<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>SAML | hyunyoun's Blog</title>
<meta name=keywords content="Security,Authentication,SAML"><meta name=description content="웹 애플리케이션에서 사용자 인증과 권한 부여를 위한 개방형 표준 프로토콜"><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/security/authentication/saml/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/security/authentication/saml/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/security/authentication/saml/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="SAML"><meta property="og:description" content="웹 애플리케이션에서 사용자 인증과 권한 부여를 위한 개방형 표준 프로토콜"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-11T11:25:00+00:00"><meta property="article:modified_time" content="2024-11-11T11:25:00+00:00"><meta property="article:tag" content="Security"><meta property="article:tag" content="Authentication"><meta property="article:tag" content="SAML"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="SAML"><meta name=twitter:description content="웹 애플리케이션에서 사용자 인증과 권한 부여를 위한 개방형 표준 프로토콜"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"IT Security","item":"https://buenhyden.github.io/posts/security/"},{"@type":"ListItem","position":3,"name":"인증 (authentication)","item":"https://buenhyden.github.io/posts/security/authentication/"},{"@type":"ListItem","position":4,"name":"SAML","item":"https://buenhyden.github.io/posts/security/authentication/saml/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"SAML","name":"SAML","description":"웹 애플리케이션에서 사용자 인증과 권한 부여를 위한 개방형 표준 프로토콜","keywords":["Security","Authentication","SAML"],"articleBody":"SAML 웹 애플리케이션에서 사용자 인증과 권한 부여를 위한 개방형 표준 프로토콜.\nSAML은 사용자가 하나의 로그인 자격 증명으로 여러 웹 애플리케이션에 접근할 수 있게 해주는 인증 메커니즘.\n주로 기업 환경에서 단일 로그인(SSO) 구현에 사용된다.\n장점 통합 인증(SSO) 지원으로 사용자 편의성 향상 표준화된 XML 기반 프로토콜로 상호운용성 보장 강력한 보안 기능 제공 다양한 인증 방식 지원 주요 구성 요소 아이덴티티 제공자(IdP) 사용자 인증을 수행하고 인증 정보를 서비스 제공자에게 전달합니다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 class IdentityProvider: def __init__(self): self.private_key = load_private_key() self.certificate = load_certificate() def create_assertion(self, user_data): \"\"\"SAML Assertion 생성\"\"\" assertion = { \"issuer\": \"https://idp.example.com\", \"subject\": user_data[\"username\"], \"attributes\": { \"email\": user_data[\"email\"], \"role\": user_data[\"role\"] }, \"conditions\": { \"notBefore\": datetime.utcnow(), \"notOnOrAfter\": datetime.utcnow() + timedelta(minutes=5) } } return self.sign_assertion(assertion) 서비스 제공자(SP) IdP로부터 받은 인증 정보를 신뢰하고 사용자에게 서비스를 제공합니다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 class ServiceProvider: def __init__(self): self.idp_certificate = load_idp_certificate() def validate_assertion(self, assertion): \"\"\"SAML Assertion 검증\"\"\" try: # 서명 검증 if not self.verify_signature(assertion): raise ValueError(\"Invalid signature\") # 시간 조건 검증 if not self.validate_conditions(assertion[\"conditions\"]): raise ValueError(\"Assertion expired\") # 사용자 정보 추출 return { \"username\": assertion[\"subject\"], \"attributes\": assertion[\"attributes\"] } except Exception as e: raise SAMLValidationError(str(e)) SAML 어서션 사용자 인증 정보를 포함한 XML 문서입니다.\n작동 방식 사용자가 서비스 제공자에 접근을 시도합니다. 서비스 제공자는 사용자를 아이덴티티 제공자로 리다이렉트합니다. 아이덴티티 제공자는 사용자를 인증하고 SAML 어서션을 생성합니다. 사용자는 SAML 어서션과 함께 서비스 제공자로 다시 리다이렉트됩니다. 서비스 제공자는 SAML 어서션을 검증하고 사용자에게 접근 권한을 부여합니다. 주요 프로세스 SP-Initiated Flow 1 2 3 4 5 6 7 def sp_initiated_sso(): \"\"\"SP에서 시작하는 SSO\"\"\" # AuthnRequest 생성 auth_request = create_authn_request() # IdP로 리다이렉트 return redirect_to_idp(auth_request) IdP-Initiated Flow 1 2 3 4 5 6 7 8 9 def idp_initiated_sso(): \"\"\"IdP에서 시작하는 SSO\"\"\" # SAML Response 수신 response = receive_saml_response() # Response 검증 if validate_response(response): # 사용자 세션 생성 create_user_session(response.get_user_data()) 보안 고려사항 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 class SAMLSecurity: def __init__(self): self.replay_cache = {} # 재생 공격 방지용 캐시 def prevent_replay_attack(self, assertion_id): \"\"\"재생 공격 방지\"\"\" if assertion_id in self.replay_cache: raise SecurityError(\"Replay attack detected\") self.replay_cache[assertion_id] = datetime.utcnow() def validate_signature(self, assertion, certificate): \"\"\"서명 검증\"\"\" return verify_xml_signature(assertion, certificate) def validate_timestamps(self, assertion): \"\"\"시간 제한 검증\"\"\" now = datetime.utcnow() not_before = assertion.conditions.not_before not_after = assertion.conditions.not_on_or_after return not_before \u003c= now \u003c= not_after 고려사항 XML 기반이므로 구현이 상대적으로 복잡 설정과 유지보수에 전문 지식 필요 상대적으로 많은 네트워크 트래픽 발생 기본 구현 Python 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 from python3_saml import OneLogin_Saml2_Auth from flask import Flask, request, session class SAMLServiceProvider: def __init__(self): self.saml_settings = { \"strict\": True, \"debug\": True, \"sp\": { # Service Provider 설정 \"entityId\": \"https://your-app.com/metadata/\", \"assertionConsumerService\": { \"url\": \"https://your-app.com/acs/\", \"binding\": \"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST\" } }, \"idp\": { # Identity Provider 설정 \"entityId\": \"https://idp.example.com/metadata/\", \"singleSignOnService\": { \"url\": \"https://idp.example.com/sso/\", \"binding\": \"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect\" }, \"x509cert\": \"IDP_X509_CERTIFICATE\" } } def init_saml_auth(self, request): return OneLogin_Saml2_Auth(request, self.saml_settings) def start_sso(self): \"\"\"SSO 로그인 시작\"\"\" auth = self.init_saml_auth(request) return auth.login() def process_response(self): \"\"\"SAML Response 처리\"\"\" auth = self.init_saml_auth(request) auth.process_response() if auth.is_authenticated(): # 사용자 속성 획득 attributes = auth.get_attributes() nameId = auth.get_nameid() return { \"user_id\": nameId, \"attributes\": attributes } return None 참고 및 출처 ","wordCount":"570","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2024-11-11T11:25:00Z","dateModified":"2024-11-11T11:25:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/security/authentication/saml/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>posts</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/security/>IT Security</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/security/authentication/>인증 (authentication)</a></div><h1 class="post-title entry-hint-parent">SAML</h1><div class=post-description>웹 애플리케이션에서 사용자 인증과 권한 부여를 위한 개방형 표준 프로토콜</div><div class=post-meta><span title='2024-11-11 11:25:00 +0000 UTC'>November 11, 2024</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;570 words&nbsp;·&nbsp;Me</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#saml>SAML</a><ul><li><a href=#장점>장점</a></li><li><a href=#주요-구성-요소>주요 구성 요소</a></li><li><a href=#작동-방식>작동 방식</a></li><li><a href=#주요-프로세스>주요 프로세스</a></li><li><a href=#보안-고려사항>보안 고려사항</a></li><li><a href=#고려사항>고려사항</a></li><li><a href=#기본-구현>기본 구현</a></li></ul></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=saml>SAML<a hidden class=anchor aria-hidden=true href=#saml>#</a></h2><p>웹 애플리케이션에서 사용자 인증과 권한 부여를 위한 개방형 표준 프로토콜.<br>SAML은 사용자가 하나의 로그인 자격 증명으로 여러 웹 애플리케이션에 접근할 수 있게 해주는 인증 메커니즘.<br>주로 기업 환경에서 단일 로그인(SSO) 구현에 사용된다.</p><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><ul><li>통합 인증(SSO) 지원으로 사용자 편의성 향상</li><li>표준화된 XML 기반 프로토콜로 상호운용성 보장</li><li>강력한 보안 기능 제공</li><li>다양한 인증 방식 지원</li></ul><h3 id=주요-구성-요소>주요 구성 요소<a hidden class=anchor aria-hidden=true href=#주요-구성-요소>#</a></h3><h4 id=아이덴티티-제공자idp>아이덴티티 제공자(IdP)<a hidden class=anchor aria-hidden=true href=#아이덴티티-제공자idp>#</a></h4><p>사용자 인증을 수행하고 인증 정보를 서비스 제공자에게 전달합니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>IdentityProvider</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>private_key</span> <span class=o>=</span> <span class=n>load_private_key</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>certificate</span> <span class=o>=</span> <span class=n>load_certificate</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_assertion</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;SAML Assertion 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>assertion</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;issuer&#34;</span><span class=p>:</span> <span class=s2>&#34;https://idp.example.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;subject&#34;</span><span class=p>:</span> <span class=n>user_data</span><span class=p>[</span><span class=s2>&#34;username&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;attributes&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;email&#34;</span><span class=p>:</span> <span class=n>user_data</span><span class=p>[</span><span class=s2>&#34;email&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;role&#34;</span><span class=p>:</span> <span class=n>user_data</span><span class=p>[</span><span class=s2>&#34;role&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;conditions&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;notBefore&#34;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;notOnOrAfter&#34;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>+</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>minutes</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>sign_assertion</span><span class=p>(</span><span class=n>assertion</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=서비스-제공자sp>서비스 제공자(SP)<a hidden class=anchor aria-hidden=true href=#서비스-제공자sp>#</a></h4><p>IdP로부터 받은 인증 정보를 신뢰하고 사용자에게 서비스를 제공합니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16>16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17>17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18>18</a>
</span><span class=lnt id=hl-1-19><a class=lnlinks href=#hl-1-19>19</a>
</span><span class=lnt id=hl-1-20><a class=lnlinks href=#hl-1-20>20</a>
</span><span class=lnt id=hl-1-21><a class=lnlinks href=#hl-1-21>21</a>
</span><span class=lnt id=hl-1-22><a class=lnlinks href=#hl-1-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>ServiceProvider</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>idp_certificate</span> <span class=o>=</span> <span class=n>load_idp_certificate</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>validate_assertion</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>assertion</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;SAML Assertion 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 서명 검증</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>verify_signature</span><span class=p>(</span><span class=n>assertion</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Invalid signature&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 시간 조건 검증</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>validate_conditions</span><span class=p>(</span><span class=n>assertion</span><span class=p>[</span><span class=s2>&#34;conditions&#34;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Assertion expired&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 사용자 정보 추출</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;username&#34;</span><span class=p>:</span> <span class=n>assertion</span><span class=p>[</span><span class=s2>&#34;subject&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;attributes&#34;</span><span class=p>:</span> <span class=n>assertion</span><span class=p>[</span><span class=s2>&#34;attributes&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>SAMLValidationError</span><span class=p>(</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=saml-어서션>SAML 어서션<a hidden class=anchor aria-hidden=true href=#saml-어서션>#</a></h4><p>사용자 인증 정보를 포함한 XML 문서입니다.</p><h3 id=작동-방식>작동 방식<a hidden class=anchor aria-hidden=true href=#작동-방식>#</a></h3><ol><li>사용자가 서비스 제공자에 접근을 시도합니다.</li><li>서비스 제공자는 사용자를 아이덴티티 제공자로 리다이렉트합니다.</li><li>아이덴티티 제공자는 사용자를 인증하고 SAML 어서션을 생성합니다.</li><li>사용자는 SAML 어서션과 함께 서비스 제공자로 다시 리다이렉트됩니다.</li><li>서비스 제공자는 SAML 어서션을 검증하고 사용자에게 접근 권한을 부여합니다.</li></ol><h3 id=주요-프로세스>주요 프로세스<a hidden class=anchor aria-hidden=true href=#주요-프로세스>#</a></h3><h4 id=sp-initiated-flow>SP-Initiated Flow<a hidden class=anchor aria-hidden=true href=#sp-initiated-flow>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3>3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4>4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5>5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6>6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>sp_initiated_sso</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;SP에서 시작하는 SSO&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># AuthnRequest 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>auth_request</span> <span class=o>=</span> <span class=n>create_authn_request</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># IdP로 리다이렉트</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect_to_idp</span><span class=p>(</span><span class=n>auth_request</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=idp-initiated-flow>IdP-Initiated Flow<a hidden class=anchor aria-hidden=true href=#idp-initiated-flow>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4>4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5>5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6>6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7>7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8>8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>idp_initiated_sso</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;IdP에서 시작하는 SSO&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># SAML Response 수신</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>receive_saml_response</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Response 검증</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>validate_response</span><span class=p>(</span><span class=n>response</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 사용자 세션 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>create_user_session</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>get_user_data</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=보안-고려사항>보안 고려사항<a hidden class=anchor aria-hidden=true href=#보안-고려사항>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span><span class=lnt id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a>
</span><span class=lnt id=hl-4-19><a class=lnlinks href=#hl-4-19>19</a>
</span><span class=lnt id=hl-4-20><a class=lnlinks href=#hl-4-20>20</a>
</span><span class=lnt id=hl-4-21><a class=lnlinks href=#hl-4-21>21</a>
</span><span class=lnt id=hl-4-22><a class=lnlinks href=#hl-4-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>SAMLSecurity</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>replay_cache</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># 재생 공격 방지용 캐시</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>prevent_replay_attack</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>assertion_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;재생 공격 방지&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>assertion_id</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>replay_cache</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>SecurityError</span><span class=p>(</span><span class=s2>&#34;Replay attack detected&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>replay_cache</span><span class=p>[</span><span class=n>assertion_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>validate_signature</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>assertion</span><span class=p>,</span> <span class=n>certificate</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;서명 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>verify_xml_signature</span><span class=p>(</span><span class=n>assertion</span><span class=p>,</span> <span class=n>certificate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>validate_timestamps</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>assertion</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;시간 제한 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>now</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>not_before</span> <span class=o>=</span> <span class=n>assertion</span><span class=o>.</span><span class=n>conditions</span><span class=o>.</span><span class=n>not_before</span>
</span></span><span class=line><span class=cl>        <span class=n>not_after</span> <span class=o>=</span> <span class=n>assertion</span><span class=o>.</span><span class=n>conditions</span><span class=o>.</span><span class=n>not_on_or_after</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>not_before</span> <span class=o>&lt;=</span> <span class=n>now</span> <span class=o>&lt;=</span> <span class=n>not_after</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=고려사항>고려사항<a hidden class=anchor aria-hidden=true href=#고려사항>#</a></h3><ol><li>XML 기반이므로 구현이 상대적으로 복잡</li><li>설정과 유지보수에 전문 지식 필요</li><li>상대적으로 많은 네트워크 트래픽 발생</li></ol><h3 id=기본-구현>기본 구현<a hidden class=anchor aria-hidden=true href=#기본-구현>#</a></h3><h4 id=python>Python<a hidden class=anchor aria-hidden=true href=#python>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16>16</a>
</span><span class=lnt id=hl-5-17><a class=lnlinks href=#hl-5-17>17</a>
</span><span class=lnt id=hl-5-18><a class=lnlinks href=#hl-5-18>18</a>
</span><span class=lnt id=hl-5-19><a class=lnlinks href=#hl-5-19>19</a>
</span><span class=lnt id=hl-5-20><a class=lnlinks href=#hl-5-20>20</a>
</span><span class=lnt id=hl-5-21><a class=lnlinks href=#hl-5-21>21</a>
</span><span class=lnt id=hl-5-22><a class=lnlinks href=#hl-5-22>22</a>
</span><span class=lnt id=hl-5-23><a class=lnlinks href=#hl-5-23>23</a>
</span><span class=lnt id=hl-5-24><a class=lnlinks href=#hl-5-24>24</a>
</span><span class=lnt id=hl-5-25><a class=lnlinks href=#hl-5-25>25</a>
</span><span class=lnt id=hl-5-26><a class=lnlinks href=#hl-5-26>26</a>
</span><span class=lnt id=hl-5-27><a class=lnlinks href=#hl-5-27>27</a>
</span><span class=lnt id=hl-5-28><a class=lnlinks href=#hl-5-28>28</a>
</span><span class=lnt id=hl-5-29><a class=lnlinks href=#hl-5-29>29</a>
</span><span class=lnt id=hl-5-30><a class=lnlinks href=#hl-5-30>30</a>
</span><span class=lnt id=hl-5-31><a class=lnlinks href=#hl-5-31>31</a>
</span><span class=lnt id=hl-5-32><a class=lnlinks href=#hl-5-32>32</a>
</span><span class=lnt id=hl-5-33><a class=lnlinks href=#hl-5-33>33</a>
</span><span class=lnt id=hl-5-34><a class=lnlinks href=#hl-5-34>34</a>
</span><span class=lnt id=hl-5-35><a class=lnlinks href=#hl-5-35>35</a>
</span><span class=lnt id=hl-5-36><a class=lnlinks href=#hl-5-36>36</a>
</span><span class=lnt id=hl-5-37><a class=lnlinks href=#hl-5-37>37</a>
</span><span class=lnt id=hl-5-38><a class=lnlinks href=#hl-5-38>38</a>
</span><span class=lnt id=hl-5-39><a class=lnlinks href=#hl-5-39>39</a>
</span><span class=lnt id=hl-5-40><a class=lnlinks href=#hl-5-40>40</a>
</span><span class=lnt id=hl-5-41><a class=lnlinks href=#hl-5-41>41</a>
</span><span class=lnt id=hl-5-42><a class=lnlinks href=#hl-5-42>42</a>
</span><span class=lnt id=hl-5-43><a class=lnlinks href=#hl-5-43>43</a>
</span><span class=lnt id=hl-5-44><a class=lnlinks href=#hl-5-44>44</a>
</span><span class=lnt id=hl-5-45><a class=lnlinks href=#hl-5-45>45</a>
</span><span class=lnt id=hl-5-46><a class=lnlinks href=#hl-5-46>46</a>
</span><span class=lnt id=hl-5-47><a class=lnlinks href=#hl-5-47>47</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>python3_saml</span> <span class=kn>import</span> <span class=n>OneLogin_Saml2_Auth</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>session</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SAMLServiceProvider</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>saml_settings</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;strict&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;debug&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;sp&#34;</span><span class=p>:</span> <span class=p>{</span>  <span class=c1># Service Provider 설정</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;entityId&#34;</span><span class=p>:</span> <span class=s2>&#34;https://your-app.com/metadata/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;assertionConsumerService&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://your-app.com/acs/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;binding&#34;</span><span class=p>:</span> <span class=s2>&#34;urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;idp&#34;</span><span class=p>:</span> <span class=p>{</span>  <span class=c1># Identity Provider 설정</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;entityId&#34;</span><span class=p>:</span> <span class=s2>&#34;https://idp.example.com/metadata/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;singleSignOnService&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://idp.example.com/sso/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;binding&#34;</span><span class=p>:</span> <span class=s2>&#34;urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;x509cert&#34;</span><span class=p>:</span> <span class=s2>&#34;IDP_X509_CERTIFICATE&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>init_saml_auth</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>OneLogin_Saml2_Auth</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>saml_settings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>start_sso</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;SSO 로그인 시작&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>auth</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>init_saml_auth</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>auth</span><span class=o>.</span><span class=n>login</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_response</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;SAML Response 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>auth</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>init_saml_auth</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>auth</span><span class=o>.</span><span class=n>process_response</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>auth</span><span class=o>.</span><span class=n>is_authenticated</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=c1># 사용자 속성 획득</span>
</span></span><span class=line><span class=cl>            <span class=n>attributes</span> <span class=o>=</span> <span class=n>auth</span><span class=o>.</span><span class=n>get_attributes</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>nameId</span> <span class=o>=</span> <span class=n>auth</span><span class=o>.</span><span class=n>get_nameid</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;user_id&#34;</span><span class=p>:</span> <span class=n>nameId</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;attributes&#34;</span><span class=p>:</span> <span class=n>attributes</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/security/>Security</a></li><li><a href=https://buenhyden.github.io/tags/authentication/>Authentication</a></li><li><a href=https://buenhyden.github.io/tags/saml/>SAML</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/security/authentication/session-based-auth/><span class=title>« Prev</span><br><span>Session based Auth</span>
</a><a class=next href=https://buenhyden.github.io/posts/security/authentication/basic-authentication/><span class=title>Next »</span><br><span>Basic Authentication</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>