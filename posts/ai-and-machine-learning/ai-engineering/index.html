<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>AI Engineering | hyunyoun's Blog</title><meta name=keywords content="AI,AI-Engineering"><meta name=description content="AI 엔지니어링(Artificial Intelligence Engineering)은 인공지능 시스템을 설계, 개발, 배포 및 유지보수하는 체계적인 접근 방식이다. 이는 단순히 AI 모델을 훈련하는 것을 넘어서, 실제 비즈니스 환경에서 안정적으로 작동하는 AI 솔루션을 구축하는 전체 과정을 포함한다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/ai-and-machine-learning/ai-engineering/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/ai-and-machine-learning/ai-engineering/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/ai-and-machine-learning/ai-engineering/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="AI Engineering"><meta property="og:description" content="AI 엔지니어링(Artificial Intelligence Engineering)은 인공지능 시스템을 설계, 개발, 배포 및 유지보수하는 체계적인 접근 방식이다. 이는 단순히 AI 모델을 훈련하는 것을 넘어서, 실제 비즈니스 환경에서 안정적으로 작동하는 AI 솔루션을 구축하는 전체 과정을 포함한다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-01-31T12:08:00+00:00"><meta property="article:modified_time" content="2025-01-31T12:08:00+00:00"><meta property="article:tag" content="AI"><meta property="article:tag" content="AI-Engineering"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="AI Engineering"><meta name=twitter:description content="AI 엔지니어링(Artificial Intelligence Engineering)은 인공지능 시스템을 설계, 개발, 배포 및 유지보수하는 체계적인 접근 방식이다. 이는 단순히 AI 모델을 훈련하는 것을 넘어서, 실제 비즈니스 환경에서 안정적으로 작동하는 AI 솔루션을 구축하는 전체 과정을 포함한다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Computer Science and Engineering","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"AI and Machine Learning","item":"https://buenhyden.github.io/posts/ai-and-machine-learning/"},{"@type":"ListItem","position":3,"name":"AI Engineering","item":"https://buenhyden.github.io/posts/ai-and-machine-learning/ai-engineering/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"AI Engineering","name":"AI Engineering","description":"AI 엔지니어링(Artificial Intelligence Engineering)은 인공지능 시스템을 설계, 개발, 배포 및 유지보수하는 체계적인 접근 방식이다. 이는 단순히 AI 모델을 훈련하는 것을 넘어서, 실제 비즈니스 환경에서 안정적으로 작동하는 AI 솔루션을 구축하는 전체 과정을 포함한다.","keywords":["AI","AI-Engineering"],"articleBody":"AI Engineering AI 엔지니어링(Artificial Intelligence Engineering)은 인공지능 시스템을 설계, 개발, 배포 및 유지보수하는 체계적인 접근 방식이다. 이는 단순히 AI 모델을 훈련하는 것을 넘어서, 실제 비즈니스 환경에서 안정적으로 작동하는 AI 솔루션을 구축하는 전체 과정을 포함한다.\n기존의 소프트웨어 엔지니어링이 소프트웨어 시스템을 개발하는 원칙과 방법론을 다룬다면, AI 엔지니어링은 여기에 데이터 관리, 모델 훈련, 불확실성 처리, 지속적인 학습 등 AI 시스템 특유의 측면을 추가한다.\nAI 엔지니어링은 실험실에서 개발된 모델이 실제 환경에서 가치를 창출할 수 있도록 다리를 놓는 역할을 한다.\nAI 엔지니어링은 연구 환경에서 개발된 AI 모델을 실제 비즈니스 환경에서 가치를 창출하는 운영 시스템으로 전환하는 핵심 분야이다. 이는 데이터 엔지니어링, 모델 개발, MLOps, 모니터링 및 피드백 루프를 포함하는 종합적인 접근 방식을 필요로 한다.\nAI 엔지니어링의 필요성 AI 시스템은 전통적인 소프트웨어 시스템과 몇 가지 중요한 차이점이 있다:\n데이터 중심: AI 시스템은 코드뿐만 아니라 데이터에 의해 동작이 결정된다. 비결정적 동작: 같은 입력에 대해 항상 동일한 출력을 보장하지 않을 수 있다. 지속적 학습 필요: 시간이 지남에 따라 데이터가 변하면 모델도 업데이트되어야 한다. 해석과 설명 과제: 모델의 결정을 이해하고 설명하는 것이 어려울 수 있다. 이러한 특성으로 인해, AI 시스템을 개발하고 운영하기 위한 별도의 엔지니어링 접근 방식이 필요하게 되었다.\nAI 엔지니어링의 핵심 구성 요소 AI 엔지니어링은 다음과 같은 핵심 영역으로 구성된다:\n데이터 엔지니어링 AI 시스템의 기반이 되는 데이터를 수집, 처리, 저장하는 과정을 관리한다.\n데이터 수집: 다양한 소스에서 데이터를 수집하는 파이프라인 구축 데이터 전처리: 결측치 처리, 정규화, 특성 추출 등의 과정 자동화 데이터 저장 및 관리: 효율적인 데이터 저장소 설계 및 버전 관리 데이터 품질 관리: 일관성, 정확성, 완전성 등 데이터 품질 보장 예시 코드 - 데이터 파이프라인 구축:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 # Apache Airflow를 사용한 데이터 수집 파이프라인 예시 from airflow import DAG from airflow.operators.python_operator import PythonOperator from datetime import datetime, timedelta # 기본 인자 설정 default_args = { 'owner': 'ai_engineer', 'depends_on_past': False, 'start_date': datetime(2023, 1, 1), 'email_on_failure': True, 'retries': 3, 'retry_delay': timedelta(minutes=5), } # DAG 정의 dag = DAG( 'data_collection_pipeline', default_args=default_args, description='데이터 수집 및 전처리 파이프라인', schedule_interval=timedelta(days=1), ) # 데이터 수집 함수 def collect_data(**context): # 데이터 소스에서 데이터 수집 로직 print(\"데이터 수집 중…\") # 수집된 데이터 반환 # 데이터 전처리 함수 def preprocess_data(**context): # 데이터 전처리 로직 print(\"데이터 전처리 중…\") # 전처리된 데이터 반환 # 데이터 검증 함수 def validate_data(**context): # 데이터 품질 검증 로직 print(\"데이터 검증 중…\") # 검증 결과 반환 # 태스크 생성 및 연결 collect_task = PythonOperator( task_id='collect_data', python_callable=collect_data, provide_context=True, dag=dag, ) preprocess_task = PythonOperator( task_id='preprocess_data', python_callable=preprocess_data, provide_context=True, dag=dag, ) validate_task = PythonOperator( task_id='validate_data', python_callable=validate_data, provide_context=True, dag=dag, ) # 태스크 의존성 설정 collect_task \u003e\u003e preprocess_task \u003e\u003e validate_task 모델 개발 및 훈련 AI 모델을 설계하고 최적화하는 과정을 관리한다.\n모델 설계: 문제에 적합한 알고리즘 및 아키텍처 선택 하이퍼파라미터 최적화: 최적의 모델 파라미터 탐색 모델 평가: 정확성, 견고성, 공정성 등 다양한 측면에서 모델 평가 실험 관리: 모델 실험 추적 및 재현성 보장 예시 코드 - 모델 훈련 및 실험 추적:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 # PyTorch와 MLflow를 사용한 모델 훈련 및 실험 추적 예시 import torch import torch.nn as nn import torch.optim as optim from torch.utils.data import DataLoader import mlflow import mlflow.pytorch # 모델 정의 class SimpleNN(nn.Module): def __init__(self, input_size, hidden_size, output_size): super(SimpleNN, self).__init__() self.layer1 = nn.Linear(input_size, hidden_size) self.relu = nn.ReLU() self.layer2 = nn.Linear(hidden_size, output_size) def forward(self, x): x = self.layer1(x) x = self.relu(x) x = self.layer2(x) return x # 훈련 함수 def train_model(model, train_loader, val_loader, criterion, optimizer, epochs): # MLflow 실험 시작 mlflow.start_run() # 하이퍼파라미터 로깅 mlflow.log_param(\"hidden_size\", model.layer1.out_features) mlflow.log_param(\"learning_rate\", optimizer.param_groups[0]['lr']) mlflow.log_param(\"epochs\", epochs) for epoch in range(epochs): # 훈련 모드 model.train() train_loss = 0 for inputs, targets in train_loader: # 순전파 outputs = model(inputs) loss = criterion(outputs, targets) # 역전파 및 최적화 optimizer.zero_grad() loss.backward() optimizer.step() train_loss += loss.item() # 평가 모드 model.eval() val_loss = 0 correct = 0 total = 0 with torch.no_grad(): for inputs, targets in val_loader: outputs = model(inputs) loss = criterion(outputs, targets) val_loss += loss.item() _, predicted = outputs.max(1) total += targets.size(0) correct += predicted.eq(targets).sum().item() # 메트릭 계산 및 로깅 train_loss /= len(train_loader) val_loss /= len(val_loader) accuracy = 100. * correct / total mlflow.log_metric(\"train_loss\", train_loss, step=epoch) mlflow.log_metric(\"val_loss\", val_loss, step=epoch) mlflow.log_metric(\"accuracy\", accuracy, step=epoch) print(f\"Epoch {epoch+1}/{epochs}: \" f\"Train Loss: {train_loss:f}, \" f\"Val Loss: {val_loss:f}, \" f\"Accuracy: {accuracy:f}%\") # 모델 저장 mlflow.pytorch.log_model(model, \"model\") mlflow.end_run() return model # 모델 훈련 실행 input_size = 784 # MNIST 이미지 크기 hidden_size = 128 output_size = 10 # 0-9 숫자 분류 model = SimpleNN(input_size, hidden_size, output_size) # 손실 함수 및 옵티마이저 설정 criterion = nn.CrossEntropyLoss() optimizer = optim.Adam(model.parameters(), lr=0.001) # 데이터 로더 설정 (실제 코드에서는 실제 데이터 사용) # train_loader = DataLoader(…) # val_loader = DataLoader(…) # 모델 훈련 # trained_model = train_model(model, train_loader, val_loader, criterion, optimizer, epochs=10) 모델 배포 및 제공 개발된 AI 모델을 실제 환경에 배포하고 서비스하는 과정을 관리한다.\n모델 패키징: 모델과 의존성을 함께 패키징하여 이식성 확보 서빙 인프라: 모델 서빙을 위한 확장 가능한 인프라 구축 API 설계: 모델과 상호작용하기 위한 인터페이스 설계 성능 최적화: 지연 시간 및 처리량 최적화 예시 코드 - 모델 배포:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 # Flask와 Docker를 사용한 모델 배포 예시 # app.py from flask import Flask, request, jsonify import torch import torch.nn as nn import numpy as np app = Flask(__name__) # 모델 정의 (실제 배포에서는 저장된 모델을 로드) class SimpleNN(nn.Module): def __init__(self, input_size, hidden_size, output_size): super(SimpleNN, self).__init__() self.layer1 = nn.Linear(input_size, hidden_size) self.relu = nn.ReLU() self.layer2 = nn.Linear(hidden_size, output_size) def forward(self, x): x = self.layer1(x) x = self.relu(x) x = self.layer2(x) return x # 모델 로드 def load_model(): model = SimpleNN(784, 128, 10) model.load_state_dict(torch.load('model.pth')) model.eval() return model model = load_model() @app.route('/predict', methods=['POST']) def predict(): try: # 요청에서 데이터 추출 data = request.json input_data = np.array(data['input']) # 입력 데이터 전처리 input_tensor = torch.FloatTensor(input_data) # 예측 수행 with torch.no_grad(): output = model(input_tensor) probabilities = torch.nn.functional.softmax(output, dim=0) predicted_class = torch.argmax(probabilities).item() # 결과 반환 return jsonify({ 'predicted_class': predicted_class, 'probabilities': probabilities.tolist() }) except Exception as e: return jsonify({'error': str(e)}), 400 if __name__ == '__main__': app.run(host='0.0.0.0', port=5000) 1 2 3 4 5 6 7 8 9 10 11 12 13 # Dockerfile FROM python:3.9-slim WORKDIR /app COPY requirements.txt . RUN pip install --no-cache-dir -r requirements.txt COPY . . EXPOSE 5000 CMD [\"python\", \"app.py\"] MLOps 및 자동화 AI 모델의 개발, 테스트, 배포, 모니터링 과정을 자동화하는 CI/CD 파이프라인을 구축한다.\n지속적 통합(CI): 코드 및 데이터 변경 시 자동 테스트 지속적 배포(CD): 검증된 모델을 자동으로 배포 모델 버전 관리: 모델과 데이터의 버전 및 계보 추적 인프라스트럭처 as 코드(IaC): 인프라 설정을 코드로 관리 예시 코드 - CI/CD 파이프라인:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 # GitHub Actions를 사용한 CI/CD 파이프라인 예시 # .github/workflows/model-pipeline.yml name: Model Training and Deployment Pipeline on: push: branches: [ main ] pull_request: branches: [ main ] jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v2 - name: Set up Python uses: actions/setup-python@v2 with: python-version: '3.9' - name: Install dependencies run: | python -m pip install --upgrade pip pip install -r requirements.txt - name: Run tests run: | pytest tests/ train: needs: test runs-on: ubuntu-latest steps: - uses: actions/checkout@v2 - name: Set up Python uses: actions/setup-python@v2 with: python-version: '3.9' - name: Install dependencies run: | python -m pip install --upgrade pip pip install -r requirements.txt - name: Train model run: | python scripts/train.py - name: Evaluate model run: | python scripts/evaluate.py - name: Upload model artifact uses: actions/upload-artifact@v2 with: name: model-artifact path: models/model.pth deploy: needs: train if: github.event_name == 'push' \u0026\u0026 github.ref == 'refs/heads/main' runs-on: ubuntu-latest steps: - uses: actions/checkout@v2 - name: Download model artifact uses: actions/download-artifact@v2 with: name: model-artifact path: models/ - name: Set up Docker Buildx uses: docker/setup-buildx-action@v1 - name: Login to DockerHub uses: docker/login-action@v1 with: username: ${{ secrets.DOCKERHUB_USERNAME }} password: ${{ secrets.DOCKERHUB_TOKEN }} - name: Build and push uses: docker/build-push-action@v2 with: context: . push: true tags: user/model-api:latest 모델 모니터링 및 피드백 루프 배포된 모델의 성능을 지속적으로 모니터링하고 필요에 따라 업데이트하는 과정을 관리한다.\n성능 모니터링: 정확도, 예측 지연 시간 등의 측정 및 추적 데이터 드리프트 감지: 입력 데이터 변화 감지 및 대응 개념 드리프트 감지: 데이터와 대상 간 관계 변화 감지 A/B 테스트: 새 모델과 기존 모델 비교 실험 예시 코드 - 모델 모니터링:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 # Prometheus와 Grafana를 사용한 모델 모니터링 예시 from flask import Flask, request, jsonify import torch import numpy as np from prometheus_client import Counter, Histogram, Gauge, Summary, start_http_server import time app = Flask(__name__) # Prometheus 메트릭 정의 PREDICTION_COUNT = Counter('model_predictions_total', 'Total number of predictions') PREDICTION_LATENCY = Histogram('model_prediction_latency_seconds', 'Prediction latency in seconds') PREDICTION_ERRORS = Counter('model_prediction_errors_total', 'Total number of prediction errors') MODEL_ACCURACY = Gauge('model_accuracy', 'Current model accuracy') INPUT_DRIFT = Gauge('input_drift_score', 'Input data drift score') # 모델 로드 및 설정 # (이전 예시 참조) @app.route('/predict', methods=['POST']) def predict(): start_time = time.time() try: # 요청에서 데이터 추출 data = request.json input_data = np.array(data['input']) # 입력 데이터 드리프트 감지 drift_score = check_data_drift(input_data) INPUT_DRIFT.set(drift_score) # 예측 수행 with torch.no_grad(): input_tensor = torch.FloatTensor(input_data) output = model(input_tensor) probabilities = torch.nn.functional.softmax(output, dim=0) predicted_class = torch.argmax(probabilities).item() # 메트릭 업데이트 PREDICTION_COUNT.inc() # 결과 반환 response = { 'predicted_class': predicted_class, 'probabilities': probabilities.tolist() } return jsonify(response) except Exception as e: PREDICTION_ERRORS.inc() return jsonify({'error': str(e)}), 400 finally: # 예측 지연 시간 측정 latency = time.time() - start_time PREDICTION_LATENCY.observe(latency) def check_data_drift(input_data): # 입력 데이터 드리프트 감지 로직 # 기준 데이터와 현재 데이터의 통계적 특성 비교 # 간단한 예시로, 평균 차이를 기반으로 점수 계산 reference_mean = 0.5 # 기준 데이터의 평균 (예시 값) current_mean = np.mean(input_data) drift_score = abs(current_mean - reference_mean) return drift_score # 모델 정확도 업데이트 함수 (주기적으로 호출) def update_model_accuracy(): # 테스트 데이터로 모델 정확도 평가 accuracy = evaluate_model_on_test_data() MODEL_ACCURACY.set(accuracy) # 메트릭 서버 시작 start_http_server(8000) if __name__ == '__main__': app.run(host='0.0.0.0', port=5000) AI 엔지니어링의 필수 기술과 도구 프로그래밍 언어 및 프레임워크:\nAI 엔지니어링에 필요한 주요 프로그래밍 언어와 프레임워크:\nPython: AI 개발의 사실상 표준 언어 R: 통계 분석 및 시각화에 강점 Julia: 고성능 연산에 최적화된 언어 TensorFlow, PyTorch: 딥러닝 모델 개발에 사용되는 주요 프레임워크 scikit-learn: 전통적인 머신러닝 알고리즘 구현 Spark MLlib: 분산 머신러닝을 위한 라이브러리 데이터 엔지니어링 도구\n데이터 처리 및 관리를 위한 도구:\nSQL, NoSQL 데이터베이스: 데이터 저장 및 쿼리 Apache Spark, Hadoop: 대규모 데이터 처리 Kafka, RabbitMQ: 데이터 스트리밍 및 메시징 Airflow, Luigi: 데이터 파이프라인 오케스트레이션 dbt (data build tool): 데이터 변환 및 관리 MLOps 도구\nAI 시스템의 개발 및 운영을 위한 도구:\nGit, GitHub: 코드 버전 관리 DVC (Data Version Control): 데이터 및 모델 버전 관리 MLflow, Weights \u0026 Biases: 실험 추적 및 모델 관리 Kubeflow, Metaflow: ML 워크플로우 오케스트레이션 Docker, Kubernetes: 컨테이너화 및 오케스트레이션 TensorFlow Serving, TorchServe, KFServing: 모델 서빙 Prometheus, Grafana: 모니터링 및 알림 클라우드 플랫폼 및 서비스\n클라우드 기반 AI 서비스:\nAWS SageMaker: 모델 개발, 훈련, 배포를 위한 통합 플랫폼 Google AI Platform: 모델 개발 및 배포를 위한 Google의 서비스 Azure Machine Learning: Microsoft의 ML 개발 및 배포 서비스 IBM Watson: 다양한 AI 서비스를 제공하는 IBM의 플랫폼 Databricks: 협업 기반 데이터 분석 및 ML 플랫폼 AI 엔지니어링 프로세스 문제 정의 및 요구사항 분석\nAI 프로젝트의 출발점은 명확한 문제 정의와 요구사항 분석이다: 비즈니스 문제 이해: 해결하려는 문제와 비즈니스 목표 파악 요구사항 분석: 기능적, 비기능적 요구사항 정의 성공 기준 설정: 모델 성능 및 비즈니스 성과 지표 정의 제약 조건 식별: 리소스, 시간, 규제 등의 제약 확인 데이터 수집 및 준비\nAI 모델 개발에 필요한 데이터를 수집하고 준비하는 단계: 데이터 소스 식별: 관련 데이터 소스 식별 및 접근 방법 수립 데이터 수집: 다양한 소스에서 데이터 수집 및 통합 데이터 탐색: 데이터 특성, 분포, 품질 등 분석 데이터 전처리: 결측치 처리, 정규화, 특성 추출 등 수행 데이터 분할: 훈련, 검증, 테스트 세트로 데이터 분할 모델 개발 및 훈련\nAI 모델을 설계하고 훈련하는 단계: 모델 선택: 문제에 적합한 알고리즘 및 아키텍처 선택 초기 모델 훈련: 기본 설정으로 모델 훈련 및 평가 하이퍼파라미터 최적화: 모델 성능 향상을 위한 파라미터 튜닝 모델 평가: 다양한 메트릭으로 모델 성능 평가 모델 재훈련: 최적의 설정으로 전체 훈련 데이터셋에서 모델 재훈련 모델 배포 및 통합\n개발된 모델을 실제 환경에 배포하고 기존 시스템과 통합하는 단계: 배포 전략 수립: 온라인/오프라인, 배치/실시간 등 배포 방식 결정 모델 패키징: 모델과 의존성을 함께 패키징 서빙 인프라 구축: 확장성, 가용성, 성능을 고려한 인프라 설계 API 개발: 모델과 상호작용하기 위한 인터페이스 개발 시스템 통합: 기존 시스템과의 통합 및 테스트 모니터링 및 유지보수\n배포된 모델의 성능을 모니터링하고 유지보수하는 단계: 성능 모니터링: 모델 정확도, 응답 시간 등 추적 데이터 드리프트 감지: 입력 데이터 변화 모니터링 개념 드리프트 감지: 데이터와 목표 변수 간 관계 변화 감지 모델 업데이트: 필요에 따라 모델 재훈련 및 업데이트 피드백 수집: 사용자 피드백 수집 및 분석 AI 엔지니어링의 도전 과제 및 모범 사례 데이터 관련 도전 과제\n불충분한 데이터: 모델 훈련에 필요한 데이터 부족 편향된 데이터: 특정 그룹이나 상황을 과소/과대 표현하는 데이터 낮은 데이터 품질: 결측치, 잡음, 불일치 등의 문제 데이터 라벨링 비용: 지도학습을 위한 라벨링의 높은 비용과 시간\n모범 사례: 데이터 증강(Data Augmentation) 기법 활용 다양성과 공정성을 고려한 데이터 수집 자동화된 데이터 품질 검증 파이프라인 구축 준지도학습, 약지도학습 등의 대안적 접근법 고려 모델 개발 도전 과제\n과적합(Overfitting): 훈련 데이터에만 최적화된 모델 모델 복잡성: 해석하기 어려운 블랙박스 모델 일반화 능력: 새로운 데이터에 대한 성능 저하 컴퓨팅 요구사항: 대규모 모델 훈련의 높은 컴퓨팅 요구\n모범 사례: 정규화, 교차 검증 등 과적합 방지 기법 적용 모델 설명 가능성(XAI) 기법 활용 다양한 조건에서의 강건성 테스트 모델 압축, 증류, 양자화 등의 최적화 기법 적용 배포 및 운영 도전 과제\n모델-서빙 간극: 연구 환경과 생산 환경 간의 차이로 인한 문제 확장성: 트래픽 증가에 따른 확장 문제 지연 시간: 실시간 응답이 필요한 애플리케이션의 성능 요구사항 의존성 관리: 모델과 환경 의존성의 복잡성\n모범 사례: 컨테이너화를 통한 환경 일관성 확보 자동 스케일링 인프라 구축 모델 최적화 및 캐싱 전략 도입 의존성을 포함한 모델 패키징 및 버전 관리 모니터링 및 유지보수 도전 과제\n성능 저하 감지: 시간이 지남에 따른 모델 성능 저하 감지 데이터 드리프트: 입력 데이터 분포의 변화 관리 개념 드리프트: 데이터와 목표 변수 간 관계 변화 관리 피드백 루프: 모델 업데이트를 위한 피드백 메커니즘 구축\n모범 사례: 자동화된 모델 성능 모니터링 시스템 구축 데이터 드리프트 감지 및 알림 메커니즘 구현 정기적인 모델 재평가 및 재훈련 일정 수립 A/B 테스트를 통한 모델 업데이트 효과 검증 윤리 및 책임 AI 도전 과제\n편향과 공정성: 모델의 결정에서 특정 그룹에 대한 편향 설명 가능성: 모델 결정에 대한 투명성 및 해석 가능성 부족 프라이버시: 개인 정보 보호 및 데이터 보안 문제 사회적 영향: AI 시스템의 잠재적 부정적 사회 영향\n모범 사례: 공정성 메트릭을 통한 모델 평가 및 편향 감지 설명 가능한 AI(XAI) 기법 및 도구 활용 차등 프라이버시, 연합 학습 등의 프라이버시 보호 기법 적용 다양한 이해관계자와의 협력 및 윤리적 영향 평가 AI 엔지니어링 프로젝트 예시 고객 이탈 예측 시스템 통신사나 구독 서비스 회사가 고객 이탈(Churn)을 예측하고 방지하기 위한 AI 시스템 구축 과정을 단계별로 살펴보자.\n문제 정의 및 요구사항 비즈니스 문제: 고객 이탈로 인한 수익 손실 최소화 AI 접근법: 고객 이탈 위험이 높은 고객을 식별하는 예측 모델 성공 기준: 이탈 예측 정확도 85% 이상, 고객 유지율 10% 향상 제약 조건: 일별 예측 업데이트, 90초 이내 마케팅 시스템 통합 데이터 파이프라인 구축 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 # 데이터 파이프라인 예시 코드 (Airflow 사용) from airflow import DAG from airflow.operators.python_operator import PythonOperator from datetime import datetime, timedelta import pandas as pd import numpy as np from sklearn.preprocessing import StandardScaler import logging default_args = { 'owner': 'ai_team', 'depends_on_past': False, 'start_date': datetime(2023, 1, 1), 'email_on_failure': True, 'email_on_retry': False, 'retries': 1, 'retry_delay': timedelta(minutes=5), } dag = DAG( 'customer_churn_data_pipeline', default_args=default_args, description='Customer churn data processing pipeline', schedule_interval='@daily', ) def extract_customer_data(**kwargs): \"\"\"고객 데이터 추출 함수\"\"\" try: # 데이터베이스에서 고객 데이터 추출 # 실제 구현에서는 SQL 쿼리 또는 API 호출 사용 logging.info(\"Extracting customer data...\") # 예시 데이터 (실제로는 DB에서 가져옴) customers = pd.DataFrame({ 'customer_id': range(1000, 1100), 'subscription_length': np.random.randint(1, 60, 100), 'monthly_charges': np.random.uniform(20, 200, 100), 'total_charges': np.random.uniform(100, 5000, 100), 'contract_type': np.random.choice(['Monthly', 'One year', 'Two year'], 100), 'payment_method': np.random.choice(['Credit card', 'Bank transfer', 'Electronic check'], 100), 'tech_support_calls': np.random.randint(0, 15, 100), 'last_active_days': np.random.randint(0, 30, 100), }) # 결과 저장 customers.to_csv('/tmp/raw_customer_data.csv', index=False) return '/tmp/raw_customer_data.csv' except Exception as e: logging.error(f\"Error extracting customer data: {e}\") raise def validate_data(**kwargs): \"\"\"데이터 검증 함수\"\"\" try: input_path = kwargs['ti'].xcom_pull(task_ids='extract_customer_data') logging.info(f\"Validating data from {input_path}\") # 데이터 로드 df = pd.read_csv(input_path) # 데이터 검증 로직 # 1. 필수 열 존재 확인 required_columns = ['customer_id', 'subscription_length', 'monthly_charges'] missing_columns = [col for col in required_columns if col not in df.columns] if missing_columns: raise ValueError(f\"Missing required columns: {missing_columns}\") # 2. 중복 고객 ID 확인 if df['customer_id'].duplicated().any(): raise ValueError(\"Duplicate customer IDs found\") # 3. 데이터 범위 확인 if (df['monthly_charges'] \u003c 0).any(): raise ValueError(\"Negative monthly charges found\") # 4. 결측치 확인 missing_values = df.isnull().sum() if missing_values.sum() \u003e 0: logging.warning(f\"Missing values found: {missing_values[missing_values \u003e 0]}\") # 검증 통과 - 데이터 저장 df.to_csv('/tmp/validated_customer_data.csv', index=False) return '/tmp/validated_customer_data.csv' except Exception as e: logging.error(f\"Data validation error: {e}\") raise def transform_features(**kwargs): \"\"\"특성 엔지니어링 함수\"\"\" try: input_path = kwargs['ti'].xcom_pull(task_ids='validate_data') logging.info(f\"Transforming features from {input_path}\") # 데이터 로드 df = pd.read_csv(input_path) # 특성 엔지니어링 # 1. 범주형 변수 원-핫 인코딩 df = pd.get_dummies(df, columns=['contract_type', 'payment_method'], drop_first=True) # 2. 새로운 특성 생성 df['avg_monthly_charge'] = df['total_charges'] / df['subscription_length'] df['inactive_ratio'] = df['last_active_days'] / 30 # 활동 비율 계산 # 3. 수치형 특성 정규화 scaler = StandardScaler() numeric_features = ['subscription_length', 'monthly_charges', 'total_charges', 'tech_support_calls', 'avg_monthly_charge'] df[numeric_features] = scaler.fit_transform(df[numeric_features]) # 4. 특성 선택 (중요한 특성만 유지) selected_columns = ['customer_id', 'subscription_length', 'monthly_charges', 'tech_support_calls', 'last_active_days', 'inactive_ratio', 'avg_monthly_charge'] + [col for col in df.columns if 'contract_type' in col or 'payment_method' in col] df = df[selected_columns] # 변환된 데이터 저장 df.to_csv('/tmp/features_customer_data.csv', index=False) return '/tmp/features_customer_data.csv' except Exception as e: logging.error(f\"Feature transformation error: {e}\") raise # DAG 태스크 정의 extract_task = PythonOperator( task_id='extract_customer_data', python_callable=extract_customer_data, provide_context=True, dag=dag, ) validate_task = PythonOperator( task_id='validate_data', python_callable=validate_data, provide_context=True, dag=dag, ) transform_task = PythonOperator( task_id='transform_features', python_callable=transform_features, provide_context=True, dag=dag, ) # 태스크 의존성 설정 extract_task \u003e\u003e validate_task \u003e\u003e transform_task 모델 개발 및 훈련 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 # 모델 훈련 및 평가 예시 코드 (MLflow 사용) import pandas as pd import numpy as np from sklearn.model_selection import train_test_split, cross_val_score from sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier from sklearn.linear_model import LogisticRegression from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, roc_auc_score from sklearn.pipeline import Pipeline from sklearn.compose import ColumnTransformer from sklearn.preprocessing import StandardScaler, OneHotEncoder import mlflow import mlflow.sklearn import logging # 로깅 설정 logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(name)s - %(levelname)s - %(message)s') logger = logging.getLogger(__name__) def load_train_data(path='/tmp/features_customer_data.csv', target_path='/tmp/customer_churn_labels.csv'): \"\"\"훈련 데이터 및 레이블 로드\"\"\" try: # 특성 데이터 로드 features = pd.read_csv(path) # 타겟 데이터 로드 (이탈 여부) # 실제 구현에서는 이 데이터가 별도 소스에서 올 수 있음 targets = pd.read_csv(target_path) # 고객 ID로 데이터 병합 data = features.merge(targets, on='customer_id') # ID 열 분리 X = data.drop(['customer_id', 'churn'], axis=1) y = data['churn'] return X, y except Exception as e: logger.error(f\"Error loading training data: {e}\") raise def train_evaluate_model(X, y, model_type='random_forest', experiment_name='churn_prediction'): \"\"\"모델 훈련 및 평가\"\"\" try: # MLflow 실험 설정 mlflow.set_experiment(experiment_name) # 데이터 분할 X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42) # MLflow 실행 시작 with mlflow.start_run() as run: # 모델 선택 if model_type == 'random_forest': model = RandomForestClassifier(n_estimators=100, random_state=42) params = { 'n_estimators': 100, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1 } elif model_type == 'gradient_boosting': model = GradientBoostingClassifier(n_estimators=100, random_state=42) params = { 'n_estimators': 100, 'learning_rate': 0.1, 'max_depth': 3 } elif model_type == 'logistic_regression': model = LogisticRegression(max_iter=1000, random_state=42) params = { 'C': 1.0, 'penalty': 'l2', 'solver': 'lbfgs' } else: raise ValueError(f\"Unsupported model type: {model_type}\") # 파라미터 로깅 mlflow.log_params(params) # 모델 훈련 model.fit(X_train, y_train) # 예측 y_pred = model.predict(X_test) y_prob = model.predict_proba(X_test)[:, 1] # 평가 메트릭 계산 accuracy = accuracy_score(y_test, y_pred) precision = precision_score(y_test, y_pred) recall = recall_score(y_test, y_pred) f1 = f1_score(y_test, y_pred) roc_auc = roc_auc_score(y_test, y_prob) # 메트릭 로깅 metrics = { 'accuracy': accuracy, 'precision': precision, 'recall': recall, 'f1_score': f1, 'roc_auc': roc_auc } mlflow.log_metrics(metrics) # 모델 저장 mlflow.sklearn.log_model(model, \"model\") # 결과 출력 logger.info(f\"Model training completed with metrics: {metrics}\") # 교차 검증 수행 cv_scores = cross_val_score(model, X, y, cv=5, scoring='roc_auc') mlflow.log_metric(\"cv_roc_auc_mean\", cv_scores.mean()) mlflow.log_metric(\"cv_roc_auc_std\", cv_scores.std()) logger.info(f\"Cross-validation ROC AUC: {cv_scores.mean():.4f} ± {cv_scores.std():.4f}\") return { 'model': model, 'metrics': metrics, 'run_id': run.info.run_id } except Exception as e: logger.error(f\"Error in model training and evaluation: {e}\") raise def main(): \"\"\"메인 실행 함수\"\"\" try: # 데이터 로드 logger.info(\"Loading training data...\") X, y = load_train_data() # 여러 모델 학습 및 평가 models = ['random_forest', 'gradient_boosting', 'logistic_regression'] results = {} for model_type in models: logger.info(f\"Training and evaluating {model_type} model...\") results[model_type] = train_evaluate_model(X, y, model_type) # 최고 성능 모델 선택 best_model_type = max(results, key=lambda k: results[k]['metrics']['roc_auc']) best_model_results = results[best_model_type] logger.info(f\"Best model: {best_model_type} with ROC AUC: {best_model_results['metrics']['roc_auc']:.4f}\") # 최고 성능 모델 등록 (모델 레지스트리 사용) mlflow.set_tracking_uri(\"http://localhost:5000\") # MLflow 서버 주소 model_name = \"customer_churn_predictor\" model_version = mlflow.register_model( f\"runs:/{best_model_results['run_id']}/model\", model_name ) logger.info(f\"Registered model: {model_name} version {model_version.version}\") return best_model_results except Exception as e: logger.error(f\"Error in main function: {e}\") raise if __name__ == \"__main__\": main() 모델 배포 및 API 구현 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 # FastAPI를 사용한 모델 서빙 예시 코드 from fastapi import FastAPI, HTTPException, Depends, BackgroundTasks from pydantic import BaseModel from typing import List, Dict, Optional import pandas as pd import numpy as np import pickle import json import logging from datetime import datetime import mlflow.pyfunc import redis import os from prometheus_client import Counter, Histogram, Gauge import time # 로깅 설정 logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(name)s - %(levelname)s - %(message)s') logger = logging.getLogger(__name__) # Redis 연결 설정 redis_client = redis.Redis( host=os.getenv(\"REDIS_HOST\", \"localhost\"), port=int(os.getenv(\"REDIS_PORT\", 6379)), db=0 ) # Prometheus 메트릭 정의 PREDICTION_COUNT = Counter('churn_predictions_total', 'Total number of churn predictions', ['result']) PREDICTION_LATENCY = Histogram('churn_prediction_latency_seconds', 'Churn prediction latency in seconds') MODEL_ACCURACY = Gauge('churn_model_accuracy', 'Current churn model accuracy') # 기본 정확도 설정 (모니터링 시스템에서 주기적으로 업데이트됨) MODEL_ACCURACY.set(0.85) # FastAPI 앱 초기화 app = FastAPI(title=\"Customer Churn Prediction API\") # 요청 및 응답 모델 class CustomerFeatures(BaseModel): customer_id: str subscription_length: int monthly_charges: float total_charges: float contract_type: str payment_method: str tech_support_calls: int last_active_days: int class PredictionResponse(BaseModel): customer_id: str churn_probability: float churn_risk_level: str model_version: str prediction_id: str prediction_time: str # 모델 로드 함수 def load_model(): \"\"\"MLflow에서 최신 모델 로드\"\"\" try: # 모델 레지스트리에서 'Production' 단계의 모델 로드 model = mlflow.pyfunc.load_model(\"models:/customer_churn_predictor/Production\") logger.info(\"Successfully loaded churn prediction model\") return model except Exception as e: logger.error(f\"Error loading model: {e}\") # 백업 방법: 로컬에 저장된 모델 파일 로드 with open('models/churn_model_backup.pkl', 'rb') as f: model = pickle.load(f) logger.info(\"Loaded backup model\") return model # 의존성 주입을 위한 모델 제공자 def get_model(): \"\"\"싱글톤 패턴으로 모델 제공\"\"\" if not hasattr(get_model, \"model\"): get_model.model = load_model() return get_model.model # 전처리 함수 def preprocess_features(customer: CustomerFeatures) -\u003e pd.DataFrame: \"\"\"요청 데이터 전처리\"\"\" # 데이터 프레임 변환 data = pd.DataFrame([customer.dict()]) # 1. 범주형 변수 처리 contract_types = ['Monthly', 'One year', 'Two year'] payment_methods = ['Credit card', 'Bank transfer', 'Electronic check'] # 원-핫 인코딩 for contract in contract_types[1:]: # 첫 번째 카테고리는 기준으로 사용 data[f'contract_type_{contract}'] = (data['contract_type'] == contract).astype(int) for method in payment_methods[1:]: data[f'payment_method_{method}'] = (data['payment_method'] == method).astype(int) # 2. 새로운 특성 생성 data['avg_monthly_charge'] = data['total_charges'] / data['subscription_length'] data['inactive_ratio'] = data['last_active_days'] / 30 # 3. 원본 범주형 변수 제거 data = data.drop(['contract_type', 'payment_method'], axis=1) # 고객 ID 별도 저장 customer_id = data['customer_id'] data = data.drop(['customer_id'], axis=1) return data, customer_id # 예측 결과를 Redis에 캐싱하는 함수 def cache_prediction(customer_id: str, prediction: dict): \"\"\"예측 결과를 Redis에 캐싱\"\"\" try: # 12시간 유효기간으로 캐싱 redis_client.setex( f\"churn_prediction:{customer_id}\", 43200, # 12시간 (초 단위) json.dumps(prediction) ) except Exception as e: logger.warning(f\"Failed to cache prediction: {e}\") # 캐시된 예측 결과 조회 함수 def get_cached_prediction(customer_id: str) -\u003e Optional[dict]: \"\"\"Redis에서 캐시된 예측 결과 조회\"\"\" try: cached = redis_client.get(f\"churn_prediction:{customer_id}\") if cached: return json.loads(cached) return None except Exception as e: logger.warning(f\"Failed to retrieve cached prediction: {e}\") return None # 마케팅 시스템에 알림 전송 함수 (백그라운드 작업) def send_to_marketing_system(customer_id: str, churn_probability: float, risk_level: str): \"\"\"고위험 고객 정보를 마케팅 시스템에 전송\"\"\" try: # 실제 구현에서는 외부 시스템 API 호출 logger.info(f\"Sending alert to marketing system for customer {customer_id}\") # requests.post(\"https://marketing-api.example.com/churn-alerts\", # json={ # \"customer_id\": customer_id, # \"churn_probability\": churn_probability, # \"risk_level\": risk_level, # \"timestamp\": datetime.now().isoformat() # }, # headers={\"Authorization\": \"Bearer \" + API_KEY} # ) except Exception as e: logger.error(f\"Failed to send alert to marketing system: {e}\") @app.get(\"/\") def read_root(): return {\"message\": \"Customer Churn Prediction API\"} @app.get(\"/health\") def health_check(): \"\"\"헬스 체크 엔드포인트\"\"\" try: # 모델이 로드되었는지 확인 model = get_model() # Redis 연결 확인 redis_client.ping() return {\"status\": \"healthy\", \"model_loaded\": True, \"redis_connected\": True} except Exception as e: logger.error(f\"Health check failed: {e}\") return {\"status\": \"unhealthy\", \"error\": str(e)}, 503 @app.post(\"/predict\", response_model=PredictionResponse) async def predict_churn( customer: CustomerFeatures, background_tasks: BackgroundTasks, model=Depends(get_model) ): \"\"\"고객 이탈 예측 엔드포인트\"\"\" prediction_start_time = time.time() try: # 1. 캐시된 결과 확인 cached_prediction = get_cached_prediction(customer.customer_id) if cached_prediction: logger.info(f\"Returning cached prediction for customer {customer.customer_id}\") # 캐시된 결과를 반환하되, 예측 시간은 현재 시간으로 업데이트 cached_prediction[\"prediction_time\"] = datetime.now().isoformat() return PredictionResponse(**cached_prediction) # 2. 특성 전처리 features, customer_id = preprocess_features(customer) # 3. 예측 수행 churn_probability = model.predict(features)[0] # 4. 결과 후처리 risk_level = \"high\" if churn_probability \u003e 0.7 else \"medium\" if churn_probability \u003e 0.3 else \"low\" # 5. 응답 생성 prediction_id = f\"pred_{int(time.time())}_{customer.customer_id}\" response = { \"customer_id\": customer.customer_id, \"churn_probability\": float(churn_probability), \"churn_risk_level\": risk_level, \"model_version\": getattr(model, 'version', 'unknown'), \"prediction_id\": prediction_id, \"prediction_time\": datetime.now().isoformat() } # 6. 결과 캐싱 background_tasks.add_task(cache_prediction, customer.customer_id, response) # 7. 고위험 고객 마케팅 알림 if risk_level == \"high\": background_tasks.add_task( send_to_marketing_system, customer.customer_id, churn_probability, risk_level ) # 8. 메트릭 업데이트 prediction_label = \"churn\" if churn_probability \u003e 0.5 else \"no_churn\" PREDICTION_COUNT.labels(result=prediction_label).inc() # 9. 응답 반환 return PredictionResponse(**response) except Exception as e: logger.error(f\"Prediction error: {e}\") raise HTTPException(status_code=500, detail=str(e)) finally: # 지연 시간 측정 및 기록 prediction_time = time.time() - prediction_start_time PREDICTION_LATENCY.observe(prediction_time) # 애플리케이션 시작 시 필요한 초기화 @app.on_event(\"startup\") async def startup_event(): \"\"\"애플리케이션 시작 시 실행되는 작업\"\"\" logger.info(\"Starting Churn Prediction API\") # 모델 미리 로드 get_model() # 애플리케이션 종료 시 정리 작업 @app.on_event(\"shutdown\") async def shutdown_event(): \"\"\"애플리케이션 종료 시 실행되는 작업\"\"\" logger.info(\"Shutting down Churn Prediction API\") 모니터링 및 재훈련 파이프라인 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 # 모델 모니터링 및 재훈련 파이프라인 예시 코드 import pandas as pd import numpy as np from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score, roc_auc_score from scipy.stats import ks_2samp import mlflow import mlflow.sklearn from mlflow.tracking import MlflowClient import logging import time from datetime import datetime, timedelta import schedule import requests import json import os # 로깅 설정 logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(name)s - %(levelname)s - %(message)s') logger = logging.getLogger(__name__) # MLflow 설정 mlflow.set_tracking_uri(\"http://localhost:5000\") client = MlflowClient() model_name = \"customer_churn_predictor\" # 알림 설정 SLACK_WEBHOOK_URL = os.getenv(\"SLACK_WEBHOOK_URL\") EMAIL_API_URL = os.getenv(\"EMAIL_API_URL\") EMAIL_API_KEY = os.getenv(\"EMAIL_API_KEY\") TEAM_EMAIL = \"ai-team@example.com\" def load_reference_data(): \"\"\"기준 데이터 로드\"\"\" try: # 기준 데이터 경로 reference_features_path = \"data/reference/customer_features.csv\" reference_predictions_path = \"data/reference/model_predictions.csv\" # 기준 특성 데이터 로드 reference_features = pd.read_csv(reference_features_path) # 기준 예측 및 실제 결과 로드 reference_predictions = pd.read_csv(reference_predictions_path) return reference_features, reference_predictions except Exception as e: logger.error(f\"Error loading reference data: {e}\") raise def load_production_data(days=7): \"\"\"최근 프로덕션 데이터 로드\"\"\" try: # 최근 7일간의 데이터 로드 end_date = datetime.now() start_date = end_date - timedelta(days=days) # 실제 구현에서는 데이터베이스 쿼리 또는 로그 분석 시스템에서 데이터 추출 # 예시를 위한 가상 데이터 경로 production_data_path = f\"data/production/customer_data_{start_date.strftime('%Y%m%d')}_{end_date.strftime('%Y%m%d')}.csv\" # 프로덕션 데이터 로드 production_data = pd.read_csv(production_data_path) return production_data except Exception as e: logger.error(f\"Error loading production data: {e}\") raise def detect_data_drift(reference_data, production_data, threshold=0.05): \"\"\"데이터 드리프트 감지\"\"\" try: drift_detected = False drift_features = [] # 수치형 특성에 대해 Kolmogorov-Smirnov 테스트 수행 numeric_features = ['subscription_length', 'monthly_charges', 'total_charges', 'tech_support_calls', 'last_active_days'] for feature in numeric_features: if feature in reference_data.columns and feature in production_data.columns: # KS 테스트로 두 분포의 차이 검정 ks_stat, p_value = ks_2samp(reference_data[feature].dropna(), production_data[feature].dropna()) logger.info(f\"KS test for {feature}: statistic={ks_stat:f}, p-value={p_value:f}\") # p-value가 임계값보다 작으면 드리프트 감지 if p_value \u003c threshold: drift_detected = True drift_features.append({ 'feature': feature, 'ks_statistic': ks_stat, 'p_value': p_value }) # 범주형 특성에 대한 분포 비교 categorical_features = [col for col in reference_data.columns if col.startswith('contract_type_') or col.startswith('payment_method_')] for feature in categorical_features: if feature in reference_data.columns and feature in production_data.columns: # 범주 비율 계산 ref_ratio = reference_data[feature].mean() prod_ratio = production_data[feature].mean() # 비율 차이가 임계값보다 크면 드리프트 감지 if abs(ref_ratio - prod_ratio) \u003e threshold: drift_detected = True drift_features.append({ 'feature': feature, 'reference_ratio': ref_ratio, 'production_ratio': prod_ratio, 'difference': abs(ref_ratio - prod_ratio) }) return drift_detected, drift_features except Exception as e: logger.error(f\"Error detecting data drift: {e}\") raise def evaluate_model_performance(predictions_df): \"\"\"모델 성능 평가\"\"\" try: # 예측 및 실제 결과 추출 y_true = predictions_df['actual_churn'] y_pred = predictions_df['predicted_churn'] y_prob = predictions_df['churn_probability'] # 평가 메트릭 계산 metrics = { 'accuracy': accuracy_score(y_true, y_pred), 'precision': precision_score(y_true, y_pred), 'recall': recall_score(y_true, y_pred), 'f1_score': f1_score(y_true, y_pred), 'roc_auc': roc_auc_score(y_true, y_prob) } logger.info(f\"Model performance metrics: {metrics}\") return metrics except Exception as e: logger.error(f\"Error evaluating model performance: {e}\") raise def detect_performance_drift(baseline_metrics, current_metrics, threshold=0.05): \"\"\"성능 드리프트 감지\"\"\" try: performance_drift = False drift_metrics = [] for metric, value in current_metrics.items(): if metric in baseline_metrics: diff = baseline_metrics[metric] - value # 성능 저하가 임계값보다 크면 드리프트 감지 if diff \u003e threshold: performance_drift = True drift_metrics.append({ 'metric': metric, 'baseline': baseline_metrics[metric], 'current': value, 'difference': diff }) return performance_drift, drift_metrics except Exception as e: logger.error(f\"Error detecting performance drift: {e}\") raise def send_alert(title, message, level='info'): \"\"\"알림 전송\"\"\" try: # Slack 웹훅으로 알림 전송 if SLACK_WEBHOOK_URL: slack_payload = { 'text': f\"*{title}*\\n{message}\", 'username': 'Model Monitoring Bot', 'icon_emoji': ':robot_face:' if level == 'info' else ':warning:' } requests.post(SLACK_WEBHOOK_URL, json=slack_payload) # 심각한 알림은 이메일로도 전송 if level == 'critical' and EMAIL_API_URL and EMAIL_API_KEY: email_payload = { 'to': TEAM_EMAIL, 'subject': f\"[URGENT] {title}\", 'body': message, 'api_key': EMAIL_API_KEY } requests.post(EMAIL_API_URL, json=email_payload) logger.info(f\"Alert sent: {title}\") except Exception as e: logger.error(f\"Error sending alert: {e}\") def trigger_model_retraining(): \"\"\"모델 재훈련 트리거\"\"\" try: # 재훈련 파이프라인 API 호출 retraining_api_url = \"http://airflow-api:8080/api/v1/dags/customer_churn_retraining/dagRuns\" payload = { 'conf': {'triggered_by': 'monitoring_system'} } headers = { 'Content-Type': 'application/json', 'Authorization': f\"Bearer {os.getenv('AIRFLOW_API_KEY')}\" } response = requests.post(retraining_api_url, json=payload, headers=headers) response.raise_for_status() run_id = response.json()['dag_run_id'] logger.info(f\"Model retraining triggered successfully. Run ID: {run_id}\") # 알림 전송 send_alert( \"Model Retraining Triggered\", f\"Customer churn model retraining has been triggered due to detected drift. Run ID: {run_id}\" ) return run_id except Exception as e: logger.error(f\"Error triggering model retraining: {e}\") send_alert( \"Model Retraining Failed\", f\"Failed to trigger customer churn model retraining: {str(e)}\", level='critical' ) raise def run_monitoring_pipeline(): \"\"\"모니터링 파이프라인 실행\"\"\" try: logger.info(\"Starting model monitoring pipeline…\") # 1. 기준 데이터 로드 reference_features, reference_predictions = load_reference_data() # 2. 프로덕션 데이터 로드 production_data = load_production_data(days=7) # 3. 데이터 드리프트 감지 data_drift_detected, drift_features = detect_data_drift(reference_features, production_data) if data_drift_detected: logger.warning(\"Data drift detected!\") drift_message = \"Data drift detected in the following features:\\n\" for feature in drift_features: drift_message += f\"- {feature['feature']}\\n\" send_alert(\"Data Drift Detected\", drift_message, level='warning') # 4. 현재 프로덕션 모델 성능 평가 # 실제 구현에서는 라벨이 지연되어 도착할 수 있음을 고려해야 함 production_predictions = pd.read_csv(\"data/production/recent_predictions_with_actuals.csv\") current_metrics = evaluate_model_performance(production_predictions) # 5. 기준 성능 지표 로드 latest_model_version = client.get_latest_versions(model_name, stages=[\"Production\"])[0] run_id = latest_model_version.run_id run = client.get_run(run_id) baseline_metrics = {k: v for k, v in run.data.metrics.items() if k in ['accuracy', 'precision', 'recall', 'f1_score', 'roc_auc']} # 6. 성능 드리프트 감지 performance_drift, drift_metrics = detect_performance_drift(baseline_metrics, current_metrics) if performance_drift: logger.warning(\"Performance drift detected!\") drift_message = \"Model performance drift detected:\\n\" for metric in drift_metrics: drift_message += f\"- {metric['metric']}: {metric['baseline']:f} → {metric['current']:f} (Δ {metric['difference']:f})\\n\" send_alert(\"Performance Drift Detected\", drift_message, level='warning') # 7. 재훈련 필요 여부 결정 retrain_threshold = 0.1 # 성능 10% 이상 저하 시 재훈련 significant_performance_drift = any(m['difference'] \u003e retrain_threshold for m in drift_metrics) if performance_drift else False if data_drift_detected and significant_performance_drift: logger.warning(\"Significant drift detected. Triggering model retraining…\") trigger_model_retraining() elif data_drift_detected or significant_performance_drift: logger.info(\"Drift detected but not significant enough for automatic retraining.\") send_alert( \"Drift Detected - Manual Review Required\", \"Data or performance drift has been detected but is not significant enough for automatic retraining. Please review the monitoring dashboard.\", level='info' ) else: logger.info(\"No significant drift detected. Model is performing well.\") # 8. 결과 저장 monitoring_results = { 'timestamp': datetime.now().isoformat(), 'data_drift_detected': data_drift_detected, 'performance_drift_detected': performance_drift, 'current_metrics': current_metrics, 'baseline_metrics': baseline_metrics, 'retrain_triggered': data_drift_detected and significant_performance_drift } with open(f\"logs/monitoring_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json\", 'w') as f: json.dump(monitoring_results, f, indent=2) logger.info(\"Model monitoring pipeline completed successfully.\") except Exception as e: logger.error(f\"Error in monitoring pipeline: {e}\") send_alert( \"Monitoring Pipeline Error\", f\"The model monitoring pipeline encountered an error: {str(e)}\", level='critical' ) raise def schedule_monitoring(): \"\"\"모니터링 작업 스케줄링\"\"\" # 매일 자정에 모니터링 파이프라인 실행 schedule.every().day.at(\"00:00\").do(run_monitoring_pipeline) # 매주 월요일에 상세 보고서 생성 # schedule.every().monday.at(\"09:00\").do(generate_weekly_report) logger.info(\"Monitoring tasks scheduled.\") while True: schedule.run_pending() time.sleep(60) # 1분마다 스케줄 확인 if __name__ == \"__main__\": # 스크립트 직접 실행 시 즉시 실행 후 스케줄링 run_monitoring_pipeline() schedule_monitoring() 실제 AI 엔지니어링 워크플로우 위에서 살펴본 고객 이탈 예측 시스템 예시를 통해 AI 엔지니어링의 전체 워크플로우를 이해할 수 있다.\n이 워크플로우는 다음과 같은 단계로 구성된다:\n문제 정의 및 범위 설정 비즈니스 문제 이해 및 AI 접근 방식 결정 성공 기준 및 제약 조건 설정 데이터 파이프라인 구축 데이터 소스 연결 및 수집 자동화 데이터 검증 및 전처리 단계 구현 특성 엔지니어링 및 데이터 변환 모델 개발 및 실험 다양한 모델 아키텍처 및 알고리즘 실험 하이퍼파라미터 최적화 및 교차 검증 실험 추적 및 버전 관리 모델 배포 인프라 구축 모델 패키징 및 컨테이너화 API 설계 및 개발 확장성 및 성능 최적화 CI/CD 파이프라인 구축 코드 및 모델 테스트 자동화 지속적 통합 및 배포 워크플로우 설정 환경별 설정 관리 모니터링 시스템 구축 모델 성능 메트릭 정의 및 추적 데이터 드리프트 감지 메커니즘 구현 알림 및 보고 시스템 설정 피드백 루프 및 재훈련 모델 성능 저하 감지 시 자동 재훈련 A/B 테스트를 통한 모델 업데이트 검증 지속적인 모델 개선 AI 엔지니어링의 미래 동향 자동화 및 Low-Code/No-Code 솔루션\nAutoML의 발전: 모델 선택, 하이퍼파라미터 최적화, 특성 엔지니어링의 자동화 ML 파이프라인 자동화: 데이터 준비부터 모델 배포까지 자동화된 파이프라인 Low-Code AI 플랫폼: 코딩 지식이 적은 사용자도 AI 시스템을 구축할 수 있는 도구 분산 및 연합 학습\n에지 AI: 에지 디바이스에서의 AI 모델 실행 및 학습 연합 학습(Federated Learning): 중앙 데이터 저장소 없이 분산된 디바이스에서 학습 프라이버시 보존 AI: 개인 정보를 보호하면서 학습 및 추론 생성형 AI 및 대규모 언어 모델\n생성형 AI 파이프라인: 텍스트, 이미지, 오디오 생성 모델의 개발 및 배포 LLM 응용 개발: 대규모 언어 모델을 활용한 애플리케이션 개발 파인튜닝 및 추론 최적화: 대규모 모델의 효율적인 맞춤화 및 추론 책임 있는 AI 엔지니어링\nAI 거버넌스: AI 시스템의 개발 및 배포를 관리하는 프레임워크 공정성 및 편향 감지: AI 시스템의 공정성을 보장하기 위한 방법론 설명 가능한 AI(XAI): AI 모델의 결정을 이해하고 설명하는 기법 지속 가능한 AI: 환경적 영향을 최소화하는 AI 시스템 개발 AI 시스템 보안\n적대적 공격 방어: 모델 강인성 향상 및 적대적 공격 방어 AI 모델 도난 방지: 모델 지적 재산권 보호 데이터 누출 감지: 모델을 통한 훈련 데이터 유출 방지 참고 및 출처 Roadmap Roadmap - AI Engineer\n학습 로드맵 📘 이론적으로 꼭 알아야 할 내용 (Foundation for AI System Design) 영역 내용 설명 ✅ AI 시스템 설계 원칙 AI를 하나의 엔지니어링 시스템으로 접근하는 방법론 성능, 확장성, 신뢰성, 유지보수성을 고려한 설계 ✅ 머신러닝/딥러닝 기초 지도학습, 비지도학습, 강화학습 각 알고리즘의 구조, 한계, 적용 조건 등 이해 ✅ 데이터 엔지니어링 기초 ETL, 데이터 전처리, 피처 엔지니어링 좋은 AI는 좋은 데이터에서 출발한다는 기본 원리 ✅ 모델 서빙 및 배포 전략 온라인/오프라인 서빙, REST API, ONNX 등 모델을 실제 서비스에 적용하는 전략적 접근 ✅ AI 윤리 및 안전성 바이어스, 설명가능성, 책임 있는 AI 신뢰받는 AI 시스템을 위한 필수 요소 ✅ 소프트웨어 아키텍처 이론 모듈화, 마이크로서비스, 이벤트 기반 구조 AI 시스템의 확장성과 유지보수성 확보 ✅ 실험 관리와 버전 관리 실험 추적, 하이퍼파라미터 기록, 모델 버전 관리 reproducibility 확보를 위한 원칙 ✅ MLOps 원리 DevOps + ML 모델 운영 관리 CI/CD + 모델 학습/배포/모니터링 자동화 이론 📌 목적: AI를 “개발 가능한 시스템\"으로 설계할 수 있는 기초 확보\n🛠️ 실무적으로 꼭 알아야 할 내용 (Implementation \u0026 Operation) 영역 내용 설명 ✅ Python 기반 ML 실습 scikit-learn, PyTorch, TensorFlow 등 모델 학습/테스트/튜닝 실습 역량 ✅ 데이터 파이프라인 구축 Pandas, SQL, Airflow, Spark 데이터 수집/가공/저장 자동화 구축 ✅ 모델 배포 실습 FastAPI, Docker, TorchServe RESTful API 기반 실시간 모델 서빙 구현 ✅ 실험 관리 도구 사용 MLflow, Weights \u0026 Biases 실험/버전 관리, 성능 트래킹 능력 확보 ✅ MLOps 파이프라인 구성 Kubeflow, SageMaker, Vertex AI 등 모델 학습/배포/모니터링 자동화 실습 ✅ CI/CD 적용 GitHub Actions, Jenkins, Docker Compose 코드/모델의 배포 자동화 및 테스트 연동 ✅ 모니터링 \u0026 알림 시스템 Prometheus, Grafana, 로그 추적 모델 드리프트 감지 및 운영 안정성 확보 ✅ API 연동 및 시스템 통합 모델 결과를 프론트엔드/백엔드와 통합 실제 제품 서비스에 모델 내장하는 실무 능력 📌 목적: 모델 개발 → 배포 → 운영까지 엔드 투 엔드로 시스템을 구현하는 역량 확보\n📐 이론 ↔ 실무 연결 예시 이론 요소 실무 연결 MLOps 원리 Kubeflow + MLflow를 활용한 자동 학습/배포 파이프라인 구성 모델 서빙 전략 Dockerized REST API로 모델 서빙 후, API Gateway로 통합 AI 윤리 Explainable AI 도구(LIME, SHAP)를 사용해 판단 근거 시각화 데이터 엔지니어링 Airflow + Spark로 대용량 데이터 파이프라인 구성 실험 관리 W\u0026B를 통해 실험 기록, 비교, 시각화 자동화 적용 🧭 추천 학습 순서 (IT 개발자 입장 기준) AI 엔지니어링 개요 및 구성요소 파악\n(설계 → 개발 → 배포 → 운영 전체 흐름 이해)\n기초 ML 알고리즘 \u0026 Python 기반 모델 구현 학습\n(scikit-learn → PyTorch 실습 중심)\n데이터 파이프라인 및 전처리 자동화 학습\nFastAPI + Docker 기반 모델 서빙 구조 실습\nMLflow/W\u0026B 등 실험 관리 적용 및 버전 관리\nMLOps 구성 및 CI/CD 적용\n모니터링 \u0026 안전성 도입 → AI 시스템 통합 운영\n🏁 학습의 궁극적인 목적 “AI 모델\"을 만드는 것을 넘어서,\n**“현실 문제를 해결할 수 있는 완전한 AI 제품을 만들고 운영할 수 있는 개발자”**가 되는 것\n","wordCount":"7114","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2025-01-31T12:08:00Z","dateModified":"2025-01-31T12:08:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/ai-and-machine-learning/ai-engineering/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>Computer Science and Engineering</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/ai-and-machine-learning/>AI and Machine Learning</a></div><h1 class="post-title entry-hint-parent">AI Engineering</h1><div class=post-description>AI 엔지니어링(Artificial Intelligence Engineering)은 인공지능 시스템을 설계, 개발, 배포 및 유지보수하는 체계적인 접근 방식이다. 이는 단순히 AI 모델을 훈련하는 것을 넘어서, 실제 비즈니스 환경에서 안정적으로 작동하는 AI 솔루션을 구축하는 전체 과정을 포함한다.</div><div class=post-meta><span title='2025-01-31 12:08:00 +0000 UTC'>January 31, 2025</span>&nbsp;·&nbsp;34 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/AI%20and%20Machine%20Learning/AI-Engineering.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#ai-engineering>AI Engineering</a><ul><li><a href=#ai-엔지니어링의-필요성>AI 엔지니어링의 필요성</a></li><li><a href=#ai-엔지니어링의-핵심-구성-요소>AI 엔지니어링의 핵심 구성 요소</a></li><li><a href=#ai-엔지니어링의-필수-기술과-도구>AI 엔지니어링의 필수 기술과 도구</a></li><li><a href=#ai-엔지니어링-프로세스>AI 엔지니어링 프로세스</a></li><li><a href=#ai-엔지니어링의-도전-과제-및-모범-사례>AI 엔지니어링의 도전 과제 및 모범 사례</a></li><li><a href=#ai-엔지니어링-프로젝트-예시>AI 엔지니어링 프로젝트 예시</a></li><li><a href=#ai-엔지니어링의-미래-동향>AI 엔지니어링의 미래 동향</a></li></ul></li><li><a href=#참고-및-출처>참고 및 출처</a></li><li><a href=#roadmap>Roadmap</a><ul><li><a href=#학습-로드맵>학습 로드맵</a></li><li><a href=#-추천-학습-순서-it-개발자-입장-기준>🧭 추천 학습 순서 (IT 개발자 입장 기준)</a></li><li><a href=#-학습의-궁극적인-목적>🏁 학습의 궁극적인 목적</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=ai-engineering>AI Engineering<a hidden class=anchor aria-hidden=true href=#ai-engineering>#</a></h2><p>AI 엔지니어링(Artificial Intelligence Engineering)은 인공지능 시스템을 설계, 개발, 배포 및 유지보수하는 체계적인 접근 방식이다. 이는 단순히 AI 모델을 훈련하는 것을 넘어서, 실제 비즈니스 환경에서 안정적으로 작동하는 AI 솔루션을 구축하는 전체 과정을 포함한다.</p><p>기존의 소프트웨어 엔지니어링이 소프트웨어 시스템을 개발하는 원칙과 방법론을 다룬다면, AI 엔지니어링은 여기에 데이터 관리, 모델 훈련, 불확실성 처리, 지속적인 학습 등 AI 시스템 특유의 측면을 추가한다.<br>AI 엔지니어링은 실험실에서 개발된 모델이 실제 환경에서 가치를 창출할 수 있도록 다리를 놓는 역할을 한다.</p><p>AI 엔지니어링은 연구 환경에서 개발된 AI 모델을 실제 비즈니스 환경에서 가치를 창출하는 운영 시스템으로 전환하는 핵심 분야이다. 이는 데이터 엔지니어링, 모델 개발, MLOps, 모니터링 및 피드백 루프를 포함하는 종합적인 접근 방식을 필요로 한다.</p><h3 id=ai-엔지니어링의-필요성>AI 엔지니어링의 필요성<a hidden class=anchor aria-hidden=true href=#ai-엔지니어링의-필요성>#</a></h3><p>AI 시스템은 전통적인 소프트웨어 시스템과 몇 가지 중요한 차이점이 있다:</p><ol><li><strong>데이터 중심</strong>: AI 시스템은 코드뿐만 아니라 데이터에 의해 동작이 결정된다.</li><li><strong>비결정적 동작</strong>: 같은 입력에 대해 항상 동일한 출력을 보장하지 않을 수 있다.</li><li><strong>지속적 학습 필요</strong>: 시간이 지남에 따라 데이터가 변하면 모델도 업데이트되어야 한다.</li><li><strong>해석과 설명 과제</strong>: 모델의 결정을 이해하고 설명하는 것이 어려울 수 있다.</li></ol><p>이러한 특성으로 인해, AI 시스템을 개발하고 운영하기 위한 별도의 엔지니어링 접근 방식이 필요하게 되었다.</p><h3 id=ai-엔지니어링의-핵심-구성-요소>AI 엔지니어링의 핵심 구성 요소<a hidden class=anchor aria-hidden=true href=#ai-엔지니어링의-핵심-구성-요소>#</a></h3><p>AI 엔지니어링은 다음과 같은 핵심 영역으로 구성된다:</p><h4 id=데이터-엔지니어링>데이터 엔지니어링<a hidden class=anchor aria-hidden=true href=#데이터-엔지니어링>#</a></h4><p>AI 시스템의 기반이 되는 데이터를 수집, 처리, 저장하는 과정을 관리한다.</p><ul><li><strong>데이터 수집</strong>: 다양한 소스에서 데이터를 수집하는 파이프라인 구축</li><li><strong>데이터 전처리</strong>: 결측치 처리, 정규화, 특성 추출 등의 과정 자동화</li><li><strong>데이터 저장 및 관리</strong>: 효율적인 데이터 저장소 설계 및 버전 관리</li><li><strong>데이터 품질 관리</strong>: 일관성, 정확성, 완전성 등 데이터 품질 보장</li></ul><p>예시 코드 - 데이터 파이프라인 구축:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21>21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22>22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23>23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24>24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25>25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26>26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27>27</a>
</span><span class=lnt id=hl-0-28><a class=lnlinks href=#hl-0-28>28</a>
</span><span class=lnt id=hl-0-29><a class=lnlinks href=#hl-0-29>29</a>
</span><span class=lnt id=hl-0-30><a class=lnlinks href=#hl-0-30>30</a>
</span><span class=lnt id=hl-0-31><a class=lnlinks href=#hl-0-31>31</a>
</span><span class=lnt id=hl-0-32><a class=lnlinks href=#hl-0-32>32</a>
</span><span class=lnt id=hl-0-33><a class=lnlinks href=#hl-0-33>33</a>
</span><span class=lnt id=hl-0-34><a class=lnlinks href=#hl-0-34>34</a>
</span><span class=lnt id=hl-0-35><a class=lnlinks href=#hl-0-35>35</a>
</span><span class=lnt id=hl-0-36><a class=lnlinks href=#hl-0-36>36</a>
</span><span class=lnt id=hl-0-37><a class=lnlinks href=#hl-0-37>37</a>
</span><span class=lnt id=hl-0-38><a class=lnlinks href=#hl-0-38>38</a>
</span><span class=lnt id=hl-0-39><a class=lnlinks href=#hl-0-39>39</a>
</span><span class=lnt id=hl-0-40><a class=lnlinks href=#hl-0-40>40</a>
</span><span class=lnt id=hl-0-41><a class=lnlinks href=#hl-0-41>41</a>
</span><span class=lnt id=hl-0-42><a class=lnlinks href=#hl-0-42>42</a>
</span><span class=lnt id=hl-0-43><a class=lnlinks href=#hl-0-43>43</a>
</span><span class=lnt id=hl-0-44><a class=lnlinks href=#hl-0-44>44</a>
</span><span class=lnt id=hl-0-45><a class=lnlinks href=#hl-0-45>45</a>
</span><span class=lnt id=hl-0-46><a class=lnlinks href=#hl-0-46>46</a>
</span><span class=lnt id=hl-0-47><a class=lnlinks href=#hl-0-47>47</a>
</span><span class=lnt id=hl-0-48><a class=lnlinks href=#hl-0-48>48</a>
</span><span class=lnt id=hl-0-49><a class=lnlinks href=#hl-0-49>49</a>
</span><span class=lnt id=hl-0-50><a class=lnlinks href=#hl-0-50>50</a>
</span><span class=lnt id=hl-0-51><a class=lnlinks href=#hl-0-51>51</a>
</span><span class=lnt id=hl-0-52><a class=lnlinks href=#hl-0-52>52</a>
</span><span class=lnt id=hl-0-53><a class=lnlinks href=#hl-0-53>53</a>
</span><span class=lnt id=hl-0-54><a class=lnlinks href=#hl-0-54>54</a>
</span><span class=lnt id=hl-0-55><a class=lnlinks href=#hl-0-55>55</a>
</span><span class=lnt id=hl-0-56><a class=lnlinks href=#hl-0-56>56</a>
</span><span class=lnt id=hl-0-57><a class=lnlinks href=#hl-0-57>57</a>
</span><span class=lnt id=hl-0-58><a class=lnlinks href=#hl-0-58>58</a>
</span><span class=lnt id=hl-0-59><a class=lnlinks href=#hl-0-59>59</a>
</span><span class=lnt id=hl-0-60><a class=lnlinks href=#hl-0-60>60</a>
</span><span class=lnt id=hl-0-61><a class=lnlinks href=#hl-0-61>61</a>
</span><span class=lnt id=hl-0-62><a class=lnlinks href=#hl-0-62>62</a>
</span><span class=lnt id=hl-0-63><a class=lnlinks href=#hl-0-63>63</a>
</span><span class=lnt id=hl-0-64><a class=lnlinks href=#hl-0-64>64</a>
</span><span class=lnt id=hl-0-65><a class=lnlinks href=#hl-0-65>65</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Apache Airflow를 사용한 데이터 수집 파이프라인 예시</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow</span> <span class=kn>import</span> <span class=n>DAG</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.operators.python_operator</span> <span class=kn>import</span> <span class=n>PythonOperator</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span><span class=p>,</span> <span class=n>timedelta</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 기본 인자 설정</span>
</span></span><span class=line><span class=cl><span class=n>default_args</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;owner&#39;</span><span class=p>:</span> <span class=s1>&#39;ai_engineer&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;depends_on_past&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;start_date&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=p>(</span><span class=mi>2023</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;email_on_failure&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;retries&#39;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;retry_delay&#39;</span><span class=p>:</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>minutes</span><span class=o>=</span><span class=mi>5</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># DAG 정의</span>
</span></span><span class=line><span class=cl><span class=n>dag</span> <span class=o>=</span> <span class=n>DAG</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;data_collection_pipeline&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>default_args</span><span class=o>=</span><span class=n>default_args</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=o>=</span><span class=s1>&#39;데이터 수집 및 전처리 파이프라인&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>schedule_interval</span><span class=o>=</span><span class=n>timedelta</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 데이터 수집 함수</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>collect_data</span><span class=p>(</span><span class=o>**</span><span class=n>context</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 데이터 소스에서 데이터 수집 로직</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;데이터 수집 중…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 수집된 데이터 반환</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 데이터 전처리 함수</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>preprocess_data</span><span class=p>(</span><span class=o>**</span><span class=n>context</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 데이터 전처리 로직</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;데이터 전처리 중…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 전처리된 데이터 반환</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 데이터 검증 함수</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>validate_data</span><span class=p>(</span><span class=o>**</span><span class=n>context</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 데이터 품질 검증 로직</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;데이터 검증 중…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 검증 결과 반환</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 태스크 생성 및 연결</span>
</span></span><span class=line><span class=cl><span class=n>collect_task</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>task_id</span><span class=o>=</span><span class=s1>&#39;collect_data&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>python_callable</span><span class=o>=</span><span class=n>collect_data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>provide_context</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>dag</span><span class=o>=</span><span class=n>dag</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>preprocess_task</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>task_id</span><span class=o>=</span><span class=s1>&#39;preprocess_data&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>python_callable</span><span class=o>=</span><span class=n>preprocess_data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>provide_context</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>dag</span><span class=o>=</span><span class=n>dag</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>validate_task</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>task_id</span><span class=o>=</span><span class=s1>&#39;validate_data&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>python_callable</span><span class=o>=</span><span class=n>validate_data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>provide_context</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>dag</span><span class=o>=</span><span class=n>dag</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 태스크 의존성 설정</span>
</span></span><span class=line><span class=cl><span class=n>collect_task</span> <span class=o>&gt;&gt;</span> <span class=n>preprocess_task</span> <span class=o>&gt;&gt;</span> <span class=n>validate_task</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=모델-개발-및-훈련>모델 개발 및 훈련<a hidden class=anchor aria-hidden=true href=#모델-개발-및-훈련>#</a></h4><p>AI 모델을 설계하고 최적화하는 과정을 관리한다.</p><ul><li><strong>모델 설계</strong>: 문제에 적합한 알고리즘 및 아키텍처 선택</li><li><strong>하이퍼파라미터 최적화</strong>: 최적의 모델 파라미터 탐색</li><li><strong>모델 평가</strong>: 정확성, 견고성, 공정성 등 다양한 측면에서 모델 평가</li><li><strong>실험 관리</strong>: 모델 실험 추적 및 재현성 보장</li></ul><p>예시 코드 - 모델 훈련 및 실험 추적:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16>16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17>17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18>18</a>
</span><span class=lnt id=hl-1-19><a class=lnlinks href=#hl-1-19>19</a>
</span><span class=lnt id=hl-1-20><a class=lnlinks href=#hl-1-20>20</a>
</span><span class=lnt id=hl-1-21><a class=lnlinks href=#hl-1-21>21</a>
</span><span class=lnt id=hl-1-22><a class=lnlinks href=#hl-1-22>22</a>
</span><span class=lnt id=hl-1-23><a class=lnlinks href=#hl-1-23>23</a>
</span><span class=lnt id=hl-1-24><a class=lnlinks href=#hl-1-24>24</a>
</span><span class=lnt id=hl-1-25><a class=lnlinks href=#hl-1-25>25</a>
</span><span class=lnt id=hl-1-26><a class=lnlinks href=#hl-1-26>26</a>
</span><span class=lnt id=hl-1-27><a class=lnlinks href=#hl-1-27>27</a>
</span><span class=lnt id=hl-1-28><a class=lnlinks href=#hl-1-28>28</a>
</span><span class=lnt id=hl-1-29><a class=lnlinks href=#hl-1-29>29</a>
</span><span class=lnt id=hl-1-30><a class=lnlinks href=#hl-1-30>30</a>
</span><span class=lnt id=hl-1-31><a class=lnlinks href=#hl-1-31>31</a>
</span><span class=lnt id=hl-1-32><a class=lnlinks href=#hl-1-32>32</a>
</span><span class=lnt id=hl-1-33><a class=lnlinks href=#hl-1-33>33</a>
</span><span class=lnt id=hl-1-34><a class=lnlinks href=#hl-1-34>34</a>
</span><span class=lnt id=hl-1-35><a class=lnlinks href=#hl-1-35>35</a>
</span><span class=lnt id=hl-1-36><a class=lnlinks href=#hl-1-36>36</a>
</span><span class=lnt id=hl-1-37><a class=lnlinks href=#hl-1-37>37</a>
</span><span class=lnt id=hl-1-38><a class=lnlinks href=#hl-1-38>38</a>
</span><span class=lnt id=hl-1-39><a class=lnlinks href=#hl-1-39>39</a>
</span><span class=lnt id=hl-1-40><a class=lnlinks href=#hl-1-40>40</a>
</span><span class=lnt id=hl-1-41><a class=lnlinks href=#hl-1-41>41</a>
</span><span class=lnt id=hl-1-42><a class=lnlinks href=#hl-1-42>42</a>
</span><span class=lnt id=hl-1-43><a class=lnlinks href=#hl-1-43>43</a>
</span><span class=lnt id=hl-1-44><a class=lnlinks href=#hl-1-44>44</a>
</span><span class=lnt id=hl-1-45><a class=lnlinks href=#hl-1-45>45</a>
</span><span class=lnt id=hl-1-46><a class=lnlinks href=#hl-1-46>46</a>
</span><span class=lnt id=hl-1-47><a class=lnlinks href=#hl-1-47>47</a>
</span><span class=lnt id=hl-1-48><a class=lnlinks href=#hl-1-48>48</a>
</span><span class=lnt id=hl-1-49><a class=lnlinks href=#hl-1-49>49</a>
</span><span class=lnt id=hl-1-50><a class=lnlinks href=#hl-1-50>50</a>
</span><span class=lnt id=hl-1-51><a class=lnlinks href=#hl-1-51>51</a>
</span><span class=lnt id=hl-1-52><a class=lnlinks href=#hl-1-52>52</a>
</span><span class=lnt id=hl-1-53><a class=lnlinks href=#hl-1-53>53</a>
</span><span class=lnt id=hl-1-54><a class=lnlinks href=#hl-1-54>54</a>
</span><span class=lnt id=hl-1-55><a class=lnlinks href=#hl-1-55>55</a>
</span><span class=lnt id=hl-1-56><a class=lnlinks href=#hl-1-56>56</a>
</span><span class=lnt id=hl-1-57><a class=lnlinks href=#hl-1-57>57</a>
</span><span class=lnt id=hl-1-58><a class=lnlinks href=#hl-1-58>58</a>
</span><span class=lnt id=hl-1-59><a class=lnlinks href=#hl-1-59>59</a>
</span><span class=lnt id=hl-1-60><a class=lnlinks href=#hl-1-60>60</a>
</span><span class=lnt id=hl-1-61><a class=lnlinks href=#hl-1-61>61</a>
</span><span class=lnt id=hl-1-62><a class=lnlinks href=#hl-1-62>62</a>
</span><span class=lnt id=hl-1-63><a class=lnlinks href=#hl-1-63>63</a>
</span><span class=lnt id=hl-1-64><a class=lnlinks href=#hl-1-64>64</a>
</span><span class=lnt id=hl-1-65><a class=lnlinks href=#hl-1-65>65</a>
</span><span class=lnt id=hl-1-66><a class=lnlinks href=#hl-1-66>66</a>
</span><span class=lnt id=hl-1-67><a class=lnlinks href=#hl-1-67>67</a>
</span><span class=lnt id=hl-1-68><a class=lnlinks href=#hl-1-68>68</a>
</span><span class=lnt id=hl-1-69><a class=lnlinks href=#hl-1-69>69</a>
</span><span class=lnt id=hl-1-70><a class=lnlinks href=#hl-1-70>70</a>
</span><span class=lnt id=hl-1-71><a class=lnlinks href=#hl-1-71>71</a>
</span><span class=lnt id=hl-1-72><a class=lnlinks href=#hl-1-72>72</a>
</span><span class=lnt id=hl-1-73><a class=lnlinks href=#hl-1-73>73</a>
</span><span class=lnt id=hl-1-74><a class=lnlinks href=#hl-1-74>74</a>
</span><span class=lnt id=hl-1-75><a class=lnlinks href=#hl-1-75>75</a>
</span><span class=lnt id=hl-1-76><a class=lnlinks href=#hl-1-76>76</a>
</span><span class=lnt id=hl-1-77><a class=lnlinks href=#hl-1-77>77</a>
</span><span class=lnt id=hl-1-78><a class=lnlinks href=#hl-1-78>78</a>
</span><span class=lnt id=hl-1-79><a class=lnlinks href=#hl-1-79>79</a>
</span><span class=lnt id=hl-1-80><a class=lnlinks href=#hl-1-80>80</a>
</span><span class=lnt id=hl-1-81><a class=lnlinks href=#hl-1-81>81</a>
</span><span class=lnt id=hl-1-82><a class=lnlinks href=#hl-1-82>82</a>
</span><span class=lnt id=hl-1-83><a class=lnlinks href=#hl-1-83>83</a>
</span><span class=lnt id=hl-1-84><a class=lnlinks href=#hl-1-84>84</a>
</span><span class=lnt id=hl-1-85><a class=lnlinks href=#hl-1-85>85</a>
</span><span class=lnt id=hl-1-86><a class=lnlinks href=#hl-1-86>86</a>
</span><span class=lnt id=hl-1-87><a class=lnlinks href=#hl-1-87>87</a>
</span><span class=lnt id=hl-1-88><a class=lnlinks href=#hl-1-88>88</a>
</span><span class=lnt id=hl-1-89><a class=lnlinks href=#hl-1-89>89</a>
</span><span class=lnt id=hl-1-90><a class=lnlinks href=#hl-1-90>90</a>
</span><span class=lnt id=hl-1-91><a class=lnlinks href=#hl-1-91>91</a>
</span><span class=lnt id=hl-1-92><a class=lnlinks href=#hl-1-92>92</a>
</span><span class=lnt id=hl-1-93><a class=lnlinks href=#hl-1-93>93</a>
</span><span class=lnt id=hl-1-94><a class=lnlinks href=#hl-1-94>94</a>
</span><span class=lnt id=hl-1-95><a class=lnlinks href=#hl-1-95>95</a>
</span><span class=lnt id=hl-1-96><a class=lnlinks href=#hl-1-96>96</a>
</span><span class=lnt id=hl-1-97><a class=lnlinks href=#hl-1-97>97</a>
</span><span class=lnt id=hl-1-98><a class=lnlinks href=#hl-1-98>98</a>
</span><span class=lnt id=hl-1-99><a class=lnlinks href=#hl-1-99>99</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># PyTorch와 MLflow를 사용한 모델 훈련 및 실험 추적 예시</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>torch</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>torch.nn</span> <span class=k>as</span> <span class=nn>nn</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>torch.optim</span> <span class=k>as</span> <span class=nn>optim</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>torch.utils.data</span> <span class=kn>import</span> <span class=n>DataLoader</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>mlflow</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>mlflow.pytorch</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 모델 정의</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SimpleNN</span><span class=p>(</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_size</span><span class=p>,</span> <span class=n>hidden_size</span><span class=p>,</span> <span class=n>output_size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>(</span><span class=n>SimpleNN</span><span class=p>,</span> <span class=bp>self</span><span class=p>)</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>layer1</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>input_size</span><span class=p>,</span> <span class=n>hidden_size</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>relu</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>ReLU</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>layer2</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>hidden_size</span><span class=p>,</span> <span class=n>output_size</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>layer1</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>relu</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>layer2</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 훈련 함수</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>train_model</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>train_loader</span><span class=p>,</span> <span class=n>val_loader</span><span class=p>,</span> <span class=n>criterion</span><span class=p>,</span> <span class=n>optimizer</span><span class=p>,</span> <span class=n>epochs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># MLflow 실험 시작</span>
</span></span><span class=line><span class=cl>    <span class=n>mlflow</span><span class=o>.</span><span class=n>start_run</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 하이퍼파라미터 로깅</span>
</span></span><span class=line><span class=cl>    <span class=n>mlflow</span><span class=o>.</span><span class=n>log_param</span><span class=p>(</span><span class=s2>&#34;hidden_size&#34;</span><span class=p>,</span> <span class=n>model</span><span class=o>.</span><span class=n>layer1</span><span class=o>.</span><span class=n>out_features</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>mlflow</span><span class=o>.</span><span class=n>log_param</span><span class=p>(</span><span class=s2>&#34;learning_rate&#34;</span><span class=p>,</span> <span class=n>optimizer</span><span class=o>.</span><span class=n>param_groups</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=s1>&#39;lr&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>mlflow</span><span class=o>.</span><span class=n>log_param</span><span class=p>(</span><span class=s2>&#34;epochs&#34;</span><span class=p>,</span> <span class=n>epochs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>epoch</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>epochs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 훈련 모드</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span><span class=o>.</span><span class=n>train</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>train_loss</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>inputs</span><span class=p>,</span> <span class=n>targets</span> <span class=ow>in</span> <span class=n>train_loader</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 순전파</span>
</span></span><span class=line><span class=cl>            <span class=n>outputs</span> <span class=o>=</span> <span class=n>model</span><span class=p>(</span><span class=n>inputs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>loss</span> <span class=o>=</span> <span class=n>criterion</span><span class=p>(</span><span class=n>outputs</span><span class=p>,</span> <span class=n>targets</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 역전파 및 최적화</span>
</span></span><span class=line><span class=cl>            <span class=n>optimizer</span><span class=o>.</span><span class=n>zero_grad</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>loss</span><span class=o>.</span><span class=n>backward</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>optimizer</span><span class=o>.</span><span class=n>step</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>train_loss</span> <span class=o>+=</span> <span class=n>loss</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 평가 모드</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span><span class=o>.</span><span class=n>eval</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>val_loss</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>correct</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>total</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=n>torch</span><span class=o>.</span><span class=n>no_grad</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>inputs</span><span class=p>,</span> <span class=n>targets</span> <span class=ow>in</span> <span class=n>val_loader</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>outputs</span> <span class=o>=</span> <span class=n>model</span><span class=p>(</span><span class=n>inputs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>loss</span> <span class=o>=</span> <span class=n>criterion</span><span class=p>(</span><span class=n>outputs</span><span class=p>,</span> <span class=n>targets</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>val_loss</span> <span class=o>+=</span> <span class=n>loss</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=n>_</span><span class=p>,</span> <span class=n>predicted</span> <span class=o>=</span> <span class=n>outputs</span><span class=o>.</span><span class=n>max</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>total</span> <span class=o>+=</span> <span class=n>targets</span><span class=o>.</span><span class=n>size</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>correct</span> <span class=o>+=</span> <span class=n>predicted</span><span class=o>.</span><span class=n>eq</span><span class=p>(</span><span class=n>targets</span><span class=p>)</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 메트릭 계산 및 로깅</span>
</span></span><span class=line><span class=cl>        <span class=n>train_loss</span> <span class=o>/=</span> <span class=nb>len</span><span class=p>(</span><span class=n>train_loader</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>val_loss</span> <span class=o>/=</span> <span class=nb>len</span><span class=p>(</span><span class=n>val_loader</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>accuracy</span> <span class=o>=</span> <span class=mf>100.</span> <span class=o>*</span> <span class=n>correct</span> <span class=o>/</span> <span class=n>total</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>mlflow</span><span class=o>.</span><span class=n>log_metric</span><span class=p>(</span><span class=s2>&#34;train_loss&#34;</span><span class=p>,</span> <span class=n>train_loss</span><span class=p>,</span> <span class=n>step</span><span class=o>=</span><span class=n>epoch</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>mlflow</span><span class=o>.</span><span class=n>log_metric</span><span class=p>(</span><span class=s2>&#34;val_loss&#34;</span><span class=p>,</span> <span class=n>val_loss</span><span class=p>,</span> <span class=n>step</span><span class=o>=</span><span class=n>epoch</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>mlflow</span><span class=o>.</span><span class=n>log_metric</span><span class=p>(</span><span class=s2>&#34;accuracy&#34;</span><span class=p>,</span> <span class=n>accuracy</span><span class=p>,</span> <span class=n>step</span><span class=o>=</span><span class=n>epoch</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Epoch </span><span class=si>{</span><span class=n>epoch</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>epochs</span><span class=si>}</span><span class=s2>: &#34;</span>
</span></span><span class=line><span class=cl>              <span class=sa>f</span><span class=s2>&#34;Train Loss: </span><span class=si>{</span><span class=n>train_loss</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>, &#34;</span>
</span></span><span class=line><span class=cl>              <span class=sa>f</span><span class=s2>&#34;Val Loss: </span><span class=si>{</span><span class=n>val_loss</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>, &#34;</span>
</span></span><span class=line><span class=cl>              <span class=sa>f</span><span class=s2>&#34;Accuracy: </span><span class=si>{</span><span class=n>accuracy</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>%&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 모델 저장</span>
</span></span><span class=line><span class=cl>    <span class=n>mlflow</span><span class=o>.</span><span class=n>pytorch</span><span class=o>.</span><span class=n>log_model</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=s2>&#34;model&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>mlflow</span><span class=o>.</span><span class=n>end_run</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>model</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 모델 훈련 실행</span>
</span></span><span class=line><span class=cl><span class=n>input_size</span> <span class=o>=</span> <span class=mi>784</span>  <span class=c1># MNIST 이미지 크기</span>
</span></span><span class=line><span class=cl><span class=n>hidden_size</span> <span class=o>=</span> <span class=mi>128</span>
</span></span><span class=line><span class=cl><span class=n>output_size</span> <span class=o>=</span> <span class=mi>10</span>  <span class=c1># 0-9 숫자 분류</span>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>SimpleNN</span><span class=p>(</span><span class=n>input_size</span><span class=p>,</span> <span class=n>hidden_size</span><span class=p>,</span> <span class=n>output_size</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 손실 함수 및 옵티마이저 설정</span>
</span></span><span class=line><span class=cl><span class=n>criterion</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>CrossEntropyLoss</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>optimizer</span> <span class=o>=</span> <span class=n>optim</span><span class=o>.</span><span class=n>Adam</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>parameters</span><span class=p>(),</span> <span class=n>lr</span><span class=o>=</span><span class=mf>0.001</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 데이터 로더 설정 (실제 코드에서는 실제 데이터 사용)</span>
</span></span><span class=line><span class=cl><span class=c1># train_loader = DataLoader(…)</span>
</span></span><span class=line><span class=cl><span class=c1># val_loader = DataLoader(…)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 모델 훈련</span>
</span></span><span class=line><span class=cl><span class=c1># trained_model = train_model(model, train_loader, val_loader, criterion, optimizer, epochs=10)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=모델-배포-및-제공>모델 배포 및 제공<a hidden class=anchor aria-hidden=true href=#모델-배포-및-제공>#</a></h4><p>개발된 AI 모델을 실제 환경에 배포하고 서비스하는 과정을 관리한다.</p><ul><li><strong>모델 패키징</strong>: 모델과 의존성을 함께 패키징하여 이식성 확보</li><li><strong>서빙 인프라</strong>: 모델 서빙을 위한 확장 가능한 인프라 구축</li><li><strong>API 설계</strong>: 모델과 상호작용하기 위한 인터페이스 설계</li><li><strong>성능 최적화</strong>: 지연 시간 및 처리량 최적화</li></ul><p>예시 코드 - 모델 배포:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span><span class=lnt id=hl-2-21><a class=lnlinks href=#hl-2-21>21</a>
</span><span class=lnt id=hl-2-22><a class=lnlinks href=#hl-2-22>22</a>
</span><span class=lnt id=hl-2-23><a class=lnlinks href=#hl-2-23>23</a>
</span><span class=lnt id=hl-2-24><a class=lnlinks href=#hl-2-24>24</a>
</span><span class=lnt id=hl-2-25><a class=lnlinks href=#hl-2-25>25</a>
</span><span class=lnt id=hl-2-26><a class=lnlinks href=#hl-2-26>26</a>
</span><span class=lnt id=hl-2-27><a class=lnlinks href=#hl-2-27>27</a>
</span><span class=lnt id=hl-2-28><a class=lnlinks href=#hl-2-28>28</a>
</span><span class=lnt id=hl-2-29><a class=lnlinks href=#hl-2-29>29</a>
</span><span class=lnt id=hl-2-30><a class=lnlinks href=#hl-2-30>30</a>
</span><span class=lnt id=hl-2-31><a class=lnlinks href=#hl-2-31>31</a>
</span><span class=lnt id=hl-2-32><a class=lnlinks href=#hl-2-32>32</a>
</span><span class=lnt id=hl-2-33><a class=lnlinks href=#hl-2-33>33</a>
</span><span class=lnt id=hl-2-34><a class=lnlinks href=#hl-2-34>34</a>
</span><span class=lnt id=hl-2-35><a class=lnlinks href=#hl-2-35>35</a>
</span><span class=lnt id=hl-2-36><a class=lnlinks href=#hl-2-36>36</a>
</span><span class=lnt id=hl-2-37><a class=lnlinks href=#hl-2-37>37</a>
</span><span class=lnt id=hl-2-38><a class=lnlinks href=#hl-2-38>38</a>
</span><span class=lnt id=hl-2-39><a class=lnlinks href=#hl-2-39>39</a>
</span><span class=lnt id=hl-2-40><a class=lnlinks href=#hl-2-40>40</a>
</span><span class=lnt id=hl-2-41><a class=lnlinks href=#hl-2-41>41</a>
</span><span class=lnt id=hl-2-42><a class=lnlinks href=#hl-2-42>42</a>
</span><span class=lnt id=hl-2-43><a class=lnlinks href=#hl-2-43>43</a>
</span><span class=lnt id=hl-2-44><a class=lnlinks href=#hl-2-44>44</a>
</span><span class=lnt id=hl-2-45><a class=lnlinks href=#hl-2-45>45</a>
</span><span class=lnt id=hl-2-46><a class=lnlinks href=#hl-2-46>46</a>
</span><span class=lnt id=hl-2-47><a class=lnlinks href=#hl-2-47>47</a>
</span><span class=lnt id=hl-2-48><a class=lnlinks href=#hl-2-48>48</a>
</span><span class=lnt id=hl-2-49><a class=lnlinks href=#hl-2-49>49</a>
</span><span class=lnt id=hl-2-50><a class=lnlinks href=#hl-2-50>50</a>
</span><span class=lnt id=hl-2-51><a class=lnlinks href=#hl-2-51>51</a>
</span><span class=lnt id=hl-2-52><a class=lnlinks href=#hl-2-52>52</a>
</span><span class=lnt id=hl-2-53><a class=lnlinks href=#hl-2-53>53</a>
</span><span class=lnt id=hl-2-54><a class=lnlinks href=#hl-2-54>54</a>
</span><span class=lnt id=hl-2-55><a class=lnlinks href=#hl-2-55>55</a>
</span><span class=lnt id=hl-2-56><a class=lnlinks href=#hl-2-56>56</a>
</span><span class=lnt id=hl-2-57><a class=lnlinks href=#hl-2-57>57</a>
</span><span class=lnt id=hl-2-58><a class=lnlinks href=#hl-2-58>58</a>
</span><span class=lnt id=hl-2-59><a class=lnlinks href=#hl-2-59>59</a>
</span><span class=lnt id=hl-2-60><a class=lnlinks href=#hl-2-60>60</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Flask와 Docker를 사용한 모델 배포 예시</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># app.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>torch</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>torch.nn</span> <span class=k>as</span> <span class=nn>nn</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 모델 정의 (실제 배포에서는 저장된 모델을 로드)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SimpleNN</span><span class=p>(</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>input_size</span><span class=p>,</span> <span class=n>hidden_size</span><span class=p>,</span> <span class=n>output_size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>(</span><span class=n>SimpleNN</span><span class=p>,</span> <span class=bp>self</span><span class=p>)</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>layer1</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>input_size</span><span class=p>,</span> <span class=n>hidden_size</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>relu</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>ReLU</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>layer2</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Linear</span><span class=p>(</span><span class=n>hidden_size</span><span class=p>,</span> <span class=n>output_size</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>forward</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>layer1</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>relu</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>x</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>layer2</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 모델 로드</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>load_model</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span> <span class=o>=</span> <span class=n>SimpleNN</span><span class=p>(</span><span class=mi>784</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=n>load_state_dict</span><span class=p>(</span><span class=n>torch</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;model.pth&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=n>eval</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>model</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>load_model</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/predict&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>predict</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 요청에서 데이터 추출</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>json</span>
</span></span><span class=line><span class=cl>        <span class=n>input_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;input&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 입력 데이터 전처리</span>
</span></span><span class=line><span class=cl>        <span class=n>input_tensor</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>FloatTensor</span><span class=p>(</span><span class=n>input_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 예측 수행</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=n>torch</span><span class=o>.</span><span class=n>no_grad</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>output</span> <span class=o>=</span> <span class=n>model</span><span class=p>(</span><span class=n>input_tensor</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>probabilities</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>functional</span><span class=o>.</span><span class=n>softmax</span><span class=p>(</span><span class=n>output</span><span class=p>,</span> <span class=n>dim</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>predicted_class</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>probabilities</span><span class=p>)</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 결과 반환</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;predicted_class&#39;</span><span class=p>:</span> <span class=n>predicted_class</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;probabilities&#39;</span><span class=p>:</span> <span class=n>probabilities</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)}),</span> <span class=mi>400</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>5000</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=c># Dockerfile</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> python:3.9-slim</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> requirements.txt .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> pip install --no-cache-dir -r requirements.txt<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 5000</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;python&#34;</span><span class=p>,</span> <span class=s2>&#34;app.py&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=mlops-및-자동화>MLOps 및 자동화<a hidden class=anchor aria-hidden=true href=#mlops-및-자동화>#</a></h4><p>AI 모델의 개발, 테스트, 배포, 모니터링 과정을 자동화하는 CI/CD 파이프라인을 구축한다.</p><ul><li><strong>지속적 통합(CI)</strong>: 코드 및 데이터 변경 시 자동 테스트</li><li><strong>지속적 배포(CD)</strong>: 검증된 모델을 자동으로 배포</li><li><strong>모델 버전 관리</strong>: 모델과 데이터의 버전 및 계보 추적</li><li><strong>인프라스트럭처 as 코드(IaC)</strong>: 인프라 설정을 코드로 관리</li></ul><p>예시 코드 - CI/CD 파이프라인:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span><span class=lnt id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a>
</span><span class=lnt id=hl-4-19><a class=lnlinks href=#hl-4-19>19</a>
</span><span class=lnt id=hl-4-20><a class=lnlinks href=#hl-4-20>20</a>
</span><span class=lnt id=hl-4-21><a class=lnlinks href=#hl-4-21>21</a>
</span><span class=lnt id=hl-4-22><a class=lnlinks href=#hl-4-22>22</a>
</span><span class=lnt id=hl-4-23><a class=lnlinks href=#hl-4-23>23</a>
</span><span class=lnt id=hl-4-24><a class=lnlinks href=#hl-4-24>24</a>
</span><span class=lnt id=hl-4-25><a class=lnlinks href=#hl-4-25>25</a>
</span><span class=lnt id=hl-4-26><a class=lnlinks href=#hl-4-26>26</a>
</span><span class=lnt id=hl-4-27><a class=lnlinks href=#hl-4-27>27</a>
</span><span class=lnt id=hl-4-28><a class=lnlinks href=#hl-4-28>28</a>
</span><span class=lnt id=hl-4-29><a class=lnlinks href=#hl-4-29>29</a>
</span><span class=lnt id=hl-4-30><a class=lnlinks href=#hl-4-30>30</a>
</span><span class=lnt id=hl-4-31><a class=lnlinks href=#hl-4-31>31</a>
</span><span class=lnt id=hl-4-32><a class=lnlinks href=#hl-4-32>32</a>
</span><span class=lnt id=hl-4-33><a class=lnlinks href=#hl-4-33>33</a>
</span><span class=lnt id=hl-4-34><a class=lnlinks href=#hl-4-34>34</a>
</span><span class=lnt id=hl-4-35><a class=lnlinks href=#hl-4-35>35</a>
</span><span class=lnt id=hl-4-36><a class=lnlinks href=#hl-4-36>36</a>
</span><span class=lnt id=hl-4-37><a class=lnlinks href=#hl-4-37>37</a>
</span><span class=lnt id=hl-4-38><a class=lnlinks href=#hl-4-38>38</a>
</span><span class=lnt id=hl-4-39><a class=lnlinks href=#hl-4-39>39</a>
</span><span class=lnt id=hl-4-40><a class=lnlinks href=#hl-4-40>40</a>
</span><span class=lnt id=hl-4-41><a class=lnlinks href=#hl-4-41>41</a>
</span><span class=lnt id=hl-4-42><a class=lnlinks href=#hl-4-42>42</a>
</span><span class=lnt id=hl-4-43><a class=lnlinks href=#hl-4-43>43</a>
</span><span class=lnt id=hl-4-44><a class=lnlinks href=#hl-4-44>44</a>
</span><span class=lnt id=hl-4-45><a class=lnlinks href=#hl-4-45>45</a>
</span><span class=lnt id=hl-4-46><a class=lnlinks href=#hl-4-46>46</a>
</span><span class=lnt id=hl-4-47><a class=lnlinks href=#hl-4-47>47</a>
</span><span class=lnt id=hl-4-48><a class=lnlinks href=#hl-4-48>48</a>
</span><span class=lnt id=hl-4-49><a class=lnlinks href=#hl-4-49>49</a>
</span><span class=lnt id=hl-4-50><a class=lnlinks href=#hl-4-50>50</a>
</span><span class=lnt id=hl-4-51><a class=lnlinks href=#hl-4-51>51</a>
</span><span class=lnt id=hl-4-52><a class=lnlinks href=#hl-4-52>52</a>
</span><span class=lnt id=hl-4-53><a class=lnlinks href=#hl-4-53>53</a>
</span><span class=lnt id=hl-4-54><a class=lnlinks href=#hl-4-54>54</a>
</span><span class=lnt id=hl-4-55><a class=lnlinks href=#hl-4-55>55</a>
</span><span class=lnt id=hl-4-56><a class=lnlinks href=#hl-4-56>56</a>
</span><span class=lnt id=hl-4-57><a class=lnlinks href=#hl-4-57>57</a>
</span><span class=lnt id=hl-4-58><a class=lnlinks href=#hl-4-58>58</a>
</span><span class=lnt id=hl-4-59><a class=lnlinks href=#hl-4-59>59</a>
</span><span class=lnt id=hl-4-60><a class=lnlinks href=#hl-4-60>60</a>
</span><span class=lnt id=hl-4-61><a class=lnlinks href=#hl-4-61>61</a>
</span><span class=lnt id=hl-4-62><a class=lnlinks href=#hl-4-62>62</a>
</span><span class=lnt id=hl-4-63><a class=lnlinks href=#hl-4-63>63</a>
</span><span class=lnt id=hl-4-64><a class=lnlinks href=#hl-4-64>64</a>
</span><span class=lnt id=hl-4-65><a class=lnlinks href=#hl-4-65>65</a>
</span><span class=lnt id=hl-4-66><a class=lnlinks href=#hl-4-66>66</a>
</span><span class=lnt id=hl-4-67><a class=lnlinks href=#hl-4-67>67</a>
</span><span class=lnt id=hl-4-68><a class=lnlinks href=#hl-4-68>68</a>
</span><span class=lnt id=hl-4-69><a class=lnlinks href=#hl-4-69>69</a>
</span><span class=lnt id=hl-4-70><a class=lnlinks href=#hl-4-70>70</a>
</span><span class=lnt id=hl-4-71><a class=lnlinks href=#hl-4-71>71</a>
</span><span class=lnt id=hl-4-72><a class=lnlinks href=#hl-4-72>72</a>
</span><span class=lnt id=hl-4-73><a class=lnlinks href=#hl-4-73>73</a>
</span><span class=lnt id=hl-4-74><a class=lnlinks href=#hl-4-74>74</a>
</span><span class=lnt id=hl-4-75><a class=lnlinks href=#hl-4-75>75</a>
</span><span class=lnt id=hl-4-76><a class=lnlinks href=#hl-4-76>76</a>
</span><span class=lnt id=hl-4-77><a class=lnlinks href=#hl-4-77>77</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># GitHub Actions를 사용한 CI/CD 파이프라인 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># .github/workflows/model-pipeline.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Model Training and Deployment Pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=l>main ]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pull_request</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=l>main ]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Set up Python</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/setup-python@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>python-version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;3.9&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Install dependencies</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>        python -m pip install --upgrade pip
</span></span></span><span class=line><span class=cl><span class=sd>        pip install -r requirements.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Run tests</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>        pytest tests/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>train</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>needs</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Set up Python</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/setup-python@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>python-version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;3.9&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Install dependencies</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>        python -m pip install --upgrade pip
</span></span></span><span class=line><span class=cl><span class=sd>        pip install -r requirements.txt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Train model</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>        python scripts/train.py</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Evaluate model</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>        python scripts/evaluate.py</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Upload model artifact</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/upload-artifact@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>model-artifact</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>models/model.pth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>needs</span><span class=p>:</span><span class=w> </span><span class=l>train</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>github.event_name == &#39;push&#39; &amp;&amp; github.ref == &#39;refs/heads/main&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Download model artifact</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/download-artifact@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>model-artifact</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>models/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Set up Docker Buildx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>docker/setup-buildx-action@v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Login to DockerHub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>docker/login-action@v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>username</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.DOCKERHUB_USERNAME }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.DOCKERHUB_TOKEN }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build and push</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>docker/build-push-action@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>context</span><span class=p>:</span><span class=w> </span><span class=l>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>push</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>tags</span><span class=p>:</span><span class=w> </span><span class=l>user/model-api:latest</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=모델-모니터링-및-피드백-루프>모델 모니터링 및 피드백 루프<a hidden class=anchor aria-hidden=true href=#모델-모니터링-및-피드백-루프>#</a></h4><p>배포된 모델의 성능을 지속적으로 모니터링하고 필요에 따라 업데이트하는 과정을 관리한다.</p><ul><li><strong>성능 모니터링</strong>: 정확도, 예측 지연 시간 등의 측정 및 추적</li><li><strong>데이터 드리프트 감지</strong>: 입력 데이터 변화 감지 및 대응</li><li><strong>개념 드리프트 감지</strong>: 데이터와 대상 간 관계 변화 감지</li><li><strong>A/B 테스트</strong>: 새 모델과 기존 모델 비교 실험</li></ul><p>예시 코드 - 모델 모니터링:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16>16</a>
</span><span class=lnt id=hl-5-17><a class=lnlinks href=#hl-5-17>17</a>
</span><span class=lnt id=hl-5-18><a class=lnlinks href=#hl-5-18>18</a>
</span><span class=lnt id=hl-5-19><a class=lnlinks href=#hl-5-19>19</a>
</span><span class=lnt id=hl-5-20><a class=lnlinks href=#hl-5-20>20</a>
</span><span class=lnt id=hl-5-21><a class=lnlinks href=#hl-5-21>21</a>
</span><span class=lnt id=hl-5-22><a class=lnlinks href=#hl-5-22>22</a>
</span><span class=lnt id=hl-5-23><a class=lnlinks href=#hl-5-23>23</a>
</span><span class=lnt id=hl-5-24><a class=lnlinks href=#hl-5-24>24</a>
</span><span class=lnt id=hl-5-25><a class=lnlinks href=#hl-5-25>25</a>
</span><span class=lnt id=hl-5-26><a class=lnlinks href=#hl-5-26>26</a>
</span><span class=lnt id=hl-5-27><a class=lnlinks href=#hl-5-27>27</a>
</span><span class=lnt id=hl-5-28><a class=lnlinks href=#hl-5-28>28</a>
</span><span class=lnt id=hl-5-29><a class=lnlinks href=#hl-5-29>29</a>
</span><span class=lnt id=hl-5-30><a class=lnlinks href=#hl-5-30>30</a>
</span><span class=lnt id=hl-5-31><a class=lnlinks href=#hl-5-31>31</a>
</span><span class=lnt id=hl-5-32><a class=lnlinks href=#hl-5-32>32</a>
</span><span class=lnt id=hl-5-33><a class=lnlinks href=#hl-5-33>33</a>
</span><span class=lnt id=hl-5-34><a class=lnlinks href=#hl-5-34>34</a>
</span><span class=lnt id=hl-5-35><a class=lnlinks href=#hl-5-35>35</a>
</span><span class=lnt id=hl-5-36><a class=lnlinks href=#hl-5-36>36</a>
</span><span class=lnt id=hl-5-37><a class=lnlinks href=#hl-5-37>37</a>
</span><span class=lnt id=hl-5-38><a class=lnlinks href=#hl-5-38>38</a>
</span><span class=lnt id=hl-5-39><a class=lnlinks href=#hl-5-39>39</a>
</span><span class=lnt id=hl-5-40><a class=lnlinks href=#hl-5-40>40</a>
</span><span class=lnt id=hl-5-41><a class=lnlinks href=#hl-5-41>41</a>
</span><span class=lnt id=hl-5-42><a class=lnlinks href=#hl-5-42>42</a>
</span><span class=lnt id=hl-5-43><a class=lnlinks href=#hl-5-43>43</a>
</span><span class=lnt id=hl-5-44><a class=lnlinks href=#hl-5-44>44</a>
</span><span class=lnt id=hl-5-45><a class=lnlinks href=#hl-5-45>45</a>
</span><span class=lnt id=hl-5-46><a class=lnlinks href=#hl-5-46>46</a>
</span><span class=lnt id=hl-5-47><a class=lnlinks href=#hl-5-47>47</a>
</span><span class=lnt id=hl-5-48><a class=lnlinks href=#hl-5-48>48</a>
</span><span class=lnt id=hl-5-49><a class=lnlinks href=#hl-5-49>49</a>
</span><span class=lnt id=hl-5-50><a class=lnlinks href=#hl-5-50>50</a>
</span><span class=lnt id=hl-5-51><a class=lnlinks href=#hl-5-51>51</a>
</span><span class=lnt id=hl-5-52><a class=lnlinks href=#hl-5-52>52</a>
</span><span class=lnt id=hl-5-53><a class=lnlinks href=#hl-5-53>53</a>
</span><span class=lnt id=hl-5-54><a class=lnlinks href=#hl-5-54>54</a>
</span><span class=lnt id=hl-5-55><a class=lnlinks href=#hl-5-55>55</a>
</span><span class=lnt id=hl-5-56><a class=lnlinks href=#hl-5-56>56</a>
</span><span class=lnt id=hl-5-57><a class=lnlinks href=#hl-5-57>57</a>
</span><span class=lnt id=hl-5-58><a class=lnlinks href=#hl-5-58>58</a>
</span><span class=lnt id=hl-5-59><a class=lnlinks href=#hl-5-59>59</a>
</span><span class=lnt id=hl-5-60><a class=lnlinks href=#hl-5-60>60</a>
</span><span class=lnt id=hl-5-61><a class=lnlinks href=#hl-5-61>61</a>
</span><span class=lnt id=hl-5-62><a class=lnlinks href=#hl-5-62>62</a>
</span><span class=lnt id=hl-5-63><a class=lnlinks href=#hl-5-63>63</a>
</span><span class=lnt id=hl-5-64><a class=lnlinks href=#hl-5-64>64</a>
</span><span class=lnt id=hl-5-65><a class=lnlinks href=#hl-5-65>65</a>
</span><span class=lnt id=hl-5-66><a class=lnlinks href=#hl-5-66>66</a>
</span><span class=lnt id=hl-5-67><a class=lnlinks href=#hl-5-67>67</a>
</span><span class=lnt id=hl-5-68><a class=lnlinks href=#hl-5-68>68</a>
</span><span class=lnt id=hl-5-69><a class=lnlinks href=#hl-5-69>69</a>
</span><span class=lnt id=hl-5-70><a class=lnlinks href=#hl-5-70>70</a>
</span><span class=lnt id=hl-5-71><a class=lnlinks href=#hl-5-71>71</a>
</span><span class=lnt id=hl-5-72><a class=lnlinks href=#hl-5-72>72</a>
</span><span class=lnt id=hl-5-73><a class=lnlinks href=#hl-5-73>73</a>
</span><span class=lnt id=hl-5-74><a class=lnlinks href=#hl-5-74>74</a>
</span><span class=lnt id=hl-5-75><a class=lnlinks href=#hl-5-75>75</a>
</span><span class=lnt id=hl-5-76><a class=lnlinks href=#hl-5-76>76</a>
</span><span class=lnt id=hl-5-77><a class=lnlinks href=#hl-5-77>77</a>
</span><span class=lnt id=hl-5-78><a class=lnlinks href=#hl-5-78>78</a>
</span><span class=lnt id=hl-5-79><a class=lnlinks href=#hl-5-79>79</a>
</span><span class=lnt id=hl-5-80><a class=lnlinks href=#hl-5-80>80</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Prometheus와 Grafana를 사용한 모델 모니터링 예시</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>torch</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>prometheus_client</span> <span class=kn>import</span> <span class=n>Counter</span><span class=p>,</span> <span class=n>Histogram</span><span class=p>,</span> <span class=n>Gauge</span><span class=p>,</span> <span class=n>Summary</span><span class=p>,</span> <span class=n>start_http_server</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Prometheus 메트릭 정의</span>
</span></span><span class=line><span class=cl><span class=n>PREDICTION_COUNT</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>(</span><span class=s1>&#39;model_predictions_total&#39;</span><span class=p>,</span> <span class=s1>&#39;Total number of predictions&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>PREDICTION_LATENCY</span> <span class=o>=</span> <span class=n>Histogram</span><span class=p>(</span><span class=s1>&#39;model_prediction_latency_seconds&#39;</span><span class=p>,</span> <span class=s1>&#39;Prediction latency in seconds&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>PREDICTION_ERRORS</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>(</span><span class=s1>&#39;model_prediction_errors_total&#39;</span><span class=p>,</span> <span class=s1>&#39;Total number of prediction errors&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>MODEL_ACCURACY</span> <span class=o>=</span> <span class=n>Gauge</span><span class=p>(</span><span class=s1>&#39;model_accuracy&#39;</span><span class=p>,</span> <span class=s1>&#39;Current model accuracy&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>INPUT_DRIFT</span> <span class=o>=</span> <span class=n>Gauge</span><span class=p>(</span><span class=s1>&#39;input_drift_score&#39;</span><span class=p>,</span> <span class=s1>&#39;Input data drift score&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 모델 로드 및 설정</span>
</span></span><span class=line><span class=cl><span class=c1># (이전 예시 참조)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/predict&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>predict</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 요청에서 데이터 추출</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>json</span>
</span></span><span class=line><span class=cl>        <span class=n>input_data</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;input&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 입력 데이터 드리프트 감지</span>
</span></span><span class=line><span class=cl>        <span class=n>drift_score</span> <span class=o>=</span> <span class=n>check_data_drift</span><span class=p>(</span><span class=n>input_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>INPUT_DRIFT</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=n>drift_score</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 예측 수행</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=n>torch</span><span class=o>.</span><span class=n>no_grad</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>input_tensor</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>FloatTensor</span><span class=p>(</span><span class=n>input_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>output</span> <span class=o>=</span> <span class=n>model</span><span class=p>(</span><span class=n>input_tensor</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>probabilities</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>functional</span><span class=o>.</span><span class=n>softmax</span><span class=p>(</span><span class=n>output</span><span class=p>,</span> <span class=n>dim</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>predicted_class</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>probabilities</span><span class=p>)</span><span class=o>.</span><span class=n>item</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 메트릭 업데이트</span>
</span></span><span class=line><span class=cl>        <span class=n>PREDICTION_COUNT</span><span class=o>.</span><span class=n>inc</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 결과 반환</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;predicted_class&#39;</span><span class=p>:</span> <span class=n>predicted_class</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;probabilities&#39;</span><span class=p>:</span> <span class=n>probabilities</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>response</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>PREDICTION_ERRORS</span><span class=o>.</span><span class=n>inc</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)}),</span> <span class=mi>400</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 예측 지연 시간 측정</span>
</span></span><span class=line><span class=cl>        <span class=n>latency</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl>        <span class=n>PREDICTION_LATENCY</span><span class=o>.</span><span class=n>observe</span><span class=p>(</span><span class=n>latency</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>check_data_drift</span><span class=p>(</span><span class=n>input_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 입력 데이터 드리프트 감지 로직</span>
</span></span><span class=line><span class=cl>    <span class=c1># 기준 데이터와 현재 데이터의 통계적 특성 비교</span>
</span></span><span class=line><span class=cl>    <span class=c1># 간단한 예시로, 평균 차이를 기반으로 점수 계산</span>
</span></span><span class=line><span class=cl>    <span class=n>reference_mean</span> <span class=o>=</span> <span class=mf>0.5</span>  <span class=c1># 기준 데이터의 평균 (예시 값)</span>
</span></span><span class=line><span class=cl>    <span class=n>current_mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>input_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>drift_score</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>(</span><span class=n>current_mean</span> <span class=o>-</span> <span class=n>reference_mean</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>drift_score</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 모델 정확도 업데이트 함수 (주기적으로 호출)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>update_model_accuracy</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 테스트 데이터로 모델 정확도 평가</span>
</span></span><span class=line><span class=cl>    <span class=n>accuracy</span> <span class=o>=</span> <span class=n>evaluate_model_on_test_data</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>MODEL_ACCURACY</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=n>accuracy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메트릭 서버 시작</span>
</span></span><span class=line><span class=cl><span class=n>start_http_server</span><span class=p>(</span><span class=mi>8000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>5000</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ai-엔지니어링의-필수-기술과-도구>AI 엔지니어링의 필수 기술과 도구<a hidden class=anchor aria-hidden=true href=#ai-엔지니어링의-필수-기술과-도구>#</a></h3><ol><li><p>프로그래밍 언어 및 프레임워크:<br>AI 엔지니어링에 필요한 주요 프로그래밍 언어와 프레임워크:</p><ul><li><strong>Python</strong>: AI 개발의 사실상 표준 언어</li><li><strong>R</strong>: 통계 분석 및 시각화에 강점</li><li><strong>Julia</strong>: 고성능 연산에 최적화된 언어</li><li><strong>TensorFlow, PyTorch</strong>: 딥러닝 모델 개발에 사용되는 주요 프레임워크</li><li><strong>scikit-learn</strong>: 전통적인 머신러닝 알고리즘 구현</li><li><strong>Spark MLlib</strong>: 분산 머신러닝을 위한 라이브러리</li></ul></li><li><p>데이터 엔지니어링 도구<br>데이터 처리 및 관리를 위한 도구:</p><ul><li><strong>SQL, NoSQL 데이터베이스</strong>: 데이터 저장 및 쿼리</li><li><strong>Apache Spark, Hadoop</strong>: 대규모 데이터 처리</li><li><strong>Kafka, RabbitMQ</strong>: 데이터 스트리밍 및 메시징</li><li><strong>Airflow, Luigi</strong>: 데이터 파이프라인 오케스트레이션</li><li><strong>dbt (data build tool)</strong>: 데이터 변환 및 관리</li></ul></li><li><p>MLOps 도구<br>AI 시스템의 개발 및 운영을 위한 도구:</p><ul><li><strong>Git, GitHub</strong>: 코드 버전 관리</li><li><strong>DVC (Data Version Control)</strong>: 데이터 및 모델 버전 관리</li><li><strong>MLflow, Weights & Biases</strong>: 실험 추적 및 모델 관리</li><li><strong>Kubeflow, Metaflow</strong>: ML 워크플로우 오케스트레이션</li><li><strong>Docker, Kubernetes</strong>: 컨테이너화 및 오케스트레이션</li><li><strong>TensorFlow Serving, TorchServe, KFServing</strong>: 모델 서빙</li><li><strong>Prometheus, Grafana</strong>: 모니터링 및 알림</li></ul></li><li><p>클라우드 플랫폼 및 서비스<br>클라우드 기반 AI 서비스:</p><ul><li><strong>AWS SageMaker</strong>: 모델 개발, 훈련, 배포를 위한 통합 플랫폼</li><li><strong>Google AI Platform</strong>: 모델 개발 및 배포를 위한 Google의 서비스</li><li><strong>Azure Machine Learning</strong>: Microsoft의 ML 개발 및 배포 서비스</li><li><strong>IBM Watson</strong>: 다양한 AI 서비스를 제공하는 IBM의 플랫폼</li><li><strong>Databricks</strong>: 협업 기반 데이터 분석 및 ML 플랫폼</li></ul></li></ol><h3 id=ai-엔지니어링-프로세스>AI 엔지니어링 프로세스<a hidden class=anchor aria-hidden=true href=#ai-엔지니어링-프로세스>#</a></h3><ol><li>문제 정의 및 요구사항 분석<br>AI 프로젝트의 출발점은 명확한 문제 정의와 요구사항 분석이다:<ol><li><strong>비즈니스 문제 이해</strong>: 해결하려는 문제와 비즈니스 목표 파악</li><li><strong>요구사항 분석</strong>: 기능적, 비기능적 요구사항 정의</li><li><strong>성공 기준 설정</strong>: 모델 성능 및 비즈니스 성과 지표 정의</li><li><strong>제약 조건 식별</strong>: 리소스, 시간, 규제 등의 제약 확인</li></ol></li><li>데이터 수집 및 준비<br>AI 모델 개발에 필요한 데이터를 수집하고 준비하는 단계:<ol><li><strong>데이터 소스 식별</strong>: 관련 데이터 소스 식별 및 접근 방법 수립</li><li><strong>데이터 수집</strong>: 다양한 소스에서 데이터 수집 및 통합</li><li><strong>데이터 탐색</strong>: 데이터 특성, 분포, 품질 등 분석</li><li><strong>데이터 전처리</strong>: 결측치 처리, 정규화, 특성 추출 등 수행</li><li><strong>데이터 분할</strong>: 훈련, 검증, 테스트 세트로 데이터 분할</li></ol></li><li>모델 개발 및 훈련<br>AI 모델을 설계하고 훈련하는 단계:<ol><li><strong>모델 선택</strong>: 문제에 적합한 알고리즘 및 아키텍처 선택</li><li><strong>초기 모델 훈련</strong>: 기본 설정으로 모델 훈련 및 평가</li><li><strong>하이퍼파라미터 최적화</strong>: 모델 성능 향상을 위한 파라미터 튜닝</li><li><strong>모델 평가</strong>: 다양한 메트릭으로 모델 성능 평가</li><li><strong>모델 재훈련</strong>: 최적의 설정으로 전체 훈련 데이터셋에서 모델 재훈련</li></ol></li><li>모델 배포 및 통합<br>개발된 모델을 실제 환경에 배포하고 기존 시스템과 통합하는 단계:<ol><li><strong>배포 전략 수립</strong>: 온라인/오프라인, 배치/실시간 등 배포 방식 결정</li><li><strong>모델 패키징</strong>: 모델과 의존성을 함께 패키징</li><li><strong>서빙 인프라 구축</strong>: 확장성, 가용성, 성능을 고려한 인프라 설계</li><li><strong>API 개발</strong>: 모델과 상호작용하기 위한 인터페이스 개발</li><li><strong>시스템 통합</strong>: 기존 시스템과의 통합 및 테스트</li></ol></li><li>모니터링 및 유지보수<br>배포된 모델의 성능을 모니터링하고 유지보수하는 단계:<ol><li><strong>성능 모니터링</strong>: 모델 정확도, 응답 시간 등 추적</li><li><strong>데이터 드리프트 감지</strong>: 입력 데이터 변화 모니터링</li><li><strong>개념 드리프트 감지</strong>: 데이터와 목표 변수 간 관계 변화 감지</li><li><strong>모델 업데이트</strong>: 필요에 따라 모델 재훈련 및 업데이트</li><li><strong>피드백 수집</strong>: 사용자 피드백 수집 및 분석</li></ol></li></ol><h3 id=ai-엔지니어링의-도전-과제-및-모범-사례>AI 엔지니어링의 도전 과제 및 모범 사례<a hidden class=anchor aria-hidden=true href=#ai-엔지니어링의-도전-과제-및-모범-사례>#</a></h3><ol><li><p>데이터 관련 도전 과제</p><ul><li><strong>불충분한 데이터</strong>: 모델 훈련에 필요한 데이터 부족</li><li><strong>편향된 데이터</strong>: 특정 그룹이나 상황을 과소/과대 표현하는 데이터</li><li><strong>낮은 데이터 품질</strong>: 결측치, 잡음, 불일치 등의 문제</li><li><strong>데이터 라벨링 비용</strong>: 지도학습을 위한 라벨링의 높은 비용과 시간<br><strong>모범 사례</strong>:</li><li>데이터 증강(Data Augmentation) 기법 활용</li><li>다양성과 공정성을 고려한 데이터 수집</li><li>자동화된 데이터 품질 검증 파이프라인 구축</li><li>준지도학습, 약지도학습 등의 대안적 접근법 고려</li></ul></li><li><p>모델 개발 도전 과제</p><ul><li><strong>과적합(Overfitting)</strong>: 훈련 데이터에만 최적화된 모델</li><li><strong>모델 복잡성</strong>: 해석하기 어려운 블랙박스 모델</li><li><strong>일반화 능력</strong>: 새로운 데이터에 대한 성능 저하</li><li><strong>컴퓨팅 요구사항</strong>: 대규모 모델 훈련의 높은 컴퓨팅 요구<br><strong>모범 사례</strong>:</li><li>정규화, 교차 검증 등 과적합 방지 기법 적용</li><li>모델 설명 가능성(XAI) 기법 활용</li><li>다양한 조건에서의 강건성 테스트</li><li>모델 압축, 증류, 양자화 등의 최적화 기법 적용</li></ul></li><li><p>배포 및 운영 도전 과제</p><ul><li><strong>모델-서빙 간극</strong>: 연구 환경과 생산 환경 간의 차이로 인한 문제</li><li><strong>확장성</strong>: 트래픽 증가에 따른 확장 문제</li><li><strong>지연 시간</strong>: 실시간 응답이 필요한 애플리케이션의 성능 요구사항</li><li><strong>의존성 관리</strong>: 모델과 환경 의존성의 복잡성<br><strong>모범 사례</strong>:</li><li>컨테이너화를 통한 환경 일관성 확보</li><li>자동 스케일링 인프라 구축</li><li>모델 최적화 및 캐싱 전략 도입</li><li>의존성을 포함한 모델 패키징 및 버전 관리</li></ul></li><li><p>모니터링 및 유지보수 도전 과제</p><ul><li><strong>성능 저하 감지</strong>: 시간이 지남에 따른 모델 성능 저하 감지</li><li><strong>데이터 드리프트</strong>: 입력 데이터 분포의 변화 관리</li><li><strong>개념 드리프트</strong>: 데이터와 목표 변수 간 관계 변화 관리</li><li><strong>피드백 루프</strong>: 모델 업데이트를 위한 피드백 메커니즘 구축<br><strong>모범 사례</strong>:</li><li>자동화된 모델 성능 모니터링 시스템 구축</li><li>데이터 드리프트 감지 및 알림 메커니즘 구현</li><li>정기적인 모델 재평가 및 재훈련 일정 수립</li><li>A/B 테스트를 통한 모델 업데이트 효과 검증</li></ul></li><li><p>윤리 및 책임 AI 도전 과제</p><ul><li><strong>편향과 공정성</strong>: 모델의 결정에서 특정 그룹에 대한 편향</li><li><strong>설명 가능성</strong>: 모델 결정에 대한 투명성 및 해석 가능성 부족</li><li><strong>프라이버시</strong>: 개인 정보 보호 및 데이터 보안 문제</li><li><strong>사회적 영향</strong>: AI 시스템의 잠재적 부정적 사회 영향<br><strong>모범 사례</strong>:</li><li>공정성 메트릭을 통한 모델 평가 및 편향 감지</li><li>설명 가능한 AI(XAI) 기법 및 도구 활용</li><li>차등 프라이버시, 연합 학습 등의 프라이버시 보호 기법 적용</li><li>다양한 이해관계자와의 협력 및 윤리적 영향 평가</li></ul></li></ol><h3 id=ai-엔지니어링-프로젝트-예시>AI 엔지니어링 프로젝트 예시<a hidden class=anchor aria-hidden=true href=#ai-엔지니어링-프로젝트-예시>#</a></h3><h4 id=고객-이탈-예측-시스템>고객 이탈 예측 시스템<a hidden class=anchor aria-hidden=true href=#고객-이탈-예측-시스템>#</a></h4><p>통신사나 구독 서비스 회사가 고객 이탈(Churn)을 예측하고 방지하기 위한 AI 시스템 구축 과정을 단계별로 살펴보자.</p><h5 id=문제-정의-및-요구사항>문제 정의 및 요구사항<a hidden class=anchor aria-hidden=true href=#문제-정의-및-요구사항>#</a></h5><ul><li><strong>비즈니스 문제</strong>: 고객 이탈로 인한 수익 손실 최소화</li><li><strong>AI 접근법</strong>: 고객 이탈 위험이 높은 고객을 식별하는 예측 모델</li><li><strong>성공 기준</strong>: 이탈 예측 정확도 85% 이상, 고객 유지율 10% 향상</li><li><strong>제약 조건</strong>: 일별 예측 업데이트, 90초 이내 마케팅 시스템 통합</li></ul><h5 id=데이터-파이프라인-구축>데이터 파이프라인 구축<a hidden class=anchor aria-hidden=true href=#데이터-파이프라인-구축>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>  1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2>  2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3>  3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4>  4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5>  5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6>  6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7>  7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8>  8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9>  9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10> 10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11> 11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12> 12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13> 13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14> 14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15> 15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16> 16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17> 17</a>
</span><span class=lnt id=hl-6-18><a class=lnlinks href=#hl-6-18> 18</a>
</span><span class=lnt id=hl-6-19><a class=lnlinks href=#hl-6-19> 19</a>
</span><span class=lnt id=hl-6-20><a class=lnlinks href=#hl-6-20> 20</a>
</span><span class=lnt id=hl-6-21><a class=lnlinks href=#hl-6-21> 21</a>
</span><span class=lnt id=hl-6-22><a class=lnlinks href=#hl-6-22> 22</a>
</span><span class=lnt id=hl-6-23><a class=lnlinks href=#hl-6-23> 23</a>
</span><span class=lnt id=hl-6-24><a class=lnlinks href=#hl-6-24> 24</a>
</span><span class=lnt id=hl-6-25><a class=lnlinks href=#hl-6-25> 25</a>
</span><span class=lnt id=hl-6-26><a class=lnlinks href=#hl-6-26> 26</a>
</span><span class=lnt id=hl-6-27><a class=lnlinks href=#hl-6-27> 27</a>
</span><span class=lnt id=hl-6-28><a class=lnlinks href=#hl-6-28> 28</a>
</span><span class=lnt id=hl-6-29><a class=lnlinks href=#hl-6-29> 29</a>
</span><span class=lnt id=hl-6-30><a class=lnlinks href=#hl-6-30> 30</a>
</span><span class=lnt id=hl-6-31><a class=lnlinks href=#hl-6-31> 31</a>
</span><span class=lnt id=hl-6-32><a class=lnlinks href=#hl-6-32> 32</a>
</span><span class=lnt id=hl-6-33><a class=lnlinks href=#hl-6-33> 33</a>
</span><span class=lnt id=hl-6-34><a class=lnlinks href=#hl-6-34> 34</a>
</span><span class=lnt id=hl-6-35><a class=lnlinks href=#hl-6-35> 35</a>
</span><span class=lnt id=hl-6-36><a class=lnlinks href=#hl-6-36> 36</a>
</span><span class=lnt id=hl-6-37><a class=lnlinks href=#hl-6-37> 37</a>
</span><span class=lnt id=hl-6-38><a class=lnlinks href=#hl-6-38> 38</a>
</span><span class=lnt id=hl-6-39><a class=lnlinks href=#hl-6-39> 39</a>
</span><span class=lnt id=hl-6-40><a class=lnlinks href=#hl-6-40> 40</a>
</span><span class=lnt id=hl-6-41><a class=lnlinks href=#hl-6-41> 41</a>
</span><span class=lnt id=hl-6-42><a class=lnlinks href=#hl-6-42> 42</a>
</span><span class=lnt id=hl-6-43><a class=lnlinks href=#hl-6-43> 43</a>
</span><span class=lnt id=hl-6-44><a class=lnlinks href=#hl-6-44> 44</a>
</span><span class=lnt id=hl-6-45><a class=lnlinks href=#hl-6-45> 45</a>
</span><span class=lnt id=hl-6-46><a class=lnlinks href=#hl-6-46> 46</a>
</span><span class=lnt id=hl-6-47><a class=lnlinks href=#hl-6-47> 47</a>
</span><span class=lnt id=hl-6-48><a class=lnlinks href=#hl-6-48> 48</a>
</span><span class=lnt id=hl-6-49><a class=lnlinks href=#hl-6-49> 49</a>
</span><span class=lnt id=hl-6-50><a class=lnlinks href=#hl-6-50> 50</a>
</span><span class=lnt id=hl-6-51><a class=lnlinks href=#hl-6-51> 51</a>
</span><span class=lnt id=hl-6-52><a class=lnlinks href=#hl-6-52> 52</a>
</span><span class=lnt id=hl-6-53><a class=lnlinks href=#hl-6-53> 53</a>
</span><span class=lnt id=hl-6-54><a class=lnlinks href=#hl-6-54> 54</a>
</span><span class=lnt id=hl-6-55><a class=lnlinks href=#hl-6-55> 55</a>
</span><span class=lnt id=hl-6-56><a class=lnlinks href=#hl-6-56> 56</a>
</span><span class=lnt id=hl-6-57><a class=lnlinks href=#hl-6-57> 57</a>
</span><span class=lnt id=hl-6-58><a class=lnlinks href=#hl-6-58> 58</a>
</span><span class=lnt id=hl-6-59><a class=lnlinks href=#hl-6-59> 59</a>
</span><span class=lnt id=hl-6-60><a class=lnlinks href=#hl-6-60> 60</a>
</span><span class=lnt id=hl-6-61><a class=lnlinks href=#hl-6-61> 61</a>
</span><span class=lnt id=hl-6-62><a class=lnlinks href=#hl-6-62> 62</a>
</span><span class=lnt id=hl-6-63><a class=lnlinks href=#hl-6-63> 63</a>
</span><span class=lnt id=hl-6-64><a class=lnlinks href=#hl-6-64> 64</a>
</span><span class=lnt id=hl-6-65><a class=lnlinks href=#hl-6-65> 65</a>
</span><span class=lnt id=hl-6-66><a class=lnlinks href=#hl-6-66> 66</a>
</span><span class=lnt id=hl-6-67><a class=lnlinks href=#hl-6-67> 67</a>
</span><span class=lnt id=hl-6-68><a class=lnlinks href=#hl-6-68> 68</a>
</span><span class=lnt id=hl-6-69><a class=lnlinks href=#hl-6-69> 69</a>
</span><span class=lnt id=hl-6-70><a class=lnlinks href=#hl-6-70> 70</a>
</span><span class=lnt id=hl-6-71><a class=lnlinks href=#hl-6-71> 71</a>
</span><span class=lnt id=hl-6-72><a class=lnlinks href=#hl-6-72> 72</a>
</span><span class=lnt id=hl-6-73><a class=lnlinks href=#hl-6-73> 73</a>
</span><span class=lnt id=hl-6-74><a class=lnlinks href=#hl-6-74> 74</a>
</span><span class=lnt id=hl-6-75><a class=lnlinks href=#hl-6-75> 75</a>
</span><span class=lnt id=hl-6-76><a class=lnlinks href=#hl-6-76> 76</a>
</span><span class=lnt id=hl-6-77><a class=lnlinks href=#hl-6-77> 77</a>
</span><span class=lnt id=hl-6-78><a class=lnlinks href=#hl-6-78> 78</a>
</span><span class=lnt id=hl-6-79><a class=lnlinks href=#hl-6-79> 79</a>
</span><span class=lnt id=hl-6-80><a class=lnlinks href=#hl-6-80> 80</a>
</span><span class=lnt id=hl-6-81><a class=lnlinks href=#hl-6-81> 81</a>
</span><span class=lnt id=hl-6-82><a class=lnlinks href=#hl-6-82> 82</a>
</span><span class=lnt id=hl-6-83><a class=lnlinks href=#hl-6-83> 83</a>
</span><span class=lnt id=hl-6-84><a class=lnlinks href=#hl-6-84> 84</a>
</span><span class=lnt id=hl-6-85><a class=lnlinks href=#hl-6-85> 85</a>
</span><span class=lnt id=hl-6-86><a class=lnlinks href=#hl-6-86> 86</a>
</span><span class=lnt id=hl-6-87><a class=lnlinks href=#hl-6-87> 87</a>
</span><span class=lnt id=hl-6-88><a class=lnlinks href=#hl-6-88> 88</a>
</span><span class=lnt id=hl-6-89><a class=lnlinks href=#hl-6-89> 89</a>
</span><span class=lnt id=hl-6-90><a class=lnlinks href=#hl-6-90> 90</a>
</span><span class=lnt id=hl-6-91><a class=lnlinks href=#hl-6-91> 91</a>
</span><span class=lnt id=hl-6-92><a class=lnlinks href=#hl-6-92> 92</a>
</span><span class=lnt id=hl-6-93><a class=lnlinks href=#hl-6-93> 93</a>
</span><span class=lnt id=hl-6-94><a class=lnlinks href=#hl-6-94> 94</a>
</span><span class=lnt id=hl-6-95><a class=lnlinks href=#hl-6-95> 95</a>
</span><span class=lnt id=hl-6-96><a class=lnlinks href=#hl-6-96> 96</a>
</span><span class=lnt id=hl-6-97><a class=lnlinks href=#hl-6-97> 97</a>
</span><span class=lnt id=hl-6-98><a class=lnlinks href=#hl-6-98> 98</a>
</span><span class=lnt id=hl-6-99><a class=lnlinks href=#hl-6-99> 99</a>
</span><span class=lnt id=hl-6-100><a class=lnlinks href=#hl-6-100>100</a>
</span><span class=lnt id=hl-6-101><a class=lnlinks href=#hl-6-101>101</a>
</span><span class=lnt id=hl-6-102><a class=lnlinks href=#hl-6-102>102</a>
</span><span class=lnt id=hl-6-103><a class=lnlinks href=#hl-6-103>103</a>
</span><span class=lnt id=hl-6-104><a class=lnlinks href=#hl-6-104>104</a>
</span><span class=lnt id=hl-6-105><a class=lnlinks href=#hl-6-105>105</a>
</span><span class=lnt id=hl-6-106><a class=lnlinks href=#hl-6-106>106</a>
</span><span class=lnt id=hl-6-107><a class=lnlinks href=#hl-6-107>107</a>
</span><span class=lnt id=hl-6-108><a class=lnlinks href=#hl-6-108>108</a>
</span><span class=lnt id=hl-6-109><a class=lnlinks href=#hl-6-109>109</a>
</span><span class=lnt id=hl-6-110><a class=lnlinks href=#hl-6-110>110</a>
</span><span class=lnt id=hl-6-111><a class=lnlinks href=#hl-6-111>111</a>
</span><span class=lnt id=hl-6-112><a class=lnlinks href=#hl-6-112>112</a>
</span><span class=lnt id=hl-6-113><a class=lnlinks href=#hl-6-113>113</a>
</span><span class=lnt id=hl-6-114><a class=lnlinks href=#hl-6-114>114</a>
</span><span class=lnt id=hl-6-115><a class=lnlinks href=#hl-6-115>115</a>
</span><span class=lnt id=hl-6-116><a class=lnlinks href=#hl-6-116>116</a>
</span><span class=lnt id=hl-6-117><a class=lnlinks href=#hl-6-117>117</a>
</span><span class=lnt id=hl-6-118><a class=lnlinks href=#hl-6-118>118</a>
</span><span class=lnt id=hl-6-119><a class=lnlinks href=#hl-6-119>119</a>
</span><span class=lnt id=hl-6-120><a class=lnlinks href=#hl-6-120>120</a>
</span><span class=lnt id=hl-6-121><a class=lnlinks href=#hl-6-121>121</a>
</span><span class=lnt id=hl-6-122><a class=lnlinks href=#hl-6-122>122</a>
</span><span class=lnt id=hl-6-123><a class=lnlinks href=#hl-6-123>123</a>
</span><span class=lnt id=hl-6-124><a class=lnlinks href=#hl-6-124>124</a>
</span><span class=lnt id=hl-6-125><a class=lnlinks href=#hl-6-125>125</a>
</span><span class=lnt id=hl-6-126><a class=lnlinks href=#hl-6-126>126</a>
</span><span class=lnt id=hl-6-127><a class=lnlinks href=#hl-6-127>127</a>
</span><span class=lnt id=hl-6-128><a class=lnlinks href=#hl-6-128>128</a>
</span><span class=lnt id=hl-6-129><a class=lnlinks href=#hl-6-129>129</a>
</span><span class=lnt id=hl-6-130><a class=lnlinks href=#hl-6-130>130</a>
</span><span class=lnt id=hl-6-131><a class=lnlinks href=#hl-6-131>131</a>
</span><span class=lnt id=hl-6-132><a class=lnlinks href=#hl-6-132>132</a>
</span><span class=lnt id=hl-6-133><a class=lnlinks href=#hl-6-133>133</a>
</span><span class=lnt id=hl-6-134><a class=lnlinks href=#hl-6-134>134</a>
</span><span class=lnt id=hl-6-135><a class=lnlinks href=#hl-6-135>135</a>
</span><span class=lnt id=hl-6-136><a class=lnlinks href=#hl-6-136>136</a>
</span><span class=lnt id=hl-6-137><a class=lnlinks href=#hl-6-137>137</a>
</span><span class=lnt id=hl-6-138><a class=lnlinks href=#hl-6-138>138</a>
</span><span class=lnt id=hl-6-139><a class=lnlinks href=#hl-6-139>139</a>
</span><span class=lnt id=hl-6-140><a class=lnlinks href=#hl-6-140>140</a>
</span><span class=lnt id=hl-6-141><a class=lnlinks href=#hl-6-141>141</a>
</span><span class=lnt id=hl-6-142><a class=lnlinks href=#hl-6-142>142</a>
</span><span class=lnt id=hl-6-143><a class=lnlinks href=#hl-6-143>143</a>
</span><span class=lnt id=hl-6-144><a class=lnlinks href=#hl-6-144>144</a>
</span><span class=lnt id=hl-6-145><a class=lnlinks href=#hl-6-145>145</a>
</span><span class=lnt id=hl-6-146><a class=lnlinks href=#hl-6-146>146</a>
</span><span class=lnt id=hl-6-147><a class=lnlinks href=#hl-6-147>147</a>
</span><span class=lnt id=hl-6-148><a class=lnlinks href=#hl-6-148>148</a>
</span><span class=lnt id=hl-6-149><a class=lnlinks href=#hl-6-149>149</a>
</span><span class=lnt id=hl-6-150><a class=lnlinks href=#hl-6-150>150</a>
</span><span class=lnt id=hl-6-151><a class=lnlinks href=#hl-6-151>151</a>
</span><span class=lnt id=hl-6-152><a class=lnlinks href=#hl-6-152>152</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 데이터 파이프라인 예시 코드 (Airflow 사용)</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow</span> <span class=kn>import</span> <span class=n>DAG</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.operators.python_operator</span> <span class=kn>import</span> <span class=n>PythonOperator</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span><span class=p>,</span> <span class=n>timedelta</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.preprocessing</span> <span class=kn>import</span> <span class=n>StandardScaler</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>default_args</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;owner&#39;</span><span class=p>:</span> <span class=s1>&#39;ai_team&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;depends_on_past&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;start_date&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=p>(</span><span class=mi>2023</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;email_on_failure&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;email_on_retry&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;retries&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;retry_delay&#39;</span><span class=p>:</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>minutes</span><span class=o>=</span><span class=mi>5</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dag</span> <span class=o>=</span> <span class=n>DAG</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;customer_churn_data_pipeline&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>default_args</span><span class=o>=</span><span class=n>default_args</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=o>=</span><span class=s1>&#39;Customer churn data processing pipeline&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>schedule_interval</span><span class=o>=</span><span class=s1>&#39;@daily&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_customer_data</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;고객 데이터 추출 함수&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 데이터베이스에서 고객 데이터 추출</span>
</span></span><span class=line><span class=cl>        <span class=c1># 실제 구현에서는 SQL 쿼리 또는 API 호출 사용</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Extracting customer data...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 예시 데이터 (실제로는 DB에서 가져옴)</span>
</span></span><span class=line><span class=cl>        <span class=n>customers</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1000</span><span class=p>,</span> <span class=mi>1100</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;subscription_length&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;monthly_charges&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=mi>20</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_charges&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>5000</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;contract_type&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;Monthly&#39;</span><span class=p>,</span> <span class=s1>&#39;One year&#39;</span><span class=p>,</span> <span class=s1>&#39;Two year&#39;</span><span class=p>],</span> <span class=mi>100</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;payment_method&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=s1>&#39;Credit card&#39;</span><span class=p>,</span> <span class=s1>&#39;Bank transfer&#39;</span><span class=p>,</span> <span class=s1>&#39;Electronic check&#39;</span><span class=p>],</span> <span class=mi>100</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;tech_support_calls&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;last_active_days&#39;</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>30</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 결과 저장</span>
</span></span><span class=line><span class=cl>        <span class=n>customers</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=s1>&#39;/tmp/raw_customer_data.csv&#39;</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;/tmp/raw_customer_data.csv&#39;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error extracting customer data: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>validate_data</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;데이터 검증 함수&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>input_path</span> <span class=o>=</span> <span class=n>kwargs</span><span class=p>[</span><span class=s1>&#39;ti&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>xcom_pull</span><span class=p>(</span><span class=n>task_ids</span><span class=o>=</span><span class=s1>&#39;extract_customer_data&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Validating data from </span><span class=si>{</span><span class=n>input_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 데이터 로드</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>input_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 데이터 검증 로직</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. 필수 열 존재 확인</span>
</span></span><span class=line><span class=cl>        <span class=n>required_columns</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=s1>&#39;subscription_length&#39;</span><span class=p>,</span> <span class=s1>&#39;monthly_charges&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>missing_columns</span> <span class=o>=</span> <span class=p>[</span><span class=n>col</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>required_columns</span> <span class=k>if</span> <span class=n>col</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>missing_columns</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Missing required columns: </span><span class=si>{</span><span class=n>missing_columns</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. 중복 고객 ID 확인</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>duplicated</span><span class=p>()</span><span class=o>.</span><span class=n>any</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Duplicate customer IDs found&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. 데이터 범위 확인</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;monthly_charges&#39;</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>any</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Negative monthly charges found&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 4. 결측치 확인</span>
</span></span><span class=line><span class=cl>        <span class=n>missing_values</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>isnull</span><span class=p>()</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>missing_values</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Missing values found: </span><span class=si>{</span><span class=n>missing_values</span><span class=p>[</span><span class=n>missing_values</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 검증 통과 - 데이터 저장</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=s1>&#39;/tmp/validated_customer_data.csv&#39;</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;/tmp/validated_customer_data.csv&#39;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Data validation error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>transform_features</span><span class=p>(</span><span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;특성 엔지니어링 함수&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>input_path</span> <span class=o>=</span> <span class=n>kwargs</span><span class=p>[</span><span class=s1>&#39;ti&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>xcom_pull</span><span class=p>(</span><span class=n>task_ids</span><span class=o>=</span><span class=s1>&#39;validate_data&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Transforming features from </span><span class=si>{</span><span class=n>input_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 데이터 로드</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>input_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 특성 엔지니어링</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. 범주형 변수 원-핫 인코딩</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>get_dummies</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;contract_type&#39;</span><span class=p>,</span> <span class=s1>&#39;payment_method&#39;</span><span class=p>],</span> <span class=n>drop_first</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. 새로운 특성 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span><span class=p>[</span><span class=s1>&#39;avg_monthly_charge&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;total_charges&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;subscription_length&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span><span class=p>[</span><span class=s1>&#39;inactive_ratio&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;last_active_days&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=mi>30</span>  <span class=c1># 활동 비율 계산</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. 수치형 특성 정규화</span>
</span></span><span class=line><span class=cl>        <span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>numeric_features</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;subscription_length&#39;</span><span class=p>,</span> <span class=s1>&#39;monthly_charges&#39;</span><span class=p>,</span> <span class=s1>&#39;total_charges&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                           <span class=s1>&#39;tech_support_calls&#39;</span><span class=p>,</span> <span class=s1>&#39;avg_monthly_charge&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span><span class=p>[</span><span class=n>numeric_features</span><span class=p>]</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=n>numeric_features</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 4. 특성 선택 (중요한 특성만 유지)</span>
</span></span><span class=line><span class=cl>        <span class=n>selected_columns</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=s1>&#39;subscription_length&#39;</span><span class=p>,</span> <span class=s1>&#39;monthly_charges&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                           <span class=s1>&#39;tech_support_calls&#39;</span><span class=p>,</span> <span class=s1>&#39;last_active_days&#39;</span><span class=p>,</span> <span class=s1>&#39;inactive_ratio&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                           <span class=s1>&#39;avg_monthly_charge&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=n>col</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span> <span class=k>if</span> <span class=s1>&#39;contract_type&#39;</span> <span class=ow>in</span> <span class=n>col</span> 
</span></span><span class=line><span class=cl>                                                  <span class=ow>or</span> <span class=s1>&#39;payment_method&#39;</span> <span class=ow>in</span> <span class=n>col</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>selected_columns</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 변환된 데이터 저장</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span><span class=o>.</span><span class=n>to_csv</span><span class=p>(</span><span class=s1>&#39;/tmp/features_customer_data.csv&#39;</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;/tmp/features_customer_data.csv&#39;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Feature transformation error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># DAG 태스크 정의</span>
</span></span><span class=line><span class=cl><span class=n>extract_task</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>task_id</span><span class=o>=</span><span class=s1>&#39;extract_customer_data&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>python_callable</span><span class=o>=</span><span class=n>extract_customer_data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>provide_context</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>dag</span><span class=o>=</span><span class=n>dag</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>validate_task</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>task_id</span><span class=o>=</span><span class=s1>&#39;validate_data&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>python_callable</span><span class=o>=</span><span class=n>validate_data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>provide_context</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>dag</span><span class=o>=</span><span class=n>dag</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>transform_task</span> <span class=o>=</span> <span class=n>PythonOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>task_id</span><span class=o>=</span><span class=s1>&#39;transform_features&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>python_callable</span><span class=o>=</span><span class=n>transform_features</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>provide_context</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>dag</span><span class=o>=</span><span class=n>dag</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 태스크 의존성 설정</span>
</span></span><span class=line><span class=cl><span class=n>extract_task</span> <span class=o>&gt;&gt;</span> <span class=n>validate_task</span> <span class=o>&gt;&gt;</span> <span class=n>transform_task</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=모델-개발-및-훈련-1>모델 개발 및 훈련<a hidden class=anchor aria-hidden=true href=#모델-개발-및-훈련-1>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>  1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2>  2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3>  3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4>  4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5>  5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6>  6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7>  7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8>  8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9>  9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10> 10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11> 11</a>
</span><span class=lnt id=hl-7-12><a class=lnlinks href=#hl-7-12> 12</a>
</span><span class=lnt id=hl-7-13><a class=lnlinks href=#hl-7-13> 13</a>
</span><span class=lnt id=hl-7-14><a class=lnlinks href=#hl-7-14> 14</a>
</span><span class=lnt id=hl-7-15><a class=lnlinks href=#hl-7-15> 15</a>
</span><span class=lnt id=hl-7-16><a class=lnlinks href=#hl-7-16> 16</a>
</span><span class=lnt id=hl-7-17><a class=lnlinks href=#hl-7-17> 17</a>
</span><span class=lnt id=hl-7-18><a class=lnlinks href=#hl-7-18> 18</a>
</span><span class=lnt id=hl-7-19><a class=lnlinks href=#hl-7-19> 19</a>
</span><span class=lnt id=hl-7-20><a class=lnlinks href=#hl-7-20> 20</a>
</span><span class=lnt id=hl-7-21><a class=lnlinks href=#hl-7-21> 21</a>
</span><span class=lnt id=hl-7-22><a class=lnlinks href=#hl-7-22> 22</a>
</span><span class=lnt id=hl-7-23><a class=lnlinks href=#hl-7-23> 23</a>
</span><span class=lnt id=hl-7-24><a class=lnlinks href=#hl-7-24> 24</a>
</span><span class=lnt id=hl-7-25><a class=lnlinks href=#hl-7-25> 25</a>
</span><span class=lnt id=hl-7-26><a class=lnlinks href=#hl-7-26> 26</a>
</span><span class=lnt id=hl-7-27><a class=lnlinks href=#hl-7-27> 27</a>
</span><span class=lnt id=hl-7-28><a class=lnlinks href=#hl-7-28> 28</a>
</span><span class=lnt id=hl-7-29><a class=lnlinks href=#hl-7-29> 29</a>
</span><span class=lnt id=hl-7-30><a class=lnlinks href=#hl-7-30> 30</a>
</span><span class=lnt id=hl-7-31><a class=lnlinks href=#hl-7-31> 31</a>
</span><span class=lnt id=hl-7-32><a class=lnlinks href=#hl-7-32> 32</a>
</span><span class=lnt id=hl-7-33><a class=lnlinks href=#hl-7-33> 33</a>
</span><span class=lnt id=hl-7-34><a class=lnlinks href=#hl-7-34> 34</a>
</span><span class=lnt id=hl-7-35><a class=lnlinks href=#hl-7-35> 35</a>
</span><span class=lnt id=hl-7-36><a class=lnlinks href=#hl-7-36> 36</a>
</span><span class=lnt id=hl-7-37><a class=lnlinks href=#hl-7-37> 37</a>
</span><span class=lnt id=hl-7-38><a class=lnlinks href=#hl-7-38> 38</a>
</span><span class=lnt id=hl-7-39><a class=lnlinks href=#hl-7-39> 39</a>
</span><span class=lnt id=hl-7-40><a class=lnlinks href=#hl-7-40> 40</a>
</span><span class=lnt id=hl-7-41><a class=lnlinks href=#hl-7-41> 41</a>
</span><span class=lnt id=hl-7-42><a class=lnlinks href=#hl-7-42> 42</a>
</span><span class=lnt id=hl-7-43><a class=lnlinks href=#hl-7-43> 43</a>
</span><span class=lnt id=hl-7-44><a class=lnlinks href=#hl-7-44> 44</a>
</span><span class=lnt id=hl-7-45><a class=lnlinks href=#hl-7-45> 45</a>
</span><span class=lnt id=hl-7-46><a class=lnlinks href=#hl-7-46> 46</a>
</span><span class=lnt id=hl-7-47><a class=lnlinks href=#hl-7-47> 47</a>
</span><span class=lnt id=hl-7-48><a class=lnlinks href=#hl-7-48> 48</a>
</span><span class=lnt id=hl-7-49><a class=lnlinks href=#hl-7-49> 49</a>
</span><span class=lnt id=hl-7-50><a class=lnlinks href=#hl-7-50> 50</a>
</span><span class=lnt id=hl-7-51><a class=lnlinks href=#hl-7-51> 51</a>
</span><span class=lnt id=hl-7-52><a class=lnlinks href=#hl-7-52> 52</a>
</span><span class=lnt id=hl-7-53><a class=lnlinks href=#hl-7-53> 53</a>
</span><span class=lnt id=hl-7-54><a class=lnlinks href=#hl-7-54> 54</a>
</span><span class=lnt id=hl-7-55><a class=lnlinks href=#hl-7-55> 55</a>
</span><span class=lnt id=hl-7-56><a class=lnlinks href=#hl-7-56> 56</a>
</span><span class=lnt id=hl-7-57><a class=lnlinks href=#hl-7-57> 57</a>
</span><span class=lnt id=hl-7-58><a class=lnlinks href=#hl-7-58> 58</a>
</span><span class=lnt id=hl-7-59><a class=lnlinks href=#hl-7-59> 59</a>
</span><span class=lnt id=hl-7-60><a class=lnlinks href=#hl-7-60> 60</a>
</span><span class=lnt id=hl-7-61><a class=lnlinks href=#hl-7-61> 61</a>
</span><span class=lnt id=hl-7-62><a class=lnlinks href=#hl-7-62> 62</a>
</span><span class=lnt id=hl-7-63><a class=lnlinks href=#hl-7-63> 63</a>
</span><span class=lnt id=hl-7-64><a class=lnlinks href=#hl-7-64> 64</a>
</span><span class=lnt id=hl-7-65><a class=lnlinks href=#hl-7-65> 65</a>
</span><span class=lnt id=hl-7-66><a class=lnlinks href=#hl-7-66> 66</a>
</span><span class=lnt id=hl-7-67><a class=lnlinks href=#hl-7-67> 67</a>
</span><span class=lnt id=hl-7-68><a class=lnlinks href=#hl-7-68> 68</a>
</span><span class=lnt id=hl-7-69><a class=lnlinks href=#hl-7-69> 69</a>
</span><span class=lnt id=hl-7-70><a class=lnlinks href=#hl-7-70> 70</a>
</span><span class=lnt id=hl-7-71><a class=lnlinks href=#hl-7-71> 71</a>
</span><span class=lnt id=hl-7-72><a class=lnlinks href=#hl-7-72> 72</a>
</span><span class=lnt id=hl-7-73><a class=lnlinks href=#hl-7-73> 73</a>
</span><span class=lnt id=hl-7-74><a class=lnlinks href=#hl-7-74> 74</a>
</span><span class=lnt id=hl-7-75><a class=lnlinks href=#hl-7-75> 75</a>
</span><span class=lnt id=hl-7-76><a class=lnlinks href=#hl-7-76> 76</a>
</span><span class=lnt id=hl-7-77><a class=lnlinks href=#hl-7-77> 77</a>
</span><span class=lnt id=hl-7-78><a class=lnlinks href=#hl-7-78> 78</a>
</span><span class=lnt id=hl-7-79><a class=lnlinks href=#hl-7-79> 79</a>
</span><span class=lnt id=hl-7-80><a class=lnlinks href=#hl-7-80> 80</a>
</span><span class=lnt id=hl-7-81><a class=lnlinks href=#hl-7-81> 81</a>
</span><span class=lnt id=hl-7-82><a class=lnlinks href=#hl-7-82> 82</a>
</span><span class=lnt id=hl-7-83><a class=lnlinks href=#hl-7-83> 83</a>
</span><span class=lnt id=hl-7-84><a class=lnlinks href=#hl-7-84> 84</a>
</span><span class=lnt id=hl-7-85><a class=lnlinks href=#hl-7-85> 85</a>
</span><span class=lnt id=hl-7-86><a class=lnlinks href=#hl-7-86> 86</a>
</span><span class=lnt id=hl-7-87><a class=lnlinks href=#hl-7-87> 87</a>
</span><span class=lnt id=hl-7-88><a class=lnlinks href=#hl-7-88> 88</a>
</span><span class=lnt id=hl-7-89><a class=lnlinks href=#hl-7-89> 89</a>
</span><span class=lnt id=hl-7-90><a class=lnlinks href=#hl-7-90> 90</a>
</span><span class=lnt id=hl-7-91><a class=lnlinks href=#hl-7-91> 91</a>
</span><span class=lnt id=hl-7-92><a class=lnlinks href=#hl-7-92> 92</a>
</span><span class=lnt id=hl-7-93><a class=lnlinks href=#hl-7-93> 93</a>
</span><span class=lnt id=hl-7-94><a class=lnlinks href=#hl-7-94> 94</a>
</span><span class=lnt id=hl-7-95><a class=lnlinks href=#hl-7-95> 95</a>
</span><span class=lnt id=hl-7-96><a class=lnlinks href=#hl-7-96> 96</a>
</span><span class=lnt id=hl-7-97><a class=lnlinks href=#hl-7-97> 97</a>
</span><span class=lnt id=hl-7-98><a class=lnlinks href=#hl-7-98> 98</a>
</span><span class=lnt id=hl-7-99><a class=lnlinks href=#hl-7-99> 99</a>
</span><span class=lnt id=hl-7-100><a class=lnlinks href=#hl-7-100>100</a>
</span><span class=lnt id=hl-7-101><a class=lnlinks href=#hl-7-101>101</a>
</span><span class=lnt id=hl-7-102><a class=lnlinks href=#hl-7-102>102</a>
</span><span class=lnt id=hl-7-103><a class=lnlinks href=#hl-7-103>103</a>
</span><span class=lnt id=hl-7-104><a class=lnlinks href=#hl-7-104>104</a>
</span><span class=lnt id=hl-7-105><a class=lnlinks href=#hl-7-105>105</a>
</span><span class=lnt id=hl-7-106><a class=lnlinks href=#hl-7-106>106</a>
</span><span class=lnt id=hl-7-107><a class=lnlinks href=#hl-7-107>107</a>
</span><span class=lnt id=hl-7-108><a class=lnlinks href=#hl-7-108>108</a>
</span><span class=lnt id=hl-7-109><a class=lnlinks href=#hl-7-109>109</a>
</span><span class=lnt id=hl-7-110><a class=lnlinks href=#hl-7-110>110</a>
</span><span class=lnt id=hl-7-111><a class=lnlinks href=#hl-7-111>111</a>
</span><span class=lnt id=hl-7-112><a class=lnlinks href=#hl-7-112>112</a>
</span><span class=lnt id=hl-7-113><a class=lnlinks href=#hl-7-113>113</a>
</span><span class=lnt id=hl-7-114><a class=lnlinks href=#hl-7-114>114</a>
</span><span class=lnt id=hl-7-115><a class=lnlinks href=#hl-7-115>115</a>
</span><span class=lnt id=hl-7-116><a class=lnlinks href=#hl-7-116>116</a>
</span><span class=lnt id=hl-7-117><a class=lnlinks href=#hl-7-117>117</a>
</span><span class=lnt id=hl-7-118><a class=lnlinks href=#hl-7-118>118</a>
</span><span class=lnt id=hl-7-119><a class=lnlinks href=#hl-7-119>119</a>
</span><span class=lnt id=hl-7-120><a class=lnlinks href=#hl-7-120>120</a>
</span><span class=lnt id=hl-7-121><a class=lnlinks href=#hl-7-121>121</a>
</span><span class=lnt id=hl-7-122><a class=lnlinks href=#hl-7-122>122</a>
</span><span class=lnt id=hl-7-123><a class=lnlinks href=#hl-7-123>123</a>
</span><span class=lnt id=hl-7-124><a class=lnlinks href=#hl-7-124>124</a>
</span><span class=lnt id=hl-7-125><a class=lnlinks href=#hl-7-125>125</a>
</span><span class=lnt id=hl-7-126><a class=lnlinks href=#hl-7-126>126</a>
</span><span class=lnt id=hl-7-127><a class=lnlinks href=#hl-7-127>127</a>
</span><span class=lnt id=hl-7-128><a class=lnlinks href=#hl-7-128>128</a>
</span><span class=lnt id=hl-7-129><a class=lnlinks href=#hl-7-129>129</a>
</span><span class=lnt id=hl-7-130><a class=lnlinks href=#hl-7-130>130</a>
</span><span class=lnt id=hl-7-131><a class=lnlinks href=#hl-7-131>131</a>
</span><span class=lnt id=hl-7-132><a class=lnlinks href=#hl-7-132>132</a>
</span><span class=lnt id=hl-7-133><a class=lnlinks href=#hl-7-133>133</a>
</span><span class=lnt id=hl-7-134><a class=lnlinks href=#hl-7-134>134</a>
</span><span class=lnt id=hl-7-135><a class=lnlinks href=#hl-7-135>135</a>
</span><span class=lnt id=hl-7-136><a class=lnlinks href=#hl-7-136>136</a>
</span><span class=lnt id=hl-7-137><a class=lnlinks href=#hl-7-137>137</a>
</span><span class=lnt id=hl-7-138><a class=lnlinks href=#hl-7-138>138</a>
</span><span class=lnt id=hl-7-139><a class=lnlinks href=#hl-7-139>139</a>
</span><span class=lnt id=hl-7-140><a class=lnlinks href=#hl-7-140>140</a>
</span><span class=lnt id=hl-7-141><a class=lnlinks href=#hl-7-141>141</a>
</span><span class=lnt id=hl-7-142><a class=lnlinks href=#hl-7-142>142</a>
</span><span class=lnt id=hl-7-143><a class=lnlinks href=#hl-7-143>143</a>
</span><span class=lnt id=hl-7-144><a class=lnlinks href=#hl-7-144>144</a>
</span><span class=lnt id=hl-7-145><a class=lnlinks href=#hl-7-145>145</a>
</span><span class=lnt id=hl-7-146><a class=lnlinks href=#hl-7-146>146</a>
</span><span class=lnt id=hl-7-147><a class=lnlinks href=#hl-7-147>147</a>
</span><span class=lnt id=hl-7-148><a class=lnlinks href=#hl-7-148>148</a>
</span><span class=lnt id=hl-7-149><a class=lnlinks href=#hl-7-149>149</a>
</span><span class=lnt id=hl-7-150><a class=lnlinks href=#hl-7-150>150</a>
</span><span class=lnt id=hl-7-151><a class=lnlinks href=#hl-7-151>151</a>
</span><span class=lnt id=hl-7-152><a class=lnlinks href=#hl-7-152>152</a>
</span><span class=lnt id=hl-7-153><a class=lnlinks href=#hl-7-153>153</a>
</span><span class=lnt id=hl-7-154><a class=lnlinks href=#hl-7-154>154</a>
</span><span class=lnt id=hl-7-155><a class=lnlinks href=#hl-7-155>155</a>
</span><span class=lnt id=hl-7-156><a class=lnlinks href=#hl-7-156>156</a>
</span><span class=lnt id=hl-7-157><a class=lnlinks href=#hl-7-157>157</a>
</span><span class=lnt id=hl-7-158><a class=lnlinks href=#hl-7-158>158</a>
</span><span class=lnt id=hl-7-159><a class=lnlinks href=#hl-7-159>159</a>
</span><span class=lnt id=hl-7-160><a class=lnlinks href=#hl-7-160>160</a>
</span><span class=lnt id=hl-7-161><a class=lnlinks href=#hl-7-161>161</a>
</span><span class=lnt id=hl-7-162><a class=lnlinks href=#hl-7-162>162</a>
</span><span class=lnt id=hl-7-163><a class=lnlinks href=#hl-7-163>163</a>
</span><span class=lnt id=hl-7-164><a class=lnlinks href=#hl-7-164>164</a>
</span><span class=lnt id=hl-7-165><a class=lnlinks href=#hl-7-165>165</a>
</span><span class=lnt id=hl-7-166><a class=lnlinks href=#hl-7-166>166</a>
</span><span class=lnt id=hl-7-167><a class=lnlinks href=#hl-7-167>167</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 모델 훈련 및 평가 예시 코드 (MLflow 사용)</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.model_selection</span> <span class=kn>import</span> <span class=n>train_test_split</span><span class=p>,</span> <span class=n>cross_val_score</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.ensemble</span> <span class=kn>import</span> <span class=n>RandomForestClassifier</span><span class=p>,</span> <span class=n>GradientBoostingClassifier</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.linear_model</span> <span class=kn>import</span> <span class=n>LogisticRegression</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.metrics</span> <span class=kn>import</span> <span class=n>accuracy_score</span><span class=p>,</span> <span class=n>precision_score</span><span class=p>,</span> <span class=n>recall_score</span><span class=p>,</span> <span class=n>f1_score</span><span class=p>,</span> <span class=n>roc_auc_score</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.pipeline</span> <span class=kn>import</span> <span class=n>Pipeline</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.compose</span> <span class=kn>import</span> <span class=n>ColumnTransformer</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.preprocessing</span> <span class=kn>import</span> <span class=n>StandardScaler</span><span class=p>,</span> <span class=n>OneHotEncoder</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>mlflow</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>mlflow.sklearn</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 로깅 설정</span>
</span></span><span class=line><span class=cl><span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> - </span><span class=si>%(name)s</span><span class=s1> - </span><span class=si>%(levelname)s</span><span class=s1> - </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>load_train_data</span><span class=p>(</span><span class=n>path</span><span class=o>=</span><span class=s1>&#39;/tmp/features_customer_data.csv&#39;</span><span class=p>,</span> <span class=n>target_path</span><span class=o>=</span><span class=s1>&#39;/tmp/customer_churn_labels.csv&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;훈련 데이터 및 레이블 로드&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 특성 데이터 로드</span>
</span></span><span class=line><span class=cl>        <span class=n>features</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 타겟 데이터 로드 (이탈 여부)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 실제 구현에서는 이 데이터가 별도 소스에서 올 수 있음</span>
</span></span><span class=line><span class=cl>        <span class=n>targets</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>target_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 고객 ID로 데이터 병합</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>features</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>targets</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=s1>&#39;customer_id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># ID 열 분리</span>
</span></span><span class=line><span class=cl>        <span class=n>X</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>drop</span><span class=p>([</span><span class=s1>&#39;customer_id&#39;</span><span class=p>,</span> <span class=s1>&#39;churn&#39;</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;churn&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error loading training data: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>train_evaluate_model</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>model_type</span><span class=o>=</span><span class=s1>&#39;random_forest&#39;</span><span class=p>,</span> <span class=n>experiment_name</span><span class=o>=</span><span class=s1>&#39;churn_prediction&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;모델 훈련 및 평가&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># MLflow 실험 설정</span>
</span></span><span class=line><span class=cl>        <span class=n>mlflow</span><span class=o>.</span><span class=n>set_experiment</span><span class=p>(</span><span class=n>experiment_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 데이터 분할</span>
</span></span><span class=line><span class=cl>        <span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>test_size</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># MLflow 실행 시작</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=n>mlflow</span><span class=o>.</span><span class=n>start_run</span><span class=p>()</span> <span class=k>as</span> <span class=n>run</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 모델 선택</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>model_type</span> <span class=o>==</span> <span class=s1>&#39;random_forest&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>model</span> <span class=o>=</span> <span class=n>RandomForestClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>params</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;n_estimators&#39;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;max_depth&#39;</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;min_samples_split&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;min_samples_leaf&#39;</span><span class=p>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>model_type</span> <span class=o>==</span> <span class=s1>&#39;gradient_boosting&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>model</span> <span class=o>=</span> <span class=n>GradientBoostingClassifier</span><span class=p>(</span><span class=n>n_estimators</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>params</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;n_estimators&#39;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;learning_rate&#39;</span><span class=p>:</span> <span class=mf>0.1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;max_depth&#39;</span><span class=p>:</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>model_type</span> <span class=o>==</span> <span class=s1>&#39;logistic_regression&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>model</span> <span class=o>=</span> <span class=n>LogisticRegression</span><span class=p>(</span><span class=n>max_iter</span><span class=o>=</span><span class=mi>1000</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>params</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;C&#39;</span><span class=p>:</span> <span class=mf>1.0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;penalty&#39;</span><span class=p>:</span> <span class=s1>&#39;l2&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;solver&#39;</span><span class=p>:</span> <span class=s1>&#39;lbfgs&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Unsupported model type: </span><span class=si>{</span><span class=n>model_type</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 파라미터 로깅</span>
</span></span><span class=line><span class=cl>            <span class=n>mlflow</span><span class=o>.</span><span class=n>log_params</span><span class=p>(</span><span class=n>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 모델 훈련</span>
</span></span><span class=line><span class=cl>            <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span> <span class=n>y_train</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 예측</span>
</span></span><span class=line><span class=cl>            <span class=n>y_pred</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>y_prob</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict_proba</span><span class=p>(</span><span class=n>X_test</span><span class=p>)[:,</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 평가 메트릭 계산</span>
</span></span><span class=line><span class=cl>            <span class=n>accuracy</span> <span class=o>=</span> <span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>precision</span> <span class=o>=</span> <span class=n>precision_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>recall</span> <span class=o>=</span> <span class=n>recall_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>f1</span> <span class=o>=</span> <span class=n>f1_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>roc_auc</span> <span class=o>=</span> <span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_prob</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 메트릭 로깅</span>
</span></span><span class=line><span class=cl>            <span class=n>metrics</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;accuracy&#39;</span><span class=p>:</span> <span class=n>accuracy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;precision&#39;</span><span class=p>:</span> <span class=n>precision</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;recall&#39;</span><span class=p>:</span> <span class=n>recall</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;f1_score&#39;</span><span class=p>:</span> <span class=n>f1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;roc_auc&#39;</span><span class=p>:</span> <span class=n>roc_auc</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=n>mlflow</span><span class=o>.</span><span class=n>log_metrics</span><span class=p>(</span><span class=n>metrics</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 모델 저장</span>
</span></span><span class=line><span class=cl>            <span class=n>mlflow</span><span class=o>.</span><span class=n>sklearn</span><span class=o>.</span><span class=n>log_model</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=s2>&#34;model&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 결과 출력</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Model training completed with metrics: </span><span class=si>{</span><span class=n>metrics</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 교차 검증 수행</span>
</span></span><span class=line><span class=cl>            <span class=n>cv_scores</span> <span class=o>=</span> <span class=n>cross_val_score</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>cv</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>scoring</span><span class=o>=</span><span class=s1>&#39;roc_auc&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>mlflow</span><span class=o>.</span><span class=n>log_metric</span><span class=p>(</span><span class=s2>&#34;cv_roc_auc_mean&#34;</span><span class=p>,</span> <span class=n>cv_scores</span><span class=o>.</span><span class=n>mean</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=n>mlflow</span><span class=o>.</span><span class=n>log_metric</span><span class=p>(</span><span class=s2>&#34;cv_roc_auc_std&#34;</span><span class=p>,</span> <span class=n>cv_scores</span><span class=o>.</span><span class=n>std</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Cross-validation ROC AUC: </span><span class=si>{</span><span class=n>cv_scores</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2> ± </span><span class=si>{</span><span class=n>cv_scores</span><span class=o>.</span><span class=n>std</span><span class=p>()</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;model&#39;</span><span class=p>:</span> <span class=n>model</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;metrics&#39;</span><span class=p>:</span> <span class=n>metrics</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;run_id&#39;</span><span class=p>:</span> <span class=n>run</span><span class=o>.</span><span class=n>info</span><span class=o>.</span><span class=n>run_id</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error in model training and evaluation: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;메인 실행 함수&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 데이터 로드</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Loading training data...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>load_train_data</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 여러 모델 학습 및 평가</span>
</span></span><span class=line><span class=cl>        <span class=n>models</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;random_forest&#39;</span><span class=p>,</span> <span class=s1>&#39;gradient_boosting&#39;</span><span class=p>,</span> <span class=s1>&#39;logistic_regression&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>results</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>model_type</span> <span class=ow>in</span> <span class=n>models</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Training and evaluating </span><span class=si>{</span><span class=n>model_type</span><span class=si>}</span><span class=s2> model...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>results</span><span class=p>[</span><span class=n>model_type</span><span class=p>]</span> <span class=o>=</span> <span class=n>train_evaluate_model</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>model_type</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 최고 성능 모델 선택</span>
</span></span><span class=line><span class=cl>        <span class=n>best_model_type</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>results</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>k</span><span class=p>:</span> <span class=n>results</span><span class=p>[</span><span class=n>k</span><span class=p>][</span><span class=s1>&#39;metrics&#39;</span><span class=p>][</span><span class=s1>&#39;roc_auc&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>best_model_results</span> <span class=o>=</span> <span class=n>results</span><span class=p>[</span><span class=n>best_model_type</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Best model: </span><span class=si>{</span><span class=n>best_model_type</span><span class=si>}</span><span class=s2> with ROC AUC: </span><span class=si>{</span><span class=n>best_model_results</span><span class=p>[</span><span class=s1>&#39;metrics&#39;</span><span class=p>][</span><span class=s1>&#39;roc_auc&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.4f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 최고 성능 모델 등록 (모델 레지스트리 사용)</span>
</span></span><span class=line><span class=cl>        <span class=n>mlflow</span><span class=o>.</span><span class=n>set_tracking_uri</span><span class=p>(</span><span class=s2>&#34;http://localhost:5000&#34;</span><span class=p>)</span>  <span class=c1># MLflow 서버 주소</span>
</span></span><span class=line><span class=cl>        <span class=n>model_name</span> <span class=o>=</span> <span class=s2>&#34;customer_churn_predictor&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>model_version</span> <span class=o>=</span> <span class=n>mlflow</span><span class=o>.</span><span class=n>register_model</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;runs:/</span><span class=si>{</span><span class=n>best_model_results</span><span class=p>[</span><span class=s1>&#39;run_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>/model&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>model_name</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Registered model: </span><span class=si>{</span><span class=n>model_name</span><span class=si>}</span><span class=s2> version </span><span class=si>{</span><span class=n>model_version</span><span class=o>.</span><span class=n>version</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>best_model_results</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error in main function: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=모델-배포-및-api-구현>모델 배포 및 API 구현<a hidden class=anchor aria-hidden=true href=#모델-배포-및-api-구현>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>  1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>  2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>  3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>  4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>  5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6>  6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7>  7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8>  8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9>  9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10> 10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11> 11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12> 12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13> 13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14> 14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15> 15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16> 16</a>
</span><span class=lnt id=hl-8-17><a class=lnlinks href=#hl-8-17> 17</a>
</span><span class=lnt id=hl-8-18><a class=lnlinks href=#hl-8-18> 18</a>
</span><span class=lnt id=hl-8-19><a class=lnlinks href=#hl-8-19> 19</a>
</span><span class=lnt id=hl-8-20><a class=lnlinks href=#hl-8-20> 20</a>
</span><span class=lnt id=hl-8-21><a class=lnlinks href=#hl-8-21> 21</a>
</span><span class=lnt id=hl-8-22><a class=lnlinks href=#hl-8-22> 22</a>
</span><span class=lnt id=hl-8-23><a class=lnlinks href=#hl-8-23> 23</a>
</span><span class=lnt id=hl-8-24><a class=lnlinks href=#hl-8-24> 24</a>
</span><span class=lnt id=hl-8-25><a class=lnlinks href=#hl-8-25> 25</a>
</span><span class=lnt id=hl-8-26><a class=lnlinks href=#hl-8-26> 26</a>
</span><span class=lnt id=hl-8-27><a class=lnlinks href=#hl-8-27> 27</a>
</span><span class=lnt id=hl-8-28><a class=lnlinks href=#hl-8-28> 28</a>
</span><span class=lnt id=hl-8-29><a class=lnlinks href=#hl-8-29> 29</a>
</span><span class=lnt id=hl-8-30><a class=lnlinks href=#hl-8-30> 30</a>
</span><span class=lnt id=hl-8-31><a class=lnlinks href=#hl-8-31> 31</a>
</span><span class=lnt id=hl-8-32><a class=lnlinks href=#hl-8-32> 32</a>
</span><span class=lnt id=hl-8-33><a class=lnlinks href=#hl-8-33> 33</a>
</span><span class=lnt id=hl-8-34><a class=lnlinks href=#hl-8-34> 34</a>
</span><span class=lnt id=hl-8-35><a class=lnlinks href=#hl-8-35> 35</a>
</span><span class=lnt id=hl-8-36><a class=lnlinks href=#hl-8-36> 36</a>
</span><span class=lnt id=hl-8-37><a class=lnlinks href=#hl-8-37> 37</a>
</span><span class=lnt id=hl-8-38><a class=lnlinks href=#hl-8-38> 38</a>
</span><span class=lnt id=hl-8-39><a class=lnlinks href=#hl-8-39> 39</a>
</span><span class=lnt id=hl-8-40><a class=lnlinks href=#hl-8-40> 40</a>
</span><span class=lnt id=hl-8-41><a class=lnlinks href=#hl-8-41> 41</a>
</span><span class=lnt id=hl-8-42><a class=lnlinks href=#hl-8-42> 42</a>
</span><span class=lnt id=hl-8-43><a class=lnlinks href=#hl-8-43> 43</a>
</span><span class=lnt id=hl-8-44><a class=lnlinks href=#hl-8-44> 44</a>
</span><span class=lnt id=hl-8-45><a class=lnlinks href=#hl-8-45> 45</a>
</span><span class=lnt id=hl-8-46><a class=lnlinks href=#hl-8-46> 46</a>
</span><span class=lnt id=hl-8-47><a class=lnlinks href=#hl-8-47> 47</a>
</span><span class=lnt id=hl-8-48><a class=lnlinks href=#hl-8-48> 48</a>
</span><span class=lnt id=hl-8-49><a class=lnlinks href=#hl-8-49> 49</a>
</span><span class=lnt id=hl-8-50><a class=lnlinks href=#hl-8-50> 50</a>
</span><span class=lnt id=hl-8-51><a class=lnlinks href=#hl-8-51> 51</a>
</span><span class=lnt id=hl-8-52><a class=lnlinks href=#hl-8-52> 52</a>
</span><span class=lnt id=hl-8-53><a class=lnlinks href=#hl-8-53> 53</a>
</span><span class=lnt id=hl-8-54><a class=lnlinks href=#hl-8-54> 54</a>
</span><span class=lnt id=hl-8-55><a class=lnlinks href=#hl-8-55> 55</a>
</span><span class=lnt id=hl-8-56><a class=lnlinks href=#hl-8-56> 56</a>
</span><span class=lnt id=hl-8-57><a class=lnlinks href=#hl-8-57> 57</a>
</span><span class=lnt id=hl-8-58><a class=lnlinks href=#hl-8-58> 58</a>
</span><span class=lnt id=hl-8-59><a class=lnlinks href=#hl-8-59> 59</a>
</span><span class=lnt id=hl-8-60><a class=lnlinks href=#hl-8-60> 60</a>
</span><span class=lnt id=hl-8-61><a class=lnlinks href=#hl-8-61> 61</a>
</span><span class=lnt id=hl-8-62><a class=lnlinks href=#hl-8-62> 62</a>
</span><span class=lnt id=hl-8-63><a class=lnlinks href=#hl-8-63> 63</a>
</span><span class=lnt id=hl-8-64><a class=lnlinks href=#hl-8-64> 64</a>
</span><span class=lnt id=hl-8-65><a class=lnlinks href=#hl-8-65> 65</a>
</span><span class=lnt id=hl-8-66><a class=lnlinks href=#hl-8-66> 66</a>
</span><span class=lnt id=hl-8-67><a class=lnlinks href=#hl-8-67> 67</a>
</span><span class=lnt id=hl-8-68><a class=lnlinks href=#hl-8-68> 68</a>
</span><span class=lnt id=hl-8-69><a class=lnlinks href=#hl-8-69> 69</a>
</span><span class=lnt id=hl-8-70><a class=lnlinks href=#hl-8-70> 70</a>
</span><span class=lnt id=hl-8-71><a class=lnlinks href=#hl-8-71> 71</a>
</span><span class=lnt id=hl-8-72><a class=lnlinks href=#hl-8-72> 72</a>
</span><span class=lnt id=hl-8-73><a class=lnlinks href=#hl-8-73> 73</a>
</span><span class=lnt id=hl-8-74><a class=lnlinks href=#hl-8-74> 74</a>
</span><span class=lnt id=hl-8-75><a class=lnlinks href=#hl-8-75> 75</a>
</span><span class=lnt id=hl-8-76><a class=lnlinks href=#hl-8-76> 76</a>
</span><span class=lnt id=hl-8-77><a class=lnlinks href=#hl-8-77> 77</a>
</span><span class=lnt id=hl-8-78><a class=lnlinks href=#hl-8-78> 78</a>
</span><span class=lnt id=hl-8-79><a class=lnlinks href=#hl-8-79> 79</a>
</span><span class=lnt id=hl-8-80><a class=lnlinks href=#hl-8-80> 80</a>
</span><span class=lnt id=hl-8-81><a class=lnlinks href=#hl-8-81> 81</a>
</span><span class=lnt id=hl-8-82><a class=lnlinks href=#hl-8-82> 82</a>
</span><span class=lnt id=hl-8-83><a class=lnlinks href=#hl-8-83> 83</a>
</span><span class=lnt id=hl-8-84><a class=lnlinks href=#hl-8-84> 84</a>
</span><span class=lnt id=hl-8-85><a class=lnlinks href=#hl-8-85> 85</a>
</span><span class=lnt id=hl-8-86><a class=lnlinks href=#hl-8-86> 86</a>
</span><span class=lnt id=hl-8-87><a class=lnlinks href=#hl-8-87> 87</a>
</span><span class=lnt id=hl-8-88><a class=lnlinks href=#hl-8-88> 88</a>
</span><span class=lnt id=hl-8-89><a class=lnlinks href=#hl-8-89> 89</a>
</span><span class=lnt id=hl-8-90><a class=lnlinks href=#hl-8-90> 90</a>
</span><span class=lnt id=hl-8-91><a class=lnlinks href=#hl-8-91> 91</a>
</span><span class=lnt id=hl-8-92><a class=lnlinks href=#hl-8-92> 92</a>
</span><span class=lnt id=hl-8-93><a class=lnlinks href=#hl-8-93> 93</a>
</span><span class=lnt id=hl-8-94><a class=lnlinks href=#hl-8-94> 94</a>
</span><span class=lnt id=hl-8-95><a class=lnlinks href=#hl-8-95> 95</a>
</span><span class=lnt id=hl-8-96><a class=lnlinks href=#hl-8-96> 96</a>
</span><span class=lnt id=hl-8-97><a class=lnlinks href=#hl-8-97> 97</a>
</span><span class=lnt id=hl-8-98><a class=lnlinks href=#hl-8-98> 98</a>
</span><span class=lnt id=hl-8-99><a class=lnlinks href=#hl-8-99> 99</a>
</span><span class=lnt id=hl-8-100><a class=lnlinks href=#hl-8-100>100</a>
</span><span class=lnt id=hl-8-101><a class=lnlinks href=#hl-8-101>101</a>
</span><span class=lnt id=hl-8-102><a class=lnlinks href=#hl-8-102>102</a>
</span><span class=lnt id=hl-8-103><a class=lnlinks href=#hl-8-103>103</a>
</span><span class=lnt id=hl-8-104><a class=lnlinks href=#hl-8-104>104</a>
</span><span class=lnt id=hl-8-105><a class=lnlinks href=#hl-8-105>105</a>
</span><span class=lnt id=hl-8-106><a class=lnlinks href=#hl-8-106>106</a>
</span><span class=lnt id=hl-8-107><a class=lnlinks href=#hl-8-107>107</a>
</span><span class=lnt id=hl-8-108><a class=lnlinks href=#hl-8-108>108</a>
</span><span class=lnt id=hl-8-109><a class=lnlinks href=#hl-8-109>109</a>
</span><span class=lnt id=hl-8-110><a class=lnlinks href=#hl-8-110>110</a>
</span><span class=lnt id=hl-8-111><a class=lnlinks href=#hl-8-111>111</a>
</span><span class=lnt id=hl-8-112><a class=lnlinks href=#hl-8-112>112</a>
</span><span class=lnt id=hl-8-113><a class=lnlinks href=#hl-8-113>113</a>
</span><span class=lnt id=hl-8-114><a class=lnlinks href=#hl-8-114>114</a>
</span><span class=lnt id=hl-8-115><a class=lnlinks href=#hl-8-115>115</a>
</span><span class=lnt id=hl-8-116><a class=lnlinks href=#hl-8-116>116</a>
</span><span class=lnt id=hl-8-117><a class=lnlinks href=#hl-8-117>117</a>
</span><span class=lnt id=hl-8-118><a class=lnlinks href=#hl-8-118>118</a>
</span><span class=lnt id=hl-8-119><a class=lnlinks href=#hl-8-119>119</a>
</span><span class=lnt id=hl-8-120><a class=lnlinks href=#hl-8-120>120</a>
</span><span class=lnt id=hl-8-121><a class=lnlinks href=#hl-8-121>121</a>
</span><span class=lnt id=hl-8-122><a class=lnlinks href=#hl-8-122>122</a>
</span><span class=lnt id=hl-8-123><a class=lnlinks href=#hl-8-123>123</a>
</span><span class=lnt id=hl-8-124><a class=lnlinks href=#hl-8-124>124</a>
</span><span class=lnt id=hl-8-125><a class=lnlinks href=#hl-8-125>125</a>
</span><span class=lnt id=hl-8-126><a class=lnlinks href=#hl-8-126>126</a>
</span><span class=lnt id=hl-8-127><a class=lnlinks href=#hl-8-127>127</a>
</span><span class=lnt id=hl-8-128><a class=lnlinks href=#hl-8-128>128</a>
</span><span class=lnt id=hl-8-129><a class=lnlinks href=#hl-8-129>129</a>
</span><span class=lnt id=hl-8-130><a class=lnlinks href=#hl-8-130>130</a>
</span><span class=lnt id=hl-8-131><a class=lnlinks href=#hl-8-131>131</a>
</span><span class=lnt id=hl-8-132><a class=lnlinks href=#hl-8-132>132</a>
</span><span class=lnt id=hl-8-133><a class=lnlinks href=#hl-8-133>133</a>
</span><span class=lnt id=hl-8-134><a class=lnlinks href=#hl-8-134>134</a>
</span><span class=lnt id=hl-8-135><a class=lnlinks href=#hl-8-135>135</a>
</span><span class=lnt id=hl-8-136><a class=lnlinks href=#hl-8-136>136</a>
</span><span class=lnt id=hl-8-137><a class=lnlinks href=#hl-8-137>137</a>
</span><span class=lnt id=hl-8-138><a class=lnlinks href=#hl-8-138>138</a>
</span><span class=lnt id=hl-8-139><a class=lnlinks href=#hl-8-139>139</a>
</span><span class=lnt id=hl-8-140><a class=lnlinks href=#hl-8-140>140</a>
</span><span class=lnt id=hl-8-141><a class=lnlinks href=#hl-8-141>141</a>
</span><span class=lnt id=hl-8-142><a class=lnlinks href=#hl-8-142>142</a>
</span><span class=lnt id=hl-8-143><a class=lnlinks href=#hl-8-143>143</a>
</span><span class=lnt id=hl-8-144><a class=lnlinks href=#hl-8-144>144</a>
</span><span class=lnt id=hl-8-145><a class=lnlinks href=#hl-8-145>145</a>
</span><span class=lnt id=hl-8-146><a class=lnlinks href=#hl-8-146>146</a>
</span><span class=lnt id=hl-8-147><a class=lnlinks href=#hl-8-147>147</a>
</span><span class=lnt id=hl-8-148><a class=lnlinks href=#hl-8-148>148</a>
</span><span class=lnt id=hl-8-149><a class=lnlinks href=#hl-8-149>149</a>
</span><span class=lnt id=hl-8-150><a class=lnlinks href=#hl-8-150>150</a>
</span><span class=lnt id=hl-8-151><a class=lnlinks href=#hl-8-151>151</a>
</span><span class=lnt id=hl-8-152><a class=lnlinks href=#hl-8-152>152</a>
</span><span class=lnt id=hl-8-153><a class=lnlinks href=#hl-8-153>153</a>
</span><span class=lnt id=hl-8-154><a class=lnlinks href=#hl-8-154>154</a>
</span><span class=lnt id=hl-8-155><a class=lnlinks href=#hl-8-155>155</a>
</span><span class=lnt id=hl-8-156><a class=lnlinks href=#hl-8-156>156</a>
</span><span class=lnt id=hl-8-157><a class=lnlinks href=#hl-8-157>157</a>
</span><span class=lnt id=hl-8-158><a class=lnlinks href=#hl-8-158>158</a>
</span><span class=lnt id=hl-8-159><a class=lnlinks href=#hl-8-159>159</a>
</span><span class=lnt id=hl-8-160><a class=lnlinks href=#hl-8-160>160</a>
</span><span class=lnt id=hl-8-161><a class=lnlinks href=#hl-8-161>161</a>
</span><span class=lnt id=hl-8-162><a class=lnlinks href=#hl-8-162>162</a>
</span><span class=lnt id=hl-8-163><a class=lnlinks href=#hl-8-163>163</a>
</span><span class=lnt id=hl-8-164><a class=lnlinks href=#hl-8-164>164</a>
</span><span class=lnt id=hl-8-165><a class=lnlinks href=#hl-8-165>165</a>
</span><span class=lnt id=hl-8-166><a class=lnlinks href=#hl-8-166>166</a>
</span><span class=lnt id=hl-8-167><a class=lnlinks href=#hl-8-167>167</a>
</span><span class=lnt id=hl-8-168><a class=lnlinks href=#hl-8-168>168</a>
</span><span class=lnt id=hl-8-169><a class=lnlinks href=#hl-8-169>169</a>
</span><span class=lnt id=hl-8-170><a class=lnlinks href=#hl-8-170>170</a>
</span><span class=lnt id=hl-8-171><a class=lnlinks href=#hl-8-171>171</a>
</span><span class=lnt id=hl-8-172><a class=lnlinks href=#hl-8-172>172</a>
</span><span class=lnt id=hl-8-173><a class=lnlinks href=#hl-8-173>173</a>
</span><span class=lnt id=hl-8-174><a class=lnlinks href=#hl-8-174>174</a>
</span><span class=lnt id=hl-8-175><a class=lnlinks href=#hl-8-175>175</a>
</span><span class=lnt id=hl-8-176><a class=lnlinks href=#hl-8-176>176</a>
</span><span class=lnt id=hl-8-177><a class=lnlinks href=#hl-8-177>177</a>
</span><span class=lnt id=hl-8-178><a class=lnlinks href=#hl-8-178>178</a>
</span><span class=lnt id=hl-8-179><a class=lnlinks href=#hl-8-179>179</a>
</span><span class=lnt id=hl-8-180><a class=lnlinks href=#hl-8-180>180</a>
</span><span class=lnt id=hl-8-181><a class=lnlinks href=#hl-8-181>181</a>
</span><span class=lnt id=hl-8-182><a class=lnlinks href=#hl-8-182>182</a>
</span><span class=lnt id=hl-8-183><a class=lnlinks href=#hl-8-183>183</a>
</span><span class=lnt id=hl-8-184><a class=lnlinks href=#hl-8-184>184</a>
</span><span class=lnt id=hl-8-185><a class=lnlinks href=#hl-8-185>185</a>
</span><span class=lnt id=hl-8-186><a class=lnlinks href=#hl-8-186>186</a>
</span><span class=lnt id=hl-8-187><a class=lnlinks href=#hl-8-187>187</a>
</span><span class=lnt id=hl-8-188><a class=lnlinks href=#hl-8-188>188</a>
</span><span class=lnt id=hl-8-189><a class=lnlinks href=#hl-8-189>189</a>
</span><span class=lnt id=hl-8-190><a class=lnlinks href=#hl-8-190>190</a>
</span><span class=lnt id=hl-8-191><a class=lnlinks href=#hl-8-191>191</a>
</span><span class=lnt id=hl-8-192><a class=lnlinks href=#hl-8-192>192</a>
</span><span class=lnt id=hl-8-193><a class=lnlinks href=#hl-8-193>193</a>
</span><span class=lnt id=hl-8-194><a class=lnlinks href=#hl-8-194>194</a>
</span><span class=lnt id=hl-8-195><a class=lnlinks href=#hl-8-195>195</a>
</span><span class=lnt id=hl-8-196><a class=lnlinks href=#hl-8-196>196</a>
</span><span class=lnt id=hl-8-197><a class=lnlinks href=#hl-8-197>197</a>
</span><span class=lnt id=hl-8-198><a class=lnlinks href=#hl-8-198>198</a>
</span><span class=lnt id=hl-8-199><a class=lnlinks href=#hl-8-199>199</a>
</span><span class=lnt id=hl-8-200><a class=lnlinks href=#hl-8-200>200</a>
</span><span class=lnt id=hl-8-201><a class=lnlinks href=#hl-8-201>201</a>
</span><span class=lnt id=hl-8-202><a class=lnlinks href=#hl-8-202>202</a>
</span><span class=lnt id=hl-8-203><a class=lnlinks href=#hl-8-203>203</a>
</span><span class=lnt id=hl-8-204><a class=lnlinks href=#hl-8-204>204</a>
</span><span class=lnt id=hl-8-205><a class=lnlinks href=#hl-8-205>205</a>
</span><span class=lnt id=hl-8-206><a class=lnlinks href=#hl-8-206>206</a>
</span><span class=lnt id=hl-8-207><a class=lnlinks href=#hl-8-207>207</a>
</span><span class=lnt id=hl-8-208><a class=lnlinks href=#hl-8-208>208</a>
</span><span class=lnt id=hl-8-209><a class=lnlinks href=#hl-8-209>209</a>
</span><span class=lnt id=hl-8-210><a class=lnlinks href=#hl-8-210>210</a>
</span><span class=lnt id=hl-8-211><a class=lnlinks href=#hl-8-211>211</a>
</span><span class=lnt id=hl-8-212><a class=lnlinks href=#hl-8-212>212</a>
</span><span class=lnt id=hl-8-213><a class=lnlinks href=#hl-8-213>213</a>
</span><span class=lnt id=hl-8-214><a class=lnlinks href=#hl-8-214>214</a>
</span><span class=lnt id=hl-8-215><a class=lnlinks href=#hl-8-215>215</a>
</span><span class=lnt id=hl-8-216><a class=lnlinks href=#hl-8-216>216</a>
</span><span class=lnt id=hl-8-217><a class=lnlinks href=#hl-8-217>217</a>
</span><span class=lnt id=hl-8-218><a class=lnlinks href=#hl-8-218>218</a>
</span><span class=lnt id=hl-8-219><a class=lnlinks href=#hl-8-219>219</a>
</span><span class=lnt id=hl-8-220><a class=lnlinks href=#hl-8-220>220</a>
</span><span class=lnt id=hl-8-221><a class=lnlinks href=#hl-8-221>221</a>
</span><span class=lnt id=hl-8-222><a class=lnlinks href=#hl-8-222>222</a>
</span><span class=lnt id=hl-8-223><a class=lnlinks href=#hl-8-223>223</a>
</span><span class=lnt id=hl-8-224><a class=lnlinks href=#hl-8-224>224</a>
</span><span class=lnt id=hl-8-225><a class=lnlinks href=#hl-8-225>225</a>
</span><span class=lnt id=hl-8-226><a class=lnlinks href=#hl-8-226>226</a>
</span><span class=lnt id=hl-8-227><a class=lnlinks href=#hl-8-227>227</a>
</span><span class=lnt id=hl-8-228><a class=lnlinks href=#hl-8-228>228</a>
</span><span class=lnt id=hl-8-229><a class=lnlinks href=#hl-8-229>229</a>
</span><span class=lnt id=hl-8-230><a class=lnlinks href=#hl-8-230>230</a>
</span><span class=lnt id=hl-8-231><a class=lnlinks href=#hl-8-231>231</a>
</span><span class=lnt id=hl-8-232><a class=lnlinks href=#hl-8-232>232</a>
</span><span class=lnt id=hl-8-233><a class=lnlinks href=#hl-8-233>233</a>
</span><span class=lnt id=hl-8-234><a class=lnlinks href=#hl-8-234>234</a>
</span><span class=lnt id=hl-8-235><a class=lnlinks href=#hl-8-235>235</a>
</span><span class=lnt id=hl-8-236><a class=lnlinks href=#hl-8-236>236</a>
</span><span class=lnt id=hl-8-237><a class=lnlinks href=#hl-8-237>237</a>
</span><span class=lnt id=hl-8-238><a class=lnlinks href=#hl-8-238>238</a>
</span><span class=lnt id=hl-8-239><a class=lnlinks href=#hl-8-239>239</a>
</span><span class=lnt id=hl-8-240><a class=lnlinks href=#hl-8-240>240</a>
</span><span class=lnt id=hl-8-241><a class=lnlinks href=#hl-8-241>241</a>
</span><span class=lnt id=hl-8-242><a class=lnlinks href=#hl-8-242>242</a>
</span><span class=lnt id=hl-8-243><a class=lnlinks href=#hl-8-243>243</a>
</span><span class=lnt id=hl-8-244><a class=lnlinks href=#hl-8-244>244</a>
</span><span class=lnt id=hl-8-245><a class=lnlinks href=#hl-8-245>245</a>
</span><span class=lnt id=hl-8-246><a class=lnlinks href=#hl-8-246>246</a>
</span><span class=lnt id=hl-8-247><a class=lnlinks href=#hl-8-247>247</a>
</span><span class=lnt id=hl-8-248><a class=lnlinks href=#hl-8-248>248</a>
</span><span class=lnt id=hl-8-249><a class=lnlinks href=#hl-8-249>249</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># FastAPI를 사용한 모델 서빙 예시 코드</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span><span class=p>,</span> <span class=n>HTTPException</span><span class=p>,</span> <span class=n>Depends</span><span class=p>,</span> <span class=n>BackgroundTasks</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pydantic</span> <span class=kn>import</span> <span class=n>BaseModel</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span><span class=p>,</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>Optional</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pickle</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>mlflow.pyfunc</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>redis</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>prometheus_client</span> <span class=kn>import</span> <span class=n>Counter</span><span class=p>,</span> <span class=n>Histogram</span><span class=p>,</span> <span class=n>Gauge</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 로깅 설정</span>
</span></span><span class=line><span class=cl><span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> - </span><span class=si>%(name)s</span><span class=s1> - </span><span class=si>%(levelname)s</span><span class=s1> - </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Redis 연결 설정</span>
</span></span><span class=line><span class=cl><span class=n>redis_client</span> <span class=o>=</span> <span class=n>redis</span><span class=o>.</span><span class=n>Redis</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>host</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;REDIS_HOST&#34;</span><span class=p>,</span> <span class=s2>&#34;localhost&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>port</span><span class=o>=</span><span class=nb>int</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;REDIS_PORT&#34;</span><span class=p>,</span> <span class=mi>6379</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Prometheus 메트릭 정의</span>
</span></span><span class=line><span class=cl><span class=n>PREDICTION_COUNT</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>(</span><span class=s1>&#39;churn_predictions_total&#39;</span><span class=p>,</span> <span class=s1>&#39;Total number of churn predictions&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;result&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>PREDICTION_LATENCY</span> <span class=o>=</span> <span class=n>Histogram</span><span class=p>(</span><span class=s1>&#39;churn_prediction_latency_seconds&#39;</span><span class=p>,</span> <span class=s1>&#39;Churn prediction latency in seconds&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>MODEL_ACCURACY</span> <span class=o>=</span> <span class=n>Gauge</span><span class=p>(</span><span class=s1>&#39;churn_model_accuracy&#39;</span><span class=p>,</span> <span class=s1>&#39;Current churn model accuracy&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 기본 정확도 설정 (모니터링 시스템에서 주기적으로 업데이트됨)</span>
</span></span><span class=line><span class=cl><span class=n>MODEL_ACCURACY</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=mf>0.85</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># FastAPI 앱 초기화</span>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s2>&#34;Customer Churn Prediction API&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 요청 및 응답 모델</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CustomerFeatures</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>subscription_length</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>    <span class=n>monthly_charges</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>total_charges</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>contract_type</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>payment_method</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>tech_support_calls</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>    <span class=n>last_active_days</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>PredictionResponse</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>churn_probability</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>churn_risk_level</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>model_version</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>prediction_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>prediction_time</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 모델 로드 함수</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>load_model</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;MLflow에서 최신 모델 로드&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 모델 레지스트리에서 &#39;Production&#39; 단계의 모델 로드</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span> <span class=o>=</span> <span class=n>mlflow</span><span class=o>.</span><span class=n>pyfunc</span><span class=o>.</span><span class=n>load_model</span><span class=p>(</span><span class=s2>&#34;models:/customer_churn_predictor/Production&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Successfully loaded churn prediction model&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>model</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error loading model: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 백업 방법: 로컬에 저장된 모델 파일 로드</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;models/churn_model_backup.pkl&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>model</span> <span class=o>=</span> <span class=n>pickle</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Loaded backup model&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>model</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 의존성 주입을 위한 모델 제공자</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_model</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;싱글톤 패턴으로 모델 제공&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>get_model</span><span class=p>,</span> <span class=s2>&#34;model&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>get_model</span><span class=o>.</span><span class=n>model</span> <span class=o>=</span> <span class=n>load_model</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>get_model</span><span class=o>.</span><span class=n>model</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 전처리 함수</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>preprocess_features</span><span class=p>(</span><span class=n>customer</span><span class=p>:</span> <span class=n>CustomerFeatures</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;요청 데이터 전처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 데이터 프레임 변환</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([</span><span class=n>customer</span><span class=o>.</span><span class=n>dict</span><span class=p>()])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 1. 범주형 변수 처리</span>
</span></span><span class=line><span class=cl>    <span class=n>contract_types</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Monthly&#39;</span><span class=p>,</span> <span class=s1>&#39;One year&#39;</span><span class=p>,</span> <span class=s1>&#39;Two year&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>payment_methods</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Credit card&#39;</span><span class=p>,</span> <span class=s1>&#39;Bank transfer&#39;</span><span class=p>,</span> <span class=s1>&#39;Electronic check&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 원-핫 인코딩</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>contract</span> <span class=ow>in</span> <span class=n>contract_types</span><span class=p>[</span><span class=mi>1</span><span class=p>:]:</span>  <span class=c1># 첫 번째 카테고리는 기준으로 사용</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=p>[</span><span class=sa>f</span><span class=s1>&#39;contract_type_</span><span class=si>{</span><span class=n>contract</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;contract_type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>contract</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>method</span> <span class=ow>in</span> <span class=n>payment_methods</span><span class=p>[</span><span class=mi>1</span><span class=p>:]:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=p>[</span><span class=sa>f</span><span class=s1>&#39;payment_method_</span><span class=si>{</span><span class=n>method</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;payment_method&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>method</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 2. 새로운 특성 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span><span class=p>[</span><span class=s1>&#39;avg_monthly_charge&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;total_charges&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;subscription_length&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span><span class=p>[</span><span class=s1>&#39;inactive_ratio&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;last_active_days&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=mi>30</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 3. 원본 범주형 변수 제거</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>drop</span><span class=p>([</span><span class=s1>&#39;contract_type&#39;</span><span class=p>,</span> <span class=s1>&#39;payment_method&#39;</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 고객 ID 별도 저장</span>
</span></span><span class=line><span class=cl>    <span class=n>customer_id</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>drop</span><span class=p>([</span><span class=s1>&#39;customer_id&#39;</span><span class=p>],</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>data</span><span class=p>,</span> <span class=n>customer_id</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 예측 결과를 Redis에 캐싱하는 함수</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>cache_prediction</span><span class=p>(</span><span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>prediction</span><span class=p>:</span> <span class=nb>dict</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;예측 결과를 Redis에 캐싱&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 12시간 유효기간으로 캐싱</span>
</span></span><span class=line><span class=cl>        <span class=n>redis_client</span><span class=o>.</span><span class=n>setex</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;churn_prediction:</span><span class=si>{</span><span class=n>customer_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=mi>43200</span><span class=p>,</span>  <span class=c1># 12시간 (초 단위)</span>
</span></span><span class=line><span class=cl>            <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>prediction</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to cache prediction: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 캐시된 예측 결과 조회 함수</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_cached_prediction</span><span class=p>(</span><span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>dict</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Redis에서 캐시된 예측 결과 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>cached</span> <span class=o>=</span> <span class=n>redis_client</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;churn_prediction:</span><span class=si>{</span><span class=n>customer_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>cached</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>cached</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to retrieve cached prediction: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 마케팅 시스템에 알림 전송 함수 (백그라운드 작업)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_to_marketing_system</span><span class=p>(</span><span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>churn_probability</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>risk_level</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;고위험 고객 정보를 마케팅 시스템에 전송&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 실제 구현에서는 외부 시스템 API 호출</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Sending alert to marketing system for customer </span><span class=si>{</span><span class=n>customer_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># requests.post(&#34;https://marketing-api.example.com/churn-alerts&#34;,</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     json={</span>
</span></span><span class=line><span class=cl>        <span class=c1>#         &#34;customer_id&#34;: customer_id,</span>
</span></span><span class=line><span class=cl>        <span class=c1>#         &#34;churn_probability&#34;: churn_probability,</span>
</span></span><span class=line><span class=cl>        <span class=c1>#         &#34;risk_level&#34;: risk_level,</span>
</span></span><span class=line><span class=cl>        <span class=c1>#         &#34;timestamp&#34;: datetime.now().isoformat()</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     },</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     headers={&#34;Authorization&#34;: &#34;Bearer &#34; + API_KEY}</span>
</span></span><span class=line><span class=cl>        <span class=c1># )</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to send alert to marketing system: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>read_root</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;message&#34;</span><span class=p>:</span> <span class=s2>&#34;Customer Churn Prediction API&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/health&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>health_check</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;헬스 체크 엔드포인트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 모델이 로드되었는지 확인</span>
</span></span><span class=line><span class=cl>        <span class=n>model</span> <span class=o>=</span> <span class=n>get_model</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=c1># Redis 연결 확인</span>
</span></span><span class=line><span class=cl>        <span class=n>redis_client</span><span class=o>.</span><span class=n>ping</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;healthy&#34;</span><span class=p>,</span> <span class=s2>&#34;model_loaded&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s2>&#34;redis_connected&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Health check failed: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;unhealthy&#34;</span><span class=p>,</span> <span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)},</span> <span class=mi>503</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.post</span><span class=p>(</span><span class=s2>&#34;/predict&#34;</span><span class=p>,</span> <span class=n>response_model</span><span class=o>=</span><span class=n>PredictionResponse</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>predict_churn</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>customer</span><span class=p>:</span> <span class=n>CustomerFeatures</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>background_tasks</span><span class=p>:</span> <span class=n>BackgroundTasks</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>=</span><span class=n>Depends</span><span class=p>(</span><span class=n>get_model</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;고객 이탈 예측 엔드포인트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>prediction_start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. 캐시된 결과 확인</span>
</span></span><span class=line><span class=cl>        <span class=n>cached_prediction</span> <span class=o>=</span> <span class=n>get_cached_prediction</span><span class=p>(</span><span class=n>customer</span><span class=o>.</span><span class=n>customer_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>cached_prediction</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Returning cached prediction for customer </span><span class=si>{</span><span class=n>customer</span><span class=o>.</span><span class=n>customer_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># 캐시된 결과를 반환하되, 예측 시간은 현재 시간으로 업데이트</span>
</span></span><span class=line><span class=cl>            <span class=n>cached_prediction</span><span class=p>[</span><span class=s2>&#34;prediction_time&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>PredictionResponse</span><span class=p>(</span><span class=o>**</span><span class=n>cached_prediction</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. 특성 전처리</span>
</span></span><span class=line><span class=cl>        <span class=n>features</span><span class=p>,</span> <span class=n>customer_id</span> <span class=o>=</span> <span class=n>preprocess_features</span><span class=p>(</span><span class=n>customer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. 예측 수행</span>
</span></span><span class=line><span class=cl>        <span class=n>churn_probability</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>features</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 4. 결과 후처리</span>
</span></span><span class=line><span class=cl>        <span class=n>risk_level</span> <span class=o>=</span> <span class=s2>&#34;high&#34;</span> <span class=k>if</span> <span class=n>churn_probability</span> <span class=o>&gt;</span> <span class=mf>0.7</span> <span class=k>else</span> <span class=s2>&#34;medium&#34;</span> <span class=k>if</span> <span class=n>churn_probability</span> <span class=o>&gt;</span> <span class=mf>0.3</span> <span class=k>else</span> <span class=s2>&#34;low&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 5. 응답 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>prediction_id</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;pred_</span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>())</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>customer</span><span class=o>.</span><span class=n>customer_id</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;customer_id&#34;</span><span class=p>:</span> <span class=n>customer</span><span class=o>.</span><span class=n>customer_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;churn_probability&#34;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>churn_probability</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;churn_risk_level&#34;</span><span class=p>:</span> <span class=n>risk_level</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;model_version&#34;</span><span class=p>:</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=s1>&#39;version&#39;</span><span class=p>,</span> <span class=s1>&#39;unknown&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;prediction_id&#34;</span><span class=p>:</span> <span class=n>prediction_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;prediction_time&#34;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 6. 결과 캐싱</span>
</span></span><span class=line><span class=cl>        <span class=n>background_tasks</span><span class=o>.</span><span class=n>add_task</span><span class=p>(</span><span class=n>cache_prediction</span><span class=p>,</span> <span class=n>customer</span><span class=o>.</span><span class=n>customer_id</span><span class=p>,</span> <span class=n>response</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 7. 고위험 고객 마케팅 알림</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>risk_level</span> <span class=o>==</span> <span class=s2>&#34;high&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>background_tasks</span><span class=o>.</span><span class=n>add_task</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>send_to_marketing_system</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>customer</span><span class=o>.</span><span class=n>customer_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>churn_probability</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>risk_level</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 8. 메트릭 업데이트</span>
</span></span><span class=line><span class=cl>        <span class=n>prediction_label</span> <span class=o>=</span> <span class=s2>&#34;churn&#34;</span> <span class=k>if</span> <span class=n>churn_probability</span> <span class=o>&gt;</span> <span class=mf>0.5</span> <span class=k>else</span> <span class=s2>&#34;no_churn&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>PREDICTION_COUNT</span><span class=o>.</span><span class=n>labels</span><span class=p>(</span><span class=n>result</span><span class=o>=</span><span class=n>prediction_label</span><span class=p>)</span><span class=o>.</span><span class=n>inc</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 9. 응답 반환</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>PredictionResponse</span><span class=p>(</span><span class=o>**</span><span class=n>response</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Prediction error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>500</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 지연 시간 측정 및 기록</span>
</span></span><span class=line><span class=cl>        <span class=n>prediction_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>prediction_start_time</span>
</span></span><span class=line><span class=cl>        <span class=n>PREDICTION_LATENCY</span><span class=o>.</span><span class=n>observe</span><span class=p>(</span><span class=n>prediction_time</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 애플리케이션 시작 시 필요한 초기화</span>
</span></span><span class=line><span class=cl><span class=nd>@app.on_event</span><span class=p>(</span><span class=s2>&#34;startup&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>startup_event</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;애플리케이션 시작 시 실행되는 작업&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Starting Churn Prediction API&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 모델 미리 로드</span>
</span></span><span class=line><span class=cl>    <span class=n>get_model</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 애플리케이션 종료 시 정리 작업</span>
</span></span><span class=line><span class=cl><span class=nd>@app.on_event</span><span class=p>(</span><span class=s2>&#34;shutdown&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>shutdown_event</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;애플리케이션 종료 시 실행되는 작업&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Shutting down Churn Prediction API&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=모니터링-및-재훈련-파이프라인>모니터링 및 재훈련 파이프라인<a hidden class=anchor aria-hidden=true href=#모니터링-및-재훈련-파이프라인>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>  1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>  2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3>  3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4>  4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5>  5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6>  6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7>  7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8>  8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9>  9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10> 10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11> 11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12> 12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13> 13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14> 14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15> 15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16> 16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17> 17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18> 18</a>
</span><span class=lnt id=hl-9-19><a class=lnlinks href=#hl-9-19> 19</a>
</span><span class=lnt id=hl-9-20><a class=lnlinks href=#hl-9-20> 20</a>
</span><span class=lnt id=hl-9-21><a class=lnlinks href=#hl-9-21> 21</a>
</span><span class=lnt id=hl-9-22><a class=lnlinks href=#hl-9-22> 22</a>
</span><span class=lnt id=hl-9-23><a class=lnlinks href=#hl-9-23> 23</a>
</span><span class=lnt id=hl-9-24><a class=lnlinks href=#hl-9-24> 24</a>
</span><span class=lnt id=hl-9-25><a class=lnlinks href=#hl-9-25> 25</a>
</span><span class=lnt id=hl-9-26><a class=lnlinks href=#hl-9-26> 26</a>
</span><span class=lnt id=hl-9-27><a class=lnlinks href=#hl-9-27> 27</a>
</span><span class=lnt id=hl-9-28><a class=lnlinks href=#hl-9-28> 28</a>
</span><span class=lnt id=hl-9-29><a class=lnlinks href=#hl-9-29> 29</a>
</span><span class=lnt id=hl-9-30><a class=lnlinks href=#hl-9-30> 30</a>
</span><span class=lnt id=hl-9-31><a class=lnlinks href=#hl-9-31> 31</a>
</span><span class=lnt id=hl-9-32><a class=lnlinks href=#hl-9-32> 32</a>
</span><span class=lnt id=hl-9-33><a class=lnlinks href=#hl-9-33> 33</a>
</span><span class=lnt id=hl-9-34><a class=lnlinks href=#hl-9-34> 34</a>
</span><span class=lnt id=hl-9-35><a class=lnlinks href=#hl-9-35> 35</a>
</span><span class=lnt id=hl-9-36><a class=lnlinks href=#hl-9-36> 36</a>
</span><span class=lnt id=hl-9-37><a class=lnlinks href=#hl-9-37> 37</a>
</span><span class=lnt id=hl-9-38><a class=lnlinks href=#hl-9-38> 38</a>
</span><span class=lnt id=hl-9-39><a class=lnlinks href=#hl-9-39> 39</a>
</span><span class=lnt id=hl-9-40><a class=lnlinks href=#hl-9-40> 40</a>
</span><span class=lnt id=hl-9-41><a class=lnlinks href=#hl-9-41> 41</a>
</span><span class=lnt id=hl-9-42><a class=lnlinks href=#hl-9-42> 42</a>
</span><span class=lnt id=hl-9-43><a class=lnlinks href=#hl-9-43> 43</a>
</span><span class=lnt id=hl-9-44><a class=lnlinks href=#hl-9-44> 44</a>
</span><span class=lnt id=hl-9-45><a class=lnlinks href=#hl-9-45> 45</a>
</span><span class=lnt id=hl-9-46><a class=lnlinks href=#hl-9-46> 46</a>
</span><span class=lnt id=hl-9-47><a class=lnlinks href=#hl-9-47> 47</a>
</span><span class=lnt id=hl-9-48><a class=lnlinks href=#hl-9-48> 48</a>
</span><span class=lnt id=hl-9-49><a class=lnlinks href=#hl-9-49> 49</a>
</span><span class=lnt id=hl-9-50><a class=lnlinks href=#hl-9-50> 50</a>
</span><span class=lnt id=hl-9-51><a class=lnlinks href=#hl-9-51> 51</a>
</span><span class=lnt id=hl-9-52><a class=lnlinks href=#hl-9-52> 52</a>
</span><span class=lnt id=hl-9-53><a class=lnlinks href=#hl-9-53> 53</a>
</span><span class=lnt id=hl-9-54><a class=lnlinks href=#hl-9-54> 54</a>
</span><span class=lnt id=hl-9-55><a class=lnlinks href=#hl-9-55> 55</a>
</span><span class=lnt id=hl-9-56><a class=lnlinks href=#hl-9-56> 56</a>
</span><span class=lnt id=hl-9-57><a class=lnlinks href=#hl-9-57> 57</a>
</span><span class=lnt id=hl-9-58><a class=lnlinks href=#hl-9-58> 58</a>
</span><span class=lnt id=hl-9-59><a class=lnlinks href=#hl-9-59> 59</a>
</span><span class=lnt id=hl-9-60><a class=lnlinks href=#hl-9-60> 60</a>
</span><span class=lnt id=hl-9-61><a class=lnlinks href=#hl-9-61> 61</a>
</span><span class=lnt id=hl-9-62><a class=lnlinks href=#hl-9-62> 62</a>
</span><span class=lnt id=hl-9-63><a class=lnlinks href=#hl-9-63> 63</a>
</span><span class=lnt id=hl-9-64><a class=lnlinks href=#hl-9-64> 64</a>
</span><span class=lnt id=hl-9-65><a class=lnlinks href=#hl-9-65> 65</a>
</span><span class=lnt id=hl-9-66><a class=lnlinks href=#hl-9-66> 66</a>
</span><span class=lnt id=hl-9-67><a class=lnlinks href=#hl-9-67> 67</a>
</span><span class=lnt id=hl-9-68><a class=lnlinks href=#hl-9-68> 68</a>
</span><span class=lnt id=hl-9-69><a class=lnlinks href=#hl-9-69> 69</a>
</span><span class=lnt id=hl-9-70><a class=lnlinks href=#hl-9-70> 70</a>
</span><span class=lnt id=hl-9-71><a class=lnlinks href=#hl-9-71> 71</a>
</span><span class=lnt id=hl-9-72><a class=lnlinks href=#hl-9-72> 72</a>
</span><span class=lnt id=hl-9-73><a class=lnlinks href=#hl-9-73> 73</a>
</span><span class=lnt id=hl-9-74><a class=lnlinks href=#hl-9-74> 74</a>
</span><span class=lnt id=hl-9-75><a class=lnlinks href=#hl-9-75> 75</a>
</span><span class=lnt id=hl-9-76><a class=lnlinks href=#hl-9-76> 76</a>
</span><span class=lnt id=hl-9-77><a class=lnlinks href=#hl-9-77> 77</a>
</span><span class=lnt id=hl-9-78><a class=lnlinks href=#hl-9-78> 78</a>
</span><span class=lnt id=hl-9-79><a class=lnlinks href=#hl-9-79> 79</a>
</span><span class=lnt id=hl-9-80><a class=lnlinks href=#hl-9-80> 80</a>
</span><span class=lnt id=hl-9-81><a class=lnlinks href=#hl-9-81> 81</a>
</span><span class=lnt id=hl-9-82><a class=lnlinks href=#hl-9-82> 82</a>
</span><span class=lnt id=hl-9-83><a class=lnlinks href=#hl-9-83> 83</a>
</span><span class=lnt id=hl-9-84><a class=lnlinks href=#hl-9-84> 84</a>
</span><span class=lnt id=hl-9-85><a class=lnlinks href=#hl-9-85> 85</a>
</span><span class=lnt id=hl-9-86><a class=lnlinks href=#hl-9-86> 86</a>
</span><span class=lnt id=hl-9-87><a class=lnlinks href=#hl-9-87> 87</a>
</span><span class=lnt id=hl-9-88><a class=lnlinks href=#hl-9-88> 88</a>
</span><span class=lnt id=hl-9-89><a class=lnlinks href=#hl-9-89> 89</a>
</span><span class=lnt id=hl-9-90><a class=lnlinks href=#hl-9-90> 90</a>
</span><span class=lnt id=hl-9-91><a class=lnlinks href=#hl-9-91> 91</a>
</span><span class=lnt id=hl-9-92><a class=lnlinks href=#hl-9-92> 92</a>
</span><span class=lnt id=hl-9-93><a class=lnlinks href=#hl-9-93> 93</a>
</span><span class=lnt id=hl-9-94><a class=lnlinks href=#hl-9-94> 94</a>
</span><span class=lnt id=hl-9-95><a class=lnlinks href=#hl-9-95> 95</a>
</span><span class=lnt id=hl-9-96><a class=lnlinks href=#hl-9-96> 96</a>
</span><span class=lnt id=hl-9-97><a class=lnlinks href=#hl-9-97> 97</a>
</span><span class=lnt id=hl-9-98><a class=lnlinks href=#hl-9-98> 98</a>
</span><span class=lnt id=hl-9-99><a class=lnlinks href=#hl-9-99> 99</a>
</span><span class=lnt id=hl-9-100><a class=lnlinks href=#hl-9-100>100</a>
</span><span class=lnt id=hl-9-101><a class=lnlinks href=#hl-9-101>101</a>
</span><span class=lnt id=hl-9-102><a class=lnlinks href=#hl-9-102>102</a>
</span><span class=lnt id=hl-9-103><a class=lnlinks href=#hl-9-103>103</a>
</span><span class=lnt id=hl-9-104><a class=lnlinks href=#hl-9-104>104</a>
</span><span class=lnt id=hl-9-105><a class=lnlinks href=#hl-9-105>105</a>
</span><span class=lnt id=hl-9-106><a class=lnlinks href=#hl-9-106>106</a>
</span><span class=lnt id=hl-9-107><a class=lnlinks href=#hl-9-107>107</a>
</span><span class=lnt id=hl-9-108><a class=lnlinks href=#hl-9-108>108</a>
</span><span class=lnt id=hl-9-109><a class=lnlinks href=#hl-9-109>109</a>
</span><span class=lnt id=hl-9-110><a class=lnlinks href=#hl-9-110>110</a>
</span><span class=lnt id=hl-9-111><a class=lnlinks href=#hl-9-111>111</a>
</span><span class=lnt id=hl-9-112><a class=lnlinks href=#hl-9-112>112</a>
</span><span class=lnt id=hl-9-113><a class=lnlinks href=#hl-9-113>113</a>
</span><span class=lnt id=hl-9-114><a class=lnlinks href=#hl-9-114>114</a>
</span><span class=lnt id=hl-9-115><a class=lnlinks href=#hl-9-115>115</a>
</span><span class=lnt id=hl-9-116><a class=lnlinks href=#hl-9-116>116</a>
</span><span class=lnt id=hl-9-117><a class=lnlinks href=#hl-9-117>117</a>
</span><span class=lnt id=hl-9-118><a class=lnlinks href=#hl-9-118>118</a>
</span><span class=lnt id=hl-9-119><a class=lnlinks href=#hl-9-119>119</a>
</span><span class=lnt id=hl-9-120><a class=lnlinks href=#hl-9-120>120</a>
</span><span class=lnt id=hl-9-121><a class=lnlinks href=#hl-9-121>121</a>
</span><span class=lnt id=hl-9-122><a class=lnlinks href=#hl-9-122>122</a>
</span><span class=lnt id=hl-9-123><a class=lnlinks href=#hl-9-123>123</a>
</span><span class=lnt id=hl-9-124><a class=lnlinks href=#hl-9-124>124</a>
</span><span class=lnt id=hl-9-125><a class=lnlinks href=#hl-9-125>125</a>
</span><span class=lnt id=hl-9-126><a class=lnlinks href=#hl-9-126>126</a>
</span><span class=lnt id=hl-9-127><a class=lnlinks href=#hl-9-127>127</a>
</span><span class=lnt id=hl-9-128><a class=lnlinks href=#hl-9-128>128</a>
</span><span class=lnt id=hl-9-129><a class=lnlinks href=#hl-9-129>129</a>
</span><span class=lnt id=hl-9-130><a class=lnlinks href=#hl-9-130>130</a>
</span><span class=lnt id=hl-9-131><a class=lnlinks href=#hl-9-131>131</a>
</span><span class=lnt id=hl-9-132><a class=lnlinks href=#hl-9-132>132</a>
</span><span class=lnt id=hl-9-133><a class=lnlinks href=#hl-9-133>133</a>
</span><span class=lnt id=hl-9-134><a class=lnlinks href=#hl-9-134>134</a>
</span><span class=lnt id=hl-9-135><a class=lnlinks href=#hl-9-135>135</a>
</span><span class=lnt id=hl-9-136><a class=lnlinks href=#hl-9-136>136</a>
</span><span class=lnt id=hl-9-137><a class=lnlinks href=#hl-9-137>137</a>
</span><span class=lnt id=hl-9-138><a class=lnlinks href=#hl-9-138>138</a>
</span><span class=lnt id=hl-9-139><a class=lnlinks href=#hl-9-139>139</a>
</span><span class=lnt id=hl-9-140><a class=lnlinks href=#hl-9-140>140</a>
</span><span class=lnt id=hl-9-141><a class=lnlinks href=#hl-9-141>141</a>
</span><span class=lnt id=hl-9-142><a class=lnlinks href=#hl-9-142>142</a>
</span><span class=lnt id=hl-9-143><a class=lnlinks href=#hl-9-143>143</a>
</span><span class=lnt id=hl-9-144><a class=lnlinks href=#hl-9-144>144</a>
</span><span class=lnt id=hl-9-145><a class=lnlinks href=#hl-9-145>145</a>
</span><span class=lnt id=hl-9-146><a class=lnlinks href=#hl-9-146>146</a>
</span><span class=lnt id=hl-9-147><a class=lnlinks href=#hl-9-147>147</a>
</span><span class=lnt id=hl-9-148><a class=lnlinks href=#hl-9-148>148</a>
</span><span class=lnt id=hl-9-149><a class=lnlinks href=#hl-9-149>149</a>
</span><span class=lnt id=hl-9-150><a class=lnlinks href=#hl-9-150>150</a>
</span><span class=lnt id=hl-9-151><a class=lnlinks href=#hl-9-151>151</a>
</span><span class=lnt id=hl-9-152><a class=lnlinks href=#hl-9-152>152</a>
</span><span class=lnt id=hl-9-153><a class=lnlinks href=#hl-9-153>153</a>
</span><span class=lnt id=hl-9-154><a class=lnlinks href=#hl-9-154>154</a>
</span><span class=lnt id=hl-9-155><a class=lnlinks href=#hl-9-155>155</a>
</span><span class=lnt id=hl-9-156><a class=lnlinks href=#hl-9-156>156</a>
</span><span class=lnt id=hl-9-157><a class=lnlinks href=#hl-9-157>157</a>
</span><span class=lnt id=hl-9-158><a class=lnlinks href=#hl-9-158>158</a>
</span><span class=lnt id=hl-9-159><a class=lnlinks href=#hl-9-159>159</a>
</span><span class=lnt id=hl-9-160><a class=lnlinks href=#hl-9-160>160</a>
</span><span class=lnt id=hl-9-161><a class=lnlinks href=#hl-9-161>161</a>
</span><span class=lnt id=hl-9-162><a class=lnlinks href=#hl-9-162>162</a>
</span><span class=lnt id=hl-9-163><a class=lnlinks href=#hl-9-163>163</a>
</span><span class=lnt id=hl-9-164><a class=lnlinks href=#hl-9-164>164</a>
</span><span class=lnt id=hl-9-165><a class=lnlinks href=#hl-9-165>165</a>
</span><span class=lnt id=hl-9-166><a class=lnlinks href=#hl-9-166>166</a>
</span><span class=lnt id=hl-9-167><a class=lnlinks href=#hl-9-167>167</a>
</span><span class=lnt id=hl-9-168><a class=lnlinks href=#hl-9-168>168</a>
</span><span class=lnt id=hl-9-169><a class=lnlinks href=#hl-9-169>169</a>
</span><span class=lnt id=hl-9-170><a class=lnlinks href=#hl-9-170>170</a>
</span><span class=lnt id=hl-9-171><a class=lnlinks href=#hl-9-171>171</a>
</span><span class=lnt id=hl-9-172><a class=lnlinks href=#hl-9-172>172</a>
</span><span class=lnt id=hl-9-173><a class=lnlinks href=#hl-9-173>173</a>
</span><span class=lnt id=hl-9-174><a class=lnlinks href=#hl-9-174>174</a>
</span><span class=lnt id=hl-9-175><a class=lnlinks href=#hl-9-175>175</a>
</span><span class=lnt id=hl-9-176><a class=lnlinks href=#hl-9-176>176</a>
</span><span class=lnt id=hl-9-177><a class=lnlinks href=#hl-9-177>177</a>
</span><span class=lnt id=hl-9-178><a class=lnlinks href=#hl-9-178>178</a>
</span><span class=lnt id=hl-9-179><a class=lnlinks href=#hl-9-179>179</a>
</span><span class=lnt id=hl-9-180><a class=lnlinks href=#hl-9-180>180</a>
</span><span class=lnt id=hl-9-181><a class=lnlinks href=#hl-9-181>181</a>
</span><span class=lnt id=hl-9-182><a class=lnlinks href=#hl-9-182>182</a>
</span><span class=lnt id=hl-9-183><a class=lnlinks href=#hl-9-183>183</a>
</span><span class=lnt id=hl-9-184><a class=lnlinks href=#hl-9-184>184</a>
</span><span class=lnt id=hl-9-185><a class=lnlinks href=#hl-9-185>185</a>
</span><span class=lnt id=hl-9-186><a class=lnlinks href=#hl-9-186>186</a>
</span><span class=lnt id=hl-9-187><a class=lnlinks href=#hl-9-187>187</a>
</span><span class=lnt id=hl-9-188><a class=lnlinks href=#hl-9-188>188</a>
</span><span class=lnt id=hl-9-189><a class=lnlinks href=#hl-9-189>189</a>
</span><span class=lnt id=hl-9-190><a class=lnlinks href=#hl-9-190>190</a>
</span><span class=lnt id=hl-9-191><a class=lnlinks href=#hl-9-191>191</a>
</span><span class=lnt id=hl-9-192><a class=lnlinks href=#hl-9-192>192</a>
</span><span class=lnt id=hl-9-193><a class=lnlinks href=#hl-9-193>193</a>
</span><span class=lnt id=hl-9-194><a class=lnlinks href=#hl-9-194>194</a>
</span><span class=lnt id=hl-9-195><a class=lnlinks href=#hl-9-195>195</a>
</span><span class=lnt id=hl-9-196><a class=lnlinks href=#hl-9-196>196</a>
</span><span class=lnt id=hl-9-197><a class=lnlinks href=#hl-9-197>197</a>
</span><span class=lnt id=hl-9-198><a class=lnlinks href=#hl-9-198>198</a>
</span><span class=lnt id=hl-9-199><a class=lnlinks href=#hl-9-199>199</a>
</span><span class=lnt id=hl-9-200><a class=lnlinks href=#hl-9-200>200</a>
</span><span class=lnt id=hl-9-201><a class=lnlinks href=#hl-9-201>201</a>
</span><span class=lnt id=hl-9-202><a class=lnlinks href=#hl-9-202>202</a>
</span><span class=lnt id=hl-9-203><a class=lnlinks href=#hl-9-203>203</a>
</span><span class=lnt id=hl-9-204><a class=lnlinks href=#hl-9-204>204</a>
</span><span class=lnt id=hl-9-205><a class=lnlinks href=#hl-9-205>205</a>
</span><span class=lnt id=hl-9-206><a class=lnlinks href=#hl-9-206>206</a>
</span><span class=lnt id=hl-9-207><a class=lnlinks href=#hl-9-207>207</a>
</span><span class=lnt id=hl-9-208><a class=lnlinks href=#hl-9-208>208</a>
</span><span class=lnt id=hl-9-209><a class=lnlinks href=#hl-9-209>209</a>
</span><span class=lnt id=hl-9-210><a class=lnlinks href=#hl-9-210>210</a>
</span><span class=lnt id=hl-9-211><a class=lnlinks href=#hl-9-211>211</a>
</span><span class=lnt id=hl-9-212><a class=lnlinks href=#hl-9-212>212</a>
</span><span class=lnt id=hl-9-213><a class=lnlinks href=#hl-9-213>213</a>
</span><span class=lnt id=hl-9-214><a class=lnlinks href=#hl-9-214>214</a>
</span><span class=lnt id=hl-9-215><a class=lnlinks href=#hl-9-215>215</a>
</span><span class=lnt id=hl-9-216><a class=lnlinks href=#hl-9-216>216</a>
</span><span class=lnt id=hl-9-217><a class=lnlinks href=#hl-9-217>217</a>
</span><span class=lnt id=hl-9-218><a class=lnlinks href=#hl-9-218>218</a>
</span><span class=lnt id=hl-9-219><a class=lnlinks href=#hl-9-219>219</a>
</span><span class=lnt id=hl-9-220><a class=lnlinks href=#hl-9-220>220</a>
</span><span class=lnt id=hl-9-221><a class=lnlinks href=#hl-9-221>221</a>
</span><span class=lnt id=hl-9-222><a class=lnlinks href=#hl-9-222>222</a>
</span><span class=lnt id=hl-9-223><a class=lnlinks href=#hl-9-223>223</a>
</span><span class=lnt id=hl-9-224><a class=lnlinks href=#hl-9-224>224</a>
</span><span class=lnt id=hl-9-225><a class=lnlinks href=#hl-9-225>225</a>
</span><span class=lnt id=hl-9-226><a class=lnlinks href=#hl-9-226>226</a>
</span><span class=lnt id=hl-9-227><a class=lnlinks href=#hl-9-227>227</a>
</span><span class=lnt id=hl-9-228><a class=lnlinks href=#hl-9-228>228</a>
</span><span class=lnt id=hl-9-229><a class=lnlinks href=#hl-9-229>229</a>
</span><span class=lnt id=hl-9-230><a class=lnlinks href=#hl-9-230>230</a>
</span><span class=lnt id=hl-9-231><a class=lnlinks href=#hl-9-231>231</a>
</span><span class=lnt id=hl-9-232><a class=lnlinks href=#hl-9-232>232</a>
</span><span class=lnt id=hl-9-233><a class=lnlinks href=#hl-9-233>233</a>
</span><span class=lnt id=hl-9-234><a class=lnlinks href=#hl-9-234>234</a>
</span><span class=lnt id=hl-9-235><a class=lnlinks href=#hl-9-235>235</a>
</span><span class=lnt id=hl-9-236><a class=lnlinks href=#hl-9-236>236</a>
</span><span class=lnt id=hl-9-237><a class=lnlinks href=#hl-9-237>237</a>
</span><span class=lnt id=hl-9-238><a class=lnlinks href=#hl-9-238>238</a>
</span><span class=lnt id=hl-9-239><a class=lnlinks href=#hl-9-239>239</a>
</span><span class=lnt id=hl-9-240><a class=lnlinks href=#hl-9-240>240</a>
</span><span class=lnt id=hl-9-241><a class=lnlinks href=#hl-9-241>241</a>
</span><span class=lnt id=hl-9-242><a class=lnlinks href=#hl-9-242>242</a>
</span><span class=lnt id=hl-9-243><a class=lnlinks href=#hl-9-243>243</a>
</span><span class=lnt id=hl-9-244><a class=lnlinks href=#hl-9-244>244</a>
</span><span class=lnt id=hl-9-245><a class=lnlinks href=#hl-9-245>245</a>
</span><span class=lnt id=hl-9-246><a class=lnlinks href=#hl-9-246>246</a>
</span><span class=lnt id=hl-9-247><a class=lnlinks href=#hl-9-247>247</a>
</span><span class=lnt id=hl-9-248><a class=lnlinks href=#hl-9-248>248</a>
</span><span class=lnt id=hl-9-249><a class=lnlinks href=#hl-9-249>249</a>
</span><span class=lnt id=hl-9-250><a class=lnlinks href=#hl-9-250>250</a>
</span><span class=lnt id=hl-9-251><a class=lnlinks href=#hl-9-251>251</a>
</span><span class=lnt id=hl-9-252><a class=lnlinks href=#hl-9-252>252</a>
</span><span class=lnt id=hl-9-253><a class=lnlinks href=#hl-9-253>253</a>
</span><span class=lnt id=hl-9-254><a class=lnlinks href=#hl-9-254>254</a>
</span><span class=lnt id=hl-9-255><a class=lnlinks href=#hl-9-255>255</a>
</span><span class=lnt id=hl-9-256><a class=lnlinks href=#hl-9-256>256</a>
</span><span class=lnt id=hl-9-257><a class=lnlinks href=#hl-9-257>257</a>
</span><span class=lnt id=hl-9-258><a class=lnlinks href=#hl-9-258>258</a>
</span><span class=lnt id=hl-9-259><a class=lnlinks href=#hl-9-259>259</a>
</span><span class=lnt id=hl-9-260><a class=lnlinks href=#hl-9-260>260</a>
</span><span class=lnt id=hl-9-261><a class=lnlinks href=#hl-9-261>261</a>
</span><span class=lnt id=hl-9-262><a class=lnlinks href=#hl-9-262>262</a>
</span><span class=lnt id=hl-9-263><a class=lnlinks href=#hl-9-263>263</a>
</span><span class=lnt id=hl-9-264><a class=lnlinks href=#hl-9-264>264</a>
</span><span class=lnt id=hl-9-265><a class=lnlinks href=#hl-9-265>265</a>
</span><span class=lnt id=hl-9-266><a class=lnlinks href=#hl-9-266>266</a>
</span><span class=lnt id=hl-9-267><a class=lnlinks href=#hl-9-267>267</a>
</span><span class=lnt id=hl-9-268><a class=lnlinks href=#hl-9-268>268</a>
</span><span class=lnt id=hl-9-269><a class=lnlinks href=#hl-9-269>269</a>
</span><span class=lnt id=hl-9-270><a class=lnlinks href=#hl-9-270>270</a>
</span><span class=lnt id=hl-9-271><a class=lnlinks href=#hl-9-271>271</a>
</span><span class=lnt id=hl-9-272><a class=lnlinks href=#hl-9-272>272</a>
</span><span class=lnt id=hl-9-273><a class=lnlinks href=#hl-9-273>273</a>
</span><span class=lnt id=hl-9-274><a class=lnlinks href=#hl-9-274>274</a>
</span><span class=lnt id=hl-9-275><a class=lnlinks href=#hl-9-275>275</a>
</span><span class=lnt id=hl-9-276><a class=lnlinks href=#hl-9-276>276</a>
</span><span class=lnt id=hl-9-277><a class=lnlinks href=#hl-9-277>277</a>
</span><span class=lnt id=hl-9-278><a class=lnlinks href=#hl-9-278>278</a>
</span><span class=lnt id=hl-9-279><a class=lnlinks href=#hl-9-279>279</a>
</span><span class=lnt id=hl-9-280><a class=lnlinks href=#hl-9-280>280</a>
</span><span class=lnt id=hl-9-281><a class=lnlinks href=#hl-9-281>281</a>
</span><span class=lnt id=hl-9-282><a class=lnlinks href=#hl-9-282>282</a>
</span><span class=lnt id=hl-9-283><a class=lnlinks href=#hl-9-283>283</a>
</span><span class=lnt id=hl-9-284><a class=lnlinks href=#hl-9-284>284</a>
</span><span class=lnt id=hl-9-285><a class=lnlinks href=#hl-9-285>285</a>
</span><span class=lnt id=hl-9-286><a class=lnlinks href=#hl-9-286>286</a>
</span><span class=lnt id=hl-9-287><a class=lnlinks href=#hl-9-287>287</a>
</span><span class=lnt id=hl-9-288><a class=lnlinks href=#hl-9-288>288</a>
</span><span class=lnt id=hl-9-289><a class=lnlinks href=#hl-9-289>289</a>
</span><span class=lnt id=hl-9-290><a class=lnlinks href=#hl-9-290>290</a>
</span><span class=lnt id=hl-9-291><a class=lnlinks href=#hl-9-291>291</a>
</span><span class=lnt id=hl-9-292><a class=lnlinks href=#hl-9-292>292</a>
</span><span class=lnt id=hl-9-293><a class=lnlinks href=#hl-9-293>293</a>
</span><span class=lnt id=hl-9-294><a class=lnlinks href=#hl-9-294>294</a>
</span><span class=lnt id=hl-9-295><a class=lnlinks href=#hl-9-295>295</a>
</span><span class=lnt id=hl-9-296><a class=lnlinks href=#hl-9-296>296</a>
</span><span class=lnt id=hl-9-297><a class=lnlinks href=#hl-9-297>297</a>
</span><span class=lnt id=hl-9-298><a class=lnlinks href=#hl-9-298>298</a>
</span><span class=lnt id=hl-9-299><a class=lnlinks href=#hl-9-299>299</a>
</span><span class=lnt id=hl-9-300><a class=lnlinks href=#hl-9-300>300</a>
</span><span class=lnt id=hl-9-301><a class=lnlinks href=#hl-9-301>301</a>
</span><span class=lnt id=hl-9-302><a class=lnlinks href=#hl-9-302>302</a>
</span><span class=lnt id=hl-9-303><a class=lnlinks href=#hl-9-303>303</a>
</span><span class=lnt id=hl-9-304><a class=lnlinks href=#hl-9-304>304</a>
</span><span class=lnt id=hl-9-305><a class=lnlinks href=#hl-9-305>305</a>
</span><span class=lnt id=hl-9-306><a class=lnlinks href=#hl-9-306>306</a>
</span><span class=lnt id=hl-9-307><a class=lnlinks href=#hl-9-307>307</a>
</span><span class=lnt id=hl-9-308><a class=lnlinks href=#hl-9-308>308</a>
</span><span class=lnt id=hl-9-309><a class=lnlinks href=#hl-9-309>309</a>
</span><span class=lnt id=hl-9-310><a class=lnlinks href=#hl-9-310>310</a>
</span><span class=lnt id=hl-9-311><a class=lnlinks href=#hl-9-311>311</a>
</span><span class=lnt id=hl-9-312><a class=lnlinks href=#hl-9-312>312</a>
</span><span class=lnt id=hl-9-313><a class=lnlinks href=#hl-9-313>313</a>
</span><span class=lnt id=hl-9-314><a class=lnlinks href=#hl-9-314>314</a>
</span><span class=lnt id=hl-9-315><a class=lnlinks href=#hl-9-315>315</a>
</span><span class=lnt id=hl-9-316><a class=lnlinks href=#hl-9-316>316</a>
</span><span class=lnt id=hl-9-317><a class=lnlinks href=#hl-9-317>317</a>
</span><span class=lnt id=hl-9-318><a class=lnlinks href=#hl-9-318>318</a>
</span><span class=lnt id=hl-9-319><a class=lnlinks href=#hl-9-319>319</a>
</span><span class=lnt id=hl-9-320><a class=lnlinks href=#hl-9-320>320</a>
</span><span class=lnt id=hl-9-321><a class=lnlinks href=#hl-9-321>321</a>
</span><span class=lnt id=hl-9-322><a class=lnlinks href=#hl-9-322>322</a>
</span><span class=lnt id=hl-9-323><a class=lnlinks href=#hl-9-323>323</a>
</span><span class=lnt id=hl-9-324><a class=lnlinks href=#hl-9-324>324</a>
</span><span class=lnt id=hl-9-325><a class=lnlinks href=#hl-9-325>325</a>
</span><span class=lnt id=hl-9-326><a class=lnlinks href=#hl-9-326>326</a>
</span><span class=lnt id=hl-9-327><a class=lnlinks href=#hl-9-327>327</a>
</span><span class=lnt id=hl-9-328><a class=lnlinks href=#hl-9-328>328</a>
</span><span class=lnt id=hl-9-329><a class=lnlinks href=#hl-9-329>329</a>
</span><span class=lnt id=hl-9-330><a class=lnlinks href=#hl-9-330>330</a>
</span><span class=lnt id=hl-9-331><a class=lnlinks href=#hl-9-331>331</a>
</span><span class=lnt id=hl-9-332><a class=lnlinks href=#hl-9-332>332</a>
</span><span class=lnt id=hl-9-333><a class=lnlinks href=#hl-9-333>333</a>
</span><span class=lnt id=hl-9-334><a class=lnlinks href=#hl-9-334>334</a>
</span><span class=lnt id=hl-9-335><a class=lnlinks href=#hl-9-335>335</a>
</span><span class=lnt id=hl-9-336><a class=lnlinks href=#hl-9-336>336</a>
</span><span class=lnt id=hl-9-337><a class=lnlinks href=#hl-9-337>337</a>
</span><span class=lnt id=hl-9-338><a class=lnlinks href=#hl-9-338>338</a>
</span><span class=lnt id=hl-9-339><a class=lnlinks href=#hl-9-339>339</a>
</span><span class=lnt id=hl-9-340><a class=lnlinks href=#hl-9-340>340</a>
</span><span class=lnt id=hl-9-341><a class=lnlinks href=#hl-9-341>341</a>
</span><span class=lnt id=hl-9-342><a class=lnlinks href=#hl-9-342>342</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 모델 모니터링 및 재훈련 파이프라인 예시 코드</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sklearn.metrics</span> <span class=kn>import</span> <span class=n>accuracy_score</span><span class=p>,</span> <span class=n>precision_score</span><span class=p>,</span> <span class=n>recall_score</span><span class=p>,</span> <span class=n>f1_score</span><span class=p>,</span> <span class=n>roc_auc_score</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy.stats</span> <span class=kn>import</span> <span class=n>ks_2samp</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>mlflow</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>mlflow.sklearn</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>mlflow.tracking</span> <span class=kn>import</span> <span class=n>MlflowClient</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span><span class=p>,</span> <span class=n>timedelta</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>schedule</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 로깅 설정</span>
</span></span><span class=line><span class=cl><span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> - </span><span class=si>%(name)s</span><span class=s1> - </span><span class=si>%(levelname)s</span><span class=s1> - </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># MLflow 설정</span>
</span></span><span class=line><span class=cl><span class=n>mlflow</span><span class=o>.</span><span class=n>set_tracking_uri</span><span class=p>(</span><span class=s2>&#34;http://localhost:5000&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>client</span> <span class=o>=</span> <span class=n>MlflowClient</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>model_name</span> <span class=o>=</span> <span class=s2>&#34;customer_churn_predictor&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 알림 설정</span>
</span></span><span class=line><span class=cl><span class=n>SLACK_WEBHOOK_URL</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;SLACK_WEBHOOK_URL&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>EMAIL_API_URL</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;EMAIL_API_URL&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>EMAIL_API_KEY</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;EMAIL_API_KEY&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>TEAM_EMAIL</span> <span class=o>=</span> <span class=s2>&#34;ai-team@example.com&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>load_reference_data</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;기준 데이터 로드&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 기준 데이터 경로</span>
</span></span><span class=line><span class=cl>        <span class=n>reference_features_path</span> <span class=o>=</span> <span class=s2>&#34;data/reference/customer_features.csv&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>reference_predictions_path</span> <span class=o>=</span> <span class=s2>&#34;data/reference/model_predictions.csv&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 기준 특성 데이터 로드</span>
</span></span><span class=line><span class=cl>        <span class=n>reference_features</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>reference_features_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 기준 예측 및 실제 결과 로드</span>
</span></span><span class=line><span class=cl>        <span class=n>reference_predictions</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>reference_predictions_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>reference_features</span><span class=p>,</span> <span class=n>reference_predictions</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error loading reference data: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>load_production_data</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=mi>7</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;최근 프로덕션 데이터 로드&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 최근 7일간의 데이터 로드</span>
</span></span><span class=line><span class=cl>        <span class=n>end_date</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>start_date</span> <span class=o>=</span> <span class=n>end_date</span> <span class=o>-</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=n>days</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 실제 구현에서는 데이터베이스 쿼리 또는 로그 분석 시스템에서 데이터 추출</span>
</span></span><span class=line><span class=cl>        <span class=c1># 예시를 위한 가상 데이터 경로</span>
</span></span><span class=line><span class=cl>        <span class=n>production_data_path</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;data/production/customer_data_</span><span class=si>{</span><span class=n>start_date</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y%m</span><span class=si>%d</span><span class=s1>&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>end_date</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y%m</span><span class=si>%d</span><span class=s1>&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>.csv&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 프로덕션 데이터 로드</span>
</span></span><span class=line><span class=cl>        <span class=n>production_data</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=n>production_data_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>production_data</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error loading production data: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>detect_data_drift</span><span class=p>(</span><span class=n>reference_data</span><span class=p>,</span> <span class=n>production_data</span><span class=p>,</span> <span class=n>threshold</span><span class=o>=</span><span class=mf>0.05</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;데이터 드리프트 감지&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>drift_detected</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=n>drift_features</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 수치형 특성에 대해 Kolmogorov-Smirnov 테스트 수행</span>
</span></span><span class=line><span class=cl>        <span class=n>numeric_features</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;subscription_length&#39;</span><span class=p>,</span> <span class=s1>&#39;monthly_charges&#39;</span><span class=p>,</span> <span class=s1>&#39;total_charges&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                           <span class=s1>&#39;tech_support_calls&#39;</span><span class=p>,</span> <span class=s1>&#39;last_active_days&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>feature</span> <span class=ow>in</span> <span class=n>numeric_features</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>feature</span> <span class=ow>in</span> <span class=n>reference_data</span><span class=o>.</span><span class=n>columns</span> <span class=ow>and</span> <span class=n>feature</span> <span class=ow>in</span> <span class=n>production_data</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># KS 테스트로 두 분포의 차이 검정</span>
</span></span><span class=line><span class=cl>                <span class=n>ks_stat</span><span class=p>,</span> <span class=n>p_value</span> <span class=o>=</span> <span class=n>ks_2samp</span><span class=p>(</span><span class=n>reference_data</span><span class=p>[</span><span class=n>feature</span><span class=p>]</span><span class=o>.</span><span class=n>dropna</span><span class=p>(),</span> 
</span></span><span class=line><span class=cl>                                           <span class=n>production_data</span><span class=p>[</span><span class=n>feature</span><span class=p>]</span><span class=o>.</span><span class=n>dropna</span><span class=p>())</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;KS test for </span><span class=si>{</span><span class=n>feature</span><span class=si>}</span><span class=s2>: statistic=</span><span class=si>{</span><span class=n>ks_stat</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>, p-value=</span><span class=si>{</span><span class=n>p_value</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># p-value가 임계값보다 작으면 드리프트 감지</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>p_value</span> <span class=o>&lt;</span> <span class=n>threshold</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>drift_detected</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>                    <span class=n>drift_features</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;feature&#39;</span><span class=p>:</span> <span class=n>feature</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;ks_statistic&#39;</span><span class=p>:</span> <span class=n>ks_stat</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;p_value&#39;</span><span class=p>:</span> <span class=n>p_value</span>
</span></span><span class=line><span class=cl>                    <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 범주형 특성에 대한 분포 비교</span>
</span></span><span class=line><span class=cl>        <span class=n>categorical_features</span> <span class=o>=</span> <span class=p>[</span><span class=n>col</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>reference_data</span><span class=o>.</span><span class=n>columns</span> 
</span></span><span class=line><span class=cl>                               <span class=k>if</span> <span class=n>col</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;contract_type_&#39;</span><span class=p>)</span> <span class=ow>or</span> <span class=n>col</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;payment_method_&#39;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>feature</span> <span class=ow>in</span> <span class=n>categorical_features</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>feature</span> <span class=ow>in</span> <span class=n>reference_data</span><span class=o>.</span><span class=n>columns</span> <span class=ow>and</span> <span class=n>feature</span> <span class=ow>in</span> <span class=n>production_data</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># 범주 비율 계산</span>
</span></span><span class=line><span class=cl>                <span class=n>ref_ratio</span> <span class=o>=</span> <span class=n>reference_data</span><span class=p>[</span><span class=n>feature</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=n>prod_ratio</span> <span class=o>=</span> <span class=n>production_data</span><span class=p>[</span><span class=n>feature</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 비율 차이가 임계값보다 크면 드리프트 감지</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>ref_ratio</span> <span class=o>-</span> <span class=n>prod_ratio</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>threshold</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>drift_detected</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>                    <span class=n>drift_features</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;feature&#39;</span><span class=p>:</span> <span class=n>feature</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;reference_ratio&#39;</span><span class=p>:</span> <span class=n>ref_ratio</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;production_ratio&#39;</span><span class=p>:</span> <span class=n>prod_ratio</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;difference&#39;</span><span class=p>:</span> <span class=nb>abs</span><span class=p>(</span><span class=n>ref_ratio</span> <span class=o>-</span> <span class=n>prod_ratio</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>drift_detected</span><span class=p>,</span> <span class=n>drift_features</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error detecting data drift: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>evaluate_model_performance</span><span class=p>(</span><span class=n>predictions_df</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;모델 성능 평가&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 예측 및 실제 결과 추출</span>
</span></span><span class=line><span class=cl>        <span class=n>y_true</span> <span class=o>=</span> <span class=n>predictions_df</span><span class=p>[</span><span class=s1>&#39;actual_churn&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>y_pred</span> <span class=o>=</span> <span class=n>predictions_df</span><span class=p>[</span><span class=s1>&#39;predicted_churn&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>y_prob</span> <span class=o>=</span> <span class=n>predictions_df</span><span class=p>[</span><span class=s1>&#39;churn_probability&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 평가 메트릭 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;accuracy&#39;</span><span class=p>:</span> <span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;precision&#39;</span><span class=p>:</span> <span class=n>precision_score</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;recall&#39;</span><span class=p>:</span> <span class=n>recall_score</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;f1_score&#39;</span><span class=p>:</span> <span class=n>f1_score</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;roc_auc&#39;</span><span class=p>:</span> <span class=n>roc_auc_score</span><span class=p>(</span><span class=n>y_true</span><span class=p>,</span> <span class=n>y_prob</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Model performance metrics: </span><span class=si>{</span><span class=n>metrics</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>metrics</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error evaluating model performance: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>detect_performance_drift</span><span class=p>(</span><span class=n>baseline_metrics</span><span class=p>,</span> <span class=n>current_metrics</span><span class=p>,</span> <span class=n>threshold</span><span class=o>=</span><span class=mf>0.05</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;성능 드리프트 감지&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>performance_drift</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=n>drift_metrics</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>metric</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>current_metrics</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>metric</span> <span class=ow>in</span> <span class=n>baseline_metrics</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>diff</span> <span class=o>=</span> <span class=n>baseline_metrics</span><span class=p>[</span><span class=n>metric</span><span class=p>]</span> <span class=o>-</span> <span class=n>value</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 성능 저하가 임계값보다 크면 드리프트 감지</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>diff</span> <span class=o>&gt;</span> <span class=n>threshold</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>performance_drift</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>                    <span class=n>drift_metrics</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;metric&#39;</span><span class=p>:</span> <span class=n>metric</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;baseline&#39;</span><span class=p>:</span> <span class=n>baseline_metrics</span><span class=p>[</span><span class=n>metric</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;current&#39;</span><span class=p>:</span> <span class=n>value</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;difference&#39;</span><span class=p>:</span> <span class=n>diff</span>
</span></span><span class=line><span class=cl>                    <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>performance_drift</span><span class=p>,</span> <span class=n>drift_metrics</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error detecting performance drift: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_alert</span><span class=p>(</span><span class=n>title</span><span class=p>,</span> <span class=n>message</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=s1>&#39;info&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;알림 전송&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Slack 웹훅으로 알림 전송</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>SLACK_WEBHOOK_URL</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>slack_payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;text&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;*</span><span class=si>{</span><span class=n>title</span><span class=si>}</span><span class=s2>*</span><span class=se>\n</span><span class=si>{</span><span class=n>message</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=s1>&#39;Model Monitoring Bot&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;icon_emoji&#39;</span><span class=p>:</span> <span class=s1>&#39;:robot_face:&#39;</span> <span class=k>if</span> <span class=n>level</span> <span class=o>==</span> <span class=s1>&#39;info&#39;</span> <span class=k>else</span> <span class=s1>&#39;:warning:&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>SLACK_WEBHOOK_URL</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>slack_payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 심각한 알림은 이메일로도 전송</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>level</span> <span class=o>==</span> <span class=s1>&#39;critical&#39;</span> <span class=ow>and</span> <span class=n>EMAIL_API_URL</span> <span class=ow>and</span> <span class=n>EMAIL_API_KEY</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>email_payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;to&#39;</span><span class=p>:</span> <span class=n>TEAM_EMAIL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;subject&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;[URGENT] </span><span class=si>{</span><span class=n>title</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;body&#39;</span><span class=p>:</span> <span class=n>message</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;api_key&#39;</span><span class=p>:</span> <span class=n>EMAIL_API_KEY</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>EMAIL_API_URL</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>email_payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Alert sent: </span><span class=si>{</span><span class=n>title</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error sending alert: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>trigger_model_retraining</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;모델 재훈련 트리거&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 재훈련 파이프라인 API 호출</span>
</span></span><span class=line><span class=cl>        <span class=n>retraining_api_url</span> <span class=o>=</span> <span class=s2>&#34;http://airflow-api:8080/api/v1/dags/customer_churn_retraining/dagRuns&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;conf&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;triggered_by&#39;</span><span class=p>:</span> <span class=s1>&#39;monitoring_system&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Content-Type&#39;</span><span class=p>:</span> <span class=s1>&#39;application/json&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Authorization&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;Bearer </span><span class=si>{</span><span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s1>&#39;AIRFLOW_API_KEY&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>retraining_api_url</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>payload</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>run_id</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()[</span><span class=s1>&#39;dag_run_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Model retraining triggered successfully. Run ID: </span><span class=si>{</span><span class=n>run_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 알림 전송</span>
</span></span><span class=line><span class=cl>        <span class=n>send_alert</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Model Retraining Triggered&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;Customer churn model retraining has been triggered due to detected drift. Run ID: </span><span class=si>{</span><span class=n>run_id</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>run_id</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error triggering model retraining: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>send_alert</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Model Retraining Failed&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;Failed to trigger customer churn model retraining: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>level</span><span class=o>=</span><span class=s1>&#39;critical&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>run_monitoring_pipeline</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;모니터링 파이프라인 실행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Starting model monitoring pipeline…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 1. 기준 데이터 로드</span>
</span></span><span class=line><span class=cl>        <span class=n>reference_features</span><span class=p>,</span> <span class=n>reference_predictions</span> <span class=o>=</span> <span class=n>load_reference_data</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. 프로덕션 데이터 로드</span>
</span></span><span class=line><span class=cl>        <span class=n>production_data</span> <span class=o>=</span> <span class=n>load_production_data</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. 데이터 드리프트 감지</span>
</span></span><span class=line><span class=cl>        <span class=n>data_drift_detected</span><span class=p>,</span> <span class=n>drift_features</span> <span class=o>=</span> <span class=n>detect_data_drift</span><span class=p>(</span><span class=n>reference_features</span><span class=p>,</span> <span class=n>production_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>data_drift_detected</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&#34;Data drift detected!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>drift_message</span> <span class=o>=</span> <span class=s2>&#34;Data drift detected in the following features:</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>feature</span> <span class=ow>in</span> <span class=n>drift_features</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>drift_message</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;- </span><span class=si>{</span><span class=n>feature</span><span class=p>[</span><span class=s1>&#39;feature&#39;</span><span class=p>]</span><span class=si>}</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>send_alert</span><span class=p>(</span><span class=s2>&#34;Data Drift Detected&#34;</span><span class=p>,</span> <span class=n>drift_message</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=s1>&#39;warning&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 4. 현재 프로덕션 모델 성능 평가</span>
</span></span><span class=line><span class=cl>        <span class=c1># 실제 구현에서는 라벨이 지연되어 도착할 수 있음을 고려해야 함</span>
</span></span><span class=line><span class=cl>        <span class=n>production_predictions</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s2>&#34;data/production/recent_predictions_with_actuals.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>current_metrics</span> <span class=o>=</span> <span class=n>evaluate_model_performance</span><span class=p>(</span><span class=n>production_predictions</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 5. 기준 성능 지표 로드</span>
</span></span><span class=line><span class=cl>        <span class=n>latest_model_version</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>get_latest_versions</span><span class=p>(</span><span class=n>model_name</span><span class=p>,</span> <span class=n>stages</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;Production&#34;</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>run_id</span> <span class=o>=</span> <span class=n>latest_model_version</span><span class=o>.</span><span class=n>run_id</span>
</span></span><span class=line><span class=cl>        <span class=n>run</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>get_run</span><span class=p>(</span><span class=n>run_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>baseline_metrics</span> <span class=o>=</span> <span class=p>{</span><span class=n>k</span><span class=p>:</span> <span class=n>v</span> <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>run</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>metrics</span><span class=o>.</span><span class=n>items</span><span class=p>()</span> 
</span></span><span class=line><span class=cl>                           <span class=k>if</span> <span class=n>k</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;accuracy&#39;</span><span class=p>,</span> <span class=s1>&#39;precision&#39;</span><span class=p>,</span> <span class=s1>&#39;recall&#39;</span><span class=p>,</span> <span class=s1>&#39;f1_score&#39;</span><span class=p>,</span> <span class=s1>&#39;roc_auc&#39;</span><span class=p>]}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 6. 성능 드리프트 감지</span>
</span></span><span class=line><span class=cl>        <span class=n>performance_drift</span><span class=p>,</span> <span class=n>drift_metrics</span> <span class=o>=</span> <span class=n>detect_performance_drift</span><span class=p>(</span><span class=n>baseline_metrics</span><span class=p>,</span> <span class=n>current_metrics</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>performance_drift</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&#34;Performance drift detected!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>drift_message</span> <span class=o>=</span> <span class=s2>&#34;Model performance drift detected:</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>metric</span> <span class=ow>in</span> <span class=n>drift_metrics</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>drift_message</span> <span class=o>+=</span> <span class=sa>f</span><span class=s2>&#34;- </span><span class=si>{</span><span class=n>metric</span><span class=p>[</span><span class=s1>&#39;metric&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>metric</span><span class=p>[</span><span class=s1>&#39;baseline&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2> → </span><span class=si>{</span><span class=n>metric</span><span class=p>[</span><span class=s1>&#39;current&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2> (Δ </span><span class=si>{</span><span class=n>metric</span><span class=p>[</span><span class=s1>&#39;difference&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>)</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>send_alert</span><span class=p>(</span><span class=s2>&#34;Performance Drift Detected&#34;</span><span class=p>,</span> <span class=n>drift_message</span><span class=p>,</span> <span class=n>level</span><span class=o>=</span><span class=s1>&#39;warning&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 7. 재훈련 필요 여부 결정</span>
</span></span><span class=line><span class=cl>        <span class=n>retrain_threshold</span> <span class=o>=</span> <span class=mf>0.1</span>  <span class=c1># 성능 10% 이상 저하 시 재훈련</span>
</span></span><span class=line><span class=cl>        <span class=n>significant_performance_drift</span> <span class=o>=</span> <span class=nb>any</span><span class=p>(</span><span class=n>m</span><span class=p>[</span><span class=s1>&#39;difference&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>retrain_threshold</span> <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>drift_metrics</span><span class=p>)</span> <span class=k>if</span> <span class=n>performance_drift</span> <span class=k>else</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>data_drift_detected</span> <span class=ow>and</span> <span class=n>significant_performance_drift</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&#34;Significant drift detected. Triggering model retraining…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>trigger_model_retraining</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>data_drift_detected</span> <span class=ow>or</span> <span class=n>significant_performance_drift</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Drift detected but not significant enough for automatic retraining.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>send_alert</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;Drift Detected - Manual Review Required&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;Data or performance drift has been detected but is not significant enough for automatic retraining. Please review the monitoring dashboard.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>level</span><span class=o>=</span><span class=s1>&#39;info&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;No significant drift detected. Model is performing well.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 8. 결과 저장</span>
</span></span><span class=line><span class=cl>        <span class=n>monitoring_results</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;data_drift_detected&#39;</span><span class=p>:</span> <span class=n>data_drift_detected</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;performance_drift_detected&#39;</span><span class=p>:</span> <span class=n>performance_drift</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;current_metrics&#39;</span><span class=p>:</span> <span class=n>current_metrics</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;baseline_metrics&#39;</span><span class=p>:</span> <span class=n>baseline_metrics</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;retrain_triggered&#39;</span><span class=p>:</span> <span class=n>data_drift_detected</span> <span class=ow>and</span> <span class=n>significant_performance_drift</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;logs/monitoring_</span><span class=si>{</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y%m</span><span class=si>%d</span><span class=s1>_%H%M%S&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>.json&#34;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>monitoring_results</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Model monitoring pipeline completed successfully.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error in monitoring pipeline: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>send_alert</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Monitoring Pipeline Error&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;The model monitoring pipeline encountered an error: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>level</span><span class=o>=</span><span class=s1>&#39;critical&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>schedule_monitoring</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;모니터링 작업 스케줄링&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 매일 자정에 모니터링 파이프라인 실행</span>
</span></span><span class=line><span class=cl>    <span class=n>schedule</span><span class=o>.</span><span class=n>every</span><span class=p>()</span><span class=o>.</span><span class=n>day</span><span class=o>.</span><span class=n>at</span><span class=p>(</span><span class=s2>&#34;00:00&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>do</span><span class=p>(</span><span class=n>run_monitoring_pipeline</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 매주 월요일에 상세 보고서 생성</span>
</span></span><span class=line><span class=cl>    <span class=c1># schedule.every().monday.at(&#34;09:00&#34;).do(generate_weekly_report)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Monitoring tasks scheduled.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>schedule</span><span class=o>.</span><span class=n>run_pending</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>60</span><span class=p>)</span>  <span class=c1># 1분마다 스케줄 확인</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 스크립트 직접 실행 시 즉시 실행 후 스케줄링</span>
</span></span><span class=line><span class=cl>    <span class=n>run_monitoring_pipeline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>schedule_monitoring</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=실제-ai-엔지니어링-워크플로우>실제 AI 엔지니어링 워크플로우<a hidden class=anchor aria-hidden=true href=#실제-ai-엔지니어링-워크플로우>#</a></h4><p>위에서 살펴본 고객 이탈 예측 시스템 예시를 통해 AI 엔지니어링의 전체 워크플로우를 이해할 수 있다.<br>이 워크플로우는 다음과 같은 단계로 구성된다:</p><ol><li><strong>문제 정의 및 범위 설정</strong><ul><li>비즈니스 문제 이해 및 AI 접근 방식 결정</li><li>성공 기준 및 제약 조건 설정</li></ul></li><li><strong>데이터 파이프라인 구축</strong><ul><li>데이터 소스 연결 및 수집 자동화</li><li>데이터 검증 및 전처리 단계 구현</li><li>특성 엔지니어링 및 데이터 변환</li></ul></li><li><strong>모델 개발 및 실험</strong><ul><li>다양한 모델 아키텍처 및 알고리즘 실험</li><li>하이퍼파라미터 최적화 및 교차 검증</li><li>실험 추적 및 버전 관리</li></ul></li><li><strong>모델 배포 인프라 구축</strong><ul><li>모델 패키징 및 컨테이너화</li><li>API 설계 및 개발</li><li>확장성 및 성능 최적화</li></ul></li><li><strong>CI/CD 파이프라인 구축</strong><ul><li>코드 및 모델 테스트 자동화</li><li>지속적 통합 및 배포 워크플로우 설정</li><li>환경별 설정 관리</li></ul></li><li><strong>모니터링 시스템 구축</strong><ul><li>모델 성능 메트릭 정의 및 추적</li><li>데이터 드리프트 감지 메커니즘 구현</li><li>알림 및 보고 시스템 설정</li></ul></li><li><strong>피드백 루프 및 재훈련</strong><ul><li>모델 성능 저하 감지 시 자동 재훈련</li><li>A/B 테스트를 통한 모델 업데이트 검증</li><li>지속적인 모델 개선</li></ul></li></ol><h3 id=ai-엔지니어링의-미래-동향>AI 엔지니어링의 미래 동향<a hidden class=anchor aria-hidden=true href=#ai-엔지니어링의-미래-동향>#</a></h3><ol><li><p>자동화 및 Low-Code/No-Code 솔루션</p><ul><li><strong>AutoML의 발전</strong>: 모델 선택, 하이퍼파라미터 최적화, 특성 엔지니어링의 자동화</li><li><strong>ML 파이프라인 자동화</strong>: 데이터 준비부터 모델 배포까지 자동화된 파이프라인</li><li><strong>Low-Code AI 플랫폼</strong>: 코딩 지식이 적은 사용자도 AI 시스템을 구축할 수 있는 도구</li></ul></li><li><p>분산 및 연합 학습</p><ul><li><strong>에지 AI</strong>: 에지 디바이스에서의 AI 모델 실행 및 학습</li><li><strong>연합 학습(Federated Learning)</strong>: 중앙 데이터 저장소 없이 분산된 디바이스에서 학습</li><li><strong>프라이버시 보존 AI</strong>: 개인 정보를 보호하면서 학습 및 추론</li></ul></li><li><p>생성형 AI 및 대규모 언어 모델</p><ul><li><strong>생성형 AI 파이프라인</strong>: 텍스트, 이미지, 오디오 생성 모델의 개발 및 배포</li><li><strong>LLM 응용 개발</strong>: 대규모 언어 모델을 활용한 애플리케이션 개발</li><li><strong>파인튜닝 및 추론 최적화</strong>: 대규모 모델의 효율적인 맞춤화 및 추론</li></ul></li><li><p>책임 있는 AI 엔지니어링</p><ul><li><strong>AI 거버넌스</strong>: AI 시스템의 개발 및 배포를 관리하는 프레임워크</li><li><strong>공정성 및 편향 감지</strong>: AI 시스템의 공정성을 보장하기 위한 방법론</li><li><strong>설명 가능한 AI(XAI)</strong>: AI 모델의 결정을 이해하고 설명하는 기법</li><li><strong>지속 가능한 AI</strong>: 환경적 영향을 최소화하는 AI 시스템 개발</li></ul></li><li><p>AI 시스템 보안</p><ul><li><strong>적대적 공격 방어</strong>: 모델 강인성 향상 및 적대적 공격 방어</li><li><strong>AI 모델 도난 방지</strong>: 모델 지적 재산권 보호</li><li><strong>데이터 누출 감지</strong>: 모델을 통한 훈련 데이터 유출 방지</li></ul></li></ol><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><hr><h2 id=roadmap>Roadmap<a hidden class=anchor aria-hidden=true href=#roadmap>#</a></h2><p><a href=https://roadmap.sh/ai-engineer>Roadmap - AI Engineer</a></p><hr><h3 id=학습-로드맵>학습 로드맵<a hidden class=anchor aria-hidden=true href=#학습-로드맵>#</a></h3><h4 id=-이론적으로-꼭-알아야-할-내용-foundation-for-ai-system-design>📘 이론적으로 꼭 알아야 할 내용 (Foundation for AI System Design)<a hidden class=anchor aria-hidden=true href=#-이론적으로-꼭-알아야-할-내용-foundation-for-ai-system-design>#</a></h4><table><thead><tr><th>영역</th><th>내용</th><th>설명</th></tr></thead><tbody><tr><td>✅ AI 시스템 설계 원칙</td><td>AI를 하나의 엔지니어링 시스템으로 접근하는 방법론</td><td>성능, 확장성, 신뢰성, 유지보수성을 고려한 설계</td></tr><tr><td>✅ 머신러닝/딥러닝 기초</td><td>지도학습, 비지도학습, 강화학습</td><td>각 알고리즘의 구조, 한계, 적용 조건 등 이해</td></tr><tr><td>✅ 데이터 엔지니어링 기초</td><td>ETL, 데이터 전처리, 피처 엔지니어링</td><td>좋은 AI는 좋은 데이터에서 출발한다는 기본 원리</td></tr><tr><td>✅ 모델 서빙 및 배포 전략</td><td>온라인/오프라인 서빙, REST API, ONNX 등</td><td>모델을 실제 서비스에 적용하는 전략적 접근</td></tr><tr><td>✅ AI 윤리 및 안전성</td><td>바이어스, 설명가능성, 책임 있는 AI</td><td>신뢰받는 AI 시스템을 위한 필수 요소</td></tr><tr><td>✅ 소프트웨어 아키텍처 이론</td><td>모듈화, 마이크로서비스, 이벤트 기반 구조</td><td>AI 시스템의 확장성과 유지보수성 확보</td></tr><tr><td>✅ 실험 관리와 버전 관리</td><td>실험 추적, 하이퍼파라미터 기록, 모델 버전 관리</td><td>reproducibility 확보를 위한 원칙</td></tr><tr><td>✅ MLOps 원리</td><td>DevOps + ML 모델 운영 관리</td><td>CI/CD + 모델 학습/배포/모니터링 자동화 이론</td></tr></tbody></table><blockquote><p>📌 목적: AI를 &ldquo;개발 가능한 시스템"으로 설계할 수 있는 기초 확보</p></blockquote><h4 id=-실무적으로-꼭-알아야-할-내용-implementation--operation>🛠️ 실무적으로 꼭 알아야 할 내용 (Implementation & Operation)<a hidden class=anchor aria-hidden=true href=#-실무적으로-꼭-알아야-할-내용-implementation--operation>#</a></h4><table><thead><tr><th>영역</th><th>내용</th><th>설명</th></tr></thead><tbody><tr><td>✅ Python 기반 ML 실습</td><td>scikit-learn, PyTorch, TensorFlow 등</td><td>모델 학습/테스트/튜닝 실습 역량</td></tr><tr><td>✅ 데이터 파이프라인 구축</td><td>Pandas, SQL, Airflow, Spark</td><td>데이터 수집/가공/저장 자동화 구축</td></tr><tr><td>✅ 모델 배포 실습</td><td>FastAPI, Docker, TorchServe</td><td>RESTful API 기반 실시간 모델 서빙 구현</td></tr><tr><td>✅ 실험 관리 도구 사용</td><td>MLflow, Weights & Biases</td><td>실험/버전 관리, 성능 트래킹 능력 확보</td></tr><tr><td>✅ MLOps 파이프라인 구성</td><td>Kubeflow, SageMaker, Vertex AI 등</td><td>모델 학습/배포/모니터링 자동화 실습</td></tr><tr><td>✅ CI/CD 적용</td><td>GitHub Actions, Jenkins, Docker Compose</td><td>코드/모델의 배포 자동화 및 테스트 연동</td></tr><tr><td>✅ 모니터링 & 알림 시스템</td><td>Prometheus, Grafana, 로그 추적</td><td>모델 드리프트 감지 및 운영 안정성 확보</td></tr><tr><td>✅ API 연동 및 시스템 통합</td><td>모델 결과를 프론트엔드/백엔드와 통합</td><td>실제 제품 서비스에 모델 내장하는 실무 능력</td></tr></tbody></table><blockquote><p>📌 목적: 모델 개발 → 배포 → 운영까지 <strong>엔드 투 엔드로 시스템을 구현하는 역량</strong> 확보</p></blockquote><h4 id=-이론--실무-연결-예시>📐 이론 ↔ 실무 연결 예시<a hidden class=anchor aria-hidden=true href=#-이론--실무-연결-예시>#</a></h4><table><thead><tr><th>이론 요소</th><th>실무 연결</th></tr></thead><tbody><tr><td>MLOps 원리</td><td>Kubeflow + MLflow를 활용한 자동 학습/배포 파이프라인 구성</td></tr><tr><td>모델 서빙 전략</td><td>Dockerized REST API로 모델 서빙 후, API Gateway로 통합</td></tr><tr><td>AI 윤리</td><td>Explainable AI 도구(LIME, SHAP)를 사용해 판단 근거 시각화</td></tr><tr><td>데이터 엔지니어링</td><td>Airflow + Spark로 대용량 데이터 파이프라인 구성</td></tr><tr><td>실험 관리</td><td>W&amp;B를 통해 실험 기록, 비교, 시각화 자동화 적용</td></tr></tbody></table><h3 id=-추천-학습-순서-it-개발자-입장-기준>🧭 추천 학습 순서 (IT 개발자 입장 기준)<a hidden class=anchor aria-hidden=true href=#-추천-학습-순서-it-개발자-입장-기준>#</a></h3><ol><li><p><strong>AI 엔지니어링 개요 및 구성요소 파악</strong><br>(설계 → 개발 → 배포 → 운영 전체 흐름 이해)</p></li><li><p><strong>기초 ML 알고리즘 & Python 기반 모델 구현 학습</strong><br>(scikit-learn → PyTorch 실습 중심)</p></li><li><p><strong>데이터 파이프라인 및 전처리 자동화 학습</strong></p></li><li><p><strong>FastAPI + Docker 기반 모델 서빙 구조 실습</strong></p></li><li><p><strong>MLflow/W&amp;B 등 실험 관리 적용 및 버전 관리</strong></p></li><li><p><strong>MLOps 구성 및 CI/CD 적용</strong></p></li><li><p><strong>모니터링 & 안전성 도입 → AI 시스템 통합 운영</strong></p></li></ol><h3 id=-학습의-궁극적인-목적>🏁 학습의 궁극적인 목적<a hidden class=anchor aria-hidden=true href=#-학습의-궁극적인-목적>#</a></h3><blockquote><p>&ldquo;AI 모델"을 만드는 것을 넘어서,<br>**&ldquo;현실 문제를 해결할 수 있는 완전한 AI 제품을 만들고 운영할 수 있는 개발자&rdquo;**가 되는 것</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/ai/>AI</a></li><li><a href=https://buenhyden.github.io/tags/ai-engineering/>AI-Engineering</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/software-engineering/service-and-application-engineering/api-design-and-implementation/api-integration-patterns/webhooks-vs-polling/polling/types/long-polling/><span class=title>« Prev</span><br><span>Long Polling</span>
</a><a class=next href=https://buenhyden.github.io/posts/data-structures-and-algorithms/problem-solving-techniques/divide-and-conquer/divide-and-conquer-vs-brute-force/><span class=title>Next »</span><br><span>Divide and Conquer vs. Brute Force</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>