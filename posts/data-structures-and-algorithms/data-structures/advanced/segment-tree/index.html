<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Segment Tree | hyunyoun's Blog</title>
<meta name=keywords content="Data-Structures-and-Algorithms,Data-Structures,Tree,Binary-Tree,Segment-Tree"><meta name=description content="세그먼트 트리는 배열의 특정 구간에 대한 정보를 빠르게 구할 수 있도록 설계된 이진 트리 기반의 자료구조"><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/data-structures-and-algorithms/data-structures/advanced/segment-tree/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/data-structures-and-algorithms/data-structures/advanced/segment-tree/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/data-structures-and-algorithms/data-structures/advanced/segment-tree/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Segment Tree"><meta property="og:description" content="세그먼트 트리는 배열의 특정 구간에 대한 정보를 빠르게 구할 수 있도록 설계된 이진 트리 기반의 자료구조"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-10-11T12:56:00+00:00"><meta property="article:modified_time" content="2024-10-11T12:56:00+00:00"><meta property="article:tag" content="Data-Structures-and-Algorithms"><meta property="article:tag" content="Data-Structures"><meta property="article:tag" content="Tree"><meta property="article:tag" content="Binary-Tree"><meta property="article:tag" content="Segment-Tree"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Segment Tree"><meta name=twitter:description content="세그먼트 트리는 배열의 특정 구간에 대한 정보를 빠르게 구할 수 있도록 설계된 이진 트리 기반의 자료구조"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Data Structures and Algorithms","item":"https://buenhyden.github.io/posts/data-structures-and-algorithms/"},{"@type":"ListItem","position":3,"name":"Data Structures","item":"https://buenhyden.github.io/posts/data-structures-and-algorithms/data-structures/"},{"@type":"ListItem","position":4,"name":"Segment Tree","item":"https://buenhyden.github.io/posts/data-structures-and-algorithms/data-structures/advanced/segment-tree/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Segment Tree","name":"Segment Tree","description":"세그먼트 트리는 배열의 특정 구간에 대한 정보를 빠르게 구할 수 있도록 설계된 이진 트리 기반의 자료구조","keywords":["Data-Structures-and-Algorithms","Data-Structures","Tree","Binary-Tree","Segment-Tree"],"articleBody":"Segment Tree 세그먼트 트리는 구간 또는 범위에 대한 정보를 저장하고 관리하는 트리 형태의 자료구조이다. 데이터베이스, 파일 시스템, 네트워크 라우팅 등 다양한 응용 프로그램에서 사용되며, 효율적인 구간 쿼리와 업데이트 연산을 제공하는 특수한 데이터 구조이다.\nhttps://www.geeksforgeeks.org/segment-tree-data-structure/\n특징 완전 이진 트리 구조를 가진다. 각 노드는 배열의 특정 구간에 대한 정보를 저장한다. 리프 노드는 배열의 개별 원소를 나타낸다. 부모 노드는 자식 노드들의 정보를 결합한 값을 저장한다. 장점 구간 쿼리의 시간 복잡도가 O(log n)으로 매우 효율적이다. 데이터 업데이트 시 O(log n) 시간에 트리를 갱신할 수 있다. 동적인 상황에서도 효율적으로 작동한다. 단점 일반 배열에 비해 더 많은 메모리를 사용한다 (약 4n의 공간 복잡도). 구현이 상대적으로 복잡할 수 있다. 응용 데이터베이스 시스템의 범위 쿼리 최적화 컴퓨터 그래픽스의 렌더링 최적화 네트워크 라우팅 테이블 관리 금융 데이터 분석의 구간 통계 계산 동작 원리 트리 구축 (Build):\n배열을 반으로 나누어 재귀적으로 트리를 구성한다. 리프 노드에는 원본 배열의 값을 저장한다. 내부 노드에는 자식 노드들의 정보를 결합한 값을 저장한다. 구간 쿼리 (Query):\n루트에서 시작하여 원하는 구간을 포함하는 노드들을 탐색한다. 구간이 노드의 범위와 일치하면 해당 노드의 값을 반환한다. 부분적으로 겹치는 경우 자식 노드로 이동하여 계산을 계속한다. 업데이트 (Update):\n리프 노드에서 시작하여 값을 변경한다. 변경된 리프 노드부터 루트까지 올라가며 부모 노드들의 값을 재계산한다. 구성 요소 노드: 구간 정보를 저장하는 기본 단위 리프 노드: 원본 배열의 개별 원소를 나타내는 노드 내부 노드: 자식 노드들의 정보를 결합한 값을 저장하는 노드 루트 노드: 전체 배열의 정보를 나타내는 최상위 노드 구현 방식 세그먼트 트리는 주로 배열을 사용하여 구현된다.\n트리의 노드들은 배열의 인덱스로 표현되며, 다음과 같은 관계를 가진다:\n노드 i의 왼쪽 자식: 2i 노드 i의 오른쪽 자식: 2i + 1 노드 i의 부모: i / 2 이러한 구조를 통해 포인터 없이도 효율적으로 트리를 탐색할 수 있다.\n예시 코드 JavaScript:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 class SegmentTree { constructor(arr) { this.n = arr.length; this.tree = new Array(4 * this.n).fill(0); this.build(arr, 1, 0, this.n - 1); } build(arr, v, tl, tr) { if (tl == tr) { this.tree[v] = arr[tl]; } else { let tm = Math.floor((tl + tr) / 2); this.build(arr, v*2, tl, tm); this.build(arr, v*2+1, tm+1, tr); this.tree[v] = this.tree[v*2] + this.tree[v*2+1]; } } sum(v, tl, tr, l, r) { if (l \u003e r) return 0; if (l == tl \u0026\u0026 r == tr) return this.tree[v]; let tm = Math.floor((tl + tr) / 2); return this.sum(v*2, tl, tm, l, Math.min(r, tm)) + this.sum(v*2+1, tm+1, tr, Math.max(l, tm+1), r); } update(v, tl, tr, pos, new_val) { if (tl == tr) { this.tree[v] = new_val; } else { let tm = Math.floor((tl + tr) / 2); if (pos \u003c= tm) this.update(v*2, tl, tm, pos, new_val); else this.update(v*2+1, tm+1, tr, pos, new_val); this.tree[v] = this.tree[v*2] + this.tree[v*2+1]; } } } Python:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 class SegmentTree: def __init__(self, arr): self.n = len(arr) self.tree = [0] * (4 * self.n) self.build(arr, 1, 0, self.n - 1) def build(self, arr, v, tl, tr): if tl == tr: self.tree[v] = arr[tl] else: tm = (tl + tr) // 2 self.build(arr, v*2, tl, tm) self.build(arr, v*2+1, tm+1, tr) self.tree[v] = self.tree[v*2] + self.tree[v*2+1] def sum(self, v, tl, tr, l, r): if l \u003e r: return 0 if l == tl and r == tr: return self.tree[v] tm = (tl + tr) // 2 return (self.sum(v*2, tl, tm, l, min(r, tm)) + self.sum(v*2+1, tm+1, tr, max(l, tm+1), r)) def update(self, v, tl, tr, pos, new_val): if tl == tr: self.tree[v] = new_val else: tm = (tl + tr) // 2 if pos \u003c= tm: self.update(v*2, tl, tm, pos, new_val) else: self.update(v*2+1, tm+1, tr, pos, new_val) self.tree[v] = self.tree[v*2] + self.tree[v*2+1] Java:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 class SegmentTree { int[] tree; int n; SegmentTree(int[] arr) { n = arr.length; tree = new int[4 * n]; build(arr, 1, 0, n - 1); } void build(int[] arr, int v, int tl, int tr) { if (tl == tr) { tree[v] = arr[tl]; } else { int tm = (tl + tr) / 2; build(arr, v*2, tl, tm); build(arr, v*2+1, tm+1, tr); tree[v] = tree[v*2] + tree[v*2+1]; } } int sum(int v, int tl, int tr, int l, int r) { if (l \u003e r) return 0; if (l == tl \u0026\u0026 r == tr) return tree[v]; int tm = (tl + tr) / 2; return sum(v*2, tl, tm, l, Math.min(r, tm)) + sum(v*2+1, tm+1, tr, Math.max(l, tm+1), r); } void update(int v, int tl, int tr, int pos, int new_val) { if (tl == tr) { tree[v] = new_val; } else { int tm = (tl + tr) / 2; if (pos \u003c= tm) update(v*2, tl, tm, pos, new_val); else update(v*2+1, tm+1, tr, pos, new_val); tree[v] = tree[v*2] + tree[v*2+1]; } } } 참고 및 출처 ","wordCount":"861","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2024-10-11T12:56:00Z","dateModified":"2024-10-11T12:56:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/data-structures-and-algorithms/data-structures/advanced/segment-tree/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>posts</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/data-structures-and-algorithms/>Data Structures and Algorithms</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/data-structures-and-algorithms/data-structures/>Data Structures</a></div><h1 class="post-title entry-hint-parent">Segment Tree</h1><div class=post-description>세그먼트 트리는 배열의 특정 구간에 대한 정보를 빠르게 구할 수 있도록 설계된 이진 트리 기반의 자료구조</div><div class=post-meta><span title='2024-10-11 12:56:00 +0000 UTC'>October 11, 2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/Data%20Structures%20and%20Algorithms/Data%20Structures/Advanced/Segment-Tree.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#segment-tree>Segment Tree</a><ul><li><a href=#특징>특징</a></li><li><a href=#장점>장점</a></li><li><a href=#단점>단점</a></li><li><a href=#응용>응용</a></li><li><a href=#동작-원리>동작 원리</a></li><li><a href=#구성-요소>구성 요소</a></li><li><a href=#구현-방식>구현 방식</a></li></ul></li><li><a href=#예시-코드>예시 코드</a></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=segment-tree>Segment Tree<a hidden class=anchor aria-hidden=true href=#segment-tree>#</a></h2><p>세그먼트 트리는 구간 또는 범위에 대한 정보를 저장하고 관리하는 트리 형태의 자료구조이다. 데이터베이스, 파일 시스템, 네트워크 라우팅 등 다양한 응용 프로그램에서 사용되며, 효율적인 구간 쿼리와 업데이트 연산을 제공하는 특수한 데이터 구조이다.<br><figure><img alt="Segment Tree" loading=lazy src=/img/Segment-Tree-(1).webp><figcaption>https://www.geeksforgeeks.org/segment-tree-data-structure/</figcaption></figure></p><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><ol><li>완전 이진 트리 구조를 가진다.</li><li>각 노드는 배열의 특정 구간에 대한 정보를 저장한다.</li><li>리프 노드는 배열의 개별 원소를 나타낸다.</li><li>부모 노드는 자식 노드들의 정보를 결합한 값을 저장한다.</li></ol><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><ol><li>구간 쿼리의 시간 복잡도가 O(log n)으로 매우 효율적이다.</li><li>데이터 업데이트 시 O(log n) 시간에 트리를 갱신할 수 있다.</li><li>동적인 상황에서도 효율적으로 작동한다.</li></ol><h3 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h3><ol><li>일반 배열에 비해 더 많은 메모리를 사용한다 (약 4n의 공간 복잡도).</li><li>구현이 상대적으로 복잡할 수 있다.</li></ol><h3 id=응용>응용<a hidden class=anchor aria-hidden=true href=#응용>#</a></h3><ol><li>데이터베이스 시스템의 범위 쿼리 최적화</li><li>컴퓨터 그래픽스의 렌더링 최적화</li><li>네트워크 라우팅 테이블 관리</li><li>금융 데이터 분석의 구간 통계 계산</li></ol><h3 id=동작-원리>동작 원리<a hidden class=anchor aria-hidden=true href=#동작-원리>#</a></h3><ol><li><p>트리 구축 (Build):</p><ul><li>배열을 반으로 나누어 재귀적으로 트리를 구성한다.</li><li>리프 노드에는 원본 배열의 값을 저장한다.</li><li>내부 노드에는 자식 노드들의 정보를 결합한 값을 저장한다.</li></ul></li><li><p>구간 쿼리 (Query):</p><ul><li>루트에서 시작하여 원하는 구간을 포함하는 노드들을 탐색한다.</li><li>구간이 노드의 범위와 일치하면 해당 노드의 값을 반환한다.</li><li>부분적으로 겹치는 경우 자식 노드로 이동하여 계산을 계속한다.</li></ul></li><li><p>업데이트 (Update):</p><ul><li>리프 노드에서 시작하여 값을 변경한다.</li><li>변경된 리프 노드부터 루트까지 올라가며 부모 노드들의 값을 재계산한다.</li></ul></li></ol><h3 id=구성-요소>구성 요소<a hidden class=anchor aria-hidden=true href=#구성-요소>#</a></h3><ol><li>노드: 구간 정보를 저장하는 기본 단위</li><li>리프 노드: 원본 배열의 개별 원소를 나타내는 노드</li><li>내부 노드: 자식 노드들의 정보를 결합한 값을 저장하는 노드</li><li>루트 노드: 전체 배열의 정보를 나타내는 최상위 노드</li></ol><h3 id=구현-방식>구현 방식<a hidden class=anchor aria-hidden=true href=#구현-방식>#</a></h3><p>세그먼트 트리는 주로 배열을 사용하여 구현된다.<br>트리의 노드들은 배열의 인덱스로 표현되며, 다음과 같은 관계를 가진다:</p><ul><li>노드 i의 왼쪽 자식: 2i</li><li>노드 i의 오른쪽 자식: 2i + 1</li><li>노드 i의 부모: i / 2</li></ul><p>이러한 구조를 통해 포인터 없이도 효율적으로 트리를 탐색할 수 있다.</p><h2 id=예시-코드>예시 코드<a hidden class=anchor aria-hidden=true href=#예시-코드>#</a></h2><ol><li><p>JavaScript:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21>21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22>22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23>23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24>24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25>25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26>26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27>27</a>
</span><span class=lnt id=hl-0-28><a class=lnlinks href=#hl-0-28>28</a>
</span><span class=lnt id=hl-0-29><a class=lnlinks href=#hl-0-29>29</a>
</span><span class=lnt id=hl-0-30><a class=lnlinks href=#hl-0-30>30</a>
</span><span class=lnt id=hl-0-31><a class=lnlinks href=#hl-0-31>31</a>
</span><span class=lnt id=hl-0-32><a class=lnlinks href=#hl-0-32>32</a>
</span><span class=lnt id=hl-0-33><a class=lnlinks href=#hl-0-33>33</a>
</span><span class=lnt id=hl-0-34><a class=lnlinks href=#hl-0-34>34</a>
</span><span class=lnt id=hl-0-35><a class=lnlinks href=#hl-0-35>35</a>
</span><span class=lnt id=hl-0-36><a class=lnlinks href=#hl-0-36>36</a>
</span><span class=lnt id=hl-0-37><a class=lnlinks href=#hl-0-37>37</a>
</span><span class=lnt id=hl-0-38><a class=lnlinks href=#hl-0-38>38</a>
</span><span class=lnt id=hl-0-39><a class=lnlinks href=#hl-0-39>39</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>class</span> <span class=nx>SegmentTree</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>(</span><span class=nx>arr</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>n</span> <span class=o>=</span> <span class=nx>arr</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>tree</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Array</span><span class=p>(</span><span class=mi>4</span> <span class=o>*</span> <span class=k>this</span><span class=p>.</span><span class=nx>n</span><span class=p>).</span><span class=nx>fill</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>build</span><span class=p>(</span><span class=nx>arr</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>build</span><span class=p>(</span><span class=nx>arr</span><span class=p>,</span> <span class=nx>v</span><span class=p>,</span> <span class=nx>tl</span><span class=p>,</span> <span class=nx>tr</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>tl</span> <span class=o>==</span> <span class=nx>tr</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>tree</span><span class=p>[</span><span class=nx>v</span><span class=p>]</span> <span class=o>=</span> <span class=nx>arr</span><span class=p>[</span><span class=nx>tl</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>let</span> <span class=nx>tm</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>((</span><span class=nx>tl</span> <span class=o>+</span> <span class=nx>tr</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>build</span><span class=p>(</span><span class=nx>arr</span><span class=p>,</span> <span class=nx>v</span><span class=o>*</span><span class=mi>2</span><span class=p>,</span> <span class=nx>tl</span><span class=p>,</span> <span class=nx>tm</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>build</span><span class=p>(</span><span class=nx>arr</span><span class=p>,</span> <span class=nx>v</span><span class=o>*</span><span class=mi>2</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=nx>tm</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=nx>tr</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>tree</span><span class=p>[</span><span class=nx>v</span><span class=p>]</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>tree</span><span class=p>[</span><span class=nx>v</span><span class=o>*</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>tree</span><span class=p>[</span><span class=nx>v</span><span class=o>*</span><span class=mi>2</span><span class=o>+</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>sum</span><span class=p>(</span><span class=nx>v</span><span class=p>,</span> <span class=nx>tl</span><span class=p>,</span> <span class=nx>tr</span><span class=p>,</span> <span class=nx>l</span><span class=p>,</span> <span class=nx>r</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>l</span> <span class=o>&gt;</span> <span class=nx>r</span><span class=p>)</span> <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>l</span> <span class=o>==</span> <span class=nx>tl</span> <span class=o>&amp;&amp;</span> <span class=nx>r</span> <span class=o>==</span> <span class=nx>tr</span><span class=p>)</span> <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>tree</span><span class=p>[</span><span class=nx>v</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>tm</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>((</span><span class=nx>tl</span> <span class=o>+</span> <span class=nx>tr</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>sum</span><span class=p>(</span><span class=nx>v</span><span class=o>*</span><span class=mi>2</span><span class=p>,</span> <span class=nx>tl</span><span class=p>,</span> <span class=nx>tm</span><span class=p>,</span> <span class=nx>l</span><span class=p>,</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>min</span><span class=p>(</span><span class=nx>r</span><span class=p>,</span> <span class=nx>tm</span><span class=p>))</span>
</span></span><span class=line><span class=cl>         <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>sum</span><span class=p>(</span><span class=nx>v</span><span class=o>*</span><span class=mi>2</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=nx>tm</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=nx>tr</span><span class=p>,</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>max</span><span class=p>(</span><span class=nx>l</span><span class=p>,</span> <span class=nx>tm</span><span class=o>+</span><span class=mi>1</span><span class=p>),</span> <span class=nx>r</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>update</span><span class=p>(</span><span class=nx>v</span><span class=p>,</span> <span class=nx>tl</span><span class=p>,</span> <span class=nx>tr</span><span class=p>,</span> <span class=nx>pos</span><span class=p>,</span> <span class=nx>new_val</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>tl</span> <span class=o>==</span> <span class=nx>tr</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>tree</span><span class=p>[</span><span class=nx>v</span><span class=p>]</span> <span class=o>=</span> <span class=nx>new_val</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>let</span> <span class=nx>tm</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>((</span><span class=nx>tl</span> <span class=o>+</span> <span class=nx>tr</span><span class=p>)</span> <span class=o>/</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>pos</span> <span class=o>&lt;=</span> <span class=nx>tm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>update</span><span class=p>(</span><span class=nx>v</span><span class=o>*</span><span class=mi>2</span><span class=p>,</span> <span class=nx>tl</span><span class=p>,</span> <span class=nx>tm</span><span class=p>,</span> <span class=nx>pos</span><span class=p>,</span> <span class=nx>new_val</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>update</span><span class=p>(</span><span class=nx>v</span><span class=o>*</span><span class=mi>2</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=nx>tm</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=nx>tr</span><span class=p>,</span> <span class=nx>pos</span><span class=p>,</span> <span class=nx>new_val</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>tree</span><span class=p>[</span><span class=nx>v</span><span class=p>]</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>tree</span><span class=p>[</span><span class=nx>v</span><span class=o>*</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=k>this</span><span class=p>.</span><span class=nx>tree</span><span class=p>[</span><span class=nx>v</span><span class=o>*</span><span class=mi>2</span><span class=o>+</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>Python:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16>16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17>17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18>18</a>
</span><span class=lnt id=hl-1-19><a class=lnlinks href=#hl-1-19>19</a>
</span><span class=lnt id=hl-1-20><a class=lnlinks href=#hl-1-20>20</a>
</span><span class=lnt id=hl-1-21><a class=lnlinks href=#hl-1-21>21</a>
</span><span class=lnt id=hl-1-22><a class=lnlinks href=#hl-1-22>22</a>
</span><span class=lnt id=hl-1-23><a class=lnlinks href=#hl-1-23>23</a>
</span><span class=lnt id=hl-1-24><a class=lnlinks href=#hl-1-24>24</a>
</span><span class=lnt id=hl-1-25><a class=lnlinks href=#hl-1-25>25</a>
</span><span class=lnt id=hl-1-26><a class=lnlinks href=#hl-1-26>26</a>
</span><span class=lnt id=hl-1-27><a class=lnlinks href=#hl-1-27>27</a>
</span><span class=lnt id=hl-1-28><a class=lnlinks href=#hl-1-28>28</a>
</span><span class=lnt id=hl-1-29><a class=lnlinks href=#hl-1-29>29</a>
</span><span class=lnt id=hl-1-30><a class=lnlinks href=#hl-1-30>30</a>
</span><span class=lnt id=hl-1-31><a class=lnlinks href=#hl-1-31>31</a>
</span><span class=lnt id=hl-1-32><a class=lnlinks href=#hl-1-32>32</a>
</span><span class=lnt id=hl-1-33><a class=lnlinks href=#hl-1-33>33</a>
</span><span class=lnt id=hl-1-34><a class=lnlinks href=#hl-1-34>34</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>SegmentTree</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>arr</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>n</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>arr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>tree</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=mi>4</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>build</span><span class=p>(</span><span class=n>arr</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>build</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>arr</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>tl</span><span class=p>,</span> <span class=n>tr</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>tl</span> <span class=o>==</span> <span class=n>tr</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>tree</span><span class=p>[</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>arr</span><span class=p>[</span><span class=n>tl</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tm</span> <span class=o>=</span> <span class=p>(</span><span class=n>tl</span> <span class=o>+</span> <span class=n>tr</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>build</span><span class=p>(</span><span class=n>arr</span><span class=p>,</span> <span class=n>v</span><span class=o>*</span><span class=mi>2</span><span class=p>,</span> <span class=n>tl</span><span class=p>,</span> <span class=n>tm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>build</span><span class=p>(</span><span class=n>arr</span><span class=p>,</span> <span class=n>v</span><span class=o>*</span><span class=mi>2</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=n>tm</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=n>tr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>tree</span><span class=p>[</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tree</span><span class=p>[</span><span class=n>v</span><span class=o>*</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>tree</span><span class=p>[</span><span class=n>v</span><span class=o>*</span><span class=mi>2</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>sum</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>tl</span><span class=p>,</span> <span class=n>tr</span><span class=p>,</span> <span class=n>l</span><span class=p>,</span> <span class=n>r</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>l</span> <span class=o>&gt;</span> <span class=n>r</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>l</span> <span class=o>==</span> <span class=n>tl</span> <span class=ow>and</span> <span class=n>r</span> <span class=o>==</span> <span class=n>tr</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>tree</span><span class=p>[</span><span class=n>v</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>tm</span> <span class=o>=</span> <span class=p>(</span><span class=n>tl</span> <span class=o>+</span> <span class=n>tr</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>v</span><span class=o>*</span><span class=mi>2</span><span class=p>,</span> <span class=n>tl</span><span class=p>,</span> <span class=n>tm</span><span class=p>,</span> <span class=n>l</span><span class=p>,</span> <span class=nb>min</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>tm</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>v</span><span class=o>*</span><span class=mi>2</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=n>tm</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=n>tr</span><span class=p>,</span> <span class=nb>max</span><span class=p>(</span><span class=n>l</span><span class=p>,</span> <span class=n>tm</span><span class=o>+</span><span class=mi>1</span><span class=p>),</span> <span class=n>r</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>update</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>v</span><span class=p>,</span> <span class=n>tl</span><span class=p>,</span> <span class=n>tr</span><span class=p>,</span> <span class=n>pos</span><span class=p>,</span> <span class=n>new_val</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>tl</span> <span class=o>==</span> <span class=n>tr</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>tree</span><span class=p>[</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>new_val</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tm</span> <span class=o>=</span> <span class=p>(</span><span class=n>tl</span> <span class=o>+</span> <span class=n>tr</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>pos</span> <span class=o>&lt;=</span> <span class=n>tm</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>v</span><span class=o>*</span><span class=mi>2</span><span class=p>,</span> <span class=n>tl</span><span class=p>,</span> <span class=n>tm</span><span class=p>,</span> <span class=n>pos</span><span class=p>,</span> <span class=n>new_val</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>v</span><span class=o>*</span><span class=mi>2</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=n>tm</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=n>tr</span><span class=p>,</span> <span class=n>pos</span><span class=p>,</span> <span class=n>new_val</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>tree</span><span class=p>[</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tree</span><span class=p>[</span><span class=n>v</span><span class=o>*</span><span class=mi>2</span><span class=p>]</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>tree</span><span class=p>[</span><span class=n>v</span><span class=o>*</span><span class=mi>2</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>Java:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span><span class=lnt id=hl-2-21><a class=lnlinks href=#hl-2-21>21</a>
</span><span class=lnt id=hl-2-22><a class=lnlinks href=#hl-2-22>22</a>
</span><span class=lnt id=hl-2-23><a class=lnlinks href=#hl-2-23>23</a>
</span><span class=lnt id=hl-2-24><a class=lnlinks href=#hl-2-24>24</a>
</span><span class=lnt id=hl-2-25><a class=lnlinks href=#hl-2-25>25</a>
</span><span class=lnt id=hl-2-26><a class=lnlinks href=#hl-2-26>26</a>
</span><span class=lnt id=hl-2-27><a class=lnlinks href=#hl-2-27>27</a>
</span><span class=lnt id=hl-2-28><a class=lnlinks href=#hl-2-28>28</a>
</span><span class=lnt id=hl-2-29><a class=lnlinks href=#hl-2-29>29</a>
</span><span class=lnt id=hl-2-30><a class=lnlinks href=#hl-2-30>30</a>
</span><span class=lnt id=hl-2-31><a class=lnlinks href=#hl-2-31>31</a>
</span><span class=lnt id=hl-2-32><a class=lnlinks href=#hl-2-32>32</a>
</span><span class=lnt id=hl-2-33><a class=lnlinks href=#hl-2-33>33</a>
</span><span class=lnt id=hl-2-34><a class=lnlinks href=#hl-2-34>34</a>
</span><span class=lnt id=hl-2-35><a class=lnlinks href=#hl-2-35>35</a>
</span><span class=lnt id=hl-2-36><a class=lnlinks href=#hl-2-36>36</a>
</span><span class=lnt id=hl-2-37><a class=lnlinks href=#hl-2-37>37</a>
</span><span class=lnt id=hl-2-38><a class=lnlinks href=#hl-2-38>38</a>
</span><span class=lnt id=hl-2-39><a class=lnlinks href=#hl-2-39>39</a>
</span><span class=lnt id=hl-2-40><a class=lnlinks href=#hl-2-40>40</a>
</span><span class=lnt id=hl-2-41><a class=lnlinks href=#hl-2-41>41</a>
</span><span class=lnt id=hl-2-42><a class=lnlinks href=#hl-2-42>42</a>
</span><span class=lnt id=hl-2-43><a class=lnlinks href=#hl-2-43>43</a>
</span><span class=lnt id=hl-2-44><a class=lnlinks href=#hl-2-44>44</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>class</span> <span class=nc>SegmentTree</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>int</span><span class=o>[]</span><span class=w> </span><span class=n>tree</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>SegmentTree</span><span class=p>(</span><span class=kt>int</span><span class=o>[]</span><span class=w> </span><span class=n>arr</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>arr</span><span class=p>.</span><span class=na>length</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>tree</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=kt>int</span><span class=o>[</span><span class=n>4</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>n</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>build</span><span class=p>(</span><span class=n>arr</span><span class=p>,</span><span class=w> </span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>0</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>build</span><span class=p>(</span><span class=kt>int</span><span class=o>[]</span><span class=w> </span><span class=n>arr</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>v</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>tl</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>tr</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>tl</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>tr</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>tree</span><span class=o>[</span><span class=n>v</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>arr</span><span class=o>[</span><span class=n>tl</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>tm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>tl</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>tr</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>build</span><span class=p>(</span><span class=n>arr</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=o>*</span><span class=n>2</span><span class=p>,</span><span class=w> </span><span class=n>tl</span><span class=p>,</span><span class=w> </span><span class=n>tm</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>build</span><span class=p>(</span><span class=n>arr</span><span class=p>,</span><span class=w> </span><span class=n>v</span><span class=o>*</span><span class=n>2</span><span class=o>+</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>tm</span><span class=o>+</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>tr</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>tree</span><span class=o>[</span><span class=n>v</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tree</span><span class=o>[</span><span class=n>v</span><span class=o>*</span><span class=n>2</span><span class=o>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>tree</span><span class=o>[</span><span class=n>v</span><span class=o>*</span><span class=n>2</span><span class=o>+</span><span class=n>1</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=nf>sum</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>v</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>tl</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>tr</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>l</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>r</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>l</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>r</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>l</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>tl</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>tr</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>tree</span><span class=o>[</span><span class=n>v</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kt>int</span><span class=w> </span><span class=n>tm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>tl</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>tr</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>sum</span><span class=p>(</span><span class=n>v</span><span class=o>*</span><span class=n>2</span><span class=p>,</span><span class=w> </span><span class=n>tl</span><span class=p>,</span><span class=w> </span><span class=n>tm</span><span class=p>,</span><span class=w> </span><span class=n>l</span><span class=p>,</span><span class=w> </span><span class=n>Math</span><span class=p>.</span><span class=na>min</span><span class=p>(</span><span class=n>r</span><span class=p>,</span><span class=w> </span><span class=n>tm</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>             </span><span class=o>+</span><span class=w> </span><span class=n>sum</span><span class=p>(</span><span class=n>v</span><span class=o>*</span><span class=n>2</span><span class=o>+</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>tm</span><span class=o>+</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>tr</span><span class=p>,</span><span class=w> </span><span class=n>Math</span><span class=p>.</span><span class=na>max</span><span class=p>(</span><span class=n>l</span><span class=p>,</span><span class=w> </span><span class=n>tm</span><span class=o>+</span><span class=n>1</span><span class=p>),</span><span class=w> </span><span class=n>r</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>update</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>v</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>tl</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>tr</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>pos</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>new_val</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>tl</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>tr</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>tree</span><span class=o>[</span><span class=n>v</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>new_val</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>tm</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>tl</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>tr</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>pos</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>tm</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>update</span><span class=p>(</span><span class=n>v</span><span class=o>*</span><span class=n>2</span><span class=p>,</span><span class=w> </span><span class=n>tl</span><span class=p>,</span><span class=w> </span><span class=n>tm</span><span class=p>,</span><span class=w> </span><span class=n>pos</span><span class=p>,</span><span class=w> </span><span class=n>new_val</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>else</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>update</span><span class=p>(</span><span class=n>v</span><span class=o>*</span><span class=n>2</span><span class=o>+</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>tm</span><span class=o>+</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>tr</span><span class=p>,</span><span class=w> </span><span class=n>pos</span><span class=p>,</span><span class=w> </span><span class=n>new_val</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>tree</span><span class=o>[</span><span class=n>v</span><span class=o>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tree</span><span class=o>[</span><span class=n>v</span><span class=o>*</span><span class=n>2</span><span class=o>]</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>tree</span><span class=o>[</span><span class=n>v</span><span class=o>*</span><span class=n>2</span><span class=o>+</span><span class=n>1</span><span class=o>]</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ol><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/data-structures-and-algorithms/>Data-Structures-and-Algorithms</a></li><li><a href=https://buenhyden.github.io/tags/data-structures/>Data-Structures</a></li><li><a href=https://buenhyden.github.io/tags/tree/>Tree</a></li><li><a href=https://buenhyden.github.io/tags/binary-tree/>Binary-Tree</a></li><li><a href=https://buenhyden.github.io/tags/segment-tree/>Segment-Tree</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/computer-science/fundamentals/string-search-and-manipulations/data-structures/suffix-array-vs-suffix-tree-vs-trie/><span class=title>« Prev</span><br><span>Suffix Array vs Suffix Tree vs Trie</span>
</a><a class=next href=https://buenhyden.github.io/posts/qa/fundamentals/sdlc/7-maintenance/><span class=title>Next »</span><br><span>7. 유지보수 (Maintenance)</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>