<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Hashing | hyunyoun's Blog</title>
<meta name=keywords content="Computer-Science,Security,Cryptography,Fundamentals,Hashing"><meta name=description content="해싱(Hashing)은 임의의 크기를 가진 데이터를 고정된 크기의 값으로 변환하는 과정이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/security-engineering/cryptography/hashing/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/security-engineering/cryptography/hashing/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/security-engineering/cryptography/hashing/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/security-engineering/cryptography/hashing/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Hashing"><meta property="og:description" content="해싱(Hashing)은 임의의 크기를 가진 데이터를 고정된 크기의 값으로 변환하는 과정이다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Hashing"><meta name=twitter:description content="해싱(Hashing)은 임의의 크기를 가진 데이터를 고정된 크기의 값으로 변환하는 과정이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Hashing","item":"https://buenhyden.github.io/posts/security-engineering/cryptography/hashing/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a></div><h1>Hashing</h1><div class=post-description>해싱(Hashing)은 임의의 크기를 가진 데이터를 고정된 크기의 값으로 변환하는 과정이다.</div></header><div class=post-content><h2 id=hashing>Hashing<a hidden class=anchor aria-hidden=true href=#hashing>#</a></h2><p>해싱(Hashing)은 임의의 크기를 가진 데이터를 고정된 크기의 값으로 변환하는 과정이다.<br>보안 관점에서 해싱은 데이터의 무결성 검증, 비밀번호 저장, 디지털 서명 등 다양한 보안 메커니즘의 핵심 기술로 활용된다.</p><p>해싱은 다음과 같은 과정으로 이루어진다:</p><ol><li>원본 데이터(예: 비밀번호, 파일, 메시지 등)를 입력으로 받는다.</li><li>해시 함수(Hash Function)라는 알고리즘을 통해 처리한다.</li><li>고정된 길이의 해시값(Hash Value) 또는 해시 다이제스트(Hash Digest)를 출력한다.</li></ol><p>이 해시값은 원본 데이터의 디지털 지문(Digital Fingerprint)이라고 볼 수 있으며, 원본 데이터를 유추하기 어렵다는 특성이 있다.</p><h3 id=암호학적-해시-함수의-핵심-특성>암호학적 해시 함수의 핵심 특성<a hidden class=anchor aria-hidden=true href=#암호학적-해시-함수의-핵심-특성>#</a></h3><p>보안에 사용되는 암호학적 해시 함수(Cryptographic Hash Function)는 다음과 같은 중요한 특성을 갖추어야 한다:</p><ol><li><p>일방향성(One-way Function)<br>해시 함수는 일방향 함수여야 한다.<br>즉, 해시값에서 원본 데이터를 계산적으로 복구하는 것이 불가능해야 한다.<br>이 특성은 비밀번호 저장과 같은 보안 응용에서 매우 중요하다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 일방향성 예시 - 비밀번호 해싱</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hash_password</span><span class=p>(</span><span class=n>password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># SHA-256 해시 함수 사용</span>
</span></span><span class=line><span class=cl>    <span class=n>hashed</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>hashed</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용자 비밀번호를 해싱하여 저장</span>
</span></span><span class=line><span class=cl><span class=n>user_password</span> <span class=o>=</span> <span class=s2>&#34;MySecretPassword123&#34;</span>
</span></span><span class=line><span class=cl><span class=n>stored_hash</span> <span class=o>=</span> <span class=n>hash_password</span><span class=p>(</span><span class=n>user_password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;저장된 해시값: </span><span class=si>{</span><span class=n>stored_hash</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 해시값에서 원본 비밀번호를 복구할 수 없음</span>
</span></span><span class=line><span class=cl><span class=c1># 검증은 항상 동일한 해싱 과정을 통해 이루어짐</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>충돌 저항성(Collision Resistance)<br>충돌 저항성은 서로 다른 두 입력이 동일한 해시값을 생성할 가능성이 매우 낮아야 한다는 것을 의미한다.<br>충돌 저항성은 두 가지 유형으로 나뉜다:</p><ol><li><strong>강한 충돌 저항성(Strong Collision Resistance)</strong>: 동일한 해시값을 생성하는 두 개의 서로 다른, 임의의 입력을 찾는 것이 계산적으로 불가능해야 한다.</li><li><strong>약한 충돌 저항성(Weak Collision Resistance)</strong>: 주어진 입력 x에 대해, 동일한 해시값을 생성하는 다른 입력 y를 찾는 것이 계산적으로 불가능해야 한다.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16>16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17>17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18>18</a>
</span><span class=lnt id=hl-1-19><a class=lnlinks href=#hl-1-19>19</a>
</span><span class=lnt id=hl-1-20><a class=lnlinks href=#hl-1-20>20</a>
</span><span class=lnt id=hl-1-21><a class=lnlinks href=#hl-1-21>21</a>
</span><span class=lnt id=hl-1-22><a class=lnlinks href=#hl-1-22>22</a>
</span><span class=lnt id=hl-1-23><a class=lnlinks href=#hl-1-23>23</a>
</span><span class=lnt id=hl-1-24><a class=lnlinks href=#hl-1-24>24</a>
</span><span class=lnt id=hl-1-25><a class=lnlinks href=#hl-1-25>25</a>
</span><span class=lnt id=hl-1-26><a class=lnlinks href=#hl-1-26>26</a>
</span><span class=lnt id=hl-1-27><a class=lnlinks href=#hl-1-27>27</a>
</span><span class=lnt id=hl-1-28><a class=lnlinks href=#hl-1-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 충돌 가능성 예시</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>generate_random_string</span><span class=p>(</span><span class=n>length</span><span class=o>=</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;무작위 문자열 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>letters</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>ascii_lowercase</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>letters</span><span class=p>)</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>length</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 10,000개의 무작위 문자열에 대한 해시값 생성</span>
</span></span><span class=line><span class=cl><span class=n>hash_values</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>collisions</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>total_strings</span> <span class=o>=</span> <span class=mi>10000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>total_strings</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>random_string</span> <span class=o>=</span> <span class=n>generate_random_string</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>hash_value</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>md5</span><span class=p>(</span><span class=n>random_string</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>hash_value</span> <span class=ow>in</span> <span class=n>hash_values</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>collisions</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>hash_values</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>hash_value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;생성된 문자열 수: </span><span class=si>{</span><span class=n>total_strings</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;고유한 해시값 수: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>hash_values</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;충돌 수: </span><span class=si>{</span><span class=n>collisions</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;충돌 확률: </span><span class=si>{</span><span class=n>collisions</span><span class=o>/</span><span class=n>total_strings</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>위의 코드는 MD5 해시 함수에서 충돌이 얼마나 발생하는지 보여주는 예시이다.<br>현대의 보안 응용에서는 MD5가 안전하지 않다고 간주되므로 사용을 피해야 한다.</p></li><li><p>예측 불가능성(Unpredictability)<br>해시 함수는 예측 불가능해야 한다.<br>즉, 입력값이 조금만 변경되어도 출력 해시값이 완전히 달라져야 한다.<br>이러한 특성을 &lsquo;눈사태 효과(Avalanche Effect)&lsquo;라고도 한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span><span class=lnt id=hl-2-21><a class=lnlinks href=#hl-2-21>21</a>
</span><span class=lnt id=hl-2-22><a class=lnlinks href=#hl-2-22>22</a>
</span><span class=lnt id=hl-2-23><a class=lnlinks href=#hl-2-23>23</a>
</span><span class=lnt id=hl-2-24><a class=lnlinks href=#hl-2-24>24</a>
</span><span class=lnt id=hl-2-25><a class=lnlinks href=#hl-2-25>25</a>
</span><span class=lnt id=hl-2-26><a class=lnlinks href=#hl-2-26>26</a>
</span><span class=lnt id=hl-2-27><a class=lnlinks href=#hl-2-27>27</a>
</span><span class=lnt id=hl-2-28><a class=lnlinks href=#hl-2-28>28</a>
</span><span class=lnt id=hl-2-29><a class=lnlinks href=#hl-2-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 눈사태 효과 예시</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>show_avalanche_effect</span><span class=p>(</span><span class=n>text1</span><span class=p>,</span> <span class=n>text2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;두 문자열의 해시값 차이를 비트 단위로 계산&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>hash1</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>text1</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>digest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>hash2</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>text2</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>digest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 바이트 단위로 비교하여 다른 비트 수 계산</span>
</span></span><span class=line><span class=cl>    <span class=n>different_bits</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>b1</span><span class=p>,</span> <span class=n>b2</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>hash1</span><span class=p>,</span> <span class=n>hash2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># XOR 연산으로 다른 비트 확인</span>
</span></span><span class=line><span class=cl>        <span class=n>xor_result</span> <span class=o>=</span> <span class=n>b1</span> <span class=o>^</span> <span class=n>b2</span>
</span></span><span class=line><span class=cl>        <span class=c1># 비트 수 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>different_bits</span> <span class=o>+=</span> <span class=nb>bin</span><span class=p>(</span><span class=n>xor_result</span><span class=p>)</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>total_bits</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>hash1</span><span class=p>)</span> <span class=o>*</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=n>difference_percentage</span> <span class=o>=</span> <span class=p>(</span><span class=n>different_bits</span> <span class=o>/</span> <span class=n>total_bits</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;문자열1: </span><span class=si>{</span><span class=n>text1</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;해시값1: </span><span class=si>{</span><span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>text1</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;문자열2: </span><span class=si>{</span><span class=n>text2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;해시값2: </span><span class=si>{</span><span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>text2</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;총 비트 수: </span><span class=si>{</span><span class=n>total_bits</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;다른 비트 수: </span><span class=si>{</span><span class=n>different_bits</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;차이 비율: </span><span class=si>{</span><span class=n>difference_percentage</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>%&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 한 글자만 다른 두 문자열 비교</span>
</span></span><span class=line><span class=cl><span class=n>show_avalanche_effect</span><span class=p>(</span><span class=s2>&#34;Hello, World!&#34;</span><span class=p>,</span> <span class=s2>&#34;Hello, World.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>위 코드는 입력값이 조금만 변경되어도(마지막 문자가 &lsquo;!&lsquo;에서 &lsquo;.&lsquo;로) 해시값이 크게 변경됨을 보여준다.</p></li></ol><h3 id=주요-암호학적-해시-알고리즘>주요 암호학적 해시 알고리즘<a hidden class=anchor aria-hidden=true href=#주요-암호학적-해시-알고리즘>#</a></h3><p>보안에 사용되는 주요 해시 알고리즘을 살펴보면:</p><h4 id=md5-message-digest-algorithm-5>MD5 (Message Digest Algorithm 5)<a hidden class=anchor aria-hidden=true href=#md5-message-digest-algorithm-5>#</a></h4><p>MD5는 128비트(16바이트) 해시값을 생성하는 알고리즘으로, 한때 널리 사용되었지만 현재는 보안상의 취약점이 발견되어 보안 목적으로는 사용하지 않는 것이 좋다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4>4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=s2>&#34;안녕하세요, 이것은 MD5 해시 예제입니다.&#34;</span>
</span></span><span class=line><span class=cl><span class=n>md5_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>md5</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;MD5 해시: </span><span class=si>{</span><span class=n>md5_hash</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=sha-1-secure-hash-algorithm-1>SHA-1 (Secure Hash Algorithm 1)<a hidden class=anchor aria-hidden=true href=#sha-1-secure-hash-algorithm-1>#</a></h4><p>SHA-1은 160비트(20바이트) 해시값을 생성하는 알고리즘이다.<br>MD5와 마찬가지로 취약점이 발견되어 보안 목적으로는 권장되지 않는다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2>2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3>3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4>4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=s2>&#34;안녕하세요, 이것은 SHA-1 해시 예제입니다.&#34;</span>
</span></span><span class=line><span class=cl><span class=n>sha1_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha1</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;SHA-1 해시: </span><span class=si>{</span><span class=n>sha1_hash</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=sha-2-계열-sha-256-sha-384-sha-512>SHA-2 계열 (SHA-256, SHA-384, SHA-512)<a hidden class=anchor aria-hidden=true href=#sha-2-계열-sha-256-sha-384-sha-512>#</a></h4><p>SHA-2는 여러 변형이 있으며, 그 중 SHA-256(32바이트), SHA-384(48바이트), SHA-512(64바이트)가 널리 사용된다.<br>현재 많은 보안 응용 프로그램에서 표준으로 사용되고 있다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=s2>&#34;안녕하세요, 이것은 SHA-256 해시 예제입니다.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SHA-256 (32바이트, 64자 16진수)</span>
</span></span><span class=line><span class=cl><span class=n>sha256_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;SHA-256 해시: </span><span class=si>{</span><span class=n>sha256_hash</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SHA-384 (48바이트, 96자 16진수)</span>
</span></span><span class=line><span class=cl><span class=n>sha384_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha384</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;SHA-384 해시: </span><span class=si>{</span><span class=n>sha384_hash</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SHA-512 (64바이트, 128자 16진수)</span>
</span></span><span class=line><span class=cl><span class=n>sha512_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha512</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;SHA-512 해시: </span><span class=si>{</span><span class=n>sha512_hash</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=sha-3-계열>SHA-3 계열<a hidden class=anchor aria-hidden=true href=#sha-3-계열>#</a></h4><p>SHA-3는 SHA-2의 후속으로 개발된 해시 알고리즘 가족으로, 이전 SHA 알고리즘과는 완전히 다른 내부 구조를 가지고 있어 같은 취약점의 영향을 받지 않는다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=s2>&#34;안녕하세요, 이것은 SHA-3 해시 예제입니다.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SHA3-256</span>
</span></span><span class=line><span class=cl><span class=n>sha3_256_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha3_256</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;SHA3-256 해시: </span><span class=si>{</span><span class=n>sha3_256_hash</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SHA3-512</span>
</span></span><span class=line><span class=cl><span class=n>sha3_512_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha3_512</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;SHA3-512 해시: </span><span class=si>{</span><span class=n>sha3_512_hash</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=blake2>BLAKE2<a hidden class=anchor aria-hidden=true href=#blake2>#</a></h4><p>BLAKE2는 속도와 보안을 모두 고려한 현대적인 해시 알고리즘으로, 다양한 크기의 출력을 지원한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=s2>&#34;안녕하세요, 이것은 BLAKE2 해시 예제입니다.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># BLAKE2b (64바이트)</span>
</span></span><span class=line><span class=cl><span class=n>blake2b_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>blake2b</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;BLAKE2b 해시: </span><span class=si>{</span><span class=n>blake2b_hash</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># BLAKE2s (32바이트)</span>
</span></span><span class=line><span class=cl><span class=n>blake2s_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>blake2s</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;BLAKE2s 해시: </span><span class=si>{</span><span class=n>blake2s_hash</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=보안-응용에서의-해싱>보안 응용에서의 해싱<a hidden class=anchor aria-hidden=true href=#보안-응용에서의-해싱>#</a></h3><p>해싱은 다양한 보안 분야에서 활용된다:</p><h4 id=비밀번호-저장>비밀번호 저장<a hidden class=anchor aria-hidden=true href=#비밀번호-저장>#</a></h4><p>안전한 비밀번호 저장을 위해서는 단순 해싱이 아닌, 솔트(Salt)와 키 스트레칭(Key Stretching)을 조합한 방법을 사용한다.</p><h5 id=솔트salt>솔트(Salt)<a hidden class=anchor aria-hidden=true href=#솔트salt>#</a></h5><p>솔트는 해시 전에 비밀번호에 추가되는 무작위 값으로, 동일한 비밀번호라도 다른 해시값을 갖게 하여 레인보우 테이블 공격 등을 방지한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1> 1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2> 2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3> 3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4> 4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5> 5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6> 6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7> 7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8> 8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9> 9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10>10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11>11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12>12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13>13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14>14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15>15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16>16</a>
</span><span class=lnt id=hl-8-17><a class=lnlinks href=#hl-8-17>17</a>
</span><span class=lnt id=hl-8-18><a class=lnlinks href=#hl-8-18>18</a>
</span><span class=lnt id=hl-8-19><a class=lnlinks href=#hl-8-19>19</a>
</span><span class=lnt id=hl-8-20><a class=lnlinks href=#hl-8-20>20</a>
</span><span class=lnt id=hl-8-21><a class=lnlinks href=#hl-8-21>21</a>
</span><span class=lnt id=hl-8-22><a class=lnlinks href=#hl-8-22>22</a>
</span><span class=lnt id=hl-8-23><a class=lnlinks href=#hl-8-23>23</a>
</span><span class=lnt id=hl-8-24><a class=lnlinks href=#hl-8-24>24</a>
</span><span class=lnt id=hl-8-25><a class=lnlinks href=#hl-8-25>25</a>
</span><span class=lnt id=hl-8-26><a class=lnlinks href=#hl-8-26>26</a>
</span><span class=lnt id=hl-8-27><a class=lnlinks href=#hl-8-27>27</a>
</span><span class=lnt id=hl-8-28><a class=lnlinks href=#hl-8-28>28</a>
</span><span class=lnt id=hl-8-29><a class=lnlinks href=#hl-8-29>29</a>
</span><span class=lnt id=hl-8-30><a class=lnlinks href=#hl-8-30>30</a>
</span><span class=lnt id=hl-8-31><a class=lnlinks href=#hl-8-31>31</a>
</span><span class=lnt id=hl-8-32><a class=lnlinks href=#hl-8-32>32</a>
</span><span class=lnt id=hl-8-33><a class=lnlinks href=#hl-8-33>33</a>
</span><span class=lnt id=hl-8-34><a class=lnlinks href=#hl-8-34>34</a>
</span><span class=lnt id=hl-8-35><a class=lnlinks href=#hl-8-35>35</a>
</span><span class=lnt id=hl-8-36><a class=lnlinks href=#hl-8-36>36</a>
</span><span class=lnt id=hl-8-37><a class=lnlinks href=#hl-8-37>37</a>
</span><span class=lnt id=hl-8-38><a class=lnlinks href=#hl-8-38>38</a>
</span><span class=lnt id=hl-8-39><a class=lnlinks href=#hl-8-39>39</a>
</span><span class=lnt id=hl-8-40><a class=lnlinks href=#hl-8-40>40</a>
</span><span class=lnt id=hl-8-41><a class=lnlinks href=#hl-8-41>41</a>
</span><span class=lnt id=hl-8-42><a class=lnlinks href=#hl-8-42>42</a>
</span><span class=lnt id=hl-8-43><a class=lnlinks href=#hl-8-43>43</a>
</span><span class=lnt id=hl-8-44><a class=lnlinks href=#hl-8-44>44</a>
</span><span class=lnt id=hl-8-45><a class=lnlinks href=#hl-8-45>45</a>
</span><span class=lnt id=hl-8-46><a class=lnlinks href=#hl-8-46>46</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hash_password_with_salt</span><span class=p>(</span><span class=n>password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 16바이트(128비트) 무작위 솔트 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>salt</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 비밀번호와 솔트 결합 후 해싱</span>
</span></span><span class=line><span class=cl>    <span class=n>password_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>pbkdf2_hmac</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;sha256&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=n>salt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>100000</span>  <span class=c1># 반복 횟수</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 솔트와 해시를 함께 저장 (나중에 검증 시 필요)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>salt</span> <span class=o>+</span> <span class=n>password_hash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify_password</span><span class=p>(</span><span class=n>stored_password_hash</span><span class=p>,</span> <span class=n>password_to_check</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 저장된 해시에서 솔트 추출 (처음 16바이트)</span>
</span></span><span class=line><span class=cl>    <span class=n>salt</span> <span class=o>=</span> <span class=n>stored_password_hash</span><span class=p>[:</span><span class=mi>16</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>stored_hash</span> <span class=o>=</span> <span class=n>stored_password_hash</span><span class=p>[</span><span class=mi>16</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 입력된 비밀번호를 동일한 방식으로 해싱</span>
</span></span><span class=line><span class=cl>    <span class=n>password_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>pbkdf2_hmac</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;sha256&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>password_to_check</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=n>salt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=mi>100000</span>  <span class=c1># 원래 해싱과 동일한 반복 횟수</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 저장된 해시와 계산된 해시 비교</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>stored_hash</span> <span class=o>==</span> <span class=n>password_hash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>user_password</span> <span class=o>=</span> <span class=s2>&#34;MySecurePassword123&#34;</span>
</span></span><span class=line><span class=cl><span class=n>stored_hash</span> <span class=o>=</span> <span class=n>hash_password_with_salt</span><span class=p>(</span><span class=n>user_password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;저장된 해시 (솔트 + 해시): </span><span class=si>{</span><span class=n>stored_hash</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 올바른 비밀번호 검증</span>
</span></span><span class=line><span class=cl><span class=n>is_valid</span> <span class=o>=</span> <span class=n>verify_password</span><span class=p>(</span><span class=n>stored_hash</span><span class=p>,</span> <span class=n>user_password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;비밀번호 검증 결과 (올바른 비밀번호): </span><span class=si>{</span><span class=n>is_valid</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 잘못된 비밀번호 검증</span>
</span></span><span class=line><span class=cl><span class=n>is_valid</span> <span class=o>=</span> <span class=n>verify_password</span><span class=p>(</span><span class=n>stored_hash</span><span class=p>,</span> <span class=s2>&#34;WrongPassword123&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;비밀번호 검증 결과 (잘못된 비밀번호): </span><span class=si>{</span><span class=n>is_valid</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=키-스트레칭key-stretching>키 스트레칭(Key Stretching)<a hidden class=anchor aria-hidden=true href=#키-스트레칭key-stretching>#</a></h5><p>키 스트레칭은 해시 함수를 여러 번 반복 적용하여 해싱 과정을 의도적으로 느리게 만드는 기법으로, 무차별 대입 공격(Brute Force Attack)을 어렵게 만든다.<br>PBKDF2, bcrypt, Argon2와 같은 알고리즘이 대표적이다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11>11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12>12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13>13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14>14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15>15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16>16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17>17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18>18</a>
</span><span class=lnt id=hl-9-19><a class=lnlinks href=#hl-9-19>19</a>
</span><span class=lnt id=hl-9-20><a class=lnlinks href=#hl-9-20>20</a>
</span><span class=lnt id=hl-9-21><a class=lnlinks href=#hl-9-21>21</a>
</span><span class=lnt id=hl-9-22><a class=lnlinks href=#hl-9-22>22</a>
</span><span class=lnt id=hl-9-23><a class=lnlinks href=#hl-9-23>23</a>
</span><span class=lnt id=hl-9-24><a class=lnlinks href=#hl-9-24>24</a>
</span><span class=lnt id=hl-9-25><a class=lnlinks href=#hl-9-25>25</a>
</span><span class=lnt id=hl-9-26><a class=lnlinks href=#hl-9-26>26</a>
</span><span class=lnt id=hl-9-27><a class=lnlinks href=#hl-9-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>benchmark_key_stretching</span><span class=p>(</span><span class=n>password</span><span class=p>,</span> <span class=n>iterations_list</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;다양한 반복 횟수에 따른 해싱 시간 측정&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>salt</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>iterations</span> <span class=ow>in</span> <span class=n>iterations_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>hashlib</span><span class=o>.</span><span class=n>pbkdf2_hmac</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;sha256&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>salt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>iterations</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>end_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>elapsed</span> <span class=o>=</span> <span class=n>end_time</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;반복 횟수 </span><span class=si>{</span><span class=n>iterations</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>elapsed</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>초 소요&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 다양한 반복 횟수로 성능 측정</span>
</span></span><span class=line><span class=cl><span class=n>password</span> <span class=o>=</span> <span class=s2>&#34;test_password&#34;</span>
</span></span><span class=line><span class=cl><span class=n>iterations</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=mi>10000</span><span class=p>,</span> <span class=mi>100000</span><span class=p>,</span> <span class=mi>500000</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>benchmark_key_stretching</span><span class=p>(</span><span class=n>password</span><span class=p>,</span> <span class=n>iterations</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>위 코드는 다양한 반복 횟수에 따른 해싱 시간을 측정한다.<br>반복 횟수를 늘릴수록 해싱 시간이 선형적으로 증가하며, 이는 공격자의 무차별 대입 공격을 그만큼 어렵게 만든다.</p><h5 id=현대적인-비밀번호-해싱-알고리즘>현대적인 비밀번호 해싱 알고리즘<a hidden class=anchor aria-hidden=true href=#현대적인-비밀번호-해싱-알고리즘>#</a></h5><p>현대적인 비밀번호 저장을 위해서는 PBKDF2, bcrypt, scrypt, Argon2와 같은 전문 알고리즘을 사용하는 것이 권장된다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span><span class=lnt id=hl-10-16><a class=lnlinks href=#hl-10-16>16</a>
</span><span class=lnt id=hl-10-17><a class=lnlinks href=#hl-10-17>17</a>
</span><span class=lnt id=hl-10-18><a class=lnlinks href=#hl-10-18>18</a>
</span><span class=lnt id=hl-10-19><a class=lnlinks href=#hl-10-19>19</a>
</span><span class=lnt id=hl-10-20><a class=lnlinks href=#hl-10-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># bcrypt 예시 (설치 필요: pip install bcrypt)</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>bcrypt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hash_password_bcrypt</span><span class=p>(</span><span class=n>password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># bcrypt는 내부적으로 솔트를 생성하고 관리</span>
</span></span><span class=line><span class=cl>    <span class=n>password_hash</span> <span class=o>=</span> <span class=n>bcrypt</span><span class=o>.</span><span class=n>hashpw</span><span class=p>(</span><span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>bcrypt</span><span class=o>.</span><span class=n>gensalt</span><span class=p>(</span><span class=n>rounds</span><span class=o>=</span><span class=mi>12</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>password_hash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify_password_bcrypt</span><span class=p>(</span><span class=n>stored_hash</span><span class=p>,</span> <span class=n>password_to_check</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># bcrypt는 내부적으로 솔트를 추출하고 검증</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>bcrypt</span><span class=o>.</span><span class=n>checkpw</span><span class=p>(</span><span class=n>password_to_check</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>stored_hash</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>user_password</span> <span class=o>=</span> <span class=s2>&#34;MySecurePassword123&#34;</span>
</span></span><span class=line><span class=cl><span class=n>hashed</span> <span class=o>=</span> <span class=n>hash_password_bcrypt</span><span class=p>(</span><span class=n>user_password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;bcrypt 해시: </span><span class=si>{</span><span class=n>hashed</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 검증</span>
</span></span><span class=line><span class=cl><span class=n>is_valid</span> <span class=o>=</span> <span class=n>verify_password_bcrypt</span><span class=p>(</span><span class=n>hashed</span><span class=p>,</span> <span class=n>user_password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;비밀번호 검증 결과: </span><span class=si>{</span><span class=n>is_valid</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=데이터-무결성-검증>데이터 무결성 검증<a hidden class=anchor aria-hidden=true href=#데이터-무결성-검증>#</a></h4><p>해싱은 파일이나 메시지가 변조되지 않았는지 확인하는 데 사용된다.<br>원본 데이터의 해시값을 계산하여 저장해두고, 나중에 동일한 해시값이 생성되는지 확인하는 방식이다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15>15</a>
</span><span class=lnt id=hl-11-16><a class=lnlinks href=#hl-11-16>16</a>
</span><span class=lnt id=hl-11-17><a class=lnlinks href=#hl-11-17>17</a>
</span><span class=lnt id=hl-11-18><a class=lnlinks href=#hl-11-18>18</a>
</span><span class=lnt id=hl-11-19><a class=lnlinks href=#hl-11-19>19</a>
</span><span class=lnt id=hl-11-20><a class=lnlinks href=#hl-11-20>20</a>
</span><span class=lnt id=hl-11-21><a class=lnlinks href=#hl-11-21>21</a>
</span><span class=lnt id=hl-11-22><a class=lnlinks href=#hl-11-22>22</a>
</span><span class=lnt id=hl-11-23><a class=lnlinks href=#hl-11-23>23</a>
</span><span class=lnt id=hl-11-24><a class=lnlinks href=#hl-11-24>24</a>
</span><span class=lnt id=hl-11-25><a class=lnlinks href=#hl-11-25>25</a>
</span><span class=lnt id=hl-11-26><a class=lnlinks href=#hl-11-26>26</a>
</span><span class=lnt id=hl-11-27><a class=lnlinks href=#hl-11-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>calculate_file_hash</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=n>algorithm</span><span class=o>=</span><span class=s1>&#39;sha256&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;파일의 해시값 계산&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>hash_obj</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>algorithm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 메모리 효율성을 위해 청크 단위로 읽기</span>
</span></span><span class=line><span class=cl>        <span class=n>chunk</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>4096</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>chunk</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>hash_obj</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>chunk</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>4096</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>hash_obj</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify_file_integrity</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=n>expected_hash</span><span class=p>,</span> <span class=n>algorithm</span><span class=o>=</span><span class=s1>&#39;sha256&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;파일의 무결성 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>calculated_hash</span> <span class=o>=</span> <span class=n>calculate_file_hash</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span> <span class=n>algorithm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>calculated_hash</span> <span class=o>==</span> <span class=n>expected_hash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시 (파일이 있다고 가정)</span>
</span></span><span class=line><span class=cl><span class=c1># file_hash = calculate_file_hash(&#39;example.txt&#39;)</span>
</span></span><span class=line><span class=cl><span class=c1># print(f&#34;파일 해시: {file_hash}&#34;)</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># # 나중에 파일 무결성 검증</span>
</span></span><span class=line><span class=cl><span class=c1># is_valid = verify_file_integrity(&#39;example.txt&#39;, file_hash)</span>
</span></span><span class=line><span class=cl><span class=c1># print(f&#34;파일 무결성: {is_valid}&#34;)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=디지털-서명>디지털 서명<a hidden class=anchor aria-hidden=true href=#디지털-서명>#</a></h4><p>해시 함수는 디지털 서명 과정에서 중요한 역할을 한다.<br>전체 메시지가 아닌 메시지의 해시값에 서명함으로써 효율성을 높인다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1> 1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2> 2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3> 3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4> 4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5> 5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6> 6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7> 7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8> 8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9> 9</a>
</span><span class=lnt id=hl-12-10><a class=lnlinks href=#hl-12-10>10</a>
</span><span class=lnt id=hl-12-11><a class=lnlinks href=#hl-12-11>11</a>
</span><span class=lnt id=hl-12-12><a class=lnlinks href=#hl-12-12>12</a>
</span><span class=lnt id=hl-12-13><a class=lnlinks href=#hl-12-13>13</a>
</span><span class=lnt id=hl-12-14><a class=lnlinks href=#hl-12-14>14</a>
</span><span class=lnt id=hl-12-15><a class=lnlinks href=#hl-12-15>15</a>
</span><span class=lnt id=hl-12-16><a class=lnlinks href=#hl-12-16>16</a>
</span><span class=lnt id=hl-12-17><a class=lnlinks href=#hl-12-17>17</a>
</span><span class=lnt id=hl-12-18><a class=lnlinks href=#hl-12-18>18</a>
</span><span class=lnt id=hl-12-19><a class=lnlinks href=#hl-12-19>19</a>
</span><span class=lnt id=hl-12-20><a class=lnlinks href=#hl-12-20>20</a>
</span><span class=lnt id=hl-12-21><a class=lnlinks href=#hl-12-21>21</a>
</span><span class=lnt id=hl-12-22><a class=lnlinks href=#hl-12-22>22</a>
</span><span class=lnt id=hl-12-23><a class=lnlinks href=#hl-12-23>23</a>
</span><span class=lnt id=hl-12-24><a class=lnlinks href=#hl-12-24>24</a>
</span><span class=lnt id=hl-12-25><a class=lnlinks href=#hl-12-25>25</a>
</span><span class=lnt id=hl-12-26><a class=lnlinks href=#hl-12-26>26</a>
</span><span class=lnt id=hl-12-27><a class=lnlinks href=#hl-12-27>27</a>
</span><span class=lnt id=hl-12-28><a class=lnlinks href=#hl-12-28>28</a>
</span><span class=lnt id=hl-12-29><a class=lnlinks href=#hl-12-29>29</a>
</span><span class=lnt id=hl-12-30><a class=lnlinks href=#hl-12-30>30</a>
</span><span class=lnt id=hl-12-31><a class=lnlinks href=#hl-12-31>31</a>
</span><span class=lnt id=hl-12-32><a class=lnlinks href=#hl-12-32>32</a>
</span><span class=lnt id=hl-12-33><a class=lnlinks href=#hl-12-33>33</a>
</span><span class=lnt id=hl-12-34><a class=lnlinks href=#hl-12-34>34</a>
</span><span class=lnt id=hl-12-35><a class=lnlinks href=#hl-12-35>35</a>
</span><span class=lnt id=hl-12-36><a class=lnlinks href=#hl-12-36>36</a>
</span><span class=lnt id=hl-12-37><a class=lnlinks href=#hl-12-37>37</a>
</span><span class=lnt id=hl-12-38><a class=lnlinks href=#hl-12-38>38</a>
</span><span class=lnt id=hl-12-39><a class=lnlinks href=#hl-12-39>39</a>
</span><span class=lnt id=hl-12-40><a class=lnlinks href=#hl-12-40>40</a>
</span><span class=lnt id=hl-12-41><a class=lnlinks href=#hl-12-41>41</a>
</span><span class=lnt id=hl-12-42><a class=lnlinks href=#hl-12-42>42</a>
</span><span class=lnt id=hl-12-43><a class=lnlinks href=#hl-12-43>43</a>
</span><span class=lnt id=hl-12-44><a class=lnlinks href=#hl-12-44>44</a>
</span><span class=lnt id=hl-12-45><a class=lnlinks href=#hl-12-45>45</a>
</span><span class=lnt id=hl-12-46><a class=lnlinks href=#hl-12-46>46</a>
</span><span class=lnt id=hl-12-47><a class=lnlinks href=#hl-12-47>47</a>
</span><span class=lnt id=hl-12-48><a class=lnlinks href=#hl-12-48>48</a>
</span><span class=lnt id=hl-12-49><a class=lnlinks href=#hl-12-49>49</a>
</span><span class=lnt id=hl-12-50><a class=lnlinks href=#hl-12-50>50</a>
</span><span class=lnt id=hl-12-51><a class=lnlinks href=#hl-12-51>51</a>
</span><span class=lnt id=hl-12-52><a class=lnlinks href=#hl-12-52>52</a>
</span><span class=lnt id=hl-12-53><a class=lnlinks href=#hl-12-53>53</a>
</span><span class=lnt id=hl-12-54><a class=lnlinks href=#hl-12-54>54</a>
</span><span class=lnt id=hl-12-55><a class=lnlinks href=#hl-12-55>55</a>
</span><span class=lnt id=hl-12-56><a class=lnlinks href=#hl-12-56>56</a>
</span><span class=lnt id=hl-12-57><a class=lnlinks href=#hl-12-57>57</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>cryptography.hazmat.primitives</span> <span class=kn>import</span> <span class=n>hashes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>cryptography.hazmat.primitives.asymmetric</span> <span class=kn>import</span> <span class=n>padding</span><span class=p>,</span> <span class=n>rsa</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>cryptography.exceptions</span> <span class=kn>import</span> <span class=n>InvalidSignature</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>generate_keys</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;RSA 키 쌍 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>private_key</span> <span class=o>=</span> <span class=n>rsa</span><span class=o>.</span><span class=n>generate_private_key</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>public_exponent</span><span class=o>=</span><span class=mi>65537</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>key_size</span><span class=o>=</span><span class=mi>2048</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>public_key</span> <span class=o>=</span> <span class=n>private_key</span><span class=o>.</span><span class=n>public_key</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>private_key</span><span class=p>,</span> <span class=n>public_key</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>sign_message</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=n>private_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;메시지에 디지털 서명&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>signature</span> <span class=o>=</span> <span class=n>private_key</span><span class=o>.</span><span class=n>sign</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>message</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=n>padding</span><span class=o>.</span><span class=n>PSS</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>mgf</span><span class=o>=</span><span class=n>padding</span><span class=o>.</span><span class=n>MGF1</span><span class=p>(</span><span class=n>hashes</span><span class=o>.</span><span class=n>SHA256</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>            <span class=n>salt_length</span><span class=o>=</span><span class=n>padding</span><span class=o>.</span><span class=n>PSS</span><span class=o>.</span><span class=n>MAX_LENGTH</span>
</span></span><span class=line><span class=cl>        <span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>hashes</span><span class=o>.</span><span class=n>SHA256</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>signature</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify_signature</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=n>signature</span><span class=p>,</span> <span class=n>public_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;디지털 서명 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>public_key</span><span class=o>.</span><span class=n>verify</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>signature</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>message</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>padding</span><span class=o>.</span><span class=n>PSS</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>mgf</span><span class=o>=</span><span class=n>padding</span><span class=o>.</span><span class=n>MGF1</span><span class=p>(</span><span class=n>hashes</span><span class=o>.</span><span class=n>SHA256</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>                <span class=n>salt_length</span><span class=o>=</span><span class=n>padding</span><span class=o>.</span><span class=n>PSS</span><span class=o>.</span><span class=n>MAX_LENGTH</span>
</span></span><span class=line><span class=cl>            <span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>hashes</span><span class=o>.</span><span class=n>SHA256</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>InvalidSignature</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>private_key</span><span class=p>,</span> <span class=n>public_key</span> <span class=o>=</span> <span class=n>generate_keys</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메시지에 서명</span>
</span></span><span class=line><span class=cl><span class=n>message</span> <span class=o>=</span> <span class=s2>&#34;중요한 메시지입니다. 이 메시지는 변조되지 않아야 합니다.&#34;</span>
</span></span><span class=line><span class=cl><span class=n>signature</span> <span class=o>=</span> <span class=n>sign_message</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=n>private_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;서명: </span><span class=si>{</span><span class=n>signature</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 서명 검증</span>
</span></span><span class=line><span class=cl><span class=n>is_valid</span> <span class=o>=</span> <span class=n>verify_signature</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=n>signature</span><span class=p>,</span> <span class=n>public_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;서명 검증 결과: </span><span class=si>{</span><span class=n>is_valid</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 변조된 메시지 검증</span>
</span></span><span class=line><span class=cl><span class=n>tampered_message</span> <span class=o>=</span> <span class=s2>&#34;변조된 메시지입니다. 이 메시지는 검증에 실패해야 합니다.&#34;</span>
</span></span><span class=line><span class=cl><span class=n>is_valid</span> <span class=o>=</span> <span class=n>verify_signature</span><span class=p>(</span><span class=n>tampered_message</span><span class=p>,</span> <span class=n>signature</span><span class=p>,</span> <span class=n>public_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;변조된 메시지 검증 결과: </span><span class=si>{</span><span class=n>is_valid</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=44-hmac-hash-based-message-authentication-code>4.4. HMAC (Hash-based Message Authentication Code)<a hidden class=anchor aria-hidden=true href=#44-hmac-hash-based-message-authentication-code>#</a></h4><p>HMAC은 메시지 인증에 사용되는 기법으로, 비밀 키와 해시 함수를 조합하여 메시지의 무결성과 출처를 동시에 검증한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1> 1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2> 2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3> 3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4> 4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5> 5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6> 6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7> 7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8> 8</a>
</span><span class=lnt id=hl-13-9><a class=lnlinks href=#hl-13-9> 9</a>
</span><span class=lnt id=hl-13-10><a class=lnlinks href=#hl-13-10>10</a>
</span><span class=lnt id=hl-13-11><a class=lnlinks href=#hl-13-11>11</a>
</span><span class=lnt id=hl-13-12><a class=lnlinks href=#hl-13-12>12</a>
</span><span class=lnt id=hl-13-13><a class=lnlinks href=#hl-13-13>13</a>
</span><span class=lnt id=hl-13-14><a class=lnlinks href=#hl-13-14>14</a>
</span><span class=lnt id=hl-13-15><a class=lnlinks href=#hl-13-15>15</a>
</span><span class=lnt id=hl-13-16><a class=lnlinks href=#hl-13-16>16</a>
</span><span class=lnt id=hl-13-17><a class=lnlinks href=#hl-13-17>17</a>
</span><span class=lnt id=hl-13-18><a class=lnlinks href=#hl-13-18>18</a>
</span><span class=lnt id=hl-13-19><a class=lnlinks href=#hl-13-19>19</a>
</span><span class=lnt id=hl-13-20><a class=lnlinks href=#hl-13-20>20</a>
</span><span class=lnt id=hl-13-21><a class=lnlinks href=#hl-13-21>21</a>
</span><span class=lnt id=hl-13-22><a class=lnlinks href=#hl-13-22>22</a>
</span><span class=lnt id=hl-13-23><a class=lnlinks href=#hl-13-23>23</a>
</span><span class=lnt id=hl-13-24><a class=lnlinks href=#hl-13-24>24</a>
</span><span class=lnt id=hl-13-25><a class=lnlinks href=#hl-13-25>25</a>
</span><span class=lnt id=hl-13-26><a class=lnlinks href=#hl-13-26>26</a>
</span><span class=lnt id=hl-13-27><a class=lnlinks href=#hl-13-27>27</a>
</span><span class=lnt id=hl-13-28><a class=lnlinks href=#hl-13-28>28</a>
</span><span class=lnt id=hl-13-29><a class=lnlinks href=#hl-13-29>29</a>
</span><span class=lnt id=hl-13-30><a class=lnlinks href=#hl-13-30>30</a>
</span><span class=lnt id=hl-13-31><a class=lnlinks href=#hl-13-31>31</a>
</span><span class=lnt id=hl-13-32><a class=lnlinks href=#hl-13-32>32</a>
</span><span class=lnt id=hl-13-33><a class=lnlinks href=#hl-13-33>33</a>
</span><span class=lnt id=hl-13-34><a class=lnlinks href=#hl-13-34>34</a>
</span><span class=lnt id=hl-13-35><a class=lnlinks href=#hl-13-35>35</a>
</span><span class=lnt id=hl-13-36><a class=lnlinks href=#hl-13-36>36</a>
</span><span class=lnt id=hl-13-37><a class=lnlinks href=#hl-13-37>37</a>
</span><span class=lnt id=hl-13-38><a class=lnlinks href=#hl-13-38>38</a>
</span><span class=lnt id=hl-13-39><a class=lnlinks href=#hl-13-39>39</a>
</span><span class=lnt id=hl-13-40><a class=lnlinks href=#hl-13-40>40</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hmac</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_hmac</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;메시지에 대한 HMAC 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>key</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 키가 제공되지 않은 경우 무작위 키 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>key</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># HMAC 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>message_hmac</span> <span class=o>=</span> <span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>message</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>)</span><span class=o>.</span><span class=n>digest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>message_hmac</span><span class=p>,</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify_hmac</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=n>message_hmac</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;HMAC 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 동일한 키와 해시 함수로 HMAC 재계산</span>
</span></span><span class=line><span class=cl>    <span class=n>calculated_hmac</span> <span class=o>=</span> <span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>message</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>)</span><span class=o>.</span><span class=n>digest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 상수 시간 비교로 타이밍 공격 방지</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>hmac</span><span class=o>.</span><span class=n>compare_digest</span><span class=p>(</span><span class=n>message_hmac</span><span class=p>,</span> <span class=n>calculated_hmac</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>message</span> <span class=o>=</span> <span class=s2>&#34;API 요청 데이터: user_id=123&amp;action=update_profile&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># HMAC 생성</span>
</span></span><span class=line><span class=cl><span class=n>message_hmac</span><span class=p>,</span> <span class=n>key</span> <span class=o>=</span> <span class=n>create_hmac</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;메시지: </span><span class=si>{</span><span class=n>message</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;HMAC: </span><span class=si>{</span><span class=n>message_hmac</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;키: </span><span class=si>{</span><span class=n>key</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># HMAC 검증</span>
</span></span><span class=line><span class=cl><span class=n>is_valid</span> <span class=o>=</span> <span class=n>verify_hmac</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=n>message_hmac</span><span class=p>,</span> <span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;HMAC 검증 결과: </span><span class=si>{</span><span class=n>is_valid</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 변조된 메시지 검증</span>
</span></span><span class=line><span class=cl><span class=n>tampered_message</span> <span class=o>=</span> <span class=s2>&#34;API 요청 데이터: user_id=456&amp;action=delete_account&#34;</span>
</span></span><span class=line><span class=cl><span class=n>is_valid</span> <span class=o>=</span> <span class=n>verify_hmac</span><span class=p>(</span><span class=n>tampered_message</span><span class=p>,</span> <span class=n>message_hmac</span><span class=p>,</span> <span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;변조된 메시지 HMAC 검증 결과: </span><span class=si>{</span><span class=n>is_valid</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>HMAC은 API 인증, 토큰 검증, 세션 무결성 보장 등에 널리 사용된다.</p><h3 id=해싱-관련-보안-위협-및-대응>해싱 관련 보안 위협 및 대응<a hidden class=anchor aria-hidden=true href=#해싱-관련-보안-위협-및-대응>#</a></h3><h4 id=레인보우-테이블-공격rainbow-table-attack>레인보우 테이블 공격(Rainbow Table Attack)<a hidden class=anchor aria-hidden=true href=#레인보우-테이블-공격rainbow-table-attack>#</a></h4><p>미리 계산된 해시값과 원본 값을 테이블로 저장해 놓고, 이를 통해 해시값으로부터 원본을 찾아내는 공격 방식이다.</p><ul><li><strong>대응 방법</strong>: 솔트(Salt) 사용, 느린 해시 함수 사용</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1> 1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2> 2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3> 3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4> 4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5> 5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6> 6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7> 7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8> 8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9> 9</a>
</span><span class=lnt id=hl-14-10><a class=lnlinks href=#hl-14-10>10</a>
</span><span class=lnt id=hl-14-11><a class=lnlinks href=#hl-14-11>11</a>
</span><span class=lnt id=hl-14-12><a class=lnlinks href=#hl-14-12>12</a>
</span><span class=lnt id=hl-14-13><a class=lnlinks href=#hl-14-13>13</a>
</span><span class=lnt id=hl-14-14><a class=lnlinks href=#hl-14-14>14</a>
</span><span class=lnt id=hl-14-15><a class=lnlinks href=#hl-14-15>15</a>
</span><span class=lnt id=hl-14-16><a class=lnlinks href=#hl-14-16>16</a>
</span><span class=lnt id=hl-14-17><a class=lnlinks href=#hl-14-17>17</a>
</span><span class=lnt id=hl-14-18><a class=lnlinks href=#hl-14-18>18</a>
</span><span class=lnt id=hl-14-19><a class=lnlinks href=#hl-14-19>19</a>
</span><span class=lnt id=hl-14-20><a class=lnlinks href=#hl-14-20>20</a>
</span><span class=lnt id=hl-14-21><a class=lnlinks href=#hl-14-21>21</a>
</span><span class=lnt id=hl-14-22><a class=lnlinks href=#hl-14-22>22</a>
</span><span class=lnt id=hl-14-23><a class=lnlinks href=#hl-14-23>23</a>
</span><span class=lnt id=hl-14-24><a class=lnlinks href=#hl-14-24>24</a>
</span><span class=lnt id=hl-14-25><a class=lnlinks href=#hl-14-25>25</a>
</span><span class=lnt id=hl-14-26><a class=lnlinks href=#hl-14-26>26</a>
</span><span class=lnt id=hl-14-27><a class=lnlinks href=#hl-14-27>27</a>
</span><span class=lnt id=hl-14-28><a class=lnlinks href=#hl-14-28>28</a>
</span><span class=lnt id=hl-14-29><a class=lnlinks href=#hl-14-29>29</a>
</span><span class=lnt id=hl-14-30><a class=lnlinks href=#hl-14-30>30</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 솔트를 사용한 방어 예시</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 솔트 없이 단순 해싱 - 취약함</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>simple_hash</span><span class=p>(</span><span class=n>password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 솔트를 사용한 해싱 - 레인보우 테이블 공격에 강함</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>salted_hash</span><span class=p>(</span><span class=n>password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>salt</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>hash_value</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>((</span><span class=n>password</span> <span class=o>+</span> <span class=n>salt</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>salt</span><span class=si>}</span><span class=s2>$</span><span class=si>{</span><span class=n>hash_value</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 동일한 비밀번호에 대한 해시값 비교</span>
</span></span><span class=line><span class=cl><span class=n>password</span> <span class=o>=</span> <span class=s2>&#34;password123&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 솔트 없는 해시 - 항상 동일한 값 생성</span>
</span></span><span class=line><span class=cl><span class=n>simple_hash1</span> <span class=o>=</span> <span class=n>simple_hash</span><span class=p>(</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>simple_hash2</span> <span class=o>=</span> <span class=n>simple_hash</span><span class=p>(</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;솔트 없는 해시 #1: </span><span class=si>{</span><span class=n>simple_hash1</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;솔트 없는 해시 #2: </span><span class=si>{</span><span class=n>simple_hash2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;해시값 동일?: </span><span class=si>{</span><span class=n>simple_hash1</span> <span class=o>==</span> <span class=n>simple_hash2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 솔트 있는 해시 - 매번 다른 값 생성</span>
</span></span><span class=line><span class=cl><span class=n>salted_hash1</span> <span class=o>=</span> <span class=n>salted_hash</span><span class=p>(</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>salted_hash2</span> <span class=o>=</span> <span class=n>salted_hash</span><span class=p>(</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;솔트 있는 해시 #1: </span><span class=si>{</span><span class=n>salted_hash1</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;솔트 있는 해시 #2: </span><span class=si>{</span><span class=n>salted_hash2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;해시값 동일?: </span><span class=si>{</span><span class=n>salted_hash1</span> <span class=o>==</span> <span class=n>salted_hash2</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=무차별-대입-공격brute-force-attack>무차별 대입 공격(Brute Force Attack)<a hidden class=anchor aria-hidden=true href=#무차별-대입-공격brute-force-attack>#</a></h4><p>가능한 모든 입력값을 시도하여 해시값이 일치하는 원본을 찾아내는 공격 방식.</p><ul><li><strong>대응 방법</strong>: 키 스트레칭(Key Stretching), 강력한 비밀번호 정책, 계정 잠금 정책</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1> 1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2> 2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3> 3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4> 4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5> 5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6> 6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7> 7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8> 8</a>
</span><span class=lnt id=hl-15-9><a class=lnlinks href=#hl-15-9> 9</a>
</span><span class=lnt id=hl-15-10><a class=lnlinks href=#hl-15-10>10</a>
</span><span class=lnt id=hl-15-11><a class=lnlinks href=#hl-15-11>11</a>
</span><span class=lnt id=hl-15-12><a class=lnlinks href=#hl-15-12>12</a>
</span><span class=lnt id=hl-15-13><a class=lnlinks href=#hl-15-13>13</a>
</span><span class=lnt id=hl-15-14><a class=lnlinks href=#hl-15-14>14</a>
</span><span class=lnt id=hl-15-15><a class=lnlinks href=#hl-15-15>15</a>
</span><span class=lnt id=hl-15-16><a class=lnlinks href=#hl-15-16>16</a>
</span><span class=lnt id=hl-15-17><a class=lnlinks href=#hl-15-17>17</a>
</span><span class=lnt id=hl-15-18><a class=lnlinks href=#hl-15-18>18</a>
</span><span class=lnt id=hl-15-19><a class=lnlinks href=#hl-15-19>19</a>
</span><span class=lnt id=hl-15-20><a class=lnlinks href=#hl-15-20>20</a>
</span><span class=lnt id=hl-15-21><a class=lnlinks href=#hl-15-21>21</a>
</span><span class=lnt id=hl-15-22><a class=lnlinks href=#hl-15-22>22</a>
</span><span class=lnt id=hl-15-23><a class=lnlinks href=#hl-15-23>23</a>
</span><span class=lnt id=hl-15-24><a class=lnlinks href=#hl-15-24>24</a>
</span><span class=lnt id=hl-15-25><a class=lnlinks href=#hl-15-25>25</a>
</span><span class=lnt id=hl-15-26><a class=lnlinks href=#hl-15-26>26</a>
</span><span class=lnt id=hl-15-27><a class=lnlinks href=#hl-15-27>27</a>
</span><span class=lnt id=hl-15-28><a class=lnlinks href=#hl-15-28>28</a>
</span><span class=lnt id=hl-15-29><a class=lnlinks href=#hl-15-29>29</a>
</span><span class=lnt id=hl-15-30><a class=lnlinks href=#hl-15-30>30</a>
</span><span class=lnt id=hl-15-31><a class=lnlinks href=#hl-15-31>31</a>
</span><span class=lnt id=hl-15-32><a class=lnlinks href=#hl-15-32>32</a>
</span><span class=lnt id=hl-15-33><a class=lnlinks href=#hl-15-33>33</a>
</span><span class=lnt id=hl-15-34><a class=lnlinks href=#hl-15-34>34</a>
</span><span class=lnt id=hl-15-35><a class=lnlinks href=#hl-15-35>35</a>
</span><span class=lnt id=hl-15-36><a class=lnlinks href=#hl-15-36>36</a>
</span><span class=lnt id=hl-15-37><a class=lnlinks href=#hl-15-37>37</a>
</span><span class=lnt id=hl-15-38><a class=lnlinks href=#hl-15-38>38</a>
</span><span class=lnt id=hl-15-39><a class=lnlinks href=#hl-15-39>39</a>
</span><span class=lnt id=hl-15-40><a class=lnlinks href=#hl-15-40>40</a>
</span><span class=lnt id=hl-15-41><a class=lnlinks href=#hl-15-41>41</a>
</span><span class=lnt id=hl-15-42><a class=lnlinks href=#hl-15-42>42</a>
</span><span class=lnt id=hl-15-43><a class=lnlinks href=#hl-15-43>43</a>
</span><span class=lnt id=hl-15-44><a class=lnlinks href=#hl-15-44>44</a>
</span><span class=lnt id=hl-15-45><a class=lnlinks href=#hl-15-45>45</a>
</span><span class=lnt id=hl-15-46><a class=lnlinks href=#hl-15-46>46</a>
</span><span class=lnt id=hl-15-47><a class=lnlinks href=#hl-15-47>47</a>
</span><span class=lnt id=hl-15-48><a class=lnlinks href=#hl-15-48>48</a>
</span><span class=lnt id=hl-15-49><a class=lnlinks href=#hl-15-49>49</a>
</span><span class=lnt id=hl-15-50><a class=lnlinks href=#hl-15-50>50</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 키 스트레칭을 사용한 방어 예시</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>measure_attack_time</span><span class=p>(</span><span class=n>hash_function</span><span class=p>,</span> <span class=n>iterations</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;해시 함수의 계산 시간 측정으로 무차별 대입 공격 시간 추정&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=s2>&#34;test123&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 해싱 시간 측정</span>
</span></span><span class=line><span class=cl>    <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>iterations</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>hash_function</span><span class=p>(</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>end_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>single_hash_time</span> <span class=o>=</span> <span class=p>(</span><span class=n>end_time</span> <span class=o>-</span> <span class=n>start_time</span><span class=p>)</span> <span class=o>/</span> <span class=n>iterations</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 가능한 모든 6자리 숫자 비밀번호를 시도하는 데 걸리는 시간 추정</span>
</span></span><span class=line><span class=cl>    <span class=n>possible_passwords</span> <span class=o>=</span> <span class=mi>10</span> <span class=o>**</span> <span class=mi>6</span>  <span class=c1># 000000 ~ 999999</span>
</span></span><span class=line><span class=cl>    <span class=n>total_time_seconds</span> <span class=o>=</span> <span class=n>single_hash_time</span> <span class=o>*</span> <span class=n>possible_passwords</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 시간 포맷팅</span>
</span></span><span class=line><span class=cl>    <span class=n>days</span> <span class=o>=</span> <span class=n>total_time_seconds</span> <span class=o>//</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=mi>3600</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>remaining</span> <span class=o>=</span> <span class=n>total_time_seconds</span> <span class=o>%</span> <span class=p>(</span><span class=mi>24</span> <span class=o>*</span> <span class=mi>3600</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>hours</span> <span class=o>=</span> <span class=n>remaining</span> <span class=o>//</span> <span class=mi>3600</span>
</span></span><span class=line><span class=cl>    <span class=n>remaining</span> <span class=o>%=</span> <span class=mi>3600</span>
</span></span><span class=line><span class=cl>    <span class=n>minutes</span> <span class=o>=</span> <span class=n>remaining</span> <span class=o>//</span> <span class=mi>60</span>
</span></span><span class=line><span class=cl>    <span class=n>seconds</span> <span class=o>=</span> <span class=n>remaining</span> <span class=o>%</span> <span class=mi>60</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;단일 해시 시간: </span><span class=si>{</span><span class=n>single_hash_time</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>초&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;100만 개 비밀번호 시도 예상 시간: </span><span class=si>{</span><span class=n>days</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>일 </span><span class=si>{</span><span class=n>hours</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>시간 </span><span class=si>{</span><span class=n>minutes</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>분 </span><span class=si>{</span><span class=n>seconds</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>초&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 단순 SHA-256 해싱 (빠름)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>simple_hash</span><span class=p>(</span><span class=n>password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># PBKDF2를 사용한 키 스트레칭 (느림)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>stretched_hash</span><span class=p>(</span><span class=n>password</span><span class=p>,</span> <span class=n>iterations</span><span class=o>=</span><span class=mi>100000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>salt</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;fixed_salt_for_demo&#39;</span>  <span class=c1># 실제로는 무작위 솔트 사용</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>pbkdf2_hmac</span><span class=p>(</span><span class=s1>&#39;sha256&#39;</span><span class=p>,</span> <span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>salt</span><span class=p>,</span> <span class=n>iterations</span><span class=p>)</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 각 함수의 무차별 대입 공격 시간 측정</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;단순 SHA-256 해싱:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>measure_attack_time</span><span class=p>(</span><span class=n>simple_hash</span><span class=p>,</span> <span class=mi>10000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>PBKDF2 키 스트레칭 (10만 번 반복):&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 실행 시간이 오래 걸리므로 적은 수의 반복으로 측정</span>
</span></span><span class=line><span class=cl><span class=n>iterations</span> <span class=o>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>stretched_hash_with_fixed_iterations</span> <span class=o>=</span> <span class=k>lambda</span> <span class=n>p</span><span class=p>:</span> <span class=n>stretched_hash</span><span class=p>(</span><span class=n>p</span><span class=p>,</span> <span class=mi>100000</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>measure_attack_time</span><span class=p>(</span><span class=n>stretched_hash_with_fixed_iterations</span><span class=p>,</span> <span class=n>iterations</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=해시-충돌-공격hash-collision-attack>해시 충돌 공격(Hash Collision Attack)<a hidden class=anchor aria-hidden=true href=#해시-충돌-공격hash-collision-attack>#</a></h4><ul><li>동일한 해시값을 가지는 서로 다른 두 입력을 찾아내는 공격 방식.</li><li><strong>대응 방법</strong>: 강한 해시 알고리즘(SHA-256, SHA-3 등) 사용, 입력 검증</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11>11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12>12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13>13</a>
</span><span class=lnt id=hl-16-14><a class=lnlinks href=#hl-16-14>14</a>
</span><span class=lnt id=hl-16-15><a class=lnlinks href=#hl-16-15>15</a>
</span><span class=lnt id=hl-16-16><a class=lnlinks href=#hl-16-16>16</a>
</span><span class=lnt id=hl-16-17><a class=lnlinks href=#hl-16-17>17</a>
</span><span class=lnt id=hl-16-18><a class=lnlinks href=#hl-16-18>18</a>
</span><span class=lnt id=hl-16-19><a class=lnlinks href=#hl-16-19>19</a>
</span><span class=lnt id=hl-16-20><a class=lnlinks href=#hl-16-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 다양한 해시 알고리즘의 충돌 저항성 비교 (이론적)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>collision_resistance_comparison</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>algorithms</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s2>&#34;MD5&#34;</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=s2>&#34;약함 - 충돌 발견됨&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s2>&#34;SHA-1&#34;</span><span class=p>,</span> <span class=mi>160</span><span class=p>,</span> <span class=s2>&#34;약함 - 충돌 발견됨&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s2>&#34;SHA-256&#34;</span><span class=p>,</span> <span class=mi>256</span><span class=p>,</span> <span class=s2>&#34;강함 - 실용적인 충돌 공격 없음&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s2>&#34;SHA-3-256&#34;</span><span class=p>,</span> <span class=mi>256</span><span class=p>,</span> <span class=s2>&#34;강함 - 구조적으로 다른 설계로 더 안전&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=s2>&#34;BLAKE2b&#34;</span><span class=p>,</span> <span class=mi>512</span><span class=p>,</span> <span class=s2>&#34;강함 - 고성능 및 높은 보안성&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;해시 알고리즘 충돌 저항성 비교:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;| 알고리즘 | 비트 길이 | 충돌 저항성 | 이론적 공격 복잡도 |&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;|---------|----------|------------|-------------------|&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>algo</span><span class=p>,</span> <span class=n>bits</span><span class=p>,</span> <span class=n>strength</span> <span class=ow>in</span> <span class=n>algorithms</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 생일 역설에 따른 충돌 공격 복잡도: 2^(n/2)</span>
</span></span><span class=line><span class=cl>        <span class=n>complexity</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>**</span> <span class=p>(</span><span class=n>bits</span> <span class=o>/</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;| </span><span class=si>{</span><span class=n>algo</span><span class=si>}</span><span class=s2> | </span><span class=si>{</span><span class=n>bits</span><span class=si>}</span><span class=s2> | </span><span class=si>{</span><span class=n>strength</span><span class=si>}</span><span class=s2> | 2^</span><span class=si>{</span><span class=n>bits</span><span class=o>/</span><span class=mi>2</span><span class=si>}</span><span class=s2> ≈ </span><span class=si>{</span><span class=n>complexity</span><span class=si>:</span><span class=s2>e</span><span class=si>}</span><span class=s2> |&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>collision_resistance_comparison</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=길이-확장-공격length-extension-attack>길이 확장 공격(Length Extension Attack)<a hidden class=anchor aria-hidden=true href=#길이-확장-공격length-extension-attack>#</a></h4><p>일부 해시 함수(SHA-1, SHA-2 등)는 메르켈-담가드(Merkle-Damgård) 구조를 사용하여, 원본 메시지와 해시값을 알면 추가 데이터를 덧붙인 새로운 메시지의 해시값을 계산할 수 있다. 이를 이용한 공격이 길이 확장 공격.</p><ul><li><strong>대응 방법</strong>: HMAC 사용, SHA-3와 같은 내부 구조가 다른 해시 알고리즘 사용</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1> 1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2> 2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3> 3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4> 4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5> 5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6> 6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7> 7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8> 8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9> 9</a>
</span><span class=lnt id=hl-17-10><a class=lnlinks href=#hl-17-10>10</a>
</span><span class=lnt id=hl-17-11><a class=lnlinks href=#hl-17-11>11</a>
</span><span class=lnt id=hl-17-12><a class=lnlinks href=#hl-17-12>12</a>
</span><span class=lnt id=hl-17-13><a class=lnlinks href=#hl-17-13>13</a>
</span><span class=lnt id=hl-17-14><a class=lnlinks href=#hl-17-14>14</a>
</span><span class=lnt id=hl-17-15><a class=lnlinks href=#hl-17-15>15</a>
</span><span class=lnt id=hl-17-16><a class=lnlinks href=#hl-17-16>16</a>
</span><span class=lnt id=hl-17-17><a class=lnlinks href=#hl-17-17>17</a>
</span><span class=lnt id=hl-17-18><a class=lnlinks href=#hl-17-18>18</a>
</span><span class=lnt id=hl-17-19><a class=lnlinks href=#hl-17-19>19</a>
</span><span class=lnt id=hl-17-20><a class=lnlinks href=#hl-17-20>20</a>
</span><span class=lnt id=hl-17-21><a class=lnlinks href=#hl-17-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hmac</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>compare_hash_vs_hmac</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;단순 해싱과 HMAC의 길이 확장 공격 취약성 비교&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>secret_key</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;very_secret_key&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>original_message</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;original_data&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 단순 해싱 (길이 확장 공격에 취약)</span>
</span></span><span class=line><span class=cl>    <span class=n>simple_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>secret_key</span> <span class=o>+</span> <span class=n>original_message</span><span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># HMAC (길이 확장 공격에 안전)</span>
</span></span><span class=line><span class=cl>    <span class=n>message_hmac</span> <span class=o>=</span> <span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>secret_key</span><span class=p>,</span> <span class=n>original_message</span><span class=p>,</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;단순 해싱 vs HMAC 비교:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;단순 해싱: </span><span class=si>{</span><span class=n>simple_hash</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;HMAC: </span><span class=si>{</span><span class=n>message_hmac</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>단순 해싱은 키를 메시지 앞에 연결하여 길이 확장 공격에 취약합니다.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;HMAC은 키를 특별한 방식으로 처리하여 길이 확장 공격에 안전합니다.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>compare_hash_vs_hmac</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>길이 확장 공격은 웹 애플리케이션의 인증 토큰, 서명된 데이터 등에 영향을 줄 수 있다.</p><h3 id=실제-개발에서의-해싱-모범-사례>실제 개발에서의 해싱 모범 사례<a hidden class=anchor aria-hidden=true href=#실제-개발에서의-해싱-모범-사례>#</a></h3><p>개발자가 보안 관련 해싱을 구현할 때 따라야 할 모범 사례:</p><h4 id=비밀번호-저장-모범-사례>비밀번호 저장 모범 사례<a hidden class=anchor aria-hidden=true href=#비밀번호-저장-모범-사례>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1> 1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2> 2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3> 3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4> 4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5> 5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6> 6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7> 7</a>
</span><span class=lnt id=hl-18-8><a class=lnlinks href=#hl-18-8> 8</a>
</span><span class=lnt id=hl-18-9><a class=lnlinks href=#hl-18-9> 9</a>
</span><span class=lnt id=hl-18-10><a class=lnlinks href=#hl-18-10>10</a>
</span><span class=lnt id=hl-18-11><a class=lnlinks href=#hl-18-11>11</a>
</span><span class=lnt id=hl-18-12><a class=lnlinks href=#hl-18-12>12</a>
</span><span class=lnt id=hl-18-13><a class=lnlinks href=#hl-18-13>13</a>
</span><span class=lnt id=hl-18-14><a class=lnlinks href=#hl-18-14>14</a>
</span><span class=lnt id=hl-18-15><a class=lnlinks href=#hl-18-15>15</a>
</span><span class=lnt id=hl-18-16><a class=lnlinks href=#hl-18-16>16</a>
</span><span class=lnt id=hl-18-17><a class=lnlinks href=#hl-18-17>17</a>
</span><span class=lnt id=hl-18-18><a class=lnlinks href=#hl-18-18>18</a>
</span><span class=lnt id=hl-18-19><a class=lnlinks href=#hl-18-19>19</a>
</span><span class=lnt id=hl-18-20><a class=lnlinks href=#hl-18-20>20</a>
</span><span class=lnt id=hl-18-21><a class=lnlinks href=#hl-18-21>21</a>
</span><span class=lnt id=hl-18-22><a class=lnlinks href=#hl-18-22>22</a>
</span><span class=lnt id=hl-18-23><a class=lnlinks href=#hl-18-23>23</a>
</span><span class=lnt id=hl-18-24><a class=lnlinks href=#hl-18-24>24</a>
</span><span class=lnt id=hl-18-25><a class=lnlinks href=#hl-18-25>25</a>
</span><span class=lnt id=hl-18-26><a class=lnlinks href=#hl-18-26>26</a>
</span><span class=lnt id=hl-18-27><a class=lnlinks href=#hl-18-27>27</a>
</span><span class=lnt id=hl-18-28><a class=lnlinks href=#hl-18-28>28</a>
</span><span class=lnt id=hl-18-29><a class=lnlinks href=#hl-18-29>29</a>
</span><span class=lnt id=hl-18-30><a class=lnlinks href=#hl-18-30>30</a>
</span><span class=lnt id=hl-18-31><a class=lnlinks href=#hl-18-31>31</a>
</span><span class=lnt id=hl-18-32><a class=lnlinks href=#hl-18-32>32</a>
</span><span class=lnt id=hl-18-33><a class=lnlinks href=#hl-18-33>33</a>
</span><span class=lnt id=hl-18-34><a class=lnlinks href=#hl-18-34>34</a>
</span><span class=lnt id=hl-18-35><a class=lnlinks href=#hl-18-35>35</a>
</span><span class=lnt id=hl-18-36><a class=lnlinks href=#hl-18-36>36</a>
</span><span class=lnt id=hl-18-37><a class=lnlinks href=#hl-18-37>37</a>
</span><span class=lnt id=hl-18-38><a class=lnlinks href=#hl-18-38>38</a>
</span><span class=lnt id=hl-18-39><a class=lnlinks href=#hl-18-39>39</a>
</span><span class=lnt id=hl-18-40><a class=lnlinks href=#hl-18-40>40</a>
</span><span class=lnt id=hl-18-41><a class=lnlinks href=#hl-18-41>41</a>
</span><span class=lnt id=hl-18-42><a class=lnlinks href=#hl-18-42>42</a>
</span><span class=lnt id=hl-18-43><a class=lnlinks href=#hl-18-43>43</a>
</span><span class=lnt id=hl-18-44><a class=lnlinks href=#hl-18-44>44</a>
</span><span class=lnt id=hl-18-45><a class=lnlinks href=#hl-18-45>45</a>
</span><span class=lnt id=hl-18-46><a class=lnlinks href=#hl-18-46>46</a>
</span><span class=lnt id=hl-18-47><a class=lnlinks href=#hl-18-47>47</a>
</span><span class=lnt id=hl-18-48><a class=lnlinks href=#hl-18-48>48</a>
</span><span class=lnt id=hl-18-49><a class=lnlinks href=#hl-18-49>49</a>
</span><span class=lnt id=hl-18-50><a class=lnlinks href=#hl-18-50>50</a>
</span><span class=lnt id=hl-18-51><a class=lnlinks href=#hl-18-51>51</a>
</span><span class=lnt id=hl-18-52><a class=lnlinks href=#hl-18-52>52</a>
</span><span class=lnt id=hl-18-53><a class=lnlinks href=#hl-18-53>53</a>
</span><span class=lnt id=hl-18-54><a class=lnlinks href=#hl-18-54>54</a>
</span><span class=lnt id=hl-18-55><a class=lnlinks href=#hl-18-55>55</a>
</span><span class=lnt id=hl-18-56><a class=lnlinks href=#hl-18-56>56</a>
</span><span class=lnt id=hl-18-57><a class=lnlinks href=#hl-18-57>57</a>
</span><span class=lnt id=hl-18-58><a class=lnlinks href=#hl-18-58>58</a>
</span><span class=lnt id=hl-18-59><a class=lnlinks href=#hl-18-59>59</a>
</span><span class=lnt id=hl-18-60><a class=lnlinks href=#hl-18-60>60</a>
</span><span class=lnt id=hl-18-61><a class=lnlinks href=#hl-18-61>61</a>
</span><span class=lnt id=hl-18-62><a class=lnlinks href=#hl-18-62>62</a>
</span><span class=lnt id=hl-18-63><a class=lnlinks href=#hl-18-63>63</a>
</span><span class=lnt id=hl-18-64><a class=lnlinks href=#hl-18-64>64</a>
</span><span class=lnt id=hl-18-65><a class=lnlinks href=#hl-18-65>65</a>
</span><span class=lnt id=hl-18-66><a class=lnlinks href=#hl-18-66>66</a>
</span><span class=lnt id=hl-18-67><a class=lnlinks href=#hl-18-67>67</a>
</span><span class=lnt id=hl-18-68><a class=lnlinks href=#hl-18-68>68</a>
</span><span class=lnt id=hl-18-69><a class=lnlinks href=#hl-18-69>69</a>
</span><span class=lnt id=hl-18-70><a class=lnlinks href=#hl-18-70>70</a>
</span><span class=lnt id=hl-18-71><a class=lnlinks href=#hl-18-71>71</a>
</span><span class=lnt id=hl-18-72><a class=lnlinks href=#hl-18-72>72</a>
</span><span class=lnt id=hl-18-73><a class=lnlinks href=#hl-18-73>73</a>
</span><span class=lnt id=hl-18-74><a class=lnlinks href=#hl-18-74>74</a>
</span><span class=lnt id=hl-18-75><a class=lnlinks href=#hl-18-75>75</a>
</span><span class=lnt id=hl-18-76><a class=lnlinks href=#hl-18-76>76</a>
</span><span class=lnt id=hl-18-77><a class=lnlinks href=#hl-18-77>77</a>
</span><span class=lnt id=hl-18-78><a class=lnlinks href=#hl-18-78>78</a>
</span><span class=lnt id=hl-18-79><a class=lnlinks href=#hl-18-79>79</a>
</span><span class=lnt id=hl-18-80><a class=lnlinks href=#hl-18-80>80</a>
</span><span class=lnt id=hl-18-81><a class=lnlinks href=#hl-18-81>81</a>
</span><span class=lnt id=hl-18-82><a class=lnlinks href=#hl-18-82>82</a>
</span><span class=lnt id=hl-18-83><a class=lnlinks href=#hl-18-83>83</a>
</span><span class=lnt id=hl-18-84><a class=lnlinks href=#hl-18-84>84</a>
</span><span class=lnt id=hl-18-85><a class=lnlinks href=#hl-18-85>85</a>
</span><span class=lnt id=hl-18-86><a class=lnlinks href=#hl-18-86>86</a>
</span><span class=lnt id=hl-18-87><a class=lnlinks href=#hl-18-87>87</a>
</span><span class=lnt id=hl-18-88><a class=lnlinks href=#hl-18-88>88</a>
</span><span class=lnt id=hl-18-89><a class=lnlinks href=#hl-18-89>89</a>
</span><span class=lnt id=hl-18-90><a class=lnlinks href=#hl-18-90>90</a>
</span><span class=lnt id=hl-18-91><a class=lnlinks href=#hl-18-91>91</a>
</span><span class=lnt id=hl-18-92><a class=lnlinks href=#hl-18-92>92</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hmac</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>PasswordManager</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;안전한 비밀번호 관리를 위한 클래스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>pepper</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        초기화
</span></span></span><span class=line><span class=cl><span class=s2>        pepper: 모든 비밀번호에 추가되는 비밀 값 (서버측 비밀)
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 페퍼가 제공되지 않으면 무작위로 생성 (실제로는 환경 변수나 설정에서 가져와야 함)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pepper</span> <span class=o>=</span> <span class=n>pepper</span> <span class=ow>or</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>hash_password</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>password</span><span class=p>,</span> <span class=n>iterations</span><span class=o>=</span><span class=mi>100000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        안전한 비밀번호 해싱
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        password: 해싱할 비밀번호
</span></span></span><span class=line><span class=cl><span class=s2>        iterations: 반복 횟수 (키 스트레칭)
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        반환: 솔트와 해시를 포함한 문자열 (형식: </span><span class=si>{알고리즘}</span><span class=s2>$</span><span class=si>{반복횟수}</span><span class=s2>$</span><span class=si>{솔트}</span><span class=s2>$</span><span class=si>{해시}</span><span class=s2>)
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 무작위 솔트 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>salt</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># PBKDF2 해싱 수행</span>
</span></span><span class=line><span class=cl>        <span class=n>password_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>pbkdf2_hmac</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;sha256&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>pepper</span><span class=p>,</span>  <span class=c1># 페퍼 추가</span>
</span></span><span class=line><span class=cl>            <span class=n>salt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>iterations</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Base64로 인코딩</span>
</span></span><span class=line><span class=cl>        <span class=n>salt_b64</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>salt</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>hash_b64</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>password_hash</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 포맷: {알고리즘}${반복횟수}${솔트}${해시}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;pbkdf2_sha256$</span><span class=si>{</span><span class=n>iterations</span><span class=si>}</span><span class=s2>$</span><span class=si>{</span><span class=n>salt_b64</span><span class=si>}</span><span class=s2>$</span><span class=si>{</span><span class=n>hash_b64</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>verify_password</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>stored_password_hash</span><span class=p>,</span> <span class=n>password_to_check</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        비밀번호 검증
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        stored_password_hash: hash_password로 생성된 해시 문자열
</span></span></span><span class=line><span class=cl><span class=s2>        password_to_check: 검증할 비밀번호
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        반환: 비밀번호가 일치하면 True, 그렇지 않으면 False
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 저장된 해시에서 정보 추출</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>algorithm</span><span class=p>,</span> <span class=n>iterations</span><span class=p>,</span> <span class=n>salt_b64</span><span class=p>,</span> <span class=n>hash_b64</span> <span class=o>=</span> <span class=n>stored_password_hash</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;$&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Base64 디코딩</span>
</span></span><span class=line><span class=cl>            <span class=n>salt</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>salt_b64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>stored_hash</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>hash_b64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 반복 횟수를 정수로 변환</span>
</span></span><span class=line><span class=cl>            <span class=n>iterations</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>iterations</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 동일한 방식으로 해싱</span>
</span></span><span class=line><span class=cl>            <span class=n>calculated_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>pbkdf2_hmac</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;sha256&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>password_to_check</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>pepper</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>salt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>iterations</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 해시 비교 (상수 시간 비교로 타이밍 공격 방지)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>hmac</span><span class=o>.</span><span class=n>compare_digest</span><span class=p>(</span><span class=n>stored_hash</span><span class=p>,</span> <span class=n>calculated_hash</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=p>(</span><span class=ne>ValueError</span><span class=p>,</span> <span class=ne>IndexError</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=c1># 잘못된 형식의 해시</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>password_manager</span> <span class=o>=</span> <span class=n>PasswordManager</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 비밀번호 해싱</span>
</span></span><span class=line><span class=cl><span class=n>user_password</span> <span class=o>=</span> <span class=s2>&#34;Secure_Password123!&#34;</span>
</span></span><span class=line><span class=cl><span class=n>hashed_password</span> <span class=o>=</span> <span class=n>password_manager</span><span class=o>.</span><span class=n>hash_password</span><span class=p>(</span><span class=n>user_password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;해시된 비밀번호: </span><span class=si>{</span><span class=n>hashed_password</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 비밀번호 검증</span>
</span></span><span class=line><span class=cl><span class=n>is_valid</span> <span class=o>=</span> <span class=n>password_manager</span><span class=o>.</span><span class=n>verify_password</span><span class=p>(</span><span class=n>hashed_password</span><span class=p>,</span> <span class=n>user_password</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;올바른 비밀번호 검증 결과: </span><span class=si>{</span><span class=n>is_valid</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>is_valid</span> <span class=o>=</span> <span class=n>password_manager</span><span class=o>.</span><span class=n>verify_password</span><span class=p>(</span><span class=n>hashed_password</span><span class=p>,</span> <span class=s2>&#34;Wrong_Password123!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;잘못된 비밀번호 검증 결과: </span><span class=si>{</span><span class=n>is_valid</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>이 코드는 비밀번호 저장을 위한 여러 보안 기법을 보여준다:</p><ul><li>솔트(Salt): 각 비밀번호마다 무작위 솔트 사용</li><li>페퍼(Pepper): 모든 비밀번호에 적용되는 서버 측 비밀 값</li><li>키 스트레칭: PBKDF2로 여러 번 반복</li><li>상수 시간 비교: 타이밍 공격 방지</li></ul><h4 id=api-인증을-위한-hmac-사용>API 인증을 위한 HMAC 사용<a hidden class=anchor aria-hidden=true href=#api-인증을-위한-hmac-사용>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12>12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13>13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14>14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15>15</a>
</span><span class=lnt id=hl-19-16><a class=lnlinks href=#hl-19-16>16</a>
</span><span class=lnt id=hl-19-17><a class=lnlinks href=#hl-19-17>17</a>
</span><span class=lnt id=hl-19-18><a class=lnlinks href=#hl-19-18>18</a>
</span><span class=lnt id=hl-19-19><a class=lnlinks href=#hl-19-19>19</a>
</span><span class=lnt id=hl-19-20><a class=lnlinks href=#hl-19-20>20</a>
</span><span class=lnt id=hl-19-21><a class=lnlinks href=#hl-19-21>21</a>
</span><span class=lnt id=hl-19-22><a class=lnlinks href=#hl-19-22>22</a>
</span><span class=lnt id=hl-19-23><a class=lnlinks href=#hl-19-23>23</a>
</span><span class=lnt id=hl-19-24><a class=lnlinks href=#hl-19-24>24</a>
</span><span class=lnt id=hl-19-25><a class=lnlinks href=#hl-19-25>25</a>
</span><span class=lnt id=hl-19-26><a class=lnlinks href=#hl-19-26>26</a>
</span><span class=lnt id=hl-19-27><a class=lnlinks href=#hl-19-27>27</a>
</span><span class=lnt id=hl-19-28><a class=lnlinks href=#hl-19-28>28</a>
</span><span class=lnt id=hl-19-29><a class=lnlinks href=#hl-19-29>29</a>
</span><span class=lnt id=hl-19-30><a class=lnlinks href=#hl-19-30>30</a>
</span><span class=lnt id=hl-19-31><a class=lnlinks href=#hl-19-31>31</a>
</span><span class=lnt id=hl-19-32><a class=lnlinks href=#hl-19-32>32</a>
</span><span class=lnt id=hl-19-33><a class=lnlinks href=#hl-19-33>33</a>
</span><span class=lnt id=hl-19-34><a class=lnlinks href=#hl-19-34>34</a>
</span><span class=lnt id=hl-19-35><a class=lnlinks href=#hl-19-35>35</a>
</span><span class=lnt id=hl-19-36><a class=lnlinks href=#hl-19-36>36</a>
</span><span class=lnt id=hl-19-37><a class=lnlinks href=#hl-19-37>37</a>
</span><span class=lnt id=hl-19-38><a class=lnlinks href=#hl-19-38>38</a>
</span><span class=lnt id=hl-19-39><a class=lnlinks href=#hl-19-39>39</a>
</span><span class=lnt id=hl-19-40><a class=lnlinks href=#hl-19-40>40</a>
</span><span class=lnt id=hl-19-41><a class=lnlinks href=#hl-19-41>41</a>
</span><span class=lnt id=hl-19-42><a class=lnlinks href=#hl-19-42>42</a>
</span><span class=lnt id=hl-19-43><a class=lnlinks href=#hl-19-43>43</a>
</span><span class=lnt id=hl-19-44><a class=lnlinks href=#hl-19-44>44</a>
</span><span class=lnt id=hl-19-45><a class=lnlinks href=#hl-19-45>45</a>
</span><span class=lnt id=hl-19-46><a class=lnlinks href=#hl-19-46>46</a>
</span><span class=lnt id=hl-19-47><a class=lnlinks href=#hl-19-47>47</a>
</span><span class=lnt id=hl-19-48><a class=lnlinks href=#hl-19-48>48</a>
</span><span class=lnt id=hl-19-49><a class=lnlinks href=#hl-19-49>49</a>
</span><span class=lnt id=hl-19-50><a class=lnlinks href=#hl-19-50>50</a>
</span><span class=lnt id=hl-19-51><a class=lnlinks href=#hl-19-51>51</a>
</span><span class=lnt id=hl-19-52><a class=lnlinks href=#hl-19-52>52</a>
</span><span class=lnt id=hl-19-53><a class=lnlinks href=#hl-19-53>53</a>
</span><span class=lnt id=hl-19-54><a class=lnlinks href=#hl-19-54>54</a>
</span><span class=lnt id=hl-19-55><a class=lnlinks href=#hl-19-55>55</a>
</span><span class=lnt id=hl-19-56><a class=lnlinks href=#hl-19-56>56</a>
</span><span class=lnt id=hl-19-57><a class=lnlinks href=#hl-19-57>57</a>
</span><span class=lnt id=hl-19-58><a class=lnlinks href=#hl-19-58>58</a>
</span><span class=lnt id=hl-19-59><a class=lnlinks href=#hl-19-59>59</a>
</span><span class=lnt id=hl-19-60><a class=lnlinks href=#hl-19-60>60</a>
</span><span class=lnt id=hl-19-61><a class=lnlinks href=#hl-19-61>61</a>
</span><span class=lnt id=hl-19-62><a class=lnlinks href=#hl-19-62>62</a>
</span><span class=lnt id=hl-19-63><a class=lnlinks href=#hl-19-63>63</a>
</span><span class=lnt id=hl-19-64><a class=lnlinks href=#hl-19-64>64</a>
</span><span class=lnt id=hl-19-65><a class=lnlinks href=#hl-19-65>65</a>
</span><span class=lnt id=hl-19-66><a class=lnlinks href=#hl-19-66>66</a>
</span><span class=lnt id=hl-19-67><a class=lnlinks href=#hl-19-67>67</a>
</span><span class=lnt id=hl-19-68><a class=lnlinks href=#hl-19-68>68</a>
</span><span class=lnt id=hl-19-69><a class=lnlinks href=#hl-19-69>69</a>
</span><span class=lnt id=hl-19-70><a class=lnlinks href=#hl-19-70>70</a>
</span><span class=lnt id=hl-19-71><a class=lnlinks href=#hl-19-71>71</a>
</span><span class=lnt id=hl-19-72><a class=lnlinks href=#hl-19-72>72</a>
</span><span class=lnt id=hl-19-73><a class=lnlinks href=#hl-19-73>73</a>
</span><span class=lnt id=hl-19-74><a class=lnlinks href=#hl-19-74>74</a>
</span><span class=lnt id=hl-19-75><a class=lnlinks href=#hl-19-75>75</a>
</span><span class=lnt id=hl-19-76><a class=lnlinks href=#hl-19-76>76</a>
</span><span class=lnt id=hl-19-77><a class=lnlinks href=#hl-19-77>77</a>
</span><span class=lnt id=hl-19-78><a class=lnlinks href=#hl-19-78>78</a>
</span><span class=lnt id=hl-19-79><a class=lnlinks href=#hl-19-79>79</a>
</span><span class=lnt id=hl-19-80><a class=lnlinks href=#hl-19-80>80</a>
</span><span class=lnt id=hl-19-81><a class=lnlinks href=#hl-19-81>81</a>
</span><span class=lnt id=hl-19-82><a class=lnlinks href=#hl-19-82>82</a>
</span><span class=lnt id=hl-19-83><a class=lnlinks href=#hl-19-83>83</a>
</span><span class=lnt id=hl-19-84><a class=lnlinks href=#hl-19-84>84</a>
</span><span class=lnt id=hl-19-85><a class=lnlinks href=#hl-19-85>85</a>
</span><span class=lnt id=hl-19-86><a class=lnlinks href=#hl-19-86>86</a>
</span><span class=lnt id=hl-19-87><a class=lnlinks href=#hl-19-87>87</a>
</span><span class=lnt id=hl-19-88><a class=lnlinks href=#hl-19-88>88</a>
</span><span class=lnt id=hl-19-89><a class=lnlinks href=#hl-19-89>89</a>
</span><span class=lnt id=hl-19-90><a class=lnlinks href=#hl-19-90>90</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hmac</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ApiAuthenticator</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;API 요청 인증을 위한 HMAC 기반 클래스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>api_key</span><span class=p>,</span> <span class=n>api_secret</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        초기화
</span></span></span><span class=line><span class=cl><span class=s2>        api_key: API 키 (클라이언트 식별)
</span></span></span><span class=line><span class=cl><span class=s2>        api_secret: API 비밀 키 (서명 생성용)
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>api_key</span> <span class=o>=</span> <span class=n>api_key</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>api_secret</span> <span class=o>=</span> <span class=n>api_secret</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>generate_signature</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>method</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>timestamp</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        API 요청에 대한 HMAC 서명 생성
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        method: HTTP 메서드 (GET, POST 등)
</span></span></span><span class=line><span class=cl><span class=s2>        endpoint: API 엔드포인트 경로
</span></span></span><span class=line><span class=cl><span class=s2>        params: 요청 파라미터 딕셔너리
</span></span></span><span class=line><span class=cl><span class=s2>        timestamp: 타임스탬프 (None인 경우 현재 시간 사용)
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        반환: Base64로 인코딩된 HMAC 서명
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 타임스탬프가 제공되지 않으면 현재 시간 사용</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>timestamp</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>timestamp</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 정렬된 파라미터 문자열로 변환</span>
</span></span><span class=line><span class=cl>        <span class=n>sorted_params</span> <span class=o>=</span> <span class=s1>&#39;&amp;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>k</span><span class=si>}</span><span class=s2>=</span><span class=si>{</span><span class=n>v</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>params</span><span class=o>.</span><span class=n>items</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 서명 대상 문자열 생성: method + endpoint + params + timestamp</span>
</span></span><span class=line><span class=cl>        <span class=n>message</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>method</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span><span class=si>}{</span><span class=n>endpoint</span><span class=si>}{</span><span class=n>sorted_params</span><span class=si>}{</span><span class=n>timestamp</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># HMAC-SHA256 서명 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>signature</span> <span class=o>=</span> <span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>api_secret</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>message</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span><span class=o>.</span><span class=n>digest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Base64로 인코딩</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>signature</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>verify_signature</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>signature</span><span class=p>,</span> <span class=n>method</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        API 요청 서명 검증
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        signature: 검증할 서명
</span></span></span><span class=line><span class=cl><span class=s2>        method, endpoint, params, timestamp: 원본 요청 정보
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        반환: 서명이 일치하면 True, 그렇지 않으면 False
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>expected_signature</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>generate_signature</span><span class=p>(</span><span class=n>method</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 상수 시간 비교로 타이밍 공격 방지</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>hmac</span><span class=o>.</span><span class=n>compare_digest</span><span class=p>(</span><span class=n>signature</span><span class=p>,</span> <span class=n>expected_signature</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>api_key</span> <span class=o>=</span> <span class=s2>&#34;user123&#34;</span>
</span></span><span class=line><span class=cl><span class=n>api_secret</span> <span class=o>=</span> <span class=s2>&#34;very_secret_api_key&#34;</span>
</span></span><span class=line><span class=cl><span class=n>authenticator</span> <span class=o>=</span> <span class=n>ApiAuthenticator</span><span class=p>(</span><span class=n>api_key</span><span class=p>,</span> <span class=n>api_secret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># API 요청 정보</span>
</span></span><span class=line><span class=cl><span class=n>method</span> <span class=o>=</span> <span class=s2>&#34;POST&#34;</span>
</span></span><span class=line><span class=cl><span class=n>endpoint</span> <span class=o>=</span> <span class=s2>&#34;/api/v1/orders&#34;</span>
</span></span><span class=line><span class=cl><span class=n>params</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;product_id&#34;</span><span class=p>:</span> <span class=s2>&#34;12345&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;quantity&#34;</span><span class=p>:</span> <span class=s2>&#34;2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;price&#34;</span><span class=p>:</span> <span class=s2>&#34;99.99&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>timestamp</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 서명 생성 (클라이언트 측)</span>
</span></span><span class=line><span class=cl><span class=n>signature</span> <span class=o>=</span> <span class=n>authenticator</span><span class=o>.</span><span class=n>generate_signature</span><span class=p>(</span><span class=n>method</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;생성된 서명: </span><span class=si>{</span><span class=n>signature</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 서명 검증 (서버 측)</span>
</span></span><span class=line><span class=cl><span class=n>is_valid</span> <span class=o>=</span> <span class=n>authenticator</span><span class=o>.</span><span class=n>verify_signature</span><span class=p>(</span><span class=n>signature</span><span class=p>,</span> <span class=n>method</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;서명 검증 결과: </span><span class=si>{</span><span class=n>is_valid</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 변조된 요청 검증</span>
</span></span><span class=line><span class=cl><span class=n>tampered_params</span> <span class=o>=</span> <span class=n>params</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>tampered_params</span><span class=p>[</span><span class=s2>&#34;quantity&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;10&#34;</span>  <span class=c1># 수량을 2에서 10으로 변경</span>
</span></span><span class=line><span class=cl><span class=n>is_valid</span> <span class=o>=</span> <span class=n>authenticator</span><span class=o>.</span><span class=n>verify_signature</span><span class=p>(</span><span class=n>signature</span><span class=p>,</span> <span class=n>method</span><span class=p>,</span> <span class=n>endpoint</span><span class=p>,</span> <span class=n>tampered_params</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;변조된 요청 검증 결과: </span><span class=si>{</span><span class=n>is_valid</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>이 코드는 API 요청의 무결성과 출처를 검증하기 위한 HMAC 기반 인증 시스템을 보여준다.<br>클라이언트가 API 요청을 보낼 때 서명을 함께 제공하고, 서버는 이 서명을 검증하여 요청이 변조되지 않았는지 확인한다.</p><h4 id=파일-무결성-검증을-위한-체크섬checksum>파일 무결성 검증을 위한 체크섬(Checksum)<a hidden class=anchor aria-hidden=true href=#파일-무결성-검증을-위한-체크섬checksum>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1>  1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2>  2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3>  3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4>  4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5>  5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6>  6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7>  7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8>  8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9>  9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10> 10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11> 11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12> 12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13> 13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14> 14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15> 15</a>
</span><span class=lnt id=hl-20-16><a class=lnlinks href=#hl-20-16> 16</a>
</span><span class=lnt id=hl-20-17><a class=lnlinks href=#hl-20-17> 17</a>
</span><span class=lnt id=hl-20-18><a class=lnlinks href=#hl-20-18> 18</a>
</span><span class=lnt id=hl-20-19><a class=lnlinks href=#hl-20-19> 19</a>
</span><span class=lnt id=hl-20-20><a class=lnlinks href=#hl-20-20> 20</a>
</span><span class=lnt id=hl-20-21><a class=lnlinks href=#hl-20-21> 21</a>
</span><span class=lnt id=hl-20-22><a class=lnlinks href=#hl-20-22> 22</a>
</span><span class=lnt id=hl-20-23><a class=lnlinks href=#hl-20-23> 23</a>
</span><span class=lnt id=hl-20-24><a class=lnlinks href=#hl-20-24> 24</a>
</span><span class=lnt id=hl-20-25><a class=lnlinks href=#hl-20-25> 25</a>
</span><span class=lnt id=hl-20-26><a class=lnlinks href=#hl-20-26> 26</a>
</span><span class=lnt id=hl-20-27><a class=lnlinks href=#hl-20-27> 27</a>
</span><span class=lnt id=hl-20-28><a class=lnlinks href=#hl-20-28> 28</a>
</span><span class=lnt id=hl-20-29><a class=lnlinks href=#hl-20-29> 29</a>
</span><span class=lnt id=hl-20-30><a class=lnlinks href=#hl-20-30> 30</a>
</span><span class=lnt id=hl-20-31><a class=lnlinks href=#hl-20-31> 31</a>
</span><span class=lnt id=hl-20-32><a class=lnlinks href=#hl-20-32> 32</a>
</span><span class=lnt id=hl-20-33><a class=lnlinks href=#hl-20-33> 33</a>
</span><span class=lnt id=hl-20-34><a class=lnlinks href=#hl-20-34> 34</a>
</span><span class=lnt id=hl-20-35><a class=lnlinks href=#hl-20-35> 35</a>
</span><span class=lnt id=hl-20-36><a class=lnlinks href=#hl-20-36> 36</a>
</span><span class=lnt id=hl-20-37><a class=lnlinks href=#hl-20-37> 37</a>
</span><span class=lnt id=hl-20-38><a class=lnlinks href=#hl-20-38> 38</a>
</span><span class=lnt id=hl-20-39><a class=lnlinks href=#hl-20-39> 39</a>
</span><span class=lnt id=hl-20-40><a class=lnlinks href=#hl-20-40> 40</a>
</span><span class=lnt id=hl-20-41><a class=lnlinks href=#hl-20-41> 41</a>
</span><span class=lnt id=hl-20-42><a class=lnlinks href=#hl-20-42> 42</a>
</span><span class=lnt id=hl-20-43><a class=lnlinks href=#hl-20-43> 43</a>
</span><span class=lnt id=hl-20-44><a class=lnlinks href=#hl-20-44> 44</a>
</span><span class=lnt id=hl-20-45><a class=lnlinks href=#hl-20-45> 45</a>
</span><span class=lnt id=hl-20-46><a class=lnlinks href=#hl-20-46> 46</a>
</span><span class=lnt id=hl-20-47><a class=lnlinks href=#hl-20-47> 47</a>
</span><span class=lnt id=hl-20-48><a class=lnlinks href=#hl-20-48> 48</a>
</span><span class=lnt id=hl-20-49><a class=lnlinks href=#hl-20-49> 49</a>
</span><span class=lnt id=hl-20-50><a class=lnlinks href=#hl-20-50> 50</a>
</span><span class=lnt id=hl-20-51><a class=lnlinks href=#hl-20-51> 51</a>
</span><span class=lnt id=hl-20-52><a class=lnlinks href=#hl-20-52> 52</a>
</span><span class=lnt id=hl-20-53><a class=lnlinks href=#hl-20-53> 53</a>
</span><span class=lnt id=hl-20-54><a class=lnlinks href=#hl-20-54> 54</a>
</span><span class=lnt id=hl-20-55><a class=lnlinks href=#hl-20-55> 55</a>
</span><span class=lnt id=hl-20-56><a class=lnlinks href=#hl-20-56> 56</a>
</span><span class=lnt id=hl-20-57><a class=lnlinks href=#hl-20-57> 57</a>
</span><span class=lnt id=hl-20-58><a class=lnlinks href=#hl-20-58> 58</a>
</span><span class=lnt id=hl-20-59><a class=lnlinks href=#hl-20-59> 59</a>
</span><span class=lnt id=hl-20-60><a class=lnlinks href=#hl-20-60> 60</a>
</span><span class=lnt id=hl-20-61><a class=lnlinks href=#hl-20-61> 61</a>
</span><span class=lnt id=hl-20-62><a class=lnlinks href=#hl-20-62> 62</a>
</span><span class=lnt id=hl-20-63><a class=lnlinks href=#hl-20-63> 63</a>
</span><span class=lnt id=hl-20-64><a class=lnlinks href=#hl-20-64> 64</a>
</span><span class=lnt id=hl-20-65><a class=lnlinks href=#hl-20-65> 65</a>
</span><span class=lnt id=hl-20-66><a class=lnlinks href=#hl-20-66> 66</a>
</span><span class=lnt id=hl-20-67><a class=lnlinks href=#hl-20-67> 67</a>
</span><span class=lnt id=hl-20-68><a class=lnlinks href=#hl-20-68> 68</a>
</span><span class=lnt id=hl-20-69><a class=lnlinks href=#hl-20-69> 69</a>
</span><span class=lnt id=hl-20-70><a class=lnlinks href=#hl-20-70> 70</a>
</span><span class=lnt id=hl-20-71><a class=lnlinks href=#hl-20-71> 71</a>
</span><span class=lnt id=hl-20-72><a class=lnlinks href=#hl-20-72> 72</a>
</span><span class=lnt id=hl-20-73><a class=lnlinks href=#hl-20-73> 73</a>
</span><span class=lnt id=hl-20-74><a class=lnlinks href=#hl-20-74> 74</a>
</span><span class=lnt id=hl-20-75><a class=lnlinks href=#hl-20-75> 75</a>
</span><span class=lnt id=hl-20-76><a class=lnlinks href=#hl-20-76> 76</a>
</span><span class=lnt id=hl-20-77><a class=lnlinks href=#hl-20-77> 77</a>
</span><span class=lnt id=hl-20-78><a class=lnlinks href=#hl-20-78> 78</a>
</span><span class=lnt id=hl-20-79><a class=lnlinks href=#hl-20-79> 79</a>
</span><span class=lnt id=hl-20-80><a class=lnlinks href=#hl-20-80> 80</a>
</span><span class=lnt id=hl-20-81><a class=lnlinks href=#hl-20-81> 81</a>
</span><span class=lnt id=hl-20-82><a class=lnlinks href=#hl-20-82> 82</a>
</span><span class=lnt id=hl-20-83><a class=lnlinks href=#hl-20-83> 83</a>
</span><span class=lnt id=hl-20-84><a class=lnlinks href=#hl-20-84> 84</a>
</span><span class=lnt id=hl-20-85><a class=lnlinks href=#hl-20-85> 85</a>
</span><span class=lnt id=hl-20-86><a class=lnlinks href=#hl-20-86> 86</a>
</span><span class=lnt id=hl-20-87><a class=lnlinks href=#hl-20-87> 87</a>
</span><span class=lnt id=hl-20-88><a class=lnlinks href=#hl-20-88> 88</a>
</span><span class=lnt id=hl-20-89><a class=lnlinks href=#hl-20-89> 89</a>
</span><span class=lnt id=hl-20-90><a class=lnlinks href=#hl-20-90> 90</a>
</span><span class=lnt id=hl-20-91><a class=lnlinks href=#hl-20-91> 91</a>
</span><span class=lnt id=hl-20-92><a class=lnlinks href=#hl-20-92> 92</a>
</span><span class=lnt id=hl-20-93><a class=lnlinks href=#hl-20-93> 93</a>
</span><span class=lnt id=hl-20-94><a class=lnlinks href=#hl-20-94> 94</a>
</span><span class=lnt id=hl-20-95><a class=lnlinks href=#hl-20-95> 95</a>
</span><span class=lnt id=hl-20-96><a class=lnlinks href=#hl-20-96> 96</a>
</span><span class=lnt id=hl-20-97><a class=lnlinks href=#hl-20-97> 97</a>
</span><span class=lnt id=hl-20-98><a class=lnlinks href=#hl-20-98> 98</a>
</span><span class=lnt id=hl-20-99><a class=lnlinks href=#hl-20-99> 99</a>
</span><span class=lnt id=hl-20-100><a class=lnlinks href=#hl-20-100>100</a>
</span><span class=lnt id=hl-20-101><a class=lnlinks href=#hl-20-101>101</a>
</span><span class=lnt id=hl-20-102><a class=lnlinks href=#hl-20-102>102</a>
</span><span class=lnt id=hl-20-103><a class=lnlinks href=#hl-20-103>103</a>
</span><span class=lnt id=hl-20-104><a class=lnlinks href=#hl-20-104>104</a>
</span><span class=lnt id=hl-20-105><a class=lnlinks href=#hl-20-105>105</a>
</span><span class=lnt id=hl-20-106><a class=lnlinks href=#hl-20-106>106</a>
</span><span class=lnt id=hl-20-107><a class=lnlinks href=#hl-20-107>107</a>
</span><span class=lnt id=hl-20-108><a class=lnlinks href=#hl-20-108>108</a>
</span><span class=lnt id=hl-20-109><a class=lnlinks href=#hl-20-109>109</a>
</span><span class=lnt id=hl-20-110><a class=lnlinks href=#hl-20-110>110</a>
</span><span class=lnt id=hl-20-111><a class=lnlinks href=#hl-20-111>111</a>
</span><span class=lnt id=hl-20-112><a class=lnlinks href=#hl-20-112>112</a>
</span><span class=lnt id=hl-20-113><a class=lnlinks href=#hl-20-113>113</a>
</span><span class=lnt id=hl-20-114><a class=lnlinks href=#hl-20-114>114</a>
</span><span class=lnt id=hl-20-115><a class=lnlinks href=#hl-20-115>115</a>
</span><span class=lnt id=hl-20-116><a class=lnlinks href=#hl-20-116>116</a>
</span><span class=lnt id=hl-20-117><a class=lnlinks href=#hl-20-117>117</a>
</span><span class=lnt id=hl-20-118><a class=lnlinks href=#hl-20-118>118</a>
</span><span class=lnt id=hl-20-119><a class=lnlinks href=#hl-20-119>119</a>
</span><span class=lnt id=hl-20-120><a class=lnlinks href=#hl-20-120>120</a>
</span><span class=lnt id=hl-20-121><a class=lnlinks href=#hl-20-121>121</a>
</span><span class=lnt id=hl-20-122><a class=lnlinks href=#hl-20-122>122</a>
</span><span class=lnt id=hl-20-123><a class=lnlinks href=#hl-20-123>123</a>
</span><span class=lnt id=hl-20-124><a class=lnlinks href=#hl-20-124>124</a>
</span><span class=lnt id=hl-20-125><a class=lnlinks href=#hl-20-125>125</a>
</span><span class=lnt id=hl-20-126><a class=lnlinks href=#hl-20-126>126</a>
</span><span class=lnt id=hl-20-127><a class=lnlinks href=#hl-20-127>127</a>
</span><span class=lnt id=hl-20-128><a class=lnlinks href=#hl-20-128>128</a>
</span><span class=lnt id=hl-20-129><a class=lnlinks href=#hl-20-129>129</a>
</span><span class=lnt id=hl-20-130><a class=lnlinks href=#hl-20-130>130</a>
</span><span class=lnt id=hl-20-131><a class=lnlinks href=#hl-20-131>131</a>
</span><span class=lnt id=hl-20-132><a class=lnlinks href=#hl-20-132>132</a>
</span><span class=lnt id=hl-20-133><a class=lnlinks href=#hl-20-133>133</a>
</span><span class=lnt id=hl-20-134><a class=lnlinks href=#hl-20-134>134</a>
</span><span class=lnt id=hl-20-135><a class=lnlinks href=#hl-20-135>135</a>
</span><span class=lnt id=hl-20-136><a class=lnlinks href=#hl-20-136>136</a>
</span><span class=lnt id=hl-20-137><a class=lnlinks href=#hl-20-137>137</a>
</span><span class=lnt id=hl-20-138><a class=lnlinks href=#hl-20-138>138</a>
</span><span class=lnt id=hl-20-139><a class=lnlinks href=#hl-20-139>139</a>
</span><span class=lnt id=hl-20-140><a class=lnlinks href=#hl-20-140>140</a>
</span><span class=lnt id=hl-20-141><a class=lnlinks href=#hl-20-141>141</a>
</span><span class=lnt id=hl-20-142><a class=lnlinks href=#hl-20-142>142</a>
</span><span class=lnt id=hl-20-143><a class=lnlinks href=#hl-20-143>143</a>
</span><span class=lnt id=hl-20-144><a class=lnlinks href=#hl-20-144>144</a>
</span><span class=lnt id=hl-20-145><a class=lnlinks href=#hl-20-145>145</a>
</span><span class=lnt id=hl-20-146><a class=lnlinks href=#hl-20-146>146</a>
</span><span class=lnt id=hl-20-147><a class=lnlinks href=#hl-20-147>147</a>
</span><span class=lnt id=hl-20-148><a class=lnlinks href=#hl-20-148>148</a>
</span><span class=lnt id=hl-20-149><a class=lnlinks href=#hl-20-149>149</a>
</span><span class=lnt id=hl-20-150><a class=lnlinks href=#hl-20-150>150</a>
</span><span class=lnt id=hl-20-151><a class=lnlinks href=#hl-20-151>151</a>
</span><span class=lnt id=hl-20-152><a class=lnlinks href=#hl-20-152>152</a>
</span><span class=lnt id=hl-20-153><a class=lnlinks href=#hl-20-153>153</a>
</span><span class=lnt id=hl-20-154><a class=lnlinks href=#hl-20-154>154</a>
</span><span class=lnt id=hl-20-155><a class=lnlinks href=#hl-20-155>155</a>
</span><span class=lnt id=hl-20-156><a class=lnlinks href=#hl-20-156>156</a>
</span><span class=lnt id=hl-20-157><a class=lnlinks href=#hl-20-157>157</a>
</span><span class=lnt id=hl-20-158><a class=lnlinks href=#hl-20-158>158</a>
</span><span class=lnt id=hl-20-159><a class=lnlinks href=#hl-20-159>159</a>
</span><span class=lnt id=hl-20-160><a class=lnlinks href=#hl-20-160>160</a>
</span><span class=lnt id=hl-20-161><a class=lnlinks href=#hl-20-161>161</a>
</span><span class=lnt id=hl-20-162><a class=lnlinks href=#hl-20-162>162</a>
</span><span class=lnt id=hl-20-163><a class=lnlinks href=#hl-20-163>163</a>
</span><span class=lnt id=hl-20-164><a class=lnlinks href=#hl-20-164>164</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>IntegrityVerifier</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;파일 무결성 검증을 위한 클래스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>hash_algorithm</span><span class=o>=</span><span class=s1>&#39;sha256&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        초기화
</span></span></span><span class=line><span class=cl><span class=s2>        hash_algorithm: 사용할 해시 알고리즘
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>hash_algorithm</span> <span class=o>=</span> <span class=n>hash_algorithm</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>calculate_file_hash</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        파일의 해시값 계산
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        file_path: 해시를 계산할 파일 경로
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        반환: 파일의 해시값 (16진수 문자열)
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>hash_obj</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>hash_algorithm</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 메모리 효율성을 위해 청크 단위로 읽기</span>
</span></span><span class=line><span class=cl>            <span class=n>chunk</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>8192</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=n>chunk</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>hash_obj</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>chunk</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=mi>8192</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>hash_obj</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>generate_manifest</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>directory</span><span class=p>,</span> <span class=n>output_file</span><span class=o>=</span><span class=s1>&#39;integrity_manifest.json&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        디렉토리 내 모든 파일의 해시값이 포함된 무결성 매니페스트 생성
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        directory: 파일이 있는 디렉토리 경로
</span></span></span><span class=line><span class=cl><span class=s2>        output_file: 매니페스트를 저장할 파일 경로
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        반환: 매니페스트 데이터
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>manifest</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;created_at&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;hash_algorithm&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>hash_algorithm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;files&#39;</span><span class=p>:</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 디렉토리 내 모든 파일 처리</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>root</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>files</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>walk</span><span class=p>(</span><span class=n>directory</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>filename</span> <span class=ow>in</span> <span class=n>files</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># 매니페스트 파일 자체는 제외</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>filename</span> <span class=o>==</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>output_file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=k>continue</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=n>file_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>root</span><span class=p>,</span> <span class=n>filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=c1># 디렉토리 경로에 상대적인 파일 경로</span>
</span></span><span class=line><span class=cl>                <span class=n>relative_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>relpath</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>file_hash</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_file_hash</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>file_size</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>getsize</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>manifest</span><span class=p>[</span><span class=s1>&#39;files&#39;</span><span class=p>][</span><span class=n>relative_path</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;hash&#39;</span><span class=p>:</span> <span class=n>file_hash</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;size&#39;</span><span class=p>:</span> <span class=n>file_size</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>except</span> <span class=p>(</span><span class=ne>IOError</span><span class=p>,</span> <span class=ne>OSError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;파일 처리 중 오류 발생: </span><span class=si>{</span><span class=n>file_path</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 매니페스트 파일 저장</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_file</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>manifest</span><span class=p>,</span> <span class=n>f</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>manifest</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>verify_integrity</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>directory</span><span class=p>,</span> <span class=n>manifest_file</span><span class=o>=</span><span class=s1>&#39;integrity_manifest.json&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        매니페스트를 기반으로 파일 무결성 검증
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        directory: 검증할 파일이 있는 디렉토리
</span></span></span><span class=line><span class=cl><span class=s2>        manifest_file: 매니페스트 파일 경로
</span></span></span><span class=line><span class=cl><span class=s2>        
</span></span></span><span class=line><span class=cl><span class=s2>        반환: 검증 결과 딕셔너리
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 매니페스트 파일 로드</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>manifest_file</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>manifest</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=p>(</span><span class=ne>IOError</span><span class=p>,</span> <span class=n>json</span><span class=o>.</span><span class=n>JSONDecodeError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;error&#39;</span><span class=p>,</span> <span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;매니페스트 파일 로드 오류: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>results</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;success&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;algorithm&#39;</span><span class=p>:</span> <span class=n>manifest</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;hash_algorithm&#39;</span><span class=p>,</span> <span class=s1>&#39;unknown&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;verified_at&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_files&#39;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>manifest</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;files&#39;</span><span class=p>,</span> <span class=p>{})),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;verified_files&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;modified_files&#39;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;missing_files&#39;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;details&#39;</span><span class=p>:</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 각 파일 검증</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>relative_path</span><span class=p>,</span> <span class=n>file_info</span> <span class=ow>in</span> <span class=n>manifest</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;files&#39;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>file_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>directory</span><span class=p>,</span> <span class=n>relative_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>expected_hash</span> <span class=o>=</span> <span class=n>file_info</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;hash&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>results</span><span class=p>[</span><span class=s1>&#39;missing_files&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relative_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>results</span><span class=p>[</span><span class=s1>&#39;details&#39;</span><span class=p>][</span><span class=n>relative_path</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;missing&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;expected_hash&#39;</span><span class=p>:</span> <span class=n>expected_hash</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>actual_hash</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_file_hash</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>actual_hash</span> <span class=o>==</span> <span class=n>expected_hash</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;verified_files&#39;</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;details&#39;</span><span class=p>][</span><span class=n>relative_path</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;verified&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;hash&#39;</span><span class=p>:</span> <span class=n>actual_hash</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;modified_files&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>relative_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>results</span><span class=p>[</span><span class=s1>&#39;details&#39;</span><span class=p>][</span><span class=n>relative_path</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;modified&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;expected_hash&#39;</span><span class=p>:</span> <span class=n>expected_hash</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;actual_hash&#39;</span><span class=p>:</span> <span class=n>actual_hash</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=p>(</span><span class=ne>IOError</span><span class=p>,</span> <span class=ne>OSError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>results</span><span class=p>[</span><span class=s1>&#39;details&#39;</span><span class=p>][</span><span class=n>relative_path</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;error&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 검증 요약 계산</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>results</span><span class=p>[</span><span class=s1>&#39;missing_files&#39;</span><span class=p>]</span> <span class=ow>or</span> <span class=n>results</span><span class=p>[</span><span class=s1>&#39;modified_files&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>results</span><span class=p>[</span><span class=s1>&#39;status&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;failed&#39;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>results</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시 (실제 파일이 있다고 가정)</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>verifier = IntegrityVerifier()
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1># 무결성 매니페스트 생성
</span></span></span><span class=line><span class=cl><span class=s1>print(&#34;무결성 매니페스트 생성 중…&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>manifest = verifier.generate_manifest(&#34;./my_important_files&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1># 나중에 무결성 검증
</span></span></span><span class=line><span class=cl><span class=s1>print(&#34;</span><span class=se>\n</span><span class=s1>파일 무결성 검증 중…&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>results = verifier.verify_integrity(&#34;./my_important_files&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>if results[&#39;status&#39;] == &#39;success&#39;:
</span></span></span><span class=line><span class=cl><span class=s1>    print(&#34;모든 파일이 검증되었습니다.&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>else:
</span></span></span><span class=line><span class=cl><span class=s1>    print(&#34;무결성 검증 실패!&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>    if results[&#39;modified_files&#39;]:
</span></span></span><span class=line><span class=cl><span class=s1>        print(f&#34;변경된 파일: </span><span class=si>{results[&#39;modified_files&#39;]}</span><span class=s1>&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>    if results[&#39;missing_files&#39;]:
</span></span></span><span class=line><span class=cl><span class=s1>        print(f&#34;누락된 파일: </span><span class=si>{results[&#39;missing_files&#39;]}</span><span class=s1>&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>이 코드는 디렉토리 내 파일들의 무결성을 검증하기 위한 시스템을 보여준다.<br>초기에 모든 파일의 해시값이 포함된 매니페스트를 생성하고, 나중에 이 매니페스트를 사용하여 파일이 변경되거나 삭제되었는지 확인할 수 있다.</p><h3 id=개발자를-위한-해싱-보안-지침>개발자를 위한 해싱 보안 지침<a hidden class=anchor aria-hidden=true href=#개발자를-위한-해싱-보안-지침>#</a></h3><p>보안 관점에서 해싱을 효과적으로 활용하기 위한 핵심 지침</p><ol><li><strong>항상 최신 알고리즘 사용</strong>: 최신 보안 권장사항에 따라 강력한 해시 알고리즘(SHA-256, SHA-3, BLAKE2)을 사용한다.</li><li><strong>비밀번호는 특수 함수로 해싱</strong>: 일반 해시 함수 대신 비밀번호에 특화된 함수(bcrypt, Argon2, PBKDF2)를 사용한다.</li><li><strong>무작위 솔트 사용</strong>: 모든 해싱 작업에 충분히 길고 무작위적인 솔트를 사용한다.</li><li><strong>키 스트레칭 적용</strong>: 충분한 반복 횟수로 해싱 과정을 느리게 만들어 무차별 대입 공격을 어렵게 만든다.</li><li><strong>상수 시간 비교</strong>: 해시 비교 시 항상 상수 시간 비교 함수를 사용하여 타이밍 공격을 방지한다.</li><li><strong>보안 모범 사례 준수</strong>: 암호화 키와 솔트를 안전하게 관리하고, 정기적으로 보안 업데이트를 적용한다.</li><li><strong>라이브러리 활용</strong>: 가능하면 직접 구현하기보다 검증된 보안 라이브러리를 활용한다.</li><li><strong>데이터 무결성 확인</strong>: 중요한 파일이나 메시지에 해시 기반 무결성 검증을 적용한다.</li><li><strong>표준 포맷 사용</strong>: 해시값, 솔트, 알고리즘 정보 등을 표준화된 형식으로 저장한다.</li><li><strong>정기적인 보안 감사</strong>: 해싱 관련 코드와 구현을 정기적으로 감사하고 개선한다.</li></ol><p>개발자는 이러한 지침을 따름으로써 애플리케이션의 보안을 크게 향상시킬 수 있다.<br>해싱은 적절하게 구현될 때 데이터 보호와 인증의 강력한 도구가 된다.</p><h3 id=해싱의-미래와-발전-방향>해싱의 미래와 발전 방향<a hidden class=anchor aria-hidden=true href=#해싱의-미래와-발전-방향>#</a></h3><p>보안 해싱 기술은 계속 발전하고 있다.</p><ol><li><p>양자 저항성 해시 함수<br>양자 컴퓨터가 발전함에 따라 현재의 암호화 알고리즘이 취약해질 가능성이 있다. 이에 대비하여 양자 컴퓨터의 공격에도 안전한 양자 저항성(Quantum-Resistant) 해시 함수를 개발하는 연구가 진행되고 있다.<br>양자 컴퓨터는 Grover의 알고리즘을 통해 현재 해시 함수의 보안 강도를 약화시킬 수 있다. n비트 해시의 경우, 기존에는 2^n의 계산 복잡도가 필요했지만, 양자 컴퓨터에서는 2^(n/2)로 감소할 수 있다. 이에 대응하기 위해 더 긴 출력을 제공하는 해시 함수나 새로운 구조의 해시 함수가 필요하다.</p></li><li><p>메모리 하드(Memory-Hard) 해시 함수<br>많은 메모리를 필요로 하는 메모리 하드 해시 함수는 특수 하드웨어(ASIC, GPU 등)를 사용한 공격에 강한 저항성을 제공한다. 이러한 함수는 비밀번호 해싱에 특히 유용하다.<br>Argon2는 이러한 접근 방식의 대표적인 예로, 2015년 Password Hashing Competition에서 우승한 알고리즘이다.</p></li><li><p>블록체인과 해싱<br>블록체인 기술은 해싱에 크게 의존하며, 이로 인해 새로운 해싱 알고리즘과 응용 방법이 개발되고 있다.<br>블록체인에서는 해시 함수가 다음과 같은 역할을 한다:</p><ol><li><strong>블록 해싱</strong>: 각 블록의 고유 식별자를 생성</li><li><strong>작업 증명(Proof of Work)</strong>: 채굴 과정에서 특정 패턴을 가진 해시를 찾는 작업</li><li><strong>머클 트리(Merkle Tree)</strong>: 트랜잭션의 효율적인 무결성 검증</li></ol></li></ol><h3 id=해싱-관련-실수와-취약점-방지>해싱 관련 실수와 취약점 방지<a hidden class=anchor aria-hidden=true href=#해싱-관련-실수와-취약점-방지>#</a></h3><p>해싱을 구현할 때 흔히 발생하는 실수와 그 방지법:</p><ol><li><p>일반적인 실수</p><ol><li><strong>취약한 해시 알고리즘 사용</strong>: MD5, SHA-1과 같은 취약한 알고리즘 대신 SHA-256, SHA-3, BLAKE2와 같은 안전한 알고리즘을 사용해야 한다.</li><li><strong>솔트 없이 해싱</strong>: 모든 비밀번호 해싱에는 무작위 솔트를 사용해야 한다.</li><li><strong>키 스트레칭 생략</strong>: 비밀번호 해싱에는 반드시 키 스트레칭(PBKDF2, bcrypt, Argon2 등)을 적용해야 한다.</li><li><strong>고정된 솔트 사용</strong>: 솔트는 항상 무작위로 생성해야 하며, 고정된 솔트는 레인보우 테이블 공격에 취약한다.</li><li><strong>평문 비교를 통한 타이밍 공격 취약성</strong>: 해시 비교 시 항상 상수 시간 비교 함수를 사용해야 한다.</li></ol></li><li><p>안전한 해싱을 위한 체크리스트</p><ol><li><strong>최신 해시 알고리즘 사용</strong>: SHA-256 이상의 안전한 알고리즘</li><li><strong>무작위 솔트 적용</strong>: 각 비밀번호마다 고유한 솔트</li><li><strong>키 스트레칭 적용</strong>: 충분한 반복 횟수(최소 10,000회 이상)</li><li><strong>페퍼(추가 비밀값) 고려</strong>: 더 높은 보안이 필요한 경우</li><li><strong>상수 시간 비교</strong>: 타이밍 공격 방지</li><li><strong>안전한 난수 생성기</strong>: 예측 불가능한 솔트 생성</li><li><strong>솔트 길이</strong>: 최소 16바이트(128비트) 이상</li><li><strong>정기적인 업데이트</strong>: 발견된 취약점에 대응하여 알고리즘 업데이트</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span><span class=lnt id=hl-21-11><a class=lnlinks href=#hl-21-11>11</a>
</span><span class=lnt id=hl-21-12><a class=lnlinks href=#hl-21-12>12</a>
</span><span class=lnt id=hl-21-13><a class=lnlinks href=#hl-21-13>13</a>
</span><span class=lnt id=hl-21-14><a class=lnlinks href=#hl-21-14>14</a>
</span><span class=lnt id=hl-21-15><a class=lnlinks href=#hl-21-15>15</a>
</span><span class=lnt id=hl-21-16><a class=lnlinks href=#hl-21-16>16</a>
</span><span class=lnt id=hl-21-17><a class=lnlinks href=#hl-21-17>17</a>
</span><span class=lnt id=hl-21-18><a class=lnlinks href=#hl-21-18>18</a>
</span><span class=lnt id=hl-21-19><a class=lnlinks href=#hl-21-19>19</a>
</span><span class=lnt id=hl-21-20><a class=lnlinks href=#hl-21-20>20</a>
</span><span class=lnt id=hl-21-21><a class=lnlinks href=#hl-21-21>21</a>
</span><span class=lnt id=hl-21-22><a class=lnlinks href=#hl-21-22>22</a>
</span><span class=lnt id=hl-21-23><a class=lnlinks href=#hl-21-23>23</a>
</span><span class=lnt id=hl-21-24><a class=lnlinks href=#hl-21-24>24</a>
</span><span class=lnt id=hl-21-25><a class=lnlinks href=#hl-21-25>25</a>
</span><span class=lnt id=hl-21-26><a class=lnlinks href=#hl-21-26>26</a>
</span><span class=lnt id=hl-21-27><a class=lnlinks href=#hl-21-27>27</a>
</span><span class=lnt id=hl-21-28><a class=lnlinks href=#hl-21-28>28</a>
</span><span class=lnt id=hl-21-29><a class=lnlinks href=#hl-21-29>29</a>
</span><span class=lnt id=hl-21-30><a class=lnlinks href=#hl-21-30>30</a>
</span><span class=lnt id=hl-21-31><a class=lnlinks href=#hl-21-31>31</a>
</span><span class=lnt id=hl-21-32><a class=lnlinks href=#hl-21-32>32</a>
</span><span class=lnt id=hl-21-33><a class=lnlinks href=#hl-21-33>33</a>
</span><span class=lnt id=hl-21-34><a class=lnlinks href=#hl-21-34>34</a>
</span><span class=lnt id=hl-21-35><a class=lnlinks href=#hl-21-35>35</a>
</span><span class=lnt id=hl-21-36><a class=lnlinks href=#hl-21-36>36</a>
</span><span class=lnt id=hl-21-37><a class=lnlinks href=#hl-21-37>37</a>
</span><span class=lnt id=hl-21-38><a class=lnlinks href=#hl-21-38>38</a>
</span><span class=lnt id=hl-21-39><a class=lnlinks href=#hl-21-39>39</a>
</span><span class=lnt id=hl-21-40><a class=lnlinks href=#hl-21-40>40</a>
</span><span class=lnt id=hl-21-41><a class=lnlinks href=#hl-21-41>41</a>
</span><span class=lnt id=hl-21-42><a class=lnlinks href=#hl-21-42>42</a>
</span><span class=lnt id=hl-21-43><a class=lnlinks href=#hl-21-43>43</a>
</span><span class=lnt id=hl-21-44><a class=lnlinks href=#hl-21-44>44</a>
</span><span class=lnt id=hl-21-45><a class=lnlinks href=#hl-21-45>45</a>
</span><span class=lnt id=hl-21-46><a class=lnlinks href=#hl-21-46>46</a>
</span><span class=lnt id=hl-21-47><a class=lnlinks href=#hl-21-47>47</a>
</span><span class=lnt id=hl-21-48><a class=lnlinks href=#hl-21-48>48</a>
</span><span class=lnt id=hl-21-49><a class=lnlinks href=#hl-21-49>49</a>
</span><span class=lnt id=hl-21-50><a class=lnlinks href=#hl-21-50>50</a>
</span><span class=lnt id=hl-21-51><a class=lnlinks href=#hl-21-51>51</a>
</span><span class=lnt id=hl-21-52><a class=lnlinks href=#hl-21-52>52</a>
</span><span class=lnt id=hl-21-53><a class=lnlinks href=#hl-21-53>53</a>
</span><span class=lnt id=hl-21-54><a class=lnlinks href=#hl-21-54>54</a>
</span><span class=lnt id=hl-21-55><a class=lnlinks href=#hl-21-55>55</a>
</span><span class=lnt id=hl-21-56><a class=lnlinks href=#hl-21-56>56</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>secure_hashing_checklist</span><span class=p>(</span><span class=n>password</span><span class=p>,</span> <span class=n>use_pepper</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;안전한 해싱 구현을 위한 체크리스트 예시&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 1. 최신 해시 알고리즘 사용</span>
</span></span><span class=line><span class=cl>    <span class=n>hash_algorithm</span> <span class=o>=</span> <span class=s1>&#39;sha256&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 2. 무작위 솔트 적용 (16바이트)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 6. 안전한 난수 생성기 사용</span>
</span></span><span class=line><span class=cl>    <span class=n>salt</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 4. 선택적 페퍼 적용</span>
</span></span><span class=line><span class=cl>    <span class=n>pepper</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;SECRET_PEPPER&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=k>if</span> <span class=n>use_pepper</span> <span class=k>else</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 3. 키 스트레칭 적용 (100,000회 반복)</span>
</span></span><span class=line><span class=cl>    <span class=n>iterations</span> <span class=o>=</span> <span class=mi>100000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 해싱 수행</span>
</span></span><span class=line><span class=cl>    <span class=n>password_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>pbkdf2_hmac</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>hash_algorithm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=o>+</span> <span class=n>pepper</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>salt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>iterations</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 저장 형식: 알고리즘$반복횟수$솔트$해시</span>
</span></span><span class=line><span class=cl>    <span class=n>salt_b64</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>salt</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>hash_b64</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>password_hash</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>stored_hash</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>hash_algorithm</span><span class=si>}</span><span class=s2>$</span><span class=si>{</span><span class=n>iterations</span><span class=si>}</span><span class=s2>$</span><span class=si>{</span><span class=n>salt_b64</span><span class=si>}</span><span class=s2>$</span><span class=si>{</span><span class=n>hash_b64</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>stored_hash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify_with_checklist</span><span class=p>(</span><span class=n>stored_hash</span><span class=p>,</span> <span class=n>password</span><span class=p>,</span> <span class=n>use_pepper</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;안전한 검증 구현을 위한 체크리스트 예시&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 저장된 해시에서 정보 추출</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>algorithm</span><span class=p>,</span> <span class=n>iterations</span><span class=p>,</span> <span class=n>salt_b64</span><span class=p>,</span> <span class=n>hash_b64</span> <span class=o>=</span> <span class=n>stored_hash</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;$&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>iterations</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>iterations</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>salt</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>salt_b64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>stored_password_hash</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64decode</span><span class=p>(</span><span class=n>hash_b64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 페퍼 적용 (저장하지 않고 환경 변수에서 가져옴)</span>
</span></span><span class=line><span class=cl>        <span class=n>pepper</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;SECRET_PEPPER&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=k>if</span> <span class=n>use_pepper</span> <span class=k>else</span> <span class=sa>b</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 동일한 방식으로 해싱</span>
</span></span><span class=line><span class=cl>        <span class=n>password_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>pbkdf2_hmac</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>algorithm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span> <span class=o>+</span> <span class=n>pepper</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>salt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>iterations</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 5. 상수 시간 비교로 타이밍 공격 방지</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>hmac</span><span class=o>.</span><span class=n>compare_digest</span><span class=p>(</span><span class=n>stored_password_hash</span><span class=p>,</span> <span class=n>password_hash</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=p>(</span><span class=ne>ValueError</span><span class=p>,</span> <span class=ne>IndexError</span><span class=p>,</span> <span class=n>base64</span><span class=o>.</span><span class=n>binascii</span><span class=o>.</span><span class=n>Error</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 잘못된 형식의 해시</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Fundamentals of Hashing</h2></header><div class=entry-content><p></p></div><footer class=entry-footer>0 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Fundamentals of Hashing" href=https://buenhyden.github.io/posts/security-engineering/cryptography/hashing/fundamentals/></a></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>