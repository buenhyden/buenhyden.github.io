<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>보안 코딩 (Secure Coding) | hyunyoun's Blog</title><meta name=keywords content="Software-Design-and-Architecture,Secure-Coding"><meta name=description content="Secure Coding은 소프트웨어 개발 과정에서 보안 취약점을 최소화하고 안전한 소프트웨어를 만들기 위한 코딩 기법이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/security-engineering/web-and-application-security/secure-coding/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/security-engineering/web-and-application-security/secure-coding/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/security-engineering/web-and-application-security/secure-coding/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="보안 코딩 (Secure Coding)"><meta property="og:description" content="Secure Coding은 소프트웨어 개발 과정에서 보안 취약점을 최소화하고 안전한 소프트웨어를 만들기 위한 코딩 기법이다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-19T01:33:00+00:00"><meta property="article:modified_time" content="2024-09-19T01:33:00+00:00"><meta property="article:tag" content="Software-Design-and-Architecture"><meta property="article:tag" content="Secure-Coding"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="보안 코딩 (Secure Coding)"><meta name=twitter:description content="Secure Coding은 소프트웨어 개발 과정에서 보안 취약점을 최소화하고 안전한 소프트웨어를 만들기 위한 코딩 기법이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"보안 코딩 (Secure Coding)","item":"https://buenhyden.github.io/posts/security-engineering/web-and-application-security/secure-coding/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"보안 코딩 (Secure Coding)","name":"보안 코딩 (Secure Coding)","description":"Secure Coding은 소프트웨어 개발 과정에서 보안 취약점을 최소화하고 안전한 소프트웨어를 만들기 위한 코딩 기법이다.","keywords":["Software-Design-and-Architecture","Secure-Coding"],"articleBody":"보안 코딩 (Secure Coding) 보안 코딩은 소프트웨어 개발 과정에서 보안 취약점을 최소화하는 코딩 기법과 원칙을 적용하는 관행이다.\n이는 소프트웨어가 처음부터 보안을 고려하여 설계되고 구현되도록 하여 침해, 데이터 유출, 무단 접근 및 기타 보안 위협으로부터 시스템을 보호하는 것을 목표로 한다.\n보안 코딩은 소프트웨어 개발의 필수적인 부분이다. 점점 더 연결된 디지털 세계에서 안전한 소프트웨어를 구축하는 것은 모든 개발자의 기본적인 책임이 되었다.\n효과적인 보안 코딩을 위해서는 다음 원칙을 따라야 한다:\n보안은 설계부터: 개발 초기 단계부터 보안을 고려. 심층 방어: 여러 보안 계층을 구현하여 단일 실패 지점을 방지. 최소 권한: 필요한 최소한의 권한만 부여. 기본적으로 안전: 명시적인 권한 부여 없이는 접근을 거부. 지속적인 학습: 새로운 위협과 방어 기법에 대해 계속 배운다. 보안 코딩은 일회성 작업이 아니라 지속적인 과정이다.\n모든 개발자가 보안 코딩 원칙과 기법을 이해하고 실천하면, 더 안전한 디지털 생태계를 구축하는 데 기여할 수 있다.\n소프트웨어의 보안은 가장 취약한 구성 요소의 강도에 의해 결정됩니다. 따라서 코드의 모든 부분에서 보안 모범 사례를 일관되게 적용하는 것이 중요하다. 이를 통해 개인 정보, 기업 데이터, 그리고 전체 시스템의 무결성을 보호할 수 있다.\n보안 코딩의 중요성 현대 디지털 환경에서 보안 코딩이 중요한 이유는 다음과 같다:\n데이터 보호: 민감한 개인정보, 금융 데이터, 기업 기밀 등을 무단 접근과 유출로부터 보호한다. 비용 절감: 개발 초기 단계에서 보안을 고려하는 것이 나중에 취약점을 수정하는 것보다 비용 효율적이다. IBM에 따르면, 설계 단계에서 보안 결함을 해결하는 비용은 운영 단계에서 해결하는 비용의 약 6분의 1이다. 법적 규정 준수: GDPR, HIPAA, PCI DSS와 같은 다양한 규제 프레임워크는 기업이 특정 보안 표준을 준수할 것을 요구한다.. 평판 보호: 보안 위반은 기업의 평판에 심각한 손상을 초래할 수 있으며, 고객 신뢰 상실로 이어질 수 있다. 비즈니스 연속성: 보안 사고는 서비스 중단, 데이터 손실, 법적 제재 등을 초래하여 비즈니스 운영에 심각한 영향을 미칠 수 있다. 주요 보안 취약점 OWASP(Open Web Application Security Project)는 가장 일반적인 웹 애플리케이션 보안 위험 목록인 “OWASP Top 10\"을 발표한다.\n2021년 기준 OWASP Top 10은 다음과 같다:\n취약한 접근 제어(Broken Access Control): 사용자가 권한 없이 다른 사용자의 계정, 파일, 데이터에 접근할 수 있는 경우. 암호화 실패(Cryptographic Failures): 민감한 데이터를 충분히 보호하지 않거나 암호화가 약하게 구현된 경우. 인젝션(Injection): SQL, NoSQL, OS, LDAP 인젝션 등이 이에 해당한다. 신뢰할 수 없는 데이터가 명령어나 쿼리의 일부로 해석기에 전송될 때 발생한다. 불안전한 설계(Insecure Design): 설계 단계에서 보안을 충분히 고려하지 않은 경우이다. 보안 설정 오류(Security Misconfiguration): 기본 설정이나 불완전한 설정, 개방된 클라우드 저장소, 불필요한 HTTP 헤더 등이 포함된다. 취약하고 오래된 구성요소(Vulnerable and Outdated Components): 취약점이 알려진 오래된 라이브러리, 프레임워크, 소프트웨어 모듈을 사용하는 경우이다. 식별 및 인증 실패(Identification and Authentication Failures): 사용자 신원, 인증, 세션 관리 관련 함수가 잘못 구현되어 공격자가 비밀번호, 키, 세션 토큰을 탈취하거나 다른 구현 결함을 악용할 수 있는 경우. 소프트웨어 및 데이터 무결성 실패(Software and Data Integrity Failures): 코드와 인프라가 소프트웨어 업데이트, 중요 데이터, CI/CD 파이프라인 등과 관련된 무결성 검증 없이 작동하는 경우. 보안 로깅 및 모니터링 실패(Security Logging and Monitoring Failures): 로깅과 모니터링이 부족하거나 효과적인 대응이 이루어지지 않는 경우. 서버 측 요청 위조(Server-Side Request Forgery): 웹 애플리케이션이 사용자가 제공한 URL의 유효성을 검사하지 않고 원격 리소스를 가져올 때 발생. 보안 코딩 원칙 안전한 소프트웨어를 개발하기 위한 핵심 원칙은 다음과 같다:\n최소 권한의 원칙 (Principle of Least Privilege)\n사용자, 프로그램, 프로세스는 작업을 수행하는 데 필요한 최소한의 권한만 부여받아야 한다.\n이는 권한 오용의 영향을 제한하고 취약점 발생 시 피해를 최소화한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 // Java에서 최소 권한 원칙 적용 예시 // 필요할 때만 관리자 권한 상승 public void performTask() { // 일반 권한으로 작업 수행 regularWork(); try { // 필요한 경우에만 임시적으로 권한 상승 SecurityManager.elevatePrivileges(); privilegedWork(); } finally { // 권한 작업 완료 후 즉시 권한 원복 SecurityManager.dropPrivileges(); } } 심층 방어 (Defense in Depth)\n단일 보안 제어에 의존하지 않고 여러 방어 계층을 구현하여 한 계층이 뚫리더라도 다른 계층이 보호를 유지하도록 한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 # Python에서 심층 방어 예시 def process_user_request(request): # 1단계: 입력 검증 if not validate_request_format(request): return \"Invalid request format\" # 2단계: 인증 if not authenticate_user(request.user_id, request.token): log_authentication_failure(request) return \"Authentication failed\" # 3단계: 권한 부여 if not authorize_action(request.user_id, request.action): log_authorization_failure(request) return \"Unauthorized action\" # 4단계: 입력 샌드박스 처리 및 이스케이프 sanitized_data = sanitize_input(request.data) # 5단계: 실행 및 모니터링 result = execute_action(sanitized_data) log_action_execution(request, result) return result 안전한 기본값 (Secure by Default)\n소프트웨어는 기본적으로 보안을 유지하도록 구성해야 한다.\n사용자가 새 기능을 활성화할 때까지 안전한 상태를 유지해야 한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 // JavaScript에서 안전한 기본값 예시 const createUserConfig = (userOptions = {}) =\u003e { // 안전한 기본값을 먼저 정의 const defaultConfig = { allowExternalConnections: false, enableEncryption: true, maxLoginAttempts: 5, sessionTimeout: 15 * 60 * 1000, // 15분 requireStrongPasswords: true }; // 사용자 옵션으로 기본값 덮어쓰기 return { …defaultConfig, …userOptions }; }; 데이터 검증 (Data Validation)\n모든 입력 데이터는 사용하기 전에 유효성을 검사해야 한다. 이는 클라이언트와 서버 측 모두에서 수행해야 한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 // C#에서 데이터 검증 예시 public void ProcessUserInput(string username, string email, int age) { // 빈 값 체크 if (string.IsNullOrEmpty(username) || string.IsNullOrEmpty(email)) throw new ArgumentException(\"Username and email are required\"); // 형식 검증 if (!Regex.IsMatch(username, \"^[a-zA-Z0-9_]{3,20}$\")) throw new ArgumentException(\"Username must be 3-20 alphanumeric characters or underscores\"); if (!Regex.IsMatch(email, @\"^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$\")) throw new ArgumentException(\"Invalid email format\"); // 범위 검증 if (age \u003c 18 || age \u003e 120) throw new ArgumentException(\"Age must be between 18 and 120\"); // 검증 통과 후 처리 SaveUserData(username, email, age); } 적절한 인증 및 인가 (Proper Authentication and Authorization)\n사용자 신원을 확인하고(인증) 해당 사용자가 특정 리소스나 기능에 접근할 수 있는 권한이 있는지(인가) 확인하는 강력한 메커니즘을 구현한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # Python Flask에서 인증 및 인가 예시 @app.route('/admin/dashboard') def admin_dashboard(): # 인증: 사용자가 로그인되어 있는지 확인 if not current_user.is_authenticated: return redirect(url_for('login')) # 인가: 사용자가 관리자 권한을 가지고 있는지 확인 if not current_user.has_role('admin'): flash('Unauthorized access attempt recorded') log_security_event('unauthorized_access', user=current_user.id) return redirect(url_for('home')) # 인증 및 인가 성공 return render_template('admin/dashboard.html') 실패 안전 (Fail Secure)\n오류가 발생할 경우, 시스템은 안전한 상태로 되돌아가야 한다.\n오류가 보안을 약화시키거나 민감한 정보를 노출해서는 안 된다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 // Java에서 실패 안전 예시 public void processTransaction(Transaction transaction) { try { // 트랜잭션 처리 validateTransaction(transaction); authorizeTransaction(transaction); completeTransaction(transaction); logSuccess(transaction); } catch (ValidationException e) { // 유효성 검사 실패 - 안전하게 처리 logError(\"Validation error\", e); notifyUser(\"Transaction could not be processed\"); return; } catch (AuthorizationException e) { // 권한 부여 실패 - 안전하게 처리 logError(\"Authorization error\", e); notifyUser(\"Transaction not authorized\"); return; } catch (Exception e) { // 예상치 못한 오류 - 안전하게 처리 logError(\"Unexpected error in transaction\", e); rollbackTransaction(transaction); notifyUser(\"System error occurred, transaction cancelled\"); notifyAdmin(\"Unexpected transaction error\"); return; } } 비밀 유지하지 않기 (No Security Through Obscurity)\n암호화 알고리즘, 키, 비밀번호와 같은 핵심 보안 요소는 시스템의 비공개 부분에 의존해서는 안 된다.\n시스템은 내부 작동이 노출되더라도 안전해야 한다.\n완전한 중개 (Complete Mediation)\n모든 리소스 접근은 각 접근 시도마다 인증과 인가를 거쳐야 한다.\n이전 접근 결정에 의존하는 캐싱 메커니즘은 신중하게 설계해야 한다.\n보안 코딩 관행 효과적인 보안 코딩을 위한 주요 실천 사항:\n코드 리뷰\n보안에 중점을 둔 코드 리뷰 프로세스를 구현한다.\n이는 보안 결함을 조기에 발견하고 수정하는 데 도움이 된다.\n정적 코드 분석\n정적 분석 도구를 사용하여 실행 전에 코드에서 보안 취약점을 식별한다:\nJava: FindBugs, SonarQube, Checkmarx Python: Bandit, PyLint JavaScript: ESLint, SonarQube C/C++: Coverity, Cppcheck 동적 분석\n애플리케이션이 실행 중일 때 보안 취약점을 발견하기 위해 동적 분석을 수행한다:\n퍼징(Fuzzing): 무작위 또는 조작된 입력으로 프로그램을 테스트하여 충돌이나 취약점 발견 침투 테스트: 실제 공격자처럼 시스템을 테스트 보안 스캐닝: OWASP ZAP, Burp Suite와 같은 도구를 사용하여 웹 애플리케이션 취약점 스캔 의존성 관리\n모든 라이브러리와 프레임워크를 정기적으로 업데이트하고 알려진 취약점이 있는 종속성을 모니터링한다:\nNode.js: npm audit Java: OWASP Dependency Check Python: Safety 안전한 배포 프로세스\n배포 과정의 각 단계에서 보안을 통합한다:\n개발 환경에서 보안 시작 CI/CD 파이프라인에 자동화된 보안 테스트 통합 안전한 코드 서명 및 확인 취약점 모니터링을 위한 지속적인 감사 언어별 보안 코딩 기법 각 프로그래밍 언어는 자체적인 보안 위험과 모범 사례를 가지고 있다:\nJava Java는 메모리 안전성 기능이 내장되어 있지만 여전히 주의해야 할 사항이 있다:\n1 2 3 4 5 6 7 8 9 10 // 안전하지 않은 코드 String query = \"SELECT * FROM users WHERE username = '\" + userInput + \"'\"; Statement stmt = connection.createStatement(); ResultSet rs = stmt.executeQuery(query); // SQL 인젝션 위험 // 안전한 코드 String query = \"SELECT * FROM users WHERE username = ?\"; PreparedStatement stmt = connection.prepareStatement(query); stmt.setString(1, userInput); // 파라미터화된 쿼리 ResultSet rs = stmt.executeQuery(); 입력 검증: 모든 사용자 입력을 신뢰하지 말고 검증한다. 매개변수화된 쿼리: SQL 인젝션을 방지하기 위해 항상 PreparedStatement를 사용한다. 안전한 직렬화: readObject() 메서드를 오버라이드하여 안전한 역직렬화를 보장한다. 접근 제어: 클래스와 메서드에 적절한 접근 수정자(private, protected 등)를 사용한다. Python Python은 사용하기 쉽지만 몇 가지 주의할 보안 문제가 있다:\n1 2 3 4 5 6 7 8 9 # 안전하지 않은 코드 user_data = request.GET.get('user_input') eval(user_data) # 코드 인젝션 위험 # 안전한 코드 import ast user_data = request.GET.get('user_input') # 안전한 평가를 위해 ast.literal_eval 사용 safe_data = ast.literal_eval(user_data) 안전하지 않은 함수 사용 자제: eval(), exec(), os.system() 등의 사용을 피하거나 신중하게 사용한다. 매개변수화된 SQL: SQL 인젝션 방지를 위해 ORM이나 매개변수화된 쿼리를 사용한다. 패키지 보안: 신뢰할 수 있는 소스의 라이브러리만 사용하고 정기적으로 업데이트한다. YAML 보안: 안전하지 않은 YAML 로더 대신 yaml.safe_load()를 사용한다. JavaScript/Node.js 웹 환경에서 JavaScript는 고유한 보안 문제를 가지고 있다:\n1 2 3 4 5 6 7 8 9 // 안전하지 않은 코드 const userInput = req.body.input; const html = '' + userInput + ''; // XSS 위험 // 안전한 코드 const userInput = req.body.input; const DOMPurify = require('dompurify'); const cleanHtml = DOMPurify.sanitize(userInput); const html = '' + cleanHtml + ''; 크로스 사이트 스크립팅(XSS) 방지: 사용자 입력을 출력할 때 항상 이스케이프 처리한다. CSRF 방지: 상태 변경 요청에 고유한 토큰을 사용한다. 안전한 의존성 관리: 정기적으로 npm 패키지를 감사하고 업데이트한다. 컨텐츠 보안 정책(CSP): 스크립트 실행을 제한하는 CSP 헤더를 구현한다. 보안 코딩의 언어별 도구 및 프레임워크 Java 보안 도구 Spring Security: 인증, 권한 부여, 보안 취약점 방지를 위한 강력한 프레임워크\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Spring Security 기본 구성 예제 @Configuration @EnableWebSecurity public class SecurityConfig extends WebSecurityConfigurerAdapter { @Override protected void configure(HttpSecurity http) throws Exception { http .authorizeRequests() .antMatchers(\"/\", \"/home\").permitAll() .antMatchers(\"/admin/**\").hasRole(\"ADMIN\") .anyRequest().authenticated() .and() .formLogin() .loginPage(\"/login\") .permitAll() .and() .logout() .permitAll() .and() .csrf() // CSRF 보호 활성화 .and() .headers() .contentSecurityPolicy(\"default-src 'self'\") // CSP 설정 .and() .frameOptions().deny(); // 클릭재킹 방지 } } OWASP Dependency-Check: Maven 및 Gradle 플러그인으로 프로젝트 종속성의 알려진 취약점을 스캔\nFindBugs/SpotBugs: 정적 코드 분석 도구로 잠재적 버그와 보안 취약점 탐지\nSonarQube: 코드 품질 및 보안 규칙 위반 검사\nPython 보안 도구 Bandit: Python 코드에서 일반적인 보안 이슈를 찾는 정적 분석 도구\n1 2 3 # Bandit 사용 예시 pip install bandit bandit -r path/to/your/code Flask-Security: Flask 애플리케이션에 보안 기능 추가\nDjango Security Middleware: 기본적으로 XSS, CSRF, 클릭재킹 등에 대한 보호 제공\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # Django settings.py 보안 설정 예시 MIDDLEWARE = [ 'django.middleware.security.SecurityMiddleware', # 기타 미들웨어… ] # 보안 설정 SECURE_HSTS_SECONDS = 3600 SECURE_HSTS_INCLUDE_SUBDOMAINS = True SECURE_CONTENT_TYPE_NOSNIFF = True SECURE_BROWSER_XSS_FILTER = True SECURE_SSL_REDIRECT = True SESSION_COOKIE_SECURE = True CSRF_COOKIE_SECURE = True X_FRAME_OPTIONS = 'DENY' Safety: 설치된 Python 패키지에서 알려진 보안 취약점 확인\nJavaScript/Node.js 보안 도구 Helmet.js: HTTP 헤더 설정을 통해 Express.js 애플리케이션의 보안 강화\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // Helmet.js 사용 예시 const express = require('express'); const helmet = require('helmet'); const app = express(); // 기본 보안 헤더 설정 app.use(helmet()); // 특정 보안 정책 추가 구성 app.use( helmet.contentSecurityPolicy({ directives: { defaultSrc: [\"'self'\"], scriptSrc: [\"'self'\", \"trusted-cdn.com\"] } }) ); ESLint와 보안 플러그인: 보안 관련 코드 품질 문제 감지\nnpm audit: 프로젝트 종속성의 알려진 취약점 스캔\n1 2 3 # npm audit 사용 예시 npm audit npm audit fix # 가능한 경우 취약점 자동 수정 OWASP ZAP: 웹 애플리케이션 보안 취약점 탐지 및 테스트\n일반적인 보안 코딩 실수 및 방지법 하드코딩된 비밀 (Hardcoded Secrets) 문제: 소스 코드에 API 키, 비밀번호, 암호화 키 등을 직접 포함시키는 것은 코드가 노출될 경우 심각한 보안 위험을 초래한다.\n1 2 3 4 5 // 안전하지 않은 코드 - 하드코딩된 비밀 public class DatabaseConnection { private static final String DB_PASSWORD = \"SuperSecretP@ssw0rd\"; // ... } 해결책: 환경 변수, 보안 키 저장소, 암호화된 구성 파일 등을 사용하여 민감한 정보를 코드와 분리한다.\n1 2 3 4 5 6 7 8 // 안전한 코드 - 외부 구성 사용 public class DatabaseConnection { private static String getDbPassword() { // 환경 변수, 보안 키 저장소 또는 암호화된 구성 파일에서 가져오기 return System.getenv(\"DB_PASSWORD\"); } // ... } 부적절한 오류 처리 (Improper Error Handling) 문제: 상세한 오류 메시지가 사용자에게 노출되면 시스템 내부 정보를 유출할 수 있다.\n1 2 3 4 5 6 // 안전하지 않은 코드 - 상세한 오류 정보 노출 try { // 데이터베이스 작업 } catch (Exception $e) { echo \"Error: \" . $e-\u003egetMessage() . \" in \" . $e-\u003egetFile() . \" on line \" . $e-\u003egetLine(); } 해결책: 사용자에게는 일반적인 오류 메시지를 표시하고, 상세한 오류 정보는 로그에만 기록한다.\n1 2 3 4 5 6 7 8 9 10 // 안전한 코드 - 일반적인 오류 메시지 표시 try { // 데이터베이스 작업 } catch (Exception $e) { // 로그에만 상세 정보 기록 error_log(\"Database error: \" . $e-\u003egetMessage() . \" in \" . $e-\u003egetFile() . \" on line \" . $e-\u003egetLine()); // 사용자에게는 일반적인 메시지 표시 echo \"An error occurred processing your request. Please try again later.\"; } 안전하지 않은 직접 객체 참조 (Insecure Direct Object References) 문제: 사용자가 직접 데이터베이스 키나 파일 이름과 같은 내부 객체 참조를 조작할 수 있는 경우 발생.\n1 2 3 4 5 6 7 // 안전하지 않은 코드 - 객체 ID 직접 사용 app.get('/documents/:id', (req, res) =\u003e { const documentId = req.params.id; // 권한 검사 없이 문서 반환 const document = getDocumentById(documentId); res.json(document); }); 해결책: 사용자 입력을 간접적인 참조로 매핑하고, 접근 제어 검사를 시행.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // 안전한 코드 - 권한 검사 추가 app.get('/documents/:id', (req, res) =\u003e { const documentId = req.params.id; // 현재 로그인한 사용자 확인 const currentUser = req.user; // 사용자가 해당 문서에 접근할 권한이 있는지 확인 if (!hasAccessToDocument(currentUser, documentId)) { return res.status(403).json({ error: 'Access denied' }); } // 권한이 확인된 후 문서 반환 const document = getDocumentById(documentId); res.json(document); }); 안전하지 않은 역직렬화 (Insecure Deserialization) 문제: 신뢰할 수 없는 소스의 데이터를 검증 없이 역직렬화하면 원격 코드 실행, 서비스 거부 등의 공격에 취약해진다.\n1 2 3 4 5 6 7 8 9 // 안전하지 않은 코드 - 검증 없는 역직렬화 public Object deserializeObject(byte[] data) { try (ByteArrayInputStream bais = new ByteArrayInputStream(data); ObjectInputStream ois = new ObjectInputStream(bais)) { return ois.readObject(); // 위험한 역직렬화 } catch (Exception e) { return null; } } 해결책: 역직렬화 전에 데이터를 검증하고, 안전한 대안(JSON 등)을 사용하거나 신뢰할 수 있는 소스의 데이터만 역직렬화한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 // 안전한 코드 - 타입 필터링과 검증 public Object deserializeObject(byte[] data, Class\u003c?\u003e expectedType) { try (ByteArrayInputStream bais = new ByteArrayInputStream(data); ObjectInputStreamWithFilter ois = new ObjectInputStreamWithFilter(bais)) { // 허용된 클래스만 역직렬화 허용 ois.setObjectInputFilter(info -\u003e { Class\u003c?\u003e clazz = info.serialClass(); if (clazz != null \u0026\u0026 !expectedType.isAssignableFrom(clazz)) { return ObjectInputFilter.Status.REJECTED; } return ObjectInputFilter.Status.ALLOWED; }); return ois.readObject(); } catch (Exception e) { // 오류 로깅 return null; } } 안전한 웹 통신 구현 HTTPS 구현\n모든 웹 애플리케이션은 HTTPS를 사용하여 전송 계층 보안을 보장해야 한다:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 // Node.js에서 HTTPS 서버 구현 const https = require('https'); const fs = require('fs'); const express = require('express'); const app = express(); // SSL 인증서 로드 const options = { key: fs.readFileSync('path/to/private/key.pem'), cert: fs.readFileSync('path/to/certificate.pem'), ciphers: 'TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256', // 강력한 암호화 알고리즘 지정 minVersion: 'TLSv1.2' // 최소 TLS 버전 설정 }; // HTTPS 서버 생성 https.createServer(options, app).listen(443, () =\u003e { console.log('HTTPS server running on port 443'); }); // HTTP에서 HTTPS로 리다이렉션 const http = require('http'); http.createServer((req, res) =\u003e { res.writeHead(301, { 'Location': 'https://' + req.headers.host + req.url }); res.end(); }).listen(80); 보안 쿠키 설정\n쿠키에는 Secure, HttpOnly, SameSite 플래그를 설정하여 보안을 강화해야 한다:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 // Express.js에서 보안 쿠키 설정 const session = require('express-session'); app.use(session({ secret: 'your-secret-key', resave: false, saveUninitialized: true, cookie: { secure: true, // HTTPS에서만 쿠키 전송 httpOnly: true, // JavaScript에서 쿠키 접근 방지 sameSite: 'strict', // CSRF 공격 방지 maxAge: 3600000 // 쿠키 만료 시간 (1시간) } })); CORS(Cross-Origin Resource Sharing) 올바르게 구성\n허용된 도메인에서만 리소스 접근을 허용하도록 CORS를 구성한다:\n1 2 3 4 5 6 7 8 9 10 11 12 13 // Express.js에서 CORS 구성 const cors = require('cors'); // 특정 출처만 허용 const corsOptions = { origin: ['https://trusted-site.com', 'https://another-trusted-site.com'], methods: ['GET', 'POST'], allowedHeaders: ['Content-Type', 'Authorization'], credentials: true, maxAge: 86400 // 프리플라이트 요청 캐싱 시간 }; app.use(cors(corsOptions)); 콘텐츠 보안 정책(CSP) 구현\nCSP는 XSS 공격과 같은 코드 인젝션 공격을 방지하는 데 도움이 된다:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // Express.js에서 CSP 헤더 설정 const helmet = require('helmet'); app.use(helmet.contentSecurityPolicy({ directives: { defaultSrc: [\"'self'\"], // 기본적으로 같은 출처의 리소스만 허용 scriptSrc: [\"'self'\", 'trusted-scripts.com'], // 스크립트 허용 출처 styleSrc: [\"'self'\", 'trusted-styles.com', \"'unsafe-inline'\"], // 스타일 허용 출처 imgSrc: [\"'self'\", 'data:', 'trusted-images.com'], // 이미지 허용 출처 connectSrc: [\"'self'\", 'api.trusted-site.com'], // AJAX, WebSocket 허용 출처 fontSrc: [\"'self'\", 'fonts.googleapis.com'], // 폰트 허용 출처 objectSrc: [\"'none'\"], // , , 태그 차단 mediaSrc: [\"'self'\"], // 오디오/비디오 허용 출처 frameSrc: [\"'none'\"], // , 차단 reportUri: '/csp-violation-report' // 위반 보고 엔드포인트 } })); 클라우드 환경에서의 보안 코딩 클라우드 환경은 추가적인 보안 고려사항이 필요하다:\n안전한 클라우드 구성\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # AWS CloudFormation 보안 구성 예시 Resources: S3Bucket: Type: AWS::S3::Bucket Properties: BucketName: my-secure-bucket AccessControl: Private PublicAccessBlockConfiguration: BlockPublicAcls: true BlockPublicPolicy: true IgnorePublicAcls: true RestrictPublicBuckets: true BucketEncryption: ServerSideEncryptionConfiguration: - ServerSideEncryptionByDefault: SSEAlgorithm: AES256 권한 관리 (IAM)\n최소 권한 원칙을 적용하여 필요한 권한만 부여:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 // AWS IAM 정책 예시 - 최소 권한 { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Action\": [ \"s3:GetObject\", \"s3:PutObject\" ], \"Resource\": \"arn:aws:s3:::my-bucket/my-app/*\", \"Condition\": { \"StringEquals\": { \"aws:SourceVpc\": \"vpc-12345678\" } } } ] } 보안 네트워킹\n클라우드 네트워크를 안전하게 구성:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # AWS CloudFormation을 사용한 보안 VPC 구성 Resources: MyVPC: Type: AWS::EC2::VPC Properties: CidrBlock: 10.0.0.0/16 EnableDnsSupport: true EnableDnsHostnames: true PrivateSubnet: Type: AWS::EC2::Subnet Properties: VpcId: !Ref MyVPC CidrBlock: 10.0.1.0/24 MapPublicIpOnLaunch: false SecurityGroup: Type: AWS::EC2::SecurityGroup Properties: GroupDescription: Restricted Security Group VpcId: !Ref MyVPC SecurityGroupIngress: - IpProtocol: tcp FromPort: 443 ToPort: 443 CidrIp: 0.0.0.0/0 비밀 관리\nAWS Secrets Manager, Azure Key Vault, Google Secret Manager와 같은 클라우드 비밀 관리 서비스를 사용:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # AWS Secrets Manager 사용 예시 import boto3 import json def get_secret(): secret_name = \"my-app/database-credentials\" region_name = \"us-west-2\" session = boto3.session.Session() client = session.client( service_name='secretsmanager', region_name=region_name ) try: get_secret_value_response = client.get_secret_value( SecretId=secret_name ) # 복호화된 비밀 정보 반환 if 'SecretString' in get_secret_value_response: secret = get_secret_value_response['SecretString'] return json.loads(secret) except Exception as e: # 오류 처리 raise e 마이크로서비스 및 API 보안 마이크로서비스 아키텍처에서의 보안 고려사항:\nAPI 게이트웨이 보안\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // Express.js에서 API 게이트웨이 보안 미들웨어 const rateLimit = require('express-rate-limit'); const helmet = require('helmet'); // 속도 제한 설정 const apiLimiter = rateLimit({ windowMs: 15 * 60 * 1000, // 15분 max: 100, // 15분당 최대 100개 요청 standardHeaders: true, // RateLimit 헤더 반환 legacyHeaders: false, // X-RateLimit 헤더 비활성화 message: 'Too many requests from this IP, please try again after 15 minutes' }); // API 경로에 보안 미들웨어 적용 app.use('/api/', apiLimiter); app.use(helmet()); 서비스 간 인증\n마이크로서비스 간 통신 보안을 위해 JWT 또는 mTLS 사용:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 // Spring Boot에서 JWT 인증 설정 @Configuration @EnableWebSecurity public class SecurityConfig extends WebSecurityConfigurerAdapter { @Autowired private JwtTokenProvider jwtTokenProvider; @Override protected void configure(HttpSecurity http) throws Exception { http .csrf().disable() .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS) .and() .authorizeRequests() .antMatchers(\"/public/**\").permitAll() .antMatchers(\"/api/v1/**\").hasRole(\"SERVICE\") .anyRequest().authenticated() .and() .apply(new JwtConfigurer(jwtTokenProvider)); } } mTLS(상호 TLS) 구현\n서비스 간 통신에 mTLS를 사용하여 양방향 인증 보장:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 // Spring Boot에서 mTLS 구성 @Configuration public class MtlsConfig { @Bean public ServletWebServerFactory servletContainer() { TomcatServletWebServerFactory tomcat = new TomcatServletWebServerFactory(); tomcat.addConnectorCustomizers(connector -\u003e { connector.setScheme(\"https\"); connector.setSecure(true); Http11NioProtocol protocol = (Http11NioProtocol) connector.getProtocolHandler(); protocol.setSSLEnabled(true); protocol.setClientAuth(\"true\"); // 클라이언트 인증 요구 // 키스토어 및 트러스트스토어 설정 protocol.setKeystoreFile(\"/path/to/keystore.jks\"); protocol.setKeystorePass(\"keystorePassword\"); protocol.setTruststoreFile(\"/path/to/truststore.jks\"); protocol.setTruststorePass(\"truststorePassword\"); protocol.setKeyAlias(\"tomcat\"); }); return tomcat; } } API 권한 관리\n세분화된 API 접근 제어를 구현:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 # Python FastAPI에서 권한 기반 접근 제어 from fastapi import FastAPI, Depends, HTTPException, status from fastapi.security import OAuth2PasswordBearer from jose import JWTError, jwt from pydantic import BaseModel from typing import List, Optional app = FastAPI() oauth2_scheme = OAuth2PasswordBearer(tokenUrl=\"token\") # 사용자 모델 class User(BaseModel): username: str email: str roles: List[str] = [] disabled: Optional[bool] = None # 토큰에서 사용자 정보 추출 def get_current_user(token: str = Depends(oauth2_scheme)): credentials_exception = HTTPException( status_code=status.HTTP_401_UNAUTHORIZED, detail=\"Invalid authentication credentials\", headers={\"WWW-Authenticate\": \"Bearer\"}, ) try: payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM]) username: str = payload.get(\"sub\") if username is None: raise credentials_exception user = get_user_from_db(username) if user is None: raise credentials_exception return user except JWTError: raise credentials_exception # 권한 확인 함수 def has_role(required_role: str): def role_checker(user: User = Depends(get_current_user)): if required_role not in user.roles: raise HTTPException( status_code=status.HTTP_403_FORBIDDEN, detail=\"Insufficient permissions\" ) return user return role_checker # 엔드포인트 예제 @app.get(\"/admin/users\", dependencies=[Depends(has_role(\"ADMIN\"))]) async def get_users(): return {\"users\": get_all_users()} @app.get(\"/api/items\", dependencies=[Depends(has_role(\"USER\"))]) async def get_items(): return {\"items\": get_all_items()} IoT 기기를 위한 보안 코딩 IoT 디바이스는 특별한 보안 고려사항이 필요:\n안전한 부팅 및 펌웨어 업데이트\n디지털 서명을 통한 펌웨어 무결성 검증:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 // C에서 펌웨어 서명 확인 #include #include int verify_firmware_signature(const unsigned char *firmware_data, size_t firmware_len, const unsigned char *signature, size_t sig_len, const char *public_key_path) { FILE *key_file = fopen(public_key_path, \"r\"); if (!key_file) { return -1; // 키 파일 열기 실패 } // 공개 키 로드 EVP_PKEY *public_key = PEM_read_PUBKEY(key_file, NULL, NULL, NULL); fclose(key_file); if (!public_key) { return -1; // 공개 키 로드 실패 } // 서명 확인 컨텍스트 생성 EVP_MD_CTX *ctx = EVP_MD_CTX_new(); int result = -1; if (ctx) { // 서명 확인 초기화 if (EVP_VerifyInit(ctx, EVP_sha256()) == 1) { // 펌웨어 데이터 업데이트 if (EVP_VerifyUpdate(ctx, firmware_data, firmware_len) == 1) { // 서명 확인 if (EVP_VerifyFinal(ctx, signature, sig_len, public_key) == 1) { result = 0; // 서명 확인 성공 } } } EVP_MD_CTX_free(ctx); } EVP_PKEY_free(public_key); return result; } 안전한 통신\nTLS를 사용한 IoT 기기 통신 보안:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 // C에서 mbedTLS를 사용한 TLS 클라이언트 구현 #include \"mbedtls/net_sockets.h\" #include \"mbedtls/ssl.h\" #include \"mbedtls/entropy.h\" #include \"mbedtls/ctr_drbg.h\" #include \"mbedtls/error.h\" #include \"mbedtls/certs.h\" int secure_connect_to_server(const char *server, const char *port) { mbedtls_net_context server_fd; mbedtls_ssl_context ssl; mbedtls_ssl_config conf; mbedtls_entropy_context entropy; mbedtls_ctr_drbg_context ctr_drbg; const char *pers = \"ssl_client\"; // 초기화 mbedtls_net_init(\u0026server_fd); mbedtls_ssl_init(\u0026ssl); mbedtls_ssl_config_init(\u0026conf); mbedtls_entropy_init(\u0026entropy); mbedtls_ctr_drbg_init(\u0026ctr_drbg); // 난수 생성기 시드 설정 if (mbedtls_ctr_drbg_seed(\u0026ctr_drbg, mbedtls_entropy_func, \u0026entropy, (const unsigned char *)pers, strlen(pers)) != 0) { return -1; } // 서버에 연결 if (mbedtls_net_connect(\u0026server_fd, server, port, MBEDTLS_NET_PROTO_TCP) != 0) { return -1; } // SSL/TLS 설정 if (mbedtls_ssl_config_defaults(\u0026conf, MBEDTLS_SSL_IS_CLIENT, MBEDTLS_SSL_TRANSPORT_STREAM, MBEDTLS_SSL_PRESET_DEFAULT) != 0) { return -1; } // 인증서 확인을 선택 사항으로 설정 (프로덕션에서는 필수로 설정해야 함) mbedtls_ssl_conf_authmode(\u0026conf, MBEDTLS_SSL_VERIFY_OPTIONAL); mbedtls_ssl_conf_rng(\u0026conf, mbedtls_ctr_drbg_random, \u0026ctr_drbg); // SSL/TLS 설정 적용 if (mbedtls_ssl_setup(\u0026ssl, \u0026conf) != 0) { return -1; } // 호스트 이름 설정 (필수) if (mbedtls_ssl_set_hostname(\u0026ssl, server) != 0) { return -1; } // SSL/TLS 입출력 설정 mbedtls_ssl_set_bio(\u0026ssl, \u0026server_fd, mbedtls_net_send, mbedtls_net_recv, NULL); // 핸드셰이크 수행 while (mbedtls_ssl_handshake(\u0026ssl) != 0) { // 핸드셰이크 재시도 } // 이제 ssl_write와 ssl_read를 사용하여 통신 가능 // 사용 후 리소스 정리 mbedtls_ssl_close_notify(\u0026ssl); mbedtls_net_free(\u0026server_fd); mbedtls_ssl_free(\u0026ssl); mbedtls_ssl_config_free(\u0026conf); mbedtls_ctr_drbg_free(\u0026ctr_drbg); mbedtls_entropy_free(\u0026entropy); return 0; } 데이터 저장 암호화\nIoT 기기에서 민감한 데이터 암호화:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 // C에서 데이터 암호화 #include #include int encrypt_data(const unsigned char *plaintext, int plaintext_len, const unsigned char *key, const unsigned char *iv, unsigned char *ciphertext) { EVP_CIPHER_CTX *ctx = EVP_CIPHER_CTX_new(); int len = 0; int ciphertext_len = 0; // 암호화 컨텍스트 초기화 if (!EVP_EncryptInit_ex(ctx, EVP_aes_256_cbc(), NULL, key, iv)) { EVP_CIPHER_CTX_free(ctx); return -1; } // 암호화 수행 if (!EVP_EncryptUpdate(ctx, ciphertext, \u0026len, plaintext, plaintext_len)) { EVP_CIPHER_CTX_free(ctx); return -1; } ciphertext_len = len; // 암호화 종료 if (!EVP_EncryptFinal_ex(ctx, ciphertext + len, \u0026len)) { EVP_CIPHER_CTX_free(ctx); return -1; } ciphertext_len += len; // 정리 EVP_CIPHER_CTX_free(ctx); return ciphertext_len; } 안전한 리소스 관리\n메모리, CPU, 네트워크 등의 리소스 사용을 제한하여 DoS 공격 방지:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 // C에서 리소스 제한 설정 #include int set_resource_limits() { struct rlimit rlim; // CPU 시간 제한 설정 rlim.rlim_cur = 10; // 10초 rlim.rlim_max = 20; // 최대 20초 if (setrlimit(RLIMIT_CPU, \u0026rlim) != 0) { return -1; } // 메모리 사용량 제한 rlim.rlim_cur = 10 * 1024 * 1024; // 10MB rlim.rlim_max = 15 * 1024 * 1024; // 최대 15MB if (setrlimit(RLIMIT_AS, \u0026rlim) != 0) { return -1; } // 파일 개수 제한 rlim.rlim_cur = 100; rlim.rlim_max = 100; if (setrlimit(RLIMIT_NOFILE, \u0026rlim) != 0) { return -1; } return 0; } 인젝션 공격 방어 인젝션 공격은 가장 흔하고 위험한 웹 애플리케이션 보안 취약점 중 하나:\nSQL 인젝션 방지\n1 2 3 4 5 6 7 8 // 안전하지 않은 코드 String query = \"SELECT * FROM users WHERE username = '\" + username + \"' AND password = '\" + password + \"'\"; // 안전한 코드 String query = \"SELECT * FROM users WHERE username = ? AND password = ?\"; PreparedStatement stmt = connection.prepareStatement(query); stmt.setString(1, username); stmt.setString(2, password); 명령어 인젝션 방지\n1 2 3 4 5 6 # 안전하지 않은 코드 os.system(\"ping \" + user_input) # 안전한 코드 import subprocess subprocess.run([\"ping\", user_input], capture_output=True, text=True, check=True) XSS 방지\n1 2 3 4 5 // 안전하지 않은 코드 element.innerHTML = userInput; // 안전한 코드 element.textContent = userInput; // 또는 적절한 이스케이프 라이브러리 사용 암호화 및 민감 데이터 처리 데이터 보호를 위한 암호화 모범 사례:\n강력한 암호화 알고리즘 사용\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 // Node.js에서 안전한 암호화 예시 const crypto = require('crypto'); function encryptData(data, key) { // 무작위 초기화 벡터(IV) 생성 const iv = crypto.randomBytes(16); // AES-256-GCM 암호화 (인증된 암호화) const cipher = crypto.createCipheriv('aes-256-gcm', key, iv); let encrypted = cipher.update(data, 'utf8', 'hex'); encrypted += cipher.final('hex'); // 인증 태그 획득 const authTag = cipher.getAuthTag().toString('hex'); // IV, 암호문, 인증 태그 반환 return { iv: iv.toString('hex'), encryptedData: encrypted, authTag: authTag }; } 안전한 비밀번호 관리\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 # Python에서 안전한 비밀번호 해싱 import hashlib import os import binascii def hash_password(password): # 솔트 생성 salt = os.urandom(32) # 키 스트레칭을 통한 해싱 iterations = 100000 hash_bytes = hashlib.pbkdf2_hmac( 'sha256', password.encode('utf-8'), salt, iterations ) # 솔트와 해시 저장 storage = salt.hex() + ':' + binascii.hexlify(hash_bytes).decode('utf-8') return storage def verify_password(stored_password, provided_password): # 저장된 비밀번호에서 솔트와 해시 추출 salt_hex, hash_hex = stored_password.split(':') salt = bytes.fromhex(salt_hex) # 제공된 비밀번호 해싱 iterations = 100000 hash_bytes = hashlib.pbkdf2_hmac( 'sha256', provided_password.encode('utf-8'), salt, iterations ) # 해시 비교 calculated_hash_hex = binascii.hexlify(hash_bytes).decode('utf-8') return hash_hex == calculated_hash_hex 전송 중 데이터 보호:\nHTTPS, TLS, SSH 등 안전한 통신 프로토콜을 사용.\n민감한 데이터 관리\n민감한 정보는 필요한 기간 동안만 메모리에 보관하고 사용 후 즉시 제거:\n1 2 3 4 5 6 7 8 9 10 // Java에서 민감한 데이터 관리 // 문자열 대신 char[] 사용 try { char[] password = getPasswordFromUser(); authenticateUser(password); // 사용 후 즉시 비밀번호 초기화 Arrays.fill(password, '0'); } catch (Exception e) { // 오류 처리 } 세션 관리 및 인증 안전한 세션 및 인증 관리 방법:\n강력한 세션 ID 생성\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 // PHP에서 안전한 세션 관리 // 세션 시작 전 보안 설정 ini_set('session.cookie_httponly', 1); ini_set('session.cookie_secure', 1); ini_set('session.use_only_cookies', 1); ini_set('session.cookie_samesite', 'Strict'); // 세션 시작 session_start(); // 새 세션일 경우 안전한 ID 재생성 if (empty($_SESSION['initialized'])) { session_regenerate_id(true); $_SESSION['initialized'] = true; } 다중 인증 구현\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 # Python Flask에서 2단계 인증 구현 import pyotp @app.route('/login', methods=['POST']) def login(): username = request.form['username'] password = request.form['password'] user = authenticate_credentials(username, password) if not user: return render_template('login.html', error='Invalid credentials') # 사용자가 2FA를 활성화했는지 확인 if user.two_factor_enabled: # 세션에 사용자 ID 저장하고 2FA 인증 페이지로 리디렉션 session['pending_user_id'] = user.id return redirect(url_for('two_factor_auth')) # 2FA가 활성화되지 않은 경우 바로 로그인 login_user(user) return redirect(url_for('dashboard')) @app.route('/2fa', methods=['GET', 'POST']) def two_factor_auth(): if 'pending_user_id' not in session: return redirect(url_for('login')) if request.method == 'POST': user = User.query.get(session['pending_user_id']) totp = pyotp.TOTP(user.otp_secret) if totp.verify(request.form['otp_code']): # 2FA 성공 del session['pending_user_id'] login_user(user) return redirect(url_for('dashboard')) return render_template('2fa.html', error='Invalid code') return render_template('2fa.html') 안전한 비밀번호 정책 시행\n최소 길이 요구 대소문자, 숫자, 특수 문자 조합 필요 흔한 비밀번호 및 이전에 사용한 비밀번호 거부 정기적인 비밀번호 변경 유도 (단, 너무 자주 변경 요구하지 않음) 안전한 코딩 관련 조직 및 표준 보안 코딩과 관련된 주요 조직 및 표준:\nOWASP (Open Web Application Security Project): 웹 애플리케이션 보안 커뮤니티로, 보안 위험 Top 10 목록, 테스트 가이드, 코드 리뷰 가이드 등을 제공. NIST (National Institute of Standards and Technology): 미국 표준 기술 연구소로, 사이버 보안 프레임워크 및 가이드라인을 발표. ISO/IEC 27034: 애플리케이션 보안에 관한 국제 표준. CERT Secure Coding Standards: 다양한 프로그래밍 언어에 대한 보안 코딩 표준과 가이드라인을 제공. CWE (Common Weakness Enumeration): 소프트웨어 보안 취약점의 공통 언어를 제공하는 목록. 개발자들이 코드에서 발생할 수 있는 일반적인 취약점을 이해하고 방지하는 데 도움을 준다. SANS (SysAdmin, Audit, Network, Security): 정보 보안 연구 및 교육 기관으로, 보안 코딩 지침과 교육 프로그램을 제공한다. PCI DSS (Payment Card Industry Data Security Standard): 신용카드 정보를 처리하는 모든 기업이 준수해야 하는 보안 표준. GDPR (General Data Protection Regulation): 유럽연합의 개인정보 보호 규정으로, 소프트웨어 개발에서 데이터 보호 및 개인정보 처리에 관한 요구사항을 규정한다. DevSecOps: 개발 수명 주기에 보안 통합 DevSecOps는 개발, 보안, 운영 팀이 협력하여 소프트웨어 개발 수명 주기 전반에 걸쳐 보안을 통합하는 방식:\n계획 및 요구사항 단계\n보안 요구사항 정의 위협 모델링 수행 보안 사용 사례 개발 개발 단계\n안전한 코딩 표준 적용 개발자 보안 교육 정적 코드 분석 도구 통합 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # GitLab CI/CD 파이프라인에 정적 분석 통합 예시 stages: - build - test - security - deploy security-scan: stage: security script: - npm audit # Node.js 종속성 검사 - sonar-scanner # SonarQube 분석 - owasp-dependency-check # OWASP 종속성 검사 artifacts: paths: - security-reports/ 테스트 단계\n자동화된 보안 테스트 수행 침투 테스트 취약점 스캐닝 1 2 3 4 5 6 7 8 # GitLab CI/CD에 동적 보안 테스트 통합 dynamic-security: stage: security script: - zap-baseline.py -t https://staging-app.example.com # OWASP ZAP 스캔 - nikto -h https://staging-app.example.com # Nikto 스캔 only: - master 배포 단계\n안전한 배포 프로세스 인프라 보안 검사 비밀 관리 자동화 1 2 3 4 5 6 7 # Docker 이미지 보안 스캔 container-scan: stage: security script: - trivy image myapp:latest # 컨테이너 취약점 스캔 only: - master 모니터링 및 대응 단계\n보안 모니터링 및 로깅 자동화된 보안 인시던트 대응 정기적인 보안 감사 보안 코딩 교육 및 문화 조직 내 보안 코딩 문화를 구축하기 위한 방법:\n개발자 교육\n정기적인 보안 코딩 교육과 훈련을 제공:\n보안 코딩 워크샵 온라인 학습 플랫폼 CTF(Capture The Flag) 경진대회 코드 리뷰 세션 보안 챔피언 프로그램\n각 개발 팀에 보안 챔피언을 지정하여 보안 관행을 촉진:\n보안 코드 리뷰 수행 팀 내 보안 지식 공유 보안 관련 질문에 대한 첫 번째 연락 지점 역할 지속적인 보안 평가\n애플리케이션 보안을 지속적으로 평가하고 개선:\n정기적인 보안 감사 자동화된 보안 스캔 침투 테스트 버그 바운티 프로그램 보안 코딩 가이드라인\n조직에 맞는 보안 코딩 가이드라인을 개발:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 # 회사 보안 코딩 가이드라인 예시 ## 1. 입력 검증 - 모든 사용자 입력은 서버 측에서 유효성을 검사해야 합니다. - 문자열에는 허용 목록(allowlist) 접근 방식을 사용합니다. - 숫자형 데이터는 범위를 검사합니다. - 파일 업로드는 확장자, 크기, 콘텐츠 유형을 검증합니다. ## 2. 데이터베이스 접근 - ORM 또는 매개변수화된 쿼리를 사용합니다. - 직접 문자열 연결로 쿼리를 구성하지 않습니다. - 최소 권한 데이터베이스 계정을 사용합니다. - 민감한 데이터는 항상 암호화합니다. ## 3. 인증 및 세션 관리 - 다중 요소 인증을 지원합니다. - 패스워드는 최소 12자리 이상이어야 합니다. - 세션 ID는 URL에 노출되지 않아야 합니다. - 세션 타임아웃을 적절하게 설정합니다. ## 4. 암호화 - 최신 암호화 알고리즘과 라이브러리를 사용합니다. - 자체 암호화 알고리즘을 만들지 않습니다. - 암호화 키는 안전하게 관리합니다. - 전송 중인 모든 데이터에 TLS를 사용합니다. 참고 및 출처 ","wordCount":"5701","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2024-09-19T01:33:00Z","dateModified":"2024-09-19T01:33:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/security-engineering/web-and-application-security/secure-coding/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a></div><h1 class="post-title entry-hint-parent">보안 코딩 (Secure Coding)</h1><div class=post-description>Secure Coding은 소프트웨어 개발 과정에서 보안 취약점을 최소화하고 안전한 소프트웨어를 만들기 위한 코딩 기법이다.</div><div class=post-meta><span title='2024-09-19 01:33:00 +0000 UTC'>September 19, 2024</span>&nbsp;·&nbsp;27 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/Security%20Engineering/Web%20and%20Application%20Security/secure-coding.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#보안-코딩-secure-coding>보안 코딩 (Secure Coding)</a><ul><li><a href=#보안-코딩의-중요성>보안 코딩의 중요성</a></li><li><a href=#주요-보안-취약점>주요 보안 취약점</a></li><li><a href=#보안-코딩-원칙>보안 코딩 원칙</a></li><li><a href=#보안-코딩-관행>보안 코딩 관행</a></li><li><a href=#언어별-보안-코딩-기법>언어별 보안 코딩 기법</a></li><li><a href=#보안-코딩의-언어별-도구-및-프레임워크>보안 코딩의 언어별 도구 및 프레임워크</a></li><li><a href=#일반적인-보안-코딩-실수-및-방지법>일반적인 보안 코딩 실수 및 방지법</a></li><li><a href=#안전한-웹-통신-구현>안전한 웹 통신 구현</a></li><li><a href=#클라우드-환경에서의-보안-코딩>클라우드 환경에서의 보안 코딩</a></li><li><a href=#마이크로서비스-및-api-보안>마이크로서비스 및 API 보안</a></li><li><a href=#iot-기기를-위한-보안-코딩>IoT 기기를 위한 보안 코딩</a></li><li><a href=#인젝션-공격-방어>인젝션 공격 방어</a></li><li><a href=#암호화-및-민감-데이터-처리>암호화 및 민감 데이터 처리</a></li><li><a href=#세션-관리-및-인증>세션 관리 및 인증</a></li><li><a href=#안전한-코딩-관련-조직-및-표준>안전한 코딩 관련 조직 및 표준</a></li><li><a href=#devsecops-개발-수명-주기에-보안-통합>DevSecOps: 개발 수명 주기에 보안 통합</a></li><li><a href=#보안-코딩-교육-및-문화>보안 코딩 교육 및 문화</a></li></ul></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=보안-코딩-secure-coding>보안 코딩 (Secure Coding)<a hidden class=anchor aria-hidden=true href=#보안-코딩-secure-coding>#</a></h2><p>보안 코딩은 소프트웨어 개발 과정에서 보안 취약점을 최소화하는 코딩 기법과 원칙을 적용하는 관행이다.<br>이는 소프트웨어가 처음부터 보안을 고려하여 설계되고 구현되도록 하여 침해, 데이터 유출, 무단 접근 및 기타 보안 위협으로부터 시스템을 보호하는 것을 목표로 한다.</p><p>보안 코딩은 소프트웨어 개발의 필수적인 부분이다. 점점 더 연결된 디지털 세계에서 안전한 소프트웨어를 구축하는 것은 모든 개발자의 기본적인 책임이 되었다.</p><p>효과적인 보안 코딩을 위해서는 다음 원칙을 따라야 한다:</p><ol><li><strong>보안은 설계부터</strong>: 개발 초기 단계부터 보안을 고려.</li><li><strong>심층 방어</strong>: 여러 보안 계층을 구현하여 단일 실패 지점을 방지.</li><li><strong>최소 권한</strong>: 필요한 최소한의 권한만 부여.</li><li><strong>기본적으로 안전</strong>: 명시적인 권한 부여 없이는 접근을 거부.</li><li><strong>지속적인 학습</strong>: 새로운 위협과 방어 기법에 대해 계속 배운다.</li></ol><p>보안 코딩은 일회성 작업이 아니라 지속적인 과정이다.<br>모든 개발자가 보안 코딩 원칙과 기법을 이해하고 실천하면, 더 안전한 디지털 생태계를 구축하는 데 기여할 수 있다.</p><p>소프트웨어의 보안은 가장 취약한 구성 요소의 강도에 의해 결정됩니다. 따라서 코드의 모든 부분에서 보안 모범 사례를 일관되게 적용하는 것이 중요하다. 이를 통해 개인 정보, 기업 데이터, 그리고 전체 시스템의 무결성을 보호할 수 있다.</p><h3 id=보안-코딩의-중요성>보안 코딩의 중요성<a hidden class=anchor aria-hidden=true href=#보안-코딩의-중요성>#</a></h3><p>현대 디지털 환경에서 보안 코딩이 중요한 이유는 다음과 같다:</p><ol><li><strong>데이터 보호</strong>: 민감한 개인정보, 금융 데이터, 기업 기밀 등을 무단 접근과 유출로부터 보호한다.</li><li><strong>비용 절감</strong>: 개발 초기 단계에서 보안을 고려하는 것이 나중에 취약점을 수정하는 것보다 비용 효율적이다. IBM에 따르면, 설계 단계에서 보안 결함을 해결하는 비용은 운영 단계에서 해결하는 비용의 약 6분의 1이다.</li><li><strong>법적 규정 준수</strong>: GDPR, HIPAA, PCI DSS와 같은 다양한 규제 프레임워크는 기업이 특정 보안 표준을 준수할 것을 요구한다..</li><li><strong>평판 보호</strong>: 보안 위반은 기업의 평판에 심각한 손상을 초래할 수 있으며, 고객 신뢰 상실로 이어질 수 있다.</li><li><strong>비즈니스 연속성</strong>: 보안 사고는 서비스 중단, 데이터 손실, 법적 제재 등을 초래하여 비즈니스 운영에 심각한 영향을 미칠 수 있다.</li></ol><h3 id=주요-보안-취약점>주요 보안 취약점<a hidden class=anchor aria-hidden=true href=#주요-보안-취약점>#</a></h3><p>OWASP(Open Web Application Security Project)는 가장 일반적인 웹 애플리케이션 보안 위험 목록인 &ldquo;OWASP Top 10"을 발표한다.<br>2021년 기준 OWASP Top 10은 다음과 같다:</p><ol><li><strong>취약한 접근 제어(Broken Access Control)</strong>: 사용자가 권한 없이 다른 사용자의 계정, 파일, 데이터에 접근할 수 있는 경우.</li><li><strong>암호화 실패(Cryptographic Failures)</strong>: 민감한 데이터를 충분히 보호하지 않거나 암호화가 약하게 구현된 경우.</li><li><strong>인젝션(Injection)</strong>: SQL, NoSQL, OS, LDAP 인젝션 등이 이에 해당한다. 신뢰할 수 없는 데이터가 명령어나 쿼리의 일부로 해석기에 전송될 때 발생한다.</li><li><strong>불안전한 설계(Insecure Design)</strong>: 설계 단계에서 보안을 충분히 고려하지 않은 경우이다.</li><li><strong>보안 설정 오류(Security Misconfiguration)</strong>: 기본 설정이나 불완전한 설정, 개방된 클라우드 저장소, 불필요한 HTTP 헤더 등이 포함된다.</li><li><strong>취약하고 오래된 구성요소(Vulnerable and Outdated Components)</strong>: 취약점이 알려진 오래된 라이브러리, 프레임워크, 소프트웨어 모듈을 사용하는 경우이다.</li><li><strong>식별 및 인증 실패(Identification and Authentication Failures)</strong>: 사용자 신원, 인증, 세션 관리 관련 함수가 잘못 구현되어 공격자가 비밀번호, 키, 세션 토큰을 탈취하거나 다른 구현 결함을 악용할 수 있는 경우.</li><li><strong>소프트웨어 및 데이터 무결성 실패(Software and Data Integrity Failures)</strong>: 코드와 인프라가 소프트웨어 업데이트, 중요 데이터, CI/CD 파이프라인 등과 관련된 무결성 검증 없이 작동하는 경우.</li><li><strong>보안 로깅 및 모니터링 실패(Security Logging and Monitoring Failures)</strong>: 로깅과 모니터링이 부족하거나 효과적인 대응이 이루어지지 않는 경우.</li><li><strong>서버 측 요청 위조(Server-Side Request Forgery)</strong>: 웹 애플리케이션이 사용자가 제공한 URL의 유효성을 검사하지 않고 원격 리소스를 가져올 때 발생.</li></ol><h3 id=보안-코딩-원칙>보안 코딩 원칙<a hidden class=anchor aria-hidden=true href=#보안-코딩-원칙>#</a></h3><p>안전한 소프트웨어를 개발하기 위한 핵심 원칙은 다음과 같다:</p><ol><li><p>최소 권한의 원칙 (Principle of Least Privilege)<br>사용자, 프로그램, 프로세스는 작업을 수행하는 데 필요한 최소한의 권한만 부여받아야 한다.<br>이는 권한 오용의 영향을 제한하고 취약점 발생 시 피해를 최소화한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Java에서 최소 권한 원칙 적용 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 필요할 때만 관리자 권한 상승</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>performTask</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 일반 권한으로 작업 수행</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>regularWork</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 필요한 경우에만 임시적으로 권한 상승</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SecurityManager</span><span class=p>.</span><span class=na>elevatePrivileges</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>privilegedWork</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 권한 작업 완료 후 즉시 권한 원복</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SecurityManager</span><span class=p>.</span><span class=na>dropPrivileges</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>심층 방어 (Defense in Depth)<br>단일 보안 제어에 의존하지 않고 여러 방어 계층을 구현하여 한 계층이 뚫리더라도 다른 계층이 보호를 유지하도록 한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16>16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17>17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18>18</a>
</span><span class=lnt id=hl-1-19><a class=lnlinks href=#hl-1-19>19</a>
</span><span class=lnt id=hl-1-20><a class=lnlinks href=#hl-1-20>20</a>
</span><span class=lnt id=hl-1-21><a class=lnlinks href=#hl-1-21>21</a>
</span><span class=lnt id=hl-1-22><a class=lnlinks href=#hl-1-22>22</a>
</span><span class=lnt id=hl-1-23><a class=lnlinks href=#hl-1-23>23</a>
</span><span class=lnt id=hl-1-24><a class=lnlinks href=#hl-1-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python에서 심층 방어 예시</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>process_user_request</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 1단계: 입력 검증</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>validate_request_format</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;Invalid request format&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 2단계: 인증</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>authenticate_user</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>user_id</span><span class=p>,</span> <span class=n>request</span><span class=o>.</span><span class=n>token</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>log_authentication_failure</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;Authentication failed&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 3단계: 권한 부여</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>authorize_action</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>user_id</span><span class=p>,</span> <span class=n>request</span><span class=o>.</span><span class=n>action</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>log_authorization_failure</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;Unauthorized action&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 4단계: 입력 샌드박스 처리 및 이스케이프</span>
</span></span><span class=line><span class=cl>    <span class=n>sanitized_data</span> <span class=o>=</span> <span class=n>sanitize_input</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 5단계: 실행 및 모니터링</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>execute_action</span><span class=p>(</span><span class=n>sanitized_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>log_action_execution</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>안전한 기본값 (Secure by Default)<br>소프트웨어는 기본적으로 보안을 유지하도록 구성해야 한다.<br>사용자가 새 기능을 활성화할 때까지 안전한 상태를 유지해야 한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// JavaScript에서 안전한 기본값 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>createUserConfig</span> <span class=o>=</span> <span class=p>(</span><span class=nx>userOptions</span> <span class=o>=</span> <span class=p>{})</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 안전한 기본값을 먼저 정의
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>defaultConfig</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>allowExternalConnections</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>enableEncryption</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>maxLoginAttempts</span><span class=o>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>sessionTimeout</span><span class=o>:</span> <span class=mi>15</span> <span class=o>*</span> <span class=mi>60</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>,</span> <span class=c1>// 15분
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>requireStrongPasswords</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 사용자 옵션으로 기본값 덮어쓰기
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=p>{</span> <span class=err>…</span><span class=nx>defaultConfig</span><span class=p>,</span> <span class=err>…</span><span class=nx>userOptions</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>데이터 검증 (Data Validation)<br>모든 입력 데이터는 사용하기 전에 유효성을 검사해야 한다. 이는 클라이언트와 서버 측 모두에서 수행해야 한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16>16</a>
</span><span class=lnt id=hl-3-17><a class=lnlinks href=#hl-3-17>17</a>
</span><span class=lnt id=hl-3-18><a class=lnlinks href=#hl-3-18>18</a>
</span><span class=lnt id=hl-3-19><a class=lnlinks href=#hl-3-19>19</a>
</span><span class=lnt id=hl-3-20><a class=lnlinks href=#hl-3-20>20</a>
</span><span class=lnt id=hl-3-21><a class=lnlinks href=#hl-3-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=c1>// C#에서 데이터 검증 예시</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>void</span> <span class=n>ProcessUserInput</span><span class=p>(</span><span class=kt>string</span> <span class=n>username</span><span class=p>,</span> <span class=kt>string</span> <span class=n>email</span><span class=p>,</span> <span class=kt>int</span> <span class=n>age</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 빈 값 체크</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=kt>string</span><span class=p>.</span><span class=n>IsNullOrEmpty</span><span class=p>(</span><span class=n>username</span><span class=p>)</span> <span class=p>||</span> <span class=kt>string</span><span class=p>.</span><span class=n>IsNullOrEmpty</span><span class=p>(</span><span class=n>email</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=n>ArgumentException</span><span class=p>(</span><span class=s>&#34;Username and email are required&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 형식 검증</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>Regex</span><span class=p>.</span><span class=n>IsMatch</span><span class=p>(</span><span class=n>username</span><span class=p>,</span> <span class=s>&#34;^[a-zA-Z0-9_]{3,20}$&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=n>ArgumentException</span><span class=p>(</span><span class=s>&#34;Username must be 3-20 alphanumeric characters or underscores&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>Regex</span><span class=p>.</span><span class=n>IsMatch</span><span class=p>(</span><span class=n>email</span><span class=p>,</span> <span class=s>@&#34;^[^@\s]+@[^@\s]+\.[^@\s]+$&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=n>ArgumentException</span><span class=p>(</span><span class=s>&#34;Invalid email format&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 범위 검증</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>age</span> <span class=p>&lt;</span> <span class=m>18</span> <span class=p>||</span> <span class=n>age</span> <span class=p>&gt;</span> <span class=m>120</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=n>ArgumentException</span><span class=p>(</span><span class=s>&#34;Age must be between 18 and 120&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 검증 통과 후 처리</span>
</span></span><span class=line><span class=cl>    <span class=n>SaveUserData</span><span class=p>(</span><span class=n>username</span><span class=p>,</span> <span class=n>email</span><span class=p>,</span> <span class=n>age</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>적절한 인증 및 인가 (Proper Authentication and Authorization)<br>사용자 신원을 확인하고(인증) 해당 사용자가 특정 리소스나 기능에 접근할 수 있는 권한이 있는지(인가) 확인하는 강력한 메커니즘을 구현한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python Flask에서 인증 및 인가 예시</span>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/admin/dashboard&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>admin_dashboard</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 인증: 사용자가 로그인되어 있는지 확인</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>current_user</span><span class=o>.</span><span class=n>is_authenticated</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;login&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 인가: 사용자가 관리자 권한을 가지고 있는지 확인</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>current_user</span><span class=o>.</span><span class=n>has_role</span><span class=p>(</span><span class=s1>&#39;admin&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>flash</span><span class=p>(</span><span class=s1>&#39;Unauthorized access attempt recorded&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>log_security_event</span><span class=p>(</span><span class=s1>&#39;unauthorized_access&#39;</span><span class=p>,</span> <span class=n>user</span><span class=o>=</span><span class=n>current_user</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;home&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 인증 및 인가 성공</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;admin/dashboard.html&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>실패 안전 (Fail Secure)<br>오류가 발생할 경우, 시스템은 안전한 상태로 되돌아가야 한다.<br>오류가 보안을 약화시키거나 민감한 정보를 노출해서는 안 된다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16>16</a>
</span><span class=lnt id=hl-5-17><a class=lnlinks href=#hl-5-17>17</a>
</span><span class=lnt id=hl-5-18><a class=lnlinks href=#hl-5-18>18</a>
</span><span class=lnt id=hl-5-19><a class=lnlinks href=#hl-5-19>19</a>
</span><span class=lnt id=hl-5-20><a class=lnlinks href=#hl-5-20>20</a>
</span><span class=lnt id=hl-5-21><a class=lnlinks href=#hl-5-21>21</a>
</span><span class=lnt id=hl-5-22><a class=lnlinks href=#hl-5-22>22</a>
</span><span class=lnt id=hl-5-23><a class=lnlinks href=#hl-5-23>23</a>
</span><span class=lnt id=hl-5-24><a class=lnlinks href=#hl-5-24>24</a>
</span><span class=lnt id=hl-5-25><a class=lnlinks href=#hl-5-25>25</a>
</span><span class=lnt id=hl-5-26><a class=lnlinks href=#hl-5-26>26</a>
</span><span class=lnt id=hl-5-27><a class=lnlinks href=#hl-5-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Java에서 실패 안전 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>processTransaction</span><span class=p>(</span><span class=n>Transaction</span><span class=w> </span><span class=n>transaction</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 트랜잭션 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>validateTransaction</span><span class=p>(</span><span class=n>transaction</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>authorizeTransaction</span><span class=p>(</span><span class=n>transaction</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>completeTransaction</span><span class=p>(</span><span class=n>transaction</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>logSuccess</span><span class=p>(</span><span class=n>transaction</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>ValidationException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 유효성 검사 실패 - 안전하게 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>logError</span><span class=p>(</span><span class=s>&#34;Validation error&#34;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>notifyUser</span><span class=p>(</span><span class=s>&#34;Transaction could not be processed&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>AuthorizationException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 권한 부여 실패 - 안전하게 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>logError</span><span class=p>(</span><span class=s>&#34;Authorization error&#34;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>notifyUser</span><span class=p>(</span><span class=s>&#34;Transaction not authorized&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 예상치 못한 오류 - 안전하게 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>logError</span><span class=p>(</span><span class=s>&#34;Unexpected error in transaction&#34;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>rollbackTransaction</span><span class=p>(</span><span class=n>transaction</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>notifyUser</span><span class=p>(</span><span class=s>&#34;System error occurred, transaction cancelled&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>notifyAdmin</span><span class=p>(</span><span class=s>&#34;Unexpected transaction error&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>비밀 유지하지 않기 (No Security Through Obscurity)<br>암호화 알고리즘, 키, 비밀번호와 같은 핵심 보안 요소는 시스템의 비공개 부분에 의존해서는 안 된다.<br>시스템은 내부 작동이 노출되더라도 안전해야 한다.</p></li><li><p>완전한 중개 (Complete Mediation)<br>모든 리소스 접근은 각 접근 시도마다 인증과 인가를 거쳐야 한다.<br>이전 접근 결정에 의존하는 캐싱 메커니즘은 신중하게 설계해야 한다.</p></li></ol><h3 id=보안-코딩-관행>보안 코딩 관행<a hidden class=anchor aria-hidden=true href=#보안-코딩-관행>#</a></h3><p>효과적인 보안 코딩을 위한 주요 실천 사항:</p><ol><li><p>코드 리뷰<br>보안에 중점을 둔 코드 리뷰 프로세스를 구현한다.<br>이는 보안 결함을 조기에 발견하고 수정하는 데 도움이 된다.</p></li><li><p>정적 코드 분석<br>정적 분석 도구를 사용하여 실행 전에 코드에서 보안 취약점을 식별한다:</p><ul><li>Java: FindBugs, SonarQube, Checkmarx</li><li>Python: Bandit, PyLint</li><li>JavaScript: ESLint, SonarQube</li><li>C/C++: Coverity, Cppcheck</li></ul></li><li><p>동적 분석<br>애플리케이션이 실행 중일 때 보안 취약점을 발견하기 위해 동적 분석을 수행한다:</p><ul><li>퍼징(Fuzzing): 무작위 또는 조작된 입력으로 프로그램을 테스트하여 충돌이나 취약점 발견</li><li>침투 테스트: 실제 공격자처럼 시스템을 테스트</li><li>보안 스캐닝: OWASP ZAP, Burp Suite와 같은 도구를 사용하여 웹 애플리케이션 취약점 스캔</li></ul></li><li><p>의존성 관리<br>모든 라이브러리와 프레임워크를 정기적으로 업데이트하고 알려진 취약점이 있는 종속성을 모니터링한다:</p><ul><li>Node.js: <code>npm audit</code></li><li>Java: OWASP Dependency Check</li><li>Python: Safety</li></ul></li><li><p>안전한 배포 프로세스<br>배포 과정의 각 단계에서 보안을 통합한다:</p><ul><li>개발 환경에서 보안 시작</li><li>CI/CD 파이프라인에 자동화된 보안 테스트 통합</li><li>안전한 코드 서명 및 확인</li><li>취약점 모니터링을 위한 지속적인 감사</li></ul></li></ol><h3 id=언어별-보안-코딩-기법>언어별 보안 코딩 기법<a hidden class=anchor aria-hidden=true href=#언어별-보안-코딩-기법>#</a></h3><p>각 프로그래밍 언어는 자체적인 보안 위험과 모범 사례를 가지고 있다:</p><h4 id=java>Java<a hidden class=anchor aria-hidden=true href=#java>#</a></h4><p>Java는 메모리 안전성 기능이 내장되어 있지만 여전히 주의해야 할 사항이 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT * FROM users WHERE username = &#39;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>userInput</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;&#39;&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Statement</span><span class=w> </span><span class=n>stmt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connection</span><span class=p>.</span><span class=na>createStatement</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>ResultSet</span><span class=w> </span><span class=n>rs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stmt</span><span class=p>.</span><span class=na>executeQuery</span><span class=p>(</span><span class=n>query</span><span class=p>);</span><span class=w>  </span><span class=c1>// SQL 인젝션 위험</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 안전한 코드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT * FROM users WHERE username = ?&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>PreparedStatement</span><span class=w> </span><span class=n>stmt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connection</span><span class=p>.</span><span class=na>prepareStatement</span><span class=p>(</span><span class=n>query</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>stmt</span><span class=p>.</span><span class=na>setString</span><span class=p>(</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>userInput</span><span class=p>);</span><span class=w>  </span><span class=c1>// 파라미터화된 쿼리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>ResultSet</span><span class=w> </span><span class=n>rs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stmt</span><span class=p>.</span><span class=na>executeQuery</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol><li><strong>입력 검증</strong>: 모든 사용자 입력을 신뢰하지 말고 검증한다.</li><li><strong>매개변수화된 쿼리</strong>: SQL 인젝션을 방지하기 위해 항상 PreparedStatement를 사용한다.</li><li><strong>안전한 직렬화</strong>: <code>readObject()</code> 메서드를 오버라이드하여 안전한 역직렬화를 보장한다.</li><li><strong>접근 제어</strong>: 클래스와 메서드에 적절한 접근 수정자(private, protected 등)를 사용한다.</li></ol><h4 id=python>Python<a hidden class=anchor aria-hidden=true href=#python>#</a></h4><p>Python은 사용하기 쉽지만 몇 가지 주의할 보안 문제가 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2>2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3>3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4>4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5>5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6>6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7>7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8>8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 안전하지 않은 코드</span>
</span></span><span class=line><span class=cl><span class=n>user_data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user_input&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>eval</span><span class=p>(</span><span class=n>user_data</span><span class=p>)</span>  <span class=c1># 코드 인젝션 위험</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 안전한 코드</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>ast</span>
</span></span><span class=line><span class=cl><span class=n>user_data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user_input&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 안전한 평가를 위해 ast.literal_eval 사용</span>
</span></span><span class=line><span class=cl><span class=n>safe_data</span> <span class=o>=</span> <span class=n>ast</span><span class=o>.</span><span class=n>literal_eval</span><span class=p>(</span><span class=n>user_data</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ol><li><strong>안전하지 않은 함수 사용 자제</strong>: <code>eval()</code>, <code>exec()</code>, <code>os.system()</code> 등의 사용을 피하거나 신중하게 사용한다.</li><li><strong>매개변수화된 SQL</strong>: SQL 인젝션 방지를 위해 ORM이나 매개변수화된 쿼리를 사용한다.</li><li><strong>패키지 보안</strong>: 신뢰할 수 있는 소스의 라이브러리만 사용하고 정기적으로 업데이트한다.</li><li><strong>YAML 보안</strong>: 안전하지 않은 YAML 로더 대신 <code>yaml.safe_load()</code>를 사용한다.</li></ol><h4 id=javascriptnodejs>JavaScript/Node.js<a hidden class=anchor aria-hidden=true href=#javascriptnodejs>#</a></h4><p>웹 환경에서 JavaScript는 고유한 보안 문제를 가지고 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6>6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7>7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8>8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>userInput</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>input</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>html</span> <span class=o>=</span> <span class=s1>&#39;&lt;div&gt;&#39;</span> <span class=o>+</span> <span class=nx>userInput</span> <span class=o>+</span> <span class=s1>&#39;&lt;/div&gt;&#39;</span><span class=p>;</span>  <span class=c1>// XSS 위험
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 안전한 코드
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>userInput</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>input</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>DOMPurify</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;dompurify&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cleanHtml</span> <span class=o>=</span> <span class=nx>DOMPurify</span><span class=p>.</span><span class=nx>sanitize</span><span class=p>(</span><span class=nx>userInput</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>html</span> <span class=o>=</span> <span class=s1>&#39;&lt;div&gt;&#39;</span> <span class=o>+</span> <span class=nx>cleanHtml</span> <span class=o>+</span> <span class=s1>&#39;&lt;/div&gt;&#39;</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><ol><li><strong>크로스 사이트 스크립팅(XSS) 방지</strong>: 사용자 입력을 출력할 때 항상 이스케이프 처리한다.</li><li><strong>CSRF 방지</strong>: 상태 변경 요청에 고유한 토큰을 사용한다.</li><li><strong>안전한 의존성 관리</strong>: 정기적으로 npm 패키지를 감사하고 업데이트한다.</li><li><strong>컨텐츠 보안 정책(CSP)</strong>: 스크립트 실행을 제한하는 CSP 헤더를 구현한다.</li></ol><h3 id=보안-코딩의-언어별-도구-및-프레임워크>보안 코딩의 언어별 도구 및 프레임워크<a hidden class=anchor aria-hidden=true href=#보안-코딩의-언어별-도구-및-프레임워크>#</a></h3><h4 id=java-보안-도구>Java 보안 도구<a hidden class=anchor aria-hidden=true href=#java-보안-도구>#</a></h4><ol><li><p><strong>Spring Security</strong>: 인증, 권한 부여, 보안 취약점 방지를 위한 강력한 프레임워크</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11>11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12>12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13>13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14>14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15>15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16>16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17>17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18>18</a>
</span><span class=lnt id=hl-9-19><a class=lnlinks href=#hl-9-19>19</a>
</span><span class=lnt id=hl-9-20><a class=lnlinks href=#hl-9-20>20</a>
</span><span class=lnt id=hl-9-21><a class=lnlinks href=#hl-9-21>21</a>
</span><span class=lnt id=hl-9-22><a class=lnlinks href=#hl-9-22>22</a>
</span><span class=lnt id=hl-9-23><a class=lnlinks href=#hl-9-23>23</a>
</span><span class=lnt id=hl-9-24><a class=lnlinks href=#hl-9-24>24</a>
</span><span class=lnt id=hl-9-25><a class=lnlinks href=#hl-9-25>25</a>
</span><span class=lnt id=hl-9-26><a class=lnlinks href=#hl-9-26>26</a>
</span><span class=lnt id=hl-9-27><a class=lnlinks href=#hl-9-27>27</a>
</span><span class=lnt id=hl-9-28><a class=lnlinks href=#hl-9-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Spring Security 기본 구성 예제</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableWebSecurity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>SecurityConfig</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>WebSecurityConfigurerAdapter</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>configure</span><span class=p>(</span><span class=n>HttpSecurity</span><span class=w> </span><span class=n>http</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>http</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>authorizeRequests</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>antMatchers</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;/home&#34;</span><span class=p>).</span><span class=na>permitAll</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>antMatchers</span><span class=p>(</span><span class=s>&#34;/admin/**&#34;</span><span class=p>).</span><span class=na>hasRole</span><span class=p>(</span><span class=s>&#34;ADMIN&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>anyRequest</span><span class=p>().</span><span class=na>authenticated</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>and</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>formLogin</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>loginPage</span><span class=p>(</span><span class=s>&#34;/login&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>permitAll</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>and</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>logout</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>permitAll</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>and</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>csrf</span><span class=p>()</span><span class=w>  </span><span class=c1>// CSRF 보호 활성화</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>and</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>headers</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>contentSecurityPolicy</span><span class=p>(</span><span class=s>&#34;default-src &#39;self&#39;&#34;</span><span class=p>)</span><span class=w>  </span><span class=c1>// CSP 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>and</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>frameOptions</span><span class=p>().</span><span class=na>deny</span><span class=p>();</span><span class=w>  </span><span class=c1>// 클릭재킹 방지</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>OWASP Dependency-Check</strong>: Maven 및 Gradle 플러그인으로 프로젝트 종속성의 알려진 취약점을 스캔</p></li><li><p><strong>FindBugs/SpotBugs</strong>: 정적 코드 분석 도구로 잠재적 버그와 보안 취약점 탐지</p></li><li><p><strong>SonarQube</strong>: 코드 품질 및 보안 규칙 위반 검사</p></li></ol><h4 id=python-보안-도구>Python 보안 도구<a hidden class=anchor aria-hidden=true href=#python-보안-도구>#</a></h4><ol><li><p><strong>Bandit</strong>: Python 코드에서 일반적인 보안 이슈를 찾는 정적 분석 도구</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1>1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2>2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Bandit 사용 예시</span>
</span></span><span class=line><span class=cl>pip install bandit
</span></span><span class=line><span class=cl>bandit -r path/to/your/code
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Flask-Security</strong>: Flask 애플리케이션에 보안 기능 추가</p></li><li><p><strong>Django Security Middleware</strong>: 기본적으로 XSS, CSRF, 클릭재킹 등에 대한 보호 제공</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Django settings.py 보안 설정 예시</span>
</span></span><span class=line><span class=cl><span class=n>MIDDLEWARE</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.middleware.security.SecurityMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=c1># 기타 미들웨어…</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 보안 설정</span>
</span></span><span class=line><span class=cl><span class=n>SECURE_HSTS_SECONDS</span> <span class=o>=</span> <span class=mi>3600</span>
</span></span><span class=line><span class=cl><span class=n>SECURE_HSTS_INCLUDE_SUBDOMAINS</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=n>SECURE_CONTENT_TYPE_NOSNIFF</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=n>SECURE_BROWSER_XSS_FILTER</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=n>SECURE_SSL_REDIRECT</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_COOKIE_SECURE</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=n>CSRF_COOKIE_SECURE</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=n>X_FRAME_OPTIONS</span> <span class=o>=</span> <span class=s1>&#39;DENY&#39;</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Safety</strong>: 설치된 Python 패키지에서 알려진 보안 취약점 확인</p></li></ol><h4 id=javascriptnodejs-보안-도구>JavaScript/Node.js 보안 도구<a hidden class=anchor aria-hidden=true href=#javascriptnodejs-보안-도구>#</a></h4><ol><li><p><strong>Helmet.js</strong>: HTTP 헤더 설정을 통해 Express.js 애플리케이션의 보안 강화</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1> 1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2> 2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3> 3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4> 4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5> 5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6> 6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7> 7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8> 8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9> 9</a>
</span><span class=lnt id=hl-12-10><a class=lnlinks href=#hl-12-10>10</a>
</span><span class=lnt id=hl-12-11><a class=lnlinks href=#hl-12-11>11</a>
</span><span class=lnt id=hl-12-12><a class=lnlinks href=#hl-12-12>12</a>
</span><span class=lnt id=hl-12-13><a class=lnlinks href=#hl-12-13>13</a>
</span><span class=lnt id=hl-12-14><a class=lnlinks href=#hl-12-14>14</a>
</span><span class=lnt id=hl-12-15><a class=lnlinks href=#hl-12-15>15</a>
</span><span class=lnt id=hl-12-16><a class=lnlinks href=#hl-12-16>16</a>
</span><span class=lnt id=hl-12-17><a class=lnlinks href=#hl-12-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Helmet.js 사용 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>helmet</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;helmet&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 기본 보안 헤더 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>helmet</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 특정 보안 정책 추가 구성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>helmet</span><span class=p>.</span><span class=nx>contentSecurityPolicy</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>directives</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>defaultSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>scriptSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>,</span> <span class=s2>&#34;trusted-cdn.com&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>ESLint와 보안 플러그인</strong>: 보안 관련 코드 품질 문제 감지</p></li><li><p><strong>npm audit</strong>: 프로젝트 종속성의 알려진 취약점 스캔</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1>1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2>2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># npm audit 사용 예시</span>
</span></span><span class=line><span class=cl>npm audit
</span></span><span class=line><span class=cl>npm audit fix  <span class=c1># 가능한 경우 취약점 자동 수정</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>OWASP ZAP</strong>: 웹 애플리케이션 보안 취약점 탐지 및 테스트</p></li></ol><h3 id=일반적인-보안-코딩-실수-및-방지법>일반적인 보안 코딩 실수 및 방지법<a hidden class=anchor aria-hidden=true href=#일반적인-보안-코딩-실수-및-방지법>#</a></h3><h4 id=하드코딩된-비밀-hardcoded-secrets>하드코딩된 비밀 (Hardcoded Secrets)<a hidden class=anchor aria-hidden=true href=#하드코딩된-비밀-hardcoded-secrets>#</a></h4><p><strong>문제</strong>: 소스 코드에 API 키, 비밀번호, 암호화 키 등을 직접 포함시키는 것은 코드가 노출될 경우 심각한 보안 위험을 초래한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1>1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2>2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3>3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4>4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드 - 하드코딩된 비밀</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>DatabaseConnection</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>DB_PASSWORD</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SuperSecretP@ssw0rd&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// ...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>해결책</strong>: 환경 변수, 보안 키 저장소, 암호화된 구성 파일 등을 사용하여 민감한 정보를 코드와 분리한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1>1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2>2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3>3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4>4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5>5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6>6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7>7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 안전한 코드 - 외부 구성 사용</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>DatabaseConnection</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>getDbPassword</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 환경 변수, 보안 키 저장소 또는 암호화된 구성 파일에서 가져오기</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>System</span><span class=p>.</span><span class=na>getenv</span><span class=p>(</span><span class=s>&#34;DB_PASSWORD&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// ...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=부적절한-오류-처리-improper-error-handling>부적절한 오류 처리 (Improper Error Handling)<a hidden class=anchor aria-hidden=true href=#부적절한-오류-처리-improper-error-handling>#</a></h4><p><strong>문제</strong>: 상세한 오류 메시지가 사용자에게 노출되면 시스템 내부 정보를 유출할 수 있다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1>1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2>2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3>3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4>4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5>5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드 - 상세한 오류 정보 노출
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 데이터베이스 작업
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>Exception</span> <span class=nv>$e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s2>&#34;Error: &#34;</span> <span class=o>.</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getMessage</span><span class=p>()</span> <span class=o>.</span> <span class=s2>&#34; in &#34;</span> <span class=o>.</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getFile</span><span class=p>()</span> <span class=o>.</span> <span class=s2>&#34; on line &#34;</span> <span class=o>.</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getLine</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>해결책</strong>: 사용자에게는 일반적인 오류 메시지를 표시하고, 상세한 오류 정보는 로그에만 기록한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1> 1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2> 2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3> 3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4> 4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5> 5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6> 6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7> 7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8> 8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9> 9</a>
</span><span class=lnt id=hl-17-10><a class=lnlinks href=#hl-17-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// 안전한 코드 - 일반적인 오류 메시지 표시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 데이터베이스 작업
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>Exception</span> <span class=nv>$e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 로그에만 상세 정보 기록
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>error_log</span><span class=p>(</span><span class=s2>&#34;Database error: &#34;</span> <span class=o>.</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getMessage</span><span class=p>()</span> <span class=o>.</span> <span class=s2>&#34; in &#34;</span> <span class=o>.</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getFile</span><span class=p>()</span> <span class=o>.</span> <span class=s2>&#34; on line &#34;</span> <span class=o>.</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getLine</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 사용자에게는 일반적인 메시지 표시
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>echo</span> <span class=s2>&#34;An error occurred processing your request. Please try again later.&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=안전하지-않은-직접-객체-참조-insecure-direct-object-references>안전하지 않은 직접 객체 참조 (Insecure Direct Object References)<a hidden class=anchor aria-hidden=true href=#안전하지-않은-직접-객체-참조-insecure-direct-object-references>#</a></h4><p><strong>문제</strong>: 사용자가 직접 데이터베이스 키나 파일 이름과 같은 내부 객체 참조를 조작할 수 있는 경우 발생.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1>1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2>2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3>3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4>4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5>5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6>6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드 - 객체 ID 직접 사용
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/documents/:id&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>documentId</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>params</span><span class=p>.</span><span class=nx>id</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 권한 검사 없이 문서 반환
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nb>document</span> <span class=o>=</span> <span class=nx>getDocumentById</span><span class=p>(</span><span class=nx>documentId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>(</span><span class=nb>document</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>해결책</strong>: 사용자 입력을 간접적인 참조로 매핑하고, 접근 제어 검사를 시행.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12>12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13>13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14>14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15>15</a>
</span><span class=lnt id=hl-19-16><a class=lnlinks href=#hl-19-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 안전한 코드 - 권한 검사 추가
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/documents/:id&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>documentId</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>params</span><span class=p>.</span><span class=nx>id</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 현재 로그인한 사용자 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>currentUser</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 사용자가 해당 문서에 접근할 권한이 있는지 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>hasAccessToDocument</span><span class=p>(</span><span class=nx>currentUser</span><span class=p>,</span> <span class=nx>documentId</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>403</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Access denied&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 권한이 확인된 후 문서 반환
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nb>document</span> <span class=o>=</span> <span class=nx>getDocumentById</span><span class=p>(</span><span class=nx>documentId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>(</span><span class=nb>document</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=안전하지-않은-역직렬화-insecure-deserialization>안전하지 않은 역직렬화 (Insecure Deserialization)<a hidden class=anchor aria-hidden=true href=#안전하지-않은-역직렬화-insecure-deserialization>#</a></h4><p><strong>문제</strong>: 신뢰할 수 없는 소스의 데이터를 검증 없이 역직렬화하면 원격 코드 실행, 서비스 거부 등의 공격에 취약해진다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1>1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2>2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3>3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4>4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5>5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6>6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7>7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8>8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드 - 검증 없는 역직렬화</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=nf>deserializeObject</span><span class=p>(</span><span class=kt>byte</span><span class=o>[]</span><span class=w> </span><span class=n>data</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>(</span><span class=n>ByteArrayInputStream</span><span class=w> </span><span class=n>bais</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ByteArrayInputStream</span><span class=p>(</span><span class=n>data</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>ObjectInputStream</span><span class=w> </span><span class=n>ois</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ObjectInputStream</span><span class=p>(</span><span class=n>bais</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ois</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span><span class=w>  </span><span class=c1>// 위험한 역직렬화</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>null</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>해결책</strong>: 역직렬화 전에 데이터를 검증하고, 안전한 대안(JSON 등)을 사용하거나 신뢰할 수 있는 소스의 데이터만 역직렬화한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span><span class=lnt id=hl-21-11><a class=lnlinks href=#hl-21-11>11</a>
</span><span class=lnt id=hl-21-12><a class=lnlinks href=#hl-21-12>12</a>
</span><span class=lnt id=hl-21-13><a class=lnlinks href=#hl-21-13>13</a>
</span><span class=lnt id=hl-21-14><a class=lnlinks href=#hl-21-14>14</a>
</span><span class=lnt id=hl-21-15><a class=lnlinks href=#hl-21-15>15</a>
</span><span class=lnt id=hl-21-16><a class=lnlinks href=#hl-21-16>16</a>
</span><span class=lnt id=hl-21-17><a class=lnlinks href=#hl-21-17>17</a>
</span><span class=lnt id=hl-21-18><a class=lnlinks href=#hl-21-18>18</a>
</span><span class=lnt id=hl-21-19><a class=lnlinks href=#hl-21-19>19</a>
</span><span class=lnt id=hl-21-20><a class=lnlinks href=#hl-21-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 안전한 코드 - 타입 필터링과 검증</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=nf>deserializeObject</span><span class=p>(</span><span class=kt>byte</span><span class=o>[]</span><span class=w> </span><span class=n>data</span><span class=p>,</span><span class=w> </span><span class=n>Class</span><span class=o>&lt;?&gt;</span><span class=w> </span><span class=n>expectedType</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>(</span><span class=n>ByteArrayInputStream</span><span class=w> </span><span class=n>bais</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ByteArrayInputStream</span><span class=p>(</span><span class=n>data</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>ObjectInputStreamWithFilter</span><span class=w> </span><span class=n>ois</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ObjectInputStreamWithFilter</span><span class=p>(</span><span class=n>bais</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 허용된 클래스만 역직렬화 허용</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>ois</span><span class=p>.</span><span class=na>setObjectInputFilter</span><span class=p>(</span><span class=n>info</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Class</span><span class=o>&lt;?&gt;</span><span class=w> </span><span class=n>clazz</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>info</span><span class=p>.</span><span class=na>serialClass</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>clazz</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>!</span><span class=n>expectedType</span><span class=p>.</span><span class=na>isAssignableFrom</span><span class=p>(</span><span class=n>clazz</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=n>ObjectInputFilter</span><span class=p>.</span><span class=na>Status</span><span class=p>.</span><span class=na>REJECTED</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>ObjectInputFilter</span><span class=p>.</span><span class=na>Status</span><span class=p>.</span><span class=na>ALLOWED</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ois</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 오류 로깅</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>null</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=안전한-웹-통신-구현>안전한 웹 통신 구현<a hidden class=anchor aria-hidden=true href=#안전한-웹-통신-구현>#</a></h3><ol><li><p>HTTPS 구현<br>모든 웹 애플리케이션은 HTTPS를 사용하여 전송 계층 보안을 보장해야 한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1> 1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2> 2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3> 3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4> 4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5> 5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6> 6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7> 7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8> 8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9> 9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10>10</a>
</span><span class=lnt id=hl-22-11><a class=lnlinks href=#hl-22-11>11</a>
</span><span class=lnt id=hl-22-12><a class=lnlinks href=#hl-22-12>12</a>
</span><span class=lnt id=hl-22-13><a class=lnlinks href=#hl-22-13>13</a>
</span><span class=lnt id=hl-22-14><a class=lnlinks href=#hl-22-14>14</a>
</span><span class=lnt id=hl-22-15><a class=lnlinks href=#hl-22-15>15</a>
</span><span class=lnt id=hl-22-16><a class=lnlinks href=#hl-22-16>16</a>
</span><span class=lnt id=hl-22-17><a class=lnlinks href=#hl-22-17>17</a>
</span><span class=lnt id=hl-22-18><a class=lnlinks href=#hl-22-18>18</a>
</span><span class=lnt id=hl-22-19><a class=lnlinks href=#hl-22-19>19</a>
</span><span class=lnt id=hl-22-20><a class=lnlinks href=#hl-22-20>20</a>
</span><span class=lnt id=hl-22-21><a class=lnlinks href=#hl-22-21>21</a>
</span><span class=lnt id=hl-22-22><a class=lnlinks href=#hl-22-22>22</a>
</span><span class=lnt id=hl-22-23><a class=lnlinks href=#hl-22-23>23</a>
</span><span class=lnt id=hl-22-24><a class=lnlinks href=#hl-22-24>24</a>
</span><span class=lnt id=hl-22-25><a class=lnlinks href=#hl-22-25>25</a>
</span><span class=lnt id=hl-22-26><a class=lnlinks href=#hl-22-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Node.js에서 HTTPS 서버 구현
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>https</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;https&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>fs</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;fs&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// SSL 인증서 로드
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>key</span><span class=o>:</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;path/to/private/key.pem&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>cert</span><span class=o>:</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;path/to/certificate.pem&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>ciphers</span><span class=o>:</span> <span class=s1>&#39;TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256&#39;</span><span class=p>,</span> <span class=c1>// 강력한 암호화 알고리즘 지정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>minVersion</span><span class=o>:</span> <span class=s1>&#39;TLSv1.2&#39;</span> <span class=c1>// 최소 TLS 버전 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// HTTPS 서버 생성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>https</span><span class=p>.</span><span class=nx>createServer</span><span class=p>(</span><span class=nx>options</span><span class=p>,</span> <span class=nx>app</span><span class=p>).</span><span class=nx>listen</span><span class=p>(</span><span class=mi>443</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;HTTPS server running on port 443&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// HTTP에서 HTTPS로 리다이렉션
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>http</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;http&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>http</span><span class=p>.</span><span class=nx>createServer</span><span class=p>((</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>writeHead</span><span class=p>(</span><span class=mi>301</span><span class=p>,</span> <span class=p>{</span> <span class=s1>&#39;Location&#39;</span><span class=o>:</span> <span class=s1>&#39;https://&#39;</span> <span class=o>+</span> <span class=nx>req</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>host</span> <span class=o>+</span> <span class=nx>req</span><span class=p>.</span><span class=nx>url</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}).</span><span class=nx>listen</span><span class=p>(</span><span class=mi>80</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>보안 쿠키 설정<br>쿠키에는 Secure, HttpOnly, SameSite 플래그를 설정하여 보안을 강화해야 한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1> 1</a>
</span><span class=lnt id=hl-23-2><a class=lnlinks href=#hl-23-2> 2</a>
</span><span class=lnt id=hl-23-3><a class=lnlinks href=#hl-23-3> 3</a>
</span><span class=lnt id=hl-23-4><a class=lnlinks href=#hl-23-4> 4</a>
</span><span class=lnt id=hl-23-5><a class=lnlinks href=#hl-23-5> 5</a>
</span><span class=lnt id=hl-23-6><a class=lnlinks href=#hl-23-6> 6</a>
</span><span class=lnt id=hl-23-7><a class=lnlinks href=#hl-23-7> 7</a>
</span><span class=lnt id=hl-23-8><a class=lnlinks href=#hl-23-8> 8</a>
</span><span class=lnt id=hl-23-9><a class=lnlinks href=#hl-23-9> 9</a>
</span><span class=lnt id=hl-23-10><a class=lnlinks href=#hl-23-10>10</a>
</span><span class=lnt id=hl-23-11><a class=lnlinks href=#hl-23-11>11</a>
</span><span class=lnt id=hl-23-12><a class=lnlinks href=#hl-23-12>12</a>
</span><span class=lnt id=hl-23-13><a class=lnlinks href=#hl-23-13>13</a>
</span><span class=lnt id=hl-23-14><a class=lnlinks href=#hl-23-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Express.js에서 보안 쿠키 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>session</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express-session&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>session</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>secret</span><span class=o>:</span> <span class=s1>&#39;your-secret-key&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>resave</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>saveUninitialized</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>cookie</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>secure</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>        <span class=c1>// HTTPS에서만 쿠키 전송
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>httpOnly</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>      <span class=c1>// JavaScript에서 쿠키 접근 방지
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>sameSite</span><span class=o>:</span> <span class=s1>&#39;strict&#39;</span><span class=p>,</span>  <span class=c1>// CSRF 공격 방지
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>maxAge</span><span class=o>:</span> <span class=mi>3600000</span>      <span class=c1>// 쿠키 만료 시간 (1시간)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}));</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>CORS(Cross-Origin Resource Sharing) 올바르게 구성<br>허용된 도메인에서만 리소스 접근을 허용하도록 CORS를 구성한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1> 1</a>
</span><span class=lnt id=hl-24-2><a class=lnlinks href=#hl-24-2> 2</a>
</span><span class=lnt id=hl-24-3><a class=lnlinks href=#hl-24-3> 3</a>
</span><span class=lnt id=hl-24-4><a class=lnlinks href=#hl-24-4> 4</a>
</span><span class=lnt id=hl-24-5><a class=lnlinks href=#hl-24-5> 5</a>
</span><span class=lnt id=hl-24-6><a class=lnlinks href=#hl-24-6> 6</a>
</span><span class=lnt id=hl-24-7><a class=lnlinks href=#hl-24-7> 7</a>
</span><span class=lnt id=hl-24-8><a class=lnlinks href=#hl-24-8> 8</a>
</span><span class=lnt id=hl-24-9><a class=lnlinks href=#hl-24-9> 9</a>
</span><span class=lnt id=hl-24-10><a class=lnlinks href=#hl-24-10>10</a>
</span><span class=lnt id=hl-24-11><a class=lnlinks href=#hl-24-11>11</a>
</span><span class=lnt id=hl-24-12><a class=lnlinks href=#hl-24-12>12</a>
</span><span class=lnt id=hl-24-13><a class=lnlinks href=#hl-24-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Express.js에서 CORS 구성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>cors</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;cors&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 특정 출처만 허용
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>corsOptions</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>origin</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;https://trusted-site.com&#39;</span><span class=p>,</span> <span class=s1>&#39;https://another-trusted-site.com&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nx>methods</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=s1>&#39;POST&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nx>allowedHeaders</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;Content-Type&#39;</span><span class=p>,</span> <span class=s1>&#39;Authorization&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nx>credentials</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>maxAge</span><span class=o>:</span> <span class=mi>86400</span>  <span class=c1>// 프리플라이트 요청 캐싱 시간
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>cors</span><span class=p>(</span><span class=nx>corsOptions</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>콘텐츠 보안 정책(CSP) 구현<br>CSP는 XSS 공격과 같은 코드 인젝션 공격을 방지하는 데 도움이 된다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1> 1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2> 2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3> 3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4> 4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5> 5</a>
</span><span class=lnt id=hl-25-6><a class=lnlinks href=#hl-25-6> 6</a>
</span><span class=lnt id=hl-25-7><a class=lnlinks href=#hl-25-7> 7</a>
</span><span class=lnt id=hl-25-8><a class=lnlinks href=#hl-25-8> 8</a>
</span><span class=lnt id=hl-25-9><a class=lnlinks href=#hl-25-9> 9</a>
</span><span class=lnt id=hl-25-10><a class=lnlinks href=#hl-25-10>10</a>
</span><span class=lnt id=hl-25-11><a class=lnlinks href=#hl-25-11>11</a>
</span><span class=lnt id=hl-25-12><a class=lnlinks href=#hl-25-12>12</a>
</span><span class=lnt id=hl-25-13><a class=lnlinks href=#hl-25-13>13</a>
</span><span class=lnt id=hl-25-14><a class=lnlinks href=#hl-25-14>14</a>
</span><span class=lnt id=hl-25-15><a class=lnlinks href=#hl-25-15>15</a>
</span><span class=lnt id=hl-25-16><a class=lnlinks href=#hl-25-16>16</a>
</span><span class=lnt id=hl-25-17><a class=lnlinks href=#hl-25-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Express.js에서 CSP 헤더 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>helmet</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;helmet&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>helmet</span><span class=p>.</span><span class=nx>contentSecurityPolicy</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>directives</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>defaultSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>],</span>  <span class=c1>// 기본적으로 같은 출처의 리소스만 허용
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>scriptSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>,</span> <span class=s1>&#39;trusted-scripts.com&#39;</span><span class=p>],</span>  <span class=c1>// 스크립트 허용 출처
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>styleSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>,</span> <span class=s1>&#39;trusted-styles.com&#39;</span><span class=p>,</span> <span class=s2>&#34;&#39;unsafe-inline&#39;&#34;</span><span class=p>],</span>  <span class=c1>// 스타일 허용 출처
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>imgSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>,</span> <span class=s1>&#39;data:&#39;</span><span class=p>,</span> <span class=s1>&#39;trusted-images.com&#39;</span><span class=p>],</span>  <span class=c1>// 이미지 허용 출처
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>connectSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>,</span> <span class=s1>&#39;api.trusted-site.com&#39;</span><span class=p>],</span>  <span class=c1>// AJAX, WebSocket 허용 출처
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fontSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>,</span> <span class=s1>&#39;fonts.googleapis.com&#39;</span><span class=p>],</span>  <span class=c1>// 폰트 허용 출처
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>objectSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;none&#39;&#34;</span><span class=p>],</span>  <span class=c1>// &lt;object&gt;, &lt;embed&gt;, &lt;applet&gt; 태그 차단
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>mediaSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>],</span>  <span class=c1>// 오디오/비디오 허용 출처
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>frameSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;none&#39;&#34;</span><span class=p>],</span>  <span class=c1>// &lt;frame&gt;, &lt;iframe&gt; 차단
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>reportUri</span><span class=o>:</span> <span class=s1>&#39;/csp-violation-report&#39;</span>  <span class=c1>// 위반 보고 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}));</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=클라우드-환경에서의-보안-코딩>클라우드 환경에서의 보안 코딩<a hidden class=anchor aria-hidden=true href=#클라우드-환경에서의-보안-코딩>#</a></h3><p>클라우드 환경은 추가적인 보안 고려사항이 필요하다:</p><ol><li><p>안전한 클라우드 구성</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-26-1><a class=lnlinks href=#hl-26-1> 1</a>
</span><span class=lnt id=hl-26-2><a class=lnlinks href=#hl-26-2> 2</a>
</span><span class=lnt id=hl-26-3><a class=lnlinks href=#hl-26-3> 3</a>
</span><span class=lnt id=hl-26-4><a class=lnlinks href=#hl-26-4> 4</a>
</span><span class=lnt id=hl-26-5><a class=lnlinks href=#hl-26-5> 5</a>
</span><span class=lnt id=hl-26-6><a class=lnlinks href=#hl-26-6> 6</a>
</span><span class=lnt id=hl-26-7><a class=lnlinks href=#hl-26-7> 7</a>
</span><span class=lnt id=hl-26-8><a class=lnlinks href=#hl-26-8> 8</a>
</span><span class=lnt id=hl-26-9><a class=lnlinks href=#hl-26-9> 9</a>
</span><span class=lnt id=hl-26-10><a class=lnlinks href=#hl-26-10>10</a>
</span><span class=lnt id=hl-26-11><a class=lnlinks href=#hl-26-11>11</a>
</span><span class=lnt id=hl-26-12><a class=lnlinks href=#hl-26-12>12</a>
</span><span class=lnt id=hl-26-13><a class=lnlinks href=#hl-26-13>13</a>
</span><span class=lnt id=hl-26-14><a class=lnlinks href=#hl-26-14>14</a>
</span><span class=lnt id=hl-26-15><a class=lnlinks href=#hl-26-15>15</a>
</span><span class=lnt id=hl-26-16><a class=lnlinks href=#hl-26-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># AWS CloudFormation 보안 구성 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>Resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>S3Bucket</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Type</span><span class=p>:</span><span class=w> </span><span class=l>AWS::S3::Bucket</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Properties</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>BucketName</span><span class=p>:</span><span class=w> </span><span class=l>my-secure-bucket</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>AccessControl</span><span class=p>:</span><span class=w> </span><span class=l>Private</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PublicAccessBlockConfiguration</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>BlockPublicAcls</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>BlockPublicPolicy</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>IgnorePublicAcls</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>RestrictPublicBuckets</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>BucketEncryption</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ServerSideEncryptionConfiguration</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=nt>ServerSideEncryptionByDefault</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>SSEAlgorithm</span><span class=p>:</span><span class=w> </span><span class=l>AES256</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>권한 관리 (IAM)<br>최소 권한 원칙을 적용하여 필요한 권한만 부여:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-27-1><a class=lnlinks href=#hl-27-1> 1</a>
</span><span class=lnt id=hl-27-2><a class=lnlinks href=#hl-27-2> 2</a>
</span><span class=lnt id=hl-27-3><a class=lnlinks href=#hl-27-3> 3</a>
</span><span class=lnt id=hl-27-4><a class=lnlinks href=#hl-27-4> 4</a>
</span><span class=lnt id=hl-27-5><a class=lnlinks href=#hl-27-5> 5</a>
</span><span class=lnt id=hl-27-6><a class=lnlinks href=#hl-27-6> 6</a>
</span><span class=lnt id=hl-27-7><a class=lnlinks href=#hl-27-7> 7</a>
</span><span class=lnt id=hl-27-8><a class=lnlinks href=#hl-27-8> 8</a>
</span><span class=lnt id=hl-27-9><a class=lnlinks href=#hl-27-9> 9</a>
</span><span class=lnt id=hl-27-10><a class=lnlinks href=#hl-27-10>10</a>
</span><span class=lnt id=hl-27-11><a class=lnlinks href=#hl-27-11>11</a>
</span><span class=lnt id=hl-27-12><a class=lnlinks href=#hl-27-12>12</a>
</span><span class=lnt id=hl-27-13><a class=lnlinks href=#hl-27-13>13</a>
</span><span class=lnt id=hl-27-14><a class=lnlinks href=#hl-27-14>14</a>
</span><span class=lnt id=hl-27-15><a class=lnlinks href=#hl-27-15>15</a>
</span><span class=lnt id=hl-27-16><a class=lnlinks href=#hl-27-16>16</a>
</span><span class=lnt id=hl-27-17><a class=lnlinks href=#hl-27-17>17</a>
</span><span class=lnt id=hl-27-18><a class=lnlinks href=#hl-27-18>18</a>
</span><span class=lnt id=hl-27-19><a class=lnlinks href=#hl-27-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=c1>// AWS IAM 정책 예시 - 최소 권한
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;Version&#34;</span><span class=p>:</span> <span class=s2>&#34;2012-10-17&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;Statement&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Effect&#34;</span><span class=p>:</span> <span class=s2>&#34;Allow&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Action&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;s3:GetObject&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;s3:PutObject&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>],</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Resource&#34;</span><span class=p>:</span> <span class=s2>&#34;arn:aws:s3:::my-bucket/my-app/*&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Condition&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;StringEquals&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;aws:SourceVpc&#34;</span><span class=p>:</span> <span class=s2>&#34;vpc-12345678&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>보안 네트워킹<br>클라우드 네트워크를 안전하게 구성:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-28-1><a class=lnlinks href=#hl-28-1> 1</a>
</span><span class=lnt id=hl-28-2><a class=lnlinks href=#hl-28-2> 2</a>
</span><span class=lnt id=hl-28-3><a class=lnlinks href=#hl-28-3> 3</a>
</span><span class=lnt id=hl-28-4><a class=lnlinks href=#hl-28-4> 4</a>
</span><span class=lnt id=hl-28-5><a class=lnlinks href=#hl-28-5> 5</a>
</span><span class=lnt id=hl-28-6><a class=lnlinks href=#hl-28-6> 6</a>
</span><span class=lnt id=hl-28-7><a class=lnlinks href=#hl-28-7> 7</a>
</span><span class=lnt id=hl-28-8><a class=lnlinks href=#hl-28-8> 8</a>
</span><span class=lnt id=hl-28-9><a class=lnlinks href=#hl-28-9> 9</a>
</span><span class=lnt id=hl-28-10><a class=lnlinks href=#hl-28-10>10</a>
</span><span class=lnt id=hl-28-11><a class=lnlinks href=#hl-28-11>11</a>
</span><span class=lnt id=hl-28-12><a class=lnlinks href=#hl-28-12>12</a>
</span><span class=lnt id=hl-28-13><a class=lnlinks href=#hl-28-13>13</a>
</span><span class=lnt id=hl-28-14><a class=lnlinks href=#hl-28-14>14</a>
</span><span class=lnt id=hl-28-15><a class=lnlinks href=#hl-28-15>15</a>
</span><span class=lnt id=hl-28-16><a class=lnlinks href=#hl-28-16>16</a>
</span><span class=lnt id=hl-28-17><a class=lnlinks href=#hl-28-17>17</a>
</span><span class=lnt id=hl-28-18><a class=lnlinks href=#hl-28-18>18</a>
</span><span class=lnt id=hl-28-19><a class=lnlinks href=#hl-28-19>19</a>
</span><span class=lnt id=hl-28-20><a class=lnlinks href=#hl-28-20>20</a>
</span><span class=lnt id=hl-28-21><a class=lnlinks href=#hl-28-21>21</a>
</span><span class=lnt id=hl-28-22><a class=lnlinks href=#hl-28-22>22</a>
</span><span class=lnt id=hl-28-23><a class=lnlinks href=#hl-28-23>23</a>
</span><span class=lnt id=hl-28-24><a class=lnlinks href=#hl-28-24>24</a>
</span><span class=lnt id=hl-28-25><a class=lnlinks href=#hl-28-25>25</a>
</span><span class=lnt id=hl-28-26><a class=lnlinks href=#hl-28-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># AWS CloudFormation을 사용한 보안 VPC 구성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>Resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>MyVPC</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Type</span><span class=p>:</span><span class=w> </span><span class=l>AWS::EC2::VPC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Properties</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>CidrBlock</span><span class=p>:</span><span class=w> </span><span class=m>10.0.0.0</span><span class=l>/16</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>EnableDnsSupport</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>EnableDnsHostnames</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>PrivateSubnet</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Type</span><span class=p>:</span><span class=w> </span><span class=l>AWS::EC2::Subnet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Properties</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>VpcId</span><span class=p>:</span><span class=w> </span>!<span class=l>Ref MyVPC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>CidrBlock</span><span class=p>:</span><span class=w> </span><span class=m>10.0.1.0</span><span class=l>/24</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>MapPublicIpOnLaunch</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>SecurityGroup</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Type</span><span class=p>:</span><span class=w> </span><span class=l>AWS::EC2::SecurityGroup</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Properties</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>GroupDescription</span><span class=p>:</span><span class=w> </span><span class=l>Restricted Security Group</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>VpcId</span><span class=p>:</span><span class=w> </span>!<span class=l>Ref MyVPC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>SecurityGroupIngress</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>IpProtocol</span><span class=p>:</span><span class=w> </span><span class=l>tcp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>FromPort</span><span class=p>:</span><span class=w> </span><span class=m>443</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ToPort</span><span class=p>:</span><span class=w> </span><span class=m>443</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>CidrIp</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=l>/0</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>비밀 관리<br>AWS Secrets Manager, Azure Key Vault, Google Secret Manager와 같은 클라우드 비밀 관리 서비스를 사용:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-29-1><a class=lnlinks href=#hl-29-1> 1</a>
</span><span class=lnt id=hl-29-2><a class=lnlinks href=#hl-29-2> 2</a>
</span><span class=lnt id=hl-29-3><a class=lnlinks href=#hl-29-3> 3</a>
</span><span class=lnt id=hl-29-4><a class=lnlinks href=#hl-29-4> 4</a>
</span><span class=lnt id=hl-29-5><a class=lnlinks href=#hl-29-5> 5</a>
</span><span class=lnt id=hl-29-6><a class=lnlinks href=#hl-29-6> 6</a>
</span><span class=lnt id=hl-29-7><a class=lnlinks href=#hl-29-7> 7</a>
</span><span class=lnt id=hl-29-8><a class=lnlinks href=#hl-29-8> 8</a>
</span><span class=lnt id=hl-29-9><a class=lnlinks href=#hl-29-9> 9</a>
</span><span class=lnt id=hl-29-10><a class=lnlinks href=#hl-29-10>10</a>
</span><span class=lnt id=hl-29-11><a class=lnlinks href=#hl-29-11>11</a>
</span><span class=lnt id=hl-29-12><a class=lnlinks href=#hl-29-12>12</a>
</span><span class=lnt id=hl-29-13><a class=lnlinks href=#hl-29-13>13</a>
</span><span class=lnt id=hl-29-14><a class=lnlinks href=#hl-29-14>14</a>
</span><span class=lnt id=hl-29-15><a class=lnlinks href=#hl-29-15>15</a>
</span><span class=lnt id=hl-29-16><a class=lnlinks href=#hl-29-16>16</a>
</span><span class=lnt id=hl-29-17><a class=lnlinks href=#hl-29-17>17</a>
</span><span class=lnt id=hl-29-18><a class=lnlinks href=#hl-29-18>18</a>
</span><span class=lnt id=hl-29-19><a class=lnlinks href=#hl-29-19>19</a>
</span><span class=lnt id=hl-29-20><a class=lnlinks href=#hl-29-20>20</a>
</span><span class=lnt id=hl-29-21><a class=lnlinks href=#hl-29-21>21</a>
</span><span class=lnt id=hl-29-22><a class=lnlinks href=#hl-29-22>22</a>
</span><span class=lnt id=hl-29-23><a class=lnlinks href=#hl-29-23>23</a>
</span><span class=lnt id=hl-29-24><a class=lnlinks href=#hl-29-24>24</a>
</span><span class=lnt id=hl-29-25><a class=lnlinks href=#hl-29-25>25</a>
</span><span class=lnt id=hl-29-26><a class=lnlinks href=#hl-29-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># AWS Secrets Manager 사용 예시</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>boto3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_secret</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>secret_name</span> <span class=o>=</span> <span class=s2>&#34;my-app/database-credentials&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>region_name</span> <span class=o>=</span> <span class=s2>&#34;us-west-2&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>session</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>client</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>client</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>service_name</span><span class=o>=</span><span class=s1>&#39;secretsmanager&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>region_name</span><span class=o>=</span><span class=n>region_name</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>get_secret_value_response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>get_secret_value</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>SecretId</span><span class=o>=</span><span class=n>secret_name</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 복호화된 비밀 정보 반환</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s1>&#39;SecretString&#39;</span> <span class=ow>in</span> <span class=n>get_secret_value_response</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>secret</span> <span class=o>=</span> <span class=n>get_secret_value_response</span><span class=p>[</span><span class=s1>&#39;SecretString&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>secret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 오류 처리</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>e</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=마이크로서비스-및-api-보안>마이크로서비스 및 API 보안<a hidden class=anchor aria-hidden=true href=#마이크로서비스-및-api-보안>#</a></h3><p>마이크로서비스 아키텍처에서의 보안 고려사항:</p><ol><li><p>API 게이트웨이 보안</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-30-1><a class=lnlinks href=#hl-30-1> 1</a>
</span><span class=lnt id=hl-30-2><a class=lnlinks href=#hl-30-2> 2</a>
</span><span class=lnt id=hl-30-3><a class=lnlinks href=#hl-30-3> 3</a>
</span><span class=lnt id=hl-30-4><a class=lnlinks href=#hl-30-4> 4</a>
</span><span class=lnt id=hl-30-5><a class=lnlinks href=#hl-30-5> 5</a>
</span><span class=lnt id=hl-30-6><a class=lnlinks href=#hl-30-6> 6</a>
</span><span class=lnt id=hl-30-7><a class=lnlinks href=#hl-30-7> 7</a>
</span><span class=lnt id=hl-30-8><a class=lnlinks href=#hl-30-8> 8</a>
</span><span class=lnt id=hl-30-9><a class=lnlinks href=#hl-30-9> 9</a>
</span><span class=lnt id=hl-30-10><a class=lnlinks href=#hl-30-10>10</a>
</span><span class=lnt id=hl-30-11><a class=lnlinks href=#hl-30-11>11</a>
</span><span class=lnt id=hl-30-12><a class=lnlinks href=#hl-30-12>12</a>
</span><span class=lnt id=hl-30-13><a class=lnlinks href=#hl-30-13>13</a>
</span><span class=lnt id=hl-30-14><a class=lnlinks href=#hl-30-14>14</a>
</span><span class=lnt id=hl-30-15><a class=lnlinks href=#hl-30-15>15</a>
</span><span class=lnt id=hl-30-16><a class=lnlinks href=#hl-30-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Express.js에서 API 게이트웨이 보안 미들웨어
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>rateLimit</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express-rate-limit&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>helmet</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;helmet&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 속도 제한 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>apiLimiter</span> <span class=o>=</span> <span class=nx>rateLimit</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>windowMs</span><span class=o>:</span> <span class=mi>15</span> <span class=o>*</span> <span class=mi>60</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>,</span>  <span class=c1>// 15분
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>max</span><span class=o>:</span> <span class=mi>100</span><span class=p>,</span>  <span class=c1>// 15분당 최대 100개 요청
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>standardHeaders</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>  <span class=c1>// RateLimit 헤더 반환
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>legacyHeaders</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>  <span class=c1>// X-RateLimit 헤더 비활성화
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;Too many requests from this IP, please try again after 15 minutes&#39;</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// API 경로에 보안 미들웨어 적용
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=s1>&#39;/api/&#39;</span><span class=p>,</span> <span class=nx>apiLimiter</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>helmet</span><span class=p>());</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>서비스 간 인증<br>마이크로서비스 간 통신 보안을 위해 JWT 또는 mTLS 사용:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-31-1><a class=lnlinks href=#hl-31-1> 1</a>
</span><span class=lnt id=hl-31-2><a class=lnlinks href=#hl-31-2> 2</a>
</span><span class=lnt id=hl-31-3><a class=lnlinks href=#hl-31-3> 3</a>
</span><span class=lnt id=hl-31-4><a class=lnlinks href=#hl-31-4> 4</a>
</span><span class=lnt id=hl-31-5><a class=lnlinks href=#hl-31-5> 5</a>
</span><span class=lnt id=hl-31-6><a class=lnlinks href=#hl-31-6> 6</a>
</span><span class=lnt id=hl-31-7><a class=lnlinks href=#hl-31-7> 7</a>
</span><span class=lnt id=hl-31-8><a class=lnlinks href=#hl-31-8> 8</a>
</span><span class=lnt id=hl-31-9><a class=lnlinks href=#hl-31-9> 9</a>
</span><span class=lnt id=hl-31-10><a class=lnlinks href=#hl-31-10>10</a>
</span><span class=lnt id=hl-31-11><a class=lnlinks href=#hl-31-11>11</a>
</span><span class=lnt id=hl-31-12><a class=lnlinks href=#hl-31-12>12</a>
</span><span class=lnt id=hl-31-13><a class=lnlinks href=#hl-31-13>13</a>
</span><span class=lnt id=hl-31-14><a class=lnlinks href=#hl-31-14>14</a>
</span><span class=lnt id=hl-31-15><a class=lnlinks href=#hl-31-15>15</a>
</span><span class=lnt id=hl-31-16><a class=lnlinks href=#hl-31-16>16</a>
</span><span class=lnt id=hl-31-17><a class=lnlinks href=#hl-31-17>17</a>
</span><span class=lnt id=hl-31-18><a class=lnlinks href=#hl-31-18>18</a>
</span><span class=lnt id=hl-31-19><a class=lnlinks href=#hl-31-19>19</a>
</span><span class=lnt id=hl-31-20><a class=lnlinks href=#hl-31-20>20</a>
</span><span class=lnt id=hl-31-21><a class=lnlinks href=#hl-31-21>21</a>
</span><span class=lnt id=hl-31-22><a class=lnlinks href=#hl-31-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Spring Boot에서 JWT 인증 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableWebSecurity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>SecurityConfig</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>WebSecurityConfigurerAdapter</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>JwtTokenProvider</span><span class=w> </span><span class=n>jwtTokenProvider</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>configure</span><span class=p>(</span><span class=n>HttpSecurity</span><span class=w> </span><span class=n>http</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>http</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>csrf</span><span class=p>().</span><span class=na>disable</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>sessionManagement</span><span class=p>().</span><span class=na>sessionCreationPolicy</span><span class=p>(</span><span class=n>SessionCreationPolicy</span><span class=p>.</span><span class=na>STATELESS</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>and</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>authorizeRequests</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>antMatchers</span><span class=p>(</span><span class=s>&#34;/public/**&#34;</span><span class=p>).</span><span class=na>permitAll</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>antMatchers</span><span class=p>(</span><span class=s>&#34;/api/v1/**&#34;</span><span class=p>).</span><span class=na>hasRole</span><span class=p>(</span><span class=s>&#34;SERVICE&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>anyRequest</span><span class=p>().</span><span class=na>authenticated</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>and</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>JwtConfigurer</span><span class=p>(</span><span class=n>jwtTokenProvider</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>mTLS(상호 TLS) 구현<br>서비스 간 통신에 mTLS를 사용하여 양방향 인증 보장:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-32-1><a class=lnlinks href=#hl-32-1> 1</a>
</span><span class=lnt id=hl-32-2><a class=lnlinks href=#hl-32-2> 2</a>
</span><span class=lnt id=hl-32-3><a class=lnlinks href=#hl-32-3> 3</a>
</span><span class=lnt id=hl-32-4><a class=lnlinks href=#hl-32-4> 4</a>
</span><span class=lnt id=hl-32-5><a class=lnlinks href=#hl-32-5> 5</a>
</span><span class=lnt id=hl-32-6><a class=lnlinks href=#hl-32-6> 6</a>
</span><span class=lnt id=hl-32-7><a class=lnlinks href=#hl-32-7> 7</a>
</span><span class=lnt id=hl-32-8><a class=lnlinks href=#hl-32-8> 8</a>
</span><span class=lnt id=hl-32-9><a class=lnlinks href=#hl-32-9> 9</a>
</span><span class=lnt id=hl-32-10><a class=lnlinks href=#hl-32-10>10</a>
</span><span class=lnt id=hl-32-11><a class=lnlinks href=#hl-32-11>11</a>
</span><span class=lnt id=hl-32-12><a class=lnlinks href=#hl-32-12>12</a>
</span><span class=lnt id=hl-32-13><a class=lnlinks href=#hl-32-13>13</a>
</span><span class=lnt id=hl-32-14><a class=lnlinks href=#hl-32-14>14</a>
</span><span class=lnt id=hl-32-15><a class=lnlinks href=#hl-32-15>15</a>
</span><span class=lnt id=hl-32-16><a class=lnlinks href=#hl-32-16>16</a>
</span><span class=lnt id=hl-32-17><a class=lnlinks href=#hl-32-17>17</a>
</span><span class=lnt id=hl-32-18><a class=lnlinks href=#hl-32-18>18</a>
</span><span class=lnt id=hl-32-19><a class=lnlinks href=#hl-32-19>19</a>
</span><span class=lnt id=hl-32-20><a class=lnlinks href=#hl-32-20>20</a>
</span><span class=lnt id=hl-32-21><a class=lnlinks href=#hl-32-21>21</a>
</span><span class=lnt id=hl-32-22><a class=lnlinks href=#hl-32-22>22</a>
</span><span class=lnt id=hl-32-23><a class=lnlinks href=#hl-32-23>23</a>
</span><span class=lnt id=hl-32-24><a class=lnlinks href=#hl-32-24>24</a>
</span><span class=lnt id=hl-32-25><a class=lnlinks href=#hl-32-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Spring Boot에서 mTLS 구성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MtlsConfig</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>ServletWebServerFactory</span><span class=w> </span><span class=nf>servletContainer</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>TomcatServletWebServerFactory</span><span class=w> </span><span class=n>tomcat</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>TomcatServletWebServerFactory</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>tomcat</span><span class=p>.</span><span class=na>addConnectorCustomizers</span><span class=p>(</span><span class=n>connector</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>connector</span><span class=p>.</span><span class=na>setScheme</span><span class=p>(</span><span class=s>&#34;https&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>connector</span><span class=p>.</span><span class=na>setSecure</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Http11NioProtocol</span><span class=w> </span><span class=n>protocol</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>Http11NioProtocol</span><span class=p>)</span><span class=w> </span><span class=n>connector</span><span class=p>.</span><span class=na>getProtocolHandler</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>protocol</span><span class=p>.</span><span class=na>setSSLEnabled</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>protocol</span><span class=p>.</span><span class=na>setClientAuth</span><span class=p>(</span><span class=s>&#34;true&#34;</span><span class=p>);</span><span class=w> </span><span class=c1>// 클라이언트 인증 요구</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 키스토어 및 트러스트스토어 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>protocol</span><span class=p>.</span><span class=na>setKeystoreFile</span><span class=p>(</span><span class=s>&#34;/path/to/keystore.jks&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>protocol</span><span class=p>.</span><span class=na>setKeystorePass</span><span class=p>(</span><span class=s>&#34;keystorePassword&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>protocol</span><span class=p>.</span><span class=na>setTruststoreFile</span><span class=p>(</span><span class=s>&#34;/path/to/truststore.jks&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>protocol</span><span class=p>.</span><span class=na>setTruststorePass</span><span class=p>(</span><span class=s>&#34;truststorePassword&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>protocol</span><span class=p>.</span><span class=na>setKeyAlias</span><span class=p>(</span><span class=s>&#34;tomcat&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>tomcat</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>API 권한 관리<br>세분화된 API 접근 제어를 구현:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-33-1><a class=lnlinks href=#hl-33-1> 1</a>
</span><span class=lnt id=hl-33-2><a class=lnlinks href=#hl-33-2> 2</a>
</span><span class=lnt id=hl-33-3><a class=lnlinks href=#hl-33-3> 3</a>
</span><span class=lnt id=hl-33-4><a class=lnlinks href=#hl-33-4> 4</a>
</span><span class=lnt id=hl-33-5><a class=lnlinks href=#hl-33-5> 5</a>
</span><span class=lnt id=hl-33-6><a class=lnlinks href=#hl-33-6> 6</a>
</span><span class=lnt id=hl-33-7><a class=lnlinks href=#hl-33-7> 7</a>
</span><span class=lnt id=hl-33-8><a class=lnlinks href=#hl-33-8> 8</a>
</span><span class=lnt id=hl-33-9><a class=lnlinks href=#hl-33-9> 9</a>
</span><span class=lnt id=hl-33-10><a class=lnlinks href=#hl-33-10>10</a>
</span><span class=lnt id=hl-33-11><a class=lnlinks href=#hl-33-11>11</a>
</span><span class=lnt id=hl-33-12><a class=lnlinks href=#hl-33-12>12</a>
</span><span class=lnt id=hl-33-13><a class=lnlinks href=#hl-33-13>13</a>
</span><span class=lnt id=hl-33-14><a class=lnlinks href=#hl-33-14>14</a>
</span><span class=lnt id=hl-33-15><a class=lnlinks href=#hl-33-15>15</a>
</span><span class=lnt id=hl-33-16><a class=lnlinks href=#hl-33-16>16</a>
</span><span class=lnt id=hl-33-17><a class=lnlinks href=#hl-33-17>17</a>
</span><span class=lnt id=hl-33-18><a class=lnlinks href=#hl-33-18>18</a>
</span><span class=lnt id=hl-33-19><a class=lnlinks href=#hl-33-19>19</a>
</span><span class=lnt id=hl-33-20><a class=lnlinks href=#hl-33-20>20</a>
</span><span class=lnt id=hl-33-21><a class=lnlinks href=#hl-33-21>21</a>
</span><span class=lnt id=hl-33-22><a class=lnlinks href=#hl-33-22>22</a>
</span><span class=lnt id=hl-33-23><a class=lnlinks href=#hl-33-23>23</a>
</span><span class=lnt id=hl-33-24><a class=lnlinks href=#hl-33-24>24</a>
</span><span class=lnt id=hl-33-25><a class=lnlinks href=#hl-33-25>25</a>
</span><span class=lnt id=hl-33-26><a class=lnlinks href=#hl-33-26>26</a>
</span><span class=lnt id=hl-33-27><a class=lnlinks href=#hl-33-27>27</a>
</span><span class=lnt id=hl-33-28><a class=lnlinks href=#hl-33-28>28</a>
</span><span class=lnt id=hl-33-29><a class=lnlinks href=#hl-33-29>29</a>
</span><span class=lnt id=hl-33-30><a class=lnlinks href=#hl-33-30>30</a>
</span><span class=lnt id=hl-33-31><a class=lnlinks href=#hl-33-31>31</a>
</span><span class=lnt id=hl-33-32><a class=lnlinks href=#hl-33-32>32</a>
</span><span class=lnt id=hl-33-33><a class=lnlinks href=#hl-33-33>33</a>
</span><span class=lnt id=hl-33-34><a class=lnlinks href=#hl-33-34>34</a>
</span><span class=lnt id=hl-33-35><a class=lnlinks href=#hl-33-35>35</a>
</span><span class=lnt id=hl-33-36><a class=lnlinks href=#hl-33-36>36</a>
</span><span class=lnt id=hl-33-37><a class=lnlinks href=#hl-33-37>37</a>
</span><span class=lnt id=hl-33-38><a class=lnlinks href=#hl-33-38>38</a>
</span><span class=lnt id=hl-33-39><a class=lnlinks href=#hl-33-39>39</a>
</span><span class=lnt id=hl-33-40><a class=lnlinks href=#hl-33-40>40</a>
</span><span class=lnt id=hl-33-41><a class=lnlinks href=#hl-33-41>41</a>
</span><span class=lnt id=hl-33-42><a class=lnlinks href=#hl-33-42>42</a>
</span><span class=lnt id=hl-33-43><a class=lnlinks href=#hl-33-43>43</a>
</span><span class=lnt id=hl-33-44><a class=lnlinks href=#hl-33-44>44</a>
</span><span class=lnt id=hl-33-45><a class=lnlinks href=#hl-33-45>45</a>
</span><span class=lnt id=hl-33-46><a class=lnlinks href=#hl-33-46>46</a>
</span><span class=lnt id=hl-33-47><a class=lnlinks href=#hl-33-47>47</a>
</span><span class=lnt id=hl-33-48><a class=lnlinks href=#hl-33-48>48</a>
</span><span class=lnt id=hl-33-49><a class=lnlinks href=#hl-33-49>49</a>
</span><span class=lnt id=hl-33-50><a class=lnlinks href=#hl-33-50>50</a>
</span><span class=lnt id=hl-33-51><a class=lnlinks href=#hl-33-51>51</a>
</span><span class=lnt id=hl-33-52><a class=lnlinks href=#hl-33-52>52</a>
</span><span class=lnt id=hl-33-53><a class=lnlinks href=#hl-33-53>53</a>
</span><span class=lnt id=hl-33-54><a class=lnlinks href=#hl-33-54>54</a>
</span><span class=lnt id=hl-33-55><a class=lnlinks href=#hl-33-55>55</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python FastAPI에서 권한 기반 접근 제어</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span><span class=p>,</span> <span class=n>Depends</span><span class=p>,</span> <span class=n>HTTPException</span><span class=p>,</span> <span class=n>status</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi.security</span> <span class=kn>import</span> <span class=n>OAuth2PasswordBearer</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>jose</span> <span class=kn>import</span> <span class=n>JWTError</span><span class=p>,</span> <span class=n>jwt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pydantic</span> <span class=kn>import</span> <span class=n>BaseModel</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span><span class=p>,</span> <span class=n>Optional</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>oauth2_scheme</span> <span class=o>=</span> <span class=n>OAuth2PasswordBearer</span><span class=p>(</span><span class=n>tokenUrl</span><span class=o>=</span><span class=s2>&#34;token&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용자 모델</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>email</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>roles</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>disabled</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 토큰에서 사용자 정보 추출</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_current_user</span><span class=p>(</span><span class=n>token</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>oauth2_scheme</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>credentials_exception</span> <span class=o>=</span> <span class=n>HTTPException</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>status_code</span><span class=o>=</span><span class=n>status</span><span class=o>.</span><span class=n>HTTP_401_UNAUTHORIZED</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Invalid authentication credentials&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>headers</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;WWW-Authenticate&#34;</span><span class=p>:</span> <span class=s2>&#34;Bearer&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>SECRET_KEY</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=n>ALGORITHM</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;sub&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>username</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>credentials_exception</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=n>get_user_from_db</span><span class=p>(</span><span class=n>username</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>credentials_exception</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>user</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>JWTError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>credentials_exception</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 권한 확인 함수</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>has_role</span><span class=p>(</span><span class=n>required_role</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>role_checker</span><span class=p>(</span><span class=n>user</span><span class=p>:</span> <span class=n>User</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>get_current_user</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>required_role</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>user</span><span class=o>.</span><span class=n>roles</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>status_code</span><span class=o>=</span><span class=n>status</span><span class=o>.</span><span class=n>HTTP_403_FORBIDDEN</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Insufficient permissions&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>user</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>role_checker</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 엔드포인트 예제</span>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/admin/users&#34;</span><span class=p>,</span> <span class=n>dependencies</span><span class=o>=</span><span class=p>[</span><span class=n>Depends</span><span class=p>(</span><span class=n>has_role</span><span class=p>(</span><span class=s2>&#34;ADMIN&#34;</span><span class=p>))])</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>get_users</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;users&#34;</span><span class=p>:</span> <span class=n>get_all_users</span><span class=p>()}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/api/items&#34;</span><span class=p>,</span> <span class=n>dependencies</span><span class=o>=</span><span class=p>[</span><span class=n>Depends</span><span class=p>(</span><span class=n>has_role</span><span class=p>(</span><span class=s2>&#34;USER&#34;</span><span class=p>))])</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>get_items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;items&#34;</span><span class=p>:</span> <span class=n>get_all_items</span><span class=p>()}</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=iot-기기를-위한-보안-코딩>IoT 기기를 위한 보안 코딩<a hidden class=anchor aria-hidden=true href=#iot-기기를-위한-보안-코딩>#</a></h3><p>IoT 디바이스는 특별한 보안 고려사항이 필요:</p><ol><li><p>안전한 부팅 및 펌웨어 업데이트<br>디지털 서명을 통한 펌웨어 무결성 검증:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-34-1><a class=lnlinks href=#hl-34-1> 1</a>
</span><span class=lnt id=hl-34-2><a class=lnlinks href=#hl-34-2> 2</a>
</span><span class=lnt id=hl-34-3><a class=lnlinks href=#hl-34-3> 3</a>
</span><span class=lnt id=hl-34-4><a class=lnlinks href=#hl-34-4> 4</a>
</span><span class=lnt id=hl-34-5><a class=lnlinks href=#hl-34-5> 5</a>
</span><span class=lnt id=hl-34-6><a class=lnlinks href=#hl-34-6> 6</a>
</span><span class=lnt id=hl-34-7><a class=lnlinks href=#hl-34-7> 7</a>
</span><span class=lnt id=hl-34-8><a class=lnlinks href=#hl-34-8> 8</a>
</span><span class=lnt id=hl-34-9><a class=lnlinks href=#hl-34-9> 9</a>
</span><span class=lnt id=hl-34-10><a class=lnlinks href=#hl-34-10>10</a>
</span><span class=lnt id=hl-34-11><a class=lnlinks href=#hl-34-11>11</a>
</span><span class=lnt id=hl-34-12><a class=lnlinks href=#hl-34-12>12</a>
</span><span class=lnt id=hl-34-13><a class=lnlinks href=#hl-34-13>13</a>
</span><span class=lnt id=hl-34-14><a class=lnlinks href=#hl-34-14>14</a>
</span><span class=lnt id=hl-34-15><a class=lnlinks href=#hl-34-15>15</a>
</span><span class=lnt id=hl-34-16><a class=lnlinks href=#hl-34-16>16</a>
</span><span class=lnt id=hl-34-17><a class=lnlinks href=#hl-34-17>17</a>
</span><span class=lnt id=hl-34-18><a class=lnlinks href=#hl-34-18>18</a>
</span><span class=lnt id=hl-34-19><a class=lnlinks href=#hl-34-19>19</a>
</span><span class=lnt id=hl-34-20><a class=lnlinks href=#hl-34-20>20</a>
</span><span class=lnt id=hl-34-21><a class=lnlinks href=#hl-34-21>21</a>
</span><span class=lnt id=hl-34-22><a class=lnlinks href=#hl-34-22>22</a>
</span><span class=lnt id=hl-34-23><a class=lnlinks href=#hl-34-23>23</a>
</span><span class=lnt id=hl-34-24><a class=lnlinks href=#hl-34-24>24</a>
</span><span class=lnt id=hl-34-25><a class=lnlinks href=#hl-34-25>25</a>
</span><span class=lnt id=hl-34-26><a class=lnlinks href=#hl-34-26>26</a>
</span><span class=lnt id=hl-34-27><a class=lnlinks href=#hl-34-27>27</a>
</span><span class=lnt id=hl-34-28><a class=lnlinks href=#hl-34-28>28</a>
</span><span class=lnt id=hl-34-29><a class=lnlinks href=#hl-34-29>29</a>
</span><span class=lnt id=hl-34-30><a class=lnlinks href=#hl-34-30>30</a>
</span><span class=lnt id=hl-34-31><a class=lnlinks href=#hl-34-31>31</a>
</span><span class=lnt id=hl-34-32><a class=lnlinks href=#hl-34-32>32</a>
</span><span class=lnt id=hl-34-33><a class=lnlinks href=#hl-34-33>33</a>
</span><span class=lnt id=hl-34-34><a class=lnlinks href=#hl-34-34>34</a>
</span><span class=lnt id=hl-34-35><a class=lnlinks href=#hl-34-35>35</a>
</span><span class=lnt id=hl-34-36><a class=lnlinks href=#hl-34-36>36</a>
</span><span class=lnt id=hl-34-37><a class=lnlinks href=#hl-34-37>37</a>
</span><span class=lnt id=hl-34-38><a class=lnlinks href=#hl-34-38>38</a>
</span><span class=lnt id=hl-34-39><a class=lnlinks href=#hl-34-39>39</a>
</span><span class=lnt id=hl-34-40><a class=lnlinks href=#hl-34-40>40</a>
</span><span class=lnt id=hl-34-41><a class=lnlinks href=#hl-34-41>41</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=c1>// C에서 펌웨어 서명 확인
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#include</span> <span class=cpf>&lt;openssl/evp.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;openssl/pem.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>verify_firmware_signature</span><span class=p>(</span><span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>firmware_data</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>firmware_len</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                             <span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>signature</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>sig_len</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                             <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>public_key_path</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>FILE</span> <span class=o>*</span><span class=n>key_file</span> <span class=o>=</span> <span class=nf>fopen</span><span class=p>(</span><span class=n>public_key_path</span><span class=p>,</span> <span class=s>&#34;r&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>key_file</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span> <span class=c1>// 키 파일 열기 실패
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 공개 키 로드
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>EVP_PKEY</span> <span class=o>*</span><span class=n>public_key</span> <span class=o>=</span> <span class=nf>PEM_read_PUBKEY</span><span class=p>(</span><span class=n>key_file</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>fclose</span><span class=p>(</span><span class=n>key_file</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>public_key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span> <span class=c1>// 공개 키 로드 실패
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 서명 확인 컨텍스트 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>EVP_MD_CTX</span> <span class=o>*</span><span class=n>ctx</span> <span class=o>=</span> <span class=nf>EVP_MD_CTX_new</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>result</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>ctx</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 서명 확인 초기화
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nf>EVP_VerifyInit</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>EVP_sha256</span><span class=p>())</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 펌웨어 데이터 업데이트
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>if</span> <span class=p>(</span><span class=nf>EVP_VerifyUpdate</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>firmware_data</span><span class=p>,</span> <span class=n>firmware_len</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>// 서명 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>if</span> <span class=p>(</span><span class=nf>EVP_VerifyFinal</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>signature</span><span class=p>,</span> <span class=n>sig_len</span><span class=p>,</span> <span class=n>public_key</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>result</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// 서명 확인 성공
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nf>EVP_MD_CTX_free</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nf>EVP_PKEY_free</span><span class=p>(</span><span class=n>public_key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>안전한 통신<br>TLS를 사용한 IoT 기기 통신 보안:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-35-1><a class=lnlinks href=#hl-35-1> 1</a>
</span><span class=lnt id=hl-35-2><a class=lnlinks href=#hl-35-2> 2</a>
</span><span class=lnt id=hl-35-3><a class=lnlinks href=#hl-35-3> 3</a>
</span><span class=lnt id=hl-35-4><a class=lnlinks href=#hl-35-4> 4</a>
</span><span class=lnt id=hl-35-5><a class=lnlinks href=#hl-35-5> 5</a>
</span><span class=lnt id=hl-35-6><a class=lnlinks href=#hl-35-6> 6</a>
</span><span class=lnt id=hl-35-7><a class=lnlinks href=#hl-35-7> 7</a>
</span><span class=lnt id=hl-35-8><a class=lnlinks href=#hl-35-8> 8</a>
</span><span class=lnt id=hl-35-9><a class=lnlinks href=#hl-35-9> 9</a>
</span><span class=lnt id=hl-35-10><a class=lnlinks href=#hl-35-10>10</a>
</span><span class=lnt id=hl-35-11><a class=lnlinks href=#hl-35-11>11</a>
</span><span class=lnt id=hl-35-12><a class=lnlinks href=#hl-35-12>12</a>
</span><span class=lnt id=hl-35-13><a class=lnlinks href=#hl-35-13>13</a>
</span><span class=lnt id=hl-35-14><a class=lnlinks href=#hl-35-14>14</a>
</span><span class=lnt id=hl-35-15><a class=lnlinks href=#hl-35-15>15</a>
</span><span class=lnt id=hl-35-16><a class=lnlinks href=#hl-35-16>16</a>
</span><span class=lnt id=hl-35-17><a class=lnlinks href=#hl-35-17>17</a>
</span><span class=lnt id=hl-35-18><a class=lnlinks href=#hl-35-18>18</a>
</span><span class=lnt id=hl-35-19><a class=lnlinks href=#hl-35-19>19</a>
</span><span class=lnt id=hl-35-20><a class=lnlinks href=#hl-35-20>20</a>
</span><span class=lnt id=hl-35-21><a class=lnlinks href=#hl-35-21>21</a>
</span><span class=lnt id=hl-35-22><a class=lnlinks href=#hl-35-22>22</a>
</span><span class=lnt id=hl-35-23><a class=lnlinks href=#hl-35-23>23</a>
</span><span class=lnt id=hl-35-24><a class=lnlinks href=#hl-35-24>24</a>
</span><span class=lnt id=hl-35-25><a class=lnlinks href=#hl-35-25>25</a>
</span><span class=lnt id=hl-35-26><a class=lnlinks href=#hl-35-26>26</a>
</span><span class=lnt id=hl-35-27><a class=lnlinks href=#hl-35-27>27</a>
</span><span class=lnt id=hl-35-28><a class=lnlinks href=#hl-35-28>28</a>
</span><span class=lnt id=hl-35-29><a class=lnlinks href=#hl-35-29>29</a>
</span><span class=lnt id=hl-35-30><a class=lnlinks href=#hl-35-30>30</a>
</span><span class=lnt id=hl-35-31><a class=lnlinks href=#hl-35-31>31</a>
</span><span class=lnt id=hl-35-32><a class=lnlinks href=#hl-35-32>32</a>
</span><span class=lnt id=hl-35-33><a class=lnlinks href=#hl-35-33>33</a>
</span><span class=lnt id=hl-35-34><a class=lnlinks href=#hl-35-34>34</a>
</span><span class=lnt id=hl-35-35><a class=lnlinks href=#hl-35-35>35</a>
</span><span class=lnt id=hl-35-36><a class=lnlinks href=#hl-35-36>36</a>
</span><span class=lnt id=hl-35-37><a class=lnlinks href=#hl-35-37>37</a>
</span><span class=lnt id=hl-35-38><a class=lnlinks href=#hl-35-38>38</a>
</span><span class=lnt id=hl-35-39><a class=lnlinks href=#hl-35-39>39</a>
</span><span class=lnt id=hl-35-40><a class=lnlinks href=#hl-35-40>40</a>
</span><span class=lnt id=hl-35-41><a class=lnlinks href=#hl-35-41>41</a>
</span><span class=lnt id=hl-35-42><a class=lnlinks href=#hl-35-42>42</a>
</span><span class=lnt id=hl-35-43><a class=lnlinks href=#hl-35-43>43</a>
</span><span class=lnt id=hl-35-44><a class=lnlinks href=#hl-35-44>44</a>
</span><span class=lnt id=hl-35-45><a class=lnlinks href=#hl-35-45>45</a>
</span><span class=lnt id=hl-35-46><a class=lnlinks href=#hl-35-46>46</a>
</span><span class=lnt id=hl-35-47><a class=lnlinks href=#hl-35-47>47</a>
</span><span class=lnt id=hl-35-48><a class=lnlinks href=#hl-35-48>48</a>
</span><span class=lnt id=hl-35-49><a class=lnlinks href=#hl-35-49>49</a>
</span><span class=lnt id=hl-35-50><a class=lnlinks href=#hl-35-50>50</a>
</span><span class=lnt id=hl-35-51><a class=lnlinks href=#hl-35-51>51</a>
</span><span class=lnt id=hl-35-52><a class=lnlinks href=#hl-35-52>52</a>
</span><span class=lnt id=hl-35-53><a class=lnlinks href=#hl-35-53>53</a>
</span><span class=lnt id=hl-35-54><a class=lnlinks href=#hl-35-54>54</a>
</span><span class=lnt id=hl-35-55><a class=lnlinks href=#hl-35-55>55</a>
</span><span class=lnt id=hl-35-56><a class=lnlinks href=#hl-35-56>56</a>
</span><span class=lnt id=hl-35-57><a class=lnlinks href=#hl-35-57>57</a>
</span><span class=lnt id=hl-35-58><a class=lnlinks href=#hl-35-58>58</a>
</span><span class=lnt id=hl-35-59><a class=lnlinks href=#hl-35-59>59</a>
</span><span class=lnt id=hl-35-60><a class=lnlinks href=#hl-35-60>60</a>
</span><span class=lnt id=hl-35-61><a class=lnlinks href=#hl-35-61>61</a>
</span><span class=lnt id=hl-35-62><a class=lnlinks href=#hl-35-62>62</a>
</span><span class=lnt id=hl-35-63><a class=lnlinks href=#hl-35-63>63</a>
</span><span class=lnt id=hl-35-64><a class=lnlinks href=#hl-35-64>64</a>
</span><span class=lnt id=hl-35-65><a class=lnlinks href=#hl-35-65>65</a>
</span><span class=lnt id=hl-35-66><a class=lnlinks href=#hl-35-66>66</a>
</span><span class=lnt id=hl-35-67><a class=lnlinks href=#hl-35-67>67</a>
</span><span class=lnt id=hl-35-68><a class=lnlinks href=#hl-35-68>68</a>
</span><span class=lnt id=hl-35-69><a class=lnlinks href=#hl-35-69>69</a>
</span><span class=lnt id=hl-35-70><a class=lnlinks href=#hl-35-70>70</a>
</span><span class=lnt id=hl-35-71><a class=lnlinks href=#hl-35-71>71</a>
</span><span class=lnt id=hl-35-72><a class=lnlinks href=#hl-35-72>72</a>
</span><span class=lnt id=hl-35-73><a class=lnlinks href=#hl-35-73>73</a>
</span><span class=lnt id=hl-35-74><a class=lnlinks href=#hl-35-74>74</a>
</span><span class=lnt id=hl-35-75><a class=lnlinks href=#hl-35-75>75</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=c1>// C에서 mbedTLS를 사용한 TLS 클라이언트 구현
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#include</span> <span class=cpf>&#34;mbedtls/net_sockets.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mbedtls/ssl.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mbedtls/entropy.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mbedtls/ctr_drbg.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mbedtls/error.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mbedtls/certs.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>secure_connect_to_server</span><span class=p>(</span><span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>server</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>port</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>mbedtls_net_context</span> <span class=n>server_fd</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>mbedtls_ssl_context</span> <span class=n>ssl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>mbedtls_ssl_config</span> <span class=n>conf</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>mbedtls_entropy_context</span> <span class=n>entropy</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>mbedtls_ctr_drbg_context</span> <span class=n>ctr_drbg</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>pers</span> <span class=o>=</span> <span class=s>&#34;ssl_client&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 초기화
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>mbedtls_net_init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>server_fd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_ssl_init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ssl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_ssl_config_init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>conf</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_entropy_init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>entropy</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_ctr_drbg_init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctr_drbg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 난수 생성기 시드 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nf>mbedtls_ctr_drbg_seed</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctr_drbg</span><span class=p>,</span> <span class=n>mbedtls_entropy_func</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>entropy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                             <span class=p>(</span><span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=n>pers</span><span class=p>,</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>pers</span><span class=p>))</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 서버에 연결
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nf>mbedtls_net_connect</span><span class=p>(</span><span class=o>&amp;</span><span class=n>server_fd</span><span class=p>,</span> <span class=n>server</span><span class=p>,</span> <span class=n>port</span><span class=p>,</span> <span class=n>MBEDTLS_NET_PROTO_TCP</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// SSL/TLS 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nf>mbedtls_ssl_config_defaults</span><span class=p>(</span><span class=o>&amp;</span><span class=n>conf</span><span class=p>,</span> <span class=n>MBEDTLS_SSL_IS_CLIENT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=n>MBEDTLS_SSL_TRANSPORT_STREAM</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=n>MBEDTLS_SSL_PRESET_DEFAULT</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 인증서 확인을 선택 사항으로 설정 (프로덕션에서는 필수로 설정해야 함)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>mbedtls_ssl_conf_authmode</span><span class=p>(</span><span class=o>&amp;</span><span class=n>conf</span><span class=p>,</span> <span class=n>MBEDTLS_SSL_VERIFY_OPTIONAL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_ssl_conf_rng</span><span class=p>(</span><span class=o>&amp;</span><span class=n>conf</span><span class=p>,</span> <span class=n>mbedtls_ctr_drbg_random</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>ctr_drbg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// SSL/TLS 설정 적용
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nf>mbedtls_ssl_setup</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ssl</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>conf</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 호스트 이름 설정 (필수)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nf>mbedtls_ssl_set_hostname</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ssl</span><span class=p>,</span> <span class=n>server</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// SSL/TLS 입출력 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>mbedtls_ssl_set_bio</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ssl</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>server_fd</span><span class=p>,</span> <span class=n>mbedtls_net_send</span><span class=p>,</span> <span class=n>mbedtls_net_recv</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 핸드셰이크 수행
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>while</span> <span class=p>(</span><span class=nf>mbedtls_ssl_handshake</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ssl</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 핸드셰이크 재시도
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 이제 ssl_write와 ssl_read를 사용하여 통신 가능
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 사용 후 리소스 정리
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>mbedtls_ssl_close_notify</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ssl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_net_free</span><span class=p>(</span><span class=o>&amp;</span><span class=n>server_fd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_ssl_free</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ssl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_ssl_config_free</span><span class=p>(</span><span class=o>&amp;</span><span class=n>conf</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_ctr_drbg_free</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctr_drbg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_entropy_free</span><span class=p>(</span><span class=o>&amp;</span><span class=n>entropy</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>데이터 저장 암호화<br>IoT 기기에서 민감한 데이터 암호화:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-36-1><a class=lnlinks href=#hl-36-1> 1</a>
</span><span class=lnt id=hl-36-2><a class=lnlinks href=#hl-36-2> 2</a>
</span><span class=lnt id=hl-36-3><a class=lnlinks href=#hl-36-3> 3</a>
</span><span class=lnt id=hl-36-4><a class=lnlinks href=#hl-36-4> 4</a>
</span><span class=lnt id=hl-36-5><a class=lnlinks href=#hl-36-5> 5</a>
</span><span class=lnt id=hl-36-6><a class=lnlinks href=#hl-36-6> 6</a>
</span><span class=lnt id=hl-36-7><a class=lnlinks href=#hl-36-7> 7</a>
</span><span class=lnt id=hl-36-8><a class=lnlinks href=#hl-36-8> 8</a>
</span><span class=lnt id=hl-36-9><a class=lnlinks href=#hl-36-9> 9</a>
</span><span class=lnt id=hl-36-10><a class=lnlinks href=#hl-36-10>10</a>
</span><span class=lnt id=hl-36-11><a class=lnlinks href=#hl-36-11>11</a>
</span><span class=lnt id=hl-36-12><a class=lnlinks href=#hl-36-12>12</a>
</span><span class=lnt id=hl-36-13><a class=lnlinks href=#hl-36-13>13</a>
</span><span class=lnt id=hl-36-14><a class=lnlinks href=#hl-36-14>14</a>
</span><span class=lnt id=hl-36-15><a class=lnlinks href=#hl-36-15>15</a>
</span><span class=lnt id=hl-36-16><a class=lnlinks href=#hl-36-16>16</a>
</span><span class=lnt id=hl-36-17><a class=lnlinks href=#hl-36-17>17</a>
</span><span class=lnt id=hl-36-18><a class=lnlinks href=#hl-36-18>18</a>
</span><span class=lnt id=hl-36-19><a class=lnlinks href=#hl-36-19>19</a>
</span><span class=lnt id=hl-36-20><a class=lnlinks href=#hl-36-20>20</a>
</span><span class=lnt id=hl-36-21><a class=lnlinks href=#hl-36-21>21</a>
</span><span class=lnt id=hl-36-22><a class=lnlinks href=#hl-36-22>22</a>
</span><span class=lnt id=hl-36-23><a class=lnlinks href=#hl-36-23>23</a>
</span><span class=lnt id=hl-36-24><a class=lnlinks href=#hl-36-24>24</a>
</span><span class=lnt id=hl-36-25><a class=lnlinks href=#hl-36-25>25</a>
</span><span class=lnt id=hl-36-26><a class=lnlinks href=#hl-36-26>26</a>
</span><span class=lnt id=hl-36-27><a class=lnlinks href=#hl-36-27>27</a>
</span><span class=lnt id=hl-36-28><a class=lnlinks href=#hl-36-28>28</a>
</span><span class=lnt id=hl-36-29><a class=lnlinks href=#hl-36-29>29</a>
</span><span class=lnt id=hl-36-30><a class=lnlinks href=#hl-36-30>30</a>
</span><span class=lnt id=hl-36-31><a class=lnlinks href=#hl-36-31>31</a>
</span><span class=lnt id=hl-36-32><a class=lnlinks href=#hl-36-32>32</a>
</span><span class=lnt id=hl-36-33><a class=lnlinks href=#hl-36-33>33</a>
</span><span class=lnt id=hl-36-34><a class=lnlinks href=#hl-36-34>34</a>
</span><span class=lnt id=hl-36-35><a class=lnlinks href=#hl-36-35>35</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=c1>// C에서 데이터 암호화
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#include</span> <span class=cpf>&lt;openssl/evp.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;openssl/rand.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>encrypt_data</span><span class=p>(</span><span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>plaintext</span><span class=p>,</span> <span class=kt>int</span> <span class=n>plaintext_len</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>key</span><span class=p>,</span> <span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>iv</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>ciphertext</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>EVP_CIPHER_CTX</span> <span class=o>*</span><span class=n>ctx</span> <span class=o>=</span> <span class=nf>EVP_CIPHER_CTX_new</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>len</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>ciphertext_len</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 암호화 컨텍스트 초기화
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nf>EVP_EncryptInit_ex</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>EVP_aes_256_cbc</span><span class=p>(),</span> <span class=nb>NULL</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>iv</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>EVP_CIPHER_CTX_free</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 암호화 수행
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nf>EVP_EncryptUpdate</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>ciphertext</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>len</span><span class=p>,</span> <span class=n>plaintext</span><span class=p>,</span> <span class=n>plaintext_len</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>EVP_CIPHER_CTX_free</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>ciphertext_len</span> <span class=o>=</span> <span class=n>len</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 암호화 종료
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nf>EVP_EncryptFinal_ex</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>ciphertext</span> <span class=o>+</span> <span class=n>len</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>len</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>EVP_CIPHER_CTX_free</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>ciphertext_len</span> <span class=o>+=</span> <span class=n>len</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 정리
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>EVP_CIPHER_CTX_free</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ciphertext_len</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>안전한 리소스 관리<br>메모리, CPU, 네트워크 등의 리소스 사용을 제한하여 DoS 공격 방지:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-37-1><a class=lnlinks href=#hl-37-1> 1</a>
</span><span class=lnt id=hl-37-2><a class=lnlinks href=#hl-37-2> 2</a>
</span><span class=lnt id=hl-37-3><a class=lnlinks href=#hl-37-3> 3</a>
</span><span class=lnt id=hl-37-4><a class=lnlinks href=#hl-37-4> 4</a>
</span><span class=lnt id=hl-37-5><a class=lnlinks href=#hl-37-5> 5</a>
</span><span class=lnt id=hl-37-6><a class=lnlinks href=#hl-37-6> 6</a>
</span><span class=lnt id=hl-37-7><a class=lnlinks href=#hl-37-7> 7</a>
</span><span class=lnt id=hl-37-8><a class=lnlinks href=#hl-37-8> 8</a>
</span><span class=lnt id=hl-37-9><a class=lnlinks href=#hl-37-9> 9</a>
</span><span class=lnt id=hl-37-10><a class=lnlinks href=#hl-37-10>10</a>
</span><span class=lnt id=hl-37-11><a class=lnlinks href=#hl-37-11>11</a>
</span><span class=lnt id=hl-37-12><a class=lnlinks href=#hl-37-12>12</a>
</span><span class=lnt id=hl-37-13><a class=lnlinks href=#hl-37-13>13</a>
</span><span class=lnt id=hl-37-14><a class=lnlinks href=#hl-37-14>14</a>
</span><span class=lnt id=hl-37-15><a class=lnlinks href=#hl-37-15>15</a>
</span><span class=lnt id=hl-37-16><a class=lnlinks href=#hl-37-16>16</a>
</span><span class=lnt id=hl-37-17><a class=lnlinks href=#hl-37-17>17</a>
</span><span class=lnt id=hl-37-18><a class=lnlinks href=#hl-37-18>18</a>
</span><span class=lnt id=hl-37-19><a class=lnlinks href=#hl-37-19>19</a>
</span><span class=lnt id=hl-37-20><a class=lnlinks href=#hl-37-20>20</a>
</span><span class=lnt id=hl-37-21><a class=lnlinks href=#hl-37-21>21</a>
</span><span class=lnt id=hl-37-22><a class=lnlinks href=#hl-37-22>22</a>
</span><span class=lnt id=hl-37-23><a class=lnlinks href=#hl-37-23>23</a>
</span><span class=lnt id=hl-37-24><a class=lnlinks href=#hl-37-24>24</a>
</span><span class=lnt id=hl-37-25><a class=lnlinks href=#hl-37-25>25</a>
</span><span class=lnt id=hl-37-26><a class=lnlinks href=#hl-37-26>26</a>
</span><span class=lnt id=hl-37-27><a class=lnlinks href=#hl-37-27>27</a>
</span><span class=lnt id=hl-37-28><a class=lnlinks href=#hl-37-28>28</a>
</span><span class=lnt id=hl-37-29><a class=lnlinks href=#hl-37-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=c1>// C에서 리소스 제한 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#include</span> <span class=cpf>&lt;sys/resource.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>set_resource_limits</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>struct</span> <span class=n>rlimit</span> <span class=n>rlim</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// CPU 시간 제한 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>rlim</span><span class=p>.</span><span class=n>rlim_cur</span> <span class=o>=</span> <span class=mi>10</span><span class=p>;</span> <span class=c1>// 10초
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>rlim</span><span class=p>.</span><span class=n>rlim_max</span> <span class=o>=</span> <span class=mi>20</span><span class=p>;</span> <span class=c1>// 최대 20초
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nf>setrlimit</span><span class=p>(</span><span class=n>RLIMIT_CPU</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>rlim</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 메모리 사용량 제한
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>rlim</span><span class=p>.</span><span class=n>rlim_cur</span> <span class=o>=</span> <span class=mi>10</span> <span class=o>*</span> <span class=mi>1024</span> <span class=o>*</span> <span class=mi>1024</span><span class=p>;</span> <span class=c1>// 10MB
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>rlim</span><span class=p>.</span><span class=n>rlim_max</span> <span class=o>=</span> <span class=mi>15</span> <span class=o>*</span> <span class=mi>1024</span> <span class=o>*</span> <span class=mi>1024</span><span class=p>;</span> <span class=c1>// 최대 15MB
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nf>setrlimit</span><span class=p>(</span><span class=n>RLIMIT_AS</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>rlim</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 파일 개수 제한
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>rlim</span><span class=p>.</span><span class=n>rlim_cur</span> <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>rlim</span><span class=p>.</span><span class=n>rlim_max</span> <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nf>setrlimit</span><span class=p>(</span><span class=n>RLIMIT_NOFILE</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>rlim</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=인젝션-공격-방어>인젝션 공격 방어<a hidden class=anchor aria-hidden=true href=#인젝션-공격-방어>#</a></h3><p>인젝션 공격은 가장 흔하고 위험한 웹 애플리케이션 보안 취약점 중 하나:</p><ol><li><p>SQL 인젝션 방지</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-38-1><a class=lnlinks href=#hl-38-1>1</a>
</span><span class=lnt id=hl-38-2><a class=lnlinks href=#hl-38-2>2</a>
</span><span class=lnt id=hl-38-3><a class=lnlinks href=#hl-38-3>3</a>
</span><span class=lnt id=hl-38-4><a class=lnlinks href=#hl-38-4>4</a>
</span><span class=lnt id=hl-38-5><a class=lnlinks href=#hl-38-5>5</a>
</span><span class=lnt id=hl-38-6><a class=lnlinks href=#hl-38-6>6</a>
</span><span class=lnt id=hl-38-7><a class=lnlinks href=#hl-38-7>7</a>
</span><span class=lnt id=hl-38-8><a class=lnlinks href=#hl-38-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT * FROM users WHERE username = &#39;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>username</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;&#39; AND password = &#39;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;&#39;&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 안전한 코드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT * FROM users WHERE username = ? AND password = ?&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>PreparedStatement</span><span class=w> </span><span class=n>stmt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connection</span><span class=p>.</span><span class=na>prepareStatement</span><span class=p>(</span><span class=n>query</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>stmt</span><span class=p>.</span><span class=na>setString</span><span class=p>(</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>username</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>stmt</span><span class=p>.</span><span class=na>setString</span><span class=p>(</span><span class=n>2</span><span class=p>,</span><span class=w> </span><span class=n>password</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>명령어 인젝션 방지</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-39-1><a class=lnlinks href=#hl-39-1>1</a>
</span><span class=lnt id=hl-39-2><a class=lnlinks href=#hl-39-2>2</a>
</span><span class=lnt id=hl-39-3><a class=lnlinks href=#hl-39-3>3</a>
</span><span class=lnt id=hl-39-4><a class=lnlinks href=#hl-39-4>4</a>
</span><span class=lnt id=hl-39-5><a class=lnlinks href=#hl-39-5>5</a>
</span><span class=lnt id=hl-39-6><a class=lnlinks href=#hl-39-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 안전하지 않은 코드</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s2>&#34;ping &#34;</span> <span class=o>+</span> <span class=n>user_input</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 안전한 코드</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=s2>&#34;ping&#34;</span><span class=p>,</span> <span class=n>user_input</span><span class=p>],</span> <span class=n>capture_output</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>text</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>check</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>XSS 방지</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-40-1><a class=lnlinks href=#hl-40-1>1</a>
</span><span class=lnt id=hl-40-2><a class=lnlinks href=#hl-40-2>2</a>
</span><span class=lnt id=hl-40-3><a class=lnlinks href=#hl-40-3>3</a>
</span><span class=lnt id=hl-40-4><a class=lnlinks href=#hl-40-4>4</a>
</span><span class=lnt id=hl-40-5><a class=lnlinks href=#hl-40-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>element</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=nx>userInput</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 안전한 코드
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>element</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=nx>userInput</span><span class=p>;</span>  <span class=c1>// 또는 적절한 이스케이프 라이브러리 사용
</span></span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=암호화-및-민감-데이터-처리>암호화 및 민감 데이터 처리<a hidden class=anchor aria-hidden=true href=#암호화-및-민감-데이터-처리>#</a></h3><p>데이터 보호를 위한 암호화 모범 사례:</p><ol><li><p>강력한 암호화 알고리즘 사용</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-41-1><a class=lnlinks href=#hl-41-1> 1</a>
</span><span class=lnt id=hl-41-2><a class=lnlinks href=#hl-41-2> 2</a>
</span><span class=lnt id=hl-41-3><a class=lnlinks href=#hl-41-3> 3</a>
</span><span class=lnt id=hl-41-4><a class=lnlinks href=#hl-41-4> 4</a>
</span><span class=lnt id=hl-41-5><a class=lnlinks href=#hl-41-5> 5</a>
</span><span class=lnt id=hl-41-6><a class=lnlinks href=#hl-41-6> 6</a>
</span><span class=lnt id=hl-41-7><a class=lnlinks href=#hl-41-7> 7</a>
</span><span class=lnt id=hl-41-8><a class=lnlinks href=#hl-41-8> 8</a>
</span><span class=lnt id=hl-41-9><a class=lnlinks href=#hl-41-9> 9</a>
</span><span class=lnt id=hl-41-10><a class=lnlinks href=#hl-41-10>10</a>
</span><span class=lnt id=hl-41-11><a class=lnlinks href=#hl-41-11>11</a>
</span><span class=lnt id=hl-41-12><a class=lnlinks href=#hl-41-12>12</a>
</span><span class=lnt id=hl-41-13><a class=lnlinks href=#hl-41-13>13</a>
</span><span class=lnt id=hl-41-14><a class=lnlinks href=#hl-41-14>14</a>
</span><span class=lnt id=hl-41-15><a class=lnlinks href=#hl-41-15>15</a>
</span><span class=lnt id=hl-41-16><a class=lnlinks href=#hl-41-16>16</a>
</span><span class=lnt id=hl-41-17><a class=lnlinks href=#hl-41-17>17</a>
</span><span class=lnt id=hl-41-18><a class=lnlinks href=#hl-41-18>18</a>
</span><span class=lnt id=hl-41-19><a class=lnlinks href=#hl-41-19>19</a>
</span><span class=lnt id=hl-41-20><a class=lnlinks href=#hl-41-20>20</a>
</span><span class=lnt id=hl-41-21><a class=lnlinks href=#hl-41-21>21</a>
</span><span class=lnt id=hl-41-22><a class=lnlinks href=#hl-41-22>22</a>
</span><span class=lnt id=hl-41-23><a class=lnlinks href=#hl-41-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Node.js에서 안전한 암호화 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>crypto</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;crypto&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>encryptData</span><span class=p>(</span><span class=nx>data</span><span class=p>,</span> <span class=nx>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 무작위 초기화 벡터(IV) 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>iv</span> <span class=o>=</span> <span class=nx>crypto</span><span class=p>.</span><span class=nx>randomBytes</span><span class=p>(</span><span class=mi>16</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// AES-256-GCM 암호화 (인증된 암호화)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>cipher</span> <span class=o>=</span> <span class=nx>crypto</span><span class=p>.</span><span class=nx>createCipheriv</span><span class=p>(</span><span class=s1>&#39;aes-256-gcm&#39;</span><span class=p>,</span> <span class=nx>key</span><span class=p>,</span> <span class=nx>iv</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>encrypted</span> <span class=o>=</span> <span class=nx>cipher</span><span class=p>.</span><span class=nx>update</span><span class=p>(</span><span class=nx>data</span><span class=p>,</span> <span class=s1>&#39;utf8&#39;</span><span class=p>,</span> <span class=s1>&#39;hex&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>encrypted</span> <span class=o>+=</span> <span class=nx>cipher</span><span class=p>.</span><span class=kr>final</span><span class=p>(</span><span class=s1>&#39;hex&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 인증 태그 획득
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>authTag</span> <span class=o>=</span> <span class=nx>cipher</span><span class=p>.</span><span class=nx>getAuthTag</span><span class=p>().</span><span class=nx>toString</span><span class=p>(</span><span class=s1>&#39;hex&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// IV, 암호문, 인증 태그 반환
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>iv</span><span class=o>:</span> <span class=nx>iv</span><span class=p>.</span><span class=nx>toString</span><span class=p>(</span><span class=s1>&#39;hex&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>encryptedData</span><span class=o>:</span> <span class=nx>encrypted</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>authTag</span><span class=o>:</span> <span class=nx>authTag</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>안전한 비밀번호 관리</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-42-1><a class=lnlinks href=#hl-42-1> 1</a>
</span><span class=lnt id=hl-42-2><a class=lnlinks href=#hl-42-2> 2</a>
</span><span class=lnt id=hl-42-3><a class=lnlinks href=#hl-42-3> 3</a>
</span><span class=lnt id=hl-42-4><a class=lnlinks href=#hl-42-4> 4</a>
</span><span class=lnt id=hl-42-5><a class=lnlinks href=#hl-42-5> 5</a>
</span><span class=lnt id=hl-42-6><a class=lnlinks href=#hl-42-6> 6</a>
</span><span class=lnt id=hl-42-7><a class=lnlinks href=#hl-42-7> 7</a>
</span><span class=lnt id=hl-42-8><a class=lnlinks href=#hl-42-8> 8</a>
</span><span class=lnt id=hl-42-9><a class=lnlinks href=#hl-42-9> 9</a>
</span><span class=lnt id=hl-42-10><a class=lnlinks href=#hl-42-10>10</a>
</span><span class=lnt id=hl-42-11><a class=lnlinks href=#hl-42-11>11</a>
</span><span class=lnt id=hl-42-12><a class=lnlinks href=#hl-42-12>12</a>
</span><span class=lnt id=hl-42-13><a class=lnlinks href=#hl-42-13>13</a>
</span><span class=lnt id=hl-42-14><a class=lnlinks href=#hl-42-14>14</a>
</span><span class=lnt id=hl-42-15><a class=lnlinks href=#hl-42-15>15</a>
</span><span class=lnt id=hl-42-16><a class=lnlinks href=#hl-42-16>16</a>
</span><span class=lnt id=hl-42-17><a class=lnlinks href=#hl-42-17>17</a>
</span><span class=lnt id=hl-42-18><a class=lnlinks href=#hl-42-18>18</a>
</span><span class=lnt id=hl-42-19><a class=lnlinks href=#hl-42-19>19</a>
</span><span class=lnt id=hl-42-20><a class=lnlinks href=#hl-42-20>20</a>
</span><span class=lnt id=hl-42-21><a class=lnlinks href=#hl-42-21>21</a>
</span><span class=lnt id=hl-42-22><a class=lnlinks href=#hl-42-22>22</a>
</span><span class=lnt id=hl-42-23><a class=lnlinks href=#hl-42-23>23</a>
</span><span class=lnt id=hl-42-24><a class=lnlinks href=#hl-42-24>24</a>
</span><span class=lnt id=hl-42-25><a class=lnlinks href=#hl-42-25>25</a>
</span><span class=lnt id=hl-42-26><a class=lnlinks href=#hl-42-26>26</a>
</span><span class=lnt id=hl-42-27><a class=lnlinks href=#hl-42-27>27</a>
</span><span class=lnt id=hl-42-28><a class=lnlinks href=#hl-42-28>28</a>
</span><span class=lnt id=hl-42-29><a class=lnlinks href=#hl-42-29>29</a>
</span><span class=lnt id=hl-42-30><a class=lnlinks href=#hl-42-30>30</a>
</span><span class=lnt id=hl-42-31><a class=lnlinks href=#hl-42-31>31</a>
</span><span class=lnt id=hl-42-32><a class=lnlinks href=#hl-42-32>32</a>
</span><span class=lnt id=hl-42-33><a class=lnlinks href=#hl-42-33>33</a>
</span><span class=lnt id=hl-42-34><a class=lnlinks href=#hl-42-34>34</a>
</span><span class=lnt id=hl-42-35><a class=lnlinks href=#hl-42-35>35</a>
</span><span class=lnt id=hl-42-36><a class=lnlinks href=#hl-42-36>36</a>
</span><span class=lnt id=hl-42-37><a class=lnlinks href=#hl-42-37>37</a>
</span><span class=lnt id=hl-42-38><a class=lnlinks href=#hl-42-38>38</a>
</span><span class=lnt id=hl-42-39><a class=lnlinks href=#hl-42-39>39</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python에서 안전한 비밀번호 해싱</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>binascii</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hash_password</span><span class=p>(</span><span class=n>password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 솔트 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>salt</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 키 스트레칭을 통한 해싱</span>
</span></span><span class=line><span class=cl>    <span class=n>iterations</span> <span class=o>=</span> <span class=mi>100000</span>
</span></span><span class=line><span class=cl>    <span class=n>hash_bytes</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>pbkdf2_hmac</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;sha256&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>salt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>iterations</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 솔트와 해시 저장</span>
</span></span><span class=line><span class=cl>    <span class=n>storage</span> <span class=o>=</span> <span class=n>salt</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span> <span class=o>+</span> <span class=s1>&#39;:&#39;</span> <span class=o>+</span> <span class=n>binascii</span><span class=o>.</span><span class=n>hexlify</span><span class=p>(</span><span class=n>hash_bytes</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>storage</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify_password</span><span class=p>(</span><span class=n>stored_password</span><span class=p>,</span> <span class=n>provided_password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 저장된 비밀번호에서 솔트와 해시 추출</span>
</span></span><span class=line><span class=cl>    <span class=n>salt_hex</span><span class=p>,</span> <span class=n>hash_hex</span> <span class=o>=</span> <span class=n>stored_password</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>salt</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>salt_hex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 제공된 비밀번호 해싱</span>
</span></span><span class=line><span class=cl>    <span class=n>iterations</span> <span class=o>=</span> <span class=mi>100000</span>
</span></span><span class=line><span class=cl>    <span class=n>hash_bytes</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>pbkdf2_hmac</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;sha256&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>provided_password</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>salt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>iterations</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 해시 비교</span>
</span></span><span class=line><span class=cl>    <span class=n>calculated_hash_hex</span> <span class=o>=</span> <span class=n>binascii</span><span class=o>.</span><span class=n>hexlify</span><span class=p>(</span><span class=n>hash_bytes</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>hash_hex</span> <span class=o>==</span> <span class=n>calculated_hash_hex</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>전송 중 데이터 보호:<br>HTTPS, TLS, SSH 등 안전한 통신 프로토콜을 사용.</p></li><li><p>민감한 데이터 관리<br>민감한 정보는 필요한 기간 동안만 메모리에 보관하고 사용 후 즉시 제거:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-43-1><a class=lnlinks href=#hl-43-1> 1</a>
</span><span class=lnt id=hl-43-2><a class=lnlinks href=#hl-43-2> 2</a>
</span><span class=lnt id=hl-43-3><a class=lnlinks href=#hl-43-3> 3</a>
</span><span class=lnt id=hl-43-4><a class=lnlinks href=#hl-43-4> 4</a>
</span><span class=lnt id=hl-43-5><a class=lnlinks href=#hl-43-5> 5</a>
</span><span class=lnt id=hl-43-6><a class=lnlinks href=#hl-43-6> 6</a>
</span><span class=lnt id=hl-43-7><a class=lnlinks href=#hl-43-7> 7</a>
</span><span class=lnt id=hl-43-8><a class=lnlinks href=#hl-43-8> 8</a>
</span><span class=lnt id=hl-43-9><a class=lnlinks href=#hl-43-9> 9</a>
</span><span class=lnt id=hl-43-10><a class=lnlinks href=#hl-43-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Java에서 민감한 데이터 관리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 문자열 대신 char[] 사용</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>char</span><span class=o>[]</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getPasswordFromUser</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>authenticateUser</span><span class=p>(</span><span class=n>password</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 사용 후 즉시 비밀번호 초기화</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Arrays</span><span class=p>.</span><span class=na>fill</span><span class=p>(</span><span class=n>password</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;0&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 오류 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=세션-관리-및-인증>세션 관리 및 인증<a hidden class=anchor aria-hidden=true href=#세션-관리-및-인증>#</a></h3><p>안전한 세션 및 인증 관리 방법:</p><ol><li><p>강력한 세션 ID 생성</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-44-1><a class=lnlinks href=#hl-44-1> 1</a>
</span><span class=lnt id=hl-44-2><a class=lnlinks href=#hl-44-2> 2</a>
</span><span class=lnt id=hl-44-3><a class=lnlinks href=#hl-44-3> 3</a>
</span><span class=lnt id=hl-44-4><a class=lnlinks href=#hl-44-4> 4</a>
</span><span class=lnt id=hl-44-5><a class=lnlinks href=#hl-44-5> 5</a>
</span><span class=lnt id=hl-44-6><a class=lnlinks href=#hl-44-6> 6</a>
</span><span class=lnt id=hl-44-7><a class=lnlinks href=#hl-44-7> 7</a>
</span><span class=lnt id=hl-44-8><a class=lnlinks href=#hl-44-8> 8</a>
</span><span class=lnt id=hl-44-9><a class=lnlinks href=#hl-44-9> 9</a>
</span><span class=lnt id=hl-44-10><a class=lnlinks href=#hl-44-10>10</a>
</span><span class=lnt id=hl-44-11><a class=lnlinks href=#hl-44-11>11</a>
</span><span class=lnt id=hl-44-12><a class=lnlinks href=#hl-44-12>12</a>
</span><span class=lnt id=hl-44-13><a class=lnlinks href=#hl-44-13>13</a>
</span><span class=lnt id=hl-44-14><a class=lnlinks href=#hl-44-14>14</a>
</span><span class=lnt id=hl-44-15><a class=lnlinks href=#hl-44-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// PHP에서 안전한 세션 관리
</span></span></span><span class=line><span class=cl><span class=c1>// 세션 시작 전 보안 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>ini_set</span><span class=p>(</span><span class=s1>&#39;session.cookie_httponly&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>ini_set</span><span class=p>(</span><span class=s1>&#39;session.cookie_secure&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>ini_set</span><span class=p>(</span><span class=s1>&#39;session.use_only_cookies&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>ini_set</span><span class=p>(</span><span class=s1>&#39;session.cookie_samesite&#39;</span><span class=p>,</span> <span class=s1>&#39;Strict&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 세션 시작
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>session_start</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 새 세션일 경우 안전한 ID 재생성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span> <span class=p>(</span><span class=k>empty</span><span class=p>(</span><span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;initialized&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>session_regenerate_id</span><span class=p>(</span><span class=k>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;initialized&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>다중 인증 구현</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-45-1><a class=lnlinks href=#hl-45-1> 1</a>
</span><span class=lnt id=hl-45-2><a class=lnlinks href=#hl-45-2> 2</a>
</span><span class=lnt id=hl-45-3><a class=lnlinks href=#hl-45-3> 3</a>
</span><span class=lnt id=hl-45-4><a class=lnlinks href=#hl-45-4> 4</a>
</span><span class=lnt id=hl-45-5><a class=lnlinks href=#hl-45-5> 5</a>
</span><span class=lnt id=hl-45-6><a class=lnlinks href=#hl-45-6> 6</a>
</span><span class=lnt id=hl-45-7><a class=lnlinks href=#hl-45-7> 7</a>
</span><span class=lnt id=hl-45-8><a class=lnlinks href=#hl-45-8> 8</a>
</span><span class=lnt id=hl-45-9><a class=lnlinks href=#hl-45-9> 9</a>
</span><span class=lnt id=hl-45-10><a class=lnlinks href=#hl-45-10>10</a>
</span><span class=lnt id=hl-45-11><a class=lnlinks href=#hl-45-11>11</a>
</span><span class=lnt id=hl-45-12><a class=lnlinks href=#hl-45-12>12</a>
</span><span class=lnt id=hl-45-13><a class=lnlinks href=#hl-45-13>13</a>
</span><span class=lnt id=hl-45-14><a class=lnlinks href=#hl-45-14>14</a>
</span><span class=lnt id=hl-45-15><a class=lnlinks href=#hl-45-15>15</a>
</span><span class=lnt id=hl-45-16><a class=lnlinks href=#hl-45-16>16</a>
</span><span class=lnt id=hl-45-17><a class=lnlinks href=#hl-45-17>17</a>
</span><span class=lnt id=hl-45-18><a class=lnlinks href=#hl-45-18>18</a>
</span><span class=lnt id=hl-45-19><a class=lnlinks href=#hl-45-19>19</a>
</span><span class=lnt id=hl-45-20><a class=lnlinks href=#hl-45-20>20</a>
</span><span class=lnt id=hl-45-21><a class=lnlinks href=#hl-45-21>21</a>
</span><span class=lnt id=hl-45-22><a class=lnlinks href=#hl-45-22>22</a>
</span><span class=lnt id=hl-45-23><a class=lnlinks href=#hl-45-23>23</a>
</span><span class=lnt id=hl-45-24><a class=lnlinks href=#hl-45-24>24</a>
</span><span class=lnt id=hl-45-25><a class=lnlinks href=#hl-45-25>25</a>
</span><span class=lnt id=hl-45-26><a class=lnlinks href=#hl-45-26>26</a>
</span><span class=lnt id=hl-45-27><a class=lnlinks href=#hl-45-27>27</a>
</span><span class=lnt id=hl-45-28><a class=lnlinks href=#hl-45-28>28</a>
</span><span class=lnt id=hl-45-29><a class=lnlinks href=#hl-45-29>29</a>
</span><span class=lnt id=hl-45-30><a class=lnlinks href=#hl-45-30>30</a>
</span><span class=lnt id=hl-45-31><a class=lnlinks href=#hl-45-31>31</a>
</span><span class=lnt id=hl-45-32><a class=lnlinks href=#hl-45-32>32</a>
</span><span class=lnt id=hl-45-33><a class=lnlinks href=#hl-45-33>33</a>
</span><span class=lnt id=hl-45-34><a class=lnlinks href=#hl-45-34>34</a>
</span><span class=lnt id=hl-45-35><a class=lnlinks href=#hl-45-35>35</a>
</span><span class=lnt id=hl-45-36><a class=lnlinks href=#hl-45-36>36</a>
</span><span class=lnt id=hl-45-37><a class=lnlinks href=#hl-45-37>37</a>
</span><span class=lnt id=hl-45-38><a class=lnlinks href=#hl-45-38>38</a>
</span><span class=lnt id=hl-45-39><a class=lnlinks href=#hl-45-39>39</a>
</span><span class=lnt id=hl-45-40><a class=lnlinks href=#hl-45-40>40</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python Flask에서 2단계 인증 구현</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pyotp</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>user</span> <span class=o>=</span> <span class=n>authenticate_credentials</span><span class=p>(</span><span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>user</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;login.html&#39;</span><span class=p>,</span> <span class=n>error</span><span class=o>=</span><span class=s1>&#39;Invalid credentials&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 사용자가 2FA를 활성화했는지 확인</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>user</span><span class=o>.</span><span class=n>two_factor_enabled</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 세션에 사용자 ID 저장하고 2FA 인증 페이지로 리디렉션</span>
</span></span><span class=line><span class=cl>        <span class=n>session</span><span class=p>[</span><span class=s1>&#39;pending_user_id&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>user</span><span class=o>.</span><span class=n>id</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;two_factor_auth&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 2FA가 활성화되지 않은 경우 바로 로그인</span>
</span></span><span class=line><span class=cl>    <span class=n>login_user</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;dashboard&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/2fa&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>two_factor_auth</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;pending_user_id&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>session</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;login&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>query</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>session</span><span class=p>[</span><span class=s1>&#39;pending_user_id&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>totp</span> <span class=o>=</span> <span class=n>pyotp</span><span class=o>.</span><span class=n>TOTP</span><span class=p>(</span><span class=n>user</span><span class=o>.</span><span class=n>otp_secret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>totp</span><span class=o>.</span><span class=n>verify</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;otp_code&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>            <span class=c1># 2FA 성공</span>
</span></span><span class=line><span class=cl>            <span class=k>del</span> <span class=n>session</span><span class=p>[</span><span class=s1>&#39;pending_user_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>login_user</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;dashboard&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;2fa.html&#39;</span><span class=p>,</span> <span class=n>error</span><span class=o>=</span><span class=s1>&#39;Invalid code&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;2fa.html&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>안전한 비밀번호 정책 시행</p><ul><li>최소 길이 요구</li><li>대소문자, 숫자, 특수 문자 조합 필요</li><li>흔한 비밀번호 및 이전에 사용한 비밀번호 거부</li><li>정기적인 비밀번호 변경 유도 (단, 너무 자주 변경 요구하지 않음)</li></ul></li></ol><h3 id=안전한-코딩-관련-조직-및-표준>안전한 코딩 관련 조직 및 표준<a hidden class=anchor aria-hidden=true href=#안전한-코딩-관련-조직-및-표준>#</a></h3><p>보안 코딩과 관련된 주요 조직 및 표준:</p><ol><li><strong>OWASP (Open Web Application Security Project)</strong>: 웹 애플리케이션 보안 커뮤니티로, 보안 위험 Top 10 목록, 테스트 가이드, 코드 리뷰 가이드 등을 제공.</li><li><strong>NIST (National Institute of Standards and Technology)</strong>: 미국 표준 기술 연구소로, 사이버 보안 프레임워크 및 가이드라인을 발표.</li><li><strong>ISO/IEC 27034</strong>: 애플리케이션 보안에 관한 국제 표준.</li><li><strong>CERT Secure Coding Standards</strong>: 다양한 프로그래밍 언어에 대한 보안 코딩 표준과 가이드라인을 제공.</li><li><strong>CWE (Common Weakness Enumeration)</strong>: 소프트웨어 보안 취약점의 공통 언어를 제공하는 목록. 개발자들이 코드에서 발생할 수 있는 일반적인 취약점을 이해하고 방지하는 데 도움을 준다.</li><li><strong>SANS (SysAdmin, Audit, Network, Security)</strong>: 정보 보안 연구 및 교육 기관으로, 보안 코딩 지침과 교육 프로그램을 제공한다.</li><li><strong>PCI DSS (Payment Card Industry Data Security Standard)</strong>: 신용카드 정보를 처리하는 모든 기업이 준수해야 하는 보안 표준.</li><li><strong>GDPR (General Data Protection Regulation)</strong>: 유럽연합의 개인정보 보호 규정으로, 소프트웨어 개발에서 데이터 보호 및 개인정보 처리에 관한 요구사항을 규정한다.</li></ol><h3 id=devsecops-개발-수명-주기에-보안-통합>DevSecOps: 개발 수명 주기에 보안 통합<a hidden class=anchor aria-hidden=true href=#devsecops-개발-수명-주기에-보안-통합>#</a></h3><p>DevSecOps는 개발, 보안, 운영 팀이 협력하여 소프트웨어 개발 수명 주기 전반에 걸쳐 보안을 통합하는 방식:</p><ol><li><p>계획 및 요구사항 단계</p><ul><li>보안 요구사항 정의</li><li>위협 모델링 수행</li><li>보안 사용 사례 개발</li></ul></li><li><p>개발 단계</p><ul><li>안전한 코딩 표준 적용</li><li>개발자 보안 교육</li><li>정적 코드 분석 도구 통합</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-46-1><a class=lnlinks href=#hl-46-1> 1</a>
</span><span class=lnt id=hl-46-2><a class=lnlinks href=#hl-46-2> 2</a>
</span><span class=lnt id=hl-46-3><a class=lnlinks href=#hl-46-3> 3</a>
</span><span class=lnt id=hl-46-4><a class=lnlinks href=#hl-46-4> 4</a>
</span><span class=lnt id=hl-46-5><a class=lnlinks href=#hl-46-5> 5</a>
</span><span class=lnt id=hl-46-6><a class=lnlinks href=#hl-46-6> 6</a>
</span><span class=lnt id=hl-46-7><a class=lnlinks href=#hl-46-7> 7</a>
</span><span class=lnt id=hl-46-8><a class=lnlinks href=#hl-46-8> 8</a>
</span><span class=lnt id=hl-46-9><a class=lnlinks href=#hl-46-9> 9</a>
</span><span class=lnt id=hl-46-10><a class=lnlinks href=#hl-46-10>10</a>
</span><span class=lnt id=hl-46-11><a class=lnlinks href=#hl-46-11>11</a>
</span><span class=lnt id=hl-46-12><a class=lnlinks href=#hl-46-12>12</a>
</span><span class=lnt id=hl-46-13><a class=lnlinks href=#hl-46-13>13</a>
</span><span class=lnt id=hl-46-14><a class=lnlinks href=#hl-46-14>14</a>
</span><span class=lnt id=hl-46-15><a class=lnlinks href=#hl-46-15>15</a>
</span><span class=lnt id=hl-46-16><a class=lnlinks href=#hl-46-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># GitLab CI/CD 파이프라인에 정적 분석 통합 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>stages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>security</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>security-scan</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>security</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>npm audit </span><span class=w> </span><span class=c># Node.js 종속성 검사</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sonar-scanner </span><span class=w> </span><span class=c># SonarQube 분석</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>owasp-dependency-check </span><span class=w> </span><span class=c># OWASP 종속성 검사</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>security-reports/</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>테스트 단계</p><ul><li>자동화된 보안 테스트 수행</li><li>침투 테스트</li><li>취약점 스캐닝</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-47-1><a class=lnlinks href=#hl-47-1>1</a>
</span><span class=lnt id=hl-47-2><a class=lnlinks href=#hl-47-2>2</a>
</span><span class=lnt id=hl-47-3><a class=lnlinks href=#hl-47-3>3</a>
</span><span class=lnt id=hl-47-4><a class=lnlinks href=#hl-47-4>4</a>
</span><span class=lnt id=hl-47-5><a class=lnlinks href=#hl-47-5>5</a>
</span><span class=lnt id=hl-47-6><a class=lnlinks href=#hl-47-6>6</a>
</span><span class=lnt id=hl-47-7><a class=lnlinks href=#hl-47-7>7</a>
</span><span class=lnt id=hl-47-8><a class=lnlinks href=#hl-47-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># GitLab CI/CD에 동적 보안 테스트 통합</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>dynamic-security</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>security</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zap-baseline.py -t https://staging-app.example.com </span><span class=w> </span><span class=c># OWASP ZAP 스캔</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>nikto -h https://staging-app.example.com </span><span class=w> </span><span class=c># Nikto 스캔</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>only</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>master</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>배포 단계</p><ul><li>안전한 배포 프로세스</li><li>인프라 보안 검사</li><li>비밀 관리 자동화</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-48-1><a class=lnlinks href=#hl-48-1>1</a>
</span><span class=lnt id=hl-48-2><a class=lnlinks href=#hl-48-2>2</a>
</span><span class=lnt id=hl-48-3><a class=lnlinks href=#hl-48-3>3</a>
</span><span class=lnt id=hl-48-4><a class=lnlinks href=#hl-48-4>4</a>
</span><span class=lnt id=hl-48-5><a class=lnlinks href=#hl-48-5>5</a>
</span><span class=lnt id=hl-48-6><a class=lnlinks href=#hl-48-6>6</a>
</span><span class=lnt id=hl-48-7><a class=lnlinks href=#hl-48-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># Docker 이미지 보안 스캔</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>container-scan</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>security</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>trivy image myapp:latest </span><span class=w> </span><span class=c># 컨테이너 취약점 스캔</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>only</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>master</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>모니터링 및 대응 단계</p><ul><li>보안 모니터링 및 로깅</li><li>자동화된 보안 인시던트 대응</li><li>정기적인 보안 감사</li></ul></li></ol><h3 id=보안-코딩-교육-및-문화>보안 코딩 교육 및 문화<a hidden class=anchor aria-hidden=true href=#보안-코딩-교육-및-문화>#</a></h3><p>조직 내 보안 코딩 문화를 구축하기 위한 방법:</p><ol><li><p>개발자 교육<br>정기적인 보안 코딩 교육과 훈련을 제공:</p><ul><li>보안 코딩 워크샵</li><li>온라인 학습 플랫폼</li><li>CTF(Capture The Flag) 경진대회</li><li>코드 리뷰 세션</li></ul></li><li><p>보안 챔피언 프로그램<br>각 개발 팀에 보안 챔피언을 지정하여 보안 관행을 촉진:</p><ul><li>보안 코드 리뷰 수행</li><li>팀 내 보안 지식 공유</li><li>보안 관련 질문에 대한 첫 번째 연락 지점 역할</li></ul></li><li><p>지속적인 보안 평가<br>애플리케이션 보안을 지속적으로 평가하고 개선:</p><ul><li>정기적인 보안 감사</li><li>자동화된 보안 스캔</li><li>침투 테스트</li><li>버그 바운티 프로그램</li></ul></li><li><p>보안 코딩 가이드라인<br>조직에 맞는 보안 코딩 가이드라인을 개발:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-49-1><a class=lnlinks href=#hl-49-1> 1</a>
</span><span class=lnt id=hl-49-2><a class=lnlinks href=#hl-49-2> 2</a>
</span><span class=lnt id=hl-49-3><a class=lnlinks href=#hl-49-3> 3</a>
</span><span class=lnt id=hl-49-4><a class=lnlinks href=#hl-49-4> 4</a>
</span><span class=lnt id=hl-49-5><a class=lnlinks href=#hl-49-5> 5</a>
</span><span class=lnt id=hl-49-6><a class=lnlinks href=#hl-49-6> 6</a>
</span><span class=lnt id=hl-49-7><a class=lnlinks href=#hl-49-7> 7</a>
</span><span class=lnt id=hl-49-8><a class=lnlinks href=#hl-49-8> 8</a>
</span><span class=lnt id=hl-49-9><a class=lnlinks href=#hl-49-9> 9</a>
</span><span class=lnt id=hl-49-10><a class=lnlinks href=#hl-49-10>10</a>
</span><span class=lnt id=hl-49-11><a class=lnlinks href=#hl-49-11>11</a>
</span><span class=lnt id=hl-49-12><a class=lnlinks href=#hl-49-12>12</a>
</span><span class=lnt id=hl-49-13><a class=lnlinks href=#hl-49-13>13</a>
</span><span class=lnt id=hl-49-14><a class=lnlinks href=#hl-49-14>14</a>
</span><span class=lnt id=hl-49-15><a class=lnlinks href=#hl-49-15>15</a>
</span><span class=lnt id=hl-49-16><a class=lnlinks href=#hl-49-16>16</a>
</span><span class=lnt id=hl-49-17><a class=lnlinks href=#hl-49-17>17</a>
</span><span class=lnt id=hl-49-18><a class=lnlinks href=#hl-49-18>18</a>
</span><span class=lnt id=hl-49-19><a class=lnlinks href=#hl-49-19>19</a>
</span><span class=lnt id=hl-49-20><a class=lnlinks href=#hl-49-20>20</a>
</span><span class=lnt id=hl-49-21><a class=lnlinks href=#hl-49-21>21</a>
</span><span class=lnt id=hl-49-22><a class=lnlinks href=#hl-49-22>22</a>
</span><span class=lnt id=hl-49-23><a class=lnlinks href=#hl-49-23>23</a>
</span><span class=lnt id=hl-49-24><a class=lnlinks href=#hl-49-24>24</a>
</span><span class=lnt id=hl-49-25><a class=lnlinks href=#hl-49-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># 회사 보안 코딩 가이드라인 예시
</span></span></span><span class=line><span class=cl><span class=gh></span>
</span></span><span class=line><span class=cl><span class=gu>## 1. 입력 검증
</span></span></span><span class=line><span class=cl><span class=gu></span><span class=k>-</span> 모든 사용자 입력은 서버 측에서 유효성을 검사해야 합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 문자열에는 허용 목록(allowlist) 접근 방식을 사용합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 숫자형 데이터는 범위를 검사합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 파일 업로드는 확장자, 크기, 콘텐츠 유형을 검증합니다.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>## 2. 데이터베이스 접근
</span></span></span><span class=line><span class=cl><span class=gu></span><span class=k>-</span> ORM 또는 매개변수화된 쿼리를 사용합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 직접 문자열 연결로 쿼리를 구성하지 않습니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 최소 권한 데이터베이스 계정을 사용합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 민감한 데이터는 항상 암호화합니다.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>## 3. 인증 및 세션 관리
</span></span></span><span class=line><span class=cl><span class=gu></span><span class=k>-</span> 다중 요소 인증을 지원합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 패스워드는 최소 12자리 이상이어야 합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 세션 ID는 URL에 노출되지 않아야 합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 세션 타임아웃을 적절하게 설정합니다.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>## 4. 암호화
</span></span></span><span class=line><span class=cl><span class=gu></span><span class=k>-</span> 최신 암호화 알고리즘과 라이브러리를 사용합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 자체 암호화 알고리즘을 만들지 않습니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 암호화 키는 안전하게 관리합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 전송 중인 모든 데이터에 TLS를 사용합니다.
</span></span></code></pre></td></tr></table></div></div></li></ol><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/software-design-and-architecture/>Software-Design-and-Architecture</a></li><li><a href=https://buenhyden.github.io/tags/secure-coding/>Secure-Coding</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/quality-assurance/sdlc/1-planning/><span class=title>« Prev</span><br><span>1. 계획 (Planning)</span>
</a><a class=next href=https://buenhyden.github.io/posts/computer-science-fundamentals/fundamentals/encoding-and-decoding/character/types/cp949/><span class=title>Next »</span><br><span>CP949</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>