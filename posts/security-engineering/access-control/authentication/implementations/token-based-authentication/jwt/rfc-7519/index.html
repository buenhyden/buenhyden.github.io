<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>RFC 7519 | hyunyoun's Blog</title><meta name=keywords content="Backend-Development,API-Design,Authentication-Methods,JWT"><meta name=description content="2015년 5월에 Internet Engineering Task Force(IETF)에 의해 발행된 이 문서는 JWT의 구조, 형식, 서명 방법, 암호화 방법 등을 상세히 정의하고 있다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/security-engineering/access-control/authentication/implementations/token-based-authentication/jwt/rfc-7519/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/security-engineering/access-control/authentication/implementations/token-based-authentication/jwt/rfc-7519/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/security-engineering/access-control/authentication/implementations/token-based-authentication/jwt/rfc-7519/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="RFC 7519"><meta property="og:description" content="2015년 5월에 Internet Engineering Task Force(IETF)에 의해 발행된 이 문서는 JWT의 구조, 형식, 서명 방법, 암호화 방법 등을 상세히 정의하고 있다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-06T03:33:00+00:00"><meta property="article:modified_time" content="2025-02-06T03:33:00+00:00"><meta property="article:tag" content="Backend-Development"><meta property="article:tag" content="API-Design"><meta property="article:tag" content="Authentication-Methods"><meta property="article:tag" content="JWT"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="RFC 7519"><meta name=twitter:description content="2015년 5월에 Internet Engineering Task Force(IETF)에 의해 발행된 이 문서는 JWT의 구조, 형식, 서명 방법, 암호화 방법 등을 상세히 정의하고 있다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"RFC 7519","item":"https://buenhyden.github.io/posts/security-engineering/access-control/authentication/implementations/token-based-authentication/jwt/rfc-7519/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"RFC 7519","name":"RFC 7519","description":"2015년 5월에 Internet Engineering Task Force(IETF)에 의해 발행된 이 문서는 JWT의 구조, 형식, 서명 방법, 암호화 방법 등을 상세히 정의하고 있다.","keywords":["Backend-Development","API-Design","Authentication-Methods","JWT"],"articleBody":"RFC 7519 RFC 7519는 JSON Web Token(JWT)에 대한 공식 인터넷 표준 문서이다.\n2015년 5월에 Internet Engineering Task Force(IETF)에 의해 발행된 이 문서는 JWT의 구조, 형식, 서명 방법, 암호화 방법 등을 상세히 정의하고 있다. JWT는 당사자 간에 안전하게 정보를 전송하기 위한 간결하고 자체 포함적인 방법을 제공하는 개방형 표준이다.\nJWT는 현대 웹 애플리케이션과 마이크로서비스 아키텍처에서 인증 및 정보 교환을 위한 핵심 기술로 자리 잡았다. 특히 Single Sign-On(SSO), API 인증, 정보의 안전한 전송 등 다양한 사용 사례에서 널리 활용되고 있다.\nRFC 7519는 Michael B. Jones, John Bradley, Nat Sakimura가 작성했으며, JWT의 기반이 되는 JSON Web Signature(JWS, RFC 7515) 및 JSON Web Encryption(JWE, RFC 7516) 표준과 밀접하게 연관되어 있다.\nJWT의 기본 개념과 구조 JWT의 정의 JWT는 당사자 간에 클레임(claim)을 안전하게 표현하기 위한 컴팩트하고 URL-safe한 수단이다. 클레임이란 어떤 주체(subject)에 대한 진술이나 정보를 의미한다. 예를 들어, 사용자의 신원, 권한, 또는 기타 데이터 등이 클레임에 포함될 수 있다.\nJWT의 기본 구조 JWT는 세 부분으로 구성되며, 각 부분은 점(.)으로 구분된다:\n1 xxxxx.yyyyy.zzzzz 이 세 부분은 각각 다음과 같다:\n헤더(Header): JWT의 유형과 사용된 서명 알고리즘을 지정한다. 페이로드(Payload): 전송하려는 클레임들을 포함한다. 서명(Signature): 토큰의 무결성을 검증하기 위한 서명 부분이다. 각 부분은 Base64Url로 인코딩되어 있어, URL에서 안전하게 사용할 수 있다.\n헤더(Header) 헤더는 일반적으로 두 가지 정보를 담고 있다:\ntyp (Type): 토큰의 유형을 지정한다. 일반적으로 “JWT\"이다. alg (Algorithm): 서명 생성에 사용된 알고리즘을 지정한다. 예: HMAC SHA256 (HS256), RSA SHA256 (RS256) 등 예시:\n1 2 3 4 { \"alg\": \"HS256\", \"typ\": \"JWT\" } 페이로드(Payload) 페이로드는 토큰이 전달하려는 클레임들을 포함한다.\nRFC 7519는 클레임을 세 가지 유형으로 분류한다:\n등록된 클레임(Registered Claims): 미리 정의된 클레임으로, 필수는 아니지만 권장된다. iss (Issuer): 토큰 발급자 sub (Subject): 토큰 제목 aud (Audience): 토큰 대상자 exp (Expiration Time): 토큰 만료 시간 nbf (Not Before): 이 시간 이전에는 토큰이 유효하지 않음 iat (Issued At): 토큰 발급 시간 jti (JWT ID): 토큰의 고유 식별자 공개 클레임(Public Claims): JWT 사용자가 정의할 수 있지만, 충돌 방지를 위해 IANA JSON Web Token Registry에 등록하거나 충돌 방지 이름(Collision-Resistant Name)을 포함해야 한다. 비공개 클레임(Private Claims): 사용 당사자 간에 정보를 공유하기 위해 생성된 맞춤형 클레임이다. 예시:\n1 2 3 4 5 6 7 { \"sub\": \"1234567890\", \"name\": \"John Doe\", \"admin\": true, \"iat\": 1516239022, \"exp\": 1516242622 } 서명(Signature) 서명은 JWT의 무결성을 검증하고 발신자를 인증하는 데 사용된다. 서명은 인코딩된 헤더, 인코딩된 페이로드, 비밀 키, 헤더에 지정된 알고리즘을 사용하여 생성된다.\n예를 들어, HMAC SHA256 알고리즘을 사용하는 경우:\n1 2 3 4 5 HMACSHA256( base64UrlEncode(header) + \".\" + base64UrlEncode(payload), secret ) 이 서명은 메시지가 도중에 변경되지 않았는지 확인하는 데 사용되며, 비밀 키로 서명된 토큰의 경우 발신자의 신원도 확인할 수 있다.\nJWT의 서명 및 암호화 알고리즘 RFC 7519는 JWT의 서명과 암호화를 위한 여러 알고리즘을 지원한다.\n서명 알고리즘 JWT는 다양한 서명 알고리즘을 지원하며, 주요 알고리즘은 다음과 같다:\nHMAC(Hash-based Message Authentication Code) 알고리즘: HS256: HMAC using SHA-256 HS384: HMAC using SHA-384 HS512: HMAC using SHA-512 RSA(Rivest-Shamir-Adleman) 알고리즘: RS256: RSA Signature with SHA-256 RS384: RSA Signature with SHA-384 RS512: RSA Signature with SHA-512 ECDSA(Elliptic Curve Digital Signature Algorithm) 알고리즘: ES256: ECDSA using P-256 curve and SHA-256 ES384: ECDSA using P-384 curve and SHA-384 ES512: ECDSA using P-521 curve and SHA-512 무서명 JWT: none: 서명 없음 (보안상의 이유로 일반적으로 권장되지 않음) 각 알고리즘의 특징 및 적용 사례 HMAC 기반 알고리즘: 대칭 암호화 방식으로, 동일한 비밀 키를 사용하여 서명 생성 및 검증 구현이 간단하고 빠른 성능 주로 단일 시스템 내에서 사용되거나 안전하게 비밀 키를 공유할 수 있는 경우에 적합 사용 사례: 동일한 조직 내 서비스 간 통신 RSA 기반 알고리즘: 비대칭 암호화 방식으로, 개인 키로 서명을 생성하고 공개 키로 검증 키 배포가 더 안전함 (공개 키는 공개적으로 공유 가능) 상대적으로 더 많은 컴퓨팅 리소스 필요 사용 사례: 여러 클라이언트가 토큰을 검증해야 하는 공개 API ECDSA 기반 알고리즘: 비대칭 암호화 방식으로, RSA와 유사하지만 더 작은 키 크기로 동등한 보안 제공 더 높은 성능과 더 작은 서명 크기 사용 사례: 모바일 애플리케이션, IoT 디바이스 등 리소스 제약이 있는 환경 암호화 알고리즘 JWT는 JWE(JSON Web Encryption) 사양을 통해 페이로드 암호화를 지원한다.\n주요 암호화 알고리즘은 다음과 같다:\n키 암호화 알고리즘: RSA1_5: RSAES-PKCS1-v1_5 RSA-OAEP: RSAES OAEP using default parameters A128KW, A192KW, A256KW: AES Key Wrap with 128, 192, 256-bit keys 콘텐츠 암호화 알고리즘: A128CBC-HS256: AES CBC mode with HMAC SHA-256 A192CBC-HS384: AES CBC mode with HMAC SHA-384 A256CBC-HS512: AES CBC mode with HMAC SHA-512 A128GCM, A192GCM, A256GCM: AES GCM mode with 128, 192, 256-bit keys 암호화된 JWT(JWE)는 다섯 부분으로 구성되며, 각 부분은 점(.)으로 구분된다:\n1 header.encrypted_key.initialization_vector.ciphertext.authentication_tag JWT의 보안 고려사항 RFC 7519는 JWT 사용 시 고려해야 할 여러 보안 사항을 명시하고 있다.\n알고리즘 선택과 관련된 보안 문제 알고리즘 강제(Algorithm Forcing) 공격: 공격자가 alg 값을 none으로 변경하여 서명 검증을 우회하려는 시도 방어: none 알고리즘 사용을 명시적으로 금지하고, 예상되는 알고리즘을 강제 적용 알고리즘 교체(Algorithm Substitution) 공격: 공격자가 알고리즘을 대칭키(HMAC)에서 비대칭키(RSA)로 변경하여 공개키를 비밀키로 사용하게 하는 공격 방어: 토큰 검증 시 사용할 알고리즘을 미리 결정하고 고정 토큰 수명 관리 만료 시간 설정: 모든 JWT에 적절한 만료 시간(exp 클레임)을 설정해야 함 애플리케이션 요구사항에 따라 짧게(몇 분에서 몇 시간) 설정하는 것이 좋음 토큰 갱신(Refresh) 메커니즘: 짧은 만료 시간을 가진 액세스 토큰과 더 긴 만료 시간을 가진 갱신 토큰의 조합 사용 액세스 토큰이 만료되면 갱신 토큰을 사용하여 새 액세스 토큰 발급 토큰 저장 및 전송 클라이언트 측 저장: httpOnly 플래그가 설정된 쿠키에 저장(XSS 공격으로부터 보호) Secure 플래그를 사용하여 HTTPS를 통해서만 전송 SameSite 속성을 설정하여 CSRF 공격 방지 토큰 전송: Authorization 헤더를 통한 전송: Authorization: Bearer 쿼리 파라미터로 전송하는 것은 보안상 권장되지 않음(로그에 노출될 수 있음) 페이로드 보안 민감한 정보 처리:\nJWT의 페이로드는 단순히 Base64Url로 인코딩되어 있어 누구나 디코딩할 수 있음 비밀번호, 개인식별정보 등 민감한 정보는 포함하지 않아야 함 민감한 정보가 필요한 경우 JWE를 사용하여 페이로드 전체를 암호화해야 함 토큰 크기 관리:\n페이로드에 너무 많은 정보를 포함하면 토큰 크기가 커져 성능에 영향을 미칠 수 있음 필요한 최소한의 정보만 포함하는 것이 좋음 서명 검증 서명 무결성 보장: 모든 JWT 검증 시 서명을 철저히 검증해야 함 서명 검증을 건너뛰지 않도록 주의 키 관리: 서명 및 암호화에 사용되는 키를 안전하게 관리 정기적인 키 교체(rotation) 메커니즘 구현 JWT 클레임(Claims)의 상세 설명 RFC 7519는 JWT에서 사용할 수 있는 여러 표준 클레임을 정의하고 있습니다. 이러한 클레임은 토큰에 대한 메타데이터와 조건을 제공합니다.\n5.1 등록된 클레임(Registered Claims) 등록된 클레임은 상호 운용성을 위해 IANA JWT Claims Registry에 등록된 미리 정의된 클레임입니다:\niss (Issuer):\n토큰을 발행한 주체(발급자)를 식별 일반적으로 URL 형식의 문자열(예: “https://auth.example.com”) 수신자는 이 값을 사용하여 특정 발급자로부터의 토큰만 수락하도록 제한 가능 sub (Subject):\n토큰이 나타내는 주체(일반적으로 사용자)를 식별 발급자 내에서 고유해야 함(예: 사용자 ID) 수신자는 이 값을 사용하여 특정 사용자와 관련된 작업을 수행 aud (Audience):\n토큰의 의도된 수신자를 식별 문자열 또는 문자열 배열 가능 수신자는 자신이 이 목록에 포함되어 있는지 확인해야 함 exp (Expiration Time):\n토큰이 만료되는 시간(NumericDate 형식, Unix 시간(초)) 이 시간 이후에는 토큰이 거부되어야 함 약간의 시계 편차(일반적으로 몇 분)를 허용하는 것이 좋음 nbf (Not Before):\n토큰이 유효해지는 시작 시간(NumericDate 형식) 이 시간 이전에는 토큰이 거부되어야 함 미래 시간으로 설정하여 토큰의 사용을 지연시킬 수 있음 iat (Issued At):\n토큰이 발행된 시간(NumericDate 형식) 토큰의 나이를 결정하는 데 사용 가능 토큰 갱신 정책에 활용 가능 jti (JWT ID):\n토큰의 고유 식별자 중복 처리, 재생 공격 방지 등에 사용 발급자는 각 토큰에 고유한 값을 할당해야 함 5.2 공개 클레임(Public Claims) 공개 클레임은 JWT 사용자가 정의할 수 있지만, 이름 충돌을 방지하기 위한 조치가 필요합니다:\nIANA JWT Claims Registry에 등록:\n표준화된 클레임 사용을 위해 공식 레지스트리에 등록 예: name, email, preferred_username 등 충돌 방지 이름(Collision-Resistant Name) 사용:\n도메인 이름을 접두사로 사용(예: https://example.com/claims/role) URI 형식으로 정의하여 충돌 방지 공개 클레임의 예:\n1 2 3 4 5 { \"name\": \"John Doe\", \"email\": \"john.doe@example.com\", \"https://example.com/roles\": [\"admin\", \"user\"] } 5.3 비공개 클레임(Private Claims) 비공개 클레임은 당사자 간에 합의된 정보를 공유하기 위한 맞춤형 클레임입니다:\n등록된 클레임이나 공개 클레임과 충돌하지 않는 이름 사용 발급자와 소비자 간에 의미가 이해되어야 함 일반적으로 특정 애플리케이션이나 컨텍스트에 한정된 정보 비공개 클레임의 예:\n1 2 3 4 5 6 { \"user_id\": 123456, \"role\": \"manager\", \"organization\": \"Engineering\", \"permissions\": [\"read\", \"write\", \"delete\"] } 6. JWT 사용 패턴 및 모범 사례 RFC 7519와 업계 모범 사례를 기반으로 한 JWT의 효과적인 사용 패턴을 살펴보겠습니다.\n6.1 인증 및 권한 부여 패턴 액세스 토큰/갱신 토큰 패턴:\n짧은 수명의 액세스 토큰(몇 분몇 시간)과 긴 수명의 갱신 토큰(며칠몇 주) 사용 액세스 토큰이 만료되면 갱신 토큰을 사용하여 새 액세스 토큰 발급 갱신 토큰은 데이터베이스에 저장하고 필요시 취소 가능하게 관리 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 클라이언트 서버 | | |-- 로그인 (username, password) --\u003e | | | |\u003c-- 액세스 토큰 + 갱신 토큰 ------| | | |-- 요청 + 액세스 토큰 -----------\u003e | |\u003c-- 응답 ------------------------- | | | |-- 요청 + 만료된 액세스 토큰 ----\u003e | |\u003c-- 401 Unauthorized ------------- | | | |-- 갱신 요청 + 갱신 토큰 --------\u003e | |\u003c-- 새 액세스 토큰 + 새 갱신 토큰 -| | | 상태 비저장(Stateless) JWT vs. 상태 저장(Stateful) JWT:\n상태 비저장: 토큰에 모든 필요한 정보 포함, 서버에 저장 안 함 장점: 확장성 좋음, 데이터베이스 조회 불필요 단점: 토큰 취소 어려움, 크기가 클 수 있음 상태 저장: 토큰에 최소한의 정보만 포함하고 서버에 나머지 정보 저장 장점: 토큰 취소 용이, 작은 토큰 크기 단점: 데이터베이스 조회 필요, 복잡한 구현 자체 포함(Self-contained) 권한:\nJWT에 사용자 역할, 권한 등을 포함하여 별도 조회 없이 권한 부여 결정\n예:\n1 { \"sub\": \"1234567890\", \"roles\": [\"admin\", \"editor\"], \"permissions\": [\"read:users\", \"write:users\"]} 6.2 토큰 관리 모범 사례 적절한 만료 시간 설정:\n액세스 토큰: 15분~2시간 (보안 요구사항에 따라 조정) 갱신 토큰: 7일~30일 (필요에 따라 조정) 위험도가 높은 작업은 더 짧은 만료 시간 적용 토큰 취소 메커니즘:\n블랙리스트: 취소된 토큰의 jti를 저장하여 검증 시 확인 화이트리스트: 유효한 토큰만 목록에 유지 Redis와 같은 인메모리 데이터 저장소 사용 권장 키 관리(Key Management):\n정기적인 키 교체(rotation) 구현 (일반적으로 3~6개월마다) 키 ID(kid) 헤더 파라미터 사용하여 여러 키 관리 HSM(Hardware Security Module) 또는 KMS(Key Management Service) 사용 권장 토큰 크기 최적화:\n필요한 최소한의 클레임만 포함 긴 클레임 이름 대신 짧은 이름 사용 고려 중요한 메타데이터에만 등록된 클레임 사용 6.3 보안 강화 방법 서명 알고리즘 권장사항:\n대칭 키: HS256 이상 사용(HS384, HS512 권장) 비대칭 키: RS256 이상 또는 ES256 이상 권장 알고리즘 없음(\"alg\": \"none\")은 절대 사용 금지 토큰 사용 제한:\naud 클레임을 사용하여 특정 서비스만 토큰을 사용하도록 제한 scope 또는 scp 클레임을 사용하여 토큰의 권한 범위 제한 CSRF 및 XSS 방어:\nJWT를 httpOnly 및 Secure 플래그가 설정된 쿠키에 저장 SameSite=Strict 또는 SameSite=Lax 쿠키 설정 사용 브라우저 내 스토리지(localStorage, sessionStorage)를 사용할 경우 XSS 대비 강화 토큰 무결성 검증:\n모든 필수 클레임 존재 여부 검증 예상되는 발급자(iss), 대상(aud) 확인 토큰 유형(typ) 확인 JWT 구현 예제 다양한 프로그래밍 언어에서 JWT를 구현하는 방법\nNode.js에서의 JWT 구현 jsonwebtoken 라이브러리를 사용한 예제:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 const jwt = require('jsonwebtoken'); // JWT 생성 function generateToken(user) { const payload = { sub: user.id, name: user.name, email: user.email, roles: user.roles, iat: Math.floor(Date.now() / 1000), exp: Math.floor(Date.now() / 1000) + (60 * 60) // 1시간 후 만료 }; return jwt.sign(payload, process.env.JWT_SECRET, { algorithm: 'HS256' }); } // JWT 검증 function verifyToken(token) { try { const decoded = jwt.verify(token, process.env.JWT_SECRET, { algorithms: ['HS256'] // 허용할 알고리즘 명시적 지정 }); return { valid: true, data: decoded }; } catch (err) { return { valid: false, error: err.message }; } } // 미들웨어로 사용 예 function authMiddleware(req, res, next) { const authHeader = req.headers.authorization; if (!authHeader || !authHeader.startsWith('Bearer ')) { return res.status(401).json({ message: 'Authentication required' }); } const token = authHeader.split(' ')[1]; const result = verifyToken(token); if (!result.valid) { return res.status(401).json({ message: 'Invalid token' }); } req.user = result.data; next(); } Python에서의 JWT 구현 PyJWT 라이브러리를 사용한 예제:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 import jwt import datetime import os from functools import wraps from flask import Flask, request, jsonify app = Flask(__name__) JWT_SECRET = os.environ.get('JWT_SECRET', 'default-secret') # JWT 생성 def generate_token(user): payload = { 'sub': str(user['id']), 'name': user['name'], 'email': user['email'], 'roles': user['roles'], 'iat': datetime.datetime.utcnow(), 'exp': datetime.datetime.utcnow() + datetime.timedelta(hours=1) } return jwt.encode(payload, JWT_SECRET, algorithm='HS256') # JWT 검증 def verify_token(token): try: return jwt.decode(token, JWT_SECRET, algorithms=['HS256']) except jwt.ExpiredSignatureError: return None # 토큰 만료 except jwt.InvalidTokenError: return None # 유효하지 않은 토큰 # 미들웨어로 사용 예 def token_required(f): @wraps(f) def decorated(*args, **kwargs): auth_header = request.headers.get('Authorization') if not auth_header or not auth_header.startswith('Bearer '): return jsonify({'message': 'Authentication required'}), 401 token = auth_header.split(' ')[1] user_data = verify_token(token) if not user_data: return jsonify({'message': 'Invalid token'}), 401 request.user = user_data return f(*args, **kwargs) return decorated # 라우트 예제 @app.route('/api/protected') @token_required def protected_route(): return jsonify({'message': 'Access granted', 'user': request.user}) @app.route('/api/login', methods=['POST']) def login(): # 실제 구현에서는 데이터베이스에서 사용자 검증 필요 user = { 'id': 123, 'name': 'Test User', 'email': 'test@example.com', 'roles': ['user'] } token = generate_token(user) return jsonify({'token': token}) Java에서의 JWT 구현 jjwt 라이브러리를 사용한 예제:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 import io.jsonwebtoken.Claims; import io.jsonwebtoken.Jwts; import io.jsonwebtoken.SignatureAlgorithm; import io.jsonwebtoken.security.Keys; import org.springframework.security.core.userdetails.UserDetails; import org.springframework.stereotype.Component; import java.security.Key; import java.util.Date; import java.util.HashMap; import java.util.Map; import java.util.function.Function; @Component public class JwtUtil { private final Key key = Keys.secretKeyFor(SignatureAlgorithm.HS256); private final long JWT_TOKEN_VALIDITY = 60 * 60 * 1000; // 1시간 // JWT 토큰에서 사용자 이름 추출 public String extractUsername(String token) { return extractClaim(token, Claims::getSubject); } // JWT 토큰에서 만료 날짜 추출 public Date extractExpiration(String token) { return extractClaim(token, Claims::getExpiration); } // JWT 토큰에서 클레임 추출 public \u003cT\u003e T extractClaim(String token, Function\u003cClaims, T\u003e claimsResolver) { final Claims claims = extractAllClaims(token); return claimsResolver.apply(claims); } // 모든 클레임 추출 private Claims extractAllClaims(String token) { return Jwts.parserBuilder() .setSigningKey(key) .build() .parseClaimsJws(token) .getBody(); } // 토큰 만료 확인 private Boolean isTokenExpired(String token) { return extractExpiration(token).before(new Date()); } // 사용자에 대한 JWT 토큰 생성 public String generateToken(UserDetails userDetails) { Map\u003cString, Object\u003e claims = new HashMap\u003c\u003e(); return createToken(claims, userDetails.getUsername()); } // JWT 토큰 생성 private String createToken(Map\u003cString, Object\u003e claims, String subject) { return Jwts.builder() .setClaims(claims) .setSubject(subject) .setIssuedAt(new Date(System.currentTimeMillis())) .setExpiration(new Date(System.currentTimeMillis() + JWT_TOKEN_VALIDITY)) .signWith(key) .compact(); } // JWT 토큰 검증 public Boolean validateToken(String token, UserDetails userDetails) { final String username = extractUsername(token); return (username.equals(userDetails.getUsername()) \u0026\u0026 !isTokenExpired(token)); } } 8. JWT 관련 도구 및 라이브러리 JWT 작업을 위한 유용한 도구와 라이브러리\n디버깅 및 검사 도구 jwt.io: JWT 디코딩, 검증, 생성을 위한 온라인 도구 다양한 알고리즘 지원 토큰 구조 시각화 제공 JSON Web Token Debugger Chrome Extension: 브라우저에서 직접 JWT 디코딩 및 검사 개발 및 디버깅 시 유용 JWT Validator: JWT 검증 도구 다양한 서명 알고리즘 지원 주요 JWT 라이브러리 다양한 프로그래밍 언어별 주요 JWT 라이브러리:\nJavaScript/Node.js: jsonwebtoken: Node.js에서 가장 인기 있는 JWT 라이브러리 jose: 완전한 JSON Object Signing and Encryption 구현 Python: PyJWT: 가볍고 사용하기 쉬운 JWT 라이브러리 python-jose: JWS, JWE, JWK, JWA 구현 포함 Java: jjwt: 사용하기 쉬운 JWT 생성 및 검증 java-jwt: Auth0에서 제공하는 JWT 라이브러리 C#/.NET: System.IdentityModel.Tokens.Jwt:.NET 공식 JWT 라이브러리 jose-jwt: JWS, JWE, JWK, JWA 구현 PHP: firebase/php-jwt: 간단한 JWT 인코딩/디코딩 라이브러리 lcobucci/jwt: 더 완전한 구현 Ruby: ruby-jwt: Ruby에서의 JWT 구현 Go: golang-jwt/jwt: Go에서 가장 인기 있는 JWT 구현 JWT 관련 프레임워크 통합 많은 웹 프레임워크와 인증 시스템이 JWT를 지원:\nSpring Security (Java): JWT 기반 인증 지원 OAuth2 및 JWT 통합 Passport.js (Node.js): passport-jwt 전략 제공 Express.js와 쉽게 통합 Django REST Framework (Python): djangorestframework-simplejwt 패키지 JWT 인증 제공 ASP.NET Core (C#): 내장 JWT 인증 미들웨어 쉬운 설정 및 통합 Laravel (PHP): tymon/jwt-auth 패키지 JWT 인증 지원 JWT와 관련 표준 JWT는 더 큰 JSON 객체 서명 및 암호화(JOSE) 프레임워크의 일부이다.\nJOSE 프레임워크 JSON Object Signing and Encryption(JOSE) 프레임워크는 JSON 데이터 구조를 사용하여 보안 서비스를 제공하는 표준 모음:\nJWS(JSON Web Signature) - RFC 7515: JSON 데이터 구조 서명을 위한 표준 데이터 무결성과 출처 인증 제공 JWT의 서명 메커니즘 정의 JWE(JSON Web Encryption) - RFC 7516: JSON 데이터 구조 암호화를 위한 표준 기밀성 제공 JWT의 암호화 메커니즘 정의 JWK(JSON Web Key) - RFC 7517: 암호화 키를 JSON 형식으로 표현하는 표준 키 정보 교환에 사용 공개 키 인프라(PKI)를 단순화 JWA(JSON Web Algorithms) - RFC 7518: JWS, JWE, JWK에서 사용되는 암호화 알고리즘 정의 서명, 암호화, 키 암호화, 콘텐츠 암호화 등을 위한 알고리즘 지정 OpenID Connect와 JWT JWT는 OpenID Connect(OIDC) 프로토콜의 핵심 구성 요소이다:\nID 토큰: OpenID Connect의 핵심 개념 사용자 인증 정보를 포함하는 JWT iss, sub, aud, exp, iat 등의 표준 클레임 포함 UserInfo 응답: 선택적으로 JWT 형식으로 제공 가능 사용자 프로필 정보 포함 클라이언트 등록: JWT를 사용한 클라이언트 인증 지원 OAuth 2.0과 JWT JWT는 OAuth 2.0 프로토콜에서 여러 방식으로 활용된다:\nBearer 토큰 형식: JWT는 OAuth 2.0에서 액세스 토큰으로 사용 가능 RFC 6750에 정의된 Bearer 토큰 전송 방식 사용 클라이언트 인증: JWT를 사용한 클라이언트 인증 RFC 7523에 정의된 JWT 프로필 토큰 교환: JWT 교환을 위한 OAuth 2.0 확장(JWT Bearer Token Flow) 한 도메인의 JWT를 다른 도메인에서 사용 가능한 토큰으로 교환 용어 정리 용어 설명 참고 및 출처 ","wordCount":"2812","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2025-02-06T03:33:00Z","dateModified":"2025-02-06T03:33:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/security-engineering/access-control/authentication/implementations/token-based-authentication/jwt/rfc-7519/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a></div><h1 class="post-title entry-hint-parent">RFC 7519</h1><div class=post-description>2015년 5월에 Internet Engineering Task Force(IETF)에 의해 발행된 이 문서는 JWT의 구조, 형식, 서명 방법, 암호화 방법 등을 상세히 정의하고 있다.</div><div class=post-meta><span title='2025-02-06 03:33:00 +0000 UTC'>February 6, 2025</span>&nbsp;·&nbsp;14 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/Security%20Engineering/Access%20Control/Authentication/Implementations/Token-Based%20Authentication/JWT/rfc-7519.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#rfc-7519>RFC 7519</a><ul><li><a href=#jwt의-기본-개념과-구조>JWT의 기본 개념과 구조</a></li><li><a href=#jwt의-서명-및-암호화-알고리즘>JWT의 서명 및 암호화 알고리즘</a></li><li><a href=#jwt의-보안-고려사항>JWT의 보안 고려사항</a></li><li><a href=#jwt-클레임claims의-상세-설명>JWT 클레임(Claims)의 상세 설명</a></li><li><a href=#6-jwt-사용-패턴-및-모범-사례>6. JWT 사용 패턴 및 모범 사례</a></li><li><a href=#jwt-구현-예제>JWT 구현 예제</a></li><li><a href=#8-jwt-관련-도구-및-라이브러리>8. JWT 관련 도구 및 라이브러리</a></li><li><a href=#jwt와-관련-표준>JWT와 관련 표준</a></li></ul></li><li><a href=#용어-정리>용어 정리</a></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=rfc-7519>RFC 7519<a hidden class=anchor aria-hidden=true href=#rfc-7519>#</a></h2><p>RFC 7519는 JSON Web Token(JWT)에 대한 공식 인터넷 표준 문서이다.<br>2015년 5월에 Internet Engineering Task Force(IETF)에 의해 발행된 이 문서는 JWT의 구조, 형식, 서명 방법, 암호화 방법 등을 상세히 정의하고 있다. JWT는 당사자 간에 안전하게 정보를 전송하기 위한 간결하고 자체 포함적인 방법을 제공하는 개방형 표준이다.</p><p>JWT는 현대 웹 애플리케이션과 마이크로서비스 아키텍처에서 인증 및 정보 교환을 위한 핵심 기술로 자리 잡았다. 특히 Single Sign-On(SSO), API 인증, 정보의 안전한 전송 등 다양한 사용 사례에서 널리 활용되고 있다.</p><p>RFC 7519는 Michael B. Jones, John Bradley, Nat Sakimura가 작성했으며, JWT의 기반이 되는 JSON Web Signature(JWS, RFC 7515) 및 JSON Web Encryption(JWE, RFC 7516) 표준과 밀접하게 연관되어 있다.</p><h3 id=jwt의-기본-개념과-구조>JWT의 기본 개념과 구조<a hidden class=anchor aria-hidden=true href=#jwt의-기본-개념과-구조>#</a></h3><h4 id=jwt의-정의>JWT의 정의<a hidden class=anchor aria-hidden=true href=#jwt의-정의>#</a></h4><p>JWT는 당사자 간에 클레임(claim)을 안전하게 표현하기 위한 컴팩트하고 URL-safe한 수단이다. 클레임이란 어떤 주체(subject)에 대한 진술이나 정보를 의미한다. 예를 들어, 사용자의 신원, 권한, 또는 기타 데이터 등이 클레임에 포함될 수 있다.</p><h4 id=jwt의-기본-구조>JWT의 기본 구조<a hidden class=anchor aria-hidden=true href=#jwt의-기본-구조>#</a></h4><p>JWT는 세 부분으로 구성되며, 각 부분은 점(.)으로 구분된다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>xxxxx.yyyyy.zzzzz
</span></span></code></pre></td></tr></table></div></div><p>이 세 부분은 각각 다음과 같다:</p><ol><li><strong>헤더(Header)</strong>: JWT의 유형과 사용된 서명 알고리즘을 지정한다.</li><li><strong>페이로드(Payload)</strong>: 전송하려는 클레임들을 포함한다.</li><li><strong>서명(Signature)</strong>: 토큰의 무결성을 검증하기 위한 서명 부분이다.</li></ol><p>각 부분은 Base64Url로 인코딩되어 있어, URL에서 안전하게 사용할 수 있다.</p><h4 id=헤더header>헤더(Header)<a hidden class=anchor aria-hidden=true href=#헤더header>#</a></h4><p>헤더는 일반적으로 두 가지 정보를 담고 있다:</p><ul><li><code>typ</code> (Type): 토큰의 유형을 지정한다. 일반적으로 &ldquo;JWT"이다.</li><li><code>alg</code> (Algorithm): 서명 생성에 사용된 알고리즘을 지정한다. 예: HMAC SHA256 (HS256), RSA SHA256 (RS256) 등</li></ul><p>예시:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;alg&#34;</span><span class=p>:</span> <span class=s2>&#34;HS256&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;typ&#34;</span><span class=p>:</span> <span class=s2>&#34;JWT&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=페이로드payload>페이로드(Payload)<a hidden class=anchor aria-hidden=true href=#페이로드payload>#</a></h4><p>페이로드는 토큰이 전달하려는 클레임들을 포함한다.</p><p>RFC 7519는 클레임을 세 가지 유형으로 분류한다:</p><ol><li><strong>등록된 클레임(Registered Claims)</strong>: 미리 정의된 클레임으로, 필수는 아니지만 권장된다.<ul><li><code>iss</code> (Issuer): 토큰 발급자</li><li><code>sub</code> (Subject): 토큰 제목</li><li><code>aud</code> (Audience): 토큰 대상자</li><li><code>exp</code> (Expiration Time): 토큰 만료 시간</li><li><code>nbf</code> (Not Before): 이 시간 이전에는 토큰이 유효하지 않음</li><li><code>iat</code> (Issued At): 토큰 발급 시간</li><li><code>jti</code> (JWT ID): 토큰의 고유 식별자</li></ul></li><li><strong>공개 클레임(Public Claims)</strong>: JWT 사용자가 정의할 수 있지만, 충돌 방지를 위해 IANA JSON Web Token Registry에 등록하거나 충돌 방지 이름(Collision-Resistant Name)을 포함해야 한다.</li><li><strong>비공개 클레임(Private Claims)</strong>: 사용 당사자 간에 정보를 공유하기 위해 생성된 맞춤형 클레임이다.</li></ol><p>예시:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3>3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4>4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5>5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6>6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;sub&#34;</span><span class=p>:</span> <span class=s2>&#34;1234567890&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;John Doe&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;admin&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;iat&#34;</span><span class=p>:</span> <span class=mi>1516239022</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;exp&#34;</span><span class=p>:</span> <span class=mi>1516242622</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=서명signature>서명(Signature)<a hidden class=anchor aria-hidden=true href=#서명signature>#</a></h4><p>서명은 JWT의 무결성을 검증하고 발신자를 인증하는 데 사용된다. 서명은 인코딩된 헤더, 인코딩된 페이로드, 비밀 키, 헤더에 지정된 알고리즘을 사용하여 생성된다.</p><p>예를 들어, HMAC SHA256 알고리즘을 사용하는 경우:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4>4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>HMACSHA256</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>base64UrlEncode</span><span class=p>(</span><span class=n>header</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;.&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=n>base64UrlEncode</span><span class=p>(</span><span class=n>payload</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=n>secret</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>이 서명은 메시지가 도중에 변경되지 않았는지 확인하는 데 사용되며, 비밀 키로 서명된 토큰의 경우 발신자의 신원도 확인할 수 있다.</p><h3 id=jwt의-서명-및-암호화-알고리즘>JWT의 서명 및 암호화 알고리즘<a hidden class=anchor aria-hidden=true href=#jwt의-서명-및-암호화-알고리즘>#</a></h3><p>RFC 7519는 JWT의 서명과 암호화를 위한 여러 알고리즘을 지원한다.</p><h4 id=서명-알고리즘>서명 알고리즘<a hidden class=anchor aria-hidden=true href=#서명-알고리즘>#</a></h4><p>JWT는 다양한 서명 알고리즘을 지원하며, 주요 알고리즘은 다음과 같다:</p><ol><li><strong>HMAC(Hash-based Message Authentication Code)</strong> 알고리즘:<ul><li>HS256: HMAC using SHA-256</li><li>HS384: HMAC using SHA-384</li><li>HS512: HMAC using SHA-512</li></ul></li><li><strong>RSA(Rivest-Shamir-Adleman)</strong> 알고리즘:<ul><li>RS256: RSA Signature with SHA-256</li><li>RS384: RSA Signature with SHA-384</li><li>RS512: RSA Signature with SHA-512</li></ul></li><li><strong>ECDSA(Elliptic Curve Digital Signature Algorithm)</strong> 알고리즘:<ul><li>ES256: ECDSA using P-256 curve and SHA-256</li><li>ES384: ECDSA using P-384 curve and SHA-384</li><li>ES512: ECDSA using P-521 curve and SHA-512</li></ul></li><li><strong>무서명 JWT</strong>:<ul><li><code>none</code>: 서명 없음 (보안상의 이유로 일반적으로 권장되지 않음)</li></ul></li></ol><h4 id=각-알고리즘의-특징-및-적용-사례>각 알고리즘의 특징 및 적용 사례<a hidden class=anchor aria-hidden=true href=#각-알고리즘의-특징-및-적용-사례>#</a></h4><ol><li><strong>HMAC 기반 알고리즘</strong>:<ul><li>대칭 암호화 방식으로, 동일한 비밀 키를 사용하여 서명 생성 및 검증</li><li>구현이 간단하고 빠른 성능</li><li>주로 단일 시스템 내에서 사용되거나 안전하게 비밀 키를 공유할 수 있는 경우에 적합</li><li>사용 사례: 동일한 조직 내 서비스 간 통신</li></ul></li><li><strong>RSA 기반 알고리즘</strong>:<ul><li>비대칭 암호화 방식으로, 개인 키로 서명을 생성하고 공개 키로 검증</li><li>키 배포가 더 안전함 (공개 키는 공개적으로 공유 가능)</li><li>상대적으로 더 많은 컴퓨팅 리소스 필요</li><li>사용 사례: 여러 클라이언트가 토큰을 검증해야 하는 공개 API</li></ul></li><li><strong>ECDSA 기반 알고리즘</strong>:<ul><li>비대칭 암호화 방식으로, RSA와 유사하지만 더 작은 키 크기로 동등한 보안 제공</li><li>더 높은 성능과 더 작은 서명 크기</li><li>사용 사례: 모바일 애플리케이션, IoT 디바이스 등 리소스 제약이 있는 환경</li></ul></li></ol><h4 id=암호화-알고리즘>암호화 알고리즘<a hidden class=anchor aria-hidden=true href=#암호화-알고리즘>#</a></h4><p>JWT는 JWE(JSON Web Encryption) 사양을 통해 페이로드 암호화를 지원한다.</p><p>주요 암호화 알고리즘은 다음과 같다:</p><ol><li><strong>키 암호화 알고리즘</strong>:<ul><li>RSA1_5: RSAES-PKCS1-v1_5</li><li>RSA-OAEP: RSAES OAEP using default parameters</li><li>A128KW, A192KW, A256KW: AES Key Wrap with 128, 192, 256-bit keys</li></ul></li><li><strong>콘텐츠 암호화 알고리즘</strong>:<ul><li>A128CBC-HS256: AES CBC mode with HMAC SHA-256</li><li>A192CBC-HS384: AES CBC mode with HMAC SHA-384</li><li>A256CBC-HS512: AES CBC mode with HMAC SHA-512</li><li>A128GCM, A192GCM, A256GCM: AES GCM mode with 128, 192, 256-bit keys</li></ul></li></ol><p>암호화된 JWT(JWE)는 다섯 부분으로 구성되며, 각 부분은 점(.)으로 구분된다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>header.encrypted_key.initialization_vector.ciphertext.authentication_tag
</span></span></code></pre></td></tr></table></div></div><h3 id=jwt의-보안-고려사항>JWT의 보안 고려사항<a hidden class=anchor aria-hidden=true href=#jwt의-보안-고려사항>#</a></h3><p>RFC 7519는 JWT 사용 시 고려해야 할 여러 보안 사항을 명시하고 있다.</p><h4 id=알고리즘-선택과-관련된-보안-문제>알고리즘 선택과 관련된 보안 문제<a hidden class=anchor aria-hidden=true href=#알고리즘-선택과-관련된-보안-문제>#</a></h4><ol><li><strong>알고리즘 강제(Algorithm Forcing) 공격</strong>:<ul><li>공격자가 <code>alg</code> 값을 <code>none</code>으로 변경하여 서명 검증을 우회하려는 시도</li><li>방어: <code>none</code> 알고리즘 사용을 명시적으로 금지하고, 예상되는 알고리즘을 강제 적용</li></ul></li><li><strong>알고리즘 교체(Algorithm Substitution) 공격</strong>:<ul><li>공격자가 알고리즘을 대칭키(HMAC)에서 비대칭키(RSA)로 변경하여 공개키를 비밀키로 사용하게 하는 공격</li><li>방어: 토큰 검증 시 사용할 알고리즘을 미리 결정하고 고정</li></ul></li></ol><h4 id=토큰-수명-관리>토큰 수명 관리<a hidden class=anchor aria-hidden=true href=#토큰-수명-관리>#</a></h4><ol><li><strong>만료 시간 설정</strong>:<ul><li>모든 JWT에 적절한 만료 시간(<code>exp</code> 클레임)을 설정해야 함</li><li>애플리케이션 요구사항에 따라 짧게(몇 분에서 몇 시간) 설정하는 것이 좋음</li></ul></li><li><strong>토큰 갱신(Refresh) 메커니즘</strong>:<ul><li>짧은 만료 시간을 가진 액세스 토큰과 더 긴 만료 시간을 가진 갱신 토큰의 조합 사용</li><li>액세스 토큰이 만료되면 갱신 토큰을 사용하여 새 액세스 토큰 발급</li></ul></li></ol><h4 id=토큰-저장-및-전송>토큰 저장 및 전송<a hidden class=anchor aria-hidden=true href=#토큰-저장-및-전송>#</a></h4><ol><li><strong>클라이언트 측 저장</strong>:<ul><li><code>httpOnly</code> 플래그가 설정된 쿠키에 저장(XSS 공격으로부터 보호)</li><li><code>Secure</code> 플래그를 사용하여 HTTPS를 통해서만 전송</li><li><code>SameSite</code> 속성을 설정하여 CSRF 공격 방지</li></ul></li><li><strong>토큰 전송</strong>:<ul><li>Authorization 헤더를 통한 전송: <code>Authorization: Bearer &lt;token></code></li><li>쿼리 파라미터로 전송하는 것은 보안상 권장되지 않음(로그에 노출될 수 있음)</li></ul></li></ol><h4 id=페이로드-보안>페이로드 보안<a hidden class=anchor aria-hidden=true href=#페이로드-보안>#</a></h4><ol><li><p><strong>민감한 정보 처리</strong>:</p><ul><li>JWT의 페이로드는 단순히 Base64Url로 인코딩되어 있어 누구나 디코딩할 수 있음</li><li>비밀번호, 개인식별정보 등 민감한 정보는 포함하지 않아야 함</li><li>민감한 정보가 필요한 경우 JWE를 사용하여 페이로드 전체를 암호화해야 함</li></ul></li><li><p><strong>토큰 크기 관리</strong>:</p><ul><li>페이로드에 너무 많은 정보를 포함하면 토큰 크기가 커져 성능에 영향을 미칠 수 있음</li><li>필요한 최소한의 정보만 포함하는 것이 좋음</li></ul></li></ol><h4 id=서명-검증>서명 검증<a hidden class=anchor aria-hidden=true href=#서명-검증>#</a></h4><ol><li><strong>서명 무결성 보장</strong>:<ul><li>모든 JWT 검증 시 서명을 철저히 검증해야 함</li><li>서명 검증을 건너뛰지 않도록 주의</li></ul></li><li><strong>키 관리</strong>:<ul><li>서명 및 암호화에 사용되는 키를 안전하게 관리</li><li>정기적인 키 교체(rotation) 메커니즘 구현</li></ul></li></ol><h3 id=jwt-클레임claims의-상세-설명>JWT 클레임(Claims)의 상세 설명<a hidden class=anchor aria-hidden=true href=#jwt-클레임claims의-상세-설명>#</a></h3><p>RFC 7519는 JWT에서 사용할 수 있는 여러 표준 클레임을 정의하고 있습니다. 이러한 클레임은 토큰에 대한 메타데이터와 조건을 제공합니다.</p><h4 id=51-등록된-클레임registered-claims>5.1 등록된 클레임(Registered Claims)<a hidden class=anchor aria-hidden=true href=#51-등록된-클레임registered-claims>#</a></h4><p>등록된 클레임은 상호 운용성을 위해 IANA JWT Claims Registry에 등록된 미리 정의된 클레임입니다:</p><ol><li><p><strong><code>iss</code> (Issuer)</strong>:</p><ul><li>토큰을 발행한 주체(발급자)를 식별</li><li>일반적으로 URL 형식의 문자열(예: &ldquo;<a href=https://auth.example.com>https://auth.example.com</a>&rdquo;)</li><li>수신자는 이 값을 사용하여 특정 발급자로부터의 토큰만 수락하도록 제한 가능</li></ul></li><li><p><strong><code>sub</code> (Subject)</strong>:</p><ul><li>토큰이 나타내는 주체(일반적으로 사용자)를 식별</li><li>발급자 내에서 고유해야 함(예: 사용자 ID)</li><li>수신자는 이 값을 사용하여 특정 사용자와 관련된 작업을 수행</li></ul></li><li><p><strong><code>aud</code> (Audience)</strong>:</p><ul><li>토큰의 의도된 수신자를 식별</li><li>문자열 또는 문자열 배열 가능</li><li>수신자는 자신이 이 목록에 포함되어 있는지 확인해야 함</li></ul></li><li><p><strong><code>exp</code> (Expiration Time)</strong>:</p><ul><li>토큰이 만료되는 시간(NumericDate 형식, Unix 시간(초))</li><li>이 시간 이후에는 토큰이 거부되어야 함</li><li>약간의 시계 편차(일반적으로 몇 분)를 허용하는 것이 좋음</li></ul></li><li><p><strong><code>nbf</code> (Not Before)</strong>:</p><ul><li>토큰이 유효해지는 시작 시간(NumericDate 형식)</li><li>이 시간 이전에는 토큰이 거부되어야 함</li><li>미래 시간으로 설정하여 토큰의 사용을 지연시킬 수 있음</li></ul></li><li><p><strong><code>iat</code> (Issued At)</strong>:</p><ul><li>토큰이 발행된 시간(NumericDate 형식)</li><li>토큰의 나이를 결정하는 데 사용 가능</li><li>토큰 갱신 정책에 활용 가능</li></ul></li><li><p><strong><code>jti</code> (JWT ID)</strong>:</p><ul><li>토큰의 고유 식별자</li><li>중복 처리, 재생 공격 방지 등에 사용</li><li>발급자는 각 토큰에 고유한 값을 할당해야 함</li></ul></li></ol><h4 id=52-공개-클레임public-claims>5.2 공개 클레임(Public Claims)<a hidden class=anchor aria-hidden=true href=#52-공개-클레임public-claims>#</a></h4><p>공개 클레임은 JWT 사용자가 정의할 수 있지만, 이름 충돌을 방지하기 위한 조치가 필요합니다:</p><ol><li><p><strong>IANA JWT Claims Registry에 등록</strong>:</p><ul><li>표준화된 클레임 사용을 위해 공식 레지스트리에 등록</li><li>예: <code>name</code>, <code>email</code>, <code>preferred_username</code> 등</li></ul></li><li><p><strong>충돌 방지 이름(Collision-Resistant Name) 사용</strong>:</p><ul><li>도메인 이름을 접두사로 사용(예: <code>https://example.com/claims/role</code>)</li><li>URI 형식으로 정의하여 충돌 방지</li></ul></li></ol><p>공개 클레임의 예:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2>2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3>3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4>4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;John Doe&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;email&#34;</span><span class=p>:</span> <span class=s2>&#34;john.doe@example.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;https://example.com/roles&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;admin&#34;</span><span class=p>,</span> <span class=s2>&#34;user&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=53-비공개-클레임private-claims>5.3 비공개 클레임(Private Claims)<a hidden class=anchor aria-hidden=true href=#53-비공개-클레임private-claims>#</a></h4><p>비공개 클레임은 당사자 간에 합의된 정보를 공유하기 위한 맞춤형 클레임입니다:</p><ul><li>등록된 클레임이나 공개 클레임과 충돌하지 않는 이름 사용</li><li>발급자와 소비자 간에 의미가 이해되어야 함</li><li>일반적으로 특정 애플리케이션이나 컨텍스트에 한정된 정보</li></ul><p>비공개 클레임의 예:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2>2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3>3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4>4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5>5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;user_id&#34;</span><span class=p>:</span> <span class=mi>123456</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;role&#34;</span><span class=p>:</span> <span class=s2>&#34;manager&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;organization&#34;</span><span class=p>:</span> <span class=s2>&#34;Engineering&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;permissions&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;read&#34;</span><span class=p>,</span> <span class=s2>&#34;write&#34;</span><span class=p>,</span> <span class=s2>&#34;delete&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=6-jwt-사용-패턴-및-모범-사례>6. JWT 사용 패턴 및 모범 사례<a hidden class=anchor aria-hidden=true href=#6-jwt-사용-패턴-및-모범-사례>#</a></h3><p>RFC 7519와 업계 모범 사례를 기반으로 한 JWT의 효과적인 사용 패턴을 살펴보겠습니다.</p><h4 id=61-인증-및-권한-부여-패턴>6.1 인증 및 권한 부여 패턴<a hidden class=anchor aria-hidden=true href=#61-인증-및-권한-부여-패턴>#</a></h4><ol><li><p><strong>액세스 토큰/갱신 토큰 패턴</strong>:</p><ul><li>짧은 수명의 액세스 토큰(몇 분<del>몇 시간)과 긴 수명의 갱신 토큰(며칠</del>몇 주) 사용</li><li>액세스 토큰이 만료되면 갱신 토큰을 사용하여 새 액세스 토큰 발급</li><li>갱신 토큰은 데이터베이스에 저장하고 필요시 취소 가능하게 관리</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span><span class=lnt id=hl-7-12><a class=lnlinks href=#hl-7-12>12</a>
</span><span class=lnt id=hl-7-13><a class=lnlinks href=#hl-7-13>13</a>
</span><span class=lnt id=hl-7-14><a class=lnlinks href=#hl-7-14>14</a>
</span><span class=lnt id=hl-7-15><a class=lnlinks href=#hl-7-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>클라이언트                             서버
</span></span><span class=line><span class=cl>   |                                   |
</span></span><span class=line><span class=cl>   |-- 로그인 (username, password) --&gt; |
</span></span><span class=line><span class=cl>   |                                   |
</span></span><span class=line><span class=cl>   |&lt;-- 액세스 토큰 + 갱신 토큰 ------| 
</span></span><span class=line><span class=cl>   |                                   |
</span></span><span class=line><span class=cl>   |-- 요청 + 액세스 토큰 -----------&gt; |
</span></span><span class=line><span class=cl>   |&lt;-- 응답 ------------------------- |
</span></span><span class=line><span class=cl>   |                                   |
</span></span><span class=line><span class=cl>   |-- 요청 + 만료된 액세스 토큰 ----&gt; |
</span></span><span class=line><span class=cl>   |&lt;-- 401 Unauthorized ------------- |
</span></span><span class=line><span class=cl>   |                                   |
</span></span><span class=line><span class=cl>   |-- 갱신 요청 + 갱신 토큰 --------&gt; |
</span></span><span class=line><span class=cl>   |&lt;-- 새 액세스 토큰 + 새 갱신 토큰 -|
</span></span><span class=line><span class=cl>   |                                   |
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>상태 비저장(Stateless) JWT vs. 상태 저장(Stateful) JWT</strong>:</p><ul><li><strong>상태 비저장</strong>: 토큰에 모든 필요한 정보 포함, 서버에 저장 안 함<ul><li>장점: 확장성 좋음, 데이터베이스 조회 불필요</li><li>단점: 토큰 취소 어려움, 크기가 클 수 있음</li></ul></li><li><strong>상태 저장</strong>: 토큰에 최소한의 정보만 포함하고 서버에 나머지 정보 저장<ul><li>장점: 토큰 취소 용이, 작은 토큰 크기</li><li>단점: 데이터베이스 조회 필요, 복잡한 구현</li></ul></li></ul></li><li><p><strong>자체 포함(Self-contained) 권한</strong>:</p><ul><li><p>JWT에 사용자 역할, 권한 등을 포함하여 별도 조회 없이 권한 부여 결정</p></li><li><p>예:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>  <span class=nt>&#34;sub&#34;</span><span class=p>:</span> <span class=s2>&#34;1234567890&#34;</span><span class=p>,</span>  <span class=nt>&#34;roles&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;admin&#34;</span><span class=p>,</span> <span class=s2>&#34;editor&#34;</span><span class=p>],</span>  <span class=nt>&#34;permissions&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;read:users&#34;</span><span class=p>,</span> <span class=s2>&#34;write:users&#34;</span><span class=p>]}</span>
</span></span></code></pre></td></tr></table></div></div></li></ul></li></ol><h4 id=62-토큰-관리-모범-사례>6.2 토큰 관리 모범 사례<a hidden class=anchor aria-hidden=true href=#62-토큰-관리-모범-사례>#</a></h4><ol><li><p><strong>적절한 만료 시간 설정</strong>:</p><ul><li>액세스 토큰: 15분~2시간 (보안 요구사항에 따라 조정)</li><li>갱신 토큰: 7일~30일 (필요에 따라 조정)</li><li>위험도가 높은 작업은 더 짧은 만료 시간 적용</li></ul></li><li><p><strong>토큰 취소 메커니즘</strong>:</p><ul><li>블랙리스트: 취소된 토큰의 jti를 저장하여 검증 시 확인</li><li>화이트리스트: 유효한 토큰만 목록에 유지</li><li>Redis와 같은 인메모리 데이터 저장소 사용 권장</li></ul></li><li><p><strong>키 관리(Key Management)</strong>:</p><ul><li>정기적인 키 교체(rotation) 구현 (일반적으로 3~6개월마다)</li><li>키 ID(<code>kid</code>) 헤더 파라미터 사용하여 여러 키 관리</li><li>HSM(Hardware Security Module) 또는 KMS(Key Management Service) 사용 권장</li></ul></li><li><p><strong>토큰 크기 최적화</strong>:</p><ul><li>필요한 최소한의 클레임만 포함</li><li>긴 클레임 이름 대신 짧은 이름 사용 고려</li><li>중요한 메타데이터에만 등록된 클레임 사용</li></ul></li></ol><h4 id=63-보안-강화-방법>6.3 보안 강화 방법<a hidden class=anchor aria-hidden=true href=#63-보안-강화-방법>#</a></h4><ol><li><p><strong>서명 알고리즘 권장사항</strong>:</p><ul><li>대칭 키: HS256 이상 사용(HS384, HS512 권장)</li><li>비대칭 키: RS256 이상 또는 ES256 이상 권장</li><li>알고리즘 없음(<code>"alg": "none"</code>)은 절대 사용 금지</li></ul></li><li><p><strong>토큰 사용 제한</strong>:</p><ul><li><code>aud</code> 클레임을 사용하여 특정 서비스만 토큰을 사용하도록 제한</li><li><code>scope</code> 또는 <code>scp</code> 클레임을 사용하여 토큰의 권한 범위 제한</li></ul></li><li><p><strong>CSRF 및 XSS 방어</strong>:</p><ul><li>JWT를 <code>httpOnly</code> 및 <code>Secure</code> 플래그가 설정된 쿠키에 저장</li><li><code>SameSite=Strict</code> 또는 <code>SameSite=Lax</code> 쿠키 설정 사용</li><li>브라우저 내 스토리지(localStorage, sessionStorage)를 사용할 경우 XSS 대비 강화</li></ul></li><li><p><strong>토큰 무결성 검증</strong>:</p><ul><li>모든 필수 클레임 존재 여부 검증</li><li>예상되는 발급자(<code>iss</code>), 대상(<code>aud</code>) 확인</li><li>토큰 유형(<code>typ</code>) 확인</li></ul></li></ol><h3 id=jwt-구현-예제>JWT 구현 예제<a hidden class=anchor aria-hidden=true href=#jwt-구현-예제>#</a></h3><p>다양한 프로그래밍 언어에서 JWT를 구현하는 방법</p><h4 id=nodejs에서의-jwt-구현>Node.js에서의 JWT 구현<a hidden class=anchor aria-hidden=true href=#nodejs에서의-jwt-구현>#</a></h4><p><a href=https://github.com/auth0/node-jsonwebtoken>jsonwebtoken</a> 라이브러리를 사용한 예제:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11>11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12>12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13>13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14>14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15>15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16>16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17>17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18>18</a>
</span><span class=lnt id=hl-9-19><a class=lnlinks href=#hl-9-19>19</a>
</span><span class=lnt id=hl-9-20><a class=lnlinks href=#hl-9-20>20</a>
</span><span class=lnt id=hl-9-21><a class=lnlinks href=#hl-9-21>21</a>
</span><span class=lnt id=hl-9-22><a class=lnlinks href=#hl-9-22>22</a>
</span><span class=lnt id=hl-9-23><a class=lnlinks href=#hl-9-23>23</a>
</span><span class=lnt id=hl-9-24><a class=lnlinks href=#hl-9-24>24</a>
</span><span class=lnt id=hl-9-25><a class=lnlinks href=#hl-9-25>25</a>
</span><span class=lnt id=hl-9-26><a class=lnlinks href=#hl-9-26>26</a>
</span><span class=lnt id=hl-9-27><a class=lnlinks href=#hl-9-27>27</a>
</span><span class=lnt id=hl-9-28><a class=lnlinks href=#hl-9-28>28</a>
</span><span class=lnt id=hl-9-29><a class=lnlinks href=#hl-9-29>29</a>
</span><span class=lnt id=hl-9-30><a class=lnlinks href=#hl-9-30>30</a>
</span><span class=lnt id=hl-9-31><a class=lnlinks href=#hl-9-31>31</a>
</span><span class=lnt id=hl-9-32><a class=lnlinks href=#hl-9-32>32</a>
</span><span class=lnt id=hl-9-33><a class=lnlinks href=#hl-9-33>33</a>
</span><span class=lnt id=hl-9-34><a class=lnlinks href=#hl-9-34>34</a>
</span><span class=lnt id=hl-9-35><a class=lnlinks href=#hl-9-35>35</a>
</span><span class=lnt id=hl-9-36><a class=lnlinks href=#hl-9-36>36</a>
</span><span class=lnt id=hl-9-37><a class=lnlinks href=#hl-9-37>37</a>
</span><span class=lnt id=hl-9-38><a class=lnlinks href=#hl-9-38>38</a>
</span><span class=lnt id=hl-9-39><a class=lnlinks href=#hl-9-39>39</a>
</span><span class=lnt id=hl-9-40><a class=lnlinks href=#hl-9-40>40</a>
</span><span class=lnt id=hl-9-41><a class=lnlinks href=#hl-9-41>41</a>
</span><span class=lnt id=hl-9-42><a class=lnlinks href=#hl-9-42>42</a>
</span><span class=lnt id=hl-9-43><a class=lnlinks href=#hl-9-43>43</a>
</span><span class=lnt id=hl-9-44><a class=lnlinks href=#hl-9-44>44</a>
</span><span class=lnt id=hl-9-45><a class=lnlinks href=#hl-9-45>45</a>
</span><span class=lnt id=hl-9-46><a class=lnlinks href=#hl-9-46>46</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>jwt</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;jsonwebtoken&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// JWT 생성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>generateToken</span><span class=p>(</span><span class=nx>user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>sub</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>email</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>email</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>roles</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>roles</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>iat</span><span class=o>:</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>exp</span><span class=o>:</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=mi>60</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span> <span class=c1>// 1시간 후 만료
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>};</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>(</span><span class=nx>payload</span><span class=p>,</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>JWT_SECRET</span><span class=p>,</span> <span class=p>{</span> <span class=nx>algorithm</span><span class=o>:</span> <span class=s1>&#39;HS256&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// JWT 검증
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>verifyToken</span><span class=p>(</span><span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>decoded</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>token</span><span class=p>,</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>JWT_SECRET</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>algorithms</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;HS256&#39;</span><span class=p>]</span> <span class=c1>// 허용할 알고리즘 명시적 지정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span> <span class=nx>valid</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=nx>data</span><span class=o>:</span> <span class=nx>decoded</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span> <span class=nx>valid</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span> <span class=nx>error</span><span class=o>:</span> <span class=nx>err</span><span class=p>.</span><span class=nx>message</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 미들웨어로 사용 예
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>authMiddleware</span><span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>authHeader</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>authorization</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>authHeader</span> <span class=o>||</span> <span class=o>!</span><span class=nx>authHeader</span><span class=p>.</span><span class=nx>startsWith</span><span class=p>(</span><span class=s1>&#39;Bearer &#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;Authentication required&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>authHeader</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=nx>verifyToken</span><span class=p>(</span><span class=nx>token</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>result</span><span class=p>.</span><span class=nx>valid</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;Invalid token&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>req</span><span class=p>.</span><span class=nx>user</span> <span class=o>=</span> <span class=nx>result</span><span class=p>.</span><span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=python에서의-jwt-구현>Python에서의 JWT 구현<a hidden class=anchor aria-hidden=true href=#python에서의-jwt-구현>#</a></h4><p><a href=https://github.com/jpadilla/pyjwt>PyJWT</a> 라이브러리를 사용한 예제:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span><span class=lnt id=hl-10-16><a class=lnlinks href=#hl-10-16>16</a>
</span><span class=lnt id=hl-10-17><a class=lnlinks href=#hl-10-17>17</a>
</span><span class=lnt id=hl-10-18><a class=lnlinks href=#hl-10-18>18</a>
</span><span class=lnt id=hl-10-19><a class=lnlinks href=#hl-10-19>19</a>
</span><span class=lnt id=hl-10-20><a class=lnlinks href=#hl-10-20>20</a>
</span><span class=lnt id=hl-10-21><a class=lnlinks href=#hl-10-21>21</a>
</span><span class=lnt id=hl-10-22><a class=lnlinks href=#hl-10-22>22</a>
</span><span class=lnt id=hl-10-23><a class=lnlinks href=#hl-10-23>23</a>
</span><span class=lnt id=hl-10-24><a class=lnlinks href=#hl-10-24>24</a>
</span><span class=lnt id=hl-10-25><a class=lnlinks href=#hl-10-25>25</a>
</span><span class=lnt id=hl-10-26><a class=lnlinks href=#hl-10-26>26</a>
</span><span class=lnt id=hl-10-27><a class=lnlinks href=#hl-10-27>27</a>
</span><span class=lnt id=hl-10-28><a class=lnlinks href=#hl-10-28>28</a>
</span><span class=lnt id=hl-10-29><a class=lnlinks href=#hl-10-29>29</a>
</span><span class=lnt id=hl-10-30><a class=lnlinks href=#hl-10-30>30</a>
</span><span class=lnt id=hl-10-31><a class=lnlinks href=#hl-10-31>31</a>
</span><span class=lnt id=hl-10-32><a class=lnlinks href=#hl-10-32>32</a>
</span><span class=lnt id=hl-10-33><a class=lnlinks href=#hl-10-33>33</a>
</span><span class=lnt id=hl-10-34><a class=lnlinks href=#hl-10-34>34</a>
</span><span class=lnt id=hl-10-35><a class=lnlinks href=#hl-10-35>35</a>
</span><span class=lnt id=hl-10-36><a class=lnlinks href=#hl-10-36>36</a>
</span><span class=lnt id=hl-10-37><a class=lnlinks href=#hl-10-37>37</a>
</span><span class=lnt id=hl-10-38><a class=lnlinks href=#hl-10-38>38</a>
</span><span class=lnt id=hl-10-39><a class=lnlinks href=#hl-10-39>39</a>
</span><span class=lnt id=hl-10-40><a class=lnlinks href=#hl-10-40>40</a>
</span><span class=lnt id=hl-10-41><a class=lnlinks href=#hl-10-41>41</a>
</span><span class=lnt id=hl-10-42><a class=lnlinks href=#hl-10-42>42</a>
</span><span class=lnt id=hl-10-43><a class=lnlinks href=#hl-10-43>43</a>
</span><span class=lnt id=hl-10-44><a class=lnlinks href=#hl-10-44>44</a>
</span><span class=lnt id=hl-10-45><a class=lnlinks href=#hl-10-45>45</a>
</span><span class=lnt id=hl-10-46><a class=lnlinks href=#hl-10-46>46</a>
</span><span class=lnt id=hl-10-47><a class=lnlinks href=#hl-10-47>47</a>
</span><span class=lnt id=hl-10-48><a class=lnlinks href=#hl-10-48>48</a>
</span><span class=lnt id=hl-10-49><a class=lnlinks href=#hl-10-49>49</a>
</span><span class=lnt id=hl-10-50><a class=lnlinks href=#hl-10-50>50</a>
</span><span class=lnt id=hl-10-51><a class=lnlinks href=#hl-10-51>51</a>
</span><span class=lnt id=hl-10-52><a class=lnlinks href=#hl-10-52>52</a>
</span><span class=lnt id=hl-10-53><a class=lnlinks href=#hl-10-53>53</a>
</span><span class=lnt id=hl-10-54><a class=lnlinks href=#hl-10-54>54</a>
</span><span class=lnt id=hl-10-55><a class=lnlinks href=#hl-10-55>55</a>
</span><span class=lnt id=hl-10-56><a class=lnlinks href=#hl-10-56>56</a>
</span><span class=lnt id=hl-10-57><a class=lnlinks href=#hl-10-57>57</a>
</span><span class=lnt id=hl-10-58><a class=lnlinks href=#hl-10-58>58</a>
</span><span class=lnt id=hl-10-59><a class=lnlinks href=#hl-10-59>59</a>
</span><span class=lnt id=hl-10-60><a class=lnlinks href=#hl-10-60>60</a>
</span><span class=lnt id=hl-10-61><a class=lnlinks href=#hl-10-61>61</a>
</span><span class=lnt id=hl-10-62><a class=lnlinks href=#hl-10-62>62</a>
</span><span class=lnt id=hl-10-63><a class=lnlinks href=#hl-10-63>63</a>
</span><span class=lnt id=hl-10-64><a class=lnlinks href=#hl-10-64>64</a>
</span><span class=lnt id=hl-10-65><a class=lnlinks href=#hl-10-65>65</a>
</span><span class=lnt id=hl-10-66><a class=lnlinks href=#hl-10-66>66</a>
</span><span class=lnt id=hl-10-67><a class=lnlinks href=#hl-10-67>67</a>
</span><span class=lnt id=hl-10-68><a class=lnlinks href=#hl-10-68>68</a>
</span><span class=lnt id=hl-10-69><a class=lnlinks href=#hl-10-69>69</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>jwt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>functools</span> <span class=kn>import</span> <span class=n>wraps</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>JWT_SECRET</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;JWT_SECRET&#39;</span><span class=p>,</span> <span class=s1>&#39;default-secret&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># JWT 생성</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>generate_token</span><span class=p>(</span><span class=n>user</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;sub&#39;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>user</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=n>user</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;email&#39;</span><span class=p>:</span> <span class=n>user</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;roles&#39;</span><span class=p>:</span> <span class=n>user</span><span class=p>[</span><span class=s1>&#39;roles&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;iat&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;exp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>+</span> <span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>hours</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jwt</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>payload</span><span class=p>,</span> <span class=n>JWT_SECRET</span><span class=p>,</span> <span class=n>algorithm</span><span class=o>=</span><span class=s1>&#39;HS256&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># JWT 검증</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify_token</span><span class=p>(</span><span class=n>token</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>JWT_SECRET</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;HS256&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>ExpiredSignatureError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>  <span class=c1># 토큰 만료</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>InvalidTokenError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>  <span class=c1># 유효하지 않은 토큰</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 미들웨어로 사용 예</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>token_required</span><span class=p>(</span><span class=n>f</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nd>@wraps</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>decorated</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>auth_header</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;Authorization&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>auth_header</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>auth_header</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;Bearer &#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=s1>&#39;Authentication required&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>token</span> <span class=o>=</span> <span class=n>auth_header</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>user_data</span> <span class=o>=</span> <span class=n>verify_token</span><span class=p>(</span><span class=n>token</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>user_data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=s1>&#39;Invalid token&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>request</span><span class=o>.</span><span class=n>user</span> <span class=o>=</span> <span class=n>user_data</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>decorated</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 라우트 예제</span>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/protected&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nd>@token_required</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>protected_route</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=s1>&#39;Access granted&#39;</span><span class=p>,</span> <span class=s1>&#39;user&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/login&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 실제 구현에서는 데이터베이스에서 사용자 검증 필요</span>
</span></span><span class=line><span class=cl>    <span class=n>user</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>123</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Test User&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;email&#39;</span><span class=p>:</span> <span class=s1>&#39;test@example.com&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;roles&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;user&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>token</span> <span class=o>=</span> <span class=n>generate_token</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;token&#39;</span><span class=p>:</span> <span class=n>token</span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=java에서의-jwt-구현>Java에서의 JWT 구현<a hidden class=anchor aria-hidden=true href=#java에서의-jwt-구현>#</a></h4><p><a href=https://github.com/jwtk/jjwt>jjwt</a> 라이브러리를 사용한 예제:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15>15</a>
</span><span class=lnt id=hl-11-16><a class=lnlinks href=#hl-11-16>16</a>
</span><span class=lnt id=hl-11-17><a class=lnlinks href=#hl-11-17>17</a>
</span><span class=lnt id=hl-11-18><a class=lnlinks href=#hl-11-18>18</a>
</span><span class=lnt id=hl-11-19><a class=lnlinks href=#hl-11-19>19</a>
</span><span class=lnt id=hl-11-20><a class=lnlinks href=#hl-11-20>20</a>
</span><span class=lnt id=hl-11-21><a class=lnlinks href=#hl-11-21>21</a>
</span><span class=lnt id=hl-11-22><a class=lnlinks href=#hl-11-22>22</a>
</span><span class=lnt id=hl-11-23><a class=lnlinks href=#hl-11-23>23</a>
</span><span class=lnt id=hl-11-24><a class=lnlinks href=#hl-11-24>24</a>
</span><span class=lnt id=hl-11-25><a class=lnlinks href=#hl-11-25>25</a>
</span><span class=lnt id=hl-11-26><a class=lnlinks href=#hl-11-26>26</a>
</span><span class=lnt id=hl-11-27><a class=lnlinks href=#hl-11-27>27</a>
</span><span class=lnt id=hl-11-28><a class=lnlinks href=#hl-11-28>28</a>
</span><span class=lnt id=hl-11-29><a class=lnlinks href=#hl-11-29>29</a>
</span><span class=lnt id=hl-11-30><a class=lnlinks href=#hl-11-30>30</a>
</span><span class=lnt id=hl-11-31><a class=lnlinks href=#hl-11-31>31</a>
</span><span class=lnt id=hl-11-32><a class=lnlinks href=#hl-11-32>32</a>
</span><span class=lnt id=hl-11-33><a class=lnlinks href=#hl-11-33>33</a>
</span><span class=lnt id=hl-11-34><a class=lnlinks href=#hl-11-34>34</a>
</span><span class=lnt id=hl-11-35><a class=lnlinks href=#hl-11-35>35</a>
</span><span class=lnt id=hl-11-36><a class=lnlinks href=#hl-11-36>36</a>
</span><span class=lnt id=hl-11-37><a class=lnlinks href=#hl-11-37>37</a>
</span><span class=lnt id=hl-11-38><a class=lnlinks href=#hl-11-38>38</a>
</span><span class=lnt id=hl-11-39><a class=lnlinks href=#hl-11-39>39</a>
</span><span class=lnt id=hl-11-40><a class=lnlinks href=#hl-11-40>40</a>
</span><span class=lnt id=hl-11-41><a class=lnlinks href=#hl-11-41>41</a>
</span><span class=lnt id=hl-11-42><a class=lnlinks href=#hl-11-42>42</a>
</span><span class=lnt id=hl-11-43><a class=lnlinks href=#hl-11-43>43</a>
</span><span class=lnt id=hl-11-44><a class=lnlinks href=#hl-11-44>44</a>
</span><span class=lnt id=hl-11-45><a class=lnlinks href=#hl-11-45>45</a>
</span><span class=lnt id=hl-11-46><a class=lnlinks href=#hl-11-46>46</a>
</span><span class=lnt id=hl-11-47><a class=lnlinks href=#hl-11-47>47</a>
</span><span class=lnt id=hl-11-48><a class=lnlinks href=#hl-11-48>48</a>
</span><span class=lnt id=hl-11-49><a class=lnlinks href=#hl-11-49>49</a>
</span><span class=lnt id=hl-11-50><a class=lnlinks href=#hl-11-50>50</a>
</span><span class=lnt id=hl-11-51><a class=lnlinks href=#hl-11-51>51</a>
</span><span class=lnt id=hl-11-52><a class=lnlinks href=#hl-11-52>52</a>
</span><span class=lnt id=hl-11-53><a class=lnlinks href=#hl-11-53>53</a>
</span><span class=lnt id=hl-11-54><a class=lnlinks href=#hl-11-54>54</a>
</span><span class=lnt id=hl-11-55><a class=lnlinks href=#hl-11-55>55</a>
</span><span class=lnt id=hl-11-56><a class=lnlinks href=#hl-11-56>56</a>
</span><span class=lnt id=hl-11-57><a class=lnlinks href=#hl-11-57>57</a>
</span><span class=lnt id=hl-11-58><a class=lnlinks href=#hl-11-58>58</a>
</span><span class=lnt id=hl-11-59><a class=lnlinks href=#hl-11-59>59</a>
</span><span class=lnt id=hl-11-60><a class=lnlinks href=#hl-11-60>60</a>
</span><span class=lnt id=hl-11-61><a class=lnlinks href=#hl-11-61>61</a>
</span><span class=lnt id=hl-11-62><a class=lnlinks href=#hl-11-62>62</a>
</span><span class=lnt id=hl-11-63><a class=lnlinks href=#hl-11-63>63</a>
</span><span class=lnt id=hl-11-64><a class=lnlinks href=#hl-11-64>64</a>
</span><span class=lnt id=hl-11-65><a class=lnlinks href=#hl-11-65>65</a>
</span><span class=lnt id=hl-11-66><a class=lnlinks href=#hl-11-66>66</a>
</span><span class=lnt id=hl-11-67><a class=lnlinks href=#hl-11-67>67</a>
</span><span class=lnt id=hl-11-68><a class=lnlinks href=#hl-11-68>68</a>
</span><span class=lnt id=hl-11-69><a class=lnlinks href=#hl-11-69>69</a>
</span><span class=lnt id=hl-11-70><a class=lnlinks href=#hl-11-70>70</a>
</span><span class=lnt id=hl-11-71><a class=lnlinks href=#hl-11-71>71</a>
</span><span class=lnt id=hl-11-72><a class=lnlinks href=#hl-11-72>72</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>io.jsonwebtoken.Claims</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>io.jsonwebtoken.Jwts</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>io.jsonwebtoken.SignatureAlgorithm</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>io.jsonwebtoken.security.Keys</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.security.core.userdetails.UserDetails</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.stereotype.Component</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.security.Key</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.Date</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.HashMap</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.Map</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.function.Function</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Component</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>JwtUtil</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Key</span><span class=w> </span><span class=n>key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Keys</span><span class=p>.</span><span class=na>secretKeyFor</span><span class=p>(</span><span class=n>SignatureAlgorithm</span><span class=p>.</span><span class=na>HS256</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>JWT_TOKEN_VALIDITY</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>60</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>60</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>1000</span><span class=p>;</span><span class=w> </span><span class=c1>// 1시간</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// JWT 토큰에서 사용자 이름 추출</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>extractUsername</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>token</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>extractClaim</span><span class=p>(</span><span class=n>token</span><span class=p>,</span><span class=w> </span><span class=n>Claims</span><span class=p>::</span><span class=n>getSubject</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// JWT 토큰에서 만료 날짜 추출</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Date</span><span class=w> </span><span class=nf>extractExpiration</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>token</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>extractClaim</span><span class=p>(</span><span class=n>token</span><span class=p>,</span><span class=w> </span><span class=n>Claims</span><span class=p>::</span><span class=n>getExpiration</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// JWT 토큰에서 클레임 추출</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=nf>extractClaim</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>token</span><span class=p>,</span><span class=w> </span><span class=n>Function</span><span class=o>&lt;</span><span class=n>Claims</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=n>claimsResolver</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>final</span><span class=w> </span><span class=n>Claims</span><span class=w> </span><span class=n>claims</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>extractAllClaims</span><span class=p>(</span><span class=n>token</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>claimsResolver</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=n>claims</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 모든 클레임 추출</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Claims</span><span class=w> </span><span class=nf>extractAllClaims</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>token</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Jwts</span><span class=p>.</span><span class=na>parserBuilder</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>setSigningKey</span><span class=p>(</span><span class=n>key</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>build</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>parseClaimsJws</span><span class=p>(</span><span class=n>token</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>getBody</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 토큰 만료 확인</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Boolean</span><span class=w> </span><span class=nf>isTokenExpired</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>token</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>extractExpiration</span><span class=p>(</span><span class=n>token</span><span class=p>).</span><span class=na>before</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>Date</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 사용자에 대한 JWT 토큰 생성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>generateToken</span><span class=p>(</span><span class=n>UserDetails</span><span class=w> </span><span class=n>userDetails</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>&gt;</span><span class=w> </span><span class=n>claims</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>HashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>createToken</span><span class=p>(</span><span class=n>claims</span><span class=p>,</span><span class=w> </span><span class=n>userDetails</span><span class=p>.</span><span class=na>getUsername</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// JWT 토큰 생성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>createToken</span><span class=p>(</span><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>&gt;</span><span class=w> </span><span class=n>claims</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>subject</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Jwts</span><span class=p>.</span><span class=na>builder</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>setClaims</span><span class=p>(</span><span class=n>claims</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>setSubject</span><span class=p>(</span><span class=n>subject</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>setIssuedAt</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>Date</span><span class=p>(</span><span class=n>System</span><span class=p>.</span><span class=na>currentTimeMillis</span><span class=p>()))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>setExpiration</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>Date</span><span class=p>(</span><span class=n>System</span><span class=p>.</span><span class=na>currentTimeMillis</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>JWT_TOKEN_VALIDITY</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>signWith</span><span class=p>(</span><span class=n>key</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>compact</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// JWT 토큰 검증</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Boolean</span><span class=w> </span><span class=nf>validateToken</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>token</span><span class=p>,</span><span class=w> </span><span class=n>UserDetails</span><span class=w> </span><span class=n>userDetails</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>extractUsername</span><span class=p>(</span><span class=n>token</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>(</span><span class=n>username</span><span class=p>.</span><span class=na>equals</span><span class=p>(</span><span class=n>userDetails</span><span class=p>.</span><span class=na>getUsername</span><span class=p>())</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>!</span><span class=n>isTokenExpired</span><span class=p>(</span><span class=n>token</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=8-jwt-관련-도구-및-라이브러리>8. JWT 관련 도구 및 라이브러리<a hidden class=anchor aria-hidden=true href=#8-jwt-관련-도구-및-라이브러리>#</a></h3><p>JWT 작업을 위한 유용한 도구와 라이브러리</p><h4 id=디버깅-및-검사-도구>디버깅 및 검사 도구<a hidden class=anchor aria-hidden=true href=#디버깅-및-검사-도구>#</a></h4><ol><li><strong><a href=https://jwt.io/>jwt.io</a></strong>:<ul><li>JWT 디코딩, 검증, 생성을 위한 온라인 도구</li><li>다양한 알고리즘 지원</li><li>토큰 구조 시각화 제공</li></ul></li><li><strong><a href=https://chrome.google.com/webstore/detail/jwt-debugger/ppmmlchacdbknfphdeafcbmklcghghmd>JSON Web Token Debugger Chrome Extension</a></strong>:<ul><li>브라우저에서 직접 JWT 디코딩 및 검사</li><li>개발 및 디버깅 시 유용</li></ul></li><li><strong><a href=https://www.jsonwebtoken.io/>JWT Validator</a></strong>:<ul><li>JWT 검증 도구</li><li>다양한 서명 알고리즘 지원</li></ul></li></ol><h4 id=주요-jwt-라이브러리>주요 JWT 라이브러리<a hidden class=anchor aria-hidden=true href=#주요-jwt-라이브러리>#</a></h4><p>다양한 프로그래밍 언어별 주요 JWT 라이브러리:</p><ol><li><strong>JavaScript/Node.js</strong>:<ul><li><a href=https://github.com/auth0/node-jsonwebtoken>jsonwebtoken</a>: Node.js에서 가장 인기 있는 JWT 라이브러리</li><li><a href=https://github.com/panva/jose>jose</a>: 완전한 JSON Object Signing and Encryption 구현</li></ul></li><li><strong>Python</strong>:<ul><li><a href=https://github.com/jpadilla/pyjwt>PyJWT</a>: 가볍고 사용하기 쉬운 JWT 라이브러리</li><li><a href=https://github.com/mpdavis/python-jose>python-jose</a>: JWS, JWE, JWK, JWA 구현 포함</li></ul></li><li><strong>Java</strong>:<ul><li><a href=https://github.com/jwtk/jjwt>jjwt</a>: 사용하기 쉬운 JWT 생성 및 검증</li><li><a href=https://github.com/auth0/java-jwt>java-jwt</a>: Auth0에서 제공하는 JWT 라이브러리</li></ul></li><li><strong>C#/.NET</strong>:<ul><li><a href=https://docs.microsoft.com/en-us/dotnet/api/system.identitymodel.tokens.jwt>System.IdentityModel.Tokens.Jwt</a>:.NET 공식 JWT 라이브러리</li><li><a href=https://github.com/dvsekhvalnov/jose-jwt>jose-jwt</a>: JWS, JWE, JWK, JWA 구현</li></ul></li><li><strong>PHP</strong>:<ul><li><a href=https://github.com/firebase/php-jwt>firebase/php-jwt</a>: 간단한 JWT 인코딩/디코딩 라이브러리</li><li><a href=https://github.com/lcobucci/jwt>lcobucci/jwt</a>: 더 완전한 구현</li></ul></li><li><strong>Ruby</strong>:<ul><li><a href=https://github.com/jwt/ruby-jwt>ruby-jwt</a>: Ruby에서의 JWT 구현</li></ul></li><li><strong>Go</strong>:<ul><li><a href=https://github.com/golang-jwt/jwt>golang-jwt/jwt</a>: Go에서 가장 인기 있는 JWT 구현</li></ul></li></ol><h4 id=jwt-관련-프레임워크-통합>JWT 관련 프레임워크 통합<a hidden class=anchor aria-hidden=true href=#jwt-관련-프레임워크-통합>#</a></h4><p>많은 웹 프레임워크와 인증 시스템이 JWT를 지원:</p><ol><li><strong>Spring Security (Java)</strong>:<ul><li>JWT 기반 인증 지원</li><li>OAuth2 및 JWT 통합</li></ul></li><li><strong>Passport.js (Node.js)</strong>:<ul><li><a href=http://www.passportjs.org/packages/passport-jwt/>passport-jwt</a> 전략 제공</li><li>Express.js와 쉽게 통합</li></ul></li><li><strong>Django REST Framework (Python)</strong>:<ul><li><a href=https://github.com/jazzband/djangorestframework-simplejwt>djangorestframework-simplejwt</a> 패키지</li><li>JWT 인증 제공</li></ul></li><li><strong>ASP.NET Core (C#)</strong>:<ul><li>내장 JWT 인증 미들웨어</li><li>쉬운 설정 및 통합</li></ul></li><li><strong>Laravel (PHP)</strong>:<ul><li><a href=https://github.com/tymondesigns/jwt-auth>tymon/jwt-auth</a> 패키지</li><li>JWT 인증 지원</li></ul></li></ol><h3 id=jwt와-관련-표준>JWT와 관련 표준<a hidden class=anchor aria-hidden=true href=#jwt와-관련-표준>#</a></h3><p>JWT는 더 큰 JSON 객체 서명 및 암호화(JOSE) 프레임워크의 일부이다.</p><h4 id=jose-프레임워크>JOSE 프레임워크<a hidden class=anchor aria-hidden=true href=#jose-프레임워크>#</a></h4><p>JSON Object Signing and Encryption(JOSE) 프레임워크는 JSON 데이터 구조를 사용하여 보안 서비스를 제공하는 표준 모음:</p><ol><li><strong>JWS(JSON Web Signature) - RFC 7515</strong>:<ul><li>JSON 데이터 구조 서명을 위한 표준</li><li>데이터 무결성과 출처 인증 제공</li><li>JWT의 서명 메커니즘 정의</li></ul></li><li><strong>JWE(JSON Web Encryption) - RFC 7516</strong>:<ul><li>JSON 데이터 구조 암호화를 위한 표준</li><li>기밀성 제공</li><li>JWT의 암호화 메커니즘 정의</li></ul></li><li><strong>JWK(JSON Web Key) - RFC 7517</strong>:<ul><li>암호화 키를 JSON 형식으로 표현하는 표준</li><li>키 정보 교환에 사용</li><li>공개 키 인프라(PKI)를 단순화</li></ul></li><li><strong>JWA(JSON Web Algorithms) - RFC 7518</strong>:<ul><li>JWS, JWE, JWK에서 사용되는 암호화 알고리즘 정의</li><li>서명, 암호화, 키 암호화, 콘텐츠 암호화 등을 위한 알고리즘 지정</li></ul></li></ol><h4 id=openid-connect와-jwt>OpenID Connect와 JWT<a hidden class=anchor aria-hidden=true href=#openid-connect와-jwt>#</a></h4><p>JWT는 OpenID Connect(OIDC) 프로토콜의 핵심 구성 요소이다:</p><ol><li><strong>ID 토큰</strong>:<ul><li>OpenID Connect의 핵심 개념</li><li>사용자 인증 정보를 포함하는 JWT</li><li><code>iss</code>, <code>sub</code>, <code>aud</code>, <code>exp</code>, <code>iat</code> 등의 표준 클레임 포함</li></ul></li><li><strong>UserInfo 응답</strong>:<ul><li>선택적으로 JWT 형식으로 제공 가능</li><li>사용자 프로필 정보 포함</li></ul></li><li><strong>클라이언트 등록</strong>:<ul><li>JWT를 사용한 클라이언트 인증 지원</li></ul></li></ol><h4 id=oauth-20과-jwt>OAuth 2.0과 JWT<a hidden class=anchor aria-hidden=true href=#oauth-20과-jwt>#</a></h4><p>JWT는 OAuth 2.0 프로토콜에서 여러 방식으로 활용된다:</p><ol><li><strong>Bearer 토큰 형식</strong>:<ul><li>JWT는 OAuth 2.0에서 액세스 토큰으로 사용 가능</li><li>RFC 6750에 정의된 Bearer 토큰 전송 방식 사용</li></ul></li><li><strong>클라이언트 인증</strong>:<ul><li>JWT를 사용한 클라이언트 인증</li><li>RFC 7523에 정의된 JWT 프로필</li></ul></li><li><strong>토큰 교환</strong>:<ul><li>JWT 교환을 위한 OAuth 2.0 확장(JWT Bearer Token Flow)</li><li>한 도메인의 JWT를 다른 도메인에서 사용 가능한 토큰으로 교환</li></ul></li></ol><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/backend-development/>Backend-Development</a></li><li><a href=https://buenhyden.github.io/tags/api-design/>API-Design</a></li><li><a href=https://buenhyden.github.io/tags/authentication-methods/>Authentication-Methods</a></li><li><a href=https://buenhyden.github.io/tags/jwt/>JWT</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/programming-languages/python/web-framework/django/orm/queryset/optimization/select_related/><span class=title>« Prev</span><br><span>select_related</span>
</a><a class=next href=https://buenhyden.github.io/posts/backend-development/api-design-and-implementation/api-fundamentals/api-lifecycle-management/><span class=title>Next »</span><br><span>API Lifecycle Management</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>