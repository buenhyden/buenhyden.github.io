<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>SAML | hyunyoun's Blog</title><meta name=keywords content="Backend-Development,API-Design,Authentication-Methods,SAML"><meta name=description content="SAML(Security Assertion Markup Language)은 기업과 조직에서 단일 로그인(SSO, Single Sign-On)과 신원 연합(Identity Federation)을 구현하기 위한 XML 기반 표준 프레임워크이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/security-engineering/access-control/authentication/protocols/saml/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/security-engineering/access-control/authentication/protocols/saml/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/security-engineering/access-control/authentication/protocols/saml/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/security-engineering/access-control/authentication/protocols/saml/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="SAML"><meta property="og:description" content="SAML(Security Assertion Markup Language)은 기업과 조직에서 단일 로그인(SSO, Single Sign-On)과 신원 연합(Identity Federation)을 구현하기 위한 XML 기반 표준 프레임워크이다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="SAML"><meta name=twitter:description content="SAML(Security Assertion Markup Language)은 기업과 조직에서 단일 로그인(SSO, Single Sign-On)과 신원 연합(Identity Federation)을 구현하기 위한 XML 기반 표준 프레임워크이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"SAML","item":"https://buenhyden.github.io/posts/security-engineering/access-control/authentication/protocols/saml/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a></div><h1>SAML</h1><div class=post-description>SAML(Security Assertion Markup Language)은 기업과 조직에서 단일 로그인(SSO, Single Sign-On)과 신원 연합(Identity Federation)을 구현하기 위한 XML 기반 표준 프레임워크이다.</div></header><div class=post-content><h2 id=saml>SAML<a hidden class=anchor aria-hidden=true href=#saml>#</a></h2><p>SAML(Security Assertion Markup Language)은 기업과 조직에서 단일 로그인(SSO, Single Sign-On)과 신원 연합(Identity Federation)을 구현하기 위한 XML 기반 표준 프레임워크이다. 이 강력한 인증 기술은 현대 기업 환경에서 사용자 인증 및 권한 관리를 간소화하는 핵심 요소로 자리 잡았다.</p><h3 id=saml의-기본-개념>SAML의 기본 개념<a hidden class=anchor aria-hidden=true href=#saml의-기본-개념>#</a></h3><p>SAML은 2002년 OASIS(Organization for the Advancement of Structured Information Standards)에 의해 처음 표준화되었으며, 현재는 SAML 2.0 버전(2005년 발표)이 가장 널리 사용되고 있다.</p><p>이 프로토콜의 주요 목적은 다음과 같다:</p><ol><li><strong>단일 로그인(SSO) 구현</strong>: 사용자가 한 번만 인증하여 여러 애플리케이션에 접근할 수 있도록 한다.</li><li><strong>신원 정보 교환</strong>: 신원 공급자(IdP)와 서비스 공급자(SP) 간에 인증 정보를 안전하게 교환한다.</li><li><strong>권한 부여 결정</strong>: 사용자의 접근 권한에 대한 정보를 전달한다.</li></ol><h3 id=saml의-주요-구성-요소>SAML의 주요 구성 요소<a hidden class=anchor aria-hidden=true href=#saml의-주요-구성-요소>#</a></h3><p>SAML 생태계는 다음 세 가지 주요 구성 요소로 이루어져 있다:</p><h4 id=주체principal>주체(Principal)<a hidden class=anchor aria-hidden=true href=#주체principal>#</a></h4><p>주체는 인증을 요청하는 사용자(일반적으로 브라우저를 통해)이다.</p><h4 id=신원-공급자identity-provider-idp>신원 공급자(Identity Provider, IdP)<a hidden class=anchor aria-hidden=true href=#신원-공급자identity-provider-idp>#</a></h4><p>신원 공급자는 사용자 인증을 수행하고 SAML 어설션(Assertion)을 발행하는 시스템이다.</p><p>주요 기능은 다음과 같다:</p><ul><li>사용자 자격 증명 확인</li><li>인증 상태 관리</li><li>SAML 어설션 생성 및 서명</li><li>사용자 속성 및 권한 정보 제공</li></ul><p>대표적인 IdP 제품/서비스:</p><ul><li>Microsoft Active Directory Federation Services (AD FS)</li><li>Okta</li><li>OneLogin</li><li>Ping Identity</li><li>Azure Active Directory</li></ul><h4 id=서비스-공급자service-provider-sp>서비스 공급자(Service Provider, SP)<a hidden class=anchor aria-hidden=true href=#서비스-공급자service-provider-sp>#</a></h4><p>서비스 공급자는 사용자가 접근하려는 애플리케이션이나 서비스이다.</p><p>주요 기능은 다음과 같다:</p><ul><li>SAML 어설션 수신 및 검증</li><li>사용자 세션 생성</li><li>접근 제어 결정</li></ul><h3 id=saml-어설션assertions>SAML 어설션(Assertions)<a hidden class=anchor aria-hidden=true href=#saml-어설션assertions>#</a></h3><p>SAML의 핵심은 &lsquo;어설션&rsquo;이다.</p><p>어설션은 IdP가 생성하는 XML 문서로, 다음과 같은 정보를 포함한다:</p><ol><li><strong>인증 어설션(Authentication Assertions)</strong>: 사용자가 인증되었음을 확인한다.</li><li><strong>속성 어설션(Attribute Assertions)</strong>: 사용자에 대한 추가 정보(이름, 이메일, 부서 등)를 제공한다.</li><li><strong>권한 부여 결정 어설션(Authorization Decision Assertions)</strong>: 사용자가 특정 리소스에 접근할 수 있는지 여부를 나타낸다.</li></ol><p>SAML 어설션의 예:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21>21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22>22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23>23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24>24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25>25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26>26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27>27</a>
</span><span class=lnt id=hl-0-28><a class=lnlinks href=#hl-0-28>28</a>
</span><span class=lnt id=hl-0-29><a class=lnlinks href=#hl-0-29>29</a>
</span><span class=lnt id=hl-0-30><a class=lnlinks href=#hl-0-30>30</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;saml:Assertion</span>
</span></span><span class=line><span class=cl>   <span class=na>xmlns:saml=</span><span class=s>&#34;urn:oasis:names:tc:SAML:2.0:assertion&#34;</span>
</span></span><span class=line><span class=cl>   <span class=na>ID=</span><span class=s>&#34;_a75adf55-01d7-4acf-8891-e3bd5f36b63c&#34;</span>
</span></span><span class=line><span class=cl>   <span class=na>IssueInstant=</span><span class=s>&#34;2023-06-15T10:45:30Z&#34;</span>
</span></span><span class=line><span class=cl>   <span class=na>Version=</span><span class=s>&#34;2.0&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;saml:Issuer&gt;</span>https://idp.example.org<span class=nt>&lt;/saml:Issuer&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;saml:Subject&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;saml:NameID&gt;</span>kim@example.org<span class=nt>&lt;/saml:NameID&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/saml:Subject&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;saml:Conditions</span>
</span></span><span class=line><span class=cl>      <span class=na>NotBefore=</span><span class=s>&#34;2023-06-15T10:45:30Z&#34;</span>
</span></span><span class=line><span class=cl>      <span class=na>NotOnOrAfter=</span><span class=s>&#34;2023-06-15T11:45:30Z&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/saml:Conditions&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;saml:AuthnStatement</span>
</span></span><span class=line><span class=cl>      <span class=na>AuthnInstant=</span><span class=s>&#34;2023-06-15T10:30:45Z&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;saml:AuthnContext&gt;</span>
</span></span><span class=line><span class=cl>         <span class=nt>&lt;saml:AuthnContextClassRef&gt;</span>
</span></span><span class=line><span class=cl>            urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport
</span></span><span class=line><span class=cl>         <span class=nt>&lt;/saml:AuthnContextClassRef&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/saml:AuthnContext&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/saml:AuthnStatement&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;saml:AttributeStatement&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;saml:Attribute</span> <span class=na>Name=</span><span class=s>&#34;email&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>         <span class=nt>&lt;saml:AttributeValue&gt;</span>kim@example.org<span class=nt>&lt;/saml:AttributeValue&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/saml:Attribute&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;saml:Attribute</span> <span class=na>Name=</span><span class=s>&#34;role&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>         <span class=nt>&lt;saml:AttributeValue&gt;</span>manager<span class=nt>&lt;/saml:AttributeValue&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/saml:Attribute&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/saml:AttributeStatement&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/saml:Assertion&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=saml-흐름flows>SAML 흐름(Flows)<a hidden class=anchor aria-hidden=true href=#saml-흐름flows>#</a></h3><p>SAML에는 두 가지 주요 흐름이 있다:</p><h4 id=sp-초기화-흐름sp-initiated-flow>SP-초기화 흐름(SP-Initiated Flow)<a hidden class=anchor aria-hidden=true href=#sp-초기화-흐름sp-initiated-flow>#</a></h4><p>이 흐름에서는 사용자가 먼저 서비스 공급자(SP)에 접근한다:</p><ol><li>사용자가 SP 웹사이트/서비스에 접근을 시도한다.</li><li>SP는 사용자가 인증되지 않았음을 감지하고 SAML 인증 요청을 생성한다.</li><li>SP는 사용자 브라우저를 IdP로 리다이렉트한다(SAML 요청 포함).</li><li>IdP는 사용자 인증을 수행한다(로그인 화면 표시 등).</li><li>인증 성공 후, IdP는 SAML 어설션을 생성한다.</li><li>IdP는 사용자 브라우저를 SAML 어설션과 함께 SP로 다시 리다이렉트한다.</li><li>SP는 SAML 어설션을 검증하고 사용자에게 접근 권한을 부여한다.</li></ol><h4 id=idp-초기화-흐름idp-initiated-flow>IdP-초기화 흐름(IdP-Initiated Flow)<a hidden class=anchor aria-hidden=true href=#idp-초기화-흐름idp-initiated-flow>#</a></h4><p>이 흐름에서는 사용자가 먼저 신원 공급자(IdP)에 접근한다:</p><ol><li>사용자가 IdP 포털에 로그인한다.</li><li>사용자는 접근하려는 애플리케이션(SP)을 선택한다.</li><li>IdP는 SAML 어설션을 생성한다.</li><li>IdP는 사용자 브라우저를 SAML 어설션과 함께 SP로 리다이렉트한다.</li><li>SP는 SAML 어설션을 검증하고 사용자에게 접근 권한을 부여한다.</li></ol><h3 id=saml-구현-예제-python>SAML 구현 예제: Python<a hidden class=anchor aria-hidden=true href=#saml-구현-예제-python>#</a></h3><p>다음은 Python에서 SAML SP(서비스 공급자)를 구현하는 간단한 예제:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>  1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>  2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>  3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>  4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5>  5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6>  6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7>  7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8>  8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9>  9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10> 10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11> 11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12> 12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13> 13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14> 14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15> 15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16> 16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17> 17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18> 18</a>
</span><span class=lnt id=hl-1-19><a class=lnlinks href=#hl-1-19> 19</a>
</span><span class=lnt id=hl-1-20><a class=lnlinks href=#hl-1-20> 20</a>
</span><span class=lnt id=hl-1-21><a class=lnlinks href=#hl-1-21> 21</a>
</span><span class=lnt id=hl-1-22><a class=lnlinks href=#hl-1-22> 22</a>
</span><span class=lnt id=hl-1-23><a class=lnlinks href=#hl-1-23> 23</a>
</span><span class=lnt id=hl-1-24><a class=lnlinks href=#hl-1-24> 24</a>
</span><span class=lnt id=hl-1-25><a class=lnlinks href=#hl-1-25> 25</a>
</span><span class=lnt id=hl-1-26><a class=lnlinks href=#hl-1-26> 26</a>
</span><span class=lnt id=hl-1-27><a class=lnlinks href=#hl-1-27> 27</a>
</span><span class=lnt id=hl-1-28><a class=lnlinks href=#hl-1-28> 28</a>
</span><span class=lnt id=hl-1-29><a class=lnlinks href=#hl-1-29> 29</a>
</span><span class=lnt id=hl-1-30><a class=lnlinks href=#hl-1-30> 30</a>
</span><span class=lnt id=hl-1-31><a class=lnlinks href=#hl-1-31> 31</a>
</span><span class=lnt id=hl-1-32><a class=lnlinks href=#hl-1-32> 32</a>
</span><span class=lnt id=hl-1-33><a class=lnlinks href=#hl-1-33> 33</a>
</span><span class=lnt id=hl-1-34><a class=lnlinks href=#hl-1-34> 34</a>
</span><span class=lnt id=hl-1-35><a class=lnlinks href=#hl-1-35> 35</a>
</span><span class=lnt id=hl-1-36><a class=lnlinks href=#hl-1-36> 36</a>
</span><span class=lnt id=hl-1-37><a class=lnlinks href=#hl-1-37> 37</a>
</span><span class=lnt id=hl-1-38><a class=lnlinks href=#hl-1-38> 38</a>
</span><span class=lnt id=hl-1-39><a class=lnlinks href=#hl-1-39> 39</a>
</span><span class=lnt id=hl-1-40><a class=lnlinks href=#hl-1-40> 40</a>
</span><span class=lnt id=hl-1-41><a class=lnlinks href=#hl-1-41> 41</a>
</span><span class=lnt id=hl-1-42><a class=lnlinks href=#hl-1-42> 42</a>
</span><span class=lnt id=hl-1-43><a class=lnlinks href=#hl-1-43> 43</a>
</span><span class=lnt id=hl-1-44><a class=lnlinks href=#hl-1-44> 44</a>
</span><span class=lnt id=hl-1-45><a class=lnlinks href=#hl-1-45> 45</a>
</span><span class=lnt id=hl-1-46><a class=lnlinks href=#hl-1-46> 46</a>
</span><span class=lnt id=hl-1-47><a class=lnlinks href=#hl-1-47> 47</a>
</span><span class=lnt id=hl-1-48><a class=lnlinks href=#hl-1-48> 48</a>
</span><span class=lnt id=hl-1-49><a class=lnlinks href=#hl-1-49> 49</a>
</span><span class=lnt id=hl-1-50><a class=lnlinks href=#hl-1-50> 50</a>
</span><span class=lnt id=hl-1-51><a class=lnlinks href=#hl-1-51> 51</a>
</span><span class=lnt id=hl-1-52><a class=lnlinks href=#hl-1-52> 52</a>
</span><span class=lnt id=hl-1-53><a class=lnlinks href=#hl-1-53> 53</a>
</span><span class=lnt id=hl-1-54><a class=lnlinks href=#hl-1-54> 54</a>
</span><span class=lnt id=hl-1-55><a class=lnlinks href=#hl-1-55> 55</a>
</span><span class=lnt id=hl-1-56><a class=lnlinks href=#hl-1-56> 56</a>
</span><span class=lnt id=hl-1-57><a class=lnlinks href=#hl-1-57> 57</a>
</span><span class=lnt id=hl-1-58><a class=lnlinks href=#hl-1-58> 58</a>
</span><span class=lnt id=hl-1-59><a class=lnlinks href=#hl-1-59> 59</a>
</span><span class=lnt id=hl-1-60><a class=lnlinks href=#hl-1-60> 60</a>
</span><span class=lnt id=hl-1-61><a class=lnlinks href=#hl-1-61> 61</a>
</span><span class=lnt id=hl-1-62><a class=lnlinks href=#hl-1-62> 62</a>
</span><span class=lnt id=hl-1-63><a class=lnlinks href=#hl-1-63> 63</a>
</span><span class=lnt id=hl-1-64><a class=lnlinks href=#hl-1-64> 64</a>
</span><span class=lnt id=hl-1-65><a class=lnlinks href=#hl-1-65> 65</a>
</span><span class=lnt id=hl-1-66><a class=lnlinks href=#hl-1-66> 66</a>
</span><span class=lnt id=hl-1-67><a class=lnlinks href=#hl-1-67> 67</a>
</span><span class=lnt id=hl-1-68><a class=lnlinks href=#hl-1-68> 68</a>
</span><span class=lnt id=hl-1-69><a class=lnlinks href=#hl-1-69> 69</a>
</span><span class=lnt id=hl-1-70><a class=lnlinks href=#hl-1-70> 70</a>
</span><span class=lnt id=hl-1-71><a class=lnlinks href=#hl-1-71> 71</a>
</span><span class=lnt id=hl-1-72><a class=lnlinks href=#hl-1-72> 72</a>
</span><span class=lnt id=hl-1-73><a class=lnlinks href=#hl-1-73> 73</a>
</span><span class=lnt id=hl-1-74><a class=lnlinks href=#hl-1-74> 74</a>
</span><span class=lnt id=hl-1-75><a class=lnlinks href=#hl-1-75> 75</a>
</span><span class=lnt id=hl-1-76><a class=lnlinks href=#hl-1-76> 76</a>
</span><span class=lnt id=hl-1-77><a class=lnlinks href=#hl-1-77> 77</a>
</span><span class=lnt id=hl-1-78><a class=lnlinks href=#hl-1-78> 78</a>
</span><span class=lnt id=hl-1-79><a class=lnlinks href=#hl-1-79> 79</a>
</span><span class=lnt id=hl-1-80><a class=lnlinks href=#hl-1-80> 80</a>
</span><span class=lnt id=hl-1-81><a class=lnlinks href=#hl-1-81> 81</a>
</span><span class=lnt id=hl-1-82><a class=lnlinks href=#hl-1-82> 82</a>
</span><span class=lnt id=hl-1-83><a class=lnlinks href=#hl-1-83> 83</a>
</span><span class=lnt id=hl-1-84><a class=lnlinks href=#hl-1-84> 84</a>
</span><span class=lnt id=hl-1-85><a class=lnlinks href=#hl-1-85> 85</a>
</span><span class=lnt id=hl-1-86><a class=lnlinks href=#hl-1-86> 86</a>
</span><span class=lnt id=hl-1-87><a class=lnlinks href=#hl-1-87> 87</a>
</span><span class=lnt id=hl-1-88><a class=lnlinks href=#hl-1-88> 88</a>
</span><span class=lnt id=hl-1-89><a class=lnlinks href=#hl-1-89> 89</a>
</span><span class=lnt id=hl-1-90><a class=lnlinks href=#hl-1-90> 90</a>
</span><span class=lnt id=hl-1-91><a class=lnlinks href=#hl-1-91> 91</a>
</span><span class=lnt id=hl-1-92><a class=lnlinks href=#hl-1-92> 92</a>
</span><span class=lnt id=hl-1-93><a class=lnlinks href=#hl-1-93> 93</a>
</span><span class=lnt id=hl-1-94><a class=lnlinks href=#hl-1-94> 94</a>
</span><span class=lnt id=hl-1-95><a class=lnlinks href=#hl-1-95> 95</a>
</span><span class=lnt id=hl-1-96><a class=lnlinks href=#hl-1-96> 96</a>
</span><span class=lnt id=hl-1-97><a class=lnlinks href=#hl-1-97> 97</a>
</span><span class=lnt id=hl-1-98><a class=lnlinks href=#hl-1-98> 98</a>
</span><span class=lnt id=hl-1-99><a class=lnlinks href=#hl-1-99> 99</a>
</span><span class=lnt id=hl-1-100><a class=lnlinks href=#hl-1-100>100</a>
</span><span class=lnt id=hl-1-101><a class=lnlinks href=#hl-1-101>101</a>
</span><span class=lnt id=hl-1-102><a class=lnlinks href=#hl-1-102>102</a>
</span><span class=lnt id=hl-1-103><a class=lnlinks href=#hl-1-103>103</a>
</span><span class=lnt id=hl-1-104><a class=lnlinks href=#hl-1-104>104</a>
</span><span class=lnt id=hl-1-105><a class=lnlinks href=#hl-1-105>105</a>
</span><span class=lnt id=hl-1-106><a class=lnlinks href=#hl-1-106>106</a>
</span><span class=lnt id=hl-1-107><a class=lnlinks href=#hl-1-107>107</a>
</span><span class=lnt id=hl-1-108><a class=lnlinks href=#hl-1-108>108</a>
</span><span class=lnt id=hl-1-109><a class=lnlinks href=#hl-1-109>109</a>
</span><span class=lnt id=hl-1-110><a class=lnlinks href=#hl-1-110>110</a>
</span><span class=lnt id=hl-1-111><a class=lnlinks href=#hl-1-111>111</a>
</span><span class=lnt id=hl-1-112><a class=lnlinks href=#hl-1-112>112</a>
</span><span class=lnt id=hl-1-113><a class=lnlinks href=#hl-1-113>113</a>
</span><span class=lnt id=hl-1-114><a class=lnlinks href=#hl-1-114>114</a>
</span><span class=lnt id=hl-1-115><a class=lnlinks href=#hl-1-115>115</a>
</span><span class=lnt id=hl-1-116><a class=lnlinks href=#hl-1-116>116</a>
</span><span class=lnt id=hl-1-117><a class=lnlinks href=#hl-1-117>117</a>
</span><span class=lnt id=hl-1-118><a class=lnlinks href=#hl-1-118>118</a>
</span><span class=lnt id=hl-1-119><a class=lnlinks href=#hl-1-119>119</a>
</span><span class=lnt id=hl-1-120><a class=lnlinks href=#hl-1-120>120</a>
</span><span class=lnt id=hl-1-121><a class=lnlinks href=#hl-1-121>121</a>
</span><span class=lnt id=hl-1-122><a class=lnlinks href=#hl-1-122>122</a>
</span><span class=lnt id=hl-1-123><a class=lnlinks href=#hl-1-123>123</a>
</span><span class=lnt id=hl-1-124><a class=lnlinks href=#hl-1-124>124</a>
</span><span class=lnt id=hl-1-125><a class=lnlinks href=#hl-1-125>125</a>
</span><span class=lnt id=hl-1-126><a class=lnlinks href=#hl-1-126>126</a>
</span><span class=lnt id=hl-1-127><a class=lnlinks href=#hl-1-127>127</a>
</span><span class=lnt id=hl-1-128><a class=lnlinks href=#hl-1-128>128</a>
</span><span class=lnt id=hl-1-129><a class=lnlinks href=#hl-1-129>129</a>
</span><span class=lnt id=hl-1-130><a class=lnlinks href=#hl-1-130>130</a>
</span><span class=lnt id=hl-1-131><a class=lnlinks href=#hl-1-131>131</a>
</span><span class=lnt id=hl-1-132><a class=lnlinks href=#hl-1-132>132</a>
</span><span class=lnt id=hl-1-133><a class=lnlinks href=#hl-1-133>133</a>
</span><span class=lnt id=hl-1-134><a class=lnlinks href=#hl-1-134>134</a>
</span><span class=lnt id=hl-1-135><a class=lnlinks href=#hl-1-135>135</a>
</span><span class=lnt id=hl-1-136><a class=lnlinks href=#hl-1-136>136</a>
</span><span class=lnt id=hl-1-137><a class=lnlinks href=#hl-1-137>137</a>
</span><span class=lnt id=hl-1-138><a class=lnlinks href=#hl-1-138>138</a>
</span><span class=lnt id=hl-1-139><a class=lnlinks href=#hl-1-139>139</a>
</span><span class=lnt id=hl-1-140><a class=lnlinks href=#hl-1-140>140</a>
</span><span class=lnt id=hl-1-141><a class=lnlinks href=#hl-1-141>141</a>
</span><span class=lnt id=hl-1-142><a class=lnlinks href=#hl-1-142>142</a>
</span><span class=lnt id=hl-1-143><a class=lnlinks href=#hl-1-143>143</a>
</span><span class=lnt id=hl-1-144><a class=lnlinks href=#hl-1-144>144</a>
</span><span class=lnt id=hl-1-145><a class=lnlinks href=#hl-1-145>145</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># SAML 서비스 공급자(SP) 구현 예제</span>
</span></span><span class=line><span class=cl><span class=c1># 필요한 라이브러리: python3-saml</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>redirect</span><span class=p>,</span> <span class=n>session</span><span class=p>,</span> <span class=n>url_for</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>onelogin.saml2.auth</span> <span class=kn>import</span> <span class=n>OneLogin_Saml2_Auth</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>onelogin.saml2.settings</span> <span class=kn>import</span> <span class=n>OneLogin_Saml2_Settings</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>onelogin.saml2.utils</span> <span class=kn>import</span> <span class=n>OneLogin_Saml2_Utils</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>secret_key</span> <span class=o>=</span> <span class=s1>&#39;안전한_비밀_키_사용&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SAML 설정을 로드하는 함수</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_saml_settings</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 실제 구현에서는 설정 파일에서 로드하는 것이 좋습니다</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;strict&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;debug&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;sp&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;entityId&#34;</span><span class=p>:</span> <span class=s2>&#34;https://sp.example.com/metadata/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;assertionConsumerService&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://sp.example.com/acs/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;binding&#34;</span><span class=p>:</span> <span class=s2>&#34;urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;singleLogoutService&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://sp.example.com/sls/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;binding&#34;</span><span class=p>:</span> <span class=s2>&#34;urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;x509cert&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;privateKey&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;idp&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;entityId&#34;</span><span class=p>:</span> <span class=s2>&#34;https://idp.example.org/metadata/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;singleSignOnService&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://idp.example.org/sso/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;binding&#34;</span><span class=p>:</span> <span class=s2>&#34;urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;singleLogoutService&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://idp.example.org/slo/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;binding&#34;</span><span class=p>:</span> <span class=s2>&#34;urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;x509cert&#34;</span><span class=p>:</span> <span class=s2>&#34;IdP의_인증서_문자열&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;security&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;nameIdEncrypted&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;authnRequestsSigned&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;logoutRequestSigned&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;logoutResponseSigned&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;signMetadata&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;wantMessagesSigned&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;wantAssertionsSigned&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;wantNameId&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;wantNameIdEncrypted&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;wantAssertionsEncrypted&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;allowSingleLabelDomains&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;signatureAlgorithm&#34;</span><span class=p>:</span> <span class=s2>&#34;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;digestAlgorithm&#34;</span><span class=p>:</span> <span class=s2>&#34;http://www.w3.org/2001/04/xmlenc#sha256&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># OneLogin_Saml2_Auth 객체를 초기화하는 함수</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>init_saml_auth</span><span class=p>(</span><span class=n>req</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>settings</span> <span class=o>=</span> <span class=n>OneLogin_Saml2_Settings</span><span class=p>(</span><span class=n>get_saml_settings</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>OneLogin_Saml2_Auth</span><span class=p>(</span><span class=n>req</span><span class=p>,</span> <span class=n>settings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 요청 데이터를 OneLogin_Saml2_Auth에 필요한 형식으로 변환</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>prepare_flask_request</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>url_data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>url</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;https&#39;</span><span class=p>:</span> <span class=s1>&#39;on&#39;</span> <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>scheme</span> <span class=o>==</span> <span class=s1>&#39;https&#39;</span> <span class=k>else</span> <span class=s1>&#39;off&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;http_host&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>host</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;server_port&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;SERVER_PORT&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;script_name&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>path</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;get_data&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>copy</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;post_data&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=o>.</span><span class=n>copy</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;query_string&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>query_string</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>index</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;saml_attributes&#39;</span> <span class=ow>in</span> <span class=n>session</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 인증된 사용자라면 환영 메시지 표시</span>
</span></span><span class=line><span class=cl>        <span class=n>attributes</span> <span class=o>=</span> <span class=n>session</span><span class=p>[</span><span class=s1>&#39;saml_attributes&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;로그인 성공! 사용자: </span><span class=si>{</span><span class=n>attributes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;&#39;</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>, 이메일: </span><span class=si>{</span><span class=n>attributes</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;email&#39;</span><span class=p>,</span> <span class=p>[</span><span class=s1>&#39;&#39;</span><span class=p>])[</span><span class=mi>0</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 인증되지 않은 사용자라면 로그인 링크 표시</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;&lt;a href=&#34;/login/&#34;&gt;SAML 로그인&lt;/a&gt;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/login/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># SP-초기화 SSO 프로세스 시작</span>
</span></span><span class=line><span class=cl>    <span class=n>req</span> <span class=o>=</span> <span class=n>prepare_flask_request</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>auth</span> <span class=o>=</span> <span class=n>init_saml_auth</span><span class=p>(</span><span class=n>req</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># IdP로 리다이렉트</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>auth</span><span class=o>.</span><span class=n>login</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/acs/&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>acs</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># IdP로부터의 SAML 응답 처리</span>
</span></span><span class=line><span class=cl>    <span class=n>req</span> <span class=o>=</span> <span class=n>prepare_flask_request</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>auth</span> <span class=o>=</span> <span class=n>init_saml_auth</span><span class=p>(</span><span class=n>req</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># SAML 응답 처리</span>
</span></span><span class=line><span class=cl>    <span class=n>auth</span><span class=o>.</span><span class=n>process_response</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>errors</span> <span class=o>=</span> <span class=n>auth</span><span class=o>.</span><span class=n>get_errors</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>errors</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>auth</span><span class=o>.</span><span class=n>is_authenticated</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=c1># 인증 성공</span>
</span></span><span class=line><span class=cl>        <span class=n>session</span><span class=p>[</span><span class=s1>&#39;saml_attributes&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>auth</span><span class=o>.</span><span class=n>get_attributes</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>session</span><span class=p>[</span><span class=s1>&#39;saml_name_id&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>auth</span><span class=o>.</span><span class=n>get_nameid</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;index&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 인증 실패</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;오류: </span><span class=si>{</span><span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>errors</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/logout/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>logout</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 로그아웃 프로세스 시작</span>
</span></span><span class=line><span class=cl>    <span class=n>req</span> <span class=o>=</span> <span class=n>prepare_flask_request</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>auth</span> <span class=o>=</span> <span class=n>init_saml_auth</span><span class=p>(</span><span class=n>req</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 세션 정보 삭제</span>
</span></span><span class=line><span class=cl>    <span class=n>session</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># IdP 로그아웃 페이지로 리다이렉트</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>auth</span><span class=o>.</span><span class=n>logout</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/metadata/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>metadata</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># SP 메타데이터 생성 및 제공</span>
</span></span><span class=line><span class=cl>    <span class=n>req</span> <span class=o>=</span> <span class=n>prepare_flask_request</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>auth</span> <span class=o>=</span> <span class=n>init_saml_auth</span><span class=p>(</span><span class=n>req</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>settings</span> <span class=o>=</span> <span class=n>auth</span><span class=o>.</span><span class=n>get_settings</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>metadata</span> <span class=o>=</span> <span class=n>settings</span><span class=o>.</span><span class=n>get_sp_metadata</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>errors</span> <span class=o>=</span> <span class=n>settings</span><span class=o>.</span><span class=n>validate_metadata</span><span class=p>(</span><span class=n>metadata</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>errors</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>metadata</span><span class=p>,</span> <span class=mi>200</span><span class=p>,</span> <span class=p>{</span><span class=s1>&#39;Content-Type&#39;</span><span class=p>:</span> <span class=s1>&#39;text/xml&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;오류: </span><span class=si>{</span><span class=s1>&#39;, &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>errors</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>debug</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>이 코드는 Flask 웹 애플리케이션에서 SAML 서비스 공급자를 구현한 예이다.</p><p>주요 구성 요소는 다음과 같다:</p><ul><li><strong>로그인 엔드포인트(<code>/login/</code>)</strong>: SP-초기화 SSO 프로세스를 시작한다.</li><li><strong>어설션 소비자 서비스(<code>/acs/</code>)</strong>: IdP로부터 SAML 응답을 처리한다.</li><li><strong>로그아웃 엔드포인트(<code>/logout/</code>)</strong>: 사용자 로그아웃을 처리한다.</li><li><strong>메타데이터 엔드포인트(<code>/metadata/</code>)</strong>: SP 메타데이터를 제공한다.</li></ul><h3 id=saml의-장단점>SAML의 장단점<a hidden class=anchor aria-hidden=true href=#saml의-장단점>#</a></h3><h4 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h4><ol><li><strong>중앙화된 인증</strong>: 사용자 자격 증명을 한 곳에서 관리할 수 있어 보안이 향상된다.</li><li><strong>통합 사용자 경험</strong>: 사용자는 여러 애플리케이션에 개별적으로 로그인할 필요가 없어 경험이 향상된다.</li><li><strong>강력한 보안</strong>: XML 서명과 암호화를 통해 메시지 무결성과 기밀성을 보장한다.</li><li><strong>엔터프라이즈 지원</strong>: 대부분의 기업용 애플리케이션과 서비스에서 SAML을 지원한다.</li><li><strong>상호 운용성</strong>: 다양한 플랫폼과 공급업체 간에 호환된다.</li><li><strong>감사 및 규정 준수</strong>: 중앙화된 인증을 통해 감사 추적 및 규정 준수가 용이해진다.</li></ol><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><ol><li><strong>복잡성</strong>: 구현과 디버깅이 복잡하며 XML 처리가 필요하다.</li><li><strong>모바일 한계</strong>: 모바일 애플리케이션에서는 제한적으로 사용된다.</li><li><strong>오버헤드</strong>: XML 형식은 JSON에 비해 더 많은 대역폭을 사용한다.</li><li><strong>설정 복잡성</strong>: SP와 IdP 간의 초기 설정이 복잡하다.</li><li><strong>최신 앱 통합의 어려움</strong>: 최신 SPA(Single Page Application) 및 API 중심 아키텍처와의 통합이 어려울 수 있다.</li></ol><h3 id=saml의-실제-활용-사례>SAML의 실제 활용 사례<a hidden class=anchor aria-hidden=true href=#saml의-실제-활용-사례>#</a></h3><ol><li><strong>기업 포털</strong>: 직원들이 한 번의 로그인으로 여러 내부 시스템에 접근할 수 있다.</li><li><strong>클라우드 서비스 액세스</strong>: Salesforce, Office 365, Google Workspace 등의 클라우드 서비스에 기업 자격 증명으로 접근한다.</li><li><strong>대학 시스템</strong>: 학생과 교직원이 학교 포털, 도서관 시스템, 학습 관리 시스템 등에 단일 로그인으로 접근한다.</li><li><strong>정부 시스템</strong>: 공무원들이 여러 정부 시스템에 안전하게 접근한다.</li><li><strong>의료 정보 시스템</strong>: 의료진이 다양한 의료 애플리케이션에 단일 인증으로 접근한다.</li></ol><h3 id=saml-구현의-모범-사례>SAML 구현의 모범 사례<a hidden class=anchor aria-hidden=true href=#saml-구현의-모범-사례>#</a></h3><ol><li><strong>암호화 사용</strong>: 민감한 사용자 정보가 포함된 어설션은 암호화해야 한다.</li><li><strong>서명 검증</strong>: 모든 SAML 메시지와 어설션의 서명을 반드시 검증해야 한다.</li><li><strong>적절한 타임아웃 설정</strong>: 어설션의 유효 기간을 적절히 설정하여 재생 공격을 방지한다.</li><li><strong>메타데이터 교환 자동화</strong>: IdP와 SP 간의 메타데이터 교환을 자동화하여 오류를 줄인다.</li><li><strong>SSL/TLS 사용</strong>: 모든 SAML 통신은 SSL/TLS를 통해 이루어져야 한다.</li><li><strong>속성 매핑 표준화</strong>: IdP와 SP 간의 사용자 속성 매핑을 명확히 정의한다.</li><li><strong>로깅 및 모니터링</strong>: 인증 이벤트를 철저히 로깅하고 모니터링한다.</li></ol><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>SAML vs. OpenID Connect</h2></header><div class=entry-content><p>SAML vs. OpenID Connect SAML(Security Assertion Markup Language)과 OpenID Connect는 모두 사용자 인증 및 권한 부여를 위한 핵심 프로토콜이지만, 역사, 구현 방식, 용도 면에서 중요한 차이점이 있다.
SAML (Security Assertion Markup Language) SAML은 2002년에 OASIS(Organization for the Advancement of Structured Information Standards)에 의해 개발된 XML 기반 프레임워크이다.
핵심 특징 XML 형식으로 인증 정보를 교환 주로 엔터프라이즈 환경과 대기업에서 사용 복잡한 구현이지만 높은 보안성 제공 웹 기반 SSO(Single Sign-On)에 최적화 메타데이터를 통한 신뢰 관계 구축 작동 방식 사용자가 서비스 제공자(SP)에게 접근 요청 SP는 사용자를 신원 제공자(IdP)로 리디렉션 IdP는 사용자를 인증하고 SAML 어설션(assertion) 생성 사용자는 SAML 어설션과 함께 SP로 리디렉션 SP는 SAML 어설션을 검증하고 사용자 접근 허용 OpenID Connect (OIDC) OpenID Connect는 2014년에 OpenID Foundation에 의해 개발된 OAuth 2.0 위에 구축된 인증 레이어이다.
...</p></div><footer class=entry-footer><span title='2025-04-03 05:36:00 +0000 UTC'>April 3, 2025</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to SAML vs. OpenID Connect" href=https://buenhyden.github.io/posts/security-engineering/access-control/authentication/protocols/saml/saml-vs-openid-connect/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>SAML vs. OAuth 2.0</h2></header><div class=entry-content><p>SAML vs. OAuth 2.0 인증(Authentication)과 권한 부여(Authorization)는 현대 웹 애플리케이션과 시스템에서 핵심적인 보안 구성 요소이다. SAML(Security Assertion Markup Language)과 OAuth 2.0은 이러한 기능을 제공하는 두 가지 주요 프로토콜이지만, 설계 철학, 사용 사례 및 기술적 구현에서 상당한 차이가 있다.
기본 개념 및 역사 SAML (Security Assertion Markup Language) SAML은 2002년 OASIS(Organization for the Advancement of Structured Information Standards)에 의해 개발된 XML 기반 개방형 표준으로, 당시 기업들이 직면한 단일 인증 문제를 해결하기 위해 설계되었다. 현재 가장 널리 사용되는 버전은 2005년에 발표된 SAML 2.0이다.
...</p></div><footer class=entry-footer><span title='2025-03-11 13:31:00 +0000 UTC'>March 11, 2025</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to SAML vs. OAuth 2.0" href=https://buenhyden.github.io/posts/security-engineering/access-control/authentication/protocols/saml/saml-vs-oauth-20/></a></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>