<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Monitoring | hyunyoun's Blog</title><meta name=keywords content="Backend-Development,API-Design-and-Implementation,API-Performance,Profiling-and-Monitoring"><meta name=description content="API 모니터링은 단순한 로그 수집을 넘어서, API 시스템의 건강 상태를 종합적으로 관찰하고 평가하는 프로세스이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/backend-development/api-design-and-implementation/api-monitoring-and-analytics/api-monitoring/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/backend-development/api-design-and-implementation/api-monitoring-and-analytics/api-monitoring/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/backend-development/api-design-and-implementation/api-monitoring-and-analytics/api-monitoring/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Monitoring"><meta property="og:description" content="API 모니터링은 단순한 로그 수집을 넘어서, API 시스템의 건강 상태를 종합적으로 관찰하고 평가하는 프로세스이다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-14T01:28:00+00:00"><meta property="article:modified_time" content="2025-02-14T01:28:00+00:00"><meta property="article:tag" content="Backend Development"><meta property="article:tag" content="API-Design-and-Implementation"><meta property="article:tag" content="API-Performance"><meta property="article:tag" content="Profiling-and-Monitoring"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Monitoring"><meta name=twitter:description content="API 모니터링은 단순한 로그 수집을 넘어서, API 시스템의 건강 상태를 종합적으로 관찰하고 평가하는 프로세스이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"기술 블로그","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Backend Development","item":"https://buenhyden.github.io/posts/backend-development/"},{"@type":"ListItem","position":3,"name":"API Design and Implementation","item":"https://buenhyden.github.io/posts/backend-development/api-design-and-implementation/"},{"@type":"ListItem","position":4,"name":"Monitoring","item":"https://buenhyden.github.io/posts/backend-development/api-design-and-implementation/api-monitoring-and-analytics/api-monitoring/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Monitoring","name":"Monitoring","description":"API 모니터링은 단순한 로그 수집을 넘어서, API 시스템의 건강 상태를 종합적으로 관찰하고 평가하는 프로세스이다.","keywords":["Backend-Development","API-Design-and-Implementation","API-Performance","Profiling-and-Monitoring"],"articleBody":"Monitoring API 모니터링은 API의 가용성, 성능, 기능적 정확성을 지속적으로 관찰하고 평가하는 체계적인 프로세스이다. 이는 현대 소프트웨어 시스템의 안정성과 신뢰성을 보장하는 데 필수적인 요소로, 문제를 조기에 감지하고 해결함으로써 서비스 중단과 사용자 경험 저하를 방지한다.\nAPI 모니터링의 기본 개념 API 모니터링은 단순한 로그 수집을 넘어서, API 시스템의 건강 상태를 종합적으로 관찰하고 평가하는 프로세스이다. 이는 다음과 같은 핵심 측면을 포함한다:\n가용성 모니터링: API가 지속적으로 응답하며 접근 가능한지 확인한다. 성능 모니터링: 응답 시간, 처리량, 오류율 등의 성능 지표를 추적한다. 기능적 모니터링: API가 예상대로 정확한 결과를 반환하는지 검증한다. 인프라 모니터링: API를 지원하는 기본 인프라의 상태를 관찰한다. 보안 모니터링: 비정상적인 접근 패턴이나 보안 위협을 감지한다. API 모니터링의 중요성 API 모니터링이 비즈니스와 기술적 측면에서 제공하는 가치는 다음과 같다:\n서비스 신뢰성 보장: 지속적인 모니터링을 통해 API 장애를 빠르게 감지하고 대응함으로써 서비스 중단 시간을 최소화한다. 사용자 경험 향상: 성능 저하 문제를 조기에 식별하여 사용자 만족도를 유지하고 개선한다. 프로액티브한 문제 해결: 문제가 심각해지기 전에 조기 경고 신호를 통해 선제적으로 대응할 수 있다. 용량 계획 및 확장성: 트래픽 패턴과 리소스 사용량을 분석하여 적절한 용량 계획을 수립할 수 있다. SLA(서비스 수준 계약) 준수: 서비스 수준 목표를 지속적으로 측정하고 보고하여 계약 준수를 보장한다. 비즈니스 인텔리전스: API 사용 패턴을 분석하여 비즈니스 통찰력을 얻을 수 있다. API 모니터링의 핵심 지표 효과적인 API 모니터링을 위해 추적해야 할 핵심 지표들은 다음과 같다:\n가용성 지표 업타임(Uptime): API 서비스의 가용 시간 비율 가동 시간(Uptime Duration): 연속적인 서비스 가동 시간 장애 빈도(Failure Rate): 일정 기간 동안 발생한 장애의 수 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # API 가용성 계산 예시 def calculate_availability(total_requests, failed_requests): if total_requests == 0: return 100.0 # 요청이 없으면 100% 가용성으로 간주 availability = ((total_requests - failed_requests) / total_requests) * 100 return round(availability, 2) # 소수점 둘째 자리까지 반올림 # 9s 가용성 수준 정의 availability_levels = { \"two_nines\": 99.0, # 가동 중지 시간: 월간 약 7.2시간 \"three_nines\": 99.9, # 가동 중지 시간: 월간 약 43.2분 \"four_nines\": 99.99, # 가동 중지 시간: 월간 약 4.32분 \"five_nines\": 99.999 # 가동 중지 시간: 월간 약 26초 } 성능 지표 응답 시간(Response Time): 요청을 처리하는 데 걸리는 시간 지연 시간(Latency): 네트워크 또는 처리 지연 시간 처리량(Throughput): 단위 시간당 처리된 요청 수 요청 속도(Request Rate): 초당 들어오는 요청의 수 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 // Express.js에서 응답 시간 모니터링 미들웨어 예시 const responseTimeMiddleware = (req, res, next) =\u003e { const start = process.hrtime(); res.on('finish', () =\u003e { const end = process.hrtime(start); const duration = (end[0] * 1e9 + end[1]) / 1e6; // 밀리초로 변환 // 메트릭 기록 (예: Prometheus, StatsD 등에 전송) recordMetric('api.response_time', { method: req.method, path: req.route ? req.route.path : req.path, status: res.statusCode, duration: duration }); // 응답 시간이 임계값을 초과하면 알림 if (duration \u003e 500) { // 500ms = 0.5초 notifySlowResponse({ method: req.method, path: req.path, duration: duration, timestamp: new Date() }); } }); next(); }; 오류 지표 오류율(Error Rate): 전체 요청 중 오류 응답의 비율 HTTP 상태 코드 분포: 각 상태 코드(2xx, 4xx, 5xx 등)의 분포 오류 유형 분류: 발생하는 오류의 유형별 분류와 빈도 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 # FastAPI에서 오류 모니터링 예시 from fastapi import FastAPI, Request, status from fastapi.responses import JSONResponse from fastapi.exceptions import RequestValidationError import time import logging from collections import defaultdict app = FastAPI() error_counts = defaultdict(int) error_logger = logging.getLogger(\"api_errors\") @app.exception_handler(RequestValidationError) async def validation_exception_handler(request: Request, exc: RequestValidationError): error_type = \"validation_error\" error_counts[error_type] += 1 error_logger.error( f\"Validation error: endpoint={request.url.path}, client_ip={request.client.host}, \" f\"error_detail={exc.errors()}\" ) return JSONResponse( status_code=status.HTTP_422_UNPROCESSABLE_ENTITY, content={\"detail\": exc.errors()} ) @app.exception_handler(Exception) async def general_exception_handler(request: Request, exc: Exception): error_type = type(exc).__name__ error_counts[error_type] += 1 error_logger.error( f\"Unhandled exception: endpoint={request.url.path}, client_ip={request.client.host}, \" f\"error_type={error_type}, error_message={str(exc)}\" ) return JSONResponse( status_code=status.HTTP_500_INTERNAL_SERVER_ERROR, content={\"detail\": \"Internal server error\"} ) # 정기적으로 오류 통계 보고 @app.on_event(\"startup\") async def start_error_reporting(): async def report_errors(): while True: await asyncio.sleep(300) # 5분마다 보고 if error_counts: error_logger.info(f\"Error summary (last 5 minutes): {dict(error_counts)}\") # 메트릭 시스템에 데이터 전송 for error_type, count in error_counts.items(): send_metric(f\"api.error.{error_type}\", count) # 카운터 초기화 error_counts.clear() asyncio.create_task(report_errors()) 리소스 사용 지표 CPU 사용률: API 서버의 CPU 사용 수준 메모리 사용량: 사용 중인 메모리 양과 패턴 디스크 I/O: 디스크 읽기/쓰기 작업의 양과 지연 시간 네트워크 사용량: 입출력 네트워크 트래픽 양 비즈니스 지표 API 호출 볼륨: 시간대별, 엔드포인트별 호출 수 사용자별 API 사용량: 개별 사용자 또는 클라이언트별 사용 패턴 비즈니스 트랜잭션 성공률: 비즈니스 관점에서의 성공적인 트랜잭션 비율 수익 관련 지표: API 사용과 직접 연관된 수익 지표 API 모니터링 구현 방법 합성 모니터링(Synthetic Monitoring) 합성 모니터링은 사전 정의된 시나리오를 주기적으로 실행하여 API의 가용성과 성능을 검증하는 방법이다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 // Puppeteer를 사용한 합성 모니터링 예시 const puppeteer = require('puppeteer'); const axios = require('axios'); async function runSyntheticTest() { const startTime = Date.now(); let success = false; let responseTime = 0; let errorMessage = null; try { // API 호출 시뮬레이션 const response = await axios.get('https://api.example.com/health', { timeout: 5000 // 5초 타임아웃 }); responseTime = Date.now() - startTime; success = response.status === 200; // JWT 인증이 필요한 API 흐름 검증 const token = await getAuthToken(); const userResponse = await axios.get('https://api.example.com/users/me', { headers: { 'Authorization': `Bearer ${token}` } }); // 응답 데이터 유효성 검사 if (!userResponse.data.id) { throw new Error('User data is invalid'); } } catch (error) { success = false; errorMessage = error.message; responseTime = Date.now() - startTime; } // 결과 보고 reportTestResult({ testName: 'API Health Check', success, responseTime, errorMessage, timestamp: new Date() }); } // 스케줄링: 5분마다 테스트 실행 setInterval(runSyntheticTest, 5 * 60 * 1000); 합성 모니터링의 주요 장점:\n사용자 흐름을 종단간(end-to-end) 테스트할 수 있음 실제 사용자가 없더라도 모니터링 가능 예정된 중단 시간 동안 비활성화 가능 실제 사용자 모니터링(Real User Monitoring, RUM) 실제 사용자의 API 상호작용을 모니터링하여 실제 환경에서의 성능과 사용자 경험을 측정한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 // 클라이언트 측 RUM 구현 예시 (브라우저) class APIMonitor { constructor() { this.metrics = { calls: 0, errors: 0, totalResponseTime: 0 }; this.initialize(); } initialize() { // 원본 fetch 메서드를 가로채기 const originalFetch = window.fetch; window.fetch = async (url, options) =\u003e { // API 호출만 모니터링 (자체 도메인의 /api 경로) if (url.includes('/api')) { const start = performance.now(); let error = false; try { const response = await originalFetch(url, options); if (!response.ok) { error = true; } const end = performance.now(); this.recordMetrics(url, end - start, error); return response; } catch (err) { const end = performance.now(); this.recordMetrics(url, end - start, true); throw err; } } else { // API가 아닌 경우 원본 fetch 실행 return originalFetch(url, options); } }; // 주기적으로 메트릭 전송 setInterval(() =\u003e this.sendMetrics(), 60000); } recordMetrics(url, responseTime, isError) { this.metrics.calls++; this.metrics.totalResponseTime += responseTime; if (isError) { this.metrics.errors++; } // 개별 엔드포인트별 메트릭 기록도 가능 } sendMetrics() { if (this.metrics.calls \u003e 0) { const avgResponseTime = this.metrics.totalResponseTime / this.metrics.calls; const errorRate = (this.metrics.errors / this.metrics.calls) * 100; // 백엔드 애널리틱스 시스템으로 메트릭 전송 navigator.sendBeacon('/analytics/api-metrics', JSON.stringify({ calls: this.metrics.calls, avgResponseTime, errorRate, userAgent: navigator.userAgent, timestamp: Date.now() })); // 메트릭 초기화 this.metrics = { calls: 0, errors: 0, totalResponseTime: 0 }; } } } // 모니터링 시작 const apiMonitor = new APIMonitor(); RUM의 주요 장점:\n실제 사용자 경험을 직접 측정 지역, 디바이스, 브라우저별 성능 차이 식별 가능 실제 사용 패턴을 기반으로 한 통찰력 제공 로그 기반 모니터링 API 로그를 수집, 분석하여 성능과 오류 패턴을 파악한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 # Python/Flask에서의 구조화된 로깅 예시 import logging import json import time import uuid from flask import Flask, request, g app = Flask(__name__) # JSON 형식 로거 설정 class JSONFormatter(logging.Formatter): def format(self, record): log_record = { \"timestamp\": self.formatTime(record, self.datefmt), \"level\": record.levelname, \"message\": record.getMessage(), \"logger\": record.name } # 추가 컨텍스트 정보가 있으면 포함 if hasattr(record, 'request_id'): log_record[\"request_id\"] = record.request_id if hasattr(record, 'path'): log_record[\"path\"] = record.path if hasattr(record, 'method'): log_record[\"method\"] = record.method if hasattr(record, 'duration_ms'): log_record[\"duration_ms\"] = record.duration_ms if hasattr(record, 'status_code'): log_record[\"status_code\"] = record.status_code if hasattr(record, 'user_id'): log_record[\"user_id\"] = record.user_id return json.dumps(log_record) # 로거 설정 logger = logging.getLogger(\"api\") handler = logging.StreamHandler() handler.setFormatter(JSONFormatter()) logger.addHandler(handler) logger.setLevel(logging.INFO) # 요청/응답 로깅 미들웨어 @app.before_request def before_request(): g.start_time = time.time() g.request_id = str(uuid.uuid4()) @app.after_request def after_request(response): duration = time.time() - g.start_time # 구조화된 로그 레코드 생성 logger.info( f\"API Request Completed\", extra={ \"request_id\": g.request_id, \"method\": request.method, \"path\": request.path, \"status_code\": response.status_code, \"duration_ms\": round(duration * 1000, 2), \"user_id\": g.get('user_id', 'anonymous') } ) return response # 오류 로깅 @app.errorhandler(Exception) def handle_exception(e): logger.error( f\"API Error: {str(e)}\", extra={ \"request_id\": g.get('request_id', 'unknown'), \"method\": request.method, \"path\": request.path, \"error_type\": type(e).__name__ }, exc_info=True ) return {\"error\": \"Internal Server Error\"}, 500 로그 기반 모니터링의 주요 장점:\n오류의 상세한 컨텍스트 제공 디버깅을 위한 풍부한 정보 제공 과거 문제 분석 및 트렌드 파악 가능 메트릭 기반 모니터링 API의 성능과 동작에 관한 측정 가능한 수치 데이터를 수집하고 분석한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 # Prometheus 클라이언트를 사용한 메트릭 모니터링 예시 from flask import Flask, request from prometheus_client import Counter, Histogram, start_http_server import time app = Flask(__name__) # 메트릭 정의 REQUEST_COUNT = Counter( 'api_requests_total', 'Total API Request Count', ['method', 'endpoint', 'status'] ) REQUEST_LATENCY = Histogram( 'api_request_latency_seconds', 'API Request Latency', ['method', 'endpoint'] ) # 메트릭 수집 미들웨어 @app.before_request def before_request(): request.start_time = time.time() @app.after_request def after_request(response): request_latency = time.time() - request.start_time REQUEST_LATENCY.labels( method=request.method, endpoint=request.path ).observe(request_latency) REQUEST_COUNT.labels( method=request.method, endpoint=request.path, status=response.status_code ).inc() return response # Prometheus 메트릭 서버 시작 @app.before_first_request def start_metrics_server(): start_http_server(8000) # 메트릭을 8000 포트에서 제공 @app.route('/api/user/') def get_user(user_id): # API 로직... return {\"user\": {\"id\": user_id, \"name\": \"Test User\"}} 메트릭 기반 모니터링의 주요 장점:\n실시간 성능 통찰 제공 알림 및 자동화된 응답 가능 장기적인 성능 추세 분석 용이 분산 추적(Distributed Tracing) 마이크로서비스 아키텍처에서 API 요청이 여러 서비스를 통과하는 경로를 추적한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 # OpenTelemetry를 사용한 분산 추적 예시 from flask import Flask from opentelemetry import trace from opentelemetry.exporter.otlp.proto.grpc.trace_exporter import OTLPSpanExporter from opentelemetry.sdk.resources import SERVICE_NAME, Resource from opentelemetry.sdk.trace import TracerProvider from opentelemetry.sdk.trace.export import BatchSpanProcessor from opentelemetry.instrumentation.flask import FlaskInstrumentor from opentelemetry.instrumentation.requests import RequestsInstrumentor import requests # 트레이싱 설정 resource = Resource(attributes={SERVICE_NAME: \"user-api\"}) tracer_provider = TracerProvider(resource=resource) processor = BatchSpanProcessor(OTLPSpanExporter(endpoint=\"localhost:4317\")) tracer_provider.add_span_processor(processor) trace.set_tracer_provider(tracer_provider) tracer = trace.get_tracer(__name__) app = Flask(__name__) FlaskInstrumentor().instrument_app(app) RequestsInstrumentor().instrument() @app.route('/api/user-activity/') def get_user_activity(user_id): with tracer.start_as_current_span(\"get_user_details\") as span: span.set_attribute(\"user.id\", user_id) # 사용자 세부 정보 가져오기 user_response = requests.get(f\"http://user-service/users/{user_id}\") user_data = user_response.json() with tracer.start_as_current_span(\"get_activity_data\") as activity_span: # 사용자 활동 데이터 가져오기 activity_response = requests.get(f\"http://activity-service/activities?user_id={user_id}\") activity_data = activity_response.json() activity_span.set_attribute(\"activity.count\", len(activity_data)) # 응답 데이터 조합 result = { \"user\": user_data, \"recent_activities\": activity_data[:5] } return result 분산 추적의 주요 장점:\n전체 시스템에 걸친 요청 흐름 가시화 서비스 간 지연 시간 파악 시스템 병목 지점 정확히 식별 API 모니터링 도구 및 플랫폼 1. 오픈소스 모니터링 도구 Prometheus + Grafana: 메트릭 수집, 저장, 쿼리 및 시각화를 위한 강력한 조합 강력한 알림 및 쿼리 언어 제공 Kubernetes와의 원활한 통합 ELK 스택(Elasticsearch, Logstash, Kibana): 로그 수집, 저장, 검색 및 시각화를 위한 통합 솔루션 비정형 로그 데이터 분석에 적합 강력한 전문 검색 기능 Jaeger/Zipkin: 분산 시스템을 위한 추적 도구 요청 흐름 시각화 및 병목 현상 식별 OpenTelemetry와 통합 2. 상용 모니터링 솔루션 Datadog: 종합적인 모니터링 및 분석 플랫폼 API, 인프라, 로그, 사용자 경험을 통합적으로 모니터링 강력한 이상 탐지 및 알림 기능 New Relic: 애플리케이션 성능 모니터링(APM) 중심의 플랫폼 상세한 트랜잭션 추적 및 성능 분석 실시간 대시보드 및 알림 Dynatrace: AI 기반 모니터링 및 관찰성 플랫폼 자동화된 문제 발견 및 근본 원인 분석 전체 스택 모니터링 3. 클라우드 제공업체 도구 AWS CloudWatch: AWS 서비스와 통합된 모니터링 솔루션 API Gateway, Lambda 등의 서비스 모니터링 사용자 지정 메트릭 및 알림 지원 Google Cloud Monitoring: Google Cloud 서비스 모니터링 API 성능 및 오류 추적 통합 대시보드 및 알림 Azure Monitor: Azure 서비스 모니터링 Application Insights를 통한 API 추적 종합적인 로그 분석 API 모니터링 구현 모범 사례 다층적 모니터링 전략 효과적인 API 모니터링은 여러 계층에서 접근해야 한다:\n인프라 계층: 서버, 네트워크, 컨테이너 상태 모니터링 애플리케이션 계층: API 서비스 자체의 성능과 동작 모니터링 비즈니스 계층: 비즈니스 프로세스와 트랜잭션 성공률 모니터링 사용자 경험 계층: 클라이언트 측에서의 API 상호작용 모니터링 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 # Prometheus 알림 규칙 예시 (다층적 접근) groups: - name: api_alerts rules: # 인프라 계층 알림 - alert: HighCpuUsage expr: avg(rate(node_cpu_seconds_total{mode!=\"idle\"}[5m])) by (instance) \u003e 0.8 for: 5m labels: severity: warning layer: infrastructure annotations: summary: \"High CPU usage on {{ $labels.instance }}\" description: \"CPU usage is above 80% for 5 minutes\" # 애플리케이션 계층 알림 - alert: ApiHighErrorRate expr: sum(rate(api_requests_total{status=~\"5..\"}[5m])) / sum(rate(api_requests_total[5m])) \u003e 0.05 for: 2m labels: severity: critical layer: application annotations: summary: \"API error rate is high\" description: \"Error rate is above 5% for 2 minutes\" # 비즈니스 계층 알림 - alert: LowTransactionSuccessRate expr: sum(rate(business_transactions_success_total[5m])) / sum(rate(business_transactions_total[5m])) \u003c 0.95 for: 5m labels: severity: critical layer: business annotations: summary: \"Business transaction success rate is low\" description: \"Transaction success rate is below 95% for 5 minutes\" 효과적인 알림 설계 알림 피로를 방지하고 중요한 문제에 집중할 수 있는 알림 전략을 구현한다:\n임계값 기반 알림: 주요 지표가 사전 정의된 임계값을 초과할 때 알림 추세 기반 알림: 비정상적인 패턴이나 갑작스러운 변화 감지 시 알림 우선순위 기반 라우팅: 알림의 심각도에 따라 적절한 대응 채널로 라우팅 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 # 알림 임계값 설정 및 에스컬레이션 예시 class AlertManager: def __init__(self): self.thresholds = { 'response_time': { 'warning': 500, # 500ms 'critical': 1000 # 1초 }, 'error_rate': { 'warning': 0.01, # 1% 'critical': 0.05 # 5% }, 'request_rate': { 'warning': 1000, # 초당 1000 요청 'critical': 1500 # 초당 1500 요청 } } self.escalation_policies = { 'warning': ['slack-channel'], 'critical': ['slack-channel', 'pagerduty', 'sms'] } # 알림 발생 이력 (알림 폭풍 방지) self.alert_history = {} def check_and_alert(self, metric_name, value, context=None): if metric_name not in self.thresholds: return severity = None if value \u003e= self.thresholds[metric_name]['critical']: severity = 'critical' elif value \u003e= self.thresholds[metric_name]['warning']: severity = 'warning' if severity: # 알림 폭풍 방지: 최근에 비슷한 알림이 발생했는지 확인 alert_key = f\"{metric_name}:{severity}\" current_time = time.time() # 지난 10분 이내에 알림이 발생했는지 확인 if (alert_key in self.alert_history and current_time - self.alert_history[alert_key] \u003c 600): # 이미 알림이 발생했으므로 무시 return # 알림 발생 시간 기록 self.alert_history[alert_key] = current_time # 알림 생성 및 전송 alert = { 'metric': metric_name, 'value': value, 'threshold': self.thresholds[metric_name][severity], 'severity': severity, 'timestamp': current_time, 'context': context or {} } self.send_alert(alert, self.escalation_policies[severity]) def send_alert(self, alert, channels): for channel in channels: if channel == 'slack-channel': self.send_to_slack(alert) elif channel == 'pagerduty': self.send_to_pagerduty(alert) elif channel == 'sms': self.send_sms(alert) 전체 API 수명 주기 모니터링 API의 모든 생명 주기 단계를 모니터링하는 것이 중요하다:\n개발 단계: 성능 테스트 및 코드 품질 모니터링 배포 단계: 배포 성공률 및 서비스 중단 모니터링 운영 단계: 실시간 성능 및 가용성 모니터링 폐기 단계: 레거시 API 사용 현황 및 마이그레이션 진행 상황 모니터링 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 # API 버전별 사용 현황 모니터링 예시 def track_api_version_usage(request, response): \"\"\"API 버전 사용 현황을 모니터링하는 미들웨어\"\"\" version = get_api_version(request) # 버전별 사용량 메트릭 기록 increment_counter('api.version.usage', tags={'version': version}) # 폐기 예정 버전에 대한 경고 로깅 if version in DEPRECATED_VERSIONS: log.warning( \"Deprecated API version used\", extra={ 'version': version, 'client_id': get_client_id(request), 'endpoint': request.path, 'sunset_date': SUNSET_DATES.get(version, 'unknown') } ) # 응답 헤더에 폐기 관련 정보 추가 sunset_date = SUNSET_DATES.get(version) if sunset_date: response.headers['Sunset'] = sunset_date response.headers['Deprecation'] = 'true' response.headers['Link'] = f'\u003c{MIGRATION_GUIDES[version]}\u003e; rel=\"deprecation\"; type=\"text/html\"' return response 사용자 정의 건강 검사(Health Checks) 구현 API의 핵심 기능과 종속성을 주기적으로 검사하여 전체 시스템의 건강 상태를 모니터링한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 # Flask에서의 종합적인 건강 검사 API 구현 from flask import Flask, jsonify import redis import psycopg2 import requests import time app = Flask(__name__) def check_database(): \"\"\"데이터베이스 연결 및 기본 쿼리 건강 검사\"\"\" try: conn = psycopg2.connect(DATABASE_URL) cursor = conn.cursor() cursor.execute(\"SELECT 1\") # 간단한 쿼리로 연결 확인 cursor.close() conn.close() return True, \"Database connection is healthy\" except Exception as e: return False, f\"Database connection failed: {str(e)}\" def check_redis(): \"\"\"Redis 연결 건강 검사\"\"\" try: redis_client = redis.Redis(host=REDIS_HOST, port=REDIS_PORT) redis_client.ping() # PING 명령으로 연결 확인 return True, \"Redis connection is healthy\" except Exception as e: return False, f\"Redis connection failed: {str(e)}\" def check_external_api(): \"\"\"외부 의존성 API 건강 검사\"\"\" try: response = requests.get( \"https://external-api.example.com/health\", timeout=3 # 3초 타임아웃 설정 ) if response.status_code == 200: return True, \"External API is reachable\" else: return False, f\"External API returned status code {response.status_code}\" except Exception as e: return False, f\"External API check failed: {str(e)}\" @app.route('/health') def basic_health_check(): \"\"\"기본 가용성 확인을 위한 간단한 건강 검사\"\"\" return jsonify({\"status\": \"UP\"}) @app.route('/health/detailed') def detailed_health_check(): \"\"\"상세한, 종합적인 건강 검사\"\"\" start_time = time.time() checks = { \"database\": check_database(), \"redis\": check_redis(), \"external_api\": check_external_api() } # 전체 상태 계산 all_healthy = all(result[0] for result in checks.values()) overall_status = \"UP\" if all_healthy else \"DOWN\" # 응답 형식화 response = { \"status\": overall_status, \"checks\": { name: { \"status\": \"UP\" if result[0] else \"DOWN\", \"message\": result[1] } for name, result in checks.items() }, \"time\": round((time.time() - start_time) * 1000, 2) # ms 단위 응답 시간 } status_code = 200 if all_healthy else 503 # 서비스 사용 불가 상태 코드 return jsonify(response), status_code API 모니터링의 도전 과제와 해결 방법 데이터 볼륨 관리 대규모 API는 방대한 양의 모니터링 데이터를 생성하며, 이를 효과적으로 관리해야 한다.\n해결 방법:\n데이터 샘플링: 전체 트래픽의 일부만 상세히 추적 집계 전략: 원시 데이터를 의미 있는 통계로 축소 TTL(Time-to-Live) 정책: 오래된 데이터 자동 삭제 계층적 스토리지: 최신 데이터는 고속 스토리지에, 오래된 데이터는 저비용 스토리지에 보관 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 // 샘플링 구현 예시 (Node.js) function shouldSample(requestId) { // 현재 샘플링 비율 (환경 변수나 설정에서 가져옴) const samplingRate = parseFloat(process.env.TRACING_SAMPLING_RATE || \"0.1\"); // 기본값 10% // requestId의 해시값을 계산하여 0-1 사이의 값으로 정규화 const hash = calculateHash(requestId); const normalizedHash = hash / Number.MAX_SAFE_INTEGER; // 정규화된 해시값이 샘플링 비율보다 작으면 샘플링 return normalizedHash \u003c samplingRate; } // 미들웨어에서 사용 app.use((req, res, next) =\u003e { const requestId = req.headers['x-request-id'] || uuidv4(); req.requestId = requestId; // 샘플링 여부 결정 req.shouldTrace = shouldSample(requestId); // 모든 요청에 대해 기본 메트릭은 항상 수집 collectBasicMetrics(req, res); // 샘플링된 요청에 대해서만 상세 추적 활성화 if (req.shouldTrace) { enableDetailedTracing(req, res); } next(); }); 보안 모니터링 통합 API 모니터링은 성능뿐만 아니라 보안 측면도 고려해야 한다.\n해결 방법:\n비정상 패턴 감지: 비정상적인 요청 패턴 모니터링 속도 제한 모니터링: 속도 제한 위반 추적 인증 실패 모니터링: 인증 오류 패턴 분석 데이터 유출 감지: 민감한 데이터 유출 모니터링 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 # API 보안 모니터링 예시 def monitor_security_events(request, response): # 인증 실패 모니터링 if response.status_code == 401: increment_counter('api.auth.failure', tags={ 'ip': request.remote_addr, 'user_agent': request.user_agent.string, 'endpoint': request.path }) # 동일 IP에서의 인증 실패 횟수 확인 failure_count = get_recent_failures(request.remote_addr) if failure_count \u003e THRESHOLD_SUSPICIOUS_AUTH_FAILURES: log_security_event('excessive_auth_failures', { 'ip': request.remote_addr, 'count': failure_count, 'time_window': 'last 1 hour' }) # API 속도 제한 모니터링 if response.status_code == 429: increment_counter('api.rate_limit.exceeded', tags={ 'client_id': get_client_id(request), 'endpoint': request.path }) # 속도 제한 초과 패턴 분석 if is_abnormal_rate_pattern(get_client_id(request)): log_security_event('suspicious_rate_limit_pattern', { 'client_id': get_client_id(request), 'pattern': 'burst_traffic' }) # 데이터 유출 의심 모니터링 (비정상적으로 큰 응답) if response.content_length \u003e THRESHOLD_LARGE_RESPONSE: log_security_event('large_data_transfer', { 'client_id': get_client_id(request), 'endpoint': request.path, 'size': response.content_length }) 마이크로서비스 환경에서의 모니터링 마이크로서비스 아키텍처는 분산된 서비스의 모니터링 복잡성을 증가시킨다.\n해결 방법:\n상관 ID 전파: 요청 추적을 위한 고유 식별자 전달 서비스 맵 생성: 서비스 간 종속성 시각화 분산 로깅: 중앙 집중식 로그 수집 및 분석 서비스 메시: Istio, Linkerd 등의 서비스 메시를 통한 관찰성 향상 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 // 상관 ID 전파 예시 (Java/Spring) @Component public class CorrelationIdFilter extends OncePerRequestFilter { private static final String CORRELATION_ID_HEADER = \"X-Correlation-ID\"; @Override protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException { String correlationId = request.getHeader(CORRELATION_ID_HEADER); // 상관 ID가 없으면 새로 생성 if (correlationId == null || correlationId.isEmpty()) { correlationId = UUID.randomUUID().toString(); } // MDC에 상관 ID 설정 (로깅용) MDC.put(\"correlationId\", correlationId); // 응답 헤더에 상관 ID 추가 response.addHeader(CORRELATION_ID_HEADER, correlationId); try { // 다운스트림 서비스 호출 시 상관 ID 전달을 위한 설정 RequestContextHolder.currentRequestAttributes() .setAttribute(\"correlationId\", correlationId, RequestAttributes.SCOPE_REQUEST); filterChain.doFilter(request, response); } finally { MDC.remove(\"correlationId\"); } } } // RestTemplate에 상관 ID 추가 @Configuration public class RestTemplateConfig { @Bean public RestTemplate restTemplate() { RestTemplate restTemplate = new RestTemplate(); restTemplate.setInterceptors( Collections.singletonList((request, body, execution) -\u003e { String correlationId = (String) RequestContextHolder.currentRequestAttributes() .getAttribute(\"correlationId\", RequestAttributes.SCOPE_REQUEST); if (correlationId != null) { request.getHeaders().add(\"X-Correlation-ID\", correlationId); } return execution.execute(request, body); }) ); return restTemplate; } } API 모니터링 고급 기법 이상 탐지 및 예측 분석 정상적인 패턴에서 벗어난 비정상적인 API 동작을 자동으로 감지하고 미래 문제를 예측한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 # 이상 탐지 예시 (Python/SciPy) from scipy import stats import numpy as np class AnomalyDetector: def __init__(self, window_size=60, threshold=3.0): self.window_size = window_size # 분석할 이전 데이터 포인트 수 self.threshold = threshold # 이상 감지 z-score 임계값 self.history = [] # 이전 데이터 포인트 저장 def is_anomaly(self, value): \"\"\"현재 값이 이상치인지 확인\"\"\" self.history.append(value) # 충분한 데이터가 없으면 이상으로 간주하지 않음 if len(self.history) \u003c self.window_size: return False # 윈도우 크기 유지 if len(self.history) \u003e self.window_size: self.history.pop(0) # z-score 계산 mean = np.mean(self.history[:-1]) # 현재 값을 제외한 평균 std = np.std(self.history[:-1]) # 현재 값을 제외한 표준편차 # 표준편차가 0에 가까우면 일정한 값이므로 이상이 아님 if std \u003c 1e-10: return False z_score = abs((value - mean) / std) return z_score \u003e self.threshold # 사용 예시 response_time_detector = AnomalyDetector(window_size=100, threshold=3.5) def monitor_api_response_time(endpoint, response_time): if response_time_detector.is_anomaly(response_time): log.warning( f\"Anomalous response time detected for {endpoint}: {response_time}ms \" f\"(threshold: {response_time_detector.threshold} standard deviations)\" ) # 알림 전송 send_alert( title=f\"Anomalous API Response Time: {endpoint}\", message=f\"Response time of {response_time}ms is abnormally high.\", severity=\"warning\" ) 지능형 알림 전략 컨텍스트 인식 알림과 자동화된 문제 해결 방법을 구현한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 # 지능형 알림 시스템 예시 class SmartAlertSystem: def __init__(self): # 알림 상태 저장 self.active_alerts = {} # 알림 에스컬레이션 상태 self.escalations = {} # 자동 해결 동작 self.auto_remediation_actions = { 'high_error_rate': self.restart_service, 'memory_leak': self.increase_memory_limit, 'database_connection_issues': self.check_db_connections } def process_alert(self, alert_type, severity, context): \"\"\"알림 처리 및 지능형 라우팅\"\"\" alert_key = f\"{alert_type}:{context.get('service', 'unknown')}\" # 이미 활성화된 알림인지 확인 if alert_key in self.active_alerts: # 기존 알림 상태 업데이트 self.active_alerts[alert_key]['count'] += 1 self.active_alerts[alert_key]['last_seen'] = time.time() # 알림이 지속되면 에스컬레이션 duration = time.time() - self.active_alerts[alert_key]['first_seen'] if duration \u003e 900 and alert_key not in self.escalations: # 15분 이상 지속 self.escalate_alert(alert_key, context) else: # 새로운 알림 생성 self.active_alerts[alert_key] = { 'type': alert_type, 'severity': severity, 'context': context, 'count': 1, 'first_seen': time.time(), 'last_seen': time.time() } # 즉시 알림 self.send_initial_alert(alert_key) # 자동 해결 시도 self.attempt_auto_remediation(alert_type, context) def escalate_alert(self, alert_key, context): \"\"\"알림 에스컬레이션 - 더 높은 우선순위로 라우팅\"\"\" alert = self.active_alerts[alert_key] # 에스컬레이션 상태 저장 self.escalations[alert_key] = { 'time': time.time(), 'previous_severity': alert['severity'] } # 심각도 상향 조정 new_severity = 'critical' if alert['severity'] == 'warning' else 'emergency' alert['severity'] = new_severity # 상향된 심각도로 알림 전송 message = ( f\"ESCALATED ALERT: {alert['type']} issue has been ongoing for \" f\"{int((time.time() - alert['first_seen']) / 60)} minutes. \" f\"Occurred {alert['count']} times.\" ) # 에스컬레이션 경로에 따라 알림 전송 self.send_escalated_alert(alert_key, message, new_severity) def attempt_auto_remediation(self, alert_type, context): \"\"\"자동 문제 해결 시도\"\"\" if alert_type in self.auto_remediation_actions: try: result = self.auto_remediation_actions[alert_type](context) if result['success']: log.info( f\"Auto-remediation for {alert_type} successful: {result['message']}\" ) else: log.warning( f\"Auto-remediation for {alert_type} failed: {result['message']}\" ) except Exception as e: log.error(f\"Error during auto-remediation for {alert_type}: {str(e)}\") # 자동 해결 동작 구현 def restart_service(self, context): service_name = context.get('service') # 서비스 재시작 로직… return {'success': True, 'message': f\"Service {service_name} restarted successfully\"} def increase_memory_limit(self, context): service_name = context.get('service') # 메모리 한도 증가 로직… return {'success': True, 'message': f\"Memory limit for {service_name} increased\"} def check_db_connections(self, context): # 데이터베이스 연결 풀 확인 및 리셋 로직… return {'success': True, 'message': \"Database connection pool reset\"} 사용자 행동 분석 API 사용 패턴을 분석하여 사용자 행동과 요구사항을 더 잘 이해한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 // API 사용자 행동 분석 예시 (Node.js) class APIUsageAnalytics { constructor() { this.sessionData = {}; // 세션별 데이터 저장 this.userPatterns = {}; // 사용자별 패턴 저장 } trackRequest(userId, sessionId, endpoint, method, timestamp) { // 세션 데이터 초기화 if (!this.sessionData[sessionId]) { this.sessionData[sessionId] = { userId, startTime: timestamp, lastActivity: timestamp, requests: [], endpoints: new Set() }; } // 요청 추적 this.sessionData[sessionId].requests.push({ endpoint, method, timestamp }); this.sessionData[sessionId].endpoints.add(endpoint); this.sessionData[sessionId].lastActivity = timestamp; // 사용자 패턴 업데이트 if (!this.userPatterns[userId]) { this.userPatterns[userId] = { frequentEndpoints: {}, typicalSessionLength: [], commonFlows: {} }; } // 엔드포인트 사용 빈도 추적 const endpoints = this.userPatterns[userId].frequentEndpoints; endpoints[endpoint] = (endpoints[endpoint] || 0) + 1; // 흐름 분석 (순차적 API 호출 패턴) const session = this.sessionData[sessionId]; if (session.requests.length \u003e= 2) { const prevRequest = session.requests[session.requests.length - 2]; const flow = `${prevRequest.endpoint} -\u003e ${endpoint}`; const flows = this.userPatterns[userId].commonFlows; flows[flow] = (flows[flow] || 0) + 1; } } analyzeSession(sessionId) { const session = this.sessionData[sessionId]; if (!session) return null; const sessionLength = session.lastActivity - session.startTime; const userId = session.userId; // 세션 길이 추적 this.userPatterns[userId].typicalSessionLength.push(sessionLength); // 세션 분석 결과 반환 return { userId, duration: sessionLength, requestCount: session.requests.length, uniqueEndpoints: session.endpoints.size, mostFrequentEndpoint: this.getMostFrequent( session.requests.map(r =\u003e r.endpoint) ) }; } getUserInsights(userId) { const patterns = this.userPatterns[userId]; if (!patterns) return null; // 가장 자주 사용하는 엔드포인트 const frequentEndpoints = Object.entries(patterns.frequentEndpoints) .sort((a, b) =\u003e b[1] - a[1]) .slice(0, 5); // 평균 세션 길이 const avgSessionLength = patterns.typicalSessionLength.length \u003e 0 ? patterns.typicalSessionLength.reduce((sum, len) =\u003e sum + len, 0) / patterns.typicalSessionLength.length : 0; // 일반적인 API 사용 흐름 const commonFlows = Object.entries(patterns.commonFlows) .sort((a, b) =\u003e b[1] - a[1]) .slice(0, 5); return { userId, topEndpoints: frequentEndpoints, averageSessionLength: avgSessionLength, typicalFlows: commonFlows }; } getMostFrequent(arr) { const counts = {}; let maxItem = null; let maxCount = 0; for (const item of arr) { counts[item] = (counts[item] || 0) + 1; if (counts[item] \u003e maxCount) { maxItem = item; maxCount = counts[item]; } } return maxItem; } } API 모니터링을 위한 조직 문화 및 프로세스 관찰성 문화 구축 모니터링에 그치지 않고 더 넓은 관찰성(Observability) 문화를 조직에 정착시킨다.\n핵심 원칙:\n관찰성 중심 설계: API 설계 단계부터 관찰성 고려 로그, 메트릭, 트레이스의 통합: “3대 관찰성 기둥” 통합 접근법 가시성 민주화: 모든 팀원이 모니터링 도구에 접근 가능하게 함 지속적 개선: 인시던트에서 배운 교훈을 통해 모니터링 전략 개선 SRE(Site Reliability Engineering) 원칙 적용 Google의 SRE 원칙을 API 모니터링에 적용한다.\n주요 개념:\n서비스 수준 목표(SLO) 정의: 명확한 성능 및 가용성 목표 설정 오류 예산: 허용 가능한 서비스 중단 또는 성능 저하의 한도 설정 점진적 알림: 심각도에 따른 단계적 알림 전략 포스트모템 문화: 장애 후 비난 없는 분석 및 학습 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 # SLO 정의 예시 (yaml 형식) service: user-api slos: - name: availability target: 99.9% # 월간 목표 가용성 metric: api_success_rate measurement: ratio of successful to total requests window: 30d # 30일 측정 기간 - name: latency target: 95% # 요청의 95%가 임계값 이내여야 함 metric: api_request_duration_ms measurement: percentage of requests under threshold threshold: 300ms # 300밀리초 임계값 window: 30d # 30일 측정 기간 error_budget: policy: # 오류 예산의 50%를 소진하면 릴리스 속도 줄이기 - consumption: 50% action: \"Reduce release velocity by 50%\" # 오류 예산의 75%를 소진하면 예정된 기능 릴리스 중단 - consumption: 75% action: \"Pause feature releases, focus on reliability improvements\" # 오류 예산의 90%를 소진하면 긴급 대응 모드 진입 - consumption: 90% action: \"Enter emergency response mode, all teams focus on reliability\" 3. DevOps 통합 및 자동화 CI/CD 파이프라인에 모니터링 및 알림을 통합하여 개발과 운영 사이의 격차를 줄인다.\n핵심 전략:\n배포 전 성능 테스트: 자동화된 성능 테스트를, 빌드 프로세스에 통합 카나리 배포: 소규모 사용자 그룹에 새 버전을 점진적으로 출시하며 모니터링 자동 롤백: 성능 저하 시 자동으로 이전 버전으로 롤백 인프라스트럭처 코드화: 모니터링 구성도 코드화하여 버전 관리 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 # GitHub Actions를 사용한 API 모니터링 CI/CD 통합 예시 name: API Deploy and Monitor on: push: branches: [ main ] jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v2 - name: Setup environment run: docker-compose up -d - name: Run unit and integration tests run: npm test - name: Performance baseline test run: | npm run perf-test node scripts/analyze-performance.js --fail-threshold=10 deploy: needs: test runs-on: ubuntu-latest steps: - uses: actions/checkout@v2 - name: Deploy to 10% of production (canary) run: ./deploy.sh --environment=production --canary=10 - name: Monitor canary deployment run: | # 15분 동안 카나리 배포 모니터링 ./monitor-deployment.sh --duration=15m --environment=canary - name: Check error budget consumption run: | ERROR_BUDGET_CONSUMPTION=$(curl -s https://monitoring-api.example.com/error-budget) if [ $ERROR_BUDGET_CONSUMPTION -gt 80 ]; then echo \"Error budget consumption too high: $ERROR_BUDGET_CONSUMPTION%\" ./rollback.sh --environment=production exit 1 fi - name: Complete rollout to production if: success() run: ./deploy.sh --environment=production --complete-rollout - name: Configure monitoring alerts run: | # 새로운 배포에 대한 모니터링 알림 설정 ./configure-alerts.sh --version=$(git rev-parse --short HEAD) 용어 정리 용어 설명 가용성(Availability) IT와 소프트웨어 시스템에서 서비스, 시스템, 또는 애플리케이션이 사용자에게 정상적으로 접근 가능하고 동작 가능한 상태를 유지하는 능력을 의미한다. 이는 시스템의 신뢰성과 안정성을 나타내는 중요한 지표 중 하나로, 특히 클라우드 컴퓨팅, 네트워크, 데이터센터, 웹 애플리케이션 등에서 핵심적인 성능 척도로 사용된다. - 공식적인 정의: 가용성은 특정 시간 동안 시스템이 정상적으로 작동하여 사용자 요청을 처리할 수 있는 비율을 나타낸다. 수식: 가용성 (%)=(정상 작동 시간 / 전체 시간)×100\n- 예시: - 하루(24시간) 중 시스템이 23시간 55분 동안 정상 작동했다면: 가용성 (%)=(1435 / 1440)×100=99.65%\n가용성의 중요성\n1. 사용자 경험 개선: - 높은 가용성은 서비스 중단 없이 사용자에게 안정적인 경험을 제공한다. - 예: 전자상거래 사이트가 항상 접근 가능해야 고객이 구매를 완료할 수 있음. 2. 비즈니스 연속성 보장: - 서비스 중단은 매출 손실과 고객 신뢰도 저하로 이어질 수 있다. - 예: 금융 서비스나 의료 시스템에서 가용성 부족은 심각한 문제를 초래할 수 있음. 3. 서비스 수준 계약(SLA) 준수: - 서비스 제공자는 SLA에서 명시된 가용성을 보장해야 하며, 이를 충족하지 못하면 페널티를 지불해야 할 수도 있다. 참고 및 출처 ","wordCount":"5608","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2025-02-14T01:28:00Z","dateModified":"2025-02-14T01:28:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/backend-development/api-design-and-implementation/api-monitoring-and-analytics/api-monitoring/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>기술 블로그</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend-development/>Backend Development</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend-development/api-design-and-implementation/>API Design and Implementation</a></div><h1 class="post-title entry-hint-parent">Monitoring</h1><div class=post-description>API 모니터링은 단순한 로그 수집을 넘어서, API 시스템의 건강 상태를 종합적으로 관찰하고 평가하는 프로세스이다.</div><div class=post-meta><span title='2025-02-14 01:28:00 +0000 UTC'>February 14, 2025</span>&nbsp;·&nbsp;27 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/Backend%20Development/API%20Design%20and%20Implementation/API%20Monitoring%20and%20Analytics/API-Monitoring.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#monitoring>Monitoring</a><ul><li><a href=#api-모니터링의-기본-개념>API 모니터링의 기본 개념</a></li><li><a href=#api-모니터링의-중요성>API 모니터링의 중요성</a></li><li><a href=#api-모니터링의-핵심-지표>API 모니터링의 핵심 지표</a></li><li><a href=#api-모니터링-구현-방법>API 모니터링 구현 방법</a></li><li><a href=#api-모니터링-도구-및-플랫폼>API 모니터링 도구 및 플랫폼</a></li><li><a href=#api-모니터링-구현-모범-사례>API 모니터링 구현 모범 사례</a></li><li><a href=#api-모니터링의-도전-과제와-해결-방법>API 모니터링의 도전 과제와 해결 방법</a></li><li><a href=#api-모니터링-고급-기법>API 모니터링 고급 기법</a></li><li><a href=#api-모니터링을-위한-조직-문화-및-프로세스>API 모니터링을 위한 조직 문화 및 프로세스</a></li></ul></li><li><a href=#용어-정리>용어 정리</a></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=monitoring>Monitoring<a hidden class=anchor aria-hidden=true href=#monitoring>#</a></h2><p>API 모니터링은 API의 가용성, 성능, 기능적 정확성을 지속적으로 관찰하고 평가하는 체계적인 프로세스이다. 이는 현대 소프트웨어 시스템의 안정성과 신뢰성을 보장하는 데 필수적인 요소로, 문제를 조기에 감지하고 해결함으로써 서비스 중단과 사용자 경험 저하를 방지한다.</p><h3 id=api-모니터링의-기본-개념>API 모니터링의 기본 개념<a hidden class=anchor aria-hidden=true href=#api-모니터링의-기본-개념>#</a></h3><p>API 모니터링은 단순한 로그 수집을 넘어서, API 시스템의 건강 상태를 종합적으로 관찰하고 평가하는 프로세스이다. 이는 다음과 같은 핵심 측면을 포함한다:</p><ol><li><strong>가용성 모니터링</strong>: API가 지속적으로 응답하며 접근 가능한지 확인한다.</li><li><strong>성능 모니터링</strong>: 응답 시간, 처리량, 오류율 등의 성능 지표를 추적한다.</li><li><strong>기능적 모니터링</strong>: API가 예상대로 정확한 결과를 반환하는지 검증한다.</li><li><strong>인프라 모니터링</strong>: API를 지원하는 기본 인프라의 상태를 관찰한다.</li><li><strong>보안 모니터링</strong>: 비정상적인 접근 패턴이나 보안 위협을 감지한다.</li></ol><h3 id=api-모니터링의-중요성>API 모니터링의 중요성<a hidden class=anchor aria-hidden=true href=#api-모니터링의-중요성>#</a></h3><p>API 모니터링이 비즈니스와 기술적 측면에서 제공하는 가치는 다음과 같다:</p><ol><li><strong>서비스 신뢰성 보장</strong>: 지속적인 모니터링을 통해 API 장애를 빠르게 감지하고 대응함으로써 서비스 중단 시간을 최소화한다.</li><li><strong>사용자 경험 향상</strong>: 성능 저하 문제를 조기에 식별하여 사용자 만족도를 유지하고 개선한다.</li><li><strong>프로액티브한 문제 해결</strong>: 문제가 심각해지기 전에 조기 경고 신호를 통해 선제적으로 대응할 수 있다.</li><li><strong>용량 계획 및 확장성</strong>: 트래픽 패턴과 리소스 사용량을 분석하여 적절한 용량 계획을 수립할 수 있다.</li><li><strong>SLA(서비스 수준 계약) 준수</strong>: 서비스 수준 목표를 지속적으로 측정하고 보고하여 계약 준수를 보장한다.</li><li><strong>비즈니스 인텔리전스</strong>: API 사용 패턴을 분석하여 비즈니스 통찰력을 얻을 수 있다.</li></ol><h3 id=api-모니터링의-핵심-지표>API 모니터링의 핵심 지표<a hidden class=anchor aria-hidden=true href=#api-모니터링의-핵심-지표>#</a></h3><p>효과적인 API 모니터링을 위해 추적해야 할 핵심 지표들은 다음과 같다:</p><h4 id=가용성-지표>가용성 지표<a hidden class=anchor aria-hidden=true href=#가용성-지표>#</a></h4><ul><li><strong>업타임(Uptime)</strong>: API 서비스의 가용 시간 비율</li><li><strong>가동 시간(Uptime Duration)</strong>: 연속적인 서비스 가동 시간</li><li><strong>장애 빈도(Failure Rate)</strong>: 일정 기간 동안 발생한 장애의 수</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># API 가용성 계산 예시</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>calculate_availability</span><span class=p>(</span><span class=n>total_requests</span><span class=p>,</span> <span class=n>failed_requests</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>total_requests</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mf>100.0</span>  <span class=c1># 요청이 없으면 100% 가용성으로 간주</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>availability</span> <span class=o>=</span> <span class=p>((</span><span class=n>total_requests</span> <span class=o>-</span> <span class=n>failed_requests</span><span class=p>)</span> <span class=o>/</span> <span class=n>total_requests</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>round</span><span class=p>(</span><span class=n>availability</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>  <span class=c1># 소수점 둘째 자리까지 반올림</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 9s 가용성 수준 정의</span>
</span></span><span class=line><span class=cl><span class=n>availability_levels</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;two_nines&#34;</span><span class=p>:</span> <span class=mf>99.0</span><span class=p>,</span>    <span class=c1># 가동 중지 시간: 월간 약 7.2시간</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;three_nines&#34;</span><span class=p>:</span> <span class=mf>99.9</span><span class=p>,</span>  <span class=c1># 가동 중지 시간: 월간 약 43.2분</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;four_nines&#34;</span><span class=p>:</span> <span class=mf>99.99</span><span class=p>,</span>  <span class=c1># 가동 중지 시간: 월간 약 4.32분</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;five_nines&#34;</span><span class=p>:</span> <span class=mf>99.999</span>  <span class=c1># 가동 중지 시간: 월간 약 26초</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=성능-지표>성능 지표<a hidden class=anchor aria-hidden=true href=#성능-지표>#</a></h4><ul><li><strong>응답 시간(Response Time)</strong>: 요청을 처리하는 데 걸리는 시간</li><li><strong>지연 시간(Latency)</strong>: 네트워크 또는 처리 지연 시간</li><li><strong>처리량(Throughput)</strong>: 단위 시간당 처리된 요청 수</li><li><strong>요청 속도(Request Rate)</strong>: 초당 들어오는 요청의 수</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16>16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17>17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18>18</a>
</span><span class=lnt id=hl-1-19><a class=lnlinks href=#hl-1-19>19</a>
</span><span class=lnt id=hl-1-20><a class=lnlinks href=#hl-1-20>20</a>
</span><span class=lnt id=hl-1-21><a class=lnlinks href=#hl-1-21>21</a>
</span><span class=lnt id=hl-1-22><a class=lnlinks href=#hl-1-22>22</a>
</span><span class=lnt id=hl-1-23><a class=lnlinks href=#hl-1-23>23</a>
</span><span class=lnt id=hl-1-24><a class=lnlinks href=#hl-1-24>24</a>
</span><span class=lnt id=hl-1-25><a class=lnlinks href=#hl-1-25>25</a>
</span><span class=lnt id=hl-1-26><a class=lnlinks href=#hl-1-26>26</a>
</span><span class=lnt id=hl-1-27><a class=lnlinks href=#hl-1-27>27</a>
</span><span class=lnt id=hl-1-28><a class=lnlinks href=#hl-1-28>28</a>
</span><span class=lnt id=hl-1-29><a class=lnlinks href=#hl-1-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Express.js에서 응답 시간 모니터링 미들웨어 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>responseTimeMiddleware</span> <span class=o>=</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>start</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>hrtime</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;finish&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>end</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>hrtime</span><span class=p>(</span><span class=nx>start</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>duration</span> <span class=o>=</span> <span class=p>(</span><span class=nx>end</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mf>1e9</span> <span class=o>+</span> <span class=nx>end</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>/</span> <span class=mf>1e6</span><span class=p>;</span> <span class=c1>// 밀리초로 변환
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=c1>// 메트릭 기록 (예: Prometheus, StatsD 등에 전송)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>recordMetric</span><span class=p>(</span><span class=s1>&#39;api.response_time&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>method</span><span class=o>:</span> <span class=nx>req</span><span class=p>.</span><span class=nx>method</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>path</span><span class=o>:</span> <span class=nx>req</span><span class=p>.</span><span class=nx>route</span> <span class=o>?</span> <span class=nx>req</span><span class=p>.</span><span class=nx>route</span><span class=p>.</span><span class=nx>path</span> <span class=o>:</span> <span class=nx>req</span><span class=p>.</span><span class=nx>path</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>status</span><span class=o>:</span> <span class=nx>res</span><span class=p>.</span><span class=nx>statusCode</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>duration</span><span class=o>:</span> <span class=nx>duration</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 응답 시간이 임계값을 초과하면 알림
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>duration</span> <span class=o>&gt;</span> <span class=mi>500</span><span class=p>)</span> <span class=p>{</span>  <span class=c1>// 500ms = 0.5초
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>notifySlowResponse</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>method</span><span class=o>:</span> <span class=nx>req</span><span class=p>.</span><span class=nx>method</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>path</span><span class=o>:</span> <span class=nx>req</span><span class=p>.</span><span class=nx>path</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>duration</span><span class=o>:</span> <span class=nx>duration</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>timestamp</span><span class=o>:</span> <span class=k>new</span> <span class=nb>Date</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=오류-지표>오류 지표<a hidden class=anchor aria-hidden=true href=#오류-지표>#</a></h4><ul><li><strong>오류율(Error Rate)</strong>: 전체 요청 중 오류 응답의 비율</li><li><strong>HTTP 상태 코드 분포</strong>: 각 상태 코드(2xx, 4xx, 5xx 등)의 분포</li><li><strong>오류 유형 분류</strong>: 발생하는 오류의 유형별 분류와 빈도</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span><span class=lnt id=hl-2-21><a class=lnlinks href=#hl-2-21>21</a>
</span><span class=lnt id=hl-2-22><a class=lnlinks href=#hl-2-22>22</a>
</span><span class=lnt id=hl-2-23><a class=lnlinks href=#hl-2-23>23</a>
</span><span class=lnt id=hl-2-24><a class=lnlinks href=#hl-2-24>24</a>
</span><span class=lnt id=hl-2-25><a class=lnlinks href=#hl-2-25>25</a>
</span><span class=lnt id=hl-2-26><a class=lnlinks href=#hl-2-26>26</a>
</span><span class=lnt id=hl-2-27><a class=lnlinks href=#hl-2-27>27</a>
</span><span class=lnt id=hl-2-28><a class=lnlinks href=#hl-2-28>28</a>
</span><span class=lnt id=hl-2-29><a class=lnlinks href=#hl-2-29>29</a>
</span><span class=lnt id=hl-2-30><a class=lnlinks href=#hl-2-30>30</a>
</span><span class=lnt id=hl-2-31><a class=lnlinks href=#hl-2-31>31</a>
</span><span class=lnt id=hl-2-32><a class=lnlinks href=#hl-2-32>32</a>
</span><span class=lnt id=hl-2-33><a class=lnlinks href=#hl-2-33>33</a>
</span><span class=lnt id=hl-2-34><a class=lnlinks href=#hl-2-34>34</a>
</span><span class=lnt id=hl-2-35><a class=lnlinks href=#hl-2-35>35</a>
</span><span class=lnt id=hl-2-36><a class=lnlinks href=#hl-2-36>36</a>
</span><span class=lnt id=hl-2-37><a class=lnlinks href=#hl-2-37>37</a>
</span><span class=lnt id=hl-2-38><a class=lnlinks href=#hl-2-38>38</a>
</span><span class=lnt id=hl-2-39><a class=lnlinks href=#hl-2-39>39</a>
</span><span class=lnt id=hl-2-40><a class=lnlinks href=#hl-2-40>40</a>
</span><span class=lnt id=hl-2-41><a class=lnlinks href=#hl-2-41>41</a>
</span><span class=lnt id=hl-2-42><a class=lnlinks href=#hl-2-42>42</a>
</span><span class=lnt id=hl-2-43><a class=lnlinks href=#hl-2-43>43</a>
</span><span class=lnt id=hl-2-44><a class=lnlinks href=#hl-2-44>44</a>
</span><span class=lnt id=hl-2-45><a class=lnlinks href=#hl-2-45>45</a>
</span><span class=lnt id=hl-2-46><a class=lnlinks href=#hl-2-46>46</a>
</span><span class=lnt id=hl-2-47><a class=lnlinks href=#hl-2-47>47</a>
</span><span class=lnt id=hl-2-48><a class=lnlinks href=#hl-2-48>48</a>
</span><span class=lnt id=hl-2-49><a class=lnlinks href=#hl-2-49>49</a>
</span><span class=lnt id=hl-2-50><a class=lnlinks href=#hl-2-50>50</a>
</span><span class=lnt id=hl-2-51><a class=lnlinks href=#hl-2-51>51</a>
</span><span class=lnt id=hl-2-52><a class=lnlinks href=#hl-2-52>52</a>
</span><span class=lnt id=hl-2-53><a class=lnlinks href=#hl-2-53>53</a>
</span><span class=lnt id=hl-2-54><a class=lnlinks href=#hl-2-54>54</a>
</span><span class=lnt id=hl-2-55><a class=lnlinks href=#hl-2-55>55</a>
</span><span class=lnt id=hl-2-56><a class=lnlinks href=#hl-2-56>56</a>
</span><span class=lnt id=hl-2-57><a class=lnlinks href=#hl-2-57>57</a>
</span><span class=lnt id=hl-2-58><a class=lnlinks href=#hl-2-58>58</a>
</span><span class=lnt id=hl-2-59><a class=lnlinks href=#hl-2-59>59</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># FastAPI에서 오류 모니터링 예시</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span><span class=p>,</span> <span class=n>Request</span><span class=p>,</span> <span class=n>status</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi.responses</span> <span class=kn>import</span> <span class=n>JSONResponse</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi.exceptions</span> <span class=kn>import</span> <span class=n>RequestValidationError</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>defaultdict</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>error_counts</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>error_logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s2>&#34;api_errors&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.exception_handler</span><span class=p>(</span><span class=n>RequestValidationError</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>validation_exception_handler</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>exc</span><span class=p>:</span> <span class=n>RequestValidationError</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>error_type</span> <span class=o>=</span> <span class=s2>&#34;validation_error&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>error_counts</span><span class=p>[</span><span class=n>error_type</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>error_logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;Validation error: endpoint=</span><span class=si>{</span><span class=n>request</span><span class=o>.</span><span class=n>url</span><span class=o>.</span><span class=n>path</span><span class=si>}</span><span class=s2>, client_ip=</span><span class=si>{</span><span class=n>request</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>host</span><span class=si>}</span><span class=s2>, &#34;</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;error_detail=</span><span class=si>{</span><span class=n>exc</span><span class=o>.</span><span class=n>errors</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>JSONResponse</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>status_code</span><span class=o>=</span><span class=n>status</span><span class=o>.</span><span class=n>HTTP_422_UNPROCESSABLE_ENTITY</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>content</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;detail&#34;</span><span class=p>:</span> <span class=n>exc</span><span class=o>.</span><span class=n>errors</span><span class=p>()}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.exception_handler</span><span class=p>(</span><span class=ne>Exception</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>general_exception_handler</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>exc</span><span class=p>:</span> <span class=ne>Exception</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>error_type</span> <span class=o>=</span> <span class=nb>type</span><span class=p>(</span><span class=n>exc</span><span class=p>)</span><span class=o>.</span><span class=vm>__name__</span>
</span></span><span class=line><span class=cl>    <span class=n>error_counts</span><span class=p>[</span><span class=n>error_type</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>error_logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;Unhandled exception: endpoint=</span><span class=si>{</span><span class=n>request</span><span class=o>.</span><span class=n>url</span><span class=o>.</span><span class=n>path</span><span class=si>}</span><span class=s2>, client_ip=</span><span class=si>{</span><span class=n>request</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>host</span><span class=si>}</span><span class=s2>, &#34;</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;error_type=</span><span class=si>{</span><span class=n>error_type</span><span class=si>}</span><span class=s2>, error_message=</span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>exc</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>JSONResponse</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>status_code</span><span class=o>=</span><span class=n>status</span><span class=o>.</span><span class=n>HTTP_500_INTERNAL_SERVER_ERROR</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>content</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;detail&#34;</span><span class=p>:</span> <span class=s2>&#34;Internal server error&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 정기적으로 오류 통계 보고</span>
</span></span><span class=line><span class=cl><span class=nd>@app.on_event</span><span class=p>(</span><span class=s2>&#34;startup&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>start_error_reporting</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>report_errors</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>300</span><span class=p>)</span>  <span class=c1># 5분마다 보고</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>error_counts</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>error_logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error summary (last 5 minutes): </span><span class=si>{</span><span class=nb>dict</span><span class=p>(</span><span class=n>error_counts</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=c1># 메트릭 시스템에 데이터 전송</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>error_type</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>error_counts</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                    <span class=n>send_metric</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;api.error.</span><span class=si>{</span><span class=n>error_type</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>count</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 카운터 초기화</span>
</span></span><span class=line><span class=cl>                <span class=n>error_counts</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>asyncio</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span><span class=n>report_errors</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=리소스-사용-지표>리소스 사용 지표<a hidden class=anchor aria-hidden=true href=#리소스-사용-지표>#</a></h4><ul><li><strong>CPU 사용률</strong>: API 서버의 CPU 사용 수준</li><li><strong>메모리 사용량</strong>: 사용 중인 메모리 양과 패턴</li><li><strong>디스크 I/O</strong>: 디스크 읽기/쓰기 작업의 양과 지연 시간</li><li><strong>네트워크 사용량</strong>: 입출력 네트워크 트래픽 양</li></ul><h4 id=비즈니스-지표>비즈니스 지표<a hidden class=anchor aria-hidden=true href=#비즈니스-지표>#</a></h4><ul><li><strong>API 호출 볼륨</strong>: 시간대별, 엔드포인트별 호출 수</li><li><strong>사용자별 API 사용량</strong>: 개별 사용자 또는 클라이언트별 사용 패턴</li><li><strong>비즈니스 트랜잭션 성공률</strong>: 비즈니스 관점에서의 성공적인 트랜잭션 비율</li><li><strong>수익 관련 지표</strong>: API 사용과 직접 연관된 수익 지표</li></ul><h3 id=api-모니터링-구현-방법>API 모니터링 구현 방법<a hidden class=anchor aria-hidden=true href=#api-모니터링-구현-방법>#</a></h3><h4 id=합성-모니터링synthetic-monitoring>합성 모니터링(Synthetic Monitoring)<a hidden class=anchor aria-hidden=true href=#합성-모니터링synthetic-monitoring>#</a></h4><p>합성 모니터링은 사전 정의된 시나리오를 주기적으로 실행하여 API의 가용성과 성능을 검증하는 방법이다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16>16</a>
</span><span class=lnt id=hl-3-17><a class=lnlinks href=#hl-3-17>17</a>
</span><span class=lnt id=hl-3-18><a class=lnlinks href=#hl-3-18>18</a>
</span><span class=lnt id=hl-3-19><a class=lnlinks href=#hl-3-19>19</a>
</span><span class=lnt id=hl-3-20><a class=lnlinks href=#hl-3-20>20</a>
</span><span class=lnt id=hl-3-21><a class=lnlinks href=#hl-3-21>21</a>
</span><span class=lnt id=hl-3-22><a class=lnlinks href=#hl-3-22>22</a>
</span><span class=lnt id=hl-3-23><a class=lnlinks href=#hl-3-23>23</a>
</span><span class=lnt id=hl-3-24><a class=lnlinks href=#hl-3-24>24</a>
</span><span class=lnt id=hl-3-25><a class=lnlinks href=#hl-3-25>25</a>
</span><span class=lnt id=hl-3-26><a class=lnlinks href=#hl-3-26>26</a>
</span><span class=lnt id=hl-3-27><a class=lnlinks href=#hl-3-27>27</a>
</span><span class=lnt id=hl-3-28><a class=lnlinks href=#hl-3-28>28</a>
</span><span class=lnt id=hl-3-29><a class=lnlinks href=#hl-3-29>29</a>
</span><span class=lnt id=hl-3-30><a class=lnlinks href=#hl-3-30>30</a>
</span><span class=lnt id=hl-3-31><a class=lnlinks href=#hl-3-31>31</a>
</span><span class=lnt id=hl-3-32><a class=lnlinks href=#hl-3-32>32</a>
</span><span class=lnt id=hl-3-33><a class=lnlinks href=#hl-3-33>33</a>
</span><span class=lnt id=hl-3-34><a class=lnlinks href=#hl-3-34>34</a>
</span><span class=lnt id=hl-3-35><a class=lnlinks href=#hl-3-35>35</a>
</span><span class=lnt id=hl-3-36><a class=lnlinks href=#hl-3-36>36</a>
</span><span class=lnt id=hl-3-37><a class=lnlinks href=#hl-3-37>37</a>
</span><span class=lnt id=hl-3-38><a class=lnlinks href=#hl-3-38>38</a>
</span><span class=lnt id=hl-3-39><a class=lnlinks href=#hl-3-39>39</a>
</span><span class=lnt id=hl-3-40><a class=lnlinks href=#hl-3-40>40</a>
</span><span class=lnt id=hl-3-41><a class=lnlinks href=#hl-3-41>41</a>
</span><span class=lnt id=hl-3-42><a class=lnlinks href=#hl-3-42>42</a>
</span><span class=lnt id=hl-3-43><a class=lnlinks href=#hl-3-43>43</a>
</span><span class=lnt id=hl-3-44><a class=lnlinks href=#hl-3-44>44</a>
</span><span class=lnt id=hl-3-45><a class=lnlinks href=#hl-3-45>45</a>
</span><span class=lnt id=hl-3-46><a class=lnlinks href=#hl-3-46>46</a>
</span><span class=lnt id=hl-3-47><a class=lnlinks href=#hl-3-47>47</a>
</span><span class=lnt id=hl-3-48><a class=lnlinks href=#hl-3-48>48</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Puppeteer를 사용한 합성 모니터링 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>puppeteer</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;puppeteer&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>axios</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;axios&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>runSyntheticTest</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>startTime</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>success</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>responseTime</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>errorMessage</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// API 호출 시뮬레이션
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;https://api.example.com/health&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>timeout</span><span class=o>:</span> <span class=mi>5000</span>  <span class=c1>// 5초 타임아웃
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>responseTime</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>-</span> <span class=nx>startTime</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>success</span> <span class=o>=</span> <span class=nx>response</span><span class=p>.</span><span class=nx>status</span> <span class=o>===</span> <span class=mi>200</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// JWT 인증이 필요한 API 흐름 검증
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>getAuthToken</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>userResponse</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;https://api.example.com/users/me&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span> <span class=s1>&#39;Authorization&#39;</span><span class=o>:</span> <span class=sb>`Bearer </span><span class=si>${</span><span class=nx>token</span><span class=si>}</span><span class=sb>`</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 응답 데이터 유효성 검사
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>userResponse</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>id</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;User data is invalid&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>success</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>errorMessage</span> <span class=o>=</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>responseTime</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>-</span> <span class=nx>startTime</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 결과 보고
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>reportTestResult</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>testName</span><span class=o>:</span> <span class=s1>&#39;API Health Check&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>success</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>responseTime</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>errorMessage</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>timestamp</span><span class=o>:</span> <span class=k>new</span> <span class=nb>Date</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 스케줄링: 5분마다 테스트 실행
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>setInterval</span><span class=p>(</span><span class=nx>runSyntheticTest</span><span class=p>,</span> <span class=mi>5</span> <span class=o>*</span> <span class=mi>60</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>합성 모니터링의 주요 장점:</p><ul><li>사용자 흐름을 종단간(end-to-end) 테스트할 수 있음</li><li>실제 사용자가 없더라도 모니터링 가능</li><li>예정된 중단 시간 동안 비활성화 가능</li></ul><h4 id=실제-사용자-모니터링real-user-monitoring-rum>실제 사용자 모니터링(Real User Monitoring, RUM)<a hidden class=anchor aria-hidden=true href=#실제-사용자-모니터링real-user-monitoring-rum>#</a></h4><p>실제 사용자의 API 상호작용을 모니터링하여 실제 환경에서의 성능과 사용자 경험을 측정한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span><span class=lnt id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a>
</span><span class=lnt id=hl-4-19><a class=lnlinks href=#hl-4-19>19</a>
</span><span class=lnt id=hl-4-20><a class=lnlinks href=#hl-4-20>20</a>
</span><span class=lnt id=hl-4-21><a class=lnlinks href=#hl-4-21>21</a>
</span><span class=lnt id=hl-4-22><a class=lnlinks href=#hl-4-22>22</a>
</span><span class=lnt id=hl-4-23><a class=lnlinks href=#hl-4-23>23</a>
</span><span class=lnt id=hl-4-24><a class=lnlinks href=#hl-4-24>24</a>
</span><span class=lnt id=hl-4-25><a class=lnlinks href=#hl-4-25>25</a>
</span><span class=lnt id=hl-4-26><a class=lnlinks href=#hl-4-26>26</a>
</span><span class=lnt id=hl-4-27><a class=lnlinks href=#hl-4-27>27</a>
</span><span class=lnt id=hl-4-28><a class=lnlinks href=#hl-4-28>28</a>
</span><span class=lnt id=hl-4-29><a class=lnlinks href=#hl-4-29>29</a>
</span><span class=lnt id=hl-4-30><a class=lnlinks href=#hl-4-30>30</a>
</span><span class=lnt id=hl-4-31><a class=lnlinks href=#hl-4-31>31</a>
</span><span class=lnt id=hl-4-32><a class=lnlinks href=#hl-4-32>32</a>
</span><span class=lnt id=hl-4-33><a class=lnlinks href=#hl-4-33>33</a>
</span><span class=lnt id=hl-4-34><a class=lnlinks href=#hl-4-34>34</a>
</span><span class=lnt id=hl-4-35><a class=lnlinks href=#hl-4-35>35</a>
</span><span class=lnt id=hl-4-36><a class=lnlinks href=#hl-4-36>36</a>
</span><span class=lnt id=hl-4-37><a class=lnlinks href=#hl-4-37>37</a>
</span><span class=lnt id=hl-4-38><a class=lnlinks href=#hl-4-38>38</a>
</span><span class=lnt id=hl-4-39><a class=lnlinks href=#hl-4-39>39</a>
</span><span class=lnt id=hl-4-40><a class=lnlinks href=#hl-4-40>40</a>
</span><span class=lnt id=hl-4-41><a class=lnlinks href=#hl-4-41>41</a>
</span><span class=lnt id=hl-4-42><a class=lnlinks href=#hl-4-42>42</a>
</span><span class=lnt id=hl-4-43><a class=lnlinks href=#hl-4-43>43</a>
</span><span class=lnt id=hl-4-44><a class=lnlinks href=#hl-4-44>44</a>
</span><span class=lnt id=hl-4-45><a class=lnlinks href=#hl-4-45>45</a>
</span><span class=lnt id=hl-4-46><a class=lnlinks href=#hl-4-46>46</a>
</span><span class=lnt id=hl-4-47><a class=lnlinks href=#hl-4-47>47</a>
</span><span class=lnt id=hl-4-48><a class=lnlinks href=#hl-4-48>48</a>
</span><span class=lnt id=hl-4-49><a class=lnlinks href=#hl-4-49>49</a>
</span><span class=lnt id=hl-4-50><a class=lnlinks href=#hl-4-50>50</a>
</span><span class=lnt id=hl-4-51><a class=lnlinks href=#hl-4-51>51</a>
</span><span class=lnt id=hl-4-52><a class=lnlinks href=#hl-4-52>52</a>
</span><span class=lnt id=hl-4-53><a class=lnlinks href=#hl-4-53>53</a>
</span><span class=lnt id=hl-4-54><a class=lnlinks href=#hl-4-54>54</a>
</span><span class=lnt id=hl-4-55><a class=lnlinks href=#hl-4-55>55</a>
</span><span class=lnt id=hl-4-56><a class=lnlinks href=#hl-4-56>56</a>
</span><span class=lnt id=hl-4-57><a class=lnlinks href=#hl-4-57>57</a>
</span><span class=lnt id=hl-4-58><a class=lnlinks href=#hl-4-58>58</a>
</span><span class=lnt id=hl-4-59><a class=lnlinks href=#hl-4-59>59</a>
</span><span class=lnt id=hl-4-60><a class=lnlinks href=#hl-4-60>60</a>
</span><span class=lnt id=hl-4-61><a class=lnlinks href=#hl-4-61>61</a>
</span><span class=lnt id=hl-4-62><a class=lnlinks href=#hl-4-62>62</a>
</span><span class=lnt id=hl-4-63><a class=lnlinks href=#hl-4-63>63</a>
</span><span class=lnt id=hl-4-64><a class=lnlinks href=#hl-4-64>64</a>
</span><span class=lnt id=hl-4-65><a class=lnlinks href=#hl-4-65>65</a>
</span><span class=lnt id=hl-4-66><a class=lnlinks href=#hl-4-66>66</a>
</span><span class=lnt id=hl-4-67><a class=lnlinks href=#hl-4-67>67</a>
</span><span class=lnt id=hl-4-68><a class=lnlinks href=#hl-4-68>68</a>
</span><span class=lnt id=hl-4-69><a class=lnlinks href=#hl-4-69>69</a>
</span><span class=lnt id=hl-4-70><a class=lnlinks href=#hl-4-70>70</a>
</span><span class=lnt id=hl-4-71><a class=lnlinks href=#hl-4-71>71</a>
</span><span class=lnt id=hl-4-72><a class=lnlinks href=#hl-4-72>72</a>
</span><span class=lnt id=hl-4-73><a class=lnlinks href=#hl-4-73>73</a>
</span><span class=lnt id=hl-4-74><a class=lnlinks href=#hl-4-74>74</a>
</span><span class=lnt id=hl-4-75><a class=lnlinks href=#hl-4-75>75</a>
</span><span class=lnt id=hl-4-76><a class=lnlinks href=#hl-4-76>76</a>
</span><span class=lnt id=hl-4-77><a class=lnlinks href=#hl-4-77>77</a>
</span><span class=lnt id=hl-4-78><a class=lnlinks href=#hl-4-78>78</a>
</span><span class=lnt id=hl-4-79><a class=lnlinks href=#hl-4-79>79</a>
</span><span class=lnt id=hl-4-80><a class=lnlinks href=#hl-4-80>80</a>
</span><span class=lnt id=hl-4-81><a class=lnlinks href=#hl-4-81>81</a>
</span><span class=lnt id=hl-4-82><a class=lnlinks href=#hl-4-82>82</a>
</span><span class=lnt id=hl-4-83><a class=lnlinks href=#hl-4-83>83</a>
</span><span class=lnt id=hl-4-84><a class=lnlinks href=#hl-4-84>84</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 클라이언트 측 RUM 구현 예시 (브라우저)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>class</span> <span class=nx>APIMonitor</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>metrics</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>calls</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>errors</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>totalResponseTime</span><span class=o>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>initialize</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>initialize</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 원본 fetch 메서드를 가로채기
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>originalFetch</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>fetch</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>window</span><span class=p>.</span><span class=nx>fetch</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>url</span><span class=p>,</span> <span class=nx>options</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// API 호출만 모니터링 (자체 도메인의 /api 경로)
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>if</span> <span class=p>(</span><span class=nx>url</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=s1>&#39;/api&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>start</span> <span class=o>=</span> <span class=nx>performance</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=kd>let</span> <span class=nx>error</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>originalFetch</span><span class=p>(</span><span class=nx>url</span><span class=p>,</span> <span class=nx>options</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>response</span><span class=p>.</span><span class=nx>ok</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>error</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>          
</span></span><span class=line><span class=cl>          <span class=kr>const</span> <span class=nx>end</span> <span class=o>=</span> <span class=nx>performance</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>          <span class=k>this</span><span class=p>.</span><span class=nx>recordMetrics</span><span class=p>(</span><span class=nx>url</span><span class=p>,</span> <span class=nx>end</span> <span class=o>-</span> <span class=nx>start</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          
</span></span><span class=line><span class=cl>          <span class=k>return</span> <span class=nx>response</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=kr>const</span> <span class=nx>end</span> <span class=o>=</span> <span class=nx>performance</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>          <span class=k>this</span><span class=p>.</span><span class=nx>recordMetrics</span><span class=p>(</span><span class=nx>url</span><span class=p>,</span> <span class=nx>end</span> <span class=o>-</span> <span class=nx>start</span><span class=p>,</span> <span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=k>throw</span> <span class=nx>err</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// API가 아닌 경우 원본 fetch 실행
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=nx>originalFetch</span><span class=p>(</span><span class=nx>url</span><span class=p>,</span> <span class=nx>options</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 주기적으로 메트릭 전송
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>setInterval</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=k>this</span><span class=p>.</span><span class=nx>sendMetrics</span><span class=p>(),</span> <span class=mi>60000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>recordMetrics</span><span class=p>(</span><span class=nx>url</span><span class=p>,</span> <span class=nx>responseTime</span><span class=p>,</span> <span class=nx>isError</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>metrics</span><span class=p>.</span><span class=nx>calls</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>metrics</span><span class=p>.</span><span class=nx>totalResponseTime</span> <span class=o>+=</span> <span class=nx>responseTime</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>isError</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>metrics</span><span class=p>.</span><span class=nx>errors</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 개별 엔드포인트별 메트릭 기록도 가능
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>sendMetrics</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>metrics</span><span class=p>.</span><span class=nx>calls</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>avgResponseTime</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>metrics</span><span class=p>.</span><span class=nx>totalResponseTime</span> <span class=o>/</span> <span class=k>this</span><span class=p>.</span><span class=nx>metrics</span><span class=p>.</span><span class=nx>calls</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>errorRate</span> <span class=o>=</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>metrics</span><span class=p>.</span><span class=nx>errors</span> <span class=o>/</span> <span class=k>this</span><span class=p>.</span><span class=nx>metrics</span><span class=p>.</span><span class=nx>calls</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 백엔드 애널리틱스 시스템으로 메트릭 전송
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>navigator</span><span class=p>.</span><span class=nx>sendBeacon</span><span class=p>(</span><span class=s1>&#39;/analytics/api-metrics&#39;</span><span class=p>,</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>calls</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>metrics</span><span class=p>.</span><span class=nx>calls</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>avgResponseTime</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>errorRate</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>userAgent</span><span class=o>:</span> <span class=nx>navigator</span><span class=p>.</span><span class=nx>userAgent</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>timestamp</span><span class=o>:</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=p>}));</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 메트릭 초기화
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>this</span><span class=p>.</span><span class=nx>metrics</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>calls</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>errors</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>totalResponseTime</span><span class=o>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>      <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 모니터링 시작
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>apiMonitor</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>APIMonitor</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p>RUM의 주요 장점:</p><ul><li>실제 사용자 경험을 직접 측정</li><li>지역, 디바이스, 브라우저별 성능 차이 식별 가능</li><li>실제 사용 패턴을 기반으로 한 통찰력 제공</li></ul><h4 id=로그-기반-모니터링>로그 기반 모니터링<a hidden class=anchor aria-hidden=true href=#로그-기반-모니터링>#</a></h4><p>API 로그를 수집, 분석하여 성능과 오류 패턴을 파악한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16>16</a>
</span><span class=lnt id=hl-5-17><a class=lnlinks href=#hl-5-17>17</a>
</span><span class=lnt id=hl-5-18><a class=lnlinks href=#hl-5-18>18</a>
</span><span class=lnt id=hl-5-19><a class=lnlinks href=#hl-5-19>19</a>
</span><span class=lnt id=hl-5-20><a class=lnlinks href=#hl-5-20>20</a>
</span><span class=lnt id=hl-5-21><a class=lnlinks href=#hl-5-21>21</a>
</span><span class=lnt id=hl-5-22><a class=lnlinks href=#hl-5-22>22</a>
</span><span class=lnt id=hl-5-23><a class=lnlinks href=#hl-5-23>23</a>
</span><span class=lnt id=hl-5-24><a class=lnlinks href=#hl-5-24>24</a>
</span><span class=lnt id=hl-5-25><a class=lnlinks href=#hl-5-25>25</a>
</span><span class=lnt id=hl-5-26><a class=lnlinks href=#hl-5-26>26</a>
</span><span class=lnt id=hl-5-27><a class=lnlinks href=#hl-5-27>27</a>
</span><span class=lnt id=hl-5-28><a class=lnlinks href=#hl-5-28>28</a>
</span><span class=lnt id=hl-5-29><a class=lnlinks href=#hl-5-29>29</a>
</span><span class=lnt id=hl-5-30><a class=lnlinks href=#hl-5-30>30</a>
</span><span class=lnt id=hl-5-31><a class=lnlinks href=#hl-5-31>31</a>
</span><span class=lnt id=hl-5-32><a class=lnlinks href=#hl-5-32>32</a>
</span><span class=lnt id=hl-5-33><a class=lnlinks href=#hl-5-33>33</a>
</span><span class=lnt id=hl-5-34><a class=lnlinks href=#hl-5-34>34</a>
</span><span class=lnt id=hl-5-35><a class=lnlinks href=#hl-5-35>35</a>
</span><span class=lnt id=hl-5-36><a class=lnlinks href=#hl-5-36>36</a>
</span><span class=lnt id=hl-5-37><a class=lnlinks href=#hl-5-37>37</a>
</span><span class=lnt id=hl-5-38><a class=lnlinks href=#hl-5-38>38</a>
</span><span class=lnt id=hl-5-39><a class=lnlinks href=#hl-5-39>39</a>
</span><span class=lnt id=hl-5-40><a class=lnlinks href=#hl-5-40>40</a>
</span><span class=lnt id=hl-5-41><a class=lnlinks href=#hl-5-41>41</a>
</span><span class=lnt id=hl-5-42><a class=lnlinks href=#hl-5-42>42</a>
</span><span class=lnt id=hl-5-43><a class=lnlinks href=#hl-5-43>43</a>
</span><span class=lnt id=hl-5-44><a class=lnlinks href=#hl-5-44>44</a>
</span><span class=lnt id=hl-5-45><a class=lnlinks href=#hl-5-45>45</a>
</span><span class=lnt id=hl-5-46><a class=lnlinks href=#hl-5-46>46</a>
</span><span class=lnt id=hl-5-47><a class=lnlinks href=#hl-5-47>47</a>
</span><span class=lnt id=hl-5-48><a class=lnlinks href=#hl-5-48>48</a>
</span><span class=lnt id=hl-5-49><a class=lnlinks href=#hl-5-49>49</a>
</span><span class=lnt id=hl-5-50><a class=lnlinks href=#hl-5-50>50</a>
</span><span class=lnt id=hl-5-51><a class=lnlinks href=#hl-5-51>51</a>
</span><span class=lnt id=hl-5-52><a class=lnlinks href=#hl-5-52>52</a>
</span><span class=lnt id=hl-5-53><a class=lnlinks href=#hl-5-53>53</a>
</span><span class=lnt id=hl-5-54><a class=lnlinks href=#hl-5-54>54</a>
</span><span class=lnt id=hl-5-55><a class=lnlinks href=#hl-5-55>55</a>
</span><span class=lnt id=hl-5-56><a class=lnlinks href=#hl-5-56>56</a>
</span><span class=lnt id=hl-5-57><a class=lnlinks href=#hl-5-57>57</a>
</span><span class=lnt id=hl-5-58><a class=lnlinks href=#hl-5-58>58</a>
</span><span class=lnt id=hl-5-59><a class=lnlinks href=#hl-5-59>59</a>
</span><span class=lnt id=hl-5-60><a class=lnlinks href=#hl-5-60>60</a>
</span><span class=lnt id=hl-5-61><a class=lnlinks href=#hl-5-61>61</a>
</span><span class=lnt id=hl-5-62><a class=lnlinks href=#hl-5-62>62</a>
</span><span class=lnt id=hl-5-63><a class=lnlinks href=#hl-5-63>63</a>
</span><span class=lnt id=hl-5-64><a class=lnlinks href=#hl-5-64>64</a>
</span><span class=lnt id=hl-5-65><a class=lnlinks href=#hl-5-65>65</a>
</span><span class=lnt id=hl-5-66><a class=lnlinks href=#hl-5-66>66</a>
</span><span class=lnt id=hl-5-67><a class=lnlinks href=#hl-5-67>67</a>
</span><span class=lnt id=hl-5-68><a class=lnlinks href=#hl-5-68>68</a>
</span><span class=lnt id=hl-5-69><a class=lnlinks href=#hl-5-69>69</a>
</span><span class=lnt id=hl-5-70><a class=lnlinks href=#hl-5-70>70</a>
</span><span class=lnt id=hl-5-71><a class=lnlinks href=#hl-5-71>71</a>
</span><span class=lnt id=hl-5-72><a class=lnlinks href=#hl-5-72>72</a>
</span><span class=lnt id=hl-5-73><a class=lnlinks href=#hl-5-73>73</a>
</span><span class=lnt id=hl-5-74><a class=lnlinks href=#hl-5-74>74</a>
</span><span class=lnt id=hl-5-75><a class=lnlinks href=#hl-5-75>75</a>
</span><span class=lnt id=hl-5-76><a class=lnlinks href=#hl-5-76>76</a>
</span><span class=lnt id=hl-5-77><a class=lnlinks href=#hl-5-77>77</a>
</span><span class=lnt id=hl-5-78><a class=lnlinks href=#hl-5-78>78</a>
</span><span class=lnt id=hl-5-79><a class=lnlinks href=#hl-5-79>79</a>
</span><span class=lnt id=hl-5-80><a class=lnlinks href=#hl-5-80>80</a>
</span><span class=lnt id=hl-5-81><a class=lnlinks href=#hl-5-81>81</a>
</span><span class=lnt id=hl-5-82><a class=lnlinks href=#hl-5-82>82</a>
</span><span class=lnt id=hl-5-83><a class=lnlinks href=#hl-5-83>83</a>
</span><span class=lnt id=hl-5-84><a class=lnlinks href=#hl-5-84>84</a>
</span><span class=lnt id=hl-5-85><a class=lnlinks href=#hl-5-85>85</a>
</span><span class=lnt id=hl-5-86><a class=lnlinks href=#hl-5-86>86</a>
</span><span class=lnt id=hl-5-87><a class=lnlinks href=#hl-5-87>87</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python/Flask에서의 구조화된 로깅 예시</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>uuid</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>g</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># JSON 형식 로거 설정</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>JSONFormatter</span><span class=p>(</span><span class=n>logging</span><span class=o>.</span><span class=n>Formatter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>format</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>record</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>log_record</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;timestamp&#34;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>formatTime</span><span class=p>(</span><span class=n>record</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>datefmt</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;level&#34;</span><span class=p>:</span> <span class=n>record</span><span class=o>.</span><span class=n>levelname</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;message&#34;</span><span class=p>:</span> <span class=n>record</span><span class=o>.</span><span class=n>getMessage</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;logger&#34;</span><span class=p>:</span> <span class=n>record</span><span class=o>.</span><span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 추가 컨텍스트 정보가 있으면 포함</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>record</span><span class=p>,</span> <span class=s1>&#39;request_id&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>log_record</span><span class=p>[</span><span class=s2>&#34;request_id&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>record</span><span class=o>.</span><span class=n>request_id</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>record</span><span class=p>,</span> <span class=s1>&#39;path&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>log_record</span><span class=p>[</span><span class=s2>&#34;path&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>record</span><span class=o>.</span><span class=n>path</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>record</span><span class=p>,</span> <span class=s1>&#39;method&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>log_record</span><span class=p>[</span><span class=s2>&#34;method&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>record</span><span class=o>.</span><span class=n>method</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>record</span><span class=p>,</span> <span class=s1>&#39;duration_ms&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>log_record</span><span class=p>[</span><span class=s2>&#34;duration_ms&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>record</span><span class=o>.</span><span class=n>duration_ms</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>record</span><span class=p>,</span> <span class=s1>&#39;status_code&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>log_record</span><span class=p>[</span><span class=s2>&#34;status_code&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>record</span><span class=o>.</span><span class=n>status_code</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>record</span><span class=p>,</span> <span class=s1>&#39;user_id&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>log_record</span><span class=p>[</span><span class=s2>&#34;user_id&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>record</span><span class=o>.</span><span class=n>user_id</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>log_record</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 로거 설정</span>
</span></span><span class=line><span class=cl><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s2>&#34;api&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>handler</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>StreamHandler</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>handler</span><span class=o>.</span><span class=n>setFormatter</span><span class=p>(</span><span class=n>JSONFormatter</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>logger</span><span class=o>.</span><span class=n>addHandler</span><span class=p>(</span><span class=n>handler</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 요청/응답 로깅 미들웨어</span>
</span></span><span class=line><span class=cl><span class=nd>@app.before_request</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>before_request</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>g</span><span class=o>.</span><span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>g</span><span class=o>.</span><span class=n>request_id</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.after_request</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>after_request</span><span class=p>(</span><span class=n>response</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>duration</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>g</span><span class=o>.</span><span class=n>start_time</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 구조화된 로그 레코드 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;API Request Completed&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>extra</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;request_id&#34;</span><span class=p>:</span> <span class=n>g</span><span class=o>.</span><span class=n>request_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;method&#34;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;path&#34;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>path</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;status_code&#34;</span><span class=p>:</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;duration_ms&#34;</span><span class=p>:</span> <span class=nb>round</span><span class=p>(</span><span class=n>duration</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;user_id&#34;</span><span class=p>:</span> <span class=n>g</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user_id&#39;</span><span class=p>,</span> <span class=s1>&#39;anonymous&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>response</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 오류 로깅</span>
</span></span><span class=line><span class=cl><span class=nd>@app.errorhandler</span><span class=p>(</span><span class=ne>Exception</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>handle_exception</span><span class=p>(</span><span class=n>e</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>f</span><span class=s2>&#34;API Error: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>extra</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;request_id&#34;</span><span class=p>:</span> <span class=n>g</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;request_id&#39;</span><span class=p>,</span> <span class=s1>&#39;unknown&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;method&#34;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;path&#34;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>path</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;error_type&#34;</span><span class=p>:</span> <span class=nb>type</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=o>.</span><span class=vm>__name__</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=n>exc_info</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;Internal Server Error&#34;</span><span class=p>},</span> <span class=mi>500</span>
</span></span></code></pre></td></tr></table></div></div><p>로그 기반 모니터링의 주요 장점:</p><ul><li>오류의 상세한 컨텍스트 제공</li><li>디버깅을 위한 풍부한 정보 제공</li><li>과거 문제 분석 및 트렌드 파악 가능</li></ul><h4 id=메트릭-기반-모니터링>메트릭 기반 모니터링<a hidden class=anchor aria-hidden=true href=#메트릭-기반-모니터링>#</a></h4><p>API의 성능과 동작에 관한 측정 가능한 수치 데이터를 수집하고 분석한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14>14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15>15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16>16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17>17</a>
</span><span class=lnt id=hl-6-18><a class=lnlinks href=#hl-6-18>18</a>
</span><span class=lnt id=hl-6-19><a class=lnlinks href=#hl-6-19>19</a>
</span><span class=lnt id=hl-6-20><a class=lnlinks href=#hl-6-20>20</a>
</span><span class=lnt id=hl-6-21><a class=lnlinks href=#hl-6-21>21</a>
</span><span class=lnt id=hl-6-22><a class=lnlinks href=#hl-6-22>22</a>
</span><span class=lnt id=hl-6-23><a class=lnlinks href=#hl-6-23>23</a>
</span><span class=lnt id=hl-6-24><a class=lnlinks href=#hl-6-24>24</a>
</span><span class=lnt id=hl-6-25><a class=lnlinks href=#hl-6-25>25</a>
</span><span class=lnt id=hl-6-26><a class=lnlinks href=#hl-6-26>26</a>
</span><span class=lnt id=hl-6-27><a class=lnlinks href=#hl-6-27>27</a>
</span><span class=lnt id=hl-6-28><a class=lnlinks href=#hl-6-28>28</a>
</span><span class=lnt id=hl-6-29><a class=lnlinks href=#hl-6-29>29</a>
</span><span class=lnt id=hl-6-30><a class=lnlinks href=#hl-6-30>30</a>
</span><span class=lnt id=hl-6-31><a class=lnlinks href=#hl-6-31>31</a>
</span><span class=lnt id=hl-6-32><a class=lnlinks href=#hl-6-32>32</a>
</span><span class=lnt id=hl-6-33><a class=lnlinks href=#hl-6-33>33</a>
</span><span class=lnt id=hl-6-34><a class=lnlinks href=#hl-6-34>34</a>
</span><span class=lnt id=hl-6-35><a class=lnlinks href=#hl-6-35>35</a>
</span><span class=lnt id=hl-6-36><a class=lnlinks href=#hl-6-36>36</a>
</span><span class=lnt id=hl-6-37><a class=lnlinks href=#hl-6-37>37</a>
</span><span class=lnt id=hl-6-38><a class=lnlinks href=#hl-6-38>38</a>
</span><span class=lnt id=hl-6-39><a class=lnlinks href=#hl-6-39>39</a>
</span><span class=lnt id=hl-6-40><a class=lnlinks href=#hl-6-40>40</a>
</span><span class=lnt id=hl-6-41><a class=lnlinks href=#hl-6-41>41</a>
</span><span class=lnt id=hl-6-42><a class=lnlinks href=#hl-6-42>42</a>
</span><span class=lnt id=hl-6-43><a class=lnlinks href=#hl-6-43>43</a>
</span><span class=lnt id=hl-6-44><a class=lnlinks href=#hl-6-44>44</a>
</span><span class=lnt id=hl-6-45><a class=lnlinks href=#hl-6-45>45</a>
</span><span class=lnt id=hl-6-46><a class=lnlinks href=#hl-6-46>46</a>
</span><span class=lnt id=hl-6-47><a class=lnlinks href=#hl-6-47>47</a>
</span><span class=lnt id=hl-6-48><a class=lnlinks href=#hl-6-48>48</a>
</span><span class=lnt id=hl-6-49><a class=lnlinks href=#hl-6-49>49</a>
</span><span class=lnt id=hl-6-50><a class=lnlinks href=#hl-6-50>50</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Prometheus 클라이언트를 사용한 메트릭 모니터링 예시</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>prometheus_client</span> <span class=kn>import</span> <span class=n>Counter</span><span class=p>,</span> <span class=n>Histogram</span><span class=p>,</span> <span class=n>start_http_server</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메트릭 정의</span>
</span></span><span class=line><span class=cl><span class=n>REQUEST_COUNT</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;api_requests_total&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;Total API Request Count&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=s1>&#39;method&#39;</span><span class=p>,</span> <span class=s1>&#39;endpoint&#39;</span><span class=p>,</span> <span class=s1>&#39;status&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>REQUEST_LATENCY</span> <span class=o>=</span> <span class=n>Histogram</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;api_request_latency_seconds&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;API Request Latency&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=s1>&#39;method&#39;</span><span class=p>,</span> <span class=s1>&#39;endpoint&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메트릭 수집 미들웨어</span>
</span></span><span class=line><span class=cl><span class=nd>@app.before_request</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>before_request</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=o>.</span><span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.after_request</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>after_request</span><span class=p>(</span><span class=n>response</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>request_latency</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>request</span><span class=o>.</span><span class=n>start_time</span>
</span></span><span class=line><span class=cl>    <span class=n>REQUEST_LATENCY</span><span class=o>.</span><span class=n>labels</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>method</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>method</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>endpoint</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>path</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span><span class=o>.</span><span class=n>observe</span><span class=p>(</span><span class=n>request_latency</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>REQUEST_COUNT</span><span class=o>.</span><span class=n>labels</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>method</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>method</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>endpoint</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>path</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>status</span><span class=o>=</span><span class=n>response</span><span class=o>.</span><span class=n>status_code</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span><span class=o>.</span><span class=n>inc</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>response</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Prometheus 메트릭 서버 시작</span>
</span></span><span class=line><span class=cl><span class=nd>@app.before_first_request</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>start_metrics_server</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>start_http_server</span><span class=p>(</span><span class=mi>8000</span><span class=p>)</span>  <span class=c1># 메트릭을 8000 포트에서 제공</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/user/&lt;user_id&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_user</span><span class=p>(</span><span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># API 로직...</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;user&#34;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span> <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Test User&#34;</span><span class=p>}}</span>
</span></span></code></pre></td></tr></table></div></div><p>메트릭 기반 모니터링의 주요 장점:</p><ul><li>실시간 성능 통찰 제공</li><li>알림 및 자동화된 응답 가능</li><li>장기적인 성능 추세 분석 용이</li></ul><h4 id=분산-추적distributed-tracing>분산 추적(Distributed Tracing)<a hidden class=anchor aria-hidden=true href=#분산-추적distributed-tracing>#</a></h4><p>마이크로서비스 아키텍처에서 API 요청이 여러 서비스를 통과하는 경로를 추적한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span><span class=lnt id=hl-7-12><a class=lnlinks href=#hl-7-12>12</a>
</span><span class=lnt id=hl-7-13><a class=lnlinks href=#hl-7-13>13</a>
</span><span class=lnt id=hl-7-14><a class=lnlinks href=#hl-7-14>14</a>
</span><span class=lnt id=hl-7-15><a class=lnlinks href=#hl-7-15>15</a>
</span><span class=lnt id=hl-7-16><a class=lnlinks href=#hl-7-16>16</a>
</span><span class=lnt id=hl-7-17><a class=lnlinks href=#hl-7-17>17</a>
</span><span class=lnt id=hl-7-18><a class=lnlinks href=#hl-7-18>18</a>
</span><span class=lnt id=hl-7-19><a class=lnlinks href=#hl-7-19>19</a>
</span><span class=lnt id=hl-7-20><a class=lnlinks href=#hl-7-20>20</a>
</span><span class=lnt id=hl-7-21><a class=lnlinks href=#hl-7-21>21</a>
</span><span class=lnt id=hl-7-22><a class=lnlinks href=#hl-7-22>22</a>
</span><span class=lnt id=hl-7-23><a class=lnlinks href=#hl-7-23>23</a>
</span><span class=lnt id=hl-7-24><a class=lnlinks href=#hl-7-24>24</a>
</span><span class=lnt id=hl-7-25><a class=lnlinks href=#hl-7-25>25</a>
</span><span class=lnt id=hl-7-26><a class=lnlinks href=#hl-7-26>26</a>
</span><span class=lnt id=hl-7-27><a class=lnlinks href=#hl-7-27>27</a>
</span><span class=lnt id=hl-7-28><a class=lnlinks href=#hl-7-28>28</a>
</span><span class=lnt id=hl-7-29><a class=lnlinks href=#hl-7-29>29</a>
</span><span class=lnt id=hl-7-30><a class=lnlinks href=#hl-7-30>30</a>
</span><span class=lnt id=hl-7-31><a class=lnlinks href=#hl-7-31>31</a>
</span><span class=lnt id=hl-7-32><a class=lnlinks href=#hl-7-32>32</a>
</span><span class=lnt id=hl-7-33><a class=lnlinks href=#hl-7-33>33</a>
</span><span class=lnt id=hl-7-34><a class=lnlinks href=#hl-7-34>34</a>
</span><span class=lnt id=hl-7-35><a class=lnlinks href=#hl-7-35>35</a>
</span><span class=lnt id=hl-7-36><a class=lnlinks href=#hl-7-36>36</a>
</span><span class=lnt id=hl-7-37><a class=lnlinks href=#hl-7-37>37</a>
</span><span class=lnt id=hl-7-38><a class=lnlinks href=#hl-7-38>38</a>
</span><span class=lnt id=hl-7-39><a class=lnlinks href=#hl-7-39>39</a>
</span><span class=lnt id=hl-7-40><a class=lnlinks href=#hl-7-40>40</a>
</span><span class=lnt id=hl-7-41><a class=lnlinks href=#hl-7-41>41</a>
</span><span class=lnt id=hl-7-42><a class=lnlinks href=#hl-7-42>42</a>
</span><span class=lnt id=hl-7-43><a class=lnlinks href=#hl-7-43>43</a>
</span><span class=lnt id=hl-7-44><a class=lnlinks href=#hl-7-44>44</a>
</span><span class=lnt id=hl-7-45><a class=lnlinks href=#hl-7-45>45</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># OpenTelemetry를 사용한 분산 추적 예시</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry</span> <span class=kn>import</span> <span class=n>trace</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.exporter.otlp.proto.grpc.trace_exporter</span> <span class=kn>import</span> <span class=n>OTLPSpanExporter</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.sdk.resources</span> <span class=kn>import</span> <span class=n>SERVICE_NAME</span><span class=p>,</span> <span class=n>Resource</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.sdk.trace</span> <span class=kn>import</span> <span class=n>TracerProvider</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.sdk.trace.export</span> <span class=kn>import</span> <span class=n>BatchSpanProcessor</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.instrumentation.flask</span> <span class=kn>import</span> <span class=n>FlaskInstrumentor</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.instrumentation.requests</span> <span class=kn>import</span> <span class=n>RequestsInstrumentor</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 트레이싱 설정</span>
</span></span><span class=line><span class=cl><span class=n>resource</span> <span class=o>=</span> <span class=n>Resource</span><span class=p>(</span><span class=n>attributes</span><span class=o>=</span><span class=p>{</span><span class=n>SERVICE_NAME</span><span class=p>:</span> <span class=s2>&#34;user-api&#34;</span><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=n>tracer_provider</span> <span class=o>=</span> <span class=n>TracerProvider</span><span class=p>(</span><span class=n>resource</span><span class=o>=</span><span class=n>resource</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>processor</span> <span class=o>=</span> <span class=n>BatchSpanProcessor</span><span class=p>(</span><span class=n>OTLPSpanExporter</span><span class=p>(</span><span class=n>endpoint</span><span class=o>=</span><span class=s2>&#34;localhost:4317&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>tracer_provider</span><span class=o>.</span><span class=n>add_span_processor</span><span class=p>(</span><span class=n>processor</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>trace</span><span class=o>.</span><span class=n>set_tracer_provider</span><span class=p>(</span><span class=n>tracer_provider</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tracer</span> <span class=o>=</span> <span class=n>trace</span><span class=o>.</span><span class=n>get_tracer</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>FlaskInstrumentor</span><span class=p>()</span><span class=o>.</span><span class=n>instrument_app</span><span class=p>(</span><span class=n>app</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>RequestsInstrumentor</span><span class=p>()</span><span class=o>.</span><span class=n>instrument</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/user-activity/&lt;user_id&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_user_activity</span><span class=p>(</span><span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>tracer</span><span class=o>.</span><span class=n>start_as_current_span</span><span class=p>(</span><span class=s2>&#34;get_user_details&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>span</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>span</span><span class=o>.</span><span class=n>set_attribute</span><span class=p>(</span><span class=s2>&#34;user.id&#34;</span><span class=p>,</span> <span class=n>user_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 사용자 세부 정보 가져오기</span>
</span></span><span class=line><span class=cl>        <span class=n>user_response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;http://user-service/users/</span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>user_data</span> <span class=o>=</span> <span class=n>user_response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=n>tracer</span><span class=o>.</span><span class=n>start_as_current_span</span><span class=p>(</span><span class=s2>&#34;get_activity_data&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>activity_span</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 사용자 활동 데이터 가져오기</span>
</span></span><span class=line><span class=cl>            <span class=n>activity_response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;http://activity-service/activities?user_id=</span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>activity_data</span> <span class=o>=</span> <span class=n>activity_response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>activity_span</span><span class=o>.</span><span class=n>set_attribute</span><span class=p>(</span><span class=s2>&#34;activity.count&#34;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>activity_data</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 응답 데이터 조합</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;user&#34;</span><span class=p>:</span> <span class=n>user_data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;recent_activities&#34;</span><span class=p>:</span> <span class=n>activity_data</span><span class=p>[:</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span>
</span></span></code></pre></td></tr></table></div></div><p>분산 추적의 주요 장점:</p><ul><li>전체 시스템에 걸친 요청 흐름 가시화</li><li>서비스 간 지연 시간 파악</li><li>시스템 병목 지점 정확히 식별</li></ul><h3 id=api-모니터링-도구-및-플랫폼>API 모니터링 도구 및 플랫폼<a hidden class=anchor aria-hidden=true href=#api-모니터링-도구-및-플랫폼>#</a></h3><h4 id=1-오픈소스-모니터링-도구>1. 오픈소스 모니터링 도구<a hidden class=anchor aria-hidden=true href=#1-오픈소스-모니터링-도구>#</a></h4><ol><li><strong>Prometheus + Grafana</strong>:<ul><li>메트릭 수집, 저장, 쿼리 및 시각화를 위한 강력한 조합</li><li>강력한 알림 및 쿼리 언어 제공</li><li>Kubernetes와의 원활한 통합</li></ul></li><li><strong>ELK 스택(Elasticsearch, Logstash, Kibana)</strong>:<ul><li>로그 수집, 저장, 검색 및 시각화를 위한 통합 솔루션</li><li>비정형 로그 데이터 분석에 적합</li><li>강력한 전문 검색 기능</li></ul></li><li><strong>Jaeger/Zipkin</strong>:<ul><li>분산 시스템을 위한 추적 도구</li><li>요청 흐름 시각화 및 병목 현상 식별</li><li>OpenTelemetry와 통합</li></ul></li></ol><h4 id=2-상용-모니터링-솔루션>2. 상용 모니터링 솔루션<a hidden class=anchor aria-hidden=true href=#2-상용-모니터링-솔루션>#</a></h4><ol><li><strong>Datadog</strong>:<ul><li>종합적인 모니터링 및 분석 플랫폼</li><li>API, 인프라, 로그, 사용자 경험을 통합적으로 모니터링</li><li>강력한 이상 탐지 및 알림 기능</li></ul></li><li><strong>New Relic</strong>:<ul><li>애플리케이션 성능 모니터링(APM) 중심의 플랫폼</li><li>상세한 트랜잭션 추적 및 성능 분석</li><li>실시간 대시보드 및 알림</li></ul></li><li><strong>Dynatrace</strong>:<ul><li>AI 기반 모니터링 및 관찰성 플랫폼</li><li>자동화된 문제 발견 및 근본 원인 분석</li><li>전체 스택 모니터링</li></ul></li></ol><h4 id=3-클라우드-제공업체-도구>3. 클라우드 제공업체 도구<a hidden class=anchor aria-hidden=true href=#3-클라우드-제공업체-도구>#</a></h4><ol><li><strong>AWS CloudWatch</strong>:<ul><li>AWS 서비스와 통합된 모니터링 솔루션</li><li>API Gateway, Lambda 등의 서비스 모니터링</li><li>사용자 지정 메트릭 및 알림 지원</li></ul></li><li><strong>Google Cloud Monitoring</strong>:<ul><li>Google Cloud 서비스 모니터링</li><li>API 성능 및 오류 추적</li><li>통합 대시보드 및 알림</li></ul></li><li><strong>Azure Monitor</strong>:<ul><li>Azure 서비스 모니터링</li><li>Application Insights를 통한 API 추적</li><li>종합적인 로그 분석</li></ul></li></ol><h3 id=api-모니터링-구현-모범-사례>API 모니터링 구현 모범 사례<a hidden class=anchor aria-hidden=true href=#api-모니터링-구현-모범-사례>#</a></h3><h4 id=다층적-모니터링-전략>다층적 모니터링 전략<a hidden class=anchor aria-hidden=true href=#다층적-모니터링-전략>#</a></h4><p>효과적인 API 모니터링은 여러 계층에서 접근해야 한다:</p><ol><li><strong>인프라 계층</strong>: 서버, 네트워크, 컨테이너 상태 모니터링</li><li><strong>애플리케이션 계층</strong>: API 서비스 자체의 성능과 동작 모니터링</li><li><strong>비즈니스 계층</strong>: 비즈니스 프로세스와 트랜잭션 성공률 모니터링</li><li><strong>사용자 경험 계층</strong>: 클라이언트 측에서의 API 상호작용 모니터링</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1> 1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2> 2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3> 3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4> 4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5> 5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6> 6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7> 7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8> 8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9> 9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10>10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11>11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12>12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13>13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14>14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15>15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16>16</a>
</span><span class=lnt id=hl-8-17><a class=lnlinks href=#hl-8-17>17</a>
</span><span class=lnt id=hl-8-18><a class=lnlinks href=#hl-8-18>18</a>
</span><span class=lnt id=hl-8-19><a class=lnlinks href=#hl-8-19>19</a>
</span><span class=lnt id=hl-8-20><a class=lnlinks href=#hl-8-20>20</a>
</span><span class=lnt id=hl-8-21><a class=lnlinks href=#hl-8-21>21</a>
</span><span class=lnt id=hl-8-22><a class=lnlinks href=#hl-8-22>22</a>
</span><span class=lnt id=hl-8-23><a class=lnlinks href=#hl-8-23>23</a>
</span><span class=lnt id=hl-8-24><a class=lnlinks href=#hl-8-24>24</a>
</span><span class=lnt id=hl-8-25><a class=lnlinks href=#hl-8-25>25</a>
</span><span class=lnt id=hl-8-26><a class=lnlinks href=#hl-8-26>26</a>
</span><span class=lnt id=hl-8-27><a class=lnlinks href=#hl-8-27>27</a>
</span><span class=lnt id=hl-8-28><a class=lnlinks href=#hl-8-28>28</a>
</span><span class=lnt id=hl-8-29><a class=lnlinks href=#hl-8-29>29</a>
</span><span class=lnt id=hl-8-30><a class=lnlinks href=#hl-8-30>30</a>
</span><span class=lnt id=hl-8-31><a class=lnlinks href=#hl-8-31>31</a>
</span><span class=lnt id=hl-8-32><a class=lnlinks href=#hl-8-32>32</a>
</span><span class=lnt id=hl-8-33><a class=lnlinks href=#hl-8-33>33</a>
</span><span class=lnt id=hl-8-34><a class=lnlinks href=#hl-8-34>34</a>
</span><span class=lnt id=hl-8-35><a class=lnlinks href=#hl-8-35>35</a>
</span><span class=lnt id=hl-8-36><a class=lnlinks href=#hl-8-36>36</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># Prometheus 알림 규칙 예시 (다층적 접근)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>groups</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>api_alerts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 인프라 계층 알림</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>alert</span><span class=p>:</span><span class=w> </span><span class=l>HighCpuUsage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>expr</span><span class=p>:</span><span class=w> </span><span class=l>avg(rate(node_cpu_seconds_total{mode!=&#34;idle&#34;}[5m])) by (instance) &gt; 0.8</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>for</span><span class=p>:</span><span class=w> </span><span class=l>5m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class=l>warning</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>layer</span><span class=p>:</span><span class=w> </span><span class=l>infrastructure</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;High CPU usage on {{ $labels.instance }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;CPU usage is above 80% for 5 minutes&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 애플리케이션 계층 알림</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>alert</span><span class=p>:</span><span class=w> </span><span class=l>ApiHighErrorRate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>expr</span><span class=p>:</span><span class=w> </span><span class=l>sum(rate(api_requests_total{status=~&#34;5..&#34;}[5m])) / sum(rate(api_requests_total[5m])) &gt; 0.05</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>for</span><span class=p>:</span><span class=w> </span><span class=l>2m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class=l>critical</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>layer</span><span class=p>:</span><span class=w> </span><span class=l>application</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;API error rate is high&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Error rate is above 5% for 2 minutes&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 비즈니스 계층 알림</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>alert</span><span class=p>:</span><span class=w> </span><span class=l>LowTransactionSuccessRate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>expr</span><span class=p>:</span><span class=w> </span><span class=l>sum(rate(business_transactions_success_total[5m])) / sum(rate(business_transactions_total[5m])) &lt; 0.95</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>for</span><span class=p>:</span><span class=w> </span><span class=l>5m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class=l>critical</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>layer</span><span class=p>:</span><span class=w> </span><span class=l>business</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Business transaction success rate is low&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Transaction success rate is below 95% for 5 minutes&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=효과적인-알림-설계>효과적인 알림 설계<a hidden class=anchor aria-hidden=true href=#효과적인-알림-설계>#</a></h4><p>알림 피로를 방지하고 중요한 문제에 집중할 수 있는 알림 전략을 구현한다:</p><ol><li><strong>임계값 기반 알림</strong>: 주요 지표가 사전 정의된 임계값을 초과할 때 알림</li><li><strong>추세 기반 알림</strong>: 비정상적인 패턴이나 갑작스러운 변화 감지 시 알림</li><li><strong>우선순위 기반 라우팅</strong>: 알림의 심각도에 따라 적절한 대응 채널로 라우팅</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11>11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12>12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13>13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14>14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15>15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16>16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17>17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18>18</a>
</span><span class=lnt id=hl-9-19><a class=lnlinks href=#hl-9-19>19</a>
</span><span class=lnt id=hl-9-20><a class=lnlinks href=#hl-9-20>20</a>
</span><span class=lnt id=hl-9-21><a class=lnlinks href=#hl-9-21>21</a>
</span><span class=lnt id=hl-9-22><a class=lnlinks href=#hl-9-22>22</a>
</span><span class=lnt id=hl-9-23><a class=lnlinks href=#hl-9-23>23</a>
</span><span class=lnt id=hl-9-24><a class=lnlinks href=#hl-9-24>24</a>
</span><span class=lnt id=hl-9-25><a class=lnlinks href=#hl-9-25>25</a>
</span><span class=lnt id=hl-9-26><a class=lnlinks href=#hl-9-26>26</a>
</span><span class=lnt id=hl-9-27><a class=lnlinks href=#hl-9-27>27</a>
</span><span class=lnt id=hl-9-28><a class=lnlinks href=#hl-9-28>28</a>
</span><span class=lnt id=hl-9-29><a class=lnlinks href=#hl-9-29>29</a>
</span><span class=lnt id=hl-9-30><a class=lnlinks href=#hl-9-30>30</a>
</span><span class=lnt id=hl-9-31><a class=lnlinks href=#hl-9-31>31</a>
</span><span class=lnt id=hl-9-32><a class=lnlinks href=#hl-9-32>32</a>
</span><span class=lnt id=hl-9-33><a class=lnlinks href=#hl-9-33>33</a>
</span><span class=lnt id=hl-9-34><a class=lnlinks href=#hl-9-34>34</a>
</span><span class=lnt id=hl-9-35><a class=lnlinks href=#hl-9-35>35</a>
</span><span class=lnt id=hl-9-36><a class=lnlinks href=#hl-9-36>36</a>
</span><span class=lnt id=hl-9-37><a class=lnlinks href=#hl-9-37>37</a>
</span><span class=lnt id=hl-9-38><a class=lnlinks href=#hl-9-38>38</a>
</span><span class=lnt id=hl-9-39><a class=lnlinks href=#hl-9-39>39</a>
</span><span class=lnt id=hl-9-40><a class=lnlinks href=#hl-9-40>40</a>
</span><span class=lnt id=hl-9-41><a class=lnlinks href=#hl-9-41>41</a>
</span><span class=lnt id=hl-9-42><a class=lnlinks href=#hl-9-42>42</a>
</span><span class=lnt id=hl-9-43><a class=lnlinks href=#hl-9-43>43</a>
</span><span class=lnt id=hl-9-44><a class=lnlinks href=#hl-9-44>44</a>
</span><span class=lnt id=hl-9-45><a class=lnlinks href=#hl-9-45>45</a>
</span><span class=lnt id=hl-9-46><a class=lnlinks href=#hl-9-46>46</a>
</span><span class=lnt id=hl-9-47><a class=lnlinks href=#hl-9-47>47</a>
</span><span class=lnt id=hl-9-48><a class=lnlinks href=#hl-9-48>48</a>
</span><span class=lnt id=hl-9-49><a class=lnlinks href=#hl-9-49>49</a>
</span><span class=lnt id=hl-9-50><a class=lnlinks href=#hl-9-50>50</a>
</span><span class=lnt id=hl-9-51><a class=lnlinks href=#hl-9-51>51</a>
</span><span class=lnt id=hl-9-52><a class=lnlinks href=#hl-9-52>52</a>
</span><span class=lnt id=hl-9-53><a class=lnlinks href=#hl-9-53>53</a>
</span><span class=lnt id=hl-9-54><a class=lnlinks href=#hl-9-54>54</a>
</span><span class=lnt id=hl-9-55><a class=lnlinks href=#hl-9-55>55</a>
</span><span class=lnt id=hl-9-56><a class=lnlinks href=#hl-9-56>56</a>
</span><span class=lnt id=hl-9-57><a class=lnlinks href=#hl-9-57>57</a>
</span><span class=lnt id=hl-9-58><a class=lnlinks href=#hl-9-58>58</a>
</span><span class=lnt id=hl-9-59><a class=lnlinks href=#hl-9-59>59</a>
</span><span class=lnt id=hl-9-60><a class=lnlinks href=#hl-9-60>60</a>
</span><span class=lnt id=hl-9-61><a class=lnlinks href=#hl-9-61>61</a>
</span><span class=lnt id=hl-9-62><a class=lnlinks href=#hl-9-62>62</a>
</span><span class=lnt id=hl-9-63><a class=lnlinks href=#hl-9-63>63</a>
</span><span class=lnt id=hl-9-64><a class=lnlinks href=#hl-9-64>64</a>
</span><span class=lnt id=hl-9-65><a class=lnlinks href=#hl-9-65>65</a>
</span><span class=lnt id=hl-9-66><a class=lnlinks href=#hl-9-66>66</a>
</span><span class=lnt id=hl-9-67><a class=lnlinks href=#hl-9-67>67</a>
</span><span class=lnt id=hl-9-68><a class=lnlinks href=#hl-9-68>68</a>
</span><span class=lnt id=hl-9-69><a class=lnlinks href=#hl-9-69>69</a>
</span><span class=lnt id=hl-9-70><a class=lnlinks href=#hl-9-70>70</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 알림 임계값 설정 및 에스컬레이션 예시</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AlertManager</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>thresholds</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;response_time&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;warning&#39;</span><span class=p>:</span> <span class=mi>500</span><span class=p>,</span>    <span class=c1># 500ms</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;critical&#39;</span><span class=p>:</span> <span class=mi>1000</span>   <span class=c1># 1초</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;error_rate&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;warning&#39;</span><span class=p>:</span> <span class=mf>0.01</span><span class=p>,</span>   <span class=c1># 1%</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;critical&#39;</span><span class=p>:</span> <span class=mf>0.05</span>   <span class=c1># 5%</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;request_rate&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;warning&#39;</span><span class=p>:</span> <span class=mi>1000</span><span class=p>,</span>   <span class=c1># 초당 1000 요청</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;critical&#39;</span><span class=p>:</span> <span class=mi>1500</span>   <span class=c1># 초당 1500 요청</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>escalation_policies</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;warning&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;slack-channel&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;critical&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;slack-channel&#39;</span><span class=p>,</span> <span class=s1>&#39;pagerduty&#39;</span><span class=p>,</span> <span class=s1>&#39;sms&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 알림 발생 이력 (알림 폭풍 방지)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>alert_history</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>check_and_alert</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>metric_name</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=n>context</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>metric_name</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>thresholds</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>severity</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>value</span> <span class=o>&gt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>thresholds</span><span class=p>[</span><span class=n>metric_name</span><span class=p>][</span><span class=s1>&#39;critical&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>severity</span> <span class=o>=</span> <span class=s1>&#39;critical&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>value</span> <span class=o>&gt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>thresholds</span><span class=p>[</span><span class=n>metric_name</span><span class=p>][</span><span class=s1>&#39;warning&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>severity</span> <span class=o>=</span> <span class=s1>&#39;warning&#39;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>severity</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 알림 폭풍 방지: 최근에 비슷한 알림이 발생했는지 확인</span>
</span></span><span class=line><span class=cl>            <span class=n>alert_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>metric_name</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>severity</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>current_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 지난 10분 이내에 알림이 발생했는지 확인</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>alert_key</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>alert_history</span> <span class=ow>and</span> 
</span></span><span class=line><span class=cl>                <span class=n>current_time</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>alert_history</span><span class=p>[</span><span class=n>alert_key</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>600</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=c1># 이미 알림이 발생했으므로 무시</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 알림 발생 시간 기록</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>alert_history</span><span class=p>[</span><span class=n>alert_key</span><span class=p>]</span> <span class=o>=</span> <span class=n>current_time</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 알림 생성 및 전송</span>
</span></span><span class=line><span class=cl>            <span class=n>alert</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;metric&#39;</span><span class=p>:</span> <span class=n>metric_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=n>value</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;threshold&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>thresholds</span><span class=p>[</span><span class=n>metric_name</span><span class=p>][</span><span class=n>severity</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;severity&#39;</span><span class=p>:</span> <span class=n>severity</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>current_time</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;context&#39;</span><span class=p>:</span> <span class=n>context</span> <span class=ow>or</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>send_alert</span><span class=p>(</span><span class=n>alert</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>escalation_policies</span><span class=p>[</span><span class=n>severity</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>send_alert</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>alert</span><span class=p>,</span> <span class=n>channels</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>channel</span> <span class=ow>in</span> <span class=n>channels</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>channel</span> <span class=o>==</span> <span class=s1>&#39;slack-channel&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>send_to_slack</span><span class=p>(</span><span class=n>alert</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>channel</span> <span class=o>==</span> <span class=s1>&#39;pagerduty&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>send_to_pagerduty</span><span class=p>(</span><span class=n>alert</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>channel</span> <span class=o>==</span> <span class=s1>&#39;sms&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>send_sms</span><span class=p>(</span><span class=n>alert</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=전체-api-수명-주기-모니터링>전체 API 수명 주기 모니터링<a hidden class=anchor aria-hidden=true href=#전체-api-수명-주기-모니터링>#</a></h4><p>API의 모든 생명 주기 단계를 모니터링하는 것이 중요하다:</p><ol><li><strong>개발 단계</strong>: 성능 테스트 및 코드 품질 모니터링</li><li><strong>배포 단계</strong>: 배포 성공률 및 서비스 중단 모니터링</li><li><strong>운영 단계</strong>: 실시간 성능 및 가용성 모니터링</li><li><strong>폐기 단계</strong>: 레거시 API 사용 현황 및 마이그레이션 진행 상황 모니터링</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span><span class=lnt id=hl-10-16><a class=lnlinks href=#hl-10-16>16</a>
</span><span class=lnt id=hl-10-17><a class=lnlinks href=#hl-10-17>17</a>
</span><span class=lnt id=hl-10-18><a class=lnlinks href=#hl-10-18>18</a>
</span><span class=lnt id=hl-10-19><a class=lnlinks href=#hl-10-19>19</a>
</span><span class=lnt id=hl-10-20><a class=lnlinks href=#hl-10-20>20</a>
</span><span class=lnt id=hl-10-21><a class=lnlinks href=#hl-10-21>21</a>
</span><span class=lnt id=hl-10-22><a class=lnlinks href=#hl-10-22>22</a>
</span><span class=lnt id=hl-10-23><a class=lnlinks href=#hl-10-23>23</a>
</span><span class=lnt id=hl-10-24><a class=lnlinks href=#hl-10-24>24</a>
</span><span class=lnt id=hl-10-25><a class=lnlinks href=#hl-10-25>25</a>
</span><span class=lnt id=hl-10-26><a class=lnlinks href=#hl-10-26>26</a>
</span><span class=lnt id=hl-10-27><a class=lnlinks href=#hl-10-27>27</a>
</span><span class=lnt id=hl-10-28><a class=lnlinks href=#hl-10-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># API 버전별 사용 현황 모니터링 예시</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>track_api_version_usage</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>response</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;API 버전 사용 현황을 모니터링하는 미들웨어&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>version</span> <span class=o>=</span> <span class=n>get_api_version</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 버전별 사용량 메트릭 기록</span>
</span></span><span class=line><span class=cl>    <span class=n>increment_counter</span><span class=p>(</span><span class=s1>&#39;api.version.usage&#39;</span><span class=p>,</span> <span class=n>tags</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;version&#39;</span><span class=p>:</span> <span class=n>version</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 폐기 예정 버전에 대한 경고 로깅</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>version</span> <span class=ow>in</span> <span class=n>DEPRECATED_VERSIONS</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Deprecated API version used&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>extra</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;version&#39;</span><span class=p>:</span> <span class=n>version</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;client_id&#39;</span><span class=p>:</span> <span class=n>get_client_id</span><span class=p>(</span><span class=n>request</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;endpoint&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>path</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;sunset_date&#39;</span><span class=p>:</span> <span class=n>SUNSET_DATES</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>version</span><span class=p>,</span> <span class=s1>&#39;unknown&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 응답 헤더에 폐기 관련 정보 추가</span>
</span></span><span class=line><span class=cl>        <span class=n>sunset_date</span> <span class=o>=</span> <span class=n>SUNSET_DATES</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>version</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>sunset_date</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=p>[</span><span class=s1>&#39;Sunset&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>sunset_date</span>
</span></span><span class=line><span class=cl>            <span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=p>[</span><span class=s1>&#39;Deprecation&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;true&#39;</span>
</span></span><span class=line><span class=cl>            <span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=p>[</span><span class=s1>&#39;Link&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;&lt;</span><span class=si>{</span><span class=n>MIGRATION_GUIDES</span><span class=p>[</span><span class=n>version</span><span class=p>]</span><span class=si>}</span><span class=s1>&gt;; rel=&#34;deprecation&#34;; type=&#34;text/html&#34;&#39;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>response</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사용자-정의-건강-검사health-checks-구현>사용자 정의 건강 검사(Health Checks) 구현<a hidden class=anchor aria-hidden=true href=#사용자-정의-건강-검사health-checks-구현>#</a></h4><p>API의 핵심 기능과 종속성을 주기적으로 검사하여 전체 시스템의 건강 상태를 모니터링한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15>15</a>
</span><span class=lnt id=hl-11-16><a class=lnlinks href=#hl-11-16>16</a>
</span><span class=lnt id=hl-11-17><a class=lnlinks href=#hl-11-17>17</a>
</span><span class=lnt id=hl-11-18><a class=lnlinks href=#hl-11-18>18</a>
</span><span class=lnt id=hl-11-19><a class=lnlinks href=#hl-11-19>19</a>
</span><span class=lnt id=hl-11-20><a class=lnlinks href=#hl-11-20>20</a>
</span><span class=lnt id=hl-11-21><a class=lnlinks href=#hl-11-21>21</a>
</span><span class=lnt id=hl-11-22><a class=lnlinks href=#hl-11-22>22</a>
</span><span class=lnt id=hl-11-23><a class=lnlinks href=#hl-11-23>23</a>
</span><span class=lnt id=hl-11-24><a class=lnlinks href=#hl-11-24>24</a>
</span><span class=lnt id=hl-11-25><a class=lnlinks href=#hl-11-25>25</a>
</span><span class=lnt id=hl-11-26><a class=lnlinks href=#hl-11-26>26</a>
</span><span class=lnt id=hl-11-27><a class=lnlinks href=#hl-11-27>27</a>
</span><span class=lnt id=hl-11-28><a class=lnlinks href=#hl-11-28>28</a>
</span><span class=lnt id=hl-11-29><a class=lnlinks href=#hl-11-29>29</a>
</span><span class=lnt id=hl-11-30><a class=lnlinks href=#hl-11-30>30</a>
</span><span class=lnt id=hl-11-31><a class=lnlinks href=#hl-11-31>31</a>
</span><span class=lnt id=hl-11-32><a class=lnlinks href=#hl-11-32>32</a>
</span><span class=lnt id=hl-11-33><a class=lnlinks href=#hl-11-33>33</a>
</span><span class=lnt id=hl-11-34><a class=lnlinks href=#hl-11-34>34</a>
</span><span class=lnt id=hl-11-35><a class=lnlinks href=#hl-11-35>35</a>
</span><span class=lnt id=hl-11-36><a class=lnlinks href=#hl-11-36>36</a>
</span><span class=lnt id=hl-11-37><a class=lnlinks href=#hl-11-37>37</a>
</span><span class=lnt id=hl-11-38><a class=lnlinks href=#hl-11-38>38</a>
</span><span class=lnt id=hl-11-39><a class=lnlinks href=#hl-11-39>39</a>
</span><span class=lnt id=hl-11-40><a class=lnlinks href=#hl-11-40>40</a>
</span><span class=lnt id=hl-11-41><a class=lnlinks href=#hl-11-41>41</a>
</span><span class=lnt id=hl-11-42><a class=lnlinks href=#hl-11-42>42</a>
</span><span class=lnt id=hl-11-43><a class=lnlinks href=#hl-11-43>43</a>
</span><span class=lnt id=hl-11-44><a class=lnlinks href=#hl-11-44>44</a>
</span><span class=lnt id=hl-11-45><a class=lnlinks href=#hl-11-45>45</a>
</span><span class=lnt id=hl-11-46><a class=lnlinks href=#hl-11-46>46</a>
</span><span class=lnt id=hl-11-47><a class=lnlinks href=#hl-11-47>47</a>
</span><span class=lnt id=hl-11-48><a class=lnlinks href=#hl-11-48>48</a>
</span><span class=lnt id=hl-11-49><a class=lnlinks href=#hl-11-49>49</a>
</span><span class=lnt id=hl-11-50><a class=lnlinks href=#hl-11-50>50</a>
</span><span class=lnt id=hl-11-51><a class=lnlinks href=#hl-11-51>51</a>
</span><span class=lnt id=hl-11-52><a class=lnlinks href=#hl-11-52>52</a>
</span><span class=lnt id=hl-11-53><a class=lnlinks href=#hl-11-53>53</a>
</span><span class=lnt id=hl-11-54><a class=lnlinks href=#hl-11-54>54</a>
</span><span class=lnt id=hl-11-55><a class=lnlinks href=#hl-11-55>55</a>
</span><span class=lnt id=hl-11-56><a class=lnlinks href=#hl-11-56>56</a>
</span><span class=lnt id=hl-11-57><a class=lnlinks href=#hl-11-57>57</a>
</span><span class=lnt id=hl-11-58><a class=lnlinks href=#hl-11-58>58</a>
</span><span class=lnt id=hl-11-59><a class=lnlinks href=#hl-11-59>59</a>
</span><span class=lnt id=hl-11-60><a class=lnlinks href=#hl-11-60>60</a>
</span><span class=lnt id=hl-11-61><a class=lnlinks href=#hl-11-61>61</a>
</span><span class=lnt id=hl-11-62><a class=lnlinks href=#hl-11-62>62</a>
</span><span class=lnt id=hl-11-63><a class=lnlinks href=#hl-11-63>63</a>
</span><span class=lnt id=hl-11-64><a class=lnlinks href=#hl-11-64>64</a>
</span><span class=lnt id=hl-11-65><a class=lnlinks href=#hl-11-65>65</a>
</span><span class=lnt id=hl-11-66><a class=lnlinks href=#hl-11-66>66</a>
</span><span class=lnt id=hl-11-67><a class=lnlinks href=#hl-11-67>67</a>
</span><span class=lnt id=hl-11-68><a class=lnlinks href=#hl-11-68>68</a>
</span><span class=lnt id=hl-11-69><a class=lnlinks href=#hl-11-69>69</a>
</span><span class=lnt id=hl-11-70><a class=lnlinks href=#hl-11-70>70</a>
</span><span class=lnt id=hl-11-71><a class=lnlinks href=#hl-11-71>71</a>
</span><span class=lnt id=hl-11-72><a class=lnlinks href=#hl-11-72>72</a>
</span><span class=lnt id=hl-11-73><a class=lnlinks href=#hl-11-73>73</a>
</span><span class=lnt id=hl-11-74><a class=lnlinks href=#hl-11-74>74</a>
</span><span class=lnt id=hl-11-75><a class=lnlinks href=#hl-11-75>75</a>
</span><span class=lnt id=hl-11-76><a class=lnlinks href=#hl-11-76>76</a>
</span><span class=lnt id=hl-11-77><a class=lnlinks href=#hl-11-77>77</a>
</span><span class=lnt id=hl-11-78><a class=lnlinks href=#hl-11-78>78</a>
</span><span class=lnt id=hl-11-79><a class=lnlinks href=#hl-11-79>79</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Flask에서의 종합적인 건강 검사 API 구현</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>redis</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>psycopg2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>check_database</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;데이터베이스 연결 및 기본 쿼리 건강 검사&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span> <span class=o>=</span> <span class=n>psycopg2</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>DATABASE_URL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>cursor</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>cursor</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;SELECT 1&#34;</span><span class=p>)</span>  <span class=c1># 간단한 쿼리로 연결 확인</span>
</span></span><span class=line><span class=cl>        <span class=n>cursor</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span><span class=p>,</span> <span class=s2>&#34;Database connection is healthy&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&#34;Database connection failed: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>check_redis</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Redis 연결 건강 검사&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>redis_client</span> <span class=o>=</span> <span class=n>redis</span><span class=o>.</span><span class=n>Redis</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=n>REDIS_HOST</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=n>REDIS_PORT</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>redis_client</span><span class=o>.</span><span class=n>ping</span><span class=p>()</span>  <span class=c1># PING 명령으로 연결 확인</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span><span class=p>,</span> <span class=s2>&#34;Redis connection is healthy&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&#34;Redis connection failed: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>check_external_api</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;외부 의존성 API 건강 검사&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;https://external-api.example.com/health&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>timeout</span><span class=o>=</span><span class=mi>3</span>  <span class=c1># 3초 타임아웃 설정</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>True</span><span class=p>,</span> <span class=s2>&#34;External API is reachable&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&#34;External API returned status code </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&#34;External API check failed: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/health&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>basic_health_check</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;기본 가용성 확인을 위한 간단한 건강 검사&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;UP&#34;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/health/detailed&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>detailed_health_check</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;상세한, 종합적인 건강 검사&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>checks</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;database&#34;</span><span class=p>:</span> <span class=n>check_database</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;redis&#34;</span><span class=p>:</span> <span class=n>check_redis</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;external_api&#34;</span><span class=p>:</span> <span class=n>check_external_api</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 전체 상태 계산</span>
</span></span><span class=line><span class=cl>    <span class=n>all_healthy</span> <span class=o>=</span> <span class=nb>all</span><span class=p>(</span><span class=n>result</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>checks</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>overall_status</span> <span class=o>=</span> <span class=s2>&#34;UP&#34;</span> <span class=k>if</span> <span class=n>all_healthy</span> <span class=k>else</span> <span class=s2>&#34;DOWN&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 응답 형식화</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=n>overall_status</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;checks&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>name</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;UP&#34;</span> <span class=k>if</span> <span class=n>result</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>else</span> <span class=s2>&#34;DOWN&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;message&#34;</span><span class=p>:</span> <span class=n>result</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>checks</span><span class=o>.</span><span class=n>items</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;time&#34;</span><span class=p>:</span> <span class=nb>round</span><span class=p>((</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span><span class=p>)</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>  <span class=c1># ms 단위 응답 시간</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>status_code</span> <span class=o>=</span> <span class=mi>200</span> <span class=k>if</span> <span class=n>all_healthy</span> <span class=k>else</span> <span class=mi>503</span>  <span class=c1># 서비스 사용 불가 상태 코드</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>response</span><span class=p>),</span> <span class=n>status_code</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=api-모니터링의-도전-과제와-해결-방법>API 모니터링의 도전 과제와 해결 방법<a hidden class=anchor aria-hidden=true href=#api-모니터링의-도전-과제와-해결-방법>#</a></h3><h4 id=데이터-볼륨-관리>데이터 볼륨 관리<a hidden class=anchor aria-hidden=true href=#데이터-볼륨-관리>#</a></h4><p>대규모 API는 방대한 양의 모니터링 데이터를 생성하며, 이를 효과적으로 관리해야 한다.</p><p><strong>해결 방법</strong>:</p><ul><li><strong>데이터 샘플링</strong>: 전체 트래픽의 일부만 상세히 추적</li><li><strong>집계 전략</strong>: 원시 데이터를 의미 있는 통계로 축소</li><li><strong>TTL(Time-to-Live) 정책</strong>: 오래된 데이터 자동 삭제</li><li><strong>계층적 스토리지</strong>: 최신 데이터는 고속 스토리지에, 오래된 데이터는 저비용 스토리지에 보관</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1> 1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2> 2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3> 3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4> 4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5> 5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6> 6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7> 7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8> 8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9> 9</a>
</span><span class=lnt id=hl-12-10><a class=lnlinks href=#hl-12-10>10</a>
</span><span class=lnt id=hl-12-11><a class=lnlinks href=#hl-12-11>11</a>
</span><span class=lnt id=hl-12-12><a class=lnlinks href=#hl-12-12>12</a>
</span><span class=lnt id=hl-12-13><a class=lnlinks href=#hl-12-13>13</a>
</span><span class=lnt id=hl-12-14><a class=lnlinks href=#hl-12-14>14</a>
</span><span class=lnt id=hl-12-15><a class=lnlinks href=#hl-12-15>15</a>
</span><span class=lnt id=hl-12-16><a class=lnlinks href=#hl-12-16>16</a>
</span><span class=lnt id=hl-12-17><a class=lnlinks href=#hl-12-17>17</a>
</span><span class=lnt id=hl-12-18><a class=lnlinks href=#hl-12-18>18</a>
</span><span class=lnt id=hl-12-19><a class=lnlinks href=#hl-12-19>19</a>
</span><span class=lnt id=hl-12-20><a class=lnlinks href=#hl-12-20>20</a>
</span><span class=lnt id=hl-12-21><a class=lnlinks href=#hl-12-21>21</a>
</span><span class=lnt id=hl-12-22><a class=lnlinks href=#hl-12-22>22</a>
</span><span class=lnt id=hl-12-23><a class=lnlinks href=#hl-12-23>23</a>
</span><span class=lnt id=hl-12-24><a class=lnlinks href=#hl-12-24>24</a>
</span><span class=lnt id=hl-12-25><a class=lnlinks href=#hl-12-25>25</a>
</span><span class=lnt id=hl-12-26><a class=lnlinks href=#hl-12-26>26</a>
</span><span class=lnt id=hl-12-27><a class=lnlinks href=#hl-12-27>27</a>
</span><span class=lnt id=hl-12-28><a class=lnlinks href=#hl-12-28>28</a>
</span><span class=lnt id=hl-12-29><a class=lnlinks href=#hl-12-29>29</a>
</span><span class=lnt id=hl-12-30><a class=lnlinks href=#hl-12-30>30</a>
</span><span class=lnt id=hl-12-31><a class=lnlinks href=#hl-12-31>31</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 샘플링 구현 예시 (Node.js)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>shouldSample</span><span class=p>(</span><span class=nx>requestId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 현재 샘플링 비율 (환경 변수나 설정에서 가져옴)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>samplingRate</span> <span class=o>=</span> <span class=nb>parseFloat</span><span class=p>(</span><span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>TRACING_SAMPLING_RATE</span> <span class=o>||</span> <span class=s2>&#34;0.1&#34;</span><span class=p>);</span>  <span class=c1>// 기본값 10%
</span></span></span><span class=line><span class=cl><span class=c1></span>  
</span></span><span class=line><span class=cl>  <span class=c1>// requestId의 해시값을 계산하여 0-1 사이의 값으로 정규화
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>hash</span> <span class=o>=</span> <span class=nx>calculateHash</span><span class=p>(</span><span class=nx>requestId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>normalizedHash</span> <span class=o>=</span> <span class=nx>hash</span> <span class=o>/</span> <span class=nb>Number</span><span class=p>.</span><span class=nx>MAX_SAFE_INTEGER</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 정규화된 해시값이 샘플링 비율보다 작으면 샘플링
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=nx>normalizedHash</span> <span class=o>&lt;</span> <span class=nx>samplingRate</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 미들웨어에서 사용
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>((</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>requestId</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>headers</span><span class=p>[</span><span class=s1>&#39;x-request-id&#39;</span><span class=p>]</span> <span class=o>||</span> <span class=nx>uuidv4</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=nx>req</span><span class=p>.</span><span class=nx>requestId</span> <span class=o>=</span> <span class=nx>requestId</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 샘플링 여부 결정
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>req</span><span class=p>.</span><span class=nx>shouldTrace</span> <span class=o>=</span> <span class=nx>shouldSample</span><span class=p>(</span><span class=nx>requestId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 모든 요청에 대해 기본 메트릭은 항상 수집
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>collectBasicMetrics</span><span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 샘플링된 요청에 대해서만 상세 추적 활성화
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>shouldTrace</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>enableDetailedTracing</span><span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=보안-모니터링-통합>보안 모니터링 통합<a hidden class=anchor aria-hidden=true href=#보안-모니터링-통합>#</a></h4><p>API 모니터링은 성능뿐만 아니라 보안 측면도 고려해야 한다.</p><p><strong>해결 방법</strong>:</p><ul><li><strong>비정상 패턴 감지</strong>: 비정상적인 요청 패턴 모니터링</li><li><strong>속도 제한 모니터링</strong>: 속도 제한 위반 추적</li><li><strong>인증 실패 모니터링</strong>: 인증 오류 패턴 분석</li><li><strong>데이터 유출 감지</strong>: 민감한 데이터 유출 모니터링</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1> 1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2> 2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3> 3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4> 4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5> 5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6> 6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7> 7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8> 8</a>
</span><span class=lnt id=hl-13-9><a class=lnlinks href=#hl-13-9> 9</a>
</span><span class=lnt id=hl-13-10><a class=lnlinks href=#hl-13-10>10</a>
</span><span class=lnt id=hl-13-11><a class=lnlinks href=#hl-13-11>11</a>
</span><span class=lnt id=hl-13-12><a class=lnlinks href=#hl-13-12>12</a>
</span><span class=lnt id=hl-13-13><a class=lnlinks href=#hl-13-13>13</a>
</span><span class=lnt id=hl-13-14><a class=lnlinks href=#hl-13-14>14</a>
</span><span class=lnt id=hl-13-15><a class=lnlinks href=#hl-13-15>15</a>
</span><span class=lnt id=hl-13-16><a class=lnlinks href=#hl-13-16>16</a>
</span><span class=lnt id=hl-13-17><a class=lnlinks href=#hl-13-17>17</a>
</span><span class=lnt id=hl-13-18><a class=lnlinks href=#hl-13-18>18</a>
</span><span class=lnt id=hl-13-19><a class=lnlinks href=#hl-13-19>19</a>
</span><span class=lnt id=hl-13-20><a class=lnlinks href=#hl-13-20>20</a>
</span><span class=lnt id=hl-13-21><a class=lnlinks href=#hl-13-21>21</a>
</span><span class=lnt id=hl-13-22><a class=lnlinks href=#hl-13-22>22</a>
</span><span class=lnt id=hl-13-23><a class=lnlinks href=#hl-13-23>23</a>
</span><span class=lnt id=hl-13-24><a class=lnlinks href=#hl-13-24>24</a>
</span><span class=lnt id=hl-13-25><a class=lnlinks href=#hl-13-25>25</a>
</span><span class=lnt id=hl-13-26><a class=lnlinks href=#hl-13-26>26</a>
</span><span class=lnt id=hl-13-27><a class=lnlinks href=#hl-13-27>27</a>
</span><span class=lnt id=hl-13-28><a class=lnlinks href=#hl-13-28>28</a>
</span><span class=lnt id=hl-13-29><a class=lnlinks href=#hl-13-29>29</a>
</span><span class=lnt id=hl-13-30><a class=lnlinks href=#hl-13-30>30</a>
</span><span class=lnt id=hl-13-31><a class=lnlinks href=#hl-13-31>31</a>
</span><span class=lnt id=hl-13-32><a class=lnlinks href=#hl-13-32>32</a>
</span><span class=lnt id=hl-13-33><a class=lnlinks href=#hl-13-33>33</a>
</span><span class=lnt id=hl-13-34><a class=lnlinks href=#hl-13-34>34</a>
</span><span class=lnt id=hl-13-35><a class=lnlinks href=#hl-13-35>35</a>
</span><span class=lnt id=hl-13-36><a class=lnlinks href=#hl-13-36>36</a>
</span><span class=lnt id=hl-13-37><a class=lnlinks href=#hl-13-37>37</a>
</span><span class=lnt id=hl-13-38><a class=lnlinks href=#hl-13-38>38</a>
</span><span class=lnt id=hl-13-39><a class=lnlinks href=#hl-13-39>39</a>
</span><span class=lnt id=hl-13-40><a class=lnlinks href=#hl-13-40>40</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># API 보안 모니터링 예시</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>monitor_security_events</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>response</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 인증 실패 모니터링</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>401</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>increment_counter</span><span class=p>(</span><span class=s1>&#39;api.auth.failure&#39;</span><span class=p>,</span> <span class=n>tags</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;ip&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>remote_addr</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_agent&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>user_agent</span><span class=o>.</span><span class=n>string</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;endpoint&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>path</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 동일 IP에서의 인증 실패 횟수 확인</span>
</span></span><span class=line><span class=cl>        <span class=n>failure_count</span> <span class=o>=</span> <span class=n>get_recent_failures</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>remote_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>failure_count</span> <span class=o>&gt;</span> <span class=n>THRESHOLD_SUSPICIOUS_AUTH_FAILURES</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>log_security_event</span><span class=p>(</span><span class=s1>&#39;excessive_auth_failures&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;ip&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>remote_addr</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;count&#39;</span><span class=p>:</span> <span class=n>failure_count</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;time_window&#39;</span><span class=p>:</span> <span class=s1>&#39;last 1 hour&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># API 속도 제한 모니터링</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>429</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>increment_counter</span><span class=p>(</span><span class=s1>&#39;api.rate_limit.exceeded&#39;</span><span class=p>,</span> <span class=n>tags</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;client_id&#39;</span><span class=p>:</span> <span class=n>get_client_id</span><span class=p>(</span><span class=n>request</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;endpoint&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>path</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 속도 제한 초과 패턴 분석</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>is_abnormal_rate_pattern</span><span class=p>(</span><span class=n>get_client_id</span><span class=p>(</span><span class=n>request</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=n>log_security_event</span><span class=p>(</span><span class=s1>&#39;suspicious_rate_limit_pattern&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;client_id&#39;</span><span class=p>:</span> <span class=n>get_client_id</span><span class=p>(</span><span class=n>request</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;pattern&#39;</span><span class=p>:</span> <span class=s1>&#39;burst_traffic&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 데이터 유출 의심 모니터링 (비정상적으로 큰 응답)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>content_length</span> <span class=o>&gt;</span> <span class=n>THRESHOLD_LARGE_RESPONSE</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>log_security_event</span><span class=p>(</span><span class=s1>&#39;large_data_transfer&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;client_id&#39;</span><span class=p>:</span> <span class=n>get_client_id</span><span class=p>(</span><span class=n>request</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;endpoint&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>path</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;size&#39;</span><span class=p>:</span> <span class=n>response</span><span class=o>.</span><span class=n>content_length</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=마이크로서비스-환경에서의-모니터링>마이크로서비스 환경에서의 모니터링<a hidden class=anchor aria-hidden=true href=#마이크로서비스-환경에서의-모니터링>#</a></h4><p>마이크로서비스 아키텍처는 분산된 서비스의 모니터링 복잡성을 증가시킨다.</p><p><strong>해결 방법</strong>:</p><ul><li><strong>상관 ID 전파</strong>: 요청 추적을 위한 고유 식별자 전달</li><li><strong>서비스 맵 생성</strong>: 서비스 간 종속성 시각화</li><li><strong>분산 로깅</strong>: 중앙 집중식 로그 수집 및 분석</li><li><strong>서비스 메시</strong>: Istio, Linkerd 등의 서비스 메시를 통한 관찰성 향상</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1> 1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2> 2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3> 3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4> 4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5> 5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6> 6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7> 7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8> 8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9> 9</a>
</span><span class=lnt id=hl-14-10><a class=lnlinks href=#hl-14-10>10</a>
</span><span class=lnt id=hl-14-11><a class=lnlinks href=#hl-14-11>11</a>
</span><span class=lnt id=hl-14-12><a class=lnlinks href=#hl-14-12>12</a>
</span><span class=lnt id=hl-14-13><a class=lnlinks href=#hl-14-13>13</a>
</span><span class=lnt id=hl-14-14><a class=lnlinks href=#hl-14-14>14</a>
</span><span class=lnt id=hl-14-15><a class=lnlinks href=#hl-14-15>15</a>
</span><span class=lnt id=hl-14-16><a class=lnlinks href=#hl-14-16>16</a>
</span><span class=lnt id=hl-14-17><a class=lnlinks href=#hl-14-17>17</a>
</span><span class=lnt id=hl-14-18><a class=lnlinks href=#hl-14-18>18</a>
</span><span class=lnt id=hl-14-19><a class=lnlinks href=#hl-14-19>19</a>
</span><span class=lnt id=hl-14-20><a class=lnlinks href=#hl-14-20>20</a>
</span><span class=lnt id=hl-14-21><a class=lnlinks href=#hl-14-21>21</a>
</span><span class=lnt id=hl-14-22><a class=lnlinks href=#hl-14-22>22</a>
</span><span class=lnt id=hl-14-23><a class=lnlinks href=#hl-14-23>23</a>
</span><span class=lnt id=hl-14-24><a class=lnlinks href=#hl-14-24>24</a>
</span><span class=lnt id=hl-14-25><a class=lnlinks href=#hl-14-25>25</a>
</span><span class=lnt id=hl-14-26><a class=lnlinks href=#hl-14-26>26</a>
</span><span class=lnt id=hl-14-27><a class=lnlinks href=#hl-14-27>27</a>
</span><span class=lnt id=hl-14-28><a class=lnlinks href=#hl-14-28>28</a>
</span><span class=lnt id=hl-14-29><a class=lnlinks href=#hl-14-29>29</a>
</span><span class=lnt id=hl-14-30><a class=lnlinks href=#hl-14-30>30</a>
</span><span class=lnt id=hl-14-31><a class=lnlinks href=#hl-14-31>31</a>
</span><span class=lnt id=hl-14-32><a class=lnlinks href=#hl-14-32>32</a>
</span><span class=lnt id=hl-14-33><a class=lnlinks href=#hl-14-33>33</a>
</span><span class=lnt id=hl-14-34><a class=lnlinks href=#hl-14-34>34</a>
</span><span class=lnt id=hl-14-35><a class=lnlinks href=#hl-14-35>35</a>
</span><span class=lnt id=hl-14-36><a class=lnlinks href=#hl-14-36>36</a>
</span><span class=lnt id=hl-14-37><a class=lnlinks href=#hl-14-37>37</a>
</span><span class=lnt id=hl-14-38><a class=lnlinks href=#hl-14-38>38</a>
</span><span class=lnt id=hl-14-39><a class=lnlinks href=#hl-14-39>39</a>
</span><span class=lnt id=hl-14-40><a class=lnlinks href=#hl-14-40>40</a>
</span><span class=lnt id=hl-14-41><a class=lnlinks href=#hl-14-41>41</a>
</span><span class=lnt id=hl-14-42><a class=lnlinks href=#hl-14-42>42</a>
</span><span class=lnt id=hl-14-43><a class=lnlinks href=#hl-14-43>43</a>
</span><span class=lnt id=hl-14-44><a class=lnlinks href=#hl-14-44>44</a>
</span><span class=lnt id=hl-14-45><a class=lnlinks href=#hl-14-45>45</a>
</span><span class=lnt id=hl-14-46><a class=lnlinks href=#hl-14-46>46</a>
</span><span class=lnt id=hl-14-47><a class=lnlinks href=#hl-14-47>47</a>
</span><span class=lnt id=hl-14-48><a class=lnlinks href=#hl-14-48>48</a>
</span><span class=lnt id=hl-14-49><a class=lnlinks href=#hl-14-49>49</a>
</span><span class=lnt id=hl-14-50><a class=lnlinks href=#hl-14-50>50</a>
</span><span class=lnt id=hl-14-51><a class=lnlinks href=#hl-14-51>51</a>
</span><span class=lnt id=hl-14-52><a class=lnlinks href=#hl-14-52>52</a>
</span><span class=lnt id=hl-14-53><a class=lnlinks href=#hl-14-53>53</a>
</span><span class=lnt id=hl-14-54><a class=lnlinks href=#hl-14-54>54</a>
</span><span class=lnt id=hl-14-55><a class=lnlinks href=#hl-14-55>55</a>
</span><span class=lnt id=hl-14-56><a class=lnlinks href=#hl-14-56>56</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 상관 ID 전파 예시 (Java/Spring)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Component</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>CorrelationIdFilter</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>OncePerRequestFilter</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>CORRELATION_ID_HEADER</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;X-Correlation-ID&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>doFilterInternal</span><span class=p>(</span><span class=n>HttpServletRequest</span><span class=w> </span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>response</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                                   </span><span class=n>FilterChain</span><span class=w> </span><span class=n>filterChain</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>ServletException</span><span class=p>,</span><span class=w> </span><span class=n>IOException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>correlationId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>request</span><span class=p>.</span><span class=na>getHeader</span><span class=p>(</span><span class=n>CORRELATION_ID_HEADER</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 상관 ID가 없으면 새로 생성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>correlationId</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=kc>null</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>correlationId</span><span class=p>.</span><span class=na>isEmpty</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>correlationId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>UUID</span><span class=p>.</span><span class=na>randomUUID</span><span class=p>().</span><span class=na>toString</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// MDC에 상관 ID 설정 (로깅용)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>MDC</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;correlationId&#34;</span><span class=p>,</span><span class=w> </span><span class=n>correlationId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 응답 헤더에 상관 ID 추가</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>response</span><span class=p>.</span><span class=na>addHeader</span><span class=p>(</span><span class=n>CORRELATION_ID_HEADER</span><span class=p>,</span><span class=w> </span><span class=n>correlationId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 다운스트림 서비스 호출 시 상관 ID 전달을 위한 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>RequestContextHolder</span><span class=p>.</span><span class=na>currentRequestAttributes</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>setAttribute</span><span class=p>(</span><span class=s>&#34;correlationId&#34;</span><span class=p>,</span><span class=w> </span><span class=n>correlationId</span><span class=p>,</span><span class=w> </span><span class=n>RequestAttributes</span><span class=p>.</span><span class=na>SCOPE_REQUEST</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>filterChain</span><span class=p>.</span><span class=na>doFilter</span><span class=p>(</span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>response</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>MDC</span><span class=p>.</span><span class=na>remove</span><span class=p>(</span><span class=s>&#34;correlationId&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// RestTemplate에 상관 ID 추가</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>RestTemplateConfig</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>RestTemplate</span><span class=w> </span><span class=nf>restTemplate</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>RestTemplate</span><span class=w> </span><span class=n>restTemplate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>RestTemplate</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>restTemplate</span><span class=p>.</span><span class=na>setInterceptors</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Collections</span><span class=p>.</span><span class=na>singletonList</span><span class=p>((</span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>body</span><span class=p>,</span><span class=w> </span><span class=n>execution</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>String</span><span class=w> </span><span class=n>correlationId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>String</span><span class=p>)</span><span class=w> </span><span class=n>RequestContextHolder</span><span class=p>.</span><span class=na>currentRequestAttributes</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=p>.</span><span class=na>getAttribute</span><span class=p>(</span><span class=s>&#34;correlationId&#34;</span><span class=p>,</span><span class=w> </span><span class=n>RequestAttributes</span><span class=p>.</span><span class=na>SCOPE_REQUEST</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>correlationId</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>request</span><span class=p>.</span><span class=na>getHeaders</span><span class=p>().</span><span class=na>add</span><span class=p>(</span><span class=s>&#34;X-Correlation-ID&#34;</span><span class=p>,</span><span class=w> </span><span class=n>correlationId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=n>execution</span><span class=p>.</span><span class=na>execute</span><span class=p>(</span><span class=n>request</span><span class=p>,</span><span class=w> </span><span class=n>body</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>})</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>restTemplate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=api-모니터링-고급-기법>API 모니터링 고급 기법<a hidden class=anchor aria-hidden=true href=#api-모니터링-고급-기법>#</a></h3><h4 id=이상-탐지-및-예측-분석>이상 탐지 및 예측 분석<a hidden class=anchor aria-hidden=true href=#이상-탐지-및-예측-분석>#</a></h4><p>정상적인 패턴에서 벗어난 비정상적인 API 동작을 자동으로 감지하고 미래 문제를 예측한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1> 1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2> 2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3> 3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4> 4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5> 5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6> 6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7> 7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8> 8</a>
</span><span class=lnt id=hl-15-9><a class=lnlinks href=#hl-15-9> 9</a>
</span><span class=lnt id=hl-15-10><a class=lnlinks href=#hl-15-10>10</a>
</span><span class=lnt id=hl-15-11><a class=lnlinks href=#hl-15-11>11</a>
</span><span class=lnt id=hl-15-12><a class=lnlinks href=#hl-15-12>12</a>
</span><span class=lnt id=hl-15-13><a class=lnlinks href=#hl-15-13>13</a>
</span><span class=lnt id=hl-15-14><a class=lnlinks href=#hl-15-14>14</a>
</span><span class=lnt id=hl-15-15><a class=lnlinks href=#hl-15-15>15</a>
</span><span class=lnt id=hl-15-16><a class=lnlinks href=#hl-15-16>16</a>
</span><span class=lnt id=hl-15-17><a class=lnlinks href=#hl-15-17>17</a>
</span><span class=lnt id=hl-15-18><a class=lnlinks href=#hl-15-18>18</a>
</span><span class=lnt id=hl-15-19><a class=lnlinks href=#hl-15-19>19</a>
</span><span class=lnt id=hl-15-20><a class=lnlinks href=#hl-15-20>20</a>
</span><span class=lnt id=hl-15-21><a class=lnlinks href=#hl-15-21>21</a>
</span><span class=lnt id=hl-15-22><a class=lnlinks href=#hl-15-22>22</a>
</span><span class=lnt id=hl-15-23><a class=lnlinks href=#hl-15-23>23</a>
</span><span class=lnt id=hl-15-24><a class=lnlinks href=#hl-15-24>24</a>
</span><span class=lnt id=hl-15-25><a class=lnlinks href=#hl-15-25>25</a>
</span><span class=lnt id=hl-15-26><a class=lnlinks href=#hl-15-26>26</a>
</span><span class=lnt id=hl-15-27><a class=lnlinks href=#hl-15-27>27</a>
</span><span class=lnt id=hl-15-28><a class=lnlinks href=#hl-15-28>28</a>
</span><span class=lnt id=hl-15-29><a class=lnlinks href=#hl-15-29>29</a>
</span><span class=lnt id=hl-15-30><a class=lnlinks href=#hl-15-30>30</a>
</span><span class=lnt id=hl-15-31><a class=lnlinks href=#hl-15-31>31</a>
</span><span class=lnt id=hl-15-32><a class=lnlinks href=#hl-15-32>32</a>
</span><span class=lnt id=hl-15-33><a class=lnlinks href=#hl-15-33>33</a>
</span><span class=lnt id=hl-15-34><a class=lnlinks href=#hl-15-34>34</a>
</span><span class=lnt id=hl-15-35><a class=lnlinks href=#hl-15-35>35</a>
</span><span class=lnt id=hl-15-36><a class=lnlinks href=#hl-15-36>36</a>
</span><span class=lnt id=hl-15-37><a class=lnlinks href=#hl-15-37>37</a>
</span><span class=lnt id=hl-15-38><a class=lnlinks href=#hl-15-38>38</a>
</span><span class=lnt id=hl-15-39><a class=lnlinks href=#hl-15-39>39</a>
</span><span class=lnt id=hl-15-40><a class=lnlinks href=#hl-15-40>40</a>
</span><span class=lnt id=hl-15-41><a class=lnlinks href=#hl-15-41>41</a>
</span><span class=lnt id=hl-15-42><a class=lnlinks href=#hl-15-42>42</a>
</span><span class=lnt id=hl-15-43><a class=lnlinks href=#hl-15-43>43</a>
</span><span class=lnt id=hl-15-44><a class=lnlinks href=#hl-15-44>44</a>
</span><span class=lnt id=hl-15-45><a class=lnlinks href=#hl-15-45>45</a>
</span><span class=lnt id=hl-15-46><a class=lnlinks href=#hl-15-46>46</a>
</span><span class=lnt id=hl-15-47><a class=lnlinks href=#hl-15-47>47</a>
</span><span class=lnt id=hl-15-48><a class=lnlinks href=#hl-15-48>48</a>
</span><span class=lnt id=hl-15-49><a class=lnlinks href=#hl-15-49>49</a>
</span><span class=lnt id=hl-15-50><a class=lnlinks href=#hl-15-50>50</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 이상 탐지 예시 (Python/SciPy)</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scipy</span> <span class=kn>import</span> <span class=n>stats</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AnomalyDetector</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>window_size</span><span class=o>=</span><span class=mi>60</span><span class=p>,</span> <span class=n>threshold</span><span class=o>=</span><span class=mf>3.0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>window_size</span> <span class=o>=</span> <span class=n>window_size</span>  <span class=c1># 분석할 이전 데이터 포인트 수</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>threshold</span> <span class=o>=</span> <span class=n>threshold</span>      <span class=c1># 이상 감지 z-score 임계값</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>history</span> <span class=o>=</span> <span class=p>[]</span>               <span class=c1># 이전 데이터 포인트 저장</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>is_anomaly</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;현재 값이 이상치인지 확인&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 충분한 데이터가 없으면 이상으로 간주하지 않음</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=p>)</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>window_size</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 윈도우 크기 유지</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=p>)</span> <span class=o>&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>window_size</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># z-score 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>mean</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>  <span class=c1># 현재 값을 제외한 평균</span>
</span></span><span class=line><span class=cl>        <span class=n>std</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>history</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>    <span class=c1># 현재 값을 제외한 표준편차</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 표준편차가 0에 가까우면 일정한 값이므로 이상이 아님</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>std</span> <span class=o>&lt;</span> <span class=mf>1e-10</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>z_score</span> <span class=o>=</span> <span class=nb>abs</span><span class=p>((</span><span class=n>value</span> <span class=o>-</span> <span class=n>mean</span><span class=p>)</span> <span class=o>/</span> <span class=n>std</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>z_score</span> <span class=o>&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>threshold</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>response_time_detector</span> <span class=o>=</span> <span class=n>AnomalyDetector</span><span class=p>(</span><span class=n>window_size</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>threshold</span><span class=o>=</span><span class=mf>3.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>monitor_api_response_time</span><span class=p>(</span><span class=n>endpoint</span><span class=p>,</span> <span class=n>response_time</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>response_time_detector</span><span class=o>.</span><span class=n>is_anomaly</span><span class=p>(</span><span class=n>response_time</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;Anomalous response time detected for </span><span class=si>{</span><span class=n>endpoint</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>response_time</span><span class=si>}</span><span class=s2>ms &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;(threshold: </span><span class=si>{</span><span class=n>response_time_detector</span><span class=o>.</span><span class=n>threshold</span><span class=si>}</span><span class=s2> standard deviations)&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 알림 전송</span>
</span></span><span class=line><span class=cl>        <span class=n>send_alert</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>title</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;Anomalous API Response Time: </span><span class=si>{</span><span class=n>endpoint</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>message</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;Response time of </span><span class=si>{</span><span class=n>response_time</span><span class=si>}</span><span class=s2>ms is abnormally high.&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>severity</span><span class=o>=</span><span class=s2>&#34;warning&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=지능형-알림-전략>지능형 알림 전략<a hidden class=anchor aria-hidden=true href=#지능형-알림-전략>#</a></h4><p>컨텍스트 인식 알림과 자동화된 문제 해결 방법을 구현한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1>  1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2>  2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3>  3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4>  4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5>  5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6>  6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7>  7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8>  8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9>  9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10> 10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11> 11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12> 12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13> 13</a>
</span><span class=lnt id=hl-16-14><a class=lnlinks href=#hl-16-14> 14</a>
</span><span class=lnt id=hl-16-15><a class=lnlinks href=#hl-16-15> 15</a>
</span><span class=lnt id=hl-16-16><a class=lnlinks href=#hl-16-16> 16</a>
</span><span class=lnt id=hl-16-17><a class=lnlinks href=#hl-16-17> 17</a>
</span><span class=lnt id=hl-16-18><a class=lnlinks href=#hl-16-18> 18</a>
</span><span class=lnt id=hl-16-19><a class=lnlinks href=#hl-16-19> 19</a>
</span><span class=lnt id=hl-16-20><a class=lnlinks href=#hl-16-20> 20</a>
</span><span class=lnt id=hl-16-21><a class=lnlinks href=#hl-16-21> 21</a>
</span><span class=lnt id=hl-16-22><a class=lnlinks href=#hl-16-22> 22</a>
</span><span class=lnt id=hl-16-23><a class=lnlinks href=#hl-16-23> 23</a>
</span><span class=lnt id=hl-16-24><a class=lnlinks href=#hl-16-24> 24</a>
</span><span class=lnt id=hl-16-25><a class=lnlinks href=#hl-16-25> 25</a>
</span><span class=lnt id=hl-16-26><a class=lnlinks href=#hl-16-26> 26</a>
</span><span class=lnt id=hl-16-27><a class=lnlinks href=#hl-16-27> 27</a>
</span><span class=lnt id=hl-16-28><a class=lnlinks href=#hl-16-28> 28</a>
</span><span class=lnt id=hl-16-29><a class=lnlinks href=#hl-16-29> 29</a>
</span><span class=lnt id=hl-16-30><a class=lnlinks href=#hl-16-30> 30</a>
</span><span class=lnt id=hl-16-31><a class=lnlinks href=#hl-16-31> 31</a>
</span><span class=lnt id=hl-16-32><a class=lnlinks href=#hl-16-32> 32</a>
</span><span class=lnt id=hl-16-33><a class=lnlinks href=#hl-16-33> 33</a>
</span><span class=lnt id=hl-16-34><a class=lnlinks href=#hl-16-34> 34</a>
</span><span class=lnt id=hl-16-35><a class=lnlinks href=#hl-16-35> 35</a>
</span><span class=lnt id=hl-16-36><a class=lnlinks href=#hl-16-36> 36</a>
</span><span class=lnt id=hl-16-37><a class=lnlinks href=#hl-16-37> 37</a>
</span><span class=lnt id=hl-16-38><a class=lnlinks href=#hl-16-38> 38</a>
</span><span class=lnt id=hl-16-39><a class=lnlinks href=#hl-16-39> 39</a>
</span><span class=lnt id=hl-16-40><a class=lnlinks href=#hl-16-40> 40</a>
</span><span class=lnt id=hl-16-41><a class=lnlinks href=#hl-16-41> 41</a>
</span><span class=lnt id=hl-16-42><a class=lnlinks href=#hl-16-42> 42</a>
</span><span class=lnt id=hl-16-43><a class=lnlinks href=#hl-16-43> 43</a>
</span><span class=lnt id=hl-16-44><a class=lnlinks href=#hl-16-44> 44</a>
</span><span class=lnt id=hl-16-45><a class=lnlinks href=#hl-16-45> 45</a>
</span><span class=lnt id=hl-16-46><a class=lnlinks href=#hl-16-46> 46</a>
</span><span class=lnt id=hl-16-47><a class=lnlinks href=#hl-16-47> 47</a>
</span><span class=lnt id=hl-16-48><a class=lnlinks href=#hl-16-48> 48</a>
</span><span class=lnt id=hl-16-49><a class=lnlinks href=#hl-16-49> 49</a>
</span><span class=lnt id=hl-16-50><a class=lnlinks href=#hl-16-50> 50</a>
</span><span class=lnt id=hl-16-51><a class=lnlinks href=#hl-16-51> 51</a>
</span><span class=lnt id=hl-16-52><a class=lnlinks href=#hl-16-52> 52</a>
</span><span class=lnt id=hl-16-53><a class=lnlinks href=#hl-16-53> 53</a>
</span><span class=lnt id=hl-16-54><a class=lnlinks href=#hl-16-54> 54</a>
</span><span class=lnt id=hl-16-55><a class=lnlinks href=#hl-16-55> 55</a>
</span><span class=lnt id=hl-16-56><a class=lnlinks href=#hl-16-56> 56</a>
</span><span class=lnt id=hl-16-57><a class=lnlinks href=#hl-16-57> 57</a>
</span><span class=lnt id=hl-16-58><a class=lnlinks href=#hl-16-58> 58</a>
</span><span class=lnt id=hl-16-59><a class=lnlinks href=#hl-16-59> 59</a>
</span><span class=lnt id=hl-16-60><a class=lnlinks href=#hl-16-60> 60</a>
</span><span class=lnt id=hl-16-61><a class=lnlinks href=#hl-16-61> 61</a>
</span><span class=lnt id=hl-16-62><a class=lnlinks href=#hl-16-62> 62</a>
</span><span class=lnt id=hl-16-63><a class=lnlinks href=#hl-16-63> 63</a>
</span><span class=lnt id=hl-16-64><a class=lnlinks href=#hl-16-64> 64</a>
</span><span class=lnt id=hl-16-65><a class=lnlinks href=#hl-16-65> 65</a>
</span><span class=lnt id=hl-16-66><a class=lnlinks href=#hl-16-66> 66</a>
</span><span class=lnt id=hl-16-67><a class=lnlinks href=#hl-16-67> 67</a>
</span><span class=lnt id=hl-16-68><a class=lnlinks href=#hl-16-68> 68</a>
</span><span class=lnt id=hl-16-69><a class=lnlinks href=#hl-16-69> 69</a>
</span><span class=lnt id=hl-16-70><a class=lnlinks href=#hl-16-70> 70</a>
</span><span class=lnt id=hl-16-71><a class=lnlinks href=#hl-16-71> 71</a>
</span><span class=lnt id=hl-16-72><a class=lnlinks href=#hl-16-72> 72</a>
</span><span class=lnt id=hl-16-73><a class=lnlinks href=#hl-16-73> 73</a>
</span><span class=lnt id=hl-16-74><a class=lnlinks href=#hl-16-74> 74</a>
</span><span class=lnt id=hl-16-75><a class=lnlinks href=#hl-16-75> 75</a>
</span><span class=lnt id=hl-16-76><a class=lnlinks href=#hl-16-76> 76</a>
</span><span class=lnt id=hl-16-77><a class=lnlinks href=#hl-16-77> 77</a>
</span><span class=lnt id=hl-16-78><a class=lnlinks href=#hl-16-78> 78</a>
</span><span class=lnt id=hl-16-79><a class=lnlinks href=#hl-16-79> 79</a>
</span><span class=lnt id=hl-16-80><a class=lnlinks href=#hl-16-80> 80</a>
</span><span class=lnt id=hl-16-81><a class=lnlinks href=#hl-16-81> 81</a>
</span><span class=lnt id=hl-16-82><a class=lnlinks href=#hl-16-82> 82</a>
</span><span class=lnt id=hl-16-83><a class=lnlinks href=#hl-16-83> 83</a>
</span><span class=lnt id=hl-16-84><a class=lnlinks href=#hl-16-84> 84</a>
</span><span class=lnt id=hl-16-85><a class=lnlinks href=#hl-16-85> 85</a>
</span><span class=lnt id=hl-16-86><a class=lnlinks href=#hl-16-86> 86</a>
</span><span class=lnt id=hl-16-87><a class=lnlinks href=#hl-16-87> 87</a>
</span><span class=lnt id=hl-16-88><a class=lnlinks href=#hl-16-88> 88</a>
</span><span class=lnt id=hl-16-89><a class=lnlinks href=#hl-16-89> 89</a>
</span><span class=lnt id=hl-16-90><a class=lnlinks href=#hl-16-90> 90</a>
</span><span class=lnt id=hl-16-91><a class=lnlinks href=#hl-16-91> 91</a>
</span><span class=lnt id=hl-16-92><a class=lnlinks href=#hl-16-92> 92</a>
</span><span class=lnt id=hl-16-93><a class=lnlinks href=#hl-16-93> 93</a>
</span><span class=lnt id=hl-16-94><a class=lnlinks href=#hl-16-94> 94</a>
</span><span class=lnt id=hl-16-95><a class=lnlinks href=#hl-16-95> 95</a>
</span><span class=lnt id=hl-16-96><a class=lnlinks href=#hl-16-96> 96</a>
</span><span class=lnt id=hl-16-97><a class=lnlinks href=#hl-16-97> 97</a>
</span><span class=lnt id=hl-16-98><a class=lnlinks href=#hl-16-98> 98</a>
</span><span class=lnt id=hl-16-99><a class=lnlinks href=#hl-16-99> 99</a>
</span><span class=lnt id=hl-16-100><a class=lnlinks href=#hl-16-100>100</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 지능형 알림 시스템 예시</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SmartAlertSystem</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 알림 상태 저장</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>active_alerts</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=c1># 알림 에스컬레이션 상태</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>escalations</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=c1># 자동 해결 동작</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>auto_remediation_actions</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;high_error_rate&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>restart_service</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;memory_leak&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>increase_memory_limit</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;database_connection_issues&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_db_connections</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_alert</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>alert_type</span><span class=p>,</span> <span class=n>severity</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;알림 처리 및 지능형 라우팅&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>alert_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>alert_type</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>context</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;service&#39;</span><span class=p>,</span> <span class=s1>&#39;unknown&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 이미 활성화된 알림인지 확인</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>alert_key</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>active_alerts</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 기존 알림 상태 업데이트</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>active_alerts</span><span class=p>[</span><span class=n>alert_key</span><span class=p>][</span><span class=s1>&#39;count&#39;</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>active_alerts</span><span class=p>[</span><span class=n>alert_key</span><span class=p>][</span><span class=s1>&#39;last_seen&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 알림이 지속되면 에스컬레이션</span>
</span></span><span class=line><span class=cl>            <span class=n>duration</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>active_alerts</span><span class=p>[</span><span class=n>alert_key</span><span class=p>][</span><span class=s1>&#39;first_seen&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>duration</span> <span class=o>&gt;</span> <span class=mi>900</span> <span class=ow>and</span> <span class=n>alert_key</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>escalations</span><span class=p>:</span>  <span class=c1># 15분 이상 지속</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>escalate_alert</span><span class=p>(</span><span class=n>alert_key</span><span class=p>,</span> <span class=n>context</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 새로운 알림 생성</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>active_alerts</span><span class=p>[</span><span class=n>alert_key</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=n>alert_type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;severity&#39;</span><span class=p>:</span> <span class=n>severity</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;context&#39;</span><span class=p>:</span> <span class=n>context</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;count&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;first_seen&#39;</span><span class=p>:</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;last_seen&#39;</span><span class=p>:</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 즉시 알림</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>send_initial_alert</span><span class=p>(</span><span class=n>alert_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 자동 해결 시도</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>attempt_auto_remediation</span><span class=p>(</span><span class=n>alert_type</span><span class=p>,</span> <span class=n>context</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>escalate_alert</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>alert_key</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;알림 에스컬레이션 - 더 높은 우선순위로 라우팅&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>alert</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>active_alerts</span><span class=p>[</span><span class=n>alert_key</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 에스컬레이션 상태 저장</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>escalations</span><span class=p>[</span><span class=n>alert_key</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;time&#39;</span><span class=p>:</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;previous_severity&#39;</span><span class=p>:</span> <span class=n>alert</span><span class=p>[</span><span class=s1>&#39;severity&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 심각도 상향 조정</span>
</span></span><span class=line><span class=cl>        <span class=n>new_severity</span> <span class=o>=</span> <span class=s1>&#39;critical&#39;</span> <span class=k>if</span> <span class=n>alert</span><span class=p>[</span><span class=s1>&#39;severity&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;warning&#39;</span> <span class=k>else</span> <span class=s1>&#39;emergency&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>alert</span><span class=p>[</span><span class=s1>&#39;severity&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>new_severity</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 상향된 심각도로 알림 전송</span>
</span></span><span class=line><span class=cl>        <span class=n>message</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;ESCALATED ALERT: </span><span class=si>{</span><span class=n>alert</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> issue has been ongoing for &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=nb>int</span><span class=p>((</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>alert</span><span class=p>[</span><span class=s1>&#39;first_seen&#39;</span><span class=p>])</span> <span class=o>/</span> <span class=mi>60</span><span class=p>)</span><span class=si>}</span><span class=s2> minutes. &#34;</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;Occurred </span><span class=si>{</span><span class=n>alert</span><span class=p>[</span><span class=s1>&#39;count&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> times.&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 에스컬레이션 경로에 따라 알림 전송</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>send_escalated_alert</span><span class=p>(</span><span class=n>alert_key</span><span class=p>,</span> <span class=n>message</span><span class=p>,</span> <span class=n>new_severity</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>attempt_auto_remediation</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>alert_type</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;자동 문제 해결 시도&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>alert_type</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>auto_remediation_actions</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>auto_remediation_actions</span><span class=p>[</span><span class=n>alert_type</span><span class=p>](</span><span class=n>context</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>result</span><span class=p>[</span><span class=s1>&#39;success&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=n>log</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                        <span class=sa>f</span><span class=s2>&#34;Auto-remediation for </span><span class=si>{</span><span class=n>alert_type</span><span class=si>}</span><span class=s2> successful: </span><span class=si>{</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;message&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>log</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                        <span class=sa>f</span><span class=s2>&#34;Auto-remediation for </span><span class=si>{</span><span class=n>alert_type</span><span class=si>}</span><span class=s2> failed: </span><span class=si>{</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;message&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>log</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error during auto-remediation for </span><span class=si>{</span><span class=n>alert_type</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 자동 해결 동작 구현</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>restart_service</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>service_name</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;service&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 서비스 재시작 로직…</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;success&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;Service </span><span class=si>{</span><span class=n>service_name</span><span class=si>}</span><span class=s2> restarted successfully&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>increase_memory_limit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>service_name</span> <span class=o>=</span> <span class=n>context</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;service&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 메모리 한도 증가 로직…</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;success&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;Memory limit for </span><span class=si>{</span><span class=n>service_name</span><span class=si>}</span><span class=s2> increased&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>check_db_connections</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 데이터베이스 연결 풀 확인 및 리셋 로직…</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;success&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=s2>&#34;Database connection pool reset&#34;</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사용자-행동-분석>사용자 행동 분석<a hidden class=anchor aria-hidden=true href=#사용자-행동-분석>#</a></h4><p>API 사용 패턴을 분석하여 사용자 행동과 요구사항을 더 잘 이해한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1>  1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2>  2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3>  3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4>  4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5>  5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6>  6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7>  7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8>  8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9>  9</a>
</span><span class=lnt id=hl-17-10><a class=lnlinks href=#hl-17-10> 10</a>
</span><span class=lnt id=hl-17-11><a class=lnlinks href=#hl-17-11> 11</a>
</span><span class=lnt id=hl-17-12><a class=lnlinks href=#hl-17-12> 12</a>
</span><span class=lnt id=hl-17-13><a class=lnlinks href=#hl-17-13> 13</a>
</span><span class=lnt id=hl-17-14><a class=lnlinks href=#hl-17-14> 14</a>
</span><span class=lnt id=hl-17-15><a class=lnlinks href=#hl-17-15> 15</a>
</span><span class=lnt id=hl-17-16><a class=lnlinks href=#hl-17-16> 16</a>
</span><span class=lnt id=hl-17-17><a class=lnlinks href=#hl-17-17> 17</a>
</span><span class=lnt id=hl-17-18><a class=lnlinks href=#hl-17-18> 18</a>
</span><span class=lnt id=hl-17-19><a class=lnlinks href=#hl-17-19> 19</a>
</span><span class=lnt id=hl-17-20><a class=lnlinks href=#hl-17-20> 20</a>
</span><span class=lnt id=hl-17-21><a class=lnlinks href=#hl-17-21> 21</a>
</span><span class=lnt id=hl-17-22><a class=lnlinks href=#hl-17-22> 22</a>
</span><span class=lnt id=hl-17-23><a class=lnlinks href=#hl-17-23> 23</a>
</span><span class=lnt id=hl-17-24><a class=lnlinks href=#hl-17-24> 24</a>
</span><span class=lnt id=hl-17-25><a class=lnlinks href=#hl-17-25> 25</a>
</span><span class=lnt id=hl-17-26><a class=lnlinks href=#hl-17-26> 26</a>
</span><span class=lnt id=hl-17-27><a class=lnlinks href=#hl-17-27> 27</a>
</span><span class=lnt id=hl-17-28><a class=lnlinks href=#hl-17-28> 28</a>
</span><span class=lnt id=hl-17-29><a class=lnlinks href=#hl-17-29> 29</a>
</span><span class=lnt id=hl-17-30><a class=lnlinks href=#hl-17-30> 30</a>
</span><span class=lnt id=hl-17-31><a class=lnlinks href=#hl-17-31> 31</a>
</span><span class=lnt id=hl-17-32><a class=lnlinks href=#hl-17-32> 32</a>
</span><span class=lnt id=hl-17-33><a class=lnlinks href=#hl-17-33> 33</a>
</span><span class=lnt id=hl-17-34><a class=lnlinks href=#hl-17-34> 34</a>
</span><span class=lnt id=hl-17-35><a class=lnlinks href=#hl-17-35> 35</a>
</span><span class=lnt id=hl-17-36><a class=lnlinks href=#hl-17-36> 36</a>
</span><span class=lnt id=hl-17-37><a class=lnlinks href=#hl-17-37> 37</a>
</span><span class=lnt id=hl-17-38><a class=lnlinks href=#hl-17-38> 38</a>
</span><span class=lnt id=hl-17-39><a class=lnlinks href=#hl-17-39> 39</a>
</span><span class=lnt id=hl-17-40><a class=lnlinks href=#hl-17-40> 40</a>
</span><span class=lnt id=hl-17-41><a class=lnlinks href=#hl-17-41> 41</a>
</span><span class=lnt id=hl-17-42><a class=lnlinks href=#hl-17-42> 42</a>
</span><span class=lnt id=hl-17-43><a class=lnlinks href=#hl-17-43> 43</a>
</span><span class=lnt id=hl-17-44><a class=lnlinks href=#hl-17-44> 44</a>
</span><span class=lnt id=hl-17-45><a class=lnlinks href=#hl-17-45> 45</a>
</span><span class=lnt id=hl-17-46><a class=lnlinks href=#hl-17-46> 46</a>
</span><span class=lnt id=hl-17-47><a class=lnlinks href=#hl-17-47> 47</a>
</span><span class=lnt id=hl-17-48><a class=lnlinks href=#hl-17-48> 48</a>
</span><span class=lnt id=hl-17-49><a class=lnlinks href=#hl-17-49> 49</a>
</span><span class=lnt id=hl-17-50><a class=lnlinks href=#hl-17-50> 50</a>
</span><span class=lnt id=hl-17-51><a class=lnlinks href=#hl-17-51> 51</a>
</span><span class=lnt id=hl-17-52><a class=lnlinks href=#hl-17-52> 52</a>
</span><span class=lnt id=hl-17-53><a class=lnlinks href=#hl-17-53> 53</a>
</span><span class=lnt id=hl-17-54><a class=lnlinks href=#hl-17-54> 54</a>
</span><span class=lnt id=hl-17-55><a class=lnlinks href=#hl-17-55> 55</a>
</span><span class=lnt id=hl-17-56><a class=lnlinks href=#hl-17-56> 56</a>
</span><span class=lnt id=hl-17-57><a class=lnlinks href=#hl-17-57> 57</a>
</span><span class=lnt id=hl-17-58><a class=lnlinks href=#hl-17-58> 58</a>
</span><span class=lnt id=hl-17-59><a class=lnlinks href=#hl-17-59> 59</a>
</span><span class=lnt id=hl-17-60><a class=lnlinks href=#hl-17-60> 60</a>
</span><span class=lnt id=hl-17-61><a class=lnlinks href=#hl-17-61> 61</a>
</span><span class=lnt id=hl-17-62><a class=lnlinks href=#hl-17-62> 62</a>
</span><span class=lnt id=hl-17-63><a class=lnlinks href=#hl-17-63> 63</a>
</span><span class=lnt id=hl-17-64><a class=lnlinks href=#hl-17-64> 64</a>
</span><span class=lnt id=hl-17-65><a class=lnlinks href=#hl-17-65> 65</a>
</span><span class=lnt id=hl-17-66><a class=lnlinks href=#hl-17-66> 66</a>
</span><span class=lnt id=hl-17-67><a class=lnlinks href=#hl-17-67> 67</a>
</span><span class=lnt id=hl-17-68><a class=lnlinks href=#hl-17-68> 68</a>
</span><span class=lnt id=hl-17-69><a class=lnlinks href=#hl-17-69> 69</a>
</span><span class=lnt id=hl-17-70><a class=lnlinks href=#hl-17-70> 70</a>
</span><span class=lnt id=hl-17-71><a class=lnlinks href=#hl-17-71> 71</a>
</span><span class=lnt id=hl-17-72><a class=lnlinks href=#hl-17-72> 72</a>
</span><span class=lnt id=hl-17-73><a class=lnlinks href=#hl-17-73> 73</a>
</span><span class=lnt id=hl-17-74><a class=lnlinks href=#hl-17-74> 74</a>
</span><span class=lnt id=hl-17-75><a class=lnlinks href=#hl-17-75> 75</a>
</span><span class=lnt id=hl-17-76><a class=lnlinks href=#hl-17-76> 76</a>
</span><span class=lnt id=hl-17-77><a class=lnlinks href=#hl-17-77> 77</a>
</span><span class=lnt id=hl-17-78><a class=lnlinks href=#hl-17-78> 78</a>
</span><span class=lnt id=hl-17-79><a class=lnlinks href=#hl-17-79> 79</a>
</span><span class=lnt id=hl-17-80><a class=lnlinks href=#hl-17-80> 80</a>
</span><span class=lnt id=hl-17-81><a class=lnlinks href=#hl-17-81> 81</a>
</span><span class=lnt id=hl-17-82><a class=lnlinks href=#hl-17-82> 82</a>
</span><span class=lnt id=hl-17-83><a class=lnlinks href=#hl-17-83> 83</a>
</span><span class=lnt id=hl-17-84><a class=lnlinks href=#hl-17-84> 84</a>
</span><span class=lnt id=hl-17-85><a class=lnlinks href=#hl-17-85> 85</a>
</span><span class=lnt id=hl-17-86><a class=lnlinks href=#hl-17-86> 86</a>
</span><span class=lnt id=hl-17-87><a class=lnlinks href=#hl-17-87> 87</a>
</span><span class=lnt id=hl-17-88><a class=lnlinks href=#hl-17-88> 88</a>
</span><span class=lnt id=hl-17-89><a class=lnlinks href=#hl-17-89> 89</a>
</span><span class=lnt id=hl-17-90><a class=lnlinks href=#hl-17-90> 90</a>
</span><span class=lnt id=hl-17-91><a class=lnlinks href=#hl-17-91> 91</a>
</span><span class=lnt id=hl-17-92><a class=lnlinks href=#hl-17-92> 92</a>
</span><span class=lnt id=hl-17-93><a class=lnlinks href=#hl-17-93> 93</a>
</span><span class=lnt id=hl-17-94><a class=lnlinks href=#hl-17-94> 94</a>
</span><span class=lnt id=hl-17-95><a class=lnlinks href=#hl-17-95> 95</a>
</span><span class=lnt id=hl-17-96><a class=lnlinks href=#hl-17-96> 96</a>
</span><span class=lnt id=hl-17-97><a class=lnlinks href=#hl-17-97> 97</a>
</span><span class=lnt id=hl-17-98><a class=lnlinks href=#hl-17-98> 98</a>
</span><span class=lnt id=hl-17-99><a class=lnlinks href=#hl-17-99> 99</a>
</span><span class=lnt id=hl-17-100><a class=lnlinks href=#hl-17-100>100</a>
</span><span class=lnt id=hl-17-101><a class=lnlinks href=#hl-17-101>101</a>
</span><span class=lnt id=hl-17-102><a class=lnlinks href=#hl-17-102>102</a>
</span><span class=lnt id=hl-17-103><a class=lnlinks href=#hl-17-103>103</a>
</span><span class=lnt id=hl-17-104><a class=lnlinks href=#hl-17-104>104</a>
</span><span class=lnt id=hl-17-105><a class=lnlinks href=#hl-17-105>105</a>
</span><span class=lnt id=hl-17-106><a class=lnlinks href=#hl-17-106>106</a>
</span><span class=lnt id=hl-17-107><a class=lnlinks href=#hl-17-107>107</a>
</span><span class=lnt id=hl-17-108><a class=lnlinks href=#hl-17-108>108</a>
</span><span class=lnt id=hl-17-109><a class=lnlinks href=#hl-17-109>109</a>
</span><span class=lnt id=hl-17-110><a class=lnlinks href=#hl-17-110>110</a>
</span><span class=lnt id=hl-17-111><a class=lnlinks href=#hl-17-111>111</a>
</span><span class=lnt id=hl-17-112><a class=lnlinks href=#hl-17-112>112</a>
</span><span class=lnt id=hl-17-113><a class=lnlinks href=#hl-17-113>113</a>
</span><span class=lnt id=hl-17-114><a class=lnlinks href=#hl-17-114>114</a>
</span><span class=lnt id=hl-17-115><a class=lnlinks href=#hl-17-115>115</a>
</span><span class=lnt id=hl-17-116><a class=lnlinks href=#hl-17-116>116</a>
</span><span class=lnt id=hl-17-117><a class=lnlinks href=#hl-17-117>117</a>
</span><span class=lnt id=hl-17-118><a class=lnlinks href=#hl-17-118>118</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// API 사용자 행동 분석 예시 (Node.js)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>class</span> <span class=nx>APIUsageAnalytics</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>sessionData</span> <span class=o>=</span> <span class=p>{};</span>  <span class=c1>// 세션별 데이터 저장
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>this</span><span class=p>.</span><span class=nx>userPatterns</span> <span class=o>=</span> <span class=p>{};</span> <span class=c1>// 사용자별 패턴 저장
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>trackRequest</span><span class=p>(</span><span class=nx>userId</span><span class=p>,</span> <span class=nx>sessionId</span><span class=p>,</span> <span class=nx>endpoint</span><span class=p>,</span> <span class=nx>method</span><span class=p>,</span> <span class=nx>timestamp</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 세션 데이터 초기화
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=k>this</span><span class=p>.</span><span class=nx>sessionData</span><span class=p>[</span><span class=nx>sessionId</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>sessionData</span><span class=p>[</span><span class=nx>sessionId</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>userId</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>startTime</span><span class=o>:</span> <span class=nx>timestamp</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>lastActivity</span><span class=o>:</span> <span class=nx>timestamp</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>requests</span><span class=o>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>        <span class=nx>endpoints</span><span class=o>:</span> <span class=k>new</span> <span class=nx>Set</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 요청 추적
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>this</span><span class=p>.</span><span class=nx>sessionData</span><span class=p>[</span><span class=nx>sessionId</span><span class=p>].</span><span class=nx>requests</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>endpoint</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>method</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>timestamp</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>sessionData</span><span class=p>[</span><span class=nx>sessionId</span><span class=p>].</span><span class=nx>endpoints</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>endpoint</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>sessionData</span><span class=p>[</span><span class=nx>sessionId</span><span class=p>].</span><span class=nx>lastActivity</span> <span class=o>=</span> <span class=nx>timestamp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 사용자 패턴 업데이트
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=k>this</span><span class=p>.</span><span class=nx>userPatterns</span><span class=p>[</span><span class=nx>userId</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>userPatterns</span><span class=p>[</span><span class=nx>userId</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>frequentEndpoints</span><span class=o>:</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>        <span class=nx>typicalSessionLength</span><span class=o>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>        <span class=nx>commonFlows</span><span class=o>:</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>      <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 엔드포인트 사용 빈도 추적
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>endpoints</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>userPatterns</span><span class=p>[</span><span class=nx>userId</span><span class=p>].</span><span class=nx>frequentEndpoints</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>endpoints</span><span class=p>[</span><span class=nx>endpoint</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=nx>endpoints</span><span class=p>[</span><span class=nx>endpoint</span><span class=p>]</span> <span class=o>||</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 흐름 분석 (순차적 API 호출 패턴)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>session</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>sessionData</span><span class=p>[</span><span class=nx>sessionId</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>session</span><span class=p>.</span><span class=nx>requests</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;=</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>prevRequest</span> <span class=o>=</span> <span class=nx>session</span><span class=p>.</span><span class=nx>requests</span><span class=p>[</span><span class=nx>session</span><span class=p>.</span><span class=nx>requests</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>flow</span> <span class=o>=</span> <span class=sb>`</span><span class=si>${</span><span class=nx>prevRequest</span><span class=p>.</span><span class=nx>endpoint</span><span class=si>}</span><span class=sb> -&gt; </span><span class=si>${</span><span class=nx>endpoint</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>flows</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>userPatterns</span><span class=p>[</span><span class=nx>userId</span><span class=p>].</span><span class=nx>commonFlows</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>flows</span><span class=p>[</span><span class=nx>flow</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=nx>flows</span><span class=p>[</span><span class=nx>flow</span><span class=p>]</span> <span class=o>||</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>analyzeSession</span><span class=p>(</span><span class=nx>sessionId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>session</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>sessionData</span><span class=p>[</span><span class=nx>sessionId</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>session</span><span class=p>)</span> <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>sessionLength</span> <span class=o>=</span> <span class=nx>session</span><span class=p>.</span><span class=nx>lastActivity</span> <span class=o>-</span> <span class=nx>session</span><span class=p>.</span><span class=nx>startTime</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>userId</span> <span class=o>=</span> <span class=nx>session</span><span class=p>.</span><span class=nx>userId</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 세션 길이 추적
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>this</span><span class=p>.</span><span class=nx>userPatterns</span><span class=p>[</span><span class=nx>userId</span><span class=p>].</span><span class=nx>typicalSessionLength</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>sessionLength</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 세션 분석 결과 반환
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>userId</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>duration</span><span class=o>:</span> <span class=nx>sessionLength</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>requestCount</span><span class=o>:</span> <span class=nx>session</span><span class=p>.</span><span class=nx>requests</span><span class=p>.</span><span class=nx>length</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>uniqueEndpoints</span><span class=o>:</span> <span class=nx>session</span><span class=p>.</span><span class=nx>endpoints</span><span class=p>.</span><span class=nx>size</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>mostFrequentEndpoint</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>getMostFrequent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>session</span><span class=p>.</span><span class=nx>requests</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>r</span> <span class=p>=&gt;</span> <span class=nx>r</span><span class=p>.</span><span class=nx>endpoint</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>getUserInsights</span><span class=p>(</span><span class=nx>userId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>patterns</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>userPatterns</span><span class=p>[</span><span class=nx>userId</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>patterns</span><span class=p>)</span> <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 가장 자주 사용하는 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>frequentEndpoints</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>entries</span><span class=p>(</span><span class=nx>patterns</span><span class=p>.</span><span class=nx>frequentEndpoints</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>sort</span><span class=p>((</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>b</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=nx>a</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>5</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 평균 세션 길이
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>avgSessionLength</span> <span class=o>=</span> <span class=nx>patterns</span><span class=p>.</span><span class=nx>typicalSessionLength</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>      <span class=o>?</span> <span class=nx>patterns</span><span class=p>.</span><span class=nx>typicalSessionLength</span><span class=p>.</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>sum</span><span class=p>,</span> <span class=nx>len</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>sum</span> <span class=o>+</span> <span class=nx>len</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>/</span> <span class=nx>patterns</span><span class=p>.</span><span class=nx>typicalSessionLength</span><span class=p>.</span><span class=nx>length</span>
</span></span><span class=line><span class=cl>      <span class=o>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 일반적인 API 사용 흐름
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>commonFlows</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>entries</span><span class=p>(</span><span class=nx>patterns</span><span class=p>.</span><span class=nx>commonFlows</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>sort</span><span class=p>((</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>b</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=nx>a</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>      <span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>5</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>userId</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>topEndpoints</span><span class=o>:</span> <span class=nx>frequentEndpoints</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>averageSessionLength</span><span class=o>:</span> <span class=nx>avgSessionLength</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>typicalFlows</span><span class=o>:</span> <span class=nx>commonFlows</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>getMostFrequent</span><span class=p>(</span><span class=nx>arr</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>counts</span> <span class=o>=</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>maxItem</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>maxCount</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kr>const</span> <span class=nx>item</span> <span class=k>of</span> <span class=nx>arr</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>counts</span><span class=p>[</span><span class=nx>item</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=nx>counts</span><span class=p>[</span><span class=nx>item</span><span class=p>]</span> <span class=o>||</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>counts</span><span class=p>[</span><span class=nx>item</span><span class=p>]</span> <span class=o>&gt;</span> <span class=nx>maxCount</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>maxItem</span> <span class=o>=</span> <span class=nx>item</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>maxCount</span> <span class=o>=</span> <span class=nx>counts</span><span class=p>[</span><span class=nx>item</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>maxItem</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=api-모니터링을-위한-조직-문화-및-프로세스>API 모니터링을 위한 조직 문화 및 프로세스<a hidden class=anchor aria-hidden=true href=#api-모니터링을-위한-조직-문화-및-프로세스>#</a></h3><h4 id=관찰성-문화-구축>관찰성 문화 구축<a hidden class=anchor aria-hidden=true href=#관찰성-문화-구축>#</a></h4><p>모니터링에 그치지 않고 더 넓은 관찰성(Observability) 문화를 조직에 정착시킨다.</p><p><strong>핵심 원칙</strong>:</p><ul><li><strong>관찰성 중심 설계</strong>: API 설계 단계부터 관찰성 고려</li><li><strong>로그, 메트릭, 트레이스의 통합</strong>: &ldquo;3대 관찰성 기둥&rdquo; 통합 접근법</li><li><strong>가시성 민주화</strong>: 모든 팀원이 모니터링 도구에 접근 가능하게 함</li><li><strong>지속적 개선</strong>: 인시던트에서 배운 교훈을 통해 모니터링 전략 개선</li></ul><h4 id=sresite-reliability-engineering-원칙-적용>SRE(Site Reliability Engineering) 원칙 적용<a hidden class=anchor aria-hidden=true href=#sresite-reliability-engineering-원칙-적용>#</a></h4><p>Google의 SRE 원칙을 API 모니터링에 적용한다.</p><p><strong>주요 개념</strong>:</p><ul><li><strong>서비스 수준 목표(SLO) 정의</strong>: 명확한 성능 및 가용성 목표 설정</li><li><strong>오류 예산</strong>: 허용 가능한 서비스 중단 또는 성능 저하의 한도 설정</li><li><strong>점진적 알림</strong>: 심각도에 따른 단계적 알림 전략</li><li><strong>포스트모템 문화</strong>: 장애 후 비난 없는 분석 및 학습</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1> 1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2> 2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3> 3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4> 4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5> 5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6> 6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7> 7</a>
</span><span class=lnt id=hl-18-8><a class=lnlinks href=#hl-18-8> 8</a>
</span><span class=lnt id=hl-18-9><a class=lnlinks href=#hl-18-9> 9</a>
</span><span class=lnt id=hl-18-10><a class=lnlinks href=#hl-18-10>10</a>
</span><span class=lnt id=hl-18-11><a class=lnlinks href=#hl-18-11>11</a>
</span><span class=lnt id=hl-18-12><a class=lnlinks href=#hl-18-12>12</a>
</span><span class=lnt id=hl-18-13><a class=lnlinks href=#hl-18-13>13</a>
</span><span class=lnt id=hl-18-14><a class=lnlinks href=#hl-18-14>14</a>
</span><span class=lnt id=hl-18-15><a class=lnlinks href=#hl-18-15>15</a>
</span><span class=lnt id=hl-18-16><a class=lnlinks href=#hl-18-16>16</a>
</span><span class=lnt id=hl-18-17><a class=lnlinks href=#hl-18-17>17</a>
</span><span class=lnt id=hl-18-18><a class=lnlinks href=#hl-18-18>18</a>
</span><span class=lnt id=hl-18-19><a class=lnlinks href=#hl-18-19>19</a>
</span><span class=lnt id=hl-18-20><a class=lnlinks href=#hl-18-20>20</a>
</span><span class=lnt id=hl-18-21><a class=lnlinks href=#hl-18-21>21</a>
</span><span class=lnt id=hl-18-22><a class=lnlinks href=#hl-18-22>22</a>
</span><span class=lnt id=hl-18-23><a class=lnlinks href=#hl-18-23>23</a>
</span><span class=lnt id=hl-18-24><a class=lnlinks href=#hl-18-24>24</a>
</span><span class=lnt id=hl-18-25><a class=lnlinks href=#hl-18-25>25</a>
</span><span class=lnt id=hl-18-26><a class=lnlinks href=#hl-18-26>26</a>
</span><span class=lnt id=hl-18-27><a class=lnlinks href=#hl-18-27>27</a>
</span><span class=lnt id=hl-18-28><a class=lnlinks href=#hl-18-28>28</a>
</span><span class=lnt id=hl-18-29><a class=lnlinks href=#hl-18-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># SLO 정의 예시 (yaml 형식)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w> </span><span class=l>user-api</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>slos</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>availability</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>target</span><span class=p>:</span><span class=w> </span><span class=m>99.9</span><span class=l>% </span><span class=w> </span><span class=c># 월간 목표 가용성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metric</span><span class=p>:</span><span class=w> </span><span class=l>api_success_rate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>measurement</span><span class=p>:</span><span class=w> </span><span class=l>ratio of successful to total requests</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>window</span><span class=p>:</span><span class=w> </span><span class=l>30d </span><span class=w> </span><span class=c># 30일 측정 기간</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>latency</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>target</span><span class=p>:</span><span class=w> </span><span class=m>95</span><span class=l>% </span><span class=w> </span><span class=c># 요청의 95%가 임계값 이내여야 함</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metric</span><span class=p>:</span><span class=w> </span><span class=l>api_request_duration_ms</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>measurement</span><span class=p>:</span><span class=w> </span><span class=l>percentage of requests under threshold</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>threshold</span><span class=p>:</span><span class=w> </span><span class=l>300ms </span><span class=w> </span><span class=c># 300밀리초 임계값</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>window</span><span class=p>:</span><span class=w> </span><span class=l>30d </span><span class=w> </span><span class=c># 30일 측정 기간</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>error_budget</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>policy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># 오류 예산의 50%를 소진하면 릴리스 속도 줄이기</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>consumption</span><span class=p>:</span><span class=w> </span><span class=m>50</span><span class=l>%</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Reduce release velocity by 50%&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># 오류 예산의 75%를 소진하면 예정된 기능 릴리스 중단</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>consumption</span><span class=p>:</span><span class=w> </span><span class=m>75</span><span class=l>%</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Pause feature releases, focus on reliability improvements&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># 오류 예산의 90%를 소진하면 긴급 대응 모드 진입</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>consumption</span><span class=p>:</span><span class=w> </span><span class=m>90</span><span class=l>%</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Enter emergency response mode, all teams focus on reliability&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=3-devops-통합-및-자동화>3. DevOps 통합 및 자동화<a hidden class=anchor aria-hidden=true href=#3-devops-통합-및-자동화>#</a></h4><p>CI/CD 파이프라인에 모니터링 및 알림을 통합하여 개발과 운영 사이의 격차를 줄인다.</p><p><strong>핵심 전략</strong>:</p><ol><li><strong>배포 전 성능 테스트</strong>: 자동화된 성능 테스트를, 빌드 프로세스에 통합</li><li><strong>카나리 배포</strong>: 소규모 사용자 그룹에 새 버전을 점진적으로 출시하며 모니터링</li><li><strong>자동 롤백</strong>: 성능 저하 시 자동으로 이전 버전으로 롤백</li><li><strong>인프라스트럭처 코드화</strong>: 모니터링 구성도 코드화하여 버전 관리</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12>12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13>13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14>14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15>15</a>
</span><span class=lnt id=hl-19-16><a class=lnlinks href=#hl-19-16>16</a>
</span><span class=lnt id=hl-19-17><a class=lnlinks href=#hl-19-17>17</a>
</span><span class=lnt id=hl-19-18><a class=lnlinks href=#hl-19-18>18</a>
</span><span class=lnt id=hl-19-19><a class=lnlinks href=#hl-19-19>19</a>
</span><span class=lnt id=hl-19-20><a class=lnlinks href=#hl-19-20>20</a>
</span><span class=lnt id=hl-19-21><a class=lnlinks href=#hl-19-21>21</a>
</span><span class=lnt id=hl-19-22><a class=lnlinks href=#hl-19-22>22</a>
</span><span class=lnt id=hl-19-23><a class=lnlinks href=#hl-19-23>23</a>
</span><span class=lnt id=hl-19-24><a class=lnlinks href=#hl-19-24>24</a>
</span><span class=lnt id=hl-19-25><a class=lnlinks href=#hl-19-25>25</a>
</span><span class=lnt id=hl-19-26><a class=lnlinks href=#hl-19-26>26</a>
</span><span class=lnt id=hl-19-27><a class=lnlinks href=#hl-19-27>27</a>
</span><span class=lnt id=hl-19-28><a class=lnlinks href=#hl-19-28>28</a>
</span><span class=lnt id=hl-19-29><a class=lnlinks href=#hl-19-29>29</a>
</span><span class=lnt id=hl-19-30><a class=lnlinks href=#hl-19-30>30</a>
</span><span class=lnt id=hl-19-31><a class=lnlinks href=#hl-19-31>31</a>
</span><span class=lnt id=hl-19-32><a class=lnlinks href=#hl-19-32>32</a>
</span><span class=lnt id=hl-19-33><a class=lnlinks href=#hl-19-33>33</a>
</span><span class=lnt id=hl-19-34><a class=lnlinks href=#hl-19-34>34</a>
</span><span class=lnt id=hl-19-35><a class=lnlinks href=#hl-19-35>35</a>
</span><span class=lnt id=hl-19-36><a class=lnlinks href=#hl-19-36>36</a>
</span><span class=lnt id=hl-19-37><a class=lnlinks href=#hl-19-37>37</a>
</span><span class=lnt id=hl-19-38><a class=lnlinks href=#hl-19-38>38</a>
</span><span class=lnt id=hl-19-39><a class=lnlinks href=#hl-19-39>39</a>
</span><span class=lnt id=hl-19-40><a class=lnlinks href=#hl-19-40>40</a>
</span><span class=lnt id=hl-19-41><a class=lnlinks href=#hl-19-41>41</a>
</span><span class=lnt id=hl-19-42><a class=lnlinks href=#hl-19-42>42</a>
</span><span class=lnt id=hl-19-43><a class=lnlinks href=#hl-19-43>43</a>
</span><span class=lnt id=hl-19-44><a class=lnlinks href=#hl-19-44>44</a>
</span><span class=lnt id=hl-19-45><a class=lnlinks href=#hl-19-45>45</a>
</span><span class=lnt id=hl-19-46><a class=lnlinks href=#hl-19-46>46</a>
</span><span class=lnt id=hl-19-47><a class=lnlinks href=#hl-19-47>47</a>
</span><span class=lnt id=hl-19-48><a class=lnlinks href=#hl-19-48>48</a>
</span><span class=lnt id=hl-19-49><a class=lnlinks href=#hl-19-49>49</a>
</span><span class=lnt id=hl-19-50><a class=lnlinks href=#hl-19-50>50</a>
</span><span class=lnt id=hl-19-51><a class=lnlinks href=#hl-19-51>51</a>
</span><span class=lnt id=hl-19-52><a class=lnlinks href=#hl-19-52>52</a>
</span><span class=lnt id=hl-19-53><a class=lnlinks href=#hl-19-53>53</a>
</span><span class=lnt id=hl-19-54><a class=lnlinks href=#hl-19-54>54</a>
</span><span class=lnt id=hl-19-55><a class=lnlinks href=#hl-19-55>55</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># GitHub Actions를 사용한 API 모니터링 CI/CD 통합 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>API Deploy and Monitor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=l>main ]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>test</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Setup environment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>docker-compose up -d</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Run unit and integration tests</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>npm test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Performance baseline test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          npm run perf-test
</span></span></span><span class=line><span class=cl><span class=sd>          node scripts/analyze-performance.js --fail-threshold=10</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>needs</span><span class=p>:</span><span class=w> </span><span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy to 10% of production (canary)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>./deploy.sh --environment=production --canary=10</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Monitor canary deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          # 15분 동안 카나리 배포 모니터링
</span></span></span><span class=line><span class=cl><span class=sd>          ./monitor-deployment.sh --duration=15m --environment=canary</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Check error budget consumption</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          ERROR_BUDGET_CONSUMPTION=$(curl -s https://monitoring-api.example.com/error-budget)
</span></span></span><span class=line><span class=cl><span class=sd>          if [ $ERROR_BUDGET_CONSUMPTION -gt 80 ]; then
</span></span></span><span class=line><span class=cl><span class=sd>            echo &#34;Error budget consumption too high: $ERROR_BUDGET_CONSUMPTION%&#34;
</span></span></span><span class=line><span class=cl><span class=sd>            ./rollback.sh --environment=production
</span></span></span><span class=line><span class=cl><span class=sd>            exit 1
</span></span></span><span class=line><span class=cl><span class=sd>          fi</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Complete rollout to production</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>success()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>./deploy.sh --environment=production --complete-rollout</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Configure monitoring alerts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          # 새로운 배포에 대한 모니터링 알림 설정
</span></span></span><span class=line><span class=cl><span class=sd>          ./configure-alerts.sh --version=$(git rev-parse --short HEAD)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>가용성(Availability)</td><td>IT와 소프트웨어 시스템에서 <strong>서비스, 시스템, 또는 애플리케이션이 사용자에게 정상적으로 접근 가능하고 동작 가능한 상태를 유지하는 능력</strong>을 의미한다. 이는 시스템의 신뢰성과 안정성을 나타내는 중요한 지표 중 하나로, 특히 클라우드 컴퓨팅, 네트워크, 데이터센터, 웹 애플리케이션 등에서 핵심적인 성능 척도로 사용된다.<br>- <strong>공식적인 정의</strong>:<br>가용성은 특정 시간 동안 시스템이 정상적으로 작동하여 사용자 요청을 처리할 수 있는 비율을 나타낸다.<br><strong>수식</strong>:<br>가용성 (%)=(정상 작동 시간 / 전체 시간)×100<br>- <strong>예시</strong>:<br>- 하루(24시간) 중 시스템이 23시간 55분 동안 정상 작동했다면:<br>가용성 (%)=(1435 / 1440)×100=99.65%<br><strong>가용성의 중요성</strong><br>1. <strong>사용자 경험 개선</strong>:<br>- 높은 가용성은 서비스 중단 없이 사용자에게 안정적인 경험을 제공한다.<br>- 예: 전자상거래 사이트가 항상 접근 가능해야 고객이 구매를 완료할 수 있음.<br>2. <strong>비즈니스 연속성 보장</strong>:<br>- 서비스 중단은 매출 손실과 고객 신뢰도 저하로 이어질 수 있다.<br>- 예: 금융 서비스나 의료 시스템에서 가용성 부족은 심각한 문제를 초래할 수 있음.<br>3. <strong>서비스 수준 계약(SLA) 준수</strong>:<br>- 서비스 제공자는 SLA에서 명시된 가용성을 보장해야 하며, 이를 충족하지 못하면 페널티를 지불해야 할 수도 있다.</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/backend-development/>Backend Development</a></li><li><a href=https://buenhyden.github.io/tags/api-design-and-implementation/>API-Design-and-Implementation</a></li><li><a href=https://buenhyden.github.io/tags/api-performance/>API-Performance</a></li><li><a href=https://buenhyden.github.io/tags/profiling-and-monitoring/>Profiling-and-Monitoring</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/computer-science-fundamentals/networking-knowledge/real-time-apis/types-of-real-time-apis/><span class=title>« Prev</span><br><span>Types of Real-time APIs</span>
</a><a class=next href=https://buenhyden.github.io/posts/backend-development/api-design-and-implementation/api-monitoring-and-analytics/api-profiling/><span class=title>Next »</span><br><span>Profiling</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>