<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Event Brokers | hyunyoun's Blog</title><meta name=keywords content="Backend-Development,Event-and-Message-Brokers,Fundamentals,Event-Brokers"><meta name=description content="Event Broker는 이벤트 생성자(Producer)와 이벤트 소비자(Consumer) 사이에서 중개자 역할을 수행한다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/backend-development/event-and-message-brokers/fundamentals/event-brokers/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/backend-development/event-and-message-brokers/fundamentals/event-brokers/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/backend-development/event-and-message-brokers/fundamentals/event-brokers/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Event Brokers"><meta property="og:description" content="Event Broker는 이벤트 생성자(Producer)와 이벤트 소비자(Consumer) 사이에서 중개자 역할을 수행한다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-10-25T06:28:00+00:00"><meta property="article:modified_time" content="2024-10-25T06:28:00+00:00"><meta property="article:tag" content="Backend-Development"><meta property="article:tag" content="Event-and-Message-Brokers"><meta property="article:tag" content="Fundamentals"><meta property="article:tag" content="Event-Brokers"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Event Brokers"><meta name=twitter:description content="Event Broker는 이벤트 생성자(Producer)와 이벤트 소비자(Consumer) 사이에서 중개자 역할을 수행한다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"기술 블로그","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Backend Development","item":"https://buenhyden.github.io/posts/backend-development/"},{"@type":"ListItem","position":3,"name":"Event and Message Brokers","item":"https://buenhyden.github.io/posts/backend-development/event-and-message-brokers/"},{"@type":"ListItem","position":4,"name":"Event Brokers","item":"https://buenhyden.github.io/posts/backend-development/event-and-message-brokers/fundamentals/event-brokers/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Event Brokers","name":"Event Brokers","description":"Event Broker는 이벤트 생성자(Producer)와 이벤트 소비자(Consumer) 사이에서 중개자 역할을 수행한다.","keywords":["Backend-Development","Event-and-Message-Brokers","Fundamentals","Event-Brokers"],"articleBody":"Event Brokers 이벤트 브로커는 현대 분산 시스템과 마이크로서비스 아키텍처의 핵심 구성 요소로, 비동기 통신과 시스템 간 느슨한 결합을 가능하게 한다. Event Broker 는 이벤트 생성자 (Producer) 와 이벤트 소비자 (Consumer) 사이에서 중개자 역할을 수행한다.\nSource: https://developer.confluent.io/patterns/event-stream/event-broker/\n이벤트 브로커 기초 개념 이벤트 브로커란? 이벤트 브로커는 이벤트 생산자 (Producer) 와 소비자 (Consumer) 사이에서 메시지를 중개하는 미들웨어이다. 생산자는 이벤트를 발행 (publish) 하고, 소비자는 관심 있는 이벤트를 구독 (subscribe) 하는 발행 - 구독 (Pub/Sub) 패턴을 기반으로 한다.\n이벤트 브로커의 핵심 기능 메시지 라우팅: 적절한 소비자에게 메시지 전달 메시지 버퍼링: 일시적인 부하 증가나 소비자 장애 시 메시지 임시 저장 메시지 필터링: 특정 조건에 맞는 메시지만 전달 메시지 변환: 필요에 따라 메시지 형식 변환 신뢰성 보장: 메시지 전달 보장, 순서 유지 등 이벤트 브로커의 주요 이점 느슨한 결합 (Loose Coupling): 생산자와 소비자가 서로를 직접 알 필요 없음 확장성 (Scalability): 시스템 구성 요소를 독립적으로 확장 가능 탄력성 (Resilience): 일부 서비스 실패 시에도 전체 시스템 작동 가능 비동기 처리: 즉각적인 응답이 필요 없는 작업의 효율적 처리 주요 이벤트 브로커 시스템 비교 Apache Kafka 특징:\n높은 처리량과 내구성 제공 분산 커밋 로그 아키텍처 메시지 순서와 내구성 보장 파티션 기반 확장성 적합한 사용 사례:\n대용량 로그 처리 실시간 데이터 파이프라인 이벤트 소싱 아키텍처 장기간 메시지 보존 필요 시 RabbitMQ 특징:\nAMQP 프로토콜 구현 다양한 메시징 패턴 (라우팅, 토픽, RPC 등) 지원 관리 용이성 플러그인 시스템 적합한 사용 사례:\n복잡한 라우팅 요구사항 우선순위 큐 지연 메시지 처리 다양한 프로토콜 지원 필요 시 Apache Pulsar 특징:\n멀티 테넌트 아키텍처 저장소와 브로커 계층 분리 무제한 메시지 보존 Kafka 와 RabbitMQ 의 장점 결합 적합한 사용 사례:\n멀티 테넌트 환경 지역 간 복제 필요 시 장기 데이터 보존과 스트리밍 처리 결합 NATS 특징:\n초경량 아키텍처 낮은 지연 시간 간단한 설정과 운영 서비스 발견 기능 내장 적합한 사용 사례:\n클라우드 네이티브 애플리케이션 IoT 장치 통신 실시간 서비스 간 통신 AWS SNS/SQS, Google Pub/Sub, Azure Service Bus 특징:\n관리형 서비스 (서버리스) 클라우드 제공업체 통합 자동 확장 및 관리 적합한 사용 사례:\n해당 클라우드 플랫폼에서 운영되는 시스템 인프라 관리 부담 최소화 필요 시 실무 구현 가이드 Apache Kafka 구현 예제 기본 설정:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 # docker-compose.yml version: '3' services: zookeeper: image: confluentinc/cp-zookeeper:latest environment: ZOOKEEPER_CLIENT_PORT: 2181 kafka: image: confluentinc/cp-kafka:latest depends_on: - zookeeper ports: - \"9092:9092\" environment: KAFKA_BROKER_ID: 1 KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181 KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:29092,PLAINTEXT_HOST://localhost:9092 KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT KAFKA_INTER_BROKER_LISTENER_NAME: PLAINTEXT KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1 Java 생산자 코드:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 // Kafka 생산자 예제 import org.apache.kafka.clients.producer.*; import java.util.Properties; public class OrderEventProducer { public static void main(String[] args) { // 생산자 설정 Properties props = new Properties(); props.put(\"bootstrap.servers\", \"localhost:9092\"); props.put(\"key.serializer\", \"org.apache.kafka.common.serialization.StringSerializer\"); props.put(\"value.serializer\", \"org.apache.kafka.common.serialization.StringSerializer\"); // 생산자 인스턴스 생성 Producer\u003cString, String\u003e producer = new KafkaProducer\u003c\u003e(props); // 주문 이벤트 메시지 생성 String orderId = \"ORD-\" + System.currentTimeMillis(); String orderData = \"{\\\"orderId\\\":\\\"\" + orderId + \"\\\",\\\"customerId\\\":\\\"CUST001\\\",\\\"amount\\\":150.00}\"; // 메시지 전송 ProducerRecord\u003cString, String\u003e record = new ProducerRecord\u003c\u003e(\"order-events\", orderId, orderData); // 비동기 전송 (콜백 포함) producer.send(record, new Callback() { @Override public void onCompletion(RecordMetadata metadata, Exception e) { if (e != null) { // 에러 처리 System.err.println(\"메시지 전송 실패: \" + e.getMessage()); } else { // 성공 로깅 System.out.println(\"메시지 전송 성공: \" + \"토픽=\" + metadata.topic() + \", \" + \"파티션=\" + metadata.partition() + \", \" + \"오프셋=\" + metadata.offset()); } } }); // 리소스 정리 producer.flush(); producer.close(); } } Java 소비자 코드:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 // Kafka 소비자 예제 import org.apache.kafka.clients.consumer.*; import java.time.Duration; import java.util.*; public class OrderEventConsumer { public static void main(String[] args) { // 소비자 설정 Properties props = new Properties(); props.put(\"bootstrap.servers\", \"localhost:9092\"); props.put(\"group.id\", \"order-processing-group\"); props.put(\"key.deserializer\", \"org.apache.kafka.common.serialization.StringDeserializer\"); props.put(\"value.deserializer\", \"org.apache.kafka.common.serialization.StringDeserializer\"); props.put(\"auto.offset.reset\", \"earliest\"); // 처음부터 읽기 // 소비자 인스턴스 생성 Consumer\u003cString, String\u003e consumer = new KafkaConsumer\u003c\u003e(props); // 토픽 구독 consumer.subscribe(Arrays.asList(\"order-events\")); // 주기적으로 데이터 폴링 try { while (true) { // 100ms 동안 데이터 기다림 ConsumerRecords\u003cString, String\u003e records = consumer.poll(Duration.ofMillis(100)); for (ConsumerRecord\u003cString, String\u003e record : records) { // 메시지 처리 System.out.println(\"수신 데이터: \" + \"키=\" + record.key() + \", \" + \"값=\" + record.value() + \", \" + \"토픽=\" + record.topic() + \", \" + \"파티션=\" + record.partition() + \", \" + \"오프셋=\" + record.offset()); // 여기서 주문 처리 로직 구현 processOrder(record.value()); } // 명시적 커밋 (자동 커밋을 사용할 수도 있음) consumer.commitSync(); } } finally { // 리소스 정리 consumer.close(); } } private static void processOrder(String orderJson) { // 주문 처리 로직 System.out.println(\"주문 처리 중: \" + orderJson); } } Spring Boot 에서의 Kafka 사용 예제 의존성 설정 (build.gradle):\n1 2 3 4 5 dependencies { implementation 'org.springframework.kafka:spring-kafka' implementation 'org.springframework.boot:spring-boot-starter-web' // 기타 필요한 의존성 } 애플리케이션 설정 (application.yml):\n1 2 3 4 5 6 7 8 9 10 11 12 13 spring: kafka: bootstrap-servers: localhost:9092 producer: key-serializer: org.apache.kafka.common.serialization.StringSerializer value-serializer: org.springframework.kafka.support.serializer.JsonSerializer consumer: group-id: order-processing-group auto-offset-reset: earliest key-deserializer: org.apache.kafka.common.serialization.StringDeserializer value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer properties: spring.json.trusted.packages: com.example.model 이벤트 모델:\n1 2 3 4 5 6 7 8 9 10 11 12 13 package com.example.model; import java.math.BigDecimal; import java.time.LocalDateTime; public class OrderEvent { private String orderId; private String customerId; private BigDecimal amount; private LocalDateTime timestamp; // 생성자, 게터, 세터 생략 } 이벤트 생산자 서비스:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 package com.example.service; import com.example.model.OrderEvent; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.kafka.core.KafkaTemplate; import org.springframework.kafka.support.SendResult; import org.springframework.stereotype.Service; import org.springframework.util.concurrent.ListenableFuture; import org.springframework.util.concurrent.ListenableFutureCallback; import java.time.LocalDateTime; @Service public class OrderEventProducer { private static final String TOPIC = \"order-events\"; @Autowired private KafkaTemplate\u003cString, OrderEvent\u003e kafkaTemplate; public void sendOrderEvent(OrderEvent orderEvent) { // 타임스탬프 설정 orderEvent.setTimestamp(LocalDateTime.now()); // 키는 주문 ID, 값은 OrderEvent 객체 ListenableFuture\u003cSendResult\u003cString, OrderEvent\u003e\u003e future = kafkaTemplate.send(TOPIC, orderEvent.getOrderId(), orderEvent); future.addCallback(new ListenableFutureCallback\u003cSendResult\u003cString, OrderEvent\u003e\u003e() { @Override public void onSuccess(SendResult\u003cString, OrderEvent\u003e result) { System.out.println(\"주문 이벤트 전송 성공: \" + orderEvent.getOrderId() + \", 오프셋: \" + result.getRecordMetadata().offset()); } @Override public void onFailure(Throwable ex) { System.err.println(\"주문 이벤트 전송 실패: \" + orderEvent.getOrderId() + \", 원인: \" + ex.getMessage()); } }); } } 이벤트 소비자 서비스:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 package com.example.service; import com.example.model.OrderEvent; import org.springframework.kafka.annotation.KafkaListener; import org.springframework.stereotype.Service; @Service public class OrderEventConsumer { @KafkaListener(topics = \"order-events\", groupId = \"order-processing-group\") public void consume(OrderEvent orderEvent) { System.out.println(\"주문 이벤트 수신: \" + orderEvent.getOrderId()); // 여기서 비즈니스 로직 처리 processOrder(orderEvent); } private void processOrder(OrderEvent orderEvent) { // 주문 처리 로직 System.out.println(\"주문 처리 중: \" + orderEvent.getOrderId() + \", 고객: \" + orderEvent.getCustomerId() + \", 금액: \" + orderEvent.getAmount()); } } 심화 주제 이벤트 스트리밍과 처리 Kafka Streams 사용 예제 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 package com.example.streaming; import org.apache.kafka.common.serialization.Serdes; import org.apache.kafka.streams.KafkaStreams; import org.apache.kafka.streams.StreamsBuilder; import org.apache.kafka.streams.StreamsConfig; import org.apache.kafka.streams.kstream.KStream; import org.apache.kafka.streams.kstream.KTable; import org.apache.kafka.streams.kstream.Produced; import java.util.Properties; public class OrderProcessingStream { public static void main(String[] args) { // 스트림 설정 Properties props = new Properties(); props.put(StreamsConfig.APPLICATION_ID_CONFIG, \"order-analysis-app\"); props.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, \"localhost:9092\"); props.put(StreamsConfig.DEFAULT_KEY_SERDE_CLASS_CONFIG, Serdes.String().getClass()); props.put(StreamsConfig.DEFAULT_VALUE_SERDE_CLASS_CONFIG, Serdes.String().getClass()); // 스트림 빌더 StreamsBuilder builder = new StreamsBuilder(); // 입력 스트림 생성 KStream\u003cString, String\u003e orderEvents = builder.stream(\"order-events\"); // 주문 금액으로 필터링 (JSON 문자열 파싱 가정) KStream\u003cString, String\u003e highValueOrders = orderEvents .filter((key, value) -\u003e { // JSON 파싱 및 금액 추출 로직 double amount = extractAmountFromJson(value); return amount \u003e 1000.0; // 고액 주문 필터링 }); // 고액 주문을 별도 토픽으로 전송 highValueOrders.to(\"high-value-orders\", Produced.with(Serdes.String(), Serdes.String())); // 고객별 주문 합계 계산 KTable\u003cString, Double\u003e customerOrderTotals = orderEvents .groupBy((key, value) -\u003e extractCustomerIdFromJson(value)) .aggregate( () -\u003e 0.0, // 초기값 (customerId, orderJson, total) -\u003e { double amount = extractAmountFromJson(orderJson); return total + amount; } ); // 고객별 합계를 별도 토픽으로 전송 customerOrderTotals.toStream().to(\"customer-order-totals\", Produced.with(Serdes.String(), Serdes.Double())); // 스트림 생성 및 시작 KafkaStreams streams = new KafkaStreams(builder.build(), props); streams.start(); // 종료 처리 Runtime.getRuntime().addShutdownHook(new Thread(streams::close)); } // JSON 문자열에서 금액 추출 (간단한 예시) private static double extractAmountFromJson(String json) { // 실제 구현에서는 JSON 라이브러리 사용 // 여기서는 예시로 간단히 구현 if (json.contains(\"\\\"amount\\\":\")) { int start = json.indexOf(\"\\\"amount\\\":\") + \"\\\"amount\\\":\".length(); int end = json.indexOf(\",\", start); if (end == -1) { end = json.indexOf(\"}\", start); } return Double.parseDouble(json.substring(start, end).trim()); } return 0.0; } // JSON 문자열에서 고객 ID 추출 private static String extractCustomerIdFromJson(String json) { // 실제 구현에서는 JSON 라이브러리 사용 if (json.contains(\"\\\"customerId\\\":\")) { int start = json.indexOf(\"\\\"customerId\\\":\") + \"\\\"customerId\\\":\".length(); if (json.charAt(start) == '\\\"') { start++; // 따옴표 건너뛰기 int end = json.indexOf(\"\\\"\", start); return json.substring(start, end); } } return \"unknown\"; } } 이벤트 소싱 (Event Sourcing) 패턴 이벤트 소싱은 시스템의 상태 변화를 이벤트 시퀀스로 저장하는 패턴이다.\n이벤트 소싱 구현 예제:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 // 이벤트 클래스 public abstract class DomainEvent { private final String aggregateId; private final long timestamp; public DomainEvent(String aggregateId) { this.aggregateId = aggregateId; this.timestamp = System.currentTimeMillis(); } // 게터 메소드 } // 주문 생성 이벤트 public class OrderCreatedEvent extends DomainEvent { private final String customerId; private final BigDecimal initialAmount; public OrderCreatedEvent(String orderId, String customerId, BigDecimal initialAmount) { super(orderId); this.customerId = customerId; this.initialAmount = initialAmount; } // 게터 메소드 } // 주문 항목 추가 이벤트 public class OrderItemAddedEvent extends DomainEvent { private final String productId; private final int quantity; private final BigDecimal price; public OrderItemAddedEvent(String orderId, String productId, int quantity, BigDecimal price) { super(orderId); this.productId = productId; this.quantity = quantity; this.price = price; } // 게터 메소드 } // 이벤트 저장소 인터페이스 public interface EventStore { void saveEvents(String aggregateId, List\u003cDomainEvent\u003e events, int expectedVersion); List\u003cDomainEvent\u003e getEvents(String aggregateId); } // 주문 엔티티(애그리게이트 루트) public class Order { private String orderId; private String customerId; private BigDecimal totalAmount; private List\u003cOrderItem\u003e items = new ArrayList\u003c\u003e(); private int version = -1; private List\u003cDomainEvent\u003e changes = new ArrayList\u003c\u003e(); // 새 주문 생성 public static Order createOrder(String orderId, String customerId) { Order order = new Order(); order.applyChange(new OrderCreatedEvent(orderId, customerId, BigDecimal.ZERO)); return order; } // 이벤트 기록에서 주문 로드 public static Order loadFromHistory(List\u003cDomainEvent\u003e history) { Order order = new Order(); history.forEach(order::applyChange); return order; } // 항목 추가 public void addItem(String productId, int quantity, BigDecimal price) { applyChange(new OrderItemAddedEvent(orderId, productId, quantity, price)); } // 변경 사항 적용 및 기록 private void applyChange(DomainEvent event) { applyEvent(event); changes.add(event); } // 이벤트 적용 private void applyEvent(DomainEvent event) { if (event instanceof OrderCreatedEvent) { OrderCreatedEvent e = (OrderCreatedEvent) event; this.orderId = e.getAggregateId(); this.customerId = e.getCustomerId(); this.totalAmount = e.getInitialAmount(); this.version++; } else if (event instanceof OrderItemAddedEvent) { OrderItemAddedEvent e = (OrderItemAddedEvent) event; OrderItem item = new OrderItem(e.getProductId(), e.getQuantity(), e.getPrice()); this.items.add(item); this.totalAmount = this.totalAmount.add(item.getTotalPrice()); this.version++; } } // 변경 사항 커밋 public List\u003cDomainEvent\u003e getUncommittedChanges() { return new ArrayList\u003c\u003e(changes); } public void markChangesAsCommitted() { changes.clear(); } // 게터 메소드 } // 주문 서비스 public class OrderService { private final EventStore eventStore; public OrderService(EventStore eventStore) { this.eventStore = eventStore; } public String createOrder(String customerId) { String orderId = UUID.randomUUID().toString(); Order order = Order.createOrder(orderId, customerId); eventStore.saveEvents(orderId, order.getUncommittedChanges(), -1); order.markChangesAsCommitted(); return orderId; } public void addOrderItem(String orderId, String productId, int quantity, BigDecimal price) { List\u003cDomainEvent\u003e events = eventStore.getEvents(orderId); Order order = Order.loadFromHistory(events); order.addItem(productId, quantity, price); eventStore.saveEvents(orderId, order.getUncommittedChanges(), order.getVersion() - order.getUncommittedChanges().size()); order.markChangesAsCommitted(); } public Order getOrder(String orderId) { List\u003cDomainEvent\u003e events = eventStore.getEvents(orderId); return Order.loadFromHistory(events); } } 장애 복구 및 내구성 전략 메시지 전달 보장 수준 최대 한 번 전달 (At most once) 메시지가 전달되지 않을 수 있음 성능이 중요하고 데이터 손실이 허용되는 경우 최소 한 번 전달 (At least once) 메시지가 중복 전달될 수 있음 소비자 측에서 멱등성 처리 필요 Kafka 의 기본 모드 정확히 한 번 전달 (Exactly once) 가장 엄격한 보장 수준 트랜잭션 및 멱등성 프로듀서 사용 성능 비용 증가 Kafka 의 내구성 설정 1 2 3 4 5 6 7 8 9 10 11 12 13 # 브로커 측 설정 # 데이터 손실 방지를 위한 설정 min.insync.replicas=2 unclean.leader.election.enable=false # 프로듀서 측 설정 acks=all # 모든 복제본 확인 retries=10 # 재시도 횟수 max.in.flight.requests.per.connection=1 # 순서 보장 enable.idempotence=true # 멱등성 활성화 # 트랜잭션 사용 (정확히 한 번 처리) transactional.id=unique-id-per-producer 대규모 분산 시스템에서의 이벤트 브로커 활용 멀티 데이터 센터 복제 Kafka MirrorMaker 2.0 설정 예시:\n1 2 3 4 5 6 7 8 # MirrorMaker 2 설정 clusters=source, target source.bootstrap.servers=source-kafka:9092 target.bootstrap.servers=target-kafka:9092 # 소스 -\u003e 타겟 복제 설정 source-\u003etarget.enabled=true source-\u003etarget.topics=.* # 모든 토픽 복제 스트리밍 데이터 파이프라인 구축 Kafka Connect 로 데이터 파이프라인 구축:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 // 소스 커넥터 설정 (데이터베이스 변경 캡처) { \"name\": \"mysql-source-connector\", \"config\": { \"connector.class\": \"io.debezium.connector.mysql.MySqlConnector\", \"database.hostname\": \"mysql-server\", \"database.port\": \"3306\", \"database.user\": \"debezium\", \"database.password\": \"dbz\", \"database.server.id\": \"1\", \"database.server.name\": \"mysql-server-1\", \"table.whitelist\": \"inventory.customers\", \"database.history.kafka.bootstrap.servers\": \"kafka:9092\", \"database.history.kafka.topic\": \"dbhistory.inventory\" } } // 싱크 커넥터 설정 (ElasticSearch로 데이터 전송) { \"name\": \"elasticsearch-sink\", \"config\": { \"connector.class\": \"io.confluent.connect.elasticsearch.ElasticsearchSinkConnector\", \"tasks.max\": \"1\", \"topics\": \"mysql-server-1.inventory.customers\", \"connection.url\": \"http://elasticsearch:9200\", \"transforms\": \"unwrap\", \"transforms.unwrap.type\": \"io.debezium.transforms.ExtractNewRecordState\", \"key.ignore\": \"false\", \"schema.ignore\": \"true\", \"type.name\": \"customer\" } } 이벤트 브로커 설계 및 운영 모범 사례 토픽 설계 원칙 문제 도메인 기반 토픽 정의 비즈니스 도메인 개념과 일치하는 토픽 네이밍 예: orders, payments, inventory-changes 적절한 파티션 수 결정 처리량에 맞는 파티션 수 설정 파티션 수 = 목표 처리량 / 단일 파티션 처리량 파티션 수가 많을수록 관리 복잡성 증가 효과적인 키 선택 관련 이벤트가 같은 파티션에 들어가도록 키 선택 예: 주문 ID 를 키로 사용하여 주문 관련 이벤트 순서 보장 최적화 배치 처리 활용 프로듀서: batch.size, linger.ms 조정 소비자: 적절한 fetch.min.bytes, fetch.max.wait.ms 설정 압축 사용 네트워크 대역폭 절약 및 처리량 향상 compression.type=snappy 또는 lz4 권장 적절한 버퍼 크기 설정 프로듀서: buffer.memory 소비자: fetch.max.bytes 모니터링 및 알림 전략 핵심 메트릭 모니터링\n브로커 레벨: CPU, 메모리, 디스크 I/O, 네트워크 I/O 토픽 레벨: 처리량 (초당 메시지 수), 지연 시간, 복제 지연 소비자 그룹 레벨: 소비자 지연 (Consumer lag), 처리 시간 Prometheus 및 Grafana 를 활용한 모니터링 시스템 구축\n1 2 3 4 5 6 7 8 # Prometheus 설정 예시 scrape_configs: - job_name: 'kafka' static_configs: - targets: ['kafka-exporter:9308'] - job_name: 'kafka-consumer-groups' static_configs: - targets: ['kafka-lag-exporter:9999'] 알림 규칙 설정\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 # Prometheus 알림 규칙 예시 groups: - name: kafka_alerts rules: - alert: KafkaConsumerLagHigh expr: kafka_consumergroup_lag \u003e 10000 for: 10m labels: severity: warning annotations: summary: \"Kafka consumer lag high\" description: \"Consumer group {{ $labels.consumergroup }} on topic {{ $labels.topic }} has lag of {{ $value }} messages\" - alert: KafkaBrokerDown expr: kafka_server_active_controller_count == 0 for: 1m labels: severity: critical annotations: summary: \"Kafka broker down\" description: \"No active controller in the Kafka cluster\" 확장성 및 고가용성 설계 클러스터 크기 결정\n데이터 보존 기간, 복제 인수, 메시지 크기, 처리량 고려 용량 계획: (메시지 수/초 × 평균 메시지 크기 × 보존 기간 × 복제 인수) / 브로커 수 파티션 재할당 전략\n1 2 3 4 5 6 7 8 9 10 # 파티션 재분배 계획 생성 cat \u003e reassign.json \u003c\u003c EOF { \"version\": 1, \"partitions\": [ {\"topic\": \"high-volume-topic\", \"partition\": 0, \"replicas\": [1,2,3]}, {\"topic\": \"high-volume-topic\", \"partition\": 1, \"replicas\": [2,3,1]}, {\"topic\": \"high-volume-topic\", \"partition\": 2, \"replicas\": [3,1,2]} ] } EOF\n# 파티션 재분배 실행 kafka-reassign-partitions.sh --bootstrap-server kafka:9092 \\ --reassignment-json-file reassign.json --execute\t``` 롤링 재시작 및 무중단 업그레이드\n1 2 3 4 5 6 7 8 9 10 # 브로커 롤링 재시작 스크립트 예시 for broker in {1.}; do echo \"재시작 broker $broker\" ssh kafka-$broker 'systemctl stop kafka' wait_for_shutdown ssh kafka-$broker 'systemctl start kafka' wait_for_full_recovery echo \"브로커 $broker 정상 복구 완료\" sleep 300 # 다음 브로커 재시작 전 안정화 시간 done 실제 사례 연구 및 문제 해결 대용량 로그 처리 시스템 요구사항:\n초당 10 만 로그 메시지 처리 7 일간 로그 보존 로그 타입별 처리 로직 분리 해결책:\n토픽 설계:\n로그 타입별 토픽 생성: app-logs, system-logs, security-logs 각 토픽 24 개 파티션으로 시작 (확장성 확보) 프로듀서 설정:\n1 2 3 4 5 6 7 8 9 Properties props = new Properties(); props.put(\"bootstrap.servers\", \"kafka1:9092,kafka2:9092,kafka3:9092\"); props.put(\"key.serializer\", \"org.apache.kafka.common.serialization.StringSerializer\"); props.put(\"value.serializer\", \"org.apache.kafka.common.serialization.StringSerializer\"); props.put(\"compression.type\", \"lz4\"); props.put(\"batch.size\", 65536); // 64KB props.put(\"linger.ms\", 10); // 10ms 대기 시간으로 배치 처리 props.put(\"buffer.memory\", 67108864); // 64MB props.put(\"acks\", \"1\"); // 리더만 확인 (처리량 중시) 소비자 그룹 설계:\n로그 유형별 소비자 그룹 구성 각 소비자 그룹 내 인스턴스 수 = 파티션 수 탄력적인 스케일링을 위한 Kubernetes StatefulSet 사용 로그 처리 파이프라인:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 // 로그 처리 소비자 예시 @KafkaListener(topics = \"app-logs\", groupId = \"app-logs-processor\") public void process(ConsumerRecord\u003cString, String\u003e record) { try { LogEvent logEvent = parseLogEvent(record.value()); // 로그 레벨에 따른 처리 switch (logEvent.getLevel()) { case \"ERROR\": alertingService.sendAlert(logEvent); break; case \"WARN\": anomalyDetector.analyze(logEvent); break; } // Elasticsearch에 저장 elasticsearchClient.index( IndexRequest.of(i -\u003e i .index(\"app-logs-\" + logEvent.getDate()) .id(record.key()) .document(logEvent) ) ); } catch (Exception e) { // 에러 로깅 및 처리 log.error(\"로그 처리 중 오류 발생: \" + record.key(), e); // 오류 토픽으로 전송 (DLQ 패턴) kafkaTemplate.send(\"app-logs-errors\", record.key(), record.value() + \"||ERROR:\" + e.getMessage()); } } 마이크로서비스 간 통신 시스템 요구사항:\n주문 처리 시스템 내 마이크로서비스 간 통신 각 서비스의 독립적 배포와 확장 서비스 장애 시에도 시스템 지속 운영 해결책:\n토픽 설계:\n도메인 이벤트별 토픽: orders, payments, inventory, shipping 명령 토픽: order-commands, payment-commands 등 이벤트 중심 아키텍처 구현:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 // 주문 생성 핸들러 @RestController public class OrderController { @Autowired private KafkaTemplate\u003cString, OrderEvent\u003e kafkaTemplate; @PostMapping(\"/orders\") public ResponseEntity\u003cOrderCreatedResponse\u003e createOrder(@RequestBody CreateOrderRequest request) { // 주문 ID 생성 String orderId = UUID.randomUUID().toString(); // 주문 생성 이벤트 OrderCreatedEvent event = OrderCreatedEvent.builder() .orderId(orderId) .customerId(request.getCustomerId()) .items(request.getItems()) .totalAmount(calculateTotal(request.getItems())) .status(\"CREATED\") .timestamp(LocalDateTime.now()) .build(); // 이벤트 발행 kafkaTemplate.send(\"orders\", orderId, event) .addCallback( result -\u003e log.info(\"주문 이벤트 발행 성공: \" + orderId), ex -\u003e log.error(\"주문 이벤트 발행 실패: \" + orderId, ex) ); // 응답 반환 return ResponseEntity.accepted().body(new OrderCreatedResponse(orderId)); } } // 재고 서비스의 주문 이벤트 소비자 @Service public class InventoryEventHandler { @Autowired private InventoryService inventoryService; @Autowired private KafkaTemplate\u003cString, InventoryEvent\u003e kafkaTemplate; @KafkaListener(topics = \"orders\", groupId = \"inventory-service\") public void handleOrderEvent(OrderCreatedEvent event) { try { // 재고 확인 및 할당 boolean allItemsAvailable = inventoryService.reserveItems(event.getItems()); // 결과 이벤트 발행 InventoryEvent resultEvent; if (allItemsAvailable) { resultEvent = new InventoryReservedEvent( event.getOrderId(), event.getItems()); } else { resultEvent = new InventoryShortageEvent( event.getOrderId(), inventoryService.findUnavailableItems(event.getItems())); } kafkaTemplate.send(\"inventory\", event.getOrderId(), resultEvent); } catch (Exception e) { log.error(\"재고 처리 중 오류: \" + event.getOrderId(), e); // 재시도 로직 또는 오류 이벤트 발행 } } } // 주문 조정 서비스 (오케스트레이터) @Service public class OrderOrchestratorService { // 다양한 이벤트 구독 후 주문 상태 업데이트 @KafkaListener(topics = \"inventory\", groupId = \"order-orchestrator\") public void handleInventoryEvent(InventoryEvent event) { if (event instanceof InventoryReservedEvent) { // 결제 명령 발행 initiatePaymentProcess(event.getOrderId()); } else if (event instanceof InventoryShortageEvent) { // 주문 취소 이벤트 발행 sendOrderCancellationEvent(event.getOrderId(), \"재고 부족: \" + ((InventoryShortageEvent) event).getUnavailableItems()); } } @KafkaListener(topics = \"payments\", groupId = \"order-orchestrator\") public void handlePaymentEvent(PaymentEvent event) { if (event instanceof PaymentSucceededEvent) { // 배송 명령 발행 initiateShippingProcess(event.getOrderId()); } else if (event instanceof PaymentFailedEvent) { // 주문 취소 및 재고 롤백 sendOrderCancellationEvent(event.getOrderId(), \"결제 실패: \" + ((PaymentFailedEvent) event).getReason()); rollbackInventory(event.getOrderId()); } } } 내구성 및 재시도 메커니즘:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 // 멱등 소비자 설계 @Service public class IdempotentConsumer\u003cT\u003e { @Autowired private JdbcTemplate jdbcTemplate; public boolean processOnce(String eventId, String consumerGroup, Consumer\u003cT\u003e processor, T event) { // 처리 이력 확인 boolean alreadyProcessed = checkIfProcessed(eventId, consumerGroup); if (!alreadyProcessed) { try { // 이벤트 처리 processor.accept(event); // 처리 이력 기록 markAsProcessed(eventId, consumerGroup); return true; } catch (Exception e) { log.error(\"이벤트 처리 실패: \" + eventId, e); throw e; } } else { log.info(\"이미 처리된 이벤트: \" + eventId); return false; } } private boolean checkIfProcessed(String eventId, String consumerGroup) { Integer count = jdbcTemplate.queryForObject( \"SELECT COUNT(*) FROM processed_events WHERE event_id = ? AND consumer_group = ?\", Integer.class, eventId, consumerGroup); return count != null \u0026\u0026 count \u003e 0; } private void markAsProcessed(String eventId, String consumerGroup) { jdbcTemplate.update( \"INSERT INTO processed_events (event_id, consumer_group, processed_at) VALUES (?, ?, ?)\", eventId, consumerGroup, new Timestamp(System.currentTimeMillis())); } } 실시간 분석 및 대시보드 시스템 요구사항:\n웹사이트 사용자 활동 실시간 분석 세션별 사용자 행동 추적 실시간 KPI 대시보드 해결책:\n데이터 파이프라인 설계:\n원시 이벤트 수집 토픽: user-activities 세션별 집계 토픽: user-sessions 지표별 집계 토픽: real-time-metrics Kafka Streams 처리 로직:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 public class UserActivityProcessor { public static void main(String[] args) { Properties props = new Properties(); props.put(StreamsConfig.APPLICATION_ID_CONFIG, \"user-activity-processor\"); props.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, \"kafka:9092\"); props.put(StreamsConfig.DEFAULT_KEY_SERDE_CLASS_CONFIG, Serdes.String().getClass()); props.put(StreamsConfig.DEFAULT_VALUE_SERDE_CLASS_CONFIG, Serdes.String().getClass()); StreamsBuilder builder = new StreamsBuilder(); // 활동 이벤트 스트림 생성 KStream\u003cString, String\u003e activityEvents = builder.stream(\"user-activities\"); // 이벤트 유형별 분리 KStream\u003cString, String\u003e[] branches = activityEvents.branch( // 페이지 조회 이벤트 (key, value) -\u003e value.contains(\"\\\"type\\\":\\\"page_view\\\"\"), // 클릭 이벤트 (key, value) -\u003e value.contains(\"\\\"type\\\":\\\"click\\\"\"), // 검색 이벤트 (key, value) -\u003e value.contains(\"\\\"type\\\":\\\"search\\\"\"), // 기타 이벤트 (key, value) -\u003e true ); // 페이지뷰 집계 branches[0] .map((key, value) -\u003e extractUserIdAndPage(value)) .groupByKey() .windowedBy(TimeWindows.of(Duration.ofMinutes(1))) .count() .toStream() .map((windowedKey, count) -\u003e { String metricKey = \"pageviews_\" + windowedKey.key() + \"_\" + formatWindowTime(windowedKey.window()); return KeyValue.pair(metricKey, String.valueOf(count)); }) .to(\"real-time-metrics\"); // 세션별 활동 집계 activityEvents .groupByKey() .windowedBy(SessionWindows.with(Duration.ofMinutes(30))) .aggregate( // 세션 초기값 () -\u003e \"[]\", // 이벤트 추가 집계 함수 (sessionId, event, sessionEvents) -\u003e appendEvent(sessionEvents, event), // 세션 병합 함수 (대부분의 경우 사용되지 않음) (key, session1, session2) -\u003e mergeSessionEvents(session1, session2), // 세션 이벤트 저장에 JSON Serde 사용 Materialized.with(Serdes.String(), Serdes.String()) ) .toStream() .map((windowedKey, events) -\u003e { String sessionKey = windowedKey.key() + \"_\" + formatWindowTime(windowedKey.window()); return KeyValue.pair(sessionKey, events); }) .to(\"user-sessions\"); // 실시간 전환율 계산 KStream\u003cString, Double\u003e conversionRates = activityEvents .groupByKey() .windowedBy(TimeWindows.of(Duration.ofMinutes(5))) .aggregate( () -\u003e new PageConversionTracker(), (key, event, tracker) -\u003e tracker.trackEvent(event), Materialized.with(Serdes.String(), new JsonSerde\u003c\u003e(PageConversionTracker.class)) ) .toStream() .map((windowedKey, tracker) -\u003e { String metricKey = \"conversion_rate_\" + formatWindowTime(windowedKey.window()); return KeyValue.pair(metricKey, tracker.calculateConversionRate()); }); conversionRates.to(\"real-time-metrics\", Produced.with(Serdes.String(), Serdes.Double())); // 토폴로지 생성 및 스트림 시작 KafkaStreams streams = new KafkaStreams(builder.build(), props); streams.start(); // 종료 처리 Runtime.getRuntime().addShutdownHook(new Thread(streams::close)); } // 헬퍼 메소드들 (JSON 파싱, 키 추출, 세션 병합 등) } Elasticsearch 로 집계 데이터 전송:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // Kafka Connect Elasticsearch 싱크 설정 { \"name\": \"metrics-elasticsearch-sink\", \"config\": { \"connector.class\": \"io.confluent.connect.elasticsearch.ElasticsearchSinkConnector\", \"tasks.max\": \"1\", \"topics\": \"real-time-metrics\", \"connection.url\": \"http://elasticsearch:9200\", \"key.converter\": \"org.apache.kafka.connect.storage.StringConverter\", \"value.converter\": \"org.apache.kafka.connect.json.JsonConverter\", \"value.converter.schemas.enable\": \"false\", \"key.ignore\": \"false\", \"schema.ignore\": \"true\", \"type.name\": \"metrics\", \"behavior.on.null.values\": \"delete\" } } Grafana 대시보드 구현:\nElasticsearch 데이터 소스 추가 실시간 업데이트 대시보드 구성 시각화 패널: 페이지뷰 트렌드 전환율 게이지 활성 사용자 수 세션 지속 시간 분포 이벤트 브로커 선택 가이드 최적의 이벤트 브로커 선택은 다음 요소에 따라 달라진다:\n데이터 양과 처리량 요구사항 대용량 처리: Kafka, Pulsar 중소규모: RabbitMQ, NATS 지연 시간 요구사항 초저지연: NATS 일반 메시징: RabbitMQ 대량 처리 중심: Kafka 기능 요구사항 복잡한 라우팅: RabbitMQ 장기 데이터 보존: Kafka, Pulsar 멀티테넌시: Pulsar 운영 환경 클라우드 네이티브: 관리형 서비스 (AWS MSK, Google Pub/Sub) 온프레미스: Kafka, RabbitMQ 하이브리드: Pulsar 아키텍처 진화 방향 메시 아키텍처로의 전환 중앙집중식에서 분산형 이벤트 메시로 발전 도메인별 브로커 분리 및 연동 서버리스 이벤트 처리의 부상 인프라 관리 부담 감소 이벤트 기반 함수 실행 모델 확산 빅데이터 및 AI 와의 통합 실시간 스트림 처리와 AI 모델 결합 지능형 이벤트 라우팅 및 분석 용어 정리 용어 설명 참고 및 출처 1. 주제의 분류 적절성 “Event Brokers”(이벤트 브로커) 는 “Computer Science and Engineering \u003e Backend Development \u003e Event and Message Brokers \u003e Fundamentals” 분류에 매우 적합합니다. 이벤트 브로커는 이벤트 기반 아키텍처 (EDA, Event-Driven Architecture) 의 핵심 인프라로, 백엔드 시스템의 확장성, 비동기성, 실시간성, 유연성을 실현하는 데 필수적인 미들웨어입니다 [4][14][6].\n2. 200 자 요약 이벤트 브로커는 이벤트 발행자와 구독자 간의 메시지 교환을 중개하는 미들웨어로, 비동기 통신, 실시간 데이터 분배, 서비스 간 결합도 감소, 확장성 및 장애 복원력을 제공합니다. Pub/Sub, 스트리밍, 다양한 QoS(서비스 품질) 와 같은 고급 기능을 지원하며, 현대 백엔드 아키텍처의 핵심 역할을 담당합니다 [4][14][16].\n3. 전체 개요 (250 자 내외) 이벤트 브로커는 이벤트 기반 아키텍처에서 이벤트 발행자 (Producer) 와 구독자 (Consumer) 사이의 이벤트 메시지 흐름을 중개하는 미들웨어입니다. 이벤트 브로커는 Pub/Sub, 스트리밍, 다양한 QoS, 보안, 트랜잭션, 확장성, 장애 복구 등 다양한 기능을 제공하며, 시스템 간 결합도를 낮추고, 실시간 데이터 분배와 비동기 처리를 지원합니다. 대표 솔루션으로는 Solace, Kafka, AWS EventBridge, Azure Event Grid 등이 있으며, 다양한 산업에서 실시간 분석, 알림, IoT, 마이크로서비스 통합 등 광범위하게 활용됩니다 [4][14][6][16].\n핵심 개념 이벤트 브로커 (Event Broker): 이벤트 발행자와 구독자 사이에서 이벤트 메시지를 중개하는 미들웨어. 이벤트의 저장, 라우팅, 필터링, 전달, 보안, 품질 보장 (QoS) 등 다양한 역할을 수행 [4][14][16]. Pub/Sub(발행 - 구독): 이벤트를 특정 주제 (Topic) 에 발행하면, 해당 주제를 구독한 모든 소비자가 이벤트를 수신하는 방식 [2][3][4]. 토픽 (Topic): 이벤트 메시지를 분류하고 라우팅하는 논리적 채널. 계층적 구조와 와일드카드 구독 등 다양한 방식 지원 [2][3]. QoS(서비스 품질): 이벤트 전달 보장 수준 (Exactly once, At least once, At most once 등)[6][14]. 비동기 통신: 발행자와 구독자가 직접 연결되지 않고, 이벤트 브로커를 통해 비동기적으로 통신 [4][5][14]. 목적 및 필요성 서비스 간 결합도 감소 및 유연성 확보 실시간 데이터 분배 및 비동기 처리 장애 복원력, 확장성, 신뢰성 강화 다양한 시스템 및 프로토콜 간 통합 지원 고가용성 및 분산 환경 지원 [4][5][14][16]. 주요 기능 및 역할 이벤트 저장, 라우팅, 필터링, 전달 Pub/Sub, 스트리밍, 요청 - 응답 등 다양한 메시징 패턴 지원 QoS, 트랜잭션, 이벤트 순서 보장, 중복 방지 인증, 권한, 암호화 등 보안 기능 모니터링, 장애 복구, 확장성 관리 [6][14][16][11]. 특징 느슨한 결합 (Loose Coupling), 비동기성, 실시간성, 확장성 다양한 배포 형태 (온프레미스, 클라우드, SaaS) 다양한 프로토콜 및 클라이언트 지원 이벤트 저장 및 재전송, 이벤트 소싱 지원 고가용성, 장애 복원력, 분산 처리 [4][14][16]. 핵심 원칙 발행자와 구독자 간의 완전한 분리 (Decoupling) 신뢰성 있는 이벤트 전달 (중복 방지, 순서 보장) 확장성, 장애 복원력, 보안, 유연성 표준화된 메시징 패턴 및 프로토콜 준수 [4][14][16]. 주요 원리 및 작동 원리 **이벤트 발행자 (Producer)**가 이벤트를 브로커에 발행 **이벤트 브로커 (Event Broker)**가 이벤트를 저장, 라우팅, 필터링 **이벤트 구독자 (Consumer)**가 구독한 토픽의 이벤트를 수신 브로커는 QoS, 보안, 장애 복구 등 다양한 내부 로직을 적용 작동 원리 다이어그램 1 [Producer] --(Event)--\u003e [Event Broker (Topic/Channel)] --(Event)--\u003e [Consumer] Pub/Sub, 스트리밍, QoS, 이벤트 저장 등 다양한 기능 내장 구조 및 아키텍처 필수 구성요소 구성 요소 기능 및 역할 Producer(발행자) 이벤트 생성 및 브로커에 발행 Event Broker(브로커) 이벤트 저장, 라우팅, 필터링, 전달, 보안, QoS Consumer(구독자) 구독한 토픽의 이벤트 수신 및 처리 Topic/Channel 이벤트 분류, 라우팅, 구독 관리 선택 구성요소 구성 요소 기능 및 역할 Event Store 이벤트 영속 저장, 이벤트 소싱, 감사, 재처리 지원 Schema Registry 이벤트 메시지 구조 관리 및 호환성 보장 모니터링/관리 도구 성능, 장애, 트래픽 모니터링 및 관리 Event Router 라우팅 규칙 기반 이벤트 분배 구조 다이어그램 예시 1 2 3 [Producer] → [Event Broker (Topic/Channel)] → [Consumer] ↘︎ ↑ [Schema Registry/Event Store] (선택) 구현 기법 구현 기법 정의/구성 목적 실제 예시 (시스템/시나리오) Pub/Sub 토픽 기반 1:N 이벤트 분배 실시간 데이터 분배, 확장성 Kafka, Solace, AWS EventBridge 스트리밍 실시간 데이터 스트림 처리 대용량 실시간 처리 Kafka, Pulsar 이벤트 소싱 이벤트 로그 기반 상태 관리 데이터 추적, 복구 Kafka, EventStoreDB QoS 조정 이벤트 전달 보장 수준 설정 신뢰성, 중복 방지 Exactly once, At least once, At most once 장점과 단점 구분 항목 설명 ✅ 장점 결합도 감소 발행자 - 구독자 완전 분리, 유연한 확장 신뢰성 QoS, 장애 복구, 이벤트 저장 실시간성 실시간 데이터 분배, 스트리밍 확장성 대용량 트래픽, 수평 확장 용이 다양한 패턴 Pub/Sub, 스트리밍, 이벤트 소싱 등 지원 ⚠ 단점 복잡성 운영, 모니터링, 장애 분석 난이도 지연 브로커 장애, 네트워크 이슈 시 지연 가능 일관성 Eventually Consistent, 즉각적 일관성 어려움 운영 비용 인프라, 관리, 보안 등 추가 리소스 필요 도전 과제 이벤트 순서 보장, 중복 방지, 트랜잭션 처리 장애 복구, 데이터 유실 방지, 확장성 관리 운영 복잡성, 실시간 모니터링 및 장애 탐지 스키마/버전 관리, 보안 강화 [14][16][11]. 분류에 따른 종류 및 유형 분류 기준 종류/유형 설명 메시징 패턴 Pub/Sub, 스트리밍, 이벤트 소싱 이벤트 전달 방식에 따른 분류 아키텍처 토픽 기반, 로그 기반, 큐 기반 내부 저장/분배 구조 배포 형태 온프레미스, 클라우드, SaaS 배포 및 운영 방식 QoS Exactly once, At least once, At most once 이벤트 전달 보장 수준 대표 제품 Solace, Kafka, AWS EventBridge, Azure Event Grid, IBM MQ 등 주요 상용/오픈소스 솔루션 실무 적용 예시 적용 분야 적용 예시 설명 실시간 분석 Kafka 대용량 실시간 로그 스트림 분배 알림 서비스 Solace 다양한 채널로 이벤트 분배 IoT MQTT, Solace 센서 데이터 실시간 수집/분배 데이터 파이프라인 AWS EventBridge 데이터 이동 및 ETL 자동화 마이크로서비스 통합 Azure Event Grid 서비스 간 이벤트 기반 통합 활용 사례 (시나리오) 시나리오: 글로벌 이커머스 실시간 주문/알림 시스템 시스템 구성\n주문 서비스 (Producer) → Kafka(이벤트 브로커, Topic: order-events) → 결제/알림/배송 서비스 (Consumer) 알림 서비스 → Solace(이벤트 브로커, Topic: notification) → 이메일/SMS/푸시 서버 시스템 다이어그램\n1 2 [주문 서비스] --(order 이벤트)--\u003e [Kafka Topic] --(구독)--\u003e [결제/알림/배송 서비스] [알림 서비스] --(알림 이벤트)--\u003e [Solace Topic] --(구독)--\u003e [이메일/SMS/푸시 서버] Workflow\n주문 발생 시 order 이벤트를 Kafka 에 발행 결제, 알림, 배송 서비스가 각자 필요한 이벤트만 구독 알림 서비스는 Solace 를 통해 다양한 채널로 이벤트 분배 장애 발생 시 브로커가 이벤트 임시 저장, 재시도 담당 역할\nKafka: 대용량 이벤트 스트림, Pub/Sub, 실시간 처리 Solace: 다양한 채널, QoS, 이벤트 분배 실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점 항목 설명 권장사항 메시지 패턴 Pub/Sub 등 요구에 맞는 패턴 선택 시스템 요구사항 분석 후 설계 확장성 트래픽 증가 대비 수평 확장성 확보 클러스터링, 파티셔닝 적용 장애 복구 데이터 유실 방지, 장애 격리 복제, 백업, 장애 복구 시나리오 구축 모니터링 성능, 지연, 장애 실시간 모니터링 APM, 대시보드, 알림 설정 보안 인증, 암호화, 접근 제어 TLS, ACL, 권한 분리 적용 스키마 관리 이벤트 구조 일관성 유지 Schema Registry, 버전 관리 도입 최적화하기 위한 고려사항 및 주의할 점 항목 설명 권장사항 이벤트 크기 이벤트 최소화, 불필요 데이터 제거 10MB 이하, 경량 포맷 사용 브로커 설정 최적화된 토픽/파티션 구성 테스트 기반 튜닝, 병렬 처리 네트워크 대역폭, 지연 최소화 전용 네트워크, 로컬 배치 리소스 할당 CPU/메모리/디스크 충분히 확보 오토스케일링, 모니터링 오류 처리 재시도, 백오프, DLQ 적용 자동화된 오류 처리 로직 구현 캐싱/비동기 병렬/비동기 처리로 처리량 증대 캐시, 비동기 API 활용 2025 년 기준 최신 동향 주제 항목 설명 클라우드 네이티브 매니지드 브로커 서비스 Kafka, Solace 등 클라우드 통합, 자동 확장 AI/ML AI 기반 트래픽 예측, 자동 튜닝 AI 가 이벤트 패턴 분석, 리소스 자동 할당 IoT 초경량 브로커, MQTT 확산 IoT 데이터 실시간 수집/분배 보안 고급 암호화, 인증 강화 TLS, OAuth 등 보안 강화 추세 이벤트 메시시 글로벌 이벤트 메시시 멀티 브로커 연결, 글로벌 분산 이벤트 처리 주제와 관련하여 주목할 내용 주제 항목 설명 메시징 패턴 Pub/Sub, 스트리밍, 이벤트 소싱 다양한 패턴 조합으로 유연한 통신 스키마 관리 Schema Registry 이벤트 구조 일관성, 호환성 보장 장애 복구 복제, 파티셔닝 데이터 유실 방지, 고가용성 실시간성 스트리밍, 이벤트 소싱 대용량 실시간 데이터 처리 운영 자동화 오토스케일링, AI 기반 튜닝 운영 효율성 및 장애 대응 강화 앞으로의 전망 주제 항목 설명 시장 성장 이벤트 브로커 시장 연평균 20% 이상 성장, IoT/클라우드 영향 AI 통합 AI/ML 기반 브로커 예측, 자동화, 장애 탐지 강화 IoT 확장 초경량 브로커 엣지/IoT 환경에 최적화 이벤트 메시시 글로벌 메시시 멀티 브로커, 글로벌 분산 트래픽 보안 고급 보안 기능 데이터 보호, 규제 대응 강화 하위 주제 및 추가 학습 필요 내용 카테고리 주제 설명 메시징 패턴 Pub/Sub, 스트리밍, 이벤트 소싱 각 패턴별 특징, 적용법 브로커 비교 Kafka, Solace, EventBridge 등 주요 브로커별 장단점, 아키텍처 스키마 관리 Schema Registry 이벤트 구조 관리, 버전 호환성 장애 복구 복제, 파티셔닝, DLQ 고가용성, 장애/오류 처리 보안 인증, 암호화, 접근제어 보안 설계 및 운영 가이드 카테고리 주제 설명 아키텍처 이벤트 메시시, 글로벌 분산 멀티 브로커, 이벤트 메시시 구조 운영 모니터링, 오토스케일링 실시간 성능/장애 관리 성능 튜닝, 최적화 브로커별 성능 최적화 방법 클라우드 매니지드 서비스 클라우드 기반 브로커 활용법 개발 API, SDK 활용 다양한 언어/플랫폼 연동법 용어 정리 용어 설명 Pub/Sub 발행 - 구독 패턴, 이벤트를 여러 구독자에게 분배하는 구조 Topic 이벤트 메시지 분류 및 라우팅 논리적 채널 QoS 이벤트 전달 보장 수준 (Exactly once, At least once, At most once) Event Mesh 복수 브로커를 연결한 글로벌 분산 구조 Schema Registry 이벤트 메시지 구조 (스키마) 관리 시스템 DLQ(Dead Letter Queue) 처리 실패 이벤트 임시 저장 큐 오토스케일링 자동 리소스 확장/축소 기능 참고 및 출처 Solace Event Broker 개념 및 기능 Solace Docs - What Are Event Brokers? Gartner Event Broker 시장 가이드 PubNub Event Broker 설명 Azure Event Broker 아키텍처 예시 EDA 실무 적용 사례 EDA 성능 최적화 및 브로커 튜닝 Gartner Event Broker 비교 및 선택 가이드 Citations:\n[1] https://talent500.com/blog/how-to-implement-event-driven-architecture-for-complex-backend-systems/\n[2] https://www.linkedin.com/pulse/eda-fundamentals-sap-advanced-event-mesh-mahesh-dash-mrpge\n[3] https://docs.solace.com/Cloud/Event-Portal/event-portal-topic-addresses.htm\n[4] https://docs.solace.com/Get-Started/what-are-event-brokers.htm\n[5] https://solace.com/blog/why-developers-pubsub-plus-event-driven-architecture/\n[6] https://www.gartner.com/reviews/market/event-brokers\n[7] https://estuary.dev/blog/event-driven-architecture-examples/\n[8] https://learn.microsoft.com/en-us/azure/architecture/example-scenario/integration/queues-events\n[9] https://tyk.io/learning-center/event-driven-architecture-best-practices/\n[10] https://www.site24x7.com/blog/troubleshooting-latency-issues-in-event-driven-architectures\n[11] https://solace.com/blog/gartner-how-to-choose-an-event-broker/\n[12] https://cerexio.com/axon-real-time-event-broker-platform\n[13] https://www.cognitivemarketresearch.com/e-brokerage-market-report\n[14] https://solace.com/what-is-an-event-broker/\n[15] https://solace.com/resources/solace-event-driven-architecture-resources/gartner-market-guide-for-event-brokers\n[16] https://www.pubnub.com/guides/event-driven-architecture/\n[17] https://dev.to/jhonifaber/introduction-to-event-driven-architecture-eda-3ioj\n[18] https://risingwave.com/blog/real-world-applications-of-event-driven-architecture-10-examples/\n[19] https://aws.amazon.com/blogs/architecture/best-practices-for-implementing-event-driven-architectures-in-your-organization/\n[20] https://ibm.github.io/event-automation/es/installing/capacity-planning/\n[21] https://solace.com/resources/pubsub-event-broker/why-pubsub-is-the-worlds-best-event-broker-2-video\n[22] https://dev.to/hamzakhan/understanding-event-driven-architecture-a-guide-for-backend-developers-3bne\n[23] https://help.pubsub.em.services.cloud.sap/Get-Started/what-are-event-brokers.htm\n[24] https://solace.com/blog/gartners-latest-advice-on-how-to-choose-an-event-broker/\n[25] https://www.nucamp.co/blog/coding-bootcamp-backend-with-python-2025-eventdriven-architectures-how-backend-systems-are-changing-in-2025\n[26] https://netmetic.wordpress.com/2020/07/17/gartners-advise-on-how-to-choose-an-event-broker-2/\n[27] https://en.wikipedia.org/wiki/Event-driven_architecture\n[28] https://www.ibm.com/think/topics/message-brokers\n[29] https://developer.confluent.io/patterns/event-stream/event-broker/\n[30] https://rasa.com/docs/rasa/next/event-brokers/\n[31] https://solace.com/what-is-event-driven-architecture/\n[32] https://www.gartner.com/en/documents/4004081\n[33] https://slashdot.org/software/event-brokers/\n[34] https://dzone.com/articles/top-5-considerations-when-selecting-an-event-broke\n[35] https://insights.daffodilsw.com/blog/event-driven-architecture-explained-with-real-world-examples\n[36] https://www.gartner.com/en/documents/5834147\n[37] https://help.pubsub.em.services.cloud.sap/Cloud/Deployment-Considerations/deployment-options-ownership.htm\n[38] https://www.rtinsights.com/dont-be-let-down-by-the-middleman-ensure-your-event-broker-is-the-best-in-the-business-for-your-business/\n[39] https://www.wearemci.com/en/insights/10-game-changing-event-trends-for-associations-in-2025\n[40] https://remo.co/blog/event-industry-statistics\n[41] https://hsmai.eu/2025/01/30/9-event-trends-that-will-shape-2025/\n[42] https://www.linkedin.com/pulse/b2b-event-trends-2025-insights-engaging-sustainable-anna-anisin-orxic\n[43] https://www.encoreglobal.com/news-releases/2024-outlook-research-insights-driving-the-events-industry/\n[44] https://www.eventible.com/learning/event-trends/\n[45] https://docs.solace.com/Get-Started/tutorial/event-broker-basics.htm\n[46] https://rasa.com/docs/rasa-pro/production/event-brokers/\n[47] https://tyk.io/learning-center/what-is-event-driven-architecture/\n[48] https://www.b2match.com/blog/how-to-organize-an-impactful-brokerage-event\n[49] https://docs.solace.com/Messaging/Topic-Architecture-Best-Practices.htm\n[50] https://help.sap.com/docs/integration-suite/sap-integration-suite/f72428ff67db467ab1673e85a9b61927.html\nPerplexity 로부터의 답변: pplx.ai/share 좋습니다. 다음은 “Event Brokers” 주제에 대한 체계적인 조사 및 정리입니다. 이 내용은 AWS, Confluent, Red Hat 등 공식 자료 기반으로 정리되었습니다.\n✅ 1. 주제의 분류 적절성 분류: Computer Science and Engineering \u003e Backend Development \u003e Event and Message Brokers \u003e Fundamentals\n적절성: ✔ 매우 적절합니다.\nEvent Broker는 백엔드 아키텍처의 메시징, 비동기 처리, 시스템 해석 및 설계에 직접적으로 관련되며, 특히 마이크로서비스 환경에서 필수적인 구성 요소입니다.\n✅ 2. 요약 문장 (200자 이내) Event Broker는 이벤트 기반 아키텍처에서 시스템 간 메시지를 중개하여, 비동기 통신, 느슨한 결합, 확장성 있는 설계를 가능하게 하는 핵심 인프라 컴포넌트입니다.\n✅ 3. 전체 개요 (250자 이내) Event Broker는 이벤트 기반 아키텍처에서 이벤트를 생산자에서 소비자로 전달하는 메시징 컴포넌트입니다. 마이크로서비스, 클라우드 네이티브 환경에서 시스템 간 느슨한 결합과 비동기 통신을 통해 확장성과 장애 격리에 기여하며, 실시간 데이터 스트리밍, 알림 시스템, 자동화 워크플로우 등 다양한 곳에 활용됩니다.\n✅ 4. 핵심 개념 항목 설명 Event 시스템 내 상태 변화나 행동을 나타내는 데이터 단위. 예: “OrderPlaced” Event Producer 이벤트를 생성하여 브로커에 전달하는 주체. 예: 주문 서비스 Event Consumer 이벤트를 구독하고 처리하는 주체. 예: 재고 서비스 Event Broker 이벤트를 수신하고 적절한 소비자에게 전달하는 중재자 역할. Topic / Channel 이벤트를 분류해주는 라우팅 단위. 구독자는 토픽을 기준으로 메시지를 받음. Event-Driven Architecture (EDA) 이벤트를 중심으로 동작하는 아키텍처 패턴. 서비스 간 느슨한 결합과 확장성 지원. ✅ 5. 주제별 상세 조사 (참고사항 반영) 5.1 목적 및 필요성 비동기 통신 지원: 요청-응답 구조를 벗어나 서비스 간 독립성 보장\n확장성: 생산자, 소비자가 독립적으로 확장 가능\n장애 격리: 서비스 장애 시에도 이벤트 처리 보장\n실시간 반응성: 사용자 행동에 빠른 대응\n5.2 주요 기능 및 역할 기능 설명 이벤트 수신 생산자가 생성한 이벤트 수신 이벤트 저장 디스크 기반의 로그 또는 큐 형태로 보관 이벤트 라우팅 토픽 기반 또는 규칙 기반으로 소비자에게 전달 이벤트 재처리 실패한 이벤트의 재시도 또는 리플레이 기능 제공 메시지 순서 보장 FIFO(First In First Out) 보장 (선택적) 메시지 중복 제거 멱등성(idempotency) 보장 기능 제공 5.3 특징 비동기, 느슨한 결합\nPub/Sub 또는 Queue 모델 채택\n높은 처리량과 신뢰성\n스케일 아웃(Scale-out) 구조 지원\n5.4 핵심 원칙 원칙 설명 비동기 메시징 서비스 간 직접 호출 대신 이벤트를 통해 상호작용 느슨한 결합 시스템 간 독립성 유지 발행-구독 (Pub/Sub) 이벤트 브로커가 생산자-소비자 간 직접 연결을 제거 리액티브 처리 이벤트 기반 반응형 프로세싱 가능 5.5 주요 원리 및 작동 원리 작동 흐름 다이어그램:\n1 2 3 [Producer] --\u003e [Event Broker] --\u003e [Consumer] | | | [이벤트 생성] [이벤트 라우팅] [이벤트 처리] Producer는 이벤트를 Broker에게 보냄\nBroker는 토픽 또는 규칙 기반으로 Consumer에게 전달\nConsumer는 이벤트를 비동기적으로 수신하고 처리\n5.6 구조 및 아키텍처 ✅ 필수 구성 요소 구성 요소 설명 Producer 이벤트를 생성해 브로커에 전달 Broker 이벤트를 수신, 저장, 라우팅 Consumer 이벤트를 수신해 처리 수행 Topic / Channel 메시지 분류 단위 Storage (Log) 이벤트 내구성 보장, 재처리를 위한 저장소 🔁 선택 구성 요소 구성 요소 설명 Rule Engine 이벤트 라우팅에 조건 기반 처리 적용 Event Router 이벤트를 다양한 소비자에게 라우팅 Retry Queue / DLQ 실패 이벤트를 위한 재처리 큐 구성 ✅ 아키텍처 다이어그램 (간단화) 1 2 3 4 5 6 7 +------------+ +-------------+ +------------+ | Producer | -----\u003e | Event Broker | --\u003e | Consumer | +------------+ +-------------+ +------------+ | +----------+ | Topic/Log | +----------+ 5.7 구현 기법 구현 방식 정의 주요 구성 목적 예시 Pub/Sub 발행자가 메시지를 전송하고 구독자가 수신 Topic, Subscriber 비동기 통신 Kafka, Pulsar Queue-based 메시지가 큐에 쌓이고 소비자가 처리 Queue, Consumer 순차적 처리, 병렬성 제한 RabbitMQ, SQS Rule-based Routing 조건 기반으로 라우팅 Rule, EventPattern 조건 기반 처리 AWS EventBridge Replay / Log-based 이벤트를 저장하고 재생 가능 Storage, Offset 재처리 및 감사 Kafka log 5.8 장점과 단점 구분 항목 설명 ✅ 장점 확장성 생산자/소비자의 독립적 스케일링 가능 유연성 마이크로서비스 통합 용이 장애 격리 일부 소비자가 실패해도 전체 영향 없음 이벤트 저장 과거 이벤트 재처리 가능 ⚠ 단점 설계 복잡도 메시지 흐름과 데이터 흐름 이해 필요 중복 처리 위험 멱등성 구현 필요 모니터링 부담 메시지 지연/손실 추적 필요 순서 보장 이슈 다중 파티션 사용 시 순서 깨질 수 있음 5.9 분류에 따른 종류 및 유형 분류 기준 유형 설명 메시징 모델 Pub/Sub 다수 소비자 대상 이벤트 분배 큐 기반 단일 소비자 처리 (FIFO) 전달 보장 At-most-once 최대 한 번, 손실 가능 At-least-once 중복 가능, 반드시 한 번 이상 Exactly-once 중복 없이 정확히 한 번 배포 형태 클라우드 기반 AWS EventBridge, GCP Pub/Sub 온프레미스 Kafka, RabbitMQ, NATS 좋습니다. 이어서 실무 적용 예시부터 정리해드리겠습니다.\n✅ 5.10 실무 적용 예시 사례 설명 주문 처리 시스템 사용자가 상품을 주문하면 OrderCreated 이벤트를 발행하고, 결제, 재고, 배송 서비스가 이를 소비함 실시간 알림 시스템 게시글에 댓글이 달리면 이벤트를 통해 사용자에게 푸시 알림을 전송 IoT 센서 네트워크 센서가 측정한 데이터를 이벤트로 브로커에 보내고, 분석 서비스가 이를 실시간 처리 로그 수집 및 분석 다양한 마이크로서비스에서 발생하는 로그를 이벤트로 Kafka에 전송하고, ELK(Elasticsearch, Logstash, Kibana)로 분석 결제 거래 흐름 추적 사용자의 결제 이벤트 흐름을 전송하여 상태 변화 추적 및 자동화 처리 수행 ✅ 5.11 활용 사례 📌 상황: 이커머스 플랫폼의 실시간 주문-배송 연동 시나리오 설명:\n고객이 주문을 완료하면 결제, 재고 확인, 배송 예약 등의 처리가 순차적으로 이루어짐. 각 단계는 독립된 마이크로서비스로 구성되어 있음.\n사용 시스템 구성:\n구성 요소 기술 이벤트 브로커 Apache Kafka 주문 서비스 Spring Boot (Producer) 결제 서비스 Node.js 재고 서비스 Python FastAPI 배송 서비스 Golang 알림 서비스 Firebase Messaging (Consumer) 워크플로우:\n주문 발생 → OrderCreated 이벤트 Kafka에 발행\n결제/재고 서비스는 해당 이벤트 구독 후 처리\n결제 완료 → PaymentSuccess 이벤트 발행\n배송 서비스는 이를 구독하고 배송 스케줄링\n알림 서비스는 각 단계의 이벤트를 수신하여 사용자에게 알림 전송\n역할 분담:\nKafka: 모든 이벤트의 전달 및 순서 제어\n각 서비스: 자신의 도메인 처리만 책임, 이벤트에 반응\n✅ 5.12 실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점 항목 설명 권장사항 멱등성 처리 중복 메시지로 인한 중복 처리 방지 필요 메시지에 ID 부여, 상태 체크 후 처리 이벤트 스키마 관리 필드 추가/변경 시 하위 호환성 이슈 Avro + Schema Registry 사용 소비자 장애 복구 소비자 실패 시 데이터 유실 위험 Retry + Dead Letter Queue 구성 보안 및 인증 브로커 접근 제어 필요 TLS, SASL, IAM 정책 구성 운영 모니터링 메시지 지연, 실패 추적 필수 Prometheus, Grafana, Kafka UI 도입 데이터 유실 방지 브로커 저장소나 파티션 장애 시 손실 발생 가능 Replication, 메시지 영속화 설정 ✅ 5.13 성능을 최적화하기 위한 고려사항 및 주의할 점 항목 설명 권장사항 처리량 (Throughput) 초당 메시지 전송량 제한 배치 전송, 압축 사용, 프로듀서 설정 조정 지연시간 (Latency) 소비자 수신 지연 빠른 네트워크, 바이너리 포맷(Avro 등) 사용 저장 공간 로그 기반 브로커는 저장공간 이슈 있음 보존 기간 설정, 압축 활성화 파티션 설계 너무 적으면 병렬성 부족, 많으면 오버헤드 증가 토픽 설계 시 키 기반 파티션 전략 사용 메시지 크기 큰 메시지는 처리 및 전송 부담 파일은 별도 저장, 링크만 이벤트에 포함 소비자 병렬성 단일 소비자는 처리량 한계 Consumer Group으로 수평 확장 ✅ 5.14 2025년 기준 최신 동향 주제 항목 설명 기술 Apache Kafka 4.0 KRaft 기반으로 Zookeeper 제거, 관리 단순화 클라우드 AWS EventBridge 성장 이벤트 중심 SaaS 간 통합 허브로 확장 표준화 AsyncAPI 메시징 기반 API 명세화 도구로 도입 확산 아키텍처 Event Mesh 다양한 브로커를 통합하는 메시지 네트워크 개념 확대 보안 메시지 레벨 암호화 데이터 보안 요구 증가에 따라 메시지 단위 보호 강화 ✅ 5.15 주제와 관련하여 주목할 내용 주제 항목 설명 운영 자동화 브로커 오토스케일링 Kubernetes 기반 자동 확장 구현 확대 고가용성 다중 브로커 클러스터 장애 대비용 이중화 구성이 보편화 메시지 포맷 Protobuf, Avro 성능, 용량, 스키마 진화성에서 주목받는 포맷 Event Replay Kafka, Pulsar 등에서 지원 장애 시 재처리 및 감사용으로 활용 증가 ✅ 5.16 앞으로의 전망 주제 항목 설명 아키텍처 전환 이벤트 기반 설계 표준화 기존 REST 기반 시스템도 이벤트 중심으로 재편 중 산업 확산 IoT, AI 기반 시스템 증가 실시간 데이터 수집 및 반응형 처리가 필수화됨 통합 표준 AsyncAPI + OpenAPI 연동 메시징과 REST API 명세 통합 시도 활발 서비스화 Event Broker as a Service Kafka, EventBridge 등 완전관리형 서비스 확산 지속 ✅ 5.17 하위 주제별 추가 학습 목록 카테고리 주제 설명 아키텍처 Event Mesh 다중 브로커 통합과 글로벌 이벤트 전파 설계 전략 이벤트 스키마 설계 이벤트 정의 시 필수 고려사항 및 버전 관리 보안 메시징 인증 및 암호화 TLS, OAuth, IAM 기반 접근 제어 기법 테스트 이벤트 기반 통합 테스트 E2E 흐름 테스트 및 시뮬레이션 전략 성능 이벤트 병렬 처리 전략 Partition, Consumer Group 구성 전략 학습 ✅ 5.18 관련 분야별 추가 학습 목록 카테고리 주제 설명 데이터 엔지니어링 Kafka Connect / Kafka Streams 외부 시스템 연동 및 스트림 처리 학습 DevOps Kafka 클러스터 운영 배포, 모니터링, 확장 전략 학습 클라우드 아키텍처 AWS EventBridge, SNS/SQS 완전관리형 메시징 서비스 설계 AI/ML 실시간 추론 트리거 이벤트 기반 ML 모델 실행 자동화 보안 Event Audit Logging 이벤트 추적을 위한 로깅 및 감사 전략 🧾 용어 정리 용어 설명 Event Broker 이벤트를 생산자에서 소비자로 전달하는 중간 시스템 Pub/Sub 발행-구독 모델로, 하나의 발행자가 다수 소비자에게 메시지를 전파 Dead Letter Queue (DLQ) 처리 실패한 메시지를 보관하여 별도로 처리하는 큐 AsyncAPI 메시지 기반 API 명세를 위한 표준 포맷 Event Mesh 다양한 브로커를 하나의 통합 메시지 시스템처럼 연결한 구조 🔗 참고 및 출처 What is an Event Broker - Confluent\nAWS EventBridge 공식 페이지\nRed Hat - Event-Driven Architecture 소개\nApache Kafka 공식 문서\nAsyncAPI 공식 웹사이트\n필요하시면 “Event Broker 구축 예제 코드”, “Kafka vs EventBridge 비교”, “Kafka 모니터링 지표 및 실전 대시보드 구성”도 제공해드릴 수 있습니다. 어떤 부분을 더 살펴볼까요?\n아래에 요청하신 세 가지 항목을 실무 기준으로 구체적으로 정리해드립니다:\n✅ 1. Event Broker 구축 예제 코드 (Kafka 기반, Python) 🎯 목표: Kafka를 사용하여 Event Broker 환경을 구축하고 간단한 Producer-Consumer 이벤트 흐름을 구현합니다.\n📦 구성: Apache Kafka\nPython (kafka-python 라이브러리)\n1-1. 설치 준비 1 2 3 4 5 6 7 8 9 # Kafka \u0026 Zookeeper 실행 (Docker 기반 예시) docker run -d --name zookeeper -p 2181:2181 zookeeper docker run -d --name kafka -p 9092:9092 \\ -e KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181 \\ -e KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://localhost:9092 \\ -e KAFKA_LISTENER_SECURITY_PROTOCOL_MAP=PLAINTEXT:PLAINTEXT \\ -e KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1 \\ --network=host \\ confluentinc/cp-kafka 1-2. Python Producer 코드 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # producer.py from kafka import KafkaProducer import json producer = KafkaProducer( bootstrap_servers='localhost:9092', value_serializer=lambda v: json.dumps(v).encode('utf-8') ) event = {'event_type': 'OrderCreated', 'order_id': 1234, 'user_id': 5678} producer.send('order-events', value=event) producer.flush() print(\"✅ OrderCreated 이벤트 전송 완료\") 1-3. Python Consumer 코드 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # consumer.py from kafka import KafkaConsumer import json consumer = KafkaConsumer( 'order-events', bootstrap_servers='localhost:9092', auto_offset_reset='earliest', group_id='order-service', value_deserializer=lambda m: json.loads(m.decode('utf-8')) ) for message in consumer: print(f\"✅ 수신된 이벤트: {message.value}\") ✅ 2. Kafka vs AWS EventBridge 비교 항목 Apache Kafka AWS EventBridge 설치 형태 자체 호스팅 또는 Confluent Cloud 완전관리형 (서버리스) 프로토콜 TCP 기반 고속 스트리밍 HTTP 기반 이벤트 버스 스키마 관리 Avro + Schema Registry JSON + Schema Registry 이벤트 처리 고속, 실시간, 다중 소비자 규칙 기반 라우팅, 느린 이벤트 처리 가능 통합성 외부 도구와의 커스텀 연동 용이 AWS 서비스와의 통합 강력 보안 TLS, ACL 등 자체 구성 IAM, 리소스 정책 통합 사용 사례 실시간 로그, 스트리밍 분석 SaaS 이벤트 통합, 워크플로우 트리거링 장점 고성능, 유연성, 재처리 가능 간단한 설정, 완전관리형 단점 운영 복잡, 설정 어려움 Throughput 제한, 제약된 커스터마이징 🧠 추천 시나리오:\nKafka: 대량의 실시간 데이터 처리 및 복잡한 이벤트 스트림 처리\nEventBridge: 서버리스 아키텍처, AWS 서비스 간 이벤트 통합 중심\n✅ 3. Kafka 모니터링 지표 및 실전 대시보드 구성 (Prometheus + Grafana) 📊 주요 지표 지표 설명 kafka_server_brokertopicmetrics_messages_in_total 초당 수신 메시지 수 kafka_server_brokertopicmetrics_bytes_in_total 수신 바이트 수 kafka_server_brokertopicmetrics_bytes_out_total 전송 바이트 수 kafka_server_replicamanager_underreplicated_partitions 동기화 안된 파티션 수 kafka_network_requestmetrics_requests_total 총 네트워크 요청 수 kafka_controller_kafkacontroller_activecontrollercount 활성 컨트롤러 수 (1이 아니면 비정상) kafka_log_logsize 토픽/파티션별 로그 사이즈 🛠️ 실전 대시보드 구성 Exporter 설치\nKafka용 JMX Exporter 사용: 1 2 java -javaagent:/opt/jmx_prometheus_javaagent.jar=7071:/opt/kafka.yml \\ -jar kafka-server-start.sh … Prometheus 설정 예시 1 2 3 4 scrape_configs: - job_name: 'kafka' static_configs: - targets: ['localhost:7071'] Grafana 대시보드 템플릿 ID: 7589 (confluentinc 제공 Kafka Dashboard)\n대시보드 포함 항목:\n브로커별 처리량\n파티션 상태\nlag 상태\nconsumer group health\n메시지 지연 현황\n📍 Grafana Dashboards 공식 페이지\n필요하시면 다음 항목도 추가 제공 가능합니다:\nKafka + Flink 실시간 분석 연동 예제\nEventBridge를 사용한 AWS 서비스 오케스트레이션 사례\nKafka Streams와 KSQL 사용법\n원하시는 방향이 있다면 이어서 더 지원하겠습니다.\n이벤트 및 메시지 브로커 1. 주제의 분류 적절성 확인 “Event and Message Brokers\"는 “Computer Science and Engineering” \u003e “Backend Development” 분류가 매우 적절합니다. 이벤트 및 메시지 브로커는 백엔드 시스템의 핵심 구성 요소로, 분산 시스템에서 비동기 통신을 가능하게 하고 시스템 간 결합도를 낮추는 데 중요한 역할을 합니다.\n2. 요약 (200자 내외) 이벤트 및 메시지 브로커는 서로 다른 시스템이나 애플리케이션 간 비동기 통신을 가능하게 하는 미들웨어로, 메시지 브로커는 안전한 메시지 전달과 라우팅에 중점을 두고, 이벤트 브로커는 대용량 데이터 처리와 이벤트 기록 보존에 중점을 둡니다. 대표적으로 메시지 브로커는 RabbitMQ, 이벤트 브로커는 Apache Kafka가 있습니다.\n3. 개요 (250자 내외) 이벤트 및 메시지 브로커는 현대 백엔드 아키텍처에서 핵심적인 통신 메커니즘을 제공하는 미들웨어 시스템입니다. 이들은 분산 시스템에서 애플리케이션 간의 느슨한 결합을 가능하게 하고, 비동기 통신을 통해 시스템 확장성과 안정성을 높입니다. 메시지 브로커가 메시지의 안전한 전달과 순서 보장에 중점을 두는 반면, 이벤트 브로커는 대용량 이벤트 데이터의 실시간 처리와 영구 저장에 특화되어 있습니다.\n4. 핵심 개념 메시지 브로커(Message Broker) 메시지 브로커는 서로 다른 시스템이나 애플리케이션 간의 메시지를 안전하게 송수신하도록 중개하는 소프트웨어입니다. 주요 목적은 메시지를 검증, 변환, 라우팅하여 적절한 수신자에게 전달하는 것입니다. 메시지 브로커는 메시지를 일시적으로 저장하고, 소비자가 처리될 때까지 보관합니다.\n이벤트 브로커(Event Broker) 이벤트 브로커는 시스템에서 발생하는 이벤트를 중계하는 미들웨어로, 이벤트 데이터를 로그 방식으로 저장하여 대용량 데이터를 효율적으로 처리할 수 있습니다. 이벤트 브로커는 이벤트 데이터를 영구적으로 저장하며, 소비자가 필요할 때 특정 시점부터 이벤트를 다시 소비할 수 있는 특징이 있습니다.\n생산자-소비자 패턴(Producer-Consumer Pattern) 메시지/이벤트 브로커에서는 메시지를 보내는 측(생산자, Producer)과 메시지를 받는 측(소비자, Consumer) 간의 통신 패턴입니다. 생산자는 브로커에 메시지를 발행하고, 소비자는 브로커로부터 메시지를 구독합니다.\n비동기 통신(Asynchronous Communication) 메시지/이벤트 브로커의 핵심 개념으로, 시스템 간에 실시간으로 응답을 기다리지 않고 독립적으로 작동할 수 있게 합니다. 이는 시스템의 확장성과 장애 대응력을 높입니다.\n느슨한 결합(Loose Coupling) 시스템 간 의존성을 최소화하는 설계 원칙으로, 메시지/이벤트 브로커를 통해 서비스들이 직접적인 연결 없이도 통신할 수 있게 합니다. 이를 통해 시스템 변경이나 확장 시 다른 시스템에 미치는 영향을 최소화할 수 있습니다.\n5. 주제와 관련하여 조사할 내용 목적 및 필요성 메시지 및 이벤트 브로커의 주요 목적은 분산 시스템에서 비동기 통신을 가능하게 하는 것입니다. 이를 통해 다음과 같은 필요성을 해결합니다:\n시스템 간 느슨한 결합 구현: 서비스 간 직접적인 의존성을 제거하여 각 서비스가 독립적으로 개발, 배포, 확장될 수 있도록 합니다. 부하 분산: 갑작스러운 트래픽 증가나 대량 요청 시에도 메시지를 일시적으로 저장하고 순차적으로 처리할 수 있습니다. 안정성 향상: 수신 시스템이 일시적으로 사용 불가능한 상황에서도 메시지를 보존하여 나중에 처리할 수 있습니다. 확장성 지원: 시스템 규모가 커지고 복잡해질수록 직접 연결 방식은 관리하기 어려워지므로, 브로커를 통한 중앙화된 통신 채널을 제공합니다. 비동기 처리: 응답을 기다리지 않고 처리할 수 있어 시스템 효율성이 향상됩니다. 주요 기능 및 역할 메시지 라우팅: 메시지를 적절한 수신자에게 전달합니다. 메시지 변환: 다양한 프로토콜과 데이터 형식 간 변환을 지원합니다. 메시지 저장: 소비자가 처리할 수 있을 때까지 메시지를 안전하게 저장합니다. 메시지 필터링: 특정 조건에 맞는 메시지만 선별하여 전달합니다. 부하 분산: 여러 소비자 간에 메시지를 분산시켜 처리 효율을 높입니다. 신뢰성 보장: 메시지 전달 성공 여부를 확인하고, 필요시 재전송합니다. 이벤트 지속성: 이벤트 브로커의 경우, 이벤트를 영구적으로 저장하여 나중에 접근할 수 있게 합니다. 특징 비동기 통신: 송신자와 수신자가 동시에 활성화되어 있지 않아도 메시지 교환이 가능합니다. 메시지 버퍼링: 대량의 메시지를 일시적으로 저장하여 처리 부하를 분산합니다. 확장성: 메시지 양이 증가해도 시스템을 수평적으로 확장할 수 있습니다. 장애 내구성: 시스템 일부가 실패해도 전체 시스템 중단 없이 계속 작동합니다. 다양한 통신 패턴 지원: 일대일, 일대다, 발행-구독 등 다양한 통신 패턴을 지원합니다. 플랫폼 독립성: 다양한 프로그래밍 언어와 플랫폼 간 통신을 가능하게 합니다. 핵심 원칙 메시지 지향 미들웨어(Message-Oriented Middleware, MOM) 원칙: 시스템 간 통신을 메시지 교환으로 추상화합니다. 발행-구독(Publish-Subscribe) 원칙: 메시지 생산자와 소비자 간의 느슨한 결합을 촉진합니다. 점대점(Point-to-Point) 원칙: 한 생산자가 하나의 소비자에게 메시지를 전달하는 방식입니다. 메시지 보존 원칙: 메시지는 소비될 때까지 안전하게 보존되어야 합니다. 멱등성(Idempotency) 원칙: 동일한 메시지가 여러 번 처리되더라도 시스템 상태는 동일해야 합니다. 순서 보장 원칙: 특정 상황에서는 메시지의 처리 순서가 보장되어야 합니다. 장애 격리 원칙: 한 시스템의 장애가 다른 시스템에 영향을 미치지 않아야 합니다. 주요 원리 및 작동 원리 메시지 브로커와 이벤트 브로커의 작동 원리는 다음과 같습니다:\n메시지 브로커 작동 원리 메시지 생성(Production): 생산자(Producer)가 메시지를 생성하여 브로커에 전송합니다. 메시지 수신 및 검증: 브로커는 메시지를 수신하고 유효성을 검증합니다. 메시지 라우팅: 브로커는 메시지의 라우팅 키나 주제(Topic)에 따라 메시지를 적절한 큐나 교환소(Exchange)로 라우팅합니다. 메시지 저장: 메시지는 큐에 저장되어 소비자가 처리할 수 있을 때까지 대기합니다. 메시지 소비(Consumption): 소비자(Consumer)는 큐에서 메시지를 가져와 처리합니다. 확인(Acknowledgment): 메시지 처리가 완료되면 소비자는 브로커에게 확인 메시지를 보내고, 브로커는 해당 메시지를 큐에서 제거합니다. 이벤트 브로커 작동 원리 이벤트 생성(Publication): 생산자(Publisher)가 이벤트를 생성하여 브로커에 발행(Publish)합니다. 이벤트 저장: 이벤트는 로그 형태로 영구적으로 저장됩니다. 이벤트 구독(Subscription): 소비자(Subscriber)는 특정 주제(Topic)나 파티션(Partition)을 구독합니다. 이벤트 배포: 브로커는 이벤트를 관련된 구독자에게 전달합니다. 이벤트 소비(Consumption): 구독자는 이벤트를 받아 처리합니다. 이때 이벤트는 로그에서 삭제되지 않고 유지됩니다. 오프셋 관리: 소비자는 자신이 어디까지 이벤트를 소비했는지에 대한 오프셋(Offset)을 관리하며, 필요시 이전 이벤트부터 다시 소비할 수 있습니다. 구조 및 아키텍처 메시지 브로커 아키텍처 메시지 브로커 시스템은 다음과 같은 주요 구성 요소로 이루어져 있습니다:\n필수 구성요소 브로커(Broker): 메시지 라우팅과 전달을 담당하는 중심 구성 요소입니다. 교환소(Exchange): 생산자로부터 받은 메시지를 라우팅 규칙에 따라 적절한 큐로 전달하는 역할을 합니다. 큐(Queue): 메시지가 소비자에게 전달되기 전에 임시 저장되는 공간입니다. 바인딩(Binding): 교환소와 큐를 연결하는 규칙으로, 어떤 메시지가 어떤 큐로 전달될지 결정합니다. 생산자(Producer): 메시지를 생성하여 브로커에게 전송하는 역할을 합니다. 소비자(Consumer): 큐에서 메시지를 가져와 처리하는 역할을 합니다. 선택 구성요소 가상 호스트(Virtual Host): 여러 사용자나 애플리케이션이 동일한 브로커를 독립적으로 사용할 수 있도록 논리적으로 분리하는 기능입니다. 메시지 우선순위(Priority): 특정 메시지에 우선순위를 부여하여 처리 순서를 조정할 수 있습니다. 메시지 TTL(Time-To-Live): 메시지가 큐에서 얼마나 오래 유지될지 설정할 수 있습니다. 데드 레터 교환소(Dead Letter Exchange): 처리에 실패한 메시지를 별도로 관리할 수 있는 특수 교환소입니다. 클러스터링(Clustering): 고가용성과 확장성을 위해 여러 브로커 노드를 연결할 수 있습니다. 메시지 브로커 아키텍처 다이어그램 이벤트 브로커 아키텍처 이벤트 브로커 시스템은 다음과 같은 주요 구성 요소로 이루어져 있습니다:\n필수 구성요소 브로커(Broker): 이벤트 수신, 저장, 전달을 담당하는 중심 노드입니다. 주제(Topic): 관련 이벤트를 그룹화하는 논리적 채널입니다. 파티션(Partition): 주제 내에서 이벤트를 분산 저장하고 병렬 처리하기 위한 물리적 분할입니다. 로그(Log): 이벤트가 영구적으로 저장되는 순차적 데이터 구조입니다. 생산자(Producer): 이벤트를 생성하여 브로커에게 전송하는 역할을 합니다. 소비자(Consumer): 브로커로부터 이벤트를 가져와 처리하는 역할을 합니다. 소비자 그룹(Consumer Group): 동일한 이벤트 스트림을 처리하는 소비자들의 집합입니다. 선택 구성요소 레플리케이션(Replication): 고가용성을 위해 파티션 데이터를 여러 브로커에 복제합니다. 지연 주제(Delayed Topic): 특정 시간 후에 처리되어야 하는 이벤트를 위한 특수 주제입니다. 컴팩션(Compaction): 동일한 키를 가진 이벤트 중 최신 이벤트만 보존하는 기능입니다. 스키마 레지스트리(Schema Registry): 이벤트 데이터의 스키마를 관리하고 검증하는 컴포넌트입니다. 스트림 처리(Stream Processing): 이벤트 스트림을 실시간으로 변환하고 처리하는 기능입니다. 이벤트 브로커 아키텍처 다이어그램 구현 기법 1. 발행-구독(Publish-Subscribe) 패턴 정의: 메시지 발행자(Publisher)가 특정 주제(Topic)나 채널에 메시지를 게시하고, 해당 주제를 구독한 모든 구독자(Subscriber)에게 메시지가 전달되는 방식입니다.\n구성:\n발행자(Publisher): 주제(Topic)에 메시지를 발행합니다. 주제(Topic): 메시지를 카테고리별로 분류합니다. 구독자(Subscriber): 특정 주제(Topic)를 구독하고 관련 메시지를 수신합니다. 목적:\n발행자와 구독자 간의 느슨한 결합을 제공합니다. 일대다(one-to-many) 통신을 가능하게 합니다. 비동기 메시지 전달을 지원합니다. 실제 예시:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 // Apache Kafka를 사용한 발행-구독 패턴 예시 (Java) // 발행자 코드 Properties props = new Properties(); props.put(\"bootstrap.servers\", \"localhost:9092\"); props.put(\"key.serializer\", \"org.apache.kafka.common.serialization.StringSerializer\"); props.put(\"value.serializer\", \"org.apache.kafka.common.serialization.StringSerializer\"); Producer producer = new KafkaProducer\u003c\u003e(props); ProducerRecord record = new ProducerRecord\u003c\u003e(\"my-topic\", \"key\", \"message-value\"); producer.send(record); producer.close(); // 구독자 코드 Properties props = new Properties(); props.put(\"bootstrap.servers\", \"localhost:9092\"); props.put(\"group.id\", \"consumer-group\"); props.put(\"key.deserializer\", \"org.apache.kafka.common.serialization.StringDeserializer\"); props.put(\"value.deserializer\", \"org.apache.kafka.common.serialization.StringDeserializer\"); Consumer consumer = new KafkaConsumer\u003c\u003e(props); consumer.subscribe(Arrays.asList(\"my-topic\")); while (true) { ConsumerRecords records = consumer.poll(Duration.ofMillis(100)); for (ConsumerRecord record : records) { System.out.printf(\"topic = %s, partition = %d, offset = %d, key = %s, value = %s%n\", record.topic(), record.partition(), record.offset(), record.key(), record.value()); } } 2. 점대점(Point-to-Point) 패턴 정의: 메시지 발신자가 특정 큐에 메시지를 전송하고, 하나의 소비자만이 해당 메시지를 처리하는 방식입니다.\n구성:\n발신자(Sender): 큐에 메시지를 전송합니다. 큐(Queue): 메시지를 일시적으로 저장합니다. 수신자(Receiver): 큐에서 메시지를 가져와 처리합니다. 목적:\n메시지가 정확히 한 번만 처리되도록 보장합니다. 부하 분산을 위해 여러 수신자 간에 메시지를 분배할 수 있습니다. 메시지의 순서 보장을 지원합니다. 실제 예시:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 // RabbitMQ를 사용한 점대점 패턴 예시 (Java) // 발신자 코드 ConnectionFactory factory = new ConnectionFactory(); factory.setHost(\"localhost\"); try (Connection connection = factory.newConnection(); Channel channel = connection.createChannel()) { String queueName = \"work-queue\"; channel.queueDeclare(queueName, true, false, false, null); String message = \"Task message\"; channel.basicPublish(\"\", queueName, MessageProperties.PERSISTENT_TEXT_PLAIN, message.getBytes()); System.out.println(\" [x] Sent '\" + message + \"'\"); } // 수신자 코드 ConnectionFactory factory = new ConnectionFactory(); factory.setHost(\"localhost\"); Connection connection = factory.newConnection(); Channel channel = connection.createChannel(); String queueName = \"work-queue\"; channel.queueDeclare(queueName, true, false, false, null); System.out.println(\" [*] Waiting for messages.\"); channel.basicQos(1); // 한 번에 하나의 메시지만 처리 DeliverCallback deliverCallback = (consumerTag, delivery) -\u003e { String message = new String(delivery.getBody(), \"UTF-8\"); System.out.println(\" [x] Received '\" + message + \"'\"); try { doWork(message); // 메시지 처리 작업 } finally { channel.basicAck(delivery.getEnvelope().getDeliveryTag(), false); // 메시지 확인 } }; channel.basicConsume(queueName, false, deliverCallback, consumerTag -\u003e { }); 3. 요청-응답(Request-Reply) 패턴 정의: 클라이언트가 서버에 요청 메시지를 보내고, 서버가 응답 메시지를 반환하는 방식입니다.\n구성:\n클라이언트(Client): 요청 메시지를 전송하고 응답을 기다립니다. 서버(Server): 요청 메시지를 처리하고 응답 메시지를 생성합니다. 요청 큐(Request Queue): 클라이언트의 요청 메시지가 저장됩니다. 응답 큐(Reply Queue): 서버의 응답 메시지가 저장됩니다. 목적:\n비동기적 요청-응답 패턴을 구현합니다. 분산 시스템에서 RPC(Remote Procedure Call)를 구현할 수 있습니다. 클라이언트와 서버 간의 느슨한 결합을 제공합니다. 실제 예시:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 // RabbitMQ를 사용한 요청-응답 패턴 예시 (Java) // 클라이언트 코드 ConnectionFactory factory = new ConnectionFactory(); factory.setHost(\"localhost\"); try (Connection connection = factory.newConnection(); Channel channel = connection.createChannel()) { String requestQueueName = \"rpc_queue\"; String replyQueueName = channel.queueDeclare().getQueue(); AMQP.BasicProperties props = new AMQP.BasicProperties .Builder() .correlationId(UUID.randomUUID().toString()) .replyTo(replyQueueName) .build(); String message = \"10\"; // 요청 메시지 (예: 피보나치 수열의 10번째 숫자 요청) channel.basicPublish(\"\", requestQueueName, props, message.getBytes()); // 응답 대기 final BlockingQueue response = new ArrayBlockingQueue\u003c\u003e(1); String ctag = channel.basicConsume(replyQueueName, true, (consumerTag, delivery) -\u003e { if (delivery.getProperties().getCorrelationId().equals(props.getCorrelationId())) { response.offer(new String(delivery.getBody(), \"UTF-8\")); } }, consumerTag -\u003e { }); String result = response.take(); channel.basicCancel(ctag); System.out.println(\"Got '\" + result + \"'\"); } // 서버 코드 ConnectionFactory factory = new ConnectionFactory(); factory.setHost(\"localhost\"); Connection connection = factory.newConnection(); Channel channel = connection.createChannel(); String queueName = \"rpc_queue\"; channel.queueDeclare(queueName, false, false, false, null); channel.basicQos(1); System.out.println(\" [x] Awaiting RPC requests\"); DeliverCallback deliverCallback = (consumerTag, delivery) -\u003e { AMQP.BasicProperties replyProps = new AMQP.BasicProperties .Builder() .correlationId(delivery.getProperties().getCorrelationId()) .build(); String response = \"\"; try { String message = new String(delivery.getBody(), \"UTF-8\"); int n = Integer.parseInt(message); System.out.println(\" [.] fib(\" + message + \")\"); response += fib(n); // 피보나치 수열 계산 } catch (RuntimeException e) { System.out.println(\" [.] \" + e.toString()); } finally { channel.basicPublish(\"\", delivery.getProperties().getReplyTo(), replyProps, response.getBytes(\"UTF-8\")); channel.basicAck(delivery.getEnvelope().getDeliveryTag(), false); } }; channel.basicConsume(queueName, false, deliverCallback, (consumerTag -\u003e {})); 4. 이벤트 소싱(Event Sourcing) 패턴 정의: 시스템의 상태 변화를 일련의 이벤트로 저장하고, 이벤트를 재생하여 현재 상태를 복원하는 방식입니다.\n구성:\n이벤트 저장소(Event Store): 모든 이벤트를 시간 순서대로 저장합니다. 이벤트 생성자(Event Producer): 상태 변화를 이벤트로 발행합니다. 이벤트 소비자(Event Consumer): 이벤트를 처리하여 시스템 상태를 업데이트합니다. 스냅샷(Snapshot): 성능 향상을 위해 특정 시점의 시스템 상태를 저장합니다. 목적:\n시스템의 모든 상태 변화에 대한 감사 추적(audit trail)을 제공합니다. 시스템 상태를 특정 시점으로 복원할 수 있는 시간 여행(time travel) 기능을 지원합니다. 상태 변화의 이유와 의도를 명확하게 표현할 수 있습니다. 높은 확장성과 동시성을 제공합니다. 실제 예시(시스템 구성):\n이벤트 저장소: Apache Kafka, Event Store DB 이벤트 처리: Spring Cloud Stream, Akka Streams 스냅샷 저장소: MongoDB, PostgreSQL 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 // 이벤트 소싱 패턴을 사용한 계좌 관리 예시 (Java) // 이벤트 정의 public interface AccountEvent { UUID getAccountId(); LocalDateTime getTimestamp(); } public class AccountCreatedEvent implements AccountEvent { private final UUID accountId; private final String owner; private final LocalDateTime timestamp; // 생성자, 게터 등 } public class MoneyDepositedEvent implements AccountEvent { private final UUID accountId; private final BigDecimal amount; private final LocalDateTime timestamp; // 생성자, 게터 등 } // 계좌 상태 관리 public class Account { private UUID id; private String owner; private BigDecimal balance; private boolean active; // 이벤트를 적용하여 상태 업데이트 public void apply(AccountEvent event) { if (event instanceof AccountCreatedEvent) { apply((AccountCreatedEvent) event); } else if (event instanceof MoneyDepositedEvent) { apply((MoneyDepositedEvent) event); } // 다른 이벤트 타입도 처리 } private void apply(AccountCreatedEvent event) { this.id = event.getAccountId(); this.owner = event.getOwner(); this.balance = BigDecimal.ZERO; this.active = true; } private void apply(MoneyDepositedEvent event) { this.balance = this.balance.add(event.getAmount()); } } // 이벤트 저장소 public interface EventStore { void save(AccountEvent event); List\u003cAccountEvent\u003e getEventsForAccount(UUID accountId); } // 계좌 서비스 public class AccountService { private final EventStore eventStore; public Account getAccount(UUID accountId) { List\u003cAccountEvent\u003e events = eventStore.getEventsForAccount(accountId); Account account = new Account(); // 모든 이벤트를 재생하여 현재 상태 복원 for (AccountEvent event : events) { account.apply(event); } return account; } public void deposit(UUID accountId, BigDecimal amount) { MoneyDepositedEvent event = new MoneyDepositedEvent(accountId, amount, LocalDateTime.now()); eventStore.save(event); } } 5. 명령 쿼리 책임 분리(CQRS: Command Query Responsibility Segregation) 패턴 정의: 시스템의 명령(상태 변경)과 쿼리(상태 조회)를 분리하여 각각에 최적화된 모델을 사용하는 패턴입니다. 종종 이벤트 소싱과 함께 사용됩니다.\n구성:\n명령 모델(Command Model): 시스템 상태를 변경하는 작업을 처리합니다. 쿼리 모델(Query Model): 시스템 상태를 조회하는 작업을 처리합니다. 이벤트 버스(Event Bus): 명령 모델의 변경 사항을 쿼리 모델에 전파합니다. 읽기 저장소(Read Store): 쿼리 성능 최적화를 위한 특수한 형태의 데이터 저장소입니다. 목적:\n읽기와 쓰기 작업을 분리하여 각각에 최적화된 성능을 제공합니다. 복잡한 도메인 모델과 간단한 쿼리 모델의 분리를 지원합니다. 확장성이 높은 시스템 아키텍처를 구현할 수 있습니다. 읽기 모델과 쓰기 모델 간의 낮은 결합도를 제공합니다. 실제 예시:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 // CQRS 패턴 예시 (Java) // 명령 부분 public interface AccountCommand { UUID getAccountId(); } public class CreateAccountCommand implements AccountCommand { private final UUID accountId; private final String owner; // 생성자, 게터 등 } public class DepositMoneyCommand implements AccountCommand { private final UUID accountId; private final BigDecimal amount; // 생성자, 게터 등 } public class AccountCommandHandler { private final EventStore eventStore; private final EventBus eventBus; public void handle(CreateAccountCommand command) { AccountCreatedEvent event = new AccountCreatedEvent(command.getAccountId(), command.getOwner(), LocalDateTime.now()); eventStore.save(event); eventBus.publish(event); } public void handle(DepositMoneyCommand command) { // 필요한 검증 로직 MoneyDepositedEvent event = new MoneyDepositedEvent(command.getAccountId(), command.getAmount(), LocalDateTime.now()); eventStore.save(event); eventBus.publish(event); } } // 쿼리 부분 public class AccountQueryService { private final AccountReadRepository repository; public AccountDTO getAccount(UUID accountId) { return repository.findById(accountId); } public List\u003cAccountDTO\u003e findAccountsByOwner(String owner) { return repository.findByOwner(owner); } } // 이벤트 핸들러 (쿼리 모델 업데이트) public class AccountEventHandler { private final AccountReadRepository repository; public void on(AccountCreatedEvent event) { AccountDTO dto = new AccountDTO(); dto.setId(event.getAccountId()); dto.setOwner(event.getOwner()); dto.setBalance(BigDecimal.ZERO); repository.save(dto); } public void on(MoneyDepositedEvent event) { AccountDTO dto = repository.findById(event.getAccountId()); dto.setBalance(dto.getBalance().add(event.getAmount())); repository.save(dto); } } 장점과 단점 구분 항목 설명 ✅ 장점 느슨한 결합(Loose Coupling) 서비스 간 직접적인 의존성이 없어 각 서비스를 독립적으로 개발, 배포, 확장할 수 있습니다. 비동기 통신 요청-응답 패턴과 달리 즉각적인 응답을 기다리지 않아도 되므로, 시스템 효율성이 향상됩니다. 부하 분산 갑작스러운 트래픽 증가 시에도 메시지를 버퍼링하여 순차적으로 처리할 수 있어 시스템 안정성이 높아집니다. 장애 격리 한 서비스의 장애가 다른 서비스에 직접적인 영향을 미치지 않습니다. 확장성 생산자와 소비자를 독립적으로 확장할 수 있어 시스템 확장이 용이합니다. 다양한 통신 패턴 지원 점대점, 발행-구독, 요청-응답 등 다양한 통신 패턴을 지원합니다. ⚠ 단점 복잡성 증가 분산 시스템 디버깅이 어렵고, 메시지 라우팅, 재시도 등의 복잡한 로직이 필요합니다. 일관성 보장의 어려움 일시적인 데이터 불일치가 발생할 수 있으며, 최종 일관성(eventual consistency)에 의존해야 합니다. 운영 오버헤드 브로커 설정, 모니터링, 확장 등 추가적인 운영 부담이 있습니다. 메시지 순서 보장의 어려움 분산 환경에서 메시지 순서를 완벽하게 보장하기 어려울 수 있습니다. 브로커 장애 위험 브로커 자체가 시스템의 단일 장애 지점(SPOF)이 될 수 있습니다. 도전 과제 일관성과 순서 보장: 분산 환경에서 메시지/이벤트의 순서를 보장하고 일관성을 유지하는 것은 어렵습니다. 특히 파티셔닝과 샤딩을 사용할 때 더욱 어렵습니다.\n확장성과 성능: 대용량 메시지/이벤트 처리 시 브로커의 확장성과 성능을 유지하는 것이 중요합니다. 특히 브로커가 단일 장애 지점이 되지 않도록 분산 아키텍처를 설계해야 합니다.\n메시지 중복 처리: 네트워크 장애 등으로 인해 동일한 메시지가 여러 번 전송될 수 있으므로, 멱등성(idempotency)을 구현하여 중복 처리를 방지해야 합니다.\n데드레터 처리: 실패한 메시지를 처리하기 위한 데드레터 큐(Dead Letter Queue) 및 재시도 메커니즘을 구현해야 합니다.\n보안과 인증: 브로커 접근 제어, 메시지/이벤트 암호화, 인증 등의 보안 메커니즘을 구현해야 합니다.\n모니터링과 디버깅: 분산 시스템에서 메시지/이벤트 흐름을 추적하고 디버깅하는 것은 어렵습니다. 효과적인 모니터링 및 로깅 전략이 필요합니다.\n스키마 진화: 시간이 지남에 따라 메시지/이벤트 스키마가 변경될 수 있으므로, 하위 호환성을 유지하면서 스키마를 진화시키는 방법이 필요합니다.\n장애 복구와 내구성: 브로커 장애 시 메시지/이벤트 손실을 방지하고 신속하게 복구할 수 있는 메커니즘이 필요합니다.\n분류에 따른 종류 및 유형 분류 유형 특징 사용 사례 대표 기술 통신 모델 점대점(Point-to-Point) 하나의 발신자에서 하나의 수신자로 메시지 전달 작업 큐, 부하 분산 RabbitMQ, ActiveMQ 발행-구독(Publish-Subscribe) 하나의 발행자에서 여러 구독자로 메시지 전달 이벤트 알림, 브로드캐스트 Kafka, MQTT 요청-응답(Request-Reply) 요청 메시지 전송 후 응답 메시지 수신 RPC, 분산 서비스 RabbitMQ, ZeroMQ 메시지 저장 방식 인메모리(In-memory) 메시지를 메모리에 저장하여 빠른 처리 실시간 데이터 처리 Redis 디스크 기반(Disk-based) 메시지를 디스크에 저장하여 내구성 보장 중요 트랜잭션, 장기 저장 Kafka, RabbitMQ 하이브리드(Hybrid) 인메모리와 디스크 기반 접근 방식 결합 성능과 내구성 모두 중요한 경우 Apache Pulsar 브로커 유형 메시지 브로커(Message Broker) 메시지를 큐에 저장하고 소비 후 삭제 작업 큐, 비동기 통신 RabbitMQ, ActiveMQ 이벤트 브로커(Event Broker) 이벤트를 로그에 저장하고 유지 이벤트 소싱, 스트림 처리 Kafka, EventStoreDB 서비스 버스(Service Bus) 메시지 라우팅, 변환, 조정 기능 엔터프라이즈 통합 Azure Service Bus, NServiceBus 분산 아키텍처 중앙 집중형(Centralized) 단일 브로커 인스턴스 또는 클러스터 소규모 시스템, 간단한 통합 Redis PubSub 분산형(Distributed) 여러 브로커 노드가 분산되어 작동 대규모 시스템, 고가용성 필요 Kafka, RabbitMQ 클러스터 메시 아키텍처(Mesh) 브로커 간 직접 통신 지원 글로벌 분산 시스템 NATS, Kafka MirrorMaker 프로토콜 AMQP 고급 메시지 큐 프로토콜 엔터프라이즈 메시징 RabbitMQ, ActiveMQ MQTT 경량 M2M 통신 프로토콜 IoT, 모바일 Mosquitto, HiveMQ STOMP 심플 텍스트 지향 메시징 프로토콜 웹 애플리케이션 RabbitMQ, ActiveMQ Kafka 프로토콜 바이너리 TCP 기반 프로토콜 대용량 스트리밍 Kafka 실무 적용 예시 분야 사용 사례 설명 적용 기술 전자상거래 주문 처리 주문 접수 후 결제, 재고 확인, 배송 등의 프로세스를 비동기적으로 처리 RabbitMQ, Amazon SQS 금융 결제 시스템 결제 요청을 안전하게 처리하고 관련 시스템(회계, 사기 감지 등)에 알림 Kafka, ActiveMQ 물류 재고 관리 재고 변경 이벤트를 처리하여 재고 수준을 실시간으로 추적 Kafka, RabbitMQ IoT 센서 데이터 수집 대량의 센서 데이터를 수집하여 분석 시스템으로 전달 MQTT, Kafka 소셜 미디어 알림 서비스 사용자 활동(댓글, 좋아요 등)에 대한 알림을 실시간으로 처리 Redis PubSub, Kafka 게임 멀티플레이어 게임 플레이어 간 상호작용 및 게임 상태 변경 이벤트 처리 NATS, Redis PubSub 데이터 분석 실시간 분석 발생하는 이벤트를 실시간으로 수집하여 분석 파이프라인으로 전달 Kafka, Apache Pulsar 마이크로서비스 서비스 간 통신 서비스 간 느슨한 결합을 유지하면서 데이터 교환 RabbitMQ, Kafka 모니터링 로그 수집 분산 시스템의 로그 데이터를 중앙 집중화하여 모니터링 Kafka, Fluentd 클라우드 이벤트 기반 자동화 클라우드 리소스 변경 이벤트에 대응하여 작업 자동화 AWS EventBridge, Azure Event Grid 활용 사례 금융 거래 처리 시스템(RabbitMQ와 Kafka를 활용한 하이브리드 아키텍처) 시나리오: 대형 금융 기관에서 다양한 채널(웹, 모바일, ATM 등)을 통해 들어오는 거래 요청을 안정적으로 처리하고, 관련 시스템(계정 관리, 사기 감지, 회계, 감사, 고객 알림 등)과 통합하는 시스템을 구축해야 합니다.\n시스템 구성:\nRabbitMQ 클러스터:\n거래 요청 수신 및 초기 처리 작업 큐를 통한 부하 분산 트랜잭션 보장을 위한 메시지 확인(acknowledgment) 메커니즘 활용 Apache Kafka 클러스터:\n모든 거래 이벤트 기록 및 유지 다양한 시스템에 이벤트 스트림 제공 실시간 분석 및 모니터링 지원 서비스 컴포넌트:\n거래 처리 서비스: 실제 거래 로직 실행 사기 감지 서비스: 실시간으로 이상 거래 탐지 알림 서비스: 고객에게 거래 알림 전송 분석 서비스: 거래 패턴 분석 및 리포트 생성 아카이브 서비스: 이벤트를 장기 저장소에 보관 시스템 다이어그램:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 +--------------------+ +---------------------+ +------------------------+ | 채널 (웹/모바일/ATM) |----\u003e| API 게이트웨이 (Kong) |----\u003e| 트랜잭션 유효성 검증 서비스 | +--------------------+ +---------------------+ +------------------------+ | v +------------------+ +------------------+ +------------------------+ | 알림 서비스 |\u003c----| RabbitMQ 클러스터 |\u003c----| 트랜잭션 라우팅 서비스 | +------------------+ +------------------+ +------------------------+ | | | | v v | +------------------------+ +----------------------+ | | 트랜잭션 처리 서비스 풀 | | Kafka Connect (CDC) | | +------------------------+ +----------------------+ | | | v v v +------------------+ +------------------+ +---------------------+ | 고객 앱/이메일/SMS | | 데이터베이스 시스템 | | Kafka 클러스터 | +------------------+ +------------------+ +---------------------+ | | v v +----------------+ +----------------+ | 실시간 분석 시스템 | | 이벤트 아카이빙 | +----------------+ +----------------+ 워크플로우:\n고객이 다양한 채널을 통해 거래 요청을 시작합니다. API 게이트웨이가 요청을 수신하고 기본 유효성 검사를 수행합니다. 트랜잭션 유효성 검증 서비스가 요청을 검증하고 필요한 변환을 수행합니다. 트랜잭션 라우팅 서비스가 요청 유형에 따라 적절한 RabbitMQ 큐로 메시지를 라우팅합니다. RabbitMQ는 메시지를 적절한 트랜잭션 처리 서비스로 전달합니다. 트랜잭션 처리 서비스는 거래를 처리하고 결과를 데이터베이스에 저장합니다. 데이터베이스 변경 사항은 Kafka Connect의 CDC(Change Data Capture)를 통해 Kafka로 전파됩니다. 알림 서비스는 RabbitMQ로부터 처리 결과를 수신하고 고객에게 알림을 전송합니다. Kafka에 저장된 이벤트 스트림은 실시간 분석 시스템, 사기 감지 시스템 등 다양한 소비자가 활용합니다. 장기 보관이 필요한 이벤트는 이벤트 아카이빙 시스템으로 전송됩니다. 역할 및 책임:\nRabbitMQ: 신뢰성 있는 메시지 전달, 작업 큐 관리, 트랜잭션 처리 보장 Kafka: 이벤트 스트림 저장 및 배포, 실시간 데이터 파이프라인 제공 서비스 컴포넌트: 비즈니스 로직 처리, 데이터 변환, 고객 상호작용 관리 이 아키텍처의 주요 이점은 다음과 같습니다:\n고가용성과 확장성을 제공하는 분산 설계 RabbitMQ를 통한 안정적인 트랜잭션 처리 Kafka를 통한 완전한 이벤트 기록 및 실시간 분석 지원 시스템 컴포넌트 간의 느슨한 결합으로 유지보수성 향상 장애 상황에서도 데이터 손실 방지 및 빠른 복구 실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점 고려사항 설명 권장사항 메시지/이벤트 스키마 설계 메시지 구조와 데이터 형식이 시스템 통합에 큰 영향을 미침 스키마 레지스트리 도입, 버전 관리 체계 구축, 하위 호환성 유지 배포 전략 브로커 인프라의 가용성과 확장성이 전체 시스템에 영향을 줌 클러스터링, 고가용성 설정, 지역 분산 배포, 장애 조치(failover) 메커니즘 구현 모니터링 및 알림 브로커 및 메시지 흐름에 대한 가시성 확보가 중요 포괄적인 모니터링 도구 도입, 주요 지표 대시보드 구성, 자동 알림 설정 메시지 우선순위 중요한 메시지가 적시에 처리되어야 함 우선순위 큐 활용, 중요 메시지용 전용 채널 구성, QoS(Quality of Service) 설정 적용 메시지 재시도 및 실패 처리 일시적 장애로 인한 메시지 처리 실패 대응 필요 지수 백오프 재시도 전략, 데드레터 큐(DLQ) 구현, 실패 메시지 모니터링 및 알림 보안 및 인증 브로커 접근 제어 및 메시지 보안이 중요 TLS/SSL 암호화 적용, 강력한 인증 메커니즘 구현, 세분화된 접근 제어 설정 일관성 보장 분산 환경에서 메시지 순서 및 처리 보장이 어려움 파티션 키 전략 수립, 메시지 ID 및 타임스탬프 활용, 멱등 소비자 구현 용량 계획 메시지 볼륨 및 브로커 리소스 요구사항 예측 필요 부하 테스트 수행, 확장 계획 수립, 자동 스케일링 메커니즘 구현 로깅 및 추적 메시지 흐름 추적 및 문제 해결 필요 상관관계 ID 도입, 분산 추적 시스템 구현, 구조화된 로깅 표준 적용 백업 및 복구 데이터 손실 방지 및 재해 복구 계획 필요 정기적 백업 수행, 복구 계획 문서화, 복구 훈련 실시 최적화하기 위한 고려사항 및 주의할 점 고려사항 설명 권장사항 메시지 크기 큰 메시지는 네트워크 대역폭과 브로커 성능에 영향을 줌 메시지 크기 제한 설정, 대용량 콘텐츠는 외부 저장소 활용, 메시지 압축 적용 배치 처리 개별 메시지 처리는 오버헤드가 크므로 성능 저하 가능 생산자 및 소비자 배치 설정 최적화, 배치 크기와 지연 시간 균형 조정 브로커 설정 기본 설정이 모든 워크로드에 최적화되지 않음 메모리, 디스크 I/O, 네트워크 설정 최적화, 하드웨어 리소스에 맞는 JVM 튜닝 파티션 전략 파티션 수와 배치가 처리량과 순서에 영향을 줌 워크로드에 적합한 파티션 수 설정, 균형 잡힌 파 최적화하기 위한 고려사항 및 주의할 점 (계속) 고려사항 설명 권장사항 파티션 전략 파티션 수와 배치가 처리량과 순서에 영향을 줌 워크로드에 적합한 파티션 수 설정, 균형 잡힌 파티션 키 선택, 핫 파티션 방지 네트워크 최적화 네트워크 지연 및 대역폭이 성능에 영향을 줌 브로커와 클라이언트 간 네트워크 최적화, 지리적으로 가까운 배치, TCP 설정 튜닝 소비자 그룹 설계 소비자 그룹 구성이 병렬 처리에 영향을 줌 워크로드에 맞는 소비자 수 조정, 균형 잡힌 파티션 할당 전략 선택 캐싱 전략 반복 데이터 접근이 성능을 저하시킬 수 있음 클라이언트 측 캐싱 적용, 읽기 전용 복제본 활용, 캐시 무효화 전략 수립 디스크 I/O 디스크 성능이 메시지 지속성에 영향을 줌 SSD 활용, RAID 구성 최적화, 로그 세그먼트 설정 조정 메시지 압축 압축이 네트워크 사용량은 줄이지만 CPU 사용량은 증가 메시지 특성에 맞는 압축 알고리즘 선택, 압축 수준과 성능 사이의 균형 조정 필터링 최적화 클라이언트 측 필터링이 불필요한 네트워크 사용 유발 서버 측 필터링 활용, 토픽/파티션 설계 최적화, 이벤트 필터링 패턴 도입 모니터링 오버헤드 과도한 모니터링이 성능에 영향을 줄 수 있음 샘플링 기반 모니터링 적용, 중요 지표 선별, 모니터링 주기 최적화 보존 정책 오래된 메시지 저장이 스토리지 성능에 영향을 줌 적절한 보존 기간 설정, 계층형 스토리지 활용, 압축 정책 최적화 클라이언트 라이브러리 선택 클라이언트 라이브러리에 따라 성능 차이 발생 최신 버전의 공식 클라이언트 사용, 비동기 API 활용, 커넥션 풀링 구현 2025년 기준 최신 동향 주제 항목 설명 메시지 브로커 기술 서버리스 메시징 클라우드 제공업체의 완전 관리형 서버리스 메시징 솔루션이 확산되어 운영 부담을 크게 줄이고 유연한 확장성을 제공합니다. Edge 메시징 엣지 컴퓨팅 환경에서도 작동하는 경량화된 메시지 브로커들이 등장하여 IoT 및 분산 애플리케이션을 위한 지연 시간 최소화와 오프라인 지원이 가능해졌습니다. WebSocket 및 WebTransport 통합 최신 메시지 브로커들은 WebSocket과 더 새로운 WebTransport 프로토콜을 기본적으로 지원하여 웹 애플리케이션과의 연결성이 강화되었습니다. 이벤트 중심 아키텍처 이벤트 메시 단일 중앙 브로커에 의존하지 않고 여러 브로커가 분산 네트워크를 형성하는 이벤트 메시(Event Mesh) 아키텍처가 확산되고 있습니다. 하이브리드/멀티클라우드 이벤트 라우팅 서로 다른 클라우드 환경과 온프레미스 시스템 간의 원활한 이벤트 라우팅을 지원하는 솔루션이 발전하여 기업의 멀티클라우드 전략을 지원합니다. 이벤트 기반 서버리스 이벤트에 반응하여 자동으로 확장되는 서버리스 함수와 메시지/이벤트 브로커의 통합이 더욱 강화되었습니다. 데이터 관리 실시간 데이터 파이프라인 메시지/이벤트 브로커를 중심으로 실시간 데이터 파이프라인을 구축하는 패턴이 확산되어 데이터 레이크, 웨어하우스와의 통합이 강화되었습니다. 스키마 진화 관리 메시지/이벤트 스키마의 버전 관리와 진화를 지원하는 고급 도구가 발전하여 장기적인 시스템 유지 관리 부담이 감소했습니다. 컴플라이언스 및 데이터 거버넌스 메시지/이벤트 브로커에서의 데이터 처리에 대한 규제 준수와 거버넌스 기능이 강화되어 민감한 데이터 처리 지원이 개선되었습니다. 개발자 경험 저코드/노코드 통합 시각적 도구를 통해 메시지/이벤트 흐름을 설계하고 관리할 수 있는 저코드/노코드 솔루션이 발전하여 개발자가 아닌 사용자도 통합 파이프라인을 구축할 수 있게 되었습니다. AI 지원 디버깅 분산 메시징 시스템에서 문제를 진단하고 해결하는 AI 기반 도구가 등장하여 복잡한 디버깅 과정을 간소화합니다. API 우선 접근 방식 메시지/이벤트 브로커가 API 관리 플랫폼과 긴밀하게 통합되어 API와 이벤트 기반 통신의 경계가 모호해지고 있습니다. 주제와 관련하여 주목할 내용 주제 항목 설명 핵심 기술 발전 eBPF 기반 브로커 최적화 eBPF(extended Berkeley Packet Filter) 기술을 활용하여 커널 레벨에서 메시지 라우팅 및 필터링을 최적화하는 기법이 도입되고 있습니다. 영속성과 지연 시간 균형 비휘발성 메모리(NVRAM)와 같은 신기술을 활용해 높은 영속성과 낮은 지연 시간을 동시에 제공하는 메시지 브로커가 등장하고 있습니다. 양자 내성 암호화 향후 양자 컴퓨팅 위협에 대비한 양자 내성 암호화를 적용한 메시지/이벤트 브로커 보안 기능이 연구 중입니다. 새로운 패러다임 메시지-쿼리 통합 메시지 브로커와 데이터베이스 쿼리 기능이 통합된 하이브리드 시스템이 등장하여 이벤트와 상태 관리의 경계가 모호해지고 있습니다. 네트워크 메시 통합 서비스 메시(Service Mesh)와 이벤트 메시(Event Mesh)의 통합을 통해 일관된 통신 인프라를 제공하는 접근 방식이 발전하고 있습니다. 상태 중심 메시징(State-centric Messaging) 단순 이벤트 전달을 넘어 분산 상태 관리와 메시징을 결합한 새로운 패러다임이 등장하고 있습니다. 도메인 특화 솔루션 IoT 특화 브로커 리소스 제약 환경, 간헐적 연결성, 엣지 처리를 고려한 IoT 특화 메시지/이벤트 브로커가 발전하고 있습니다. 금융 거래용 고성능 브로커 나노초 지연 시간, 확정적 전달, 규제 준수를 보장하는 금융 특화 메시지 브로커가 개발되고 있습니다. AI/ML 파이프라인 통합 대규모 AI/ML 데이터 파이프라인에 최적화된 이벤트 스트리밍 플랫폼이 등장하여 모델 훈련 및 추론 워크플로우를 지원합니다. 운영 혁신 자가 최적화 브로커 워크로드 패턴을 학습하여 자동으로 설정을 최적화하는 인공지능 기반 메시지 브로커가 연구되고 있습니다. 탄소 발자국 최적화 에너지 효율성을 고려한 메시지 라우팅 및 저장 전략을 통해 데이터센터 탄소 발자국을 줄이는 접근 방식이 주목받고 있습니다. 통합 가시성 도구 여러 브로커와 환경에 걸친 메시지/이벤트 흐름을 통합적으로 시각화하고 모니터링하는 도구가 개발되고 있습니다. 앞으로의 전망 주제 항목 설명 기술 통합 분산 원장 기술(DLT) 통합 블록체인/DLT 기술과 메시지/이벤트 브로커의 통합이 확대되어 메시지 불변성, 추적성, 신뢰성을 강화하는 솔루션이 확산될 것으로 예상됩니다. 엣지-클라우드 연속성 엣지 컴퓨팅과 클라우드 환경 간의 원활한 메시지/이벤트 흐름을 지원하는 통합 브로커 솔루션이 중요해질 것입니다. AI 기반 브로커 AI가 메시지 라우팅, 필터링, 우선순위 지정에 활용되어 상황에 맞는 지능적인 메시지 처리를 제공하는 브로커가 등장할 것입니다. 새로운 응용 분야 디지털 트윈 플랫폼 물리적 자산과 디지털 트윈 간의 실시간 동기화를 위한 핵심 인프라로 메시지/이벤트 브로커가 활용될 것입니다. 메타버스 커뮤니케이션 대규모 가상 환경에서 시공간 이벤트를 처리하기 위한 특화된 메시지/이벤트 브로커가 발전할 것입니다. 자율 시스템 조정 자율 시스템 간의 협업과 조정을 위한 의사결정 플랫폼으로 이벤트 브로커의 역할이 확대될 것입니다. 아키텍처 진화 멀티모달 이벤트 처리 다양한 유형(텍스트, 이미지, 오디오, 동영상 등)의 이벤트 데이터를 처리하기 위한 메시지/이벤트 브로커 기능이 확장될 것입니다. 양자 메시징 양자 컴퓨팅과 양자 통신 기술을 활용한 고도로 안전한 메시지 브로커가 연구 개발될 것입니다. 공간 이벤트 처리 지리적 위치와 공간 관계를 고려한 이벤트 라우팅 및 처리 기능이 강화될 것입니다. 생태계 발전 이벤트 마켓플레이스 조직 간에 이벤트를 안전하게 공유하고 거래할 수 있는 이벤트 마켓플레이스가 발전할 것입니다. 크로스 도메인 표준화 다양한 산업 분야에 걸친 이벤트 스키마와 메시지 형식의 표준화가 진행될 것입니다. 오픈소스 혁신 새로운 메시징 패러다임을 구현한 혁신적인 오픈소스 브로커가 등장하여 생태계가 더욱 다양화될 것입니다. 추가 학습 주제 카테고리 주제 설명 메시지 브로커 심화 AMQP 프로토콜 Advanced Message Queuing Protocol의 세부 사항과 구현 기법에 대한 심층 이해 메시지 라우팅 전략 복잡한 라우팅 토폴로지와 패턴 설계 및 구현 방법 브로커 내부 아키텍처 메시지 브로커의 내부 구현과 최적화 기법에 대한 이해 이벤트 브로커 심화 파티셔닝 전략 대규모 이벤트 처리를 위한 파티션 설계와 최적화 방법 이벤트 컴팩션 이벤트 스트림의 효율적인 압축 및 관리 기법 스트림 처리 토폴로지 복잡한 이벤트 처리 파이프라인 설계 및 구현 방법 분산 시스템 CAP 이론과 브로커 설계 일관성, 가용성, 분할 내성 간의 트레이드오프와 브로커 설계에 미치는 영향 분산 합의 알고리즘 Raft, Paxos 등 분산 시스템의 합의 알고리즘과 메시지 브로커 적용 비동기 패턴 콜백, 프로미스, 리액티브 프로그래밍 등 비동기 통신 패턴 패턴 및 아키텍처 사가 패턴 분산 트랜잭션 관리를 위한 메시지 기반 사가 패턴 구현 이벤트 소싱 심화 복잡한 도메인을 위한 이벤트 소싱 설계 및 구현 메시징 패턴 카탈로그 다양한 메시징 패턴과 응용 사례 분석 성능 및 운영 고성능 메시징 저지연, 고처리량 메시징 시스템 설계 및 구현 대규모 운영 수백 개의 브로커 노드로 구성된 클러스터 관리 및 운영 장애 복구 전략 다양한 장애 시나리오에 대응하는 복구 전략 보안 메시지 보안 메시지 암호화, 인증, 무결성 보장 기법 접근 제어 세분화된 메시지 접근 제어 정책 설계 및 구현 보안 위협 분석 메시지 브로커 환경의 잠재적 보안 위협과 대응 방안 클라우드 네이티브 쿠버네티스 통합 쿠버네티스 환경에서의 메시지 브로커 배포 및 운영 서버리스 메시징 AWS Lambda, Azure Functions 등과의 통합 패턴 클라우드 간 메시징 멀티클라우드 환경에서의 메시지/이벤트 브로커 활용 특수 도메인 IoT 메시징 리소스 제약 환경에서의 효율적인 메시징 구현 실시간 분석 이벤트 스트림을 활용한 실시간 분석 파이프라인 구축 규제 준수 금융, 의료 등 규제 산업에서의 메시지 브로커 활용 추가 학습 내용 카테고리 주제 설명 프로그래밍 언어 리액티브 프로그래밍 비동기 이벤트 스트림 처리를 위한 리액티브 프로그래밍 패러다임과 도구 함수형 프로그래밍 불변성과 부작용 없는 함수를 활용한 이벤트 처리 접근 방식 동시성 모델 다양한 프로그래밍 언어의 동시성 모델과 메시지 처리 적용 데이터 엔지니어링 데이터 파이프라인 설계 메시지/이벤트 브로커를 중심으로 한 데이터 파이프라인 아키텍처 스키마 설계 효율적인 메시지/이벤트 스키마 설계 원칙과 방법론 ETL과 ELT 통합 메시지/이벤트 브로커를 활용한 ETL/ELT 프로세스 구현 DevOps 브로커 자동화 메시지/이벤트 브로커의 자동화된 배포, 설정, 관리 지속적 통합/배포 메시지 기반 시스템의 CI/CD 파이프라인 구축 카오스 엔지니어링 메시지/이벤트 브로커 환경에서의 회복력 테스트 인공지능 ML 파이프라인 통합 이벤트 스트림을 활용한 ML 모델 훈련 및 서빙 이상 탐지 메시지/이벤트 스트림에서의 이상 탐지 기법 스트림 기반 의사결정 실시간 이벤트를 기반으로 한 인공지능 의사결정 시스템 시스템 설계 대규모 분산 시스템 수천만 사용자를 지원하는 메시지/이벤트 기반 시스템 설계 장애 내성 설계 다양한 장애 시나리오에 대응하는 시스템 아키텍처 글로벌 배포 전략 지역 분산된 메시지/이벤트 브로커 인프라 구축 용어 정리 용어 설명 AMQP(Advanced Message Queuing Protocol) 메시지 지향 미들웨어를 위한 개방형 표준 프로토콜로, 클라이언트와 브로커 간의 통신에 사용됩니다. 바인딩(Binding) 메시지 브로커에서 교환소(Exchange)와 큐(Queue)를 연결하는 규칙으로, 어떤 메시지가 어떤 큐로 전달될지 결정합니다. CDC(Change Data Capture) 데이터베이스의 변경 사항을 실시간으로 추적하여 이벤트 스트림으로 변환하는 기술입니다. 소비자(Consumer) 메시지/이벤트 브로커로부터 메시지를 수신하여 처리하는 애플리케이션 또는 서비스입니다. CQRS(Command Query Responsibility Segregation) 명령(상태 변경)과 쿼리(상태 읽기)를 분리하는 아키텍처 패턴입니다. DLQ(Dead Letter Queue) 처리에 실패한 메시지를 저장하는 특수한 큐로, 나중에 분석하거나 재처리하는 데 사용됩니다. 교환소(Exchange) 메시지 브로커에서 메시지를 수신하여 라우팅 규칙에 따라 적절한 큐로 전달하는 컴포넌트입니다. 이벤트 소싱(Event Sourcing) 상태 변화를 일련의 이벤트로 저장하고, 이벤트를 재생하여 현재 상태를 복원하는 패턴입니다. 멱등성(Idempotency) 동일한 메시지가 여러 번 처리되더라도 시스템 상태가 동일하게 유지되는 속성입니다. 메시지 브로커(Message Broker) 메시지 검증, 변환, 라우팅을 통해 서로 다른 시스템 간의 통신을 중개하는 소프트웨어입니다. MQTT(Message Queuing Telemetry Transport) 경량 메시징 프로토콜로, 주로 IoT 기기 간 통신에 사용됩니다. 오프셋(Offset) 이벤트 스트림에서 소비자가 어디까지 메시지를 소비했는지 추적하는 위치 지표입니다. 파티션(Partition) 이벤트 브로커에서 주제(Topic)를 물리적으로 분할하여 병렬 처리를 가능하게 하는 단위입니다. 생산자(Producer) 메시지/이벤트 브로커에 메시지를 발행하는 애플리케이션 또는 서비스입니다. 발행-구독(Publish-Subscribe) 발행자가 메시지를 주제(Topic)에 발행하고, 해당 주제를 구독한 모든 구독자가 메시지를 수신하는 패턴입니다. 큐(Queue) 메시지 브로커에서 메시지가 소비자에게 전달되기 전까지 저장되는 버퍼입니다. 사가(Saga) 분산 트랜잭션을 구현하기 위해 일련의 로컬 트랜잭션과 보상 트랜잭션을 조합하는 패턴입니다. 스키마 레지스트리(Schema Registry) 메시지/이벤트 스키마를 중앙에서 관리하고 유효성을 검증하는 컴포넌트입니다. STOMP(Simple Text Oriented Messaging Protocol) 텍스트 기반의 간단한 메시징 프로토콜로, 다양한 언어와 플랫폼에서 쉽게 구현할 수 있습니다. 주제(Topic) 이벤트 브로커에서 특정 카테고리의 이벤트를 그룹화하는 논리적 채널입니다. 참고 및 출처 메시지 브로커란 무엇인가요? | IBM 메시지 브로커와 이벤트 브로커의 이해와 활용 메시지 브로커와 이벤트 브로커: 분산 시스템의 핵심 기술 RabbitMQ와 Kafka - 메시지 대기열 시스템 간의 차이점 - AWS 이벤트 기반 아키텍처란? 이벤트 메쉬(Event Mesh)의 개념, 기능, 작동 방식, 사용 방법 Kafka(이벤트 브로커) vs RabbitMQ(메시지 브로커) 메시지 브로커 - 위키백과 카프카(kafka) vs RabbitMQ Message Broker 활용 Message Broker(메시지 브로커)란 무엇일까? ","wordCount":"13154","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2024-10-25T06:28:00Z","dateModified":"2024-10-25T06:28:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/backend-development/event-and-message-brokers/fundamentals/event-brokers/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>기술 블로그</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend-development/>Backend Development</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend-development/event-and-message-brokers/>Event and Message Brokers</a></div><h1 class="post-title entry-hint-parent">Event Brokers</h1><div class=post-description>Event Broker는 이벤트 생성자(Producer)와 이벤트 소비자(Consumer) 사이에서 중개자 역할을 수행한다.</div><div class=post-meta><span title='2024-10-25 06:28:00 +0000 UTC'>October 25, 2024</span>&nbsp;·&nbsp;62 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/Backend%20Development/Event%20and%20Message%20Brokers/Fundamentals/Event-Brokers.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#event-brokers>Event Brokers</a><ul><li><a href=#이벤트-브로커-기초-개념>이벤트 브로커 기초 개념</a></li><li><a href=#주요-이벤트-브로커-시스템-비교>주요 이벤트 브로커 시스템 비교</a></li><li><a href=#실무-구현-가이드>실무 구현 가이드</a></li><li><a href=#심화-주제>심화 주제</a></li><li><a href=#이벤트-브로커-설계-및-운영-모범-사례>이벤트 브로커 설계 및 운영 모범 사례</a></li><li><a href=#실제-사례-연구-및-문제-해결>실제 사례 연구 및 문제 해결</a></li><li><a href=#이벤트-브로커-선택-가이드>이벤트 브로커 선택 가이드</a></li><li><a href=#아키텍처-진화-방향>아키텍처 진화 방향</a></li></ul></li><li><a href=#용어-정리>용어 정리</a></li><li><a href=#참고-및-출처>참고 및 출처</a><ul><li><a href=#1-주제의-분류-적절성>1. 주제의 분류 적절성</a></li><li><a href=#2-200-자-요약>2. 200 자 요약</a></li><li><a href=#3-전체-개요-250-자-내외>3. 전체 개요 (250 자 내외)</a></li></ul></li><li><a href=#핵심-개념>핵심 개념</a></li><li><a href=#목적-및-필요성>목적 및 필요성</a></li><li><a href=#주요-기능-및-역할>주요 기능 및 역할</a></li><li><a href=#특징>특징</a></li><li><a href=#핵심-원칙>핵심 원칙</a></li><li><a href=#주요-원리-및-작동-원리>주요 원리 및 작동 원리</a><ul><li><a href=#작동-원리-다이어그램>작동 원리 다이어그램</a></li></ul></li><li><a href=#구조-및-아키텍처>구조 및 아키텍처</a><ul><li><a href=#필수-구성요소>필수 구성요소</a></li><li><a href=#선택-구성요소>선택 구성요소</a></li></ul></li><li><a href=#구현-기법>구현 기법</a></li><li><a href=#장점과-단점>장점과 단점</a></li><li><a href=#도전-과제>도전 과제</a></li><li><a href=#분류에-따른-종류-및-유형>분류에 따른 종류 및 유형</a></li><li><a href=#실무-적용-예시>실무 적용 예시</a></li><li><a href=#활용-사례-시나리오>활용 사례 (시나리오)</a><ul><li><a href=#시나리오-글로벌-이커머스-실시간-주문알림-시스템>시나리오: 글로벌 이커머스 실시간 주문/알림 시스템</a></li></ul></li><li><a href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점</a></li><li><a href=#최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점</a></li><li><a href=#2025-년-기준-최신-동향>2025 년 기준 최신 동향</a></li><li><a href=#주제와-관련하여-주목할-내용>주제와 관련하여 주목할 내용</a></li><li><a href=#앞으로의-전망>앞으로의 전망</a></li><li><a href=#하위-주제-및-추가-학습-필요-내용>하위 주제 및 추가 학습 필요 내용</a></li><li><a href=#용어-정리-1>용어 정리</a></li><li><a href=#참고-및-출처-1>참고 및 출처</a><ul><li><a href=#-1-주제의-분류-적절성>✅ 1. 주제의 분류 적절성</a></li><li><a href=#-2-요약-문장-200자-이내>✅ 2. 요약 문장 (200자 이내)</a></li><li><a href=#-3-전체-개요-250자-이내>✅ 3. 전체 개요 (250자 이내)</a></li><li><a href=#-4-핵심-개념>✅ 4. 핵심 개념</a></li></ul></li><li><a href=#-5-주제별-상세-조사-참고사항-반영>✅ 5. 주제별 상세 조사 (참고사항 반영)</a><ul><li><a href=#51-목적-및-필요성>5.1 목적 및 필요성</a></li><li><a href=#52-주요-기능-및-역할>5.2 주요 기능 및 역할</a></li><li><a href=#53-특징>5.3 특징</a></li><li><a href=#54-핵심-원칙>5.4 핵심 원칙</a></li><li><a href=#55-주요-원리-및-작동-원리>5.5 주요 원리 및 작동 원리</a></li><li><a href=#56-구조-및-아키텍처>5.6 구조 및 아키텍처</a></li><li><a href=#57-구현-기법>5.7 구현 기법</a></li><li><a href=#58-장점과-단점>5.8 장점과 단점</a></li><li><a href=#59-분류에-따른-종류-및-유형>5.9 분류에 따른 종류 및 유형</a></li></ul></li><li><a href=#-510-실무-적용-예시>✅ 5.10 실무 적용 예시</a></li><li><a href=#-511-활용-사례>✅ 5.11 활용 사례</a><ul><li><a href=#-상황-이커머스-플랫폼의-실시간-주문-배송-연동>📌 상황: 이커머스 플랫폼의 실시간 주문-배송 연동</a></li></ul></li><li><a href=#-512-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>✅ 5.12 실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점</a></li><li><a href=#-513-성능을-최적화하기-위한-고려사항-및-주의할-점>✅ 5.13 성능을 최적화하기 위한 고려사항 및 주의할 점</a></li><li><a href=#-514-2025년-기준-최신-동향>✅ 5.14 2025년 기준 최신 동향</a></li><li><a href=#-515-주제와-관련하여-주목할-내용>✅ 5.15 주제와 관련하여 주목할 내용</a></li><li><a href=#-516-앞으로의-전망>✅ 5.16 앞으로의 전망</a></li><li><a href=#-517-하위-주제별-추가-학습-목록>✅ 5.17 하위 주제별 추가 학습 목록</a></li><li><a href=#-518-관련-분야별-추가-학습-목록>✅ 5.18 관련 분야별 추가 학습 목록</a></li><li><a href=#-용어-정리>🧾 용어 정리</a></li><li><a href=#-참고-및-출처>🔗 참고 및 출처</a></li><li><a href=#-1-event-broker-구축-예제-코드-kafka-기반-python>✅ 1. Event Broker 구축 예제 코드 (Kafka 기반, Python)</a><ul><li><a href=#-목표>🎯 목표:</a></li><li><a href=#-구성>📦 구성:</a></li><li><a href=#1-1-설치-준비>1-1. 설치 준비</a></li><li><a href=#1-2-python-producer-코드>1-2. Python Producer 코드</a></li><li><a href=#1-3-python-consumer-코드>1-3. Python Consumer 코드</a></li></ul></li><li><a href=#-2-kafka-vs-aws-eventbridge-비교>✅ 2. Kafka vs AWS EventBridge 비교</a></li><li><a href=#-3-kafka-모니터링-지표-및-실전-대시보드-구성-prometheus--grafana>✅ 3. Kafka 모니터링 지표 및 실전 대시보드 구성 (Prometheus + Grafana)</a><ul><li><a href=#-주요-지표>📊 주요 지표</a></li><li><a href=#-실전-대시보드-구성>🛠️ 실전 대시보드 구성</a></li></ul></li></ul><ul><li><a href=#1-주제의-분류-적절성-확인>1. 주제의 분류 적절성 확인</a></li><li><a href=#2-요약-200자-내외>2. 요약 (200자 내외)</a></li><li><a href=#3-개요-250자-내외>3. 개요 (250자 내외)</a></li><li><a href=#4-핵심-개념>4. 핵심 개념</a><ul><li><a href=#메시지-브로커message-broker>메시지 브로커(Message Broker)</a></li><li><a href=#이벤트-브로커event-broker>이벤트 브로커(Event Broker)</a></li><li><a href=#생산자-소비자-패턴producer-consumer-pattern>생산자-소비자 패턴(Producer-Consumer Pattern)</a></li><li><a href=#비동기-통신asynchronous-communication>비동기 통신(Asynchronous Communication)</a></li><li><a href=#느슨한-결합loose-coupling>느슨한 결합(Loose Coupling)</a></li></ul></li><li><a href=#5-주제와-관련하여-조사할-내용>5. 주제와 관련하여 조사할 내용</a><ul><li><a href=#목적-및-필요성-1>목적 및 필요성</a></li><li><a href=#주요-기능-및-역할-1>주요 기능 및 역할</a></li><li><a href=#특징-1>특징</a></li><li><a href=#핵심-원칙-1>핵심 원칙</a></li><li><a href=#주요-원리-및-작동-원리-1>주요 원리 및 작동 원리</a></li><li><a href=#구조-및-아키텍처-1>구조 및 아키텍처</a></li><li><a href=#구현-기법-1>구현 기법</a></li><li><a href=#장점과-단점-1>장점과 단점</a></li><li><a href=#도전-과제-1>도전 과제</a></li><li><a href=#분류에-따른-종류-및-유형-1>분류에 따른 종류 및 유형</a></li><li><a href=#실무-적용-예시-1>실무 적용 예시</a></li><li><a href=#활용-사례>활용 사례</a></li><li><a href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점-1>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점</a></li><li><a href=#최적화하기-위한-고려사항-및-주의할-점-1>최적화하기 위한 고려사항 및 주의할 점</a></li><li><a href=#최적화하기-위한-고려사항-및-주의할-점-계속>최적화하기 위한 고려사항 및 주의할 점 (계속)</a></li><li><a href=#2025년-기준-최신-동향>2025년 기준 최신 동향</a></li><li><a href=#주제와-관련하여-주목할-내용-1>주제와 관련하여 주목할 내용</a></li><li><a href=#앞으로의-전망-1>앞으로의 전망</a></li><li><a href=#추가-학습-주제>추가 학습 주제</a></li><li><a href=#추가-학습-내용>추가 학습 내용</a></li></ul></li><li><a href=#용어-정리-2>용어 정리</a></li><li><a href=#참고-및-출처-2>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=event-brokers>Event Brokers<a hidden class=anchor aria-hidden=true href=#event-brokers>#</a></h2><p>이벤트 브로커는 현대 분산 시스템과 마이크로서비스 아키텍처의 핵심 구성 요소로, 비동기 통신과 시스템 간 느슨한 결합을 가능하게 한다. Event Broker 는 이벤트 생성자 (Producer) 와 이벤트 소비자 (Consumer) 사이에서 중개자 역할을 수행한다.</p><p><figure><img alt="Event Broker" loading=lazy src=/img/event-broker.svg><figcaption>Source: https://developer.confluent.io/patterns/event-stream/event-broker/</figcaption></figure></p><h3 id=이벤트-브로커-기초-개념>이벤트 브로커 기초 개념<a hidden class=anchor aria-hidden=true href=#이벤트-브로커-기초-개념>#</a></h3><h4 id=이벤트-브로커란>이벤트 브로커란?<a hidden class=anchor aria-hidden=true href=#이벤트-브로커란>#</a></h4><p>이벤트 브로커는 이벤트 생산자 (Producer) 와 소비자 (Consumer) 사이에서 메시지를 중개하는 미들웨어이다. 생산자는 이벤트를 발행 (publish) 하고, 소비자는 관심 있는 이벤트를 구독 (subscribe) 하는 발행 - 구독 (Pub/Sub) 패턴을 기반으로 한다.</p><h4 id=이벤트-브로커의-핵심-기능>이벤트 브로커의 핵심 기능<a hidden class=anchor aria-hidden=true href=#이벤트-브로커의-핵심-기능>#</a></h4><ol><li><strong>메시지 라우팅</strong>: 적절한 소비자에게 메시지 전달</li><li><strong>메시지 버퍼링</strong>: 일시적인 부하 증가나 소비자 장애 시 메시지 임시 저장</li><li><strong>메시지 필터링</strong>: 특정 조건에 맞는 메시지만 전달</li><li><strong>메시지 변환</strong>: 필요에 따라 메시지 형식 변환</li><li><strong>신뢰성 보장</strong>: 메시지 전달 보장, 순서 유지 등</li></ol><h4 id=이벤트-브로커의-주요-이점>이벤트 브로커의 주요 이점<a hidden class=anchor aria-hidden=true href=#이벤트-브로커의-주요-이점>#</a></h4><ol><li><strong>느슨한 결합 (Loose Coupling)</strong>: 생산자와 소비자가 서로를 직접 알 필요 없음</li><li><strong>확장성 (Scalability)</strong>: 시스템 구성 요소를 독립적으로 확장 가능</li><li><strong>탄력성 (Resilience)</strong>: 일부 서비스 실패 시에도 전체 시스템 작동 가능</li><li><strong>비동기 처리</strong>: 즉각적인 응답이 필요 없는 작업의 효율적 처리</li></ol><h3 id=주요-이벤트-브로커-시스템-비교>주요 이벤트 브로커 시스템 비교<a hidden class=anchor aria-hidden=true href=#주요-이벤트-브로커-시스템-비교>#</a></h3><h4 id=apache-kafka>Apache Kafka<a hidden class=anchor aria-hidden=true href=#apache-kafka>#</a></h4><p><strong>특징</strong>:</p><ul><li>높은 처리량과 내구성 제공</li><li>분산 커밋 로그 아키텍처</li><li>메시지 순서와 내구성 보장</li><li>파티션 기반 확장성</li></ul><p><strong>적합한 사용 사례</strong>:</p><ul><li>대용량 로그 처리</li><li>실시간 데이터 파이프라인</li><li>이벤트 소싱 아키텍처</li><li>장기간 메시지 보존 필요 시</li></ul><h4 id=rabbitmq>RabbitMQ<a hidden class=anchor aria-hidden=true href=#rabbitmq>#</a></h4><p><strong>특징</strong>:</p><ul><li>AMQP 프로토콜 구현</li><li>다양한 메시징 패턴 (라우팅, 토픽, RPC 등) 지원</li><li>관리 용이성</li><li>플러그인 시스템</li></ul><p><strong>적합한 사용 사례</strong>:</p><ul><li>복잡한 라우팅 요구사항</li><li>우선순위 큐</li><li>지연 메시지 처리</li><li>다양한 프로토콜 지원 필요 시</li></ul><h4 id=apache-pulsar>Apache Pulsar<a hidden class=anchor aria-hidden=true href=#apache-pulsar>#</a></h4><p><strong>특징</strong>:</p><ul><li>멀티 테넌트 아키텍처</li><li>저장소와 브로커 계층 분리</li><li>무제한 메시지 보존</li><li>Kafka 와 RabbitMQ 의 장점 결합</li></ul><p><strong>적합한 사용 사례</strong>:</p><ul><li>멀티 테넌트 환경</li><li>지역 간 복제 필요 시</li><li>장기 데이터 보존과 스트리밍 처리 결합</li></ul><h4 id=nats>NATS<a hidden class=anchor aria-hidden=true href=#nats>#</a></h4><p><strong>특징</strong>:</p><ul><li>초경량 아키텍처</li><li>낮은 지연 시간</li><li>간단한 설정과 운영</li><li>서비스 발견 기능 내장</li></ul><p><strong>적합한 사용 사례</strong>:</p><ul><li>클라우드 네이티브 애플리케이션</li><li>IoT 장치 통신</li><li>실시간 서비스 간 통신</li></ul><h4 id=aws-snssqs-google-pubsub-azure-service-bus>AWS SNS/SQS, Google Pub/Sub, Azure Service Bus<a hidden class=anchor aria-hidden=true href=#aws-snssqs-google-pubsub-azure-service-bus>#</a></h4><p><strong>특징</strong>:</p><ul><li>관리형 서비스 (서버리스)</li><li>클라우드 제공업체 통합</li><li>자동 확장 및 관리</li></ul><p><strong>적합한 사용 사례</strong>:</p><ul><li>해당 클라우드 플랫폼에서 운영되는 시스템</li><li>인프라 관리 부담 최소화 필요 시</li></ul><h3 id=실무-구현-가이드>실무 구현 가이드<a hidden class=anchor aria-hidden=true href=#실무-구현-가이드>#</a></h3><h4 id=apache-kafka-구현-예제>Apache Kafka 구현 예제<a hidden class=anchor aria-hidden=true href=#apache-kafka-구현-예제>#</a></h4><p><strong>기본 설정</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># docker-compose.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;3&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zookeeper</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>confluentinc/cp-zookeeper:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>ZOOKEEPER_CLIENT_PORT</span><span class=p>:</span><span class=w> </span><span class=m>2181</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>kafka</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>confluentinc/cp-kafka:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>depends_on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>zookeeper</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;9092:9092&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>KAFKA_BROKER_ID</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>KAFKA_ZOOKEEPER_CONNECT</span><span class=p>:</span><span class=w> </span><span class=l>zookeeper:2181</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>KAFKA_ADVERTISED_LISTENERS</span><span class=p>:</span><span class=w> </span><span class=l>PLAINTEXT://kafka:29092,PLAINTEXT_HOST://localhost:9092</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>KAFKA_LISTENER_SECURITY_PROTOCOL_MAP</span><span class=p>:</span><span class=w> </span><span class=l>PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>KAFKA_INTER_BROKER_LISTENER_NAME</span><span class=p>:</span><span class=w> </span><span class=l>PLAINTEXT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>Java 생산자 코드</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16>16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17>17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18>18</a>
</span><span class=lnt id=hl-1-19><a class=lnlinks href=#hl-1-19>19</a>
</span><span class=lnt id=hl-1-20><a class=lnlinks href=#hl-1-20>20</a>
</span><span class=lnt id=hl-1-21><a class=lnlinks href=#hl-1-21>21</a>
</span><span class=lnt id=hl-1-22><a class=lnlinks href=#hl-1-22>22</a>
</span><span class=lnt id=hl-1-23><a class=lnlinks href=#hl-1-23>23</a>
</span><span class=lnt id=hl-1-24><a class=lnlinks href=#hl-1-24>24</a>
</span><span class=lnt id=hl-1-25><a class=lnlinks href=#hl-1-25>25</a>
</span><span class=lnt id=hl-1-26><a class=lnlinks href=#hl-1-26>26</a>
</span><span class=lnt id=hl-1-27><a class=lnlinks href=#hl-1-27>27</a>
</span><span class=lnt id=hl-1-28><a class=lnlinks href=#hl-1-28>28</a>
</span><span class=lnt id=hl-1-29><a class=lnlinks href=#hl-1-29>29</a>
</span><span class=lnt id=hl-1-30><a class=lnlinks href=#hl-1-30>30</a>
</span><span class=lnt id=hl-1-31><a class=lnlinks href=#hl-1-31>31</a>
</span><span class=lnt id=hl-1-32><a class=lnlinks href=#hl-1-32>32</a>
</span><span class=lnt id=hl-1-33><a class=lnlinks href=#hl-1-33>33</a>
</span><span class=lnt id=hl-1-34><a class=lnlinks href=#hl-1-34>34</a>
</span><span class=lnt id=hl-1-35><a class=lnlinks href=#hl-1-35>35</a>
</span><span class=lnt id=hl-1-36><a class=lnlinks href=#hl-1-36>36</a>
</span><span class=lnt id=hl-1-37><a class=lnlinks href=#hl-1-37>37</a>
</span><span class=lnt id=hl-1-38><a class=lnlinks href=#hl-1-38>38</a>
</span><span class=lnt id=hl-1-39><a class=lnlinks href=#hl-1-39>39</a>
</span><span class=lnt id=hl-1-40><a class=lnlinks href=#hl-1-40>40</a>
</span><span class=lnt id=hl-1-41><a class=lnlinks href=#hl-1-41>41</a>
</span><span class=lnt id=hl-1-42><a class=lnlinks href=#hl-1-42>42</a>
</span><span class=lnt id=hl-1-43><a class=lnlinks href=#hl-1-43>43</a>
</span><span class=lnt id=hl-1-44><a class=lnlinks href=#hl-1-44>44</a>
</span><span class=lnt id=hl-1-45><a class=lnlinks href=#hl-1-45>45</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Kafka 생산자 예제</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.apache.kafka.clients.producer.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.Properties</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderEventProducer</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 생산자 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Properties</span><span class=w> </span><span class=n>props</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Properties</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;bootstrap.servers&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;localhost:9092&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;key.serializer&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;org.apache.kafka.common.serialization.StringSerializer&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;value.serializer&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;org.apache.kafka.common.serialization.StringSerializer&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 생산자 인스턴스 생성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Producer</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>producer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>KafkaProducer</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>props</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 주문 이벤트 메시지 생성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>orderId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;ORD-&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>System</span><span class=p>.</span><span class=na>currentTimeMillis</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>orderData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;{\&#34;orderId\&#34;:\&#34;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>orderId</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;\&#34;,\&#34;customerId\&#34;:\&#34;CUST001\&#34;,\&#34;amount\&#34;:150.00}&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 메시지 전송</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>ProducerRecord</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>record</span><span class=w> </span><span class=o>=</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>new</span><span class=w> </span><span class=n>ProducerRecord</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=s>&#34;order-events&#34;</span><span class=p>,</span><span class=w> </span><span class=n>orderId</span><span class=p>,</span><span class=w> </span><span class=n>orderData</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 비동기 전송 (콜백 포함)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>producer</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=n>record</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Callback</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCompletion</span><span class=p>(</span><span class=n>RecordMetadata</span><span class=w> </span><span class=n>metadata</span><span class=p>,</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>e</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=c1>// 에러 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>System</span><span class=p>.</span><span class=na>err</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;메시지 전송 실패: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=na>getMessage</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=c1>// 성공 로깅</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;메시지 전송 성공: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=s>&#34;토픽=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>metadata</span><span class=p>.</span><span class=na>topic</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;, &#34;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=s>&#34;파티션=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>metadata</span><span class=p>.</span><span class=na>partition</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;, &#34;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=s>&#34;오프셋=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>metadata</span><span class=p>.</span><span class=na>offset</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 리소스 정리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>producer</span><span class=p>.</span><span class=na>flush</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>producer</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>Java 소비자 코드</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span><span class=lnt id=hl-2-21><a class=lnlinks href=#hl-2-21>21</a>
</span><span class=lnt id=hl-2-22><a class=lnlinks href=#hl-2-22>22</a>
</span><span class=lnt id=hl-2-23><a class=lnlinks href=#hl-2-23>23</a>
</span><span class=lnt id=hl-2-24><a class=lnlinks href=#hl-2-24>24</a>
</span><span class=lnt id=hl-2-25><a class=lnlinks href=#hl-2-25>25</a>
</span><span class=lnt id=hl-2-26><a class=lnlinks href=#hl-2-26>26</a>
</span><span class=lnt id=hl-2-27><a class=lnlinks href=#hl-2-27>27</a>
</span><span class=lnt id=hl-2-28><a class=lnlinks href=#hl-2-28>28</a>
</span><span class=lnt id=hl-2-29><a class=lnlinks href=#hl-2-29>29</a>
</span><span class=lnt id=hl-2-30><a class=lnlinks href=#hl-2-30>30</a>
</span><span class=lnt id=hl-2-31><a class=lnlinks href=#hl-2-31>31</a>
</span><span class=lnt id=hl-2-32><a class=lnlinks href=#hl-2-32>32</a>
</span><span class=lnt id=hl-2-33><a class=lnlinks href=#hl-2-33>33</a>
</span><span class=lnt id=hl-2-34><a class=lnlinks href=#hl-2-34>34</a>
</span><span class=lnt id=hl-2-35><a class=lnlinks href=#hl-2-35>35</a>
</span><span class=lnt id=hl-2-36><a class=lnlinks href=#hl-2-36>36</a>
</span><span class=lnt id=hl-2-37><a class=lnlinks href=#hl-2-37>37</a>
</span><span class=lnt id=hl-2-38><a class=lnlinks href=#hl-2-38>38</a>
</span><span class=lnt id=hl-2-39><a class=lnlinks href=#hl-2-39>39</a>
</span><span class=lnt id=hl-2-40><a class=lnlinks href=#hl-2-40>40</a>
</span><span class=lnt id=hl-2-41><a class=lnlinks href=#hl-2-41>41</a>
</span><span class=lnt id=hl-2-42><a class=lnlinks href=#hl-2-42>42</a>
</span><span class=lnt id=hl-2-43><a class=lnlinks href=#hl-2-43>43</a>
</span><span class=lnt id=hl-2-44><a class=lnlinks href=#hl-2-44>44</a>
</span><span class=lnt id=hl-2-45><a class=lnlinks href=#hl-2-45>45</a>
</span><span class=lnt id=hl-2-46><a class=lnlinks href=#hl-2-46>46</a>
</span><span class=lnt id=hl-2-47><a class=lnlinks href=#hl-2-47>47</a>
</span><span class=lnt id=hl-2-48><a class=lnlinks href=#hl-2-48>48</a>
</span><span class=lnt id=hl-2-49><a class=lnlinks href=#hl-2-49>49</a>
</span><span class=lnt id=hl-2-50><a class=lnlinks href=#hl-2-50>50</a>
</span><span class=lnt id=hl-2-51><a class=lnlinks href=#hl-2-51>51</a>
</span><span class=lnt id=hl-2-52><a class=lnlinks href=#hl-2-52>52</a>
</span><span class=lnt id=hl-2-53><a class=lnlinks href=#hl-2-53>53</a>
</span><span class=lnt id=hl-2-54><a class=lnlinks href=#hl-2-54>54</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Kafka 소비자 예제</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.apache.kafka.clients.consumer.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.time.Duration</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderEventConsumer</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 소비자 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Properties</span><span class=w> </span><span class=n>props</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Properties</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;bootstrap.servers&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;localhost:9092&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;group.id&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;order-processing-group&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;key.deserializer&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;org.apache.kafka.common.serialization.StringDeserializer&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;value.deserializer&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;org.apache.kafka.common.serialization.StringDeserializer&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;auto.offset.reset&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;earliest&#34;</span><span class=p>);</span><span class=w> </span><span class=c1>// 처음부터 읽기</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 소비자 인스턴스 생성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Consumer</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>consumer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>KafkaConsumer</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>props</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 토픽 구독</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>consumer</span><span class=p>.</span><span class=na>subscribe</span><span class=p>(</span><span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=s>&#34;order-events&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 주기적으로 데이터 폴링</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=kc>true</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 100ms 동안 데이터 기다림</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>ConsumerRecords</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>records</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>consumer</span><span class=p>.</span><span class=na>poll</span><span class=p>(</span><span class=n>Duration</span><span class=p>.</span><span class=na>ofMillis</span><span class=p>(</span><span class=n>100</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>ConsumerRecord</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>record</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>records</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=c1>// 메시지 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;수신 데이터: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=s>&#34;키=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>record</span><span class=p>.</span><span class=na>key</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;, &#34;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=s>&#34;값=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>record</span><span class=p>.</span><span class=na>value</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;, &#34;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=s>&#34;토픽=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>record</span><span class=p>.</span><span class=na>topic</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;, &#34;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=s>&#34;파티션=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>record</span><span class=p>.</span><span class=na>partition</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;, &#34;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=s>&#34;오프셋=&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>record</span><span class=p>.</span><span class=na>offset</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=c1>// 여기서 주문 처리 로직 구현</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>processOrder</span><span class=p>(</span><span class=n>record</span><span class=p>.</span><span class=na>value</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 명시적 커밋 (자동 커밋을 사용할 수도 있음)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>consumer</span><span class=p>.</span><span class=na>commitSync</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 리소스 정리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>consumer</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>processOrder</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>orderJson</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 주문 처리 로직</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;주문 처리 중: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>orderJson</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=spring-boot-에서의-kafka-사용-예제>Spring Boot 에서의 Kafka 사용 예제<a hidden class=anchor aria-hidden=true href=#spring-boot-에서의-kafka-사용-예제>#</a></h4><p><strong>의존성 설정 (build.gradle)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4>4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gradle data-lang=gradle><span class=line><span class=cl><span class=n>dependencies</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>implementation</span> <span class=s1>&#39;org.springframework.kafka:spring-kafka&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>implementation</span> <span class=s1>&#39;org.springframework.boot:spring-boot-starter-web&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 기타 필요한 의존성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>애플리케이션 설정 (application.yml)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>spring</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>kafka</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>bootstrap-servers</span><span class=p>:</span><span class=w> </span><span class=l>localhost:9092</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>producer</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>key-serializer</span><span class=p>:</span><span class=w> </span><span class=l>org.apache.kafka.common.serialization.StringSerializer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value-serializer</span><span class=p>:</span><span class=w> </span><span class=l>org.springframework.kafka.support.serializer.JsonSerializer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>consumer</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>group-id</span><span class=p>:</span><span class=w> </span><span class=l>order-processing-group</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>auto-offset-reset</span><span class=p>:</span><span class=w> </span><span class=l>earliest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>key-deserializer</span><span class=p>:</span><span class=w> </span><span class=l>org.apache.kafka.common.serialization.StringDeserializer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value-deserializer</span><span class=p>:</span><span class=w> </span><span class=l>org.springframework.kafka.support.serializer.JsonDeserializer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>properties</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>spring.json.trusted.packages</span><span class=p>:</span><span class=w> </span><span class=l>com.example.model</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>이벤트 모델</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nn>com.example.model</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.math.BigDecimal</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.time.LocalDateTime</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderEvent</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>orderId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>customerId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>amount</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>timestamp</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 생성자, 게터, 세터 생략</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>이벤트 생산자 서비스</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14>14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15>15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16>16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17>17</a>
</span><span class=lnt id=hl-6-18><a class=lnlinks href=#hl-6-18>18</a>
</span><span class=lnt id=hl-6-19><a class=lnlinks href=#hl-6-19>19</a>
</span><span class=lnt id=hl-6-20><a class=lnlinks href=#hl-6-20>20</a>
</span><span class=lnt id=hl-6-21><a class=lnlinks href=#hl-6-21>21</a>
</span><span class=lnt id=hl-6-22><a class=lnlinks href=#hl-6-22>22</a>
</span><span class=lnt id=hl-6-23><a class=lnlinks href=#hl-6-23>23</a>
</span><span class=lnt id=hl-6-24><a class=lnlinks href=#hl-6-24>24</a>
</span><span class=lnt id=hl-6-25><a class=lnlinks href=#hl-6-25>25</a>
</span><span class=lnt id=hl-6-26><a class=lnlinks href=#hl-6-26>26</a>
</span><span class=lnt id=hl-6-27><a class=lnlinks href=#hl-6-27>27</a>
</span><span class=lnt id=hl-6-28><a class=lnlinks href=#hl-6-28>28</a>
</span><span class=lnt id=hl-6-29><a class=lnlinks href=#hl-6-29>29</a>
</span><span class=lnt id=hl-6-30><a class=lnlinks href=#hl-6-30>30</a>
</span><span class=lnt id=hl-6-31><a class=lnlinks href=#hl-6-31>31</a>
</span><span class=lnt id=hl-6-32><a class=lnlinks href=#hl-6-32>32</a>
</span><span class=lnt id=hl-6-33><a class=lnlinks href=#hl-6-33>33</a>
</span><span class=lnt id=hl-6-34><a class=lnlinks href=#hl-6-34>34</a>
</span><span class=lnt id=hl-6-35><a class=lnlinks href=#hl-6-35>35</a>
</span><span class=lnt id=hl-6-36><a class=lnlinks href=#hl-6-36>36</a>
</span><span class=lnt id=hl-6-37><a class=lnlinks href=#hl-6-37>37</a>
</span><span class=lnt id=hl-6-38><a class=lnlinks href=#hl-6-38>38</a>
</span><span class=lnt id=hl-6-39><a class=lnlinks href=#hl-6-39>39</a>
</span><span class=lnt id=hl-6-40><a class=lnlinks href=#hl-6-40>40</a>
</span><span class=lnt id=hl-6-41><a class=lnlinks href=#hl-6-41>41</a>
</span><span class=lnt id=hl-6-42><a class=lnlinks href=#hl-6-42>42</a>
</span><span class=lnt id=hl-6-43><a class=lnlinks href=#hl-6-43>43</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nn>com.example.service</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>com.example.model.OrderEvent</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.beans.factory.annotation.Autowired</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.kafka.core.KafkaTemplate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.kafka.support.SendResult</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.stereotype.Service</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.util.concurrent.ListenableFuture</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.util.concurrent.ListenableFutureCallback</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.time.LocalDateTime</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderEventProducer</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>TOPIC</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;order-events&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>KafkaTemplate</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>OrderEvent</span><span class=o>&gt;</span><span class=w> </span><span class=n>kafkaTemplate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>sendOrderEvent</span><span class=p>(</span><span class=n>OrderEvent</span><span class=w> </span><span class=n>orderEvent</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 타임스탬프 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>orderEvent</span><span class=p>.</span><span class=na>setTimestamp</span><span class=p>(</span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 키는 주문 ID, 값은 OrderEvent 객체</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>ListenableFuture</span><span class=o>&lt;</span><span class=n>SendResult</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>OrderEvent</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>future</span><span class=w> </span><span class=o>=</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>kafkaTemplate</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=n>TOPIC</span><span class=p>,</span><span class=w> </span><span class=n>orderEvent</span><span class=p>.</span><span class=na>getOrderId</span><span class=p>(),</span><span class=w> </span><span class=n>orderEvent</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>future</span><span class=p>.</span><span class=na>addCallback</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>ListenableFutureCallback</span><span class=o>&lt;</span><span class=n>SendResult</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>OrderEvent</span><span class=o>&gt;&gt;</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onSuccess</span><span class=p>(</span><span class=n>SendResult</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>OrderEvent</span><span class=o>&gt;</span><span class=w> </span><span class=n>result</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;주문 이벤트 전송 성공: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>orderEvent</span><span class=p>.</span><span class=na>getOrderId</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=s>&#34;, 오프셋: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>result</span><span class=p>.</span><span class=na>getRecordMetadata</span><span class=p>().</span><span class=na>offset</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onFailure</span><span class=p>(</span><span class=n>Throwable</span><span class=w> </span><span class=n>ex</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>System</span><span class=p>.</span><span class=na>err</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;주문 이벤트 전송 실패: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>orderEvent</span><span class=p>.</span><span class=na>getOrderId</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=s>&#34;, 원인: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>ex</span><span class=p>.</span><span class=na>getMessage</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>이벤트 소비자 서비스</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span><span class=lnt id=hl-7-12><a class=lnlinks href=#hl-7-12>12</a>
</span><span class=lnt id=hl-7-13><a class=lnlinks href=#hl-7-13>13</a>
</span><span class=lnt id=hl-7-14><a class=lnlinks href=#hl-7-14>14</a>
</span><span class=lnt id=hl-7-15><a class=lnlinks href=#hl-7-15>15</a>
</span><span class=lnt id=hl-7-16><a class=lnlinks href=#hl-7-16>16</a>
</span><span class=lnt id=hl-7-17><a class=lnlinks href=#hl-7-17>17</a>
</span><span class=lnt id=hl-7-18><a class=lnlinks href=#hl-7-18>18</a>
</span><span class=lnt id=hl-7-19><a class=lnlinks href=#hl-7-19>19</a>
</span><span class=lnt id=hl-7-20><a class=lnlinks href=#hl-7-20>20</a>
</span><span class=lnt id=hl-7-21><a class=lnlinks href=#hl-7-21>21</a>
</span><span class=lnt id=hl-7-22><a class=lnlinks href=#hl-7-22>22</a>
</span><span class=lnt id=hl-7-23><a class=lnlinks href=#hl-7-23>23</a>
</span><span class=lnt id=hl-7-24><a class=lnlinks href=#hl-7-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nn>com.example.service</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>com.example.model.OrderEvent</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.kafka.annotation.KafkaListener</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.stereotype.Service</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderEventConsumer</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@KafkaListener</span><span class=p>(</span><span class=n>topics</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;order-events&#34;</span><span class=p>,</span><span class=w> </span><span class=n>groupId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;order-processing-group&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>consume</span><span class=p>(</span><span class=n>OrderEvent</span><span class=w> </span><span class=n>orderEvent</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;주문 이벤트 수신: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>orderEvent</span><span class=p>.</span><span class=na>getOrderId</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 여기서 비즈니스 로직 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>processOrder</span><span class=p>(</span><span class=n>orderEvent</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>processOrder</span><span class=p>(</span><span class=n>OrderEvent</span><span class=w> </span><span class=n>orderEvent</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 주문 처리 로직</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;주문 처리 중: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>orderEvent</span><span class=p>.</span><span class=na>getOrderId</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=s>&#34;, 고객: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>orderEvent</span><span class=p>.</span><span class=na>getCustomerId</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=s>&#34;, 금액: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>orderEvent</span><span class=p>.</span><span class=na>getAmount</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=심화-주제>심화 주제<a hidden class=anchor aria-hidden=true href=#심화-주제>#</a></h3><h4 id=이벤트-스트리밍과-처리>이벤트 스트리밍과 처리<a hidden class=anchor aria-hidden=true href=#이벤트-스트리밍과-처리>#</a></h4><h5 id=kafka-streams-사용-예제>Kafka Streams 사용 예제<a hidden class=anchor aria-hidden=true href=#kafka-streams-사용-예제>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1> 1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2> 2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3> 3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4> 4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5> 5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6> 6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7> 7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8> 8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9> 9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10>10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11>11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12>12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13>13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14>14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15>15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16>16</a>
</span><span class=lnt id=hl-8-17><a class=lnlinks href=#hl-8-17>17</a>
</span><span class=lnt id=hl-8-18><a class=lnlinks href=#hl-8-18>18</a>
</span><span class=lnt id=hl-8-19><a class=lnlinks href=#hl-8-19>19</a>
</span><span class=lnt id=hl-8-20><a class=lnlinks href=#hl-8-20>20</a>
</span><span class=lnt id=hl-8-21><a class=lnlinks href=#hl-8-21>21</a>
</span><span class=lnt id=hl-8-22><a class=lnlinks href=#hl-8-22>22</a>
</span><span class=lnt id=hl-8-23><a class=lnlinks href=#hl-8-23>23</a>
</span><span class=lnt id=hl-8-24><a class=lnlinks href=#hl-8-24>24</a>
</span><span class=lnt id=hl-8-25><a class=lnlinks href=#hl-8-25>25</a>
</span><span class=lnt id=hl-8-26><a class=lnlinks href=#hl-8-26>26</a>
</span><span class=lnt id=hl-8-27><a class=lnlinks href=#hl-8-27>27</a>
</span><span class=lnt id=hl-8-28><a class=lnlinks href=#hl-8-28>28</a>
</span><span class=lnt id=hl-8-29><a class=lnlinks href=#hl-8-29>29</a>
</span><span class=lnt id=hl-8-30><a class=lnlinks href=#hl-8-30>30</a>
</span><span class=lnt id=hl-8-31><a class=lnlinks href=#hl-8-31>31</a>
</span><span class=lnt id=hl-8-32><a class=lnlinks href=#hl-8-32>32</a>
</span><span class=lnt id=hl-8-33><a class=lnlinks href=#hl-8-33>33</a>
</span><span class=lnt id=hl-8-34><a class=lnlinks href=#hl-8-34>34</a>
</span><span class=lnt id=hl-8-35><a class=lnlinks href=#hl-8-35>35</a>
</span><span class=lnt id=hl-8-36><a class=lnlinks href=#hl-8-36>36</a>
</span><span class=lnt id=hl-8-37><a class=lnlinks href=#hl-8-37>37</a>
</span><span class=lnt id=hl-8-38><a class=lnlinks href=#hl-8-38>38</a>
</span><span class=lnt id=hl-8-39><a class=lnlinks href=#hl-8-39>39</a>
</span><span class=lnt id=hl-8-40><a class=lnlinks href=#hl-8-40>40</a>
</span><span class=lnt id=hl-8-41><a class=lnlinks href=#hl-8-41>41</a>
</span><span class=lnt id=hl-8-42><a class=lnlinks href=#hl-8-42>42</a>
</span><span class=lnt id=hl-8-43><a class=lnlinks href=#hl-8-43>43</a>
</span><span class=lnt id=hl-8-44><a class=lnlinks href=#hl-8-44>44</a>
</span><span class=lnt id=hl-8-45><a class=lnlinks href=#hl-8-45>45</a>
</span><span class=lnt id=hl-8-46><a class=lnlinks href=#hl-8-46>46</a>
</span><span class=lnt id=hl-8-47><a class=lnlinks href=#hl-8-47>47</a>
</span><span class=lnt id=hl-8-48><a class=lnlinks href=#hl-8-48>48</a>
</span><span class=lnt id=hl-8-49><a class=lnlinks href=#hl-8-49>49</a>
</span><span class=lnt id=hl-8-50><a class=lnlinks href=#hl-8-50>50</a>
</span><span class=lnt id=hl-8-51><a class=lnlinks href=#hl-8-51>51</a>
</span><span class=lnt id=hl-8-52><a class=lnlinks href=#hl-8-52>52</a>
</span><span class=lnt id=hl-8-53><a class=lnlinks href=#hl-8-53>53</a>
</span><span class=lnt id=hl-8-54><a class=lnlinks href=#hl-8-54>54</a>
</span><span class=lnt id=hl-8-55><a class=lnlinks href=#hl-8-55>55</a>
</span><span class=lnt id=hl-8-56><a class=lnlinks href=#hl-8-56>56</a>
</span><span class=lnt id=hl-8-57><a class=lnlinks href=#hl-8-57>57</a>
</span><span class=lnt id=hl-8-58><a class=lnlinks href=#hl-8-58>58</a>
</span><span class=lnt id=hl-8-59><a class=lnlinks href=#hl-8-59>59</a>
</span><span class=lnt id=hl-8-60><a class=lnlinks href=#hl-8-60>60</a>
</span><span class=lnt id=hl-8-61><a class=lnlinks href=#hl-8-61>61</a>
</span><span class=lnt id=hl-8-62><a class=lnlinks href=#hl-8-62>62</a>
</span><span class=lnt id=hl-8-63><a class=lnlinks href=#hl-8-63>63</a>
</span><span class=lnt id=hl-8-64><a class=lnlinks href=#hl-8-64>64</a>
</span><span class=lnt id=hl-8-65><a class=lnlinks href=#hl-8-65>65</a>
</span><span class=lnt id=hl-8-66><a class=lnlinks href=#hl-8-66>66</a>
</span><span class=lnt id=hl-8-67><a class=lnlinks href=#hl-8-67>67</a>
</span><span class=lnt id=hl-8-68><a class=lnlinks href=#hl-8-68>68</a>
</span><span class=lnt id=hl-8-69><a class=lnlinks href=#hl-8-69>69</a>
</span><span class=lnt id=hl-8-70><a class=lnlinks href=#hl-8-70>70</a>
</span><span class=lnt id=hl-8-71><a class=lnlinks href=#hl-8-71>71</a>
</span><span class=lnt id=hl-8-72><a class=lnlinks href=#hl-8-72>72</a>
</span><span class=lnt id=hl-8-73><a class=lnlinks href=#hl-8-73>73</a>
</span><span class=lnt id=hl-8-74><a class=lnlinks href=#hl-8-74>74</a>
</span><span class=lnt id=hl-8-75><a class=lnlinks href=#hl-8-75>75</a>
</span><span class=lnt id=hl-8-76><a class=lnlinks href=#hl-8-76>76</a>
</span><span class=lnt id=hl-8-77><a class=lnlinks href=#hl-8-77>77</a>
</span><span class=lnt id=hl-8-78><a class=lnlinks href=#hl-8-78>78</a>
</span><span class=lnt id=hl-8-79><a class=lnlinks href=#hl-8-79>79</a>
</span><span class=lnt id=hl-8-80><a class=lnlinks href=#hl-8-80>80</a>
</span><span class=lnt id=hl-8-81><a class=lnlinks href=#hl-8-81>81</a>
</span><span class=lnt id=hl-8-82><a class=lnlinks href=#hl-8-82>82</a>
</span><span class=lnt id=hl-8-83><a class=lnlinks href=#hl-8-83>83</a>
</span><span class=lnt id=hl-8-84><a class=lnlinks href=#hl-8-84>84</a>
</span><span class=lnt id=hl-8-85><a class=lnlinks href=#hl-8-85>85</a>
</span><span class=lnt id=hl-8-86><a class=lnlinks href=#hl-8-86>86</a>
</span><span class=lnt id=hl-8-87><a class=lnlinks href=#hl-8-87>87</a>
</span><span class=lnt id=hl-8-88><a class=lnlinks href=#hl-8-88>88</a>
</span><span class=lnt id=hl-8-89><a class=lnlinks href=#hl-8-89>89</a>
</span><span class=lnt id=hl-8-90><a class=lnlinks href=#hl-8-90>90</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>package</span><span class=w> </span><span class=nn>com.example.streaming</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.apache.kafka.common.serialization.Serdes</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.apache.kafka.streams.KafkaStreams</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.apache.kafka.streams.StreamsBuilder</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.apache.kafka.streams.StreamsConfig</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.apache.kafka.streams.kstream.KStream</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.apache.kafka.streams.kstream.KTable</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.apache.kafka.streams.kstream.Produced</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.Properties</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderProcessingStream</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 스트림 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Properties</span><span class=w> </span><span class=n>props</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Properties</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>StreamsConfig</span><span class=p>.</span><span class=na>APPLICATION_ID_CONFIG</span><span class=p>,</span><span class=w> </span><span class=s>&#34;order-analysis-app&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>StreamsConfig</span><span class=p>.</span><span class=na>BOOTSTRAP_SERVERS_CONFIG</span><span class=p>,</span><span class=w> </span><span class=s>&#34;localhost:9092&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>StreamsConfig</span><span class=p>.</span><span class=na>DEFAULT_KEY_SERDE_CLASS_CONFIG</span><span class=p>,</span><span class=w> </span><span class=n>Serdes</span><span class=p>.</span><span class=na>String</span><span class=p>().</span><span class=na>getClass</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>StreamsConfig</span><span class=p>.</span><span class=na>DEFAULT_VALUE_SERDE_CLASS_CONFIG</span><span class=p>,</span><span class=w> </span><span class=n>Serdes</span><span class=p>.</span><span class=na>String</span><span class=p>().</span><span class=na>getClass</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 스트림 빌더</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>StreamsBuilder</span><span class=w> </span><span class=n>builder</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StreamsBuilder</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 입력 스트림 생성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>KStream</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>orderEvents</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>builder</span><span class=p>.</span><span class=na>stream</span><span class=p>(</span><span class=s>&#34;order-events&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 주문 금액으로 필터링 (JSON 문자열 파싱 가정)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>KStream</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>highValueOrders</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>orderEvents</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>filter</span><span class=p>((</span><span class=n>key</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// JSON 파싱 및 금액 추출 로직</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=kt>double</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>extractAmountFromJson</span><span class=p>(</span><span class=n>value</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>1000</span><span class=p>.</span><span class=na>0</span><span class=p>;</span><span class=w> </span><span class=c1>// 고액 주문 필터링</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 고액 주문을 별도 토픽으로 전송</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>highValueOrders</span><span class=p>.</span><span class=na>to</span><span class=p>(</span><span class=s>&#34;high-value-orders&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Produced</span><span class=p>.</span><span class=na>with</span><span class=p>(</span><span class=n>Serdes</span><span class=p>.</span><span class=na>String</span><span class=p>(),</span><span class=w> </span><span class=n>Serdes</span><span class=p>.</span><span class=na>String</span><span class=p>()));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 고객별 주문 합계 계산</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>KTable</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Double</span><span class=o>&gt;</span><span class=w> </span><span class=n>customerOrderTotals</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>orderEvents</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>groupBy</span><span class=p>((</span><span class=n>key</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>extractCustomerIdFromJson</span><span class=p>(</span><span class=n>value</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>aggregate</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>0</span><span class=p>.</span><span class=na>0</span><span class=p>,</span><span class=w> </span><span class=c1>// 초기값</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>(</span><span class=n>customerId</span><span class=p>,</span><span class=w> </span><span class=n>orderJson</span><span class=p>,</span><span class=w> </span><span class=n>total</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=kt>double</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>extractAmountFromJson</span><span class=p>(</span><span class=n>orderJson</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>return</span><span class=w> </span><span class=n>total</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>amount</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 고객별 합계를 별도 토픽으로 전송</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>customerOrderTotals</span><span class=p>.</span><span class=na>toStream</span><span class=p>().</span><span class=na>to</span><span class=p>(</span><span class=s>&#34;customer-order-totals&#34;</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Produced</span><span class=p>.</span><span class=na>with</span><span class=p>(</span><span class=n>Serdes</span><span class=p>.</span><span class=na>String</span><span class=p>(),</span><span class=w> </span><span class=n>Serdes</span><span class=p>.</span><span class=na>Double</span><span class=p>()));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 스트림 생성 및 시작</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>KafkaStreams</span><span class=w> </span><span class=n>streams</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>KafkaStreams</span><span class=p>(</span><span class=n>builder</span><span class=p>.</span><span class=na>build</span><span class=p>(),</span><span class=w> </span><span class=n>props</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>streams</span><span class=p>.</span><span class=na>start</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 종료 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Runtime</span><span class=p>.</span><span class=na>getRuntime</span><span class=p>().</span><span class=na>addShutdownHook</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>Thread</span><span class=p>(</span><span class=n>streams</span><span class=p>::</span><span class=n>close</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// JSON 문자열에서 금액 추출 (간단한 예시)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=nf>extractAmountFromJson</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>json</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 실제 구현에서는 JSON 라이브러리 사용</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 여기서는 예시로 간단히 구현</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>json</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=s>&#34;\&#34;amount\&#34;:&#34;</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>start</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>json</span><span class=p>.</span><span class=na>indexOf</span><span class=p>(</span><span class=s>&#34;\&#34;amount\&#34;:&#34;</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;\&#34;amount\&#34;:&#34;</span><span class=p>.</span><span class=na>length</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>end</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>json</span><span class=p>.</span><span class=na>indexOf</span><span class=p>(</span><span class=s>&#34;,&#34;</span><span class=p>,</span><span class=w> </span><span class=n>start</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>end</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=o>-</span><span class=n>1</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>end</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>json</span><span class=p>.</span><span class=na>indexOf</span><span class=p>(</span><span class=s>&#34;}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>start</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>Double</span><span class=p>.</span><span class=na>parseDouble</span><span class=p>(</span><span class=n>json</span><span class=p>.</span><span class=na>substring</span><span class=p>(</span><span class=n>start</span><span class=p>,</span><span class=w> </span><span class=n>end</span><span class=p>).</span><span class=na>trim</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>0</span><span class=p>.</span><span class=na>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// JSON 문자열에서 고객 ID 추출</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>extractCustomerIdFromJson</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>json</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 실제 구현에서는 JSON 라이브러리 사용</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>json</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=s>&#34;\&#34;customerId\&#34;:&#34;</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>start</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>json</span><span class=p>.</span><span class=na>indexOf</span><span class=p>(</span><span class=s>&#34;\&#34;customerId\&#34;:&#34;</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;\&#34;customerId\&#34;:&#34;</span><span class=p>.</span><span class=na>length</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>json</span><span class=p>.</span><span class=na>charAt</span><span class=p>(</span><span class=n>start</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=sc>&#39;\&#34;&#39;</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>start</span><span class=o>++</span><span class=p>;</span><span class=w> </span><span class=c1>// 따옴표 건너뛰기</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=kt>int</span><span class=w> </span><span class=n>end</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>json</span><span class=p>.</span><span class=na>indexOf</span><span class=p>(</span><span class=s>&#34;\&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=n>start</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=n>json</span><span class=p>.</span><span class=na>substring</span><span class=p>(</span><span class=n>start</span><span class=p>,</span><span class=w> </span><span class=n>end</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;unknown&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=이벤트-소싱-event-sourcing-패턴>이벤트 소싱 (Event Sourcing) 패턴<a hidden class=anchor aria-hidden=true href=#이벤트-소싱-event-sourcing-패턴>#</a></h4><p>이벤트 소싱은 시스템의 상태 변화를 이벤트 시퀀스로 저장하는 패턴이다.</p><p><strong>이벤트 소싱 구현 예제</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>  1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>  2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3>  3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4>  4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5>  5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6>  6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7>  7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8>  8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9>  9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10> 10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11> 11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12> 12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13> 13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14> 14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15> 15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16> 16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17> 17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18> 18</a>
</span><span class=lnt id=hl-9-19><a class=lnlinks href=#hl-9-19> 19</a>
</span><span class=lnt id=hl-9-20><a class=lnlinks href=#hl-9-20> 20</a>
</span><span class=lnt id=hl-9-21><a class=lnlinks href=#hl-9-21> 21</a>
</span><span class=lnt id=hl-9-22><a class=lnlinks href=#hl-9-22> 22</a>
</span><span class=lnt id=hl-9-23><a class=lnlinks href=#hl-9-23> 23</a>
</span><span class=lnt id=hl-9-24><a class=lnlinks href=#hl-9-24> 24</a>
</span><span class=lnt id=hl-9-25><a class=lnlinks href=#hl-9-25> 25</a>
</span><span class=lnt id=hl-9-26><a class=lnlinks href=#hl-9-26> 26</a>
</span><span class=lnt id=hl-9-27><a class=lnlinks href=#hl-9-27> 27</a>
</span><span class=lnt id=hl-9-28><a class=lnlinks href=#hl-9-28> 28</a>
</span><span class=lnt id=hl-9-29><a class=lnlinks href=#hl-9-29> 29</a>
</span><span class=lnt id=hl-9-30><a class=lnlinks href=#hl-9-30> 30</a>
</span><span class=lnt id=hl-9-31><a class=lnlinks href=#hl-9-31> 31</a>
</span><span class=lnt id=hl-9-32><a class=lnlinks href=#hl-9-32> 32</a>
</span><span class=lnt id=hl-9-33><a class=lnlinks href=#hl-9-33> 33</a>
</span><span class=lnt id=hl-9-34><a class=lnlinks href=#hl-9-34> 34</a>
</span><span class=lnt id=hl-9-35><a class=lnlinks href=#hl-9-35> 35</a>
</span><span class=lnt id=hl-9-36><a class=lnlinks href=#hl-9-36> 36</a>
</span><span class=lnt id=hl-9-37><a class=lnlinks href=#hl-9-37> 37</a>
</span><span class=lnt id=hl-9-38><a class=lnlinks href=#hl-9-38> 38</a>
</span><span class=lnt id=hl-9-39><a class=lnlinks href=#hl-9-39> 39</a>
</span><span class=lnt id=hl-9-40><a class=lnlinks href=#hl-9-40> 40</a>
</span><span class=lnt id=hl-9-41><a class=lnlinks href=#hl-9-41> 41</a>
</span><span class=lnt id=hl-9-42><a class=lnlinks href=#hl-9-42> 42</a>
</span><span class=lnt id=hl-9-43><a class=lnlinks href=#hl-9-43> 43</a>
</span><span class=lnt id=hl-9-44><a class=lnlinks href=#hl-9-44> 44</a>
</span><span class=lnt id=hl-9-45><a class=lnlinks href=#hl-9-45> 45</a>
</span><span class=lnt id=hl-9-46><a class=lnlinks href=#hl-9-46> 46</a>
</span><span class=lnt id=hl-9-47><a class=lnlinks href=#hl-9-47> 47</a>
</span><span class=lnt id=hl-9-48><a class=lnlinks href=#hl-9-48> 48</a>
</span><span class=lnt id=hl-9-49><a class=lnlinks href=#hl-9-49> 49</a>
</span><span class=lnt id=hl-9-50><a class=lnlinks href=#hl-9-50> 50</a>
</span><span class=lnt id=hl-9-51><a class=lnlinks href=#hl-9-51> 51</a>
</span><span class=lnt id=hl-9-52><a class=lnlinks href=#hl-9-52> 52</a>
</span><span class=lnt id=hl-9-53><a class=lnlinks href=#hl-9-53> 53</a>
</span><span class=lnt id=hl-9-54><a class=lnlinks href=#hl-9-54> 54</a>
</span><span class=lnt id=hl-9-55><a class=lnlinks href=#hl-9-55> 55</a>
</span><span class=lnt id=hl-9-56><a class=lnlinks href=#hl-9-56> 56</a>
</span><span class=lnt id=hl-9-57><a class=lnlinks href=#hl-9-57> 57</a>
</span><span class=lnt id=hl-9-58><a class=lnlinks href=#hl-9-58> 58</a>
</span><span class=lnt id=hl-9-59><a class=lnlinks href=#hl-9-59> 59</a>
</span><span class=lnt id=hl-9-60><a class=lnlinks href=#hl-9-60> 60</a>
</span><span class=lnt id=hl-9-61><a class=lnlinks href=#hl-9-61> 61</a>
</span><span class=lnt id=hl-9-62><a class=lnlinks href=#hl-9-62> 62</a>
</span><span class=lnt id=hl-9-63><a class=lnlinks href=#hl-9-63> 63</a>
</span><span class=lnt id=hl-9-64><a class=lnlinks href=#hl-9-64> 64</a>
</span><span class=lnt id=hl-9-65><a class=lnlinks href=#hl-9-65> 65</a>
</span><span class=lnt id=hl-9-66><a class=lnlinks href=#hl-9-66> 66</a>
</span><span class=lnt id=hl-9-67><a class=lnlinks href=#hl-9-67> 67</a>
</span><span class=lnt id=hl-9-68><a class=lnlinks href=#hl-9-68> 68</a>
</span><span class=lnt id=hl-9-69><a class=lnlinks href=#hl-9-69> 69</a>
</span><span class=lnt id=hl-9-70><a class=lnlinks href=#hl-9-70> 70</a>
</span><span class=lnt id=hl-9-71><a class=lnlinks href=#hl-9-71> 71</a>
</span><span class=lnt id=hl-9-72><a class=lnlinks href=#hl-9-72> 72</a>
</span><span class=lnt id=hl-9-73><a class=lnlinks href=#hl-9-73> 73</a>
</span><span class=lnt id=hl-9-74><a class=lnlinks href=#hl-9-74> 74</a>
</span><span class=lnt id=hl-9-75><a class=lnlinks href=#hl-9-75> 75</a>
</span><span class=lnt id=hl-9-76><a class=lnlinks href=#hl-9-76> 76</a>
</span><span class=lnt id=hl-9-77><a class=lnlinks href=#hl-9-77> 77</a>
</span><span class=lnt id=hl-9-78><a class=lnlinks href=#hl-9-78> 78</a>
</span><span class=lnt id=hl-9-79><a class=lnlinks href=#hl-9-79> 79</a>
</span><span class=lnt id=hl-9-80><a class=lnlinks href=#hl-9-80> 80</a>
</span><span class=lnt id=hl-9-81><a class=lnlinks href=#hl-9-81> 81</a>
</span><span class=lnt id=hl-9-82><a class=lnlinks href=#hl-9-82> 82</a>
</span><span class=lnt id=hl-9-83><a class=lnlinks href=#hl-9-83> 83</a>
</span><span class=lnt id=hl-9-84><a class=lnlinks href=#hl-9-84> 84</a>
</span><span class=lnt id=hl-9-85><a class=lnlinks href=#hl-9-85> 85</a>
</span><span class=lnt id=hl-9-86><a class=lnlinks href=#hl-9-86> 86</a>
</span><span class=lnt id=hl-9-87><a class=lnlinks href=#hl-9-87> 87</a>
</span><span class=lnt id=hl-9-88><a class=lnlinks href=#hl-9-88> 88</a>
</span><span class=lnt id=hl-9-89><a class=lnlinks href=#hl-9-89> 89</a>
</span><span class=lnt id=hl-9-90><a class=lnlinks href=#hl-9-90> 90</a>
</span><span class=lnt id=hl-9-91><a class=lnlinks href=#hl-9-91> 91</a>
</span><span class=lnt id=hl-9-92><a class=lnlinks href=#hl-9-92> 92</a>
</span><span class=lnt id=hl-9-93><a class=lnlinks href=#hl-9-93> 93</a>
</span><span class=lnt id=hl-9-94><a class=lnlinks href=#hl-9-94> 94</a>
</span><span class=lnt id=hl-9-95><a class=lnlinks href=#hl-9-95> 95</a>
</span><span class=lnt id=hl-9-96><a class=lnlinks href=#hl-9-96> 96</a>
</span><span class=lnt id=hl-9-97><a class=lnlinks href=#hl-9-97> 97</a>
</span><span class=lnt id=hl-9-98><a class=lnlinks href=#hl-9-98> 98</a>
</span><span class=lnt id=hl-9-99><a class=lnlinks href=#hl-9-99> 99</a>
</span><span class=lnt id=hl-9-100><a class=lnlinks href=#hl-9-100>100</a>
</span><span class=lnt id=hl-9-101><a class=lnlinks href=#hl-9-101>101</a>
</span><span class=lnt id=hl-9-102><a class=lnlinks href=#hl-9-102>102</a>
</span><span class=lnt id=hl-9-103><a class=lnlinks href=#hl-9-103>103</a>
</span><span class=lnt id=hl-9-104><a class=lnlinks href=#hl-9-104>104</a>
</span><span class=lnt id=hl-9-105><a class=lnlinks href=#hl-9-105>105</a>
</span><span class=lnt id=hl-9-106><a class=lnlinks href=#hl-9-106>106</a>
</span><span class=lnt id=hl-9-107><a class=lnlinks href=#hl-9-107>107</a>
</span><span class=lnt id=hl-9-108><a class=lnlinks href=#hl-9-108>108</a>
</span><span class=lnt id=hl-9-109><a class=lnlinks href=#hl-9-109>109</a>
</span><span class=lnt id=hl-9-110><a class=lnlinks href=#hl-9-110>110</a>
</span><span class=lnt id=hl-9-111><a class=lnlinks href=#hl-9-111>111</a>
</span><span class=lnt id=hl-9-112><a class=lnlinks href=#hl-9-112>112</a>
</span><span class=lnt id=hl-9-113><a class=lnlinks href=#hl-9-113>113</a>
</span><span class=lnt id=hl-9-114><a class=lnlinks href=#hl-9-114>114</a>
</span><span class=lnt id=hl-9-115><a class=lnlinks href=#hl-9-115>115</a>
</span><span class=lnt id=hl-9-116><a class=lnlinks href=#hl-9-116>116</a>
</span><span class=lnt id=hl-9-117><a class=lnlinks href=#hl-9-117>117</a>
</span><span class=lnt id=hl-9-118><a class=lnlinks href=#hl-9-118>118</a>
</span><span class=lnt id=hl-9-119><a class=lnlinks href=#hl-9-119>119</a>
</span><span class=lnt id=hl-9-120><a class=lnlinks href=#hl-9-120>120</a>
</span><span class=lnt id=hl-9-121><a class=lnlinks href=#hl-9-121>121</a>
</span><span class=lnt id=hl-9-122><a class=lnlinks href=#hl-9-122>122</a>
</span><span class=lnt id=hl-9-123><a class=lnlinks href=#hl-9-123>123</a>
</span><span class=lnt id=hl-9-124><a class=lnlinks href=#hl-9-124>124</a>
</span><span class=lnt id=hl-9-125><a class=lnlinks href=#hl-9-125>125</a>
</span><span class=lnt id=hl-9-126><a class=lnlinks href=#hl-9-126>126</a>
</span><span class=lnt id=hl-9-127><a class=lnlinks href=#hl-9-127>127</a>
</span><span class=lnt id=hl-9-128><a class=lnlinks href=#hl-9-128>128</a>
</span><span class=lnt id=hl-9-129><a class=lnlinks href=#hl-9-129>129</a>
</span><span class=lnt id=hl-9-130><a class=lnlinks href=#hl-9-130>130</a>
</span><span class=lnt id=hl-9-131><a class=lnlinks href=#hl-9-131>131</a>
</span><span class=lnt id=hl-9-132><a class=lnlinks href=#hl-9-132>132</a>
</span><span class=lnt id=hl-9-133><a class=lnlinks href=#hl-9-133>133</a>
</span><span class=lnt id=hl-9-134><a class=lnlinks href=#hl-9-134>134</a>
</span><span class=lnt id=hl-9-135><a class=lnlinks href=#hl-9-135>135</a>
</span><span class=lnt id=hl-9-136><a class=lnlinks href=#hl-9-136>136</a>
</span><span class=lnt id=hl-9-137><a class=lnlinks href=#hl-9-137>137</a>
</span><span class=lnt id=hl-9-138><a class=lnlinks href=#hl-9-138>138</a>
</span><span class=lnt id=hl-9-139><a class=lnlinks href=#hl-9-139>139</a>
</span><span class=lnt id=hl-9-140><a class=lnlinks href=#hl-9-140>140</a>
</span><span class=lnt id=hl-9-141><a class=lnlinks href=#hl-9-141>141</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 이벤트 클래스</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>abstract</span><span class=w> </span><span class=kd>class</span> <span class=nc>DomainEvent</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>aggregateId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>timestamp</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>DomainEvent</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>aggregateId</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>aggregateId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>aggregateId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>timestamp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>System</span><span class=p>.</span><span class=na>currentTimeMillis</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 게터 메소드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 주문 생성 이벤트</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderCreatedEvent</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>DomainEvent</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>customerId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>initialAmount</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>OrderCreatedEvent</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>orderId</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>customerId</span><span class=p>,</span><span class=w> </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>initialAmount</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>(</span><span class=n>orderId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>customerId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>customerId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>initialAmount</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>initialAmount</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 게터 메소드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 주문 항목 추가 이벤트</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderItemAddedEvent</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>DomainEvent</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>productId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>quantity</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>price</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>OrderItemAddedEvent</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>orderId</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>productId</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>quantity</span><span class=p>,</span><span class=w> </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>price</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>super</span><span class=p>(</span><span class=n>orderId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>productId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>productId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>quantity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>quantity</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>price</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>price</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 게터 메소드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 이벤트 저장소 인터페이스</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>interface</span> <span class=nc>EventStore</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>saveEvents</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>aggregateId</span><span class=p>,</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>DomainEvent</span><span class=o>&gt;</span><span class=w> </span><span class=n>events</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>expectedVersion</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>List</span><span class=o>&lt;</span><span class=n>DomainEvent</span><span class=o>&gt;</span><span class=w> </span><span class=nf>getEvents</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>aggregateId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 주문 엔티티(애그리게이트 루트)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Order</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>orderId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>customerId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>totalAmount</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>OrderItem</span><span class=o>&gt;</span><span class=w> </span><span class=n>items</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>version</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>DomainEvent</span><span class=o>&gt;</span><span class=w> </span><span class=n>changes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 새 주문 생성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>Order</span><span class=w> </span><span class=nf>createOrder</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>orderId</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>customerId</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Order</span><span class=w> </span><span class=n>order</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Order</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>order</span><span class=p>.</span><span class=na>applyChange</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>OrderCreatedEvent</span><span class=p>(</span><span class=n>orderId</span><span class=p>,</span><span class=w> </span><span class=n>customerId</span><span class=p>,</span><span class=w> </span><span class=n>BigDecimal</span><span class=p>.</span><span class=na>ZERO</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>order</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 이벤트 기록에서 주문 로드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>Order</span><span class=w> </span><span class=nf>loadFromHistory</span><span class=p>(</span><span class=n>List</span><span class=o>&lt;</span><span class=n>DomainEvent</span><span class=o>&gt;</span><span class=w> </span><span class=n>history</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Order</span><span class=w> </span><span class=n>order</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Order</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>history</span><span class=p>.</span><span class=na>forEach</span><span class=p>(</span><span class=n>order</span><span class=p>::</span><span class=n>applyChange</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>order</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 항목 추가</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>addItem</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>productId</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>quantity</span><span class=p>,</span><span class=w> </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>price</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>applyChange</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>OrderItemAddedEvent</span><span class=p>(</span><span class=n>orderId</span><span class=p>,</span><span class=w> </span><span class=n>productId</span><span class=p>,</span><span class=w> </span><span class=n>quantity</span><span class=p>,</span><span class=w> </span><span class=n>price</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 변경 사항 적용 및 기록</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>applyChange</span><span class=p>(</span><span class=n>DomainEvent</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>applyEvent</span><span class=p>(</span><span class=n>event</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>changes</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>event</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 이벤트 적용</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>applyEvent</span><span class=p>(</span><span class=n>DomainEvent</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>event</span><span class=w> </span><span class=k>instanceof</span><span class=w> </span><span class=n>OrderCreatedEvent</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>OrderCreatedEvent</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>OrderCreatedEvent</span><span class=p>)</span><span class=w> </span><span class=n>event</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>this</span><span class=p>.</span><span class=na>orderId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=na>getAggregateId</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>this</span><span class=p>.</span><span class=na>customerId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=na>getCustomerId</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>this</span><span class=p>.</span><span class=na>totalAmount</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=na>getInitialAmount</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>this</span><span class=p>.</span><span class=na>version</span><span class=o>++</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>event</span><span class=w> </span><span class=k>instanceof</span><span class=w> </span><span class=n>OrderItemAddedEvent</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>OrderItemAddedEvent</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>OrderItemAddedEvent</span><span class=p>)</span><span class=w> </span><span class=n>event</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>OrderItem</span><span class=w> </span><span class=n>item</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>OrderItem</span><span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=na>getProductId</span><span class=p>(),</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=na>getQuantity</span><span class=p>(),</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=na>getPrice</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>this</span><span class=p>.</span><span class=na>items</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>item</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>this</span><span class=p>.</span><span class=na>totalAmount</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>totalAmount</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>item</span><span class=p>.</span><span class=na>getTotalPrice</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>this</span><span class=p>.</span><span class=na>version</span><span class=o>++</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 변경 사항 커밋</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>DomainEvent</span><span class=o>&gt;</span><span class=w> </span><span class=nf>getUncommittedChanges</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>changes</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>markChangesAsCommitted</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>changes</span><span class=p>.</span><span class=na>clear</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 게터 메소드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 주문 서비스</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderService</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>EventStore</span><span class=w> </span><span class=n>eventStore</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>OrderService</span><span class=p>(</span><span class=n>EventStore</span><span class=w> </span><span class=n>eventStore</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>eventStore</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>eventStore</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>createOrder</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>customerId</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>orderId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>UUID</span><span class=p>.</span><span class=na>randomUUID</span><span class=p>().</span><span class=na>toString</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Order</span><span class=w> </span><span class=n>order</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Order</span><span class=p>.</span><span class=na>createOrder</span><span class=p>(</span><span class=n>orderId</span><span class=p>,</span><span class=w> </span><span class=n>customerId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>eventStore</span><span class=p>.</span><span class=na>saveEvents</span><span class=p>(</span><span class=n>orderId</span><span class=p>,</span><span class=w> </span><span class=n>order</span><span class=p>.</span><span class=na>getUncommittedChanges</span><span class=p>(),</span><span class=w> </span><span class=o>-</span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>order</span><span class=p>.</span><span class=na>markChangesAsCommitted</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>orderId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>addOrderItem</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>orderId</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>productId</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>quantity</span><span class=p>,</span><span class=w> </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>price</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>DomainEvent</span><span class=o>&gt;</span><span class=w> </span><span class=n>events</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>eventStore</span><span class=p>.</span><span class=na>getEvents</span><span class=p>(</span><span class=n>orderId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Order</span><span class=w> </span><span class=n>order</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Order</span><span class=p>.</span><span class=na>loadFromHistory</span><span class=p>(</span><span class=n>events</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>order</span><span class=p>.</span><span class=na>addItem</span><span class=p>(</span><span class=n>productId</span><span class=p>,</span><span class=w> </span><span class=n>quantity</span><span class=p>,</span><span class=w> </span><span class=n>price</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>eventStore</span><span class=p>.</span><span class=na>saveEvents</span><span class=p>(</span><span class=n>orderId</span><span class=p>,</span><span class=w> </span><span class=n>order</span><span class=p>.</span><span class=na>getUncommittedChanges</span><span class=p>(),</span><span class=w> </span><span class=n>order</span><span class=p>.</span><span class=na>getVersion</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>order</span><span class=p>.</span><span class=na>getUncommittedChanges</span><span class=p>().</span><span class=na>size</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>order</span><span class=p>.</span><span class=na>markChangesAsCommitted</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Order</span><span class=w> </span><span class=nf>getOrder</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>orderId</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>DomainEvent</span><span class=o>&gt;</span><span class=w> </span><span class=n>events</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>eventStore</span><span class=p>.</span><span class=na>getEvents</span><span class=p>(</span><span class=n>orderId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Order</span><span class=p>.</span><span class=na>loadFromHistory</span><span class=p>(</span><span class=n>events</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=장애-복구-및-내구성-전략>장애 복구 및 내구성 전략<a hidden class=anchor aria-hidden=true href=#장애-복구-및-내구성-전략>#</a></h4><h5 id=메시지-전달-보장-수준>메시지 전달 보장 수준<a hidden class=anchor aria-hidden=true href=#메시지-전달-보장-수준>#</a></h5><ol><li><strong>최대 한 번 전달 (At most once)</strong><ul><li>메시지가 전달되지 않을 수 있음</li><li>성능이 중요하고 데이터 손실이 허용되는 경우</li></ul></li><li><strong>최소 한 번 전달 (At least once)</strong><ul><li>메시지가 중복 전달될 수 있음</li><li>소비자 측에서 멱등성 처리 필요</li><li>Kafka 의 기본 모드</li></ul></li><li><strong>정확히 한 번 전달 (Exactly once)</strong><ul><li>가장 엄격한 보장 수준</li><li>트랜잭션 및 멱등성 프로듀서 사용</li><li>성능 비용 증가</li></ul></li></ol><h5 id=kafka-의-내구성-설정>Kafka 의 내구성 설정<a hidden class=anchor aria-hidden=true href=#kafka-의-내구성-설정>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=c1># 브로커 측 설정</span>
</span></span><span class=line><span class=cl><span class=c1># 데이터 손실 방지를 위한 설정</span>
</span></span><span class=line><span class=cl><span class=na>min.insync.replicas</span><span class=o>=</span><span class=s>2</span>
</span></span><span class=line><span class=cl><span class=na>unclean.leader.election.enable</span><span class=o>=</span><span class=s>false</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 프로듀서 측 설정</span>
</span></span><span class=line><span class=cl><span class=na>acks</span><span class=o>=</span><span class=s>all        # 모든 복제본 확인</span>
</span></span><span class=line><span class=cl><span class=na>retries</span><span class=o>=</span><span class=s>10      # 재시도 횟수</span>
</span></span><span class=line><span class=cl><span class=na>max.in.flight.requests.per.connection</span><span class=o>=</span><span class=s>1  # 순서 보장</span>
</span></span><span class=line><span class=cl><span class=na>enable.idempotence</span><span class=o>=</span><span class=s>true  # 멱등성 활성화</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 트랜잭션 사용 (정확히 한 번 처리)</span>
</span></span><span class=line><span class=cl><span class=na>transactional.id</span><span class=o>=</span><span class=s>unique-id-per-producer</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=대규모-분산-시스템에서의-이벤트-브로커-활용>대규모 분산 시스템에서의 이벤트 브로커 활용<a hidden class=anchor aria-hidden=true href=#대규모-분산-시스템에서의-이벤트-브로커-활용>#</a></h4><h5 id=멀티-데이터-센터-복제>멀티 데이터 센터 복제<a hidden class=anchor aria-hidden=true href=#멀티-데이터-센터-복제>#</a></h5><p>Kafka MirrorMaker 2.0 설정 예시:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1>1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2>2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3>3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4>4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5>5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6>6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7>7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=c1># MirrorMaker 2 설정</span>
</span></span><span class=line><span class=cl><span class=na>clusters</span><span class=o>=</span><span class=s>source, target</span>
</span></span><span class=line><span class=cl><span class=na>source.bootstrap.servers</span><span class=o>=</span><span class=s>source-kafka:9092</span>
</span></span><span class=line><span class=cl><span class=na>target.bootstrap.servers</span><span class=o>=</span><span class=s>target-kafka:9092</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 소스 -&gt; 타겟 복제 설정</span>
</span></span><span class=line><span class=cl><span class=na>source-&gt;target.enabled</span><span class=o>=</span><span class=s>true</span>
</span></span><span class=line><span class=cl><span class=na>source-&gt;target.topics</span><span class=o>=</span><span class=s>.*  # 모든 토픽 복제</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=스트리밍-데이터-파이프라인-구축>스트리밍 데이터 파이프라인 구축<a hidden class=anchor aria-hidden=true href=#스트리밍-데이터-파이프라인-구축>#</a></h5><p>Kafka Connect 로 데이터 파이프라인 구축:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1> 1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2> 2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3> 3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4> 4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5> 5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6> 6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7> 7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8> 8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9> 9</a>
</span><span class=lnt id=hl-12-10><a class=lnlinks href=#hl-12-10>10</a>
</span><span class=lnt id=hl-12-11><a class=lnlinks href=#hl-12-11>11</a>
</span><span class=lnt id=hl-12-12><a class=lnlinks href=#hl-12-12>12</a>
</span><span class=lnt id=hl-12-13><a class=lnlinks href=#hl-12-13>13</a>
</span><span class=lnt id=hl-12-14><a class=lnlinks href=#hl-12-14>14</a>
</span><span class=lnt id=hl-12-15><a class=lnlinks href=#hl-12-15>15</a>
</span><span class=lnt id=hl-12-16><a class=lnlinks href=#hl-12-16>16</a>
</span><span class=lnt id=hl-12-17><a class=lnlinks href=#hl-12-17>17</a>
</span><span class=lnt id=hl-12-18><a class=lnlinks href=#hl-12-18>18</a>
</span><span class=lnt id=hl-12-19><a class=lnlinks href=#hl-12-19>19</a>
</span><span class=lnt id=hl-12-20><a class=lnlinks href=#hl-12-20>20</a>
</span><span class=lnt id=hl-12-21><a class=lnlinks href=#hl-12-21>21</a>
</span><span class=lnt id=hl-12-22><a class=lnlinks href=#hl-12-22>22</a>
</span><span class=lnt id=hl-12-23><a class=lnlinks href=#hl-12-23>23</a>
</span><span class=lnt id=hl-12-24><a class=lnlinks href=#hl-12-24>24</a>
</span><span class=lnt id=hl-12-25><a class=lnlinks href=#hl-12-25>25</a>
</span><span class=lnt id=hl-12-26><a class=lnlinks href=#hl-12-26>26</a>
</span><span class=lnt id=hl-12-27><a class=lnlinks href=#hl-12-27>27</a>
</span><span class=lnt id=hl-12-28><a class=lnlinks href=#hl-12-28>28</a>
</span><span class=lnt id=hl-12-29><a class=lnlinks href=#hl-12-29>29</a>
</span><span class=lnt id=hl-12-30><a class=lnlinks href=#hl-12-30>30</a>
</span><span class=lnt id=hl-12-31><a class=lnlinks href=#hl-12-31>31</a>
</span><span class=lnt id=hl-12-32><a class=lnlinks href=#hl-12-32>32</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=c1>// 소스 커넥터 설정 (데이터베이스 변경 캡처)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;mysql-source-connector&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;config&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;connector.class&#34;</span><span class=p>:</span> <span class=s2>&#34;io.debezium.connector.mysql.MySqlConnector&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;database.hostname&#34;</span><span class=p>:</span> <span class=s2>&#34;mysql-server&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;database.port&#34;</span><span class=p>:</span> <span class=s2>&#34;3306&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;database.user&#34;</span><span class=p>:</span> <span class=s2>&#34;debezium&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;database.password&#34;</span><span class=p>:</span> <span class=s2>&#34;dbz&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;database.server.id&#34;</span><span class=p>:</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;database.server.name&#34;</span><span class=p>:</span> <span class=s2>&#34;mysql-server-1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;table.whitelist&#34;</span><span class=p>:</span> <span class=s2>&#34;inventory.customers&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;database.history.kafka.bootstrap.servers&#34;</span><span class=p>:</span> <span class=s2>&#34;kafka:9092&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;database.history.kafka.topic&#34;</span><span class=p>:</span> <span class=s2>&#34;dbhistory.inventory&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 싱크 커넥터 설정 (ElasticSearch로 데이터 전송)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;elasticsearch-sink&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;config&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;connector.class&#34;</span><span class=p>:</span> <span class=s2>&#34;io.confluent.connect.elasticsearch.ElasticsearchSinkConnector&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;tasks.max&#34;</span><span class=p>:</span> <span class=s2>&#34;1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;topics&#34;</span><span class=p>:</span> <span class=s2>&#34;mysql-server-1.inventory.customers&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;connection.url&#34;</span><span class=p>:</span> <span class=s2>&#34;http://elasticsearch:9200&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;transforms&#34;</span><span class=p>:</span> <span class=s2>&#34;unwrap&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;transforms.unwrap.type&#34;</span><span class=p>:</span> <span class=s2>&#34;io.debezium.transforms.ExtractNewRecordState&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;key.ignore&#34;</span><span class=p>:</span> <span class=s2>&#34;false&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;schema.ignore&#34;</span><span class=p>:</span> <span class=s2>&#34;true&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type.name&#34;</span><span class=p>:</span> <span class=s2>&#34;customer&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=이벤트-브로커-설계-및-운영-모범-사례>이벤트 브로커 설계 및 운영 모범 사례<a hidden class=anchor aria-hidden=true href=#이벤트-브로커-설계-및-운영-모범-사례>#</a></h3><h4 id=토픽-설계-원칙>토픽 설계 원칙<a hidden class=anchor aria-hidden=true href=#토픽-설계-원칙>#</a></h4><ol><li><strong>문제 도메인 기반 토픽 정의</strong><ul><li>비즈니스 도메인 개념과 일치하는 토픽 네이밍</li><li>예: <code>orders</code>, <code>payments</code>, <code>inventory-changes</code></li></ul></li><li><strong>적절한 파티션 수 결정</strong><ul><li>처리량에 맞는 파티션 수 설정</li><li>파티션 수 = 목표 처리량 / 단일 파티션 처리량</li><li>파티션 수가 많을수록 관리 복잡성 증가</li></ul></li><li><strong>효과적인 키 선택</strong><ul><li>관련 이벤트가 같은 파티션에 들어가도록 키 선택</li><li>예: 주문 ID 를 키로 사용하여 주문 관련 이벤트 순서 보장</li></ul></li></ol><h4 id=최적화>최적화<a hidden class=anchor aria-hidden=true href=#최적화>#</a></h4><ol><li><strong>배치 처리 활용</strong><ul><li>프로듀서: <code>batch.size</code>, <code>linger.ms</code> 조정</li><li>소비자: 적절한 <code>fetch.min.bytes</code>, <code>fetch.max.wait.ms</code> 설정</li></ul></li><li><strong>압축 사용</strong><ul><li>네트워크 대역폭 절약 및 처리량 향상</li><li><code>compression.type=snappy</code> 또는 <code>lz4</code> 권장</li></ul></li><li><strong>적절한 버퍼 크기 설정</strong><ul><li>프로듀서: <code>buffer.memory</code></li><li>소비자: <code>fetch.max.bytes</code></li></ul></li></ol><h4 id=모니터링-및-알림-전략>모니터링 및 알림 전략<a hidden class=anchor aria-hidden=true href=#모니터링-및-알림-전략>#</a></h4><ol><li><p><strong>핵심 메트릭 모니터링</strong></p><ul><li>브로커 레벨: CPU, 메모리, 디스크 I/O, 네트워크 I/O</li><li>토픽 레벨: 처리량 (초당 메시지 수), 지연 시간, 복제 지연</li><li>소비자 그룹 레벨: 소비자 지연 (Consumer lag), 처리 시간</li></ul></li><li><p><strong>Prometheus 및 Grafana 를 활용한 모니터링 시스템 구축</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1>1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2>2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3>3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4>4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5>5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6>6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7>7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># Prometheus 설정 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;kafka&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;kafka-exporter:9308&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;kafka-consumer-groups&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;kafka-lag-exporter:9999&#39;</span><span class=p>]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>알림 규칙 설정</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1> 1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2> 2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3> 3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4> 4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5> 5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6> 6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7> 7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8> 8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9> 9</a>
</span><span class=lnt id=hl-14-10><a class=lnlinks href=#hl-14-10>10</a>
</span><span class=lnt id=hl-14-11><a class=lnlinks href=#hl-14-11>11</a>
</span><span class=lnt id=hl-14-12><a class=lnlinks href=#hl-14-12>12</a>
</span><span class=lnt id=hl-14-13><a class=lnlinks href=#hl-14-13>13</a>
</span><span class=lnt id=hl-14-14><a class=lnlinks href=#hl-14-14>14</a>
</span><span class=lnt id=hl-14-15><a class=lnlinks href=#hl-14-15>15</a>
</span><span class=lnt id=hl-14-16><a class=lnlinks href=#hl-14-16>16</a>
</span><span class=lnt id=hl-14-17><a class=lnlinks href=#hl-14-17>17</a>
</span><span class=lnt id=hl-14-18><a class=lnlinks href=#hl-14-18>18</a>
</span><span class=lnt id=hl-14-19><a class=lnlinks href=#hl-14-19>19</a>
</span><span class=lnt id=hl-14-20><a class=lnlinks href=#hl-14-20>20</a>
</span><span class=lnt id=hl-14-21><a class=lnlinks href=#hl-14-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># Prometheus 알림 규칙 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>groups</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>kafka_alerts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>alert</span><span class=p>:</span><span class=w> </span><span class=l>KafkaConsumerLagHigh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>expr</span><span class=p>:</span><span class=w> </span><span class=l>kafka_consumergroup_lag &gt; 10000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>for</span><span class=p>:</span><span class=w> </span><span class=l>10m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class=l>warning</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Kafka consumer lag high&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Consumer group {{ $labels.consumergroup }} on topic {{ $labels.topic }} has lag of {{ $value }} messages&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>alert</span><span class=p>:</span><span class=w> </span><span class=l>KafkaBrokerDown</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>expr</span><span class=p>:</span><span class=w> </span><span class=l>kafka_server_active_controller_count == 0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>for</span><span class=p>:</span><span class=w> </span><span class=l>1m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class=l>critical</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Kafka broker down&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;No active controller in the Kafka cluster&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ol><h4 id=확장성-및-고가용성-설계>확장성 및 고가용성 설계<a hidden class=anchor aria-hidden=true href=#확장성-및-고가용성-설계>#</a></h4><ol><li><p><strong>클러스터 크기 결정</strong></p><ul><li>데이터 보존 기간, 복제 인수, 메시지 크기, 처리량 고려</li><li>용량 계획: <code>(메시지 수/초 × 평균 메시지 크기 × 보존 기간 × 복제 인수) / 브로커 수</code></li></ul></li><li><p><strong>파티션 재할당 전략</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1> 1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2> 2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3> 3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4> 4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5> 5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6> 6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7> 7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8> 8</a>
</span><span class=lnt id=hl-15-9><a class=lnlinks href=#hl-15-9> 9</a>
</span><span class=lnt id=hl-15-10><a class=lnlinks href=#hl-15-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 파티션 재분배 계획 생성</span>
</span></span><span class=line><span class=cl>cat &gt; reassign.json &lt;&lt; EOF
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;version&#34;</span>: 1,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;partitions&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>    <span class=o>{</span><span class=s2>&#34;topic&#34;</span>: <span class=s2>&#34;high-volume-topic&#34;</span>, <span class=s2>&#34;partition&#34;</span>: 0, <span class=s2>&#34;replicas&#34;</span>: <span class=o>[</span>1,2,3<span class=o>]}</span>,
</span></span><span class=line><span class=cl>    <span class=o>{</span><span class=s2>&#34;topic&#34;</span>: <span class=s2>&#34;high-volume-topic&#34;</span>, <span class=s2>&#34;partition&#34;</span>: 1, <span class=s2>&#34;replicas&#34;</span>: <span class=o>[</span>2,3,1<span class=o>]}</span>,
</span></span><span class=line><span class=cl>    <span class=o>{</span><span class=s2>&#34;topic&#34;</span>: <span class=s2>&#34;high-volume-topic&#34;</span>, <span class=s2>&#34;partition&#34;</span>: 2, <span class=s2>&#34;replicas&#34;</span>: <span class=o>[</span>3,1,2<span class=o>]}</span>
</span></span><span class=line><span class=cl>  <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><p>EOF</p><pre><code># 파티션 재분배 실행
kafka-reassign-partitions.sh --bootstrap-server kafka:9092 \
  --reassignment-json-file reassign.json --execute	
```
</code></pre><ol start=3><li><p><strong>롤링 재시작 및 무중단 업그레이드</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 브로커 롤링 재시작 스크립트 예시</span>
</span></span><span class=line><span class=cl><span class=k>for</span> broker in <span class=o>{</span>1.<span class=o>}</span><span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;재시작 broker </span><span class=nv>$broker</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  ssh kafka-<span class=nv>$broker</span> <span class=s1>&#39;systemctl stop kafka&#39;</span>
</span></span><span class=line><span class=cl>  wait_for_shutdown
</span></span><span class=line><span class=cl>  ssh kafka-<span class=nv>$broker</span> <span class=s1>&#39;systemctl start kafka&#39;</span>
</span></span><span class=line><span class=cl>  wait_for_full_recovery
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;브로커 </span><span class=nv>$broker</span><span class=s2> 정상 복구 완료&#34;</span>
</span></span><span class=line><span class=cl>  sleep <span class=m>300</span>  <span class=c1># 다음 브로커 재시작 전 안정화 시간</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=실제-사례-연구-및-문제-해결>실제 사례 연구 및 문제 해결<a hidden class=anchor aria-hidden=true href=#실제-사례-연구-및-문제-해결>#</a></h3><h4 id=대용량-로그-처리-시스템>대용량 로그 처리 시스템<a hidden class=anchor aria-hidden=true href=#대용량-로그-처리-시스템>#</a></h4><p><strong>요구사항:</strong></p><ul><li>초당 10 만 로그 메시지 처리</li><li>7 일간 로그 보존</li><li>로그 타입별 처리 로직 분리</li></ul><p><strong>해결책:</strong></p><ol><li><p><strong>토픽 설계:</strong></p><ul><li>로그 타입별 토픽 생성: <code>app-logs</code>, <code>system-logs</code>, <code>security-logs</code></li><li>각 토픽 24 개 파티션으로 시작 (확장성 확보)</li></ul></li><li><p><strong>프로듀서 설정:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1>1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2>2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3>3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4>4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5>5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6>6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7>7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8>8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Properties</span><span class=w> </span><span class=n>props</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Properties</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;bootstrap.servers&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;kafka1:9092,kafka2:9092,kafka3:9092&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;key.serializer&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;org.apache.kafka.common.serialization.StringSerializer&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;value.serializer&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;org.apache.kafka.common.serialization.StringSerializer&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;compression.type&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;lz4&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;batch.size&#34;</span><span class=p>,</span><span class=w> </span><span class=n>65536</span><span class=p>);</span><span class=w>  </span><span class=c1>// 64KB</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;linger.ms&#34;</span><span class=p>,</span><span class=w> </span><span class=n>10</span><span class=p>);</span><span class=w>  </span><span class=c1>// 10ms 대기 시간으로 배치 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;buffer.memory&#34;</span><span class=p>,</span><span class=w> </span><span class=n>67108864</span><span class=p>);</span><span class=w>  </span><span class=c1>// 64MB</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;acks&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;1&#34;</span><span class=p>);</span><span class=w>  </span><span class=c1>// 리더만 확인 (처리량 중시)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>소비자 그룹 설계:</strong></p><ul><li>로그 유형별 소비자 그룹 구성</li><li>각 소비자 그룹 내 인스턴스 수 = 파티션 수</li><li>탄력적인 스케일링을 위한 Kubernetes StatefulSet 사용</li></ul></li><li><p><strong>로그 처리 파이프라인:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1> 1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2> 2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3> 3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4> 4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5> 5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6> 6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7> 7</a>
</span><span class=lnt id=hl-18-8><a class=lnlinks href=#hl-18-8> 8</a>
</span><span class=lnt id=hl-18-9><a class=lnlinks href=#hl-18-9> 9</a>
</span><span class=lnt id=hl-18-10><a class=lnlinks href=#hl-18-10>10</a>
</span><span class=lnt id=hl-18-11><a class=lnlinks href=#hl-18-11>11</a>
</span><span class=lnt id=hl-18-12><a class=lnlinks href=#hl-18-12>12</a>
</span><span class=lnt id=hl-18-13><a class=lnlinks href=#hl-18-13>13</a>
</span><span class=lnt id=hl-18-14><a class=lnlinks href=#hl-18-14>14</a>
</span><span class=lnt id=hl-18-15><a class=lnlinks href=#hl-18-15>15</a>
</span><span class=lnt id=hl-18-16><a class=lnlinks href=#hl-18-16>16</a>
</span><span class=lnt id=hl-18-17><a class=lnlinks href=#hl-18-17>17</a>
</span><span class=lnt id=hl-18-18><a class=lnlinks href=#hl-18-18>18</a>
</span><span class=lnt id=hl-18-19><a class=lnlinks href=#hl-18-19>19</a>
</span><span class=lnt id=hl-18-20><a class=lnlinks href=#hl-18-20>20</a>
</span><span class=lnt id=hl-18-21><a class=lnlinks href=#hl-18-21>21</a>
</span><span class=lnt id=hl-18-22><a class=lnlinks href=#hl-18-22>22</a>
</span><span class=lnt id=hl-18-23><a class=lnlinks href=#hl-18-23>23</a>
</span><span class=lnt id=hl-18-24><a class=lnlinks href=#hl-18-24>24</a>
</span><span class=lnt id=hl-18-25><a class=lnlinks href=#hl-18-25>25</a>
</span><span class=lnt id=hl-18-26><a class=lnlinks href=#hl-18-26>26</a>
</span><span class=lnt id=hl-18-27><a class=lnlinks href=#hl-18-27>27</a>
</span><span class=lnt id=hl-18-28><a class=lnlinks href=#hl-18-28>28</a>
</span><span class=lnt id=hl-18-29><a class=lnlinks href=#hl-18-29>29</a>
</span><span class=lnt id=hl-18-30><a class=lnlinks href=#hl-18-30>30</a>
</span><span class=lnt id=hl-18-31><a class=lnlinks href=#hl-18-31>31</a>
</span><span class=lnt id=hl-18-32><a class=lnlinks href=#hl-18-32>32</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 로그 처리 소비자 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@KafkaListener</span><span class=p>(</span><span class=n>topics</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;app-logs&#34;</span><span class=p>,</span><span class=w> </span><span class=n>groupId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;app-logs-processor&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>process</span><span class=p>(</span><span class=n>ConsumerRecord</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>record</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>LogEvent</span><span class=w> </span><span class=n>logEvent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>parseLogEvent</span><span class=p>(</span><span class=n>record</span><span class=p>.</span><span class=na>value</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 로그 레벨에 따른 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>switch</span><span class=w> </span><span class=p>(</span><span class=n>logEvent</span><span class=p>.</span><span class=na>getLevel</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>case</span><span class=w> </span><span class=s>&#34;ERROR&#34;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>alertingService</span><span class=p>.</span><span class=na>sendAlert</span><span class=p>(</span><span class=n>logEvent</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>case</span><span class=w> </span><span class=s>&#34;WARN&#34;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>anomalyDetector</span><span class=p>.</span><span class=na>analyze</span><span class=p>(</span><span class=n>logEvent</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>break</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// Elasticsearch에 저장</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>elasticsearchClient</span><span class=p>.</span><span class=na>index</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>IndexRequest</span><span class=p>.</span><span class=na>of</span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>i</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>index</span><span class=p>(</span><span class=s>&#34;app-logs-&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>logEvent</span><span class=p>.</span><span class=na>getDate</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>id</span><span class=p>(</span><span class=n>record</span><span class=p>.</span><span class=na>key</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>document</span><span class=p>(</span><span class=n>logEvent</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 에러 로깅 및 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>log</span><span class=p>.</span><span class=na>error</span><span class=p>(</span><span class=s>&#34;로그 처리 중 오류 발생: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>record</span><span class=p>.</span><span class=na>key</span><span class=p>(),</span><span class=w> </span><span class=n>e</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 오류 토픽으로 전송 (DLQ 패턴)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>kafkaTemplate</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=s>&#34;app-logs-errors&#34;</span><span class=p>,</span><span class=w> </span><span class=n>record</span><span class=p>.</span><span class=na>key</span><span class=p>(),</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kd>record</span><span class=err>.</span><span class=nc>value</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;||ERROR:&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=na>getMessage</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ol><h4 id=마이크로서비스-간-통신-시스템>마이크로서비스 간 통신 시스템<a hidden class=anchor aria-hidden=true href=#마이크로서비스-간-통신-시스템>#</a></h4><p><strong>요구사항:</strong></p><ul><li>주문 처리 시스템 내 마이크로서비스 간 통신</li><li>각 서비스의 독립적 배포와 확장</li><li>서비스 장애 시에도 시스템 지속 운영</li></ul><p><strong>해결책:</strong></p><ol><li><p><strong>토픽 설계:</strong></p><ul><li>도메인 이벤트별 토픽: <code>orders</code>, <code>payments</code>, <code>inventory</code>, <code>shipping</code></li><li>명령 토픽: <code>order-commands</code>, <code>payment-commands</code> 등</li></ul></li><li><p><strong>이벤트 중심 아키텍처 구현:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12>12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13>13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14>14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15>15</a>
</span><span class=lnt id=hl-19-16><a class=lnlinks href=#hl-19-16>16</a>
</span><span class=lnt id=hl-19-17><a class=lnlinks href=#hl-19-17>17</a>
</span><span class=lnt id=hl-19-18><a class=lnlinks href=#hl-19-18>18</a>
</span><span class=lnt id=hl-19-19><a class=lnlinks href=#hl-19-19>19</a>
</span><span class=lnt id=hl-19-20><a class=lnlinks href=#hl-19-20>20</a>
</span><span class=lnt id=hl-19-21><a class=lnlinks href=#hl-19-21>21</a>
</span><span class=lnt id=hl-19-22><a class=lnlinks href=#hl-19-22>22</a>
</span><span class=lnt id=hl-19-23><a class=lnlinks href=#hl-19-23>23</a>
</span><span class=lnt id=hl-19-24><a class=lnlinks href=#hl-19-24>24</a>
</span><span class=lnt id=hl-19-25><a class=lnlinks href=#hl-19-25>25</a>
</span><span class=lnt id=hl-19-26><a class=lnlinks href=#hl-19-26>26</a>
</span><span class=lnt id=hl-19-27><a class=lnlinks href=#hl-19-27>27</a>
</span><span class=lnt id=hl-19-28><a class=lnlinks href=#hl-19-28>28</a>
</span><span class=lnt id=hl-19-29><a class=lnlinks href=#hl-19-29>29</a>
</span><span class=lnt id=hl-19-30><a class=lnlinks href=#hl-19-30>30</a>
</span><span class=lnt id=hl-19-31><a class=lnlinks href=#hl-19-31>31</a>
</span><span class=lnt id=hl-19-32><a class=lnlinks href=#hl-19-32>32</a>
</span><span class=lnt id=hl-19-33><a class=lnlinks href=#hl-19-33>33</a>
</span><span class=lnt id=hl-19-34><a class=lnlinks href=#hl-19-34>34</a>
</span><span class=lnt id=hl-19-35><a class=lnlinks href=#hl-19-35>35</a>
</span><span class=lnt id=hl-19-36><a class=lnlinks href=#hl-19-36>36</a>
</span><span class=lnt id=hl-19-37><a class=lnlinks href=#hl-19-37>37</a>
</span><span class=lnt id=hl-19-38><a class=lnlinks href=#hl-19-38>38</a>
</span><span class=lnt id=hl-19-39><a class=lnlinks href=#hl-19-39>39</a>
</span><span class=lnt id=hl-19-40><a class=lnlinks href=#hl-19-40>40</a>
</span><span class=lnt id=hl-19-41><a class=lnlinks href=#hl-19-41>41</a>
</span><span class=lnt id=hl-19-42><a class=lnlinks href=#hl-19-42>42</a>
</span><span class=lnt id=hl-19-43><a class=lnlinks href=#hl-19-43>43</a>
</span><span class=lnt id=hl-19-44><a class=lnlinks href=#hl-19-44>44</a>
</span><span class=lnt id=hl-19-45><a class=lnlinks href=#hl-19-45>45</a>
</span><span class=lnt id=hl-19-46><a class=lnlinks href=#hl-19-46>46</a>
</span><span class=lnt id=hl-19-47><a class=lnlinks href=#hl-19-47>47</a>
</span><span class=lnt id=hl-19-48><a class=lnlinks href=#hl-19-48>48</a>
</span><span class=lnt id=hl-19-49><a class=lnlinks href=#hl-19-49>49</a>
</span><span class=lnt id=hl-19-50><a class=lnlinks href=#hl-19-50>50</a>
</span><span class=lnt id=hl-19-51><a class=lnlinks href=#hl-19-51>51</a>
</span><span class=lnt id=hl-19-52><a class=lnlinks href=#hl-19-52>52</a>
</span><span class=lnt id=hl-19-53><a class=lnlinks href=#hl-19-53>53</a>
</span><span class=lnt id=hl-19-54><a class=lnlinks href=#hl-19-54>54</a>
</span><span class=lnt id=hl-19-55><a class=lnlinks href=#hl-19-55>55</a>
</span><span class=lnt id=hl-19-56><a class=lnlinks href=#hl-19-56>56</a>
</span><span class=lnt id=hl-19-57><a class=lnlinks href=#hl-19-57>57</a>
</span><span class=lnt id=hl-19-58><a class=lnlinks href=#hl-19-58>58</a>
</span><span class=lnt id=hl-19-59><a class=lnlinks href=#hl-19-59>59</a>
</span><span class=lnt id=hl-19-60><a class=lnlinks href=#hl-19-60>60</a>
</span><span class=lnt id=hl-19-61><a class=lnlinks href=#hl-19-61>61</a>
</span><span class=lnt id=hl-19-62><a class=lnlinks href=#hl-19-62>62</a>
</span><span class=lnt id=hl-19-63><a class=lnlinks href=#hl-19-63>63</a>
</span><span class=lnt id=hl-19-64><a class=lnlinks href=#hl-19-64>64</a>
</span><span class=lnt id=hl-19-65><a class=lnlinks href=#hl-19-65>65</a>
</span><span class=lnt id=hl-19-66><a class=lnlinks href=#hl-19-66>66</a>
</span><span class=lnt id=hl-19-67><a class=lnlinks href=#hl-19-67>67</a>
</span><span class=lnt id=hl-19-68><a class=lnlinks href=#hl-19-68>68</a>
</span><span class=lnt id=hl-19-69><a class=lnlinks href=#hl-19-69>69</a>
</span><span class=lnt id=hl-19-70><a class=lnlinks href=#hl-19-70>70</a>
</span><span class=lnt id=hl-19-71><a class=lnlinks href=#hl-19-71>71</a>
</span><span class=lnt id=hl-19-72><a class=lnlinks href=#hl-19-72>72</a>
</span><span class=lnt id=hl-19-73><a class=lnlinks href=#hl-19-73>73</a>
</span><span class=lnt id=hl-19-74><a class=lnlinks href=#hl-19-74>74</a>
</span><span class=lnt id=hl-19-75><a class=lnlinks href=#hl-19-75>75</a>
</span><span class=lnt id=hl-19-76><a class=lnlinks href=#hl-19-76>76</a>
</span><span class=lnt id=hl-19-77><a class=lnlinks href=#hl-19-77>77</a>
</span><span class=lnt id=hl-19-78><a class=lnlinks href=#hl-19-78>78</a>
</span><span class=lnt id=hl-19-79><a class=lnlinks href=#hl-19-79>79</a>
</span><span class=lnt id=hl-19-80><a class=lnlinks href=#hl-19-80>80</a>
</span><span class=lnt id=hl-19-81><a class=lnlinks href=#hl-19-81>81</a>
</span><span class=lnt id=hl-19-82><a class=lnlinks href=#hl-19-82>82</a>
</span><span class=lnt id=hl-19-83><a class=lnlinks href=#hl-19-83>83</a>
</span><span class=lnt id=hl-19-84><a class=lnlinks href=#hl-19-84>84</a>
</span><span class=lnt id=hl-19-85><a class=lnlinks href=#hl-19-85>85</a>
</span><span class=lnt id=hl-19-86><a class=lnlinks href=#hl-19-86>86</a>
</span><span class=lnt id=hl-19-87><a class=lnlinks href=#hl-19-87>87</a>
</span><span class=lnt id=hl-19-88><a class=lnlinks href=#hl-19-88>88</a>
</span><span class=lnt id=hl-19-89><a class=lnlinks href=#hl-19-89>89</a>
</span><span class=lnt id=hl-19-90><a class=lnlinks href=#hl-19-90>90</a>
</span><span class=lnt id=hl-19-91><a class=lnlinks href=#hl-19-91>91</a>
</span><span class=lnt id=hl-19-92><a class=lnlinks href=#hl-19-92>92</a>
</span><span class=lnt id=hl-19-93><a class=lnlinks href=#hl-19-93>93</a>
</span><span class=lnt id=hl-19-94><a class=lnlinks href=#hl-19-94>94</a>
</span><span class=lnt id=hl-19-95><a class=lnlinks href=#hl-19-95>95</a>
</span><span class=lnt id=hl-19-96><a class=lnlinks href=#hl-19-96>96</a>
</span><span class=lnt id=hl-19-97><a class=lnlinks href=#hl-19-97>97</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 주문 생성 핸들러</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RestController</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>KafkaTemplate</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>OrderEvent</span><span class=o>&gt;</span><span class=w> </span><span class=n>kafkaTemplate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@PostMapping</span><span class=p>(</span><span class=s>&#34;/orders&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>ResponseEntity</span><span class=o>&lt;</span><span class=n>OrderCreatedResponse</span><span class=o>&gt;</span><span class=w> </span><span class=nf>createOrder</span><span class=p>(</span><span class=nd>@RequestBody</span><span class=w> </span><span class=n>CreateOrderRequest</span><span class=w> </span><span class=n>request</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 주문 ID 생성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>orderId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>UUID</span><span class=p>.</span><span class=na>randomUUID</span><span class=p>().</span><span class=na>toString</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 주문 생성 이벤트</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>OrderCreatedEvent</span><span class=w> </span><span class=n>event</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>OrderCreatedEvent</span><span class=p>.</span><span class=na>builder</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>orderId</span><span class=p>(</span><span class=n>orderId</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>customerId</span><span class=p>(</span><span class=n>request</span><span class=p>.</span><span class=na>getCustomerId</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>items</span><span class=p>(</span><span class=n>request</span><span class=p>.</span><span class=na>getItems</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>totalAmount</span><span class=p>(</span><span class=n>calculateTotal</span><span class=p>(</span><span class=n>request</span><span class=p>.</span><span class=na>getItems</span><span class=p>()))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>status</span><span class=p>(</span><span class=s>&#34;CREATED&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>timestamp</span><span class=p>(</span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 이벤트 발행</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>kafkaTemplate</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=s>&#34;orders&#34;</span><span class=p>,</span><span class=w> </span><span class=n>orderId</span><span class=p>,</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>addCallback</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>result</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>log</span><span class=p>.</span><span class=na>info</span><span class=p>(</span><span class=s>&#34;주문 이벤트 발행 성공: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>orderId</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>ex</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>log</span><span class=p>.</span><span class=na>error</span><span class=p>(</span><span class=s>&#34;주문 이벤트 발행 실패: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>orderId</span><span class=p>,</span><span class=w> </span><span class=n>ex</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 응답 반환</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ResponseEntity</span><span class=p>.</span><span class=na>accepted</span><span class=p>().</span><span class=na>body</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>OrderCreatedResponse</span><span class=p>(</span><span class=n>orderId</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 재고 서비스의 주문 이벤트 소비자</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>InventoryEventHandler</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>InventoryService</span><span class=w> </span><span class=n>inventoryService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>KafkaTemplate</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>InventoryEvent</span><span class=o>&gt;</span><span class=w> </span><span class=n>kafkaTemplate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@KafkaListener</span><span class=p>(</span><span class=n>topics</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;orders&#34;</span><span class=p>,</span><span class=w> </span><span class=n>groupId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;inventory-service&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>handleOrderEvent</span><span class=p>(</span><span class=n>OrderCreatedEvent</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 재고 확인 및 할당</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kt>boolean</span><span class=w> </span><span class=n>allItemsAvailable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>inventoryService</span><span class=p>.</span><span class=na>reserveItems</span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getItems</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 결과 이벤트 발행</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>InventoryEvent</span><span class=w> </span><span class=n>resultEvent</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>allItemsAvailable</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>resultEvent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>InventoryReservedEvent</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>event</span><span class=p>.</span><span class=na>getOrderId</span><span class=p>(),</span><span class=w> </span><span class=n>event</span><span class=p>.</span><span class=na>getItems</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>resultEvent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>InventoryShortageEvent</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>event</span><span class=p>.</span><span class=na>getOrderId</span><span class=p>(),</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>inventoryService</span><span class=p>.</span><span class=na>findUnavailableItems</span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getItems</span><span class=p>()));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>kafkaTemplate</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=s>&#34;inventory&#34;</span><span class=p>,</span><span class=w> </span><span class=n>event</span><span class=p>.</span><span class=na>getOrderId</span><span class=p>(),</span><span class=w> </span><span class=n>resultEvent</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>log</span><span class=p>.</span><span class=na>error</span><span class=p>(</span><span class=s>&#34;재고 처리 중 오류: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>event</span><span class=p>.</span><span class=na>getOrderId</span><span class=p>(),</span><span class=w> </span><span class=n>e</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 재시도 로직 또는 오류 이벤트 발행</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 주문 조정 서비스 (오케스트레이터)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderOrchestratorService</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 다양한 이벤트 구독 후 주문 상태 업데이트</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@KafkaListener</span><span class=p>(</span><span class=n>topics</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;inventory&#34;</span><span class=p>,</span><span class=w> </span><span class=n>groupId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;order-orchestrator&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>handleInventoryEvent</span><span class=p>(</span><span class=n>InventoryEvent</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>event</span><span class=w> </span><span class=k>instanceof</span><span class=w> </span><span class=n>InventoryReservedEvent</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 결제 명령 발행</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>initiatePaymentProcess</span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getOrderId</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>event</span><span class=w> </span><span class=k>instanceof</span><span class=w> </span><span class=n>InventoryShortageEvent</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 주문 취소 이벤트 발행</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>sendOrderCancellationEvent</span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getOrderId</span><span class=p>(),</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=s>&#34;재고 부족: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>((</span><span class=n>InventoryShortageEvent</span><span class=p>)</span><span class=w> </span><span class=n>event</span><span class=p>).</span><span class=na>getUnavailableItems</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@KafkaListener</span><span class=p>(</span><span class=n>topics</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;payments&#34;</span><span class=p>,</span><span class=w> </span><span class=n>groupId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;order-orchestrator&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>handlePaymentEvent</span><span class=p>(</span><span class=n>PaymentEvent</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>event</span><span class=w> </span><span class=k>instanceof</span><span class=w> </span><span class=n>PaymentSucceededEvent</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 배송 명령 발행</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>initiateShippingProcess</span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getOrderId</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>event</span><span class=w> </span><span class=k>instanceof</span><span class=w> </span><span class=n>PaymentFailedEvent</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 주문 취소 및 재고 롤백</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>sendOrderCancellationEvent</span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getOrderId</span><span class=p>(),</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=s>&#34;결제 실패: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=p>((</span><span class=n>PaymentFailedEvent</span><span class=p>)</span><span class=w> </span><span class=n>event</span><span class=p>).</span><span class=na>getReason</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>rollbackInventory</span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getOrderId</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>내구성 및 재시도 메커니즘:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1> 1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2> 2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3> 3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4> 4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5> 5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6> 6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7> 7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8> 8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9> 9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10>10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11>11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12>12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13>13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14>14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15>15</a>
</span><span class=lnt id=hl-20-16><a class=lnlinks href=#hl-20-16>16</a>
</span><span class=lnt id=hl-20-17><a class=lnlinks href=#hl-20-17>17</a>
</span><span class=lnt id=hl-20-18><a class=lnlinks href=#hl-20-18>18</a>
</span><span class=lnt id=hl-20-19><a class=lnlinks href=#hl-20-19>19</a>
</span><span class=lnt id=hl-20-20><a class=lnlinks href=#hl-20-20>20</a>
</span><span class=lnt id=hl-20-21><a class=lnlinks href=#hl-20-21>21</a>
</span><span class=lnt id=hl-20-22><a class=lnlinks href=#hl-20-22>22</a>
</span><span class=lnt id=hl-20-23><a class=lnlinks href=#hl-20-23>23</a>
</span><span class=lnt id=hl-20-24><a class=lnlinks href=#hl-20-24>24</a>
</span><span class=lnt id=hl-20-25><a class=lnlinks href=#hl-20-25>25</a>
</span><span class=lnt id=hl-20-26><a class=lnlinks href=#hl-20-26>26</a>
</span><span class=lnt id=hl-20-27><a class=lnlinks href=#hl-20-27>27</a>
</span><span class=lnt id=hl-20-28><a class=lnlinks href=#hl-20-28>28</a>
</span><span class=lnt id=hl-20-29><a class=lnlinks href=#hl-20-29>29</a>
</span><span class=lnt id=hl-20-30><a class=lnlinks href=#hl-20-30>30</a>
</span><span class=lnt id=hl-20-31><a class=lnlinks href=#hl-20-31>31</a>
</span><span class=lnt id=hl-20-32><a class=lnlinks href=#hl-20-32>32</a>
</span><span class=lnt id=hl-20-33><a class=lnlinks href=#hl-20-33>33</a>
</span><span class=lnt id=hl-20-34><a class=lnlinks href=#hl-20-34>34</a>
</span><span class=lnt id=hl-20-35><a class=lnlinks href=#hl-20-35>35</a>
</span><span class=lnt id=hl-20-36><a class=lnlinks href=#hl-20-36>36</a>
</span><span class=lnt id=hl-20-37><a class=lnlinks href=#hl-20-37>37</a>
</span><span class=lnt id=hl-20-38><a class=lnlinks href=#hl-20-38>38</a>
</span><span class=lnt id=hl-20-39><a class=lnlinks href=#hl-20-39>39</a>
</span><span class=lnt id=hl-20-40><a class=lnlinks href=#hl-20-40>40</a>
</span><span class=lnt id=hl-20-41><a class=lnlinks href=#hl-20-41>41</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 멱등 소비자 설계</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>IdempotentConsumer</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>JdbcTemplate</span><span class=w> </span><span class=n>jdbcTemplate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>processOnce</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>eventId</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>consumerGroup</span><span class=p>,</span><span class=w> </span><span class=n>Consumer</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=n>processor</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 처리 이력 확인</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kt>boolean</span><span class=w> </span><span class=n>alreadyProcessed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>checkIfProcessed</span><span class=p>(</span><span class=n>eventId</span><span class=p>,</span><span class=w> </span><span class=n>consumerGroup</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>alreadyProcessed</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 이벤트 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>processor</span><span class=p>.</span><span class=na>accept</span><span class=p>(</span><span class=n>event</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 처리 이력 기록</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>markAsProcessed</span><span class=p>(</span><span class=n>eventId</span><span class=p>,</span><span class=w> </span><span class=n>consumerGroup</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>log</span><span class=p>.</span><span class=na>error</span><span class=p>(</span><span class=s>&#34;이벤트 처리 실패: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>eventId</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>throw</span><span class=w> </span><span class=n>e</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>log</span><span class=p>.</span><span class=na>info</span><span class=p>(</span><span class=s>&#34;이미 처리된 이벤트: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>eventId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=kc>false</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=nf>checkIfProcessed</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>eventId</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>consumerGroup</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Integer</span><span class=w> </span><span class=n>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>jdbcTemplate</span><span class=p>.</span><span class=na>queryForObject</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=s>&#34;SELECT COUNT(*) FROM processed_events WHERE event_id = ? AND consumer_group = ?&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Integer</span><span class=p>.</span><span class=na>class</span><span class=p>,</span><span class=w> </span><span class=n>eventId</span><span class=p>,</span><span class=w> </span><span class=n>consumerGroup</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>count</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>count</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>markAsProcessed</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>eventId</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>consumerGroup</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>jdbcTemplate</span><span class=p>.</span><span class=na>update</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=s>&#34;INSERT INTO processed_events (event_id, consumer_group, processed_at) VALUES (?, ?, ?)&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>eventId</span><span class=p>,</span><span class=w> </span><span class=n>consumerGroup</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Timestamp</span><span class=p>(</span><span class=n>System</span><span class=p>.</span><span class=na>currentTimeMillis</span><span class=p>()));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ol><h4 id=실시간-분석-및-대시보드-시스템>실시간 분석 및 대시보드 시스템<a hidden class=anchor aria-hidden=true href=#실시간-분석-및-대시보드-시스템>#</a></h4><p><strong>요구사항:</strong></p><ul><li>웹사이트 사용자 활동 실시간 분석</li><li>세션별 사용자 행동 추적</li><li>실시간 KPI 대시보드</li></ul><p><strong>해결책:</strong></p><ol><li><p><strong>데이터 파이프라인 설계:</strong></p><ul><li>원시 이벤트 수집 토픽: <code>user-activities</code></li><li>세션별 집계 토픽: <code>user-sessions</code></li><li>지표별 집계 토픽: <code>real-time-metrics</code></li></ul></li><li><p><strong>Kafka Streams 처리 로직:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span><span class=lnt id=hl-21-11><a class=lnlinks href=#hl-21-11>11</a>
</span><span class=lnt id=hl-21-12><a class=lnlinks href=#hl-21-12>12</a>
</span><span class=lnt id=hl-21-13><a class=lnlinks href=#hl-21-13>13</a>
</span><span class=lnt id=hl-21-14><a class=lnlinks href=#hl-21-14>14</a>
</span><span class=lnt id=hl-21-15><a class=lnlinks href=#hl-21-15>15</a>
</span><span class=lnt id=hl-21-16><a class=lnlinks href=#hl-21-16>16</a>
</span><span class=lnt id=hl-21-17><a class=lnlinks href=#hl-21-17>17</a>
</span><span class=lnt id=hl-21-18><a class=lnlinks href=#hl-21-18>18</a>
</span><span class=lnt id=hl-21-19><a class=lnlinks href=#hl-21-19>19</a>
</span><span class=lnt id=hl-21-20><a class=lnlinks href=#hl-21-20>20</a>
</span><span class=lnt id=hl-21-21><a class=lnlinks href=#hl-21-21>21</a>
</span><span class=lnt id=hl-21-22><a class=lnlinks href=#hl-21-22>22</a>
</span><span class=lnt id=hl-21-23><a class=lnlinks href=#hl-21-23>23</a>
</span><span class=lnt id=hl-21-24><a class=lnlinks href=#hl-21-24>24</a>
</span><span class=lnt id=hl-21-25><a class=lnlinks href=#hl-21-25>25</a>
</span><span class=lnt id=hl-21-26><a class=lnlinks href=#hl-21-26>26</a>
</span><span class=lnt id=hl-21-27><a class=lnlinks href=#hl-21-27>27</a>
</span><span class=lnt id=hl-21-28><a class=lnlinks href=#hl-21-28>28</a>
</span><span class=lnt id=hl-21-29><a class=lnlinks href=#hl-21-29>29</a>
</span><span class=lnt id=hl-21-30><a class=lnlinks href=#hl-21-30>30</a>
</span><span class=lnt id=hl-21-31><a class=lnlinks href=#hl-21-31>31</a>
</span><span class=lnt id=hl-21-32><a class=lnlinks href=#hl-21-32>32</a>
</span><span class=lnt id=hl-21-33><a class=lnlinks href=#hl-21-33>33</a>
</span><span class=lnt id=hl-21-34><a class=lnlinks href=#hl-21-34>34</a>
</span><span class=lnt id=hl-21-35><a class=lnlinks href=#hl-21-35>35</a>
</span><span class=lnt id=hl-21-36><a class=lnlinks href=#hl-21-36>36</a>
</span><span class=lnt id=hl-21-37><a class=lnlinks href=#hl-21-37>37</a>
</span><span class=lnt id=hl-21-38><a class=lnlinks href=#hl-21-38>38</a>
</span><span class=lnt id=hl-21-39><a class=lnlinks href=#hl-21-39>39</a>
</span><span class=lnt id=hl-21-40><a class=lnlinks href=#hl-21-40>40</a>
</span><span class=lnt id=hl-21-41><a class=lnlinks href=#hl-21-41>41</a>
</span><span class=lnt id=hl-21-42><a class=lnlinks href=#hl-21-42>42</a>
</span><span class=lnt id=hl-21-43><a class=lnlinks href=#hl-21-43>43</a>
</span><span class=lnt id=hl-21-44><a class=lnlinks href=#hl-21-44>44</a>
</span><span class=lnt id=hl-21-45><a class=lnlinks href=#hl-21-45>45</a>
</span><span class=lnt id=hl-21-46><a class=lnlinks href=#hl-21-46>46</a>
</span><span class=lnt id=hl-21-47><a class=lnlinks href=#hl-21-47>47</a>
</span><span class=lnt id=hl-21-48><a class=lnlinks href=#hl-21-48>48</a>
</span><span class=lnt id=hl-21-49><a class=lnlinks href=#hl-21-49>49</a>
</span><span class=lnt id=hl-21-50><a class=lnlinks href=#hl-21-50>50</a>
</span><span class=lnt id=hl-21-51><a class=lnlinks href=#hl-21-51>51</a>
</span><span class=lnt id=hl-21-52><a class=lnlinks href=#hl-21-52>52</a>
</span><span class=lnt id=hl-21-53><a class=lnlinks href=#hl-21-53>53</a>
</span><span class=lnt id=hl-21-54><a class=lnlinks href=#hl-21-54>54</a>
</span><span class=lnt id=hl-21-55><a class=lnlinks href=#hl-21-55>55</a>
</span><span class=lnt id=hl-21-56><a class=lnlinks href=#hl-21-56>56</a>
</span><span class=lnt id=hl-21-57><a class=lnlinks href=#hl-21-57>57</a>
</span><span class=lnt id=hl-21-58><a class=lnlinks href=#hl-21-58>58</a>
</span><span class=lnt id=hl-21-59><a class=lnlinks href=#hl-21-59>59</a>
</span><span class=lnt id=hl-21-60><a class=lnlinks href=#hl-21-60>60</a>
</span><span class=lnt id=hl-21-61><a class=lnlinks href=#hl-21-61>61</a>
</span><span class=lnt id=hl-21-62><a class=lnlinks href=#hl-21-62>62</a>
</span><span class=lnt id=hl-21-63><a class=lnlinks href=#hl-21-63>63</a>
</span><span class=lnt id=hl-21-64><a class=lnlinks href=#hl-21-64>64</a>
</span><span class=lnt id=hl-21-65><a class=lnlinks href=#hl-21-65>65</a>
</span><span class=lnt id=hl-21-66><a class=lnlinks href=#hl-21-66>66</a>
</span><span class=lnt id=hl-21-67><a class=lnlinks href=#hl-21-67>67</a>
</span><span class=lnt id=hl-21-68><a class=lnlinks href=#hl-21-68>68</a>
</span><span class=lnt id=hl-21-69><a class=lnlinks href=#hl-21-69>69</a>
</span><span class=lnt id=hl-21-70><a class=lnlinks href=#hl-21-70>70</a>
</span><span class=lnt id=hl-21-71><a class=lnlinks href=#hl-21-71>71</a>
</span><span class=lnt id=hl-21-72><a class=lnlinks href=#hl-21-72>72</a>
</span><span class=lnt id=hl-21-73><a class=lnlinks href=#hl-21-73>73</a>
</span><span class=lnt id=hl-21-74><a class=lnlinks href=#hl-21-74>74</a>
</span><span class=lnt id=hl-21-75><a class=lnlinks href=#hl-21-75>75</a>
</span><span class=lnt id=hl-21-76><a class=lnlinks href=#hl-21-76>76</a>
</span><span class=lnt id=hl-21-77><a class=lnlinks href=#hl-21-77>77</a>
</span><span class=lnt id=hl-21-78><a class=lnlinks href=#hl-21-78>78</a>
</span><span class=lnt id=hl-21-79><a class=lnlinks href=#hl-21-79>79</a>
</span><span class=lnt id=hl-21-80><a class=lnlinks href=#hl-21-80>80</a>
</span><span class=lnt id=hl-21-81><a class=lnlinks href=#hl-21-81>81</a>
</span><span class=lnt id=hl-21-82><a class=lnlinks href=#hl-21-82>82</a>
</span><span class=lnt id=hl-21-83><a class=lnlinks href=#hl-21-83>83</a>
</span><span class=lnt id=hl-21-84><a class=lnlinks href=#hl-21-84>84</a>
</span><span class=lnt id=hl-21-85><a class=lnlinks href=#hl-21-85>85</a>
</span><span class=lnt id=hl-21-86><a class=lnlinks href=#hl-21-86>86</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>UserActivityProcessor</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Properties</span><span class=w> </span><span class=n>props</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Properties</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>StreamsConfig</span><span class=p>.</span><span class=na>APPLICATION_ID_CONFIG</span><span class=p>,</span><span class=w> </span><span class=s>&#34;user-activity-processor&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>StreamsConfig</span><span class=p>.</span><span class=na>BOOTSTRAP_SERVERS_CONFIG</span><span class=p>,</span><span class=w> </span><span class=s>&#34;kafka:9092&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>StreamsConfig</span><span class=p>.</span><span class=na>DEFAULT_KEY_SERDE_CLASS_CONFIG</span><span class=p>,</span><span class=w> </span><span class=n>Serdes</span><span class=p>.</span><span class=na>String</span><span class=p>().</span><span class=na>getClass</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>StreamsConfig</span><span class=p>.</span><span class=na>DEFAULT_VALUE_SERDE_CLASS_CONFIG</span><span class=p>,</span><span class=w> </span><span class=n>Serdes</span><span class=p>.</span><span class=na>String</span><span class=p>().</span><span class=na>getClass</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>StreamsBuilder</span><span class=w> </span><span class=n>builder</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StreamsBuilder</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 활동 이벤트 스트림 생성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>KStream</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>activityEvents</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>builder</span><span class=p>.</span><span class=na>stream</span><span class=p>(</span><span class=s>&#34;user-activities&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 이벤트 유형별 분리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>KStream</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;[]</span><span class=w> </span><span class=n>branches</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>activityEvents</span><span class=p>.</span><span class=na>branch</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 페이지 조회 이벤트</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>(</span><span class=n>key</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>value</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=s>&#34;\&#34;type\&#34;:\&#34;page_view\&#34;&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 클릭 이벤트</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>(</span><span class=n>key</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>value</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=s>&#34;\&#34;type\&#34;:\&#34;click\&#34;&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 검색 이벤트</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>(</span><span class=n>key</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>value</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=s>&#34;\&#34;type\&#34;:\&#34;search\&#34;&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 기타 이벤트</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>(</span><span class=n>key</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 페이지뷰 집계</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>branches</span><span class=o>[</span><span class=n>0</span><span class=o>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>map</span><span class=p>((</span><span class=n>key</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>extractUserIdAndPage</span><span class=p>(</span><span class=n>value</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>groupByKey</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>windowedBy</span><span class=p>(</span><span class=n>TimeWindows</span><span class=p>.</span><span class=na>of</span><span class=p>(</span><span class=n>Duration</span><span class=p>.</span><span class=na>ofMinutes</span><span class=p>(</span><span class=n>1</span><span class=p>)))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>count</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>toStream</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>map</span><span class=p>((</span><span class=n>windowedKey</span><span class=p>,</span><span class=w> </span><span class=n>count</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>String</span><span class=w> </span><span class=n>metricKey</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;pageviews_&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>windowedKey</span><span class=p>.</span><span class=na>key</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;_&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>formatWindowTime</span><span class=p>(</span><span class=n>windowedKey</span><span class=p>.</span><span class=na>window</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=n>KeyValue</span><span class=p>.</span><span class=na>pair</span><span class=p>(</span><span class=n>metricKey</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=p>.</span><span class=na>valueOf</span><span class=p>(</span><span class=n>count</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>})</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>to</span><span class=p>(</span><span class=s>&#34;real-time-metrics&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 세션별 활동 집계</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>activityEvents</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>groupByKey</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>windowedBy</span><span class=p>(</span><span class=n>SessionWindows</span><span class=p>.</span><span class=na>with</span><span class=p>(</span><span class=n>Duration</span><span class=p>.</span><span class=na>ofMinutes</span><span class=p>(</span><span class=n>30</span><span class=p>)))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>aggregate</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 세션 초기값</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=s>&#34;[]&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 이벤트 추가 집계 함수</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>(</span><span class=n>sessionId</span><span class=p>,</span><span class=w> </span><span class=n>event</span><span class=p>,</span><span class=w> </span><span class=n>sessionEvents</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>appendEvent</span><span class=p>(</span><span class=n>sessionEvents</span><span class=p>,</span><span class=w> </span><span class=n>event</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 세션 병합 함수 (대부분의 경우 사용되지 않음)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>(</span><span class=n>key</span><span class=p>,</span><span class=w> </span><span class=n>session1</span><span class=p>,</span><span class=w> </span><span class=n>session2</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>mergeSessionEvents</span><span class=p>(</span><span class=n>session1</span><span class=p>,</span><span class=w> </span><span class=n>session2</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 세션 이벤트 저장에 JSON Serde 사용</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Materialized</span><span class=p>.</span><span class=na>with</span><span class=p>(</span><span class=n>Serdes</span><span class=p>.</span><span class=na>String</span><span class=p>(),</span><span class=w> </span><span class=n>Serdes</span><span class=p>.</span><span class=na>String</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>toStream</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>map</span><span class=p>((</span><span class=n>windowedKey</span><span class=p>,</span><span class=w> </span><span class=n>events</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>String</span><span class=w> </span><span class=n>sessionKey</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>windowedKey</span><span class=p>.</span><span class=na>key</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;_&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>formatWindowTime</span><span class=p>(</span><span class=n>windowedKey</span><span class=p>.</span><span class=na>window</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=n>KeyValue</span><span class=p>.</span><span class=na>pair</span><span class=p>(</span><span class=n>sessionKey</span><span class=p>,</span><span class=w> </span><span class=n>events</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>})</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>to</span><span class=p>(</span><span class=s>&#34;user-sessions&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 실시간 전환율 계산</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>KStream</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Double</span><span class=o>&gt;</span><span class=w> </span><span class=n>conversionRates</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>activityEvents</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>groupByKey</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>windowedBy</span><span class=p>(</span><span class=n>TimeWindows</span><span class=p>.</span><span class=na>of</span><span class=p>(</span><span class=n>Duration</span><span class=p>.</span><span class=na>ofMinutes</span><span class=p>(</span><span class=n>5</span><span class=p>)))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>aggregate</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>PageConversionTracker</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>(</span><span class=n>key</span><span class=p>,</span><span class=w> </span><span class=n>event</span><span class=p>,</span><span class=w> </span><span class=n>tracker</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>tracker</span><span class=p>.</span><span class=na>trackEvent</span><span class=p>(</span><span class=n>event</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Materialized</span><span class=p>.</span><span class=na>with</span><span class=p>(</span><span class=n>Serdes</span><span class=p>.</span><span class=na>String</span><span class=p>(),</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>JsonSerde</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>PageConversionTracker</span><span class=p>.</span><span class=na>class</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>toStream</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>map</span><span class=p>((</span><span class=n>windowedKey</span><span class=p>,</span><span class=w> </span><span class=n>tracker</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>String</span><span class=w> </span><span class=n>metricKey</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;conversion_rate_&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>formatWindowTime</span><span class=p>(</span><span class=n>windowedKey</span><span class=p>.</span><span class=na>window</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=n>KeyValue</span><span class=p>.</span><span class=na>pair</span><span class=p>(</span><span class=n>metricKey</span><span class=p>,</span><span class=w> </span><span class=n>tracker</span><span class=p>.</span><span class=na>calculateConversionRate</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>conversionRates</span><span class=p>.</span><span class=na>to</span><span class=p>(</span><span class=s>&#34;real-time-metrics&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Produced</span><span class=p>.</span><span class=na>with</span><span class=p>(</span><span class=n>Serdes</span><span class=p>.</span><span class=na>String</span><span class=p>(),</span><span class=w> </span><span class=n>Serdes</span><span class=p>.</span><span class=na>Double</span><span class=p>()));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 토폴로지 생성 및 스트림 시작</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>KafkaStreams</span><span class=w> </span><span class=n>streams</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>KafkaStreams</span><span class=p>(</span><span class=n>builder</span><span class=p>.</span><span class=na>build</span><span class=p>(),</span><span class=w> </span><span class=n>props</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>streams</span><span class=p>.</span><span class=na>start</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 종료 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Runtime</span><span class=p>.</span><span class=na>getRuntime</span><span class=p>().</span><span class=na>addShutdownHook</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>Thread</span><span class=p>(</span><span class=n>streams</span><span class=p>::</span><span class=n>close</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 헬퍼 메소드들 (JSON 파싱, 키 추출, 세션 병합 등)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Elasticsearch 로 집계 데이터 전송:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1> 1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2> 2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3> 3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4> 4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5> 5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6> 6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7> 7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8> 8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9> 9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10>10</a>
</span><span class=lnt id=hl-22-11><a class=lnlinks href=#hl-22-11>11</a>
</span><span class=lnt id=hl-22-12><a class=lnlinks href=#hl-22-12>12</a>
</span><span class=lnt id=hl-22-13><a class=lnlinks href=#hl-22-13>13</a>
</span><span class=lnt id=hl-22-14><a class=lnlinks href=#hl-22-14>14</a>
</span><span class=lnt id=hl-22-15><a class=lnlinks href=#hl-22-15>15</a>
</span><span class=lnt id=hl-22-16><a class=lnlinks href=#hl-22-16>16</a>
</span><span class=lnt id=hl-22-17><a class=lnlinks href=#hl-22-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Kafka Connect Elasticsearch 싱크 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s>&#34;name&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;metrics-elasticsearch-sink&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=s>&#34;config&#34;</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;connector.class&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;io.confluent.connect.elasticsearch.ElasticsearchSinkConnector&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;tasks.max&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;1&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;topics&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;real-time-metrics&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;connection.url&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;http://elasticsearch:9200&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;key.converter&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;org.apache.kafka.connect.storage.StringConverter&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;value.converter&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;org.apache.kafka.connect.json.JsonConverter&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;value.converter.schemas.enable&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;false&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;key.ignore&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;false&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;schema.ignore&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;true&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;type.name&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;metrics&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#34;behavior.on.null.values&#34;</span><span class=p>:</span><span class=w> </span><span class=s>&#34;delete&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Grafana 대시보드 구현:</strong></p><ul><li>Elasticsearch 데이터 소스 추가</li><li>실시간 업데이트 대시보드 구성</li><li>시각화 패널:<ul><li>페이지뷰 트렌드</li><li>전환율 게이지</li><li>활성 사용자 수</li><li>세션 지속 시간 분포</li></ul></li></ul></li></ol><h3 id=이벤트-브로커-선택-가이드>이벤트 브로커 선택 가이드<a hidden class=anchor aria-hidden=true href=#이벤트-브로커-선택-가이드>#</a></h3><p>최적의 이벤트 브로커 선택은 다음 요소에 따라 달라진다:</p><ol><li><strong>데이터 양과 처리량 요구사항</strong><ul><li>대용량 처리: Kafka, Pulsar</li><li>중소규모: RabbitMQ, NATS</li></ul></li><li><strong>지연 시간 요구사항</strong><ul><li>초저지연: NATS</li><li>일반 메시징: RabbitMQ</li><li>대량 처리 중심: Kafka</li></ul></li><li><strong>기능 요구사항</strong><ul><li>복잡한 라우팅: RabbitMQ</li><li>장기 데이터 보존: Kafka, Pulsar</li><li>멀티테넌시: Pulsar</li></ul></li><li><strong>운영 환경</strong><ul><li>클라우드 네이티브: 관리형 서비스 (AWS MSK, Google Pub/Sub)</li><li>온프레미스: Kafka, RabbitMQ</li><li>하이브리드: Pulsar</li></ul></li></ol><h3 id=아키텍처-진화-방향>아키텍처 진화 방향<a hidden class=anchor aria-hidden=true href=#아키텍처-진화-방향>#</a></h3><ol><li><strong>메시 아키텍처로의 전환</strong><ul><li>중앙집중식에서 분산형 이벤트 메시로 발전</li><li>도메인별 브로커 분리 및 연동</li></ul></li><li><strong>서버리스 이벤트 처리의 부상</strong><ul><li>인프라 관리 부담 감소</li><li>이벤트 기반 함수 실행 모델 확산</li></ul></li><li><strong>빅데이터 및 AI 와의 통합</strong><ul><li>실시간 스트림 처리와 AI 모델 결합</li><li>지능형 이벤트 라우팅 및 분석</li></ul></li></ol><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><h3 id=1-주제의-분류-적절성>1. 주제의 분류 적절성<a hidden class=anchor aria-hidden=true href=#1-주제의-분류-적절성>#</a></h3><p>&ldquo;Event Brokers&rdquo;(이벤트 브로커) 는 &ldquo;Computer Science and Engineering > Backend Development > Event and Message Brokers > Fundamentals&rdquo; 분류에 매우 적합합니다. 이벤트 브로커는 이벤트 기반 아키텍처 (EDA, Event-Driven Architecture) 의 핵심 인프라로, 백엔드 시스템의 확장성, 비동기성, 실시간성, 유연성을 실현하는 데 필수적인 미들웨어입니다 [4][14][6].</p><hr><h3 id=2-200-자-요약>2. 200 자 요약<a hidden class=anchor aria-hidden=true href=#2-200-자-요약>#</a></h3><p>이벤트 브로커는 이벤트 발행자와 구독자 간의 메시지 교환을 중개하는 미들웨어로, 비동기 통신, 실시간 데이터 분배, 서비스 간 결합도 감소, 확장성 및 장애 복원력을 제공합니다. Pub/Sub, 스트리밍, 다양한 QoS(서비스 품질) 와 같은 고급 기능을 지원하며, 현대 백엔드 아키텍처의 핵심 역할을 담당합니다 [4][14][16].</p><hr><h3 id=3-전체-개요-250-자-내외>3. 전체 개요 (250 자 내외)<a hidden class=anchor aria-hidden=true href=#3-전체-개요-250-자-내외>#</a></h3><p>이벤트 브로커는 이벤트 기반 아키텍처에서 이벤트 발행자 (Producer) 와 구독자 (Consumer) 사이의 이벤트 메시지 흐름을 중개하는 미들웨어입니다. 이벤트 브로커는 Pub/Sub, 스트리밍, 다양한 QoS, 보안, 트랜잭션, 확장성, 장애 복구 등 다양한 기능을 제공하며, 시스템 간 결합도를 낮추고, 실시간 데이터 분배와 비동기 처리를 지원합니다. 대표 솔루션으로는 Solace, Kafka, AWS EventBridge, Azure Event Grid 등이 있으며, 다양한 산업에서 실시간 분석, 알림, IoT, 마이크로서비스 통합 등 광범위하게 활용됩니다 [4][14][6][16].</p><hr><h2 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h2><ul><li><strong>이벤트 브로커 (Event Broker)</strong>: 이벤트 발행자와 구독자 사이에서 이벤트 메시지를 중개하는 미들웨어. 이벤트의 저장, 라우팅, 필터링, 전달, 보안, 품질 보장 (QoS) 등 다양한 역할을 수행 [4][14][16].</li><li><strong>Pub/Sub(발행 - 구독)</strong>: 이벤트를 특정 주제 (Topic) 에 발행하면, 해당 주제를 구독한 모든 소비자가 이벤트를 수신하는 방식 [2][3][4].</li><li><strong>토픽 (Topic)</strong>: 이벤트 메시지를 분류하고 라우팅하는 논리적 채널. 계층적 구조와 와일드카드 구독 등 다양한 방식 지원 [2][3].</li><li><strong>QoS(서비스 품질)</strong>: 이벤트 전달 보장 수준 (Exactly once, At least once, At most once 등)[6][14].</li><li><strong>비동기 통신</strong>: 발행자와 구독자가 직접 연결되지 않고, 이벤트 브로커를 통해 비동기적으로 통신 [4][5][14].</li></ul><hr><h2 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h2><ul><li>서비스 간 결합도 감소 및 유연성 확보</li><li>실시간 데이터 분배 및 비동기 처리</li><li>장애 복원력, 확장성, 신뢰성 강화</li><li>다양한 시스템 및 프로토콜 간 통합 지원</li><li>고가용성 및 분산 환경 지원 [4][5][14][16].</li></ul><hr><h2 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h2><ul><li>이벤트 저장, 라우팅, 필터링, 전달</li><li>Pub/Sub, 스트리밍, 요청 - 응답 등 다양한 메시징 패턴 지원</li><li>QoS, 트랜잭션, 이벤트 순서 보장, 중복 방지</li><li>인증, 권한, 암호화 등 보안 기능</li><li>모니터링, 장애 복구, 확장성 관리 [6][14][16][11].</li></ul><hr><h2 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h2><ul><li>느슨한 결합 (Loose Coupling), 비동기성, 실시간성, 확장성</li><li>다양한 배포 형태 (온프레미스, 클라우드, SaaS)</li><li>다양한 프로토콜 및 클라이언트 지원</li><li>이벤트 저장 및 재전송, 이벤트 소싱 지원</li><li>고가용성, 장애 복원력, 분산 처리 [4][14][16].</li></ul><hr><h2 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h2><ul><li>발행자와 구독자 간의 완전한 분리 (Decoupling)</li><li>신뢰성 있는 이벤트 전달 (중복 방지, 순서 보장)</li><li>확장성, 장애 복원력, 보안, 유연성</li><li>표준화된 메시징 패턴 및 프로토콜 준수 [4][14][16].</li></ul><hr><h2 id=주요-원리-및-작동-원리>주요 원리 및 작동 원리<a hidden class=anchor aria-hidden=true href=#주요-원리-및-작동-원리>#</a></h2><ol><li>**이벤트 발행자 (Producer)**가 이벤트를 브로커에 발행</li><li>**이벤트 브로커 (Event Broker)**가 이벤트를 저장, 라우팅, 필터링</li><li>**이벤트 구독자 (Consumer)**가 구독한 토픽의 이벤트를 수신</li><li>브로커는 QoS, 보안, 장애 복구 등 다양한 내부 로직을 적용</li></ol><h3 id=작동-원리-다이어그램>작동 원리 다이어그램<a hidden class=anchor aria-hidden=true href=#작동-원리-다이어그램>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[Producer] --(Event)--&gt; [Event Broker (Topic/Channel)] --(Event)--&gt; [Consumer]
</span></span></code></pre></td></tr></table></div></div><ul><li>Pub/Sub, 스트리밍, QoS, 이벤트 저장 등 다양한 기능 내장</li></ul><hr><h2 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h2><h3 id=필수-구성요소>필수 구성요소<a hidden class=anchor aria-hidden=true href=#필수-구성요소>#</a></h3><table><thead><tr><th>구성 요소</th><th>기능 및 역할</th></tr></thead><tbody><tr><td>Producer(발행자)</td><td>이벤트 생성 및 브로커에 발행</td></tr><tr><td>Event Broker(브로커)</td><td>이벤트 저장, 라우팅, 필터링, 전달, 보안, QoS</td></tr><tr><td>Consumer(구독자)</td><td>구독한 토픽의 이벤트 수신 및 처리</td></tr><tr><td>Topic/Channel</td><td>이벤트 분류, 라우팅, 구독 관리</td></tr></tbody></table><h3 id=선택-구성요소>선택 구성요소<a hidden class=anchor aria-hidden=true href=#선택-구성요소>#</a></h3><table><thead><tr><th>구성 요소</th><th>기능 및 역할</th></tr></thead><tbody><tr><td>Event Store</td><td>이벤트 영속 저장, 이벤트 소싱, 감사, 재처리 지원</td></tr><tr><td>Schema Registry</td><td>이벤트 메시지 구조 관리 및 호환성 보장</td></tr><tr><td>모니터링/관리 도구</td><td>성능, 장애, 트래픽 모니터링 및 관리</td></tr><tr><td>Event Router</td><td>라우팅 규칙 기반 이벤트 분배</td></tr></tbody></table><h4 id=구조-다이어그램-예시>구조 다이어그램 예시<a hidden class=anchor aria-hidden=true href=#구조-다이어그램-예시>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1>1</a>
</span><span class=lnt id=hl-24-2><a class=lnlinks href=#hl-24-2>2</a>
</span><span class=lnt id=hl-24-3><a class=lnlinks href=#hl-24-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[Producer] → [Event Broker (Topic/Channel)] → [Consumer]
</span></span><span class=line><span class=cl>         ↘︎         ↑
</span></span><span class=line><span class=cl>      [Schema Registry/Event Store] (선택)
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h2><table><thead><tr><th>구현 기법</th><th>정의/구성</th><th>목적</th><th>실제 예시 (시스템/시나리오)</th></tr></thead><tbody><tr><td>Pub/Sub</td><td>토픽 기반 1:N 이벤트 분배</td><td>실시간 데이터 분배, 확장성</td><td>Kafka, Solace, AWS EventBridge</td></tr><tr><td>스트리밍</td><td>실시간 데이터 스트림 처리</td><td>대용량 실시간 처리</td><td>Kafka, Pulsar</td></tr><tr><td>이벤트 소싱</td><td>이벤트 로그 기반 상태 관리</td><td>데이터 추적, 복구</td><td>Kafka, EventStoreDB</td></tr><tr><td>QoS 조정</td><td>이벤트 전달 보장 수준 설정</td><td>신뢰성, 중복 방지</td><td>Exactly once, At least once, At most once</td></tr></tbody></table><hr><h2 id=장점과-단점>장점과 단점<a hidden class=anchor aria-hidden=true href=#장점과-단점>#</a></h2><table><thead><tr><th>구분</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>✅ 장점</td><td>결합도 감소</td><td>발행자 - 구독자 완전 분리, 유연한 확장</td></tr><tr><td></td><td>신뢰성</td><td>QoS, 장애 복구, 이벤트 저장</td></tr><tr><td></td><td>실시간성</td><td>실시간 데이터 분배, 스트리밍</td></tr><tr><td></td><td>확장성</td><td>대용량 트래픽, 수평 확장 용이</td></tr><tr><td></td><td>다양한 패턴</td><td>Pub/Sub, 스트리밍, 이벤트 소싱 등 지원</td></tr><tr><td>⚠ 단점</td><td>복잡성</td><td>운영, 모니터링, 장애 분석 난이도</td></tr><tr><td></td><td>지연</td><td>브로커 장애, 네트워크 이슈 시 지연 가능</td></tr><tr><td></td><td>일관성</td><td>Eventually Consistent, 즉각적 일관성 어려움</td></tr><tr><td></td><td>운영 비용</td><td>인프라, 관리, 보안 등 추가 리소스 필요</td></tr></tbody></table><hr><h2 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h2><ul><li>이벤트 순서 보장, 중복 방지, 트랜잭션 처리</li><li>장애 복구, 데이터 유실 방지, 확장성 관리</li><li>운영 복잡성, 실시간 모니터링 및 장애 탐지</li><li>스키마/버전 관리, 보안 강화 [14][16][11].</li></ul><hr><h2 id=분류에-따른-종류-및-유형>분류에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류에-따른-종류-및-유형>#</a></h2><table><thead><tr><th>분류 기준</th><th>종류/유형</th><th>설명</th></tr></thead><tbody><tr><td>메시징 패턴</td><td>Pub/Sub, 스트리밍, 이벤트 소싱</td><td>이벤트 전달 방식에 따른 분류</td></tr><tr><td>아키텍처</td><td>토픽 기반, 로그 기반, 큐 기반</td><td>내부 저장/분배 구조</td></tr><tr><td>배포 형태</td><td>온프레미스, 클라우드, SaaS</td><td>배포 및 운영 방식</td></tr><tr><td>QoS</td><td>Exactly once, At least once, At most once</td><td>이벤트 전달 보장 수준</td></tr><tr><td>대표 제품</td><td>Solace, Kafka, AWS EventBridge, Azure Event Grid, IBM MQ 등</td><td>주요 상용/오픈소스 솔루션</td></tr></tbody></table><hr><h2 id=실무-적용-예시>실무 적용 예시<a hidden class=anchor aria-hidden=true href=#실무-적용-예시>#</a></h2><table><thead><tr><th>적용 분야</th><th>적용 예시</th><th>설명</th></tr></thead><tbody><tr><td>실시간 분석</td><td>Kafka</td><td>대용량 실시간 로그 스트림 분배</td></tr><tr><td>알림 서비스</td><td>Solace</td><td>다양한 채널로 이벤트 분배</td></tr><tr><td>IoT</td><td>MQTT, Solace</td><td>센서 데이터 실시간 수집/분배</td></tr><tr><td>데이터 파이프라인</td><td>AWS EventBridge</td><td>데이터 이동 및 ETL 자동화</td></tr><tr><td>마이크로서비스 통합</td><td>Azure Event Grid</td><td>서비스 간 이벤트 기반 통합</td></tr></tbody></table><hr><h2 id=활용-사례-시나리오>활용 사례 (시나리오)<a hidden class=anchor aria-hidden=true href=#활용-사례-시나리오>#</a></h2><h3 id=시나리오-글로벌-이커머스-실시간-주문알림-시스템>시나리오: 글로벌 이커머스 실시간 주문/알림 시스템<a hidden class=anchor aria-hidden=true href=#시나리오-글로벌-이커머스-실시간-주문알림-시스템>#</a></h3><p><strong>시스템 구성</strong></p><ul><li>주문 서비스 (Producer) → Kafka(이벤트 브로커, Topic: order-events) → 결제/알림/배송 서비스 (Consumer)</li><li>알림 서비스 → Solace(이벤트 브로커, Topic: notification) → 이메일/SMS/푸시 서버</li></ul><p><strong>시스템 다이어그램</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1>1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[주문 서비스] --(order 이벤트)--&gt; [Kafka Topic] --(구독)--&gt; [결제/알림/배송 서비스]
</span></span><span class=line><span class=cl>[알림 서비스] --(알림 이벤트)--&gt; [Solace Topic] --(구독)--&gt; [이메일/SMS/푸시 서버]
</span></span></code></pre></td></tr></table></div></div><p><strong>Workflow</strong></p><ol><li>주문 발생 시 order 이벤트를 Kafka 에 발행</li><li>결제, 알림, 배송 서비스가 각자 필요한 이벤트만 구독</li><li>알림 서비스는 Solace 를 통해 다양한 채널로 이벤트 분배</li><li>장애 발생 시 브로커가 이벤트 임시 저장, 재시도</li></ol><p><strong>담당 역할</strong></p><ul><li>Kafka: 대용량 이벤트 스트림, Pub/Sub, 실시간 처리</li><li>Solace: 다양한 채널, QoS, 이벤트 분배</li></ul><hr><h2 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h2><table><thead><tr><th>항목</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>메시지 패턴</td><td>Pub/Sub 등 요구에 맞는 패턴 선택</td><td>시스템 요구사항 분석 후 설계</td></tr><tr><td>확장성</td><td>트래픽 증가 대비 수평 확장성 확보</td><td>클러스터링, 파티셔닝 적용</td></tr><tr><td>장애 복구</td><td>데이터 유실 방지, 장애 격리</td><td>복제, 백업, 장애 복구 시나리오 구축</td></tr><tr><td>모니터링</td><td>성능, 지연, 장애 실시간 모니터링</td><td>APM, 대시보드, 알림 설정</td></tr><tr><td>보안</td><td>인증, 암호화, 접근 제어</td><td>TLS, ACL, 권한 분리 적용</td></tr><tr><td>스키마 관리</td><td>이벤트 구조 일관성 유지</td><td>Schema Registry, 버전 관리 도입</td></tr></tbody></table><hr><h2 id=최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점>#</a></h2><table><thead><tr><th>항목</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>이벤트 크기</td><td>이벤트 최소화, 불필요 데이터 제거</td><td>10MB 이하, 경량 포맷 사용</td></tr><tr><td>브로커 설정</td><td>최적화된 토픽/파티션 구성</td><td>테스트 기반 튜닝, 병렬 처리</td></tr><tr><td>네트워크</td><td>대역폭, 지연 최소화</td><td>전용 네트워크, 로컬 배치</td></tr><tr><td>리소스 할당</td><td>CPU/메모리/디스크 충분히 확보</td><td>오토스케일링, 모니터링</td></tr><tr><td>오류 처리</td><td>재시도, 백오프, DLQ 적용</td><td>자동화된 오류 처리 로직 구현</td></tr><tr><td>캐싱/비동기</td><td>병렬/비동기 처리로 처리량 증대</td><td>캐시, 비동기 API 활용</td></tr></tbody></table><hr><h2 id=2025-년-기준-최신-동향>2025 년 기준 최신 동향<a hidden class=anchor aria-hidden=true href=#2025-년-기준-최신-동향>#</a></h2><table><thead><tr><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>클라우드 네이티브</td><td>매니지드 브로커 서비스</td><td>Kafka, Solace 등 클라우드 통합, 자동 확장</td></tr><tr><td>AI/ML</td><td>AI 기반 트래픽 예측, 자동 튜닝</td><td>AI 가 이벤트 패턴 분석, 리소스 자동 할당</td></tr><tr><td>IoT</td><td>초경량 브로커, MQTT 확산</td><td>IoT 데이터 실시간 수집/분배</td></tr><tr><td>보안</td><td>고급 암호화, 인증 강화</td><td>TLS, OAuth 등 보안 강화 추세</td></tr><tr><td>이벤트 메시시</td><td>글로벌 이벤트 메시시</td><td>멀티 브로커 연결, 글로벌 분산 이벤트 처리</td></tr></tbody></table><hr><h2 id=주제와-관련하여-주목할-내용>주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#주제와-관련하여-주목할-내용>#</a></h2><table><thead><tr><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>메시징 패턴</td><td>Pub/Sub, 스트리밍, 이벤트 소싱</td><td>다양한 패턴 조합으로 유연한 통신</td></tr><tr><td>스키마 관리</td><td>Schema Registry</td><td>이벤트 구조 일관성, 호환성 보장</td></tr><tr><td>장애 복구</td><td>복제, 파티셔닝</td><td>데이터 유실 방지, 고가용성</td></tr><tr><td>실시간성</td><td>스트리밍, 이벤트 소싱</td><td>대용량 실시간 데이터 처리</td></tr><tr><td>운영 자동화</td><td>오토스케일링, AI 기반 튜닝</td><td>운영 효율성 및 장애 대응 강화</td></tr></tbody></table><hr><h2 id=앞으로의-전망>앞으로의 전망<a hidden class=anchor aria-hidden=true href=#앞으로의-전망>#</a></h2><table><thead><tr><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>시장 성장</td><td>이벤트 브로커 시장</td><td>연평균 20% 이상 성장, IoT/클라우드 영향</td></tr><tr><td>AI 통합</td><td>AI/ML 기반 브로커</td><td>예측, 자동화, 장애 탐지 강화</td></tr><tr><td>IoT 확장</td><td>초경량 브로커</td><td>엣지/IoT 환경에 최적화</td></tr><tr><td>이벤트 메시시</td><td>글로벌 메시시</td><td>멀티 브로커, 글로벌 분산 트래픽</td></tr><tr><td>보안</td><td>고급 보안 기능</td><td>데이터 보호, 규제 대응 강화</td></tr></tbody></table><hr><h2 id=하위-주제-및-추가-학습-필요-내용>하위 주제 및 추가 학습 필요 내용<a hidden class=anchor aria-hidden=true href=#하위-주제-및-추가-학습-필요-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>설명</th></tr></thead><tbody><tr><td>메시징 패턴</td><td>Pub/Sub, 스트리밍, 이벤트 소싱</td><td>각 패턴별 특징, 적용법</td></tr><tr><td>브로커 비교</td><td>Kafka, Solace, EventBridge 등</td><td>주요 브로커별 장단점, 아키텍처</td></tr><tr><td>스키마 관리</td><td>Schema Registry</td><td>이벤트 구조 관리, 버전 호환성</td></tr><tr><td>장애 복구</td><td>복제, 파티셔닝, DLQ</td><td>고가용성, 장애/오류 처리</td></tr><tr><td>보안</td><td>인증, 암호화, 접근제어</td><td>보안 설계 및 운영 가이드</td></tr></tbody></table><hr><table><thead><tr><th>카테고리</th><th>주제</th><th>설명</th></tr></thead><tbody><tr><td>아키텍처</td><td>이벤트 메시시, 글로벌 분산</td><td>멀티 브로커, 이벤트 메시시 구조</td></tr><tr><td>운영</td><td>모니터링, 오토스케일링</td><td>실시간 성능/장애 관리</td></tr><tr><td>성능</td><td>튜닝, 최적화</td><td>브로커별 성능 최적화 방법</td></tr><tr><td>클라우드</td><td>매니지드 서비스</td><td>클라우드 기반 브로커 활용법</td></tr><tr><td>개발</td><td>API, SDK 활용</td><td>다양한 언어/플랫폼 연동법</td></tr></tbody></table><hr><h2 id=용어-정리-1>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-1>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>Pub/Sub</td><td>발행 - 구독 패턴, 이벤트를 여러 구독자에게 분배하는 구조</td></tr><tr><td>Topic</td><td>이벤트 메시지 분류 및 라우팅 논리적 채널</td></tr><tr><td>QoS</td><td>이벤트 전달 보장 수준 (Exactly once, At least once, At most once)</td></tr><tr><td>Event Mesh</td><td>복수 브로커를 연결한 글로벌 분산 구조</td></tr><tr><td>Schema Registry</td><td>이벤트 메시지 구조 (스키마) 관리 시스템</td></tr><tr><td>DLQ(Dead Letter Queue)</td><td>처리 실패 이벤트 임시 저장 큐</td></tr><tr><td>오토스케일링</td><td>자동 리소스 확장/축소 기능</td></tr></tbody></table><hr><h2 id=참고-및-출처-1>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-1>#</a></h2><ul><li><a href=https://solace.com/what-is-an-event-broker/>Solace Event Broker 개념 및 기능</a></li><li><a href=https://docs.solace.com/Get-Started/what-are-event-brokers.htm>Solace Docs - What Are Event Brokers?</a></li><li><a href=https://solace.com/resources/solace-event-driven-architecture-resources/gartner-market-guide-for-event-brokers>Gartner Event Broker 시장 가이드</a></li><li><a href=https://www.pubnub.com/guides/event-driven-architecture/>PubNub Event Broker 설명</a></li><li><a href=https://learn.microsoft.com/en-us/azure/architecture/example-scenario/integration/queues-events>Azure Event Broker 아키텍처 예시</a></li><li><a href=https://estuary.dev/blog/event-driven-architecture-examples/>EDA 실무 적용 사례</a></li><li><a href=https://www.site24x7.com/blog/troubleshooting-latency-issues-in-event-driven-architectures>EDA 성능 최적화 및 브로커 튜닝</a></li><li><a href=https://solace.com/blog/gartner-how-to-choose-an-event-broker/>Gartner Event Broker 비교 및 선택 가이드</a></li></ul><p>Citations:<br>[1] <a href=https://talent500.com/blog/how-to-implement-event-driven-architecture-for-complex-backend-systems/>https://talent500.com/blog/how-to-implement-event-driven-architecture-for-complex-backend-systems/</a><br>[2] <a href=https://www.linkedin.com/pulse/eda-fundamentals-sap-advanced-event-mesh-mahesh-dash-mrpge>https://www.linkedin.com/pulse/eda-fundamentals-sap-advanced-event-mesh-mahesh-dash-mrpge</a><br>[3] <a href=https://docs.solace.com/Cloud/Event-Portal/event-portal-topic-addresses.htm>https://docs.solace.com/Cloud/Event-Portal/event-portal-topic-addresses.htm</a><br>[4] <a href=https://docs.solace.com/Get-Started/what-are-event-brokers.htm>https://docs.solace.com/Get-Started/what-are-event-brokers.htm</a><br>[5] <a href=https://solace.com/blog/why-developers-pubsub-plus-event-driven-architecture/>https://solace.com/blog/why-developers-pubsub-plus-event-driven-architecture/</a><br>[6] <a href=https://www.gartner.com/reviews/market/event-brokers>https://www.gartner.com/reviews/market/event-brokers</a><br>[7] <a href=https://estuary.dev/blog/event-driven-architecture-examples/>https://estuary.dev/blog/event-driven-architecture-examples/</a><br>[8] <a href=https://learn.microsoft.com/en-us/azure/architecture/example-scenario/integration/queues-events>https://learn.microsoft.com/en-us/azure/architecture/example-scenario/integration/queues-events</a><br>[9] <a href=https://tyk.io/learning-center/event-driven-architecture-best-practices/>https://tyk.io/learning-center/event-driven-architecture-best-practices/</a><br>[10] <a href=https://www.site24x7.com/blog/troubleshooting-latency-issues-in-event-driven-architectures>https://www.site24x7.com/blog/troubleshooting-latency-issues-in-event-driven-architectures</a><br>[11] <a href=https://solace.com/blog/gartner-how-to-choose-an-event-broker/>https://solace.com/blog/gartner-how-to-choose-an-event-broker/</a><br>[12] <a href=https://cerexio.com/axon-real-time-event-broker-platform>https://cerexio.com/axon-real-time-event-broker-platform</a><br>[13] <a href=https://www.cognitivemarketresearch.com/e-brokerage-market-report>https://www.cognitivemarketresearch.com/e-brokerage-market-report</a><br>[14] <a href=https://solace.com/what-is-an-event-broker/>https://solace.com/what-is-an-event-broker/</a><br>[15] <a href=https://solace.com/resources/solace-event-driven-architecture-resources/gartner-market-guide-for-event-brokers>https://solace.com/resources/solace-event-driven-architecture-resources/gartner-market-guide-for-event-brokers</a><br>[16] <a href=https://www.pubnub.com/guides/event-driven-architecture/>https://www.pubnub.com/guides/event-driven-architecture/</a><br>[17] <a href=https://dev.to/jhonifaber/introduction-to-event-driven-architecture-eda-3ioj>https://dev.to/jhonifaber/introduction-to-event-driven-architecture-eda-3ioj</a><br>[18] <a href=https://risingwave.com/blog/real-world-applications-of-event-driven-architecture-10-examples/>https://risingwave.com/blog/real-world-applications-of-event-driven-architecture-10-examples/</a><br>[19] <a href=https://aws.amazon.com/blogs/architecture/best-practices-for-implementing-event-driven-architectures-in-your-organization/>https://aws.amazon.com/blogs/architecture/best-practices-for-implementing-event-driven-architectures-in-your-organization/</a><br>[20] <a href=https://ibm.github.io/event-automation/es/installing/capacity-planning/>https://ibm.github.io/event-automation/es/installing/capacity-planning/</a><br>[21] <a href=https://solace.com/resources/pubsub-event-broker/why-pubsub-is-the-worlds-best-event-broker-2-video>https://solace.com/resources/pubsub-event-broker/why-pubsub-is-the-worlds-best-event-broker-2-video</a><br>[22] <a href=https://dev.to/hamzakhan/understanding-event-driven-architecture-a-guide-for-backend-developers-3bne>https://dev.to/hamzakhan/understanding-event-driven-architecture-a-guide-for-backend-developers-3bne</a><br>[23] <a href=https://help.pubsub.em.services.cloud.sap/Get-Started/what-are-event-brokers.htm>https://help.pubsub.em.services.cloud.sap/Get-Started/what-are-event-brokers.htm</a><br>[24] <a href=https://solace.com/blog/gartners-latest-advice-on-how-to-choose-an-event-broker/>https://solace.com/blog/gartners-latest-advice-on-how-to-choose-an-event-broker/</a><br>[25] <a href=https://www.nucamp.co/blog/coding-bootcamp-backend-with-python-2025-eventdriven-architectures-how-backend-systems-are-changing-in-2025>https://www.nucamp.co/blog/coding-bootcamp-backend-with-python-2025-eventdriven-architectures-how-backend-systems-are-changing-in-2025</a><br>[26] <a href=https://netmetic.wordpress.com/2020/07/17/gartners-advise-on-how-to-choose-an-event-broker-2/>https://netmetic.wordpress.com/2020/07/17/gartners-advise-on-how-to-choose-an-event-broker-2/</a><br>[27] <a href=https://en.wikipedia.org/wiki/Event-driven_architecture>https://en.wikipedia.org/wiki/Event-driven_architecture</a><br>[28] <a href=https://www.ibm.com/think/topics/message-brokers>https://www.ibm.com/think/topics/message-brokers</a><br>[29] <a href=https://developer.confluent.io/patterns/event-stream/event-broker/>https://developer.confluent.io/patterns/event-stream/event-broker/</a><br>[30] <a href=https://rasa.com/docs/rasa/next/event-brokers/>https://rasa.com/docs/rasa/next/event-brokers/</a><br>[31] <a href=https://solace.com/what-is-event-driven-architecture/>https://solace.com/what-is-event-driven-architecture/</a><br>[32] <a href=https://www.gartner.com/en/documents/4004081>https://www.gartner.com/en/documents/4004081</a><br>[33] <a href=https://slashdot.org/software/event-brokers/>https://slashdot.org/software/event-brokers/</a><br>[34] <a href=https://dzone.com/articles/top-5-considerations-when-selecting-an-event-broke>https://dzone.com/articles/top-5-considerations-when-selecting-an-event-broke</a><br>[35] <a href=https://insights.daffodilsw.com/blog/event-driven-architecture-explained-with-real-world-examples>https://insights.daffodilsw.com/blog/event-driven-architecture-explained-with-real-world-examples</a><br>[36] <a href=https://www.gartner.com/en/documents/5834147>https://www.gartner.com/en/documents/5834147</a><br>[37] <a href=https://help.pubsub.em.services.cloud.sap/Cloud/Deployment-Considerations/deployment-options-ownership.htm>https://help.pubsub.em.services.cloud.sap/Cloud/Deployment-Considerations/deployment-options-ownership.htm</a><br>[38] <a href=https://www.rtinsights.com/dont-be-let-down-by-the-middleman-ensure-your-event-broker-is-the-best-in-the-business-for-your-business/>https://www.rtinsights.com/dont-be-let-down-by-the-middleman-ensure-your-event-broker-is-the-best-in-the-business-for-your-business/</a><br>[39] <a href=https://www.wearemci.com/en/insights/10-game-changing-event-trends-for-associations-in-2025>https://www.wearemci.com/en/insights/10-game-changing-event-trends-for-associations-in-2025</a><br>[40] <a href=https://remo.co/blog/event-industry-statistics>https://remo.co/blog/event-industry-statistics</a><br>[41] <a href=https://hsmai.eu/2025/01/30/9-event-trends-that-will-shape-2025/>https://hsmai.eu/2025/01/30/9-event-trends-that-will-shape-2025/</a><br>[42] <a href=https://www.linkedin.com/pulse/b2b-event-trends-2025-insights-engaging-sustainable-anna-anisin-orxic>https://www.linkedin.com/pulse/b2b-event-trends-2025-insights-engaging-sustainable-anna-anisin-orxic</a><br>[43] <a href=https://www.encoreglobal.com/news-releases/2024-outlook-research-insights-driving-the-events-industry/>https://www.encoreglobal.com/news-releases/2024-outlook-research-insights-driving-the-events-industry/</a><br>[44] <a href=https://www.eventible.com/learning/event-trends/>https://www.eventible.com/learning/event-trends/</a><br>[45] <a href=https://docs.solace.com/Get-Started/tutorial/event-broker-basics.htm>https://docs.solace.com/Get-Started/tutorial/event-broker-basics.htm</a><br>[46] <a href=https://rasa.com/docs/rasa-pro/production/event-brokers/>https://rasa.com/docs/rasa-pro/production/event-brokers/</a><br>[47] <a href=https://tyk.io/learning-center/what-is-event-driven-architecture/>https://tyk.io/learning-center/what-is-event-driven-architecture/</a><br>[48] <a href=https://www.b2match.com/blog/how-to-organize-an-impactful-brokerage-event>https://www.b2match.com/blog/how-to-organize-an-impactful-brokerage-event</a><br>[49] <a href=https://docs.solace.com/Messaging/Topic-Architecture-Best-Practices.htm>https://docs.solace.com/Messaging/Topic-Architecture-Best-Practices.htm</a><br>[50] <a href=https://help.sap.com/docs/integration-suite/sap-integration-suite/f72428ff67db467ab1673e85a9b61927.html>https://help.sap.com/docs/integration-suite/sap-integration-suite/f72428ff67db467ab1673e85a9b61927.html</a></p><hr><p>Perplexity 로부터의 답변: pplx.ai/share
좋습니다. 다음은 <strong>“Event Brokers”</strong> 주제에 대한 체계적인 조사 및 정리입니다. 이 내용은 AWS, Confluent, Red Hat 등 공식 자료 기반으로 정리되었습니다.</p><hr><h3 id=-1-주제의-분류-적절성>✅ 1. 주제의 분류 적절성<a hidden class=anchor aria-hidden=true href=#-1-주제의-분류-적절성>#</a></h3><ul><li><p>분류: <strong>Computer Science and Engineering > Backend Development > Event and Message Brokers > Fundamentals</strong></p></li><li><p>적절성: ✔ 매우 적절합니다.<br>Event Broker는 <strong>백엔드 아키텍처의 메시징, 비동기 처리, 시스템 해석 및 설계</strong>에 직접적으로 관련되며, 특히 마이크로서비스 환경에서 필수적인 구성 요소입니다.</p></li></ul><hr><h3 id=-2-요약-문장-200자-이내>✅ 2. 요약 문장 (200자 이내)<a hidden class=anchor aria-hidden=true href=#-2-요약-문장-200자-이내>#</a></h3><p>Event Broker는 이벤트 기반 아키텍처에서 시스템 간 메시지를 중개하여, 비동기 통신, 느슨한 결합, 확장성 있는 설계를 가능하게 하는 핵심 인프라 컴포넌트입니다.</p><hr><h3 id=-3-전체-개요-250자-이내>✅ 3. 전체 개요 (250자 이내)<a hidden class=anchor aria-hidden=true href=#-3-전체-개요-250자-이내>#</a></h3><p>Event Broker는 이벤트 기반 아키텍처에서 이벤트를 생산자에서 소비자로 전달하는 메시징 컴포넌트입니다. 마이크로서비스, 클라우드 네이티브 환경에서 시스템 간 느슨한 결합과 비동기 통신을 통해 확장성과 장애 격리에 기여하며, 실시간 데이터 스트리밍, 알림 시스템, 자동화 워크플로우 등 다양한 곳에 활용됩니다.</p><hr><h3 id=-4-핵심-개념>✅ 4. 핵심 개념<a hidden class=anchor aria-hidden=true href=#-4-핵심-개념>#</a></h3><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>Event</strong></td><td>시스템 내 상태 변화나 행동을 나타내는 데이터 단위. 예: “OrderPlaced”</td></tr><tr><td><strong>Event Producer</strong></td><td>이벤트를 생성하여 브로커에 전달하는 주체. 예: 주문 서비스</td></tr><tr><td><strong>Event Consumer</strong></td><td>이벤트를 구독하고 처리하는 주체. 예: 재고 서비스</td></tr><tr><td><strong>Event Broker</strong></td><td>이벤트를 수신하고 적절한 소비자에게 전달하는 중재자 역할.</td></tr><tr><td><strong>Topic / Channel</strong></td><td>이벤트를 분류해주는 라우팅 단위. 구독자는 토픽을 기준으로 메시지를 받음.</td></tr><tr><td><strong>Event-Driven Architecture (EDA)</strong></td><td>이벤트를 중심으로 동작하는 아키텍처 패턴. 서비스 간 느슨한 결합과 확장성 지원.</td></tr></tbody></table><hr><h2 id=-5-주제별-상세-조사-참고사항-반영>✅ 5. 주제별 상세 조사 (참고사항 반영)<a hidden class=anchor aria-hidden=true href=#-5-주제별-상세-조사-참고사항-반영>#</a></h2><h3 id=51-목적-및-필요성>5.1 목적 및 필요성<a hidden class=anchor aria-hidden=true href=#51-목적-및-필요성>#</a></h3><ul><li><p><strong>비동기 통신 지원</strong>: 요청-응답 구조를 벗어나 서비스 간 독립성 보장</p></li><li><p><strong>확장성</strong>: 생산자, 소비자가 독립적으로 확장 가능</p></li><li><p><strong>장애 격리</strong>: 서비스 장애 시에도 이벤트 처리 보장</p></li><li><p><strong>실시간 반응성</strong>: 사용자 행동에 빠른 대응</p></li></ul><hr><h3 id=52-주요-기능-및-역할>5.2 주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#52-주요-기능-및-역할>#</a></h3><table><thead><tr><th>기능</th><th>설명</th></tr></thead><tbody><tr><td>이벤트 수신</td><td>생산자가 생성한 이벤트 수신</td></tr><tr><td>이벤트 저장</td><td>디스크 기반의 로그 또는 큐 형태로 보관</td></tr><tr><td>이벤트 라우팅</td><td>토픽 기반 또는 규칙 기반으로 소비자에게 전달</td></tr><tr><td>이벤트 재처리</td><td>실패한 이벤트의 재시도 또는 리플레이 기능 제공</td></tr><tr><td>메시지 순서 보장</td><td>FIFO(First In First Out) 보장 (선택적)</td></tr><tr><td>메시지 중복 제거</td><td>멱등성(idempotency) 보장 기능 제공</td></tr></tbody></table><hr><h3 id=53-특징>5.3 특징<a hidden class=anchor aria-hidden=true href=#53-특징>#</a></h3><ul><li><p><strong>비동기, 느슨한 결합</strong></p></li><li><p><strong>Pub/Sub 또는 Queue 모델 채택</strong></p></li><li><p><strong>높은 처리량과 신뢰성</strong></p></li><li><p><strong>스케일 아웃(Scale-out) 구조 지원</strong></p></li></ul><hr><h3 id=54-핵심-원칙>5.4 핵심 원칙<a hidden class=anchor aria-hidden=true href=#54-핵심-원칙>#</a></h3><table><thead><tr><th>원칙</th><th>설명</th></tr></thead><tbody><tr><td><strong>비동기 메시징</strong></td><td>서비스 간 직접 호출 대신 이벤트를 통해 상호작용</td></tr><tr><td><strong>느슨한 결합</strong></td><td>시스템 간 독립성 유지</td></tr><tr><td><strong>발행-구독 (Pub/Sub)</strong></td><td>이벤트 브로커가 생산자-소비자 간 직접 연결을 제거</td></tr><tr><td><strong>리액티브 처리</strong></td><td>이벤트 기반 반응형 프로세싱 가능</td></tr></tbody></table><hr><h3 id=55-주요-원리-및-작동-원리>5.5 주요 원리 및 작동 원리<a hidden class=anchor aria-hidden=true href=#55-주요-원리-및-작동-원리>#</a></h3><p><strong>작동 흐름 다이어그램</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-26-1><a class=lnlinks href=#hl-26-1>1</a>
</span><span class=lnt id=hl-26-2><a class=lnlinks href=#hl-26-2>2</a>
</span><span class=lnt id=hl-26-3><a class=lnlinks href=#hl-26-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[Producer] --&gt; [Event Broker] --&gt; [Consumer]
</span></span><span class=line><span class=cl>    |               |                |
</span></span><span class=line><span class=cl>[이벤트 생성]   [이벤트 라우팅]   [이벤트 처리]
</span></span></code></pre></td></tr></table></div></div><ul><li><p><strong>Producer</strong>는 이벤트를 <strong>Broker</strong>에게 보냄</p></li><li><p><strong>Broker</strong>는 토픽 또는 규칙 기반으로 <strong>Consumer</strong>에게 전달</p></li><li><p><strong>Consumer</strong>는 이벤트를 비동기적으로 수신하고 처리</p></li></ul><hr><h3 id=56-구조-및-아키텍처>5.6 구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#56-구조-및-아키텍처>#</a></h3><h4 id=-필수-구성-요소>✅ 필수 구성 요소<a hidden class=anchor aria-hidden=true href=#-필수-구성-요소>#</a></h4><table><thead><tr><th>구성 요소</th><th>설명</th></tr></thead><tbody><tr><td>Producer</td><td>이벤트를 생성해 브로커에 전달</td></tr><tr><td>Broker</td><td>이벤트를 수신, 저장, 라우팅</td></tr><tr><td>Consumer</td><td>이벤트를 수신해 처리 수행</td></tr><tr><td>Topic / Channel</td><td>메시지 분류 단위</td></tr><tr><td>Storage (Log)</td><td>이벤트 내구성 보장, 재처리를 위한 저장소</td></tr></tbody></table><h4 id=-선택-구성-요소>🔁 선택 구성 요소<a hidden class=anchor aria-hidden=true href=#-선택-구성-요소>#</a></h4><table><thead><tr><th>구성 요소</th><th>설명</th></tr></thead><tbody><tr><td>Rule Engine</td><td>이벤트 라우팅에 조건 기반 처리 적용</td></tr><tr><td>Event Router</td><td>이벤트를 다양한 소비자에게 라우팅</td></tr><tr><td>Retry Queue / DLQ</td><td>실패 이벤트를 위한 재처리 큐 구성</td></tr></tbody></table><h4 id=-아키텍처-다이어그램-간단화>✅ 아키텍처 다이어그램 (간단화)<a hidden class=anchor aria-hidden=true href=#-아키텍처-다이어그램-간단화>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-27-1><a class=lnlinks href=#hl-27-1>1</a>
</span><span class=lnt id=hl-27-2><a class=lnlinks href=#hl-27-2>2</a>
</span><span class=lnt id=hl-27-3><a class=lnlinks href=#hl-27-3>3</a>
</span><span class=lnt id=hl-27-4><a class=lnlinks href=#hl-27-4>4</a>
</span><span class=lnt id=hl-27-5><a class=lnlinks href=#hl-27-5>5</a>
</span><span class=lnt id=hl-27-6><a class=lnlinks href=#hl-27-6>6</a>
</span><span class=lnt id=hl-27-7><a class=lnlinks href=#hl-27-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>+------------+        +-------------+       +------------+
</span></span><span class=line><span class=cl>|  Producer  | -----&gt; |  Event Broker | --&gt; |  Consumer  |
</span></span><span class=line><span class=cl>+------------+        +-------------+       +------------+
</span></span><span class=line><span class=cl>                            |
</span></span><span class=line><span class=cl>                       +----------+
</span></span><span class=line><span class=cl>                       | Topic/Log |
</span></span><span class=line><span class=cl>                       +----------+
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=57-구현-기법>5.7 구현 기법<a hidden class=anchor aria-hidden=true href=#57-구현-기법>#</a></h3><table><thead><tr><th>구현 방식</th><th>정의</th><th>주요 구성</th><th>목적</th><th>예시</th></tr></thead><tbody><tr><td><strong>Pub/Sub</strong></td><td>발행자가 메시지를 전송하고 구독자가 수신</td><td>Topic, Subscriber</td><td>비동기 통신</td><td>Kafka, Pulsar</td></tr><tr><td><strong>Queue-based</strong></td><td>메시지가 큐에 쌓이고 소비자가 처리</td><td>Queue, Consumer</td><td>순차적 처리, 병렬성 제한</td><td>RabbitMQ, SQS</td></tr><tr><td><strong>Rule-based Routing</strong></td><td>조건 기반으로 라우팅</td><td>Rule, EventPattern</td><td>조건 기반 처리</td><td>AWS EventBridge</td></tr><tr><td><strong>Replay / Log-based</strong></td><td>이벤트를 저장하고 재생 가능</td><td>Storage, Offset</td><td>재처리 및 감사</td><td>Kafka log</td></tr></tbody></table><hr><h3 id=58-장점과-단점>5.8 장점과 단점<a hidden class=anchor aria-hidden=true href=#58-장점과-단점>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>✅ 장점</td><td>확장성</td><td>생산자/소비자의 독립적 스케일링 가능</td></tr><tr><td></td><td>유연성</td><td>마이크로서비스 통합 용이</td></tr><tr><td></td><td>장애 격리</td><td>일부 소비자가 실패해도 전체 영향 없음</td></tr><tr><td></td><td>이벤트 저장</td><td>과거 이벤트 재처리 가능</td></tr><tr><td>⚠ 단점</td><td>설계 복잡도</td><td>메시지 흐름과 데이터 흐름 이해 필요</td></tr><tr><td></td><td>중복 처리 위험</td><td>멱등성 구현 필요</td></tr><tr><td></td><td>모니터링 부담</td><td>메시지 지연/손실 추적 필요</td></tr><tr><td></td><td>순서 보장 이슈</td><td>다중 파티션 사용 시 순서 깨질 수 있음</td></tr></tbody></table><hr><h3 id=59-분류에-따른-종류-및-유형>5.9 분류에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#59-분류에-따른-종류-및-유형>#</a></h3><table><thead><tr><th>분류 기준</th><th>유형</th><th>설명</th></tr></thead><tbody><tr><td>메시징 모델</td><td>Pub/Sub</td><td>다수 소비자 대상 이벤트 분배</td></tr><tr><td></td><td>큐 기반</td><td>단일 소비자 처리 (FIFO)</td></tr><tr><td>전달 보장</td><td>At-most-once</td><td>최대 한 번, 손실 가능</td></tr><tr><td></td><td>At-least-once</td><td>중복 가능, 반드시 한 번 이상</td></tr><tr><td></td><td>Exactly-once</td><td>중복 없이 정확히 한 번</td></tr><tr><td>배포 형태</td><td>클라우드 기반</td><td>AWS EventBridge, GCP Pub/Sub</td></tr><tr><td></td><td>온프레미스</td><td>Kafka, RabbitMQ, NATS</td></tr></tbody></table><hr><p>좋습니다. 이어서 <strong>실무 적용 예시</strong>부터 정리해드리겠습니다.</p><hr><h2 id=-510-실무-적용-예시>✅ 5.10 실무 적용 예시<a hidden class=anchor aria-hidden=true href=#-510-실무-적용-예시>#</a></h2><table><thead><tr><th>사례</th><th>설명</th></tr></thead><tbody><tr><td>주문 처리 시스템</td><td>사용자가 상품을 주문하면 <code>OrderCreated</code> 이벤트를 발행하고, 결제, 재고, 배송 서비스가 이를 소비함</td></tr><tr><td>실시간 알림 시스템</td><td>게시글에 댓글이 달리면 이벤트를 통해 사용자에게 푸시 알림을 전송</td></tr><tr><td>IoT 센서 네트워크</td><td>센서가 측정한 데이터를 이벤트로 브로커에 보내고, 분석 서비스가 이를 실시간 처리</td></tr><tr><td>로그 수집 및 분석</td><td>다양한 마이크로서비스에서 발생하는 로그를 이벤트로 Kafka에 전송하고, ELK(Elasticsearch, Logstash, Kibana)로 분석</td></tr><tr><td>결제 거래 흐름 추적</td><td>사용자의 결제 이벤트 흐름을 전송하여 상태 변화 추적 및 자동화 처리 수행</td></tr></tbody></table><hr><h2 id=-511-활용-사례>✅ 5.11 활용 사례<a hidden class=anchor aria-hidden=true href=#-511-활용-사례>#</a></h2><h3 id=-상황-이커머스-플랫폼의-실시간-주문-배송-연동>📌 상황: 이커머스 플랫폼의 실시간 주문-배송 연동<a hidden class=anchor aria-hidden=true href=#-상황-이커머스-플랫폼의-실시간-주문-배송-연동>#</a></h3><p><strong>시나리오 설명:</strong><br>고객이 주문을 완료하면 결제, 재고 확인, 배송 예약 등의 처리가 순차적으로 이루어짐. 각 단계는 독립된 마이크로서비스로 구성되어 있음.</p><p><strong>사용 시스템 구성:</strong></p><table><thead><tr><th>구성 요소</th><th>기술</th></tr></thead><tbody><tr><td>이벤트 브로커</td><td>Apache Kafka</td></tr><tr><td>주문 서비스</td><td>Spring Boot (Producer)</td></tr><tr><td>결제 서비스</td><td>Node.js</td></tr><tr><td>재고 서비스</td><td>Python FastAPI</td></tr><tr><td>배송 서비스</td><td>Golang</td></tr><tr><td>알림 서비스</td><td>Firebase Messaging (Consumer)</td></tr></tbody></table><p><strong>워크플로우:</strong></p><ol><li><p>주문 발생 → <code>OrderCreated</code> 이벤트 Kafka에 발행</p></li><li><p>결제/재고 서비스는 해당 이벤트 구독 후 처리</p></li><li><p>결제 완료 → <code>PaymentSuccess</code> 이벤트 발행</p></li><li><p>배송 서비스는 이를 구독하고 배송 스케줄링</p></li><li><p>알림 서비스는 각 단계의 이벤트를 수신하여 사용자에게 알림 전송</p></li></ol><p><strong>역할 분담:</strong></p><ul><li><p>Kafka: 모든 이벤트의 전달 및 순서 제어</p></li><li><p>각 서비스: 자신의 도메인 처리만 책임, 이벤트에 반응</p></li></ul><hr><h2 id=-512-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>✅ 5.12 실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#-512-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h2><table><thead><tr><th>항목</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>멱등성 처리</td><td>중복 메시지로 인한 중복 처리 방지 필요</td><td>메시지에 ID 부여, 상태 체크 후 처리</td></tr><tr><td>이벤트 스키마 관리</td><td>필드 추가/변경 시 하위 호환성 이슈</td><td>Avro + Schema Registry 사용</td></tr><tr><td>소비자 장애 복구</td><td>소비자 실패 시 데이터 유실 위험</td><td>Retry + Dead Letter Queue 구성</td></tr><tr><td>보안 및 인증</td><td>브로커 접근 제어 필요</td><td>TLS, SASL, IAM 정책 구성</td></tr><tr><td>운영 모니터링</td><td>메시지 지연, 실패 추적 필수</td><td>Prometheus, Grafana, Kafka UI 도입</td></tr><tr><td>데이터 유실 방지</td><td>브로커 저장소나 파티션 장애 시 손실 발생 가능</td><td>Replication, 메시지 영속화 설정</td></tr></tbody></table><hr><h2 id=-513-성능을-최적화하기-위한-고려사항-및-주의할-점>✅ 5.13 성능을 최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#-513-성능을-최적화하기-위한-고려사항-및-주의할-점>#</a></h2><table><thead><tr><th>항목</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>처리량 (Throughput)</td><td>초당 메시지 전송량 제한</td><td>배치 전송, 압축 사용, 프로듀서 설정 조정</td></tr><tr><td>지연시간 (Latency)</td><td>소비자 수신 지연</td><td>빠른 네트워크, 바이너리 포맷(Avro 등) 사용</td></tr><tr><td>저장 공간</td><td>로그 기반 브로커는 저장공간 이슈 있음</td><td>보존 기간 설정, 압축 활성화</td></tr><tr><td>파티션 설계</td><td>너무 적으면 병렬성 부족, 많으면 오버헤드 증가</td><td>토픽 설계 시 키 기반 파티션 전략 사용</td></tr><tr><td>메시지 크기</td><td>큰 메시지는 처리 및 전송 부담</td><td>파일은 별도 저장, 링크만 이벤트에 포함</td></tr><tr><td>소비자 병렬성</td><td>단일 소비자는 처리량 한계</td><td>Consumer Group으로 수평 확장</td></tr></tbody></table><hr><h2 id=-514-2025년-기준-최신-동향>✅ 5.14 2025년 기준 최신 동향<a hidden class=anchor aria-hidden=true href=#-514-2025년-기준-최신-동향>#</a></h2><table><thead><tr><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>기술</td><td>Apache Kafka 4.0</td><td>KRaft 기반으로 Zookeeper 제거, 관리 단순화</td></tr><tr><td>클라우드</td><td>AWS EventBridge 성장</td><td>이벤트 중심 SaaS 간 통합 허브로 확장</td></tr><tr><td>표준화</td><td>AsyncAPI</td><td>메시징 기반 API 명세화 도구로 도입 확산</td></tr><tr><td>아키텍처</td><td>Event Mesh</td><td>다양한 브로커를 통합하는 메시지 네트워크 개념 확대</td></tr><tr><td>보안</td><td>메시지 레벨 암호화</td><td>데이터 보안 요구 증가에 따라 메시지 단위 보호 강화</td></tr></tbody></table><hr><h2 id=-515-주제와-관련하여-주목할-내용>✅ 5.15 주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#-515-주제와-관련하여-주목할-내용>#</a></h2><table><thead><tr><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>운영 자동화</td><td>브로커 오토스케일링</td><td>Kubernetes 기반 자동 확장 구현 확대</td></tr><tr><td>고가용성</td><td>다중 브로커 클러스터</td><td>장애 대비용 이중화 구성이 보편화</td></tr><tr><td>메시지 포맷</td><td>Protobuf, Avro</td><td>성능, 용량, 스키마 진화성에서 주목받는 포맷</td></tr><tr><td>Event Replay</td><td>Kafka, Pulsar 등에서 지원</td><td>장애 시 재처리 및 감사용으로 활용 증가</td></tr></tbody></table><hr><h2 id=-516-앞으로의-전망>✅ 5.16 앞으로의 전망<a hidden class=anchor aria-hidden=true href=#-516-앞으로의-전망>#</a></h2><table><thead><tr><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>아키텍처 전환</td><td>이벤트 기반 설계 표준화</td><td>기존 REST 기반 시스템도 이벤트 중심으로 재편 중</td></tr><tr><td>산업 확산</td><td>IoT, AI 기반 시스템 증가</td><td>실시간 데이터 수집 및 반응형 처리가 필수화됨</td></tr><tr><td>통합 표준</td><td>AsyncAPI + OpenAPI 연동</td><td>메시징과 REST API 명세 통합 시도 활발</td></tr><tr><td>서비스화</td><td>Event Broker as a Service</td><td>Kafka, EventBridge 등 완전관리형 서비스 확산 지속</td></tr></tbody></table><hr><h2 id=-517-하위-주제별-추가-학습-목록>✅ 5.17 하위 주제별 추가 학습 목록<a hidden class=anchor aria-hidden=true href=#-517-하위-주제별-추가-학습-목록>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>설명</th></tr></thead><tbody><tr><td>아키텍처</td><td>Event Mesh</td><td>다중 브로커 통합과 글로벌 이벤트 전파</td></tr><tr><td>설계 전략</td><td>이벤트 스키마 설계</td><td>이벤트 정의 시 필수 고려사항 및 버전 관리</td></tr><tr><td>보안</td><td>메시징 인증 및 암호화</td><td>TLS, OAuth, IAM 기반 접근 제어 기법</td></tr><tr><td>테스트</td><td>이벤트 기반 통합 테스트</td><td>E2E 흐름 테스트 및 시뮬레이션 전략</td></tr><tr><td>성능</td><td>이벤트 병렬 처리 전략</td><td>Partition, Consumer Group 구성 전략 학습</td></tr></tbody></table><hr><h2 id=-518-관련-분야별-추가-학습-목록>✅ 5.18 관련 분야별 추가 학습 목록<a hidden class=anchor aria-hidden=true href=#-518-관련-분야별-추가-학습-목록>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>설명</th></tr></thead><tbody><tr><td>데이터 엔지니어링</td><td>Kafka Connect / Kafka Streams</td><td>외부 시스템 연동 및 스트림 처리 학습</td></tr><tr><td>DevOps</td><td>Kafka 클러스터 운영</td><td>배포, 모니터링, 확장 전략 학습</td></tr><tr><td>클라우드 아키텍처</td><td>AWS EventBridge, SNS/SQS</td><td>완전관리형 메시징 서비스 설계</td></tr><tr><td>AI/ML</td><td>실시간 추론 트리거</td><td>이벤트 기반 ML 모델 실행 자동화</td></tr><tr><td>보안</td><td>Event Audit Logging</td><td>이벤트 추적을 위한 로깅 및 감사 전략</td></tr></tbody></table><hr><h2 id=-용어-정리>🧾 용어 정리<a hidden class=anchor aria-hidden=true href=#-용어-정리>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>Event Broker</td><td>이벤트를 생산자에서 소비자로 전달하는 중간 시스템</td></tr><tr><td>Pub/Sub</td><td>발행-구독 모델로, 하나의 발행자가 다수 소비자에게 메시지를 전파</td></tr><tr><td>Dead Letter Queue (DLQ)</td><td>처리 실패한 메시지를 보관하여 별도로 처리하는 큐</td></tr><tr><td>AsyncAPI</td><td>메시지 기반 API 명세를 위한 표준 포맷</td></tr><tr><td>Event Mesh</td><td>다양한 브로커를 하나의 통합 메시지 시스템처럼 연결한 구조</td></tr></tbody></table><hr><h2 id=-참고-및-출처>🔗 참고 및 출처<a hidden class=anchor aria-hidden=true href=#-참고-및-출처>#</a></h2><ul><li><p><a href=https://www.confluent.io/what-is-an-event-broker/>What is an Event Broker - Confluent</a></p></li><li><p><a href=https://aws.amazon.com/eventbridge/>AWS EventBridge 공식 페이지</a></p></li><li><p><a href=https://redhat.com/en/topics/integration/what-is-an-event-driven-architecture>Red Hat - Event-Driven Architecture 소개</a></p></li><li><p><a href=https://kafka.apache.org/>Apache Kafka 공식 문서</a></p></li><li><p><a href=https://www.asyncapi.com/>AsyncAPI 공식 웹사이트</a></p></li></ul><hr><p>필요하시면 “Event Broker 구축 예제 코드”, “Kafka vs EventBridge 비교”, “Kafka 모니터링 지표 및 실전 대시보드 구성”도 제공해드릴 수 있습니다. 어떤 부분을 더 살펴볼까요?</p><p>아래에 요청하신 세 가지 항목을 실무 기준으로 구체적으로 정리해드립니다:</p><hr><h2 id=-1-event-broker-구축-예제-코드-kafka-기반-python>✅ 1. Event Broker 구축 예제 코드 (Kafka 기반, Python)<a hidden class=anchor aria-hidden=true href=#-1-event-broker-구축-예제-코드-kafka-기반-python>#</a></h2><h3 id=-목표>🎯 목표:<a hidden class=anchor aria-hidden=true href=#-목표>#</a></h3><p>Kafka를 사용하여 Event Broker 환경을 구축하고 간단한 <strong>Producer-Consumer</strong> 이벤트 흐름을 구현합니다.</p><h3 id=-구성>📦 구성:<a hidden class=anchor aria-hidden=true href=#-구성>#</a></h3><ul><li><p>Apache Kafka</p></li><li><p>Python (<code>kafka-python</code> 라이브러리)</p></li></ul><h3 id=1-1-설치-준비>1-1. 설치 준비<a hidden class=anchor aria-hidden=true href=#1-1-설치-준비>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-28-1><a class=lnlinks href=#hl-28-1>1</a>
</span><span class=lnt id=hl-28-2><a class=lnlinks href=#hl-28-2>2</a>
</span><span class=lnt id=hl-28-3><a class=lnlinks href=#hl-28-3>3</a>
</span><span class=lnt id=hl-28-4><a class=lnlinks href=#hl-28-4>4</a>
</span><span class=lnt id=hl-28-5><a class=lnlinks href=#hl-28-5>5</a>
</span><span class=lnt id=hl-28-6><a class=lnlinks href=#hl-28-6>6</a>
</span><span class=lnt id=hl-28-7><a class=lnlinks href=#hl-28-7>7</a>
</span><span class=lnt id=hl-28-8><a class=lnlinks href=#hl-28-8>8</a>
</span><span class=lnt id=hl-28-9><a class=lnlinks href=#hl-28-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Kafka &amp; Zookeeper 실행 (Docker 기반 예시)</span>
</span></span><span class=line><span class=cl>docker run -d --name zookeeper -p 2181:2181 zookeeper
</span></span><span class=line><span class=cl>docker run -d --name kafka -p 9092:9092 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -e <span class=nv>KAFKA_ZOOKEEPER_CONNECT</span><span class=o>=</span>zookeeper:2181 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -e <span class=nv>KAFKA_ADVERTISED_LISTENERS</span><span class=o>=</span>PLAINTEXT://localhost:9092 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -e <span class=nv>KAFKA_LISTENER_SECURITY_PROTOCOL_MAP</span><span class=o>=</span>PLAINTEXT:PLAINTEXT <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -e <span class=nv>KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR</span><span class=o>=</span><span class=m>1</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --network<span class=o>=</span>host <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  confluentinc/cp-kafka
</span></span></code></pre></td></tr></table></div></div><h3 id=1-2-python-producer-코드>1-2. Python Producer 코드<a hidden class=anchor aria-hidden=true href=#1-2-python-producer-코드>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-29-1><a class=lnlinks href=#hl-29-1> 1</a>
</span><span class=lnt id=hl-29-2><a class=lnlinks href=#hl-29-2> 2</a>
</span><span class=lnt id=hl-29-3><a class=lnlinks href=#hl-29-3> 3</a>
</span><span class=lnt id=hl-29-4><a class=lnlinks href=#hl-29-4> 4</a>
</span><span class=lnt id=hl-29-5><a class=lnlinks href=#hl-29-5> 5</a>
</span><span class=lnt id=hl-29-6><a class=lnlinks href=#hl-29-6> 6</a>
</span><span class=lnt id=hl-29-7><a class=lnlinks href=#hl-29-7> 7</a>
</span><span class=lnt id=hl-29-8><a class=lnlinks href=#hl-29-8> 8</a>
</span><span class=lnt id=hl-29-9><a class=lnlinks href=#hl-29-9> 9</a>
</span><span class=lnt id=hl-29-10><a class=lnlinks href=#hl-29-10>10</a>
</span><span class=lnt id=hl-29-11><a class=lnlinks href=#hl-29-11>11</a>
</span><span class=lnt id=hl-29-12><a class=lnlinks href=#hl-29-12>12</a>
</span><span class=lnt id=hl-29-13><a class=lnlinks href=#hl-29-13>13</a>
</span><span class=lnt id=hl-29-14><a class=lnlinks href=#hl-29-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># producer.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaProducer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_serializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>v</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>v</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>event</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;event_type&#39;</span><span class=p>:</span> <span class=s1>&#39;OrderCreated&#39;</span><span class=p>,</span> <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=mi>1234</span><span class=p>,</span> <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=mi>5678</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s1>&#39;order-events&#39;</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>producer</span><span class=o>.</span><span class=n>flush</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;✅ OrderCreated 이벤트 전송 완료&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=1-3-python-consumer-코드>1-3. Python Consumer 코드<a hidden class=anchor aria-hidden=true href=#1-3-python-consumer-코드>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-30-1><a class=lnlinks href=#hl-30-1> 1</a>
</span><span class=lnt id=hl-30-2><a class=lnlinks href=#hl-30-2> 2</a>
</span><span class=lnt id=hl-30-3><a class=lnlinks href=#hl-30-3> 3</a>
</span><span class=lnt id=hl-30-4><a class=lnlinks href=#hl-30-4> 4</a>
</span><span class=lnt id=hl-30-5><a class=lnlinks href=#hl-30-5> 5</a>
</span><span class=lnt id=hl-30-6><a class=lnlinks href=#hl-30-6> 6</a>
</span><span class=lnt id=hl-30-7><a class=lnlinks href=#hl-30-7> 7</a>
</span><span class=lnt id=hl-30-8><a class=lnlinks href=#hl-30-8> 8</a>
</span><span class=lnt id=hl-30-9><a class=lnlinks href=#hl-30-9> 9</a>
</span><span class=lnt id=hl-30-10><a class=lnlinks href=#hl-30-10>10</a>
</span><span class=lnt id=hl-30-11><a class=lnlinks href=#hl-30-11>11</a>
</span><span class=lnt id=hl-30-12><a class=lnlinks href=#hl-30-12>12</a>
</span><span class=lnt id=hl-30-13><a class=lnlinks href=#hl-30-13>13</a>
</span><span class=lnt id=hl-30-14><a class=lnlinks href=#hl-30-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># consumer.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaConsumer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;order-events&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>auto_offset_reset</span><span class=o>=</span><span class=s1>&#39;earliest&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>group_id</span><span class=o>=</span><span class=s1>&#39;order-service&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_deserializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>message</span> <span class=ow>in</span> <span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;✅ 수신된 이벤트: </span><span class=si>{</span><span class=n>message</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=-2-kafka-vs-aws-eventbridge-비교>✅ 2. Kafka vs AWS EventBridge 비교<a hidden class=anchor aria-hidden=true href=#-2-kafka-vs-aws-eventbridge-비교>#</a></h2><table><thead><tr><th>항목</th><th>Apache Kafka</th><th>AWS EventBridge</th></tr></thead><tbody><tr><td><strong>설치 형태</strong></td><td>자체 호스팅 또는 Confluent Cloud</td><td>완전관리형 (서버리스)</td></tr><tr><td><strong>프로토콜</strong></td><td>TCP 기반 고속 스트리밍</td><td>HTTP 기반 이벤트 버스</td></tr><tr><td><strong>스키마 관리</strong></td><td>Avro + Schema Registry</td><td>JSON + Schema Registry</td></tr><tr><td><strong>이벤트 처리</strong></td><td>고속, 실시간, 다중 소비자</td><td>규칙 기반 라우팅, 느린 이벤트 처리 가능</td></tr><tr><td><strong>통합성</strong></td><td>외부 도구와의 커스텀 연동 용이</td><td>AWS 서비스와의 통합 강력</td></tr><tr><td><strong>보안</strong></td><td>TLS, ACL 등 자체 구성</td><td>IAM, 리소스 정책 통합</td></tr><tr><td><strong>사용 사례</strong></td><td>실시간 로그, 스트리밍 분석</td><td>SaaS 이벤트 통합, 워크플로우 트리거링</td></tr><tr><td><strong>장점</strong></td><td>고성능, 유연성, 재처리 가능</td><td>간단한 설정, 완전관리형</td></tr><tr><td><strong>단점</strong></td><td>운영 복잡, 설정 어려움</td><td>Throughput 제한, 제약된 커스터마이징</td></tr></tbody></table><p>🧠 <strong>추천 시나리오</strong>:</p><ul><li><p>Kafka: <strong>대량의 실시간 데이터 처리</strong> 및 <strong>복잡한 이벤트 스트림 처리</strong></p></li><li><p>EventBridge: <strong>서버리스 아키텍처</strong>, <strong>AWS 서비스 간 이벤트 통합</strong> 중심</p></li></ul><hr><h2 id=-3-kafka-모니터링-지표-및-실전-대시보드-구성-prometheus--grafana>✅ 3. Kafka 모니터링 지표 및 실전 대시보드 구성 (Prometheus + Grafana)<a hidden class=anchor aria-hidden=true href=#-3-kafka-모니터링-지표-및-실전-대시보드-구성-prometheus--grafana>#</a></h2><h3 id=-주요-지표>📊 주요 지표<a hidden class=anchor aria-hidden=true href=#-주요-지표>#</a></h3><table><thead><tr><th>지표</th><th>설명</th></tr></thead><tbody><tr><td><code>kafka_server_brokertopicmetrics_messages_in_total</code></td><td>초당 수신 메시지 수</td></tr><tr><td><code>kafka_server_brokertopicmetrics_bytes_in_total</code></td><td>수신 바이트 수</td></tr><tr><td><code>kafka_server_brokertopicmetrics_bytes_out_total</code></td><td>전송 바이트 수</td></tr><tr><td><code>kafka_server_replicamanager_underreplicated_partitions</code></td><td>동기화 안된 파티션 수</td></tr><tr><td><code>kafka_network_requestmetrics_requests_total</code></td><td>총 네트워크 요청 수</td></tr><tr><td><code>kafka_controller_kafkacontroller_activecontrollercount</code></td><td>활성 컨트롤러 수 (1이 아니면 비정상)</td></tr><tr><td><code>kafka_log_logsize</code></td><td>토픽/파티션별 로그 사이즈</td></tr></tbody></table><hr><h3 id=-실전-대시보드-구성>🛠️ 실전 대시보드 구성<a hidden class=anchor aria-hidden=true href=#-실전-대시보드-구성>#</a></h3><ol><li><strong>Exporter 설치</strong><br>Kafka용 JMX Exporter 사용:</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-31-1><a class=lnlinks href=#hl-31-1>1</a>
</span><span class=lnt id=hl-31-2><a class=lnlinks href=#hl-31-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java -javaagent:/opt/jmx_prometheus_javaagent.jar<span class=o>=</span>7071:/opt/kafka.yml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>     -jar kafka-server-start.sh …
</span></span></code></pre></td></tr></table></div></div><ol start=2><li><strong>Prometheus 설정 예시</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-32-1><a class=lnlinks href=#hl-32-1>1</a>
</span><span class=lnt id=hl-32-2><a class=lnlinks href=#hl-32-2>2</a>
</span><span class=lnt id=hl-32-3><a class=lnlinks href=#hl-32-3>3</a>
</span><span class=lnt id=hl-32-4><a class=lnlinks href=#hl-32-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;kafka&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;localhost:7071&#39;</span><span class=p>]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=3><li><strong>Grafana 대시보드 템플릿</strong></li></ol><ul><li><p>ID: <code>7589</code> (confluentinc 제공 Kafka Dashboard)</p></li><li><p>대시보드 포함 항목:</p><ul><li><p>브로커별 처리량</p></li><li><p>파티션 상태</p></li><li><p>lag 상태</p></li><li><p>consumer group health</p></li><li><p>메시지 지연 현황</p></li></ul></li></ul><p>📍 <a href=https://grafana.com/grafana/dashboards>Grafana Dashboards 공식 페이지</a></p><hr><p>필요하시면 다음 항목도 추가 제공 가능합니다:</p><ul><li><p>Kafka + Flink 실시간 분석 연동 예제</p></li><li><p>EventBridge를 사용한 AWS 서비스 오케스트레이션 사례</p></li><li><p>Kafka Streams와 KSQL 사용법</p></li></ul><p>원하시는 방향이 있다면 이어서 더 지원하겠습니다.</p><h1 id=이벤트-및-메시지-브로커>이벤트 및 메시지 브로커<a hidden class=anchor aria-hidden=true href=#이벤트-및-메시지-브로커>#</a></h1><h2 id=1-주제의-분류-적절성-확인>1. 주제의 분류 적절성 확인<a hidden class=anchor aria-hidden=true href=#1-주제의-분류-적절성-확인>#</a></h2><p>&ldquo;Event and Message Brokers"는 &ldquo;Computer Science and Engineering&rdquo; > &ldquo;Backend Development&rdquo; 분류가 매우 적절합니다. 이벤트 및 메시지 브로커는 백엔드 시스템의 핵심 구성 요소로, 분산 시스템에서 비동기 통신을 가능하게 하고 시스템 간 결합도를 낮추는 데 중요한 역할을 합니다.</p><h2 id=2-요약-200자-내외>2. 요약 (200자 내외)<a hidden class=anchor aria-hidden=true href=#2-요약-200자-내외>#</a></h2><p>이벤트 및 메시지 브로커는 서로 다른 시스템이나 애플리케이션 간 비동기 통신을 가능하게 하는 미들웨어로, 메시지 브로커는 안전한 메시지 전달과 라우팅에 중점을 두고, 이벤트 브로커는 대용량 데이터 처리와 이벤트 기록 보존에 중점을 둡니다. 대표적으로 메시지 브로커는 RabbitMQ, 이벤트 브로커는 Apache Kafka가 있습니다.</p><h2 id=3-개요-250자-내외>3. 개요 (250자 내외)<a hidden class=anchor aria-hidden=true href=#3-개요-250자-내외>#</a></h2><p>이벤트 및 메시지 브로커는 현대 백엔드 아키텍처에서 핵심적인 통신 메커니즘을 제공하는 미들웨어 시스템입니다. 이들은 분산 시스템에서 애플리케이션 간의 느슨한 결합을 가능하게 하고, 비동기 통신을 통해 시스템 확장성과 안정성을 높입니다. 메시지 브로커가 메시지의 안전한 전달과 순서 보장에 중점을 두는 반면, 이벤트 브로커는 대용량 이벤트 데이터의 실시간 처리와 영구 저장에 특화되어 있습니다.</p><h2 id=4-핵심-개념>4. 핵심 개념<a hidden class=anchor aria-hidden=true href=#4-핵심-개념>#</a></h2><h3 id=메시지-브로커message-broker>메시지 브로커(Message Broker)<a hidden class=anchor aria-hidden=true href=#메시지-브로커message-broker>#</a></h3><p>메시지 브로커는 서로 다른 시스템이나 애플리케이션 간의 메시지를 안전하게 송수신하도록 중개하는 소프트웨어입니다. 주요 목적은 메시지를 검증, 변환, 라우팅하여 적절한 수신자에게 전달하는 것입니다. 메시지 브로커는 메시지를 일시적으로 저장하고, 소비자가 처리될 때까지 보관합니다.</p><h3 id=이벤트-브로커event-broker>이벤트 브로커(Event Broker)<a hidden class=anchor aria-hidden=true href=#이벤트-브로커event-broker>#</a></h3><p>이벤트 브로커는 시스템에서 발생하는 이벤트를 중계하는 미들웨어로, 이벤트 데이터를 로그 방식으로 저장하여 대용량 데이터를 효율적으로 처리할 수 있습니다. 이벤트 브로커는 이벤트 데이터를 영구적으로 저장하며, 소비자가 필요할 때 특정 시점부터 이벤트를 다시 소비할 수 있는 특징이 있습니다.</p><h3 id=생산자-소비자-패턴producer-consumer-pattern>생산자-소비자 패턴(Producer-Consumer Pattern)<a hidden class=anchor aria-hidden=true href=#생산자-소비자-패턴producer-consumer-pattern>#</a></h3><p>메시지/이벤트 브로커에서는 메시지를 보내는 측(생산자, Producer)과 메시지를 받는 측(소비자, Consumer) 간의 통신 패턴입니다. 생산자는 브로커에 메시지를 발행하고, 소비자는 브로커로부터 메시지를 구독합니다.</p><h3 id=비동기-통신asynchronous-communication>비동기 통신(Asynchronous Communication)<a hidden class=anchor aria-hidden=true href=#비동기-통신asynchronous-communication>#</a></h3><p>메시지/이벤트 브로커의 핵심 개념으로, 시스템 간에 실시간으로 응답을 기다리지 않고 독립적으로 작동할 수 있게 합니다. 이는 시스템의 확장성과 장애 대응력을 높입니다.</p><h3 id=느슨한-결합loose-coupling>느슨한 결합(Loose Coupling)<a hidden class=anchor aria-hidden=true href=#느슨한-결합loose-coupling>#</a></h3><p>시스템 간 의존성을 최소화하는 설계 원칙으로, 메시지/이벤트 브로커를 통해 서비스들이 직접적인 연결 없이도 통신할 수 있게 합니다. 이를 통해 시스템 변경이나 확장 시 다른 시스템에 미치는 영향을 최소화할 수 있습니다.</p><h2 id=5-주제와-관련하여-조사할-내용>5. 주제와 관련하여 조사할 내용<a hidden class=anchor aria-hidden=true href=#5-주제와-관련하여-조사할-내용>#</a></h2><h3 id=목적-및-필요성-1>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성-1>#</a></h3><p>메시지 및 이벤트 브로커의 주요 목적은 분산 시스템에서 비동기 통신을 가능하게 하는 것입니다. 이를 통해 다음과 같은 필요성을 해결합니다:</p><ol><li><strong>시스템 간 느슨한 결합 구현</strong>: 서비스 간 직접적인 의존성을 제거하여 각 서비스가 독립적으로 개발, 배포, 확장될 수 있도록 합니다.</li><li><strong>부하 분산</strong>: 갑작스러운 트래픽 증가나 대량 요청 시에도 메시지를 일시적으로 저장하고 순차적으로 처리할 수 있습니다.</li><li><strong>안정성 향상</strong>: 수신 시스템이 일시적으로 사용 불가능한 상황에서도 메시지를 보존하여 나중에 처리할 수 있습니다.</li><li><strong>확장성 지원</strong>: 시스템 규모가 커지고 복잡해질수록 직접 연결 방식은 관리하기 어려워지므로, 브로커를 통한 중앙화된 통신 채널을 제공합니다.</li><li><strong>비동기 처리</strong>: 응답을 기다리지 않고 처리할 수 있어 시스템 효율성이 향상됩니다.</li></ol><h3 id=주요-기능-및-역할-1>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할-1>#</a></h3><ol><li><strong>메시지 라우팅</strong>: 메시지를 적절한 수신자에게 전달합니다.</li><li><strong>메시지 변환</strong>: 다양한 프로토콜과 데이터 형식 간 변환을 지원합니다.</li><li><strong>메시지 저장</strong>: 소비자가 처리할 수 있을 때까지 메시지를 안전하게 저장합니다.</li><li><strong>메시지 필터링</strong>: 특정 조건에 맞는 메시지만 선별하여 전달합니다.</li><li><strong>부하 분산</strong>: 여러 소비자 간에 메시지를 분산시켜 처리 효율을 높입니다.</li><li><strong>신뢰성 보장</strong>: 메시지 전달 성공 여부를 확인하고, 필요시 재전송합니다.</li><li><strong>이벤트 지속성</strong>: 이벤트 브로커의 경우, 이벤트를 영구적으로 저장하여 나중에 접근할 수 있게 합니다.</li></ol><h3 id=특징-1>특징<a hidden class=anchor aria-hidden=true href=#특징-1>#</a></h3><ol><li><strong>비동기 통신</strong>: 송신자와 수신자가 동시에 활성화되어 있지 않아도 메시지 교환이 가능합니다.</li><li><strong>메시지 버퍼링</strong>: 대량의 메시지를 일시적으로 저장하여 처리 부하를 분산합니다.</li><li><strong>확장성</strong>: 메시지 양이 증가해도 시스템을 수평적으로 확장할 수 있습니다.</li><li><strong>장애 내구성</strong>: 시스템 일부가 실패해도 전체 시스템 중단 없이 계속 작동합니다.</li><li><strong>다양한 통신 패턴 지원</strong>: 일대일, 일대다, 발행-구독 등 다양한 통신 패턴을 지원합니다.</li><li><strong>플랫폼 독립성</strong>: 다양한 프로그래밍 언어와 플랫폼 간 통신을 가능하게 합니다.</li></ol><h3 id=핵심-원칙-1>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙-1>#</a></h3><ol><li><strong>메시지 지향 미들웨어(Message-Oriented Middleware, MOM) 원칙</strong>: 시스템 간 통신을 메시지 교환으로 추상화합니다.</li><li><strong>발행-구독(Publish-Subscribe) 원칙</strong>: 메시지 생산자와 소비자 간의 느슨한 결합을 촉진합니다.</li><li><strong>점대점(Point-to-Point) 원칙</strong>: 한 생산자가 하나의 소비자에게 메시지를 전달하는 방식입니다.</li><li><strong>메시지 보존 원칙</strong>: 메시지는 소비될 때까지 안전하게 보존되어야 합니다.</li><li><strong>멱등성(Idempotency) 원칙</strong>: 동일한 메시지가 여러 번 처리되더라도 시스템 상태는 동일해야 합니다.</li><li><strong>순서 보장 원칙</strong>: 특정 상황에서는 메시지의 처리 순서가 보장되어야 합니다.</li><li><strong>장애 격리 원칙</strong>: 한 시스템의 장애가 다른 시스템에 영향을 미치지 않아야 합니다.</li></ol><h3 id=주요-원리-및-작동-원리-1>주요 원리 및 작동 원리<a hidden class=anchor aria-hidden=true href=#주요-원리-및-작동-원리-1>#</a></h3><p>메시지 브로커와 이벤트 브로커의 작동 원리는 다음과 같습니다:</p><h4 id=메시지-브로커-작동-원리>메시지 브로커 작동 원리<a hidden class=anchor aria-hidden=true href=#메시지-브로커-작동-원리>#</a></h4><ol><li><strong>메시지 생성(Production)</strong>: 생산자(Producer)가 메시지를 생성하여 브로커에 전송합니다.</li><li><strong>메시지 수신 및 검증</strong>: 브로커는 메시지를 수신하고 유효성을 검증합니다.</li><li><strong>메시지 라우팅</strong>: 브로커는 메시지의 라우팅 키나 주제(Topic)에 따라 메시지를 적절한 큐나 교환소(Exchange)로 라우팅합니다.</li><li><strong>메시지 저장</strong>: 메시지는 큐에 저장되어 소비자가 처리할 수 있을 때까지 대기합니다.</li><li><strong>메시지 소비(Consumption)</strong>: 소비자(Consumer)는 큐에서 메시지를 가져와 처리합니다.</li><li><strong>확인(Acknowledgment)</strong>: 메시지 처리가 완료되면 소비자는 브로커에게 확인 메시지를 보내고, 브로커는 해당 메시지를 큐에서 제거합니다.</li></ol><h4 id=이벤트-브로커-작동-원리>이벤트 브로커 작동 원리<a hidden class=anchor aria-hidden=true href=#이벤트-브로커-작동-원리>#</a></h4><ol><li><strong>이벤트 생성(Publication)</strong>: 생산자(Publisher)가 이벤트를 생성하여 브로커에 발행(Publish)합니다.</li><li><strong>이벤트 저장</strong>: 이벤트는 로그 형태로 영구적으로 저장됩니다.</li><li><strong>이벤트 구독(Subscription)</strong>: 소비자(Subscriber)는 특정 주제(Topic)나 파티션(Partition)을 구독합니다.</li><li><strong>이벤트 배포</strong>: 브로커는 이벤트를 관련된 구독자에게 전달합니다.</li><li><strong>이벤트 소비(Consumption)</strong>: 구독자는 이벤트를 받아 처리합니다. 이때 이벤트는 로그에서 삭제되지 않고 유지됩니다.</li><li><strong>오프셋 관리</strong>: 소비자는 자신이 어디까지 이벤트를 소비했는지에 대한 오프셋(Offset)을 관리하며, 필요시 이전 이벤트부터 다시 소비할 수 있습니다.</li></ol><p><figure><img alt="메시지/이벤트 브로커 작동 원리" loading=lazy src=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3sCkXJ9vpWbIkL0q_6V9Rg.png></figure></p><h3 id=구조-및-아키텍처-1>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처-1>#</a></h3><h4 id=메시지-브로커-아키텍처>메시지 브로커 아키텍처<a hidden class=anchor aria-hidden=true href=#메시지-브로커-아키텍처>#</a></h4><p>메시지 브로커 시스템은 다음과 같은 주요 구성 요소로 이루어져 있습니다:</p><h5 id=필수-구성요소-1>필수 구성요소<a hidden class=anchor aria-hidden=true href=#필수-구성요소-1>#</a></h5><ol><li><strong>브로커(Broker)</strong>: 메시지 라우팅과 전달을 담당하는 중심 구성 요소입니다.</li><li><strong>교환소(Exchange)</strong>: 생산자로부터 받은 메시지를 라우팅 규칙에 따라 적절한 큐로 전달하는 역할을 합니다.</li><li><strong>큐(Queue)</strong>: 메시지가 소비자에게 전달되기 전에 임시 저장되는 공간입니다.</li><li><strong>바인딩(Binding)</strong>: 교환소와 큐를 연결하는 규칙으로, 어떤 메시지가 어떤 큐로 전달될지 결정합니다.</li><li><strong>생산자(Producer)</strong>: 메시지를 생성하여 브로커에게 전송하는 역할을 합니다.</li><li><strong>소비자(Consumer)</strong>: 큐에서 메시지를 가져와 처리하는 역할을 합니다.</li></ol><h5 id=선택-구성요소-1>선택 구성요소<a hidden class=anchor aria-hidden=true href=#선택-구성요소-1>#</a></h5><ol><li><strong>가상 호스트(Virtual Host)</strong>: 여러 사용자나 애플리케이션이 동일한 브로커를 독립적으로 사용할 수 있도록 논리적으로 분리하는 기능입니다.</li><li><strong>메시지 우선순위(Priority)</strong>: 특정 메시지에 우선순위를 부여하여 처리 순서를 조정할 수 있습니다.</li><li><strong>메시지 TTL(Time-To-Live)</strong>: 메시지가 큐에서 얼마나 오래 유지될지 설정할 수 있습니다.</li><li><strong>데드 레터 교환소(Dead Letter Exchange)</strong>: 처리에 실패한 메시지를 별도로 관리할 수 있는 특수 교환소입니다.</li><li><strong>클러스터링(Clustering)</strong>: 고가용성과 확장성을 위해 여러 브로커 노드를 연결할 수 있습니다.</li></ol><h5 id=메시지-브로커-아키텍처-다이어그램>메시지 브로커 아키텍처 다이어그램<a hidden class=anchor aria-hidden=true href=#메시지-브로커-아키텍처-다이어그램>#</a></h5><p><figure><img alt="메시지 브로커 아키텍처" loading=lazy src=https://www.cloudamqp.com/img/blog/rabbitmq-beginners-updated.png></figure></p><h4 id=이벤트-브로커-아키텍처>이벤트 브로커 아키텍처<a hidden class=anchor aria-hidden=true href=#이벤트-브로커-아키텍처>#</a></h4><p>이벤트 브로커 시스템은 다음과 같은 주요 구성 요소로 이루어져 있습니다:</p><h5 id=필수-구성요소-2>필수 구성요소<a hidden class=anchor aria-hidden=true href=#필수-구성요소-2>#</a></h5><ol><li><strong>브로커(Broker)</strong>: 이벤트 수신, 저장, 전달을 담당하는 중심 노드입니다.</li><li><strong>주제(Topic)</strong>: 관련 이벤트를 그룹화하는 논리적 채널입니다.</li><li><strong>파티션(Partition)</strong>: 주제 내에서 이벤트를 분산 저장하고 병렬 처리하기 위한 물리적 분할입니다.</li><li><strong>로그(Log)</strong>: 이벤트가 영구적으로 저장되는 순차적 데이터 구조입니다.</li><li><strong>생산자(Producer)</strong>: 이벤트를 생성하여 브로커에게 전송하는 역할을 합니다.</li><li><strong>소비자(Consumer)</strong>: 브로커로부터 이벤트를 가져와 처리하는 역할을 합니다.</li><li><strong>소비자 그룹(Consumer Group)</strong>: 동일한 이벤트 스트림을 처리하는 소비자들의 집합입니다.</li></ol><h5 id=선택-구성요소-2>선택 구성요소<a hidden class=anchor aria-hidden=true href=#선택-구성요소-2>#</a></h5><ol><li><strong>레플리케이션(Replication)</strong>: 고가용성을 위해 파티션 데이터를 여러 브로커에 복제합니다.</li><li><strong>지연 주제(Delayed Topic)</strong>: 특정 시간 후에 처리되어야 하는 이벤트를 위한 특수 주제입니다.</li><li><strong>컴팩션(Compaction)</strong>: 동일한 키를 가진 이벤트 중 최신 이벤트만 보존하는 기능입니다.</li><li><strong>스키마 레지스트리(Schema Registry)</strong>: 이벤트 데이터의 스키마를 관리하고 검증하는 컴포넌트입니다.</li><li><strong>스트림 처리(Stream Processing)</strong>: 이벤트 스트림을 실시간으로 변환하고 처리하는 기능입니다.</li></ol><h5 id=이벤트-브로커-아키텍처-다이어그램>이벤트 브로커 아키텍처 다이어그램<a hidden class=anchor aria-hidden=true href=#이벤트-브로커-아키텍처-다이어그램>#</a></h5><p><figure><img alt="이벤트 브로커 아키텍처" loading=lazy src=https://cdn.confluent.io/wp-content/uploads/Kafka_Diagram_Concept2.png></figure></p><h3 id=구현-기법-1>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법-1>#</a></h3><h4 id=1-발행-구독publish-subscribe-패턴>1. 발행-구독(Publish-Subscribe) 패턴<a hidden class=anchor aria-hidden=true href=#1-발행-구독publish-subscribe-패턴>#</a></h4><p><strong>정의</strong>: 메시지 발행자(Publisher)가 특정 주제(Topic)나 채널에 메시지를 게시하고, 해당 주제를 구독한 모든 구독자(Subscriber)에게 메시지가 전달되는 방식입니다.</p><p><strong>구성</strong>:</p><ul><li>발행자(Publisher): 주제(Topic)에 메시지를 발행합니다.</li><li>주제(Topic): 메시지를 카테고리별로 분류합니다.</li><li>구독자(Subscriber): 특정 주제(Topic)를 구독하고 관련 메시지를 수신합니다.</li></ul><p><strong>목적</strong>:</p><ul><li>발행자와 구독자 간의 느슨한 결합을 제공합니다.</li><li>일대다(one-to-many) 통신을 가능하게 합니다.</li><li>비동기 메시지 전달을 지원합니다.</li></ul><p><strong>실제 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-33-1><a class=lnlinks href=#hl-33-1> 1</a>
</span><span class=lnt id=hl-33-2><a class=lnlinks href=#hl-33-2> 2</a>
</span><span class=lnt id=hl-33-3><a class=lnlinks href=#hl-33-3> 3</a>
</span><span class=lnt id=hl-33-4><a class=lnlinks href=#hl-33-4> 4</a>
</span><span class=lnt id=hl-33-5><a class=lnlinks href=#hl-33-5> 5</a>
</span><span class=lnt id=hl-33-6><a class=lnlinks href=#hl-33-6> 6</a>
</span><span class=lnt id=hl-33-7><a class=lnlinks href=#hl-33-7> 7</a>
</span><span class=lnt id=hl-33-8><a class=lnlinks href=#hl-33-8> 8</a>
</span><span class=lnt id=hl-33-9><a class=lnlinks href=#hl-33-9> 9</a>
</span><span class=lnt id=hl-33-10><a class=lnlinks href=#hl-33-10>10</a>
</span><span class=lnt id=hl-33-11><a class=lnlinks href=#hl-33-11>11</a>
</span><span class=lnt id=hl-33-12><a class=lnlinks href=#hl-33-12>12</a>
</span><span class=lnt id=hl-33-13><a class=lnlinks href=#hl-33-13>13</a>
</span><span class=lnt id=hl-33-14><a class=lnlinks href=#hl-33-14>14</a>
</span><span class=lnt id=hl-33-15><a class=lnlinks href=#hl-33-15>15</a>
</span><span class=lnt id=hl-33-16><a class=lnlinks href=#hl-33-16>16</a>
</span><span class=lnt id=hl-33-17><a class=lnlinks href=#hl-33-17>17</a>
</span><span class=lnt id=hl-33-18><a class=lnlinks href=#hl-33-18>18</a>
</span><span class=lnt id=hl-33-19><a class=lnlinks href=#hl-33-19>19</a>
</span><span class=lnt id=hl-33-20><a class=lnlinks href=#hl-33-20>20</a>
</span><span class=lnt id=hl-33-21><a class=lnlinks href=#hl-33-21>21</a>
</span><span class=lnt id=hl-33-22><a class=lnlinks href=#hl-33-22>22</a>
</span><span class=lnt id=hl-33-23><a class=lnlinks href=#hl-33-23>23</a>
</span><span class=lnt id=hl-33-24><a class=lnlinks href=#hl-33-24>24</a>
</span><span class=lnt id=hl-33-25><a class=lnlinks href=#hl-33-25>25</a>
</span><span class=lnt id=hl-33-26><a class=lnlinks href=#hl-33-26>26</a>
</span><span class=lnt id=hl-33-27><a class=lnlinks href=#hl-33-27>27</a>
</span><span class=lnt id=hl-33-28><a class=lnlinks href=#hl-33-28>28</a>
</span><span class=lnt id=hl-33-29><a class=lnlinks href=#hl-33-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>// Apache Kafka를 사용한 발행-구독 패턴 예시 (Java)
</span></span><span class=line><span class=cl>// 발행자 코드
</span></span><span class=line><span class=cl>Properties props = new Properties();
</span></span><span class=line><span class=cl>props.put(&#34;bootstrap.servers&#34;, &#34;localhost:9092&#34;);
</span></span><span class=line><span class=cl>props.put(&#34;key.serializer&#34;, &#34;org.apache.kafka.common.serialization.StringSerializer&#34;);
</span></span><span class=line><span class=cl>props.put(&#34;value.serializer&#34;, &#34;org.apache.kafka.common.serialization.StringSerializer&#34;);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Producer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(props);
</span></span><span class=line><span class=cl>ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(&#34;my-topic&#34;, &#34;key&#34;, &#34;message-value&#34;);
</span></span><span class=line><span class=cl>producer.send(record);
</span></span><span class=line><span class=cl>producer.close();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 구독자 코드
</span></span><span class=line><span class=cl>Properties props = new Properties();
</span></span><span class=line><span class=cl>props.put(&#34;bootstrap.servers&#34;, &#34;localhost:9092&#34;);
</span></span><span class=line><span class=cl>props.put(&#34;group.id&#34;, &#34;consumer-group&#34;);
</span></span><span class=line><span class=cl>props.put(&#34;key.deserializer&#34;, &#34;org.apache.kafka.common.serialization.StringDeserializer&#34;);
</span></span><span class=line><span class=cl>props.put(&#34;value.deserializer&#34;, &#34;org.apache.kafka.common.serialization.StringDeserializer&#34;);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Consumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props);
</span></span><span class=line><span class=cl>consumer.subscribe(Arrays.asList(&#34;my-topic&#34;));
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>while (true) {
</span></span><span class=line><span class=cl>    ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMillis(100));
</span></span><span class=line><span class=cl>    for (ConsumerRecord&lt;String, String&gt; record : records) {
</span></span><span class=line><span class=cl>        System.out.printf(&#34;topic = %s, partition = %d, offset = %d, key = %s, value = %s%n&#34;,
</span></span><span class=line><span class=cl>                record.topic(), record.partition(), record.offset(), record.key(), record.value());
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h4 id=2-점대점point-to-point-패턴>2. 점대점(Point-to-Point) 패턴<a hidden class=anchor aria-hidden=true href=#2-점대점point-to-point-패턴>#</a></h4><p><strong>정의</strong>: 메시지 발신자가 특정 큐에 메시지를 전송하고, 하나의 소비자만이 해당 메시지를 처리하는 방식입니다.</p><p><strong>구성</strong>:</p><ul><li>발신자(Sender): 큐에 메시지를 전송합니다.</li><li>큐(Queue): 메시지를 일시적으로 저장합니다.</li><li>수신자(Receiver): 큐에서 메시지를 가져와 처리합니다.</li></ul><p><strong>목적</strong>:</p><ul><li>메시지가 정확히 한 번만 처리되도록 보장합니다.</li><li>부하 분산을 위해 여러 수신자 간에 메시지를 분배할 수 있습니다.</li><li>메시지의 순서 보장을 지원합니다.</li></ul><p><strong>실제 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-34-1><a class=lnlinks href=#hl-34-1> 1</a>
</span><span class=lnt id=hl-34-2><a class=lnlinks href=#hl-34-2> 2</a>
</span><span class=lnt id=hl-34-3><a class=lnlinks href=#hl-34-3> 3</a>
</span><span class=lnt id=hl-34-4><a class=lnlinks href=#hl-34-4> 4</a>
</span><span class=lnt id=hl-34-5><a class=lnlinks href=#hl-34-5> 5</a>
</span><span class=lnt id=hl-34-6><a class=lnlinks href=#hl-34-6> 6</a>
</span><span class=lnt id=hl-34-7><a class=lnlinks href=#hl-34-7> 7</a>
</span><span class=lnt id=hl-34-8><a class=lnlinks href=#hl-34-8> 8</a>
</span><span class=lnt id=hl-34-9><a class=lnlinks href=#hl-34-9> 9</a>
</span><span class=lnt id=hl-34-10><a class=lnlinks href=#hl-34-10>10</a>
</span><span class=lnt id=hl-34-11><a class=lnlinks href=#hl-34-11>11</a>
</span><span class=lnt id=hl-34-12><a class=lnlinks href=#hl-34-12>12</a>
</span><span class=lnt id=hl-34-13><a class=lnlinks href=#hl-34-13>13</a>
</span><span class=lnt id=hl-34-14><a class=lnlinks href=#hl-34-14>14</a>
</span><span class=lnt id=hl-34-15><a class=lnlinks href=#hl-34-15>15</a>
</span><span class=lnt id=hl-34-16><a class=lnlinks href=#hl-34-16>16</a>
</span><span class=lnt id=hl-34-17><a class=lnlinks href=#hl-34-17>17</a>
</span><span class=lnt id=hl-34-18><a class=lnlinks href=#hl-34-18>18</a>
</span><span class=lnt id=hl-34-19><a class=lnlinks href=#hl-34-19>19</a>
</span><span class=lnt id=hl-34-20><a class=lnlinks href=#hl-34-20>20</a>
</span><span class=lnt id=hl-34-21><a class=lnlinks href=#hl-34-21>21</a>
</span><span class=lnt id=hl-34-22><a class=lnlinks href=#hl-34-22>22</a>
</span><span class=lnt id=hl-34-23><a class=lnlinks href=#hl-34-23>23</a>
</span><span class=lnt id=hl-34-24><a class=lnlinks href=#hl-34-24>24</a>
</span><span class=lnt id=hl-34-25><a class=lnlinks href=#hl-34-25>25</a>
</span><span class=lnt id=hl-34-26><a class=lnlinks href=#hl-34-26>26</a>
</span><span class=lnt id=hl-34-27><a class=lnlinks href=#hl-34-27>27</a>
</span><span class=lnt id=hl-34-28><a class=lnlinks href=#hl-34-28>28</a>
</span><span class=lnt id=hl-34-29><a class=lnlinks href=#hl-34-29>29</a>
</span><span class=lnt id=hl-34-30><a class=lnlinks href=#hl-34-30>30</a>
</span><span class=lnt id=hl-34-31><a class=lnlinks href=#hl-34-31>31</a>
</span><span class=lnt id=hl-34-32><a class=lnlinks href=#hl-34-32>32</a>
</span><span class=lnt id=hl-34-33><a class=lnlinks href=#hl-34-33>33</a>
</span><span class=lnt id=hl-34-34><a class=lnlinks href=#hl-34-34>34</a>
</span><span class=lnt id=hl-34-35><a class=lnlinks href=#hl-34-35>35</a>
</span><span class=lnt id=hl-34-36><a class=lnlinks href=#hl-34-36>36</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>// RabbitMQ를 사용한 점대점 패턴 예시 (Java)
</span></span><span class=line><span class=cl>// 발신자 코드
</span></span><span class=line><span class=cl>ConnectionFactory factory = new ConnectionFactory();
</span></span><span class=line><span class=cl>factory.setHost(&#34;localhost&#34;);
</span></span><span class=line><span class=cl>try (Connection connection = factory.newConnection();
</span></span><span class=line><span class=cl>     Channel channel = connection.createChannel()) {
</span></span><span class=line><span class=cl>    String queueName = &#34;work-queue&#34;;
</span></span><span class=line><span class=cl>    channel.queueDeclare(queueName, true, false, false, null);
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    String message = &#34;Task message&#34;;
</span></span><span class=line><span class=cl>    channel.basicPublish(&#34;&#34;, queueName, MessageProperties.PERSISTENT_TEXT_PLAIN, message.getBytes());
</span></span><span class=line><span class=cl>    System.out.println(&#34; [x] Sent &#39;&#34; + message + &#34;&#39;&#34;);
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 수신자 코드
</span></span><span class=line><span class=cl>ConnectionFactory factory = new ConnectionFactory();
</span></span><span class=line><span class=cl>factory.setHost(&#34;localhost&#34;);
</span></span><span class=line><span class=cl>Connection connection = factory.newConnection();
</span></span><span class=line><span class=cl>Channel channel = connection.createChannel();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>String queueName = &#34;work-queue&#34;;
</span></span><span class=line><span class=cl>channel.queueDeclare(queueName, true, false, false, null);
</span></span><span class=line><span class=cl>System.out.println(&#34; [*] Waiting for messages.&#34;);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>channel.basicQos(1); // 한 번에 하나의 메시지만 처리
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>DeliverCallback deliverCallback = (consumerTag, delivery) -&gt; {
</span></span><span class=line><span class=cl>    String message = new String(delivery.getBody(), &#34;UTF-8&#34;);
</span></span><span class=line><span class=cl>    System.out.println(&#34; [x] Received &#39;&#34; + message + &#34;&#39;&#34;);
</span></span><span class=line><span class=cl>    try {
</span></span><span class=line><span class=cl>        doWork(message); // 메시지 처리 작업
</span></span><span class=line><span class=cl>    } finally {
</span></span><span class=line><span class=cl>        channel.basicAck(delivery.getEnvelope().getDeliveryTag(), false); // 메시지 확인
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>};
</span></span><span class=line><span class=cl>channel.basicConsume(queueName, false, deliverCallback, consumerTag -&gt; { });
</span></span></code></pre></td></tr></table></div></div><h4 id=3-요청-응답request-reply-패턴>3. 요청-응답(Request-Reply) 패턴<a hidden class=anchor aria-hidden=true href=#3-요청-응답request-reply-패턴>#</a></h4><p><strong>정의</strong>: 클라이언트가 서버에 요청 메시지를 보내고, 서버가 응답 메시지를 반환하는 방식입니다.</p><p><strong>구성</strong>:</p><ul><li>클라이언트(Client): 요청 메시지를 전송하고 응답을 기다립니다.</li><li>서버(Server): 요청 메시지를 처리하고 응답 메시지를 생성합니다.</li><li>요청 큐(Request Queue): 클라이언트의 요청 메시지가 저장됩니다.</li><li>응답 큐(Reply Queue): 서버의 응답 메시지가 저장됩니다.</li></ul><p><strong>목적</strong>:</p><ul><li>비동기적 요청-응답 패턴을 구현합니다.</li><li>분산 시스템에서 RPC(Remote Procedure Call)를 구현할 수 있습니다.</li><li>클라이언트와 서버 간의 느슨한 결합을 제공합니다.</li></ul><p><strong>실제 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-35-1><a class=lnlinks href=#hl-35-1> 1</a>
</span><span class=lnt id=hl-35-2><a class=lnlinks href=#hl-35-2> 2</a>
</span><span class=lnt id=hl-35-3><a class=lnlinks href=#hl-35-3> 3</a>
</span><span class=lnt id=hl-35-4><a class=lnlinks href=#hl-35-4> 4</a>
</span><span class=lnt id=hl-35-5><a class=lnlinks href=#hl-35-5> 5</a>
</span><span class=lnt id=hl-35-6><a class=lnlinks href=#hl-35-6> 6</a>
</span><span class=lnt id=hl-35-7><a class=lnlinks href=#hl-35-7> 7</a>
</span><span class=lnt id=hl-35-8><a class=lnlinks href=#hl-35-8> 8</a>
</span><span class=lnt id=hl-35-9><a class=lnlinks href=#hl-35-9> 9</a>
</span><span class=lnt id=hl-35-10><a class=lnlinks href=#hl-35-10>10</a>
</span><span class=lnt id=hl-35-11><a class=lnlinks href=#hl-35-11>11</a>
</span><span class=lnt id=hl-35-12><a class=lnlinks href=#hl-35-12>12</a>
</span><span class=lnt id=hl-35-13><a class=lnlinks href=#hl-35-13>13</a>
</span><span class=lnt id=hl-35-14><a class=lnlinks href=#hl-35-14>14</a>
</span><span class=lnt id=hl-35-15><a class=lnlinks href=#hl-35-15>15</a>
</span><span class=lnt id=hl-35-16><a class=lnlinks href=#hl-35-16>16</a>
</span><span class=lnt id=hl-35-17><a class=lnlinks href=#hl-35-17>17</a>
</span><span class=lnt id=hl-35-18><a class=lnlinks href=#hl-35-18>18</a>
</span><span class=lnt id=hl-35-19><a class=lnlinks href=#hl-35-19>19</a>
</span><span class=lnt id=hl-35-20><a class=lnlinks href=#hl-35-20>20</a>
</span><span class=lnt id=hl-35-21><a class=lnlinks href=#hl-35-21>21</a>
</span><span class=lnt id=hl-35-22><a class=lnlinks href=#hl-35-22>22</a>
</span><span class=lnt id=hl-35-23><a class=lnlinks href=#hl-35-23>23</a>
</span><span class=lnt id=hl-35-24><a class=lnlinks href=#hl-35-24>24</a>
</span><span class=lnt id=hl-35-25><a class=lnlinks href=#hl-35-25>25</a>
</span><span class=lnt id=hl-35-26><a class=lnlinks href=#hl-35-26>26</a>
</span><span class=lnt id=hl-35-27><a class=lnlinks href=#hl-35-27>27</a>
</span><span class=lnt id=hl-35-28><a class=lnlinks href=#hl-35-28>28</a>
</span><span class=lnt id=hl-35-29><a class=lnlinks href=#hl-35-29>29</a>
</span><span class=lnt id=hl-35-30><a class=lnlinks href=#hl-35-30>30</a>
</span><span class=lnt id=hl-35-31><a class=lnlinks href=#hl-35-31>31</a>
</span><span class=lnt id=hl-35-32><a class=lnlinks href=#hl-35-32>32</a>
</span><span class=lnt id=hl-35-33><a class=lnlinks href=#hl-35-33>33</a>
</span><span class=lnt id=hl-35-34><a class=lnlinks href=#hl-35-34>34</a>
</span><span class=lnt id=hl-35-35><a class=lnlinks href=#hl-35-35>35</a>
</span><span class=lnt id=hl-35-36><a class=lnlinks href=#hl-35-36>36</a>
</span><span class=lnt id=hl-35-37><a class=lnlinks href=#hl-35-37>37</a>
</span><span class=lnt id=hl-35-38><a class=lnlinks href=#hl-35-38>38</a>
</span><span class=lnt id=hl-35-39><a class=lnlinks href=#hl-35-39>39</a>
</span><span class=lnt id=hl-35-40><a class=lnlinks href=#hl-35-40>40</a>
</span><span class=lnt id=hl-35-41><a class=lnlinks href=#hl-35-41>41</a>
</span><span class=lnt id=hl-35-42><a class=lnlinks href=#hl-35-42>42</a>
</span><span class=lnt id=hl-35-43><a class=lnlinks href=#hl-35-43>43</a>
</span><span class=lnt id=hl-35-44><a class=lnlinks href=#hl-35-44>44</a>
</span><span class=lnt id=hl-35-45><a class=lnlinks href=#hl-35-45>45</a>
</span><span class=lnt id=hl-35-46><a class=lnlinks href=#hl-35-46>46</a>
</span><span class=lnt id=hl-35-47><a class=lnlinks href=#hl-35-47>47</a>
</span><span class=lnt id=hl-35-48><a class=lnlinks href=#hl-35-48>48</a>
</span><span class=lnt id=hl-35-49><a class=lnlinks href=#hl-35-49>49</a>
</span><span class=lnt id=hl-35-50><a class=lnlinks href=#hl-35-50>50</a>
</span><span class=lnt id=hl-35-51><a class=lnlinks href=#hl-35-51>51</a>
</span><span class=lnt id=hl-35-52><a class=lnlinks href=#hl-35-52>52</a>
</span><span class=lnt id=hl-35-53><a class=lnlinks href=#hl-35-53>53</a>
</span><span class=lnt id=hl-35-54><a class=lnlinks href=#hl-35-54>54</a>
</span><span class=lnt id=hl-35-55><a class=lnlinks href=#hl-35-55>55</a>
</span><span class=lnt id=hl-35-56><a class=lnlinks href=#hl-35-56>56</a>
</span><span class=lnt id=hl-35-57><a class=lnlinks href=#hl-35-57>57</a>
</span><span class=lnt id=hl-35-58><a class=lnlinks href=#hl-35-58>58</a>
</span><span class=lnt id=hl-35-59><a class=lnlinks href=#hl-35-59>59</a>
</span><span class=lnt id=hl-35-60><a class=lnlinks href=#hl-35-60>60</a>
</span><span class=lnt id=hl-35-61><a class=lnlinks href=#hl-35-61>61</a>
</span><span class=lnt id=hl-35-62><a class=lnlinks href=#hl-35-62>62</a>
</span><span class=lnt id=hl-35-63><a class=lnlinks href=#hl-35-63>63</a>
</span><span class=lnt id=hl-35-64><a class=lnlinks href=#hl-35-64>64</a>
</span><span class=lnt id=hl-35-65><a class=lnlinks href=#hl-35-65>65</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>// RabbitMQ를 사용한 요청-응답 패턴 예시 (Java)
</span></span><span class=line><span class=cl>// 클라이언트 코드
</span></span><span class=line><span class=cl>ConnectionFactory factory = new ConnectionFactory();
</span></span><span class=line><span class=cl>factory.setHost(&#34;localhost&#34;);
</span></span><span class=line><span class=cl>try (Connection connection = factory.newConnection();
</span></span><span class=line><span class=cl>     Channel channel = connection.createChannel()) {
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    String requestQueueName = &#34;rpc_queue&#34;;
</span></span><span class=line><span class=cl>    String replyQueueName = channel.queueDeclare().getQueue();
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    AMQP.BasicProperties props = new AMQP.BasicProperties
</span></span><span class=line><span class=cl>            .Builder()
</span></span><span class=line><span class=cl>            .correlationId(UUID.randomUUID().toString())
</span></span><span class=line><span class=cl>            .replyTo(replyQueueName)
</span></span><span class=line><span class=cl>            .build();
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    String message = &#34;10&#34;; // 요청 메시지 (예: 피보나치 수열의 10번째 숫자 요청)
</span></span><span class=line><span class=cl>    channel.basicPublish(&#34;&#34;, requestQueueName, props, message.getBytes());
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    // 응답 대기
</span></span><span class=line><span class=cl>    final BlockingQueue&lt;String&gt; response = new ArrayBlockingQueue&lt;&gt;(1);
</span></span><span class=line><span class=cl>    String ctag = channel.basicConsume(replyQueueName, true, (consumerTag, delivery) -&gt; {
</span></span><span class=line><span class=cl>        if (delivery.getProperties().getCorrelationId().equals(props.getCorrelationId())) {
</span></span><span class=line><span class=cl>            response.offer(new String(delivery.getBody(), &#34;UTF-8&#34;));
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>    }, consumerTag -&gt; { });
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    String result = response.take();
</span></span><span class=line><span class=cl>    channel.basicCancel(ctag);
</span></span><span class=line><span class=cl>    System.out.println(&#34;Got &#39;&#34; + result + &#34;&#39;&#34;);
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 서버 코드
</span></span><span class=line><span class=cl>ConnectionFactory factory = new ConnectionFactory();
</span></span><span class=line><span class=cl>factory.setHost(&#34;localhost&#34;);
</span></span><span class=line><span class=cl>Connection connection = factory.newConnection();
</span></span><span class=line><span class=cl>Channel channel = connection.createChannel();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>String queueName = &#34;rpc_queue&#34;;
</span></span><span class=line><span class=cl>channel.queueDeclare(queueName, false, false, false, null);
</span></span><span class=line><span class=cl>channel.basicQos(1);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>System.out.println(&#34; [x] Awaiting RPC requests&#34;);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>DeliverCallback deliverCallback = (consumerTag, delivery) -&gt; {
</span></span><span class=line><span class=cl>    AMQP.BasicProperties replyProps = new AMQP.BasicProperties
</span></span><span class=line><span class=cl>            .Builder()
</span></span><span class=line><span class=cl>            .correlationId(delivery.getProperties().getCorrelationId())
</span></span><span class=line><span class=cl>            .build();
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    String response = &#34;&#34;;
</span></span><span class=line><span class=cl>    try {
</span></span><span class=line><span class=cl>        String message = new String(delivery.getBody(), &#34;UTF-8&#34;);
</span></span><span class=line><span class=cl>        int n = Integer.parseInt(message);
</span></span><span class=line><span class=cl>        System.out.println(&#34; [.] fib(&#34; + message + &#34;)&#34;);
</span></span><span class=line><span class=cl>        response += fib(n); // 피보나치 수열 계산
</span></span><span class=line><span class=cl>    } catch (RuntimeException e) {
</span></span><span class=line><span class=cl>        System.out.println(&#34; [.] &#34; + e.toString());
</span></span><span class=line><span class=cl>    } finally {
</span></span><span class=line><span class=cl>        channel.basicPublish(&#34;&#34;, delivery.getProperties().getReplyTo(), replyProps, response.getBytes(&#34;UTF-8&#34;));
</span></span><span class=line><span class=cl>        channel.basicAck(delivery.getEnvelope().getDeliveryTag(), false);
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>};
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>channel.basicConsume(queueName, false, deliverCallback, (consumerTag -&gt; {}));
</span></span></code></pre></td></tr></table></div></div><h4 id=4-이벤트-소싱event-sourcing-패턴>4. 이벤트 소싱(Event Sourcing) 패턴<a hidden class=anchor aria-hidden=true href=#4-이벤트-소싱event-sourcing-패턴>#</a></h4><p><strong>정의</strong>: 시스템의 상태 변화를 일련의 이벤트로 저장하고, 이벤트를 재생하여 현재 상태를 복원하는 방식입니다.</p><p><strong>구성</strong>:</p><ul><li>이벤트 저장소(Event Store): 모든 이벤트를 시간 순서대로 저장합니다.</li><li>이벤트 생성자(Event Producer): 상태 변화를 이벤트로 발행합니다.</li><li>이벤트 소비자(Event Consumer): 이벤트를 처리하여 시스템 상태를 업데이트합니다.</li><li>스냅샷(Snapshot): 성능 향상을 위해 특정 시점의 시스템 상태를 저장합니다.</li></ul><p><strong>목적</strong>:</p><ul><li>시스템의 모든 상태 변화에 대한 감사 추적(audit trail)을 제공합니다.</li><li>시스템 상태를 특정 시점으로 복원할 수 있는 시간 여행(time travel) 기능을 지원합니다.</li><li>상태 변화의 이유와 의도를 명확하게 표현할 수 있습니다.</li><li>높은 확장성과 동시성을 제공합니다.</li></ul><p><strong>실제 예시(시스템 구성)</strong>:</p><ul><li>이벤트 저장소: Apache Kafka, Event Store DB</li><li>이벤트 처리: Spring Cloud Stream, Akka Streams</li><li>스냅샷 저장소: MongoDB, PostgreSQL</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-36-1><a class=lnlinks href=#hl-36-1> 1</a>
</span><span class=lnt id=hl-36-2><a class=lnlinks href=#hl-36-2> 2</a>
</span><span class=lnt id=hl-36-3><a class=lnlinks href=#hl-36-3> 3</a>
</span><span class=lnt id=hl-36-4><a class=lnlinks href=#hl-36-4> 4</a>
</span><span class=lnt id=hl-36-5><a class=lnlinks href=#hl-36-5> 5</a>
</span><span class=lnt id=hl-36-6><a class=lnlinks href=#hl-36-6> 6</a>
</span><span class=lnt id=hl-36-7><a class=lnlinks href=#hl-36-7> 7</a>
</span><span class=lnt id=hl-36-8><a class=lnlinks href=#hl-36-8> 8</a>
</span><span class=lnt id=hl-36-9><a class=lnlinks href=#hl-36-9> 9</a>
</span><span class=lnt id=hl-36-10><a class=lnlinks href=#hl-36-10>10</a>
</span><span class=lnt id=hl-36-11><a class=lnlinks href=#hl-36-11>11</a>
</span><span class=lnt id=hl-36-12><a class=lnlinks href=#hl-36-12>12</a>
</span><span class=lnt id=hl-36-13><a class=lnlinks href=#hl-36-13>13</a>
</span><span class=lnt id=hl-36-14><a class=lnlinks href=#hl-36-14>14</a>
</span><span class=lnt id=hl-36-15><a class=lnlinks href=#hl-36-15>15</a>
</span><span class=lnt id=hl-36-16><a class=lnlinks href=#hl-36-16>16</a>
</span><span class=lnt id=hl-36-17><a class=lnlinks href=#hl-36-17>17</a>
</span><span class=lnt id=hl-36-18><a class=lnlinks href=#hl-36-18>18</a>
</span><span class=lnt id=hl-36-19><a class=lnlinks href=#hl-36-19>19</a>
</span><span class=lnt id=hl-36-20><a class=lnlinks href=#hl-36-20>20</a>
</span><span class=lnt id=hl-36-21><a class=lnlinks href=#hl-36-21>21</a>
</span><span class=lnt id=hl-36-22><a class=lnlinks href=#hl-36-22>22</a>
</span><span class=lnt id=hl-36-23><a class=lnlinks href=#hl-36-23>23</a>
</span><span class=lnt id=hl-36-24><a class=lnlinks href=#hl-36-24>24</a>
</span><span class=lnt id=hl-36-25><a class=lnlinks href=#hl-36-25>25</a>
</span><span class=lnt id=hl-36-26><a class=lnlinks href=#hl-36-26>26</a>
</span><span class=lnt id=hl-36-27><a class=lnlinks href=#hl-36-27>27</a>
</span><span class=lnt id=hl-36-28><a class=lnlinks href=#hl-36-28>28</a>
</span><span class=lnt id=hl-36-29><a class=lnlinks href=#hl-36-29>29</a>
</span><span class=lnt id=hl-36-30><a class=lnlinks href=#hl-36-30>30</a>
</span><span class=lnt id=hl-36-31><a class=lnlinks href=#hl-36-31>31</a>
</span><span class=lnt id=hl-36-32><a class=lnlinks href=#hl-36-32>32</a>
</span><span class=lnt id=hl-36-33><a class=lnlinks href=#hl-36-33>33</a>
</span><span class=lnt id=hl-36-34><a class=lnlinks href=#hl-36-34>34</a>
</span><span class=lnt id=hl-36-35><a class=lnlinks href=#hl-36-35>35</a>
</span><span class=lnt id=hl-36-36><a class=lnlinks href=#hl-36-36>36</a>
</span><span class=lnt id=hl-36-37><a class=lnlinks href=#hl-36-37>37</a>
</span><span class=lnt id=hl-36-38><a class=lnlinks href=#hl-36-38>38</a>
</span><span class=lnt id=hl-36-39><a class=lnlinks href=#hl-36-39>39</a>
</span><span class=lnt id=hl-36-40><a class=lnlinks href=#hl-36-40>40</a>
</span><span class=lnt id=hl-36-41><a class=lnlinks href=#hl-36-41>41</a>
</span><span class=lnt id=hl-36-42><a class=lnlinks href=#hl-36-42>42</a>
</span><span class=lnt id=hl-36-43><a class=lnlinks href=#hl-36-43>43</a>
</span><span class=lnt id=hl-36-44><a class=lnlinks href=#hl-36-44>44</a>
</span><span class=lnt id=hl-36-45><a class=lnlinks href=#hl-36-45>45</a>
</span><span class=lnt id=hl-36-46><a class=lnlinks href=#hl-36-46>46</a>
</span><span class=lnt id=hl-36-47><a class=lnlinks href=#hl-36-47>47</a>
</span><span class=lnt id=hl-36-48><a class=lnlinks href=#hl-36-48>48</a>
</span><span class=lnt id=hl-36-49><a class=lnlinks href=#hl-36-49>49</a>
</span><span class=lnt id=hl-36-50><a class=lnlinks href=#hl-36-50>50</a>
</span><span class=lnt id=hl-36-51><a class=lnlinks href=#hl-36-51>51</a>
</span><span class=lnt id=hl-36-52><a class=lnlinks href=#hl-36-52>52</a>
</span><span class=lnt id=hl-36-53><a class=lnlinks href=#hl-36-53>53</a>
</span><span class=lnt id=hl-36-54><a class=lnlinks href=#hl-36-54>54</a>
</span><span class=lnt id=hl-36-55><a class=lnlinks href=#hl-36-55>55</a>
</span><span class=lnt id=hl-36-56><a class=lnlinks href=#hl-36-56>56</a>
</span><span class=lnt id=hl-36-57><a class=lnlinks href=#hl-36-57>57</a>
</span><span class=lnt id=hl-36-58><a class=lnlinks href=#hl-36-58>58</a>
</span><span class=lnt id=hl-36-59><a class=lnlinks href=#hl-36-59>59</a>
</span><span class=lnt id=hl-36-60><a class=lnlinks href=#hl-36-60>60</a>
</span><span class=lnt id=hl-36-61><a class=lnlinks href=#hl-36-61>61</a>
</span><span class=lnt id=hl-36-62><a class=lnlinks href=#hl-36-62>62</a>
</span><span class=lnt id=hl-36-63><a class=lnlinks href=#hl-36-63>63</a>
</span><span class=lnt id=hl-36-64><a class=lnlinks href=#hl-36-64>64</a>
</span><span class=lnt id=hl-36-65><a class=lnlinks href=#hl-36-65>65</a>
</span><span class=lnt id=hl-36-66><a class=lnlinks href=#hl-36-66>66</a>
</span><span class=lnt id=hl-36-67><a class=lnlinks href=#hl-36-67>67</a>
</span><span class=lnt id=hl-36-68><a class=lnlinks href=#hl-36-68>68</a>
</span><span class=lnt id=hl-36-69><a class=lnlinks href=#hl-36-69>69</a>
</span><span class=lnt id=hl-36-70><a class=lnlinks href=#hl-36-70>70</a>
</span><span class=lnt id=hl-36-71><a class=lnlinks href=#hl-36-71>71</a>
</span><span class=lnt id=hl-36-72><a class=lnlinks href=#hl-36-72>72</a>
</span><span class=lnt id=hl-36-73><a class=lnlinks href=#hl-36-73>73</a>
</span><span class=lnt id=hl-36-74><a class=lnlinks href=#hl-36-74>74</a>
</span><span class=lnt id=hl-36-75><a class=lnlinks href=#hl-36-75>75</a>
</span><span class=lnt id=hl-36-76><a class=lnlinks href=#hl-36-76>76</a>
</span><span class=lnt id=hl-36-77><a class=lnlinks href=#hl-36-77>77</a>
</span><span class=lnt id=hl-36-78><a class=lnlinks href=#hl-36-78>78</a>
</span><span class=lnt id=hl-36-79><a class=lnlinks href=#hl-36-79>79</a>
</span><span class=lnt id=hl-36-80><a class=lnlinks href=#hl-36-80>80</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 이벤트 소싱 패턴을 사용한 계좌 관리 예시 (Java)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 이벤트 정의</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>interface</span> <span class=nc>AccountEvent</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>UUID</span><span class=w> </span><span class=nf>getAccountId</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>LocalDateTime</span><span class=w> </span><span class=nf>getTimestamp</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>AccountCreatedEvent</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>AccountEvent</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=n>accountId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>owner</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>timestamp</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 생성자, 게터 등</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MoneyDepositedEvent</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>AccountEvent</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=n>accountId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>amount</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>timestamp</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 생성자, 게터 등</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 계좌 상태 관리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Account</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>owner</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>balance</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>boolean</span><span class=w> </span><span class=n>active</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 이벤트를 적용하여 상태 업데이트</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>apply</span><span class=p>(</span><span class=n>AccountEvent</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>event</span><span class=w> </span><span class=k>instanceof</span><span class=w> </span><span class=n>AccountCreatedEvent</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>apply</span><span class=p>((</span><span class=n>AccountCreatedEvent</span><span class=p>)</span><span class=w> </span><span class=n>event</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>event</span><span class=w> </span><span class=k>instanceof</span><span class=w> </span><span class=n>MoneyDepositedEvent</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>apply</span><span class=p>((</span><span class=n>MoneyDepositedEvent</span><span class=p>)</span><span class=w> </span><span class=n>event</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 다른 이벤트 타입도 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>apply</span><span class=p>(</span><span class=n>AccountCreatedEvent</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>event</span><span class=p>.</span><span class=na>getAccountId</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>owner</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>event</span><span class=p>.</span><span class=na>getOwner</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>balance</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>BigDecimal</span><span class=p>.</span><span class=na>ZERO</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>active</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>apply</span><span class=p>(</span><span class=n>MoneyDepositedEvent</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>balance</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>balance</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getAmount</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 이벤트 저장소</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>interface</span> <span class=nc>EventStore</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>save</span><span class=p>(</span><span class=n>AccountEvent</span><span class=w> </span><span class=n>event</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>List</span><span class=o>&lt;</span><span class=n>AccountEvent</span><span class=o>&gt;</span><span class=w> </span><span class=nf>getEventsForAccount</span><span class=p>(</span><span class=n>UUID</span><span class=w> </span><span class=n>accountId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 계좌 서비스</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>AccountService</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>EventStore</span><span class=w> </span><span class=n>eventStore</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Account</span><span class=w> </span><span class=nf>getAccount</span><span class=p>(</span><span class=n>UUID</span><span class=w> </span><span class=n>accountId</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>AccountEvent</span><span class=o>&gt;</span><span class=w> </span><span class=n>events</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>eventStore</span><span class=p>.</span><span class=na>getEventsForAccount</span><span class=p>(</span><span class=n>accountId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Account</span><span class=w> </span><span class=n>account</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Account</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 모든 이벤트를 재생하여 현재 상태 복원</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>AccountEvent</span><span class=w> </span><span class=n>event</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>events</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>account</span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=n>event</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>account</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>deposit</span><span class=p>(</span><span class=n>UUID</span><span class=w> </span><span class=n>accountId</span><span class=p>,</span><span class=w> </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>amount</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>MoneyDepositedEvent</span><span class=w> </span><span class=n>event</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>MoneyDepositedEvent</span><span class=p>(</span><span class=n>accountId</span><span class=p>,</span><span class=w> </span><span class=n>amount</span><span class=p>,</span><span class=w> </span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>eventStore</span><span class=p>.</span><span class=na>save</span><span class=p>(</span><span class=n>event</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=5-명령-쿼리-책임-분리cqrs-command-query-responsibility-segregation-패턴>5. 명령 쿼리 책임 분리(CQRS: Command Query Responsibility Segregation) 패턴<a hidden class=anchor aria-hidden=true href=#5-명령-쿼리-책임-분리cqrs-command-query-responsibility-segregation-패턴>#</a></h4><p><strong>정의</strong>: 시스템의 명령(상태 변경)과 쿼리(상태 조회)를 분리하여 각각에 최적화된 모델을 사용하는 패턴입니다. 종종 이벤트 소싱과 함께 사용됩니다.</p><p><strong>구성</strong>:</p><ul><li>명령 모델(Command Model): 시스템 상태를 변경하는 작업을 처리합니다.</li><li>쿼리 모델(Query Model): 시스템 상태를 조회하는 작업을 처리합니다.</li><li>이벤트 버스(Event Bus): 명령 모델의 변경 사항을 쿼리 모델에 전파합니다.</li><li>읽기 저장소(Read Store): 쿼리 성능 최적화를 위한 특수한 형태의 데이터 저장소입니다.</li></ul><p><strong>목적</strong>:</p><ul><li>읽기와 쓰기 작업을 분리하여 각각에 최적화된 성능을 제공합니다.</li><li>복잡한 도메인 모델과 간단한 쿼리 모델의 분리를 지원합니다.</li><li>확장성이 높은 시스템 아키텍처를 구현할 수 있습니다.</li><li>읽기 모델과 쓰기 모델 간의 낮은 결합도를 제공합니다.</li></ul><p><strong>실제 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-37-1><a class=lnlinks href=#hl-37-1> 1</a>
</span><span class=lnt id=hl-37-2><a class=lnlinks href=#hl-37-2> 2</a>
</span><span class=lnt id=hl-37-3><a class=lnlinks href=#hl-37-3> 3</a>
</span><span class=lnt id=hl-37-4><a class=lnlinks href=#hl-37-4> 4</a>
</span><span class=lnt id=hl-37-5><a class=lnlinks href=#hl-37-5> 5</a>
</span><span class=lnt id=hl-37-6><a class=lnlinks href=#hl-37-6> 6</a>
</span><span class=lnt id=hl-37-7><a class=lnlinks href=#hl-37-7> 7</a>
</span><span class=lnt id=hl-37-8><a class=lnlinks href=#hl-37-8> 8</a>
</span><span class=lnt id=hl-37-9><a class=lnlinks href=#hl-37-9> 9</a>
</span><span class=lnt id=hl-37-10><a class=lnlinks href=#hl-37-10>10</a>
</span><span class=lnt id=hl-37-11><a class=lnlinks href=#hl-37-11>11</a>
</span><span class=lnt id=hl-37-12><a class=lnlinks href=#hl-37-12>12</a>
</span><span class=lnt id=hl-37-13><a class=lnlinks href=#hl-37-13>13</a>
</span><span class=lnt id=hl-37-14><a class=lnlinks href=#hl-37-14>14</a>
</span><span class=lnt id=hl-37-15><a class=lnlinks href=#hl-37-15>15</a>
</span><span class=lnt id=hl-37-16><a class=lnlinks href=#hl-37-16>16</a>
</span><span class=lnt id=hl-37-17><a class=lnlinks href=#hl-37-17>17</a>
</span><span class=lnt id=hl-37-18><a class=lnlinks href=#hl-37-18>18</a>
</span><span class=lnt id=hl-37-19><a class=lnlinks href=#hl-37-19>19</a>
</span><span class=lnt id=hl-37-20><a class=lnlinks href=#hl-37-20>20</a>
</span><span class=lnt id=hl-37-21><a class=lnlinks href=#hl-37-21>21</a>
</span><span class=lnt id=hl-37-22><a class=lnlinks href=#hl-37-22>22</a>
</span><span class=lnt id=hl-37-23><a class=lnlinks href=#hl-37-23>23</a>
</span><span class=lnt id=hl-37-24><a class=lnlinks href=#hl-37-24>24</a>
</span><span class=lnt id=hl-37-25><a class=lnlinks href=#hl-37-25>25</a>
</span><span class=lnt id=hl-37-26><a class=lnlinks href=#hl-37-26>26</a>
</span><span class=lnt id=hl-37-27><a class=lnlinks href=#hl-37-27>27</a>
</span><span class=lnt id=hl-37-28><a class=lnlinks href=#hl-37-28>28</a>
</span><span class=lnt id=hl-37-29><a class=lnlinks href=#hl-37-29>29</a>
</span><span class=lnt id=hl-37-30><a class=lnlinks href=#hl-37-30>30</a>
</span><span class=lnt id=hl-37-31><a class=lnlinks href=#hl-37-31>31</a>
</span><span class=lnt id=hl-37-32><a class=lnlinks href=#hl-37-32>32</a>
</span><span class=lnt id=hl-37-33><a class=lnlinks href=#hl-37-33>33</a>
</span><span class=lnt id=hl-37-34><a class=lnlinks href=#hl-37-34>34</a>
</span><span class=lnt id=hl-37-35><a class=lnlinks href=#hl-37-35>35</a>
</span><span class=lnt id=hl-37-36><a class=lnlinks href=#hl-37-36>36</a>
</span><span class=lnt id=hl-37-37><a class=lnlinks href=#hl-37-37>37</a>
</span><span class=lnt id=hl-37-38><a class=lnlinks href=#hl-37-38>38</a>
</span><span class=lnt id=hl-37-39><a class=lnlinks href=#hl-37-39>39</a>
</span><span class=lnt id=hl-37-40><a class=lnlinks href=#hl-37-40>40</a>
</span><span class=lnt id=hl-37-41><a class=lnlinks href=#hl-37-41>41</a>
</span><span class=lnt id=hl-37-42><a class=lnlinks href=#hl-37-42>42</a>
</span><span class=lnt id=hl-37-43><a class=lnlinks href=#hl-37-43>43</a>
</span><span class=lnt id=hl-37-44><a class=lnlinks href=#hl-37-44>44</a>
</span><span class=lnt id=hl-37-45><a class=lnlinks href=#hl-37-45>45</a>
</span><span class=lnt id=hl-37-46><a class=lnlinks href=#hl-37-46>46</a>
</span><span class=lnt id=hl-37-47><a class=lnlinks href=#hl-37-47>47</a>
</span><span class=lnt id=hl-37-48><a class=lnlinks href=#hl-37-48>48</a>
</span><span class=lnt id=hl-37-49><a class=lnlinks href=#hl-37-49>49</a>
</span><span class=lnt id=hl-37-50><a class=lnlinks href=#hl-37-50>50</a>
</span><span class=lnt id=hl-37-51><a class=lnlinks href=#hl-37-51>51</a>
</span><span class=lnt id=hl-37-52><a class=lnlinks href=#hl-37-52>52</a>
</span><span class=lnt id=hl-37-53><a class=lnlinks href=#hl-37-53>53</a>
</span><span class=lnt id=hl-37-54><a class=lnlinks href=#hl-37-54>54</a>
</span><span class=lnt id=hl-37-55><a class=lnlinks href=#hl-37-55>55</a>
</span><span class=lnt id=hl-37-56><a class=lnlinks href=#hl-37-56>56</a>
</span><span class=lnt id=hl-37-57><a class=lnlinks href=#hl-37-57>57</a>
</span><span class=lnt id=hl-37-58><a class=lnlinks href=#hl-37-58>58</a>
</span><span class=lnt id=hl-37-59><a class=lnlinks href=#hl-37-59>59</a>
</span><span class=lnt id=hl-37-60><a class=lnlinks href=#hl-37-60>60</a>
</span><span class=lnt id=hl-37-61><a class=lnlinks href=#hl-37-61>61</a>
</span><span class=lnt id=hl-37-62><a class=lnlinks href=#hl-37-62>62</a>
</span><span class=lnt id=hl-37-63><a class=lnlinks href=#hl-37-63>63</a>
</span><span class=lnt id=hl-37-64><a class=lnlinks href=#hl-37-64>64</a>
</span><span class=lnt id=hl-37-65><a class=lnlinks href=#hl-37-65>65</a>
</span><span class=lnt id=hl-37-66><a class=lnlinks href=#hl-37-66>66</a>
</span><span class=lnt id=hl-37-67><a class=lnlinks href=#hl-37-67>67</a>
</span><span class=lnt id=hl-37-68><a class=lnlinks href=#hl-37-68>68</a>
</span><span class=lnt id=hl-37-69><a class=lnlinks href=#hl-37-69>69</a>
</span><span class=lnt id=hl-37-70><a class=lnlinks href=#hl-37-70>70</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// CQRS 패턴 예시 (Java)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 명령 부분</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>interface</span> <span class=nc>AccountCommand</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>UUID</span><span class=w> </span><span class=nf>getAccountId</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>CreateAccountCommand</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>AccountCommand</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=n>accountId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>owner</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 생성자, 게터 등</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>DepositMoneyCommand</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>AccountCommand</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=n>accountId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>amount</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 생성자, 게터 등</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>AccountCommandHandler</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>EventStore</span><span class=w> </span><span class=n>eventStore</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>EventBus</span><span class=w> </span><span class=n>eventBus</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>handle</span><span class=p>(</span><span class=n>CreateAccountCommand</span><span class=w> </span><span class=n>command</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>AccountCreatedEvent</span><span class=w> </span><span class=n>event</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>AccountCreatedEvent</span><span class=p>(</span><span class=n>command</span><span class=p>.</span><span class=na>getAccountId</span><span class=p>(),</span><span class=w> </span><span class=n>command</span><span class=p>.</span><span class=na>getOwner</span><span class=p>(),</span><span class=w> </span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>eventStore</span><span class=p>.</span><span class=na>save</span><span class=p>(</span><span class=n>event</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>eventBus</span><span class=p>.</span><span class=na>publish</span><span class=p>(</span><span class=n>event</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>handle</span><span class=p>(</span><span class=n>DepositMoneyCommand</span><span class=w> </span><span class=n>command</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 필요한 검증 로직</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>MoneyDepositedEvent</span><span class=w> </span><span class=n>event</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>MoneyDepositedEvent</span><span class=p>(</span><span class=n>command</span><span class=p>.</span><span class=na>getAccountId</span><span class=p>(),</span><span class=w> </span><span class=n>command</span><span class=p>.</span><span class=na>getAmount</span><span class=p>(),</span><span class=w> </span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>eventStore</span><span class=p>.</span><span class=na>save</span><span class=p>(</span><span class=n>event</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>eventBus</span><span class=p>.</span><span class=na>publish</span><span class=p>(</span><span class=n>event</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 쿼리 부분</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>AccountQueryService</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>AccountReadRepository</span><span class=w> </span><span class=n>repository</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>AccountDTO</span><span class=w> </span><span class=nf>getAccount</span><span class=p>(</span><span class=n>UUID</span><span class=w> </span><span class=n>accountId</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>repository</span><span class=p>.</span><span class=na>findById</span><span class=p>(</span><span class=n>accountId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>AccountDTO</span><span class=o>&gt;</span><span class=w> </span><span class=nf>findAccountsByOwner</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>owner</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>repository</span><span class=p>.</span><span class=na>findByOwner</span><span class=p>(</span><span class=n>owner</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 이벤트 핸들러 (쿼리 모델 업데이트)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>AccountEventHandler</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>AccountReadRepository</span><span class=w> </span><span class=n>repository</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>on</span><span class=p>(</span><span class=n>AccountCreatedEvent</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>AccountDTO</span><span class=w> </span><span class=n>dto</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>AccountDTO</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>dto</span><span class=p>.</span><span class=na>setId</span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getAccountId</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>dto</span><span class=p>.</span><span class=na>setOwner</span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getOwner</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>dto</span><span class=p>.</span><span class=na>setBalance</span><span class=p>(</span><span class=n>BigDecimal</span><span class=p>.</span><span class=na>ZERO</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>repository</span><span class=p>.</span><span class=na>save</span><span class=p>(</span><span class=n>dto</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>on</span><span class=p>(</span><span class=n>MoneyDepositedEvent</span><span class=w> </span><span class=n>event</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>AccountDTO</span><span class=w> </span><span class=n>dto</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>repository</span><span class=p>.</span><span class=na>findById</span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getAccountId</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>dto</span><span class=p>.</span><span class=na>setBalance</span><span class=p>(</span><span class=n>dto</span><span class=p>.</span><span class=na>getBalance</span><span class=p>().</span><span class=na>add</span><span class=p>(</span><span class=n>event</span><span class=p>.</span><span class=na>getAmount</span><span class=p>()));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>repository</span><span class=p>.</span><span class=na>save</span><span class=p>(</span><span class=n>dto</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=장점과-단점-1>장점과 단점<a hidden class=anchor aria-hidden=true href=#장점과-단점-1>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>✅ 장점</td><td>느슨한 결합(Loose Coupling)</td><td>서비스 간 직접적인 의존성이 없어 각 서비스를 독립적으로 개발, 배포, 확장할 수 있습니다.</td></tr><tr><td></td><td>비동기 통신</td><td>요청-응답 패턴과 달리 즉각적인 응답을 기다리지 않아도 되므로, 시스템 효율성이 향상됩니다.</td></tr><tr><td></td><td>부하 분산</td><td>갑작스러운 트래픽 증가 시에도 메시지를 버퍼링하여 순차적으로 처리할 수 있어 시스템 안정성이 높아집니다.</td></tr><tr><td></td><td>장애 격리</td><td>한 서비스의 장애가 다른 서비스에 직접적인 영향을 미치지 않습니다.</td></tr><tr><td></td><td>확장성</td><td>생산자와 소비자를 독립적으로 확장할 수 있어 시스템 확장이 용이합니다.</td></tr><tr><td></td><td>다양한 통신 패턴 지원</td><td>점대점, 발행-구독, 요청-응답 등 다양한 통신 패턴을 지원합니다.</td></tr><tr><td>⚠ 단점</td><td>복잡성 증가</td><td>분산 시스템 디버깅이 어렵고, 메시지 라우팅, 재시도 등의 복잡한 로직이 필요합니다.</td></tr><tr><td></td><td>일관성 보장의 어려움</td><td>일시적인 데이터 불일치가 발생할 수 있으며, 최종 일관성(eventual consistency)에 의존해야 합니다.</td></tr><tr><td></td><td>운영 오버헤드</td><td>브로커 설정, 모니터링, 확장 등 추가적인</td></tr><tr><td>운영 부담이 있습니다.</td><td></td><td></td></tr><tr><td></td><td>메시지 순서 보장의 어려움</td><td>분산 환경에서 메시지 순서를 완벽하게 보장하기 어려울 수 있습니다.</td></tr><tr><td></td><td>브로커 장애 위험</td><td>브로커 자체가 시스템의 단일 장애 지점(SPOF)이 될 수 있습니다.</td></tr></tbody></table><h3 id=도전-과제-1>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제-1>#</a></h3><ol><li><p><strong>일관성과 순서 보장</strong>: 분산 환경에서 메시지/이벤트의 순서를 보장하고 일관성을 유지하는 것은 어렵습니다. 특히 파티셔닝과 샤딩을 사용할 때 더욱 어렵습니다.</p></li><li><p><strong>확장성과 성능</strong>: 대용량 메시지/이벤트 처리 시 브로커의 확장성과 성능을 유지하는 것이 중요합니다. 특히 브로커가 단일 장애 지점이 되지 않도록 분산 아키텍처를 설계해야 합니다.</p></li><li><p><strong>메시지 중복 처리</strong>: 네트워크 장애 등으로 인해 동일한 메시지가 여러 번 전송될 수 있으므로, 멱등성(idempotency)을 구현하여 중복 처리를 방지해야 합니다.</p></li><li><p><strong>데드레터 처리</strong>: 실패한 메시지를 처리하기 위한 데드레터 큐(Dead Letter Queue) 및 재시도 메커니즘을 구현해야 합니다.</p></li><li><p><strong>보안과 인증</strong>: 브로커 접근 제어, 메시지/이벤트 암호화, 인증 등의 보안 메커니즘을 구현해야 합니다.</p></li><li><p><strong>모니터링과 디버깅</strong>: 분산 시스템에서 메시지/이벤트 흐름을 추적하고 디버깅하는 것은 어렵습니다. 효과적인 모니터링 및 로깅 전략이 필요합니다.</p></li><li><p><strong>스키마 진화</strong>: 시간이 지남에 따라 메시지/이벤트 스키마가 변경될 수 있으므로, 하위 호환성을 유지하면서 스키마를 진화시키는 방법이 필요합니다.</p></li><li><p><strong>장애 복구와 내구성</strong>: 브로커 장애 시 메시지/이벤트 손실을 방지하고 신속하게 복구할 수 있는 메커니즘이 필요합니다.</p></li></ol><h3 id=분류에-따른-종류-및-유형-1>분류에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류에-따른-종류-및-유형-1>#</a></h3><table><thead><tr><th>분류</th><th>유형</th><th>특징</th><th>사용 사례</th><th>대표 기술</th></tr></thead><tbody><tr><td>통신 모델</td><td>점대점(Point-to-Point)</td><td>하나의 발신자에서 하나의 수신자로 메시지 전달</td><td>작업 큐, 부하 분산</td><td>RabbitMQ, ActiveMQ</td></tr><tr><td></td><td>발행-구독(Publish-Subscribe)</td><td>하나의 발행자에서 여러 구독자로 메시지 전달</td><td>이벤트 알림, 브로드캐스트</td><td>Kafka, MQTT</td></tr><tr><td></td><td>요청-응답(Request-Reply)</td><td>요청 메시지 전송 후 응답 메시지 수신</td><td>RPC, 분산 서비스</td><td>RabbitMQ, ZeroMQ</td></tr><tr><td>메시지 저장 방식</td><td>인메모리(In-memory)</td><td>메시지를 메모리에 저장하여 빠른 처리</td><td>실시간 데이터 처리</td><td>Redis</td></tr><tr><td></td><td>디스크 기반(Disk-based)</td><td>메시지를 디스크에 저장하여 내구성 보장</td><td>중요 트랜잭션, 장기 저장</td><td>Kafka, RabbitMQ</td></tr><tr><td></td><td>하이브리드(Hybrid)</td><td>인메모리와 디스크 기반 접근 방식 결합</td><td>성능과 내구성 모두 중요한 경우</td><td>Apache Pulsar</td></tr><tr><td>브로커 유형</td><td>메시지 브로커(Message Broker)</td><td>메시지를 큐에 저장하고 소비 후 삭제</td><td>작업 큐, 비동기 통신</td><td>RabbitMQ, ActiveMQ</td></tr><tr><td></td><td>이벤트 브로커(Event Broker)</td><td>이벤트를 로그에 저장하고 유지</td><td>이벤트 소싱, 스트림 처리</td><td>Kafka, EventStoreDB</td></tr><tr><td></td><td>서비스 버스(Service Bus)</td><td>메시지 라우팅, 변환, 조정 기능</td><td>엔터프라이즈 통합</td><td>Azure Service Bus, NServiceBus</td></tr><tr><td>분산 아키텍처</td><td>중앙 집중형(Centralized)</td><td>단일 브로커 인스턴스 또는 클러스터</td><td>소규모 시스템, 간단한 통합</td><td>Redis PubSub</td></tr><tr><td></td><td>분산형(Distributed)</td><td>여러 브로커 노드가 분산되어 작동</td><td>대규모 시스템, 고가용성 필요</td><td>Kafka, RabbitMQ 클러스터</td></tr><tr><td></td><td>메시 아키텍처(Mesh)</td><td>브로커 간 직접 통신 지원</td><td>글로벌 분산 시스템</td><td>NATS, Kafka MirrorMaker</td></tr><tr><td>프로토콜</td><td>AMQP</td><td>고급 메시지 큐 프로토콜</td><td>엔터프라이즈 메시징</td><td>RabbitMQ, ActiveMQ</td></tr><tr><td></td><td>MQTT</td><td>경량 M2M 통신 프로토콜</td><td>IoT, 모바일</td><td>Mosquitto, HiveMQ</td></tr><tr><td></td><td>STOMP</td><td>심플 텍스트 지향 메시징 프로토콜</td><td>웹 애플리케이션</td><td>RabbitMQ, ActiveMQ</td></tr><tr><td></td><td>Kafka 프로토콜</td><td>바이너리 TCP 기반 프로토콜</td><td>대용량 스트리밍</td><td>Kafka</td></tr></tbody></table><h3 id=실무-적용-예시-1>실무 적용 예시<a hidden class=anchor aria-hidden=true href=#실무-적용-예시-1>#</a></h3><table><thead><tr><th>분야</th><th>사용 사례</th><th>설명</th><th>적용 기술</th></tr></thead><tbody><tr><td>전자상거래</td><td>주문 처리</td><td>주문 접수 후 결제, 재고 확인, 배송 등의 프로세스를 비동기적으로 처리</td><td>RabbitMQ, Amazon SQS</td></tr><tr><td>금융</td><td>결제 시스템</td><td>결제 요청을 안전하게 처리하고 관련 시스템(회계, 사기 감지 등)에 알림</td><td>Kafka, ActiveMQ</td></tr><tr><td>물류</td><td>재고 관리</td><td>재고 변경 이벤트를 처리하여 재고 수준을 실시간으로 추적</td><td>Kafka, RabbitMQ</td></tr><tr><td>IoT</td><td>센서 데이터 수집</td><td>대량의 센서 데이터를 수집하여 분석 시스템으로 전달</td><td>MQTT, Kafka</td></tr><tr><td>소셜 미디어</td><td>알림 서비스</td><td>사용자 활동(댓글, 좋아요 등)에 대한 알림을 실시간으로 처리</td><td>Redis PubSub, Kafka</td></tr><tr><td>게임</td><td>멀티플레이어 게임</td><td>플레이어 간 상호작용 및 게임 상태 변경 이벤트 처리</td><td>NATS, Redis PubSub</td></tr><tr><td>데이터 분석</td><td>실시간 분석</td><td>발생하는 이벤트를 실시간으로 수집하여 분석 파이프라인으로 전달</td><td>Kafka, Apache Pulsar</td></tr><tr><td>마이크로서비스</td><td>서비스 간 통신</td><td>서비스 간 느슨한 결합을 유지하면서 데이터 교환</td><td>RabbitMQ, Kafka</td></tr><tr><td>모니터링</td><td>로그 수집</td><td>분산 시스템의 로그 데이터를 중앙 집중화하여 모니터링</td><td>Kafka, Fluentd</td></tr><tr><td>클라우드</td><td>이벤트 기반 자동화</td><td>클라우드 리소스 변경 이벤트에 대응하여 작업 자동화</td><td>AWS EventBridge, Azure Event Grid</td></tr></tbody></table><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><h4 id=금융-거래-처리-시스템rabbitmq와-kafka를-활용한-하이브리드-아키텍처>금융 거래 처리 시스템(RabbitMQ와 Kafka를 활용한 하이브리드 아키텍처)<a hidden class=anchor aria-hidden=true href=#금융-거래-처리-시스템rabbitmq와-kafka를-활용한-하이브리드-아키텍처>#</a></h4><p><strong>시나리오</strong>: 대형 금융 기관에서 다양한 채널(웹, 모바일, ATM 등)을 통해 들어오는 거래 요청을 안정적으로 처리하고, 관련 시스템(계정 관리, 사기 감지, 회계, 감사, 고객 알림 등)과 통합하는 시스템을 구축해야 합니다.</p><p><strong>시스템 구성</strong>:</p><ol><li><p><strong>RabbitMQ 클러스터</strong>:</p><ul><li>거래 요청 수신 및 초기 처리</li><li>작업 큐를 통한 부하 분산</li><li>트랜잭션 보장을 위한 메시지 확인(acknowledgment) 메커니즘 활용</li></ul></li><li><p><strong>Apache Kafka 클러스터</strong>:</p><ul><li>모든 거래 이벤트 기록 및 유지</li><li>다양한 시스템에 이벤트 스트림 제공</li><li>실시간 분석 및 모니터링 지원</li></ul></li><li><p><strong>서비스 컴포넌트</strong>:</p><ul><li>거래 처리 서비스: 실제 거래 로직 실행</li><li>사기 감지 서비스: 실시간으로 이상 거래 탐지</li><li>알림 서비스: 고객에게 거래 알림 전송</li><li>분석 서비스: 거래 패턴 분석 및 리포트 생성</li><li>아카이브 서비스: 이벤트를 장기 저장소에 보관</li></ul></li></ol><p><strong>시스템 다이어그램</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-38-1><a class=lnlinks href=#hl-38-1> 1</a>
</span><span class=lnt id=hl-38-2><a class=lnlinks href=#hl-38-2> 2</a>
</span><span class=lnt id=hl-38-3><a class=lnlinks href=#hl-38-3> 3</a>
</span><span class=lnt id=hl-38-4><a class=lnlinks href=#hl-38-4> 4</a>
</span><span class=lnt id=hl-38-5><a class=lnlinks href=#hl-38-5> 5</a>
</span><span class=lnt id=hl-38-6><a class=lnlinks href=#hl-38-6> 6</a>
</span><span class=lnt id=hl-38-7><a class=lnlinks href=#hl-38-7> 7</a>
</span><span class=lnt id=hl-38-8><a class=lnlinks href=#hl-38-8> 8</a>
</span><span class=lnt id=hl-38-9><a class=lnlinks href=#hl-38-9> 9</a>
</span><span class=lnt id=hl-38-10><a class=lnlinks href=#hl-38-10>10</a>
</span><span class=lnt id=hl-38-11><a class=lnlinks href=#hl-38-11>11</a>
</span><span class=lnt id=hl-38-12><a class=lnlinks href=#hl-38-12>12</a>
</span><span class=lnt id=hl-38-13><a class=lnlinks href=#hl-38-13>13</a>
</span><span class=lnt id=hl-38-14><a class=lnlinks href=#hl-38-14>14</a>
</span><span class=lnt id=hl-38-15><a class=lnlinks href=#hl-38-15>15</a>
</span><span class=lnt id=hl-38-16><a class=lnlinks href=#hl-38-16>16</a>
</span><span class=lnt id=hl-38-17><a class=lnlinks href=#hl-38-17>17</a>
</span><span class=lnt id=hl-38-18><a class=lnlinks href=#hl-38-18>18</a>
</span><span class=lnt id=hl-38-19><a class=lnlinks href=#hl-38-19>19</a>
</span><span class=lnt id=hl-38-20><a class=lnlinks href=#hl-38-20>20</a>
</span><span class=lnt id=hl-38-21><a class=lnlinks href=#hl-38-21>21</a>
</span><span class=lnt id=hl-38-22><a class=lnlinks href=#hl-38-22>22</a>
</span><span class=lnt id=hl-38-23><a class=lnlinks href=#hl-38-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>+--------------------+     +---------------------+     +------------------------+
</span></span><span class=line><span class=cl>|  채널 (웹/모바일/ATM) |----&gt;| API 게이트웨이 (Kong) |----&gt;| 트랜잭션 유효성 검증 서비스 |
</span></span><span class=line><span class=cl>+--------------------+     +---------------------+     +------------------------+
</span></span><span class=line><span class=cl>                                                               |
</span></span><span class=line><span class=cl>                                                               v
</span></span><span class=line><span class=cl>+------------------+     +------------------+     +------------------------+
</span></span><span class=line><span class=cl>| 알림 서비스       |&lt;----| RabbitMQ 클러스터  |&lt;----| 트랜잭션 라우팅 서비스     |
</span></span><span class=line><span class=cl>+------------------+     +------------------+     +------------------------+
</span></span><span class=line><span class=cl>      |                         |                          |
</span></span><span class=line><span class=cl>      |                         v                          v
</span></span><span class=line><span class=cl>      |             +------------------------+   +----------------------+
</span></span><span class=line><span class=cl>      |             | 트랜잭션 처리 서비스 풀    |   | Kafka Connect (CDC)  |
</span></span><span class=line><span class=cl>      |             +------------------------+   +----------------------+
</span></span><span class=line><span class=cl>      |                         |                          |
</span></span><span class=line><span class=cl>      v                         v                          v
</span></span><span class=line><span class=cl>+------------------+     +------------------+     +---------------------+
</span></span><span class=line><span class=cl>| 고객 앱/이메일/SMS |     | 데이터베이스 시스템  |     | Kafka 클러스터         |
</span></span><span class=line><span class=cl>+------------------+     +------------------+     +---------------------+
</span></span><span class=line><span class=cl>                                                      |         |
</span></span><span class=line><span class=cl>                                                      v         v
</span></span><span class=line><span class=cl>                                             +----------------+ +----------------+
</span></span><span class=line><span class=cl>                                             | 실시간 분석 시스템 | | 이벤트 아카이빙   |
</span></span><span class=line><span class=cl>                                             +----------------+ +----------------+
</span></span></code></pre></td></tr></table></div></div><p><strong>워크플로우</strong>:</p><ol><li>고객이 다양한 채널을 통해 거래 요청을 시작합니다.</li><li>API 게이트웨이가 요청을 수신하고 기본 유효성 검사를 수행합니다.</li><li>트랜잭션 유효성 검증 서비스가 요청을 검증하고 필요한 변환을 수행합니다.</li><li>트랜잭션 라우팅 서비스가 요청 유형에 따라 적절한 RabbitMQ 큐로 메시지를 라우팅합니다.</li><li>RabbitMQ는 메시지를 적절한 트랜잭션 처리 서비스로 전달합니다.</li><li>트랜잭션 처리 서비스는 거래를 처리하고 결과를 데이터베이스에 저장합니다.</li><li>데이터베이스 변경 사항은 Kafka Connect의 CDC(Change Data Capture)를 통해 Kafka로 전파됩니다.</li><li>알림 서비스는 RabbitMQ로부터 처리 결과를 수신하고 고객에게 알림을 전송합니다.</li><li>Kafka에 저장된 이벤트 스트림은 실시간 분석 시스템, 사기 감지 시스템 등 다양한 소비자가 활용합니다.</li><li>장기 보관이 필요한 이벤트는 이벤트 아카이빙 시스템으로 전송됩니다.</li></ol><p><strong>역할 및 책임</strong>:</p><ul><li><strong>RabbitMQ</strong>: 신뢰성 있는 메시지 전달, 작업 큐 관리, 트랜잭션 처리 보장</li><li><strong>Kafka</strong>: 이벤트 스트림 저장 및 배포, 실시간 데이터 파이프라인 제공</li><li><strong>서비스 컴포넌트</strong>: 비즈니스 로직 처리, 데이터 변환, 고객 상호작용 관리</li></ul><p>이 아키텍처의 주요 이점은 다음과 같습니다:</p><ul><li>고가용성과 확장성을 제공하는 분산 설계</li><li>RabbitMQ를 통한 안정적인 트랜잭션 처리</li><li>Kafka를 통한 완전한 이벤트 기록 및 실시간 분석 지원</li><li>시스템 컴포넌트 간의 느슨한 결합으로 유지보수성 향상</li><li>장애 상황에서도 데이터 손실 방지 및 빠른 복구</li></ul><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점-1>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점-1>#</a></h3><table><thead><tr><th>고려사항</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>메시지/이벤트 스키마 설계</td><td>메시지 구조와 데이터 형식이 시스템 통합에 큰 영향을 미침</td><td>스키마 레지스트리 도입, 버전 관리 체계 구축, 하위 호환성 유지</td></tr><tr><td>배포 전략</td><td>브로커 인프라의 가용성과 확장성이 전체 시스템에 영향을 줌</td><td>클러스터링, 고가용성 설정, 지역 분산 배포, 장애 조치(failover) 메커니즘 구현</td></tr><tr><td>모니터링 및 알림</td><td>브로커 및 메시지 흐름에 대한 가시성 확보가 중요</td><td>포괄적인 모니터링 도구 도입, 주요 지표 대시보드 구성, 자동 알림 설정</td></tr><tr><td>메시지 우선순위</td><td>중요한 메시지가 적시에 처리되어야 함</td><td>우선순위 큐 활용, 중요 메시지용 전용 채널 구성, QoS(Quality of Service) 설정 적용</td></tr><tr><td>메시지 재시도 및 실패 처리</td><td>일시적 장애로 인한 메시지 처리 실패 대응 필요</td><td>지수 백오프 재시도 전략, 데드레터 큐(DLQ) 구현, 실패 메시지 모니터링 및 알림</td></tr><tr><td>보안 및 인증</td><td>브로커 접근 제어 및 메시지 보안이 중요</td><td>TLS/SSL 암호화 적용, 강력한 인증 메커니즘 구현, 세분화된 접근 제어 설정</td></tr><tr><td>일관성 보장</td><td>분산 환경에서 메시지 순서 및 처리 보장이 어려움</td><td>파티션 키 전략 수립, 메시지 ID 및 타임스탬프 활용, 멱등 소비자 구현</td></tr><tr><td>용량 계획</td><td>메시지 볼륨 및 브로커 리소스 요구사항 예측 필요</td><td>부하 테스트 수행, 확장 계획 수립, 자동 스케일링 메커니즘 구현</td></tr><tr><td>로깅 및 추적</td><td>메시지 흐름 추적 및 문제 해결 필요</td><td>상관관계 ID 도입, 분산 추적 시스템 구현, 구조화된 로깅 표준 적용</td></tr><tr><td>백업 및 복구</td><td>데이터 손실 방지 및 재해 복구 계획 필요</td><td>정기적 백업 수행, 복구 계획 문서화, 복구 훈련 실시</td></tr></tbody></table><h3 id=최적화하기-위한-고려사항-및-주의할-점-1>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점-1>#</a></h3><table><thead><tr><th>고려사항</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>메시지 크기</td><td>큰 메시지는 네트워크 대역폭과 브로커 성능에 영향을 줌</td><td>메시지 크기 제한 설정, 대용량 콘텐츠는 외부 저장소 활용, 메시지 압축 적용</td></tr><tr><td>배치 처리</td><td>개별 메시지 처리는 오버헤드가 크므로 성능 저하 가능</td><td>생산자 및 소비자 배치 설정 최적화, 배치 크기와 지연 시간 균형 조정</td></tr><tr><td>브로커 설정</td><td>기본 설정이 모든 워크로드에 최적화되지 않음</td><td>메모리, 디스크 I/O, 네트워크 설정 최적화, 하드웨어 리소스에 맞는 JVM 튜닝</td></tr><tr><td>파티션 전략</td><td>파티션 수와 배치가 처리량과 순서에 영향을 줌</td><td>워크로드에 적합한 파티션 수 설정, 균형 잡힌 파</td></tr></tbody></table><h3 id=최적화하기-위한-고려사항-및-주의할-점-계속>최적화하기 위한 고려사항 및 주의할 점 (계속)<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점-계속>#</a></h3><table><thead><tr><th>고려사항</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>파티션 전략</td><td>파티션 수와 배치가 처리량과 순서에 영향을 줌</td><td>워크로드에 적합한 파티션 수 설정, 균형 잡힌 파티션 키 선택, 핫 파티션 방지</td></tr><tr><td>네트워크 최적화</td><td>네트워크 지연 및 대역폭이 성능에 영향을 줌</td><td>브로커와 클라이언트 간 네트워크 최적화, 지리적으로 가까운 배치, TCP 설정 튜닝</td></tr><tr><td>소비자 그룹 설계</td><td>소비자 그룹 구성이 병렬 처리에 영향을 줌</td><td>워크로드에 맞는 소비자 수 조정, 균형 잡힌 파티션 할당 전략 선택</td></tr><tr><td>캐싱 전략</td><td>반복 데이터 접근이 성능을 저하시킬 수 있음</td><td>클라이언트 측 캐싱 적용, 읽기 전용 복제본 활용, 캐시 무효화 전략 수립</td></tr><tr><td>디스크 I/O</td><td>디스크 성능이 메시지 지속성에 영향을 줌</td><td>SSD 활용, RAID 구성 최적화, 로그 세그먼트 설정 조정</td></tr><tr><td>메시지 압축</td><td>압축이 네트워크 사용량은 줄이지만 CPU 사용량은 증가</td><td>메시지 특성에 맞는 압축 알고리즘 선택, 압축 수준과 성능 사이의 균형 조정</td></tr><tr><td>필터링 최적화</td><td>클라이언트 측 필터링이 불필요한 네트워크 사용 유발</td><td>서버 측 필터링 활용, 토픽/파티션 설계 최적화, 이벤트 필터링 패턴 도입</td></tr><tr><td>모니터링 오버헤드</td><td>과도한 모니터링이 성능에 영향을 줄 수 있음</td><td>샘플링 기반 모니터링 적용, 중요 지표 선별, 모니터링 주기 최적화</td></tr><tr><td>보존 정책</td><td>오래된 메시지 저장이 스토리지 성능에 영향을 줌</td><td>적절한 보존 기간 설정, 계층형 스토리지 활용, 압축 정책 최적화</td></tr><tr><td>클라이언트 라이브러리 선택</td><td>클라이언트 라이브러리에 따라 성능 차이 발생</td><td>최신 버전의 공식 클라이언트 사용, 비동기 API 활용, 커넥션 풀링 구현</td></tr></tbody></table><h3 id=2025년-기준-최신-동향>2025년 기준 최신 동향<a hidden class=anchor aria-hidden=true href=#2025년-기준-최신-동향>#</a></h3><table><thead><tr><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>메시지 브로커 기술</td><td>서버리스 메시징</td><td>클라우드 제공업체의 완전 관리형 서버리스 메시징 솔루션이 확산되어 운영 부담을 크게 줄이고 유연한 확장성을 제공합니다.</td></tr><tr><td></td><td>Edge 메시징</td><td>엣지 컴퓨팅 환경에서도 작동하는 경량화된 메시지 브로커들이 등장하여 IoT 및 분산 애플리케이션을 위한 지연 시간 최소화와 오프라인 지원이 가능해졌습니다.</td></tr><tr><td></td><td>WebSocket 및 WebTransport 통합</td><td>최신 메시지 브로커들은 WebSocket과 더 새로운 WebTransport 프로토콜을 기본적으로 지원하여 웹 애플리케이션과의 연결성이 강화되었습니다.</td></tr><tr><td>이벤트 중심 아키텍처</td><td>이벤트 메시</td><td>단일 중앙 브로커에 의존하지 않고 여러 브로커가 분산 네트워크를 형성하는 이벤트 메시(Event Mesh) 아키텍처가 확산되고 있습니다.</td></tr><tr><td></td><td>하이브리드/멀티클라우드 이벤트 라우팅</td><td>서로 다른 클라우드 환경과 온프레미스 시스템 간의 원활한 이벤트 라우팅을 지원하는 솔루션이 발전하여 기업의 멀티클라우드 전략을 지원합니다.</td></tr><tr><td></td><td>이벤트 기반 서버리스</td><td>이벤트에 반응하여 자동으로 확장되는 서버리스 함수와 메시지/이벤트 브로커의 통합이 더욱 강화되었습니다.</td></tr><tr><td>데이터 관리</td><td>실시간 데이터 파이프라인</td><td>메시지/이벤트 브로커를 중심으로 실시간 데이터 파이프라인을 구축하는 패턴이 확산되어 데이터 레이크, 웨어하우스와의 통합이 강화되었습니다.</td></tr><tr><td></td><td>스키마 진화 관리</td><td>메시지/이벤트 스키마의 버전 관리와 진화를 지원하는 고급 도구가 발전하여 장기적인 시스템 유지 관리 부담이 감소했습니다.</td></tr><tr><td></td><td>컴플라이언스 및 데이터 거버넌스</td><td>메시지/이벤트 브로커에서의 데이터 처리에 대한 규제 준수와 거버넌스 기능이 강화되어 민감한 데이터 처리 지원이 개선되었습니다.</td></tr><tr><td>개발자 경험</td><td>저코드/노코드 통합</td><td>시각적 도구를 통해 메시지/이벤트 흐름을 설계하고 관리할 수 있는 저코드/노코드 솔루션이 발전하여 개발자가 아닌 사용자도 통합 파이프라인을 구축할 수 있게 되었습니다.</td></tr><tr><td></td><td>AI 지원 디버깅</td><td>분산 메시징 시스템에서 문제를 진단하고 해결하는 AI 기반 도구가 등장하여 복잡한 디버깅 과정을 간소화합니다.</td></tr><tr><td></td><td>API 우선 접근 방식</td><td>메시지/이벤트 브로커가 API 관리 플랫폼과 긴밀하게 통합되어 API와 이벤트 기반 통신의 경계가 모호해지고 있습니다.</td></tr></tbody></table><h3 id=주제와-관련하여-주목할-내용-1>주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#주제와-관련하여-주목할-내용-1>#</a></h3><table><thead><tr><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>핵심 기술 발전</td><td>eBPF 기반 브로커 최적화</td><td>eBPF(extended Berkeley Packet Filter) 기술을 활용하여 커널 레벨에서 메시지 라우팅 및 필터링을 최적화하는 기법이 도입되고 있습니다.</td></tr><tr><td></td><td>영속성과 지연 시간 균형</td><td>비휘발성 메모리(NVRAM)와 같은 신기술을 활용해 높은 영속성과 낮은 지연 시간을 동시에 제공하는 메시지 브로커가 등장하고 있습니다.</td></tr><tr><td></td><td>양자 내성 암호화</td><td>향후 양자 컴퓨팅 위협에 대비한 양자 내성 암호화를 적용한 메시지/이벤트 브로커 보안 기능이 연구 중입니다.</td></tr><tr><td>새로운 패러다임</td><td>메시지-쿼리 통합</td><td>메시지 브로커와 데이터베이스 쿼리 기능이 통합된 하이브리드 시스템이 등장하여 이벤트와 상태 관리의 경계가 모호해지고 있습니다.</td></tr><tr><td></td><td>네트워크 메시 통합</td><td>서비스 메시(Service Mesh)와 이벤트 메시(Event Mesh)의 통합을 통해 일관된 통신 인프라를 제공하는 접근 방식이 발전하고 있습니다.</td></tr><tr><td></td><td>상태 중심 메시징(State-centric Messaging)</td><td>단순 이벤트 전달을 넘어 분산 상태 관리와 메시징을 결합한 새로운 패러다임이 등장하고 있습니다.</td></tr><tr><td>도메인 특화 솔루션</td><td>IoT 특화 브로커</td><td>리소스 제약 환경, 간헐적 연결성, 엣지 처리를 고려한 IoT 특화 메시지/이벤트 브로커가 발전하고 있습니다.</td></tr><tr><td></td><td>금융 거래용 고성능 브로커</td><td>나노초 지연 시간, 확정적 전달, 규제 준수를 보장하는 금융 특화 메시지 브로커가 개발되고 있습니다.</td></tr><tr><td></td><td>AI/ML 파이프라인 통합</td><td>대규모 AI/ML 데이터 파이프라인에 최적화된 이벤트 스트리밍 플랫폼이 등장하여 모델 훈련 및 추론 워크플로우를 지원합니다.</td></tr><tr><td>운영 혁신</td><td>자가 최적화 브로커</td><td>워크로드 패턴을 학습하여 자동으로 설정을 최적화하는 인공지능 기반 메시지 브로커가 연구되고 있습니다.</td></tr><tr><td></td><td>탄소 발자국 최적화</td><td>에너지 효율성을 고려한 메시지 라우팅 및 저장 전략을 통해 데이터센터 탄소 발자국을 줄이는 접근 방식이 주목받고 있습니다.</td></tr><tr><td></td><td>통합 가시성 도구</td><td>여러 브로커와 환경에 걸친 메시지/이벤트 흐름을 통합적으로 시각화하고 모니터링하는 도구가 개발되고 있습니다.</td></tr></tbody></table><h3 id=앞으로의-전망-1>앞으로의 전망<a hidden class=anchor aria-hidden=true href=#앞으로의-전망-1>#</a></h3><table><thead><tr><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>기술 통합</td><td>분산 원장 기술(DLT) 통합</td><td>블록체인/DLT 기술과 메시지/이벤트 브로커의 통합이 확대되어 메시지 불변성, 추적성, 신뢰성을 강화하는 솔루션이 확산될 것으로 예상됩니다.</td></tr><tr><td></td><td>엣지-클라우드 연속성</td><td>엣지 컴퓨팅과 클라우드 환경 간의 원활한 메시지/이벤트 흐름을 지원하는 통합 브로커 솔루션이 중요해질 것입니다.</td></tr><tr><td></td><td>AI 기반 브로커</td><td>AI가 메시지 라우팅, 필터링, 우선순위 지정에 활용되어 상황에 맞는 지능적인 메시지 처리를 제공하는 브로커가 등장할 것입니다.</td></tr><tr><td>새로운 응용 분야</td><td>디지털 트윈 플랫폼</td><td>물리적 자산과 디지털 트윈 간의 실시간 동기화를 위한 핵심 인프라로 메시지/이벤트 브로커가 활용될 것입니다.</td></tr><tr><td></td><td>메타버스 커뮤니케이션</td><td>대규모 가상 환경에서 시공간 이벤트를 처리하기 위한 특화된 메시지/이벤트 브로커가 발전할 것입니다.</td></tr><tr><td></td><td>자율 시스템 조정</td><td>자율 시스템 간의 협업과 조정을 위한 의사결정 플랫폼으로 이벤트 브로커의 역할이 확대될 것입니다.</td></tr><tr><td>아키텍처 진화</td><td>멀티모달 이벤트 처리</td><td>다양한 유형(텍스트, 이미지, 오디오, 동영상 등)의 이벤트 데이터를 처리하기 위한 메시지/이벤트 브로커 기능이 확장될 것입니다.</td></tr><tr><td></td><td>양자 메시징</td><td>양자 컴퓨팅과 양자 통신 기술을 활용한 고도로 안전한 메시지 브로커가 연구 개발될 것입니다.</td></tr><tr><td></td><td>공간 이벤트 처리</td><td>지리적 위치와 공간 관계를 고려한 이벤트 라우팅 및 처리 기능이 강화될 것입니다.</td></tr><tr><td>생태계 발전</td><td>이벤트 마켓플레이스</td><td>조직 간에 이벤트를 안전하게 공유하고 거래할 수 있는 이벤트 마켓플레이스가 발전할 것입니다.</td></tr><tr><td></td><td>크로스 도메인 표준화</td><td>다양한 산업 분야에 걸친 이벤트 스키마와 메시지 형식의 표준화가 진행될 것입니다.</td></tr><tr><td></td><td>오픈소스 혁신</td><td>새로운 메시징 패러다임을 구현한 혁신적인 오픈소스 브로커가 등장하여 생태계가 더욱 다양화될 것입니다.</td></tr></tbody></table><h3 id=추가-학습-주제>추가 학습 주제<a hidden class=anchor aria-hidden=true href=#추가-학습-주제>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>설명</th></tr></thead><tbody><tr><td>메시지 브로커 심화</td><td>AMQP 프로토콜</td><td>Advanced Message Queuing Protocol의 세부 사항과 구현 기법에 대한 심층 이해</td></tr><tr><td></td><td>메시지 라우팅 전략</td><td>복잡한 라우팅 토폴로지와 패턴 설계 및 구현 방법</td></tr><tr><td></td><td>브로커 내부 아키텍처</td><td>메시지 브로커의 내부 구현과 최적화 기법에 대한 이해</td></tr><tr><td>이벤트 브로커 심화</td><td>파티셔닝 전략</td><td>대규모 이벤트 처리를 위한 파티션 설계와 최적화 방법</td></tr><tr><td></td><td>이벤트 컴팩션</td><td>이벤트 스트림의 효율적인 압축 및 관리 기법</td></tr><tr><td></td><td>스트림 처리 토폴로지</td><td>복잡한 이벤트 처리 파이프라인 설계 및 구현 방법</td></tr><tr><td>분산 시스템</td><td>CAP 이론과 브로커 설계</td><td>일관성, 가용성, 분할 내성 간의 트레이드오프와 브로커 설계에 미치는 영향</td></tr><tr><td></td><td>분산 합의 알고리즘</td><td>Raft, Paxos 등 분산 시스템의 합의 알고리즘과 메시지 브로커 적용</td></tr><tr><td></td><td>비동기 패턴</td><td>콜백, 프로미스, 리액티브 프로그래밍 등 비동기 통신 패턴</td></tr><tr><td>패턴 및 아키텍처</td><td>사가 패턴</td><td>분산 트랜잭션 관리를 위한 메시지 기반 사가 패턴 구현</td></tr><tr><td></td><td>이벤트 소싱 심화</td><td>복잡한 도메인을 위한 이벤트 소싱 설계 및 구현</td></tr><tr><td></td><td>메시징 패턴 카탈로그</td><td>다양한 메시징 패턴과 응용 사례 분석</td></tr><tr><td>성능 및 운영</td><td>고성능 메시징</td><td>저지연, 고처리량 메시징 시스템 설계 및 구현</td></tr><tr><td></td><td>대규모 운영</td><td>수백 개의 브로커 노드로 구성된 클러스터 관리 및 운영</td></tr><tr><td></td><td>장애 복구 전략</td><td>다양한 장애 시나리오에 대응하는 복구 전략</td></tr><tr><td>보안</td><td>메시지 보안</td><td>메시지 암호화, 인증, 무결성 보장 기법</td></tr><tr><td></td><td>접근 제어</td><td>세분화된 메시지 접근 제어 정책 설계 및 구현</td></tr><tr><td></td><td>보안 위협 분석</td><td>메시지 브로커 환경의 잠재적 보안 위협과 대응 방안</td></tr><tr><td>클라우드 네이티브</td><td>쿠버네티스 통합</td><td>쿠버네티스 환경에서의 메시지 브로커 배포 및 운영</td></tr><tr><td></td><td>서버리스 메시징</td><td>AWS Lambda, Azure Functions 등과의 통합 패턴</td></tr><tr><td></td><td>클라우드 간 메시징</td><td>멀티클라우드 환경에서의 메시지/이벤트 브로커 활용</td></tr><tr><td>특수 도메인</td><td>IoT 메시징</td><td>리소스 제약 환경에서의 효율적인 메시징 구현</td></tr><tr><td></td><td>실시간 분석</td><td>이벤트 스트림을 활용한 실시간 분석 파이프라인 구축</td></tr><tr><td></td><td>규제 준수</td><td>금융, 의료 등 규제 산업에서의 메시지 브로커 활용</td></tr></tbody></table><h3 id=추가-학습-내용>추가 학습 내용<a hidden class=anchor aria-hidden=true href=#추가-학습-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>설명</th></tr></thead><tbody><tr><td>프로그래밍 언어</td><td>리액티브 프로그래밍</td><td>비동기 이벤트 스트림 처리를 위한 리액티브 프로그래밍 패러다임과 도구</td></tr><tr><td></td><td>함수형 프로그래밍</td><td>불변성과 부작용 없는 함수를 활용한 이벤트 처리 접근 방식</td></tr><tr><td></td><td>동시성 모델</td><td>다양한 프로그래밍 언어의 동시성 모델과 메시지 처리 적용</td></tr><tr><td>데이터 엔지니어링</td><td>데이터 파이프라인 설계</td><td>메시지/이벤트 브로커를 중심으로 한 데이터 파이프라인 아키텍처</td></tr><tr><td></td><td>스키마 설계</td><td>효율적인 메시지/이벤트 스키마 설계 원칙과 방법론</td></tr><tr><td></td><td>ETL과 ELT 통합</td><td>메시지/이벤트 브로커를 활용한 ETL/ELT 프로세스 구현</td></tr><tr><td>DevOps</td><td>브로커 자동화</td><td>메시지/이벤트 브로커의 자동화된 배포, 설정, 관리</td></tr><tr><td></td><td>지속적 통합/배포</td><td>메시지 기반 시스템의 CI/CD 파이프라인 구축</td></tr><tr><td></td><td>카오스 엔지니어링</td><td>메시지/이벤트 브로커 환경에서의 회복력 테스트</td></tr><tr><td>인공지능</td><td>ML 파이프라인 통합</td><td>이벤트 스트림을 활용한 ML 모델 훈련 및 서빙</td></tr><tr><td></td><td>이상 탐지</td><td>메시지/이벤트 스트림에서의 이상 탐지 기법</td></tr><tr><td></td><td>스트림 기반 의사결정</td><td>실시간 이벤트를 기반으로 한 인공지능 의사결정 시스템</td></tr><tr><td>시스템 설계</td><td>대규모 분산 시스템</td><td>수천만 사용자를 지원하는 메시지/이벤트 기반 시스템 설계</td></tr><tr><td></td><td>장애 내성 설계</td><td>다양한 장애 시나리오에 대응하는 시스템 아키텍처</td></tr><tr><td></td><td>글로벌 배포 전략</td><td>지역 분산된 메시지/이벤트 브로커 인프라 구축</td></tr></tbody></table><hr><h2 id=용어-정리-2>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-2>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>AMQP(Advanced Message Queuing Protocol)</td><td>메시지 지향 미들웨어를 위한 개방형 표준 프로토콜로, 클라이언트와 브로커 간의 통신에 사용됩니다.</td></tr><tr><td>바인딩(Binding)</td><td>메시지 브로커에서 교환소(Exchange)와 큐(Queue)를 연결하는 규칙으로, 어떤 메시지가 어떤 큐로 전달될지 결정합니다.</td></tr><tr><td>CDC(Change Data Capture)</td><td>데이터베이스의 변경 사항을 실시간으로 추적하여 이벤트 스트림으로 변환하는 기술입니다.</td></tr><tr><td>소비자(Consumer)</td><td>메시지/이벤트 브로커로부터 메시지를 수신하여 처리하는 애플리케이션 또는 서비스입니다.</td></tr><tr><td>CQRS(Command Query Responsibility Segregation)</td><td>명령(상태 변경)과 쿼리(상태 읽기)를 분리하는 아키텍처 패턴입니다.</td></tr><tr><td>DLQ(Dead Letter Queue)</td><td>처리에 실패한 메시지를 저장하는 특수한 큐로, 나중에 분석하거나 재처리하는 데 사용됩니다.</td></tr><tr><td>교환소(Exchange)</td><td>메시지 브로커에서 메시지를 수신하여 라우팅 규칙에 따라 적절한 큐로 전달하는 컴포넌트입니다.</td></tr><tr><td>이벤트 소싱(Event Sourcing)</td><td>상태 변화를 일련의 이벤트로 저장하고, 이벤트를 재생하여 현재 상태를 복원하는 패턴입니다.</td></tr><tr><td>멱등성(Idempotency)</td><td>동일한 메시지가 여러 번 처리되더라도 시스템 상태가 동일하게 유지되는 속성입니다.</td></tr><tr><td>메시지 브로커(Message Broker)</td><td>메시지 검증, 변환, 라우팅을 통해 서로 다른 시스템 간의 통신을 중개하는 소프트웨어입니다.</td></tr><tr><td>MQTT(Message Queuing Telemetry Transport)</td><td>경량 메시징 프로토콜로, 주로 IoT 기기 간 통신에 사용됩니다.</td></tr><tr><td>오프셋(Offset)</td><td>이벤트 스트림에서 소비자가 어디까지 메시지를 소비했는지 추적하는 위치 지표입니다.</td></tr><tr><td>파티션(Partition)</td><td>이벤트 브로커에서 주제(Topic)를 물리적으로 분할하여 병렬 처리를 가능하게 하는 단위입니다.</td></tr><tr><td>생산자(Producer)</td><td>메시지/이벤트 브로커에 메시지를 발행하는 애플리케이션 또는 서비스입니다.</td></tr><tr><td>발행-구독(Publish-Subscribe)</td><td>발행자가 메시지를 주제(Topic)에 발행하고, 해당 주제를 구독한 모든 구독자가 메시지를 수신하는 패턴입니다.</td></tr><tr><td>큐(Queue)</td><td>메시지 브로커에서 메시지가 소비자에게 전달되기 전까지 저장되는 버퍼입니다.</td></tr><tr><td>사가(Saga)</td><td>분산 트랜잭션을 구현하기 위해 일련의 로컬 트랜잭션과 보상 트랜잭션을 조합하는 패턴입니다.</td></tr><tr><td>스키마 레지스트리(Schema Registry)</td><td>메시지/이벤트 스키마를 중앙에서 관리하고 유효성을 검증하는 컴포넌트입니다.</td></tr><tr><td>STOMP(Simple Text Oriented Messaging Protocol)</td><td>텍스트 기반의 간단한 메시징 프로토콜로, 다양한 언어와 플랫폼에서 쉽게 구현할 수 있습니다.</td></tr><tr><td>주제(Topic)</td><td>이벤트 브로커에서 특정 카테고리의 이벤트를 그룹화하는 논리적 채널입니다.</td></tr></tbody></table><hr><h2 id=참고-및-출처-2>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-2>#</a></h2><ul><li><a href=https://www.ibm.com/kr-ko/cloud/learn/message-brokers>메시지 브로커란 무엇인가요? | IBM</a></li><li><a href=https://f-lab.kr/insight/understanding-message-and-event-brokers-20240924>메시지 브로커와 이벤트 브로커의 이해와 활용</a></li><li><a href=https://f-lab.kr/insight/message-broker-event-broker>메시지 브로커와 이벤트 브로커: 분산 시스템의 핵심 기술</a></li><li><a href=https://aws.amazon.com/ko/compare/the-difference-between-rabbitmq-and-kafka/>RabbitMQ와 Kafka - 메시지 대기열 시스템 간의 차이점 - AWS</a></li><li><a href=https://www.redhat.com/ko/topics/integration/what-is-event-driven-architecture>이벤트 기반 아키텍처란?</a></li><li><a href=https://www.redhat.com/ko/topics/integration/what-is-an-event-mesh>이벤트 메쉬(Event Mesh)의 개념, 기능, 작동 방식, 사용 방법</a></li><li><a href=https://velog.io/@cjy9306/Kafka%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%B8%8C%EB%A1%9C%EC%BB%A4-vs-RabbitMQ%EB%A9%94%EC%8B%9C%EC%A7%80-%EB%B8%8C%EB%A1%9C%EC%BB%A4>Kafka(이벤트 브로커) vs RabbitMQ(메시지 브로커)</a></li><li><a href=https://ko.wikipedia.org/wiki/%EB%A9%94%EC%8B%9C%EC%A7%80_%EB%B8%8C%EB%A1%9C%EC%BB%A4>메시지 브로커 - 위키백과</a></li><li><a href=https://velog.io/@cho876/%EC%B9%B4%ED%94%84%EC%B9%B4kafka-vs-RabbitMQ>카프카(kafka) vs RabbitMQ</a></li><li><a href=https://velog.io/@happysang/8-2.-Message-Broker-%ED%99%9C%EC%9A%A9>Message Broker 활용</a></li><li><a href=https://www.devkobe24.com/Architecture/2024-12-30-Message-Broker.html>Message Broker(메시지 브로커)란 무엇일까?</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/backend-development/>Backend-Development</a></li><li><a href=https://buenhyden.github.io/tags/event-and-message-brokers/>Event-and-Message-Brokers</a></li><li><a href=https://buenhyden.github.io/tags/fundamentals/>Fundamentals</a></li><li><a href=https://buenhyden.github.io/tags/event-brokers/>Event-Brokers</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/frontend-development/rendering-strategies/client-side-rendering/csr-vs-ssr/><span class=title>« Prev</span><br><span>CSR vs SSR</span>
</a><a class=next href=https://buenhyden.github.io/posts/computer-science-fundamentals/data-structures-and-algorithms/algorithms/sorting/comparison-sorts/insertion-sort/><span class=title>Next »</span><br><span>삽입 정렬 (Insertion Sort)</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>