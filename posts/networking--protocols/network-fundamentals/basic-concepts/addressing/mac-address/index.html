<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Media Access Control Address (MAC Address) | hyunyoun's Blog</title><meta name=keywords content="Networking-and-Protocols,Network-Fundamentals,Basic-Concepts,Addressing,MAC-Address,Media-Access-Control-Address,Device-Identifier,Data-Link-Layer"><meta name=description content="MAC 주소(EUI-48)는 데이터 링크 계층(L2)에서 사용되는 48비트 식별자로, IEEE가 OUI/MA-L 등으로 제조사 블록을 관리한다. U/L 비트로 로컬/글로벌, I/G 비트로 단일/그룹을 구분하며 스위치 포워딩·ARP/NDP 연동에 필수적이다. 다만 OS·무선 랜덤화·가상화로 변경·랜덤화가 가능하므로 인증·접근제어는 MAC 단독 의존을 피하고 802.1X·NAC·IPAM 등으로 보완해야 한다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/networking--protocols/network-fundamentals/basic-concepts/addressing/mac-address/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.d522c866f0cc9c20ae4fa73a0a8c07f0af4c36af75bcbcd3e90558446f681077.css integrity="sha256-1SLIZvDMnCCuT6c6CowH8K9MNq91vLzT6QVYRG9oEHc=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/networking--protocols/network-fundamentals/basic-concepts/addressing/mac-address/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/networking--protocols/network-fundamentals/basic-concepts/addressing/mac-address/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/networking--protocols/network-fundamentals/basic-concepts/addressing/mac-address/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Media Access Control Address (MAC Address)"><meta property="og:description" content="MAC 주소(EUI-48)는 데이터 링크 계층(L2)에서 사용되는 48비트 식별자로, IEEE가 OUI/MA-L 등으로 제조사 블록을 관리한다. U/L 비트로 로컬/글로벌, I/G 비트로 단일/그룹을 구분하며 스위치 포워딩·ARP/NDP 연동에 필수적이다. 다만 OS·무선 랜덤화·가상화로 변경·랜덤화가 가능하므로 인증·접근제어는 MAC 단독 의존을 피하고 802.1X·NAC·IPAM 등으로 보완해야 한다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Media Access Control Address (MAC Address)"><meta name=twitter:description content="MAC 주소(EUI-48)는 데이터 링크 계층(L2)에서 사용되는 48비트 식별자로, IEEE가 OUI/MA-L 등으로 제조사 블록을 관리한다. U/L 비트로 로컬/글로벌, I/G 비트로 단일/그룹을 구분하며 스위치 포워딩·ARP/NDP 연동에 필수적이다. 다만 OS·무선 랜덤화·가상화로 변경·랜덤화가 가능하므로 인증·접근제어는 MAC 단독 의존을 피하고 802.1X·NAC·IPAM 등으로 보완해야 한다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HY's Blog","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":6,"name":"Media Access Control Address (MAC Address)","item":"https://buenhyden.github.io/posts/networking--protocols/network-fundamentals/basic-concepts/addressing/mac-address/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>HY's Blog</a></div><h1>Media Access Control Address (MAC Address)</h1><div class=post-description>MAC 주소(EUI-48)는 데이터 링크 계층(L2)에서 사용되는 48비트 식별자로, IEEE가 OUI/MA-L 등으로 제조사 블록을 관리한다. U/L 비트로 로컬/글로벌, I/G 비트로 단일/그룹을 구분하며 스위치 포워딩·ARP/NDP 연동에 필수적이다. 다만 OS·무선 랜덤화·가상화로 변경·랜덤화가 가능하므로 인증·접근제어는 MAC 단독 의존을 피하고 802.1X·NAC·IPAM 등으로 보완해야 한다.</div></header><div class=post-content><h2 id=media-access-control-addressmac-address>Media Access Control Address(MAC Address)<a hidden class=anchor aria-hidden=true href=#media-access-control-addressmac-address>#</a></h2><p>MAC 주소는 데이터 링크 (L2) 의 48 비트 식별자 (EUI-48) 로, 상위 24 비트는 제조사 식별자 (OUI) 를 포함한다.<br>스위치는 이 MAC 으로 학습해 프레임을 전달하고 ARP/NDP 와 결합해 호스트 도달성을 보장한다.</p><p>첫 바이트의 I/G·U/L 비트는 그룹/개별·전역/로컬 의미를 제공하며, IPv6 SLAAC 에서는 MAC 을 EUI-64 로 변환해 인터페이스 ID 를 생성한다.<br>가상 NIC·클라우드 ENI 는 소프트웨어 MAC 을 사용하므로 IPAM·자산 DB 관리가 필요하며, MAC 은 스푸핑·플러딩에 취약해 802.1X, 포트 시큐리티, DHCP snooping, DAI, NAC 등으로 보완한다.</p><p>최근에는 프라이버시 목적의 MAC 랜덤화가 확산돼 로그·접근 제어 정책 조정이 요구된다.</p><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><p>MAC 주소는 네트워크 인터페이스의 고유 식별자이며, 스위치는 이 MAC 을 학습해 프레임을 어떤 포트로 보낼지 결정한다. IP 로 목적지를 확인한 뒤 로컬 전송 시에는 ARP(또는 IPv6 의 NDP) 를 통해 해당 IP 의 MAC 을 찾아 물리 링크로 보낸다. 무선·모바일·가상화 환경에서는 MAC 이 동적으로 바뀌거나 논리적으로 할당되어 전통적 관리 방식만으론 충분하지 않다. 따라서 NAC, DHCP snooping, EVPN/VXLAN 같은 보완 기술과 운영 정책 (예외 정책·프라이버시 고려) 이 필요하다.</p><table><thead><tr><th>핵심 개념 (한글 / 약어)</th><th>정의</th><th>왜 중요한가</th></tr></thead><tbody><tr><td>MAC 주소 / MAC</td><td>네트워크 인터페이스에 할당되는 48 비트 식별자</td><td>데이터링크 계층 포워딩의 기본 키</td></tr><tr><td>조직 고유 식별자 / OUI</td><td>MAC 상위 24 비트로 제조사 식별자</td><td>자산 식별·관리 단서 제공</td></tr><tr><td>전역/로컬 비트 / U/L 비트</td><td>MAC 이 전역 (0) 인지 로컬 (1) 인지 표시</td><td>로컬 관리 주소 구분, 정책 처리</td></tr><tr><td>개별/그룹 비트 / I/G 비트</td><td>유니캐스트 (개별) 인지 멀티캐스트 (그룹) 인지 표시</td><td>브로드캐스트/멀티캐스트 처리 분기</td></tr><tr><td>BIA / LAA</td><td>제조시 고정 주소 (BIA) / 로컬 관리 주소 (LAA)</td><td>관리·충돌·정책 관점에서 상이 처리</td></tr><tr><td>ARP / Address Resolution Protocol</td><td>IPv4 주소→MAC 매핑 프로토콜</td><td>로컬 전송을 위한 L3→L2 해석</td></tr><tr><td>NDP / Neighbor Discovery Protocol</td><td>IPv6 의 이웃 발견 및 주소 해석</td><td>IPv6 환경의 필수 L2 매핑/보안 요소</td></tr><tr><td>MAC 학습 / (스위치)</td><td>스위치가 소스 MAC 으로 포트 학습</td><td>포워딩 효율화, 플러딩 감소</td></tr><tr><td>CAM 테이블 / CAM</td><td>스위치의 MAC→포트 매핑 저장소</td><td>포워딩·문제 진단의 핵심 데이터</td></tr><tr><td>멀티캐스트 매핑</td><td>IP 멀티캐스트 → 이더넷 멀티캐스트 변환 규칙</td><td>멀티캐스트 전달을 위한 규칙 이해 필요</td></tr><tr><td>MAC 랜덤화 / (Privacy MAC)</td><td>OS/디바이스가 임의 MAC 을 사용하는 기능</td><td>프라이버시 보호 / NAC 등 정책과 충돌 가능</td></tr><tr><td>EVPN / VXLAN</td><td>오버레이 기반 분산 MAC 학습·전달 기술</td><td>대규모·클라우드 환경에서 L2 확장성 제공</td></tr><tr><td>802.1X / (NAC)</td><td>포트 기반 인증 표준</td><td>디바이스 신뢰성 확보, 네트워크 접근 통제</td></tr><tr><td>DHCP snooping / DAI</td><td>DHCP 메시지 감시·ARP 스푸핑 방지 기능</td><td>네트워크 보안 강화, 바인딩 유지</td></tr></tbody></table><p>MAC 관련 개념들은 모두 데이터링크 계층에서의 식별·포워딩·보안과 직결된다. 실제 서비스에서는 MAC 기반 정책 (예: DHCP 예약, NAC) 과 보안 기능이 함께 설계되어야 한다.</p><h4 id=개념간-상호관계>개념간 상호관계<a hidden class=anchor aria-hidden=true href=#개념간-상호관계>#</a></h4><table><thead><tr><th>출발 개념</th><th style=text-align:right>관계 (→)</th><th>도착 개념</th><th>목적/설명</th></tr></thead><tbody><tr><td>MAC 주소</td><td style=text-align:right>→</td><td>스위치 MAC 학습</td><td>스위치는 소스 MAC 을 보고 포트 매핑을 기록</td></tr><tr><td>IP 주소</td><td style=text-align:right>→</td><td>ARP/NDP</td><td>로컬 전달 시 IP 를 MAC 으로 변환하기 위해 호출</td></tr><tr><td>ARP/NDP</td><td style=text-align:right>→</td><td>MAC 획득</td><td>획득한 MAC 으로 L2 프레임 전달</td></tr><tr><td>OUI</td><td style=text-align:right>→</td><td>자산 식별</td><td>제조사 기반 분류·인벤토리에 사용</td></tr><tr><td>MAC 랜덤화</td><td style=text-align:right>→</td><td>NAC 정책 충돌</td><td>랜덤 MAC 은 MAC 기반 인증을 우회/혼란시킬 수 있음</td></tr><tr><td>vNIC (가상 NIC)</td><td style=text-align:right>→</td><td>EVPN/VXLAN</td><td>오버레이에서 논리 MAC 을 분산 학습·전파</td></tr><tr><td>DHCP snooping</td><td style=text-align:right>→</td><td>DAI (Dynamic ARP Inspection)</td><td>DHCP 바인딩 기반으로 ARP 스푸핑 차단</td></tr><tr><td>802.1X (NAC)</td><td style=text-align:right>→</td><td>네트워크 접근 제어</td><td>인증된 장치만 포트 접근 허용</td></tr></tbody></table><p>IP 와 MAC 은 ARP/NDP 로 연결되고, 스위치의 MAC 학습은 포워딩 효율을 만든다. 가상화·랜덤화·보안 기능들은 이 기본 흐름에 영향을 주어 추가 정책·예외 처리를 필요로 한다.</p><h4 id=실무-구현-연관성>실무 구현 연관성<a hidden class=anchor aria-hidden=true href=#실무-구현-연관성>#</a></h4><table><thead><tr><th>실무 요소</th><th>무엇 (기능)</th><th>어떻게 (구현 방법)</th><th>왜 (목적/효과)</th></tr></thead><tbody><tr><td>NAC (802.1X)</td><td>포트 기반 인증</td><td>RADIUS, EAP, 인증서/계정 연동</td><td>무단 장치 차단, 사용자 기반 접근 통제</td></tr><tr><td>MAC 기반 DHCP 예약</td><td>특정 MAC 에 고정 IP 제공</td><td>DHCP 서버 (예: ISC, Kea) 에서 바인딩 설정</td><td>서비스에 고정 IP 보장 (서버·프린터)</td></tr><tr><td>DHCP snooping + DAI</td><td>DHCP 메시지 감시, ARP 검증</td><td>스위치 기능 활성화 (신뢰 포트 설정)</td><td>스푸핑·사기 ARP 방지, 바인딩 품질 확보</td></tr><tr><td>Port-security</td><td>포트별 허용 MAC 수 제한</td><td>스위치에서 포트별 설정 (정적/동적)</td><td>CAM overflow·무단 이동 방지</td></tr><tr><td>EVPN/VXLAN</td><td>데이터센터 L2 오버레이 확장</td><td>BGP-EVPN 컨트롤플레인 + VXLAN 데이터플레인</td><td>멀티테넌시·L2 확장·vNIC 이식성 제공</td></tr><tr><td>MAC 모니터링</td><td>CAM 상태·flapping 탐지</td><td>SNMP 트랩, 로그, NetFlow</td><td>장애 조기 인지·수렴 시간 문제 해결</td></tr><tr><td>무선 운영 (로밍·BSSID)</td><td>AP/클라이언트 MAC 관리</td><td>RADIUS, WLAN 컨트롤러, 적절한 예외정책</td><td>로밍 품질 향상, 보안 유지</td></tr><tr><td>가상화 관리</td><td>vNIC MAC 충돌·풀 관리</td><td>클라우드 콘트롤플레인, IPAM 연동</td><td>충돌 방지·자동화된 주소 관리</td></tr><tr><td>포렌식/감사</td><td>MAC 기반 이벤트 연계</td><td>로그 통합 (SIEM), DHCP/NAT 로그 보관</td><td>사고 조사·규정 준수</td></tr></tbody></table><p>실무 구현은 MAC 개념을 중심으로 NAC·DHCP·스위치 보안·오버레이 네트워킹·모니터링을 조합해서 진행된다. 각 기능은 보안·운영·확장성 요구를 충족시키기 위해 함께 설계돼야 한다.</p><h3 id=기초-조사-및-개념-정립>기초 조사 및 개념 정립<a hidden class=anchor aria-hidden=true href=#기초-조사-및-개념-정립>#</a></h3><h4 id=개념-정의-및-본질적-이해>개념 정의 및 본질적 이해<a hidden class=anchor aria-hidden=true href=#개념-정의-및-본질적-이해>#</a></h4><p>MAC 주소는 네트워크 케이블/무선 어댑터에 붙어 있는 <strong>고유한 물리적 식별자</strong>로, 같은 LAN 안에서 누가 누구에게 프레임 (데이터) 을 보내야 하는지 결정하는 데 쓰인다. 제조사가 부여하는 고정 MAC 도 있지만, 개인정보 보호나 가상환경 때문에 운영체제나 가상화 플랫폼이 임의 MAC 을 쓰기도 한다. 따라서 운영자는 MAC 을 신뢰 표시로만 보지 말고, 보안 (포트 인증 등)·모니터링 (로그·IPAM)·정책 (동적 할당 처리) 으로 보완해야 한다.</p><p><strong>본질적 포인트</strong>:</p><ol><li><strong>식별자 역할</strong>: 네트워크 세그먼트 내 정교한 송수신 식별—라우팅 이전 단계의 직접 전달 단위.</li><li><strong>고정성 vs 가변성</strong>: 제조사 고유 (BIT U/L = 0) 또는 로컬/랜덤화 (U/L = 1) 로 나뉘며, 프라이버시/가상화로 가변성이 증가.</li><li><strong>프로토콜 연계</strong>: ARP(IPv4)/NDP(IPv6) 에서 IP↔MAC 매핑, 스위치 학습 테이블 (CAM table) 에 의해 L2 전달 결정.</li><li><strong>보안·운영 중요성</strong>: 스푸핑·중복 발생 시 트래픽 도용·가용성 저하 → 포렌식·컴플라이언스에서 MAC 로그·변경 추적 필수.</li></ol><h5 id=형식-및-의미>형식 및 의미<a hidden class=anchor aria-hidden=true href=#형식-및-의미>#</a></h5><ul><li><strong>포맷</strong>: <code>XX:XX:XX:XX:XX:XX</code> (6 바이트, 16 진수)—EUI-48</li><li><strong>구성</strong>: <code>OUI (24bit)</code> + <code>NIC specific (24bit)</code></li><li><strong>비트 의미 (첫 바이트)</strong>:<ul><li><strong>LSB (I/G bit)</strong>: 0 = 개별 (Individual), 1 = 그룹 (Multicast)</li><li><strong>다음 비트 (U/L bit)</strong>: 0 = 전역 (IEEE 할당), 1 = 로컬 (관리자/임의)</li></ul></li></ul><h5 id=eui-64-변환-ipv6-slaac>EUI-64 변환 (IPv6 SLAAC)<a hidden class=anchor aria-hidden=true href=#eui-64-변환-ipv6-slaac>#</a></h5><ul><li>절차: EUI-48 을 두 부분으로 나누고 <code>FF:FE</code> 삽입 → 첫 바이트의 U/L 비트 반전</li><li>예: <code>00:1B:44:11:3A:B7</code> → <code>02:1B:44:FF:FE:11:3A:B7</code></li></ul><h5 id=배포형태>배포형태<a hidden class=anchor aria-hidden=true href=#배포형태>#</a></h5><ul><li><strong>Burned-in (제조사 고정)</strong></li><li><strong>관리자 할당 (네트워크 관리자/가상 NIC)</strong></li><li><strong>랜덤화 (프라이버시)</strong>—모바일/OS 에서 사용</li></ul><h5 id=기능연계>기능/연계<a hidden class=anchor aria-hidden=true href=#기능연계>#</a></h5><ul><li>스위치 CAM 학습 → 프레임 포워딩</li><li>ARP/NDP 에서 IP↔MAC 매핑</li><li>VLAN/Trunking: MAC 은 태그와 함께 포워딩 결정에 사용</li></ul><h5 id=보안문제점>보안·문제점<a hidden class=anchor aria-hidden=true href=#보안문제점>#</a></h5><ul><li><strong>스푸핑</strong>: 위조 MAC 으로 트래픽 가로채기</li><li><strong>중복</strong>: 가상머신·컨테이너로 인한 중복 MAC → 불통</li><li><strong>프라이버시 충돌</strong>: MAC 고정 → 개인 추적 가능</li></ul><h5 id=완화책-우선권>완화책 (우선권)<a hidden class=anchor aria-hidden=true href=#완화책-우선권>#</a></h5><ul><li>802.1X(포트 인증), Port-security(sticky), DHCP 스누핑 + DAI, 모니터링/알림, IPAM 기반 추적</li></ul><h4 id=등장-배경-및-발전-과정>등장 배경 및 발전 과정<a hidden class=anchor aria-hidden=true href=#등장-배경-및-발전-과정>#</a></h4><p>MAC 주소는 이더넷 프레임을 정확히 전달하기 위해 각 네트워크 인터페이스에 부여되는 <strong>물리적 식별자</strong>이다.<br>초기에는 제조사별로 고유한 48 비트 식별 (OUI+NIC) 이 표준이었지만, 장치 대량화·가상화·IPv6·개인정보 요구가 커지면서 EUI-64 같은 확장 포맷과 MAC 랜덤화 같은 운영 관행이 등장했다.<br>즉, MAC 은 &rsquo; 하드웨어 고유표시 &rsquo; 에서 &rsquo; 운영·프라이버시·클라우드 친화적 식별자 &rsquo; 로 역할이 확장되고 있다—이 변화가 왜 필요한지 (규모·보안·확장성) 와 어떤 트레이드오프 (추적성 vs 프라이버시) 가 있는지를 아는 것이 핵심이다.</p><h5 id=등장-배경>등장 배경<a hidden class=anchor aria-hidden=true href=#등장-배경>#</a></h5><ul><li><strong>공유 매체의 프레임 전달 문제</strong>: 동일 물리 매체 (버스·허브) 에서 목적지 식별 없이는 프레임 전달 불가 → 고유 식별 필요.</li><li><strong>제조사/생산 관리 필요성</strong>: 일관된 할당 체계 부재 시 충돌·중복 발생 → OUI 기반 중앙 등록 필요.</li><li><strong>인터넷·대규모 네트워크의 등장</strong>: 네트워크 확장과 라우팅/관리 이슈로 표준화 필요성 증가.</li><li><strong>새로운 요구사항</strong>: IPv6 인터페이스 ID, 가상 NIC, 개인정보보호 (프라이버시) 요구 등으로 포맷·운영 변화 촉발.</li></ul><h5 id=발전-과정>발전 과정<a hidden class=anchor aria-hidden=true href=#발전-과정>#</a></h5><table><thead><tr><th style=text-align:right>연도 (대략)</th><th>이벤트 (표준/변화)</th><th>등장 이유 (무엇이 문제였나)</th><th>핵심 개선/의미</th></tr></thead><tbody><tr><td style=text-align:right>1973</td><td>Ethernet 개념 (Parc) 출현</td><td>공유 매체에서 장치 식별 필요</td><td>프레임 단위 통신 모델과 장치 식별 도입</td></tr><tr><td style=text-align:right>1980</td><td>DIX Ethernet 스펙 (초기)</td><td>산업 표준화 요구</td><td>기본 MAC 주소 포맷 채택 (48bit)</td></tr><tr><td style=text-align:right>1983–1985</td><td>IEEE 802.3 채택</td><td>공통 표준/호환성 확보</td><td>Ethernet 표준화, 생태계 확장</td></tr><tr><td style=text-align:right>1990s</td><td>IEEE Registration Authority 운영 강화</td><td>OUI 관리 필요</td><td>제조사별 OUI 할당 체계 확립</td></tr><tr><td style=text-align:right>1990s–2000s</td><td>EUI-64 / IPv6 연동</td><td>IPv6 인터페이스 ID 필요</td><td>48bit→64bit 확장, SLAAC 연동 가능</td></tr><tr><td style=text-align:right>2010s</td><td>가상화/클라우드 확산</td><td>다중 NIC·가상 인터페이스 증가</td><td>소프트웨어적 MAC 관리, CNI 연동</td></tr><tr><td style=text-align:right>2014~</td><td>MAC 랜덤화 (모바일 기기)</td><td>위치/행태 추적 방지 (프라이버시)</td><td>클라이언트 단 랜덤 MAC 사용 → 추적 저감</td></tr></tbody></table><blockquote><p>참고: 연도 표기는 대표적 시기. 세부 연도는 문헌에 따라 일부 차이 있음 (검증 권장).</p></blockquote><pre class=mermaid>timeline
    title MAC 주소: 등장 → 발전 타임라인
    1973 : Ethernet 개념 (Xerox PARC) 등장
    1980 : DIX Ethernet 스펙(초기) 공개
    1983-1985 : IEEE 802.3 채택·표준화
    1990s : IEEE Registration Authority의 OUI 관리 강화
    1990s-2000s : EUI-64 / IPv6 연동 등장
    2010s : 가상화·클라우드에서의 MAC 운영 관행 등장
    2014~ : MAC 랜덤화(모바일 중심) 확산
</pre><p>위 표는 MAC 주소가 &rsquo; 물리적 장치 식별자 &rsquo; 로 시작해, 네트워크 표준화 (IEEE), IPv6 연계 (EUI-64), 가상화·클라우드 운영 관행, 그리고 개인정보 보호 (랜덤화) 로 진화한 흐름을 보여준다. 각 단계는 <strong>새로운 기술 환경이 제기한 문제 (식별·확장·프라이버시)</strong> 를 해결하는 방향으로 발전했다. 실무에서는 각 단계별로 도입 이유와 운영상의 trade-off(예: 추적성 vs 프라이버시) 를 반드시 고려해야 한다.</p><h4 id=해결하는-문제-및-핵심-목적>해결하는 문제 및 핵심 목적<a hidden class=anchor aria-hidden=true href=#해결하는-문제-및-핵심-목적>#</a></h4><ul><li><strong>MAC 주소는 " 같은 스위치/같은 VLAN 안에서 누구에게 프레임을 줄지 " 를 정하는 L2 주소</strong>다.</li><li><strong>IP 패킷이 도착하려면, 먼저 MAC 주소가 있어야 한다</strong>(ARP/NDP 가 이를 알려줌).</li><li><strong>현대 LAN 은 풀듀플렉스 스위칭</strong>이라 충돌이 없다. 충돌 얘기는 옛날 허브 환경 맥락.</li><li><strong>무선은 프라이버시 때문에 MAC 을 랜덤화</strong>하기도 한다 (관리·인증 설계 시 고려).</li><li><strong>보안은 MAC 필터가 아니라 802.1X 로</strong>(사용자/기기 인증 + 권한).</li></ul><h5 id=해결하는-문제>해결하는 문제<a hidden class=anchor aria-hidden=true href=#해결하는-문제>#</a></h5><table><thead><tr><th>문제 영역</th><th>개선/해결 방식</th><th>핵심 메커니즘</th><th>효과</th></tr></thead><tbody><tr><td>L2 단말 구분·추적</td><td>EUI-48/64, U/L·I/G 비트</td><td>UAA/LAA·개별/그룹 주소 체계</td><td>정확한 식별·스위칭 포워딩 안정화</td></tr><tr><td>L3→L2 해상</td><td>ARP/NDP 로 IP↔MAC 매핑</td><td>RFC 826/4861</td><td>동일 링크 전달·라우터/이웃 탐색</td></tr><tr><td>그룹 통신 효율</td><td>멀티캐스트 MAC 매핑</td><td>IPv4 01:00:5E/23bit, IPv6 33:33</td><td>대역 절감·그룹 전송 확장성</td></tr><tr><td>접속 제어·보안</td><td>802.1X(PNAC) 중심 설계</td><td>EAP/RADIUS 기반 인증</td><td>무단 접속 차단·감사 용이성 향상</td></tr><tr><td>충돌·성능</td><td>스위칭/풀듀플렉스</td><td>포트 단위 마이크로세그멘트</td><td>충돌 제거·처리량 안정화</td></tr></tbody></table><p>MAC 은 " 같은 링크 안에서 누구에게 줄지 " 를 결정하고, ARP/NDP 가 " 그 누구의 MAC 이 무엇인지 " 를 알려준다. 멀티캐스트 매핑·802.1X·풀듀플렉스로 실제 성능/보안/운영 품질이 완성된다.</p><h5 id=핵심-목적>핵심 목적<a hidden class=anchor aria-hidden=true href=#핵심-목적>#</a></h5><table><thead><tr><th>핵심 목적</th><th>설명</th><th>대표 표준/사실</th></tr></thead><tbody><tr><td>전역/로컬 단말 식별</td><td>UAA/LAA·U/L·I/G 로 주소 성격 규정</td><td>IEEE 튜토리얼 (U/L·I/G)</td></tr><tr><td>효율적 L2 전달</td><td>MAC 테이블 기반 포워딩·VLAN 경계</td><td>충돌 제거 (풀듀플렉스)</td></tr><tr><td>L3 상호운용</td><td>ARP/NDP 로 IP 트래픽 실전달</td><td>RFC 826/4861</td></tr><tr><td>그룹 통신 최적화</td><td>IPv4/IPv6 멀티캐스트 MAC 매핑</td><td>RFC 1112, RFC 2464</td></tr><tr><td>보안·거버넌스 기반</td><td>802.1X, BYOD 랜덤화 고려</td><td>IEEE 802.1X, iOS/Android 문서</td></tr></tbody></table><p>목적은 " 정확히 식별→정확히 전달→IP 와 연동→그룹 효율화→안전한 접속 " 의 연쇄다.</p><h5 id=해결하는-문제--핵심-목적-연관성성>해결하는 문제 ↔ 핵심 목적 연관성성<a hidden class=anchor aria-hidden=true href=#해결하는-문제--핵심-목적-연관성성>#</a></h5><table><thead><tr><th>문제 (좌)</th><th>핵심 목적 (우)</th><th>연관성 포인트</th></tr></thead><tbody><tr><td>L2 단말 구분</td><td>전역/로컬 단말 식별</td><td>주소 체계 (U/L·I/G) 로 관리·가시성 확보</td></tr><tr><td>L3→L2 해상</td><td>L3 상호운용</td><td>ARP/NDP 가 IP 트래픽을 MAC 으로 연결</td></tr><tr><td>그룹 통신 효율</td><td>그룹 통신 최적화</td><td>IPv4/IPv6 멀티캐스트 MAC 매핑 규칙 활용</td></tr><tr><td>접속 제어·보안</td><td>보안·거버넌스 기반</td><td>802.1X 로 인증·권한·감사 일원화</td></tr><tr><td>충돌·성능</td><td>효율적 L2 전달</td><td>스위칭/풀듀플렉스로 충돌 제거·처리량 안정</td></tr></tbody></table><p>각 문제는 대응 목적과 1:1 로 맞물려 있으며, 구현은 표준 (RFC·IEEE) 기반으로 수렴한다.</p><h4 id=전제-조건-및-요구사항>전제 조건 및 요구사항<a hidden class=anchor aria-hidden=true href=#전제-조건-및-요구사항>#</a></h4><p>MAC 주소는 이더넷 등 링크 계층에서 장치를 구분하는 48 비트 식별자다.<br>스위치는 들어온 프레임의 출발지 MAC 으로 포트 - 주소 맵을 만들고, 목적지 MAC 을 기준으로 프레임을 전달한다.<br>제조사 식별 (OUI) 로 주소 블록을 관리하지만, 가상화·OS 랜덤화로 MAC 이 바뀔 수 있으므로 네트워크 보안·인증은 MAC 만 믿지 않고 802.1X·NAC·DHCP 바인딩 같은 보완 기법을 함께 사용해야 한다.</p><table><thead><tr><th>분류</th><th style=text-align:right>항목</th><th>요구조건 / 설명</th><th>실무 체크포인트</th></tr></thead><tbody><tr><td>기술적 전제</td><td style=text-align:right>IEEE 802 호환 NIC</td><td>NIC/스위치가 IEEE 802 이더넷 규격 준수</td><td>장비 데이터시트 확인</td></tr><tr><td></td><td style=text-align:right>48 비트 주소 처리</td><td>스위치·NIC·관리 툴이 EUI-48 처리 가능</td><td>툴·로그 포맷 검증</td></tr><tr><td></td><td style=text-align:right>스위치 학습/포워딩 구현</td><td>소스 MAC 학습, CAM 테이블, 플러딩 동작</td><td>스위치 동작 모드 확인</td></tr><tr><td>운영 요구</td><td style=text-align:right>OUI(제조사 할당) 관리</td><td>제조사 (또는 조직) 가 OUI 또는 로컬 관리 정책 보유</td><td>제조사 OUI 확인, 로컬 MAC 정책 문서</td></tr><tr><td></td><td style=text-align:right>고유성 보장 절차</td><td>MAC 중복 검출·등록 프로세스 운영</td><td>IPAM/NAC 에 MAC 인벤토리 등록</td></tr><tr><td></td><td style=text-align:right>로컬/가상 MAC 정책</td><td>가상 NIC·컨테이너에 대한 MAC 할당 규칙</td><td>하이퍼바이저·CNI 정책 검사</td></tr><tr><td>보안 요구</td><td style=text-align:right>인증·접근 제어</td><td>802.1X, 포트 시큐리티, NAC 연계 권장</td><td>인증서·RADIUS 구성</td></tr><tr><td></td><td style=text-align:right>스푸핑·ARP 보호</td><td>DHCP Snooping, DAI, RA Guard 등 적용</td><td>스위치·라우터 기능 지원 여부</td></tr><tr><td>성능/확장</td><td style=text-align:right>CAM 테이블 규모·aging</td><td>스위치 메모리·테이블 한계 고려</td><td>포트당 학습 수·aging 타임 설정</td></tr><tr><td>관측성</td><td style=text-align:right>감사 로그·변경 관리</td><td>MAC 변경/랜덤화 이벤트 로깅</td><td>SIEM 연동·로그 보존 정책</td></tr><tr><td>규정·컴플라이언스</td><td style=text-align:right>개인정보·추적 정책</td><td>MAC 기반 위치/추적 정책의 법적 고려</td><td>법무·보안 검토</td></tr></tbody></table><p>MAC 주소 운영을 위해서는 <strong>기술적 전제 (IEEE 호환 장비, 48 비트 처리, 스위치의 학습/포워딩 메커니즘)</strong> 와 <strong>운영·보안 요구 (고유성 검증, OUI 관리, 가상 NIC 정책, 인증 및 스푸핑 방어)</strong> 가 모두 충족되어야 한다. 특히 가상화·모바일 환경에서 MAC 이 변경될 수 있으므로 <strong>MAC 단독 식별에 의존하지 않는 인증 (802.1X 등) 과 중앙 인벤토리 (IPAM/NAC)·감사 로그 연동</strong>이 필수다.<br>스위치 CAM 테이블 한계와 aging 정책은 네트워크 확장성·성능 설계에 직접적인 영향을 주니 설계 초기부터 고려해야 한다.</p><h4 id=핵심-특징>핵심 특징<a hidden class=anchor aria-hidden=true href=#핵심-특징>#</a></h4><p>MAC 주소는 네트워크의 <strong>데이터 링크 (L2)</strong> 에서 동작하는 48 비트 식별자 (EUI-48) 로, 제조사 식별자 (OUI) 를 포함해 전 세계 중복을 방지한다.<br>스위치는 소스 MAC 을 학습해 프레임을 전달하고 ARP/NDP 를 통해 IP-to-MAC 매핑을 완성한다.</p><p>MAC 은 물리적 (BIA) 일 수도, 가상 NIC 가 소프트웨어로 부여할 수도 있으며, I/G(멀티캐스트)·U/L(로컬) 비트로 추가 의미를 가진다.<br>단점은 <strong>스푸핑·플러딩</strong>에 취약하다는 점이며, 이에 대응하려면 802.1X, 포트 시큐리티, DHCP snooping, DAI, NAC 같은 통제 수단을 도입해야 한다. 또한 모바일 프라이버시를 위해 MAC 랜덤화가 널리 쓰이며, 이는 자산 관리·로깅 정책에 영향을 준다.</p><table><thead><tr><th>핵심 특징</th><th>기술적 근거</th><th>다른 기술과의 차별점 (왜/무엇으로/어떻게)</th></tr></thead><tbody><tr><td>글로벌 유일성 (OUI)</td><td>IEEE OUI(상위 24 비트) 등록 체계</td><td>IP 의 논리적 주소와 달리 제조사 기반 고유 식별자 → L2 식별에 적합</td></tr><tr><td>L2 식별자·스위치 학습</td><td>스위치 CAM/FDB, ARP/NDP 연계</td><td>라우터를 통한 L3 전달이 아닌 동일 세그먼트 내 직접 포워딩</td></tr><tr><td>I/G, U/L 비트 의미</td><td>첫 옥텟의 최하위 2 비트 규약</td><td>멀티캐스트/로컬관리 표시로 주소의 역할·관리 모드 구분</td></tr><tr><td>하드웨어·소프트웨어 병존</td><td>BIA(ROM) 및 가상 NIC 의 소프트웨어 MAC</td><td>물리적 고정성 vs 가상 유연성 (클라우드·가상화)</td></tr><tr><td>프라이버시 (랜덤화)</td><td>모바일/무선 스캐닝 대응 정책</td><td>트래킹 방지 vs 자산·로그·접근 제어 영향</td></tr><tr><td>보안 취약성 (스푸핑·플러딩)</td><td>L2 프레임의 인증 부재</td><td>상위계층 인증 (TLS)·802.1X·NAC 등으로 보완 필요</td></tr><tr><td>프로토콜 연계성</td><td>IPv6 SLAAC(EUI-64), VLAN, 802.11 BSSID</td><td>L2 와 L3·무선 스택 간의 기술적 연결 고리 제공</td></tr></tbody></table><p>MAC 주소는 L2 에서의 물리적/논리적 식별자 역할을 하며, OUI 로 보장되는 유일성·비트별 의미 (I/G, U/L), 가상/물리 병존 특성, 그리고 프라이버시·보안 이슈가 핵심이다. IP 와 근본적으로 다른 목적 (로컬 식별 vs 전역 라우팅) 을 가지므로 네트워크 설계 시 각각의 책임을 분명히 나눠 대책을 세워야 한다.</p><h4 id=표준화-배경-및-호환성-요구사항>표준화 배경 및 호환성 요구사항<a hidden class=anchor aria-hidden=true href=#표준화-배경-및-호환성-요구사항>#</a></h4><p>표준화는 장비·사이트 간 &rsquo; 같은 언어 &rsquo; 로 주소를 주고받기 위해 필요하다.<br>IEEE 는 MAC/EUI 주소의 형식과 블록을 할당하여 제조사 식별과 고유성 보장을 담당하고, IETF 는 ARP/NDP 같은 프로토콜과 운영 권고를 통해 서로 다른 네트워크 환경에서 올바르게 동작하도록 지침을 제공한다.</p><p>실무에서는 이 표준을 지키면 상호운용성·관리성이 확보되지만, 무선 랜덤화나 가상화 같은 최신 환경에서는 추가 정책 (예: MAC 랜덤화 예외, vNIC 관리 규칙) 이 필요하다.</p><table><thead><tr><th style=text-align:right>항목</th><th>핵심 내용</th><th>실무 영향 / 비고</th></tr></thead><tbody><tr><td style=text-align:right>표준화 배경</td><td>전 세계 장비 간 일관된 식별자 필요 → 상호운용성·관리성 확보</td><td>자산관리·보안·자동화 구현 기반</td></tr><tr><td style=text-align:right>표준화 주체</td><td>IEEE Registration Authority, IEEE 802 위원회, IETF</td><td>OUI 할당 · 물리/데이터링크 규정 · 운영 권고</td></tr><tr><td style=text-align:right>핵심 표준·문서</td><td>EUI-48/EUI-64 규격, IEEE 802.3/802.11/802.1, RFC 826/4861/4941/7042 등</td><td>구현 시 참조 문서로 명시적 링크·버전 관리 필요</td></tr><tr><td style=text-align:right>주소 블록 관리</td><td>MA-L / MA-M / MA-S 등 블록 할당 규칙</td><td>OUI 등록·관리 절차 준수 필요</td></tr><tr><td style=text-align:right>호환성 요구사항</td><td>주소 형식, 비트 의미 (U/L,I/G), 프레임·프로토콜 포맷, 캡슐화 규칙</td><td>장비 간 통신 오류·보안 이슈 방지</td></tr><tr><td style=text-align:right>추가 고려사항</td><td>무선 MAC 랜덤화, 가상화 (vNIC)/오버레이, 로컬관리 주소 정책</td><td>표준 외 운영 규약 (예: 예외 정책) 문서화 권장</td></tr></tbody></table><p>표준화는 MAC/EUI 식별자를 전 세계적으로 일관되게 관리하기 위한 체계로, IEEE RA 가 블록을 할당하고 IEEE 802 계열이 물리·데이터링크 규칙을, IETF 가 운영·상호운용 지침을 제공한다. 실무에서는 EUI 형식 준수와 관련 RFC/IEEE 문서 참조를 기본으로 하되, 무선 랜덤화나 클라우드 가상화 같은 최신 환경을 반영한 운영 규약과 예외 처리 절차를 반드시 마련해야 한다.</p><h5 id=표준화-배경>표준화 배경<a hidden class=anchor aria-hidden=true href=#표준화-배경>#</a></h5><ul><li>대규모 네트워크에서 충돌 없는 고유 식별자 필요 → 자산관리·라우팅/포워딩 정확성 확보</li><li>제조사별 OUI 기반 관리 필요 → 트래킹·책임 소재 확인 가능</li><li>보안/운영 자동화 (예: NAC, DHCP 예약) 구현을 위한 표준화된 식별 규칙 필요</li></ul><h5 id=표준화-현황>표준화 현황<a hidden class=anchor aria-hidden=true href=#표준화-현황>#</a></h5><ul><li>IEEE Registration Authority: OUI, MA-L/M/S 블록 관리 및 등록 절차</li><li>IEEE 802.3 / 802.11 / 802.1: 물리·데이터링크/브리징/무선 규격과 동작 규칙</li><li>IETF (RFC 군): ARP/NDP/프라이버시/운영 권고 문서 (예시: RFC 826, RFC 4861, RFC 4941, RFC 7042 등)</li></ul><h5 id=호환성-요구사항>호환성 요구사항<a hidden class=anchor aria-hidden=true href=#호환성-요구사항>#</a></h5><ul><li>EUI 형식 (48/64 비트) 과 비트 의미 (U/L, I/G) 준수</li><li>프레임·프로토콜 포맷 준수 (이더넷 헤더, ARP/NDP 메시지 등)</li><li>무선 프라이버시 기능과 기업 정책 사이의 예외 규약 적용</li><li>가상화 환경에서의 MAC 관리 정책 (할당 풀, 충돌 방지, IPAM 연동) 수립</li><li>표준 문서 (RFC/IEEE 문서) 에 기반한 구현·운영 절차 문서화</li></ul><h3 id=핵심-원리-및-이론적-기반>핵심 원리 및 이론적 기반<a hidden class=anchor aria-hidden=true href=#핵심-원리-및-이론적-기반>#</a></h3><h4 id=핵심-원칙-및-설계-철학>핵심 원칙 및 설계 철학<a hidden class=anchor aria-hidden=true href=#핵심-원칙-및-설계-철학>#</a></h4><p>MAC 주소는 네트워크 카드에 새겨진 <strong>물리적 식별자</strong>로, 같은 LAN 안에서 누가 누구에게 데이터를 보내야 하는지 알려주는 역할을 한다.<br>제조사가 부여한 고정 값이 일반적이지만, 개인정보 보호 (임시 MAC) 나 가상화 환경 (가상 NIC) 에서는 바뀔 수 있다. 운영자는 MAC 을 기반으로 접근 제어·DHCP 예약·로그를 구성하지만, MAC 이 변할 가능성 (랜덤화/가상화) 을 항상 고려해서 정책을 설계해야 한다.</p><h5 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h5><table><thead><tr><th>원칙 (한글) / (영어)</th><th style=text-align:right>목적 (What)</th><th>왜 필요한가 (Why)</th><th>구현/메커니즘 (How)</th><th>실무 고려사항</th></tr></thead><tbody><tr><td>전역 고유성 (Global Uniqueness)</td><td style=text-align:right>장치 식별의 중복 방지</td><td>포워딩·추적·감사 정확성 확보</td><td>IEEE OUI 할당, 제조사 Burn-in MAC</td><td>OUI 위조·로컬 MAC 사용 주의</td></tr><tr><td>로컬 유효성 (Local Significance)</td><td style=text-align:right>L2 범위 내 유효한 식별</td><td>L3/라우팅 경계와 역할 분리</td><td>스위치 학습 (CAM table), 라우터 경계</td><td>브로드캐스트 도메인 설계 중요</td></tr><tr><td>하드웨어 기반성 (Hardware-Based Identity)</td><td style=text-align:right>안정적 식별자 제공</td><td>재부팅·교체 후 일관성</td><td>Burn-in, NIC 펌웨어</td><td>가상 NIC·컨테이너 환경의 예외 처리</td></tr><tr><td>단순성·확장성·투명성 (Design Simplicity/Scalability)</td><td style=text-align:right>운영 효율성·상호운용성</td><td>대규모 네트워크 관리 용이</td><td>48bit 구조, 표준 프레임 포맷</td><td>프라이버시 (랜덤화) 와 충돌가능성 고려</td></tr></tbody></table><p>MAC 의 목적은 &rsquo; 같은 LAN 안에서 누가 누구인지 정확히 알려주는 것 &rsquo; 이며, 이를 위해 IEEE 가 제조사별 OUI 를 관리한다. 그러나 가상화·프라이버시 등 현대 환경은 이 모델에 예외를 만들므로 운영 설계 시 이를 고려해야 한다.</p><h5 id=설계-철학>설계 철학<a hidden class=anchor aria-hidden=true href=#설계-철학>#</a></h5><table><thead><tr><th>설계 철학 (한글) / (영어)</th><th style=text-align:right>목적 (What)</th><th>왜 필요한가 (Why)</th><th>실무 적용 예시</th><th>트레이드오프 (주의점)</th></tr></thead><tbody><tr><td>단순성 (Simplicity)</td><td style=text-align:right>구현·운영 복잡도 최소화</td><td>빠른 상호운용성과 오류 감소</td><td>Ethernet 프레임 단순 포맷</td><td>복잡한 요구 (보안·정책) 에선 확장성 제한</td></tr><tr><td>확장성 (Scalability)</td><td style=text-align:right>제조사·장비 증가에 대응</td><td>대규모 배포 시 충돌 회피</td><td>OUI 할당 체계</td><td>주소 고갈은 아니지만 관리 필요</td></tr><tr><td>투명성 (Transparency)</td><td style=text-align:right>사용자·앱 개입 최소화</td><td>운영 편의성, 자동 동작 보장</td><td>NIC 기본식별, 스위치 학습</td><td>프라이버시 요구와 충돌 가능</td></tr><tr><td>유연성 (관리 가능성)</td><td style=text-align:right>로컬/가상시스템 허용</td><td>현대 클라우드/모바일 환경 대응</td><td>로컬 MAC, 가상 NIC, 랜덤화</td><td>고정성 기대하는 정책과 충돌</td></tr></tbody></table><p>MAC 설계 철학은 &rsquo; 간단하고 확장 가능한 물리 식별자 &rsquo; 로서 네트워크의 근간을 쉽게 만들려는 것. 그러나 현대의 가상화·프라이버시 요구는 이 철학에 유연성을 요구하므로 운영 측면에서 균형 (투명성 vs 유연성) 을 항상 고려해야 한다.</p><h4 id=기본-동작-원리-및-메커니즘>기본 동작 원리 및 메커니즘<a hidden class=anchor aria-hidden=true href=#기본-동작-원리-및-메커니즘>#</a></h4><p>이더넷 네트워크에서는 기기들이 서로 주고받는 단위가 <strong>프레임</strong>이고, 이 프레임의 송수신 식별은 <strong>MAC 주소</strong>로 이루어진다.<br>스위치는 들어오는 프레임의 출발 MAC 을 기억해 어느 포트에 해당 장치가 있는지 학습하고, 목적지 MAC 을 알고 있으면 그 포트로 직접 보내며 모르고 있으면 VLAN 전체로 흩뿌린다 (플러딩).<br>IP 기반 통신은 ARP(또는 IPv6 의 Neighbor Discovery) 로 IP→MAC 을 바꿔주며, 운영 환경에서는 MAC 테이블 용량·보안 (스푸핑 방지)·가상화·프라이버시 (랜덤화) 같은 추가 고려사항이 필요하다.</p><table><thead><tr><th style=text-align:right>단계</th><th>동작 (요약)</th><th>역할/목적</th><th>트리거/조건</th><th>실무 영향</th></tr></thead><tbody><tr><td style=text-align:right>1</td><td>프레임 생성</td><td>송신자가 dst MAC 으로 프레임 생성</td><td>호스트가 dst MAC 을 알고 있거나 ARP 결과가 있을 때</td><td>ARP 미존재 시 브로드캐스트/지연 발생</td></tr><tr><td style=text-align:right>2</td><td>스위치 학습</td><td>ingress 포트 ↔ src MAC 등록</td><td>모든 수신 프레임마다</td><td>스위치가 점점 포워딩 최적화</td></tr><tr><td style=text-align:right>3</td><td>포워딩 결정</td><td>dst MAC 이 있으면 unicast, 없으면 flooding</td><td>CAM 에 엔트리 존재 여부</td><td>플러딩은 대역폭·보안에 영향</td></tr><tr><td style=text-align:right>4</td><td>ARP 처리</td><td>IP → MAC 매핑 제공</td><td>IP 통신 시 ARP 요청 발생</td><td>ARP 캐시 만료/수정 주기 민감</td></tr><tr><td style=text-align:right>5</td><td>MAC aging</td><td>오래된 엔트리 제거</td><td>설정된 타이머 만료</td><td>이동성 많은 환경에서 재학습 비용</td></tr><tr><td style=text-align:right>6</td><td>VLAN 격리</td><td>브로드캐스트 도메인 분리</td><td>VLAN 태깅/포트 구성</td><td>보안·성능 격리 가능</td></tr><tr><td style=text-align:right>7</td><td>포트 시큐리티</td><td>MAC 고정/제한, 침입 차단</td><td>정책 기반 (허용 MAC 목록 등)</td><td>MAC 랜덤화·다이내믹 디바이스에서 영향</td></tr><tr><td style=text-align:right>8</td><td>멀티캐스트 처리</td><td>IGMP snooping 등으로 효율 전달</td><td>멀티캐스트 트래픽 존재 시</td><td>멀티캐스트 최적화 필요</td></tr><tr><td style=text-align:right>9</td><td>가상화/CNI</td><td>가상 NIC 이 MAC 관리</td><td>VM/컨테이너 생성·이동</td><td>DHCP 바인딩·로깅 정책 재검토</td></tr><tr><td style=text-align:right>10</td><td>공격/방어</td><td>CAM overflow, ARP spoofing 등</td><td>악의적 트래픽</td><td>보안 장비/모니터링 필요</td></tr></tbody></table><p>프레임 생성→스위치 학습→포워딩의 기본 루프가 핵심이며, ARP 와 MAC 테이블 유지 (aging), VLAN·포트 보안·가상화 연계가 운영에서 성능·보안·관리에 직접적인 영향을 준다.</p><h5 id=흐름도>흐름도<a hidden class=anchor aria-hidden=true href=#흐름도>#</a></h5><pre class=mermaid>sequenceDiagram
  participant H1 as Host A (IP A / MAC a1)
  participant SW as L2 Switch (CAM)
  participant H2 as Host B (IP B / MAC b1)
  participant GW as Gateway/Router

  H1-&gt;&gt;SW: Frame(src=a1,dst=b1?)  %% 송신
  note right of SW: SW learns a1↔portX
  alt SW CAM has dst b1
    SW-&gt;&gt;H2: Unicast frame to portY
  else SW CAM missing dst
    SW-&gt;&gt;SW: Flood to VLAN (broadcast)
    SW--&gt;&gt;H2: Frame delivered to all ports in VLAN
  end
  alt H2 is target
    H2-&gt;&gt;SW: Reply frame(src=b1,dst=a1)
    note right of SW: SW learns b1↔portY then forwards to portX
    SW-&gt;&gt;H1: Unicast forward
  end

  %% ARP case
  H1-&gt;&gt;SW: ARP Request (dst IP=B, dst MAC=FF:FF:FF)
  SW-&gt;&gt;H2: Flood ARP
  H2-&gt;&gt;SW: ARP Reply (src MAC=b1)
  SW-&gt;&gt;H1: Deliver ARP Reply
</pre><ol><li>Host A 가 프레임을 보내면 스위치는 송신 MAC 과 포트를 학습한다.</li><li>목적지 MAC 이 테이블에 있으면 해당 포트로 유니캐스트 전달.</li><li>목적지가 없으면 VLAN 내 모든 포트로 플러딩한다 (브로드캐스트).</li><li>ARP 는 IP→MAC 매핑을 위해 브로드캐스트 방식으로 동작하고, 응답이 돌아오면 통신이 이어진다.</li><li>운영 정책 (포트 시큐리티, VLAN, IGMP snooping 등) 에 따라 플로우가 제어된다.</li></ol><h4 id=데이터-및-제어-흐름>데이터 및 제어 흐름<a hidden class=anchor aria-hidden=true href=#데이터-및-제어-흐름>#</a></h4><ul><li><strong>누가 받는지</strong>를 정하는 건 <strong>MAC</strong>, <strong>누구에게 줄지</strong>를 찾게 해주는 건 같은 링크의 <strong>ARP/NDP</strong>다.</li><li>스위치는 <strong>본 프레임의 출발지 MAC 을 보고 포트 매핑을 학습</strong>하고, 오래 안 보이면 잊는다 (에이징).</li><li>무선·BYOD 환경에선 <strong>랜덤 MAC</strong>으로 주소가 바뀌기도 한다 → 추적/인증은 <strong>MAC 단독</strong> 대신 <strong>NAC·802.1X</strong> 같은 상위 정책과 결합하는 것을 권장한다.</li></ul><table><thead><tr><th>단계</th><th>입력/조건</th><th>핵심 동작 (데이터/제어)</th><th>산출/상태</th><th>운영 포인트</th></tr></thead><tbody><tr><td>제조/할당</td><td>IEEE RA 의 MA-L/MA-M/MA-S</td><td>OUI 기반 EUI-48/64 생성·ROM 저장</td><td>전역/UAA MAC 준비</td><td>블록·대역 관리 (제조사)</td></tr><tr><td>활성화</td><td>NIC 링크업</td><td>드라이버→OS 등록, 첫 프레임 Tx</td><td>스위치가 Src MAC 학습</td><td>초기 플러딩은 정상 동작</td></tr><tr><td>해상·전달</td><td>같은 링크 L3 통신</td><td>ARP/NDP 로 IP→MAC</td><td>목적지 MAC 확정</td><td>IPv6 는 NDP·링크로컬 필수</td></tr><tr><td>학습·에이징</td><td>트래픽 유무</td><td>CAM 테이블 갱신/타임아웃</td><td>오래된 MAC 제거</td><td>에이징 튜닝·정적 MAC 예외</td></tr><tr><td>운영·보안</td><td>정책/변경</td><td>NAC/802.1X, LAA/랜덤 MAC/VM 처리</td><td>추적·감사 일관성</td><td>무선 프라이버시 정책 고려</td></tr></tbody></table><p><strong>출발지로 학습, 목적지로 포워딩, 오래되면 잊기</strong>가 스위치의 기본 리듬이다. L3 통신은 항상 <strong>IP→MAC 해상</strong>이 전제다.</p><h5 id=정리>정리<a hidden class=anchor aria-hidden=true href=#정리>#</a></h5><ol><li><strong>제조·할당</strong>: IEEE RA 의 MA-L/MA-M/MA-S 블록이 기업에 부여되고, 제조사는 이를 기반으로 각 NIC 에 EUI-48/64 를 구워 넣는다.</li><li><strong>활성화</strong>: 부팅/링크업 시 NIC 가 ROM 의 MAC 을 드라이버→OS 에 공개, 첫 프레임을 보낸 순간 스위치는 <strong>Src MAC–Port</strong>를 학습한다.</li><li><strong>해상·전달</strong>: 같은 링크의 L3 통신은 **ARP(NDP)**로 목적지 MAC 을 알아낸 뒤 이더넷 프레임으로 전달된다.</li><li><strong>학습·에이징</strong>: 스위치는 <strong>활동이 없는 MAC 엔트리를 타이머로 제거</strong>해 테이블을 건강하게 유지한다.</li><li><strong>동적 변경·보안</strong>: LAA/랜덤 MAC/가상 NIC 로 주소가 변할 수 있다. 특히 Wi-Fi 는 <strong>네트워크별 프라이빗 주소</strong>와 <strong>주기적 회전</strong>을 사용하므로, 자산·접속 정책은 장치 아이덴티티 (802.1X 등) 와 연동해야 한다.</li></ol><h5 id=흐름도-1>흐름도<a hidden class=anchor aria-hidden=true href=#흐름도-1>#</a></h5><pre class=mermaid>flowchart TD
  A[&#34;IEEE RA 블록 배정&lt;br/&gt;(MA-L/MA-M/MA-S)&#34;] --&gt; B[제조사: EUI-48/64 생성&lt;br/&gt;ROM/EEPROM 저장]
  B --&gt; C[NIC 활성화/링크업&lt;br/&gt;드라이버→OS 등록]
  C --&gt; D{목적지 MAC 보유?}
  D -- &#34;같은 링크의 L3 통신&#34; --&gt; E[&#34;ARP(IPv4)/NDP(IPv6)&lt;br/&gt;IP→MAC 해상&#34;]
  D -- &#34;L2만으로 충분&#34; --&gt; F[바로 프레임 송신]
  E --&gt; F[프레임 송신: Dst/Src MAC 포함]
  F --&gt; G[&#34;스위치 수신: Src MAC 학습(CAM)&#34;]
  G --&gt; H{CAM에 Dst MAC 존재?}
  H -- &#34;예&#34; --&gt; I[지정 포트로 포워딩]
  H -- &#34;아니오&#34; --&gt; J[&#34;동일 VLAN 플러딩(일시)&#34;]
  I --&gt; K[수신 NIC: MAC 필터링 후 상위로]
  J --&gt; K[수신 NIC: MAC 필터링 후 상위로]
  K --&gt; L[스위치 CAM 에이징 타이머&lt;br/&gt;비활성 엔트리 제거]
  L --&gt; M{&#34;주소 변경 이벤트? &lt;br/&gt;(LAA/랜덤/가상화)&#34;}
  M -- &#34;예&#34; --&gt; N[IPAM/NAC 동기화·정책 재평가]
  M -- &#34;아니오&#34; --&gt; O[정상 운영 지속]

  %% 보완 포인트
  %% - IPv6는 RFC2464 기반 링크로컬/RA/NS/NA 흐름
  %% - 무선은 랜덤 MAC/회전 → NAC와 연동 필요
</pre><h4 id=구조-및-구성-요소>구조 및 구성 요소<a hidden class=anchor aria-hidden=true href=#구조-및-구성-요소>#</a></h4><p>MAC 주소는 이더넷 프레임의 출발지·목적지를 지정하는 48 비트 값으로, 상위 24 비트 (OUI) 는 제조사 식별, 하위 24 비트는 장치별 번호다.<br>첫 옥텟의 두 비트 (I/G, U/L) 는 주소의 전달 범위 (유니캐스트/멀티캐스트) 와 할당 종류 (글로벌/로컬) 를 나타낸다.<br>L2 스위치는 수신한 프레임의 출발지 MAC 으로 어느 포트에 장치가 있는지 학습하고, 목적지 MAC 을 찾아 해당 포트로 프레임을 전달한다.<br>가상화·OS 수준의 MAC 변경 (랜덤화)·로컬 관리 MAC 은 이 흐름을 복잡하게 하므로, 운영에서는 IPAM·NAC·802.1X 같은 추가 식별·인증 체계를 병행해 신뢰성을 확보해야 한다.</p><ul><li><strong>구조 (무엇으로 구성되는가)</strong>: 48 비트 비트필드 (Octet1.) → I/G 및 U/L 플래그 포함 → OUI(24 비트) + NIC(24 비트). 주소 유형 (유니/멀티/브로드캐스트). 표현법 (콜론/하이픈/점).</li><li><strong>구성요소 (무엇이 동작하는가)</strong>: NIC(주소 소유·변경), 스위치 (학습·포워딩), CAM 테이블 (매핑 저장), 관리 시스템 (IPAM/NAC/SIEM), 보안기능 (포트 시큐리티 등).</li></ul><h5 id=구조>구조<a hidden class=anchor aria-hidden=true href=#구조>#</a></h5><p>MAC 주소는 6 바이트 (48 비트) 로 구성된 링크 계층 식별자다.<br>앞 3 바이트는 제조사 (OUI), 나머지 3 바이트는 장치 일련번호이며, 특정 비트로 유니캐스트/멀티캐스트와 전역/로컬 할당 여부를 나타낸다.<br>스위치는 이 주소를 기반으로 L2 포워딩 결정을 내리며, 가상화나 모바일 프라이버시 기능이 있는 환경에서는 MAC 만으로 장치를 완전히 신뢰하면 안 된다.</p><h6 id=mac-주소-구조의-역할기능특징-및-상호관계>MAC 주소 구조의 역할·기능·특징 및 상호관계<a hidden class=anchor aria-hidden=true href=#mac-주소-구조의-역할기능특징-및-상호관계>#</a></h6><table><thead><tr><th>구조 요소</th><th>역할</th><th style=text-align:right>기능</th><th>특징</th><th>상호관계</th></tr></thead><tbody><tr><td>비트 구조 (48 비트)</td><td>전체 식별자 제공</td><td style=text-align:right>프레임 식별키</td><td>OUI+NIC 결합, I/G·U/L 포함</td><td>스위치 포워딩 키, IPAM 키</td></tr><tr><td>OUI (상위 24 비트)</td><td>제조사 식별</td><td style=text-align:right>장치군 구분</td><td>IEEE 할당, 전역식별 기여</td><td>제조사 DB ↔ 자산관리</td></tr><tr><td>NIC 고유번호 (하위 24 비트)</td><td>장치별 구분</td><td style=text-align:right>일련번호 기능</td><td>제조사 내부 정책 의존</td><td>OUI 와 결합해 MAC 형성</td></tr><tr><td>I/G 비트</td><td>전달 범위 판별</td><td style=text-align:right>유니/멀티 결정</td><td>LSB 위치 (Octet1 bit0)</td><td>IGMP/MLD 와 연동</td></tr><tr><td>U/L 비트</td><td>할당 주체 표기</td><td style=text-align:right>전역/로컬 구분</td><td>로컬 MAC 은 U/L=1</td><td>가상 NIC·테스트 환경과 연계</td></tr><tr><td>주소 범주</td><td>전송 스코프 정의</td><td style=text-align:right>브로드캐스트/멀티캐스트 처리</td><td>IPv6 은 브로드캐스트 없음</td><td>L3 프로토콜 (ARP/ND) 와 연동</td></tr><tr><td>표현 방식</td><td>가독성·로그 표준화</td><td style=text-align:right>표기 규칙 통일</td><td>다양한 표기 포맷 존재</td><td>모니터링·스크립트 표기 규정 필요</td></tr></tbody></table><p>MAC 구조의 각 요소가 네트워크에서 어떤 역할을 하고 어떤 기능적 특징을 가지며 다른 구성요소와 어떻게 연결되는지를 보여준다. 설계 시에는 각 요소의 상호관계 (예: OUI → 자산관리, I/G → 멀티캐스트 처리) 를 반영해 운영·보안·모니터링 정책을 수립해야 한다.</p><h6 id=mac-구조의-운영제한실무-고려사항>MAC 구조의 운영·제한·실무 고려사항<a hidden class=anchor aria-hidden=true href=#mac-구조의-운영제한실무-고려사항>#</a></h6><table><thead><tr><th>구조 요소</th><th>비트 위치 / 표현 예</th><th style=text-align:right>운영 리스크</th><th>권장 운영 액션</th></tr></thead><tbody><tr><td>비트 구조</td><td>Octet1. (예: AA:BB:CC:DD:EE:FF)</td><td style=text-align:right>비트 인덱스 혼동 (문서 불일치)</td><td>설계 문서에 비트 인덱스 표기</td></tr><tr><td>OUI</td><td>상위 24 비트 (AA:BB:CC:xx:xx:xx)</td><td style=text-align:right>제조사 변경·복제 가능성</td><td>자산 DB 에 OUI 매핑</td></tr><tr><td>U/L bit</td><td>Octet1 bit1</td><td style=text-align:right>로컬 MAC 중복 위험</td><td>로컬 MAC 정책·IPAM 등록</td></tr><tr><td>I/G bit</td><td>Octet1 bit0</td><td style=text-align:right>멀티캐스트 오용 시 트래픽 증가</td><td>IGMP/MLD 필터 정책</td></tr><tr><td>EUI-64 연계</td><td>EUI-64 변환 규칙</td><td style=text-align:right>개인정보 (추적) 이슈</td><td>privacy extensions 사용 권장</td></tr><tr><td>표기법</td><td><code>:</code> / <code>-</code> / <code>.</code></td><td style=text-align:right>스크립트 파싱 오류</td><td>운영 표준 포맷 정의</td></tr><tr><td>CAM 테이블</td><td>스위치 메모리 제약</td><td style=text-align:right>학습 폭발 → 플러딩</td><td>VLAN 분할·포트당 학습 제한</td></tr></tbody></table><p>운영 관점에서 MAC 구조가 가지는 실무적 리스크 (문서 혼선·중복·추적 문제) 와 이를 완화하기 위한 권장 액션을 정리했다. 특히 EUI-64 로 인한 개인정보 문제나 CAM 테이블 한계는 설계 초기에 반영해야 하는 항목이다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>MAC (표준 표기) : 00:11:22:33:44:55
</span></span><span class=line><span class=cl>바이트(6)         : [00] [11] [22] [33] [44] [55]
</span></span><span class=line><span class=cl>상위 3바이트(OUI) : 00:11:22   &lt;- 제조사 할당
</span></span><span class=line><span class=cl>하위 3바이트      : 33:44:55   &lt;- 장치/인터페이스 식별
</span></span></code></pre></td></tr></table></div></div><ul><li>전체 비트 수: <code>48</code> (약 <code>2^48 ≈ 2.8e14</code> 주소)</li><li>표기 방식: <code>XX:XX:XX:XX:XX:XX</code> 또는 <code>XXXX.XXXX.XXXX</code> 등</li></ul><h6 id=첫-옥텟의-하위-2-비트>첫 옥텟의 하위 2 비트<a hidden class=anchor aria-hidden=true href=#첫-옥텟의-하위-2-비트>#</a></h6><table><thead><tr><th>비트</th><th>이름</th><th>값</th><th>의미</th></tr></thead><tbody><tr><td>b1</td><td>U/L(Universal/Local) Flag</td><td>0</td><td>전역 (IEEE 배정: UAA)</td></tr><tr><td></td><td></td><td>1</td><td>로컬 (관리자가 지정: LAA)</td></tr><tr><td>b0</td><td>I/G(Individual/Group) Flag</td><td>0</td><td>개별 (유니캐스트)</td></tr><tr><td></td><td></td><td>1</td><td>그룹 (멀티캐스트/브로드캐스트)</td></tr></tbody></table><p><strong>예제 (첫 바이트)</strong>:</p><ul><li><code>00</code> (0x00) → <code>00000000</code> → I/G=0 (unicast), U/L=0 (global)</li><li><code>01</code> (0x01) → <code>00000001</code> → I/G=1 (multicast)</li><li><code>02</code> (0x02) → <code>00000010</code> → I/G=0, U/L=1 (locally administered) ← <strong>로컬 MAC 표식</strong></li></ul><p><strong>입력 MAC 의 첫 옥텟을 2 진수로 보고, LSB 두 비트</strong>가 위 의미를 가진다.<br><strong>실무 판단법</strong>: MAC 의 첫 바이트 (16 진수) 를 2 진수로 바꿔 마지막 두 비트를 보면 된다.</p><ul><li>예: <code>02:11:22:33:44:55</code> → 첫 바이트 <code>0x02</code> (00000010) → U/L=1 → 로컬 할당 MAC.</li></ul><h6 id=ouima-l-와-블록-크기>OUI(=MA-L) 와 블록 크기<a hidden class=anchor aria-hidden=true href=#ouima-l-와-블록-크기>#</a></h6><ul><li><strong>MA-L(구 OUI)</strong>: 상위 24 비트 (첫 3 옥텟). 한 블록 ≈ 1,600 만 개 주소.</li><li><strong>MA-M/MA-S</strong>: 더 작은 블록 (≈ 100 만, 4096 개) 로 유연 배정.</li><li>IEEE 는 RA 페이지에서 <strong>MA-L/MA-M/MA-S</strong>와 **CID(Company ID)**를 안내한다.</li></ul><h6 id=대표-주소-형태-예시>대표 주소 형태 예시<a hidden class=anchor aria-hidden=true href=#대표-주소-형태-예시>#</a></h6><table><thead><tr><th>유형</th><th>예</th><th>비고</th></tr></thead><tbody><tr><td>전역 유니캐스트 (UAA)</td><td><code>3c:5a:b4:12:34:56</code></td><td>U/L=0, I/G=0</td></tr><tr><td>로컬 유니캐스트 (LAA)</td><td><code>02:11:22:33:44:55</code></td><td><strong>랜덤 MAC</strong>에 흔함</td></tr><tr><td>전역 멀티캐스트</td><td><code>01:00:5e:00:00:fb</code></td><td>IPv4 mDNS(224.0.0.251) 매핑, 23 비트 매핑 규칙 사용</td></tr><tr><td>IPv6 멀티캐스트</td><td><code>33:33:00:00:00:01</code></td><td>ff02::1 → 33:33 매핑</td></tr><tr><td>브로드캐스트</td><td><code>ff:ff:ff:ff:ff:ff</code></td><td>I/G=1(그룹)</td></tr></tbody></table><h6 id=구조도>구조도<a hidden class=anchor aria-hidden=true href=#구조도>#</a></h6><pre class=mermaid>graph TB
  subgraph &#34;MAC 구조 (48-bit)&#34;
    A[Octet1 b7..b0] --&gt; B[Octet2]
    B --&gt; C[Octet3]
    C --&gt; D[Octet4]
    D --&gt; E[Octet5]
    E --&gt; F[Octet6]
  end

  A --&gt; IG[&#34;I/G (bit0)&#34;]
  A --&gt; UL[&#34;U/L (bit1)&#34;]
  A --&gt; OUI[&#34;OUI (상위24bit: Octet1~3)&#34;]
  C --&gt; NIC[&#34;NIC 일련번호 (하위24bit: Octet4~6)&#34;]

  OUI --&gt;|제조사 식별| AssetDB[&#34;자산관리(IPAM)&#34;]
  NIC --&gt;|장치 구분| NICDB[제품 시리얼]
  IG --&gt;|멀티캐스트 판별| MCAST[IGMP/MLD 처리]
  UL --&gt;|로컬표시| LocalPolicy[로컬 MAC 정책]
  subgraph &#34;L2 동작&#34;
    Switch[&#34;Switch (CAM Table)&#34;]
    Switch --&gt;|학습| AssetDB
    Switch --&gt;|포워딩| Port[포트]
  end

  AssetDB --&gt;|정책 연계| NAC[NAC / 802.1X]
  NAC --&gt; Switch
</pre><h5 id=구성-요소>구성 요소<a hidden class=anchor aria-hidden=true href=#구성-요소>#</a></h5><ul><li><strong>NIC</strong>: MAC 을 보유하고 프레임 송수신을 수행하는 장치. 물리 NIC 와 가상 NIC(하이퍼바이저/컨테이너) 의 차이 이해 필요.</li><li><strong>스위치</strong>: 소스 MAC 을 학습해 CAM 테이블을 채우고 목적지 MAC 을 찾아 포워딩. CAM 테이블 한계를 고려한 VLAN/설계 필요.</li><li><strong>CAM / MAC 테이블</strong>: 스위치의 메모리로 포트↔MAC 매핑을 저장. 학습 폭주 시 플러딩·성능 문제 발생.</li><li><strong>관리 시스템 (IPAM/NAC/SIEM)</strong>: MAC·IP 자산관리·정책·감사를 수행해 운영 안정성 보장.</li><li><strong>보안 모듈 (Port Security 등)</strong>: MAC 스푸핑·무단접속 방지용 기능으로 NAC·802.1X 와 함께 운영.</li></ul><h6 id=mac-관련-구성-요소의-역할기능특징-및-운영-분류>MAC 관련 구성 요소의 역할·기능·특징 및 운영 분류<a hidden class=anchor aria-hidden=true href=#mac-관련-구성-요소의-역할기능특징-및-운영-분류>#</a></h6><table><thead><tr><th>구성 요소</th><th>역할</th><th style=text-align:right>기능</th><th>특징</th><th>상호관계</th><th style=text-align:right>필수/선택</th><th>속하는 구조</th></tr></thead><tbody><tr><td>NIC (물리/가상)</td><td>MAC 보유·프레임 I/O</td><td style=text-align:right>BIA 저장 / MAC 오버라이드 가능</td><td>하드웨어/소프트웨어 혼합</td><td>하이퍼바이저·OS·IPAM</td><td style=text-align:right>필수</td><td>구성요소</td></tr><tr><td>L2 스위치</td><td>포워딩·학습</td><td style=text-align:right>CAM 학습/포워딩/필터링</td><td>테이블 크기·aging 존재</td><td>NAC·IPAM·라우터</td><td style=text-align:right>필수</td><td>구성요소</td></tr><tr><td>CAM 테이블</td><td>포트↔MAC 매핑 저장</td><td style=text-align:right>포워딩 키 제공</td><td>메모리 제한·aging</td><td>스위치 내부</td><td style=text-align:right>필수</td><td>구성요소</td></tr><tr><td>IPAM</td><td>자산·정책관리</td><td style=text-align:right>MAC/IP 인벤토리·변경로그</td><td>가상환경 연동 필요</td><td>DHCP/DNS/NAC</td><td style=text-align:right>필수 (대규모)</td><td>관리</td></tr><tr><td>NAC / 802.1X</td><td>인증·정책 강제</td><td style=text-align:right>포트 액세스 제어</td><td>RADIUS 연동</td><td>Switch·IPAM</td><td style=text-align:right>권장</td><td>보안/관리</td></tr><tr><td>Port Security</td><td>MAC 바인딩</td><td style=text-align:right>허용 MAC 제한</td><td>오동작 시 차단 가능</td><td>Switch</td><td style=text-align:right>선택 (권장)</td><td>보안</td></tr><tr><td>DHCP Snooping / DAI</td><td>DHCP/ARP 보호</td><td style=text-align:right>불량 DHCP/ARP 차단</td><td>장비별 지원 상이</td><td>Switch / IPAM</td><td style=text-align:right>권장</td><td>보안</td></tr><tr><td>RA Guard / SeND</td><td>IPv6 NDP 보호</td><td style=text-align:right>RA/NS 필터링·인증</td><td>장비 지원 요구</td><td>Switch / Router</td><td style=text-align:right>선택 (권장)</td><td>보안</td></tr></tbody></table><p>구성 요소는 NIC·스위치·CAM·관리시스템·보안모듈로 구분되며, 대규모·고신뢰 운영에서는 IPAM·NAC 가 필수적 (또는 강력 권장) 하다. 스위치·보안 기능은 장비 지원 여부와 운영 복잡성을 고려해 도입 결정을 내려야 한다.</p><h6 id=구성-요소의-운영성능검증-고려사항>구성 요소의 운영·성능·검증 고려사항<a hidden class=anchor aria-hidden=true href=#구성-요소의-운영성능검증-고려사항>#</a></h6><table><thead><tr><th>구성 요소</th><th>성능 한계</th><th style=text-align:right>운영 리스크</th><th>검증 항목</th></tr></thead><tbody><tr><td>NIC</td><td>처리량·동시 연결</td><td style=text-align:right>MAC 복제·오버라이드</td><td>BIA vs OS MAC 확인</td></tr><tr><td>L2 스위치</td><td>CAM 크기, CPU 사용</td><td style=text-align:right>플러딩, 학습 폭주</td><td><code>show mac address-table</code> 감시</td></tr><tr><td>CAM 테이블</td><td>저장 용량, aging</td><td style=text-align:right>학습 누락/오버플로우</td><td>aging 설정·모니터링</td></tr><tr><td>IPAM</td><td>동기화 지연</td><td style=text-align:right>데이터 불일치</td><td>DHCP/DNS 연동 테스트</td></tr><tr><td>NAC</td><td>인증 병목</td><td style=text-align:right>잘못된 차단 (정상 차단)</td><td>RADIUS 시나리오 테스트</td></tr><tr><td>DHCP Snooping</td><td>룰 복잡성</td><td style=text-align:right>DHCP 차단 오탐</td><td>DHCP 로그 검증</td></tr><tr><td>RA Guard/SeND</td><td>장비 지원</td><td style=text-align:right>IPv6 통신 장애</td><td>RA/NS 정상성 테스트</td></tr></tbody></table><p>운영·성능·검증 항목은 도입 전 반드시 체크해야 한다. 특히 CAM 테이블 크기·aging 과 NAC 의 인증성능, DHCP Snooping 의 오탐 가능성은 사전 테스트가 필수다.</p><h6 id=구성도>구성도<a hidden class=anchor aria-hidden=true href=#구성도>#</a></h6><pre class=mermaid>graph TB
  subgraph &#34;엔드포인트&#34;
    VM1[&#34;VM / Host (NIC)&#34;]
    VM2[&#34;Container (vNIC)&#34;]
  end

  subgraph &#34;L2 Domain&#34;
    SW[&#34;Switch (CAM Table)&#34;]
    PS[Port Security]
    DS[DHCP Snooping / DAI]
    RA[RA Guard / SeND]
  end

  subgraph &#34;관리·보안&#34;
    IPAM[IPAM]
    NAC[NAC / 802.1X / RADIUS]
    SIEM[SIEM / 로그]
    DNS[DNS / DDNS]
    DHCP[DHCP Server]
  end

  VM1 --&gt;|frame src/dst MAC| SW
  VM2 --&gt;|frame src/dst MAC| SW
  SW --&gt;|learn MAC -&gt; port| SW
  SW --&gt;|feed DHCP info| IPAM
  DHCP --&gt;|leases| IPAM
  SW --&gt;|enforce| PS
  SW --&gt;|protection| DS
  SW --&gt;|NDP protection| RA
  IPAM --&gt;|policy| NAC
  NAC --&gt;|auth| SW
  SW --&gt;|logs| SIEM
  DNS --&gt;|dynamic update| IPAM
</pre><h4 id=프로토콜-스택-및-메시지-형식>프로토콜 스택 및 메시지 형식<a hidden class=anchor aria-hidden=true href=#프로토콜-스택-및-메시지-형식>#</a></h4><p>이더넷 프레임은 L2(데이터 링크) 에서 MAC 주소로 송수신 대상을 식별하는 기본 단위다.<br>프레임은 목적지·출발지 MAC, EtherType, 페이로드, FCS 로 구성되며 (옵션: VLAN 태그), EtherType 에 따라 페이로드를 IPv4/IPv6/ARP 등으로 해석한다.<br>VLAN, VXLAN 같은 캡슐화로 L2 경계가 달라질 수 있고, 프레임 최소/최대 크기, 패딩, FCS 등 물리·링크 규칙을 지켜야 정상 통신이 이루어진다.</p><h5 id=대표적인-프로토콜-스택-유형과-실무-역할>대표적인 프로토콜 스택 유형과 실무 역할<a hidden class=anchor aria-hidden=true href=#대표적인-프로토콜-스택-유형과-실무-역할>#</a></h5><ol><li><p><strong>기본 이더넷 스택 (Ethernet II + IPv4/IPv6 + TCP/UDP)</strong></p><ul><li>정의: 가장 일반적인 LAN 스택.</li><li>역할: L2 로 전달 → L3 에서 라우팅 → L4 로 포트 다중화</li><li>사용 예: 사무실 LAN, 데이터센터 내부 통신</li></ul></li><li><p><strong>무선 스택 (802.11 MAC + 802.11 PHY + IP)</strong></p><ul><li>정의: Wi-Fi 는 프레임 포맷·관리/제어 프레임 (Beacon, Probe, Authentication) 존재</li><li>특징: BSSID/SSID, 프레임 암호화 (WPA2/3) 포함</li></ul></li><li><p><strong>VLAN/Trunk 스택 (802.1Q)</strong></p><ul><li>정의: 동일 물리망에서 논리적 분리 (태깅) 제공</li><li>역할: L2 분리·다중 테넌시, 트렁크에서 태그 유지</li></ul></li><li><p><strong>오버레이 스택 (VXLAN / GRE / NVGRE)</strong></p><ul><li>정의: L2 프레임을 UDP(GRE) 로 캡슐화 → IP 네트워크 상에서 L2 확장</li><li>역할: 멀티테넌트 가상 네트워크, 데이터센터 오버레이</li></ul></li><li><p><strong>브리지/스패닝/제어 스택 (STP, LLDP, 802.1X)</strong></p><ul><li>정의: L2 관리용 프로토콜 집합 (루프 방지, 이웃 탐지, 인증)</li><li>역할: 네트워크 안정화·보안·관리</li></ul></li></ol><h6 id=대표적인-프로토콜-스택-유형과-실무-역할-1>대표적인 프로토콜 스택 유형과 실무 역할<a hidden class=anchor aria-hidden=true href=#대표적인-프로토콜-스택-유형과-실무-역할-1>#</a></h6><table><thead><tr><th style=text-align:right>스택 유형</th><th>구성 요소 (예)</th><th>주요 기능</th><th>실무 역할/비고</th></tr></thead><tbody><tr><td style=text-align:right>기본 이더넷 스택</td><td>Ethernet II, IPv4/IPv6, TCP/UDP</td><td>L2 전달→L3 라우팅→L4 멀티플렉싱</td><td>기본 LAN/데이터센터 통신</td></tr><tr><td style=text-align:right>무선 (802.11) 스택</td><td>802.11 MAC/PHY, WPA2/3, DHCP</td><td>무선 연결·암호화·관리프레임</td><td>모바일·IoT 환경 특수성 (프레임 크기·재전송)</td></tr><tr><td style=text-align:right>VLAN/802.1Q</td><td>802.1Q 태깅 (TPID 0x8100)</td><td>L2 세그멘테이션·트렁킹</td><td>테넌트 분리, QoS 연계</td></tr><tr><td style=text-align:right>오버레이 (VXLAN)</td><td>VXLAN(UDP 4789) + VTEP</td><td>L2 오버 L3, 멀티테넌시</td><td>클라우드/가상화 네트워킹 필수</td></tr><tr><td style=text-align:right>L2 관리/보안</td><td>STP, LLDP, 802.1X, DAI</td><td>루프 방지·인증·인벤토리·ARP 보호</td><td>안정성·보안 필수 구성</td></tr></tbody></table><h5 id=이더넷-기반-주요-메시지-형식과-용도>이더넷 기반 주요 메시지 형식과 용도<a hidden class=anchor aria-hidden=true href=#이더넷-기반-주요-메시지-형식과-용도>#</a></h5><ul><li><strong>정의</strong>: 메시지 형식은 각 계층·프로토콜이 전송하는 패킷/프레임의 필드 배치와 값·크기를 규정한 것.</li><li><strong>L2(이더넷) 관점</strong>: 이더넷 프레임이 최하위 전달 단위이며, 그 내부를 해석해 ARP/IPv4/IPv6/DHCP/802.1X 등이 동작.</li></ul><h6 id=메시지-형식-분류>메시지 형식 분류<a hidden class=anchor aria-hidden=true href=#메시지-형식-분류>#</a></h6><ol><li><p><strong>이더넷 II 프레임</strong></p><ul><li>필드·크기: DstMAC(6) | SrcMAC(6) | EtherType(2) | Payload(46–1500) | FCS(4)</li><li>역할: 상위 프로토콜 구별 (EtherType) 및 페이로드 전달</li><li>특징: VLAN 태그 삽입 가능 (802.1Q)</li></ul></li><li><p><strong>802.3 + LLC/SNAP</strong></p><ul><li>구조: Dst|Src|Length|LLC(SAP)|Payload|FCS</li><li>사용처: IEEE LLC 필요 시 (호환성)</li></ul></li><li><p><strong>802.1Q VLAN 태그</strong></p><ul><li>구조 (태그 4 바이트): TPID(0x8100) | TCI(PCP(3)|DEI(1)|VID(12))</li><li>역할: VLAN 식별·우선순위 (PCP) 전달</li></ul></li><li><p><strong>ARP (EtherType 0x0806)</strong></p><ul><li>필드: HTYPE(2)|PTYPE(2)|HLEN(1)|PLEN(1)|OPER(2)|SHA(6)|SPA(4)|THA(6)|TPA(4)</li><li>역할: IP → MAC 매핑 (브로드캐스트 Request, Unicast Reply)</li></ul></li><li><p><strong>IPv4 / IPv6</strong> (이더넷 페이로드)</p><ul><li>IPv4: 버전/IHL/TOS/TotalLen/ID/Flags/Frag/TTL/Proto/Checksum/Src/Dst/…</li><li>IPv6: 버전/FlowLabel/Plen/NextHeader/HopLimit/Src/Dst/…</li></ul></li><li><p><strong>DHCP (UDP 67/68)</strong></p><ul><li>필드: op, htype, hlen, hops, xid, secs, flags, ciaddr, yiaddr, siaddr, giaddr, chaddr, options</li><li>역할: 동적 IP 할당 및 옵션 전달</li></ul></li><li><p><strong>LLC/802.11 관리·제어 프레임</strong></p><ul><li>Wi-Fi 특유 프레임 (Management/Control/Data) 구조 존재</li></ul></li><li><p><strong>오버레이 캡슐화</strong></p><ul><li>VXLAN: Outer Ethernet | Outer IP | UDP(4789) | VXLAN header | Inner Ethernet | Inner Payload</li></ul></li></ol><h6 id=이더넷-기반-주요-메시지-형식과-용도-1>이더넷 기반 주요 메시지 형식과 용도<a hidden class=anchor aria-hidden=true href=#이더넷-기반-주요-메시지-형식과-용도-1>#</a></h6><table><thead><tr><th style=text-align:right>메시지 형식</th><th style=text-align:right>EtherType/포트</th><th>주요 필드 (요약)</th><th>용도/특징</th></tr></thead><tbody><tr><td style=text-align:right>Ethernet II frame</td><td style=text-align:right>—</td><td>DstMAC, SrcMAC, EtherType, Payload, FCS</td><td>L2 기본 전달 단위</td></tr><tr><td style=text-align:right>802.1Q VLAN tag</td><td style=text-align:right>TPID=0x8100</td><td>TCI(PCP/DEI/VID)</td><td>트래픽 분리/우선순위</td></tr><tr><td style=text-align:right>ARP</td><td style=text-align:right>EtherType 0x0806</td><td>HTYPE/PTYPE/OPER/SHA/SPA/THA/TPA</td><td>IP→MAC 매핑</td></tr><tr><td style=text-align:right>IPv4</td><td style=text-align:right>EtherType 0x0800</td><td>Version/IHL/TTL/Proto/Src/Dst</td><td>L3 라우팅 패킷</td></tr><tr><td style=text-align:right>IPv6</td><td style=text-align:right>EtherType 0x86DD</td><td>Version/FlowLabel/NextHeader/Src/Dst</td><td>L3(IPv6)</td></tr><tr><td style=text-align:right>DHCP</td><td style=text-align:right>UDP 67/68</td><td>op,xid,chaddr,options</td><td>동적 주소 할당</td></tr><tr><td style=text-align:right>VXLAN</td><td style=text-align:right>UDP 4789</td><td>VNI + inner Ethernet</td><td>L2 오버레이 (클라우드)</td></tr></tbody></table><p>`</p><h6 id=메시지-형식-예시-실무형-포맷-예시>메시지 형식 예시 (실무형 포맷 예시)<a hidden class=anchor aria-hidden=true href=#메시지-형식-예시-실무형-포맷-예시>#</a></h6><ol><li><p>간단한 Ethernet II + IPv4 헤더 (헥스/필드 예시)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2>2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3>3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4>4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>DstMAC: 01:23:45:67:89:ab
</span></span><span class=line><span class=cl>SrcMAC: 11:22:33:44:55:66
</span></span><span class=line><span class=cl>EtherType: 0x0800 (IPv4)
</span></span><span class=line><span class=cl>IPv4 Header (start): 45 00 00 3c 1c 46 40 00 40 06 … 
</span></span><span class=line><span class=cl>(45=ver(4)/IHL(5), 00=TOS, 00 3c=total len, …)
</span></span></code></pre></td></tr></table></div></div><ul><li>실제 캡처에서 위처럼 MAC 12 바이트 + EtherType 2 바이트 + IPv4 헤더 시작 (0x45) 순으로 보인다.</li></ul></li><li><p>VLAN 태그 포함 프레임</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2>2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3>3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4>4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>DstMAC: aa:bb:cc:dd:ee:ff
</span></span><span class=line><span class=cl>SrcMAC: 11:22:33:44:55:66
</span></span><span class=line><span class=cl>TPID: 0x8100
</span></span><span class=line><span class=cl>TCI: 0x0a01  -&gt; PCP=0 (우선순위), DEI=0, VID=0x0a1 (257)
</span></span><span class=line><span class=cl>EtherType: 0x0800 (IPv4)
</span></span></code></pre></td></tr></table></div></div></li><li><p>ARP Request 필드 예시 (의미 중심)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6>6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7>7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8>8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>HTYPE: 1  (Ethernet)
</span></span><span class=line><span class=cl>PTYPE: 0x0800 (IPv4)
</span></span><span class=line><span class=cl>HLEN: 6
</span></span><span class=line><span class=cl>PLEN: 4
</span></span><span class=line><span class=cl>OPER: 1 (Request)
</span></span><span class=line><span class=cl>SHA: src MAC
</span></span><span class=line><span class=cl>SPA: src IP
</span></span><span class=line><span class=cl>THA: 00:00:00:00:00:00
</span></span><span class=line><span class=cl>TPA: target IP
</span></span></code></pre></td></tr></table></div></div></li><li><p>IPv6 멀티캐스트 → MAC 매핑</p><ul><li>IPv6 multicast 주소 <code>ff02::1:ffXX:XXXX</code> 의 하위 32 비트를 취해 MAC <code>33:33:XX:XX:XX:XX</code> 로 매핑</li></ul></li></ol><h3 id=특성-분석-및-평가>특성 분석 및 평가<a hidden class=anchor aria-hidden=true href=#특성-분석-및-평가>#</a></h3><h4 id=mac-주소의-장점-근거-및-운영적-고려사항>MAC 주소의 장점, 근거 및 운영적 고려사항<a hidden class=anchor aria-hidden=true href=#mac-주소의-장점-근거-및-운영적-고려사항>#</a></h4><p>네트워크에서 데이터를 같은 물리적 세그먼트 안의 장치로 보낼 때, 라우터와 IP 대신 이더넷 프레임의 MAC 주소를 보고 바로 전달한다.<br>제조사가 할당한 OUI 와 장치 고유번호로 구성되어 있어 장비를 식별하고, 스위치는 받은 프레임의 출발지 MAC 을 학습해 포트 -MAC 테이블을 유지함으로써 다음번 전달을 빠르게 수행한다. 이 때문에 장비 인벤토리, 접근제어, 트러블슈팅에서 MAC 은 매우 유용하지만, 쉽게 위조될 수 있으므로 중요한 인증엔 다른 메커니즘 (802.1X 등) 을 함께 써야 한다.</p><table><thead><tr><th>장점</th><th>근거 (기술적 근거)</th><th>실무 효과 (무엇이 개선되는가)</th></tr></thead><tbody><tr><td>고유성 (식별)</td><td>IEEE OUI + EUI 규격 (전역 고유성)</td><td>자산관리·인벤토리 정확성, 자동 등록</td></tr><tr><td>관리 용이성</td><td>프레임 내 포함 + 스위치 자동 학습</td><td>장비 교체·확장 시 수작업 감소</td></tr><tr><td>로컬 통신 효율성</td><td>MAC 테이블 기반 포워딩 (브리지)</td><td>낮은 지연, 내부 트래픽 처리량 향상</td></tr><tr><td>범용성·호환성</td><td>IEEE 802 표준 채택으로 전장비 지원</td><td>멀티벤더 통합 쉬움, 장비 교체 용이</td></tr><tr><td>보안/접근제어 활용</td><td>L2 ACL, 포트 보안, NAC 연계 가능</td><td>미승인 장비 차단, 기본적 접근 통제</td></tr><tr><td>트러블슈팅·가시성</td><td>ARP·MAC 테이블·패킷 캡처 연동</td><td>장애 원인 추적·포렌식·문제 복구 가속</td></tr><tr><td>멀티캐스트 지원</td><td>이더넷 멀티캐스트 매핑 규칙</td><td>그룹 통신 효율화, 대역폭 절감</td></tr></tbody></table><p>MAC 주소는 물리적/데이터링크 계층에서 장치를 고유하게 식별하고 스위치 기반의 빠른 포워딩을 가능하게 함으로써 자산관리, 접근제어, 내부 통신 성능, 트러블슈팅 등 실무 운영의 여러 영역에서 즉각적이고 가시적인 이점을 제공한다. 다만 보안적 신뢰성 (스푸핑) 과 동적 환경 (가상화·MAC 랜덤화) 에서는 한계를 가지므로, 중요한 인증·권한 결정에는 802.1X 같은 보완 메커니즘을 결합하는 것이 실무 권장 사항이다.</p><h4 id=mac-주소-단점과-제약사항-분석위험-실무영향-완화전략-및-대안-기술>MAC 주소: 단점과 제약사항 분석—위험, 실무영향, 완화전략 및 대안 기술<a hidden class=anchor aria-hidden=true href=#mac-주소-단점과-제약사항-분석위험-실무영향-완화전략-및-대안-기술>#</a></h4><p>MAC 주소는 이더넷 카드에 배정된 <strong>로컬 (같은 LAN 한정)</strong> 식별자이다.<br>고유성이 프라이버시·보안 문제로 이어질 수 있고, 소프트웨어로 쉽게 바꿀 수 있어 신뢰 기반 보안에는 취약하다.<br>가상화와 모바일 랜덤화로 운영상의 혼란이 늘어나므로 네트워크 운영자는 802.1X, DHCP snooping, IPAM 같은 보완 수단과 정책을 함께 설계해야 한다.</p><table><thead><tr><th style=text-align:right>분류</th><th>항목</th><th>설명</th><th>원인</th><th>실무 문제 (예시)</th><th>완화/해결 방안</th><th>대안 기술</th></tr></thead><tbody><tr><td style=text-align:right>단점</td><td>개인정보 추적 위험</td><td>고유 MAC 으로 추적 가능</td><td>고정성 (제조사 할당)</td><td>위치 추적, 규제 이슈</td><td>MAC 랜덤화, SSID 프로파일</td><td>IPv6 Privacy Ext.</td></tr><tr><td style=text-align:right>단점</td><td>MAC 스푸핑</td><td>MAC 변경으로 인증 우회 가능</td><td>L2 신뢰 부재</td><td>NAC 우회, 불법 접근</td><td>802.1X, DHCP snooping, DAI</td><td>DevID(802.1AR), cert-based</td></tr><tr><td style=text-align:right>단점</td><td>가상화 충돌</td><td>VM/컨테이너의 동적/복제 MAC</td><td>소프트웨어 NIC 생성</td><td>DHCP 예약 실패, 마이그레이션 장애</td><td>하이퍼바이저 MAC 풀 관리</td><td>SDN, ENI 고정 정책</td></tr><tr><td style=text-align:right>단점</td><td>CAM 테이블·확장성 한계</td><td>L2 테이블 오버플로우</td><td>대규모 L2·IoT</td><td>패킷 드롭·플래핑</td><td>L2 세그멘테이션, 오버레이</td><td>EVPN/VXLAN, L3 전환</td></tr><tr><td style=text-align:right>제약</td><td>로컬 범위 한정</td><td>MAC 은 L2 에서만 유효</td><td>OSI 레이어 설계</td><td>WAN 장치 식별 불가</td><td>IP-MAC 연계 로그/모니터링</td><td>IP 주소 (L3)</td></tr><tr><td style=text-align:right>제약</td><td>동적 랜덤화 충돌</td><td>프라이버시 목적 MAC 변경</td><td>OS 정책 (랜덤화)</td><td>NAC/DHCP 정책 실패</td><td>SSID 별 정책, 등록 절차</td><td>802.1X, MDM</td></tr><tr><td style=text-align:right>제약</td><td>제조사/표준 의존</td><td>OUI·벤더별 차이</td><td>중앙 할당 모델</td><td>호환성·관리 차이</td><td>표준 준수 테스트</td><td>소프트웨어 식별자</td></tr></tbody></table><ul><li><strong>핵심 포인트</strong>: MAC 은 빠르고 간단한 L2 식별자지만 <strong>프라이버시·보안·운영 스케일</strong>에서 약점이 있다.</li><li><strong>운영 권고</strong>: MAC 만으로 신뢰하지 말고 <strong>인증 (802.1X)</strong>, <strong>DHCP snooping/DAI</strong>, <strong>IPAM 연계 로그 상관</strong>, <strong>L2 세그멘테이션</strong>을 병행하는 것이 좋다.</li><li><strong>전략적 대안</strong>: 인증서/DevID 나 IP/애플리케이션 레벨 식별을 도입해 MAC 한계를 보완해야 한다.</li></ul><h4 id=mac-주소-트레이드오프-분석-및-실무적-완화-패턴>MAC 주소 트레이드오프 분석 및 실무적 완화 패턴<a hidden class=anchor aria-hidden=true href=#mac-주소-트레이드오프-분석-및-실무적-완화-패턴>#</a></h4><p>MAC 주소는 L2 에서 장치를 식별하는 고유값으로, 고정형이면 관리·감시·정책 적용이 쉬우며 보안에 유리하다. 반면 프라이버시를 위해 MAC 을 랜덤화하면 개인 추적이 어려워지지만 네트워크 인증·로깅·접근 제어가 복잡해진다. 작은 네트워크에서는 단순 MAC 정책으로 충분하지만, 대규모·무선·가상화 환경에서는 CAM 테이블 용량, 플러딩, 스푸핑 공격 등 문제를 고려해 <strong>포트 시큐리티·DHCP Snooping·DAI·802.1X·SDN·NAC</strong> 같은 보조 수단을 결합하는 하이브리드 설계가 필요하다.</p><h5 id=mac-트레이드오프-비교표>MAC 트레이드오프 비교표<a hidden class=anchor aria-hidden=true href=#mac-트레이드오프-비교표>#</a></h5><table><thead><tr><th>트레이드오프 (A vs B)</th><th style=text-align:right>A 선택 시 장점</th><th>A 선택 시 단점</th><th style=text-align:right>B 선택 시 장점</th><th>B 선택 시 단점</th><th>고려 기준</th></tr></thead><tbody><tr><td><strong>고유성 (고정 MAC)</strong> vs <strong>프라이버시 (랜덤화)</strong></td><td style=text-align:right>정책·인증·정밀 로깅 가능</td><td>프라이버시 취약, 관리 부담</td><td style=text-align:right>사용자 프라이버시 보호</td><td>인증·로그·NAC 문제 발생</td><td>규정 (로그 필요성), 서비스 유형 (내부 자산 vs 게스트)</td></tr><tr><td><strong>관리 단순성 (L2 단순)</strong> vs <strong>확장성 (L3/IP 기반)</strong></td><td style=text-align:right>설정·디버깅 쉬움</td><td>대규모에서 비효율·플러딩</td><td style=text-align:right>라우팅 집계·스케일 우수</td><td>초기 설계 복잡</td><td>네트워크 규모, 미래 성장</td></tr><tr><td><strong>하드웨어 기반 (고정 NIC)</strong> vs <strong>소프트웨어 기반 (vNIC)</strong></td><td style=text-align:right>안정·예측성 높음</td><td>물리적 변경 시 유연성 낮음</td><td style=text-align:right>이동성·자동화·컨테이너 지원</td><td>정책 추적 어려움</td><td>가상화 비중, 이동성 요구</td></tr><tr><td><strong>보안 적용 (MAC 필터링)</strong> vs <strong>호환성 (유연 허용)</strong></td><td style=text-align:right>불법 접속 차단 가능</td><td>스푸핑·유지보수 문제</td><td style=text-align:right>사용자·장치 변화 수용 용이</td><td>보안 약화</td><td>보안 요구도, 운영 인력</td></tr><tr><td><strong>로컬 효율 (L2)</strong> vs <strong>글로벌 확장 (L3)</strong></td><td style=text-align:right>저지연·단순 전달</td><td>브로드캐스트 범위 문제</td><td style=text-align:right>라우팅·집계 효율</td><td>라우터·관리 복잡</td><td>토폴로지·지연 요구</td></tr></tbody></table><p>설계 선택은 <em>목표 (보안/프라이버시/확장성/운영 단순성)</em> 중 어떤 것을 우선시하느냐로 결정된다. 실무에서는 한 쪽만 택하기보다 <strong>식별이 필요한 자원은 고정·강화</strong>, <strong>게스트/비중요자원은 프라이버시 허용</strong> 같은 혼합 전략이 현실적이다.</p><h5 id=mac-트레이드오프-완화용-하이브리드-패턴>MAC 트레이드오프 완화용 하이브리드 패턴<a hidden class=anchor aria-hidden=true href=#mac-트레이드오프-완화용-하이브리드-패턴>#</a></h5><table><thead><tr><th>패턴명</th><th>구성 요소</th><th>적용 목적</th><th>장점</th><th>고려사항</th></tr></thead><tbody><tr><td>인증 - 분리 (Managed vs Guest)</td><td>802.1X(내부)/Open SSID(게스트)</td><td>관리자 자산은 식별·로깅, 게스트는 프라이버시</td><td>내부 보안 유지 + 사용자 프라이버시</td><td>인증 실패 대비 MAC-fallback 정책 필요</td></tr><tr><td>포트 + 논리 방어</td><td>Port-security + DHCP Snooping + DAI</td><td>스푸핑·ARP 공격 방지</td><td>강력한 계층적 방어</td><td>가상·컨테이너 환경 예외 처리 필요</td></tr><tr><td>SDN + NAC 프로파일링</td><td>SDN 컨트롤러 + NAC + ML 프로파일링</td><td>실시간 중앙제어·동적 격리</td><td>정책 유연성·자동 대응</td><td>도입 복잡, 운영 비용</td></tr><tr><td>로그 기반 적응</td><td>중앙 로깅 + 탐지 룰</td><td>랜덤화/이상 MAC 변화 탐지</td><td>운영자 판단으로 예외 처리</td><td>오탐·프라이버시 법규 준수 필요</td></tr><tr><td>IP-MAC 바인딩 with exception</td><td>DHCP binding + static bindings for infra</td><td>인프라 안정성 확보</td><td>IP-MAC 신뢰성 ↑</td><td>모바일·이동 디바이스 지원 정책 필요</td></tr></tbody></table><p>하이브리드 패턴은 <strong>여러 계층 (물리/링크/네트워크/관리) 을 결합</strong>해 단일한 약점을 보완한다. 각 패턴은 적용 목적에 맞게 구성요소를 골라 쓰되, <strong>가상화·무선·게스트</strong> 시나리오에 대한 예외 규칙을 반드시 마련해야 한다.</p><h4 id=mac-address-적용-적합성-가이드-l2-식별의-한계와-현대-대안>MAC Address 적용 적합성 가이드: L2 식별의 한계와 현대 대안<a hidden class=anchor aria-hidden=true href=#mac-address-적용-적합성-가이드-l2-식별의-한계와-현대-대안>#</a></h4><ul><li><strong>MAC 은 " 같은 스위치/같은 VLAN 안에서 누구에게 프레임을 줄지 " 결정하는 L2 주소</strong>다. 이 범위를 넘으면 의미가 약하다.</li><li><strong>보안은 MAC 단독이 아니라 802.1X 같은 상위 인증과 함께</strong> 설계한다.</li><li>**클라우드에선 MAC 중심 설계가 아니라 L3/L4 정책 (보안 그룹/NSG)**이 기본이다.</li><li><strong>무선·BYOD 는 랜덤 MAC 이 기본</strong>이라 MAC 고정 식별은 잘 맞지 않는다.</li></ul><h5 id=mac-address-적용-적합성-설계분석운영-3-관점-매트릭스>MAC Address 적용 적합성: 설계·분석·운영 3 관점 매트릭스<a hidden class=anchor aria-hidden=true href=#mac-address-적용-적합성-설계분석운영-3-관점-매트릭스>#</a></h5><table><thead><tr><th>범주</th><th>시나리오/환경</th><th style=text-align:right>적합성</th><th>이유 (핵심 포인트)</th><th>권장 설계/대안</th></tr></thead><tbody><tr><td>LAN 캠퍼스/액세스</td><td>유선 사무실망, 스위치 기반</td><td style=text-align:right>높음</td><td>L2 도메인·MAC 학습/에이징으로 효율 포워딩</td><td>802.1X+ 포트시큐리티, 에이징 튜닝</td></tr><tr><td>WLAN/BYOD</td><td>사내 Wi-Fi, 게스트</td><td style=text-align:right>중간</td><td>랜덤 MAC 로 지속식별 약함</td><td>802.1X/EAP-TLS, 사용자·기기 아이덴티티 우선</td></tr><tr><td>IoT/OT</td><td>고정 단말·현장 장비</td><td style=text-align:right>높음</td><td>단순 L2 식별로 관리 용이</td><td>제조사/OUI 기반 인벤토리 + 네트워크 세그멘트</td></tr><tr><td>데이터센터 액세스망</td><td>Leaf-Spine L2 엣지</td><td style=text-align:right>높음</td><td>포트 기반 보안·포워딩 명확</td><td>L2 는 최소화, L3 경계 엄격 · 자동화</td></tr><tr><td>퍼블릭 클라우드</td><td>AWS/Azure VPC/VNet</td><td style=text-align:right>낮음</td><td>L3 오버레이, 브로드캐스트/일반 멀티캐스트 미지원</td><td>SG/NSG·IAM·라우팅 정책 사용</td></tr><tr><td>글로벌 식별</td><td>인터넷 전역 단말 구분</td><td style=text-align:right>부적합</td><td>MAC 은 L2 한정, 라우팅 경계 넘지 못함</td><td>PKI·디바이스 ID·앱 계정 체계</td></tr><tr><td>고보안 환경</td><td>스푸핑 우려 높은 구간</td><td style=text-align:right>낮음</td><td>MAC 필터는 우회 가능</td><td>802.1X·세그멘트·암호화 필수</td></tr></tbody></table><p>&ldquo;L2 도메인 내부 " 에선 MAC 이 강력한 식별자이지만, <strong>클라우드·프라이버시·스푸핑</strong> 조건에서는 <strong>아이덴티티 중심</strong>과 L3/L4 정책이 정석이다.</p><h5 id=클라우드-네트워킹-모델>클라우드 네트워킹 모델<a hidden class=anchor aria-hidden=true href=#클라우드-네트워킹-모델>#</a></h5><ul><li><p><strong>클라우드 VPC/VNet 은 L3 오버레이</strong>로 동작한다. 전통적 L2 브로드캐스트/멀티캐스트는 기본 미지원이며 (플랫폼 백본이 ARP/ND 등을 대행), 일부 한정된 서비스로만 지원된다.<br>예: GCP VPC 는 브로드캐스트/멀티캐스트 미지원, AWS 는 <strong>Transit Gateway 멀티캐스트</strong>로 제한적 지원.</p></li><li><p><strong>보안 필터의 기본 성질</strong></p><ul><li>AWS: <strong>Security Group = 상태추적 (Stateful)</strong>, <strong>NACL = 비상태 (Stateless)</strong>.</li><li>Azure: <strong>NSG</strong>는 서브넷/NIC 에 적용되는 ACL 세트.</li><li>GCP: <strong>분산형 상태추적 방화벽</strong>(VPC 레벨) 로 허용/우선순위 규칙을 적용.</li></ul></li><li><p><strong>라우팅 제어</strong></p><ul><li>AWS: <strong>Transit Gateway(TGW)</strong> 라우트 테이블의 연결/전파로 세그먼테이션·경로제어.</li><li>Azure: **UDR(사용자 정의 라우트)**로 기본 경로를 재정의하고 허브로 집결.</li><li>GCP: <strong>정책 기반 라우트 → 서브넷 라우트 → 커스텀 라우트</strong> 순서로 평가.</li></ul></li></ul><h6 id=설계-패턴-모음>설계 패턴 모음<a hidden class=anchor aria-hidden=true href=#설계-패턴-모음>#</a></h6><ol><li><p>단일 VPC/VNet, 계층형 서브넷 + 인스턴스 방화벽</p><ul><li><strong>언제</strong>: 초기 단계, 소규모 워크로드, 빠른 배포.</li><li><strong>구성</strong>: Public/Private 서브넷 분리 → 인스턴스 레벨 (SG/NSG/GCP FW) 최소허용 (allow-list) → NACL/UDR 로 보조 제어.</li><li><strong>핵심 근거</strong>: AWS SG(Stateful)·NACL(Stateless) 역할분담, Azure NSG 의 서브넷/NIC 결합, GCP 분산 FW.</li><li><strong>주의</strong>: SG/NSG 는 <strong>허용만 정의</strong>(묵시적 거부), NACL/UDR/커스텀라우트와 충돌 없도록 룰/경로를 상위→하위로 정렬.</li></ul></li><li><p>허브 - 스포크 (중앙 허브로 세그먼트 통합)</p><ul><li><strong>언제</strong>: 다계정/다프로젝트, 규제 준수, 중앙 관제·검사 필요.</li><li><strong>구성</strong>:<ul><li>AWS: TGW + RT(Association/Propagation) 로 스포크 VPC 와 온프렘/Direct Connect 를 허브에 연계.</li><li>Azure: <strong>VNet Peering 은 비전이 (Non-transitive)</strong> → Hub 에 NVA/Azure Firewall/VPN GW 를 두고 스포크를 수평 연결.</li><li>GCP: **Shared VPC(호스트 프로젝트)**로 네트워크를 중앙화, 서비스 프로젝트는 내부 IP 로 통신.</li></ul></li><li><strong>장점</strong>: 라우팅/보안 정책 중앙집중, 팀/계정 분리와 네트워크 공통화 동시 달성.</li></ul></li><li><p>중앙 집중형 인터넷 이그레스 (Outbound) + 트래픽 검사</p><ul><li><strong>언제</strong>: 외부 통신 통제·로깅·규정 준수 필요, NAT 비용 최적화.</li><li><strong>구성</strong>:<ul><li>AWS: <strong>Egress VPC</strong>에 NAT GW 집약 + TGW/Cloud WAN 으로 스포크 트래픽 집결, 필요 시 <strong>AWS Network Firewall</strong> 또는 <strong>GWLB</strong>로 L3–7 검사.</li><li>Azure: <strong>NAT Gateway</strong>를 허브 서브넷에 연결해 대량 Outbound 처리.</li><li>GCP: <strong>Cloud NAT</strong>로 무공인 IP VM 의 고가용 Outbound, 정책 기반 라우팅/프록시와 결합.</li></ul></li><li><strong>보너스</strong>: IPv6 환경은 AWS 에서 <strong>중앙 egress 패턴 (egress-only IGW/프록시)</strong> 참조.</li></ul></li><li><p>프라이빗 서비스 액세스 (클라우드 네이티브/SaaS 사설 연결)</p><ul><li><strong>문제</strong>: 퍼블릭 인터넷을 거치지 않고 관리형 서비스·타계정 SaaS 에 사설로 접속.</li><li><strong>해법</strong>:<ul><li>AWS <strong>PrivateLink</strong>(Interface Endpoint) 로 VPC 내부 사설 ENI 에 서비스 노출.</li><li>Azure <strong>Private Link/Private Endpoint</strong>로 PaaS·파트너 서비스에 사설 IP 로 접속.</li><li>GCP **Private Service Connect(PSC)**로 서비스 소비자↔제공자 VPC 간 사설 연결.</li></ul></li><li><strong>활용</strong>: 데이터 유출 경로 축소, 방화벽/라우팅 단순화, 제로트러스트와 상호보완.</li></ul></li><li><p>멀티캐스트/브로드캐스트 요구 대응</p><ul><li><strong>현실</strong>: 기본 VPC/VNet 은 L2 브로드캐스트·멀티캐스트 미지원, 설계 시 유니캐스트/애플리케이션 레벨 재전송 권장. GCP 는 공식적으로 미지원 명시.</li><li><strong>예외</strong>: AWS <strong>Transit Gateway Multicast</strong>로 특정 유스케이스를 지원 (도메인 지정, 가입/탈퇴 관리).</li></ul></li></ol><h6 id=라우팅-정책-설계-체크리스트>라우팅 정책 설계 체크리스트<a hidden class=anchor aria-hidden=true href=#라우팅-정책-설계-체크리스트>#</a></h6><ol><li><p><strong>경로 우선순위/평가 순서</strong>를 이해하자</p><ul><li>GCP: 정책기반 라우트 → 서브넷 라우트 → 커스텀 라우트.</li><li>Azure: 시스템 경로 + <strong>UDR 로 재정의</strong>, 서브넷 단위 적용.</li><li>AWS: <strong>TGW RT</strong>에 연결/전파를 분리하여 테넌트별 경로 격리.</li></ul></li><li><p><strong>검사 지점</strong>을 명시하자</p><ul><li>중앙 이그레스 경유 시 모든 스포크의 0.0.0.0/0(및::/0) 을 허브로 유도하고, 검사 후 인터넷으로. AWS 레퍼런스 아키텍처/화이트페이퍼 참고.</li></ul></li><li><p><strong>서비스 접근은 프라이빗 엔드포인트 우선</strong></p><ul><li>PrivateLink/Private Link/PSC 로 DNS·라우팅을 사설 경로에 고정.</li></ul></li></ol><h3 id=구현-방법-및-분류>구현 방법 및 분류<a hidden class=anchor aria-hidden=true href=#구현-방법-및-분류>#</a></h3><h4 id=mac-주소-구현-기법-및-운영-가이드>MAC 주소 구현 기법 및 운영 가이드<a hidden class=anchor aria-hidden=true href=#mac-주소-구현-기법-및-운영-가이드>#</a></h4><ul><li><strong>하드웨어 (BIA)</strong>: 제조사가 NIC 에 영구적으로 새긴 MAC—전역 식별자로 신뢰도가 높음.</li><li><strong>소프트웨어</strong>: OS/관리자가 MAC 을 바꿀 수 있어 유연하지만 추적성·충돌 측면 주의.</li><li><strong>가상화</strong>: 중앙 할당 (풀)·정책 적용—대규모 환경 필수적.</li><li><strong>랜덤화</strong>: 개인정보 보호용으로 쓰이지만 NAC·자산관리엔 장애 요인.</li></ul><p>운영에서는 <strong>IPAM + NAC + DHCP/DNS 연동</strong>으로 MAC 변경/랜덤화/마이그레이션을 추적·검증해야 한다.</p><h5 id=mac-구현-기법-비교표>MAC 구현 기법 비교표<a hidden class=anchor aria-hidden=true href=#mac-구현-기법-비교표>#</a></h5><table><thead><tr><th>구현 기법</th><th>정의</th><th style=text-align:right>변경 가능성</th><th>장점</th><th>단점</th><th>권장 사용</th></tr></thead><tbody><tr><td>BIA (하드웨어)</td><td>NIC 에 ROM/EEPROM/OTP 로 영구 기록</td><td style=text-align:right>불가 또는 매우 어려움</td><td>영구성·신뢰성·전역 고유성</td><td>제조시 오류 시 교체 필요</td><td>물리 NIC / IoT</td></tr><tr><td>소프트웨어 변경</td><td>OS/관리자가 런타임 변경</td><td style=text-align:right>즉시 가능</td><td>유연성·테스트 용이</td><td>추적성 저하·스푸핑 위험</td><td>실무 테스트·특수 정책</td></tr><tr><td>가상화 할당</td><td>하이퍼바이저/CNI 가 중앙관리</td><td style=text-align:right>중앙정책으로 변경 가능</td><td>대규모 관리·충돌 방지</td><td>운영 복잡도·정책 필요</td><td>클라우드·컨테이너</td></tr><tr><td>랜덤화 (Privacy)</td><td>클라이언트 임의 MAC 사용</td><td style=text-align:right>자주 변경 가능</td><td>개인정보 보호</td><td>NAC/로그 불일치</td><td>엔드유저 개인정보 보호</td></tr><tr><td>LAA (로컬)</td><td>U/L=1 로 로컬 할당</td><td style=text-align:right>가능</td><td>관리 편의</td><td>전역 유일성 없음</td><td>랩/테스트/임시환경</td></tr></tbody></table><p>하드웨어 (BIA) 는 신뢰성과 영구성을 제공하므로 물리 장비에 권장된다. 가상화 및 대규모 환경은 중앙 할당 (하이퍼바이저/CNI) 으로 관리하고, 소프트웨어 변경/랜덤화는 특정 목적 (테스트·프라이버시) 에만 제한적으로 허용해야 한다. 항상 IPAM/NAC 연동을 권장.</p><h6 id=각-구현-기법의-코드명령-예시>각 구현 기법의 코드/명령 예시<a hidden class=anchor aria-hidden=true href=#각-구현-기법의-코드명령-예시>#</a></h6><ul><li><p><strong>BIA 확인 (Bash)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ethtool -P eth0   <span class=c1># Permanent hardware MAC</span>
</span></span><span class=line><span class=cl>ip link show eth0
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>소프트웨어 변경 (Python)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1>1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2>2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3>3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4>4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5>5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6>6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7>7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 위에서 제공한 set_mac 함수 (subprocess 사용)</span>
</span></span><span class=line><span class=cl><span class=c1># Python: MAC 변경(간단한 subprocess 호출)</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>set_mac</span><span class=p>(</span><span class=n>interface</span><span class=p>,</span> <span class=n>mac</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=s2>&#34;sudo&#34;</span><span class=p>,</span> <span class=s2>&#34;ip&#34;</span><span class=p>,</span> <span class=s2>&#34;link&#34;</span><span class=p>,</span> <span class=s2>&#34;set&#34;</span><span class=p>,</span> <span class=s2>&#34;dev&#34;</span><span class=p>,</span> <span class=n>interface</span><span class=p>,</span> <span class=s2>&#34;down&#34;</span><span class=p>],</span> <span class=n>check</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=s2>&#34;sudo&#34;</span><span class=p>,</span> <span class=s2>&#34;ip&#34;</span><span class=p>,</span> <span class=s2>&#34;link&#34;</span><span class=p>,</span> <span class=s2>&#34;set&#34;</span><span class=p>,</span> <span class=s2>&#34;dev&#34;</span><span class=p>,</span> <span class=n>interface</span><span class=p>,</span> <span class=s2>&#34;address&#34;</span><span class=p>,</span> <span class=n>mac</span><span class=p>],</span> <span class=n>check</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=s2>&#34;sudo&#34;</span><span class=p>,</span> <span class=s2>&#34;ip&#34;</span><span class=p>,</span> <span class=s2>&#34;link&#34;</span><span class=p>,</span> <span class=s2>&#34;set&#34;</span><span class=p>,</span> <span class=s2>&#34;dev&#34;</span><span class=p>,</span> <span class=n>interface</span><span class=p>,</span> <span class=s2>&#34;up&#34;</span><span class=p>],</span> <span class=n>check</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 사용 예: set_mac(&#34;eth0&#34;, &#34;02:01:02:03:04:05&#34;)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>가상화 할당 (Docker Compose YAML)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1>1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2>2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3>3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4>4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5>5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6>6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7>7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># Docker Compose: mac_address 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;3&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>web</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>networks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>frontend</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>mac_address</span><span class=p>:</span><span class=w> </span><span class=m>02</span><span class=p>:</span><span class=m>42</span><span class=p>:</span><span class=l>ac:11:00:02</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>랜덤화 (Python)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1>1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2>2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3>3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4>4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5>5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6>6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7>7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># random_mac 함수 (위 예시) 사용 → ip link set … 로 적용</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>random_mac</span><span class=p>(</span><span class=n>local_admin</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 로컬 관리 비트(U/L=1)를 세팅하려면 두번째 LSB를 1로 설정</span>
</span></span><span class=line><span class=cl>    <span class=n>mac</span> <span class=o>=</span> <span class=p>[</span><span class=mh>0x02</span> <span class=k>if</span> <span class=n>local_admin</span> <span class=k>else</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0xff</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=n>mac</span> <span class=o>+=</span> <span class=p>[</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mh>0x00</span><span class=p>,</span><span class=mh>0xff</span><span class=p>)</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;:&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>b</span><span class=si>:</span><span class=s2>02x</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>mac</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 사용 예: random_mac()</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>LAA (bash)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1>1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 로컬 관리 비트 세팅 예시 (첫 옥텟의 LSB 2비트 중 b1=1)</span>
</span></span><span class=line><span class=cl>sudo ip link <span class=nb>set</span> dev eth0 address 02:11:22:33:44:55
</span></span></code></pre></td></tr></table></div></div></li></ul><h5 id=mac-운영검증-체크리스트>MAC 운영·검증 체크리스트<a hidden class=anchor aria-hidden=true href=#mac-운영검증-체크리스트>#</a></h5><table><thead><tr><th>항목</th><th>체크 포인트</th><th>권장 액션</th></tr></thead><tbody><tr><td>영구성 확인</td><td>BIA 와 현재 주소 일치 여부</td><td><code>ethtool -P</code> / <code>ip link</code> 비교</td></tr><tr><td>충돌 탐지</td><td>동일 MAC 이 네트워크에 존재하는가</td><td>네트워크 스캔, IPAM 대조</td></tr><tr><td>랜덤화 식별</td><td>무선 장치 스캔/접속 시 MAC 변경</td><td>NAC 정책에서 랜덤 MAC 허용 규정</td></tr><tr><td>가상화 충돌</td><td>VM 마이그레이션시 MAC 유지/중복 여부</td><td>MAC 풀 정책·검증 스크립트</td></tr><tr><td>로그/자산 동기화</td><td>MAC 변경시 IPAM/시큐리티 로그 업데이트</td><td>DHCP/DNS 웹훅 연동</td></tr><tr><td>보안 정책</td><td>Port Security / DHCP Snooping 적용 여부</td><td>정책 활성화 및 오탐 테스트</td></tr></tbody></table><p>운영팀은 MAC 변경 이벤트가 발생할 때마다 IPAM·SIEM·DHCP 로그가 동기화되는지 확인해야 한다. 랜덤화 장치는 별도 식별 레이블 (예: device fingerprint) 로 보완하는 것이 좋다.</p><h6 id=관련-코드검증-예시-python>관련 코드/검증 예시 (Python)<a hidden class=anchor aria-hidden=true href=#관련-코드검증-예시-python>#</a></h6><ul><li><p><strong>네트워크에서 동일 MAC 검색 (간단 스캔, ARP table 조합)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1> 1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2> 2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3> 3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4> 4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5> 5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6> 6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7> 7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8> 8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9> 9</a>
</span><span class=lnt id=hl-14-10><a class=lnlinks href=#hl-14-10>10</a>
</span><span class=lnt id=hl-14-11><a class=lnlinks href=#hl-14-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span><span class=o>,</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>find_arp_entries</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>check_output</span><span class=p>([</span><span class=s2>&#34;arp&#34;</span><span class=p>,</span> <span class=s2>&#34;-n&#34;</span><span class=p>])</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>entries</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>out</span><span class=o>.</span><span class=n>splitlines</span><span class=p>()[</span><span class=mi>1</span><span class=p>:]:</span>
</span></span><span class=line><span class=cl>        <span class=n>parts</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\s+&#39;</span><span class=p>,</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>ip</span><span class=p>,</span> <span class=n>hw</span> <span class=o>=</span> <span class=n>parts</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>parts</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>entries</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>ip</span><span class=p>,</span> <span class=n>hw</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>entries</span>
</span></span><span class=line><span class=cl><span class=c1># 사용 예: print(find_arp_entries())</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h4 id=mac-주소-유형별-분류-체계-및-실무-적용-가이드>MAC 주소 유형별 분류 체계 및 실무 적용 가이드<a hidden class=anchor aria-hidden=true href=#mac-주소-유형별-분류-체계-및-실무-적용-가이드>#</a></h4><p>MAC 주소는 <strong>L2 에서의 장치 식별자</strong>로, 실무에서는 " 무엇을 겨냥해 보내는가 (범위)&rdquo; 와 " 누가/어떻게 부여했는가 (관리·영속성)" 를 기준으로 분류한다.<br>예를 들어 <code>00:11:22:33:44:55</code> 는 제조사 (OUI) 기반의 전역 유니캐스트 (Universally Administered, Static) 일 수 있고, <code>02:11:22:33:44:55</code> 는 로컬관리 (Locally Administered) 마크가 된 가상 NIC 일 수 있다.</p><p>멀티캐스트·브로드캐스트는 L2 전달 방식에 따라 특별한 MAC 범위를 가지며, 클라우드·무선 환경에서는 소프트웨어 할당·랜덤화가 늘어나 자산·로그 정책에 영향을 준다.</p><h5 id=전송-범위-scope-기준>전송 범위 (Scope) 기준<a hidden class=anchor aria-hidden=true href=#전송-범위-scope-기준>#</a></h5><table><thead><tr><th>유형</th><th>정의</th><th style=text-align:right>MAC 예시/표현</th><th>사용 사례</th></tr></thead><tbody><tr><td>Unicast</td><td>단일 인터페이스 향하는 주소</td><td style=text-align:right><code>00:11:22:33:44:55</code></td><td>서버·클라이언트 통신</td></tr><tr><td>Multicast</td><td>그룹 수신자 지정 (I/G=1)</td><td style=text-align:right>IPv4→<code>01:00:5e:xx:xx:xx</code>IPv6→<code>33:33:xx:xx:xx:xx</code></td><td>IPTV, mDNS, 그룹 메시지</td></tr><tr><td>Broadcast</td><td>링크 내 모든 노드 (FF:FF:FF:FF:FF:FF)</td><td style=text-align:right><code>FF:FF:FF:FF:FF:FF</code></td><td>ARP Request, DHCP Discover</td></tr></tbody></table><p>전송 범위는 &rsquo; 누가 수신하느냐 &rsquo; 기준으로 단순 분류된다. Unicast 는 1:1, Multicast 는 그룹 (특정 매핑 규칙 존재), Broadcast 는 모든 노드 대상 (특수 전송). 멀티캐스트는 L3 주소와 매핑 규칙이 있으니 프로토콜 간 연관성 이해가 필요하다.</p><h5 id=관리-주체-administration-기준>관리 주체 (Administration) 기준<a hidden class=anchor aria-hidden=true href=#관리-주체-administration-기준>#</a></h5><table><thead><tr><th>유형</th><th>정의</th><th style=text-align:right>U/L 비트</th><th>예시</th><th>실무 시점의 의미</th></tr></thead><tbody><tr><td>Universally Administered</td><td>IEEE/OUI 기반 전역 고유</td><td style=text-align:right>U/L = 0</td><td>제조사 BIA(burned-in)</td><td>신뢰 자산 식별 (벤더·모델 파악)</td></tr><tr><td>Locally Administered</td><td>로컬 관리자/시스템에 의해 지정</td><td style=text-align:right>U/L = 1</td><td><code>02:xx:xx:xx:xx:xx</code> (LAA 마크)</td><td>가상 NIC, 테스트용, 정책식별용</td></tr></tbody></table><p>U/L 비트로 구분하면 " 전역 관리 (제조사)" 인지 " 로컬 관리 (운영자)" 인지 한눈에 파악된다. 로컬 MAC 은 가상화·운영 테스트에서 흔하므로 자산 DB 에 태그를 달아 구분하는 것이 실무 관행이다.</p><h5 id=영속성-persistence-기준>영속성 (Persistence) 기준<a hidden class=anchor aria-hidden=true href=#영속성-persistence-기준>#</a></h5><table><thead><tr><th>유형</th><th>정의</th><th style=text-align:right>변경 가능성</th><th>예시</th><th>운영·보안 영향</th></tr></thead><tbody><tr><td>Static</td><td>하드웨어로 고정되거나 수동 설정된 항목</td><td style=text-align:right>변경 불가 (또는 특수 방법)</td><td>NIC BIA, 스위치 Static FDB</td><td>안정적 정책 적용, 보안 바인딩 용이</td></tr><tr><td>Dynamic</td><td>런타임에 학습/할당되는 항목</td><td style=text-align:right>재부팅·타임아웃시 사라짐</td><td>스위치 학습 FDB, DHCP-assigned vNIC MAC</td><td>유동성, 충돌·플러딩 리스크</td></tr></tbody></table><p>정적 MAC 은 보안 바인딩 (예: 포트 시큐리티) 이나 고정 라우팅에 유리하다. 동적 MAC 은 유연하지만 스푸핑·중복 위험이 있어 모니터링·레이트리밋 등이 필요하다.</p><h5 id=구현저장-방식-implementation>구현·저장 방식 (Implementation)<a hidden class=anchor aria-hidden=true href=#구현저장-방식-implementation>#</a></h5><table><thead><tr><th>방식</th><th style=text-align:right>저장 위치</th><th style=text-align:right>변경성</th><th style=text-align:right>신뢰성</th><th>적용 환경</th></tr></thead><tbody><tr><td>Hardware-burned</td><td style=text-align:right>ROM/OTP</td><td style=text-align:right>불가능</td><td style=text-align:right>매우 높음</td><td>물리 NIC, 임베디드 장비</td></tr><tr><td>EEPROM-based</td><td style=text-align:right>장비 EEPROM</td><td style=text-align:right>제한적 (도구 필요)</td><td style=text-align:right>높음</td><td>업그레이드 가능한 NIC</td></tr><tr><td>Software-assigned</td><td style=text-align:right>OS config / hypervisor</td><td style=text-align:right>자유롭게 변경 가능</td><td style=text-align:right>중간</td><td>VM, 컨테이너, ENI</td></tr><tr><td>Runtime-generated</td><td style=text-align:right>휘발성 메모리 (랜덤화)</td><td style=text-align:right>재부팅 시 변경</td><td style=text-align:right>낮음</td><td>모바일 스캔 MAC, 임시 세션</td></tr></tbody></table><p>저장 방식은 복구·감사·신뢰성에 직접 영향. 클라우드·가상화 환경은 소프트웨어 할당이 일반적이라 운영 DB 연동 (태깅, 소유자 매핑) 이 필수다.</p><h5 id=운영-특성-및-특수-유형>운영 특성 및 특수 유형<a hidden class=anchor aria-hidden=true href=#운영-특성-및-특수-유형>#</a></h5><table><thead><tr><th>유형</th><th>정의</th><th style=text-align:right>표식/식별 방법</th><th>실무적 대응</th></tr></thead><tbody><tr><td>Virtual / ENI</td><td>클라우드/하이퍼바이저가 부여</td><td style=text-align:right>관리 콘솔/태그로 식별</td><td>자산 DB·자동화 연동</td></tr><tr><td>Randomized (Privacy)</td><td>OS 가 스캔용/연결용으로 임시 MAC 사용</td><td style=text-align:right>OS 정책·로그 패턴</td><td>접속 로그에 &rsquo; 임시 MAC&rsquo; 표기, 장기 바인딩 회피</td></tr><tr><td>Blackhole</td><td>의도적으로 패킷 폐기용 MAC</td><td style=text-align:right>네트워크 정책 · 스위치 ACL</td><td>이상 트래픽 필터링, 모니터링</td></tr><tr><td>Learned Entry</td><td>스위치 FDB 에 학습된 항목</td><td style=text-align:right>FDB 조회 (<code>show mac address-table</code>)</td><td>타임아웃·충돌 모니터링</td></tr></tbody></table><p>운영 특성은 정책·로그 처리·자동화 측면에서 중요하다. 랜덤화는 개인정보 보호에 유리하지만 자산 추적·포렌식에 부담을 준다. virtual MAC 은 반드시 태깅·소유자 매핑이 필요하다.</p><h4 id=mac-운영관리-도구-가이드>MAC 운영·관리 도구 가이드<a hidden class=anchor aria-hidden=true href=#mac-운영관리-도구-가이드>#</a></h4><p>운영체제·네트워크 관리 도구는 MAC 주소의 <strong>조회·변경·감시</strong>를 담당하고, 패킷 분석 도구는 MAC 기반 통신을 <strong>관찰·진단</strong>한다.<br>IPAM·네트워크 스캐너는 네트워크 전체의 <strong>자산과 주소 상태</strong>를 기록·관리하고, NAC·보안 도구는 MAC 을 포함한 식별 정보를 바탕으로 <strong>접근을 제어</strong>한다.<br>개발 라이브러리는 자동화와 커스텀 분석을 가능하게 한다. 실제 운영에서는 이들 도구를 조합해 실시간 가시성·정책·감사를 구현해야 한다.</p><h5 id=os--로컬-인터페이스-도구>OS / 로컬 인터페이스 도구<a hidden class=anchor aria-hidden=true href=#os--로컬-인터페이스-도구>#</a></h5><table><thead><tr><th>도구</th><th style=text-align:right>기능</th><th>역할 (무엇을 하는가)</th><th>강점</th><th>약점</th></tr></thead><tbody><tr><td><code>ip</code> (Linux)</td><td style=text-align:right>인터페이스 관리, MAC 조회/설정</td><td>현대적 표준, 링크 상태/주소 조작</td><td>풍부한 기능, 스크립트 친화적</td><td>관리자 권한 필요, 출력 형식 학습 필요</td></tr><tr><td><code>ethtool</code></td><td style=text-align:right>NIC 상세 정보/통계/드라이버</td><td>하드웨어 MAC·링크·속성 확인</td><td>하드웨어 레벨 진단 가능</td><td>일부 가상 NIC 미지원</td></tr><tr><td><code>macchanger</code></td><td style=text-align:right>MAC 변경</td><td>프라이버시/테스트용 MAC 랜덤화</td><td>빠른 변경·자동화 가능</td><td>기업망에서 규정상 금지될 수 있음</td></tr><tr><td><code>ipconfig</code>/<code>getmac</code> (Windows)</td><td style=text-align:right>인터페이스·MAC 조회</td><td>Windows 환경 기본 정보 제공</td><td>OS 내장, 사용 간편</td><td>제한적 기능 (세부 NIC 제어는 어려움)</td></tr></tbody></table><p>로컬 진단·임시 테스트에 필수. 운영 환경에선 정책·감사와 함께 사용해야 안전.</p><h5 id=패킷-분석--침해-조사-도구>패킷 분석 · 침해 조사 도구<a hidden class=anchor aria-hidden=true href=#패킷-분석--침해-조사-도구>#</a></h5><table><thead><tr><th>도구</th><th style=text-align:right>기능</th><th>역할</th><th>강점</th><th>약점</th></tr></thead><tbody><tr><td>Wireshark</td><td style=text-align:right>GUI 패킷 캡처·분석</td><td>프로토콜·프레임 디테일 분석</td><td>직관적 UI, 강력한 필터·디코딩</td><td>실시간 대규모 캡처시 성능 한계</td></tr><tr><td><code>tcpdump</code></td><td style=text-align:right>CLI 캡처·필터</td><td>경량 캡처·스크립트 연동</td><td>서버·SSH 환경에서 편리</td><td>복잡한 분석은 불편</td></tr><tr><td>Scapy (Python)</td><td style=text-align:right>패킷 생성·재생·분석</td><td>테스트·프로토타이핑</td><td>프로그래밍 가능, 유연</td><td>학습 곡선, 잘못된 패킷 주입 위험</td></tr></tbody></table><p>문제 원인 규명·포렌식의 핵심. 테스트는 격리된 환경에서 수행해야 안전.</p><h5 id=디스커버리관리ipam>디스커버리·관리·IPAM<a hidden class=anchor aria-hidden=true href=#디스커버리관리ipam>#</a></h5><table><thead><tr><th>도구/솔루션</th><th style=text-align:right>기능</th><th>역할</th><th>강점</th><th>약점</th></tr></thead><tbody><tr><td>Nmap / ARP-scan</td><td style=text-align:right>호스트·포트 탐지, ARP 기반 매핑</td><td>디바이스 발견, MAC-IP 매핑</td><td>빠른 스캔, 오픈 소스</td><td>대규모 스캔시 네트워크 부하</td></tr><tr><td>NetBox / phpIPAM</td><td style=text-align:right>IPAM, 인벤토리</td><td>중앙 주소·장비 레지스트리</td><td>API 기반 자동화, 시각화</td><td>실시간성은 별도 연동 필요</td></tr><tr><td>ISC DHCP / Windows DHCP</td><td style=text-align:right>DHCP 서비스</td><td>동적 IP 할당, 예약 (맥기반)</td><td>안정적 운영, 성숙한 기능</td><td>대규모 환경 관리 복잡도</td></tr></tbody></table><p>자동화된 주소·장비 관리는 운영 효율·감사에 직결. 반드시 스캔→IPAM 동기화 전략 필요.</p><h5 id=보안--nac--네트워크-보호>보안 · NAC · 네트워크 보호<a hidden class=anchor aria-hidden=true href=#보안--nac--네트워크-보호>#</a></h5><table><thead><tr><th>항목</th><th style=text-align:right>기능</th><th>역할</th><th>강점</th><th>약점</th></tr></thead><tbody><tr><td>802.1X (RADIUS)</td><td style=text-align:right>포트 기반 인증</td><td>장비 인증·접근제어</td><td>강력한 인증, 중앙관리</td><td>구현 복잡, 장비 지원 필요</td></tr><tr><td>DHCP snooping / DAI</td><td style=text-align:right>ARP/NDP/응답 보호</td><td>스푸핑 완화</td><td>L2 공격 억제</td><td>스위치 설정 복잡, false positive 가능</td></tr><tr><td>SIEM 연동</td><td style=text-align:right>로그/이상탐지</td><td>중앙 이상 탐지</td><td>컨텍스트 결합 탐지</td><td>통합·규칙 튜닝 필요</td></tr></tbody></table><p>MAC 기반 정책은 보완 (인증/검증) 과 결합해야 신뢰성 확보.</p><h5 id=개발자동화-라이브러리>개발·자동화 라이브러리<a hidden class=anchor aria-hidden=true href=#개발자동화-라이브러리>#</a></h5><table><thead><tr><th>라이브러리</th><th style=text-align:right>주요 용도</th><th>역할</th><th>강점</th><th>약점</th></tr></thead><tbody><tr><td><code>scapy</code></td><td style=text-align:right>패킷 조작·테스트</td><td>맞춤형 패킷 생성·분석</td><td>유연성 높음</td><td>직접 네트워크 영향 가능</td></tr><tr><td><code>netaddr</code>/<code>ipaddress</code></td><td style=text-align:right>주소 파싱·연산</td><td>서브넷 계산·검증</td><td>표준화된 연산 지원</td><td>대규모 네트워크 모델링은 추가 작업 필요</td></tr><tr><td><code>psutil</code>/<code>netifaces</code></td><td style=text-align:right>인터페이스 정보 수집</td><td>로컬 모니터링</td><td>간단한 시스템 정보 획득</td><td>플랫폼별 차이 존재</td></tr></tbody></table><p>자동화·테스트 코드의 핵심. 운영 자동화 파이프라인에 통합하면 가성비 큼.</p><h4 id=mac-주소-표준관리운영-가이드규격-oui-특수주소-보안-및-실무-권고>MAC 주소 표준·관리·운영 가이드—규격, OUI, 특수주소, 보안 및 실무 권고<a hidden class=anchor aria-hidden=true href=#mac-주소-표준관리운영-가이드규격-oui-특수주소-보안-및-실무-권고>#</a></h4><p>MAC 주소 표준은 <strong>누가 (IEEE)</strong>, <strong>어떻게 (OUI·EUI 포맷)</strong>, <strong>무엇을 위해 (프레임 전달·장치 식별)</strong> 정의했는지를 규정한다.<br>또한 특정 MAC 값들은 스위치·프로토콜 동작을 위해 예약되어 있고, 보안 (802.1X)·암호화 (MACsec) 표준이 존재한다.<br>현대 운영 환경에서는 MAC 랜덤화, 가상 NIC, IPv6 연동 (EUI-64) 등 표준과 실제 구현이 교차하므로 표준을 이해하고 운영 정책 (인증·감사·테스트) 을 병행하는 것이 중요하다.</p><h5 id=규격표준-체계>규격·표준 체계<a hidden class=anchor aria-hidden=true href=#규격표준-체계>#</a></h5><table><thead><tr><th>카테고리</th><th style=text-align:right>표준/기관</th><th>역할·내용</th></tr></thead><tbody><tr><td>기본 규격</td><td style=text-align:right>IEEE 802 (802.3, 802.11, 802.1 등)</td><td>MAC 포맷·프레임 구조·브리지 동작·보안 (802.1X/802.1AE) 규정</td></tr><tr><td>IP 연계</td><td style=text-align:right>IETF (RFC 2464 등)</td><td>이더넷 -IPv6 연동, 멀티캐스트 매핑 등 L2-L3 상호작용 규정</td></tr><tr><td>등록 기관</td><td style=text-align:right>IEEE Registration Authority</td><td>OUI/MA 등록·관리, 할당 정책 운영</td></tr></tbody></table><p>MAC 관련 핵심 규격은 IEEE 가 정의하고, IP 계층과의 상호작용/매핑은 IETF(RFC) 에서 다룹니다. 제조·운영자는 두 체계를 모두 참고해야 한다.</p><h6 id=oui-할당-및-관리>OUI 할당 및 관리<a hidden class=anchor aria-hidden=true href=#oui-할당-및-관리>#</a></h6><p><strong>IEEE Registration Authority 관리 체계:</strong></p><pre class=mermaid>graph TB
    A[IEEE Registration Authority] --&gt; B[OUI 할당 신청]
    B --&gt; C[제조업체 검증]
    C --&gt; D[OUI 할당 승인]
    D --&gt; E[OUI 데이터베이스 등록]
    E --&gt; F[공개 OUI 데이터베이스]
    
    subgraph &#34;OUI 사용&#34;
        G[제조업체] --&gt; H[MAC 주소 생성]
        H --&gt; I[디바이스 제조]
        I --&gt; J[MAC 주소 할당]
    end
    
    D --&gt; G
</pre><p><strong>준수해야 할 할당 규칙:</strong></p><ol><li><strong>OUI 신청 자격</strong>: 네트워크 장비 제조업체 또는 관련 기업</li><li><strong>할당 수량</strong>: OUI 당 2^24 (16,777,216) 개의 고유 주소</li><li><strong>사용 제한</strong>: 할당받은 OUI 를 다른 업체에 재판매 금지</li><li><strong>보고 의무</strong>: 특별한 경우 IEEE 에 사용 현황 보고</li></ol><h5 id=할당관리>할당·관리<a hidden class=anchor aria-hidden=true href=#할당관리>#</a></h5><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>OUI (MA-L 등)</td><td>제조사 식별자: IEEE 가 배정, 각 제조사는 자신 OUI 로 MAC 생성</td></tr><tr><td>MA-M/MA-S 등</td><td>보다 세분화된 할당 단위 (운영적 차이 존재)</td></tr><tr><td>U/L / I/G 비트</td><td>주소의 로컬/유니버설, 그룹/유니캐스트 특성 지정</td></tr></tbody></table><p>OUI 는 전역 고유성의 근거이며 MAC 주소의 일부 비트 (U/L, I/G) 는 주소 성격 판단에 사용됩니다.</p><h5 id=보안인증-표준>보안·인증 표준<a hidden class=anchor aria-hidden=true href=#보안인증-표준>#</a></h5><table><thead><tr><th>표준</th><th>용도/기능</th></tr></thead><tbody><tr><td>IEEE 802.1X</td><td>포트 기반 인증 (네트워크 접속 제어, EAP 기반)</td></tr><tr><td>IEEE 802.1AE (MACsec)</td><td>데이터링크 계층 암호화/무결성</td></tr><tr><td>IEEE 802.1AR (DevID)</td><td>장치 식별을 위한 인증서 기반 식별자 (디바이스 ID)</td></tr></tbody></table><p>MAC 자체는 신뢰할 수 없으므로 802.1X/MA Csec/DevID 같은 표준으로 보완해야 합니다.</p><h5 id=특수예약-mac-주소>특수/예약 MAC 주소<a hidden class=anchor aria-hidden=true href=#특수예약-mac-주소>#</a></h5><table><thead><tr><th>주소/패턴</th><th>용도 (프로토콜)</th></tr></thead><tbody><tr><td><code>FF:FF:FF:FF:FF:FF</code></td><td>브로드캐스트 (모든 호스트)</td></tr><tr><td><code>01:80:C2:00:00:00</code> 등</td><td>STP BPDU, LACP, Pause 등 스위치 - 특수프레임</td></tr><tr><td><code>01:00:5E:xx:xx:xx</code></td><td>IPv4 멀티캐스트 매핑</td></tr><tr><td><code>33:33:xx:xx:xx:xx</code></td><td>IPv6 멀티캐스트 매핑</td></tr></tbody></table><p>이들 주소는 표준상 특별 취급되며, 관리자가 임의로 사용하면 네트워크 동작에 문제를 일으킵니다.</p><h5 id=운영실무-규칙권고>운영·실무 규칙/권고<a hidden class=anchor aria-hidden=true href=#운영실무-규칙권고>#</a></h5><table><thead><tr><th>주제</th><th>권장 조치</th></tr></thead><tbody><tr><td>MAC 랜덤화</td><td>기업 SSID/프로파일 적용 또는 MDM 등록, DHCP 예약 정책 재설계</td></tr><tr><td>가상화 환경</td><td>하이퍼바이저 중심 MAC 풀 관리·충돌 검사</td></tr><tr><td>L2 스케일</td><td>VLAN 분리·오버레이 (EVPN/VXLAN) 도입</td></tr><tr><td>로그·감사</td><td>DHCP/RADIUS/스위치 로그 연계·상관분석 (SIEM)</td></tr></tbody></table><p>표준 준수만으로 충분치 않으므로 운영 정책·자동화·로그 상관이 실무 핵심입니다.</p><h5 id=시험호환성>시험·호환성<a hidden class=anchor aria-hidden=true href=#시험호환성>#</a></h5><table><thead><tr><th>항목</th><th>목적</th></tr></thead><tbody><tr><td>Wi-Fi / Ethernet 상호운용성 테스트</td><td>장비 간 상호 동작 확인</td></tr><tr><td>IPv6 Ready / 기타 로고</td><td>IPv6/Ethernet 관련 구현 검증</td></tr><tr><td>자체 테스트</td><td>예약주소 처리, 802.1X/DAI 작동 검증</td></tr></tbody></table><p>제조·운영자는 표준 시험과 상호운용성 검증을 통해 실전 배포 리스크를 낮춰야 합니다.</p><h3 id=실무-적용-및-사례>실무 적용 및 사례<a hidden class=anchor aria-hidden=true href=#실무-적용-및-사례>#</a></h3><h4 id=실습-예제-및-코드-구현>실습 예제 및 코드 구현<a hidden class=anchor aria-hidden=true href=#실습-예제-및-코드-구현>#</a></h4><h5 id=실습-예제-python-으로-mac-주소-읽기-및-변경>실습 예제: Python 으로 MAC 주소 읽기 및 변경<a hidden class=anchor aria-hidden=true href=#실습-예제-python-으로-mac-주소-읽기-및-변경>#</a></h5><h6 id=목적>목적<a hidden class=anchor aria-hidden=true href=#목적>#</a></h6><ul><li>네트워크 인터페이스의 MAC 주소 식별 및 변경 원리를 실습을 통해 체득</li></ul><h6 id=사전-요구사항>사전 요구사항<a hidden class=anchor aria-hidden=true href=#사전-요구사항>#</a></h6><ul><li>Python 3.6+</li><li>운영체제: Linux/Windows/macOS</li><li>권한: 관리자 (root), 네트워크 액세스 권한</li></ul><h6 id=단계별-구현>단계별 구현<a hidden class=anchor aria-hidden=true href=#단계별-구현>#</a></h6><ol><li><p><strong>1 단계: 현재 MAC 주소 읽기</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1>1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2>2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3>3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4>4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5>5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6>6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7>7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 현재 시스템의 네트워크 하드웨어(MAC) 주소를 읽어오는 코드 예시</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>uuid</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mac</span> <span class=o>=</span> <span class=s1>&#39;:&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=s1>&#39;</span><span class=si>{:02x}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>((</span><span class=n>uuid</span><span class=o>.</span><span class=n>getnode</span><span class=p>()</span> <span class=o>&gt;&gt;</span> <span class=n>ele</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xff</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>ele</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>8</span><span class=o>*</span><span class=mi>6</span><span class=p>,</span> <span class=mi>8</span><span class=p>)][::</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;현재 MAC 주소:&#34;</span><span class=p>,</span> <span class=n>mac</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># uuid.getnode()는 하드웨어 주소를 48비트 정수형으로 반환</span>
</span></span><span class=line><span class=cl><span class=c1># 비트 시프트와 마스킹으로 각 바이트 추출하여 16진수 → MAC 주소 형태로 포맷팅</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>2 단계: 랜덤 MAC 생성 및 변경</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1> 1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2> 2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3> 3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4> 4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5> 5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6> 6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7> 7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8> 8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9> 9</a>
</span><span class=lnt id=hl-17-10><a class=lnlinks href=#hl-17-10>10</a>
</span><span class=lnt id=hl-17-11><a class=lnlinks href=#hl-17-11>11</a>
</span><span class=lnt id=hl-17-12><a class=lnlinks href=#hl-17-12>12</a>
</span><span class=lnt id=hl-17-13><a class=lnlinks href=#hl-17-13>13</a>
</span><span class=lnt id=hl-17-14><a class=lnlinks href=#hl-17-14>14</a>
</span><span class=lnt id=hl-17-15><a class=lnlinks href=#hl-17-15>15</a>
</span><span class=lnt id=hl-17-16><a class=lnlinks href=#hl-17-16>16</a>
</span><span class=lnt id=hl-17-17><a class=lnlinks href=#hl-17-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 랜덤 MAC 주소를 생성하고 특정 인터페이스에 할당하는 예시(Linux 환경)</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_random_mac_address</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># OUI 앞 1바이트는 &#39;00&#39;, 나머지 무작위 16진수로 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>mac</span> <span class=o>=</span> <span class=s2>&#34;00:&#34;</span> <span class=o>+</span> <span class=s2>&#34;:&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{:02x}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>255</span><span class=p>))</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>5</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>mac</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>iface</span> <span class=o>=</span> <span class=s2>&#34;eth0&#34;</span> <span class=c1># 변경할 네트워크 인터페이스</span>
</span></span><span class=line><span class=cl><span class=n>new_mac</span> <span class=o>=</span> <span class=n>get_random_mac_address</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;랜덤 MAC 주소:&#34;</span><span class=p>,</span> <span class=n>new_mac</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>subprocess</span><span class=o>.</span><span class=n>call</span><span class=p>([</span><span class=s2>&#34;sudo&#34;</span><span class=p>,</span> <span class=s2>&#34;ifconfig&#34;</span><span class=p>,</span> <span class=n>iface</span><span class=p>,</span> <span class=s2>&#34;down&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>subprocess</span><span class=o>.</span><span class=n>call</span><span class=p>([</span><span class=s2>&#34;sudo&#34;</span><span class=p>,</span> <span class=s2>&#34;ifconfig&#34;</span><span class=p>,</span> <span class=n>iface</span><span class=p>,</span> <span class=s2>&#34;hw&#34;</span><span class=p>,</span> <span class=s2>&#34;ether&#34;</span><span class=p>,</span> <span class=n>new_mac</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>subprocess</span><span class=o>.</span><span class=n>call</span><span class=p>([</span><span class=s2>&#34;sudo&#34;</span><span class=p>,</span> <span class=s2>&#34;ifconfig&#34;</span><span class=p>,</span> <span class=n>iface</span><span class=p>,</span> <span class=s2>&#34;up&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=c1># 실제 운영환경에서는 &#39;macchanger&#39; CLI나 고급 API 활용 가능</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h5 id=실행-결과>실행 결과<a hidden class=anchor aria-hidden=true href=#실행-결과>#</a></h5><ul><li>현재 MAC 주소, 랜덤 MAC 주소 출력 및 네트워크 장치 MAC 이 실제 변경됨</li><li><code>ifconfig</code> 명령 등으로 변경 내역 검증 가능</li></ul><h5 id=추가-실험>추가 실험<a hidden class=anchor aria-hidden=true href=#추가-실험>#</a></h5><ul><li>여러 인터페이스 반복 변경, MAC 주소 기반 네트워크 ACL 적용, 스푸핑 탐지 실험</li></ul><h5 id=실습-예제-mac-주소-정보-수집-및-분석>실습 예제: MAC 주소 정보 수집 및 분석<a hidden class=anchor aria-hidden=true href=#실습-예제-mac-주소-정보-수집-및-분석>#</a></h5><h6 id=목적-1>목적<a hidden class=anchor aria-hidden=true href=#목적-1>#</a></h6><ul><li>네트워크 내 디바이스들의 MAC 주소를 자동으로 수집하고 분석</li><li>제조업체 정보를 파악하여 네트워크 인벤토리 구성</li></ul><h6 id=사전-요구사항-1>사전 요구사항<a hidden class=anchor aria-hidden=true href=#사전-요구사항-1>#</a></h6><ul><li>Python 3.7 이상</li><li>라이브러리: <code>scapy</code>, <code>requests</code>, <code>netifaces</code></li><li>관리자 권한 (패킷 캡처용)</li></ul><h6 id=단계별-구현-1>단계별 구현<a hidden class=anchor aria-hidden=true href=#단계별-구현-1>#</a></h6><ol><li><p><strong>1 단계: 라이브러리 설치 및 기본 설정</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1>1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 필요 라이브러리 설치</span>
</span></span><span class=line><span class=cl>pip install scapy requests netifaces python-nmap
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12>12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13>13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14>14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15>15</a>
</span><span class=lnt id=hl-19-16><a class=lnlinks href=#hl-19-16>16</a>
</span><span class=lnt id=hl-19-17><a class=lnlinks href=#hl-19-17>17</a>
</span><span class=lnt id=hl-19-18><a class=lnlinks href=#hl-19-18>18</a>
</span><span class=lnt id=hl-19-19><a class=lnlinks href=#hl-19-19>19</a>
</span><span class=lnt id=hl-19-20><a class=lnlinks href=#hl-19-20>20</a>
</span><span class=lnt id=hl-19-21><a class=lnlinks href=#hl-19-21>21</a>
</span><span class=lnt id=hl-19-22><a class=lnlinks href=#hl-19-22>22</a>
</span><span class=lnt id=hl-19-23><a class=lnlinks href=#hl-19-23>23</a>
</span><span class=lnt id=hl-19-24><a class=lnlinks href=#hl-19-24>24</a>
</span><span class=lnt id=hl-19-25><a class=lnlinks href=#hl-19-25>25</a>
</span><span class=lnt id=hl-19-26><a class=lnlinks href=#hl-19-26>26</a>
</span><span class=lnt id=hl-19-27><a class=lnlinks href=#hl-19-27>27</a>
</span><span class=lnt id=hl-19-28><a class=lnlinks href=#hl-19-28>28</a>
</span><span class=lnt id=hl-19-29><a class=lnlinks href=#hl-19-29>29</a>
</span><span class=lnt id=hl-19-30><a class=lnlinks href=#hl-19-30>30</a>
</span><span class=lnt id=hl-19-31><a class=lnlinks href=#hl-19-31>31</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># mac_analyzer.py - MAC 주소 분석 도구</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>netifaces</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>scapy.all</span> <span class=kn>import</span> <span class=n>ARP</span><span class=p>,</span> <span class=n>Ether</span><span class=p>,</span> <span class=n>srp</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>socket</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MACAnalyzer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># OUI 데이터베이스 URL (IEEE 공식)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>oui_url</span> <span class=o>=</span> <span class=s2>&#34;http://standards-oui.ieee.org/oui/oui.txt&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>oui_db</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>load_oui_database</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>load_oui_database</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;IEEE OUI 데이터베이스를 로드하여 제조업체 정보 매핑&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>oui_url</span><span class=p>,</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># OUI 정보 파싱 (예: &#34;00-1B-44   (hex)		Dell Inc.&#34;)</span>
</span></span><span class=line><span class=cl>                <span class=n>oui_pattern</span> <span class=o>=</span> <span class=sa>r</span><span class=s1>&#39;^([0-9A-F]</span><span class=si>{2}</span><span class=s1>-[0-9A-F]</span><span class=si>{2}</span><span class=s1>-[0-9A-F]</span><span class=si>{2}</span><span class=s1>)\s+\(hex\)\s+(.+)$&#39;</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=k>match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>oui_pattern</span><span class=p>,</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=k>match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>oui</span> <span class=o>=</span> <span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;-&#39;</span><span class=p>,</span> <span class=s1>&#39;:&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                        <span class=n>vendor</span> <span class=o>=</span> <span class=k>match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                        <span class=bp>self</span><span class=o>.</span><span class=n>oui_db</span><span class=p>[</span><span class=n>oui</span><span class=p>]</span> <span class=o>=</span> <span class=n>vendor</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;OUI 데이터베이스 로드 완료: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>oui_db</span><span class=p>)</span><span class=si>}</span><span class=s2>개 제조업체&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;OUI 데이터베이스 로드 실패: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>2 단계: 네트워크 스캔 및 MAC 주소 수집</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1> 1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2> 2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3> 3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4> 4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5> 5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6> 6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7> 7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8> 8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9> 9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10>10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11>11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12>12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13>13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14>14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15>15</a>
</span><span class=lnt id=hl-20-16><a class=lnlinks href=#hl-20-16>16</a>
</span><span class=lnt id=hl-20-17><a class=lnlinks href=#hl-20-17>17</a>
</span><span class=lnt id=hl-20-18><a class=lnlinks href=#hl-20-18>18</a>
</span><span class=lnt id=hl-20-19><a class=lnlinks href=#hl-20-19>19</a>
</span><span class=lnt id=hl-20-20><a class=lnlinks href=#hl-20-20>20</a>
</span><span class=lnt id=hl-20-21><a class=lnlinks href=#hl-20-21>21</a>
</span><span class=lnt id=hl-20-22><a class=lnlinks href=#hl-20-22>22</a>
</span><span class=lnt id=hl-20-23><a class=lnlinks href=#hl-20-23>23</a>
</span><span class=lnt id=hl-20-24><a class=lnlinks href=#hl-20-24>24</a>
</span><span class=lnt id=hl-20-25><a class=lnlinks href=#hl-20-25>25</a>
</span><span class=lnt id=hl-20-26><a class=lnlinks href=#hl-20-26>26</a>
</span><span class=lnt id=hl-20-27><a class=lnlinks href=#hl-20-27>27</a>
</span><span class=lnt id=hl-20-28><a class=lnlinks href=#hl-20-28>28</a>
</span><span class=lnt id=hl-20-29><a class=lnlinks href=#hl-20-29>29</a>
</span><span class=lnt id=hl-20-30><a class=lnlinks href=#hl-20-30>30</a>
</span><span class=lnt id=hl-20-31><a class=lnlinks href=#hl-20-31>31</a>
</span><span class=lnt id=hl-20-32><a class=lnlinks href=#hl-20-32>32</a>
</span><span class=lnt id=hl-20-33><a class=lnlinks href=#hl-20-33>33</a>
</span><span class=lnt id=hl-20-34><a class=lnlinks href=#hl-20-34>34</a>
</span><span class=lnt id=hl-20-35><a class=lnlinks href=#hl-20-35>35</a>
</span><span class=lnt id=hl-20-36><a class=lnlinks href=#hl-20-36>36</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>scan_network</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>network_range</span><span class=o>=</span><span class=s2>&#34;192.168.1.0/24&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;ARP 스캔을 통해 네트워크 내 활성 디바이스 MAC 주소 수집&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;네트워크 스캔 시작: </span><span class=si>{</span><span class=n>network_range</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># ARP 요청 패킷 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>arp_request</span> <span class=o>=</span> <span class=n>ARP</span><span class=p>(</span><span class=n>pdst</span><span class=o>=</span><span class=n>network_range</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>broadcast</span> <span class=o>=</span> <span class=n>Ether</span><span class=p>(</span><span class=n>dst</span><span class=o>=</span><span class=s2>&#34;ff:ff:ff:ff:ff:ff&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>arp_request_broadcast</span> <span class=o>=</span> <span class=n>broadcast</span> <span class=o>/</span> <span class=n>arp_request</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 패킷 전송 및 응답 수신</span>
</span></span><span class=line><span class=cl>        <span class=n>answered_list</span> <span class=o>=</span> <span class=n>srp</span><span class=p>(</span><span class=n>arp_request_broadcast</span><span class=p>,</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=kc>False</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>devices</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>element</span> <span class=ow>in</span> <span class=n>answered_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>device_info</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;ip&#39;</span><span class=p>:</span> <span class=n>element</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>psrc</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;mac&#39;</span><span class=p>:</span> <span class=n>element</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>hwsrc</span><span class=o>.</span><span class=n>lower</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;vendor&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_vendor_from_mac</span><span class=p>(</span><span class=n>element</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>hwsrc</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;hostname&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_hostname</span><span class=p>(</span><span class=n>element</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>psrc</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=n>devices</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>device_info</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>devices</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_vendor_from_mac</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>mac_address</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;MAC 주소로부터 제조업체 정보 추출&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># OUI 추출 (처음 3옥텟)</span>
</span></span><span class=line><span class=cl>        <span class=n>oui</span> <span class=o>=</span> <span class=s1>&#39;:&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>mac_address</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)[:</span><span class=mi>3</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>oui_db</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>oui</span><span class=p>,</span> <span class=s2>&#34;Unknown Vendor&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_hostname</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ip_address</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;IP 주소로부터 호스트명 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>socket</span><span class=o>.</span><span class=n>gethostbyaddr</span><span class=p>(</span><span class=n>ip_address</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s2>&#34;Unknown&#34;</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>3 단계: MAC 주소 검증 및 분석</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span><span class=lnt id=hl-21-11><a class=lnlinks href=#hl-21-11>11</a>
</span><span class=lnt id=hl-21-12><a class=lnlinks href=#hl-21-12>12</a>
</span><span class=lnt id=hl-21-13><a class=lnlinks href=#hl-21-13>13</a>
</span><span class=lnt id=hl-21-14><a class=lnlinks href=#hl-21-14>14</a>
</span><span class=lnt id=hl-21-15><a class=lnlinks href=#hl-21-15>15</a>
</span><span class=lnt id=hl-21-16><a class=lnlinks href=#hl-21-16>16</a>
</span><span class=lnt id=hl-21-17><a class=lnlinks href=#hl-21-17>17</a>
</span><span class=lnt id=hl-21-18><a class=lnlinks href=#hl-21-18>18</a>
</span><span class=lnt id=hl-21-19><a class=lnlinks href=#hl-21-19>19</a>
</span><span class=lnt id=hl-21-20><a class=lnlinks href=#hl-21-20>20</a>
</span><span class=lnt id=hl-21-21><a class=lnlinks href=#hl-21-21>21</a>
</span><span class=lnt id=hl-21-22><a class=lnlinks href=#hl-21-22>22</a>
</span><span class=lnt id=hl-21-23><a class=lnlinks href=#hl-21-23>23</a>
</span><span class=lnt id=hl-21-24><a class=lnlinks href=#hl-21-24>24</a>
</span><span class=lnt id=hl-21-25><a class=lnlinks href=#hl-21-25>25</a>
</span><span class=lnt id=hl-21-26><a class=lnlinks href=#hl-21-26>26</a>
</span><span class=lnt id=hl-21-27><a class=lnlinks href=#hl-21-27>27</a>
</span><span class=lnt id=hl-21-28><a class=lnlinks href=#hl-21-28>28</a>
</span><span class=lnt id=hl-21-29><a class=lnlinks href=#hl-21-29>29</a>
</span><span class=lnt id=hl-21-30><a class=lnlinks href=#hl-21-30>30</a>
</span><span class=lnt id=hl-21-31><a class=lnlinks href=#hl-21-31>31</a>
</span><span class=lnt id=hl-21-32><a class=lnlinks href=#hl-21-32>32</a>
</span><span class=lnt id=hl-21-33><a class=lnlinks href=#hl-21-33>33</a>
</span><span class=lnt id=hl-21-34><a class=lnlinks href=#hl-21-34>34</a>
</span><span class=lnt id=hl-21-35><a class=lnlinks href=#hl-21-35>35</a>
</span><span class=lnt id=hl-21-36><a class=lnlinks href=#hl-21-36>36</a>
</span><span class=lnt id=hl-21-37><a class=lnlinks href=#hl-21-37>37</a>
</span><span class=lnt id=hl-21-38><a class=lnlinks href=#hl-21-38>38</a>
</span><span class=lnt id=hl-21-39><a class=lnlinks href=#hl-21-39>39</a>
</span><span class=lnt id=hl-21-40><a class=lnlinks href=#hl-21-40>40</a>
</span><span class=lnt id=hl-21-41><a class=lnlinks href=#hl-21-41>41</a>
</span><span class=lnt id=hl-21-42><a class=lnlinks href=#hl-21-42>42</a>
</span><span class=lnt id=hl-21-43><a class=lnlinks href=#hl-21-43>43</a>
</span><span class=lnt id=hl-21-44><a class=lnlinks href=#hl-21-44>44</a>
</span><span class=lnt id=hl-21-45><a class=lnlinks href=#hl-21-45>45</a>
</span><span class=lnt id=hl-21-46><a class=lnlinks href=#hl-21-46>46</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>validate_mac_address</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>mac</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;MAC 주소 형식 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 표준 MAC 주소 패턴 (XX:XX:XX:XX:XX:XX)</span>
</span></span><span class=line><span class=cl>        <span class=n>pattern</span> <span class=o>=</span> <span class=sa>r</span><span class=s1>&#39;^([0-9A-Fa-f]</span><span class=si>{2}</span><span class=s1>[:-])</span><span class=si>{5}</span><span class=s1>([0-9A-Fa-f]</span><span class=si>{2}</span><span class=s1>)$&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>bool</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>mac</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>analyze_mac_flags</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>mac_address</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;MAC 주소의 플래그 비트 분석&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 첫 번째 옥텟의 최하위 2비트 분석</span>
</span></span><span class=line><span class=cl>        <span class=n>first_octet</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>mac_address</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>],</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># I/G 플래그 (비트 0)</span>
</span></span><span class=line><span class=cl>        <span class=n>is_group</span> <span class=o>=</span> <span class=nb>bool</span><span class=p>(</span><span class=n>first_octet</span> <span class=o>&amp;</span> <span class=mh>0x01</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># U/L 플래그 (비트 1)  </span>
</span></span><span class=line><span class=cl>        <span class=n>is_local</span> <span class=o>=</span> <span class=nb>bool</span><span class=p>(</span><span class=n>first_octet</span> <span class=o>&amp;</span> <span class=mh>0x02</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;is_individual&#39;</span><span class=p>:</span> <span class=ow>not</span> <span class=n>is_group</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;is_group&#39;</span><span class=p>:</span> <span class=n>is_group</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;is_universal&#39;</span><span class=p>:</span> <span class=ow>not</span> <span class=n>is_local</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;is_local&#39;</span><span class=p>:</span> <span class=n>is_local</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;Multicast/Broadcast&#39;</span> <span class=k>if</span> <span class=n>is_group</span> <span class=k>else</span> <span class=s1>&#39;Unicast&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;administration&#39;</span><span class=p>:</span> <span class=s1>&#39;Locally Administered&#39;</span> <span class=k>if</span> <span class=n>is_local</span> <span class=k>else</span> <span class=s1>&#39;Universally Administered&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>generate_report</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>devices</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;수집된 디바이스 정보를 기반으로 보고서 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>=== 네트워크 MAC 주소 분석 보고서 ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;총 발견된 디바이스: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>devices</span><span class=p>)</span><span class=si>}</span><span class=s2>개</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 제조업체별 통계</span>
</span></span><span class=line><span class=cl>        <span class=n>vendor_stats</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>device</span> <span class=ow>in</span> <span class=n>devices</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>vendor</span> <span class=o>=</span> <span class=n>device</span><span class=p>[</span><span class=s1>&#39;vendor&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>vendor_stats</span><span class=p>[</span><span class=n>vendor</span><span class=p>]</span> <span class=o>=</span> <span class=n>vendor_stats</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>vendor</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;제조업체별 디바이스 수:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>vendor</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>vendor_stats</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  </span><span class=si>{</span><span class=n>vendor</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>count</span><span class=si>}</span><span class=s2>개&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>상세 디바이스 목록:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>device</span> <span class=ow>in</span> <span class=n>devices</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>flags</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>analyze_mac_flags</span><span class=p>(</span><span class=n>device</span><span class=p>[</span><span class=s1>&#39;mac&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;IP: </span><span class=si>{</span><span class=n>device</span><span class=p>[</span><span class=s1>&#39;ip&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>15</span><span class=si>}</span><span class=s2> | MAC: </span><span class=si>{</span><span class=n>device</span><span class=p>[</span><span class=s1>&#39;mac&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>17</span><span class=si>}</span><span class=s2> | &#34;</span>
</span></span><span class=line><span class=cl>                  <span class=sa>f</span><span class=s2>&#34;제조업체: </span><span class=si>{</span><span class=n>device</span><span class=p>[</span><span class=s1>&#39;vendor&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>20</span><span class=si>}</span><span class=s2> | 호스트: </span><span class=si>{</span><span class=n>device</span><span class=p>[</span><span class=s1>&#39;hostname&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;                    플래그: </span><span class=si>{</span><span class=n>flags</span><span class=p>[</span><span class=s1>&#39;administration&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>flags</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h6 id=실행-결과-1>실행 결과<a hidden class=anchor aria-hidden=true href=#실행-결과-1>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1> 1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2> 2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3> 3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4> 4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5> 5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6> 6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7> 7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8> 8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9> 9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10>10</a>
</span><span class=lnt id=hl-22-11><a class=lnlinks href=#hl-22-11>11</a>
</span><span class=lnt id=hl-22-12><a class=lnlinks href=#hl-22-12>12</a>
</span><span class=lnt id=hl-22-13><a class=lnlinks href=#hl-22-13>13</a>
</span><span class=lnt id=hl-22-14><a class=lnlinks href=#hl-22-14>14</a>
</span><span class=lnt id=hl-22-15><a class=lnlinks href=#hl-22-15>15</a>
</span><span class=lnt id=hl-22-16><a class=lnlinks href=#hl-22-16>16</a>
</span><span class=lnt id=hl-22-17><a class=lnlinks href=#hl-22-17>17</a>
</span><span class=lnt id=hl-22-18><a class=lnlinks href=#hl-22-18>18</a>
</span><span class=lnt id=hl-22-19><a class=lnlinks href=#hl-22-19>19</a>
</span><span class=lnt id=hl-22-20><a class=lnlinks href=#hl-22-20>20</a>
</span><span class=lnt id=hl-22-21><a class=lnlinks href=#hl-22-21>21</a>
</span><span class=lnt id=hl-22-22><a class=lnlinks href=#hl-22-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 스크립트 실행</span>
</span></span><span class=line><span class=cl>python mac_analyzer.py
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 예상 출력</span>
</span></span><span class=line><span class=cl>OUI 데이터베이스 로드 완료: 28742개 제조업체
</span></span><span class=line><span class=cl>네트워크 스캔 시작: 192.168.1.0/24
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>===</span> 네트워크 MAC 주소 분석 <span class=nv>보고서</span> <span class=o>===</span>
</span></span><span class=line><span class=cl>총 발견된 디바이스: 12개
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>제조업체별 디바이스 수:
</span></span><span class=line><span class=cl>  Apple, Inc.: 4개
</span></span><span class=line><span class=cl>  Samsung Electronics Co.,Ltd: 3개
</span></span><span class=line><span class=cl>  Intel Corporate: 2개
</span></span><span class=line><span class=cl>  Dell Inc.: 2개
</span></span><span class=line><span class=cl>  Unknown Vendor: 1개
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>상세 디바이스 목록:
</span></span><span class=line><span class=cl>IP: 192.168.1.1    <span class=p>|</span> MAC: a4:5e:60:e8:96:28 <span class=p>|</span> 제조업체: Netgear              <span class=p>|</span> 호스트: router.local
</span></span><span class=line><span class=cl>                    플래그: Universally Administered, Unicast
</span></span><span class=line><span class=cl>IP: 192.168.1.15   <span class=p>|</span> MAC: 88:e9:fe:6b:42:1a <span class=p>|</span> 제조업체: Apple, Inc.          <span class=p>|</span> 호스트: MacBook-Pro.local
</span></span><span class=line><span class=cl>                    플래그: Universally Administered, Unicast
</span></span></code></pre></td></tr></table></div></div><h6 id=추가-실험-1>추가 실험<a hidden class=anchor aria-hidden=true href=#추가-실험-1>#</a></h6><ul><li>다른 네트워크 대역 스캔</li><li>MAC 주소 변경 감지 모니터링</li><li>의심스러운 MAC 주소 패턴 탐지</li></ul><h5 id=실습-예제-mac-기반-네트워크-보안-시스템>실습 예제: MAC 기반 네트워크 보안 시스템<a hidden class=anchor aria-hidden=true href=#실습-예제-mac-기반-네트워크-보안-시스템>#</a></h5><h6 id=목적-2>목적<a hidden class=anchor aria-hidden=true href=#목적-2>#</a></h6><ul><li>MAC 주소를 활용한 간단한 네트워크 접근 제어 시스템 구현</li><li>화이트리스트/블랙리스트 기반 접근 관리</li></ul><h6 id=사전-요구사항-2>사전 요구사항<a hidden class=anchor aria-hidden=true href=#사전-요구사항-2>#</a></h6><ul><li>Linux 환경 (iptables 지원)</li><li>Python 3.7 이상</li><li>root 권한 (방화벽 규칙 조작용)</li></ul><h6 id=단계별-구현-2>단계별 구현<a hidden class=anchor aria-hidden=true href=#단계별-구현-2>#</a></h6><ol><li><p><strong>1 단계: MAC 기반 방화벽 관리자 클래스</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1> 1</a>
</span><span class=lnt id=hl-23-2><a class=lnlinks href=#hl-23-2> 2</a>
</span><span class=lnt id=hl-23-3><a class=lnlinks href=#hl-23-3> 3</a>
</span><span class=lnt id=hl-23-4><a class=lnlinks href=#hl-23-4> 4</a>
</span><span class=lnt id=hl-23-5><a class=lnlinks href=#hl-23-5> 5</a>
</span><span class=lnt id=hl-23-6><a class=lnlinks href=#hl-23-6> 6</a>
</span><span class=lnt id=hl-23-7><a class=lnlinks href=#hl-23-7> 7</a>
</span><span class=lnt id=hl-23-8><a class=lnlinks href=#hl-23-8> 8</a>
</span><span class=lnt id=hl-23-9><a class=lnlinks href=#hl-23-9> 9</a>
</span><span class=lnt id=hl-23-10><a class=lnlinks href=#hl-23-10>10</a>
</span><span class=lnt id=hl-23-11><a class=lnlinks href=#hl-23-11>11</a>
</span><span class=lnt id=hl-23-12><a class=lnlinks href=#hl-23-12>12</a>
</span><span class=lnt id=hl-23-13><a class=lnlinks href=#hl-23-13>13</a>
</span><span class=lnt id=hl-23-14><a class=lnlinks href=#hl-23-14>14</a>
</span><span class=lnt id=hl-23-15><a class=lnlinks href=#hl-23-15>15</a>
</span><span class=lnt id=hl-23-16><a class=lnlinks href=#hl-23-16>16</a>
</span><span class=lnt id=hl-23-17><a class=lnlinks href=#hl-23-17>17</a>
</span><span class=lnt id=hl-23-18><a class=lnlinks href=#hl-23-18>18</a>
</span><span class=lnt id=hl-23-19><a class=lnlinks href=#hl-23-19>19</a>
</span><span class=lnt id=hl-23-20><a class=lnlinks href=#hl-23-20>20</a>
</span><span class=lnt id=hl-23-21><a class=lnlinks href=#hl-23-21>21</a>
</span><span class=lnt id=hl-23-22><a class=lnlinks href=#hl-23-22>22</a>
</span><span class=lnt id=hl-23-23><a class=lnlinks href=#hl-23-23>23</a>
</span><span class=lnt id=hl-23-24><a class=lnlinks href=#hl-23-24>24</a>
</span><span class=lnt id=hl-23-25><a class=lnlinks href=#hl-23-25>25</a>
</span><span class=lnt id=hl-23-26><a class=lnlinks href=#hl-23-26>26</a>
</span><span class=lnt id=hl-23-27><a class=lnlinks href=#hl-23-27>27</a>
</span><span class=lnt id=hl-23-28><a class=lnlinks href=#hl-23-28>28</a>
</span><span class=lnt id=hl-23-29><a class=lnlinks href=#hl-23-29>29</a>
</span><span class=lnt id=hl-23-30><a class=lnlinks href=#hl-23-30>30</a>
</span><span class=lnt id=hl-23-31><a class=lnlinks href=#hl-23-31>31</a>
</span><span class=lnt id=hl-23-32><a class=lnlinks href=#hl-23-32>32</a>
</span><span class=lnt id=hl-23-33><a class=lnlinks href=#hl-23-33>33</a>
</span><span class=lnt id=hl-23-34><a class=lnlinks href=#hl-23-34>34</a>
</span><span class=lnt id=hl-23-35><a class=lnlinks href=#hl-23-35>35</a>
</span><span class=lnt id=hl-23-36><a class=lnlinks href=#hl-23-36>36</a>
</span><span class=lnt id=hl-23-37><a class=lnlinks href=#hl-23-37>37</a>
</span><span class=lnt id=hl-23-38><a class=lnlinks href=#hl-23-38>38</a>
</span><span class=lnt id=hl-23-39><a class=lnlinks href=#hl-23-39>39</a>
</span><span class=lnt id=hl-23-40><a class=lnlinks href=#hl-23-40>40</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># mac_firewall.py - MAC 주소 기반 방화벽 관리</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MACFirewall</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>config_file</span><span class=o>=</span><span class=s2>&#34;mac_policy.json&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>config_file</span> <span class=o>=</span> <span class=n>config_file</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>setup_logging</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>load_config</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>setup_logging</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;로깅 설정&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> - </span><span class=si>%(levelname)s</span><span class=s1> - </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>handlers</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=n>logging</span><span class=o>.</span><span class=n>FileHandler</span><span class=p>(</span><span class=s1>&#39;mac_firewall.log&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=n>logging</span><span class=o>.</span><span class=n>StreamHandler</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>load_config</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;설정 파일에서 MAC 주소 정책 로드&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>config_file</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>config</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>whitelist</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;whitelist&#39;</span><span class=p>,</span> <span class=p>[])</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>blacklist</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;blacklist&#39;</span><span class=p>,</span> <span class=p>[])</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>default_policy</span> <span class=o>=</span> <span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;default_policy&#39;</span><span class=p>,</span> <span class=s1>&#39;ACCEPT&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;설정 로드 완료: 화이트리스트 </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>whitelist</span><span class=p>)</span><span class=si>}</span><span class=s2>개, &#34;</span>
</span></span><span class=line><span class=cl>                                <span class=sa>f</span><span class=s2>&#34;블랙리스트 </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>blacklist</span><span class=p>)</span><span class=si>}</span><span class=s2>개&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>FileNotFoundError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>whitelist</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>blacklist</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>default_policy</span> <span class=o>=</span> <span class=s1>&#39;ACCEPT&#39;</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>save_config</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;새 설정 파일 생성됨&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>2 단계: iptables 규칙 관리</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1> 1</a>
</span><span class=lnt id=hl-24-2><a class=lnlinks href=#hl-24-2> 2</a>
</span><span class=lnt id=hl-24-3><a class=lnlinks href=#hl-24-3> 3</a>
</span><span class=lnt id=hl-24-4><a class=lnlinks href=#hl-24-4> 4</a>
</span><span class=lnt id=hl-24-5><a class=lnlinks href=#hl-24-5> 5</a>
</span><span class=lnt id=hl-24-6><a class=lnlinks href=#hl-24-6> 6</a>
</span><span class=lnt id=hl-24-7><a class=lnlinks href=#hl-24-7> 7</a>
</span><span class=lnt id=hl-24-8><a class=lnlinks href=#hl-24-8> 8</a>
</span><span class=lnt id=hl-24-9><a class=lnlinks href=#hl-24-9> 9</a>
</span><span class=lnt id=hl-24-10><a class=lnlinks href=#hl-24-10>10</a>
</span><span class=lnt id=hl-24-11><a class=lnlinks href=#hl-24-11>11</a>
</span><span class=lnt id=hl-24-12><a class=lnlinks href=#hl-24-12>12</a>
</span><span class=lnt id=hl-24-13><a class=lnlinks href=#hl-24-13>13</a>
</span><span class=lnt id=hl-24-14><a class=lnlinks href=#hl-24-14>14</a>
</span><span class=lnt id=hl-24-15><a class=lnlinks href=#hl-24-15>15</a>
</span><span class=lnt id=hl-24-16><a class=lnlinks href=#hl-24-16>16</a>
</span><span class=lnt id=hl-24-17><a class=lnlinks href=#hl-24-17>17</a>
</span><span class=lnt id=hl-24-18><a class=lnlinks href=#hl-24-18>18</a>
</span><span class=lnt id=hl-24-19><a class=lnlinks href=#hl-24-19>19</a>
</span><span class=lnt id=hl-24-20><a class=lnlinks href=#hl-24-20>20</a>
</span><span class=lnt id=hl-24-21><a class=lnlinks href=#hl-24-21>21</a>
</span><span class=lnt id=hl-24-22><a class=lnlinks href=#hl-24-22>22</a>
</span><span class=lnt id=hl-24-23><a class=lnlinks href=#hl-24-23>23</a>
</span><span class=lnt id=hl-24-24><a class=lnlinks href=#hl-24-24>24</a>
</span><span class=lnt id=hl-24-25><a class=lnlinks href=#hl-24-25>25</a>
</span><span class=lnt id=hl-24-26><a class=lnlinks href=#hl-24-26>26</a>
</span><span class=lnt id=hl-24-27><a class=lnlinks href=#hl-24-27>27</a>
</span><span class=lnt id=hl-24-28><a class=lnlinks href=#hl-24-28>28</a>
</span><span class=lnt id=hl-24-29><a class=lnlinks href=#hl-24-29>29</a>
</span><span class=lnt id=hl-24-30><a class=lnlinks href=#hl-24-30>30</a>
</span><span class=lnt id=hl-24-31><a class=lnlinks href=#hl-24-31>31</a>
</span><span class=lnt id=hl-24-32><a class=lnlinks href=#hl-24-32>32</a>
</span><span class=lnt id=hl-24-33><a class=lnlinks href=#hl-24-33>33</a>
</span><span class=lnt id=hl-24-34><a class=lnlinks href=#hl-24-34>34</a>
</span><span class=lnt id=hl-24-35><a class=lnlinks href=#hl-24-35>35</a>
</span><span class=lnt id=hl-24-36><a class=lnlinks href=#hl-24-36>36</a>
</span><span class=lnt id=hl-24-37><a class=lnlinks href=#hl-24-37>37</a>
</span><span class=lnt id=hl-24-38><a class=lnlinks href=#hl-24-38>38</a>
</span><span class=lnt id=hl-24-39><a class=lnlinks href=#hl-24-39>39</a>
</span><span class=lnt id=hl-24-40><a class=lnlinks href=#hl-24-40>40</a>
</span><span class=lnt id=hl-24-41><a class=lnlinks href=#hl-24-41>41</a>
</span><span class=lnt id=hl-24-42><a class=lnlinks href=#hl-24-42>42</a>
</span><span class=lnt id=hl-24-43><a class=lnlinks href=#hl-24-43>43</a>
</span><span class=lnt id=hl-24-44><a class=lnlinks href=#hl-24-44>44</a>
</span><span class=lnt id=hl-24-45><a class=lnlinks href=#hl-24-45>45</a>
</span><span class=lnt id=hl-24-46><a class=lnlinks href=#hl-24-46>46</a>
</span><span class=lnt id=hl-24-47><a class=lnlinks href=#hl-24-47>47</a>
</span><span class=lnt id=hl-24-48><a class=lnlinks href=#hl-24-48>48</a>
</span><span class=lnt id=hl-24-49><a class=lnlinks href=#hl-24-49>49</a>
</span><span class=lnt id=hl-24-50><a class=lnlinks href=#hl-24-50>50</a>
</span><span class=lnt id=hl-24-51><a class=lnlinks href=#hl-24-51>51</a>
</span><span class=lnt id=hl-24-52><a class=lnlinks href=#hl-24-52>52</a>
</span><span class=lnt id=hl-24-53><a class=lnlinks href=#hl-24-53>53</a>
</span><span class=lnt id=hl-24-54><a class=lnlinks href=#hl-24-54>54</a>
</span><span class=lnt id=hl-24-55><a class=lnlinks href=#hl-24-55>55</a>
</span><span class=lnt id=hl-24-56><a class=lnlinks href=#hl-24-56>56</a>
</span><span class=lnt id=hl-24-57><a class=lnlinks href=#hl-24-57>57</a>
</span><span class=lnt id=hl-24-58><a class=lnlinks href=#hl-24-58>58</a>
</span><span class=lnt id=hl-24-59><a class=lnlinks href=#hl-24-59>59</a>
</span><span class=lnt id=hl-24-60><a class=lnlinks href=#hl-24-60>60</a>
</span><span class=lnt id=hl-24-61><a class=lnlinks href=#hl-24-61>61</a>
</span><span class=lnt id=hl-24-62><a class=lnlinks href=#hl-24-62>62</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>run_command</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>command</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;시스템 명령어 실행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>command</span><span class=p>,</span> <span class=n>shell</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                                  <span class=n>capture_output</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>text</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>check</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>CalledProcessError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;명령어 실행 실패: </span><span class=si>{</span><span class=n>command</span><span class=si>}</span><span class=s2>, 오류: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_mac_rule</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>mac_address</span><span class=p>,</span> <span class=n>action</span><span class=o>=</span><span class=s1>&#39;DROP&#39;</span><span class=p>,</span> <span class=n>chain</span><span class=o>=</span><span class=s1>&#39;INPUT&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;특정 MAC 주소에 대한 iptables 규칙 추가&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># MAC 주소 형식 검증</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>validate_mac</span><span class=p>(</span><span class=n>mac_address</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;잘못된 MAC 주소 형식: </span><span class=si>{</span><span class=n>mac_address</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># iptables 규칙 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>command</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;iptables -A </span><span class=si>{</span><span class=n>chain</span><span class=si>}</span><span class=s2> -m mac --mac-source </span><span class=si>{</span><span class=n>mac_address</span><span class=si>}</span><span class=s2> -j </span><span class=si>{</span><span class=n>action</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>run_command</span><span class=p>(</span><span class=n>command</span><span class=p>)</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;MAC 규칙 추가됨: </span><span class=si>{</span><span class=n>mac_address</span><span class=si>}</span><span class=s2> -&gt; </span><span class=si>{</span><span class=n>action</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>remove_mac_rule</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>mac_address</span><span class=p>,</span> <span class=n>action</span><span class=o>=</span><span class=s1>&#39;DROP&#39;</span><span class=p>,</span> <span class=n>chain</span><span class=o>=</span><span class=s1>&#39;INPUT&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;특정 MAC 주소에 대한 iptables 규칙 제거&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>command</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;iptables -D </span><span class=si>{</span><span class=n>chain</span><span class=si>}</span><span class=s2> -m mac --mac-source </span><span class=si>{</span><span class=n>mac_address</span><span class=si>}</span><span class=s2> -j </span><span class=si>{</span><span class=n>action</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>run_command</span><span class=p>(</span><span class=n>command</span><span class=p>)</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;MAC 규칙 제거됨: </span><span class=si>{</span><span class=n>mac_address</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>apply_policies</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;화이트리스트/블랙리스트 정책 적용&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;MAC 주소 정책 적용 시작&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 기존 MAC 관련 규칙 정리</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>run_command</span><span class=p>(</span><span class=s2>&#34;iptables -F MAC_FILTER 2&gt;/dev/null || true&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>run_command</span><span class=p>(</span><span class=s2>&#34;iptables -X MAC_FILTER 2&gt;/dev/null || true&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 새 체인 생성</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>run_command</span><span class=p>(</span><span class=s2>&#34;iptables -N MAC_FILTER&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 블랙리스트 적용 (차단)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>mac</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>blacklist</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>run_command</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;iptables -A MAC_FILTER -m mac --mac-source </span><span class=si>{</span><span class=n>mac</span><span class=si>}</span><span class=s2> -j DROP&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;블랙리스트 적용: </span><span class=si>{</span><span class=n>mac</span><span class=si>}</span><span class=s2> 차단&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 화이트리스트 적용 (허용)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>mac</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>whitelist</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>run_command</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;iptables -A MAC_FILTER -m mac --mac-source </span><span class=si>{</span><span class=n>mac</span><span class=si>}</span><span class=s2> -j ACCEPT&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;화이트리스트 적용: </span><span class=si>{</span><span class=n>mac</span><span class=si>}</span><span class=s2> 허용&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 기본 정책 적용</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>run_command</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;iptables -A MAC_FILTER -j </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>default_policy</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># INPUT 체인에 MAC_FILTER 연결</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>run_command</span><span class=p>(</span><span class=s2>&#34;iptables -I INPUT -j MAC_FILTER&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;MAC 주소 정책 적용 완료&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>3 단계: 실시간 모니터링 및 관리</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1> 1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2> 2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3> 3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4> 4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5> 5</a>
</span><span class=lnt id=hl-25-6><a class=lnlinks href=#hl-25-6> 6</a>
</span><span class=lnt id=hl-25-7><a class=lnlinks href=#hl-25-7> 7</a>
</span><span class=lnt id=hl-25-8><a class=lnlinks href=#hl-25-8> 8</a>
</span><span class=lnt id=hl-25-9><a class=lnlinks href=#hl-25-9> 9</a>
</span><span class=lnt id=hl-25-10><a class=lnlinks href=#hl-25-10>10</a>
</span><span class=lnt id=hl-25-11><a class=lnlinks href=#hl-25-11>11</a>
</span><span class=lnt id=hl-25-12><a class=lnlinks href=#hl-25-12>12</a>
</span><span class=lnt id=hl-25-13><a class=lnlinks href=#hl-25-13>13</a>
</span><span class=lnt id=hl-25-14><a class=lnlinks href=#hl-25-14>14</a>
</span><span class=lnt id=hl-25-15><a class=lnlinks href=#hl-25-15>15</a>
</span><span class=lnt id=hl-25-16><a class=lnlinks href=#hl-25-16>16</a>
</span><span class=lnt id=hl-25-17><a class=lnlinks href=#hl-25-17>17</a>
</span><span class=lnt id=hl-25-18><a class=lnlinks href=#hl-25-18>18</a>
</span><span class=lnt id=hl-25-19><a class=lnlinks href=#hl-25-19>19</a>
</span><span class=lnt id=hl-25-20><a class=lnlinks href=#hl-25-20>20</a>
</span><span class=lnt id=hl-25-21><a class=lnlinks href=#hl-25-21>21</a>
</span><span class=lnt id=hl-25-22><a class=lnlinks href=#hl-25-22>22</a>
</span><span class=lnt id=hl-25-23><a class=lnlinks href=#hl-25-23>23</a>
</span><span class=lnt id=hl-25-24><a class=lnlinks href=#hl-25-24>24</a>
</span><span class=lnt id=hl-25-25><a class=lnlinks href=#hl-25-25>25</a>
</span><span class=lnt id=hl-25-26><a class=lnlinks href=#hl-25-26>26</a>
</span><span class=lnt id=hl-25-27><a class=lnlinks href=#hl-25-27>27</a>
</span><span class=lnt id=hl-25-28><a class=lnlinks href=#hl-25-28>28</a>
</span><span class=lnt id=hl-25-29><a class=lnlinks href=#hl-25-29>29</a>
</span><span class=lnt id=hl-25-30><a class=lnlinks href=#hl-25-30>30</a>
</span><span class=lnt id=hl-25-31><a class=lnlinks href=#hl-25-31>31</a>
</span><span class=lnt id=hl-25-32><a class=lnlinks href=#hl-25-32>32</a>
</span><span class=lnt id=hl-25-33><a class=lnlinks href=#hl-25-33>33</a>
</span><span class=lnt id=hl-25-34><a class=lnlinks href=#hl-25-34>34</a>
</span><span class=lnt id=hl-25-35><a class=lnlinks href=#hl-25-35>35</a>
</span><span class=lnt id=hl-25-36><a class=lnlinks href=#hl-25-36>36</a>
</span><span class=lnt id=hl-25-37><a class=lnlinks href=#hl-25-37>37</a>
</span><span class=lnt id=hl-25-38><a class=lnlinks href=#hl-25-38>38</a>
</span><span class=lnt id=hl-25-39><a class=lnlinks href=#hl-25-39>39</a>
</span><span class=lnt id=hl-25-40><a class=lnlinks href=#hl-25-40>40</a>
</span><span class=lnt id=hl-25-41><a class=lnlinks href=#hl-25-41>41</a>
</span><span class=lnt id=hl-25-42><a class=lnlinks href=#hl-25-42>42</a>
</span><span class=lnt id=hl-25-43><a class=lnlinks href=#hl-25-43>43</a>
</span><span class=lnt id=hl-25-44><a class=lnlinks href=#hl-25-44>44</a>
</span><span class=lnt id=hl-25-45><a class=lnlinks href=#hl-25-45>45</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>monitor_connections</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;실시간 연결 모니터링&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;네트워크 연결 모니터링 시작&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># ARP 테이블에서 활성 연결 확인</span>
</span></span><span class=line><span class=cl>        <span class=n>arp_output</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>run_command</span><span class=p>(</span><span class=s2>&#34;arp -a&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>arp_output</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>arp_output</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=c1># ARP 항목 파싱 (예: &#34;192.168.1.100 (192.168.1.100) at aa:bb:cc:dd:ee:ff [ether] on eth0&#34;)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=s1>&#39;at&#39;</span> <span class=ow>in</span> <span class=n>line</span> <span class=ow>and</span> <span class=s1>&#39;[ether]&#39;</span> <span class=ow>in</span> <span class=n>line</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>parts</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>ip</span> <span class=o>=</span> <span class=n>parts</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>strip</span><span class=p>(</span><span class=s1>&#39;()&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=n>mac</span> <span class=o>=</span> <span class=n>parts</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                        <span class=bp>self</span><span class=o>.</span><span class=n>check_mac_policy</span><span class=p>(</span><span class=n>ip</span><span class=p>,</span> <span class=n>mac</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>check_mac_policy</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ip</span><span class=p>,</span> <span class=n>mac</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;특정 MAC 주소의 정책 준수 확인&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>mac</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>blacklist</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;블랙리스트 MAC 감지: </span><span class=si>{</span><span class=n>mac</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>ip</span><span class=si>}</span><span class=s2>) - 차단 필요&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>mac</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>whitelist</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;화이트리스트 MAC 확인: </span><span class=si>{</span><span class=n>mac</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>ip</span><span class=si>}</span><span class=s2>) - 허용&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;알 수 없는 MAC: </span><span class=si>{</span><span class=n>mac</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>ip</span><span class=si>}</span><span class=s2>) - 기본 정책 적용&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>default_policy</span> <span class=o>==</span> <span class=s1>&#39;ACCEPT&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_to_whitelist</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>mac_address</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;화이트리스트에 MAC 주소 추가&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>mac_address</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>whitelist</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>whitelist</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>mac_address</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>save_config</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;화이트리스트 추가: </span><span class=si>{</span><span class=n>mac_address</span><span class=si>}</span><span class=s2> - </span><span class=si>{</span><span class=n>description</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_to_blacklist</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>mac_address</span><span class=p>,</span> <span class=n>description</span><span class=o>=</span><span class=s2>&#34;&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;블랙리스트에 MAC 주소 추가&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>mac_address</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>blacklist</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>blacklist</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>mac_address</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>save_config</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;블랙리스트 추가: </span><span class=si>{</span><span class=n>mac_address</span><span class=si>}</span><span class=s2> - </span><span class=si>{</span><span class=n>description</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h6 id=실행-결과-2>실행 결과<a hidden class=anchor aria-hidden=true href=#실행-결과-2>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-26-1><a class=lnlinks href=#hl-26-1> 1</a>
</span><span class=lnt id=hl-26-2><a class=lnlinks href=#hl-26-2> 2</a>
</span><span class=lnt id=hl-26-3><a class=lnlinks href=#hl-26-3> 3</a>
</span><span class=lnt id=hl-26-4><a class=lnlinks href=#hl-26-4> 4</a>
</span><span class=lnt id=hl-26-5><a class=lnlinks href=#hl-26-5> 5</a>
</span><span class=lnt id=hl-26-6><a class=lnlinks href=#hl-26-6> 6</a>
</span><span class=lnt id=hl-26-7><a class=lnlinks href=#hl-26-7> 7</a>
</span><span class=lnt id=hl-26-8><a class=lnlinks href=#hl-26-8> 8</a>
</span><span class=lnt id=hl-26-9><a class=lnlinks href=#hl-26-9> 9</a>
</span><span class=lnt id=hl-26-10><a class=lnlinks href=#hl-26-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 방화벽 관리자 실행</span>
</span></span><span class=line><span class=cl>sudo python mac_firewall.py
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 예상 로그 출력</span>
</span></span><span class=line><span class=cl>2024-09-05 14:30:15 - INFO - 설정 로드 완료: 화이트리스트 5개, 블랙리스트 2개
</span></span><span class=line><span class=cl>2024-09-05 14:30:16 - INFO - MAC 주소 정책 적용 시작
</span></span><span class=line><span class=cl>2024-09-05 14:30:16 - INFO - 블랙리스트 적용: 00:11:22:33:44:55 차단
</span></span><span class=line><span class=cl>2024-09-05 14:30:16 - INFO - 화이트리스트 적용: aa:bb:cc:dd:ee:ff 허용
</span></span><span class=line><span class=cl>2024-09-05 14:30:16 - INFO - MAC 주소 정책 적용 완료
</span></span><span class=line><span class=cl>2024-09-05 14:30:17 - INFO - 네트워크 연결 모니터링 시작
</span></span></code></pre></td></tr></table></div></div><h6 id=추가-실험-2>추가 실험<a hidden class=anchor aria-hidden=true href=#추가-실험-2>#</a></h6><ul><li>실시간 침입 탐지 시스템 연동</li><li>MAC 주소 스푸핑 감지 알고리즘</li><li>동적 화이트리스트 관리 (시간 기반)</li></ul><h4 id=실제-도입-사례-분석>실제 도입 사례 분석<a hidden class=anchor aria-hidden=true href=#실제-도입-사례-분석>#</a></h4><h5 id=실제-도입-사례-대학교-캠퍼스-네트워크-관리-시스템>실제 도입 사례: 대학교 캠퍼스 네트워크 관리 시스템<a hidden class=anchor aria-hidden=true href=#실제-도입-사례-대학교-캠퍼스-네트워크-관리-시스템>#</a></h5><h6 id=배경-및-도입-이유>배경 및 도입 이유<a hidden class=anchor aria-hidden=true href=#배경-및-도입-이유>#</a></h6><p>모 대학교에서는 3 만여 명의 학생과 교직원이 사용하는 캠퍼스 네트워크에서 무단 접속과 네트워크 남용 문제가 심각했다. 기존 IP 기반 관리로는 동적 할당과 우회 접속으로 인한 한계가 있어, MAC 주소 기반의 종합적인 네트워크 관리 시스템 도입을 결정했다.</p><h6 id=구현-아키텍처>구현 아키텍처<a hidden class=anchor aria-hidden=true href=#구현-아키텍처>#</a></h6><pre class=mermaid>graph TB
    subgraph &#34;사용자 디바이스&#34;
        A1[학생 노트북]
        A2[교직원 PC]
        A3[모바일 디바이스]
        A4[IoT 디바이스]
    end
    
    subgraph &#34;네트워크 인프라&#34;
        B1[무선 AP&lt;br/&gt;MAC 인증]
        B2[스위치&lt;br/&gt;포트 보안]
        B3[라우터&lt;br/&gt;VLAN 분리]
    end
    
    subgraph &#34;인증 시스템&#34;
        C1[RADIUS 서버&lt;br/&gt;802.1X 인증]
        C2[MAC 주소 DB&lt;br/&gt;사용자 매핑]
        C3[LDAP 연동&lt;br/&gt;신원 확인]
    end
    
    subgraph &#34;관리 시스템&#34;
        D1[네트워크 관리&lt;br/&gt;시스템 NMS]
        D2[보안 모니터링&lt;br/&gt;SIEM]
        D3[자산 관리&lt;br/&gt;시스템]
    end
    
    subgraph &#34;정책 엔진&#34;
        E1[접근 제어&lt;br/&gt;ACL 관리]
        E2[대역폭 제어&lt;br/&gt;QoS 정책]
        E3[시간 기반&lt;br/&gt;접근 제어]
    end
    
    A1 --&gt; B1
    A2 --&gt; B2
    A3 --&gt; B1
    A4 --&gt; B2
    
    B1 --&gt; C1
    B2 --&gt; C1
    B3 --&gt; C1
    
    C1 --&gt; C2
    C2 --&gt; C3
    
    C1 --&gt; D1
    D1 --&gt; D2
    D2 --&gt; D3
    
    C1 --&gt; E1
    E1 --&gt; E2
    E2 --&gt; E3
    
    E1 --&gt; B1
    E1 --&gt; B2
    E1 --&gt; B3
</pre><p><strong>MAC 주소 기반 정책 플로우:</strong></p><pre class=mermaid>sequenceDiagram
    participant U as 사용자 디바이스
    participant AP as 무선 AP
    participant R as RADIUS 서버
    participant DB as MAC DB
    participant P as 정책 엔진
    
    U-&gt;&gt;AP: 연결 요청 (MAC: aa:bb:cc:dd:ee:ff)
    AP-&gt;&gt;R: 인증 요청 (MAC 포함)
    R-&gt;&gt;DB: MAC 주소 조회
    
    alt 등록된 MAC
        DB-&gt;&gt;R: 사용자 정보 + 권한
        R-&gt;&gt;P: 정책 조회 요청
        P-&gt;&gt;R: 접근 정책 (VLAN, 대역폭, 시간)
        R-&gt;&gt;AP: 인증 성공 + 정책
        AP-&gt;&gt;U: 네트워크 접근 허용
    else 미등록 MAC
        DB-&gt;&gt;R: MAC 없음
        R-&gt;&gt;AP: 인증 실패
        AP-&gt;&gt;U: 게스트 포털로 리다이렉트
    end
</pre><h6 id=핵심-구현-코드>핵심 구현 코드<a hidden class=anchor aria-hidden=true href=#핵심-구현-코드>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-29-1><a class=lnlinks href=#hl-29-1> 1</a>
</span><span class=lnt id=hl-29-2><a class=lnlinks href=#hl-29-2> 2</a>
</span><span class=lnt id=hl-29-3><a class=lnlinks href=#hl-29-3> 3</a>
</span><span class=lnt id=hl-29-4><a class=lnlinks href=#hl-29-4> 4</a>
</span><span class=lnt id=hl-29-5><a class=lnlinks href=#hl-29-5> 5</a>
</span><span class=lnt id=hl-29-6><a class=lnlinks href=#hl-29-6> 6</a>
</span><span class=lnt id=hl-29-7><a class=lnlinks href=#hl-29-7> 7</a>
</span><span class=lnt id=hl-29-8><a class=lnlinks href=#hl-29-8> 8</a>
</span><span class=lnt id=hl-29-9><a class=lnlinks href=#hl-29-9> 9</a>
</span><span class=lnt id=hl-29-10><a class=lnlinks href=#hl-29-10>10</a>
</span><span class=lnt id=hl-29-11><a class=lnlinks href=#hl-29-11>11</a>
</span><span class=lnt id=hl-29-12><a class=lnlinks href=#hl-29-12>12</a>
</span><span class=lnt id=hl-29-13><a class=lnlinks href=#hl-29-13>13</a>
</span><span class=lnt id=hl-29-14><a class=lnlinks href=#hl-29-14>14</a>
</span><span class=lnt id=hl-29-15><a class=lnlinks href=#hl-29-15>15</a>
</span><span class=lnt id=hl-29-16><a class=lnlinks href=#hl-29-16>16</a>
</span><span class=lnt id=hl-29-17><a class=lnlinks href=#hl-29-17>17</a>
</span><span class=lnt id=hl-29-18><a class=lnlinks href=#hl-29-18>18</a>
</span><span class=lnt id=hl-29-19><a class=lnlinks href=#hl-29-19>19</a>
</span><span class=lnt id=hl-29-20><a class=lnlinks href=#hl-29-20>20</a>
</span><span class=lnt id=hl-29-21><a class=lnlinks href=#hl-29-21>21</a>
</span><span class=lnt id=hl-29-22><a class=lnlinks href=#hl-29-22>22</a>
</span><span class=lnt id=hl-29-23><a class=lnlinks href=#hl-29-23>23</a>
</span><span class=lnt id=hl-29-24><a class=lnlinks href=#hl-29-24>24</a>
</span><span class=lnt id=hl-29-25><a class=lnlinks href=#hl-29-25>25</a>
</span><span class=lnt id=hl-29-26><a class=lnlinks href=#hl-29-26>26</a>
</span><span class=lnt id=hl-29-27><a class=lnlinks href=#hl-29-27>27</a>
</span><span class=lnt id=hl-29-28><a class=lnlinks href=#hl-29-28>28</a>
</span><span class=lnt id=hl-29-29><a class=lnlinks href=#hl-29-29>29</a>
</span><span class=lnt id=hl-29-30><a class=lnlinks href=#hl-29-30>30</a>
</span><span class=lnt id=hl-29-31><a class=lnlinks href=#hl-29-31>31</a>
</span><span class=lnt id=hl-29-32><a class=lnlinks href=#hl-29-32>32</a>
</span><span class=lnt id=hl-29-33><a class=lnlinks href=#hl-29-33>33</a>
</span><span class=lnt id=hl-29-34><a class=lnlinks href=#hl-29-34>34</a>
</span><span class=lnt id=hl-29-35><a class=lnlinks href=#hl-29-35>35</a>
</span><span class=lnt id=hl-29-36><a class=lnlinks href=#hl-29-36>36</a>
</span><span class=lnt id=hl-29-37><a class=lnlinks href=#hl-29-37>37</a>
</span><span class=lnt id=hl-29-38><a class=lnlinks href=#hl-29-38>38</a>
</span><span class=lnt id=hl-29-39><a class=lnlinks href=#hl-29-39>39</a>
</span><span class=lnt id=hl-29-40><a class=lnlinks href=#hl-29-40>40</a>
</span><span class=lnt id=hl-29-41><a class=lnlinks href=#hl-29-41>41</a>
</span><span class=lnt id=hl-29-42><a class=lnlinks href=#hl-29-42>42</a>
</span><span class=lnt id=hl-29-43><a class=lnlinks href=#hl-29-43>43</a>
</span><span class=lnt id=hl-29-44><a class=lnlinks href=#hl-29-44>44</a>
</span><span class=lnt id=hl-29-45><a class=lnlinks href=#hl-29-45>45</a>
</span><span class=lnt id=hl-29-46><a class=lnlinks href=#hl-29-46>46</a>
</span><span class=lnt id=hl-29-47><a class=lnlinks href=#hl-29-47>47</a>
</span><span class=lnt id=hl-29-48><a class=lnlinks href=#hl-29-48>48</a>
</span><span class=lnt id=hl-29-49><a class=lnlinks href=#hl-29-49>49</a>
</span><span class=lnt id=hl-29-50><a class=lnlinks href=#hl-29-50>50</a>
</span><span class=lnt id=hl-29-51><a class=lnlinks href=#hl-29-51>51</a>
</span><span class=lnt id=hl-29-52><a class=lnlinks href=#hl-29-52>52</a>
</span><span class=lnt id=hl-29-53><a class=lnlinks href=#hl-29-53>53</a>
</span><span class=lnt id=hl-29-54><a class=lnlinks href=#hl-29-54>54</a>
</span><span class=lnt id=hl-29-55><a class=lnlinks href=#hl-29-55>55</a>
</span><span class=lnt id=hl-29-56><a class=lnlinks href=#hl-29-56>56</a>
</span><span class=lnt id=hl-29-57><a class=lnlinks href=#hl-29-57>57</a>
</span><span class=lnt id=hl-29-58><a class=lnlinks href=#hl-29-58>58</a>
</span><span class=lnt id=hl-29-59><a class=lnlinks href=#hl-29-59>59</a>
</span><span class=lnt id=hl-29-60><a class=lnlinks href=#hl-29-60>60</a>
</span><span class=lnt id=hl-29-61><a class=lnlinks href=#hl-29-61>61</a>
</span><span class=lnt id=hl-29-62><a class=lnlinks href=#hl-29-62>62</a>
</span><span class=lnt id=hl-29-63><a class=lnlinks href=#hl-29-63>63</a>
</span><span class=lnt id=hl-29-64><a class=lnlinks href=#hl-29-64>64</a>
</span><span class=lnt id=hl-29-65><a class=lnlinks href=#hl-29-65>65</a>
</span><span class=lnt id=hl-29-66><a class=lnlinks href=#hl-29-66>66</a>
</span><span class=lnt id=hl-29-67><a class=lnlinks href=#hl-29-67>67</a>
</span><span class=lnt id=hl-29-68><a class=lnlinks href=#hl-29-68>68</a>
</span><span class=lnt id=hl-29-69><a class=lnlinks href=#hl-29-69>69</a>
</span><span class=lnt id=hl-29-70><a class=lnlinks href=#hl-29-70>70</a>
</span><span class=lnt id=hl-29-71><a class=lnlinks href=#hl-29-71>71</a>
</span><span class=lnt id=hl-29-72><a class=lnlinks href=#hl-29-72>72</a>
</span><span class=lnt id=hl-29-73><a class=lnlinks href=#hl-29-73>73</a>
</span><span class=lnt id=hl-29-74><a class=lnlinks href=#hl-29-74>74</a>
</span><span class=lnt id=hl-29-75><a class=lnlinks href=#hl-29-75>75</a>
</span><span class=lnt id=hl-29-76><a class=lnlinks href=#hl-29-76>76</a>
</span><span class=lnt id=hl-29-77><a class=lnlinks href=#hl-29-77>77</a>
</span><span class=lnt id=hl-29-78><a class=lnlinks href=#hl-29-78>78</a>
</span><span class=lnt id=hl-29-79><a class=lnlinks href=#hl-29-79>79</a>
</span><span class=lnt id=hl-29-80><a class=lnlinks href=#hl-29-80>80</a>
</span><span class=lnt id=hl-29-81><a class=lnlinks href=#hl-29-81>81</a>
</span><span class=lnt id=hl-29-82><a class=lnlinks href=#hl-29-82>82</a>
</span><span class=lnt id=hl-29-83><a class=lnlinks href=#hl-29-83>83</a>
</span><span class=lnt id=hl-29-84><a class=lnlinks href=#hl-29-84>84</a>
</span><span class=lnt id=hl-29-85><a class=lnlinks href=#hl-29-85>85</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># campus_mac_manager.py - 캠퍼스 MAC 주소 관리 시스템</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CampusMACManager</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db_connection</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>connect_database</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>radius_client</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>setup_radius</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>register_device</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>,</span> <span class=n>mac_address</span><span class=p>,</span> <span class=n>device_type</span><span class=p>,</span> <span class=n>location</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;사용자 디바이스 MAC 주소 등록&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># MAC 주소 정규화 및 검증</span>
</span></span><span class=line><span class=cl>        <span class=n>normalized_mac</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>normalize_mac</span><span class=p>(</span><span class=n>mac_address</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>validate_mac</span><span class=p>(</span><span class=n>normalized_mac</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;잘못된 MAC 주소 형식&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 중복 등록 확인</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_mac_registered</span><span class=p>(</span><span class=n>normalized_mac</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;이미 등록된 MAC 주소&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 디바이스 정보 데이터베이스 저장</span>
</span></span><span class=line><span class=cl>        <span class=n>device_info</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;mac_address&#39;</span><span class=p>:</span> <span class=n>normalized_mac</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;device_type&#39;</span><span class=p>:</span> <span class=n>device_type</span><span class=p>,</span>  <span class=c1># laptop, mobile, tablet, etc.</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;location&#39;</span><span class=p>:</span> <span class=n>location</span><span class=p>,</span>        <span class=c1># 기숙사, 연구실, 강의실 등</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;registration_date&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;active&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;policy_group&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>determine_policy_group</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=n>device_type</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db_connection</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;INSERT INTO mac_registry (user_id, mac_address, device_type, location, policy_group) &#34;</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;VALUES (</span><span class=si>%(user_id)s</span><span class=s2>, </span><span class=si>%(mac_address)s</span><span class=s2>, </span><span class=si>%(device_type)s</span><span class=s2>, </span><span class=si>%(location)s</span><span class=s2>, </span><span class=si>%(policy_group)s</span><span class=s2>)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>device_info</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># RADIUS 서버 정책 업데이트</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>update_radius_policy</span><span class=p>(</span><span class=n>normalized_mac</span><span class=p>,</span> <span class=n>device_info</span><span class=p>[</span><span class=s1>&#39;policy_group&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>device_info</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>determine_policy_group</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>,</span> <span class=n>device_type</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;사용자 및 디바이스 유형에 따른 정책 그룹 결정&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>user_info</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_user_info</span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 정책 그룹 매트릭스</span>
</span></span><span class=line><span class=cl>        <span class=n>policy_matrix</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;student&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;laptop&#39;</span><span class=p>:</span> <span class=s1>&#39;student_unlimited&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;mobile&#39;</span><span class=p>:</span> <span class=s1>&#39;student_limited&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;tablet&#39;</span><span class=p>:</span> <span class=s1>&#39;student_limited&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;faculty&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;laptop&#39;</span><span class=p>:</span> <span class=s1>&#39;faculty_unlimited&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;mobile&#39;</span><span class=p>:</span> <span class=s1>&#39;faculty_standard&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;tablet&#39;</span><span class=p>:</span> <span class=s1>&#39;faculty_standard&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;staff&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;laptop&#39;</span><span class=p>:</span> <span class=s1>&#39;staff_business&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;mobile&#39;</span><span class=p>:</span> <span class=s1>&#39;staff_standard&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;tablet&#39;</span><span class=p>:</span> <span class=s1>&#39;staff_standard&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>policy_matrix</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>user_info</span><span class=p>[</span><span class=s1>&#39;role&#39;</span><span class=p>],</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>device_type</span><span class=p>,</span> <span class=s1>&#39;guest&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>monitor_network_usage</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;실시간 네트워크 사용량 모니터링&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># SNMP를 통한 스위치 MAC 테이블 수집</span>
</span></span><span class=line><span class=cl>        <span class=n>active_macs</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>collect_switch_mac_tables</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>mac_entry</span> <span class=ow>in</span> <span class=n>active_macs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mac_address</span> <span class=o>=</span> <span class=n>mac_entry</span><span class=p>[</span><span class=s1>&#39;mac&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>port</span> <span class=o>=</span> <span class=n>mac_entry</span><span class=p>[</span><span class=s1>&#39;port&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>vlan</span> <span class=o>=</span> <span class=n>mac_entry</span><span class=p>[</span><span class=s1>&#39;vlan&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 등록된 MAC인지 확인</span>
</span></span><span class=line><span class=cl>            <span class=n>device_info</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_device_info</span><span class=p>(</span><span class=n>mac_address</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>device_info</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># 정책 준수 확인</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>check_policy_compliance</span><span class=p>(</span><span class=n>device_info</span><span class=p>,</span> <span class=n>port</span><span class=p>,</span> <span class=n>vlan</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>log_policy_violation</span><span class=p>(</span><span class=n>device_info</span><span class=p>,</span> <span class=n>port</span><span class=p>,</span> <span class=n>vlan</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>apply_quarantine_policy</span><span class=p>(</span><span class=n>mac_address</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># 미등록 MAC 발견</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>log_unregistered_device</span><span class=p>(</span><span class=n>mac_address</span><span class=p>,</span> <span class=n>port</span><span class=p>,</span> <span class=n>vlan</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>notify_security_team</span><span class=p>(</span><span class=n>mac_address</span><span class=p>,</span> <span class=n>port</span><span class=p>,</span> <span class=n>vlan</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=성과-및-결과>성과 및 결과<a hidden class=anchor aria-hidden=true href=#성과-및-결과>#</a></h6><p><strong>정량적 성과:</strong></p><ul><li><strong>보안 사고 감소</strong>: 연간 네트워크 보안 사고 85% 감소</li><li><strong>불법 접속 차단</strong>: 월평균 1,200 건의 미인가 접속 시도 자동 차단</li><li><strong>네트워크 성능 향상</strong>: 대역폭 남용으로 인한 성능 저하 90% 개선</li><li><strong>관리 효율성</strong>: 네트워크 관리 인력 소요시간 60% 단축</li></ul><p><strong>정성적 개선:</strong></p><ul><li><strong>사용자 경험 향상</strong>: 자동 인증으로 인한 편의성 증대</li><li><strong>정책 일관성</strong>: 전 캠퍼스 통일된 네트워크 정책 적용</li><li><strong>문제 해결 속도</strong>: MAC 기반 추적으로 문제 해결 시간 단축</li></ul><h6 id=교훈-및-시사점>교훈 및 시사점<a hidden class=anchor aria-hidden=true href=#교훈-및-시사점>#</a></h6><ul><li>MAC 주소만으로는 완벽한 보안을 보장할 수 없어 802.1X 와 같은 추가 인증 계층 필요</li><li>사용자 교육과 정책 홍보가 성공적 도입의 핵심 요소</li><li>프라이버시 보호를 위한 MAC 주소 해싱 및 보관 정책 수립 중요</li></ul><h5 id=실제-도입-사례-기업-네트워크에서-mac-기반-인증접근제어-적용>실제 도입 사례: 기업 네트워크에서 MAC 기반 인증/접근제어 적용<a hidden class=anchor aria-hidden=true href=#실제-도입-사례-기업-네트워크에서-mac-기반-인증접근제어-적용>#</a></h5><h6 id=배경-및-도입-이유-1>배경 및 도입 이유<a hidden class=anchor aria-hidden=true href=#배경-및-도입-이유-1>#</a></h6><ul><li>보안 강화를 위해 모든 사내 PC, 프린터, IoT 장비에 MAC 등록 후 네트워크 접근 통제</li><li>네트워크 침입 및 불법 단말 접속 원천 차단, 관리 자동화 필요</li></ul><h6 id=구현-아키텍처-1>구현 아키텍처<a hidden class=anchor aria-hidden=true href=#구현-아키텍처-1>#</a></h6><pre class=mermaid>graph TB
    A[네트워크 사용자 PC] --&gt;|MAC 등록| B[스위치/Access Point]
    B --&gt; C[NAC 서버]
    C --&gt; D[인증/정책 DB]
</pre><ul><li>각 단말은 사전 등록된 MAC DB 와 네트워크 인증 과정에서 매칭됨</li><li>스위치/AP 는 실시간으로 MAC 기반 접근제어·정책 적용</li></ul><h6 id=핵심-구현-코드-1>핵심 구현 코드<a hidden class=anchor aria-hidden=true href=#핵심-구현-코드-1>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-31-1><a class=lnlinks href=#hl-31-1>1</a>
</span><span class=lnt id=hl-31-2><a class=lnlinks href=#hl-31-2>2</a>
</span><span class=lnt id=hl-31-3><a class=lnlinks href=#hl-31-3>3</a>
</span><span class=lnt id=hl-31-4><a class=lnlinks href=#hl-31-4>4</a>
</span><span class=lnt id=hl-31-5><a class=lnlinks href=#hl-31-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python으로 NAC 정책 서버와 연동해 단말 MAC 인증 예시</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>is_allowed_mac</span><span class=p>(</span><span class=n>mac</span><span class=p>,</span> <span class=n>db_mac_list</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>mac</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>in</span> <span class=p>[</span><span class=n>x</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>db_mac_list</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 네트워크 연결 시 이 함수로 MAC을 인증 서버 DB와 비교해 접근 권한 판단</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=성과-및-결과-1>성과 및 결과<a hidden class=anchor aria-hidden=true href=#성과-및-결과-1>#</a></h6><ul><li>불법 단말 유입률 90% 이상 감소</li><li>장애 추적, 자산관리 효율 약 50% 향상</li><li>정책 자동화로 운영비 절감</li></ul><h6 id=교훈-및-시사점-1>교훈 및 시사점<a hidden class=anchor aria-hidden=true href=#교훈-및-시사점-1>#</a></h6><ul><li>MAC 기반 인증의 한계 (스푸핑, NIC 교체 등) 대비 추가 인증 정책 (DHCP, 802.1X 등) 병행 필요</li><li>랜덤/회전 MAC 주소 시대에는 네트워크 관리 정책 변화 필요</li></ul><h4 id=mac-연계-설계-패턴-핵심-가이드>MAC 연계 설계 패턴 핵심 가이드<a hidden class=anchor aria-hidden=true href=#mac-연계-설계-패턴-핵심-가이드>#</a></h4><ul><li>**주소 정책은 DHCP(+Option 82)**로 " 어디의 누구인지 " 를 반영한다.</li><li><strong>보안은 엣지에서</strong>: <strong>DHCP Snooping–DAI–IPSG</strong>를 연쇄 적용해 위조를 원천 차단한다.</li><li><strong>대규모 확장은 EVPN/VXLAN</strong>: MAC/IP 를 제어평면으로 광고해 브로드캐스트를 줄이고 이동성을 보장한다.</li><li><strong>관측은 BRIDGE-MIB</strong>로 표준화해 어떤 MAC 이 어느 포트에 있는지 항상 볼 수 있게 한다.</li></ul><h5 id=주소정책-연계>주소/정책 연계<a hidden class=anchor aria-hidden=true href=#주소정책-연계>#</a></h5><table><thead><tr><th>통합 대상</th><th>왜 (문제/목표)</th><th>무엇 (데이터)</th><th>어떻게 (연계/구성)</th><th>가치</th></tr></thead><tbody><tr><td>DHCP 예약</td><td>역할별 고정 IP/정책</td><td>MAC↔IP 매핑</td><td>예약/클래스/스코프</td><td>예측가능 운영</td></tr><tr><td>DHCP Option 82</td><td>위치 기반 정책</td><td>회선/포트·릴레이 정보</td><td>릴레이가 Option 82 삽입, 서버 정책</td><td>위치·보안 강화</td></tr><tr><td>IPAM 연동</td><td>카탈로그·감사</td><td>MAC/IP/OUI</td><td>DHCP 로그→IPAM 동기화</td><td>장애 포렌식 속도↑</td></tr></tbody></table><p>Option 82 를 쓰면 " 어디의 단말인지 " 까지 반영한 <strong>정밀 주소정책</strong>이 가능하다.</p><h5 id=엣지-보안-체인>엣지 보안 체인<a hidden class=anchor aria-hidden=true href=#엣지-보안-체인>#</a></h5><table><thead><tr><th>통합 대상</th><th>왜</th><th>무엇</th><th>어떻게</th><th>가치</th></tr></thead><tbody><tr><td>DHCP Snooping</td><td>가짜 DHCP/바인딩 확보</td><td>MAC-IP- 포트</td><td>엣지 untrusted, 업링크 trusted</td><td>위조 선제 차단</td></tr><tr><td>DAI</td><td>ARP 스푸핑 방지</td><td>ARP↔바인딩 검증</td><td>Snooping 테이블 참조</td><td>MITM 차단</td></tr><tr><td>IP Source Guard</td><td>소스 IP 위조 방지</td><td>MAC/IP/포트</td><td>허용 소스만 통과</td><td>L3 위협 차단</td></tr><tr><td>802.1X</td><td>MAC 한계 보완</td><td>사용자/디바이스 ID</td><td>EAP-TLS/RADIUS·동적 VLAN</td><td>제로트러스트</td></tr></tbody></table><p><strong>Snooping→DAI→IPSG</strong>는 L2/L3 위조를 <strong>액세스 포트</strong>에서 끊는다.</p><h5 id=패브릭오버레이>패브릭/오버레이<a hidden class=anchor aria-hidden=true href=#패브릭오버레이>#</a></h5><table><thead><tr><th>통합 대상</th><th>왜</th><th>무엇</th><th>어떻게</th><th>가치</th></tr></thead><tbody><tr><td>VXLAN</td><td>L2 확장/분리</td><td>L2-over-L3(UDP)</td><td>VTEP 캡슐화</td><td>확장성·다중 테넌시</td></tr><tr><td>EVPN</td><td>제어평면·이동성</td><td>MAC/IP 라우트</td><td>BGP EVPN(RT-2 등)</td><td>ARP 억제·최적 경로</td></tr></tbody></table><p>VXLAN 이 <strong>운반</strong>, EVPN 이 <strong>알려줌</strong>(광고/수습) 으로 대규모를 안정화한다.</p><h5 id=관측운영>관측/운영<a hidden class=anchor aria-hidden=true href=#관측운영>#</a></h5><table><thead><tr><th>통합 대상</th><th>왜</th><th>무엇</th><th>어떻게</th><th>가치</th></tr></thead><tbody><tr><td>BRIDGE-MIB</td><td>위치·이동 추적</td><td>dot1dTpFdbAddress</td><td>NMS 폴링/트랩</td><td>인벤토리·보안 상관</td></tr><tr><td>SNMP+IPAM/NAC</td><td>상관·자동화</td><td>MAC/IP/사용자</td><td>주기 수집→동기화</td><td>온보딩·차단 자동화</td></tr></tbody></table><p><strong>표준 MIB</strong>로 MAC 위치를 읽어와 IPAM/NAC 와 맞물리면 <strong>가시성→행동</strong>까지 이어진다.</p><h3 id=운영-및-최적화>운영 및 최적화<a hidden class=anchor aria-hidden=true href=#운영-및-최적화>#</a></h3><h4 id=mac-기반-관측성-운영-가이드>MAC 기반 관측성 운영 가이드<a hidden class=anchor aria-hidden=true href=#mac-기반-관측성-운영-가이드>#</a></h4><p>MAC 기반 관측성은 스위치의 CAM/MAC 테이블과 관련 로그 (syslog, DHCP, RADIUS 등) 를 실시간으로 수집·상관시키는 활동으로, 장치 식별·이동 추적·보안 이상 탐지·성능 문제 조기발견을 목표로 한다.<br>수집은 SNMP(폴링/트랩) 와 syslog 를 기본으로 하고, 장비 지원 시 스트리밍 텔레메트리로 보완한다.<br>수집된 데이터를 중앙에 모아 대시보드로 시각화하고, 탐지 규칙과 자동화 플레이북으로 빠르게 대응하는 것이 운영 핵심이다.</p><h5 id=데이터-수집-수집-대상--방법--권장-설정>데이터 수집 (수집 대상 · 방법 · 권장 설정)<a hidden class=anchor aria-hidden=true href=#데이터-수집-수집-대상--방법--권장-설정>#</a></h5><table><thead><tr><th>수집 대상</th><th>수집 방법</th><th style=text-align:right>권장 주기/설정</th><th>비고</th></tr></thead><tbody><tr><td>스위치 MAC 테이블</td><td>SNMP 폴링 (dot1dTpFdbAddress/Port)</td><td style=text-align:right>소규모 30s / 대규모 300s (기본)</td><td>트래픽 급증시 스트리밍 권장</td></tr><tr><td>스위치 이벤트</td><td>SNMP Trap / syslog</td><td style=text-align:right>실시간 수집</td><td>플래핑·aged 메시지 활용</td></tr><tr><td>DHCP 로그</td><td>로그 수집 (syslog/API)</td><td style=text-align:right>실시간</td><td>MAC→IP 매핑 확보</td></tr><tr><td>RADIUS/802.1X 로그</td><td>로그 수집</td><td style=text-align:right>실시간</td><td>인증 기반 장치 매핑</td></tr><tr><td>NetFlow/sFlow</td><td>샘플링</td><td style=text-align:right>30s~5m 샘플</td><td>트래픽 발원지 확인</td></tr><tr><td>OUI DB</td><td>정기 동기화 (weekly)</td><td style=text-align:right>주간</td><td>제조사 분류 정확도 유지</td></tr></tbody></table><p>기본은 SNMP 폴링 + syslog/트랩의 조합. 대규모 환경에서는 폴링 빈도를 늘리고 스트리밍 텔레메트리로 보완. DHCP/RADIUS 로그 연동으로 MAC→IP→호스트 추적이 핵심이다.</p><h5 id=처리상관관계-처리-대상--목적--도구-예시>처리·상관관계 (처리 대상 · 목적 · 도구 예시)<a hidden class=anchor aria-hidden=true href=#처리상관관계-처리-대상--목적--도구-예시>#</a></h5><table><thead><tr><th>처리 대상</th><th>목적</th><th>구현 예시 (도구)</th></tr></thead><tbody><tr><td>MAC 레코드 집계</td><td>포트 이력/last_seen 유지</td><td>ELK / Timeseries DB</td></tr><tr><td>DHCP/DNS 병합</td><td>MAC→IP→호스트 매핑</td><td>Logstash / Fluentd / custom webhook</td></tr><tr><td>OUI 매칭</td><td>장비 제조사 분류</td><td>OUI DB + 스크립트</td></tr><tr><td>이상탐지 전처리</td><td>노이즈 제거·정상 패턴 학습</td><td>Spark / Python pipeline</td></tr><tr><td>유실·중복 보정</td><td>SNMP 지연 보정</td><td>타임윈도우 기반 집계</td></tr></tbody></table><p>데이터 처리 파이프라인은 로그·메트릭을 시간적으로 정렬하고, DHCP/DNS 와 연결하여 신뢰도 높은 자산 매핑을 만드는 것이 목표다.</p><h5 id=탐지-규칙-및-알림-메트릭--임계값-권장--대응>탐지 규칙 및 알림 (메트릭 · 임계값 (권장) · 대응)<a hidden class=anchor aria-hidden=true href=#탐지-규칙-및-알림-메트릭--임계값-권장--대응>#</a></h5><table><thead><tr><th>탐지 항목</th><th style=text-align:right>권장 임계값 (초기)</th><th style=text-align:right>우선도</th><th>자동 대응 예시</th></tr></thead><tbody><tr><td>CAM 사용률</td><td style=text-align:right>> 80%</td><td style=text-align:right>WARN</td><td>사례 수집, 용량 계획 알림</td></tr><tr><td>초당 학습 수</td><td style=text-align:right>> 1000/sec</td><td style=text-align:right>HIGH</td><td>트래픽 샘플링·포트 제한 권고</td></tr><tr><td>MAC 플래핑</td><td style=text-align:right>> 5 회/분</td><td style=text-align:right>HIGH</td><td>포트 로그 수집 → 격리 추천</td></tr><tr><td>동일 MAC 다중 포트</td><td style=text-align:right>동시 2 개 이상</td><td style=text-align:right>CRITICAL</td><td>즉시 포트 차단 (조건부)</td></tr><tr><td>미등록 MAC 등장</td><td style=text-align:right>정책 미매핑 시</td><td style=text-align:right>HIGH</td><td>운영자 알림 + 격리 (조건부)</td></tr></tbody></table><p>초기 임계값은 환경별 튜닝 필요. 자동 대응은 단계적 (알림→수동 확인→자동 격리) 으로 구성해 오탐 위험을 줄여야 한다.</p><h5 id=시각화리포팅-대시보드-항목--설명>시각화/리포팅 (대시보드 항목 · 설명)<a hidden class=anchor aria-hidden=true href=#시각화리포팅-대시보드-항목--설명>#</a></h5><table><thead><tr><th>대시보드 항목</th><th>목적</th><th>표현 방식</th></tr></thead><tbody><tr><td>MAC 분포 (포트/VLAN/OUI)</td><td>자산 분포 파악</td><td>히트맵 / 막대그래프</td></tr><tr><td>MAC 이동 히트맵</td><td>이동성 트렌드 분석</td><td>시계열 + 포트 이동 애니메이션</td></tr><tr><td>플랩/이상 이벤트 타임라인</td><td>이상 탐지 추적</td><td>이벤트 타임라인</td></tr><tr><td>CAM 용량 추이</td><td>용량 계획</td><td>시계열 경향선</td></tr><tr><td>실시간 미등록 장치</td><td>보안 모니터</td><td>테이블 + 상세 링크</td></tr></tbody></table><p>시각화는 원인 규명과 추세 파악에 최적화해야 함. 실시간 알람과 히스토리 조회가 유기적으로 연결되어야 빠른 대응이 가능하다.</p><h5 id=snmp-수집-파이프라인-예시>SNMP 수집 파이프라인 예시<a hidden class=anchor aria-hidden=true href=#snmp-수집-파이프라인-예시>#</a></h5><p>(A) <code>snmp_exporter</code> 를 사용한 직접 수집 (일반 메트릭) 과 (B) FDB(MAC 테이블) 처럼 OctetString → 라벨 변환이 까다로운 항목은 <strong>SNMP-walk → textfile</strong> 방식 (노드엑스포터 텍스트파일 콜렉터) 으로 처리하는 하이브리드 아키텍처를 권장한다.</p><pre class=mermaid>graph LR
  subgraph Network
    S1[Switch / Bridge / Access Point]
    S2[Router / Core]
  end

  subgraph CollectorLayer
    SE[&#34;snmp_exporter&lt;br/&gt; (metrics: ifOperStatus, ifDescr, port counters)&#34;]
    FDBCOL[&#34;MAC-FDB-collector&lt;br/&gt;(snmpwalk -&gt; textfile)&#34;]
    NODE[&#34;node_exporter&lt;br/&gt; (textfile collector)&#34;]
  end

  subgraph Monitoring
    PROM[Prometheus]
    GRAF[Grafana]
    ALERT[Alertmanager]
  end

  S1 --&gt;|&#34;SNMP (UDP/161)&#34;| SE
  S1 --&gt;|&#34;SNMP (walk)&#34;| FDBCOL
  FDBCOL --&gt;|writes| NODE
  SE --&gt;|exposes /snmp| PROM
  NODE --&gt;|exposes /metrics| PROM
  PROM --&gt; GRAF
  PROM --&gt; ALERT
</pre><ul><li><p><strong>snmp_exporter</strong>: 장비의 표준 OID(인터페이스 상태, 트래픽 카운터, 온도 등) 를 Prometheus 메트릭으로 노출. 실시간 폴링 (또는 Prometheus 가 scrape) 방식. 범용 메트릭 수집에 적합.</p></li><li><p><strong>MAC-FDB-collector (script)</strong>: <code>dot1dTpFdbAddress</code>/<code>dot1dTpFdbPort</code> 같이 OctetString 을 라벨 (예: mac=&ldquo;00:11:22:33:44:55&rdquo;) 로 변환해야 하는 경우, snmp_exporter 만으로 라벨화가 불편하므로 <code>snmpwalk</code> 를 통해 가져와 Prometheus 포맷 파일로 변환해 node_exporter textfile_collector 에 쓴다.</p></li><li><p><strong>node_exporter (textfile collector)</strong>: 수집 스크립트가 생성한 <code>.prom</code> 파일을 읽어 Prometheus 에 노출. 간단하고 안정적.</p></li><li><p><strong>Prometheus</strong>: snmp_exporter 와 node_exporter 를 스크랩하여 중앙 수집·저장. 알람 룰과 장기 시계열 보존 담당.</p></li><li><p><strong>Grafana / Alertmanager</strong>: 시각화, 알람 처리.</p></li></ul><h6 id=snmp_exporter-모듈-예시-간단한-모듈>snmp_exporter 모듈 예시 (간단한 모듈)<a hidden class=anchor aria-hidden=true href=#snmp_exporter-모듈-예시-간단한-모듈>#</a></h6><p>다음은 <code>snmp_exporter</code> 의 <code>snmp.yml</code> 모듈 예시 (인터페이스/기본 OID).<br>실제 배포 시 <code>snmp_exporter</code> 의 버전·generator 규칙을 참고해 조정.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-33-1><a class=lnlinks href=#hl-33-1> 1</a>
</span><span class=lnt id=hl-33-2><a class=lnlinks href=#hl-33-2> 2</a>
</span><span class=lnt id=hl-33-3><a class=lnlinks href=#hl-33-3> 3</a>
</span><span class=lnt id=hl-33-4><a class=lnlinks href=#hl-33-4> 4</a>
</span><span class=lnt id=hl-33-5><a class=lnlinks href=#hl-33-5> 5</a>
</span><span class=lnt id=hl-33-6><a class=lnlinks href=#hl-33-6> 6</a>
</span><span class=lnt id=hl-33-7><a class=lnlinks href=#hl-33-7> 7</a>
</span><span class=lnt id=hl-33-8><a class=lnlinks href=#hl-33-8> 8</a>
</span><span class=lnt id=hl-33-9><a class=lnlinks href=#hl-33-9> 9</a>
</span><span class=lnt id=hl-33-10><a class=lnlinks href=#hl-33-10>10</a>
</span><span class=lnt id=hl-33-11><a class=lnlinks href=#hl-33-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># snmp.yml (부분)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>modules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>if_mib_v2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>walk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>1.3.6.1.2.1.2.2.1.2</span><span class=w>   </span><span class=c># ifDescr</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>1.3.6.1.2.1.2.2.1.8</span><span class=w>   </span><span class=c># ifOperStatus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>1.3.6.1.2.1.2.2.1.10</span><span class=w>  </span><span class=c># ifInOctets</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>1.3.6.1.2.1.2.2.1.16</span><span class=w>  </span><span class=c># ifOutOctets</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>max_repetitions</span><span class=p>:</span><span class=w> </span><span class=m>25</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>auth</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>주의: FDB 관련 OID(<code>1.3.6.1.2.1.17.4.3.1.1</code>, <code>.2</code>) 는 OctetString/INDEX 형태라서 <code>snmp_exporter</code> 로 라벨화하면 메트릭명이 복잡해질 수 있음. 그래서 FDB 는 아래 B 방식 (SNMP-walk → textfile) 을 권장한다.</p></blockquote><h6 id=prometheus-scrape_config-예시>Prometheus <code>scrape_config</code> 예시<a hidden class=anchor aria-hidden=true href=#prometheus-scrape_config-예시>#</a></h6><p><code>snmp_exporter</code> 가 9116 포트에서 동작하고, node_exporter 가 각 수집기/노드에서 9100 포트를 열어놓은 상황 가정.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-34-1><a class=lnlinks href=#hl-34-1> 1</a>
</span><span class=lnt id=hl-34-2><a class=lnlinks href=#hl-34-2> 2</a>
</span><span class=lnt id=hl-34-3><a class=lnlinks href=#hl-34-3> 3</a>
</span><span class=lnt id=hl-34-4><a class=lnlinks href=#hl-34-4> 4</a>
</span><span class=lnt id=hl-34-5><a class=lnlinks href=#hl-34-5> 5</a>
</span><span class=lnt id=hl-34-6><a class=lnlinks href=#hl-34-6> 6</a>
</span><span class=lnt id=hl-34-7><a class=lnlinks href=#hl-34-7> 7</a>
</span><span class=lnt id=hl-34-8><a class=lnlinks href=#hl-34-8> 8</a>
</span><span class=lnt id=hl-34-9><a class=lnlinks href=#hl-34-9> 9</a>
</span><span class=lnt id=hl-34-10><a class=lnlinks href=#hl-34-10>10</a>
</span><span class=lnt id=hl-34-11><a class=lnlinks href=#hl-34-11>11</a>
</span><span class=lnt id=hl-34-12><a class=lnlinks href=#hl-34-12>12</a>
</span><span class=lnt id=hl-34-13><a class=lnlinks href=#hl-34-13>13</a>
</span><span class=lnt id=hl-34-14><a class=lnlinks href=#hl-34-14>14</a>
</span><span class=lnt id=hl-34-15><a class=lnlinks href=#hl-34-15>15</a>
</span><span class=lnt id=hl-34-16><a class=lnlinks href=#hl-34-16>16</a>
</span><span class=lnt id=hl-34-17><a class=lnlinks href=#hl-34-17>17</a>
</span><span class=lnt id=hl-34-18><a class=lnlinks href=#hl-34-18>18</a>
</span><span class=lnt id=hl-34-19><a class=lnlinks href=#hl-34-19>19</a>
</span><span class=lnt id=hl-34-20><a class=lnlinks href=#hl-34-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># prometheus.yml (일부)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;snmp&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics_path</span><span class=p>:</span><span class=w> </span><span class=l>/snmp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>params</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>module</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>if_mib_v2]         </span><span class=w> </span><span class=c># snmp_exporter의 모듈명</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;192.0.2.10&#39;</span><span class=p>]</span><span class=w>    </span><span class=c># 스위치/장비 IP (comma multiple)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w> </span><span class=l>production</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>role</span><span class=p>:</span><span class=w> </span><span class=l>access-switch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>relabel_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>source_labels</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>__address__]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>regex</span><span class=p>:</span><span class=w> </span><span class=l>(.*)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>replacement</span><span class=p>:</span><span class=w> </span><span class=l>snmp-exporter.example.local:9116</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>target_label</span><span class=p>:</span><span class=w> </span><span class=l>__address__ </span><span class=w> </span><span class=c># 실제 scrape는 snmp_exporter로 향함</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;node_exporter&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;collector-host:9100&#39;</span><span class=p>]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Prometheus 는 snmp_exporter 의 <code>/snmp?target=&lt;device>&amp;module=&lt;module></code> 를 호출한다. <code>relabel_configs</code> 로 <code>__address__</code> 를 snmp_exporter 주소로 바꿔 실제 요청을 snmp_exporter 가 처리하도록 한다.</p><h6 id=macfdb-전용-수집기권장-snmpwalk--textfile-collector-방식>MAC(FDB) 전용 수집기—권장: Snmpwalk → Textfile Collector 방식<a hidden class=anchor aria-hidden=true href=#macfdb-전용-수집기권장-snmpwalk--textfile-collector-방식>#</a></h6><p>직접 예시 스크립트를 제공한다 (실제 운영 전 환경별 OID 포맷 확인 후 조정).<br>이 스크립트는 각 스위치에 대해 <code>snmpwalk</code> 로 FDB 를 읽어 <code>mac_fdb.prom</code> 파일을 생성 (노드엑스포터 텍스트파일 위치) 한다.</p><p><strong>요구사항</strong>:</p><ul><li><code>snmpwalk</code>(net-snmp) 또는 <code>pysnmp</code> 가 설치돼 있어야 함</li><li>node_exporter 가 <code>--collector.textfile.directory=/var/lib/node_exporter/textfile_collector</code> 로 실행돼야 함</li><li>스크립트는 크론/시스템타이머로 주기 (예: 30s~300s) 실행</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-35-1><a class=lnlinks href=#hl-35-1>  1</a>
</span><span class=lnt id=hl-35-2><a class=lnlinks href=#hl-35-2>  2</a>
</span><span class=lnt id=hl-35-3><a class=lnlinks href=#hl-35-3>  3</a>
</span><span class=lnt id=hl-35-4><a class=lnlinks href=#hl-35-4>  4</a>
</span><span class=lnt id=hl-35-5><a class=lnlinks href=#hl-35-5>  5</a>
</span><span class=lnt id=hl-35-6><a class=lnlinks href=#hl-35-6>  6</a>
</span><span class=lnt id=hl-35-7><a class=lnlinks href=#hl-35-7>  7</a>
</span><span class=lnt id=hl-35-8><a class=lnlinks href=#hl-35-8>  8</a>
</span><span class=lnt id=hl-35-9><a class=lnlinks href=#hl-35-9>  9</a>
</span><span class=lnt id=hl-35-10><a class=lnlinks href=#hl-35-10> 10</a>
</span><span class=lnt id=hl-35-11><a class=lnlinks href=#hl-35-11> 11</a>
</span><span class=lnt id=hl-35-12><a class=lnlinks href=#hl-35-12> 12</a>
</span><span class=lnt id=hl-35-13><a class=lnlinks href=#hl-35-13> 13</a>
</span><span class=lnt id=hl-35-14><a class=lnlinks href=#hl-35-14> 14</a>
</span><span class=lnt id=hl-35-15><a class=lnlinks href=#hl-35-15> 15</a>
</span><span class=lnt id=hl-35-16><a class=lnlinks href=#hl-35-16> 16</a>
</span><span class=lnt id=hl-35-17><a class=lnlinks href=#hl-35-17> 17</a>
</span><span class=lnt id=hl-35-18><a class=lnlinks href=#hl-35-18> 18</a>
</span><span class=lnt id=hl-35-19><a class=lnlinks href=#hl-35-19> 19</a>
</span><span class=lnt id=hl-35-20><a class=lnlinks href=#hl-35-20> 20</a>
</span><span class=lnt id=hl-35-21><a class=lnlinks href=#hl-35-21> 21</a>
</span><span class=lnt id=hl-35-22><a class=lnlinks href=#hl-35-22> 22</a>
</span><span class=lnt id=hl-35-23><a class=lnlinks href=#hl-35-23> 23</a>
</span><span class=lnt id=hl-35-24><a class=lnlinks href=#hl-35-24> 24</a>
</span><span class=lnt id=hl-35-25><a class=lnlinks href=#hl-35-25> 25</a>
</span><span class=lnt id=hl-35-26><a class=lnlinks href=#hl-35-26> 26</a>
</span><span class=lnt id=hl-35-27><a class=lnlinks href=#hl-35-27> 27</a>
</span><span class=lnt id=hl-35-28><a class=lnlinks href=#hl-35-28> 28</a>
</span><span class=lnt id=hl-35-29><a class=lnlinks href=#hl-35-29> 29</a>
</span><span class=lnt id=hl-35-30><a class=lnlinks href=#hl-35-30> 30</a>
</span><span class=lnt id=hl-35-31><a class=lnlinks href=#hl-35-31> 31</a>
</span><span class=lnt id=hl-35-32><a class=lnlinks href=#hl-35-32> 32</a>
</span><span class=lnt id=hl-35-33><a class=lnlinks href=#hl-35-33> 33</a>
</span><span class=lnt id=hl-35-34><a class=lnlinks href=#hl-35-34> 34</a>
</span><span class=lnt id=hl-35-35><a class=lnlinks href=#hl-35-35> 35</a>
</span><span class=lnt id=hl-35-36><a class=lnlinks href=#hl-35-36> 36</a>
</span><span class=lnt id=hl-35-37><a class=lnlinks href=#hl-35-37> 37</a>
</span><span class=lnt id=hl-35-38><a class=lnlinks href=#hl-35-38> 38</a>
</span><span class=lnt id=hl-35-39><a class=lnlinks href=#hl-35-39> 39</a>
</span><span class=lnt id=hl-35-40><a class=lnlinks href=#hl-35-40> 40</a>
</span><span class=lnt id=hl-35-41><a class=lnlinks href=#hl-35-41> 41</a>
</span><span class=lnt id=hl-35-42><a class=lnlinks href=#hl-35-42> 42</a>
</span><span class=lnt id=hl-35-43><a class=lnlinks href=#hl-35-43> 43</a>
</span><span class=lnt id=hl-35-44><a class=lnlinks href=#hl-35-44> 44</a>
</span><span class=lnt id=hl-35-45><a class=lnlinks href=#hl-35-45> 45</a>
</span><span class=lnt id=hl-35-46><a class=lnlinks href=#hl-35-46> 46</a>
</span><span class=lnt id=hl-35-47><a class=lnlinks href=#hl-35-47> 47</a>
</span><span class=lnt id=hl-35-48><a class=lnlinks href=#hl-35-48> 48</a>
</span><span class=lnt id=hl-35-49><a class=lnlinks href=#hl-35-49> 49</a>
</span><span class=lnt id=hl-35-50><a class=lnlinks href=#hl-35-50> 50</a>
</span><span class=lnt id=hl-35-51><a class=lnlinks href=#hl-35-51> 51</a>
</span><span class=lnt id=hl-35-52><a class=lnlinks href=#hl-35-52> 52</a>
</span><span class=lnt id=hl-35-53><a class=lnlinks href=#hl-35-53> 53</a>
</span><span class=lnt id=hl-35-54><a class=lnlinks href=#hl-35-54> 54</a>
</span><span class=lnt id=hl-35-55><a class=lnlinks href=#hl-35-55> 55</a>
</span><span class=lnt id=hl-35-56><a class=lnlinks href=#hl-35-56> 56</a>
</span><span class=lnt id=hl-35-57><a class=lnlinks href=#hl-35-57> 57</a>
</span><span class=lnt id=hl-35-58><a class=lnlinks href=#hl-35-58> 58</a>
</span><span class=lnt id=hl-35-59><a class=lnlinks href=#hl-35-59> 59</a>
</span><span class=lnt id=hl-35-60><a class=lnlinks href=#hl-35-60> 60</a>
</span><span class=lnt id=hl-35-61><a class=lnlinks href=#hl-35-61> 61</a>
</span><span class=lnt id=hl-35-62><a class=lnlinks href=#hl-35-62> 62</a>
</span><span class=lnt id=hl-35-63><a class=lnlinks href=#hl-35-63> 63</a>
</span><span class=lnt id=hl-35-64><a class=lnlinks href=#hl-35-64> 64</a>
</span><span class=lnt id=hl-35-65><a class=lnlinks href=#hl-35-65> 65</a>
</span><span class=lnt id=hl-35-66><a class=lnlinks href=#hl-35-66> 66</a>
</span><span class=lnt id=hl-35-67><a class=lnlinks href=#hl-35-67> 67</a>
</span><span class=lnt id=hl-35-68><a class=lnlinks href=#hl-35-68> 68</a>
</span><span class=lnt id=hl-35-69><a class=lnlinks href=#hl-35-69> 69</a>
</span><span class=lnt id=hl-35-70><a class=lnlinks href=#hl-35-70> 70</a>
</span><span class=lnt id=hl-35-71><a class=lnlinks href=#hl-35-71> 71</a>
</span><span class=lnt id=hl-35-72><a class=lnlinks href=#hl-35-72> 72</a>
</span><span class=lnt id=hl-35-73><a class=lnlinks href=#hl-35-73> 73</a>
</span><span class=lnt id=hl-35-74><a class=lnlinks href=#hl-35-74> 74</a>
</span><span class=lnt id=hl-35-75><a class=lnlinks href=#hl-35-75> 75</a>
</span><span class=lnt id=hl-35-76><a class=lnlinks href=#hl-35-76> 76</a>
</span><span class=lnt id=hl-35-77><a class=lnlinks href=#hl-35-77> 77</a>
</span><span class=lnt id=hl-35-78><a class=lnlinks href=#hl-35-78> 78</a>
</span><span class=lnt id=hl-35-79><a class=lnlinks href=#hl-35-79> 79</a>
</span><span class=lnt id=hl-35-80><a class=lnlinks href=#hl-35-80> 80</a>
</span><span class=lnt id=hl-35-81><a class=lnlinks href=#hl-35-81> 81</a>
</span><span class=lnt id=hl-35-82><a class=lnlinks href=#hl-35-82> 82</a>
</span><span class=lnt id=hl-35-83><a class=lnlinks href=#hl-35-83> 83</a>
</span><span class=lnt id=hl-35-84><a class=lnlinks href=#hl-35-84> 84</a>
</span><span class=lnt id=hl-35-85><a class=lnlinks href=#hl-35-85> 85</a>
</span><span class=lnt id=hl-35-86><a class=lnlinks href=#hl-35-86> 86</a>
</span><span class=lnt id=hl-35-87><a class=lnlinks href=#hl-35-87> 87</a>
</span><span class=lnt id=hl-35-88><a class=lnlinks href=#hl-35-88> 88</a>
</span><span class=lnt id=hl-35-89><a class=lnlinks href=#hl-35-89> 89</a>
</span><span class=lnt id=hl-35-90><a class=lnlinks href=#hl-35-90> 90</a>
</span><span class=lnt id=hl-35-91><a class=lnlinks href=#hl-35-91> 91</a>
</span><span class=lnt id=hl-35-92><a class=lnlinks href=#hl-35-92> 92</a>
</span><span class=lnt id=hl-35-93><a class=lnlinks href=#hl-35-93> 93</a>
</span><span class=lnt id=hl-35-94><a class=lnlinks href=#hl-35-94> 94</a>
</span><span class=lnt id=hl-35-95><a class=lnlinks href=#hl-35-95> 95</a>
</span><span class=lnt id=hl-35-96><a class=lnlinks href=#hl-35-96> 96</a>
</span><span class=lnt id=hl-35-97><a class=lnlinks href=#hl-35-97> 97</a>
</span><span class=lnt id=hl-35-98><a class=lnlinks href=#hl-35-98> 98</a>
</span><span class=lnt id=hl-35-99><a class=lnlinks href=#hl-35-99> 99</a>
</span><span class=lnt id=hl-35-100><a class=lnlinks href=#hl-35-100>100</a>
</span><span class=lnt id=hl-35-101><a class=lnlinks href=#hl-35-101>101</a>
</span><span class=lnt id=hl-35-102><a class=lnlinks href=#hl-35-102>102</a>
</span><span class=lnt id=hl-35-103><a class=lnlinks href=#hl-35-103>103</a>
</span><span class=lnt id=hl-35-104><a class=lnlinks href=#hl-35-104>104</a>
</span><span class=lnt id=hl-35-105><a class=lnlinks href=#hl-35-105>105</a>
</span><span class=lnt id=hl-35-106><a class=lnlinks href=#hl-35-106>106</a>
</span><span class=lnt id=hl-35-107><a class=lnlinks href=#hl-35-107>107</a>
</span><span class=lnt id=hl-35-108><a class=lnlinks href=#hl-35-108>108</a>
</span><span class=lnt id=hl-35-109><a class=lnlinks href=#hl-35-109>109</a>
</span><span class=lnt id=hl-35-110><a class=lnlinks href=#hl-35-110>110</a>
</span><span class=lnt id=hl-35-111><a class=lnlinks href=#hl-35-111>111</a>
</span><span class=lnt id=hl-35-112><a class=lnlinks href=#hl-35-112>112</a>
</span><span class=lnt id=hl-35-113><a class=lnlinks href=#hl-35-113>113</a>
</span><span class=lnt id=hl-35-114><a class=lnlinks href=#hl-35-114>114</a>
</span><span class=lnt id=hl-35-115><a class=lnlinks href=#hl-35-115>115</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl><span class=c1># mac_fdb_collector.py</span>
</span></span><span class=line><span class=cl><span class=c1># 목적: SNMP FDB 읽어 Prometheus textfile 형식으로 출력</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl><span class=n>OUT_DIR</span> <span class=o>=</span> <span class=s2>&#34;/var/lib/node_exporter/textfile_collector&#34;</span>
</span></span><span class=line><span class=cl><span class=n>OUTPUT_FILE</span> <span class=o>=</span> <span class=n>OUT_DIR</span> <span class=o>+</span> <span class=s2>&#34;/mac_fdb.prom&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 스위치와 community 리스트 (예시)</span>
</span></span><span class=line><span class=cl><span class=n>DEVICES</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s2>&#34;ip&#34;</span><span class=p>:</span> <span class=s2>&#34;192.0.2.10&#34;</span><span class=p>,</span> <span class=s2>&#34;community&#34;</span><span class=p>:</span> <span class=s2>&#34;public&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=c1># {&#34;ip&#34;: &#34;192.0.2.11&#34;, &#34;community&#34;: &#34;public&#34;},</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># OIDs</span>
</span></span><span class=line><span class=cl><span class=n>OID_FDB_ADDR</span> <span class=o>=</span> <span class=s2>&#34;1.3.6.1.2.1.17.4.3.1.1&#34;</span>  <span class=c1># dot1dTpFdbAddress</span>
</span></span><span class=line><span class=cl><span class=n>OID_FDB_PORT</span> <span class=o>=</span> <span class=s2>&#34;1.3.6.1.2.1.17.4.3.1.2&#34;</span>  <span class=c1># dot1dTpFdbPort</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>hex_re</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;([0-9A-Fa-f]</span><span class=si>{2}</span><span class=s1>(?:\s[0-9A-Fa-f]</span><span class=si>{2}</span><span class=s1>)*)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>snmpwalk</span><span class=p>(</span><span class=n>device_ip</span><span class=p>,</span> <span class=n>community</span><span class=p>,</span> <span class=n>oid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>cmd</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;snmpwalk&#34;</span><span class=p>,</span> <span class=s2>&#34;-v2c&#34;</span><span class=p>,</span> <span class=s2>&#34;-c&#34;</span><span class=p>,</span> <span class=n>community</span><span class=p>,</span> <span class=n>device_ip</span><span class=p>,</span> <span class=n>oid</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>proc</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>cmd</span><span class=p>,</span> <span class=n>capture_output</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>text</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>proc</span><span class=o>.</span><span class=n>returncode</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>proc</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>splitlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>parse_mac_line</span><span class=p>(</span><span class=n>line</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    snmpwalk 출력에서 Hex-STRING: 00 1B 44 11 3A B7 같은 부분을 찾아 MAC 문자열으로 반환
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>m</span> <span class=o>=</span> <span class=n>hex_re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>m</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=n>hex_str</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34; &#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># format as xx:xx:xx:xx:xx:xx</span>
</span></span><span class=line><span class=cl>    <span class=n>mac</span> <span class=o>=</span> <span class=s1>&#39;:&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>hex_str</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=n>i</span><span class=o>+</span><span class=mi>2</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>hex_str</span><span class=p>),</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>mac</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>build_index_map</span><span class=p>(</span><span class=n>lines</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    dot1dTpFdbAddress 출력은 OID 인덱스 포함: e.g.
</span></span></span><span class=line><span class=cl><span class=s2>    DOT1DTPFDBADDRESS.X.Y.Z = Hex-STRING: …
</span></span></span><span class=line><span class=cl><span class=s2>    인덱스 (X.Y.Z) 는 내부 인덱스. 여기서는 같은 인덱스를 사용해 포트와 매칭
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_to_mac</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>lines</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># e.g. SNMPv2-SMI::mib-2.17.4.3.1.1.0.1 = Hex-STRING: 00 1B 44 11 3A B7</span>
</span></span><span class=line><span class=cl>        <span class=c1># capture trailing .&lt;index&gt; sequence</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>left</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;=&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># extract index as last numeric block after OID</span>
</span></span><span class=line><span class=cl>            <span class=n>idx_match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\.(\d+(?:\.\d+)*)\s*$&#39;</span><span class=p>,</span> <span class=n>left</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>idx_match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>            <span class=n>index</span> <span class=o>=</span> <span class=n>idx_match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>mac</span> <span class=o>=</span> <span class=n>parse_mac_line</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>mac</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>idx_to_mac</span><span class=p>[</span><span class=n>index</span><span class=p>]</span> <span class=o>=</span> <span class=n>mac</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>idx_to_mac</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>build_port_map</span><span class=p>(</span><span class=n>lines</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>idx_to_port</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>lines</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>left</span><span class=p>,</span> <span class=n>right</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;=&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>idx_match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\.(\d+(?:\.\d+)*)\s*$&#39;</span><span class=p>,</span> <span class=n>left</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>idx_match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>            <span class=n>index</span> <span class=o>=</span> <span class=n>idx_match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># right part contains integer port number</span>
</span></span><span class=line><span class=cl>            <span class=n>port_match</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;(-?\d+)&#39;</span><span class=p>,</span> <span class=n>right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>port_match</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>idx_to_port</span><span class=p>[</span><span class=n>index</span><span class=p>]</span> <span class=o>=</span> <span class=n>port_match</span><span class=o>.</span><span class=n>group</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>idx_to_port</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>collect_for_device</span><span class=p>(</span><span class=n>dev</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>addr_lines</span> <span class=o>=</span> <span class=n>snmpwalk</span><span class=p>(</span><span class=n>dev</span><span class=p>[</span><span class=s2>&#34;ip&#34;</span><span class=p>],</span> <span class=n>dev</span><span class=p>[</span><span class=s2>&#34;community&#34;</span><span class=p>],</span> <span class=n>OID_FDB_ADDR</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>port_lines</span> <span class=o>=</span> <span class=n>snmpwalk</span><span class=p>(</span><span class=n>dev</span><span class=p>[</span><span class=s2>&#34;ip&#34;</span><span class=p>],</span> <span class=n>dev</span><span class=p>[</span><span class=s2>&#34;community&#34;</span><span class=p>],</span> <span class=n>OID_FDB_PORT</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>mac_map</span> <span class=o>=</span> <span class=n>build_index_map</span><span class=p>(</span><span class=n>addr_lines</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>port_map</span> <span class=o>=</span> <span class=n>build_port_map</span><span class=p>(</span><span class=n>port_lines</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># produce metric lines</span>
</span></span><span class=line><span class=cl>    <span class=n>metrics</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>now</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>mac</span> <span class=ow>in</span> <span class=n>mac_map</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>port</span> <span class=o>=</span> <span class=n>port_map</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span> <span class=s2>&#34;0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># metric: mac_fdb_port{device=&#34;192.0.2.10&#34;,mac=&#34;00:1b:…&#34;,port=&#34;5&#34;} 1</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;mac_fdb_port</span><span class=se>{{</span><span class=s1>device=&#34;</span><span class=si>{</span><span class=n>dev</span><span class=p>[</span><span class=s2>&#34;ip&#34;</span><span class=p>]</span><span class=si>}</span><span class=s1>&#34;, mac=&#34;</span><span class=si>{</span><span class=n>mac</span><span class=si>}</span><span class=s1>&#34;, port=&#34;</span><span class=si>{</span><span class=n>port</span><span class=si>}</span><span class=s1>&#34;</span><span class=se>}}</span><span class=s1> 1 </span><span class=si>{</span><span class=n>now</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>metrics</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>all_metrics</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>dev</span> <span class=ow>in</span> <span class=n>DEVICES</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>metrics</span> <span class=o>=</span> <span class=n>collect_for_device</span><span class=p>(</span><span class=n>dev</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>all_metrics</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>metrics</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 운영에서는 로그로 남기고 계속 진행</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;collect error:&#34;</span><span class=p>,</span> <span class=n>dev</span><span class=p>[</span><span class=s2>&#34;ip&#34;</span><span class=p>],</span> <span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>header</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;# HELP mac_fdb_port MAC FDB: mac -&gt; port mapping (value 1 means learned)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;# TYPE mac_fdb_port gauge&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>OUTPUT_FILE</span><span class=p>,</span> <span class=s2>&#34;w&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>header</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>all_metrics</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>위 스크립트는 <code>snmpwalk</code> 출력 형식을 기준으로 한다. 일부 장비는 출력 포맷이 다를 수 있으므로 (예: <code>Hex-STRING: 00 1B …</code> vs <code>STRING:</code>), 환경 맞춤 파서가 필요하다.</li><li>파일 생성 권한과 node_exporter user 권한을 맞춰야 한다. (예: <code>/var/lib/node_exporter/textfile_collector</code> 소유/퍼미션)</li></ul><h6 id=prometheus-에서의-사용-흐름>Prometheus 에서의 사용 흐름<a hidden class=anchor aria-hidden=true href=#prometheus-에서의-사용-흐름>#</a></h6><ol><li><code>snmp_exporter</code> 는 인터페이스/카운터/온도 등 <strong>일반 메트릭</strong>을 노출 → Prometheus 가 <code>/snmp</code> 로 스크랩.</li><li><code>mac_fdb_collector.py</code> 를 cron 으로 주기 실행 → <code>/var/lib/node_exporter/textfile_collector/mac_fdb.prom</code> 생성 → node_exporter 가 이 파일을 읽어 메트릭으로 노출 → Prometheus 가 node_exporter 를 스크랩.</li><li>Grafana 에서 <code>mac_fdb_port{device="192.0.2.10"}</code> 같은 메트릭으로 포트별 MAC 목록/히트맵 시각화.</li><li>Alertmanager 알람 규칙 예: 동일 MAC 이 여러 포트에서 동시에 관측되면 <code>alert</code> 트리거.</li></ol><h6 id=prometheus-알람-룰-간단-예시>Prometheus 알람 룰 (간단 예시)<a hidden class=anchor aria-hidden=true href=#prometheus-알람-룰-간단-예시>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-36-1><a class=lnlinks href=#hl-36-1> 1</a>
</span><span class=lnt id=hl-36-2><a class=lnlinks href=#hl-36-2> 2</a>
</span><span class=lnt id=hl-36-3><a class=lnlinks href=#hl-36-3> 3</a>
</span><span class=lnt id=hl-36-4><a class=lnlinks href=#hl-36-4> 4</a>
</span><span class=lnt id=hl-36-5><a class=lnlinks href=#hl-36-5> 5</a>
</span><span class=lnt id=hl-36-6><a class=lnlinks href=#hl-36-6> 6</a>
</span><span class=lnt id=hl-36-7><a class=lnlinks href=#hl-36-7> 7</a>
</span><span class=lnt id=hl-36-8><a class=lnlinks href=#hl-36-8> 8</a>
</span><span class=lnt id=hl-36-9><a class=lnlinks href=#hl-36-9> 9</a>
</span><span class=lnt id=hl-36-10><a class=lnlinks href=#hl-36-10>10</a>
</span><span class=lnt id=hl-36-11><a class=lnlinks href=#hl-36-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>groups</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>mac_fdb_alerts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>alert</span><span class=p>:</span><span class=w> </span><span class=l>MacSeenOnMultiplePorts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>expr</span><span class=p>:</span><span class=w> </span><span class=l>count by (mac) (mac_fdb_port) &gt; 1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>for</span><span class=p>:</span><span class=w> </span><span class=l>1m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class=l>critical</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;MAC {{ $labels.mac }} seen on &gt;1 ports&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;MAC {{ $labels.mac }} appears on multiple ports in last scrape&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=mac-보안컴플라이언스-운영-가이드>MAC 보안·컴플라이언스 운영 가이드<a hidden class=anchor aria-hidden=true href=#mac-보안컴플라이언스-운영-가이드>#</a></h4><p>MAC 주소는 L2 식별자라서 <strong>물리적/링크 수준의 접근 제어에 유용</strong>하지만 <strong>쉽게 위조 (spoofing)</strong> 될 수 있다.<br>따라서 실무에서는 <strong>단일 기술에 의존하지 않고 (예: MAC 필터만)</strong>, <strong>인증 (802.1X), DHCP 기반 검증 (DHCP Snooping+DAI), 포트 시큐리티, L2 암호화 (MACsec)</strong>, 그리고 <strong>모니터링 (SIEM)</strong> 을 조합해 방어 계층을 쌓는 것이 표준적이다.<br>또한 MAC 은 환경에 따라 개인정보로 간주될 수 있으니 <strong>익명화·보존 정책</strong>을 마련해 규정 요구를 충족해야 한다.</p><h5 id=예방-preventive-통제>예방 (Preventive) 통제<a hidden class=anchor aria-hidden=true href=#예방-preventive-통제>#</a></h5><table><thead><tr><th>제어</th><th>목적</th><th style=text-align:right>구현 포인트</th><th>한계/주의</th></tr></thead><tbody><tr><td>802.1X (EAP-TLS)</td><td>근본적 접근 제어 (장치/사용자 인증)</td><td style=text-align:right>RADIUS,cert 관리, NAC 연동</td><td>복잡·장비지원 필요, MAB 예외 최소화</td></tr><tr><td>Port Security</td><td>포트 수준 MAC 제한</td><td style=text-align:right>max MAC, sticky, violation action</td><td>MAC 스푸핑 우회 가능성 존재</td></tr><tr><td>DHCP Snooping</td><td>DHCP 기반 IP↔MAC 바인딩 확보</td><td style=text-align:right>switch-level snooping, trusted ports</td><td>클라우드/무선 환경 적용 제한</td></tr><tr><td>MAC ACL / Whitelist</td><td>단순 허용/차단</td><td style=text-align:right>소규모 환경 유용</td><td>쉽게 스푸핑 가능하므로 보조 수단</td></tr><tr><td>MACsec (802.1AE)</td><td>L2 암호화·무결성</td><td style=text-align:right>NIC/스위치 지원 및 키관리</td><td>하드웨어 지원 필요, 성능 영향 고려</td></tr></tbody></table><p>예방 통제는 &rsquo; 무단 접근을 처음부터 막는 &rsquo; 역할. 가장 강력한 조합은 802.1X + NAC + Port Security 이며, MACsec 은 민감 구간에서 추가 보안 계층으로 고려.</p><h5 id=탐지-detective-통제>탐지 (Detective) 통제<a hidden class=anchor aria-hidden=true href=#탐지-detective-통제>#</a></h5><table><thead><tr><th>제어</th><th>목적</th><th style=text-align:right>구현 포인트</th><th>예시 SIEM 룰</th></tr></thead><tbody><tr><td>DAI (Dynamic ARP Inspection)</td><td>ARP 스푸핑 탐지·차단</td><td style=text-align:right>DHCP 바인딩과 연계</td><td>ARP 요청의 sender MAC ≠ DHCP 바인딩 → 경보/차단</td></tr><tr><td>FDB 모니터링</td><td>MAC 이동·플러딩 탐지</td><td style=text-align:right>스위치 FDB 관찰, 임계치 설정</td><td>같은 MAC 이 2 개 포트에서 30s 내 발견 → 경보</td></tr><tr><td>트래픽 이상탐지 (NDR/IDS)</td><td>비정상 트래픽 탐지</td><td style=text-align:right>플로우·패킷 패턴 분석</td><td>급격한 MAC 증가·ARP 폭주 → 탐지</td></tr><tr><td>로그 상관분석 (SIEM)</td><td>이벤트 연계·분석</td><td style=text-align:right>RADIUS/DHCP/ Switch 로그 통합</td><td>DHCP OFFER from unauthorized server → 경보</td></tr></tbody></table><p>탐지 통제는 예방을 우회하는 시도를 빠르게 발견하고 자동화된 조치 (격리·티켓화) 로 연결하는 역할. SIEM·NDR 연동으로 상관분석을 해두면 근본 원인 추적이 쉬워진다.</p><h5 id=대응-및-운영-교정>대응 및 운영 (교정)<a hidden class=anchor aria-hidden=true href=#대응-및-운영-교정>#</a></h5><table><thead><tr><th>항목</th><th>목적</th><th style=text-align:right>절차 예시</th><th style=text-align:right>자동화 가능성</th></tr></thead><tbody><tr><td>자동 격리</td><td>의심 장치 네트워크 분리</td><td style=text-align:right>NAC → 격리 VLAN 할당</td><td style=text-align:right>높음 (정책 기반)</td></tr><tr><td>포렌식 수집</td><td>사고 원인 분석</td><td style=text-align:right>pcap/스위치 FDB 스냅샷 수집</td><td style=text-align:right>일부 (스크립트) 가능</td></tr><tr><td>복구 및 재검증</td><td>정상화 후 정책 재적용</td><td style=text-align:right>MAC 재등록·재인증</td><td style=text-align:right>중간 (수동검토 필요)</td></tr><tr><td>정책 갱신</td><td>운영 중 규칙 개선</td><td style=text-align:right>분기별 리뷰·변경관리</td><td style=text-align:right>낮~중간</td></tr></tbody></table><p>사고 후 빠른 격리와 증거 수집 (포렌식) 이 관건. 자동 격리를 우선 구현하고, 복구 절차와 책임 및 감사 로그를 문서화해 둬야 한다.</p><h5 id=컴플라이언스프라이버시>컴플라이언스·프라이버시<a hidden class=anchor aria-hidden=true href=#컴플라이언스프라이버시>#</a></h5><table><thead><tr><th>항목</th><th>왜 필요한가</th><th style=text-align:right>구현 팁</th><th>검증 포인트</th></tr></thead><tbody><tr><td>익명화 (Hash/HMAC)</td><td>식별자 보호 (GDPR 등)</td><td style=text-align:right>HMAC(secret) 로 일방향 저장, 매핑 분리 보관</td><td>재식별 불가성 테스트</td></tr><tr><td>보존 정책</td><td>최소 보존으로 규정 준수</td><td style=text-align:right>보존기간 (예: 30–90 일), 정기 자동 삭제</td><td>삭제 로그·감사 증적</td></tr><tr><td>접근 통제</td><td>로그 접근 최소화</td><td style=text-align:right>RBAC, 키관리, 암호화 저장</td><td>접근 감사 로그</td></tr><tr><td>동의·고지</td><td>법적 근거 확보</td><td style=text-align:right>사용자 고지·동의 수집</td><td>동의 기록 보관</td></tr></tbody></table><p>MAC 가 개인식별자 (또는 식별 가능성 포함 데이터) 가 될 수 있어 법적 리스크가 존재한다. 익명화·보존·접근 통제·동의 절차는 반드시 문서화·자동화해야 한다.</p><h4 id=스위치-mac-성능확장성-운영-가이드>스위치 MAC 성능·확장성 운영 가이드<a hidden class=anchor aria-hidden=true href=#스위치-mac-성능확장성-운영-가이드>#</a></h4><ul><li><p>스위치 (또는 L2 스위칭 장비) 는 <strong>MAC 주소 테이블</strong>을 이용해 프레임을 어디로 보낼지 판단한다.</p></li><li><p><strong>성능 문제</strong>는 주로</p><ol><li>MAC 테이블 크기 부족</li><li>엔트리의 잦은 생성을 유발하는 짧은 aging</li><li>브로드캐스트/멀티캐스트 폭주에서 발생한다.</li></ol></li><li><p>해결 방법은</p><ol><li>장비 튜닝 (aging, TCAM/SDM)</li><li>네트워크 설계 (브로드캐스트 도메인 분리, VLAN)</li><li>확장 기술 (EVPN/VXLAN)</li><li>모니터링 (플래핑·ARP 폭주 감지) 이며<br>모든 변경은 <strong>측정→적용→검증</strong> 루프를 따라야 한다.</li></ol></li></ul><h5 id=로컬-스위치-튜닝-성능>로컬 스위치 튜닝 (성능)<a hidden class=anchor aria-hidden=true href=#로컬-스위치-튜닝-성능>#</a></h5><table><thead><tr><th>항목</th><th>목적 (왜)</th><th>권장 방법 (어떻게)</th><th>예시 명령/설정</th></tr></thead><tbody><tr><td>Aging Time</td><td>불필요 엔트리 제거 vs 재학습 비용 균형</td><td>환경별 측정 후 값 설정. 서버존 길게 (1800s), 사무실 중간 (300s), 모바일 짧게 (120s)</td><td><code>mac address-table aging-time 300</code></td></tr><tr><td>MAC Table Size / SDM</td><td>CAM overflow 예방</td><td>장비 스펙 확인 → SDM 템플릿 조정/업그레이드</td><td><code>sdm prefer switching</code> (장비별 상이)</td></tr><tr><td>Storm Control</td><td>브로드캐스트 스톰 제어</td><td>포트별 임계값·알람 설정</td><td><code>storm-control broadcast level 1.00 0.50</code> (예시)</td></tr><tr><td>IGMP/MLD Snooping</td><td>멀티캐스트 트래픽 제어</td><td>스위치에서 snooping 활성화</td><td><code>ip igmp snooping</code></td></tr></tbody></table><p>로컬 파라미터 (aging, TCAM, 스톰) 로 즉각적 성능 향상. 환경에 맞게 조정하고 모니터링.</p><h5 id=네트워크-설계분할-확장성안정성>네트워크 설계·분할 (확장성/안정성)<a hidden class=anchor aria-hidden=true href=#네트워크-설계분할-확장성안정성>#</a></h5><table><thead><tr><th>항목</th><th>목적</th><th>방법</th><th>실무 팁</th></tr></thead><tbody><tr><td>VLAN 분리</td><td>브로드캐스트 도메인 분리 → 안정성</td><td>서비스/부서/IoT 별 VLAN 설계</td><td>정책 기반 VLAN 자동 프로비저닝</td></tr><tr><td>Layer3 분할 (스파인 - 리프)</td><td>라우팅으로 큰 L2 도메인 피해</td><td>스파인 - 리프 아키텍처 적용</td><td>ECMP 로 부하 분산</td></tr><tr><td>Port Security</td><td>MAC 바인딩으로 불법단말 차단</td><td>정적 MAC/동적 제한 설정</td><td>MAC 스푸핑 탐지와 연동</td></tr></tbody></table><p>적절한 분할 설계로 MAC 테이블 부담·브로드캐스트 확산 차단. 보안과 성능 동시에 개선.</p><h5 id=오버레이확장-기술-evpnvxlan>오버레이/확장 기술 (EVPN/VXLAN)<a hidden class=anchor aria-hidden=true href=#오버레이확장-기술-evpnvxlan>#</a></h5><table><thead><tr><th>항목</th><th>목적</th><th>방법</th><th>고려사항</th></tr></thead><tbody><tr><td>EVPN/VXLAN</td><td>L2 를 L3 위에 확장, 멀티 DC 연결</td><td>BGP-EVPN 컨트롤 플레인 + VXLAN 데이터 플레인</td><td>ARP suppression, control plane 메시지량, 운영 복잡도</td></tr><tr><td>ARP/ND Suppression</td><td>ARP 트래픽 감소</td><td>EVPN 에서 ARP 캐시 공유/프록시</td><td>성능·일관성 테스트 필요</td></tr></tbody></table><p>대규모 L2 확장 표준 해법. 구성 복잡성·운영 부담을 감수할 만큼 장점 큼.</p><h5 id=하드웨어리소스-관리>하드웨어·리소스 관리<a hidden class=anchor aria-hidden=true href=#하드웨어리소스-관리>#</a></h5><table><thead><tr><th>항목</th><th>목적</th><th>방법</th><th>체크리스트</th></tr></thead><tbody><tr><td>TCAM/ASIC 활용</td><td>고속 룩업·정책 처리</td><td>ACL/CoS/MACT 배분 고려</td><td>장비 스펙 확인, 기능별 TCAM 소비 산정</td></tr><tr><td>하드웨어 업그레이드</td><td>용량/성능 한계 극복</td><td>스펙에 맞는 플랫폼 선택</td><td>예상 최대 MAC 수 계산 후 여유 20~30% 확보</td></tr></tbody></table><p>논리적 설계만으로는 한계. 하드웨어 제약을 설계 초기부터 반영해야 함.</p><h5 id=모니터링운영-관측성자동화>모니터링·운영 (관측성·자동화)<a hidden class=anchor aria-hidden=true href=#모니터링운영-관측성자동화>#</a></h5><table><thead><tr><th>항목</th><th>목적</th><th>방법</th><th>도구 예시</th></tr></thead><tbody><tr><td>MAC churn / flapping 모니터링</td><td>빈번한 MAC 변경 탐지</td><td>syslog/telemetry → 알람</td><td>SNMP, sFlow, NetFlow, Syslog, ELK/Prometheus</td></tr><tr><td>ARP/ND 이상 탐지</td><td>ARP 폭주·스푸핑 탐지</td><td>threshold 알람·SIEM 연동</td><td>SIEM, IDS/IPS</td></tr><tr><td>변경 전후 벤치마크</td><td>영향 평가</td><td>KPI(ARP hit, CPU, packet drop) 측정</td><td>자동화 스크립트</td></tr></tbody></table><p>지속적 관측이 변경의 안정성 보장. 자동화된 알람/대시보드 필수.</p><h5 id=보안안정성>보안·안정성<a hidden class=anchor aria-hidden=true href=#보안안정성>#</a></h5><table><thead><tr><th>항목</th><th>목적</th><th>방법</th><th>주의점</th></tr></thead><tbody><tr><td>Port Security</td><td>무단 디바이스 차단</td><td>MAC 바인딩, violation action 설정</td><td>VM/컨테이너 이동 고려해 정책 설계</td></tr><tr><td>DHCP snooping / DAI</td><td>ARP/NDP 위조 완화</td><td>스위치 보안 기능 활성화</td><td>잘못 구성 시 정상 서비스 차단 위험</td></tr><tr><td>ACL / uRPF</td><td>정합성 검사</td><td>경계에서 패킷 소스 검증</td><td>멀티 홈 환경 유의</td></tr></tbody></table><p>MAC 기반 제어는 보완적 수단. 인증/로그와 결합해 신뢰성 확보.</p><h4 id=mac-트러블슈팅-진단해결예방-가이드>MAC 트러블슈팅: 진단·해결·예방 가이드<a hidden class=anchor aria-hidden=true href=#mac-트러블슈팅-진단해결예방-가이드>#</a></h4><p>MAC 문제 트러블슈팅의 핵심은 **관찰 (테이블/로그) → 원인 분류 (루프/중복/스푸핑/용량) → 즉시 완화 (포트 차단/에이징 단축) → 근본 해결 (정책·구성 교정) → 예방 (인증·분리·모니터링)**의 반복 사이클이다.<br>도구 (<code>show mac address-table</code>, <code>arp -a</code>, <code>tcpdump -e</code>) 로 증상을 수집하고, 포트 보안·DHCP snooping·802.1X 같은 표준 기법과 VLAN/오버레이 설계를 통해 재발을 막는다.</p><h5 id=진단-탐지수집>진단 (탐지/수집)<a hidden class=anchor aria-hidden=true href=#진단-탐지수집>#</a></h5><table><thead><tr><th>문제 유형</th><th style=text-align:right>증상 (관찰)</th><th>권장 수집 명령/도구</th><th>추가 확보할 데이터</th></tr></thead><tbody><tr><td>MAC 플래핑</td><td style=text-align:right>동일 MAC 이 여러 포트에 빠르게 나타남</td><td><code>show mac address-table dynamic</code>, <code>show interfaces status</code>, <code>tcpdump -e</code></td><td>포트별 타임스탬프, LACP 상태</td></tr><tr><td>MAC 충돌</td><td style=text-align:right>통신 끊김, ARP 불일치</td><td><code>arp -a</code>, <code>show mac address-table</code>, DHCP 서버 로그</td><td>DHCP lease, VM 호스트 정보</td></tr><tr><td>MAC 오버플로우</td><td style=text-align:right>신규 장치 학습 실패</td><td><code>show mac address-table counts</code>, <code>show platform resources</code></td><td>스위치 TCAM/MA 용량, 브로드캐스트 트래픽 레이트</td></tr><tr><td>스푸핑</td><td style=text-align:right>의심 트래픽/인증 실패</td><td>RADIUS logs, DHCP snooping logs, <code>tcpdump -e</code></td><td>사용자 세션, 타임라인, MAC 변경 이력</td></tr></tbody></table><p>문제 파악은 정확한 증상 (포트·타임스탬프·로그) 을 확보하는 것부터. 다양한 로그를 시간축으로 상관 분석하면 원인 분류가 빨라진다.</p><h5 id=즉시-대응-완화>즉시 대응 (완화)<a hidden class=anchor aria-hidden=true href=#즉시-대응-완화>#</a></h5><table><thead><tr><th>상황</th><th>즉시 조치 (권고)</th><th>주의사항</th></tr></thead><tbody><tr><td>MAC 플래핑</td><td>의심 포트 <code>shutdown</code> → STP/포트채널 재검토</td><td>서비스 영향 최소화 위해 단계적 조치</td></tr><tr><td>MAC 오버플로우</td><td>에이징 시간 임시 단축, 오래된 엔트리 <code>clear dynamic</code></td><td>대규모 네트워크에선 영향 범위 확인</td></tr><tr><td>스푸핑 탐지</td><td>포트 보안 적용 (비승인 MAC 차단), 세션 로그 캡처</td><td>오탐으로 정당 사용자 차단 주의</td></tr><tr><td>랜덤화 오탐</td><td>SSID 정책으로 랜덤화 비활성 유도 또는 MDM 예외</td><td>사용자 경험·프라이버시 고려</td></tr></tbody></table><p>즉시 완화는 서비스 유지와 원인 제거 사이 균형. 자동화된 공격 대응은 신중히 (롤백 전략 필요).</p><h5 id=근본-원인-해결-구성정책>근본 원인 해결 (구성/정책)<a hidden class=anchor aria-hidden=true href=#근본-원인-해결-구성정책>#</a></h5><table><thead><tr><th>문제</th><th>근본 조치</th><th>관련 정책/설정</th></tr></thead><tbody><tr><td>플래핑 (루프)</td><td>물리 케이블 정리, STP 튜닝, 올바른 port-channel 설정</td><td>STP 우선순위·BPDU guard, LACP 정책</td></tr><tr><td>충돌 (중복 MAC)</td><td>하이퍼바이저 MAC 풀 정비, 이미지화 정책 강화</td><td>VM 템플릿에 MAC 재설정 절차 포함</td></tr><tr><td>오버플로우</td><td>L2 도메인 축소 (VLAN), 오버레이 (EVPN/VXLAN) 전환</td><td>주소 학습 한계 문서화, 용량 계획</td></tr><tr><td>스푸핑</td><td>802.1X 도입, DHCP snooping + DAI</td><td>RADIUS 계정/세션 정책, TACACS 연동</td></tr></tbody></table><p>근본 해결은 네트워크 설계 (분리·오버레이) 와 인증·정책 (802.1X, DHCP snooping) 을 결합하는 일이다.</p><h5 id=자동화보고복구>자동화·보고·복구<a hidden class=anchor aria-hidden=true href=#자동화보고복구>#</a></h5><table><thead><tr><th>기능</th><th>구현 예</th><th>고려사항</th></tr></thead><tbody><tr><td>자동 탐지</td><td>SIEM 룰: MAC 플래핑 임계치 알람</td><td>정상 재구성 (예: VM 마이그레이션) 제외 규칙 필요</td></tr><tr><td>자동 완화</td><td>스크립트로 임시 포트 차단 또는 에이징 조정</td><td>자동화 권한·롤백 채널 확보</td></tr><tr><td>복구 절차</td><td>무중단 복구 체크리스트, 백업 구성</td><td>테스트된 복구 절차·주기적 DR 연습 필요</td></tr><tr><td>보고/감사</td><td>DHCP/RADIUS/스위치 로그 상관 리포트</td><td>로그 보존 기간·프라이버시 규정 준수</td></tr></tbody></table><p>자동화는 탐지 - 완화 - 복구를 빠르게 하지만 오탐·권한오남용 위험을 줄이기 위한 안전장치가 필수.</p><h5 id=예방-설계운영>예방 (설계·운영)<a hidden class=anchor aria-hidden=true href=#예방-설계운영>#</a></h5><table><thead><tr><th>항목</th><th>권장 설계/운영 조치</th></tr></thead><tbody><tr><td>L2 스케일</td><td>VLAN 분리, EVPN/VXLAN 오버레이로 L2 도메인 축소</td></tr><tr><td>인증</td><td>802.1X + RADIUS 로 사용자/디바이스 바인딩</td></tr><tr><td>DHCP 관리</td><td>DHCP snooping, IP-MAC 바인딩, IPAM 도구 사용</td></tr><tr><td>모바일·랜덤화 정책</td><td>기업 SSID 프로파일, MDM/네트워크 접근 예외 설정</td></tr><tr><td>교육·운영절차</td><td>NIC 교체·VM 마이그레이션 체크리스트, 변경관리 (CMDB)</td></tr></tbody></table><p>설계 단계에서 L2 범위·인증·IPAM 을 고려하면 운영 중 발생하는 MAC 이슈를 대폭 줄일 수 있다.</p><h3 id=고급-주제-및-미래-전망>고급 주제 및 미래 전망<a hidden class=anchor aria-hidden=true href=#고급-주제-및-미래-전망>#</a></h3><h4 id=mac-주소-도전제약과-실무적-완화전략>MAC 주소: 도전·제약과 실무적 완화전략<a hidden class=anchor aria-hidden=true href=#mac-주소-도전제약과-실무적-완화전략>#</a></h4><p>MAC 주소는 네트워크 장치의 물리적 식별자였지만, 개인정보 보호와 모바일·무선 사용 증가로 <strong>MAC 랜덤화</strong>가 도입되었다.<br>이것은 사용자 프라이버시를 보호하지만 네트워크 운영자 입장에서는 같은 장비를 지속적으로 식별·인증·추적하기 어려워져 보안 정책, 접근 제어, 로그 분석, 문제 해결이 복잡해진다. 또한 가상화/컨테이너 환경에서 수많은 가상 인터페이스가 생성되면서 MAC 관리·충돌·스케일 문제가 새로 생겼다. 따라서 실무에서는 <strong>강화된 인증, 계층적 정책, 예외 처리 규칙, 관측성 (로그) 설계</strong>를 조합해 이 문제들을 완화해야 한다.</p><h5 id=기술적-문제>기술적 문제<a hidden class=anchor aria-hidden=true href=#기술적-문제>#</a></h5><table><thead><tr><th>항목</th><th>문제 (무엇)</th><th>원인</th><th>실무 영향</th><th>완화/대응</th></tr></thead><tbody><tr><td>MAC 랜덤화 동작</td><td>MAC 이 회전/랜덤화됨</td><td>OS/무선 표준의 프라이버시 기능</td><td>NAC·로그·식별 실패, 인증 재요청</td><td>Probe/Assoc 구분 정책, 게스트 SSID 분리, 기기 인증서 병행</td></tr><tr><td>ARP/ND 타이밍</td><td>캐시 타임아웃·재검증 빈도</td><td>ARP/ND 기본 타이밍</td><td>이동성·재연결 지연</td><td>ARP 캐시 정책 튜닝, 빠른 재검증 메커니즘</td></tr><tr><td>스위치/하이퍼바이저 동작 차이</td><td>포트 시큐리티/aging 불일치</td><td>벤더별 디폴트 상이</td><td>정책 불일치·예외 처리 필요</td><td>운영 표준화, 테스트·검증 프로파일</td></tr></tbody></table><p>기술적 문제는 운영 중인 플랫폼 (OS, 스위치, 하이퍼바이저 등) 의 세부 동작 차이에서 기인한다. 실무는 각 플랫폼의 랜덤화/learning/aging 정책을 파악해 예외 처리·정책을 설계해야 한다.</p><h5 id=운영관리-문제>운영·관리 문제<a hidden class=anchor aria-hidden=true href=#운영관리-문제>#</a></h5><table><thead><tr><th>항목</th><th>문제 (무엇)</th><th>원인</th><th>실무 영향</th><th>완화/대응</th></tr></thead><tbody><tr><td>장기 로그·추적 불가</td><td>MAC 변경으로 연속 추적 곤란</td><td>MAC 랜덤화 / 동적 vNIC</td><td>포렌식·고객지원 악화</td><td>디바이스 ID(인증서)/동작 기반 식별, 세션키 로깅</td></tr><tr><td>가상 MAC 폭증</td><td>vNIC 대량생성/삭제</td><td>컨테이너·VM 확장</td><td>포트 제한·CAM 포화 가능</td><td>네임스페이스별 오버레이, MAC pool 관리</td></tr><tr><td>운영 복잡도 증가</td><td>빈번한 예외·정책 수정</td><td>이동성·게스트 증가</td><td>운영 비용 상승</td><td>정책 템플릿화, 자동화 (Ansible/SDN)</td></tr></tbody></table><p>운영 측면은 &rsquo; 식별의 지속성 &rsquo; 저하와 &rsquo; 대량·동적 자원 &rsquo; 이 핵심 원인이다. 인증 기반 식별 (디바이스 인증서), 자동화된 정책·예외 처리, 로그 설계로 완화할 수 있다.</p><h5 id=보안프라이버시-문제>보안·프라이버시 문제<a hidden class=anchor aria-hidden=true href=#보안프라이버시-문제>#</a></h5><table><thead><tr><th>항목</th><th>문제 (무엇)</th><th>원인</th><th>실무 영향</th><th>완화/대응</th></tr></thead><tbody><tr><td>프라이버시 vs 운영</td><td>MAC 수집이 개인정보 논란</td><td>법규 (GDPR 등) · 사용자 요구</td><td>로그 보관 제한, 마케팅 집행 제약</td><td>익명화·동의 기반 로그, 최소수집 원칙</td></tr><tr><td>스푸핑·신뢰성 저하</td><td>MAC 만으로 신뢰 불가</td><td>스푸핑 도구·물리 교체</td><td>인증·접근제어 우회 가능</td><td>802.1X, DHCP Snooping, DAI, IP-MAC 바인딩</td></tr></tbody></table><p>보안과 프라이버시는 서로 상충되는 요구다. MAC 단독 신뢰는 위험하므로 강한 인증·논리적 바인딩이 필요하다. 로그는 법적 요건과 프라이버시를 고려해 설계해야 한다.</p><h5 id=스케일자원-문제>스케일·자원 문제<a hidden class=anchor aria-hidden=true href=#스케일자원-문제>#</a></h5><table><thead><tr><th>항목</th><th>문제 (무엇)</th><th>원인</th><th>실무 영향</th><th>완화/대응</th></tr></thead><tbody><tr><td>OUI/주소공간 압박</td><td>대량 디바이스로 OUI 부담</td><td>IoT·제조사 성장</td><td>MAC 할당 어려움, 관리 비용</td><td>EUI-64, 지역/용도별 할당, 로컬 MAC 네임스페이스</td></tr><tr><td>CAM/테이블 포화</td><td>MAC 엔트리 증가</td><td>대규모 L2 도메인</td><td>플러딩·성능 저하</td><td>L2 분할 (VLAN), L3 집계, EVPN/VXLAN 오버레이</td></tr></tbody></table><p>스케일 문제는 물리적 한계 (CAM, OUI) 와 토폴로지 설계의 결과다. L2 도메인 분할과 오버레이/L3 집계 전략이 실무적 해법이다.</p><h4 id=최신-트렌드-및-방향>최신 트렌드 및 방향<a hidden class=anchor aria-hidden=true href=#최신-트렌드-및-방향>#</a></h4><ul><li>휴대폰·노트북은 <strong>네트워크마다 다른 MAC</strong>을 쓰게 되어 <strong>사생활 보호</strong>가 커졌다. 필요하면 <strong>회사 정책</strong>으로 고정 MAC 을 쓰게 만들 수 있다.</li><li>회사망은 <strong>MAC 만 믿지 말고</strong> → <strong>802.1X(증명서)</strong> + <strong>장치 프로파일링</strong>을 같이 쓰면 안전하다.</li><li>데이터센터·클라우드는 <strong>EVPN/VXLAN</strong>으로 <strong>MAC 을 라우팅</strong>해 <strong>대규모 L2</strong>를 만든다.</li><li><strong>Wi-Fi 7</strong>은 여러 대역을 동시에 쓰는 <strong>MLO</strong>로 속도·지연을 개선하고, <strong>MLD/링크별 MAC</strong> 구조를 쓴다.</li></ul><h5 id=프라이버시--단말>프라이버시 & 단말<a hidden class=anchor aria-hidden=true href=#프라이버시--단말>#</a></h5><table><thead><tr><th>항목</th><th>내용</th><th>실무 포인트</th></tr></thead><tbody><tr><td>iOS/macOS Private Wi-Fi Address</td><td>SSID 별 지속 MAC, <strong>주기적 회전 가능</strong></td><td>MDM 로 SSID 별 랜덤화 해제/강제 가능</td></tr><tr><td>Android 랜덤화</td><td>기본 <strong>지속 랜덤화</strong>, Android 12+ 일부 <strong>비지속</strong></td><td>개발자 옵션·UEM 정책으로 제어</td></tr><tr><td>Windows 랜덤 하드웨어 주소</td><td>HW/드라이버 지원 시 설정 제공</td><td>조직 정책으로 on/off 관리</td></tr></tbody></table><p>단말은 기본적으로 랜덤화한다. 기업은 MDM/UEM 으로 예외를 강제해 일관성 확보.</p><h5 id=엔터프라이즈-보안>엔터프라이즈 보안<a hidden class=anchor aria-hidden=true href=#엔터프라이즈-보안>#</a></h5><table><thead><tr><th>항목</th><th>내용</th><th>실무 포인트</th></tr></thead><tbody><tr><td>802.1X/EAP-TLS</td><td>사용자·디바이스 인증 표준</td><td>MAC 스푸핑·랜덤화 영향 최소화</td></tr><tr><td>802.1AR DevID</td><td>제조단 보증 장치 신원</td><td>자동 등록·제로터스트 토대</td></tr><tr><td>NAC 프로파일링</td><td>OUI+DHCP+LLDP 등 다특성 식별</td><td>&ldquo;MAC 단독 인증 지양 " 권고</td></tr><tr><td>DHCP Snooping/DAI/IPSG</td><td>L2 위협 차단 체인</td><td>Rogue DHCP/ARP 스푸핑 방어</td></tr></tbody></table><p>인증은 <strong>증명서 + 프로파일링</strong>이 기본. L2 보안 기능으로 가장자리에서 리스크 차단.</p><h5 id=데이터센터클라우드>데이터센터/클라우드<a hidden class=anchor aria-hidden=true href=#데이터센터클라우드>#</a></h5><table><thead><tr><th>항목</th><th>내용</th><th>실무 포인트</th></tr></thead><tbody><tr><td>VXLAN</td><td>L2 오버레이 캡슐레이션</td><td>멀티테넌시·대규모 확장</td></tr><tr><td>EVPN(Type-2)</td><td>MAC/IP 광고 표준</td><td>MAC 모빌리티·ARP 억제·대규모 동기화</td></tr></tbody></table><p><strong>요약</strong>: EVPN/VXLAN 조합이 사실상 표준. MAC 을 BGP 로 싣고, 운영 일관성을 확보.</p><h5 id=무선-진화-wi-fi-7>무선 진화 (Wi-Fi 7)<a hidden class=anchor aria-hidden=true href=#무선-진화-wi-fi-7>#</a></h5><table><thead><tr><th>항목</th><th>내용</th><th>실무 포인트</th></tr></thead><tbody><tr><td>MLO</td><td>다대역 동시 통신</td><td>성능·지연·복원력 개선 (필수 기능)</td></tr><tr><td>주소 모델</td><td><strong>MLD MAC + 링크별 STA MAC</strong></td><td>SSID 지속성·링크 독립성 동시에 달성</td></tr></tbody></table><p>Wi-Fi 7 은 <strong>주소 체계를 다층화</strong>해 성능 확보. 프라이버시는 여전히 OS 정책이 핵심.</p><h4 id=mac-의존도-축소를-위한-대안-기술-모음>MAC 의존도 축소를 위한 대안 기술 모음<a hidden class=anchor aria-hidden=true href=#mac-의존도-축소를-위한-대안-기술-모음>#</a></h4><p>MAC 주소는 L2 식별자로 오래 유효했지만, 모바일·가상화·프라이버시 기능으로 한계가 생겼다.<br>이를 그대로 두기보다 포트/세션 수준의 강력 인증 (802.1X, DevID), 중앙 관리 (NAC/MDM) 로 신원을 검증하고, 행동·메타데이터 (디바이스 지문) 로 보강하며, 클라우드/컨테이너 환경에서는 서비스 메시 (SPIFFE) 같은 워크로드 신원을 적용하는 것이 현실적 대안이다.<br>IPv6 전환과 함께 다층으로 적용하면 MAC 의존도를 크게 줄일 수 있다.</p><h5 id=인증신원-기반>인증·신원 기반<a hidden class=anchor aria-hidden=true href=#인증신원-기반>#</a></h5><table><thead><tr><th>기술</th><th style=text-align:right>설명</th><th>경쟁력 (핵심)</th><th>단점</th><th>권장 적용</th></tr></thead><tbody><tr><td>802.1X / EAP</td><td style=text-align:right>포트/무선 접속 시 인증 (IEEE 표준)</td><td>강력한 포트 레벨 인증·RADIUS 연동</td><td>설정 복잡, IoT 지원 제한</td><td>기업 유선/무선, 보안중요망</td></tr><tr><td>DevID (802.1AR)</td><td style=text-align:right>장치 하드웨어 신원 (디바이스 ID)</td><td>하드웨어 기반 신뢰성</td><td>장비지원·발급체계 필요</td><td>고보안 장비, 공급망 신원확인</td></tr><tr><td>DHCP 인증 / IP 기반 인증</td><td style=text-align:right>DHCP 옵션·서버 기반 인증</td><td>쉬운 도입, 기존 인프라 활용</td><td>IP 이동성·랜덤화 취약</td><td>소규모/레거시 환경 보완</td></tr></tbody></table><p>인증·신원 기반은 가장 신뢰도가 높지만 운영·호환성 비용이 발생한다. 레거시·IoT 는 보완책 필요.</p><h5 id=관리정책-플랫폼>관리·정책 플랫폼<a hidden class=anchor aria-hidden=true href=#관리정책-플랫폼>#</a></h5><table><thead><tr><th>기술</th><th style=text-align:right>설명</th><th>경쟁력</th><th>단점</th><th>권장 적용</th></tr></thead><tbody><tr><td>NAC (Network Access Control)</td><td style=text-align:right>네트워크 접속 정책·컴플라이언스 적용</td><td>중앙정책·게스트 관리</td><td>복잡한 정책, TCO</td><td>대기업·캠퍼스 네트워크</td></tr><tr><td>MDM (Mobile Device Management)</td><td style=text-align:right>단말 관리·정책·차단</td><td>단말 생명주기 관리</td><td>엔드포인트 에이전트 필요</td><td>BYOD·모바일 중심 환경</td></tr><tr><td>IPAM/DNS/DHCP 통합</td><td style=text-align:right>주소 · 이름 · 할당 통합관리</td><td>운영 자동화·추적성 확보</td><td>연동·마이그레이션 비용</td><td>클라우드/엔터프라이즈 네트워크</td></tr></tbody></table><p>중앙관리 플랫폼은 관찰성·정책 시행 능력을 크게 높여준다. 초기 설계·정책이 관건.</p><h5 id=행동메타데이터-식별>행동·메타데이터 식별<a hidden class=anchor aria-hidden=true href=#행동메타데이터-식별>#</a></h5><table><thead><tr><th>기술</th><th style=text-align:right>설명</th><th>경쟁력</th><th>단점</th><th>권장 적용</th></tr></thead><tbody><tr><td>Device Fingerprinting</td><td style=text-align:right>트래픽·스택·타이밍으로 단말 식별</td><td>MAC 랜덤화에도 탐지 가능</td><td>프라이버시·오탐 위험</td><td>고가치 네트워크 모니터링</td></tr><tr><td>UEBA / Flow 분석</td><td style=text-align:right>사용자/엔티티 행동기반 이상징후</td><td>비정상 탐지에 강함</td><td>머신러닝 운영·튜닝 필요</td><td>보안 운영 센터 (SOC)</td></tr></tbody></table><p>행동기반 식별은 MAC 이 신뢰불가할 때 유용하나 규제·정확도 문제를 함께 고려해야 함.</p><h5 id=네트워크주소-대체진화>네트워크·주소 대체/진화<a hidden class=anchor aria-hidden=true href=#네트워크주소-대체진화>#</a></h5><table><thead><tr><th>기술</th><th style=text-align:right>설명</th><th>경쟁력</th><th>단점</th><th>권장 적용</th></tr></thead><tbody><tr><td>IPv6 (RFC7217 등)</td><td style=text-align:right>주소공간 확장·프라이버시 옵션</td><td>근본적 주소문제 해결</td><td>전환비용·호환성 문제</td><td>장기 인프라 전환 계획</td></tr><tr><td>CGNAT 대안/변환</td><td style=text-align:right>IPv4 부족 대응</td><td>즉시 사용 가능</td><td>NAT 로 인한 연결성 문제</td><td>ISP 레벨 적용</td></tr></tbody></table><p>요약: IPv6 채택은 필수적 장기 목표. 전환 중에는 변환·터널링 조합 필요.</p><h5 id=클라우드컨테이너-신원>클라우드·컨테이너 신원<a hidden class=anchor aria-hidden=true href=#클라우드컨테이너-신원>#</a></h5><table><thead><tr><th>기술</th><th style=text-align:right>설명</th><th>경쟁력</th><th>단점</th><th>권장 적용</th></tr></thead><tbody><tr><td>CNI 기반 IP/MAC 관리</td><td style=text-align:right>Kubernetes 등에서 네트워크 제어</td><td>클라우드 네이티브와 통합</td><td>플러그인 의존성</td><td>클라우드/컨테이너 환경</td></tr><tr><td>Service Mesh + SPIFFE</td><td style=text-align:right>워크로드 신원 (TLS 기반)</td><td>인증·권한부여 체계화</td><td>인프라 복잡도 증가</td><td>마이크로서비스 아키텍처</td></tr></tbody></table><p>요약: 클라우드/컨테이너 환경에서는 MAC 대신 워크로드 신원이 실용적이므로 적극 도입 권장.</p><h4 id=차세대-네트워크의-mac-역할과-표준-진화>차세대 네트워크의 MAC 역할과 표준 진화<a hidden class=anchor aria-hidden=true href=#차세대-네트워크의-mac-역할과-표준-진화>#</a></h4><p>차세대 네트워크 표준에서는 MAC 주소가 단순한 L2 식별자를 넘어서 다양한 역할을 맡는다.<br>Wi-Fi 7 은 하나의 장치가 여러 링크 (주파수) 에 각각의 MAC 을 써서 동시 전송을 하도록 설계했고, TSN 은 MAC 에서 파생한 식별자를 시간 동기화에 사용해 정밀한 그랜드마스터 선출에 활용한다.<br>DetNet 은 플로우 단위로 전송을 예약·보호해 지연·손실을 엄격히 제한하는데, 이 과정에서 MAC·플로우 매핑·스케줄 관리가 핵심이다. 따라서 운영자는 <strong>멀티 MAC 관리, 장치 인증, 시간정밀성 확보, 플로우 예약/백업 관리</strong>에 초점을 맞춰야 한다.</p><h5 id=무선접속-계층-wi-fi-7-mlo>무선/접속 계층: Wi-Fi 7 (MLO)<a hidden class=anchor aria-hidden=true href=#무선접속-계층-wi-fi-7-mlo>#</a></h5><table><thead><tr><th>항목</th><th style=text-align:right>의미/정의</th><th>실무적 영향</th><th>구현·확인 포인트</th></tr></thead><tbody><tr><td>MLD / U-MAC</td><td style=text-align:right>디바이스 (MLD) 식별자</td><td>장치 단위 인증/관리에 사용</td><td>MLD MAC 등록·인벤토리 유지</td></tr><tr><td>L-MAC (링크별)</td><td style=text-align:right>각 링크의 물리 MAC</td><td>링크별 트래픽·보안 정책 필요</td><td>링크별 키/ACL/로그 분리</td></tr><tr><td>키 유도·보안</td><td style=text-align:right>PMK/PTK 파생에 MLD/Link 사용</td><td>멀티링크 보안 연속성 확보</td><td>PMK 파생 절차·핸드셰이크 검증</td></tr></tbody></table><p>Wi-Fi 7 MLO 는 하나의 장치가 여러 MAC 을 가지므로 자산관리·보안정책·로그 체계를 링크 단위까지 확장해야 한다.</p><h5 id=시간산업용-네트워킹-tsn-8021as-rev>시간·산업용 네트워킹: TSN (802.1AS-rev)<a hidden class=anchor aria-hidden=true href=#시간산업용-네트워킹-tsn-8021as-rev>#</a></h5><table><thead><tr><th>항목</th><th style=text-align:right>의미/정의</th><th>실무적 영향</th><th>구현·확인 포인트</th></tr></thead><tbody><tr><td>ClockIdentity (EUI-64 파생)</td><td style=text-align:right>MAC→EUI-64 변환으로 클록 ID 생성</td><td>BMCA 에서 우선순위 비교·동기화 기준</td><td>clockIdentity 일관성·중복 방지</td></tr><tr><td>BMCA (Best Master Clock Algorithm)</td><td style=text-align:right>최적 그랜드마스터 선출</td><td>네트워크 전역 시간 품질 확보</td><td>그랜드마스터 모니터링·failover</td></tr><tr><td>시간정밀도 요구</td><td style=text-align:right>μs~ns 수준 동기화 필요</td><td>하드웨어 타임스탬핑·큐잉 짧음</td><td>NIC/스위치 PTP/PHC 지원 여부 확인</td></tr></tbody></table><p>TSN 환경은 MAC 에서 파생한 식별자를 시간계층에서 핵심으로 쓰므로 MAC 변경·랜덤화는 시간 도메인에 큰 영향을 준다.</p><h5 id=결정적-전송-detnet>결정적 전송: DetNet<a hidden class=anchor aria-hidden=true href=#결정적-전송-detnet>#</a></h5><table><thead><tr><th>항목</th><th style=text-align:right>의미/정의</th><th>실무적 영향</th><th>구현·확인 포인트</th></tr></thead><tbody><tr><td>플로우 스케줄링</td><td style=text-align:right>전송 시간 슬롯 기반 예약</td><td>지연·손실 보장 (산업·오디오)</td><td>스케줄 배치·충돌 검증</td></tr><tr><td>포워딩 규칙 (데이터플레인)</td><td style=text-align:right>플로우별 경로·백업 지정</td><td>트래픽 분리·우선순위 보장</td><td>Forwarding tables·MPLS/TSN 연동</td></tr><tr><td>관리 모델 (YANG)</td><td style=text-align:right>DetNet 리소스 모델화</td><td>오케스트레이션 자동화</td><td>YANG 모델 적용·컨트롤러 통합</td></tr></tbody></table><p>DetNet 은 플로우 단위로 자원 예약과 스케줄을 강제하기 때문에 MAC/플로우 매핑과 제어면 (컨트롤러)·데이터면 (스위치) 연계가 필수다.</p><hr><h2 id=최종-정리-및-학습-가이드>최종 정리 및 학습 가이드<a hidden class=anchor aria-hidden=true href=#최종-정리-및-학습-가이드>#</a></h2><h3 id=내용-종합>내용 종합<a hidden class=anchor aria-hidden=true href=#내용-종합>#</a></h3><p>MAC 주소는 네트워크 L2 의 기본 식별자이며, 전 세계 고유성 (IEEE OUI) 과 L2 포워딩의 핵심 역할을 담당한다.<br>현대 네트워크에서는 물리적 장비뿐 아니라 가상 NIC·컨테이너까지 MAC 을 사용하므로 <strong>관리 복잡성</strong>, <strong>프라이버시 요구</strong>, <strong>대규모 확장성 한계</strong>가 주요 도전 과제이다.<br>실무적으로는 <strong>로컬 튜닝 (aging·storm control)</strong>, <strong>설계적 분할 (VLAN·L3 구간화)</strong>, <strong>확장 기술 (EVPN/VXLAN)</strong>, <strong>하드웨어 고려 (TCAM)</strong>, 그리고 **모니터링·보안 (DAI/DHCP snooping/802.1X)**의 조합으로 문제를 완화·해결해야 한다.<br>모든 변경은 <strong>측정→적용→검증</strong> 루프를 통해 리스크를 최소화해야 한다.</p><h3 id=실무-적용-가이드>실무 적용 가이드<a hidden class=anchor aria-hidden=true href=#실무-적용-가이드>#</a></h3><table><thead><tr><th>단계</th><th style=text-align:right>항목 (실행)</th><th>이유 (목적)</th><th>실무 권장·메모</th></tr></thead><tbody><tr><td>Plan</td><td style=text-align:right>네트워크/디바이스 규모 예측</td><td>용량·주소계획, 장비 스펙 결정</td><td>장비별 MAC 테이블 크기·DHCP 바인딩 한계 확인</td></tr><tr><td>Plan</td><td style=text-align:right>보안·규정 요구 정의 (GDPR 등)</td><td>로그·보존·익명화 설계</td><td>감사 주기·보존기간 명문화</td></tr><tr><td>Implement</td><td style=text-align:right>802.1X (EAP-TLS) 우선 적용</td><td>장치 수준 강력 인증</td><td>MAB 는 보조, MDM 과 연계</td></tr><tr><td>Implement</td><td style=text-align:right>DHCP Snooping 활성화 (VLAN 지정)</td><td>Rogue DHCP 차단, 바인딩 수집</td><td>uplink/릴레이는 반드시 trusted 설정</td></tr><tr><td>Implement</td><td style=text-align:right>Dynamic ARP Inspection (DAI)</td><td>ARP 스푸핑 차단</td><td>DAI 는 DHCP 바인딩 의존</td></tr><tr><td>Implement</td><td style=text-align:right>Port Security 설정</td><td>단말 수·MAC 고정</td><td>포트별 limit·violation action 설정</td></tr><tr><td>Implement</td><td style=text-align:right>Option 82 활용/검증</td><td>클라이언트 위치 정보 확보</td><td>릴레이 장비와 정책 일치 확인</td></tr><tr><td>Operate</td><td style=text-align:right>MAC 바인딩·테이블 모니터링</td><td>이상행동 (플래핑/중복) 탐지</td><td>알람·자동화 (플레이북) 연동</td></tr><tr><td>Operate</td><td style=text-align:right>로그·감사 자동화 (IPAM/SIEM)</td><td>추적·증적 확보</td><td>PII 취급 주의 (GDPR)</td></tr><tr><td>Operate</td><td style=text-align:right>모바일/무선 정책</td><td>MAC 랜덤화·BYOD 대응</td><td>MDM 프로파일, SSID 분리</td></tr><tr><td>Scale</td><td style=text-align:right>중앙 IPAM/NAC 도입</td><td>일관된 할당·정책 자동화</td><td>RADIUS 연동, API 기반 운영</td></tr><tr><td>Scale</td><td style=text-align:right>EVPN/VXLAN 등 L2 확장</td><td>대규모 L2 확장·세그멘테이션</td><td>MAC learning offload 고려</td></tr><tr><td>Security</td><td style=text-align:right>MAC 랜덤화 관리 정책</td><td>프라이버시 vs 보안 균형</td><td>기업 SSID 에서 비활성화/예외 관리</td></tr><tr><td>Security</td><td style=text-align:right>로그 보존·익명화 정책</td><td>규제 준수·침해 조사 대비</td><td>접근제어·암호화 적용</td></tr><tr><td>Tooling</td><td style=text-align:right>권장 툴/연계</td><td>관리·가시성 확보</td><td>NAC(ISE/ClearPass), IPAM, SIEM, MDM, DHCP 서버</td></tr><tr><td>Tooling</td><td style=text-align:right>자동화/플레이북</td><td>신속대응·일관성 유지</td><td>MAC 플래핑/충돌 자동화 스크립트</td></tr></tbody></table><h3 id=학습-로드맵>학습 로드맵<a hidden class=anchor aria-hidden=true href=#학습-로드맵>#</a></h3><table><thead><tr><th style=text-align:right>단계</th><th style=text-align:right>권장 기간</th><th>핵심 학습 주제 (요약)</th><th>학습 목표 (Outcome)</th><th>실무 연관 실습/예제</th><th>권장 도구</th></tr></thead><tbody><tr><td style=text-align:right>초급 (Beginner)</td><td style=text-align:right>1–2 개월</td><td>OSI 기본, 이더넷/프레임, MAC 구조 (OUI,U/L,I/G), ARP/ND</td><td>네트워크 기본 원리 이해, MAC 의 역할 파악</td><td><code>tcpdump</code>/<code>Wireshark</code> 로 프레임 캡처·분석, <code>ip/ifconfig</code> 명령 실습</td><td>Wireshark, tcpdump, VirtualBox</td></tr><tr><td style=text-align:right>중급 (Intermediate)</td><td style=text-align:right>2–3 개월</td><td>스위치 MAC 테이블·포트 시큐리티, DHCP/DNS, DHCP Snooping/DAI, 기본 NAC</td><td>네트워크 운영·보안 정책 구성, 문제 진단 능력</td><td>스위치에서 port-security 구성, DHCP Snooping 구성, SNMP 로 MAC 수집</td><td>GNS3/EVE-NG, Cisco IOS (or OVS), Prometheus</td></tr><tr><td style=text-align:right>고급 (Advanced)</td><td style=text-align:right>3–6 개월</td><td>802.1X+RADIUS, FreeRADIUS 실습, 컨테이너 CNI 동작, SDN/NAC 연동, Device certs(TPM/802.1AR)</td><td>대규모·가상화 환경의 정책 구현, 인증기반 운영 설계</td><td>FreeRADIUS 802.1X 실습, K8s(CNI) 에서 MAC/이더넷 동작 관찰, SDN/NAC 시나리오</td><td>FreeRADIUS, Kubernetes, Calico/Cilium, Open vSwitch, Mininet</td></tr><tr><td style=text-align:right>심화 (Research/Trend)</td><td style=text-align:right>선택</td><td>MAC 랜덤화 내부 동작 (iOS/Android), EVPN/VXLAN, RFC7217, Device fingerprinting</td><td>최신 트렌드 이해, 설계·정책 고도화</td><td>Wireshark 로 모바일 probe 분석, EVPN/VXLAN 실습, RFC 리뷰</td><td>Mobile devices, EVPN lab, academic papers</td></tr></tbody></table><h3 id=학습-항목-정리>학습 항목 정리<a hidden class=anchor aria-hidden=true href=#학습-항목-정리>#</a></h3><table><thead><tr><th style=text-align:right>단계</th><th>항목</th><th style=text-align:right>중요도</th><th>학습 목표</th><th>실무 연관성</th><th>설명</th></tr></thead><tbody><tr><td style=text-align:right>초급</td><td>MAC 구조 / OUI / U/L / I/G</td><td style=text-align:right>필수</td><td>MAC 비트 해석 및 분류 판단</td><td>장비 식별, 정책 기초</td><td>MAC 포맷 (48 비트/64 비트), OUI 검색법</td></tr><tr><td style=text-align:right>초급</td><td>이더넷 프레임·ARP·ND</td><td style=text-align:right>필수</td><td>L2→L3 해상 이해</td><td>트래픽 분석, 문제진단</td><td>ARP Request/Reply 흐름, ND 메시지</td></tr><tr><td style=text-align:right>초급</td><td>기본 명령어 실습</td><td style=text-align:right>필수</td><td>네트워크 인터페이스 조작</td><td>운영 진단</td><td><code>ip addr</code>, <code>ip neigh</code>, <code>arp -a</code></td></tr><tr><td style=text-align:right>중급</td><td>스위치 MAC 테이블 학습</td><td style=text-align:right>필수</td><td>포트 학습·플러딩 이해</td><td>포트 시큐리티/분리 정책</td><td><code>show mac address-table</code> 및 CAM 개념</td></tr><tr><td style=text-align:right>중급</td><td>포트 시큐리티 / DHCP Snooping / DAI</td><td style=text-align:right>필수</td><td>기본 L2 보안 구성</td><td>스푸핑 방지·정책 강화</td><td>스위치 보안 설계·구성 실습</td></tr><tr><td style=text-align:right>중급</td><td>DHCP 관리·예약·IPAM</td><td style=text-align:right>필수</td><td>주소 할당 자동화</td><td>대규모 운영, 충돌 예방</td><td>ISC Kea/ISC DHCP/NetBox 연동</td></tr><tr><td style=text-align:right>중급</td><td>SNMP / 로그 수집</td><td style=text-align:right>권장</td><td>모니터링 자동화</td><td>운영·관측성</td><td>Grafana/Prometheus 연동</td></tr><tr><td style=text-align:right>고급</td><td>802.1X + FreeRADIUS</td><td style=text-align:right>필수</td><td>인증 기반 접속 제어</td><td>엔터프라이즈 NAC</td><td>802.1X 인증 흐름·EAP 종류 실습</td></tr><tr><td style=text-align:right>고급</td><td>컨테이너 CNI (Calico/Cilium)</td><td style=text-align:right>필수</td><td>가상 네트워크 처리 이해</td><td>K8s 환경 정책</td><td>Pod 네트워킹, MAC/IP 할당 차이</td></tr><tr><td style=text-align:right>고급</td><td>SDN/NAC 통합</td><td style=text-align:right>권장</td><td>중앙 정책·오케스트레이션</td><td>대규모 정책 일관화</td><td>ONOS/ODL/Consul 연동 사례</td></tr><tr><td style=text-align:right>고급</td><td>디바이스 인증 (802.1AR/TPM)</td><td style=text-align:right>권장</td><td>영구 식별·신뢰성 확보</td><td>고보안 환경</td><td>기기 인증서 발급·관리</td></tr><tr><td style=text-align:right>심화</td><td>모바일 MAC 랜덤화 분석</td><td style=text-align:right>선택</td><td>플랫폼별 랜덤화 패턴 파악</td><td>무선 운영 정책 설계</td><td>iOS/Android probe/assoc 분석</td></tr><tr><td style=text-align:right>심화</td><td>EVPN/VXLAN, RFC7217</td><td style=text-align:right>선택</td><td>L2 확장/프라이버시 주소 이해</td><td>데이터센터/클라우드 설계</td><td>RFC 읽기·랩 구축</td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어 (한글·영문·약어)</th><th>정의</th><th>관련 개념</th><th>실무 활용</th></tr></thead><tbody><tr><td>핵심/주소</td><td><strong>MAC 주소 (Media Access Control Address, MAC)</strong></td><td>L2 에서 인터페이스를 식별하는 48 비트 주소 (일반적으로 EUI-48)</td><td>EUI-48/64, OUI, U/L·I/G 비트</td><td>단말 식별, 포워딩 결정, 접근 제어</td></tr><tr><td>핵심/주소</td><td><strong>EUI-48 (Extended Unique Identifier-48, EUI-48)</strong></td><td>48 비트 식별자 포맷 (전통적 MAC-48)</td><td>OUI, EUI-64</td><td>이더넷/Wi-Fi 주소 체계</td></tr><tr><td>핵심/주소</td><td><strong>EUI-64 (Extended Unique Identifier-64, EUI-64)</strong></td><td>64 비트 식별자 포맷, IPv6 주소 형성에 활용</td><td>IPv6 링크 - 로컬, SLAAC</td><td>인터페이스 ID 생성, 장치 식별</td></tr><tr><td>할당/등록</td><td><strong>MA-L (MAC Address Block Large, MA-L)</strong></td><td>OUI + 대규모 EUI-48/64 블록 (제조사 대량 할당)</td><td>OUI, RA 등록</td><td>NIC 제조·대량 주소 생성</td></tr><tr><td>할당/등록</td><td><strong>MA-M (MAC Address Block Medium, MA-M)</strong></td><td>중간 규모 EUI-48/64 블록</td><td>MA-L/MA-S</td><td>중견 규모 제품군 주소</td></tr><tr><td>할당/등록</td><td><strong>MA-S (MAC Address Block Small, MA-S)</strong></td><td><strong>OUI-36</strong> 기반의 소규모 블록</td><td>OUI-36</td><td>소량·스타트업 제품군</td></tr><tr><td>할당/등록</td><td><strong>CID (Company ID, CID)</strong></td><td>24 비트 식별자. EUI 생성에는 <strong>사용 불가</strong></td><td>제조사 식별</td><td>객체 식별 등 특수 용도</td></tr><tr><td>할당/등록</td><td><strong>BIA (Burned-In Address, BIA)</strong></td><td>제조 시 NIC 에 영구 기록된 MAC</td><td>OUI, EUI-48</td><td>자산 고유 식별, 하드웨어 등록</td></tr><tr><td>할당/등록</td><td><strong>LAA (Locally Administered Address, LAA)</strong></td><td>소프트웨어로 설정한 로컬 관리 MAC</td><td>U/L 비트=1</td><td>테스트·격리·프라이버시</td></tr><tr><td>구조/비트</td><td><strong>U/L 비트 (Universal/Local bit, U/L)</strong></td><td>첫 바이트의 2 번째 비트: 0=전역 (제조사), 1=로컬 (LAA)</td><td>EUI-48/64</td><td>주소 유효성·정책 분기</td></tr><tr><td>구조/비트</td><td><strong>I/G 비트 (Individual/Group bit, I/G)</strong></td><td>첫 바이트의 최하위 비트: 0=유니캐스트, 1=멀티캐스트</td><td>IPv6 33:33, 멀티캐스트</td><td>필터링·스누핑·멀티캐스트 제어</td></tr><tr><td>운영/스위칭</td><td><strong>MAC 테이블 (MAC Address Table)</strong></td><td>스위치의 MAC↔포트 매핑 정보 (CAM/FDB)</td><td>학습·플러딩·에이징</td><td>포워딩 최적화·장애 추적</td></tr><tr><td>운영/스위칭</td><td><strong>MAC 학습 (MAC Learning)</strong></td><td>수신 프레임의 출발지 MAC 을 포트에 매핑하여 학습</td><td>플러딩, 필터링</td><td>자동 포워딩 경로 형성</td></tr><tr><td>운영/스위칭</td><td><strong>에이징 시간 (Aging Time)</strong></td><td>비활성 MAC 엔트리 제거 타이머</td><td>MAC 테이블 관리</td><td>메모리/성능 최적화</td></tr><tr><td>운영/스위칭</td><td><strong>MAC 플래핑 (MAC Flapping)</strong></td><td>동일 MAC 이 여러 포트에서 번갈아 학습되는 현상</td><td>루프, STP</td><td>루프/이중화 오류 진단</td></tr><tr><td>무선</td><td><strong>BSSID (Basic Service Set Identifier, BSSID)</strong></td><td>802.11 BSS 의 고유 48 비트 식별자 (보통 AP 인터페이스 MAC)</td><td>SSID, 로밍</td><td>AP 구분·채널 최적화</td></tr><tr><td>보안</td><td><strong>MAC 스푸핑 (MAC Spoofing)</strong></td><td>MAC 을 임의값으로 변조해 신원을 위장하는 행위</td><td>LAA, 랜덤화</td><td>NAC/802.1X 필요성</td></tr><tr><td>보안</td><td><strong>포트 보안 (Port Security)</strong></td><td>포트별 허용 MAC 수/목록 제한</td><td>Sticky MAC</td><td>유입 제어·위협 차단</td></tr><tr><td>보안</td><td><strong>802.1X (Port-Based Network Access Control, 802.1X)</strong></td><td>포트 기반 인증 표준 (EAP/RADIUS 연계)</td><td>EAP-TLS, NAC</td><td>기업 망 접근 제어</td></tr><tr><td>관측</td><td><strong>ARP 테이블 (Address Resolution Protocol Table, ARP)</strong></td><td>IP↔MAC 매핑 테이블</td><td>RFC 826</td><td>L3-L2 해석·트러블슈팅</td></tr><tr><td>관측</td><td><strong>BRIDGE-MIB (BRIDGE Management Information Base, BRIDGE-MIB)</strong></td><td>SNMP 로 FDB(MAC–포트) 노출</td><td>dot1dTpFdbAddress</td><td>자산/이동 추적·감사</td></tr><tr><td>오버레이</td><td><strong>EVPN (Ethernet VPN, EVPN)</strong></td><td>BGP 제어평면으로 MAC/IP 라우트 광고 (Type-2 등)</td><td>VXLAN, ARP 억제</td><td>DC/클라우드 대규모 L2</td></tr><tr><td>오버레이</td><td><strong>VXLAN (Virtual eXtensible LAN, VXLAN)</strong></td><td>L2-over-L3(UDP) 캡슐레이션, VNI 기반 격리</td><td>EVPN</td><td>멀티테넌시·확장성</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://standards.ieee.org/ieee/802.11/7028/>IEEE 802.11 표준 (IEEE SA)</a>.</li><li><a href=https://regauth.standards.ieee.org/standards-ra-web/pub/view.html>IEEE Registration Authority — Public listing</a>.</li><li><a href=https://standards.ieee.org/products-programs/regauth/mac/>IEEE Registration Authority — MAC Addresses 안내 페이지</a>.</li><li><a href=https://standards.ieee.org/wp-content/uploads/import/documents/tutorials/eui.pdf>IEEE RA: Guidelines for Use of EUI/OUI/CID (EUI 가이드 PDF)</a>.</li><li><a href=https://tools.ietf.org/html/rfc826>RFC 826 — ARP (Ethernet Address Resolution Protocol)</a>.</li><li><a href=https://datatracker.ietf.org/doc/html/rfc7042>RFC 7042 — IANA/IETF 사용을 위한 IEEE 802 파라미터 안내</a>.</li><li><a href=https://www.rfc-editor.org/info/rfc2464>RFC 2464 — IPv6 over Ethernet (RFC Editor)</a>.</li><li><a href=https://www.rfc-editor.org/info/rfc4291>RFC 4291 — IPv6 주소 구조 (RFC Editor)</a>.</li><li><a href=https://www.rfc-editor.org/info/rfc7217>RFC 7217 — IPv6 의미 불투명 IID (Privacy Extensions 관련)</a>.</li><li><a href=https://1.ieee802.org/security/802-1ar/>IEEE 802.1AR — Secure Device Identity (DevID)</a>.</li><li><a href=https://support.apple.com/guide/security/privacy-features-connecting-wireless-networks-secb9cb3140c/web>Apple Support — Wi-Fi 연결 시 프라이버시 기능 안내</a>.</li><li><a href=https://opennetworking.org/software-defined-standards/specifications/>Open Networking Foundation — SDN 기술/사양 (OpenFlow 등)</a>.</li><li><a href=https://www.nist.gov/cyberframework>NIST Cybersecurity Framework</a>.</li><li><a href=https://www.wireshark.org/docs/>Wireshark Documentation</a>.</li></ul><hr></div></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2026 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>