<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Event Broker | hyunyoun's Blog</title><meta name=keywords content="Systems-and-Infrastructure,Infrastructure,Infrastructure-Components,Messaging-Systems,Event-Brokers-vs-Message-Brokers,Event-Broker"><meta name=description content="이벤트 브로커는 이벤트 발행자와 구독자 간의 메시지 교환을 중개하는 미들웨어로, 비동기 통신, 실시간 데이터 분배, 서비스 간 결합도 감소, 확장성 및 장애 복원력을 제공한다. Pub/Sub, 스트리밍, 다양한 QoS(서비스 품질) 와 같은 고급 기능을 지원하며, 현대 백엔드 아키텍처의 핵심 역할을 담당한다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/networking--protocols/communication-patterns/message-infrastructure/message-brokers-vs-event-brokers/event-broker/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/networking--protocols/communication-patterns/message-infrastructure/message-brokers-vs-event-brokers/event-broker/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/networking--protocols/communication-patterns/message-infrastructure/message-brokers-vs-event-brokers/event-broker/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Event Broker"><meta property="og:description" content="이벤트 브로커는 이벤트 발행자와 구독자 간의 메시지 교환을 중개하는 미들웨어로, 비동기 통신, 실시간 데이터 분배, 서비스 간 결합도 감소, 확장성 및 장애 복원력을 제공한다. Pub/Sub, 스트리밍, 다양한 QoS(서비스 품질) 와 같은 고급 기능을 지원하며, 현대 백엔드 아키텍처의 핵심 역할을 담당한다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-07-18T05:58:00+00:00"><meta property="article:modified_time" content="2025-07-18T05:58:00+00:00"><meta property="article:tag" content="Systems-and-Infrastructure"><meta property="article:tag" content="Infrastructure"><meta property="article:tag" content="Infrastructure-Components"><meta property="article:tag" content="Messaging-Systems"><meta property="article:tag" content="Event-Brokers-vs-Message-Brokers"><meta property="article:tag" content="Event-Broker"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Event Broker"><meta name=twitter:description content="이벤트 브로커는 이벤트 발행자와 구독자 간의 메시지 교환을 중개하는 미들웨어로, 비동기 통신, 실시간 데이터 분배, 서비스 간 결합도 감소, 확장성 및 장애 복원력을 제공한다. Pub/Sub, 스트리밍, 다양한 QoS(서비스 품질) 와 같은 고급 기능을 지원하며, 현대 백엔드 아키텍처의 핵심 역할을 담당한다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Event Broker","item":"https://buenhyden.github.io/posts/networking--protocols/communication-patterns/message-infrastructure/message-brokers-vs-event-brokers/event-broker/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Event Broker","name":"Event Broker","description":"이벤트 브로커는 이벤트 발행자와 구독자 간의 메시지 교환을 중개하는 미들웨어로, 비동기 통신, 실시간 데이터 분배, 서비스 간 결합도 감소, 확장성 및 장애 복원력을 제공한다. Pub/Sub, 스트리밍, 다양한 QoS(서비스 품질) 와 같은 고급 기능을 지원하며, 현대 백엔드 아키텍처의 핵심 역할을 담당한다.","keywords":["Systems-and-Infrastructure","Infrastructure","Infrastructure-Components","Messaging-Systems","Event-Brokers-vs-Message-Brokers","Event-Broker"],"articleBody":"Event Broker 이벤트 브로커는 이벤트 기반 아키텍처에서 이벤트 발행자 (Producer) 와 구독자 (Consumer) 사이의 이벤트 메시지 흐름을 중개하는 미들웨어이다.\n분산 마이크로서비스 환경에서 데이터 흐름의 실시간성, 비동기성, 확장성을 확보할 수 있도록 지원한다. 대용량 실시간 데이터 처리와 시스템 간의 결합도 감소, 장애 격리 및 이벤트 아카이빙 등 다양한 장점으로 인해 오늘날 IT 인프라에서 매우 중요한 역할을 차지한다.\n이벤트 브로커는 Pub/Sub, 스트리밍, 다양한 QoS, 보안, 트랜잭션, 확장성, 장애 복구 등 다양한 기능을 제공하며, 시스템 간 결합도를 낮추고, 실시간 데이터 분배와 비동기 처리를 지원한다.\n대표 솔루션으로는 Solace, Kafka, AWS EventBridge, Azure Event Grid 등이 있으며, 다양한 산업에서 실시간 분석, 알림, IoT, 마이크로서비스 통합 등 광범위하게 활용된다.\nSource: https://developer.confluent.io/patterns/event-stream/event-broker/\n배경 Event Broker 는 다음과 같은 기술적 요구사항과 발전 과정을 통해 등장했다:\n분산 시스템의 복잡성 증가\n마이크로서비스 아키텍처의 확산 시스템 간 상호 의존성 증가 동기식 통신의 한계 극복 필요성 실시간 데이터 처리 요구 증가\nIoT 디바이스의 폭발적 증가 실시간 분석 및 대응 시스템 구축 필요 스트리밍 데이터 처리 패러다임 변화 기존 메시지 브로커의 한계\n지점 간 통신 중심의 설계 메시지 지속성과 재처리 어려움 확장성과 처리량의 제약 목적 및 필요성 시스템 분리 (Decoupling)\n이벤트 생산자와 소비자의 완전한 분리 시간적, 공간적 분리를 통한 유연성 확보 의존성 최소화로 독립적인 개발 및 배포 가능 확장성 향상 (Scalability)\n수평적 확장을 통한 처리 능력 증대 동적 확장 및 축소 지원 워크로드 분산을 통한 효율성 개선 내결함성 보장 (Fault Tolerance)\n시스템 일부 장애가 전체에 미치는 영향 최소화 자동 복구 및 재시도 메커니즘 데이터 손실 방지를 위한 지속성 보장 실시간 반응성 (Real-time Responsiveness)\n이벤트 발생 즉시 관련 시스템들의 반응 배치 처리 대비 현저한 지연시간 단축 동적 비즈니스 요구사항에 신속한 대응 핵심 개념 Event Broker는 이벤트를 발행 (Publish) 하는 서비스와 이를 구독 (Subscribe) 하는 소비자 사이에서 중계자 역할을 하는 시스템 구성 요소다.\n기본 개념 이벤트 (Event)\n시스템에서 발생하는 상태 변화를 나타내는 메시지 불변성 (Immutable) 특성을 가지며 과거에 발생한 사실을 기록 이벤트 헤더 (메타데이터) 와 이벤트 페이로드 (실제 데이터) 로 구성 발행 - 구독 패턴 (Publish-Subscribe Pattern)\n이벤트 발행자 (Publisher) 와 구독자 (Subscriber) 간의 비동기 통신 모델 발행자는 구독자의 존재를 알 필요가 없는 완전한 분리 토픽 (Topic) 기반의 이벤트 분류 및 라우팅 토픽 (Topic)\n이벤트를 분류하고 라우팅하는 논리적 채널 계층적 구조를 통한 효율적인 이벤트 관리 와일드카드를 활용한 구독 패턴 지원 이벤트 스트림 (Event Stream)\n시간 순서로 정렬된 이벤트들의 연속된 흐름 내구성과 재처리 가능성을 제공 실시간 및 배치 처리 모두 지원 실무 구현을 위한 핵심 연관성 확장성 측면:\n수평적 확장을 통한 처리량 증대 파티셔닝을 통한 병렬 처리 지원 로드 밸런싱과 백프레셔 관리 신뢰성 측면:\n이벤트 지속성과 복제를 통한 데이터 안정성 정확히 한 번 처리 (Exactly-once processing) 보장 장애 복구 및 재시작 메커니즘 성능 측면:\n비동기 처리를 통한 응답성 향상 배치 처리와 압축을 통한 효율성 개선 메모리 및 디스크 최적화 주요 기능 및 역할 Event Broker 는 다음과 같은 핵심 기능들을 수행한다:\n이벤트 수집 및 수신 (Event Ingestion)\n다양한 소스로부터 이벤트 수집 이벤트 검증 및 스키마 확인 처리량 조절 및 백프레셔 관리 이벤트 라우팅 및 분배 (Event Routing \u0026 Distribution)\n토픽 기반의 이벤트 분류 구독 패턴에 따른 선택적 배포 다중 소비자 지원 이벤트 지속성 (Event Persistence)\n내구성 있는 이벤트 저장 복제를 통한 데이터 안정성 히스토리 데이터 관리 이벤트 순서 보장 (Event Ordering)\n파티션 내 순서 보장 글로벌 순서 제어 옵션 타임스탬프 기반 정렬 특징 비동기 통신 (Asynchronous Communication)\n논블로킹 이벤트 전송 생산자와 소비자의 독립적 처리 시스템 응답성 향상 높은 처리량 (High Throughput)\n대용량 이벤트 스트림 처리 배치 처리 및 압축 최적화 병렬 처리 지원 내결함성 (Fault Tolerance)\n자동 장애 감지 및 복구 다중 복제본 관리 네트워크 파티션 내성 확장성 (Scalability)\n수평적 확장 지원 동적 파티션 관리 로드 밸런싱 핵심 원칙 이벤트 불변성 (Event Immutability)\n한 번 기록된 이벤트는 변경되지 않음 히스토리 추적 및 감사 가능 데이터 일관성 보장 최소한의 브로커 (Dumb Broker, Smart Client)\n브로커는 단순한 전달 역할에 집중 클라이언트가 복잡한 로직 처리 성능과 확장성 최적화 토픽 기반 라우팅 (Topic-based Routing)\n논리적 채널을 통한 이벤트 분류 계층적 토픽 구조 지원 와일드카드 구독 패턴 주요 원리 및 작동 방식 다음은 Event Broker 의 핵심 작동 원리를 보여주는 다이어그램입니다:\ngraph TB subgraph \"Event Producers\" P1[Producer 1Web Application] P2[Producer 2Mobile App] P3[Producer 3IoT Sensor] end subgraph \"Event Broker Cluster\" EB1[Event Broker 1Partition A] EB2[Event Broker 2Partition B] EB3[Event Broker 3Partition C] EB1 -.-\u003e|Replication| EB2 EB2 -.-\u003e|Replication| EB3 EB3 -.-\u003e|Replication| EB1 end subgraph \"Topics\" T1[user.events] T2[order.events] T3[sensor.data] end subgraph \"Event Consumers\" C1[Consumer 1Analytics Service] C2[Consumer 2Notification Service] C3[Consumer 3Inventory Service] C4[Consumer 4ML Pipeline] end P1 --\u003e|Publish| EB1 P2 --\u003e|Publish| EB2 P3 --\u003e|Publish| EB3 EB1 --\u003e T1 EB2 --\u003e T2 EB3 --\u003e T3 T1 --\u003e|Subscribe| C1 T1 --\u003e|Subscribe| C2 T2 --\u003e|Subscribe| C3 T3 --\u003e|Subscribe| C4 style EB1 fill:#f9f,stroke:#333,stroke-width:2px style EB2 fill:#f9f,stroke:#333,stroke-width:2px style EB3 fill:#f9f,stroke:#333,stroke-width:2px 작동 원리 설명:\n이벤트 발행: 프로듀서들이 다양한 토픽으로 이벤트를 발행 파티셔닝: 이벤트가 파티션별로 분산 저장 복제: 내결함성을 위한 데이터 복제 구독 및 소비: 컨슈머들이 관심 있는 토픽을 구독하여 이벤트 소비 구조 및 아키텍처 graph TB subgraph \"Client Layer\" PC[Producer Clients] CC[Consumer Clients] end subgraph \"Event Broker Infrastructure\" subgraph \"Broker Cluster\" B1[Broker Node 1] B2[Broker Node 2] B3[Broker Node 3] end subgraph \"Storage Layer\" S1[Segment 1] S2[Segment 2] S3[Segment 3] end subgraph \"Coordination Service\" ZK[ZooKeeper/RaftMetadata Management] end end subgraph \"Monitoring \u0026 Management\" M1[Metrics Collection] M2[Health Monitoring] M3[Configuration Management] end PC -.-\u003e|Produce Events| B1 PC -.-\u003e|Produce Events| B2 PC -.-\u003e|Produce Events| B3 B1 -.-\u003e|Consume Events| CC B2 -.-\u003e|Consume Events| CC B3 -.-\u003e|Consume Events| CC B1 \u003c--\u003e S1 B2 \u003c--\u003e S2 B3 \u003c--\u003e S3 B1 \u003c--\u003e ZK B2 \u003c--\u003e ZK B3 \u003c--\u003e ZK B1 --\u003e M1 B2 --\u003e M2 B3 --\u003e M3 구성요소 구분 구성요소 기능 역할 특징 필수 브로커 노드 (Broker Nodes) 이벤트 수신, 저장, 배포 클라이언트 요청 처리 및 데이터 흐름 관리 상태 비저장 설계, 수평 확장성 뛰어남 스토리지 레이어 (Storage Layer) 이벤트의 영구 저장 및 복제 데이터의 내구성 및 일관성 보장 로그 기반 저장 또는 분산 파일 시스템 활용 메타데이터 관리자 (Metadata Manager) 토픽, 파티션, 브로커 정보 관리 클러스터 상태 유지 및 리더 선출 분산 합의 알고리즘 (Raft, Zookeeper 등) 활용 클라이언트 라이브러리 (Client Libraries) 프로듀서/컨슈머 API 제공 이벤트 송수신, 네트워크 통신 처리 다양한 언어 지원, 직렬화/역직렬화 포함 선택 스키마 레지스트리 (Schema Registry) 이벤트 스키마 관리 및 검증 데이터 호환성 유지 및 스키마 진화 관리 Avro, Protobuf 등과 연계, 중앙 집중 스키마 관리 커넥터 (Connectors) 외부 시스템과의 연결 (입출력) DB, MQ, 파일 등 외부 소스/싱크 연동 플러그인 기반 확장, Kafka Connect 등에서 활용 스트림 프로세싱 엔진 (Stream Processing Engine) 실시간 이벤트 변환 및 집계 복잡 이벤트 처리 (CEP), 데이터 파이프라인 구성 상태 기반 처리, 타임 윈도우, join, 필터링 등 지원 모니터링 시스템 (Monitoring System) 성능 지표 수집 및 시각화 시스템 운영 상태 추적 및 이상 탐지 Prometheus, Grafana, Alertmanager 등 연계 가능 구현 기법 카테고리 구현 기법 정의 / 구성 요소 주요 목적 실제 예시 시스템 / 시나리오 1. 메시징 모델 Pub/Sub 모델 Publisher, Subscriber, Topic 구조 느슨한 결합, 1:N 메시지 분배, 실시간 알림 Kafka, Pulsar, SNS, EventBridge Queue 기반 모델 Queue, Consumer, Acknowledge 순차적 소비, 1:1 메시지 처리, 작업 큐 RabbitMQ, Amazon SQS Topic 기반 분류 Topic, 파티션 키, Subscription Rule 논리적 구분, 멀티 이벤트 처리, 토픽 기반 라우팅 Kafka Topics: order.created 등 2. 저장 구조 로그 기반 스토리지 Append-only log, Segment, Offset, Index 고성능 순차적 저장, 이벤트 보존 Kafka log, Redpanda, EventStoreDB 이벤트 소싱 모든 변경 이벤트 기록, 상태 재구성 감사/추적, 데이터 복구 및 리플레이 Kafka + Snapshot 기반 시스템 3. 데이터 처리 방식 스트림 처리 Continuous ingestion, Time window, State Management 실시간 분석, CEP, 복잡 이벤트 흐름 처리 Flink, Kafka Streams, Spark Streaming Event Filtering / Routing Rule-based 조건 필터링, 이벤트 패턴 매칭 조건별 라우팅, 멀티 서비스 이벤트 전달 최적화 AWS EventBridge Rule, Solace 4. 확장성 및 병렬성 파티셔닝 (Partitioning) Partition Key, Hashing, Leader-Follower 구조 병렬 처리, 확장성 확보, 소비자 그룹 분산 처리 Kafka 파티션 설계 (user_id 기반) 5. 신뢰성과 복원력 복제 (Replication) 리더 - 팔로워, ISR, 동기/비동기 복제 내결함성, 데이터 유실 방지, 고가용성 Kafka replication factor = 3 QoS / Delivery Guarantee At-most/At-least/Exactly-once 설정 중복 방지, 메시지 손실 방지 Kafka Idempotent Producer, SQS 설정 6. 시스템 안정성 백프레셔 관리 버퍼링, 쓰로틀링, 배치 크기 조정, Flow Control 소비자 병목 방지, 처리율 제어, 장애 확산 방지 Kafka producer linger.ms, 쓰로틀링 정책 7. 인터페이스 / 통합 서버리스 연동 Event → Function Trigger (Lambda/FaaS) 비용 최적화, 온디맨드 처리, 코드 간소화 AWS EventBridge + Lambda 커넥터 (Connectors) Source/Sink 플러그인, 외부 시스템 연동 DB, MQ, 파일 시스템 통합 자동화 Kafka Connect, Debezium 8. 메시지 구조 관리 스키마 레지스트리 Avro/Protobuf 스키마 등록 및 검증 스키마 호환성, 데이터 정합성 유지, 포맷 진화 관리 Confluent Schema Registry 장점 카테고리 장점 항목 설명 1. 아키텍처 유연성 시스템 분리 및 느슨한 결합 Pub/Sub 모델을 통해 Producer 와 Consumer 간 직접 연결 없이 독립적으로 개발·배포 가능 유연한 통합 구조 마이크로서비스, 서버리스, 이벤트 기반 워크플로우에 자연스럽게 통합 가능 2. 확장성과 성능 수평 확장성 파티셔닝과 소비자 그룹을 활용한 병렬 처리 가능, 처리량 증가 시 노드 추가만으로 선형 확장 가능 고성능 실시간 처리 이벤트 발생 직후 소비자에게 비동기 전달되어 밀리초 단위 반응 가능 3. 신뢰성 및 복원력 내결함성 (Fault Tolerance) 복제 및 분산 구조를 통해 단일 장애점 제거, 장애 발생 시 자동 복구 가능 장애 격리성 개별 Consumer 장애가 전체 시스템에 영향을 주지 않음 (Fail-safe 구조) 4. 데이터 재사용성 이벤트 재처리 가능 로그 기반 저장을 통해 과거 이벤트 재소비 가능, A/B 테스트·ML 재훈련·재처리 가능 감사 및 추적 용이성 이벤트 로그가 감사 기록으로 활용 가능, 보안/회계/컴플라이언스 측면에서 유용 5. 플랫폼 호환성 이기종 시스템 통합 다양한 언어/OS/프로토콜 지원으로 이기종 플랫폼 간 통합이 용이함 표준 인터페이스 지원 Kafka, MQTT, AMQP, HTTP 등 다양한 표준 프로토콜 지원 6. 개발 생산성 비동기 이벤트 흐름 설계 용이 도메인 중심 이벤트 설계로 비즈니스 로직 분리, 개발 속도 및 테스트 용이성 증가 단점과 문제점 그리고 해결방안 단점 항목 설명 해결방안 복잡성 증가 분산 시스템의 구조/운영/디버깅 난이도 증가 자동화된 모니터링 도구 도입 (Prometheus, Grafana), 표준 운영 가이드 수립, 통합 관제 적용 이벤트 흐름 추적 어려움 이벤트가 브로커를 거쳐 다수 소비자에게 비동기 전달되므로 호출 흐름 추적 어려움 분산 트레이싱 도입 (OpenTelemetry, Zipkin, Jaeger 등) 테스트 복잡성 비동기 흐름/멀티 소비자 구조로 인해 E2E 테스트 난이도 ↑ Consumer-driven contract test 도입, 테스트 환경에서 모킹 처리 순서 보장 제약 멀티 파티션 또는 다중 노드 분산 구조로 인해 글로벌 순서 보장 어려움 파티션 키 고정, 동일 파티션 내 메시지 처리 또는 메시지 순서 보정 로직 추가 지연 가능성 비동기 전파, 네트워크 병목, 소비자 지연 등으로 실시간성 저하 워커 증설, Backpressure 제어, 파티션 분산 튜닝, 적절한 batch 설정 비용 증가 메시지 로그 저장, 고가용성 구성, 멀티 AZ 구성 등으로 인해 인프라 비용 증가 스토리지 압축, Retention 정책 설정, 적절한 파티션/리소스 할당 스키마 진화 어려움 이벤트 구조 변경 시 하위 호환성 문제가 발생 가능 Schema Registry 도입, backward-compatible 설계, 버전 관리 정책 수립 문제점 항목 원인 영향 탐지 및 진단 예방 방법 해결 방법 및 기법 메시지 손실 브로커 장애, ACK 누락, 재시도 미구현 기능 누락, 데이터 정합성 훼손 메시지 카운트, 로그 분석 복제, Durable Storage, 멀티 AZ 구성 ACK 기반 처리, DLQ 구성, 메시지 재전송 로직 적용 순서 불일치 멀티 파티션 또는 브로커 간 분산 처리 상태 불일치, 이벤트 순서 오류 파티션별 로그, 순서 체크 동일 파티션 키 지정, 순서 보장 전략 수립 정렬 로직 적용, 단일 파티션 구성 또는 메시지 재정렬 이벤트 중복 재전송, 리플레이 시 중복 처리 발생 가능 데이터 중복, 트리거 중복 수행 중복 카운터, ID 추적 멱등성 키 (Idempotent ID) 도입 중복 제거 로직 구현, 상태 기반 메시지 필터링 처리 지연 소비자 처리 속도 저하, 병목 발생 실시간 처리 실패, SLA 미준수 TPS/Lag 모니터링, 지연 알림 병렬 컨슈머 증설, 네트워크 최적화 Auto-scaling, Queue 병렬 처리, 리밸런싱 적용 파티션 핫스팟 특정 파티션으로 키가 집중되어 부하 편중 파티션 과부하, 병목 발생 파티션별 메시지 처리량 분석 해시 기반 분산 키 전략, 키 재설계 파티션 수 증가, 샤딩 적용, 키 분산 재조정 데이터 유실 저장소 고장, ACK 누락, 버퍼 유실 등 중요 이벤트 소실 로그, 모니터링, Lag 확인 Replication, 장애 감지 자동화 재시도, 메시지 영속화, 장애 감지 후 자동 복구 도전 과제 카테고리 주요 이슈 (도전 과제) 원인 또는 상황 영향 또는 리스크 해결 및 대응 전략 확장성/성능 대규모 트래픽 및 이벤트 증가 데이터 폭증, 소비자 증가, 불균형 파티션 처리 지연, 처리 실패, 브로커 과부하 자동 스케일링, 파티셔닝 키 설계, Backpressure 제어, 멀티 브로커 구성 일관성/순서 이벤트 순서 보장/정합성 유지 어려움 분산 환경의 병렬 처리, CAP 제약 상태 기반 처리 오류, 정합성 훼손 파티션 키 기반 순서 관리, Outbox 패턴, CDC 연동, SAGA/보상 트랜잭션 설계 운영 복잡성 다수 컴포넌트 간의 의존성과 복잡한 트레이싱 Pub/Sub 기반 구조, 호출 체인 없음 장애 원인 파악 지연, 운영 비용 증가 OpenTelemetry, 분산 트레이싱 도입, 통합 모니터링 대시보드 구축, GitOps 기반 운영 자동화 신뢰성/내구성 메시지 유실 및 중복 처리 위험 네트워크 장애, 브로커 장애, ACK 실패 데이터 불일치, 시스템 신뢰도 하락 메시지 리텐션 설정, DLQ(Dead Letter Queue), 중복 제거 처리 (Idempotency) 보안/규정 민감 정보 노출 및 무단 접근 가능성 멀티 브로커, 네트워크 기반 전송, 인증 미비 데이터 유출, 법적 이슈 발생 종단간 암호화 (TLS), 인증·인가 적용, RBAC 정책, GDPR/ISMS 등 컴플라이언스 대응 표준화/호환성 메시지 포맷 불일치 및 Schema 충돌 Producer 간 형식 다양성, 사전 합의 부재 Consumer 오류, 이벤트 파싱 실패 Schema Registry 도입 (e.g., Avro, Protobuf), 계약 기반 개발 (Contract-First) 적용 비용/최적화 과도한 이벤트 발행 및 무분별한 트리거링 잘못된 트리거 설계, 이벤트 필터 부재 처리 비용 증가, 리소스 낭비 필터링/샘플링 적용, Rate Limit 설정, 불필요 이벤트 차단 전략 (Pre-filter, Rule 기반 조건 설계 등) 데이터 연계성 관계형 DB 와 이벤트 연계 시 정합성 유지 어려움 트랜잭션과 이벤트 발행의 시간 차, 원자성 미보장 데이터 정합성 훼손, 장애 시 복구 복잡화 Outbox Pattern, Transactional Outbox + Polling Publisher, Eventual Consistency 설계 적용 분류 기준에 따른 종류 및 유형 분류 기준 유형 설명 대표 기술/예시 1. 배포 방식 온프레미스 (On-premise) 조직 내 자체 인프라에서 직접 설치/운영 Apache Kafka, RabbitMQ, NATS 클라우드 관리형 (Managed Service) CSP 가 운영하며 확장성/가용성 자동 제공 AWS EventBridge, Azure Event Grid, GCP Pub/Sub 하이브리드 온프레미스와 클라우드의 통합 운영 Confluent Platform 2. 처리 모델 Pull 기반 소비자가 직접 메시지를 가져감 (polling) Kafka Consumer, SQS Push 기반 브로커가 컨슈머로 직접 메시지 전달 EventBridge → Lambda 3. 메시지 전달 보장 (QoS) At-most-once 최대 1 회 전달, 유실 가능성 있음 빠른 처리 우선 시 사용 At-least-once 중복 허용, 데이터 손실 없음 Kafka 기본 동작, RabbitMQ Exactly-once 정확히 한 번 처리, 높은 복잡도 Kafka Transactions 4. 메시징 패턴 Point-to-Point 1:1 통신, 작업 큐 모델 RabbitMQ Queue Publish-Subscribe 1:N 통신, 구독자 모두에게 메시지 전달 Kafka, MQTT Request-Reply 요청 후 응답 패턴, RPC 스타일 gRPC over Kafka, ZeroMQ 5. 아키텍처 구조 중앙 집중형 (Centralized) 단일 브로커 인스턴스/클러스터로 구성 RabbitMQ 단일 노드 분산형 (Distributed) 여러 노드로 구성된 클러스터 Kafka, Pulsar 메시 아키텍처 (Mesh) 브로커 간 직접 통신, 분산 라우팅 NATS, Solace, Kafka MirrorMaker 6. 저장 방식 In-memory 메시지를 메모리에만 저장, 휘발성 Redis PubSub Disk-based 디스크에 영속 저장, 재처리 가능 Kafka, RabbitMQ 하이브리드 메모리와 디스크 혼합 전략 Apache Pulsar 7. 메시지 처리 유형 스트리밍 (Streaming) 실시간 연속 처리 모델 Kafka Streams, Flink 배치 (Batch) 일괄 처리, 주기적 트리거 Spark Structured Streaming 8. 프로토콜 AMQP 고급 메시징 기능 지원, 표준화 RabbitMQ, ActiveMQ MQTT 경량 메시징, IoT 특화 Mosquitto, HiveMQ STOMP 텍스트 기반 단순 프로토콜 RabbitMQ (웹 통신용) Kafka Protocol 바이너리 TCP 기반 고성능 프로토콜 Apache Kafka 9. 메시지 저장 모델 큐 기반 (Queue-based) 메시지는 소비 후 삭제됨 RabbitMQ 로그 기반 (Log-based) 메시지는 로그로 저장되고 다중 소비 가능 Kafka, Pulsar 토픽 기반 (Topic-based) 메시지를 주제별로 분리/전파 Kafka, MQTT 10. 대표 제품 유형 메시지 브로커 (Message Broker) 큐 중심 메시징, 트랜잭션 지원 RabbitMQ, ActiveMQ 이벤트 브로커 (Event Broker) 이벤트 스트림, 로그 기반 처리 Kafka, EventStoreDB 서비스 버스 (Service Bus) 라우팅/변환/오케스트레이션 기능 포함 Azure Service Bus, NServiceBus Event Broker 기술별 비교 항목 구분 Apache Kafka AWS EventBridge Azure Event Grid Google Cloud Eventarc 형태 오픈소스, 자체 호스팅 (Self-Managed) Fully Managed (서버리스) Fully Managed (서버리스) Fully Managed (서버리스, Kubernetes 기반) 아키텍처 유형 Pull 기반 Consumer Group 구조 Rule 기반 이벤트 라우팅 + Push Event Subscription + HTTP Push Event Trigger + Cloud Run 연계 이벤트 보존 디스크 기반 로그 저장 (Retention 설정 가능) 기본 TTL 존재 (장기 저장 불가) 기본 TTL 존재 (수분~수시간 수준) 일시적 처리 (장기 보존 미지원) 필터링 기능 Consumer 애플리케이션 내부 처리 Event Pattern 기반 JSON 필터 고급 필터 (속성 기반, 주제 기반 등) 조건 필터 + 대상 서비스 조합 가능 성능 지표 수백만 TPS 이상, 고성능 스트리밍 수만 TPS 수준 수만 TPS 수준 수천~수만 TPS 수준 통합/연계성 외부 시스템 및 커스텀 애플리케이션과 유연한 연계 AWS 서비스 및 SaaS 연계 최적화 Azure 리소스 및 서드파티 연동 최적화 GCP 서비스 (Cloud Run, Function 등) 연동 최적화 재처리 지원 ✅ 오프셋 기반 재처리 (내구성 우수) ❌ 기본 미지원 (Lambda 재시도 설정 필요) ❌ 이벤트 재처리 구조 미제공 ❌ Cloud Run 재실행 필요 활용 사례 IoT 센서 수집, 대용량 로그 스트림 분석 주문 생성 → Lambda 트리거 Azure Blob 생성 → Logic App 실행 Firebase 등록 이벤트 → 메일 발송 강점 요약 고성능, 내구성, 재처리/순서보장/파티셔닝 지원 AWS 서비스 간 손쉬운 통합, 간단한 서버리스 워크플로우 고급 필터링 및 Azure 서비스 통합 Kubernetes 및 GCP 기반 서버리스 최적화 적합한 사용 시점 대용량 스트리밍, 재처리 필요, 멀티컨슈머 구조 간단한 이벤트 트리거 자동화, AWS SaaS 연동 리소스 이벤트 감지 및 처리 자동화 GCP 이벤트 기반 서버리스 파이프라인 구축 요약 구분 분석 결과 요약 Kafka 자체 호스팅 기반으로 고성능 이벤트 스트리밍, 이벤트 재처리, 내구성 요구 환경에 적합. 컨슈머 그룹으로 다중 처리 가능. 복잡하지만 유연함. AWS EventBridge AWS 환경에서 Lambda 등과 결합 시 매우 간단하게 이벤트 처리 가능. 서버리스와 SaaS 연동이 쉽고, 간단한 이벤트 기반 워크플로우에 최적. Azure Event Grid Azure 자원 이벤트 처리에 최적화되어 있으며, 고급 필터링 및 HTTP Push 연동 기능 강력. Logic App 과의 연계 유용. Google Eventarc GCP 내 Cloud Run 기반 서버리스 워크플로우 구성에 강점. Kubernetes 기반 워크플로우 또는 Firebase 등과의 연계에 특화. Event Broker 구축 예제 Kafka 를 사용하여 Event Broker 환경을 구축하고 간단한 Producer-Consumer 이벤트 흐름을 구현한다.\n구성:\nApache Kafka Python (kafka-python 라이브러리) 설치 준비\n1 2 3 4 5 6 7 8 9 # Kafka \u0026 Zookeeper 실행 (Docker 기반 예시) docker run -d --name zookeeper -p 2181:2181 zookeeper docker run -d --name kafka -p 9092:9092 \\ -e KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181 \\ -e KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://localhost:9092 \\ -e KAFKA_LISTENER_SECURITY_PROTOCOL_MAP=PLAINTEXT:PLAINTEXT \\ -e KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1 \\ --network=host \\ confluentinc/cp-kafka Python Producer 코드\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 # producer.py from kafka import KafkaProducer import json producer = KafkaProducer( bootstrap_servers='localhost:9092', value_serializer=lambda v: json.dumps(v).encode('utf-8') ) event = {'event_type': 'OrderCreated', 'order_id': 1234, 'user_id': 5678} producer.send('order-events', value=event) producer.flush() print(\"✅ OrderCreated 이벤트 전송 완료\") Python Consumer 코드\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 # consumer.py from kafka import KafkaConsumer import json consumer = KafkaConsumer( 'order-events', bootstrap_servers='localhost:9092', auto_offset_reset='earliest', group_id='order-service', value_deserializer=lambda m: json.loads(m.decode('utf-8')) ) for message in consumer: print(f\"✅ 수신된 이벤트: {message.value}\") Kafka 모니터링 지표 및 실전 대시보드 구성 Tool: Prometheus + Grafana\n주요 지표:\n지표 설명 kafka_server_brokertopicmetrics_messages_in_total 초당 수신 메시지 수 kafka_server_brokertopicmetrics_bytes_in_total 수신 바이트 수 kafka_server_brokertopicmetrics_bytes_out_total 전송 바이트 수 kafka_server_replicamanager_underreplicated_partitions 동기화 안된 파티션 수 kafka_network_requestmetrics_requests_total 총 네트워크 요청 수 kafka_controller_kafkacontroller_activecontrollercount 활성 컨트롤러 수 (1 이 아니면 비정상) kafka_log_logsize 토픽/파티션별 로그 사이즈 실전 대시보드 구성\nExporter 설치\nKafka 용 JMX Exporter 사용:\n1 2 java -javaagent:/opt/jmx_prometheus_javaagent.jar=7071:/opt/kafka.yml \\ -jar kafka-server-start.sh … Prometheus 설정 예시\n1 2 3 4 scrape_configs: - job_name: 'kafka' static_configs: - targets: ['localhost:7071'] Grafana 대시보드 템플릿\nID: 7589 (confluentinc 제공 Kafka Dashboard) 대시보드 포함 항목: 브로커별 처리량 파티션 상태 lag 상태 consumer group health 메시지 지연 현황 실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점 카테고리 고려사항 설명 권장사항 1. 토픽/파티션 설계 토픽 네이밍/구조 설계 도메인 중심의 계층적 토픽 설계가 필요함 도메인.이벤트명 규칙 적용 (order.created) 파티션 전략 및 수량 병렬성 확보, 순서 보장 위한 파티션 설계 키 기반 파티셔닝, 예상 처리량의 2~3 배로 설정 2. 메시지 일관성 메시지 순서 및 중복 처리 중복 소비/재처리 방지 및 순서 보장 필요 메시지 ID, 타임스탬프, 멱등 소비자 처리 멱등성 (Idempotency) 중복 이벤트 수신 시 상태 변화 방지 상태 조회 기반 멱등 처리 또는 상태머신 적용 3. 장애 복구 및 실패 처리 메시지 유실/지연 대응 브로커 장애, 소비자 실패 시 데이터 보호 DLQ 구성, Retry 전략, Replication 적용 메시지 재처리 장애 후 재처리 위한 이벤트 보존 필요 Kafka replay, TTL 기반 재전송 지원 4. 모니터링 및 가시성 이벤트 흐름 추적 및 문제 진단 흐름 시각화 및 에러 식별 필요 OpenTelemetry, Prometheus, Kafka UI 등 도입 실시간 지표 모니터링 처리량, 지연, 실패율 등 지표 확인 필요 APM, 알림, 대시보드 구축 5. 스키마 관리 이벤트 포맷 일관성 및 진화 전략 버전 충돌, 하위 호환성 문제 방지 필요 Schema Registry 도입, Avro/Protobuf 적용 필드 변경/추가 대응 소비자 호환성 유지 필요 backward-compatible 스키마 설계 6. 성능 최적화 배치 크기/지연 시간 조절 처리량과 응답 속도 간 균형 조정 필요 linger.ms, batch.size 등 튜닝 압축 및 캐싱 전송 및 저장 효율 향상 snappy/gzip 압축, 커넥션 풀, 메타데이터 캐시 7. 보안 및 접근 제어 인증/인가 메시지 접근 통제 및 식별자 관리 IAM, JWT, SASL, ACL 설정 암호화 데이터 전송/저장 보호 TLS/SSL 적용, 디스크 암호화 감사 및 감사 로그 접근/변경 기록 추적 감사 로그 수집 및 보존 정책 설정 8. 배포 및 인프라 전략 고가용성 구성 단일 장애점 제거 및 무중단 운영 멀티 AZ, 클러스터 구성, 자동 장애 조치 설정 자동 확장 트래픽 급증 대응 Horizontal Pod Autoscaler, KEDA 등 사용 백업 및 재해 복구 데이터 손실 방지 정기 백업 + 재해 복구 시나리오 문서화 9. 용량 및 트래픽 계획 메시지 양/트래픽 예측 리소스 부족 시 병목/지연 발생 가능성 예측 기반 스케일링, Kafka Cruise Control 도입 스토리지 최적화 이벤트 보존 설정과 디스크 용량 균형 보존 기간 조절, 압축 전략, 토픽 정리 10. 우선순위 및 QoS 중요도 기반 메시지 처리 긴급 메시지 우선 처리 필요 우선순위 큐, 별도 토픽/채널로 분리 QoS (전달 보장 수준) At-least-once vs Exactly-once 결정 필요 트랜잭션 + 멱등 프로듀서 설정 (Kafka 기준) 아키텍처 설계 시 고려 요소 고려 항목 설명 권장 사항 도메인 분리 이벤트는 업무 도메인 단위로 구성되어야 함 order.created, payment.success 등 명확한 이벤트 명명 이벤트 흐름 시각화 전체 이벤트 흐름을 설계 초기부터 도식화 Sequence Diagram, Event Map 활용 브로커 선택 워크로드와 운영 역량에 따라 선택 대규모 실시간: Kafka / 간단 자동화: EventBridge 스키마 관리 이벤트 스키마는 반드시 버저닝 및 관리 필요 Avro + Schema Registry 구성 필수 멱등성 처리 중복 이벤트에 안전한 설계 필요 이벤트 ID + 상태 기반 로직 설계 배포 전략 항목 전략 도구 브로커 배포 자체 운영 또는 매니지드 Kafka, AWS MSK, GCP Pub/Sub 메시지 소비자 배포 컨테이너 또는 서버리스 함수 Docker, Kubernetes, AWS Lambda 토픽/구독 설정 자동화 IaC 기반 구성 Terraform, AWS CDK, Azure Bicep 모니터링 연동 이벤트 지연/누락 추적 Prometheus, Datadog, Kafka Lag Exporter 보안 설정 IAM, 인증서, 메시지 암호화 TLS, VPC 연결, OAuth/JWT 인증 등 테스트 및 검증 전략 테스트 항목 설명 도구/기법 계약 기반 테스트 Producer 와 Consumer 간 메시지 형식 합의 Pact, Spring Cloud Contract 성능 테스트 TPS, 처리 지연, 이벤트 누락 여부 검증 JMeter, Locust, Kafka-producer-perf-test 오류 시나리오 브로커 장애, 네트워크 단절, 소비자 중단 Chaos Monkey, ToxiProxy 재처리 시나리오 이벤트 리플레이가 정상 동작하는지 Kafka Consumer Offset Reset 보안 테스트 인증 미비, 권한 우회 등 검증 IAM Role 테스트, 토픽 접근 제어 테스트 운영 자동화 및 모니터링 운영 항목 항목 모니터링 지표 도구 브로커 상태 CPU, Disk I/O, Partition Lag Prometheus + Grafana 이벤트 처리 지연 Consumer Lag, 처리 시간 Kafka Lag Exporter 이벤트 유실/중복 전송 실패율, DLQ 비율 AWS CloudWatch, Elastic 보안 감사 접근 로그, 인증 실패 로그 CloudTrail, Kafka Audit Logs 스키마 변경 추적 Schema version 변경, Incompatibility 감지 Confluent Schema Registry, diff 도구 자동화 요소 자동화 영역 방법 토픽 생성/관리 IaC (Terraform, CDK) 알림 설정 Slack, PagerDuty 연동 소비자 배포 파이프라인 GitOps, ArgoCD, GitHub Actions 리플레이 트리거 Kafka CLI, Lambda 트리거 구성 소비자 헬스체크 Kubernetes liveness/readiness probes 최적화하기 위한 고려사항 및 주의할 점 카테고리 고려사항 설명 권장사항 1. 메시지 처리 최적화 메시지 크기 제한 메시지가 너무 크면 브로커, 네트워크에 부하 발생 메시지 크기 제한 설정 (ex: 1~10MB), 대용량은 외부 저장소 활용, 압축 적용 배치 처리 개별 메시지 전송은 오버헤드 큼 linger.ms, batch.size 최적화, Consumer Poll 조정 압축 전략 네트워크 효율은 높이지만 CPU 부하 발생 Snappy, ZSTD 등 적절한 알고리즘 선택 및 압축 수준 조절 이벤트 경량화 메시지 내용 중 불필요 데이터 제거 Avro, Protobuf 등 경량 포맷 사용 2. 파티션/병렬성 설계 파티션 전략 파티션 수는 병렬성/순서 보장에 직접 영향 파티션 수 = 소비자 수 고려, 키 기반 파티션 전략 적용, 핫 파티션 방지 소비자 그룹 설계 잘못된 그룹 구성은 오히려 처리량 감소 병렬 처리 극대화를 위한 균형 잡힌 파티션 할당 스레드 및 워커 설정 스레드/워크자 수 부족 시 처리 병목 발생 멀티스레드 처리 또는 비동기 워커 활용 3. 네트워크/IO 최적화 네트워크 지연/대역폭 지역 간 전송, 느린 네트워크는 Latency 증가 브로커 - 클라이언트 근접 배치, TCP 튜닝, 전용 네트워크 고려 디스크 I/O 디스크 쓰기 지연은 메시지 저장 지연으로 직결 SSD 사용, 로그 세그먼트 최적화, I/O 스레드 분리 캐싱 전략 반복 요청/메타데이터 접근 비용 발생 클라이언트 메타데이터 캐싱, 캐시 무효화 정책 수립 4. 리소스 관리 및 인프라 CPU / 메모리 JVM, 네이티브 메모리 부족 시 GC, 성능 저하 유발 JVM 튜닝, 힙/버퍼 설정 최적화, 컨테이너 리소스 설정 조정 오토스케일링 고정 노드는 트래픽 급증에 대응 어려움 KEDA, AutoScalingGroup 등 자동 확장 구성 Broker 설정 기본 설정이 워크로드에 부적합할 수 있음 브로커당 처리량, 큐 크기, 내부 버퍼 최적화 5. 장애 복구/안정성 복제 전략 복제는 장애 복구에 중요하지만 과도하면 성능 저하 비동기 복제 활용, 적절한 ISR(In-Sync Replica) 수 설정 DLQ 구성 장애 메시지 처리 실패 시 무한 루프/손실 발생 위험 Dead Letter Queue 활용, 재시도 정책 적용 백프레셔 과부하 시 시스템 전체 성능 저하 Throttling, Circuit Breaker 패턴 도입 6. 운영 및 모니터링 모니터링 오버헤드 과도한 지표 수집은 처리 흐름에 부정적 영향 샘플링 적용, 핵심 지표만 수집, Prometheus, Datadog 활용 성능 지표 추적 Throughput, Latency, Lag 등 실시간 분석 필요 Grafana + Prometheus + Alertmanager 등 연계 장애 탐지/알림 장애 발생 시 빠른 대응 필수 자동화된 장애 감지 및 알림 시스템 구축 (예: AIOps 연동) 7. 보존 및 데이터 정책 메시지 보존 메시지를 너무 오래 저장하면 스토리지 비용 증가 주기적 만료 설정, Retention 정책 정의, 히스토리 백업 스토리지 관리 로그 누적이 디스크 병목을 유발할 수 있음 계층형 스토리지 구성 (hot/cold), 메시지 압축 활성화 실무 사용 예시 📌 적용 분야 대표 시나리오 사용 기술 주요 효과 1. 전자상거래 / 주문 처리 주문 이벤트 기반 멀티 서비스 처리 (결제, 재고, 배송 등) Kafka, RabbitMQ, SQS, Spring Boot, MongoDB 주문 워크플로우 비동기 처리, 확장성 확보 2. 실시간 알림 서비스 사용자 활동 (댓글, 좋아요 등) 에 대한 실시간 알림 Kafka, Redis PubSub, Solace, AWS SNS 실시간 반응형 UX, 빠른 알림 분배 3. IoT / 센서 네트워크 대규모 센서 데이터의 실시간 수집 및 처리 MQTT, Kafka, Google Eventarc, InfluxDB, Grafana 고빈도 이벤트 처리, 실시간 모니터링 4. 데이터 파이프라인 / 분석 데이터 이벤트 기반 스트리밍 처리 및 ELT 파이프라인 구성 Kafka Connect, Apache Flink, EventBridge, ELK, BigQuery 대용량 실시간 분석, ETL 자동화 5. 금융 / 거래 추적 실시간 결제 흐름, 사기 탐지, 거래 분석 Kafka, Flink, Elasticsearch, Apache Pulsar 트랜잭션 추적, 이상 탐지, 실시간 정합성 6. 마이크로서비스 통합 서비스 간 느슨한 결합 기반 비동기 이벤트 통신 Kafka, RabbitMQ, Azure Event Grid, Docker, Istio 독립적 배포, 서비스 확장 유연성 7. 로그 수집 및 모니터링 마이크로서비스의 로그/메트릭을 중앙 시스템으로 전송 Kafka, Fluentd, OpenTelemetry, Prometheus, Grafana 시스템 상태 가시성 향상, 장애 대응 8. 서버리스 자동화 클라우드 리소스 변경, 예약 이벤트에 따른 Lambda 트리거 실행 AWS EventBridge + Lambda, Azure Functions, GCP Eventarc 인프라 자동화, 코드 간소화 9. 실시간 사용자 추적 사용자의 웹/앱 활동 실시간 분석 및 추천 시스템 연결 Azure Event Hub, Kafka, Apache Spark, Snowflake Streams 행동 분석 기반 실시간 추천 강화 활용 사례 사례 1: IoT 센서 로그와 웹 서버 로그를 실시간으로 수집·분석 시스템 구성도\nflowchart LR IoT[IoT/웹서버] --\u003e Broker[Event Broker] Broker --\u003e Analyzer[Log Analyzer/Consumer] Broker --\u003e Storage[Raw Log 저장소] Analyzer --\u003e BI[DashBoard/Alert] Workflow\nIoT/웹서버에서 로그 이벤트 발생 → 브로커로 발행 브로커가 Analyzer(실시간 처리) 및 Storage(저장) 에 동시에 브로드캐스트 Analyzer 는 실시간 알림 또는 대시보드에 결과 전달 주제의 역할: 서로 다른 데이터 소스를 빠짐 없이 실시간 브로드캐스팅, 대용량 처리, 장애 시 재처리 가능\n유무 차이: 이벤트 브로커 없을 시, 다수 대상 동시 전달 힘들고 확장/유지보수 취약, 장애 전파 쉬움\n구현 예시:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # Kafka를 통한 이벤트 브로커 실습 예시 from kafka import KafkaProducer, KafkaConsumer # Producer - 이벤트 전송 producer = KafkaProducer(bootstrap_servers=['localhost:9092']) producer.send('log-events', b'{\"msg\":\"로그 수집 이벤트\"}') # Consumer - 이벤트 수신 consumer = KafkaConsumer( 'log-events', bootstrap_servers=['localhost:9092'], auto_offset_reset='earliest', group_id='log-analyzer' ) for message in consumer: print(f\"수신된 이벤트: {message.value.decode()}\") # 이곳에 실시간 분석 등 처리 준비 Producer 는 ’log-events’ 토픽에 메시지를 보내고, Consumer 는 같은 토픽을 구독하여 메시지를 실시간으로 소비/처리 사례 2: 이커머스 주문 시스템에서의 Event Broker 활용 시스템 구성:\nProducer: 주문 마이크로서비스 Broker: Apache Kafka Consumer: 재고 시스템 배송 시스템 알림 서비스 이벤트 로깅 (ELK) flowchart TD A[Order Service] --\u003e B[Kafka Topic: order.created] B --\u003e C[Inventory Service] B --\u003e D[Shipping Service] B --\u003e E[Notification Service] B --\u003e F[Analytics Dashboard] Workflow:\norder.created 이벤트가 Kafka 에 발행됨 Kafka 는 이를 다수 Consumer 에 브로드캐스트 각 Consumer 는 독립적으로 이벤트를 처리 (예: 배송 트리거, 알림 전송, 재고 차감) 역할 분석:\nEvent Broker는 Producer-Consumer 간 결합을 제거 복수 시스템에서 동시에 이벤트 소비 가능 Kafka 는 이벤트 로그를 유지하여 리플레이/장애 복구도 지원 유무 비교:\n항목 Event Broker 사용 미사용 시 이벤트 분기 다수 시스템 자동 처리 명시적 코드로 분기 필요 장애 대응 개별 서비스 영향 없음 동기 호출 시 전체 실패 가능성 확장성 새로운 소비자 즉시 추가 가능 기존 서비스 코드 수정 필요 구현 예시:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # Kafka Producer - 주문 이벤트 발행 from kafka import KafkaProducer import json producer = KafkaProducer( bootstrap_servers='localhost:9092', value_serializer=lambda v: json.dumps(v).encode('utf-8') ) order_event = { \"order_id\": 1001, \"status\": \"created\", \"timestamp\": \"2025-07-18T09:00:00Z\" } producer.send('order.created', value=order_event) producer.flush() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # Kafka Consumer - 배송 서비스 from kafka import KafkaConsumer import json consumer = KafkaConsumer( 'order.created', bootstrap_servers='localhost:9092', group_id='shipping-service', value_deserializer=lambda m: json.loads(m.decode('utf-8')) ) for msg in consumer: order = msg.value print(f\"배송 처리 시작 - 주문번호: {order['order_id']}\") # 배송 처리 로직 사례 3: 글로벌 전자상거래 플랫폼의 실시간 주문 처리 대형 전자상거래 플랫폼에서 Event Broker 를 활용하여 주문부터 배송까지의 전체 워크플로우를 실시간으로 처리하는 시스템을 구축한 사례.\n시스템 구성\ngraph TB subgraph \"Frontend Layer\" WEB[Web Application] MOBILE[Mobile App] API[API Gateway] end subgraph \"Event Broker Infrastructure\" KAFKA[Apache Kafka Cluster] end subgraph \"Microservices\" ORDER[Order Service] PAYMENT[Payment Service] INVENTORY[Inventory Service] SHIPPING[Shipping Service] NOTIFICATION[Notification Service] ANALYTICS[Analytics Service] end subgraph \"Data Storage\" ORDERDB[(Order DB)] INVENTORYDB[(Inventory DB)] USERDB[(User DB)] CACHE[(Redis Cache)] end WEB --\u003e API MOBILE --\u003e API API --\u003e ORDER ORDER --\u003e KAFKA PAYMENT --\u003e KAFKA INVENTORY --\u003e KAFKA SHIPPING --\u003e KAFKA KAFKA --\u003e ORDER KAFKA --\u003e PAYMENT KAFKA --\u003e INVENTORY KAFKA --\u003e SHIPPING KAFKA --\u003e NOTIFICATION KAFKA --\u003e ANALYTICS ORDER --\u003e ORDERDB INVENTORY --\u003e INVENTORYDB PAYMENT --\u003e USERDB NOTIFICATION --\u003e CACHE 워크플로우\nsequenceDiagram participant Customer participant OrderService participant EventBroker participant PaymentService participant InventoryService participant ShippingService participant NotificationService Customer-\u003e\u003eOrderService: 주문 요청 OrderService-\u003e\u003eEventBroker: order.created 이벤트 발행 EventBroker-\u003e\u003ePaymentService: 결제 처리 트리거 EventBroker-\u003e\u003eInventoryService: 재고 확인 트리거 PaymentService-\u003e\u003eEventBroker: payment.processed 이벤트 발행 InventoryService-\u003e\u003eEventBroker: inventory.reserved 이벤트 발행 EventBroker-\u003e\u003eShippingService: 배송 준비 트리거 EventBroker-\u003e\u003eNotificationService: 고객 알림 트리거 ShippingService-\u003e\u003eEventBroker: shipping.prepared 이벤트 발행 EventBroker-\u003e\u003eNotificationService: 배송 알림 트리거 NotificationService-\u003e\u003eCustomer: 주문 완료 알림 Event Broker 의 역할\n실시간 이벤트 라우팅: 주문 생성 시 관련된 모든 서비스에 즉시 알림 비동기 처리: 각 서비스가 독립적으로 작업을 수행하여 전체 응답 시간 단축 장애 격리: 한 서비스의 장애가 다른 서비스에 미치는 영향 최소화 확장성: 트래픽 증가 시 개별 서비스 확장 가능 Event Broker 유무에 따른 차이점\nEvent Broker 사용 시: 평균 주문 처리 시간: 2-3 초 시스템 간 결합도: 낮음 확장성: 개별 서비스 단위로 수평 확장 가능 장애 영향 범위: 제한적 Event Broker 미사용 시 (동기식 API 호출): 평균 주문 처리 시간: 8-12 초 시스템 간 결합도: 높음 확장성: 전체 시스템 단위로만 확장 가능 장애 영향 범위: 연쇄적 장애 발생 가능 구현 예시:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 import json import asyncio from typing import Dict, List, Callable, Any from dataclasses import dataclass, asdict from datetime import datetime import logging # 이벤트 클래스 정의 @dataclass class Event: \"\"\" 이벤트의 기본 구조를 정의하는 클래스 - topic: 이벤트가 발행될 토픽 - data: 이벤트 페이로드 데이터 - timestamp: 이벤트 발생 시각 - event_id: 이벤트 고유 식별자 \"\"\" topic: str data: Dict[str, Any] timestamp: datetime = None event_id: str = None def __post_init__(self): if self.timestamp is None: self.timestamp = datetime.now() if self.event_id is None: import uuid self.event_id = str(uuid.uuid4()) # Event Broker 핵심 클래스 class EventBroker: \"\"\" 이벤트 브로커의 핵심 기능을 구현하는 클래스 - 토픽 기반 이벤트 라우팅 - 비동기 이벤트 처리 - 구독자 관리 \"\"\" def __init__(self): self.subscribers: Dict[str, List[Callable]] = {} # 토픽별 구독자 목록 self.event_history: List[Event] = [] # 이벤트 히스토리 (재처리용) self.logger = logging.getLogger(__name__) async def publish(self, event: Event) -\u003e None: \"\"\" 이벤트를 지정된 토픽에 발행 - 이벤트 히스토리에 저장 (재처리 지원) - 해당 토픽의 모든 구독자에게 비동기 전달 \"\"\" self.logger.info(f\"Publishing event {event.event_id} to topic '{event.topic}'\") # 이벤트 히스토리에 저장 self.event_history.append(event) # 토픽의 구독자들에게 이벤트 전달 if event.topic in self.subscribers: tasks = [] for subscriber in self.subscribers[event.topic]: task = asyncio.create_task(self._deliver_event(subscriber, event)) tasks.append(task) # 모든 구독자에게 병렬로 이벤트 전달 await asyncio.gather(*tasks, return_exceptions=True) async def _deliver_event(self, subscriber: Callable, event: Event) -\u003e None: \"\"\" 개별 구독자에게 이벤트 전달 (내부 메서드) - 에러 핸들링 포함 - 재시도 로직 구현 가능 지점 \"\"\" try: if asyncio.iscoroutinefunction(subscriber): await subscriber(event) else: subscriber(event) except Exception as e: self.logger.error(f\"Error delivering event {event.event_id}: {e}\") # 실제 환경에서는 Dead Letter Queue로 전송 def subscribe(self, topic: str, callback: Callable) -\u003e None: \"\"\" 특정 토픽에 구독자 등록 - 와일드카드 패턴 지원 가능 - 구독자별 필터링 옵션 추가 가능 \"\"\" if topic not in self.subscribers: self.subscribers[topic] = [] self.subscribers[topic].append(callback) self.logger.info(f\"Subscriber registered for topic '{topic}'\") def unsubscribe(self, topic: str, callback: Callable) -\u003e None: \"\"\" 구독자 해제 \"\"\" if topic in self.subscribers: try: self.subscribers[topic].remove(callback) self.logger.info(f\"Subscriber unregistered from topic '{topic}'\") except ValueError: self.logger.warning(f\"Subscriber not found for topic '{topic}'\") async def replay_events(self, topic: str, from_timestamp: datetime = None) -\u003e None: \"\"\" 과거 이벤트 재처리 기능 - 특정 시점 이후의 이벤트 재처리 - A/B 테스트, 버그 수정 후 재처리 등에 활용 \"\"\" filtered_events = [ event for event in self.event_history if event.topic == topic and ( from_timestamp is None or event.timestamp \u003e= from_timestamp ) ] self.logger.info(f\"Replaying {len(filtered_events)} events for topic '{topic}'\") for event in filtered_events: await self.publish(event) # 실제 사용 예시: 전자상거래 주문 처리 class OrderService: \"\"\" 주문 서비스 구현 예시 - 주문 생성 시 이벤트 발행 \"\"\" def __init__(self, event_broker: EventBroker): self.event_broker = event_broker self.logger = logging.getLogger(self.__class__.__name__) async def create_order(self, order_data: Dict[str, Any]) -\u003e str: \"\"\" 주문 생성 및 이벤트 발행 \"\"\" order_id = f\"order_{datetime.now().strftime('%Y%m%d%H%M%S')}\" # 주문 데이터 저장 (DB 저장 로직) self.logger.info(f\"Order {order_id} created\") # 주문 생성 이벤트 발행 event = Event( topic=\"order.created\", data={ \"order_id\": order_id, \"customer_id\": order_data[\"customer_id\"], \"items\": order_data[\"items\"], \"total_amount\": order_data[\"total_amount\"] } ) await self.event_broker.publish(event) return order_id class PaymentService: \"\"\" 결제 서비스 구현 예시 - 주문 생성 이벤트 구독 - 결제 처리 후 이벤트 발행 \"\"\" def __init__(self, event_broker: EventBroker): self.event_broker = event_broker self.logger = logging.getLogger(self.__class__.__name__) # 주문 생성 이벤트 구독 self.event_broker.subscribe(\"order.created\", self.handle_order_created) async def handle_order_created(self, event: Event) -\u003e None: \"\"\" 주문 생성 이벤트 처리 \"\"\" order_data = event.data self.logger.info(f\"Processing payment for order {order_data['order_id']}\") # 결제 처리 로직 (실제로는 외부 결제 게이트웨이 연동) await asyncio.sleep(0.5) # 결제 처리 시뮬레이션 # 결제 완료 이벤트 발행 payment_event = Event( topic=\"payment.completed\", data={ \"order_id\": order_data[\"order_id\"], \"payment_status\": \"success\", \"transaction_id\": f\"txn_{datetime.now().strftime('%Y%m%d%H%M%S')}\" } ) await self.event_broker.publish(payment_event) class InventoryService: \"\"\" 재고 서비스 구현 예시 \"\"\" def __init__(self, event_broker: EventBroker): self.event_broker = event_broker self.logger = logging.getLogger(self.__class__.__name__) # 주문 생성 이벤트 구독 self.event_broker.subscribe(\"order.created\", self.handle_order_created) async def handle_order_created(self, event: Event) -\u003e None: \"\"\" 주문 생성 시 재고 확인 및 예약 \"\"\" order_data = event.data self.logger.info(f\"Checking inventory for order {order_data['order_id']}\") # 재고 확인 및 예약 로직 await asyncio.sleep(0.3) # 재고 처리 시뮬레이션 # 재고 예약 완료 이벤트 발행 inventory_event = Event( topic=\"inventory.reserved\", data={ \"order_id\": order_data[\"order_id\"], \"items\": order_data[\"items\"], \"reservation_status\": \"confirmed\" } ) await self.event_broker.publish(inventory_event) # 사용 예시 및 테스트 async def main(): \"\"\" Event Broker 사용 예시 \"\"\" # 로깅 설정 logging.basicConfig(level=logging.INFO) # Event Broker 초기화 broker = EventBroker() # 서비스 인스턴스 생성 order_service = OrderService(broker) payment_service = PaymentService(broker) inventory_service = InventoryService(broker) # 주문 생성 테스트 order_data = { \"customer_id\": \"customer_123\", \"items\": [ {\"product_id\": \"prod_1\", \"quantity\": 2, \"price\": 29.99}, {\"product_id\": \"prod_2\", \"quantity\": 1, \"price\": 49.99} ], \"total_amount\": 109.97 } print(\"=== 주문 처리 시작 ===\") order_id = await order_service.create_order(order_data) # 이벤트 처리 완료를 위한 대기 await asyncio.sleep(2) print(f\"\\n=== 주문 {order_id} 처리 완료 ===\") print(f\"총 처리된 이벤트 수: {len(broker.event_history)}\") # 이벤트 히스토리 출력 print(\"\\n=== 이벤트 히스토리 ===\") for event in broker.event_history: print(f\"[{event.timestamp}] {event.topic}: {event.data}\") # 실행 if __name__ == \"__main__\": asyncio.run(main()) 이 구현 예시는 Event Broker 의 핵심 개념들을 실제 코드로 보여줍니다:\n비동기 이벤트 처리: asyncio 를 활용한 논블로킹 처리 토픽 기반 라우팅: 토픽별 구독자 관리 느슨한 결합: 서비스 간 직접 호출 없이 이벤트를 통한 통신 이벤트 재처리: 히스토리 기반 재처리 기능 에러 핸들링: 구독자별 예외 처리 사례 4: 실시간 알림 서비스 SNS, 커뮤니티, 커머스 등 거의 모든 서비스에서 사용되며, 일반적으로 Event-Driven Architecture + Pub/Sub 기반 알림 브로커 + WebSocket/Push API 조합으로 구현된다.\n시스템 구성:\n컴포넌트 역할 Kafka 이벤트 버퍼 및 브로커 역할 Comment Service 이벤트 생성 및 발행 Notification Service 이벤트 수신 → 알림 생성/전송 WebSocket Gateway 사용자에게 실시간 알림 전달 Notification DB 알림 이력 저장 (선택 사항) graph TD A[사용자] --\u003e|댓글 작성| B(API Gateway) B --\u003e C[Comment Service] C --\u003e|Event 생성| D(Kafka Topic: comment.events) D --\u003e E[Notification Service] E --\u003e|WebSocket 전송| F[WebSocket Gateway] F --\u003e G[실시간 연결 사용자] E --\u003e|DB 저장| H[Notification DB] Workflow:\n단계 설명 1. 사용자 댓글 작성 사용자가 게시글에 댓글을 작성 2. 이벤트 발행 Comment Service 는 CommentCreated 이벤트를 Kafka 에 발행 3. 알림 서비스 수신 Notification Service 가 해당 이벤트를 소비하고, 알림 데이터를 구성 4. 실시간 전송 WebSocket 을 통해 실시간 연결된 사용자에게 즉시 알림 전송 5. 알림 저장 알림을 데이터베이스에 저장하여, 추후 알림 리스트 조회 가능 구현 코드:\nKafka 이벤트 발행–Comment Service\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 # comment_service.py from kafka import KafkaProducer import json producer = KafkaProducer( bootstrap_servers='localhost:9092', value_serializer=lambda v: json.dumps(v).encode('utf-8') ) def publish_comment_event(comment_data): event = { \"type\": \"CommentCreated\", \"post_id\": comment_data[\"post_id\"], \"commenter_id\": comment_data[\"user_id\"], \"receiver_id\": comment_data[\"post_owner_id\"], \"message\": comment_data[\"text\"] } producer.send('comment.events', event) producer.flush() Kafka 이벤트 소비 + WebSocket 연동–Notification Service\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 # notification_service.py from kafka import KafkaConsumer import json from fastapi import FastAPI, WebSocket from collections import defaultdict import asyncio app = FastAPI() active_connections = defaultdict(list) # user_id -\u003e list of WebSockets @app.websocket(\"/ws/{user_id}\") async def websocket_endpoint(websocket: WebSocket, user_id: str): await websocket.accept() active_connections[user_id].append(websocket) try: while True: await websocket.receive_text() # Keep connection alive finally: active_connections[user_id].remove(websocket) def send_realtime_notification(user_id, message): for ws in active_connections[user_id]: asyncio.create_task(ws.send_text(message)) def run_kafka_consumer(): consumer = KafkaConsumer( 'comment.events', bootstrap_servers='localhost:9092', group_id='notification-group', value_deserializer=lambda m: json.loads(m.decode('utf-8')) ) for msg in consumer: data = msg.value receiver_id = data['receiver_id'] text = f\"새 댓글이 달렸습니다: {data['message']}\" send_realtime_notification(receiver_id, text) # 비동기 Kafka consumer 실행 import threading threading.Thread(target=run_kafka_consumer, daemon=True).start() 클라이언트 (WebSocket JS 예시)\n1 2 3 4 5 const socket = new WebSocket(\"ws://localhost:8000/ws/USER_ID\"); socket.onmessage = function(event) { alert(\"🔔 알림: \" + event.data); }; 사례 5: 마이크로서비스 아키텍처에서 서비스 간 통합 주문 처리 시스템\n사용자가 주문을 생성하면 Order Service 가 OrderCreated 이벤트를 발행하고, Inventory Service 와 Payment Service 가 이를 구독해 각각 재고 확인과 결제 처리를 수행한다. 시스템 구성:\n컴포넌트 역할 Kafka 서비스 간 이벤트 전달 버스 역할 Order Service 주문 저장 및 OrderCreated 이벤트 발행 Inventory Service 재고 확인 및 후속 이벤트 발행 Payment Service 결제 처리 및 후속 이벤트 발행 flowchart TD A[Client] --\u003e|POST /orders| B[Order Service] B --\u003e|OrderCreated Event| C[Kafka Topic: order.events] C --\u003e D[Inventory Service] C --\u003e E[Payment Service] D --\u003e|InventoryReserved| F[Kafka Topic: inventory.events] E --\u003e|PaymentProcessed| G[Kafka Topic: payment.events] Workflow:\n단계 설명 1. 주문 생성 사용자가 주문 요청을 보내면 Order Service 가 DB 에 주문 저장 2. 이벤트 발행 주문이 저장되면 Kafka 에 OrderCreated 이벤트 발행 3. 재고/결제 처리 Inventory Service 와 Payment Service 는 이벤트를 수신해 각각 처리 4. 후속 이벤트 발행 각각 처리 결과 (InventoryReserved, PaymentProcessed) 를 발행하여 후속 프로세스 연동 구현 예시:\nOrder Service–이벤트 발행\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 # order_service.py from kafka import KafkaProducer import json from fastapi import FastAPI, Request app = FastAPI() producer = KafkaProducer( bootstrap_servers='localhost:9092', value_serializer=lambda v: json.dumps(v).encode('utf-8') ) @app.post(\"/orders\") async def create_order(req: Request): body = await req.json() order = { \"order_id\": body[\"order_id\"], \"user_id\": body[\"user_id\"], \"items\": body[\"items\"], \"total\": body[\"total\"] } # 가상 DB 저장 생략 producer.send('order.events', { \"type\": \"OrderCreated\", \"data\": order }) producer.flush() return {\"status\": \"Order created and event published\"} Inventory Service–이벤트 소비자\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 # inventory_service.py from kafka import KafkaConsumer, KafkaProducer import json consumer = KafkaConsumer( 'order.events', bootstrap_servers='localhost:9092', group_id='inventory-service', value_deserializer=lambda m: json.loads(m.decode('utf-8')) ) producer = KafkaProducer( bootstrap_servers='localhost:9092', value_serializer=lambda v: json.dumps(v).encode('utf-8') ) def handle_order_created(event_data): items = event_data['data']['items'] # 재고 확인 로직 (가정) all_available = True # 여기서는 항상 성공 가정 if all_available: result = { \"type\": \"InventoryReserved\", \"data\": { \"order_id\": event_data['data']['order_id'], \"status\": \"reserved\" } } producer.send('inventory.events', result) producer.flush() for msg in consumer: event = msg.value if event['type'] == \"OrderCreated\": handle_order_created(event) Payment Service–이벤트 소비자\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 # payment_service.py from kafka import KafkaConsumer, KafkaProducer import json consumer = KafkaConsumer( 'order.events', bootstrap_servers='localhost:9092', group_id='payment-service', value_deserializer=lambda m: json.loads(m.decode('utf-8')) ) producer = KafkaProducer( bootstrap_servers='localhost:9092', value_serializer=lambda v: json.dumps(v).encode('utf-8') ) def handle_order_created(event_data): amount = event_data['data']['total'] # 결제 처리 로직 (가정) is_paid = True if is_paid: result = { \"type\": \"PaymentProcessed\", \"data\": { \"order_id\": event_data['data']['order_id'], \"status\": \"paid\" } } producer.send('payment.events', result) producer.flush() for msg in consumer: event = msg.value if event['type'] == \"OrderCreated\": handle_order_created(event) 주목할 내용 카테고리 주요 항목 설명 아키텍처 패턴 Pub/Sub 발행자와 구독자 간의 비동기 이벤트 전달 모델 Event Sourcing 상태 변경을 이벤트 시퀀스로 기록하는 패턴 CQRS 명령/조회 분리 아키텍처, 읽기/쓰기 최적화 Fan-out 하나의 이벤트를 다수의 소비자가 수신하는 패턴 Event Mesh 복수 브로커 간 메시지 전달을 지원하는 통합 네트워크 구조 Event Gateway 외부 이벤트를 브로커로 전달하는 통합 인터페이스 State-centric Messaging 분산 상태 관리와 메시징을 결합한 패러다임 메시지 - 쿼리 통합 메시징 시스템과 데이터베이스 쿼리 기능의 결합 형태 운영/관리 기술 Schema Registry 이벤트 메시지 포맷의 버전 관리 및 유효성 검증 도구 Tracing / Logging 이벤트 흐름 및 장애 분석용 관찰 도구 (OpenTelemetry 등) 오토스케일링 Kubernetes 기반 자동 확장 기능 리밸런싱 / 백프레셔 소비자 할당 재조정 및 과부하 제어 기법 Event Replay 메시지 재처리를 위한 이벤트 로그 재생 기능 통합 가시성 도구 멀티 브로커/환경 이벤트 추적 및 시각화 시스템 자가 최적화 브로커 AI 기반 워크로드 분석 및 설정 자동화 기능 신뢰성 / 확장성 Partition / Sharding 메시지 병렬 처리 및 확장을 위한 파티셔닝 기술 Replication 장애/데이터 유실 방지를 위한 다중 복제 DLQ (Dead Letter Queue) 실패 메시지 별도 저장 후 재처리 가능하게 하는 큐 ISR (In-Sync Replica) 리더와 동기화된 복제본 집합 실시간 처리 Stream Processing 이벤트를 실시간 분석, 알림, 변환 처리하는 기능 Flink, Storm, Spark Streaming 주요 실시간 스트림 처리 엔진들 표준 및 생태계 AsyncAPI 비동기 메시징용 API 명세 포맷 CloudEvents 클라우드 간 이벤트 표준 메타데이터 포맷 Avro / Protobuf / JSON Schema 이벤트 메시지 포맷 및 스키마 정의 방식 Apache Kafka / Pulsar / NATS 대표적인 오픈소스 Event Broker 솔루션 EventBridge / Event Hubs AWS, Azure 등 관리형 이벤트 서비스 기술 트렌드 eBPF 기반 브로커 최적화 커널 레벨 필터링 및 라우팅 최적화를 위한 고급 기술 영속성과 지연 시간 균형 NVRAM, SSD 등을 통한 저지연 고내구성 설계 양자 내성 암호화 향후 양자 컴퓨팅 위협 대비 보안 기법 적용 연구 중 탄소 발자국 최적화 에너지 효율성 향상 및 지속가능한 메시징 시스템 설계 도메인 특화 솔루션 IoT 특화 브로커 리소스 제약, 엣지 환경 대응용 경량 메시징 솔루션 (예: MQTT 기반) 금융 특화 고성능 브로커 초저지연/고신뢰/규제 준수 메시지 처리 요구 대응 AI/ML 파이프라인 통합 모델 학습/추론 워크플로우와 이벤트 시스템 통합 설계 반드시 학습해야 할 내용 🚀 카테고리 주제 핵심 항목 설명 Messaging Theory 전송 보장 At-least-once / Exactly-once 메시지 중복·손실 방지를 위한 전달 보장 수준 이해 Pub/Sub 발행/구독/이벤트 분배 퍼블리셔와 구독자 간의 메시지 배포 구조 Ack / Idempotency ack(확인 응답) / 중복 처리 방지 메시지 처리 상태 확인 및 중복 트랜잭션 방지 Streaming Platform Apache Kafka 아키텍처 분산 로그 기반 구조 및 설정 Kafka 내부 구조, 파티션, 브로커 구성 등 Partitioning 파티션, 샤딩, 토픽 분할 스케일아웃 및 병목 해소 설계 기법 Integration Design Event Storming 도메인 이벤트 중심 설계 기법 비즈니스 흐름을 중심으로 이벤트 모델링 Schema Registry 스키마 등록소 및 버전 관리 Avro/Protobuf 기반 메시지 구조 통제 Observability 모니터링 및 트레이싱 흐름 추적, 장애 탐지 OpenTelemetry 등으로 이벤트 흐름 실시간 모니터링 Format \u0026 Schema Avro / Protobuf 포맷 메시지 직렬화와 스키마 관리 효율적 포맷과 상호 운용성 유지 운영/관제 장애 복구 패턴 DLQ, Replication 실패 시 재처리와 데이터 복제 전략 보안 메시지 암호화/인증/인가 TLS, OAuth, 인증/인가 정책 메시지 무결성과 접근 제어 보장 용어 정리 카테고리 용어 (영문) 설명 구조/역할 Broker 메시지/이벤트를 발행자와 구독자 간에 중계하는 중심 시스템 Producer (생산자) 메시지를 생성하여 브로커에 발행하는 컴포넌트 Consumer (소비자) 브로커로부터 메시지를 수신하고 처리하는 컴포넌트 Consumer Group (컨슈머 그룹) 동일 토픽을 병렬 처리하는 소비자들의 논리적 그룹 Exchange (교환소) 메시지를 라우팅 규칙에 따라 큐에 분배하는 브로커 컴포넌트 메시지 채널 Topic (토픽) 이벤트를 분류하고 구독할 수 있는 논리적 메시지 채널 Queue (큐) 메시지를 순서대로 저장하고 처리 대기하는 구조 Partition (파티션) 병렬 처리와 확장을 위해 토픽을 나눈 단위 Offset (오프셋) 컨슈머가 토픽 내 메시지를 어디까지 처리했는지 나타내는 지표 Segment (세그먼트) 파티션의 물리적 파일 단위 패턴/모델 Pub/Sub (발행 - 구독) 발행자가 메시지를 보내고, 구독자가 이를 수신하는 비동기 메시징 모델 Event Sourcing 시스템 상태 변경을 이벤트로 저장하고, 재생하여 상태를 복원하는 방식 CQRS (Command Query Responsibility Segregation) 명령과 조회의 책임을 분리하여 성능과 확장성 확보 Saga Pattern (사가 패턴) 분산 트랜잭션 처리를 위한 이벤트 기반 보상 트랜잭션 패턴 Event Mesh 여러 브로커를 연결하여 메시지 전송을 통합한 글로벌 이벤트 라우팅 구조 신뢰성/보장 DLQ (Dead Letter Queue) 처리 실패 메시지를 임시 저장해 재처리 또는 분석 가능하게 하는 큐 Replication (복제) 장애 대비를 위해 메시지를 다수의 브로커에 복제 ISR (In-Sync Replica) 리더와 동기화된 복제본 세트 QoS (Quality of Service) 메시지 전달 보장 수준: At-most-once, At-least-once, Exactly-once 성능/운영 Backpressure (백프레셔) 소비 속도가 생산 속도를 따라가지 못할 때 처리량 제어 메커니즘 Rebalancing (리밸런싱) 컨슈머 그룹 간 파티션 재할당 과정 Watermark (워터마크) 스트림 처리 시 시간 윈도우 계산 기준 운영/도구 Schema Registry (스키마 레지스트리) 메시지 포맷 (Avro, JSON 등) 의 버전/유효성 관리 시스템 Tracing (트레이싱) 이벤트 흐름 추적 및 분석 도구 (예: OpenTelemetry, Jaeger) AsyncAPI 메시지 기반 API 명세 정의 포맷 오토스케일링 (Auto-scaling) 시스템 부하에 따라 컴퓨팅 자원을 자동으로 조절하는 기능 프로토콜 AMQP 고급 메시지 큐 프로토콜, 라우팅/보안 등 지원 MQTT 경량 메시지 프로토콜, IoT 환경에 적합 STOMP 간단한 텍스트 기반 메시징 프로토콜 이벤트 추출 CDC (Change Data Capture) DB 변경 이벤트를 실시간 메시지로 전환하는 기법 참고 및 출처 Message Broker \u0026 Event Broker 메시지 브로커란 무엇인가요? | IBM 메시지 브로커 - 위키백과 Event Broker 개념 및 기능 What is an Event Broker - Confluent Message Broker Vs Event Broker 비교 메시지 브로커와 이벤트 브로커의 이해와 활용 메시지 브로커와 이벤트 브로커: 분산 시스템의 핵심 기술 Message Broker vs Event Broker 비교 분석 - Riskified Tech 메시지 브로커 vs 이벤트 처리 도구 비교 - Upsolver RabbitMQ Vs Kafka RabbitMQ와 Kafka - 메시지 대기열 시스템 간의 차이점 - AWS Kafka(이벤트 브로커) vs RabbitMQ(메시지 브로커) 카프카(kafka) vs RabbitMQ Event-Driven Architecture \u0026 Event Mesh 이벤트 기반 아키텍처란? | Red Hat 이벤트 메쉬(Event Mesh)의 개념, 기능, 작동 방식, 사용 방법 | Red Hat Event-Driven Architecture 패턴 가이드 - Microsoft Azure 솔라스 Event Broker 아키텍처 예시 실무 적용 \u0026 최적화 사례 EDA 실무 적용 사례 - Estuary EDA 성능 최적화 및 브로커 튜닝 Event-Driven Architecture 실무 사례 - Estuary 플랫폼별 공식 문서 Apache Kafka 공식 문서 (Event Broker 구조) AWS EventBridge 공식 페이지 Azure Event Grid 개요 Google Cloud Eventarc 소개 AsyncAPI 공식 웹사이트 추가 자료 Message Broker(메시지 브로커)란 무엇일까? Message Broker 활용 ","wordCount":"8049","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2025-07-18T05:58:00Z","dateModified":"2025-07-18T05:58:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/networking--protocols/communication-patterns/message-infrastructure/message-brokers-vs-event-brokers/event-broker/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a></div><h1 class="post-title entry-hint-parent">Event Broker</h1><div class=post-description>이벤트 브로커는 이벤트 발행자와 구독자 간의 메시지 교환을 중개하는 미들웨어로, 비동기 통신, 실시간 데이터 분배, 서비스 간 결합도 감소, 확장성 및 장애 복원력을 제공한다. Pub/Sub, 스트리밍, 다양한 QoS(서비스 품질) 와 같은 고급 기능을 지원하며, 현대 백엔드 아키텍처의 핵심 역할을 담당한다.</div><div class=post-meta><span title='2025-07-18 05:58:00 +0000 UTC'>July 18, 2025</span>&nbsp;·&nbsp;38 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/Networking%20&%20Protocols/Communication%20Patterns/Message%20Infrastructure/Message%20Brokers%20vs%20Event%20Brokers/Event-Broker.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#event-broker>Event Broker</a><ul><li><a href=#배경>배경</a></li><li><a href=#목적-및-필요성>목적 및 필요성</a></li><li><a href=#핵심-개념>핵심 개념</a></li><li><a href=#주요-기능-및-역할>주요 기능 및 역할</a></li><li><a href=#특징>특징</a></li><li><a href=#핵심-원칙>핵심 원칙</a></li><li><a href=#주요-원리-및-작동-방식>주요 원리 및 작동 방식</a></li><li><a href=#구조-및-아키텍처>구조 및 아키텍처</a></li><li><a href=#구현-기법>구현 기법</a></li><li><a href=#장점>장점</a></li><li><a href=#단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안</a></li><li><a href=#도전-과제>도전 과제</a></li><li><a href=#분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형</a></li><li><a href=#event-broker-기술별-비교>Event Broker 기술별 비교</a></li><li><a href=#event-broker-구축-예제>Event Broker 구축 예제</a></li><li><a href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점</a></li><li><a href=#최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점</a></li><li><a href=#실무-사용-예시>실무 사용 예시</a></li><li><a href=#활용-사례>활용 사례</a></li><li><a href=#주목할-내용>주목할 내용</a></li><li><a href=#반드시-학습해야-할-내용>반드시 학습해야 할 내용</a></li></ul></li><li><a href=#용어-정리>용어 정리</a></li><li><a href=#참고-및-출처>참고 및 출처</a><ul><li><a href=#message-broker--event-broker>Message Broker & Event Broker</a></li><li><a href=#message-broker-vs-event-broker-비교>Message Broker Vs Event Broker 비교</a></li><li><a href=#rabbitmq-vs-kafka>RabbitMQ Vs Kafka</a></li><li><a href=#event-driven-architecture--event-mesh>Event-Driven Architecture & Event Mesh</a></li><li><a href=#실무-적용--최적화-사례>실무 적용 & 최적화 사례</a></li><li><a href=#플랫폼별-공식-문서>플랫폼별 공식 문서</a></li><li><a href=#추가-자료>추가 자료</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=event-broker>Event Broker<a hidden class=anchor aria-hidden=true href=#event-broker>#</a></h2><p>이벤트 브로커는 이벤트 기반 아키텍처에서 이벤트 발행자 (Producer) 와 구독자 (Consumer) 사이의 이벤트 메시지 흐름을 중개하는 미들웨어이다.<br>분산 마이크로서비스 환경에서 데이터 흐름의 실시간성, 비동기성, 확장성을 확보할 수 있도록 지원한다. 대용량 실시간 데이터 처리와 시스템 간의 결합도 감소, 장애 격리 및 이벤트 아카이빙 등 다양한 장점으로 인해 오늘날 IT 인프라에서 매우 중요한 역할을 차지한다.</p><p>이벤트 브로커는 Pub/Sub, 스트리밍, 다양한 QoS, 보안, 트랜잭션, 확장성, 장애 복구 등 다양한 기능을 제공하며, 시스템 간 결합도를 낮추고, 실시간 데이터 분배와 비동기 처리를 지원한다.</p><p>대표 솔루션으로는 Solace, Kafka, AWS EventBridge, Azure Event Grid 등이 있으며, 다양한 산업에서 실시간 분석, 알림, IoT, 마이크로서비스 통합 등 광범위하게 활용된다.</p><p><figure><img alt="Event Broker" loading=lazy src=/img/event-broker.svg><figcaption>Source: https://developer.confluent.io/patterns/event-stream/event-broker/</figcaption></figure></p><h3 id=배경>배경<a hidden class=anchor aria-hidden=true href=#배경>#</a></h3><p>Event Broker 는 다음과 같은 기술적 요구사항과 발전 과정을 통해 등장했다:</p><ol><li><p><strong>분산 시스템의 복잡성 증가</strong></p><ul><li>마이크로서비스 아키텍처의 확산</li><li>시스템 간 상호 의존성 증가</li><li>동기식 통신의 한계 극복 필요성</li></ul></li><li><p><strong>실시간 데이터 처리 요구 증가</strong></p><ul><li>IoT 디바이스의 폭발적 증가</li><li>실시간 분석 및 대응 시스템 구축 필요</li><li>스트리밍 데이터 처리 패러다임 변화</li></ul></li><li><p><strong>기존 메시지 브로커의 한계</strong></p><ul><li>지점 간 통신 중심의 설계</li><li>메시지 지속성과 재처리 어려움</li><li>확장성과 처리량의 제약</li></ul></li></ol><h3 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h3><ol><li><p><strong>시스템 분리 (Decoupling)</strong></p><ul><li>이벤트 생산자와 소비자의 완전한 분리</li><li>시간적, 공간적 분리를 통한 유연성 확보</li><li>의존성 최소화로 독립적인 개발 및 배포 가능</li></ul></li><li><p><strong>확장성 향상 (Scalability)</strong></p><ul><li>수평적 확장을 통한 처리 능력 증대</li><li>동적 확장 및 축소 지원</li><li>워크로드 분산을 통한 효율성 개선</li></ul></li><li><p><strong>내결함성 보장 (Fault Tolerance)</strong></p><ul><li>시스템 일부 장애가 전체에 미치는 영향 최소화</li><li>자동 복구 및 재시도 메커니즘</li><li>데이터 손실 방지를 위한 지속성 보장</li></ul></li><li><p><strong>실시간 반응성 (Real-time Responsiveness)</strong></p><ul><li>이벤트 발생 즉시 관련 시스템들의 반응</li><li>배치 처리 대비 현저한 지연시간 단축</li><li>동적 비즈니스 요구사항에 신속한 대응</li></ul></li></ol><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><p><strong>Event Broker</strong>는 이벤트를 발행 (Publish) 하는 서비스와 이를 구독 (Subscribe) 하는 소비자 사이에서 <strong>중계자 역할을 하는 시스템 구성 요소</strong>다.</p><h4 id=기본-개념>기본 개념<a hidden class=anchor aria-hidden=true href=#기본-개념>#</a></h4><ol><li><p><strong>이벤트 (Event)</strong></p><ul><li>시스템에서 발생하는 상태 변화를 나타내는 메시지</li><li>불변성 (Immutable) 특성을 가지며 과거에 발생한 사실을 기록</li><li>이벤트 헤더 (메타데이터) 와 이벤트 페이로드 (실제 데이터) 로 구성</li></ul></li><li><p><strong>발행 - 구독 패턴 (Publish-Subscribe Pattern)</strong></p><ul><li>이벤트 발행자 (Publisher) 와 구독자 (Subscriber) 간의 비동기 통신 모델</li><li>발행자는 구독자의 존재를 알 필요가 없는 완전한 분리</li><li>토픽 (Topic) 기반의 이벤트 분류 및 라우팅</li></ul></li><li><p><strong>토픽 (Topic)</strong></p><ul><li>이벤트를 분류하고 라우팅하는 논리적 채널</li><li>계층적 구조를 통한 효율적인 이벤트 관리</li><li>와일드카드를 활용한 구독 패턴 지원</li></ul></li><li><p><strong>이벤트 스트림 (Event Stream)</strong></p><ul><li>시간 순서로 정렬된 이벤트들의 연속된 흐름</li><li>내구성과 재처리 가능성을 제공</li><li>실시간 및 배치 처리 모두 지원</li></ul></li></ol><h4 id=실무-구현을-위한-핵심-연관성>실무 구현을 위한 핵심 연관성<a hidden class=anchor aria-hidden=true href=#실무-구현을-위한-핵심-연관성>#</a></h4><p><strong>확장성 측면:</strong></p><ul><li>수평적 확장을 통한 처리량 증대</li><li>파티셔닝을 통한 병렬 처리 지원</li><li>로드 밸런싱과 백프레셔 관리</li></ul><p><strong>신뢰성 측면:</strong></p><ul><li>이벤트 지속성과 복제를 통한 데이터 안정성</li><li>정확히 한 번 처리 (Exactly-once processing) 보장</li><li>장애 복구 및 재시작 메커니즘</li></ul><p><strong>성능 측면:</strong></p><ul><li>비동기 처리를 통한 응답성 향상</li><li>배치 처리와 압축을 통한 효율성 개선</li><li>메모리 및 디스크 최적화</li></ul><h3 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h3><p>Event Broker 는 다음과 같은 핵심 기능들을 수행한다:</p><ol><li><p><strong>이벤트 수집 및 수신 (Event Ingestion)</strong></p><ul><li>다양한 소스로부터 이벤트 수집</li><li>이벤트 검증 및 스키마 확인</li><li>처리량 조절 및 백프레셔 관리</li></ul></li><li><p><strong>이벤트 라우팅 및 분배 (Event Routing & Distribution)</strong></p><ul><li>토픽 기반의 이벤트 분류</li><li>구독 패턴에 따른 선택적 배포</li><li>다중 소비자 지원</li></ul></li><li><p><strong>이벤트 지속성 (Event Persistence)</strong></p><ul><li>내구성 있는 이벤트 저장</li><li>복제를 통한 데이터 안정성</li><li>히스토리 데이터 관리</li></ul></li><li><p><strong>이벤트 순서 보장 (Event Ordering)</strong></p><ul><li>파티션 내 순서 보장</li><li>글로벌 순서 제어 옵션</li><li>타임스탬프 기반 정렬</li></ul></li></ol><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><ol><li><p><strong>비동기 통신 (Asynchronous Communication)</strong></p><ul><li>논블로킹 이벤트 전송</li><li>생산자와 소비자의 독립적 처리</li><li>시스템 응답성 향상</li></ul></li><li><p><strong>높은 처리량 (High Throughput)</strong></p><ul><li>대용량 이벤트 스트림 처리</li><li>배치 처리 및 압축 최적화</li><li>병렬 처리 지원</li></ul></li><li><p><strong>내결함성 (Fault Tolerance)</strong></p><ul><li>자동 장애 감지 및 복구</li><li>다중 복제본 관리</li><li>네트워크 파티션 내성</li></ul></li><li><p><strong>확장성 (Scalability)</strong></p><ul><li>수평적 확장 지원</li><li>동적 파티션 관리</li><li>로드 밸런싱</li></ul></li></ol><h3 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h3><ol><li><p><strong>이벤트 불변성 (Event Immutability)</strong></p><ul><li>한 번 기록된 이벤트는 변경되지 않음</li><li>히스토리 추적 및 감사 가능</li><li>데이터 일관성 보장</li></ul></li><li><p><strong>최소한의 브로커 (Dumb Broker, Smart Client)</strong></p><ul><li>브로커는 단순한 전달 역할에 집중</li><li>클라이언트가 복잡한 로직 처리</li><li>성능과 확장성 최적화</li></ul></li><li><p><strong>토픽 기반 라우팅 (Topic-based Routing)</strong></p><ul><li>논리적 채널을 통한 이벤트 분류</li><li>계층적 토픽 구조 지원</li><li>와일드카드 구독 패턴</li></ul></li></ol><h3 id=주요-원리-및-작동-방식>주요 원리 및 작동 방식<a hidden class=anchor aria-hidden=true href=#주요-원리-및-작동-방식>#</a></h3><p>다음은 Event Broker 의 핵심 작동 원리를 보여주는 다이어그램입니다:</p><pre class=mermaid>graph TB
    subgraph &#34;Event Producers&#34;
        P1[Producer 1&lt;br/&gt;Web Application]
        P2[Producer 2&lt;br/&gt;Mobile App]
        P3[Producer 3&lt;br/&gt;IoT Sensor]
    end
    
    subgraph &#34;Event Broker Cluster&#34;
        EB1[Event Broker 1&lt;br/&gt;Partition A]
        EB2[Event Broker 2&lt;br/&gt;Partition B]
        EB3[Event Broker 3&lt;br/&gt;Partition C]
        
        EB1 -.-&gt;|Replication| EB2
        EB2 -.-&gt;|Replication| EB3
        EB3 -.-&gt;|Replication| EB1
    end
    
    subgraph &#34;Topics&#34;
        T1[user.events]
        T2[order.events]
        T3[sensor.data]
    end
    
    subgraph &#34;Event Consumers&#34;
        C1[Consumer 1&lt;br/&gt;Analytics Service]
        C2[Consumer 2&lt;br/&gt;Notification Service]
        C3[Consumer 3&lt;br/&gt;Inventory Service]
        C4[Consumer 4&lt;br/&gt;ML Pipeline]
    end
    
    P1 --&gt;|Publish| EB1
    P2 --&gt;|Publish| EB2
    P3 --&gt;|Publish| EB3
    
    EB1 --&gt; T1
    EB2 --&gt; T2
    EB3 --&gt; T3
    
    T1 --&gt;|Subscribe| C1
    T1 --&gt;|Subscribe| C2
    T2 --&gt;|Subscribe| C3
    T3 --&gt;|Subscribe| C4
    
    style EB1 fill:#f9f,stroke:#333,stroke-width:2px
    style EB2 fill:#f9f,stroke:#333,stroke-width:2px
    style EB3 fill:#f9f,stroke:#333,stroke-width:2px
</pre><p><strong>작동 원리 설명:</strong></p><ol><li><strong>이벤트 발행</strong>: 프로듀서들이 다양한 토픽으로 이벤트를 발행</li><li><strong>파티셔닝</strong>: 이벤트가 파티션별로 분산 저장</li><li><strong>복제</strong>: 내결함성을 위한 데이터 복제</li><li><strong>구독 및 소비</strong>: 컨슈머들이 관심 있는 토픽을 구독하여 이벤트 소비</li></ol><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><pre class=mermaid>graph TB
    subgraph &#34;Client Layer&#34;
        PC[Producer Clients]
        CC[Consumer Clients]
    end
    
    subgraph &#34;Event Broker Infrastructure&#34;
        subgraph &#34;Broker Cluster&#34;
            B1[Broker Node 1]
            B2[Broker Node 2]
            B3[Broker Node 3]
        end
        
        subgraph &#34;Storage Layer&#34;
            S1[Segment 1]
            S2[Segment 2]
            S3[Segment 3]
        end
        
        subgraph &#34;Coordination Service&#34;
            ZK[ZooKeeper/Raft&lt;br/&gt;Metadata Management]
        end
    end
    
    subgraph &#34;Monitoring &amp; Management&#34;
        M1[Metrics Collection]
        M2[Health Monitoring]
        M3[Configuration Management]
    end
    
    PC -.-&gt;|Produce Events| B1
    PC -.-&gt;|Produce Events| B2
    PC -.-&gt;|Produce Events| B3
    
    B1 -.-&gt;|Consume Events| CC
    B2 -.-&gt;|Consume Events| CC
    B3 -.-&gt;|Consume Events| CC
    
    B1 &lt;--&gt; S1
    B2 &lt;--&gt; S2
    B3 &lt;--&gt; S3
    
    B1 &lt;--&gt; ZK
    B2 &lt;--&gt; ZK
    B3 &lt;--&gt; ZK
    
    B1 --&gt; M1
    B2 --&gt; M2
    B3 --&gt; M3
</pre><h4 id=구성요소>구성요소<a hidden class=anchor aria-hidden=true href=#구성요소>#</a></h4><table><thead><tr><th>구분</th><th>구성요소</th><th>기능</th><th>역할</th><th>특징</th></tr></thead><tbody><tr><td><strong>필수</strong></td><td>브로커 노드 (Broker Nodes)</td><td>이벤트 수신, 저장, 배포</td><td>클라이언트 요청 처리 및 데이터 흐름 관리</td><td>상태 비저장 설계, 수평 확장성 뛰어남</td></tr><tr><td></td><td>스토리지 레이어 (Storage Layer)</td><td>이벤트의 영구 저장 및 복제</td><td>데이터의 내구성 및 일관성 보장</td><td>로그 기반 저장 또는 분산 파일 시스템 활용</td></tr><tr><td></td><td>메타데이터 관리자 (Metadata Manager)</td><td>토픽, 파티션, 브로커 정보 관리</td><td>클러스터 상태 유지 및 리더 선출</td><td>분산 합의 알고리즘 (Raft, Zookeeper 등) 활용</td></tr><tr><td></td><td>클라이언트 라이브러리 (Client Libraries)</td><td>프로듀서/컨슈머 API 제공</td><td>이벤트 송수신, 네트워크 통신 처리</td><td>다양한 언어 지원, 직렬화/역직렬화 포함</td></tr><tr><td><strong>선택</strong></td><td>스키마 레지스트리 (Schema Registry)</td><td>이벤트 스키마 관리 및 검증</td><td>데이터 호환성 유지 및 스키마 진화 관리</td><td>Avro, Protobuf 등과 연계, 중앙 집중 스키마 관리</td></tr><tr><td></td><td>커넥터 (Connectors)</td><td>외부 시스템과의 연결 (입출력)</td><td>DB, MQ, 파일 등 외부 소스/싱크 연동</td><td>플러그인 기반 확장, Kafka Connect 등에서 활용</td></tr><tr><td></td><td>스트림 프로세싱 엔진 (Stream Processing Engine)</td><td>실시간 이벤트 변환 및 집계</td><td>복잡 이벤트 처리 (CEP), 데이터 파이프라인 구성</td><td>상태 기반 처리, 타임 윈도우, join, 필터링 등 지원</td></tr><tr><td></td><td>모니터링 시스템 (Monitoring System)</td><td>성능 지표 수집 및 시각화</td><td>시스템 운영 상태 추적 및 이상 탐지</td><td>Prometheus, Grafana, Alertmanager 등 연계 가능</td></tr></tbody></table><h3 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h3><table><thead><tr><th>카테고리</th><th>구현 기법</th><th>정의 / 구성 요소</th><th>주요 목적</th><th>실제 예시 시스템 / 시나리오</th></tr></thead><tbody><tr><td><strong>1. 메시징 모델</strong></td><td><strong>Pub/Sub 모델</strong></td><td>Publisher, Subscriber, Topic 구조</td><td>느슨한 결합, 1:N 메시지 분배, 실시간 알림</td><td>Kafka, Pulsar, SNS, EventBridge</td></tr><tr><td></td><td><strong>Queue 기반 모델</strong></td><td>Queue, Consumer, Acknowledge</td><td>순차적 소비, 1:1 메시지 처리, 작업 큐</td><td>RabbitMQ, Amazon SQS</td></tr><tr><td></td><td><strong>Topic 기반 분류</strong></td><td>Topic, 파티션 키, Subscription Rule</td><td>논리적 구분, 멀티 이벤트 처리, 토픽 기반 라우팅</td><td>Kafka Topics: order.created 등</td></tr><tr><td><strong>2. 저장 구조</strong></td><td><strong>로그 기반 스토리지</strong></td><td>Append-only log, Segment, Offset, Index</td><td>고성능 순차적 저장, 이벤트 보존</td><td>Kafka log, Redpanda, EventStoreDB</td></tr><tr><td></td><td><strong>이벤트 소싱</strong></td><td>모든 변경 이벤트 기록, 상태 재구성</td><td>감사/추적, 데이터 복구 및 리플레이</td><td>Kafka + Snapshot 기반 시스템</td></tr><tr><td><strong>3. 데이터 처리 방식</strong></td><td><strong>스트림 처리</strong></td><td>Continuous ingestion, Time window, State Management</td><td>실시간 분석, CEP, 복잡 이벤트 흐름 처리</td><td>Flink, Kafka Streams, Spark Streaming</td></tr><tr><td></td><td><strong>Event Filtering / Routing</strong></td><td>Rule-based 조건 필터링, 이벤트 패턴 매칭</td><td>조건별 라우팅, 멀티 서비스 이벤트 전달 최적화</td><td>AWS EventBridge Rule, Solace</td></tr><tr><td><strong>4. 확장성 및 병렬성</strong></td><td><strong>파티셔닝 (Partitioning)</strong></td><td>Partition Key, Hashing, Leader-Follower 구조</td><td>병렬 처리, 확장성 확보, 소비자 그룹 분산 처리</td><td>Kafka 파티션 설계 (user_id 기반)</td></tr><tr><td><strong>5. 신뢰성과 복원력</strong></td><td><strong>복제 (Replication)</strong></td><td>리더 - 팔로워, ISR, 동기/비동기 복제</td><td>내결함성, 데이터 유실 방지, 고가용성</td><td>Kafka replication factor = 3</td></tr><tr><td></td><td><strong>QoS / Delivery Guarantee</strong></td><td>At-most/At-least/Exactly-once 설정</td><td>중복 방지, 메시지 손실 방지</td><td>Kafka Idempotent Producer, SQS 설정</td></tr><tr><td><strong>6. 시스템 안정성</strong></td><td><strong>백프레셔 관리</strong></td><td>버퍼링, 쓰로틀링, 배치 크기 조정, Flow Control</td><td>소비자 병목 방지, 처리율 제어, 장애 확산 방지</td><td>Kafka producer linger.ms, 쓰로틀링 정책</td></tr><tr><td><strong>7. 인터페이스 / 통합</strong></td><td><strong>서버리스 연동</strong></td><td>Event → Function Trigger (Lambda/FaaS)</td><td>비용 최적화, 온디맨드 처리, 코드 간소화</td><td>AWS EventBridge + Lambda</td></tr><tr><td></td><td><strong>커넥터 (Connectors)</strong></td><td>Source/Sink 플러그인, 외부 시스템 연동</td><td>DB, MQ, 파일 시스템 통합 자동화</td><td>Kafka Connect, Debezium</td></tr><tr><td><strong>8. 메시지 구조 관리</strong></td><td><strong>스키마 레지스트리</strong></td><td>Avro/Protobuf 스키마 등록 및 검증</td><td>스키마 호환성, 데이터 정합성 유지, 포맷 진화 관리</td><td>Confluent Schema Registry</td></tr></tbody></table><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><table><thead><tr><th>카테고리</th><th>장점 항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>1. 아키텍처 유연성</strong></td><td><strong>시스템 분리 및 느슨한 결합</strong></td><td>Pub/Sub 모델을 통해 Producer 와 Consumer 간 직접 연결 없이 독립적으로 개발·배포 가능</td></tr><tr><td></td><td><strong>유연한 통합 구조</strong></td><td>마이크로서비스, 서버리스, 이벤트 기반 워크플로우에 자연스럽게 통합 가능</td></tr><tr><td><strong>2. 확장성과 성능</strong></td><td><strong>수평 확장성</strong></td><td>파티셔닝과 소비자 그룹을 활용한 병렬 처리 가능, 처리량 증가 시 노드 추가만으로 선형 확장 가능</td></tr><tr><td></td><td><strong>고성능 실시간 처리</strong></td><td>이벤트 발생 직후 소비자에게 비동기 전달되어 밀리초 단위 반응 가능</td></tr><tr><td><strong>3. 신뢰성 및 복원력</strong></td><td><strong>내결함성 (Fault Tolerance)</strong></td><td>복제 및 분산 구조를 통해 단일 장애점 제거, 장애 발생 시 자동 복구 가능</td></tr><tr><td></td><td><strong>장애 격리성</strong></td><td>개별 Consumer 장애가 전체 시스템에 영향을 주지 않음 (Fail-safe 구조)</td></tr><tr><td><strong>4. 데이터 재사용성</strong></td><td><strong>이벤트 재처리 가능</strong></td><td>로그 기반 저장을 통해 과거 이벤트 재소비 가능, A/B 테스트·ML 재훈련·재처리 가능</td></tr><tr><td></td><td><strong>감사 및 추적 용이성</strong></td><td>이벤트 로그가 감사 기록으로 활용 가능, 보안/회계/컴플라이언스 측면에서 유용</td></tr><tr><td><strong>5. 플랫폼 호환성</strong></td><td><strong>이기종 시스템 통합</strong></td><td>다양한 언어/OS/프로토콜 지원으로 이기종 플랫폼 간 통합이 용이함</td></tr><tr><td></td><td><strong>표준 인터페이스 지원</strong></td><td>Kafka, MQTT, AMQP, HTTP 등 다양한 표준 프로토콜 지원</td></tr><tr><td><strong>6. 개발 생산성</strong></td><td><strong>비동기 이벤트 흐름 설계 용이</strong></td><td>도메인 중심 이벤트 설계로 비즈니스 로직 분리, 개발 속도 및 테스트 용이성 증가</td></tr></tbody></table><h3 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th><strong>항목</strong></th><th><strong>설명</strong></th><th><strong>해결방안</strong></th></tr></thead><tbody><tr><td>복잡성 증가</td><td>분산 시스템의 구조/운영/디버깅 난이도 증가</td><td>자동화된 모니터링 도구 도입 (Prometheus, Grafana), 표준 운영 가이드 수립, 통합 관제 적용</td></tr><tr><td>이벤트 흐름 추적 어려움</td><td>이벤트가 브로커를 거쳐 다수 소비자에게 비동기 전달되므로 호출 흐름 추적 어려움</td><td><strong>분산 트레이싱 도입</strong> (OpenTelemetry, Zipkin, Jaeger 등)</td></tr><tr><td>테스트 복잡성</td><td>비동기 흐름/멀티 소비자 구조로 인해 E2E 테스트 난이도 ↑</td><td><strong>Consumer-driven contract test</strong> 도입, 테스트 환경에서 모킹 처리</td></tr><tr><td>순서 보장 제약</td><td>멀티 파티션 또는 다중 노드 분산 구조로 인해 글로벌 순서 보장 어려움</td><td>파티션 키 고정, 동일 파티션 내 메시지 처리 또는 메시지 순서 보정 로직 추가</td></tr><tr><td>지연 가능성</td><td>비동기 전파, 네트워크 병목, 소비자 지연 등으로 실시간성 저하</td><td>워커 증설, <strong>Backpressure 제어</strong>, 파티션 분산 튜닝, 적절한 batch 설정</td></tr><tr><td>비용 증가</td><td>메시지 로그 저장, 고가용성 구성, 멀티 AZ 구성 등으로 인해 인프라 비용 증가</td><td>스토리지 압축, <strong>Retention 정책 설정</strong>, 적절한 파티션/리소스 할당</td></tr><tr><td>스키마 진화 어려움</td><td>이벤트 구조 변경 시 하위 호환성 문제가 발생 가능</td><td><strong>Schema Registry 도입</strong>, backward-compatible 설계, 버전 관리 정책 수립</td></tr></tbody></table><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th><strong>항목</strong></th><th><strong>원인</strong></th><th><strong>영향</strong></th><th><strong>탐지 및 진단</strong></th><th><strong>예방 방법</strong></th><th><strong>해결 방법 및 기법</strong></th></tr></thead><tbody><tr><td>메시지 손실</td><td>브로커 장애, ACK 누락, 재시도 미구현</td><td>기능 누락, 데이터 정합성 훼손</td><td>메시지 카운트, 로그 분석</td><td><strong>복제, Durable Storage, 멀티 AZ 구성</strong></td><td><strong>ACK 기반 처리, DLQ 구성, 메시지 재전송 로직 적용</strong></td></tr><tr><td>순서 불일치</td><td>멀티 파티션 또는 브로커 간 분산 처리</td><td>상태 불일치, 이벤트 순서 오류</td><td>파티션별 로그, 순서 체크</td><td><strong>동일 파티션 키 지정, 순서 보장 전략 수립</strong></td><td><strong>정렬 로직 적용, 단일 파티션 구성 또는 메시지 재정렬</strong></td></tr><tr><td>이벤트 중복</td><td>재전송, 리플레이 시 중복 처리 발생 가능</td><td>데이터 중복, 트리거 중복 수행</td><td>중복 카운터, ID 추적</td><td><strong>멱등성 키 (Idempotent ID) 도입</strong></td><td><strong>중복 제거 로직 구현, 상태 기반 메시지 필터링</strong></td></tr><tr><td>처리 지연</td><td>소비자 처리 속도 저하, 병목 발생</td><td>실시간 처리 실패, SLA 미준수</td><td>TPS/Lag 모니터링, 지연 알림</td><td><strong>병렬 컨슈머 증설, 네트워크 최적화</strong></td><td><strong>Auto-scaling, Queue 병렬 처리, 리밸런싱 적용</strong></td></tr><tr><td>파티션 핫스팟</td><td>특정 파티션으로 키가 집중되어 부하 편중</td><td>파티션 과부하, 병목 발생</td><td>파티션별 메시지 처리량 분석</td><td><strong>해시 기반 분산 키 전략, 키 재설계</strong></td><td><strong>파티션 수 증가, 샤딩 적용, 키 분산 재조정</strong></td></tr><tr><td>데이터 유실</td><td>저장소 고장, ACK 누락, 버퍼 유실 등</td><td>중요 이벤트 소실</td><td>로그, 모니터링, Lag 확인</td><td><strong>Replication, 장애 감지 자동화</strong></td><td><strong>재시도, 메시지 영속화, 장애 감지 후 자동 복구</strong></td></tr></tbody></table><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><table><thead><tr><th>카테고리</th><th>주요 이슈 (도전 과제)</th><th>원인 또는 상황</th><th>영향 또는 리스크</th><th>해결 및 대응 전략</th></tr></thead><tbody><tr><td><strong>확장성/성능</strong></td><td>대규모 트래픽 및 이벤트 증가</td><td>데이터 폭증, 소비자 증가, 불균형 파티션</td><td>처리 지연, 처리 실패, 브로커 과부하</td><td>자동 스케일링, 파티셔닝 키 설계, Backpressure 제어, 멀티 브로커 구성</td></tr><tr><td><strong>일관성/순서</strong></td><td>이벤트 순서 보장/정합성 유지 어려움</td><td>분산 환경의 병렬 처리, CAP 제약</td><td>상태 기반 처리 오류, 정합성 훼손</td><td>파티션 키 기반 순서 관리, Outbox 패턴, CDC 연동, SAGA/보상 트랜잭션 설계</td></tr><tr><td><strong>운영 복잡성</strong></td><td>다수 컴포넌트 간의 의존성과 복잡한 트레이싱</td><td>Pub/Sub 기반 구조, 호출 체인 없음</td><td>장애 원인 파악 지연, 운영 비용 증가</td><td>OpenTelemetry, 분산 트레이싱 도입, 통합 모니터링 대시보드 구축, GitOps 기반 운영 자동화</td></tr><tr><td><strong>신뢰성/내구성</strong></td><td>메시지 유실 및 중복 처리 위험</td><td>네트워크 장애, 브로커 장애, ACK 실패</td><td>데이터 불일치, 시스템 신뢰도 하락</td><td>메시지 리텐션 설정, DLQ(Dead Letter Queue), 중복 제거 처리 (Idempotency)</td></tr><tr><td><strong>보안/규정</strong></td><td>민감 정보 노출 및 무단 접근 가능성</td><td>멀티 브로커, 네트워크 기반 전송, 인증 미비</td><td>데이터 유출, 법적 이슈 발생</td><td>종단간 암호화 (TLS), 인증·인가 적용, RBAC 정책, GDPR/ISMS 등 컴플라이언스 대응</td></tr><tr><td><strong>표준화/호환성</strong></td><td>메시지 포맷 불일치 및 Schema 충돌</td><td>Producer 간 형식 다양성, 사전 합의 부재</td><td>Consumer 오류, 이벤트 파싱 실패</td><td>Schema Registry 도입 (e.g., Avro, Protobuf), 계약 기반 개발 (Contract-First) 적용</td></tr><tr><td><strong>비용/최적화</strong></td><td>과도한 이벤트 발행 및 무분별한 트리거링</td><td>잘못된 트리거 설계, 이벤트 필터 부재</td><td>처리 비용 증가, 리소스 낭비</td><td>필터링/샘플링 적용, Rate Limit 설정, 불필요 이벤트 차단 전략 (Pre-filter, Rule 기반 조건 설계 등)</td></tr><tr><td><strong>데이터 연계성</strong></td><td>관계형 DB 와 이벤트 연계 시 정합성 유지 어려움</td><td>트랜잭션과 이벤트 발행의 시간 차, 원자성 미보장</td><td>데이터 정합성 훼손, 장애 시 복구 복잡화</td><td>Outbox Pattern, Transactional Outbox + Polling Publisher, Eventual Consistency 설계 적용</td></tr></tbody></table><h3 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th><strong>분류 기준</strong></th><th><strong>유형</strong></th><th><strong>설명</strong></th><th><strong>대표 기술/예시</strong></th></tr></thead><tbody><tr><td><strong>1. 배포 방식</strong></td><td>온프레미스 (On-premise)</td><td>조직 내 자체 인프라에서 직접 설치/운영</td><td>Apache Kafka, RabbitMQ, NATS</td></tr><tr><td></td><td>클라우드 관리형 (Managed Service)</td><td>CSP 가 운영하며 확장성/가용성 자동 제공</td><td>AWS EventBridge, Azure Event Grid, GCP Pub/Sub</td></tr><tr><td></td><td>하이브리드</td><td>온프레미스와 클라우드의 통합 운영</td><td>Confluent Platform</td></tr><tr><td><strong>2. 처리 모델</strong></td><td>Pull 기반</td><td>소비자가 직접 메시지를 가져감 (polling)</td><td>Kafka Consumer, SQS</td></tr><tr><td></td><td>Push 기반</td><td>브로커가 컨슈머로 직접 메시지 전달</td><td>EventBridge → Lambda</td></tr><tr><td><strong>3. 메시지 전달 보장 (QoS)</strong></td><td>At-most-once</td><td>최대 1 회 전달, 유실 가능성 있음</td><td>빠른 처리 우선 시 사용</td></tr><tr><td></td><td>At-least-once</td><td>중복 허용, 데이터 손실 없음</td><td>Kafka 기본 동작, RabbitMQ</td></tr><tr><td></td><td>Exactly-once</td><td>정확히 한 번 처리, 높은 복잡도</td><td>Kafka Transactions</td></tr><tr><td><strong>4. 메시징 패턴</strong></td><td>Point-to-Point</td><td>1:1 통신, 작업 큐 모델</td><td>RabbitMQ Queue</td></tr><tr><td></td><td>Publish-Subscribe</td><td>1:N 통신, 구독자 모두에게 메시지 전달</td><td>Kafka, MQTT</td></tr><tr><td></td><td>Request-Reply</td><td>요청 후 응답 패턴, RPC 스타일</td><td>gRPC over Kafka, ZeroMQ</td></tr><tr><td><strong>5. 아키텍처 구조</strong></td><td>중앙 집중형 (Centralized)</td><td>단일 브로커 인스턴스/클러스터로 구성</td><td>RabbitMQ 단일 노드</td></tr><tr><td></td><td>분산형 (Distributed)</td><td>여러 노드로 구성된 클러스터</td><td>Kafka, Pulsar</td></tr><tr><td></td><td>메시 아키텍처 (Mesh)</td><td>브로커 간 직접 통신, 분산 라우팅</td><td>NATS, Solace, Kafka MirrorMaker</td></tr><tr><td><strong>6. 저장 방식</strong></td><td>In-memory</td><td>메시지를 메모리에만 저장, 휘발성</td><td>Redis PubSub</td></tr><tr><td></td><td>Disk-based</td><td>디스크에 영속 저장, 재처리 가능</td><td>Kafka, RabbitMQ</td></tr><tr><td></td><td>하이브리드</td><td>메모리와 디스크 혼합 전략</td><td>Apache Pulsar</td></tr><tr><td><strong>7. 메시지 처리 유형</strong></td><td>스트리밍 (Streaming)</td><td>실시간 연속 처리 모델</td><td>Kafka Streams, Flink</td></tr><tr><td></td><td>배치 (Batch)</td><td>일괄 처리, 주기적 트리거</td><td>Spark Structured Streaming</td></tr><tr><td><strong>8. 프로토콜</strong></td><td>AMQP</td><td>고급 메시징 기능 지원, 표준화</td><td>RabbitMQ, ActiveMQ</td></tr><tr><td></td><td>MQTT</td><td>경량 메시징, IoT 특화</td><td>Mosquitto, HiveMQ</td></tr><tr><td></td><td>STOMP</td><td>텍스트 기반 단순 프로토콜</td><td>RabbitMQ (웹 통신용)</td></tr><tr><td></td><td>Kafka Protocol</td><td>바이너리 TCP 기반 고성능 프로토콜</td><td>Apache Kafka</td></tr><tr><td><strong>9. 메시지 저장 모델</strong></td><td>큐 기반 (Queue-based)</td><td>메시지는 소비 후 삭제됨</td><td>RabbitMQ</td></tr><tr><td></td><td>로그 기반 (Log-based)</td><td>메시지는 로그로 저장되고 다중 소비 가능</td><td>Kafka, Pulsar</td></tr><tr><td></td><td>토픽 기반 (Topic-based)</td><td>메시지를 주제별로 분리/전파</td><td>Kafka, MQTT</td></tr><tr><td><strong>10. 대표 제품 유형</strong></td><td>메시지 브로커 (Message Broker)</td><td>큐 중심 메시징, 트랜잭션 지원</td><td>RabbitMQ, ActiveMQ</td></tr><tr><td></td><td>이벤트 브로커 (Event Broker)</td><td>이벤트 스트림, 로그 기반 처리</td><td>Kafka, EventStoreDB</td></tr><tr><td></td><td>서비스 버스 (Service Bus)</td><td>라우팅/변환/오케스트레이션 기능 포함</td><td>Azure Service Bus, NServiceBus</td></tr></tbody></table><h3 id=event-broker-기술별-비교>Event Broker 기술별 비교<a hidden class=anchor aria-hidden=true href=#event-broker-기술별-비교>#</a></h3><table><thead><tr><th>항목 구분</th><th>Apache Kafka</th><th>AWS EventBridge</th><th>Azure Event Grid</th><th>Google Cloud Eventarc</th></tr></thead><tbody><tr><td><strong>형태</strong></td><td>오픈소스, 자체 호스팅 (Self-Managed)</td><td>Fully Managed (서버리스)</td><td>Fully Managed (서버리스)</td><td>Fully Managed (서버리스, Kubernetes 기반)</td></tr><tr><td><strong>아키텍처 유형</strong></td><td>Pull 기반 Consumer Group 구조</td><td>Rule 기반 이벤트 라우팅 + Push</td><td>Event Subscription + HTTP Push</td><td>Event Trigger + Cloud Run 연계</td></tr><tr><td><strong>이벤트 보존</strong></td><td>디스크 기반 로그 저장 (Retention 설정 가능)</td><td>기본 TTL 존재 (장기 저장 불가)</td><td>기본 TTL 존재 (수분~수시간 수준)</td><td>일시적 처리 (장기 보존 미지원)</td></tr><tr><td><strong>필터링 기능</strong></td><td>Consumer 애플리케이션 내부 처리</td><td>Event Pattern 기반 JSON 필터</td><td>고급 필터 (속성 기반, 주제 기반 등)</td><td>조건 필터 + 대상 서비스 조합 가능</td></tr><tr><td><strong>성능 지표</strong></td><td>수백만 TPS 이상, 고성능 스트리밍</td><td>수만 TPS 수준</td><td>수만 TPS 수준</td><td>수천~수만 TPS 수준</td></tr><tr><td><strong>통합/연계성</strong></td><td>외부 시스템 및 커스텀 애플리케이션과 유연한 연계</td><td>AWS 서비스 및 SaaS 연계 최적화</td><td>Azure 리소스 및 서드파티 연동 최적화</td><td>GCP 서비스 (Cloud Run, Function 등) 연동 최적화</td></tr><tr><td><strong>재처리 지원</strong></td><td>✅ 오프셋 기반 재처리 (내구성 우수)</td><td>❌ 기본 미지원 (Lambda 재시도 설정 필요)</td><td>❌ 이벤트 재처리 구조 미제공</td><td>❌ Cloud Run 재실행 필요</td></tr><tr><td><strong>활용 사례</strong></td><td>IoT 센서 수집, 대용량 로그 스트림 분석</td><td>주문 생성 → Lambda 트리거</td><td>Azure Blob 생성 → Logic App 실행</td><td>Firebase 등록 이벤트 → 메일 발송</td></tr><tr><td><strong>강점 요약</strong></td><td>고성능, 내구성, 재처리/순서보장/파티셔닝 지원</td><td>AWS 서비스 간 손쉬운 통합, 간단한 서버리스 워크플로우</td><td>고급 필터링 및 Azure 서비스 통합</td><td>Kubernetes 및 GCP 기반 서버리스 최적화</td></tr><tr><td><strong>적합한 사용 시점</strong></td><td>대용량 스트리밍, 재처리 필요, 멀티컨슈머 구조</td><td>간단한 이벤트 트리거 자동화, AWS SaaS 연동</td><td>리소스 이벤트 감지 및 처리 자동화</td><td>GCP 이벤트 기반 서버리스 파이프라인 구축</td></tr></tbody></table><h4 id=요약>요약<a hidden class=anchor aria-hidden=true href=#요약>#</a></h4><table><thead><tr><th>구분</th><th>분석 결과 요약</th></tr></thead><tbody><tr><td><strong>Kafka</strong></td><td>자체 호스팅 기반으로 고성능 이벤트 스트리밍, 이벤트 재처리, 내구성 요구 환경에 적합. 컨슈머 그룹으로 다중 처리 가능. 복잡하지만 유연함.</td></tr><tr><td><strong>AWS EventBridge</strong></td><td>AWS 환경에서 Lambda 등과 결합 시 매우 간단하게 이벤트 처리 가능. 서버리스와 SaaS 연동이 쉽고, 간단한 이벤트 기반 워크플로우에 최적.</td></tr><tr><td><strong>Azure Event Grid</strong></td><td>Azure 자원 이벤트 처리에 최적화되어 있으며, 고급 필터링 및 HTTP Push 연동 기능 강력. Logic App 과의 연계 유용.</td></tr><tr><td><strong>Google Eventarc</strong></td><td>GCP 내 Cloud Run 기반 서버리스 워크플로우 구성에 강점. Kubernetes 기반 워크플로우 또는 Firebase 등과의 연계에 특화.</td></tr></tbody></table><h3 id=event-broker-구축-예제>Event Broker 구축 예제<a hidden class=anchor aria-hidden=true href=#event-broker-구축-예제>#</a></h3><p>Kafka 를 사용하여 Event Broker 환경을 구축하고 간단한 <strong>Producer-Consumer</strong> 이벤트 흐름을 구현한다.</p><p><strong>구성</strong>:</p><ul><li>Apache Kafka</li><li>Python (<code>kafka-python</code> 라이브러리)</li></ul><ol><li><p>설치 준비</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3>3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4>4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5>5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6>6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7>7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8>8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Kafka &amp; Zookeeper 실행 (Docker 기반 예시)</span>
</span></span><span class=line><span class=cl>docker run -d --name zookeeper -p 2181:2181 zookeeper
</span></span><span class=line><span class=cl>docker run -d --name kafka -p 9092:9092 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -e <span class=nv>KAFKA_ZOOKEEPER_CONNECT</span><span class=o>=</span>zookeeper:2181 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -e <span class=nv>KAFKA_ADVERTISED_LISTENERS</span><span class=o>=</span>PLAINTEXT://localhost:9092 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -e <span class=nv>KAFKA_LISTENER_SECURITY_PROTOCOL_MAP</span><span class=o>=</span>PLAINTEXT:PLAINTEXT <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -e <span class=nv>KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR</span><span class=o>=</span><span class=m>1</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --network<span class=o>=</span>host <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  confluentinc/cp-kafka
</span></span></code></pre></td></tr></table></div></div></li><li><p>Python Producer 코드</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># producer.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaProducer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_serializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>v</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>v</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>event</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;event_type&#39;</span><span class=p>:</span> <span class=s1>&#39;OrderCreated&#39;</span><span class=p>,</span> <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=mi>1234</span><span class=p>,</span> <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=mi>5678</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s1>&#39;order-events&#39;</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>producer</span><span class=o>.</span><span class=n>flush</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;✅ OrderCreated 이벤트 전송 완료&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>Python Consumer 코드</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># consumer.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaConsumer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;order-events&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>auto_offset_reset</span><span class=o>=</span><span class=s1>&#39;earliest&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>group_id</span><span class=o>=</span><span class=s1>&#39;order-service&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_deserializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>message</span> <span class=ow>in</span> <span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;✅ 수신된 이벤트: </span><span class=si>{</span><span class=n>message</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h4 id=kafka-모니터링-지표-및-실전-대시보드-구성>Kafka 모니터링 지표 및 실전 대시보드 구성<a hidden class=anchor aria-hidden=true href=#kafka-모니터링-지표-및-실전-대시보드-구성>#</a></h4><p><strong>Tool</strong>: Prometheus + Grafana<br><strong>주요 지표</strong>:</p><table><thead><tr><th>지표</th><th>설명</th></tr></thead><tbody><tr><td><code>kafka_server_brokertopicmetrics_messages_in_total</code></td><td>초당 수신 메시지 수</td></tr><tr><td><code>kafka_server_brokertopicmetrics_bytes_in_total</code></td><td>수신 바이트 수</td></tr><tr><td><code>kafka_server_brokertopicmetrics_bytes_out_total</code></td><td>전송 바이트 수</td></tr><tr><td><code>kafka_server_replicamanager_underreplicated_partitions</code></td><td>동기화 안된 파티션 수</td></tr><tr><td><code>kafka_network_requestmetrics_requests_total</code></td><td>총 네트워크 요청 수</td></tr><tr><td><code>kafka_controller_kafkacontroller_activecontrollercount</code></td><td>활성 컨트롤러 수 (1 이 아니면 비정상)</td></tr><tr><td><code>kafka_log_logsize</code></td><td>토픽/파티션별 로그 사이즈</td></tr></tbody></table><p><strong>실전 대시보드 구성</strong></p><ol><li><p><strong>Exporter 설치</strong><br>Kafka 용 JMX Exporter 사용:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java -javaagent:/opt/jmx_prometheus_javaagent.jar<span class=o>=</span>7071:/opt/kafka.yml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>     -jar kafka-server-start.sh …
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Prometheus 설정 예시</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2>2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3>3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;kafka&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;localhost:7071&#39;</span><span class=p>]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Grafana 대시보드 템플릿</strong></p><ul><li>ID: <code>7589</code> (confluentinc 제공 Kafka Dashboard)</li><li>대시보드 포함 항목:<ul><li>브로커별 처리량</li><li>파티션 상태</li><li>lag 상태</li><li>consumer group health</li><li>메시지 지연 현황</li></ul></li></ul></li></ol><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>고려사항</strong></th><th><strong>설명</strong></th><th><strong>권장사항</strong></th></tr></thead><tbody><tr><td><strong>1. 토픽/파티션 설계</strong></td><td>토픽 네이밍/구조 설계</td><td>도메인 중심의 계층적 토픽 설계가 필요함</td><td><code>도메인.이벤트명</code> 규칙 적용 (<code>order.created</code>)</td></tr><tr><td></td><td>파티션 전략 및 수량</td><td>병렬성 확보, 순서 보장 위한 파티션 설계</td><td>키 기반 파티셔닝, 예상 처리량의 2~3 배로 설정</td></tr><tr><td><strong>2. 메시지 일관성</strong></td><td>메시지 순서 및 중복 처리</td><td>중복 소비/재처리 방지 및 순서 보장 필요</td><td>메시지 ID, 타임스탬프, 멱등 소비자 처리</td></tr><tr><td></td><td>멱등성 (Idempotency)</td><td>중복 이벤트 수신 시 상태 변화 방지</td><td>상태 조회 기반 멱등 처리 또는 상태머신 적용</td></tr><tr><td><strong>3. 장애 복구 및 실패 처리</strong></td><td>메시지 유실/지연 대응</td><td>브로커 장애, 소비자 실패 시 데이터 보호</td><td>DLQ 구성, Retry 전략, Replication 적용</td></tr><tr><td></td><td>메시지 재처리</td><td>장애 후 재처리 위한 이벤트 보존 필요</td><td>Kafka replay, TTL 기반 재전송 지원</td></tr><tr><td><strong>4. 모니터링 및 가시성</strong></td><td>이벤트 흐름 추적 및 문제 진단</td><td>흐름 시각화 및 에러 식별 필요</td><td>OpenTelemetry, Prometheus, Kafka UI 등 도입</td></tr><tr><td></td><td>실시간 지표 모니터링</td><td>처리량, 지연, 실패율 등 지표 확인 필요</td><td>APM, 알림, 대시보드 구축</td></tr><tr><td><strong>5. 스키마 관리</strong></td><td>이벤트 포맷 일관성 및 진화 전략</td><td>버전 충돌, 하위 호환성 문제 방지 필요</td><td>Schema Registry 도입, Avro/Protobuf 적용</td></tr><tr><td></td><td>필드 변경/추가 대응</td><td>소비자 호환성 유지 필요</td><td>backward-compatible 스키마 설계</td></tr><tr><td><strong>6. 성능 최적화</strong></td><td>배치 크기/지연 시간 조절</td><td>처리량과 응답 속도 간 균형 조정 필요</td><td><code>linger.ms</code>, <code>batch.size</code> 등 튜닝</td></tr><tr><td></td><td>압축 및 캐싱</td><td>전송 및 저장 효율 향상</td><td>snappy/gzip 압축, 커넥션 풀, 메타데이터 캐시</td></tr><tr><td><strong>7. 보안 및 접근 제어</strong></td><td>인증/인가</td><td>메시지 접근 통제 및 식별자 관리</td><td>IAM, JWT, SASL, ACL 설정</td></tr><tr><td></td><td>암호화</td><td>데이터 전송/저장 보호</td><td>TLS/SSL 적용, 디스크 암호화</td></tr><tr><td></td><td>감사 및 감사 로그</td><td>접근/변경 기록 추적</td><td>감사 로그 수집 및 보존 정책 설정</td></tr><tr><td><strong>8. 배포 및 인프라 전략</strong></td><td>고가용성 구성</td><td>단일 장애점 제거 및 무중단 운영</td><td>멀티 AZ, 클러스터 구성, 자동 장애 조치 설정</td></tr><tr><td></td><td>자동 확장</td><td>트래픽 급증 대응</td><td>Horizontal Pod Autoscaler, KEDA 등 사용</td></tr><tr><td></td><td>백업 및 재해 복구</td><td>데이터 손실 방지</td><td>정기 백업 + 재해 복구 시나리오 문서화</td></tr><tr><td><strong>9. 용량 및 트래픽 계획</strong></td><td>메시지 양/트래픽 예측</td><td>리소스 부족 시 병목/지연 발생 가능성</td><td>예측 기반 스케일링, Kafka Cruise Control 도입</td></tr><tr><td></td><td>스토리지 최적화</td><td>이벤트 보존 설정과 디스크 용량 균형</td><td>보존 기간 조절, 압축 전략, 토픽 정리</td></tr><tr><td><strong>10. 우선순위 및 QoS</strong></td><td>중요도 기반 메시지 처리</td><td>긴급 메시지 우선 처리 필요</td><td>우선순위 큐, 별도 토픽/채널로 분리</td></tr><tr><td></td><td>QoS (전달 보장 수준)</td><td>At-least-once vs Exactly-once 결정 필요</td><td>트랜잭션 + 멱등 프로듀서 설정 (Kafka 기준)</td></tr></tbody></table><h4 id=아키텍처-설계-시-고려-요소>아키텍처 설계 시 고려 요소<a hidden class=anchor aria-hidden=true href=#아키텍처-설계-시-고려-요소>#</a></h4><table><thead><tr><th>고려 항목</th><th>설명</th><th>권장 사항</th></tr></thead><tbody><tr><td><strong>도메인 분리</strong></td><td>이벤트는 업무 도메인 단위로 구성되어야 함</td><td><code>order.created</code>, <code>payment.success</code> 등 명확한 이벤트 명명</td></tr><tr><td><strong>이벤트 흐름 시각화</strong></td><td>전체 이벤트 흐름을 설계 초기부터 도식화</td><td>Sequence Diagram, Event Map 활용</td></tr><tr><td><strong>브로커 선택</strong></td><td>워크로드와 운영 역량에 따라 선택</td><td>대규모 실시간: Kafka / 간단 자동화: EventBridge</td></tr><tr><td><strong>스키마 관리</strong></td><td>이벤트 스키마는 반드시 버저닝 및 관리 필요</td><td>Avro + Schema Registry 구성 필수</td></tr><tr><td><strong>멱등성 처리</strong></td><td>중복 이벤트에 안전한 설계 필요</td><td>이벤트 ID + 상태 기반 로직 설계</td></tr></tbody></table><h4 id=배포-전략>배포 전략<a hidden class=anchor aria-hidden=true href=#배포-전략>#</a></h4><table><thead><tr><th>항목</th><th>전략</th><th>도구</th></tr></thead><tbody><tr><td>브로커 배포</td><td>자체 운영 또는 매니지드</td><td>Kafka, AWS MSK, GCP Pub/Sub</td></tr><tr><td>메시지 소비자 배포</td><td>컨테이너 또는 서버리스 함수</td><td>Docker, Kubernetes, AWS Lambda</td></tr><tr><td>토픽/구독 설정 자동화</td><td>IaC 기반 구성</td><td>Terraform, AWS CDK, Azure Bicep</td></tr><tr><td>모니터링 연동</td><td>이벤트 지연/누락 추적</td><td>Prometheus, Datadog, Kafka Lag Exporter</td></tr><tr><td>보안 설정</td><td>IAM, 인증서, 메시지 암호화</td><td>TLS, VPC 연결, OAuth/JWT 인증 등</td></tr></tbody></table><h4 id=테스트-및-검증-전략>테스트 및 검증 전략<a hidden class=anchor aria-hidden=true href=#테스트-및-검증-전략>#</a></h4><table><thead><tr><th>테스트 항목</th><th>설명</th><th>도구/기법</th></tr></thead><tbody><tr><td><strong>계약 기반 테스트</strong></td><td>Producer 와 Consumer 간 메시지 형식 합의</td><td>Pact, Spring Cloud Contract</td></tr><tr><td><strong>성능 테스트</strong></td><td>TPS, 처리 지연, 이벤트 누락 여부 검증</td><td>JMeter, Locust, Kafka-producer-perf-test</td></tr><tr><td><strong>오류 시나리오</strong></td><td>브로커 장애, 네트워크 단절, 소비자 중단</td><td>Chaos Monkey, ToxiProxy</td></tr><tr><td><strong>재처리 시나리오</strong></td><td>이벤트 리플레이가 정상 동작하는지</td><td>Kafka Consumer Offset Reset</td></tr><tr><td><strong>보안 테스트</strong></td><td>인증 미비, 권한 우회 등 검증</td><td>IAM Role 테스트, 토픽 접근 제어 테스트</td></tr></tbody></table><h4 id=운영-자동화-및-모니터링>운영 자동화 및 모니터링<a hidden class=anchor aria-hidden=true href=#운영-자동화-및-모니터링>#</a></h4><h5 id=운영-항목>운영 항목<a hidden class=anchor aria-hidden=true href=#운영-항목>#</a></h5><table><thead><tr><th>항목</th><th>모니터링 지표</th><th>도구</th></tr></thead><tbody><tr><td><strong>브로커 상태</strong></td><td>CPU, Disk I/O, Partition Lag</td><td>Prometheus + Grafana</td></tr><tr><td><strong>이벤트 처리 지연</strong></td><td>Consumer Lag, 처리 시간</td><td>Kafka Lag Exporter</td></tr><tr><td><strong>이벤트 유실/중복</strong></td><td>전송 실패율, DLQ 비율</td><td>AWS CloudWatch, Elastic</td></tr><tr><td><strong>보안 감사</strong></td><td>접근 로그, 인증 실패 로그</td><td>CloudTrail, Kafka Audit Logs</td></tr><tr><td><strong>스키마 변경 추적</strong></td><td>Schema version 변경, Incompatibility 감지</td><td>Confluent Schema Registry, diff 도구</td></tr></tbody></table><h5 id=자동화-요소>자동화 요소<a hidden class=anchor aria-hidden=true href=#자동화-요소>#</a></h5><table><thead><tr><th>자동화 영역</th><th>방법</th></tr></thead><tbody><tr><td>토픽 생성/관리</td><td>IaC (Terraform, CDK)</td></tr><tr><td>알림 설정</td><td>Slack, PagerDuty 연동</td></tr><tr><td>소비자 배포 파이프라인</td><td>GitOps, ArgoCD, GitHub Actions</td></tr><tr><td>리플레이 트리거</td><td>Kafka CLI, Lambda 트리거 구성</td></tr><tr><td>소비자 헬스체크</td><td>Kubernetes liveness/readiness probes</td></tr></tbody></table><h3 id=최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>카테고리</th><th>고려사항</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td><strong>1. 메시지 처리 최적화</strong></td><td>메시지 크기 제한</td><td>메시지가 너무 크면 브로커, 네트워크에 부하 발생</td><td>메시지 크기 제한 설정 (ex: 1~10MB), 대용량은 외부 저장소 활용, 압축 적용</td></tr><tr><td></td><td>배치 처리</td><td>개별 메시지 전송은 오버헤드 큼</td><td><code>linger.ms</code>, <code>batch.size</code> 최적화, Consumer Poll 조정</td></tr><tr><td></td><td>압축 전략</td><td>네트워크 효율은 높이지만 CPU 부하 발생</td><td>Snappy, ZSTD 등 적절한 알고리즘 선택 및 압축 수준 조절</td></tr><tr><td></td><td>이벤트 경량화</td><td>메시지 내용 중 불필요 데이터 제거</td><td>Avro, Protobuf 등 경량 포맷 사용</td></tr><tr><td><strong>2. 파티션/병렬성 설계</strong></td><td>파티션 전략</td><td>파티션 수는 병렬성/순서 보장에 직접 영향</td><td>파티션 수 = 소비자 수 고려, 키 기반 파티션 전략 적용, 핫 파티션 방지</td></tr><tr><td></td><td>소비자 그룹 설계</td><td>잘못된 그룹 구성은 오히려 처리량 감소</td><td>병렬 처리 극대화를 위한 균형 잡힌 파티션 할당</td></tr><tr><td></td><td>스레드 및 워커 설정</td><td>스레드/워크자 수 부족 시 처리 병목 발생</td><td>멀티스레드 처리 또는 비동기 워커 활용</td></tr><tr><td><strong>3. 네트워크/IO 최적화</strong></td><td>네트워크 지연/대역폭</td><td>지역 간 전송, 느린 네트워크는 Latency 증가</td><td>브로커 - 클라이언트 근접 배치, TCP 튜닝, 전용 네트워크 고려</td></tr><tr><td></td><td>디스크 I/O</td><td>디스크 쓰기 지연은 메시지 저장 지연으로 직결</td><td>SSD 사용, 로그 세그먼트 최적화, I/O 스레드 분리</td></tr><tr><td></td><td>캐싱 전략</td><td>반복 요청/메타데이터 접근 비용 발생</td><td>클라이언트 메타데이터 캐싱, 캐시 무효화 정책 수립</td></tr><tr><td><strong>4. 리소스 관리 및 인프라</strong></td><td>CPU / 메모리</td><td>JVM, 네이티브 메모리 부족 시 GC, 성능 저하 유발</td><td>JVM 튜닝, 힙/버퍼 설정 최적화, 컨테이너 리소스 설정 조정</td></tr><tr><td></td><td>오토스케일링</td><td>고정 노드는 트래픽 급증에 대응 어려움</td><td>KEDA, AutoScalingGroup 등 자동 확장 구성</td></tr><tr><td></td><td>Broker 설정</td><td>기본 설정이 워크로드에 부적합할 수 있음</td><td>브로커당 처리량, 큐 크기, 내부 버퍼 최적화</td></tr><tr><td><strong>5. 장애 복구/안정성</strong></td><td>복제 전략</td><td>복제는 장애 복구에 중요하지만 과도하면 성능 저하</td><td>비동기 복제 활용, 적절한 ISR(In-Sync Replica) 수 설정</td></tr><tr><td></td><td>DLQ 구성</td><td>장애 메시지 처리 실패 시 무한 루프/손실 발생 위험</td><td>Dead Letter Queue 활용, 재시도 정책 적용</td></tr><tr><td></td><td>백프레셔</td><td>과부하 시 시스템 전체 성능 저하</td><td>Throttling, Circuit Breaker 패턴 도입</td></tr><tr><td><strong>6. 운영 및 모니터링</strong></td><td>모니터링 오버헤드</td><td>과도한 지표 수집은 처리 흐름에 부정적 영향</td><td>샘플링 적용, 핵심 지표만 수집, Prometheus, Datadog 활용</td></tr><tr><td></td><td>성능 지표 추적</td><td>Throughput, Latency, Lag 등 실시간 분석 필요</td><td>Grafana + Prometheus + Alertmanager 등 연계</td></tr><tr><td></td><td>장애 탐지/알림</td><td>장애 발생 시 빠른 대응 필수</td><td>자동화된 장애 감지 및 알림 시스템 구축 (예: AIOps 연동)</td></tr><tr><td><strong>7. 보존 및 데이터 정책</strong></td><td>메시지 보존</td><td>메시지를 너무 오래 저장하면 스토리지 비용 증가</td><td>주기적 만료 설정, Retention 정책 정의, 히스토리 백업</td></tr><tr><td></td><td>스토리지 관리</td><td>로그 누적이 디스크 병목을 유발할 수 있음</td><td>계층형 스토리지 구성 (hot/cold), 메시지 압축 활성화</td></tr></tbody></table><h3 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h3><table><thead><tr><th>📌 적용 분야</th><th>대표 시나리오</th><th>사용 기술</th><th>주요 효과</th></tr></thead><tbody><tr><td><strong>1. 전자상거래 / 주문 처리</strong></td><td>주문 이벤트 기반 멀티 서비스 처리 (결제, 재고, 배송 등)</td><td>Kafka, RabbitMQ, SQS, Spring Boot, MongoDB</td><td>주문 워크플로우 비동기 처리, 확장성 확보</td></tr><tr><td><strong>2. 실시간 알림 서비스</strong></td><td>사용자 활동 (댓글, 좋아요 등) 에 대한 실시간 알림</td><td>Kafka, Redis PubSub, Solace, AWS SNS</td><td>실시간 반응형 UX, 빠른 알림 분배</td></tr><tr><td><strong>3. IoT / 센서 네트워크</strong></td><td>대규모 센서 데이터의 실시간 수집 및 처리</td><td>MQTT, Kafka, Google Eventarc, InfluxDB, Grafana</td><td>고빈도 이벤트 처리, 실시간 모니터링</td></tr><tr><td><strong>4. 데이터 파이프라인 / 분석</strong></td><td>데이터 이벤트 기반 스트리밍 처리 및 ELT 파이프라인 구성</td><td>Kafka Connect, Apache Flink, EventBridge, ELK, BigQuery</td><td>대용량 실시간 분석, ETL 자동화</td></tr><tr><td><strong>5. 금융 / 거래 추적</strong></td><td>실시간 결제 흐름, 사기 탐지, 거래 분석</td><td>Kafka, Flink, Elasticsearch, Apache Pulsar</td><td>트랜잭션 추적, 이상 탐지, 실시간 정합성</td></tr><tr><td><strong>6. 마이크로서비스 통합</strong></td><td>서비스 간 느슨한 결합 기반 비동기 이벤트 통신</td><td>Kafka, RabbitMQ, Azure Event Grid, Docker, Istio</td><td>독립적 배포, 서비스 확장 유연성</td></tr><tr><td><strong>7. 로그 수집 및 모니터링</strong></td><td>마이크로서비스의 로그/메트릭을 중앙 시스템으로 전송</td><td>Kafka, Fluentd, OpenTelemetry, Prometheus, Grafana</td><td>시스템 상태 가시성 향상, 장애 대응</td></tr><tr><td><strong>8. 서버리스 자동화</strong></td><td>클라우드 리소스 변경, 예약 이벤트에 따른 Lambda 트리거 실행</td><td>AWS EventBridge + Lambda, Azure Functions, GCP Eventarc</td><td>인프라 자동화, 코드 간소화</td></tr><tr><td><strong>9. 실시간 사용자 추적</strong></td><td>사용자의 웹/앱 활동 실시간 분석 및 추천 시스템 연결</td><td>Azure Event Hub, Kafka, Apache Spark, Snowflake Streams</td><td>행동 분석 기반 실시간 추천 강화</td></tr></tbody></table><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><h4 id=사례-1-iot-센서-로그와-웹-서버-로그를-실시간으로-수집분석>사례 1: IoT 센서 로그와 웹 서버 로그를 실시간으로 수집·분석<a hidden class=anchor aria-hidden=true href=#사례-1-iot-센서-로그와-웹-서버-로그를-실시간으로-수집분석>#</a></h4><p><strong>시스템 구성도</strong></p><pre class=mermaid>flowchart LR
    IoT[IoT/웹서버] --&gt; Broker[Event Broker]
    Broker --&gt; Analyzer[Log Analyzer/Consumer]
    Broker --&gt; Storage[Raw Log 저장소]
    Analyzer --&gt; BI[DashBoard/Alert]
</pre><p><strong>Workflow</strong></p><ol><li>IoT/웹서버에서 로그 이벤트 발생 → 브로커로 발행</li><li>브로커가 Analyzer(실시간 처리) 및 Storage(저장) 에 동시에 브로드캐스트</li><li>Analyzer 는 실시간 알림 또는 대시보드에 결과 전달</li></ol><p><strong>주제의 역할</strong>: 서로 다른 데이터 소스를 빠짐 없이 실시간 브로드캐스팅, 대용량 처리, 장애 시 재처리 가능</p><p><strong>유무 차이</strong>: 이벤트 브로커 없을 시, 다수 대상 동시 전달 힘들고 확장/유지보수 취약, 장애 전파 쉬움</p><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1> 1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2> 2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3> 3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4> 4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5> 5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6> 6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7> 7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8> 8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9> 9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10>10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11>11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12>12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13>13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14>14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15>15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16>16</a>
</span><span class=lnt id=hl-8-17><a class=lnlinks href=#hl-8-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Kafka를 통한 이벤트 브로커 실습 예시</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaProducer</span><span class=p>,</span> <span class=n>KafkaConsumer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Producer - 이벤트 전송</span>
</span></span><span class=line><span class=cl><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span><span class=n>bootstrap_servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s1>&#39;log-events&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;{&#34;msg&#34;:&#34;로그 수집 이벤트&#34;}&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Consumer - 이벤트 수신</span>
</span></span><span class=line><span class=cl><span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;log-events&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>auto_offset_reset</span><span class=o>=</span><span class=s1>&#39;earliest&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>group_id</span><span class=o>=</span><span class=s1>&#39;log-analyzer&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>message</span> <span class=ow>in</span> <span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;수신된 이벤트: </span><span class=si>{</span><span class=n>message</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 이곳에 실시간 분석 등 처리 준비</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Producer 는 &rsquo;log-events&rsquo; 토픽에 메시지를 보내고, Consumer 는 같은 토픽을 구독하여 메시지를 실시간으로 소비/처리</li></ul><h4 id=사례-2-이커머스-주문-시스템에서의-event-broker-활용>사례 2: 이커머스 주문 시스템에서의 Event Broker 활용<a hidden class=anchor aria-hidden=true href=#사례-2-이커머스-주문-시스템에서의-event-broker-활용>#</a></h4><p><strong>시스템 구성</strong>:</p><ul><li><strong>Producer</strong>: 주문 마이크로서비스</li><li><strong>Broker</strong>: Apache Kafka</li><li><strong>Consumer</strong>:<ul><li>재고 시스템</li><li>배송 시스템</li><li>알림 서비스</li><li>이벤트 로깅 (ELK)</li></ul></li></ul><pre class=mermaid>flowchart TD
    A[Order Service] --&gt; B[Kafka Topic: order.created]
    B --&gt; C[Inventory Service]
    B --&gt; D[Shipping Service]
    B --&gt; E[Notification Service]
    B --&gt; F[Analytics Dashboard]
</pre><p><strong>Workflow</strong>:</p><ol><li><code>order.created</code> 이벤트가 Kafka 에 발행됨</li><li>Kafka 는 이를 다수 Consumer 에 브로드캐스트</li><li>각 Consumer 는 독립적으로 이벤트를 처리 (예: 배송 트리거, 알림 전송, 재고 차감)</li></ol><p><strong>역할 분석</strong>:</p><ul><li><strong>Event Broker</strong>는 Producer-Consumer 간 결합을 제거</li><li>복수 시스템에서 <strong>동시에 이벤트 소비</strong> 가능</li><li>Kafka 는 <strong>이벤트 로그를 유지</strong>하여 리플레이/장애 복구도 지원</li></ul><p><strong>유무 비교</strong>:</p><table><thead><tr><th>항목</th><th>Event Broker 사용</th><th>미사용 시</th></tr></thead><tbody><tr><td>이벤트 분기</td><td>다수 시스템 자동 처리</td><td>명시적 코드로 분기 필요</td></tr><tr><td>장애 대응</td><td>개별 서비스 영향 없음</td><td>동기 호출 시 전체 실패 가능성</td></tr><tr><td>확장성</td><td>새로운 소비자 즉시 추가 가능</td><td>기존 서비스 코드 수정 필요</td></tr></tbody></table><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span><span class=lnt id=hl-10-16><a class=lnlinks href=#hl-10-16>16</a>
</span><span class=lnt id=hl-10-17><a class=lnlinks href=#hl-10-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Kafka Producer - 주문 이벤트 발행</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaProducer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_serializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>v</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>v</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>order_event</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;order_id&#34;</span><span class=p>:</span> <span class=mi>1001</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;created&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;timestamp&#34;</span><span class=p>:</span> <span class=s2>&#34;2025-07-18T09:00:00Z&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s1>&#39;order.created&#39;</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=n>order_event</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>producer</span><span class=o>.</span><span class=n>flush</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Kafka Consumer - 배송 서비스</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaConsumer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;order.created&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>group_id</span><span class=o>=</span><span class=s1>&#39;shipping-service&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_deserializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>msg</span> <span class=ow>in</span> <span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>order</span> <span class=o>=</span> <span class=n>msg</span><span class=o>.</span><span class=n>value</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;배송 처리 시작 - 주문번호: </span><span class=si>{</span><span class=n>order</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 배송 처리 로직</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-3-글로벌-전자상거래-플랫폼의-실시간-주문-처리>사례 3: 글로벌 전자상거래 플랫폼의 실시간 주문 처리<a hidden class=anchor aria-hidden=true href=#사례-3-글로벌-전자상거래-플랫폼의-실시간-주문-처리>#</a></h4><p>대형 전자상거래 플랫폼에서 Event Broker 를 활용하여 주문부터 배송까지의 전체 워크플로우를 실시간으로 처리하는 시스템을 구축한 사례.</p><p><strong>시스템 구성</strong></p><pre class=mermaid>graph TB
    subgraph &#34;Frontend Layer&#34;
        WEB[Web Application]
        MOBILE[Mobile App]
        API[API Gateway]
    end
    
    subgraph &#34;Event Broker Infrastructure&#34;
        KAFKA[Apache Kafka Cluster]
    end
    
    subgraph &#34;Microservices&#34;
        ORDER[Order Service]
        PAYMENT[Payment Service]
        INVENTORY[Inventory Service]
        SHIPPING[Shipping Service]
        NOTIFICATION[Notification Service]
        ANALYTICS[Analytics Service]
    end
    
    subgraph &#34;Data Storage&#34;
        ORDERDB[(Order DB)]
        INVENTORYDB[(Inventory DB)]
        USERDB[(User DB)]
        CACHE[(Redis Cache)]
    end
    
    WEB --&gt; API
    MOBILE --&gt; API
    API --&gt; ORDER
    
    ORDER --&gt; KAFKA
    PAYMENT --&gt; KAFKA
    INVENTORY --&gt; KAFKA
    SHIPPING --&gt; KAFKA
    
    KAFKA --&gt; ORDER
    KAFKA --&gt; PAYMENT
    KAFKA --&gt; INVENTORY
    KAFKA --&gt; SHIPPING
    KAFKA --&gt; NOTIFICATION
    KAFKA --&gt; ANALYTICS
    
    ORDER --&gt; ORDERDB
    INVENTORY --&gt; INVENTORYDB
    PAYMENT --&gt; USERDB
    NOTIFICATION --&gt; CACHE
</pre><p><strong>워크플로우</strong></p><pre class=mermaid>sequenceDiagram
    participant Customer
    participant OrderService
    participant EventBroker
    participant PaymentService
    participant InventoryService
    participant ShippingService
    participant NotificationService
    
    Customer-&gt;&gt;OrderService: 주문 요청
    OrderService-&gt;&gt;EventBroker: order.created 이벤트 발행
    
    EventBroker-&gt;&gt;PaymentService: 결제 처리 트리거
    EventBroker-&gt;&gt;InventoryService: 재고 확인 트리거
    
    PaymentService-&gt;&gt;EventBroker: payment.processed 이벤트 발행
    InventoryService-&gt;&gt;EventBroker: inventory.reserved 이벤트 발행
    
    EventBroker-&gt;&gt;ShippingService: 배송 준비 트리거
    EventBroker-&gt;&gt;NotificationService: 고객 알림 트리거
    
    ShippingService-&gt;&gt;EventBroker: shipping.prepared 이벤트 발행
    EventBroker-&gt;&gt;NotificationService: 배송 알림 트리거
    NotificationService-&gt;&gt;Customer: 주문 완료 알림
</pre><p><strong>Event Broker 의 역할</strong></p><ul><li><strong>실시간 이벤트 라우팅</strong>: 주문 생성 시 관련된 모든 서비스에 즉시 알림</li><li><strong>비동기 처리</strong>: 각 서비스가 독립적으로 작업을 수행하여 전체 응답 시간 단축</li><li><strong>장애 격리</strong>: 한 서비스의 장애가 다른 서비스에 미치는 영향 최소화</li><li><strong>확장성</strong>: 트래픽 증가 시 개별 서비스 확장 가능</li></ul><p><strong>Event Broker 유무에 따른 차이점</strong></p><ul><li><strong>Event Broker 사용 시:</strong><ul><li>평균 주문 처리 시간: 2-3 초</li><li>시스템 간 결합도: 낮음</li><li>확장성: 개별 서비스 단위로 수평 확장 가능</li><li>장애 영향 범위: 제한적</li></ul></li><li><strong>Event Broker 미사용 시 (동기식 API 호출):</strong><ul><li>평균 주문 처리 시간: 8-12 초</li><li>시스템 간 결합도: 높음</li><li>확장성: 전체 시스템 단위로만 확장 가능</li><li>장애 영향 범위: 연쇄적 장애 발생 가능</li></ul></li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1>  1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2>  2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3>  3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4>  4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5>  5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6>  6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7>  7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8>  8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9>  9</a>
</span><span class=lnt id=hl-14-10><a class=lnlinks href=#hl-14-10> 10</a>
</span><span class=lnt id=hl-14-11><a class=lnlinks href=#hl-14-11> 11</a>
</span><span class=lnt id=hl-14-12><a class=lnlinks href=#hl-14-12> 12</a>
</span><span class=lnt id=hl-14-13><a class=lnlinks href=#hl-14-13> 13</a>
</span><span class=lnt id=hl-14-14><a class=lnlinks href=#hl-14-14> 14</a>
</span><span class=lnt id=hl-14-15><a class=lnlinks href=#hl-14-15> 15</a>
</span><span class=lnt id=hl-14-16><a class=lnlinks href=#hl-14-16> 16</a>
</span><span class=lnt id=hl-14-17><a class=lnlinks href=#hl-14-17> 17</a>
</span><span class=lnt id=hl-14-18><a class=lnlinks href=#hl-14-18> 18</a>
</span><span class=lnt id=hl-14-19><a class=lnlinks href=#hl-14-19> 19</a>
</span><span class=lnt id=hl-14-20><a class=lnlinks href=#hl-14-20> 20</a>
</span><span class=lnt id=hl-14-21><a class=lnlinks href=#hl-14-21> 21</a>
</span><span class=lnt id=hl-14-22><a class=lnlinks href=#hl-14-22> 22</a>
</span><span class=lnt id=hl-14-23><a class=lnlinks href=#hl-14-23> 23</a>
</span><span class=lnt id=hl-14-24><a class=lnlinks href=#hl-14-24> 24</a>
</span><span class=lnt id=hl-14-25><a class=lnlinks href=#hl-14-25> 25</a>
</span><span class=lnt id=hl-14-26><a class=lnlinks href=#hl-14-26> 26</a>
</span><span class=lnt id=hl-14-27><a class=lnlinks href=#hl-14-27> 27</a>
</span><span class=lnt id=hl-14-28><a class=lnlinks href=#hl-14-28> 28</a>
</span><span class=lnt id=hl-14-29><a class=lnlinks href=#hl-14-29> 29</a>
</span><span class=lnt id=hl-14-30><a class=lnlinks href=#hl-14-30> 30</a>
</span><span class=lnt id=hl-14-31><a class=lnlinks href=#hl-14-31> 31</a>
</span><span class=lnt id=hl-14-32><a class=lnlinks href=#hl-14-32> 32</a>
</span><span class=lnt id=hl-14-33><a class=lnlinks href=#hl-14-33> 33</a>
</span><span class=lnt id=hl-14-34><a class=lnlinks href=#hl-14-34> 34</a>
</span><span class=lnt id=hl-14-35><a class=lnlinks href=#hl-14-35> 35</a>
</span><span class=lnt id=hl-14-36><a class=lnlinks href=#hl-14-36> 36</a>
</span><span class=lnt id=hl-14-37><a class=lnlinks href=#hl-14-37> 37</a>
</span><span class=lnt id=hl-14-38><a class=lnlinks href=#hl-14-38> 38</a>
</span><span class=lnt id=hl-14-39><a class=lnlinks href=#hl-14-39> 39</a>
</span><span class=lnt id=hl-14-40><a class=lnlinks href=#hl-14-40> 40</a>
</span><span class=lnt id=hl-14-41><a class=lnlinks href=#hl-14-41> 41</a>
</span><span class=lnt id=hl-14-42><a class=lnlinks href=#hl-14-42> 42</a>
</span><span class=lnt id=hl-14-43><a class=lnlinks href=#hl-14-43> 43</a>
</span><span class=lnt id=hl-14-44><a class=lnlinks href=#hl-14-44> 44</a>
</span><span class=lnt id=hl-14-45><a class=lnlinks href=#hl-14-45> 45</a>
</span><span class=lnt id=hl-14-46><a class=lnlinks href=#hl-14-46> 46</a>
</span><span class=lnt id=hl-14-47><a class=lnlinks href=#hl-14-47> 47</a>
</span><span class=lnt id=hl-14-48><a class=lnlinks href=#hl-14-48> 48</a>
</span><span class=lnt id=hl-14-49><a class=lnlinks href=#hl-14-49> 49</a>
</span><span class=lnt id=hl-14-50><a class=lnlinks href=#hl-14-50> 50</a>
</span><span class=lnt id=hl-14-51><a class=lnlinks href=#hl-14-51> 51</a>
</span><span class=lnt id=hl-14-52><a class=lnlinks href=#hl-14-52> 52</a>
</span><span class=lnt id=hl-14-53><a class=lnlinks href=#hl-14-53> 53</a>
</span><span class=lnt id=hl-14-54><a class=lnlinks href=#hl-14-54> 54</a>
</span><span class=lnt id=hl-14-55><a class=lnlinks href=#hl-14-55> 55</a>
</span><span class=lnt id=hl-14-56><a class=lnlinks href=#hl-14-56> 56</a>
</span><span class=lnt id=hl-14-57><a class=lnlinks href=#hl-14-57> 57</a>
</span><span class=lnt id=hl-14-58><a class=lnlinks href=#hl-14-58> 58</a>
</span><span class=lnt id=hl-14-59><a class=lnlinks href=#hl-14-59> 59</a>
</span><span class=lnt id=hl-14-60><a class=lnlinks href=#hl-14-60> 60</a>
</span><span class=lnt id=hl-14-61><a class=lnlinks href=#hl-14-61> 61</a>
</span><span class=lnt id=hl-14-62><a class=lnlinks href=#hl-14-62> 62</a>
</span><span class=lnt id=hl-14-63><a class=lnlinks href=#hl-14-63> 63</a>
</span><span class=lnt id=hl-14-64><a class=lnlinks href=#hl-14-64> 64</a>
</span><span class=lnt id=hl-14-65><a class=lnlinks href=#hl-14-65> 65</a>
</span><span class=lnt id=hl-14-66><a class=lnlinks href=#hl-14-66> 66</a>
</span><span class=lnt id=hl-14-67><a class=lnlinks href=#hl-14-67> 67</a>
</span><span class=lnt id=hl-14-68><a class=lnlinks href=#hl-14-68> 68</a>
</span><span class=lnt id=hl-14-69><a class=lnlinks href=#hl-14-69> 69</a>
</span><span class=lnt id=hl-14-70><a class=lnlinks href=#hl-14-70> 70</a>
</span><span class=lnt id=hl-14-71><a class=lnlinks href=#hl-14-71> 71</a>
</span><span class=lnt id=hl-14-72><a class=lnlinks href=#hl-14-72> 72</a>
</span><span class=lnt id=hl-14-73><a class=lnlinks href=#hl-14-73> 73</a>
</span><span class=lnt id=hl-14-74><a class=lnlinks href=#hl-14-74> 74</a>
</span><span class=lnt id=hl-14-75><a class=lnlinks href=#hl-14-75> 75</a>
</span><span class=lnt id=hl-14-76><a class=lnlinks href=#hl-14-76> 76</a>
</span><span class=lnt id=hl-14-77><a class=lnlinks href=#hl-14-77> 77</a>
</span><span class=lnt id=hl-14-78><a class=lnlinks href=#hl-14-78> 78</a>
</span><span class=lnt id=hl-14-79><a class=lnlinks href=#hl-14-79> 79</a>
</span><span class=lnt id=hl-14-80><a class=lnlinks href=#hl-14-80> 80</a>
</span><span class=lnt id=hl-14-81><a class=lnlinks href=#hl-14-81> 81</a>
</span><span class=lnt id=hl-14-82><a class=lnlinks href=#hl-14-82> 82</a>
</span><span class=lnt id=hl-14-83><a class=lnlinks href=#hl-14-83> 83</a>
</span><span class=lnt id=hl-14-84><a class=lnlinks href=#hl-14-84> 84</a>
</span><span class=lnt id=hl-14-85><a class=lnlinks href=#hl-14-85> 85</a>
</span><span class=lnt id=hl-14-86><a class=lnlinks href=#hl-14-86> 86</a>
</span><span class=lnt id=hl-14-87><a class=lnlinks href=#hl-14-87> 87</a>
</span><span class=lnt id=hl-14-88><a class=lnlinks href=#hl-14-88> 88</a>
</span><span class=lnt id=hl-14-89><a class=lnlinks href=#hl-14-89> 89</a>
</span><span class=lnt id=hl-14-90><a class=lnlinks href=#hl-14-90> 90</a>
</span><span class=lnt id=hl-14-91><a class=lnlinks href=#hl-14-91> 91</a>
</span><span class=lnt id=hl-14-92><a class=lnlinks href=#hl-14-92> 92</a>
</span><span class=lnt id=hl-14-93><a class=lnlinks href=#hl-14-93> 93</a>
</span><span class=lnt id=hl-14-94><a class=lnlinks href=#hl-14-94> 94</a>
</span><span class=lnt id=hl-14-95><a class=lnlinks href=#hl-14-95> 95</a>
</span><span class=lnt id=hl-14-96><a class=lnlinks href=#hl-14-96> 96</a>
</span><span class=lnt id=hl-14-97><a class=lnlinks href=#hl-14-97> 97</a>
</span><span class=lnt id=hl-14-98><a class=lnlinks href=#hl-14-98> 98</a>
</span><span class=lnt id=hl-14-99><a class=lnlinks href=#hl-14-99> 99</a>
</span><span class=lnt id=hl-14-100><a class=lnlinks href=#hl-14-100>100</a>
</span><span class=lnt id=hl-14-101><a class=lnlinks href=#hl-14-101>101</a>
</span><span class=lnt id=hl-14-102><a class=lnlinks href=#hl-14-102>102</a>
</span><span class=lnt id=hl-14-103><a class=lnlinks href=#hl-14-103>103</a>
</span><span class=lnt id=hl-14-104><a class=lnlinks href=#hl-14-104>104</a>
</span><span class=lnt id=hl-14-105><a class=lnlinks href=#hl-14-105>105</a>
</span><span class=lnt id=hl-14-106><a class=lnlinks href=#hl-14-106>106</a>
</span><span class=lnt id=hl-14-107><a class=lnlinks href=#hl-14-107>107</a>
</span><span class=lnt id=hl-14-108><a class=lnlinks href=#hl-14-108>108</a>
</span><span class=lnt id=hl-14-109><a class=lnlinks href=#hl-14-109>109</a>
</span><span class=lnt id=hl-14-110><a class=lnlinks href=#hl-14-110>110</a>
</span><span class=lnt id=hl-14-111><a class=lnlinks href=#hl-14-111>111</a>
</span><span class=lnt id=hl-14-112><a class=lnlinks href=#hl-14-112>112</a>
</span><span class=lnt id=hl-14-113><a class=lnlinks href=#hl-14-113>113</a>
</span><span class=lnt id=hl-14-114><a class=lnlinks href=#hl-14-114>114</a>
</span><span class=lnt id=hl-14-115><a class=lnlinks href=#hl-14-115>115</a>
</span><span class=lnt id=hl-14-116><a class=lnlinks href=#hl-14-116>116</a>
</span><span class=lnt id=hl-14-117><a class=lnlinks href=#hl-14-117>117</a>
</span><span class=lnt id=hl-14-118><a class=lnlinks href=#hl-14-118>118</a>
</span><span class=lnt id=hl-14-119><a class=lnlinks href=#hl-14-119>119</a>
</span><span class=lnt id=hl-14-120><a class=lnlinks href=#hl-14-120>120</a>
</span><span class=lnt id=hl-14-121><a class=lnlinks href=#hl-14-121>121</a>
</span><span class=lnt id=hl-14-122><a class=lnlinks href=#hl-14-122>122</a>
</span><span class=lnt id=hl-14-123><a class=lnlinks href=#hl-14-123>123</a>
</span><span class=lnt id=hl-14-124><a class=lnlinks href=#hl-14-124>124</a>
</span><span class=lnt id=hl-14-125><a class=lnlinks href=#hl-14-125>125</a>
</span><span class=lnt id=hl-14-126><a class=lnlinks href=#hl-14-126>126</a>
</span><span class=lnt id=hl-14-127><a class=lnlinks href=#hl-14-127>127</a>
</span><span class=lnt id=hl-14-128><a class=lnlinks href=#hl-14-128>128</a>
</span><span class=lnt id=hl-14-129><a class=lnlinks href=#hl-14-129>129</a>
</span><span class=lnt id=hl-14-130><a class=lnlinks href=#hl-14-130>130</a>
</span><span class=lnt id=hl-14-131><a class=lnlinks href=#hl-14-131>131</a>
</span><span class=lnt id=hl-14-132><a class=lnlinks href=#hl-14-132>132</a>
</span><span class=lnt id=hl-14-133><a class=lnlinks href=#hl-14-133>133</a>
</span><span class=lnt id=hl-14-134><a class=lnlinks href=#hl-14-134>134</a>
</span><span class=lnt id=hl-14-135><a class=lnlinks href=#hl-14-135>135</a>
</span><span class=lnt id=hl-14-136><a class=lnlinks href=#hl-14-136>136</a>
</span><span class=lnt id=hl-14-137><a class=lnlinks href=#hl-14-137>137</a>
</span><span class=lnt id=hl-14-138><a class=lnlinks href=#hl-14-138>138</a>
</span><span class=lnt id=hl-14-139><a class=lnlinks href=#hl-14-139>139</a>
</span><span class=lnt id=hl-14-140><a class=lnlinks href=#hl-14-140>140</a>
</span><span class=lnt id=hl-14-141><a class=lnlinks href=#hl-14-141>141</a>
</span><span class=lnt id=hl-14-142><a class=lnlinks href=#hl-14-142>142</a>
</span><span class=lnt id=hl-14-143><a class=lnlinks href=#hl-14-143>143</a>
</span><span class=lnt id=hl-14-144><a class=lnlinks href=#hl-14-144>144</a>
</span><span class=lnt id=hl-14-145><a class=lnlinks href=#hl-14-145>145</a>
</span><span class=lnt id=hl-14-146><a class=lnlinks href=#hl-14-146>146</a>
</span><span class=lnt id=hl-14-147><a class=lnlinks href=#hl-14-147>147</a>
</span><span class=lnt id=hl-14-148><a class=lnlinks href=#hl-14-148>148</a>
</span><span class=lnt id=hl-14-149><a class=lnlinks href=#hl-14-149>149</a>
</span><span class=lnt id=hl-14-150><a class=lnlinks href=#hl-14-150>150</a>
</span><span class=lnt id=hl-14-151><a class=lnlinks href=#hl-14-151>151</a>
</span><span class=lnt id=hl-14-152><a class=lnlinks href=#hl-14-152>152</a>
</span><span class=lnt id=hl-14-153><a class=lnlinks href=#hl-14-153>153</a>
</span><span class=lnt id=hl-14-154><a class=lnlinks href=#hl-14-154>154</a>
</span><span class=lnt id=hl-14-155><a class=lnlinks href=#hl-14-155>155</a>
</span><span class=lnt id=hl-14-156><a class=lnlinks href=#hl-14-156>156</a>
</span><span class=lnt id=hl-14-157><a class=lnlinks href=#hl-14-157>157</a>
</span><span class=lnt id=hl-14-158><a class=lnlinks href=#hl-14-158>158</a>
</span><span class=lnt id=hl-14-159><a class=lnlinks href=#hl-14-159>159</a>
</span><span class=lnt id=hl-14-160><a class=lnlinks href=#hl-14-160>160</a>
</span><span class=lnt id=hl-14-161><a class=lnlinks href=#hl-14-161>161</a>
</span><span class=lnt id=hl-14-162><a class=lnlinks href=#hl-14-162>162</a>
</span><span class=lnt id=hl-14-163><a class=lnlinks href=#hl-14-163>163</a>
</span><span class=lnt id=hl-14-164><a class=lnlinks href=#hl-14-164>164</a>
</span><span class=lnt id=hl-14-165><a class=lnlinks href=#hl-14-165>165</a>
</span><span class=lnt id=hl-14-166><a class=lnlinks href=#hl-14-166>166</a>
</span><span class=lnt id=hl-14-167><a class=lnlinks href=#hl-14-167>167</a>
</span><span class=lnt id=hl-14-168><a class=lnlinks href=#hl-14-168>168</a>
</span><span class=lnt id=hl-14-169><a class=lnlinks href=#hl-14-169>169</a>
</span><span class=lnt id=hl-14-170><a class=lnlinks href=#hl-14-170>170</a>
</span><span class=lnt id=hl-14-171><a class=lnlinks href=#hl-14-171>171</a>
</span><span class=lnt id=hl-14-172><a class=lnlinks href=#hl-14-172>172</a>
</span><span class=lnt id=hl-14-173><a class=lnlinks href=#hl-14-173>173</a>
</span><span class=lnt id=hl-14-174><a class=lnlinks href=#hl-14-174>174</a>
</span><span class=lnt id=hl-14-175><a class=lnlinks href=#hl-14-175>175</a>
</span><span class=lnt id=hl-14-176><a class=lnlinks href=#hl-14-176>176</a>
</span><span class=lnt id=hl-14-177><a class=lnlinks href=#hl-14-177>177</a>
</span><span class=lnt id=hl-14-178><a class=lnlinks href=#hl-14-178>178</a>
</span><span class=lnt id=hl-14-179><a class=lnlinks href=#hl-14-179>179</a>
</span><span class=lnt id=hl-14-180><a class=lnlinks href=#hl-14-180>180</a>
</span><span class=lnt id=hl-14-181><a class=lnlinks href=#hl-14-181>181</a>
</span><span class=lnt id=hl-14-182><a class=lnlinks href=#hl-14-182>182</a>
</span><span class=lnt id=hl-14-183><a class=lnlinks href=#hl-14-183>183</a>
</span><span class=lnt id=hl-14-184><a class=lnlinks href=#hl-14-184>184</a>
</span><span class=lnt id=hl-14-185><a class=lnlinks href=#hl-14-185>185</a>
</span><span class=lnt id=hl-14-186><a class=lnlinks href=#hl-14-186>186</a>
</span><span class=lnt id=hl-14-187><a class=lnlinks href=#hl-14-187>187</a>
</span><span class=lnt id=hl-14-188><a class=lnlinks href=#hl-14-188>188</a>
</span><span class=lnt id=hl-14-189><a class=lnlinks href=#hl-14-189>189</a>
</span><span class=lnt id=hl-14-190><a class=lnlinks href=#hl-14-190>190</a>
</span><span class=lnt id=hl-14-191><a class=lnlinks href=#hl-14-191>191</a>
</span><span class=lnt id=hl-14-192><a class=lnlinks href=#hl-14-192>192</a>
</span><span class=lnt id=hl-14-193><a class=lnlinks href=#hl-14-193>193</a>
</span><span class=lnt id=hl-14-194><a class=lnlinks href=#hl-14-194>194</a>
</span><span class=lnt id=hl-14-195><a class=lnlinks href=#hl-14-195>195</a>
</span><span class=lnt id=hl-14-196><a class=lnlinks href=#hl-14-196>196</a>
</span><span class=lnt id=hl-14-197><a class=lnlinks href=#hl-14-197>197</a>
</span><span class=lnt id=hl-14-198><a class=lnlinks href=#hl-14-198>198</a>
</span><span class=lnt id=hl-14-199><a class=lnlinks href=#hl-14-199>199</a>
</span><span class=lnt id=hl-14-200><a class=lnlinks href=#hl-14-200>200</a>
</span><span class=lnt id=hl-14-201><a class=lnlinks href=#hl-14-201>201</a>
</span><span class=lnt id=hl-14-202><a class=lnlinks href=#hl-14-202>202</a>
</span><span class=lnt id=hl-14-203><a class=lnlinks href=#hl-14-203>203</a>
</span><span class=lnt id=hl-14-204><a class=lnlinks href=#hl-14-204>204</a>
</span><span class=lnt id=hl-14-205><a class=lnlinks href=#hl-14-205>205</a>
</span><span class=lnt id=hl-14-206><a class=lnlinks href=#hl-14-206>206</a>
</span><span class=lnt id=hl-14-207><a class=lnlinks href=#hl-14-207>207</a>
</span><span class=lnt id=hl-14-208><a class=lnlinks href=#hl-14-208>208</a>
</span><span class=lnt id=hl-14-209><a class=lnlinks href=#hl-14-209>209</a>
</span><span class=lnt id=hl-14-210><a class=lnlinks href=#hl-14-210>210</a>
</span><span class=lnt id=hl-14-211><a class=lnlinks href=#hl-14-211>211</a>
</span><span class=lnt id=hl-14-212><a class=lnlinks href=#hl-14-212>212</a>
</span><span class=lnt id=hl-14-213><a class=lnlinks href=#hl-14-213>213</a>
</span><span class=lnt id=hl-14-214><a class=lnlinks href=#hl-14-214>214</a>
</span><span class=lnt id=hl-14-215><a class=lnlinks href=#hl-14-215>215</a>
</span><span class=lnt id=hl-14-216><a class=lnlinks href=#hl-14-216>216</a>
</span><span class=lnt id=hl-14-217><a class=lnlinks href=#hl-14-217>217</a>
</span><span class=lnt id=hl-14-218><a class=lnlinks href=#hl-14-218>218</a>
</span><span class=lnt id=hl-14-219><a class=lnlinks href=#hl-14-219>219</a>
</span><span class=lnt id=hl-14-220><a class=lnlinks href=#hl-14-220>220</a>
</span><span class=lnt id=hl-14-221><a class=lnlinks href=#hl-14-221>221</a>
</span><span class=lnt id=hl-14-222><a class=lnlinks href=#hl-14-222>222</a>
</span><span class=lnt id=hl-14-223><a class=lnlinks href=#hl-14-223>223</a>
</span><span class=lnt id=hl-14-224><a class=lnlinks href=#hl-14-224>224</a>
</span><span class=lnt id=hl-14-225><a class=lnlinks href=#hl-14-225>225</a>
</span><span class=lnt id=hl-14-226><a class=lnlinks href=#hl-14-226>226</a>
</span><span class=lnt id=hl-14-227><a class=lnlinks href=#hl-14-227>227</a>
</span><span class=lnt id=hl-14-228><a class=lnlinks href=#hl-14-228>228</a>
</span><span class=lnt id=hl-14-229><a class=lnlinks href=#hl-14-229>229</a>
</span><span class=lnt id=hl-14-230><a class=lnlinks href=#hl-14-230>230</a>
</span><span class=lnt id=hl-14-231><a class=lnlinks href=#hl-14-231>231</a>
</span><span class=lnt id=hl-14-232><a class=lnlinks href=#hl-14-232>232</a>
</span><span class=lnt id=hl-14-233><a class=lnlinks href=#hl-14-233>233</a>
</span><span class=lnt id=hl-14-234><a class=lnlinks href=#hl-14-234>234</a>
</span><span class=lnt id=hl-14-235><a class=lnlinks href=#hl-14-235>235</a>
</span><span class=lnt id=hl-14-236><a class=lnlinks href=#hl-14-236>236</a>
</span><span class=lnt id=hl-14-237><a class=lnlinks href=#hl-14-237>237</a>
</span><span class=lnt id=hl-14-238><a class=lnlinks href=#hl-14-238>238</a>
</span><span class=lnt id=hl-14-239><a class=lnlinks href=#hl-14-239>239</a>
</span><span class=lnt id=hl-14-240><a class=lnlinks href=#hl-14-240>240</a>
</span><span class=lnt id=hl-14-241><a class=lnlinks href=#hl-14-241>241</a>
</span><span class=lnt id=hl-14-242><a class=lnlinks href=#hl-14-242>242</a>
</span><span class=lnt id=hl-14-243><a class=lnlinks href=#hl-14-243>243</a>
</span><span class=lnt id=hl-14-244><a class=lnlinks href=#hl-14-244>244</a>
</span><span class=lnt id=hl-14-245><a class=lnlinks href=#hl-14-245>245</a>
</span><span class=lnt id=hl-14-246><a class=lnlinks href=#hl-14-246>246</a>
</span><span class=lnt id=hl-14-247><a class=lnlinks href=#hl-14-247>247</a>
</span><span class=lnt id=hl-14-248><a class=lnlinks href=#hl-14-248>248</a>
</span><span class=lnt id=hl-14-249><a class=lnlinks href=#hl-14-249>249</a>
</span><span class=lnt id=hl-14-250><a class=lnlinks href=#hl-14-250>250</a>
</span><span class=lnt id=hl-14-251><a class=lnlinks href=#hl-14-251>251</a>
</span><span class=lnt id=hl-14-252><a class=lnlinks href=#hl-14-252>252</a>
</span><span class=lnt id=hl-14-253><a class=lnlinks href=#hl-14-253>253</a>
</span><span class=lnt id=hl-14-254><a class=lnlinks href=#hl-14-254>254</a>
</span><span class=lnt id=hl-14-255><a class=lnlinks href=#hl-14-255>255</a>
</span><span class=lnt id=hl-14-256><a class=lnlinks href=#hl-14-256>256</a>
</span><span class=lnt id=hl-14-257><a class=lnlinks href=#hl-14-257>257</a>
</span><span class=lnt id=hl-14-258><a class=lnlinks href=#hl-14-258>258</a>
</span><span class=lnt id=hl-14-259><a class=lnlinks href=#hl-14-259>259</a>
</span><span class=lnt id=hl-14-260><a class=lnlinks href=#hl-14-260>260</a>
</span><span class=lnt id=hl-14-261><a class=lnlinks href=#hl-14-261>261</a>
</span><span class=lnt id=hl-14-262><a class=lnlinks href=#hl-14-262>262</a>
</span><span class=lnt id=hl-14-263><a class=lnlinks href=#hl-14-263>263</a>
</span><span class=lnt id=hl-14-264><a class=lnlinks href=#hl-14-264>264</a>
</span><span class=lnt id=hl-14-265><a class=lnlinks href=#hl-14-265>265</a>
</span><span class=lnt id=hl-14-266><a class=lnlinks href=#hl-14-266>266</a>
</span><span class=lnt id=hl-14-267><a class=lnlinks href=#hl-14-267>267</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>asyncio</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>List</span><span class=p>,</span> <span class=n>Callable</span><span class=p>,</span> <span class=n>Any</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dataclasses</span> <span class=kn>import</span> <span class=n>dataclass</span><span class=p>,</span> <span class=n>asdict</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 이벤트 클래스 정의</span>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Event</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    이벤트의 기본 구조를 정의하는 클래스
</span></span></span><span class=line><span class=cl><span class=s2>    - topic: 이벤트가 발행될 토픽
</span></span></span><span class=line><span class=cl><span class=s2>    - data: 이벤트 페이로드 데이터
</span></span></span><span class=line><span class=cl><span class=s2>    - timestamp: 이벤트 발생 시각
</span></span></span><span class=line><span class=cl><span class=s2>    - event_id: 이벤트 고유 식별자
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>topic</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>timestamp</span><span class=p>:</span> <span class=n>datetime</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=n>event_id</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>__post_init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>timestamp</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>timestamp</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>event_id</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=kn>import</span> <span class=nn>uuid</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>event_id</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Event Broker 핵심 클래스</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>EventBroker</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    이벤트 브로커의 핵심 기능을 구현하는 클래스
</span></span></span><span class=line><span class=cl><span class=s2>    - 토픽 기반 이벤트 라우팅
</span></span></span><span class=line><span class=cl><span class=s2>    - 비동기 이벤트 처리
</span></span></span><span class=line><span class=cl><span class=s2>    - 구독자 관리
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>Callable</span><span class=p>]]</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># 토픽별 구독자 목록</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_history</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Event</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># 이벤트 히스토리 (재처리용)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>publish</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>:</span> <span class=n>Event</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        이벤트를 지정된 토픽에 발행
</span></span></span><span class=line><span class=cl><span class=s2>        - 이벤트 히스토리에 저장 (재처리 지원)
</span></span></span><span class=line><span class=cl><span class=s2>        - 해당 토픽의 모든 구독자에게 비동기 전달
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Publishing event </span><span class=si>{</span><span class=n>event</span><span class=o>.</span><span class=n>event_id</span><span class=si>}</span><span class=s2> to topic &#39;</span><span class=si>{</span><span class=n>event</span><span class=o>.</span><span class=n>topic</span><span class=si>}</span><span class=s2>&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 이벤트 히스토리에 저장</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 토픽의 구독자들에게 이벤트 전달</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>event</span><span class=o>.</span><span class=n>topic</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tasks</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>subscriber</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span><span class=p>[</span><span class=n>event</span><span class=o>.</span><span class=n>topic</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>task</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_deliver_event</span><span class=p>(</span><span class=n>subscriber</span><span class=p>,</span> <span class=n>event</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>tasks</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>task</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 모든 구독자에게 병렬로 이벤트 전달</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span><span class=o>*</span><span class=n>tasks</span><span class=p>,</span> <span class=n>return_exceptions</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>_deliver_event</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>subscriber</span><span class=p>:</span> <span class=n>Callable</span><span class=p>,</span> <span class=n>event</span><span class=p>:</span> <span class=n>Event</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        개별 구독자에게 이벤트 전달 (내부 메서드)
</span></span></span><span class=line><span class=cl><span class=s2>        - 에러 핸들링 포함
</span></span></span><span class=line><span class=cl><span class=s2>        - 재시도 로직 구현 가능 지점
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>iscoroutinefunction</span><span class=p>(</span><span class=n>subscriber</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>await</span> <span class=n>subscriber</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>subscriber</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error delivering event </span><span class=si>{</span><span class=n>event</span><span class=o>.</span><span class=n>event_id</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># 실제 환경에서는 Dead Letter Queue로 전송</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>subscribe</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>topic</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>callback</span><span class=p>:</span> <span class=n>Callable</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        특정 토픽에 구독자 등록
</span></span></span><span class=line><span class=cl><span class=s2>        - 와일드카드 패턴 지원 가능
</span></span></span><span class=line><span class=cl><span class=s2>        - 구독자별 필터링 옵션 추가 가능
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>topic</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span><span class=p>[</span><span class=n>topic</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span><span class=p>[</span><span class=n>topic</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>callback</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Subscriber registered for topic &#39;</span><span class=si>{</span><span class=n>topic</span><span class=si>}</span><span class=s2>&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>unsubscribe</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>topic</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>callback</span><span class=p>:</span> <span class=n>Callable</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        구독자 해제
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>topic</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span><span class=p>[</span><span class=n>topic</span><span class=p>]</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>callback</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Subscriber unregistered from topic &#39;</span><span class=si>{</span><span class=n>topic</span><span class=si>}</span><span class=s2>&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Subscriber not found for topic &#39;</span><span class=si>{</span><span class=n>topic</span><span class=si>}</span><span class=s2>&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>replay_events</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>topic</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>from_timestamp</span><span class=p>:</span> <span class=n>datetime</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        과거 이벤트 재처리 기능
</span></span></span><span class=line><span class=cl><span class=s2>        - 특정 시점 이후의 이벤트 재처리
</span></span></span><span class=line><span class=cl><span class=s2>        - A/B 테스트, 버그 수정 후 재처리 등에 활용
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>filtered_events</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=n>event</span> <span class=k>for</span> <span class=n>event</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>event_history</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>event</span><span class=o>.</span><span class=n>topic</span> <span class=o>==</span> <span class=n>topic</span> <span class=ow>and</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>from_timestamp</span> <span class=ow>is</span> <span class=kc>None</span> <span class=ow>or</span> <span class=n>event</span><span class=o>.</span><span class=n>timestamp</span> <span class=o>&gt;=</span> <span class=n>from_timestamp</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Replaying </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>filtered_events</span><span class=p>)</span><span class=si>}</span><span class=s2> events for topic &#39;</span><span class=si>{</span><span class=n>topic</span><span class=si>}</span><span class=s2>&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>event</span> <span class=ow>in</span> <span class=n>filtered_events</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 실제 사용 예시: 전자상거래 주문 처리</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    주문 서비스 구현 예시
</span></span></span><span class=line><span class=cl><span class=s2>    - 주문 생성 시 이벤트 발행
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_broker</span><span class=p>:</span> <span class=n>EventBroker</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_broker</span> <span class=o>=</span> <span class=n>event_broker</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>create_order</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        주문 생성 및 이벤트 발행
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>order_id</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;order_</span><span class=si>{</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y%m</span><span class=si>%d</span><span class=s1>%H%M%S&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 주문 데이터 저장 (DB 저장 로직)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Order </span><span class=si>{</span><span class=n>order_id</span><span class=si>}</span><span class=s2> created&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 주문 생성 이벤트 발행</span>
</span></span><span class=line><span class=cl>        <span class=n>event</span> <span class=o>=</span> <span class=n>Event</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>topic</span><span class=o>=</span><span class=s2>&#34;order.created&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;order_id&#34;</span><span class=p>:</span> <span class=n>order_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;customer_id&#34;</span><span class=p>:</span> <span class=n>order_data</span><span class=p>[</span><span class=s2>&#34;customer_id&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;items&#34;</span><span class=p>:</span> <span class=n>order_data</span><span class=p>[</span><span class=s2>&#34;items&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;total_amount&#34;</span><span class=p>:</span> <span class=n>order_data</span><span class=p>[</span><span class=s2>&#34;total_amount&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>event_broker</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>order_id</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>PaymentService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    결제 서비스 구현 예시
</span></span></span><span class=line><span class=cl><span class=s2>    - 주문 생성 이벤트 구독
</span></span></span><span class=line><span class=cl><span class=s2>    - 결제 처리 후 이벤트 발행
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_broker</span><span class=p>:</span> <span class=n>EventBroker</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_broker</span> <span class=o>=</span> <span class=n>event_broker</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 주문 생성 이벤트 구독</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_broker</span><span class=o>.</span><span class=n>subscribe</span><span class=p>(</span><span class=s2>&#34;order.created&#34;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>handle_order_created</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>handle_order_created</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>:</span> <span class=n>Event</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        주문 생성 이벤트 처리
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>order_data</span> <span class=o>=</span> <span class=n>event</span><span class=o>.</span><span class=n>data</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Processing payment for order </span><span class=si>{</span><span class=n>order_data</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 결제 처리 로직 (실제로는 외부 결제 게이트웨이 연동)</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.5</span><span class=p>)</span>  <span class=c1># 결제 처리 시뮬레이션</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 결제 완료 이벤트 발행</span>
</span></span><span class=line><span class=cl>        <span class=n>payment_event</span> <span class=o>=</span> <span class=n>Event</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>topic</span><span class=o>=</span><span class=s2>&#34;payment.completed&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;order_id&#34;</span><span class=p>:</span> <span class=n>order_data</span><span class=p>[</span><span class=s2>&#34;order_id&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;payment_status&#34;</span><span class=p>:</span> <span class=s2>&#34;success&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;transaction_id&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;txn_</span><span class=si>{</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y%m</span><span class=si>%d</span><span class=s1>%H%M%S&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>event_broker</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>payment_event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>InventoryService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    재고 서비스 구현 예시
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_broker</span><span class=p>:</span> <span class=n>EventBroker</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_broker</span> <span class=o>=</span> <span class=n>event_broker</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 주문 생성 이벤트 구독</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_broker</span><span class=o>.</span><span class=n>subscribe</span><span class=p>(</span><span class=s2>&#34;order.created&#34;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>handle_order_created</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>handle_order_created</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>:</span> <span class=n>Event</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        주문 생성 시 재고 확인 및 예약
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>order_data</span> <span class=o>=</span> <span class=n>event</span><span class=o>.</span><span class=n>data</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Checking inventory for order </span><span class=si>{</span><span class=n>order_data</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 재고 확인 및 예약 로직</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.3</span><span class=p>)</span>  <span class=c1># 재고 처리 시뮬레이션</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 재고 예약 완료 이벤트 발행</span>
</span></span><span class=line><span class=cl>        <span class=n>inventory_event</span> <span class=o>=</span> <span class=n>Event</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>topic</span><span class=o>=</span><span class=s2>&#34;inventory.reserved&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;order_id&#34;</span><span class=p>:</span> <span class=n>order_data</span><span class=p>[</span><span class=s2>&#34;order_id&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;items&#34;</span><span class=p>:</span> <span class=n>order_data</span><span class=p>[</span><span class=s2>&#34;items&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;reservation_status&#34;</span><span class=p>:</span> <span class=s2>&#34;confirmed&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>event_broker</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>inventory_event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시 및 테스트</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Event Broker 사용 예시
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 로깅 설정</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Event Broker 초기화</span>
</span></span><span class=line><span class=cl>    <span class=n>broker</span> <span class=o>=</span> <span class=n>EventBroker</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 서비스 인스턴스 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>order_service</span> <span class=o>=</span> <span class=n>OrderService</span><span class=p>(</span><span class=n>broker</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payment_service</span> <span class=o>=</span> <span class=n>PaymentService</span><span class=p>(</span><span class=n>broker</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>inventory_service</span> <span class=o>=</span> <span class=n>InventoryService</span><span class=p>(</span><span class=n>broker</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 주문 생성 테스트</span>
</span></span><span class=line><span class=cl>    <span class=n>order_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;customer_id&#34;</span><span class=p>:</span> <span class=s2>&#34;customer_123&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;items&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s2>&#34;product_id&#34;</span><span class=p>:</span> <span class=s2>&#34;prod_1&#34;</span><span class=p>,</span> <span class=s2>&#34;quantity&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s2>&#34;price&#34;</span><span class=p>:</span> <span class=mf>29.99</span><span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s2>&#34;product_id&#34;</span><span class=p>:</span> <span class=s2>&#34;prod_2&#34;</span><span class=p>,</span> <span class=s2>&#34;quantity&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;price&#34;</span><span class=p>:</span> <span class=mf>49.99</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;total_amount&#34;</span><span class=p>:</span> <span class=mf>109.97</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=== 주문 처리 시작 ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>order_id</span> <span class=o>=</span> <span class=k>await</span> <span class=n>order_service</span><span class=o>.</span><span class=n>create_order</span><span class=p>(</span><span class=n>order_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 이벤트 처리 완료를 위한 대기</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>=== 주문 </span><span class=si>{</span><span class=n>order_id</span><span class=si>}</span><span class=s2> 처리 완료 ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;총 처리된 이벤트 수: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>broker</span><span class=o>.</span><span class=n>event_history</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 이벤트 히스토리 출력</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>=== 이벤트 히스토리 ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>event</span> <span class=ow>in</span> <span class=n>broker</span><span class=o>.</span><span class=n>event_history</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=n>event</span><span class=o>.</span><span class=n>timestamp</span><span class=si>}</span><span class=s2>] </span><span class=si>{</span><span class=n>event</span><span class=o>.</span><span class=n>topic</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>event</span><span class=o>.</span><span class=n>data</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 실행</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>main</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p>이 구현 예시는 Event Broker 의 핵심 개념들을 실제 코드로 보여줍니다:</p><ol><li><strong>비동기 이벤트 처리</strong>: <code>asyncio</code> 를 활용한 논블로킹 처리</li><li><strong>토픽 기반 라우팅</strong>: 토픽별 구독자 관리</li><li><strong>느슨한 결합</strong>: 서비스 간 직접 호출 없이 이벤트를 통한 통신</li><li><strong>이벤트 재처리</strong>: 히스토리 기반 재처리 기능</li><li><strong>에러 핸들링</strong>: 구독자별 예외 처리</li></ol><h4 id=사례-4-실시간-알림-서비스>사례 4: 실시간 알림 서비스<a hidden class=anchor aria-hidden=true href=#사례-4-실시간-알림-서비스>#</a></h4><p>SNS, 커뮤니티, 커머스 등 거의 모든 서비스에서 사용되며, 일반적으로 <strong>Event-Driven Architecture + Pub/Sub 기반 알림 브로커 + WebSocket/Push API</strong> 조합으로 구현된다.</p><p><strong>시스템 구성</strong>:</p><table><thead><tr><th>컴포넌트</th><th>역할</th></tr></thead><tbody><tr><td>Kafka</td><td>이벤트 버퍼 및 브로커 역할</td></tr><tr><td>Comment Service</td><td>이벤트 생성 및 발행</td></tr><tr><td>Notification Service</td><td>이벤트 수신 → 알림 생성/전송</td></tr><tr><td>WebSocket Gateway</td><td>사용자에게 실시간 알림 전달</td></tr><tr><td>Notification DB</td><td>알림 이력 저장 (선택 사항)</td></tr></tbody></table><pre class=mermaid>graph TD
  A[사용자] --&gt;|댓글 작성| B(API Gateway)
  B --&gt; C[Comment Service]
  C --&gt;|Event 생성| D(Kafka Topic: comment.events)
  D --&gt; E[Notification Service]
  E --&gt;|WebSocket 전송| F[WebSocket Gateway]
  F --&gt; G[실시간 연결 사용자]
  E --&gt;|DB 저장| H[Notification DB]
</pre><p><strong>Workflow</strong>:</p><table><thead><tr><th>단계</th><th>설명</th></tr></thead><tbody><tr><td>1. 사용자 댓글 작성</td><td>사용자가 게시글에 댓글을 작성</td></tr><tr><td>2. 이벤트 발행</td><td>Comment Service 는 <code>CommentCreated</code> 이벤트를 Kafka 에 발행</td></tr><tr><td>3. 알림 서비스 수신</td><td>Notification Service 가 해당 이벤트를 소비하고, 알림 데이터를 구성</td></tr><tr><td>4. 실시간 전송</td><td>WebSocket 을 통해 실시간 연결된 사용자에게 즉시 알림 전송</td></tr><tr><td>5. 알림 저장</td><td>알림을 데이터베이스에 저장하여, 추후 알림 리스트 조회 가능</td></tr></tbody></table><p><strong>구현 코드</strong>:</p><ol><li><p>Kafka 이벤트 발행–<code>Comment Service</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11>11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12>12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13>13</a>
</span><span class=lnt id=hl-16-14><a class=lnlinks href=#hl-16-14>14</a>
</span><span class=lnt id=hl-16-15><a class=lnlinks href=#hl-16-15>15</a>
</span><span class=lnt id=hl-16-16><a class=lnlinks href=#hl-16-16>16</a>
</span><span class=lnt id=hl-16-17><a class=lnlinks href=#hl-16-17>17</a>
</span><span class=lnt id=hl-16-18><a class=lnlinks href=#hl-16-18>18</a>
</span><span class=lnt id=hl-16-19><a class=lnlinks href=#hl-16-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># comment_service.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaProducer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_serializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>v</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>v</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>publish_comment_event</span><span class=p>(</span><span class=n>comment_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>event</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;CommentCreated&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;post_id&#34;</span><span class=p>:</span> <span class=n>comment_data</span><span class=p>[</span><span class=s2>&#34;post_id&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;commenter_id&#34;</span><span class=p>:</span> <span class=n>comment_data</span><span class=p>[</span><span class=s2>&#34;user_id&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;receiver_id&#34;</span><span class=p>:</span> <span class=n>comment_data</span><span class=p>[</span><span class=s2>&#34;post_owner_id&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;message&#34;</span><span class=p>:</span> <span class=n>comment_data</span><span class=p>[</span><span class=s2>&#34;text&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s1>&#39;comment.events&#39;</span><span class=p>,</span> <span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>producer</span><span class=o>.</span><span class=n>flush</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>Kafka 이벤트 소비 + WebSocket 연동–<code>Notification Service</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1> 1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2> 2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3> 3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4> 4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5> 5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6> 6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7> 7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8> 8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9> 9</a>
</span><span class=lnt id=hl-17-10><a class=lnlinks href=#hl-17-10>10</a>
</span><span class=lnt id=hl-17-11><a class=lnlinks href=#hl-17-11>11</a>
</span><span class=lnt id=hl-17-12><a class=lnlinks href=#hl-17-12>12</a>
</span><span class=lnt id=hl-17-13><a class=lnlinks href=#hl-17-13>13</a>
</span><span class=lnt id=hl-17-14><a class=lnlinks href=#hl-17-14>14</a>
</span><span class=lnt id=hl-17-15><a class=lnlinks href=#hl-17-15>15</a>
</span><span class=lnt id=hl-17-16><a class=lnlinks href=#hl-17-16>16</a>
</span><span class=lnt id=hl-17-17><a class=lnlinks href=#hl-17-17>17</a>
</span><span class=lnt id=hl-17-18><a class=lnlinks href=#hl-17-18>18</a>
</span><span class=lnt id=hl-17-19><a class=lnlinks href=#hl-17-19>19</a>
</span><span class=lnt id=hl-17-20><a class=lnlinks href=#hl-17-20>20</a>
</span><span class=lnt id=hl-17-21><a class=lnlinks href=#hl-17-21>21</a>
</span><span class=lnt id=hl-17-22><a class=lnlinks href=#hl-17-22>22</a>
</span><span class=lnt id=hl-17-23><a class=lnlinks href=#hl-17-23>23</a>
</span><span class=lnt id=hl-17-24><a class=lnlinks href=#hl-17-24>24</a>
</span><span class=lnt id=hl-17-25><a class=lnlinks href=#hl-17-25>25</a>
</span><span class=lnt id=hl-17-26><a class=lnlinks href=#hl-17-26>26</a>
</span><span class=lnt id=hl-17-27><a class=lnlinks href=#hl-17-27>27</a>
</span><span class=lnt id=hl-17-28><a class=lnlinks href=#hl-17-28>28</a>
</span><span class=lnt id=hl-17-29><a class=lnlinks href=#hl-17-29>29</a>
</span><span class=lnt id=hl-17-30><a class=lnlinks href=#hl-17-30>30</a>
</span><span class=lnt id=hl-17-31><a class=lnlinks href=#hl-17-31>31</a>
</span><span class=lnt id=hl-17-32><a class=lnlinks href=#hl-17-32>32</a>
</span><span class=lnt id=hl-17-33><a class=lnlinks href=#hl-17-33>33</a>
</span><span class=lnt id=hl-17-34><a class=lnlinks href=#hl-17-34>34</a>
</span><span class=lnt id=hl-17-35><a class=lnlinks href=#hl-17-35>35</a>
</span><span class=lnt id=hl-17-36><a class=lnlinks href=#hl-17-36>36</a>
</span><span class=lnt id=hl-17-37><a class=lnlinks href=#hl-17-37>37</a>
</span><span class=lnt id=hl-17-38><a class=lnlinks href=#hl-17-38>38</a>
</span><span class=lnt id=hl-17-39><a class=lnlinks href=#hl-17-39>39</a>
</span><span class=lnt id=hl-17-40><a class=lnlinks href=#hl-17-40>40</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># notification_service.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaConsumer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span><span class=p>,</span> <span class=n>WebSocket</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>defaultdict</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>asyncio</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>active_connections</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>  <span class=c1># user_id -&gt; list of WebSockets</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.websocket</span><span class=p>(</span><span class=s2>&#34;/ws/</span><span class=si>{user_id}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>websocket_endpoint</span><span class=p>(</span><span class=n>websocket</span><span class=p>:</span> <span class=n>WebSocket</span><span class=p>,</span> <span class=n>user_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>websocket</span><span class=o>.</span><span class=n>accept</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>active_connections</span><span class=p>[</span><span class=n>user_id</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>websocket</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=n>websocket</span><span class=o>.</span><span class=n>receive_text</span><span class=p>()</span>  <span class=c1># Keep connection alive</span>
</span></span><span class=line><span class=cl>    <span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>active_connections</span><span class=p>[</span><span class=n>user_id</span><span class=p>]</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>websocket</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_realtime_notification</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=n>message</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>ws</span> <span class=ow>in</span> <span class=n>active_connections</span><span class=p>[</span><span class=n>user_id</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>asyncio</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span><span class=n>ws</span><span class=o>.</span><span class=n>send_text</span><span class=p>(</span><span class=n>message</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>run_kafka_consumer</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;comment.events&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>group_id</span><span class=o>=</span><span class=s1>&#39;notification-group&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>value_deserializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>msg</span> <span class=ow>in</span> <span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>msg</span><span class=o>.</span><span class=n>value</span>
</span></span><span class=line><span class=cl>        <span class=n>receiver_id</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;receiver_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;새 댓글이 달렸습니다: </span><span class=si>{</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;message&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>send_realtime_notification</span><span class=p>(</span><span class=n>receiver_id</span><span class=p>,</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 비동기 Kafka consumer 실행</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>threading</span>
</span></span><span class=line><span class=cl><span class=n>threading</span><span class=o>.</span><span class=n>Thread</span><span class=p>(</span><span class=n>target</span><span class=o>=</span><span class=n>run_kafka_consumer</span><span class=p>,</span> <span class=n>daemon</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>클라이언트 (WebSocket JS 예시)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1>1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2>2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3>3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4>4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>socket</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>WebSocket</span><span class=p>(</span><span class=s2>&#34;ws://localhost:8000/ws/USER_ID&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>socket</span><span class=p>.</span><span class=nx>onmessage</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>alert</span><span class=p>(</span><span class=s2>&#34;🔔 알림: &#34;</span> <span class=o>+</span> <span class=nx>event</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h4 id=사례-5-마이크로서비스-아키텍처에서-서비스-간-통합>사례 5: 마이크로서비스 아키텍처에서 서비스 간 통합<a hidden class=anchor aria-hidden=true href=#사례-5-마이크로서비스-아키텍처에서-서비스-간-통합>#</a></h4><p><strong>주문 처리 시스템</strong></p><ul><li>사용자가 주문을 생성하면 <code>Order Service</code> 가 <code>OrderCreated</code> 이벤트를 발행하고, <code>Inventory Service</code> 와 <code>Payment Service</code> 가 이를 구독해 각각 재고 확인과 결제 처리를 수행한다.</li></ul><p><strong>시스템 구성</strong>:</p><table><thead><tr><th>컴포넌트</th><th>역할</th></tr></thead><tbody><tr><td><strong>Kafka</strong></td><td>서비스 간 이벤트 전달 버스 역할</td></tr><tr><td><strong>Order Service</strong></td><td>주문 저장 및 <code>OrderCreated</code> 이벤트 발행</td></tr><tr><td><strong>Inventory Service</strong></td><td>재고 확인 및 후속 이벤트 발행</td></tr><tr><td><strong>Payment Service</strong></td><td>결제 처리 및 후속 이벤트 발행</td></tr></tbody></table><pre class=mermaid>flowchart TD
  A[Client] --&gt;|POST /orders| B[Order Service]
  B --&gt;|OrderCreated Event| C[Kafka Topic: order.events]
  C --&gt; D[Inventory Service]
  C --&gt; E[Payment Service]
  D --&gt;|InventoryReserved| F[Kafka Topic: inventory.events]
  E --&gt;|PaymentProcessed| G[Kafka Topic: payment.events]
</pre><p><strong>Workflow</strong>:</p><table><thead><tr><th>단계</th><th>설명</th></tr></thead><tbody><tr><td>1. 주문 생성</td><td>사용자가 주문 요청을 보내면 Order Service 가 DB 에 주문 저장</td></tr><tr><td>2. 이벤트 발행</td><td>주문이 저장되면 Kafka 에 <code>OrderCreated</code> 이벤트 발행</td></tr><tr><td>3. 재고/결제 처리</td><td>Inventory Service 와 Payment Service 는 이벤트를 수신해 각각 처리</td></tr><tr><td>4. 후속 이벤트 발행</td><td>각각 처리 결과 (<code>InventoryReserved</code>, <code>PaymentProcessed</code>) 를 발행하여 후속 프로세스 연동</td></tr></tbody></table><p><strong>구현 예시</strong>:</p><ol><li><p>Order Service–이벤트 발행</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1> 1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2> 2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3> 3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4> 4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5> 5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6> 6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7> 7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8> 8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9> 9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10>10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11>11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12>12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13>13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14>14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15>15</a>
</span><span class=lnt id=hl-20-16><a class=lnlinks href=#hl-20-16>16</a>
</span><span class=lnt id=hl-20-17><a class=lnlinks href=#hl-20-17>17</a>
</span><span class=lnt id=hl-20-18><a class=lnlinks href=#hl-20-18>18</a>
</span><span class=lnt id=hl-20-19><a class=lnlinks href=#hl-20-19>19</a>
</span><span class=lnt id=hl-20-20><a class=lnlinks href=#hl-20-20>20</a>
</span><span class=lnt id=hl-20-21><a class=lnlinks href=#hl-20-21>21</a>
</span><span class=lnt id=hl-20-22><a class=lnlinks href=#hl-20-22>22</a>
</span><span class=lnt id=hl-20-23><a class=lnlinks href=#hl-20-23>23</a>
</span><span class=lnt id=hl-20-24><a class=lnlinks href=#hl-20-24>24</a>
</span><span class=lnt id=hl-20-25><a class=lnlinks href=#hl-20-25>25</a>
</span><span class=lnt id=hl-20-26><a class=lnlinks href=#hl-20-26>26</a>
</span><span class=lnt id=hl-20-27><a class=lnlinks href=#hl-20-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># order_service.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaProducer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span><span class=p>,</span> <span class=n>Request</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_serializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>v</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>v</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.post</span><span class=p>(</span><span class=s2>&#34;/orders&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>create_order</span><span class=p>(</span><span class=n>req</span><span class=p>:</span> <span class=n>Request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>body</span> <span class=o>=</span> <span class=k>await</span> <span class=n>req</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>order</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;order_id&#34;</span><span class=p>:</span> <span class=n>body</span><span class=p>[</span><span class=s2>&#34;order_id&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;user_id&#34;</span><span class=p>:</span> <span class=n>body</span><span class=p>[</span><span class=s2>&#34;user_id&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;items&#34;</span><span class=p>:</span> <span class=n>body</span><span class=p>[</span><span class=s2>&#34;items&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;total&#34;</span><span class=p>:</span> <span class=n>body</span><span class=p>[</span><span class=s2>&#34;total&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1># 가상 DB 저장 생략</span>
</span></span><span class=line><span class=cl>    <span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s1>&#39;order.events&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;OrderCreated&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;data&#34;</span><span class=p>:</span> <span class=n>order</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=n>producer</span><span class=o>.</span><span class=n>flush</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;Order created and event published&#34;</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>Inventory Service–이벤트 소비자</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span><span class=lnt id=hl-21-11><a class=lnlinks href=#hl-21-11>11</a>
</span><span class=lnt id=hl-21-12><a class=lnlinks href=#hl-21-12>12</a>
</span><span class=lnt id=hl-21-13><a class=lnlinks href=#hl-21-13>13</a>
</span><span class=lnt id=hl-21-14><a class=lnlinks href=#hl-21-14>14</a>
</span><span class=lnt id=hl-21-15><a class=lnlinks href=#hl-21-15>15</a>
</span><span class=lnt id=hl-21-16><a class=lnlinks href=#hl-21-16>16</a>
</span><span class=lnt id=hl-21-17><a class=lnlinks href=#hl-21-17>17</a>
</span><span class=lnt id=hl-21-18><a class=lnlinks href=#hl-21-18>18</a>
</span><span class=lnt id=hl-21-19><a class=lnlinks href=#hl-21-19>19</a>
</span><span class=lnt id=hl-21-20><a class=lnlinks href=#hl-21-20>20</a>
</span><span class=lnt id=hl-21-21><a class=lnlinks href=#hl-21-21>21</a>
</span><span class=lnt id=hl-21-22><a class=lnlinks href=#hl-21-22>22</a>
</span><span class=lnt id=hl-21-23><a class=lnlinks href=#hl-21-23>23</a>
</span><span class=lnt id=hl-21-24><a class=lnlinks href=#hl-21-24>24</a>
</span><span class=lnt id=hl-21-25><a class=lnlinks href=#hl-21-25>25</a>
</span><span class=lnt id=hl-21-26><a class=lnlinks href=#hl-21-26>26</a>
</span><span class=lnt id=hl-21-27><a class=lnlinks href=#hl-21-27>27</a>
</span><span class=lnt id=hl-21-28><a class=lnlinks href=#hl-21-28>28</a>
</span><span class=lnt id=hl-21-29><a class=lnlinks href=#hl-21-29>29</a>
</span><span class=lnt id=hl-21-30><a class=lnlinks href=#hl-21-30>30</a>
</span><span class=lnt id=hl-21-31><a class=lnlinks href=#hl-21-31>31</a>
</span><span class=lnt id=hl-21-32><a class=lnlinks href=#hl-21-32>32</a>
</span><span class=lnt id=hl-21-33><a class=lnlinks href=#hl-21-33>33</a>
</span><span class=lnt id=hl-21-34><a class=lnlinks href=#hl-21-34>34</a>
</span><span class=lnt id=hl-21-35><a class=lnlinks href=#hl-21-35>35</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># inventory_service.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaConsumer</span><span class=p>,</span> <span class=n>KafkaProducer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;order.events&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>group_id</span><span class=o>=</span><span class=s1>&#39;inventory-service&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_deserializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_serializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>v</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>v</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>handle_order_created</span><span class=p>(</span><span class=n>event_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>items</span> <span class=o>=</span> <span class=n>event_data</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>][</span><span class=s1>&#39;items&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=c1># 재고 확인 로직 (가정)</span>
</span></span><span class=line><span class=cl>    <span class=n>all_available</span> <span class=o>=</span> <span class=kc>True</span>  <span class=c1># 여기서는 항상 성공 가정</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>all_available</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;InventoryReserved&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;data&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;order_id&#34;</span><span class=p>:</span> <span class=n>event_data</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>][</span><span class=s1>&#39;order_id&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;reserved&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s1>&#39;inventory.events&#39;</span><span class=p>,</span> <span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>producer</span><span class=o>.</span><span class=n>flush</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>msg</span> <span class=ow>in</span> <span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>event</span> <span class=o>=</span> <span class=n>msg</span><span class=o>.</span><span class=n>value</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;OrderCreated&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>handle_order_created</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ol><li><p>Payment Service–이벤트 소비자</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1> 1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2> 2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3> 3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4> 4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5> 5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6> 6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7> 7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8> 8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9> 9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10>10</a>
</span><span class=lnt id=hl-22-11><a class=lnlinks href=#hl-22-11>11</a>
</span><span class=lnt id=hl-22-12><a class=lnlinks href=#hl-22-12>12</a>
</span><span class=lnt id=hl-22-13><a class=lnlinks href=#hl-22-13>13</a>
</span><span class=lnt id=hl-22-14><a class=lnlinks href=#hl-22-14>14</a>
</span><span class=lnt id=hl-22-15><a class=lnlinks href=#hl-22-15>15</a>
</span><span class=lnt id=hl-22-16><a class=lnlinks href=#hl-22-16>16</a>
</span><span class=lnt id=hl-22-17><a class=lnlinks href=#hl-22-17>17</a>
</span><span class=lnt id=hl-22-18><a class=lnlinks href=#hl-22-18>18</a>
</span><span class=lnt id=hl-22-19><a class=lnlinks href=#hl-22-19>19</a>
</span><span class=lnt id=hl-22-20><a class=lnlinks href=#hl-22-20>20</a>
</span><span class=lnt id=hl-22-21><a class=lnlinks href=#hl-22-21>21</a>
</span><span class=lnt id=hl-22-22><a class=lnlinks href=#hl-22-22>22</a>
</span><span class=lnt id=hl-22-23><a class=lnlinks href=#hl-22-23>23</a>
</span><span class=lnt id=hl-22-24><a class=lnlinks href=#hl-22-24>24</a>
</span><span class=lnt id=hl-22-25><a class=lnlinks href=#hl-22-25>25</a>
</span><span class=lnt id=hl-22-26><a class=lnlinks href=#hl-22-26>26</a>
</span><span class=lnt id=hl-22-27><a class=lnlinks href=#hl-22-27>27</a>
</span><span class=lnt id=hl-22-28><a class=lnlinks href=#hl-22-28>28</a>
</span><span class=lnt id=hl-22-29><a class=lnlinks href=#hl-22-29>29</a>
</span><span class=lnt id=hl-22-30><a class=lnlinks href=#hl-22-30>30</a>
</span><span class=lnt id=hl-22-31><a class=lnlinks href=#hl-22-31>31</a>
</span><span class=lnt id=hl-22-32><a class=lnlinks href=#hl-22-32>32</a>
</span><span class=lnt id=hl-22-33><a class=lnlinks href=#hl-22-33>33</a>
</span><span class=lnt id=hl-22-34><a class=lnlinks href=#hl-22-34>34</a>
</span><span class=lnt id=hl-22-35><a class=lnlinks href=#hl-22-35>35</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># payment_service.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaConsumer</span><span class=p>,</span> <span class=n>KafkaProducer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;order.events&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>group_id</span><span class=o>=</span><span class=s1>&#39;payment-service&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_deserializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_serializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>v</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>v</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>handle_order_created</span><span class=p>(</span><span class=n>event_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>amount</span> <span class=o>=</span> <span class=n>event_data</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>][</span><span class=s1>&#39;total&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=c1># 결제 처리 로직 (가정)</span>
</span></span><span class=line><span class=cl>    <span class=n>is_paid</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>is_paid</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;PaymentProcessed&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;data&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;order_id&#34;</span><span class=p>:</span> <span class=n>event_data</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>][</span><span class=s1>&#39;order_id&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;paid&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s1>&#39;payment.events&#39;</span><span class=p>,</span> <span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>producer</span><span class=o>.</span><span class=n>flush</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>msg</span> <span class=ow>in</span> <span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>event</span> <span class=o>=</span> <span class=n>msg</span><span class=o>.</span><span class=n>value</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;OrderCreated&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>handle_order_created</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=주목할-내용>주목할 내용<a hidden class=anchor aria-hidden=true href=#주목할-내용>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>주요 항목</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>아키텍처 패턴</strong></td><td>Pub/Sub</td><td>발행자와 구독자 간의 비동기 이벤트 전달 모델</td></tr><tr><td></td><td>Event Sourcing</td><td>상태 변경을 이벤트 시퀀스로 기록하는 패턴</td></tr><tr><td></td><td>CQRS</td><td>명령/조회 분리 아키텍처, 읽기/쓰기 최적화</td></tr><tr><td></td><td>Fan-out</td><td>하나의 이벤트를 다수의 소비자가 수신하는 패턴</td></tr><tr><td></td><td>Event Mesh</td><td>복수 브로커 간 메시지 전달을 지원하는 통합 네트워크 구조</td></tr><tr><td></td><td>Event Gateway</td><td>외부 이벤트를 브로커로 전달하는 통합 인터페이스</td></tr><tr><td></td><td>State-centric Messaging</td><td>분산 상태 관리와 메시징을 결합한 패러다임</td></tr><tr><td></td><td>메시지 - 쿼리 통합</td><td>메시징 시스템과 데이터베이스 쿼리 기능의 결합 형태</td></tr><tr><td><strong>운영/관리 기술</strong></td><td>Schema Registry</td><td>이벤트 메시지 포맷의 버전 관리 및 유효성 검증 도구</td></tr><tr><td></td><td>Tracing / Logging</td><td>이벤트 흐름 및 장애 분석용 관찰 도구 (OpenTelemetry 등)</td></tr><tr><td></td><td>오토스케일링</td><td>Kubernetes 기반 자동 확장 기능</td></tr><tr><td></td><td>리밸런싱 / 백프레셔</td><td>소비자 할당 재조정 및 과부하 제어 기법</td></tr><tr><td></td><td>Event Replay</td><td>메시지 재처리를 위한 이벤트 로그 재생 기능</td></tr><tr><td></td><td>통합 가시성 도구</td><td>멀티 브로커/환경 이벤트 추적 및 시각화 시스템</td></tr><tr><td></td><td>자가 최적화 브로커</td><td>AI 기반 워크로드 분석 및 설정 자동화 기능</td></tr><tr><td><strong>신뢰성 / 확장성</strong></td><td>Partition / Sharding</td><td>메시지 병렬 처리 및 확장을 위한 파티셔닝 기술</td></tr><tr><td></td><td>Replication</td><td>장애/데이터 유실 방지를 위한 다중 복제</td></tr><tr><td></td><td>DLQ (Dead Letter Queue)</td><td>실패 메시지 별도 저장 후 재처리 가능하게 하는 큐</td></tr><tr><td></td><td>ISR (In-Sync Replica)</td><td>리더와 동기화된 복제본 집합</td></tr><tr><td><strong>실시간 처리</strong></td><td>Stream Processing</td><td>이벤트를 실시간 분석, 알림, 변환 처리하는 기능</td></tr><tr><td></td><td>Flink, Storm, Spark Streaming</td><td>주요 실시간 스트림 처리 엔진들</td></tr><tr><td><strong>표준 및 생태계</strong></td><td>AsyncAPI</td><td>비동기 메시징용 API 명세 포맷</td></tr><tr><td></td><td>CloudEvents</td><td>클라우드 간 이벤트 표준 메타데이터 포맷</td></tr><tr><td></td><td>Avro / Protobuf / JSON Schema</td><td>이벤트 메시지 포맷 및 스키마 정의 방식</td></tr><tr><td></td><td>Apache Kafka / Pulsar / NATS</td><td>대표적인 오픈소스 Event Broker 솔루션</td></tr><tr><td></td><td>EventBridge / Event Hubs</td><td>AWS, Azure 등 관리형 이벤트 서비스</td></tr><tr><td><strong>기술 트렌드</strong></td><td>eBPF 기반 브로커 최적화</td><td>커널 레벨 필터링 및 라우팅 최적화를 위한 고급 기술</td></tr><tr><td></td><td>영속성과 지연 시간 균형</td><td>NVRAM, SSD 등을 통한 저지연 고내구성 설계</td></tr><tr><td></td><td>양자 내성 암호화</td><td>향후 양자 컴퓨팅 위협 대비 보안 기법 적용 연구 중</td></tr><tr><td></td><td>탄소 발자국 최적화</td><td>에너지 효율성 향상 및 지속가능한 메시징 시스템 설계</td></tr><tr><td><strong>도메인 특화 솔루션</strong></td><td>IoT 특화 브로커</td><td>리소스 제약, 엣지 환경 대응용 경량 메시징 솔루션 (예: MQTT 기반)</td></tr><tr><td></td><td>금융 특화 고성능 브로커</td><td>초저지연/고신뢰/규제 준수 메시지 처리 요구 대응</td></tr><tr><td></td><td>AI/ML 파이프라인 통합</td><td>모델 학습/추론 워크플로우와 이벤트 시스템 통합 설계</td></tr></tbody></table><h3 id=반드시-학습해야-할-내용>반드시 학습해야 할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야-할-내용>#</a></h3><table><thead><tr><th>🚀 카테고리</th><th>주제</th><th>핵심 항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>Messaging Theory</strong></td><td>전송 보장</td><td>At-least-once / Exactly-once</td><td>메시지 중복·손실 방지를 위한 전달 보장 수준 이해</td></tr><tr><td></td><td>Pub/Sub</td><td>발행/구독/이벤트 분배</td><td>퍼블리셔와 구독자 간의 메시지 배포 구조</td></tr><tr><td></td><td>Ack / Idempotency</td><td>ack(확인 응답) / 중복 처리 방지</td><td>메시지 처리 상태 확인 및 중복 트랜잭션 방지</td></tr><tr><td><strong>Streaming Platform</strong></td><td>Apache Kafka 아키텍처</td><td>분산 로그 기반 구조 및 설정</td><td>Kafka 내부 구조, 파티션, 브로커 구성 등</td></tr><tr><td></td><td>Partitioning</td><td>파티션, 샤딩, 토픽 분할</td><td>스케일아웃 및 병목 해소 설계 기법</td></tr><tr><td><strong>Integration Design</strong></td><td>Event Storming</td><td>도메인 이벤트 중심 설계 기법</td><td>비즈니스 흐름을 중심으로 이벤트 모델링</td></tr><tr><td></td><td>Schema Registry</td><td>스키마 등록소 및 버전 관리</td><td>Avro/Protobuf 기반 메시지 구조 통제</td></tr><tr><td><strong>Observability</strong></td><td>모니터링 및 트레이싱</td><td>흐름 추적, 장애 탐지</td><td>OpenTelemetry 등으로 이벤트 흐름 실시간 모니터링</td></tr><tr><td><strong>Format & Schema</strong></td><td>Avro / Protobuf 포맷</td><td>메시지 직렬화와 스키마 관리</td><td>효율적 포맷과 상호 운용성 유지</td></tr><tr><td><strong>운영/관제</strong></td><td>장애 복구 패턴</td><td>DLQ, Replication</td><td>실패 시 재처리와 데이터 복제 전략</td></tr><tr><td><strong>보안</strong></td><td>메시지 암호화/인증/인가</td><td>TLS, OAuth, 인증/인가 정책</td><td>메시지 무결성과 접근 제어 보장</td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어 (영문)</th><th>설명</th></tr></thead><tbody><tr><td>구조/역할</td><td><strong>Broker</strong></td><td>메시지/이벤트를 발행자와 구독자 간에 중계하는 중심 시스템</td></tr><tr><td></td><td><strong>Producer (생산자)</strong></td><td>메시지를 생성하여 브로커에 발행하는 컴포넌트</td></tr><tr><td></td><td><strong>Consumer (소비자)</strong></td><td>브로커로부터 메시지를 수신하고 처리하는 컴포넌트</td></tr><tr><td></td><td><strong>Consumer Group (컨슈머 그룹)</strong></td><td>동일 토픽을 병렬 처리하는 소비자들의 논리적 그룹</td></tr><tr><td></td><td><strong>Exchange (교환소)</strong></td><td>메시지를 라우팅 규칙에 따라 큐에 분배하는 브로커 컴포넌트</td></tr><tr><td>메시지 채널</td><td><strong>Topic (토픽)</strong></td><td>이벤트를 분류하고 구독할 수 있는 논리적 메시지 채널</td></tr><tr><td></td><td><strong>Queue (큐)</strong></td><td>메시지를 순서대로 저장하고 처리 대기하는 구조</td></tr><tr><td></td><td><strong>Partition (파티션)</strong></td><td>병렬 처리와 확장을 위해 토픽을 나눈 단위</td></tr><tr><td></td><td><strong>Offset (오프셋)</strong></td><td>컨슈머가 토픽 내 메시지를 어디까지 처리했는지 나타내는 지표</td></tr><tr><td></td><td><strong>Segment (세그먼트)</strong></td><td>파티션의 물리적 파일 단위</td></tr><tr><td>패턴/모델</td><td><strong>Pub/Sub (발행 - 구독)</strong></td><td>발행자가 메시지를 보내고, 구독자가 이를 수신하는 비동기 메시징 모델</td></tr><tr><td></td><td><strong>Event Sourcing</strong></td><td>시스템 상태 변경을 이벤트로 저장하고, 재생하여 상태를 복원하는 방식</td></tr><tr><td></td><td><strong>CQRS (Command Query Responsibility Segregation)</strong></td><td>명령과 조회의 책임을 분리하여 성능과 확장성 확보</td></tr><tr><td></td><td><strong>Saga Pattern (사가 패턴)</strong></td><td>분산 트랜잭션 처리를 위한 이벤트 기반 보상 트랜잭션 패턴</td></tr><tr><td></td><td><strong>Event Mesh</strong></td><td>여러 브로커를 연결하여 메시지 전송을 통합한 글로벌 이벤트 라우팅 구조</td></tr><tr><td>신뢰성/보장</td><td><strong>DLQ (Dead Letter Queue)</strong></td><td>처리 실패 메시지를 임시 저장해 재처리 또는 분석 가능하게 하는 큐</td></tr><tr><td></td><td><strong>Replication (복제)</strong></td><td>장애 대비를 위해 메시지를 다수의 브로커에 복제</td></tr><tr><td></td><td><strong>ISR (In-Sync Replica)</strong></td><td>리더와 동기화된 복제본 세트</td></tr><tr><td></td><td><strong>QoS (Quality of Service)</strong></td><td>메시지 전달 보장 수준: At-most-once, At-least-once, Exactly-once</td></tr><tr><td>성능/운영</td><td><strong>Backpressure (백프레셔)</strong></td><td>소비 속도가 생산 속도를 따라가지 못할 때 처리량 제어 메커니즘</td></tr><tr><td></td><td><strong>Rebalancing (리밸런싱)</strong></td><td>컨슈머 그룹 간 파티션 재할당 과정</td></tr><tr><td></td><td><strong>Watermark (워터마크)</strong></td><td>스트림 처리 시 시간 윈도우 계산 기준</td></tr><tr><td>운영/도구</td><td><strong>Schema Registry (스키마 레지스트리)</strong></td><td>메시지 포맷 (Avro, JSON 등) 의 버전/유효성 관리 시스템</td></tr><tr><td></td><td><strong>Tracing (트레이싱)</strong></td><td>이벤트 흐름 추적 및 분석 도구 (예: OpenTelemetry, Jaeger)</td></tr><tr><td></td><td><strong>AsyncAPI</strong></td><td>메시지 기반 API 명세 정의 포맷</td></tr><tr><td></td><td><strong>오토스케일링 (Auto-scaling)</strong></td><td>시스템 부하에 따라 컴퓨팅 자원을 자동으로 조절하는 기능</td></tr><tr><td>프로토콜</td><td><strong>AMQP</strong></td><td>고급 메시지 큐 프로토콜, 라우팅/보안 등 지원</td></tr><tr><td></td><td><strong>MQTT</strong></td><td>경량 메시지 프로토콜, IoT 환경에 적합</td></tr><tr><td></td><td><strong>STOMP</strong></td><td>간단한 텍스트 기반 메시징 프로토콜</td></tr><tr><td>이벤트 추출</td><td><strong>CDC (Change Data Capture)</strong></td><td>DB 변경 이벤트를 실시간 메시지로 전환하는 기법</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><h3 id=message-broker--event-broker>Message Broker & Event Broker<a hidden class=anchor aria-hidden=true href=#message-broker--event-broker>#</a></h3><ul><li><a href=https://www.ibm.com/kr-ko/cloud/learn/message-brokers>메시지 브로커란 무엇인가요? | IBM</a></li><li><a href=https://ko.wikipedia.org/wiki/%EB%A9%94%EC%8B%9C%EC%A7%80_%EB%B8%8C%EB%A1%9C%EC%BB%A4>메시지 브로커 - 위키백과</a></li><li><a href=https://solace.com/what-is-an-event-broker/>Event Broker 개념 및 기능</a></li><li><a href=https://www.confluent.io/what-is-an-event-broker/>What is an Event Broker - Confluent</a></li></ul><h3 id=message-broker-vs-event-broker-비교>Message Broker Vs Event Broker 비교<a hidden class=anchor aria-hidden=true href=#message-broker-vs-event-broker-비교>#</a></h3><ul><li><a href=https://f-lab.kr/insight/understanding-message-and-event-brokers-20240924>메시지 브로커와 이벤트 브로커의 이해와 활용</a></li><li><a href=https://f-lab.kr/insight/message-broker-event-broker>메시지 브로커와 이벤트 브로커: 분산 시스템의 핵심 기술</a></li><li><a href=https://medium.com/riskified-technology/message-broker-vs-event-broker-when-to-use-each-one-of-them-15597320a8ba>Message Broker vs Event Broker 비교 분석 - Riskified Tech</a></li><li><a href=https://www.upsolver.com/blog/comparing-message-brokers-and-event-processing-tools>메시지 브로커 vs 이벤트 처리 도구 비교 - Upsolver</a></li></ul><h3 id=rabbitmq-vs-kafka>RabbitMQ Vs Kafka<a hidden class=anchor aria-hidden=true href=#rabbitmq-vs-kafka>#</a></h3><ul><li><a href=https://aws.amazon.com/ko/compare/the-difference-between-rabbitmq-and-kafka/>RabbitMQ와 Kafka - 메시지 대기열 시스템 간의 차이점 - AWS</a></li><li><a href=https://velog.io/@cjy9306/Kafka%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%B8%8C%EB%A1%9C%EC%BB%A4-vs-RabbitMQ%EB%A9%94%EC%8B%9C%EC%A7%80-%EB%B8%8C%EB%A1%9C%EC%BB%A4>Kafka(이벤트 브로커) vs RabbitMQ(메시지 브로커)</a></li><li><a href=https://velog.io/@cho876/%EC%B9%B4%ED%94%84%EC%B9%B4kafka-vs-RabbitMQ>카프카(kafka) vs RabbitMQ</a></li></ul><h3 id=event-driven-architecture--event-mesh>Event-Driven Architecture & Event Mesh<a hidden class=anchor aria-hidden=true href=#event-driven-architecture--event-mesh>#</a></h3><ul><li><a href=https://www.redhat.com/ko/topics/integration/what-is-event-driven-architecture>이벤트 기반 아키텍처란? | Red Hat</a></li><li><a href=https://www.redhat.com/ko/topics/integration/what-is-an-event-mesh>이벤트 메쉬(Event Mesh)의 개념, 기능, 작동 방식, 사용 방법 | Red Hat</a></li><li><a href=https://learn.microsoft.com/en-us/azure/architecture/guide/architecture-styles/event-driven>Event-Driven Architecture 패턴 가이드 - Microsoft Azure</a></li><li><a href=https://learn.microsoft.com/en-us/azure/architecture/example-scenario/integration/queues-events>솔라스 Event Broker 아키텍처 예시</a></li></ul><h3 id=실무-적용--최적화-사례>실무 적용 & 최적화 사례<a hidden class=anchor aria-hidden=true href=#실무-적용--최적화-사례>#</a></h3><ul><li><a href=https://estuary.dev/blog/event-driven-architecture-examples/>EDA 실무 적용 사례 - Estuary</a></li><li><a href=https://www.site24x7.com/blog/troubleshooting-latency-issues-in-event-driven-architectures>EDA 성능 최적화 및 브로커 튜닝</a></li><li><a href=https://estuary.dev/blog/event-driven-architecture-examples/>Event-Driven Architecture 실무 사례 - Estuary</a></li></ul><h3 id=플랫폼별-공식-문서>플랫폼별 공식 문서<a hidden class=anchor aria-hidden=true href=#플랫폼별-공식-문서>#</a></h3><ul><li><a href=https://kafka.apache.org/documentation/>Apache Kafka 공식 문서 (Event Broker 구조)</a></li><li><a href=https://aws.amazon.com/eventbridge/>AWS EventBridge 공식 페이지</a></li><li><a href=https://learn.microsoft.com/en-us/azure/event-grid/overview>Azure Event Grid 개요</a></li><li><a href=https://cloud.google.com/eventarc/docs/overview>Google Cloud Eventarc 소개</a></li><li><a href=https://www.asyncapi.com/>AsyncAPI 공식 웹사이트</a></li></ul><h3 id=추가-자료>추가 자료<a hidden class=anchor aria-hidden=true href=#추가-자료>#</a></h3><ul><li><a href=https://www.devkobe24.com/Architecture/2024-12-30-Message-Broker.html>Message Broker(메시지 브로커)란 무엇일까?</a></li><li><a href=https://velog.io/@happysang/8-2.-Message-Broker-%ED%99%9C%EC%9A%A9>Message Broker 활용</a></li></ul><hr></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/systems-and-infrastructure/>Systems-and-Infrastructure</a></li><li><a href=https://buenhyden.github.io/tags/infrastructure/>Infrastructure</a></li><li><a href=https://buenhyden.github.io/tags/infrastructure-components/>Infrastructure-Components</a></li><li><a href=https://buenhyden.github.io/tags/messaging-systems/>Messaging-Systems</a></li><li><a href=https://buenhyden.github.io/tags/event-brokers-vs-message-brokers/>Event-Brokers-vs-Message-Brokers</a></li><li><a href=https://buenhyden.github.io/tags/event-broker/>Event-Broker</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/computer-science-fundamentals/concurrency-fundamentals/basic-concepts/lock/pessimistic-vs-optimistic-locking/><span class=title>« Prev</span><br><span>Pessimistic vs. Optimistic Locking</span>
</a><a class=next href=https://buenhyden.github.io/posts/networking--protocols/communication-patterns/message-infrastructure/message-brokers-vs-event-brokers/message-broker/><span class=title>Next »</span><br><span>Message Broker</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>