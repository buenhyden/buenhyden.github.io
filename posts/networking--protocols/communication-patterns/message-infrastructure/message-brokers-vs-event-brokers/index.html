<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Event Broker vs. Message Broker | hyunyoun's Blog</title><meta name=keywords content="Networking-and-Protocols,Communication-Patterns,Message-Infrastructure,Event-Brokers-vs-Message-Brokers,Event-Broker,Message-Broker"><meta name=description content="Event Broker 와 Message Broker 는 분산 시스템에서 애플리케이션 간 비동기 통신을 담당하는 미들웨어이다.  Message Broker 는 전통적인 큐 기반 메시지 전달에 특화되어 있으며, Event Broker 는 이벤트 스트리밍과 로그 기반 아키텍처를 통해 대용량 실시간 데이터 처리에 최적화되어 있다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/networking--protocols/communication-patterns/message-infrastructure/message-brokers-vs-event-brokers/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/networking--protocols/communication-patterns/message-infrastructure/message-brokers-vs-event-brokers/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/networking--protocols/communication-patterns/message-infrastructure/message-brokers-vs-event-brokers/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/networking--protocols/communication-patterns/message-infrastructure/message-brokers-vs-event-brokers/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Event Broker vs. Message Broker"><meta property="og:description" content="Event Broker 와 Message Broker 는 분산 시스템에서 애플리케이션 간 비동기 통신을 담당하는 미들웨어이다.  Message Broker 는 전통적인 큐 기반 메시지 전달에 특화되어 있으며, Event Broker 는 이벤트 스트리밍과 로그 기반 아키텍처를 통해 대용량 실시간 데이터 처리에 최적화되어 있다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Event Broker vs. Message Broker"><meta name=twitter:description content="Event Broker 와 Message Broker 는 분산 시스템에서 애플리케이션 간 비동기 통신을 담당하는 미들웨어이다.  Message Broker 는 전통적인 큐 기반 메시지 전달에 특화되어 있으며, Event Broker 는 이벤트 스트리밍과 로그 기반 아키텍처를 통해 대용량 실시간 데이터 처리에 최적화되어 있다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HY's Blog","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":3,"name":"Event Broker vs. Message Broker","item":"https://buenhyden.github.io/posts/networking--protocols/communication-patterns/message-infrastructure/message-brokers-vs-event-brokers/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>HY's Blog</a></div><h1>Event Broker vs. Message Broker</h1><div class=post-description>Event Broker 와 Message Broker 는 분산 시스템에서 애플리케이션 간 비동기 통신을 담당하는 미들웨어이다. Message Broker 는 전통적인 큐 기반 메시지 전달에 특화되어 있으며, Event Broker 는 이벤트 스트리밍과 로그 기반 아키텍처를 통해 대용량 실시간 데이터 처리에 최적화되어 있다.</div></header><div class=post-content><h2 id=event-broker-vs-message-broker>Event Broker vs. Message Broker<a hidden class=anchor aria-hidden=true href=#event-broker-vs-message-broker>#</a></h2><p>이벤트 브로커와 메시지 브로커는 현대 분산 시스템에서 핵심적인 미들웨어로, 서비스 간 결합도를 낮추고 확장성, 신뢰성, 실시간성, 장애 복원력을 제공한다. 이벤트 브로커는 Pub/Sub, 이벤트 스트리밍, 실시간 데이터 분배에 최적화되어 있으며, 메시지 브로커는 큐잉, 복잡한 라우팅, 포맷 변환, 트랜잭션 등 엔터프라이즈 통합에 강점을 보인다. 두 기술은 아키텍처, 메시징 패턴, 처리 방식, 주요 기능 등에서 차이가 있으며, 실제 환경에서는 요구사항에 따라 혼합 적용되기도 한다.</p><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><ul><li><strong>메시지 브로커는 작업 처리와 안정성 중심의 통신에 적합</strong>하며, <strong>명령 (Command), 요청 - 응답, 복잡한 라우팅이 필요한 경우에 효과적</strong>이다.</li><li><strong>이벤트 브로커는 실시간 스트리밍, 이벤트 소싱, 이벤트 기반 데이터 흐름이 중심인 아키텍처에 최적화</strong>되어 있다.</li><li>양자 모두 <strong>분산 시스템에서의 decoupling, 비동기성, 확장성</strong> 확보에 필수적인 미들웨어이며, <strong>도메인/업무의 특성에 따라 적절히 선택하거나 병행하여 사용</strong>하는 것이 권장된다.</li></ul><table><thead><tr><th>항목</th><th><strong>Event Broker (이벤트 브로커)</strong></th><th><strong>Message Broker (메시지 브로커)</strong></th></tr></thead><tbody><tr><td><strong>기본 정의</strong></td><td>시스템 내에서 발생한 <strong>이벤트를 토픽 기반 Pub/Sub</strong> 모델로 <strong>중계 및 브로드캐스트</strong>하는 미들웨어</td><td>송신자와 수신자 간의 메시지를 <strong>큐 기반 Point-to-Point</strong> 방식으로 <strong>중개 및 전달</strong>하는 미들웨어</td></tr><tr><td><strong>기반 모델</strong></td><td>Log 기반, Publish-Subscribe 모델</td><td>Queue 기반, Routing 기반 (Direct, Topic, Fanout, Headers)</td></tr><tr><td><strong>메시지 처리 방식</strong></td><td>여러 구독자가 동일 이벤트를 동시에 소비 가능 (1:N, N:N 확장에 유리)</td><td>메시지를 수신한 단일 소비자가 처리 (1:1 또는 Load Balancing 처리)</td></tr><tr><td><strong>용도 중심성</strong></td><td>상태 변화, 알림, 데이터 변경 전파 등 이벤트 스트리밍 중심 (Event-based)</td><td>작업 명령, 요청 처리, 커맨드 전송 중심 (Command-based)</td></tr><tr><td><strong>재처리 및 리텐션</strong></td><td>로그 기반으로 이벤트 보존 가능 (리텐션/압축 설정), 이벤트 재처리 및 타임 트래블 가능</td><td>일반적으로 메시지 소비 후 삭제, 재처리는 DLQ 기반 처리</td></tr><tr><td><strong>주요 특징</strong></td><td>실시간 이벤트 스트리밍, 대용량 데이터 브로드캐스트, 이벤트 소싱 및 추적 가능</td><td>신뢰성 높은 메시지 전달, 메시지 포맷 변환, 복잡한 라우팅 지원</td></tr><tr><td><strong>대표 구현체</strong></td><td>Apache Kafka, Apache Pulsar, Amazon EventBridge, Azure Event Grid, Solace PubSub+</td><td>RabbitMQ, Apache ActiveMQ, IBM MQ, Amazon SQS</td></tr></tbody></table><h3 id=event-broker-vs-message-broker-비교>Event Broker vs. Message Broker 비교<a hidden class=anchor aria-hidden=true href=#event-broker-vs-message-broker-비교>#</a></h3><p>이벤트 브로커와 메시지 브로커는 모두 메시지 기반의 비동기 통신 미들웨어이다. 하지만 이벤트 중심 (Event-Driven Architecture) 과 메시지 큐잉 및 라우팅 (Queueing & Routing) 이라는 핵심 원칙과 동작 방식의 차이가 있다.</p><table><thead><tr><th>구분</th><th><strong>Event Broker</strong></th><th><strong>Message Broker</strong></th></tr></thead><tbody><tr><td><strong>기본 개념</strong></td><td>상태 변화 (Event) 를 실시간으로 발행하고 다수 소비자가 동시에 수신할 수 있도록 하는 Pub/Sub 미들웨어</td><td>명령, 요청, 작업 메시지를 송신자에서 수신자로 전달하는 큐 기반 메시징 미들웨어</td></tr><tr><td><strong>주요 용도</strong></td><td>상태 변화 알림, 실시간 스트리밍, 이벤트 소싱</td><td>백엔드 작업 분리, 비동기 명령 처리, 복잡한 라우팅</td></tr><tr><td><strong>대표 기술</strong></td><td>Apache Kafka, Apache Pulsar, AWS EventBridge, Azure Event Grid</td><td>RabbitMQ, Apache ActiveMQ, Amazon SQS, IBM MQ</td></tr></tbody></table><h4 id=기능적-특성-비교>기능적 특성 비교<a hidden class=anchor aria-hidden=true href=#기능적-특성-비교>#</a></h4><p>두 브로커 유형은 애플리케이션 간 통신을 담당하지만, 제공하는 핵심 기능에 차이가 있다.</p><table><thead><tr><th>항목</th><th><strong>Event Broker</strong></th><th><strong>Message Broker</strong></th></tr></thead><tbody><tr><td><strong>재처리/리플레이</strong></td><td>오프셋 기반 로그 리플레이 가능 (Kafka), 타임 트래블 가능</td><td>제한적 (DLQ 기반 재시도, 수동으로 재게시 필요)</td></tr><tr><td><strong>확장성</strong></td><td>파티션 단위 수평 확장 구조, 대량 이벤트 스트리밍에 적합</td><td>브로커 수 증가로 수평 확장 가능하나 네트워크/설정 부담 존재</td></tr><tr><td><strong>라우팅 기능</strong></td><td>단순한 토픽 기반 라우팅</td><td>다양한 라우팅 (Direct, Topic, Headers, Fanout 등) 지원</td></tr><tr><td><strong>보존 정책</strong></td><td>설정 가능한 보존 시간 (<code>retention.ms</code>, <code>compaction</code>)</td><td>일반적으로 소비 후 삭제, TTL 설정 가능</td></tr><tr><td><strong>백프레셔 제어</strong></td><td>오프셋 기반 Flow Control (pull 제어)</td><td>큐 적체를 통해 자동 제어 (push 방식)</td></tr></tbody></table><h4 id=품질-성능-운영-측면-비교>품질, 성능, 운영 측면 비교<a hidden class=anchor aria-hidden=true href=#품질-성능-운영-측면-비교>#</a></h4><p>Event Broker 는 높은 처리량을 제공하며, Message Broker 는 낮은 지연시간과 정확한 메시지 전달에 강점을 보인다.</p><table><thead><tr><th>항목</th><th><strong>Event Broker</strong></th><th><strong>Message Broker</strong></th></tr></thead><tbody><tr><td><strong>처리량</strong></td><td>매우 높음 (초당 수백만 메시지, 파티션 병렬성 기반)</td><td>중간 ~ 높음 (메시지 사이즈, 큐 깊이에 따라 다름)</td></tr><tr><td><strong>지연 시간</strong></td><td>중간 (밀리초 ~ 수십 밀리초)</td><td>낮음 (마이크로초 ~ 밀리초)</td></tr><tr><td><strong>신뢰성</strong></td><td>높은 내구성 (로그 기반, 리플레이 가능)</td><td>보장된 전달 (Ack, DLQ 등으로 설정 가능)</td></tr><tr><td><strong>운영 복잡도</strong></td><td>설정 복잡 (오프셋, 파티션, 리밸런싱 등), 리소스 요구 높음</td><td>비교적 단순 (설정 및 운용 용이, 리소스 요구 낮음)</td></tr><tr><td><strong>스키마 관리</strong></td><td>Schema Registry 활용 가능 (Avro, Protobuf 등)</td><td>JSON/AMQP 로 유연하게 사용 가능</td></tr></tbody></table><h4 id=철학과-아키텍처-원칙>철학과 아키텍처 원칙<a hidden class=anchor aria-hidden=true href=#철학과-아키텍처-원칙>#</a></h4><p>Event Broker 는 이벤트 중심의 데이터 스트리밍에 최적화되어 있으며, Message Broker 는 안정적인 메시지 전달과 복잡한 라우팅에 특화되어 있다.</p><table><thead><tr><th>항목</th><th><strong>Event Broker</strong></th><th><strong>Message Broker</strong></th></tr></thead><tbody><tr><td><strong>중심 모델</strong></td><td>Event Stream 중심</td><td>Queue 기반 메시지 처리</td></tr><tr><td><strong>상태 관리</strong></td><td>오프셋/로그 기반 상태 유지</td><td>큐에 상태 저장, 일반적으로 무상태</td></tr><tr><td><strong>디커플링</strong></td><td>발행자 ↔ 구독자 완전한 분리</td><td>생산자 ↔ 소비자 간 시간적 분리 중심</td></tr><tr><td><strong>일관성 모델</strong></td><td>Eventually Consistent 중심</td><td>Strong Consistency 기반 구현 가능</td></tr><tr><td><strong>전달 보장 수준</strong></td><td>At least once / Exactly once 설정 가능 (Kafka EOS 등)</td><td>At most / At least / Exactly once 설정 가능 (Ack, retry 등)</td></tr></tbody></table><h3 id=주요-원리-및-작동-원리>주요 원리 및 작동 원리<a hidden class=anchor aria-hidden=true href=#주요-원리-및-작동-원리>#</a></h3><p>이벤트 브로커와 메시지 브로커는 분산 시스템에서 메시지를 전달하는 미들웨어이지만, 그 작동 원리와 메시지 처리 방식에는 큰 차이가 있다.</p><table><thead><tr><th>항목</th><th><strong>Event Broker</strong></th><th><strong>Message Broker</strong></th></tr></thead><tbody><tr><td><strong>전송 패턴</strong></td><td>발행 - 구독 (1:N 또는 N:N)</td><td>지점 간 (1:1), 발행 - 구독 (1:N), 요청 - 응답 (RPC 등)</td></tr><tr><td><strong>메시지 전달 방식</strong></td><td>주로 Pull 기반 (Kafka: Consumer 가 오프셋 기준으로 Pull)</td><td>주로 Push 기반 (RabbitMQ 등)</td></tr><tr><td><strong>저장 구조</strong></td><td>분산 로그 (Log-based), 파티션 단위로 디스크에 영구 저장</td><td>큐 기반, 메모리 + 디스크, 메시지 소비 후 삭제</td></tr><tr><td><strong>소비자 모델</strong></td><td>오프셋 기반, 컨슈머 그룹에서 병렬 소비 가능</td><td>단일 소비자 또는 Round-Robin, 메시지 소비 시 제거</td></tr><tr><td><strong>순서 보장</strong></td><td>파티션 내 순서 보장 (Kafka 등)</td><td>큐 순서 보장 (FIFO), 다중 소비자 시 순서 손상 가능</td></tr></tbody></table><h4 id=event-broker-작동-원리>Event Broker 작동 원리<a hidden class=anchor aria-hidden=true href=#event-broker-작동-원리>#</a></h4><pre class=mermaid>sequenceDiagram
    participant P as Producer
    participant B as Broker
    participant C as Consumer
    
    P-&gt;&gt;B: 1. 이벤트 발행 (토픽/파티션 지정)
    B-&gt;&gt;B: 2. 로그에 순차적 저장
    C-&gt;&gt;B: 3. 오프셋 기반 폴링
    B-&gt;&gt;C: 4. 배치 이벤트 전달
    C-&gt;&gt;B: 5. 오프셋 커밋
    
    Note over B: 이벤트는 보관 기간까지 유지
    Note over C: 컨슈머가 진행상황 관리
</pre><p>이벤트 브로커는 발행 - 구독 (pub/sub) 패턴을 중심으로 작동한다:</p><ol><li><strong>이벤트 발행</strong>: 생산자 (Publisher) 는 이벤트를 특정 주제 (Topic) 로 발행한다.</li><li><strong>이벤트 저장</strong>: 브로커는 이벤트를 로그 형태로 저장하고 분산된 파티션에 보관한다.</li><li><strong>이벤트 구독</strong>: 소비자 (Subscriber) 는 관심 있는 주제를 구독한다.</li><li><strong>이벤트 배포</strong>: 브로커는 이벤트를 해당 주제를 구독하는 모든 소비자에게 배포한다.</li><li><strong>오프셋 관리</strong>: 소비자는 자신이 처리한 이벤트의 위치 (오프셋) 를 관리한다.</li><li><strong>이벤트 재생</strong>: 소비자는 필요에 따라 이전 이벤트를 재생할 수 있다.</li></ol><p>특히 로그 기반 이벤트 브로커 (예: Apache Kafka) 에서는 이벤트가 순차적으로 저장되고, 소비자가 자신의 오프셋을 관리하면서 개별적인 속도로 이벤트를 소비할 수 있다.</p><h4 id=message-broker-작동-원리>Message Broker 작동 원리<a hidden class=anchor aria-hidden=true href=#message-broker-작동-원리>#</a></h4><pre class=mermaid>sequenceDiagram
    participant P as Producer
    participant E as Exchange
    participant Q as Queue
    participant C as Consumer
    
    P-&gt;&gt;E: 1. 메시지 발행 (라우팅 키 포함)
    E-&gt;&gt;Q: 2. 라우팅 규칙에 따라 큐 전달
    Q-&gt;&gt;C: 3. 메시지 푸시 또는 풀
    C-&gt;&gt;Q: 4. 처리 완료 ACK
    Q-&gt;&gt;Q: 5. 메시지 삭제
    
    Note over E: 스마트 라우팅 로직
    Note over Q: 메시지 소비 후 삭제
</pre><p>메시지 브로커는 주로 큐 기반으로 작동한다:</p><ol><li><strong>메시지 생성</strong>: 생산자는 메시지를 특정 큐에 발송한다.</li><li><strong>메시지 라우팅</strong>: 브로커는 메시지를 적절한 큐로 라우팅한다 (교환을 통해).</li><li><strong>메시지 큐잉</strong>: 메시지는 소비자가 처리할 때까지 큐에 저장된다.</li><li><strong>메시지 소비</strong>: 소비자는 큐에서 메시지를 가져와 처리한다.</li><li><strong>메시지 확인</strong>: 소비자는 처리 완료 후 확인 (acknowledgment) 을 보낸다.</li><li><strong>메시지 제거</strong>: 확인 후 브로커는 큐에서 메시지를 제거한다.</li></ol><p>메시지 브로커는 메시지 라우팅, 트랜잭션 관리, 메시지 우선순위 지정 등의 기능을 제공한다.</p><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><table><thead><tr><th>구분</th><th>Event Broker</th><th>Message Broker</th></tr></thead><tbody><tr><td><strong>통신 패턴</strong></td><td>Pub/Sub, Broadcast 중심</td><td>Point-to-Point, 일부 Pub/Sub 지원</td></tr><tr><td><strong>구성 요소</strong></td><td>Topic, Partition, Consumer Group, Offset, Retention 등</td><td>Queue, Exchange, Routing Key, Consumer, DLQ 등</td></tr><tr><td><strong>확장성</strong></td><td>수평 확장 용이 (파티션 기반), 구독자 증가에 강한 구조</td><td>수평 확장 어려움 (큐 중심), 수신자 수에 따라 제약 있음</td></tr><tr><td><strong>유지/관리</strong></td><td>이벤트 순서 관리, 오프셋 기반 추적, 로그 보존 정책 필요</td><td>메시지 순서 유지, QoS, Retry 관리, 라우팅 규칙 복잡화 가능</td></tr><tr><td><strong>데이터 흐름 제어</strong></td><td>Offset 기반 재처리, Rebalancing, Log Compaction 등</td><td>Backpressure, 우선순위 큐, DLQ 등</td></tr></tbody></table><h4 id=event-broker-아키텍처>Event Broker 아키텍처<a hidden class=anchor aria-hidden=true href=#event-broker-아키텍처>#</a></h4><pre class=mermaid>graph TB
    subgraph &#34;Event Broker Architecture&#34;
        P1[Producer 1] --&gt; T1[Topic/Partition 1]
        P2[Producer 2] --&gt; T1
        P3[Producer 3] --&gt; T2[Topic/Partition 2]
        
        T1 --&gt; CG1[Consumer Group 1]
        T1 --&gt; CG2[Consumer Group 2]
        T2 --&gt; CG1
        T2 --&gt; CG3[Consumer Group 3]
        
        CG1 --&gt; C1[Consumer 1]
        CG1 --&gt; C2[Consumer 2]
        CG2 --&gt; C3[Consumer 3]
        CG3 --&gt; C4[Consumer 4]
    end
</pre><p><strong>Event Broker 구성 요소:</strong><br><strong>필수 구성요소:</strong></p><ul><li><strong>브로커 클러스터</strong>: 분산 로그 저장과 복제</li><li><strong>토픽/파티션</strong>: 이벤트 분류와 병렬 처리</li><li><strong>프로듀서</strong>: 이벤트 발행 클라이언트</li><li><strong>컨슈머 그룹</strong>: 병렬 소비와 오프셋 관리</li></ul><p><strong>선택 구성요소:</strong></p><ul><li><strong>스키마 레지스트리</strong>: 이벤트 스키마 관리</li><li><strong>커넥터</strong>: 외부 시스템 통합</li><li><strong>스트림 프로세서</strong>: 실시간 데이터 변환</li></ul><h4 id=message-broker-아키텍처>Message Broker 아키텍처<a hidden class=anchor aria-hidden=true href=#message-broker-아키텍처>#</a></h4><pre class=mermaid>graph TB
    subgraph &#34;Message Broker Architecture&#34;
        P1[Producer 1] --&gt; E1[Exchange 1]
        P2[Producer 2] --&gt; E2[Exchange 2]
        
        E1 --&gt; Q1[Queue 1]
        E1 --&gt; Q2[Queue 2]
        E2 --&gt; Q2
        E2 --&gt; Q3[Queue 3]
        
        Q1 --&gt; C1[Consumer 1]
        Q2 --&gt; C2[Consumer 2]
        Q2 --&gt; C3[Consumer 3]
        Q3 --&gt; C4[Consumer 4]
    end
</pre><p><strong>Message Broker 구성 요소:</strong></p><p><strong>필수 구성요소:</strong></p><ul><li><strong>브로커 노드</strong>: 메시지 라우팅과 큐 관리</li><li><strong>교환기</strong>: 메시지 라우팅 로직</li><li><strong>큐</strong>: 메시지 임시 저장</li><li><strong>바인딩</strong>: 교환기와 큐 간 연결 규칙</li></ul><p><strong>선택 구성요소:</strong></p><ul><li><strong>데드 레터 큐</strong>: 실패 메시지 처리</li><li><strong>우선순위 큐</strong>: 메시지 우선순위 관리</li><li><strong>지연 큐</strong>: 스케줄링된 메시지 전달</li></ul><h3 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h3><table><thead><tr><th>분류</th><th>구현 기법</th><th>정의</th><th>구성 요소</th><th>목적</th><th>실제 시스템 구성 및 시나리오 예시</th></tr></thead><tbody><tr><td><strong>이벤트 브로커</strong></td><td><strong>1. 로그 기반 이벤트 스트리밍</strong></td><td>이벤트를 불변의 순차적 로그로 저장하여 재생 가능하게 하는 방식</td><td>분산 로그, 파티션, 오프셋, 소비자 그룹</td><td>이벤트 영속성, 재처리, 순서 보장</td><td><strong>Apache Kafka</strong>, Kafka Streams, ZooKeeper🛒 전자상거래 주문 이벤트를 실시간 분석/처리</td></tr><tr><td></td><td><strong>2. 주제 기반 발행 - 구독</strong></td><td>주제 (topic) 별로 이벤트를 분류하여 구독자에게 라우팅</td><td>주제, 필터, 구독자, 메시지 버스</td><td>관심사 기반 라우팅, 유연한 구독 구조</td><td><strong>AWS SNS, EventBridge, SQS</strong>📡 IoT 디바이스 이벤트 → 온도, 습도별 필터링 전달</td></tr><tr><td></td><td><strong>3. 이벤트 스트리밍 플랫폼</strong></td><td>수집, 저장, 처리, 분석을 포함한 통합 이벤트 파이프라인 구축</td><td>스트림 프로세서, 커넥터, 스키마 레지스트리</td><td>실시간 파이프라인, 분석 및 반응형 처리</td><td><strong>Confluent Platform, ksqlDB</strong>🏦 금융 사기 탐지, 위험 분석 시스템</td></tr><tr><td><strong>메시지 브로커</strong></td><td><strong>1. 큐 기반 메시징</strong></td><td>메시지를 큐에 저장하고 소비자가 순차적으로 처리하게 하는 방식</td><td>큐, 교환 (Exchange), 라우팅 키</td><td>안정적인 전달, 부하 분산, 병렬 처리</td><td><strong>RabbitMQ, AMQP</strong>🌐 사용자 요청 비동기 처리로 응답 최적화</td></tr><tr><td></td><td><strong>2. 미들웨어 통합</strong></td><td>다양한 시스템 간 통신을 중재하고 메시지 변환, 라우팅 등을 담당</td><td>어댑터, 메시지 변환기, 라우팅 엔진</td><td>이기종 시스템 간 통합</td><td><strong>Apache ActiveMQ, Spring Integration</strong>🏛️ 레거시 ↔ 마이크로서비스 연동</td></tr><tr><td></td><td><strong>3. 메시지 지향 미들웨어 (MOM)</strong></td><td>비동기 메시지 기반 통신 인프라를 제공하는 전통적인 미들웨어</td><td>메시지 큐, 클라이언트 라이브러리, 관리 도구</td><td>신뢰성 높은 통신, 엔터프라이즈 시스템 통합</td><td><strong>IBM MQ, JMS</strong>🏢 트랜잭션 데이터 전송/처리용 인프라</td></tr></tbody></table><ul><li><strong>이벤트 브로커</strong>는 <strong>로그 기반의 비가역적 저장</strong> 및 <strong>관심 기반 전달</strong>에 초점을 맞추고, <strong>실시간 분석 및 확장성</strong>에 적합.</li><li><strong>메시지 브로커</strong>는 <strong>큐 중심의 명령형 처리</strong>와 <strong>이기종 시스템 통합</strong>에 강점이 있으며, <strong>트랜잭션 안정성</strong>과 <strong>처리 보장</strong>에 집중됨.</li><li>둘은 <strong>Pub/Sub</strong>이라는 공통 모델을 공유하지만, 처리 방식과 아키텍처 설계 철학에서 차별화된다.</li></ul><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><table><thead><tr><th>카테고리</th><th>도전 과제</th><th>원인</th><th>영향</th><th>대응 전략</th></tr></thead><tbody><tr><td><strong>1. 메시지 무결성</strong></td><td>메시지 유실 / 중복 / 순서 보장</td><td>네트워크 장애, 브로커 실패, 중복 전송, 파티션 분산 구조</td><td>데이터 정합성 저하, 비즈니스 장애</td><td>- DLQ<br>Ack & Retry<br>Idempotency 처리<br>Partition Key 설정</td></tr><tr><td><strong>2. 스키마 관리</strong></td><td>메시지 스키마 호환성</td><td>프로듀서/컨슈머 버전 차이, 명세 미준수</td><td>소비자 파싱 오류, 서비스 실패</td><td>- Schema Registry<br>Forward/Backward 호환성<br>- 버전 관리</td></tr><tr><td><strong>3. 트랜잭션 및 일관성</strong></td><td>분산 트랜잭션 처리</td><td>멀티 서비스 간 데이터 상태 비동기 동기화 문제</td><td>상태 불일치, 중복 처리, Rollback 어려움</td><td>- SAGA<br>Outbox Pattern<br>- 이벤트 소싱 (CQRS)</td></tr><tr><td><strong>4. 모니터링 및 가시성</strong></td><td>메시지 흐름 추적 / 상태 탐지</td><td>비동기 처리 + Pub/Sub 구조로 인한 흐름 불투명성</td><td>장애 원인 파악 지연, 운영 복잡성</td><td>- Distributed Tracing (OpenTelemetry)<br>- 브로커 모니터링 지표 (Lag, Ack 등)</td></tr><tr><td><strong>5. 성능 및 확장성</strong></td><td>처리량 저하 / 병목 / 지연</td><td>큐 적체, 불균형 파티션 처리, 리소스 고갈</td><td>SLA 미충족, 사용자 경험 저하</td><td>- 파티셔닝 / 샤딩<br>Auto-scaling 워커<br>- 배치 처리</td></tr><tr><td><strong>6. 보안 및 규정 준수</strong></td><td>민감 정보 노출 / 규정 미준수</td><td>인증·암호화 부족, 정책 미흡, 접근 제어 부재</td><td>법적 위반, 데이터 유출 위험</td><td>- TLS/SASL 적용<br>RBAC/ACL<br>- 감사 로그 및 데이터 마스킹</td></tr><tr><td><strong>7. 테스트 복잡성</strong></td><td>이벤트 기반 테스트 어려움</td><td>상태 없는 메시지, 비동기 구조</td><td>예측 불가한 장애, 통합 테스트 환경 구축 어려움</td><td>- Contract Testing (CDC)<br>Mock 브로커 활용</td></tr><tr><td><strong>8. 장애 복구 및 신뢰성</strong></td><td>장애 대응 어려움 / 재처리 복잡성</td><td>재시도 로직 부재, 메시지 유실 감지 안됨, 상태 미동기화</td><td>신뢰성 저하, 사용자의 데이터 손실</td><td>- 보상 트랜잭션<br>- 로그 기반 재처리<br>- 메시지 재생 기능 (Replay)</td></tr><tr><td><strong>9. 운영 복잡성</strong></td><td>브로커/컨슈머/서비스 다수 운영</td><td>마이크로서비스 + 분산 브로커 구성</td><td>운영 부담, 설정 오류, 장애 전파</td><td>- Helm/Operator 로 구성 자동화<br>- 표준화된 모니터링 및 대시보드</td></tr></tbody></table><h3 id=실무-적용-구분>실무 적용 구분<a hidden class=anchor aria-hidden=true href=#실무-적용-구분>#</a></h3><p>각 브로커는 서로 다른 비즈니스 요구사항과 기술적 제약 조건에 최적화되어 있다.</p><table><thead><tr><th>조건/요구사항</th><th><strong>적합한 브로커</strong></th><th><strong>사유</strong></th></tr></thead><tbody><tr><td>대규모 실시간 데이터 스트리밍</td><td>Event Broker</td><td>파티셔닝 기반 수평 확장, 오프셋 기반 재처리, 높은 처리량</td></tr><tr><td>주문 처리, 워크플로우 관리, 명령 큐</td><td>Message Broker</td><td>단순 명령/작업 지시, 낮은 지연 시간, 다양한 라우팅</td></tr><tr><td>이벤트 소싱, 타임 트래블 기반 분석</td><td>Event Broker</td><td>과거 이벤트 재구성, 로그 보존 기능 필수</td></tr><tr><td>백오피스 작업 큐, 이메일 발송 등</td><td>Message Broker</td><td>작업 단위 메시지 처리, DLQ/우선순위 큐 활용 가능</td></tr><tr><td>시스템 간 통합, 포맷 변환, API Gateway 연동</td><td>Message Broker</td><td>메시지 포맷 변환, 트랜잭션, 복잡한 Exchange 라우팅 가능</td></tr><tr><td>IoT/분산 트래픽 브로드캐스트</td><td>Event Broker</td><td>이벤트 기반 라우팅, 고속 Fan-out, 다중 구독자 처리 최적화</td></tr></tbody></table><h4 id=실무-구현-연관성-분석>실무 구현 연관성 분석<a hidden class=anchor aria-hidden=true href=#실무-구현-연관성-분석>#</a></h4><h5 id=공통-실무-요소>공통 실무 요소<a hidden class=anchor aria-hidden=true href=#공통-실무-요소>#</a></h5><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>Decoupling</strong></td><td>송신자와 수신자의 시간·공간적 독립성 제공</td></tr><tr><td><strong>비동기 처리</strong></td><td>시스템 응답성과 확장성 개선</td></tr><tr><td><strong>장애 복원력</strong></td><td>메시지 큐, 로그 리텐션, 재처리 메커니즘으로 장애 시 복구</td></tr><tr><td><strong>보안</strong></td><td>TLS, 인증/인가, 역할 기반 권한관리 필요</td></tr><tr><td><strong>Observability</strong></td><td>트레이싱, 로그 수집, 메트릭 모니터링 필수 (OpenTelemetry, Prometheus 등)</td></tr></tbody></table><h5 id=event-broker-특화-실무-요소>Event Broker 특화 실무 요소<a hidden class=anchor aria-hidden=true href=#event-broker-특화-실무-요소>#</a></h5><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>파티셔닝</strong></td><td>수평 확장성과 병렬 처리 최적화 (Kafka, Pulsar)</td></tr><tr><td><strong>Offset/Consumer Group</strong></td><td>이벤트 재처리 및 순서 보장에 필수</td></tr><tr><td><strong>리텐션/압축</strong></td><td>로그 기반 보존, 장기 아카이빙 가능</td></tr><tr><td><strong>이벤트 소싱 연계</strong></td><td>도메인 상태 저장 및 재구성에 유리</td></tr><tr><td><strong>Stream Processing 연계</strong></td><td>Kafka Streams, Flink 등 실시간 처리 파이프라인과 자연스럽게 통합됨</td></tr></tbody></table><h5 id=message-broker-특화-실무-요소>Message Broker 특화 실무 요소<a hidden class=anchor aria-hidden=true href=#message-broker-특화-실무-요소>#</a></h5><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>Exchange Routing</strong></td><td>Direct, Topic, Headers 등 복잡한 메시지 라우팅 가능</td></tr><tr><td><strong>DLQ 및 Retry 관리</strong></td><td>실패한 메시지 재처리 및 모니터링</td></tr><tr><td><strong>우선순위 큐 구성</strong></td><td>중요 메시지 먼저 소비</td></tr><tr><td><strong>Command/Task 분리</strong></td><td>명령 메시지 중심의 작업 처리 분리</td></tr><tr><td><strong>트랜잭션 및 포맷 변환</strong></td><td>다중 메시지 트랜잭션 처리, 메시지 포맷 통합 처리</td></tr></tbody></table><h4 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h4><table><thead><tr><th><strong>카테고리</strong></th><th><strong>고려사항</strong></th><th><strong>설명</strong></th><th><strong>Event Broker</strong></th><th><strong>Message Broker</strong></th><th><strong>권장사항</strong></th></tr></thead><tbody><tr><td><strong>설계 및 패턴</strong></td><td>메시징 패턴</td><td>처리 목적에 맞는 Pub/Sub, Queue, 스트리밍, 이벤트 소싱 등 선택</td><td>Pub/Sub, 스트리밍, 이벤트 소싱 중심</td><td>Queue, Pub/Sub, Request/Reply 지원</td><td>도메인 목적과 트래픽 특성을 기준으로 패턴 선택</td></tr><tr><td></td><td>아키텍처 목적 정의</td><td>실시간/이벤트 중심 처리인지, 명령/작업 중심 처리인지 구분 필요</td><td>상태 변화 중심 이벤트 전파</td><td>명령/요청 기반 작업 위임 구조</td><td>CQRS, EDA, MDA 등 설계 철학에 맞는 브로커 선택</td></tr><tr><td><strong>운영 및 확장성</strong></td><td>확장성</td><td>수평 확장, 오토스케일링, 병렬성 확보를 위한 구성</td><td>파티션 기반 병렬 소비, Consumer Group 구성 쉬움</td><td>클러스터 구성 시 제한적. Exchange/Queue 수 증가에 따른 부하</td><td>파티셔닝 전략 및 컨슈머 그룹 설정, 오토스케일링 기반 확장 설계</td></tr><tr><td></td><td>운영 복잡도</td><td>설정 항목, 클러스터링, 리밸런싱, 오프셋 관리 등 운영 난이도</td><td>높음: 오프셋, 리텐션, 오케스트레이션 필요</td><td>중간: 큐 구성, 라우팅 관리 중심</td><td>운영 자동화 도구 적용 (Kafka Operator, MirrorMaker 등)</td></tr><tr><td></td><td>데이터 볼륨 및 처리량</td><td>대용량 스트림 처리 또는 소규모 트랜잭션 중심인지 판단</td><td>대용량 스트리밍에 적합</td><td>중소규모 트랜잭션 처리에 적합</td><td>사전 부하 예측 기반 파티션 수, 브로커 수 구성</td></tr><tr><td><strong>신뢰성 및 복원력</strong></td><td>메시지 보장 수준</td><td>전송/중복/손실을 제어할 수 있는 전송 보장 모델 (QoS) 필요</td><td>At-least-once / Exactly-once 구성 가능</td><td>At-most / At-least / Exactly-once 설정 가능</td><td>멱등성, 트랜잭션, ack 설정 및 DLQ 구성으로 보장 수준 설계</td></tr><tr><td></td><td>장애 복구 전략</td><td>브로커 장애 시의 복구 전략과 처리 실패 메시지 대응 방안</td><td>로그 기반 재처리 (Offset), 리플레이</td><td>DLQ, Retry, 트랜잭션 기반 복원</td><td>복제, 리텐션 정책, 오프셋 관리, DLQ/Retry 구성</td></tr><tr><td></td><td>메시지 순서 보장</td><td>순서 의존 로직이 있는 경우 메시지 순서 유지가 필수</td><td>파티션 내 순서 보장 (단일 키 유지 필요)</td><td>큐 기반 순서 보장, 단 다중 컨슈머 시 순서 깨질 수 있음</td><td>파티션 키 설계 또는 순차 큐 구성</td></tr><tr><td><strong>보안 및 스키마</strong></td><td>스키마 관리</td><td>생산자/소비자 간 메시지 구조 불일치 방지를 위한 사전 정의 필요</td><td>Avro, Protobuf + Schema Registry</td><td>JSON, XML 등 포맷 자유로우나 형식 불일치 가능성 있음</td><td>Confluent Schema Registry, AsyncAPI 등 도입</td></tr><tr><td></td><td>메시지 크기 및 TTL</td><td>대용량 메시지 또는 장기 보관 메시지로 인한 성능 저하 방지</td><td>Retention 설정으로 오래 보관 가능</td><td>TTL 설정으로 자동 삭제 가능</td><td>메시지 크기 제한 설정 + 보관 정책 수립</td></tr><tr><td></td><td>보안 정책</td><td>암호화, 인증, 권한 제어, 채널별 접근 제어 등</td><td>TLS, ACL, SASL/JAAS 기반 Topic 접근 제어</td><td>TLS, 사용자 인증 + Queue 단위 권한 설정</td><td>민감한 데이터 전송 시 전송/저장 시점 모두 암호화 구성</td></tr><tr><td><strong>모니터링 및 장애 분석</strong></td><td>시스템 모니터링</td><td>브로커 상태, 처리량, 큐 길이, 지연 시간 등의 지표 모니터링</td><td>Offset lag, 파티션 지연, Consumer Lag</td><td>Queue length, In-flight 메시지, ack 지연 등</td><td>Prometheus, Kafka Lag Exporter, Grafana 등 연동</td></tr><tr><td></td><td>분산 추적 및 흐름 분석</td><td>장애 시 메시지 흐름 및 호출 관계 추적</td><td>Tracing 연계 어려움 → OpenTelemetry 통합 필요</td><td>Zipkin/Jaeger 등과 연계 용이</td><td>Distributed Tracing 연동 (Trace ID 기반)</td></tr><tr><td></td><td>백프레셔 처리</td><td>생산/소비 속도 불균형 시 과부하 방지 전략 필요</td><td>Pull 기반 흐름 제어, 소비자 속도에 따라 조절 가능</td><td>큐 적체 시 자동 컨트롤 (Push 기반)</td><td>버퍼 설정, 소비자 수 확장, 파티션 조절 등으로 대응</td></tr></tbody></table><h4 id=성능을-최적화하기-위한-고려사항-및-주의할-점>성능을 최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#성능을-최적화하기-위한-고려사항-및-주의할-점>#</a></h4><table><thead><tr><th>카테고리</th><th>항목</th><th>공통 고려사항</th><th>Event Broker 고려사항 (예: Kafka)</th><th>Message Broker 고려사항 (예: RabbitMQ)</th></tr></thead><tbody><tr><td><strong>1. 메시징 구조</strong></td><td>메시지 크기</td><td>메시지 경량화, 10MB 이하 권장</td><td>Avro/Protobuf 사용, 헤더 최소화</td><td>메시지 크기 제한 있음 (예: SQS 256KB), 분할 전송 고려</td></tr><tr><td></td><td>메시지 배치</td><td>단건 처리 오버헤드 방지, Throughput 증가</td><td>Producer/Consumer 배치 처리, linger.ms 조정</td><td><code>prefetch_count</code>, ack 설정 최적화</td></tr><tr><td></td><td>메시지 압축</td><td>네트워크/저장 공간 최적화</td><td>Snappy, LZ4, GZIP 압축 레벨 조정</td><td>지원 안되는 경우도 많음. 애플리케이션 레벨에서 압축 필요</td></tr><tr><td></td><td>멱등성 / 중복 처리</td><td>중복 수신 방지, 중복 메시지 식별 ID 적용</td><td>idempotent producer, 이벤트 키 기반 추적</td><td>메시지 해시값 기반 중복 필터링 큐 구성</td></tr><tr><td></td><td>순서 보장</td><td>처리 순서가 중요할 경우 파티션 또는 큐 라우팅 전략 필수</td><td>파티션 키 기반 라우팅, 단일 파티션 처리</td><td>FIFO 큐, 메시지 그룹 ID 활용</td></tr><tr><td><strong>2. 브로커 구조</strong></td><td>파티션 / 큐 설계</td><td>병렬성 확보와 부하 분산, 핫스팟 방지</td><td>파티션 수 조정, 파티션 재조정 계획 (Kafka Reassign Tool 등)</td><td>교환기 (Exchange) + 큐 라우팅 키 구조 설계</td></tr><tr><td></td><td>토픽/큐 유지 설정</td><td>Retention 정책, 저장소 절약</td><td>주제 보존 기간 조절, log compaction 설정</td><td>큐 TTL, 최대 메시지 수 제한 설정</td></tr><tr><td></td><td>디스크 최적화</td><td>디스크 I/O 성능 확보</td><td>SSD 사용, page cache 튜닝</td><td>디스크 경로 다중화, journal 최적화</td></tr><tr><td></td><td>메시지 직렬화 포맷</td><td>직렬화 비용 최소화</td><td>Avro, Protobuf 등 바이너리 포맷</td><td>JSON 은 느림, MsgPack, CBOR 등 고려</td></tr><tr><td><strong>3. 네트워크/전송</strong></td><td>네트워크 대역폭</td><td>전송 병목 방지, WAN 환경 최적화</td><td>브로커 간 replication 최소화, Zero-Copy 사용 가능</td><td>메시지 압축, VPC 피어링 적용</td></tr><tr><td></td><td>연결 관리</td><td>클라이언트 수 증가 대응</td><td>Persistent connection 유지, 연결 풀 구성</td><td>Connection pool 관리, heartbeat 조정</td></tr><tr><td></td><td>클러스터 구성 최적화</td><td>브로커 간 트래픽 최적화</td><td>리더 선출 알고리즘, 리더 - 팔로워 구조 최적화</td><td>미러 큐 구성으로 데이터 복제</td></tr><tr><td><strong>4. 리소스/확장성</strong></td><td>CPU / Memory / Disk</td><td>브로커에 충분한 리소스 할당 필요</td><td>JVM 힙 최적화, GC 튜닝, 디스크 I/O 모니터링</td><td>메시지 큐별 할당량 제한, prefetch 튜닝</td></tr><tr><td></td><td>오토스케일링</td><td>트래픽 급증 대응</td><td>Kafka Operator, KEDA 기반 스케일링 적용</td><td>Kubernetes HPA + RabbitMQ Cluster Operator 활용</td></tr><tr><td></td><td>캐싱 전략</td><td>메타데이터 및 반복 데이터 캐싱</td><td>컨슈머 측 캐시, 이벤트 중복 검증 캐시</td><td>큐 정보 캐싱, 메시지 상태 캐싱 등</td></tr><tr><td><strong>5. 오류/복원성</strong></td><td>오류 처리 전략</td><td>재시도, 백오프, DLQ 구성</td><td>Retries + DLQ 구성, ack.timeout 설정</td><td>Dead Letter Exchange (DLX), reject + requeue 전략</td></tr><tr><td></td><td>메시지 재처리 / 리플레이</td><td>장애 발생 시 동일 메시지 재처리</td><td>Consumer offset rewind, compacted topic 재조회</td><td>메시지 재생 직접 구현 필요, 별도 큐 유지 필요</td></tr><tr><td></td><td>Consumer Lag</td><td>지연 감지 및 대응</td><td>Lag 모니터링 지표 분석, 소비자 병렬도 조정</td><td>큐 길이 감시, prefetch 조절</td></tr><tr><td><strong>6. 보안/운영</strong></td><td>인증 / 암호화</td><td>민감 데이터 보호</td><td>SASL/TLS, mTLS 인증, 토픽 단위 ACL</td><td>TLS 인증, IP 화이트리스트, 큐 접근 제한</td></tr><tr><td></td><td>모니터링</td><td>성능 병목 및 이상 탐지</td><td>Kafka Exporter + Prometheus + Grafana</td><td>RabbitMQ Management Plugin, Exporter 활용</td></tr><tr><td></td><td>로깅 오버헤드</td><td>과도한 로그 발생 시 성능 저하</td><td>로그 레벨 조정, 샘플링 로깅, 비동기 로깅 적용</td><td>Filebeat 등으로 로그 수집, 큐별 이벤트 로그 제한</td></tr></tbody></table><h4 id=선택-가이드-실무-활용-관점>선택 가이드: 실무 활용 관점<a hidden class=anchor aria-hidden=true href=#선택-가이드-실무-활용-관점>#</a></h4><table><thead><tr><th><strong>적용 조건/설계 기준</strong></th><th><strong>권장 브로커 유형</strong></th><th><strong>설명 및 이유</strong></th></tr></thead><tbody><tr><td><strong>1:1 명령 처리 / Task Queue 중심 워크로드</strong></td><td>Message Broker</td><td>단일 소비자 처리, 명령 기반 구조, 작업 분산 최적 (예: 이메일 발송, 이미지 처리)</td></tr><tr><td><strong>1:N 알림 / 이벤트 브로드캐스트 필요</strong></td><td>Event Broker</td><td>구독자 다수에게 전달, 느슨한 결합 구조, 반응형 처리에 적합 (예: 주문 발생 → 알림/재고/배송 등)</td></tr><tr><td><strong>대용량 스트리밍 / 이벤트 소싱 / 로그 기반 처리</strong></td><td>Event Broker</td><td>Kafka 기반 로그 저장 및 재처리, 스트리밍 분석, 상태 변화 추적에 이상적</td></tr><tr><td><strong>정교한 라우팅, 트랜잭션 처리, 포맷 변환이 필요한 경우</strong></td><td>Message Broker</td><td>AMQP 기반 Exchange 기능으로 복잡한 메시지 흐름, 데이터 포맷 전환, 트랜잭션 지원</td></tr><tr><td><strong>Microservice 간 업무 분산 및 비동기 작업 분배</strong></td><td>Message Broker</td><td>각 서비스에 특정 작업만 전달, 큐 기반 소비, 작업 우선순위 처리 최적</td></tr><tr><td><strong>복수 시스템에서 동시에 반응해야 하고 재처리 가능해야 함</strong></td><td>Event Broker</td><td>다중 구독 처리, 로그 기반 재처리, 재생 가능, 이벤트 소싱 기반 아키텍처에 적합</td></tr><tr><td><strong>엄격한 순서 보장이 중요한 시나리오</strong></td><td>Message Broker</td><td>기본 FIFO 보장 큐 활용 가능 (예: 은행 이체, 주문 순서)</td></tr><tr><td><strong>다수 소비자 + 순서 보장 병행 필요</strong></td><td>Event Broker + Partition</td><td>Kafka 파티션 단위로 소비자 그룹 구성 시 순서 보장 유지 가능</td></tr><tr><td><strong>메시지 유실이 절대 용납되지 않는 환경</strong></td><td>Message Broker</td><td>ACK, Retry, DLQ, Persistent Queue 기반의 높은 신뢰성 제공</td></tr><tr><td><strong>시스템 상태 변화의 실시간 모니터링이 중요한 경우</strong></td><td>Event Broker</td><td>스트리밍 기반 처리 및 로그 수집, 실시간 대시보드, 이벤트 흐름 추적에 유리</td></tr><tr><td><strong>레거시 시스템과 통합 연동이 중요한 경우</strong></td><td>Message Broker</td><td>JMS, AMQP, STOMP 등 기존 프로토콜과의 호환성 우수</td></tr></tbody></table><h4 id=실시간-vs-비실시간-메시지-처리-시스템-비교>실시간 vs. 비실시간 메시지 처리 시스템 비교<a hidden class=anchor aria-hidden=true href=#실시간-vs-비실시간-메시지-처리-시스템-비교>#</a></h4><table><thead><tr><th>구분</th><th>실시간 메시지 처리 시스템</th><th>비실시간 메시지 처리 시스템</th></tr></thead><tbody><tr><td><strong>정의</strong></td><td>이벤트가 발생하는 즉시 처리</td><td>이벤트가 일정 시간 단위로 일괄 처리</td></tr><tr><td><strong>처리 지연</strong></td><td>수 ms ~ 수 초</td><td>수 초 ~ 수 분 이상</td></tr><tr><td><strong>브로커 예시</strong></td><td>Apache Kafka, NATS, Pulsar, Google Pub/Sub</td><td>Amazon SQS, RabbitMQ, AWS Kinesis Data Firehose</td></tr><tr><td><strong>사용 목적</strong></td><td>실시간 알림, 금융 거래, IoT 센서, AI 추론</td><td>로그 수집, 통계 처리, 보고서 생성</td></tr><tr><td><strong>처리 단위</strong></td><td>단건 이벤트, Stream</td><td>일괄 메시지, Batch</td></tr><tr><td><strong>복잡도</strong></td><td>높은 동기화, 장애 대응 필요</td><td>상대적으로 단순</td></tr><tr><td><strong>데이터 정확성</strong></td><td>고신뢰 메시지 보장 필요</td><td>지연 허용 가능, 신뢰성 일부 낮음</td></tr><tr><td><strong>보통 구조</strong></td><td>Pub/Sub, Stream Processing</td><td>Queue 기반 일괄 소비</td></tr><tr><td><strong>대표 기술</strong></td><td>Kafka + Flink, Pulsar Functions, EventBridge</td><td>SQS + Lambda, Kinesis Firehose, Hadoop</td></tr><tr><td><strong>장점</strong></td><td>사용자 반응성, 자동화, 예측 기반 처리</td><td>단순 구성, 비용 효율성, 안정성</td></tr><tr><td><strong>단점</strong></td><td>운영 복잡도, 높은 인프라 비용</td><td>늦은 응답, 실시간 피드백 불가</td></tr></tbody></table><h5 id=아키텍처-차이-도식>아키텍처 차이 도식<a hidden class=anchor aria-hidden=true href=#아키텍처-차이-도식>#</a></h5><h6 id=실시간-메시지-처리-아키텍처>실시간 메시지 처리 아키텍처<a hidden class=anchor aria-hidden=true href=#실시간-메시지-처리-아키텍처>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2>2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3>3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4>4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5>5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6>6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[이벤트 발생 (앱, IoT, 웹)]
</span></span><span class=line><span class=cl>        ↓
</span></span><span class=line><span class=cl>   [Message Broker (Kafka)]
</span></span><span class=line><span class=cl>        ↓
</span></span><span class=line><span class=cl>[실시간 처리 엔진 (Flink, Spark Streaming)]
</span></span><span class=line><span class=cl>        ↓
</span></span><span class=line><span class=cl>   [DB / 알림 시스템 / 추론 API]
</span></span></code></pre></td></tr></table></div></div><ul><li>특징: 메시지가 발생하는 즉시 소비자에게 전달 → 실시간 처리 후 알림 또는 결과 반환</li></ul><h6 id=비실시간-메시지-처리-아키텍처>비실시간 메시지 처리 아키텍처<a hidden class=anchor aria-hidden=true href=#비실시간-메시지-처리-아키텍처>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2>2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3>3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4>4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5>5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6>6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[로그, 이벤트 수집]
</span></span><span class=line><span class=cl>        ↓
</span></span><span class=line><span class=cl>[Message Queue (SQS, RabbitMQ)]
</span></span><span class=line><span class=cl>        ↓
</span></span><span class=line><span class=cl>[Batch Consumer (Lambda, ETL Job)]
</span></span><span class=line><span class=cl>        ↓
</span></span><span class=line><span class=cl>[Data Lake, RDS, 보고서 시스템]
</span></span></code></pre></td></tr></table></div></div><ul><li>특징: 일정 주기로 메시지를 수신하여 한번에 묶어 처리 → DB 적재 또는 정기 리포트 생성</li></ul><h5 id=설계-시-고려할-점>설계 시 고려할 점<a hidden class=anchor aria-hidden=true href=#설계-시-고려할-점>#</a></h5><table><thead><tr><th>요소</th><th>실시간 설계 시 고려사항</th><th>비실시간 설계 시 고려사항</th></tr></thead><tbody><tr><td>메시지 지연</td><td>Low Latency (ms 단위)</td><td>1 분 이상 허용</td></tr><tr><td>메시지 순서</td><td>순서 보장 필수 (Kafka 파티션)</td><td>순서 필요 없을 수 있음</td></tr><tr><td>장애 복구</td><td>이벤트 재처리 또는 재시도 큐 구성</td><td>실패한 Job 의 재시도 설정 중심</td></tr><tr><td>데이터 보존</td><td>이벤트 저장 (로그 재생 등)</td><td>일정 기간 후 삭제</td></tr><tr><td>리소스 비용</td><td>지속적인 소비 → 높은 비용</td><td>예약 실행, 스팟 인스턴스 등으로 절감 가능</td></tr></tbody></table><h4 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h4><table><thead><tr><th><strong>도메인</strong></th><th><strong>대표 시나리오</strong></th><th><strong>브로커 유형</strong></th><th><strong>연계 시스템/기술</strong></th><th><strong>구현 목적</strong></th><th><strong>기대 효과</strong></th></tr></thead><tbody><tr><td>전자상거래</td><td>주문 처리, 배송 시스템 연동</td><td>Message Broker</td><td>RabbitMQ, SQS, Worker Pool</td><td>주문 요청 큐 처리, 작업 분리</td><td>주문 누락 방지, 시스템 응답성 향상</td></tr><tr><td>전자상거래</td><td>주문 이벤트 기반 재고/추천 반영</td><td>Event Broker</td><td>Kafka, Elasticsearch, Kafka Connect</td><td>실시간 이벤트 전파</td><td>동기화 지연 없는 분석, 실시간 UX 개선</td></tr><tr><td>금융</td><td>거래 이벤트 스트리밍 분석</td><td>Event Broker</td><td>Kafka, Flink, ML Model</td><td>리스크 평가, 사기 탐지</td><td>실시간 위험 탐지 및 자동 차단 가능</td></tr><tr><td>금융</td><td>트랜잭션 요청/응답 처리</td><td>Message Broker</td><td>RabbitMQ, BPM, DLQ</td><td>신뢰성 높은 결제 처리</td><td>메시지 유실 방지, 강한 일관성 확보</td></tr><tr><td>IoT</td><td>센서 데이터 수집/처리</td><td>Event Broker</td><td>Google Eventarc, Kafka, InfluxDB, Grafana</td><td>실시간 데이터 스트림</td><td>예측 유지보수, 상태 기반 알림, 대시보드 통합</td></tr><tr><td>IoT</td><td>디바이스 명령, 펌웨어 업데이트</td><td>Message Broker</td><td>MQTT, RabbitMQ</td><td>디바이스 제어 메시지 큐 관리</td><td>비동기 명령 전달, 제어 신뢰성 확보</td></tr><tr><td>미디어/콘텐츠</td><td>실시간 콘텐츠 배포/사용자 추적</td><td>Event Broker</td><td>Kafka, CloudFront, Recommendation Engine</td><td>사용자 이벤트 분석, 콘텐츠 최적화</td><td>콘텐츠 개인화, 스트리밍 동기화</td></tr><tr><td>미디어/콘텐츠</td><td>인코딩/전송 작업 큐 관리</td><td>Message Broker</td><td>RabbitMQ, FFmpeg, Worker Pool</td><td>비동기 병렬 작업 분배</td><td>처리 지연 감소, 리소스 최적화</td></tr><tr><td>알림 시스템</td><td>멀티 채널 사용자 알림</td><td>Message Broker</td><td>AWS SNS/SQS, FCM, SMS Gateway</td><td>사용자 트리거 알림 전송</td><td>반응성 증가, 다채널 대응 가능</td></tr><tr><td>알림 시스템</td><td>사용자 이벤트 기반 알림</td><td>Event Broker</td><td>Kafka, EventBridge, Firebase Cloud Messaging</td><td>이벤트 기반 자동 푸시</td><td>지연 없는 대규모 알림 브로드캐스트</td></tr><tr><td>실시간 분석</td><td>사용자 행동 분석, 로그 집계</td><td>Event Broker</td><td>Kafka, Spark, ELK Stack, Fluentd</td><td>스트리밍 기반 실시간 분석</td><td>실시간 개인화, 운영 이슈 탐지</td></tr><tr><td>서버리스 아키텍처</td><td>이벤트 기반 트리거 처리</td><td>Event Broker</td><td>AWS EventBridge + Lambda, Azure Event Grid + Logic Apps</td><td>이벤트 중심 마이크로서비스 통합</td><td>운영비 절감, 코드 없는 연결</td></tr><tr><td>백오피스 자동화</td><td>워크플로우 처리, 보고서 생성</td><td>Message Broker</td><td>Workflow Engine, BPM, RabbitMQ</td><td>백그라운드 작업 분리 및 트리거</td><td>운영 자동화, 가용성 및 장애 대응력 향상</td></tr><tr><td>데이터 파이프라인</td><td>실시간 데이터 이동/ETL</td><td>Event Broker</td><td>Kafka, Google Pub/Sub, Cloud Run</td><td>스트림 기반 ETL 구성</td><td>실시간 데이터 흐름, 확장성 확보</td></tr><tr><td>교통/물류</td><td>실시간 차량 추적, 배송 알림</td><td>Event Broker</td><td>Kafka, GPS Tracker, Delivery System</td><td>실시간 위치 추적</td><td>운영 효율성, 루트 최적화</td></tr></tbody></table><h4 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h4><h5 id=사례-1-주문-처리-시스템>사례 1: 주문 처리 시스템<a hidden class=anchor aria-hidden=true href=#사례-1-주문-처리-시스템>#</a></h5><p><strong>시스템 구성</strong></p><pre class=mermaid>graph TD
  Client(클라이언트) --&gt; Frontend(프론트엔드)
  Frontend --&gt; API_Server(API 서버)
  API_Server --&gt; MQ[&#34;Message Broker(메시지 브로커)&#34;]
  MQ --&gt; Worker1[주문처리 워커1]
  MQ --&gt; Worker2[주문처리 워커2]
</pre><p><strong>Workflow</strong></p><ol><li>클라이언트가 주문 요청</li><li>API 서버가 메시지 브로커로 주문 메시지 전송</li><li>여러 워커가 메시지 브로커에서 메시지를 읽어 작업 수행</li><li>완료된 경우, 메시지 삭제/acknowledge</li></ol><p><strong>역할</strong>: 메시지 브로커는 중복 없이 신뢰적으로 메시지를 전달하고, 장애 발생 시 재처리를 지원.</p><p><strong>존재 유무 차이</strong>: 메시지 브로커 미사용 시, 주문 누락, 중복 주문, 시스템 부하 불균형이 발생할 수 있음. 사용 시 신뢰성 및 확장성을 확보.</p><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span><span class=lnt id=hl-7-12><a class=lnlinks href=#hl-7-12>12</a>
</span><span class=lnt id=hl-7-13><a class=lnlinks href=#hl-7-13>13</a>
</span><span class=lnt id=hl-7-14><a class=lnlinks href=#hl-7-14>14</a>
</span><span class=lnt id=hl-7-15><a class=lnlinks href=#hl-7-15>15</a>
</span><span class=lnt id=hl-7-16><a class=lnlinks href=#hl-7-16>16</a>
</span><span class=lnt id=hl-7-17><a class=lnlinks href=#hl-7-17>17</a>
</span><span class=lnt id=hl-7-18><a class=lnlinks href=#hl-7-18>18</a>
</span><span class=lnt id=hl-7-19><a class=lnlinks href=#hl-7-19>19</a>
</span><span class=lnt id=hl-7-20><a class=lnlinks href=#hl-7-20>20</a>
</span><span class=lnt id=hl-7-21><a class=lnlinks href=#hl-7-21>21</a>
</span><span class=lnt id=hl-7-22><a class=lnlinks href=#hl-7-22>22</a>
</span><span class=lnt id=hl-7-23><a class=lnlinks href=#hl-7-23>23</a>
</span><span class=lnt id=hl-7-24><a class=lnlinks href=#hl-7-24>24</a>
</span><span class=lnt id=hl-7-25><a class=lnlinks href=#hl-7-25>25</a>
</span><span class=lnt id=hl-7-26><a class=lnlinks href=#hl-7-26>26</a>
</span><span class=lnt id=hl-7-27><a class=lnlinks href=#hl-7-27>27</a>
</span><span class=lnt id=hl-7-28><a class=lnlinks href=#hl-7-28>28</a>
</span><span class=lnt id=hl-7-29><a class=lnlinks href=#hl-7-29>29</a>
</span><span class=lnt id=hl-7-30><a class=lnlinks href=#hl-7-30>30</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 메시지 브로커(RabbitMQ) 기반 주문 처리 예시</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pika</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메시지 발신자(Producer) - 주문 메시지 발행</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_order</span><span class=p>(</span><span class=n>message</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>connection</span> <span class=o>=</span> <span class=n>pika</span><span class=o>.</span><span class=n>BlockingConnection</span><span class=p>(</span><span class=n>pika</span><span class=o>.</span><span class=n>ConnectionParameters</span><span class=p>(</span><span class=s1>&#39;localhost&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>channel</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>channel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>channel</span><span class=o>.</span><span class=n>queue_declare</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;order_queue&#39;</span><span class=p>,</span> <span class=n>durable</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>channel</span><span class=o>.</span><span class=n>basic_publish</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                          <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;order_queue&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                          <span class=n>body</span><span class=o>=</span><span class=n>message</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                          <span class=n>properties</span><span class=o>=</span><span class=n>pika</span><span class=o>.</span><span class=n>BasicProperties</span><span class=p>(</span><span class=n>delivery_mode</span><span class=o>=</span><span class=mi>2</span><span class=p>))</span> <span class=c1># 메시지 영속성</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Order sent: </span><span class=si>{</span><span class=n>message</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>connection</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메시지 수신자(Consumer) - 워커가 메시지를 받아 처리</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>process_orders</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>callback</span><span class=p>(</span><span class=n>ch</span><span class=p>,</span> <span class=n>method</span><span class=p>,</span> <span class=n>properties</span><span class=p>,</span> <span class=n>body</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Order received: </span><span class=si>{</span><span class=n>body</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 실제 주문 처리 로직 (DB 저장 등)</span>
</span></span><span class=line><span class=cl>        <span class=n>ch</span><span class=o>.</span><span class=n>basic_ack</span><span class=p>(</span><span class=n>delivery_tag</span><span class=o>=</span><span class=n>method</span><span class=o>.</span><span class=n>delivery_tag</span><span class=p>)</span> <span class=c1># 메시지 처리 완료 알림</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>connection</span> <span class=o>=</span> <span class=n>pika</span><span class=o>.</span><span class=n>BlockingConnection</span><span class=p>(</span><span class=n>pika</span><span class=o>.</span><span class=n>ConnectionParameters</span><span class=p>(</span><span class=s1>&#39;localhost&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>channel</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>channel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>channel</span><span class=o>.</span><span class=n>queue_declare</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;order_queue&#39;</span><span class=p>,</span> <span class=n>durable</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>channel</span><span class=o>.</span><span class=n>basic_qos</span><span class=p>(</span><span class=n>prefetch_count</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span> <span class=c1># 하나씩 처리 (부하제어)</span>
</span></span><span class=line><span class=cl>    <span class=n>channel</span><span class=o>.</span><span class=n>basic_consume</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;order_queue&#39;</span><span class=p>,</span> <span class=n>on_message_callback</span><span class=o>=</span><span class=n>callback</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Waiting for orders...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>channel</span><span class=o>.</span><span class=n>start_consuming</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>위 코드는 RabbitMQ (메시지 브로커) 에서 주문 메시지를 큐로 송수신하는 실무 구조를 주석과 함께 보여준다.</li></ul><h5 id=사례-2-이커머스-주문-이벤트-처리>사례 2: 이커머스 주문 이벤트 처리<a hidden class=anchor aria-hidden=true href=#사례-2-이커머스-주문-이벤트-처리>#</a></h5><p><strong>시스템 구성</strong>:</p><ul><li>Kafka Topic: <code>order.created</code>, <code>order.shipped</code></li><li>Producer: 주문 마이크로서비스 (Spring Boot)</li><li>Consumers:<ul><li>배송 시스템 (자동화)</li><li>알림 서비스 (이메일/SMS)</li><li>실시간 대시보드 (Elastic/Kibana)</li></ul></li></ul><pre class=mermaid>flowchart LR
    A[Order Service] --&gt; B[Kafka Topic: order.created]
    B --&gt; C[Shipping Service]
    B --&gt; D[Notification Service]
    B --&gt; E[Analytics Dashboard]
</pre><p><strong>Workflow</strong>:</p><ol><li>주문 완료 시 <code>order.created</code> 이벤트 발행</li><li>Kafka 가 이벤트를 저장하고 구독자에게 전파</li><li>각 소비자는 독립적으로 반응 (자동 배송, 알림 전송 등)</li></ol><p><strong>역할</strong>:</p><ul><li>Kafka (Event Broker) 는 이벤트를 <strong>한 번 발행하여 여러 서비스가 동시 반응</strong>할 수 있도록 함</li><li><strong>느슨한 결합</strong>, <strong>스케일 아웃</strong>, <strong>장애 격리성</strong> 보장</li></ul><p><strong>유무에 따른 차이점</strong>:</p><table><thead><tr><th>비교 항목</th><th>Kafka 사용</th><th>미사용</th></tr></thead><tbody><tr><td>확장성</td><td>소비자 수에 관계없이 확장 가능</td><td>서비스 추가 시 코드 수정 필요</td></tr><tr><td>장애 영향도</td><td>한 소비자 장애 시 다른 소비자 영향 없음</td><td>동기 호출 방식은 전체 실패로 연결 가능</td></tr><tr><td>개발 생산성</td><td>이벤트 기반으로 관심 서비스만 구현 가능</td><td>전체 호출 흐름 관리가 복잡</td></tr></tbody></table><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11>11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12>12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13>13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14>14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Kafka Consumer - 주문 이벤트 수신 후 배송 처리</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaConsumer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;order.created&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>group_id</span><span class=o>=</span><span class=s1>&#39;shipping-service&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_deserializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>message</span> <span class=ow>in</span> <span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>order</span> <span class=o>=</span> <span class=n>message</span><span class=o>.</span><span class=n>value</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;🚚 배송 시작: 주문번호 </span><span class=si>{</span><span class=n>order</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 배송 처리 로직 호출</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>KafkaConsumer</code> 는 <code>order.created</code> 토픽을 구독하고,</li><li>메시지를 실시간 수신해 배송 처리 자동화 로직과 연동</li></ul><h5 id=사례-3-전자상거래-실시간-추천-시스템>사례 3: 전자상거래 실시간 추천 시스템<a hidden class=anchor aria-hidden=true href=#사례-3-전자상거래-실시간-추천-시스템>#</a></h5><p><strong>시스템 구성</strong>:</p><ul><li><strong>데이터 프로듀서</strong>: 웹/모바일 애플리케이션, 클릭스트림 수집기</li><li><strong>Event Broker</strong>: Apache Kafka 클러스터 (3 노드)</li><li><strong>스트림 프로세서</strong>: Apache Kafka Streams, Apache Flink</li><li><strong>데이터 저장소</strong>: Redis (실시간 추천), Elasticsearch (검색), Apache Cassandra (사용자 프로필)</li></ul><pre class=mermaid>graph TB
    subgraph &#34;Data Sources&#34;
        WEB[웹 애플리케이션]
        MOBILE[모바일 앱]
        API[API 게이트웨이]
    end
    
    subgraph &#34;Event Broker Layer&#34;
        KAFKA[Apache Kafka Cluster]
        T1[사용자 행동 토픽]
        T2[상품 조회 토픽]
        T3[구매 이벤트 토픽]
    end
    
    subgraph &#34;Stream Processing&#34;
        KS[Kafka Streams]
        FLINK[Apache Flink]
    end
    
    subgraph &#34;Data Storage&#34;
        REDIS[Redis Cache]
        ES[Elasticsearch]
        CASSANDRA[Cassandra DB]
    end
    
    subgraph &#34;Application Services&#34;
        REC[추천 서비스]
        SEARCH[검색 서비스]
        USER[사용자 서비스]
    end
    
    WEB --&gt; KAFKA
    MOBILE --&gt; KAFKA
    API --&gt; KAFKA
    
    KAFKA --&gt; T1
    KAFKA --&gt; T2
    KAFKA --&gt; T3
    
    T1 --&gt; KS
    T2 --&gt; FLINK
    T3 --&gt; KS
    
    KS --&gt; REDIS
    FLINK --&gt; ES
    KS --&gt; CASSANDRA
    
    REDIS --&gt; REC
    ES --&gt; SEARCH
    CASSANDRA --&gt; USER
</pre><p><strong>Workflow</strong>:</p><ol><li><strong>이벤트 발생</strong>: 사용자가 상품을 클릭하거나 구매</li><li><strong>이벤트 수집</strong>: 웹/모바일 앱에서 이벤트 데이터 생성</li><li><strong>이벤트 발행</strong>: Kafka 토픽에 이벤트 전송</li><li><strong>스트림 처리</strong>: 실시간으로 사용자 행동 패턴 분석</li><li><strong>추천 생성</strong>: 개인화된 상품 추천 목록 생성</li><li><strong>결과 저장</strong>: Redis 에 추천 결과 캐싱</li><li><strong>서비스 제공</strong>: 실시간으로 추천 상품 제공</li></ol><p><strong>Event Broker 의 역할</strong>:</p><ul><li><strong>높은 처리량</strong>: 초당 100 만 건의 이벤트 처리</li><li><strong>실시간 스트리밍</strong>: 수 밀리초 내 이벤트 전달</li><li><strong>데이터 영속성</strong>: 7 일간 이벤트 이력 보관으로 재처리 가능</li><li><strong>확장성</strong>: 파티셔닝을 통한 선형적 확장</li></ul><p><strong>Event Broker 유무에 따른 차이점</strong>:</p><ul><li><strong>Event Broker 사용 시:</strong><ul><li>실시간 개인화 추천 (&lt; 100ms 응답시간)</li><li>이벤트 재처리를 통한 모델 개선</li><li>시스템 장애 시 자동 복구</li><li>다양한 분석 도구와 쉬운 통합</li></ul></li><li><strong>Event Broker 미사용 시:</strong><ul><li>배치 기반 추천 (수 시간 지연)</li><li>데이터 유실 위험</li><li>시스템 간 강결합</li><li>확장성 제약</li></ul></li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1>  1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2>  2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3>  3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4>  4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5>  5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6>  6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7>  7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8>  8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9>  9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10> 10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11> 11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12> 12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13> 13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14> 14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15> 15</a>
</span><span class=lnt id=hl-11-16><a class=lnlinks href=#hl-11-16> 16</a>
</span><span class=lnt id=hl-11-17><a class=lnlinks href=#hl-11-17> 17</a>
</span><span class=lnt id=hl-11-18><a class=lnlinks href=#hl-11-18> 18</a>
</span><span class=lnt id=hl-11-19><a class=lnlinks href=#hl-11-19> 19</a>
</span><span class=lnt id=hl-11-20><a class=lnlinks href=#hl-11-20> 20</a>
</span><span class=lnt id=hl-11-21><a class=lnlinks href=#hl-11-21> 21</a>
</span><span class=lnt id=hl-11-22><a class=lnlinks href=#hl-11-22> 22</a>
</span><span class=lnt id=hl-11-23><a class=lnlinks href=#hl-11-23> 23</a>
</span><span class=lnt id=hl-11-24><a class=lnlinks href=#hl-11-24> 24</a>
</span><span class=lnt id=hl-11-25><a class=lnlinks href=#hl-11-25> 25</a>
</span><span class=lnt id=hl-11-26><a class=lnlinks href=#hl-11-26> 26</a>
</span><span class=lnt id=hl-11-27><a class=lnlinks href=#hl-11-27> 27</a>
</span><span class=lnt id=hl-11-28><a class=lnlinks href=#hl-11-28> 28</a>
</span><span class=lnt id=hl-11-29><a class=lnlinks href=#hl-11-29> 29</a>
</span><span class=lnt id=hl-11-30><a class=lnlinks href=#hl-11-30> 30</a>
</span><span class=lnt id=hl-11-31><a class=lnlinks href=#hl-11-31> 31</a>
</span><span class=lnt id=hl-11-32><a class=lnlinks href=#hl-11-32> 32</a>
</span><span class=lnt id=hl-11-33><a class=lnlinks href=#hl-11-33> 33</a>
</span><span class=lnt id=hl-11-34><a class=lnlinks href=#hl-11-34> 34</a>
</span><span class=lnt id=hl-11-35><a class=lnlinks href=#hl-11-35> 35</a>
</span><span class=lnt id=hl-11-36><a class=lnlinks href=#hl-11-36> 36</a>
</span><span class=lnt id=hl-11-37><a class=lnlinks href=#hl-11-37> 37</a>
</span><span class=lnt id=hl-11-38><a class=lnlinks href=#hl-11-38> 38</a>
</span><span class=lnt id=hl-11-39><a class=lnlinks href=#hl-11-39> 39</a>
</span><span class=lnt id=hl-11-40><a class=lnlinks href=#hl-11-40> 40</a>
</span><span class=lnt id=hl-11-41><a class=lnlinks href=#hl-11-41> 41</a>
</span><span class=lnt id=hl-11-42><a class=lnlinks href=#hl-11-42> 42</a>
</span><span class=lnt id=hl-11-43><a class=lnlinks href=#hl-11-43> 43</a>
</span><span class=lnt id=hl-11-44><a class=lnlinks href=#hl-11-44> 44</a>
</span><span class=lnt id=hl-11-45><a class=lnlinks href=#hl-11-45> 45</a>
</span><span class=lnt id=hl-11-46><a class=lnlinks href=#hl-11-46> 46</a>
</span><span class=lnt id=hl-11-47><a class=lnlinks href=#hl-11-47> 47</a>
</span><span class=lnt id=hl-11-48><a class=lnlinks href=#hl-11-48> 48</a>
</span><span class=lnt id=hl-11-49><a class=lnlinks href=#hl-11-49> 49</a>
</span><span class=lnt id=hl-11-50><a class=lnlinks href=#hl-11-50> 50</a>
</span><span class=lnt id=hl-11-51><a class=lnlinks href=#hl-11-51> 51</a>
</span><span class=lnt id=hl-11-52><a class=lnlinks href=#hl-11-52> 52</a>
</span><span class=lnt id=hl-11-53><a class=lnlinks href=#hl-11-53> 53</a>
</span><span class=lnt id=hl-11-54><a class=lnlinks href=#hl-11-54> 54</a>
</span><span class=lnt id=hl-11-55><a class=lnlinks href=#hl-11-55> 55</a>
</span><span class=lnt id=hl-11-56><a class=lnlinks href=#hl-11-56> 56</a>
</span><span class=lnt id=hl-11-57><a class=lnlinks href=#hl-11-57> 57</a>
</span><span class=lnt id=hl-11-58><a class=lnlinks href=#hl-11-58> 58</a>
</span><span class=lnt id=hl-11-59><a class=lnlinks href=#hl-11-59> 59</a>
</span><span class=lnt id=hl-11-60><a class=lnlinks href=#hl-11-60> 60</a>
</span><span class=lnt id=hl-11-61><a class=lnlinks href=#hl-11-61> 61</a>
</span><span class=lnt id=hl-11-62><a class=lnlinks href=#hl-11-62> 62</a>
</span><span class=lnt id=hl-11-63><a class=lnlinks href=#hl-11-63> 63</a>
</span><span class=lnt id=hl-11-64><a class=lnlinks href=#hl-11-64> 64</a>
</span><span class=lnt id=hl-11-65><a class=lnlinks href=#hl-11-65> 65</a>
</span><span class=lnt id=hl-11-66><a class=lnlinks href=#hl-11-66> 66</a>
</span><span class=lnt id=hl-11-67><a class=lnlinks href=#hl-11-67> 67</a>
</span><span class=lnt id=hl-11-68><a class=lnlinks href=#hl-11-68> 68</a>
</span><span class=lnt id=hl-11-69><a class=lnlinks href=#hl-11-69> 69</a>
</span><span class=lnt id=hl-11-70><a class=lnlinks href=#hl-11-70> 70</a>
</span><span class=lnt id=hl-11-71><a class=lnlinks href=#hl-11-71> 71</a>
</span><span class=lnt id=hl-11-72><a class=lnlinks href=#hl-11-72> 72</a>
</span><span class=lnt id=hl-11-73><a class=lnlinks href=#hl-11-73> 73</a>
</span><span class=lnt id=hl-11-74><a class=lnlinks href=#hl-11-74> 74</a>
</span><span class=lnt id=hl-11-75><a class=lnlinks href=#hl-11-75> 75</a>
</span><span class=lnt id=hl-11-76><a class=lnlinks href=#hl-11-76> 76</a>
</span><span class=lnt id=hl-11-77><a class=lnlinks href=#hl-11-77> 77</a>
</span><span class=lnt id=hl-11-78><a class=lnlinks href=#hl-11-78> 78</a>
</span><span class=lnt id=hl-11-79><a class=lnlinks href=#hl-11-79> 79</a>
</span><span class=lnt id=hl-11-80><a class=lnlinks href=#hl-11-80> 80</a>
</span><span class=lnt id=hl-11-81><a class=lnlinks href=#hl-11-81> 81</a>
</span><span class=lnt id=hl-11-82><a class=lnlinks href=#hl-11-82> 82</a>
</span><span class=lnt id=hl-11-83><a class=lnlinks href=#hl-11-83> 83</a>
</span><span class=lnt id=hl-11-84><a class=lnlinks href=#hl-11-84> 84</a>
</span><span class=lnt id=hl-11-85><a class=lnlinks href=#hl-11-85> 85</a>
</span><span class=lnt id=hl-11-86><a class=lnlinks href=#hl-11-86> 86</a>
</span><span class=lnt id=hl-11-87><a class=lnlinks href=#hl-11-87> 87</a>
</span><span class=lnt id=hl-11-88><a class=lnlinks href=#hl-11-88> 88</a>
</span><span class=lnt id=hl-11-89><a class=lnlinks href=#hl-11-89> 89</a>
</span><span class=lnt id=hl-11-90><a class=lnlinks href=#hl-11-90> 90</a>
</span><span class=lnt id=hl-11-91><a class=lnlinks href=#hl-11-91> 91</a>
</span><span class=lnt id=hl-11-92><a class=lnlinks href=#hl-11-92> 92</a>
</span><span class=lnt id=hl-11-93><a class=lnlinks href=#hl-11-93> 93</a>
</span><span class=lnt id=hl-11-94><a class=lnlinks href=#hl-11-94> 94</a>
</span><span class=lnt id=hl-11-95><a class=lnlinks href=#hl-11-95> 95</a>
</span><span class=lnt id=hl-11-96><a class=lnlinks href=#hl-11-96> 96</a>
</span><span class=lnt id=hl-11-97><a class=lnlinks href=#hl-11-97> 97</a>
</span><span class=lnt id=hl-11-98><a class=lnlinks href=#hl-11-98> 98</a>
</span><span class=lnt id=hl-11-99><a class=lnlinks href=#hl-11-99> 99</a>
</span><span class=lnt id=hl-11-100><a class=lnlinks href=#hl-11-100>100</a>
</span><span class=lnt id=hl-11-101><a class=lnlinks href=#hl-11-101>101</a>
</span><span class=lnt id=hl-11-102><a class=lnlinks href=#hl-11-102>102</a>
</span><span class=lnt id=hl-11-103><a class=lnlinks href=#hl-11-103>103</a>
</span><span class=lnt id=hl-11-104><a class=lnlinks href=#hl-11-104>104</a>
</span><span class=lnt id=hl-11-105><a class=lnlinks href=#hl-11-105>105</a>
</span><span class=lnt id=hl-11-106><a class=lnlinks href=#hl-11-106>106</a>
</span><span class=lnt id=hl-11-107><a class=lnlinks href=#hl-11-107>107</a>
</span><span class=lnt id=hl-11-108><a class=lnlinks href=#hl-11-108>108</a>
</span><span class=lnt id=hl-11-109><a class=lnlinks href=#hl-11-109>109</a>
</span><span class=lnt id=hl-11-110><a class=lnlinks href=#hl-11-110>110</a>
</span><span class=lnt id=hl-11-111><a class=lnlinks href=#hl-11-111>111</a>
</span><span class=lnt id=hl-11-112><a class=lnlinks href=#hl-11-112>112</a>
</span><span class=lnt id=hl-11-113><a class=lnlinks href=#hl-11-113>113</a>
</span><span class=lnt id=hl-11-114><a class=lnlinks href=#hl-11-114>114</a>
</span><span class=lnt id=hl-11-115><a class=lnlinks href=#hl-11-115>115</a>
</span><span class=lnt id=hl-11-116><a class=lnlinks href=#hl-11-116>116</a>
</span><span class=lnt id=hl-11-117><a class=lnlinks href=#hl-11-117>117</a>
</span><span class=lnt id=hl-11-118><a class=lnlinks href=#hl-11-118>118</a>
</span><span class=lnt id=hl-11-119><a class=lnlinks href=#hl-11-119>119</a>
</span><span class=lnt id=hl-11-120><a class=lnlinks href=#hl-11-120>120</a>
</span><span class=lnt id=hl-11-121><a class=lnlinks href=#hl-11-121>121</a>
</span><span class=lnt id=hl-11-122><a class=lnlinks href=#hl-11-122>122</a>
</span><span class=lnt id=hl-11-123><a class=lnlinks href=#hl-11-123>123</a>
</span><span class=lnt id=hl-11-124><a class=lnlinks href=#hl-11-124>124</a>
</span><span class=lnt id=hl-11-125><a class=lnlinks href=#hl-11-125>125</a>
</span><span class=lnt id=hl-11-126><a class=lnlinks href=#hl-11-126>126</a>
</span><span class=lnt id=hl-11-127><a class=lnlinks href=#hl-11-127>127</a>
</span><span class=lnt id=hl-11-128><a class=lnlinks href=#hl-11-128>128</a>
</span><span class=lnt id=hl-11-129><a class=lnlinks href=#hl-11-129>129</a>
</span><span class=lnt id=hl-11-130><a class=lnlinks href=#hl-11-130>130</a>
</span><span class=lnt id=hl-11-131><a class=lnlinks href=#hl-11-131>131</a>
</span><span class=lnt id=hl-11-132><a class=lnlinks href=#hl-11-132>132</a>
</span><span class=lnt id=hl-11-133><a class=lnlinks href=#hl-11-133>133</a>
</span><span class=lnt id=hl-11-134><a class=lnlinks href=#hl-11-134>134</a>
</span><span class=lnt id=hl-11-135><a class=lnlinks href=#hl-11-135>135</a>
</span><span class=lnt id=hl-11-136><a class=lnlinks href=#hl-11-136>136</a>
</span><span class=lnt id=hl-11-137><a class=lnlinks href=#hl-11-137>137</a>
</span><span class=lnt id=hl-11-138><a class=lnlinks href=#hl-11-138>138</a>
</span><span class=lnt id=hl-11-139><a class=lnlinks href=#hl-11-139>139</a>
</span><span class=lnt id=hl-11-140><a class=lnlinks href=#hl-11-140>140</a>
</span><span class=lnt id=hl-11-141><a class=lnlinks href=#hl-11-141>141</a>
</span><span class=lnt id=hl-11-142><a class=lnlinks href=#hl-11-142>142</a>
</span><span class=lnt id=hl-11-143><a class=lnlinks href=#hl-11-143>143</a>
</span><span class=lnt id=hl-11-144><a class=lnlinks href=#hl-11-144>144</a>
</span><span class=lnt id=hl-11-145><a class=lnlinks href=#hl-11-145>145</a>
</span><span class=lnt id=hl-11-146><a class=lnlinks href=#hl-11-146>146</a>
</span><span class=lnt id=hl-11-147><a class=lnlinks href=#hl-11-147>147</a>
</span><span class=lnt id=hl-11-148><a class=lnlinks href=#hl-11-148>148</a>
</span><span class=lnt id=hl-11-149><a class=lnlinks href=#hl-11-149>149</a>
</span><span class=lnt id=hl-11-150><a class=lnlinks href=#hl-11-150>150</a>
</span><span class=lnt id=hl-11-151><a class=lnlinks href=#hl-11-151>151</a>
</span><span class=lnt id=hl-11-152><a class=lnlinks href=#hl-11-152>152</a>
</span><span class=lnt id=hl-11-153><a class=lnlinks href=#hl-11-153>153</a>
</span><span class=lnt id=hl-11-154><a class=lnlinks href=#hl-11-154>154</a>
</span><span class=lnt id=hl-11-155><a class=lnlinks href=#hl-11-155>155</a>
</span><span class=lnt id=hl-11-156><a class=lnlinks href=#hl-11-156>156</a>
</span><span class=lnt id=hl-11-157><a class=lnlinks href=#hl-11-157>157</a>
</span><span class=lnt id=hl-11-158><a class=lnlinks href=#hl-11-158>158</a>
</span><span class=lnt id=hl-11-159><a class=lnlinks href=#hl-11-159>159</a>
</span><span class=lnt id=hl-11-160><a class=lnlinks href=#hl-11-160>160</a>
</span><span class=lnt id=hl-11-161><a class=lnlinks href=#hl-11-161>161</a>
</span><span class=lnt id=hl-11-162><a class=lnlinks href=#hl-11-162>162</a>
</span><span class=lnt id=hl-11-163><a class=lnlinks href=#hl-11-163>163</a>
</span><span class=lnt id=hl-11-164><a class=lnlinks href=#hl-11-164>164</a>
</span><span class=lnt id=hl-11-165><a class=lnlinks href=#hl-11-165>165</a>
</span><span class=lnt id=hl-11-166><a class=lnlinks href=#hl-11-166>166</a>
</span><span class=lnt id=hl-11-167><a class=lnlinks href=#hl-11-167>167</a>
</span><span class=lnt id=hl-11-168><a class=lnlinks href=#hl-11-168>168</a>
</span><span class=lnt id=hl-11-169><a class=lnlinks href=#hl-11-169>169</a>
</span><span class=lnt id=hl-11-170><a class=lnlinks href=#hl-11-170>170</a>
</span><span class=lnt id=hl-11-171><a class=lnlinks href=#hl-11-171>171</a>
</span><span class=lnt id=hl-11-172><a class=lnlinks href=#hl-11-172>172</a>
</span><span class=lnt id=hl-11-173><a class=lnlinks href=#hl-11-173>173</a>
</span><span class=lnt id=hl-11-174><a class=lnlinks href=#hl-11-174>174</a>
</span><span class=lnt id=hl-11-175><a class=lnlinks href=#hl-11-175>175</a>
</span><span class=lnt id=hl-11-176><a class=lnlinks href=#hl-11-176>176</a>
</span><span class=lnt id=hl-11-177><a class=lnlinks href=#hl-11-177>177</a>
</span><span class=lnt id=hl-11-178><a class=lnlinks href=#hl-11-178>178</a>
</span><span class=lnt id=hl-11-179><a class=lnlinks href=#hl-11-179>179</a>
</span><span class=lnt id=hl-11-180><a class=lnlinks href=#hl-11-180>180</a>
</span><span class=lnt id=hl-11-181><a class=lnlinks href=#hl-11-181>181</a>
</span><span class=lnt id=hl-11-182><a class=lnlinks href=#hl-11-182>182</a>
</span><span class=lnt id=hl-11-183><a class=lnlinks href=#hl-11-183>183</a>
</span><span class=lnt id=hl-11-184><a class=lnlinks href=#hl-11-184>184</a>
</span><span class=lnt id=hl-11-185><a class=lnlinks href=#hl-11-185>185</a>
</span><span class=lnt id=hl-11-186><a class=lnlinks href=#hl-11-186>186</a>
</span><span class=lnt id=hl-11-187><a class=lnlinks href=#hl-11-187>187</a>
</span><span class=lnt id=hl-11-188><a class=lnlinks href=#hl-11-188>188</a>
</span><span class=lnt id=hl-11-189><a class=lnlinks href=#hl-11-189>189</a>
</span><span class=lnt id=hl-11-190><a class=lnlinks href=#hl-11-190>190</a>
</span><span class=lnt id=hl-11-191><a class=lnlinks href=#hl-11-191>191</a>
</span><span class=lnt id=hl-11-192><a class=lnlinks href=#hl-11-192>192</a>
</span><span class=lnt id=hl-11-193><a class=lnlinks href=#hl-11-193>193</a>
</span><span class=lnt id=hl-11-194><a class=lnlinks href=#hl-11-194>194</a>
</span><span class=lnt id=hl-11-195><a class=lnlinks href=#hl-11-195>195</a>
</span><span class=lnt id=hl-11-196><a class=lnlinks href=#hl-11-196>196</a>
</span><span class=lnt id=hl-11-197><a class=lnlinks href=#hl-11-197>197</a>
</span><span class=lnt id=hl-11-198><a class=lnlinks href=#hl-11-198>198</a>
</span><span class=lnt id=hl-11-199><a class=lnlinks href=#hl-11-199>199</a>
</span><span class=lnt id=hl-11-200><a class=lnlinks href=#hl-11-200>200</a>
</span><span class=lnt id=hl-11-201><a class=lnlinks href=#hl-11-201>201</a>
</span><span class=lnt id=hl-11-202><a class=lnlinks href=#hl-11-202>202</a>
</span><span class=lnt id=hl-11-203><a class=lnlinks href=#hl-11-203>203</a>
</span><span class=lnt id=hl-11-204><a class=lnlinks href=#hl-11-204>204</a>
</span><span class=lnt id=hl-11-205><a class=lnlinks href=#hl-11-205>205</a>
</span><span class=lnt id=hl-11-206><a class=lnlinks href=#hl-11-206>206</a>
</span><span class=lnt id=hl-11-207><a class=lnlinks href=#hl-11-207>207</a>
</span><span class=lnt id=hl-11-208><a class=lnlinks href=#hl-11-208>208</a>
</span><span class=lnt id=hl-11-209><a class=lnlinks href=#hl-11-209>209</a>
</span><span class=lnt id=hl-11-210><a class=lnlinks href=#hl-11-210>210</a>
</span><span class=lnt id=hl-11-211><a class=lnlinks href=#hl-11-211>211</a>
</span><span class=lnt id=hl-11-212><a class=lnlinks href=#hl-11-212>212</a>
</span><span class=lnt id=hl-11-213><a class=lnlinks href=#hl-11-213>213</a>
</span><span class=lnt id=hl-11-214><a class=lnlinks href=#hl-11-214>214</a>
</span><span class=lnt id=hl-11-215><a class=lnlinks href=#hl-11-215>215</a>
</span><span class=lnt id=hl-11-216><a class=lnlinks href=#hl-11-216>216</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Event Producer - 사용자 행동 이벤트 발행</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaProducer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UserEventProducer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;사용자 행동 이벤트를 Kafka에 발행하는 프로듀서&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Kafka 프로듀서 초기화</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>bootstrap_servers</span><span class=o>=</span><span class=n>bootstrap_servers</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>value_serializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>v</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>v</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=c1># 높은 처리량을 위한 배치 설정</span>
</span></span><span class=line><span class=cl>            <span class=n>batch_size</span><span class=o>=</span><span class=mi>16384</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>linger_ms</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=c1># 데이터 안정성을 위한 ACK 설정</span>
</span></span><span class=line><span class=cl>            <span class=n>acks</span><span class=o>=</span><span class=s1>&#39;all&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>send_user_action</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>,</span> <span class=n>action_type</span><span class=p>,</span> <span class=n>product_id</span><span class=p>,</span> <span class=n>metadata</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;사용자 행동 이벤트 발행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>event</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;action_type&#39;</span><span class=p>:</span> <span class=n>action_type</span><span class=p>,</span>  <span class=c1># view, click, purchase</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;product_id&#39;</span><span class=p>:</span> <span class=n>product_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;metadata&#39;</span><span class=p>:</span> <span class=n>metadata</span> <span class=ow>or</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 사용자 ID를 키로 사용하여 파티션 분산</span>
</span></span><span class=line><span class=cl>        <span class=n>partition_key</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>topic</span><span class=o>=</span><span class=s1>&#39;user-actions&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>key</span><span class=o>=</span><span class=n>partition_key</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>value</span><span class=o>=</span><span class=n>event</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;이벤트 발행: </span><span class=si>{</span><span class=n>action_type</span><span class=si>}</span><span class=s2> by user </span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Event Consumer - 실시간 추천 처리</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaConsumer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>redis</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>RecommendationProcessor</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;실시간 추천 생성 및 업데이트 컨슈머&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Kafka 컨슈머 초기화</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user-actions&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>bootstrap_servers</span><span class=o>=</span><span class=n>bootstrap_servers</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>value_deserializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>            <span class=c1># 컨슈머 그룹 설정으로 병렬 처리</span>
</span></span><span class=line><span class=cl>            <span class=n>group_id</span><span class=o>=</span><span class=s1>&#39;recommendation-processor&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=c1># 가장 빠른 처리를 위한 오프셋 설정</span>
</span></span><span class=line><span class=cl>            <span class=n>auto_offset_reset</span><span class=o>=</span><span class=s1>&#39;latest&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Redis 연결 (추천 결과 캐싱)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>redis_client</span> <span class=o>=</span> <span class=n>redis</span><span class=o>.</span><span class=n>Redis</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>host</span><span class=o>=</span><span class=s1>&#39;localhost&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>port</span><span class=o>=</span><span class=mi>6379</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>decode_responses</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_events</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;이벤트 스트림을 지속적으로 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;실시간 추천 처리 시작…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>message</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>event</span> <span class=o>=</span> <span class=n>message</span><span class=o>.</span><span class=n>value</span>
</span></span><span class=line><span class=cl>            <span class=n>user_id</span> <span class=o>=</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>action_type</span> <span class=o>=</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;action_type&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>product_id</span> <span class=o>=</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 사용자 행동 패턴 업데이트</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_update_user_profile</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=n>action_type</span><span class=p>,</span> <span class=n>product_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 실시간 추천 생성</span>
</span></span><span class=line><span class=cl>            <span class=n>recommendations</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_generate_recommendations</span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Redis에 추천 결과 캐싱</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_cache_recommendations</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=n>recommendations</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;사용자 </span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>에 대한 추천 업데이트 완료&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_update_user_profile</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>,</span> <span class=n>action_type</span><span class=p>,</span> <span class=n>product_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;사용자 프로필 업데이트 (행동 패턴 학습)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>profile_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;user_profile:</span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 행동 가중치 적용</span>
</span></span><span class=line><span class=cl>        <span class=n>weights</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;view&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;click&#39;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;purchase&#39;</span><span class=p>:</span> <span class=mi>10</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>weight</span> <span class=o>=</span> <span class=n>weights</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>action_type</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Redis에서 사용자 프로필 조회 및 업데이트</span>
</span></span><span class=line><span class=cl>        <span class=n>current_score</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>redis_client</span><span class=o>.</span><span class=n>hget</span><span class=p>(</span><span class=n>profile_key</span><span class=p>,</span> <span class=n>product_id</span><span class=p>)</span> <span class=ow>or</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>new_score</span> <span class=o>=</span> <span class=n>current_score</span> <span class=o>+</span> <span class=n>weight</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>redis_client</span><span class=o>.</span><span class=n>hset</span><span class=p>(</span><span class=n>profile_key</span><span class=p>,</span> <span class=n>product_id</span><span class=p>,</span> <span class=n>new_score</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>redis_client</span><span class=o>.</span><span class=n>expire</span><span class=p>(</span><span class=n>profile_key</span><span class=p>,</span> <span class=mi>86400</span><span class=p>)</span>  <span class=c1># 24시간 TTL</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_generate_recommendations</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;협업 필터링 기반 실시간 추천 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>profile_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;user_profile:</span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>user_preferences</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>redis_client</span><span class=o>.</span><span class=n>hgetall</span><span class=p>(</span><span class=n>profile_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 간단한 협업 필터링 알고리즘</span>
</span></span><span class=line><span class=cl>        <span class=n>recommendations</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user_preferences</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 선호도가 높은 상품 카테고리 추출</span>
</span></span><span class=line><span class=cl>            <span class=n>top_products</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>user_preferences</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl>            <span class=p>)[:</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 유사한 상품 추천 (실제로는 ML 모델 사용)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>product_id</span><span class=p>,</span> <span class=n>score</span> <span class=ow>in</span> <span class=n>top_products</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>similar_products</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_find_similar_products</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>recommendations</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>similar_products</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>list</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>recommendations</span><span class=p>))[:</span><span class=mi>10</span><span class=p>]</span>  <span class=c1># 중복 제거 후 상위 10개</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_find_similar_products</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>product_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;유사 상품 찾기 (Mock 구현)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 실제로는 Vector DB나 ML 모델 사용</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&#34;sim_</span><span class=si>{</span><span class=n>product_id</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_cache_recommendations</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>,</span> <span class=n>recommendations</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;추천 결과를 Redis에 캐싱&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>cache_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;recommendations:</span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>redis_client</span><span class=o>.</span><span class=n>setex</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>cache_key</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=mi>3600</span><span class=p>,</span>  <span class=c1># 1시간 TTL</span>
</span></span><span class=line><span class=cl>            <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>recommendations</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Event Stream Processing - Kafka Streams 스타일의 처리</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>EventStreamProcessor</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;이벤트 스트림 실시간 집계 및 분석&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>redis_client</span> <span class=o>=</span> <span class=n>redis</span><span class=o>.</span><span class=n>Redis</span><span class=p>(</span><span class=n>decode_responses</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 윈도우 기반 집계를 위한 메모리 저장소</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>window_data</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_windowed_aggregation</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>events</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;시간 윈도우 기반 이벤트 집계&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>current_time</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>window_size</span> <span class=o>=</span> <span class=mi>300</span>  <span class=c1># 5분 윈도우</span>
</span></span><span class=line><span class=cl>        <span class=n>window_key</span> <span class=o>=</span> <span class=n>current_time</span> <span class=o>//</span> <span class=n>window_size</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>event</span> <span class=ow>in</span> <span class=n>events</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>product_id</span> <span class=o>=</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>action_type</span> <span class=o>=</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;action_type&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 윈도우별 상품 인기도 집계</span>
</span></span><span class=line><span class=cl>            <span class=n>metrics_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;metrics:</span><span class=si>{</span><span class=n>window_key</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>field_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>product_id</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>action_type</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>redis_client</span><span class=o>.</span><span class=n>hincrby</span><span class=p>(</span><span class=n>metrics_key</span><span class=p>,</span> <span class=n>field_key</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>redis_client</span><span class=o>.</span><span class=n>expire</span><span class=p>(</span><span class=n>metrics_key</span><span class=p>,</span> <span class=mi>3600</span><span class=p>)</span>  <span class=c1># 1시간 보관</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 실시간 트렌딩 상품 업데이트</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_update_trending_products</span><span class=p>(</span><span class=n>window_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_update_trending_products</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>window_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;트렌딩 상품 목록 업데이트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;metrics:</span><span class=si>{</span><span class=n>window_key</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>redis_client</span><span class=o>.</span><span class=n>hgetall</span><span class=p>(</span><span class=n>metrics_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 상품별 종합 점수 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>product_scores</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>field</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>metrics</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>product_id</span><span class=p>,</span> <span class=n>action_type</span> <span class=o>=</span> <span class=n>field</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>weight</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;view&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;click&#39;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;purchase&#39;</span><span class=p>:</span> <span class=mi>10</span><span class=p>}[</span><span class=n>action_type</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>product_id</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>product_scores</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>product_scores</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=n>product_scores</span><span class=p>[</span><span class=n>product_id</span><span class=p>]</span> <span class=o>+=</span> <span class=nb>int</span><span class=p>(</span><span class=n>count</span><span class=p>)</span> <span class=o>*</span> <span class=n>weight</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 상위 트렌딩 상품 저장</span>
</span></span><span class=line><span class=cl>        <span class=n>trending</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>product_scores</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=p>)[:</span><span class=mi>20</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>redis_client</span><span class=o>.</span><span class=n>setex</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;trending_products&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=mi>1800</span><span class=p>,</span>  <span class=c1># 30분 TTL</span>
</span></span><span class=line><span class=cl>            <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>([</span><span class=n>product_id</span> <span class=k>for</span> <span class=n>product_id</span><span class=p>,</span> <span class=n>_</span> <span class=ow>in</span> <span class=n>trending</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 프로듀서로 이벤트 발행</span>
</span></span><span class=line><span class=cl>    <span class=n>producer</span> <span class=o>=</span> <span class=n>UserEventProducer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>producer</span><span class=o>.</span><span class=n>send_user_action</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>user_id</span><span class=o>=</span><span class=mi>12345</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>action_type</span><span class=o>=</span><span class=s1>&#39;click&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>product_id</span><span class=o>=</span><span class=s1>&#39;product_001&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>metadata</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;category&#39;</span><span class=p>:</span> <span class=s1>&#39;electronics&#39;</span><span class=p>,</span> <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=mf>299.99</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 컨슈머로 실시간 처리</span>
</span></span><span class=line><span class=cl>    <span class=n>processor</span> <span class=o>=</span> <span class=n>RecommendationProcessor</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>processor</span><span class=o>.</span><span class=n>process_events</span><span class=p>()</span>  <span class=c1># 무한 루프로 이벤트 처리</span>
</span></span></code></pre></td></tr></table></div></div><p>이 구현 예시는 Event Broker 의 핵심 기능인 <strong>높은 처리량</strong>, <strong>실시간 스트리밍</strong>, <strong>파티션 기반 확장성</strong>을 활용하여 실시간 추천 시스템을 구축하는 방법을 보여준다.</p><h3 id=주목할-내용>주목할 내용<a hidden class=anchor aria-hidden=true href=#주목할-내용>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>항목</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td>아키텍처 패턴</td><td>Event-Driven Architecture (EDA)</td><td>비동기 이벤트 기반 시스템 구조. 서비스 간 느슨한 결합을 통해 확장성과 유연성 제공</td></tr><tr><td></td><td>Event Sourcing</td><td>상태 변경을 이벤트 로그로 저장, 복원 및 감사 가능</td></tr><tr><td></td><td>CQRS (Command Query Responsibility Segregation)</td><td>읽기/쓰기 분리로 성능 최적화 및 이벤트 소싱과 결합 가능</td></tr><tr><td></td><td>Event Mesh</td><td>다수의 브로커를 연결한 글로벌 이벤트 라우팅 인프라 구조</td></tr><tr><td></td><td>Partitioning</td><td>파티션 기반 데이터 분산 처리 구조. Kafka 등에서 병렬성과 확장성 확보에 필수</td></tr><tr><td></td><td>Consumer Groups</td><td>동일 토픽을 병렬로 처리하는 컨슈머 그룹. 메시지 병렬 처리에 활용</td></tr><tr><td>메시징 패턴</td><td>Pub/Sub</td><td>발행자와 구독자 간의 메시지 흐름. 다수의 구독자가 동일 이벤트 수신 가능</td></tr><tr><td></td><td>Queue</td><td>FIFO 메시지 저장 구조. 하나의 소비자가 하나의 메시지를 소비</td></tr><tr><td></td><td>Fan-out</td><td>하나의 이벤트를 다수의 소비자에게 전파하는 패턴</td></tr><tr><td></td><td>Streaming</td><td>실시간 연속 데이터 처리. Kafka, Pulsar 등에서 핵심 모델</td></tr><tr><td>성능 최적화</td><td>Record Batching</td><td>다수의 메시지를 묶어서 처리하여 처리량 향상</td></tr><tr><td></td><td>Zero-Copy</td><td>메모리 복사 없이 네트워크 전송으로 지연 감소 및 CPU 사용 절감</td></tr><tr><td></td><td>Batch Processing</td><td>묶음 단위 처리로 Throughput 개선. Kafka Connect, ETL 등에서 사용</td></tr><tr><td></td><td>Horizontal Scaling (파티션 기반)</td><td>메시지 브로커의 수평 확장을 위한 기반 구조. Kafka, Pulsar 등에서 핵심 전략</td></tr><tr><td>안정성 및 복원력</td><td>Circuit Breaker</td><td>장애 발생 시 호출 중단하여 시스템 전체 장애 확산 방지</td></tr><tr><td></td><td>Replication</td><td>메시지 복제를 통해 브로커 장애 발생 시 데이터 손실 방지</td></tr><tr><td></td><td>DLQ (Dead Letter Queue)</td><td>처리 실패 메시지 격리 저장소. 재처리 및 장애 분석용</td></tr><tr><td></td><td>At-most / At-least / Exactly-once</td><td>메시지 전송 보장 수준. 시스템 요구사항에 따라 선택</td></tr><tr><td>운영 자동화</td><td>Kafka on Kubernetes</td><td>자동 확장, 복구, 모니터링이 가능한 Kafka 배포 방식</td></tr><tr><td></td><td>Broker Auto-scaling</td><td>메시지 트래픽 기반으로 브로커/컨슈머 수 자동 조절</td></tr><tr><td></td><td>EventBridge + Lambda</td><td>서버리스 환경에서 이벤트 기반 자동 트리거 처리</td></tr><tr><td></td><td>AI 기반 튜닝</td><td>이상 탐지 및 성능 최적화를 위한 AI 기반 예측 운영 기능</td></tr><tr><td>추적 및 가시성</td><td>Distributed Tracing</td><td>Zipkin, Jaeger 등. 이벤트 흐름을 추적하여 장애 원인 분석</td></tr><tr><td></td><td>Consumer Lag</td><td>소비자가 브로커에서 메시지를 늦게 처리하는 정도. 병목 탐지 지표</td></tr><tr><td></td><td>Monitoring Metrics</td><td>큐 깊이, 처리율, 에러율, DLQ 발생률 등 실시간 모니터링 대상 지표</td></tr><tr><td>표준 및 보안</td><td>AsyncAPI</td><td>메시지 기반 API 정의 표준. 이벤트 명세 및 문서화를 지원</td></tr><tr><td></td><td>Schema Registry</td><td>메시지 포맷을 통합 관리하여 생산자 - 소비자 간 계약 유지</td></tr><tr><td></td><td>Avro / Protobuf / JSON</td><td>메시지 인코딩/압축 포맷. 효율성과 호환성에 따라 선택</td></tr><tr><td></td><td>End-to-End Encryption</td><td>메시지 발행부터 소비까지 암호화 적용</td></tr><tr><td></td><td>SASL / JAAS</td><td>인증/인가를 위한 보안 프로토콜 프레임워크</td></tr></tbody></table><ul><li><strong>아키텍처 측면</strong>에서는 Event Sourcing, Mesh, Partitioning 등 확장성과 복원력 확보를 위한 전략이 핵심</li><li><strong>성능 최적화</strong>는 메시지 처리량, 처리 속도, 리소스 효율화를 위한 기술 (Batching, Zero-Copy 등) 중심</li><li><strong>운영 자동화</strong>는 쿠버네티스, 서버리스, AI 기반 운영 최적화로 발전 중</li><li><strong>보안/표준</strong>은 AsyncAPI, Schema Registry, QoS 모델 등 일관성과 신뢰성 확보에 집중</li></ul><h3 id=반드시-학습해야-할-내용>반드시 학습해야 할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야-할-내용>#</a></h3><table><thead><tr><th>대분류</th><th>핵심 학습 주제</th><th>설명</th></tr></thead><tbody><tr><td><strong>1. 아키텍처 패턴</strong></td><td>이벤트 소싱 및 CQRS</td><td>상태 변경을 이벤트로 저장하고 명령/쿼리를 분리하여 일관성과 추적성을 보장</td></tr><tr><td></td><td>이벤트 기반 마이크로서비스</td><td>이벤트 브로커 중심의 느슨한 결합형 마이크로서비스 설계</td></tr><tr><td></td><td>Event Mesh</td><td>브로커 간 연합 구조로 글로벌 메시지 흐름 구성</td></tr><tr><td></td><td>클라우드 네이티브 이벤트 시스템</td><td>SNS/SQS, EventBridge 기반 서버리스 이벤트 아키텍처 설계</td></tr><tr><td><strong>2. 메시징 패턴</strong></td><td>Pub/Sub, Queue, Fanout</td><td>다양한 메시지 전달 구조의 비교 및 활용 전략</td></tr><tr><td></td><td>QoS 보장 전략</td><td>At-most-once, At-least-once, Exactly-once 의미와 적용</td></tr><tr><td></td><td>멱등성 설계</td><td>중복 메시지를 안전하게 처리하기 위한 수신자 로직 설계</td></tr><tr><td></td><td>장애 복구 및 DLQ 설계</td><td>실패 메시지 대응을 위한 Dead Letter Queue 및 재처리 전략</td></tr><tr><td><strong>3. 브로커 아키텍처</strong></td><td>Kafka, RabbitMQ 구조 분석</td><td>내부 파티션, 오프셋, ACK 메커니즘 등 브로커 동작 원리</td></tr><tr><td></td><td>중앙형 vs 분산형 아키텍처</td><td>고가용성/확장성 요구에 따른 브로커 구조 선택 기준</td></tr><tr><td></td><td>브로커 선택 기준</td><td>성능, 신뢰성, 실시간성 요구사항에 따른 브로커 비교</td></tr><tr><td><strong>4. 운영 및 성능</strong></td><td>Kafka 모니터링 및 성능 튜닝</td><td>Prometheus, Grafana, 컨슈머 lag, throughput 등 핵심 지표 분석</td></tr><tr><td></td><td>파티셔닝 및 배치 전략</td><td>메시지 분산 및 처리량 최적화를 위한 설계 기법</td></tr><tr><td></td><td>데이터 흐름 제어 (Flow Control)</td><td>브로커 ↔ 컨슈머 간 처리 속도 불균형 대응 (backpressure 포함)</td></tr><tr><td></td><td>메시지 재처리 및 재생 (Replay)</td><td>장애 복구, 감사용으로 메시지를 재처리할 수 있는 기능</td></tr><tr><td><strong>5. 데이터 및 스키마</strong></td><td>이벤트 스키마 설계 및 진화</td><td>Avro, Protobuf 기반 스키마 정의 및 버전 관리 전략</td></tr><tr><td></td><td>스키마 레지스트리 및 관리</td><td>중앙 스키마 저장소를 통한 소비자/생산자 간 호환성 보장</td></tr><tr><td><strong>6. 보안 및 규정 준수</strong></td><td>MQ 인증 및 접근 제어</td><td>TLS, SASL, RBAC 등으로 전송 및 접근 보호</td></tr><tr><td></td><td>메시징 시스템 감사 및 규정 대응</td><td>GDPR, ISO 27001 등에 부합하는 감사 추적 및 스키마 검증 구조</td></tr><tr><td><strong>7. 통합 및 테스트</strong></td><td>메시징 통합 테스트 전략</td><td>시스템 간 메시지 흐름 테스트 및 자동화 구성</td></tr><tr><td></td><td>메시지 트레이싱 및 디버깅</td><td>OpenTelemetry, Jaeger 등으로 전체 흐름 추적</td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th><strong>카테고리</strong></th><th><strong>용어</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>기본 개념</strong></td><td>Broker (브로커)</td><td>메시지 또는 이벤트를 중개하는 미들웨어. 메시지 브로커, 이벤트 브로커 모두 포함됨</td></tr><tr><td></td><td>Pub/Sub</td><td>발행자 (Publisher) 가 메시지를 발행하고, 구독자 (Subscriber) 가 이를 구독하는 비동기 메시징 패턴</td></tr><tr><td></td><td>Queue (큐)</td><td>메시지를 FIFO 순서로 저장하고, 소비자가 하나씩 꺼내 처리하는 구조</td></tr><tr><td></td><td>Topic (토픽)</td><td>이벤트를 분류하여 발행하는 논리적 채널로, 여러 소비자가 동시에 구독할 수 있음</td></tr><tr><td></td><td>Command</td><td>수신자에게 특정 작업을 요청하는 메시지 유형 (주로 메시지 브로커에서 사용)</td></tr><tr><td></td><td>Event</td><td>시스템에서 발생한 상태 변화로, 처리된 후 다른 서비스에 전달되는 메시지 (주로 이벤트 브로커에서 사용)</td></tr><tr><td><strong>구성 요소 및 구조</strong></td><td>Producer (프로듀서)</td><td>메시지 또는 이벤트를 브로커에 발행하는 주체</td></tr><tr><td></td><td>Consumer (컨슈머)</td><td>브로커에서 메시지를 수신하여 처리하는 주체</td></tr><tr><td></td><td>Consumer Group</td><td>Kafka 등에서 동일한 토픽을 병렬 소비하는 컨슈머들의 논리적 집합</td></tr><tr><td></td><td>Partition (파티션)</td><td>Kafka 등에서 메시지를 물리적으로 분산 저장 및 병렬 처리하기 위한 단위</td></tr><tr><td></td><td>Offset (오프셋)</td><td>파티션 내 메시지의 순서 위치를 나타내는 식별자</td></tr><tr><td></td><td>Exchange (교환기)</td><td>RabbitMQ 등에서 메시지를 큐로 라우팅하는 구성 요소 (Direct, Fanout 등 유형 존재)</td></tr><tr><td></td><td>Binding</td><td>Exchange 와 Queue 를 연결하는 라우팅 조건</td></tr><tr><td></td><td>Routing Key</td><td>메시지를 특정 Queue 로 전달하기 위해 사용하는 라우팅 기준</td></tr><tr><td><strong>운영 및 보장</strong></td><td>ACK (Acknowledgment)</td><td>메시지가 정상적으로 처리되었음을 브로커에 알리는 확인 신호</td></tr><tr><td></td><td>DLQ (Dead Letter Queue)</td><td>처리 실패한 메시지를 보관하는 특수 큐로, 재처리나 장애 분석에 사용</td></tr><tr><td></td><td>TTL (Time-To-Live)</td><td>메시지가 큐에 보관될 수 있는 최대 시간. 초과 시 자동 삭제됨</td></tr><tr><td></td><td>Idempotency (멱등성)</td><td>동일한 메시지가 여러 번 처리되어도 결과가 변하지 않는 성질</td></tr><tr><td></td><td>QoS (Quality of Service)</td><td>메시지 전달 보장 수준: at-most-once, at-least-once, exactly-once 등</td></tr><tr><td></td><td>Backpressure (백프레셔)</td><td>생산자와 소비자 간 처리 속도 차이로 인한 과부하를 제어하는 흐름 제어 메커니즘</td></tr><tr><td></td><td>Consumer Lag</td><td>브로커에 쌓인 메시지와 소비자가 소비한 메시지의 간격. 시스템 병목 또는 지연 지표로 사용됨</td></tr><tr><td><strong>스키마 및 표준</strong></td><td>Schema Registry</td><td>메시지 또는 이벤트의 구조를 정의하고 관리하는 중앙 저장소. Avro, Protobuf 등과 연동됨</td></tr><tr><td></td><td>Event Schema</td><td>이벤트 메시지의 구조와 필드를 정의한 명세로, 생산자 - 소비자 간의 계약 역할을 수행</td></tr><tr><td></td><td>AsyncAPI</td><td>메시지 기반 API 정의를 위한 명세 포맷. OpenAPI 의 메시징 확장판</td></tr><tr><td><strong>고급 구조 및 기타</strong></td><td>Event Mesh</td><td>여러 이벤트 브로커가 연결된 네트워크 구조로, 글로벌 이벤트 전파 및 라우팅을 지원</td></tr><tr><td></td><td>Federation (페더레이션)</td><td>다수 브로커 인스턴스를 하나의 논리 브로커처럼 연결하여 메시지를 교환하는 기법</td></tr><tr><td></td><td>Hydra Effect</td><td>분산 시스템에서 하나의 장애가 연쇄적으로 다른 구성 요소에 영향을 미치는 현상</td></tr><tr><td></td><td>AMQP</td><td>Advanced Message Queuing Protocol. RabbitMQ 등에서 사용하는 표준 메시징 프로토콜</td></tr><tr><td></td><td>MQTT</td><td>IoT 환경에 최적화된 경량 메시징 프로토콜. 트래픽/리소스 제한 환경에서 사용</td></tr><tr><td></td><td>Auto-Scaling</td><td>메시지 큐 또는 이벤트 트래픽 증가에 따라 컨슈머 인스턴스를 자동으로 확장/축소하는 기능</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://kafka.apache.org/>Apache Kafka 공식 문서</a></li><li><a href=https://www.rabbitmq.com/tutorials/tutorial-one-python.html>RabbitMQ 아키텍처 설명</a></li><li><a href=https://aws.amazon.com/messaging/>AWS Messaging 서비스 소개</a></li><li><a href=https://www.confluent.io/what-is-apache-kafka/>Confluent Kafka 설명 문서</a></li><li><a href=https://www.asyncapi.com/>AsyncAPI 공식 사이트</a></li><li><a href=https://www.ibm.com/think/topics/message-brokers>IBM Message Broker 개념</a></li><li><a href=https://solace.com/what-is-an-event-broker/>Solace Event Broker 설명</a></li><li><a href=https://www.koyeb.com/blog/rabbitmq-vs-apache-kafka-comparing-message-brokers-and-modern-event-streaming-platforms>RabbitMQ vs Kafka 비교</a></li><li><a href=https://learn.microsoft.com/en-us/azure/architecture/example-scenario/integration/queues-events>Azure 메시지 브로커 아키텍처</a></li><li><a href=https://www.nucamp.co/blog/coding-bootcamp-backend-with-python-2025-eventdriven-architectures-how-backend-systems-are-changing-in-2025>EDA와 메시지 브로커 실무 동향</a></li><li><a href=https://hevodata.com/learn/message-brokers/>Message Broker Best Practices</a></li><li><a href=https://pmarketresearch.com/product/worldwide-real-time-data-streaming-tool-market-research-2024-by-type-application-participants-and-countries-forecast-to-2030/worldwide-message-broker-platform-market-research-2024-by-type-application-participants-and-countries-forecast-to-2030>2025년 메시지 브로커 시장 동향</a></li><li><a href=https://estuary.dev/blog/event-driven-architecture-examples/>Event-Driven Architecture 실무 적용 사례</a></li><li><a href=https://www.gartner.com/reviews/market/event-brokers>Event Broker 기능 및 비교 (Gartner)</a></li><li><a href=https://dev.to/oleg_potapov/message-brokers-queue-based-vs-log-based-2f21>Queue‑based vs Log‑based 메시지 브로커 비교</a></li><li><a href=https://nordicapis.com/whats-the-difference-between-event-brokers-and-message-queues/>예시: 이벤트 브로커와 메시지 브로커 비교 해설</a></li><li><a href=https://www.upsolver.com/blog/comparing-message-brokers-and-event-processing-tools>Upsolver: Message Brokers vs Event Processing Tools 비교</a></li><li><a href=https://www.3pillarglobal.com/insights/blog/event-driven-architecture-topologies-broker-and-mediator/>교재: Event‑Driven Architecture 실무 Topology</a></li><li><a href=https://www.oreilly.com/library/view/software-architecture-patterns/9781491971437/ch01.html>O’Reilly: Software Architecture Patterns – 첫 챕터 (EDA vs 메시지 드리븐)</a></li><li><a href=https://medium.com/riskified-technology/message-broker-vs-event-broker-when-to-use-each-one-of-them-15597320a8ba>Riskified Tech: Message Broker vs Event Broker 사용 가이드</a></li><li><a href=https://www.geeksforgeeks.org/event-driven-architecture-system-design/>GeeksforGeeks: Event‑Driven Architecture 시스템 설계</a></li><li><a href=https://www.confluent.io/blog/what-is-an-event-driven-architecture/>Confluent: What is Event‑Driven Architecture?</a></li><li><a href=https://www.redhat.com/en/topics/integration/what-is-a-message-broker>RedHat: What is a Message Broker?</a></li><li><a href=https://aws.amazon.com/eventbridge/>AWS: EventBridge 공식 문서</a></li><li><a href=https://learn.microsoft.com/en-us/azure/event-grid/compare-messaging-services>Azure Event Grid 비교 가이드</a></li><li><a href=https://cloud.google.com/eventarc/docs/overview>Google Cloud Eventarc Overview</a></li><li><a href=https://www.xenonstack.com/insights/event-broker-vs-message-broker>XenonStack: Event Broker vs Message Broker 분석</a></li><li><a href=https://www.cloudamqp.com/docs/usecases.html>CloudAMQP: Message Broker 실제 사용 사례</a></li><li><a href=https://www.koyeb.com/blog/rabbitmq-vs-kafka-comparison>Koyeb: Kafka vs RabbitMQ 비교</a></li><li><a href=https://www.confluent.io/what-is-a-message-broker/>Confluent: What is a Message Broker?</a></li></ul><hr></div><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Event Broker</h2></header><div class=entry-content><p>Event Broker 이벤트 브로커는 이벤트 기반 아키텍처에서 이벤트 발행자 (Producer) 와 구독자 (Consumer) 사이의 이벤트 메시지 흐름을 중개하는 미들웨어이다.
분산 마이크로서비스 환경에서 데이터 흐름의 실시간성, 비동기성, 확장성을 확보할 수 있도록 지원한다. 대용량 실시간 데이터 처리와 시스템 간의 결합도 감소, 장애 격리 및 이벤트 아카이빙 등 다양한 장점으로 인해 오늘날 IT 인프라에서 매우 중요한 역할을 차지한다.
이벤트 브로커는 Pub/Sub, 스트리밍, 다양한 QoS, 보안, 트랜잭션, 확장성, 장애 복구 등 다양한 기능을 제공하며, 시스템 간 결합도를 낮추고, 실시간 데이터 분배와 비동기 처리를 지원한다.
...</p></div><footer class=entry-footer><span title='2025-07-18 05:58:00 +0000 UTC'>July 18, 2025</span>&nbsp;·&nbsp;38 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Event Broker" href=https://buenhyden.github.io/posts/networking--protocols/communication-patterns/message-infrastructure/message-brokers-vs-event-brokers/event-broker/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Message Broker</h2></header><div class=entry-content><p>Message Broker 메시지 브로커는 다양한 애플리케이션, 서비스, 시스템 간 메시지 교환을 중개하는 미들웨어로, 비동기 통신, 결합도 감소, 확장성, 신뢰성, 장애 복원력 등 백엔드 시스템에 필수적인 역할을 한다. 메시지 큐 (Queue), 토픽 (Topic), 교환기 (Exchange) 등 다양한 구조를 통해 Point-to-Point, Publish/Subscribe 등 다양한 패턴을 지원하며, RabbitMQ, Kafka, ActiveMQ, Amazon SQS 등 다양한 솔루션이 존재한다. 메시지 브로커는 마이크로서비스, IoT, 실시간 데이터 처리, 대용량 트래픽 분산 등 다양한 분야에서 활용된다.
Source: https://ademcatamak.medium.com/what-is-message-broker-4f6698c73089
...</p></div><footer class=entry-footer><span title='2025-07-18 05:58:00 +0000 UTC'>July 18, 2025</span>&nbsp;·&nbsp;39 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Message Broker" href=https://buenhyden.github.io/posts/networking--protocols/communication-patterns/message-infrastructure/message-brokers-vs-event-brokers/message-broker/></a></article></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>