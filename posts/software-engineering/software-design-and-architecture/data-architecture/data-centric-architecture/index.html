<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Data-Centric Architecture | hyunyoun's Blog</title><meta name=keywords content="Software-Engineering,Design-and-Architecture,Architecture-Styles,Data-Centric-Architecture,Database-Centered-Design"><meta name=description content="Data-Centric Architecture 는 데이터가 시스템 설계와 운영의 중심에 위치하는 아키텍처 스타일로, 데이터의 일관성, 접근성, 관리 효율성을 극대화하여 데이터 기반 의사결정과 신속한 서비스 제공을 지원한다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/software-engineering/software-design-and-architecture/data-architecture/data-centric-architecture/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/software-engineering/software-design-and-architecture/data-architecture/data-centric-architecture/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/software-engineering/software-design-and-architecture/data-architecture/data-centric-architecture/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/software-engineering/software-design-and-architecture/data-architecture/data-centric-architecture/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Data-Centric Architecture"><meta property="og:description" content="Data-Centric Architecture 는 데이터가 시스템 설계와 운영의 중심에 위치하는 아키텍처 스타일로, 데이터의 일관성, 접근성, 관리 효율성을 극대화하여 데이터 기반 의사결정과 신속한 서비스 제공을 지원한다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Data-Centric Architecture"><meta name=twitter:description content="Data-Centric Architecture 는 데이터가 시스템 설계와 운영의 중심에 위치하는 아키텍처 스타일로, 데이터의 일관성, 접근성, 관리 효율성을 극대화하여 데이터 기반 의사결정과 신속한 서비스 제공을 지원한다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Data-Centric Architecture","item":"https://buenhyden.github.io/posts/software-engineering/software-design-and-architecture/data-architecture/data-centric-architecture/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a></div><h1>Data-Centric Architecture</h1><div class=post-description>Data-Centric Architecture 는 데이터가 시스템 설계와 운영의 중심에 위치하는 아키텍처 스타일로, 데이터의 일관성, 접근성, 관리 효율성을 극대화하여 데이터 기반 의사결정과 신속한 서비스 제공을 지원한다.</div></header><div class=post-content><h2 id=data-centric-architecture>Data-Centric Architecture<a hidden class=anchor aria-hidden=true href=#data-centric-architecture>#</a></h2><p>데이터 중심 아키텍처는 비즈니스 도메인의 중심에 <strong>데이터</strong>를 두고 시스템을 정렬하는 설계 스타일이다. 핵심 구성 요소는 단일화된 스키마, 데이터 저장소, 이벤트 스트림, 데이터 액세스 계층이며, 이를 통해 데이터 무결성과 비즈니스 유연성을 확보한다. 마이크로서비스, ETL/ELT, 메시지 큐, 이벤트 소싱 등과 연계되어 데이터 일관성과 확장성을 유지하며 중앙 집중/분산 모델 모두에 적용 가능하다. 주요 장점은 통합된 데이터 모델, 쉬운 변화 대응, 데이터 배포 가시성이며, 단점은 복잡한 데이터 관리, 성능 병목 및 운영 부담이다. 적절한 커버리지, 거버넌스, 관찰성 도구 덕분에 실무 적용이 수월하다.</p><h3 id=배경>배경<a hidden class=anchor aria-hidden=true href=#배경>#</a></h3><ul><li><strong>데이터 폭증 및 분석 수요 증가</strong>: 빅데이터, IoT, AI 시대에 데이터는 핵심 자산이 되었으며, 데이터 주도 의사결정이 중요해졌다.</li><li><strong>마이크로서비스 등장</strong>: 서비스마다 데이터 구조와 저장소가 달라지며 데이터 일관성과 중복 문제가 발생했다.</li><li><strong>데이터 통합과 레이크 요구</strong>: 여러 서비스와 시스템 간의 데이터 통합이 필요해짐.</li><li><strong>ETL/ELT 및 이벤트 스트리밍 기술의 발전</strong>: Kafka, Pulsar, Airflow 등 도구의 성장으로 데이터 파이프라인 구성과 운영이 실용화됐다.</li></ul><h3 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h3><ul><li><strong>데이터 일관성 유지</strong>: 중앙 집중형 스키마로 전체 애플리케이션의 데이터 구조를 일관되게 관리.</li><li><strong>변화에 유연한 설계</strong>: 스키마 기준 기반으로 호환성과 버전 관리를 체계적으로 수행.</li><li><strong>재사용 가능성 확대</strong>: 데이터 모델이 정의되어 있으면 여러 애플리케이션에서 중복 없이 활용 가능.</li><li><strong>확장성과 데이터 분석 강화</strong>: 데이터 레이크와 스트림 기반 아키텍처로 확장을 수월하게 함.</li><li><strong>비즈니스 중심성 강조</strong>: 데이터 중심 설계를 통해 비즈니스 로직이 아닌 데이터에 초점을 맞춤.</li></ul><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><p><strong>데이터 중심 아키텍처 (Data-Centric Architecture)</strong> 는 데이터가 시스템의 중심에 위치하며, 애플리케이션, 서비스, 로직 등은 데이터와의 상호작용에 기반해 설계되는 아키텍처 스타일이다.</p><h4 id=기본-개념>기본 개념<a hidden class=anchor aria-hidden=true href=#기본-개념>#</a></h4><ol><li><p><strong>데이터 우선주의 (Data Primacy)</strong></p><ul><li>데이터를 시스템의 핵심 자산으로 인식</li><li>애플리케이션보다 데이터의 생명주기가 더 길다는 관점</li><li>데이터 모델이 애플리케이션 구현에 선행</li></ul></li><li><p><strong>단일 진실 원천 (Single Source of Truth, SSOT)</strong></p><ul><li>모든 데이터에 대한 신뢰할 수 있는 단일 참조점 제공</li><li>데이터 중복과 불일치 문제 해결</li><li>데이터 무결성과 일관성 보장</li></ul></li><li><p><strong>공유 데이터 모델 (Shared Data Model)</strong></p><ul><li>조직 전체에서 사용하는 표준화된 데이터 구조</li><li>의미론적 일관성을 통한 상호 운용성 확보</li><li>엔터프라이즈 온톨로지 (Enterprise Ontology) 기반</li></ul></li><li><p><strong>애플리케이션 독립성 (Application Independence)</strong></p><ul><li>데이터가 특정 애플리케이션에 종속되지 않음</li><li>새로운 애플리케이션 개발 시 기존 데이터 재활용 가능</li><li>시스템 간 느슨한 결합 (Loose Coupling) 실현</li></ul></li></ol><h4 id=실무-연관성-분석>실무 연관성 분석<a hidden class=anchor aria-hidden=true href=#실무-연관성-분석>#</a></h4><table><thead><tr><th>항목</th><th>설명</th><th>실무 연관성</th></tr></thead><tbody><tr><td>데이터 중심성</td><td>데이터가 시스템의 중심이며, 나머지는 이를 소비함</td><td>대규모 데이터 시스템, ETL 파이프라인, Data Lake, ML 파이프라인 설계</td></tr><tr><td>스키마 우선 접근</td><td>데이터 스키마가 모든 애플리케이션 설계의 기준</td><td>데이터 통합, API 정합성 보장, GraphQL 및 protobuf 기반 시스템 설계에 유리</td></tr><tr><td>시스템 간 통합</td><td>서비스 간 통신보다 데이터 공유에 중점을 둠</td><td>Microservices 간 메시지 브로커 없이도 일관된 데이터 처리 가능</td></tr><tr><td>변경 최소화</td><td>데이터 모델을 중심으로 하면 애플리케이션 변경 영향도 줄어듦</td><td>변화 대응력 향상, 기능 모듈화 용이</td></tr></tbody></table><h3 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h3><ol><li><p><strong>데이터 통합 및 표준화</strong></p><ul><li>이질적인 데이터 소스들의 통합 관리</li><li>데이터 포맷과 스키마 표준화</li><li>마스터 데이터 관리 (Master Data Management)</li></ul></li><li><p><strong>메타데이터 관리</strong></p><ul><li>데이터 카탈로그 (Data Catalog) 제공</li><li>데이터 계보 (Data Lineage) 추적</li><li>스키마 레지스트리 (Schema Registry) 운영</li></ul></li><li><p><strong>데이터 접근 및 보안</strong></p><ul><li>역할 기반 접근 제어 (RBAC)</li><li>데이터 마스킹과 암호화</li><li>감사 로그 및 모니터링</li></ul></li><li><p><strong>실시간 데이터 처리</strong></p><ul><li>이벤트 스트리밍 (Event Streaming)</li><li>변경 데이터 캡처 (Change Data Capture)</li><li>실시간 분석 및 알림</li></ul></li></ol><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><ol><li><p><strong>데이터 자기 기술성 (Self-Describing Data)</strong></p><ul><li>데이터가 자체적으로 의미와 구조 정보 포함</li><li>애플리케이션 없이도 데이터 해석 가능</li><li>개방형, 비독점적 포맷 사용</li></ul></li><li><p><strong>탄력적 확장성 (Elastic Scalability)</strong></p><ul><li>수평적 확장을 통한 성능 향상</li><li>클라우드 네이티브 아키텍처와 결합</li><li>마이크로서비스 패턴과의 조화</li></ul></li><li><p><strong>이벤트 기반 동기화</strong></p><ul><li>데이터 변경 시 실시간 전파</li><li>최종 일관성 (Eventual Consistency) 보장</li><li>분산 시스템 환경에서의 데이터 동기화</li></ul></li></ol><h3 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h3><ol><li><p><strong>데이터 중심성 (Data Centricity)</strong></p><ul><li>데이터를 시스템 설계의 출발점으로 설정</li><li>모든 의사결정을 데이터 관점에서 접근</li><li>애플리케이션은 데이터를 방문하여 처리하고 결과를 다시 데이터 계층에 저장</li></ul></li><li><p><strong>분리의 원칙 (Separation of Concerns)</strong></p><ul><li>데이터 저장과 처리 로직의 분리</li><li>관심사의 분리를 통한 시스템 복잡성 관리</li><li>각 계층별 독립적 진화 가능</li></ul></li><li><p><strong>개방성과 투명성</strong></p><ul><li>개방형 표준과 API 사용</li><li>데이터 접근 방법의 투명성 제공</li><li>벤더 종속성 최소화</li></ul></li><li><p><strong>연합성 (Federation)</strong></p><ul><li>물리적으로 분산된 데이터의 논리적 통합</li><li>가상 데이터베이스 개념 적용</li><li>데이터 위치에 관계없는 일관된 접근 방법</li></ul></li></ol><h3 id=주요-원리>주요 원리<a hidden class=anchor aria-hidden=true href=#주요-원리>#</a></h3><pre class=mermaid>graph TB
    subgraph &#34;Application-Centric Approach&#34;
        A1[App 1] --&gt; DB1[(Database 1)]
        A2[App 2] --&gt; DB2[(Database 2)]
        A3[App 3] --&gt; DB3[(Database 3)]
        DB1 -.-&gt;|Data Replication| DB2
        DB2 -.-&gt;|ETL Process| DB3
    end
    
    subgraph &#34;Data-Centric Approach&#34;
        Apps[Applications Layer] --&gt; DAL[Data Access Layer]
        DAL --&gt; SDM[Shared Data Model]
        SDM --&gt; MDM[Master Data Management]
        SDM --&gt; FED[Federated Data Layer]
        FED --&gt; DS1[(Data Source 1)]
        FED --&gt; DS2[(Data Source 2)]
        FED --&gt; DS3[(Data Source 3)]
    end
</pre><p><strong>핵심 원리 설명:</strong></p><ol><li><p><strong>데이터 조합성 (Data Composability)</strong></p><ul><li>데이터는 자연스럽게 조합되지만 서비스와 애플리케이션은 그렇지 않음</li><li>공유 데이터를 통한 시스템 통합</li><li>컴포넌트 간 간접적 통신</li></ul></li><li><p><strong>상태 기반 처리</strong></p><ul><li>현재 데이터 상태에 따른 처리 로직 결정</li><li>외부 입력보다는 데이터 상태가 실행을 트리거</li><li>이벤트 기반 아키텍처와의 결합</li></ul></li><li><p><strong>의미론적 일관성</strong></p><ul><li>조직 전체의 공통 개념 모델 사용</li><li>엔터프라이즈 온톨로지 기반 데이터 구조</li><li>용어와 의미의 표준화</li></ul></li></ol><h3 id=작동-원리-및-방식>작동 원리 및 방식<a hidden class=anchor aria-hidden=true href=#작동-원리-및-방식>#</a></h3><p>데이터 중심 아키텍처의 작동 원리를 상세히 설명하겠습니다:</p><pre class=mermaid>sequenceDiagram
    participant App as Application
    participant DAL as Data Access Layer
    participant DG as Data Gateway
    participant SDM as Shared Data Model
    participant MD as Metadata Store
    participant DS as Data Sources

    App-&gt;&gt;DAL: Request Data Query
    DAL-&gt;&gt;MD: Check Metadata &amp; Schema
    MD--&gt;&gt;DAL: Return Schema Info
    DAL-&gt;&gt;DG: Transform to Standard Query
    DG-&gt;&gt;SDM: Execute Federated Query
    SDM-&gt;&gt;DS: Retrieve Data
    DS--&gt;&gt;SDM: Return Raw Data
    SDM--&gt;&gt;DG: Standardized Data
    DG--&gt;&gt;DAL: Processed Data
    DAL--&gt;&gt;App: Application-specific Format
    
    Note over App,DS: Data flows through standardized layers
    Note over SDM: All data access goes through shared model
</pre><p><strong>작동 방식 설명:</strong></p><ol><li><p><strong>요청 처리 흐름</strong></p><ul><li>애플리케이션이 데이터 접근 계층을 통해 요청</li><li>메타데이터 저장소에서 스키마 정보 확인</li><li>표준화된 쿼리로 변환 후 실행</li><li>결과를 애플리케이션별 형식으로 반환</li></ul></li><li><p><strong>데이터 동기화 메커니즘</strong></p><ul><li>변경 데이터 캡처 (CDC) 를 통한 실시간 동기화</li><li>이벤트 스트리밍을 활용한 변경 사항 전파</li><li>최종 일관성 보장을 위한 재조정 프로세스</li></ul></li><li><p><strong>메타데이터 관리</strong></p><ul><li>스키마 진화와 버전 관리</li><li>데이터 계보 추적과 영향 분석</li><li>자동화된 데이터 품질 모니터링</li></ul></li></ol><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><pre class=mermaid>graph TB
    subgraph &#34;Presentation Layer&#34;
        UI[User Interfaces]
        API[API Gateway]
        DASH[Dashboards]
    end
    
    subgraph &#34;Application Layer&#34;
        APP1[Business App 1]
        APP2[Business App 2]
        APP3[Analytics App]
        ML[ML Models]
    end
    
    subgraph &#34;Data Access Layer&#34;
        DAL[Data Access API]
        AUTH[Authentication/Authorization]
        CACHE[Data Cache]
    end
    
    subgraph &#34;Data Management Layer&#34;
        SDM[Shared Data Model]
        DGV[Data Governance]
        META[Metadata Management]
        QUAL[Data Quality Engine]
    end
    
    subgraph &#34;Integration Layer&#34;
        FED[Data Federation]
        CDC[Change Data Capture]
        ETL[ETL/ELT Processes]
        STREAM[Event Streaming]
    end
    
    subgraph &#34;Storage Layer&#34;
        RDB[(Relational DB)]
        NOSQL[(NoSQL DB)]
        DW[(Data Warehouse)]
        LAKE[(Data Lake)]
    end
    
    UI --&gt; API
    API --&gt; APP1
    API --&gt; APP2
    DASH --&gt; APP3
    ML --&gt; APP3
    
    APP1 --&gt; DAL
    APP2 --&gt; DAL
    APP3 --&gt; DAL
    ML --&gt; DAL
    
    DAL --&gt; SDM
    AUTH --&gt; DAL
    CACHE --&gt; DAL
    
    SDM --&gt; FED
    DGV --&gt; SDM
    META --&gt; SDM
    QUAL --&gt; SDM
    
    FED --&gt; RDB
    FED --&gt; NOSQL
    FED --&gt; DW
    FED --&gt; LAKE
    
    CDC --&gt; STREAM
    ETL --&gt; FED
    STREAM --&gt; FED
</pre><h4 id=구성-요소>구성 요소<a hidden class=anchor aria-hidden=true href=#구성-요소>#</a></h4><table><thead><tr><th><strong>구분</strong></th><th><strong>구성요소</strong></th><th><strong>기능</strong></th><th><strong>역할</strong></th><th><strong>특징</strong></th></tr></thead><tbody><tr><td><strong>필수</strong></td><td>공유 데이터 모델 (Shared Data Model)</td><td>조직 전체에서 사용하는 표준화된 데이터 구조 정의</td><td>데이터 일관성 유지 및 시스템 간 상호 운용성 확보</td><td>의미론적 모델링, 온톨로지 기반</td></tr><tr><td></td><td>데이터 접근 계층 (Data Access Layer)</td><td>앱과 저장소 간의 추상화 계층으로 데이터 접근 표준화</td><td>API 기반 데이터 접근, 보안, 캐싱 등 중재 기능 수행</td><td>API 기반, 보안 통합, 캐싱 지원</td></tr><tr><td></td><td>메타데이터 관리 시스템</td><td>데이터의 의미, 구조, 계보 (lineage) 정보 관리</td><td>데이터 자산의 탐색, 이해도 향상, 데이터 계보 추적 지원</td><td>자동 수집, 검색, 버전 관리</td></tr><tr><td></td><td>데이터 거버넌스 프레임워크</td><td>품질, 보안, 규제 준수 등 데이터 자산의 체계적 관리</td><td>거버넌스 정책 수립, 품질 표준 적용, 규정 준수 자동화</td><td>정책 기반, 품질 검사 자동화</td></tr><tr><td></td><td>통합 계층 (Integration Layer)</td><td>이기종 데이터 소스를 통합, 동기화, 흐름 제어</td><td>실시간 통합, CDC/ETL/ELT 처리, 이벤트 기반 아키텍처 연계</td><td>CDC, 스트리밍, 동기화</td></tr><tr><td><strong>선택</strong></td><td>데이터 가상화 (Data Virtualization)</td><td>실제 데이터 위치와 무관하게 논리적 데이터 뷰 제공</td><td>실시간 통합 쿼리 수행 및 보안 유지</td><td>쿼리 최적화, 캐싱, 보안 전파</td></tr><tr><td></td><td>데이터 카탈로그 (Data Catalog)</td><td>조직 내 모든 데이터 자산을 중앙에서 자동 인벤토리화</td><td>데이터 탐색, 셀프서비스 분석, 데이터 자산 인식 향상</td><td>자동 스캔, 태깅, 품질 평가</td></tr><tr><td></td><td>데이터 레이크 (Data Lake)</td><td>다양한 원시 데이터 (정형/비정형) 를 대용량으로 저장</td><td>빅데이터 분석, ML 모델 훈련, 유연한 데이터 수집</td><td>스키마 온 리드, 비용 효율성</td></tr><tr><td></td><td>엔터프라이즈 지식 그래프 (Enterprise Knowledge Graph)</td><td>조직 내 엔티티 간 관계를 그래프 형태로 표현</td><td>AI/검색/추론 기반 분석, 의미론적 통합 데이터 제공</td><td>의미론 쿼리, 추론 엔진, 관계 분석</td></tr></tbody></table><h3 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h3><table><thead><tr><th>구현 기법</th><th>설명</th><th>대표 도구/기술</th></tr></thead><tbody><tr><td>Schema-first Design</td><td>먼저 스키마를 정의하고 각 시스템이 이를 따르도록 설계</td><td>OpenAPI, Avro, Protobuf</td></tr><tr><td>Event-driven Architecture</td><td>데이터 변경 사항을 이벤트로 전파하여 실시간 통합</td><td>Kafka, Pulsar, EventBridge</td></tr><tr><td>Data Lake Integration</td><td>다양한 데이터 소스를 중앙 데이터 저장소에 통합</td><td>AWS S3, Delta Lake, Hadoop</td></tr><tr><td>Stream Processing</td><td>이벤트를 실시간으로 변환, 적재, 분석</td><td>Apache Flink, Kafka Streams</td></tr><tr><td>Data Catalog & Governance</td><td>데이터 흐름 및 소유권 명세화, 메타데이터 관리</td><td>DataHub, Amundsen, Collibra</td></tr><tr><td>Versioned Data Models</td><td>스키마 변경 시 호환성 유지, 버전별 API 관리</td><td>Git-based 모델 관리, Semver</td></tr></tbody></table><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th><th>주요 특성/근거 요인</th></tr></thead><tbody><tr><td><strong>데이터 품질 및 일관성</strong></td><td>데이터 일관성 및 무결성 확보</td><td>단일 진실 원천 (SSOT) 기반으로 데이터 불일치와 무결성 문제 해결</td><td>데이터 중심 아키텍처, 중앙 스키마 관리</td></tr><tr><td></td><td>데이터 품질 향상</td><td>중앙 집중식 데이터 거버넌스 및 메타데이터 관리로 데이터 품질 보장</td><td>거버넌스 정책, 메타데이터 계층</td></tr><tr><td></td><td>일관된 데이터 구조</td><td>통합 스키마 관리로 시스템 간 일관성 유지</td><td>중앙 스키마 레지스트리</td></tr><tr><td><strong>개발 및 운영 효율성</strong></td><td>개발 효율성</td><td>표준화된 공유 데이터 모델로 신규 애플리케이션 개발 시간 단축</td><td>재사용 가능한 데이터 구조</td></tr><tr><td></td><td>통합 비용 절감</td><td>ETL/복제를 최소화하여 운영 및 유지보수 비용 절감</td><td>중복 제거, 직접 접근</td></tr><tr><td></td><td>재사용성 증대</td><td>공통 데이터 모델을 다양한 컴포넌트에서 재활용 가능</td><td>모듈화 설계, 표준 스키마</td></tr><tr><td><strong>확장성과 유연성</strong></td><td>확장성 및 유연성 제공</td><td>수평적 확장과 모듈화 구조로 시스템 성능과 변화 대응 능력 향상</td><td>분산 아키텍처, 모듈화 컴포넌트</td></tr><tr><td></td><td>변화에 강한 아키텍처</td><td>스키마 변경에 유연하게 대응 가능</td><td>느슨한 결합, 버전 관리</td></tr><tr><td><strong>데이터 활용성과 민첩성</strong></td><td>실시간 처리</td><td>이벤트 기반 데이터 흐름 처리로 민첩한 반응성 확보</td><td>스트리밍 파이프라인, Pub/Sub 구조</td></tr><tr><td></td><td>신속한 데이터 접근/처리</td><td>자동화된 데이터 파이프라인으로 빠른 수집, 저장, 분석 가능</td><td>ETL/ELT 자동화</td></tr><tr><td></td><td>분석 최적화</td><td>중앙 저장소 기반으로 전사 통합 분석 가능</td><td>중앙화된 분석 인프라</td></tr><tr><td></td><td>데이터 기반 의사결정 지원</td><td>시각화 및 통계 분석 기반으로 전략적 의사결정 가능</td><td>BI 도구, 시각화 플랫폼</td></tr><tr><td><strong>보안 및 거버넌스</strong></td><td>보안 및 규정 준수 강화</td><td>데이터 접근 통제, 로그 추적, 감사 기능으로 보안 및 컴플라이언스 만족</td><td>거버넌스 정책, 보안 계층</td></tr><tr><td><strong>투명성 및 추적성</strong></td><td>데이터 투명성 및 계보 관리</td><td>메타데이터와 데이터 계보 추적으로 영향 분석과 변경 추적 가능</td><td>계보 추적 시스템, 메타데이터 통합</td></tr></tbody></table><h3 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th><strong>카테고리</strong></th><th><strong>단점 항목</strong></th><th><strong>설명</strong></th><th><strong>해결책 / 대응 전략</strong></th></tr></thead><tbody><tr><td><strong>구조적 복잡성</strong></td><td>초기 설계 복잡성</td><td>스키마 설계, 도메인 모델링, 컴포넌트 분리 등으로 높은 설계 난이도 요구</td><td>데이터 도메인 명확화, 표준 스키마 가이드라인 수립, 전문가 컨설팅 도입</td></tr><tr><td></td><td>데이터 관리 구조의 분산</td><td>다양한 데이터 소스 및 처리 계층으로 인해 일관성 및 추적 어려움 발생</td><td>데이터 카탈로그, 공통 메타데이터 관리, 표준화된 수집 파이프라인 설계</td></tr><tr><td><strong>성능/운영 측면</strong></td><td>성능 병목 가능성</td><td>중앙화된 API 또는 저장소에 의존 시 성능 저하 발생 가능</td><td>캐싱, 데이터 샤딩, 분산 DB 활용, 로드 밸런싱</td></tr><tr><td></td><td>기술 스택 다양성</td><td>각 도메인 또는 서비스가 서로 다른 기술 스택을 사용할 경우 학습 비용 및 통합 부담 증가</td><td>기술 표준화 정책 수립, 공통 SDK 및 라이브러리 제공</td></tr><tr><td></td><td>높은 초기 비용</td><td>인프라, 보안, 데이터 관리 도구에 대한 초기 투자 비용 발생</td><td>클라우드 활용으로 CapEx → OpEx 전환, ROI 기반 단계적 도입</td></tr><tr><td><strong>조직/문화 측면</strong></td><td>조직 저항</td><td>기존 운영 방식과의 단절로 인해 조직 내 도입 저항 발생</td><td>변화 관리 프로그램, 단계별 교육/전파 전략 도입</td></tr><tr><td></td><td>개발 속도 저하 가능성</td><td>중앙 관리 프로세스 또는 스키마 승인 절차로 인해 릴리즈 병목 발생 가능</td><td>스키마 자율성 부여, 자동 검증 도구 도입, 린 거버넌스 적용</td></tr><tr><td></td><td>기술 의존성 심화</td><td>특정 클라우드 서비스나 프로토콜에 대한 종속이 심화될 가능성 있음</td><td>멀티 클라우드 고려, 오픈소스 기반 기술 스택 활용</td></tr></tbody></table><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th><strong>카테고리</strong></th><th><strong>문제 항목</strong></th><th><strong>원인</strong></th><th><strong>영향</strong></th><th><strong>탐지 및 진단</strong></th><th><strong>예방 방법</strong></th><th><strong>해결 방법 및 기법</strong></th></tr></thead><tbody><tr><td><strong>데이터 품질/정합성</strong></td><td>데이터 중복 저장 / 불일치</td><td>동일 데이터가 여러 시스템에 분산 저장됨</td><td>저장 비용 증가, 정합성 저하</td><td>스토리지 사용량 / 정합성 비교 로그 모니터링</td><td>파이프라인 정규화, 소스 표준화 적용</td><td>CDC 적용, 정규화된 저장 전략</td></tr><tr><td></td><td>스키마 불일치 / 진화 충돌</td><td>시스템 간 스키마 버전 상이, 호환성 고려 부족</td><td>서비스 오류, 장애 발생</td><td>스키마 레지스트리 로그, 버전 비교 도구 활용</td><td>계약 기반 개발, 버전 관리 정책 수립</td><td>Forward/Backward 호환 설계, A/B 마이그레이션</td></tr><tr><td></td><td>데이터 품질 저하</td><td>다양한 소스에서 수집되는 데이터의 검증 부재</td><td>잘못된 분석 결과, 비즈니스 판단 오류</td><td>자동화된 품질 지표 모니터링 (null 비율, 이상값 등)</td><td>입력 검증 강화, 품질 기준 정의</td><td>클렌징 파이프라인, 데이터 품질 대시보드 구축</td></tr><tr><td><strong>성능/확장성</strong></td><td>이벤트 처리 병목</td><td>이벤트 큐 적체, 컨슈머 병렬성 부족</td><td>지연 증가, 실시간 장애</td><td>메시지 지연률, 큐 적체 모니터링</td><td>컨슈머 그룹 분리, 스케일 아웃 구성</td><td>Kafka 파티셔닝, 멀티 쓰레드 소비</td></tr><tr><td></td><td>처리 성능 저하</td><td>대용량 데이터 처리 시 단일 노드/함수 병목 발생</td><td>응답 시간 증가, 사용자 경험 저하</td><td>응답 시간 / 처리량 메트릭 분석</td><td>캐싱, 병렬 처리 도입</td><td>Lambda fan-out, Kinesis 병렬 소비</td></tr><tr><td><strong>보안/컴플라이언스</strong></td><td>보안 취약점</td><td>데이터 접근 통제 미흡, 암호화 부재</td><td>권한 남용, 개인정보 유출 위험</td><td>보안 감사 로그, 접근 패턴 분석</td><td>RBAC 적용, IAM 최소 권한 정책 설정</td><td>제로 트러스트 보안 모델, 데이터 마스킹</td></tr><tr><td></td><td>중앙 데이터 접근 과다</td><td>모든 서비스가 동일한 데이터 허브에 접근</td><td>보안 노출, 성능 병목</td><td>접근 경로 로그 분석, 사용자 접근 이력 추적</td><td>접근 제어 세분화, 계층 분리</td><td>데이터 거버넌스 정책 수립 및 분산 설계</td></tr><tr><td><strong>운영/동기화</strong></td><td>동기화 지연</td><td>시스템 간 네트워크 지연, 트랜잭션 충돌</td><td>실시간 분석 불가, 지연 발생</td><td>지연 메트릭, 최신 동기화 시점 로그 분석</td><td>비동기 처리 설계, CDC/이벤트 기반 갱신 방식 도입</td><td>Kafka, EventBridge 기반 비동기 아키텍처 구성</td></tr></tbody></table><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><table><thead><tr><th>카테고리</th><th>문제 유형</th><th>원인</th><th>영향</th><th>탐지 및 진단 방식</th><th>예방 방법</th><th>해결 기법</th></tr></thead><tbody><tr><td><strong>기술적 도전</strong></td><td>레거시 통합 및 기술 스택 다양성</td><td>다양한 기술 구성 요소 및 레거시 시스템 통합의 복잡성</td><td>구현 비용 상승, 마이그레이션 지연</td><td>시스템 성능 모니터링, 호환성 테스트</td><td>API 우선 설계, 점진적 전환 전략</td><td>어댑터 패턴, 마이크로서비스 기반 분리</td></tr><tr><td><strong>데이터 품질 관리</strong></td><td>데이터 불일치 및 무결성 문제</td><td>소스 시스템 간 데이터 처리 타이밍, 입력 오류</td><td>잘못된 분석 결과, 의사결정 오류</td><td>이상 탐지, 데이터 품질 자동 검증</td><td>입력 검증, 품질 규칙 정의</td><td>클렌징 파이프라인, 품질 대시보드</td></tr><tr><td></td><td>스키마 진화 및 호환성 문제</td><td>버전 관리 미흡, Schema 변경 시 하위 호환성 부족</td><td>데이터 파싱 오류, 서비스 중단</td><td>Schema Registry 검사, 계약 기반 테스트</td><td>스키마 버저닝, 사전 테스트 자동화</td><td>AVRO/PROTOBUF 활용, CI/CD 연동 검증</td></tr><tr><td><strong>확장성과 성능</strong></td><td>데이터 급증 및 트래픽 병목</td><td>대량 데이터 처리, 동시 요청 증가</td><td>시스템 성능 저하, 처리 지연</td><td>부하 테스트, 처리량 메트릭 분석</td><td>분산 아키텍처 설계, 클라우드 네이티브 확장 구조</td><td>수평 확장, 캐싱, 파티셔닝 전략</td></tr><tr><td><strong>실시간성 대응</strong></td><td>스트림 처리 병목 현상</td><td>불균형 이벤트 수신, 처리 지연</td><td>실시간 데이터 누락, 분석 지연</td><td>이벤트 처리 시간 측정, 지연 분포 시각화</td><td>이벤트 큐 모니터링, 적절한 큐 설계</td><td>멀티 컨슈머 구조, 부하 분산 이벤트 라우팅</td></tr><tr><td><strong>조직 문화/구조적 요인</strong></td><td>데이터 소유권 갈등 및 거버넌스 부재</td><td>조직 간 이해관계 충돌, 책임자 명확하지 않음</td><td>프로젝트 지연, 도입 실패</td><td>사용자 채택률, 이해관계자 피드백</td><td>변화 관리 체계, 역할 기반 책임 명확화</td><td>거버넌스 위원회 구성, 도메인 기반 Mesh 운영 도입</td></tr><tr><td><strong>보안 및 규정 준수</strong></td><td>데이터 접근 보안 및 규제 위반</td><td>다양한 접근 지점, 민감 데이터 노출 위험</td><td>신뢰도 저하, 법적 리스크</td><td>감사 로그 분석, 접근 기록 추적</td><td>최소 권한 정책, 정기 보안 점검</td><td>데이터 암호화, RBAC/ABAC 적용</td></tr><tr><td><strong>통합 및 동기화 문제</strong></td><td>데이터 일관성 유지</td><td>비동기 통신 간 이벤트 수신 시점 불일치</td><td>중복 처리, 데이터 오류</td><td>타임스탬프 기반 동기화 검증</td><td>이벤트 설계 시 순서 보장, 시간 동기화</td><td>이벤트 재처리, Idempotency 처리</td></tr><tr><td><strong>데이터 통합 및 소유권</strong></td><td>멀티 소스 데이터 정합성 문제</td><td>다양한 소스 간 표준 불일치, 정제되지 않은 데이터 혼합</td><td>데이터 분석 오류, 통합 실패</td><td>메타데이터 기반 계보 추적, 소스별 품질 리포트</td><td>표준화된 모델 정의, 소스 정합성 검증 자동화</td><td>ETL 선 정제, 소스 별 데이터 계약 기반 통합</td></tr></tbody></table><h3 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th><strong>분류 기준</strong></th><th><strong>종류/유형</strong></th><th><strong>특징</strong></th><th><strong>적용 분야</strong></th></tr></thead><tbody><tr><td><strong>1. 아키텍처 접근 방식</strong></td><td>API 중심</td><td>데이터 접근이 데이터 서비스 계층 (API 등) 을 통해 이루어짐</td><td>마이크로서비스, BFF, 서버리스 시스템</td></tr><tr><td></td><td>이벤트 기반 (Event-Driven)</td><td>이벤트 트리거 중심으로 데이터 흐름 및 처리를 설계</td><td>IoT, 실시간 모니터링, 이벤트 소싱 시스템</td></tr><tr><td></td><td>중앙 집중형</td><td>단일 데이터 허브 또는 웨어하우스로 집중 관리</td><td>전사적 데이터 허브, ERP, 정형 분석 시스템</td></tr><tr><td></td><td>분산형</td><td>여러 위치에 분산된 노드 또는 시스템에 의해 데이터 처리 및 저장</td><td>글로벌 분산 시스템, 엣지 컴퓨팅</td></tr><tr><td><strong>2. 구현 아키텍처 패턴</strong></td><td>Repository Architecture</td><td>수동적 저장소. 클라이언트가 직접 데이터를 요청하여 처리</td><td>전통적 RDBMS, 라이브러리 시스템</td></tr><tr><td></td><td>Blackboard Architecture</td><td>능동적 저장소. 데이터 상태 변화에 따라 트리거되어 처리</td><td>음성 인식, AI 추론 엔진, 이미지 인식</td></tr><tr><td><strong>3. 데이터 통합 전략</strong></td><td>Federated Database</td><td>이질적인 DB 를 통합 접근. 실제로는 분산되어 있고 실시간으로 연결됨</td><td>글로벌 기업, 멀티 클라우드 환경</td></tr><tr><td></td><td>Data Lake Architecture</td><td>원시 데이터 중심 저장, 스키마는 조회 시 적용 (Schema-on-read)</td><td>빅데이터 분석, 머신러닝, IoT 데이터 수집</td></tr><tr><td><strong>4. 데이터 처리 방식</strong></td><td>Batch-Oriented</td><td>일괄 처리 중심. 일정 주기로 데이터 적재 및 분석</td><td>데이터 웨어하우징, 전통적 ETL 처리</td></tr><tr><td></td><td>Stream-Oriented</td><td>스트리밍 기반 실시간 처리. 지연시간 최소화</td><td>실시간 로그 분석, IoT, 사용자 이벤트 처리</td></tr><tr><td><strong>5. 저장 방식</strong></td><td>Data Lake 중심</td><td>정제되지 않은 데이터 저장, 확장성/유연성 중심</td><td>분석, ML 학습용 데이터, IoT 로그 저장</td></tr><tr><td></td><td>스키마 중심 저장</td><td>저장 전 스키마 강제 적용 (Schema-on-write)</td><td>정형 데이터 처리, 트랜잭션 시스템</td></tr><tr><td><strong>6. 데이터 정의 방식</strong></td><td>스키마 중심 설계</td><td>표준화된 데이터 모델 및 구조 선 설계</td><td>데이터 거버넌스 강화 조직, 데이터 계약 기반 개발</td></tr><tr><td></td><td>유연한 스키마 또는 스키마 - 온 - 리드</td><td>저장 시 자유롭게, 조회 시 구조 정의 가능</td><td>비정형 데이터 분석, 로그 수집 시스템</td></tr><tr><td><strong>7. 데이터 모델 유형</strong></td><td>Relational Model</td><td>정규화 구조, ACID 보장, 관계형 테이블 기반</td><td>트랜잭션 처리, 금융 시스템, ERP</td></tr><tr><td></td><td>Graph Model</td><td>노드/엣지 기반, 관계 중심, 비정형 연결 구조</td><td>소셜 네트워크, 추천 시스템, 사기 탐지</td></tr><tr><td><strong>8. 배포 형태</strong></td><td>On-Premise</td><td>자체 인프라 사용. 보안, 규제, 통제 중심</td><td>금융권, 정부기관, 군사 시스템</td></tr><tr><td></td><td>Cloud-Native</td><td>클라우드 최적화. 컨테이너 기반 자동 확장 및 API 중심 구조</td><td>스타트업, SaaS, 글로벌 확장 조직</td></tr></tbody></table><h3 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h3><table><thead><tr><th>📂 카테고리</th><th>사용 목적</th><th>주요 사용 기술</th><th>기대 효과</th><th>적용 분야</th></tr></thead><tbody><tr><td><strong>1. 고객 이해 및 개인화</strong></td><td>고객 360 도 뷰 확보</td><td>CRM, CDP, 분석 도구</td><td>개인화된 서비스 제공, 매출 증가</td><td>리테일, 금융, 마케팅</td></tr><tr><td></td><td>사용자 행동 기반 추천</td><td>Kafka Streams, Spark, ML 엔진</td><td>전환율 향상, 추천 정확도 개선</td><td>이커머스, OTT</td></tr><tr><td><strong>2. 실시간 데이터 활용</strong></td><td>실시간 추천 및 반응형 서비스 제공</td><td>스트리밍 처리 (Flink, Kafka), ML 모델</td><td>사용자 경험 개선, 실시간 반응 제공</td><td>커머스, 미디어 플랫폼</td></tr><tr><td></td><td>금융권 실시간 거래 처리</td><td>Kafka, Protobuf, Snowflake</td><td>거래 속도 개선, 데이터 일관성 확보</td><td>은행, 증권</td></tr><tr><td></td><td>IoT 기반 실시간 분석</td><td>MQTT, InfluxDB, Apache Flink</td><td>실시간 센서 분석, 이상 탐지, 예지 보전 (PdM)</td><td>제조, 스마트시티</td></tr><tr><td><strong>3. 데이터 기반 의사결정</strong></td><td>빅데이터 통합 분석 및 시각화 구축</td><td>Hadoop, Spark, BI 도구, dbt, BigQuery</td><td>전사 데이터 기반 분석, 데이터 활용도 극대화</td><td>SaaS, 대기업 데이터 팀</td></tr><tr><td></td><td>공공 정책 데이터 허브 구축</td><td>REST API, GraphQL, Data Catalog</td><td>부처 간 통합, 정책 결정 지원, 시민 서비스 개선</td><td>공공기관</td></tr><tr><td><strong>4. 운영 효율 및 자동화</strong></td><td>운영 최적화 및 비용 절감</td><td>IoT, 예측 분석, ERP, SCM</td><td>설비 효율 향상, 재고 최적화, 운영 비용 절감</td><td>제조업, 유통, 물류</td></tr><tr><td></td><td>공급망 가시성 확보</td><td>센서, ERP, 실시간 트래킹 시스템</td><td>실시간 재고 파악, 리스크 관리</td><td>유통, 제조, 글로벌 공급망</td></tr><tr><td><strong>5. 리스크 및 규제 대응</strong></td><td>사기 탐지 및 이상 행동 탐지</td><td>이상 탐지 알고리즘, 그래프 DB, ML 기반 보안 엔진</td><td>금융 사기 방지, 리스크 최소화</td><td>보험, 핀테크</td></tr><tr><td></td><td>금융 리스크 통제 및 보고 자동화</td><td>Kafka, Snowflake, BI, 컴플라이언스 플랫폼</td><td>실시간 리스크 분석, 규제 보고 자동화</td><td>금융권 전반</td></tr><tr><td><strong>6. 거버넌스 및 컴플라이언스</strong></td><td>데이터 품질 및 규제 대응 강화</td><td>메타데이터 관리 도구, 감사 로깅 시스템</td><td>신뢰도 향상, 법적 규제 대응</td><td>헬스케어, 정부기관</td></tr></tbody></table><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><h4 id=사례-1-고객-360-도-뷰-확보-customer-360-view>사례 1: 고객 360 도 뷰 확보 (Customer 360 View)<a hidden class=anchor aria-hidden=true href=#사례-1-고객-360-도-뷰-확보-customer-360-view>#</a></h4><blockquote><p>고객 데이터를 <strong>중앙에 통합 관리</strong>하고, 다양한 채널의 데이터를 분석하여 <strong>개인화, 세분화된 마케팅</strong>, 그리고 <strong>실시간 의사결정</strong>을 가능하게 하는 <strong>Data-Centric Architecture</strong> 기반 구조</p></blockquote><p><strong>주요 구성요소</strong>:</p><table><thead><tr><th>구성 요소</th><th>설명</th></tr></thead><tbody><tr><td><strong>Data Ingestion Layer</strong></td><td>CRM, 웹/모바일 로그, POS, IoT, SNS 등에서 실시간/배치로 데이터 수집 (Kafka, Logstash, ETL)</td></tr><tr><td><strong>Data Lake / Warehouse</strong></td><td>통합 저장소로써 Raw + Refined 데이터 관리 (S3 + Snowflake / BigQuery / Redshift)</td></tr><tr><td><strong>CDP (Customer Data Platform)</strong></td><td>고객 식별 및 통합, ID Graph 관리, 마스터 데이터 관리</td></tr><tr><td><strong>Metadata & Catalog Layer</strong></td><td>데이터 정의, 계보 추적, 민감 정보 마킹 등 (Apache Atlas, DataHub)</td></tr><tr><td><strong>Analytics / ML Layer</strong></td><td>고객 세분화, 예측 분석, 추천 모델 등 (Spark ML, SageMaker, Vertex AI)</td></tr><tr><td><strong>BI & Activation Layer</strong></td><td>고객 대시보드, 개인화 이메일/알림 발송, 마케팅 캠페인 실행 등 (Looker, Tableau, Segment, Braze)</td></tr></tbody></table><p><strong>시스템 구성 아키텍처</strong></p><pre class=mermaid>flowchart LR
    subgraph Sources
        CRM[CRM]
        WebLogs[웹/앱 로그]
        POS[POS 데이터]
        IoT[IoT 센서]
        SNS[SNS API]
    end

    subgraph Ingestion
        Kafka[Kafka/Logstash]
        ETL[Batch ETL]
    end

    subgraph Storage
        Raw[&#34;S3 / HDFS (Raw Layer)&#34;]
        Curated[&#34;Snowflake / BigQuery (Refined Layer)&#34;]
    end

    subgraph Processing
        CDP[Customer Data Platform]
        ML[&#34;ML Pipeline (Spark/SageMaker)&#34;]
    end

    subgraph Output
        BI[Tableau / Looker]
        Activation[&#34;Marketing Automation (Braze, Segment)&#34;]
    end

    CRM --&gt; Kafka
    WebLogs --&gt; Kafka
    POS --&gt; Kafka
    IoT --&gt; Kafka
    SNS --&gt; ETL

    Kafka --&gt; Raw
    ETL --&gt; Raw
    Raw --&gt; Curated

    Curated --&gt; CDP
    CDP --&gt; ML
    ML --&gt; Activation
    Curated --&gt; BI
    CDP --&gt; BI
</pre><hr><p><strong>데이터 흐름 (Workflow)</strong>:</p><ol><li><strong>수집 (Ingestion)</strong><ul><li>Kafka / Logstash 를 통해 다양한 소스 (웹, 앱, CRM, POS 등) 로부터 실시간 스트리밍 또는 배치 수집</li><li>정형, 반정형, 비정형 데이터 모두 수용 가능</li></ul></li><li><strong>저장 및 정제 (Storage & Refinement)</strong><ul><li><strong>Data Lake</strong>에 원천 데이터 저장 (<code>Raw zone</code>)</li><li>정제된 데이터는 <code>Curated zone</code> 에 Snowflake / BigQuery 등으로 적재됨</li></ul></li><li><strong>통합 및 식별 (Customer ID Resolution)</strong><ul><li>이메일, 전화번호, 쿠키 등 다양한 ID 를 그래프 모델로 통합 (CDP)</li><li>고객 단일 프로필 생성 (Golden Record)</li></ul></li><li><strong>분석 및 예측 (Analytics & ML)</strong><ul><li>고객 세그먼트 분류, 이탈 예측, 추천 모델 등 ML 분석</li><li>Spark, SageMaker 등을 활용한 예측 분석 워크플로우</li></ul></li><li><strong>활용 (Activation)</strong><ul><li>개인화된 메시지/알림 발송 (Push, Email, 광고)</li><li>캠페인 별 고객 행동 측정 → CDP 로 다시 피드백 루프 생성</li></ul></li></ol><p><strong>Python 기반 구현 예시</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Kafka 소비자 예시: 고객 행동 수집</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaConsumer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;customer_behavior&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>value_deserializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>message</span> <span class=ow>in</span> <span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>message</span><span class=o>.</span><span class=n>value</span>
</span></span><span class=line><span class=cl>    <span class=n>customer_id</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;user_id&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>event</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;action_type&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>timestamp</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;timestamp&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=n>timestamp</span><span class=si>}</span><span class=s2>] User </span><span class=si>{</span><span class=n>customer_id</span><span class=si>}</span><span class=s2> performed </span><span class=si>{</span><span class=n>event</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 고객 통합 (CDP-like ID mapping)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>unify_customer_records</span><span class=p>(</span><span class=n>records</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>unified</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>record</span> <span class=ow>in</span> <span class=n>records</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>email</span> <span class=o>=</span> <span class=n>record</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;email&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>phone</span> <span class=o>=</span> <span class=n>record</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;phone&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>key</span> <span class=o>=</span> <span class=n>email</span> <span class=ow>or</span> <span class=n>phone</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>key</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>unified</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>unified</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>record</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>unified</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>record</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>unified</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-2-커머스-기업의-실시간-사용자-행동-분석>사례 2: 커머스 기업의 실시간 사용자 행동 분석<a hidden class=anchor aria-hidden=true href=#사례-2-커머스-기업의-실시간-사용자-행동-분석>#</a></h4><p><strong>배경</strong>: 수백만 사용자의 상품 검색, 클릭, 구매 행동을 분석하여 개인화된 추천과 마케팅 자동화를 추진.</p><p><strong>구성요소</strong>:</p><ul><li>이벤트 수집: Kafka</li><li>실시간 처리: Apache Flink</li><li>저장소: Amazon S3 (Data Lake), Redis (캐시)</li><li>데이터 모델: Avro 기반 스키마</li><li>분석/추천: Python 기반 ML 파이프라인</li></ul><p><strong>시스템 구성 다이어그램</strong>:</p><pre class=mermaid>flowchart LR
    U[User Behavior] --&gt; K[Kafka]
    K --&gt; F[Apache Flink]
    F --&gt; S3[&#34;Data Lake (S3)&#34;]
    F --&gt; R[Redis]
    S3 --&gt; A[Analytics / ML]
</pre><p><strong>Workflow</strong>:</p><ol><li>사용자가 앱/웹에서 행동 → Kafka 에 이벤트 적재</li><li>Apache Flink 가 실시간 분석/필터링</li><li>필터링된 데이터는 Redis 에 저장하여 개인화 추천에 사용</li><li>장기 저장된 S3 데이터를 ML 모델 훈련용으로 분석</li></ol><p><strong>역할</strong>:</p><ul><li><code>Data-Centric Architecture</code> 는 <strong>모든 서비스가 동일한 데이터 정의 및 흐름을 따르도록 하여 통일성, 확장성, 분석 연계성</strong>을 확보함.</li><li>스키마 중심 설계로 오류 가능성을 줄이고, 실시간 이벤트 중심 아키텍처로 반응성을 향상시킴.</li></ul><p><strong>유무 비교</strong>:</p><table><thead><tr><th>항목</th><th>적용 전</th><th>적용 후</th></tr></thead><tbody><tr><td>데이터 정의</td><td>팀마다 상이</td><td>통일된 Avro 스키마 사용</td></tr><tr><td>분석 시간</td><td>주 단위 일괄</td><td>실시간 반영 가능</td></tr><tr><td>시스템 확장</td><td>서비스 간 결합 높음</td><td>서비스와 데이터 흐름 분리로 유연</td></tr><tr><td>유지보수</td><td>높은 연동 비용</td><td>중앙 스키마 관리로 유지보수 용이</td></tr></tbody></table><h4 id=사례-3-금융권-실시간-거래-처리-시스템>사례 3: 금융권 실시간 거래 처리 시스템<a hidden class=anchor aria-hidden=true href=#사례-3-금융권-실시간-거래-처리-시스템>#</a></h4><p><strong>시스템 구성:</strong></p><ul><li>데이터 수집, 처리, 분석 모듈 분리</li><li>실시간 데이터 파이프라인 구축</li><li>데이터 거버넌스 및 보안 체계 적용</li></ul><p><strong>Workflow 다이어그램:</strong></p><pre class=mermaid>graph LR
A[데이터 수집] --&gt; B[데이터 처리]
B --&gt; C[데이터 분석]
C --&gt; D[데이터 시각화]
D --&gt; E[데이터 거버넌스/보안]
E --&gt; A
</pre><p><strong>역할:</strong></p><ul><li>데이터 중심 아키텍처를 통해 신속한 거래 처리, 데이터 일관성 확보, 보안 강화</li></ul><p><strong>차이점:</strong></p><ul><li><strong>패턴 미적용 시:</strong> 데이터 일관성 저하, 처리 지연, 보안 취약</li><li><strong>패턴 적용 시:</strong> 신속한 처리, 데이터 일관성, 보안 강화</li></ul><h4 id=사례-4-jpmorgan-chase-의-데이터-중심-전환>사례 4: JPMorgan Chase 의 데이터 중심 전환<a hidden class=anchor aria-hidden=true href=#사례-4-jpmorgan-chase-의-데이터-중심-전환>#</a></h4><p>JPMorgan Chase 는 전 세계적으로 분산된 수백 개의 시스템에서 발생하는 방대한 금융 데이터를 통합 관리하기 위해 데이터 중심 아키텍처를 도입했다.</p><p><strong>시스템 구성:</strong></p><pre class=mermaid>graph TB
    subgraph &#34;Front Office&#34;
        TRADE[Trading Systems]
        CRM[Customer Management]
        RISK[Risk Management]
    end
    
    subgraph &#34;Data-Centric Core&#34;
        API[Unified Data API]
        DL[Data Lake]
        DW[Enterprise Data Warehouse]
        MD[Master Data Management]
        RT[Real-time Stream Processing]
    end
    
    subgraph &#34;Back Office&#34;
        REG[Regulatory Reporting]
        ACC[Accounting Systems]
        COMP[Compliance Tools]
    end
    
    TRADE --&gt; API
    CRM --&gt; API
    RISK --&gt; API
    
    API --&gt; DL
    API --&gt; DW
    API --&gt; MD
    API --&gt; RT
    
    DL --&gt; REG
    DW --&gt; ACC
    MD --&gt; COMP
    RT --&gt; RISK
</pre><p><strong>활용 사례 Workflow:</strong></p><ol><li><strong>데이터 수집</strong>: 거래 시스템에서 실시간으로 데이터 스트리밍</li><li><strong>표준화</strong>: 통합 API 를 통해 표준 포맷으로 변환</li><li><strong>저장</strong>: 데이터 레이크에 원시 데이터, 데이터 웨어하우스에 정제된 데이터 저장</li><li><strong>분석</strong>: 실시간 리스크 분석과 규제 보고서 자동 생성</li><li><strong>의사결정</strong>: 통합된 고객 뷰를 기반으로 한 투자 상품 추천</li></ol><p><strong>데이터 중심 아키텍처의 역할:</strong></p><ul><li><strong>통합된 고객 뷰</strong>: 여러 채널의 고객 데이터를 단일 뷰로 통합</li><li><strong>실시간 리스크 관리</strong>: 포트폴리오 전반의 실시간 리스크 모니터링</li><li><strong>자동화된 컴플라이언스</strong>: 규제 요구사항에 따른 자동 보고서 생성</li><li><strong>데이터 계보 추적</strong>: 감사를 위한 완전한 데이터 추적 체계</li></ul><p><strong>데이터 중심 아키텍처 유무에 따른 차이점:</strong></p><ul><li><strong>도입 전</strong>: 시스템별 데이터 사일로로 인한 중복 작업과 일관성 문제</li><li><strong>도입 후</strong>: 통합된 데이터 플랫폼을 통한 신속한 분석과 의사결정</li></ul><h3 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h3><h4 id=python-커머스-기업의-실시간-사용자-행동-분석>Python: 커머스 기업의 실시간 사용자 행동 분석<a hidden class=anchor aria-hidden=true href=#python-커머스-기업의-실시간-사용자-행동-분석>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>  1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>  2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3>  3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4>  4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5>  5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6>  6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7>  7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8>  8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9>  9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10> 10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11> 11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12> 12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13> 13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14> 14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15> 15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16> 16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17> 17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18> 18</a>
</span><span class=lnt id=hl-9-19><a class=lnlinks href=#hl-9-19> 19</a>
</span><span class=lnt id=hl-9-20><a class=lnlinks href=#hl-9-20> 20</a>
</span><span class=lnt id=hl-9-21><a class=lnlinks href=#hl-9-21> 21</a>
</span><span class=lnt id=hl-9-22><a class=lnlinks href=#hl-9-22> 22</a>
</span><span class=lnt id=hl-9-23><a class=lnlinks href=#hl-9-23> 23</a>
</span><span class=lnt id=hl-9-24><a class=lnlinks href=#hl-9-24> 24</a>
</span><span class=lnt id=hl-9-25><a class=lnlinks href=#hl-9-25> 25</a>
</span><span class=lnt id=hl-9-26><a class=lnlinks href=#hl-9-26> 26</a>
</span><span class=lnt id=hl-9-27><a class=lnlinks href=#hl-9-27> 27</a>
</span><span class=lnt id=hl-9-28><a class=lnlinks href=#hl-9-28> 28</a>
</span><span class=lnt id=hl-9-29><a class=lnlinks href=#hl-9-29> 29</a>
</span><span class=lnt id=hl-9-30><a class=lnlinks href=#hl-9-30> 30</a>
</span><span class=lnt id=hl-9-31><a class=lnlinks href=#hl-9-31> 31</a>
</span><span class=lnt id=hl-9-32><a class=lnlinks href=#hl-9-32> 32</a>
</span><span class=lnt id=hl-9-33><a class=lnlinks href=#hl-9-33> 33</a>
</span><span class=lnt id=hl-9-34><a class=lnlinks href=#hl-9-34> 34</a>
</span><span class=lnt id=hl-9-35><a class=lnlinks href=#hl-9-35> 35</a>
</span><span class=lnt id=hl-9-36><a class=lnlinks href=#hl-9-36> 36</a>
</span><span class=lnt id=hl-9-37><a class=lnlinks href=#hl-9-37> 37</a>
</span><span class=lnt id=hl-9-38><a class=lnlinks href=#hl-9-38> 38</a>
</span><span class=lnt id=hl-9-39><a class=lnlinks href=#hl-9-39> 39</a>
</span><span class=lnt id=hl-9-40><a class=lnlinks href=#hl-9-40> 40</a>
</span><span class=lnt id=hl-9-41><a class=lnlinks href=#hl-9-41> 41</a>
</span><span class=lnt id=hl-9-42><a class=lnlinks href=#hl-9-42> 42</a>
</span><span class=lnt id=hl-9-43><a class=lnlinks href=#hl-9-43> 43</a>
</span><span class=lnt id=hl-9-44><a class=lnlinks href=#hl-9-44> 44</a>
</span><span class=lnt id=hl-9-45><a class=lnlinks href=#hl-9-45> 45</a>
</span><span class=lnt id=hl-9-46><a class=lnlinks href=#hl-9-46> 46</a>
</span><span class=lnt id=hl-9-47><a class=lnlinks href=#hl-9-47> 47</a>
</span><span class=lnt id=hl-9-48><a class=lnlinks href=#hl-9-48> 48</a>
</span><span class=lnt id=hl-9-49><a class=lnlinks href=#hl-9-49> 49</a>
</span><span class=lnt id=hl-9-50><a class=lnlinks href=#hl-9-50> 50</a>
</span><span class=lnt id=hl-9-51><a class=lnlinks href=#hl-9-51> 51</a>
</span><span class=lnt id=hl-9-52><a class=lnlinks href=#hl-9-52> 52</a>
</span><span class=lnt id=hl-9-53><a class=lnlinks href=#hl-9-53> 53</a>
</span><span class=lnt id=hl-9-54><a class=lnlinks href=#hl-9-54> 54</a>
</span><span class=lnt id=hl-9-55><a class=lnlinks href=#hl-9-55> 55</a>
</span><span class=lnt id=hl-9-56><a class=lnlinks href=#hl-9-56> 56</a>
</span><span class=lnt id=hl-9-57><a class=lnlinks href=#hl-9-57> 57</a>
</span><span class=lnt id=hl-9-58><a class=lnlinks href=#hl-9-58> 58</a>
</span><span class=lnt id=hl-9-59><a class=lnlinks href=#hl-9-59> 59</a>
</span><span class=lnt id=hl-9-60><a class=lnlinks href=#hl-9-60> 60</a>
</span><span class=lnt id=hl-9-61><a class=lnlinks href=#hl-9-61> 61</a>
</span><span class=lnt id=hl-9-62><a class=lnlinks href=#hl-9-62> 62</a>
</span><span class=lnt id=hl-9-63><a class=lnlinks href=#hl-9-63> 63</a>
</span><span class=lnt id=hl-9-64><a class=lnlinks href=#hl-9-64> 64</a>
</span><span class=lnt id=hl-9-65><a class=lnlinks href=#hl-9-65> 65</a>
</span><span class=lnt id=hl-9-66><a class=lnlinks href=#hl-9-66> 66</a>
</span><span class=lnt id=hl-9-67><a class=lnlinks href=#hl-9-67> 67</a>
</span><span class=lnt id=hl-9-68><a class=lnlinks href=#hl-9-68> 68</a>
</span><span class=lnt id=hl-9-69><a class=lnlinks href=#hl-9-69> 69</a>
</span><span class=lnt id=hl-9-70><a class=lnlinks href=#hl-9-70> 70</a>
</span><span class=lnt id=hl-9-71><a class=lnlinks href=#hl-9-71> 71</a>
</span><span class=lnt id=hl-9-72><a class=lnlinks href=#hl-9-72> 72</a>
</span><span class=lnt id=hl-9-73><a class=lnlinks href=#hl-9-73> 73</a>
</span><span class=lnt id=hl-9-74><a class=lnlinks href=#hl-9-74> 74</a>
</span><span class=lnt id=hl-9-75><a class=lnlinks href=#hl-9-75> 75</a>
</span><span class=lnt id=hl-9-76><a class=lnlinks href=#hl-9-76> 76</a>
</span><span class=lnt id=hl-9-77><a class=lnlinks href=#hl-9-77> 77</a>
</span><span class=lnt id=hl-9-78><a class=lnlinks href=#hl-9-78> 78</a>
</span><span class=lnt id=hl-9-79><a class=lnlinks href=#hl-9-79> 79</a>
</span><span class=lnt id=hl-9-80><a class=lnlinks href=#hl-9-80> 80</a>
</span><span class=lnt id=hl-9-81><a class=lnlinks href=#hl-9-81> 81</a>
</span><span class=lnt id=hl-9-82><a class=lnlinks href=#hl-9-82> 82</a>
</span><span class=lnt id=hl-9-83><a class=lnlinks href=#hl-9-83> 83</a>
</span><span class=lnt id=hl-9-84><a class=lnlinks href=#hl-9-84> 84</a>
</span><span class=lnt id=hl-9-85><a class=lnlinks href=#hl-9-85> 85</a>
</span><span class=lnt id=hl-9-86><a class=lnlinks href=#hl-9-86> 86</a>
</span><span class=lnt id=hl-9-87><a class=lnlinks href=#hl-9-87> 87</a>
</span><span class=lnt id=hl-9-88><a class=lnlinks href=#hl-9-88> 88</a>
</span><span class=lnt id=hl-9-89><a class=lnlinks href=#hl-9-89> 89</a>
</span><span class=lnt id=hl-9-90><a class=lnlinks href=#hl-9-90> 90</a>
</span><span class=lnt id=hl-9-91><a class=lnlinks href=#hl-9-91> 91</a>
</span><span class=lnt id=hl-9-92><a class=lnlinks href=#hl-9-92> 92</a>
</span><span class=lnt id=hl-9-93><a class=lnlinks href=#hl-9-93> 93</a>
</span><span class=lnt id=hl-9-94><a class=lnlinks href=#hl-9-94> 94</a>
</span><span class=lnt id=hl-9-95><a class=lnlinks href=#hl-9-95> 95</a>
</span><span class=lnt id=hl-9-96><a class=lnlinks href=#hl-9-96> 96</a>
</span><span class=lnt id=hl-9-97><a class=lnlinks href=#hl-9-97> 97</a>
</span><span class=lnt id=hl-9-98><a class=lnlinks href=#hl-9-98> 98</a>
</span><span class=lnt id=hl-9-99><a class=lnlinks href=#hl-9-99> 99</a>
</span><span class=lnt id=hl-9-100><a class=lnlinks href=#hl-9-100>100</a>
</span><span class=lnt id=hl-9-101><a class=lnlinks href=#hl-9-101>101</a>
</span><span class=lnt id=hl-9-102><a class=lnlinks href=#hl-9-102>102</a>
</span><span class=lnt id=hl-9-103><a class=lnlinks href=#hl-9-103>103</a>
</span><span class=lnt id=hl-9-104><a class=lnlinks href=#hl-9-104>104</a>
</span><span class=lnt id=hl-9-105><a class=lnlinks href=#hl-9-105>105</a>
</span><span class=lnt id=hl-9-106><a class=lnlinks href=#hl-9-106>106</a>
</span><span class=lnt id=hl-9-107><a class=lnlinks href=#hl-9-107>107</a>
</span><span class=lnt id=hl-9-108><a class=lnlinks href=#hl-9-108>108</a>
</span><span class=lnt id=hl-9-109><a class=lnlinks href=#hl-9-109>109</a>
</span><span class=lnt id=hl-9-110><a class=lnlinks href=#hl-9-110>110</a>
</span><span class=lnt id=hl-9-111><a class=lnlinks href=#hl-9-111>111</a>
</span><span class=lnt id=hl-9-112><a class=lnlinks href=#hl-9-112>112</a>
</span><span class=lnt id=hl-9-113><a class=lnlinks href=#hl-9-113>113</a>
</span><span class=lnt id=hl-9-114><a class=lnlinks href=#hl-9-114>114</a>
</span><span class=lnt id=hl-9-115><a class=lnlinks href=#hl-9-115>115</a>
</span><span class=lnt id=hl-9-116><a class=lnlinks href=#hl-9-116>116</a>
</span><span class=lnt id=hl-9-117><a class=lnlinks href=#hl-9-117>117</a>
</span><span class=lnt id=hl-9-118><a class=lnlinks href=#hl-9-118>118</a>
</span><span class=lnt id=hl-9-119><a class=lnlinks href=#hl-9-119>119</a>
</span><span class=lnt id=hl-9-120><a class=lnlinks href=#hl-9-120>120</a>
</span><span class=lnt id=hl-9-121><a class=lnlinks href=#hl-9-121>121</a>
</span><span class=lnt id=hl-9-122><a class=lnlinks href=#hl-9-122>122</a>
</span><span class=lnt id=hl-9-123><a class=lnlinks href=#hl-9-123>123</a>
</span><span class=lnt id=hl-9-124><a class=lnlinks href=#hl-9-124>124</a>
</span><span class=lnt id=hl-9-125><a class=lnlinks href=#hl-9-125>125</a>
</span><span class=lnt id=hl-9-126><a class=lnlinks href=#hl-9-126>126</a>
</span><span class=lnt id=hl-9-127><a class=lnlinks href=#hl-9-127>127</a>
</span><span class=lnt id=hl-9-128><a class=lnlinks href=#hl-9-128>128</a>
</span><span class=lnt id=hl-9-129><a class=lnlinks href=#hl-9-129>129</a>
</span><span class=lnt id=hl-9-130><a class=lnlinks href=#hl-9-130>130</a>
</span><span class=lnt id=hl-9-131><a class=lnlinks href=#hl-9-131>131</a>
</span><span class=lnt id=hl-9-132><a class=lnlinks href=#hl-9-132>132</a>
</span><span class=lnt id=hl-9-133><a class=lnlinks href=#hl-9-133>133</a>
</span><span class=lnt id=hl-9-134><a class=lnlinks href=#hl-9-134>134</a>
</span><span class=lnt id=hl-9-135><a class=lnlinks href=#hl-9-135>135</a>
</span><span class=lnt id=hl-9-136><a class=lnlinks href=#hl-9-136>136</a>
</span><span class=lnt id=hl-9-137><a class=lnlinks href=#hl-9-137>137</a>
</span><span class=lnt id=hl-9-138><a class=lnlinks href=#hl-9-138>138</a>
</span><span class=lnt id=hl-9-139><a class=lnlinks href=#hl-9-139>139</a>
</span><span class=lnt id=hl-9-140><a class=lnlinks href=#hl-9-140>140</a>
</span><span class=lnt id=hl-9-141><a class=lnlinks href=#hl-9-141>141</a>
</span><span class=lnt id=hl-9-142><a class=lnlinks href=#hl-9-142>142</a>
</span><span class=lnt id=hl-9-143><a class=lnlinks href=#hl-9-143>143</a>
</span><span class=lnt id=hl-9-144><a class=lnlinks href=#hl-9-144>144</a>
</span><span class=lnt id=hl-9-145><a class=lnlinks href=#hl-9-145>145</a>
</span><span class=lnt id=hl-9-146><a class=lnlinks href=#hl-9-146>146</a>
</span><span class=lnt id=hl-9-147><a class=lnlinks href=#hl-9-147>147</a>
</span><span class=lnt id=hl-9-148><a class=lnlinks href=#hl-9-148>148</a>
</span><span class=lnt id=hl-9-149><a class=lnlinks href=#hl-9-149>149</a>
</span><span class=lnt id=hl-9-150><a class=lnlinks href=#hl-9-150>150</a>
</span><span class=lnt id=hl-9-151><a class=lnlinks href=#hl-9-151>151</a>
</span><span class=lnt id=hl-9-152><a class=lnlinks href=#hl-9-152>152</a>
</span><span class=lnt id=hl-9-153><a class=lnlinks href=#hl-9-153>153</a>
</span><span class=lnt id=hl-9-154><a class=lnlinks href=#hl-9-154>154</a>
</span><span class=lnt id=hl-9-155><a class=lnlinks href=#hl-9-155>155</a>
</span><span class=lnt id=hl-9-156><a class=lnlinks href=#hl-9-156>156</a>
</span><span class=lnt id=hl-9-157><a class=lnlinks href=#hl-9-157>157</a>
</span><span class=lnt id=hl-9-158><a class=lnlinks href=#hl-9-158>158</a>
</span><span class=lnt id=hl-9-159><a class=lnlinks href=#hl-9-159>159</a>
</span><span class=lnt id=hl-9-160><a class=lnlinks href=#hl-9-160>160</a>
</span><span class=lnt id=hl-9-161><a class=lnlinks href=#hl-9-161>161</a>
</span><span class=lnt id=hl-9-162><a class=lnlinks href=#hl-9-162>162</a>
</span><span class=lnt id=hl-9-163><a class=lnlinks href=#hl-9-163>163</a>
</span><span class=lnt id=hl-9-164><a class=lnlinks href=#hl-9-164>164</a>
</span><span class=lnt id=hl-9-165><a class=lnlinks href=#hl-9-165>165</a>
</span><span class=lnt id=hl-9-166><a class=lnlinks href=#hl-9-166>166</a>
</span><span class=lnt id=hl-9-167><a class=lnlinks href=#hl-9-167>167</a>
</span><span class=lnt id=hl-9-168><a class=lnlinks href=#hl-9-168>168</a>
</span><span class=lnt id=hl-9-169><a class=lnlinks href=#hl-9-169>169</a>
</span><span class=lnt id=hl-9-170><a class=lnlinks href=#hl-9-170>170</a>
</span><span class=lnt id=hl-9-171><a class=lnlinks href=#hl-9-171>171</a>
</span><span class=lnt id=hl-9-172><a class=lnlinks href=#hl-9-172>172</a>
</span><span class=lnt id=hl-9-173><a class=lnlinks href=#hl-9-173>173</a>
</span><span class=lnt id=hl-9-174><a class=lnlinks href=#hl-9-174>174</a>
</span><span class=lnt id=hl-9-175><a class=lnlinks href=#hl-9-175>175</a>
</span><span class=lnt id=hl-9-176><a class=lnlinks href=#hl-9-176>176</a>
</span><span class=lnt id=hl-9-177><a class=lnlinks href=#hl-9-177>177</a>
</span><span class=lnt id=hl-9-178><a class=lnlinks href=#hl-9-178>178</a>
</span><span class=lnt id=hl-9-179><a class=lnlinks href=#hl-9-179>179</a>
</span><span class=lnt id=hl-9-180><a class=lnlinks href=#hl-9-180>180</a>
</span><span class=lnt id=hl-9-181><a class=lnlinks href=#hl-9-181>181</a>
</span><span class=lnt id=hl-9-182><a class=lnlinks href=#hl-9-182>182</a>
</span><span class=lnt id=hl-9-183><a class=lnlinks href=#hl-9-183>183</a>
</span><span class=lnt id=hl-9-184><a class=lnlinks href=#hl-9-184>184</a>
</span><span class=lnt id=hl-9-185><a class=lnlinks href=#hl-9-185>185</a>
</span><span class=lnt id=hl-9-186><a class=lnlinks href=#hl-9-186>186</a>
</span><span class=lnt id=hl-9-187><a class=lnlinks href=#hl-9-187>187</a>
</span><span class=lnt id=hl-9-188><a class=lnlinks href=#hl-9-188>188</a>
</span><span class=lnt id=hl-9-189><a class=lnlinks href=#hl-9-189>189</a>
</span><span class=lnt id=hl-9-190><a class=lnlinks href=#hl-9-190>190</a>
</span><span class=lnt id=hl-9-191><a class=lnlinks href=#hl-9-191>191</a>
</span><span class=lnt id=hl-9-192><a class=lnlinks href=#hl-9-192>192</a>
</span><span class=lnt id=hl-9-193><a class=lnlinks href=#hl-9-193>193</a>
</span><span class=lnt id=hl-9-194><a class=lnlinks href=#hl-9-194>194</a>
</span><span class=lnt id=hl-9-195><a class=lnlinks href=#hl-9-195>195</a>
</span><span class=lnt id=hl-9-196><a class=lnlinks href=#hl-9-196>196</a>
</span><span class=lnt id=hl-9-197><a class=lnlinks href=#hl-9-197>197</a>
</span><span class=lnt id=hl-9-198><a class=lnlinks href=#hl-9-198>198</a>
</span><span class=lnt id=hl-9-199><a class=lnlinks href=#hl-9-199>199</a>
</span><span class=lnt id=hl-9-200><a class=lnlinks href=#hl-9-200>200</a>
</span><span class=lnt id=hl-9-201><a class=lnlinks href=#hl-9-201>201</a>
</span><span class=lnt id=hl-9-202><a class=lnlinks href=#hl-9-202>202</a>
</span><span class=lnt id=hl-9-203><a class=lnlinks href=#hl-9-203>203</a>
</span><span class=lnt id=hl-9-204><a class=lnlinks href=#hl-9-204>204</a>
</span><span class=lnt id=hl-9-205><a class=lnlinks href=#hl-9-205>205</a>
</span><span class=lnt id=hl-9-206><a class=lnlinks href=#hl-9-206>206</a>
</span><span class=lnt id=hl-9-207><a class=lnlinks href=#hl-9-207>207</a>
</span><span class=lnt id=hl-9-208><a class=lnlinks href=#hl-9-208>208</a>
</span><span class=lnt id=hl-9-209><a class=lnlinks href=#hl-9-209>209</a>
</span><span class=lnt id=hl-9-210><a class=lnlinks href=#hl-9-210>210</a>
</span><span class=lnt id=hl-9-211><a class=lnlinks href=#hl-9-211>211</a>
</span><span class=lnt id=hl-9-212><a class=lnlinks href=#hl-9-212>212</a>
</span><span class=lnt id=hl-9-213><a class=lnlinks href=#hl-9-213>213</a>
</span><span class=lnt id=hl-9-214><a class=lnlinks href=#hl-9-214>214</a>
</span><span class=lnt id=hl-9-215><a class=lnlinks href=#hl-9-215>215</a>
</span><span class=lnt id=hl-9-216><a class=lnlinks href=#hl-9-216>216</a>
</span><span class=lnt id=hl-9-217><a class=lnlinks href=#hl-9-217>217</a>
</span><span class=lnt id=hl-9-218><a class=lnlinks href=#hl-9-218>218</a>
</span><span class=lnt id=hl-9-219><a class=lnlinks href=#hl-9-219>219</a>
</span><span class=lnt id=hl-9-220><a class=lnlinks href=#hl-9-220>220</a>
</span><span class=lnt id=hl-9-221><a class=lnlinks href=#hl-9-221>221</a>
</span><span class=lnt id=hl-9-222><a class=lnlinks href=#hl-9-222>222</a>
</span><span class=lnt id=hl-9-223><a class=lnlinks href=#hl-9-223>223</a>
</span><span class=lnt id=hl-9-224><a class=lnlinks href=#hl-9-224>224</a>
</span><span class=lnt id=hl-9-225><a class=lnlinks href=#hl-9-225>225</a>
</span><span class=lnt id=hl-9-226><a class=lnlinks href=#hl-9-226>226</a>
</span><span class=lnt id=hl-9-227><a class=lnlinks href=#hl-9-227>227</a>
</span><span class=lnt id=hl-9-228><a class=lnlinks href=#hl-9-228>228</a>
</span><span class=lnt id=hl-9-229><a class=lnlinks href=#hl-9-229>229</a>
</span><span class=lnt id=hl-9-230><a class=lnlinks href=#hl-9-230>230</a>
</span><span class=lnt id=hl-9-231><a class=lnlinks href=#hl-9-231>231</a>
</span><span class=lnt id=hl-9-232><a class=lnlinks href=#hl-9-232>232</a>
</span><span class=lnt id=hl-9-233><a class=lnlinks href=#hl-9-233>233</a>
</span><span class=lnt id=hl-9-234><a class=lnlinks href=#hl-9-234>234</a>
</span><span class=lnt id=hl-9-235><a class=lnlinks href=#hl-9-235>235</a>
</span><span class=lnt id=hl-9-236><a class=lnlinks href=#hl-9-236>236</a>
</span><span class=lnt id=hl-9-237><a class=lnlinks href=#hl-9-237>237</a>
</span><span class=lnt id=hl-9-238><a class=lnlinks href=#hl-9-238>238</a>
</span><span class=lnt id=hl-9-239><a class=lnlinks href=#hl-9-239>239</a>
</span><span class=lnt id=hl-9-240><a class=lnlinks href=#hl-9-240>240</a>
</span><span class=lnt id=hl-9-241><a class=lnlinks href=#hl-9-241>241</a>
</span><span class=lnt id=hl-9-242><a class=lnlinks href=#hl-9-242>242</a>
</span><span class=lnt id=hl-9-243><a class=lnlinks href=#hl-9-243>243</a>
</span><span class=lnt id=hl-9-244><a class=lnlinks href=#hl-9-244>244</a>
</span><span class=lnt id=hl-9-245><a class=lnlinks href=#hl-9-245>245</a>
</span><span class=lnt id=hl-9-246><a class=lnlinks href=#hl-9-246>246</a>
</span><span class=lnt id=hl-9-247><a class=lnlinks href=#hl-9-247>247</a>
</span><span class=lnt id=hl-9-248><a class=lnlinks href=#hl-9-248>248</a>
</span><span class=lnt id=hl-9-249><a class=lnlinks href=#hl-9-249>249</a>
</span><span class=lnt id=hl-9-250><a class=lnlinks href=#hl-9-250>250</a>
</span><span class=lnt id=hl-9-251><a class=lnlinks href=#hl-9-251>251</a>
</span><span class=lnt id=hl-9-252><a class=lnlinks href=#hl-9-252>252</a>
</span><span class=lnt id=hl-9-253><a class=lnlinks href=#hl-9-253>253</a>
</span><span class=lnt id=hl-9-254><a class=lnlinks href=#hl-9-254>254</a>
</span><span class=lnt id=hl-9-255><a class=lnlinks href=#hl-9-255>255</a>
</span><span class=lnt id=hl-9-256><a class=lnlinks href=#hl-9-256>256</a>
</span><span class=lnt id=hl-9-257><a class=lnlinks href=#hl-9-257>257</a>
</span><span class=lnt id=hl-9-258><a class=lnlinks href=#hl-9-258>258</a>
</span><span class=lnt id=hl-9-259><a class=lnlinks href=#hl-9-259>259</a>
</span><span class=lnt id=hl-9-260><a class=lnlinks href=#hl-9-260>260</a>
</span><span class=lnt id=hl-9-261><a class=lnlinks href=#hl-9-261>261</a>
</span><span class=lnt id=hl-9-262><a class=lnlinks href=#hl-9-262>262</a>
</span><span class=lnt id=hl-9-263><a class=lnlinks href=#hl-9-263>263</a>
</span><span class=lnt id=hl-9-264><a class=lnlinks href=#hl-9-264>264</a>
</span><span class=lnt id=hl-9-265><a class=lnlinks href=#hl-9-265>265</a>
</span><span class=lnt id=hl-9-266><a class=lnlinks href=#hl-9-266>266</a>
</span><span class=lnt id=hl-9-267><a class=lnlinks href=#hl-9-267>267</a>
</span><span class=lnt id=hl-9-268><a class=lnlinks href=#hl-9-268>268</a>
</span><span class=lnt id=hl-9-269><a class=lnlinks href=#hl-9-269>269</a>
</span><span class=lnt id=hl-9-270><a class=lnlinks href=#hl-9-270>270</a>
</span><span class=lnt id=hl-9-271><a class=lnlinks href=#hl-9-271>271</a>
</span><span class=lnt id=hl-9-272><a class=lnlinks href=#hl-9-272>272</a>
</span><span class=lnt id=hl-9-273><a class=lnlinks href=#hl-9-273>273</a>
</span><span class=lnt id=hl-9-274><a class=lnlinks href=#hl-9-274>274</a>
</span><span class=lnt id=hl-9-275><a class=lnlinks href=#hl-9-275>275</a>
</span><span class=lnt id=hl-9-276><a class=lnlinks href=#hl-9-276>276</a>
</span><span class=lnt id=hl-9-277><a class=lnlinks href=#hl-9-277>277</a>
</span><span class=lnt id=hl-9-278><a class=lnlinks href=#hl-9-278>278</a>
</span><span class=lnt id=hl-9-279><a class=lnlinks href=#hl-9-279>279</a>
</span><span class=lnt id=hl-9-280><a class=lnlinks href=#hl-9-280>280</a>
</span><span class=lnt id=hl-9-281><a class=lnlinks href=#hl-9-281>281</a>
</span><span class=lnt id=hl-9-282><a class=lnlinks href=#hl-9-282>282</a>
</span><span class=lnt id=hl-9-283><a class=lnlinks href=#hl-9-283>283</a>
</span><span class=lnt id=hl-9-284><a class=lnlinks href=#hl-9-284>284</a>
</span><span class=lnt id=hl-9-285><a class=lnlinks href=#hl-9-285>285</a>
</span><span class=lnt id=hl-9-286><a class=lnlinks href=#hl-9-286>286</a>
</span><span class=lnt id=hl-9-287><a class=lnlinks href=#hl-9-287>287</a>
</span><span class=lnt id=hl-9-288><a class=lnlinks href=#hl-9-288>288</a>
</span><span class=lnt id=hl-9-289><a class=lnlinks href=#hl-9-289>289</a>
</span><span class=lnt id=hl-9-290><a class=lnlinks href=#hl-9-290>290</a>
</span><span class=lnt id=hl-9-291><a class=lnlinks href=#hl-9-291>291</a>
</span><span class=lnt id=hl-9-292><a class=lnlinks href=#hl-9-292>292</a>
</span><span class=lnt id=hl-9-293><a class=lnlinks href=#hl-9-293>293</a>
</span><span class=lnt id=hl-9-294><a class=lnlinks href=#hl-9-294>294</a>
</span><span class=lnt id=hl-9-295><a class=lnlinks href=#hl-9-295>295</a>
</span><span class=lnt id=hl-9-296><a class=lnlinks href=#hl-9-296>296</a>
</span><span class=lnt id=hl-9-297><a class=lnlinks href=#hl-9-297>297</a>
</span><span class=lnt id=hl-9-298><a class=lnlinks href=#hl-9-298>298</a>
</span><span class=lnt id=hl-9-299><a class=lnlinks href=#hl-9-299>299</a>
</span><span class=lnt id=hl-9-300><a class=lnlinks href=#hl-9-300>300</a>
</span><span class=lnt id=hl-9-301><a class=lnlinks href=#hl-9-301>301</a>
</span><span class=lnt id=hl-9-302><a class=lnlinks href=#hl-9-302>302</a>
</span><span class=lnt id=hl-9-303><a class=lnlinks href=#hl-9-303>303</a>
</span><span class=lnt id=hl-9-304><a class=lnlinks href=#hl-9-304>304</a>
</span><span class=lnt id=hl-9-305><a class=lnlinks href=#hl-9-305>305</a>
</span><span class=lnt id=hl-9-306><a class=lnlinks href=#hl-9-306>306</a>
</span><span class=lnt id=hl-9-307><a class=lnlinks href=#hl-9-307>307</a>
</span><span class=lnt id=hl-9-308><a class=lnlinks href=#hl-9-308>308</a>
</span><span class=lnt id=hl-9-309><a class=lnlinks href=#hl-9-309>309</a>
</span><span class=lnt id=hl-9-310><a class=lnlinks href=#hl-9-310>310</a>
</span><span class=lnt id=hl-9-311><a class=lnlinks href=#hl-9-311>311</a>
</span><span class=lnt id=hl-9-312><a class=lnlinks href=#hl-9-312>312</a>
</span><span class=lnt id=hl-9-313><a class=lnlinks href=#hl-9-313>313</a>
</span><span class=lnt id=hl-9-314><a class=lnlinks href=#hl-9-314>314</a>
</span><span class=lnt id=hl-9-315><a class=lnlinks href=#hl-9-315>315</a>
</span><span class=lnt id=hl-9-316><a class=lnlinks href=#hl-9-316>316</a>
</span><span class=lnt id=hl-9-317><a class=lnlinks href=#hl-9-317>317</a>
</span><span class=lnt id=hl-9-318><a class=lnlinks href=#hl-9-318>318</a>
</span><span class=lnt id=hl-9-319><a class=lnlinks href=#hl-9-319>319</a>
</span><span class=lnt id=hl-9-320><a class=lnlinks href=#hl-9-320>320</a>
</span><span class=lnt id=hl-9-321><a class=lnlinks href=#hl-9-321>321</a>
</span><span class=lnt id=hl-9-322><a class=lnlinks href=#hl-9-322>322</a>
</span><span class=lnt id=hl-9-323><a class=lnlinks href=#hl-9-323>323</a>
</span><span class=lnt id=hl-9-324><a class=lnlinks href=#hl-9-324>324</a>
</span><span class=lnt id=hl-9-325><a class=lnlinks href=#hl-9-325>325</a>
</span><span class=lnt id=hl-9-326><a class=lnlinks href=#hl-9-326>326</a>
</span><span class=lnt id=hl-9-327><a class=lnlinks href=#hl-9-327>327</a>
</span><span class=lnt id=hl-9-328><a class=lnlinks href=#hl-9-328>328</a>
</span><span class=lnt id=hl-9-329><a class=lnlinks href=#hl-9-329>329</a>
</span><span class=lnt id=hl-9-330><a class=lnlinks href=#hl-9-330>330</a>
</span><span class=lnt id=hl-9-331><a class=lnlinks href=#hl-9-331>331</a>
</span><span class=lnt id=hl-9-332><a class=lnlinks href=#hl-9-332>332</a>
</span><span class=lnt id=hl-9-333><a class=lnlinks href=#hl-9-333>333</a>
</span><span class=lnt id=hl-9-334><a class=lnlinks href=#hl-9-334>334</a>
</span><span class=lnt id=hl-9-335><a class=lnlinks href=#hl-9-335>335</a>
</span><span class=lnt id=hl-9-336><a class=lnlinks href=#hl-9-336>336</a>
</span><span class=lnt id=hl-9-337><a class=lnlinks href=#hl-9-337>337</a>
</span><span class=lnt id=hl-9-338><a class=lnlinks href=#hl-9-338>338</a>
</span><span class=lnt id=hl-9-339><a class=lnlinks href=#hl-9-339>339</a>
</span><span class=lnt id=hl-9-340><a class=lnlinks href=#hl-9-340>340</a>
</span><span class=lnt id=hl-9-341><a class=lnlinks href=#hl-9-341>341</a>
</span><span class=lnt id=hl-9-342><a class=lnlinks href=#hl-9-342>342</a>
</span><span class=lnt id=hl-9-343><a class=lnlinks href=#hl-9-343>343</a>
</span><span class=lnt id=hl-9-344><a class=lnlinks href=#hl-9-344>344</a>
</span><span class=lnt id=hl-9-345><a class=lnlinks href=#hl-9-345>345</a>
</span><span class=lnt id=hl-9-346><a class=lnlinks href=#hl-9-346>346</a>
</span><span class=lnt id=hl-9-347><a class=lnlinks href=#hl-9-347>347</a>
</span><span class=lnt id=hl-9-348><a class=lnlinks href=#hl-9-348>348</a>
</span><span class=lnt id=hl-9-349><a class=lnlinks href=#hl-9-349>349</a>
</span><span class=lnt id=hl-9-350><a class=lnlinks href=#hl-9-350>350</a>
</span><span class=lnt id=hl-9-351><a class=lnlinks href=#hl-9-351>351</a>
</span><span class=lnt id=hl-9-352><a class=lnlinks href=#hl-9-352>352</a>
</span><span class=lnt id=hl-9-353><a class=lnlinks href=#hl-9-353>353</a>
</span><span class=lnt id=hl-9-354><a class=lnlinks href=#hl-9-354>354</a>
</span><span class=lnt id=hl-9-355><a class=lnlinks href=#hl-9-355>355</a>
</span><span class=lnt id=hl-9-356><a class=lnlinks href=#hl-9-356>356</a>
</span><span class=lnt id=hl-9-357><a class=lnlinks href=#hl-9-357>357</a>
</span><span class=lnt id=hl-9-358><a class=lnlinks href=#hl-9-358>358</a>
</span><span class=lnt id=hl-9-359><a class=lnlinks href=#hl-9-359>359</a>
</span><span class=lnt id=hl-9-360><a class=lnlinks href=#hl-9-360>360</a>
</span><span class=lnt id=hl-9-361><a class=lnlinks href=#hl-9-361>361</a>
</span><span class=lnt id=hl-9-362><a class=lnlinks href=#hl-9-362>362</a>
</span><span class=lnt id=hl-9-363><a class=lnlinks href=#hl-9-363>363</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>Data-Centric Architecture 구현 예시
</span></span></span><span class=line><span class=cl><span class=s2>Repository Pattern과 Data Access Layer를 중심으로 구현
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABC</span><span class=p>,</span> <span class=n>abstractmethod</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span><span class=p>,</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>Any</span><span class=p>,</span> <span class=n>Optional</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>asyncio</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dataclasses</span> <span class=kn>import</span> <span class=n>dataclass</span><span class=p>,</span> <span class=n>asdict</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 도메인 모델 정의</span>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Customer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;고객 도메인 모델 - 데이터 중심 설계의 핵심 엔티티&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>email</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>created_at</span><span class=p>:</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>    <span class=n>last_updated</span><span class=p>:</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>to_dict</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;딕셔너리 변환 - 데이터 교환 표준화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>asdict</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Order</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;주문 도메인 모델&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>amount</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>status</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>created_at</span><span class=p>:</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>to_dict</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>asdict</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Repository Pattern 구현 - 데이터 접근 추상화</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Repository</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;추상 저장소 인터페이스 - 데이터 접근 방식 표준화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>create</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>entity</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;엔티티 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>get_by_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>entity_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;ID로 엔티티 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>update</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>entity</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;엔티티 업데이트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>delete</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>entity_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;엔티티 삭제&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CustomerRepository</span><span class=p>(</span><span class=n>Repository</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;고객 저장소 구현 - 공유 데이터 모델 활용&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data_access_layer</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>dal</span> <span class=o>=</span> <span class=n>data_access_layer</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>collection_name</span> <span class=o>=</span> <span class=s2>&#34;customers&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>create</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>customer</span><span class=p>:</span> <span class=n>Customer</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;고객 데이터 생성 - 표준화된 접근&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>customer</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>dal</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>collection_name</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>get_by_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Customer</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;고객 ID로 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>dal</span><span class=o>.</span><span class=n>find_by_id</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>collection_name</span><span class=p>,</span> <span class=n>customer_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Customer</span><span class=p>(</span><span class=o>**</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>get_by_email</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>email</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Customer</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;이메일로 고객 조회 - 비즈니스 로직 캡슐화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>dal</span><span class=o>.</span><span class=n>find_by_field</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>collection_name</span><span class=p>,</span> <span class=s2>&#34;email&#34;</span><span class=p>,</span> <span class=n>email</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Customer</span><span class=p>(</span><span class=o>**</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>update</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>customer</span><span class=p>:</span> <span class=n>Customer</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;고객 정보 업데이트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>customer</span><span class=o>.</span><span class=n>last_updated</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>customer</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>dal</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>collection_name</span><span class=p>,</span> <span class=n>customer</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>delete</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;고객 삭제&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>dal</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>collection_name</span><span class=p>,</span> <span class=n>customer_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderRepository</span><span class=p>(</span><span class=n>Repository</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;주문 저장소 구현&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data_access_layer</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>dal</span> <span class=o>=</span> <span class=n>data_access_layer</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>collection_name</span> <span class=o>=</span> <span class=s2>&#34;orders&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>create</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order</span><span class=p>:</span> <span class=n>Order</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>order</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>dal</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>collection_name</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>get_by_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Order</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>dal</span><span class=o>.</span><span class=n>find_by_id</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>collection_name</span><span class=p>,</span> <span class=n>order_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Order</span><span class=p>(</span><span class=o>**</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>get_by_customer_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Order</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;고객별 주문 목록 조회 - 관계형 데이터 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>data_list</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>dal</span><span class=o>.</span><span class=n>find_by_field</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>collection_name</span><span class=p>,</span> <span class=s2>&#34;customer_id&#34;</span><span class=p>,</span> <span class=n>customer_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span><span class=n>Order</span><span class=p>(</span><span class=o>**</span><span class=n>data</span><span class=p>)</span> <span class=k>for</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>data_list</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>update</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order</span><span class=p>:</span> <span class=n>Order</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>order</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>dal</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>collection_name</span><span class=p>,</span> <span class=n>order</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>delete</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>dal</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>collection_name</span><span class=p>,</span> <span class=n>order_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Data Access Layer - 데이터 접근 통합 계층</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DataAccessLayer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;데이터 접근 계층 - 다양한 데이터 소스 통합&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 실제 구현에서는 데이터베이스 연결 설정</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># 메모리 저장소 (데모용)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_metadata</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># 메타데이터 저장</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_event_handlers</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># 이벤트 핸들러</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>insert</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>collection</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터 삽입 - 표준화된 인터페이스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>collection</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span><span class=p>[</span><span class=n>collection</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>entity_id</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_storage</span><span class=p>[</span><span class=n>collection</span><span class=p>])</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span><span class=p>[</span><span class=n>collection</span><span class=p>][</span><span class=n>entity_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 메타데이터 업데이트</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_update_metadata</span><span class=p>(</span><span class=n>collection</span><span class=p>,</span> <span class=s1>&#39;insert&#39;</span><span class=p>,</span> <span class=n>entity_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 이벤트 발행 - 데이터 변경 알림</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_publish_event</span><span class=p>(</span><span class=s1>&#39;data_inserted&#39;</span><span class=p>,</span> <span class=n>collection</span><span class=p>,</span> <span class=n>entity_id</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>entity_id</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>find_by_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>collection</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>entity_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;ID로 데이터 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>collection</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span> <span class=ow>and</span> <span class=n>entity_id</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span><span class=p>[</span><span class=n>collection</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span><span class=p>[</span><span class=n>collection</span><span class=p>][</span><span class=n>entity_id</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>find_by_field</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>collection</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>field</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;필드 값으로 데이터 조회 - 유연한 쿼리 지원&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>collection</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>data</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span><span class=p>[</span><span class=n>collection</span><span class=p>]</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>field</span><span class=p>)</span> <span class=o>==</span> <span class=n>value</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>results</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>results</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>update</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>collection</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>entity_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터 업데이트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>collection</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span> <span class=ow>and</span> <span class=n>entity_id</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span><span class=p>[</span><span class=n>collection</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>old_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span><span class=p>[</span><span class=n>collection</span><span class=p>][</span><span class=n>entity_id</span><span class=p>]</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span><span class=p>[</span><span class=n>collection</span><span class=p>][</span><span class=n>entity_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_update_metadata</span><span class=p>(</span><span class=n>collection</span><span class=p>,</span> <span class=s1>&#39;update&#39;</span><span class=p>,</span> <span class=n>entity_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_publish_event</span><span class=p>(</span><span class=s1>&#39;data_updated&#39;</span><span class=p>,</span> <span class=n>collection</span><span class=p>,</span> <span class=n>entity_id</span><span class=p>,</span> <span class=n>data</span><span class=p>,</span> <span class=n>old_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>delete</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>collection</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>entity_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터 삭제&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>collection</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span> <span class=ow>and</span> <span class=n>entity_id</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span><span class=p>[</span><span class=n>collection</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>deleted_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_storage</span><span class=p>[</span><span class=n>collection</span><span class=p>]</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=n>entity_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_update_metadata</span><span class=p>(</span><span class=n>collection</span><span class=p>,</span> <span class=s1>&#39;delete&#39;</span><span class=p>,</span> <span class=n>entity_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_publish_event</span><span class=p>(</span><span class=s1>&#39;data_deleted&#39;</span><span class=p>,</span> <span class=n>collection</span><span class=p>,</span> <span class=n>entity_id</span><span class=p>,</span> <span class=n>deleted_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>_update_metadata</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>collection</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>operation</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>entity_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;메타데이터 업데이트 - 데이터 계보 추적&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>collection</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_metadata</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_metadata</span><span class=p>[</span><span class=n>collection</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;total_records&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;operations&#39;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;last_updated&#39;</span><span class=p>:</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_metadata</span><span class=p>[</span><span class=n>collection</span><span class=p>][</span><span class=s1>&#39;operations&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;operation&#39;</span><span class=p>:</span> <span class=n>operation</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;entity_id&#39;</span><span class=p>:</span> <span class=n>entity_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_metadata</span><span class=p>[</span><span class=n>collection</span><span class=p>][</span><span class=s1>&#39;last_updated&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>operation</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;insert&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_metadata</span><span class=p>[</span><span class=n>collection</span><span class=p>][</span><span class=s1>&#39;total_records&#39;</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>operation</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;delete&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_metadata</span><span class=p>[</span><span class=n>collection</span><span class=p>][</span><span class=s1>&#39;total_records&#39;</span><span class=p>]</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>_publish_event</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_type</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>collection</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>entity_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                           <span class=n>data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=n>old_data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;이벤트 발행 - 데이터 변경 알림&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>event</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=n>event_type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;collection&#39;</span><span class=p>:</span> <span class=n>collection</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;entity_id&#39;</span><span class=p>:</span> <span class=n>entity_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=n>data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;old_data&#39;</span><span class=p>:</span> <span class=n>old_data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 등록된 이벤트 핸들러들에게 알림</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>handler</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_event_handlers</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=n>handler</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_event_handler</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>handler</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;이벤트 핸들러 등록&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_event_handlers</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>handler</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_metadata</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>collection</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;메타데이터 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>collection</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>collection</span><span class=p>,</span> <span class=p>{})</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_metadata</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 비즈니스 서비스 레이어 - 도메인 로직 구현</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CustomerService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;고객 서비스 - 비즈니스 로직 구현&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>customer_repo</span><span class=p>:</span> <span class=n>CustomerRepository</span><span class=p>,</span> <span class=n>order_repo</span><span class=p>:</span> <span class=n>OrderRepository</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>customer_repo</span> <span class=o>=</span> <span class=n>customer_repo</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>order_repo</span> <span class=o>=</span> <span class=n>order_repo</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>create_customer</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>email</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Customer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;고객 생성 - 비즈니스 규칙 적용&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 중복 이메일 검사</span>
</span></span><span class=line><span class=cl>        <span class=n>existing</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>customer_repo</span><span class=o>.</span><span class=n>get_by_email</span><span class=p>(</span><span class=n>email</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>existing</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Customer with email </span><span class=si>{</span><span class=n>email</span><span class=si>}</span><span class=s2> already exists&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>customer</span> <span class=o>=</span> <span class=n>Customer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nb>id</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;cust_</span><span class=si>{</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>timestamp</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>name</span><span class=o>=</span><span class=n>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>email</span><span class=o>=</span><span class=n>email</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>created_at</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>last_updated</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>customer_repo</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>customer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>customer</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>get_customer_with_orders</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;고객과 주문 정보 통합 조회 - 데이터 조합&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>customer</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>customer_repo</span><span class=o>.</span><span class=n>get_by_id</span><span class=p>(</span><span class=n>customer_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>customer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>orders</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>order_repo</span><span class=o>.</span><span class=n>get_by_customer_id</span><span class=p>(</span><span class=n>customer_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;customer&#39;</span><span class=p>:</span> <span class=n>customer</span><span class=o>.</span><span class=n>to_dict</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;orders&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>order</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span> <span class=k>for</span> <span class=n>order</span> <span class=ow>in</span> <span class=n>orders</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_orders&#39;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>orders</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_amount&#39;</span><span class=p>:</span> <span class=nb>sum</span><span class=p>(</span><span class=n>order</span><span class=o>.</span><span class=n>amount</span> <span class=k>for</span> <span class=n>order</span> <span class=ow>in</span> <span class=n>orders</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 이벤트 핸들러 - 데이터 변경 처리</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>audit_event_handler</span><span class=p>(</span><span class=n>event</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;감사 로그 핸들러 - 데이터 변경 추적&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;AUDIT: </span><span class=si>{</span><span class=n>event</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> on </span><span class=si>{</span><span class=n>event</span><span class=p>[</span><span class=s1>&#39;collection&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>event</span><span class=p>[</span><span class=s1>&#39;entity_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> at </span><span class=si>{</span><span class=n>event</span><span class=p>[</span><span class=s1>&#39;timestamp&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>cache_invalidation_handler</span><span class=p>(</span><span class=n>event</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;캐시 무효화 핸들러 - 데이터 일관성 보장&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;CACHE: Invalidating cache for </span><span class=si>{</span><span class=n>event</span><span class=p>[</span><span class=s1>&#39;collection&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>event</span><span class=p>[</span><span class=s1>&#39;entity_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 데모 실행 함수</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>demo_data_centric_architecture</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;데이터 중심 아키텍처 데모&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 데이터 접근 계층 초기화</span>
</span></span><span class=line><span class=cl>    <span class=n>dal</span> <span class=o>=</span> <span class=n>DataAccessLayer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 이벤트 핸들러 등록</span>
</span></span><span class=line><span class=cl>    <span class=n>dal</span><span class=o>.</span><span class=n>add_event_handler</span><span class=p>(</span><span class=n>audit_event_handler</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>dal</span><span class=o>.</span><span class=n>add_event_handler</span><span class=p>(</span><span class=n>cache_invalidation_handler</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 저장소 초기화</span>
</span></span><span class=line><span class=cl>    <span class=n>customer_repo</span> <span class=o>=</span> <span class=n>CustomerRepository</span><span class=p>(</span><span class=n>dal</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>order_repo</span> <span class=o>=</span> <span class=n>OrderRepository</span><span class=p>(</span><span class=n>dal</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 서비스 초기화</span>
</span></span><span class=line><span class=cl>    <span class=n>customer_service</span> <span class=o>=</span> <span class=n>CustomerService</span><span class=p>(</span><span class=n>customer_repo</span><span class=p>,</span> <span class=n>order_repo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=== Data-Centric Architecture 데모 시작 ===</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 1. 고객 생성</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;1. 고객 생성&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>customer</span> <span class=o>=</span> <span class=k>await</span> <span class=n>customer_service</span><span class=o>.</span><span class=n>create_customer</span><span class=p>(</span><span class=s2>&#34;홍길동&#34;</span><span class=p>,</span> <span class=s2>&#34;hong@example.com&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;생성된 고객: </span><span class=si>{</span><span class=n>customer</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>customer</span><span class=o>.</span><span class=n>email</span><span class=si>}</span><span class=s2>)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 2. 주문 생성</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>2. 주문 생성&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>order1</span> <span class=o>=</span> <span class=n>Order</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nb>id</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;order_1_</span><span class=si>{</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>timestamp</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>customer_id</span><span class=o>=</span><span class=n>customer</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>amount</span><span class=o>=</span><span class=mf>150000.0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>status</span><span class=o>=</span><span class=s2>&#34;completed&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>created_at</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>order_repo</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>order1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;생성된 주문: </span><span class=si>{</span><span class=n>order1</span><span class=o>.</span><span class=n>id</span><span class=si>}</span><span class=s2> - </span><span class=si>{</span><span class=n>order1</span><span class=o>.</span><span class=n>amount</span><span class=si>}</span><span class=s2>원&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>order2</span> <span class=o>=</span> <span class=n>Order</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nb>id</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;order_2_</span><span class=si>{</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>timestamp</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>customer_id</span><span class=o>=</span><span class=n>customer</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>amount</span><span class=o>=</span><span class=mf>75000.0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>status</span><span class=o>=</span><span class=s2>&#34;pending&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>created_at</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>order_repo</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>order2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;생성된 주문: </span><span class=si>{</span><span class=n>order2</span><span class=o>.</span><span class=n>id</span><span class=si>}</span><span class=s2> - </span><span class=si>{</span><span class=n>order2</span><span class=o>.</span><span class=n>amount</span><span class=si>}</span><span class=s2>원&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 3. 통합 데이터 조회</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>3. 고객과 주문 통합 조회&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>customer_data</span> <span class=o>=</span> <span class=k>await</span> <span class=n>customer_service</span><span class=o>.</span><span class=n>get_customer_with_orders</span><span class=p>(</span><span class=n>customer</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;고객: </span><span class=si>{</span><span class=n>customer_data</span><span class=p>[</span><span class=s1>&#39;customer&#39;</span><span class=p>][</span><span class=s1>&#39;name&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;총 주문 수: </span><span class=si>{</span><span class=n>customer_data</span><span class=p>[</span><span class=s1>&#39;total_orders&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;총 주문 금액: </span><span class=si>{</span><span class=n>customer_data</span><span class=p>[</span><span class=s1>&#39;total_amount&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>원&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 4. 메타데이터 조회</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>4. 메타데이터 정보&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>customers_meta</span> <span class=o>=</span> <span class=n>dal</span><span class=o>.</span><span class=n>get_metadata</span><span class=p>(</span><span class=s1>&#39;customers&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>orders_meta</span> <span class=o>=</span> <span class=n>dal</span><span class=o>.</span><span class=n>get_metadata</span><span class=p>(</span><span class=s1>&#39;orders&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;고객 컬렉션: </span><span class=si>{</span><span class=n>customers_meta</span><span class=p>[</span><span class=s1>&#39;total_records&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>개 레코드&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;주문 컬렉션: </span><span class=si>{</span><span class=n>orders_meta</span><span class=p>[</span><span class=s1>&#39;total_records&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>개 레코드&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>=== 데모 완료 ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;customer&#39;</span><span class=p>:</span> <span class=n>customer</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;orders&#39;</span><span class=p>:</span> <span class=p>[</span><span class=n>order1</span><span class=p>,</span> <span class=n>order2</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;metadata&#39;</span><span class=p>:</span> <span class=n>dal</span><span class=o>.</span><span class=n>get_metadata</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메인 실행</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 비동기 실행</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>demo_data_centric_architecture</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>최종 결과:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;생성된 고객 ID: </span><span class=si>{</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;customer&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;생성된 주문 수: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;orders&#39;</span><span class=p>])</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;전체 메타데이터: </span><span class=si>{</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>result</span><span class=p>[</span><span class=s1>&#39;metadata&#39;</span><span class=p>],</span> <span class=n>indent</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>ensure_ascii</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=python--kafka-기반-간단-모델>Python + Kafka 기반 간단 모델<a hidden class=anchor aria-hidden=true href=#python--kafka-기반-간단-모델>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span><span class=lnt id=hl-10-16><a class=lnlinks href=#hl-10-16>16</a>
</span><span class=lnt id=hl-10-17><a class=lnlinks href=#hl-10-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaConsumer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kafka로부터 사용자 이벤트 수신</span>
</span></span><span class=line><span class=cl><span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;user-events&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;kafka-broker:9092&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>value_deserializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>msg</span> <span class=ow>in</span> <span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>event</span> <span class=o>=</span> <span class=n>msg</span><span class=o>.</span><span class=n>value</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;product_click&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>product_id</span> <span class=o>=</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;product_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>user_id</span> <span class=o>=</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=c1># 간단한 추천 로직 (캐시 예시)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;사용자 </span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>가 클릭한 상품: </span><span class=si>{</span><span class=n>product_id</span><span class=si>}</span><span class=s2> -&gt; 추천 업데이트&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Kafka 를 통해 실시간 사용자 이벤트 수신</li><li>특정 이벤트에 반응하여 추천 시스템에 반영</li><li>이벤트 중심 처리 흐름 및 스키마 정의 기반 아키텍처의 핵심 구현</li></ul><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>고려사항</strong></th><th><strong>주의할 점</strong></th><th><strong>권장 사항</strong></th></tr></thead><tbody><tr><td><strong>1. 데이터 품질 및 스키마 관리</strong></td><td>데이터 품질 관리 강화</td><td>데이터 오류가 전체 흐름에 영향</td><td>사전 정제, 유효성 검증, 품질 대시보드 구축</td></tr><tr><td></td><td>스키마 관리 및 진화</td><td>스키마 변경 시 하위 시스템 장애</td><td>Schema Registry, 스키마 버저닝 적용</td></tr><tr><td></td><td>메타데이터 관리</td><td>관리되지 않는 메타데이터의 신뢰성 저하</td><td>자동화 수집 도구 도입 (예: DataHub, Amundsen)</td></tr><tr><td><strong>2. 보안 및 접근 제어</strong></td><td>데이터 접근 권한 분리</td><td>민감 정보 노출 위험</td><td>Role-Based Access Control(RBAC), Attribute-Based Access Control(ABAC) 적용</td></tr><tr><td></td><td>제로 트러스트 보안 모델 적용</td><td>중앙 집중형 구조의 보안 취약점</td><td>다중 인증, 암호화 저장, 감사 로그 필수</td></tr><tr><td><strong>3. 확장성 및 성능</strong></td><td>클라우드 네이티브 확장성 설계</td><td>특정 CSP 종속성 (Vendor Lock-in)</td><td>멀티 클라우드/하이브리드 아키텍처 고려</td></tr><tr><td></td><td>스트리밍/분석 성능 부하 관리</td><td>실시간 처리 시 병목 및 처리 지연 발생</td><td>Flink, Spark 등의 분산 처리 프레임워크 활용</td></tr><tr><td></td><td>캐싱 전략</td><td>캐시 일관성 문제, TTL 누락</td><td>적절한 TTL 및 무효화 정책 설정</td></tr><tr><td><strong>4. 운영 및 모니터링</strong></td><td>실시간 관찰성 확보</td><td>과도한 로깅으로 시스템 성능 저하</td><td>로그 샘플링, 지표 기반 알람, 트레이싱 (OpenTelemetry) 구성</td></tr><tr><td></td><td>서비스 간 연동 구조 관리</td><td>서비스 종속성 증가로 유지보수 복잡도 증가</td><td>이벤트 버스 기반 비동기 통신 구조 (EventBridge, Kafka 등) 적용</td></tr><tr><td><strong>5. 거버넌스 및 표준화</strong></td><td>데이터 거버넌스 체계 구축</td><td>과도한 규제 도입 시 개발 생산성 저하</td><td>메타데이터 표준화, 정책 기반 접근 제어, 점진적 거버넌스 도입</td></tr><tr><td></td><td>표준 기술 스택 채택</td><td>최신 기술에 대한 무분별한 도입</td><td>실증된 오픈소스 기술 및 클라우드 네이티브 기술 우선 고려</td></tr><tr><td><strong>6. 도입 및 마이그레이션</strong></td><td>단계적 도입 및 전환 전략</td><td>빅뱅식 전환 시 서비스 중단, 실패 위험</td><td>MVP 기반 반복적 확장, A/B 테스트, 이중화 전환 구간 설정</td></tr><tr><td><strong>7. 조직/문화적 요소</strong></td><td>조직 저항 극복 및 문화 전환</td><td>기존 프로세스와의 충돌, 내부 반발</td><td>조직 변화 관리, 교육/워크숍, 협업 기반 데이터 전략 수립</td></tr></tbody></table><h3 id=최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>📂 카테고리</th><th>최적화 요소</th><th>주의할 점 또는 리스크</th><th>권장 기법 및 전략</th></tr></thead><tbody><tr><td><strong>1. 성능 최적화</strong></td><td>쿼리 및 데이터 접근 최적화</td><td>복잡한 조인, 비효율적인 필터링</td><td>인덱스 설계, 비정규화, 쿼리 재작성</td></tr><tr><td></td><td>스트리밍 처리 최적화</td><td>백프레셔, 처리 지연</td><td>윈도우 처리, 병렬 컨슈머, 플로우 컨트롤</td></tr><tr><td></td><td>데이터 병렬/분산 처리</td><td>과도한 분산 → 오버헤드 발생 가능</td><td>파티셔닝 + 샤딩, 분산 처리 프레임워크 (Spark 등)</td></tr><tr><td><strong>2. 저장소 및 구조</strong></td><td>데이터 파티셔닝</td><td>파티션 핫스팟 발생 가능</td><td>균등 해시/범위 키 설계, 파티션 회전 전략</td></tr><tr><td></td><td>저장소 유형 선택</td><td>부적절한 포맷 선택 시 쿼리 성능 저하</td><td>컬럼 기반 포맷 (Parquet), 오브젝트 스토리지 조합</td></tr><tr><td></td><td>데이터 수명 관리</td><td>오래된 데이터로 인한 스토리지 비용 증가</td><td>TTL 적용, 데이터 아카이빙, Cold Storage 분리</td></tr><tr><td><strong>3. 메모리/캐싱</strong></td><td>인메모리 캐시 사용</td><td>메모리 사용량 급증, 데이터 동기화 문제</td><td>LRU/LFU 캐시 정책, 캐시 만료 정책 설정</td></tr><tr><td></td><td>인메모리 DB 활용</td><td>전체 데이터 로딩 시 메모리 초과 가능</td><td>필요한 부분만 캐싱, In-Memory + Persistent 조합</td></tr><tr><td><strong>4. 네트워크 및 전송</strong></td><td>데이터 압축 및 전송 최적화</td><td>CPU 오버헤드, 압축 비효율</td><td>적절한 압축률 선택 (e.g., Snappy, Zstd), 네트워크 대역폭 고려</td></tr><tr><td><strong>5. 자동화 및 운영</strong></td><td>데이터 파이프라인 자동화</td><td>과도한 자동화 → 장애 복잡성 증가</td><td>단계적 자동화 도입, 에러 핸들링 포함한 DAG 설계</td></tr><tr><td></td><td>메타데이터 관리</td><td>메타정보 불일치로 파이프라인 분석 어려움</td><td>중앙 메타데이터 카탈로그, 데이터 계보 관리</td></tr><tr><td></td><td>모니터링 및 튜닝</td><td>과소 모니터링 시 성능 이슈 사전 탐지 어려움</td><td>실시간 메트릭 수집, 알람 설정, 성능 분석 도구 연동</td></tr><tr><td><strong>6. 보안 및 규정 대응</strong></td><td>데이터 암호화</td><td>성능 저하, 인증/암호화 누락</td><td>하드웨어 암호화 가속기 사용 (AES-NI 등), 필드 단위 암호화 적용</td></tr><tr><td><strong>7. 동시성 및 아키텍처</strong></td><td>비동기 처리/이벤트 기반 설계</td><td>데드락, 순서 보장 실패</td><td>이벤트 기반 비동기 아키텍처, Idempotency 보장 설계</td></tr><tr><td><strong>8. 데이터 정확성</strong></td><td>데이터 중복 제거</td><td>동일 이벤트 중복 시 분석 왜곡</td><td>고유 ID 기반 중복 제거, 중복 필터 처리 단계 명시</td></tr></tbody></table><h3 id=주목할-내용>주목할 내용<a hidden class=anchor aria-hidden=true href=#주목할-내용>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>주제</strong></th><th><strong>항목</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>1. 아키텍처 설계 원칙</strong></td><td>Data-Centric Architecture</td><td>데이터 중심 설계</td><td>데이터가 서비스, 도메인, 인프라 구조의 중심으로 작동함</td></tr><tr><td></td><td></td><td>모듈화</td><td>데이터 수집, 처리, 저장, 분석을 독립적인 책임 단위로 분리하여 유연성 확보</td></tr><tr><td></td><td></td><td>자동화</td><td>ETL, 이벤트 흐름, 배치 파이프라인 등을 코드 기반으로 자동화하여 유지보수 최소화</td></tr><tr><td></td><td></td><td>보안 및 거버넌스</td><td>데이터 보안, 품질 정책, 규정 준수 등 거버넌스 체계를 아키텍처 구성에 통합</td></tr><tr><td><strong>2. 아키텍처 패턴</strong></td><td>Event Sourcing</td><td>이벤트 기반 상태 관리</td><td>상태를 이벤트로 기록하여 변경 이력 추적 및 감사 로그 확보</td></tr><tr><td></td><td>CQRS</td><td>명령 - 조회 분리</td><td>쓰기 (명령) 와 읽기 (조회) 를 분리하여 각각의 처리 특성에 맞는 최적화 구현</td></tr><tr><td></td><td>Data Mesh</td><td>분산 데이터 도메인 모델</td><td>각 도메인이 데이터를 소유하고 통합된 거버넌스를 통해 협업</td></tr><tr><td><strong>3. 실시간 데이터 처리</strong></td><td>Apache Kafka</td><td>이벤트 스트리밍 플랫폼</td><td>고신뢰 메시지 브로커로 대규모 실시간 데이터 처리 및 통합 인프라로 사용</td></tr><tr><td></td><td>Stream Processing</td><td>실시간 분석 엔진</td><td>Kafka, Flink, Pulsar 등을 통한 이벤트 기반 데이터 분석</td></tr><tr><td></td><td>Serverless</td><td>서버리스 스트림 처리</td><td>Lambda, Firehose 등을 통한 서버 운영 부담 없는 스트림 처리</td></tr><tr><td><strong>4. 분산 데이터 관리 및 저장소</strong></td><td>Data Lake</td><td>원시 데이터 기반 비정형 저장</td><td>정제되지 않은 원시 데이터를 저장하고, 후속 분석에 활용</td></tr><tr><td></td><td>Object Storage</td><td>유연한 저장 구조</td><td>이미지, 로그, 문서 등 다양한 형식의 데이터 저장 및 통합</td></tr><tr><td></td><td>Schema Registry</td><td>스키마 관리 및 버전 호환성</td><td>Avro/Protobuf 기반의 메시지 스키마를 중앙에서 관리 및 유효성 검사 수행</td></tr><tr><td><strong>5. 데이터 분석 및 처리</strong></td><td>Spark / Flink</td><td>분산 분석 프레임워크</td><td>대규모 배치 및 스트림 데이터를 위한 확장 가능한 분석 엔진</td></tr><tr><td></td><td>MLOps</td><td>머신러닝 운영 최적화</td><td>데이터 파이프라인, 모델 훈련, 배포, 버전 관리, Drift 모니터링 등 ML 운영 자동화</td></tr><tr><td><strong>6. 보안 및 접근 제어</strong></td><td>RBAC, 암호화</td><td>데이터 접근 제어</td><td>민감 데이터 보호, 인증/인가 기반의 세밀한 접근 제어 정책 도입</td></tr><tr><td></td><td>Zero Trust</td><td>제로 트러스트 보안 모델</td><td>신뢰 없는 네트워크 가정, 지속적인 인증 검증 및 최소 권한 원칙 적용</td></tr><tr><td><strong>7. 분산 시스템 이해</strong></td><td>CAP Theorem</td><td>일관성 - 가용성 - 분할내성 트레이드오프</td><td>분산 시스템에서 3 가지 속성 중 2 개만 동시에 보장 가능. 시스템 설계시 기준이 되는 이론적 모델</td></tr></tbody></table><h3 id=반드시-학습해야할-내용>반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야할-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>데이터 모델링</td><td>Domain Modeling</td><td>도메인 주도 설계</td><td>비즈니스 도메인을 반영한 데이터 모델 설계</td></tr><tr><td>데이터 모델링</td><td>Semantic Modeling</td><td>의미론적 모델링</td><td>온톨로지와 그래프 기반 데이터 관계 정의</td></tr><tr><td>분산 시스템</td><td>Consensus Algorithms</td><td>합의 알고리즘</td><td>Raft, PBFT 등 분산 일관성 보장 메커니즘</td></tr><tr><td>데이터 처리</td><td>Lambda Architecture</td><td>람다 아키텍처</td><td>배치와 스트림 처리의 하이브리드 접근</td></tr><tr><td>데이터 품질</td><td>Data Profiling</td><td>데이터 프로파일링</td><td>데이터 분포와 품질 특성 분석 기법</td></tr><tr><td>메타데이터</td><td>Schema Evolution</td><td>스키마 진화</td><td>하위 호환성을 유지하는 스키마 변경 전략</td></tr><tr><td>보안</td><td>Data Governance</td><td>데이터 거버넌스</td><td>데이터 생명주기 전반의 관리 정책</td></tr><tr><td>성능</td><td>Query Optimization</td><td>쿼리 최적화</td><td>인덱스, 파티셔닝, 캐싱 전략</td></tr></tbody></table><h2 id=20-반드시-학습해야할-내용>20. 반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#20-반드시-학습해야할-내용>#</a></h2><table><thead><tr><th>📂 카테고리</th><th>주제</th><th>핵심 항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>1. 데이터 모델링 및 표현</strong></td><td>Domain Modeling</td><td>도메인 주도 설계 (DDD)</td><td>비즈니스 요구를 데이터 구조에 반영하여 설계하는 방법론</td></tr><tr><td></td><td>Semantic Modeling</td><td>의미론적 모델링</td><td>온톨로지 기반으로 데이터 의미와 관계를 정의하여 재사용성과 상호운용성 확보</td></tr><tr><td></td><td>Schema Evolution</td><td>스키마 진화</td><td>하위 호환성을 보장하며 스키마를 변경하는 전략 (버전 관리, 마이그레이션)</td></tr><tr><td></td><td>Data Format</td><td>Avro, Protobuf, Parquet</td><td>고속 전송 및 저장을 위한 포맷 선택 (배치, 실시간 모두에 최적화)</td></tr><tr><td><strong>2. 데이터 파이프라인 및 처리</strong></td><td>ETL/ELT</td><td>데이터 수집 및 정제</td><td>다양한 소스에서 데이터를 수집하고 변환하여 저장소로 전송하는 자동화 흐름</td></tr><tr><td></td><td>Lambda Architecture</td><td>람다 아키텍처</td><td>배치 + 실시간 스트림 처리의 하이브리드 아키텍처</td></tr><tr><td></td><td>Event-Driven Architecture</td><td>이벤트 기반 처리</td><td>비동기 메시지 중심의 구조로 실시간성과 모듈 독립성 향상</td></tr><tr><td></td><td>Data Pipeline Automation</td><td>데이터 파이프라인 자동화</td><td>워크플로우 자동화, 스케줄링, 장애 복구 등을 포함한 데이터 흐름 관리</td></tr><tr><td><strong>3. 분산 시스템 및 아키텍처</strong></td><td>Consensus Algorithms</td><td>합의 알고리즘 (Raft, PBFT 등)</td><td>분산 환경에서 데이터 일관성을 보장하기 위한 노드 간 합의 프로토콜</td></tr><tr><td></td><td>Distributed Data Architecture</td><td>데이터 중심 아키텍처 설계</td><td>분산 환경에서의 확장성, 일관성, 내결함성을 중심으로 설계된 아키텍처</td></tr><tr><td></td><td>Cloud-Native Architecture</td><td>클라우드 네이티브 데이터 처리</td><td>클라우드 환경에서 확장 가능한 데이터 중심 아키텍처 (서버리스, 오토스케일 포함)</td></tr><tr><td><strong>4. 메타데이터 및 거버넌스</strong></td><td>Data Catalog</td><td>메타데이터 탐색 및 계보 관리</td><td>데이터의 출처, 속성, 관계, 사용 이력을 관리하여 투명성과 추적성을 확보</td></tr><tr><td></td><td>Data Governance</td><td>정책/규제/보안</td><td>데이터 품질, 프라이버시, 권한, 규정 (GDPR, HIPAA 등) 을 통합 관리하는 정책 체계</td></tr><tr><td><strong>5. 성능 및 최적화</strong></td><td>Query Optimization</td><td>쿼리 최적화</td><td>인덱스 활용, 파티셔닝, 캐싱 등을 통한 성능 향상 기법</td></tr><tr><td></td><td>Storage Strategy</td><td>데이터 저장소 설계</td><td>OLAP/OLTP 최적화를 위한 저장소 선택 및 파티셔닝, 포맷 전략</td></tr><tr><td><strong>6. 데이터 품질 관리</strong></td><td>Data Profiling</td><td>데이터 프로파일링</td><td>통계 기반으로 데이터의 이상값, 결측치, 분포 등을 분석하여 품질 상태 진단</td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th><strong>카테고리</strong></th><th><strong>용어</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>아키텍처 개념</strong></td><td>Data-Centric Architecture</td><td>데이터가 시스템 설계 및 운영의 중심이 되는 아키텍처 스타일</td></tr><tr><td></td><td>SSOT (Single Source of Truth)</td><td>조직 내 모든 시스템이 참조하는 단일한 데이터 소스</td></tr><tr><td></td><td>EKG (Enterprise Knowledge Graph)</td><td>조직의 데이터 및 지식 관계를 그래프 형태로 표현한 지식 구조</td></tr><tr><td></td><td>Data Federation</td><td>분산된 데이터 소스를 가상 통합하여 일관된 인터페이스로 제공하는 기술</td></tr><tr><td></td><td>Data Lake</td><td>원시 상태의 다양한 데이터를 저장하는 대규모 비정형 저장소</td></tr><tr><td></td><td>Data Warehouse</td><td>정형 데이터를 구조화하여 저장하고 분석 가능한 저장소</td></tr><tr><td></td><td>데이터 파이프라인</td><td>데이터 수집, 처리, 저장, 분석 과정을 자동화한 흐름</td></tr><tr><td></td><td>데이터 거버넌스</td><td>데이터 품질, 보안, 규정 준수 등을 포함한 전사적 데이터 관리 체계</td></tr><tr><td><strong>패턴 및 구조</strong></td><td>Repository Pattern</td><td>데이터 접근 로직을 분리 및 캡슐화하는 설계 패턴</td></tr><tr><td></td><td>Blackboard Pattern</td><td>공유 메모리를 통해 독립적인 모듈이 협업하는 AI 중심 처리 구조</td></tr><tr><td><strong>메시징 및 실시간 처리</strong></td><td>Apache Kafka</td><td>분산 메시징 및 스트리밍 데이터 처리용 고성능 메시지 브로커</td></tr><tr><td></td><td>Schema Registry</td><td>메시지 스키마를 저장, 관리하며 버전 관리와 호환성을 검증하는 시스템</td></tr><tr><td></td><td>CDC (Change Data Capture)</td><td>데이터베이스의 변경 사항을 실시간으로 캡처하여 스트리밍 처리에 활용하는 기술</td></tr><tr><td></td><td>Stream Processing</td><td>이벤트 기반 실시간 데이터 처리 기법 및 프레임워크 (예: Kafka Streams, Flink 등)</td></tr><tr><td><strong>데이터 모델 및 저장 포맷</strong></td><td>Avro, Parquet</td><td>고성능 직렬화 및 컬럼 기반 저장 포맷 (압축, 쿼리 최적화에 유리)</td></tr><tr><td></td><td>Object Storage</td><td>대용량 비정형 파일 (이미지, 로그 등) 을 저장하기 위한 클라우드 기반 파일 시스템</td></tr><tr><td><strong>데이터 관리 및 추적</strong></td><td>Data Catalog</td><td>메타데이터, 데이터 출처, 설명 등 데이터 정보와 관계를 체계적으로 관리하는 시스템</td></tr><tr><td></td><td>Data Lineage</td><td>데이터가 생성된 출처부터 처리 과정을 추적하는 체계 (감사 및 규정 준수용)</td></tr><tr><td></td><td>Master Data Management (MDM)</td><td>조직 내 핵심 데이터 (고객, 제품 등) 의 정확성 및 일관성 확보를 위한 통합 관리</td></tr><tr><td><strong>보안 및 통제</strong></td><td>RBAC (Role-Based Access Control)</td><td>사용자 역할에 따라 리소스 접근을 제어하는 권한 시스템</td></tr><tr><td></td><td>Data Masking</td><td>데이터 노출 시 민감 정보를 보호하기 위해 데이터를 가상화 또는 마스킹하는 보안 기술</td></tr><tr><td></td><td>Zero Trust</td><td>네트워크 내부도 신뢰하지 않고 모든 요청에 대해 지속적으로 검증하는 보안 모델</td></tr><tr><td><strong>운영 및 성능</strong></td><td>TTL (Time To Live)</td><td>캐시 또는 임시 데이터의 유효 시간을 정의하는 메타데이터 속성</td></tr><tr><td></td><td>Query Federation</td><td>서로 다른 데이터 소스에 대해 통합 쿼리를 실행하고 결과를 집계하는 기법</td></tr><tr><td></td><td>DataOps</td><td>DevOps 에서 파생된 데이터 운영 자동화 및 협업 중심의 데이터 처리 방식</td></tr><tr><td></td><td>Serverless Data Processing</td><td>서버리스 환경 (Lambda 등) 에서 이벤트 기반으로 데이터를 처리하는 구조</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://datacentricmanifesto.org/>Data-Centric Manifesto - 데이터 중심 원칙</a> ([datacentricmanifesto.org][1])</li><li><a href=https://docs.aws.amazon.com/prescriptive-guidance/latest/modern-data-centric-use-cases/introduction.html>AWS Prescriptive Guidance ‎– Modern Data‑Centric Architecture Use Cases</a> ([docs.aws.amazon.com][2])</li><li><a href=https://docs.aws.amazon.com/prescriptive-guidance/latest/modern-data-centric-use-cases/best-practices.html>AWS Prescriptive Guidance ‎– Best Practices</a> ([docs.aws.amazon.com][3])</li><li><a href=https://docs.aws.amazon.com/prescriptive-guidance/latest/aws-caf-platform-perspective/data-arch.html>AWS Prescriptive Guidance ‎– Data Architecture Guide</a> ([docs.aws.amazon.com][4])</li><li><a href=https://docs.aws.amazon.com/prescriptive-guidance/latest/modern-data-centric-use-cases/data-engineering-principles.html>AWS Prescriptive Guidance ‎– Data Engineering Principles</a> ([docs.aws.amazon.com][5])</li><li><a href=https://docs.aws.amazon.com/prescriptive-guidance/latest/modern-data-centric-use-cases/data-lifecycle.html>AWS Prescriptive Guidance ‎– Data Lifecycle</a> ([docs.aws.amazon.com][6])</li><li><a href=https://en.wikipedia.org/wiki/Data-centric_computing>Data-centric computing – Wikipedia</a> ([en.wikipedia.org][7])</li><li><a href=https://cedanet.com.au/ceda/data-centric-principle/>Data-Centric Principle – 이론적 배경 (CedaNet)</a> <em>(유효성 확인 권장)</em></li><li><a href=https://www.geeksforgeeks.org/difference-between-data-centric-and-service-centric-architecture/>GeeksforGeeks – 데이터 중심 vs 서비스 중심 아키텍처 비교</a> <em>(웹페이지 확인 요망)</em></li><li><a href=https://dzone.com/articles/data-centric-architecture-principles-and-practices>DZone – Data‑Centric Architecture: Principles and Practices</a></li><li><a href=https://learn.microsoft.com/ko-kr/azure/architecture/guide/architecture-styles/data%E2%80%91centric>Microsoft – 데이터 중심 아키텍처 패턴 (Azure)</a></li><li><a href=https://www.ibm.com/topics/data-centric-architecture>IBM – What is Data‑Centric Architecture?</a></li><li><a href=https://www.gartner.com/en/information-technology/glossary/data-centric-architecture>Gartner – Data‑Centric Architecture: The Future of Data Management</a></li></ul><hr></div><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Data Lake vs. Data Warehouse vs. Data Lakehouse</h2></header><div class=entry-content><p>Data Lake vs. Data Warehouse vs. Data Lakehouse https://www.databricks.com/kr/glossary/data-lakehouse
1. 태그 Data-Lake, Data-Warehouse, Data-Lakehouse, Data-Architecture
2. 계층 구조 적합성 및 의견 현재 “Data Lake vs. Data Warehouse vs. Data Lakehouse” 비교 주제는 “Software Engineering > Design and Architecture > Architecture Styles and Patterns > Architecture Styles > Data-Centric Architecture” 카테고리에 적합함.
만약 추가 세분화가 필요하다면 아래 구조도 고려할 수 있음.
Computer Science and Engineering
└─ Software Engineering
└─ Design and Architecture
└─ Data Architecture Styles
└─ [Data Lake, Data Warehouse, Data Lakehouse Architecture] 근거:
→ 세 개의 아키텍처는 데이터 중심 구조 (Data-Centric Architecture) 에서 실제로 데이터 저장·분석 관점의 대표적 스타일이므로, 데이터 아키텍처 (Data Architecture) 레벨에서 한 번 더 분류하면 관리 및 설명에 용이함.
...</p></div><footer class=entry-footer><span title='2024-10-26 05:24:00 +0000 UTC'>October 26, 2024</span>&nbsp;·&nbsp;39 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Data Lake vs. Data Warehouse vs. Data Lakehouse" href=https://buenhyden.github.io/posts/software-engineering/software-design-and-architecture/data-architecture/data-centric-architecture/data-lake-vs-data-warehouse-vs-data-lakehouse/></a></article></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>