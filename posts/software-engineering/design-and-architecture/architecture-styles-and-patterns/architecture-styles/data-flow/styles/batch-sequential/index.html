<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Batch Sequential | hyunyoun's Blog</title><meta name=keywords content="Software-Engineering,Design-and-Architecture,Architecture-Styles-and-Patterns,Architecture-Styles,Data-Flow,Styles,Batch-Sequential"><meta name=description content="Batch Sequential 은 일정 단위로 모은 데이터를 순차적 단계로 처리하는 전통적 배치 아키텍처로, 모듈화와 안정성은 우수하지만 지연과 리소스 제약이 있다. 체크포인트, 파티셔닝, 하이브리드 스트림 보강, 워크플로우 도구를 통해 한계점을 보완할 수 있다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-styles/data-flow/styles/batch-sequential/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-styles/data-flow/styles/batch-sequential/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-styles/data-flow/styles/batch-sequential/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-styles/data-flow/styles/batch-sequential/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Batch Sequential"><meta property="og:description" content="Batch Sequential 은 일정 단위로 모은 데이터를 순차적 단계로 처리하는 전통적 배치 아키텍처로, 모듈화와 안정성은 우수하지만 지연과 리소스 제약이 있다. 체크포인트, 파티셔닝, 하이브리드 스트림 보강, 워크플로우 도구를 통해 한계점을 보완할 수 있다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Batch Sequential"><meta name=twitter:description content="Batch Sequential 은 일정 단위로 모은 데이터를 순차적 단계로 처리하는 전통적 배치 아키텍처로, 모듈화와 안정성은 우수하지만 지연과 리소스 제약이 있다. 체크포인트, 파티셔닝, 하이브리드 스트림 보강, 워크플로우 도구를 통해 한계점을 보완할 수 있다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"기록하고 기억하고 활용하자.","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Software Engineering","item":"https://buenhyden.github.io/posts/software-engineering/"},{"@type":"ListItem","position":3,"name":"Design and Architecture","item":""},{"@type":"ListItem","position":4,"name":"Architecture Styles and Patterns","item":"https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/"},{"@type":"ListItem","position":5,"name":"Architecture Styles","item":""},{"@type":"ListItem","position":6,"name":"Data-Flow Architecture","item":"https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-styles/data-flow/"},{"@type":"ListItem","position":7,"name":"Styles","item":"https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-styles/data-flow/styles/"},{"@type":"ListItem","position":8,"name":"Batch Sequential","item":"https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-styles/data-flow/styles/batch-sequential/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>기록하고 기억하고 활용하자.</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/software-engineering/>Software Engineering</a>&nbsp;»&nbsp;<a href>Design and Architecture</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/>Architecture Styles and Patterns</a>&nbsp;»&nbsp;<a href>Architecture Styles</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-styles/data-flow/>Data-Flow Architecture</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-styles/data-flow/styles/>Styles</a></div><h1>Batch Sequential</h1><div class=post-description>Batch Sequential 은 일정 단위로 모은 데이터를 순차적 단계로 처리하는 전통적 배치 아키텍처로, 모듈화와 안정성은 우수하지만 지연과 리소스 제약이 있다. 체크포인트, 파티셔닝, 하이브리드 스트림 보강, 워크플로우 도구를 통해 한계점을 보완할 수 있다.</div></header><div class=post-content><h2 id=batch-sequential>Batch Sequential<a hidden class=anchor aria-hidden=true href=#batch-sequential>#</a></h2><p>Batch Sequential 은 데이터‑플로우 아키텍처의 전통적 형태로, 큰 단위의 데이터를 일괄 처리 (batch) 하면서 순차적 단계 (연속 처리) 를 거치는 구조다. 각 단계는 독립 실행되며 임시 저장을 통해 이전 단계 결과를 전달한다. 과거 메인프레임 및 비즈니스 시스템 (회계, 청구 등) 에 널리 사용되었으며, 오늘날에도 대량 데이터 처리, ETL, 스케줄 기반 작업 등에서 활용된다. 장점으로 모듈화∙재사용성, 단순화된 디버깅 등이 있으며 단점으로 높은 지연 시간, 낮은 실시간 대응성, 병렬 처리 부족이 있다.</p><h3 id=배경>배경<a hidden class=anchor aria-hidden=true href=#배경>#</a></h3><p>배치 순차 처리는 1950 년대 메인프레임 시대부터 시작된 개념으로, 컴퓨터 자원이 제한적이던 시절 효율적인 데이터 처리를 위해 개발되었다.</p><p><strong>역사적 발전:</strong></p><ul><li><strong>1950 년대</strong>: 메인프레임에서 대용량 데이터 처리를 위한 배치 작업</li><li><strong>1970 년대</strong>: 유닉스 파이프라인과 명령어 체인의 개념 도입</li><li><strong>1980 년대</strong>: 관계형 데이터베이스의 ETL 프로세스에 적용</li><li><strong>2000 년대</strong>: 웹 스케일 데이터 처리를 위한 분산 배치 시스템</li><li><strong>2010 년대</strong>: 빅데이터 처리를 위한 Apache Hadoop, Spark 등의 프레임워크</li></ul><h3 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h3><p><strong>주요 목적</strong>:</p><ol><li><strong>대용량 데이터 처리</strong>: 메모리 제약을 극복한 효율적 처리</li><li><strong>복잡한 변환 작업</strong>: 다단계 데이터 변환의 체계적 관리</li><li><strong>시스템 신뢰성</strong>: 단계별 검증과 오류 복구 지점 제공</li><li><strong>자원 효율성</strong>: 시스템 자원의 최적 활용</li></ol><p><strong>필요성</strong>:</p><ul><li><strong>메모리 제약 해결</strong>: 전체 데이터를 메모리에 로드할 수 없는 상황</li><li><strong>처리 복잡도 관리</strong>: 복잡한 비즈니스 로직의 단계별 분해</li><li><strong>오류 격리</strong>: 특정 단계의 오류가 전체 시스템에 미치는 영향 최소화</li><li><strong>재처리 용이성</strong>: 특정 단계부터 재처리 가능</li></ul><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><p><strong>Batch Sequential(배치 순차 처리)</strong> 는 데이터를 일정한 배치 단위로 모아, 여러 독립적인 처리 단계 (프로그램/모듈) 를 순차적으로 연결하여 처리하는 아키텍처 스타일이다. 각 단계는 입력 파일을 받아 처리 후 결과를 출력 파일로 저장하며, 이 출력이 다음 단계의 입력이 된다.</p><ul><li><strong>배치 (Batch)</strong>: 정해진 주기나 대기 조건에 따라 묶음으로 처리되는 데이터 단위.</li><li><strong>순차 처리 (Sequential Processing)</strong>: 이전 단계 완료 후 다음 단계 수행. 동시 실행 없음.</li><li><strong>중간 저장소 (Intermediate files)</strong>: 단계 간 데이터 전달을 위한 임시 저장 매체.</li><li><strong>비상호작용식 (Non-interactive)</strong>: 사용자 개입 없이 자동 실행.</li></ul><h4 id=실무-구현과의-연관성>실무 구현과의 연관성<a hidden class=anchor aria-hidden=true href=#실무-구현과의-연관성>#</a></h4><ol><li><p><strong>시스템 설계 측면</strong></p><ul><li><strong>모듈화</strong>: 각 처리 단계를 독립적인 모듈로 설계</li><li><strong>확장성</strong>: 단계별 독립적인 스케일링 가능</li><li><strong>유지보수성</strong>: 단계별 개별 수정 및 테스트 가능</li></ul></li><li><p><strong>성능 최적화 측면</strong></p><ul><li><strong>리소스 관리</strong>: 단계별 리소스 할당 최적화</li><li><strong>병렬 처리</strong>: 동일 단계 내 배치 병렬 처리</li><li><strong>메모리 효율성</strong>: 배치 크기 조정을 통한 메모리 사용량 최적화</li></ul></li></ol><h3 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h3><p><strong>핵심 기능</strong>:</p><ol><li><strong>데이터 분할 (Data Partitioning)</strong>: 대용량 데이터를 처리 가능한 배치로 분할</li><li><strong>순차 처리 (Sequential Processing)</strong>: 각 단계의 순차적 실행 보장</li><li><strong>중간 결과 저장</strong>: 단계 간 데이터 전달을 위한 임시 저장</li><li><strong>상태 관리</strong>: 처리 진행 상황과 오류 상태 추적</li></ol><p><strong>시스템 내 역할</strong>:</p><ul><li><strong>데이터 변환 엔진</strong>: 원시 데이터를 최종 형태로 변환</li><li><strong>워크플로우 조정자</strong>: 복잡한 처리 흐름의 순서 관리</li><li><strong>리소스 중재자</strong>: 시스템 자원의 단계별 할당 및 해제</li></ul><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><ol><li><p><strong>배치 기반 처리</strong></p><ul><li>개별 항목이 아닌 데이터 묶음 단위 처리</li><li>배치 크기에 따른 성능 특성 변화</li></ul></li><li><p><strong>순차적 실행 흐름</strong></p><ul><li>엄격한 단계별 순서 준수</li><li>이전 단계 완료 후 다음 단계 시작</li></ul></li><li><p><strong>단계별 독립성</strong></p><ul><li>각 단계의 독립적인 실행 환경</li><li>단계 간 느슨한 결합 (Loose Coupling)</li></ul></li><li><p><strong>완전한 데이터 전달</strong></p><ul><li>한 단계의 전체 출력이 다음 단계 입력</li><li>부분적 데이터 전달 없음</li></ul></li></ol><h3 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h3><ol><li><p><strong>단일 책임 원칙 (Single Responsibility Principle)</strong></p><ul><li>각 단계는 하나의 명확한 기능만 수행</li><li>기능별 명확한 경계 설정</li></ul></li><li><p><strong>데이터 무결성 원칙</strong></p><ul><li>단계 간 완전한 데이터 전달 보장</li><li>데이터 손실 방지 메커니즘</li></ul></li><li><p><strong>독립성 원칙</strong></p><ul><li>각 단계의 독립적인 실행 가능성</li><li>단계 간 최소한의 의존성</li></ul></li><li><p><strong>재사용성 원칙</strong></p><ul><li>단계별 모듈의 다른 파이프라인에서 재사용</li><li>표준화된 인터페이스 제공</li></ul></li></ol><h3 id=주요-원리-및-작동-원리>주요 원리 및 작동 원리<a hidden class=anchor aria-hidden=true href=#주요-원리-및-작동-원리>#</a></h3><ul><li>데이터가 파일 또는 큐에 저장되어 다음 처리 단계로 전달</li><li>각 단계는 독립적으로 실행 가능</li><li>장애 발생 시 해당 단계만 재실행 가능</li></ul><h4 id=작동-원리>작동 원리<a hidden class=anchor aria-hidden=true href=#작동-원리>#</a></h4><pre class=mermaid>graph LR
    A[Input Data] --&gt; B[Stage 1: Extract]
    B --&gt; C[Intermediate Storage 1]
    C --&gt; D[Stage 2: Transform]
    D --&gt; E[Intermediate Storage 2]
    E --&gt; F[Stage 3: Load]
    F --&gt; G[Output Data]
    
    H[Batch Controller] --&gt; B
    H --&gt; D
    H --&gt; F
    
    I[Error Handler] --&gt; B
    I --&gt; D
    I --&gt; F
</pre><h4 id=처리-흐름>처리 흐름<a hidden class=anchor aria-hidden=true href=#처리-흐름>#</a></h4><pre class=mermaid>sequenceDiagram
    participant Controller as 배치 컨트롤러
    participant Stage1 as 단계 1
    participant Stage2 as 단계 2
    participant Stage3 as 단계 3
    participant Storage as 중간 저장소
    
    Controller-&gt;&gt;Stage1: 배치 처리 시작
    Stage1-&gt;&gt;Storage: 처리 결과 저장
    Stage1-&gt;&gt;Controller: 완료 신호
    
    Controller-&gt;&gt;Stage2: 다음 단계 시작
    Stage2-&gt;&gt;Storage: 데이터 읽기
    Stage2-&gt;&gt;Storage: 처리 결과 저장
    Stage2-&gt;&gt;Controller: 완료 신호
    
    Controller-&gt;&gt;Stage3: 최종 단계 시작
    Stage3-&gt;&gt;Storage: 데이터 읽기
    Stage3-&gt;&gt;Controller: 전체 완료
</pre><p><strong>작동 메커니즘:</strong></p><ol><li><strong>배치 초기화</strong>: 입력 데이터를 처리 가능한 배치로 분할</li><li><strong>단계별 순차 실행</strong>: 각 단계가 완전히 완료된 후 다음 단계 시작</li><li><strong>중간 결과 저장</strong>: 단계 간 데이터 전달을 위한 임시 저장</li><li><strong>상태 추적</strong>: 각 단계의 진행 상황과 결과 모니터링</li><li><strong>오류 처리</strong>: 단계별 오류 발생 시 적절한 복구 또는 중단</li></ol><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><pre class=mermaid>graph TB
    subgraph &#34;Input Layer&#34;
        A[Data Source]
        B[Data Partitioner]
    end
    
    subgraph &#34;Processing Pipeline&#34;
        C[Stage 1]
        D[Intermediate Storage 1]
        E[Stage 2]
        F[Intermediate Storage 2]
        G[Stage N]
    end
    
    subgraph &#34;Control Layer&#34;
        H[Batch Controller]
        I[Scheduler]
        J[Monitor]
    end
    
    subgraph &#34;Storage Layer&#34;
        K[Persistent Storage]
        L[Temporary Storage]
    end
    
    subgraph &#34;Error Handling&#34;
        M[Error Handler]
        N[Recovery Manager]
    end
    
    A --&gt; B
    B --&gt; C
    C --&gt; D
    D --&gt; E
    E --&gt; F
    F --&gt; G
    
    H --&gt; C
    H --&gt; E
    H --&gt; G
    
    I --&gt; H
    J --&gt; H
    
    M --&gt; C
    M --&gt; E
    M --&gt; G
    
    D --&gt; L
    F --&gt; L
    G --&gt; K
</pre><h4 id=구성요소>구성요소<a hidden class=anchor aria-hidden=true href=#구성요소>#</a></h4><table><thead><tr><th>구분</th><th>구성요소</th><th>기능</th><th>역할</th><th>특징</th></tr></thead><tbody><tr><td>필수</td><td><strong>배치 컨트롤러</strong></td><td>전체 처리 흐름 제어 및 조정</td><td>단계별 실행 순서 관리, 상태 추적</td><td>중앙집중식 제어, 오류 감지 및 대응</td></tr><tr><td>필수</td><td><strong>처리 단계 (Stages)</strong></td><td>실제 데이터 변환 및 처리 수행</td><td>특정 비즈니스 로직 실행</td><td>독립적 실행, 재사용 가능한 모듈</td></tr><tr><td>필수</td><td><strong>중간 저장소</strong></td><td>단계 간 데이터 전달을 위한 임시 저장</td><td>데이터 버퍼링, 백프레셔 관리</td><td>고성능 읽기/쓰기, 자동 정리</td></tr><tr><td>필수</td><td><strong>데이터 분할기</strong></td><td>대용량 데이터를 처리 가능한 배치로 분할</td><td>메모리 효율성 보장, 병렬 처리 지원</td><td>동적 배치 크기 조정, 데이터 특성 고려</td></tr><tr><td>선택</td><td><strong>스케줄러</strong></td><td>배치 작업의 시간 기반 실행 관리</td><td>자동화된 작업 실행, 리소스 최적화</td><td>조건부 실행, 의존성 관리</td></tr><tr><td>선택</td><td><strong>모니터링 시스템</strong></td><td>실시간 성능 모니터링 및 알림</td><td>시스템 상태 가시성 제공</td><td>메트릭 수집, 대시보드 제공</td></tr><tr><td>선택</td><td><strong>캐싱 계층</strong></td><td>자주 접근하는 데이터의 캐시 관리</td><td>성능 향상, 네트워크 부하 감소</td><td>지능형 캐시 정책, 분산 캐시 지원</td></tr><tr><td>선택</td><td><strong>부하 분산기</strong></td><td>여러 처리 인스턴스 간 작업 분산</td><td>시스템 확장성 제공</td><td>동적 부하 분산, 장애 감지</td></tr></tbody></table><h3 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h3><table><thead><tr><th><strong>구현 전략</strong></th><th><strong>정의 및 구성 방식</strong></th><th><strong>주요 목적</strong></th><th><strong>대표 도구 및 예시</strong></th></tr></thead><tbody><tr><td><strong>1. 커스텀 스크립트 기반</strong></td><td>단계별 Shell, Python 스크립트 작성 + Cron/Task Scheduler 로 순차 실행</td><td>간단한 구조, 빠른 프로토타이핑</td><td><code>bash + cron</code>, <code>Python + schedule</code>, <code>Airflow CLI</code> 등</td></tr><tr><td><strong>2. 프레임워크 기반 배치</strong></td><td><code>Job</code>, <code>Step</code>, <code>Reader/Writer</code> 등 명세 중심 처리. 상태 저장, 재시작, 병렬 처리 지원</td><td>재시작, 로깅, 트랜잭션 제어, 대용량 처리</td><td><code>Spring Batch</code>, <code>terasoluna-batch</code>, <code>Quartz</code> 등</td></tr><tr><td><strong>3. 워크플로우 오케스트레이션</strong></td><td>DAG(Task Graph) 기반으로 단계 연결, 스케줄링 + 모니터링 + 재실행 자동화</td><td>복잡한 워크플로우 구성, 장애 대응, 확장성</td><td><code>Apache Airflow</code>, <code>AWS Step Functions</code>, <code>Argo Workflow</code></td></tr><tr><td><strong>4. GUI 기반 ETL 도구</strong></td><td>Drag & Drop 방식의 시각적 흐름 정의, 연동된 임시 저장소 또는 메타데이터 기반 처리</td><td>빠른 설계, 비개발자 접근성, 시각화</td><td><code>Informatica</code>, <code>Talend</code>, <code>Pentaho</code>, <code>Nifi</code></td></tr><tr><td><strong>5. 분산 실행 기반 배치</strong></td><td>Spark/Flink 기반 Job 을 순차 구성하고, YARN/Oozie 등으로 실행 흐름 제어</td><td>분산 병렬 처리, 대용량 데이터 파이프라인</td><td><code>Apache Spark + Oozie</code>, <code>Flink Batch + Airflow</code></td></tr><tr><td><strong>6. 파이프라인 기반 처리</strong></td><td>각 단계를 독립 프로세스로 구성하고, 메시지 큐/파일/표준 I/O 기반으로 연결</td><td>유연한 단계 연결, 시스템 격리, Fault Isolation</td><td><code>UNIX pipeline</code>, <code>Kafka → ETL → Loader</code>, <code>GStreamer</code></td></tr><tr><td><strong>7. 스트리밍 - 배치 하이브리드</strong></td><td>실시간 스트림을 시간 윈도우 단위로 배치화하여 마이크로 배치 처리</td><td>실시간성과 안정성 결합</td><td><code>Spark Structured Streaming</code>, <code>Flink with Windowing</code></td></tr><tr><td><strong>8. 메모리 매핑 처리</strong></td><td>대용량 파일을 가상 메모리에 매핑하여 페이지 단위로 처리</td><td>메모리 효율적 접근, 랜덤 액세스</td><td><code>mmap</code> (Unix), <code>memoryview</code>, <code>Apache Arrow</code></td></tr><tr><td><strong>9. 체크포인트 기반 복구</strong></td><td>각 단계 실행 후 상태를 저장하여 장애 시 해당 단계만 재실행 가능하게 구성</td><td>장애 대응, 증분 복구, 안정성 확보</td><td><code>Airflow XCom</code>, <code>Spring Batch JobRepository</code>, <code>Flink Savepoint</code></td></tr></tbody></table><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>성능 및 처리 효율</strong></td><td><strong>대용량 데이터 처리 적합</strong></td><td>전체 데이터를 메모리에 로드하지 않고 배치 단위로 처리함으로써, 메모리 효율적으로 수 TB 이상의 데이터를 처리 가능</td></tr><tr><td></td><td><strong>병렬 처리 지원</strong></td><td>동일 단계 내에서 배치를 분할하여 병렬로 실행할 수 있어 처리량 증가 및 Throughput 향상 가능</td></tr><tr><td></td><td><strong>예측 가능한 리소스 사용</strong></td><td>단계별로 필요한 리소스를 정적으로 추산하고 할당 가능하므로, 안정적인 성능 보장 및 비용 최적화</td></tr><tr><td><strong>운영 및 관리 용이성</strong></td><td><strong>오류 격리</strong></td><td>각 Step 이 독립적이므로 한 단계의 오류가 전체 플로우에 영향을 주지 않고 해당 단계만 재실행 가능</td></tr><tr><td></td><td><strong>재시작 용이성</strong></td><td>각 단계별 완료 시점이 명확히 기록되어 장애 발생 시 해당 단계부터 재처리 가능</td></tr><tr><td></td><td><strong>디버깅 및 추적 용이</strong></td><td>중간 결과가 저장되므로 실행 로그 및 중간 데이터를 기반으로 문제 추적 및 원인 파악이 쉬움</td></tr><tr><td><strong>설계 및 구조적 유연성</strong></td><td><strong>모듈화 및 유지보수성 향상</strong></td><td>각 처리 단계를 독립적인 프로그램 또는 모듈로 분리하여 개발, 테스트, 배포가 용이함</td></tr><tr><td></td><td><strong>로직 단순화 및 명확한 흐름</strong></td><td>순차적 실행 흐름이 명확하여 복잡한 로직 없이도 전체 시스템 이해가 쉬움</td></tr><tr><td></td><td><strong>재사용성</strong></td><td>공통 처리 로직을 단일 모듈로 구성하여 다른 플로우에서도 쉽게 재사용 가능</td></tr><tr><td><strong>시스템 안정성</strong></td><td><strong>낮은 결합도 (Loose Coupling)</strong></td><td>각 단계가 Intermediate Storage 를 통해 연결되어 시스템 간 결합도를 낮춰 변경에 대한 영향을 최소화</td></tr><tr><td></td><td><strong>구간별 테스트 가능성</strong></td><td>각 단계가 독립적으로 실행되기 때문에 단위 테스트 및 통합 테스트가 용이함</td></tr><tr><td></td><td><strong>장애 영향 최소화</strong></td><td>전체 시스템이 아닌 개별 단계에 대한 장애 대응이 가능하여 전체 다운 타임 최소화</td></tr></tbody></table><h3 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th><strong>구분</strong></th><th><strong>항목</strong></th><th><strong>설명</strong></th><th><strong>해결 방안</strong></th></tr></thead><tbody><tr><td><strong>처리 지연</strong></td><td>지연 시간 증가</td><td>모든 단계가 순차적으로 실행되므로 전체 처리 시간이 길어짐</td><td>마이크로 배치 도입, 스트리밍과의 하이브리드 처리 병행</td></tr><tr><td><strong>운영 복잡성</strong></td><td>복잡한 제어 로직</td><td>실행 순서, 의존성, 에러 처리를 수동 제어해야 하므로 유지보수가 어려움</td><td>워크플로우 엔진 (Airflow, Spring Batch 등) 도입, 선언적 파이프라인 사용</td></tr><tr><td><strong>저장소 오버헤드</strong></td><td>중간 파일/저장소 과다 사용</td><td>각 단계의 결과를 파일이나 테이블로 저장하면서 스토리지 사용량 증가</td><td>임시 저장소 최적화, 주기적 정리 자동화, 메모리 기반 임시 저장소 활용</td></tr><tr><td><strong>실시간성 부족</strong></td><td>실시간 요청에 대응 불가</td><td>사용자 요청에 대해 실시간 응답이 불가능하며 인터랙티브한 시스템과 병행 사용 불가</td><td>이벤트 기반 시스템 또는 스트림 처리 병행 구조 설계</td></tr><tr><td><strong>리소스 독점</strong></td><td>외부 트랜잭션 영향</td><td>대용량 배치가 시스템 전체 리소스를 점유하여 실시간 시스템 성능 저하</td><td>리소스 제한 설정, QoS 기반 스케줄링, 배치 시간대 분리 운영</td></tr></tbody></table><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th><strong>구분</strong></th><th><strong>문제 항목</strong></th><th><strong>원인</strong></th><th><strong>영향</strong></th><th><strong>탐지/진단 방법</strong></th><th><strong>예방 및 해결 방안</strong></th></tr></thead><tbody><tr><td><strong>데이터 품질</strong></td><td>데이터 불일치</td><td>단계 간 전달 중 누락/중복 발생, 중간 결과 검증 누락</td><td>결과 오류, 데이터 신뢰도 저하</td><td>로그/체크섬 기반 검증, 정합성 비교</td><td>트랜잭션 보장, 멱등성 적용, 데이터 무결성 검증</td></tr><tr><td><strong>장애 대응성</strong></td><td>복구 어려움</td><td>체크포인트 부재, 임시 저장소 의존</td><td>배치 실패 시 전체 재시작, 시간/비용 증가</td><td>상태 모니터링, 실패 단계 추적</td><td>체크포인트 저장, 스테이지별 재시작 기능 도입</td></tr><tr><td><strong>리소스 병목</strong></td><td>특정 단계 병목</td><td>불균형한 처리 로직, 고비용 연산 존재</td><td>전체 성능 저하, SLA 지연</td><td>단계별 처리 시간 측정, 시스템 모니터링</td><td>병목 단계 분산 처리, 리팩토링, 리소스 증설</td></tr><tr><td><strong>저장소 오류</strong></td><td>중간 저장소 손상/삭제</td><td>디스크 오류, 네트워크 문제, 파일 충돌 등</td><td>데이터 손실, 재처리 필요</td><td>스토리지 상태 모니터링, 백업 주기 관리</td><td>저장소 이중화, 자동 백업/복원 스크립트</td></tr><tr><td><strong>스키마 호환성</strong></td><td>스키마 변경 시 파이프라인 오류 발생</td><td>하위 모듈 미준비, 버전 불일치</td><td>다운스트림 오류, 배치 실패</td><td>Schema Registry 로그, 버전 비교 분석</td><td>스키마 레지스트리 도입, 정/역방향 호환 정책 수립</td></tr><tr><td><strong>성능 저하</strong></td><td>대용량 데이터 처리 지연</td><td>단일 노드 처리, 비효율적 알고리즘</td><td>전체 처리 지연, 시간 초과</td><td>처리 시간 프로파일링, GC 로그 분석</td><td>병렬 처리 도입, 파티셔닝 및 리팩토링, 메모리 튜닝</td></tr><tr><td><strong>에러 은닉</strong></td><td>오류 탐지 누락</td><td>로그 미흡, 예외 처리 부재</td><td>문제 진단 어려움, 배치 실패 원인 파악 불가</td><td>상세 로그/알림 시스템 구축</td><td>자동화된 에러 감지, 알림 설정, 로깅 레벨 고도화</td></tr></tbody></table><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><table><thead><tr><th>카테고리</th><th>과제</th><th>원인</th><th>영향</th><th>해결 방안</th></tr></thead><tbody><tr><td><strong>기술적 과제</strong></td><td>대용량 처리 병목 (Scalability)</td><td>데이터 증가, 병렬화 부족, 단일 스레드/노드 처리 한계</td><td>처리 지연, 시스템 부하, 병목 발생</td><td>멀티 파티션 처리, Kubernetes 기반 수평 확장스케줄러 병렬화 전략</td></tr><tr><td></td><td>실시간 요구 대응 (Hybrid Integration)</td><td>실시간 분석 수요 증가, 순수 배치 구조의 한계</td><td>분석 지연, 비즈니스 인사이트 지연</td><td>Lambda/Kappa 아키텍처 도입배치 - 스트림 하이브리드화</td></tr><tr><td></td><td>체크포인트 처리 최적화</td><td>지나친 메타데이터 쓰기, 상태 저장 비용 증가</td><td>I/O 및 DB 부하 증가, 처리 지연</td><td>배치 크기 조정, Checkpoint 주기 최적화</td></tr><tr><td></td><td>정확한 처리 보장 (Exactly-once)</td><td>장애 시 재처리 중복 가능성</td><td>데이터 중복 저장, 결과 불일치</td><td>트랜잭션 격리, 키 기반 중복 제거, Idempotent 처리 설계</td></tr><tr><td><strong>운영 과제</strong></td><td>운영 자동화 부족</td><td>수작업 배포/모니터링/복구 구성</td><td>운영 복잡성, 오류 대응 지연</td><td>자동화된 CI/CD, 통합 모니터링, 장애 감지 및 복구 자동화</td></tr><tr><td></td><td>장애 복구 시 처리 불안정</td><td>수동 복구 전략, 처리 중 상태 유실 가능성</td><td>처리 재시작 불가 또는 중복 처리</td><td>Checkpointing, 재시작 가능한 워크플로우 구성</td></tr><tr><td><strong>품질/신뢰성</strong></td><td>데이터 품질 관리 (Quality)</td><td>다양한 소스 및 변환으로 인한 오류 발생 가능성</td><td>잘못된 분석 결과, 다운스트림 오류</td><td>데이터 린나지 관리, 단계별 데이터 검증 및 프로파일링</td></tr><tr><td></td><td>신뢰성 있는 처리 보장</td><td>변동성 있는 소스 입력, 일시적 오류 무시 전략 등</td><td>결과 불신, SLA 미달</td><td>데이터 검증 룰 기반 유효성 검증, 오류 알림 및 보정 정책</td></tr><tr><td><strong>비용/인프라</strong></td><td>비용 최적화</td><td>클라우드 리소스 과소/과다 사용</td><td>비용 낭비 또는 성능 저하</td><td>스팟 인스턴스 활용, 비용 기반 스케줄링, 적응형 리소스 할당</td></tr><tr><td></td><td>리소스 할당/확장 설계 부족</td><td>과도한 고정 리소스, 수동 확장</td><td>트래픽 증가 시 처리 실패, 리소스 낭비</td><td>오토스케일링, 동적 리소스 할당 전략 적용</td></tr></tbody></table><h3 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th><strong>분류 기준</strong></th><th><strong>유형</strong></th><th><strong>정의 및 특징</strong></th><th><strong>적용 사례</strong></th></tr></thead><tbody><tr><td><strong>1. 배치 크기 기준</strong></td><td>Fixed-size 배치</td><td>일정한 데이터 건수 단위로 처리. 예: 1,000 건씩 고정</td><td>대금 정산 처리, 고정 건수 마이그레이션 배치</td></tr><tr><td></td><td>Time-window 배치</td><td>시간 간격 단위로 처리. 예: 1 시간마다, 매일 새벽 3 시</td><td>로그 수집, 시간 기반 로그 집계</td></tr><tr><td><strong>2. 처리 구조 기준</strong></td><td>순차 단일 프로세스</td><td>모든 단계를 단일 프로세스로 순차 실행. 단순하나 확장성 부족</td><td>DB 백업 스크립트, 단일 cron job</td></tr><tr><td></td><td>병렬 파티셔닝 처리</td><td>데이터를 파티션으로 나누어 여러 인스턴스에서 병렬 처리</td><td>사용자 활동 로그 병렬 수집, 청구서 병렬 처리</td></tr><tr><td><strong>3. 실행 주기 기준</strong></td><td>정기 배치 (Scheduled)</td><td>cron, scheduler 등을 이용한 고정 주기 실행</td><td>야간 배치, 월말 회계 정산</td></tr><tr><td></td><td>온디맨드 배치 (On-demand)</td><td>사용자의 명시적 요청 또는 이벤트 발생 시 실행</td><td>실시간 보고서 생성, 수동 데이터 재처리</td></tr><tr><td><strong>4. 실행 환경 기준</strong></td><td>온프레미스</td><td>자체 서버 및 물리적 인프라 기반 처리</td><td>금융권 사내 시스템, ERP 일괄 처리</td></tr><tr><td></td><td>클라우드 기반</td><td>AWS Batch, Dataflow 등 클라우드 매니지드 서비스 활용</td><td>데이터 웨어하우스 적재, BigQuery ETL 처리</td></tr><tr><td><strong>5. 데이터 전달 방식</strong></td><td>파일 기반</td><td>각 단계가 파일 입출력을 통해 데이터를 전달</td><td>CSV 처리, Hadoop Input/Output</td></tr><tr><td></td><td>메시지 큐 기반</td><td>Kafka, RabbitMQ 등으로 각 단계 연결. 병렬·비동기 처리가 가능</td><td>실시간 수집 후 배치 적재, 이벤트 기반 ETL</td></tr><tr><td><strong>6. 실행 제어 방식</strong></td><td>스크립트 기반 실행</td><td>Shell/Python 등의 스크립트와 cron 기반 수동 제어</td><td>레거시 배치 시스템, 단순 자동화</td></tr><tr><td></td><td>프레임워크 기반 실행</td><td>Spring Batch, Airflow 등으로 정의된 워크플로우 기반 배치 처리</td><td>병렬 파이프라인, 재시작·트랜잭션 보장되는 정형 배치</td></tr><tr><td><strong>7. 장애 처리 전략</strong></td><td>체크포인트 기반</td><td>중간 단계마다 상태 저장 → 오류 발생 시 해당 시점부터 재처리 가능</td><td>장시간 금융 마감 배치, 단계 복구 필수 파이프라인</td></tr><tr><td></td><td>재시도 기반</td><td>실패 시 전체 재처리. 구조는 단순하나 자원 소모 큼</td><td>소규모 간단 배치 작업, 알림 이메일 발송</td></tr></tbody></table><h3 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h3><table><thead><tr><th>적용 분야</th><th>목적</th><th>연계 기술 및 도구</th><th>효과</th></tr></thead><tbody><tr><td><strong>데이터 파이프라인 (ETL)</strong></td><td>데이터 추출, 정제, 적재 (정기 배치)</td><td>Apache Airflow, Spark, SQL, Staging Tables</td><td>대용량 데이터 자동 변환, 정형화된 웨어하우스 구축 가능</td></tr><tr><td><strong>통신/요금 정산</strong></td><td>JSON 기반 로그 분석 및 요금 청구 변환 처리</td><td>Spring Batch, DBMS, JSON Parser</td><td>요금 정산 정확도 향상, 체크포인트 기반 안정성 확보</td></tr><tr><td><strong>매출 집계</strong></td><td>일일/월별 매출 통계 처리</td><td>Spark SQL, Python, CSV/Parquet</td><td>비즈니스 인사이트 제공, 시간 단위 리포트 자동화</td></tr><tr><td><strong>로그 분석</strong></td><td>대량 로그 수집 및 이벤트 분석</td><td>ELK Stack (Logstash, Kibana), Hadoop, Spark</td><td>실시간 이상 탐지, 트렌드 분석 최적화</td></tr><tr><td><strong>이미지/미디어 처리</strong></td><td>이미지/영상 데이터의 일괄 변환</td><td>ImageMagick, OpenCV, PIL</td><td>병렬 이미지 처리, 사이즈 변환, 포맷 통일 등 일괄 처리</td></tr><tr><td><strong>금융/재무 분석</strong></td><td>일별 거래내역 정산 및 리포팅 자동화</td><td>SQL, Python Pandas, 파일시스템, FTP</td><td>정산 신뢰성 확보, 자동 보고서 생성</td></tr><tr><td><strong>ML 파이프라인</strong></td><td>모델 학습 / 재학습, 주기적 배포</td><td>MLflow, Kubeflow, Spark MLlib</td><td>학습 - 배포 자동화, 성능 관리 반복 주기 최적화</td></tr><tr><td><strong>백업 및 복구</strong></td><td>정기적 데이터 백업 및 재해 복구</td><td>rsync, 분산 파일 시스템 (HDFS, S3), cron, Kubernetes</td><td>데이터 안정성 확보, 비용 최소화</td></tr><tr><td><strong>클라우드 기반 확장</strong></td><td>대규모 배치 스케일링 및 자원 최적화</td><td>Spring Batch + Kubernetes, Autoscaler</td><td>Auto-Restart, 내결함성, 리소스 효율 극대화</td></tr></tbody></table><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><h4 id=사례-1-통신사-요금-청구-배치-spring-batch-기반>사례 1: 통신사 요금 청구 배치 (Spring Batch 기반)<a hidden class=anchor aria-hidden=true href=#사례-1-통신사-요금-청구-배치-spring-batch-기반>#</a></h4><p><strong>시스템 구성</strong>:</p><pre class=mermaid>graph TD
  A[Usage JSON Files] --&gt; B[Step1: Reader/Processor]
  B --&gt; C[Intermediate Storage: BILL_STATEMENTS table]
  C --&gt; D[Step2: Aggregation/Finalization]
  D --&gt; E[Reporting/Table Load]
  B &amp; D --&gt; F[Job Repository: 상태/체크포인트]
  F &amp; E --&gt; G[JobLauncher &amp; Scheduler triggering]
</pre><ul><li><strong>Step1</strong>: JSON 파일 사용량 입력 → DTO 매핑 → <code>BILL_STATEMENTS</code> 테이블 임시 삽입</li><li><strong>Step2</strong>: SQL 기반 집계를 통한 최종 청구서 작성 및 결과 적재</li><li><strong>Job Repository</strong>: Spring Batch 내 메타데이터 저장, 체크포인트 관리</li><li><strong>Scheduler</strong>: cron 이나 클라우드 태스크 큐를 통한 배치 실행 제어</li></ul><p><strong>Workflow</strong>:</p><ol><li>Scheduler 가 JobLauncher 로 <code>billrun</code> Job 호출</li><li>Step1 읽기 처리 후 <code>BILL_STATEMENTS</code> 에 임시 저장</li><li>Step2 에서 계산 및 테이블 업데이트</li><li>각 Step 종료 시 트랜잭션 커밋, 체크포인트 기록</li><li>Job 종료 후 상태 로그와 메타 기록</li><li>오류 시 체크포인트 기준 재시작</li></ol><p><strong>구현 예시</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>Job</span><span class=w> </span><span class=nf>billJob</span><span class=p>(</span><span class=n>JobBuilderFactory</span><span class=w> </span><span class=n>jb</span><span class=p>,</span><span class=w> </span><span class=n>StepBuilderFactory</span><span class=w> </span><span class=n>sb</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                   </span><span class=n>ItemReader</span><span class=o>&lt;</span><span class=n>JsonUsage</span><span class=o>&gt;</span><span class=w> </span><span class=n>reader</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                   </span><span class=n>ItemProcessor</span><span class=o>&lt;</span><span class=n>JsonUsage</span><span class=p>,</span><span class=w> </span><span class=n>Bill</span><span class=o>&gt;</span><span class=w> </span><span class=n>processor</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                   </span><span class=n>ItemWriter</span><span class=o>&lt;</span><span class=n>Bill</span><span class=o>&gt;</span><span class=w> </span><span class=n>writer</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>Step</span><span class=w> </span><span class=n>step1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sb</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=s>&#34;usageToBill&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=o>&lt;</span><span class=n>JsonUsage</span><span class=p>,</span><span class=n>Bill</span><span class=o>&gt;</span><span class=n>chunk</span><span class=p>(</span><span class=n>1000</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=na>reader</span><span class=p>(</span><span class=n>reader</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=na>processor</span><span class=p>(</span><span class=n>processor</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=na>writer</span><span class=p>(</span><span class=n>writer</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=n>jb</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=s>&#34;billJob&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=na>incrementer</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>RunIdIncrementer</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=na>repository</span><span class=p>(</span><span class=n>jobRepository</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=na>start</span><span class=p>(</span><span class=n>step1</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ul><li><strong>chunk 기반 처리</strong>: 1000 건 단위 트랜잭션, 체크포인트 기능 포함</li><li><strong>ItemReader/Processor/Writer</strong> 역할 분리로 코드 가독성과 유지보수성 향상</li></ul><p>하이브리드 확장 팁 (대규모 사용량 처리 시):</p><ul><li><code>Partitioner</code> 및 <code>StepScope</code> 사용하여 Step1 병렬화 적용 가능</li></ul><h4 id=사례-2-etlextract-transform-load-파이프라인>사례 2: ETL(Extract, Transform, Load) 파이프라인<a hidden class=anchor aria-hidden=true href=#사례-2-etlextract-transform-load-파이프라인>#</a></h4><p><strong>시스템 구성</strong>: 원본 데이터 → 추출 프로그램 → 변환 프로그램 → 적재 프로그램 → 데이터 웨어하우스</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[원본 데이터]
</span></span><span class=line><span class=cl>   |
</span></span><span class=line><span class=cl>[추출 프로그램]
</span></span><span class=line><span class=cl>   |
</span></span><span class=line><span class=cl>[중간 파일 1]
</span></span><span class=line><span class=cl>   |
</span></span><span class=line><span class=cl>[변환 프로그램]
</span></span><span class=line><span class=cl>   |
</span></span><span class=line><span class=cl>[중간 파일 2]
</span></span><span class=line><span class=cl>   |
</span></span><span class=line><span class=cl>[적재 프로그램]
</span></span><span class=line><span class=cl>   |
</span></span><span class=line><span class=cl>[데이터 웨어하우스]
</span></span></code></pre></td></tr></table></div></div><p><strong>워크플로우</strong>: 원본 데이터 수집 → 추출 (Extract) → 변환 (Transform) → 적재 (Load)</p><p><strong>Batch Sequential 적용 시</strong>: 각 단계가 독립적으로 실행되어 장애 발생 시 해당 단계만 재처리 가능, 데이터 품질 관리 용이<br><strong>미적용 시</strong>: 전체 파이프라인 장애 시 복구 어려움, 오류 추적 어려움</p><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14>14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15>15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16>16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17>17</a>
</span><span class=lnt id=hl-6-18><a class=lnlinks href=#hl-6-18>18</a>
</span><span class=lnt id=hl-6-19><a class=lnlinks href=#hl-6-19>19</a>
</span><span class=lnt id=hl-6-20><a class=lnlinks href=#hl-6-20>20</a>
</span><span class=lnt id=hl-6-21><a class=lnlinks href=#hl-6-21>21</a>
</span><span class=lnt id=hl-6-22><a class=lnlinks href=#hl-6-22>22</a>
</span><span class=lnt id=hl-6-23><a class=lnlinks href=#hl-6-23>23</a>
</span><span class=lnt id=hl-6-24><a class=lnlinks href=#hl-6-24>24</a>
</span><span class=lnt id=hl-6-25><a class=lnlinks href=#hl-6-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 각 단계별로 독립적인 배치 프로그램을 작성하는 예시</span>
</span></span><span class=line><span class=cl><span class=c1># 1. 데이터 추출</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_data</span><span class=p>(</span><span class=n>input_path</span><span class=p>,</span> <span class=n>output_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>input_path</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>infile</span><span class=p>,</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_path</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>outfile</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>infile</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 데이터 전처리 및 필터링</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=s1>&#39;필요한 조건&#39;</span> <span class=ow>in</span> <span class=n>line</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>outfile</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. 데이터 변환</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>transform_data</span><span class=p>(</span><span class=n>input_path</span><span class=p>,</span> <span class=n>output_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>input_path</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>infile</span><span class=p>,</span> <span class=nb>open</span><span class=p>(</span><span class=n>output_path</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>outfile</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>infile</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 데이터 변환 로직 적용</span>
</span></span><span class=line><span class=cl>            <span class=n>transformed</span> <span class=o>=</span> <span class=n>line</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;old&#39;</span><span class=p>,</span> <span class=s1>&#39;new&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>outfile</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>transformed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. 데이터 적재</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>load_data</span><span class=p>(</span><span class=n>input_path</span><span class=p>,</span> <span class=n>db_conn</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>input_path</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>infile</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>infile</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 데이터베이스에 적재</span>
</span></span><span class=line><span class=cl>            <span class=n>db_conn</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 각 단계는 배치 스케줄러로 순차적으로 실행</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>각 단계는 독립적으로 실행되며, 중간 파일을 통해 데이터가 전달됩니다. 장애 발생 시 해당 단계만 재실행 가능합니다.</p></blockquote><h4 id=사례-3-대형-전자상거래-플랫폼의-일일-매출-분석-시스템>사례 3: 대형 전자상거래 플랫폼의 일일 매출 분석 시스템<a hidden class=anchor aria-hidden=true href=#사례-3-대형-전자상거래-플랫폼의-일일-매출-분석-시스템>#</a></h4><p><strong>시스템 구성:</strong></p><pre class=mermaid>graph TB
    subgraph &#34;데이터 소스&#34;
        A[주문 DB]
        B[결제 시스템]
        C[배송 추적]
        D[고객 DB]
    end
    
    subgraph &#34;배치 처리 파이프라인&#34;
        E[데이터 추출]
        F[데이터 정제]
        G[비즈니스 로직 적용]
        H[집계 및 계산]
        I[보고서 생성]
    end
    
    subgraph &#34;출력&#34;
        J[매출 대시보드]
        K[경영진 보고서]
        L[부서별 리포트]
    end
    
    A --&gt; E
    B --&gt; E
    C --&gt; E
    D --&gt; E
    
    E --&gt; F
    F --&gt; G
    G --&gt; H
    H --&gt; I
    
    I --&gt; J
    I --&gt; K
    I --&gt; L
</pre><p><strong>Workflow:</strong></p><ol><li><strong>데이터 추출 단계</strong>: 각 시스템에서 일일 데이터 추출 (오전 1 시 시작)</li><li><strong>데이터 정제 단계</strong>: 중복 제거, 누락 데이터 보정, 형식 통일</li><li><strong>비즈니스 로직 적용</strong>: 할인율 적용, 세금 계산, 배송비 정산</li><li><strong>집계 및 계산</strong>: 카테고리별, 지역별, 고객군별 매출 집계</li><li><strong>보고서 생성</strong>: 다양한 형태의 보고서 및 대시보드 데이터 생성</li></ol><p><strong>배치 순차 처리의 역할:</strong></p><ul><li><strong>데이터 일관성 보장</strong>: 모든 소스 데이터가 완전히 추출된 후 다음 단계 진행</li><li><strong>메모리 효율성</strong>: 수백만 건의 거래 데이터를 배치 단위로 처리</li><li><strong>오류 복구</strong>: 특정 단계 실패 시 해당 단계부터 재시작</li><li><strong>모니터링</strong>: 각 단계별 처리 현황 실시간 추적</li></ul><p><strong>배치 순차 처리 유무에 따른 차이점:</strong></p><ul><li><strong>적용 시:</strong><ul><li>안정적인 대용량 데이터 처리</li><li>명확한 오류 지점 파악</li><li>단계별 품질 검증 가능</li><li>예측 가능한 처리 시간</li></ul></li><li><strong>미적용 시:</strong><ul><li>메모리 부족으로 인한 시스템 다운 위험</li><li>전체 재처리 필요 시 비용 증가</li><li>복잡한 디버깅 과정</li><li>데이터 일관성 문제 발생 가능</li></ul></li></ul><p><strong>구현 예시</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>  1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>  2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>  3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>  4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>  5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6>  6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7>  7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8>  8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9>  9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10> 10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11> 11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12> 12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13> 13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14> 14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15> 15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16> 16</a>
</span><span class=lnt id=hl-8-17><a class=lnlinks href=#hl-8-17> 17</a>
</span><span class=lnt id=hl-8-18><a class=lnlinks href=#hl-8-18> 18</a>
</span><span class=lnt id=hl-8-19><a class=lnlinks href=#hl-8-19> 19</a>
</span><span class=lnt id=hl-8-20><a class=lnlinks href=#hl-8-20> 20</a>
</span><span class=lnt id=hl-8-21><a class=lnlinks href=#hl-8-21> 21</a>
</span><span class=lnt id=hl-8-22><a class=lnlinks href=#hl-8-22> 22</a>
</span><span class=lnt id=hl-8-23><a class=lnlinks href=#hl-8-23> 23</a>
</span><span class=lnt id=hl-8-24><a class=lnlinks href=#hl-8-24> 24</a>
</span><span class=lnt id=hl-8-25><a class=lnlinks href=#hl-8-25> 25</a>
</span><span class=lnt id=hl-8-26><a class=lnlinks href=#hl-8-26> 26</a>
</span><span class=lnt id=hl-8-27><a class=lnlinks href=#hl-8-27> 27</a>
</span><span class=lnt id=hl-8-28><a class=lnlinks href=#hl-8-28> 28</a>
</span><span class=lnt id=hl-8-29><a class=lnlinks href=#hl-8-29> 29</a>
</span><span class=lnt id=hl-8-30><a class=lnlinks href=#hl-8-30> 30</a>
</span><span class=lnt id=hl-8-31><a class=lnlinks href=#hl-8-31> 31</a>
</span><span class=lnt id=hl-8-32><a class=lnlinks href=#hl-8-32> 32</a>
</span><span class=lnt id=hl-8-33><a class=lnlinks href=#hl-8-33> 33</a>
</span><span class=lnt id=hl-8-34><a class=lnlinks href=#hl-8-34> 34</a>
</span><span class=lnt id=hl-8-35><a class=lnlinks href=#hl-8-35> 35</a>
</span><span class=lnt id=hl-8-36><a class=lnlinks href=#hl-8-36> 36</a>
</span><span class=lnt id=hl-8-37><a class=lnlinks href=#hl-8-37> 37</a>
</span><span class=lnt id=hl-8-38><a class=lnlinks href=#hl-8-38> 38</a>
</span><span class=lnt id=hl-8-39><a class=lnlinks href=#hl-8-39> 39</a>
</span><span class=lnt id=hl-8-40><a class=lnlinks href=#hl-8-40> 40</a>
</span><span class=lnt id=hl-8-41><a class=lnlinks href=#hl-8-41> 41</a>
</span><span class=lnt id=hl-8-42><a class=lnlinks href=#hl-8-42> 42</a>
</span><span class=lnt id=hl-8-43><a class=lnlinks href=#hl-8-43> 43</a>
</span><span class=lnt id=hl-8-44><a class=lnlinks href=#hl-8-44> 44</a>
</span><span class=lnt id=hl-8-45><a class=lnlinks href=#hl-8-45> 45</a>
</span><span class=lnt id=hl-8-46><a class=lnlinks href=#hl-8-46> 46</a>
</span><span class=lnt id=hl-8-47><a class=lnlinks href=#hl-8-47> 47</a>
</span><span class=lnt id=hl-8-48><a class=lnlinks href=#hl-8-48> 48</a>
</span><span class=lnt id=hl-8-49><a class=lnlinks href=#hl-8-49> 49</a>
</span><span class=lnt id=hl-8-50><a class=lnlinks href=#hl-8-50> 50</a>
</span><span class=lnt id=hl-8-51><a class=lnlinks href=#hl-8-51> 51</a>
</span><span class=lnt id=hl-8-52><a class=lnlinks href=#hl-8-52> 52</a>
</span><span class=lnt id=hl-8-53><a class=lnlinks href=#hl-8-53> 53</a>
</span><span class=lnt id=hl-8-54><a class=lnlinks href=#hl-8-54> 54</a>
</span><span class=lnt id=hl-8-55><a class=lnlinks href=#hl-8-55> 55</a>
</span><span class=lnt id=hl-8-56><a class=lnlinks href=#hl-8-56> 56</a>
</span><span class=lnt id=hl-8-57><a class=lnlinks href=#hl-8-57> 57</a>
</span><span class=lnt id=hl-8-58><a class=lnlinks href=#hl-8-58> 58</a>
</span><span class=lnt id=hl-8-59><a class=lnlinks href=#hl-8-59> 59</a>
</span><span class=lnt id=hl-8-60><a class=lnlinks href=#hl-8-60> 60</a>
</span><span class=lnt id=hl-8-61><a class=lnlinks href=#hl-8-61> 61</a>
</span><span class=lnt id=hl-8-62><a class=lnlinks href=#hl-8-62> 62</a>
</span><span class=lnt id=hl-8-63><a class=lnlinks href=#hl-8-63> 63</a>
</span><span class=lnt id=hl-8-64><a class=lnlinks href=#hl-8-64> 64</a>
</span><span class=lnt id=hl-8-65><a class=lnlinks href=#hl-8-65> 65</a>
</span><span class=lnt id=hl-8-66><a class=lnlinks href=#hl-8-66> 66</a>
</span><span class=lnt id=hl-8-67><a class=lnlinks href=#hl-8-67> 67</a>
</span><span class=lnt id=hl-8-68><a class=lnlinks href=#hl-8-68> 68</a>
</span><span class=lnt id=hl-8-69><a class=lnlinks href=#hl-8-69> 69</a>
</span><span class=lnt id=hl-8-70><a class=lnlinks href=#hl-8-70> 70</a>
</span><span class=lnt id=hl-8-71><a class=lnlinks href=#hl-8-71> 71</a>
</span><span class=lnt id=hl-8-72><a class=lnlinks href=#hl-8-72> 72</a>
</span><span class=lnt id=hl-8-73><a class=lnlinks href=#hl-8-73> 73</a>
</span><span class=lnt id=hl-8-74><a class=lnlinks href=#hl-8-74> 74</a>
</span><span class=lnt id=hl-8-75><a class=lnlinks href=#hl-8-75> 75</a>
</span><span class=lnt id=hl-8-76><a class=lnlinks href=#hl-8-76> 76</a>
</span><span class=lnt id=hl-8-77><a class=lnlinks href=#hl-8-77> 77</a>
</span><span class=lnt id=hl-8-78><a class=lnlinks href=#hl-8-78> 78</a>
</span><span class=lnt id=hl-8-79><a class=lnlinks href=#hl-8-79> 79</a>
</span><span class=lnt id=hl-8-80><a class=lnlinks href=#hl-8-80> 80</a>
</span><span class=lnt id=hl-8-81><a class=lnlinks href=#hl-8-81> 81</a>
</span><span class=lnt id=hl-8-82><a class=lnlinks href=#hl-8-82> 82</a>
</span><span class=lnt id=hl-8-83><a class=lnlinks href=#hl-8-83> 83</a>
</span><span class=lnt id=hl-8-84><a class=lnlinks href=#hl-8-84> 84</a>
</span><span class=lnt id=hl-8-85><a class=lnlinks href=#hl-8-85> 85</a>
</span><span class=lnt id=hl-8-86><a class=lnlinks href=#hl-8-86> 86</a>
</span><span class=lnt id=hl-8-87><a class=lnlinks href=#hl-8-87> 87</a>
</span><span class=lnt id=hl-8-88><a class=lnlinks href=#hl-8-88> 88</a>
</span><span class=lnt id=hl-8-89><a class=lnlinks href=#hl-8-89> 89</a>
</span><span class=lnt id=hl-8-90><a class=lnlinks href=#hl-8-90> 90</a>
</span><span class=lnt id=hl-8-91><a class=lnlinks href=#hl-8-91> 91</a>
</span><span class=lnt id=hl-8-92><a class=lnlinks href=#hl-8-92> 92</a>
</span><span class=lnt id=hl-8-93><a class=lnlinks href=#hl-8-93> 93</a>
</span><span class=lnt id=hl-8-94><a class=lnlinks href=#hl-8-94> 94</a>
</span><span class=lnt id=hl-8-95><a class=lnlinks href=#hl-8-95> 95</a>
</span><span class=lnt id=hl-8-96><a class=lnlinks href=#hl-8-96> 96</a>
</span><span class=lnt id=hl-8-97><a class=lnlinks href=#hl-8-97> 97</a>
</span><span class=lnt id=hl-8-98><a class=lnlinks href=#hl-8-98> 98</a>
</span><span class=lnt id=hl-8-99><a class=lnlinks href=#hl-8-99> 99</a>
</span><span class=lnt id=hl-8-100><a class=lnlinks href=#hl-8-100>100</a>
</span><span class=lnt id=hl-8-101><a class=lnlinks href=#hl-8-101>101</a>
</span><span class=lnt id=hl-8-102><a class=lnlinks href=#hl-8-102>102</a>
</span><span class=lnt id=hl-8-103><a class=lnlinks href=#hl-8-103>103</a>
</span><span class=lnt id=hl-8-104><a class=lnlinks href=#hl-8-104>104</a>
</span><span class=lnt id=hl-8-105><a class=lnlinks href=#hl-8-105>105</a>
</span><span class=lnt id=hl-8-106><a class=lnlinks href=#hl-8-106>106</a>
</span><span class=lnt id=hl-8-107><a class=lnlinks href=#hl-8-107>107</a>
</span><span class=lnt id=hl-8-108><a class=lnlinks href=#hl-8-108>108</a>
</span><span class=lnt id=hl-8-109><a class=lnlinks href=#hl-8-109>109</a>
</span><span class=lnt id=hl-8-110><a class=lnlinks href=#hl-8-110>110</a>
</span><span class=lnt id=hl-8-111><a class=lnlinks href=#hl-8-111>111</a>
</span><span class=lnt id=hl-8-112><a class=lnlinks href=#hl-8-112>112</a>
</span><span class=lnt id=hl-8-113><a class=lnlinks href=#hl-8-113>113</a>
</span><span class=lnt id=hl-8-114><a class=lnlinks href=#hl-8-114>114</a>
</span><span class=lnt id=hl-8-115><a class=lnlinks href=#hl-8-115>115</a>
</span><span class=lnt id=hl-8-116><a class=lnlinks href=#hl-8-116>116</a>
</span><span class=lnt id=hl-8-117><a class=lnlinks href=#hl-8-117>117</a>
</span><span class=lnt id=hl-8-118><a class=lnlinks href=#hl-8-118>118</a>
</span><span class=lnt id=hl-8-119><a class=lnlinks href=#hl-8-119>119</a>
</span><span class=lnt id=hl-8-120><a class=lnlinks href=#hl-8-120>120</a>
</span><span class=lnt id=hl-8-121><a class=lnlinks href=#hl-8-121>121</a>
</span><span class=lnt id=hl-8-122><a class=lnlinks href=#hl-8-122>122</a>
</span><span class=lnt id=hl-8-123><a class=lnlinks href=#hl-8-123>123</a>
</span><span class=lnt id=hl-8-124><a class=lnlinks href=#hl-8-124>124</a>
</span><span class=lnt id=hl-8-125><a class=lnlinks href=#hl-8-125>125</a>
</span><span class=lnt id=hl-8-126><a class=lnlinks href=#hl-8-126>126</a>
</span><span class=lnt id=hl-8-127><a class=lnlinks href=#hl-8-127>127</a>
</span><span class=lnt id=hl-8-128><a class=lnlinks href=#hl-8-128>128</a>
</span><span class=lnt id=hl-8-129><a class=lnlinks href=#hl-8-129>129</a>
</span><span class=lnt id=hl-8-130><a class=lnlinks href=#hl-8-130>130</a>
</span><span class=lnt id=hl-8-131><a class=lnlinks href=#hl-8-131>131</a>
</span><span class=lnt id=hl-8-132><a class=lnlinks href=#hl-8-132>132</a>
</span><span class=lnt id=hl-8-133><a class=lnlinks href=#hl-8-133>133</a>
</span><span class=lnt id=hl-8-134><a class=lnlinks href=#hl-8-134>134</a>
</span><span class=lnt id=hl-8-135><a class=lnlinks href=#hl-8-135>135</a>
</span><span class=lnt id=hl-8-136><a class=lnlinks href=#hl-8-136>136</a>
</span><span class=lnt id=hl-8-137><a class=lnlinks href=#hl-8-137>137</a>
</span><span class=lnt id=hl-8-138><a class=lnlinks href=#hl-8-138>138</a>
</span><span class=lnt id=hl-8-139><a class=lnlinks href=#hl-8-139>139</a>
</span><span class=lnt id=hl-8-140><a class=lnlinks href=#hl-8-140>140</a>
</span><span class=lnt id=hl-8-141><a class=lnlinks href=#hl-8-141>141</a>
</span><span class=lnt id=hl-8-142><a class=lnlinks href=#hl-8-142>142</a>
</span><span class=lnt id=hl-8-143><a class=lnlinks href=#hl-8-143>143</a>
</span><span class=lnt id=hl-8-144><a class=lnlinks href=#hl-8-144>144</a>
</span><span class=lnt id=hl-8-145><a class=lnlinks href=#hl-8-145>145</a>
</span><span class=lnt id=hl-8-146><a class=lnlinks href=#hl-8-146>146</a>
</span><span class=lnt id=hl-8-147><a class=lnlinks href=#hl-8-147>147</a>
</span><span class=lnt id=hl-8-148><a class=lnlinks href=#hl-8-148>148</a>
</span><span class=lnt id=hl-8-149><a class=lnlinks href=#hl-8-149>149</a>
</span><span class=lnt id=hl-8-150><a class=lnlinks href=#hl-8-150>150</a>
</span><span class=lnt id=hl-8-151><a class=lnlinks href=#hl-8-151>151</a>
</span><span class=lnt id=hl-8-152><a class=lnlinks href=#hl-8-152>152</a>
</span><span class=lnt id=hl-8-153><a class=lnlinks href=#hl-8-153>153</a>
</span><span class=lnt id=hl-8-154><a class=lnlinks href=#hl-8-154>154</a>
</span><span class=lnt id=hl-8-155><a class=lnlinks href=#hl-8-155>155</a>
</span><span class=lnt id=hl-8-156><a class=lnlinks href=#hl-8-156>156</a>
</span><span class=lnt id=hl-8-157><a class=lnlinks href=#hl-8-157>157</a>
</span><span class=lnt id=hl-8-158><a class=lnlinks href=#hl-8-158>158</a>
</span><span class=lnt id=hl-8-159><a class=lnlinks href=#hl-8-159>159</a>
</span><span class=lnt id=hl-8-160><a class=lnlinks href=#hl-8-160>160</a>
</span><span class=lnt id=hl-8-161><a class=lnlinks href=#hl-8-161>161</a>
</span><span class=lnt id=hl-8-162><a class=lnlinks href=#hl-8-162>162</a>
</span><span class=lnt id=hl-8-163><a class=lnlinks href=#hl-8-163>163</a>
</span><span class=lnt id=hl-8-164><a class=lnlinks href=#hl-8-164>164</a>
</span><span class=lnt id=hl-8-165><a class=lnlinks href=#hl-8-165>165</a>
</span><span class=lnt id=hl-8-166><a class=lnlinks href=#hl-8-166>166</a>
</span><span class=lnt id=hl-8-167><a class=lnlinks href=#hl-8-167>167</a>
</span><span class=lnt id=hl-8-168><a class=lnlinks href=#hl-8-168>168</a>
</span><span class=lnt id=hl-8-169><a class=lnlinks href=#hl-8-169>169</a>
</span><span class=lnt id=hl-8-170><a class=lnlinks href=#hl-8-170>170</a>
</span><span class=lnt id=hl-8-171><a class=lnlinks href=#hl-8-171>171</a>
</span><span class=lnt id=hl-8-172><a class=lnlinks href=#hl-8-172>172</a>
</span><span class=lnt id=hl-8-173><a class=lnlinks href=#hl-8-173>173</a>
</span><span class=lnt id=hl-8-174><a class=lnlinks href=#hl-8-174>174</a>
</span><span class=lnt id=hl-8-175><a class=lnlinks href=#hl-8-175>175</a>
</span><span class=lnt id=hl-8-176><a class=lnlinks href=#hl-8-176>176</a>
</span><span class=lnt id=hl-8-177><a class=lnlinks href=#hl-8-177>177</a>
</span><span class=lnt id=hl-8-178><a class=lnlinks href=#hl-8-178>178</a>
</span><span class=lnt id=hl-8-179><a class=lnlinks href=#hl-8-179>179</a>
</span><span class=lnt id=hl-8-180><a class=lnlinks href=#hl-8-180>180</a>
</span><span class=lnt id=hl-8-181><a class=lnlinks href=#hl-8-181>181</a>
</span><span class=lnt id=hl-8-182><a class=lnlinks href=#hl-8-182>182</a>
</span><span class=lnt id=hl-8-183><a class=lnlinks href=#hl-8-183>183</a>
</span><span class=lnt id=hl-8-184><a class=lnlinks href=#hl-8-184>184</a>
</span><span class=lnt id=hl-8-185><a class=lnlinks href=#hl-8-185>185</a>
</span><span class=lnt id=hl-8-186><a class=lnlinks href=#hl-8-186>186</a>
</span><span class=lnt id=hl-8-187><a class=lnlinks href=#hl-8-187>187</a>
</span><span class=lnt id=hl-8-188><a class=lnlinks href=#hl-8-188>188</a>
</span><span class=lnt id=hl-8-189><a class=lnlinks href=#hl-8-189>189</a>
</span><span class=lnt id=hl-8-190><a class=lnlinks href=#hl-8-190>190</a>
</span><span class=lnt id=hl-8-191><a class=lnlinks href=#hl-8-191>191</a>
</span><span class=lnt id=hl-8-192><a class=lnlinks href=#hl-8-192>192</a>
</span><span class=lnt id=hl-8-193><a class=lnlinks href=#hl-8-193>193</a>
</span><span class=lnt id=hl-8-194><a class=lnlinks href=#hl-8-194>194</a>
</span><span class=lnt id=hl-8-195><a class=lnlinks href=#hl-8-195>195</a>
</span><span class=lnt id=hl-8-196><a class=lnlinks href=#hl-8-196>196</a>
</span><span class=lnt id=hl-8-197><a class=lnlinks href=#hl-8-197>197</a>
</span><span class=lnt id=hl-8-198><a class=lnlinks href=#hl-8-198>198</a>
</span><span class=lnt id=hl-8-199><a class=lnlinks href=#hl-8-199>199</a>
</span><span class=lnt id=hl-8-200><a class=lnlinks href=#hl-8-200>200</a>
</span><span class=lnt id=hl-8-201><a class=lnlinks href=#hl-8-201>201</a>
</span><span class=lnt id=hl-8-202><a class=lnlinks href=#hl-8-202>202</a>
</span><span class=lnt id=hl-8-203><a class=lnlinks href=#hl-8-203>203</a>
</span><span class=lnt id=hl-8-204><a class=lnlinks href=#hl-8-204>204</a>
</span><span class=lnt id=hl-8-205><a class=lnlinks href=#hl-8-205>205</a>
</span><span class=lnt id=hl-8-206><a class=lnlinks href=#hl-8-206>206</a>
</span><span class=lnt id=hl-8-207><a class=lnlinks href=#hl-8-207>207</a>
</span><span class=lnt id=hl-8-208><a class=lnlinks href=#hl-8-208>208</a>
</span><span class=lnt id=hl-8-209><a class=lnlinks href=#hl-8-209>209</a>
</span><span class=lnt id=hl-8-210><a class=lnlinks href=#hl-8-210>210</a>
</span><span class=lnt id=hl-8-211><a class=lnlinks href=#hl-8-211>211</a>
</span><span class=lnt id=hl-8-212><a class=lnlinks href=#hl-8-212>212</a>
</span><span class=lnt id=hl-8-213><a class=lnlinks href=#hl-8-213>213</a>
</span><span class=lnt id=hl-8-214><a class=lnlinks href=#hl-8-214>214</a>
</span><span class=lnt id=hl-8-215><a class=lnlinks href=#hl-8-215>215</a>
</span><span class=lnt id=hl-8-216><a class=lnlinks href=#hl-8-216>216</a>
</span><span class=lnt id=hl-8-217><a class=lnlinks href=#hl-8-217>217</a>
</span><span class=lnt id=hl-8-218><a class=lnlinks href=#hl-8-218>218</a>
</span><span class=lnt id=hl-8-219><a class=lnlinks href=#hl-8-219>219</a>
</span><span class=lnt id=hl-8-220><a class=lnlinks href=#hl-8-220>220</a>
</span><span class=lnt id=hl-8-221><a class=lnlinks href=#hl-8-221>221</a>
</span><span class=lnt id=hl-8-222><a class=lnlinks href=#hl-8-222>222</a>
</span><span class=lnt id=hl-8-223><a class=lnlinks href=#hl-8-223>223</a>
</span><span class=lnt id=hl-8-224><a class=lnlinks href=#hl-8-224>224</a>
</span><span class=lnt id=hl-8-225><a class=lnlinks href=#hl-8-225>225</a>
</span><span class=lnt id=hl-8-226><a class=lnlinks href=#hl-8-226>226</a>
</span><span class=lnt id=hl-8-227><a class=lnlinks href=#hl-8-227>227</a>
</span><span class=lnt id=hl-8-228><a class=lnlinks href=#hl-8-228>228</a>
</span><span class=lnt id=hl-8-229><a class=lnlinks href=#hl-8-229>229</a>
</span><span class=lnt id=hl-8-230><a class=lnlinks href=#hl-8-230>230</a>
</span><span class=lnt id=hl-8-231><a class=lnlinks href=#hl-8-231>231</a>
</span><span class=lnt id=hl-8-232><a class=lnlinks href=#hl-8-232>232</a>
</span><span class=lnt id=hl-8-233><a class=lnlinks href=#hl-8-233>233</a>
</span><span class=lnt id=hl-8-234><a class=lnlinks href=#hl-8-234>234</a>
</span><span class=lnt id=hl-8-235><a class=lnlinks href=#hl-8-235>235</a>
</span><span class=lnt id=hl-8-236><a class=lnlinks href=#hl-8-236>236</a>
</span><span class=lnt id=hl-8-237><a class=lnlinks href=#hl-8-237>237</a>
</span><span class=lnt id=hl-8-238><a class=lnlinks href=#hl-8-238>238</a>
</span><span class=lnt id=hl-8-239><a class=lnlinks href=#hl-8-239>239</a>
</span><span class=lnt id=hl-8-240><a class=lnlinks href=#hl-8-240>240</a>
</span><span class=lnt id=hl-8-241><a class=lnlinks href=#hl-8-241>241</a>
</span><span class=lnt id=hl-8-242><a class=lnlinks href=#hl-8-242>242</a>
</span><span class=lnt id=hl-8-243><a class=lnlinks href=#hl-8-243>243</a>
</span><span class=lnt id=hl-8-244><a class=lnlinks href=#hl-8-244>244</a>
</span><span class=lnt id=hl-8-245><a class=lnlinks href=#hl-8-245>245</a>
</span><span class=lnt id=hl-8-246><a class=lnlinks href=#hl-8-246>246</a>
</span><span class=lnt id=hl-8-247><a class=lnlinks href=#hl-8-247>247</a>
</span><span class=lnt id=hl-8-248><a class=lnlinks href=#hl-8-248>248</a>
</span><span class=lnt id=hl-8-249><a class=lnlinks href=#hl-8-249>249</a>
</span><span class=lnt id=hl-8-250><a class=lnlinks href=#hl-8-250>250</a>
</span><span class=lnt id=hl-8-251><a class=lnlinks href=#hl-8-251>251</a>
</span><span class=lnt id=hl-8-252><a class=lnlinks href=#hl-8-252>252</a>
</span><span class=lnt id=hl-8-253><a class=lnlinks href=#hl-8-253>253</a>
</span><span class=lnt id=hl-8-254><a class=lnlinks href=#hl-8-254>254</a>
</span><span class=lnt id=hl-8-255><a class=lnlinks href=#hl-8-255>255</a>
</span><span class=lnt id=hl-8-256><a class=lnlinks href=#hl-8-256>256</a>
</span><span class=lnt id=hl-8-257><a class=lnlinks href=#hl-8-257>257</a>
</span><span class=lnt id=hl-8-258><a class=lnlinks href=#hl-8-258>258</a>
</span><span class=lnt id=hl-8-259><a class=lnlinks href=#hl-8-259>259</a>
</span><span class=lnt id=hl-8-260><a class=lnlinks href=#hl-8-260>260</a>
</span><span class=lnt id=hl-8-261><a class=lnlinks href=#hl-8-261>261</a>
</span><span class=lnt id=hl-8-262><a class=lnlinks href=#hl-8-262>262</a>
</span><span class=lnt id=hl-8-263><a class=lnlinks href=#hl-8-263>263</a>
</span><span class=lnt id=hl-8-264><a class=lnlinks href=#hl-8-264>264</a>
</span><span class=lnt id=hl-8-265><a class=lnlinks href=#hl-8-265>265</a>
</span><span class=lnt id=hl-8-266><a class=lnlinks href=#hl-8-266>266</a>
</span><span class=lnt id=hl-8-267><a class=lnlinks href=#hl-8-267>267</a>
</span><span class=lnt id=hl-8-268><a class=lnlinks href=#hl-8-268>268</a>
</span><span class=lnt id=hl-8-269><a class=lnlinks href=#hl-8-269>269</a>
</span><span class=lnt id=hl-8-270><a class=lnlinks href=#hl-8-270>270</a>
</span><span class=lnt id=hl-8-271><a class=lnlinks href=#hl-8-271>271</a>
</span><span class=lnt id=hl-8-272><a class=lnlinks href=#hl-8-272>272</a>
</span><span class=lnt id=hl-8-273><a class=lnlinks href=#hl-8-273>273</a>
</span><span class=lnt id=hl-8-274><a class=lnlinks href=#hl-8-274>274</a>
</span><span class=lnt id=hl-8-275><a class=lnlinks href=#hl-8-275>275</a>
</span><span class=lnt id=hl-8-276><a class=lnlinks href=#hl-8-276>276</a>
</span><span class=lnt id=hl-8-277><a class=lnlinks href=#hl-8-277>277</a>
</span><span class=lnt id=hl-8-278><a class=lnlinks href=#hl-8-278>278</a>
</span><span class=lnt id=hl-8-279><a class=lnlinks href=#hl-8-279>279</a>
</span><span class=lnt id=hl-8-280><a class=lnlinks href=#hl-8-280>280</a>
</span><span class=lnt id=hl-8-281><a class=lnlinks href=#hl-8-281>281</a>
</span><span class=lnt id=hl-8-282><a class=lnlinks href=#hl-8-282>282</a>
</span><span class=lnt id=hl-8-283><a class=lnlinks href=#hl-8-283>283</a>
</span><span class=lnt id=hl-8-284><a class=lnlinks href=#hl-8-284>284</a>
</span><span class=lnt id=hl-8-285><a class=lnlinks href=#hl-8-285>285</a>
</span><span class=lnt id=hl-8-286><a class=lnlinks href=#hl-8-286>286</a>
</span><span class=lnt id=hl-8-287><a class=lnlinks href=#hl-8-287>287</a>
</span><span class=lnt id=hl-8-288><a class=lnlinks href=#hl-8-288>288</a>
</span><span class=lnt id=hl-8-289><a class=lnlinks href=#hl-8-289>289</a>
</span><span class=lnt id=hl-8-290><a class=lnlinks href=#hl-8-290>290</a>
</span><span class=lnt id=hl-8-291><a class=lnlinks href=#hl-8-291>291</a>
</span><span class=lnt id=hl-8-292><a class=lnlinks href=#hl-8-292>292</a>
</span><span class=lnt id=hl-8-293><a class=lnlinks href=#hl-8-293>293</a>
</span><span class=lnt id=hl-8-294><a class=lnlinks href=#hl-8-294>294</a>
</span><span class=lnt id=hl-8-295><a class=lnlinks href=#hl-8-295>295</a>
</span><span class=lnt id=hl-8-296><a class=lnlinks href=#hl-8-296>296</a>
</span><span class=lnt id=hl-8-297><a class=lnlinks href=#hl-8-297>297</a>
</span><span class=lnt id=hl-8-298><a class=lnlinks href=#hl-8-298>298</a>
</span><span class=lnt id=hl-8-299><a class=lnlinks href=#hl-8-299>299</a>
</span><span class=lnt id=hl-8-300><a class=lnlinks href=#hl-8-300>300</a>
</span><span class=lnt id=hl-8-301><a class=lnlinks href=#hl-8-301>301</a>
</span><span class=lnt id=hl-8-302><a class=lnlinks href=#hl-8-302>302</a>
</span><span class=lnt id=hl-8-303><a class=lnlinks href=#hl-8-303>303</a>
</span><span class=lnt id=hl-8-304><a class=lnlinks href=#hl-8-304>304</a>
</span><span class=lnt id=hl-8-305><a class=lnlinks href=#hl-8-305>305</a>
</span><span class=lnt id=hl-8-306><a class=lnlinks href=#hl-8-306>306</a>
</span><span class=lnt id=hl-8-307><a class=lnlinks href=#hl-8-307>307</a>
</span><span class=lnt id=hl-8-308><a class=lnlinks href=#hl-8-308>308</a>
</span><span class=lnt id=hl-8-309><a class=lnlinks href=#hl-8-309>309</a>
</span><span class=lnt id=hl-8-310><a class=lnlinks href=#hl-8-310>310</a>
</span><span class=lnt id=hl-8-311><a class=lnlinks href=#hl-8-311>311</a>
</span><span class=lnt id=hl-8-312><a class=lnlinks href=#hl-8-312>312</a>
</span><span class=lnt id=hl-8-313><a class=lnlinks href=#hl-8-313>313</a>
</span><span class=lnt id=hl-8-314><a class=lnlinks href=#hl-8-314>314</a>
</span><span class=lnt id=hl-8-315><a class=lnlinks href=#hl-8-315>315</a>
</span><span class=lnt id=hl-8-316><a class=lnlinks href=#hl-8-316>316</a>
</span><span class=lnt id=hl-8-317><a class=lnlinks href=#hl-8-317>317</a>
</span><span class=lnt id=hl-8-318><a class=lnlinks href=#hl-8-318>318</a>
</span><span class=lnt id=hl-8-319><a class=lnlinks href=#hl-8-319>319</a>
</span><span class=lnt id=hl-8-320><a class=lnlinks href=#hl-8-320>320</a>
</span><span class=lnt id=hl-8-321><a class=lnlinks href=#hl-8-321>321</a>
</span><span class=lnt id=hl-8-322><a class=lnlinks href=#hl-8-322>322</a>
</span><span class=lnt id=hl-8-323><a class=lnlinks href=#hl-8-323>323</a>
</span><span class=lnt id=hl-8-324><a class=lnlinks href=#hl-8-324>324</a>
</span><span class=lnt id=hl-8-325><a class=lnlinks href=#hl-8-325>325</a>
</span><span class=lnt id=hl-8-326><a class=lnlinks href=#hl-8-326>326</a>
</span><span class=lnt id=hl-8-327><a class=lnlinks href=#hl-8-327>327</a>
</span><span class=lnt id=hl-8-328><a class=lnlinks href=#hl-8-328>328</a>
</span><span class=lnt id=hl-8-329><a class=lnlinks href=#hl-8-329>329</a>
</span><span class=lnt id=hl-8-330><a class=lnlinks href=#hl-8-330>330</a>
</span><span class=lnt id=hl-8-331><a class=lnlinks href=#hl-8-331>331</a>
</span><span class=lnt id=hl-8-332><a class=lnlinks href=#hl-8-332>332</a>
</span><span class=lnt id=hl-8-333><a class=lnlinks href=#hl-8-333>333</a>
</span><span class=lnt id=hl-8-334><a class=lnlinks href=#hl-8-334>334</a>
</span><span class=lnt id=hl-8-335><a class=lnlinks href=#hl-8-335>335</a>
</span><span class=lnt id=hl-8-336><a class=lnlinks href=#hl-8-336>336</a>
</span><span class=lnt id=hl-8-337><a class=lnlinks href=#hl-8-337>337</a>
</span><span class=lnt id=hl-8-338><a class=lnlinks href=#hl-8-338>338</a>
</span><span class=lnt id=hl-8-339><a class=lnlinks href=#hl-8-339>339</a>
</span><span class=lnt id=hl-8-340><a class=lnlinks href=#hl-8-340>340</a>
</span><span class=lnt id=hl-8-341><a class=lnlinks href=#hl-8-341>341</a>
</span><span class=lnt id=hl-8-342><a class=lnlinks href=#hl-8-342>342</a>
</span><span class=lnt id=hl-8-343><a class=lnlinks href=#hl-8-343>343</a>
</span><span class=lnt id=hl-8-344><a class=lnlinks href=#hl-8-344>344</a>
</span><span class=lnt id=hl-8-345><a class=lnlinks href=#hl-8-345>345</a>
</span><span class=lnt id=hl-8-346><a class=lnlinks href=#hl-8-346>346</a>
</span><span class=lnt id=hl-8-347><a class=lnlinks href=#hl-8-347>347</a>
</span><span class=lnt id=hl-8-348><a class=lnlinks href=#hl-8-348>348</a>
</span><span class=lnt id=hl-8-349><a class=lnlinks href=#hl-8-349>349</a>
</span><span class=lnt id=hl-8-350><a class=lnlinks href=#hl-8-350>350</a>
</span><span class=lnt id=hl-8-351><a class=lnlinks href=#hl-8-351>351</a>
</span><span class=lnt id=hl-8-352><a class=lnlinks href=#hl-8-352>352</a>
</span><span class=lnt id=hl-8-353><a class=lnlinks href=#hl-8-353>353</a>
</span><span class=lnt id=hl-8-354><a class=lnlinks href=#hl-8-354>354</a>
</span><span class=lnt id=hl-8-355><a class=lnlinks href=#hl-8-355>355</a>
</span><span class=lnt id=hl-8-356><a class=lnlinks href=#hl-8-356>356</a>
</span><span class=lnt id=hl-8-357><a class=lnlinks href=#hl-8-357>357</a>
</span><span class=lnt id=hl-8-358><a class=lnlinks href=#hl-8-358>358</a>
</span><span class=lnt id=hl-8-359><a class=lnlinks href=#hl-8-359>359</a>
</span><span class=lnt id=hl-8-360><a class=lnlinks href=#hl-8-360>360</a>
</span><span class=lnt id=hl-8-361><a class=lnlinks href=#hl-8-361>361</a>
</span><span class=lnt id=hl-8-362><a class=lnlinks href=#hl-8-362>362</a>
</span><span class=lnt id=hl-8-363><a class=lnlinks href=#hl-8-363>363</a>
</span><span class=lnt id=hl-8-364><a class=lnlinks href=#hl-8-364>364</a>
</span><span class=lnt id=hl-8-365><a class=lnlinks href=#hl-8-365>365</a>
</span><span class=lnt id=hl-8-366><a class=lnlinks href=#hl-8-366>366</a>
</span><span class=lnt id=hl-8-367><a class=lnlinks href=#hl-8-367>367</a>
</span><span class=lnt id=hl-8-368><a class=lnlinks href=#hl-8-368>368</a>
</span><span class=lnt id=hl-8-369><a class=lnlinks href=#hl-8-369>369</a>
</span><span class=lnt id=hl-8-370><a class=lnlinks href=#hl-8-370>370</a>
</span><span class=lnt id=hl-8-371><a class=lnlinks href=#hl-8-371>371</a>
</span><span class=lnt id=hl-8-372><a class=lnlinks href=#hl-8-372>372</a>
</span><span class=lnt id=hl-8-373><a class=lnlinks href=#hl-8-373>373</a>
</span><span class=lnt id=hl-8-374><a class=lnlinks href=#hl-8-374>374</a>
</span><span class=lnt id=hl-8-375><a class=lnlinks href=#hl-8-375>375</a>
</span><span class=lnt id=hl-8-376><a class=lnlinks href=#hl-8-376>376</a>
</span><span class=lnt id=hl-8-377><a class=lnlinks href=#hl-8-377>377</a>
</span><span class=lnt id=hl-8-378><a class=lnlinks href=#hl-8-378>378</a>
</span><span class=lnt id=hl-8-379><a class=lnlinks href=#hl-8-379>379</a>
</span><span class=lnt id=hl-8-380><a class=lnlinks href=#hl-8-380>380</a>
</span><span class=lnt id=hl-8-381><a class=lnlinks href=#hl-8-381>381</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>asyncio</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABC</span><span class=p>,</span> <span class=n>abstractmethod</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dataclasses</span> <span class=kn>import</span> <span class=n>dataclass</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span><span class=p>,</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>Any</span><span class=p>,</span> <span class=n>Optional</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 로깅 설정</span>
</span></span><span class=line><span class=cl><span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>BatchData</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;배치 데이터 클래스 - 단계 간 전달되는 데이터 구조&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span>
</span></span><span class=line><span class=cl>    <span class=n>metadata</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>batch_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>timestamp</span><span class=p>:</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ProcessingStage</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;추상 처리 단계 클래스 - 모든 처리 단계의 기본 인터페이스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>stage_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>stage_name</span> <span class=o>=</span> <span class=n>stage_name</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Stage.</span><span class=si>{</span><span class=n>stage_name</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>batch_data</span><span class=p>:</span> <span class=n>BatchData</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BatchData</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;실제 처리 로직을 구현하는 추상 메서드&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>execute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>batch_data</span><span class=p>:</span> <span class=n>BatchData</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BatchData</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;단계 실행 래퍼 - 로깅 및 오류 처리 포함&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Starting stage: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>stage_name</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>start_time</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>batch_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 처리 시간 계산 및 메타데이터 업데이트</span>
</span></span><span class=line><span class=cl>            <span class=n>processing_time</span> <span class=o>=</span> <span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span><span class=p>)</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>stage_name</span><span class=si>}</span><span class=s2>_processing_time&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>processing_time</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>stage_name</span><span class=si>}</span><span class=s2>_completed_at&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Completed stage: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>stage_name</span><span class=si>}</span><span class=s2> in </span><span class=si>{</span><span class=n>processing_time</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>s&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error in stage </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>stage_name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DataExtractionStage</span><span class=p>(</span><span class=n>ProcessingStage</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;데이터 추출 단계 - 다양한 소스에서 데이터 추출&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=s2>&#34;DataExtraction&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>batch_data</span><span class=p>:</span> <span class=n>BatchData</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BatchData</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;시뮬레이션된 데이터 추출 - 실제로는 데이터베이스에서 추출&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 시뮬레이션: 주문 데이터 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>sample_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10001</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&#34;CUST_</span><span class=si>{</span><span class=n>i</span><span class=o>%</span><span class=mi>1000</span><span class=si>:</span><span class=s2>04d</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10001</span><span class=p>)],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;product_category&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Electronics&#39;</span><span class=p>,</span> <span class=s1>&#39;Clothing&#39;</span><span class=p>,</span> <span class=s1>&#39;Books&#39;</span><span class=p>,</span> <span class=s1>&#39;Home&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>2500</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;order_amount&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>100</span> <span class=o>+</span> <span class=p>(</span><span class=n>i</span> <span class=o>%</span> <span class=mi>500</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10001</span><span class=p>)],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;order_date&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;2024-01-15&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>10000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;payment_status&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;PAID&#39;</span><span class=p>,</span> <span class=s1>&#39;PENDING&#39;</span><span class=p>,</span> <span class=s1>&#39;FAILED&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mi>3334</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 데이터 추출 시뮬레이션을 위한 지연</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>extracted_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>sample_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 메타데이터 업데이트</span>
</span></span><span class=line><span class=cl>        <span class=n>batch_data</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=n>extracted_df</span>
</span></span><span class=line><span class=cl>        <span class=n>batch_data</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>update</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;extracted_records&#39;</span><span class=p>:</span> <span class=nb>len</span><span class=p>(</span><span class=n>extracted_df</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;extraction_source&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;orders_db&#39;</span><span class=p>,</span> <span class=s1>&#39;payments_db&#39;</span><span class=p>,</span> <span class=s1>&#39;customers_db&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Extracted </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>extracted_df</span><span class=p>)</span><span class=si>}</span><span class=s2> records&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>batch_data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DataCleaningStage</span><span class=p>(</span><span class=n>ProcessingStage</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;데이터 정제 단계 - 데이터 품질 향상&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=s2>&#34;DataCleaning&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>batch_data</span><span class=p>:</span> <span class=n>BatchData</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BatchData</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터 정제 로직 수행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>df</span> <span class=o>=</span> <span class=n>batch_data</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 데이터 정제 작업들</span>
</span></span><span class=line><span class=cl>        <span class=n>original_count</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 1. 중복 제거</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>drop_duplicates</span><span class=p>(</span><span class=n>subset</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. 잘못된 결제 상태 데이터 필터링</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;payment_status&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>isin</span><span class=p>([</span><span class=s1>&#39;PAID&#39;</span><span class=p>,</span> <span class=s1>&#39;PENDING&#39;</span><span class=p>])]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. 음수 금액 제거</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;order_amount&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 4. 날짜 형식 정규화</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span><span class=p>[</span><span class=s1>&#39;order_date&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;order_date&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 정제 시뮬레이션을 위한 지연</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>cleaned_count</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 메타데이터 업데이트</span>
</span></span><span class=line><span class=cl>        <span class=n>batch_data</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=n>df</span>
</span></span><span class=line><span class=cl>        <span class=n>batch_data</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>update</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;original_records&#39;</span><span class=p>:</span> <span class=n>original_count</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;cleaned_records&#39;</span><span class=p>:</span> <span class=n>cleaned_count</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;removed_records&#39;</span><span class=p>:</span> <span class=n>original_count</span> <span class=o>-</span> <span class=n>cleaned_count</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;cleaning_rules_applied&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;duplicate_removal&#39;</span><span class=p>,</span> <span class=s1>&#39;payment_validation&#39;</span><span class=p>,</span> <span class=s1>&#39;amount_validation&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Cleaned data: </span><span class=si>{</span><span class=n>original_count</span><span class=si>}</span><span class=s2> -&gt; </span><span class=si>{</span><span class=n>cleaned_count</span><span class=si>}</span><span class=s2> records&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>batch_data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>BusinessLogicStage</span><span class=p>(</span><span class=n>ProcessingStage</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;비즈니스 로직 적용 단계 - 도메인 특화 계산&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=s2>&#34;BusinessLogic&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>batch_data</span><span class=p>:</span> <span class=n>BatchData</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BatchData</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;비즈니스 로직 적용&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>df</span> <span class=o>=</span> <span class=n>batch_data</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 비즈니스 로직 적용</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. 카테고리별 할인 적용</span>
</span></span><span class=line><span class=cl>        <span class=n>discount_rates</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Electronics&#39;</span><span class=p>:</span> <span class=mf>0.1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Clothing&#39;</span><span class=p>:</span> <span class=mf>0.15</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Books&#39;</span><span class=p>:</span> <span class=mf>0.05</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Home&#39;</span><span class=p>:</span> <span class=mf>0.12</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>df</span><span class=p>[</span><span class=s1>&#39;discount_rate&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;product_category&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>discount_rates</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span><span class=p>[</span><span class=s1>&#39;discount_amount&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;order_amount&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;discount_rate&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span><span class=p>[</span><span class=s1>&#39;final_amount&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;order_amount&#39;</span><span class=p>]</span> <span class=o>-</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;discount_amount&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. 세금 계산 (10%)</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span><span class=p>[</span><span class=s1>&#39;tax_amount&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;final_amount&#39;</span><span class=p>]</span> <span class=o>*</span> <span class=mf>0.1</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span><span class=p>[</span><span class=s1>&#39;total_amount&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;final_amount&#39;</span><span class=p>]</span> <span class=o>+</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;tax_amount&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. 고객 등급 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>customer_totals</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;customer_id&#39;</span><span class=p>)[</span><span class=s1>&#39;total_amount&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>customer_tiers</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>cut</span><span class=p>(</span><span class=n>customer_totals</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                              <span class=n>bins</span><span class=o>=</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1000</span><span class=p>,</span> <span class=mi>5000</span><span class=p>,</span> <span class=nb>float</span><span class=p>(</span><span class=s1>&#39;inf&#39;</span><span class=p>)],</span> 
</span></span><span class=line><span class=cl>                              <span class=n>labels</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Bronze&#39;</span><span class=p>,</span> <span class=s1>&#39;Silver&#39;</span><span class=p>,</span> <span class=s1>&#39;Gold&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>df</span><span class=p>[</span><span class=s1>&#39;customer_tier&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>map</span><span class=p>(</span><span class=n>customer_tiers</span><span class=o>.</span><span class=n>to_dict</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 비즈니스 로직 시뮬레이션을 위한 지연</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 메타데이터 업데이트</span>
</span></span><span class=line><span class=cl>        <span class=n>batch_data</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=n>df</span>
</span></span><span class=line><span class=cl>        <span class=n>batch_data</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>update</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;business_rules_applied&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;category_discount&#39;</span><span class=p>,</span> <span class=s1>&#39;tax_calculation&#39;</span><span class=p>,</span> <span class=s1>&#39;customer_tiering&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_revenue&#39;</span><span class=p>:</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;total_amount&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_discount_given&#39;</span><span class=p>:</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;discount_amount&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Applied business logic. Total revenue: </span><span class=si>{</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;total_amount&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>batch_data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AggregationStage</span><span class=p>(</span><span class=n>ProcessingStage</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;집계 단계 - 보고서용 집계 데이터 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=s2>&#34;Aggregation&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>batch_data</span><span class=p>:</span> <span class=n>BatchData</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BatchData</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터 집계 수행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>df</span> <span class=o>=</span> <span class=n>batch_data</span><span class=o>.</span><span class=n>data</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 다양한 관점에서 집계</span>
</span></span><span class=line><span class=cl>        <span class=n>aggregations</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 1. 카테고리별 집계</span>
</span></span><span class=line><span class=cl>        <span class=n>category_agg</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;product_category&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_amount&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;discount_amount&#39;</span><span class=p>:</span> <span class=s1>&#39;sum&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>aggregations</span><span class=p>[</span><span class=s1>&#39;by_category&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>category_agg</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. 고객 등급별 집계</span>
</span></span><span class=line><span class=cl>        <span class=n>tier_agg</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;customer_tier&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_amount&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;sum&#39;</span><span class=p>,</span> <span class=s1>&#39;mean&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=s1>&#39;nunique&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>aggregations</span><span class=p>[</span><span class=s1>&#39;by_tier&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>tier_agg</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. 결제 상태별 집계</span>
</span></span><span class=line><span class=cl>        <span class=n>payment_agg</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>groupby</span><span class=p>(</span><span class=s1>&#39;payment_status&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_amount&#39;</span><span class=p>:</span> <span class=s1>&#39;sum&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=s1>&#39;count&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>aggregations</span><span class=p>[</span><span class=s1>&#39;by_payment_status&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>payment_agg</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 집계 시뮬레이션을 위한 지연</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 집계 결과를 새로운 DataFrame으로 저장</span>
</span></span><span class=line><span class=cl>        <span class=n>summary_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;metric&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;total_orders&#39;</span><span class=p>,</span> <span class=s1>&#39;total_revenue&#39;</span><span class=p>,</span> <span class=s1>&#39;avg_order_value&#39;</span><span class=p>,</span> <span class=s1>&#39;total_customers&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;value&#39;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=n>df</span><span class=p>[</span><span class=s1>&#39;total_amount&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=n>df</span><span class=p>[</span><span class=s1>&#39;total_amount&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>mean</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=n>df</span><span class=p>[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>nunique</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>summary_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>summary_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 메타데이터 업데이트</span>
</span></span><span class=line><span class=cl>        <span class=n>batch_data</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=n>summary_df</span>
</span></span><span class=line><span class=cl>        <span class=n>batch_data</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>update</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;aggregations&#39;</span><span class=p>:</span> <span class=n>aggregations</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;summary_metrics&#39;</span><span class=p>:</span> <span class=n>summary_data</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Generated aggregations for </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>)</span><span class=si>}</span><span class=s2> records&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>batch_data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ReportGenerationStage</span><span class=p>(</span><span class=n>ProcessingStage</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;보고서 생성 단계 - 최종 보고서 작성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=s2>&#34;ReportGeneration&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>batch_data</span><span class=p>:</span> <span class=n>BatchData</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BatchData</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;보고서 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 보고서 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>report</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;report_date&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;batch_id&#39;</span><span class=p>:</span> <span class=n>batch_data</span><span class=o>.</span><span class=n>batch_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;processing_summary&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;total_processing_time&#39;</span><span class=p>:</span> <span class=nb>sum</span><span class=p>([</span>
</span></span><span class=line><span class=cl>                    <span class=n>batch_data</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>stage</span><span class=si>}</span><span class=s2>_processing_time&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>for</span> <span class=n>stage</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;DataExtraction&#39;</span><span class=p>,</span> <span class=s1>&#39;DataCleaning&#39;</span><span class=p>,</span> <span class=s1>&#39;BusinessLogic&#39;</span><span class=p>,</span> <span class=s1>&#39;Aggregation&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=p>]),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;records_processed&#39;</span><span class=p>:</span> <span class=n>batch_data</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;extracted_records&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;data_quality_score&#39;</span><span class=p>:</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>batch_data</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;cleaned_records&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>/</span> 
</span></span><span class=line><span class=cl>                    <span class=nb>max</span><span class=p>(</span><span class=n>batch_data</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;original_records&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;business_metrics&#39;</span><span class=p>:</span> <span class=n>batch_data</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;summary_metrics&#39;</span><span class=p>,</span> <span class=p>{}),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;aggregation_results&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>k</span><span class=p>:</span> <span class=n>v</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span> <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>v</span><span class=p>,</span> <span class=s1>&#39;to_dict&#39;</span><span class=p>)</span> <span class=k>else</span> <span class=nb>str</span><span class=p>(</span><span class=n>v</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>batch_data</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;aggregations&#39;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>items</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 보고서 생성 시뮬레이션을 위한 지연</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 보고서를 DataFrame으로 저장 (실제로는 파일이나 데이터베이스에 저장)</span>
</span></span><span class=line><span class=cl>        <span class=n>report_df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>([</span><span class=n>report</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>batch_data</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=n>report_df</span>
</span></span><span class=line><span class=cl>        <span class=n>batch_data</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;final_report&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>report</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Generated final report&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>batch_data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>BatchSequentialController</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;배치 순차 처리 컨트롤러 - 전체 파이프라인 제어&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>stages</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>ProcessingStage</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s2>&#34;BatchController&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_stage</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>stage</span><span class=p>:</span> <span class=n>ProcessingStage</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;처리 단계 추가&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>stages</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>stage</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Added stage: </span><span class=si>{</span><span class=n>stage</span><span class=o>.</span><span class=n>stage_name</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>execute_pipeline</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>initial_batch</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>BatchData</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>BatchData</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;전체 파이프라인 실행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 초기 배치 데이터 생성</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>initial_batch</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>initial_batch</span> <span class=o>=</span> <span class=n>BatchData</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>data</span><span class=o>=</span><span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=n>metadata</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;pipeline_start&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()},</span>
</span></span><span class=line><span class=cl>                <span class=n>batch_id</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;BATCH_</span><span class=si>{</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y%m</span><span class=si>%d</span><span class=s1>_%H%M%S&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>timestamp</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Starting pipeline execution for batch: </span><span class=si>{</span><span class=n>initial_batch</span><span class=o>.</span><span class=n>batch_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>pipeline_start</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>current_batch</span> <span class=o>=</span> <span class=n>initial_batch</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 각 단계를 순차적으로 실행</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>stage</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>stages</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Executing stage </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>stages</span><span class=p>)</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>stage</span><span class=o>.</span><span class=n>stage_name</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 단계 실행</span>
</span></span><span class=line><span class=cl>                <span class=n>current_batch</span> <span class=o>=</span> <span class=k>await</span> <span class=n>stage</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>current_batch</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 중간 체크포인트 로깅</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Stage </span><span class=si>{</span><span class=n>stage</span><span class=o>.</span><span class=n>stage_name</span><span class=si>}</span><span class=s2> completed successfully&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 파이프라인 완료</span>
</span></span><span class=line><span class=cl>            <span class=n>pipeline_duration</span> <span class=o>=</span> <span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span> <span class=o>-</span> <span class=n>pipeline_start</span><span class=p>)</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>current_batch</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;pipeline_duration&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>pipeline_duration</span>
</span></span><span class=line><span class=cl>            <span class=n>current_batch</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;pipeline_completed_at&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Pipeline execution completed in </span><span class=si>{</span><span class=n>pipeline_duration</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>s&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>current_batch</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Pipeline execution failed: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>current_batch</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;pipeline_error&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>current_batch</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s1>&#39;pipeline_failed_at&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메인 실행 함수</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;메인 실행 함수 - 전체 시스템 데모&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=== 배치 순차 처리 시스템 시작 ===</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 배치 컨트롤러 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>controller</span> <span class=o>=</span> <span class=n>BatchSequentialController</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 처리 단계들을 순서대로 추가</span>
</span></span><span class=line><span class=cl>    <span class=n>controller</span><span class=o>.</span><span class=n>add_stage</span><span class=p>(</span><span class=n>DataExtractionStage</span><span class=p>())</span>      <span class=c1># 1. 데이터 추출</span>
</span></span><span class=line><span class=cl>    <span class=n>controller</span><span class=o>.</span><span class=n>add_stage</span><span class=p>(</span><span class=n>DataCleaningStage</span><span class=p>())</span>        <span class=c1># 2. 데이터 정제</span>
</span></span><span class=line><span class=cl>    <span class=n>controller</span><span class=o>.</span><span class=n>add_stage</span><span class=p>(</span><span class=n>BusinessLogicStage</span><span class=p>())</span>       <span class=c1># 3. 비즈니스 로직 적용</span>
</span></span><span class=line><span class=cl>    <span class=n>controller</span><span class=o>.</span><span class=n>add_stage</span><span class=p>(</span><span class=n>AggregationStage</span><span class=p>())</span>         <span class=c1># 4. 집계</span>
</span></span><span class=line><span class=cl>    <span class=n>controller</span><span class=o>.</span><span class=n>add_stage</span><span class=p>(</span><span class=n>ReportGenerationStage</span><span class=p>())</span>    <span class=c1># 5. 보고서 생성</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 파이프라인 실행</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>controller</span><span class=o>.</span><span class=n>execute_pipeline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 결과 출력</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>=== 실행 결과 ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;배치 ID: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>batch_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;총 처리 시간: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;pipeline_duration&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>초&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;데이터 품질 점수: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;final_report&#39;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;processing_summary&#39;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;data_quality_score&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>%&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 최종 보고서 출력</span>
</span></span><span class=line><span class=cl>        <span class=n>final_report</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;final_report&#39;</span><span class=p>,</span> <span class=p>{})</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>final_report</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>=== 비즈니스 메트릭 ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>metric</span> <span class=ow>in</span> <span class=n>final_report</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;business_metrics&#39;</span><span class=p>,</span> <span class=p>{})</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;metric&#39;</span><span class=p>,</span> <span class=p>[]):</span>
</span></span><span class=line><span class=cl>                <span class=n>idx</span> <span class=o>=</span> <span class=n>final_report</span><span class=p>[</span><span class=s1>&#39;business_metrics&#39;</span><span class=p>][</span><span class=s1>&#39;metric&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>metric</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>value</span> <span class=o>=</span> <span class=n>final_report</span><span class=p>[</span><span class=s1>&#39;business_metrics&#39;</span><span class=p>][</span><span class=s1>&#39;value&#39;</span><span class=p>][</span><span class=n>idx</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>metric</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>value</span><span class=si>:</span><span class=s2>,f</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>value</span><span class=p>,</span> <span class=p>(</span><span class=nb>int</span><span class=p>,</span> <span class=nb>float</span><span class=p>))</span> <span class=k>else</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>metric</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>=== 배치 순차 처리 완료 ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>❌ 파이프라인 실행 중 오류 발생: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 비동기 실행</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>main</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p>이 구현 예시는 전자상거래 매출 분석 시스템의 배치 순차 처리를 보여준다. 각 단계는 독립적으로 실행되며, 이전 단계의 완전한 출력을 받아 처리한 후 다음 단계로 전달한다.</p><p><strong>주요 구현 특징:</strong></p><ul><li><strong>추상화된 단계 설계</strong>: <code>ProcessingStage</code> 추상 클래스로 일관된 인터페이스 제공</li><li><strong>메타데이터 추적</strong>: 각 단계의 처리 시간과 품질 지표 추적</li><li><strong>오류 처리</strong>: 단계별 예외 처리와 상세한 로깅</li><li><strong>배치 데이터 구조</strong>: 데이터와 메타데이터를 함께 관리하는 구조화된 접근</li></ul><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>카테고리</th><th>고려사항</th><th>상세 설명</th><th>권장사항</th></tr></thead><tbody><tr><td><strong>설계</strong></td><td>단계별 독립성 보장</td><td>각 처리 단계 간 의존성 최소화로 유연한 유지보수 및 재사용 가능</td><td>표준화된 데이터 포맷 및 API 설계</td></tr><tr><td></td><td>배치 크기 최적화</td><td>과도한 배치 크기는 메모리 부족 유발, 너무 작으면 오버헤드 증가</td><td>시스템 리소스의 70~80% 활용 기준으로 설정</td></tr><tr><td></td><td>병렬 처리 설계</td><td>단일 단계의 처리 병목 제거를 위해 병렬 실행 전략 필요</td><td>스레드 풀 또는 멀티 파티션 구조 채택</td></tr><tr><td></td><td>단계 분할 구조 설계</td><td>데이터 증가에 대비해 병렬화 가능한 구조로 각 단계를 세분화</td><td>논리적 책임 기준으로 처리 단계를 분리</td></tr><tr><td><strong>구현</strong></td><td>체크포인트 전략</td><td>장애 발생 시 중복 없이 재처리 가능한 시점 기록 필요</td><td>처리 시간의 10~20% 단위로 checkpoint 설정</td></tr><tr><td></td><td>중간 저장소 선택</td><td>I/O 병목 또는 장애 발생 방지용 고신뢰 저장소 필요</td><td>SSD 기반 로컬 디스크 또는 인메모리 DB</td></tr><tr><td></td><td>스키마 변경 대응</td><td>스키마 변경 시 파이프라인 전체 실패 가능성 있음</td><td>Schema Registry + Backward 호환성 검증</td></tr><tr><td></td><td>Idempotent 처리</td><td>재시작 시 중복 처리 방지 필요</td><td>키 기반 중복 제거, 트랜잭션 기반 처리</td></tr><tr><td><strong>운영</strong></td><td>모니터링 체계 구축</td><td>각 단계의 처리 시간, 실패율 등 실시간 추적 가능해야 함</td><td>Prometheus, SLA 기반 Alert 구성</td></tr><tr><td></td><td>리소스 관리 및 최적화</td><td>고정 리소스는 비용 낭비, 낮은 활용률 문제 발생 가능</td><td>오토스케일링, 동적 리소스 할당 (KEDA 등)</td></tr><tr><td></td><td>배치 스케줄링 자동화</td><td>정기적 실행 및 재시작을 자동으로 처리하는 구조 필요</td><td>Airflow, Argo Workflows, CronJob 사용</td></tr><tr><td></td><td>중간 파일 무결성 관리</td><td>중간 결과 파일 손상 시 전체 플로우 오류 발생 가능성</td><td>Checksum, 버전 관리, 백업 주기 설정</td></tr><tr><td><strong>성능</strong></td><td>데이터 압축</td><td>중간 데이터 저장소의 I/O, 디스크 공간 최적화</td><td>Gzip 또는 Snappy 적용, 컬럼 포맷 사용</td></tr><tr><td></td><td>직렬화 포맷 최적화</td><td>데이터 직렬화는 네트워크 및 디스크 효율성에 직접적인 영향</td><td>Avro, Protobuf 등 이진 포맷 권장</td></tr><tr><td><strong>장애 대응</strong></td><td>단계별 오류 감지 및 복구</td><td>특정 단계 오류 시 전체 재실행보다 국소적 복구가 효과적</td><td>상세 로깅 + 재시작 가능 구조 설계</td></tr><tr><td></td><td>재시작 시 안정성 확보</td><td>재시작 시 상태 불일치 또는 중복 실행 위험 있음</td><td>상태 기반 처리 보완, 정확한 처리 순서 보장</td></tr><tr><td><strong>비용/유지보수</strong></td><td>리소스 비용 최적화</td><td>고정 VM 기반 구성 시 사용량 대비 과금 손실</td><td>스팟 인스턴스, 비용 스케줄러 도입</td></tr><tr><td></td><td>고비용 시간 회피</td><td>리전 또는 시간대에 따라 리소스 비용 차이 발생</td><td>비용 인식형 스케줄링 정책 구성 (예: 야간 실행)</td></tr></tbody></table><h4 id=성능-측정-지표-performance-metrics>성능 측정 지표 (Performance Metrics)<a hidden class=anchor aria-hidden=true href=#성능-측정-지표-performance-metrics>#</a></h4><p>배치 순차 처리 시스템의 효율성을 측정하기 위한 핵심 지표들:</p><ul><li><strong>처리량 (Throughput)</strong>: 단위 시간당 처리되는 레코드 수</li><li><strong>지연 시간 (Latency)</strong>: 배치 시작부터 완료까지의 총 시간</li><li><strong>리소스 사용률</strong>: CPU, 메모리, 디스크 I/O 사용률</li><li><strong>에러율</strong>: 전체 배치 중 실패한 배치의 비율</li><li><strong>데이터 품질 점수</strong>: 입력 대비 성공적으로 처리된 데이터 비율</li></ul><h4 id=보안-고려사항-security-considerations>보안 고려사항 (Security Considerations)<a hidden class=anchor aria-hidden=true href=#보안-고려사항-security-considerations>#</a></h4><p>배치 처리 시스템에서 고려해야 할 보안 요소들:</p><ul><li><strong>데이터 암호화</strong>: 전송 중 및 저장 시 데이터 암호화</li><li><strong>접근 제어</strong>: 역할 기반 접근 제어 (RBAC, Role-Based Access Control)</li><li><strong>감사 로그</strong>: 모든 처리 단계의 상세 로그 기록</li><li><strong>데이터 마스킹</strong>: 민감한 정보의 마스킹 처리</li></ul><h4 id=테스트-전략-testing-strategy>테스트 전략 (Testing Strategy)<a hidden class=anchor aria-hidden=true href=#테스트-전략-testing-strategy>#</a></h4><p>배치 시스템의 효과적인 테스트 방법:</p><ul><li><strong>단위 테스트</strong>: 각 처리 단계의 개별 테스트</li><li><strong>통합 테스트</strong>: 전체 파이프라인의 종단간 테스트</li><li><strong>성능 테스트</strong>: 대용량 데이터를 이용한 부하 테스트</li><li><strong>장애 테스트</strong>: 의도적 장애 주입을 통한 복구 테스트</li></ul><h4 id=데이터-거버넌스-data-governance>데이터 거버넌스 (Data Governance)<a hidden class=anchor aria-hidden=true href=#데이터-거버넌스-data-governance>#</a></h4><p>배치 처리에서의 데이터 관리 원칙:</p><ul><li><strong>데이터 린나지</strong>: 데이터의 출처와 변환 과정 추적</li><li><strong>데이터 품질 관리</strong>: 자동화된 품질 검증 체계</li><li><strong>메타데이터 관리</strong>: 데이터 스키마와 의미 정보 관리</li><li><strong>규정 준수</strong>: GDPR, CCPA 등 데이터 보호 규정 준수</li></ul><h3 id=최적화를-위한-고려사항-및-주의할-점>최적화를 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화를-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>항목</strong></th><th><strong>설명</strong></th><th><strong>권장 사항</strong></th></tr></thead><tbody><tr><td><strong>1. 시스템 자원 최적화</strong></td><td>배치 크기 (Chunk Size)</td><td>크기가 너무 작으면 I/O 오버헤드, 너무 크면 메모리 초과</td><td>500~2000 건 단위로 테스트 후 최적값 설정</td></tr><tr><td></td><td>메모리 관리 및 GC 튜닝</td><td>JVM/Python 환경에서 GC 설정 미흡 시 성능 저하 발생</td><td>세대별 GC 전략 설정, 힙 사이즈 최적화, <code>-XX:+UseG1GC</code> 등 활용</td></tr><tr><td></td><td>파일/스토리지 정리</td><td>중간 파일 방치 시 디스크 사용량 증가</td><td>임시 파일 압축 저장, 종료 후 자동 삭제 스크립트 실행</td></tr><tr><td></td><td>캐싱 전략</td><td>자주 참조되는 중간 데이터를 재처리하지 않고 활용</td><td>메모리 기반 LRU 캐시, Redis 등 외부 캐시 활용</td></tr><tr><td></td><td>병렬도 제어</td><td>병렬 처리 시 DB Lock 또는 리소스 경합 발생 가능</td><td>파티셔닝 기반 병렬 처리, Lock 발생 여부 사전 테스트, 스레드 수 제한 설정</td></tr><tr><td><strong>2. 성능 최적화</strong></td><td>디스크/네트워크 I/O 최적화</td><td>랜덤 액세스 및 병목 발생 시 전체 처리 지연</td><td>순차 I/O 처리, 대용량 블록 설정, TCP 버퍼 튜닝, 압축 및 전송 최소화</td></tr><tr><td></td><td>정렬/인덱싱 알고리즘</td><td>중간 결과 정렬 시 메모리 초과/속도 저하 가능</td><td>외부 정렬 알고리즘 (Merge Sort), B+ 트리 기반 인덱싱 활용</td></tr><tr><td></td><td>로드 밸런싱 및 스케줄링</td><td>병렬 처리 시 특정 노드/프로세스에 부하 집중</td><td>라운드 로빈 또는 가중치 기반 작업 분산, 작업 단위 재조정</td></tr><tr><td><strong>3. 운영 및 관리</strong></td><td>실행 제어 자동화</td><td>cron 기반 수동 제어 시 에러 대응 어려움</td><td>Airflow, Spring Batch 등 프레임워크 기반 실행 제어</td></tr><tr><td></td><td>모니터링 및 알림</td><td>로그 부족 시 에러 추적/운영 가시성 저하</td><td>Prometheus, ELK, Grafana 등 통합 대시보드 구축</td></tr><tr><td></td><td>리소스 스케줄 제어</td><td>병렬 Job 간 리소스 경합으로 인한 처리 실패 가능</td><td>QoS 설정, 우선순위 기반 스케줄링, 야간 처리 시간 분산 운영</td></tr><tr><td><strong>4. 장애 복원력</strong></td><td>체크포인트 설정 빈도</td><td>잦은 저장은 성능 저하, 없을 경우 복구 어려움</td><td>1,000~5,000 건 단위 또는 단계별로 커밋, 실패 대비를 위한 증분 스냅샷 적용</td></tr><tr><td></td><td>자동 재처리 및 복구 전략</td><td>실패 시 전체 재시작으로 운영 부담 가중</td><td>단계별 재시작 구조 설계, 실패 알림 및 복구 자동화 스크립트 도입</td></tr><tr><td></td><td>스키마 변경 대응</td><td>스키마 변경 시 파이프라인 붕괴 가능성</td><td>Schema Registry 도입, 역방향/정방향 호환 정책 명문화</td></tr></tbody></table><h3 id=주제와-관련하여-주목할-내용>주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#주제와-관련하여-주목할-내용>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>주제</strong></th><th><strong>항목</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>1. 아키텍처 패턴</strong></td><td>파이프라인 아키텍처</td><td>단계별 직렬 처리 구조</td><td>데이터가 입력 → 처리 → 출력 단계로 순차적으로 흐르는 고전적 처리 방식</td></tr><tr><td></td><td>이벤트 기반 아키텍처</td><td>트리거 기반 비동기 실행</td><td>특정 이벤트 발생 시 실행되는 트리거 방식으로 배치 스케줄링 또는 실시간 이벤트 처리와 결합 가능</td></tr><tr><td><strong>2. 데이터 처리 방식</strong></td><td>ETL/ELT 파이프라인</td><td>추출 → 변환 → 적재</td><td>전통적인 대용량 배치 처리 구조. ELT 는 저장소 후 변환 방식으로 Cloud DW 에서 채택 중</td></tr><tr><td></td><td>스트림 - 배치 하이브리드</td><td>실시간 흐름의 마이크로 배치화</td><td>실시간성과 일괄 처리를 융합하여 배치 지연을 줄이고 스트림 특성도 흡수. 예: Spark Structured Streaming</td></tr><tr><td><strong>3. 분산 처리 구조</strong></td><td>마이크로서비스</td><td>처리 단계를 독립적 서비스로 구성</td><td>각 Step 을 서비스화하여 모듈 간 결합도 낮추고 병렬 실행 또는 장애 격리 용이</td></tr><tr><td></td><td>컨테이너 오케스트레이션</td><td>Kubernetes 기반 배치 실행</td><td>배치 작업을 컨테이너화하여 K8s Job/CronJob 으로 스케줄링 및 확장성 확보</td></tr><tr><td><strong>4. 클라우드 전략</strong></td><td>서버리스 배치</td><td>Function 기반 실행 모델</td><td>AWS Lambda, Azure Functions 등에서 이벤트 기반으로 배치 단위 실행 가능</td></tr><tr><td></td><td>관리형 배치 서비스</td><td>배치 실행/오케스트레이션 제공 플랫폼</td><td>AWS Batch, Google Cloud Dataflow 등 클라우드에서 배치 실행과 리소스 관리를 추상화</td></tr><tr><td><strong>5. 운영 및 자동화</strong></td><td>배치 스케줄러</td><td>정기 실행 및 의존성 관리</td><td>cron, Airflow, Spring Batch 등을 통해 주기적 또는 DAG 기반 제어 가능</td></tr><tr><td></td><td>자동 복구/재처리</td><td>실패 시 자동 재시작 또는 롤백 지원</td><td>체크포인트, 트랜잭션 단위 재실행 전략 도입으로 운영 효율성 증대</td></tr><tr><td><strong>6. 성능 및 확장성</strong></td><td>병렬 처리 및 파티셔닝</td><td>대용량 처리 속도 개선</td><td>데이터를 파티션 단위로 나누어 병렬 실행, 멀티 쓰레드 또는 다중 노드 확장 구조 가능</td></tr><tr><td></td><td>Dynamic Scaling</td><td>자원 자동 할당 및 조정</td><td>클러스터 또는 서버리스 기반으로 수요에 따라 리소스 자동 확장 가능</td></tr><tr><td><strong>7. 보안 및 관찰성</strong></td><td>데이터 암호화</td><td>저장 및 전송 시 암호화 적용</td><td>Encryption-at-rest/in-transit 로 보안 요건 충족</td></tr><tr><td></td><td>통합 관찰성 (Observability)</td><td>로그, 메트릭, 트레이싱 통합 관제</td><td>OpenTelemetry, Prometheus, Grafana 기반 통합 대시보드로 배치 상태 추적 및 알림 가능</td></tr></tbody></table><h3 id=반드시-학습해야할-내용>반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야할-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>이론 기초</strong></td><td>데이터 구조 및 알고리즘</td><td>큐, 스택, 정렬, 검색, B+ 트리</td><td>배치 처리에 적합한 기본 자료구조와 알고리즘 이해</td></tr><tr><td></td><td>운영체제 개념</td><td>프로세스 스케줄링, 가상 메모리</td><td>배치 작업의 OS 수준 자원 제어 방식</td></tr><tr><td></td><td>네트워킹 및 통신 원리</td><td>TCP/IP, 부하 분산</td><td>분산 배치 환경에서의 네트워크 효율성 확보</td></tr><tr><td></td><td>분산 시스템 이론</td><td>CAP 정리, Raft, Paxos</td><td>일관성 - 가용성 균형과 분산 환경의 상태 관리 핵심</td></tr><tr><td><strong>시스템 구조 및 아키텍처</strong></td><td>데이터 플로우 아키텍처</td><td>Batch Sequential, Pipe-and-Filter 등</td><td>단계 기반 데이터 처리 방식과 흐름 제어 이해</td></tr><tr><td></td><td>하이브리드 처리 아키텍처</td><td>Lambda, Kappa, Hybrid 모델</td><td>배치 - 실시간 결합 처리 방식 구조 이해</td></tr><tr><td><strong>프레임워크 및 도구</strong></td><td>배치 처리 프레임워크</td><td>Spring Batch (Job, Step, Repository 등)</td><td>표준 오픈소스 배치 프레임워크 구성요소 이해</td></tr><tr><td></td><td>워크플로우 및 스케줄링 엔진</td><td>Apache Airflow, Azure Data Factory (DAG, Sensor 등)</td><td>배치 실행 흐름 및 의존성 제어 도구</td></tr><tr><td><strong>운영 및 실무 전략</strong></td><td>배치 자동화 및 운영 최적화</td><td>스케줄러 활용, 모니터링 지표 정의</td><td>반복 작업 자동화 및 실시간 운영 대응 전략</td></tr><tr><td></td><td>장애 대응 및 복구 전략</td><td>오류 감지, 체크포인트, 재시작, 로그 추적</td><td>장애 시 정확한 재처리와 SLA 보장</td></tr><tr><td><strong>데이터 품질 및 일관성</strong></td><td>데이터 정합성 보장</td><td>ACID 트랜잭션, CDC, Idempotency</td><td>데이터 중복 제거 및 일관성 유지 메커니즘</td></tr><tr><td></td><td>스키마 및 데이터 무결성 관리</td><td>스키마 버전 관리, 검증, 프로파일링</td><td>데이터 처리 중 스키마 변경 대응 및 오류 방지</td></tr><tr><td><strong>성능 최적화 전략</strong></td><td>병렬 처리 및 파티셔닝</td><td>멀티 파티션 처리, 병렬 Step 설계</td><td>대용량 데이터 처리 성능 극대화</td></tr><tr><td></td><td>리소스/비용 최적화</td><td>리소스 격리, 배치 크기 튜닝, 오토스케일링</td><td>비용 - 성능 균형 유지 및 클라우드 운영 효율화</td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th><strong>카테고리</strong></th><th><strong>용어</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>아키텍처 패턴</strong></td><td>배치 순차 처리 (Batch Sequential)</td><td>데이터를 일정 단위로 순차 처리하는 구조적 아키텍처 스타일</td></tr><tr><td></td><td>데이터 플로우 아키텍처 (Data-Flow Architecture)</td><td>데이터 흐름을 중심으로 구성되는 아키텍처. 각 처리 단계를 명확히 분리하여 구성</td></tr><tr><td></td><td>파이프라인 (Pipeline)</td><td>입력 → 처리 → 출력 구조로 순차적 단계를 거치는 처리 방식</td></tr><tr><td></td><td>백프레셔 (Backpressure)</td><td>처리 속도 불균형을 감지하고 생산자 또는 중간단계에 압력을 가해 흐름을 제어하는 메커니즘</td></tr><tr><td><strong>배치 구성 요소</strong></td><td>Job</td><td>전체 배치 작업 단위를 나타내는 추상적 개념</td></tr><tr><td></td><td>Step</td><td>Job 내 개별 처리 단계. Reader, Processor, Writer 등으로 구성</td></tr><tr><td></td><td>Chunk</td><td>트랜잭션 단위 데이터 묶음. 예: 1000 건 단위 커밋</td></tr><tr><td></td><td>Checkpoint</td><td>실패 발생 시 재처리를 위한 상태 저장 지점. 장애 복구에 필수</td></tr><tr><td></td><td>Partitioning</td><td>데이터를 파티션 단위로 분할하여 병렬 처리하는 전략</td></tr><tr><td></td><td>Intermediate Storage / File</td><td>단계 간 데이터를 전달하기 위한 임시 저장소. 파일, 큐, 테이블 등 활용 가능</td></tr><tr><td><strong>데이터 처리</strong></td><td>ETL (Extract, Transform, Load)</td><td>데이터 추출, 변환, 적재의 일괄 처리 과정</td></tr><tr><td></td><td>마이크로 배치 (Micro-batch)</td><td>소규모 배치를 연속 처리하여 스트리밍과 유사한 성능을 얻는 방식 (Spark Structured Streaming 등)</td></tr><tr><td></td><td>데이터 린나지 (Data Lineage)</td><td>데이터가 어떤 경로와 변환을 거쳐 현재 상태에 도달했는지를 추적하는 메타 정보</td></tr><tr><td></td><td>CDC (Change Data Capture)</td><td>소스 시스템에서 발생한 변경 사항을 실시간 또는 배치로 추출하는 기술</td></tr><tr><td><strong>운영/자동화</strong></td><td>배치 스케줄러 (Batch Scheduler)</td><td>정해진 시간에 작업을 자동 실행하는 도구. 예: cron, Airflow 등</td></tr><tr><td></td><td>DAG (Directed Acyclic Graph)</td><td>배치 실행의 순서를 정의하는 비순환 방향성 그래프 구조. 의존성 관리에 유용</td></tr><tr><td></td><td>워크플로우 엔진</td><td>여러 작업 단계를 정의하고 실행 순서 및 조건을 관리하는 시스템 (ex. Spring Batch, Airflow)</td></tr><tr><td><strong>시스템 속성</strong></td><td>멱등성 (Idempotency)</td><td>동일 작업이 여러 번 실행되어도 결과가 변하지 않는 특성</td></tr><tr><td></td><td>장애 허용성 (Fault Tolerance)</td><td>일부 실패에도 시스템 전체가 계속 작동하도록 설계된 특성</td></tr><tr><td></td><td>수평적 확장 (Horizontal Scaling)</td><td>서버/노드 수 증가를 통해 시스템 성능을 확장하는 구조적 방식</td></tr><tr><td><strong>성능 최적화</strong></td><td>지연 로딩 (Lazy Loading)</td><td>필요할 때만 데이터를 불러와 메모리 사용을 최소화하는 방식</td></tr><tr><td></td><td>메모리 풀링 (Memory Pooling)</td><td>자주 사용하는 객체를 메모리에 미리 할당하고 재사용하여 성능 향상</td></tr><tr><td></td><td>외부 정렬 (External Sorting)</td><td>메모리보다 큰 데이터를 디스크 기반으로 정렬하는 알고리즘 (예: Merge Sort 기반 정렬)</td></tr><tr><td><strong>클라우드/인프라</strong></td><td>Serverless</td><td>서버 관리 없이 함수 단위로 실행하는 클라우드 실행 모델. 비용 효율성과 유연성 제공</td></tr><tr><td></td><td>Kubernetes CronJob</td><td>Kubernetes 환경에서 배치 작업을 주기적으로 실행하기 위한 리소스</td></tr><tr><td></td><td>Auto Scaling</td><td>부하에 따라 컴퓨팅 리소스를 자동으로 조절하는 메커니즘</td></tr><tr><td><strong>보안/관찰성</strong></td><td>Encryption-at-rest</td><td>저장 상태 데이터에 대한 암호화 기법</td></tr><tr><td></td><td>Distributed Tracing</td><td>분산 시스템에서 트랜잭션 또는 요청의 흐름을 추적하는 기법. 예: OpenTelemetry, Zipkin 등</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://www.ibm.com/cloud/learn/batch-processing>Batch Processing 개념 및 사례 - IBM</a></li><li><a href=https://learn.microsoft.com/en-us/azure/architecture/patterns/batch-sequential>Batch Sequential Architecture Pattern 설명 - Microsoft Docs</a></li><li><a href=https://martinfowler.com/articles/collection-pipeline/>Pipes and Filters Pattern - Martin Fowler</a></li><li><a href=https://airflow.apache.org/docs/>Apache Airflow Documentation - Batch Processing</a></li><li><a href=https://spark.apache.org/docs/latest/sql-programming-guide.html>Apache Spark SQL Programming Guide - Apache Spark</a></li><li><a href=https://docs.aws.amazon.com/batch/>AWS Batch User Guide - Amazon Web Services</a></li><li><a href=https://cloud.google.com/dataflow/docs>Google Cloud Dataflow Documentation - Google Cloud</a></li><li><a href=https://docs.microsoft.com/azure/batch/>Microsoft Azure Batch Documentation - Azure</a></li><li><a href=https://docs.spring.io/spring-batch/reference/spring-batch-architecture.html>Spring Batch 아키텍처 개요 및 구성요소 - Spring.io</a></li><li><a href=https://airflow.apache.org/docs/>Airflow DAG 패턴 및 사용 사례 - Apache Airflow</a></li><li><a href=https://debezium.io/documentation/reference/stable/>CDC 개념 및 도입 전략 - Debezium</a></li><li><a href=https://www.confluent.io/blog/schema-registry/>스키마 레지스트리 도입 전략 - Confluent</a></li><li><a href=https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs>Kubernetes CronJob 및 Job 설명 - Kubernetes.io</a></li><li><a href=https://aws.amazon.com/ko/lambda/>Serverless 기반 배치 처리 전략 - AWS Lambda</a></li><li><a href=https://opentelemetry.io/>OpenTelemetry 분산 추적 소개 - OpenTelemetry</a></li><li><a href=https://medium.com/%40kiarash.shamaii/comprehensive-guide-to-spring-batch-processing-part-2-fb599fdcb119>Spring Batch Partitioning 확장 기능 설명 - Medium</a></li><li><a href=https://estuary.dev/blog/elt-batch-processing/>Fast-food 매출 집계 배치 방식 - Estuary.dev</a></li><li><a href=https://aws.amazon.com/ko/big-data/datalakes-and-analytics/what-is-etl/>ETL 파이프라인과 배치 처리 - AWS</a></li><li><a href=https://docs.oracle.com/en/middleware/standalone/weblogic-server/14.1.1.0/wlprg/batch-processing.html>Batch Processing Best Practices - Oracle</a></li></ul><hr></div></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>