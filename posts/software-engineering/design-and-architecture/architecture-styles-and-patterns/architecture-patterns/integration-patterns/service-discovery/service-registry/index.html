<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Service registry | hyunyoun's Blog</title><meta name=keywords content="System-and-Software-Architecture,MSA-Patterns,Discovery,Service-registry"><meta name=description content="각 서비스 인스턴스의 네트워크 위치(IP 주소와 포트)를 저장하고 관리하는 중앙화된 데이터베이스"><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-patterns/integration-patterns/service-discovery/service-registry/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-patterns/integration-patterns/service-discovery/service-registry/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-patterns/integration-patterns/service-discovery/service-registry/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Service registry"><meta property="og:description" content="각 서비스 인스턴스의 네트워크 위치(IP 주소와 포트)를 저장하고 관리하는 중앙화된 데이터베이스"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-14T11:47:00+00:00"><meta property="article:modified_time" content="2024-11-14T11:47:00+00:00"><meta property="article:tag" content="System-and-Software-Architecture"><meta property="article:tag" content="MSA-Patterns"><meta property="article:tag" content="Discovery"><meta property="article:tag" content="Service-Registry"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Service registry"><meta name=twitter:description content="각 서비스 인스턴스의 네트워크 위치(IP 주소와 포트)를 저장하고 관리하는 중앙화된 데이터베이스"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Service registry","item":"https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-patterns/integration-patterns/service-discovery/service-registry/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Service registry","name":"Service registry","description":"각 서비스 인스턴스의 네트워크 위치(IP 주소와 포트)를 저장하고 관리하는 중앙화된 데이터베이스","keywords":["System-and-Software-Architecture","MSA-Patterns","Discovery","Service-registry"],"articleBody":"Service Registry Service Registry는 마이크로서비스 환경에서 각 서비스 인스턴스의 네트워크 위치(IP 주소와 포트)를 저장하고 관리하는 중앙화된 데이터베이스이다.\n이는 동적으로 변화하는 마이크로서비스 환경에서 서비스 디스커버리를 가능하게 하는 핵심 요소이다.\nService Registry는 MSA 환경에서 서비스 디스커버리를 가능하게 하는 핵심 컴포넌트이다. 이를 통해 동적이고 확장 가능한 마이크로서비스 아키텍처를 구현할 수 있다.\n서비스 레지스트리의 중요성 MSA 환경에서는 서비스 인스턴스가 자동 확장, 장애 복구, 배포 등의 이유로 동적으로 생성되고 소멸되며, 이에 따라 네트워크 위치가 변경된다.\n이러한 동적인 특성으로 인해, 서비스 레지스트리는 다음과 같은 역할을 수행한다:\n동적 스케일링 지원: 서비스 인스턴스의 추가 및 제거 시 자동으로 정보를 갱신하여, 클라이언트가 항상 최신 서비스 위치를 알 수 있도록 한다. 장애 대응: 장애가 발생한 인스턴스를 목록에서 제거하여, 클라이언트가 비정상적인 인스턴스로의 요청을 방지한다. 로드 밸런싱 지원: 현재 가용한 서비스 인스턴스 목록을 제공하여, 로드 밸런서나 클라이언트가 효율적으로 부하를 분산할 수 있도록 돕는다. Service Registry의 주요 기능 서비스 등록: 각 마이크로서비스 인스턴스는 시작 시 자신의 정보(서비스 이름, IP 주소, 포트 등)를 Service Registry에 등록한다. 서비스 조회: 클라이언트나 다른 서비스들이 특정 서비스의 위치 정보를 요청할 때 이를 제공한다. 상태 모니터링: 등록된 서비스들의 상태를 주기적으로 확인하여 가용성을 관리한다. 동적 업데이트: 서비스 인스턴스가 추가되거나 제거될 때 자동으로 정보를 업데이트한다. Service Registry의 구현 방식 중앙 집중식 데이터베이스: 모든 서비스 정보를 중앙에서 관리한다. 분산 시스템: 고가용성을 위해 여러 노드에 걸쳐 정보를 복제한다. API 제공: 서비스 등록, 조회, 삭제 등을 위한 REST API를 제공한다. 주요 Service Registry 도구 Netflix Eureka: 클라이언트 사이드 서비스 디스커버리에 주로 사용되는 오픈소스 도구이다. Apache ZooKeeper: 분산 코디네이션 서비스로, 서비스 레지스트리 기능을 제공한다. Consul: HashiCorp에서 개발한 서비스 디스커버리 및 구성 도구이다. etcd: 분산 키-값 저장소로, 서비스 레지스트리로 활용될 수 있다. Service Registry의 장점 동적 확장성: 서비스 인스턴스의 동적 추가 및 제거를 지원한다. 고가용성: 분산 시스템으로 구현되어 단일 실패 지점을 방지한다. 자동화: 서비스 등록 및 해제 과정을 자동화하여 운영 효율성을 높인다. 유연성: 클라우드 환경에서 IP 주소가 동적으로 변경되는 상황에 대응할 수 있다. 주의사항 데이터 일관성: 분산 환경에서 데이터 일관성을 유지하는 것이 중요하다. 보안: 서비스 정보의 중앙 저장소이므로 보안에 각별한 주의가 필요하다. 성능: 많은 요청을 처리해야 하므로 성능 최적화가 중요하다. 구현 예시 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 // 서비스 레지스트리 구현 class ServiceRegistry { constructor() { // 서비스 정보 저장소 this.services = new Map(); // 이벤트 구독자 관리 this.subscribers = new Map(); // 서비스 상태 정보 this.healthStatus = new Map(); // 레지스트리 설정 this.config = { cleanupInterval: 30000, // 30초마다 정리 healthCheckInterval: 10000 // 10초마다 헬스체크 }; // 주기적인 정리 작업 시작 this.startCleanupTask(); this.startHealthCheck(); } // 서비스 등록 async registerService(serviceInfo) { const serviceId = this.generateServiceId(serviceInfo); const registration = { id: serviceId, name: serviceInfo.name, host: serviceInfo.host, port: serviceInfo.port, metadata: serviceInfo.metadata || {}, registrationTime: Date.now(), lastHeartbeat: Date.now() }; // 서비스 정보 저장 this.services.set(serviceId, registration); // 이벤트 발행 this.notifySubscribers('SERVICE_REGISTERED', registration); return serviceId; } // 서비스 조회 async getServiceInstances(serviceName) { const instances = Array.from(this.services.values()) .filter(service =\u003e service.name === serviceName \u0026\u0026 this.isHealthy(service.id) ); if (instances.length === 0) { throw new Error(`No healthy instances found for service: ${serviceName}`); } return instances; } } 참고 및 출처 ","wordCount":"530","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2024-11-14T11:47:00Z","dateModified":"2024-11-14T11:47:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-patterns/integration-patterns/service-discovery/service-registry/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a></div><h1 class="post-title entry-hint-parent">Service registry</h1><div class=post-description>각 서비스 인스턴스의 네트워크 위치(IP 주소와 포트)를 저장하고 관리하는 중앙화된 데이터베이스</div><div class=post-meta><span title='2024-11-14 11:47:00 +0000 UTC'>November 14, 2024</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/Software%20Engineering/Design%20and%20Architecture/Architecture%20Styles%20and%20Patterns/Architecture%20Patterns/Integration%20Patterns/Service%20Discovery/service-registry.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#service-registry>Service Registry</a><ul><li><a href=#서비스-레지스트리의-중요성>서비스 레지스트리의 중요성</a></li><li><a href=#service-registry의-주요-기능>Service Registry의 주요 기능</a></li><li><a href=#service-registry의-구현-방식>Service Registry의 구현 방식</a></li><li><a href=#주요-service-registry-도구>주요 Service Registry 도구</a></li><li><a href=#service-registry의-장점>Service Registry의 장점</a></li><li><a href=#주의사항>주의사항</a></li><li><a href=#구현-예시>구현 예시</a></li></ul></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=service-registry>Service Registry<a hidden class=anchor aria-hidden=true href=#service-registry>#</a></h2><p>Service Registry는 마이크로서비스 환경에서 각 서비스 인스턴스의 네트워크 위치(IP 주소와 포트)를 저장하고 관리하는 중앙화된 데이터베이스이다.<br>이는 동적으로 변화하는 마이크로서비스 환경에서 서비스 디스커버리를 가능하게 하는 핵심 요소이다.</p><p>Service Registry는 MSA 환경에서 서비스 디스커버리를 가능하게 하는 핵심 컴포넌트이다. 이를 통해 동적이고 확장 가능한 마이크로서비스 아키텍처를 구현할 수 있다.</p><h3 id=서비스-레지스트리의-중요성>서비스 레지스트리의 중요성<a hidden class=anchor aria-hidden=true href=#서비스-레지스트리의-중요성>#</a></h3><p>MSA 환경에서는 서비스 인스턴스가 자동 확장, 장애 복구, 배포 등의 이유로 동적으로 생성되고 소멸되며, 이에 따라 네트워크 위치가 변경된다.<br>이러한 동적인 특성으로 인해, 서비스 레지스트리는 다음과 같은 역할을 수행한다:</p><ul><li><strong>동적 스케일링 지원</strong>: 서비스 인스턴스의 추가 및 제거 시 자동으로 정보를 갱신하여, 클라이언트가 항상 최신 서비스 위치를 알 수 있도록 한다.</li><li><strong>장애 대응</strong>: 장애가 발생한 인스턴스를 목록에서 제거하여, 클라이언트가 비정상적인 인스턴스로의 요청을 방지한다.</li><li><strong>로드 밸런싱 지원</strong>: 현재 가용한 서비스 인스턴스 목록을 제공하여, 로드 밸런서나 클라이언트가 효율적으로 부하를 분산할 수 있도록 돕는다.</li></ul><h3 id=service-registry의-주요-기능>Service Registry의 주요 기능<a hidden class=anchor aria-hidden=true href=#service-registry의-주요-기능>#</a></h3><ol><li><strong>서비스 등록</strong>: 각 마이크로서비스 인스턴스는 시작 시 자신의 정보(서비스 이름, IP 주소, 포트 등)를 Service Registry에 등록한다.</li><li><strong>서비스 조회</strong>: 클라이언트나 다른 서비스들이 특정 서비스의 위치 정보를 요청할 때 이를 제공한다.</li><li><strong>상태 모니터링</strong>: 등록된 서비스들의 상태를 주기적으로 확인하여 가용성을 관리한다.</li><li><strong>동적 업데이트</strong>: 서비스 인스턴스가 추가되거나 제거될 때 자동으로 정보를 업데이트한다.</li></ol><h3 id=service-registry의-구현-방식>Service Registry의 구현 방식<a hidden class=anchor aria-hidden=true href=#service-registry의-구현-방식>#</a></h3><ol><li><strong>중앙 집중식 데이터베이스</strong>: 모든 서비스 정보를 중앙에서 관리한다.</li><li><strong>분산 시스템</strong>: 고가용성을 위해 여러 노드에 걸쳐 정보를 복제한다.</li><li><strong>API 제공</strong>: 서비스 등록, 조회, 삭제 등을 위한 REST API를 제공한다.</li></ol><h3 id=주요-service-registry-도구>주요 Service Registry 도구<a hidden class=anchor aria-hidden=true href=#주요-service-registry-도구>#</a></h3><ol><li><strong>Netflix Eureka</strong>: 클라이언트 사이드 서비스 디스커버리에 주로 사용되는 오픈소스 도구이다.</li><li><strong>Apache ZooKeeper</strong>: 분산 코디네이션 서비스로, 서비스 레지스트리 기능을 제공한다.</li><li><strong>Consul</strong>: HashiCorp에서 개발한 서비스 디스커버리 및 구성 도구이다.</li><li><strong>etcd</strong>: 분산 키-값 저장소로, 서비스 레지스트리로 활용될 수 있다.</li></ol><h3 id=service-registry의-장점>Service Registry의 장점<a hidden class=anchor aria-hidden=true href=#service-registry의-장점>#</a></h3><ol><li><strong>동적 확장성</strong>: 서비스 인스턴스의 동적 추가 및 제거를 지원한다.</li><li><strong>고가용성</strong>: 분산 시스템으로 구현되어 단일 실패 지점을 방지한다.</li><li><strong>자동화</strong>: 서비스 등록 및 해제 과정을 자동화하여 운영 효율성을 높인다.</li><li><strong>유연성</strong>: 클라우드 환경에서 IP 주소가 동적으로 변경되는 상황에 대응할 수 있다.</li></ol><h3 id=주의사항>주의사항<a hidden class=anchor aria-hidden=true href=#주의사항>#</a></h3><ol><li><strong>데이터 일관성</strong>: 분산 환경에서 데이터 일관성을 유지하는 것이 중요하다.</li><li><strong>보안</strong>: 서비스 정보의 중앙 저장소이므로 보안에 각별한 주의가 필요하다.</li><li><strong>성능</strong>: 많은 요청을 처리해야 하므로 성능 최적화가 중요하다.</li></ol><h3 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21>21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22>22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23>23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24>24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25>25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26>26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27>27</a>
</span><span class=lnt id=hl-0-28><a class=lnlinks href=#hl-0-28>28</a>
</span><span class=lnt id=hl-0-29><a class=lnlinks href=#hl-0-29>29</a>
</span><span class=lnt id=hl-0-30><a class=lnlinks href=#hl-0-30>30</a>
</span><span class=lnt id=hl-0-31><a class=lnlinks href=#hl-0-31>31</a>
</span><span class=lnt id=hl-0-32><a class=lnlinks href=#hl-0-32>32</a>
</span><span class=lnt id=hl-0-33><a class=lnlinks href=#hl-0-33>33</a>
</span><span class=lnt id=hl-0-34><a class=lnlinks href=#hl-0-34>34</a>
</span><span class=lnt id=hl-0-35><a class=lnlinks href=#hl-0-35>35</a>
</span><span class=lnt id=hl-0-36><a class=lnlinks href=#hl-0-36>36</a>
</span><span class=lnt id=hl-0-37><a class=lnlinks href=#hl-0-37>37</a>
</span><span class=lnt id=hl-0-38><a class=lnlinks href=#hl-0-38>38</a>
</span><span class=lnt id=hl-0-39><a class=lnlinks href=#hl-0-39>39</a>
</span><span class=lnt id=hl-0-40><a class=lnlinks href=#hl-0-40>40</a>
</span><span class=lnt id=hl-0-41><a class=lnlinks href=#hl-0-41>41</a>
</span><span class=lnt id=hl-0-42><a class=lnlinks href=#hl-0-42>42</a>
</span><span class=lnt id=hl-0-43><a class=lnlinks href=#hl-0-43>43</a>
</span><span class=lnt id=hl-0-44><a class=lnlinks href=#hl-0-44>44</a>
</span><span class=lnt id=hl-0-45><a class=lnlinks href=#hl-0-45>45</a>
</span><span class=lnt id=hl-0-46><a class=lnlinks href=#hl-0-46>46</a>
</span><span class=lnt id=hl-0-47><a class=lnlinks href=#hl-0-47>47</a>
</span><span class=lnt id=hl-0-48><a class=lnlinks href=#hl-0-48>48</a>
</span><span class=lnt id=hl-0-49><a class=lnlinks href=#hl-0-49>49</a>
</span><span class=lnt id=hl-0-50><a class=lnlinks href=#hl-0-50>50</a>
</span><span class=lnt id=hl-0-51><a class=lnlinks href=#hl-0-51>51</a>
</span><span class=lnt id=hl-0-52><a class=lnlinks href=#hl-0-52>52</a>
</span><span class=lnt id=hl-0-53><a class=lnlinks href=#hl-0-53>53</a>
</span><span class=lnt id=hl-0-54><a class=lnlinks href=#hl-0-54>54</a>
</span><span class=lnt id=hl-0-55><a class=lnlinks href=#hl-0-55>55</a>
</span><span class=lnt id=hl-0-56><a class=lnlinks href=#hl-0-56>56</a>
</span><span class=lnt id=hl-0-57><a class=lnlinks href=#hl-0-57>57</a>
</span><span class=lnt id=hl-0-58><a class=lnlinks href=#hl-0-58>58</a>
</span><span class=lnt id=hl-0-59><a class=lnlinks href=#hl-0-59>59</a>
</span><span class=lnt id=hl-0-60><a class=lnlinks href=#hl-0-60>60</a>
</span><span class=lnt id=hl-0-61><a class=lnlinks href=#hl-0-61>61</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 서비스 레지스트리 구현
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>class</span> <span class=nx>ServiceRegistry</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>constructor</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 서비스 정보 저장소
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>services</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Map</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 이벤트 구독자 관리
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>subscribers</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Map</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 서비스 상태 정보
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>healthStatus</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Map</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 레지스트리 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>config</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>cleanupInterval</span><span class=o>:</span> <span class=mi>30000</span><span class=p>,</span>  <span class=c1>// 30초마다 정리
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>healthCheckInterval</span><span class=o>:</span> <span class=mi>10000</span>  <span class=c1>// 10초마다 헬스체크
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 주기적인 정리 작업 시작
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>startCleanupTask</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>startHealthCheck</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 서비스 등록
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>async</span> <span class=nx>registerService</span><span class=p>(</span><span class=nx>serviceInfo</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>serviceId</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>generateServiceId</span><span class=p>(</span><span class=nx>serviceInfo</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>registration</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>id</span><span class=o>:</span> <span class=nx>serviceId</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>name</span><span class=o>:</span> <span class=nx>serviceInfo</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>host</span><span class=o>:</span> <span class=nx>serviceInfo</span><span class=p>.</span><span class=nx>host</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>port</span><span class=o>:</span> <span class=nx>serviceInfo</span><span class=p>.</span><span class=nx>port</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>metadata</span><span class=o>:</span> <span class=nx>serviceInfo</span><span class=p>.</span><span class=nx>metadata</span> <span class=o>||</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>            <span class=nx>registrationTime</span><span class=o>:</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=nx>lastHeartbeat</span><span class=o>:</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 서비스 정보 저장
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>services</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>serviceId</span><span class=p>,</span> <span class=nx>registration</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 이벤트 발행
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>notifySubscribers</span><span class=p>(</span><span class=s1>&#39;SERVICE_REGISTERED&#39;</span><span class=p>,</span> <span class=nx>registration</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>serviceId</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 서비스 조회
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>async</span> <span class=nx>getServiceInstances</span><span class=p>(</span><span class=nx>serviceName</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>instances</span> <span class=o>=</span> <span class=nb>Array</span><span class=p>.</span><span class=nx>from</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>services</span><span class=p>.</span><span class=nx>values</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=nx>filter</span><span class=p>(</span><span class=nx>service</span> <span class=p>=&gt;</span> 
</span></span><span class=line><span class=cl>                <span class=nx>service</span><span class=p>.</span><span class=nx>name</span> <span class=o>===</span> <span class=nx>serviceName</span> <span class=o>&amp;&amp;</span> 
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>isHealthy</span><span class=p>(</span><span class=nx>service</span><span class=p>.</span><span class=nx>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>instances</span><span class=p>.</span><span class=nx>length</span> <span class=o>===</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=sb>`No healthy instances found for service: </span><span class=si>${</span><span class=nx>serviceName</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>instances</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/system-and-software-architecture/>System-and-Software-Architecture</a></li><li><a href=https://buenhyden.github.io/tags/msa-patterns/>MSA-Patterns</a></li><li><a href=https://buenhyden.github.io/tags/discovery/>Discovery</a></li><li><a href=https://buenhyden.github.io/tags/service-registry/>Service-Registry</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-patterns/integration-patterns/service-discovery/server-side-discovery/><span class=title>« Prev</span><br><span>Server-side discovery</span>
</a><a class=next href=https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles-and-patterns/architecture-patterns/integration-patterns/service-discovery/client-side-discovery/><span class=title>Next »</span><br><span>Client-side discovery</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>