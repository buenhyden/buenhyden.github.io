<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Data Lake | hyunyoun's Blog</title><meta name=keywords content="Data-Science-and-Engineering,Data-Engineering,Data-Storage-Architectures,Data-Lake,Schema-on-Read"><meta name=description content="데이터 레이크 (Data Lake) 는 구조화, 반구조화, 비구조화 데이터를 원시 형태로 대용량 저장하는 중앙집중식 저장소이다. 스키마 온 리드 (Schema-on-Read) 방식을 사용하여 데이터 저장 시점에는 구조를 정의하지 않고, 사용 시점에 스키마를 적용한다.  빅데이터 분석, 머신러닝, AI 워크로드를 지원하는 현대 데이터 아키텍처의 핵심 요소이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles/data-centric-architecture/data-lake-architecture/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles/data-centric-architecture/data-lake-architecture/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles/data-centric-architecture/data-lake-architecture/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles/data-centric-architecture/data-lake-architecture/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Data Lake"><meta property="og:description" content="데이터 레이크 (Data Lake) 는 구조화, 반구조화, 비구조화 데이터를 원시 형태로 대용량 저장하는 중앙집중식 저장소이다. 스키마 온 리드 (Schema-on-Read) 방식을 사용하여 데이터 저장 시점에는 구조를 정의하지 않고, 사용 시점에 스키마를 적용한다.  빅데이터 분석, 머신러닝, AI 워크로드를 지원하는 현대 데이터 아키텍처의 핵심 요소이다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Data Lake"><meta name=twitter:description content="데이터 레이크 (Data Lake) 는 구조화, 반구조화, 비구조화 데이터를 원시 형태로 대용량 저장하는 중앙집중식 저장소이다. 스키마 온 리드 (Schema-on-Read) 방식을 사용하여 데이터 저장 시점에는 구조를 정의하지 않고, 사용 시점에 스키마를 적용한다.  빅데이터 분석, 머신러닝, AI 워크로드를 지원하는 현대 데이터 아키텍처의 핵심 요소이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"기록하고 기억하고 활용하자.","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Software Engineering","item":"https://buenhyden.github.io/posts/software-engineering/"},{"@type":"ListItem","position":3,"name":"Design and Architecture","item":""},{"@type":"ListItem","position":4,"name":"Architecture Styles","item":""},{"@type":"ListItem","position":5,"name":"Data-Centric Architecture","item":"https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles/data-centric-architecture/"},{"@type":"ListItem","position":6,"name":"Data Lake","item":"https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles/data-centric-architecture/data-lake-architecture/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>기록하고 기억하고 활용하자.</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/software-engineering/>Software Engineering</a>&nbsp;»&nbsp;<a href>Design and Architecture</a>&nbsp;»&nbsp;<a href>Architecture Styles</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/software-engineering/design-and-architecture/architecture-styles/data-centric-architecture/>Data-Centric Architecture</a></div><h1>Data Lake</h1><div class=post-description>데이터 레이크 (Data Lake) 는 구조화, 반구조화, 비구조화 데이터를 원시 형태로 대용량 저장하는 중앙집중식 저장소이다. 스키마 온 리드 (Schema-on-Read) 방식을 사용하여 데이터 저장 시점에는 구조를 정의하지 않고, 사용 시점에 스키마를 적용한다. 빅데이터 분석, 머신러닝, AI 워크로드를 지원하는 현대 데이터 아키텍처의 핵심 요소이다.</div></header><div class=post-content><h2 id=data-lake>Data Lake<a hidden class=anchor aria-hidden=true href=#data-lake>#</a></h2><p>Data Lake 는 다양한 형식 (structured, semi-structured, unstructured) 의 데이터를 원시 (raw) 형태로 저장하는 중앙 저장소이다. 스키마를 저장 시점이 아닌 조회 시 정의하는 schema-on-read 방식을 사용하며, AWS S3, Azure Data Lake Storage, Hadoop HDFS 등 객체 스토리지를 기반으로 구성된다. 대규모 데이터 저장, 데이터 탐색, 데이터 과학, 실시간 분석 등 여러 데이터 활용 시나리오를 지원하며 Lakehouse 나 Data Warehouse 와 연계되어 통합 데이터 전략을 구현할 수 있다.</p><h3 id=배경>배경<a hidden class=anchor aria-hidden=true href=#배경>#</a></h3><ol><li><p><strong>데이터 폭증 시대의 도래</strong></p><ul><li>2025 년까지 전 세계 데이터 생성량이 181 제타바이트에 도달 예상</li><li>IoT 디바이스, 소셜 미디어, 모바일 애플리케이션의 급속한 확산</li><li>일일 2.5 퀸틸리온 바이트의 데이터 생성 (2017 년 기준)</li></ul></li><li><p><strong>기존 데이터 웨어하우스의 한계</strong></p><ul><li>구조화된 데이터만 처리 가능</li><li>스키마 온 라이트 (Schema-on-Write) 로 인한 유연성 부족</li><li>높은 저장 비용과 복잡한 ETL 프로세스</li><li>비정형 데이터 처리의 어려움</li></ul></li><li><p><strong>빅데이터 기술의 발전</strong></p><ul><li>Apache Hadoop 생태계의 성숙</li><li>클라우드 컴퓨팅의 대중화</li><li>머신러닝과 AI 기술의 급속한 발전</li></ul></li></ol><h3 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h3><ol><li><p><strong>비즈니스 목적</strong></p><ul><li><strong>비용 절감</strong>: 저렴한 객체 스토리지 활용으로 스토리지 비용 최대 90% 절감</li><li><strong>민첩성 향상</strong>: 새로운 데이터 소스의 빠른 통합</li><li><strong>혁신 촉진</strong>: 고급 분석 및 머신러닝 워크로드 지원</li><li><strong>규모 확장</strong>: 페타바이트 규모의 데이터 처리 능력</li></ul></li><li><p><strong>기술적 필요성</strong></p><ul><li><strong>다양한 데이터 형태 통합</strong>: 정형, 반정형, 비정형 데이터의 단일 저장소</li><li><strong>실시간 데이터 처리</strong>: 스트리밍 데이터의 즉시 수집 및 처리</li><li><strong>AI/ML 지원</strong>: 원시 데이터에서 직접 머신러닝 모델 훈련</li><li><strong>셀프 서비스 분석</strong>: 비즈니스 사용자의 직접적 데이터 접근</li></ul></li></ol><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><p>데이터 레이크는 다양한 소스로부터 수집된 구조화, 반구조화, 비구조화 데이터를 원시 형태로 저장하는 확장 가능한 중앙집중식 저장소이다. 스키마 온 리드 (Schema-on-Read) 접근 방식을 채택하여 데이터 저장 시점에는 구조를 강제하지 않고, 분석이나 처리가 필요한 시점에 스키마를 적용한다.</p><ol><li><p><strong>스키마 온 리드 (Schema-on-Read)</strong></p><ul><li><strong>정의</strong>: 데이터를 읽을 때 스키마를 적용하는 방식</li><li><strong>장점</strong>: 데이터 저장 시 전처리 시간 단축, 유연한 데이터 구조 변경</li><li><strong>특징</strong>: ETL 대신 ELT(Extract, Load, Transform) 방식 활용</li></ul></li><li><p><strong>플랫 아키텍처 (Flat Architecture)</strong></p><ul><li>계층적 구조의 데이터 웨어하우스와 달리 수평적 저장 구조</li><li>객체 스토리지 기반의 확장 가능한 저장 방식</li><li>메타데이터를 통한 데이터 관리 및 검색</li></ul></li><li><p><strong>멀티 모달 데이터 지원</strong></p><ul><li><strong>구조화 데이터</strong>: 관계형 데이터베이스, CSV, JSON</li><li><strong>반구조화 데이터</strong>: XML, Parquet, Avro</li><li><strong>비구조화 데이터</strong>: 텍스트, 이미지, 비디오, 오디오</li></ul></li></ol><h4 id=실무-구현-연관성>실무 구현 연관성<a hidden class=anchor aria-hidden=true href=#실무-구현-연관성>#</a></h4><ol><li><p><strong>스토리지 기술 연관성</strong></p><ul><li><strong>객체 스토리지</strong>: Amazon S3, Azure Blob Storage, Google Cloud Storage</li><li><strong>분산 파일 시스템</strong>: HDFS (Hadoop Distributed File System)</li><li><strong>클라우드 네이티브 솔루션</strong>: AWS Lake Formation, Azure Data Lake Storage</li></ul></li><li><p><strong>데이터 처리 엔진 연관성</strong></p><ul><li><strong>배치 처리</strong>: Apache Spark, Apache Hadoop MapReduce</li><li><strong>스트림 처리</strong>: Apache Kafka, Apache Flink, Amazon Kinesis</li><li><strong>쿼리 엔진</strong>: Apache Presto, Trino, Amazon Athena</li></ul></li><li><p><strong>메타데이터 관리 연관성</strong></p><ul><li><strong>카탈로그 서비스</strong>: Apache Hive Metastore, AWS Glue Catalog</li><li><strong>데이터 거버넌스</strong>: Apache Atlas, Collibra, Alation</li><li><strong>스키마 레지스트리</strong>: Confluent Schema Registry, Apache Avro</li></ul></li></ol><h3 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h3><ol><li><p><strong>데이터 수집 기능</strong></p><ul><li><strong>배치 수집</strong>: 정기적인 대량 데이터 로딩</li><li><strong>실시간 수집</strong>: 스트리밍 데이터의 연속 처리</li><li><strong>API 기반 수집</strong>: REST, GraphQL 을 통한 데이터 연동</li><li><strong>파일 기반 수집</strong>: FTP, SFTP 를 통한 파일 전송</li></ul></li><li><p><strong>데이터 저장 기능</strong></p><ul><li><strong>원시 데이터 보존</strong>: 데이터 변환 없이 원본 상태 유지</li><li><strong>버전 관리</strong>: 데이터 변경 이력 추적</li><li><strong>압축 및 파티셔닝</strong>: 저장 효율성 최적화</li><li><strong>데이터 레이크 계층화</strong>: Raw, Standardized, Curated, Sandbox 레이어</li></ul></li><li><p><strong>데이터 처리 기능</strong></p><ul><li><strong>배치 처리</strong>: 대용량 데이터의 주기적 처리</li><li><strong>스트림 처리</strong>: 실시간 데이터 변환 및 분석</li><li><strong>ETL/ELT 파이프라인</strong>: 데이터 변환 및 품질 관리</li><li><strong>데이터 품질 검증</strong>: 자동화된 데이터 검증 및 정제</li></ul></li></ol><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><ol><li><p><strong>유연성 (Flexibility)</strong></p><ul><li>스키마 온 리드 (Schema on Read) 로 인한 구조 변경의 자유도</li><li>다양한 데이터 형태와 포맷 지원</li><li>새로운 분석 요구사항에 대한 빠른 대응</li></ul></li><li><p><strong>확장성 (Scalability)</strong></p><ul><li>수평적 확장 가능한 분산 스토리지</li><li>페타바이트 규모의 데이터 처리 능력</li><li>클라우드 기반 탄력적 자원 관리</li></ul></li><li><p><strong>비용 효율성 (Cost-Effectiveness)</strong></p><ul><li>저렴한 객체 스토리지 활용</li><li>사용량 기반 과금 모델</li><li>데이터 압축 및 중복 제거 기술</li></ul></li><li><p><strong>개방성 (Openness)</strong></p><ul><li>오픈 소스 기술 스택 활용</li><li>벤더 종속성 최소화</li><li>다양한 도구와의 호환성</li></ul></li></ol><h3 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h3><ol><li><p><strong>모든 데이터 수용 (Ingest All Data)</strong></p><ul><li>데이터 형태나 품질에 관계없이 모든 데이터 수집</li><li>미래의 분석 가능성을 위한 데이터 보존</li><li>&ldquo;Ask questions later&rdquo; 접근 방식</li></ul></li><li><p><strong>원시 데이터 보존 (Keep Raw Data)</strong></p><ul><li>데이터 변환 전 원본 상태 유지</li><li>데이터 계보 (Lineage) 추적 가능</li><li>재처리 및 재분석 지원</li></ul></li><li><p><strong>스키마 온 리드 (Schema-on-Read)</strong></p><ul><li>저장 시점이 아닌 사용 시점에 스키마 적용</li><li>유연한 데이터 구조 변경</li><li>빠른 데이터 수집 지원</li></ul></li><li><p><strong>메타데이터 중심 관리 (Metadata-Driven)</strong></p><ul><li>풍부한 메타데이터를 통한 데이터 검색성 향상</li><li>데이터 카탈로그를 통한 데이터 거버넌스</li><li>자동화된 분류 및 태깅</li></ul></li></ol><h3 id=주요-원리>주요 원리<a hidden class=anchor aria-hidden=true href=#주요-원리>#</a></h3><ul><li>데이터는 원본 그대로 저장되고, 분석 시점에 필요한 구조로 해석 (스키마 온 리드)</li><li>다양한 분석 엔진 및 도구와 연동 가능</li></ul><h4 id=다이어그램>다이어그램<a hidden class=anchor aria-hidden=true href=#다이어그램>#</a></h4><pre class=mermaid>flowchart TD
    A[&#34;데이터 소스(정형/비정형)&#34;] --&gt; B[데이터 인제스트 계층]
    B --&gt; C[데이터 레이크 스토리지]
    C --&gt; D[데이터 카탈로그/메타데이터]
    D --&gt; E[분석/머신러닝/BI]
</pre><ul><li><strong>설명:</strong><br>다양한 데이터 소스에서 데이터를 수집하여 데이터 레이크 스토리지에 저장한다. 카탈로그와 메타데이터를 통해 데이터를 탐색·관리하며, 분석 및 머신러닝 워크로드에 활용한다.</li></ul><h3 id=작동-원리-및-방식>작동 원리 및 방식<a hidden class=anchor aria-hidden=true href=#작동-원리-및-방식>#</a></h3><h4 id=전형적인-data-lake-흐름>전형적인 Data Lake 흐름<a hidden class=anchor aria-hidden=true href=#전형적인-data-lake-흐름>#</a></h4><pre class=mermaid>sequenceDiagram
  participant Source as Data Source
  participant Ingest as Ingestion Layer
  participant RawZone as Raw Storage
  participant Process as Processing Engine
  participant CuratedZone as Curated Storage
  participant Query as Query Engine
  participant Consumer as BI/ML Consumer

  Source-&gt;&gt;Ingest: 실시간/배치 데이터 수집
  Ingest-&gt;&gt;RawZone: 원시 데이터 저장
  RawZone-&gt;&gt;Process: 데이터 정제, 포맷 변환
  Process-&gt;&gt;CuratedZone: 분석용 데이터 저장
  CuratedZone-&gt;&gt;Query: SQL/ML 쿼리 수행
  Query-&gt;&gt;Consumer: 결과 전달
</pre><p><strong>데이터 레이크 작동 원리 설명:</strong></p><ol><li><strong>데이터 수집</strong>: 다양한 소스에서 배치 또는 실시간으로 데이터 수집</li><li><strong>원시 저장</strong>: 수집된 데이터를 변환 없이 원본 형태로 저장</li><li><strong>표준화</strong>: 필요시 데이터 형식 통일 및 구조화</li><li><strong>정제 및 변환</strong>: 비즈니스 로직 적용 및 품질 관리</li><li><strong>분석 및 소비</strong>: 다양한 도구를 통한 데이터 활용</li></ol><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><pre class=mermaid>graph LR
  subgraph Sources
    A1[DBMS] --&gt; I1
    A2[Web Logs] --&gt; I1
    A3[IoT Devices] --&gt; I1
  end

  subgraph Ingestion
    I1[Kafka/Kinesis/Batch Upload]
  end

  subgraph Storage Zones
    RZ[Raw Zone]
    PZ[Processed Zone]
    AZ[Analytics Zone]
  end

  subgraph Processing
    PR1[Spark/Glue/Databricks]
  end

  subgraph Metadata
    M1[Glue Catalog/Atlas]
  end

  subgraph Query &amp; Consumption
    Q1[Athena/Presto]
    C1[BI Tool]
    C2[ML Tool]
  end

  I1 --&gt; RZ
  RZ --&gt; PR1
  PR1 --&gt; PZ
  PZ --&gt; AZ
  AZ --&gt; Q1
  Q1 --&gt; C1
  Q1 --&gt; C2
  AZ --&gt; M1
  PZ --&gt; M1
</pre><h4 id=주요-구성-요소>주요 구성 요소<a hidden class=anchor aria-hidden=true href=#주요-구성-요소>#</a></h4><table><thead><tr><th>구성 요소</th><th>설명</th></tr></thead><tbody><tr><td><strong>Ingestion Layer</strong></td><td>Kafka, Kinesis, NiFi, Flume 등으로 실시간 또는 배치로 데이터 적재</td></tr><tr><td><strong>Storage Layer</strong></td><td>Amazon S3, Azure ADLS, Hadoop HDFS 등 오브젝트 스토리지 기반 저장소</td></tr><tr><td><strong>Processing Layer</strong></td><td>Apache Spark, AWS Glue, Databricks 등으로 ETL/ELT 수행</td></tr><tr><td><strong>Metadata & Governance</strong></td><td>AWS Glue Catalog, Unity Catalog, Apache Atlas 등으로 메타데이터, 데이터 계보, 보안 정책 관리</td></tr><tr><td><strong>Query Layer</strong></td><td>Presto, Athena, Trino, Hive 등으로 SQL-on-Object Storage 지원</td></tr><tr><td><strong>Consumer Layer</strong></td><td>BI 도구 (Tableau, QuickSight), ML 도구 (SageMaker, Vertex AI 등)</td></tr></tbody></table><ul><li>Data Lake 는 <strong>원시 데이터를 중앙 저장소에 저장하여 다양한 목적에 재활용</strong>할 수 있게 하는 확장형 아키텍처.</li><li>핵심 원리는 <strong>Schema-on-Read</strong>, <strong>Storage 분리</strong>, <strong>오픈 포맷</strong>, <strong>대용량 처리</strong>.</li><li>아키텍처는 ingestion → storage → processing → query → consumption 단계로 구성되며, 각 계층에 맞는 기술을 적용해야 한다.</li></ul><h3 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h3><p>Data Lake 는 다양한 기술 조합으로 구현할 수 있으며, 일반적으로 <strong>Ingestion → Storage → Processing → Query → Governance</strong> 흐름으로 구성된다.</p><table><thead><tr><th>구성 요소</th><th>구현 기법</th><th>설명</th><th>예시</th></tr></thead><tbody><tr><td>데이터 수집 (Ingestion)</td><td>Batch, Stream 기반 적재</td><td>Kafka, Kinesis, Flume, Sqoop 등을 통해 로그, DB, IoT 데이터 수집</td><td>Kafka → S3 / Flume → HDFS</td></tr><tr><td>저장소 구성 (Storage)</td><td>오브젝트 스토리지 계층 분리</td><td>Raw, Processed, Analytics 계층으로 나눠 관리</td><td>S3 Bucket prefix or HDFS directory 로 구분</td></tr><tr><td>처리 (Processing)</td><td>Spark 기반의 ETL 또는 ELT</td><td>정제, 포맷 변경, 중복 제거, 데이터 정렬, 집계 등</td><td>AWS Glue, Databricks, EMR</td></tr><tr><td>쿼리 엔진</td><td>SQL-on-Lake / Serverless Query</td><td>Presto, Athena, Hive 등으로 직접 SQL 조회</td><td>Athena 로 Parquet 데이터 분석</td></tr><tr><td>메타데이터 관리</td><td>Catalog 연동 + 계보 추적</td><td>AWS Glue, Apache Atlas, DataHub 등을 통한 데이터 등록·검색</td><td>스키마 자동 추출, lineage 시각화</td></tr><tr><td>접근 제어</td><td>정책기반 권한 관리</td><td>IAM, Lake Formation, Unity Catalog 등을 통해 권한 제어</td><td>팀별 read/write 정책 분리</td></tr></tbody></table><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><table><thead><tr><th>📌 카테고리</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>1. 저장 및 인프라 유연성</strong></td><td><strong>확장성</strong></td><td>오브젝트 스토리지 기반으로 페타/엑사바이트급까지 수평 확장 가능. 클라우드와 온프레미스 모두 지원 가능</td></tr><tr><td></td><td><strong>비용 효율성</strong></td><td>S3/HDFS 등 저비용 저장소 기반, 사용량 기반 과금으로 비용 절감 효과 (DWH 대비 70~90% 저렴)</td></tr><tr><td></td><td><strong>벤더 독립성</strong></td><td>오픈 포맷 (Parquet, ORC) 과 오픈 소스 스택 (Flink, Presto 등) 을 활용하여 클라우드 벤더 종속성 최소화</td></tr><tr><td><strong>2. 데이터 유연성 및 다양성</strong></td><td><strong>데이터 포맷 다양성</strong></td><td>정형 (CSV), 반정형 (JSON, Avro), 비정형 (이미지, 오디오, 로그 등) 까지 단일 저장소에서 통합 관리 가능</td></tr><tr><td></td><td><strong>Schema-on-Read</strong></td><td>저장 시 스키마 적용 없이, 읽는 시점에서 유연하게 분석 가능. 다양한 소비 목적에 대응 가능</td></tr><tr><td></td><td><strong>데이터 수집 유연성</strong></td><td>원시 데이터를 가공 없이 바로 저장 가능. 배치/스트리밍 수집 모두 유연하게 수용</td></tr><tr><td><strong>3. 분석 및 활용 확장성</strong></td><td><strong>AI/ML 연동성</strong></td><td>원시 데이터를 그대로 활용하여 ML 모델 학습 가능. 피처 스토어와 MLOps 시스템과 연동 유리</td></tr><tr><td></td><td><strong>다양한 분석 도구 지원</strong></td><td>Spark, Hive, Athena, Presto 등 다양한 분석 도구와 연동 가능. BI 및 ML 모두 지원</td></tr><tr><td></td><td><strong>빠른 실험/반복 가능성</strong></td><td>새로운 데이터 유형이나 분석 요구에 빠르게 대응하고 실험 가능한 환경 제공</td></tr><tr><td><strong>4. 운영 및 전략적 가치</strong></td><td><strong>데이터 사일로 해소</strong></td><td>다양한 소스의 데이터를 중앙 집중화하여 조직 전반에서 통합 분석 기반 제공</td></tr><tr><td></td><td><strong>유연한 거버넌스 통합</strong></td><td>메타데이터, 품질, 보안 정책을 중앙 통제 가능. 관리 및 감사 용이</td></tr><tr><td></td><td><strong>다양한 워크로드 지원</strong></td><td>ETL, BI, ML, Streaming 등 다양한 워크로드를 단일 환경에서 지원</td></tr></tbody></table><h3 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th><th>해결 방안 및 전략</th></tr></thead><tbody><tr><td><strong>데이터 품질 관리</strong></td><td>데이터 스웜 현상</td><td>스키마 없는 저장 → 탐색/분석 불가한 " 데이터 늪 " 으로 전락 위험</td><td>데이터 카탈로그 (Glue, Atlas 등) 도입, 메타데이터 자동화, 계약 기반 저장 (Contract-First)</td></tr><tr><td><strong>거버넌스 부재</strong></td><td>권한/품질/계보 관리 부재</td><td>권한, 계보 추적, 품질 통제 어려움</td><td>RBAC/ABAC 정책 도입, Atlas+Ranger, 품질 검증 자동화</td></tr><tr><td><strong>쿼리 성능 문제</strong></td><td>느린 쿼리 응답 시간</td><td>원시 데이터 직접 스캔, 파티션 미설계, 압축 포맷 미사용 등</td><td>Parquet/ORC/Delta 도입, 파티셔닝, Z-Ordering, Caching 전략</td></tr><tr><td><strong>운영 복잡성</strong></td><td>기술/아키텍처 복잡성 증가</td><td>다양한 스택 연계 필요, 운영·유지보수 인력 부담</td><td>단계별 구축 (PoC → Pilot), 관리형 서비스 사용 (AWS Glue, EMR 등)</td></tr><tr><td><strong>비용 관리 한계</strong></td><td>스토리지/컴퓨팅 비용 증가</td><td>데이터 무분별 적재로 인한 저장 비용 및 쿼리 비용 증가</td><td>S3 Lifecycle Policy, Intelligent Tiering, Access Log 기반 데이터 TTL 설계</td></tr></tbody></table><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th>카테고리</th><th>항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방안</th><th>해결 기법/도구</th></tr></thead><tbody><tr><td><strong>데이터 품질 문제</strong></td><td>일관성 없음</td><td>스키마 불일치, 중복 적재, 형식 오류</td><td>분석 오류, 모델 성능 저하</td><td>dbt test, Great Expectations</td><td>Contract 기반 저장, ELT 사전 검증</td><td>데이터 프로파일링, Skew 분석, 정제 파이프라인 구축</td></tr><tr><td><strong>중복 데이터 저장</strong></td><td>동일 파일 재적재, 파티션 중복</td><td>무분별 적재, 배치 중복 실행</td><td>저장 비용 증가, 결과 불일치</td><td>S3 파일 수/버전 모니터링</td><td>Incremental Load 설계</td><td>SCD2, Watermark 기반 중복 방지 처리</td></tr><tr><td><strong>보안 위협</strong></td><td>권한 관리 미흡, 암호화 누락</td><td>중앙 저장소 보안 미흡</td><td>민감 정보 유출, 컴플라이언스 미준수</td><td>S3 로그, 감사 로그, 접근 통계 확인</td><td>IAM + KMS 연동, ABAC 정책 설정</td><td>데이터 암호화 (SSE-KMS), 데이터 마스킹</td></tr><tr><td><strong>메타데이터 부족</strong></td><td>카탈로그/계보 관리 미흡</td><td>스키마 진화 미추적, 탐색 불가</td><td>비효율적 탐색, 분석 지연</td><td>메타데이터 완성도 지표</td><td>자동 수집/버전 관리</td><td>Apache Atlas, Glue Crawlers, DataHub</td></tr><tr><td><strong>비용 예측 실패</strong></td><td>장기 보관, 비활성 데이터 적재</td><td>데이터 수명/접근 패턴 고려 부족</td><td>불필요한 저장 과금</td><td>Access 로그 분석, Cold Zone 트래킹</td><td>TTL 정책, 저장 등급 분리</td><td>S3 Lifecycle Rule, Intelligent Tiering, Cost Explorer 분석 도구</td></tr></tbody></table><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><table><thead><tr><th>카테고리</th><th>과제명</th><th>원인 및 증상</th><th>영향</th><th>탐지/진단 방법</th><th>예방 및 해결 방안</th><th>대표 기술/전략 예시</th></tr></thead><tbody><tr><td><strong>거버넌스/보안</strong></td><td>데이터 거버넌스 미비</td><td>분산된 소스, 형식 불일치, 메타데이터 관리 부재</td><td>규정 준수 실패, 신뢰성 저하</td><td>메타데이터 누락 비율, 규제 로그 분석</td><td>통합 거버넌스 프레임워크, 자동화 규정 모니터링</td><td>Apache Atlas, DataHub, Collibra</td></tr><tr><td></td><td>권한 제어 및 감사 실패</td><td>역할 기반 권한 모델 부재, 접근 제어 로그 미활용</td><td>보안 취약, 인증 실패, 데이터 유출 위험</td><td>IAM 로그, 접근 실패 이력</td><td>RBAC/ABAC 설계, 세분화된 접근 정책 적용</td><td>AWS IAM, Lake Formation, Ranger</td></tr><tr><td></td><td>데이터 품질 저하</td><td>스키마 불일치, 결측치, 이상치 관리 미흡</td><td>분석 오류, 모델 학습 실패</td><td>dbt 테스트 실패율, Null 비율</td><td>스키마 고정, Quality 프레임워크 구축</td><td>Great Expectations, dbt, Data Contracts</td></tr><tr><td><strong>아키텍처 설계</strong></td><td>Zone 전략 부재</td><td>단일 저장소 사용, Raw/Processed/Curated 구분 없음</td><td>관리 복잡성 증가, 추적 어려움</td><td>스토리지 분석 도구, 디렉토리 구조 시각화</td><td>레이어드 스토리지 설계, 계층별 관리 도입</td><td>Raw → Silver → Gold, Medallion Architecture</td></tr><tr><td></td><td>실시간 처리 미흡</td><td>배치 위주의 처리 구조, 이벤트 기반 처리 미지원</td><td>실시간 의사결정 지연</td><td>지연 시간, 스트림 누락율</td><td>Kafka 기반 스트리밍 도입, CDC 적용, 델타 지원</td><td>Kafka, Flink, Delta Lake</td></tr><tr><td></td><td>AI/ML 통합의 어려움</td><td>파이프라인/ML 워크플로우 분리, 피처/모델 공유 어려움</td><td>AI 프로젝트 지연, 재현성 부족</td><td>MLOps 실패율, 학습 데이터 드리프트</td><td>MLOps 파이프라인 구축, 피처 스토어 도입</td><td>MLflow, Feast, SageMaker Pipelines</td></tr><tr><td><strong>운영/자동화</strong></td><td>운영 자동화 부족</td><td>수동 작업, 인프라/워크플로우 자동화 미흡</td><td>운영 비용 상승, 장애 대응 지연</td><td>실패율 로그, 수동 작업 지표</td><td>스케줄러 도입, IaC, Auto Observability</td><td>Airflow, Dagster, Terraform, Prometheus</td></tr><tr><td></td><td>데이터 스웜 현상</td><td>무분별한 저장, 중복 파일 증가, 카탈로그 혼란</td><td>검색/관리/보안 어려움</td><td>파일 수 증가율, 카탈로그 오류 수</td><td>카탈로그 자동화, 저장소 TTL 정책 도입</td><td>Apache Hive, Glue Catalog, Atlas</td></tr><tr><td><strong>비용/효율성</strong></td><td>스토리지 비용 폭증</td><td>중복 데이터, 장기 저장, 핫 데이터 분리 실패</td><td>예산 초과, 비효율적인 저장소 운영</td><td>S3 분석 리포트, 비용 예측 지표</td><td>스토리지 파티셔닝, S3 Tier 관리, 백업 주기 최적화</td><td>S3 Lifecycle Rule, Glacier, Delta Optimize</td></tr><tr><td><strong>멀티클라우드</strong></td><td>이식성 및 사일로 발생</td><td>클라우드별 서비스/포맷/카탈로그 차이</td><td>통합 관리 어려움, 복잡도 증가</td><td>클라우드간 메타데이터 불일치, 포맷 충돌</td><td>표준 기반 메타데이터/포맷 채택, 컨테이너화, 오픈소스 활용</td><td>Apache Iceberg, OpenLineage, Docker</td></tr></tbody></table><h3 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th>분류 기준</th><th>유형</th><th>설명</th><th>대표 기술 / 적용 사례</th></tr></thead><tbody><tr><td><strong>1. 배포 환경</strong></td><td>온프레미스 (On-Premise)</td><td>자체 데이터센터 및 HDFS 기반 구축, 높은 제어권</td><td>Hadoop, 금융·정부 기관</td></tr><tr><td></td><td>클라우드 (Cloud-Native)</td><td>완전 관리형 서비스 기반의 유연한 확장 구조</td><td>AWS S3, Azure ADLS, GCP GCS</td></tr><tr><td></td><td>하이브리드</td><td>온프레미스와 클라우드를 함께 사용하는 유연한 구성</td><td>AWS Outposts, Azure Arc, 점진적 클라우드 이전 시 활용</td></tr><tr><td><strong>2. 스토리지 유형</strong></td><td>오브젝트 스토리지 (Object)</td><td>대용량 비정형 데이터에 최적화, 확장성 뛰어남</td><td>Amazon S3, Azure Blob, GCS</td></tr><tr><td></td><td>파일 기반 (File)</td><td>파일 시스템 기반, 고성능 연산에 적합</td><td>HDFS, NFS</td></tr><tr><td></td><td>블록 기반 (Block)</td><td>저지연 고속 접근이 필요한 워크로드</td><td>EBS, SAN</td></tr><tr><td><strong>3. 처리 방식</strong></td><td>배치 처리 중심</td><td>주기적인 대량 데이터 처리, 정형 보고서 및 BI 에 적합</td><td>Apache Spark, Hive</td></tr><tr><td></td><td>실시간 처리 중심 (Streaming)</td><td>이벤트 기반 데이터 수집, 실시간 분석</td><td>Kafka, Flink, Spark Structured Streaming</td></tr><tr><td></td><td>하이브리드 처리</td><td>배치 + 스트림을 통합하여 유연한 데이터 처리 지원</td><td>Lambda Architecture, Kappa Architecture</td></tr><tr><td><strong>4. 아키텍처 계층</strong></td><td>단일 티어</td><td>모든 데이터가 하나의 계층에 저장됨 (단순 구조)</td><td>Flat HDFS 디렉토리 구조</td></tr><tr><td></td><td>멀티 티어</td><td>Raw → Processed → Curated 형태의 계층적 저장 구조</td><td>데이터 파이프라인 최적화 및 거버넌스 통합에 유리</td></tr><tr><td></td><td>레이크하우스 (Lakehouse)</td><td>레이크와 웨어하우스의 통합 구조. ACID, 카탈로그, 성능 기능 포함</td><td>Delta Lake, Apache Iceberg, Apache Hudi</td></tr><tr><td><strong>5. 통합 수준</strong></td><td>스탠드얼론 데이터 레이크</td><td>DWH 와 별도로 존재하는 독립형 데이터 저장소</td><td>전통적인 Hadoop 기반 구축형 레이크</td></tr><tr><td></td><td>통합형 (DWH 통합 or Lakehouse)</td><td>기존 DWH 와 연계하거나 웨어하우스 기능을 흡수한 구조</td><td>Snowflake on S3, Databricks</td></tr><tr><td><strong>6. 데이터 구조 유형</strong></td><td>정형 데이터 (Structured)</td><td>테이블, CSV, SQL 등 명확한 스키마가 존재하는 데이터</td><td>RDBMS Export, BI 연동 데이터</td></tr><tr><td></td><td>반정형 (Semi-structured)</td><td>JSON, XML, Avro 등 필드 기반 데이터</td><td>IoT, 로그 분석, 이벤트 데이터</td></tr><tr><td></td><td>비정형 (Unstructured)</td><td>이미지, 동영상, PDF, 로그 파일 등 구조 정의 어려운 데이터</td><td>데이터 레이크의 주요 대상, ML/AI 학습 데이터</td></tr><tr><td><strong>7. 관리 방식</strong></td><td>비관리형 (Self-managed)</td><td>자체 인프라/워크플로우/거버넌스를 직접 운영</td><td>Hadoop, Airflow, Hive</td></tr><tr><td></td><td>관리형 (Managed)</td><td>클라우드 공급자 또는 SaaS 기반의 데이터 레이크 플랫폼 제공</td><td>AWS Lake Formation, Azure Synapse, GCP BigLake</td></tr></tbody></table><h3 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h3><table><thead><tr><th>도메인</th><th>사용 목적</th><th>주요 데이터 유형</th><th>구성 요소 예시</th><th>기대 효과</th></tr></thead><tbody><tr><td><strong>금융</strong></td><td>리스크 분석, 감사 추적</td><td>거래 로그, 시장 데이터, 뉴스, 트랜잭션 기록</td><td>Kafka → S3/Parquet → Glue → Spark/Athena</td><td>실시간 리스크 감지, 규제 준수 강화</td></tr><tr><td><strong>헬스케어</strong></td><td>의료 진단, 환자 데이터 분석</td><td>의료 영상, 센서 데이터, EHR(전자 건강 기록)</td><td>S3 + Airflow + TensorFlow + SageMaker</td><td>95% 이상 정확도의 예측 모델 구축, 의료 의사결정 지원</td></tr><tr><td><strong>제조</strong></td><td>예측 정비, 품질 관리</td><td>IoT 센서, 장비 로그, 유지보수 이력</td><td>IoT → Kinesis/Flink → InfluxDB/S3 → Spark</td><td>다운타임 40% 감소, 실시간 이상 탐지</td></tr><tr><td><strong>이커머스</strong></td><td>사용자 행동 기반 추천, 마케팅 최적화</td><td>클릭스트림, 구매 이력, 검색 로그</td><td>Kafka → S3 → Athena/EMR + Spark MLlib</td><td>개인화 추천, 전환율 30% 향상</td></tr><tr><td><strong>리테일</strong></td><td>재고 최적화, 수요 예측</td><td>판매 이력, 재고 상태, 고객 활동 로그</td><td>S3 + Parquet + AWS Glue + Redshift Spectrum</td><td>재고 비용 감소, 수요 기반 재고 관리</td></tr><tr><td><strong>미디어</strong></td><td>콘텐츠 분석 및 검색 최적화</td><td>동영상, 오디오, 사용자 시청 로그</td><td>비정형 파일 (S3) + ML Indexing + OpenCV + Kafka</td><td>시청률 예측 85%, 콘텐츠 자동 분류</td></tr><tr><td><strong>IoT/스마트시티</strong></td><td>실시간 데이터 수집 및 분석</td><td>센서 데이터, GPS, 교통 흐름, 기후 정보</td><td>MQTT/Kafka → S3 + Time Series DB (InfluxDB, Timestream)</td><td>교통 흐름 최적화, 에너지 소비 분석</td></tr><tr><td><strong>AI/ML 플랫폼</strong></td><td>학습 데이터 통합 및 버전 관리</td><td>정형/비정형 데이터, 이미지, 라벨링된 텍스트</td><td>Data Lake + SageMaker + Feature Store + LakeFS</td><td>재현 가능한 학습 파이프라인, 데이터 버전 관리 체계화</td></tr><tr><td><strong>BI/리포팅</strong></td><td>대시보드 기반 리포트 생성 및 쿼리 수행</td><td>트랜잭션, 고객 활동 로그, KPI 집계</td><td>S3 + Athena + Quicksight/Looker</td><td>비용 효율적 분석, 빠른 리포트 작성</td></tr></tbody></table><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><h4 id=사례-1-글로벌-리테일-기업의-data-lake-기반-분석-시스템>사례 1: 글로벌 리테일 기업의 Data Lake 기반 분석 시스템<a hidden class=anchor aria-hidden=true href=#사례-1-글로벌-리테일-기업의-data-lake-기반-분석-시스템>#</a></h4><p><strong>시스템 구성:</strong></p><ul><li>POS, 온라인, IoT 등 다양한 소스 → 데이터 인제스트 → Data Lake(Amazon S3) → 카탈로그 (AWS Glue) → 분석 (Spark, Athena) → BI/머신러닝</li></ul><p><strong>Workflow:</strong></p><ol><li>다양한 소스에서 원본 데이터를 실시간/배치로 수집</li><li>Data Lake 에 원본 그대로 저장</li><li>Glue 카탈로그로 메타데이터 관리</li><li>Spark, Athena 등으로 분석 및 BI 리포팅</li><li>머신러닝 모델 학습 및 예측에 활용</li></ol><p><strong>Data Lake 의 역할:</strong></p><ul><li>데이터 통합 저장, 품질 관리, 다양한 워크로드 지원, 데이터 사일로 해소</li></ul><p><strong>Data Lake 유무에 따른 차이:</strong></p><ul><li><strong>도입 전:</strong><br>데이터 사일로, 중복, 분석 지연, 품질 문제</li><li><strong>도입 후:</strong><br>데이터 통합, 신속 분석, 품질/보안 강화, AI/ML 활용 극대화</li></ul><h4 id=사례-2-금융-데이터-감사-시스템>사례 2: 금융 데이터 감사 시스템<a hidden class=anchor aria-hidden=true href=#사례-2-금융-데이터-감사-시스템>#</a></h4><p>금융 기업에서 모든 고객의 거래 기록을 장기 보관하고, 필요한 경우 실시간으로 규제기관의 요청에 응답할 수 있도록 Data Lake 를 도입.</p><p><strong>시스템 구성 및 흐름</strong>:</p><pre class=mermaid>flowchart LR
  T[Transaction Logs] --&gt; K(Kinesis)
  K --&gt; RZ[&#34;Raw Zone (S3)&#34;]
  RZ --&gt; PR[Spark/Glue ETL]
  PR --&gt; CZ[&#34;Curated Zone (Parquet)&#34;]
  CZ --&gt; Q[Athena Query Layer]
  Q --&gt; GRC[감사 응답 시스템]
  CZ --&gt; CAT[Glue Catalog]
</pre><ul><li><strong>Raw Zone</strong>: 거래 로그 원본 JSON 저장</li><li><strong>Curated Zone</strong>: Parquet 형식으로 정제 저장</li><li><strong>Query Layer</strong>: 규제 기관의 SQL 요청 즉시 처리</li><li><strong>Metadata</strong>: Glue Catalog 로 스키마 및 위치 관리</li></ul><p><strong>차이점 비교</strong></p><table><thead><tr><th>항목</th><th>Data Lake 도입 전</th><th>도입 후</th></tr></thead><tbody><tr><td>데이터 보관 비용</td><td>고비용 관계형 DB 장기 보관</td><td>S3 기반 저비용 장기 저장</td></tr><tr><td>분석 응답 시간</td><td>느림 (CSV 추출 후 분석)</td><td>Athena 즉시 응답</td></tr><tr><td>스키마 관리</td><td>문서화 미흡</td><td>Glue Catalog 자동 관리</td></tr><tr><td>감사 응답</td><td>수작업</td><td>자동화 + 보안 추적 가능</td></tr></tbody></table><h4 id=사례-3-netflix-의-콘텐츠-추천-시스템>사례 3: Netflix 의 콘텐츠 추천 시스템<a hidden class=anchor aria-hidden=true href=#사례-3-netflix-의-콘텐츠-추천-시스템>#</a></h4><p><strong>시스템 구성</strong></p><ul><li>Netflix 는 AWS 기반 데이터 레이크를 구축하여 매일 15 억 시간의 시청 데이터를 처리한다.</li></ul><pre class=mermaid>graph TB
    subgraph &#34;Netflix 데이터 레이크 아키텍처&#34;
        A[시청 이벤트] --&gt; B[Amazon Kinesis]
        C[콘텐츠 메타데이터] --&gt; D[Apache Kafka]
        E[사용자 프로필] --&gt; F[AWS Lambda]
        
        B --&gt; G[Amazon S3 - Raw Layer]
        D --&gt; G
        F --&gt; G
        
        G --&gt; H[Apache Spark - Processing]
        H --&gt; I[S3 - Curated Layer]
        
        I --&gt; J[Apache Spark MLlib]
        J --&gt; K[추천 모델]
        
        K --&gt; L[Amazon ElastiCache]
        L --&gt; M[실시간 추천 API]
        
        I --&gt; N[Amazon Redshift]
        N --&gt; O[BI 대시보드]
    end
</pre><p><strong>Workflow</strong></p><ol><li><strong>데이터 수집</strong>: 시청 이벤트, 평점, 검색 쿼리를 실시간 수집</li><li><strong>원시 데이터 저장</strong>: S3 에 JSON 형태로 파티션별 저장</li><li><strong>데이터 처리</strong>: Spark 를 통한 ETL 파이프라인 실행</li><li><strong>모델 훈련</strong>: MLlib 기반 협업 필터링 및 딥러닝 모델</li><li><strong>추천 서비스</strong>: ElastiCache 를 통한 실시간 추천 제공</li></ol><p><strong>데이터 레이크의 역할</strong></p><ul><li><strong>스케일</strong>: 일일 20 억 건의 이벤트 처리</li><li><strong>유연성</strong>: 새로운 추천 알고리즘 빠른 실험</li><li><strong>비용 효율성</strong>: 전체 인프라 비용 60% 절감</li></ul><p><strong>데이터 레이크 유무에 따른 차이점</strong></p><table><thead><tr><th>구분</th><th>데이터 레이크 있음</th><th>데이터 레이크 없음</th></tr></thead><tbody><tr><td>데이터 처리 규모</td><td>일일 20 억 건</td><td>일일 1 억 건 한계</td></tr><tr><td>새 모델 배포 시간</td><td>2-3 일</td><td>2-3 주</td></tr><tr><td>스토리지 비용</td><td>월 10 만 달러</td><td>월 50 만 달러</td></tr><tr><td>데이터 형태 지원</td><td>모든 형태 지원</td><td>구조화 데이터만</td></tr><tr><td>A/B 테스트 속도</td><td>실시간</td><td>주간 단위</td></tr></tbody></table><h3 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h3><h4 id=python-고객-데이터-처리>Python: 고객 데이터 처리<a hidden class=anchor aria-hidden=true href=#python-고객-데이터-처리>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>  1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2>  2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3>  3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4>  4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5>  5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6>  6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7>  7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8>  8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9>  9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10> 10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11> 11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12> 12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13> 13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14> 14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15> 15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16> 16</a>
</span><span class=lnt id=hl-5-17><a class=lnlinks href=#hl-5-17> 17</a>
</span><span class=lnt id=hl-5-18><a class=lnlinks href=#hl-5-18> 18</a>
</span><span class=lnt id=hl-5-19><a class=lnlinks href=#hl-5-19> 19</a>
</span><span class=lnt id=hl-5-20><a class=lnlinks href=#hl-5-20> 20</a>
</span><span class=lnt id=hl-5-21><a class=lnlinks href=#hl-5-21> 21</a>
</span><span class=lnt id=hl-5-22><a class=lnlinks href=#hl-5-22> 22</a>
</span><span class=lnt id=hl-5-23><a class=lnlinks href=#hl-5-23> 23</a>
</span><span class=lnt id=hl-5-24><a class=lnlinks href=#hl-5-24> 24</a>
</span><span class=lnt id=hl-5-25><a class=lnlinks href=#hl-5-25> 25</a>
</span><span class=lnt id=hl-5-26><a class=lnlinks href=#hl-5-26> 26</a>
</span><span class=lnt id=hl-5-27><a class=lnlinks href=#hl-5-27> 27</a>
</span><span class=lnt id=hl-5-28><a class=lnlinks href=#hl-5-28> 28</a>
</span><span class=lnt id=hl-5-29><a class=lnlinks href=#hl-5-29> 29</a>
</span><span class=lnt id=hl-5-30><a class=lnlinks href=#hl-5-30> 30</a>
</span><span class=lnt id=hl-5-31><a class=lnlinks href=#hl-5-31> 31</a>
</span><span class=lnt id=hl-5-32><a class=lnlinks href=#hl-5-32> 32</a>
</span><span class=lnt id=hl-5-33><a class=lnlinks href=#hl-5-33> 33</a>
</span><span class=lnt id=hl-5-34><a class=lnlinks href=#hl-5-34> 34</a>
</span><span class=lnt id=hl-5-35><a class=lnlinks href=#hl-5-35> 35</a>
</span><span class=lnt id=hl-5-36><a class=lnlinks href=#hl-5-36> 36</a>
</span><span class=lnt id=hl-5-37><a class=lnlinks href=#hl-5-37> 37</a>
</span><span class=lnt id=hl-5-38><a class=lnlinks href=#hl-5-38> 38</a>
</span><span class=lnt id=hl-5-39><a class=lnlinks href=#hl-5-39> 39</a>
</span><span class=lnt id=hl-5-40><a class=lnlinks href=#hl-5-40> 40</a>
</span><span class=lnt id=hl-5-41><a class=lnlinks href=#hl-5-41> 41</a>
</span><span class=lnt id=hl-5-42><a class=lnlinks href=#hl-5-42> 42</a>
</span><span class=lnt id=hl-5-43><a class=lnlinks href=#hl-5-43> 43</a>
</span><span class=lnt id=hl-5-44><a class=lnlinks href=#hl-5-44> 44</a>
</span><span class=lnt id=hl-5-45><a class=lnlinks href=#hl-5-45> 45</a>
</span><span class=lnt id=hl-5-46><a class=lnlinks href=#hl-5-46> 46</a>
</span><span class=lnt id=hl-5-47><a class=lnlinks href=#hl-5-47> 47</a>
</span><span class=lnt id=hl-5-48><a class=lnlinks href=#hl-5-48> 48</a>
</span><span class=lnt id=hl-5-49><a class=lnlinks href=#hl-5-49> 49</a>
</span><span class=lnt id=hl-5-50><a class=lnlinks href=#hl-5-50> 50</a>
</span><span class=lnt id=hl-5-51><a class=lnlinks href=#hl-5-51> 51</a>
</span><span class=lnt id=hl-5-52><a class=lnlinks href=#hl-5-52> 52</a>
</span><span class=lnt id=hl-5-53><a class=lnlinks href=#hl-5-53> 53</a>
</span><span class=lnt id=hl-5-54><a class=lnlinks href=#hl-5-54> 54</a>
</span><span class=lnt id=hl-5-55><a class=lnlinks href=#hl-5-55> 55</a>
</span><span class=lnt id=hl-5-56><a class=lnlinks href=#hl-5-56> 56</a>
</span><span class=lnt id=hl-5-57><a class=lnlinks href=#hl-5-57> 57</a>
</span><span class=lnt id=hl-5-58><a class=lnlinks href=#hl-5-58> 58</a>
</span><span class=lnt id=hl-5-59><a class=lnlinks href=#hl-5-59> 59</a>
</span><span class=lnt id=hl-5-60><a class=lnlinks href=#hl-5-60> 60</a>
</span><span class=lnt id=hl-5-61><a class=lnlinks href=#hl-5-61> 61</a>
</span><span class=lnt id=hl-5-62><a class=lnlinks href=#hl-5-62> 62</a>
</span><span class=lnt id=hl-5-63><a class=lnlinks href=#hl-5-63> 63</a>
</span><span class=lnt id=hl-5-64><a class=lnlinks href=#hl-5-64> 64</a>
</span><span class=lnt id=hl-5-65><a class=lnlinks href=#hl-5-65> 65</a>
</span><span class=lnt id=hl-5-66><a class=lnlinks href=#hl-5-66> 66</a>
</span><span class=lnt id=hl-5-67><a class=lnlinks href=#hl-5-67> 67</a>
</span><span class=lnt id=hl-5-68><a class=lnlinks href=#hl-5-68> 68</a>
</span><span class=lnt id=hl-5-69><a class=lnlinks href=#hl-5-69> 69</a>
</span><span class=lnt id=hl-5-70><a class=lnlinks href=#hl-5-70> 70</a>
</span><span class=lnt id=hl-5-71><a class=lnlinks href=#hl-5-71> 71</a>
</span><span class=lnt id=hl-5-72><a class=lnlinks href=#hl-5-72> 72</a>
</span><span class=lnt id=hl-5-73><a class=lnlinks href=#hl-5-73> 73</a>
</span><span class=lnt id=hl-5-74><a class=lnlinks href=#hl-5-74> 74</a>
</span><span class=lnt id=hl-5-75><a class=lnlinks href=#hl-5-75> 75</a>
</span><span class=lnt id=hl-5-76><a class=lnlinks href=#hl-5-76> 76</a>
</span><span class=lnt id=hl-5-77><a class=lnlinks href=#hl-5-77> 77</a>
</span><span class=lnt id=hl-5-78><a class=lnlinks href=#hl-5-78> 78</a>
</span><span class=lnt id=hl-5-79><a class=lnlinks href=#hl-5-79> 79</a>
</span><span class=lnt id=hl-5-80><a class=lnlinks href=#hl-5-80> 80</a>
</span><span class=lnt id=hl-5-81><a class=lnlinks href=#hl-5-81> 81</a>
</span><span class=lnt id=hl-5-82><a class=lnlinks href=#hl-5-82> 82</a>
</span><span class=lnt id=hl-5-83><a class=lnlinks href=#hl-5-83> 83</a>
</span><span class=lnt id=hl-5-84><a class=lnlinks href=#hl-5-84> 84</a>
</span><span class=lnt id=hl-5-85><a class=lnlinks href=#hl-5-85> 85</a>
</span><span class=lnt id=hl-5-86><a class=lnlinks href=#hl-5-86> 86</a>
</span><span class=lnt id=hl-5-87><a class=lnlinks href=#hl-5-87> 87</a>
</span><span class=lnt id=hl-5-88><a class=lnlinks href=#hl-5-88> 88</a>
</span><span class=lnt id=hl-5-89><a class=lnlinks href=#hl-5-89> 89</a>
</span><span class=lnt id=hl-5-90><a class=lnlinks href=#hl-5-90> 90</a>
</span><span class=lnt id=hl-5-91><a class=lnlinks href=#hl-5-91> 91</a>
</span><span class=lnt id=hl-5-92><a class=lnlinks href=#hl-5-92> 92</a>
</span><span class=lnt id=hl-5-93><a class=lnlinks href=#hl-5-93> 93</a>
</span><span class=lnt id=hl-5-94><a class=lnlinks href=#hl-5-94> 94</a>
</span><span class=lnt id=hl-5-95><a class=lnlinks href=#hl-5-95> 95</a>
</span><span class=lnt id=hl-5-96><a class=lnlinks href=#hl-5-96> 96</a>
</span><span class=lnt id=hl-5-97><a class=lnlinks href=#hl-5-97> 97</a>
</span><span class=lnt id=hl-5-98><a class=lnlinks href=#hl-5-98> 98</a>
</span><span class=lnt id=hl-5-99><a class=lnlinks href=#hl-5-99> 99</a>
</span><span class=lnt id=hl-5-100><a class=lnlinks href=#hl-5-100>100</a>
</span><span class=lnt id=hl-5-101><a class=lnlinks href=#hl-5-101>101</a>
</span><span class=lnt id=hl-5-102><a class=lnlinks href=#hl-5-102>102</a>
</span><span class=lnt id=hl-5-103><a class=lnlinks href=#hl-5-103>103</a>
</span><span class=lnt id=hl-5-104><a class=lnlinks href=#hl-5-104>104</a>
</span><span class=lnt id=hl-5-105><a class=lnlinks href=#hl-5-105>105</a>
</span><span class=lnt id=hl-5-106><a class=lnlinks href=#hl-5-106>106</a>
</span><span class=lnt id=hl-5-107><a class=lnlinks href=#hl-5-107>107</a>
</span><span class=lnt id=hl-5-108><a class=lnlinks href=#hl-5-108>108</a>
</span><span class=lnt id=hl-5-109><a class=lnlinks href=#hl-5-109>109</a>
</span><span class=lnt id=hl-5-110><a class=lnlinks href=#hl-5-110>110</a>
</span><span class=lnt id=hl-5-111><a class=lnlinks href=#hl-5-111>111</a>
</span><span class=lnt id=hl-5-112><a class=lnlinks href=#hl-5-112>112</a>
</span><span class=lnt id=hl-5-113><a class=lnlinks href=#hl-5-113>113</a>
</span><span class=lnt id=hl-5-114><a class=lnlinks href=#hl-5-114>114</a>
</span><span class=lnt id=hl-5-115><a class=lnlinks href=#hl-5-115>115</a>
</span><span class=lnt id=hl-5-116><a class=lnlinks href=#hl-5-116>116</a>
</span><span class=lnt id=hl-5-117><a class=lnlinks href=#hl-5-117>117</a>
</span><span class=lnt id=hl-5-118><a class=lnlinks href=#hl-5-118>118</a>
</span><span class=lnt id=hl-5-119><a class=lnlinks href=#hl-5-119>119</a>
</span><span class=lnt id=hl-5-120><a class=lnlinks href=#hl-5-120>120</a>
</span><span class=lnt id=hl-5-121><a class=lnlinks href=#hl-5-121>121</a>
</span><span class=lnt id=hl-5-122><a class=lnlinks href=#hl-5-122>122</a>
</span><span class=lnt id=hl-5-123><a class=lnlinks href=#hl-5-123>123</a>
</span><span class=lnt id=hl-5-124><a class=lnlinks href=#hl-5-124>124</a>
</span><span class=lnt id=hl-5-125><a class=lnlinks href=#hl-5-125>125</a>
</span><span class=lnt id=hl-5-126><a class=lnlinks href=#hl-5-126>126</a>
</span><span class=lnt id=hl-5-127><a class=lnlinks href=#hl-5-127>127</a>
</span><span class=lnt id=hl-5-128><a class=lnlinks href=#hl-5-128>128</a>
</span><span class=lnt id=hl-5-129><a class=lnlinks href=#hl-5-129>129</a>
</span><span class=lnt id=hl-5-130><a class=lnlinks href=#hl-5-130>130</a>
</span><span class=lnt id=hl-5-131><a class=lnlinks href=#hl-5-131>131</a>
</span><span class=lnt id=hl-5-132><a class=lnlinks href=#hl-5-132>132</a>
</span><span class=lnt id=hl-5-133><a class=lnlinks href=#hl-5-133>133</a>
</span><span class=lnt id=hl-5-134><a class=lnlinks href=#hl-5-134>134</a>
</span><span class=lnt id=hl-5-135><a class=lnlinks href=#hl-5-135>135</a>
</span><span class=lnt id=hl-5-136><a class=lnlinks href=#hl-5-136>136</a>
</span><span class=lnt id=hl-5-137><a class=lnlinks href=#hl-5-137>137</a>
</span><span class=lnt id=hl-5-138><a class=lnlinks href=#hl-5-138>138</a>
</span><span class=lnt id=hl-5-139><a class=lnlinks href=#hl-5-139>139</a>
</span><span class=lnt id=hl-5-140><a class=lnlinks href=#hl-5-140>140</a>
</span><span class=lnt id=hl-5-141><a class=lnlinks href=#hl-5-141>141</a>
</span><span class=lnt id=hl-5-142><a class=lnlinks href=#hl-5-142>142</a>
</span><span class=lnt id=hl-5-143><a class=lnlinks href=#hl-5-143>143</a>
</span><span class=lnt id=hl-5-144><a class=lnlinks href=#hl-5-144>144</a>
</span><span class=lnt id=hl-5-145><a class=lnlinks href=#hl-5-145>145</a>
</span><span class=lnt id=hl-5-146><a class=lnlinks href=#hl-5-146>146</a>
</span><span class=lnt id=hl-5-147><a class=lnlinks href=#hl-5-147>147</a>
</span><span class=lnt id=hl-5-148><a class=lnlinks href=#hl-5-148>148</a>
</span><span class=lnt id=hl-5-149><a class=lnlinks href=#hl-5-149>149</a>
</span><span class=lnt id=hl-5-150><a class=lnlinks href=#hl-5-150>150</a>
</span><span class=lnt id=hl-5-151><a class=lnlinks href=#hl-5-151>151</a>
</span><span class=lnt id=hl-5-152><a class=lnlinks href=#hl-5-152>152</a>
</span><span class=lnt id=hl-5-153><a class=lnlinks href=#hl-5-153>153</a>
</span><span class=lnt id=hl-5-154><a class=lnlinks href=#hl-5-154>154</a>
</span><span class=lnt id=hl-5-155><a class=lnlinks href=#hl-5-155>155</a>
</span><span class=lnt id=hl-5-156><a class=lnlinks href=#hl-5-156>156</a>
</span><span class=lnt id=hl-5-157><a class=lnlinks href=#hl-5-157>157</a>
</span><span class=lnt id=hl-5-158><a class=lnlinks href=#hl-5-158>158</a>
</span><span class=lnt id=hl-5-159><a class=lnlinks href=#hl-5-159>159</a>
</span><span class=lnt id=hl-5-160><a class=lnlinks href=#hl-5-160>160</a>
</span><span class=lnt id=hl-5-161><a class=lnlinks href=#hl-5-161>161</a>
</span><span class=lnt id=hl-5-162><a class=lnlinks href=#hl-5-162>162</a>
</span><span class=lnt id=hl-5-163><a class=lnlinks href=#hl-5-163>163</a>
</span><span class=lnt id=hl-5-164><a class=lnlinks href=#hl-5-164>164</a>
</span><span class=lnt id=hl-5-165><a class=lnlinks href=#hl-5-165>165</a>
</span><span class=lnt id=hl-5-166><a class=lnlinks href=#hl-5-166>166</a>
</span><span class=lnt id=hl-5-167><a class=lnlinks href=#hl-5-167>167</a>
</span><span class=lnt id=hl-5-168><a class=lnlinks href=#hl-5-168>168</a>
</span><span class=lnt id=hl-5-169><a class=lnlinks href=#hl-5-169>169</a>
</span><span class=lnt id=hl-5-170><a class=lnlinks href=#hl-5-170>170</a>
</span><span class=lnt id=hl-5-171><a class=lnlinks href=#hl-5-171>171</a>
</span><span class=lnt id=hl-5-172><a class=lnlinks href=#hl-5-172>172</a>
</span><span class=lnt id=hl-5-173><a class=lnlinks href=#hl-5-173>173</a>
</span><span class=lnt id=hl-5-174><a class=lnlinks href=#hl-5-174>174</a>
</span><span class=lnt id=hl-5-175><a class=lnlinks href=#hl-5-175>175</a>
</span><span class=lnt id=hl-5-176><a class=lnlinks href=#hl-5-176>176</a>
</span><span class=lnt id=hl-5-177><a class=lnlinks href=#hl-5-177>177</a>
</span><span class=lnt id=hl-5-178><a class=lnlinks href=#hl-5-178>178</a>
</span><span class=lnt id=hl-5-179><a class=lnlinks href=#hl-5-179>179</a>
</span><span class=lnt id=hl-5-180><a class=lnlinks href=#hl-5-180>180</a>
</span><span class=lnt id=hl-5-181><a class=lnlinks href=#hl-5-181>181</a>
</span><span class=lnt id=hl-5-182><a class=lnlinks href=#hl-5-182>182</a>
</span><span class=lnt id=hl-5-183><a class=lnlinks href=#hl-5-183>183</a>
</span><span class=lnt id=hl-5-184><a class=lnlinks href=#hl-5-184>184</a>
</span><span class=lnt id=hl-5-185><a class=lnlinks href=#hl-5-185>185</a>
</span><span class=lnt id=hl-5-186><a class=lnlinks href=#hl-5-186>186</a>
</span><span class=lnt id=hl-5-187><a class=lnlinks href=#hl-5-187>187</a>
</span><span class=lnt id=hl-5-188><a class=lnlinks href=#hl-5-188>188</a>
</span><span class=lnt id=hl-5-189><a class=lnlinks href=#hl-5-189>189</a>
</span><span class=lnt id=hl-5-190><a class=lnlinks href=#hl-5-190>190</a>
</span><span class=lnt id=hl-5-191><a class=lnlinks href=#hl-5-191>191</a>
</span><span class=lnt id=hl-5-192><a class=lnlinks href=#hl-5-192>192</a>
</span><span class=lnt id=hl-5-193><a class=lnlinks href=#hl-5-193>193</a>
</span><span class=lnt id=hl-5-194><a class=lnlinks href=#hl-5-194>194</a>
</span><span class=lnt id=hl-5-195><a class=lnlinks href=#hl-5-195>195</a>
</span><span class=lnt id=hl-5-196><a class=lnlinks href=#hl-5-196>196</a>
</span><span class=lnt id=hl-5-197><a class=lnlinks href=#hl-5-197>197</a>
</span><span class=lnt id=hl-5-198><a class=lnlinks href=#hl-5-198>198</a>
</span><span class=lnt id=hl-5-199><a class=lnlinks href=#hl-5-199>199</a>
</span><span class=lnt id=hl-5-200><a class=lnlinks href=#hl-5-200>200</a>
</span><span class=lnt id=hl-5-201><a class=lnlinks href=#hl-5-201>201</a>
</span><span class=lnt id=hl-5-202><a class=lnlinks href=#hl-5-202>202</a>
</span><span class=lnt id=hl-5-203><a class=lnlinks href=#hl-5-203>203</a>
</span><span class=lnt id=hl-5-204><a class=lnlinks href=#hl-5-204>204</a>
</span><span class=lnt id=hl-5-205><a class=lnlinks href=#hl-5-205>205</a>
</span><span class=lnt id=hl-5-206><a class=lnlinks href=#hl-5-206>206</a>
</span><span class=lnt id=hl-5-207><a class=lnlinks href=#hl-5-207>207</a>
</span><span class=lnt id=hl-5-208><a class=lnlinks href=#hl-5-208>208</a>
</span><span class=lnt id=hl-5-209><a class=lnlinks href=#hl-5-209>209</a>
</span><span class=lnt id=hl-5-210><a class=lnlinks href=#hl-5-210>210</a>
</span><span class=lnt id=hl-5-211><a class=lnlinks href=#hl-5-211>211</a>
</span><span class=lnt id=hl-5-212><a class=lnlinks href=#hl-5-212>212</a>
</span><span class=lnt id=hl-5-213><a class=lnlinks href=#hl-5-213>213</a>
</span><span class=lnt id=hl-5-214><a class=lnlinks href=#hl-5-214>214</a>
</span><span class=lnt id=hl-5-215><a class=lnlinks href=#hl-5-215>215</a>
</span><span class=lnt id=hl-5-216><a class=lnlinks href=#hl-5-216>216</a>
</span><span class=lnt id=hl-5-217><a class=lnlinks href=#hl-5-217>217</a>
</span><span class=lnt id=hl-5-218><a class=lnlinks href=#hl-5-218>218</a>
</span><span class=lnt id=hl-5-219><a class=lnlinks href=#hl-5-219>219</a>
</span><span class=lnt id=hl-5-220><a class=lnlinks href=#hl-5-220>220</a>
</span><span class=lnt id=hl-5-221><a class=lnlinks href=#hl-5-221>221</a>
</span><span class=lnt id=hl-5-222><a class=lnlinks href=#hl-5-222>222</a>
</span><span class=lnt id=hl-5-223><a class=lnlinks href=#hl-5-223>223</a>
</span><span class=lnt id=hl-5-224><a class=lnlinks href=#hl-5-224>224</a>
</span><span class=lnt id=hl-5-225><a class=lnlinks href=#hl-5-225>225</a>
</span><span class=lnt id=hl-5-226><a class=lnlinks href=#hl-5-226>226</a>
</span><span class=lnt id=hl-5-227><a class=lnlinks href=#hl-5-227>227</a>
</span><span class=lnt id=hl-5-228><a class=lnlinks href=#hl-5-228>228</a>
</span><span class=lnt id=hl-5-229><a class=lnlinks href=#hl-5-229>229</a>
</span><span class=lnt id=hl-5-230><a class=lnlinks href=#hl-5-230>230</a>
</span><span class=lnt id=hl-5-231><a class=lnlinks href=#hl-5-231>231</a>
</span><span class=lnt id=hl-5-232><a class=lnlinks href=#hl-5-232>232</a>
</span><span class=lnt id=hl-5-233><a class=lnlinks href=#hl-5-233>233</a>
</span><span class=lnt id=hl-5-234><a class=lnlinks href=#hl-5-234>234</a>
</span><span class=lnt id=hl-5-235><a class=lnlinks href=#hl-5-235>235</a>
</span><span class=lnt id=hl-5-236><a class=lnlinks href=#hl-5-236>236</a>
</span><span class=lnt id=hl-5-237><a class=lnlinks href=#hl-5-237>237</a>
</span><span class=lnt id=hl-5-238><a class=lnlinks href=#hl-5-238>238</a>
</span><span class=lnt id=hl-5-239><a class=lnlinks href=#hl-5-239>239</a>
</span><span class=lnt id=hl-5-240><a class=lnlinks href=#hl-5-240>240</a>
</span><span class=lnt id=hl-5-241><a class=lnlinks href=#hl-5-241>241</a>
</span><span class=lnt id=hl-5-242><a class=lnlinks href=#hl-5-242>242</a>
</span><span class=lnt id=hl-5-243><a class=lnlinks href=#hl-5-243>243</a>
</span><span class=lnt id=hl-5-244><a class=lnlinks href=#hl-5-244>244</a>
</span><span class=lnt id=hl-5-245><a class=lnlinks href=#hl-5-245>245</a>
</span><span class=lnt id=hl-5-246><a class=lnlinks href=#hl-5-246>246</a>
</span><span class=lnt id=hl-5-247><a class=lnlinks href=#hl-5-247>247</a>
</span><span class=lnt id=hl-5-248><a class=lnlinks href=#hl-5-248>248</a>
</span><span class=lnt id=hl-5-249><a class=lnlinks href=#hl-5-249>249</a>
</span><span class=lnt id=hl-5-250><a class=lnlinks href=#hl-5-250>250</a>
</span><span class=lnt id=hl-5-251><a class=lnlinks href=#hl-5-251>251</a>
</span><span class=lnt id=hl-5-252><a class=lnlinks href=#hl-5-252>252</a>
</span><span class=lnt id=hl-5-253><a class=lnlinks href=#hl-5-253>253</a>
</span><span class=lnt id=hl-5-254><a class=lnlinks href=#hl-5-254>254</a>
</span><span class=lnt id=hl-5-255><a class=lnlinks href=#hl-5-255>255</a>
</span><span class=lnt id=hl-5-256><a class=lnlinks href=#hl-5-256>256</a>
</span><span class=lnt id=hl-5-257><a class=lnlinks href=#hl-5-257>257</a>
</span><span class=lnt id=hl-5-258><a class=lnlinks href=#hl-5-258>258</a>
</span><span class=lnt id=hl-5-259><a class=lnlinks href=#hl-5-259>259</a>
</span><span class=lnt id=hl-5-260><a class=lnlinks href=#hl-5-260>260</a>
</span><span class=lnt id=hl-5-261><a class=lnlinks href=#hl-5-261>261</a>
</span><span class=lnt id=hl-5-262><a class=lnlinks href=#hl-5-262>262</a>
</span><span class=lnt id=hl-5-263><a class=lnlinks href=#hl-5-263>263</a>
</span><span class=lnt id=hl-5-264><a class=lnlinks href=#hl-5-264>264</a>
</span><span class=lnt id=hl-5-265><a class=lnlinks href=#hl-5-265>265</a>
</span><span class=lnt id=hl-5-266><a class=lnlinks href=#hl-5-266>266</a>
</span><span class=lnt id=hl-5-267><a class=lnlinks href=#hl-5-267>267</a>
</span><span class=lnt id=hl-5-268><a class=lnlinks href=#hl-5-268>268</a>
</span><span class=lnt id=hl-5-269><a class=lnlinks href=#hl-5-269>269</a>
</span><span class=lnt id=hl-5-270><a class=lnlinks href=#hl-5-270>270</a>
</span><span class=lnt id=hl-5-271><a class=lnlinks href=#hl-5-271>271</a>
</span><span class=lnt id=hl-5-272><a class=lnlinks href=#hl-5-272>272</a>
</span><span class=lnt id=hl-5-273><a class=lnlinks href=#hl-5-273>273</a>
</span><span class=lnt id=hl-5-274><a class=lnlinks href=#hl-5-274>274</a>
</span><span class=lnt id=hl-5-275><a class=lnlinks href=#hl-5-275>275</a>
</span><span class=lnt id=hl-5-276><a class=lnlinks href=#hl-5-276>276</a>
</span><span class=lnt id=hl-5-277><a class=lnlinks href=#hl-5-277>277</a>
</span><span class=lnt id=hl-5-278><a class=lnlinks href=#hl-5-278>278</a>
</span><span class=lnt id=hl-5-279><a class=lnlinks href=#hl-5-279>279</a>
</span><span class=lnt id=hl-5-280><a class=lnlinks href=#hl-5-280>280</a>
</span><span class=lnt id=hl-5-281><a class=lnlinks href=#hl-5-281>281</a>
</span><span class=lnt id=hl-5-282><a class=lnlinks href=#hl-5-282>282</a>
</span><span class=lnt id=hl-5-283><a class=lnlinks href=#hl-5-283>283</a>
</span><span class=lnt id=hl-5-284><a class=lnlinks href=#hl-5-284>284</a>
</span><span class=lnt id=hl-5-285><a class=lnlinks href=#hl-5-285>285</a>
</span><span class=lnt id=hl-5-286><a class=lnlinks href=#hl-5-286>286</a>
</span><span class=lnt id=hl-5-287><a class=lnlinks href=#hl-5-287>287</a>
</span><span class=lnt id=hl-5-288><a class=lnlinks href=#hl-5-288>288</a>
</span><span class=lnt id=hl-5-289><a class=lnlinks href=#hl-5-289>289</a>
</span><span class=lnt id=hl-5-290><a class=lnlinks href=#hl-5-290>290</a>
</span><span class=lnt id=hl-5-291><a class=lnlinks href=#hl-5-291>291</a>
</span><span class=lnt id=hl-5-292><a class=lnlinks href=#hl-5-292>292</a>
</span><span class=lnt id=hl-5-293><a class=lnlinks href=#hl-5-293>293</a>
</span><span class=lnt id=hl-5-294><a class=lnlinks href=#hl-5-294>294</a>
</span><span class=lnt id=hl-5-295><a class=lnlinks href=#hl-5-295>295</a>
</span><span class=lnt id=hl-5-296><a class=lnlinks href=#hl-5-296>296</a>
</span><span class=lnt id=hl-5-297><a class=lnlinks href=#hl-5-297>297</a>
</span><span class=lnt id=hl-5-298><a class=lnlinks href=#hl-5-298>298</a>
</span><span class=lnt id=hl-5-299><a class=lnlinks href=#hl-5-299>299</a>
</span><span class=lnt id=hl-5-300><a class=lnlinks href=#hl-5-300>300</a>
</span><span class=lnt id=hl-5-301><a class=lnlinks href=#hl-5-301>301</a>
</span><span class=lnt id=hl-5-302><a class=lnlinks href=#hl-5-302>302</a>
</span><span class=lnt id=hl-5-303><a class=lnlinks href=#hl-5-303>303</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>boto3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pyspark.sql</span> <span class=kn>import</span> <span class=n>SparkSession</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pyspark.sql.functions</span> <span class=kn>import</span> <span class=n>col</span><span class=p>,</span> <span class=n>when</span><span class=p>,</span> <span class=n>isnan</span><span class=p>,</span> <span class=n>count</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DataLakeManager</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    데이터 레이크 관리를 위한 클래스
</span></span></span><span class=line><span class=cl><span class=s2>    주요 기능: 데이터 수집, 저장, 품질 검증, 카탈로그 관리
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bucket_name</span><span class=p>,</span> <span class=n>region</span><span class=o>=</span><span class=s1>&#39;us-east-1&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        데이터 레이크 매니저 초기화
</span></span></span><span class=line><span class=cl><span class=s2>        Args:
</span></span></span><span class=line><span class=cl><span class=s2>            bucket_name: S3 버킷 이름
</span></span></span><span class=line><span class=cl><span class=s2>            region: AWS 리전
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>bucket_name</span> <span class=o>=</span> <span class=n>bucket_name</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>s3_client</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s1>&#39;s3&#39;</span><span class=p>,</span> <span class=n>region_name</span><span class=o>=</span><span class=n>region</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>glue_client</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s1>&#39;glue&#39;</span><span class=p>,</span> <span class=n>region_name</span><span class=o>=</span><span class=n>region</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Spark 세션 초기화 - 데이터 처리 엔진</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>spark</span> <span class=o>=</span> <span class=n>SparkSession</span><span class=o>.</span><span class=n>builder</span> \
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=n>appName</span><span class=p>(</span><span class=s2>&#34;DataLakeProcessor&#34;</span><span class=p>)</span> \
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=n>config</span><span class=p>(</span><span class=s2>&#34;spark.sql.adaptive.enabled&#34;</span><span class=p>,</span> <span class=s2>&#34;true&#34;</span><span class=p>)</span> \
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=n>config</span><span class=p>(</span><span class=s2>&#34;spark.sql.adaptive.coalescePartitions.enabled&#34;</span><span class=p>,</span> <span class=s2>&#34;true&#34;</span><span class=p>)</span> \
</span></span><span class=line><span class=cl>            <span class=o>.</span><span class=n>getOrCreate</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 로깅 설정 - 운영 모니터링을 위한 로그</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>ingest_batch_data</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>source_path</span><span class=p>,</span> <span class=n>destination_key</span><span class=p>,</span> <span class=n>data_format</span><span class=o>=</span><span class=s1>&#39;parquet&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        배치 데이터 수집 및 저장
</span></span></span><span class=line><span class=cl><span class=s2>        Args:
</span></span></span><span class=line><span class=cl><span class=s2>            source_path: 소스 데이터 경로
</span></span></span><span class=line><span class=cl><span class=s2>            destination_key: S3 저장 경로
</span></span></span><span class=line><span class=cl><span class=s2>            data_format: 데이터 형식 (parquet, json, csv)
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 데이터 읽기 - 다양한 형식 지원</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>data_format</span> <span class=o>==</span> <span class=s1>&#39;parquet&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>df</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>spark</span><span class=o>.</span><span class=n>read</span><span class=o>.</span><span class=n>parquet</span><span class=p>(</span><span class=n>source_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>data_format</span> <span class=o>==</span> <span class=s1>&#39;json&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>df</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>spark</span><span class=o>.</span><span class=n>read</span><span class=o>.</span><span class=n>json</span><span class=p>(</span><span class=n>source_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>  <span class=c1># CSV</span>
</span></span><span class=line><span class=cl>                <span class=n>df</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>spark</span><span class=o>.</span><span class=n>read</span><span class=o>.</span><span class=n>option</span><span class=p>(</span><span class=s2>&#34;header&#34;</span><span class=p>,</span> <span class=s2>&#34;true&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>csv</span><span class=p>(</span><span class=n>source_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 데이터 품질 검증 - 결측치 및 중복 확인</span>
</span></span><span class=line><span class=cl>            <span class=n>quality_metrics</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_validate_data_quality</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Data quality metrics: </span><span class=si>{</span><span class=n>quality_metrics</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 메타데이터 추가 - 데이터 계보 추적을 위한 정보</span>
</span></span><span class=line><span class=cl>            <span class=n>df_with_metadata</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>withColumn</span><span class=p>(</span><span class=s2>&#34;ingestion_timestamp&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                                           <span class=n>lit</span><span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 파티션 기반 저장 - 성능 최적화를 위한 파티셔닝</span>
</span></span><span class=line><span class=cl>            <span class=n>partition_column</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_determine_partition_column</span><span class=p>(</span><span class=n>df_with_metadata</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># S3에 저장 - Raw 계층에 원시 데이터 저장</span>
</span></span><span class=line><span class=cl>            <span class=n>s3_path</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;s3a://</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>bucket_name</span><span class=si>}</span><span class=s2>/raw/</span><span class=si>{</span><span class=n>destination_key</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>partition_column</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>df_with_metadata</span><span class=o>.</span><span class=n>write</span><span class=o>.</span><span class=n>mode</span><span class=p>(</span><span class=s2>&#34;append&#34;</span><span class=p>)</span> \
</span></span><span class=line><span class=cl>                    <span class=o>.</span><span class=n>partitionBy</span><span class=p>(</span><span class=n>partition_column</span><span class=p>)</span> \
</span></span><span class=line><span class=cl>                    <span class=o>.</span><span class=n>parquet</span><span class=p>(</span><span class=n>s3_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>df_with_metadata</span><span class=o>.</span><span class=n>write</span><span class=o>.</span><span class=n>mode</span><span class=p>(</span><span class=s2>&#34;append&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>parquet</span><span class=p>(</span><span class=n>s3_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 메타데이터 카탈로그 업데이트</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_update_glue_catalog</span><span class=p>(</span><span class=n>destination_key</span><span class=p>,</span> <span class=n>df_with_metadata</span><span class=o>.</span><span class=n>schema</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Successfully ingested </span><span class=si>{</span><span class=n>df</span><span class=o>.</span><span class=n>count</span><span class=p>()</span><span class=si>}</span><span class=s2> records to </span><span class=si>{</span><span class=n>s3_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error ingesting data: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_validate_data_quality</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        데이터 품질 검증 함수
</span></span></span><span class=line><span class=cl><span class=s2>        Returns:
</span></span></span><span class=line><span class=cl><span class=s2>            dict: 품질 메트릭 정보
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>total_rows</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>count</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 컬럼별 결측치 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>null_counts</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>select</span><span class=p>([</span><span class=n>count</span><span class=p>(</span><span class=n>when</span><span class=p>(</span><span class=n>col</span><span class=p>(</span><span class=n>c</span><span class=p>)</span><span class=o>.</span><span class=n>isNull</span><span class=p>()</span> <span class=o>|</span> <span class=n>isnan</span><span class=p>(</span><span class=n>col</span><span class=p>(</span><span class=n>c</span><span class=p>)),</span> <span class=n>c</span><span class=p>))</span><span class=o>.</span><span class=n>alias</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>                               <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>])</span><span class=o>.</span><span class=n>collect</span><span class=p>()[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>asDict</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 중복 레코드 수 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>distinct_rows</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>distinct</span><span class=p>()</span><span class=o>.</span><span class=n>count</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>duplicate_rows</span> <span class=o>=</span> <span class=n>total_rows</span> <span class=o>-</span> <span class=n>distinct_rows</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_rows&#39;</span><span class=p>:</span> <span class=n>total_rows</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;duplicate_rows&#39;</span><span class=p>:</span> <span class=n>duplicate_rows</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;null_counts&#39;</span><span class=p>:</span> <span class=n>null_counts</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;duplicate_percentage&#39;</span><span class=p>:</span> <span class=p>(</span><span class=n>duplicate_rows</span> <span class=o>/</span> <span class=n>total_rows</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span> <span class=k>if</span> <span class=n>total_rows</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_determine_partition_column</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>df</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        최적의 파티션 컬럼 결정
</span></span></span><span class=line><span class=cl><span class=s2>        Returns:
</span></span></span><span class=line><span class=cl><span class=s2>            str: 파티션 컬럼명 또는 None
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 날짜/시간 컬럼 우선 선택</span>
</span></span><span class=line><span class=cl>        <span class=n>date_columns</span> <span class=o>=</span> <span class=p>[</span><span class=n>col</span> <span class=k>for</span> <span class=n>col</span> <span class=ow>in</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span> 
</span></span><span class=line><span class=cl>                       <span class=k>if</span> <span class=s1>&#39;date&#39;</span> <span class=ow>in</span> <span class=n>col</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>or</span> <span class=s1>&#39;time&#39;</span> <span class=ow>in</span> <span class=n>col</span><span class=o>.</span><span class=n>lower</span><span class=p>()]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>date_columns</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>date_columns</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 카디널리티가 적절한 범위의 컬럼 선택 (100-10000)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>col_name</span> <span class=ow>in</span> <span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>df</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=n>col_name</span><span class=p>)</span><span class=o>.</span><span class=n>distinct</span><span class=p>()</span><span class=o>.</span><span class=n>count</span><span class=p>()</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=mi>10000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>col_name</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_update_glue_catalog</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>table_name</span><span class=p>,</span> <span class=n>schema</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        AWS Glue 카탈로그 업데이트 - 메타데이터 관리
</span></span></span><span class=line><span class=cl><span class=s2>        Args:
</span></span></span><span class=line><span class=cl><span class=s2>            table_name: 테이블명
</span></span></span><span class=line><span class=cl><span class=s2>            schema: 스키마 정보
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># Spark 스키마를 Glue 스키마로 변환</span>
</span></span><span class=line><span class=cl>            <span class=n>glue_columns</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>field</span> <span class=ow>in</span> <span class=n>schema</span><span class=o>.</span><span class=n>fields</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>glue_columns</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;Name&#39;</span><span class=p>:</span> <span class=n>field</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;Type&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_spark_to_glue_type</span><span class=p>(</span><span class=n>field</span><span class=o>.</span><span class=n>dataType</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>})</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Glue 테이블 정의</span>
</span></span><span class=line><span class=cl>            <span class=n>table_input</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;Name&#39;</span><span class=p>:</span> <span class=n>table_name</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=s1>&#39;_&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;StorageDescriptor&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;Columns&#39;</span><span class=p>:</span> <span class=n>glue_columns</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;Location&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;s3://</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>bucket_name</span><span class=si>}</span><span class=s2>/raw/</span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2>/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;InputFormat&#39;</span><span class=p>:</span> <span class=s1>&#39;org.apache.hadoop.mapred.TextInputFormat&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;OutputFormat&#39;</span><span class=p>:</span> <span class=s1>&#39;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;SerdeInfo&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;SerializationLibrary&#39;</span><span class=p>:</span> <span class=s1>&#39;org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe&#39;</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 테이블 생성 또는 업데이트</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>glue_client</span><span class=o>.</span><span class=n>create_table</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>DatabaseName</span><span class=o>=</span><span class=s1>&#39;data_lake_catalog&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>TableInput</span><span class=o>=</span><span class=n>table_input</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=bp>self</span><span class=o>.</span><span class=n>glue_client</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>AlreadyExistsException</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>glue_client</span><span class=o>.</span><span class=n>update_table</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>DatabaseName</span><span class=o>=</span><span class=s1>&#39;data_lake_catalog&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>TableInput</span><span class=o>=</span><span class=n>table_input</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Updated Glue catalog for table: </span><span class=si>{</span><span class=n>table_name</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to update Glue catalog: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_spark_to_glue_type</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>spark_type</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        Spark 데이터 타입을 Glue 데이터 타입으로 변환
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>type_mapping</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;StringType&#39;</span><span class=p>:</span> <span class=s1>&#39;string&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;IntegerType&#39;</span><span class=p>:</span> <span class=s1>&#39;int&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;LongType&#39;</span><span class=p>:</span> <span class=s1>&#39;bigint&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;DoubleType&#39;</span><span class=p>:</span> <span class=s1>&#39;double&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;BooleanType&#39;</span><span class=p>:</span> <span class=s1>&#39;boolean&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;TimestampType&#39;</span><span class=p>:</span> <span class=s1>&#39;timestamp&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>type_mapping</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>spark_type</span><span class=p>)</span><span class=o>.</span><span class=vm>__name__</span><span class=p>,</span> <span class=s1>&#39;string&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>transform_data</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>source_table</span><span class=p>,</span> <span class=n>target_path</span><span class=p>,</span> <span class=n>transformation_rules</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        데이터 변환 및 정제 - Curated 계층 생성
</span></span></span><span class=line><span class=cl><span class=s2>        Args:
</span></span></span><span class=line><span class=cl><span class=s2>            source_table: 원본 테이블명
</span></span></span><span class=line><span class=cl><span class=s2>            target_path: 변환된 데이터 저장 경로
</span></span></span><span class=line><span class=cl><span class=s2>            transformation_rules: 변환 규칙 딕셔너리
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 원시 데이터 읽기</span>
</span></span><span class=line><span class=cl>            <span class=n>source_path</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;s3a://</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>bucket_name</span><span class=si>}</span><span class=s2>/raw/</span><span class=si>{</span><span class=n>source_table</span><span class=si>}</span><span class=s2>/&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>df</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>spark</span><span class=o>.</span><span class=n>read</span><span class=o>.</span><span class=n>parquet</span><span class=p>(</span><span class=n>source_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 변환 규칙 적용</span>
</span></span><span class=line><span class=cl>            <span class=n>transformed_df</span> <span class=o>=</span> <span class=n>df</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 컬럼 이름 정규화</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=s1>&#39;column_mapping&#39;</span> <span class=ow>in</span> <span class=n>transformation_rules</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>old_name</span><span class=p>,</span> <span class=n>new_name</span> <span class=ow>in</span> <span class=n>transformation_rules</span><span class=p>[</span><span class=s1>&#39;column_mapping&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                    <span class=n>transformed_df</span> <span class=o>=</span> <span class=n>transformed_df</span><span class=o>.</span><span class=n>withColumnRenamed</span><span class=p>(</span><span class=n>old_name</span><span class=p>,</span> <span class=n>new_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 데이터 타입 변환</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=s1>&#39;type_casting&#39;</span> <span class=ow>in</span> <span class=n>transformation_rules</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>column</span><span class=p>,</span> <span class=n>data_type</span> <span class=ow>in</span> <span class=n>transformation_rules</span><span class=p>[</span><span class=s1>&#39;type_casting&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                    <span class=n>transformed_df</span> <span class=o>=</span> <span class=n>transformed_df</span><span class=o>.</span><span class=n>withColumn</span><span class=p>(</span><span class=n>column</span><span class=p>,</span> <span class=n>col</span><span class=p>(</span><span class=n>column</span><span class=p>)</span><span class=o>.</span><span class=n>cast</span><span class=p>(</span><span class=n>data_type</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 필터링 규칙 적용</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=s1>&#39;filters&#39;</span> <span class=ow>in</span> <span class=n>transformation_rules</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>filter_condition</span> <span class=ow>in</span> <span class=n>transformation_rules</span><span class=p>[</span><span class=s1>&#39;filters&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=n>transformed_df</span> <span class=o>=</span> <span class=n>transformed_df</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>filter_condition</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 집계 규칙 적용</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=s1>&#39;aggregations&#39;</span> <span class=ow>in</span> <span class=n>transformation_rules</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>group_by_cols</span> <span class=o>=</span> <span class=n>transformation_rules</span><span class=p>[</span><span class=s1>&#39;aggregations&#39;</span><span class=p>][</span><span class=s1>&#39;group_by&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>agg_expressions</span> <span class=o>=</span> <span class=n>transformation_rules</span><span class=p>[</span><span class=s1>&#39;aggregations&#39;</span><span class=p>][</span><span class=s1>&#39;expressions&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>transformed_df</span> <span class=o>=</span> <span class=n>transformed_df</span><span class=o>.</span><span class=n>groupBy</span><span class=p>(</span><span class=o>*</span><span class=n>group_by_cols</span><span class=p>)</span><span class=o>.</span><span class=n>agg</span><span class=p>(</span><span class=o>*</span><span class=n>agg_expressions</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Curated 계층에 저장</span>
</span></span><span class=line><span class=cl>            <span class=n>curated_path</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;s3a://</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>bucket_name</span><span class=si>}</span><span class=s2>/curated/</span><span class=si>{</span><span class=n>target_path</span><span class=si>}</span><span class=s2>/&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>transformed_df</span><span class=o>.</span><span class=n>write</span><span class=o>.</span><span class=n>mode</span><span class=p>(</span><span class=s2>&#34;overwrite&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>parquet</span><span class=p>(</span><span class=n>curated_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 메타데이터 업데이트</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_update_glue_catalog</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;curated_</span><span class=si>{</span><span class=n>target_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>transformed_df</span><span class=o>.</span><span class=n>schema</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Successfully transformed and stored data to </span><span class=si>{</span><span class=n>curated_path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error transforming data: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_data_pipeline</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>pipeline_config</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        데이터 파이프라인 생성 - ETL 워크플로우 자동화
</span></span></span><span class=line><span class=cl><span class=s2>        Args:
</span></span></span><span class=line><span class=cl><span class=s2>            pipeline_config: 파이프라인 설정 정보
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>step</span> <span class=ow>in</span> <span class=n>pipeline_config</span><span class=p>[</span><span class=s1>&#39;steps&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>step</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;ingestion&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>ingest_batch_data</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                        <span class=n>step</span><span class=p>[</span><span class=s1>&#39;source_path&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                        <span class=n>step</span><span class=p>[</span><span class=s1>&#39;destination_key&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                        <span class=n>step</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;format&#39;</span><span class=p>,</span> <span class=s1>&#39;parquet&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>elif</span> <span class=n>step</span><span class=p>[</span><span class=s1>&#39;type&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;transformation&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>transform_data</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                        <span class=n>step</span><span class=p>[</span><span class=s1>&#39;source_table&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                        <span class=n>step</span><span class=p>[</span><span class=s1>&#39;target_path&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                        <span class=n>step</span><span class=p>[</span><span class=s1>&#39;transformation_rules&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                    <span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s2>&#34;Data pipeline executed successfully&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Pipeline execution failed: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 데이터 레이크 매니저 초기화</span>
</span></span><span class=line><span class=cl>    <span class=n>dl_manager</span> <span class=o>=</span> <span class=n>DataLakeManager</span><span class=p>(</span><span class=n>bucket_name</span><span class=o>=</span><span class=s2>&#34;my-data-lake-bucket&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 파이프라인 설정 - 고객 데이터 처리 예시</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline_config</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;steps&#39;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;ingestion&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;source_path&#39;</span><span class=p>:</span> <span class=s1>&#39;/data/customer_data.parquet&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;destination_key&#39;</span><span class=p>:</span> <span class=s1>&#39;customer_data&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;format&#39;</span><span class=p>:</span> <span class=s1>&#39;parquet&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;transformation&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;source_table&#39;</span><span class=p>:</span> <span class=s1>&#39;customer_data&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;target_path&#39;</span><span class=p>:</span> <span class=s1>&#39;customer_insights&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;transformation_rules&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;column_mapping&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;cust_id&#39;</span><span class=p>:</span> <span class=s1>&#39;customer_id&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;cust_name&#39;</span><span class=p>:</span> <span class=s1>&#39;customer_name&#39;</span>
</span></span><span class=line><span class=cl>                    <span class=p>},</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;type_casting&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=s1>&#39;string&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=s1>&#39;integer&#39;</span>
</span></span><span class=line><span class=cl>                    <span class=p>},</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;filters&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;age &gt; 18&#39;</span><span class=p>,</span> <span class=s1>&#39;customer_name is not null&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;aggregations&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;group_by&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;age_group&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;expressions&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;count(*).alias(&#34;customer_count&#34;)&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                                      <span class=s1>&#39;avg(&#34;purchase_amount&#34;).alias(&#34;avg_purchase&#34;)&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 파이프라인 실행</span>
</span></span><span class=line><span class=cl>    <span class=n>dl_manager</span><span class=o>.</span><span class=n>create_data_pipeline</span><span class=p>(</span><span class=n>pipeline_config</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=python--aws-sdk>Python + AWS SDK<a hidden class=anchor aria-hidden=true href=#python--aws-sdk>#</a></h4><p><strong>목적</strong>: 금융 거래 로그를 S3 에 저장하고, Glue Catalog 에 자동 등록</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14>14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15>15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16>16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17>17</a>
</span><span class=lnt id=hl-6-18><a class=lnlinks href=#hl-6-18>18</a>
</span><span class=lnt id=hl-6-19><a class=lnlinks href=#hl-6-19>19</a>
</span><span class=lnt id=hl-6-20><a class=lnlinks href=#hl-6-20>20</a>
</span><span class=lnt id=hl-6-21><a class=lnlinks href=#hl-6-21>21</a>
</span><span class=lnt id=hl-6-22><a class=lnlinks href=#hl-6-22>22</a>
</span><span class=lnt id=hl-6-23><a class=lnlinks href=#hl-6-23>23</a>
</span><span class=lnt id=hl-6-24><a class=lnlinks href=#hl-6-24>24</a>
</span><span class=lnt id=hl-6-25><a class=lnlinks href=#hl-6-25>25</a>
</span><span class=lnt id=hl-6-26><a class=lnlinks href=#hl-6-26>26</a>
</span><span class=lnt id=hl-6-27><a class=lnlinks href=#hl-6-27>27</a>
</span><span class=lnt id=hl-6-28><a class=lnlinks href=#hl-6-28>28</a>
</span><span class=lnt id=hl-6-29><a class=lnlinks href=#hl-6-29>29</a>
</span><span class=lnt id=hl-6-30><a class=lnlinks href=#hl-6-30>30</a>
</span><span class=lnt id=hl-6-31><a class=lnlinks href=#hl-6-31>31</a>
</span><span class=lnt id=hl-6-32><a class=lnlinks href=#hl-6-32>32</a>
</span><span class=lnt id=hl-6-33><a class=lnlinks href=#hl-6-33>33</a>
</span><span class=lnt id=hl-6-34><a class=lnlinks href=#hl-6-34>34</a>
</span><span class=lnt id=hl-6-35><a class=lnlinks href=#hl-6-35>35</a>
</span><span class=lnt id=hl-6-36><a class=lnlinks href=#hl-6-36>36</a>
</span><span class=lnt id=hl-6-37><a class=lnlinks href=#hl-6-37>37</a>
</span><span class=lnt id=hl-6-38><a class=lnlinks href=#hl-6-38>38</a>
</span><span class=lnt id=hl-6-39><a class=lnlinks href=#hl-6-39>39</a>
</span><span class=lnt id=hl-6-40><a class=lnlinks href=#hl-6-40>40</a>
</span><span class=lnt id=hl-6-41><a class=lnlinks href=#hl-6-41>41</a>
</span><span class=lnt id=hl-6-42><a class=lnlinks href=#hl-6-42>42</a>
</span><span class=lnt id=hl-6-43><a class=lnlinks href=#hl-6-43>43</a>
</span><span class=lnt id=hl-6-44><a class=lnlinks href=#hl-6-44>44</a>
</span><span class=lnt id=hl-6-45><a class=lnlinks href=#hl-6-45>45</a>
</span><span class=lnt id=hl-6-46><a class=lnlinks href=#hl-6-46>46</a>
</span><span class=lnt id=hl-6-47><a class=lnlinks href=#hl-6-47>47</a>
</span><span class=lnt id=hl-6-48><a class=lnlinks href=#hl-6-48>48</a>
</span><span class=lnt id=hl-6-49><a class=lnlinks href=#hl-6-49>49</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>boto3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 거래 로그 예시</span>
</span></span><span class=line><span class=cl><span class=n>transaction</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;transaction_id&#34;</span><span class=p>:</span> <span class=s2>&#34;TX123456&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;user_id&#34;</span><span class=p>:</span> <span class=s2>&#34;U789&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;amount&#34;</span><span class=p>:</span> <span class=mf>320.50</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;currency&#34;</span><span class=p>:</span> <span class=s2>&#34;USD&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;timestamp&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># S3 저장</span>
</span></span><span class=line><span class=cl><span class=n>s3</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s1>&#39;s3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>bucket</span> <span class=o>=</span> <span class=s2>&#34;banking-raw-zone&#34;</span>
</span></span><span class=line><span class=cl><span class=n>key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;transactions/</span><span class=si>{</span><span class=n>transaction</span><span class=p>[</span><span class=s1>&#39;transaction_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>.json&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s3</span><span class=o>.</span><span class=n>put_object</span><span class=p>(</span><span class=n>Bucket</span><span class=o>=</span><span class=n>bucket</span><span class=p>,</span> <span class=n>Key</span><span class=o>=</span><span class=n>key</span><span class=p>,</span> <span class=n>Body</span><span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>transaction</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Raw transaction saved to S3.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Glue Catalog 자동 등록 예시</span>
</span></span><span class=line><span class=cl><span class=n>glue</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s1>&#39;glue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>glue</span><span class=o>.</span><span class=n>create_table</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>DatabaseName</span><span class=o>=</span><span class=s1>&#39;finance_logs&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>TableInput</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Name&#39;</span><span class=p>:</span> <span class=s1>&#39;transactions&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;StorageDescriptor&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Columns&#39;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s1>&#39;Name&#39;</span><span class=p>:</span> <span class=s1>&#39;transaction_id&#39;</span><span class=p>,</span> <span class=s1>&#39;Type&#39;</span><span class=p>:</span> <span class=s1>&#39;string&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s1>&#39;Name&#39;</span><span class=p>:</span> <span class=s1>&#39;user_id&#39;</span><span class=p>,</span> <span class=s1>&#39;Type&#39;</span><span class=p>:</span> <span class=s1>&#39;string&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s1>&#39;Name&#39;</span><span class=p>:</span> <span class=s1>&#39;amount&#39;</span><span class=p>,</span> <span class=s1>&#39;Type&#39;</span><span class=p>:</span> <span class=s1>&#39;double&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s1>&#39;Name&#39;</span><span class=p>:</span> <span class=s1>&#39;currency&#39;</span><span class=p>,</span> <span class=s1>&#39;Type&#39;</span><span class=p>:</span> <span class=s1>&#39;string&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s1>&#39;Name&#39;</span><span class=p>:</span> <span class=s1>&#39;timestamp&#39;</span><span class=p>,</span> <span class=s1>&#39;Type&#39;</span><span class=p>:</span> <span class=s1>&#39;string&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Location&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;s3://</span><span class=si>{</span><span class=n>bucket</span><span class=si>}</span><span class=s2>/transactions/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;InputFormat&#39;</span><span class=p>:</span> <span class=s1>&#39;org.apache.hadoop.mapred.TextInputFormat&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;OutputFormat&#39;</span><span class=p>:</span> <span class=s1>&#39;org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;SerdeInfo&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;SerializationLibrary&#39;</span><span class=p>:</span> <span class=s1>&#39;org.openx.data.jsonserde.JsonSerDe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;Parameters&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;serialization.format&#39;</span><span class=p>:</span> <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;TableType&#39;</span><span class=p>:</span> <span class=s1>&#39;EXTERNAL_TABLE&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Glue Catalog 등록 완료.&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>S3 에 거래 JSON 을 저장하고</li><li>Glue Catalog 에 스키마 자동 등록하여 Athena/Presto 에서 바로 쿼리 가능하게 설정</li></ul><h4 id=python-aws-s3--glue--athena>Python, AWS S3 + Glue + Athena)<a hidden class=anchor aria-hidden=true href=#python-aws-s3--glue--athena>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span><span class=lnt id=hl-7-12><a class=lnlinks href=#hl-7-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># AWS Boto3를 활용한 S3 데이터 적재 및 Athena 쿼리 예시</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>boto3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># S3에 데이터 업로드</span>
</span></span><span class=line><span class=cl><span class=n>s3</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>client</span><span class=p>(</span><span class=s1>&#39;s3&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;data.csv&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>s3</span><span class=o>.</span><span class=n>upload_fileobj</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=s1>&#39;my-datalake-bucket&#39;</span><span class=p>,</span> <span class=s1>&#39;raw/data.csv&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Glue 카탈로그 등록 및 Athena 쿼리는 AWS 콘솔 또는 SDK로 실행</span>
</span></span><span class=line><span class=cl><span class=c1># Athena에서 쿼리 예시 (SQL)</span>
</span></span><span class=line><span class=cl><span class=c1># SELECT * FROM my_datalake.raw_data WHERE event_type = &#39;purchase&#39;;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>S3 에 원본 데이터를 적재하고, Glue 카탈로그 및 Athena 를 통해 분석하는 기본적인 Data Lake 활용 예시.</li></ul><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>카테고리</th><th>고려사항</th><th>설명 및 권장사항</th></tr></thead><tbody><tr><td><strong>아키텍처 설계</strong></td><td>계층형 Zone 구조</td><td><code>Raw → Standardized → Curated → Sandbox</code> 단계적 구성으로 가시성 및 관리성 확보</td></tr><tr><td></td><td>파티셔닝 전략</td><td>날짜, 지역 등 기준 분할 → 쿼리 성능 향상 및 스토리지 비용 절감</td></tr><tr><td></td><td>컬럼형 파일 포맷 선택</td><td><code>Parquet</code>, <code>ORC</code>, <code>Delta</code> 등 → 고압축, 빠른 분석 최적화</td></tr><tr><td><strong>운영 관리</strong></td><td>ETL/ELT 파이프라인 표준화</td><td><code>dbt</code>, <code>Spark</code>, <code>Glue</code> 등 사용으로 복잡도 최소화, 코드 재사용성 확보</td></tr><tr><td></td><td>스토리지 라이프사이클</td><td><code>Intelligent Tiering</code>, 자동 아카이빙 → 비용 최적화 전략</td></tr><tr><td></td><td>모니터링 및 가시성 확보</td><td><code>CloudWatch</code>, <code>Grafana</code>, <code>DataDog</code> 기반 대시보드 구축</td></tr><tr><td><strong>데이터 거버넌스</strong></td><td>메타데이터 관리</td><td><code>Apache Atlas</code>, <code>AWS Glue Catalog</code>, <code>DataHub</code> 등으로 메타정보 통합 관리</td></tr><tr><td></td><td>계보 추적 및 품질 검증</td><td><code>데이터 계보</code>(lineage), 품질 룰 검증 자동화 → 신뢰도 확보</td></tr><tr><td><strong>보안 및 규제</strong></td><td>접근 제어 및 감사 로깅</td><td><code>RBAC + ABAC</code> 혼합 정책, <code>CloudTrail</code> 및 <code>KMS</code> 연계</td></tr><tr><td></td><td>데이터 분류 및 민감정보 보호</td><td><code>Data Classification</code>, 암호화 정책 자동 적용 필수</td></tr><tr><td><strong>클라우드 최적화</strong></td><td>클라우드 서비스 연동</td><td><code>IAM</code>, <code>S3</code>, <code>Glue</code>, <code>KMS</code>, <code>Lake Formation</code> 등 클라우드 네이티브 기능 적극 활용</td></tr><tr><td><strong>조직 운영</strong></td><td>팀 역량 및 역할 정의</td><td><code>Data Engineer</code>, <code>Platform Architect</code>, <code>Governance 담당</code> 역할 분리/명확화</td></tr><tr><td></td><td>단계적 확산 전략</td><td><code>PoC → Pilot → Rollout</code> 방식의 점진적 전개로 리스크 최소화</td></tr></tbody></table><h3 id=최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>카테고리</th><th>최적화 항목</th><th>설명</th><th>권장 방안 및 기술 예시</th></tr></thead><tbody><tr><td><strong>스토리지 최적화</strong></td><td>데이터 압축</td><td>저장 공간 절약 및 I/O 최소화를 위한 압축 적용</td><td>Snappy, Zstd, GZIP 등 압축 포맷 사용</td></tr><tr><td></td><td>파티셔닝</td><td>쿼리 범위를 줄여 I/O 및 스캔 최소화</td><td>날짜/지역/사용자 기준 파티셔닝</td></tr><tr><td></td><td>포맷 일관성</td><td>포맷 불일치로 인한 성능 저하 방지</td><td>전사 표준 포맷 정의 (예: Parquet + JSON)</td></tr><tr><td></td><td>라이프사이클 관리</td><td>장기 미사용 데이터에 대한 자동 이전 처리</td><td>S3 Lifecycle, HDFS TTL 적용</td></tr><tr><td><strong>쿼리 성능 최적화</strong></td><td>인덱싱 & 컬럼 프루닝</td><td>필요한 컬럼만 조회하고, 인덱스 기반 필터링으로 쿼리 속도 향상</td><td>Column Pruning, 컬럼 인덱스 적용</td></tr><tr><td></td><td>Z-Ordering</td><td>자주 필터링하는 컬럼 기준으로 물리적 정렬하여 스캔 효율화</td><td>Delta Lake Z-Ordering 적용</td></tr><tr><td></td><td>캐싱</td><td>반복 쿼리나 공통 쿼리에 대해 결과를 캐싱하여 응답 시간 개선</td><td>Presto/Athena 캐시, Redis 캐시</td></tr><tr><td><strong>처리 성능 및 자원 관리</strong></td><td>엔진 적합성 선택</td><td>워크로드 유형별 최적의 엔진 선택</td><td>Spark (배치), Flink (스트림), Presto (쿼리)</td></tr><tr><td></td><td>증분 처리</td><td>중복 처리 방지 및 비용 절감을 위한 증분 로딩</td><td>Watermark 기반 Incremental Load</td></tr><tr><td></td><td>스케일링 자동화</td><td>처리량 증가에 따라 동적으로 리소스를 확장</td><td>Kubernetes Horizontal Pod Autoscaler</td></tr><tr><td><strong>비용 최적화</strong></td><td>인프라 비용 절감</td><td>처리/저장 리소스의 비용 최적화</td><td>스팟 인스턴스, EC2 Savings Plan</td></tr><tr><td></td><td>저장 비용 관리</td><td>빈도에 따라 스토리지 클래스 변경</td><td>S3 Infrequent Access, Glacier</td></tr><tr><td><strong>데이터 품질</strong></td><td>실시간 품질 모니터링</td><td>데이터의 정확성/정합성을 자동으로 점검</td><td>Great Expectations, Data Quality DAG</td></tr><tr><td></td><td>품질 자동 검증</td><td>정합성 체크, Null/이상치 검사 등 자동화</td><td>ETL 중간 검증, 통계 기반 이상 탐지</td></tr><tr><td><strong>운영 자동화 및 안정성</strong></td><td>파이프라인 자동화</td><td>ETL/ELT/스트리밍 파이프라인을 자동화하여 운영 효율성 증대</td><td>Apache Airflow, Dagster</td></tr><tr><td></td><td>거버넌스 및 정책 적용</td><td>데이터 보안/품질 정책의 자동 적용</td><td>정책 기반 접근 통제, 자동 거버넌스 룰</td></tr><tr><td></td><td>재해 복구 및 백업</td><td>장애 복구 시간 최소화 및 데이터 손실 방지</td><td>다중 리전 백업, RTO/RPO 기준 설정</td></tr></tbody></table><h4 id=z-ordering>Z-Ordering<a hidden class=anchor aria-hidden=true href=#z-ordering>#</a></h4><p><strong>대용량 데이터 쿼리 성능을 획기적으로 개선</strong>하기 위한 <strong>멀티 컬럼 정렬 최적화 기법</strong>이다. 특히 <strong>데이터 레이크 기반의 분석 환경</strong>, 예를 들어 <strong>Databricks Delta Lake, Apache Iceberg</strong>에서 매우 중요한 역할을 한다.</p><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>정의</td><td>다차원 컬럼들을 기반으로 **Z-curve (Morton order)**를 적용하여 데이터를 정렬하는 <strong>멀티 컬럼 정렬 최적화 기법</strong></td></tr><tr><td>목적</td><td>특정 컬럼들에 대한 <strong>필터 조건이 자주 사용되는 쿼리의 I/O 비용을 줄이고</strong>, <strong>데이터 스캔 범위를 최소화</strong></td></tr><tr><td>적용 대상</td><td>주로 <strong>Delta Lake</strong>, <strong>Apache Iceberg</strong>, <strong>ClickHouse</strong> 등의 분석 시스템에서 사용됨</td></tr><tr><td>핵심 개념</td><td>여러 컬럼의 값을 <strong>이진 표현으로 interleave(교차 혼합)</strong> 하여 Z 모양의 순서로 데이터 정렬</td></tr></tbody></table><p><strong>Z-Ordering 동작 원리</strong>:</p><ul><li><p>Z-Ordering 은 다차원 데이터를 **Z-Curve(Morton Curve)**로 재정렬하여, 관련 데이터가 <strong>물리적으로 인접한 블록에 저장</strong>되도록 한다.</p></li><li><p>간단한 시각적 설명<br>예를 들어, 다음과 같은 2 개의 컬럼을 Z-Order 로 정렬하면:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Column A: [010, 110, 001]
</span></span><span class=line><span class=cl>Column B: [100, 011, 110]
</span></span></code></pre></td></tr></table></div></div><p>Z-Order 는 각 값을 비트 단위로 interleave 하여 하나의 값으로 정렬:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Z(A,B): [0 1 1 0 0 0], [1 0 1 1 1 0], … → Z-curve 정렬
</span></span></code></pre></td></tr></table></div></div><p>결과적으로 <code>A, B</code> 에 특정 값을 조건으로 검색할 경우, 해당 데이터가 <strong>물리적으로 근접한 블록에 저장</strong>되어 있어 <strong>스캔 범위 최소화</strong> 가능.</p></li></ul><p><strong>성능 이점 및 실험 사례</strong></p><table><thead><tr><th>실험 항목</th><th>내용</th></tr></thead><tbody><tr><td>성능 비교</td><td>10 억 건 데이터셋에서 특정 컬럼 조건 필터 시, <strong>Z-Ordering 적용 후 쿼리 시간이 최대 60~80% 감소</strong></td></tr><tr><td>I/O 효율</td><td>Z-Ordering 을 적용하면 필터된 데이터만 읽을 수 있어 <strong>스캔되는 파일 수와 크기 대폭 감소</strong></td></tr><tr><td>실사용 사례</td><td>Databricks 기준: <code>OPTIMIZE table ZORDER BY (user_id, event_time)</code> 수행 후, <code>user_id</code> 조건 쿼리가 4 배 이상 빨라짐</td></tr></tbody></table><p><strong>주의사항 및 한계점</strong></p><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>과도한 Z-Ordering 사용</td><td>너무 많은 컬럼에 대해 Z-Ordering 시, 오히려 정렬 효과가 떨어질 수 있음 (3~5 개 컬럼 이하 권장)</td></tr><tr><td>비용</td><td>Z-Ordering 은 전체 파일을 재정렬하고 재작성하므로 <strong>배치 실행 비용이 높음</strong></td></tr><tr><td>데이터 추가 시 재정렬 필요</td><td>새로운 데이터가 들어오면 기존 정렬이 깨지므로 <strong>정기적인 <code>OPTIMIZE</code> 가 필요</strong></td></tr><tr><td>비정형 필터에는 효과 미미</td><td>Full Scan 성격의 쿼리나 <code>LIKE</code>, <code>REGEXP</code> 기반 쿼리에는 효과 없음</td></tr></tbody></table><h3 id=주제와-관련하여-주목할-내용>주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#주제와-관련하여-주목할-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>세부 주제</th><th>기술/도구</th><th>주요 설명 및 특징</th></tr></thead><tbody><tr><td><strong>아키텍처 특성</strong></td><td>스키마 온 리드</td><td>-</td><td>저장 시 스키마 미정, 읽을 때 해석 → 유연성/비정형 데이터 수용</td></tr><tr><td></td><td>오브젝트 스토리지</td><td>S3, ADLS, GCS</td><td>저비용, 무제한 확장성, 파일 기반 구조에 최적화</td></tr><tr><td><strong>데이터 처리 엔진</strong></td><td>배치 처리</td><td>Apache Spark</td><td>대규모 병렬 처리, ML 지원 포함</td></tr><tr><td></td><td>스트림 처리</td><td>Apache Flink, Kafka</td><td>실시간/무한 스트림 처리, 이벤트 기반 분석 가능</td></tr><tr><td><strong>파일 포맷</strong></td><td>컬럼형 저장</td><td>Apache Parquet</td><td>압축률 우수, 쿼리 성능 향상</td></tr><tr><td></td><td>스키마 진화</td><td>Apache Avro</td><td>동적 스키마 변경, 백워드 호환 지원</td></tr><tr><td><strong>메타데이터 및 거버넌스</strong></td><td>메타데이터 관리</td><td>Apache Atlas, Glue Catalog</td><td>데이터 계보, 검색, 품질 통제</td></tr><tr><td></td><td>보안 및 권한 관리</td><td>Apache Ranger</td><td>사용자별 접근 제어 및 감사 로깅</td></tr><tr><td><strong>레이크하우스 통합</strong></td><td>ACID 지원 스토리지</td><td>Delta Lake, Iceberg, Hudi</td><td>트랜잭션 처리, 시간여행, Merge 지원</td></tr><tr><td><strong>클라우드 서비스</strong></td><td>AWS</td><td>Lake Formation</td><td>IAM 통합, 자동 데이터 카탈로그</td></tr><tr><td></td><td>Azure</td><td>Data Lake Storage Gen2</td><td>하둡 호환 + RBAC 통합 지원</td></tr><tr><td></td><td>GCP</td><td>BigQuery</td><td>서버리스 분석 플랫폼, ELT 통합</td></tr><tr><td><strong>워크로드 유형</strong></td><td>다양한 분석 지원</td><td>BI, ML, 실시간 쿼리 등</td><td>유연한 데이터 활용: 정형/비정형/반정형 모두 가능</td></tr><tr><td><strong>기술 트렌드</strong></td><td>스트리밍 데이터레이크</td><td>Kafka + Iceberg</td><td>실시간 수집과 히스토리 동시 저장 (Hybrid Architecture)</td></tr></tbody></table><h3 id=반드시-학습해야할-내용>반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야할-내용>#</a></h3><table><thead><tr><th>대분류</th><th>중분류</th><th>세부 항목</th><th>설명 및 학습 포인트</th></tr></thead><tbody><tr><td><strong>1. 데이터 아키텍처</strong></td><td>개념 비교</td><td>Schema-on-Read vs Schema-on-Write</td><td>저장 vs 조회 시점의 스키마 적용 전략. 유연성 vs 정합성 트레이드오프 분석</td></tr><tr><td></td><td>아키텍처 비교</td><td>Data Lake vs Warehouse vs Lakehouse</td><td>구조적 차이점, 사용 목적, 성능/정합성/비용 관점 비교</td></tr><tr><td><strong>2. 스토리지 기술</strong></td><td>스토리지 유형</td><td>Object Storage vs Block Storage</td><td>S3/HDFS vs EBS 등의 차이점, 데이터 레이크 적합성 분석</td></tr><tr><td></td><td>저장 최적화</td><td>Partitioning & Indexing</td><td>파일 분할 및 색인을 통한 스캔 범위 최소화, 성능 향상 전략</td></tr><tr><td><strong>3. 데이터 처리 기술</strong></td><td>배치 처리</td><td>Apache Spark Fundamentals</td><td>대용량 데이터 병렬 처리의 핵심, RDD/DataFrame 차이 학습</td></tr><tr><td></td><td>실시간 처리</td><td>Kafka 기반 Stream Processing</td><td>스트리밍 아키텍처, 이벤트 기반 처리 흐름 구성 방법</td></tr><tr><td><strong>4. 파일 포맷</strong></td><td>컬럼 기반 포맷</td><td>Parquet, ORC, Avro</td><td>압축률, 쿼리 성능 최적화 관점에서의 포맷 비교</td></tr><tr><td><strong>5. 분석 엔진</strong></td><td>쿼리 및 분석 도구</td><td>Presto, Trino, Athena, Spark SQL</td><td>Object Storage 직접 분석 가능 도구 비교 (속도, 비용, 유연성)</td></tr><tr><td><strong>6. 거버넌스 및 카탈로그</strong></td><td>메타데이터 관리</td><td>Glue, Hive Metastore, Apache Atlas</td><td>메타데이터 수집, 분류, 계보 추적 자동화 기술</td></tr><tr><td></td><td>데이터 품질 관리</td><td>Data Quality Framework</td><td>Null 검사, 범위 제한, 중복 제거 등 품질 기준 정의</td></tr><tr><td></td><td>데이터 계보 추적</td><td>Data Lineage</td><td>데이터 흐름 추적, 규제 대응, 품질 이슈 분석 도구</td></tr><tr><td><strong>7. 보안 및 접근 제어</strong></td><td>접근 제어 모델</td><td>RBAC, ABAC</td><td>사용자 역할 및 속성 기반 접근 통제 전략</td></tr><tr><td></td><td>민감 정보 보호</td><td>Data Masking, Encryption at Rest</td><td>개인정보 보호 및 규제 준수를 위한 기술 구현</td></tr><tr><td><strong>8. 클라우드 환경</strong></td><td>AWS 기반 서비스</td><td>S3, EMR, Glue, Athena</td><td>AWS 기반 전체 파이프라인 구성 흐름</td></tr><tr><td></td><td>Azure 기반 서비스</td><td>Azure Data Lake Storage, Databricks, Synapse</td><td>MS 생태계 기반 레이크 구성 요소</td></tr><tr><td><strong>9. 운영 및 모니터링</strong></td><td>운영 모니터링</td><td>Observability, Logging, Alerting</td><td>데이터 레이크 파이프라인 운영 감시 및 경고 시스템 구성</td></tr><tr><td></td><td>자동화 및 배포</td><td>IaC (Terraform), GitOps, Airflow</td><td>인프라 자동화, 배치/스케줄링 워크플로우 구성 전략</td></tr><tr><td><strong>10. 기타 필수 역량</strong></td><td>표준화 및 거버넌스 프레임워크</td><td>Data Governance Principles, FAIR</td><td>데이터 접근성, 품질, 재사용성 보장 위한 조직적 원칙</td></tr><tr><td></td><td>성능 벤치마크</td><td>TPC-DS, TPC-H 테스트 분석</td><td>포맷, 엔진, 인프라 성능 비교 기준 이해</td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>정의 및 설명</th><th>Data Lake 내 역할 및 의의</th></tr></thead><tbody><tr><td><strong>스토리지</strong></td><td>Object Storage</td><td>파일, 이미지, 로그 등 비정형 대용량 데이터를 객체 단위로 저장하는 구조 (예: AWS S3, Azure Blob)</td><td>확장성과 내구성이 뛰어나며, Data Lake 의 기반 스토리지 시스템</td></tr><tr><td></td><td>Partitioning</td><td>데이터를 날짜, 지역, 카테고리 등 기준으로 분할 저장하는 기법</td><td>쿼리 성능 향상, 스캔 범위 최소화, 비용 절감</td></tr><tr><td><strong>아키텍처 및 기술</strong></td><td>Schema-on-Read</td><td>저장 시 스키마를 적용하지 않고, 조회 시점에 스키마를 적용하는 유연한 접근 방식</td><td>다양한 구조의 데이터를 유연하게 수용 가능, 반정형/비정형 데이터 분석에 적합</td></tr><tr><td></td><td>Schema-on-Write</td><td>저장 시 스키마를 강제 적용하여 데이터의 정합성을 보장하는 방식</td><td>강한 정형성 요구되는 시스템에서 활용, 데이터 품질 보장</td></tr><tr><td></td><td>Multi-tenancy</td><td>하나의 시스템 자원을 다수의 사용자 (조직) 가 공유하여 사용하는 클라우드 아키텍처</td><td>플랫폼형 서비스에서 리소스 효율성과 격리성 보장</td></tr><tr><td><strong>데이터 처리</strong></td><td>ETL / ELT</td><td>ETL: 추출 → 변환 → 적재 / ELT: 추출 → 적재 → 변환 방식으로 데이터 파이프라인 구성</td><td>데이터 정제 및 통합, 분석 목적에 따라 적절한 처리 방식 선택 필요</td></tr><tr><td></td><td>CDC (Change Data Capture)</td><td>DB 변경사항을 실시간 추적하여 데이터 흐름에 반영하는 기술</td><td>실시간 동기화 및 스트리밍 ETL 에 필수 요소</td></tr><tr><td><strong>분석 및 쿼리 엔진</strong></td><td>Presto / Athena</td><td>오브젝트 스토리지 상의 데이터를 직접 SQL 쿼리로 분석할 수 있는 서버리스 엔진</td><td>ETL 없이 빠른 분석, 분석 비용 절감 및 셀프서비스 BI 가능</td></tr><tr><td></td><td>Parquet / ORC</td><td>열 기반 저장 포맷으로, 압축률과 쿼리 성능에 최적화됨</td><td>대규모 데이터 분석 시 스캔 효율성 및 저장 공간 최적화</td></tr><tr><td><strong>거버넌스 및 보안</strong></td><td>Data Catalog</td><td>데이터셋의 메타데이터, 계보, 품질, 위치, 사용 이력 등을 관리하고 탐색할 수 있는 시스템</td><td>데이터 탐색성, 거버넌스, 데이터 거버넌스 체계의 핵심 축</td></tr><tr><td></td><td>Data Lineage</td><td>데이터의 출처와 처리 과정을 추적할 수 있는 기능</td><td>신뢰도 확보, 규제 대응, 품질 이슈 분석 가능</td></tr><tr><td></td><td>Data Stewardship</td><td>데이터의 품질, 사용 규칙, 정책 등을 지속적으로 관리하는 책임자 역할</td><td>조직 내 데이터 관리 책임 명확화, 데이터 품질 확보</td></tr><tr><td></td><td>RBAC</td><td>역할 기반 접근 제어로, 사용자 역할에 따라 데이터 접근을 통제</td><td>거버넌스 강화 및 권한 분리</td></tr><tr><td></td><td>ABAC</td><td>속성 기반 접근 제어로, 사용자와 자원의 속성을 기준으로 세밀하게 접근 통제</td><td>정교한 정책 적용, 민감 데이터 보호 강화</td></tr><tr><td><strong>데이터 무결성</strong></td><td>ACID</td><td>트랜잭션의 원자성, 일관성, 고립성, 지속성을 보장하는 데이터 처리 특성</td><td>Delta Lake, Iceberg 등 Lakehouse 시스템에서 데이터 정합성 보장 요소로 사용</td></tr></tbody></table><ul><li><strong>스토리지</strong>: Data Lake 의 핵심 인프라 계층이며, 비용 효율성과 확장성을 갖춘 구조가 필수.</li><li><strong>아키텍처 및 기술</strong>: 데이터 구조와 사용 방식을 결정하는 핵심 전략이며, " 유연성 vs 정합성 " 트레이드오프가 존재.</li><li><strong>데이터 처리</strong>: 데이터의 흐름과 전환을 제어하는 영역이며, 실시간성과 정확성 요구에 따라 기술이 달라짐.</li><li><strong>분석 및 쿼리 엔진</strong>: 정형화된 DB 없이도 쿼리 가능하게 해주는 중요한 분석 구성 요소.</li><li><strong>거버넌스 및 보안</strong>: 메타데이터, 감사 추적, 보안 관리 측면에서 필수적인 제어 요소.</li><li><strong>데이터 무결성</strong>: Lakehouse 도입 시 필수적으로 등장하는 요구 사항으로, ACID 기반 기술이 보강됨.</li></ul><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://www.acceldata.io/blog/data-lake-architecture-beginners-guide-to-key-concepts>Acceldata – Data Lake Architecture Guide</a></li><li><a href=https://learn.microsoft.com/en-us/azure/architecture/data-guide/scenarios/data-lake>Microsoft Azure – Data Lake Architecture</a></li><li><a href=https://databricks.com/glossary/data-lake>Databricks – What is a Data Lake</a></li><li><a href=https://aws.amazon.com/big-data/datalakes-and-analytics/what-is-a-data-lake/>AWS – Data Lake Foundation</a></li><li><a href=https://estuary.dev/blog/data-lake-architecture/>Estuary – Data Lake Architecture Components</a></li><li><a href=https://www.mdpi.com/2073-431X/13/7/183>MDPI – Data Lakes: A Survey of Concepts and Architectures</a></li><li><a href=https://cloudian.com/guides/data-lake/data-lake-security-challenges-and-6-critical-best-practices/>Cloudian – Data Lake Security Best Practices</a></li><li><a href=https://www.montecarlodata.com/blog-top-data-lake-vendors/>Monte Carlo – Top Data Lake Vendors 2025</a></li><li><a href=https://www.dataversity.net/data-lake-strategy-its-benefits-challenges-and-implementation/>DATAVERSITY – Data Lake Strategy Implementation</a></li><li><a href=https://www.qubole.com/blog/2024-data-lake-trends-and-best-practices/>Qubole – Data Lake Trends and Best Practices</a></li><li><a href=https://www.snowflake.com/en/data-cloud/unistore/>Snowflake Unistore 소개</a></li></ul><hr></div></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>