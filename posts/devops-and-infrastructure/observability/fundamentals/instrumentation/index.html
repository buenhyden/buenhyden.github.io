<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Instrumentation | hyunyoun's Blog</title>
<meta name=keywords content="DevOps-and-Infrastructure,Observability,Fundamentals,Telemetry,Instrumentation"><meta name=description content="애플리케이션 코드에 특정 로직을 추가하여 메트릭, 로그, 트레이스와 같은 데이터를 수집하고 분석할 수 있도록 만드는 과정이다"><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/devops-and-infrastructure/observability/fundamentals/instrumentation/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/devops-and-infrastructure/observability/fundamentals/instrumentation/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/devops-and-infrastructure/observability/fundamentals/instrumentation/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/devops-and-infrastructure/observability/fundamentals/instrumentation/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Instrumentation"><meta property="og:description" content="애플리케이션 코드에 특정 로직을 추가하여 메트릭, 로그, 트레이스와 같은 데이터를 수집하고 분석할 수 있도록 만드는 과정이다"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Instrumentation"><meta name=twitter:description content="애플리케이션 코드에 특정 로직을 추가하여 메트릭, 로그, 트레이스와 같은 데이터를 수집하고 분석할 수 있도록 만드는 과정이다"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Instrumentation","item":"https://buenhyden.github.io/posts/devops-and-infrastructure/observability/fundamentals/instrumentation/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a></div><h1>Instrumentation</h1><div class=post-description>애플리케이션 코드에 특정 로직을 추가하여 메트릭, 로그, 트레이스와 같은 데이터를 수집하고 분석할 수 있도록 만드는 과정이다</div></header><div class=post-content><h2 id=instrumentation>Instrumentation<a hidden class=anchor aria-hidden=true href=#instrumentation>#</a></h2><p>**Instrumentation(계측)**은 애플리케이션 코드에 특정 로직을 추가하여 <strong>메트릭, 로그, 트레이스</strong>와 같은 데이터를 수집하고 분석할 수 있도록 만드는 과정이다. 이를 통해 애플리케이션의 성능, 동작, 문제점을 실시간으로 모니터링하고 최적화할 수 있다. Instrumentation은 **Observability(관측 가능성)**의 핵심 요소로, 시스템의 내부 상태를 이해하고 문제를 해결하는 데 필수적이다.</p><h3 id=인스트루멘테이션의-기본-개념>인스트루멘테이션의 기본 개념<a hidden class=anchor aria-hidden=true href=#인스트루멘테이션의-기본-개념>#</a></h3><p>인스트루멘테이션(Instrumentation)은 애플리케이션에 코드나 도구를 삽입하여 핵심 메트릭, 로그, 트레이스 등을 수집하는 과정을 의미합니다. 이는 마치 자동차에 속도계, 연료 게이지, 엔진 온도계 등의 계측 장치를 장착하는 것과 유사합니다. 이러한 계측 도구들은 자동차의 상태를 실시간으로 모니터링하고 문제가 발생했을 때 진단하는 데 도움을 주는 것처럼, 소프트웨어 인스트루멘테이션은 애플리케이션의 상태와 성능을 모니터링하고 문제를 진단하는 데 도움을 줍니다.</p><p>인스트루멘테이션의 주요 목적은 다음과 같다:</p><ol><li><strong>모니터링</strong>: 애플리케이션의 상태와 성능을 실시간으로 추적</li><li><strong>문제 해결</strong>: 오류 발생 시 원인 파악 및 디버깅 지원</li><li><strong>성능 최적화</strong>: 병목 현상이나 비효율적인 코드 식별</li><li><strong>사용자 행동 이해</strong>: 애플리케이션 사용 패턴 파악</li><li><strong>비즈니스 인사이트 제공</strong>: 기술적 메트릭과 비즈니스 성과 연결</li></ol><p>Instrumentation은 주로 <strong>Application Performance Monitoring(APM)</strong> 도구와 함께 사용되며, 수집된 데이터를 기반으로 시스템 상태를 시각화하거나 알림을 설정한다.</p><h3 id=인스트루멘테이션의-유형>인스트루멘테이션의 유형<a hidden class=anchor aria-hidden=true href=#인스트루멘테이션의-유형>#</a></h3><h4 id=코드-기반-인스트루멘테이션>코드 기반 인스트루멘테이션<a hidden class=anchor aria-hidden=true href=#코드-기반-인스트루멘테이션>#</a></h4><p>개발자가 직접 애플리케이션 코드에 모니터링 코드를 삽입한다.</p><h5 id=수동-인스트루멘테이션>수동 인스트루멘테이션<a hidden class=anchor aria-hidden=true href=#수동-인스트루멘테이션>#</a></h5><p>개발자가 명시적으로 코드에 모니터링 로직을 추가한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21>21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22>22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23>23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24>24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25>25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26>26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27>27</a>
</span><span class=lnt id=hl-0-28><a class=lnlinks href=#hl-0-28>28</a>
</span><span class=lnt id=hl-0-29><a class=lnlinks href=#hl-0-29>29</a>
</span><span class=lnt id=hl-0-30><a class=lnlinks href=#hl-0-30>30</a>
</span><span class=lnt id=hl-0-31><a class=lnlinks href=#hl-0-31>31</a>
</span><span class=lnt id=hl-0-32><a class=lnlinks href=#hl-0-32>32</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python에서의 수동 인스트루멘테이션 예시</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>process_order</span><span class=p>(</span><span class=n>order_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>  <span class=c1># 시작 시간 기록</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;주문 처리 시작: </span><span class=si>{</span><span class=n>order_data</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 주문 처리 로직</span>
</span></span><span class=line><span class=cl>        <span class=n>validate_order</span><span class=p>(</span><span class=n>order_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>payment_result</span> <span class=o>=</span> <span class=n>process_payment</span><span class=p>(</span><span class=n>order_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>update_inventory</span><span class=p>(</span><span class=n>order_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>send_confirmation</span><span class=p>(</span><span class=n>order_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 성공 메트릭 기록</span>
</span></span><span class=line><span class=cl>        <span class=n>ORDERS_PROCESSED</span><span class=o>.</span><span class=n>inc</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;주문 처리 완료: </span><span class=si>{</span><span class=n>order_data</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 실패 메트릭 기록</span>
</span></span><span class=line><span class=cl>        <span class=n>ORDERS_FAILED</span><span class=o>.</span><span class=n>inc</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;주문 처리 실패: </span><span class=si>{</span><span class=n>order_data</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> - </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span>
</span></span><span class=line><span class=cl>    <span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 처리 시간 기록</span>
</span></span><span class=line><span class=cl>        <span class=n>processing_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl>        <span class=n>ORDER_PROCESSING_TIME</span><span class=o>.</span><span class=n>observe</span><span class=p>(</span><span class=n>processing_time</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;주문 처리 시간: </span><span class=si>{</span><span class=n>processing_time</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>초&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=자동-인스트루멘테이션>자동 인스트루멘테이션<a hidden class=anchor aria-hidden=true href=#자동-인스트루멘테이션>#</a></h5><p>라이브러리나 프레임워크가 자동으로 코드에 모니터링 기능을 추가한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16>16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17>17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Flask 애플리케이션의 자동 인스트루멘테이션 예시 (OpenTelemetry 사용)</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.instrumentation.flask</span> <span class=kn>import</span> <span class=n>FlaskInstrumentor</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.instrumentation.requests</span> <span class=kn>import</span> <span class=n>RequestsInstrumentor</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Flask 애플리케이션 자동 계측</span>
</span></span><span class=line><span class=cl><span class=n>FlaskInstrumentor</span><span class=p>()</span><span class=o>.</span><span class=n>instrument_app</span><span class=p>(</span><span class=n>app</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># requests 라이브러리 자동 계측</span>
</span></span><span class=line><span class=cl><span class=n>RequestsInstrumentor</span><span class=p>()</span><span class=o>.</span><span class=n>instrument</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/users&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_users</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 이 함수 내에서 특별한 계측 코드가 없어도</span>
</span></span><span class=line><span class=cl>    <span class=c1># 요청/응답 시간, 상태 코드 등이 자동으로 기록됨</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>fetch_users_from_database</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=도구-기반-인스트루멘테이션>도구 기반 인스트루멘테이션<a hidden class=anchor aria-hidden=true href=#도구-기반-인스트루멘테이션>#</a></h4><p>애플리케이션 외부에서 동작하는 도구를 사용하여 모니터링 데이터를 수집한다.</p><h5 id=에이전트-기반-인스트루멘테이션>에이전트 기반 인스트루멘테이션<a hidden class=anchor aria-hidden=true href=#에이전트-기반-인스트루멘테이션>#</a></h5><p>애플리케이션 서버나 환경에 설치된 에이전트가 데이터를 수집한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Java 애플리케이션에 DataDog 에이전트 연결 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 코드 변경 없이 JVM 옵션으로 에이전트 연결</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// java -javaagent:/path/to/dd-java-agent.jar -Ddd.service.name=my-service -jar myapp.jar</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=런타임-계측>런타임 계측<a hidden class=anchor aria-hidden=true href=#런타임-계측>#</a></h5><p>프로그래밍 언어의 런타임 자체가 제공하는 모니터링 기능을 활용한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16>16</a>
</span><span class=lnt id=hl-3-17><a class=lnlinks href=#hl-3-17>17</a>
</span><span class=lnt id=hl-3-18><a class=lnlinks href=#hl-3-18>18</a>
</span><span class=lnt id=hl-3-19><a class=lnlinks href=#hl-3-19>19</a>
</span><span class=lnt id=hl-3-20><a class=lnlinks href=#hl-3-20>20</a>
</span><span class=lnt id=hl-3-21><a class=lnlinks href=#hl-3-21>21</a>
</span><span class=lnt id=hl-3-22><a class=lnlinks href=#hl-3-22>22</a>
</span><span class=lnt id=hl-3-23><a class=lnlinks href=#hl-3-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Node.js의 내장 성능 API 사용 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=p>{</span> <span class=nx>performance</span><span class=p>,</span> <span class=nx>PerformanceObserver</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;perf_hooks&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 성능 관찰자 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>obs</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>PerformanceObserver</span><span class=p>((</span><span class=nx>items</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>entries</span> <span class=o>=</span> <span class=nx>items</span><span class=p>.</span><span class=nx>getEntries</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kr>const</span> <span class=nx>entry</span> <span class=k>of</span> <span class=nx>entries</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nx>entry</span><span class=p>.</span><span class=nx>name</span><span class=si>}</span><span class=sb>: </span><span class=si>${</span><span class=nx>entry</span><span class=p>.</span><span class=nx>duration</span><span class=si>}</span><span class=sb>ms`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>obs</span><span class=p>.</span><span class=nx>observe</span><span class=p>({</span> <span class=nx>entryTypes</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;measure&#39;</span><span class=p>]</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 성능 측정 시작
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>performance</span><span class=p>.</span><span class=nx>mark</span><span class=p>(</span><span class=s1>&#39;A&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 시간이 걸리는 작업 수행
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>for</span> <span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>1000000</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// CPU 집약적 작업
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 성능 측정 종료 및 측정 생성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>performance</span><span class=p>.</span><span class=nx>mark</span><span class=p>(</span><span class=s1>&#39;B&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>performance</span><span class=p>.</span><span class=nx>measure</span><span class=p>(</span><span class=s1>&#39;A to B&#39;</span><span class=p>,</span> <span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=s1>&#39;B&#39;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=인스트루멘테이션이-수집하는-데이터-유형>인스트루멘테이션이 수집하는 데이터 유형<a hidden class=anchor aria-hidden=true href=#인스트루멘테이션이-수집하는-데이터-유형>#</a></h3><h4 id=메트릭metrics>메트릭(Metrics)<a hidden class=anchor aria-hidden=true href=#메트릭metrics>#</a></h4><p>수치로 표현되는 시스템 및 애플리케이션 성능 데이터이다.</p><p><strong>주요 메트릭 유형:</strong></p><ul><li><strong>카운터(Counter)</strong>: 단조 증가하는 값(예: 처리된 요청 수)</li><li><strong>게이지(Gauge)</strong>: 증가하거나 감소할 수 있는 값(예: 메모리 사용량)</li><li><strong>히스토그램(Histogram)</strong>: 값의 분포 측정(예: 응답 시간 분포)</li><li><strong>요약(Summary)</strong>: 백분위수를 포함한 값의 분포</li></ul><p><strong>일반적인 메트릭:</strong></p><ul><li>요청 수/초</li><li>오류율</li><li>응답 시간(평균, 중앙값, 95번째 백분위수)</li><li>CPU 사용률</li><li>메모리 사용량</li><li>활성 사용자 수</li></ul><h4 id=로그logs>로그(Logs)<a hidden class=anchor aria-hidden=true href=#로그logs>#</a></h4><p>애플리케이션에서 생성된 텍스트 기반 기록이다.</p><p><strong>로그 레벨:</strong></p><ul><li>DEBUG: 상세한 개발자 정보</li><li>INFO: 일반적인 운영 정보</li><li>WARN: 잠재적인 문제 경고</li><li>ERROR: 오류 정보</li><li>FATAL: 심각한 오류 정보</li></ul><p><strong>구조화된 로깅 예시:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;timestamp&#34;</span><span class=p>:</span> <span class=s2>&#34;2023-05-12T15:04:05.123Z&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;level&#34;</span><span class=p>:</span> <span class=s2>&#34;INFO&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;service&#34;</span><span class=p>:</span> <span class=s2>&#34;order-service&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;trace_id&#34;</span><span class=p>:</span> <span class=s2>&#34;abc123&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;message&#34;</span><span class=p>:</span> <span class=s2>&#34;주문 처리 완료&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;order_id&#34;</span><span class=p>:</span> <span class=s2>&#34;ORD-12345&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;processing_time_ms&#34;</span><span class=p>:</span> <span class=mi>237</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;customer_id&#34;</span><span class=p>:</span> <span class=s2>&#34;CUST-789&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=트레이스traces>트레이스(Traces)<a hidden class=anchor aria-hidden=true href=#트레이스traces>#</a></h4><p>분산 시스템에서 요청이 여러 서비스를 통과하는 과정을 추적한다.</p><p><strong>주요 구성 요소:</strong></p><ul><li><strong>트레이스(Trace)</strong>: 전체 요청 흐름</li><li><strong>스팬(Span)</strong>: 트레이스 내의 개별 작업 단위</li><li><strong>스팬 컨텍스트(Span Context)</strong>: 서비스 간 전파되는 메타데이터</li><li><strong>태그(Tags)</strong>: 스팬에 추가된 키-값 메타데이터</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16>16</a>
</span><span class=lnt id=hl-5-17><a class=lnlinks href=#hl-5-17>17</a>
</span><span class=lnt id=hl-5-18><a class=lnlinks href=#hl-5-18>18</a>
</span><span class=lnt id=hl-5-19><a class=lnlinks href=#hl-5-19>19</a>
</span><span class=lnt id=hl-5-20><a class=lnlinks href=#hl-5-20>20</a>
</span><span class=lnt id=hl-5-21><a class=lnlinks href=#hl-5-21>21</a>
</span><span class=lnt id=hl-5-22><a class=lnlinks href=#hl-5-22>22</a>
</span><span class=lnt id=hl-5-23><a class=lnlinks href=#hl-5-23>23</a>
</span><span class=lnt id=hl-5-24><a class=lnlinks href=#hl-5-24>24</a>
</span><span class=lnt id=hl-5-25><a class=lnlinks href=#hl-5-25>25</a>
</span><span class=lnt id=hl-5-26><a class=lnlinks href=#hl-5-26>26</a>
</span><span class=lnt id=hl-5-27><a class=lnlinks href=#hl-5-27>27</a>
</span><span class=lnt id=hl-5-28><a class=lnlinks href=#hl-5-28>28</a>
</span><span class=lnt id=hl-5-29><a class=lnlinks href=#hl-5-29>29</a>
</span><span class=lnt id=hl-5-30><a class=lnlinks href=#hl-5-30>30</a>
</span><span class=lnt id=hl-5-31><a class=lnlinks href=#hl-5-31>31</a>
</span><span class=lnt id=hl-5-32><a class=lnlinks href=#hl-5-32>32</a>
</span><span class=lnt id=hl-5-33><a class=lnlinks href=#hl-5-33>33</a>
</span><span class=lnt id=hl-5-34><a class=lnlinks href=#hl-5-34>34</a>
</span><span class=lnt id=hl-5-35><a class=lnlinks href=#hl-5-35>35</a>
</span><span class=lnt id=hl-5-36><a class=lnlinks href=#hl-5-36>36</a>
</span><span class=lnt id=hl-5-37><a class=lnlinks href=#hl-5-37>37</a>
</span><span class=lnt id=hl-5-38><a class=lnlinks href=#hl-5-38>38</a>
</span><span class=lnt id=hl-5-39><a class=lnlinks href=#hl-5-39>39</a>
</span><span class=lnt id=hl-5-40><a class=lnlinks href=#hl-5-40>40</a>
</span><span class=lnt id=hl-5-41><a class=lnlinks href=#hl-5-41>41</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// OpenTelemetry를 사용한 JavaScript 트레이싱 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=p>{</span> <span class=nx>trace</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;@opentelemetry/api&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>tracer</span> <span class=o>=</span> <span class=nx>trace</span><span class=p>.</span><span class=nx>getTracer</span><span class=p>(</span><span class=s1>&#39;order-service&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>processOrder</span><span class=p>(</span><span class=nx>orderData</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 새 스팬 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>span</span> <span class=o>=</span> <span class=nx>tracer</span><span class=p>.</span><span class=nx>startSpan</span><span class=p>(</span><span class=s1>&#39;process-order&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 스팬에 메타데이터 추가
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>span</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;order.id&#39;</span><span class=p>,</span> <span class=nx>orderData</span><span class=p>.</span><span class=nx>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>span</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;customer.id&#39;</span><span class=p>,</span> <span class=nx>orderData</span><span class=p>.</span><span class=nx>customerId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 중첩된 스팬으로 하위 작업 추적
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>await</span> <span class=nx>tracer</span><span class=p>.</span><span class=nx>startActiveSpan</span><span class=p>(</span><span class=s1>&#39;validate-order&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>validateSpan</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>await</span> <span class=nx>validateOrder</span><span class=p>(</span><span class=nx>orderData</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>validateSpan</span><span class=p>.</span><span class=nx>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>await</span> <span class=nx>tracer</span><span class=p>.</span><span class=nx>startActiveSpan</span><span class=p>(</span><span class=s1>&#39;process-payment&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>paymentSpan</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>processPayment</span><span class=p>(</span><span class=nx>orderData</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>paymentSpan</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;payment.amount&#39;</span><span class=p>,</span> <span class=nx>orderData</span><span class=p>.</span><span class=nx>amount</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>paymentSpan</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;payment.status&#39;</span><span class=p>,</span> <span class=nx>result</span><span class=p>.</span><span class=nx>status</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>paymentSpan</span><span class=p>.</span><span class=nx>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 추가 작업…
</span></span></span><span class=line><span class=cl><span class=c1></span>    
</span></span><span class=line><span class=cl>    <span class=nx>span</span><span class=p>.</span><span class=nx>setStatus</span><span class=p>({</span> <span class=nx>code</span><span class=o>:</span> <span class=nx>SpanStatusCode</span><span class=p>.</span><span class=nx>OK</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>span</span><span class=p>.</span><span class=nx>setStatus</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>code</span><span class=o>:</span> <span class=nx>SpanStatusCode</span><span class=p>.</span><span class=nx>ERROR</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>message</span><span class=o>:</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=nx>span</span><span class=p>.</span><span class=nx>recordException</span><span class=p>(</span><span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>throw</span> <span class=nx>error</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>finally</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 스팬 종료
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>span</span><span class=p>.</span><span class=nx>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=프로파일링-데이터>프로파일링 데이터<a hidden class=anchor aria-hidden=true href=#프로파일링-데이터>#</a></h4><p>애플리케이션의 리소스 사용에 대한 세부 정보를 제공한다.</p><p><strong>프로파일링 유형:</strong></p><ul><li>CPU 프로파일링: 함수별 CPU 사용 시간</li><li>메모리 프로파일링: 객체 할당 및 릴리스 패턴</li><li>I/O 프로파일링: 디스크 및 네트워크 작업</li><li>락(Lock) 프로파일링: 동시성 이슈 탐지</li></ul><h3 id=주요-도구-및-프레임워크>주요 도구 및 프레임워크<a hidden class=anchor aria-hidden=true href=#주요-도구-및-프레임워크>#</a></h3><p>다양한 도구와 프레임워크가 Instrumentation을 지원한다:</p><table><thead><tr><th>도구/프레임워크</th><th>주요 기능</th></tr></thead><tbody><tr><td><strong>OpenTelemetry</strong></td><td>메트릭, 로그, 트레이스를 위한 표준화된 API 및 SDK 제공.</td></tr><tr><td><strong>Prometheus</strong></td><td>메트릭 수집 및 경고 설정 지원. Grafana와 통합 가능.</td></tr><tr><td><strong>Elastic APM</strong></td><td>자동 계측 및 분산 트레이싱 지원. Node.js, Java 등 다양한 언어 지원.</td></tr><tr><td><strong>Jaeger</strong></td><td>분산 트레이싱 전문 도구. OpenTelemetry SDK로 대체되는 추세.</td></tr><tr><td><strong>Splunk Observability</strong></td><td>Kubernetes 환경에서 Zero-code Instrumentation 지원.</td></tr></tbody></table><h4 id=언어별-도구>언어별 도구<a hidden class=anchor aria-hidden=true href=#언어별-도구>#</a></h4><p>각 프로그래밍 언어에는 고유한 인스트루멘테이션 도구가 있다.</p><p><strong>Java:</strong></p><ul><li>Micrometer: 메트릭 수집 파사드</li><li>Java Flight Recorder(JFR): 런타임 분석 도구</li><li>BTrace: 동적 자바 트레이싱 도구</li></ul><p><strong>Python:</strong></p><ul><li>statsd: 메트릭 수집 클라이언트</li><li>logging 모듈: 표준 로깅 라이브러리</li><li>py-spy: 샘플링 프로파일러</li></ul><p><strong>JavaScript/Node.js:</strong></p><ul><li>Pino/Winston: 로깅 라이브러리</li><li>Node.js Inspector: 프로파일링 도구</li><li>clinic.js: 성능 문제 진단 도구</li></ul><h4 id=프레임워크-및-표준>프레임워크 및 표준<a hidden class=anchor aria-hidden=true href=#프레임워크-및-표준>#</a></h4><p>인스트루멘테이션 표준화를 위한 프레임워크이다.</p><p><strong>OpenTelemetry:</strong></p><ul><li>메트릭, 로그, 트레이스를 위한 통합 표준</li><li>벤더 중립적 API 및 SDK</li><li>다양한 백엔드로 데이터 내보내기 지원</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14>14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15>15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16>16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17>17</a>
</span><span class=lnt id=hl-6-18><a class=lnlinks href=#hl-6-18>18</a>
</span><span class=lnt id=hl-6-19><a class=lnlinks href=#hl-6-19>19</a>
</span><span class=lnt id=hl-6-20><a class=lnlinks href=#hl-6-20>20</a>
</span><span class=lnt id=hl-6-21><a class=lnlinks href=#hl-6-21>21</a>
</span><span class=lnt id=hl-6-22><a class=lnlinks href=#hl-6-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># OpenTelemetry를 사용한 Python 메트릭 계측 예시</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry</span> <span class=kn>import</span> <span class=n>metrics</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.sdk.metrics</span> <span class=kn>import</span> <span class=n>MeterProvider</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.sdk.metrics.export</span> <span class=kn>import</span> <span class=n>ConsoleMetricExporter</span><span class=p>,</span> <span class=n>PeriodicExportingMetricReader</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메터 프로바이더 설정</span>
</span></span><span class=line><span class=cl><span class=n>metric_reader</span> <span class=o>=</span> <span class=n>PeriodicExportingMetricReader</span><span class=p>(</span><span class=n>ConsoleMetricExporter</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>provider</span> <span class=o>=</span> <span class=n>MeterProvider</span><span class=p>(</span><span class=n>metric_readers</span><span class=o>=</span><span class=p>[</span><span class=n>metric_reader</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>metrics</span><span class=o>.</span><span class=n>set_meter_provider</span><span class=p>(</span><span class=n>provider</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메터 및 카운터 생성</span>
</span></span><span class=line><span class=cl><span class=n>meter</span> <span class=o>=</span> <span class=n>metrics</span><span class=o>.</span><span class=n>get_meter</span><span class=p>(</span><span class=s2>&#34;my-service&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>request_counter</span> <span class=o>=</span> <span class=n>meter</span><span class=o>.</span><span class=n>create_counter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=o>=</span><span class=s2>&#34;requests&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=o>=</span><span class=s2>&#34;Number of requests&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>unit</span><span class=o>=</span><span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메트릭 기록</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>handle_request</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>request_counter</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=p>{</span><span class=s2>&#34;route&#34;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>path</span><span class=p>,</span> <span class=s2>&#34;method&#34;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=c1># 요청 처리 로직…</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Prometheus:</strong></p><ul><li>시계열 메트릭에 특화된 모니터링 시스템</li><li>풀(Pull) 모델 기반 데이터 수집</li><li>강력한 쿼리 언어(PromQL)</li></ul><p><strong>Application Performance Monitoring(APM) 도구:</strong></p><ul><li>New Relic</li><li>Datadog</li><li>Dynatrace</li><li>Elastic APM</li><li>AppDynamics</li></ul><h3 id=instrumentation의-한계>Instrumentation의 한계<a hidden class=anchor aria-hidden=true href=#instrumentation의-한계>#</a></h3><p>Instrumentation에는 몇 가지 한계가 있다:</p><ul><li><strong>성능 오버헤드</strong>: 과도한 계측은 애플리케이션 성능 저하를 초래할 수 있다.</li><li><strong>데이터 품질 문제</strong>: 잘못된 위치에 계측 로직을 추가하면 불필요한 데이터가 생성될 수 있다.</li><li><strong>실행 범위 제한</strong>: 특정 코드 경로가 실행되지 않으면 해당 경로의 데이터는 수집되지 않는다.</li></ul><h3 id=효과적인-인스트루멘테이션-전략>효과적인 인스트루멘테이션 전략<a hidden class=anchor aria-hidden=true href=#효과적인-인스트루멘테이션-전략>#</a></h3><ol><li><p>적절한 커버리지 수준 선택<br>시스템의 모든 부분을 동일한 수준으로 계측할 필요는 없다.<br><strong>중요도에 따른 계측 수준:</strong></p><ul><li><strong>핵심 비즈니스 로직</strong>: 상세한 트레이싱 및 로깅</li><li><strong>성능 중요 경로</strong>: 상세한 메트릭 및 프로파일링</li><li><strong>외부 서비스 통합</strong>: 요청/응답 데이터 및 시간 기록</li><li><strong>지원 서비스</strong>: 기본적인 상태 및 메트릭</li></ul></li><li><p>의미 있는 이름 지정 규칙<br>일관된 명명 규칙은 데이터 분석과 문제 해결을 용이하게 한다.<br><strong>명명 규칙 예시:</strong></p><ul><li><strong>메트릭</strong>: <code>[서비스명].[기능].[측정값]</code> (예: <code>order_service.payment.duration_ms</code>)</li><li><strong>로그</strong>: 구조화된 형식으로 서비스, 컴포넌트, 컨텍스트 포함</li><li><strong>트레이스</strong>: 의미 있는 스팬 이름 및 일관된 태그 사용</li></ul></li><li><p>컨텍스트 정보 포함<br>단순 수치나 상태뿐만 아니라 관련 컨텍스트 정보를 포함해야 한다.<br><strong>유용한 컨텍스트:</strong></p><ul><li>사용자 ID 또는 세션 ID</li><li>요청 ID 또는 트레이스 ID</li><li>환경 정보(개발, 스테이징, 프로덕션)</li><li>서비스 버전 또는 빌드 ID</li><li>관련 비즈니스 엔티티(주문 ID, 제품 ID 등)</li></ul></li><li><p>비용과 오버헤드 관리<br>인스트루멘테이션은 성능에 영향을 미칠 수 있으므로 균형이 필요한다.<br><strong>오버헤드 관리 전략:</strong></p><ul><li>로깅 수준 조정(프로덕션에서는 DEBUG 로그 최소화)</li><li>샘플링 전략 적용(모든 요청이 아닌 일부만 상세 트레이싱)</li><li>비동기 처리 활용(모니터링 데이터 전송을 별도 스레드에서 처리)</li><li>버퍼링 및 배치 처리(데이터를 모아서 전송)</li></ul></li><li><p>개인 정보 보호 및 보안<br>인스트루멘테이션 데이터에 민감한 정보가 포함되지 않도록 주의해야 한다.<br><strong>데이터 보호 전략:</strong></p><ul><li>PII(개인 식별 정보) 마스킹 또는 제외</li><li>암호, API 키, 토큰 등 민감한 정보 로깅 방지</li><li>접근 제어 및 감사 로깅 구현</li><li>데이터 보존 정책 설정</li></ul></li></ol><h3 id=실제-사용-사례>실제 사용 사례<a hidden class=anchor aria-hidden=true href=#실제-사용-사례>#</a></h3><ol><li>성능 병목 현상 식별<br>인스트루멘테이션 데이터를 통해 시스템의 병목 현상을 파악할 수 있다.<br><strong>접근 방식:</strong><ol><li>높은 지연 시간 발견 → 트레이스로 문제 지점 식별</li><li>세부 메트릭 분석 → 특정 조건에서 발생하는지 확인</li><li>프로파일링 데이터 수집 → 코드 레벨에서 원인 파악</li><li>개선 후 A/B 테스트로 효과 검증</li></ol></li><li>오류 탐지 및 디버깅<br>실시간으로 오류를 탐지하고 근본 원인을 파악한다.<br><strong>워크플로우:</strong><ol><li>오류 메트릭 증가 감지 → 알림 발생</li><li>로그에서 오류 메시지 및 스택 트레이스 확인</li><li>트레이스 데이터로 오류 발생 경로 추적</li><li>관련 환경 및 컨텍스트 변수 분석</li><li>임시 해결책 적용 및 모니터링</li></ol></li><li>용량 계획 및 확장<br>인스트루멘테이션 데이터를 통해 시스템의 리소스 요구 사항을 예측한다.<br><strong>활용 방법:</strong><ol><li>리소스 사용 패턴 분석 → 일일/주간/월간 트렌드 확인</li><li>사용자 활동과 리소스 사용의 상관관계 파악</li><li>예측 모델 개발 → 미래 수요 예측</li><li>오토스케일링 정책 최적화</li></ol></li><li>사용자 경험 모니터링<br>백엔드 성능이 실제 사용자 경험에 미치는 영향을 측정한다.<br><strong>측정 방법:</strong><ol><li>엔드투엔드 트레이싱 → 프론트엔드부터 백엔드까지 요청 흐름 추적</li><li>사용자 여정 맵핑 → 주요 사용자 경로의 성능 분석</li><li>사용자 세션 재생 → 문제 발생 세션의 상세 분석</li><li>비즈니스 메트릭과 기술 메트릭 연계 → 성능이 전환율에 미치는 영향 파악</li></ol></li></ol><h3 id=인스트루멘테이션-구현-모범-사례>인스트루멘테이션 구현 모범 사례<a hidden class=anchor aria-hidden=true href=#인스트루멘테이션-구현-모범-사례>#</a></h3><ol><li><p>점진적 접근<br>한 번에 모든 것을 계측하려 하지 말고, 중요한 부분부터 시작하여 점차 확장한다.<br><strong>구현 단계:</strong></p><ol><li>핵심 비즈니스 서비스 및 API 인스트루멘테이션</li><li>주요 외부 서비스 통합 지점 계측</li><li>성능 중요 경로 상세 계측</li><li>보조 서비스 및 배치 작업 계측</li></ol></li><li><p>오픈 표준 활용<br>벤더 종속성을 방지하고 미래 호환성을 보장하기 위해 오픈 표준을 사용한다.<br><strong>권장 표준:</strong></p><ul><li>OpenTelemetry: 메트릭, 로그, 트레이스를 위한 통합 표준</li><li>Prometheus 메트릭 형식: 널리 지원되는 메트릭 형식</li><li>구조화된 JSON 로깅: 다양한 도구와 호환</li></ul></li><li><p>자동화 및 통합<br>인스트루멘테이션을 CI/CD 파이프라인 및 개발 워크플로우에 통합한다.<br><strong>자동화 전략:</strong></p><ul><li>코드 템플릿 및 라이브러리 제공</li><li>정적 분석으로 인스트루멘테이션 검증</li><li>테스트 환경에서 계측 유효성 확인</li><li>인스트루멘테이션 데이터 품질 모니터링</li></ul></li><li><p>팀 문화 및 교육<br>인스트루멘테이션은 기술적인 문제만이 아닌 조직적 접근이 필요한다.<br><strong>문화적 요소:</strong></p><ul><li>개발자 교육 및 가이드라인 제공</li><li>인스트루멘테이션 품질을 코드 리뷰 과정에 포함</li><li>데이터 기반 결정을 장려하는 문화 조성</li><li>모니터링 대시보드 및 알림을 모든 팀원이 접근 가능하게 설정</li></ul></li></ol><h3 id=최신-트렌드-및-발전>최신 트렌드 및 발전<a hidden class=anchor aria-hidden=true href=#최신-트렌드-및-발전>#</a></h3><ol><li><p>eBPF 기반 인스트루멘테이션<br>커널 수준에서 낮은 오버헤드로 데이터를 수집하는 기술이다.<br><strong>장점:</strong></p><ul><li>애플리케이션 코드 수정 없이 관찰 가능</li><li>매우 낮은 오버헤드</li><li>커널 및 시스템 수준의 상세한 인사이트</li><li>네트워크 흐름, 시스템 호출, 파일 I/O 등 모니터링</li></ul></li><li><p>AI 기반 인스트루멘테이션 분석<br>인스트루멘테이션 데이터에 AI/ML을 적용하여 인사이트를 도출한다.<br><strong>응용 분야:</strong></p><ul><li>이상 탐지: 비정상적인 패턴 자동 식별</li><li>근본 원인 분석: 문제의 원인을 자동으로 추론</li><li>예측적 알림: 문제가 발생하기 전에 예측</li><li>자동 최적화: 성능 파라미터 자동 조정</li></ul></li><li><p>OpenTelemetry의 성장<br>업계 표준으로 자리잡고 있는 OpenTelemetry의 발전이다.<br><strong>주요 발전:</strong></p><ul><li>로그, 메트릭, 트레이스의 완전한 통합</li><li>더 많은 언어 및 프레임워크 지원</li><li>향상된 자동 계측 기능</li><li>엔터프라이즈급 기능 추가</li></ul></li><li><p>옵저버빌리티 메시(Observability Mesh)<br>분산 시스템을 위한 확장 가능한 인스트루멘테이션 아키텍처이다.<br><strong>특징:</strong></p><ul><li>서비스 메시와 통합된 인스트루멘테이션</li><li>데이터 수집 및 처리의 분산화</li><li>조직 구조에 맞는 관찰성 도메인 정의</li><li>글로벌 및 로컬 컨텍스트 결합</li></ul></li></ol><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>