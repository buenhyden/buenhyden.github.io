<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Retry Pattern | hyunyoun's Blog</title><meta name=keywords content="System-and-Software-Architecture,Software-Architecture-Patterns,Retry-Patterns"><meta name=description content="분산 시스템이나 마이크로서비스 아키텍처에서 일시적인 오류(Transient Failure)를 처리하기 위한 핵심 설계 패턴이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/system-architecture--design/distributed-systems/reliability--resilience/recovery-patterns/retry/retry-pattern/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/system-architecture--design/distributed-systems/reliability--resilience/recovery-patterns/retry/retry-pattern/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/system-architecture--design/distributed-systems/reliability--resilience/recovery-patterns/retry/retry-pattern/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Retry Pattern"><meta property="og:description" content="분산 시스템이나 마이크로서비스 아키텍처에서 일시적인 오류(Transient Failure)를 처리하기 위한 핵심 설계 패턴이다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-27T11:31:00+00:00"><meta property="article:modified_time" content="2024-09-27T11:31:00+00:00"><meta property="article:tag" content="System-and-Software-Architecture"><meta property="article:tag" content="Software-Architecture-Patterns"><meta property="article:tag" content="Retry-Patterns"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Retry Pattern"><meta name=twitter:description content="분산 시스템이나 마이크로서비스 아키텍처에서 일시적인 오류(Transient Failure)를 처리하기 위한 핵심 설계 패턴이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HY's Blog","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":7,"name":"Retry Pattern","item":"https://buenhyden.github.io/posts/system-architecture--design/distributed-systems/reliability--resilience/recovery-patterns/retry/retry-pattern/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Retry Pattern","name":"Retry Pattern","description":"분산 시스템이나 마이크로서비스 아키텍처에서 일시적인 오류(Transient Failure)를 처리하기 위한 핵심 설계 패턴이다.","keywords":["System-and-Software-Architecture","Software-Architecture-Patterns","Retry-Patterns"],"articleBody":"Retry Pattern Retry Pattern은 분산 시스템이나 마이크로서비스 아키텍처에서 일시적인 오류(Transient Failure)를 처리하기 위한 핵심 설계 패턴이다.\n네트워크 불안정, 일시적인 서비스 중단 등 일시적인 실패 상황에서 시스템의 복원력(Resilience)을 강화하는 데 목적을 둔다.\n이 패턴은 분산 시스템의 안정성을 높이는 필수 도구이지만, 남용할 경우 역효과를 낼 수 있으므로 신중한 정책 수립이 필요하다.\nRetry Pattern의 핵심 개념 작동 원리\n실패한 작업 자동 재시도: API 호출, 데이터베이스 접근 등 실패 가능성이 있는 작업을 정의된 정책에 따라 재시도한다. 일시적 오류 감지: 네트워크 타임아웃, HTTP 5xx 에러, 데이터베이스 연결 실패 등 일시적인 오류만 대상으로 한다. 주요 구성 요소\n구성 요소 설명 예시 재시도 정책 (Retry Policy) 어떤 오류를 재시도할지 결정 HTTP 503(서비스 불가), SocketException 재시도 간격 (Retry Delay) 재시도 사이의 대기 시간 고정 간격, 지수 백오프(Exponential Backoff) 최대 재시도 횟수 재시도 최대 허용 횟수 기본 3회, 시스템 특성에 따라 조정 폴백 메커니즘 (Fallback) 최종 실패 시 대체 동작 캐시 데이터 반환, 오류 로깅 구현 전략과 사례 지수 백오프 전략\n점진적 대기 시간 증가: 첫 재시도는 1초, 두 번째는 2초, 세 번째는 4초와 같이 대기 시간을 지수적으로 증가시켜 과부하 방지.\n예시 코드 (의사 코드):\n1 2 3 4 5 6 7 8 9 10 11 def retry_operation(): max_retries = 3 base_delay = 1 # 초 단위 for attempt in range(max_retries): try: return perform_operation() except TransientError: if attempt == max_retries - 1: raise delay = base_delay * (2 ** attempt) sleep(delay) 라이브러리 활용\nSpring Retry (Java): @Retryable 어노테이션으로 간편한 재시도 로직 구현:\n1 2 3 4 @Retryable(maxAttempts=3, backoff=@Backoff(delay=1000)) public void callExternalService() { // 외부 서비스 호출 } Polly (.NET): 복합적인 재시도 정책과 서킷 브레이커 패턴 통합 지원.\n고려 사항과 주의점 Idempotency(멱등성) 보장\n동일 요청의 안전성: 재시도로 인해 중복 처리되지 않도록 POST 요청보다는 GET/PUT/DELETE 등 멱등성 메서드 사용 권장. 예시: 결제 시스템에서 중복 재시도 시 트랜잭션 ID 검증 필수. 부작용 관리\n시스템 과부하 방지: 무분별한 재시도는 서비스 장애 연쇄 반응(Cascading Failure) 유발 가능. 재시도 횟수와 간격을 엄격히 제한. 다른 패턴과의 조합\n서킷 브레이커 패턴: 지속적 실패 시 재시도를 중단하고 장애 전파 차단. 헤징 패턴: 동시에 여러 서비스에 요청을 보내 가장 빠른 응답 선택. 적용 시나리오와 사례 적합한 사례\n클라우드 서비스 간 통신: AWS, Azure에서 발생하는 일시적인 API 오류. 데이터베이스 장애 복구: DB 연결 일시 중단 후 자동 복구. 비적합한 사례\n영구적 오류: 잘못된 요청 파라미터(HTTP 400) 또는 권한 오류(HTTP 403)는 재시도해도 해결되지 않음. 구현 예시 HTTP 클라이언트에서의 재시도:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 class HttpClientWithRetry: def __init__(self): self.retry_strategy = ExponentialBackoffRetry( max_attempts=3, initial_delay=1 ) async def make_request(self, url, method=\"GET\", **kwargs): async def operation(): async with aiohttp.ClientSession() as session: async with session.request(method, url, **kwargs) as response: if response.status \u003e= 500: raise RetryableError(f\"서버 오류: {response.status}\") return await response.json() return await self.retry_strategy.execute(operation) 데이터베이스 작업에서의 재시도:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 class DatabaseRetry: def __init__(self): self.retry_strategy = ConditionalRetry( should_retry_func=self.is_retryable_error, max_attempts=3 ) async def execute_query(self, query, params=None): async def operation(): async with self.pool.acquire() as connection: return await connection.fetch(query, params) return await self.retry_strategy.execute(operation) def is_retryable_error(self, error): return isinstance(error, ( asyncpg.DeadlockDetectedError, asyncpg.ConnectionDoesNotExistError )) 참고 및 출처 ","wordCount":"503","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2024-09-27T11:31:00Z","dateModified":"2024-09-27T11:31:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/system-architecture--design/distributed-systems/reliability--resilience/recovery-patterns/retry/retry-pattern/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>HY's Blog</a></div><h1 class="post-title entry-hint-parent">Retry Pattern</h1><div class=post-description>분산 시스템이나 마이크로서비스 아키텍처에서 일시적인 오류(Transient Failure)를 처리하기 위한 핵심 설계 패턴이다.</div><div class=post-meta><span title='2024-09-27 11:31:00 +0000 UTC'>September 27, 2024</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/System%20Architecture%20&%20Design/Distributed%20Systems/Reliability%20&%20Resilience/Recovery%20Patterns/Retry/Retry-Pattern.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#retry-pattern>Retry Pattern</a><ul><li><a href=#retry-pattern의-핵심-개념><strong>Retry Pattern의 핵심 개념</strong></a></li><li><a href=#구현-전략과-사례><strong>구현 전략과 사례</strong></a></li><li><a href=#고려-사항과-주의점><strong>고려 사항과 주의점</strong></a></li><li><a href=#적용-시나리오와-사례><strong>적용 시나리오와 사례</strong></a></li><li><a href=#구현-예시>구현 예시</a></li></ul></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=retry-pattern>Retry Pattern<a hidden class=anchor aria-hidden=true href=#retry-pattern>#</a></h2><p><strong>Retry Pattern</strong>은 분산 시스템이나 마이크로서비스 아키텍처에서 일시적인 오류(Transient Failure)를 처리하기 위한 핵심 설계 패턴이다.<br>네트워크 불안정, 일시적인 서비스 중단 등 <strong>일시적인 실패 상황에서 시스템의 복원력(Resilience)을 강화</strong>하는 데 목적을 둔다.</p><p>이 패턴은 <strong>분산 시스템의 안정성</strong>을 높이는 필수 도구이지만, 남용할 경우 역효과를 낼 수 있으므로 <strong>신중한 정책 수립</strong>이 필요하다.</p><h3 id=retry-pattern의-핵심-개념><strong>Retry Pattern의 핵심 개념</strong><a hidden class=anchor aria-hidden=true href=#retry-pattern의-핵심-개념>#</a></h3><ol><li><p><strong>작동 원리</strong></p><ul><li><strong>실패한 작업 자동 재시도</strong>: API 호출, 데이터베이스 접근 등 실패 가능성이 있는 작업을 <strong>정의된 정책에 따라 재시도</strong>한다.</li><li><strong>일시적 오류 감지</strong>: 네트워크 타임아웃, HTTP 5xx 에러, 데이터베이스 연결 실패 등 <strong>일시적인 오류만 대상</strong>으로 한다.</li></ul></li><li><p><strong>주요 구성 요소</strong></p></li></ol><table><thead><tr><th>구성 요소</th><th>설명</th><th>예시</th></tr></thead><tbody><tr><td><strong>재시도 정책 (Retry Policy)</strong></td><td>어떤 오류를 재시도할지 결정</td><td>HTTP 503(서비스 불가), SocketException</td></tr><tr><td><strong>재시도 간격 (Retry Delay)</strong></td><td>재시도 사이의 대기 시간</td><td>고정 간격, 지수 백오프(Exponential Backoff)</td></tr><tr><td><strong>최대 재시도 횟수</strong></td><td>재시도 최대 허용 횟수</td><td>기본 3회, 시스템 특성에 따라 조정</td></tr><tr><td><strong>폴백 메커니즘 (Fallback)</strong></td><td>최종 실패 시 대체 동작</td><td>캐시 데이터 반환, 오류 로깅</td></tr></tbody></table><h3 id=구현-전략과-사례><strong>구현 전략과 사례</strong><a hidden class=anchor aria-hidden=true href=#구현-전략과-사례>#</a></h3><ol><li><p><strong>지수 백오프 전략</strong></p><ul><li><p><strong>점진적 대기 시간 증가</strong>: 첫 재시도는 1초, 두 번째는 2초, 세 번째는 4초와 같이 <strong>대기 시간을 지수적으로 증가</strong>시켜 과부하 방지.</p></li><li><p><strong>예시 코드 (의사 코드)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>retry_operation</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>max_retries</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=n>base_delay</span> <span class=o>=</span> <span class=mi>1</span>  <span class=c1># 초 단위</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>attempt</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>max_retries</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>perform_operation</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>TransientError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>attempt</span> <span class=o>==</span> <span class=n>max_retries</span> <span class=o>-</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>raise</span>
</span></span><span class=line><span class=cl>            <span class=n>delay</span> <span class=o>=</span> <span class=n>base_delay</span> <span class=o>*</span> <span class=p>(</span><span class=mi>2</span> <span class=o>**</span> <span class=n>attempt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>sleep</span><span class=p>(</span><span class=n>delay</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li></ul></li><li><p><strong>라이브러리 활용</strong></p><ul><li><p><strong>Spring Retry (Java)</strong>: <code>@Retryable</code> 어노테이션으로 간편한 재시도 로직 구현:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Retryable</span><span class=p>(</span><span class=n>maxAttempts</span><span class=o>=</span><span class=n>3</span><span class=p>,</span><span class=w> </span><span class=n>backoff</span><span class=o>=</span><span class=nd>@Backoff</span><span class=p>(</span><span class=n>delay</span><span class=o>=</span><span class=n>1000</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>callExternalService</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 외부 서비스 호출</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Polly (.NET)</strong>: 복합적인 재시도 정책과 서킷 브레이커 패턴 통합 지원.</p></li></ul></li></ol><h3 id=고려-사항과-주의점><strong>고려 사항과 주의점</strong><a hidden class=anchor aria-hidden=true href=#고려-사항과-주의점>#</a></h3><ol><li><p><strong>Idempotency(멱등성) 보장</strong></p><ul><li><strong>동일 요청의 안전성</strong>: 재시도로 인해 <strong>중복 처리되지 않도록</strong> POST 요청보다는 GET/PUT/DELETE 등 멱등성 메서드 사용 권장.</li><li><strong>예시</strong>: 결제 시스템에서 중복 재시도 시 <strong>트랜잭션 ID 검증</strong> 필수.</li></ul></li><li><p><strong>부작용 관리</strong></p><ul><li><strong>시스템 과부하 방지</strong>: 무분별한 재시도는 <strong>서비스 장애 연쇄 반응(Cascading Failure)</strong> 유발 가능. 재시도 횟수와 간격을 엄격히 제한.</li></ul></li><li><p><strong>다른 패턴과의 조합</strong></p><ul><li><strong>서킷 브레이커 패턴</strong>: 지속적 실패 시 재시도를 중단하고 <strong>장애 전파 차단</strong>.</li><li><strong>헤징 패턴</strong>: 동시에 여러 서비스에 요청을 보내 <strong>가장 빠른 응답 선택</strong>.</li></ul></li></ol><h3 id=적용-시나리오와-사례><strong>적용 시나리오와 사례</strong><a hidden class=anchor aria-hidden=true href=#적용-시나리오와-사례>#</a></h3><ol><li><p><strong>적합한 사례</strong></p><ul><li><strong>클라우드 서비스 간 통신</strong>: AWS, Azure에서 발생하는 일시적인 API 오류.</li><li><strong>데이터베이스 장애 복구</strong>: DB 연결 일시 중단 후 자동 복구.</li></ul></li><li><p><strong>비적합한 사례</strong></p><ul><li><strong>영구적 오류</strong>: 잘못된 요청 파라미터(HTTP 400) 또는 권한 오류(HTTP 403)는 재시도해도 해결되지 않음.</li></ul></li></ol><h3 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h3><p>HTTP 클라이언트에서의 재시도:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>HttpClientWithRetry</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>retry_strategy</span> <span class=o>=</span> <span class=n>ExponentialBackoffRetry</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>max_attempts</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>initial_delay</span><span class=o>=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>make_request</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>url</span><span class=p>,</span> <span class=n>method</span><span class=o>=</span><span class=s2>&#34;GET&#34;</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>async</span> <span class=k>def</span> <span class=nf>operation</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>async</span> <span class=k>with</span> <span class=n>aiohttp</span><span class=o>.</span><span class=n>ClientSession</span><span class=p>()</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>async</span> <span class=k>with</span> <span class=n>session</span><span class=o>.</span><span class=n>request</span><span class=p>(</span><span class=n>method</span><span class=p>,</span> <span class=n>url</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=k>as</span> <span class=n>response</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>status</span> <span class=o>&gt;=</span> <span class=mi>500</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>raise</span> <span class=n>RetryableError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;서버 오류: </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>status</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=k>await</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>retry_strategy</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>operation</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>데이터베이스 작업에서의 재시도:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16>16</a>
</span><span class=lnt id=hl-3-17><a class=lnlinks href=#hl-3-17>17</a>
</span><span class=lnt id=hl-3-18><a class=lnlinks href=#hl-3-18>18</a>
</span><span class=lnt id=hl-3-19><a class=lnlinks href=#hl-3-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>DatabaseRetry</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>retry_strategy</span> <span class=o>=</span> <span class=n>ConditionalRetry</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>should_retry_func</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>is_retryable_error</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>max_attempts</span><span class=o>=</span><span class=mi>3</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>execute_query</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>query</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>async</span> <span class=k>def</span> <span class=nf>operation</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>async</span> <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>pool</span><span class=o>.</span><span class=n>acquire</span><span class=p>()</span> <span class=k>as</span> <span class=n>connection</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=k>await</span> <span class=n>connection</span><span class=o>.</span><span class=n>fetch</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=n>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>retry_strategy</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>operation</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>is_retryable_error</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>error</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>error</span><span class=p>,</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>asyncpg</span><span class=o>.</span><span class=n>DeadlockDetectedError</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>asyncpg</span><span class=o>.</span><span class=n>ConnectionDoesNotExistError</span>
</span></span><span class=line><span class=cl>        <span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/system-and-software-architecture/>System-and-Software-Architecture</a></li><li><a href=https://buenhyden.github.io/tags/software-architecture-patterns/>Software-Architecture-Patterns</a></li><li><a href=https://buenhyden.github.io/tags/retry-patterns/>Retry-Patterns</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/networking--protocols/communication-patterns/asynchronous-communication/event-driven/publish-subscribe/publish-subscribe/publisher-subscriber-pattern/><span class=title>« Prev</span><br><span>Publisher-Subscriber Pattern</span>
</a><a class=next href=https://buenhyden.github.io/posts/data--database-systems/data-architecture/scalability--distribution/replication/master-slave/master-slave/><span class=title>Next »</span><br><span>Master-Slave</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2026 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>