<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>API Gateway | hyunyoun's Blog</title><meta name=keywords content="System-Design,System-Components,Traffic-Control-and-Routing,API-Gateway,Microservices-Architecture"><meta name=description content="API Gateway 는 마이크로서비스 아키텍처에서 핵심 라우터이자 진입점 역할을 수행한다. 요청의 인증, 라우팅, 로드 밸런싱, 변환, 모니터링 등을 통합적으로 처리하여 클라이언트와 백엔드 서비스 간의 결합도를 낮추고 보안/운영 효율성을 높인다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/system-architecture--design/distributed-systems/service-integration/api-gateway/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/system-architecture--design/distributed-systems/service-integration/api-gateway/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/system-architecture--design/distributed-systems/service-integration/api-gateway/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/system-architecture--design/distributed-systems/service-integration/api-gateway/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="API Gateway"><meta property="og:description" content="API Gateway 는 마이크로서비스 아키텍처에서 핵심 라우터이자 진입점 역할을 수행한다. 요청의 인증, 라우팅, 로드 밸런싱, 변환, 모니터링 등을 통합적으로 처리하여 클라이언트와 백엔드 서비스 간의 결합도를 낮추고 보안/운영 효율성을 높인다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="API Gateway"><meta name=twitter:description content="API Gateway 는 마이크로서비스 아키텍처에서 핵심 라우터이자 진입점 역할을 수행한다. 요청의 인증, 라우팅, 로드 밸런싱, 변환, 모니터링 등을 통합적으로 처리하여 클라이언트와 백엔드 서비스 간의 결합도를 낮추고 보안/운영 효율성을 높인다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HY's Blog","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":4,"name":"API Gateway","item":"https://buenhyden.github.io/posts/system-architecture--design/distributed-systems/service-integration/api-gateway/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>HY's Blog</a></div><h1>API Gateway</h1><div class=post-description>API Gateway 는 마이크로서비스 아키텍처에서 핵심 라우터이자 진입점 역할을 수행한다. 요청의 인증, 라우팅, 로드 밸런싱, 변환, 모니터링 등을 통합적으로 처리하여 클라이언트와 백엔드 서비스 간의 결합도를 낮추고 보안/운영 효율성을 높인다.</div></header><div class=post-content><h2 id=api-gateway>API Gateway<a hidden class=anchor aria-hidden=true href=#api-gateway>#</a></h2><p>API Gateway 는 분산 서비스 환경에서 클라이언트 요청을 받아 내부 서비스로 적절히 전달하고 응답을 반환하는 통신의 허브 역할을 한다.</p><p>인증·인가, SSL 종료, 로깅, 트래픽 제어, 응답 변환 등 핵심 기능을 수행하여 서비스 간 결합도를 낮추고 보안과 관리를 중앙 집중화한다. 경량 레이어에서 보안·성능·운영성과를 확보할 수 있어 마이크로서비스, 무상태화된 아키텍처 설계에 필수적이다.</p><p>핵심 개념으로는 프록시 방식, 페일오버, 캐싱, 트래픽 제어 등이 있으며, 실무 적용 시 인증체계 연동, 장애 대응, 확장성, 운영 모니터링 및 로깅 전략을 고려해야 한다.</p><h3 id=등장-배경-및-발전-과정>등장 배경 및 발전 과정<a hidden class=anchor aria-hidden=true href=#등장-배경-및-발전-과정>#</a></h3><p><strong>API Gateway 는 마이크로서비스 아키텍처와 클라우드 네이티브 환경의 확산에 따라 등장한 중앙 집중형 요청 처리 및 관리 계층이다.</strong><br>모놀리식 아키텍처의 복잡성 문제를 해결하고, 각 서비스의 공통 기능을 통합하며, 클라이언트와 서비스 간의 인터페이스 복잡성을 줄이기 위한 핵심 구성 요소로 발전해왔다.</p><h4 id=기술적-배경-모놀리식-아키텍처의-한계>기술적 배경: 모놀리식 아키텍처의 한계<a hidden class=anchor aria-hidden=true href=#기술적-배경-모놀리식-아키텍처의-한계>#</a></h4><table><thead><tr><th>문제 요소</th><th>설명</th></tr></thead><tbody><tr><td>복잡성 증가</td><td>기능이 하나의 애플리케이션에 통합되면서, 개발·테스트·배포 과정에서 병목 발생</td></tr><tr><td>부분적 확장 불가능</td><td>개별 기능이 아닌 전체 애플리케이션 단위로만 확장 가능, 자원 비효율 초래</td></tr><tr><td>기술 스택 변경 제약</td><td>전체 시스템에 영향을 주므로, 새로운 기술 도입·교체가 어렵고 위험함</td></tr></tbody></table><h4 id=아키텍처-변화-마이크로서비스의-도입>아키텍처 변화: 마이크로서비스의 도입<a hidden class=anchor aria-hidden=true href=#아키텍처-변화-마이크로서비스의-도입>#</a></h4><table><thead><tr><th>발전 요인</th><th>설명</th></tr></thead><tbody><tr><td>독립적 개발 및 배포 필요</td><td>기능별 서비스 분리로 민첩한 개발과 배포 가능</td></tr><tr><td>팀 중심의 자율성 강화</td><td>서비스 별로 팀이 구성되어 DevOps 문화가 확산됨</td></tr><tr><td>클라우드 네이티브 요구 대응</td><td>컨테이너, 오케스트레이션 환경에 최적화된 구조 필요</td></tr></tbody></table><blockquote><p><strong>관련 개념</strong>: SOA(Service-Oriented Architecture) 의 분산 아키텍처 개념을 계승 → 마이크로서비스 구조 확립</p></blockquote><h4 id=api-gateway-등장-배경>API Gateway 등장 배경<a hidden class=anchor aria-hidden=true href=#api-gateway-등장-배경>#</a></h4><table><thead><tr><th>도입 필요성</th><th>설명</th></tr></thead><tbody><tr><td>클라이언트 복잡도 감소</td><td>수십 개의 마이크로서비스를 직접 호출하지 않고 중앙 집중식 API 제공</td></tr><tr><td>횡단 관심사 (Cross-cutting concerns) 처리</td><td>인증, 로깅, 로드밸런싱, 정책 관리 등 중복 로직 통합 필요</td></tr><tr><td>유연한 요청 라우팅</td><td>다양한 클라이언트 (BFF, 모바일, IoT 등) 에 맞춘 API 구성 및 응답 가공 가능</td></tr><tr><td>보안과 관찰성 통합</td><td>인증/인가, 트래픽 제어, 로깅/모니터링 등 공통 기능 일원화</td></tr></tbody></table><h4 id=발전-흐름-시대별-기술-흐름>발전 흐름: 시대별 기술 흐름<a hidden class=anchor aria-hidden=true href=#발전-흐름-시대별-기술-흐름>#</a></h4><table><thead><tr><th>시기</th><th>주요 변화</th></tr></thead><tbody><tr><td><strong>2000 년대 초</strong></td><td>ESB(Enterprise Service Bus) 를 통한 서비스 통합이 중심. SOAP 기반</td></tr><tr><td><strong>2010 년대 초</strong></td><td>RESTful API 보편화 → API 관리 플랫폼 등장 (ex. Apigee, AWS API Gateway)</td></tr><tr><td><strong>2015 년 이후</strong></td><td>마이크로서비스 채택 확산 → 현재의 API Gateway 개념 정립</td></tr><tr><td><strong>현재</strong></td><td>클라우드 네이티브 + 서비스 메시 (Envoy, Istio 등) 와 결합하여 기능 고도화</td></tr></tbody></table><ul><li><strong>초기에는</strong> ESB 중심의 엔터프라이즈 통합 수단으로 API Gateway 개념이 등장했으며,</li><li><strong>RESTful 시대에는</strong> Apigee, AWS API Gateway 등 관리형 플랫폼이 활성화되었고,</li><li><strong>마이크로서비스 시대에는</strong> Kong, Tyk, Gloo 같은 고성능 오픈소스 플랫폼이 주요 역할을 하게 되었으며,</li><li><strong>클라우드 네이티브 환경에서는</strong> Kubernetes-native + Envoy 기반 구조가 대세가 되고 있음.</li></ul><h4 id=연관-기술과의-관계>연관 기술과의 관계<a hidden class=anchor aria-hidden=true href=#연관-기술과의-관계>#</a></h4><table><thead><tr><th>기술 요소</th><th>연계 방식</th></tr></thead><tbody><tr><td><strong>서비스 메시</strong></td><td>마이크로서비스 내부 간 통신, 정책 분리 (Data Plane / Control Plane)</td></tr><tr><td><strong>BFF (Backend for Frontend)</strong></td><td>클라이언트 유형별 최적화된 API 조합 제공–API Gateway 상위 계층으로 동작 가능</td></tr><tr><td><strong>gRPC / GraphQL / WebSocket</strong></td><td>API Gateway 에서 다양한 프로토콜 트랜스코딩 및 인터페이스 지원 가능</td></tr></tbody></table><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><h4 id=정의-및-위치>정의 및 위치<a hidden class=anchor aria-hidden=true href=#정의-및-위치>#</a></h4><p>API Gateway 는 **클라이언트와 내부 백엔드 서비스 간의 단일 진입점 (Single Entry Point)**으로, 모든 요청을 수신하여 적절한 서비스로 라우팅하고 **보안·로깅·트래픽 제어·응답 조합 등 횡단 관심사 (Cross-cutting Concerns)**를 중앙 집중적으로 처리하는 컴포넌트이다.</p><blockquote><p>🎯 주로 <strong>마이크로서비스 아키텍처</strong>, <strong>BFF 패턴</strong>, <strong>클라우드 네이티브 환경</strong>에서 필수 요소로 활용된다.</p></blockquote><h4 id=핵심-기능별-개념-정리>핵심 기능별 개념 정리<a hidden class=anchor aria-hidden=true href=#핵심-기능별-개념-정리>#</a></h4><table><thead><tr><th>기능 구분</th><th>설명</th></tr></thead><tbody><tr><td><strong>프록시 (Proxy)</strong></td><td>클라이언트 요청을 중계하여 내부 서비스를 직접 노출하지 않고 안전하게 연결함</td></tr><tr><td><strong>역방향 프록시 (Reverse Proxy)</strong></td><td>클라이언트 대신 내부 서비스에 요청 전달 및 응답 반환</td></tr><tr><td><strong>라우팅 (Routing)</strong></td><td>URL, 메서드, 헤더 기반으로 적절한 서비스로 요청 전달</td></tr><tr><td><strong>어그리게이션 (Aggregation)</strong></td><td>여러 서비스의 응답을 조합해 단일 응답으로 제공 (예: 주문 상세 + 배송 상태 + 결제 정보 등)</td></tr><tr><td><strong>인증·인가 (AuthN/AuthZ)</strong></td><td>JWT, OAuth2, API Key 등 기반의 사용자 식별 및 권한 부여</td></tr><tr><td><strong>트래픽 제어</strong></td><td>Rate Limiting, Throttling, Circuit Breaker 로 장애 전파 방지 및 성능 보호</td></tr><tr><td><strong>로깅·모니터링</strong></td><td>요청·응답 데이터 로깅, 메트릭 수집, 추적 (Tracing) 등 관측성 확보</td></tr><tr><td><strong>캐싱 (Caching)</strong></td><td>자주 호출되는 응답을 저장해 성능 개선 및 백엔드 부하 감소</td></tr><tr><td><strong>응답 변환 (Transformation)</strong></td><td>API 버전 관리, 포맷 변환 (JSON ↔ XML 등), 필드 매핑 수행</td></tr><tr><td><strong>보안 정책 적용</strong></td><td>CORS 설정, HTTPS 강제, IP 차단, Web Application Firewall(WAF) 등</td></tr><tr><td><strong>API 수익화/요금제</strong></td><td>사용량 측정 및 요금 부과 기능 (상용 플랫폼 중심 기능)</td></tr><tr><td><strong>개발자 포털 제공</strong></td><td>API 문서화, 테스트 콘솔, 키 발급 기능 등 개발자 경험 향상 목적</td></tr></tbody></table><h4 id=실무-구현-연관성-분석>실무 구현 연관성 분석<a hidden class=anchor aria-hidden=true href=#실무-구현-연관성-분석>#</a></h4><table><thead><tr><th>영역</th><th>연계 요소</th><th>실무 적용 예시</th></tr></thead><tbody><tr><td><strong>인프라 연계</strong></td><td>로드밸런서, 서비스 디스커버리, DNS, 컨테이너 오케스트레이션</td><td>Kubernetes + Istio + API Gateway 조합</td></tr><tr><td><strong>보안</strong></td><td>인증/인가, 암호화, 트래픽 필터링</td><td>OAuth2 인증 서버 연동, mTLS, WAF 정책 적용</td></tr><tr><td><strong>운영/모니터링</strong></td><td>로그 수집, APM, 트레이싱</td><td>Fluentd, Prometheus, Grafana, Jaeger 연동</td></tr><tr><td><strong>성능 최적화</strong></td><td>캐싱, 연결 풀링, 서킷 브레이커</td><td>Redis 캐시, Hystrix 또는 Envoy 필터 사용</td></tr><tr><td><strong>API 구성 관리</strong></td><td>API 버전 관리, 경로 설계, 스키마 관리</td><td>OpenAPI(Swagger) 기반 문서화, GitOps 연동</td></tr><tr><td><strong>DevOps 통합</strong></td><td>CI/CD, Canary 배포, 트래픽 스플리팅</td><td>ArgoCD + API Gateway 를 통한 배포 정책 제어</td></tr></tbody></table><h4 id=고급-기능과-전략적-역할>고급 기능과 전략적 역할<a hidden class=anchor aria-hidden=true href=#고급-기능과-전략적-역할>#</a></h4><table><thead><tr><th>고급 개념</th><th>실무 적용 시 이점</th></tr></thead><tbody><tr><td><strong>BFF (Backend for Frontend)</strong></td><td>클라이언트 유형 (모바일/웹) 에 최적화된 API 제공</td></tr><tr><td><strong>API Orchestration</strong></td><td>복잡한 비즈니스 로직을 API Gateway 에서 조합 가능</td></tr><tr><td><strong>Service Mesh 연계</strong></td><td>API Gateway 는 외부 트래픽, Service Mesh 는 내부 트래픽 담당–역할 분리 명확</td></tr><tr><td><strong>정책 기반 제어 (Policy-based Routing)</strong></td><td>사용자 역할, 지리적 위치, 트래픽 상태에 따른 동적 라우팅 가능</td></tr><tr><td><strong>A/B 테스트 & Canary 배포</strong></td><td>일부 사용자만 새 버전 사용하도록 분기 제어 가능</td></tr></tbody></table><h3 id=주요-기능과-역할>주요 기능과 역할<a hidden class=anchor aria-hidden=true href=#주요-기능과-역할>#</a></h3><h4 id=주요-기능>주요 기능<a hidden class=anchor aria-hidden=true href=#주요-기능>#</a></h4><p>API Gateway 가 수행하는 <strong>기술적 처리 동작</strong></p><table><thead><tr><th>기능 범주</th><th>기능 항목</th><th>설명</th></tr></thead><tbody><tr><td>요청 처리</td><td><strong>라우팅 (Routing)</strong></td><td>클라이언트 요청을 적절한 백엔드 서비스로 전달</td></tr><tr><td></td><td><strong>응답 집계 (Response Aggregation)</strong></td><td>여러 서비스의 응답을 하나의 응답으로 통합</td></tr><tr><td>변환</td><td><strong>프로토콜 변환 (Protocol Translation)</strong></td><td>REST ↔ SOAP, HTTP ↔ gRPC 등 프로토콜 상호 변환</td></tr><tr><td></td><td><strong>데이터 변환 (Request/Response Transformation)</strong></td><td>요청 및 응답 형식 변환 (ex. JSON ↔ XML)</td></tr><tr><td>보안</td><td><strong>인증/인가 (Authentication & Authorization)</strong></td><td>JWT, OAuth2, API 키 등 다양한 인증/권한 검증</td></tr><tr><td></td><td><strong>SSL 종료 (SSL Termination)</strong></td><td>SSL 처리를 게이트웨이에서 수행하여 백엔드 부담 해소</td></tr><tr><td></td><td><strong>DoS 방어 (DDoS Protection)</strong></td><td>속도 제한, IP 차단, 요청 임계값 기반의 공격 방어</td></tr><tr><td>성능 최적화</td><td><strong>캐싱 (Caching)</strong></td><td>자주 요청되는 데이터 응답을 저장해 백엔드 부하 경감</td></tr><tr><td></td><td><strong>로드 밸런싱 (Load Balancing)</strong></td><td>요청을 여러 인스턴스로 분산 처리</td></tr><tr><td></td><td><strong>서킷 브레이커 (Circuit Breaker)</strong></td><td>오류 발생 시 요청 차단으로 장애 전파 방지</td></tr><tr><td>관찰 가능성</td><td><strong>로깅 및 모니터링 (Logging & Monitoring)</strong></td><td>요청/응답, 지연 시간, 오류 등의 메트릭 수집 및 분석</td></tr><tr><td>운영 편의성</td><td><strong>API 버전 관리 (Versioning)</strong></td><td>여러 API 버전의 동시 운영 및 관리</td></tr><tr><td></td><td><strong>정책 적용 및 문서화</strong></td><td>Rate Limit, Throttling, API 문서, OpenAPI 등 정책 기반 구성 가능</td></tr><tr><td></td><td><strong>개발자 포털/수익화 지원</strong></td><td>API 문서화, 키 발급, 사용량 기반 과금 등 개발자 및 비즈니스 지원 기능 포함</td></tr></tbody></table><h4 id=주요-역할>주요 역할<a hidden class=anchor aria-hidden=true href=#주요-역할>#</a></h4><p>아키텍처 내에서의 <strong>위치와 책임</strong>을 나타내는 구조적/운영적 포지션</p><table><thead><tr><th>역할 범주</th><th>역할 항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>중앙 집중 관리</strong></td><td><strong>단일 진입점 제공 (Single Entry Point)</strong></td><td>클라이언트 요청을 중앙화된 게이트웨이로 수렴, 마이크로서비스 추상화</td></tr><tr><td></td><td><strong>보안 정책 시행점 (Policy Enforcement)</strong></td><td>보안 정책 및 인증/인가 로직을 중앙에서 통합 관리</td></tr><tr><td><strong>보안 관문</strong></td><td><strong>보안 게이트웨이 역할 (Security Gateway)</strong></td><td>API 요청 전 인증 및 접근 제어 수행, WAF, mTLS, IP 제어 포함</td></tr><tr><td><strong>성능 최적화</strong></td><td><strong>성능 게이트 역할 (Performance Enhancer)</strong></td><td>캐싱, 압축, 로드밸런싱 등으로 응답 지연 최소화 및 시스템 부하 감소</td></tr><tr><td><strong>복원력 강화</strong></td><td><strong>장애 격리자 역할 (Failure Isolator)</strong></td><td>서킷 브레이커, 타임아웃, 재시도 정책 등을 통해 장애 전파 방지</td></tr><tr><td><strong>운영 지원</strong></td><td><strong>관찰성 중계자 역할 (Observability Hub)</strong></td><td>메트릭 수집, 트레이싱, 로깅을 통해 운영 효율성 확보 및 문제 진단 용이화</td></tr><tr><td><strong>서비스 분리자</strong></td><td><strong>서비스 추상화 계층 (Abstraction Layer)</strong></td><td>백엔드 구조 및 버전 변경에 대해 클라이언트를 격리, API 인터페이스만 고정 유지</td></tr><tr><td><strong>정책 관리자</strong></td><td><strong>정책 및 SLA 적용자 (Policy Enforcer)</strong></td><td>SLA, QoS, 속도 제한, 데이터 변형, 필터링 등의 운영 정책 적용</td></tr></tbody></table><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><h4 id=아키텍처적-특징-architectural-characteristics>아키텍처적 특징 (Architectural Characteristics)<a hidden class=anchor aria-hidden=true href=#아키텍처적-특징-architectural-characteristics>#</a></h4><table><thead><tr><th>항목</th><th>설명</th><th>관련 요소</th></tr></thead><tbody><tr><td><strong>단일 진입점</strong></td><td>모든 클라이언트 요청을 단일 지점에서 수신 및 처리하여 API 접근을 일원화함.</td><td>Reverse Proxy, BFF</td></tr><tr><td><strong>추상화 계층</strong></td><td>클라이언트는 백엔드 서비스의 위치, 구조, 프로토콜을 몰라도 API 만 호출 가능</td><td>API Composition, Routing</td></tr><tr><td><strong>리버스 프록시 구조</strong></td><td>API Gateway 는 클라이언트 앞단에서 요청을 받아 백엔드로 프록시 처리</td><td>NGINX, Envoy, Kong</td></tr><tr><td><strong>멀티 프로토콜 지원</strong></td><td>REST, GraphQL, gRPC, WebSocket 등 다양한 프로토콜 간 변환 및 통합 가능</td><td>Protocol Translation</td></tr><tr><td><strong>무상태 구조 (Stateless)</strong></td><td>요청 상태를 저장하지 않아 수평 확장 용이하며 장애 전파 가능성 감소</td><td>확장성, 복원력 강화</td></tr><tr><td><strong>느슨한 결합 (Loose Coupling)</strong></td><td>클라이언트와 백엔드의 직접 의존 제거, 변경 시 영향 최소화</td><td>Microservice 적합</td></tr></tbody></table><h4 id=운영적-특징-operational-characteristics>운영적 특징 (Operational Characteristics)<a hidden class=anchor aria-hidden=true href=#운영적-특징-operational-characteristics>#</a></h4><table><thead><tr><th>항목</th><th>설명</th><th>기반 기능/기술</th></tr></thead><tbody><tr><td><strong>중앙집중 정책 관리</strong></td><td>인증, 인가, 트래픽 제어, 로깅 등 운영 정책을 게이트웨이에서 일괄 적용 가능</td><td>인증/인가, Rate Limiting</td></tr><tr><td><strong>관찰성 (Observability)</strong></td><td>요청 로그, 메트릭, 트레이싱 수집을 통해 실시간 분석 및 문제 진단 가능</td><td>OpenTelemetry, Prometheus, Grafana</td></tr><tr><td><strong>정책 기반 제어</strong></td><td>선언적 설정을 통해 라우팅, 보안, 트래픽 제어 등 운영 정책을 빠르게 적용</td><td>Declarative Config, CRDs</td></tr><tr><td><strong>자동화 지원</strong></td><td>CI/CD 및 IaC 와 연동하여 API 배포, 구성, 문서화 자동화 가능</td><td>OpenAPI, Terraform, GitOps</td></tr><tr><td><strong>다중 환경 지원</strong></td><td>온프레미스, 클라우드, 하이브리드 등 다양한 환경에서 유연하게 배포 가능</td><td>Helm, Kubernetes, Service Mesh 연동</td></tr></tbody></table><h4 id=기능적-특징-functional-characteristics>기능적 특징 (Functional Characteristics)<a hidden class=anchor aria-hidden=true href=#기능적-특징-functional-characteristics>#</a></h4><table><thead><tr><th>항목</th><th>설명</th><th>예시/비고</th></tr></thead><tbody><tr><td><strong>보안 중심 설계</strong></td><td>JWT, OAuth2, mTLS, WAF 등을 통해 다양한 보안 요구사항 수용</td><td>Auth0, Keycloak, Okta</td></tr><tr><td><strong>확장성</strong></td><td>수평 확장 가능, 무상태 아키텍처로 스케일 아웃이 용이함</td><td>클러스터 기반 분산 구성</td></tr><tr><td><strong>탄력성 제공</strong></td><td>Circuit Breaker, 재시도, Timeout 설정으로 장애 전파 최소화</td><td>Hystrix, Envoy Retry Policy</td></tr><tr><td><strong>플러그인 기반 유연성</strong></td><td>인증, 로깅, 트래픽 제어, 변환 기능 등을 플러그인 형태로 동적 적용 가능</td><td>Kong Plugin, API7, Tyk</td></tr><tr><td><strong>정책 기반 라우팅</strong></td><td>조건부 라우팅, 헤더/쿼리 기반 동적 라우팅 등 세밀한 요청 분기 처리</td><td>A/B 테스트, Canary Routing</td></tr><tr><td><strong>버전 및 환경 분리</strong></td><td>API 버전 및 Stage(Environment) 별 정책 적용 및 트래픽 제어 가능</td><td>/v1/, /v2/, dev/staging/prod</td></tr></tbody></table><h3 id=핵심-설계-및-운영-원칙>핵심 설계 및 운영 원칙<a hidden class=anchor aria-hidden=true href=#핵심-설계-및-운영-원칙>#</a></h3><table><thead><tr><th>카테고리</th><th>분류</th><th>원칙</th><th>설명</th><th>실무 적용 고려사항</th></tr></thead><tbody><tr><td>보안/통제 (Security & Governance)</td><td>보안</td><td><strong>보안 우선 원칙 (Security-First)</strong></td><td>인증, 인가, 암호화, 트래픽 필터링은 기본값으로 설계되어야 함</td><td>mTLS, OAuth2, JWT, API Key, WAF, CORS 설정 등 사전 적용</td></tr><tr><td></td><td>정책</td><td><strong>정책 일관성 원칙 (Policy Consistency)</strong></td><td>인증, 속도제한, 로깅 등 공통 정책은 일괄 적용해야 함</td><td>모든 서비스에 동일한 정책 필터 체인 적용</td></tr><tr><td></td><td>구조</td><td><strong>단일 진입점 원칙 (Single Entry Point)</strong></td><td>외부 요청은 반드시 Gateway 를 거쳐야 하며, 내부 서비스 직접 노출 금지</td><td>API Gateway 앞단에 L4/L7 LB 또는 CDN 연계</td></tr><tr><td>설계/구조 (Design & Structure)</td><td>라우팅</td><td><strong>유연한 라우팅 원칙 (Flexible Routing)</strong></td><td>URI, 헤더, 쿼리 파라미터 등 다양한 조건 기반으로 동적 라우팅 가능해야 함</td><td>A/B 테스트, 다중 경로 버전 관리, 트래픽 분할 등</td></tr><tr><td></td><td>책임</td><td><strong>단일 책임 원칙 (Single Responsibility)</strong></td><td>API Gateway 는 인증, 라우팅, 정책 처리 등 중재자 역할에 집중해야 함</td><td>복잡한 도메인 로직은 백엔드로 위임 (BFF 또는 Orchestration 방지)</td></tr><tr><td></td><td>경량화</td><td><strong>경량 처리 원칙 (Lightweight Processing)</strong></td><td>데이터 집계 외의 복잡한 비즈니스 로직은 처리하지 않도록 제한</td><td>Transform/Mapping 은 필수일 때만 적용, DB 접근은 지양</td></tr><tr><td></td><td>추상화</td><td><strong>백엔드 추상화 원칙 (Backend Abstraction)</strong></td><td>클라이언트는 백엔드 구현 세부 정보를 알 필요 없음</td><td>버전 관리, 경로 숨김, 서비스 ID 기반 매핑</td></tr><tr><td></td><td>확장성</td><td><strong>확장 가능성 원칙 (Extensibility)</strong></td><td>기능은 플러그인/필터 체인 방식으로 수평 확장 가능해야 함</td><td>Lua (Nginx), EnvoyFilter, Kong Plugin 등 커스터마이징</td></tr><tr><td>회복탄력성 (Resilience)</td><td>회복탄력</td><td><strong>탄력성 원칙 (Resiliency)</strong></td><td>장애 발생 시, 회복 가능하거나 최소 서비스는 유지되어야 함</td><td>Circuit Breaker, Retry, Timeout, Fallback 처리 필수</td></tr><tr><td>운영성 (Operability)</td><td>관찰성</td><td><strong>관찰 가능성 원칙 (Observability)</strong></td><td>트래픽 흐름, 장애, 성능 지표는 항상 모니터링 가능해야 함</td><td>Prometheus, Grafana, ELK, Jaeger 연동</td></tr><tr><td></td><td>테스트</td><td><strong>버전 관리 원칙 (Versioning)</strong></td><td>API 변경 시 기존 클라이언트에 영향을 주지 않도록 버전 체계를 분리해야 함</td><td>/v1, /v2 경로 구분 또는 Accept Header 기반 라우팅</td></tr><tr><td></td><td>운영</td><td><strong>고가용성 원칙 (High Availability)</strong></td><td>단일 장애점 (SPOF) 제거 및 이중화 구성 필수</td><td>수평 확장, Auto-healing, Health Check, Failover</td></tr><tr><td>사용성/개발자 경험 (UX/DX)</td><td>개발자</td><td><strong>개발자 경험 우선 원칙 (Developer Experience First)</strong></td><td>API 소비자를 위한 문서화, 테스트, 키 발급 등 편의성 제공</td><td>Swagger UI, DevPortal, Sandbox, Quota 관리 등 제공</td></tr></tbody></table><h3 id=주요-원리-및-작동-원리>주요 원리 및 작동 원리<a hidden class=anchor aria-hidden=true href=#주요-원리-및-작동-원리>#</a></h3><ul><li>모든 클라이언트 요청은 API Gateway 를 통해서만 백엔드에 전달됨</li><li>요청은 규칙 (라우팅/정책) 에 따라 분기<ul><li><strong>라우팅 (Routing):</strong> Trie, 정규식, 해시 기반 패턴 매칭</li></ul></li><li>각종 플러그인 또는 미들웨어 (캐싱, 인증, 변환 등) 단계를 순차 처리<ul><li><strong>플러그인 실행:</strong> 인증→변환→캐시→로깅 순으로 플러그인이 실행됨</li></ul></li></ul><ul><li><strong>부하 분산:</strong> 다양한 알고리즘 (라운드로빈, leastConn 등) 및 헬스체크 병행</li></ul><pre class=mermaid>sequenceDiagram
    participant C as Client
    participant AG as API Gateway
    participant S1 as Service A
    participant S2 as Service B
    participant Auth as Auth Service
    
    C-&gt;&gt;AG: API Request
    AG-&gt;&gt;Auth: Validate Token
    Auth--&gt;&gt;AG: Auth Result
    alt Authentication Success
        AG-&gt;&gt;S1: Route Request
        S1--&gt;&gt;AG: Response
        AG-&gt;&gt;S2: Additional Request (if needed)
        S2--&gt;&gt;AG: Response
        AG-&gt;&gt;AG: Aggregate Responses
        AG--&gt;&gt;C: Final Response
    else Authentication Failed
        AG--&gt;&gt;C: 401 Unauthorized
    end
</pre><p><strong>작동 방식</strong>:</p><ol><li><strong>요청 수신</strong>: 클라이언트로부터 API 요청 접수</li><li><strong>인증/인가</strong>: 토큰 검증 및 권한 확인</li><li><strong>라우팅 결정</strong>: 요청 경로 및 규칙에 따른 서비스 선택</li><li><strong>요청 전달</strong>: 선택된 백엔드 서비스로 요청 전송</li><li><strong>응답 처리</strong>: 서비스 응답 수집 및 변환</li><li><strong>응답 반환</strong>: 클라이언트로 최종 응답 전달</li></ol><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><p>API Gateway 는 일반적으로 <strong>리버스 프록시 계층</strong>에 위치하며, 클라이언트와 마이크로서비스 사이에서 <strong>보안, 라우팅, 트래픽 제어, 로깅, 포맷 변환 등</strong>을 담당하는 <strong>중간 관문 계층</strong>이다.</p><pre class=mermaid>graph LR
  A[Client] --&gt; B[API Gateway]
  B --&gt; C{Plugin System / Filter Chain}
  C --&gt; D[Auth &amp; ACL]
  C --&gt; E[Rate Limiter]
  C --&gt; F[&#34;Transformation (Format, Version)&#34;]
  C --&gt; G[Cache Layer]
  C --&gt; H[Logging &amp; Monitoring]
  B --&gt; I[Router + Load Balancer]
  I --&gt; J[Service A]
  I --&gt; K[Service B]
  I --&gt; L[Service C]
</pre><h4 id=구성-요소>구성 요소<a hidden class=anchor aria-hidden=true href=#구성-요소>#</a></h4><table><thead><tr><th>구분</th><th>구성 요소</th><th>기능 설명</th><th>역할 요약</th></tr></thead><tbody><tr><td><strong>핵심</strong></td><td><strong>요청 라우터</strong> (Routing Engine)</td><td>URL, 메서드, 헤더, 쿼리 기반 조건부 라우팅 수행</td><td>적절한 백엔드 서비스 전달</td></tr><tr><td></td><td><strong>인증/인가 모듈</strong> (Auth Filter)</td><td>JWT, OAuth2, API Key, mTLS 등 보안 검증 수행</td><td>접근 제어 및 사용자 식별</td></tr><tr><td></td><td><strong>로깅/모니터링</strong> (Log/Metrics)</td><td>요청/응답 로그, 지연 시간, 상태 코드, 트래픽 메트릭 수집 및 전송</td><td>운영 가시성과 장애 분석 지원</td></tr><tr><td><strong>확장</strong></td><td><strong>응답 집계기</strong> (Aggregator)</td><td>여러 마이크로서비스의 응답을 병합하여 하나의 응답으로 제공</td><td>클라이언트 요청 간소화</td></tr><tr><td></td><td><strong>포맷 변환기</strong> (Transformer)</td><td>JSON ↔ XML, REST ↔ GraphQL, 버전 변환 등</td><td>클라이언트와 서비스 간 호환성 확보</td></tr><tr><td></td><td><strong>캐시 처리기</strong> (Cache Layer)</td><td>응답 데이터 캐싱 및 TTL 적용</td><td>성능 개선 및 백엔드 부하 감소</td></tr><tr><td></td><td><strong>회로 차단기</strong> (Circuit Breaker)</td><td>일정 실패율 초과 시 요청 차단, 재시도 및 fallback 처리 가능</td><td>장애 전파 차단 및 시스템 보호</td></tr><tr><td></td><td><strong>속도 제한기</strong> (Rate Limiter)</td><td>IP/사용자별 요청 속도 제한, Throttling 등</td><td>DoS 방어 및 QoS 유지</td></tr></tbody></table><h4 id=아키텍처-상의-특징>아키텍처 상의 특징<a hidden class=anchor aria-hidden=true href=#아키텍처-상의-특징>#</a></h4><table><thead><tr><th>특징 항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>모듈화 구조</strong></td><td>기능별로 분리된 필터 체인 또는 플러그인 시스템으로 구성되어 기능 추가/제거가 용이함 (ex. Kong, API7)</td></tr><tr><td><strong>비동기/이벤트 기반 처리</strong></td><td>고성능 게이트웨이 (예: Envoy) 는 비동기 논블로킹 I/O 기반 처리로 높은 처리량을 유지</td></tr><tr><td><strong>무상태 설계</strong></td><td>API Gateway 자체는 상태를 저장하지 않으며 요청 단위로 동작 → 수평적 확장 및 장애 격리에 유리함</td></tr><tr><td><strong>서비스 디스커버리 연동</strong></td><td>Consul, Eureka, Kubernetes API 등과 연동하여 동적으로 백엔드 서비스 위치를 식별하고 갱신 가능</td></tr><tr><td><strong>관찰성 강화</strong></td><td>로그, 메트릭, 트레이싱 등을 통합 수집하여 운영 및 성능 모니터링에 활용 (Prometheus, Jaeger, OpenTelemetry 등과 연계)</td></tr></tbody></table><h4 id=아키텍처-패턴>아키텍처 패턴<a hidden class=anchor aria-hidden=true href=#아키텍처-패턴>#</a></h4><table><thead><tr><th>아키텍처 유형</th><th>정의</th><th>구조적 특징</th><th>장점</th><th>단점</th><th>적합한 사용 사례</th></tr></thead><tbody><tr><td><strong>1. 중앙 집중형 (Centralized)</strong></td><td>단일 API Gateway 인스턴스가 모든 트래픽을 처리</td><td>Gateway 하나가 모든 요청 수신 및 처리</td><td>- 설정 및 정책 관리가 단순<br>- 운영 및 모니터링 일원화<br>- 빠른 초기 구축</td><td>- 단일 장애점 (SPOF)<br>- 트래픽 증가 시 병목<br>- 수평 확장 어려움</td><td>초기 도입 환경, 단일 리전/단순 마이크로서비스 구조</td></tr><tr><td><strong>2. 분산형 (Distributed)</strong></td><td>여러 지역 또는 인스턴스에 걸쳐 다수의 게이트웨이 배포</td><td>Load Balancer 를 통해 트래픽 분산</td><td>- 고가용성 (HA)<br>- 수평 확장 용이<br>- 장애 격리 가능</td><td>- 설정 동기화 필요<br>- 로그/모니터링 일관성 유지 어려움</td><td>글로벌 서비스, 대규모 트래픽 처리, 멀티 리전</td></tr><tr><td><strong>3. 계층형 (Layered)</strong></td><td>외부와 내부 요청을 구분하여 게이트웨이를 계층화</td><td>Edge Gateway + Internal Gateway</td><td>- 보안 강화 (경계 구분)<br>- 도메인 분리 가능<br>- 트래픽 제어 세분화</td><td>- 복잡도 증가<br>- 응답 지연 가능</td><td>금융/보안 서비스, 내부 API 분리 필요, DMZ 구성</td></tr><tr><td><strong>4. 마이크로게이트웨이 (Microgateway)</strong></td><td>각 마이크로서비스 또는 도메인에 소형 Gateway 부착</td><td>경량 게이트웨이 인스턴스를 각 서비스와 함께 배포</td><td>- 독립 배포/확장 가능<br>- 서비스 맞춤형 기능 적용<br>- 빠른 릴리스</td><td>- 정책 일관성 유지 어려움<br>- 기능 중복, 관리 오버헤드</td><td>DevOps 조직 구조, 셀 기반 구조 (Cell-based Architecture)</td></tr><tr><td><strong>5. 하이브리드 (Hybrid)</strong></td><td>위 아키텍처들을 요구사항에 맞게 조합</td><td>예: 중앙 + 마이크로게이트웨이 혼합</td><td>- 유연성 극대화<br>- 상황 맞춤 최적화 가능</td><td>- 설계 난이도 높음<br>- 운영 복잡성↑</td><td>다양한 트래픽 출처, 다양한 서비스 요구를 갖는 복합 시스템</td></tr></tbody></table><p>API 게이트웨이의 구조와 아키텍처는 조직의 특정 요구사항, 규모, 복잡성에 따라 달라질 수 있으며, 클라우드 환경에서는 관리형 서비스로 제공되는 경우도 많다.</p><h5 id=중앙-집중형-아키텍처-centralized-architecture>중앙 집중형 아키텍처 (Centralized Architecture)<a hidden class=anchor aria-hidden=true href=#중앙-집중형-아키텍처-centralized-architecture>#</a></h5><pre class=mermaid>flowchart TD
    C[Client] --&gt; G[&#34;API Gateway (단일 인스턴스)&#34;]
    G --&gt; S1[User Service]
    G --&gt; S2[Order Service]
    G --&gt; S3[Payment Service]
</pre><blockquote><p>특징: 단일 Gateway 에서 모든 요청을 수신·라우팅. 가장 단순한 형태.</p></blockquote><hr><h5 id=분산형-아키텍처-distributed-architecture>분산형 아키텍처 (Distributed Architecture)<a hidden class=anchor aria-hidden=true href=#분산형-아키텍처-distributed-architecture>#</a></h5><pre class=mermaid>flowchart TD
    C[Client] --&gt; LB[Load Balancer]
    LB --&gt; G1[API Gateway #1]
    LB --&gt; G2[API Gateway #2]
    LB --&gt; G3[API Gateway #3]

    G1 --&gt; S1[User Service]
    G2 --&gt; S2[Order Service]
    G3 --&gt; S3[Payment Service]
</pre><blockquote><p>특징: 여러 게이트웨이 인스턴스가 트래픽을 분산 처리, 고가용성 확보 가능.</p></blockquote><h5 id=계층형-아키텍처-layered-architecture>계층형 아키텍처 (Layered Architecture)<a hidden class=anchor aria-hidden=true href=#계층형-아키텍처-layered-architecture>#</a></h5><pre class=mermaid>flowchart TD
    C[Client] --&gt; EG[Edge Gateway]
    EG --&gt; IG[Internal Gateway]
    IG --&gt; S1[User Service]
    IG --&gt; S2[Inventory Service]
</pre><blockquote><p>특징: 외부와 내부를 분리, DMZ 구성 및 보안 경계 설정이 용이함.</p></blockquote><h5 id=마이크로게이트웨이-아키텍처-microgateway-architecture>마이크로게이트웨이 아키텍처 (Microgateway Architecture)<a hidden class=anchor aria-hidden=true href=#마이크로게이트웨이-아키텍처-microgateway-architecture>#</a></h5><pre class=mermaid>flowchart TD
    C1[Client A] --&gt; MG1[Microgateway A] --&gt; SA[Service A]
    C2[Client B] --&gt; MG2[Microgateway B] --&gt; SB[Service B]
    C3[Client C] --&gt; MG3[Microgateway C] --&gt; SC[Service C]
</pre><blockquote><p>특징: 각 서비스별 게이트웨이 독립 배포, 도메인 중심 개발에 적합.</p></blockquote><h5 id=하이브리드-아키텍처-hybrid-architecture>하이브리드 아키텍처 (Hybrid Architecture)<a hidden class=anchor aria-hidden=true href=#하이브리드-아키텍처-hybrid-architecture>#</a></h5><pre class=mermaid>flowchart TD
    C[Client] --&gt; GG[Global Gateway]
    GG --&gt; EG[Edge Gateway]
    EG --&gt; MG1[Microgateway A] --&gt; S1[Service A]
    EG --&gt; MG2[Microgateway B] --&gt; S2[Service B]
</pre><blockquote><p>특징: 계층형과 마이크로게이트웨이를 혼합, 요구사항에 따라 아키텍처를 조합 가능.</p></blockquote><h3 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h3><table><thead><tr><th>분류</th><th>구현 기법</th><th>정의 및 구성 요소</th><th>주요 목적/특징</th><th>실무 사례 및 적용 기술</th></tr></thead><tbody><tr><td><strong>1. 프록시 기반</strong></td><td>Reverse Proxy / L7 프록시</td><td>요청을 내부 서비스로 전달하는 프록시 서버 (L7 라우팅, TLS 종료 포함)</td><td>트래픽 분산, 인증 필터링, 보안 헤더, SSL 종료</td><td>NGINX, Envoy, HAProxy, Kong, Traefik</td></tr><tr><td></td><td>에지 게이트웨이 (Edge Gateway)</td><td>네트워크 에지에서 라우팅, 캐싱, 인증 수행. 경량화된 실행 환경에서 동작</td><td>에지 컴퓨팅 기반의 빠른 응답, 로컬 최적화</td><td>Cloudflare Workers, Lambda@Edge, Fastly</td></tr><tr><td></td><td>Ingress Controller</td><td>Kubernetes 에서 Ingress 리소스를 이용한 API Gateway 구현</td><td>클러스터 내부 서비스와 외부 트래픽 연결</td><td>NGINX Ingress, Traefik, Gloo Edge</td></tr><tr><td><strong>2. 런타임 구조 기반</strong></td><td>플러그인/필터 체인 기반</td><td>요청/응답 흐름에 기능을 삽입하는 플러그인 체인 (Lua, Wasm, JS 등으로 확장 가능)</td><td>인증, 속도제한, 트래픽 조작, 미들웨어 삽입</td><td>Kong (Lua), APISIX (Wasm, Lua), Tyk (JS)</td></tr><tr><td></td><td>미들웨어 기반 애플리케이션</td><td>비즈니스 로직 수준에서 라우팅, 필터링, 응답 가공 수행</td><td>복잡한 조건 분기, 커스텀 인증 및 데이터 처리</td><td>Spring Cloud Gateway, Express.js Gateway</td></tr><tr><td></td><td>오케스트레이션/응답 집계</td><td>다중 서비스 응답을 통합해 클라이언트에 반환 (Aggregator)</td><td>BFF, Composite Response, 최적화된 API 반환</td><td>BFF 패턴, GraphQL Gateway, API Composition</td></tr><tr><td><strong>3. 아키텍처 연동형</strong></td><td>서비스 메시 통합 Gateway</td><td>Istio/Linkerd 등 서비스 메시와 통합된 게이트웨이로 사이드카/컨트롤 플레인과 연계됨</td><td>서비스 간 트래픽 제어, 인증, 트레이싱 통합</td><td>Istio Ingress Gateway, Linkerd, Cilium + eBPF</td></tr><tr><td></td><td>마이크로게이트웨이 (Micro-GW)</td><td>개별 마이크로서비스에 특화된 경량 게이트웨이. 서비스 단위로 독립 배포</td><td>도메인 경계 최적화, 개별 서비스 특화 정책 적용</td><td>Express Gateway, Ambassador Edge Stack</td></tr><tr><td><strong>4. 배포 모델 기반</strong></td><td>클라우드 매니지드 Gateway</td><td>클라우드에서 완전 관리형으로 제공되는 API Gateway 서비스</td><td>인프라 운영 불필요, 자동 확장, 통합 보안</td><td>AWS API Gateway, Azure API Management, GCP API Gateway</td></tr><tr><td></td><td>서버리스 API Gateway</td><td>서버리스 함수 호출에 특화된 게이트웨이 (함수 라우팅, CORS, 속도 제한 자동 적용)</td><td>완전한 서버리스 통합, 사용량 기반 과금</td><td>AWS Lambda + API Gateway, Azure Consumption Tier</td></tr><tr><td></td><td>하이브리드 클라우드 Gateway</td><td>온프레미스 + 클라우드 환경을 연계하여 API 관리</td><td>환경 간 일관성 확보, 멀티리전 통합 관리</td><td>Red Hat 3scale, Kong Hybrid Mode</td></tr><tr><td><strong>5. 기능별 세부 기술</strong></td><td>데이터 변환/프로토콜 변환</td><td>REST↔gRPC, XML↔JSON 등 API 간 포맷/프로토콜 변환 수행</td><td>레거시 시스템 호환성 확보</td><td>gRPC Gateway, SOAP ↔ REST Adapter</td></tr><tr><td></td><td>캐싱 / 속도 제한 / 인증 / 로깅</td><td>API Gateway 기능 모듈화 (캐시, Rate Limiting, TLS, Metrics, APM 등 포함)</td><td>성능 최적화, 보안 강화, 운영 가시성 확보</td><td>Redis Cache, JWT Auth Plugin, Prometheus Metrics</td></tr><tr><td></td><td>CI/CD 및 구성 자동화</td><td>API 정의 파일 기반 자동화 배포 (OpenAPI, YAML, etcd 연동)</td><td>정책 일관성 유지, 자동 롤백 및 구성 관리</td><td>GitOps, Terraform + Helm, etcd 기반 구성 관리</td></tr></tbody></table><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th><th></th></tr></thead><tbody><tr><td><strong>1. 아키텍처적 이점</strong></td><td>단일 진입점</td><td>모든 API 요청을 하나의 게이트웨이에서 통제하여 복잡성 감소, 제어 포인트 단순화</td><td></td></tr><tr><td></td><td>서비스 추상화</td><td>클라이언트가 백엔드 구조나 위치, 프로토콜을 몰라도 API 를 사용할 수 있어 변경에 대한 영향 최소화</td><td></td></tr><tr><td></td><td>프로토콜 통합 및 추상화</td><td>REST, GraphQL, gRPC 등 다양한 프로토콜 변환을 통해 클라이언트와 백엔드 간 호환성 확보</td><td></td></tr><tr><td></td><td>API 버전 관리</td><td>여러 버전의 API 를 동시에 운영 가능하여 점진적 업그레이드 및 하위 호환성 유지 가능</td><td></td></tr><tr><td><strong>2. 보안 및 안정성</strong></td><td>중앙 보안 정책 적용</td><td>인증, 인가, TLS 종료, CORS, JWT 등의 보안 처리를 게이트웨이에서 통합 적용하여 일관된 보안 정책 유지</td><td></td></tr><tr><td></td><td>DDoS 방어 및 Rate Limiting</td><td>악의적 요청/과도한 요청을 제한하여 시스템 자원 보호 및 서비스 안정성 향상</td><td></td></tr><tr><td></td><td>Zero Trust 보안 적용</td><td>게이트웨이를 통한 모든 트래픽 검증으로 내부 네트워크도 신뢰하지 않는 보안 모델 적용 가능</td><td></td></tr><tr><td><strong>3. 성능 최적화</strong></td><td>캐싱</td><td>자주 요청되는 응답을 캐싱하여 백엔드 부담 감소 및 응답 속도 향상</td><td></td></tr><tr><td></td><td>응답 집계 (Aggregation)</td><td>여러 마이크로서비스의 응답을 하나로 합쳐 클라이언트에 전달함으로써 통신 비용 최소화</td><td></td></tr><tr><td></td><td>압축 및 연결 재사용</td><td>GZIP, HTTP Keep-Alive 등을 통한 응답 최적화</td><td></td></tr><tr><td></td><td>로드 밸런싱</td><td>백엔드 트래픽 분산을 통해 고가용성 및 확장성 확보</td><td></td></tr><tr><td><strong>4. 운영 및 관측성</strong></td><td>로깅 및 모니터링 통합</td><td>모든 API 요청/응답 정보를 중앙에서 기록하고 모니터링 가능하여 디버깅 및 SLA 보장 용이</td><td></td></tr><tr><td></td><td>분산 트레이싱 및 APM 연동</td><td>OpenTelemetry, Jaeger, Prometheus 등 연동을 통해 전체 시스템 관측 가능성 확보</td><td></td></tr><tr><td></td><td>정책 기반 구성 (Config-driven)</td><td>설정 파일 기반의 구성 및 자동화 배포로 운영 편의성 증가</td><td></td></tr><tr><td><strong>5. 확장성 및 유연성</strong></td><td>플러그인 아키텍처</td><td>Lua, Go 기반의 플러그인을 통해 동적으로 기능 확장 가능, 새로운 정책 적용이나 라우팅 로직도 쉽게 변경 가능</td><td></td></tr><tr><td></td><td>수평 확장 (Horizontal Scaling)</td><td>Kubernetes, 클러스터 기반 인프라와 연계하여 트래픽 증가 시 무중단 확장 가능</td><td></td></tr><tr><td></td><td>멀티 클라우드/하이브리드 연계</td><td>다양한 환경에서 일관된 API 정책 운영 가능</td><td></td></tr><tr><td><strong>6. 개발 생산성 및 유지보수</strong></td><td>공통 기능의 중앙 집중화</td><td>인증, 트래픽 제어, 로깅 등 반복적인 기능을 공통화하여 각 서비스 개발자는 비즈니스 로직에만 집중 가능</td><td></td></tr><tr><td></td><td>유지보수성 향상</td><td>내부 서비스 변경 시 외부 인터페이스가 고정되므로, API Gateway 만 수정하면 되며 마이크로서비스 영향 최소화</td><td></td></tr><tr><td></td><td>코드 중복 제거 및 표준화</td><td>인증, 포맷 변환, 에러 응답 처리 등의 로직을 게이트웨이에 집중시켜 개발팀 간 코드 일관성과 생산성 향상</td><td></td></tr></tbody></table><h3 id=6-단점과-문제점-그리고-해결방안>6 단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#6-단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결방안 및 대응 전략</th></tr></thead><tbody><tr><td><strong>단일 장애점</strong></td><td>SPOF (Single Point of Failure)</td><td>모든 요청이 게이트웨이를 거치기 때문에, 장애 시 전체 시스템 접근 불가</td><td>이중화 구성, 클러스터링, 헬스 체크 및 Fail-over, 지리적 다중 배치</td></tr><tr><td><strong>성능 병목</strong></td><td>트래픽 집중 → 지연 발생</td><td>모든 요청이 게이트웨이에 집중되어 처리 지연 및 병목 발생 가능</td><td>수평 확장, Auto Scaling, Edge Cache, Rate Limiting 적용</td></tr><tr><td><strong>복잡성 증가</strong></td><td>아키텍처/설정 관리 복잡도</td><td>인증, 정책, 로깅, 라우팅 등 다양한 기능이 한곳에 집중되며 설정 및 운영이 복잡해짐</td><td>IaC 적용, GitOps 기반 구성 자동화, 플러그인 기반 모듈화, 설정 검증 파이프라인 구축</td></tr><tr><td><strong>디버깅 어려움</strong></td><td>요청 경로 불투명</td><td>요청 흐름이 게이트웨이에서 은닉되므로 이슈 발생 시 경로 추적 및 원인 분석 어려움</td><td>OpenTelemetry 기반 분산 추적, APM 연동, 로깅 표준화</td></tr><tr><td><strong>비용 증가</strong></td><td>인프라 및 관리 비용</td><td>추가 컴퓨팅 자원, 관찰 도구, 정책 관리 등 운영 비용 증가</td><td>Auto-scaling, Serverless API Gateway, 리소스 최적화</td></tr><tr><td><strong>Vendor Lock-in</strong></td><td>특정 솔루션 종속성</td><td>상용 게이트웨이 솔루션 도입 시 플랫폼 전환이 어렵고 기술 종속이 발생</td><td>오픈소스 활용 (Kong, APISIX 등), OpenAPI 기반 표준화, API abstraction layer 적용</td></tr></tbody></table><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>원인</th><th>영향</th><th>탐지/진단 방법</th><th>예방 방안</th><th>해결 전략 및 기법</th></tr></thead><tbody><tr><td><strong>운영</strong></td><td>메모리 누수</td><td>캐시/커넥션 풀 미관리, GC 비효율</td><td>응답 지연, OOM, 게이트웨이 중단</td><td>메모리 프로파일링, 힙덤프, GC 로그 분석</td><td>TTL 최적화, 풀 크기 조정</td><td>커넥션 제한, 캐시 만료 설정, GC 튜닝</td></tr><tr><td></td><td>설정 불일치/드리프트</td><td>수동 설정 변경, 배포 누락</td><td>라우팅 오류, 인증 오류</td><td>설정 diff, 배포 파이프라인 검증</td><td>GitOps, IaC, Canary 배포 적용</td><td>설정 롤백 및 자동화 테스트 적용</td></tr><tr><td></td><td>과부하 / 스케일링 실패</td><td>예측 불가 트래픽, 수동 확장 설정</td><td>Time-out, 장애 발생</td><td>TPS, CPU, Latency 모니터링</td><td>Auto Scaling, Rate Limiting</td><td>캐시 적용, Scale-Out 구성</td></tr><tr><td></td><td>로깅 누락</td><td>로깅 설정 미비, 플러그인 누락</td><td>감사 실패, 트러블슈팅 실패</td><td>로그 누락률 분석, 경로별 로깅 확인</td><td>Fluentd, Loki, 표준 로깅 정책 적용</td><td>로그 전송 재시도, 로그 Level 자동 관리</td></tr><tr><td></td><td>장애 전파</td><td>백엔드 장애 미격리, 서킷 브레이커 미적용</td><td>전체 시스템 장애로 확산</td><td>응답 코드 분석, 트래픽 급증 탐지</td><td>Circuit Breaker, Bulkhead 패턴</td><td>자동 Failover, Fallback 응답 적용</td></tr><tr><td><strong>보안</strong></td><td>인증 실패 / 정책 미적용</td><td>토큰 만료, 키 유출, 인증서 오류</td><td>권한 오남용, 사용자 세션 끊김</td><td>인증 로그 분석, 실패율 이상 감지</td><td>HTTPS 적용, JWT 유효성 검증, mTLS 적용</td><td>Refresh Token 적용, OAuth2 연동</td></tr><tr><td></td><td>보안 위협 (공격/우회 등)</td><td>Rate Limit 우회, 인증 Bypass, DoS 등</td><td>데이터 유출, API 오용</td><td>WAF 로그, Rate 분석, IDS 연계</td><td>API Key Rotation, WAF, IP 필터링</td><td>정책 보강, 보안 플러그인 적용</td></tr><tr><td><strong>기능</strong></td><td>캐시 무효화/일관성 문제</td><td>TTL 설정 미비, 갱신 트리거 부재</td><td>오래된 응답 반환, 캐시 적중률 저하</td><td>캐시 로그, 히트율 모니터링</td><td>이벤트 기반 캐시 무효화, TTL 동적 조정</td><td>Redis 연동, API 응답 기반 캐시 삭제 트리거 적용</td></tr><tr><td></td><td>라우팅 오류</td><td>경로 설정 오류, 타이포</td><td>404/502 응답, 백엔드 접근 불가</td><td>Error 로그, 404 분석, 라우팅 테스트</td><td>선언적 설정 관리, 경로 단위 테스트 적용</td><td>Canary Routing, 디스커버리 자동화</td></tr></tbody></table><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><table><thead><tr><th>카테고리</th><th>도전 과제</th><th>설명</th><th>영향</th><th>원인 또는 유발 요인</th><th>대응 방안 및 해결 전략</th></tr></thead><tbody><tr><td><strong>1. 성능 / 확장성</strong></td><td>고부하 트래픽 대응</td><td>TPS 급증 시 지연, 응답 속도 저하 및 백엔드 부하 증가</td><td>SLA 위반, 사용자 경험 저하</td><td>라우팅 복잡성, 단일 인스턴스 한계, 네트워크 홉 증가</td><td>캐싱, 엣지 게이트웨이, CDN, HPA, gRPC, HTTP/3 도입</td></tr><tr><td></td><td>동적 오토스케일링</td><td>예측 불가능한 트래픽 패턴에 실시간 대응 필요</td><td>과잉 자원 사용 또는 성능 저하</td><td>정적 스케일링, 수요 예측 실패</td><td>Kubernetes HPA, 이벤트 기반 오토스케일링, 서킷 브레이커 도입</td></tr><tr><td></td><td>단일 장애점 (SPoF)</td><td>중앙 집중형 Gateway 구성 시 단일 장애로 전체 서비스 마비 가능</td><td>전체 API 호출 실패</td><td>이중화 미구현, 리전 분산 미흡</td><td>클러스터 구성, DNS Failover, Multi-Region 이중화</td></tr><tr><td></td><td>구성 동기화 어려움</td><td>다수의 인스턴스 간 설정 충돌, 일관성 불일치</td><td>무중단 배포 실패, 요청 누락</td><td>설정 불일치, 멀티노드 구성 미동기화</td><td>GitOps, etcd/Consul 등 중앙 설정 레지스트리 사용</td></tr><tr><td><strong>2. 보안 / 인증</strong></td><td>인증·인가 복잡성 관리</td><td>다양한 서비스별 인증 요구사항 관리 및 권한 차등 처리의 어려움</td><td>보안 취약점 발생, 서비스 접근 오류</td><td>분산된 인증 로직, 수동 키/토큰 관리</td><td>Zero Trust, OAuth2, mTLS, 짧은 TTL 토큰, JWKS 자동화</td></tr><tr><td></td><td>인증 토큰 위변조</td><td>JWT 위조나 만료된 토큰 재사용으로 인한 보안 침해 가능</td><td>민감 데이터 노출, 인증 우회</td><td>암호화 미흡, 토큰 검증 누락</td><td>토큰 서명 검증, 암호화, 자동화된 키 재발급</td></tr><tr><td></td><td>정책 일관성 및 충돌 문제</td><td>플러그인/인증 정책 중복, 우선순위 불명확으로 인한 보안 설정 오류</td><td>보안 정책 누락, 운영 리스크 증가</td><td>분산 정책 관리, 정책 충돌</td><td>정책 CI/CD 적용, 정책 레이어 정규화</td></tr><tr><td><strong>3. 운영 / 관측성</strong></td><td>장애 원인 추적 어려움</td><td>장애 발생 시 API 흐름 단절, 호출 실패 원인 파악 어려움</td><td>MTTR 증가, 고객 이탈 가능성</td><td>로깅 미흡, 트레이싱 누락, 구조화되지 않은 로그 사용</td><td>OpenTelemetry, 분산 트레이싱, Structured Logging, APM 연동</td></tr><tr><td></td><td>설정 관리 및 환경 불일치</td><td>환경별 설정 차이, 수작업 변경으로 오류 발생</td><td>운영 중단, 릴리즈 실패</td><td>수동 구성, 배포 자동화 미흡</td><td>GitOps, Config 검증 파이프라인, 단계적 롤아웃</td></tr><tr><td></td><td>로그 및 메트릭 표준화 부족</td><td>로그 포맷 불일치, 서비스 간 메트릭 연계 어려움</td><td>운영 복잡도 증가, 경보 누락</td><td>관측 도구 미통합, 표준 미정의</td><td>표준 로깅/메트릭 포맷, Prometheus/Grafana/Jaeger 연계</td></tr><tr><td><strong>4. API 수명주기 관리</strong></td><td>버전 관리 및 호환성</td><td>다양한 클라이언트 버전 공존 시, 테스트 및 배포 복잡도 증가</td><td>API 혼선, 하위 호환성 미비</td><td>명확한 버전 전략 미수립, URI 관리 부재</td><td><code>/v1/</code>, <code>/v2/</code> 경로 버전 관리, GraphQL 도입, 버전별 게이트웨이 분리</td></tr><tr><td></td><td>문서화 및 스펙 관리 자동화</td><td>API 문서와 실제 구현 불일치 발생 가능성 높음</td><td>개발자 혼란, 연동 실패</td><td>수동 문서화, OpenAPI 연동 미흡</td><td>Swagger, OpenAPI 기반 문서 자동화, 테스트 기반 문서 생성 도구 사용</td></tr><tr><td></td><td>API 수명주기 불일치 관리</td><td>서비스별 배포 주기 차이로 인한 API 동작 불일치</td><td>통합 테스트 오류, 시스템 불안정</td><td>마이크로서비스별 독립 배포, 통합 테스트 부재</td><td>API Gateway 기반 테스트 환경 분리, Canary Release, B/G Deployment</td></tr><tr><td><strong>5. 아키텍처 / 기술 연계</strong></td><td>다양한 프로토콜/데이터 형식 지원</td><td>REST, gRPC, WebSocket 등 다양한 프로토콜 지원의 어려움</td><td>연동 실패, 프로토콜 불일치 오류</td><td>변환 로직 부재, 게이트웨이 한계</td><td>프로토콜 애그노스틱 설계, API Adapter 또는 Transformer 구성</td></tr><tr><td></td><td>레거시 시스템 통합</td><td>기존 SOAP, XML 시스템과의 연계 시 요구사항 차이 존재</td><td>마이그레이션 비용 증가, 연동 지연</td><td>포맷 불일치, 인증 방식 불일치</td><td>중간 Adapter 구성, 포맷 변환 로직 구현</td></tr><tr><td></td><td>서비스 디스커버리 연동</td><td>다이나믹 환경에서의 서비스 위치 자동 탐색 어려움</td><td>라우팅 실패, 환경 차이로 인한 설정 누락</td><td>정적 라우팅, DNS 기반 탐색 한계</td><td>Consul, Istio, Kubernetes DNS 기반 서비스 디스커버리 사용</td></tr><tr><td><strong>6. 자동화 / 배포 전략</strong></td><td>정책 자동화 및 통합 관리</td><td>인증, 보안, 라우팅 정책 배포 시 수작업 반복 발생</td><td>운영 비용 증가, 오류 확률 상승</td><td>정책 관리 표준 미비, UI 기반 운영 의존</td><td>CI/CD, IaC, 정책 템플릿화, API Policy Registry 구축</td></tr><tr><td></td><td>무중단 배포 및 릴리즈 전략</td><td>설정/정책 변경 시 전체 API 영향을 줄 가능성 있음</td><td>배포 중 장애, 사용자 요청 손실</td><td>배포 자동화 부재, 트래픽 분할 미비</td><td>Canary, Blue/Green Deployment, Circuit Breaker 적용</td></tr><tr><td></td><td>플러그인 확장 시 복잡도 증가</td><td>게이트웨이 기능 확장을 위한 플러그인 간 충돌 또는 의존성 문제</td><td>테스트 실패, 정책 충돌</td><td>검증 프로세스 부재, 라이프사이클 미통합</td><td>플러그인 검증 파이프라인, Dependency 체크 자동화</td></tr><tr><td><strong>7. 조직 / 문화 / 기술역량</strong></td><td>기술 격차 및 운영 역량 부족</td><td>게이트웨이 기술에 대한 내부 역량 부족</td><td>기능 누락, 보안 설정 오류</td><td>학습 부족, 담당자 의존</td><td>내부 교육, 문서화, Best Practice 가이드 구축</td></tr><tr><td></td><td>API 중심 문화 정착 어려움</td><td>조직 내 API 활용 및 연계 문화 부족</td><td>협업 비효율, API 남용 또는 무관심</td><td>문화 정착 부족, 책임 영역 불명확</td><td>API 카탈로그, API 소비자 - 제공자 인터페이스 정착, API 거버넌스 모델 도입</td></tr></tbody></table><h4 id=도전-과제--기술적-해결-방안-매핑-테이블>도전 과제 → 기술적 해결 방안 매핑 테이블<a hidden class=anchor aria-hidden=true href=#도전-과제--기술적-해결-방안-매핑-테이블>#</a></h4><table><thead><tr><th>도전 과제</th><th>기술적 해결 방안</th><th>관련 도구/기술 스택 예시</th></tr></thead><tbody><tr><td><strong>고부하 트래픽 대응 / 성능 병목</strong></td><td>- 응답 캐싱<br>- 엣지 게이트웨이 분산 배치<br>- gRPC/HTTP3 도입<br>- CDN 통합<br>- Connection Pooling</td><td>Redis, CloudFront, NGINX, Envoy, gRPC, QUIC</td></tr><tr><td><strong>트래픽 예측 불가로 인한 스케일링 실패</strong></td><td>- Kubernetes HPA<br>- 예측 기반 오토스케일링<br>- Event-driven Autoscaling</td><td>KEDA, HPA, Prometheus + AlertManager</td></tr><tr><td><strong>단일 장애점 (SPoF)</strong></td><td>- Gateway 이중화 구성<br>- DNS 기반 Failover<br>- Multi-Region 배포</td><td>NGINX Cluster, AWS Route53, GCP Global Load Balancer</td></tr><tr><td><strong>구성 동기화 및 설정 충돌</strong></td><td>- GitOps 기반 구성 관리<br>- 중앙 설정 저장소 사용<br>- 설정 검증 파이프라인</td><td>ArgoCD, Flux, etcd, Consul, HashiCorp Vault</td></tr><tr><td><strong>인증·인가 정책 복잡성 증가</strong></td><td>- 중앙 인증서버 연동<br>- JWT TTL 설정<br>- OAuth2 Provider 연계</td><td>Keycloak, Auth0, AWS Cognito, Okta</td></tr><tr><td><strong>토큰 위조/재사용 등 보안 위협</strong></td><td>- JWKS 기반 서명 검증<br>- 토큰 짧은 TTL 설정<br>- mTLS 사용</td><td>OAuth2, JWT, JWKS, Mutual TLS</td></tr><tr><td><strong>정책 일관성 부족 및 충돌</strong></td><td>- 정책 통합 레이어 정의<br>- 정책 템플릿화<br>- 정책 CI/CD 도입</td><td>Open Policy Agent (OPA), Rego, Kong Plugins CI</td></tr><tr><td><strong>장애 시 추적 불가 (관측성 부족)</strong></td><td>- 분산 트레이싱 연동<br>- 구조화 로깅 적용<br>- 실시간 메트릭 수집</td><td>OpenTelemetry, Jaeger, Grafana Loki, Fluent Bit</td></tr><tr><td><strong>환경별 설정 차이로 인한 운영 오류</strong></td><td>- 환경별 설정 분리 관리<br>- Config 검증 파이프라인<br>- Canary Release 적용</td><td>Helm + Kustomize, Argo Rollouts, GitOps CI/CD</td></tr><tr><td><strong>API 버전 관리 어려움</strong></td><td>- URI 버전 전략<br>- GraphQL 도입<br>- 버전별 Route 분리</td><td><code>/v1/</code>, <code>/v2/</code>, Apollo Federation</td></tr><tr><td><strong>문서화 / 스펙 동기화 누락</strong></td><td>- OpenAPI 기반 자동 문서화<br>- 코드 기반 명세 생성</td><td>Swagger, ReDoc, Stoplight Studio, FastAPI Docs</td></tr><tr><td><strong>다양한 프로토콜 지원의 어려움</strong></td><td>- 게이트웨이 내 프로토콜 변환 계층 구성<br>- 프로토콜 애그노스틱 라우팅</td><td>Kong Gateway, Envoy, Tyk, gRPC ↔ REST Adapter</td></tr><tr><td><strong>레거시 시스템 연동</strong></td><td>- XML ↔ JSON 변환기 도입<br>- API Adapter 구성<br>- 인증 Proxy 도입</td><td>Ballerina, Camel, WSO2 Adapter</td></tr><tr><td><strong>정책 배포 자동화 부재</strong></td><td>- API 정책 템플릿화<br>- Git 기반 정책 관리<br>- 배포 자동화 파이프라인</td><td>Terraform, Ansible, Pulumi, GitHub Actions + Helm</td></tr><tr><td><strong>무중단 배포 어려움</strong></td><td>- Canary, Blue/Green 배포 전략<br>- 트래픽 분할 및 서킷 브레이커 적용</td><td>Argo Rollouts, Istio Traffic Shifting, Resilience4j</td></tr><tr><td><strong>플러그인 확장 시 충돌</strong></td><td>- Lifecycle 관리 도입<br>- 플러그인 의존성 검사 자동화</td><td>Kong PluginHub, NGINX Lua Module, OPA + Rego Validation</td></tr><tr><td><strong>서비스 디스커버리 미지원 또는 오류</strong></td><td>- 동적 서비스 등록/탐색 구성<br>- DNS 기반 탐색 보완</td><td>Consul, Kubernetes DNS, Istio Service Registry</td></tr><tr><td><strong>레거시 마이그레이션 전략 부재</strong></td><td>- API Gateway Proxy 전략<br>- 점진적 트래픽 전환<br>- 단계적 분해</td><td>Strangler Fig Pattern, API Composition via BFF</td></tr><tr><td><strong>비용 증가 / 비효율적인 자원 사용</strong></td><td>- 요청 기반 오토스케일링<br>- Edge 컴퓨팅 연계<br>- 게이트웨이 로깅 분리 저장</td><td>AWS Lambda@Edge, Google Cloud Functions, Loki</td></tr><tr><td><strong>팀 기술역량 부족 / 도입 저항</strong></td><td>- 내부 문서화 체계 수립<br>- 개발자 온보딩 가이드<br>- 운영 Best Practice 공유</td><td>Confluence, API Design Handbook, Developer Portal 구축</td></tr><tr><td><strong>정책 감사/규제 준수 미흡</strong></td><td>- 감사 로그 활성화<br>- WAF 및 정책 감사 도구 연동</td><td>Audit Log, AWS WAF, Kong Enterprise Analytics</td></tr></tbody></table><h3 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th><strong>분류 기준</strong></th><th><strong>유형</strong></th><th><strong>설명</strong></th><th><strong>대표 사례</strong></th></tr></thead><tbody><tr><td><strong>1. 배포 모델</strong></td><td>온프레미스 (On-Premise)</td><td>조직의 자체 인프라에 설치되어 독립적으로 운영</td><td>Kong OSS, Tyk OSS, NGINX, Apiman</td></tr><tr><td></td><td>클라우드 관리형 (Managed Cloud)</td><td>AWS/GCP/Azure 등 퍼블릭 클라우드에서 제공하는 완전 관리형 API Gateway</td><td>AWS API Gateway, Azure API Management, GCP API Gateway</td></tr><tr><td></td><td>하이브리드 (Hybrid)</td><td>온프레미스와 클라우드의 혼합 운영 환경 지원</td><td>Apigee Hybrid, Red Hat 3scale</td></tr><tr><td></td><td>멀티클라우드</td><td>여러 클라우드 환경에 걸쳐 API 를 운영 및 관리</td><td>Kong Konnect, Mulesoft Anypoint Platform</td></tr><tr><td><strong>2. 아키텍처 구조</strong></td><td>중앙 집중형 (Centralized)</td><td>단일 인스턴스가 전체 API 트래픽을 처리</td><td>NGINX, AWS API Gateway</td></tr><tr><td></td><td>분산형 (Distributed / Microgateway)</td><td>각 도메인/서비스별 게이트웨이를 운영</td><td>Express Gateway, Ambassador, Edge Stack</td></tr><tr><td></td><td>계층형 (Tiered)</td><td>Edge ↔ Core ↔ Internal Gateway 로 계층 구분</td><td>Cloudflare → NGINX → Spring Gateway 구성 등</td></tr><tr><td></td><td>메시 기반 (Service Mesh 연동)</td><td>Service Mesh 와 통합되어 Ingress 또는 Sidecar 형태로 동작</td><td>Istio Gateway, Linkerd + Envoy</td></tr><tr><td><strong>3. 구현 방식</strong></td><td>하드웨어 어플라이언스</td><td>고성능 네트워크 장비 형태의 API Gateway</td><td>F5 BIG-IP, Imperva SecureSphere</td></tr><tr><td></td><td>소프트웨어 기반 (애플리케이션)</td><td>소프트웨어 프레임워크나 서버에서 동작</td><td>Spring Cloud Gateway, Express Gateway, FastAPI Middleware</td></tr><tr><td></td><td>서버리스 기반 (Serverless)</td><td>FaaS 와 함께 작동하며 인프라 관리가 필요 없음</td><td>AWS API Gateway + Lambda, Azure Functions</td></tr><tr><td></td><td>내장형 라이브러리</td><td>앱 내부에서 직접 라우팅, 인증, 필터 처리</td><td>Flask Middleware, Express.js 라우터</td></tr><tr><td><strong>4. 기능 범위</strong></td><td>라우팅 전용 (L7 프록시)</td><td>경로 기반 라우팅 및 SSL 종료 등 기본 기능만 제공</td><td>HAProxy, NGINX, Traefik</td></tr><tr><td></td><td>확장형 (플러그인 지원)</td><td>인증, 트래픽 제어, 보안 정책 등 고급 기능을 플러그인으로 제공</td><td>Kong, APISIX, Tyk</td></tr><tr><td></td><td>API 관리 통합형 (Full-featured)</td><td>API 수명주기 관리, 포털, 문서화, 과금, 보안 통합</td><td>Apigee, Azure API Management, Mulesoft</td></tr><tr><td><strong>5. 기능 확장 방식</strong></td><td>플러그인 기반</td><td>미리 정의된/사용자 정의 플러그인으로 기능 확장</td><td>Kong (Lua), APISIX (Wasm), Tyk (JS/Go)</td></tr><tr><td></td><td>구성 기반</td><td>YAML, JSON 등 선언적 구성파일 또는 DB 로 구성</td><td>Spring Cloud Gateway, Traefik</td></tr><tr><td></td><td>코드 기반</td><td>직접 로직을 구현하여 인증, 변환, 응답 처리 등 수행</td><td>Express Middleware, Fastify Hook, Go Gateway 구현</td></tr><tr><td><strong>6. 통신 프로토콜</strong></td><td>HTTP 전용</td><td>REST 기반 HTTP 트래픽만 지원</td><td>대부분 기본 API Gateway 솔루션</td></tr><tr><td></td><td>멀티 프로토콜 지원</td><td>REST, gRPC, WebSocket, GraphQL 등 다양한 프로토콜 처리 지원</td><td>Envoy, APISIX, Ambassador, Gloo</td></tr><tr><td><strong>7. 통합 위치</strong></td><td>에지 게이트웨이 (Edge Gateway)</td><td>CDN, 에지 노드 등 사용자와 가까운 위치에서 트래픽 처리</td><td>Cloudflare Workers, Lambda@Edge, Fastly Compute@Edge</td></tr><tr><td></td><td>내부 게이트웨이 (Internal Gateway)</td><td>내부 마이크로서비스 간 통신을 위한 게이트웨이</td><td>Istio Gateway, Gloo, NGINX Ingress</td></tr><tr><td></td><td>API 통합 인그레스</td><td>클러스터 외부에서 내부로의 진입 지점을 관리</td><td>Kubernetes Ingress Controller (NGINX, Traefik, Istio)</td></tr><tr><td><strong>8. 특화 용도</strong></td><td>마이크로서비스 전용</td><td>서비스 분해에 최적화된 라우팅 및 인증 처리</td><td>Spring Cloud Gateway, Ambassador</td></tr><tr><td></td><td>IoT 최적화</td><td>장치 연결 및 데이터 처리에 최적화된 경량 게이트웨이</td><td>AWS IoT Core, Azure IoT Hub</td></tr><tr><td></td><td>모바일 백엔드 지원</td><td>BaaS 및 모바일 전용 인증/속도 최적화 기능 포함</td><td>Firebase, AWS Amplify</td></tr><tr><td></td><td>서버리스 환경 통합</td><td>Lambda, Cloud Functions 와의 연계 및 호출 최적화</td><td>AWS API Gateway with Lambda</td></tr><tr><td><strong>9. 라이선스 모델</strong></td><td>오픈소스 (OSS)</td><td>무료로 사용 가능하며 커뮤니티 주도 개발</td><td>Kong Community, APISIX, Traefik</td></tr><tr><td></td><td>상용 (Enterprise)</td><td>라이선스 기반의 상업적 게이트웨이, 고급 기능 제공</td><td>Kong Enterprise, Apigee, IBM API Connect</td></tr><tr><td></td><td>SaaS 기반</td><td>클라우드 기반 구독형 서비스로 게이트웨이 제공</td><td>AWS API Gateway, Azure API Management (SaaS 형태 운영 시)</td></tr><tr><td></td><td>하이브리드 (오픈코어 모델)</td><td>오픈소스 코어 + 엔터프라이즈 확장 기능</td><td>Tyk Hybrid, Kong Hybrid Mode</td></tr></tbody></table><ul><li><strong>배포 모델</strong>은 조직의 인프라 환경 결정 요소 (온프레미스 vs 클라우드)</li><li><strong>아키텍처 구조</strong>는 시스템 규모 및 팀 분할 구조와 연계</li><li><strong>기능 확장성</strong>은 인증, 보안, 가시성 통합 여부 판단 기준</li><li><strong>통신 프로토콜/통합 위치</strong>는 API 성격과 요청 특성에 따라 달라짐</li><li><strong>라이선스/특화 영역</strong>은 예산, 법적 요구사항, B2B 연계 고려 시 중요</li></ul><h3 id=api-gateway-기술-비교>API Gateway 기술 비교<a hidden class=anchor aria-hidden=true href=#api-gateway-기술-비교>#</a></h3><table><thead><tr><th>항목</th><th>클라우드 매니지드형</th><th>오픈소스형</th><th>내장형 라이브러리형</th></tr></thead><tbody><tr><td>예시</td><td>AWS API Gateway, Azure API Management</td><td>Kong, Tyk, Envoy, Apigee</td><td>Express Gateway, Spring Cloud Gateway</td></tr><tr><td>배포 위치</td><td>Fully Managed (서버리스)</td><td>자가 호스팅 또는 쿠버네티스 연동</td><td>앱 내부 혹은 자체 서버</td></tr><tr><td>확장성</td><td>자동 확장 지원</td><td>수동 설정 필요 / 쿠버네티스 연동 시 자동화 가능</td><td>제한적 (코드 레벨 확장 중심)</td></tr><tr><td>설정 난이도</td><td>쉬움 (GUI + IaC 제공)</td><td>중간 (설정 복잡도 존재)</td><td>쉬움 (코드 기반 정의)</td></tr><tr><td>플러그인 지원</td><td>제한적 (사전정의된 기능 위주)</td><td>풍부한 커뮤니티 및 공식 플러그인</td><td>미들웨어 직접 작성 필요</td></tr><tr><td>유스케이스</td><td>서버리스 환경, 빠른 배포</td><td>고유 요구사항 대응, 커스터마이징</td><td>경량화, 빠른 개발 및 테스트용</td></tr></tbody></table><h4 id=주요-api-gateway-제품-비교>주요 API Gateway 제품 비교<a hidden class=anchor aria-hidden=true href=#주요-api-gateway-제품-비교>#</a></h4><table><thead><tr><th>제품</th><th>배포 방식</th><th>확장 방식</th><th>특징</th><th>기업용 적합성</th></tr></thead><tbody><tr><td><strong>Kong Gateway</strong></td><td>오픈소스 / SaaS</td><td>플러그인 기반 (Lua)</td><td>고성능, DevOps 친화</td><td>★★★★★</td></tr><tr><td><strong>NGINX API Gateway</strong></td><td>온프레미스</td><td>구성 기반</td><td>경량 프록시, 커스터마이징 용이</td><td>★★★★☆</td></tr><tr><td><strong>AWS API Gateway</strong></td><td>Fully Managed</td><td>구성 기반</td><td>Lambda 연계 최적화</td><td>★★★★★</td></tr><tr><td><strong>Azure API Management</strong></td><td>Fully Managed</td><td>구성 기반</td><td>Portal + 보안 통합</td><td>★★★★☆</td></tr><tr><td><strong>Google API Gateway</strong></td><td>Fully Managed</td><td>구성 기반</td><td>IAM 연동, ESP 통합</td><td>★★★☆☆</td></tr><tr><td><strong>Apigee (Google)</strong></td><td>SaaS</td><td>정책 기반</td><td>API 분석/보안 특화</td><td>★★★★★</td></tr><tr><td><strong>Tyk Gateway</strong></td><td>오픈소스 / SaaS</td><td>플러그인 기반 (Go)</td><td>다중 인증 지원, 유연한 구성</td><td>★★★★☆</td></tr><tr><td><strong>Traefik</strong></td><td>경량 컨테이너 게이트웨이</td><td>구성 기반 (YAML)</td><td>Kubernetes/ServiceMesh 연동 우수</td><td>★★★☆☆</td></tr></tbody></table><h3 id=api-gateway-vs-service-mesh>API Gateway vs. Service Mesh<a hidden class=anchor aria-hidden=true href=#api-gateway-vs-service-mesh>#</a></h3><table><thead><tr><th>항목</th><th>API Gateway</th><th>Service Mesh</th></tr></thead><tbody><tr><td>위치</td><td>클라이언트와 서비스 사이</td><td>서비스와 서비스 사이</td></tr><tr><td>대상</td><td>외부 요청 처리</td><td>내부 서비스 간 통신 제어</td></tr><tr><td>주요 기능</td><td>인증, 라우팅, 속도 제한, 캐싱</td><td>서비스 간 보안, 트래픽 제어, 관찰성</td></tr><tr><td>대표 기술</td><td>Kong, Apigee, AWS API Gateway</td><td>Istio, Linkerd, Consul Connect</td></tr><tr><td>트래픽 범위</td><td>North-South 트래픽</td><td>East-West 트래픽</td></tr></tbody></table><blockquote><p>둘은 상호 보완적으로 사용 가능. API Gateway 는 외부 유입 요청 제어, Service Mesh 는 내부 마이크로서비스 통신 제어가 주된 목적.</p></blockquote><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>카테고리</th><th>고려사항</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td><strong>1. 아키텍처 설계</strong></td><td>단일 장애점 방지</td><td>중앙집중형 구조로 인한 SPOF 위험</td><td>다중 인스턴스 구성, 지역 분산 배포, DNS 기반 장애 조치 구성</td></tr><tr><td></td><td>게이트웨이 역할 정의</td><td>과도한 로직 위임은 유지보수 복잡성 증가</td><td>인증, 보안, 라우팅 등 공통 관심사 중심으로 설계, 비즈니스 로직은 백엔드에 위임</td></tr><tr><td></td><td>적합한 게이트웨이 선택</td><td>기술 스택과 운영 환경에 맞는 도구 선택 필요</td><td>Kong, Envoy, NGINX 등 비교 후 요구사항 기반 선택</td></tr><tr><td><strong>2. 성능 최적화</strong></td><td>지연 시간 최소화</td><td>네트워크 홉 증가에 따른 성능 저하 가능성</td><td>HTTP/2, QUIC, 커넥션 풀링, 지역 분산 라우팅 적용</td></tr><tr><td></td><td>캐싱 전략</td><td>잘못된 캐싱은 데이터 불일치 또는 성능 저하 유발</td><td>TTL 설정, 콘텐츠 기반 캐싱, CDN + Redis 연계</td></tr><tr><td></td><td>트래픽 제어</td><td>백엔드 부하 과도 시 시스템 전반에 영향</td><td>Rate Limiting, QoS, Circuit Breaker 적용</td></tr><tr><td><strong>3. 보안 및 인증</strong></td><td>인증/인가 통합 관리</td><td>서비스별 인증 방식 상이 시 통합 어려움</td><td>OAuth2, JWT, API Key 기반 정책 일관화</td></tr><tr><td></td><td>토큰 및 키 관리</td><td>토큰 위변조 및 키 유출 방지 필요</td><td>TTL 제한, 리프레시 토큰, JWKS, 비밀관리 솔루션 (Vault 등) 연동</td></tr><tr><td></td><td>TLS/HTTPS 구성</td><td>암호화 부재 시 보안 취약</td><td>SSL 종료 설정, 내부 mTLS 적용, TLS 최신 버전 사용</td></tr><tr><td></td><td>WAF 및 DoS 방어</td><td>외부 공격에 대한 실시간 대응 필요</td><td>Web Application Firewall, IP 필터링, 인증 우선 처리</td></tr><tr><td><strong>4. 운영 관리</strong></td><td>설정 및 구성 관리</td><td>환경별 설정 충돌 또는 수동 변경 위험</td><td>GitOps 기반 구성, IaC 도구 (Terraform, Helm), 검증된 릴리즈 전략 적용</td></tr><tr><td></td><td>배포 전략</td><td>배포 중 오류 발생 시 전체 장애 유발 가능성</td><td>Blue/Green, Canary 배포, 자동 롤백 전략</td></tr><tr><td></td><td>모니터링 및 추적</td><td>문제 진단이 어려울 수 있음</td><td>OpenTelemetry, Prometheus, Grafana, 구조화된 로깅, 분산 트레이싱</td></tr><tr><td></td><td>로깅 및 데이터 볼륨 관리</td><td>로그 과다 수집으로 인한 리소스 낭비 가능성</td><td>로그 샘플링, 로그 수집 필터링, ELK 스택 적용</td></tr><tr><td><strong>5. 확장성 및 가용성</strong></td><td>수평 확장 전략</td><td>트래픽 증가 시 확장 유연성 확보 필요</td><td>Stateless 설계, Auto Scaling, HPA, KEDA 연동</td></tr><tr><td></td><td>세션 상태 관리</td><td>상태 저장 구성 시 수평 확장에 제약</td><td>세션 외부 저장소 (Redis 등) 사용, JWT 기반 인증</td></tr><tr><td></td><td>고가용성 구성</td><td>장애 시 빠른 복구 보장 필요</td><td>Multi-Zone 배포, DNS Failover, Regional Clustering</td></tr><tr><td><strong>6. API 수명주기 관리</strong></td><td>버전 관리 전략</td><td>다양한 클라이언트 버전 공존 시 복잡성 증가</td><td>URI 버전 분리 (<code>/v1/</code>, <code>/v2/</code>), GraphQL 도입</td></tr><tr><td></td><td>API 문서화 자동화</td><td>문서 - 코드 불일치 발생 가능성</td><td>Swagger, OpenAPI 연동, Dev Portal 운영</td></tr><tr><td></td><td>API 변경 전략</td><td>변경 시 연동 서비스에 영향 가능</td><td>Deprecation 정책 수립, 알림 시스템, 하위 호환 유지 전략</td></tr><tr><td><strong>7. 거버넌스 및 컴플라이언스</strong></td><td>정책 관리 자동화</td><td>인증, 보안, 트래픽 정책 반복 수동 변경</td><td>Policy-as-Code, 정책 템플릿, Rego/OPA 기반 검증</td></tr><tr><td></td><td>감사 및 규제 대응</td><td>로그 누락 및 감사 트래킹 부재 시 위험</td><td>정책 변경 기록, 감사 로그 저장소 구성, 컴플라이언스 도구 통합</td></tr><tr><td></td><td>SLA/SLO 준수</td><td>서비스 품질 기준 불명확 시 혼선 발생</td><td>SLA 정의, 모니터링 지표 연결, SLA 위반 알림 시스템 도입</td></tr><tr><td><strong>8. 개발자 경험 및 협업</strong></td><td>API 일관성</td><td>설계 일관성 부재 시 이해도 저하</td><td>API 디자인 가이드 수립, REST/GraphQL 표준 적용</td></tr><tr><td></td><td>온보딩 프로세스</td><td>개발자 교육 및 진입 장벽 높을 수 있음</td><td>셀프서비스 포털, 샘플 코드 제공, Swagger UI 등 연계</td></tr><tr><td></td><td>피드백 루프 부족</td><td>사용자 요구사항 반영 어려움</td><td>피드백 채널 구축, 사용자 분석 기반 API 개선</td></tr><tr><td></td><td>조직 내 책임 소재</td><td>역할 불분명 시 유지보수 공백 발생</td><td>API 소유권 명확화, 팀 간 명세 공유, 협업 체계 문서화</td></tr></tbody></table><h3 id=최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>최적화 대상</strong></th><th><strong>설명</strong></th><th><strong>권장사항</strong></th></tr></thead><tbody><tr><td><strong>1. 캐싱 전략</strong></td><td>응답 캐싱</td><td>백엔드 호출을 줄이기 위해 동일 요청 결과를 캐시</td><td>TTL 설정, Redis/Edge 캐싱, 클라이언트/게이트웨이/CDN 다계층 캐싱</td></tr><tr><td></td><td>캐시 키 설계</td><td>키 충돌/저효율을 방지하기 위한 캐시 키 전략</td><td>정규화된 URL 기반 키, 쿼리 파라미터 필터링</td></tr><tr><td></td><td>캐시 무효화</td><td>오래된 데이터 응답 방지를 위한 무효화 전략</td><td>TTL+ 이벤트 기반 무효화, Smart revalidation</td></tr><tr><td><strong>2. 라우팅 최적화</strong></td><td>경로 탐색 알고리즘</td><td>라우팅 지연 감소를 위한 효율적 경로 탐색</td><td>라디엑스 트리, 정규화된 패턴 매칭</td></tr><tr><td></td><td>동적 라우팅 / 패턴 매칭</td><td>동적 API 등록 및 요청 패턴 최적화</td><td>경로 캐싱, 프리픽스 기반 탐색</td></tr><tr><td></td><td>백엔드 선택</td><td>고가용성/지연 최소화를 위한 백엔드 라우팅 전략</td><td>상태 기반 라우팅, 레이턴시 기반 선택, 근접성 라우팅</td></tr><tr><td></td><td>서비스 디스커버리</td><td>비효율적인 동기식 디스커버리로 인한 지연 방지</td><td>결과 캐싱, 백그라운드 갱신, 장애 감지 통합</td></tr><tr><td><strong>3. 트래픽 관리</strong></td><td>속도 제한 (Rate Limiting)</td><td>요청 과부하 방지 및 트래픽 제어</td><td>분산 Rate Limit (token/leaky bucket), 정책 기반 셰이핑</td></tr><tr><td></td><td>트래픽 셰이핑</td><td>일시적 트래픽 급증 시 백엔드 보호</td><td>버스트 처리 허용치 설정, 큐잉 및 점진적 릴리스</td></tr><tr><td></td><td>부하 분산</td><td>특정 인스턴스 집중 처리 방지</td><td>Round Robin, IP Hash, 상태 기반 분산, Adaptive Routing</td></tr><tr><td><strong>4. 연결 및 네트워크</strong></td><td>Keep-Alive / 커넥션 풀링</td><td>TCP 연결 재사용으로 연결 설정 비용 절감</td><td>연결 수 제한, 풀 크기 최적화, 유휴 타임아웃 설정</td></tr><tr><td></td><td>압축 및 프로토콜 최적화</td><td>전송 크기와 지연 시간 축소</td><td>gzip, Brotli, HTTP/2, gRPC 사용</td></tr><tr><td></td><td>CDN 및 엣지 배포</td><td>지리적 최적화 및 정적 자원 로컬화</td><td>Cloudflare, AWS CloudFront, 지역 분산 게이트웨이</td></tr><tr><td><strong>5. 비동기 및 병렬성</strong></td><td>요청 처리 모델</td><td>동시 처리량 향상을 위한 구조 설계</td><td>이벤트 루프 기반 처리 (Node.js, Go), 비동기 큐 연동</td></tr><tr><td></td><td>이벤트 큐</td><td>장기 처리 요청의 병목 해소</td><td>Kafka, RabbitMQ, AWS SQS 연계</td></tr><tr><td><strong>6. 데이터 처리</strong></td><td>페이로드 크기</td><td>대용량 전송 방지 및 처리 성능 개선</td><td>응답 필드 필터링, 페이징, 압축, 요청 크기 제한</td></tr><tr><td></td><td>직렬화/역직렬화</td><td>CPU 사용량 최소화를 위한 효율적 데이터 처리</td><td>Protocol Buffers, MessagePack 사용, JSON 파서 최적화</td></tr><tr><td></td><td>데이터 변환</td><td>과도한 포맷 변환으로 인한 지연 방지</td><td>변환 캐시 사용, 필요 최소화, 템플릿 기반 처리</td></tr><tr><td><strong>7. 로깅 및 관찰성</strong></td><td>로깅 오버헤드</td><td>과도한 로깅으로 인한 리소스 소모 방지</td><td>샘플링 로그, 비동기 로깅, 로그 레벨 조절, Fluentd/ELK 최적화</td></tr><tr><td></td><td>메트릭 수집</td><td>고해상도 메트릭은 처리 부하를 증가시킴</td><td>수집 주기 조정, 핵심 메트릭 우선화, Prometheus + Grafana 연동</td></tr><tr><td></td><td>분산 추적</td><td>전체 요청 흐름 추적 시 오버헤드 발생 가능</td><td>OpenTelemetry + 샘플링 적용, 헤더 기반 제어</td></tr><tr><td></td><td>알림 처리</td><td>불필요한 알림 과다 발생 시 시스템 경고 노이즈 증가</td><td>알림 집계, 임계값 기반 트리거, 경고 우선순위 설정</td></tr><tr><td><strong>8. 보안/정책 효율화</strong></td><td>인증 처리</td><td>인증 서버/정책 처리 병목 방지</td><td>JWT 토큰 캐시, mTLS offload, 경량 인증 플로우 적용</td></tr><tr><td></td><td>암호화 오버헤드</td><td>TLS 연산 과다로 인한 CPU 사용량 증가</td><td>하드웨어 가속 (AES-NI), TLS 세션 재사용</td></tr><tr><td></td><td>정책 평가 최적화</td><td>복잡한 정책 조건 처리 지연</td><td>정책 캐시, 정책 컴파일/압축, 필수 평가 최소화</td></tr><tr><td><strong>9. 코드 및 구성</strong></td><td>플러그인 체인</td><td>과도한 미들웨어 체인은 처리 속도 저하 유발</td><td>플러그인 정리, 경량화, 우선 순위 기반 최적화</td></tr><tr><td></td><td>구성 복잡성</td><td>설정 변경 시 과도한 리소스 리로드 발생</td><td>모듈화된 구성 파일, 핫 리로드 지원, 설정 변경 감지기</td></tr><tr><td></td><td>런타임 의존성</td><td>과도한 외부 의존성은 장애 전파 및 복원력 저하</td><td>최소 의존성 설계, graceful fallback</td></tr><tr><td><strong>10. 인프라 및 자원</strong></td><td>리소스 프로비저닝</td><td>예상 트래픽 대비 자원 부족 시 병목 발생</td><td>CPU/메모리 기반 수치 산정 및 오토스케일링 적용</td></tr><tr><td></td><td>디스크 I/O</td><td>로깅 및 캐시로 인한 디스크 병목 발생</td><td>SSD 사용, 비동기 I/O, 디스크 로테이션/압축 설정</td></tr><tr><td></td><td>구성 요소 분리</td><td>과도한 통합은 확장성 및 장애 격리에 불리</td><td>마이크로게이트웨이, 기능별 스케일 유닛 분리</td></tr></tbody></table><h3 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h3><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><h4 id=사례-1-이커머스-마이크로서비스-환경에서-api-gateway-활용>사례 1: 이커머스 마이크로서비스 환경에서 API Gateway 활용<a hidden class=anchor aria-hidden=true href=#사례-1-이커머스-마이크로서비스-환경에서-api-gateway-활용>#</a></h4><p><strong>시스템 구성</strong>: Client → API Gateway → [상품, 주문, 유저, 결제, 배송] 마이크로서비스 각기 분리</p><p><strong>Workflow</strong>:</p><ol><li>클라이언트가 주문시 여러 API 요청을 단일 Gateway 에 전달</li><li>Gateway 가 서비스별 인증, 집계, 트래픽 제어 후 각 서비스 라우팅</li><li>통합 응답을 클라이언트에 반환</li></ol><pre class=mermaid>sequenceDiagram
Client-&gt;&gt;+APIGateway: 주문 생성 요청(JSON)
APIGateway-&gt;&gt;+AuthService: 인증/인가 확인
APIGateway-&gt;&gt;+OrderService: 주문 생성
APIGateway-&gt;&gt;+InventoryService: 재고 차감
APIGateway-&gt;&gt;+PaymentService: 결제 요청
OrderService--&gt;&gt;-APIGateway: 주문 결과
APIGateway--&gt;&gt;-Client: 통합 응답 반환
</pre><p><strong>역할</strong>: 각각의 서비스 요청/인증/집계/에러관리를 중앙에서 수행하여 개발자 및 클라이언트는 단일 엔드포인트만 신경쓰면 됨.</p><p><strong>유무 차이</strong>: Gateway 없이 직접 호출시 서비스별 정책 불일치, 보안 및 트래픽통제 분산, 장애 대응 어려움.</p><p><strong>구현 예시</strong>: Python, FastAPI + API Gateway 형 라우팅</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1> 1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2> 2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3> 3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4> 4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5> 5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6> 6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7> 7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8> 8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9> 9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10>10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11>11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12>12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13>13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14>14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15>15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16>16</a>
</span><span class=lnt id=hl-8-17><a class=lnlinks href=#hl-8-17>17</a>
</span><span class=lnt id=hl-8-18><a class=lnlinks href=#hl-8-18>18</a>
</span><span class=lnt id=hl-8-19><a class=lnlinks href=#hl-8-19>19</a>
</span><span class=lnt id=hl-8-20><a class=lnlinks href=#hl-8-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 예시: FastAPI 라우팅 + 인증 체크, API Gateway 역할 일부 구현</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span><span class=p>,</span> <span class=n>Request</span><span class=p>,</span> <span class=n>HTTPException</span><span class=p>,</span> <span class=n>Depends</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify_auth</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Gateway에서 인증 토큰 확인</span>
</span></span><span class=line><span class=cl>    <span class=n>token</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;Authorization&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>token</span> <span class=o>!=</span> <span class=s2>&#34;Bearer exampletoken&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>401</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Unauthorized&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/api/v1/order&#34;</span><span class=p>,</span> <span class=n>dependencies</span><span class=o>=</span><span class=p>[</span><span class=n>Depends</span><span class=p>(</span><span class=n>verify_auth</span><span class=p>)])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_order</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 주문 서비스와 통신 (실제론 별도 서비스로 라우팅)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;order&#34;</span><span class=p>:</span> <span class=s2>&#34;sample_order&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/api/v1/user&#34;</span><span class=p>,</span> <span class=n>dependencies</span><span class=o>=</span><span class=p>[</span><span class=n>Depends</span><span class=p>(</span><span class=n>verify_auth</span><span class=p>)])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_user</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 유저 서비스와 통신 (실제론 별도 서비스로 라우팅)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;user&#34;</span><span class=p>:</span> <span class=s2>&#34;sample_user&#34;</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>각 라우트에 대해 인증 검증을 수행해 API Gateway 가 하는 인증 통제기능의 일부를 재현.</li></ul><h4 id=사례-2-전자상거래-플랫폼-사례>사례 2: 전자상거래 플랫폼 사례<a hidden class=anchor aria-hidden=true href=#사례-2-전자상거래-플랫폼-사례>#</a></h4><p><strong>시스템 구성</strong>:</p><pre class=mermaid>graph TD
    subgraph &#34;Frontend&#34;
        Web[웹 앱]
        Mobile[모바일 앱]
        Partner[파트너 API]
    end
    
    subgraph &#34;API Gateway Layer&#34;
        AG[API Gateway]
        Cache[Redis Cache]
        WAF[Web Application Firewall]
    end
    
    subgraph &#34;Microservices&#34;
        Auth[인증 서비스]
        Product[상품 서비스]
        Cart[장바구니 서비스]
        Order[주문 서비스]
        Payment[결제 서비스]
        Inventory[재고 서비스]
    end
    
    Web --&gt; WAF
    Mobile --&gt; WAF
    Partner --&gt; WAF
    WAF --&gt; AG
    AG --&gt; Cache
    
    AG --&gt; Auth
    AG --&gt; Product
    AG --&gt; Cart
    AG --&gt; Order
    AG --&gt; Payment
    AG --&gt; Inventory
</pre><p><strong>Workflow</strong>:</p><ol><li>클라이언트 요청이 WAF 를 통해 보안 검증</li><li>API Gateway 에서 인증 토큰 검증</li><li>요청 경로에 따라 적절한 마이크로서비스로 라우팅</li><li>필요시 여러 서비스 호출하여 응답 어그리게이션</li><li>캐시된 데이터 활용으로 성능 최적화</li><li>통합된 응답을 클라이언트에게 반환</li></ol><p><strong>API Gateway 의 역할</strong>:</p><ul><li>사용자 인증 및 세션 관리</li><li>상품 조회 시 캐싱을 통한 성능 향상</li><li>주문 처리 시 여러 서비스 오케스트레이션</li><li>트래픽 제한 및 DDoS 보호</li><li>API 사용량 모니터링 및 분석</li></ul><p><strong>API Gateway 유무에 따른 차이점</strong>:</p><ul><li><strong>있는 경우</strong>: 중앙집중식 보안, 일관된 API 인터페이스, 쉬운 모니터링</li><li><strong>없는 경우</strong>: 각 서비스별 보안 구현 필요, 클라이언트의 복잡한 서비스 호출, 분산된 모니터링</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1>  1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2>  2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3>  3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4>  4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5>  5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6>  6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7>  7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8>  8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9>  9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10> 10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11> 11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12> 12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13> 13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14> 14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15> 15</a>
</span><span class=lnt id=hl-10-16><a class=lnlinks href=#hl-10-16> 16</a>
</span><span class=lnt id=hl-10-17><a class=lnlinks href=#hl-10-17> 17</a>
</span><span class=lnt id=hl-10-18><a class=lnlinks href=#hl-10-18> 18</a>
</span><span class=lnt id=hl-10-19><a class=lnlinks href=#hl-10-19> 19</a>
</span><span class=lnt id=hl-10-20><a class=lnlinks href=#hl-10-20> 20</a>
</span><span class=lnt id=hl-10-21><a class=lnlinks href=#hl-10-21> 21</a>
</span><span class=lnt id=hl-10-22><a class=lnlinks href=#hl-10-22> 22</a>
</span><span class=lnt id=hl-10-23><a class=lnlinks href=#hl-10-23> 23</a>
</span><span class=lnt id=hl-10-24><a class=lnlinks href=#hl-10-24> 24</a>
</span><span class=lnt id=hl-10-25><a class=lnlinks href=#hl-10-25> 25</a>
</span><span class=lnt id=hl-10-26><a class=lnlinks href=#hl-10-26> 26</a>
</span><span class=lnt id=hl-10-27><a class=lnlinks href=#hl-10-27> 27</a>
</span><span class=lnt id=hl-10-28><a class=lnlinks href=#hl-10-28> 28</a>
</span><span class=lnt id=hl-10-29><a class=lnlinks href=#hl-10-29> 29</a>
</span><span class=lnt id=hl-10-30><a class=lnlinks href=#hl-10-30> 30</a>
</span><span class=lnt id=hl-10-31><a class=lnlinks href=#hl-10-31> 31</a>
</span><span class=lnt id=hl-10-32><a class=lnlinks href=#hl-10-32> 32</a>
</span><span class=lnt id=hl-10-33><a class=lnlinks href=#hl-10-33> 33</a>
</span><span class=lnt id=hl-10-34><a class=lnlinks href=#hl-10-34> 34</a>
</span><span class=lnt id=hl-10-35><a class=lnlinks href=#hl-10-35> 35</a>
</span><span class=lnt id=hl-10-36><a class=lnlinks href=#hl-10-36> 36</a>
</span><span class=lnt id=hl-10-37><a class=lnlinks href=#hl-10-37> 37</a>
</span><span class=lnt id=hl-10-38><a class=lnlinks href=#hl-10-38> 38</a>
</span><span class=lnt id=hl-10-39><a class=lnlinks href=#hl-10-39> 39</a>
</span><span class=lnt id=hl-10-40><a class=lnlinks href=#hl-10-40> 40</a>
</span><span class=lnt id=hl-10-41><a class=lnlinks href=#hl-10-41> 41</a>
</span><span class=lnt id=hl-10-42><a class=lnlinks href=#hl-10-42> 42</a>
</span><span class=lnt id=hl-10-43><a class=lnlinks href=#hl-10-43> 43</a>
</span><span class=lnt id=hl-10-44><a class=lnlinks href=#hl-10-44> 44</a>
</span><span class=lnt id=hl-10-45><a class=lnlinks href=#hl-10-45> 45</a>
</span><span class=lnt id=hl-10-46><a class=lnlinks href=#hl-10-46> 46</a>
</span><span class=lnt id=hl-10-47><a class=lnlinks href=#hl-10-47> 47</a>
</span><span class=lnt id=hl-10-48><a class=lnlinks href=#hl-10-48> 48</a>
</span><span class=lnt id=hl-10-49><a class=lnlinks href=#hl-10-49> 49</a>
</span><span class=lnt id=hl-10-50><a class=lnlinks href=#hl-10-50> 50</a>
</span><span class=lnt id=hl-10-51><a class=lnlinks href=#hl-10-51> 51</a>
</span><span class=lnt id=hl-10-52><a class=lnlinks href=#hl-10-52> 52</a>
</span><span class=lnt id=hl-10-53><a class=lnlinks href=#hl-10-53> 53</a>
</span><span class=lnt id=hl-10-54><a class=lnlinks href=#hl-10-54> 54</a>
</span><span class=lnt id=hl-10-55><a class=lnlinks href=#hl-10-55> 55</a>
</span><span class=lnt id=hl-10-56><a class=lnlinks href=#hl-10-56> 56</a>
</span><span class=lnt id=hl-10-57><a class=lnlinks href=#hl-10-57> 57</a>
</span><span class=lnt id=hl-10-58><a class=lnlinks href=#hl-10-58> 58</a>
</span><span class=lnt id=hl-10-59><a class=lnlinks href=#hl-10-59> 59</a>
</span><span class=lnt id=hl-10-60><a class=lnlinks href=#hl-10-60> 60</a>
</span><span class=lnt id=hl-10-61><a class=lnlinks href=#hl-10-61> 61</a>
</span><span class=lnt id=hl-10-62><a class=lnlinks href=#hl-10-62> 62</a>
</span><span class=lnt id=hl-10-63><a class=lnlinks href=#hl-10-63> 63</a>
</span><span class=lnt id=hl-10-64><a class=lnlinks href=#hl-10-64> 64</a>
</span><span class=lnt id=hl-10-65><a class=lnlinks href=#hl-10-65> 65</a>
</span><span class=lnt id=hl-10-66><a class=lnlinks href=#hl-10-66> 66</a>
</span><span class=lnt id=hl-10-67><a class=lnlinks href=#hl-10-67> 67</a>
</span><span class=lnt id=hl-10-68><a class=lnlinks href=#hl-10-68> 68</a>
</span><span class=lnt id=hl-10-69><a class=lnlinks href=#hl-10-69> 69</a>
</span><span class=lnt id=hl-10-70><a class=lnlinks href=#hl-10-70> 70</a>
</span><span class=lnt id=hl-10-71><a class=lnlinks href=#hl-10-71> 71</a>
</span><span class=lnt id=hl-10-72><a class=lnlinks href=#hl-10-72> 72</a>
</span><span class=lnt id=hl-10-73><a class=lnlinks href=#hl-10-73> 73</a>
</span><span class=lnt id=hl-10-74><a class=lnlinks href=#hl-10-74> 74</a>
</span><span class=lnt id=hl-10-75><a class=lnlinks href=#hl-10-75> 75</a>
</span><span class=lnt id=hl-10-76><a class=lnlinks href=#hl-10-76> 76</a>
</span><span class=lnt id=hl-10-77><a class=lnlinks href=#hl-10-77> 77</a>
</span><span class=lnt id=hl-10-78><a class=lnlinks href=#hl-10-78> 78</a>
</span><span class=lnt id=hl-10-79><a class=lnlinks href=#hl-10-79> 79</a>
</span><span class=lnt id=hl-10-80><a class=lnlinks href=#hl-10-80> 80</a>
</span><span class=lnt id=hl-10-81><a class=lnlinks href=#hl-10-81> 81</a>
</span><span class=lnt id=hl-10-82><a class=lnlinks href=#hl-10-82> 82</a>
</span><span class=lnt id=hl-10-83><a class=lnlinks href=#hl-10-83> 83</a>
</span><span class=lnt id=hl-10-84><a class=lnlinks href=#hl-10-84> 84</a>
</span><span class=lnt id=hl-10-85><a class=lnlinks href=#hl-10-85> 85</a>
</span><span class=lnt id=hl-10-86><a class=lnlinks href=#hl-10-86> 86</a>
</span><span class=lnt id=hl-10-87><a class=lnlinks href=#hl-10-87> 87</a>
</span><span class=lnt id=hl-10-88><a class=lnlinks href=#hl-10-88> 88</a>
</span><span class=lnt id=hl-10-89><a class=lnlinks href=#hl-10-89> 89</a>
</span><span class=lnt id=hl-10-90><a class=lnlinks href=#hl-10-90> 90</a>
</span><span class=lnt id=hl-10-91><a class=lnlinks href=#hl-10-91> 91</a>
</span><span class=lnt id=hl-10-92><a class=lnlinks href=#hl-10-92> 92</a>
</span><span class=lnt id=hl-10-93><a class=lnlinks href=#hl-10-93> 93</a>
</span><span class=lnt id=hl-10-94><a class=lnlinks href=#hl-10-94> 94</a>
</span><span class=lnt id=hl-10-95><a class=lnlinks href=#hl-10-95> 95</a>
</span><span class=lnt id=hl-10-96><a class=lnlinks href=#hl-10-96> 96</a>
</span><span class=lnt id=hl-10-97><a class=lnlinks href=#hl-10-97> 97</a>
</span><span class=lnt id=hl-10-98><a class=lnlinks href=#hl-10-98> 98</a>
</span><span class=lnt id=hl-10-99><a class=lnlinks href=#hl-10-99> 99</a>
</span><span class=lnt id=hl-10-100><a class=lnlinks href=#hl-10-100>100</a>
</span><span class=lnt id=hl-10-101><a class=lnlinks href=#hl-10-101>101</a>
</span><span class=lnt id=hl-10-102><a class=lnlinks href=#hl-10-102>102</a>
</span><span class=lnt id=hl-10-103><a class=lnlinks href=#hl-10-103>103</a>
</span><span class=lnt id=hl-10-104><a class=lnlinks href=#hl-10-104>104</a>
</span><span class=lnt id=hl-10-105><a class=lnlinks href=#hl-10-105>105</a>
</span><span class=lnt id=hl-10-106><a class=lnlinks href=#hl-10-106>106</a>
</span><span class=lnt id=hl-10-107><a class=lnlinks href=#hl-10-107>107</a>
</span><span class=lnt id=hl-10-108><a class=lnlinks href=#hl-10-108>108</a>
</span><span class=lnt id=hl-10-109><a class=lnlinks href=#hl-10-109>109</a>
</span><span class=lnt id=hl-10-110><a class=lnlinks href=#hl-10-110>110</a>
</span><span class=lnt id=hl-10-111><a class=lnlinks href=#hl-10-111>111</a>
</span><span class=lnt id=hl-10-112><a class=lnlinks href=#hl-10-112>112</a>
</span><span class=lnt id=hl-10-113><a class=lnlinks href=#hl-10-113>113</a>
</span><span class=lnt id=hl-10-114><a class=lnlinks href=#hl-10-114>114</a>
</span><span class=lnt id=hl-10-115><a class=lnlinks href=#hl-10-115>115</a>
</span><span class=lnt id=hl-10-116><a class=lnlinks href=#hl-10-116>116</a>
</span><span class=lnt id=hl-10-117><a class=lnlinks href=#hl-10-117>117</a>
</span><span class=lnt id=hl-10-118><a class=lnlinks href=#hl-10-118>118</a>
</span><span class=lnt id=hl-10-119><a class=lnlinks href=#hl-10-119>119</a>
</span><span class=lnt id=hl-10-120><a class=lnlinks href=#hl-10-120>120</a>
</span><span class=lnt id=hl-10-121><a class=lnlinks href=#hl-10-121>121</a>
</span><span class=lnt id=hl-10-122><a class=lnlinks href=#hl-10-122>122</a>
</span><span class=lnt id=hl-10-123><a class=lnlinks href=#hl-10-123>123</a>
</span><span class=lnt id=hl-10-124><a class=lnlinks href=#hl-10-124>124</a>
</span><span class=lnt id=hl-10-125><a class=lnlinks href=#hl-10-125>125</a>
</span><span class=lnt id=hl-10-126><a class=lnlinks href=#hl-10-126>126</a>
</span><span class=lnt id=hl-10-127><a class=lnlinks href=#hl-10-127>127</a>
</span><span class=lnt id=hl-10-128><a class=lnlinks href=#hl-10-128>128</a>
</span><span class=lnt id=hl-10-129><a class=lnlinks href=#hl-10-129>129</a>
</span><span class=lnt id=hl-10-130><a class=lnlinks href=#hl-10-130>130</a>
</span><span class=lnt id=hl-10-131><a class=lnlinks href=#hl-10-131>131</a>
</span><span class=lnt id=hl-10-132><a class=lnlinks href=#hl-10-132>132</a>
</span><span class=lnt id=hl-10-133><a class=lnlinks href=#hl-10-133>133</a>
</span><span class=lnt id=hl-10-134><a class=lnlinks href=#hl-10-134>134</a>
</span><span class=lnt id=hl-10-135><a class=lnlinks href=#hl-10-135>135</a>
</span><span class=lnt id=hl-10-136><a class=lnlinks href=#hl-10-136>136</a>
</span><span class=lnt id=hl-10-137><a class=lnlinks href=#hl-10-137>137</a>
</span><span class=lnt id=hl-10-138><a class=lnlinks href=#hl-10-138>138</a>
</span><span class=lnt id=hl-10-139><a class=lnlinks href=#hl-10-139>139</a>
</span><span class=lnt id=hl-10-140><a class=lnlinks href=#hl-10-140>140</a>
</span><span class=lnt id=hl-10-141><a class=lnlinks href=#hl-10-141>141</a>
</span><span class=lnt id=hl-10-142><a class=lnlinks href=#hl-10-142>142</a>
</span><span class=lnt id=hl-10-143><a class=lnlinks href=#hl-10-143>143</a>
</span><span class=lnt id=hl-10-144><a class=lnlinks href=#hl-10-144>144</a>
</span><span class=lnt id=hl-10-145><a class=lnlinks href=#hl-10-145>145</a>
</span><span class=lnt id=hl-10-146><a class=lnlinks href=#hl-10-146>146</a>
</span><span class=lnt id=hl-10-147><a class=lnlinks href=#hl-10-147>147</a>
</span><span class=lnt id=hl-10-148><a class=lnlinks href=#hl-10-148>148</a>
</span><span class=lnt id=hl-10-149><a class=lnlinks href=#hl-10-149>149</a>
</span><span class=lnt id=hl-10-150><a class=lnlinks href=#hl-10-150>150</a>
</span><span class=lnt id=hl-10-151><a class=lnlinks href=#hl-10-151>151</a>
</span><span class=lnt id=hl-10-152><a class=lnlinks href=#hl-10-152>152</a>
</span><span class=lnt id=hl-10-153><a class=lnlinks href=#hl-10-153>153</a>
</span><span class=lnt id=hl-10-154><a class=lnlinks href=#hl-10-154>154</a>
</span><span class=lnt id=hl-10-155><a class=lnlinks href=#hl-10-155>155</a>
</span><span class=lnt id=hl-10-156><a class=lnlinks href=#hl-10-156>156</a>
</span><span class=lnt id=hl-10-157><a class=lnlinks href=#hl-10-157>157</a>
</span><span class=lnt id=hl-10-158><a class=lnlinks href=#hl-10-158>158</a>
</span><span class=lnt id=hl-10-159><a class=lnlinks href=#hl-10-159>159</a>
</span><span class=lnt id=hl-10-160><a class=lnlinks href=#hl-10-160>160</a>
</span><span class=lnt id=hl-10-161><a class=lnlinks href=#hl-10-161>161</a>
</span><span class=lnt id=hl-10-162><a class=lnlinks href=#hl-10-162>162</a>
</span><span class=lnt id=hl-10-163><a class=lnlinks href=#hl-10-163>163</a>
</span><span class=lnt id=hl-10-164><a class=lnlinks href=#hl-10-164>164</a>
</span><span class=lnt id=hl-10-165><a class=lnlinks href=#hl-10-165>165</a>
</span><span class=lnt id=hl-10-166><a class=lnlinks href=#hl-10-166>166</a>
</span><span class=lnt id=hl-10-167><a class=lnlinks href=#hl-10-167>167</a>
</span><span class=lnt id=hl-10-168><a class=lnlinks href=#hl-10-168>168</a>
</span><span class=lnt id=hl-10-169><a class=lnlinks href=#hl-10-169>169</a>
</span><span class=lnt id=hl-10-170><a class=lnlinks href=#hl-10-170>170</a>
</span><span class=lnt id=hl-10-171><a class=lnlinks href=#hl-10-171>171</a>
</span><span class=lnt id=hl-10-172><a class=lnlinks href=#hl-10-172>172</a>
</span><span class=lnt id=hl-10-173><a class=lnlinks href=#hl-10-173>173</a>
</span><span class=lnt id=hl-10-174><a class=lnlinks href=#hl-10-174>174</a>
</span><span class=lnt id=hl-10-175><a class=lnlinks href=#hl-10-175>175</a>
</span><span class=lnt id=hl-10-176><a class=lnlinks href=#hl-10-176>176</a>
</span><span class=lnt id=hl-10-177><a class=lnlinks href=#hl-10-177>177</a>
</span><span class=lnt id=hl-10-178><a class=lnlinks href=#hl-10-178>178</a>
</span><span class=lnt id=hl-10-179><a class=lnlinks href=#hl-10-179>179</a>
</span><span class=lnt id=hl-10-180><a class=lnlinks href=#hl-10-180>180</a>
</span><span class=lnt id=hl-10-181><a class=lnlinks href=#hl-10-181>181</a>
</span><span class=lnt id=hl-10-182><a class=lnlinks href=#hl-10-182>182</a>
</span><span class=lnt id=hl-10-183><a class=lnlinks href=#hl-10-183>183</a>
</span><span class=lnt id=hl-10-184><a class=lnlinks href=#hl-10-184>184</a>
</span><span class=lnt id=hl-10-185><a class=lnlinks href=#hl-10-185>185</a>
</span><span class=lnt id=hl-10-186><a class=lnlinks href=#hl-10-186>186</a>
</span><span class=lnt id=hl-10-187><a class=lnlinks href=#hl-10-187>187</a>
</span><span class=lnt id=hl-10-188><a class=lnlinks href=#hl-10-188>188</a>
</span><span class=lnt id=hl-10-189><a class=lnlinks href=#hl-10-189>189</a>
</span><span class=lnt id=hl-10-190><a class=lnlinks href=#hl-10-190>190</a>
</span><span class=lnt id=hl-10-191><a class=lnlinks href=#hl-10-191>191</a>
</span><span class=lnt id=hl-10-192><a class=lnlinks href=#hl-10-192>192</a>
</span><span class=lnt id=hl-10-193><a class=lnlinks href=#hl-10-193>193</a>
</span><span class=lnt id=hl-10-194><a class=lnlinks href=#hl-10-194>194</a>
</span><span class=lnt id=hl-10-195><a class=lnlinks href=#hl-10-195>195</a>
</span><span class=lnt id=hl-10-196><a class=lnlinks href=#hl-10-196>196</a>
</span><span class=lnt id=hl-10-197><a class=lnlinks href=#hl-10-197>197</a>
</span><span class=lnt id=hl-10-198><a class=lnlinks href=#hl-10-198>198</a>
</span><span class=lnt id=hl-10-199><a class=lnlinks href=#hl-10-199>199</a>
</span><span class=lnt id=hl-10-200><a class=lnlinks href=#hl-10-200>200</a>
</span><span class=lnt id=hl-10-201><a class=lnlinks href=#hl-10-201>201</a>
</span><span class=lnt id=hl-10-202><a class=lnlinks href=#hl-10-202>202</a>
</span><span class=lnt id=hl-10-203><a class=lnlinks href=#hl-10-203>203</a>
</span><span class=lnt id=hl-10-204><a class=lnlinks href=#hl-10-204>204</a>
</span><span class=lnt id=hl-10-205><a class=lnlinks href=#hl-10-205>205</a>
</span><span class=lnt id=hl-10-206><a class=lnlinks href=#hl-10-206>206</a>
</span><span class=lnt id=hl-10-207><a class=lnlinks href=#hl-10-207>207</a>
</span><span class=lnt id=hl-10-208><a class=lnlinks href=#hl-10-208>208</a>
</span><span class=lnt id=hl-10-209><a class=lnlinks href=#hl-10-209>209</a>
</span><span class=lnt id=hl-10-210><a class=lnlinks href=#hl-10-210>210</a>
</span><span class=lnt id=hl-10-211><a class=lnlinks href=#hl-10-211>211</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># FastAPI를 이용한 간단한 API Gateway 구현 예시</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span><span class=p>,</span> <span class=n>HTTPException</span><span class=p>,</span> <span class=n>Depends</span><span class=p>,</span> <span class=n>Header</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi.responses</span> <span class=kn>import</span> <span class=n>JSONResponse</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>httpx</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>jwt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Optional</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>redis</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>(</span><span class=n>title</span><span class=o>=</span><span class=s2>&#34;API Gateway&#34;</span><span class=p>,</span> <span class=n>version</span><span class=o>=</span><span class=s2>&#34;1.0.0&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Redis 클라이언트 (캐싱용)</span>
</span></span><span class=line><span class=cl><span class=n>redis_client</span> <span class=o>=</span> <span class=n>redis</span><span class=o>.</span><span class=n>Redis</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s1>&#39;localhost&#39;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>6379</span><span class=p>,</span> <span class=n>db</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 서비스 레지스트리 - 실제로는 서비스 디스커버리 사용</span>
</span></span><span class=line><span class=cl><span class=n>SERVICE_REGISTRY</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;user&#34;</span><span class=p>:</span> <span class=s2>&#34;http://user-service:8001&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;product&#34;</span><span class=p>:</span> <span class=s2>&#34;http://product-service:8002&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=s2>&#34;order&#34;</span><span class=p>:</span> <span class=s2>&#34;http://order-service:8003&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;payment&#34;</span><span class=p>:</span> <span class=s2>&#34;http://payment-service:8004&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># JWT 시크릿 키</span>
</span></span><span class=line><span class=cl><span class=n>JWT_SECRET</span> <span class=o>=</span> <span class=s2>&#34;your-secret-key&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>RateLimiter</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;요청 제한 클래스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>max_requests</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>100</span><span class=p>,</span> <span class=n>window_seconds</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>60</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>max_requests</span> <span class=o>=</span> <span class=n>max_requests</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>window_seconds</span> <span class=o>=</span> <span class=n>window_seconds</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>is_allowed</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>client_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;요청 허용 여부 확인&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;rate_limit:</span><span class=si>{</span><span class=n>client_id</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>current_time</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>window_start</span> <span class=o>=</span> <span class=n>current_time</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>window_seconds</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 현재 윈도우의 요청 수 확인</span>
</span></span><span class=line><span class=cl>        <span class=n>pipe</span> <span class=o>=</span> <span class=n>redis_client</span><span class=o>.</span><span class=n>pipeline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>pipe</span><span class=o>.</span><span class=n>zremrangebyscore</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>window_start</span><span class=p>)</span>  <span class=c1># 오래된 요청 제거</span>
</span></span><span class=line><span class=cl>        <span class=n>pipe</span><span class=o>.</span><span class=n>zcard</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>  <span class=c1># 현재 요청 수 확인</span>
</span></span><span class=line><span class=cl>        <span class=n>pipe</span><span class=o>.</span><span class=n>zadd</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=p>{</span><span class=nb>str</span><span class=p>(</span><span class=n>current_time</span><span class=p>):</span> <span class=n>current_time</span><span class=p>})</span>  <span class=c1># 현재 요청 추가</span>
</span></span><span class=line><span class=cl>        <span class=n>pipe</span><span class=o>.</span><span class=n>expire</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>window_seconds</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>results</span> <span class=o>=</span> <span class=n>pipe</span><span class=o>.</span><span class=n>execute</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>request_count</span> <span class=o>=</span> <span class=n>results</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>request_count</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rate_limiter</span> <span class=o>=</span> <span class=n>RateLimiter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>verify_token</span><span class=p>(</span><span class=n>authorization</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>Header</span><span class=p>(</span><span class=kc>None</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;JWT 토큰 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>authorization</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>401</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Authorization header missing&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Bearer 토큰 추출</span>
</span></span><span class=line><span class=cl>        <span class=n>token</span> <span class=o>=</span> <span class=n>authorization</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;Bearer &#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>JWT_SECRET</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;HS256&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>payload</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>ExpiredSignatureError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>401</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Token expired&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>InvalidTokenError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>401</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Invalid token&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>get_cached_response</span><span class=p>(</span><span class=n>cache_key</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;캐시된 응답 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>cached_data</span> <span class=o>=</span> <span class=n>redis_client</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>cache_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>cached_data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>cached_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>set_cached_response</span><span class=p>(</span><span class=n>cache_key</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=nb>dict</span><span class=p>,</span> <span class=n>ttl</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>300</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;응답 캐싱&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>redis_client</span><span class=o>.</span><span class=n>setex</span><span class=p>(</span><span class=n>cache_key</span><span class=p>,</span> <span class=n>ttl</span><span class=p>,</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>data</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.middleware</span><span class=p>(</span><span class=s2>&#34;http&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>rate_limiting_middleware</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>call_next</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;요청 제한 미들웨어&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>client_ip</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>host</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>rate_limiter</span><span class=o>.</span><span class=n>is_allowed</span><span class=p>(</span><span class=n>client_ip</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>JSONResponse</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>status_code</span><span class=o>=</span><span class=mi>429</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>content</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;detail&#34;</span><span class=p>:</span> <span class=s2>&#34;Rate limit exceeded&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=k>await</span> <span class=n>call_next</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>response</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>proxy_request</span><span class=p>(</span><span class=n>service_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>method</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                       <span class=n>headers</span><span class=p>:</span> <span class=nb>dict</span><span class=p>,</span> <span class=n>body</span><span class=p>:</span> <span class=nb>bytes</span> <span class=o>=</span> <span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;백엔드 서비스로 요청 프록시&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>service_name</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>SERVICE_REGISTRY</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>404</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Service not found&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>service_url</span> <span class=o>=</span> <span class=n>SERVICE_REGISTRY</span><span class=p>[</span><span class=n>service_name</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>target_url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>service_url</span><span class=si>}{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 내부 헤더 제거 (보안상)</span>
</span></span><span class=line><span class=cl>    <span class=n>filtered_headers</span> <span class=o>=</span> <span class=p>{</span><span class=n>k</span><span class=p>:</span> <span class=n>v</span> <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>headers</span><span class=o>.</span><span class=n>items</span><span class=p>()</span> 
</span></span><span class=line><span class=cl>                       <span class=k>if</span> <span class=ow>not</span> <span class=n>k</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;host&#39;</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>with</span> <span class=n>httpx</span><span class=o>.</span><span class=n>AsyncClient</span><span class=p>()</span> <span class=k>as</span> <span class=n>client</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>method</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&#34;GET&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>response</span> <span class=o>=</span> <span class=k>await</span> <span class=n>client</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>target_url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>filtered_headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>method</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&#34;POST&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>response</span> <span class=o>=</span> <span class=k>await</span> <span class=n>client</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>target_url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>filtered_headers</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=n>body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>method</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&#34;PUT&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>response</span> <span class=o>=</span> <span class=k>await</span> <span class=n>client</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>target_url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>filtered_headers</span><span class=p>,</span> <span class=n>content</span><span class=o>=</span><span class=n>body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>method</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&#34;DELETE&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>response</span> <span class=o>=</span> <span class=k>await</span> <span class=n>client</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>target_url</span><span class=p>,</span> <span class=n>headers</span><span class=o>=</span><span class=n>filtered_headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>405</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Method not allowed&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>response</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>httpx</span><span class=o>.</span><span class=n>RequestError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>503</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Service unavailable&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.api_route</span><span class=p>(</span><span class=s2>&#34;/api/</span><span class=si>{service_name}</span><span class=s2>/{path:path}&#34;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;GET&#34;</span><span class=p>,</span> <span class=s2>&#34;POST&#34;</span><span class=p>,</span> <span class=s2>&#34;PUT&#34;</span><span class=p>,</span> <span class=s2>&#34;DELETE&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>gateway_proxy</span><span class=p>(</span><span class=n>service_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                       <span class=n>token_payload</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>verify_token</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;API Gateway 메인 프록시 엔드포인트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 캐싱 키 생성 (GET 요청만)</span>
</span></span><span class=line><span class=cl>    <span class=n>cache_key</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s2>&#34;GET&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>cache_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;cache:</span><span class=si>{</span><span class=n>service_name</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>request</span><span class=o>.</span><span class=n>url</span><span class=o>.</span><span class=n>query</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>cached_response</span> <span class=o>=</span> <span class=k>await</span> <span class=n>get_cached_response</span><span class=p>(</span><span class=n>cache_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>cached_response</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>cached_response</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 요청 본문 읽기</span>
</span></span><span class=line><span class=cl>    <span class=n>body</span> <span class=o>=</span> <span class=k>await</span> <span class=n>request</span><span class=o>.</span><span class=n>body</span><span class=p>()</span> <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&#34;POST&#34;</span><span class=p>,</span> <span class=s2>&#34;PUT&#34;</span><span class=p>]</span> <span class=k>else</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 백엔드 서비스로 요청 전달</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=k>await</span> <span class=n>proxy_request</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>service_name</span><span class=o>=</span><span class=n>service_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>path</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;/</span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>method</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>method</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>headers</span><span class=o>=</span><span class=nb>dict</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>body</span><span class=o>=</span><span class=n>body</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 응답 처리</span>
</span></span><span class=line><span class=cl>    <span class=n>response_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;status_code&#34;</span><span class=p>:</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;content&#34;</span><span class=p>:</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span> <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;content-type&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;application/json&#34;</span><span class=p>)</span> <span class=k>else</span> <span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;headers&#34;</span><span class=p>:</span> <span class=nb>dict</span><span class=p>(</span><span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 성공적인 GET 요청 결과 캐싱</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s2>&#34;GET&#34;</span> <span class=ow>and</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span> <span class=ow>and</span> <span class=n>cache_key</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>set_cached_response</span><span class=p>(</span><span class=n>cache_key</span><span class=p>,</span> <span class=n>response_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>JSONResponse</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>status_code</span><span class=o>=</span><span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>content</span><span class=o>=</span><span class=n>response_data</span><span class=p>[</span><span class=s2>&#34;content&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=n>headers</span><span class=o>=</span><span class=p>{</span><span class=n>k</span><span class=p>:</span> <span class=n>v</span> <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>response_data</span><span class=p>[</span><span class=s2>&#34;headers&#34;</span><span class=p>]</span><span class=o>.</span><span class=n>items</span><span class=p>()</span> 
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>k</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;content-length&#39;</span><span class=p>,</span> <span class=s1>&#39;transfer-encoding&#39;</span><span class=p>]}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/health&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>health_check</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;헬스 체크 엔드포인트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;healthy&#34;</span><span class=p>,</span> <span class=s2>&#34;timestamp&#34;</span><span class=p>:</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/metrics&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>get_metrics</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;메트릭 수집 엔드포인트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 실제로는 Prometheus 메트릭 등을 반환</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;total_requests&#34;</span><span class=p>:</span> <span class=s2>&#34;1000&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;success_rate&#34;</span><span class=p>:</span> <span class=s2>&#34;99.5%&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;avg_response_time&#34;</span><span class=p>:</span> <span class=s2>&#34;150ms&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># API Gateway 통합 응답 예시</span>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/api/user/</span><span class=si>{user_id}</span><span class=s2>/profile&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>get_user_profile</span><span class=p>(</span><span class=n>user_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>token_payload</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>verify_token</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;사용자 프로필 통합 조회 - 여러 서비스 어그리게이션 예시&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>with</span> <span class=n>httpx</span><span class=o>.</span><span class=n>AsyncClient</span><span class=p>()</span> <span class=k>as</span> <span class=n>client</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 동시에 여러 서비스 호출</span>
</span></span><span class=line><span class=cl>        <span class=n>user_task</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>SERVICE_REGISTRY</span><span class=p>[</span><span class=s1>&#39;user&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>/users/</span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>order_task</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>SERVICE_REGISTRY</span><span class=p>[</span><span class=s1>&#39;order&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>/users/</span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>/orders/recent&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 응답 대기</span>
</span></span><span class=line><span class=cl>        <span class=n>user_response</span><span class=p>,</span> <span class=n>order_response</span> <span class=o>=</span> <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span><span class=n>user_task</span><span class=p>,</span> <span class=n>order_task</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 응답 통합</span>
</span></span><span class=line><span class=cl>        <span class=n>profile_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;user&#34;</span><span class=p>:</span> <span class=n>user_response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span> <span class=k>if</span> <span class=n>user_response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span> <span class=k>else</span> <span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;recent_orders&#34;</span><span class=p>:</span> <span class=n>order_response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span> <span class=k>if</span> <span class=n>order_response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span> <span class=k>else</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;profile_complete&#34;</span><span class=p>:</span> <span class=n>user_response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>profile_data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=kn>import</span> <span class=nn>uvicorn</span>
</span></span><span class=line><span class=cl>    <span class=n>uvicorn</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>app</span><span class=p>,</span> <span class=n>host</span><span class=o>=</span><span class=s2>&#34;0.0.0.0&#34;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>8000</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-3-쿠팡-api-게이트웨이>사례 3: 쿠팡 API 게이트웨이<a hidden class=anchor aria-hidden=true href=#사례-3-쿠팡-api-게이트웨이>#</a></h4><p><strong>사례 개요</strong>:</p><ul><li><strong>기업:</strong> 쿠팡 (Coupang)</li><li><strong>기술 스택:</strong> AWS API Gateway, Lambda, Cognito, WAF, CloudWatch</li><li><strong>목적:</strong> 쿠팡 마켓플레이스 입점사들을 위한 외부 API 제공</li></ul><p><strong>시스템 구성</strong>:</p><pre class=mermaid>graph LR
A[Partner App] --&gt; B[AWS API Gateway]
B --&gt; C[Lambda Authenticator]
B --&gt; D[Routing Rules]
D --&gt; E[Product Service]
D --&gt; F[Order Service]
E --&gt; G[DynamoDB]
F --&gt; H[RDS MySQL]
B --&gt; I[CloudWatch + X-Ray]
</pre><p><strong>Workflow</strong>:</p><ol><li><strong>인증:</strong> API Gateway 가 Lambda Authenticator 로 JWT 검증 수행</li><li><strong>요청 분기:</strong> 요청 URL 경로에 따라 Product 또는 Order 서비스로 라우팅</li><li><strong>로깅:</strong> CloudWatch 로 호출 로그 집계 및 X-Ray 로 분산 트레이싱</li></ol><p><strong>주제의 역할 및 효과</strong>:</p><table><thead><tr><th>구분</th><th>유무에 따른 차이점</th></tr></thead><tbody><tr><td>API Gateway 사용</td><td>인증, 속도제어, 로깅 통합 수행. 모든 요청을 단일 진입점에서 제어</td></tr><tr><td>미사용 시</td><td>각 서비스별 인증 및 로깅 로직 중복, 클라이언트가 다수의 서비스에 직접 접근해야 함</td></tr></tbody></table><p><strong>구현 예시</strong>: Python - AWS Lambda + API Gateway</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1> 1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2> 2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3> 3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4> 4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5> 5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6> 6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7> 7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8> 8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9> 9</a>
</span><span class=lnt id=hl-12-10><a class=lnlinks href=#hl-12-10>10</a>
</span><span class=lnt id=hl-12-11><a class=lnlinks href=#hl-12-11>11</a>
</span><span class=lnt id=hl-12-12><a class=lnlinks href=#hl-12-12>12</a>
</span><span class=lnt id=hl-12-13><a class=lnlinks href=#hl-12-13>13</a>
</span><span class=lnt id=hl-12-14><a class=lnlinks href=#hl-12-14>14</a>
</span><span class=lnt id=hl-12-15><a class=lnlinks href=#hl-12-15>15</a>
</span><span class=lnt id=hl-12-16><a class=lnlinks href=#hl-12-16>16</a>
</span><span class=lnt id=hl-12-17><a class=lnlinks href=#hl-12-17>17</a>
</span><span class=lnt id=hl-12-18><a class=lnlinks href=#hl-12-18>18</a>
</span><span class=lnt id=hl-12-19><a class=lnlinks href=#hl-12-19>19</a>
</span><span class=lnt id=hl-12-20><a class=lnlinks href=#hl-12-20>20</a>
</span><span class=lnt id=hl-12-21><a class=lnlinks href=#hl-12-21>21</a>
</span><span class=lnt id=hl-12-22><a class=lnlinks href=#hl-12-22>22</a>
</span><span class=lnt id=hl-12-23><a class=lnlinks href=#hl-12-23>23</a>
</span><span class=lnt id=hl-12-24><a class=lnlinks href=#hl-12-24>24</a>
</span><span class=lnt id=hl-12-25><a class=lnlinks href=#hl-12-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Lambda 함수: 인증 처리</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>lambda_handler</span><span class=p>(</span><span class=n>event</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>token</span> <span class=o>=</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;headers&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;Authorization&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 인증 토큰 검증 (예: JWT 형식)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>token</span> <span class=o>!=</span> <span class=s2>&#34;Bearer valid-token&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;statusCode&#39;</span><span class=p>:</span> <span class=mi>401</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;body&#39;</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=s1>&#39;Unauthorized&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 요청을 백엔드 서비스로 전달할 수 있도록 승인</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;principalId&#39;</span><span class=p>:</span> <span class=s1>&#39;user123&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;policyDocument&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Version&#39;</span><span class=p>:</span> <span class=s1>&#39;2012-10-17&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Statement&#39;</span><span class=p>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;Action&#39;</span><span class=p>:</span> <span class=s1>&#39;execute-api:Invoke&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;Effect&#39;</span><span class=p>:</span> <span class=s1>&#39;Allow&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;Resource&#39;</span><span class=p>:</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;methodArn&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>}]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Lambda 를 통해 <strong>JWT 기반 인증 로직</strong>을 수행.</li><li>API Gateway 와 연결 시 Lambda Authorizer 로 구성.</li><li>인증 후 정책 (policy) 을 반환해 API 호출 권한을 부여.</li></ul><h4 id=사례-4-대규모-전자상거래-플랫폼-사례>사례 4: 대규모 전자상거래 플랫폼 사례<a hidden class=anchor aria-hidden=true href=#사례-4-대규모-전자상거래-플랫폼-사례>#</a></h4><p><strong>시스템 구성</strong>:</p><ul><li>클라이언트: 웹/모바일 앱, 파트너 시스템</li><li>API Gateway: Kong Enterprise</li><li>백엔드 서비스: 사용자, 상품, 주문, 결제, 재고 관리 서비스</li><li>인프라: Kubernetes 클러스터, Redis 캐시, PostgreSQL</li></ul><pre class=mermaid>graph TB
    subgraph &#34;클라이언트&#34;
        WebApp[웹 애플리케이션]
        MobileApp[모바일 앱]
        PartnerAPI[파트너 시스템]
    end
    
    subgraph &#34;Kong API Gateway&#34;
        Kong[Kong Gateway]
        AuthPlugin[인증 플러그인]
        RateLimit[속도 제한]
        Analytics[분석 플러그인]
    end
    
    subgraph &#34;마이크로서비스&#34;
        UserSvc[사용자 서비스]
        ProductSvc[상품 서비스]
        OrderSvc[주문 서비스]
        PaymentSvc[결제 서비스]
        InventorySvc[재고 서비스]
    end
    
    subgraph &#34;데이터 계층&#34;
        Redis[(Redis Cache)]
        UserDB[(사용자 DB)]
        ProductDB[(상품 DB)]
        OrderDB[(주문 DB)]
    end
    
    WebApp --&gt; Kong
    MobileApp --&gt; Kong
    PartnerAPI --&gt; Kong
    
    Kong --&gt; AuthPlugin
    Kong --&gt; RateLimit
    Kong --&gt; Analytics
    
    Kong --&gt; UserSvc
    Kong --&gt; ProductSvc
    Kong --&gt; OrderSvc
    Kong --&gt; PaymentSvc
    Kong --&gt; InventorySvc
    
    Kong --&gt; Redis
    UserSvc --&gt; UserDB
    ProductSvc --&gt; ProductDB
    OrderSvc --&gt; OrderDB
</pre><p><strong>Workflow</strong>:</p><pre class=mermaid>sequenceDiagram
    participant U as 사용자
    participant W as 웹앱
    participant K as Kong Gateway
    participant A as 인증서비스
    participant O as 주문서비스
    participant P as 결제서비스
    participant I as 재고서비스
    
    U-&gt;&gt;W: 상품 주문 요청
    W-&gt;&gt;K: POST /api/orders
    K-&gt;&gt;A: 토큰 검증
    A-&gt;&gt;K: 인증 성공
    K-&gt;&gt;I: 재고 확인 요청
    I-&gt;&gt;K: 재고 상태 반환
    K-&gt;&gt;O: 주문 생성 요청
    O-&gt;&gt;K: 주문 ID 반환
    K-&gt;&gt;P: 결제 처리 요청
    P-&gt;&gt;K: 결제 결과
    K-&gt;&gt;W: 통합 응답
    W-&gt;&gt;U: 주문 완료 알림
</pre><p><strong>API Gateway 의 역할</strong>:</p><ul><li>JWT 토큰 기반 인증 처리</li><li>API 호출량 제한 (사용자별 1 분 60 회)</li><li>요청/응답 로깅 및 메트릭 수집</li><li>결제 실패 시 보상 트랜잭션 처리</li><li>상품 정보 캐싱으로 응답 속도 개선</li></ul><p><strong>API Gateway 유무에 따른 차이점</strong>:</p><ul><li><strong>Gateway 없이</strong>:<ul><li>클라이언트가 5 개 서비스를 직접 호출</li><li>각 서비스별로 인증 로직 중복 구현</li><li>서비스 장애 시 클라이언트에서 직접 처리</li><li>모니터링 데이터 분산으로 통합 분석 어려움</li></ul></li><li><strong>Gateway 적용 후</strong>:<ul><li>단일 엔드포인트로 복잡성 감소</li><li>중앙집중식 인증으로 보안 강화</li><li>자동 재시도 및 회로 차단기로 안정성 향상</li><li>통합 대시보드로 실시간 모니터링 가능</li></ul></li></ul><p><strong>구현 예시</strong>: Python Flask 기반 API Gateway 구현</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1>  1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2>  2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3>  3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4>  4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5>  5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6>  6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7>  7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8>  8</a>
</span><span class=lnt id=hl-15-9><a class=lnlinks href=#hl-15-9>  9</a>
</span><span class=lnt id=hl-15-10><a class=lnlinks href=#hl-15-10> 10</a>
</span><span class=lnt id=hl-15-11><a class=lnlinks href=#hl-15-11> 11</a>
</span><span class=lnt id=hl-15-12><a class=lnlinks href=#hl-15-12> 12</a>
</span><span class=lnt id=hl-15-13><a class=lnlinks href=#hl-15-13> 13</a>
</span><span class=lnt id=hl-15-14><a class=lnlinks href=#hl-15-14> 14</a>
</span><span class=lnt id=hl-15-15><a class=lnlinks href=#hl-15-15> 15</a>
</span><span class=lnt id=hl-15-16><a class=lnlinks href=#hl-15-16> 16</a>
</span><span class=lnt id=hl-15-17><a class=lnlinks href=#hl-15-17> 17</a>
</span><span class=lnt id=hl-15-18><a class=lnlinks href=#hl-15-18> 18</a>
</span><span class=lnt id=hl-15-19><a class=lnlinks href=#hl-15-19> 19</a>
</span><span class=lnt id=hl-15-20><a class=lnlinks href=#hl-15-20> 20</a>
</span><span class=lnt id=hl-15-21><a class=lnlinks href=#hl-15-21> 21</a>
</span><span class=lnt id=hl-15-22><a class=lnlinks href=#hl-15-22> 22</a>
</span><span class=lnt id=hl-15-23><a class=lnlinks href=#hl-15-23> 23</a>
</span><span class=lnt id=hl-15-24><a class=lnlinks href=#hl-15-24> 24</a>
</span><span class=lnt id=hl-15-25><a class=lnlinks href=#hl-15-25> 25</a>
</span><span class=lnt id=hl-15-26><a class=lnlinks href=#hl-15-26> 26</a>
</span><span class=lnt id=hl-15-27><a class=lnlinks href=#hl-15-27> 27</a>
</span><span class=lnt id=hl-15-28><a class=lnlinks href=#hl-15-28> 28</a>
</span><span class=lnt id=hl-15-29><a class=lnlinks href=#hl-15-29> 29</a>
</span><span class=lnt id=hl-15-30><a class=lnlinks href=#hl-15-30> 30</a>
</span><span class=lnt id=hl-15-31><a class=lnlinks href=#hl-15-31> 31</a>
</span><span class=lnt id=hl-15-32><a class=lnlinks href=#hl-15-32> 32</a>
</span><span class=lnt id=hl-15-33><a class=lnlinks href=#hl-15-33> 33</a>
</span><span class=lnt id=hl-15-34><a class=lnlinks href=#hl-15-34> 34</a>
</span><span class=lnt id=hl-15-35><a class=lnlinks href=#hl-15-35> 35</a>
</span><span class=lnt id=hl-15-36><a class=lnlinks href=#hl-15-36> 36</a>
</span><span class=lnt id=hl-15-37><a class=lnlinks href=#hl-15-37> 37</a>
</span><span class=lnt id=hl-15-38><a class=lnlinks href=#hl-15-38> 38</a>
</span><span class=lnt id=hl-15-39><a class=lnlinks href=#hl-15-39> 39</a>
</span><span class=lnt id=hl-15-40><a class=lnlinks href=#hl-15-40> 40</a>
</span><span class=lnt id=hl-15-41><a class=lnlinks href=#hl-15-41> 41</a>
</span><span class=lnt id=hl-15-42><a class=lnlinks href=#hl-15-42> 42</a>
</span><span class=lnt id=hl-15-43><a class=lnlinks href=#hl-15-43> 43</a>
</span><span class=lnt id=hl-15-44><a class=lnlinks href=#hl-15-44> 44</a>
</span><span class=lnt id=hl-15-45><a class=lnlinks href=#hl-15-45> 45</a>
</span><span class=lnt id=hl-15-46><a class=lnlinks href=#hl-15-46> 46</a>
</span><span class=lnt id=hl-15-47><a class=lnlinks href=#hl-15-47> 47</a>
</span><span class=lnt id=hl-15-48><a class=lnlinks href=#hl-15-48> 48</a>
</span><span class=lnt id=hl-15-49><a class=lnlinks href=#hl-15-49> 49</a>
</span><span class=lnt id=hl-15-50><a class=lnlinks href=#hl-15-50> 50</a>
</span><span class=lnt id=hl-15-51><a class=lnlinks href=#hl-15-51> 51</a>
</span><span class=lnt id=hl-15-52><a class=lnlinks href=#hl-15-52> 52</a>
</span><span class=lnt id=hl-15-53><a class=lnlinks href=#hl-15-53> 53</a>
</span><span class=lnt id=hl-15-54><a class=lnlinks href=#hl-15-54> 54</a>
</span><span class=lnt id=hl-15-55><a class=lnlinks href=#hl-15-55> 55</a>
</span><span class=lnt id=hl-15-56><a class=lnlinks href=#hl-15-56> 56</a>
</span><span class=lnt id=hl-15-57><a class=lnlinks href=#hl-15-57> 57</a>
</span><span class=lnt id=hl-15-58><a class=lnlinks href=#hl-15-58> 58</a>
</span><span class=lnt id=hl-15-59><a class=lnlinks href=#hl-15-59> 59</a>
</span><span class=lnt id=hl-15-60><a class=lnlinks href=#hl-15-60> 60</a>
</span><span class=lnt id=hl-15-61><a class=lnlinks href=#hl-15-61> 61</a>
</span><span class=lnt id=hl-15-62><a class=lnlinks href=#hl-15-62> 62</a>
</span><span class=lnt id=hl-15-63><a class=lnlinks href=#hl-15-63> 63</a>
</span><span class=lnt id=hl-15-64><a class=lnlinks href=#hl-15-64> 64</a>
</span><span class=lnt id=hl-15-65><a class=lnlinks href=#hl-15-65> 65</a>
</span><span class=lnt id=hl-15-66><a class=lnlinks href=#hl-15-66> 66</a>
</span><span class=lnt id=hl-15-67><a class=lnlinks href=#hl-15-67> 67</a>
</span><span class=lnt id=hl-15-68><a class=lnlinks href=#hl-15-68> 68</a>
</span><span class=lnt id=hl-15-69><a class=lnlinks href=#hl-15-69> 69</a>
</span><span class=lnt id=hl-15-70><a class=lnlinks href=#hl-15-70> 70</a>
</span><span class=lnt id=hl-15-71><a class=lnlinks href=#hl-15-71> 71</a>
</span><span class=lnt id=hl-15-72><a class=lnlinks href=#hl-15-72> 72</a>
</span><span class=lnt id=hl-15-73><a class=lnlinks href=#hl-15-73> 73</a>
</span><span class=lnt id=hl-15-74><a class=lnlinks href=#hl-15-74> 74</a>
</span><span class=lnt id=hl-15-75><a class=lnlinks href=#hl-15-75> 75</a>
</span><span class=lnt id=hl-15-76><a class=lnlinks href=#hl-15-76> 76</a>
</span><span class=lnt id=hl-15-77><a class=lnlinks href=#hl-15-77> 77</a>
</span><span class=lnt id=hl-15-78><a class=lnlinks href=#hl-15-78> 78</a>
</span><span class=lnt id=hl-15-79><a class=lnlinks href=#hl-15-79> 79</a>
</span><span class=lnt id=hl-15-80><a class=lnlinks href=#hl-15-80> 80</a>
</span><span class=lnt id=hl-15-81><a class=lnlinks href=#hl-15-81> 81</a>
</span><span class=lnt id=hl-15-82><a class=lnlinks href=#hl-15-82> 82</a>
</span><span class=lnt id=hl-15-83><a class=lnlinks href=#hl-15-83> 83</a>
</span><span class=lnt id=hl-15-84><a class=lnlinks href=#hl-15-84> 84</a>
</span><span class=lnt id=hl-15-85><a class=lnlinks href=#hl-15-85> 85</a>
</span><span class=lnt id=hl-15-86><a class=lnlinks href=#hl-15-86> 86</a>
</span><span class=lnt id=hl-15-87><a class=lnlinks href=#hl-15-87> 87</a>
</span><span class=lnt id=hl-15-88><a class=lnlinks href=#hl-15-88> 88</a>
</span><span class=lnt id=hl-15-89><a class=lnlinks href=#hl-15-89> 89</a>
</span><span class=lnt id=hl-15-90><a class=lnlinks href=#hl-15-90> 90</a>
</span><span class=lnt id=hl-15-91><a class=lnlinks href=#hl-15-91> 91</a>
</span><span class=lnt id=hl-15-92><a class=lnlinks href=#hl-15-92> 92</a>
</span><span class=lnt id=hl-15-93><a class=lnlinks href=#hl-15-93> 93</a>
</span><span class=lnt id=hl-15-94><a class=lnlinks href=#hl-15-94> 94</a>
</span><span class=lnt id=hl-15-95><a class=lnlinks href=#hl-15-95> 95</a>
</span><span class=lnt id=hl-15-96><a class=lnlinks href=#hl-15-96> 96</a>
</span><span class=lnt id=hl-15-97><a class=lnlinks href=#hl-15-97> 97</a>
</span><span class=lnt id=hl-15-98><a class=lnlinks href=#hl-15-98> 98</a>
</span><span class=lnt id=hl-15-99><a class=lnlinks href=#hl-15-99> 99</a>
</span><span class=lnt id=hl-15-100><a class=lnlinks href=#hl-15-100>100</a>
</span><span class=lnt id=hl-15-101><a class=lnlinks href=#hl-15-101>101</a>
</span><span class=lnt id=hl-15-102><a class=lnlinks href=#hl-15-102>102</a>
</span><span class=lnt id=hl-15-103><a class=lnlinks href=#hl-15-103>103</a>
</span><span class=lnt id=hl-15-104><a class=lnlinks href=#hl-15-104>104</a>
</span><span class=lnt id=hl-15-105><a class=lnlinks href=#hl-15-105>105</a>
</span><span class=lnt id=hl-15-106><a class=lnlinks href=#hl-15-106>106</a>
</span><span class=lnt id=hl-15-107><a class=lnlinks href=#hl-15-107>107</a>
</span><span class=lnt id=hl-15-108><a class=lnlinks href=#hl-15-108>108</a>
</span><span class=lnt id=hl-15-109><a class=lnlinks href=#hl-15-109>109</a>
</span><span class=lnt id=hl-15-110><a class=lnlinks href=#hl-15-110>110</a>
</span><span class=lnt id=hl-15-111><a class=lnlinks href=#hl-15-111>111</a>
</span><span class=lnt id=hl-15-112><a class=lnlinks href=#hl-15-112>112</a>
</span><span class=lnt id=hl-15-113><a class=lnlinks href=#hl-15-113>113</a>
</span><span class=lnt id=hl-15-114><a class=lnlinks href=#hl-15-114>114</a>
</span><span class=lnt id=hl-15-115><a class=lnlinks href=#hl-15-115>115</a>
</span><span class=lnt id=hl-15-116><a class=lnlinks href=#hl-15-116>116</a>
</span><span class=lnt id=hl-15-117><a class=lnlinks href=#hl-15-117>117</a>
</span><span class=lnt id=hl-15-118><a class=lnlinks href=#hl-15-118>118</a>
</span><span class=lnt id=hl-15-119><a class=lnlinks href=#hl-15-119>119</a>
</span><span class=lnt id=hl-15-120><a class=lnlinks href=#hl-15-120>120</a>
</span><span class=lnt id=hl-15-121><a class=lnlinks href=#hl-15-121>121</a>
</span><span class=lnt id=hl-15-122><a class=lnlinks href=#hl-15-122>122</a>
</span><span class=lnt id=hl-15-123><a class=lnlinks href=#hl-15-123>123</a>
</span><span class=lnt id=hl-15-124><a class=lnlinks href=#hl-15-124>124</a>
</span><span class=lnt id=hl-15-125><a class=lnlinks href=#hl-15-125>125</a>
</span><span class=lnt id=hl-15-126><a class=lnlinks href=#hl-15-126>126</a>
</span><span class=lnt id=hl-15-127><a class=lnlinks href=#hl-15-127>127</a>
</span><span class=lnt id=hl-15-128><a class=lnlinks href=#hl-15-128>128</a>
</span><span class=lnt id=hl-15-129><a class=lnlinks href=#hl-15-129>129</a>
</span><span class=lnt id=hl-15-130><a class=lnlinks href=#hl-15-130>130</a>
</span><span class=lnt id=hl-15-131><a class=lnlinks href=#hl-15-131>131</a>
</span><span class=lnt id=hl-15-132><a class=lnlinks href=#hl-15-132>132</a>
</span><span class=lnt id=hl-15-133><a class=lnlinks href=#hl-15-133>133</a>
</span><span class=lnt id=hl-15-134><a class=lnlinks href=#hl-15-134>134</a>
</span><span class=lnt id=hl-15-135><a class=lnlinks href=#hl-15-135>135</a>
</span><span class=lnt id=hl-15-136><a class=lnlinks href=#hl-15-136>136</a>
</span><span class=lnt id=hl-15-137><a class=lnlinks href=#hl-15-137>137</a>
</span><span class=lnt id=hl-15-138><a class=lnlinks href=#hl-15-138>138</a>
</span><span class=lnt id=hl-15-139><a class=lnlinks href=#hl-15-139>139</a>
</span><span class=lnt id=hl-15-140><a class=lnlinks href=#hl-15-140>140</a>
</span><span class=lnt id=hl-15-141><a class=lnlinks href=#hl-15-141>141</a>
</span><span class=lnt id=hl-15-142><a class=lnlinks href=#hl-15-142>142</a>
</span><span class=lnt id=hl-15-143><a class=lnlinks href=#hl-15-143>143</a>
</span><span class=lnt id=hl-15-144><a class=lnlinks href=#hl-15-144>144</a>
</span><span class=lnt id=hl-15-145><a class=lnlinks href=#hl-15-145>145</a>
</span><span class=lnt id=hl-15-146><a class=lnlinks href=#hl-15-146>146</a>
</span><span class=lnt id=hl-15-147><a class=lnlinks href=#hl-15-147>147</a>
</span><span class=lnt id=hl-15-148><a class=lnlinks href=#hl-15-148>148</a>
</span><span class=lnt id=hl-15-149><a class=lnlinks href=#hl-15-149>149</a>
</span><span class=lnt id=hl-15-150><a class=lnlinks href=#hl-15-150>150</a>
</span><span class=lnt id=hl-15-151><a class=lnlinks href=#hl-15-151>151</a>
</span><span class=lnt id=hl-15-152><a class=lnlinks href=#hl-15-152>152</a>
</span><span class=lnt id=hl-15-153><a class=lnlinks href=#hl-15-153>153</a>
</span><span class=lnt id=hl-15-154><a class=lnlinks href=#hl-15-154>154</a>
</span><span class=lnt id=hl-15-155><a class=lnlinks href=#hl-15-155>155</a>
</span><span class=lnt id=hl-15-156><a class=lnlinks href=#hl-15-156>156</a>
</span><span class=lnt id=hl-15-157><a class=lnlinks href=#hl-15-157>157</a>
</span><span class=lnt id=hl-15-158><a class=lnlinks href=#hl-15-158>158</a>
</span><span class=lnt id=hl-15-159><a class=lnlinks href=#hl-15-159>159</a>
</span><span class=lnt id=hl-15-160><a class=lnlinks href=#hl-15-160>160</a>
</span><span class=lnt id=hl-15-161><a class=lnlinks href=#hl-15-161>161</a>
</span><span class=lnt id=hl-15-162><a class=lnlinks href=#hl-15-162>162</a>
</span><span class=lnt id=hl-15-163><a class=lnlinks href=#hl-15-163>163</a>
</span><span class=lnt id=hl-15-164><a class=lnlinks href=#hl-15-164>164</a>
</span><span class=lnt id=hl-15-165><a class=lnlinks href=#hl-15-165>165</a>
</span><span class=lnt id=hl-15-166><a class=lnlinks href=#hl-15-166>166</a>
</span><span class=lnt id=hl-15-167><a class=lnlinks href=#hl-15-167>167</a>
</span><span class=lnt id=hl-15-168><a class=lnlinks href=#hl-15-168>168</a>
</span><span class=lnt id=hl-15-169><a class=lnlinks href=#hl-15-169>169</a>
</span><span class=lnt id=hl-15-170><a class=lnlinks href=#hl-15-170>170</a>
</span><span class=lnt id=hl-15-171><a class=lnlinks href=#hl-15-171>171</a>
</span><span class=lnt id=hl-15-172><a class=lnlinks href=#hl-15-172>172</a>
</span><span class=lnt id=hl-15-173><a class=lnlinks href=#hl-15-173>173</a>
</span><span class=lnt id=hl-15-174><a class=lnlinks href=#hl-15-174>174</a>
</span><span class=lnt id=hl-15-175><a class=lnlinks href=#hl-15-175>175</a>
</span><span class=lnt id=hl-15-176><a class=lnlinks href=#hl-15-176>176</a>
</span><span class=lnt id=hl-15-177><a class=lnlinks href=#hl-15-177>177</a>
</span><span class=lnt id=hl-15-178><a class=lnlinks href=#hl-15-178>178</a>
</span><span class=lnt id=hl-15-179><a class=lnlinks href=#hl-15-179>179</a>
</span><span class=lnt id=hl-15-180><a class=lnlinks href=#hl-15-180>180</a>
</span><span class=lnt id=hl-15-181><a class=lnlinks href=#hl-15-181>181</a>
</span><span class=lnt id=hl-15-182><a class=lnlinks href=#hl-15-182>182</a>
</span><span class=lnt id=hl-15-183><a class=lnlinks href=#hl-15-183>183</a>
</span><span class=lnt id=hl-15-184><a class=lnlinks href=#hl-15-184>184</a>
</span><span class=lnt id=hl-15-185><a class=lnlinks href=#hl-15-185>185</a>
</span><span class=lnt id=hl-15-186><a class=lnlinks href=#hl-15-186>186</a>
</span><span class=lnt id=hl-15-187><a class=lnlinks href=#hl-15-187>187</a>
</span><span class=lnt id=hl-15-188><a class=lnlinks href=#hl-15-188>188</a>
</span><span class=lnt id=hl-15-189><a class=lnlinks href=#hl-15-189>189</a>
</span><span class=lnt id=hl-15-190><a class=lnlinks href=#hl-15-190>190</a>
</span><span class=lnt id=hl-15-191><a class=lnlinks href=#hl-15-191>191</a>
</span><span class=lnt id=hl-15-192><a class=lnlinks href=#hl-15-192>192</a>
</span><span class=lnt id=hl-15-193><a class=lnlinks href=#hl-15-193>193</a>
</span><span class=lnt id=hl-15-194><a class=lnlinks href=#hl-15-194>194</a>
</span><span class=lnt id=hl-15-195><a class=lnlinks href=#hl-15-195>195</a>
</span><span class=lnt id=hl-15-196><a class=lnlinks href=#hl-15-196>196</a>
</span><span class=lnt id=hl-15-197><a class=lnlinks href=#hl-15-197>197</a>
</span><span class=lnt id=hl-15-198><a class=lnlinks href=#hl-15-198>198</a>
</span><span class=lnt id=hl-15-199><a class=lnlinks href=#hl-15-199>199</a>
</span><span class=lnt id=hl-15-200><a class=lnlinks href=#hl-15-200>200</a>
</span><span class=lnt id=hl-15-201><a class=lnlinks href=#hl-15-201>201</a>
</span><span class=lnt id=hl-15-202><a class=lnlinks href=#hl-15-202>202</a>
</span><span class=lnt id=hl-15-203><a class=lnlinks href=#hl-15-203>203</a>
</span><span class=lnt id=hl-15-204><a class=lnlinks href=#hl-15-204>204</a>
</span><span class=lnt id=hl-15-205><a class=lnlinks href=#hl-15-205>205</a>
</span><span class=lnt id=hl-15-206><a class=lnlinks href=#hl-15-206>206</a>
</span><span class=lnt id=hl-15-207><a class=lnlinks href=#hl-15-207>207</a>
</span><span class=lnt id=hl-15-208><a class=lnlinks href=#hl-15-208>208</a>
</span><span class=lnt id=hl-15-209><a class=lnlinks href=#hl-15-209>209</a>
</span><span class=lnt id=hl-15-210><a class=lnlinks href=#hl-15-210>210</a>
</span><span class=lnt id=hl-15-211><a class=lnlinks href=#hl-15-211>211</a>
</span><span class=lnt id=hl-15-212><a class=lnlinks href=#hl-15-212>212</a>
</span><span class=lnt id=hl-15-213><a class=lnlinks href=#hl-15-213>213</a>
</span><span class=lnt id=hl-15-214><a class=lnlinks href=#hl-15-214>214</a>
</span><span class=lnt id=hl-15-215><a class=lnlinks href=#hl-15-215>215</a>
</span><span class=lnt id=hl-15-216><a class=lnlinks href=#hl-15-216>216</a>
</span><span class=lnt id=hl-15-217><a class=lnlinks href=#hl-15-217>217</a>
</span><span class=lnt id=hl-15-218><a class=lnlinks href=#hl-15-218>218</a>
</span><span class=lnt id=hl-15-219><a class=lnlinks href=#hl-15-219>219</a>
</span><span class=lnt id=hl-15-220><a class=lnlinks href=#hl-15-220>220</a>
</span><span class=lnt id=hl-15-221><a class=lnlinks href=#hl-15-221>221</a>
</span><span class=lnt id=hl-15-222><a class=lnlinks href=#hl-15-222>222</a>
</span><span class=lnt id=hl-15-223><a class=lnlinks href=#hl-15-223>223</a>
</span><span class=lnt id=hl-15-224><a class=lnlinks href=#hl-15-224>224</a>
</span><span class=lnt id=hl-15-225><a class=lnlinks href=#hl-15-225>225</a>
</span><span class=lnt id=hl-15-226><a class=lnlinks href=#hl-15-226>226</a>
</span><span class=lnt id=hl-15-227><a class=lnlinks href=#hl-15-227>227</a>
</span><span class=lnt id=hl-15-228><a class=lnlinks href=#hl-15-228>228</a>
</span><span class=lnt id=hl-15-229><a class=lnlinks href=#hl-15-229>229</a>
</span><span class=lnt id=hl-15-230><a class=lnlinks href=#hl-15-230>230</a>
</span><span class=lnt id=hl-15-231><a class=lnlinks href=#hl-15-231>231</a>
</span><span class=lnt id=hl-15-232><a class=lnlinks href=#hl-15-232>232</a>
</span><span class=lnt id=hl-15-233><a class=lnlinks href=#hl-15-233>233</a>
</span><span class=lnt id=hl-15-234><a class=lnlinks href=#hl-15-234>234</a>
</span><span class=lnt id=hl-15-235><a class=lnlinks href=#hl-15-235>235</a>
</span><span class=lnt id=hl-15-236><a class=lnlinks href=#hl-15-236>236</a>
</span><span class=lnt id=hl-15-237><a class=lnlinks href=#hl-15-237>237</a>
</span><span class=lnt id=hl-15-238><a class=lnlinks href=#hl-15-238>238</a>
</span><span class=lnt id=hl-15-239><a class=lnlinks href=#hl-15-239>239</a>
</span><span class=lnt id=hl-15-240><a class=lnlinks href=#hl-15-240>240</a>
</span><span class=lnt id=hl-15-241><a class=lnlinks href=#hl-15-241>241</a>
</span><span class=lnt id=hl-15-242><a class=lnlinks href=#hl-15-242>242</a>
</span><span class=lnt id=hl-15-243><a class=lnlinks href=#hl-15-243>243</a>
</span><span class=lnt id=hl-15-244><a class=lnlinks href=#hl-15-244>244</a>
</span><span class=lnt id=hl-15-245><a class=lnlinks href=#hl-15-245>245</a>
</span><span class=lnt id=hl-15-246><a class=lnlinks href=#hl-15-246>246</a>
</span><span class=lnt id=hl-15-247><a class=lnlinks href=#hl-15-247>247</a>
</span><span class=lnt id=hl-15-248><a class=lnlinks href=#hl-15-248>248</a>
</span><span class=lnt id=hl-15-249><a class=lnlinks href=#hl-15-249>249</a>
</span><span class=lnt id=hl-15-250><a class=lnlinks href=#hl-15-250>250</a>
</span><span class=lnt id=hl-15-251><a class=lnlinks href=#hl-15-251>251</a>
</span><span class=lnt id=hl-15-252><a class=lnlinks href=#hl-15-252>252</a>
</span><span class=lnt id=hl-15-253><a class=lnlinks href=#hl-15-253>253</a>
</span><span class=lnt id=hl-15-254><a class=lnlinks href=#hl-15-254>254</a>
</span><span class=lnt id=hl-15-255><a class=lnlinks href=#hl-15-255>255</a>
</span><span class=lnt id=hl-15-256><a class=lnlinks href=#hl-15-256>256</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># api_gateway.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span><span class=p>,</span> <span class=n>g</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>jwt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>redis</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>functools</span> <span class=kn>import</span> <span class=n>wraps</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span><span class=p>,</span> <span class=n>timedelta</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Redis 캐시 설정</span>
</span></span><span class=line><span class=cl><span class=n>cache</span> <span class=o>=</span> <span class=n>redis</span><span class=o>.</span><span class=n>Redis</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s1>&#39;localhost&#39;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>6379</span><span class=p>,</span> <span class=n>db</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 로깅 설정</span>
</span></span><span class=line><span class=cl><span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 서비스 레지스트리 - 실제로는 외부 서비스 디스커버리 사용</span>
</span></span><span class=line><span class=cl><span class=n>SERVICE_REGISTRY</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;user-service&#39;</span><span class=p>:</span> <span class=s1>&#39;http://user-service:8001&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;order-service&#39;</span><span class=p>:</span> <span class=s1>&#39;http://order-service:8002&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;payment-service&#39;</span><span class=p>:</span> <span class=s1>&#39;http://payment-service:8003&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;inventory-service&#39;</span><span class=p>:</span> <span class=s1>&#39;http://inventory-service:8004&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># JWT 시크릿 키 (실제로는 환경변수에서 로드)</span>
</span></span><span class=line><span class=cl><span class=n>JWT_SECRET</span> <span class=o>=</span> <span class=s1>&#39;your-secret-key&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>APIGateway</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;API Gateway 메인 클래스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>rate_limit_store</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># 속도 제한을 위한 저장소</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>authenticate_request</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>f</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;JWT 토큰 기반 인증 데코레이터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nd>@wraps</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>decorated_function</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=c1># Authorization 헤더에서 토큰 추출</span>
</span></span><span class=line><span class=cl>            <span class=n>token</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;Authorization&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>token</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Missing authorization token&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># Bearer 접두사 제거</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>token</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;Bearer &#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=n>token</span> <span class=o>=</span> <span class=n>token</span><span class=p>[</span><span class=mi>7</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># JWT 토큰 검증</span>
</span></span><span class=line><span class=cl>                <span class=n>payload</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>JWT_SECRET</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;HS256&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=n>g</span><span class=o>.</span><span class=n>user_id</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user_id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>g</span><span class=o>.</span><span class=n>user_role</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;role&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Authenticated user: </span><span class=si>{</span><span class=n>g</span><span class=o>.</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>ExpiredSignatureError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Token has expired&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>InvalidTokenError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Invalid token&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>decorated_function</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>rate_limit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>max_requests</span><span class=o>=</span><span class=mi>60</span><span class=p>,</span> <span class=n>window</span><span class=o>=</span><span class=mi>60</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;속도 제한 데코레이터 (분당 요청 수 제한)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>decorator</span><span class=p>(</span><span class=n>f</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=nd>@wraps</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>def</span> <span class=nf>decorated_function</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=c1># 클라이언트 IP 또는 사용자 ID 기반으로 제한</span>
</span></span><span class=line><span class=cl>                <span class=n>client_id</span> <span class=o>=</span> <span class=n>g</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user_id&#39;</span><span class=p>)</span> <span class=ow>or</span> <span class=n>request</span><span class=o>.</span><span class=n>remote_addr</span>
</span></span><span class=line><span class=cl>                <span class=n>current_time</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>())</span>
</span></span><span class=line><span class=cl>                <span class=n>window_start</span> <span class=o>=</span> <span class=n>current_time</span> <span class=o>-</span> <span class=p>(</span><span class=n>current_time</span> <span class=o>%</span> <span class=n>window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># Redis에서 현재 윈도우의 요청 수 확인</span>
</span></span><span class=line><span class=cl>                <span class=n>key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;rate_limit:</span><span class=si>{</span><span class=n>client_id</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>window_start</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                <span class=n>current_requests</span> <span class=o>=</span> <span class=n>cache</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>current_requests</span> <span class=ow>and</span> <span class=nb>int</span><span class=p>(</span><span class=n>current_requests</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=n>max_requests</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Rate limit exceeded&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;retry_after&#39;</span><span class=p>:</span> <span class=n>window</span> <span class=o>-</span> <span class=p>(</span><span class=n>current_time</span> <span class=o>%</span> <span class=n>window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>}),</span> <span class=mi>429</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 요청 수 증가</span>
</span></span><span class=line><span class=cl>                <span class=n>cache</span><span class=o>.</span><span class=n>incr</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>cache</span><span class=o>.</span><span class=n>expire</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>decorated_function</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>decorator</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>cache_response</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>ttl</span><span class=o>=</span><span class=mi>300</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;응답 캐싱 데코레이터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>decorator</span><span class=p>(</span><span class=n>f</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=nd>@wraps</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>def</span> <span class=nf>decorated_function</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=c1># 캐시 키 생성 (URL + 쿼리 파라미터)</span>
</span></span><span class=line><span class=cl>                <span class=n>cache_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;cache:</span><span class=si>{</span><span class=n>request</span><span class=o>.</span><span class=n>url</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 캐시에서 응답 확인</span>
</span></span><span class=line><span class=cl>                <span class=n>cached_response</span> <span class=o>=</span> <span class=n>cache</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>cache_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>cached_response</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Cache hit for: </span><span class=si>{</span><span class=n>cache_key</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>cached_response</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 실제 함수 실행</span>
</span></span><span class=line><span class=cl>                <span class=n>response</span> <span class=o>=</span> <span class=n>f</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 성공 응답만 캐싱</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>response</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>  <span class=c1># status code</span>
</span></span><span class=line><span class=cl>                    <span class=n>cache</span><span class=o>.</span><span class=n>setex</span><span class=p>(</span><span class=n>cache_key</span><span class=p>,</span> <span class=n>ttl</span><span class=p>,</span> <span class=n>response</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Cached response for: </span><span class=si>{</span><span class=n>cache_key</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>response</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>decorated_function</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>decorator</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>route_request</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>service_name</span><span class=p>,</span> <span class=n>path</span><span class=p>,</span> <span class=n>method</span><span class=o>=</span><span class=s1>&#39;GET&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;백엔드 서비스로 요청 라우팅&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 서비스 URL 조회</span>
</span></span><span class=line><span class=cl>        <span class=n>service_url</span> <span class=o>=</span> <span class=n>SERVICE_REGISTRY</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>service_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>service_url</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s1>&#39;Service </span><span class=si>{</span><span class=n>service_name</span><span class=si>}</span><span class=s1> not found&#39;</span><span class=p>}),</span> <span class=mi>404</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 전체 URL 구성</span>
</span></span><span class=line><span class=cl>        <span class=n>target_url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>service_url</span><span class=si>}{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 요청 헤더 복사 (Authorization 제외)</span>
</span></span><span class=line><span class=cl>            <span class=n>headers</span> <span class=o>=</span> <span class=p>{</span><span class=n>k</span><span class=p>:</span> <span class=n>v</span> <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span> <span class=k>if</span> <span class=n>k</span> <span class=o>!=</span> <span class=s1>&#39;Authorization&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=n>headers</span><span class=p>[</span><span class=s1>&#39;X-User-ID&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>g</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user_id&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>headers</span><span class=p>[</span><span class=s1>&#39;X-User-Role&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>g</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user_role&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 백엔드 서비스로 요청 전달</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;GET&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>target_url</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                    <span class=n>params</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>timeout</span><span class=o>=</span><span class=mi>30</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>target_url</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>json</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                    <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>timeout</span><span class=o>=</span><span class=mi>30</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;PUT&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>put</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>target_url</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>json</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                    <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>timeout</span><span class=o>=</span><span class=mi>30</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;DELETE&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>target_url</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>headers</span><span class=o>=</span><span class=n>headers</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>timeout</span><span class=o>=</span><span class=mi>30</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 응답 로깅</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Routed </span><span class=si>{</span><span class=n>method</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>target_url</span><span class=si>}</span><span class=s2> -&gt; </span><span class=si>{</span><span class=n>response</span><span class=o>.</span><span class=n>status_code</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 응답 반환</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>(),</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>Timeout</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Timeout routing to </span><span class=si>{</span><span class=n>service_name</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Service timeout&#39;</span><span class=p>}),</span> <span class=mi>504</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>ConnectionError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Connection error routing to </span><span class=si>{</span><span class=n>service_name</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Service unavailable&#39;</span><span class=p>}),</span> <span class=mi>503</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error routing to </span><span class=si>{</span><span class=n>service_name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Internal server error&#39;</span><span class=p>}),</span> <span class=mi>500</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># API Gateway 인스턴스 생성</span>
</span></span><span class=line><span class=cl><span class=n>gateway</span> <span class=o>=</span> <span class=n>APIGateway</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 라우트 정의</span>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/users/&lt;path:path&gt;&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span> <span class=s1>&#39;PUT&#39;</span><span class=p>,</span> <span class=s1>&#39;DELETE&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nd>@gateway.authenticate_request</span>
</span></span><span class=line><span class=cl><span class=nd>@gateway.rate_limit</span><span class=p>(</span><span class=n>max_requests</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> <span class=n>window</span><span class=o>=</span><span class=mi>60</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>user_service_proxy</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;사용자 서비스 프록시&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>gateway</span><span class=o>.</span><span class=n>route_request</span><span class=p>(</span><span class=s1>&#39;user-service&#39;</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&#34;/</span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/orders/&lt;path:path&gt;&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span> <span class=s1>&#39;PUT&#39;</span><span class=p>,</span> <span class=s1>&#39;DELETE&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nd>@gateway.authenticate_request</span>
</span></span><span class=line><span class=cl><span class=nd>@gateway.rate_limit</span><span class=p>(</span><span class=n>max_requests</span><span class=o>=</span><span class=mi>50</span><span class=p>,</span> <span class=n>window</span><span class=o>=</span><span class=mi>60</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>order_service_proxy</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;주문 서비스 프록시&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>gateway</span><span class=o>.</span><span class=n>route_request</span><span class=p>(</span><span class=s1>&#39;order-service&#39;</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&#34;/</span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/products/&lt;path:path&gt;&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nd>@gateway.cache_response</span><span class=p>(</span><span class=n>ttl</span><span class=o>=</span><span class=mi>600</span><span class=p>)</span>  <span class=c1># 10분 캐싱</span>
</span></span><span class=line><span class=cl><span class=nd>@gateway.rate_limit</span><span class=p>(</span><span class=n>max_requests</span><span class=o>=</span><span class=mi>200</span><span class=p>,</span> <span class=n>window</span><span class=o>=</span><span class=mi>60</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>product_service_proxy</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;상품 서비스 프록시 (읽기 전용, 캐싱 적용)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>gateway</span><span class=o>.</span><span class=n>route_request</span><span class=p>(</span><span class=s1>&#39;inventory-service&#39;</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&#34;/products/</span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s1>&#39;GET&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/payments/&lt;path:path&gt;&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nd>@gateway.authenticate_request</span>
</span></span><span class=line><span class=cl><span class=nd>@gateway.rate_limit</span><span class=p>(</span><span class=n>max_requests</span><span class=o>=</span><span class=mi>20</span><span class=p>,</span> <span class=n>window</span><span class=o>=</span><span class=mi>60</span><span class=p>)</span>  <span class=c1># 결제는 더 엄격한 제한</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>payment_service_proxy</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;결제 서비스 프록시&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>gateway</span><span class=o>.</span><span class=n>route_request</span><span class=p>(</span><span class=s1>&#39;payment-service&#39;</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&#34;/</span><span class=si>{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 헬스체크 엔드포인트</span>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/health&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>health_check</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;API Gateway 헬스체크&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;healthy&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;services&#39;</span><span class=p>:</span> <span class=nb>list</span><span class=p>(</span><span class=n>SERVICE_REGISTRY</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># API 문서 엔드포인트</span>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/docs&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>api_documentation</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;API 문서 제공&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>docs</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;title&#39;</span><span class=p>:</span> <span class=s1>&#39;E-commerce API Gateway&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;version&#39;</span><span class=p>:</span> <span class=s1>&#39;1.0.0&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;endpoints&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/api/users/*&#39;</span><span class=p>:</span> <span class=s1>&#39;User management operations&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/api/orders/*&#39;</span><span class=p>:</span> <span class=s1>&#39;Order management operations&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/api/products/*&#39;</span><span class=p>:</span> <span class=s1>&#39;Product catalog (cached)&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;/api/payments/*&#39;</span><span class=p>:</span> <span class=s1>&#39;Payment processing&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;authentication&#39;</span><span class=p>:</span> <span class=s1>&#39;JWT Bearer token required&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;rate_limits&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;users&#39;</span><span class=p>:</span> <span class=s1>&#39;100 requests/minute&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;orders&#39;</span><span class=p>:</span> <span class=s1>&#39;50 requests/minute&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;products&#39;</span><span class=p>:</span> <span class=s1>&#39;200 requests/minute&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;payments&#39;</span><span class=p>:</span> <span class=s1>&#39;20 requests/minute&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>docs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 에러 핸들러</span>
</span></span><span class=line><span class=cl><span class=nd>@app.errorhandler</span><span class=p>(</span><span class=mi>404</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>not_found_error</span><span class=p>(</span><span class=n>error</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Endpoint not found&#39;</span><span class=p>}),</span> <span class=mi>404</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.errorhandler</span><span class=p>(</span><span class=mi>500</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>internal_error</span><span class=p>(</span><span class=n>error</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Internal server error&#39;</span><span class=p>}),</span> <span class=mi>500</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>8080</span><span class=p>,</span> <span class=n>debug</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>설정 파일 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11>11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12>12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13>13</a>
</span><span class=lnt id=hl-16-14><a class=lnlinks href=#hl-16-14>14</a>
</span><span class=lnt id=hl-16-15><a class=lnlinks href=#hl-16-15>15</a>
</span><span class=lnt id=hl-16-16><a class=lnlinks href=#hl-16-16>16</a>
</span><span class=lnt id=hl-16-17><a class=lnlinks href=#hl-16-17>17</a>
</span><span class=lnt id=hl-16-18><a class=lnlinks href=#hl-16-18>18</a>
</span><span class=lnt id=hl-16-19><a class=lnlinks href=#hl-16-19>19</a>
</span><span class=lnt id=hl-16-20><a class=lnlinks href=#hl-16-20>20</a>
</span><span class=lnt id=hl-16-21><a class=lnlinks href=#hl-16-21>21</a>
</span><span class=lnt id=hl-16-22><a class=lnlinks href=#hl-16-22>22</a>
</span><span class=lnt id=hl-16-23><a class=lnlinks href=#hl-16-23>23</a>
</span><span class=lnt id=hl-16-24><a class=lnlinks href=#hl-16-24>24</a>
</span><span class=lnt id=hl-16-25><a class=lnlinks href=#hl-16-25>25</a>
</span><span class=lnt id=hl-16-26><a class=lnlinks href=#hl-16-26>26</a>
</span><span class=lnt id=hl-16-27><a class=lnlinks href=#hl-16-27>27</a>
</span><span class=lnt id=hl-16-28><a class=lnlinks href=#hl-16-28>28</a>
</span><span class=lnt id=hl-16-29><a class=lnlinks href=#hl-16-29>29</a>
</span><span class=lnt id=hl-16-30><a class=lnlinks href=#hl-16-30>30</a>
</span><span class=lnt id=hl-16-31><a class=lnlinks href=#hl-16-31>31</a>
</span><span class=lnt id=hl-16-32><a class=lnlinks href=#hl-16-32>32</a>
</span><span class=lnt id=hl-16-33><a class=lnlinks href=#hl-16-33>33</a>
</span><span class=lnt id=hl-16-34><a class=lnlinks href=#hl-16-34>34</a>
</span><span class=lnt id=hl-16-35><a class=lnlinks href=#hl-16-35>35</a>
</span><span class=lnt id=hl-16-36><a class=lnlinks href=#hl-16-36>36</a>
</span><span class=lnt id=hl-16-37><a class=lnlinks href=#hl-16-37>37</a>
</span><span class=lnt id=hl-16-38><a class=lnlinks href=#hl-16-38>38</a>
</span><span class=lnt id=hl-16-39><a class=lnlinks href=#hl-16-39>39</a>
</span><span class=lnt id=hl-16-40><a class=lnlinks href=#hl-16-40>40</a>
</span><span class=lnt id=hl-16-41><a class=lnlinks href=#hl-16-41>41</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># docker-compose.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;3.8&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>api-gateway</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>build</span><span class=p>:</span><span class=w> </span><span class=l>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;8080:8080&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>JWT_SECRET=your-secret-key</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>REDIS_URL=redis://redis:6379</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>depends_on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>user-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>order-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>payment-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>inventory-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>redis</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>redis:7-alpine</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;6379:6379&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>user-service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>user-service:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;8001:8001&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>order-service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>order-service:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;8002:8002&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>payment-service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>payment-service:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;8003:8003&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>inventory-service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>inventory-service:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;8004:8004&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=주목할-내용>주목할 내용<a hidden class=anchor aria-hidden=true href=#주목할-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>1. 아키텍처 설계</strong></td><td>API Gateway Architecture</td><td>클라이언트 요청을 수신하여 인증, 라우팅, 속도 제한 등을 수행하는 중앙 관문 역할</td></tr><tr><td></td><td>BFF (Backend for Frontend)</td><td>클라이언트 유형별로 최적화된 API 제공을 위한 아키텍처 패턴</td></tr><tr><td></td><td>마이크로게이트웨이</td><td>각 마이크로서비스 그룹별 독립적 게이트웨이 구성으로, 관리 및 확장성 향상</td></tr><tr><td></td><td>Service Mesh 통합</td><td>Istio, Linkerd 등과 연계하여 사이드카 기반 트래픽 제어 및 보안, 관찰성 확보</td></tr><tr><td></td><td>Event Gateway</td><td>Kafka, NATS 기반 비동기 메시지 처리를 위한 이벤트 중심 게이트웨이</td></tr><tr><td></td><td>WebAssembly 기반 게이트웨이</td><td>커스텀 플러그인, WASM 런타임을 활용하여 언어 독립적·고성능 API 게이트웨이 구현 가능</td></tr><tr><td></td><td>다중 영역 게이트웨이</td><td>내부/외부/파트너용 게이트웨이를 분리해 보안 및 관리 효율성 향상</td></tr><tr><td></td><td>Gateway API 표준화</td><td>Kubernetes Gateway API 등 개방형 인터페이스를 통한 상호운용성 확보</td></tr><tr><td><strong>2. 보안 및 인증</strong></td><td>중앙 인증 / 인가 통합</td><td>OAuth2, JWT, mTLS, OpenID Connect 등을 통해 중앙집중 인증·인가 체계 구축</td></tr><tr><td></td><td>Zero Trust 모델</td><td>모든 요청을 검증하고 최소 권한 원칙을 적용하는 보안 모델</td></tr><tr><td></td><td>API Positive Security</td><td>Swagger, OpenAPI 기반의 스키마 검증을 통해 알려지지 않은 공격 방어</td></tr><tr><td></td><td>탈중앙화 신원 관리</td><td>DID, VC 기반 분산 ID 시스템과의 통합</td></tr><tr><td><strong>3. 요청 처리 및 기능</strong></td><td>요청 라우팅/변환/오케스트레이션</td><td>다양한 경로에 따라 서비스 라우팅, 데이터 가공 및 복합 응답 통합 처리</td></tr><tr><td></td><td>Rate Limiting</td><td>클라이언트 단위 요청 제한을 통해 시스템 보호</td></tr><tr><td></td><td>사용자 정의 변환</td><td>요청/응답 포맷 또는 데이터 변형을 위한 커스텀 로직 적용 가능</td></tr><tr><td></td><td>프로토콜 변환</td><td>REST ↔ GraphQL/gRPC 등 이기종 통신 변환 지원</td></tr><tr><td></td><td>멀티 프로토콜 지원</td><td>WebSocket, REST, GraphQL, gRPC 등 다양한 통신 프로토콜에 대한 애그노스틱 처리 지원</td></tr><tr><td><strong>4. 성능 최적화</strong></td><td>캐싱 전략</td><td>CDN, Redis 등을 활용한 응답 캐싱으로 TPS 급증 대응 및 성능 개선</td></tr><tr><td></td><td>Edge Gateway</td><td>사용자에 가까운 위치에서 API 처리하여 지연 시간 감소</td></tr><tr><td></td><td>Backpressure</td><td>과도한 요청 시 처리 제한을 통해 시스템 과부하 방지</td></tr><tr><td></td><td>HTTP/3, QUIC 지원</td><td>차세대 전송 계층 프로토콜을 통해 연결 성능 및 안정성 향상</td></tr><tr><td><strong>5. 운영 및 관찰성</strong></td><td>Observability 통합</td><td>로그, 메트릭, 트레이싱을 통합하여 시스템 내부 상태 실시간 분석 가능</td></tr><tr><td></td><td>분산 트레이싱</td><td>OpenTelemetry, Jaeger, Zipkin 등으로 요청 경로 추적 및 SLA 모니터링</td></tr><tr><td></td><td>헬스 체크</td><td>API 상태 주기적 확인을 통해 장애 탐지 및 자동화 대응 가능</td></tr><tr><td></td><td>APM 통합</td><td>애플리케이션 성능 모니터링 도구 연계로 병목 추적</td></tr><tr><td></td><td>API 카탈로그 연동</td><td>API 메타데이터 및 사용 패턴 관리 가능</td></tr><tr><td><strong>6. 확장성 및 배포 전략</strong></td><td>Horizontal Scaling</td><td>API Gateway 의 무중단 확장과 자동 트래픽 분산 기능</td></tr><tr><td></td><td>무중단 배포 (Canary, B/G)</td><td>설정 변경 시에도 시스템 가용성 유지</td></tr><tr><td></td><td>플러그인 아키텍처</td><td>Kong, Tyk 기반의 Lua, Go 등 커스텀 플러그인 연동으로 동적 기능 확장 가능</td></tr><tr><td><strong>7. API 관리 및 수익화</strong></td><td>OpenAPI / Swagger 연동</td><td>API 명세 자동화, 검증, 문서화, 코드 생성 자동화</td></tr><tr><td></td><td>정책 자동화 및 배포</td><td>CI/CD 와 연계된 Gateway 설정/정책 동적 배포 가능</td></tr><tr><td></td><td>API 수익화</td><td>사용량 기반 과금, API 사용 분석 및 비즈니스 모델 연계 가능</td></tr><tr><td></td><td>통합 API 라이프사이클 관리</td><td>설계, 배포, 모니터링, 폐기까지 API 전주기 관리 기능 지원</td></tr><tr><td><strong>8. 클라우드 / DevOps 연계</strong></td><td>Serverless Gateway</td><td>AWS Lambda, CloudFront 연계로 서버리스 환경에서 API Gateway 운영 가능</td></tr><tr><td></td><td>Hybrid/Multi-Cloud 연동</td><td>여러 클라우드 및 온프레미스 간 API 트래픽 관리</td></tr><tr><td></td><td>eBPF 기반 고성능 처리</td><td>커널 수준 트래픽 필터링 및 관측 기능으로 초고성능 처리 가능</td></tr><tr><td></td><td></td><td></td></tr></tbody></table><p><strong>API Gateway</strong>는 현대적 마이크로서비스 아키텍처에서 클라이언트와 서비스 간의 연결을 관리하는 핵심 시스템 컴포넌트이다. 인증, 요청 라우팅, 응답 변환, 로깅, 트래픽 제어 등 다양한 기능을 중앙화하여, 시스템 보안과 운영 복잡도를 낮추고 확장성과 유연성을 확보한다.</p><p>실무 적용에서는 클라우드 기반 API Gateway(AWS, Azure, GCP) 나 오픈소스 솔루션 (Kong, Tyk, Envoy) 을 선택하여 목적에 따라 구현하며, 모니터링, 확장성, 보안, 고가용성을 고려한 설계가 필수이다.</p><h3 id=반드시-학습해야할-내용>반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야할-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>핵심 항목/기술</th><th>설명</th></tr></thead><tbody><tr><td><strong>기초 이해 및 설계</strong></td><td>API Gateway 기본 구조</td><td>Reverse Proxy, Routing 방식 (Path, Header, Content 기반 등)</td><td>기본 요청 처리 흐름과 라우팅 전략 구조 이해</td></tr><tr><td></td><td>아키텍처 패턴</td><td>BFF, Aggregator, Proxy, Edge Gateway</td><td>다양한 API Gateway 구현 방식 및 선택 기준 이해</td></tr><tr><td></td><td>API 디자인 표준</td><td>RESTful, OpenAPI, AsyncAPI, API CDD</td><td>일관성 있는 API 설계와 문서화, 계약 기반 개발 (CDD) 전략</td></tr><tr><td></td><td>버전 관리 전략</td><td>URI, 헤더, 미디어 타입 기반 버전 관리</td><td>하위 호환성을 유지하면서 API 를 진화시키는 전략</td></tr><tr><td><strong>보안 및 인증</strong></td><td>인증/인가 메커니즘</td><td>OAuth2, JWT, API Key, mTLS, RBAC, ABAC</td><td>인증/인가 흐름 및 권한 제어 정책 구현 (제로 트러스트 적용 포함)</td></tr><tr><td></td><td>보안 위협 및 방어</td><td>DoS/DDoS, OWASP API Top 10, Rate Limiting, WAF</td><td>보안 취약점 대응 및 위협 완화 전략 (WAF 통합, 인증 강화 등)</td></tr><tr><td></td><td>보안 정책 자동화</td><td>Policy as Code (OPA), 감사 로그, 접근 감사</td><td>규정 준수 및 보안 정책 관리 자동화</td></tr><tr><td><strong>운영 및 관찰성</strong></td><td>로깅 및 모니터링</td><td>Prometheus, Grafana, ELK, OpenTelemetry, Jaeger</td><td>요청 추적, 메트릭 수집, 분산 추적 등을 통한 가시성 확보</td></tr><tr><td></td><td>장애 복원 및 회복</td><td>Circuit Breaker, Retry, Timeout, Bulkhead</td><td>고가용성과 장애 전파 방지를 위한 복원 전략</td></tr><tr><td></td><td>배포 및 구성 자동화</td><td>CI/CD, GitOps, Terraform, Helm</td><td>API Gateway 의 배포 및 구성 자동화 방법 (Blue-Green, Canary 포함)</td></tr><tr><td></td><td>테스트 및 품질</td><td>API 테스트 자동화, Chaos Engineering</td><td>API 품질 보장 및 비정상 상황 대응 시뮬레이션</td></tr><tr><td><strong>성능 최적화</strong></td><td>캐싱 전략</td><td>CDN, Edge Caching, Redis/Memcached, 캐시 무효화 정책</td><td>응답 속도 개선 및 네트워크 부하 감소를 위한 캐싱 전략</td></tr><tr><td></td><td>부하 분산 및 스케일링</td><td>Load Balancer, Rate Limiting, 샤딩</td><td>트래픽 분산 및 수평/수직 확장 전략</td></tr><tr><td></td><td>고성능 설계</td><td>Connection Pooling, HTTP Keep-Alive, Thread Tuning</td><td>지연 최소화, 처리량 최대화를 위한 기술 적용</td></tr><tr><td><strong>클라우드 및 인프라</strong></td><td>컨테이너 및 서버리스 배포</td><td>Docker, Kubernetes, Helm, AWS Lambda, Azure Functions</td><td>클라우드 네이티브 환경에 최적화된 API Gateway 배포 전략</td></tr><tr><td></td><td>멀티클라우드 및 하이브리드</td><td>Cross-Cloud Gateway 구성, 온프레미스 연동</td><td>이기종 환경 간 API 연동과 통합 전략</td></tr><tr><td></td><td>엣지 컴퓨팅 연계</td><td>Cloudflare Workers, AWS CloudFront + API Gateway</td><td>엣지 위치에서의 빠른 응답 및 로컬 처리 전략</td></tr><tr><td><strong>프로그래밍 및 통합</strong></td><td>프로토콜 지원</td><td>REST, gRPC, WebSocket, GraphQL, SSE</td><td>다양한 프로토콜을 지원하는 API Gateway 구현 기술</td></tr><tr><td></td><td>서비스 디스커버리 및 라우팅</td><td>DNS 기반, Consul, Eureka, Weighted Routing</td><td>마이크로서비스 탐색 및 동적 라우팅 구현</td></tr><tr><td></td><td>데이터 처리 및 응답 가공</td><td>JSON/XML 포맷팅, 데이터 필터링, Aggregation</td><td>요청/응답 변환, 다중 응답 집계, 필드 마스킹 등</td></tr><tr><td><strong>비즈니스 및 전략</strong></td><td>API 수익화 및 제품화 전략</td><td>Monetization, Rate Plan, Developer Portal</td><td>API 를 수익 모델로 전환하고 외부 파트너 및 개발자에게 공개할 수 있는 전략</td></tr><tr><td></td><td>API 수명주기 관리</td><td>API Lifecycle (Publish, Deprecate, Retire)</td><td>API 의 진화 주기를 체계적으로 관리하는 방법</td></tr><tr><td></td><td>API 거버넌스 및 규제 대응</td><td>JSON Schema, OpenAPI 규격, GDPR/PSD2/HIPAA</td><td>규정 준수와 조직 차원의 API 거버넌스 수립</td></tr><tr><td><strong>최신 기술 동향</strong></td><td>AI 기반 API Gateway</td><td>트래픽 분석 기반 자동 조정, AI 기반 보안 위협 탐지</td><td>머신러닝을 통한 동적 정책 적용 및 이상 탐지</td></tr><tr><td></td><td>eBPF 기반 성능 최적화</td><td>Cilium, Calico, eBPF 로깅 및 필터링</td><td>커널 수준에서 네트워크 트래픽을 필터링하고 추적</td></tr><tr><td></td><td>WebAssembly 플러그인 확장</td><td>WASM 기반 확장 포인트 제공</td><td>Gateway 내 경량 실행 환경으로 커스텀 로직 구현</td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td><strong>아키텍처</strong></td><td>Reverse Proxy</td><td>클라이언트의 요청을 받아 내부 백엔드 서버로 전달하고, 응답을 반환하는 중간 서버</td></tr><tr><td></td><td>API Gateway</td><td>클라이언트 요청을 인증, 라우팅, 로깅, 제한하는 진입 지점으로서 역할</td></tr><tr><td></td><td>Ingress Controller</td><td>Kubernetes 환경에서 API Gateway 역할을 수행하는 컴포넌트</td></tr><tr><td></td><td>Service Mesh</td><td>마이크로서비스 간 통신을 추상화하고 제어하는 인프라 계층</td></tr><tr><td></td><td>Sidecar Pattern</td><td>주 서비스와 나란히 배치되어 기능을 분리하는 독립 실행 컴포넌트</td></tr><tr><td></td><td>BFF (Backend for Frontend)</td><td>프론트엔드별로 최적화된 백엔드 API 를 제공하는 설계 패턴</td></tr><tr><td></td><td>North-South Traffic</td><td>외부 클라이언트 ↔ 내부 시스템 간 통신 트래픽</td></tr><tr><td></td><td>East-West Traffic</td><td>마이크로서비스 간 내부 통신 트래픽</td></tr><tr><td></td><td>Microgateway</td><td>특정 서비스에 최적화된 경량 API Gateway</td></tr><tr><td><strong>보안 / 인증</strong></td><td>JWT (JSON Web Token)</td><td>클라이언트 인증에 사용되는 경량 JSON 기반 토큰</td></tr><tr><td></td><td>OAuth2</td><td>사용자 인증 및 권한 부여를 위한 표준 프레임워크</td></tr><tr><td></td><td>mTLS (Mutual TLS)</td><td>클라이언트 - 서버 간 양방향 TLS 인증</td></tr><tr><td></td><td>CORS (Cross-Origin Resource Sharing)</td><td>교차 출처 리소스 접근을 제어하는 브라우저 보안 정책</td></tr><tr><td></td><td>JWKS (JSON Web Key Set)</td><td>JWT 검증을 위한 공개 키 집합</td></tr><tr><td></td><td>Authentication</td><td>사용자의 신원을 확인하는 절차</td></tr><tr><td></td><td>Authorization</td><td>인증된 사용자에게 권한을 부여하는 절차</td></tr><tr><td><strong>운영 / 관측</strong></td><td>Rate Limiting</td><td>클라이언트의 요청 횟수를 제한하여 API 남용 방지</td></tr><tr><td></td><td>Health Check</td><td>서비스의 상태를 주기적으로 확인하는 메커니즘</td></tr><tr><td></td><td>APM (Application Performance Monitoring)</td><td>애플리케이션 성능 및 장애 추적 도구</td></tr><tr><td></td><td>Tracing</td><td>요청 흐름을 추적하여 병목 또는 장애 지점을 분석하는 기술 (예: OpenTelemetry)</td></tr><tr><td></td><td>OpenTelemetry</td><td>분산 추적, 로그, 메트릭 수집을 위한 표준 프레임워크</td></tr><tr><td><strong>성능 / 안정성</strong></td><td>Circuit Breaker</td><td>장애 전파를 방지하기 위한 회로 차단 패턴</td></tr><tr><td></td><td>Bulkhead Pattern</td><td>시스템 격리를 통해 장애 확산을 방지하는 패턴</td></tr><tr><td></td><td>Backpressure</td><td>과도한 요청을 제어하여 시스템 안정성을 유지하는 흐름 제어 기법</td></tr><tr><td></td><td>Connection Pooling</td><td>DB 또는 백엔드 연결을 재사용하여 성능을 최적화하는 기법</td></tr><tr><td><strong>패턴 / 설계</strong></td><td>API Composition</td><td>여러 API 의 응답을 결합하여 단일 응답으로 반환하는 패턴</td></tr><tr><td></td><td>API Orchestration</td><td>여러 서비스 호출을 조합하여 순차 처리하는 방식</td></tr><tr><td></td><td>Circuit Breaker</td><td>장애 전파를 막기 위한 보호 장치 역할의 디자인 패턴</td></tr><tr><td></td><td>Plugin (확장 기능)</td><td>API Gateway 기능 확장을 위한 모듈 단위 구성요소</td></tr><tr><td><strong>프로토콜</strong></td><td>gRPC</td><td>Google 에서 만든 고성능 RPC 프로토콜, Protobuf 기반</td></tr><tr><td></td><td>WebSocket</td><td>양방향 실시간 통신을 위한 프로토콜</td></tr><tr><td></td><td>QUIC</td><td>HTTP/3 에서 사용하는 UDP 기반의 신속한 전송 프로토콜</td></tr><tr><td><strong>API 관리</strong></td><td>OpenAPI/Swagger</td><td>API 명세를 문서화하고 자동화하는 도구 및 표준 포맷</td></tr><tr><td></td><td>API Monetization</td><td>API 사용량 기반의 과금 및 수익 창출 전략</td></tr><tr><td></td><td>SPoF (Single Point of Failure)</td><td>단일 실패 지점으로 인해 전체 시스템이 장애 발생 가능성</td></tr><tr><td><strong>기타 개념</strong></td><td>Cross-Cutting Concerns</td><td>로깅, 인증, 에러처리 등 시스템 전반에 적용되는 공통 기능</td></tr><tr><td></td><td>Protocol Translation</td><td>서로 다른 통신 프로토콜 간 변환을 지원하는 기능</td></tr><tr><td></td><td>SSL Termination</td><td>외부 TLS 연결을 Gateway 에서 종료하고 내부로 평문 전달</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://www.redhat.com/en/topics/api/what-does-an-api-gateway-do>What does an API gateway do? – Red Hat</a></li><li><a href=https://www.redhat.com/en/topics/api/what-is-api-management>What is API management? – Red Hat</a></li><li><a href=https://www.f5.com/glossary/api-gateway>What Is an API Gateway? – F5</a></li><li><a href=https://cloud.google.com/api-gateway/docs/architecture-overview>API Gateway Architecture Overview – Google Cloud</a></li><li><a href=https://docs.aws.amazon.com/apigateway/latest/developerguide/welcome.html>Amazon API Gateway – AWS Documentation</a></li><li><a href=https://www.geeksforgeeks.org/what-is-api-gateway-system-design/>What is API Gateway | System Design? – GeeksforGeeks</a></li><li><a href=https://konghq.com/blog/learning-center/what-is-an-api-gateway>Kong: What is an API Gateway? – KongHQ</a></li><li><a href=https://learn.microsoft.com/en-us/azure/architecture/microservices/design/gateway>API gateways – Azure Architecture Center</a></li><li><a href=https://zuplo.com/blog/2025/01/22/top-api-gateway-features>6 Must‑Have Features of an API Gateway – Zuplo Blog</a></li><li><a href=https://tyk.io/learning-center/what-is-an-api-gateway/>What is an API Gateway? – Tyk</a></li><li><a href=https://microservices.io/patterns/apigateway.html>API Gateway Pattern – microservices.io</a></li><li><a href=https://apisix.apache.org/blog/2022/09/08/api-monetization-using-stack/>API Monetization Using API Management – Apache APISIX</a></li><li><a href=https://www.ibm.com/blog/api-gateway/>IBM API Gateway 개요</a></li><li><a href=https://api7.ai/ko/blog/4-core-functions-of-api-gateway>API7 AI: API Gateway 핵심 기능</a></li><li><a href=https://cloud.google.com/api-gateway/docs/architecture-overview>Google Cloud API Gateway 아키텍처</a> *</li><li><a href=https://nginxstore.com/blog/api-gateway/api-gateway-%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80/>NGINX API Gateway 개념</a></li><li><a href=https://api7.ai/ko/learning-center/api-gateway-guide/>API7 AI: API Gateway 동향 / 모범 사례 / 핵심 개념 등</a></li><li><a href=https://dreamcoding.tistory.com/121>Dreamcoding: API Gateway 장단점</a></li><li><a href=https://wonit.tistory.com/489>Wonit: MSA API Gateway 패턴</a></li><li><a href="https://ideatec.co.kr/ipaas_news_/?bmode=view&amp;idx=6718917">iPaaS API Gateway 적용사례</a></li><li><a href=https://blog.naver.com/flex_ceo/222689099597>Naver: API Gateway 적용사례</a></li><li><a href=https://docs.aws.amazon.com/ko_kr/apigateway/latest/developerguide/api-gateway-overview-developer-experience.html>AWS API Gateway 사용 사례</a></li><li><a href=https://docs.microsoft.com/en-us/azure/architecture/microservices/design/gateway>Microsoft Architecture Guide: API Gateway Pattern</a></li><li><a href=https://docs.konghq.com/gateway/>Kong Gateway 공식 문서</a></li><li><a href=https://istio.io/latest/docs/>Istio Service Mesh Documentation</a></li><li><a href=https://www.nginx.com/solutions/api-management-gateway/>NGINX API Gateway Solutions</a></li><li><a href=https://martinfowler.com/articles/microservices.html>Martin Fowler – Microservices</a></li><li><a href=https://apigee.com/products/api-management>Apigee API Platform – Google</a></li><li><a href=https://www.mulesoft.com/platform/api>MuleSoft API Platform</a></li><li><a href=https://medium.com/paypal-tech/principles-of-an-api-gateway-2c18849ab3e2>PayPal – Principles of an API Gateway</a></li><li><a href=https://dashbird.io/knowledge-base/api-gateway/pros-and-cons-of-using-an-api-gateway/>Dashbird – Pros & Cons of Using an API Gateway</a></li><li><a href=https://securityboulevard.com/2023/11/what-is-an-api-gateway-definition-benefits-and-limitations/>Security Boulevard – What is an API Gateway? Definition, Benefits and Limitations</a></li><li><a href=https://www.designgurus.io/course-play/grokking-system-design-fundamentals/doc/advantages-and-disadvantages-of-using-api-gateway>DesignGurus.io – Advantages and disadvantages of using API gateway</a></li><li><a href=https://www.solo.io/topics/api-gateway/api-gateway-pattern>Solo.io – API Gateway Pattern: 5 Design Options and How to Choose</a></li><li><a href=https://info.support.huawei.com/info-finder/encyclopedia/en/API+Gateway.html>Huawai Encyclopedia – What Is an API Gateway? What Are Its Functions?</a></li><li><a href=https://learn.microsoft.com/en-us/azure/architecture/microservices/design/gateway>Microsoft Architecture Center – API gateways (중복 포함)</a></li><li><a href=https://netflixtechblog.com/zuul-2-the-netflix-journey-to-asynchronous-non-blocking-systems-45947377fb5e>Netflix Tech Blog – Zuul 2 (API Gateway 사례)</a></li></ul><hr><hr><h2 id=용어-정리-1>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-1>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>폴백 (Fallback) 메커니즘</td><td>시스템이나 애플리케이션에서 <strong>주요 동작이 실패했을 때, 대체 동작 또는 안전한 기본값을 실행하는 전략</strong><br>을 말한다. 장애 격리, 사용자 경험 유지, 시스템 안정성 확보 등을 목표로 한다.<br>외부 의존성 (API, DB 등) 에 문제가 생겨도 서비스가 완전히 멈추지 않으며, 마이크로 서비스, 서버리스 구조에서 Resilient 시스템 구성에 필수이다.<br>유형:<br>- 기본값 제공: 실패 시 미리 정의된 값 반환<br>- 캐시 사용: 최근 성공한 응답을 저장해 사용<br>- 대체 경로: 다른 서버나 백업 API 호출<br>- 사용자 알림: 실패를 사용자에게 알리고 대기 또는 취소 선택 유도</td></tr></tbody></table><hr></div></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2026 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>