<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Rate Limiting | hyunyoun's Blog</title><meta name=keywords content="Software-Engineering,Design-and-Architecture,Architecture-Styles-and-Patterns,Architecture-Patterns,Performance-and-Scalability-Patterns,Rate-Limiting"><meta name=description content="클라이언트/서비스 간 요청 처리량을 제어하는 메커니즘으로, 특히 API 기반 마이크로서비스 통신에서 중요하다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/system-architecture--design/performance--scalability/load-management/traffic-control/rate-limiting/rate-limiting/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.5311427199677f919b17469b4ca383951185b54edbae0ec7a5b4378f78d8f4f4.css integrity="sha256-UxFCcZlnf5GbF0abTKODlRGFtU7brg7HpbQ3j3jY9PQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/system-architecture--design/performance--scalability/load-management/traffic-control/rate-limiting/rate-limiting/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/system-architecture--design/performance--scalability/load-management/traffic-control/rate-limiting/rate-limiting/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Rate Limiting"><meta property="og:description" content="클라이언트/서비스 간 요청 처리량을 제어하는 메커니즘으로, 특히 API 기반 마이크로서비스 통신에서 중요하다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-18T12:08:00+00:00"><meta property="article:modified_time" content="2024-11-18T12:08:00+00:00"><meta property="article:tag" content="Software-Engineering"><meta property="article:tag" content="Design-and-Architecture"><meta property="article:tag" content="Architecture-Styles-and-Patterns"><meta property="article:tag" content="Architecture-Patterns"><meta property="article:tag" content="Performance-and-Scalability-Patterns"><meta property="article:tag" content="Rate-Limiting"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Rate Limiting"><meta name=twitter:description content="클라이언트/서비스 간 요청 처리량을 제어하는 메커니즘으로, 특히 API 기반 마이크로서비스 통신에서 중요하다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HY's Blog","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":7,"name":"Rate Limiting","item":"https://buenhyden.github.io/posts/system-architecture--design/performance--scalability/load-management/traffic-control/rate-limiting/rate-limiting/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Rate Limiting","name":"Rate Limiting","description":"클라이언트/서비스 간 요청 처리량을 제어하는 메커니즘으로, 특히 API 기반 마이크로서비스 통신에서 중요하다.","keywords":["Software-Engineering","Design-and-Architecture","Architecture-Styles-and-Patterns","Architecture-Patterns","Performance-and-Scalability-Patterns","Rate-Limiting"],"articleBody":"Rate Limiting Rate Limiting은 MSA(Microservices Architecture) 환경에서 시스템 보안과 안정성을 유지하기 위한 핵심 기술로, 과도한 트래픽으로 인한 서비스 장애 방지와 악성 공격 차단을 목표로 한다.\n클라이언트/서비스 간 요청 처리량을 제어하는 메커니즘으로, 특히 API 기반 마이크로서비스 통신에서 중요하다.\nRate Limiting은 단순 트래픽 제어를 넘어 마이크로서비스 생태계의 안전벨트 역할을 수행한다.\n2025년 현재, 주요 클라우드 제공업체들은 AI 기반 예측 차단 기능을 표준으로 제공하며, 이는 시스템 보안 설계 시 필수 요소로 자리잡았다. 효과적 구현을 위해서는 서비스 특성에 맞는 알고리즘 선택과 지속적 모니터링 체계 수립이 관건이다.\nRate Limiting의 핵심 목적 서비스 안정성 보장:\n단일 서비스의 과부하로 인한 전체 시스템 장애 방지 (예: 초당 1,000회 이상 요청 시 차단) 악성 공격 차단: DDoS 공격: 초당 수만 건 요청 탐지 및 차단 무차별 대입 공격(Brute-force): IP당 분당 5회 로그인 시도 제한 리소스 공정 분배:\nAPI 사용자별 할당량 관리 (예: 유료/무료 계층별 차등 처리) 동작 원리와 주요 알고리즘 기본 작동 흐름 sequenceDiagram Client-\u003e\u003e+서버: 요청 전송 서버-\u003e\u003eRate Limiter: 요청 카운트 증가 Rate Limiter--\u003e\u003e서버: 허용 여부 판단 alt 허용 서버-\u003e\u003e+비즈니스 로직: 처리 else 거부 서버--\u003e\u003e-Client: 429 Too Many Requests end 주요 제한 알고리즘 비교 알고리즘 특징 장점 단점 사용 사례 고정 창(Fixed Window) 지정 시간 내 요청 수 제한 구현 간편 창 경계 부근 트래픽 폭주 가능 단순 API 슬라이딩 창(Sliding Window) 이동 시간 창 기반 계산 부하 분산 효과 저장 공간 요구 실시간 트래픽 토큰 버킷(Token Bucket) 가상 토큰 소비 방식 버스트 트래픽 허용 복잡한 구현 스트리밍 서비스 누수 버킷(Leaky Bucket) 고정 처리율 유지 예측 가능한 처리량 지연 발생 가능 금융 거래 시스템 MSA 환경 구현 전략 계층별 적용 방식 API Gateway 레벨: Kong, AWS API Gateway에서 전역 정책 설정 클라이언트 IP/API 키별 할당량 관리 서비스 메시 레벨:\nIstio의 EnvoyFilter를 활용한 서비스 간 호출 제한 분산 추적 시스템 연동:\nRedis Cluster를 이용한 분산 카운터 관리 구현 예시 API Gateway 레벨에서의 구현:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 @Configuration public class GatewayConfig { @Bean public RouteLocator customRouteLocator(RouteLocatorBuilder builder) { return builder.routes() .route(\"user_service_route\", r -\u003e r .path(\"/api/users/**\") .filters(f -\u003e f .requestRateLimiter(config -\u003e config .setRateLimiter(redisRateLimiter()) .setKeyResolver(userKeyResolver()))) .uri(\"lb://user-service\")) .build(); } @Bean public RedisRateLimiter redisRateLimiter() { return new RedisRateLimiter(10, 20); // 초당 10개, 버스트 20개 } @Bean KeyResolver userKeyResolver() { return exchange -\u003e Mono.just( exchange.getRequest() .getHeaders() .getFirst(\"X-User-Id\")); } } 분산 환경에서의 Rate Limiting:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 import redis class DistributedRateLimiter: def __init__(self, redis_client, key_prefix, limit, window): self.redis = redis_client self.key_prefix = key_prefix self.limit = limit self.window = window def is_allowed(self, user_id): key = f\"{self.key_prefix}:{user_id}\" pipeline = self.redis.pipeline() now = time.time() pipeline.zadd(key, {now: now}) pipeline.zremrangebyscore(key, 0, now - self.window) pipeline.zcard(key) pipeline.expire(key, self.window) results = pipeline.execute() request_count = results[2] return request_count \u003c= self.limit Nginx를 활용\n1 2 3 4 5 6 7 8 9 10 11 12 http { # 공유 메모리 영역 정의: 각 클라이언트 IP당 초당 10개의 요청을 허용 limit_req_zone $binary_remote_addr zone=one:10m rate=10r/s; server { location / { # 정의한 영역을 사용하여 요청 제한 적용 limit_req zone=one burst=5 nodelay; proxy_pass http://backend_server; } } } limit_req_zone: 클라이언트의 IP 주소를 기준으로 초당 10개의 요청을 허용하는 공유 메모리 영역을 정의한다. limit_req: 정의된 영역을 사용하여 요청을 제한하며, burst는 추가로 허용할 수 있는 대기 요청 수를, nodelay는 지연 없이 즉시 응답을 반환하도록 설정한다. Spring Boot 설정\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 @Configuration public class RateLimitConfig { @Bean public RateLimiterRegistry rateLimiterRegistry() { return RateLimiterRegistry.custom() .addRateLimiterConfig(\"user-service\", RateLimiterConfig.custom() .limitForPeriod(100) .limitRefreshPeriod(Duration.ofMinutes(1)) .build()) .build(); } } 보안 강화 기법 동적 조정(Dynamic Rate Limiting):\nAI 기반 이상 트래픽 탐지 시 임계값 자동 조정 계절성 트래픽(예: 블랙프라이데이) 대응 자동화 1 2 3 4 5 6 7 8 9 10 class AdaptiveRateLimiter: def __init__(self, initial_limit): self.current_limit = initial_limit self.error_rate = 0 def adjust_limit(self, error_rate): if error_rate \u003e 0.1: # 에러율 10% 초과 self.current_limit = max(1, self.current_limit * 0.8) elif error_rate \u003c 0.05: # 에러율 5% 미만 self.current_limit *= 1.2 다중 계층 제한:\n1 사용자 → [IP 제한(1000/일)] → [API 키별(500/시간)] → [엔드포인트별(10/초)] 예외 처리 전략:\n재시도 지침 포함 HTTP 429 응답 Retry-After 헤더를 활용한 유예 시간 안내 모니터링과 최적화 핵심 지표: Request Rate(요청율) Error Rate(429 발생 비율) Throttle Time(제한 적용 시간) 튜닝 가이드라인: 피크 트래픽 시험: 부하 테스트로 최대 한계치 파악 점진적 조정: 20%씩 제한치 증가/감소 실험 보안 로그 분석:\n차단된 요청 패턴을 통한 신규 공격 유형 식별 구현 시 고려사항 식별자 선택:\n1 2 3 4 5 6 7 8 9 10 11 def get_rate_limit_key(request): # IP 기반 ip = request.remote_addr # 사용자 인증 기반 user_id = request.headers.get('X-User-Id') # API 키 기반 api_key = request.headers.get('X-API-Key') return f\"rate_limit:{ip}:{user_id}:{api_key}\" 응답 헤더 설정:\n1 2 3 4 5 def set_rate_limit_headers(response, limit, remaining, reset): response.headers['X-RateLimit-Limit'] = str(limit) response.headers['X-RateLimit-Remaining'] = str(remaining) response.headers['X-RateLimit-Reset'] = str(reset) return response 초과 요청 처리:\n1 2 3 4 5 6 def handle_rate_limit_exceeded(): response = { 'error': 'Rate limit exceeded', 'retry_after': calculate_retry_after() } return jsonify(response), 429 도입 시 고려사항 거짓 양성 문제: 합법적 사용자 차단 방지를 위한 화이트리스트 관리 비용 효율성: 클라우드 API 게이트웨이 사용 시 과금 모델 검토 법적 준수: GDPR 등 규정에 따른 지역별 차등 정책 (예: EU 사용자 20% 높은 할당량) 참고 및 출처 ","wordCount":"850","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2024-11-18T12:08:00Z","dateModified":"2024-11-18T12:08:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/system-architecture--design/performance--scalability/load-management/traffic-control/rate-limiting/rate-limiting/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>HY's Blog</a></div><h1 class="post-title entry-hint-parent">Rate Limiting</h1><div class=post-description>클라이언트/서비스 간 요청 처리량을 제어하는 메커니즘으로, 특히 API 기반 마이크로서비스 통신에서 중요하다.</div><div class=post-meta><span title='2024-11-18 12:08:00 +0000 UTC'>November 18, 2024</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/System%20Architecture%20&%20Design/Performance%20&%20Scalability/Load%20Management/Traffic%20Control/Rate%20Limiting/rate-limiting.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#rate-limiting>Rate Limiting</a><ul><li><a href=#rate-limiting의-핵심-목적>Rate Limiting의 핵심 목적</a></li><li><a href=#동작-원리와-주요-알고리즘>동작 원리와 주요 알고리즘</a></li><li><a href=#msa-환경-구현-전략>MSA 환경 구현 전략</a></li><li><a href=#보안-강화-기법>보안 강화 기법</a></li><li><a href=#모니터링과-최적화>모니터링과 최적화</a></li><li><a href=#구현-시-고려사항>구현 시 고려사항</a></li><li><a href=#도입-시-고려사항>도입 시 고려사항</a></li></ul></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=rate-limiting>Rate Limiting<a hidden class=anchor aria-hidden=true href=#rate-limiting>#</a></h2><p><strong>Rate Limiting</strong>은 MSA(Microservices Architecture) 환경에서 시스템 보안과 안정성을 유지하기 위한 핵심 기술로, <strong>과도한 트래픽으로 인한 서비스 장애 방지</strong>와 <strong>악성 공격 차단</strong>을 목표로 한다.<br>클라이언트/서비스 간 요청 처리량을 제어하는 메커니즘으로, 특히 API 기반 마이크로서비스 통신에서 중요하다.</p><p>Rate Limiting은 단순 트래픽 제어를 넘어 <strong>마이크로서비스 생태계의 안전벨트</strong> 역할을 수행한다.<br>2025년 현재, 주요 클라우드 제공업체들은 AI 기반 예측 차단 기능을 표준으로 제공하며, 이는 시스템 보안 설계 시 필수 요소로 자리잡았다. 효과적 구현을 위해서는 서비스 특성에 맞는 알고리즘 선택과 지속적 모니터링 체계 수립이 관건이다.</p><h3 id=rate-limiting의-핵심-목적>Rate Limiting의 핵심 목적<a hidden class=anchor aria-hidden=true href=#rate-limiting의-핵심-목적>#</a></h3><ol><li><strong>서비스 안정성 보장</strong>:<br>단일 서비스의 과부하로 인한 전체 시스템 장애 방지 (예: 초당 1,000회 이상 요청 시 차단)</li><li><strong>악성 공격 차단</strong>:<ul><li>DDoS 공격: 초당 수만 건 요청 탐지 및 차단</li><li>무차별 대입 공격(Brute-force): IP당 분당 5회 로그인 시도 제한</li></ul></li><li><strong>리소스 공정 분배</strong>:<br>API 사용자별 할당량 관리 (예: 유료/무료 계층별 차등 처리)</li></ol><h3 id=동작-원리와-주요-알고리즘>동작 원리와 주요 알고리즘<a hidden class=anchor aria-hidden=true href=#동작-원리와-주요-알고리즘>#</a></h3><h4 id=기본-작동-흐름>기본 작동 흐름<a hidden class=anchor aria-hidden=true href=#기본-작동-흐름>#</a></h4><pre class=mermaid>sequenceDiagram
    Client-&gt;&gt;+서버: 요청 전송
    서버-&gt;&gt;Rate Limiter: 요청 카운트 증가
    Rate Limiter--&gt;&gt;서버: 허용 여부 판단
    alt 허용
        서버-&gt;&gt;+비즈니스 로직: 처리
    else 거부
        서버--&gt;&gt;-Client: 429 Too Many Requests
    end
</pre><h4 id=주요-제한-알고리즘-비교>주요 제한 알고리즘 비교<a hidden class=anchor aria-hidden=true href=#주요-제한-알고리즘-비교>#</a></h4><table><thead><tr><th>알고리즘</th><th>특징</th><th>장점</th><th>단점</th><th>사용 사례</th></tr></thead><tbody><tr><td><strong>고정 창(Fixed Window)</strong></td><td>지정 시간 내 요청 수 제한</td><td>구현 간편</td><td>창 경계 부근 트래픽 폭주 가능</td><td>단순 API</td></tr><tr><td><strong>슬라이딩 창(Sliding Window)</strong></td><td>이동 시간 창 기반 계산</td><td>부하 분산 효과</td><td>저장 공간 요구</td><td>실시간 트래픽</td></tr><tr><td><strong>토큰 버킷(Token Bucket)</strong></td><td>가상 토큰 소비 방식</td><td>버스트 트래픽 허용</td><td>복잡한 구현</td><td>스트리밍 서비스</td></tr><tr><td><strong>누수 버킷(Leaky Bucket)</strong></td><td>고정 처리율 유지</td><td>예측 가능한 처리량</td><td>지연 발생 가능</td><td>금융 거래 시스템</td></tr></tbody></table><h3 id=msa-환경-구현-전략>MSA 환경 구현 전략<a hidden class=anchor aria-hidden=true href=#msa-환경-구현-전략>#</a></h3><h4 id=계층별-적용-방식>계층별 적용 방식<a hidden class=anchor aria-hidden=true href=#계층별-적용-방식>#</a></h4><ol><li><strong>API Gateway 레벨</strong>:<ul><li>Kong, AWS API Gateway에서 전역 정책 설정</li><li>클라이언트 IP/API 키별 할당량 관리</li></ul></li><li><strong>서비스 메시 레벨</strong>:<br>Istio의 <code>EnvoyFilter</code>를 활용한 서비스 간 호출 제한</li><li><strong>분산 추적 시스템 연동</strong>:<br>Redis Cluster를 이용한 분산 카운터 관리</li></ol><h4 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h4><ol><li><p>API Gateway 레벨에서의 구현:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16>16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17>17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18>18</a>
</span><span class=lnt id=hl-1-19><a class=lnlinks href=#hl-1-19>19</a>
</span><span class=lnt id=hl-1-20><a class=lnlinks href=#hl-1-20>20</a>
</span><span class=lnt id=hl-1-21><a class=lnlinks href=#hl-1-21>21</a>
</span><span class=lnt id=hl-1-22><a class=lnlinks href=#hl-1-22>22</a>
</span><span class=lnt id=hl-1-23><a class=lnlinks href=#hl-1-23>23</a>
</span><span class=lnt id=hl-1-24><a class=lnlinks href=#hl-1-24>24</a>
</span><span class=lnt id=hl-1-25><a class=lnlinks href=#hl-1-25>25</a>
</span><span class=lnt id=hl-1-26><a class=lnlinks href=#hl-1-26>26</a>
</span><span class=lnt id=hl-1-27><a class=lnlinks href=#hl-1-27>27</a>
</span><span class=lnt id=hl-1-28><a class=lnlinks href=#hl-1-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>GatewayConfig</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>RouteLocator</span><span class=w> </span><span class=nf>customRouteLocator</span><span class=p>(</span><span class=n>RouteLocatorBuilder</span><span class=w> </span><span class=n>builder</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>builder</span><span class=p>.</span><span class=na>routes</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>route</span><span class=p>(</span><span class=s>&#34;user_service_route&#34;</span><span class=p>,</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>r</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>path</span><span class=p>(</span><span class=s>&#34;/api/users/**&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>filters</span><span class=p>(</span><span class=n>f</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>f</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=p>.</span><span class=na>requestRateLimiter</span><span class=p>(</span><span class=n>config</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=p>.</span><span class=na>setRateLimiter</span><span class=p>(</span><span class=n>redisRateLimiter</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=p>.</span><span class=na>setKeyResolver</span><span class=p>(</span><span class=n>userKeyResolver</span><span class=p>())))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>uri</span><span class=p>(</span><span class=s>&#34;lb://user-service&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>RedisRateLimiter</span><span class=w> </span><span class=nf>redisRateLimiter</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>RedisRateLimiter</span><span class=p>(</span><span class=n>10</span><span class=p>,</span><span class=w> </span><span class=n>20</span><span class=p>);</span><span class=w> </span><span class=c1>// 초당 10개, 버스트 20개</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>KeyResolver</span><span class=w> </span><span class=nf>userKeyResolver</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>exchange</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>Mono</span><span class=p>.</span><span class=na>just</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>exchange</span><span class=p>.</span><span class=na>getRequest</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>getHeaders</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>getFirst</span><span class=p>(</span><span class=s>&#34;X-User-Id&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>분산 환경에서의 Rate Limiting:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span><span class=lnt id=hl-2-21><a class=lnlinks href=#hl-2-21>21</a>
</span><span class=lnt id=hl-2-22><a class=lnlinks href=#hl-2-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>redis</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DistributedRateLimiter</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>redis_client</span><span class=p>,</span> <span class=n>key_prefix</span><span class=p>,</span> <span class=n>limit</span><span class=p>,</span> <span class=n>window</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>redis</span> <span class=o>=</span> <span class=n>redis_client</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>key_prefix</span> <span class=o>=</span> <span class=n>key_prefix</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>limit</span> <span class=o>=</span> <span class=n>limit</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>window</span> <span class=o>=</span> <span class=n>window</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>is_allowed</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>key_prefix</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>pipeline</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>redis</span><span class=o>.</span><span class=n>pipeline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>now</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>pipeline</span><span class=o>.</span><span class=n>zadd</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=p>{</span><span class=n>now</span><span class=p>:</span> <span class=n>now</span><span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=n>pipeline</span><span class=o>.</span><span class=n>zremrangebyscore</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>now</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>pipeline</span><span class=o>.</span><span class=n>zcard</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>pipeline</span><span class=o>.</span><span class=n>expire</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>window</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>results</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>execute</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>request_count</span> <span class=o>=</span> <span class=n>results</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>request_count</span> <span class=o>&lt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>limit</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>Nginx를 활용</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1># 공유 메모리 영역 정의: 각 클라이언트 IP당 초당 10개의 요청을 허용
</span></span></span><span class=line><span class=cl>    <span class=kn>limit_req_zone</span> <span class=nv>$binary_remote_addr</span> <span class=s>zone=one:10m</span> <span class=s>rate=10r/s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1># 정의한 영역을 사용하여 요청 제한 적용
</span></span></span><span class=line><span class=cl>            <span class=kn>limit_req</span> <span class=s>zone=one</span> <span class=s>burst=5</span> <span class=s>nodelay</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass</span> <span class=s>http://backend_server</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong><code>limit_req_zone</code></strong>: 클라이언트의 IP 주소를 기준으로 초당 10개의 요청을 허용하는 공유 메모리 영역을 정의한다.</li><li><strong><code>limit_req</code></strong>: 정의된 영역을 사용하여 요청을 제한하며, <code>burst</code>는 추가로 허용할 수 있는 대기 요청 수를, <code>nodelay</code>는 지연 없이 즉시 응답을 반환하도록 설정한다.</li></ul></li><li><p>Spring Boot 설정</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>RateLimitConfig</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>RateLimiterRegistry</span><span class=w> </span><span class=nf>rateLimiterRegistry</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>RateLimiterRegistry</span><span class=p>.</span><span class=na>custom</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>addRateLimiterConfig</span><span class=p>(</span><span class=s>&#34;user-service&#34;</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>RateLimiterConfig</span><span class=p>.</span><span class=na>custom</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=p>.</span><span class=na>limitForPeriod</span><span class=p>(</span><span class=n>100</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=p>.</span><span class=na>limitRefreshPeriod</span><span class=p>(</span><span class=n>Duration</span><span class=p>.</span><span class=na>ofMinutes</span><span class=p>(</span><span class=n>1</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=p>.</span><span class=na>build</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=보안-강화-기법>보안 강화 기법<a hidden class=anchor aria-hidden=true href=#보안-강화-기법>#</a></h3><ol><li><p><strong>동적 조정(Dynamic Rate Limiting)</strong>:</p><ul><li>AI 기반 이상 트래픽 탐지 시 임계값 자동 조정</li><li>계절성 트래픽(예: 블랙프라이데이) 대응 자동화</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>AdaptiveRateLimiter</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>initial_limit</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>current_limit</span> <span class=o>=</span> <span class=n>initial_limit</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>error_rate</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>adjust_limit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>error_rate</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>error_rate</span> <span class=o>&gt;</span> <span class=mf>0.1</span><span class=p>:</span>  <span class=c1># 에러율 10% 초과</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>current_limit</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>current_limit</span> <span class=o>*</span> <span class=mf>0.8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>error_rate</span> <span class=o>&lt;</span> <span class=mf>0.05</span><span class=p>:</span>  <span class=c1># 에러율 5% 미만</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>current_limit</span> <span class=o>*=</span> <span class=mf>1.2</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>다중 계층 제한</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>사용자 → [IP 제한(1000/일)] → [API 키별(500/시간)] → [엔드포인트별(10/초)]
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>예외 처리 전략</strong>:</p><ul><li>재시도 지침 포함 HTTP 429 응답</li><li><code>Retry-After</code> 헤더를 활용한 유예 시간 안내</li></ul></li></ol><h3 id=모니터링과-최적화>모니터링과 최적화<a hidden class=anchor aria-hidden=true href=#모니터링과-최적화>#</a></h3><ol><li><strong>핵심 지표</strong>:<ul><li>Request Rate(요청율)</li><li>Error Rate(429 발생 비율)</li><li>Throttle Time(제한 적용 시간)</li></ul></li><li><strong>튜닝 가이드라인</strong>:<ul><li>피크 트래픽 시험: 부하 테스트로 최대 한계치 파악</li><li>점진적 조정: 20%씩 제한치 증가/감소 실험</li></ul></li><li><strong>보안 로그 분석</strong>:<br>차단된 요청 패턴을 통한 신규 공격 유형 식별</li></ol><h3 id=구현-시-고려사항>구현 시 고려사항<a hidden class=anchor aria-hidden=true href=#구현-시-고려사항>#</a></h3><ol><li><p>식별자 선택:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_rate_limit_key</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># IP 기반</span>
</span></span><span class=line><span class=cl>    <span class=n>ip</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>remote_addr</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 사용자 인증 기반</span>
</span></span><span class=line><span class=cl>    <span class=n>user_id</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;X-User-Id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># API 키 기반</span>
</span></span><span class=line><span class=cl>    <span class=n>api_key</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;X-API-Key&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;rate_limit:</span><span class=si>{</span><span class=n>ip</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>:</span><span class=si>{</span><span class=n>api_key</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>응답 헤더 설정:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>set_rate_limit_headers</span><span class=p>(</span><span class=n>response</span><span class=p>,</span> <span class=n>limit</span><span class=p>,</span> <span class=n>remaining</span><span class=p>,</span> <span class=n>reset</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=p>[</span><span class=s1>&#39;X-RateLimit-Limit&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>limit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=p>[</span><span class=s1>&#39;X-RateLimit-Remaining&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>remaining</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=p>[</span><span class=s1>&#39;X-RateLimit-Reset&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>reset</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>response</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>초과 요청 처리:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3>3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4>4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5>5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>handle_rate_limit_exceeded</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Rate limit exceeded&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;retry_after&#39;</span><span class=p>:</span> <span class=n>calculate_retry_after</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>response</span><span class=p>),</span> <span class=mi>429</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=도입-시-고려사항>도입 시 고려사항<a hidden class=anchor aria-hidden=true href=#도입-시-고려사항>#</a></h3><ul><li><strong>거짓 양성 문제</strong>: 합법적 사용자 차단 방지를 위한 화이트리스트 관리</li><li><strong>비용 효율성</strong>: 클라우드 API 게이트웨이 사용 시 과금 모델 검토</li><li><strong>법적 준수</strong>: GDPR 등 규정에 따른 지역별 차등 정책 (예: EU 사용자 20% 높은 할당량)</li></ul><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/software-engineering/>Software-Engineering</a></li><li><a href=https://buenhyden.github.io/tags/design-and-architecture/>Design-and-Architecture</a></li><li><a href=https://buenhyden.github.io/tags/architecture-styles-and-patterns/>Architecture-Styles-and-Patterns</a></li><li><a href=https://buenhyden.github.io/tags/architecture-patterns/>Architecture-Patterns</a></li><li><a href=https://buenhyden.github.io/tags/performance-and-scalability-patterns/>Performance-and-Scalability-Patterns</a></li><li><a href=https://buenhyden.github.io/tags/rate-limiting/>Rate-Limiting</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/networking--protocols/core-protocols/application-layer/protocols/identity--directory--aaa/federation--authorization/oauth-2.x/oauth2-oidc/><span class=title>« Prev</span><br><span>OAuth2/OIDC (OpenID Connect)</span>
</a><a class=next href=https://buenhyden.github.io/posts/networking--protocols/communication-patterns/message-infrastructure/message-processing/idempotent-processing/idempotent-consumer/><span class=title>Next »</span><br><span>Idempotent Consumer</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2026 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>