<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Microservices Architecture | hyunyoun's Blog</title><meta name=keywords content="Software-Engineering,Design-and-Architecture,Architecture-Styles-and-Patterns,Architecture-Styles,Cloud-Native,Microservices-Architecture,Distributed-Systems"><meta name=description content="마이크로서비스 아키텍처는 하나의 애플리케이션을 독립적으로 배포 가능한 작은 서비스들의 집합으로 구성하는 소프트웨어 아키텍처 스타일이다. 각 서비스는 특정 비즈니스 기능을 담당하며, API 를 통해 통신하고, 자체 데이터베이스를 보유한다. 확장성, 유연성, 기술적 다양성을 제공하여 현대 클라우드 네이티브 애플리케이션 개발의 핵심 방식으로 자리잡았다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/distributed-architecture/microservices/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/distributed-architecture/microservices/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/distributed-architecture/microservices/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/distributed-architecture/microservices/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Microservices Architecture"><meta property="og:description" content="마이크로서비스 아키텍처는 하나의 애플리케이션을 독립적으로 배포 가능한 작은 서비스들의 집합으로 구성하는 소프트웨어 아키텍처 스타일이다. 각 서비스는 특정 비즈니스 기능을 담당하며, API 를 통해 통신하고, 자체 데이터베이스를 보유한다. 확장성, 유연성, 기술적 다양성을 제공하여 현대 클라우드 네이티브 애플리케이션 개발의 핵심 방식으로 자리잡았다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Microservices Architecture"><meta name=twitter:description content="마이크로서비스 아키텍처는 하나의 애플리케이션을 독립적으로 배포 가능한 작은 서비스들의 집합으로 구성하는 소프트웨어 아키텍처 스타일이다. 각 서비스는 특정 비즈니스 기능을 담당하며, API 를 통해 통신하고, 자체 데이터베이스를 보유한다. 확장성, 유연성, 기술적 다양성을 제공하여 현대 클라우드 네이티브 애플리케이션 개발의 핵심 방식으로 자리잡았다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HY's Blog","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":5,"name":"Microservices Architecture","item":"https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/distributed-architecture/microservices/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>HY's Blog</a></div><h1>Microservices Architecture</h1><div class=post-description>마이크로서비스 아키텍처는 하나의 애플리케이션을 독립적으로 배포 가능한 작은 서비스들의 집합으로 구성하는 소프트웨어 아키텍처 스타일이다. 각 서비스는 특정 비즈니스 기능을 담당하며, API 를 통해 통신하고, 자체 데이터베이스를 보유한다. 확장성, 유연성, 기술적 다양성을 제공하여 현대 클라우드 네이티브 애플리케이션 개발의 핵심 방식으로 자리잡았다.</div></header><div class=post-content><h2 id=microservices-architecture>Microservices Architecture<a hidden class=anchor aria-hidden=true href=#microservices-architecture>#</a></h2><p>Microservices Architecture(마이크로서비스 아키텍처) 는 복잡한 애플리케이션을 작고 독립적으로 배포 가능한 서비스 단위로 분해하여, 각 서비스가 자체 데이터와 비즈니스 로직을 관리하고, API 를 통해 상호작용하는 아키텍처 스타일이다. 이 구조는 확장성과 장애 격리, 빠른 배포, 기술 스택의 다양화, 팀별 독립 개발 등 다양한 이점을 제공한다. 반면, 서비스 간 통신, 데이터 일관성, 운영 관리 복잡성 등 새로운 도전 과제도 동반한다. Netflix, Amazon 등 글로벌 IT 기업들이 대표적으로 적용하고 있다.</p><h3 id=배경>배경<a hidden class=anchor aria-hidden=true href=#배경>#</a></h3><p><strong>모놀리식 아키텍처의 한계</strong>:</p><ul><li>대규모 애플리케이션에서 코드베이스 복잡성 증가</li><li>부분적 변경을 위해 전체 애플리케이션 재배포 필요</li><li>기술 스택 다양성 제한</li><li>확장 시 전체 애플리케이션 스케일링 필요</li></ul><p><strong>역사적 발전 과정:</strong></p><ul><li><strong>2000 년대 초</strong>: SOA (Service-Oriented Architecture) 등장</li><li><strong>2005-2010 년</strong>: Amazon, Netflix 등이 확장성 문제 해결을 위해 서비스 분해 실험</li><li><strong>2011 년</strong>: " 마이크로서비스 " 용어 등장</li><li><strong>2014 년</strong>: Martin Fowler 와 James Lewis 가 마이크로서비스 개념 정리</li><li><strong>2015 년 이후</strong>: 주류 아키텍처 패턴으로 확산</li></ul><p><strong>기술적 배경:</strong></p><ul><li>클라우드 컴퓨팅의 성숙</li><li>컨테이너화 기술 (Docker) 발전</li><li>API 중심 설계 패러다임 확산</li><li>DevOps 문화와 자동화 도구 발전</li><li>쿠버네티스 등 오케스트레이션 플랫폼 성숙</li><li>클라우드 네이티브 환경에서 자동 확장성 제공</li></ul><p>마이크로서비스 아키텍처는 2000 년대 초반 대규모 웹 서비스의 확산과 함께 등장했다. 초기에는 Amazon 과 Netflix 같은 기업들이 모놀리식 시스템의 한계를 극복하기 위해 서비스 지향 아키텍처 (SOA) 를 발전시키면서 시작되었다.</p><h3 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h3><p><strong>비즈니스 목적</strong>:</p><ul><li><strong>개발 속도 향상</strong>: 팀별 독립적 개발 및 배포로 출시 시간 단축</li><li><strong>기술 혁신 촉진</strong>: 서비스별 최적 기술 스택 선택 가능</li><li><strong>시장 적응성</strong>: 빠른 기능 추가 및 변경으로 시장 변화 대응</li><li><strong>비용 최적화</strong>: 필요한 서비스만 확장하여 리소스 효율성 증대</li></ul><p><strong>기술적 필요성</strong>:</p><ul><li><strong>확장성</strong>: 서비스별 독립적 확장으로 성능 최적화</li><li><strong>장애 격리</strong>: 일부 서비스 장애가 전체 시스템에 미치는 영향 최소화</li><li><strong>기술 다양성</strong>: 서비스 특성에 맞는 최적 기술 스택 활용</li><li><strong>유지보수성</strong>: 작은 단위의 코드베이스로 이해 및 수정 용이</li></ul><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><p>Microservices Architecture(마이크로서비스 아키텍처) 는 하나의 대규모 애플리케이션을 독립적으로 배포, 확장, 관리할 수 있는 작은 서비스 (마이크로서비스) 들의 집합으로 구성하는 아키텍처 스타일이다.</p><h4 id=주요-개념>주요 개념<a hidden class=anchor aria-hidden=true href=#주요-개념>#</a></h4><ol><li><p><strong>서비스 분해 (Service Decomposition)</strong></p><ul><li>단일 책임 원칙 (Single Responsibility Principle) 기반의 서비스 설계</li><li>비즈니스 도메인 중심의 경계 설정 (Domain-Driven Design, DDD)</li><li>느슨한 결합 (Loose Coupling) 과 높은 응집도 (High Cohesion) 추구</li></ul></li><li><p><strong>독립성 (Independence)</strong></p><ul><li>개발, 배포, 확장의 독립성</li><li>서비스별 전용 데이터베이스 (Database per Service)</li><li>기술 스택의 자유로운 선택 (Polyglot Programming)</li></ul></li><li><p><strong>분산 시스템 특성</strong></p><ul><li>네트워크를 통한 서비스 간 통신</li><li>분산 데이터 관리 및 일관성 처리</li><li>장애 격리 (Fault Isolation) 및 복원력 (Resilience)</li></ul></li><li><p><strong>API 기반 통신</strong></p><ul><li>RESTful API, gRPC, 메시징 시스템 활용</li><li>서비스 디스커버리 (Service Discovery) 메커니즘</li><li>비동기 통신 패턴 지원</li></ul></li><li><p><strong>DevOps 통합</strong></p><ul><li>지속적 통합/배포 (CI/CD) 파이프라인</li><li>컨테이너화 (Containerization) 및 오케스트레이션</li><li>모니터링 및 관찰 가능성 (Observability)</li></ul></li></ol><h4 id=실무-구현-연관성-분석>실무 구현 연관성 분석<a hidden class=anchor aria-hidden=true href=#실무-구현-연관성-분석>#</a></h4><p><strong>개발 측면:</strong></p><ul><li>팀 구조: Conway&rsquo;s Law 에 따라 조직 구조가 아키텍처에 반영</li><li>코드베이스: 서비스별 독립적인 저장소 관리</li><li>테스팅: 단위 테스트, 통합 테스트, 계약 테스트 (Contract Testing) 전략</li></ul><p><strong>운영 측면:</strong></p><ul><li>인프라스트럭처: 클라우드 네이티브 환경에서 컨테이너 기반 배포</li><li>모니터링: 분산 추적 (Distributed Tracing), 로그 집계, 메트릭 수집</li><li>보안: 서비스 메시 (Service Mesh) 활용한 보안 정책 적용</li></ul><p><strong>데이터 측면:</strong></p><ul><li>데이터 일관성: 이벤트 소싱 (Event Sourcing), SAGA 패턴 활용</li><li>데이터 동기화: 이벤트 드리븐 아키텍처 (Event-Driven Architecture) 구현</li><li>캐싱: 분산 캐싱 전략 및 캐시 무효화 처리</li></ul><h3 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h3><ol><li><p><strong>서비스 분해 (Service Decomposition)</strong></p><ul><li>비즈니스 기능별 서비스 분리</li><li>독립적인 배포 단위 생성</li><li>팀 구조와 서비스 구조 일치 (Conway&rsquo;s Law 적용)</li></ul></li><li><p><strong>서비스 통신 (Service Communication)</strong></p><ul><li>REST API, GraphQL, gRPC 등을 통한 동기 통신</li><li>메시지 큐, 이벤트 스트림을 통한 비동기 통신</li><li>서비스 간 계약 정의 및 버전 관리</li></ul></li><li><p><strong>데이터 관리 (Data Management)</strong></p><ul><li>서비스별 독립적 데이터베이스 운영</li><li>분산 트랜잭션 처리</li><li>데이터 일관성 보장 메커니즘</li></ul></li><li><p><strong>운영 및 모니터링</strong></p><ul><li>분산 추적 (Distributed Tracing)</li><li>중앙집중식 로깅</li><li>서비스 헬스 체크 및 장애 감지</li></ul></li></ol><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><ol><li><p><strong>독립성 (Independence)</strong></p><ul><li><strong>개발 독립성</strong>: 각 팀이 독립적으로 서비스 개발 가능</li><li><strong>배포 독립성</strong>: 다른 서비스에 영향 없이 개별 서비스 배포</li><li><strong>기술 독립성</strong>: 서비스별 최적 기술 스택 선택 가능</li><li><strong>확장 독립성</strong>: 필요에 따라 개별 서비스만 확장</li></ul></li><li><p><strong>분산성 (Distribution)</strong></p><ul><li><strong>네트워크 기반 통신</strong>: 서비스 간 네트워크를 통한 상호작용</li><li><strong>지리적 분산</strong>: 여러 데이터센터에 서비스 분산 배치 가능</li><li><strong>로드 밸런싱</strong>: 트래픽을 여러 인스턴스에 분산</li></ul></li><li><p><strong>탄력성 (Resilience)</strong></p><ul><li><strong>장애 격리</strong>: 개별 서비스 장애가 전체 시스템에 전파되지 않음</li><li><strong>자동 복구</strong>: 헬스 체크를 통한 자동 재시작</li><li><strong>백프레셔 처리</strong>: 부하 상황에서의 적절한 대응 메커니즘</li></ul></li></ol><h3 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h3><ol><li><p><strong>단일 책임 원칙 (Single Responsibility Principle)</strong></p><ul><li>각 서비스는 하나의 비즈니스 기능에만 집중</li><li>명확한 서비스 경계 정의</li><li>높은 응집도 추구</li></ul></li><li><p><strong>자율성 (Autonomy)</strong></p><ul><li>독립적인 개발, 배포, 확장</li><li>서비스별 팀 소유권 (Team Ownership)</li><li>의사결정의 분산화</li></ul></li><li><p><strong>분산 거버넌스 (Decentralized Governance)</strong></p><ul><li>중앙 집중식 통제 최소화</li><li>서비스별 기술 선택 자유</li><li>표준화와 자율성의 균형</li></ul></li><li><p><strong>장애 대비 설계 (Design for Failure)</strong></p><ul><li>장애를 예상하고 대비하는 설계</li><li>우아한 성능 저하 구현</li><li>빠른 복구 메커니즘</li></ul></li><li><p><strong>진화 가능성 (Evolvability)</strong></p><ul><li>변화에 대한 유연한 대응</li><li>하위 호환성 유지</li><li>점진적 업그레이드 지원</li></ul></li></ol><h3 id=주요-원리>주요 원리<a hidden class=anchor aria-hidden=true href=#주요-원리>#</a></h3><h4 id=서비스-분해-원리>서비스 분해 원리<a hidden class=anchor aria-hidden=true href=#서비스-분해-원리>#</a></h4><p>마이크로서비스 경계를 정의하는 가장 효과적인 방법 중 하나는 비즈니스 도메인을 기반으로 하는 것이다. 도메인 주도 설계는 이러한 접근 방식을 제공한다.</p><pre class=mermaid>graph TD
    A[모놀리식 애플리케이션] --&gt; B[비즈니스 기능 분석]
    B --&gt; C[도메인 경계 식별]
    C --&gt; D[서비스 후보 정의]
    D --&gt; E[데이터 의존성 분석]
    E --&gt; F[서비스 경계 확정]
    F --&gt; G[마이크로서비스 설계]
    
    H[DDD 적용] --&gt; C
    I[컨웨이 법칙 고려] --&gt; D
    J[트랜잭션 경계 분석] --&gt; E
</pre><p>마이크로서비스 분해는 비즈니스 도메인을 중심으로 진행된다. 도메인 주도 설계 (DDD) 의 경계 컨텍스트 (Bounded Context) 개념을 활용하여 서비스 간 명확한 경계를 설정한다.</p><h4 id=api-중심-설계-api-first-design>API 중심 설계 (API-First Design)<a hidden class=anchor aria-hidden=true href=#api-중심-설계-api-first-design>#</a></h4><p>API 를 구현하기 전에 API 를 먼저 설계하는 접근 방식으로, 클라이언트와 서버 개발 팀이 독립적으로 작업할 수 있게 한다.</p><p><strong>프로세스:</strong></p><ol><li>API 명세 작성 (OpenAPI/Swagger 등)</li><li>API 계약에 대한 이해관계자 동의 확보</li><li>모의 서버 (Mock Server) 생성으로 병렬 개발 지원</li><li>API 구현 및 계약 테스트</li></ol><h4 id=데이터-관리-원리>데이터 관리 원리<a hidden class=anchor aria-hidden=true href=#데이터-관리-원리>#</a></h4><p>마이크로서비스에서는 각 서비스가 자체 데이터베이스를 소유하며, 서비스 간 데이터 공유는 API 를 통해서만 이루어진다. 분산 트랜잭션은 SAGA 패턴을 통해 관리된다.</p><h4 id=자율성과-느슨한-결합>자율성과 느슨한 결합<a hidden class=anchor aria-hidden=true href=#자율성과-느슨한-결합>#</a></h4><p>마이크로서비스의 핵심 가치 중 하나는 서비스 팀의 자율성이다. 이를 위해 서비스 간의 느슨한 결합이 필수적이다.</p><p><strong>원칙:</strong></p><ul><li>동기적 호출 최소화</li><li>API 버전 관리 전략 수립</li><li>공유 데이터베이스 지양</li><li>비동기 통신 활용</li><li>서비스별 독립적인 배포 파이프라인 구축</li></ul><h4 id=내결함성-설계>내결함성 설계<a hidden class=anchor aria-hidden=true href=#내결함성-설계>#</a></h4><p>분산 시스템에서는 네트워크 지연, 서비스 장애 등 다양한 장애 상황이 발생할 수 있다. 마이크로서비스는 이러한 장애에 대비한 설계가 필요하다.</p><p><strong>패턴:</strong></p><ul><li><strong>서킷 브레이커 (Circuit Breaker)</strong>: 장애 서비스로의 호출을 차단하여 시스템 보호</li><li><strong>타임아웃 (Timeout)</strong>: 응답 지연에 대한 방어 메커니즘</li><li><strong>재시도 (Retry)</strong>: 일시적 장애에 대응하기 위한 자동 재시도</li><li><strong>폴백 (Fallback)</strong>: 서비스 호출 실패 시 대체 응답 제공</li><li><strong>벌크헤드 (Bulkhead)</strong>: 장애 격리를 위한 리소스 할당 제한</li></ul><h3 id=작동-원리-및-방식>작동 원리 및 방식<a hidden class=anchor aria-hidden=true href=#작동-원리-및-방식>#</a></h3><h4 id=요청-처리-흐름>요청 처리 흐름<a hidden class=anchor aria-hidden=true href=#요청-처리-흐름>#</a></h4><pre class=mermaid>sequenceDiagram
    participant C as Client
    participant AG as API Gateway
    participant US as User Service
    participant OS as Order Service
    participant PS as Payment Service
    participant MB as Message Broker
    
    C-&gt;&gt;AG: 주문 요청
    AG-&gt;&gt;AG: 인증/인가 검증
    AG-&gt;&gt;US: 사용자 정보 조회
    US-&gt;&gt;AG: 사용자 정보 반환
    AG-&gt;&gt;OS: 주문 생성 요청
    OS-&gt;&gt;OS: 주문 데이터 저장
    OS-&gt;&gt;MB: 주문 생성 이벤트 발행
    MB-&gt;&gt;PS: 주문 생성 이벤트 전달
    PS-&gt;&gt;PS: 결제 처리 준비
    OS-&gt;&gt;AG: 주문 ID 반환
    AG-&gt;&gt;C: 주문 완료 응답
</pre><ol><li><strong>클라이언트 요청</strong>: 모든 클라이언트 요청은 API 게이트웨이를 통해 전달</li><li><strong>라우팅</strong>: API 게이트웨이가 적절한 마이크로서비스로 요청 라우팅</li><li><strong>서비스 처리</strong>: 각 마이크로서비스가 독립적으로 비즈니스 로직 처리</li><li><strong>이벤트 발행</strong>: 상태 변경 시 이벤트를 발행하여 다른 서비스에 알림</li><li><strong>응답 반환</strong>: 처리 결과를 클라이언트에게 반환</li></ol><h4 id=서비스-간-통신-방식>서비스 간 통신 방식<a hidden class=anchor aria-hidden=true href=#서비스-간-통신-방식>#</a></h4><p><strong>동기 통신</strong>:</p><ul><li>REST API: HTTP/HTTPS 기반 RESTful 서비스</li><li>GraphQL: 클라이언트가 필요한 데이터만 요청</li><li>gRPC: 고성능 RPC 프레임워크</li></ul><p><strong>비동기 통신</strong>:</p><ul><li>메시지 큐: 점대점 메시징</li><li>이벤트 스트림: 발행 - 구독 패턴</li><li>웹훅: HTTP 콜백 기반 알림</li></ul><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><h4 id=전체-아키텍처-구조>전체 아키텍처 구조<a hidden class=anchor aria-hidden=true href=#전체-아키텍처-구조>#</a></h4><pre class=mermaid>graph TB
    subgraph &#34;클라이언트 계층&#34;
        Web[웹 애플리케이션]
        Mobile[모바일 앱]
        API_Client[API 클라이언트]
    end
    
    subgraph &#34;API 게이트웨이 계층&#34;
        Gateway[API Gateway]
        LB[로드 밸런서]
    end
    
    subgraph &#34;서비스 계층&#34;
        UserService[사용자 서비스]
        OrderService[주문 서비스]
        PaymentService[결제 서비스]
        ProductService[상품 서비스]
        NotificationService[알림 서비스]
    end
    
    subgraph &#34;데이터 계층&#34;
        UserDB[(사용자 DB)]
        OrderDB[(주문 DB)]
        PaymentDB[(결제 DB)]
        ProductDB[(상품 DB)]
    end
    
    subgraph &#34;인프라스트럭처 계층&#34;
        ServiceMesh[서비스 메시]
        Monitoring[모니터링]
        ConfigServer[설정 서버]
        MessageBus[메시지 버스]
    end
    
    Web --&gt; Gateway
    Mobile --&gt; Gateway
    API_Client --&gt; Gateway
    Gateway --&gt; LB
    LB --&gt; UserService
    LB --&gt; OrderService
    LB --&gt; PaymentService
    LB --&gt; ProductService
    
    UserService --&gt; UserDB
    OrderService --&gt; OrderDB
    PaymentService --&gt; PaymentDB
    ProductService --&gt; ProductDB
    
    UserService -.-&gt; MessageBus
    OrderService -.-&gt; MessageBus
    PaymentService -.-&gt; MessageBus
    NotificationService -.-&gt; MessageBus
    
    ServiceMesh -.-&gt; UserService
    ServiceMesh -.-&gt; OrderService
    ServiceMesh -.-&gt; PaymentService
    ServiceMesh -.-&gt; ProductService
</pre><h4 id=구성-요소>구성 요소<a hidden class=anchor aria-hidden=true href=#구성-요소>#</a></h4><table><thead><tr><th>구성 요소</th><th>기능</th><th>역할</th><th>특징</th></tr></thead><tbody><tr><td><strong>마이크로서비스</strong></td><td>특정 비즈니스 기능 구현</td><td>독립적인 배포 단위, 비즈니스 로직 처리</td><td>상태 비저장, 자율 운영, 개별 스케일링 가능</td></tr><tr><td><strong>API 게이트웨이</strong></td><td>요청 라우팅, 인증/인가, 속도 제한</td><td>서비스 진입점, 횡단 관심사 처리</td><td>단일 진입점, 요청/응답 변환, 프로토콜 변환</td></tr><tr><td><strong>서비스 레지스트리</strong></td><td>서비스 위치 정보 관리</td><td>서비스 디스커버리 지원</td><td>동적 등록/해제, 헬스 체크, 클라이언트 - 서버 위치 정보 매핑</td></tr><tr><td><strong>설정 서버</strong></td><td>중앙화된 설정 관리</td><td>환경별 설정 제공, 설정 변경 반영</td><td>버전 관리, 암호화 지원, 실시간 구성 반영 가능</td></tr><tr><td><strong>데이터 저장소</strong></td><td>서비스 전용 데이터 저장</td><td>데이터 영속성 보장</td><td>서비스별 독립, 다양한 DB 유형 지원 (RDB, NoSQL 등)</td></tr><tr><td><strong>서비스 메시</strong> <em>(선택)</em></td><td>서비스 간 통신, 보안, 모니터링</td><td>네트워크 레벨 서비스 관리</td><td>사이드카 패턴, 트래픽 제어, mTLS, 정책 기반 통신 관리</td></tr><tr><td><strong>메시지 브로커</strong> <em>(선택)</em></td><td>비동기 메시지 전달</td><td>이벤트 기반 통신 지원</td><td>발행 - 구독 모델, 메시지 영속성 및 순서 보장</td></tr><tr><td><strong>모니터링 시스템</strong> <em>(선택)</em></td><td>시스템 상태, 로그, 트레이싱 수집</td><td>운영 가시성 제공</td><td>메트릭, 로그, 분산 추적 통합, 경고/알림 지원</td></tr><tr><td><strong>CI/CD 파이프라인</strong> <em>(선택)</em></td><td>빌드, 테스트, 배포 자동화</td><td>지속적 통합 및 배포 지원</td><td>서비스별 파이프라인, 자동화 테스트, 무중단 배포 가능</td></tr><tr><td><strong>컨테이너 오케스트레이션</strong> <em>(선택)</em></td><td>컨테이너 수명주기 및 리소스 관리</td><td>서비스 배포 및 확장 자동화</td><td>자동 복구, 스케줄링, 롤링 업데이트, 자가 치유</td></tr></tbody></table><h3 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h3><table><thead><tr><th>카테고리</th><th>구현 기법</th><th>정의 및 구성요소</th><th>목적</th><th>실제 예시</th></tr></thead><tbody><tr><td><strong>서비스 분해</strong></td><td>도메인 주도 분해 (DDD)</td><td>도메인 모델, 바운디드 컨텍스트, 애그리거트 기반 서비스 경계 설정</td><td>응집도 높은 서비스 구성, 도메인 중심 아키텍처 실현</td><td>전자상거래 도메인 → 주문, 결제, 배송 서비스 분할</td></tr><tr><td></td><td>트랜잭션 기반 분해</td><td>트랜잭션 흐름 분석 → 독립 처리 가능한 서비스로 분할 → SAGA 패턴 적용</td><td>트랜잭션 경계 명확화, 데이터 일관성 보장</td><td>주문 처리 트랜잭션 → 주문, 결제, 재고 서비스 분할</td></tr><tr><td><strong>API 설계/통신 패턴</strong></td><td>API Gateway 패턴</td><td>단일 진입점, 인증/인가, 요청 집계, 속도 제한, 로깅 기능 포함</td><td>클라이언트 복잡성 감소, 횡단 관심사 집중 처리</td><td>사용자 대시보드 요청 → API Gateway → 여러 서비스 병렬 호출</td></tr><tr><td></td><td>BFF (Backend For Frontend)</td><td>프론트엔드 특화 API 제공 → 모바일/웹 별도 구성</td><td>클라이언트 맞춤형 API 구성</td><td>모바일용 경량 API, 웹용 풍부한 API 제공</td></tr><tr><td></td><td>동기 통신 (REST, gRPC)</td><td>요청/응답 기반, 빠른 응답 필요 시 사용</td><td>간단한 통신, 낮은 지연시간 요구 시 적합</td><td>사용자 인증 요청, 상세정보 조회</td></tr><tr><td></td><td>비동기 통신 (Event Streaming 등)</td><td>메시지 큐 (RabbitMQ), 스트리밍 (Kafka) 기반 이벤트 전달</td><td>서비스 간 결합도 최소화, 확장성과 복원력 향상</td><td>주문 이벤트 → 결제/알림/분석 서비스 비동기 처리</td></tr><tr><td></td><td>Request-Response / Pub-Sub</td><td>직접 호출 vs 이벤트 기반 다대다 처리 방식 구성</td><td>통신 방식 유연화 및 서비스 복원력 강화</td><td>알림 시스템 구성 등</td></tr><tr><td><strong>데이터 관리 패턴</strong></td><td>Database per Service</td><td>각 서비스가 독립 DB 보유, Polyglot Persistence 가능</td><td>데이터 독립성, 스키마 격리, 장애 전파 방지</td><td>주문은 PostgreSQL, 알림은 MongoDB</td></tr><tr><td></td><td>CQRS</td><td>Command 모델 (쓰기) / Query 모델 (읽기) 분리 구성</td><td>읽기/쓰기 성능 최적화, 확장성 개선</td><td>등록/수정은 PostgreSQL, 조회는 Elasticsearch</td></tr><tr><td></td><td>Event Sourcing</td><td>모든 상태 변경을 이벤트로 저장하고 상태 재구성</td><td>감사 추적, 변경 이력 관리, CQRS 와 결합 용이</td><td>계좌 이력 이벤트 저장 → 복원</td></tr><tr><td></td><td>SAGA 패턴</td><td>분산 트랜잭션을 로컬 트랜잭션 연속으로 처리, 보상 트랜잭션 포함</td><td>글로벌 트랜잭션 없이 데이터 일관성 확보</td><td>항공편 예약 실패 시 호텔 예약 보상 취소</td></tr><tr><td><strong>배포 전략</strong></td><td>컨테이너화 + 오케스트레이션</td><td>Docker 패키징 + Kubernetes 자동 배포/스케일링 구성</td><td>배포 단순화, 자원 최적화, 확장성 보장</td><td>서비스별 Pod 관리</td></tr><tr><td></td><td>Blue-Green / Canary / Rolling</td><td>새 버전 점진 배포 + 자동 롤백 구성</td><td>무중단 배포, 리스크 감소</td><td>Canary: 5% 트래픽만 신규 버전 처리</td></tr><tr><td></td><td>Feature Toggle</td><td>기능별 플래그로 릴리스 여부 제어</td><td>기능 롤아웃 제어 및 실험적 배포 가능</td><td>베타 기능 유저 한정 활성화</td></tr><tr><td></td><td>Serverless</td><td>이벤트 기반 배포, 자동 확장, 함수 중심 실행</td><td>비용 최적화, 인프라 관리 최소화</td><td>AWS Lambda 기반 이메일 처리</td></tr><tr><td><strong>트랜잭션 관리</strong></td><td>Saga (Orchestration / Choreography)</td><td>중앙 조정자 기반 흐름 관리 / 이벤트 기반 자율 흐름 구성</td><td>분산 트랜잭션 일관성 보장, 복잡한 프로세스 제어</td><td>결제 실패 시 주문/재고 보상 취소</td></tr><tr><td></td><td>보상 트랜잭션</td><td>실패 발생 시 이전 단계 롤백 처리 정의</td><td>원자성 보장 없이도 일관성 유지 가능</td><td>재고 차감 후 결제 실패 → 재고 복원</td></tr><tr><td><strong>운영 자동화</strong></td><td>CI/CD 파이프라인</td><td>코드 커밋 → 테스트 → 배포 자동화 구성</td><td>배포 신뢰성 향상, 개발 생산성 개선</td><td>GitHub Actions, Jenkins 파이프라인</td></tr><tr><td></td><td>Feature Flag / A/B 테스트</td><td>조건 기반 기능 분기, 실험 적용</td><td>사용자 피드백 수집, 위험 최소화</td><td>로그인 화면 A/B 테스트</td></tr><tr><td></td><td>컨테이너 보안 및 DevSecOps</td><td>이미지 취약점 검사, 보안 스캐닝, 무결성 검증 등 적용</td><td>운영 신뢰도 강화, 배포 전 보안 점검 자동화</td><td>Trivy, Aqua 사용</td></tr><tr><td><strong>서비스 인프라</strong></td><td>서비스 메시 (Istio, Linkerd)</td><td>통신 트래픽 제어, mTLS 적용, 사이드카 구조</td><td>보안, 로깅, 리트라이, 트래픽 제어 등 자동화</td><td>Envoy 사이드카 + Istio 컨트롤</td></tr><tr><td></td><td>메시지 브로커 (Kafka, RabbitMQ)</td><td>이벤트 발행/구독 기반, 메시지 큐 기반 통신 구성</td><td>확장성 높은 비동기 통신 구조</td><td>주문 이벤트 발행 → 여러 컨슈머 처리</td></tr><tr><td></td><td>서비스 디스커버리</td><td>Consul, Eureka 등 동적 위치 검색</td><td>마이크로서비스 확장성 및 네트워크 유연성 확보</td><td>Pod 등록/제거 자동화</td></tr><tr><td><strong>시스템 회복력</strong></td><td>Circuit Breaker / Retry / Timeout</td><td>장애 시 요청 차단 / 재시도 / 대기시간 제한 구성</td><td>장애 확산 방지, 빠른 복구, 사용자 경험 유지</td><td>주문 서비스 장애 시 즉시 우회</td></tr><tr><td></td><td>Bulkhead / Fallback</td><td>격리된 자원 블록 구성 / 대체 플랜 제공</td><td>한 서비스 장애가 전체에 미치지 않도록 설계</td><td>인증 서비스 장애 시 임시 메시지 처리</td></tr><tr><td><strong>관찰 가능성 (Observability)</strong></td><td>로깅, 메트릭, 트레이싱</td><td>Prometheus, Grafana, Jaeger 등 통합</td><td>시스템 상태 가시화, 성능 병목 분석, 장애 추적</td><td>분산 추적 + 알림 시스템</td></tr><tr><td></td><td>OpenTelemetry</td><td>로그/메트릭/트레이스를 통합한 표준 수집 프레임워크</td><td>도구 간 일관된 수집 및 분석 구조 구성</td><td>FastAPI + OTEL Exporter</td></tr><tr><td><strong>마이그레이션 전략</strong></td><td>Strangler Fig 패턴</td><td>기존 모놀리스를 점진적으로 마이크로서비스로 대체</td><td>리스크 최소화, 단계별 현대화 전략 적용</td><td>일부 기능만 독립 서비스로 전환 후 점진 확장</td></tr></tbody></table><h4 id=도메인-주도-분해-dddbounded-context>도메인 주도 분해 (DDD–Bounded Context)<a hidden class=anchor aria-hidden=true href=#도메인-주도-분해-dddbounded-context>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># order_service.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pydantic</span> <span class=kn>import</span> <span class=n>BaseModel</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Order</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>order_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>user_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>amount</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.post</span><span class=p>(</span><span class=s2>&#34;/orders&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_order</span><span class=p>(</span><span class=n>order</span><span class=p>:</span> <span class=n>Order</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 주문 생성 로직</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;created&#34;</span><span class=p>,</span> <span class=s2>&#34;order&#34;</span><span class=p>:</span> <span class=n>order</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>설명:</strong> Order 와 Payment 등의 도메인 서비스로 분리. 각각 독립 실행 가능한 API 를 가짐.</p></blockquote><h4 id=트랜잭션-분해--saga-패턴-choreography-방식>트랜잭션 분해 ‧ SAGA 패턴 (Choreography 방식)<a hidden class=anchor aria-hidden=true href=#트랜잭션-분해--saga-패턴-choreography-방식>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># payment_service.py</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.post</span><span class=p>(</span><span class=s2>&#34;/process-payment&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>process_payment</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=nb>dict</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 결제 로직 수행</span>
</span></span><span class=line><span class=cl>    <span class=c1># 실패 시 order 취소 이벤트 전송</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;amount&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>1000</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=s2>&#34;http://order-service/cancel-order&#34;</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;order_id&#34;</span><span class=p>:</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;order_id&#34;</span><span class=p>]})</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;cancelled&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;paid&#34;</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>설명:</strong> 주문과 결제 서비스를 이벤트 기반으로 연결하여 트랜잭션 관리.</p></blockquote><h4 id=api-gateway>API Gateway<a hidden class=anchor aria-hidden=true href=#api-gateway>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// gateway.js (Express)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>request</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;request&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=s1>&#39;/gateway&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 인증, 로깅, 속도 제한 …
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>request</span><span class=p>(</span><span class=sb>`http://order-service</span><span class=si>${</span><span class=nx>req</span><span class=p>.</span><span class=nx>originalUrl</span><span class=si>}</span><span class=sb>`</span><span class=p>,</span> <span class=p>{</span> <span class=nx>json</span><span class=o>:</span> <span class=kc>true</span> <span class=p>},</span> <span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>r</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=nx>r</span><span class=p>.</span><span class=nx>statusCode</span><span class=p>).</span><span class=nx>send</span><span class=p>(</span><span class=nx>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=mi>3000</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>설명:</strong> 단일 진입점에서 여러 마이크로서비스로 라우팅.</p></blockquote><h4 id=bff-backend-for-frontend>BFF (Backend For Frontend)<a hidden class=anchor aria-hidden=true href=#bff-backend-for-frontend>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2>2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3>3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4>4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5>5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6>6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// bff-mobile.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/mobile/orders&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 모바일 요청에 특화된 간단한 데이터 반환
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>request</span><span class=p>(</span><span class=sb>`http://order-service/orders?user=</span><span class=si>${</span><span class=nx>req</span><span class=p>.</span><span class=nx>query</span><span class=p>.</span><span class=nx>user</span><span class=si>}</span><span class=sb>`</span><span class=p>,</span> <span class=p>(</span><span class=nx>e</span><span class=p>,</span> <span class=nx>r</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>({</span> <span class=nx>mobileOrders</span><span class=o>:</span> <span class=nx>b</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>설명:</strong> 모바일과 웹 별도 API 를 제공해 클라이언트 최적화.</p></blockquote><h4 id=cqrs>CQRS<a hidden class=anchor aria-hidden=true href=#cqrs>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2>2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3>3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4>4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5>5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6>6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># query_model.py (읽기 전용)</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>elasticsearch</span> <span class=kn>import</span> <span class=n>Elasticsearch</span>
</span></span><span class=line><span class=cl><span class=n>es</span> <span class=o>=</span> <span class=n>Elasticsearch</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>search_orders</span><span class=p>(</span><span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>resp</span> <span class=o>=</span> <span class=n>es</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>index</span><span class=o>=</span><span class=s2>&#34;orders&#34;</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;term&#34;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;user_id&#34;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>}})</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>resp</span><span class=p>[</span><span class=s1>&#39;hits&#39;</span><span class=p>][</span><span class=s1>&#39;hits&#39;</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>설명:</strong> 쓰기는 RDB, 읽기는 ElasticSearch 로 분리하여 성능 최적화.</p></blockquote><h4 id=event-sourcing>Event Sourcing<a hidden class=anchor aria-hidden=true href=#event-sourcing>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1> 1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2> 2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3> 3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4> 4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5> 5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6> 6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7> 7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8> 8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9> 9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10>10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># event_store.py</span>
</span></span><span class=line><span class=cl><span class=n>events</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>append_event</span><span class=p>(</span><span class=n>event</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>events</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_current_state</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>state</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>events</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>state</span><span class=p>[</span><span class=n>e</span><span class=p>[</span><span class=s1>&#39;entity_id&#39;</span><span class=p>]]</span> <span class=o>=</span> <span class=n>e</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>state</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>설명:</strong> 모든 변경을 이벤트로 저장하고, 재생으로 상태 복원.</p></blockquote><h4 id=container-orchestration-kubernetes>Container, Orchestration (Kubernetes)<a hidden class=anchor aria-hidden=true href=#container-orchestration-kubernetes>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11>11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12>12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13>13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14>14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># deployment.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>order-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w> </span>{<span class=w> </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w> </span>{<span class=w> </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>order-service } }</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w> </span>{<span class=w> </span><span class=nt>labels</span><span class=p>:</span><span class=w> </span>{<span class=w> </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>order-service } }</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>order</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>myregistry/order-service:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ports</span><span class=p>:</span><span class=w> </span><span class=p>[</span>{<span class=w> </span><span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w> </span>}<span class=p>]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>설명:</strong> Kubernetes 를 이용한 컨테이너 자동 스케일링 구성.</p></blockquote><h4 id=canary-배포>Canary 배포<a hidden class=anchor aria-hidden=true href=#canary-배포>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1>1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2>2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3>3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4>4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5>5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># canary-deployment.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>…</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w> </span><span class=c># Canary</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>strategy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>RollingUpdate</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>설명:</strong> 신규 버전을 일부 노드에만 배포해 안전하게 테스트.</p></blockquote><h4 id=feature-toggle>Feature Toggle<a hidden class=anchor aria-hidden=true href=#feature-toggle>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// featureToggle.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>features</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>newUI</span><span class=o>:</span> <span class=kc>false</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>getOrders</span><span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>features</span><span class=p>.</span><span class=nx>newUI</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=cm>/* 새로운 UI 형태 */</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=cm>/* 기본 UI */</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>설명:</strong> 기능 온/오프 플래그로 실험 배포 지원.</p></blockquote><h4 id=saga-패턴오케스트레이션>Saga 패턴–오케스트레이션<a hidden class=anchor aria-hidden=true href=#saga-패턴오케스트레이션>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1>1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2>2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3>3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4>4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5>5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># saga_coordinator.py</span>
</span></span><span class=line><span class=cl><span class=n>steps</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=s2>&#34;order&#34;</span><span class=p>,</span> <span class=s2>&#34;create&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=s2>&#34;payment&#34;</span><span class=p>,</span> <span class=s2>&#34;charge&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=s2>&#34;inventory&#34;</span><span class=p>,</span> <span class=s2>&#34;reserve&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>설명:</strong> 중앙 컨트롤러로 단계별 서비스 호출 및 실패 시 보상 처리 구현.</p></blockquote><h4 id=cicd>CI/CD<a hidden class=anchor aria-hidden=true href=#cicd>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1> 1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2> 2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3> 3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4> 4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5> 5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6> 6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7> 7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8> 8</a>
</span><span class=lnt id=hl-13-9><a class=lnlinks href=#hl-13-9> 9</a>
</span><span class=lnt id=hl-13-10><a class=lnlinks href=#hl-13-10>10</a>
</span><span class=lnt id=hl-13-11><a class=lnlinks href=#hl-13-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># .github/workflows/deploy.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w> </span><span class=l>push</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>build-and-deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>docker build . -t myapp:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>kubectl apply -f deployment.yaml</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=메시지-브로커-kafka>메시지 브로커 (Kafka)<a hidden class=anchor aria-hidden=true href=#메시지-브로커-kafka>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1>1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2>2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3>3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4>4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># producer.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaProducer</span>
</span></span><span class=line><span class=cl><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span><span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s1>&#39;orders&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;{&#34;order_id&#34;: &#34;123&#34;}&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>producer</span><span class=o>.</span><span class=n>flush</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>설명:</strong> 주문 이벤트를 Kafka 로 비동기 발행하여 확장성 확보.</p></blockquote><h4 id=circuit-breaker>Circuit Breaker<a hidden class=anchor aria-hidden=true href=#circuit-breaker>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1>1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2>2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3>3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// using opossum package
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>CircuitBreaker</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;opossum&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>callInventory</span><span class=p>()</span> <span class=p>{</span> <span class=cm>/* 원격 호출 */</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cb</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>CircuitBreaker</span><span class=p>(</span><span class=nx>callInventory</span><span class=p>,</span> <span class=p>{</span> <span class=nx>timeout</span><span class=o>:</span> <span class=mi>3000</span><span class=p>,</span> <span class=nx>errorThresholdPercentage</span><span class=o>:</span> <span class=mi>50</span> <span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>설명:</strong> 장애 시 요청 차단 및 회복 대기 전략 제공.</p></blockquote><h4 id=observability-로깅-모니터링-트레이싱>Observability (로깅, 모니터링, 트레이싱)<a hidden class=anchor aria-hidden=true href=#observability-로깅-모니터링-트레이싱>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1>1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2>2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3>3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4>4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5>5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6>6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># tracing.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry</span> <span class=kn>import</span> <span class=n>trace</span>
</span></span><span class=line><span class=cl><span class=n>tracer</span> <span class=o>=</span> <span class=n>trace</span><span class=o>.</span><span class=n>get_tracer</span><span class=p>(</span><span class=s2>&#34;order-service&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>tracer</span><span class=o>.</span><span class=n>start_as_current_span</span><span class=p>(</span><span class=s2>&#34;create_order&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 주문 처리 로직</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>설명:</strong> OpenTelemetry 로 분산 트레이싱 구현.</p></blockquote><h4 id=strangler-fig-패턴>Strangler Fig 패턴<a hidden class=anchor aria-hidden=true href=#strangler-fig-패턴>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[모놀리식] → [/orders 기능 신규 마이크로서비스로 교체] → 남은 기능 단계별 이전
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>설명:</strong> 모놀리스를 점진적으로 독립 서비스로 대체하는 전략.</p></blockquote><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>항목</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>1. 운영/배포 유연성</strong></td><td><strong>독립적 배포 및 롤백</strong></td><td>서비스 단위로 개별 배포 가능하므로 배포 주기가 단축되고, 장애 발생 시 해당 서비스만 롤백 가능</td></tr><tr><td></td><td><strong>배포 민첩성</strong></td><td>변경이 빠르게 반영되어 빠른 기능 출시 및 실험 가능</td></tr><tr><td></td><td><strong>무중단 배포 가능성</strong></td><td>Blue-Green, Canary 전략 등과 결합하여 시스템 중단 없이 배포 가능</td></tr><tr><td><strong>2. 확장성/성능</strong></td><td><strong>선택적 확장성</strong></td><td>트래픽이 집중되는 특정 서비스만 확장하여 비용 최적화 및 리소스 효율성 향상</td></tr><tr><td></td><td><strong>독립적 스케일링</strong></td><td>서비스마다 독립적으로 수평 또는 수직 확장 가능</td></tr><tr><td><strong>3. 안정성/격리성</strong></td><td><strong>장애 격리</strong></td><td>하나의 서비스 장애가 전체 시스템에 영향을 주지 않음 (Circuit Breaker 등과 결합 시 효과 극대화)</td></tr><tr><td></td><td><strong>데이터 격리</strong></td><td>서비스별 전용 데이터베이스를 통해 데이터 일관성과 보안 강화</td></tr><tr><td><strong>4. 조직 및 팀 구조</strong></td><td><strong>팀 자율성</strong></td><td>각 팀이 서비스의 전체 생명주기를 관리, 책임감 및 의사결정 속도 증가</td></tr><tr><td></td><td><strong>조직 분리</strong></td><td>서비스별로 전담팀 운영 가능 → 크로스 펑셔널 팀 구성 용이</td></tr><tr><td><strong>5. 개발 생산성</strong></td><td><strong>병렬 개발 가능성</strong></td><td>여러 팀이 동시에 독립적으로 기능 개발 가능 → 릴리즈 병목 제거</td></tr><tr><td></td><td><strong>작은 코드베이스 유지</strong></td><td>각 서비스가 작고 명확한 범위를 가지므로 코드 유지보수성이 향상됨</td></tr><tr><td></td><td><strong>빠른 개발 주기</strong></td><td>작고 독립된 단위로 개발되어 변화 대응력 향상</td></tr><tr><td><strong>6. 기술 유연성</strong></td><td><strong>기술 스택 다양성</strong></td><td>각 서비스마다 최적의 언어, 프레임워크, 데이터베이스를 선택 가능 (폴리글랏 아키텍처 실현)</td></tr><tr><td></td><td><strong>새로운 기술 도입 용이</strong></td><td>전체 시스템에 영향 없이 일부 서비스에서만 신규 기술 실험 가능</td></tr><tr><td><strong>7. 비즈니스 민첩성</strong></td><td><strong>비즈니스 변화 대응력</strong></td><td>시장 변화나 사용자 요구에 빠르게 적응 가능</td></tr><tr><td></td><td><strong>기능별 릴리스 최적화</strong></td><td>특정 기능만 빠르게 배포하거나 비활성화 가능 (Feature Toggle 등과 연계)</td></tr></tbody></table><h3 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>운영 복잡성 증가</td><td>서비스 수 증가에 따른 배포, 모니터링, 구성 관리 등의 운영 부담 증가</td><td>Kubernetes 기반 자동화, GitOps, 서비스 메시, APM 도구 도입</td></tr><tr><td>테스트 복잡성</td><td>서비스 간 의존성으로 인한 통합 테스트 환경 구성 및 유지 어려움</td><td>Contract Testing, 테스트 더블 (Mock, Stub), 테스트 자동화 구축</td></tr><tr><td>네트워크 지연 및 비용</td><td>서비스 간 통신 증가로 인한 응답 지연과 트래픽 비용 상승</td><td>gRPC, HTTP/2, 캐싱 전략, 로컬 호출, 로드밸런싱 적용</td></tr><tr><td>데이터 일관성 관리</td><td>분산 데이터베이스 환경에서의 트랜잭션 일관성 보장이 어려움</td><td>Saga 패턴, 이벤트 소싱, Eventually Consistent 모델 도입</td></tr><tr><td>보안 구성 복잡성</td><td>다수의 서비스에 대해 개별 인증/인가, 보안 설정 필요</td><td>서비스 메시 기반 mTLS, API Gateway 인증, 중앙 집중형 보안 정책 적용</td></tr><tr><td>분산 시스템 복잡성</td><td>장애 분석, 로깅, 트레이싱, 설정 관리 등 복잡도 급증</td><td>OpenTelemetry, Centralized Config Server, Observability Stack 도입</td></tr><tr><td>기술 및 운영 인프라 요구</td><td>CI/CD, DevOps, 모니터링 등 다양한 도구와 기술에 대한 준비 필요</td><td>DevOps 역량 강화, 플랫폼 엔지니어링, 교육 투자</td></tr><tr><td>버전 관리 및 호환성</td><td>독립적 배포 환경에서 서비스 간 API 버전 불일치 가능성</td><td>API 버전 관리 (SemVer), 하위 호환 보장, Blue-Green/Canary 배포 전략 적용</td></tr></tbody></table><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th>항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 방법 및 기법</th></tr></thead><tbody><tr><td>서비스 간 순환 의존성</td><td>잘못된 서비스 분해, 공유 모델 남용</td><td>장애 전파, 배포 순서 제약</td><td>의존성 그래프 분석, 정적 분석 도구 사용</td><td>DDD 기반 설계, API Contract 관리</td><td>서비스 경계 재설계, 이벤트 기반 통신 전환</td></tr><tr><td>분산 트랜잭션 실패</td><td>네트워크 지연/장애, 서비스 다운타임</td><td>데이터 불일치, 비즈니스 로직 오류 발생</td><td>분산 트레이싱, 트랜잭션 상태 모니터링</td><td>Saga, 보상 트랜잭션 설계</td><td>자동 재시도, 장애 복구 절차 수립</td></tr><tr><td>서비스 디스커버리 실패</td><td>서비스 레지스트리 장애, 네트워크 파티션</td><td>서비스 호출 불가, 시스템 전체 장애 가능성</td><td>헬스 체크, 서비스 등록 상태 감시</td><td>다중 레지스트리 구성, 캐싱, Client-Side Discovery</td><td>DNS 폴백, 클라이언트 사이드 로드밸런싱</td></tr><tr><td>설정 불일치/오류</td><td>환경별 설정 분산, 설정 동기화 실패</td><td>서비스 이상 동작, 보안 누수</td><td>설정 검증 스크립트, diff 비교 도구</td><td>중앙화된 설정 서버 (Spring Cloud Config 등)</td><td>설정 롤백, Canary 설정 배포</td></tr><tr><td>데이터 동기화 지연</td><td>이벤트 처리 지연, 큐 적체</td><td>사용자 경험 저하, 데이터 불일치</td><td>큐 대기 시간, 이벤트 처리 지연 로그 모니터링</td><td>이벤트 스키마 설계, 병렬 처리, 파티셔닝</td><td>메시지 큐 확장, 배치 처리, 비동기 재처리</td></tr><tr><td>버전 호환성 문제</td><td>API 변경 시 하위 호환 미비</td><td>호출 오류, 서비스 충돌</td><td>API 테스트, 소비자 기반 계약 테스트 (Pact 등)</td><td>API 버전 유지, Gradual Deployment</td><td>Semantic Versioning, Blue-Green 배포 적용</td></tr><tr><td>장애 전파 위험</td><td>동기 호출 기반 강한 결합 구조</td><td>전체 시스템으로 장애 확산</td><td>Circuit Breaker 모니터링, 호출 체인 분석</td><td>느슨한 결합, 비동기 통신, Fallback 설계</td><td>서킷 브레이커, Bulkhead, Retry, Timeout 패턴 적용</td></tr><tr><td>메시지 누락/중복 처리 문제</td><td>메시지 브로커 미설계, idempotency 미흡</td><td>이벤트 재처리 실패 또는 중복 이벤트 발생</td><td>DLQ 모니터링, 메시지 추적 시스템</td><td>메시지 유일 ID 부여, 보장 옵션 설정</td><td>중복 허용 처리, 메시지 상태 저장, 수신 확인 (ACK) 시스템 도입</td></tr><tr><td>테스트 환경 충돌</td><td>통합 테스트 시 외부 의존성 존재</td><td>테스트 실패율 증가, 신뢰성 저하</td><td>테스트 격리 분석, CI/CD 테스트 로그</td><td>서비스 Mocking, Contract Testing</td><td>테스트 피라미드 설계, 환경 분리</td></tr><tr><td>보안 위협</td><td>서비스 수 증가 → 공격 표면 확대</td><td>데이터 유출, 시스템 침입</td><td>보안 스캔, 취약점 관리 도구 사용</td><td>Zero Trust 모델, 공통 보안 정책 정의</td><td>서비스 메시 보안, 인증/인가 일관화 (OAuth2, JWT 등) 적용</td></tr></tbody></table><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>도전 과제</strong></th><th><strong>원인 / 영향</strong></th><th><strong>해결 방안 및 도구/패턴</strong></th></tr></thead><tbody><tr><td><strong>데이터 관리</strong></td><td>데이터 일관성 보장</td><td>분산 DB 로 인해 트랜잭션 일관성 보장 어려움 → 데이터 불일치, 비즈니스 오류</td><td>SAGA 패턴, 이벤트 소싱, CQRS, Eventually Consistency 전략 도입</td></tr><tr><td></td><td>데이터 거버넌스</td><td>데이터 소유권 분산, 품질 관리 부재 → 규제 위반, 분석 어려움</td><td>스키마 레지스트리, 데이터 카탈로그, 데이터 메시 아키텍처, 자동 품질 검증 시스템</td></tr><tr><td><strong>통신 및 인터페이스</strong></td><td>서비스 간 통신 복잡성</td><td>호출량 증가, 네트워크 지연 → 시스템 성능 저하, 장애 전파</td><td>gRPC, 비동기 메시징 (RabbitMQ/Kafka), 서킷 브레이커, Retry, Timeout, API Gateway 활용</td></tr><tr><td></td><td>버전 호환성 문제</td><td>독립 배포로 인한 API/스키마 충돌 → 서비스 간 통신 실패</td><td>API 버전 관리 (SemVer), Consumer Contract Testing(Pact), Blue-Green 배포, 하위 호환 유지</td></tr><tr><td><strong>관찰성 및 운영</strong></td><td>분산 시스템 모니터링</td><td>서비스 수 증가 및 호출 체인 복잡성 → 장애 탐지 어려움, MTTR 증가</td><td>OpenTelemetry, Prometheus, Grafana, Jaeger, 중앙 집중형 로깅 (ELK, Loki), 메트릭/헬스체크 통합</td></tr><tr><td></td><td>로깅 및 트레이싱 일관성 부족</td><td>상관관계 ID 누락, 로그 분산 → 문제 진단 지연</td><td>구조화된 로깅, 트레이스 ID 전파, 공통 로깅 프레임워크 적용</td></tr><tr><td></td><td>테스트 복잡성</td><td>서비스 간 의존성, 통합 테스트 환경 부족 → 테스트 누락/실패</td><td>Contract Testing, Service Virtualization, 통합 테스트 자동화, 테스트 데이터 관리</td></tr><tr><td><strong>배포 및 자동화</strong></td><td>배포 복잡성</td><td>수많은 서비스의 동시 배포와 충돌 가능성 → 버전 불일치, 장애 발생</td><td>CI/CD 파이프라인 구축, Canary/Blue-Green 배포, GitOps 기반 관리, Feature Toggle</td></tr><tr><td></td><td>설정 관리 어려움</td><td>환경별 설정 불일치, 동기화 실패 → 서비스 오작동, 보안 리스크</td><td>중앙 집중형 설정 서버 (Spring Cloud Config), 암호화 설정, 환경 비교 도구 활용</td></tr><tr><td></td><td>멀티 클러스터/클라우드 운영</td><td>여러 클라우드 및 클러스터 간 구성 차이 → 벤더 종속, 네트워크 장애</td><td>Kubernetes Federation, Istio Multi-cluster, External DNS, 클러스터 간 라우팅 제어</td></tr><tr><td><strong>보안 및 인증</strong></td><td>마이크로서비스 간 보안 강화</td><td>다수의 엔드포인트, 인증 일관성 부족 → 데이터 유출, 불법 접근 위험</td><td>Zero Trust 모델, 서비스 메시 기반 mTLS, OAuth2.0, JWT, API Gateway 보안 정책 적용</td></tr><tr><td></td><td>공격 표면 확대</td><td>마이크로서비스 증가로 인한 보안 대상 확대 → 침투 위험 증가</td><td>보안 스캐닝 자동화, 침입 탐지 시스템, 최소 권한 설정 (RBAC), 정기적인 보안 점검</td></tr><tr><td><strong>조직/문화/구조</strong></td><td>서비스 경계 정의의 어려움</td><td>모호한 도메인 분리로 인해 순환 의존성 발생 → 장애 전파, 개발 병목</td><td>DDD(도메인 주도 설계), 이벤트 스토밍, API Contract 기반 설계, 바운디드 컨텍스트 식별</td></tr><tr><td></td><td>Conway&rsquo;s Law 대응</td><td>조직 구조가 아키텍처에 영향을 줌 → 팀 간 협업 장애, 서비스 분리 실패</td><td>팀 토폴로지 적용, Cross-functional 팀 구성, 서비스별 책임 명확화</td></tr><tr><td></td><td>DevOps 문화 정착</td><td>개발 - 운영 사일로, 자동화 미흡 → 배포 지연, 운영 불안정</td><td>지속적 교육, 책임 공유, 배포 권한 위임, DevOps 툴 체계 도입 (CI/CD, Infra as Code)</td></tr><tr><td><strong>성능 최적화</strong></td><td>네트워크 병목 및 지연</td><td>호출 체인 과도, 원거리 통신 → 응답 속도 저하, 리소스 낭비</td><td>스마트 캐싱, 데이터 지역성 최적화, GraphQL Federation, HTTP/2, CDN 활용</td></tr><tr><td></td><td>메시지 중복/누락</td><td>메시지 브로커 미설계, 비보장 처리 → 데이터 불일치, 중복 처리</td><td>메시지 idempotency 설계, DLQ 구성, 메시지 상태 저장, 중복 허용 처리 패턴</td></tr></tbody></table><h3 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th><strong>분류 기준</strong></th><th><strong>유형</strong></th><th><strong>특징 및 설명</strong></th><th><strong>적용 사례</strong></th></tr></thead><tbody><tr><td><strong>1. 통신 방식</strong></td><td>동기식 마이크로서비스 (Synchronous)</td><td>REST API, gRPC 기반 실시간 통신 구조</td><td>인증, 결제, 실시간 조회 등</td></tr><tr><td></td><td>비동기식 마이크로서비스 (Asynchronous)</td><td>메시지 큐, 이벤트 기반 비동기 처리, 느슨한 결합 구조</td><td>주문 처리, 알림, 데이터 파이프라인</td></tr><tr><td></td><td>하이브리드 마이크로서비스 (Hybrid)</td><td>주요 로직은 동기, 부가 로직은 비동기 처리 혼합 사용</td><td>알림 + 결제 처리 복합 로직</td></tr><tr><td><strong>2. 배포 방식</strong></td><td>컨테이너 기반</td><td>Docker, Kubernetes 환경에서 컨테이너 단위로 배포</td><td>클라우드 네이티브 앱, MSA 전환</td></tr><tr><td></td><td>서버리스 기반</td><td>FaaS(Function-as-a-Service) 기반, 요청 발생 시에만 실행</td><td>이벤트 기반 로직, 단기성 작업</td></tr><tr><td></td><td>VM 기반</td><td>전통적인 가상머신 인프라 위에 직접 배포</td><td>레거시 시스템, 온프레미스 환경</td></tr><tr><td><strong>3. 데이터 관리 방식</strong></td><td>Database per Service</td><td>각 서비스가 독립적인 데이터베이스를 가지며 높은 응집도와 낮은 결합도를 제공</td><td>금융, 커머스, 분산 시스템 전반</td></tr><tr><td></td><td>Shared Database</td><td>여러 서비스가 하나의 데이터베이스를 공유, 빠른 개발 초기엔 유리하나 일관성/확장성에 제약</td><td>레거시 통합, 전환 단계 시스템</td></tr><tr><td></td><td>Event Sourcing</td><td>상태 변경을 이벤트 로그로 저장하여 이벤트 재생으로 현재 상태 구성</td><td>감사를 위한 추적, 변경 불변 시스템</td></tr><tr><td></td><td>다중 저장소 (Polyglot Persistence)</td><td>서비스 별로 서로 다른 DBMS 선택 (SQL, NoSQL 등)</td><td>콘텐츠 관리, AI/분석 플랫폼</td></tr><tr><td><strong>4. 서비스 경계 설계</strong></td><td>도메인 기반 (DDD)</td><td>비즈니스 도메인 중심으로 서비스 분할, Bounded Context 명확화</td><td>대규모 기업 시스템, 도메인 복잡도 높을 때</td></tr><tr><td></td><td>기능 기반 (Function-based)</td><td>기능 단위 (ex: 사용자, 주문, 결제) 로 서비스 분리</td><td>스타트업, 단일 제품 중심 서비스</td></tr><tr><td><strong>5. 서비스 크기</strong></td><td>나노서비스 (Nano Service)</td><td>매우 작은 단위로 나누어진 기능 단위 서비스, 하나의 함수 수준</td><td>서버리스 함수, 간단한 유틸 서비스</td></tr><tr><td></td><td>마이크로서비스 (Microservice)</td><td>명확한 비즈니스 책임을 가지는 단위 서비스로 가장 일반적인 형태</td><td>대다수 MSA 시스템</td></tr><tr><td></td><td>미니서비스 (Mini Service)</td><td>여러 관련 기능을 하나의 서비스로 유지, 마이크로서비스와 모놀리스의 중간 크기</td><td>레거시 모놀리스 점진적 분리 구조</td></tr><tr><td><strong>6. 트랜잭션 제어 방식</strong></td><td>Orchestration Saga</td><td>중앙 서비스 (Orchestrator) 가 각 로컬 트랜잭션을 순차 실행 및 제어</td><td>워크플로우 기반 처리</td></tr><tr><td></td><td>Choreography Saga</td><td>각 서비스가 이벤트 수신 후 자체 로직을 처리하고 후속 이벤트 발행</td><td>이벤트 기반 처리 구조</td></tr><tr><td><strong>7. 프론트엔드 통합 방식</strong></td><td>마이크로프론트엔드 (Micro Frontend)</td><td>프론트엔드를 서비스 단위로 분리하여 독립 배포 가능</td><td>대규모 웹앱, SPA 구조</td></tr><tr><td></td><td>모놀리식 프론트엔드</td><td>모든 프론트엔드 기능을 하나의 코드베이스로 구성</td><td>전통적인 웹 애플리케이션</td></tr><tr><td><strong>8. 배포 환경</strong></td><td>온프레미스 (On-premises)</td><td>자체 인프라에 배포, 클러스터 및 네트워크 구성 필요</td><td>정부, 금융, 민감 정보 시스템</td></tr><tr><td></td><td>클라우드 기반 (Cloud-native)</td><td>클라우드 서비스 및 오케스트레이션 환경에 최적화된 배포</td><td>AWS, Azure, GCP 기반 서비스</td></tr><tr><td></td><td>Service Cell 구조</td><td>여러 마이크로서비스를 기능 단위로 그룹핑하여 배포</td><td>고가용성, 서비스 독립성 강화 구조</td></tr></tbody></table><h3 id=실무-적용-예시>실무 적용 예시<a hidden class=anchor aria-hidden=true href=#실무-적용-예시>#</a></h3><table><thead><tr><th><strong>적용 분야</strong></th><th><strong>대표 시스템/서비스</strong></th><th><strong>사용 기술 및 패턴</strong></th><th><strong>주요 목적</strong></th><th><strong>핵심 효과</strong></th></tr></thead><tbody><tr><td><strong>전자상거래</strong></td><td>쇼핑몰, 온라인 마켓</td><td>API Gateway, Redis, Elasticsearch, Kubernetes</td><td>기능별 독립 배포, 트래픽 급증 대응</td><td>99.9% 가용성 확보, 응답시간 50% 단축</td></tr><tr><td><strong>OTT/미디어</strong></td><td>Netflix, YouTube, 스트리밍 플랫폼</td><td>Service Mesh, CDN, Kafka, 추천 시스템</td><td>글로벌 확장, 트래픽 분산, 개인화 서비스</td><td>동시 사용자 1 억 명 지원, 빠른 배포 주기</td></tr><tr><td><strong>핀테크/금융</strong></td><td>디지털 뱅킹, 결제 게이트웨이</td><td>Circuit Breaker, OAuth, API Gateway, HSM, 분산 트랜잭션</td><td>보안 강화, 규제 준수, 장애 격리</td><td>트랜잭션 성공률 99.99%, 민감 기능 분리로 안정성 강화</td></tr><tr><td><strong>모빌리티/물류</strong></td><td>배송/운송 플랫폼, 라이드셰어링</td><td>이벤트 기반 처리, 지리 공간 API, 실시간 추적 시스템</td><td>실시간 처리, 고객 응대 자동화</td><td>배송 시간 30% 단축, 장애 격리로 안정적 운영</td></tr><tr><td><strong>IoT/센서 플랫폼</strong></td><td>스마트홈, 제조 센서 시스템</td><td>MQTT, Kafka, Time Series DB, Edge Gateway</td><td>대규모 실시간 데이터 수집/처리</td><td>초당 100 만 이벤트 처리, 디바이스별 최적 통신 지원</td></tr><tr><td><strong>교육 플랫폼</strong></td><td>온라인 강의 서비스</td><td>Micro Frontend, 알림 서비스, 결제 API</td><td>기능 독립 운영, 빠른 피처 릴리즈</td><td>도메인 간 충돌 방지, 학습 피드백 실시간 처리</td></tr><tr><td><strong>소셜 미디어</strong></td><td>SNS, 커뮤니티 서비스</td><td>GraphQL, 실시간 메시징, 캐시 시스템</td><td>A/B 테스트, 피드 개인화, 실시간 상호작용</td><td>사용자 참여도 40% 증가, 기능 실험/확장 용이</td></tr><tr><td><strong>공공기관/헬스케어</strong></td><td>민원/응급/보건 시스템</td><td>AI 마이크로서비스, 자동화 처리, 보안 감사 로깅</td><td>자동화 및 분산 분석, 민감 데이터 분리</td><td>분석 응답시간 단축, 데이터 보안 및 프라이버시 확보</td></tr><tr><td><strong>SaaS/기술 기업</strong></td><td>B2B 서비스 플랫폼</td><td>폴리글랏 아키텍처, CI/CD, 다중 DB 전략</td><td>기술 다양성 수용, 빠른 릴리즈 사이클</td><td>최적 기술 스택 채택 가능, 서비스 진화 유연성 확보</td></tr></tbody></table><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><h4 id=사례-1-netflix-스트리밍-플랫폼>사례 1: Netflix 스트리밍 플랫폼<a hidden class=anchor aria-hidden=true href=#사례-1-netflix-스트리밍-플랫폼>#</a></h4><p>Netflix 는 전 세계 2 억 명 이상의 사용자에게 스트리밍 서비스를 제공하는 대표적인 마이크로서비스 아키텍처 사례.</p><p><strong>시스템 구성도</strong>:</p><pre class=mermaid>graph TB
    subgraph &#34;Client Layer&#34;
        WebClient[웹 브라우저]
        MobileApp[모바일 앱]
        TVApp[스마트 TV 앱]
        GameConsole[게임 콘솔]
    end
    
    subgraph &#34;CDN Layer&#34;
        CloudFront[Amazon CloudFront]
        OpenConnect[Netflix Open Connect]
    end
    
    subgraph &#34;API Gateway Layer&#34;
        Zuul[Zuul Gateway&lt;br/&gt;- 동적 라우팅&lt;br/&gt;- 모니터링&lt;br/&gt;- 보안&lt;br/&gt;- 복원력]
    end
    
    subgraph &#34;Microservices Layer&#34;
        subgraph &#34;User Services&#34;
            UserProfile[User Profile Service]
            Authentication[Authentication Service]
            Preferences[Preferences Service]
        end
        
        subgraph &#34;Content Services&#34;
            Catalog[Catalog Service]
            Metadata[Metadata Service]
            Recommendations[Recommendation Service]
            Search[Search Service]
        end
        
        subgraph &#34;Playback Services&#34;
            PlayAPI[Play API Service]
            VideoStreaming[Video Streaming Service]
            Bookmarks[Bookmarks Service]
            ViewingHistory[Viewing History Service]
        end
        
        subgraph &#34;Platform Services&#34;
            DeviceRegistration[Device Registration]
            TitleSelection[Title Selection]
            ABTesting[A/B Testing Service]
            Analytics[Analytics Service]
        end
    end
    
    subgraph &#34;Data Layer&#34;
        Cassandra[(Cassandra&lt;br/&gt;분산 NoSQL)]
        MySQL[(MySQL&lt;br/&gt;관계형 DB)]
        ElasticSearch[(ElasticSearch&lt;br/&gt;검색 엔진)]
        S3[(Amazon S3&lt;br/&gt;콘텐츠 저장)]
    end
    
    subgraph &#34;Message Infrastructure&#34;
        Kafka[Apache Kafka&lt;br/&gt;실시간 이벤트 스트림]
        SQS[Amazon SQS&lt;br/&gt;메시지 큐]
    end
    
    subgraph &#34;Monitoring &amp; Infrastructure&#34;
        Hystrix[Hystrix&lt;br/&gt;Circuit Breaker]
        Eureka[Eureka&lt;br/&gt;Service Discovery]
        Ribbon[Ribbon&lt;br/&gt;Client-side Load Balancer]
        Atlas[Atlas&lt;br/&gt;Metrics Collection]
    end
    
    WebClient --&gt; CloudFront
    MobileApp --&gt; CloudFront
    TVApp --&gt; OpenConnect
    GameConsole --&gt; OpenConnect
    
    CloudFront --&gt; Zuul
    OpenConnect --&gt; Zuul
    
    Zuul --&gt; UserProfile
    Zuul --&gt; Catalog
    Zuul --&gt; PlayAPI
    Zuul --&gt; DeviceRegistration
    
    UserProfile --&gt; MySQL
    Catalog --&gt; Cassandra
    Recommendations --&gt; ElasticSearch
    PlayAPI --&gt; S3
    
    UserProfile --&gt; Kafka
    PlayAPI --&gt; Kafka
    Recommendations --&gt; Kafka
    
    UserProfile --&gt; Hystrix
    Catalog --&gt; Eureka
    PlayAPI --&gt; Ribbon
    Analytics --&gt; Atlas
</pre><p><strong>활용 사례 Workflow</strong></p><p><strong>사용자 비디오 재생 요청 처리 과정</strong>:</p><pre class=mermaid>sequenceDiagram
    participant User as 사용자
    participant CDN as CDN
    participant Zuul as Zuul Gateway
    participant Auth as Auth Service
    participant Profile as Profile Service
    participant Catalog as Catalog Service
    participant PlayAPI as Play API
    participant Recommend as Recommendation Service
    participant Analytics as Analytics Service
    participant Kafka as Kafka
    
    User-&gt;&gt;CDN: 비디오 재생 요청
    CDN-&gt;&gt;Zuul: 요청 전달
    Zuul-&gt;&gt;Auth: 사용자 인증 확인
    Auth-&gt;&gt;Zuul: 인증 성공
    
    par 병렬 처리
        Zuul-&gt;&gt;Profile: 사용자 프로필 조회
        Profile-&gt;&gt;Zuul: 프로필 정보 반환
    and
        Zuul-&gt;&gt;Catalog: 콘텐츠 메타데이터 조회
        Catalog-&gt;&gt;Zuul: 메타데이터 반환
    end
    
    Zuul-&gt;&gt;PlayAPI: 재생 URL 요청
    PlayAPI-&gt;&gt;Zuul: 스트리밍 URL 반환
    Zuul-&gt;&gt;User: 재생 정보 응답
    
    PlayAPI-&gt;&gt;Kafka: 재생 이벤트 발행
    Kafka-&gt;&gt;Analytics: 시청 데이터 분석
    Kafka-&gt;&gt;Recommend: 추천 알고리즘 업데이트
    
    Note over User,Kafka: 실시간 개인화 추천 업데이트
</pre><p><strong>마이크로서비스 아키텍처의 역할</strong>:</p><ol><li><strong>확장성</strong>: 피크 시간대 특정 서비스 (재생, 추천) 만 선별적 확장</li><li><strong>개인화</strong>: 사용자별 독립적인 추천 서비스 제공</li><li><strong>글로벌 서비스</strong>: 지역별 CDN 과 연동된 분산 아키텍처</li><li><strong>실험 플랫폼</strong>: A/B 테스트를 위한 독립적 서비스 배포</li><li><strong>장애 격리</strong>: Hystrix Circuit Breaker 로 연쇄 장애 방지</li></ol><p><strong>마이크로서비스 유무에 따른 차이점</strong>:</p><ul><li><strong>마이크로서비스 아키텍처 적용 전 (모놀리식)</strong>:<ul><li>전체 시스템 재배포 필요로 인한 주 1 회 배포</li><li>특정 기능 장애 시 전체 서비스 중단</li><li>단일 기술 스택 제한 (Java)</li><li>수직적 확장만 가능</li></ul></li><li><strong>마이크로서비스 아키텍처 적용 후</strong>:<ul><li>일일 수천 번의 독립적 서비스 배포</li><li>99.99% 가용성 달성 (개별 서비스 장애 격리)</li><li>다양한 기술 스택 활용 (Java, Python, Node.js)</li><li>서비스별 수평적 확장으로 비용 최적화</li></ul></li></ul><h4 id=사례-2-이커머스-플랫폼>사례 2: 이커머스 플랫폼<a hidden class=anchor aria-hidden=true href=#사례-2-이커머스-플랫폼>#</a></h4><p>시스템 구성: 주문 (Order), 결제 (Payment), 재고 (Inventory) 서비스</p><p>Workflow: 사용자가 주문 → 주문 서비스 → 결제 서비스 → 재고 서비스 → 각각 독립적으로 동작, 메시지 큐로 상태 전달</p><p>역할: 장애 격리, 확장성, 빠른 배포</p><p>미적용 시: 전체 시스템 장애, 배포 지연, 확장성 한계</p><pre class=mermaid>sequenceDiagram
    participant User
    participant APIGW
    participant Order
    participant Payment
    participant Inventory

    User-&gt;&gt;APIGW: 주문 요청
    APIGW-&gt;&gt;Order: 주문 생성
    Order-&gt;&gt;Payment: 결제 요청(비동기)
    Payment-&gt;&gt;Inventory: 재고 차감(비동기)
    Inventory--&gt;&gt;Order: 재고 상태 전달
    Order--&gt;&gt;APIGW: 주문 결과
    APIGW--&gt;&gt;User: 주문 응답
</pre><h4 id=사례-3-전자상거래-플랫폼>사례 3: 전자상거래 플랫폼<a hidden class=anchor aria-hidden=true href=#사례-3-전자상거래-플랫폼>#</a></h4><p><strong>시스템 구성</strong></p><pre class=mermaid>flowchart LR
  User --&gt; API_Gateway
  API_Gateway --&gt; OrderSvc
  API_Gateway --&gt; InventorySvc
  API_Gateway --&gt; PaymentSvc
  OrderSvc --&gt; InventorySvc
  OrderSvc --&gt; PaymentSvc
  OrderSvc --&gt; MQ[Kafka]
  InventorySvc --&gt; DB_I[(Inventory DB)]
  PaymentSvc --&gt; DB_P[(Payment DB)]
  OrderSvc --&gt; DB_O[(Order DB)]
</pre><ul><li><strong>OrderSvc</strong>: 주문 생성, PaymentSvc 호출 → Inventory 요청 → 주문 승인 → Kafka 이벤트 발행</li><li><strong>InventorySvc</strong>: 재고 분석 및 <code>deductEvent</code> 소비하여 재고 조정</li><li><strong>PaymentSvc</strong>: 결제 처리</li><li><strong>DB 분리</strong>: 각 서비스 독립 DB 로 일관성 및 보안 확보</li></ul><p><strong>워크플로우</strong>: Saga (Choreography 방식)</p><ol><li>OrderSvc 에서 주문 수집</li><li>PaymentSvc 로 결제 요청</li><li>InventorySvc 에서 재고 갱신</li><li>이벤트 발행 (<code>order.created</code>, <code>inventory.updated</code>)</li><li>실패 시 보상: <code>payment.refund</code>, <code>inventory.rollback</code> 이벤트 발생</li></ol><p><strong>Microservices 도입 전/후</strong>:</p><table><thead><tr><th>단계</th><th>Monolith 상태</th><th>Microservices 적용 후</th></tr></thead><tbody><tr><td>개발</td><td>전체 코드베이스 컴파일/릴리즈 필요</td><td>개별 서비스 독립 개발 및 배포 가능</td></tr><tr><td>성능 대응</td><td>전체 인스턴스 확장 필요</td><td>주문 집중시 OrderSvc 만 수평 확장 가능</td></tr><tr><td>장애 시</td><td>한 서비스 장애 시 전체 시스템 영향</td><td>한 서비스 장애 시 도메인별 제한된 영향</td></tr><tr><td>기술 스택</td><td>통일된 언어/DB 사용</td><td>서비스별 적합 스택 선택 가능 (예: Go, MongoDB 등)</td></tr></tbody></table><h3 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h3><h4 id=javascriptnodejs>JavaScript/Node.js<a hidden class=anchor aria-hidden=true href=#javascriptnodejs>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1>  1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2>  2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3>  3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4>  4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5>  5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6>  6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7>  7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8>  8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9>  9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10> 10</a>
</span><span class=lnt id=hl-22-11><a class=lnlinks href=#hl-22-11> 11</a>
</span><span class=lnt id=hl-22-12><a class=lnlinks href=#hl-22-12> 12</a>
</span><span class=lnt id=hl-22-13><a class=lnlinks href=#hl-22-13> 13</a>
</span><span class=lnt id=hl-22-14><a class=lnlinks href=#hl-22-14> 14</a>
</span><span class=lnt id=hl-22-15><a class=lnlinks href=#hl-22-15> 15</a>
</span><span class=lnt id=hl-22-16><a class=lnlinks href=#hl-22-16> 16</a>
</span><span class=lnt id=hl-22-17><a class=lnlinks href=#hl-22-17> 17</a>
</span><span class=lnt id=hl-22-18><a class=lnlinks href=#hl-22-18> 18</a>
</span><span class=lnt id=hl-22-19><a class=lnlinks href=#hl-22-19> 19</a>
</span><span class=lnt id=hl-22-20><a class=lnlinks href=#hl-22-20> 20</a>
</span><span class=lnt id=hl-22-21><a class=lnlinks href=#hl-22-21> 21</a>
</span><span class=lnt id=hl-22-22><a class=lnlinks href=#hl-22-22> 22</a>
</span><span class=lnt id=hl-22-23><a class=lnlinks href=#hl-22-23> 23</a>
</span><span class=lnt id=hl-22-24><a class=lnlinks href=#hl-22-24> 24</a>
</span><span class=lnt id=hl-22-25><a class=lnlinks href=#hl-22-25> 25</a>
</span><span class=lnt id=hl-22-26><a class=lnlinks href=#hl-22-26> 26</a>
</span><span class=lnt id=hl-22-27><a class=lnlinks href=#hl-22-27> 27</a>
</span><span class=lnt id=hl-22-28><a class=lnlinks href=#hl-22-28> 28</a>
</span><span class=lnt id=hl-22-29><a class=lnlinks href=#hl-22-29> 29</a>
</span><span class=lnt id=hl-22-30><a class=lnlinks href=#hl-22-30> 30</a>
</span><span class=lnt id=hl-22-31><a class=lnlinks href=#hl-22-31> 31</a>
</span><span class=lnt id=hl-22-32><a class=lnlinks href=#hl-22-32> 32</a>
</span><span class=lnt id=hl-22-33><a class=lnlinks href=#hl-22-33> 33</a>
</span><span class=lnt id=hl-22-34><a class=lnlinks href=#hl-22-34> 34</a>
</span><span class=lnt id=hl-22-35><a class=lnlinks href=#hl-22-35> 35</a>
</span><span class=lnt id=hl-22-36><a class=lnlinks href=#hl-22-36> 36</a>
</span><span class=lnt id=hl-22-37><a class=lnlinks href=#hl-22-37> 37</a>
</span><span class=lnt id=hl-22-38><a class=lnlinks href=#hl-22-38> 38</a>
</span><span class=lnt id=hl-22-39><a class=lnlinks href=#hl-22-39> 39</a>
</span><span class=lnt id=hl-22-40><a class=lnlinks href=#hl-22-40> 40</a>
</span><span class=lnt id=hl-22-41><a class=lnlinks href=#hl-22-41> 41</a>
</span><span class=lnt id=hl-22-42><a class=lnlinks href=#hl-22-42> 42</a>
</span><span class=lnt id=hl-22-43><a class=lnlinks href=#hl-22-43> 43</a>
</span><span class=lnt id=hl-22-44><a class=lnlinks href=#hl-22-44> 44</a>
</span><span class=lnt id=hl-22-45><a class=lnlinks href=#hl-22-45> 45</a>
</span><span class=lnt id=hl-22-46><a class=lnlinks href=#hl-22-46> 46</a>
</span><span class=lnt id=hl-22-47><a class=lnlinks href=#hl-22-47> 47</a>
</span><span class=lnt id=hl-22-48><a class=lnlinks href=#hl-22-48> 48</a>
</span><span class=lnt id=hl-22-49><a class=lnlinks href=#hl-22-49> 49</a>
</span><span class=lnt id=hl-22-50><a class=lnlinks href=#hl-22-50> 50</a>
</span><span class=lnt id=hl-22-51><a class=lnlinks href=#hl-22-51> 51</a>
</span><span class=lnt id=hl-22-52><a class=lnlinks href=#hl-22-52> 52</a>
</span><span class=lnt id=hl-22-53><a class=lnlinks href=#hl-22-53> 53</a>
</span><span class=lnt id=hl-22-54><a class=lnlinks href=#hl-22-54> 54</a>
</span><span class=lnt id=hl-22-55><a class=lnlinks href=#hl-22-55> 55</a>
</span><span class=lnt id=hl-22-56><a class=lnlinks href=#hl-22-56> 56</a>
</span><span class=lnt id=hl-22-57><a class=lnlinks href=#hl-22-57> 57</a>
</span><span class=lnt id=hl-22-58><a class=lnlinks href=#hl-22-58> 58</a>
</span><span class=lnt id=hl-22-59><a class=lnlinks href=#hl-22-59> 59</a>
</span><span class=lnt id=hl-22-60><a class=lnlinks href=#hl-22-60> 60</a>
</span><span class=lnt id=hl-22-61><a class=lnlinks href=#hl-22-61> 61</a>
</span><span class=lnt id=hl-22-62><a class=lnlinks href=#hl-22-62> 62</a>
</span><span class=lnt id=hl-22-63><a class=lnlinks href=#hl-22-63> 63</a>
</span><span class=lnt id=hl-22-64><a class=lnlinks href=#hl-22-64> 64</a>
</span><span class=lnt id=hl-22-65><a class=lnlinks href=#hl-22-65> 65</a>
</span><span class=lnt id=hl-22-66><a class=lnlinks href=#hl-22-66> 66</a>
</span><span class=lnt id=hl-22-67><a class=lnlinks href=#hl-22-67> 67</a>
</span><span class=lnt id=hl-22-68><a class=lnlinks href=#hl-22-68> 68</a>
</span><span class=lnt id=hl-22-69><a class=lnlinks href=#hl-22-69> 69</a>
</span><span class=lnt id=hl-22-70><a class=lnlinks href=#hl-22-70> 70</a>
</span><span class=lnt id=hl-22-71><a class=lnlinks href=#hl-22-71> 71</a>
</span><span class=lnt id=hl-22-72><a class=lnlinks href=#hl-22-72> 72</a>
</span><span class=lnt id=hl-22-73><a class=lnlinks href=#hl-22-73> 73</a>
</span><span class=lnt id=hl-22-74><a class=lnlinks href=#hl-22-74> 74</a>
</span><span class=lnt id=hl-22-75><a class=lnlinks href=#hl-22-75> 75</a>
</span><span class=lnt id=hl-22-76><a class=lnlinks href=#hl-22-76> 76</a>
</span><span class=lnt id=hl-22-77><a class=lnlinks href=#hl-22-77> 77</a>
</span><span class=lnt id=hl-22-78><a class=lnlinks href=#hl-22-78> 78</a>
</span><span class=lnt id=hl-22-79><a class=lnlinks href=#hl-22-79> 79</a>
</span><span class=lnt id=hl-22-80><a class=lnlinks href=#hl-22-80> 80</a>
</span><span class=lnt id=hl-22-81><a class=lnlinks href=#hl-22-81> 81</a>
</span><span class=lnt id=hl-22-82><a class=lnlinks href=#hl-22-82> 82</a>
</span><span class=lnt id=hl-22-83><a class=lnlinks href=#hl-22-83> 83</a>
</span><span class=lnt id=hl-22-84><a class=lnlinks href=#hl-22-84> 84</a>
</span><span class=lnt id=hl-22-85><a class=lnlinks href=#hl-22-85> 85</a>
</span><span class=lnt id=hl-22-86><a class=lnlinks href=#hl-22-86> 86</a>
</span><span class=lnt id=hl-22-87><a class=lnlinks href=#hl-22-87> 87</a>
</span><span class=lnt id=hl-22-88><a class=lnlinks href=#hl-22-88> 88</a>
</span><span class=lnt id=hl-22-89><a class=lnlinks href=#hl-22-89> 89</a>
</span><span class=lnt id=hl-22-90><a class=lnlinks href=#hl-22-90> 90</a>
</span><span class=lnt id=hl-22-91><a class=lnlinks href=#hl-22-91> 91</a>
</span><span class=lnt id=hl-22-92><a class=lnlinks href=#hl-22-92> 92</a>
</span><span class=lnt id=hl-22-93><a class=lnlinks href=#hl-22-93> 93</a>
</span><span class=lnt id=hl-22-94><a class=lnlinks href=#hl-22-94> 94</a>
</span><span class=lnt id=hl-22-95><a class=lnlinks href=#hl-22-95> 95</a>
</span><span class=lnt id=hl-22-96><a class=lnlinks href=#hl-22-96> 96</a>
</span><span class=lnt id=hl-22-97><a class=lnlinks href=#hl-22-97> 97</a>
</span><span class=lnt id=hl-22-98><a class=lnlinks href=#hl-22-98> 98</a>
</span><span class=lnt id=hl-22-99><a class=lnlinks href=#hl-22-99> 99</a>
</span><span class=lnt id=hl-22-100><a class=lnlinks href=#hl-22-100>100</a>
</span><span class=lnt id=hl-22-101><a class=lnlinks href=#hl-22-101>101</a>
</span><span class=lnt id=hl-22-102><a class=lnlinks href=#hl-22-102>102</a>
</span><span class=lnt id=hl-22-103><a class=lnlinks href=#hl-22-103>103</a>
</span><span class=lnt id=hl-22-104><a class=lnlinks href=#hl-22-104>104</a>
</span><span class=lnt id=hl-22-105><a class=lnlinks href=#hl-22-105>105</a>
</span><span class=lnt id=hl-22-106><a class=lnlinks href=#hl-22-106>106</a>
</span><span class=lnt id=hl-22-107><a class=lnlinks href=#hl-22-107>107</a>
</span><span class=lnt id=hl-22-108><a class=lnlinks href=#hl-22-108>108</a>
</span><span class=lnt id=hl-22-109><a class=lnlinks href=#hl-22-109>109</a>
</span><span class=lnt id=hl-22-110><a class=lnlinks href=#hl-22-110>110</a>
</span><span class=lnt id=hl-22-111><a class=lnlinks href=#hl-22-111>111</a>
</span><span class=lnt id=hl-22-112><a class=lnlinks href=#hl-22-112>112</a>
</span><span class=lnt id=hl-22-113><a class=lnlinks href=#hl-22-113>113</a>
</span><span class=lnt id=hl-22-114><a class=lnlinks href=#hl-22-114>114</a>
</span><span class=lnt id=hl-22-115><a class=lnlinks href=#hl-22-115>115</a>
</span><span class=lnt id=hl-22-116><a class=lnlinks href=#hl-22-116>116</a>
</span><span class=lnt id=hl-22-117><a class=lnlinks href=#hl-22-117>117</a>
</span><span class=lnt id=hl-22-118><a class=lnlinks href=#hl-22-118>118</a>
</span><span class=lnt id=hl-22-119><a class=lnlinks href=#hl-22-119>119</a>
</span><span class=lnt id=hl-22-120><a class=lnlinks href=#hl-22-120>120</a>
</span><span class=lnt id=hl-22-121><a class=lnlinks href=#hl-22-121>121</a>
</span><span class=lnt id=hl-22-122><a class=lnlinks href=#hl-22-122>122</a>
</span><span class=lnt id=hl-22-123><a class=lnlinks href=#hl-22-123>123</a>
</span><span class=lnt id=hl-22-124><a class=lnlinks href=#hl-22-124>124</a>
</span><span class=lnt id=hl-22-125><a class=lnlinks href=#hl-22-125>125</a>
</span><span class=lnt id=hl-22-126><a class=lnlinks href=#hl-22-126>126</a>
</span><span class=lnt id=hl-22-127><a class=lnlinks href=#hl-22-127>127</a>
</span><span class=lnt id=hl-22-128><a class=lnlinks href=#hl-22-128>128</a>
</span><span class=lnt id=hl-22-129><a class=lnlinks href=#hl-22-129>129</a>
</span><span class=lnt id=hl-22-130><a class=lnlinks href=#hl-22-130>130</a>
</span><span class=lnt id=hl-22-131><a class=lnlinks href=#hl-22-131>131</a>
</span><span class=lnt id=hl-22-132><a class=lnlinks href=#hl-22-132>132</a>
</span><span class=lnt id=hl-22-133><a class=lnlinks href=#hl-22-133>133</a>
</span><span class=lnt id=hl-22-134><a class=lnlinks href=#hl-22-134>134</a>
</span><span class=lnt id=hl-22-135><a class=lnlinks href=#hl-22-135>135</a>
</span><span class=lnt id=hl-22-136><a class=lnlinks href=#hl-22-136>136</a>
</span><span class=lnt id=hl-22-137><a class=lnlinks href=#hl-22-137>137</a>
</span><span class=lnt id=hl-22-138><a class=lnlinks href=#hl-22-138>138</a>
</span><span class=lnt id=hl-22-139><a class=lnlinks href=#hl-22-139>139</a>
</span><span class=lnt id=hl-22-140><a class=lnlinks href=#hl-22-140>140</a>
</span><span class=lnt id=hl-22-141><a class=lnlinks href=#hl-22-141>141</a>
</span><span class=lnt id=hl-22-142><a class=lnlinks href=#hl-22-142>142</a>
</span><span class=lnt id=hl-22-143><a class=lnlinks href=#hl-22-143>143</a>
</span><span class=lnt id=hl-22-144><a class=lnlinks href=#hl-22-144>144</a>
</span><span class=lnt id=hl-22-145><a class=lnlinks href=#hl-22-145>145</a>
</span><span class=lnt id=hl-22-146><a class=lnlinks href=#hl-22-146>146</a>
</span><span class=lnt id=hl-22-147><a class=lnlinks href=#hl-22-147>147</a>
</span><span class=lnt id=hl-22-148><a class=lnlinks href=#hl-22-148>148</a>
</span><span class=lnt id=hl-22-149><a class=lnlinks href=#hl-22-149>149</a>
</span><span class=lnt id=hl-22-150><a class=lnlinks href=#hl-22-150>150</a>
</span><span class=lnt id=hl-22-151><a class=lnlinks href=#hl-22-151>151</a>
</span><span class=lnt id=hl-22-152><a class=lnlinks href=#hl-22-152>152</a>
</span><span class=lnt id=hl-22-153><a class=lnlinks href=#hl-22-153>153</a>
</span><span class=lnt id=hl-22-154><a class=lnlinks href=#hl-22-154>154</a>
</span><span class=lnt id=hl-22-155><a class=lnlinks href=#hl-22-155>155</a>
</span><span class=lnt id=hl-22-156><a class=lnlinks href=#hl-22-156>156</a>
</span><span class=lnt id=hl-22-157><a class=lnlinks href=#hl-22-157>157</a>
</span><span class=lnt id=hl-22-158><a class=lnlinks href=#hl-22-158>158</a>
</span><span class=lnt id=hl-22-159><a class=lnlinks href=#hl-22-159>159</a>
</span><span class=lnt id=hl-22-160><a class=lnlinks href=#hl-22-160>160</a>
</span><span class=lnt id=hl-22-161><a class=lnlinks href=#hl-22-161>161</a>
</span><span class=lnt id=hl-22-162><a class=lnlinks href=#hl-22-162>162</a>
</span><span class=lnt id=hl-22-163><a class=lnlinks href=#hl-22-163>163</a>
</span><span class=lnt id=hl-22-164><a class=lnlinks href=#hl-22-164>164</a>
</span><span class=lnt id=hl-22-165><a class=lnlinks href=#hl-22-165>165</a>
</span><span class=lnt id=hl-22-166><a class=lnlinks href=#hl-22-166>166</a>
</span><span class=lnt id=hl-22-167><a class=lnlinks href=#hl-22-167>167</a>
</span><span class=lnt id=hl-22-168><a class=lnlinks href=#hl-22-168>168</a>
</span><span class=lnt id=hl-22-169><a class=lnlinks href=#hl-22-169>169</a>
</span><span class=lnt id=hl-22-170><a class=lnlinks href=#hl-22-170>170</a>
</span><span class=lnt id=hl-22-171><a class=lnlinks href=#hl-22-171>171</a>
</span><span class=lnt id=hl-22-172><a class=lnlinks href=#hl-22-172>172</a>
</span><span class=lnt id=hl-22-173><a class=lnlinks href=#hl-22-173>173</a>
</span><span class=lnt id=hl-22-174><a class=lnlinks href=#hl-22-174>174</a>
</span><span class=lnt id=hl-22-175><a class=lnlinks href=#hl-22-175>175</a>
</span><span class=lnt id=hl-22-176><a class=lnlinks href=#hl-22-176>176</a>
</span><span class=lnt id=hl-22-177><a class=lnlinks href=#hl-22-177>177</a>
</span><span class=lnt id=hl-22-178><a class=lnlinks href=#hl-22-178>178</a>
</span><span class=lnt id=hl-22-179><a class=lnlinks href=#hl-22-179>179</a>
</span><span class=lnt id=hl-22-180><a class=lnlinks href=#hl-22-180>180</a>
</span><span class=lnt id=hl-22-181><a class=lnlinks href=#hl-22-181>181</a>
</span><span class=lnt id=hl-22-182><a class=lnlinks href=#hl-22-182>182</a>
</span><span class=lnt id=hl-22-183><a class=lnlinks href=#hl-22-183>183</a>
</span><span class=lnt id=hl-22-184><a class=lnlinks href=#hl-22-184>184</a>
</span><span class=lnt id=hl-22-185><a class=lnlinks href=#hl-22-185>185</a>
</span><span class=lnt id=hl-22-186><a class=lnlinks href=#hl-22-186>186</a>
</span><span class=lnt id=hl-22-187><a class=lnlinks href=#hl-22-187>187</a>
</span><span class=lnt id=hl-22-188><a class=lnlinks href=#hl-22-188>188</a>
</span><span class=lnt id=hl-22-189><a class=lnlinks href=#hl-22-189>189</a>
</span><span class=lnt id=hl-22-190><a class=lnlinks href=#hl-22-190>190</a>
</span><span class=lnt id=hl-22-191><a class=lnlinks href=#hl-22-191>191</a>
</span><span class=lnt id=hl-22-192><a class=lnlinks href=#hl-22-192>192</a>
</span><span class=lnt id=hl-22-193><a class=lnlinks href=#hl-22-193>193</a>
</span><span class=lnt id=hl-22-194><a class=lnlinks href=#hl-22-194>194</a>
</span><span class=lnt id=hl-22-195><a class=lnlinks href=#hl-22-195>195</a>
</span><span class=lnt id=hl-22-196><a class=lnlinks href=#hl-22-196>196</a>
</span><span class=lnt id=hl-22-197><a class=lnlinks href=#hl-22-197>197</a>
</span><span class=lnt id=hl-22-198><a class=lnlinks href=#hl-22-198>198</a>
</span><span class=lnt id=hl-22-199><a class=lnlinks href=#hl-22-199>199</a>
</span><span class=lnt id=hl-22-200><a class=lnlinks href=#hl-22-200>200</a>
</span><span class=lnt id=hl-22-201><a class=lnlinks href=#hl-22-201>201</a>
</span><span class=lnt id=hl-22-202><a class=lnlinks href=#hl-22-202>202</a>
</span><span class=lnt id=hl-22-203><a class=lnlinks href=#hl-22-203>203</a>
</span><span class=lnt id=hl-22-204><a class=lnlinks href=#hl-22-204>204</a>
</span><span class=lnt id=hl-22-205><a class=lnlinks href=#hl-22-205>205</a>
</span><span class=lnt id=hl-22-206><a class=lnlinks href=#hl-22-206>206</a>
</span><span class=lnt id=hl-22-207><a class=lnlinks href=#hl-22-207>207</a>
</span><span class=lnt id=hl-22-208><a class=lnlinks href=#hl-22-208>208</a>
</span><span class=lnt id=hl-22-209><a class=lnlinks href=#hl-22-209>209</a>
</span><span class=lnt id=hl-22-210><a class=lnlinks href=#hl-22-210>210</a>
</span><span class=lnt id=hl-22-211><a class=lnlinks href=#hl-22-211>211</a>
</span><span class=lnt id=hl-22-212><a class=lnlinks href=#hl-22-212>212</a>
</span><span class=lnt id=hl-22-213><a class=lnlinks href=#hl-22-213>213</a>
</span><span class=lnt id=hl-22-214><a class=lnlinks href=#hl-22-214>214</a>
</span><span class=lnt id=hl-22-215><a class=lnlinks href=#hl-22-215>215</a>
</span><span class=lnt id=hl-22-216><a class=lnlinks href=#hl-22-216>216</a>
</span><span class=lnt id=hl-22-217><a class=lnlinks href=#hl-22-217>217</a>
</span><span class=lnt id=hl-22-218><a class=lnlinks href=#hl-22-218>218</a>
</span><span class=lnt id=hl-22-219><a class=lnlinks href=#hl-22-219>219</a>
</span><span class=lnt id=hl-22-220><a class=lnlinks href=#hl-22-220>220</a>
</span><span class=lnt id=hl-22-221><a class=lnlinks href=#hl-22-221>221</a>
</span><span class=lnt id=hl-22-222><a class=lnlinks href=#hl-22-222>222</a>
</span><span class=lnt id=hl-22-223><a class=lnlinks href=#hl-22-223>223</a>
</span><span class=lnt id=hl-22-224><a class=lnlinks href=#hl-22-224>224</a>
</span><span class=lnt id=hl-22-225><a class=lnlinks href=#hl-22-225>225</a>
</span><span class=lnt id=hl-22-226><a class=lnlinks href=#hl-22-226>226</a>
</span><span class=lnt id=hl-22-227><a class=lnlinks href=#hl-22-227>227</a>
</span><span class=lnt id=hl-22-228><a class=lnlinks href=#hl-22-228>228</a>
</span><span class=lnt id=hl-22-229><a class=lnlinks href=#hl-22-229>229</a>
</span><span class=lnt id=hl-22-230><a class=lnlinks href=#hl-22-230>230</a>
</span><span class=lnt id=hl-22-231><a class=lnlinks href=#hl-22-231>231</a>
</span><span class=lnt id=hl-22-232><a class=lnlinks href=#hl-22-232>232</a>
</span><span class=lnt id=hl-22-233><a class=lnlinks href=#hl-22-233>233</a>
</span><span class=lnt id=hl-22-234><a class=lnlinks href=#hl-22-234>234</a>
</span><span class=lnt id=hl-22-235><a class=lnlinks href=#hl-22-235>235</a>
</span><span class=lnt id=hl-22-236><a class=lnlinks href=#hl-22-236>236</a>
</span><span class=lnt id=hl-22-237><a class=lnlinks href=#hl-22-237>237</a>
</span><span class=lnt id=hl-22-238><a class=lnlinks href=#hl-22-238>238</a>
</span><span class=lnt id=hl-22-239><a class=lnlinks href=#hl-22-239>239</a>
</span><span class=lnt id=hl-22-240><a class=lnlinks href=#hl-22-240>240</a>
</span><span class=lnt id=hl-22-241><a class=lnlinks href=#hl-22-241>241</a>
</span><span class=lnt id=hl-22-242><a class=lnlinks href=#hl-22-242>242</a>
</span><span class=lnt id=hl-22-243><a class=lnlinks href=#hl-22-243>243</a>
</span><span class=lnt id=hl-22-244><a class=lnlinks href=#hl-22-244>244</a>
</span><span class=lnt id=hl-22-245><a class=lnlinks href=#hl-22-245>245</a>
</span><span class=lnt id=hl-22-246><a class=lnlinks href=#hl-22-246>246</a>
</span><span class=lnt id=hl-22-247><a class=lnlinks href=#hl-22-247>247</a>
</span><span class=lnt id=hl-22-248><a class=lnlinks href=#hl-22-248>248</a>
</span><span class=lnt id=hl-22-249><a class=lnlinks href=#hl-22-249>249</a>
</span><span class=lnt id=hl-22-250><a class=lnlinks href=#hl-22-250>250</a>
</span><span class=lnt id=hl-22-251><a class=lnlinks href=#hl-22-251>251</a>
</span><span class=lnt id=hl-22-252><a class=lnlinks href=#hl-22-252>252</a>
</span><span class=lnt id=hl-22-253><a class=lnlinks href=#hl-22-253>253</a>
</span><span class=lnt id=hl-22-254><a class=lnlinks href=#hl-22-254>254</a>
</span><span class=lnt id=hl-22-255><a class=lnlinks href=#hl-22-255>255</a>
</span><span class=lnt id=hl-22-256><a class=lnlinks href=#hl-22-256>256</a>
</span><span class=lnt id=hl-22-257><a class=lnlinks href=#hl-22-257>257</a>
</span><span class=lnt id=hl-22-258><a class=lnlinks href=#hl-22-258>258</a>
</span><span class=lnt id=hl-22-259><a class=lnlinks href=#hl-22-259>259</a>
</span><span class=lnt id=hl-22-260><a class=lnlinks href=#hl-22-260>260</a>
</span><span class=lnt id=hl-22-261><a class=lnlinks href=#hl-22-261>261</a>
</span><span class=lnt id=hl-22-262><a class=lnlinks href=#hl-22-262>262</a>
</span><span class=lnt id=hl-22-263><a class=lnlinks href=#hl-22-263>263</a>
</span><span class=lnt id=hl-22-264><a class=lnlinks href=#hl-22-264>264</a>
</span><span class=lnt id=hl-22-265><a class=lnlinks href=#hl-22-265>265</a>
</span><span class=lnt id=hl-22-266><a class=lnlinks href=#hl-22-266>266</a>
</span><span class=lnt id=hl-22-267><a class=lnlinks href=#hl-22-267>267</a>
</span><span class=lnt id=hl-22-268><a class=lnlinks href=#hl-22-268>268</a>
</span><span class=lnt id=hl-22-269><a class=lnlinks href=#hl-22-269>269</a>
</span><span class=lnt id=hl-22-270><a class=lnlinks href=#hl-22-270>270</a>
</span><span class=lnt id=hl-22-271><a class=lnlinks href=#hl-22-271>271</a>
</span><span class=lnt id=hl-22-272><a class=lnlinks href=#hl-22-272>272</a>
</span><span class=lnt id=hl-22-273><a class=lnlinks href=#hl-22-273>273</a>
</span><span class=lnt id=hl-22-274><a class=lnlinks href=#hl-22-274>274</a>
</span><span class=lnt id=hl-22-275><a class=lnlinks href=#hl-22-275>275</a>
</span><span class=lnt id=hl-22-276><a class=lnlinks href=#hl-22-276>276</a>
</span><span class=lnt id=hl-22-277><a class=lnlinks href=#hl-22-277>277</a>
</span><span class=lnt id=hl-22-278><a class=lnlinks href=#hl-22-278>278</a>
</span><span class=lnt id=hl-22-279><a class=lnlinks href=#hl-22-279>279</a>
</span><span class=lnt id=hl-22-280><a class=lnlinks href=#hl-22-280>280</a>
</span><span class=lnt id=hl-22-281><a class=lnlinks href=#hl-22-281>281</a>
</span><span class=lnt id=hl-22-282><a class=lnlinks href=#hl-22-282>282</a>
</span><span class=lnt id=hl-22-283><a class=lnlinks href=#hl-22-283>283</a>
</span><span class=lnt id=hl-22-284><a class=lnlinks href=#hl-22-284>284</a>
</span><span class=lnt id=hl-22-285><a class=lnlinks href=#hl-22-285>285</a>
</span><span class=lnt id=hl-22-286><a class=lnlinks href=#hl-22-286>286</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 사용자 서비스 (User Service) - Express.js 기반
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>eureka</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;eureka-js-client&#39;</span><span class=p>).</span><span class=nx>Eureka</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>winston</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;winston&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>circuit</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;opossum&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>class</span> <span class=nx>UserService</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>constructor</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>port</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>PORT</span> <span class=o>||</span> <span class=mi>3001</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>setupMiddleware</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>setupRoutes</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>setupServiceDiscovery</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>setupCircuitBreaker</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>setupLogging</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 미들웨어 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>setupMiddleware</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>express</span><span class=p>.</span><span class=nx>json</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>express</span><span class=p>.</span><span class=nx>urlencoded</span><span class=p>({</span> <span class=nx>extended</span><span class=o>:</span> <span class=kc>true</span> <span class=p>}));</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// CORS 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>((</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>res</span><span class=p>.</span><span class=nx>header</span><span class=p>(</span><span class=s1>&#39;Access-Control-Allow-Origin&#39;</span><span class=p>,</span> <span class=s1>&#39;*&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>res</span><span class=p>.</span><span class=nx>header</span><span class=p>(</span><span class=s1>&#39;Access-Control-Allow-Headers&#39;</span><span class=p>,</span> <span class=s1>&#39;Content-Type, Authorization&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>res</span><span class=p>.</span><span class=nx>header</span><span class=p>(</span><span class=s1>&#39;Access-Control-Allow-Methods&#39;</span><span class=p>,</span> <span class=s1>&#39;GET, POST, PUT, DELETE&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 라우트 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>setupRoutes</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 헬스 체크 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/health&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>200</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>service</span><span class=o>:</span> <span class=s1>&#39;user-service&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>status</span><span class=o>:</span> <span class=s1>&#39;healthy&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>timestamp</span><span class=o>:</span> <span class=k>new</span> <span class=nb>Date</span><span class=p>().</span><span class=nx>toISOString</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 사용자 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/users&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=p>{</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>email</span><span class=p>,</span> <span class=nx>password</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1>// 입력 검증
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>name</span> <span class=o>||</span> <span class=o>!</span><span class=nx>email</span> <span class=o>||</span> <span class=o>!</span><span class=nx>password</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>400</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                        <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Missing required fields&#39;</span>
</span></span><span class=line><span class=cl>                    <span class=p>});</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>createUser</span><span class=p>({</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>email</span><span class=p>,</span> <span class=nx>password</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1>// 이벤트 발행 (다른 서비스에 알림)
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>publishEvent</span><span class=p>(</span><span class=s1>&#39;user.created&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>userId</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>email</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>email</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>timestamp</span><span class=o>:</span> <span class=k>new</span> <span class=nb>Date</span><span class=p>().</span><span class=nx>toISOString</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>201</span><span class=p>).</span><span class=nx>json</span><span class=p>(</span><span class=nx>user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>logger</span><span class=p>.</span><span class=nx>info</span><span class=p>(</span><span class=sb>`User created: </span><span class=si>${</span><span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>logger</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error creating user:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>500</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Internal server error&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 사용자 조회
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/users/:id&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=p>{</span> <span class=nx>id</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>params</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>getUserById</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>404</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;User not found&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>(</span><span class=nx>user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>logger</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error fetching user:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>500</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Internal server error&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 사용자 목록 조회
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/users&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=p>{</span> <span class=nx>page</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>limit</span> <span class=o>=</span> <span class=mi>10</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>query</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>users</span> <span class=o>=</span> <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>getUsers</span><span class=p>(</span><span class=nx>page</span><span class=p>,</span> <span class=nx>limit</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>(</span><span class=nx>users</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>logger</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error fetching users:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>500</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Internal server error&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 다른 서비스 호출 예시 (주문 서비스)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/users/:id/orders&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=p>{</span> <span class=nx>id</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>params</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1>// 써킷 브레이커를 통한 외부 서비스 호출
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=kr>const</span> <span class=nx>orders</span> <span class=o>=</span> <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>orderServiceBreaker</span><span class=p>.</span><span class=nx>fire</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>(</span><span class=nx>orders</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>logger</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error fetching user orders:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=c1>// 써킷 브레이커가 열린 경우 기본값 반환
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span> <span class=nx>orders</span><span class=o>:</span> <span class=p>[],</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;Orders service unavailable&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 서비스 디스커버리 설정 (Eureka)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>setupServiceDiscovery</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>eurekaClient</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>eureka</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>instance</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>app</span><span class=o>:</span> <span class=s1>&#39;user-service&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>hostName</span><span class=o>:</span> <span class=s1>&#39;localhost&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>ipAddr</span><span class=o>:</span> <span class=s1>&#39;127.0.0.1&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>port</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;$&#39;</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>port</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;@enabled&#39;</span><span class=o>:</span> <span class=s1>&#39;true&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nx>vipAddress</span><span class=o>:</span> <span class=s1>&#39;user-service&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>dataCenterInfo</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;@class&#39;</span><span class=o>:</span> <span class=s1>&#39;com.netflix.appinfo.InstanceInfo$DefaultDataCenterInfo&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;MyOwn&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>eureka</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>host</span><span class=o>:</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>EUREKA_HOST</span> <span class=o>||</span> <span class=s1>&#39;localhost&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>port</span><span class=o>:</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>EUREKA_PORT</span> <span class=o>||</span> <span class=mi>8761</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>servicePath</span><span class=o>:</span> <span class=s1>&#39;/eureka/apps/&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 써킷 브레이커 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>setupCircuitBreaker</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>timeout</span><span class=o>:</span> <span class=mi>3000</span><span class=p>,</span>        <span class=c1>// 3초 타임아웃
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>errorThresholdPercentage</span><span class=o>:</span> <span class=mi>50</span><span class=p>,</span> <span class=c1>// 50% 실패율
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>resetTimeout</span><span class=o>:</span> <span class=mi>30000</span>   <span class=c1>// 30초 후 재시도
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 주문 서비스 호출을 위한 써킷 브레이커
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>orderServiceBreaker</span> <span class=o>=</span> <span class=nx>circuit</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>callOrderService</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=k>this</span><span class=p>),</span> <span class=nx>options</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 써킷 브레이커 이벤트 핸들링
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>orderServiceBreaker</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;open&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>logger</span><span class=p>.</span><span class=nx>warn</span><span class=p>(</span><span class=s1>&#39;Circuit breaker opened for order service&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>orderServiceBreaker</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;halfOpen&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>logger</span><span class=p>.</span><span class=nx>info</span><span class=p>(</span><span class=s1>&#39;Circuit breaker half-open for order service&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 로깅 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>setupLogging</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>logger</span> <span class=o>=</span> <span class=nx>winston</span><span class=p>.</span><span class=nx>createLogger</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>level</span><span class=o>:</span> <span class=s1>&#39;info&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>format</span><span class=o>:</span> <span class=nx>winston</span><span class=p>.</span><span class=nx>format</span><span class=p>.</span><span class=nx>combine</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=nx>winston</span><span class=p>.</span><span class=nx>format</span><span class=p>.</span><span class=nx>timestamp</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=nx>winston</span><span class=p>.</span><span class=nx>format</span><span class=p>.</span><span class=nx>errors</span><span class=p>({</span> <span class=nx>stack</span><span class=o>:</span> <span class=kc>true</span> <span class=p>}),</span>
</span></span><span class=line><span class=cl>                <span class=nx>winston</span><span class=p>.</span><span class=nx>format</span><span class=p>.</span><span class=nx>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>transports</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=nx>winston</span><span class=p>.</span><span class=nx>transports</span><span class=p>.</span><span class=nx>Console</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=nx>winston</span><span class=p>.</span><span class=nx>transports</span><span class=p>.</span><span class=nx>File</span><span class=p>({</span> <span class=nx>filename</span><span class=o>:</span> <span class=s1>&#39;user-service.log&#39;</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 사용자 생성 (데이터베이스 로직)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>async</span> <span class=nx>createUser</span><span class=p>(</span><span class=nx>userData</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 실제 구현에서는 데이터베이스 연동
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>id</span><span class=o>:</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>().</span><span class=nx>toString</span><span class=p>(</span><span class=mi>36</span><span class=p>).</span><span class=nx>substr</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>9</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>name</span><span class=o>:</span> <span class=nx>userData</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>email</span><span class=o>:</span> <span class=nx>userData</span><span class=p>.</span><span class=nx>email</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>createdAt</span><span class=o>:</span> <span class=k>new</span> <span class=nb>Date</span><span class=p>().</span><span class=nx>toISOString</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 데이터베이스 저장 로직
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// await this.userRepository.save(user);
</span></span></span><span class=line><span class=cl><span class=c1></span>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>user</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 사용자 조회
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>async</span> <span class=nx>getUserById</span><span class=p>(</span><span class=nx>id</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 실제 구현에서는 데이터베이스 조회
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// return await this.userRepository.findById(id);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;John Doe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>email</span><span class=o>:</span> <span class=s1>&#39;john@example.com&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>createdAt</span><span class=o>:</span> <span class=s1>&#39;2023-01-01T00:00:00Z&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 사용자 목록 조회
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>async</span> <span class=nx>getUsers</span><span class=p>(</span><span class=nx>page</span><span class=p>,</span> <span class=nx>limit</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 실제 구현에서는 페이징 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// return await this.userRepository.findAll(page, limit);
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>users</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;John Doe&#39;</span><span class=p>,</span> <span class=nx>email</span><span class=o>:</span> <span class=s1>&#39;john@example.com&#39;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=s1>&#39;2&#39;</span><span class=p>,</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Jane Smith&#39;</span><span class=p>,</span> <span class=nx>email</span><span class=o>:</span> <span class=s1>&#39;jane@example.com&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>total</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>page</span><span class=o>:</span> <span class=nb>parseInt</span><span class=p>(</span><span class=nx>page</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>limit</span><span class=o>:</span> <span class=nb>parseInt</span><span class=p>(</span><span class=nx>limit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 외부 서비스 호출 (주문 서비스)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>async</span> <span class=nx>callOrderService</span><span class=p>(</span><span class=nx>userId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>fetch</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;node-fetch&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 서비스 디스커버리를 통해 주문 서비스 URL 획득
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>orderServiceUrl</span> <span class=o>=</span> <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>getServiceUrl</span><span class=p>(</span><span class=s1>&#39;order-service&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nx>orderServiceUrl</span><span class=si>}</span><span class=sb>/orders/user/</span><span class=si>${</span><span class=nx>userId</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>response</span><span class=p>.</span><span class=nx>ok</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=sb>`Order service error: </span><span class=si>${</span><span class=nx>response</span><span class=p>.</span><span class=nx>status</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kr>await</span> <span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 서비스 URL 획득 (서비스 디스커버리)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>async</span> <span class=nx>getServiceUrl</span><span class=p>(</span><span class=nx>serviceName</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 실제 구현에서는 Eureka 클라이언트 사용
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>services</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;order-service&#39;</span><span class=o>:</span> <span class=s1>&#39;http://localhost:3002&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;payment-service&#39;</span><span class=o>:</span> <span class=s1>&#39;http://localhost:3003&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>services</span><span class=p>[</span><span class=nx>serviceName</span><span class=p>]</span> <span class=o>||</span> <span class=s1>&#39;http://localhost:3000&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 이벤트 발행 (메시지 큐를 통한 비동기 통신)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>async</span> <span class=nx>publishEvent</span><span class=p>(</span><span class=nx>eventType</span><span class=p>,</span> <span class=nx>data</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 실제 구현에서는 RabbitMQ, Apache Kafka 등 사용
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>logger</span><span class=p>.</span><span class=nx>info</span><span class=p>(</span><span class=sb>`Publishing event: </span><span class=si>${</span><span class=nx>eventType</span><span class=si>}</span><span class=sb>`</span><span class=p>,</span> <span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 예시: 메시지 큐에 이벤트 발행
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// await this.messageQueue.publish(eventType, data);
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 서비스 시작
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>start</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>port</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>logger</span><span class=p>.</span><span class=nx>info</span><span class=p>(</span><span class=sb>`User service running on port </span><span class=si>${</span><span class=k>this</span><span class=p>.</span><span class=nx>port</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 서비스 디스커버리에 등록
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>this</span><span class=p>.</span><span class=nx>eurekaClient</span><span class=p>.</span><span class=nx>start</span><span class=p>((</span><span class=nx>error</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>logger</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Error starting Eureka client:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>this</span><span class=p>.</span><span class=nx>logger</span><span class=p>.</span><span class=nx>info</span><span class=p>(</span><span class=s1>&#39;User service registered with Eureka&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// graceful shutdown 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>process</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;SIGTERM&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>logger</span><span class=p>.</span><span class=nx>info</span><span class=p>(</span><span class=s1>&#39;Received SIGTERM, shutting down gracefully&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>eurekaClient</span><span class=p>.</span><span class=nx>stop</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nx>process</span><span class=p>.</span><span class=nx>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 서비스 인스턴스 생성 및 시작
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>userService</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>UserService</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>userService</span><span class=p>.</span><span class=nx>start</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=nx>UserService</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=python-netflix-스타일의-비디오-스트리밍-플랫폼의-핵심-서비스>Python: Netflix 스타일의 비디오 스트리밍 플랫폼의 핵심 서비스<a hidden class=anchor aria-hidden=true href=#python-netflix-스타일의-비디오-스트리밍-플랫폼의-핵심-서비스>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1> 1</a>
</span><span class=lnt id=hl-23-2><a class=lnlinks href=#hl-23-2> 2</a>
</span><span class=lnt id=hl-23-3><a class=lnlinks href=#hl-23-3> 3</a>
</span><span class=lnt id=hl-23-4><a class=lnlinks href=#hl-23-4> 4</a>
</span><span class=lnt id=hl-23-5><a class=lnlinks href=#hl-23-5> 5</a>
</span><span class=lnt id=hl-23-6><a class=lnlinks href=#hl-23-6> 6</a>
</span><span class=lnt id=hl-23-7><a class=lnlinks href=#hl-23-7> 7</a>
</span><span class=lnt id=hl-23-8><a class=lnlinks href=#hl-23-8> 8</a>
</span><span class=lnt id=hl-23-9><a class=lnlinks href=#hl-23-9> 9</a>
</span><span class=lnt id=hl-23-10><a class=lnlinks href=#hl-23-10>10</a>
</span><span class=lnt id=hl-23-11><a class=lnlinks href=#hl-23-11>11</a>
</span><span class=lnt id=hl-23-12><a class=lnlinks href=#hl-23-12>12</a>
</span><span class=lnt id=hl-23-13><a class=lnlinks href=#hl-23-13>13</a>
</span><span class=lnt id=hl-23-14><a class=lnlinks href=#hl-23-14>14</a>
</span><span class=lnt id=hl-23-15><a class=lnlinks href=#hl-23-15>15</a>
</span><span class=lnt id=hl-23-16><a class=lnlinks href=#hl-23-16>16</a>
</span><span class=lnt id=hl-23-17><a class=lnlinks href=#hl-23-17>17</a>
</span><span class=lnt id=hl-23-18><a class=lnlinks href=#hl-23-18>18</a>
</span><span class=lnt id=hl-23-19><a class=lnlinks href=#hl-23-19>19</a>
</span><span class=lnt id=hl-23-20><a class=lnlinks href=#hl-23-20>20</a>
</span><span class=lnt id=hl-23-21><a class=lnlinks href=#hl-23-21>21</a>
</span><span class=lnt id=hl-23-22><a class=lnlinks href=#hl-23-22>22</a>
</span><span class=lnt id=hl-23-23><a class=lnlinks href=#hl-23-23>23</a>
</span><span class=lnt id=hl-23-24><a class=lnlinks href=#hl-23-24>24</a>
</span><span class=lnt id=hl-23-25><a class=lnlinks href=#hl-23-25>25</a>
</span><span class=lnt id=hl-23-26><a class=lnlinks href=#hl-23-26>26</a>
</span><span class=lnt id=hl-23-27><a class=lnlinks href=#hl-23-27>27</a>
</span><span class=lnt id=hl-23-28><a class=lnlinks href=#hl-23-28>28</a>
</span><span class=lnt id=hl-23-29><a class=lnlinks href=#hl-23-29>29</a>
</span><span class=lnt id=hl-23-30><a class=lnlinks href=#hl-23-30>30</a>
</span><span class=lnt id=hl-23-31><a class=lnlinks href=#hl-23-31>31</a>
</span><span class=lnt id=hl-23-32><a class=lnlinks href=#hl-23-32>32</a>
</span><span class=lnt id=hl-23-33><a class=lnlinks href=#hl-23-33>33</a>
</span><span class=lnt id=hl-23-34><a class=lnlinks href=#hl-23-34>34</a>
</span><span class=lnt id=hl-23-35><a class=lnlinks href=#hl-23-35>35</a>
</span><span class=lnt id=hl-23-36><a class=lnlinks href=#hl-23-36>36</a>
</span><span class=lnt id=hl-23-37><a class=lnlinks href=#hl-23-37>37</a>
</span><span class=lnt id=hl-23-38><a class=lnlinks href=#hl-23-38>38</a>
</span><span class=lnt id=hl-23-39><a class=lnlinks href=#hl-23-39>39</a>
</span><span class=lnt id=hl-23-40><a class=lnlinks href=#hl-23-40>40</a>
</span><span class=lnt id=hl-23-41><a class=lnlinks href=#hl-23-41>41</a>
</span><span class=lnt id=hl-23-42><a class=lnlinks href=#hl-23-42>42</a>
</span><span class=lnt id=hl-23-43><a class=lnlinks href=#hl-23-43>43</a>
</span><span class=lnt id=hl-23-44><a class=lnlinks href=#hl-23-44>44</a>
</span><span class=lnt id=hl-23-45><a class=lnlinks href=#hl-23-45>45</a>
</span><span class=lnt id=hl-23-46><a class=lnlinks href=#hl-23-46>46</a>
</span><span class=lnt id=hl-23-47><a class=lnlinks href=#hl-23-47>47</a>
</span><span class=lnt id=hl-23-48><a class=lnlinks href=#hl-23-48>48</a>
</span><span class=lnt id=hl-23-49><a class=lnlinks href=#hl-23-49>49</a>
</span><span class=lnt id=hl-23-50><a class=lnlinks href=#hl-23-50>50</a>
</span><span class=lnt id=hl-23-51><a class=lnlinks href=#hl-23-51>51</a>
</span><span class=lnt id=hl-23-52><a class=lnlinks href=#hl-23-52>52</a>
</span><span class=lnt id=hl-23-53><a class=lnlinks href=#hl-23-53>53</a>
</span><span class=lnt id=hl-23-54><a class=lnlinks href=#hl-23-54>54</a>
</span><span class=lnt id=hl-23-55><a class=lnlinks href=#hl-23-55>55</a>
</span><span class=lnt id=hl-23-56><a class=lnlinks href=#hl-23-56>56</a>
</span><span class=lnt id=hl-23-57><a class=lnlinks href=#hl-23-57>57</a>
</span><span class=lnt id=hl-23-58><a class=lnlinks href=#hl-23-58>58</a>
</span><span class=lnt id=hl-23-59><a class=lnlinks href=#hl-23-59>59</a>
</span><span class=lnt id=hl-23-60><a class=lnlinks href=#hl-23-60>60</a>
</span><span class=lnt id=hl-23-61><a class=lnlinks href=#hl-23-61>61</a>
</span><span class=lnt id=hl-23-62><a class=lnlinks href=#hl-23-62>62</a>
</span><span class=lnt id=hl-23-63><a class=lnlinks href=#hl-23-63>63</a>
</span><span class=lnt id=hl-23-64><a class=lnlinks href=#hl-23-64>64</a>
</span><span class=lnt id=hl-23-65><a class=lnlinks href=#hl-23-65>65</a>
</span><span class=lnt id=hl-23-66><a class=lnlinks href=#hl-23-66>66</a>
</span><span class=lnt id=hl-23-67><a class=lnlinks href=#hl-23-67>67</a>
</span><span class=lnt id=hl-23-68><a class=lnlinks href=#hl-23-68>68</a>
</span><span class=lnt id=hl-23-69><a class=lnlinks href=#hl-23-69>69</a>
</span><span class=lnt id=hl-23-70><a class=lnlinks href=#hl-23-70>70</a>
</span><span class=lnt id=hl-23-71><a class=lnlinks href=#hl-23-71>71</a>
</span><span class=lnt id=hl-23-72><a class=lnlinks href=#hl-23-72>72</a>
</span><span class=lnt id=hl-23-73><a class=lnlinks href=#hl-23-73>73</a>
</span><span class=lnt id=hl-23-74><a class=lnlinks href=#hl-23-74>74</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># user_service.py - 사용자 서비스</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask_sqlalchemy</span> <span class=kn>import</span> <span class=n>SQLAlchemy</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>jwt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;SQLALCHEMY_DATABASE_URI&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;postgresql://user:pass@localhost/userdb&#39;</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;SECRET_KEY&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;your-secret-key&#39;</span>
</span></span><span class=line><span class=cl><span class=n>db</span> <span class=o>=</span> <span class=n>SQLAlchemy</span><span class=p>(</span><span class=n>app</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>(</span><span class=n>db</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;사용자 정보를 저장하는 모델&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>Column</span><span class=p>(</span><span class=n>db</span><span class=o>.</span><span class=n>Integer</span><span class=p>,</span> <span class=n>primary_key</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>Column</span><span class=p>(</span><span class=n>db</span><span class=o>.</span><span class=n>String</span><span class=p>(</span><span class=mi>80</span><span class=p>),</span> <span class=n>unique</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>nullable</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>email</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>Column</span><span class=p>(</span><span class=n>db</span><span class=o>.</span><span class=n>String</span><span class=p>(</span><span class=mi>120</span><span class=p>),</span> <span class=n>unique</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>nullable</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>subscription_tier</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>Column</span><span class=p>(</span><span class=n>db</span><span class=o>.</span><span class=n>String</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span> <span class=n>default</span><span class=o>=</span><span class=s1>&#39;basic&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>created_at</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>Column</span><span class=p>(</span><span class=n>db</span><span class=o>.</span><span class=n>DateTime</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UserService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;사용자 관리를 위한 비즈니스 로직&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>authenticate_user</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;사용자 인증 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>query</span><span class=o>.</span><span class=n>filter_by</span><span class=p>(</span><span class=n>username</span><span class=o>=</span><span class=n>username</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_verify_password</span><span class=p>(</span><span class=n>password</span><span class=p>,</span> <span class=n>user</span><span class=o>.</span><span class=n>password_hash</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=c1># JWT 토큰 생성</span>
</span></span><span class=line><span class=cl>            <span class=n>token</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>encode</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;exp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>+</span> <span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>hours</span><span class=o>=</span><span class=mi>24</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span> <span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;SECRET_KEY&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;token&#39;</span><span class=p>:</span> <span class=n>token</span><span class=p>,</span> <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user</span><span class=o>.</span><span class=n>id</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_user_profile</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;사용자 프로필 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>query</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=n>user</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=n>user</span><span class=o>.</span><span class=n>username</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;email&#39;</span><span class=p>:</span> <span class=n>user</span><span class=o>.</span><span class=n>email</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;subscription_tier&#39;</span><span class=p>:</span> <span class=n>user</span><span class=o>.</span><span class=n>subscription_tier</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_verify_password</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>password</span><span class=p>,</span> <span class=n>password_hash</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;패스워드 검증 (실제로는 bcrypt 등 사용)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 실제 구현에서는 보안 해시 함수 사용</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>user_service</span> <span class=o>=</span> <span class=n>UserService</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/auth&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>authenticate</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;사용자 인증 엔드포인트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>user_service</span><span class=o>.</span><span class=n>authenticate_user</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>],</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>result</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>result</span><span class=p>),</span> <span class=mi>200</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Invalid credentials&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/users/&lt;int:user_id&gt;&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_profile</span><span class=p>(</span><span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;사용자 프로필 조회 엔드포인트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>profile</span> <span class=o>=</span> <span class=n>user_service</span><span class=o>.</span><span class=n>get_user_profile</span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>profile</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>profile</span><span class=p>),</span> <span class=mi>200</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;User not found&#39;</span><span class=p>}),</span> <span class=mi>404</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 개발 환경에서만 debug=True 사용</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>debug</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>5001</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1>  1</a>
</span><span class=lnt id=hl-24-2><a class=lnlinks href=#hl-24-2>  2</a>
</span><span class=lnt id=hl-24-3><a class=lnlinks href=#hl-24-3>  3</a>
</span><span class=lnt id=hl-24-4><a class=lnlinks href=#hl-24-4>  4</a>
</span><span class=lnt id=hl-24-5><a class=lnlinks href=#hl-24-5>  5</a>
</span><span class=lnt id=hl-24-6><a class=lnlinks href=#hl-24-6>  6</a>
</span><span class=lnt id=hl-24-7><a class=lnlinks href=#hl-24-7>  7</a>
</span><span class=lnt id=hl-24-8><a class=lnlinks href=#hl-24-8>  8</a>
</span><span class=lnt id=hl-24-9><a class=lnlinks href=#hl-24-9>  9</a>
</span><span class=lnt id=hl-24-10><a class=lnlinks href=#hl-24-10> 10</a>
</span><span class=lnt id=hl-24-11><a class=lnlinks href=#hl-24-11> 11</a>
</span><span class=lnt id=hl-24-12><a class=lnlinks href=#hl-24-12> 12</a>
</span><span class=lnt id=hl-24-13><a class=lnlinks href=#hl-24-13> 13</a>
</span><span class=lnt id=hl-24-14><a class=lnlinks href=#hl-24-14> 14</a>
</span><span class=lnt id=hl-24-15><a class=lnlinks href=#hl-24-15> 15</a>
</span><span class=lnt id=hl-24-16><a class=lnlinks href=#hl-24-16> 16</a>
</span><span class=lnt id=hl-24-17><a class=lnlinks href=#hl-24-17> 17</a>
</span><span class=lnt id=hl-24-18><a class=lnlinks href=#hl-24-18> 18</a>
</span><span class=lnt id=hl-24-19><a class=lnlinks href=#hl-24-19> 19</a>
</span><span class=lnt id=hl-24-20><a class=lnlinks href=#hl-24-20> 20</a>
</span><span class=lnt id=hl-24-21><a class=lnlinks href=#hl-24-21> 21</a>
</span><span class=lnt id=hl-24-22><a class=lnlinks href=#hl-24-22> 22</a>
</span><span class=lnt id=hl-24-23><a class=lnlinks href=#hl-24-23> 23</a>
</span><span class=lnt id=hl-24-24><a class=lnlinks href=#hl-24-24> 24</a>
</span><span class=lnt id=hl-24-25><a class=lnlinks href=#hl-24-25> 25</a>
</span><span class=lnt id=hl-24-26><a class=lnlinks href=#hl-24-26> 26</a>
</span><span class=lnt id=hl-24-27><a class=lnlinks href=#hl-24-27> 27</a>
</span><span class=lnt id=hl-24-28><a class=lnlinks href=#hl-24-28> 28</a>
</span><span class=lnt id=hl-24-29><a class=lnlinks href=#hl-24-29> 29</a>
</span><span class=lnt id=hl-24-30><a class=lnlinks href=#hl-24-30> 30</a>
</span><span class=lnt id=hl-24-31><a class=lnlinks href=#hl-24-31> 31</a>
</span><span class=lnt id=hl-24-32><a class=lnlinks href=#hl-24-32> 32</a>
</span><span class=lnt id=hl-24-33><a class=lnlinks href=#hl-24-33> 33</a>
</span><span class=lnt id=hl-24-34><a class=lnlinks href=#hl-24-34> 34</a>
</span><span class=lnt id=hl-24-35><a class=lnlinks href=#hl-24-35> 35</a>
</span><span class=lnt id=hl-24-36><a class=lnlinks href=#hl-24-36> 36</a>
</span><span class=lnt id=hl-24-37><a class=lnlinks href=#hl-24-37> 37</a>
</span><span class=lnt id=hl-24-38><a class=lnlinks href=#hl-24-38> 38</a>
</span><span class=lnt id=hl-24-39><a class=lnlinks href=#hl-24-39> 39</a>
</span><span class=lnt id=hl-24-40><a class=lnlinks href=#hl-24-40> 40</a>
</span><span class=lnt id=hl-24-41><a class=lnlinks href=#hl-24-41> 41</a>
</span><span class=lnt id=hl-24-42><a class=lnlinks href=#hl-24-42> 42</a>
</span><span class=lnt id=hl-24-43><a class=lnlinks href=#hl-24-43> 43</a>
</span><span class=lnt id=hl-24-44><a class=lnlinks href=#hl-24-44> 44</a>
</span><span class=lnt id=hl-24-45><a class=lnlinks href=#hl-24-45> 45</a>
</span><span class=lnt id=hl-24-46><a class=lnlinks href=#hl-24-46> 46</a>
</span><span class=lnt id=hl-24-47><a class=lnlinks href=#hl-24-47> 47</a>
</span><span class=lnt id=hl-24-48><a class=lnlinks href=#hl-24-48> 48</a>
</span><span class=lnt id=hl-24-49><a class=lnlinks href=#hl-24-49> 49</a>
</span><span class=lnt id=hl-24-50><a class=lnlinks href=#hl-24-50> 50</a>
</span><span class=lnt id=hl-24-51><a class=lnlinks href=#hl-24-51> 51</a>
</span><span class=lnt id=hl-24-52><a class=lnlinks href=#hl-24-52> 52</a>
</span><span class=lnt id=hl-24-53><a class=lnlinks href=#hl-24-53> 53</a>
</span><span class=lnt id=hl-24-54><a class=lnlinks href=#hl-24-54> 54</a>
</span><span class=lnt id=hl-24-55><a class=lnlinks href=#hl-24-55> 55</a>
</span><span class=lnt id=hl-24-56><a class=lnlinks href=#hl-24-56> 56</a>
</span><span class=lnt id=hl-24-57><a class=lnlinks href=#hl-24-57> 57</a>
</span><span class=lnt id=hl-24-58><a class=lnlinks href=#hl-24-58> 58</a>
</span><span class=lnt id=hl-24-59><a class=lnlinks href=#hl-24-59> 59</a>
</span><span class=lnt id=hl-24-60><a class=lnlinks href=#hl-24-60> 60</a>
</span><span class=lnt id=hl-24-61><a class=lnlinks href=#hl-24-61> 61</a>
</span><span class=lnt id=hl-24-62><a class=lnlinks href=#hl-24-62> 62</a>
</span><span class=lnt id=hl-24-63><a class=lnlinks href=#hl-24-63> 63</a>
</span><span class=lnt id=hl-24-64><a class=lnlinks href=#hl-24-64> 64</a>
</span><span class=lnt id=hl-24-65><a class=lnlinks href=#hl-24-65> 65</a>
</span><span class=lnt id=hl-24-66><a class=lnlinks href=#hl-24-66> 66</a>
</span><span class=lnt id=hl-24-67><a class=lnlinks href=#hl-24-67> 67</a>
</span><span class=lnt id=hl-24-68><a class=lnlinks href=#hl-24-68> 68</a>
</span><span class=lnt id=hl-24-69><a class=lnlinks href=#hl-24-69> 69</a>
</span><span class=lnt id=hl-24-70><a class=lnlinks href=#hl-24-70> 70</a>
</span><span class=lnt id=hl-24-71><a class=lnlinks href=#hl-24-71> 71</a>
</span><span class=lnt id=hl-24-72><a class=lnlinks href=#hl-24-72> 72</a>
</span><span class=lnt id=hl-24-73><a class=lnlinks href=#hl-24-73> 73</a>
</span><span class=lnt id=hl-24-74><a class=lnlinks href=#hl-24-74> 74</a>
</span><span class=lnt id=hl-24-75><a class=lnlinks href=#hl-24-75> 75</a>
</span><span class=lnt id=hl-24-76><a class=lnlinks href=#hl-24-76> 76</a>
</span><span class=lnt id=hl-24-77><a class=lnlinks href=#hl-24-77> 77</a>
</span><span class=lnt id=hl-24-78><a class=lnlinks href=#hl-24-78> 78</a>
</span><span class=lnt id=hl-24-79><a class=lnlinks href=#hl-24-79> 79</a>
</span><span class=lnt id=hl-24-80><a class=lnlinks href=#hl-24-80> 80</a>
</span><span class=lnt id=hl-24-81><a class=lnlinks href=#hl-24-81> 81</a>
</span><span class=lnt id=hl-24-82><a class=lnlinks href=#hl-24-82> 82</a>
</span><span class=lnt id=hl-24-83><a class=lnlinks href=#hl-24-83> 83</a>
</span><span class=lnt id=hl-24-84><a class=lnlinks href=#hl-24-84> 84</a>
</span><span class=lnt id=hl-24-85><a class=lnlinks href=#hl-24-85> 85</a>
</span><span class=lnt id=hl-24-86><a class=lnlinks href=#hl-24-86> 86</a>
</span><span class=lnt id=hl-24-87><a class=lnlinks href=#hl-24-87> 87</a>
</span><span class=lnt id=hl-24-88><a class=lnlinks href=#hl-24-88> 88</a>
</span><span class=lnt id=hl-24-89><a class=lnlinks href=#hl-24-89> 89</a>
</span><span class=lnt id=hl-24-90><a class=lnlinks href=#hl-24-90> 90</a>
</span><span class=lnt id=hl-24-91><a class=lnlinks href=#hl-24-91> 91</a>
</span><span class=lnt id=hl-24-92><a class=lnlinks href=#hl-24-92> 92</a>
</span><span class=lnt id=hl-24-93><a class=lnlinks href=#hl-24-93> 93</a>
</span><span class=lnt id=hl-24-94><a class=lnlinks href=#hl-24-94> 94</a>
</span><span class=lnt id=hl-24-95><a class=lnlinks href=#hl-24-95> 95</a>
</span><span class=lnt id=hl-24-96><a class=lnlinks href=#hl-24-96> 96</a>
</span><span class=lnt id=hl-24-97><a class=lnlinks href=#hl-24-97> 97</a>
</span><span class=lnt id=hl-24-98><a class=lnlinks href=#hl-24-98> 98</a>
</span><span class=lnt id=hl-24-99><a class=lnlinks href=#hl-24-99> 99</a>
</span><span class=lnt id=hl-24-100><a class=lnlinks href=#hl-24-100>100</a>
</span><span class=lnt id=hl-24-101><a class=lnlinks href=#hl-24-101>101</a>
</span><span class=lnt id=hl-24-102><a class=lnlinks href=#hl-24-102>102</a>
</span><span class=lnt id=hl-24-103><a class=lnlinks href=#hl-24-103>103</a>
</span><span class=lnt id=hl-24-104><a class=lnlinks href=#hl-24-104>104</a>
</span><span class=lnt id=hl-24-105><a class=lnlinks href=#hl-24-105>105</a>
</span><span class=lnt id=hl-24-106><a class=lnlinks href=#hl-24-106>106</a>
</span><span class=lnt id=hl-24-107><a class=lnlinks href=#hl-24-107>107</a>
</span><span class=lnt id=hl-24-108><a class=lnlinks href=#hl-24-108>108</a>
</span><span class=lnt id=hl-24-109><a class=lnlinks href=#hl-24-109>109</a>
</span><span class=lnt id=hl-24-110><a class=lnlinks href=#hl-24-110>110</a>
</span><span class=lnt id=hl-24-111><a class=lnlinks href=#hl-24-111>111</a>
</span><span class=lnt id=hl-24-112><a class=lnlinks href=#hl-24-112>112</a>
</span><span class=lnt id=hl-24-113><a class=lnlinks href=#hl-24-113>113</a>
</span><span class=lnt id=hl-24-114><a class=lnlinks href=#hl-24-114>114</a>
</span><span class=lnt id=hl-24-115><a class=lnlinks href=#hl-24-115>115</a>
</span><span class=lnt id=hl-24-116><a class=lnlinks href=#hl-24-116>116</a>
</span><span class=lnt id=hl-24-117><a class=lnlinks href=#hl-24-117>117</a>
</span><span class=lnt id=hl-24-118><a class=lnlinks href=#hl-24-118>118</a>
</span><span class=lnt id=hl-24-119><a class=lnlinks href=#hl-24-119>119</a>
</span><span class=lnt id=hl-24-120><a class=lnlinks href=#hl-24-120>120</a>
</span><span class=lnt id=hl-24-121><a class=lnlinks href=#hl-24-121>121</a>
</span><span class=lnt id=hl-24-122><a class=lnlinks href=#hl-24-122>122</a>
</span><span class=lnt id=hl-24-123><a class=lnlinks href=#hl-24-123>123</a>
</span><span class=lnt id=hl-24-124><a class=lnlinks href=#hl-24-124>124</a>
</span><span class=lnt id=hl-24-125><a class=lnlinks href=#hl-24-125>125</a>
</span><span class=lnt id=hl-24-126><a class=lnlinks href=#hl-24-126>126</a>
</span><span class=lnt id=hl-24-127><a class=lnlinks href=#hl-24-127>127</a>
</span><span class=lnt id=hl-24-128><a class=lnlinks href=#hl-24-128>128</a>
</span><span class=lnt id=hl-24-129><a class=lnlinks href=#hl-24-129>129</a>
</span><span class=lnt id=hl-24-130><a class=lnlinks href=#hl-24-130>130</a>
</span><span class=lnt id=hl-24-131><a class=lnlinks href=#hl-24-131>131</a>
</span><span class=lnt id=hl-24-132><a class=lnlinks href=#hl-24-132>132</a>
</span><span class=lnt id=hl-24-133><a class=lnlinks href=#hl-24-133>133</a>
</span><span class=lnt id=hl-24-134><a class=lnlinks href=#hl-24-134>134</a>
</span><span class=lnt id=hl-24-135><a class=lnlinks href=#hl-24-135>135</a>
</span><span class=lnt id=hl-24-136><a class=lnlinks href=#hl-24-136>136</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># recommendation_service.py - 추천 서비스</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>redis</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span><span class=p>,</span> <span class=n>timedelta</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>redis_client</span> <span class=o>=</span> <span class=n>redis</span><span class=o>.</span><span class=n>Redis</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s1>&#39;localhost&#39;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>6379</span><span class=p>,</span> <span class=n>db</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>RecommendationService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;개인화된 콘텐츠 추천을 위한 서비스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 외부 서비스 URL 설정</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_service_url</span> <span class=o>=</span> <span class=s1>&#39;http://localhost:5001&#39;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>video_service_url</span> <span class=o>=</span> <span class=s1>&#39;http://localhost:5003&#39;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_recommendations</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;사용자 맞춤 추천 콘텐츠 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 캐시에서 추천 결과 확인</span>
</span></span><span class=line><span class=cl>        <span class=n>cache_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;recommendations:</span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>cached_recommendations</span> <span class=o>=</span> <span class=n>redis_client</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>cache_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>cached_recommendations</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Cache hit for user </span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>cached_recommendations</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 사용자 프로필 조회 (User Service 호출)</span>
</span></span><span class=line><span class=cl>        <span class=n>user_profile</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_user_profile</span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>user_profile</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;User not found&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 시청 히스토리 분석</span>
</span></span><span class=line><span class=cl>        <span class=n>viewing_history</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_viewing_history</span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 추천 알고리즘 실행</span>
</span></span><span class=line><span class=cl>        <span class=n>recommendations</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_generate_recommendations</span><span class=p>(</span><span class=n>user_profile</span><span class=p>,</span> <span class=n>viewing_history</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 캐시에 결과 저장 (1시간 TTL)</span>
</span></span><span class=line><span class=cl>        <span class=n>redis_client</span><span class=o>.</span><span class=n>setex</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>cache_key</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>            <span class=n>timedelta</span><span class=p>(</span><span class=n>hours</span><span class=o>=</span><span class=mi>1</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>            <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>recommendations</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>recommendations</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_get_user_profile</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;User Service에서 사용자 프로필 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>user_service_url</span><span class=si>}</span><span class=s2>/users/</span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Failed to get user profile: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_get_viewing_history</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;사용자 시청 기록 조회 (실제로는 별도 서비스)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 실제 구현에서는 별도의 Analytics Service 호출</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s1>&#39;video_id&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;genre&#39;</span><span class=p>:</span> <span class=s1>&#39;action&#39;</span><span class=p>,</span> <span class=s1>&#39;rating&#39;</span><span class=p>:</span> <span class=mf>4.5</span><span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s1>&#39;video_id&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;genre&#39;</span><span class=p>:</span> <span class=s1>&#39;comedy&#39;</span><span class=p>,</span> <span class=s1>&#39;rating&#39;</span><span class=p>:</span> <span class=mf>3.8</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_generate_recommendations</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_profile</span><span class=p>,</span> <span class=n>viewing_history</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;추천 알고리즘 실행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 간단한 추천 로직 (실제로는 ML 모델 사용)</span>
</span></span><span class=line><span class=cl>        <span class=n>recommendations</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 구독 등급에 따른 추천</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user_profile</span><span class=p>[</span><span class=s1>&#39;subscription_tier&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;premium&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>recommendations</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_get_premium_content</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 시청 기록 기반 추천</span>
</span></span><span class=line><span class=cl>        <span class=n>preferred_genres</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_extract_preferred_genres</span><span class=p>(</span><span class=n>viewing_history</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>genre_based_recommendations</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_content_by_genres</span><span class=p>(</span><span class=n>preferred_genres</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>recommendations</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>genre_based_recommendations</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_profile</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;recommendations&#39;</span><span class=p>:</span> <span class=n>recommendations</span><span class=p>[:</span><span class=mi>10</span><span class=p>],</span>  <span class=c1># 상위 10개</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;generated_at&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_get_premium_content</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;프리미엄 콘텐츠 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s1>&#39;video_id&#39;</span><span class=p>:</span> <span class=mi>101</span><span class=p>,</span> <span class=s1>&#39;title&#39;</span><span class=p>:</span> <span class=s1>&#39;Premium Movie 1&#39;</span><span class=p>,</span> <span class=s1>&#39;genre&#39;</span><span class=p>:</span> <span class=s1>&#39;drama&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s1>&#39;video_id&#39;</span><span class=p>:</span> <span class=mi>102</span><span class=p>,</span> <span class=s1>&#39;title&#39;</span><span class=p>:</span> <span class=s1>&#39;Premium Series 1&#39;</span><span class=p>,</span> <span class=s1>&#39;genre&#39;</span><span class=p>:</span> <span class=s1>&#39;thriller&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_extract_preferred_genres</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>viewing_history</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;시청 기록에서 선호 장르 추출&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>genre_scores</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>viewing_history</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>genre</span> <span class=o>=</span> <span class=n>item</span><span class=p>[</span><span class=s1>&#39;genre&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>rating</span> <span class=o>=</span> <span class=n>item</span><span class=p>[</span><span class=s1>&#39;rating&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>genre_scores</span><span class=p>[</span><span class=n>genre</span><span class=p>]</span> <span class=o>=</span> <span class=n>genre_scores</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>genre</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=n>rating</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 평점이 높은 장르 순으로 정렬</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>genre_scores</span><span class=o>.</span><span class=n>keys</span><span class=p>(),</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>genre_scores</span><span class=p>[</span><span class=n>x</span><span class=p>],</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_get_content_by_genres</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>genres</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;장르별 콘텐츠 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>content</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>genre</span> <span class=ow>in</span> <span class=n>genres</span><span class=p>[:</span><span class=mi>3</span><span class=p>]:</span>  <span class=c1># 상위 3개 장르</span>
</span></span><span class=line><span class=cl>            <span class=c1># 실제로는 Video Service API 호출</span>
</span></span><span class=line><span class=cl>            <span class=n>content</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s1>&#39;video_id&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>genre</span><span class=si>}</span><span class=s2>_1&#34;</span><span class=p>,</span> <span class=s1>&#39;title&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;Top </span><span class=si>{</span><span class=n>genre</span><span class=si>}</span><span class=s2> Movie&#34;</span><span class=p>,</span> <span class=s1>&#39;genre&#39;</span><span class=p>:</span> <span class=n>genre</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s1>&#39;video_id&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>genre</span><span class=si>}</span><span class=s2>_2&#34;</span><span class=p>,</span> <span class=s1>&#39;title&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;Popular </span><span class=si>{</span><span class=n>genre</span><span class=si>}</span><span class=s2> Series&#34;</span><span class=p>,</span> <span class=s1>&#39;genre&#39;</span><span class=p>:</span> <span class=n>genre</span><span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>content</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>recommendation_service</span> <span class=o>=</span> <span class=n>RecommendationService</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/recommendations/&lt;int:user_id&gt;&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_recommendations</span><span class=p>(</span><span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;사용자 맞춤 추천 엔드포인트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>recommendations</span> <span class=o>=</span> <span class=n>recommendation_service</span><span class=o>.</span><span class=n>get_recommendations</span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>recommendations</span><span class=p>),</span> <span class=mi>200</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error generating recommendations: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Internal server error&#39;</span><span class=p>}),</span> <span class=mi>500</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/health&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>health_check</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;서비스 헬스 체크 엔드포인트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;healthy&#39;</span><span class=p>,</span> <span class=s1>&#39;service&#39;</span><span class=p>:</span> <span class=s1>&#39;recommendation&#39;</span><span class=p>}),</span> <span class=mi>200</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>debug</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>5002</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1>  1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2>  2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3>  3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4>  4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5>  5</a>
</span><span class=lnt id=hl-25-6><a class=lnlinks href=#hl-25-6>  6</a>
</span><span class=lnt id=hl-25-7><a class=lnlinks href=#hl-25-7>  7</a>
</span><span class=lnt id=hl-25-8><a class=lnlinks href=#hl-25-8>  8</a>
</span><span class=lnt id=hl-25-9><a class=lnlinks href=#hl-25-9>  9</a>
</span><span class=lnt id=hl-25-10><a class=lnlinks href=#hl-25-10> 10</a>
</span><span class=lnt id=hl-25-11><a class=lnlinks href=#hl-25-11> 11</a>
</span><span class=lnt id=hl-25-12><a class=lnlinks href=#hl-25-12> 12</a>
</span><span class=lnt id=hl-25-13><a class=lnlinks href=#hl-25-13> 13</a>
</span><span class=lnt id=hl-25-14><a class=lnlinks href=#hl-25-14> 14</a>
</span><span class=lnt id=hl-25-15><a class=lnlinks href=#hl-25-15> 15</a>
</span><span class=lnt id=hl-25-16><a class=lnlinks href=#hl-25-16> 16</a>
</span><span class=lnt id=hl-25-17><a class=lnlinks href=#hl-25-17> 17</a>
</span><span class=lnt id=hl-25-18><a class=lnlinks href=#hl-25-18> 18</a>
</span><span class=lnt id=hl-25-19><a class=lnlinks href=#hl-25-19> 19</a>
</span><span class=lnt id=hl-25-20><a class=lnlinks href=#hl-25-20> 20</a>
</span><span class=lnt id=hl-25-21><a class=lnlinks href=#hl-25-21> 21</a>
</span><span class=lnt id=hl-25-22><a class=lnlinks href=#hl-25-22> 22</a>
</span><span class=lnt id=hl-25-23><a class=lnlinks href=#hl-25-23> 23</a>
</span><span class=lnt id=hl-25-24><a class=lnlinks href=#hl-25-24> 24</a>
</span><span class=lnt id=hl-25-25><a class=lnlinks href=#hl-25-25> 25</a>
</span><span class=lnt id=hl-25-26><a class=lnlinks href=#hl-25-26> 26</a>
</span><span class=lnt id=hl-25-27><a class=lnlinks href=#hl-25-27> 27</a>
</span><span class=lnt id=hl-25-28><a class=lnlinks href=#hl-25-28> 28</a>
</span><span class=lnt id=hl-25-29><a class=lnlinks href=#hl-25-29> 29</a>
</span><span class=lnt id=hl-25-30><a class=lnlinks href=#hl-25-30> 30</a>
</span><span class=lnt id=hl-25-31><a class=lnlinks href=#hl-25-31> 31</a>
</span><span class=lnt id=hl-25-32><a class=lnlinks href=#hl-25-32> 32</a>
</span><span class=lnt id=hl-25-33><a class=lnlinks href=#hl-25-33> 33</a>
</span><span class=lnt id=hl-25-34><a class=lnlinks href=#hl-25-34> 34</a>
</span><span class=lnt id=hl-25-35><a class=lnlinks href=#hl-25-35> 35</a>
</span><span class=lnt id=hl-25-36><a class=lnlinks href=#hl-25-36> 36</a>
</span><span class=lnt id=hl-25-37><a class=lnlinks href=#hl-25-37> 37</a>
</span><span class=lnt id=hl-25-38><a class=lnlinks href=#hl-25-38> 38</a>
</span><span class=lnt id=hl-25-39><a class=lnlinks href=#hl-25-39> 39</a>
</span><span class=lnt id=hl-25-40><a class=lnlinks href=#hl-25-40> 40</a>
</span><span class=lnt id=hl-25-41><a class=lnlinks href=#hl-25-41> 41</a>
</span><span class=lnt id=hl-25-42><a class=lnlinks href=#hl-25-42> 42</a>
</span><span class=lnt id=hl-25-43><a class=lnlinks href=#hl-25-43> 43</a>
</span><span class=lnt id=hl-25-44><a class=lnlinks href=#hl-25-44> 44</a>
</span><span class=lnt id=hl-25-45><a class=lnlinks href=#hl-25-45> 45</a>
</span><span class=lnt id=hl-25-46><a class=lnlinks href=#hl-25-46> 46</a>
</span><span class=lnt id=hl-25-47><a class=lnlinks href=#hl-25-47> 47</a>
</span><span class=lnt id=hl-25-48><a class=lnlinks href=#hl-25-48> 48</a>
</span><span class=lnt id=hl-25-49><a class=lnlinks href=#hl-25-49> 49</a>
</span><span class=lnt id=hl-25-50><a class=lnlinks href=#hl-25-50> 50</a>
</span><span class=lnt id=hl-25-51><a class=lnlinks href=#hl-25-51> 51</a>
</span><span class=lnt id=hl-25-52><a class=lnlinks href=#hl-25-52> 52</a>
</span><span class=lnt id=hl-25-53><a class=lnlinks href=#hl-25-53> 53</a>
</span><span class=lnt id=hl-25-54><a class=lnlinks href=#hl-25-54> 54</a>
</span><span class=lnt id=hl-25-55><a class=lnlinks href=#hl-25-55> 55</a>
</span><span class=lnt id=hl-25-56><a class=lnlinks href=#hl-25-56> 56</a>
</span><span class=lnt id=hl-25-57><a class=lnlinks href=#hl-25-57> 57</a>
</span><span class=lnt id=hl-25-58><a class=lnlinks href=#hl-25-58> 58</a>
</span><span class=lnt id=hl-25-59><a class=lnlinks href=#hl-25-59> 59</a>
</span><span class=lnt id=hl-25-60><a class=lnlinks href=#hl-25-60> 60</a>
</span><span class=lnt id=hl-25-61><a class=lnlinks href=#hl-25-61> 61</a>
</span><span class=lnt id=hl-25-62><a class=lnlinks href=#hl-25-62> 62</a>
</span><span class=lnt id=hl-25-63><a class=lnlinks href=#hl-25-63> 63</a>
</span><span class=lnt id=hl-25-64><a class=lnlinks href=#hl-25-64> 64</a>
</span><span class=lnt id=hl-25-65><a class=lnlinks href=#hl-25-65> 65</a>
</span><span class=lnt id=hl-25-66><a class=lnlinks href=#hl-25-66> 66</a>
</span><span class=lnt id=hl-25-67><a class=lnlinks href=#hl-25-67> 67</a>
</span><span class=lnt id=hl-25-68><a class=lnlinks href=#hl-25-68> 68</a>
</span><span class=lnt id=hl-25-69><a class=lnlinks href=#hl-25-69> 69</a>
</span><span class=lnt id=hl-25-70><a class=lnlinks href=#hl-25-70> 70</a>
</span><span class=lnt id=hl-25-71><a class=lnlinks href=#hl-25-71> 71</a>
</span><span class=lnt id=hl-25-72><a class=lnlinks href=#hl-25-72> 72</a>
</span><span class=lnt id=hl-25-73><a class=lnlinks href=#hl-25-73> 73</a>
</span><span class=lnt id=hl-25-74><a class=lnlinks href=#hl-25-74> 74</a>
</span><span class=lnt id=hl-25-75><a class=lnlinks href=#hl-25-75> 75</a>
</span><span class=lnt id=hl-25-76><a class=lnlinks href=#hl-25-76> 76</a>
</span><span class=lnt id=hl-25-77><a class=lnlinks href=#hl-25-77> 77</a>
</span><span class=lnt id=hl-25-78><a class=lnlinks href=#hl-25-78> 78</a>
</span><span class=lnt id=hl-25-79><a class=lnlinks href=#hl-25-79> 79</a>
</span><span class=lnt id=hl-25-80><a class=lnlinks href=#hl-25-80> 80</a>
</span><span class=lnt id=hl-25-81><a class=lnlinks href=#hl-25-81> 81</a>
</span><span class=lnt id=hl-25-82><a class=lnlinks href=#hl-25-82> 82</a>
</span><span class=lnt id=hl-25-83><a class=lnlinks href=#hl-25-83> 83</a>
</span><span class=lnt id=hl-25-84><a class=lnlinks href=#hl-25-84> 84</a>
</span><span class=lnt id=hl-25-85><a class=lnlinks href=#hl-25-85> 85</a>
</span><span class=lnt id=hl-25-86><a class=lnlinks href=#hl-25-86> 86</a>
</span><span class=lnt id=hl-25-87><a class=lnlinks href=#hl-25-87> 87</a>
</span><span class=lnt id=hl-25-88><a class=lnlinks href=#hl-25-88> 88</a>
</span><span class=lnt id=hl-25-89><a class=lnlinks href=#hl-25-89> 89</a>
</span><span class=lnt id=hl-25-90><a class=lnlinks href=#hl-25-90> 90</a>
</span><span class=lnt id=hl-25-91><a class=lnlinks href=#hl-25-91> 91</a>
</span><span class=lnt id=hl-25-92><a class=lnlinks href=#hl-25-92> 92</a>
</span><span class=lnt id=hl-25-93><a class=lnlinks href=#hl-25-93> 93</a>
</span><span class=lnt id=hl-25-94><a class=lnlinks href=#hl-25-94> 94</a>
</span><span class=lnt id=hl-25-95><a class=lnlinks href=#hl-25-95> 95</a>
</span><span class=lnt id=hl-25-96><a class=lnlinks href=#hl-25-96> 96</a>
</span><span class=lnt id=hl-25-97><a class=lnlinks href=#hl-25-97> 97</a>
</span><span class=lnt id=hl-25-98><a class=lnlinks href=#hl-25-98> 98</a>
</span><span class=lnt id=hl-25-99><a class=lnlinks href=#hl-25-99> 99</a>
</span><span class=lnt id=hl-25-100><a class=lnlinks href=#hl-25-100>100</a>
</span><span class=lnt id=hl-25-101><a class=lnlinks href=#hl-25-101>101</a>
</span><span class=lnt id=hl-25-102><a class=lnlinks href=#hl-25-102>102</a>
</span><span class=lnt id=hl-25-103><a class=lnlinks href=#hl-25-103>103</a>
</span><span class=lnt id=hl-25-104><a class=lnlinks href=#hl-25-104>104</a>
</span><span class=lnt id=hl-25-105><a class=lnlinks href=#hl-25-105>105</a>
</span><span class=lnt id=hl-25-106><a class=lnlinks href=#hl-25-106>106</a>
</span><span class=lnt id=hl-25-107><a class=lnlinks href=#hl-25-107>107</a>
</span><span class=lnt id=hl-25-108><a class=lnlinks href=#hl-25-108>108</a>
</span><span class=lnt id=hl-25-109><a class=lnlinks href=#hl-25-109>109</a>
</span><span class=lnt id=hl-25-110><a class=lnlinks href=#hl-25-110>110</a>
</span><span class=lnt id=hl-25-111><a class=lnlinks href=#hl-25-111>111</a>
</span><span class=lnt id=hl-25-112><a class=lnlinks href=#hl-25-112>112</a>
</span><span class=lnt id=hl-25-113><a class=lnlinks href=#hl-25-113>113</a>
</span><span class=lnt id=hl-25-114><a class=lnlinks href=#hl-25-114>114</a>
</span><span class=lnt id=hl-25-115><a class=lnlinks href=#hl-25-115>115</a>
</span><span class=lnt id=hl-25-116><a class=lnlinks href=#hl-25-116>116</a>
</span><span class=lnt id=hl-25-117><a class=lnlinks href=#hl-25-117>117</a>
</span><span class=lnt id=hl-25-118><a class=lnlinks href=#hl-25-118>118</a>
</span><span class=lnt id=hl-25-119><a class=lnlinks href=#hl-25-119>119</a>
</span><span class=lnt id=hl-25-120><a class=lnlinks href=#hl-25-120>120</a>
</span><span class=lnt id=hl-25-121><a class=lnlinks href=#hl-25-121>121</a>
</span><span class=lnt id=hl-25-122><a class=lnlinks href=#hl-25-122>122</a>
</span><span class=lnt id=hl-25-123><a class=lnlinks href=#hl-25-123>123</a>
</span><span class=lnt id=hl-25-124><a class=lnlinks href=#hl-25-124>124</a>
</span><span class=lnt id=hl-25-125><a class=lnlinks href=#hl-25-125>125</a>
</span><span class=lnt id=hl-25-126><a class=lnlinks href=#hl-25-126>126</a>
</span><span class=lnt id=hl-25-127><a class=lnlinks href=#hl-25-127>127</a>
</span><span class=lnt id=hl-25-128><a class=lnlinks href=#hl-25-128>128</a>
</span><span class=lnt id=hl-25-129><a class=lnlinks href=#hl-25-129>129</a>
</span><span class=lnt id=hl-25-130><a class=lnlinks href=#hl-25-130>130</a>
</span><span class=lnt id=hl-25-131><a class=lnlinks href=#hl-25-131>131</a>
</span><span class=lnt id=hl-25-132><a class=lnlinks href=#hl-25-132>132</a>
</span><span class=lnt id=hl-25-133><a class=lnlinks href=#hl-25-133>133</a>
</span><span class=lnt id=hl-25-134><a class=lnlinks href=#hl-25-134>134</a>
</span><span class=lnt id=hl-25-135><a class=lnlinks href=#hl-25-135>135</a>
</span><span class=lnt id=hl-25-136><a class=lnlinks href=#hl-25-136>136</a>
</span><span class=lnt id=hl-25-137><a class=lnlinks href=#hl-25-137>137</a>
</span><span class=lnt id=hl-25-138><a class=lnlinks href=#hl-25-138>138</a>
</span><span class=lnt id=hl-25-139><a class=lnlinks href=#hl-25-139>139</a>
</span><span class=lnt id=hl-25-140><a class=lnlinks href=#hl-25-140>140</a>
</span><span class=lnt id=hl-25-141><a class=lnlinks href=#hl-25-141>141</a>
</span><span class=lnt id=hl-25-142><a class=lnlinks href=#hl-25-142>142</a>
</span><span class=lnt id=hl-25-143><a class=lnlinks href=#hl-25-143>143</a>
</span><span class=lnt id=hl-25-144><a class=lnlinks href=#hl-25-144>144</a>
</span><span class=lnt id=hl-25-145><a class=lnlinks href=#hl-25-145>145</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># api_gateway.py - API 게이트웨이</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span><span class=p>,</span> <span class=n>redirect</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>jwt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>functools</span> <span class=kn>import</span> <span class=n>wraps</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;SECRET_KEY&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;your-secret-key&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 서비스 레지스트리 (실제로는 Consul, Eureka 등 사용)</span>
</span></span><span class=line><span class=cl><span class=n>SERVICE_REGISTRY</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;user-service&#39;</span><span class=p>:</span> <span class=s1>&#39;http://localhost:5001&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;recommendation-service&#39;</span><span class=p>:</span> <span class=s1>&#39;http://localhost:5002&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;video-service&#39;</span><span class=p>:</span> <span class=s1>&#39;http://localhost:5003&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>APIGateway</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;API Gateway의 핵심 기능 구현&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>request_count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>rate_limits</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># 사용자별 요청 제한</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>authenticate_request</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>token</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;JWT 토큰 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>payload</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;SECRET_KEY&#39;</span><span class=p>],</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;HS256&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>payload</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>ExpiredSignatureError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>InvalidTokenError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>check_rate_limit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>,</span> <span class=n>limit</span><span class=o>=</span><span class=mi>100</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;사용자별 API 요청 제한 확인&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>current_requests</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>rate_limits</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>current_requests</span> <span class=o>&gt;=</span> <span class=n>limit</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>rate_limits</span><span class=p>[</span><span class=n>user_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>current_requests</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>route_request</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>service_name</span><span class=p>,</span> <span class=n>path</span><span class=p>,</span> <span class=n>method</span><span class=o>=</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;요청을 적절한 마이크로서비스로 라우팅&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>service_url</span> <span class=o>=</span> <span class=n>SERVICE_REGISTRY</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>service_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>service_url</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Service not found&#39;</span><span class=p>},</span> <span class=mi>404</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>service_url</span><span class=si>}{</span><span class=n>path</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;GET&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;PUT&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;DELETE&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Method not allowed&#39;</span><span class=p>},</span> <span class=mi>405</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>(),</span> <span class=n>response</span><span class=o>.</span><span class=n>status_code</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Service call failed: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Service unavailable&#39;</span><span class=p>},</span> <span class=mi>503</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>gateway</span> <span class=o>=</span> <span class=n>APIGateway</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>require_auth</span><span class=p>(</span><span class=n>f</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;인증이 필요한 엔드포인트를 위한 데코레이터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nd>@wraps</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>decorated</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>token</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;Authorization&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>token</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Token missing&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Bearer 토큰 형식 확인</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>token</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;Bearer &#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>token</span> <span class=o>=</span> <span class=n>token</span><span class=p>[</span><span class=mi>7</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>user_id</span> <span class=o>=</span> <span class=n>gateway</span><span class=o>.</span><span class=n>authenticate_request</span><span class=p>(</span><span class=n>token</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>user_id</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Invalid token&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 요청 제한 확인</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>gateway</span><span class=o>.</span><span class=n>check_rate_limit</span><span class=p>(</span><span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Rate limit exceeded&#39;</span><span class=p>}),</span> <span class=mi>429</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 인증된 사용자 ID를 함수에 전달</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>decorated</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># API Gateway 라우팅 규칙</span>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/auth&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>auth</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;인증 요청을 User Service로 전달&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span><span class=p>,</span> <span class=n>status</span> <span class=o>=</span> <span class=n>gateway</span><span class=o>.</span><span class=n>route_request</span><span class=p>(</span><span class=s1>&#39;user-service&#39;</span><span class=p>,</span> <span class=s1>&#39;/auth&#39;</span><span class=p>,</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>result</span><span class=p>),</span> <span class=n>status</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/users/&lt;int:user_id&gt;&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nd>@require_auth</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_user</span><span class=p>(</span><span class=n>authenticated_user_id</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;사용자 프로필 조회 (인증 필요)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 본인 정보만 조회 가능하도록 권한 확인</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>authenticated_user_id</span> <span class=o>!=</span> <span class=n>user_id</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Access denied&#39;</span><span class=p>}),</span> <span class=mi>403</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>result</span><span class=p>,</span> <span class=n>status</span> <span class=o>=</span> <span class=n>gateway</span><span class=o>.</span><span class=n>route_request</span><span class=p>(</span><span class=s1>&#39;user-service&#39;</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;/users/</span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>result</span><span class=p>),</span> <span class=n>status</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/recommendations/&lt;int:user_id&gt;&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nd>@require_auth</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_recommendations</span><span class=p>(</span><span class=n>authenticated_user_id</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;추천 서비스 호출 (인증 필요)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>authenticated_user_id</span> <span class=o>!=</span> <span class=n>user_id</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Access denied&#39;</span><span class=p>}),</span> <span class=mi>403</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>result</span><span class=p>,</span> <span class=n>status</span> <span class=o>=</span> <span class=n>gateway</span><span class=o>.</span><span class=n>route_request</span><span class=p>(</span><span class=s1>&#39;recommendation-service&#39;</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;/recommendations/</span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>result</span><span class=p>),</span> <span class=n>status</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/health&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>health</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;API Gateway 헬스 체크&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;healthy&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;service&#39;</span><span class=p>:</span> <span class=s1>&#39;api-gateway&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;request_count&#39;</span><span class=p>:</span> <span class=n>gateway</span><span class=o>.</span><span class=n>request_count</span>
</span></span><span class=line><span class=cl>    <span class=p>}),</span> <span class=mi>200</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.errorhandler</span><span class=p>(</span><span class=mi>404</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>not_found</span><span class=p>(</span><span class=n>error</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;404 에러 핸들러&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Endpoint not found&#39;</span><span class=p>}),</span> <span class=mi>404</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.errorhandler</span><span class=p>(</span><span class=mi>500</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>internal_error</span><span class=p>(</span><span class=n>error</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;500 에러 핸들러&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Internal server error&#39;</span><span class=p>}),</span> <span class=mi>500</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>debug</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>8080</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>이 구현 예시는 마이크로서비스 아키텍처의 핵심 특징들을 보여준다:</p><ol><li><strong>서비스 독립성</strong>: 각 서비스가 독립적인 Flask 애플리케이션으로 구현</li><li><strong>API 기반 통신</strong>: REST API 를 통한 서비스 간 통신</li><li><strong>인증/인가</strong>: JWT 토큰 기반 보안 구현</li><li><strong>캐싱</strong>: Redis 를 활용한 성능 최적화</li><li><strong>에러 처리</strong>: 각 서비스별 독립적인 에러 처리</li><li><strong>모니터링</strong>: 헬스 체크 엔드포인트 제공</li></ol><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>항목</strong></th><th><strong>설명</strong></th><th><strong>권장사항</strong></th></tr></thead><tbody><tr><td><strong>1. 서비스 설계 전략</strong></td><td>서비스 경계 정의</td><td>잘못된 경계는 결합도 증가와 확장성 저하를 초래함</td><td>DDD 기반 도메인 분리, 이벤트 스토밍 활용</td></tr><tr><td></td><td>서비스 분할 전략</td><td>지나친 세분화는 운영 복잡도 증가</td><td>SRP 기반의 Bounded Context 설계</td></tr><tr><td></td><td>통신 패턴 설계</td><td>네트워크 지연, 오류 전파 등을 고려해 동기/비동기 혼합 설계 필요</td><td>REST + 메시지 큐 조합, 캐싱 도입</td></tr><tr><td></td><td>트랜잭션 경계 정의</td><td>분산 환경에서는 원자성 보장 어려움</td><td>Saga, 보상 트랜잭션, 이벤트 소싱 적용</td></tr><tr><td></td><td>API 설계 및 관리</td><td>계약 위반 방지 및 하위 호환성 유지 필요</td><td>OpenAPI, Semantic Versioning 적용</td></tr><tr><td><strong>2. 데이터 전략</strong></td><td>데이터베이스 분리</td><td>서비스 간 독립성과 배포 유연성 확보</td><td>Database per Service, Polyglot Persistence</td></tr><tr><td></td><td>데이터 일관성 관리</td><td>분산 환경에서는 eventual consistency 우선</td><td>CQRS, Event Sourcing 조합</td></tr><tr><td></td><td>데이터 성능 최적화</td><td>조회 성능 및 확장성 확보 필요</td><td>샤딩, 인덱싱, 캐싱 전략 병행</td></tr><tr><td><strong>3. 테스트 전략</strong></td><td>서비스 간 통합 테스트</td><td>서비스 독립성으로 인해 전통적 통합 테스트 어려움</td><td>Contract Testing, Mocking 활용</td></tr><tr><td></td><td>자동화된 품질 검증</td><td>릴리즈 주기 단축을 위한 테스트 자동화 필수</td><td>테스트 피라미드 구성, 정적 분석 도구 사용</td></tr><tr><td><strong>4. 배포 전략</strong></td><td>점진적 전환 전략</td><td>Big Bang 마이그레이션은 실패 확률 높음</td><td>Strangler Fig, 단계적 분리 도입</td></tr><tr><td></td><td>배포 자동화</td><td>수동 배포는 휴먼 에러 및 관리 복잡성 초래</td><td>GitOps, CI/CD, IaC 적용</td></tr><tr><td></td><td>릴리스 전략</td><td>다운타임 없는 무중단 배포 필요</td><td>Blue-Green, Canary, Rolling 배포</td></tr><tr><td><strong>5. 운영 전략</strong></td><td>모니터링 및 관찰성</td><td>분산 시스템은 문제 추적 및 성능 분석이 어려움</td><td>Prometheus, Grafana, Jaeger, OpenTelemetry</td></tr><tr><td></td><td>로깅 및 트레이싱</td><td>분산 환경에서는 요청 흐름 추적이 핵심</td><td>중앙 로그 수집 (ELK), Distributed Tracing 도입</td></tr><tr><td></td><td>장애 복원 및 자가 치유</td><td>장애 격리 및 복구 체계 없이는 전체 시스템 영향 가능</td><td>Circuit Breaker, Retry, Kubernetes HPA 설정</td></tr><tr><td><strong>6. 보안 전략</strong></td><td>서비스 간 인증 및 접근 제어</td><td>내부 통신이라도 강력한 인증 체계 필요</td><td>OAuth2, JWT, API Gateway 인증 적용</td></tr><tr><td></td><td>통신 보안</td><td>외부 및 내부 트래픽 보호</td><td>mTLS, 제로 트러스트 아키텍처 적용</td></tr><tr><td></td><td>비밀 관리 및 감사 추적</td><td>민감 정보 노출 방지 및 규제 대응</td><td>Vault, Secrets Manager, 감사 로그 보관</td></tr><tr><td><strong>7. 조직 및 문화</strong></td><td>조직 구조 정렬</td><td>조직 구조는 시스템 아키텍처에 직접 영향을 미침 (Conway&rsquo;s Law)</td><td>도메인 중심 크로스펑셔널 팀 구성</td></tr><tr><td></td><td>협업 및 문서화 문화</td><td>다수 팀 간 협업을 위한 명세 공유 및 표준화 필요</td><td>계약 기반 문서화 (OpenAPI), 문서 자동화 툴 활용</td></tr><tr><td></td><td>DevOps 문화 및 성숙도</td><td>자동화, 공유 책임 문화 없이는 마이크로서비스의 효과가 반감됨</td><td>CI/CD + 모니터링 + 학습 기반 단계적 고도화</td></tr></tbody></table><h3 id=최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>최적화 항목</strong></th><th><strong>설명</strong></th><th><strong>권장사항</strong></th></tr></thead><tbody><tr><td><strong>1. 성능 최적화</strong></td><td>서비스 간 통신 최적화</td><td>마이크로서비스 간 과도한 네트워크 호출로 인한 지연 최소화</td><td>gRPC/HTTP2, 비동기 메시징, 요청 배칭, 로컬 캐시, CDN, API 집계</td></tr><tr><td></td><td>데이터 접근 성능 향상</td><td>읽기/쓰기 분리 및 캐싱을 통한 응답 속도 개선</td><td>CQRS, Redis, 읽기 전용 복제본, LRU 캐시, 데이터 파티셔닝</td></tr><tr><td></td><td>로드 밸런싱</td><td>트래픽을 효율적으로 분산하여 특정 인스턴스 과부하 방지</td><td>라운드로빈, 가중치 기반 라우팅, 지리적 로드밸런싱, API Gateway 통합</td></tr><tr><td></td><td>코드 경량화 및 모듈화</td><td>서비스 내부 처리 로직의 단순화 및 응답 시간 최소화</td><td>단일 책임 원칙 (SRP), 고응집 구조, 유닛 테스트 기반 리팩토링</td></tr><tr><td><strong>2. 리소스 최적화</strong></td><td>컨테이너 리소스 관리</td><td>서비스별 리소스 낭비 방지 및 클러스터 자원 최적 활용</td><td>CPU/메모리 제한 설정, 프로파일링 기반 자원 할당, 수직/수평 확장</td></tr><tr><td></td><td>자동 확장성 확보</td><td>트래픽 증가에 대한 빠른 대응 및 안정적인 시스템 유지</td><td>HPA, VPA, 클라우드 Auto-scaling, 예측 기반 스케일링</td></tr><tr><td></td><td>피크 타임 용량 계획</td><td>고부하 시 성능 저하 방지 및 안정성 확보</td><td>Rate Limiting, 백프레셔, 메시지 버퍼링, Queue 기반 처리</td></tr><tr><td><strong>3. 데이터 최적화</strong></td><td>일관성 및 정합성 유지</td><td>마이크로서비스 간 데이터 불일치, 중복, 트랜잭션 오류 방지</td><td>Event Sourcing, SAGA 패턴, 보상 트랜잭션, 데이터 정규화</td></tr><tr><td></td><td>데이터 통신 최소화</td><td>데이터 공유 시 불필요한 전송 방지, 성능 및 보안 개선</td><td>필요 데이터만 전송, DTO 최적화, 데이터 변경 이벤트 기반 통신</td></tr><tr><td><strong>4. 배포 자동화</strong></td><td>무중단 배포 및 롤백 전략</td><td>안정적인 지속적 릴리즈 환경 구현</td><td>Blue-Green, Canary, Rolling 배포, Feature Flag</td></tr><tr><td></td><td>테스트 자동화</td><td>빠른 배포 주기에도 서비스 품질 보장</td><td>단위/통합/E2E 테스트, Mock/Stub 테스트, GitOps 기반 검증</td></tr><tr><td><strong>5. 관찰성 및 운영</strong></td><td>모니터링 및 장애 대응</td><td>장애 탐지와 성능 분석을 위한 메트릭 수집 및 시각화 시스템 구축</td><td>Prometheus, Grafana, ELK, 분산 트레이싱 (Jaeger/Zipkin), 구조화 로깅</td></tr><tr><td></td><td>서비스 수준 관리 (SLO/SLA)</td><td>서비스 안정성, 신뢰도 확보 위한 목표 지표 설정</td><td>SLI/SLO/SLA 정의, 에러 버짓 관리, 자동 알람 임계치 설정</td></tr><tr><td></td><td>정밀한 리소스 메트릭 수집</td><td>커널 레벨까지 상세한 성능 분석 가능</td><td>eBPF 기반 성능 분석 도구, CloudWatch, Datadog 등</td></tr><tr><td><strong>6. 보안 최적화</strong></td><td>인증·인가 및 권한 관리</td><td>서비스 간, 사용자 간 보안 요구사항 대응</td><td>OAuth2, JWT, API Gateway 인증 통합, RBAC</td></tr><tr><td></td><td>네트워크 보안</td><td>서비스 간 통신 시 기밀성 및 무결성 보장</td><td>mTLS, 서비스 메시 기반 암호화, 제로 트러스트 네트워크</td></tr><tr><td></td><td>런타임 보안 및 취약점 대응</td><td>배포된 서비스 환경에 대한 실시간 위협 탐지</td><td>이미지 서명, 보안 스캔, 네트워크 정책 적용, 런타임 위협 탐지</td></tr><tr><td><strong>7. 구조 및 설계</strong></td><td>서비스 경계 및 수명 최적화</td><td>지나치게 분리된 서비스로 인한 복잡도 및 유지보수 부담</td><td>도메인 중심 모델링 (DDD), 서비스 재통합 고려, Bounded Context 명확화</td></tr><tr><td></td><td>통신 구조 단순화</td><td>서비스 간 과도한 통신 의존성 제거, 장애 전파 최소화</td><td>이벤트 기반 아키텍처 적용, 데이터 로컬화, 캐싱 전략</td></tr><tr><td><strong>8. 문서화 및 협업</strong></td><td>명세 자동화 및 공유</td><td>팀 간 협업, API 소비자 대상 일관된 문서 제공</td><td>Swagger, OpenAPI, Wiki 기반 문서, 문서 린트 및 버전 관리</td></tr><tr><td><strong>9. 비용 최적화</strong></td><td>인프라 사용 및 비용 절감</td><td>오버엔지니어링 방지 및 클라우드 비용 절감</td><td>서비스 통합 검토, Spot 인스턴스 활용, Auto Shutdown, 비용 모니터링 도구 (예: CloudCost)</td></tr></tbody></table><ul><li><strong>성능</strong>: 트레이싱 기반 병목 분석 → 병렬 처리 및 비동기 구조 설계</li><li><strong>보안</strong>: 마이크로서비스 간 보안은 <strong>mTLS + API Gateway 인증 + 최소 권한</strong></li><li><strong>운영 자동화</strong>: CI/CD + GitOps + Auto Scaling + Chaos Test 조합</li><li><strong>비용</strong>: 리소스 할당량, 사용률, 클라우드 과금 기준을 실시간 모니터링하고 조정</li></ul><h3 id=주제와-관련하여-주목할-내용>주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#주제와-관련하여-주목할-내용>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>주제</strong></th><th><strong>핵심 항목</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>아키텍처 패턴</strong></td><td>마이크로서비스 아키텍처</td><td>독립 서비스, 바운디드 컨텍스트</td><td>각 서비스가 독립적으로 동작하며 도메인 단위로 나눔</td></tr><tr><td></td><td>이벤트 기반 아키텍처</td><td>이벤트 소싱, CQRS, Saga 패턴</td><td>상태 변경을 이벤트로 저장하고 명령/조회 분리 및 분산 트랜잭션 관리</td></tr><tr><td></td><td>서버리스 마이크로서비스</td><td>FaaS 기반 구성 (AWS Lambda 등)</td><td>이벤트 기반의 유연한 확장성과 비용 효율성 확보</td></tr><tr><td></td><td>MACH 아키텍처</td><td>Microservices, API-first, Cloud-native, Headless</td><td>프론트엔드까지 분리된 고유연성 아키텍처</td></tr><tr><td><strong>통신 및 통합</strong></td><td>API 및 메시지 통신 구조</td><td>REST, gRPC, GraphQL, 메시지 브로커</td><td>동기 및 비동기 혼합 통신 구조 설계</td></tr><tr><td></td><td>통신 인프라 구성</td><td>API Gateway, Service Mesh, Service Discovery</td><td>인증, 라우팅, 위치 탐색, 보안 자동화를 지원하는 통신 계층 구성</td></tr><tr><td><strong>데이터 관리 전략</strong></td><td>데이터 저장 전략</td><td>Database per Service, Polyglot Persistence</td><td>서비스별 DB 분리 및 적합한 기술 선택 (SQL/NoSQL 등)</td></tr><tr><td></td><td>일관성 및 처리 방식</td><td>Eventual Consistency, Sharding</td><td>최종 일관성과 확장성을 위한 설계</td></tr><tr><td><strong>배포 및 운영 전략</strong></td><td>배포 구조 및 전략</td><td>컨테이너화, Kubernetes, Canary/Blue-Green</td><td>무중단 배포 및 오케스트레이션 기반 자동화</td></tr><tr><td></td><td>운영 자동화 기술</td><td>GitOps, CI/CD, IaC</td><td>선언적 인프라 관리와 지속적 배포 자동화</td></tr><tr><td></td><td>운영 플랫폼화</td><td>플랫폼 엔지니어링</td><td>내부 개발자 플랫폼 구성 (도구 + 표준)</td></tr><tr><td><strong>모니터링 및 관찰성</strong></td><td>Observability</td><td>메트릭 (Prometheus), 로깅 (ELK), 트레이싱 (Jaeger)</td><td>복잡한 호출 흐름을 추적하고 시스템 가시성 확보</td></tr><tr><td></td><td>APM 및 통합 표준</td><td>Datadog, New Relic, OpenTelemetry</td><td>통합된 성능 모니터링 및 표준화된 추적 도구 사용</td></tr><tr><td></td><td>Chaos Engineering</td><td>장애 유도 실험으로 회복력 강화</td><td>카오스 실험을 통해 장애에 대한 회복력 테스트</td></tr><tr><td><strong>보안 아키텍처</strong></td><td>인증 및 인가</td><td>OAuth2.0, OIDC, JWT</td><td>토큰 기반 인증 및 역할 기반 접근 제어</td></tr><tr><td></td><td>통신 보안</td><td>Zero Trust, mTLS</td><td>모든 요청을 신뢰하지 않고 검증, 쌍방향 TLS 적용</td></tr><tr><td></td><td>비밀 및 권한 관리</td><td>Vault, Secrets Manager, RBAC</td><td>민감 정보 보안과 정책 기반 접근 제어 적용</td></tr><tr><td><strong>확장성과 복원력</strong></td><td>자동 확장</td><td>Kubernetes HPA</td><td>트래픽 증가 시 자동으로 서비스 인스턴스 확장</td></tr><tr><td></td><td>장애 대응 및 회복</td><td>Circuit Breaker, Retry, Fallback</td><td>연쇄 장애 방지를 위한 회복성 설계</td></tr><tr><td><strong>최신 기술 트렌드</strong></td><td>AI/ML 통합 운영</td><td>AIOps, MLOps</td><td>운영 자동화 및 ML 모델 배포 전략 도입</td></tr><tr><td></td><td>Edge & WebAssembly</td><td>엣지 컴퓨팅, 고성능 런타임</td><td>사용자 근처에서 실행 가능한 경량 아키텍처</td></tr><tr><td></td><td>GraphQL Federation</td><td>GraphQL 스키마 통합</td><td>다수의 서비스에서 하나의 API 처럼 GraphQL 제공</td></tr><tr><td></td><td>Data Mesh & Event Streaming</td><td>도메인 기반 데이터 소유, 실시간 데이터 처리</td><td>Kafka, Pulsar 기반 데이터 흐름 관리</td></tr><tr><td><strong>테스트 전략</strong></td><td>계약 기반 테스트</td><td>Pact, Spring Cloud Contract</td><td>마이크로서비스 간 API 계약 검증 및 자동화 테스트</td></tr><tr><td><strong>조직 운영 모델</strong></td><td>DevOps & SRE</td><td>자동화된 운영 및 신뢰성 엔지니어링</td><td>개발 - 운영 통합과 가용성 보장 중심의 운영 문화</td></tr></tbody></table><h3 id=반드시-학습해야할-내용>반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야할-내용>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>주제</strong></th><th><strong>핵심 항목</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>설계 원칙 및 이론</strong></td><td>마이크로서비스 아키텍처 원칙</td><td>독립성, 느슨한 결합, SRP, Bounded Context, Conway&rsquo;s Law</td><td>도메인 중심 설계 및 조직 구조 연계 전략</td></tr><tr><td></td><td>분산 시스템 이론</td><td>CAP 정리, BASE 모델, Vector Clock</td><td>분산 환경에서의 제약 조건 및 트레이드오프 이해</td></tr><tr><td></td><td>DDD (Domain-Driven Design)</td><td>Aggregate, Domain Event, Event Storming</td><td>도메인 모델링 및 마이크로서비스 단위 설계 기반</td></tr><tr><td><strong>통신 구조 및 프로토콜</strong></td><td>API 설계</td><td>RESTful API, GraphQL, gRPC</td><td>서비스 간 통신 및 효율적 인터페이스 설계</td></tr><tr><td></td><td>메시징 및 이벤트 기반 통신</td><td>Kafka, RabbitMQ, Pulsar, Redis Pub/Sub, AsyncAPI</td><td>비동기 이벤트 기반 아키텍처 설계</td></tr><tr><td></td><td>통신 인프라 구성</td><td>API Gateway, Service Mesh(Istio, Linkerd), Service Discovery</td><td>인증, 로깅, 라우팅, 위치 탐색 등 통신 관점 인프라</td></tr><tr><td><strong>데이터 관리 및 일관성</strong></td><td>데이터 저장 전략</td><td>Database per Service, Polyglot Persistence</td><td>마이크로서비스에 적합한 분리된 데이터베이스 전략</td></tr><tr><td></td><td>일관성/트랜잭션 처리</td><td>CQRS, Event Sourcing, SAGA 패턴</td><td>분산 트랜잭션 처리 및 상태 저장 전략</td></tr><tr><td><strong>배포 및 인프라 관리</strong></td><td>컨테이너화 및 오케스트레이션</td><td>Docker, Kubernetes, Helm</td><td>표준화된 배포 환경과 자동화</td></tr><tr><td></td><td>배포 자동화 및 GitOps</td><td>ArgoCD, GitLab CI/CD, Jenkins, GitHub Actions</td><td>지속적 통합과 자동화된 배포 파이프라인 구성</td></tr><tr><td></td><td>클라우드 네이티브 환경</td><td>AWS, Azure, GCP, Serverless (Lambda, Cloud Functions 등)</td><td>클라우드 인프라 및 서버리스 구조 이해</td></tr><tr><td><strong>보안 및 인증/인가</strong></td><td>서비스 보안 모델</td><td>Zero Trust, mTLS, RBAC, OAuth2.0, OIDC, JWT</td><td>서비스 간 인증 및 접근 제어 원칙</td></tr><tr><td></td><td>API 및 컨테이너 보안</td><td>API 보안, 컨테이너 이미지 스캐닝, Runtime Security</td><td>API 접근 보호 및 런타임 보안 강화</td></tr><tr><td></td><td>시크릿 관리</td><td>Vault, K8s Secrets, AWS Secrets Manager</td><td>민감 정보 안전 저장 및 주입 전략</td></tr><tr><td><strong>운영 및 관찰성</strong></td><td>모니터링 및 메트릭 수집</td><td>Prometheus, Grafana, ELK, Fluentd</td><td>시스템 성능 및 로그 관찰 구성</td></tr><tr><td></td><td>분산 추적 및 APM</td><td>Jaeger, Zipkin, OpenTelemetry, Datadog</td><td>전체 요청 흐름 및 병목 추적</td></tr><tr><td></td><td>회복성과 SRE</td><td>SLI/SLO/SLA, Circuit Breaker, Chaos Engineering, 에러 버짓</td><td>장애 대응 및 신뢰성 중심 운영 전략</td></tr><tr><td></td><td>커널 기반 관찰성</td><td>eBPF 기반 모니터링</td><td>저수준 네트워크/시스템 추적</td></tr><tr><td><strong>테스트 전략</strong></td><td>마이크로서비스 테스트 전략</td><td>Unit, Integration, E2E, Contract Testing (Pact, Spring Cloud 등)</td><td>서비스 간 계약 검증 및 회귀 방지</td></tr><tr><td></td><td>성능 테스트</td><td>JMeter, k6, Gatling</td><td>부하 테스트 및 응답 시간 측정</td></tr><tr><td><strong>조직 및 플랫폼 구조</strong></td><td>플랫폼 엔지니어링 (IDP)</td><td>Internal Dev Platform, Self-service Dev Tools</td><td>개발 생산성 향상 및 표준화된 개발 환경</td></tr><tr><td></td><td>조직 구조 및 협업 문화</td><td>팀 독립성, 문서화, DevOps/SRE 융합</td><td>Conway&rsquo;s Law 를 반영한 조직/서비스 정렬</td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th><strong>카테고리</strong></th><th><strong>용어</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>1. 아키텍처 스타일 및 설계 철학</strong></td><td></td><td></td></tr><tr><td></td><td>마이크로서비스 아키텍처 (Microservices Architecture)</td><td>독립적으로 배포 가능한 소형 서비스들로 구성된 아키텍처 스타일</td></tr><tr><td></td><td>모놀리식 아키텍처 (Monolithic Architecture)</td><td>하나의 배포 단위로 모든 기능이 통합된 전통적인 구조</td></tr><tr><td></td><td>서비스 지향 아키텍처 (SOA)</td><td>독립적인 서비스들의 집합으로 구성된 분산 시스템 아키텍처</td></tr><tr><td></td><td>도메인 주도 설계 (DDD)</td><td>비즈니스 도메인에 따라 모델링하고 서비스 경계를 정의하는 설계 방법론</td></tr><tr><td></td><td>바운디드 컨텍스트 (Bounded Context)</td><td>도메인 모델이 적용되는 명확한 논리적 구역</td></tr><tr><td></td><td>Event Storming</td><td>도메인 이벤트 중심의 비즈니스 프로세스 모델링 기법</td></tr><tr><td><strong>2. 통신 구조 및 프로토콜</strong></td><td></td><td></td></tr><tr><td></td><td>API Gateway</td><td>외부 요청을 받아 내부 서비스로 라우팅하는 진입점 컴포넌트</td></tr><tr><td></td><td>Service Mesh</td><td>서비스 간 통신, 보안, 트래픽 제어를 위한 인프라 계층 (예: Istio, Envoy)</td></tr><tr><td></td><td>Service Discovery</td><td>동적으로 서비스의 위치를 등록 및 검색하는 메커니즘</td></tr><tr><td></td><td>Message Broker</td><td>서비스 간 비동기 메시지 전달을 위한 미들웨어 (Kafka, RabbitMQ 등)</td></tr><tr><td></td><td>gRPC / REST / GraphQL</td><td>서비스 간 데이터 통신을 위한 프로토콜 및 API 설계 스타일</td></tr><tr><td></td><td>Synchronous / Asynchronous Communication</td><td>동기/비동기 통신 방식 구분</td></tr><tr><td></td><td>Load Balancer</td><td>다수 인스턴스 간 트래픽 분산을 수행하는 컴포넌트</td></tr><tr><td><strong>3. 아키텍처 패턴 및 트랜잭션 전략</strong></td><td></td><td></td></tr><tr><td></td><td>CQRS (Command Query Responsibility Segregation)</td><td>명령 (쓰기) 과 조회 (읽기) 의 책임을 분리하는 패턴</td></tr><tr><td></td><td>Event Sourcing</td><td>상태 변경을 이벤트 시퀀스로 기록하는 방식</td></tr><tr><td></td><td>Saga Pattern</td><td>분산 트랜잭션을 보상 트랜잭션으로 분할 처리하는 워크플로우 패턴</td></tr><tr><td></td><td>Circuit Breaker</td><td>실패 서비스 호출을 차단해 장애 전파를 방지하는 패턴</td></tr><tr><td></td><td>Sidecar Pattern</td><td>애플리케이션과 별도로 실행되는 보조 컴포넌트 패턴 (주로 서비스 메시에서 사용)</td></tr><tr><td></td><td>Service Decomposition</td><td>기능 단위로 애플리케이션을 분리하는 리팩토링 접근 방식</td></tr><tr><td><strong>4. 데이터 및 일관성 관리</strong></td><td></td><td></td></tr><tr><td></td><td>Database per Service</td><td>각 서비스가 자체 데이터베이스를 갖는 분리 전략</td></tr><tr><td></td><td>Eventual Consistency</td><td>시간이 지나며 최종적으로 데이터 일관성을 확보하는 모델</td></tr><tr><td></td><td>Sharding</td><td>데이터를 수평으로 분할해 확장성과 처리 성능 확보</td></tr><tr><td></td><td>Polyglot Persistence</td><td>서비스마다 적합한 DB 기술을 선택해 사용하는 전략</td></tr><tr><td><strong>5. 배포 및 운영 전략</strong></td><td></td><td></td></tr><tr><td></td><td>Container / Container Orchestration</td><td>컨테이너화 및 Kubernetes 기반의 배포/관리 자동화 기술</td></tr><tr><td></td><td>Blue-Green Deployment</td><td>두 환경을 번갈아 배포해 무중단 배포를 지원하는 방식</td></tr><tr><td></td><td>Canary Deployment</td><td>새로운 버전을 일부 트래픽에만 배포해 점진적으로 확산하는 방식</td></tr><tr><td></td><td>Health Check</td><td>애플리케이션 상태를 주기적으로 확인하는 메커니즘</td></tr><tr><td></td><td>CI/CD (Continuous Integration / Delivery)</td><td>지속적 통합 및 배포 자동화를 위한 파이프라인 구축 전략</td></tr><tr><td></td><td>Platform Engineering</td><td>내부 개발 플랫폼을 위한 도구, 템플릿, 자동화 구성 전략</td></tr><tr><td><strong>6. 보안 및 인증 모델</strong></td><td></td><td></td></tr><tr><td></td><td>Zero Trust Architecture</td><td>모든 접근 요청을 검증하고 기본적으로 신뢰하지 않는 보안 모델</td></tr><tr><td></td><td>mTLS (Mutual TLS)</td><td>클라이언트 - 서버 간 양방향 인증 및 암호화 통신 방식</td></tr><tr><td></td><td>JWT (JSON Web Token)</td><td>인증/인가 정보 전달을 위한 웹 토큰 형식</td></tr><tr><td></td><td>OAuth 2.0</td><td>인증과 인가를 위한 표준 프로토콜</td></tr><tr><td><strong>7. 관찰 가능성 및 모니터링</strong></td><td></td><td></td></tr><tr><td></td><td>Observability</td><td>시스템 상태를 외부에서 추론 가능하게 하는 능력 (Metrics, Logs, Traces 포함)</td></tr><tr><td></td><td>Distributed Tracing</td><td>분산 시스템에서 요청 흐름을 추적하는 기술 (예: Jaeger, Zipkin)</td></tr><tr><td></td><td>Metrics / APM</td><td>시스템 성능 지표 / 성능 모니터링 도구 (예: Prometheus, Grafana)</td></tr><tr><td></td><td>SLI / SLO / SLA</td><td>서비스 수준 지표, 목표, 계약으로 품질 및 신뢰성 관리</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://www.redhat.com/ko/topics/microservices/what-are-microservices>마이크로서비스 아키텍처 개념 – Red Hat</a></li><li><a href=https://aws.amazon.com/ko/microservices/>AWS 마이크로서비스 가이드</a></li><li><a href=https://learn.microsoft.com/ko-kr/azure/architecture/microservices/>Microsoft 마이크로서비스 아키텍처 설계</a></li><li><a href=https://about.netflix.com/ko/news/completing-the-netflix-cloud-migration>Netflix 클라우드 마이그레이션 완료 사례</a></li><li><a href=https://thebook.io/007035/>마이크로서비스 패턴 – 크리스 리처드슨</a></li><li><a href="https://cloud.google.com/learn/what-is-microservices-architecture?hl=ko">Google Cloud 마이크로서비스 아키텍처</a></li><li><a href=https://learn.microsoft.com/ko-kr/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/>DDD 및 마이크로서비스 패턴 – Microsoft Learn</a></li><li><a href=https://payproglobal.com/ko/%EB%8B%B5%EB%B3%80/%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98%EB%9E%80/>마이크로서비스 아키텍처란? 주요 개념 및 예제 – PayPro Global</a></li><li><a href=https://hahahoho5915.tistory.com/71>MSA란?(등장배경, 특징, 장단점) – 넌 잘하고 있어</a></li><li><a href=https://wikidocs.net/230938>1.2 MSA의 특징 – 위키독스</a></li><li><a href=https://mmp2022.tistory.com/entry/MicroservicePattern%EC%A0%95%EC%9D%98%ED%8A%B9%EC%A7%95%EC%84%A4%EB%AA%85%EA%B5%AC%ED%98%84%EB%B0%A9%EB%B2%95%EC%9E%A5%EC%A0%90%EA%B3%BC%EB%8B%A8%EC%A0%90>Microservice Pattern 정의, 특징, 설명, 구현 방법, 장점과 단점</a></li><li><a href=https://f-lab.kr/insight/understanding-microservices-architecture-20240517>마이크로서비스 아키텍처 이해하기 – F‑Lab</a></li><li><a href=https://microservices.io/patterns/microservices.html>Microservices Pattern: Microservice Architecture pattern</a></li><li><a href=https://microservices.io/post/architecture/2024/10/27/evolution-of-the-microservices-pattern-language-2024.html>The evolution of the Microservice Architecture pattern language</a></li><li><a href=https://www.openlegacy.com/blog/microservices-architecture-patterns/>OpenLegacy&rsquo;s Complete Guide to Microservices Design Patterns</a></li><li><a href=https://www.geeksforgeeks.org/microservices-design-patterns/>Microservices Design Patterns – GeeksforGeeks</a></li><li><a href=https://www.atlassian.com/microservices/cloud-computing/microservices-design-patterns>7 Essential Microservices Design Patterns | Atlassian</a></li><li><a href=https://www.turing.com/blog/enterprise-microservices-benefits-implementation-best-practices/>Enterprise Microservices: Benefits, Implementation, and Best Practices for 2024 | Turing</a></li><li><a href=https://blog.dreamfactory.com/microservices-examples>4 Microservices Examples: Amazon, Netflix, Uber, and Etsy</a></li><li><a href=https://www.techaheadcorp.com/blog/design-of-microservices-architecture-at-netflix/>Understanding design of microservices architecture at Netflix | TechAhead</a></li><li><a href=https://www.geeksforgeeks.org/system-design-netflix-a-complete-architecture/>System Design Netflix | A Complete Architecture – GeeksforGeeks</a></li><li><a href=https://www.f5.com/company/blog/nginx/microservices-at-netflix-architectural-best-practices>Adopting Microservices at Netflix: Lessons for Architectural Design</a></li><li><a href=https://developers.redhat.com/articles/2022/01/11/5-design-principles-microservices>Communication patterns: HTTP vs Messaging vs Hybrid</a></li><li><a href=https://en.wikipedia.org/wiki/Microservices#Saga_pattern>Saga 구조: Orchestration vs Choreography</a></li><li><a href=https://en.wikipedia.org/wiki/Service_mesh>Service mesh 개념</a></li><li><a href=https://en.wikipedia.org/wiki/Microservices>Microservices 시장 동향 및 기술 동향</a></li><li><a href=https://martinfowler.com/articles/microservices.html>Martin Fowler, “Microservice Prerequisites.”</a></li><li><a href=https://www.atlassian.com/microservices/microservices-architecture>Atlassian 설명 “Microservices architecture … independently deployable services”</a></li><li><a href=https://redis.io/blog/microservice-architecture-key-concepts/>Redis – Microservice Architecture Key Concepts</a></li><li><a href=https://sunscrapers.com/blog/microservices-architecture-guide/>Understanding Microservices: Architecture, Benefits, and Best Practices – TechAhead</a></li><li><a href=https://collabnix.com/10-microservices-design-principles-and-best-practices-for-developers/>10 Microservices Design Principles and Best Practices for Developers – Collabnix</a></li><li><a href=https://dev.to/sardarmudassaralikhan/challenges-associated-with-microservices-architecture-3o6n>Challenges associated with microservices architecture – Dev.to</a></li><li><a href=https://medium.com/capital-one-tech/10-microservices-best-practices-for-the-optimal-architecture-design-de16abf2a232>10 Microservices Best Practices for the Optimal Architecture Design – Capital One Tech</a></li><li><a href=https://thearchitectguild.com/2024/02/23/top-10-essential-considerations-for-microservice-architecture/>Top 10 Essential Considerations for Microservice Architecture – The Architect Guild</a></li><li><a href=https://www.grmdocumentmanagement.com/blog/microservices/>Visualizing Microservice Architecture – GRM Information Management</a></li><li><a href=https://www.techtarget.com/searchapparchitecture/feature/5-core-components-of-microservices-architecture>5 core components of microservices architecture – TechTarget</a></li><li><a href=https://vfunction.com/blog/microservices-architecture-guide/>Microservices architecture and design: A complete overview – vFunction</a></li></ul><hr></div><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Decompose by Business Capability vs Decompose by Subdomain</h2></header><div class=entry-content><p>Decompose by Business Capability vs. Decompose by Subdomain Decompose by Business Capability
정의: 비즈니스의 기능적 역량을 중심으로 시스템을 분해하는 방식으로, 조직의 주요 기능(예: 판매, 마케팅, 고객 서비스 등)에 따라 모듈을 나누는 방법. 특징: 비즈니스의 주요 역량을 중심으로 서비스나 모듈을 설계. 시스템의 경계가 기능적인 책임(Functional Responsibility)에 맞춰 설정됨. 기술적으로 독립적이고 명확한 책임 분리가 가능. 조직 구조와 자연스럽게 연계되므로 비즈니스와 IT의 연계성이 높아짐. 비즈니스의 장기적 확장성과 변화를 쉽게 수용할 수 있음. 예시: 주문 관리 시스템(Order Management System), 재고 관리 시스템(Inventory Management System) 등으로 분할. Decompose by Subdomain
...</p></div><footer class=entry-footer><span title='2024-11-13 01:13:00 +0000 UTC'>November 13, 2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Decompose by Business Capability vs Decompose by Subdomain" href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/distributed-architecture/microservices/service-decomposition/decompose-by-business-capability-vs-decompose-by-subdomain/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Self-contained Service</h2></header><div class=entry-content><p>Self-contained Service 마이크로서비스 아키텍처(MSA)에서 “self-contained service” 패턴은 서비스의 자율성과 독립성을 극대화하는 중요한 개념이다.
Self-contained Service는 단일 비즈니스 기능을 완전히 독립적으로 구현한 서비스를 의미한다.
이 서비스는 자체적으로 데이터를 저장하고, 비즈니스 로직을 처리하며, 사용자 인터페이스를 제공할 수 있다.
Self-contained Service 패턴은 MSA의 핵심 원칙을 구현하는 방법 중 하나로, 서비스의 자율성과 독립성을 극대화하여 시스템의 유연성과 확장성을 높이는 데 기여한다. 하지만 이 패턴을 적용할 때는 시스템의 복잡성 증가와 데이터 일관성 관리 등의 도전 과제를 고려해야 한다.
...</p></div><footer class=entry-footer><span title='2024-11-13 10:50:00 +0000 UTC'>November 13, 2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Self-contained Service" href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/distributed-architecture/microservices/service-decomposition/self-contained-service/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Service per team</h2></header><div class=entry-content><p>Service per Team Service per team 패턴은 각 마이크로서비스를 개별 팀이 소유하고 관리하는 방식이다.
이 패턴에서는 각 팀이 특정 비즈니스 기능을 담당하며, 해당 기능의 코드베이스를 소유한다.
Service per team 패턴은 팀의 자율성과 책임감을 높이는 동시에 마이크로서비스 아키텍처의 이점을 최대화할 수 있는 효과적인 접근 방식이다. 그러나 이 패턴을 성공적으로 구현하기 위해서는 조직 문화, 팀 구조, 그리고 기술적 인프라 등 여러 측면에서의 신중한 고려가 필요하다.
주요 특징 팀 자율성: 각 팀은 자신의 서비스를 독립적으로 개발, 테스트, 배포, 확장할 수 있다. API 중심 협업: 팀들은 주로 API를 통해 상호작용하며, 다른 팀과의 협업을 최소화한다. 소규모 팀: 일반적으로 “two-pizza team” 크기의 소규모 팀이 각 서비스를 담당한다. 인지 부하 감소: 팀원들이 전체 시스템이 아닌 특정 서비스에만 집중할 수 있어 인지 부하가 감소한다. 장점 팀 자율성 강화: 각 팀이 독립적으로 의사 결정을 내릴 수 있다. 느슨한 결합: 팀 간의 의존성이 줄어들어 더 유연한 개발이 가능하다. 코드 품질 향상: 장기적인 코드 소유권으로 인해 코드 품질이 개선된다. 빠른 개발 및 배포: 작은 팀이 독립적으로 개발하고 배포할 수 있어 시장 변화에 빠르게 대응할 수 있다. 단점 복잡한 프로젝트 조정: 여러 서비스에 걸친 복잡한 프로젝트의 경우 팀 간 조정이 어려워질 수 있다. 높은 WIP (Work in Progress): 각 팀이 항상 바쁘게 유지되어야 하므로 진행 중인 작업이 많아질 수 있다. 좁은 가치 흐름: 이상적인 구현에서는 팀들이 완전히 분리되어 있어, 조직 전체의 가치 흐름이 좁아질 수 있다. 최적화되지 않은 우선순위 지정: 팀의 가용성이 프로젝트 우선순위 결정의 주요 요인이 될 수 있다. 구현 시 고려사항 팀 구성: 각 서비스를 담당할 수 있는 cross-functional 팀을 구성해야 한다. 서비스 경계 정의: 비즈니스 기능과 하위 도메인을 기반으로 서비스 경계를 명확히 정의해야 한다. 팀 간 커뮤니케이션: API 설계와 변경에 대한 팀 간 효과적인 커뮤니케이션 채널을 구축해야 한다. 확장성 고려: 새로운 팀을 추가하거나 기존 서비스를 분할할 때의 전략을 미리 수립해야 한다. 예시: 대규모 전자상거래 플랫폼을 운영하는 기업을 예로 들어보자.
이 기업은 다음과 같은 주요 비즈니스 기능을 가지고 있다:
...</p></div><footer class=entry-footer><span title='2024-11-13 10:50:00 +0000 UTC'>November 13, 2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Service per team" href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/distributed-architecture/microservices/service-decomposition/service-per-team/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Decompose by Business Capability</h2></header><div class=entry-content><p>Decompose by Business Capability “Decompose by Business Capability” 패턴은 마이크로서비스 아키텍처(MSA)에서 중요한 분해 패턴이다.
이 패턴은 비즈니스 능력을 기반으로 애플리케이션을 마이크로서비스로 분해하는 방법을 제시한다.
이 패턴은 조직의 비즈니스 능력을 기반으로 마이크로서비스를 정의한다.
비즈니스 능력은 조직이 가치를 창출하기 위해 수행하는 특정 기능이나 프로세스를 의미한다.
주요 목적은 다음과 같다:
비즈니스 목표와 소프트웨어 개발의 정렬 독립적으로 개발 및 유지보수 가능한 서비스 생성 조직 구조와 시스템 아키텍처의 일치 이 패턴을 효과적으로 적용하려면 조직의 비즈니스 도메인에 대한 깊은 이해가 필요하며, 지속적인 비즈니스 분석과 서비스 경계의 조정이 필요하다.
...</p></div><footer class=entry-footer><span title='2024-11-13 01:20:00 +0000 UTC'>November 13, 2024</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Decompose by Business Capability" href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/distributed-architecture/microservices/service-decomposition/decompose-by-business-capability/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Decompose by Subdomain</h2></header><div class=entry-content><p>Decompose by Subdomain “Decompose by Subdomain” 패턴은 마이크로서비스 아키텍처(MSA)에서 중요한 분해 패턴 중 하나이다.
이 패턴은 도메인 주도 설계(DDD)의 개념을 기반으로 하며, 비즈니스 도메인을 여러 하위 도메인으로 나누어 마이크로서비스를 설계하는 방법이다.
이 패턴을 효과적으로 적용하려면 비즈니스 도메인에 대한 깊은 이해와 지속적인 분석이 필요하다. 또한, 하위 도메인 간의 상호작용을 고려하여 서비스 간 통신을 설계해야 한다.
주요 특징 비즈니스 중심 접근: 기술적 세부사항보다 비즈니스 기능에 초점을 맞춘다.
하위 도메인 분류:
핵심(Core): 비즈니스의 핵심 차별화 요소 지원(Supporting): 비즈니스 관련이지만 차별화 요소는 아님 일반(Generic): 비즈니스 특화되지 않은 일반적 기능 경계 설정: 각 하위 도메인은 명확한 경계(Bounded Context)를 가진다.
...</p></div><footer class=entry-footer><span title='2024-11-13 01:20:00 +0000 UTC'>November 13, 2024</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Decompose by Subdomain" href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/distributed-architecture/microservices/service-decomposition/decompose-by-subdomain/></a></article></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>