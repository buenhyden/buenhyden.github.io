<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Modular Monolithic | hyunyoun's Blog</title><meta name=keywords content="Software-Engineering,Design-and-Architecture,Architecture-Styles,Monolithic-Architecture,Modular-Monolithic"><meta name=description content="**모듈러 모놀리스(Modular Monolith)** 는 단일 배포 단위 내에서 도메인 기반으로 논리적으로 모듈을 분리하여 높은 응집도와 낮은 결합도를 유지하는 아키텍처이다. 마이크로서비스 도입 전 단계로서 유지보수성과 확장성이 우수하며, 점진적 MSA 전환이 용이하다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/monolithic-architecture/modular-monolithic/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/monolithic-architecture/modular-monolithic/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/monolithic-architecture/modular-monolithic/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/monolithic-architecture/modular-monolithic/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Modular Monolithic"><meta property="og:description" content="**모듈러 모놀리스(Modular Monolith)** 는 단일 배포 단위 내에서 도메인 기반으로 논리적으로 모듈을 분리하여 높은 응집도와 낮은 결합도를 유지하는 아키텍처이다. 마이크로서비스 도입 전 단계로서 유지보수성과 확장성이 우수하며, 점진적 MSA 전환이 용이하다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Modular Monolithic"><meta name=twitter:description content="**모듈러 모놀리스(Modular Monolith)** 는 단일 배포 단위 내에서 도메인 기반으로 논리적으로 모듈을 분리하여 높은 응집도와 낮은 결합도를 유지하는 아키텍처이다. 마이크로서비스 도입 전 단계로서 유지보수성과 확장성이 우수하며, 점진적 MSA 전환이 용이하다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HY's Blog","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":5,"name":"Modular Monolithic","item":"https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/monolithic-architecture/modular-monolithic/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>HY's Blog</a></div><h1>Modular Monolithic</h1><div class=post-description><strong>모듈러 모놀리스(Modular Monolith)</strong> 는 단일 배포 단위 내에서 도메인 기반으로 논리적으로 모듈을 분리하여 높은 응집도와 낮은 결합도를 유지하는 아키텍처이다. 마이크로서비스 도입 전 단계로서 유지보수성과 확장성이 우수하며, 점진적 MSA 전환이 용이하다.</div></header><div class=post-content><h2 id=modular-monolithic>Modular Monolithic<a hidden class=anchor aria-hidden=true href=#modular-monolithic>#</a></h2><p><strong>Modular Monolith Architecture</strong>는 단일 배포 단위 내에서 비즈니스 도메인 기반으로 명확히 분리된 모듈 구조를 갖는 설계 방식이다.<br>각 모듈은 높은 응집도와 낮은 결합도를 유지하며 독립적으로 개발·테스트되고, 명확한 인터페이스를 통해 통신한다. 초기에는 모놀리식의 단순함을 유지하면서도, 필요 시 마이크로서비스로의 전환을 고려한 진화 가능성과 확장성을 동시에 확보할 수 있어 &rsquo; 골디락스 아키텍처 &rsquo; 로도 불린다.</p><h3 id=등장-배경-및-발전-과정>등장 배경 및 발전 과정<a hidden class=anchor aria-hidden=true href=#등장-배경-및-발전-과정>#</a></h3><p><strong>Modular Monolith</strong>는 단순히 아키텍처 스타일이 아니라,<br><strong>지나친 분산과 복잡성에 대한 반작용이자, 실용성과 확장성을 동시에 추구하는 전략적 구조</strong>로 등장했다.</p><ul><li>복잡한 도메인을 갖는 단일 애플리케이션을 팀 규모와 복잡도에 맞춰 <strong>내부 모듈화</strong></li><li>분산 전환 전의 <strong>안정적 중간단계</strong>로 사용</li><li>잘 설계된 Modular Monolith 는 결국 " 전환 가능한 모놀리스 " 를 의미한다.</li></ul><h4 id=등장-배경>등장 배경<a hidden class=anchor aria-hidden=true href=#등장-배경>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>전통적 모놀리식 문제</strong></td><td>- 코드/도메인/기능이 뒤섞이며, 규모 확장 시 &ldquo;Big Ball of Mud&rdquo; 로 변질됨.<br>- 기능 추가 시 전체 영향 발생, 테스트·배포 범위 광범위</td></tr><tr><td><strong>마이크로서비스 한계</strong></td><td>- 초기 설계 부담, 서비스 분리 및 데이터 분산으로 인한 일관성/성능 문제.<br>- DevOps 성숙도 없으면 운영 복잡성 증가</td></tr><tr><td><strong>기술보단 조직 문제</strong></td><td>- 마이크로서비스 전환은 종종 팀 간 독립성 확보 (Conway&rsquo;s Law) 목적에서 비롯되며, 기술적 필요보다 조직적 동기에서 유래하는 경우 많음</td></tr></tbody></table><h4 id=하이브리드-모델로서-modular-monolith-의-등장>하이브리드 모델로서 Modular Monolith 의 등장<a hidden class=anchor aria-hidden=true href=#하이브리드-모델로서-modular-monolith-의-등장>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>전략적 절충안</strong></td><td>운영의 단순성과 개발의 모듈화를 동시에 충족하는 절충 모델로 등장</td></tr><tr><td><strong>기술적 기반</strong></td><td>DDD(Bounded Context) 기반의 내부 모듈 분리 → 계층, 경계, 책임 명확화</td></tr><tr><td><strong>Google & ThoughtWorks 동향</strong></td><td>Google 의 논문 (2023) 에서 마이크로서비스의 한계를 명시하고, 모듈러 모놀리스 트렌드를 강조함 (Service Weaver, &ldquo;Towards Modern Development of Cloud Applications&rdquo;)</td></tr><tr><td><strong>Eric Evans 의 DDD</strong></td><td>원래 모놀리스를 위한 설계였음. 이를 Modular Monolith 가 잘 계승</td></tr><tr><td><strong>Shopify, StackOverflow 사례</strong></td><td>MSA 전환 전 Modular Monolith 유지로 운영 안정성과 생산성 확보</td></tr></tbody></table><h4 id=발전-과정>발전 과정<a hidden class=anchor aria-hidden=true href=#발전-과정>#</a></h4><table><thead><tr><th>시기</th><th>주요 흐름</th></tr></thead><tbody><tr><td><strong>2010 년 이전</strong></td><td>전통적인 레이어드 모놀리스 → 비대화, 유지보수 문제</td></tr><tr><td><strong>2010~2015 년</strong></td><td>MSA 열풍 → Netflix, Amazon 기반 아키텍처 확산</td></tr><tr><td><strong>2015~2020 년</strong></td><td>운영 복잡성, Data Consistency 문제 대두 → MSA 회의론</td></tr><tr><td><strong>2020 년 이후</strong></td><td>Modular Monolith 재조명 → 실무 중심 대기업도 채택 (Uber Monorepo 유지, Google Service Weaver 도입 등)</td></tr></tbody></table><h3 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h3><p>Modular Monolith 는 단일 배포 구조의 단순함을 유지하면서, 내부적으로는 명확한 모듈 경계를 정의하여 유지보수성과 확장성을 동시에 확보할 수 있는 아키텍처 전략이다. 복잡한 비즈니스 요구, 다수의 협업 팀, 점진적 MSA 전환 필요성, 기술 부채 관리 등의 문제를 해결하기 위한 현실적이고 검증된 접근 방식이다.</p><h4 id=목적-goals>목적 (Goals)<a hidden class=anchor aria-hidden=true href=#목적-goals>#</a></h4><table><thead><tr><th>목적</th><th>설명</th></tr></thead><tbody><tr><td><strong>모듈성 확보와 단일 배포의 균형</strong></td><td>마이크로서비스 수준의 모듈성과 경계를 유지하면서도, 단일 프로세스/배포 단위로 운영의 단순함 유지</td></tr><tr><td><strong>복잡성 완화와 구조적 명확성 확보</strong></td><td>거대한 코드베이스를 도메인 또는 기능 단위로 나누어 시스템 이해도와 변경 용이성 향상</td></tr><tr><td><strong>협업 효율 향상</strong></td><td>모듈 단위로 팀을 구성하여 병렬 개발과 명확한 책임 분리가 가능하게 함</td></tr><tr><td><strong>점진적 MSA 이행 준비</strong></td><td>도메인 경계를 먼저 정의하고 테스트하여, 필요 시 해당 모듈을 서비스 단위로 추출 가능</td></tr><tr><td><strong>비용 효율성과 빠른 개발 사이의 균형</strong></td><td>고가용성 및 확장성 확보는 유지하면서, 마이크로서비스의 복잡도나 인프라 비용은 최소화</td></tr></tbody></table><h4 id=필요성-necessity>필요성 (Necessity)<a hidden class=anchor aria-hidden=true href=#필요성-necessity>#</a></h4><table><thead><tr><th>필요성 항목</th><th>상세 설명</th></tr></thead><tbody><tr><td><strong>복잡성 관리</strong></td><td>대규모 시스템을 도메인 모듈로 나누어 코드 변경 범위와 리스크를 최소화함</td></tr><tr><td><strong>운영 단순화</strong></td><td>단일 프로세스/컨테이너 배포로 운영 환경 구성 및 배포 파이프라인 복잡도 감소</td></tr><tr><td><strong>개발 확장성</strong></td><td>팀 간 병렬 개발이 가능해지며, 코드 충돌 및 병합 이슈 감소</td></tr><tr><td><strong>테스트 용이성</strong></td><td>모듈 단위의 테스트, 통합 테스트 전략 적용으로 품질 확보가 쉬움</td></tr><tr><td><strong>기술 부채 캡슐화</strong></td><td>모듈 경계에 따라 기술 부채를 격리하고 점진적으로 제거 가능</td></tr><tr><td><strong>경계 실험과 도메인 검증</strong></td><td>실제 MSA 로 이행 전 도메인 경계를 안전하게 실험하고 검증 가능</td></tr><tr><td><strong>확장성과 성능 유지</strong></td><td>In-process 통신 기반으로 네트워크 오버헤드 없이 수평 확장 기반 마련 가능</td></tr><tr><td><strong>실제 사례 검증</strong></td><td>Shopify, GitHub 등 글로벌 서비스들도 장기적으로 Modular Monolith 전략 유지 또는 채택</td></tr></tbody></table><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><p>Modular Monolith 는 단일 배포 구조의 장점을 유지하면서도, 내부적으로는 도메인 기반으로 모듈을 명확히 분리하여 높은 응집도와 낮은 결합도를 갖는 아키텍처 스타일이다. 각 모듈은 자체 계층 구조를 가지며, 명확한 경계와 책임을 가지고 내부 인터페이스 또는 이벤트를 통해 통신한다.<br><strong>Modular Monolith</strong>는 향후 마이크로서비스로 전환 가능한 구조적 유연성을 제공한다.</p><h4 id=modular-monolith-구조-핵심-요약>Modular Monolith 구조 핵심 요약<a hidden class=anchor aria-hidden=true href=#modular-monolith-구조-핵심-요약>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>단일 실행 단위</strong></td><td>모든 모듈은 하나의 배포 단위로 구성되며, 단일 프로세스 또는 컨테이너에서 실행</td></tr><tr><td><strong>도메인 중심 모듈화</strong></td><td>DDD 의 Bounded Context 기준으로 모듈을 분리하여 책임을 명확히 분산</td></tr><tr><td><strong>계층화된 모듈 내부 구조</strong></td><td>각 모듈은 내부적으로 <code>Domain</code>, <code>Application</code>, <code>Infrastructure</code>, <code>Interface</code> 계층 구조를 가짐</td></tr><tr><td><strong>모듈 간 느슨한 결합</strong></td><td>직접 호출을 피하고, 인터페이스/이벤트 기반의 통신을 통해 의존성 최소화</td></tr><tr><td><strong>높은 응집도 유지</strong></td><td>각 모듈은 하나의 책임에 집중하며 기능을 응집시킴</td></tr><tr><td><strong>내부 인터페이스 기반 통신</strong></td><td>Internal API, Service Interface, Domain Event 등으로 인터페이스화</td></tr><tr><td><strong>데이터 저장소 전략</strong></td><td>단일 DB 를 사용하되, 스키마 또는 테이블 소유권 기준으로 논리적 분리 수행</td></tr><tr><td><strong>운영 및 테스트 용이성</strong></td><td>모듈 단위 개발/테스트 가능, 코드 공유 간소화, CI/CD 파이프라인 단일화</td></tr><tr><td><strong>점진적 마이크로서비스 전환 가능</strong></td><td>도메인 단위로 분리된 구조 덕분에 MSA 로 전환 시 독립 서비스로 쉽게 이관 가능</td></tr></tbody></table><h4 id=아키텍처-레벨-구성도>아키텍처 레벨 구성도<a hidden class=anchor aria-hidden=true href=#아키텍처-레벨-구성도>#</a></h4><pre class=mermaid>flowchart TB
    subgraph Monolith App
      direction TB
      A1[회원 모듈] --&gt; A1D[Domain]
      A1 --&gt; A1A[Application]
      A1 --&gt; A1I[Infrastructure]
      A1 --&gt; A1IF[Interface/API]

      A2[결제 모듈] --&gt; A2D
      A2 --&gt; A2A
      A2 --&gt; A2I
      A2 --&gt; A2IF

      A3[상품 모듈] --&gt; A3D
      A3 --&gt; A3A
      A3 --&gt; A3I
      A3 --&gt; A3IF
    end

    click A1IF &#34;Internal API or Domain Event&#34;
    click A2IF &#34;Internal API or Domain Event&#34;
</pre><h4 id=실무-구현-전략>실무 구현 전략<a hidden class=anchor aria-hidden=true href=#실무-구현-전략>#</a></h4><table><thead><tr><th>전략 항목</th><th>적용 방안</th></tr></thead><tbody><tr><td><strong>도메인 중심 설계</strong></td><td>Event Storming → Bounded Context → 모듈 매핑</td></tr><tr><td><strong>모듈 간 통신 방식</strong></td><td>- 동기: 메서드 호출 or Internal API - 비동기: 이벤트 퍼블리싱, Outbox 기반</td></tr><tr><td><strong>데이터 관리 전략</strong></td><td>- 모듈별 논리적 DB 구분 (스키마 분리) - DB 접근 계층 제한 (Repository 통한 접근만 허용)</td></tr><tr><td><strong>의존성 관리</strong></td><td>DI 활용, Interface + Implementation 구조, 순환 의존 방지</td></tr><tr><td><strong>테스트 및 배포 전략</strong></td><td>- 모듈별 단위 테스트 + 통합 테스트 구성 - CI 파이프라인에서 모듈별 테스트 수행 - 단일 Docker 이미지 구성 유지</td></tr><tr><td><strong>확장 아키텍처 적용 가능</strong></td><td>CQRS, Event Sourcing, Outbox/Inbox, API Gateway 연계 등으로 확장 가능</td></tr></tbody></table><h4 id=연관-아키텍처-패턴-적용>연관 아키텍처 패턴 적용<a hidden class=anchor aria-hidden=true href=#연관-아키텍처-패턴-적용>#</a></h4><table><thead><tr><th>패턴</th><th>설명</th></tr></thead><tbody><tr><td><strong>CQRS</strong></td><td>Command/Query 분리로 책임 구분, 이벤트 기반 읽기 모델 구성</td></tr><tr><td><strong>Event Sourcing</strong></td><td>상태를 이벤트로 저장, 리플레이 기반 복원</td></tr><tr><td><strong>Outbox/Inbox</strong></td><td>트랜잭션과 함께 이벤트 기록 → 비동기 발행 보장</td></tr><tr><td><strong>Internal API + Event Bus</strong></td><td>모듈 간 동기·비동기 통신 혼용 가능 구조 제공</td></tr></tbody></table><h3 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h3><p>Modular Monolith 의 주요 기능은 도메인 기반 모듈 캡슐화, 명확한 인터페이스 설계, 느슨한 결합 구조를 통해 복잡성을 줄이고 유지보수를 용이하게 하는 데 있다. 각 모듈은 독립적인 데이터와 로직을 소유하며, 내부적으로는 함수 호출이나 이벤트 기반 통신을 통해 협력한다. 모든 모듈은 단일 프로세스로 배포되지만, 각기 독립적으로 테스트·확장·전환이 가능한 구조로 구성되어 있으며, 이는 향후 마이크로서비스로의 점진적 진화를 위한 기반이 된다.</p><table><thead><tr><th>기능 분류</th><th>기능 설명</th><th>역할 및 실무 적용</th></tr></thead><tbody><tr><td><strong>모듈 캡슐화</strong></td><td>각 모듈은 도메인 단위로 코드/로직/데이터를 자체 관리하며 외부에 내부 구현을 노출하지 않음</td><td>기능별 책임과 변경 범위 제한, 충돌 최소화</td></tr><tr><td><strong>명확한 인터페이스</strong></td><td>각 모듈은 공개된 API, 인터페이스 또는 이벤트를 통해서만 상호작용</td><td>인터페이스를 통한 테스트 가능, 계약 기반 통신</td></tr><tr><td><strong>느슨한 결합</strong></td><td>모듈 간 직접 참조를 줄이고, 인터페이스나 이벤트로만 연결</td><td>변경 시 파급효과 최소화, 향후 서비스 분리 용이</td></tr><tr><td><strong>도메인 경계 및 조직화</strong></td><td>DDD 기반 Bounded Context 로 모듈 정의, 공통 언어 기반 설계</td><td>팀 간 소유권 분리, 협업 명확화</td></tr><tr><td><strong>동기/비동기 통신 지원</strong></td><td>내부 메서드 호출 또는 이벤트 기반 비동기 통신 모두 지원</td><td>이벤트 기반 확장을 통해 마이크로서비스 전환 대비</td></tr><tr><td><strong>데이터 관리</strong></td><td>모듈별 논리적 DB 분리 또는 명시적 스키마 분리, 트랜잭션 경계 유지</td><td>데이터 격리, 접근 통제, 일관성 유지</td></tr><tr><td><strong>공통 인프라 제공</strong></td><td>인증, 로깅, 트레이싱, 설정 등 공유 서비스는 중앙화된 기반으로 제공</td><td>개발 표준화, 중복 방지, 유지보수 간소화</td></tr><tr><td><strong>운영 단순화</strong></td><td>모든 모듈은 단일 프로세스/컨테이너로 배포</td><td>DevOps 효율성, 테스트 및 릴리즈 간편</td></tr><tr><td><strong>테스트 가능성</strong></td><td>각 모듈 단위로 유닛/통합 테스트 가능, API/이벤트 기반 테스트 구성</td><td>품질 보장, CI 파이프라인 적용 용이</td></tr><tr><td><strong>진화 및 전환 기반</strong></td><td>아키텍처적으로 서비스 추출에 유리한 구조 제공</td><td>점진적 MSA 이행 전략 실현 가능</td></tr></tbody></table><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><p><strong>Modular Monolith</strong>는 다음과 같은 특징을 가진 아키텍처다:</p><ul><li><strong>구조적으로는 모듈화된 내부 계층 + 단일 배포 구조</strong></li><li><strong>개발적으로는 병렬 개발과 테스트 전략 최적화</strong></li><li><strong>운영적으로는 배포/모니터링/성능 측면에서 단순성과 효율성 제공</strong></li><li>또한, <strong>MSA 로의 점진적 전환을 고려한 설계 토대</strong>를 제공한다.</li></ul><h4 id=구조적-특징>구조적 특징<a hidden class=anchor aria-hidden=true href=#구조적-특징>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>단일 실행/배포 단위</strong></td><td>모든 모듈이 하나의 애플리케이션으로 빌드되어 단일 프로세스에서 실행됨</td></tr><tr><td><strong>모듈화된 아키텍처</strong></td><td>도메인 중심으로 모듈을 분리하며, 모듈 내 계층 구조 (<code>Domain</code>, <code>App</code>, <code>Infra</code>, <code>Interface</code>) 를 유지</td></tr><tr><td><strong>명확한 경계 유지</strong></td><td>네임스페이스 분리, 인터페이스 기반 접근, 캡슐화로 모듈 간 경계 명확화</td></tr><tr><td><strong>낮은 모듈 간 결합도</strong></td><td>인터페이스 (계약), DI, 이벤트 등을 활용한 간접 참조 방식 채택</td></tr></tbody></table><h4 id=개발-및-테스트-특징>개발 및 테스트 특징<a hidden class=anchor aria-hidden=true href=#개발-및-테스트-특징>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>통합 코드베이스</strong></td><td>모든 모듈이 하나의 코드 저장소 (Monorepo 또는 단일 Git Repo) 에 존재</td></tr><tr><td><strong>테스트 전략 분리 가능</strong></td><td>모듈 단위의 유닛 테스트, 경계 간 통합 테스트 적용 가능</td></tr><tr><td><strong>개발 병렬화 가능</strong></td><td>각 모듈은 독립 개발 가능하며, 기능/도메인 단위 병렬 작업에 적합</td></tr><tr><td><strong>재사용성과 일관성</strong></td><td>공통 유틸리티, 보일러플레이트, 표준화된 계층 구조 활용 가능</td></tr></tbody></table><h4 id=운영-및-배포-특징>운영 및 배포 특징<a hidden class=anchor aria-hidden=true href=#운영-및-배포-특징>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>배포 단순화</strong></td><td>단일 아티팩트로 배포되므로 CI/CD 가 단순화됨</td></tr><tr><td><strong>성능 효율성</strong></td><td>모듈 간 인 - 프로세스 호출로 네트워크 지연 없음 (MSA 대비 성능 우위)</td></tr><tr><td><strong>모니터링 통합</strong></td><td>로깅, 트레이싱, 메트릭을 애플리케이션 레벨에서 일관되게 관리 가능</td></tr><tr><td><strong>낮은 인프라 복잡도</strong></td><td>하나의 서비스로 운영되므로 인프라 구성/배포 수단 간소화</td></tr></tbody></table><h3 id=traditional-monolith-vs-modular-monolith-vs-msa-비교>Traditional Monolith vs. Modular Monolith vs. MSA 비교<a hidden class=anchor aria-hidden=true href=#traditional-monolith-vs-modular-monolith-vs-msa-비교>#</a></h3><p>Modular Monolith 는 전통적인 Monolith 의 단순함과 MSA 의 유연성 사이의 균형점이며, MSA 로의 진화적 전환을 위한 전략적 출발점이다. 각 아키텍처는 조직의 규모, 팀 구성, 운영 역량에 따라 선택과 전략이 달라져야 한다.</p><table><thead><tr><th>비교 항목</th><th>Traditional Monolith</th><th>Modular Monolith</th><th>Microservices Architecture (MSA)</th></tr></thead><tbody><tr><td><strong>배포 단위</strong></td><td>단일 애플리케이션</td><td>단일 애플리케이션</td><td>서비스별 개별 배포 (다수)</td></tr><tr><td><strong>실행 환경</strong></td><td>하나의 프로세스</td><td>하나의 프로세스</td><td>각 서비스가 독립된 프로세스로 실행</td></tr><tr><td><strong>모듈 경계</strong></td><td>불명확, 기술 기반 계층 중심</td><td>도메인 기반 명확한 경계 설정</td><td>서비스 단위로 완전한 논리적/물리적 분리</td></tr><tr><td><strong>통신 방식</strong></td><td>내부 함수 호출</td><td>내부 인터페이스 또는 이벤트 버스</td><td>REST, gRPC, 메시지 브로커 기반 통신</td></tr><tr><td><strong>데이터베이스 구조</strong></td><td>단일 DB 공유</td><td>단일 DB or 논리적 스키마 분리</td><td>서비스별 독립 DB, Polyglot Persistence 허용</td></tr><tr><td><strong>배포 복잡도</strong></td><td>매우 낮음</td><td>낮음~중간 (전체 빌드, 단일 배포)</td><td>높음 (CI/CD, 서비스 디스커버리 등 필요)</td></tr><tr><td><strong>초기 개발 효율성</strong></td><td>매우 높음</td><td>높음 (모듈화 관리 필요)</td><td>낮음 (설정, 인프라 구성 필요)</td></tr><tr><td><strong>유지보수성 및 확장성</strong></td><td>낮음 (규모 커질수록 복잡성 급증)</td><td>중간~높음 (모듈 단위 테스트/확장 가능)</td><td>매우 높음 (서비스 단위로 수평 확장 가능)</td></tr><tr><td><strong>테스트 전략</strong></td><td>통합 테스트 중심, 격리 어려움</td><td>모듈 단위 테스트 가능, 통합 테스트 용이</td><td>각 서비스 단위 격리 테스트, 계약 기반 통합 테스트</td></tr><tr><td><strong>조직 구조 대응</strong></td><td>기능 기반 팀 구성</td><td>도메인 또는 모듈 중심 팀 구성</td><td>서비스별 cross-functional 팀 구성 필요</td></tr><tr><td><strong>MSA 전환 용이성</strong></td><td>구조적 분리가 없어 매우 어려움</td><td>명확한 경계 기반으로 부분 전환 용이</td><td>해당 없음 (이미 MSA)</td></tr></tbody></table><h4 id=공통점>공통점<a hidden class=anchor aria-hidden=true href=#공통점>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>사용자 입장에서는</td><td>REST API 형태로 동작 (내부 구현과 관계 없이)</td></tr><tr><td>도메인 로직 존재</td><td>3 가지 모두 비즈니스 로직은 존재, 다만 위치와 경계 방식이 다름</td></tr><tr><td>유닛 테스트 가능</td><td>모두 단위 테스트 가능, 다만 격리 수준이 다름</td></tr><tr><td>확장 가능성 존재</td><td>기술적으로는 모두 확장 가능하지만 접근 방식이 다름</td></tr></tbody></table><h4 id=주요-차이점>주요 차이점<a hidden class=anchor aria-hidden=true href=#주요-차이점>#</a></h4><table><thead><tr><th>구분</th><th>핵심 차이</th></tr></thead><tbody><tr><td><strong>경계 관리</strong></td><td>Monolith 는 모듈 경계가 약함 / Modular 은 논리적 경계 / MSA 는 물리적 경계까지 존재</td></tr><tr><td><strong>배포 단위</strong></td><td>Monolith 는 전체 배포 / MSA 는 서비스별 독립 배포</td></tr><tr><td><strong>결합도</strong></td><td>Monolith 는 강결합 / Modular 은 느슨한 모듈간 결합 / MSA 는 완전 분산 결합</td></tr><tr><td><strong>기술 스택</strong></td><td>Monolith 는 단일 언어·런타임 기반 / MSA 는 서비스별 Polyglot 가능</td></tr><tr><td><strong>운영 부담</strong></td><td>Monolith 는 운영 단순 / MSA 는 모니터링, 트레이싱, 보안 등 운영이 복잡</td></tr></tbody></table><h4 id=전략적-요약>전략적 요약<a hidden class=anchor aria-hidden=true href=#전략적-요약>#</a></h4><table><thead><tr><th>아키텍처 스타일</th><th>장점</th><th>단점</th><th>이상적 사용 시점</th></tr></thead><tbody><tr><td><strong>Traditional Monolith</strong></td><td>단순한 개발과 배포</td><td>경계 불명확, 유지보수 어려움</td><td>초기 프로토타이핑, 작은 팀</td></tr><tr><td><strong>Modular Monolith</strong></td><td>MSA 전환 고려한 구조화, 유지보수 유리</td><td>초기 설계 복잡도 있음</td><td>점진적 성장, 도메인별 팀 운영 조직</td></tr><tr><td><strong>MSA</strong></td><td>완전한 분산, 독립 배포, 유연한 확장</td><td>높은 운영/설정 복잡도</td><td>대규모 조직, 고성능 확장 필요 시점</td></tr></tbody></table><h3 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h3><p>Modular Monolith 아키텍처는 명확한 경계 정의, 책임 분리, 의존성 통제, 인터페이스 중심 설계를 기반으로 높은 응집도와 낮은 결합도를 유지하는 것이 핵심이다. 각 모듈은 자신의 책임과 데이터를 소유하며 외부와는 명시적인 계약 (API 또는 이벤트) 으로만 통신하고, 확장성과 변경 용이성을 위해 설계 시 OCP, DIP, ISP 등 SOLID 원칙을 내재화해야 한다.</p><table><thead><tr><th>분류</th><th>핵심 원칙</th><th>설명 및 실무 적용 예시</th></tr></thead><tbody><tr><td><strong>책임 분리 (SRP)</strong></td><td>모듈은 하나의 도메인 기능만을 담당하며 내부 응집도를 유지</td><td><code>Order</code>, <code>Inventory</code> 모듈이 독립된 책임 소유</td></tr><tr><td><strong>경계 명확성 (Boundary Clarity)</strong></td><td>DDD 의 Bounded Context 기준으로 모듈 경계를 설정하고 외부 접근 차단</td><td>다른 모듈의 클래스/데이터 직접 참조 금지</td></tr><tr><td><strong>의존성 역전 (Dependency Inversion)</strong></td><td>하위 계층의 구체 구현이 상위 계층에 영향을 주지 않도록 인터페이스 기반 추상화 적용</td><td><code>OrderService</code> 가 <code>PaymentPort</code> 에 의존, 실제 구현은 <code>infrastructure</code> 모듈에서</td></tr><tr><td><strong>개방 - 폐쇄 원칙 (OCP)</strong></td><td>기존 코드 변경 없이 기능 확장이 가능하도록 인터페이스 기반 설계</td><td>새로운 결제 수단 추가 시 기존 모듈 수정 없이 확장 가능</td></tr><tr><td><strong>데이터 격리 (Data Ownership)</strong></td><td>각 모듈은 자신의 데이터를 소유하고 직접 관리하며 외부 모듈의 데이터에 접근하지 않음</td><td><code>Order</code> 모듈만이 <code>Order</code> 테이블을 직접 읽고 쓸 수 있음</td></tr><tr><td><strong>공통 기능 모듈화 (Shared Concerns Isolation)</strong></td><td>인증, 로깅, 메시징 등은 별도의 공통 모듈로 분리하고 재사용</td><td><code>logging-module</code>, <code>auth-module</code> 등 재사용 가능한 패키지 제공</td></tr><tr><td><strong>인터페이스 분리 (ISP)</strong></td><td>필요한 인터페이스만 제공하고, 과도한 의존을 방지</td><td><code>PaymentCommand</code> 와 <code>PaymentQuery</code> 인터페이스를 분리해서 제공</td></tr><tr><td><strong>단방향 의존성 (Unidirectional Dependency)</strong></td><td>계층 간 또는 모듈 간 의존성은 단방향으로만 흐르며 순환 참조 금지</td><td><code>Application → Domain → Infrastructure</code> 방향만 허용</td></tr></tbody></table><pre class=mermaid>graph TD
  SRP[&#34;① 책임 분리&#34;]
  Bounded[&#34;② 경계 명확성&#34;]
  DIP[&#34;③ 의존성 역전&#34;]
  OCP[&#34;④ 확장/폐쇄 원칙&#34;]
  Data[&#34;⑤ 데이터 격리&#34;]
  Cross[&#34;⑥ 공통 기능 모듈화&#34;]
  ISP[&#34;⑦ 인터페이스 분리&#34;]
  Flow[&#34;⑧ 단방향 의존&#34;]

  SRP --&gt; DIP
  Bounded --&gt; Data
  DIP --&gt; ISP
  Cross --&gt; OCP
  OCP --&gt; Flow
</pre><h4 id=modular-monolith-핵심-원칙-위반-시-발생하는-주요-안티패턴>Modular Monolith 핵심 원칙 위반 시 발생하는 주요 안티패턴<a hidden class=anchor aria-hidden=true href=#modular-monolith-핵심-원칙-위반-시-발생하는-주요-안티패턴>#</a></h4><table><thead><tr><th>위반 원칙</th><th>발생 안티패턴</th><th>설명</th></tr></thead><tbody><tr><td>단일 책임 원칙 (SRP)</td><td><strong>God Module / Blob</strong></td><td>하나의 모듈이 너무 많은 책임을 가짐</td></tr><tr><td>경계 명확성 위반</td><td><strong>Data Bleeding</strong></td><td>다른 모듈의 내부 데이터에 무단 접근</td></tr><tr><td>의존성 역전 위반 (DIP)</td><td><strong>Concrete Dependency Trap</strong></td><td>추상화 없이 직접 구현체에 의존</td></tr><tr><td>인터페이스 분리 원칙 위반 (ISP)</td><td><strong>Fat Interface</strong></td><td>불필요한 인터페이스까지 의존</td></tr><tr><td>데이터 격리 위반</td><td><strong>Shared Database / Schema Coupling</strong></td><td>여러 모듈이 동일한 테이블/스키마를 공유</td></tr><tr><td>단방향 의존성 위반</td><td><strong>Circular Dependency</strong></td><td>순환 참조가 발생해 의존성 방향이 붕괴</td></tr><tr><td>공통 모듈 오남용</td><td><strong>Core Overload / Utility Abuse</strong></td><td>공통 모듈이 도메인 로직까지 침범</td></tr><tr><td>확장 - 폐쇄 원칙 위반 (OCP)</td><td><strong>Scattered Conditional Logic</strong></td><td>기능 추가 시 코드 곳곳에 조건문 확산</td></tr></tbody></table><h5 id=대표-안티패턴-상세-분석>대표 안티패턴 상세 분석<a hidden class=anchor aria-hidden=true href=#대표-안티패턴-상세-분석>#</a></h5><table><thead><tr><th>항목</th><th>핵심 요약</th></tr></thead><tbody><tr><td><strong>God Module</strong></td><td>단일 책임 원칙 위반으로 하나의 모듈이 모든 것을 담당</td></tr><tr><td><strong>Data Bleeding</strong></td><td>모듈 경계를 무시하고 내부 구현에 직접 접근</td></tr><tr><td><strong>Concrete Dependency Trap</strong></td><td>추상화 없이 직접 구현체 의존으로 변경 전파 발생</td></tr><tr><td><strong>Shared DB Coupling</strong></td><td>DB 스키마 공유로 변경 시 전체 영향</td></tr><tr><td><strong>Circular Dependency</strong></td><td>구조 순환으로 아키텍처 안정성 붕괴</td></tr><tr><td><strong>Utility Abuse</strong></td><td>공통 모듈이 도메인 로직까지 흡수해 중심이 무너짐</td></tr></tbody></table><h6 id=god-module-blob>God Module (Blob)<a hidden class=anchor aria-hidden=true href=#god-module-blob>#</a></h6><ul><li><strong>원칙 위반</strong>: 단일 책임 원칙 (SRP), 책임 분리 실패</li><li><strong>원인</strong>: 모든 도메인 기능을 한 파일/클래스/모듈이 담당</li><li><strong>결과</strong>:<ul><li>변경 파급력 극대화</li><li>테스트 불가능</li><li>신규 개발 시 타 기능까지 변경 위험</li></ul></li><li><strong>해결 전략</strong>:<ul><li>DDD 기반 Bounded Context 로 분리</li><li>Use Case 별로 Service 클래스를 나누기</li><li>모듈별 책임 분산</li></ul></li></ul><h6 id=data-bleeding>Data Bleeding<a hidden class=anchor aria-hidden=true href=#data-bleeding>#</a></h6><ul><li><strong>원칙 위반</strong>: 경계 명확성, 데이터 격리 원칙 위반</li><li><strong>원인</strong>: <code>order_module</code> 이 <code>user_module</code> 의 내부 엔티티 직접 조회</li><li><strong>결과</strong>:<ul><li>경계 침범으로 변경 파급</li><li>의존성 정리 어려움</li><li>테스트 불가능</li></ul></li><li><strong>해결 전략</strong>:<ul><li>공개된 API or Event 만 통해 접근</li><li>Anti-Corruption Layer 적용</li><li>DTO/Facade 구조 도입</li></ul></li></ul><h6 id=concrete-dependency-trap>Concrete Dependency Trap<a hidden class=anchor aria-hidden=true href=#concrete-dependency-trap>#</a></h6><ul><li><strong>원칙 위반</strong>: DIP 위반 (인터페이스 아닌 구현체 직접 의존)</li><li><strong>원인</strong>: <code>OrderService</code> 가 <code>JpaOrderRepository</code> 에 직접 의존</li><li><strong>결과</strong>:<ul><li>테스트 시 대체 불가</li><li>변경 시 ripple effect</li></ul></li><li><strong>해결 전략</strong>:<ul><li><code>OrderRepository</code> 인터페이스 도입</li><li>의존성 주입 (DI) 기반 연결</li><li>Mocking 용이성 확보</li></ul></li></ul><h6 id=shared-database--schema-coupling>Shared Database / Schema Coupling<a hidden class=anchor aria-hidden=true href=#shared-database--schema-coupling>#</a></h6><ul><li><strong>원칙 위반</strong>: 데이터 격리 실패</li><li><strong>원인</strong>: 모든 모듈이 <code>users</code>, <code>orders</code> 등 테이블을 직접 쿼리</li><li><strong>결과</strong>:<ul><li>스키마 변경 시 전체 모듈 재배포</li><li>데이터 소유권 불분명</li></ul></li><li><strong>해결 전략</strong>:<ul><li>논리적 스키마 분리 (<code>schema per module</code>)</li><li>Repository 계층 외 접근 금지</li><li>Outbox/DTO 기반 데이터 복제</li></ul></li></ul><h6 id=circular-dependency>Circular Dependency<a hidden class=anchor aria-hidden=true href=#circular-dependency>#</a></h6><ul><li><strong>원칙 위반</strong>: 단방향 의존 원칙 위반</li><li><strong>원인</strong>: <code>Order → Inventory → Payment → Order</code> 의존 순환</li><li><strong>결과</strong>:<ul><li>컴파일/빌드 실패</li><li>이해 불가능한 구조</li><li>계층이 무너짐</li></ul></li><li><strong>해결 전략</strong>:<ul><li>인터페이스 역전 (DIP 적용)</li><li>Application Service 로 의존성 경계 이동</li><li>Dependency Rule 테스트 적용 (ArchUnit 등)</li></ul></li></ul><h6 id=core-overload--utility-abuse>Core Overload / Utility Abuse<a hidden class=anchor aria-hidden=true href=#core-overload--utility-abuse>#</a></h6><ul><li><strong>원칙 위반</strong>: 공통 기능 모듈 오남용</li><li><strong>원인</strong>: 모든 도메인의 로직이 <code>core</code>, <code>utils</code>, <code>common</code> 디렉토리에 집중</li><li><strong>결과</strong>:<ul><li>공통 모듈이 실질적 도메인 기능을 포함</li><li>분리도 불가능한 구조</li></ul></li><li><strong>해결 전략</strong>:<ul><li>공통 모듈은 진짜 " 재사용성 " 중심 기능만 포함 (e.g. 공통 DTO, 인증, 로깅 등)</li><li>도메인 로직은 도메인 안에만 존재하도록 유지</li></ul></li></ul><h3 id=주요-원리-core-principles>주요 원리 (Core Principles)<a hidden class=anchor aria-hidden=true href=#주요-원리-core-principles>#</a></h3><table><thead><tr><th>원리</th><th>설명</th></tr></thead><tbody><tr><td><strong>도메인 기반 모듈화</strong></td><td>비즈니스 도메인별로 모듈을 구분하여 응집도 향상 및 변경 파급 최소화</td></tr><tr><td><strong>인터페이스 기반 통신</strong></td><td>모듈 간 상호작용은 명시적으로 정의된 인터페이스 또는 API 를 통해 수행</td></tr><tr><td><strong>단방향 의존성</strong></td><td>상위 → 하위 모듈만 참조하도록 설계 (의존성 역전 원칙 포함)</td></tr><tr><td><strong>모듈 캡슐화</strong></td><td>모듈 내부 구현은 외부에 노출되지 않도록 캡슐화, 공개 API 만 사용 허용</td></tr><tr><td><strong>이벤트 기반 통신</strong></td><td>도메인 이벤트를 통해 비동기 메시징 적용 가능 (Internal Event)</td></tr><tr><td><strong>데이터 격리</strong></td><td>각 모듈은 전용 스키마 또는 테이블을 가지며, 외부 모듈 데이터에 직접 접근 금지</td></tr><tr><td><strong>공통 기능 분리</strong></td><td>인증, 로깅, 모니터링 등은 Cross-cutting 모듈로 구성하여 재사용 가능성 확보</td></tr><tr><td><strong>단일 배포 단위 유지</strong></td><td>시스템 전체가 하나의 배포 단위로 관리되어 CI/CD 단순화</td></tr></tbody></table><h3 id=작동-원리-operational-mechanisms>작동 원리 (Operational Mechanisms)<a hidden class=anchor aria-hidden=true href=#작동-원리-operational-mechanisms>#</a></h3><h4 id=요청-흐름>요청 흐름<a hidden class=anchor aria-hidden=true href=#요청-흐름>#</a></h4><pre class=mermaid>sequenceDiagram
  participant Client
  participant API Gateway
  participant Module A
  participant Module B
  participant DB

  Client-&gt;&gt;API Gateway: HTTP 요청
  API Gateway-&gt;&gt;Module A: 요청 라우팅
  Module A-&gt;&gt;Module A: 비즈니스 로직 실행
  Module A-&gt;&gt;Module B: API 호출 또는 인터페이스 기반 호출
  Module B-&gt;&gt;DB: 데이터 처리
  DB--&gt;&gt;Module B: 응답
  Module B--&gt;&gt;Module A: 결과 반환
  Module A--&gt;&gt;API Gateway: 응답 반환
  API Gateway--&gt;&gt;Client: HTTP 응답
</pre><h4 id=모듈-간-통신-방식>모듈 간 통신 방식<a hidden class=anchor aria-hidden=true href=#모듈-간-통신-방식>#</a></h4><table><thead><tr><th>방식</th><th>설명</th><th>사용 목적</th></tr></thead><tbody><tr><td><strong>함수 호출 / API 호출</strong></td><td>모듈 간 직접 호출 (공개 API 또는 인터페이스)</td><td>동기적 처리 필요 시</td></tr><tr><td><strong>도메인 이벤트</strong></td><td>모듈 간 비동기 이벤트 전달</td><td>결합도 감소, 확장성 향상</td></tr><tr><td><strong>Outbox 패턴</strong></td><td>내부 트랜잭션에서 외부 이벤트 메시지를 신뢰성 있게 전송</td><td>외부 시스템 연계 대비</td></tr><tr><td><strong>공유 커널 (Shared Kernel)</strong></td><td>공통된 도메인 모델/계약 정의</td><td>메시지 스키마 또는 인터페이스 공유 시</td></tr></tbody></table><h5 id=계층-간-메시징-구조-vs-함수-호출-비교>계층 간 메시징 구조 vs. 함수 호출 비교<a hidden class=anchor aria-hidden=true href=#계층-간-메시징-구조-vs-함수-호출-비교>#</a></h5><p>계층 간 통신은 <strong>함수 호출</strong> 또는 <strong>이벤트/메시징</strong> 방식으로 이루어질 수 있다.</p><table><thead><tr><th>항목</th><th>함수 호출 (Synchronous Call)</th><th>메시징 구조 (Asynchronous Messaging)</th></tr></thead><tbody><tr><td><strong>통신 방식</strong></td><td>직접 호출 (<code>service.method()</code>)</td><td>이벤트 발행 후 구독자 처리</td></tr><tr><td><strong>결합도</strong></td><td>높음 (타 모듈의 명세에 의존)</td><td>낮음 (이벤트 계약만 공유)</td></tr><tr><td><strong>응답 보장</strong></td><td>즉시 반환됨 (Blocking)</td><td>결과 비동기적, 실패 시 재시도 필요</td></tr><tr><td><strong>에러 처리</strong></td><td>예외로 명확히 처리 가능</td><td>에러 전파 어려움, DLQ 등 필요</td></tr><tr><td><strong>성능</strong></td><td>빠름, 디버깅 용이</td><td>느림, 로그 기반 추적 필요</td></tr><tr><td><strong>적용 위치</strong></td><td>Presentation ↔ ApplicationApplication ↔ Domain</td><td>Domain → ApplicationApplication → 외부 연동 Cross-cutting concerns (e.g., Logging, Audit)</td></tr><tr><td><strong>예시</strong></td><td><code>orderService.placeOrder()</code></td><td><code>eventPublisher.publish(OrderPlacedEvent)</code></td></tr></tbody></table><h4 id=outbox-패턴과-이벤트-흐름>Outbox 패턴과 이벤트 흐름<a hidden class=anchor aria-hidden=true href=#outbox-패턴과-이벤트-흐름>#</a></h4><pre class=mermaid>sequenceDiagram
  participant Module A
  participant Outbox Table
  participant Message Dispatcher
  participant Message Broker
  participant Module B

  Module A-&gt;&gt;Outbox Table: 트랜잭션 내 메시지 기록
  Message Dispatcher-&gt;&gt;Outbox Table: 새 메시지 폴링
  Message Dispatcher-&gt;&gt;Message Broker: 메시지 발행
  Message Broker-&gt;&gt;Module B: 메시지 전달
  Module B-&gt;&gt;Module B: 이벤트 핸들링
</pre><ul><li>이 구조는 내부 트랜잭션과 외부 메시징 시스템을 분리하여 <strong>Atomicity + Eventually Consistent</strong> 구조 보장</li></ul><h4 id=주요-원리와-매핑되는-작동-구조>주요 원리와 매핑되는 작동 구조<a hidden class=anchor aria-hidden=true href=#주요-원리와-매핑되는-작동-구조>#</a></h4><table><thead><tr><th>원리</th><th>대응 구조</th></tr></thead><tbody><tr><td>모듈 캡슐화</td><td>Interface 패키지 ↔ Implementation 패키지 분리, public only 접근</td></tr><tr><td>단방향 의존성</td><td>아키텍처 테스트 도구로 순환 참조 방지 검증</td></tr><tr><td>이벤트 기반 통신</td><td>EventBus / Kafka / RabbitMQ 와 통합</td></tr><tr><td>데이터 격리</td><td>모듈 전용 DB 스키마 또는 테이블 사용</td></tr><tr><td>공통 기능 분리</td><td><code>common</code>, <code>shared</code>, <code>core</code> 모듈로 추상화</td></tr></tbody></table><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><p><strong>Modular Monolith 아키텍처의 구조 및 구성 요소</strong>는 다음과 같은 특징을 갖는다:</p><ul><li><strong>필수 요소</strong>는 Host, 모듈, 계층 구조, 인터페이스, 공통 인프라로 구성</li><li><strong>선택 요소</strong>는 이벤트 기반 통신, CQRS, Outbox, API Gateway 등으로 유연한 확장 가능</li><li><strong>모듈 내부는 계층화</strong>(Interface → App → Domain → Infra) 구조를 따라 구성</li><li><strong>실무적으로는 마이크로서비스 전환을 고려한 설계 전략 기반</strong>으로 점진적 분리 및 독립화 가능</li></ul><pre class=mermaid>flowchart TD
  subgraph Modular Monolith Application
    A[Host App] --&gt; B[User Module]
    A --&gt; C[Order Module]
    A --&gt; D[Payment Module]
    B --&gt; B_API[Public API] --&gt; B_APP[Application Layer] --&gt; B_DOMAIN[Domain Layer] --&gt; B_INFRA[Infrastructure]
    C --&gt; C_API --&gt; C_APP --&gt; C_DOMAIN --&gt; C_INFRA
    D --&gt; D_API --&gt; D_APP --&gt; D_DOMAIN --&gt; D_INFRA
    B_DOMAIN --&gt; Shared[Shared Kernel]
    C_DOMAIN --&gt; Shared
    D_DOMAIN --&gt; Shared
  end

  subgraph Optional Components
    EventBus -.-&gt; B_APP
    EventBus -.-&gt; C_APP
    EventBus -.-&gt; D_APP
  end
</pre><hr><h4 id=계층별-구성-요소-분류>계층별 구성 요소 분류<a hidden class=anchor aria-hidden=true href=#계층별-구성-요소-분류>#</a></h4><h5 id=필수-구성-요소>필수 구성 요소<a hidden class=anchor aria-hidden=true href=#필수-구성-요소>#</a></h5><table><thead><tr><th>구성 요소</th><th>설명</th></tr></thead><tbody><tr><td><strong>Host Application</strong></td><td>DI 컨테이너, 모듈 로딩, 전체 앱 실행 관리</td></tr><tr><td><strong>도메인 기반 모듈</strong></td><td>각 비즈니스 도메인별로 완결된 기능 집합 (회원, 주문 등)</td></tr><tr><td><strong>모듈 인터페이스 (Public API)</strong></td><td>외부 또는 다른 모듈이 접근 가능한 서비스/이벤트 계약 정의</td></tr><tr><td>** 공통 인프라 (Shared Kernel)**</td><td>로깅, 인증, 보안, 유틸리티 등 공통 컴포넌트 집합</td></tr><tr><td>** 단일 데이터베이스 또는 모듈별 테이블 스키마**</td><td>물리적 공유 가능, 논리적 소유권 기준 설계 필요</td></tr><tr><td>** 모듈 내부 계층 구조**</td><td><code>Interface → Application → Domain → Infrastructure</code> 계층 구분 유지</td></tr></tbody></table><h5 id=선택-구성-요소>선택 구성 요소<a hidden class=anchor aria-hidden=true href=#선택-구성-요소>#</a></h5><table><thead><tr><th>구성 요소</th><th>설명</th></tr></thead><tbody><tr><td><strong>이벤트 버스 (In-memory / Kafka)</strong></td><td>모듈 간 비동기 메시징 및 느슨한 결합</td></tr><tr><td><strong>Outbox / Inbox 패턴</strong></td><td>이벤트 일관성, 재처리 보장을 위한 패턴 적용</td></tr><tr><td><strong>CQRS / Event Sourcing</strong></td><td>읽기 - 쓰기 분리 및 상태 추적 목적 설계</td></tr><tr><td><strong>API Gateway (Monolith 내부)</strong></td><td>인증·라우팅·버전 관리 등을 중앙 집중화할 경우 사용</td></tr><tr><td><strong>모듈별 UI / 테스트 디렉토리</strong></td><td>모듈별 독립된 View, Mock 기반 테스트 가능</td></tr></tbody></table><h4 id=모듈-내부-계층-구조>모듈 내부 계층 구조<a hidden class=anchor aria-hidden=true href=#모듈-내부-계층-구조>#</a></h4><table><thead><tr><th>계층</th><th>책임</th><th>설명</th></tr></thead><tbody><tr><td><strong>Interface Layer</strong></td><td>진입점, API/이벤트 인터페이스</td><td>HTTP 컨트롤러, gRPC 핸들러, 메시지 리스너 등</td></tr><tr><td><strong>Application Layer</strong></td><td>유스케이스, 서비스</td><td>도메인 로직 조합, 트랜잭션 관리, Command/Query</td></tr><tr><td><strong>Domain Layer</strong></td><td>비즈니스 규칙, 엔티티, 밸류 오브젝트</td><td>불변 규칙, 도메인 이벤트, 애그리거트 루트 등</td></tr><tr><td><strong>Infrastructure Layer</strong></td><td>외부 자원 접근</td><td>DB, 메시지 브로커, 외부 API 연동 구현체</td></tr><tr><td><strong>Integration Events</strong></td><td>외부 전달용 이벤트</td><td>Kafka 또는 내부 EventBus 에 전달되는 직렬화된 이벤트</td></tr></tbody></table><h4 id=설계-시-고려사항>설계 시 고려사항<a hidden class=anchor aria-hidden=true href=#설계-시-고려사항>#</a></h4><table><thead><tr><th>측면</th><th>고려 사항</th></tr></thead><tbody><tr><td><strong>모듈 경계 관리</strong></td><td>Bounded Context 기준으로 모듈을 자율성과 응집도를 기준으로 분리</td></tr><tr><td><strong>공개 API 관리</strong></td><td>인터페이스 명시적 선언 + 안정적 버전 관리 (예: API 버전, 메시지 버전)</td></tr><tr><td><strong>데이터 설계</strong></td><td>모듈별 데이터 소유권 명확화 (동일 DB 라도 테이블 네임스페이스 분리 권장)</td></tr><tr><td><strong>테스트 전략</strong></td><td>모듈별 유닛 테스트, 도메인 단위 통합 테스트, Contract Test 고려</td></tr><tr><td><strong>MSA 전환성</strong></td><td>모듈 단위 이벤트 발행 및 Consumer 구성 → 마이크로서비스 분리 시 활용</td></tr></tbody></table><h3 id=구현-기법-및-방법>구현 기법 및 방법<a hidden class=anchor aria-hidden=true href=#구현-기법-및-방법>#</a></h3><p><strong>Modular Monolith 의 구현 기법 및 방법</strong>은 단순한 코드 구성의 문제가 아니라, 다음의 총체적인 접근을 요구한다:</p><ul><li><strong>구조화 전략</strong>: DDD, 계층 분리, 수직 슬라이스 등 아키텍처 정렬</li><li><strong>통신 전략</strong>: 이벤트 기반, Outbox, CQRS 등의 느슨한 결합 처리</li><li><strong>운영 전략</strong>: 모듈 단위 테스트, Strangler Fig 패턴 통한 점진적 도입</li><li><strong>기술 기반</strong>: 언어/프레임워크별 빌드/의존성 도구를 통한 코드베이스 관리</li></ul><h4 id=아키텍처-스타일-및-구조화-전략>아키텍처 스타일 및 구조화 전략<a hidden class=anchor aria-hidden=true href=#아키텍처-스타일-및-구조화-전략>#</a></h4><table><thead><tr><th>구현 기법</th><th>설명</th><th>목적</th></tr></thead><tbody><tr><td><strong>DDD (Domain-Driven Design)</strong></td><td>도메인 경계를 기준으로 모듈 분리</td><td>경계 명확화, 도메인 응집도 확보</td></tr><tr><td><strong>Clean Architecture</strong></td><td>Interface → App → Domain → Infra</td><td>관심사 분리, 테스트 용이성 확보</td></tr><tr><td><strong>Hexagonal Architecture</strong></td><td>포트 - 어댑터 구조, 외부 의존성과 내부 도메인 분리</td><td>도메인 보호, 유연한 외부 연동</td></tr><tr><td><strong>Vertical Slice Architecture</strong></td><td>기능 단위로 UI~DB 까지 수직 분리</td><td>단일 책임 기능, 배포 및 유지 관리 최적화</td></tr></tbody></table><h4 id=모듈-간-통신-전략>모듈 간 통신 전략<a hidden class=anchor aria-hidden=true href=#모듈-간-통신-전략>#</a></h4><p><strong>모듈 간 통신 전략</strong>은 시스템 아키텍처 설계 단계에서 모듈 간 상호작용을 어떻게 설계할지에 대한 <strong>전략적 방향성과 결정</strong>을 의미한다.<br>이는 " 동기 vs 비동기 &ldquo;, " 직접 호출 vs 메시징 &ldquo;, " 상태 저장 방식 " 등 <strong>전체 시스템의 통신 흐름</strong>과 아키텍처의 구조적 특징을 정의하는 상위 개념이다.<br>예를 들어, 이벤트 기반 아키텍처를 채택하거나, Outbox 패턴을 통한 비동기 이벤트 전송을 사용하는 것은 모두 통신 전략에 해당한다.</p><p>반면, <strong>모듈 간 통신 방식 패턴</strong>은 이러한 전략을 구체적으로 실현하기 위한 <strong>설계 및 구현 수준의 기술적 패턴</strong>이다.<br>즉, 어떤 통신 전략을 선택했는지에 따라 그에 적합한 패턴을 적용하게 되며, 이는 코드 레벨에서 실제 모듈 간 연결을 구현하는 방식이다.<br>예를 들어 <code>Domain Event</code>, <code>Application Messaging</code>, <code>Command Handler</code>, <code>Interface-based 호출</code> 등은 모두 각기 다른 전략을 실현하기 위한 구체적인 패턴이다.</p><p>결국, <strong>통신 전략은 " 무엇을 할 것인가?&rdquo; 에 대한 방향 설정</strong>이며, <strong>통신 방식 패턴은 " 어떻게 구현할 것인가?&rdquo; 에 대한 방법론</strong>이다.</p><table><thead><tr><th>구현 기법</th><th>설명</th><th>활용 목적</th></tr></thead><tbody><tr><td><strong>동기 호출</strong></td><td>모듈 간 직접 인터페이스 호출</td><td>단순하고 빠른 처리</td></tr><tr><td><strong>비동기 이벤트 기반</strong></td><td>Kafka, In-memory EventBus 활용</td><td>느슨한 결합, 확장성 확보</td></tr><tr><td><strong>Outbox Pattern</strong></td><td>트랜잭션 내 이벤트 저장 후 별도 전송</td><td>메시지 유실 방지, 일관성 보장</td></tr><tr><td><strong>CQRS</strong></td><td>명령/쿼리 분리</td><td>성능 최적화, 복잡성 분리</td></tr><tr><td><strong>Event Sourcing</strong></td><td>이벤트 로그 기반 상태 관리</td><td>감사 추적, 리플레이 기능 확보</td></tr></tbody></table><h5 id=전략--패턴-관계-분석>전략 → 패턴 관계 분석<a hidden class=anchor aria-hidden=true href=#전략--패턴-관계-분석>#</a></h5><p><strong>모듈 간 통신 전략</strong>은 아키텍처 설계 단계에서 " 어떤 방식의 통신 구조를 채택할지 " 에 대한 <strong>전략적 결정</strong>을 의미한다.<br><strong>모듈 간 통신 방식 패턴</strong>은 그러한 전략을 실현하기 위한 <strong>구체적인 구현 기법 또는 설계 패턴</strong>이다. 따라서, <strong>패턴은 전략의 하위 개념</strong>으로 분류되며, 전략이 결정되면 이에 맞는 하나 이상의 패턴을 적용할 수 있다.<br>예를 들어, <code>비동기 이벤트 기반</code> 전략은 <code>Domain Event</code>, <code>Application Messaging</code>, <code>Outbox Pattern</code> 등의 패턴으로 구현된다.</p><table><thead><tr><th>통신 전략</th><th>설명</th><th>추천 구현 패턴/기법</th><th>주요 기술 스택 예시</th></tr></thead><tbody><tr><td><strong>동기 호출</strong></td><td>인터페이스 기반 직접 호출</td><td>Interface-based Communication<br>Shared Kernel</td><td>Java Interface, Python Class, REST</td></tr><tr><td><strong>비동기 이벤트 기반</strong></td><td>이벤트 발행 후 구독 방식 (Loose Coupling)</td><td>Domain Event Pattern<br>Application Messaging</td><td>Kafka, RabbitMQ, In-memory Bus</td></tr><tr><td><strong>Outbox Pattern</strong></td><td>DB 트랜잭션 + 메시지 전송 분리</td><td>Transactional Outbox<br>Polling Publisher</td><td>Debezium, Kafka Connect, Redis</td></tr><tr><td><strong>CQRS</strong></td><td>명령 (Command)/조회 (Query) 책임 분리</td><td>Command Handler Pattern<br>Query Model</td><td>MediatR, Axon, FastAPI CommandBus</td></tr><tr><td><strong>Event Sourcing</strong></td><td>상태 변경을 이벤트 로그로 기록</td><td>Aggregate Root + Event Replay Pattern</td><td>EventStoreDB, Axon, custom infra</td></tr></tbody></table><h5 id=모듈-간-통신-방식-패턴>모듈 간 통신 방식 패턴<a hidden class=anchor aria-hidden=true href=#모듈-간-통신-방식-패턴>#</a></h5><table><thead><tr><th>통신 전략</th><th>추천 구현 패턴/기법</th><th>핵심 특징</th><th>장점</th><th>한계/주의사항</th><th>실무 적용 조건</th></tr></thead><tbody><tr><td><strong>동기 호출</strong></td><td><code>Interface-based Communication</code></td><td>모듈 간 직접 함수/메서드 호출</td><td>단순, 직관적, 디버깅 쉬움</td><td>강결합, 변경 전파 위험</td><td>변경 가능성 낮고 성능 요구되는 모듈 간</td></tr><tr><td></td><td><code>Shared Kernel</code></td><td>공통 도메인 코드 공유</td><td>중복 제거, 코드 재사용</td><td>경계 침범 위험, 모듈 독립성 저하</td><td>공통 VO, Enum 등에 한정</td></tr><tr><td><strong>비동기 이벤트 기반</strong></td><td><code>Domain Event Pattern</code></td><td>비동기 이벤트 퍼블리싱/구독</td><td>느슨한 결합, 확장성 우수</td><td>멱등성, 이벤트 유실 처리 필요</td><td>사후 처리 또는 리액티브 시스템</td></tr><tr><td></td><td><code>Application Messaging</code></td><td>명령/이벤트 메시지 전송</td><td>명시적 명령 구조화, CQRS 적합</td><td>오케스트레이션 시 복잡도 증가</td><td>Command Handler 구조 필요</td></tr><tr><td><strong>Outbox Pattern</strong></td><td><code>Transactional Outbox</code></td><td>DB 와 메시지를 트랜잭션으로 묶음</td><td>데이터 일관성 보장, 메시지 유실 방지</td><td>Polling 지연, 복잡한 구성</td><td>강한 일관성이 필요한 업무 로직</td></tr><tr><td></td><td><code>Polling Publisher</code></td><td>DB 테이블 → 큐로 메시지 발행</td><td>구현 단순, 신뢰도 확보</td><td>실시간성 부족, 중복 처리 필요</td><td>Kafka, Debezium 연계 환경</td></tr><tr><td><strong>CQRS</strong></td><td><code>Command Handler Pattern</code></td><td>명령 처리 전용 클래스 구조</td><td>책임 분리, 테스트 용이</td><td>설계 복잡도 증가</td><td>복잡한 도메인, R/W 분리 요구</td></tr><tr><td></td><td><code>Read Model</code></td><td>쿼리 전용 모델 제공</td><td>읽기 성능 최적화</td><td>데이터 동기화 관리 필요</td><td>읽기 집중, 성능 요구 환경</td></tr><tr><td><strong>Event Sourcing</strong></td><td><code>Aggregate + Replay Pattern</code></td><td>상태 = 이벤트의 합</td><td>감사 추적, 완전한 변경 이력</td><td>구현 난이도 높음, 설계 숙련 필요</td><td>규제 준수, 금융/헬스케어 도메인</td></tr><tr><td></td><td><code>Snapshotting</code></td><td>이벤트 집계 지점 저장</td><td>성능 향상</td><td>스냅샷 관리 필요</td><td>이벤트 수 많고 복잡한 경우</td></tr></tbody></table><h4 id=코드베이스-구조화-및-의존성-제어>코드베이스 구조화 및 의존성 제어<a hidden class=anchor aria-hidden=true href=#코드베이스-구조화-및-의존성-제어>#</a></h4><table><thead><tr><th>구현 기법</th><th>설명</th><th>목적</th></tr></thead><tbody><tr><td><strong>폴더/패키지 네임스페이스 분리</strong></td><td>도메인별 디렉토리 및 계층화 구조 유지</td><td>관리 편의성, 정리된 코드베이스</td></tr><tr><td><strong>명시적 인터페이스 노출</strong></td><td>공개 API, 이벤트, 서비스 인터페이스만 허용</td><td>모듈 간 경계 명확화</td></tr><tr><td><strong>의존성 역전 (DI)</strong></td><td>추상화 레이어를 통해 의존성 주입</td><td>상위 계층이 하위 계층에 직접 의존하지 않도록 유지</td></tr></tbody></table><h4 id=빌드운영-전략>빌드/운영 전략<a hidden class=anchor aria-hidden=true href=#빌드운영-전략>#</a></h4><table><thead><tr><th>구현 기법</th><th>설명</th></tr></thead><tbody><tr><td><strong>모듈별 테스트 분리</strong></td><td>유닛, 통합, 계약 테스트를 각 모듈 단위로 구성</td></tr><tr><td><strong>빌드 도구 활용</strong></td><td>Gradle 멀티모듈, npm workspaces 등으로 모듈 간 의존성 명확화</td></tr><tr><td><strong>Strangler Fig 패턴</strong></td><td>기존 모놀리스를 점진적으로 모듈화하면서 리팩토링</td></tr></tbody></table><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><table><thead><tr><th>분류</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>설계</strong></td><td><strong>높은 응집도 및 캡슐화</strong></td><td>도메인 중심의 모듈화로 내부 구현이 은닉되며, 책임이 명확히 분리되어 유지보수가 용이함</td></tr><tr><td></td><td><strong>단일 트랜잭션 경계</strong></td><td>모든 모듈이 동일한 DB 또는 트랜잭션 컨텍스트를 공유하여 ACID 트랜잭션 유지 가능</td></tr><tr><td><strong>개발</strong></td><td><strong>개발 단순성</strong></td><td>단일 코드베이스와 일관된 개발 환경 제공, 통합 IDE 및 디버깅 환경 활용 가능</td></tr><tr><td></td><td><strong>테스트 용이성</strong></td><td>명확한 모듈 경계로 유닛/통합/계약 테스트 구성 용이, 테스트 자동화에 적합</td></tr><tr><td></td><td><strong>팀 생산성 향상</strong></td><td>팀 단위 모듈 책임 할당 가능, 병렬 개발이 가능하며 충돌 최소화</td></tr><tr><td><strong>배포/운영</strong></td><td><strong>배포 단순화</strong></td><td>단일 아티팩트로 배포, 배포 전략/롤백/버전 관리 단순</td></tr><tr><td></td><td><strong>운영비용 효율성</strong></td><td>단일 배포 및 단일 인스턴스 운영으로 인프라 복잡성 및 비용 절감</td></tr><tr><td></td><td><strong>높은 성능</strong></td><td>모듈 간 인메모리 함수 호출로 통신 비용 최소화, 직렬화/네트워크 오버헤드 없음</td></tr><tr><td><strong>확장성</strong></td><td><strong>모듈 기반 확장성</strong></td><td>모듈 단위로 책임 분리되어 기능 확장 시 해당 모듈만 수정 가능</td></tr><tr><td></td><td><strong>마이크로서비스 전환 용이</strong></td><td>명확한 모듈 경계와 인터페이스를 기반으로 모듈 단위 서비스 분리 가능 (MSA 전환 준비 구조)</td></tr><tr><td><strong>유지보수</strong></td><td><strong>코드 변경 영향 최소화</strong></td><td>모듈 간 결합도 최소화로 변경 시 영향 범위가 제한됨</td></tr><tr><td></td><td><strong>코드 탐색성 향상</strong></td><td>모듈별 네임스페이스, 폴더 구조가 명확하여 빠른 코드 탐색 가능</td></tr></tbody></table><h3 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>확장성</td><td>독립 확장 어려움</td><td>특정 모듈만 확장하려 해도 전체 애플리케이션 단위 확장 요구됨</td><td>병목 모듈 추출, 컨테이너 기반 모듈 격리, 수평 확장 전략 적용</td></tr><tr><td>배포</td><td>단일 배포 단위</td><td>일부 변경에도 전체 시스템 재배포가 필요함</td><td>CI/CD 자동화, 점진적 MSA 분리, 피처 플래그 활용</td></tr><tr><td>기술 다양성</td><td>기술 스택 고정화</td><td>단일 런타임으로 다양한 언어/프레임워크 혼용 어려움</td><td>다중 런타임 컨테이너 기반 설계, 인터페이스 기반 공통 계약 구성</td></tr><tr><td>장애 확산</td><td>단일 장애점</td><td>하나의 모듈 장애가 전체 시스템 장애로 확산 가능</td><td>모듈 격리, 장애 탐지 및 복구 자동화, 장애 전파 차단 설계</td></tr><tr><td>협업</td><td>팀 규모 증가 시 충돌</td><td>동일한 코드베이스에서 여러 팀이 작업 시 충돌, 컨벤션 불일치</td><td>모듈 책임 분리, Git Flow/Branch 전략, 코드 오너십 명확화</td></tr><tr><td>테스트 복잡도</td><td>인터모듈 통합 테스트 복잡</td><td>모듈 간 연동 로직이 증가하며 테스트 작성 및 관리 어려움</td><td>단위 테스트 우선, 계약 테스트/Mock 적용, 테스트 더블 기반 테스트 분리</td></tr><tr><td>통신 복잡도</td><td>인터페이스/이벤트 설계 어려움</td><td>모듈 간 API/이벤트 설계 미흡 시 유지보수성/이해도 저하</td><td>명확한 API 정의 규칙, 이벤트 이름 명세화, 통신 프로토콜 표준화 적용</td></tr></tbody></table><p>Modular Monolith 는 구조적으로 명확하고 유지보수성이 높은 반면, <strong>확장성과 기술 선택, 장애 대응, 팀 협업 측면</strong>에서 제약이 존재한다. 특히 단일 배포 단위의 한계와 팀 간 충돌은 규모가 커질수록 더욱 두드러진다. 이를 해결하기 위해선 <strong>컨테이너 기반 격리, 점진적 모듈 추출 전략, 테스트 전략 고도화, 명확한 팀 책임 구분</strong> 등이 필요하다.</p><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th>카테고리</th><th>항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 방법 및 기법</th></tr></thead><tbody><tr><td>경계 불분명</td><td>모듈 경계 침범</td><td>도메인 경계 설계 미흡, 모듈 간 직접 참조</td><td>코드 스파게티화, 유지보수 어려움</td><td>정적 분석, 코드 리뷰, 아키텍처 테스트</td><td>DDD 기반 명확한 컨텍스트 정의, API 기반 통신 규약 설계</td><td>아키텍처 테스트 도입, 경계 리팩토링</td></tr><tr><td>의존성 문제</td><td>순환 의존성</td><td>잘못된 의존성 방향 설계</td><td>컴파일 실패, 빌드 오류, 변경 영향 확산</td><td>의존성 시각화 도구, 그래프 분석</td><td>단방향 의존성 원칙, 인터페이스 기반 의존 분리</td><td>리팩토링, 추상화 레이어 도입</td></tr><tr><td>데이터 설계 실패</td><td>공유 DB 또는 공유 모델 남용</td><td>모듈 간 직접 DB 접근, 공유 모델을 통한 결합도 상승</td><td>데이터 일관성 저하, 스키마 변경 시 전체 영향</td><td>데이터 액세스 추적, SQL 로그 분석</td><td>API 기반 데이터 접근, 모듈별 DB 뷰 또는 스키마 분리</td><td>Outbox 패턴, CQRS, DB 마이그레이션 도구 활용</td></tr><tr><td>배포 안정성</td><td>동시 배포 충돌</td><td>하나의 배포 단위에서 다수 모듈의 동시 수정</td><td>전체 롤백 발생, 기능 장애 가능</td><td>Canary, Blue-Green 배포 전략 모니터링</td><td>모듈별 배포 시뮬레이션, 피처 플래그 및 롤백 기법 구성</td><td>점진적 기능 활성화, 독립 테스트 후 배포 구조 도입</td></tr><tr><td>통신 문제</td><td>인터페이스 남용</td><td>세분화되지 않은 API, 잘못된 이벤트 구성</td><td>통신 프로토콜 혼선, 모듈 간 재사용 어려움</td><td>인터페이스 호출 빈도 및 실패율 추적</td><td>계약 기반 인터페이스 설계, 이벤트 명세화</td><td>이벤트 기반 통신 전환, 인터페이스 리팩토링</td></tr><tr><td>성능 문제</td><td>병목 모듈 집중</td><td>특정 모듈 과부하, 동기 호출 집중</td><td>전체 응답 지연, 시스템 병목</td><td>APM 분석, 응답 시간 프로파일링</td><td>병목 모듈 별도 분리 또는 캐싱 처리</td><td>비동기 큐, 메시지 브로커, 서킷 브레이커 도입</td></tr><tr><td>복잡성 관리 실패</td><td>설계 구조 복잡화</td><td>추상화 남용, 인터페이스 중복, 패턴 무분별 적용</td><td>개발 속도 저하, 신규 인력 진입 장벽</td><td>코드 복잡도 분석 도구 활용</td><td>설계 가이드라인 수립, 정기적인 아키텍처 리뷰</td><td>단순화 리팩토링, 설계 패턴 통제</td></tr></tbody></table><p>Modular Monolith 의 문제점은 <strong>실제 구현·운영 단계에서의 경계 침범, 의존성 순환, 공유 자원 오남용, 통신 설계 미흡, 복잡성 증가</strong> 등으로 인해 발생한다. 대부분은 명확한 아키텍처 규칙 부족 또는 설계 가이드라인 부재로 인해 발생하며, 이로 인해 <strong>시스템 유지보수성과 확장성에 큰 영향을 미친다</strong>. 예방을 위해선 <strong>설계 단계의 원칙 준수, 아키텍처 테스트 자동화, API/이벤트 명세화, 성능 및 복잡도 지속 진단 도구</strong>를 체계적으로 운영하는 것이 핵심이다.</p><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><table><thead><tr><th>카테고리</th><th>도전 과제</th><th>원인/배경</th><th>영향</th><th>탐지 및 진단 방법</th><th>예방 전략 및 해결 기법</th></tr></thead><tbody><tr><td><strong>모듈 경계 관리</strong></td><td>모듈 경계 설정·유지</td><td>도메인 모델 불명확, 요구사항 변화, 팀 간 설계 불일치</td><td>기능 중복, 결합도 상승, 코드 혼란</td><td>상호 호출 분석, 코드 리뷰, 이벤트 스토밍</td><td>Bounded Context 설계, 이벤트 기반 통신, 아키텍처 테스트 자동화</td></tr><tr><td><strong>팀 협업 및 조직</strong></td><td>모듈 간 계약 조율 어려움</td><td>공유 코드베이스, 계약 변경에 대한 동기화 부족</td><td>인터페이스 침범, 병합 충돌, 빌드 실패</td><td>계약 테스트 실패율, 리뷰 주기 분석</td><td>모듈별 책임 명확화, 계약 기반 CI/CD, 브랜치 전략 고도화</td></tr><tr><td><strong>운영 및 배포</strong></td><td>단일 배포 장애, 모듈 독립성 부족</td><td>모든 모듈이 하나의 배포 단위로 묶여 있음</td><td>일부 모듈 오류 시 전체 장애, 롤백 어려움</td><td>배포 실패 이력, Canary 테스트</td><td>모듈 리로드, 피처 플래그, Blue-Green 배포, 모듈 분리 가능 설계</td></tr><tr><td><strong>통신 및 데이터 일관성</strong></td><td>교차 모듈 트랜잭션 처리 어려움</td><td>분산된 기능이 하나의 트랜잭션으로 묶여야 하는 요구</td><td>데이터 불일치, 실패 전파, 장애 확산</td><td>트랜잭션 실패율, 데이터 유실 로그 분석</td><td>Outbox Pattern, SAGA, 명확한 데이터 소유권 정의</td></tr><tr><td><strong>테스트 및 품질</strong></td><td>테스트 자동화·계약 검증 부족</td><td>인터페이스 기반 테스트 미흡, 통합 테스트 비중 과도</td><td>테스트 불안정, 배포 실패</td><td>테스트 커버리지 리포트, 빌드 실패 로그</td><td>Contract Test (Pact), 격리 테스트, 의존성 주입 테스트 구조화</td></tr><tr><td><strong>스케일링 및 성능</strong></td><td>모듈 간 부하 편중</td><td>특정 기능 호출 집중, 캐시 미사용, 일괄 처리 부재</td><td>병목 발생, 시스템 전체 성능 저하</td><td>APM(예: Datadog), 호출 히트맵 분석</td><td>CQRS, 캐시 계층화, 읽기 모델 분리, 모듈 독립적 스케일링</td></tr><tr><td><strong>모니터링 및 관측성</strong></td><td>모듈별 메트릭 부재</td><td>중앙 집중 로깅에 의존, 모듈 단위 관측 설계 누락</td><td>문제 원인 진단 어려움, 모듈 단위 SLA 미확보</td><td>분산 추적, 모듈 로그 비율 분석</td><td>OpenTelemetry, 커스텀 모듈 메트릭, 통합 대시보드 구성</td></tr></tbody></table><ol><li><p>모듈 경계 관리<br>모듈 경계를 명확히 설계하지 않으면 기능 중복과 모듈 간 결합도가 증가한다. 특히 요구사항이 변화하거나 팀 간 협업이 미흡하면 경계가 흐려질 수 있으므로, <strong>DDD 기반의 Bounded Context</strong> 설정과 <strong>정기적인 아키텍처 리팩토링</strong>이 필수다.</p></li><li><p>팀 협업 및 계약 조율<br>공유 코드베이스 환경에서 모듈 간 인터페이스 계약을 동기화하지 않으면 <strong>빌드 실패</strong>, <strong>코드 충돌</strong>이 잦아진다. 모듈별 팀 책임 분배와 **계약 기반 자동화 (CI/CD)**가 중요하며, <strong>브랜치 전략 개선</strong>과 <strong>명확한 API 명세</strong>가 필요하다.</p></li><li><p>운영 및 배포<br>단일 배포 구조에서는 하나의 모듈만 장애가 발생해도 전체 시스템이 영향을 받는다. 따라서 <strong>피처 플래그</strong>, <strong>모듈 리로드</strong>, <strong>Blue-Green 배포 전략</strong>으로 위험을 최소화하고, 장기적으로는 모듈 독립 배포를 고려해야 한다.</p></li><li><p>통신 및 데이터 일관성<br>교차 모듈 간 트랜잭션은 데이터 일관성 문제를 유발한다. <strong>Outbox Pattern</strong>과 <strong>SAGA</strong>는 데이터 일관성을 보장하면서도 모듈 간 느슨한 결합을 유지할 수 있게 해준다.</p></li><li><p>테스트 및 품질<br>통합 테스트에만 의존하면 결함 위치 파악이 어렵고, 릴리즈 주기가 길어진다. <strong>Contract Testing</strong>, <strong>의존성 분리 테스트</strong>, <strong>테스트 자동화 도구</strong>를 통해 각 모듈을 독립적으로 검증하는 구조가 필요하다.</p></li><li><p>스케일링 및 성능<br>기능 단위로 요청이 집중되면 특정 모듈이 병목이 된다. <strong>CQRS 적용</strong>, <strong>읽기/쓰기 분리</strong>, <strong>캐시 계층화</strong> 등의 성능 최적화가 필요하며, 모듈별 독립 스케일링 구조가 성능 향상에 효과적이다.</p></li><li><p>모니터링 및 관측성<br>모듈 단위로 문제를 진단하기 어렵다면 전체 장애 대응 속도가 느려진다. <strong>OpenTelemetry</strong>, <strong>분산 추적</strong>, <strong>커스텀 모듈 메트릭</strong>으로 모듈 레벨의 관측성을 확보해야 운영 안정성을 유지할 수 있다.</p></li></ol><h4 id=modular-monolith-도전-과제별-실무-대응-사례>Modular Monolith 도전 과제별 실무 대응 사례<a hidden class=anchor aria-hidden=true href=#modular-monolith-도전-과제별-실무-대응-사례>#</a></h4><table><thead><tr><th>도전 과제</th><th>실무 사례 (기업)</th><th>대응 전략 / 실제 적용 방법</th></tr></thead><tbody><tr><td><strong>모듈 경계 설정 및 유지</strong></td><td><strong>Shopify</strong></td><td>Shopify 는 도메인 중심 모듈 구조를 유지하면서도 " 패키지 레벨 의존성 그래프 " 를 통해 모듈 간 호출을 자동으로 추적하고, 위반 시 컴파일 에러 발생 구조로 설계함.</td></tr><tr><td></td><td><strong>Google (Service Weaver)</strong></td><td>Google 은 각 모듈을 <code>API surface</code> 로 노출하고 인터페이스만 접근 가능하도록 설계. 내부 구현 접근은 Linter 및 Build 시스템에서 금지함.</td></tr><tr><td><strong>팀 협업 / 인터페이스 계약</strong></td><td><strong>StackOverflow</strong></td><td>각 모듈별 Ownership 을 명확히 하고, Git 단위 PR Template 에 API 변경 시 Impact 분석 필수로 지정. API 문서는 자동화되어 있고, 변경 시 계약 검증 테스트가 병행됨.</td></tr><tr><td><strong>운영 및 배포 전략</strong></td><td><strong>Shopify</strong></td><td>모놀리스를 유지하지만 모듈마다 독립적인 Feature Flag 를 적용해 모듈 단위의 롤아웃 및 롤백을 가능하게 함. 전체 앱 재시작 없이 모듈 업데이트가 가능함.</td></tr><tr><td><strong>트랜잭션과 데이터 일관성</strong></td><td><strong>Google</strong></td><td>Google 의 내부 시스템은 Outbox 패턴을 강화해 사용하며, 모든 모듈 간 커뮤니케이션은 " 이벤트 로그 기반 전파 " 로 처리. DB 트랜잭션 내에 이벤트 삽입 후 전송함.</td></tr><tr><td><strong>테스트 및 품질 관리</strong></td><td><strong>StackOverflow</strong></td><td>모듈별 테스트 디렉토리를 유지하고, Interface Mock 과 Pact 를 활용한 계약 기반 테스트를 채택. GitHub Action 기반으로 모듈 단위 테스트 자동 실행.</td></tr><tr><td><strong>스케일링 및 성능 대응</strong></td><td><strong>Shopify</strong></td><td>CQRS 적용으로 읽기 부하가 높은 모듈은 읽기 전용 캐시로 처리하며, 일부 고부하 모듈은 독립 실행 가능한 Process 로 전환하여 모놀리스 내에서 자체 스케일링을 허용함.</td></tr><tr><td><strong>모니터링 및 관측성</strong></td><td><strong>Google</strong></td><td>OpenTelemetry 기반 Trace ID 를 모듈 간 전파하고, GCP Stackdriver 로 통합 모듈 메트릭을 수집함. 모듈별 latency, error rate, throughput 을 실시간 대시보드로 노출함.</td></tr></tbody></table><h4 id=modular-monolith-아키텍처-검증-체크리스트>Modular Monolith 아키텍처 검증 체크리스트<a hidden class=anchor aria-hidden=true href=#modular-monolith-아키텍처-검증-체크리스트>#</a></h4><p>Modular Monolith 는 단순한 구조가 아닌, <strong>" 모듈화된 아키텍처 원칙 " + " 단일 배포 유닛 &ldquo;</strong> 을 유지하면서도 <strong>MSA 수준의 독립성, 확장성, 테스트성, 관측성</strong>을 확보하는 것이 핵심이다.</p><p>실무 기업들은 다음과 같은 전략으로 도전 과제를 해결하고 있다:</p><ul><li><strong>Shopify</strong>: 단일 배포 유지, 철저한 모듈 분리 + 피처 플래그 기반 운영</li><li><strong>Google</strong>: Bounded Context 경계와 인터페이스 보장 → MSA 전환도 무리 없음</li><li><strong>StackOverflow</strong>: 계약 중심 개발문화와 테스트 자동화를 통해 협업 리스크 최소화</li></ul><p>이 구조와 체크리스트는 &ldquo;MSA 로 가기 위한 안전한 중간 단계 " 로서 Modular Monolith 를 검증하고 발전시키는 기준이 될 수 있다.</p><table><thead><tr><th>카테고리</th><th>체크 항목</th><th>체크 여부 (✓/✗)</th><th>비고 (설명/도구 등)</th></tr></thead><tbody><tr><td><strong>🧱 모듈 경계 점검</strong></td><td>각 도메인은 별도 디렉토리/네임스페이스로 구성되는가</td><td></td><td></td></tr><tr><td></td><td>모듈 내부는 Interface → Application → Domain → Infra 계층 구조를 따르는가</td><td></td><td>Clean Architecture 기준</td></tr><tr><td></td><td>모듈 간 직접 의존 없이 인터페이스 또는 이벤트로 통신하는가</td><td></td><td>REST, EventBus, Kafka 등</td></tr><tr><td></td><td>호출 의존성을 시각화하거나 분석하는 도구가 적용되어 있는가</td><td></td><td>ArchUnit, Graphviz, jDepend 등</td></tr><tr><td><strong>👥 팀 협업 및 계약 전략</strong></td><td>모듈별 팀 소유권이 명확히 설정되어 있는가</td><td></td><td>코드오너 설정, Git 관리 정책 등</td></tr><tr><td></td><td>API 변경 시 문서, 테스트, 영향 분석이 자동화되는가</td><td></td><td>GitHub Actions, Swagger, Pact</td></tr><tr><td></td><td>인터페이스 (API) 는 명시적으로 관리되고 있는가</td><td></td><td>Interface, OpenAPI 등</td></tr><tr><td></td><td>Contract Testing 도구를 사용하는가</td><td></td><td>Pact, Spring Cloud Contract 등</td></tr><tr><td><strong>🚀 운영 및 배포 구조</strong></td><td>Feature Toggle 또는 설정 기반 Enable/Disable 이 가능한가</td><td></td><td>LaunchDarkly, Spring Config 등</td></tr><tr><td></td><td>장애 발생 시 일부 모듈만 격리 가능한 구조인가</td><td></td><td>Circuit Breaker, 모듈 격리 처리 등</td></tr><tr><td></td><td>모듈 수준 Health Check 가 구현되어 있는가</td><td></td><td>Actuator, /health endpoint 등</td></tr><tr><td><strong>🔄 트랜잭션 및 데이터 일관성</strong></td><td>Bounded Context 기준으로 데이터 접근이 구분되는가</td><td></td><td>각 모듈 별 DB schema 또는 view</td></tr><tr><td></td><td>Cross-module 트랜잭션은 Outbox/Event 기반 처리되는가</td><td></td><td>Transaction + Outbox Table</td></tr><tr><td></td><td>메시지에 version 및 idempotency key 가 포함되는가</td><td></td><td>Kafka header, message body 등</td></tr><tr><td><strong>🧪 테스트 및 품질 전략</strong></td><td>모듈마다 독립된 유닛/통합 테스트 구조가 있는가</td><td></td><td><code>tests/order/test_*.py</code> 등</td></tr><tr><td></td><td>계약 기반 테스트 (Contract Test) 가 존재하는가</td><td></td><td>Pact, Interface Test 등</td></tr><tr><td></td><td>테스트는 CI 파이프라인에서 자동으로 실행되는가</td><td></td><td>GitHub Actions, GitLab CI 등</td></tr><tr><td><strong>📈 성능 및 스케일링 전략</strong></td><td>읽기/쓰기 분리 전략 (CQRS 등) 이 구현되어 있는가</td><td></td><td>ReadModel, Projection 등</td></tr><tr><td></td><td>고부하 모듈은 캐시 또는 독립 서비스로 확장 가능한가</td><td></td><td>Redis, 분리된 실행 컨테이너 등</td></tr><tr><td></td><td>모듈별 성능 지표가 수집되고 알림 설정이 있는가</td><td></td><td>Prometheus, Grafana, Alertmanager</td></tr><tr><td><strong>🔭 모니터링 및 관측성</strong></td><td>모듈별 로그, 메트릭, 트레이스를 수집하는가</td><td></td><td>OpenTelemetry, Loki, Prometheus</td></tr><tr><td></td><td>Trace ID 가 모듈 간에 전파되는가</td><td></td><td>Trace Context, B3, W3C Header 등</td></tr><tr><td></td><td>APM 또는 관측 도구가 도입되어 있는가</td><td></td><td>Jaeger, Zipkin, New Relic 등</td></tr></tbody></table><h3 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th><strong>분류 기준</strong></th><th><strong>유형</strong></th><th><strong>설명</strong></th><th><strong>적용 예시</strong></th></tr></thead><tbody><tr><td><strong>모듈 구조 방식</strong></td><td>계층형 모듈 (Layered)</td><td>기술 계층 (UI, 서비스, 데이터 접근) 중심으로 모듈을 분리</td><td>MVC, N-Tier 기반 구조</td></tr><tr><td></td><td>도메인형 모듈 (Domain-Based)</td><td>도메인 또는 경계 컨텍스트 중심으로 기능을 그룹화</td><td>DDD 기반 User, Order, Payment 모듈</td></tr><tr><td></td><td>기능형 모듈 (Feature-Based)</td><td>CRUD 단위 기능별로 모듈 구성</td><td>게시판, 알림 기능 단위 분리</td></tr><tr><td></td><td>Vertical Slice</td><td>기능 흐름 전체를 모듈 단위로 구성</td><td>입력 → 검증 → 처리 → 응답 구조 모듈화</td></tr><tr><td><strong>통신 방식</strong></td><td>동기 호출 (In-process)</td><td>내부 메서드, 인터페이스 호출 방식의 직접 통신</td><td>Service → Repository 직접 호출</td></tr><tr><td></td><td>비동기 호출 (Event-driven)</td><td>도메인 이벤트, 메시지 큐 기반 통신으로 느슨한 결합 제공</td><td>Kafka, RabbitMQ 사용 구조</td></tr><tr><td><strong>데이터 관리 방식</strong></td><td>공유 스키마</td><td>모든 모듈이 하나의 DB 및 스키마를 공유</td><td>단일 PostgreSQL 스키마</td></tr><tr><td></td><td>분리 스키마</td><td>모듈별 테이블, DB 스키마를 분리하여 소유권 명확화</td><td>모듈별 스키마 및 접근 계층 구분</td></tr><tr><td></td><td>모듈별 DB 인스턴스 분리</td><td>아예 모듈별 DB 인스턴스를 분리하여 MSA 전환 대비</td><td>각 모듈별 MySQL/PostgreSQL 분리</td></tr><tr><td><strong>배포 전략</strong></td><td>단일 배포</td><td>전체 애플리케이션을 하나의 JAR/WAR 로 빌드 및 배포</td><td>Spring Boot Monolith 구조</td></tr><tr><td></td><td>선택적 모듈 배포</td><td>일부 모듈만 선택적으로 교체 가능한 구조 (플러그인/피처 단위 빌드)</td><td>모듈별 Docker 이미지 분리 가능</td></tr><tr><td><strong>저장소 관리 방식</strong></td><td>모노레포 (Monorepo)</td><td>모든 모듈을 단일 저장소에서 관리</td><td>GitHub 단일 리포지토리</td></tr><tr><td></td><td>멀티레포 (Manyrepo)</td><td>모듈별로 별도 저장소 구성 → 분리/독립 배포에 유리</td><td>GitHub 조직 내 모듈별 리포지토리</td></tr><tr><td><strong>아키텍처 스타일</strong></td><td>DDD 기반</td><td>도메인 주도 설계를 통해 경계 및 책임 분리 강조</td><td>Context 별 Aggregate 설계 구조</td></tr><tr><td></td><td>CQRS 기반</td><td>읽기/쓰기 모델 분리, Event 기반 처리 강화</td><td>Query/Command Handler 분리 구조</td></tr><tr><td><strong>도메인 범위 구성</strong></td><td>단일 도메인 집중형</td><td>하나 또는 두 개의 비즈니스 도메인에 집중</td><td>ERP 의 인사관리 단위 구성</td></tr><tr><td></td><td>다중 도메인 분리형</td><td>여러 도메인을 명확히 구분하고 통신 및 데이터 분리 적용</td><td>전자상거래의 주문/결제/상품 모듈화</td></tr><tr><td><strong>운영 확장성</strong></td><td>고정형 모듈</td><td>런타임 독립성 없이 내부 의존성이 강한 구조</td><td>정적 구성 기반 모듈 설계 구조</td></tr><tr><td></td><td>확장형 모듈</td><td>추후 독립 실행 가능성을 고려해 모듈 인터페이스와 의존성 분리 설계 적용</td><td>MSA 이행 대비 구조화 모듈</td></tr></tbody></table><ol><li><p><strong>모듈 구조 방식</strong>:<br>기술 계층 (Layer), 도메인 (Domain), 기능 (Feature), Vertical Slice 방식으로 나뉘며, 도메인/기능 중심 분리는 비즈니스 변화에 유리하고, 계층형은 기술적 통합 관리에 유리함.</p></li><li><p><strong>통신 방식</strong>:<br>동기 호출 구조는 단순성과 성능에 유리하나 결합도가 높고, 비동기 방식은 유연한 확장성과 오류 복원력, 낮은 결합도를 제공함. 이벤트 기반 구조가 MSA 전환을 유도하기에 적합함.</p></li><li><p><strong>데이터 관리 방식</strong>:<br>공유 스키마는 빠른 구축에 유리하나 변경 전파 리스크가 크며, 분리 스키마 및 DB 인스턴스 분리는 독립성과 유지보수성 확보에 유리. MSA 전환을 고려한다면 필수 고려 사항.</p></li><li><p><strong>배포 전략</strong>:<br>단일 배포 구조는 배포 자동화가 간편하나, 모듈 영향도가 크며 전체 재배포가 필요하다. 선택적 모듈 배포 또는 모듈별 Docker 이미지 분리가 이상적 운영 구조.</p></li><li><p><strong>저장소 관리 방식</strong>:<br>Monorepo 는 변경 추적과 협업이 쉬우나 충돌이 많고, Manyrepo 는 독립 배포와 이력 관리에 유리하며 서비스 분리 전환에도 강점을 가진다.</p></li><li><p><strong>아키텍처 스타일</strong>:<br>DDD, CQRS 등은 모듈 간 경계 명확화와 확장성, 이벤트 처리 기반 설계에 필수. 특히 CQRS 기반 구조는 읽기와 쓰기 흐름 분리로 시스템 안정성 확보에 효과적.</p></li><li><p><strong>도메인 범위 구성</strong>:<br>단일 도메인 구조는 집중적인 기능 최적화가 가능하나 확장성 부족, 다중 도메인 구조는 시스템 복잡도는 올라가지만 팀 간 분리 및 병렬 개발에 유리함.</p></li><li><p><strong>운영 확장성</strong>:<br>고정형은 단순하지만 유연성이 부족하고, 확장형은 향후 마이크로서비스 전환 및 클라우드 네이티브 대응 측면에서 필수 구조.</p></li></ol><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th><th>권장 사항</th></tr></thead><tbody><tr><td><strong>설계</strong></td><td>도메인 경계 정의</td><td>모듈 간 경계가 흐려지지 않도록 도메인 중심으로 구조 설계</td><td>DDD 기반 이벤트 스토밍, 명확한 Bounded Context 매핑 및 문서화</td></tr><tr><td></td><td>인터페이스 표준화</td><td>모듈 간 계약이 불분명하면 통합·확장 시 문제 발생</td><td>명세 기반 API 설계 (OpenAPI), 인터페이스 버전 관리 정책 수립</td></tr><tr><td></td><td>설계 표준 운영</td><td>팀 간 설계/코드 기준이 달라지면 유지보수 어려움</td><td>공통 코딩 컨벤션, 모듈 표준 템플릿 및 폴더 구조 정의</td></tr><tr><td><strong>구현</strong></td><td>의존성 관리</td><td>순환 의존 및 결합도 증가 위험</td><td>DI, 정적 분석 도구 (ArchUnit), 아키텍처 린터 도입</td></tr><tr><td></td><td>공통 코드 오남용 방지</td><td>공통 유틸 또는 레이어가 경계 침범 유도 가능</td><td>공통 코드는 명확한 경계 (Shared Module 또는 Core Layer) 로 관리</td></tr><tr><td></td><td>데이터 격리</td><td>DB 공유 시 모듈 간 결합 발생</td><td>모듈 단위 스키마 분리, 레포지토리 캡슐화, API 기반 데이터 접근 전략</td></tr><tr><td><strong>품질</strong></td><td>테스트 전략</td><td>모듈 경계 테스트 미비 시 장애 발견 지연</td><td>계약 기반 테스트, 모듈 단위 유닛 테스트 + 통합 테스트 병행</td></tr><tr><td></td><td>경계 위반 감지</td><td>무분별한 의존 또는 직접 참조</td><td>아키텍처 테스트 도구 (e.g. ArchUnit, NetArchTest), 인터페이스만 통한 접근</td></tr><tr><td><strong>운영</strong></td><td>CI/CD 전략</td><td>전체 배포와 모듈 계약의 상호 영향도 존재</td><td>Contract-first 테스트, 버전 고정 및 점진적 릴리즈 전략 적용</td></tr><tr><td></td><td>배포 안정화</td><td>전체 시스템 중단 또는 장애 대응 미흡</td><td>Blue-Green, Canary 등 무중단 배포 전략 구성</td></tr><tr><td></td><td>환경 일관성 유지</td><td>환경 차이로 발생하는 버그 대응 어려움</td><td>컨테이너 기반 환경 일치화, IaC 기반 환경 자동화</td></tr><tr><td></td><td>모니터링/관찰성 강화</td><td>모듈 수준의 문제 파악 어려움</td><td>모듈 단위 로깅/메트릭/트레이싱 구성, APM 및 OpenTelemetry 통합</td></tr><tr><td><strong>협업/문화</strong></td><td>모듈 기반 팀 운영</td><td>중앙 집중형 조직은 경계와 책임의 모호성 유발</td><td>Conway&rsquo;s Law 고려한 팀 - 모듈 정렬, 문서 기반 협업</td></tr><tr><td></td><td>문서화 및 시각화</td><td>설계 지식이 암묵적으로 남아 있을 경우 온보딩/유지보수에 문제 발생</td><td>API 문서 자동화, 도메인/모듈 다이어그램 관리 (C4 Model 등)</td></tr></tbody></table><ul><li><p><strong>설계 측면</strong>에서는 DDD 기반의 경계 설정, 인터페이스 표준화, 모듈 설계 규칙이 핵심이다. 이는 모듈 경계가 오염되지 않고 장기적으로 유지보수 가능한 구조를 만드는 데 중요하다.</p></li><li><p><strong>구현 측면</strong>에서는 의존성 방향을 철저히 관리하고, 공통 코드 또는 데이터 공유로 인한 침범을 방지하는 전략이 필요하다. DI, 레이어 캡슐화, 리포지토리 분리가 실효성이 높다.</p></li><li><p><strong>품질 측면</strong>에서는 테스트 커버리지와 아키텍처 검증이 중요하며, 특히 <strong>모듈 경계 테스트</strong>와 계약 기반 통합 테스트는 필수이다.</p></li><li><p><strong>운영 측면</strong>에서는 배포 자동화, 환경 일관성 유지, 모듈 단위 모니터링 구조가 실무 안정성 확보의 기반이 된다.</p></li><li><p><strong>협업과 문화 측면</strong>에서는 Conway&rsquo;s Law 에 따라 팀 구조를 모듈 구조에 정렬시키는 것이 효과적이며, 암묵적 지식을 제거하기 위한 문서화와 시각화가 장기적인 유지보수에 결정적이다.</p></li></ul><h4 id=설계-측면>설계 측면<a hidden class=anchor aria-hidden=true href=#설계-측면>#</a></h4><table><thead><tr><th>구분</th><th>내용</th></tr></thead><tbody><tr><td>경계 설정</td><td>DDD 기반 Bounded Context 명확히 구분, <code>interface</code> 와 <code>implementation</code> 분리</td></tr><tr><td>의존성 관리</td><td>DI 적용, 계층 간 단방향 의존 (예: Presentation → Application → Domain)</td></tr><tr><td>인터페이스</td><td>각 모듈은 내부 인터페이스를 통해서만 상호작용, 외부 노출 최소화</td></tr></tbody></table><h4 id=품질-측면>품질 측면<a hidden class=anchor aria-hidden=true href=#품질-측면>#</a></h4><h5 id=테스트-전략>테스트 전략<a hidden class=anchor aria-hidden=true href=#테스트-전략>#</a></h5><table><thead><tr><th>구분</th><th>전략</th></tr></thead><tbody><tr><td>유닛 테스트</td><td>각 모듈 내부 서비스/도메인에 대해 단위 테스트 작성 (<code>Mock</code> 활용)</td></tr><tr><td>모듈 테스트</td><td>각 모듈 인터페이스를 외부처럼 호출하여 모듈 단위 통합 테스트 수행</td></tr><tr><td>계약 기반 테스트</td><td>다른 모듈과의 인터페이스 연동을 Contract Test 로 명시 (MSA 전환 대비)</td></tr><tr><td>테스트 격리</td><td>테스트용 모듈 구성 또는 테스트 전용 ApplicationContext 구성 (Spring) 사용</td></tr></tbody></table><h4 id=운영-측면>운영 측면<a hidden class=anchor aria-hidden=true href=#운영-측면>#</a></h4><table><thead><tr><th>항목</th><th>설명</th><th>도구/기술 예시</th></tr></thead><tbody><tr><td>CI/CD</td><td>모듈 단위 단위 테스트 → 전체 빌드 배포</td><td>GitHub Actions, GitLab CI</td></tr><tr><td>Observability</td><td>로그, 메트릭, 트레이싱 통합</td><td>OpenTelemetry, Grafana, ELK Stack</td></tr><tr><td>Static Architecture Check</td><td>경계 위반, 순환 참조 검사</td><td>ArchUnit, PyArchitecture</td></tr><tr><td>Contract Testing</td><td>모듈 간 계약 위반 방지</td><td>Pact, Dredd, OpenAPI Mocking</td></tr><tr><td>Boundary Enforcement</td><td>인터페이스 외부 접근 방지</td><td>린트 규칙, 모듈 바인딩 제한</td></tr></tbody></table><h3 id=최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td><strong>성능 최적화</strong></td><td>모듈 간 통신 최적화</td><td>모듈 간 RPC, API 호출에 따른 지연 및 오버헤드 최소화</td><td>인메모리 호출, 비동기 처리, 이벤트 집계, 배치 처리 활용</td></tr><tr><td></td><td>캐싱 전략</td><td>반복 조회되는 데이터의 성능 향상 및 부하 감소</td><td>모듈별 Redis, CQRS+Read Cache 구성</td></tr><tr><td></td><td>병목 분석 및 모니터링</td><td>자원 과다 사용 또는 느린 처리 흐름의 모듈 식별</td><td>APM, 로깅/모니터링 도구로 성능 추적 및 튜닝</td></tr><tr><td></td><td>데이터 접근 최적화</td><td>쿼리 병목, 불필요한 조인, 과도한 DB 호출 등</td><td>인덱스, 쿼리 튜닝, 연결 풀 분리, 캐시 계층 도입</td></tr><tr><td><strong>확장성 전략</strong></td><td>모듈 분리 전략</td><td>모놀리식 구조 내에서도 모듈을 독립적으로 확장 가능해야 함</td><td>느슨한 결합 구조 유지, 점진적 MSA 분리 전략</td></tr><tr><td></td><td>무상태 설계</td><td>확장을 위한 기본 전제 조건으로 세션/상태 외부 저장</td><td>세션 저장소 외부화 (예: Redis), 무상태 API 설계</td></tr><tr><td></td><td>모듈 용량/복잡도 관리</td><td>과도하게 커진 모듈은 오히려 단일 장애점으로 작용 가능</td><td>기능 단위 수직 슬라이스로 구조 분할</td></tr><tr><td><strong>유지보수성</strong></td><td>코드 품질 관리</td><td>시간이 지남에 따라 레거시 코드가 쌓이고 유지보수 비용 증가</td><td>정기적 리팩토링, 정적 분석 도구, 코드 리뷰 자동화</td></tr><tr><td></td><td>문서화 및 설계 기록</td><td>의사결정의 흐름과 API 변화 추적이 어려울 수 있음</td><td>ADR 작성, Swagger/OpenAPI 기반 문서 자동화</td></tr><tr><td></td><td>테스트 전략</td><td>통합 테스트 난이도 상승, 모듈 간 계약 위반 리스크</td><td>단위 + 통합 + Contract Testing 병행</td></tr><tr><td><strong>보안 및 복원력</strong></td><td>인증·인가 체계</td><td>통합 시스템에서 공통 인증 모듈은 전체 보안에 영향을 줌</td><td>JWT, OAuth2, RBAC, 보안 로깅</td></tr><tr><td></td><td>데이터 보호</td><td>민감 정보 유출, 저장·전송 중 보안 리스크</td><td>TLS, DB 암호화, Vault 기반 키 관리</td></tr><tr><td></td><td>장애 격리 및 복구</td><td>하나의 모듈 오류가 전체 시스템 장애로 이어질 수 있음</td><td>Circuit Breaker, 타임아웃, 롤백 전략</td></tr><tr><td></td><td>백업 및 재해복구 계획</td><td>운영 DB 와 아키텍처 요소에 대한 복구 시나리오 미비</td><td>주기적 백업 + DR 환경 구성 + 복구 시뮬레이션</td></tr><tr><td><strong>구조적 품질</strong></td><td>인터페이스 경량화</td><td>모듈 간 API 복잡도는 유지보수성과 테스트 복잡도를 증가시킴</td><td>작고 명확한 계약, DTO 분리, 버전 관리 적용</td></tr><tr><td></td><td>데이터 일관성</td><td>트랜잭션 경계가 모듈별로 나뉘어 데이터 불일치 발생 가능</td><td>이벤트 기반 최종 일관성, 보상 트랜잭션 (Saga)</td></tr><tr><td></td><td>과도한 모듈화</td><td>모듈 수 증가 시 관리 비용 및 복잡성 증가 가능</td><td>도메인 중심 적정 분리, 공통 유틸리티 모듈화 기준 수립</td></tr></tbody></table><ul><li><p><strong>성능 최적화</strong>:<br>Modular Monolith 는 모듈 간 통신 비용과 데이터 접근 병목이 성능 저하의 주요 원인이 되므로, 인메모리 호출, 캐시 계층화, 쿼리 튜닝, APM 도구 활용을 통해 성능 병목을 사전에 감지하고 완화해야 한다.</p></li><li><p><strong>확장성 전략</strong>:<br>무상태 설계를 전제로 수평 확장이 가능하도록 구조를 잡고, 단일 모듈의 과도한 비대화 (모듈 붕괴) 를 방지하며 기능 중심의 수직 슬라이스로 분할한다. 추후 MSA 로 분리 가능성을 고려해 느슨한 결합과 독립 배포성을 확보한다.</p></li><li><p><strong>유지보수성</strong>:<br>코드 일관성을 위한 자동화된 품질 검사와 정적 분석 도입이 필수이며, ADR 및 API 문서를 통해 설계/변경 이력을 추적 가능해야 한다. 테스트는 단위 + 계약 기반 테스트를 함께 구성하여 경계 위반을 사전에 검출한다.</p></li><li><p><strong>보안 및 복원력</strong>:<br>전체 시스템이 단일 배포이므로 인증/인가 시스템이 취약하면 전체 서비스에 영향이 가므로, 보안 계층은 통합되되 경량화되어야 하며 장애 격리, 데이터 백업, 복구 시나리오까지 사전에 준비해야 안정적 운영이 가능하다.</p></li><li><p><strong>구조적 품질</strong>:<br>복잡한 인터페이스는 경계 침범 가능성을 높이므로 단순하고 명확한 API 계약이 중요하다. 트랜잭션은 서비스 간 경계를 고려한 보상 패턴 기반 일관성을 적용하며, 과도한 모듈화는 오히려 유지비용 증가 요인이 될 수 있어 주의가 필요하다.</p></li></ul><h3 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h3><table><thead><tr><th>카테고리</th><th>사용 예시</th><th>사용 목적</th><th>사용 기술/개념</th><th>주요 효과</th></tr></thead><tbody><tr><td>전자상거래 플랫폼</td><td>Shopify 등</td><td>상품/주문/결제 모듈화, 성능 확장성 확보</td><td>Ruby on Rails, MySQL, Redis, Event Bus</td><td>대규모 트래픽 처리, 기능 분리, 유지보수 향상</td></tr><tr><td>기업 포털</td><td>사내 인트라넷 등</td><td>사람/조직/게시판 등 역할별 모듈화</td><td>Spring Boot, Thymeleaf, LDAP</td><td>역할 기반 관리, 병렬 개발, 보안 구분</td></tr><tr><td>헬스케어 시스템</td><td>진료 플랫폼, 병원 시스템</td><td>환자/의료진/처방 모듈 분리 및 보안 강화</td><td>Node.js, MongoDB, Kafka, Kubernetes</td><td>모듈별 접근 제어, 데이터 보안, 감사 추적</td></tr><tr><td>금융 서비스</td><td>온라인 은행, 보험 플랫폼</td><td>계좌/결제/리스크 모듈화 및 트랜잭션 안정성 확보</td><td>Spring Boot, PostgreSQL, Kafka, Docker</td><td>규제 준수, 데이터 정합성, 이벤트 기반 비동기 처리</td></tr><tr><td>교육 플랫폼</td><td>온라인 러닝 시스템</td><td>강의/학생/평가/인증 모듈 구성</td><td>Django, PostgreSQL, Redis</td><td>기능 독립성 확보, 학습 데이터 확장성</td></tr><tr><td>콘텐츠 플랫폼</td><td>CMS 등</td><td>콘텐츠/사용자/워크플로우 모듈화</td><td>.NET Core, MediatR, Elasticsearch, RabbitMQ</td><td>검색 최적화, 모듈 기반 변경 유연성</td></tr><tr><td>전환 준비 구조</td><td>성장 기반 모놀리스</td><td>마이크로서비스 전환 전 단계적 분리 구조</td><td>Clean Architecture, DDD, CQRS + Outbox Pattern</td><td>모듈 경계 유지, 점진적 전환 가능성 확보</td></tr></tbody></table><ul><li><p><strong>전자상거래 플랫폼</strong>은 높은 트래픽과 빠른 릴리즈 주기를 갖기 때문에, 모듈 단위로 기능을 분리하고 Outbox, CQRS 등으로 유연한 메시징 기반 확장을 구현하여 성능과 안정성을 동시에 확보함.</p></li><li><p><strong>기업 포털</strong>은 내부 조직 구조에 따라 사람, 조직, 게시판, 결재 등의 기능이 나뉘며, 팀 단위 관리가 용이하고 역할 기반 보안 정책을 적용할 수 있는 모듈러 구조가 효과적임.</p></li><li><p><strong>헬스케어 시스템</strong>은 환자 정보 보호, 의료법 규제 준수를 위한 보안 설계가 핵심이며, 모듈별로 접근 제어를 분리하고 감사 추적이 가능한 구조로 운영되어야 함.</p></li><li><p><strong>금융 서비스 플랫폼</strong>은 복잡한 트랜잭션과 이벤트 흐름이 존재하며, 데이터 일관성 및 트랜잭션 보장을 위해 Kafka 기반 메시징 및 Outbox 패턴과 함께 적용하는 사례가 많음.</p></li><li><p><strong>교육 플랫폼</strong>은 기능별로 강의, 학습자, 평가 시스템이 분리되어 있고, 학습 데이터를 모듈 단위로 관리하여 점진적인 개선 및 기능 독립성이 용이함.</p></li><li><p><strong>콘텐츠 플랫폼</strong>은 검색, 게시, 사용자 인터랙션 등 복잡한 흐름을 가지며, 워크플로우 및 상태 관리를 모듈 단위로 분리해 콘텐츠 처리 성능을 높임.</p></li><li><p><strong>전환 준비 구조</strong>는 초기에는 모놀리식으로 개발되지만, 모듈 경계를 명확히 하여 추후 마이크로서비스로의 자연스러운 전환이 가능하도록 설계되며, Clean Architecture 및 CQRS/Outbox 기반 패턴이 자주 활용됨.</p></li></ul><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><h4 id=사례-1-e--커머스-플랫폼>사례 1: E- 커머스 플랫폼<a hidden class=anchor aria-hidden=true href=#사례-1-e--커머스-플랫폼>#</a></h4><p><strong>시스템 구성:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────┐
</span></span><span class=line><span class=cl>│           API Gateway               │
</span></span><span class=line><span class=cl>├─────────────────────────────────────┤
</span></span><span class=line><span class=cl>│  ┌─────────┐  ┌─────────┐  ┌─────── │
</span></span><span class=line><span class=cl>│  │Product  │  │Order    │  │Payment │
</span></span><span class=line><span class=cl>│  │Module   │  │Module   │  │Module  │
</span></span><span class=line><span class=cl>│  └─────────┘  └─────────┘  └─────── │
</span></span><span class=line><span class=cl>│  ┌─────────┐  ┌─────────┐  ┌─────── │
</span></span><span class=line><span class=cl>│  │User     │  │Inventory│  │Shipping│
</span></span><span class=line><span class=cl>│  │Module   │  │Module   │  │Module  │
</span></span><span class=line><span class=cl>│  └─────────┘  └─────────┘  └─────── │
</span></span><span class=line><span class=cl>├─────────────────────────────────────┤
</span></span><span class=line><span class=cl>│           Event Bus                 │
</span></span><span class=line><span class=cl>├─────────────────────────────────────┤
</span></span><span class=line><span class=cl>│         Shared Kernel               │
</span></span><span class=line><span class=cl>└─────────────────────────────────────┘
</span></span></code></pre></td></tr></table></div></div><pre class=mermaid>graph TB
    subgraph &#34;E-Commerce Modular Monolith&#34;
        A[API Gateway] --&gt; B[Product Module]
        A --&gt; C[Order Module]
        A --&gt; D[Payment Module]
        A --&gt; E[User Module]
        A --&gt; F[Inventory Module]
        A --&gt; G[Shipping Module]
        
        H[Event Bus] --&gt; B
        H --&gt; C
        H --&gt; D
        H --&gt; E
        H --&gt; F
        H --&gt; G
        
        I[Shared Kernel] --&gt; B
        I --&gt; C
        I --&gt; D
        I --&gt; E
        I --&gt; F
        I --&gt; G
        
        B --&gt; J[(Product DB)]
        C --&gt; K[(Order DB)]
        D --&gt; L[(Payment DB)]
        E --&gt; M[(User DB)]
        F --&gt; N[(Inventory DB)]
        G --&gt; O[(Shipping DB)]
    end
</pre><p><strong>활용 사례 Workflow:</strong></p><pre class=mermaid>sequenceDiagram
    participant Customer
    participant API Gateway
    participant Product Module
    participant Order Module
    participant Payment Module
    participant Event Bus
    participant Inventory Module
    participant Shipping Module
    
    Customer-&gt;&gt;API Gateway: Browse Products
    API Gateway-&gt;&gt;Product Module: Get Product List
    Product Module--&gt;&gt;API Gateway: Product Data
    API Gateway--&gt;&gt;Customer: Product Catalog
    
    Customer-&gt;&gt;API Gateway: Create Order
    API Gateway-&gt;&gt;Order Module: Process Order
    Order Module-&gt;&gt;Event Bus: Publish OrderCreated Event
    Event Bus-&gt;&gt;Inventory Module: Update Stock
    Event Bus-&gt;&gt;Payment Module: Process Payment
    
    Payment Module-&gt;&gt;Event Bus: Publish PaymentProcessed Event
    Event Bus-&gt;&gt;Shipping Module: Prepare Shipment
    Event Bus-&gt;&gt;Order Module: Update Order Status
    
    Order Module--&gt;&gt;API Gateway: Order Confirmation
    API Gateway--&gt;&gt;Customer: Order Success
</pre><p><strong>역할 및 차이점:</strong></p><ul><li><strong>Product Module</strong>: 상품 카탈로그 관리, 가격 정책</li><li><strong>Order Module</strong>: 주문 생성, 상태 관리, 비즈니스 규칙</li><li><strong>Payment Module</strong>: 결제 처리, 환불, 정산</li><li><strong>Event Bus</strong>: 모듈 간 비동기 통신 중재</li><li><strong>차이점</strong>: 기존 모놀리틱 대비 모듈별 독립적 개발/테스트</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>  1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>  2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>  3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>  4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>  5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6>  6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7>  7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8>  8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9>  9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10> 10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11> 11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12> 12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13> 13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14> 14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15> 15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16> 16</a>
</span><span class=lnt id=hl-8-17><a class=lnlinks href=#hl-8-17> 17</a>
</span><span class=lnt id=hl-8-18><a class=lnlinks href=#hl-8-18> 18</a>
</span><span class=lnt id=hl-8-19><a class=lnlinks href=#hl-8-19> 19</a>
</span><span class=lnt id=hl-8-20><a class=lnlinks href=#hl-8-20> 20</a>
</span><span class=lnt id=hl-8-21><a class=lnlinks href=#hl-8-21> 21</a>
</span><span class=lnt id=hl-8-22><a class=lnlinks href=#hl-8-22> 22</a>
</span><span class=lnt id=hl-8-23><a class=lnlinks href=#hl-8-23> 23</a>
</span><span class=lnt id=hl-8-24><a class=lnlinks href=#hl-8-24> 24</a>
</span><span class=lnt id=hl-8-25><a class=lnlinks href=#hl-8-25> 25</a>
</span><span class=lnt id=hl-8-26><a class=lnlinks href=#hl-8-26> 26</a>
</span><span class=lnt id=hl-8-27><a class=lnlinks href=#hl-8-27> 27</a>
</span><span class=lnt id=hl-8-28><a class=lnlinks href=#hl-8-28> 28</a>
</span><span class=lnt id=hl-8-29><a class=lnlinks href=#hl-8-29> 29</a>
</span><span class=lnt id=hl-8-30><a class=lnlinks href=#hl-8-30> 30</a>
</span><span class=lnt id=hl-8-31><a class=lnlinks href=#hl-8-31> 31</a>
</span><span class=lnt id=hl-8-32><a class=lnlinks href=#hl-8-32> 32</a>
</span><span class=lnt id=hl-8-33><a class=lnlinks href=#hl-8-33> 33</a>
</span><span class=lnt id=hl-8-34><a class=lnlinks href=#hl-8-34> 34</a>
</span><span class=lnt id=hl-8-35><a class=lnlinks href=#hl-8-35> 35</a>
</span><span class=lnt id=hl-8-36><a class=lnlinks href=#hl-8-36> 36</a>
</span><span class=lnt id=hl-8-37><a class=lnlinks href=#hl-8-37> 37</a>
</span><span class=lnt id=hl-8-38><a class=lnlinks href=#hl-8-38> 38</a>
</span><span class=lnt id=hl-8-39><a class=lnlinks href=#hl-8-39> 39</a>
</span><span class=lnt id=hl-8-40><a class=lnlinks href=#hl-8-40> 40</a>
</span><span class=lnt id=hl-8-41><a class=lnlinks href=#hl-8-41> 41</a>
</span><span class=lnt id=hl-8-42><a class=lnlinks href=#hl-8-42> 42</a>
</span><span class=lnt id=hl-8-43><a class=lnlinks href=#hl-8-43> 43</a>
</span><span class=lnt id=hl-8-44><a class=lnlinks href=#hl-8-44> 44</a>
</span><span class=lnt id=hl-8-45><a class=lnlinks href=#hl-8-45> 45</a>
</span><span class=lnt id=hl-8-46><a class=lnlinks href=#hl-8-46> 46</a>
</span><span class=lnt id=hl-8-47><a class=lnlinks href=#hl-8-47> 47</a>
</span><span class=lnt id=hl-8-48><a class=lnlinks href=#hl-8-48> 48</a>
</span><span class=lnt id=hl-8-49><a class=lnlinks href=#hl-8-49> 49</a>
</span><span class=lnt id=hl-8-50><a class=lnlinks href=#hl-8-50> 50</a>
</span><span class=lnt id=hl-8-51><a class=lnlinks href=#hl-8-51> 51</a>
</span><span class=lnt id=hl-8-52><a class=lnlinks href=#hl-8-52> 52</a>
</span><span class=lnt id=hl-8-53><a class=lnlinks href=#hl-8-53> 53</a>
</span><span class=lnt id=hl-8-54><a class=lnlinks href=#hl-8-54> 54</a>
</span><span class=lnt id=hl-8-55><a class=lnlinks href=#hl-8-55> 55</a>
</span><span class=lnt id=hl-8-56><a class=lnlinks href=#hl-8-56> 56</a>
</span><span class=lnt id=hl-8-57><a class=lnlinks href=#hl-8-57> 57</a>
</span><span class=lnt id=hl-8-58><a class=lnlinks href=#hl-8-58> 58</a>
</span><span class=lnt id=hl-8-59><a class=lnlinks href=#hl-8-59> 59</a>
</span><span class=lnt id=hl-8-60><a class=lnlinks href=#hl-8-60> 60</a>
</span><span class=lnt id=hl-8-61><a class=lnlinks href=#hl-8-61> 61</a>
</span><span class=lnt id=hl-8-62><a class=lnlinks href=#hl-8-62> 62</a>
</span><span class=lnt id=hl-8-63><a class=lnlinks href=#hl-8-63> 63</a>
</span><span class=lnt id=hl-8-64><a class=lnlinks href=#hl-8-64> 64</a>
</span><span class=lnt id=hl-8-65><a class=lnlinks href=#hl-8-65> 65</a>
</span><span class=lnt id=hl-8-66><a class=lnlinks href=#hl-8-66> 66</a>
</span><span class=lnt id=hl-8-67><a class=lnlinks href=#hl-8-67> 67</a>
</span><span class=lnt id=hl-8-68><a class=lnlinks href=#hl-8-68> 68</a>
</span><span class=lnt id=hl-8-69><a class=lnlinks href=#hl-8-69> 69</a>
</span><span class=lnt id=hl-8-70><a class=lnlinks href=#hl-8-70> 70</a>
</span><span class=lnt id=hl-8-71><a class=lnlinks href=#hl-8-71> 71</a>
</span><span class=lnt id=hl-8-72><a class=lnlinks href=#hl-8-72> 72</a>
</span><span class=lnt id=hl-8-73><a class=lnlinks href=#hl-8-73> 73</a>
</span><span class=lnt id=hl-8-74><a class=lnlinks href=#hl-8-74> 74</a>
</span><span class=lnt id=hl-8-75><a class=lnlinks href=#hl-8-75> 75</a>
</span><span class=lnt id=hl-8-76><a class=lnlinks href=#hl-8-76> 76</a>
</span><span class=lnt id=hl-8-77><a class=lnlinks href=#hl-8-77> 77</a>
</span><span class=lnt id=hl-8-78><a class=lnlinks href=#hl-8-78> 78</a>
</span><span class=lnt id=hl-8-79><a class=lnlinks href=#hl-8-79> 79</a>
</span><span class=lnt id=hl-8-80><a class=lnlinks href=#hl-8-80> 80</a>
</span><span class=lnt id=hl-8-81><a class=lnlinks href=#hl-8-81> 81</a>
</span><span class=lnt id=hl-8-82><a class=lnlinks href=#hl-8-82> 82</a>
</span><span class=lnt id=hl-8-83><a class=lnlinks href=#hl-8-83> 83</a>
</span><span class=lnt id=hl-8-84><a class=lnlinks href=#hl-8-84> 84</a>
</span><span class=lnt id=hl-8-85><a class=lnlinks href=#hl-8-85> 85</a>
</span><span class=lnt id=hl-8-86><a class=lnlinks href=#hl-8-86> 86</a>
</span><span class=lnt id=hl-8-87><a class=lnlinks href=#hl-8-87> 87</a>
</span><span class=lnt id=hl-8-88><a class=lnlinks href=#hl-8-88> 88</a>
</span><span class=lnt id=hl-8-89><a class=lnlinks href=#hl-8-89> 89</a>
</span><span class=lnt id=hl-8-90><a class=lnlinks href=#hl-8-90> 90</a>
</span><span class=lnt id=hl-8-91><a class=lnlinks href=#hl-8-91> 91</a>
</span><span class=lnt id=hl-8-92><a class=lnlinks href=#hl-8-92> 92</a>
</span><span class=lnt id=hl-8-93><a class=lnlinks href=#hl-8-93> 93</a>
</span><span class=lnt id=hl-8-94><a class=lnlinks href=#hl-8-94> 94</a>
</span><span class=lnt id=hl-8-95><a class=lnlinks href=#hl-8-95> 95</a>
</span><span class=lnt id=hl-8-96><a class=lnlinks href=#hl-8-96> 96</a>
</span><span class=lnt id=hl-8-97><a class=lnlinks href=#hl-8-97> 97</a>
</span><span class=lnt id=hl-8-98><a class=lnlinks href=#hl-8-98> 98</a>
</span><span class=lnt id=hl-8-99><a class=lnlinks href=#hl-8-99> 99</a>
</span><span class=lnt id=hl-8-100><a class=lnlinks href=#hl-8-100>100</a>
</span><span class=lnt id=hl-8-101><a class=lnlinks href=#hl-8-101>101</a>
</span><span class=lnt id=hl-8-102><a class=lnlinks href=#hl-8-102>102</a>
</span><span class=lnt id=hl-8-103><a class=lnlinks href=#hl-8-103>103</a>
</span><span class=lnt id=hl-8-104><a class=lnlinks href=#hl-8-104>104</a>
</span><span class=lnt id=hl-8-105><a class=lnlinks href=#hl-8-105>105</a>
</span><span class=lnt id=hl-8-106><a class=lnlinks href=#hl-8-106>106</a>
</span><span class=lnt id=hl-8-107><a class=lnlinks href=#hl-8-107>107</a>
</span><span class=lnt id=hl-8-108><a class=lnlinks href=#hl-8-108>108</a>
</span><span class=lnt id=hl-8-109><a class=lnlinks href=#hl-8-109>109</a>
</span><span class=lnt id=hl-8-110><a class=lnlinks href=#hl-8-110>110</a>
</span><span class=lnt id=hl-8-111><a class=lnlinks href=#hl-8-111>111</a>
</span><span class=lnt id=hl-8-112><a class=lnlinks href=#hl-8-112>112</a>
</span><span class=lnt id=hl-8-113><a class=lnlinks href=#hl-8-113>113</a>
</span><span class=lnt id=hl-8-114><a class=lnlinks href=#hl-8-114>114</a>
</span><span class=lnt id=hl-8-115><a class=lnlinks href=#hl-8-115>115</a>
</span><span class=lnt id=hl-8-116><a class=lnlinks href=#hl-8-116>116</a>
</span><span class=lnt id=hl-8-117><a class=lnlinks href=#hl-8-117>117</a>
</span><span class=lnt id=hl-8-118><a class=lnlinks href=#hl-8-118>118</a>
</span><span class=lnt id=hl-8-119><a class=lnlinks href=#hl-8-119>119</a>
</span><span class=lnt id=hl-8-120><a class=lnlinks href=#hl-8-120>120</a>
</span><span class=lnt id=hl-8-121><a class=lnlinks href=#hl-8-121>121</a>
</span><span class=lnt id=hl-8-122><a class=lnlinks href=#hl-8-122>122</a>
</span><span class=lnt id=hl-8-123><a class=lnlinks href=#hl-8-123>123</a>
</span><span class=lnt id=hl-8-124><a class=lnlinks href=#hl-8-124>124</a>
</span><span class=lnt id=hl-8-125><a class=lnlinks href=#hl-8-125>125</a>
</span><span class=lnt id=hl-8-126><a class=lnlinks href=#hl-8-126>126</a>
</span><span class=lnt id=hl-8-127><a class=lnlinks href=#hl-8-127>127</a>
</span><span class=lnt id=hl-8-128><a class=lnlinks href=#hl-8-128>128</a>
</span><span class=lnt id=hl-8-129><a class=lnlinks href=#hl-8-129>129</a>
</span><span class=lnt id=hl-8-130><a class=lnlinks href=#hl-8-130>130</a>
</span><span class=lnt id=hl-8-131><a class=lnlinks href=#hl-8-131>131</a>
</span><span class=lnt id=hl-8-132><a class=lnlinks href=#hl-8-132>132</a>
</span><span class=lnt id=hl-8-133><a class=lnlinks href=#hl-8-133>133</a>
</span><span class=lnt id=hl-8-134><a class=lnlinks href=#hl-8-134>134</a>
</span><span class=lnt id=hl-8-135><a class=lnlinks href=#hl-8-135>135</a>
</span><span class=lnt id=hl-8-136><a class=lnlinks href=#hl-8-136>136</a>
</span><span class=lnt id=hl-8-137><a class=lnlinks href=#hl-8-137>137</a>
</span><span class=lnt id=hl-8-138><a class=lnlinks href=#hl-8-138>138</a>
</span><span class=lnt id=hl-8-139><a class=lnlinks href=#hl-8-139>139</a>
</span><span class=lnt id=hl-8-140><a class=lnlinks href=#hl-8-140>140</a>
</span><span class=lnt id=hl-8-141><a class=lnlinks href=#hl-8-141>141</a>
</span><span class=lnt id=hl-8-142><a class=lnlinks href=#hl-8-142>142</a>
</span><span class=lnt id=hl-8-143><a class=lnlinks href=#hl-8-143>143</a>
</span><span class=lnt id=hl-8-144><a class=lnlinks href=#hl-8-144>144</a>
</span><span class=lnt id=hl-8-145><a class=lnlinks href=#hl-8-145>145</a>
</span><span class=lnt id=hl-8-146><a class=lnlinks href=#hl-8-146>146</a>
</span><span class=lnt id=hl-8-147><a class=lnlinks href=#hl-8-147>147</a>
</span><span class=lnt id=hl-8-148><a class=lnlinks href=#hl-8-148>148</a>
</span><span class=lnt id=hl-8-149><a class=lnlinks href=#hl-8-149>149</a>
</span><span class=lnt id=hl-8-150><a class=lnlinks href=#hl-8-150>150</a>
</span><span class=lnt id=hl-8-151><a class=lnlinks href=#hl-8-151>151</a>
</span><span class=lnt id=hl-8-152><a class=lnlinks href=#hl-8-152>152</a>
</span><span class=lnt id=hl-8-153><a class=lnlinks href=#hl-8-153>153</a>
</span><span class=lnt id=hl-8-154><a class=lnlinks href=#hl-8-154>154</a>
</span><span class=lnt id=hl-8-155><a class=lnlinks href=#hl-8-155>155</a>
</span><span class=lnt id=hl-8-156><a class=lnlinks href=#hl-8-156>156</a>
</span><span class=lnt id=hl-8-157><a class=lnlinks href=#hl-8-157>157</a>
</span><span class=lnt id=hl-8-158><a class=lnlinks href=#hl-8-158>158</a>
</span><span class=lnt id=hl-8-159><a class=lnlinks href=#hl-8-159>159</a>
</span><span class=lnt id=hl-8-160><a class=lnlinks href=#hl-8-160>160</a>
</span><span class=lnt id=hl-8-161><a class=lnlinks href=#hl-8-161>161</a>
</span><span class=lnt id=hl-8-162><a class=lnlinks href=#hl-8-162>162</a>
</span><span class=lnt id=hl-8-163><a class=lnlinks href=#hl-8-163>163</a>
</span><span class=lnt id=hl-8-164><a class=lnlinks href=#hl-8-164>164</a>
</span><span class=lnt id=hl-8-165><a class=lnlinks href=#hl-8-165>165</a>
</span><span class=lnt id=hl-8-166><a class=lnlinks href=#hl-8-166>166</a>
</span><span class=lnt id=hl-8-167><a class=lnlinks href=#hl-8-167>167</a>
</span><span class=lnt id=hl-8-168><a class=lnlinks href=#hl-8-168>168</a>
</span><span class=lnt id=hl-8-169><a class=lnlinks href=#hl-8-169>169</a>
</span><span class=lnt id=hl-8-170><a class=lnlinks href=#hl-8-170>170</a>
</span><span class=lnt id=hl-8-171><a class=lnlinks href=#hl-8-171>171</a>
</span><span class=lnt id=hl-8-172><a class=lnlinks href=#hl-8-172>172</a>
</span><span class=lnt id=hl-8-173><a class=lnlinks href=#hl-8-173>173</a>
</span><span class=lnt id=hl-8-174><a class=lnlinks href=#hl-8-174>174</a>
</span><span class=lnt id=hl-8-175><a class=lnlinks href=#hl-8-175>175</a>
</span><span class=lnt id=hl-8-176><a class=lnlinks href=#hl-8-176>176</a>
</span><span class=lnt id=hl-8-177><a class=lnlinks href=#hl-8-177>177</a>
</span><span class=lnt id=hl-8-178><a class=lnlinks href=#hl-8-178>178</a>
</span><span class=lnt id=hl-8-179><a class=lnlinks href=#hl-8-179>179</a>
</span><span class=lnt id=hl-8-180><a class=lnlinks href=#hl-8-180>180</a>
</span><span class=lnt id=hl-8-181><a class=lnlinks href=#hl-8-181>181</a>
</span><span class=lnt id=hl-8-182><a class=lnlinks href=#hl-8-182>182</a>
</span><span class=lnt id=hl-8-183><a class=lnlinks href=#hl-8-183>183</a>
</span><span class=lnt id=hl-8-184><a class=lnlinks href=#hl-8-184>184</a>
</span><span class=lnt id=hl-8-185><a class=lnlinks href=#hl-8-185>185</a>
</span><span class=lnt id=hl-8-186><a class=lnlinks href=#hl-8-186>186</a>
</span><span class=lnt id=hl-8-187><a class=lnlinks href=#hl-8-187>187</a>
</span><span class=lnt id=hl-8-188><a class=lnlinks href=#hl-8-188>188</a>
</span><span class=lnt id=hl-8-189><a class=lnlinks href=#hl-8-189>189</a>
</span><span class=lnt id=hl-8-190><a class=lnlinks href=#hl-8-190>190</a>
</span><span class=lnt id=hl-8-191><a class=lnlinks href=#hl-8-191>191</a>
</span><span class=lnt id=hl-8-192><a class=lnlinks href=#hl-8-192>192</a>
</span><span class=lnt id=hl-8-193><a class=lnlinks href=#hl-8-193>193</a>
</span><span class=lnt id=hl-8-194><a class=lnlinks href=#hl-8-194>194</a>
</span><span class=lnt id=hl-8-195><a class=lnlinks href=#hl-8-195>195</a>
</span><span class=lnt id=hl-8-196><a class=lnlinks href=#hl-8-196>196</a>
</span><span class=lnt id=hl-8-197><a class=lnlinks href=#hl-8-197>197</a>
</span><span class=lnt id=hl-8-198><a class=lnlinks href=#hl-8-198>198</a>
</span><span class=lnt id=hl-8-199><a class=lnlinks href=#hl-8-199>199</a>
</span><span class=lnt id=hl-8-200><a class=lnlinks href=#hl-8-200>200</a>
</span><span class=lnt id=hl-8-201><a class=lnlinks href=#hl-8-201>201</a>
</span><span class=lnt id=hl-8-202><a class=lnlinks href=#hl-8-202>202</a>
</span><span class=lnt id=hl-8-203><a class=lnlinks href=#hl-8-203>203</a>
</span><span class=lnt id=hl-8-204><a class=lnlinks href=#hl-8-204>204</a>
</span><span class=lnt id=hl-8-205><a class=lnlinks href=#hl-8-205>205</a>
</span><span class=lnt id=hl-8-206><a class=lnlinks href=#hl-8-206>206</a>
</span><span class=lnt id=hl-8-207><a class=lnlinks href=#hl-8-207>207</a>
</span><span class=lnt id=hl-8-208><a class=lnlinks href=#hl-8-208>208</a>
</span><span class=lnt id=hl-8-209><a class=lnlinks href=#hl-8-209>209</a>
</span><span class=lnt id=hl-8-210><a class=lnlinks href=#hl-8-210>210</a>
</span><span class=lnt id=hl-8-211><a class=lnlinks href=#hl-8-211>211</a>
</span><span class=lnt id=hl-8-212><a class=lnlinks href=#hl-8-212>212</a>
</span><span class=lnt id=hl-8-213><a class=lnlinks href=#hl-8-213>213</a>
</span><span class=lnt id=hl-8-214><a class=lnlinks href=#hl-8-214>214</a>
</span><span class=lnt id=hl-8-215><a class=lnlinks href=#hl-8-215>215</a>
</span><span class=lnt id=hl-8-216><a class=lnlinks href=#hl-8-216>216</a>
</span><span class=lnt id=hl-8-217><a class=lnlinks href=#hl-8-217>217</a>
</span><span class=lnt id=hl-8-218><a class=lnlinks href=#hl-8-218>218</a>
</span><span class=lnt id=hl-8-219><a class=lnlinks href=#hl-8-219>219</a>
</span><span class=lnt id=hl-8-220><a class=lnlinks href=#hl-8-220>220</a>
</span><span class=lnt id=hl-8-221><a class=lnlinks href=#hl-8-221>221</a>
</span><span class=lnt id=hl-8-222><a class=lnlinks href=#hl-8-222>222</a>
</span><span class=lnt id=hl-8-223><a class=lnlinks href=#hl-8-223>223</a>
</span><span class=lnt id=hl-8-224><a class=lnlinks href=#hl-8-224>224</a>
</span><span class=lnt id=hl-8-225><a class=lnlinks href=#hl-8-225>225</a>
</span><span class=lnt id=hl-8-226><a class=lnlinks href=#hl-8-226>226</a>
</span><span class=lnt id=hl-8-227><a class=lnlinks href=#hl-8-227>227</a>
</span><span class=lnt id=hl-8-228><a class=lnlinks href=#hl-8-228>228</a>
</span><span class=lnt id=hl-8-229><a class=lnlinks href=#hl-8-229>229</a>
</span><span class=lnt id=hl-8-230><a class=lnlinks href=#hl-8-230>230</a>
</span><span class=lnt id=hl-8-231><a class=lnlinks href=#hl-8-231>231</a>
</span><span class=lnt id=hl-8-232><a class=lnlinks href=#hl-8-232>232</a>
</span><span class=lnt id=hl-8-233><a class=lnlinks href=#hl-8-233>233</a>
</span><span class=lnt id=hl-8-234><a class=lnlinks href=#hl-8-234>234</a>
</span><span class=lnt id=hl-8-235><a class=lnlinks href=#hl-8-235>235</a>
</span><span class=lnt id=hl-8-236><a class=lnlinks href=#hl-8-236>236</a>
</span><span class=lnt id=hl-8-237><a class=lnlinks href=#hl-8-237>237</a>
</span><span class=lnt id=hl-8-238><a class=lnlinks href=#hl-8-238>238</a>
</span><span class=lnt id=hl-8-239><a class=lnlinks href=#hl-8-239>239</a>
</span><span class=lnt id=hl-8-240><a class=lnlinks href=#hl-8-240>240</a>
</span><span class=lnt id=hl-8-241><a class=lnlinks href=#hl-8-241>241</a>
</span><span class=lnt id=hl-8-242><a class=lnlinks href=#hl-8-242>242</a>
</span><span class=lnt id=hl-8-243><a class=lnlinks href=#hl-8-243>243</a>
</span><span class=lnt id=hl-8-244><a class=lnlinks href=#hl-8-244>244</a>
</span><span class=lnt id=hl-8-245><a class=lnlinks href=#hl-8-245>245</a>
</span><span class=lnt id=hl-8-246><a class=lnlinks href=#hl-8-246>246</a>
</span><span class=lnt id=hl-8-247><a class=lnlinks href=#hl-8-247>247</a>
</span><span class=lnt id=hl-8-248><a class=lnlinks href=#hl-8-248>248</a>
</span><span class=lnt id=hl-8-249><a class=lnlinks href=#hl-8-249>249</a>
</span><span class=lnt id=hl-8-250><a class=lnlinks href=#hl-8-250>250</a>
</span><span class=lnt id=hl-8-251><a class=lnlinks href=#hl-8-251>251</a>
</span><span class=lnt id=hl-8-252><a class=lnlinks href=#hl-8-252>252</a>
</span><span class=lnt id=hl-8-253><a class=lnlinks href=#hl-8-253>253</a>
</span><span class=lnt id=hl-8-254><a class=lnlinks href=#hl-8-254>254</a>
</span><span class=lnt id=hl-8-255><a class=lnlinks href=#hl-8-255>255</a>
</span><span class=lnt id=hl-8-256><a class=lnlinks href=#hl-8-256>256</a>
</span><span class=lnt id=hl-8-257><a class=lnlinks href=#hl-8-257>257</a>
</span><span class=lnt id=hl-8-258><a class=lnlinks href=#hl-8-258>258</a>
</span><span class=lnt id=hl-8-259><a class=lnlinks href=#hl-8-259>259</a>
</span><span class=lnt id=hl-8-260><a class=lnlinks href=#hl-8-260>260</a>
</span><span class=lnt id=hl-8-261><a class=lnlinks href=#hl-8-261>261</a>
</span><span class=lnt id=hl-8-262><a class=lnlinks href=#hl-8-262>262</a>
</span><span class=lnt id=hl-8-263><a class=lnlinks href=#hl-8-263>263</a>
</span><span class=lnt id=hl-8-264><a class=lnlinks href=#hl-8-264>264</a>
</span><span class=lnt id=hl-8-265><a class=lnlinks href=#hl-8-265>265</a>
</span><span class=lnt id=hl-8-266><a class=lnlinks href=#hl-8-266>266</a>
</span><span class=lnt id=hl-8-267><a class=lnlinks href=#hl-8-267>267</a>
</span><span class=lnt id=hl-8-268><a class=lnlinks href=#hl-8-268>268</a>
</span><span class=lnt id=hl-8-269><a class=lnlinks href=#hl-8-269>269</a>
</span><span class=lnt id=hl-8-270><a class=lnlinks href=#hl-8-270>270</a>
</span><span class=lnt id=hl-8-271><a class=lnlinks href=#hl-8-271>271</a>
</span><span class=lnt id=hl-8-272><a class=lnlinks href=#hl-8-272>272</a>
</span><span class=lnt id=hl-8-273><a class=lnlinks href=#hl-8-273>273</a>
</span><span class=lnt id=hl-8-274><a class=lnlinks href=#hl-8-274>274</a>
</span><span class=lnt id=hl-8-275><a class=lnlinks href=#hl-8-275>275</a>
</span><span class=lnt id=hl-8-276><a class=lnlinks href=#hl-8-276>276</a>
</span><span class=lnt id=hl-8-277><a class=lnlinks href=#hl-8-277>277</a>
</span><span class=lnt id=hl-8-278><a class=lnlinks href=#hl-8-278>278</a>
</span><span class=lnt id=hl-8-279><a class=lnlinks href=#hl-8-279>279</a>
</span><span class=lnt id=hl-8-280><a class=lnlinks href=#hl-8-280>280</a>
</span><span class=lnt id=hl-8-281><a class=lnlinks href=#hl-8-281>281</a>
</span><span class=lnt id=hl-8-282><a class=lnlinks href=#hl-8-282>282</a>
</span><span class=lnt id=hl-8-283><a class=lnlinks href=#hl-8-283>283</a>
</span><span class=lnt id=hl-8-284><a class=lnlinks href=#hl-8-284>284</a>
</span><span class=lnt id=hl-8-285><a class=lnlinks href=#hl-8-285>285</a>
</span><span class=lnt id=hl-8-286><a class=lnlinks href=#hl-8-286>286</a>
</span><span class=lnt id=hl-8-287><a class=lnlinks href=#hl-8-287>287</a>
</span><span class=lnt id=hl-8-288><a class=lnlinks href=#hl-8-288>288</a>
</span><span class=lnt id=hl-8-289><a class=lnlinks href=#hl-8-289>289</a>
</span><span class=lnt id=hl-8-290><a class=lnlinks href=#hl-8-290>290</a>
</span><span class=lnt id=hl-8-291><a class=lnlinks href=#hl-8-291>291</a>
</span><span class=lnt id=hl-8-292><a class=lnlinks href=#hl-8-292>292</a>
</span><span class=lnt id=hl-8-293><a class=lnlinks href=#hl-8-293>293</a>
</span><span class=lnt id=hl-8-294><a class=lnlinks href=#hl-8-294>294</a>
</span><span class=lnt id=hl-8-295><a class=lnlinks href=#hl-8-295>295</a>
</span><span class=lnt id=hl-8-296><a class=lnlinks href=#hl-8-296>296</a>
</span><span class=lnt id=hl-8-297><a class=lnlinks href=#hl-8-297>297</a>
</span><span class=lnt id=hl-8-298><a class=lnlinks href=#hl-8-298>298</a>
</span><span class=lnt id=hl-8-299><a class=lnlinks href=#hl-8-299>299</a>
</span><span class=lnt id=hl-8-300><a class=lnlinks href=#hl-8-300>300</a>
</span><span class=lnt id=hl-8-301><a class=lnlinks href=#hl-8-301>301</a>
</span><span class=lnt id=hl-8-302><a class=lnlinks href=#hl-8-302>302</a>
</span><span class=lnt id=hl-8-303><a class=lnlinks href=#hl-8-303>303</a>
</span><span class=lnt id=hl-8-304><a class=lnlinks href=#hl-8-304>304</a>
</span><span class=lnt id=hl-8-305><a class=lnlinks href=#hl-8-305>305</a>
</span><span class=lnt id=hl-8-306><a class=lnlinks href=#hl-8-306>306</a>
</span><span class=lnt id=hl-8-307><a class=lnlinks href=#hl-8-307>307</a>
</span><span class=lnt id=hl-8-308><a class=lnlinks href=#hl-8-308>308</a>
</span><span class=lnt id=hl-8-309><a class=lnlinks href=#hl-8-309>309</a>
</span><span class=lnt id=hl-8-310><a class=lnlinks href=#hl-8-310>310</a>
</span><span class=lnt id=hl-8-311><a class=lnlinks href=#hl-8-311>311</a>
</span><span class=lnt id=hl-8-312><a class=lnlinks href=#hl-8-312>312</a>
</span><span class=lnt id=hl-8-313><a class=lnlinks href=#hl-8-313>313</a>
</span><span class=lnt id=hl-8-314><a class=lnlinks href=#hl-8-314>314</a>
</span><span class=lnt id=hl-8-315><a class=lnlinks href=#hl-8-315>315</a>
</span><span class=lnt id=hl-8-316><a class=lnlinks href=#hl-8-316>316</a>
</span><span class=lnt id=hl-8-317><a class=lnlinks href=#hl-8-317>317</a>
</span><span class=lnt id=hl-8-318><a class=lnlinks href=#hl-8-318>318</a>
</span><span class=lnt id=hl-8-319><a class=lnlinks href=#hl-8-319>319</a>
</span><span class=lnt id=hl-8-320><a class=lnlinks href=#hl-8-320>320</a>
</span><span class=lnt id=hl-8-321><a class=lnlinks href=#hl-8-321>321</a>
</span><span class=lnt id=hl-8-322><a class=lnlinks href=#hl-8-322>322</a>
</span><span class=lnt id=hl-8-323><a class=lnlinks href=#hl-8-323>323</a>
</span><span class=lnt id=hl-8-324><a class=lnlinks href=#hl-8-324>324</a>
</span><span class=lnt id=hl-8-325><a class=lnlinks href=#hl-8-325>325</a>
</span><span class=lnt id=hl-8-326><a class=lnlinks href=#hl-8-326>326</a>
</span><span class=lnt id=hl-8-327><a class=lnlinks href=#hl-8-327>327</a>
</span><span class=lnt id=hl-8-328><a class=lnlinks href=#hl-8-328>328</a>
</span><span class=lnt id=hl-8-329><a class=lnlinks href=#hl-8-329>329</a>
</span><span class=lnt id=hl-8-330><a class=lnlinks href=#hl-8-330>330</a>
</span><span class=lnt id=hl-8-331><a class=lnlinks href=#hl-8-331>331</a>
</span><span class=lnt id=hl-8-332><a class=lnlinks href=#hl-8-332>332</a>
</span><span class=lnt id=hl-8-333><a class=lnlinks href=#hl-8-333>333</a>
</span><span class=lnt id=hl-8-334><a class=lnlinks href=#hl-8-334>334</a>
</span><span class=lnt id=hl-8-335><a class=lnlinks href=#hl-8-335>335</a>
</span><span class=lnt id=hl-8-336><a class=lnlinks href=#hl-8-336>336</a>
</span><span class=lnt id=hl-8-337><a class=lnlinks href=#hl-8-337>337</a>
</span><span class=lnt id=hl-8-338><a class=lnlinks href=#hl-8-338>338</a>
</span><span class=lnt id=hl-8-339><a class=lnlinks href=#hl-8-339>339</a>
</span><span class=lnt id=hl-8-340><a class=lnlinks href=#hl-8-340>340</a>
</span><span class=lnt id=hl-8-341><a class=lnlinks href=#hl-8-341>341</a>
</span><span class=lnt id=hl-8-342><a class=lnlinks href=#hl-8-342>342</a>
</span><span class=lnt id=hl-8-343><a class=lnlinks href=#hl-8-343>343</a>
</span><span class=lnt id=hl-8-344><a class=lnlinks href=#hl-8-344>344</a>
</span><span class=lnt id=hl-8-345><a class=lnlinks href=#hl-8-345>345</a>
</span><span class=lnt id=hl-8-346><a class=lnlinks href=#hl-8-346>346</a>
</span><span class=lnt id=hl-8-347><a class=lnlinks href=#hl-8-347>347</a>
</span><span class=lnt id=hl-8-348><a class=lnlinks href=#hl-8-348>348</a>
</span><span class=lnt id=hl-8-349><a class=lnlinks href=#hl-8-349>349</a>
</span><span class=lnt id=hl-8-350><a class=lnlinks href=#hl-8-350>350</a>
</span><span class=lnt id=hl-8-351><a class=lnlinks href=#hl-8-351>351</a>
</span><span class=lnt id=hl-8-352><a class=lnlinks href=#hl-8-352>352</a>
</span><span class=lnt id=hl-8-353><a class=lnlinks href=#hl-8-353>353</a>
</span><span class=lnt id=hl-8-354><a class=lnlinks href=#hl-8-354>354</a>
</span><span class=lnt id=hl-8-355><a class=lnlinks href=#hl-8-355>355</a>
</span><span class=lnt id=hl-8-356><a class=lnlinks href=#hl-8-356>356</a>
</span><span class=lnt id=hl-8-357><a class=lnlinks href=#hl-8-357>357</a>
</span><span class=lnt id=hl-8-358><a class=lnlinks href=#hl-8-358>358</a>
</span><span class=lnt id=hl-8-359><a class=lnlinks href=#hl-8-359>359</a>
</span><span class=lnt id=hl-8-360><a class=lnlinks href=#hl-8-360>360</a>
</span><span class=lnt id=hl-8-361><a class=lnlinks href=#hl-8-361>361</a>
</span><span class=lnt id=hl-8-362><a class=lnlinks href=#hl-8-362>362</a>
</span><span class=lnt id=hl-8-363><a class=lnlinks href=#hl-8-363>363</a>
</span><span class=lnt id=hl-8-364><a class=lnlinks href=#hl-8-364>364</a>
</span><span class=lnt id=hl-8-365><a class=lnlinks href=#hl-8-365>365</a>
</span><span class=lnt id=hl-8-366><a class=lnlinks href=#hl-8-366>366</a>
</span><span class=lnt id=hl-8-367><a class=lnlinks href=#hl-8-367>367</a>
</span><span class=lnt id=hl-8-368><a class=lnlinks href=#hl-8-368>368</a>
</span><span class=lnt id=hl-8-369><a class=lnlinks href=#hl-8-369>369</a>
</span><span class=lnt id=hl-8-370><a class=lnlinks href=#hl-8-370>370</a>
</span><span class=lnt id=hl-8-371><a class=lnlinks href=#hl-8-371>371</a>
</span><span class=lnt id=hl-8-372><a class=lnlinks href=#hl-8-372>372</a>
</span><span class=lnt id=hl-8-373><a class=lnlinks href=#hl-8-373>373</a>
</span><span class=lnt id=hl-8-374><a class=lnlinks href=#hl-8-374>374</a>
</span><span class=lnt id=hl-8-375><a class=lnlinks href=#hl-8-375>375</a>
</span><span class=lnt id=hl-8-376><a class=lnlinks href=#hl-8-376>376</a>
</span><span class=lnt id=hl-8-377><a class=lnlinks href=#hl-8-377>377</a>
</span><span class=lnt id=hl-8-378><a class=lnlinks href=#hl-8-378>378</a>
</span><span class=lnt id=hl-8-379><a class=lnlinks href=#hl-8-379>379</a>
</span><span class=lnt id=hl-8-380><a class=lnlinks href=#hl-8-380>380</a>
</span><span class=lnt id=hl-8-381><a class=lnlinks href=#hl-8-381>381</a>
</span><span class=lnt id=hl-8-382><a class=lnlinks href=#hl-8-382>382</a>
</span><span class=lnt id=hl-8-383><a class=lnlinks href=#hl-8-383>383</a>
</span><span class=lnt id=hl-8-384><a class=lnlinks href=#hl-8-384>384</a>
</span><span class=lnt id=hl-8-385><a class=lnlinks href=#hl-8-385>385</a>
</span><span class=lnt id=hl-8-386><a class=lnlinks href=#hl-8-386>386</a>
</span><span class=lnt id=hl-8-387><a class=lnlinks href=#hl-8-387>387</a>
</span><span class=lnt id=hl-8-388><a class=lnlinks href=#hl-8-388>388</a>
</span><span class=lnt id=hl-8-389><a class=lnlinks href=#hl-8-389>389</a>
</span><span class=lnt id=hl-8-390><a class=lnlinks href=#hl-8-390>390</a>
</span><span class=lnt id=hl-8-391><a class=lnlinks href=#hl-8-391>391</a>
</span><span class=lnt id=hl-8-392><a class=lnlinks href=#hl-8-392>392</a>
</span><span class=lnt id=hl-8-393><a class=lnlinks href=#hl-8-393>393</a>
</span><span class=lnt id=hl-8-394><a class=lnlinks href=#hl-8-394>394</a>
</span><span class=lnt id=hl-8-395><a class=lnlinks href=#hl-8-395>395</a>
</span><span class=lnt id=hl-8-396><a class=lnlinks href=#hl-8-396>396</a>
</span><span class=lnt id=hl-8-397><a class=lnlinks href=#hl-8-397>397</a>
</span><span class=lnt id=hl-8-398><a class=lnlinks href=#hl-8-398>398</a>
</span><span class=lnt id=hl-8-399><a class=lnlinks href=#hl-8-399>399</a>
</span><span class=lnt id=hl-8-400><a class=lnlinks href=#hl-8-400>400</a>
</span><span class=lnt id=hl-8-401><a class=lnlinks href=#hl-8-401>401</a>
</span><span class=lnt id=hl-8-402><a class=lnlinks href=#hl-8-402>402</a>
</span><span class=lnt id=hl-8-403><a class=lnlinks href=#hl-8-403>403</a>
</span><span class=lnt id=hl-8-404><a class=lnlinks href=#hl-8-404>404</a>
</span><span class=lnt id=hl-8-405><a class=lnlinks href=#hl-8-405>405</a>
</span><span class=lnt id=hl-8-406><a class=lnlinks href=#hl-8-406>406</a>
</span><span class=lnt id=hl-8-407><a class=lnlinks href=#hl-8-407>407</a>
</span><span class=lnt id=hl-8-408><a class=lnlinks href=#hl-8-408>408</a>
</span><span class=lnt id=hl-8-409><a class=lnlinks href=#hl-8-409>409</a>
</span><span class=lnt id=hl-8-410><a class=lnlinks href=#hl-8-410>410</a>
</span><span class=lnt id=hl-8-411><a class=lnlinks href=#hl-8-411>411</a>
</span><span class=lnt id=hl-8-412><a class=lnlinks href=#hl-8-412>412</a>
</span><span class=lnt id=hl-8-413><a class=lnlinks href=#hl-8-413>413</a>
</span><span class=lnt id=hl-8-414><a class=lnlinks href=#hl-8-414>414</a>
</span><span class=lnt id=hl-8-415><a class=lnlinks href=#hl-8-415>415</a>
</span><span class=lnt id=hl-8-416><a class=lnlinks href=#hl-8-416>416</a>
</span><span class=lnt id=hl-8-417><a class=lnlinks href=#hl-8-417>417</a>
</span><span class=lnt id=hl-8-418><a class=lnlinks href=#hl-8-418>418</a>
</span><span class=lnt id=hl-8-419><a class=lnlinks href=#hl-8-419>419</a>
</span><span class=lnt id=hl-8-420><a class=lnlinks href=#hl-8-420>420</a>
</span><span class=lnt id=hl-8-421><a class=lnlinks href=#hl-8-421>421</a>
</span><span class=lnt id=hl-8-422><a class=lnlinks href=#hl-8-422>422</a>
</span><span class=lnt id=hl-8-423><a class=lnlinks href=#hl-8-423>423</a>
</span><span class=lnt id=hl-8-424><a class=lnlinks href=#hl-8-424>424</a>
</span><span class=lnt id=hl-8-425><a class=lnlinks href=#hl-8-425>425</a>
</span><span class=lnt id=hl-8-426><a class=lnlinks href=#hl-8-426>426</a>
</span><span class=lnt id=hl-8-427><a class=lnlinks href=#hl-8-427>427</a>
</span><span class=lnt id=hl-8-428><a class=lnlinks href=#hl-8-428>428</a>
</span><span class=lnt id=hl-8-429><a class=lnlinks href=#hl-8-429>429</a>
</span><span class=lnt id=hl-8-430><a class=lnlinks href=#hl-8-430>430</a>
</span><span class=lnt id=hl-8-431><a class=lnlinks href=#hl-8-431>431</a>
</span><span class=lnt id=hl-8-432><a class=lnlinks href=#hl-8-432>432</a>
</span><span class=lnt id=hl-8-433><a class=lnlinks href=#hl-8-433>433</a>
</span><span class=lnt id=hl-8-434><a class=lnlinks href=#hl-8-434>434</a>
</span><span class=lnt id=hl-8-435><a class=lnlinks href=#hl-8-435>435</a>
</span><span class=lnt id=hl-8-436><a class=lnlinks href=#hl-8-436>436</a>
</span><span class=lnt id=hl-8-437><a class=lnlinks href=#hl-8-437>437</a>
</span><span class=lnt id=hl-8-438><a class=lnlinks href=#hl-8-438>438</a>
</span><span class=lnt id=hl-8-439><a class=lnlinks href=#hl-8-439>439</a>
</span><span class=lnt id=hl-8-440><a class=lnlinks href=#hl-8-440>440</a>
</span><span class=lnt id=hl-8-441><a class=lnlinks href=#hl-8-441>441</a>
</span><span class=lnt id=hl-8-442><a class=lnlinks href=#hl-8-442>442</a>
</span><span class=lnt id=hl-8-443><a class=lnlinks href=#hl-8-443>443</a>
</span><span class=lnt id=hl-8-444><a class=lnlinks href=#hl-8-444>444</a>
</span><span class=lnt id=hl-8-445><a class=lnlinks href=#hl-8-445>445</a>
</span><span class=lnt id=hl-8-446><a class=lnlinks href=#hl-8-446>446</a>
</span><span class=lnt id=hl-8-447><a class=lnlinks href=#hl-8-447>447</a>
</span><span class=lnt id=hl-8-448><a class=lnlinks href=#hl-8-448>448</a>
</span><span class=lnt id=hl-8-449><a class=lnlinks href=#hl-8-449>449</a>
</span><span class=lnt id=hl-8-450><a class=lnlinks href=#hl-8-450>450</a>
</span><span class=lnt id=hl-8-451><a class=lnlinks href=#hl-8-451>451</a>
</span><span class=lnt id=hl-8-452><a class=lnlinks href=#hl-8-452>452</a>
</span><span class=lnt id=hl-8-453><a class=lnlinks href=#hl-8-453>453</a>
</span><span class=lnt id=hl-8-454><a class=lnlinks href=#hl-8-454>454</a>
</span><span class=lnt id=hl-8-455><a class=lnlinks href=#hl-8-455>455</a>
</span><span class=lnt id=hl-8-456><a class=lnlinks href=#hl-8-456>456</a>
</span><span class=lnt id=hl-8-457><a class=lnlinks href=#hl-8-457>457</a>
</span><span class=lnt id=hl-8-458><a class=lnlinks href=#hl-8-458>458</a>
</span><span class=lnt id=hl-8-459><a class=lnlinks href=#hl-8-459>459</a>
</span><span class=lnt id=hl-8-460><a class=lnlinks href=#hl-8-460>460</a>
</span><span class=lnt id=hl-8-461><a class=lnlinks href=#hl-8-461>461</a>
</span><span class=lnt id=hl-8-462><a class=lnlinks href=#hl-8-462>462</a>
</span><span class=lnt id=hl-8-463><a class=lnlinks href=#hl-8-463>463</a>
</span><span class=lnt id=hl-8-464><a class=lnlinks href=#hl-8-464>464</a>
</span><span class=lnt id=hl-8-465><a class=lnlinks href=#hl-8-465>465</a>
</span><span class=lnt id=hl-8-466><a class=lnlinks href=#hl-8-466>466</a>
</span><span class=lnt id=hl-8-467><a class=lnlinks href=#hl-8-467>467</a>
</span><span class=lnt id=hl-8-468><a class=lnlinks href=#hl-8-468>468</a>
</span><span class=lnt id=hl-8-469><a class=lnlinks href=#hl-8-469>469</a>
</span><span class=lnt id=hl-8-470><a class=lnlinks href=#hl-8-470>470</a>
</span><span class=lnt id=hl-8-471><a class=lnlinks href=#hl-8-471>471</a>
</span><span class=lnt id=hl-8-472><a class=lnlinks href=#hl-8-472>472</a>
</span><span class=lnt id=hl-8-473><a class=lnlinks href=#hl-8-473>473</a>
</span><span class=lnt id=hl-8-474><a class=lnlinks href=#hl-8-474>474</a>
</span><span class=lnt id=hl-8-475><a class=lnlinks href=#hl-8-475>475</a>
</span><span class=lnt id=hl-8-476><a class=lnlinks href=#hl-8-476>476</a>
</span><span class=lnt id=hl-8-477><a class=lnlinks href=#hl-8-477>477</a>
</span><span class=lnt id=hl-8-478><a class=lnlinks href=#hl-8-478>478</a>
</span><span class=lnt id=hl-8-479><a class=lnlinks href=#hl-8-479>479</a>
</span><span class=lnt id=hl-8-480><a class=lnlinks href=#hl-8-480>480</a>
</span><span class=lnt id=hl-8-481><a class=lnlinks href=#hl-8-481>481</a>
</span><span class=lnt id=hl-8-482><a class=lnlinks href=#hl-8-482>482</a>
</span><span class=lnt id=hl-8-483><a class=lnlinks href=#hl-8-483>483</a>
</span><span class=lnt id=hl-8-484><a class=lnlinks href=#hl-8-484>484</a>
</span><span class=lnt id=hl-8-485><a class=lnlinks href=#hl-8-485>485</a>
</span><span class=lnt id=hl-8-486><a class=lnlinks href=#hl-8-486>486</a>
</span><span class=lnt id=hl-8-487><a class=lnlinks href=#hl-8-487>487</a>
</span><span class=lnt id=hl-8-488><a class=lnlinks href=#hl-8-488>488</a>
</span><span class=lnt id=hl-8-489><a class=lnlinks href=#hl-8-489>489</a>
</span><span class=lnt id=hl-8-490><a class=lnlinks href=#hl-8-490>490</a>
</span><span class=lnt id=hl-8-491><a class=lnlinks href=#hl-8-491>491</a>
</span><span class=lnt id=hl-8-492><a class=lnlinks href=#hl-8-492>492</a>
</span><span class=lnt id=hl-8-493><a class=lnlinks href=#hl-8-493>493</a>
</span><span class=lnt id=hl-8-494><a class=lnlinks href=#hl-8-494>494</a>
</span><span class=lnt id=hl-8-495><a class=lnlinks href=#hl-8-495>495</a>
</span><span class=lnt id=hl-8-496><a class=lnlinks href=#hl-8-496>496</a>
</span><span class=lnt id=hl-8-497><a class=lnlinks href=#hl-8-497>497</a>
</span><span class=lnt id=hl-8-498><a class=lnlinks href=#hl-8-498>498</a>
</span><span class=lnt id=hl-8-499><a class=lnlinks href=#hl-8-499>499</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 모듈러 모놀리틱 E-커머스 플랫폼 구현 예시</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABC</span><span class=p>,</span> <span class=n>abstractmethod</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>List</span><span class=p>,</span> <span class=n>Optional</span><span class=p>,</span> <span class=n>Any</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dataclasses</span> <span class=kn>import</span> <span class=n>dataclass</span><span class=p>,</span> <span class=n>field</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>enum</span> <span class=kn>import</span> <span class=n>Enum</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>uuid</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>asyncio</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>defaultdict</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># =============================================================================</span>
</span></span><span class=line><span class=cl><span class=c1># 공유 커널 (Shared Kernel) - 공통 기능</span>
</span></span><span class=line><span class=cl><span class=c1># =============================================================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DomainEvent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;도메인 이벤트 기본 클래스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_type</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_id</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_type</span> <span class=o>=</span> <span class=n>event_type</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>data</span> <span class=o>=</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>timestamp</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>EventBus</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;이벤트 버스 - 모듈 간 비동기 통신&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_subscribers</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=n>callable</span><span class=p>]]</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>subscribe</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_type</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>handler</span><span class=p>:</span> <span class=n>callable</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;이벤트 구독&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_subscribers</span><span class=p>[</span><span class=n>event_type</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>handler</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>publish</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>:</span> <span class=n>DomainEvent</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;이벤트 발행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>handlers</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_subscribers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>event</span><span class=o>.</span><span class=n>event_type</span><span class=p>,</span> <span class=p>[])</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>handler</span> <span class=ow>in</span> <span class=n>handlers</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>iscoroutinefunction</span><span class=p>(</span><span class=n>handler</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=k>await</span> <span class=n>handler</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>handler</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error handling event </span><span class=si>{</span><span class=n>event</span><span class=o>.</span><span class=n>event_type</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ModuleInterface</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;모듈 인터페이스 - 모든 모듈이 구현해야 하는 기본 인터페이스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_name</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>initialize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_bus</span><span class=p>:</span> <span class=n>EventBus</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># =============================================================================</span>
</span></span><span class=line><span class=cl><span class=c1># 상품 모듈 (Product Module)</span>
</span></span><span class=line><span class=cl><span class=c1># =============================================================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Product</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;상품 엔티티&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>price</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>category</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>stock</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=n>created_at</span><span class=p>:</span> <span class=n>datetime</span> <span class=o>=</span> <span class=n>field</span><span class=p>(</span><span class=n>default_factory</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ProductRepository</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;상품 리포지토리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_products</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Product</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>save</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>product</span><span class=p>:</span> <span class=n>Product</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Product</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_products</span><span class=p>[</span><span class=n>product</span><span class=o>.</span><span class=n>id</span><span class=p>]</span> <span class=o>=</span> <span class=n>product</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>product</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>find_by_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>product_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Product</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_products</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>find_all</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Product</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>list</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_products</span><span class=o>.</span><span class=n>values</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>find_by_category</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>category</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Product</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span><span class=n>p</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_products</span><span class=o>.</span><span class=n>values</span><span class=p>()</span> <span class=k>if</span> <span class=n>p</span><span class=o>.</span><span class=n>category</span> <span class=o>==</span> <span class=n>category</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ProductService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;상품 도메인 서비스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>repository</span><span class=p>:</span> <span class=n>ProductRepository</span><span class=p>,</span> <span class=n>event_bus</span><span class=p>:</span> <span class=n>EventBus</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>repository</span> <span class=o>=</span> <span class=n>repository</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span> <span class=o>=</span> <span class=n>event_bus</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>create_product</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>description</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>price</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                           <span class=n>category</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>stock</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Product</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;상품 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>product</span> <span class=o>=</span> <span class=n>Product</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nb>id</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>            <span class=n>name</span><span class=o>=</span><span class=n>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>description</span><span class=o>=</span><span class=n>description</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>price</span><span class=o>=</span><span class=n>price</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>category</span><span class=o>=</span><span class=n>category</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>stock</span><span class=o>=</span><span class=n>stock</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>saved_product</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>repository</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>product</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 상품 생성 이벤트 발행</span>
</span></span><span class=line><span class=cl>        <span class=n>event</span> <span class=o>=</span> <span class=n>DomainEvent</span><span class=p>(</span><span class=s2>&#34;ProductCreated&#34;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;product_id&#34;</span><span class=p>:</span> <span class=n>saved_product</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=n>saved_product</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;price&#34;</span><span class=p>:</span> <span class=n>saved_product</span><span class=o>.</span><span class=n>price</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;stock&#34;</span><span class=p>:</span> <span class=n>saved_product</span><span class=o>.</span><span class=n>stock</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>saved_product</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_product</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>product_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Product</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;상품 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>repository</span><span class=o>.</span><span class=n>find_by_id</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_products_by_category</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>category</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Product</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;카테고리별 상품 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>repository</span><span class=o>.</span><span class=n>find_by_category</span><span class=p>(</span><span class=n>category</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ProductModule</span><span class=p>(</span><span class=n>ModuleInterface</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;상품 모듈&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>repository</span> <span class=o>=</span> <span class=n>ProductRepository</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>service</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_name</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;ProductModule&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>initialize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_bus</span><span class=p>:</span> <span class=n>EventBus</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span> <span class=o>=</span> <span class=n>event_bus</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>service</span> <span class=o>=</span> <span class=n>ProductService</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>repository</span><span class=p>,</span> <span class=n>event_bus</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 재고 업데이트 이벤트 구독</span>
</span></span><span class=line><span class=cl>        <span class=n>event_bus</span><span class=o>.</span><span class=n>subscribe</span><span class=p>(</span><span class=s2>&#34;StockUpdated&#34;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_stock_update</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>_handle_stock_update</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>:</span> <span class=n>DomainEvent</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;재고 업데이트 이벤트 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>product_id</span> <span class=o>=</span> <span class=n>event</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;product_id&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>new_stock</span> <span class=o>=</span> <span class=n>event</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;new_stock&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>product</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>repository</span><span class=o>.</span><span class=n>find_by_id</span><span class=p>(</span><span class=n>product_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>product</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>product</span><span class=o>.</span><span class=n>stock</span> <span class=o>=</span> <span class=n>new_stock</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>repository</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>product</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># =============================================================================</span>
</span></span><span class=line><span class=cl><span class=c1># 주문 모듈 (Order Module)</span>
</span></span><span class=line><span class=cl><span class=c1># =============================================================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderStatus</span><span class=p>(</span><span class=n>Enum</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>PENDING</span> <span class=o>=</span> <span class=s2>&#34;pending&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>CONFIRMED</span> <span class=o>=</span> <span class=s2>&#34;confirmed&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>PROCESSING</span> <span class=o>=</span> <span class=s2>&#34;processing&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>SHIPPED</span> <span class=o>=</span> <span class=s2>&#34;shipped&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>DELIVERED</span> <span class=o>=</span> <span class=s2>&#34;delivered&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>CANCELLED</span> <span class=o>=</span> <span class=s2>&#34;cancelled&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderItem</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;주문 항목&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>product_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>product_name</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>quantity</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>    <span class=n>unit_price</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@property</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>total_price</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>quantity</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>unit_price</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Order</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;주문 엔티티&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>items</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>OrderItem</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>status</span><span class=p>:</span> <span class=n>OrderStatus</span> <span class=o>=</span> <span class=n>OrderStatus</span><span class=o>.</span><span class=n>PENDING</span>
</span></span><span class=line><span class=cl>    <span class=n>created_at</span><span class=p>:</span> <span class=n>datetime</span> <span class=o>=</span> <span class=n>field</span><span class=p>(</span><span class=n>default_factory</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>updated_at</span><span class=p>:</span> <span class=n>datetime</span> <span class=o>=</span> <span class=n>field</span><span class=p>(</span><span class=n>default_factory</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@property</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>total_amount</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>sum</span><span class=p>(</span><span class=n>item</span><span class=o>.</span><span class=n>total_price</span> <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>items</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderRepository</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;주문 리포지토리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_orders</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Order</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>save</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order</span><span class=p>:</span> <span class=n>Order</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Order</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>order</span><span class=o>.</span><span class=n>updated_at</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_orders</span><span class=p>[</span><span class=n>order</span><span class=o>.</span><span class=n>id</span><span class=p>]</span> <span class=o>=</span> <span class=n>order</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>order</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>find_by_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Order</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_orders</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>order_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>find_by_customer</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Order</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[</span><span class=n>o</span> <span class=k>for</span> <span class=n>o</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_orders</span><span class=o>.</span><span class=n>values</span><span class=p>()</span> <span class=k>if</span> <span class=n>o</span><span class=o>.</span><span class=n>customer_id</span> <span class=o>==</span> <span class=n>customer_id</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;주문 도메인 서비스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>repository</span><span class=p>:</span> <span class=n>OrderRepository</span><span class=p>,</span> <span class=n>event_bus</span><span class=p>:</span> <span class=n>EventBus</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>repository</span> <span class=o>=</span> <span class=n>repository</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span> <span class=o>=</span> <span class=n>event_bus</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>create_order</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>items</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Order</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;주문 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>order_items</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>item_data</span> <span class=ow>in</span> <span class=n>items</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>order_item</span> <span class=o>=</span> <span class=n>OrderItem</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>product_id</span><span class=o>=</span><span class=n>item_data</span><span class=p>[</span><span class=s2>&#34;product_id&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>product_name</span><span class=o>=</span><span class=n>item_data</span><span class=p>[</span><span class=s2>&#34;product_name&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>quantity</span><span class=o>=</span><span class=n>item_data</span><span class=p>[</span><span class=s2>&#34;quantity&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>unit_price</span><span class=o>=</span><span class=n>item_data</span><span class=p>[</span><span class=s2>&#34;unit_price&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>order_items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>order_item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>order</span> <span class=o>=</span> <span class=n>Order</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nb>id</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>            <span class=n>customer_id</span><span class=o>=</span><span class=n>customer_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>items</span><span class=o>=</span><span class=n>order_items</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>saved_order</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>repository</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>order</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 주문 생성 이벤트 발행</span>
</span></span><span class=line><span class=cl>        <span class=n>event</span> <span class=o>=</span> <span class=n>DomainEvent</span><span class=p>(</span><span class=s2>&#34;OrderCreated&#34;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;order_id&#34;</span><span class=p>:</span> <span class=n>saved_order</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;customer_id&#34;</span><span class=p>:</span> <span class=n>saved_order</span><span class=o>.</span><span class=n>customer_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;total_amount&#34;</span><span class=p>:</span> <span class=n>saved_order</span><span class=o>.</span><span class=n>total_amount</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;items&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;product_id&#34;</span><span class=p>:</span> <span class=n>item</span><span class=o>.</span><span class=n>product_id</span><span class=p>,</span> <span class=s2>&#34;quantity&#34;</span><span class=p>:</span> <span class=n>item</span><span class=o>.</span><span class=n>quantity</span><span class=p>}</span> 
</span></span><span class=line><span class=cl>                     <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>saved_order</span><span class=o>.</span><span class=n>items</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>saved_order</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>update_order_status</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>status</span><span class=p>:</span> <span class=n>OrderStatus</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;주문 상태 업데이트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>order</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>repository</span><span class=o>.</span><span class=n>find_by_id</span><span class=p>(</span><span class=n>order_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>order</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>old_status</span> <span class=o>=</span> <span class=n>order</span><span class=o>.</span><span class=n>status</span>
</span></span><span class=line><span class=cl>            <span class=n>order</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=n>status</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>repository</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>order</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 주문 상태 변경 이벤트 발행</span>
</span></span><span class=line><span class=cl>            <span class=n>event</span> <span class=o>=</span> <span class=n>DomainEvent</span><span class=p>(</span><span class=s2>&#34;OrderStatusChanged&#34;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;order_id&#34;</span><span class=p>:</span> <span class=n>order_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;old_status&#34;</span><span class=p>:</span> <span class=n>old_status</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;new_status&#34;</span><span class=p>:</span> <span class=n>status</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;customer_id&#34;</span><span class=p>:</span> <span class=n>order</span><span class=o>.</span><span class=n>customer_id</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderModule</span><span class=p>(</span><span class=n>ModuleInterface</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;주문 모듈&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>repository</span> <span class=o>=</span> <span class=n>OrderRepository</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>service</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_name</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;OrderModule&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>initialize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_bus</span><span class=p>:</span> <span class=n>EventBus</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span> <span class=o>=</span> <span class=n>event_bus</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>service</span> <span class=o>=</span> <span class=n>OrderService</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>repository</span><span class=p>,</span> <span class=n>event_bus</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 결제 완료 이벤트 구독</span>
</span></span><span class=line><span class=cl>        <span class=n>event_bus</span><span class=o>.</span><span class=n>subscribe</span><span class=p>(</span><span class=s2>&#34;PaymentProcessed&#34;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_payment_processed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>_handle_payment_processed</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>:</span> <span class=n>DomainEvent</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;결제 완료 이벤트 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>order_id</span> <span class=o>=</span> <span class=n>event</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;order_id&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>order_id</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>service</span><span class=o>.</span><span class=n>update_order_status</span><span class=p>(</span><span class=n>order_id</span><span class=p>,</span> <span class=n>OrderStatus</span><span class=o>.</span><span class=n>CONFIRMED</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># =============================================================================</span>
</span></span><span class=line><span class=cl><span class=c1># 결제 모듈 (Payment Module)</span>
</span></span><span class=line><span class=cl><span class=c1># =============================================================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>PaymentStatus</span><span class=p>(</span><span class=n>Enum</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>PENDING</span> <span class=o>=</span> <span class=s2>&#34;pending&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>PROCESSING</span> <span class=o>=</span> <span class=s2>&#34;processing&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>SUCCESS</span> <span class=o>=</span> <span class=s2>&#34;success&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>FAILED</span> <span class=o>=</span> <span class=s2>&#34;failed&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>REFUNDED</span> <span class=o>=</span> <span class=s2>&#34;refunded&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Payment</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;결제 엔티티&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>order_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>amount</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>status</span><span class=p>:</span> <span class=n>PaymentStatus</span> <span class=o>=</span> <span class=n>PaymentStatus</span><span class=o>.</span><span class=n>PENDING</span>
</span></span><span class=line><span class=cl>    <span class=n>payment_method</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;credit_card&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>created_at</span><span class=p>:</span> <span class=n>datetime</span> <span class=o>=</span> <span class=n>field</span><span class=p>(</span><span class=n>default_factory</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>processed_at</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>datetime</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>PaymentRepository</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;결제 리포지토리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_payments</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Payment</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>save</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payment</span><span class=p>:</span> <span class=n>Payment</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Payment</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_payments</span><span class=p>[</span><span class=n>payment</span><span class=o>.</span><span class=n>id</span><span class=p>]</span> <span class=o>=</span> <span class=n>payment</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>payment</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>find_by_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>payment_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Payment</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_payments</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>payment_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>find_by_order_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Payment</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>payment</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_payments</span><span class=o>.</span><span class=n>values</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>payment</span><span class=o>.</span><span class=n>order_id</span> <span class=o>==</span> <span class=n>order_id</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>payment</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>PaymentService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;결제 도메인 서비스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>repository</span><span class=p>:</span> <span class=n>PaymentRepository</span><span class=p>,</span> <span class=n>event_bus</span><span class=p>:</span> <span class=n>EventBus</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>repository</span> <span class=o>=</span> <span class=n>repository</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span> <span class=o>=</span> <span class=n>event_bus</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process_payment</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                            <span class=n>amount</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>payment_method</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;credit_card&#34;</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Payment</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;결제 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>payment</span> <span class=o>=</span> <span class=n>Payment</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nb>id</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>            <span class=n>order_id</span><span class=o>=</span><span class=n>order_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>customer_id</span><span class=o>=</span><span class=n>customer_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>amount</span><span class=o>=</span><span class=n>amount</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>payment_method</span><span class=o>=</span><span class=n>payment_method</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>status</span><span class=o>=</span><span class=n>PaymentStatus</span><span class=o>.</span><span class=n>PROCESSING</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 실제 결제 처리 로직 (외부 결제 게이트웨이 연동)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 여기서는 단순화하여 항상 성공으로 처리</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>  <span class=c1># 결제 처리 시뮬레이션</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>payment</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=n>PaymentStatus</span><span class=o>.</span><span class=n>SUCCESS</span>
</span></span><span class=line><span class=cl>        <span class=n>payment</span><span class=o>.</span><span class=n>processed_at</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>saved_payment</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>repository</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>payment</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 결제 완료 이벤트 발행</span>
</span></span><span class=line><span class=cl>        <span class=n>event</span> <span class=o>=</span> <span class=n>DomainEvent</span><span class=p>(</span><span class=s2>&#34;PaymentProcessed&#34;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;payment_id&#34;</span><span class=p>:</span> <span class=n>saved_payment</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;order_id&#34;</span><span class=p>:</span> <span class=n>saved_payment</span><span class=o>.</span><span class=n>order_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;customer_id&#34;</span><span class=p>:</span> <span class=n>saved_payment</span><span class=o>.</span><span class=n>customer_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;amount&#34;</span><span class=p>:</span> <span class=n>saved_payment</span><span class=o>.</span><span class=n>amount</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=n>saved_payment</span><span class=o>.</span><span class=n>status</span><span class=o>.</span><span class=n>value</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>saved_payment</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>PaymentModule</span><span class=p>(</span><span class=n>ModuleInterface</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;결제 모듈&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>repository</span> <span class=o>=</span> <span class=n>PaymentRepository</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>service</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_name</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;PaymentModule&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>initialize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_bus</span><span class=p>:</span> <span class=n>EventBus</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span> <span class=o>=</span> <span class=n>event_bus</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>service</span> <span class=o>=</span> <span class=n>PaymentService</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>repository</span><span class=p>,</span> <span class=n>event_bus</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 주문 생성 이벤트 구독</span>
</span></span><span class=line><span class=cl>        <span class=n>event_bus</span><span class=o>.</span><span class=n>subscribe</span><span class=p>(</span><span class=s2>&#34;OrderCreated&#34;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handle_order_created</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>_handle_order_created</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>:</span> <span class=n>DomainEvent</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;주문 생성 이벤트 처리 - 자동 결제 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>order_id</span> <span class=o>=</span> <span class=n>event</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;order_id&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>customer_id</span> <span class=o>=</span> <span class=n>event</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;customer_id&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>total_amount</span> <span class=o>=</span> <span class=n>event</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;total_amount&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>order_id</span> <span class=ow>and</span> <span class=n>customer_id</span> <span class=ow>and</span> <span class=n>total_amount</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>service</span><span class=o>.</span><span class=n>process_payment</span><span class=p>(</span><span class=n>order_id</span><span class=p>,</span> <span class=n>customer_id</span><span class=p>,</span> <span class=n>total_amount</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># =============================================================================</span>
</span></span><span class=line><span class=cl><span class=c1># 애플리케이션 호스트 (Application Host)</span>
</span></span><span class=line><span class=cl><span class=c1># =============================================================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ECommerceApplication</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;E-커머스 애플리케이션 호스트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span> <span class=o>=</span> <span class=n>EventBus</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>modules</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>ModuleInterface</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 모듈 등록</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>register_module</span><span class=p>(</span><span class=n>ProductModule</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>register_module</span><span class=p>(</span><span class=n>OrderModule</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>register_module</span><span class=p>(</span><span class=n>PaymentModule</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>register_module</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>module</span><span class=p>:</span> <span class=n>ModuleInterface</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;모듈 등록&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>modules</span><span class=p>[</span><span class=n>module</span><span class=o>.</span><span class=n>get_name</span><span class=p>()]</span> <span class=o>=</span> <span class=n>module</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>initialize</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;애플리케이션 초기화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;🚀 E-커머스 모듈러 모놀리틱 애플리케이션 초기화 중…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>module</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>modules</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=n>module</span><span class=o>.</span><span class=n>initialize</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>event_bus</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;✅ </span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2> 초기화 완료&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;🎉 애플리케이션 초기화 완료!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_module</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>module_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>ModuleInterface</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;모듈 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>modules</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>module_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># =============================================================================</span>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시 및 테스트</span>
</span></span><span class=line><span class=cl><span class=c1># =============================================================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;애플리케이션 실행 예시&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span> <span class=o>=</span> <span class=n>ECommerceApplication</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>app</span><span class=o>.</span><span class=n>initialize</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 모듈별 서비스 접근</span>
</span></span><span class=line><span class=cl>    <span class=n>product_module</span> <span class=o>=</span> <span class=n>app</span><span class=o>.</span><span class=n>get_module</span><span class=p>(</span><span class=s2>&#34;ProductModule&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>order_module</span> <span class=o>=</span> <span class=n>app</span><span class=o>.</span><span class=n>get_module</span><span class=p>(</span><span class=s2>&#34;OrderModule&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payment_module</span> <span class=o>=</span> <span class=n>app</span><span class=o>.</span><span class=n>get_module</span><span class=p>(</span><span class=s2>&#34;PaymentModule&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>📦 상품 생성 예시:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 상품 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>laptop</span> <span class=o>=</span> <span class=k>await</span> <span class=n>product_module</span><span class=o>.</span><span class=n>service</span><span class=o>.</span><span class=n>create_product</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>name</span><span class=o>=</span><span class=s2>&#34;Gaming Laptop&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>description</span><span class=o>=</span><span class=s2>&#34;고성능 게이밍 노트북&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>price</span><span class=o>=</span><span class=mf>1500000.0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>category</span><span class=o>=</span><span class=s2>&#34;Electronics&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>stock</span><span class=o>=</span><span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;생성된 상품: </span><span class=si>{</span><span class=n>laptop</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> - </span><span class=si>{</span><span class=n>laptop</span><span class=o>.</span><span class=n>price</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>원&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>mouse</span> <span class=o>=</span> <span class=k>await</span> <span class=n>product_module</span><span class=o>.</span><span class=n>service</span><span class=o>.</span><span class=n>create_product</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>name</span><span class=o>=</span><span class=s2>&#34;Gaming Mouse&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>description</span><span class=o>=</span><span class=s2>&#34;게이밍 마우스&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>price</span><span class=o>=</span><span class=mf>80000.0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>category</span><span class=o>=</span><span class=s2>&#34;Electronics&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>stock</span><span class=o>=</span><span class=mi>50</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;생성된 상품: </span><span class=si>{</span><span class=n>mouse</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> - </span><span class=si>{</span><span class=n>mouse</span><span class=o>.</span><span class=n>price</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>원&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>🛒 주문 생성 예시:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 주문 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>order</span> <span class=o>=</span> <span class=k>await</span> <span class=n>order_module</span><span class=o>.</span><span class=n>service</span><span class=o>.</span><span class=n>create_order</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>customer_id</span><span class=o>=</span><span class=s2>&#34;customer_123&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>items</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;product_id&#34;</span><span class=p>:</span> <span class=n>laptop</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;product_name&#34;</span><span class=p>:</span> <span class=n>laptop</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;quantity&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;unit_price&#34;</span><span class=p>:</span> <span class=n>laptop</span><span class=o>.</span><span class=n>price</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;product_id&#34;</span><span class=p>:</span> <span class=n>mouse</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;product_name&#34;</span><span class=p>:</span> <span class=n>mouse</span><span class=o>.</span><span class=n>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;quantity&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;unit_price&#34;</span><span class=p>:</span> <span class=n>mouse</span><span class=o>.</span><span class=n>price</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;생성된 주문 ID: </span><span class=si>{</span><span class=n>order</span><span class=o>.</span><span class=n>id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;주문 총액: </span><span class=si>{</span><span class=n>order</span><span class=o>.</span><span class=n>total_amount</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>원&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;주문 상태: </span><span class=si>{</span><span class=n>order</span><span class=o>.</span><span class=n>status</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 잠시 대기 (이벤트 처리 시간)</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 결제 확인</span>
</span></span><span class=line><span class=cl>    <span class=n>payment</span> <span class=o>=</span> <span class=n>payment_module</span><span class=o>.</span><span class=n>repository</span><span class=o>.</span><span class=n>find_by_order_id</span><span class=p>(</span><span class=n>order</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>payment</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>💳 결제 처리 완료:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;결제 ID: </span><span class=si>{</span><span class=n>payment</span><span class=o>.</span><span class=n>id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;결제 상태: </span><span class=si>{</span><span class=n>payment</span><span class=o>.</span><span class=n>status</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;결제 금액: </span><span class=si>{</span><span class=n>payment</span><span class=o>.</span><span class=n>amount</span><span class=si>:</span><span class=s2>,</span><span class=si>}</span><span class=s2>원&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 주문 상태 확인</span>
</span></span><span class=line><span class=cl>    <span class=n>updated_order</span> <span class=o>=</span> <span class=n>order_module</span><span class=o>.</span><span class=n>repository</span><span class=o>.</span><span class=n>find_by_id</span><span class=p>(</span><span class=n>order</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>📋 최종 주문 상태: </span><span class=si>{</span><span class=n>updated_order</span><span class=o>.</span><span class=n>status</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>main</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-2-이커머스-플랫폼>사례 2: 이커머스 플랫폼<a hidden class=anchor aria-hidden=true href=#사례-2-이커머스-플랫폼>#</a></h4><p><strong>시스템 구성</strong></p><ul><li><strong>주문 모듈</strong>: 주문 생성 및 관리</li><li><strong>결제 모듈</strong>: 결제 처리</li><li><strong>재고 모듈</strong>: 재고 관리</li></ul><pre class=mermaid>graph TD
    A[Order Module] --&gt;|API| B[Payment Module]
    B --&gt;|API| C[Inventory Module]
    D[Shared DB] -- Order Table --&gt; A
    D -- Payment Table --&gt; B
    D -- Inventory Table --&gt; C
</pre><p><strong>Workflow</strong></p><ol><li>사용자가 주문 생성</li><li>주문 모듈이 결제 모듈에 결제 요청</li><li>결제 모듈이 재고 모듈에 재고 확인 요청</li><li>결제 및 재고 확인 후 주문 완료</li></ol><p><strong>역할</strong></p><ul><li><strong>주문 모듈</strong>: 주문 생성 및 관리</li><li><strong>결제 모듈</strong>: 결제 처리</li><li><strong>재고 모듈</strong>: 재고 관리</li></ul><p><strong>차이점</strong></p><ul><li><strong>기존 모놀리식</strong>: 모든 기능이 하나의 코드베이스에 혼재</li><li><strong>Modular Monolith</strong>: 도메인별로 모듈 분리, 명확한 경계</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span><span class=lnt id=hl-10-16><a class=lnlinks href=#hl-10-16>16</a>
</span><span class=lnt id=hl-10-17><a class=lnlinks href=#hl-10-17>17</a>
</span><span class=lnt id=hl-10-18><a class=lnlinks href=#hl-10-18>18</a>
</span><span class=lnt id=hl-10-19><a class=lnlinks href=#hl-10-19>19</a>
</span><span class=lnt id=hl-10-20><a class=lnlinks href=#hl-10-20>20</a>
</span><span class=lnt id=hl-10-21><a class=lnlinks href=#hl-10-21>21</a>
</span><span class=lnt id=hl-10-22><a class=lnlinks href=#hl-10-22>22</a>
</span><span class=lnt id=hl-10-23><a class=lnlinks href=#hl-10-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 모듈별로 클래스로 분리 (간단 예시)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderModule</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_order</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>item_id</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 결제 모듈 호출</span>
</span></span><span class=line><span class=cl>        <span class=n>payment_result</span> <span class=o>=</span> <span class=n>PaymentModule</span><span class=p>()</span><span class=o>.</span><span class=n>process_payment</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=mi>10000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>payment_result</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 재고 모듈 호출</span>
</span></span><span class=line><span class=cl>            <span class=n>inventory_result</span> <span class=o>=</span> <span class=n>InventoryModule</span><span class=p>()</span><span class=o>.</span><span class=n>check_stock</span><span class=p>(</span><span class=n>item_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>inventory_result</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=s2>&#34;Order created&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;Order failed&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>PaymentModule</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_payment</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>,</span> <span class=n>amount</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span>  <span class=c1># 결제 성공 가정</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>InventoryModule</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>check_stock</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>item_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span>  <span class=c1># 재고 있음 가정</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>order</span> <span class=o>=</span> <span class=n>OrderModule</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>order</span><span class=o>.</span><span class=n>create_order</span><span class=p>(</span><span class=s2>&#34;item1&#34;</span><span class=p>,</span> <span class=s2>&#34;user1&#34;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-3-전자상거래-플랫폼-shopify-사례-기반>사례 3: 전자상거래 플랫폼 (Shopify 사례 기반)<a hidden class=anchor aria-hidden=true href=#사례-3-전자상거래-플랫폼-shopify-사례-기반>#</a></h4><p><strong>시나리오</strong>: 대규모 전자상거래 플랫폼 (Shopify 사례 기반)</p><p><strong>시스템 구성</strong>:</p><ul><li>Ruby on Rails 기반 280 만 라인 이상의 코드와 50 만 개의 커밋을 가진 핵심 애플리케이션</li><li>주문 관리, 재고 관리, 결제 처리, 고객 관리, 배송 관리 모듈</li><li>MySQL/Vitess 데이터베이스 클러스터</li><li>Redis/Memcached 캐싱 계층</li><li>Kafka 메시징 시스템</li></ul><pre class=mermaid>graph TB
    subgraph &#34;Global Load Balancer&#34;
        LB[Load Balancer]
    end
    
    subgraph &#34;Shopify Modular Monolith&#34;
        direction TB
        
        subgraph &#34;API Gateway&#34;
            API[Rails API Gateway]
        end
        
        subgraph &#34;Core Modules&#34;
            direction LR
            OM[Orders Module]
            IM[Inventory Module]
            PM[Payments Module]
            CM[Customers Module]
            SM[Shipping Module]
            AM[Analytics Module]
        end
        
        subgraph &#34;Shared Infrastructure&#34;
            CACHE[(Redis/Memcached Cache)]
            EVENT[Event Bus]
            QUEUE[Background Jobs]
        end
    end
    
    subgraph &#34;Data Layer - Pods Architecture&#34;
        direction LR
        POD1[(MySQL Pod 1&lt;br/&gt;Shops 1-1000)]
        POD2[(MySQL Pod 2&lt;br/&gt;Shops 1001-2000)]
        POD3[(MySQL Pod 3&lt;br/&gt;Shops 2001-3000)]
        PODN[(MySQL Pod N&lt;br/&gt;Shops N…)]
    end
    
    subgraph &#34;External Services&#34;
        PAYMENT_GW[Payment Gateways]
        SHIPPING_API[Shipping APIs]
        ANALYTICS_SV[Analytics Services]
    end
    
    subgraph &#34;Monitoring &amp; Observability&#34;
        LOGS[Centralized Logging]
        METRICS[Metrics &amp; Monitoring]
        TRACE[Distributed Tracing]
    end
    
    CLIENT[Clients] --&gt; LB
    LB --&gt; API
    
    API --&gt; OM
    API --&gt; IM
    API --&gt; PM
    API --&gt; CM
    API --&gt; SM
    API --&gt; AM
    
    OM --&gt; EVENT
    IM --&gt; EVENT
    PM --&gt; EVENT
    CM --&gt; EVENT
    SM --&gt; EVENT
    
    EVENT --&gt; QUEUE
    
    OM --&gt; CACHE
    IM --&gt; CACHE
    PM --&gt; CACHE
    CM --&gt; CACHE
    SM --&gt; CACHE
    
    OM -.-&gt;|Shop-based routing| POD1
    OM -.-&gt;|Shop-based routing| POD2
    OM -.-&gt;|Shop-based routing| POD3
    IM -.-&gt;|Shop-based routing| PODN
    
    PM --&gt; PAYMENT_GW
    SM --&gt; SHIPPING_API
    AM --&gt; ANALYTICS_SV
    
    API --&gt; LOGS
    API --&gt; METRICS
    API --&gt; TRACE
    
    classDef moduleStyle fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef dataStyle fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef extStyle fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef infraStyle fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    
    class OM,IM,PM,CM,SM,AM moduleStyle
    class POD1,POD2,POD3,PODN,CACHE dataStyle
    class PAYMENT_GW,SHIPPING_API,ANALYTICS_SV extStyle
    class EVENT,QUEUE,LOGS,METRICS,TRACE infraStyle
</pre><p><strong>Workflow</strong>:</p><ol><li>클라이언트 요청이 글로벌 로드 밸런서를 통해 Rails API 게이트웨이로 라우팅</li><li>API 게이트웨이가 요청을 적절한 모듈로 분배 (주문, 재고, 결제 등)</li><li>각 모듈이 자체 비즈니스 로직을 실행하고 필요시 이벤트 발행</li><li>모듈 간 통신은 이벤트 버스를 통해 비동기적으로 처리</li><li>데이터는 shop_id 기반으로 샤딩된 MySQL 포드에 저장</li><li>캐시 계층 (Redis/Memcached) 을 통해 성능 최적화</li><li>백그라운드 작업은 큐 시스템을 통해 비동기 처리</li></ol><p><strong>역할</strong>:</p><ul><li><strong>API Gateway</strong>: 모든 외부 요청의 진입점, 인증 및 라우팅 담당</li><li><strong>모듈들</strong>: 각각 특정 비즈니스 도메인 관리 (주문, 재고, 결제 등)</li><li><strong>Event Bus</strong>: 모듈 간 느슨한 결합 통신 지원</li><li><strong>Pods Architecture</strong>: 데이터베이스 샤딩을 통한 확장성 제공</li></ul><p><strong>유무에 따른 차이점</strong>:</p><ul><li><strong>모듈러 모놀리스 적용 전</strong>: 기능적으로 구별 가능한 측면들이 모두 얽혀있어 배송료 계산 코드가 체크아웃 코드와 함께 있고, 서로를 호출하는 것을 막는 것이 거의 없음</li><li><strong>모듈러 모놀리스 적용 후</strong>: 모든 코드를 하나의 코드베이스에 유지하되 서로 다른 컴포넌트 간에 경계가 정의되고 존중되도록 보장</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1>  1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2>  2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3>  3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4>  4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5>  5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6>  6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7>  7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8>  8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9>  9</a>
</span><span class=lnt id=hl-12-10><a class=lnlinks href=#hl-12-10> 10</a>
</span><span class=lnt id=hl-12-11><a class=lnlinks href=#hl-12-11> 11</a>
</span><span class=lnt id=hl-12-12><a class=lnlinks href=#hl-12-12> 12</a>
</span><span class=lnt id=hl-12-13><a class=lnlinks href=#hl-12-13> 13</a>
</span><span class=lnt id=hl-12-14><a class=lnlinks href=#hl-12-14> 14</a>
</span><span class=lnt id=hl-12-15><a class=lnlinks href=#hl-12-15> 15</a>
</span><span class=lnt id=hl-12-16><a class=lnlinks href=#hl-12-16> 16</a>
</span><span class=lnt id=hl-12-17><a class=lnlinks href=#hl-12-17> 17</a>
</span><span class=lnt id=hl-12-18><a class=lnlinks href=#hl-12-18> 18</a>
</span><span class=lnt id=hl-12-19><a class=lnlinks href=#hl-12-19> 19</a>
</span><span class=lnt id=hl-12-20><a class=lnlinks href=#hl-12-20> 20</a>
</span><span class=lnt id=hl-12-21><a class=lnlinks href=#hl-12-21> 21</a>
</span><span class=lnt id=hl-12-22><a class=lnlinks href=#hl-12-22> 22</a>
</span><span class=lnt id=hl-12-23><a class=lnlinks href=#hl-12-23> 23</a>
</span><span class=lnt id=hl-12-24><a class=lnlinks href=#hl-12-24> 24</a>
</span><span class=lnt id=hl-12-25><a class=lnlinks href=#hl-12-25> 25</a>
</span><span class=lnt id=hl-12-26><a class=lnlinks href=#hl-12-26> 26</a>
</span><span class=lnt id=hl-12-27><a class=lnlinks href=#hl-12-27> 27</a>
</span><span class=lnt id=hl-12-28><a class=lnlinks href=#hl-12-28> 28</a>
</span><span class=lnt id=hl-12-29><a class=lnlinks href=#hl-12-29> 29</a>
</span><span class=lnt id=hl-12-30><a class=lnlinks href=#hl-12-30> 30</a>
</span><span class=lnt id=hl-12-31><a class=lnlinks href=#hl-12-31> 31</a>
</span><span class=lnt id=hl-12-32><a class=lnlinks href=#hl-12-32> 32</a>
</span><span class=lnt id=hl-12-33><a class=lnlinks href=#hl-12-33> 33</a>
</span><span class=lnt id=hl-12-34><a class=lnlinks href=#hl-12-34> 34</a>
</span><span class=lnt id=hl-12-35><a class=lnlinks href=#hl-12-35> 35</a>
</span><span class=lnt id=hl-12-36><a class=lnlinks href=#hl-12-36> 36</a>
</span><span class=lnt id=hl-12-37><a class=lnlinks href=#hl-12-37> 37</a>
</span><span class=lnt id=hl-12-38><a class=lnlinks href=#hl-12-38> 38</a>
</span><span class=lnt id=hl-12-39><a class=lnlinks href=#hl-12-39> 39</a>
</span><span class=lnt id=hl-12-40><a class=lnlinks href=#hl-12-40> 40</a>
</span><span class=lnt id=hl-12-41><a class=lnlinks href=#hl-12-41> 41</a>
</span><span class=lnt id=hl-12-42><a class=lnlinks href=#hl-12-42> 42</a>
</span><span class=lnt id=hl-12-43><a class=lnlinks href=#hl-12-43> 43</a>
</span><span class=lnt id=hl-12-44><a class=lnlinks href=#hl-12-44> 44</a>
</span><span class=lnt id=hl-12-45><a class=lnlinks href=#hl-12-45> 45</a>
</span><span class=lnt id=hl-12-46><a class=lnlinks href=#hl-12-46> 46</a>
</span><span class=lnt id=hl-12-47><a class=lnlinks href=#hl-12-47> 47</a>
</span><span class=lnt id=hl-12-48><a class=lnlinks href=#hl-12-48> 48</a>
</span><span class=lnt id=hl-12-49><a class=lnlinks href=#hl-12-49> 49</a>
</span><span class=lnt id=hl-12-50><a class=lnlinks href=#hl-12-50> 50</a>
</span><span class=lnt id=hl-12-51><a class=lnlinks href=#hl-12-51> 51</a>
</span><span class=lnt id=hl-12-52><a class=lnlinks href=#hl-12-52> 52</a>
</span><span class=lnt id=hl-12-53><a class=lnlinks href=#hl-12-53> 53</a>
</span><span class=lnt id=hl-12-54><a class=lnlinks href=#hl-12-54> 54</a>
</span><span class=lnt id=hl-12-55><a class=lnlinks href=#hl-12-55> 55</a>
</span><span class=lnt id=hl-12-56><a class=lnlinks href=#hl-12-56> 56</a>
</span><span class=lnt id=hl-12-57><a class=lnlinks href=#hl-12-57> 57</a>
</span><span class=lnt id=hl-12-58><a class=lnlinks href=#hl-12-58> 58</a>
</span><span class=lnt id=hl-12-59><a class=lnlinks href=#hl-12-59> 59</a>
</span><span class=lnt id=hl-12-60><a class=lnlinks href=#hl-12-60> 60</a>
</span><span class=lnt id=hl-12-61><a class=lnlinks href=#hl-12-61> 61</a>
</span><span class=lnt id=hl-12-62><a class=lnlinks href=#hl-12-62> 62</a>
</span><span class=lnt id=hl-12-63><a class=lnlinks href=#hl-12-63> 63</a>
</span><span class=lnt id=hl-12-64><a class=lnlinks href=#hl-12-64> 64</a>
</span><span class=lnt id=hl-12-65><a class=lnlinks href=#hl-12-65> 65</a>
</span><span class=lnt id=hl-12-66><a class=lnlinks href=#hl-12-66> 66</a>
</span><span class=lnt id=hl-12-67><a class=lnlinks href=#hl-12-67> 67</a>
</span><span class=lnt id=hl-12-68><a class=lnlinks href=#hl-12-68> 68</a>
</span><span class=lnt id=hl-12-69><a class=lnlinks href=#hl-12-69> 69</a>
</span><span class=lnt id=hl-12-70><a class=lnlinks href=#hl-12-70> 70</a>
</span><span class=lnt id=hl-12-71><a class=lnlinks href=#hl-12-71> 71</a>
</span><span class=lnt id=hl-12-72><a class=lnlinks href=#hl-12-72> 72</a>
</span><span class=lnt id=hl-12-73><a class=lnlinks href=#hl-12-73> 73</a>
</span><span class=lnt id=hl-12-74><a class=lnlinks href=#hl-12-74> 74</a>
</span><span class=lnt id=hl-12-75><a class=lnlinks href=#hl-12-75> 75</a>
</span><span class=lnt id=hl-12-76><a class=lnlinks href=#hl-12-76> 76</a>
</span><span class=lnt id=hl-12-77><a class=lnlinks href=#hl-12-77> 77</a>
</span><span class=lnt id=hl-12-78><a class=lnlinks href=#hl-12-78> 78</a>
</span><span class=lnt id=hl-12-79><a class=lnlinks href=#hl-12-79> 79</a>
</span><span class=lnt id=hl-12-80><a class=lnlinks href=#hl-12-80> 80</a>
</span><span class=lnt id=hl-12-81><a class=lnlinks href=#hl-12-81> 81</a>
</span><span class=lnt id=hl-12-82><a class=lnlinks href=#hl-12-82> 82</a>
</span><span class=lnt id=hl-12-83><a class=lnlinks href=#hl-12-83> 83</a>
</span><span class=lnt id=hl-12-84><a class=lnlinks href=#hl-12-84> 84</a>
</span><span class=lnt id=hl-12-85><a class=lnlinks href=#hl-12-85> 85</a>
</span><span class=lnt id=hl-12-86><a class=lnlinks href=#hl-12-86> 86</a>
</span><span class=lnt id=hl-12-87><a class=lnlinks href=#hl-12-87> 87</a>
</span><span class=lnt id=hl-12-88><a class=lnlinks href=#hl-12-88> 88</a>
</span><span class=lnt id=hl-12-89><a class=lnlinks href=#hl-12-89> 89</a>
</span><span class=lnt id=hl-12-90><a class=lnlinks href=#hl-12-90> 90</a>
</span><span class=lnt id=hl-12-91><a class=lnlinks href=#hl-12-91> 91</a>
</span><span class=lnt id=hl-12-92><a class=lnlinks href=#hl-12-92> 92</a>
</span><span class=lnt id=hl-12-93><a class=lnlinks href=#hl-12-93> 93</a>
</span><span class=lnt id=hl-12-94><a class=lnlinks href=#hl-12-94> 94</a>
</span><span class=lnt id=hl-12-95><a class=lnlinks href=#hl-12-95> 95</a>
</span><span class=lnt id=hl-12-96><a class=lnlinks href=#hl-12-96> 96</a>
</span><span class=lnt id=hl-12-97><a class=lnlinks href=#hl-12-97> 97</a>
</span><span class=lnt id=hl-12-98><a class=lnlinks href=#hl-12-98> 98</a>
</span><span class=lnt id=hl-12-99><a class=lnlinks href=#hl-12-99> 99</a>
</span><span class=lnt id=hl-12-100><a class=lnlinks href=#hl-12-100>100</a>
</span><span class=lnt id=hl-12-101><a class=lnlinks href=#hl-12-101>101</a>
</span><span class=lnt id=hl-12-102><a class=lnlinks href=#hl-12-102>102</a>
</span><span class=lnt id=hl-12-103><a class=lnlinks href=#hl-12-103>103</a>
</span><span class=lnt id=hl-12-104><a class=lnlinks href=#hl-12-104>104</a>
</span><span class=lnt id=hl-12-105><a class=lnlinks href=#hl-12-105>105</a>
</span><span class=lnt id=hl-12-106><a class=lnlinks href=#hl-12-106>106</a>
</span><span class=lnt id=hl-12-107><a class=lnlinks href=#hl-12-107>107</a>
</span><span class=lnt id=hl-12-108><a class=lnlinks href=#hl-12-108>108</a>
</span><span class=lnt id=hl-12-109><a class=lnlinks href=#hl-12-109>109</a>
</span><span class=lnt id=hl-12-110><a class=lnlinks href=#hl-12-110>110</a>
</span><span class=lnt id=hl-12-111><a class=lnlinks href=#hl-12-111>111</a>
</span><span class=lnt id=hl-12-112><a class=lnlinks href=#hl-12-112>112</a>
</span><span class=lnt id=hl-12-113><a class=lnlinks href=#hl-12-113>113</a>
</span><span class=lnt id=hl-12-114><a class=lnlinks href=#hl-12-114>114</a>
</span><span class=lnt id=hl-12-115><a class=lnlinks href=#hl-12-115>115</a>
</span><span class=lnt id=hl-12-116><a class=lnlinks href=#hl-12-116>116</a>
</span><span class=lnt id=hl-12-117><a class=lnlinks href=#hl-12-117>117</a>
</span><span class=lnt id=hl-12-118><a class=lnlinks href=#hl-12-118>118</a>
</span><span class=lnt id=hl-12-119><a class=lnlinks href=#hl-12-119>119</a>
</span><span class=lnt id=hl-12-120><a class=lnlinks href=#hl-12-120>120</a>
</span><span class=lnt id=hl-12-121><a class=lnlinks href=#hl-12-121>121</a>
</span><span class=lnt id=hl-12-122><a class=lnlinks href=#hl-12-122>122</a>
</span><span class=lnt id=hl-12-123><a class=lnlinks href=#hl-12-123>123</a>
</span><span class=lnt id=hl-12-124><a class=lnlinks href=#hl-12-124>124</a>
</span><span class=lnt id=hl-12-125><a class=lnlinks href=#hl-12-125>125</a>
</span><span class=lnt id=hl-12-126><a class=lnlinks href=#hl-12-126>126</a>
</span><span class=lnt id=hl-12-127><a class=lnlinks href=#hl-12-127>127</a>
</span><span class=lnt id=hl-12-128><a class=lnlinks href=#hl-12-128>128</a>
</span><span class=lnt id=hl-12-129><a class=lnlinks href=#hl-12-129>129</a>
</span><span class=lnt id=hl-12-130><a class=lnlinks href=#hl-12-130>130</a>
</span><span class=lnt id=hl-12-131><a class=lnlinks href=#hl-12-131>131</a>
</span><span class=lnt id=hl-12-132><a class=lnlinks href=#hl-12-132>132</a>
</span><span class=lnt id=hl-12-133><a class=lnlinks href=#hl-12-133>133</a>
</span><span class=lnt id=hl-12-134><a class=lnlinks href=#hl-12-134>134</a>
</span><span class=lnt id=hl-12-135><a class=lnlinks href=#hl-12-135>135</a>
</span><span class=lnt id=hl-12-136><a class=lnlinks href=#hl-12-136>136</a>
</span><span class=lnt id=hl-12-137><a class=lnlinks href=#hl-12-137>137</a>
</span><span class=lnt id=hl-12-138><a class=lnlinks href=#hl-12-138>138</a>
</span><span class=lnt id=hl-12-139><a class=lnlinks href=#hl-12-139>139</a>
</span><span class=lnt id=hl-12-140><a class=lnlinks href=#hl-12-140>140</a>
</span><span class=lnt id=hl-12-141><a class=lnlinks href=#hl-12-141>141</a>
</span><span class=lnt id=hl-12-142><a class=lnlinks href=#hl-12-142>142</a>
</span><span class=lnt id=hl-12-143><a class=lnlinks href=#hl-12-143>143</a>
</span><span class=lnt id=hl-12-144><a class=lnlinks href=#hl-12-144>144</a>
</span><span class=lnt id=hl-12-145><a class=lnlinks href=#hl-12-145>145</a>
</span><span class=lnt id=hl-12-146><a class=lnlinks href=#hl-12-146>146</a>
</span><span class=lnt id=hl-12-147><a class=lnlinks href=#hl-12-147>147</a>
</span><span class=lnt id=hl-12-148><a class=lnlinks href=#hl-12-148>148</a>
</span><span class=lnt id=hl-12-149><a class=lnlinks href=#hl-12-149>149</a>
</span><span class=lnt id=hl-12-150><a class=lnlinks href=#hl-12-150>150</a>
</span><span class=lnt id=hl-12-151><a class=lnlinks href=#hl-12-151>151</a>
</span><span class=lnt id=hl-12-152><a class=lnlinks href=#hl-12-152>152</a>
</span><span class=lnt id=hl-12-153><a class=lnlinks href=#hl-12-153>153</a>
</span><span class=lnt id=hl-12-154><a class=lnlinks href=#hl-12-154>154</a>
</span><span class=lnt id=hl-12-155><a class=lnlinks href=#hl-12-155>155</a>
</span><span class=lnt id=hl-12-156><a class=lnlinks href=#hl-12-156>156</a>
</span><span class=lnt id=hl-12-157><a class=lnlinks href=#hl-12-157>157</a>
</span><span class=lnt id=hl-12-158><a class=lnlinks href=#hl-12-158>158</a>
</span><span class=lnt id=hl-12-159><a class=lnlinks href=#hl-12-159>159</a>
</span><span class=lnt id=hl-12-160><a class=lnlinks href=#hl-12-160>160</a>
</span><span class=lnt id=hl-12-161><a class=lnlinks href=#hl-12-161>161</a>
</span><span class=lnt id=hl-12-162><a class=lnlinks href=#hl-12-162>162</a>
</span><span class=lnt id=hl-12-163><a class=lnlinks href=#hl-12-163>163</a>
</span><span class=lnt id=hl-12-164><a class=lnlinks href=#hl-12-164>164</a>
</span><span class=lnt id=hl-12-165><a class=lnlinks href=#hl-12-165>165</a>
</span><span class=lnt id=hl-12-166><a class=lnlinks href=#hl-12-166>166</a>
</span><span class=lnt id=hl-12-167><a class=lnlinks href=#hl-12-167>167</a>
</span><span class=lnt id=hl-12-168><a class=lnlinks href=#hl-12-168>168</a>
</span><span class=lnt id=hl-12-169><a class=lnlinks href=#hl-12-169>169</a>
</span><span class=lnt id=hl-12-170><a class=lnlinks href=#hl-12-170>170</a>
</span><span class=lnt id=hl-12-171><a class=lnlinks href=#hl-12-171>171</a>
</span><span class=lnt id=hl-12-172><a class=lnlinks href=#hl-12-172>172</a>
</span><span class=lnt id=hl-12-173><a class=lnlinks href=#hl-12-173>173</a>
</span><span class=lnt id=hl-12-174><a class=lnlinks href=#hl-12-174>174</a>
</span><span class=lnt id=hl-12-175><a class=lnlinks href=#hl-12-175>175</a>
</span><span class=lnt id=hl-12-176><a class=lnlinks href=#hl-12-176>176</a>
</span><span class=lnt id=hl-12-177><a class=lnlinks href=#hl-12-177>177</a>
</span><span class=lnt id=hl-12-178><a class=lnlinks href=#hl-12-178>178</a>
</span><span class=lnt id=hl-12-179><a class=lnlinks href=#hl-12-179>179</a>
</span><span class=lnt id=hl-12-180><a class=lnlinks href=#hl-12-180>180</a>
</span><span class=lnt id=hl-12-181><a class=lnlinks href=#hl-12-181>181</a>
</span><span class=lnt id=hl-12-182><a class=lnlinks href=#hl-12-182>182</a>
</span><span class=lnt id=hl-12-183><a class=lnlinks href=#hl-12-183>183</a>
</span><span class=lnt id=hl-12-184><a class=lnlinks href=#hl-12-184>184</a>
</span><span class=lnt id=hl-12-185><a class=lnlinks href=#hl-12-185>185</a>
</span><span class=lnt id=hl-12-186><a class=lnlinks href=#hl-12-186>186</a>
</span><span class=lnt id=hl-12-187><a class=lnlinks href=#hl-12-187>187</a>
</span><span class=lnt id=hl-12-188><a class=lnlinks href=#hl-12-188>188</a>
</span><span class=lnt id=hl-12-189><a class=lnlinks href=#hl-12-189>189</a>
</span><span class=lnt id=hl-12-190><a class=lnlinks href=#hl-12-190>190</a>
</span><span class=lnt id=hl-12-191><a class=lnlinks href=#hl-12-191>191</a>
</span><span class=lnt id=hl-12-192><a class=lnlinks href=#hl-12-192>192</a>
</span><span class=lnt id=hl-12-193><a class=lnlinks href=#hl-12-193>193</a>
</span><span class=lnt id=hl-12-194><a class=lnlinks href=#hl-12-194>194</a>
</span><span class=lnt id=hl-12-195><a class=lnlinks href=#hl-12-195>195</a>
</span><span class=lnt id=hl-12-196><a class=lnlinks href=#hl-12-196>196</a>
</span><span class=lnt id=hl-12-197><a class=lnlinks href=#hl-12-197>197</a>
</span><span class=lnt id=hl-12-198><a class=lnlinks href=#hl-12-198>198</a>
</span><span class=lnt id=hl-12-199><a class=lnlinks href=#hl-12-199>199</a>
</span><span class=lnt id=hl-12-200><a class=lnlinks href=#hl-12-200>200</a>
</span><span class=lnt id=hl-12-201><a class=lnlinks href=#hl-12-201>201</a>
</span><span class=lnt id=hl-12-202><a class=lnlinks href=#hl-12-202>202</a>
</span><span class=lnt id=hl-12-203><a class=lnlinks href=#hl-12-203>203</a>
</span><span class=lnt id=hl-12-204><a class=lnlinks href=#hl-12-204>204</a>
</span><span class=lnt id=hl-12-205><a class=lnlinks href=#hl-12-205>205</a>
</span><span class=lnt id=hl-12-206><a class=lnlinks href=#hl-12-206>206</a>
</span><span class=lnt id=hl-12-207><a class=lnlinks href=#hl-12-207>207</a>
</span><span class=lnt id=hl-12-208><a class=lnlinks href=#hl-12-208>208</a>
</span><span class=lnt id=hl-12-209><a class=lnlinks href=#hl-12-209>209</a>
</span><span class=lnt id=hl-12-210><a class=lnlinks href=#hl-12-210>210</a>
</span><span class=lnt id=hl-12-211><a class=lnlinks href=#hl-12-211>211</a>
</span><span class=lnt id=hl-12-212><a class=lnlinks href=#hl-12-212>212</a>
</span><span class=lnt id=hl-12-213><a class=lnlinks href=#hl-12-213>213</a>
</span><span class=lnt id=hl-12-214><a class=lnlinks href=#hl-12-214>214</a>
</span><span class=lnt id=hl-12-215><a class=lnlinks href=#hl-12-215>215</a>
</span><span class=lnt id=hl-12-216><a class=lnlinks href=#hl-12-216>216</a>
</span><span class=lnt id=hl-12-217><a class=lnlinks href=#hl-12-217>217</a>
</span><span class=lnt id=hl-12-218><a class=lnlinks href=#hl-12-218>218</a>
</span><span class=lnt id=hl-12-219><a class=lnlinks href=#hl-12-219>219</a>
</span><span class=lnt id=hl-12-220><a class=lnlinks href=#hl-12-220>220</a>
</span><span class=lnt id=hl-12-221><a class=lnlinks href=#hl-12-221>221</a>
</span><span class=lnt id=hl-12-222><a class=lnlinks href=#hl-12-222>222</a>
</span><span class=lnt id=hl-12-223><a class=lnlinks href=#hl-12-223>223</a>
</span><span class=lnt id=hl-12-224><a class=lnlinks href=#hl-12-224>224</a>
</span><span class=lnt id=hl-12-225><a class=lnlinks href=#hl-12-225>225</a>
</span><span class=lnt id=hl-12-226><a class=lnlinks href=#hl-12-226>226</a>
</span><span class=lnt id=hl-12-227><a class=lnlinks href=#hl-12-227>227</a>
</span><span class=lnt id=hl-12-228><a class=lnlinks href=#hl-12-228>228</a>
</span><span class=lnt id=hl-12-229><a class=lnlinks href=#hl-12-229>229</a>
</span><span class=lnt id=hl-12-230><a class=lnlinks href=#hl-12-230>230</a>
</span><span class=lnt id=hl-12-231><a class=lnlinks href=#hl-12-231>231</a>
</span><span class=lnt id=hl-12-232><a class=lnlinks href=#hl-12-232>232</a>
</span><span class=lnt id=hl-12-233><a class=lnlinks href=#hl-12-233>233</a>
</span><span class=lnt id=hl-12-234><a class=lnlinks href=#hl-12-234>234</a>
</span><span class=lnt id=hl-12-235><a class=lnlinks href=#hl-12-235>235</a>
</span><span class=lnt id=hl-12-236><a class=lnlinks href=#hl-12-236>236</a>
</span><span class=lnt id=hl-12-237><a class=lnlinks href=#hl-12-237>237</a>
</span><span class=lnt id=hl-12-238><a class=lnlinks href=#hl-12-238>238</a>
</span><span class=lnt id=hl-12-239><a class=lnlinks href=#hl-12-239>239</a>
</span><span class=lnt id=hl-12-240><a class=lnlinks href=#hl-12-240>240</a>
</span><span class=lnt id=hl-12-241><a class=lnlinks href=#hl-12-241>241</a>
</span><span class=lnt id=hl-12-242><a class=lnlinks href=#hl-12-242>242</a>
</span><span class=lnt id=hl-12-243><a class=lnlinks href=#hl-12-243>243</a>
</span><span class=lnt id=hl-12-244><a class=lnlinks href=#hl-12-244>244</a>
</span><span class=lnt id=hl-12-245><a class=lnlinks href=#hl-12-245>245</a>
</span><span class=lnt id=hl-12-246><a class=lnlinks href=#hl-12-246>246</a>
</span><span class=lnt id=hl-12-247><a class=lnlinks href=#hl-12-247>247</a>
</span><span class=lnt id=hl-12-248><a class=lnlinks href=#hl-12-248>248</a>
</span><span class=lnt id=hl-12-249><a class=lnlinks href=#hl-12-249>249</a>
</span><span class=lnt id=hl-12-250><a class=lnlinks href=#hl-12-250>250</a>
</span><span class=lnt id=hl-12-251><a class=lnlinks href=#hl-12-251>251</a>
</span><span class=lnt id=hl-12-252><a class=lnlinks href=#hl-12-252>252</a>
</span><span class=lnt id=hl-12-253><a class=lnlinks href=#hl-12-253>253</a>
</span><span class=lnt id=hl-12-254><a class=lnlinks href=#hl-12-254>254</a>
</span><span class=lnt id=hl-12-255><a class=lnlinks href=#hl-12-255>255</a>
</span><span class=lnt id=hl-12-256><a class=lnlinks href=#hl-12-256>256</a>
</span><span class=lnt id=hl-12-257><a class=lnlinks href=#hl-12-257>257</a>
</span><span class=lnt id=hl-12-258><a class=lnlinks href=#hl-12-258>258</a>
</span><span class=lnt id=hl-12-259><a class=lnlinks href=#hl-12-259>259</a>
</span><span class=lnt id=hl-12-260><a class=lnlinks href=#hl-12-260>260</a>
</span><span class=lnt id=hl-12-261><a class=lnlinks href=#hl-12-261>261</a>
</span><span class=lnt id=hl-12-262><a class=lnlinks href=#hl-12-262>262</a>
</span><span class=lnt id=hl-12-263><a class=lnlinks href=#hl-12-263>263</a>
</span><span class=lnt id=hl-12-264><a class=lnlinks href=#hl-12-264>264</a>
</span><span class=lnt id=hl-12-265><a class=lnlinks href=#hl-12-265>265</a>
</span><span class=lnt id=hl-12-266><a class=lnlinks href=#hl-12-266>266</a>
</span><span class=lnt id=hl-12-267><a class=lnlinks href=#hl-12-267>267</a>
</span><span class=lnt id=hl-12-268><a class=lnlinks href=#hl-12-268>268</a>
</span><span class=lnt id=hl-12-269><a class=lnlinks href=#hl-12-269>269</a>
</span><span class=lnt id=hl-12-270><a class=lnlinks href=#hl-12-270>270</a>
</span><span class=lnt id=hl-12-271><a class=lnlinks href=#hl-12-271>271</a>
</span><span class=lnt id=hl-12-272><a class=lnlinks href=#hl-12-272>272</a>
</span><span class=lnt id=hl-12-273><a class=lnlinks href=#hl-12-273>273</a>
</span><span class=lnt id=hl-12-274><a class=lnlinks href=#hl-12-274>274</a>
</span><span class=lnt id=hl-12-275><a class=lnlinks href=#hl-12-275>275</a>
</span><span class=lnt id=hl-12-276><a class=lnlinks href=#hl-12-276>276</a>
</span><span class=lnt id=hl-12-277><a class=lnlinks href=#hl-12-277>277</a>
</span><span class=lnt id=hl-12-278><a class=lnlinks href=#hl-12-278>278</a>
</span><span class=lnt id=hl-12-279><a class=lnlinks href=#hl-12-279>279</a>
</span><span class=lnt id=hl-12-280><a class=lnlinks href=#hl-12-280>280</a>
</span><span class=lnt id=hl-12-281><a class=lnlinks href=#hl-12-281>281</a>
</span><span class=lnt id=hl-12-282><a class=lnlinks href=#hl-12-282>282</a>
</span><span class=lnt id=hl-12-283><a class=lnlinks href=#hl-12-283>283</a>
</span><span class=lnt id=hl-12-284><a class=lnlinks href=#hl-12-284>284</a>
</span><span class=lnt id=hl-12-285><a class=lnlinks href=#hl-12-285>285</a>
</span><span class=lnt id=hl-12-286><a class=lnlinks href=#hl-12-286>286</a>
</span><span class=lnt id=hl-12-287><a class=lnlinks href=#hl-12-287>287</a>
</span><span class=lnt id=hl-12-288><a class=lnlinks href=#hl-12-288>288</a>
</span><span class=lnt id=hl-12-289><a class=lnlinks href=#hl-12-289>289</a>
</span><span class=lnt id=hl-12-290><a class=lnlinks href=#hl-12-290>290</a>
</span><span class=lnt id=hl-12-291><a class=lnlinks href=#hl-12-291>291</a>
</span><span class=lnt id=hl-12-292><a class=lnlinks href=#hl-12-292>292</a>
</span><span class=lnt id=hl-12-293><a class=lnlinks href=#hl-12-293>293</a>
</span><span class=lnt id=hl-12-294><a class=lnlinks href=#hl-12-294>294</a>
</span><span class=lnt id=hl-12-295><a class=lnlinks href=#hl-12-295>295</a>
</span><span class=lnt id=hl-12-296><a class=lnlinks href=#hl-12-296>296</a>
</span><span class=lnt id=hl-12-297><a class=lnlinks href=#hl-12-297>297</a>
</span><span class=lnt id=hl-12-298><a class=lnlinks href=#hl-12-298>298</a>
</span><span class=lnt id=hl-12-299><a class=lnlinks href=#hl-12-299>299</a>
</span><span class=lnt id=hl-12-300><a class=lnlinks href=#hl-12-300>300</a>
</span><span class=lnt id=hl-12-301><a class=lnlinks href=#hl-12-301>301</a>
</span><span class=lnt id=hl-12-302><a class=lnlinks href=#hl-12-302>302</a>
</span><span class=lnt id=hl-12-303><a class=lnlinks href=#hl-12-303>303</a>
</span><span class=lnt id=hl-12-304><a class=lnlinks href=#hl-12-304>304</a>
</span><span class=lnt id=hl-12-305><a class=lnlinks href=#hl-12-305>305</a>
</span><span class=lnt id=hl-12-306><a class=lnlinks href=#hl-12-306>306</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// 모듈러 모놀리스 구현 예시 (Node.js/TypeScript)
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 1. 도메인 이벤트 정의
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>interface</span> <span class=nx>DomainEvent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>eventId</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>eventType</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>aggregateId</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>payload</span>: <span class=kt>any</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>occurredAt</span>: <span class=kt>Date</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 2. Event Bus 구현 (모듈 간 통신)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>class</span> <span class=nx>EventBus</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>handlers</span>: <span class=kt>Map</span><span class=p>&lt;</span><span class=nt>string</span><span class=p>,</span> <span class=na>Array</span><span class=err>&lt;(</span><span class=na>event</span><span class=err>:</span> <span class=na>DomainEvent</span><span class=err>)</span> <span class=err>=</span><span class=p>&gt;</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;</span><span class=o>&gt;&gt;</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Map</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 이벤트 핸들러 등록
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>subscribe</span><span class=p>(</span><span class=nx>eventType</span>: <span class=kt>string</span><span class=p>,</span> <span class=nx>handler</span><span class=o>:</span> <span class=p>(</span><span class=nx>event</span>: <span class=kt>DomainEvent</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;)</span><span class=o>:</span> <span class=k>void</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=k>this</span><span class=p>.</span><span class=nx>handlers</span><span class=p>.</span><span class=nx>has</span><span class=p>(</span><span class=nx>eventType</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>handlers</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=nx>eventType</span><span class=p>,</span> <span class=p>[]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>handlers</span><span class=p>.</span><span class=kr>get</span><span class=p>(</span><span class=nx>eventType</span><span class=p>)</span><span class=o>!</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>handler</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 이벤트 발행 (비동기 처리)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>async</span> <span class=nx>publish</span><span class=p>(</span><span class=nx>event</span>: <span class=kt>DomainEvent</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>handlers</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>handlers</span><span class=p>.</span><span class=kr>get</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>eventType</span><span class=p>)</span> <span class=o>||</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Outbox 패턴 구현: 이벤트를 먼저 데이터베이스에 저장
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>saveToOutbox</span><span class=p>(</span><span class=nx>event</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 핸들러들을 비동기로 실행
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>await</span> <span class=nx>Promise</span><span class=p>.</span><span class=nx>all</span><span class=p>(</span><span class=nx>handlers</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>handler</span> <span class=o>=&gt;</span> 
</span></span><span class=line><span class=cl>      <span class=nx>handler</span><span class=p>(</span><span class=nx>event</span><span class=p>).</span><span class=k>catch</span><span class=p>(</span><span class=nx>error</span> <span class=o>=&gt;</span> 
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=sb>`Event handler failed for </span><span class=si>${</span><span class=nx>event</span><span class=p>.</span><span class=nx>eventType</span><span class=si>}</span><span class=sb>:`</span><span class=p>,</span> <span class=nx>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Outbox 패턴: 이벤트를 데이터베이스에 먼저 저장
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>private</span> <span class=kr>async</span> <span class=nx>saveToOutbox</span><span class=p>(</span><span class=nx>event</span>: <span class=kt>DomainEvent</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 실제 구현에서는 데이터베이스에 저장
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Saving event to outbox: </span><span class=si>${</span><span class=nx>event</span><span class=p>.</span><span class=nx>eventType</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 3. 주문 모듈 (Orders Module) 구현
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>namespace</span> <span class=nx>OrdersModule</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 주문 집계 루트
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>export</span> <span class=kr>class</span> <span class=nx>Order</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>constructor</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=kr>public</span> <span class=kr>readonly</span> <span class=nx>id</span>: <span class=kt>string</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=kr>public</span> <span class=kr>readonly</span> <span class=nx>customerId</span>: <span class=kt>string</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=kr>public</span> <span class=kr>readonly</span> <span class=nx>items</span>: <span class=kt>OrderItem</span><span class=p>[],</span>
</span></span><span class=line><span class=cl>      <span class=kr>public</span> <span class=nx>status</span>: <span class=kt>OrderStatus</span> <span class=o>=</span> <span class=nx>OrderStatus</span><span class=p>.</span><span class=nx>Pending</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 주문 확인 비즈니스 로직
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>confirm</span><span class=p>()</span><span class=o>:</span> <span class=nx>DomainEvent</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>status</span> <span class=o>!==</span> <span class=nx>OrderStatus</span><span class=p>.</span><span class=nx>Pending</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;Only pending orders can be confirmed&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>status</span> <span class=o>=</span> <span class=nx>OrderStatus</span><span class=p>.</span><span class=nx>Confirmed</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>eventId</span>: <span class=kt>crypto.randomUUID</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=nx>eventType</span><span class=o>:</span> <span class=s1>&#39;OrderConfirmed&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>aggregateId</span>: <span class=kt>this.id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>payload</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>orderId</span>: <span class=kt>this.id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>customerId</span>: <span class=kt>this.customerId</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>items</span>: <span class=kt>this.items</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>totalAmount</span>: <span class=kt>this.calculateTotal</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nx>occurredAt</span>: <span class=kt>new</span> <span class=nb>Date</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>private</span> <span class=nx>calculateTotal</span><span class=p>()</span><span class=o>:</span> <span class=kt>number</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>items</span><span class=p>.</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>sum</span><span class=p>,</span> <span class=nx>item</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=nx>sum</span> <span class=o>+</span> <span class=p>(</span><span class=nx>item</span><span class=p>.</span><span class=nx>price</span> <span class=o>*</span> <span class=nx>item</span><span class=p>.</span><span class=nx>quantity</span><span class=p>),</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>export</span> <span class=kr>interface</span> <span class=nx>OrderItem</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>productId</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>quantity</span>: <span class=kt>number</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>price</span>: <span class=kt>number</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>export</span> <span class=kr>enum</span> <span class=nx>OrderStatus</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>Pending</span> <span class=o>=</span> <span class=s1>&#39;pending&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>Confirmed</span> <span class=o>=</span> <span class=s1>&#39;confirmed&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>Shipped</span> <span class=o>=</span> <span class=s1>&#39;shipped&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>Delivered</span> <span class=o>=</span> <span class=s1>&#39;delivered&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 주문 모듈의 공개 API
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>export</span> <span class=kr>class</span> <span class=nx>OrdersAPI</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>constructor</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=kr>private</span> <span class=nx>eventBus</span>: <span class=kt>EventBus</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=kr>private</span> <span class=nx>orderRepository</span>: <span class=kt>OrderRepository</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 주문 생성 API
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>async</span> <span class=nx>createOrder</span><span class=p>(</span><span class=nx>customerId</span>: <span class=kt>string</span><span class=p>,</span> <span class=nx>items</span>: <span class=kt>OrderItem</span><span class=p>[])</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>string</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>orderId</span> <span class=o>=</span> <span class=nx>crypto</span><span class=p>.</span><span class=nx>randomUUID</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>order</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Order</span><span class=p>(</span><span class=nx>orderId</span><span class=p>,</span> <span class=nx>customerId</span><span class=p>,</span> <span class=nx>items</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>orderRepository</span><span class=p>.</span><span class=nx>save</span><span class=p>(</span><span class=nx>order</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>event</span>: <span class=kt>DomainEvent</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>eventId</span>: <span class=kt>crypto.randomUUID</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=nx>eventType</span><span class=o>:</span> <span class=s1>&#39;OrderCreated&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>aggregateId</span>: <span class=kt>orderId</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>payload</span><span class=o>:</span> <span class=p>{</span> <span class=nx>orderId</span><span class=p>,</span> <span class=nx>customerId</span><span class=p>,</span> <span class=nx>items</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nx>occurredAt</span>: <span class=kt>new</span> <span class=nb>Date</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=p>};</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>eventBus</span><span class=p>.</span><span class=nx>publish</span><span class=p>(</span><span class=nx>event</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>orderId</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 주문 확인 API
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>async</span> <span class=nx>confirmOrder</span><span class=p>(</span><span class=nx>orderId</span>: <span class=kt>string</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>order</span> <span class=o>=</span> <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>orderRepository</span><span class=p>.</span><span class=nx>findById</span><span class=p>(</span><span class=nx>orderId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>order</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;Order not found&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>event</span> <span class=o>=</span> <span class=nx>order</span><span class=p>.</span><span class=nx>confirm</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>orderRepository</span><span class=p>.</span><span class=nx>save</span><span class=p>(</span><span class=nx>order</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>eventBus</span><span class=p>.</span><span class=nx>publish</span><span class=p>(</span><span class=nx>event</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 리포지토리 인터페이스 (데이터 액세스 추상화)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>export</span> <span class=kr>interface</span> <span class=nx>OrderRepository</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>save</span><span class=p>(</span><span class=nx>order</span>: <span class=kt>Order</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;;</span>
</span></span><span class=line><span class=cl>    <span class=nx>findById</span><span class=p>(</span><span class=nx>id</span>: <span class=kt>string</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>Order</span> <span class=err>|</span> <span class=na>null</span><span class=p>&gt;;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 4. 재고 모듈 (Inventory Module) 구현
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>namespace</span> <span class=nx>InventoryModule</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=kr>export</span> <span class=kr>class</span> <span class=nx>InventoryItem</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>constructor</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=kr>public</span> <span class=kr>readonly</span> <span class=nx>productId</span>: <span class=kt>string</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=kr>public</span> <span class=nx>availableQuantity</span>: <span class=kt>number</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=kr>public</span> <span class=nx>reservedQuantity</span>: <span class=kt>number</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 재고 예약 비즈니스 로직
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>reserve</span><span class=p>(</span><span class=nx>quantity</span>: <span class=kt>number</span><span class=p>)</span><span class=o>:</span> <span class=k>void</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>availableQuantity</span> <span class=o>&lt;</span> <span class=nx>quantity</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;Insufficient inventory&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>availableQuantity</span> <span class=o>-=</span> <span class=nx>quantity</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>reservedQuantity</span> <span class=o>+=</span> <span class=nx>quantity</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 재고 모듈의 공개 API
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>export</span> <span class=kr>class</span> <span class=nx>InventoryAPI</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>constructor</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=kr>private</span> <span class=nx>eventBus</span>: <span class=kt>EventBus</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=kr>private</span> <span class=nx>inventoryRepository</span>: <span class=kt>InventoryRepository</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 주문 생성 이벤트 구독
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>this</span><span class=p>.</span><span class=nx>eventBus</span><span class=p>.</span><span class=nx>subscribe</span><span class=p>(</span><span class=s1>&#39;OrderCreated&#39;</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>handleOrderCreated</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=k>this</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 주문 생성 이벤트 핸들러 (모듈 간 통신)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>private</span> <span class=kr>async</span> <span class=nx>handleOrderCreated</span><span class=p>(</span><span class=nx>event</span>: <span class=kt>DomainEvent</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=p>{</span> <span class=nx>orderId</span><span class=p>,</span> <span class=nx>items</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>event</span><span class=p>.</span><span class=nx>payload</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Processing inventory reservation for order: </span><span class=si>${</span><span class=nx>orderId</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 모든 아이템에 대해 재고 예약
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span> <span class=p>(</span><span class=kr>const</span> <span class=nx>item</span> <span class=k>of</span> <span class=nx>items</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>reserveInventory</span><span class=p>(</span><span class=nx>item</span><span class=p>.</span><span class=nx>productId</span><span class=p>,</span> <span class=nx>item</span><span class=p>.</span><span class=nx>quantity</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 재고 예약 완료 이벤트 발행
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>reservedEvent</span>: <span class=kt>DomainEvent</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>eventId</span>: <span class=kt>crypto.randomUUID</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>          <span class=nx>eventType</span><span class=o>:</span> <span class=s1>&#39;InventoryReserved&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>aggregateId</span>: <span class=kt>orderId</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>payload</span><span class=o>:</span> <span class=p>{</span> <span class=nx>orderId</span><span class=p>,</span> <span class=nx>items</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>          <span class=nx>occurredAt</span>: <span class=kt>new</span> <span class=nb>Date</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>eventBus</span><span class=p>.</span><span class=nx>publish</span><span class=p>(</span><span class=nx>reservedEvent</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 재고 부족 시 보상 이벤트 발행
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>failedEvent</span>: <span class=kt>DomainEvent</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>eventId</span>: <span class=kt>crypto.randomUUID</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>          <span class=nx>eventType</span><span class=o>:</span> <span class=s1>&#39;InventoryReservationFailed&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>aggregateId</span>: <span class=kt>orderId</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>payload</span><span class=o>:</span> <span class=p>{</span> <span class=nx>orderId</span><span class=p>,</span> <span class=nx>error</span>: <span class=kt>error.message</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>          <span class=nx>occurredAt</span>: <span class=kt>new</span> <span class=nb>Date</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>eventBus</span><span class=p>.</span><span class=nx>publish</span><span class=p>(</span><span class=nx>failedEvent</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 재고 예약 API
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>async</span> <span class=nx>reserveInventory</span><span class=p>(</span><span class=nx>productId</span>: <span class=kt>string</span><span class=p>,</span> <span class=nx>quantity</span>: <span class=kt>number</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>inventory</span> <span class=o>=</span> <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>inventoryRepository</span><span class=p>.</span><span class=nx>findByProductId</span><span class=p>(</span><span class=nx>productId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>inventory</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=sb>`Product </span><span class=si>${</span><span class=nx>productId</span><span class=si>}</span><span class=sb> not found in inventory`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=nx>inventory</span><span class=p>.</span><span class=nx>reserve</span><span class=p>(</span><span class=nx>quantity</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>inventoryRepository</span><span class=p>.</span><span class=nx>save</span><span class=p>(</span><span class=nx>inventory</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>export</span> <span class=kr>interface</span> <span class=nx>InventoryRepository</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>save</span><span class=p>(</span><span class=nx>inventory</span>: <span class=kt>InventoryItem</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;;</span>
</span></span><span class=line><span class=cl>    <span class=nx>findByProductId</span><span class=p>(</span><span class=nx>productId</span>: <span class=kt>string</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>InventoryItem</span> <span class=err>|</span> <span class=na>null</span><span class=p>&gt;;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 5. 애플리케이션 부트스트랩 (모든 모듈 조합)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>class</span> <span class=nx>ModularMonolithApp</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>eventBus</span>: <span class=kt>EventBus</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>ordersAPI</span>: <span class=kt>OrdersModule.OrdersAPI</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>inventoryAPI</span>: <span class=kt>InventoryModule.InventoryAPI</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>constructor</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>eventBus</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>EventBus</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 각 모듈 초기화 (의존성 주입)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>this</span><span class=p>.</span><span class=nx>ordersAPI</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>OrdersModule</span><span class=p>.</span><span class=nx>OrdersAPI</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>eventBus</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=nx>MockOrderRepository</span><span class=p>()</span> <span class=c1>// 실제 구현에서는 실제 리포지토리 사용
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>inventoryAPI</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>InventoryModule</span><span class=p>.</span><span class=nx>InventoryAPI</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>eventBus</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=nx>MockInventoryRepository</span><span class=p>()</span> <span class=c1>// 실제 구현에서는 실제 리포지토리 사용
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 애플리케이션 시작
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>async</span> <span class=nx>start</span><span class=p>()</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Modular Monolith Application started&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 예시: 주문 생성 플로우
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>orderId</span> <span class=o>=</span> <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>ordersAPI</span><span class=p>.</span><span class=nx>createOrder</span><span class=p>(</span><span class=s1>&#39;customer-123&#39;</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span> <span class=nx>productId</span><span class=o>:</span> <span class=s1>&#39;product-1&#39;</span><span class=p>,</span> <span class=nx>quantity</span>: <span class=kt>2</span><span class=p>,</span> <span class=nx>price</span>: <span class=kt>10.00</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span> <span class=nx>productId</span><span class=o>:</span> <span class=s1>&#39;product-2&#39;</span><span class=p>,</span> <span class=nx>quantity</span>: <span class=kt>1</span><span class=p>,</span> <span class=nx>price</span>: <span class=kt>25.00</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>]);</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Order created: </span><span class=si>${</span><span class=nx>orderId</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 잠시 후 주문 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>setTimeout</span><span class=p>(</span><span class=kr>async</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>ordersAPI</span><span class=p>.</span><span class=nx>confirmOrder</span><span class=p>(</span><span class=nx>orderId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Order confirmed: </span><span class=si>${</span><span class=nx>orderId</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Order processing failed:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 6. Mock Repositories (실제 구현에서는 실제 데이터베이스 연동)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>class</span> <span class=nx>MockOrderRepository</span> <span class=kr>implements</span> <span class=nx>OrdersModule</span><span class=p>.</span><span class=nx>OrderRepository</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>orders</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Map</span><span class=p>&lt;</span><span class=nt>string</span><span class=p>,</span> <span class=na>OrdersModule.Order</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>save</span><span class=p>(</span><span class=nx>order</span>: <span class=kt>OrdersModule.Order</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>orders</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=nx>order</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span> <span class=nx>order</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>findById</span><span class=p>(</span><span class=nx>id</span>: <span class=kt>string</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>OrdersModule.Order</span> <span class=err>|</span> <span class=na>null</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>orders</span><span class=p>.</span><span class=kr>get</span><span class=p>(</span><span class=nx>id</span><span class=p>)</span> <span class=o>||</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>class</span> <span class=nx>MockInventoryRepository</span> <span class=kr>implements</span> <span class=nx>InventoryModule</span><span class=p>.</span><span class=nx>InventoryRepository</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>inventory</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Map</span><span class=p>&lt;</span><span class=nt>string</span><span class=p>,</span> <span class=na>InventoryModule.InventoryItem</span><span class=p>&gt;([</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=s1>&#39;product-1&#39;</span><span class=p>,</span> <span class=k>new</span> <span class=nx>InventoryModule</span><span class=p>.</span><span class=nx>InventoryItem</span><span class=p>(</span><span class=s1>&#39;product-1&#39;</span><span class=p>,</span> <span class=mi>100</span><span class=p>)],</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=s1>&#39;product-2&#39;</span><span class=p>,</span> <span class=k>new</span> <span class=nx>InventoryModule</span><span class=p>.</span><span class=nx>InventoryItem</span><span class=p>(</span><span class=s1>&#39;product-2&#39;</span><span class=p>,</span> <span class=mi>50</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>  <span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>save</span><span class=p>(</span><span class=nx>inventory</span>: <span class=kt>InventoryModule.InventoryItem</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>inventory</span><span class=p>.</span><span class=kr>set</span><span class=p>(</span><span class=nx>inventory</span><span class=p>.</span><span class=nx>productId</span><span class=p>,</span> <span class=nx>inventory</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>findByProductId</span><span class=p>(</span><span class=nx>productId</span>: <span class=kt>string</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>InventoryModule.InventoryItem</span> <span class=err>|</span> <span class=na>null</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=nx>inventory</span><span class=p>.</span><span class=kr>get</span><span class=p>(</span><span class=nx>productId</span><span class=p>)</span> <span class=o>||</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 애플리케이션 실행
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ModularMonolithApp</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>start</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-4-온라인-쇼핑몰>사례 4: 온라인 쇼핑몰<a hidden class=anchor aria-hidden=true href=#사례-4-온라인-쇼핑몰>#</a></h4><p><strong>시나리오:</strong> 온라인 쇼핑몰에서 상품, 주문, 결제, 배송 도메인을 각각 별도 모듈로 관리하면서, 단일 Application 으로 배포하는 구조</p><p><strong>시스템 구성:</strong></p><ul><li>API 게이트웨이 모듈</li><li>상품 도메인 모듈</li><li>주문 도메인 모듈</li><li>결제 모듈</li><li>배송 모듈</li><li>공통 인프라 모듈 (인증/로깅 등)</li><li>단일 DB</li></ul><pre class=mermaid>graph TB
  subgraph Modular Monolith Application
    A[API 게이트웨이]
    B[상품 모듈]
    C[주문 모듈]
    D[결제 모듈]
    E[배송 모듈]
    F[&#34;공통 인프라(인증, 로깅)&#34;]
    G[단일 DB]
    A --&gt; B
    A --&gt; C
    A --&gt; D
    A --&gt; E
    B --- F
    C --- F
    D --- F
    E --- F
    B --&gt; G
    C --&gt; G
    D --&gt; G
    E --&gt; G
  end
</pre><p><strong>Workflow:</strong></p><ul><li>사용자가 주문 생성 API 호출</li><li>주문 모듈에서 상품, 결제, 배송 등 관련 모듈에 필요한 기능 호출</li><li>각 도메인 내에서 책임/검증 진행</li><li>최종적으로 단일 DB 에 트랜잭션 처리 후 응답 반환</li></ul><p><strong>역할:</strong></p><ul><li>각 모듈은 자신의 도메인 책임만 수행</li><li>공통 모듈은 인증, 로그 등 시스템 전반 지원</li><li>단일 배포로 운영이나 내부 구조는 분리되어 관리</li></ul><p><strong>유무에 따른 차이점</strong>:</p><ul><li>Modular Monolith(모듈러 모놀리스) 미적용 시 도메인 간 로직이 혼재되어 변화 영향 폭이 커지고, 유지보수가 어려우며, 마이크로서비스 전환이 힘듦</li><li>적용 시 각 도메인/비즈니스 책임이 분명, 추후 서비스 쪼개기 쉬움</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1> 1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2> 2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3> 3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4> 4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5> 5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6> 6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7> 7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8> 8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9> 9</a>
</span><span class=lnt id=hl-14-10><a class=lnlinks href=#hl-14-10>10</a>
</span><span class=lnt id=hl-14-11><a class=lnlinks href=#hl-14-11>11</a>
</span><span class=lnt id=hl-14-12><a class=lnlinks href=#hl-14-12>12</a>
</span><span class=lnt id=hl-14-13><a class=lnlinks href=#hl-14-13>13</a>
</span><span class=lnt id=hl-14-14><a class=lnlinks href=#hl-14-14>14</a>
</span><span class=lnt id=hl-14-15><a class=lnlinks href=#hl-14-15>15</a>
</span><span class=lnt id=hl-14-16><a class=lnlinks href=#hl-14-16>16</a>
</span><span class=lnt id=hl-14-17><a class=lnlinks href=#hl-14-17>17</a>
</span><span class=lnt id=hl-14-18><a class=lnlinks href=#hl-14-18>18</a>
</span><span class=lnt id=hl-14-19><a class=lnlinks href=#hl-14-19>19</a>
</span><span class=lnt id=hl-14-20><a class=lnlinks href=#hl-14-20>20</a>
</span><span class=lnt id=hl-14-21><a class=lnlinks href=#hl-14-21>21</a>
</span><span class=lnt id=hl-14-22><a class=lnlinks href=#hl-14-22>22</a>
</span><span class=lnt id=hl-14-23><a class=lnlinks href=#hl-14-23>23</a>
</span><span class=lnt id=hl-14-24><a class=lnlinks href=#hl-14-24>24</a>
</span><span class=lnt id=hl-14-25><a class=lnlinks href=#hl-14-25>25</a>
</span><span class=lnt id=hl-14-26><a class=lnlinks href=#hl-14-26>26</a>
</span><span class=lnt id=hl-14-27><a class=lnlinks href=#hl-14-27>27</a>
</span><span class=lnt id=hl-14-28><a class=lnlinks href=#hl-14-28>28</a>
</span><span class=lnt id=hl-14-29><a class=lnlinks href=#hl-14-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 상품 모듈 (/modules/products/service.py)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ProductService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_product</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>product_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 상품 데이터 조회 및 검증</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 주문 모듈 (/modules/orders/service.py)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>product_service</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>product_service</span> <span class=o>=</span> <span class=n>product_service</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_order</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_data</span><span class=p>:</span> <span class=nb>dict</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. 상품 모듈의 get_product 호출로 유효성 검증</span>
</span></span><span class=line><span class=cl>        <span class=n>product</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>product_service</span><span class=o>.</span><span class=n>get_product</span><span class=p>(</span><span class=n>order_data</span><span class=p>[</span><span class=s2>&#34;product_id&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=c1># 2. 주문 생성 로직</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메인 어플리케이션 레이어 (main.py)</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>modules.products.service</span> <span class=kn>import</span> <span class=n>ProductService</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>modules.orders.service</span> <span class=kn>import</span> <span class=n>OrderService</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>product_service</span> <span class=o>=</span> <span class=n>ProductService</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>order_service</span> <span class=o>=</span> <span class=n>OrderService</span><span class=p>(</span><span class=n>product_service</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.post</span><span class=p>(</span><span class=s2>&#34;/order&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_order</span><span class=p>(</span><span class=n>order_data</span><span class=p>:</span> <span class=nb>dict</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>order_service</span><span class=o>.</span><span class=n>create_order</span><span class=p>(</span><span class=n>order_data</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>각 도메인별 모듈의 경계를 서비스 객체로 캡슐화</li><li>모듈 간 의존성은 생성자 주입 방식으로 관리</li><li>모든 배포는 하나의 애플리케이션으로, 테스트 및 운영 시 모듈별 책임 유지</li></ul><h3 id=git-기반-예제-프로젝트-구조>Git 기반 예제 프로젝트 구조<a hidden class=anchor aria-hidden=true href=#git-기반-예제-프로젝트-구조>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1> 1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2> 2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3> 3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4> 4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5> 5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6> 6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7> 7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8> 8</a>
</span><span class=lnt id=hl-15-9><a class=lnlinks href=#hl-15-9> 9</a>
</span><span class=lnt id=hl-15-10><a class=lnlinks href=#hl-15-10>10</a>
</span><span class=lnt id=hl-15-11><a class=lnlinks href=#hl-15-11>11</a>
</span><span class=lnt id=hl-15-12><a class=lnlinks href=#hl-15-12>12</a>
</span><span class=lnt id=hl-15-13><a class=lnlinks href=#hl-15-13>13</a>
</span><span class=lnt id=hl-15-14><a class=lnlinks href=#hl-15-14>14</a>
</span><span class=lnt id=hl-15-15><a class=lnlinks href=#hl-15-15>15</a>
</span><span class=lnt id=hl-15-16><a class=lnlinks href=#hl-15-16>16</a>
</span><span class=lnt id=hl-15-17><a class=lnlinks href=#hl-15-17>17</a>
</span><span class=lnt id=hl-15-18><a class=lnlinks href=#hl-15-18>18</a>
</span><span class=lnt id=hl-15-19><a class=lnlinks href=#hl-15-19>19</a>
</span><span class=lnt id=hl-15-20><a class=lnlinks href=#hl-15-20>20</a>
</span><span class=lnt id=hl-15-21><a class=lnlinks href=#hl-15-21>21</a>
</span><span class=lnt id=hl-15-22><a class=lnlinks href=#hl-15-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>modular-monolith/
</span></span><span class=line><span class=cl>├── src/
</span></span><span class=line><span class=cl>│   ├── api/                     <span class=c1># Entry point (Web/API)</span>
</span></span><span class=line><span class=cl>│   │   └── app.ts
</span></span><span class=line><span class=cl>│   ├── modules/
</span></span><span class=line><span class=cl>│   │   ├── order/
</span></span><span class=line><span class=cl>│   │   │   ├── dto/
</span></span><span class=line><span class=cl>│   │   │   ├── domain/
</span></span><span class=line><span class=cl>│   │   │   └── infra/
</span></span><span class=line><span class=cl>│   │   ├── inventory/
</span></span><span class=line><span class=cl>│   │   │   ├── dto/
</span></span><span class=line><span class=cl>│   │   │   ├── domain/
</span></span><span class=line><span class=cl>│   │   │   └── infra/
</span></span><span class=line><span class=cl>│   │   └── shared/
</span></span><span class=line><span class=cl>│   │       └── contracts/      <span class=c1># 모듈 간 이벤트/DTO 계약</span>
</span></span><span class=line><span class=cl>│   ├── common/
</span></span><span class=line><span class=cl>│   │   ├── di-container.ts
</span></span><span class=line><span class=cl>│   │   └── middleware/
</span></span><span class=line><span class=cl>│   └── infrastructure/
</span></span><span class=line><span class=cl>│       ├── db/
</span></span><span class=line><span class=cl>│       └── event-bus/
</span></span><span class=line><span class=cl>└── package.json
</span></span></code></pre></td></tr></table></div></div><p><strong>구조 설명:</strong></p><ul><li><code>api/</code>: 모듈 호출 진입점 (Express, NestJS 등 사용 가능)</li><li><code>modules/{name}</code>: 도메인 단위 모듈</li><li><code>shared/contracts</code>: 모듈 간 계약 (이벤트, DTO) 정의</li><li><code>common/di-container.ts</code>: 의존성 주입 설정</li><li><code>infrastructure/event-bus</code>: 이벤트 버스 구현 (예: in-memory, RabbitMQ 등)</li></ul><h4 id=구현-예시-typescript--nodejs>구현 예시 (TypeScript + Node.js)<a hidden class=anchor aria-hidden=true href=#구현-예시-typescript--nodejs>#</a></h4><h5 id=이벤트-계약-sharedcontractsordereventsts>이벤트 계약 (shared/contracts/order.events.ts)<a hidden class=anchor aria-hidden=true href=#이벤트-계약-sharedcontractsordereventsts>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1>1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2>2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3>3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=kr>export</span> <span class=kr>interface</span> <span class=nx>OrderCreated</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>orderId</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>items</span>: <span class=kt>Array</span><span class=o>&lt;</span><span class=p>{</span> <span class=nx>productId</span>: <span class=kt>string</span><span class=p>;</span> <span class=nx>qty</span>: <span class=kt>number</span><span class=p>;</span> <span class=p>}</span><span class=o>&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=order-모듈---도메인-로직-및-이벤트-발행>Order 모듈 - 도메인 로직 및 이벤트 발행<a hidden class=anchor aria-hidden=true href=#order-모듈---도메인-로직-및-이벤트-발행>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1> 1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2> 2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3> 3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4> 4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5> 5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6> 6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7> 7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8> 8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9> 9</a>
</span><span class=lnt id=hl-17-10><a class=lnlinks href=#hl-17-10>10</a>
</span><span class=lnt id=hl-17-11><a class=lnlinks href=#hl-17-11>11</a>
</span><span class=lnt id=hl-17-12><a class=lnlinks href=#hl-17-12>12</a>
</span><span class=lnt id=hl-17-13><a class=lnlinks href=#hl-17-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=c1>// modules/order/domain/orderService.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>OrderCreated</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../../shared/contracts/order.events&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>EventBus</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../../infrastructure/event-bus&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>class</span> <span class=nx>OrderService</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>constructor</span><span class=p>(</span><span class=kr>private</span> <span class=nx>eventBus</span>: <span class=kt>EventBus</span><span class=p>)</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>createOrder</span><span class=p>(</span><span class=nx>orderId</span>: <span class=kt>string</span><span class=p>,</span> <span class=nx>items</span>: <span class=kt>unknown</span><span class=p>[])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 비즈니스 로직, DB 저장…
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>event</span>: <span class=kt>OrderCreated</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>orderId</span><span class=p>,</span> <span class=nx>items</span>: <span class=kt>items</span> <span class=kr>as</span> <span class=kt>any</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>eventBus</span><span class=p>.</span><span class=nx>publish</span><span class=p>(</span><span class=s1>&#39;order.created&#39;</span><span class=p>,</span> <span class=nx>event</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=inventory-모듈---이벤트-처리-핸들러>Inventory 모듈 - 이벤트 처리 핸들러<a hidden class=anchor aria-hidden=true href=#inventory-모듈---이벤트-처리-핸들러>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1> 1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2> 2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3> 3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4> 4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5> 5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6> 6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7> 7</a>
</span><span class=lnt id=hl-18-8><a class=lnlinks href=#hl-18-8> 8</a>
</span><span class=lnt id=hl-18-9><a class=lnlinks href=#hl-18-9> 9</a>
</span><span class=lnt id=hl-18-10><a class=lnlinks href=#hl-18-10>10</a>
</span><span class=lnt id=hl-18-11><a class=lnlinks href=#hl-18-11>11</a>
</span><span class=lnt id=hl-18-12><a class=lnlinks href=#hl-18-12>12</a>
</span><span class=lnt id=hl-18-13><a class=lnlinks href=#hl-18-13>13</a>
</span><span class=lnt id=hl-18-14><a class=lnlinks href=#hl-18-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=c1>// modules/inventory/infra/inventorySubscriber.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>OrderCreated</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../../shared/contracts/order.events&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>EventBus</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../../infrastructure/event-bus&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>class</span> <span class=nx>InventorySubscriber</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>constructor</span><span class=p>(</span><span class=nx>eventBus</span>: <span class=kt>EventBus</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>eventBus</span><span class=p>.</span><span class=nx>subscribe</span><span class=p>(</span><span class=s1>&#39;order.created&#39;</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>handleOrderCreated</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=k>this</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>handleOrderCreated</span><span class=p>(</span><span class=nx>payload</span>: <span class=kt>OrderCreated</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 재고 확인 및 차감
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Reduce stock for order </span><span class=si>${</span><span class=nx>payload</span><span class=p>.</span><span class=nx>orderId</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=이벤트-버스-구성>이벤트 버스 구성<a hidden class=anchor aria-hidden=true href=#이벤트-버스-구성>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12>12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13>13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14>14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=c1>// infrastructure/event-bus/eventBus.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>type</span> <span class=nx>Handler</span> <span class=o>=</span> <span class=p>(</span><span class=nx>payload</span>: <span class=kt>any</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;</span> <span class=o>|</span> <span class=k>void</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>class</span> <span class=nx>EventBus</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>private</span> <span class=nx>handlers</span>: <span class=kt>Record</span><span class=p>&lt;</span><span class=nt>string</span><span class=p>,</span> <span class=na>Handler</span><span class=err>[]</span><span class=p>&gt;</span> <span class=o>=</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>publish</span><span class=p>(</span><span class=nx>topic</span>: <span class=kt>string</span><span class=p>,</span> <span class=nx>payload</span>: <span class=kt>any</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>handlers</span><span class=p>[</span><span class=nx>topic</span><span class=p>]</span> <span class=o>||</span> <span class=p>[]).</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>h</span> <span class=o>=&gt;</span> <span class=nx>h</span><span class=p>(</span><span class=nx>payload</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>subscribe</span><span class=p>(</span><span class=nx>topic</span>: <span class=kt>string</span><span class=p>,</span> <span class=nx>handler</span>: <span class=kt>Handler</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>handlers</span><span class=p>[</span><span class=nx>topic</span><span class=p>]</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>handlers</span><span class=p>[</span><span class=nx>topic</span><span class=p>]</span> <span class=o>||</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>handlers</span><span class=p>[</span><span class=nx>topic</span><span class=p>].</span><span class=nx>push</span><span class=p>(</span><span class=nx>handler</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=di-및-앱-초기화>DI 및 앱 초기화<a hidden class=anchor aria-hidden=true href=#di-및-앱-초기화>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1> 1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2> 2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3> 3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4> 4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5> 5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6> 6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7> 7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8> 8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9> 9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10>10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11>11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12>12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13>13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14>14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15>15</a>
</span><span class=lnt id=hl-20-16><a class=lnlinks href=#hl-20-16>16</a>
</span><span class=lnt id=hl-20-17><a class=lnlinks href=#hl-20-17>17</a>
</span><span class=lnt id=hl-20-18><a class=lnlinks href=#hl-20-18>18</a>
</span><span class=lnt id=hl-20-19><a class=lnlinks href=#hl-20-19>19</a>
</span><span class=lnt id=hl-20-20><a class=lnlinks href=#hl-20-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ts data-lang=ts><span class=line><span class=cl><span class=c1>// api/app.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=nx>express</span> <span class=kr>from</span> <span class=s1>&#39;express&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>OrderService</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../modules/order/domain/orderService&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>InventorySubscriber</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../modules/inventory/infra/inventorySubscriber&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>EventBus</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;../infrastructure/event-bus/eventBus&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>bus</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>EventBus</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// DI
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>orderSvc</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>OrderService</span><span class=p>(</span><span class=nx>bus</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>new</span> <span class=nx>InventorySubscriber</span><span class=p>(</span><span class=nx>bus</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/order&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>orderId</span><span class=p>,</span> <span class=nx>items</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>await</span> <span class=nx>orderSvc</span><span class=p>.</span><span class=nx>createOrder</span><span class=p>(</span><span class=nx>orderId</span><span class=p>,</span> <span class=nx>items</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>sendStatus</span><span class=p>(</span><span class=mi>201</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=mi>3000</span><span class=p>,</span> <span class=p>()</span> <span class=o>=&gt;</span> <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Server started&#39;</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=전통-모놀리식--modular-monolith-로-전환-로드맵>전통 모놀리식 → Modular Monolith 로 전환 로드맵<a hidden class=anchor aria-hidden=true href=#전통-모놀리식--modular-monolith-로-전환-로드맵>#</a></h3><table><thead><tr><th>단계</th><th>목표</th><th>상세 설명</th></tr></thead><tbody><tr><td>1 단계</td><td>기능 그룹 정의</td><td>도메인 기능별로 책임 분리 (예: 주문, 결제, 상품)</td></tr><tr><td>2 단계</td><td>폴더/패키지 구조 정리</td><td>모듈 폴더화, 유틸 공통화, 내부/외부 API 구분</td></tr><tr><td>3 단계</td><td>Layered 구조 도입</td><td>Presentation, Application, Domain, Infra 구조화</td></tr><tr><td>4 단계</td><td>인터페이스 경계 정의</td><td>모듈 간 직접 참조 방지, 의존 역전 원칙 적용</td></tr><tr><td>5 단계</td><td>모듈화 린트 적용</td><td>정적 분석 도입, 경계 침범 자동 감지 도구 배포</td></tr><tr><td>6 단계</td><td>테스트 기반 리팩토링</td><td>기존 기능은 테스트 후 전환, TDD 병행</td></tr><tr><td>7 단계</td><td>In-Process → 이벤트 도입</td><td>느슨한 결합 확보 (예: 이벤트 버스 패턴 도입)</td></tr><tr><td>8 단계</td><td>성능/관측 체계 통합</td><td>성능 분석 및 장애 진단 체계 마련</td></tr></tbody></table><h3 id=modular-monolith-아키텍처-안에서-kafka-를-이용한-모듈-간-이벤트-통신>Modular Monolith 아키텍처 안에서 Kafka 를 이용한 모듈 간 이벤트 통신<a hidden class=anchor aria-hidden=true href=#modular-monolith-아키텍처-안에서-kafka-를-이용한-모듈-간-이벤트-통신>#</a></h3><p>Kafka 를 Modular Monolith 내부에서 모듈 간 통신에 도입하면 다음 효과를 얻을 수 있다:</p><ul><li><strong>모듈 간 강한 결합 해소</strong> → 유지보수성 상승</li><li><strong>비동기 처리 도입</strong> → 응답 속도 개선</li><li><strong>MSA 전환 구조 선제적 확보</strong> → 이벤트 기반 서비스 분리 용이</li><li><strong>중앙 브로커 기반 처리</strong> → 확장성과 유연한 로깅/모니터링 가능</li></ul><h4 id=개요-및-설계-목적>개요 및 설계 목적<a hidden class=anchor aria-hidden=true href=#개요-및-설계-목적>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>아키텍처 유형</strong></td><td>Modular Monolith (단일 배포 + 모듈 분리)</td></tr><tr><td><strong>통신 방식</strong></td><td>Kafka 기반 비동기 메시징 (Domain Event → Topic 발행 → 모듈 수신)</td></tr><tr><td><strong>도입 목적</strong></td><td>모듈 간 직접 호출을 제거하여 느슨한 결합 구현, 마이크로서비스 전환 유연성 확보</td></tr><tr><td><strong>전환 확장성</strong></td><td>MSA 전환 시 Kafka 구독 구조 그대로 활용 가능 (모듈 → 서비스 이관 시 무중단 전환)</td></tr><tr><td><strong>기능 적용 예시</strong></td><td>주문 완료 후 결제/재고/알림 모듈에서 독립 처리 (<code>OrderPlaced</code> → 여러 Consumer)</td></tr></tbody></table><h4 id=아키텍처-구성>아키텍처 구성<a hidden class=anchor aria-hidden=true href=#아키텍처-구성>#</a></h4><pre class=mermaid>flowchart TD
  subgraph Modular Monolith App
    direction TB
    A1[Order Module] --&gt;|OrderPlaced Event| KafkaProducer
    A2[Payment Module]
    A3[Inventory Module]
    A4[Notification Module]
  end

  KafkaProducer --&gt;|Publish to Topic: order.placed| KafkaBroker[(Kafka Broker)]

  KafkaBroker --&gt; C1[&#34;KafkaConsumer (PaymentListener)&#34;]
  KafkaBroker --&gt; C2[&#34;KafkaConsumer (InventoryListener)&#34;]
  KafkaBroker --&gt; C3[&#34;KafkaConsumer (NotificationListener)&#34;]

  C1 --&gt; A2
  C2 --&gt; A3
  C3 --&gt; A4
</pre><h4 id=설계-구성-요소-및-역할>설계 구성 요소 및 역할<a hidden class=anchor aria-hidden=true href=#설계-구성-요소-및-역할>#</a></h4><table><thead><tr><th>구성 요소</th><th>설명</th></tr></thead><tbody><tr><td><strong>KafkaProducer</strong></td><td><code>DomainEvent</code> 를 Kafka Topic 에 발행 (발행자 모듈 내부에 위치)</td></tr><tr><td><strong>KafkaBroker</strong></td><td>이벤트를 중계하는 Kafka 클러스터 (토픽 기반 라우팅)</td></tr><tr><td><strong>KafkaConsumer</strong></td><td>특정 토픽을 구독하여 모듈에 이벤트를 전달 (모듈별 리스너 존재)</td></tr><tr><td><strong>DomainEvent</strong></td><td>모듈 내부 상태 변화에 따라 생성되는 이벤트 (<code>OrderPlaced</code>, <code>UserRegistered</code>)</td></tr><tr><td><strong>EventDispatcher</strong></td><td>이벤트를 Kafka 로 발행하는 통합 인터페이스</td></tr><tr><td><strong>EventHandler</strong></td><td>Consumer 쪽에서 실제 비즈니스 로직 처리 담당</td></tr><tr><td><strong>Event Mapper (선택)</strong></td><td>Domain → Integration Event 로 변환 필요 시 사용 (버전/스키마 고려)</td></tr></tbody></table><h4 id=코드-설계-예시>코드 설계 예시<a hidden class=anchor aria-hidden=true href=#코드-설계-예시>#</a></h4><h5 id=도메인-이벤트-정의>도메인 이벤트 정의<a hidden class=anchor aria-hidden=true href=#도메인-이벤트-정의>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1>1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2>2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3>3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4>4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5>5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># events.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderPlaced</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>,</span> <span class=n>user_id</span><span class=p>,</span> <span class=n>items</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>order_id</span> <span class=o>=</span> <span class=n>order_id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_id</span> <span class=o>=</span> <span class=n>user_id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>items</span> <span class=o>=</span> <span class=n>items</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=kafka-producer>Kafka Producer<a hidden class=anchor aria-hidden=true href=#kafka-producer>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1> 1</a>
</span><span class=lnt id=hl-23-2><a class=lnlinks href=#hl-23-2> 2</a>
</span><span class=lnt id=hl-23-3><a class=lnlinks href=#hl-23-3> 3</a>
</span><span class=lnt id=hl-23-4><a class=lnlinks href=#hl-23-4> 4</a>
</span><span class=lnt id=hl-23-5><a class=lnlinks href=#hl-23-5> 5</a>
</span><span class=lnt id=hl-23-6><a class=lnlinks href=#hl-23-6> 6</a>
</span><span class=lnt id=hl-23-7><a class=lnlinks href=#hl-23-7> 7</a>
</span><span class=lnt id=hl-23-8><a class=lnlinks href=#hl-23-8> 8</a>
</span><span class=lnt id=hl-23-9><a class=lnlinks href=#hl-23-9> 9</a>
</span><span class=lnt id=hl-23-10><a class=lnlinks href=#hl-23-10>10</a>
</span><span class=lnt id=hl-23-11><a class=lnlinks href=#hl-23-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># kafka_producer.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaProducer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s2>&#34;localhost:9092&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_serializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>v</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>v</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>publish_event</span><span class=p>(</span><span class=n>topic</span><span class=p>,</span> <span class=n>event</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>topic</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=nb>vars</span><span class=p>(</span><span class=n>event</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=도메인-서비스-내부-발행>도메인 서비스 내부 발행<a hidden class=anchor aria-hidden=true href=#도메인-서비스-내부-발행>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1>1</a>
</span><span class=lnt id=hl-24-2><a class=lnlinks href=#hl-24-2>2</a>
</span><span class=lnt id=hl-24-3><a class=lnlinks href=#hl-24-3>3</a>
</span><span class=lnt id=hl-24-4><a class=lnlinks href=#hl-24-4>4</a>
</span><span class=lnt id=hl-24-5><a class=lnlinks href=#hl-24-5>5</a>
</span><span class=lnt id=hl-24-6><a class=lnlinks href=#hl-24-6>6</a>
</span><span class=lnt id=hl-24-7><a class=lnlinks href=#hl-24-7>7</a>
</span><span class=lnt id=hl-24-8><a class=lnlinks href=#hl-24-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># order_service.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>events</span> <span class=kn>import</span> <span class=n>OrderPlaced</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka_producer</span> <span class=kn>import</span> <span class=n>publish_event</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>place_order</span><span class=p>(</span><span class=n>order_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 주문 처리 로직 …</span>
</span></span><span class=line><span class=cl>    <span class=n>event</span> <span class=o>=</span> <span class=n>OrderPlaced</span><span class=p>(</span><span class=n>order_id</span><span class=o>=</span><span class=n>order_data</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=n>user_id</span><span class=o>=</span><span class=n>order_data</span><span class=o>.</span><span class=n>user_id</span><span class=p>,</span> <span class=n>items</span><span class=o>=</span><span class=n>order_data</span><span class=o>.</span><span class=n>items</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>publish_event</span><span class=p>(</span><span class=s2>&#34;order.placed&#34;</span><span class=p>,</span> <span class=n>event</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=kafka-consumer--리스너>Kafka Consumer & 리스너<a hidden class=anchor aria-hidden=true href=#kafka-consumer--리스너>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1> 1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2> 2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3> 3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4> 4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5> 5</a>
</span><span class=lnt id=hl-25-6><a class=lnlinks href=#hl-25-6> 6</a>
</span><span class=lnt id=hl-25-7><a class=lnlinks href=#hl-25-7> 7</a>
</span><span class=lnt id=hl-25-8><a class=lnlinks href=#hl-25-8> 8</a>
</span><span class=lnt id=hl-25-9><a class=lnlinks href=#hl-25-9> 9</a>
</span><span class=lnt id=hl-25-10><a class=lnlinks href=#hl-25-10>10</a>
</span><span class=lnt id=hl-25-11><a class=lnlinks href=#hl-25-11>11</a>
</span><span class=lnt id=hl-25-12><a class=lnlinks href=#hl-25-12>12</a>
</span><span class=lnt id=hl-25-13><a class=lnlinks href=#hl-25-13>13</a>
</span><span class=lnt id=hl-25-14><a class=lnlinks href=#hl-25-14>14</a>
</span><span class=lnt id=hl-25-15><a class=lnlinks href=#hl-25-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># inventory_listener.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaConsumer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;order.placed&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s2>&#34;localhost:9092&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_deserializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>    <span class=n>group_id</span><span class=o>=</span><span class=s2>&#34;inventory-service&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>message</span> <span class=ow>in</span> <span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>message</span><span class=o>.</span><span class=n>value</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;재고 차감 시작: 주문 ID = </span><span class=si>{</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 재고 처리 로직 실행</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=실무-설계-고려사항>실무 설계 고려사항<a hidden class=anchor aria-hidden=true href=#실무-설계-고려사항>#</a></h4><table><thead><tr><th>항목</th><th>전략</th></tr></thead><tbody><tr><td><strong>이벤트 중복 처리</strong></td><td>이벤트 ID 를 Redis 나 DB 에 저장하여 중복 소비 방지</td></tr><tr><td><strong>메시지 순서 보장</strong></td><td>파티션 키 사용 (<code>order_id</code>) 또는 토픽 설계 시 순서 고려</td></tr><tr><td><strong>Consumer Group 전략</strong></td><td>모듈별 고유 Consumer Group 할당 → 병렬 소비 가능</td></tr><tr><td><strong>에러 처리</strong></td><td>DLQ(Dead Letter Queue) 설정 또는 에러 리포팅 로직 구성</td></tr><tr><td><strong>Schema 관리</strong></td><td>JSON → Avro/Protobuf + Schema Registry 도입 가능</td></tr><tr><td><strong>테스트</strong></td><td>Mock Kafka 사용 (예: <code>kafka-python</code>, <code>testcontainers-kafka</code>)</td></tr><tr><td><strong>MSA 전환 대비</strong></td><td>현재 모듈의 Kafka Consumer/Producer 코드 → 독립 서비스에서 그대로 사용 가능하게 설계</td></tr><tr><td><strong>구성 자동화</strong></td><td>Docker Compose 또는 Kubernetes 로 Kafka, Zookeeper 구성 관리</td></tr></tbody></table><h4 id=구조적-정리>구조적 정리<a hidden class=anchor aria-hidden=true href=#구조적-정리>#</a></h4><h5 id=모듈-간-이벤트-통신-시나리오>모듈 간 이벤트 통신 시나리오<a hidden class=anchor aria-hidden=true href=#모듈-간-이벤트-통신-시나리오>#</a></h5><table><thead><tr><th>단계</th><th>설명</th></tr></thead><tbody><tr><td>1</td><td>주문 모듈에서 주문 완료 처리 후 <code>OrderPlaced</code> 이벤트 생성</td></tr><tr><td>2</td><td>이벤트를 Kafka Topic (<code>order.placed</code>) 에 발행</td></tr><tr><td>3</td><td>재고/결제/알림 등 모듈에서 해당 Topic 을 구독하여 이벤트 수신</td></tr><tr><td>4</td><td>각각 독립적으로 후속 비즈니스 처리 수행</td></tr></tbody></table><h4 id=모놀리식-내-이벤트-로그-기반-장애-추적-및-모니터링-구조>모놀리식 내 이벤트 로그 기반 장애 추적 및 모니터링 구조<a hidden class=anchor aria-hidden=true href=#모놀리식-내-이벤트-로그-기반-장애-추적-및-모니터링-구조>#</a></h4><p>이벤트 기반 구조를 채택한 모놀리식 시스템에서는 모듈 간 통신 흐름과 처리 결과를 추적할 수 있어야 한다.<br><strong>이벤트 로그 + 트레이싱 + 로깅</strong>을 기반으로 장애 발생 원인을 빠르게 파악할 수 있도록 해야 한다.</p><h5 id=아키텍처-구성-개요>아키텍처 구성 개요<a hidden class=anchor aria-hidden=true href=#아키텍처-구성-개요>#</a></h5><pre class=mermaid>flowchart TD
  A[Module A] --&gt;|Event: OrderCreated| B[Internal EventBus]
  B --&gt; C[&#34;Module B (Inventory)&#34;]
  B --&gt; D[&#34;Module C (Notification)&#34;]
  C --&gt; E[&#34;Event Logger (Append)&#34;]
  D --&gt; E
  E --&gt; F[Monitoring/Tracing Dashboard]
</pre><h6 id=구성-요소-및-설명>구성 요소 및 설명<a hidden class=anchor aria-hidden=true href=#구성-요소-및-설명>#</a></h6><table><thead><tr><th>구성 요소</th><th>설명</th><th>도구/기술 예시</th></tr></thead><tbody><tr><td><strong>EventBus</strong></td><td>내부 이벤트 라우팅 (동기/비동기)</td><td>Spring ApplicationEventPublisher, 자체 버스</td></tr><tr><td><strong>Event Logger</strong></td><td>이벤트 흐름, 결과 상태 기록</td><td>Custom Logging Layer, Kafka (내부 메시지 저장), Logstash</td></tr><tr><td><strong>Trace ID</strong></td><td>모듈 간 이벤트 추적을 위한 고유 식별자</td><td>UUID, ULID, Correlation ID</td></tr><tr><td><strong>Structured Logging</strong></td><td>로그 포맷 표준화, JSON 기반 처리</td><td>loguru (Python), slf4j (Java), winston (Node.js)</td></tr><tr><td><strong>Dashboard</strong></td><td>이벤트 흐름 및 상태 시각화</td><td>ELK Stack, Grafana + Loki, Prometheus, Zipkin</td></tr></tbody></table><h6 id=예시-이벤트-로그-포맷>예시: 이벤트 로그 포맷<a hidden class=anchor aria-hidden=true href=#예시-이벤트-로그-포맷>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-27-1><a class=lnlinks href=#hl-27-1> 1</a>
</span><span class=lnt id=hl-27-2><a class=lnlinks href=#hl-27-2> 2</a>
</span><span class=lnt id=hl-27-3><a class=lnlinks href=#hl-27-3> 3</a>
</span><span class=lnt id=hl-27-4><a class=lnlinks href=#hl-27-4> 4</a>
</span><span class=lnt id=hl-27-5><a class=lnlinks href=#hl-27-5> 5</a>
</span><span class=lnt id=hl-27-6><a class=lnlinks href=#hl-27-6> 6</a>
</span><span class=lnt id=hl-27-7><a class=lnlinks href=#hl-27-7> 7</a>
</span><span class=lnt id=hl-27-8><a class=lnlinks href=#hl-27-8> 8</a>
</span><span class=lnt id=hl-27-9><a class=lnlinks href=#hl-27-9> 9</a>
</span><span class=lnt id=hl-27-10><a class=lnlinks href=#hl-27-10>10</a>
</span><span class=lnt id=hl-27-11><a class=lnlinks href=#hl-27-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;event_name&#34;</span><span class=p>:</span> <span class=s2>&#34;OrderCreated&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;event_id&#34;</span><span class=p>:</span> <span class=s2>&#34;evt-123456&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;timestamp&#34;</span><span class=p>:</span> <span class=s2>&#34;2025-08-01T12:30:00Z&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;producer&#34;</span><span class=p>:</span> <span class=s2>&#34;order-module&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;consumers&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=nt>&#34;module&#34;</span><span class=p>:</span> <span class=s2>&#34;inventory-module&#34;</span><span class=p>,</span> <span class=nt>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;SUCCESS&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=nt>&#34;module&#34;</span><span class=p>:</span> <span class=s2>&#34;notification-module&#34;</span><span class=p>,</span> <span class=nt>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;FAIL&#34;</span><span class=p>,</span> <span class=nt>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;SMTP timeout&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;trace_id&#34;</span><span class=p>:</span> <span class=s2>&#34;trace-aaa-bbb-ccc&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=장애-추적-전략>장애 추적 전략<a hidden class=anchor aria-hidden=true href=#장애-추적-전략>#</a></h6><table><thead><tr><th>항목</th><th>전략</th></tr></thead><tbody><tr><td>이벤트 실패 추적</td><td>리스너 실패 시 로그에 에러 스택 기록 + 알림 연동 (예: Slack, PagerDuty)</td></tr><tr><td>트랜잭션 외 이벤트 로깅</td><td>이벤트가 트랜잭션 외부에서 실행되므로, DB commit 이후 성공 여부 별도 기록</td></tr><tr><td>재시도 전략</td><td>실패한 이벤트는 Retry Queue 또는 Dead Letter Queue 에 적재하여 후속 처리</td></tr><tr><td>트레이싱 연동</td><td>Trace ID 를 전달하여 로그, 메트릭, 트레이스를 연계 추적 (OpenTelemetry 기반 가능)</td></tr></tbody></table><h4 id=eventual-consistency-보장-전략-및-데이터-동기화-설계>Eventual Consistency 보장 전략 및 데이터 동기화 설계<a hidden class=anchor aria-hidden=true href=#eventual-consistency-보장-전략-및-데이터-동기화-설계>#</a></h4><p>모듈 간 독립성과 성능을 확보하기 위해, <strong>즉각적인 강한 일관성 대신 지연 일관성 (Eventual Consistency)</strong> 을 선택할 수 있다. 특히 모듈 간 이벤트 기반 통신을 활용할 때, 일관성 유지 전략이 필수이다.</p><h5 id=전제-조건>전제 조건<a hidden class=anchor aria-hidden=true href=#전제-조건>#</a></h5><ul><li>모듈 간 <strong>강한 트랜잭션 경계</strong>는 지양하고, <strong>이벤트 기반 동기화</strong>를 사용</li><li>각 모듈은 <strong>자기 완결적 상태 (self-contained state)</strong> 를 가짐</li></ul><h5 id=설계-구성>설계 구성<a hidden class=anchor aria-hidden=true href=#설계-구성>#</a></h5><table><thead><tr><th>구성 요소</th><th>설명</th></tr></thead><tbody><tr><td><strong>도메인 이벤트</strong></td><td>상태 변경 후 발행 (<code>OrderPlacedEvent</code>, <code>PaymentReceivedEvent</code>)</td></tr><tr><td><strong>이벤트 핸들러</strong></td><td>수신 모듈에서 비동기 처리하여 상태 반영</td></tr><tr><td><strong>보상 트랜잭션 (Compensating Transaction)</strong></td><td>이벤트 실패 시 원상 복구 처리 수행</td></tr><tr><td><strong>이벤트 저장소 (Outbox Pattern)</strong></td><td>DB 트랜잭션과 함께 이벤트 저장 후 별도 프로세스가 발행</td></tr></tbody></table><h5 id=outbox-pattern--polling-publisher-구조>Outbox Pattern + Polling Publisher 구조<a hidden class=anchor aria-hidden=true href=#outbox-pattern--polling-publisher-구조>#</a></h5><pre class=mermaid>sequenceDiagram
  participant DB
  participant Service
  participant Outbox
  participant EventPublisher

  Service-&gt;&gt;DB: Insert(Order)
  Service-&gt;&gt;Outbox: Insert(Event Row)
  Note right of Outbox: {&#34;status&#34;: &#34;PENDING&#34;}
  EventPublisher-&gt;&gt;Outbox: Poll + Mark &#34;SENT&#34;
  EventPublisher-&gt;&gt;Kafka: publish(OrderPlacedEvent)
</pre><hr><h5 id=eventual-consistency-전략>Eventual Consistency 전략<a hidden class=anchor aria-hidden=true href=#eventual-consistency-전략>#</a></h5><table><thead><tr><th>전략/패턴</th><th>설명</th></tr></thead><tbody><tr><td><strong>Outbox Pattern</strong></td><td>트랜잭션 내 이벤트를 함께 저장, 외부에서 비동기 발행</td></tr><tr><td><strong>Inbox Pattern</strong></td><td>중복 이벤트 방지를 위한 수신 측 처리 로그 저장</td></tr><tr><td><strong>Idempotency</strong></td><td>중복 이벤트에 대한 무해성 보장 (예: 키 기반 업데이트)</td></tr><tr><td><strong>Timeout + Retry</strong></td><td>실패 시 백오프 + 재시도 전략 적용</td></tr><tr><td><strong>Compensating Action</strong></td><td>실패한 경우 보상 작업 실행 (예: 결제 취소 등)</td></tr><tr><td><strong>Snapshot / Projection</strong></td><td>읽기 모델을 주기적으로 동기화 (CQRS 활용 시)</td></tr></tbody></table><h3 id=in-memory-eventbus--kafka-전환-전략>In-memory EventBus ↔ Kafka 전환 전략<a hidden class=anchor aria-hidden=true href=#in-memory-eventbus--kafka-전환-전략>#</a></h3><h4 id=in-memory-eventbus>In-memory EventBus<a hidden class=anchor aria-hidden=true href=#in-memory-eventbus>#</a></h4><p>애플리케이션 내부에서 이벤트를 <strong>동기 또는 비동기 방식으로 퍼블리시/구독</strong>하게 해주는 <strong>메모리 기반 이벤트 전달 시스템</strong>이다.</p><ul><li>네트워크나 브로커 없이, <strong>프로세스 내에서만</strong> 이벤트가 전달됨</li><li>Kafka, RabbitMQ 등의 외부 브로커 없이도 이벤트 아키텍처를 <strong>경량 구현</strong>할 수 있음</li></ul><h5 id=주요-목적-및-장점>주요 목적 및 장점<a hidden class=anchor aria-hidden=true href=#주요-목적-및-장점>#</a></h5><table><thead><tr><th>목적</th><th>설명</th></tr></thead><tbody><tr><td>느슨한 결합</td><td>발행자와 구독자가 서로 몰라도 통신 가능</td></tr><tr><td>비동기 처리</td><td>이벤트 기반 후속 처리를 메인 로직에서 분리</td></tr><tr><td>테스트 용이성</td><td>외부 시스템 없이 테스트 가능</td></tr><tr><td>성능 향상</td><td>메모리 기반으로 처리 속도 매우 빠름</td></tr><tr><td>구조 간소화</td><td>Kafka 등 브로커 없이도 이벤트 시스템 구현 가능</td></tr></tbody></table><h5 id=기본-구조>기본 구조<a hidden class=anchor aria-hidden=true href=#기본-구조>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-29-1><a class=lnlinks href=#hl-29-1> 1</a>
</span><span class=lnt id=hl-29-2><a class=lnlinks href=#hl-29-2> 2</a>
</span><span class=lnt id=hl-29-3><a class=lnlinks href=#hl-29-3> 3</a>
</span><span class=lnt id=hl-29-4><a class=lnlinks href=#hl-29-4> 4</a>
</span><span class=lnt id=hl-29-5><a class=lnlinks href=#hl-29-5> 5</a>
</span><span class=lnt id=hl-29-6><a class=lnlinks href=#hl-29-6> 6</a>
</span><span class=lnt id=hl-29-7><a class=lnlinks href=#hl-29-7> 7</a>
</span><span class=lnt id=hl-29-8><a class=lnlinks href=#hl-29-8> 8</a>
</span><span class=lnt id=hl-29-9><a class=lnlinks href=#hl-29-9> 9</a>
</span><span class=lnt id=hl-29-10><a class=lnlinks href=#hl-29-10>10</a>
</span><span class=lnt id=hl-29-11><a class=lnlinks href=#hl-29-11>11</a>
</span><span class=lnt id=hl-29-12><a class=lnlinks href=#hl-29-12>12</a>
</span><span class=lnt id=hl-29-13><a class=lnlinks href=#hl-29-13>13</a>
</span><span class=lnt id=hl-29-14><a class=lnlinks href=#hl-29-14>14</a>
</span><span class=lnt id=hl-29-15><a class=lnlinks href=#hl-29-15>15</a>
</span><span class=lnt id=hl-29-16><a class=lnlinks href=#hl-29-16>16</a>
</span><span class=lnt id=hl-29-17><a class=lnlinks href=#hl-29-17>17</a>
</span><span class=lnt id=hl-29-18><a class=lnlinks href=#hl-29-18>18</a>
</span><span class=lnt id=hl-29-19><a class=lnlinks href=#hl-29-19>19</a>
</span><span class=lnt id=hl-29-20><a class=lnlinks href=#hl-29-20>20</a>
</span><span class=lnt id=hl-29-21><a class=lnlinks href=#hl-29-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># EventBus 인터페이스</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>EventBus</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>subscribe</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_type</span><span class=p>,</span> <span class=n>handler</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>event_type</span><span class=p>,</span> <span class=p>[])</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>handler</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>publish</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>handler</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>event</span><span class=p>),</span> <span class=p>[]):</span>
</span></span><span class=line><span class=cl>            <span class=n>handler</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 예제 이벤트</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderCreatedEvent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>order_id</span> <span class=o>=</span> <span class=n>order_id</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 핸들러 등록 및 실행</span>
</span></span><span class=line><span class=cl><span class=n>bus</span> <span class=o>=</span> <span class=n>EventBus</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>bus</span><span class=o>.</span><span class=n>subscribe</span><span class=p>(</span><span class=n>OrderCreatedEvent</span><span class=p>,</span> <span class=k>lambda</span> <span class=n>e</span><span class=p>:</span> <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Send Email for Order </span><span class=si>{</span><span class=n>e</span><span class=o>.</span><span class=n>order_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>bus</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>OrderCreatedEvent</span><span class=p>(</span><span class=n>order_id</span><span class=o>=</span><span class=mi>123</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>**<code>publish()</code>**는 모든 핸들러를 동기 호출함</li><li>실무에선 <code>threading</code>, <code>asyncio</code>, <code>queue</code> 를 활용해 비동기 처리 가능</li></ul><h5 id=아키텍처>아키텍처<a hidden class=anchor aria-hidden=true href=#아키텍처>#</a></h5><pre class=mermaid>flowchart TD
  A[Order Module] --&gt;|emit OrderCreated| EB[In-memory EventBus]
  EB --&gt; B[Inventory Handler]
  EB --&gt; C[Notification Handler]
  EB --&gt; D[Audit Logger]
</pre><ul><li><code>Order Module</code> 은 EventBus 에 이벤트를 퍼블리시</li><li><code>Handler</code> 들은 사전 등록된 이벤트 타입만 처리</li></ul><h5 id=한계-및-주의점>한계 및 주의점<a hidden class=anchor aria-hidden=true href=#한계-및-주의점>#</a></h5><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>멀티 프로세스 환경</strong></td><td>다른 프로세스/서버로 이벤트 전달 불가</td></tr><tr><td><strong>신뢰성 부족</strong></td><td>메시지 손실 가능, 재시도/보장 없음</td></tr><tr><td><strong>확장성</strong></td><td>수평 확장 시 메시지 전달 어려움</td></tr><tr><td><strong>오류 처리</strong></td><td>실패 시 DLQ/재시도 로직 구현 필요</td></tr><tr><td><strong>정렬/중복 처리 없음</strong></td><td>멱등성/순서 보장 안 됨 (수동 구현 필요)</td></tr></tbody></table><h5 id=in-memory-vs-external-broker-kafka-등-비교>In-memory Vs External Broker (Kafka 등) 비교<a hidden class=anchor aria-hidden=true href=#in-memory-vs-external-broker-kafka-등-비교>#</a></h5><table><thead><tr><th>항목</th><th>In-memory EventBus</th><th>Kafka, RabbitMQ 등</th></tr></thead><tbody><tr><td><strong>성능</strong></td><td>매우 빠름 (μs)</td><td>비교적 느림 (ms 단위)</td></tr><tr><td><strong>운영 복잡도</strong></td><td>매우 낮음</td><td>설치, 구성, 운영 필요</td></tr><tr><td><strong>장애 허용성</strong></td><td>낮음 (메모리 기반)</td><td>높음 (내결함성 구성 가능)</td></tr><tr><td><strong>신뢰성</strong></td><td>낮음 (영속성 없음)</td><td>높음 (디스크 기반, 재처리 가능)</td></tr><tr><td><strong>적용 대상</strong></td><td>내부 처리, 단일 인스턴스</td><td>분산 시스템, 외부 통신 필요 시</td></tr></tbody></table><h4 id=전환-필요-배경>전환 필요 배경<a hidden class=anchor aria-hidden=true href=#전환-필요-배경>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>개발 초기</strong></td><td>Kafka 도입 없이 경량화된 In-memory EventBus 활용 (예: Python Signal, Spring Event, Node EventEmitter)</td></tr><tr><td><strong>운영 확장 시점</strong></td><td>다중 인스턴스 환경, 서비스 간 통신 필요 발생 → Kafka 같은 분산 이벤트 브로커 필요</td></tr><tr><td><strong>점진적 전환 필요</strong></td><td>전면 교체 대신 <code>추상 인터페이스 기반 이중 지원</code> 필요</td></tr></tbody></table><h4 id=구조적-전환-설계>구조적 전환 설계<a hidden class=anchor aria-hidden=true href=#구조적-전환-설계>#</a></h4><pre class=mermaid>flowchart TD
    A[도메인 서비스] --&gt;|이벤트 발행| B[&#34;EventPublisher (Interface)&#34;]
    B --&gt;|InMemory| C[InMemoryEventBus]
    B --&gt;|Kafka| D[KafkaEventBus]
    D --&gt;|Topic 발행| E[Kafka Broker]
    E --&gt;|Consume| F[모듈별 Kafka Consumer]
    C --&gt;|Direct Call| G[모듈별 리스너 함수]
</pre><h4 id=설계-패턴-적용>설계 패턴 적용<a hidden class=anchor aria-hidden=true href=#설계-패턴-적용>#</a></h4><table><thead><tr><th>구성 요소</th><th>전략 및 구현 방식</th></tr></thead><tbody><tr><td><code>EventPublisher</code> (인터페이스)</td><td><code>publish(event: DomainEvent)</code> 정의. 구현체 교체 가능성 확보</td></tr><tr><td><code>InMemoryEventBus</code></td><td>애플리케이션 내 메서드 직접 호출 기반</td></tr><tr><td><code>KafkaEventBus</code></td><td>Kafka Topic 으로 메시지 전송</td></tr><tr><td><code>Configurable Bus</code></td><td>설정 값 기반으로 런타임 시점 Bus 선택 가능하도록 DI 적용</td></tr><tr><td><code>Failover Hook</code></td><td>Kafka 실패 시 fallback to InMemory (옵션)</td></tr></tbody></table><h4 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-32-1><a class=lnlinks href=#hl-32-1> 1</a>
</span><span class=lnt id=hl-32-2><a class=lnlinks href=#hl-32-2> 2</a>
</span><span class=lnt id=hl-32-3><a class=lnlinks href=#hl-32-3> 3</a>
</span><span class=lnt id=hl-32-4><a class=lnlinks href=#hl-32-4> 4</a>
</span><span class=lnt id=hl-32-5><a class=lnlinks href=#hl-32-5> 5</a>
</span><span class=lnt id=hl-32-6><a class=lnlinks href=#hl-32-6> 6</a>
</span><span class=lnt id=hl-32-7><a class=lnlinks href=#hl-32-7> 7</a>
</span><span class=lnt id=hl-32-8><a class=lnlinks href=#hl-32-8> 8</a>
</span><span class=lnt id=hl-32-9><a class=lnlinks href=#hl-32-9> 9</a>
</span><span class=lnt id=hl-32-10><a class=lnlinks href=#hl-32-10>10</a>
</span><span class=lnt id=hl-32-11><a class=lnlinks href=#hl-32-11>11</a>
</span><span class=lnt id=hl-32-12><a class=lnlinks href=#hl-32-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># domain_event.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DomainEvent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UserCreatedEvent</span><span class=p>(</span><span class=n>DomainEvent</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_id</span> <span class=o>=</span> <span class=n>user_id</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># event_publisher.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>EventPublisher</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>publish</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>:</span> <span class=n>DomainEvent</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>NotImplementedError</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-33-1><a class=lnlinks href=#hl-33-1> 1</a>
</span><span class=lnt id=hl-33-2><a class=lnlinks href=#hl-33-2> 2</a>
</span><span class=lnt id=hl-33-3><a class=lnlinks href=#hl-33-3> 3</a>
</span><span class=lnt id=hl-33-4><a class=lnlinks href=#hl-33-4> 4</a>
</span><span class=lnt id=hl-33-5><a class=lnlinks href=#hl-33-5> 5</a>
</span><span class=lnt id=hl-33-6><a class=lnlinks href=#hl-33-6> 6</a>
</span><span class=lnt id=hl-33-7><a class=lnlinks href=#hl-33-7> 7</a>
</span><span class=lnt id=hl-33-8><a class=lnlinks href=#hl-33-8> 8</a>
</span><span class=lnt id=hl-33-9><a class=lnlinks href=#hl-33-9> 9</a>
</span><span class=lnt id=hl-33-10><a class=lnlinks href=#hl-33-10>10</a>
</span><span class=lnt id=hl-33-11><a class=lnlinks href=#hl-33-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># in_memory_bus.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>InMemoryEventBus</span><span class=p>(</span><span class=n>EventPublisher</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>subscribe</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_type</span><span class=p>,</span> <span class=n>handler</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>event_type</span><span class=p>,</span> <span class=p>[])</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>handler</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>publish</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>:</span> <span class=n>DomainEvent</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>handler</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>event</span><span class=p>),</span> <span class=p>[]):</span>
</span></span><span class=line><span class=cl>            <span class=n>handler</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-34-1><a class=lnlinks href=#hl-34-1> 1</a>
</span><span class=lnt id=hl-34-2><a class=lnlinks href=#hl-34-2> 2</a>
</span><span class=lnt id=hl-34-3><a class=lnlinks href=#hl-34-3> 3</a>
</span><span class=lnt id=hl-34-4><a class=lnlinks href=#hl-34-4> 4</a>
</span><span class=lnt id=hl-34-5><a class=lnlinks href=#hl-34-5> 5</a>
</span><span class=lnt id=hl-34-6><a class=lnlinks href=#hl-34-6> 6</a>
</span><span class=lnt id=hl-34-7><a class=lnlinks href=#hl-34-7> 7</a>
</span><span class=lnt id=hl-34-8><a class=lnlinks href=#hl-34-8> 8</a>
</span><span class=lnt id=hl-34-9><a class=lnlinks href=#hl-34-9> 9</a>
</span><span class=lnt id=hl-34-10><a class=lnlinks href=#hl-34-10>10</a>
</span><span class=lnt id=hl-34-11><a class=lnlinks href=#hl-34-11>11</a>
</span><span class=lnt id=hl-34-12><a class=lnlinks href=#hl-34-12>12</a>
</span><span class=lnt id=hl-34-13><a class=lnlinks href=#hl-34-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># kafka_bus.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaProducer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>KafkaEventBus</span><span class=p>(</span><span class=n>EventPublisher</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>value_serializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>v</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>v</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>publish</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>:</span> <span class=n>DomainEvent</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>event</span><span class=p>)</span><span class=o>.</span><span class=vm>__name__</span><span class=p>,</span> <span class=nb>vars</span><span class=p>(</span><span class=n>event</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=domain-event-vs-integration-event-설계-구분>Domain Event Vs Integration Event 설계 구분<a hidden class=anchor aria-hidden=true href=#domain-event-vs-integration-event-설계-구분>#</a></h3><table><thead><tr><th>항목</th><th><strong>Domain Event</strong></th><th><strong>Integration Event</strong></th></tr></thead><tbody><tr><td><strong>정의</strong></td><td>하나의 도메인 내부에서 발생한 의미 있는 상태 변화</td><td>시스템 간 통합을 위해 발행되는 이벤트 (MSA/모듈 간 통신용)</td></tr><tr><td><strong>관심사</strong></td><td>도메인 규칙과 상태 전이</td><td>서비스 간 데이터 전달 및 이벤트 동기화</td></tr><tr><td><strong>스코프</strong></td><td>내부 모듈/서비스 한정</td><td>외부 시스템과의 경계 포함</td></tr><tr><td><strong>의도</strong></td><td>비즈니스 불변 조건 (Event Storming 기반) 표현</td><td>통합 목적의 메시지 전달 및 확장성 확보</td></tr></tbody></table><h4 id=차이점>차이점<a hidden class=anchor aria-hidden=true href=#차이점>#</a></h4><table><thead><tr><th>구분</th><th><strong>Domain Event</strong></th><th><strong>Integration Event</strong></th></tr></thead><tbody><tr><td><strong>발행 주체</strong></td><td>내부 도메인 서비스 (ex. 주문, 사용자 등)</td><td>외부 시스템 통합 또는 다른 바운디드 컨텍스트 대상</td></tr><tr><td><strong>의도</strong></td><td>비즈니스 상태 변화 반영 (<code>OrderPlaced</code>, <code>UserSignedUp</code>)</td><td>다른 시스템과 상태 동기화 또는 알림 (<code>InventoryReserved</code>)</td></tr><tr><td><strong>보존 여부</strong></td><td>일반적으로 일회성 처리 (Replay 목적 아님)</td><td>메시지 브로커에서 보존 (Kafka 에 저장, 재처리 가능)</td></tr><tr><td><strong>전파 범위</strong></td><td>모놀리식 내부 모듈 또는 같은 바운디드 컨텍스트</td><td>마이크로서비스, 외부 시스템 (Pub/Sub)</td></tr><tr><td><strong>형식</strong></td><td>코드 클래스 기반 이벤트 객체</td><td>JSON, Avro 등 스키마 정의된 메시지</td></tr><tr><td><strong>예시</strong></td><td><code>UserCreated</code>, <code>OrderCanceled</code></td><td><code>SendWelcomeEmail</code>, <code>NotifyWarehouse</code></td></tr></tbody></table><h4 id=발생-및-흐름>발생 및 흐름<a hidden class=anchor aria-hidden=true href=#발생-및-흐름>#</a></h4><pre class=mermaid>flowchart LR
  A[도메인 서비스] --&gt; B[Domain Event 발생]
  B --&gt; C[도메인 이벤트 핸들러 처리]
  C --&gt; D[&#34;Outbox 기록 (Optional)&#34;]
  D --&gt; E[Integration Event 발행]
  E --&gt; F[외부 서비스 수신]
</pre><ul><li><code>OrderCreated</code> (Domain Event) 는 <code>InventoryHandler</code> 등 도메인 로직을 호출</li><li>그 이후 <code>OrderCreatedIntegrationEvent</code> 가 외부 Kafka 로 퍼블리시</li></ul><h4 id=설계-가이드>설계 가이드<a hidden class=anchor aria-hidden=true href=#설계-가이드>#</a></h4><table><thead><tr><th>항목</th><th>권장 전략</th></tr></thead><tbody><tr><td>DomainEvent ↔ IntegrationEvent 매핑</td><td><code>OrderPlaced</code> → <code>OrderCreatedIntegrationEvent</code></td></tr><tr><td>IntegrationEvent 버전 관리</td><td>Kafka 메시지에 <code>version</code> 필드 포함, 스키마 관리 도구 사용 (e.g. Confluent Schema Registry)</td></tr><tr><td>테스트 전략</td><td>단위 테스트는 DomainEvent, 통합 테스트는 IntegrationEvent 기준 분리</td></tr><tr><td>이벤트 메시지 디자인</td><td>명확한 context 명시 (ex. <code>user-service.user.created</code>)</td></tr></tbody></table><h4 id=실제-예시-python>실제 예시 (Python)<a hidden class=anchor aria-hidden=true href=#실제-예시-python>#</a></h4><p><strong>도메인 이벤트 정의</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-36-1><a class=lnlinks href=#hl-36-1>1</a>
</span><span class=lnt id=hl-36-2><a class=lnlinks href=#hl-36-2>2</a>
</span><span class=lnt id=hl-36-3><a class=lnlinks href=#hl-36-3>3</a>
</span><span class=lnt id=hl-36-4><a class=lnlinks href=#hl-36-4>4</a>
</span><span class=lnt id=hl-36-5><a class=lnlinks href=#hl-36-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 도메인 레이어</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderCreatedEvent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>order_id</span> <span class=o>=</span> <span class=n>order_id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_id</span> <span class=o>=</span> <span class=n>user_id</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Integration Event 정의 (Kafka 등 외부 전파)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-37-1><a class=lnlinks href=#hl-37-1>1</a>
</span><span class=lnt id=hl-37-2><a class=lnlinks href=#hl-37-2>2</a>
</span><span class=lnt id=hl-37-3><a class=lnlinks href=#hl-37-3>3</a>
</span><span class=lnt id=hl-37-4><a class=lnlinks href=#hl-37-4>4</a>
</span><span class=lnt id=hl-37-5><a class=lnlinks href=#hl-37-5>5</a>
</span><span class=lnt id=hl-37-6><a class=lnlinks href=#hl-37-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 인티그레이션 계층</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderCreatedIntegrationEvent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>,</span> <span class=n>user_id</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>order_id</span> <span class=o>=</span> <span class=n>order_id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_id</span> <span class=o>=</span> <span class=n>user_id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>timestamp</span> <span class=o>=</span> <span class=n>timestamp</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>변환 예시</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-38-1><a class=lnlinks href=#hl-38-1>1</a>
</span><span class=lnt id=hl-38-2><a class=lnlinks href=#hl-38-2>2</a>
</span><span class=lnt id=hl-38-3><a class=lnlinks href=#hl-38-3>3</a>
</span><span class=lnt id=hl-38-4><a class=lnlinks href=#hl-38-4>4</a>
</span><span class=lnt id=hl-38-5><a class=lnlinks href=#hl-38-5>5</a>
</span><span class=lnt id=hl-38-6><a class=lnlinks href=#hl-38-6>6</a>
</span><span class=lnt id=hl-38-7><a class=lnlinks href=#hl-38-7>7</a>
</span><span class=lnt id=hl-38-8><a class=lnlinks href=#hl-38-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Application 계층</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>handle_domain_event</span><span class=p>(</span><span class=n>domain_event</span><span class=p>:</span> <span class=n>OrderCreatedEvent</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>integration_event</span> <span class=o>=</span> <span class=n>OrderCreatedIntegrationEvent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>domain_event</span><span class=o>.</span><span class=n>order_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>domain_event</span><span class=o>.</span><span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>timestamp</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>kafka_producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s2>&#34;order.created&#34;</span><span class=p>,</span> <span class=n>integration_event</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=kafka-기반-domain-event--integration-event-변환-구조>Kafka 기반 Domain Event → Integration Event 변환 구조<a hidden class=anchor aria-hidden=true href=#kafka-기반-domain-event--integration-event-변환-구조>#</a></h4><h5 id=구조-개요>구조 개요<a hidden class=anchor aria-hidden=true href=#구조-개요>#</a></h5><pre class=mermaid>flowchart TD
    A[도메인 서비스] --&gt; B[&#34;Domain Event 생성 (예: OrderPlaced)&#34;]
    B --&gt; C[Domain Event Dispatcher]
    C --&gt; D[Integration Event Mapper]
    D --&gt; E[Kafka Integration Event Publisher]
    E --&gt; F[Kafka Broker]
    F --&gt; G[외부 시스템 또는 마이크로서비스]
</pre><h5 id=흐름-설명>흐름 설명<a hidden class=anchor aria-hidden=true href=#흐름-설명>#</a></h5><table><thead><tr><th>단계</th><th>구성 요소</th><th>설명</th></tr></thead><tbody><tr><td>1</td><td>Domain Event</td><td>비즈니스 트랜잭션 내에서 발생 (<code>OrderPlaced</code>, <code>PaymentFailed</code>)</td></tr><tr><td>2</td><td>Domain Event Dispatcher</td><td>등록된 핸들러에게 이벤트를 브로드캐스트</td></tr><tr><td>3</td><td>Mapper</td><td>Domain → Integration 변환 (예: <code>OrderPlaced → OrderCreatedIntegrationEvent</code>)</td></tr><tr><td>4</td><td>Kafka Publisher</td><td>Kafka 토픽으로 직렬화된 메시지 발행</td></tr><tr><td>5</td><td>Consumer (MSA)</td><td>외부 시스템/모듈에서 메시지를 구독 및 처리</td></tr></tbody></table><h5 id=예시>예시<a hidden class=anchor aria-hidden=true href=#예시>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-40-1><a class=lnlinks href=#hl-40-1> 1</a>
</span><span class=lnt id=hl-40-2><a class=lnlinks href=#hl-40-2> 2</a>
</span><span class=lnt id=hl-40-3><a class=lnlinks href=#hl-40-3> 3</a>
</span><span class=lnt id=hl-40-4><a class=lnlinks href=#hl-40-4> 4</a>
</span><span class=lnt id=hl-40-5><a class=lnlinks href=#hl-40-5> 5</a>
</span><span class=lnt id=hl-40-6><a class=lnlinks href=#hl-40-6> 6</a>
</span><span class=lnt id=hl-40-7><a class=lnlinks href=#hl-40-7> 7</a>
</span><span class=lnt id=hl-40-8><a class=lnlinks href=#hl-40-8> 8</a>
</span><span class=lnt id=hl-40-9><a class=lnlinks href=#hl-40-9> 9</a>
</span><span class=lnt id=hl-40-10><a class=lnlinks href=#hl-40-10>10</a>
</span><span class=lnt id=hl-40-11><a class=lnlinks href=#hl-40-11>11</a>
</span><span class=lnt id=hl-40-12><a class=lnlinks href=#hl-40-12>12</a>
</span><span class=lnt id=hl-40-13><a class=lnlinks href=#hl-40-13>13</a>
</span><span class=lnt id=hl-40-14><a class=lnlinks href=#hl-40-14>14</a>
</span><span class=lnt id=hl-40-15><a class=lnlinks href=#hl-40-15>15</a>
</span><span class=lnt id=hl-40-16><a class=lnlinks href=#hl-40-16>16</a>
</span><span class=lnt id=hl-40-17><a class=lnlinks href=#hl-40-17>17</a>
</span><span class=lnt id=hl-40-18><a class=lnlinks href=#hl-40-18>18</a>
</span><span class=lnt id=hl-40-19><a class=lnlinks href=#hl-40-19>19</a>
</span><span class=lnt id=hl-40-20><a class=lnlinks href=#hl-40-20>20</a>
</span><span class=lnt id=hl-40-21><a class=lnlinks href=#hl-40-21>21</a>
</span><span class=lnt id=hl-40-22><a class=lnlinks href=#hl-40-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Domain Event</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderPlaced</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>order_id</span> <span class=o>=</span> <span class=n>order_id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_id</span> <span class=o>=</span> <span class=n>user_id</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Integration Event</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderCreatedIntegrationEvent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>type</span> <span class=o>=</span> <span class=s2>&#34;OrderCreated&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>version</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>order_id</span> <span class=o>=</span> <span class=n>order_id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_id</span> <span class=o>=</span> <span class=n>user_id</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mapper</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>map_domain_to_integration</span><span class=p>(</span><span class=n>event</span><span class=p>:</span> <span class=n>OrderPlaced</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>OrderCreatedIntegrationEvent</span><span class=p>(</span><span class=n>event</span><span class=o>.</span><span class=n>order_id</span><span class=p>,</span> <span class=n>event</span><span class=o>.</span><span class=n>user_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Publisher</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>publish</span><span class=p>(</span><span class=n>event</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>integration_event</span> <span class=o>=</span> <span class=n>map_domain_to_integration</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>kafka_producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s2>&#34;order.created&#34;</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=nb>vars</span><span class=p>(</span><span class=n>integration_event</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=domain-event-dispatcher-설계-패턴>Domain Event Dispatcher 설계 패턴<a hidden class=anchor aria-hidden=true href=#domain-event-dispatcher-설계-패턴>#</a></h3><p><code>DomainEventDispatcher</code> 는 하나의 이벤트가 여러 핸들러로 전달될 수 있도록 <strong>이벤트 등록 및 전달 책임</strong>을 가진 중앙 집중형 이벤트 디스패처이다.</p><h4 id=구조>구조<a hidden class=anchor aria-hidden=true href=#구조>#</a></h4><pre class=mermaid>flowchart TD
    A[도메인 서비스] --&gt; B[DomainEventDispatcher]
    B --&gt; C1[EmailEventHandler]
    B --&gt; C2[LoggingEventHandler]
    B --&gt; C3[KafkaIntegrationPublisher]
</pre><h4 id=dispatcher-설계-python>Dispatcher 설계 (Python)<a hidden class=anchor aria-hidden=true href=#dispatcher-설계-python>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-42-1><a class=lnlinks href=#hl-42-1> 1</a>
</span><span class=lnt id=hl-42-2><a class=lnlinks href=#hl-42-2> 2</a>
</span><span class=lnt id=hl-42-3><a class=lnlinks href=#hl-42-3> 3</a>
</span><span class=lnt id=hl-42-4><a class=lnlinks href=#hl-42-4> 4</a>
</span><span class=lnt id=hl-42-5><a class=lnlinks href=#hl-42-5> 5</a>
</span><span class=lnt id=hl-42-6><a class=lnlinks href=#hl-42-6> 6</a>
</span><span class=lnt id=hl-42-7><a class=lnlinks href=#hl-42-7> 7</a>
</span><span class=lnt id=hl-42-8><a class=lnlinks href=#hl-42-8> 8</a>
</span><span class=lnt id=hl-42-9><a class=lnlinks href=#hl-42-9> 9</a>
</span><span class=lnt id=hl-42-10><a class=lnlinks href=#hl-42-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>DomainEventDispatcher</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_handlers</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>register</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_type</span><span class=p>,</span> <span class=n>handler</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_handlers</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>event_type</span><span class=p>,</span> <span class=p>[])</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>handler</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>dispatch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>handler</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_handlers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>event</span><span class=p>),</span> <span class=p>[]):</span>
</span></span><span class=line><span class=cl>            <span class=n>handler</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-43-1><a class=lnlinks href=#hl-43-1>1</a>
</span><span class=lnt id=hl-43-2><a class=lnlinks href=#hl-43-2>2</a>
</span><span class=lnt id=hl-43-3><a class=lnlinks href=#hl-43-3>3</a>
</span><span class=lnt id=hl-43-4><a class=lnlinks href=#hl-43-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 예시 사용</span>
</span></span><span class=line><span class=cl><span class=n>dispatcher</span> <span class=o>=</span> <span class=n>DomainEventDispatcher</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>dispatcher</span><span class=o>.</span><span class=n>register</span><span class=p>(</span><span class=n>OrderPlaced</span><span class=p>,</span> <span class=n>send_email</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dispatcher</span><span class=o>.</span><span class=n>register</span><span class=p>(</span><span class=n>OrderPlaced</span><span class=p>,</span> <span class=n>publish_to_kafka</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=장점-1>장점<a hidden class=anchor aria-hidden=true href=#장점-1>#</a></h4><ul><li>SRP 원칙에 따라 핸들러 로직 분리</li><li>테스트 용이성 증가</li><li>마이크로서비스 전환 시 핸들러 분산 가능</li></ul><h3 id=outbox-패턴-상세-구현-및-트랜잭션-연결>Outbox 패턴 상세 구현 및 트랜잭션 연결<a hidden class=anchor aria-hidden=true href=#outbox-패턴-상세-구현-및-트랜잭션-연결>#</a></h3><p>데이터베이스 트랜잭션과 함께 <strong>이벤트를 Outbox 테이블에 저장</strong>하고, 이후 별도 프로세스 (이벤트 릴레이어) 가 이벤트를 메시징 시스템 (Kafka 등) 으로 전송하는 패턴이다.</p><ul><li><strong>데이터베이스 상태와 이벤트 발행의 일관성 보장</strong> (Exactly-once 보장 또는 At-least-once 기반 처리) 을 목적으로 한다.</li></ul><pre class=mermaid>sequenceDiagram
  participant Domain
  participant DB
  participant Outbox
  participant Processor
  participant Kafka

  Domain-&gt;&gt;DB: save(order)
  Domain-&gt;&gt;Outbox: save(OrderCreatedEvent)
  Processor-&gt;&gt;Outbox: poll &amp; mark as SENT
  Processor-&gt;&gt;Kafka: publish event
</pre><h4 id=outbox-패턴의-장단점>Outbox 패턴의 장단점<a hidden class=anchor aria-hidden=true href=#outbox-패턴의-장단점>#</a></h4><table><thead><tr><th>구분</th><th>장점</th><th>단점</th></tr></thead><tbody><tr><td>✅ 장점</td><td>- 트랜잭션 내 메시지 저장으로 <strong>데이터와 이벤트 일관성 확보</strong><br>- 메시지 손실 방지, 장애 복구 가능<br>- 외부 시스템과의 <strong>느슨한 결합</strong></td><td>- Outbox Processor 구현 필요<br>- 중복 발행 방지 위한 <strong>멱등성 처리 복잡성</strong><br>- 지연 전파 (latency) 발생 가능</td></tr><tr><td>❌ 단점</td><td>- <strong>DB 에 쓰기 부하 증가</strong><br>Processor 의 장애/지연 시 발행 지연</td><td>- DB 와 메시징 브로커 상태 추적/관리가 필요함</td></tr></tbody></table><h4 id=outbox-테이블-스키마-예시>Outbox 테이블 스키마 예시<a hidden class=anchor aria-hidden=true href=#outbox-테이블-스키마-예시>#</a></h4><table><thead><tr><th>컬럼</th><th>설명</th></tr></thead><tbody><tr><td><code>id</code></td><td>UUID or ULID</td></tr><tr><td><code>event_type</code></td><td>이벤트 이름 (<code>OrderCreated</code>)</td></tr><tr><td><code>aggregate_id</code></td><td>관련 엔터티 ID</td></tr><tr><td><code>payload</code></td><td>JSON 직렬화된 이벤트 내용</td></tr><tr><td><code>status</code></td><td><code>PENDING</code>, <code>SENT</code>, <code>FAILED</code></td></tr><tr><td><code>created_at</code></td><td>타임스탬프</td></tr></tbody></table><h4 id=기반-구현-예시>기반 구현 예시<a hidden class=anchor aria-hidden=true href=#기반-구현-예시>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-45-1><a class=lnlinks href=#hl-45-1> 1</a>
</span><span class=lnt id=hl-45-2><a class=lnlinks href=#hl-45-2> 2</a>
</span><span class=lnt id=hl-45-3><a class=lnlinks href=#hl-45-3> 3</a>
</span><span class=lnt id=hl-45-4><a class=lnlinks href=#hl-45-4> 4</a>
</span><span class=lnt id=hl-45-5><a class=lnlinks href=#hl-45-5> 5</a>
</span><span class=lnt id=hl-45-6><a class=lnlinks href=#hl-45-6> 6</a>
</span><span class=lnt id=hl-45-7><a class=lnlinks href=#hl-45-7> 7</a>
</span><span class=lnt id=hl-45-8><a class=lnlinks href=#hl-45-8> 8</a>
</span><span class=lnt id=hl-45-9><a class=lnlinks href=#hl-45-9> 9</a>
</span><span class=lnt id=hl-45-10><a class=lnlinks href=#hl-45-10>10</a>
</span><span class=lnt id=hl-45-11><a class=lnlinks href=#hl-45-11>11</a>
</span><span class=lnt id=hl-45-12><a class=lnlinks href=#hl-45-12>12</a>
</span><span class=lnt id=hl-45-13><a class=lnlinks href=#hl-45-13>13</a>
</span><span class=lnt id=hl-45-14><a class=lnlinks href=#hl-45-14>14</a>
</span><span class=lnt id=hl-45-15><a class=lnlinks href=#hl-45-15>15</a>
</span><span class=lnt id=hl-45-16><a class=lnlinks href=#hl-45-16>16</a>
</span><span class=lnt id=hl-45-17><a class=lnlinks href=#hl-45-17>17</a>
</span><span class=lnt id=hl-45-18><a class=lnlinks href=#hl-45-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>OutboxEvent</span><span class=p>(</span><span class=n>Base</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>__tablename__</span> <span class=o>=</span> <span class=s2>&#34;outbox&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>UUID</span><span class=p>,</span> <span class=n>primary_key</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>event_type</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>String</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>JSON</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>status</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>String</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=s2>&#34;PENDING&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>created_at</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>DateTime</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>save_order</span><span class=p>(</span><span class=n>order_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=s2>&#34;orders&#34;</span><span class=p>,</span> <span class=n>order_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>event</span> <span class=o>=</span> <span class=n>OutboxEvent</span><span class=p>(</span><span class=n>event_type</span><span class=o>=</span><span class=s2>&#34;OrderCreated&#34;</span><span class=p>,</span> <span class=n>payload</span><span class=o>=</span><span class=n>order_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=s2>&#34;outbox&#34;</span><span class=p>,</span> <span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>publish_outbox</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>events</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s2>&#34;outbox&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>filter_by</span><span class=p>(</span><span class=n>status</span><span class=o>=</span><span class=s2>&#34;PENDING&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>event</span> <span class=ow>in</span> <span class=n>events</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>kafka</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>event</span><span class=o>.</span><span class=n>event_type</span><span class=p>,</span> <span class=n>event</span><span class=o>.</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>db</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=s2>&#34;outbox&#34;</span><span class=p>,</span> <span class=n>event</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=p>{</span><span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;SENT&#34;</span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=고려-사항>고려 사항<a hidden class=anchor aria-hidden=true href=#고려-사항>#</a></h4><ul><li>트랜잭션 내 이벤트 저장은 DB 일관성 보장</li><li>발행 실패 시 상태 보존 및 Retry 필요</li><li>외부 메시지 브로커 장애 시 이벤트 유실 방지 (DLQ + Retry Queue 구성)</li></ul><h3 id=event-store-기반-replay-가능한-hybrid-eventbus-설계>Event Store 기반 Replay 가능한 Hybrid EventBus 설계<a hidden class=anchor aria-hidden=true href=#event-store-기반-replay-가능한-hybrid-eventbus-설계>#</a></h3><p><strong>Hybrid EventBus</strong> 는 <strong>In-memory EventBus</strong> 와 <strong>외부 메시지 브로커 (Kafka, RabbitMQ, NATS 등)</strong> 를 결합하여 이벤트를 <strong>내부 모듈 간 빠르게 처리하면서</strong>, 동시에 <strong>시스템 외부로도 이벤트를 전파</strong>할 수 있도록 설계한 이벤트 처리 아키텍처 패턴이다.</p><h4 id=목적>목적<a hidden class=anchor aria-hidden=true href=#목적>#</a></h4><ol><li>이벤트 소실 방지</li><li>장애 복구 및 재처리</li><li>이벤트 소싱 기반 설계 확장성</li></ol><h4 id=구조-1>구조<a hidden class=anchor aria-hidden=true href=#구조-1>#</a></h4><pre class=mermaid>flowchart TD
    A[도메인 서비스] --&gt; B[Domain Event Dispatcher]
    B --&gt; C[Hybrid EventBus]
    C --&gt; D1[Kafka Producer]
    C --&gt; D2[&#34;Event Store (DB)&#34;]
    D2 --&gt;|Query| E[Replay Engine]
    E --&gt; C[재발행]
</pre><h4 id=구성-요소-설명>구성 요소 설명<a hidden class=anchor aria-hidden=true href=#구성-요소-설명>#</a></h4><table><thead><tr><th>구성 요소</th><th>역할</th></tr></thead><tbody><tr><td>Hybrid EventBus</td><td>Kafka 발행 + Event Store 저장 병행 수행</td></tr><tr><td>Event Store</td><td>DB 또는 파일 기반 이벤트 저장소 (ex. PostgreSQL, EventStoreDB)</td></tr><tr><td>Replay Engine</td><td>특정 시간 이후 이벤트를 다시 발행할 수 있도록 처리</td></tr><tr><td>Dispatcher + Bus</td><td>Dispatcher 는 핸들러 관리, Bus 는 발행 방식 관리</td></tr></tbody></table><h4 id=구현-전략>구현 전략<a hidden class=anchor aria-hidden=true href=#구현-전략>#</a></h4><ul><li><code>HybridEventBus.publish(event)</code>:<ul><li>Kafka 에 발행</li><li>JSON 직렬화 후 Event Store 에 저장</li></ul></li><li><code>ReplayEngine.replay(from_timestamp)</code>:<ul><li>저장소에서 이벤트 불러와 다시 발행</li></ul></li><li>이벤트 IDempotency 보장을 위해 처리 상태를 저장 (<code>processed_event_ids</code>)</li></ul><h4 id=예시-저장-구조>예시 저장 구조<a hidden class=anchor aria-hidden=true href=#예시-저장-구조>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-47-1><a class=lnlinks href=#hl-47-1>1</a>
</span><span class=lnt id=hl-47-2><a class=lnlinks href=#hl-47-2>2</a>
</span><span class=lnt id=hl-47-3><a class=lnlinks href=#hl-47-3>3</a>
</span><span class=lnt id=hl-47-4><a class=lnlinks href=#hl-47-4>4</a>
</span><span class=lnt id=hl-47-5><a class=lnlinks href=#hl-47-5>5</a>
</span><span class=lnt id=hl-47-6><a class=lnlinks href=#hl-47-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>event_store</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>event_type</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>payload</span><span class=w> </span><span class=n>JSONB</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>occurred_at</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=replay-코드>Replay 코드<a hidden class=anchor aria-hidden=true href=#replay-코드>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-48-1><a class=lnlinks href=#hl-48-1>1</a>
</span><span class=lnt id=hl-48-2><a class=lnlinks href=#hl-48-2>2</a>
</span><span class=lnt id=hl-48-3><a class=lnlinks href=#hl-48-3>3</a>
</span><span class=lnt id=hl-48-4><a class=lnlinks href=#hl-48-4>4</a>
</span><span class=lnt id=hl-48-5><a class=lnlinks href=#hl-48-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>replay_events</span><span class=p>(</span><span class=n>from_time</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>rows</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s2>&#34;SELECT * FROM event_store WHERE occurred_at &gt;= </span><span class=si>%s</span><span class=s2>&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>from_time</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>rows</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>event</span> <span class=o>=</span> <span class=n>deserialize</span><span class=p>(</span><span class=n>row</span><span class=p>[</span><span class=s1>&#39;payload&#39;</span><span class=p>],</span> <span class=n>row</span><span class=p>[</span><span class=s1>&#39;event_type&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>hybrid_event_bus</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=outbox-pattern-vs-hybrid-eventbus-구조-비교>Outbox Pattern vs. Hybrid EventBus 구조 비교<a hidden class=anchor aria-hidden=true href=#outbox-pattern-vs-hybrid-eventbus-구조-비교>#</a></h3><table><thead><tr><th>구분</th><th><strong>Outbox Pattern</strong></th><th><strong>Hybrid EventBus 구조</strong></th></tr></thead><tbody><tr><td><strong>이벤트 처리 방식</strong></td><td>트랜잭션 DB 내 <code>outbox 테이블</code> 에 이벤트 기록 → 별도 프로세스가 이를 Kafka 등으로 전송</td><td>이벤트 발생 시 Kafka 로 직접 발행 + 이벤트 저장소 (DB) 에 동시에 저장</td></tr><tr><td><strong>일관성 보장 수준</strong></td><td><strong>Strong Consistency (Transactional Outbox)</strong><br>→ DB 트랜잭션과 메시지 쓰기 동시 처리</td><td><strong>Eventual Consistency</strong><br>→ Kafka 발행과 저장이 별도 실행</td></tr><tr><td><strong>실행 시점</strong></td><td>DB commit 이후 Outbox Poller 에 의해 비동기 전송</td><td>이벤트 발생 시 즉시 Kafka 전송 및 이벤트 저장 병행</td></tr><tr><td><strong>Replay 기능</strong></td><td>기본적으로 없음<br>(Outbox 테이블에는 replay 기능 없음)</td><td>별도 Event Store 에 저장된 이벤트를 기반으로 재전송 가능</td></tr><tr><td><strong>운영 구성 요소</strong></td><td>DB, Outbox 테이블, Poller (Kafka Producer 역할)</td><td>Event Dispatcher, Event Store, Hybrid Bus, Replay Engine</td></tr><tr><td><strong>주요 장점</strong></td><td>✅ 트랜잭션 경계 내 안전한 메시지 발행<br>✅ 메시지 손실 없음<br>✅ 메시지 순서 보장</td><td>✅ Kafka 장애 시에도 저장소에 안전 저장<br>✅ Replay / Audit 가능<br>✅ 마이크로서비스 전환 대비 유연성</td></tr><tr><td><strong>주요 단점</strong></td><td>❌ Polling 지연 (전송 지연)<br>❌ Outbox 처리 실패 관리 필요<br>❌ 단일 DB 락 이슈</td><td>❌ 일관성 보장 어려움 (Kafka 발행 실패 시 복구 어려움)<br>❌ 중복 방지 및 Idempotency 보장 로직 필요</td></tr><tr><td><strong>Kafka 의존성</strong></td><td>Poller 가 Kafka Producer 역할</td><td>직접 Kafka 연동 혹은 EventBus 추상화 통해 교체 가능</td></tr><tr><td><strong>재처리 (Replay)</strong></td><td>Poller 재시도 필요 (기본 제공 안함)</td><td>저장소 기반 전체 재처리 또는 조건별 재처리 가능</td></tr><tr><td><strong>적합한 상황</strong></td><td>✅ 일관성이 중요한 주문, 결제 시스템<br>✅ 트랜잭션 DB 기반 시스템</td><td>✅ 이벤트 중심 복합 처리, 분석, 감사 로그가 필요한 시스템<br>✅ MSA 연계 또는 재처리 유스케이스</td></tr></tbody></table><h4 id=아키텍처-흐름-시각화>아키텍처 흐름 시각화<a hidden class=anchor aria-hidden=true href=#아키텍처-흐름-시각화>#</a></h4><h5 id=outbox-pattern-구조>Outbox Pattern 구조<a hidden class=anchor aria-hidden=true href=#outbox-pattern-구조>#</a></h5><pre class=mermaid>sequenceDiagram
    participant App
    participant DB
    participant OutboxTable
    participant Kafka
    participant Poller

    App-&gt;&gt;DB: 트랜잭션 처리 (Order + Outbox Insert)
    Poller-&gt;&gt;OutboxTable: Poll + Fetch 이벤트
    Poller-&gt;&gt;Kafka: 이벤트 발행
</pre><h5 id=hybrid-eventbus-구조>Hybrid EventBus 구조<a hidden class=anchor aria-hidden=true href=#hybrid-eventbus-구조>#</a></h5><pre class=mermaid>sequenceDiagram
    participant Domain
    participant Dispatcher
    participant EventStore
    participant Kafka

    Domain-&gt;&gt;Dispatcher: Domain Event 발생
    Dispatcher-&gt;&gt;Kafka: Kafka 발행
    Dispatcher-&gt;&gt;EventStore: DB 저장
</pre><h3 id=modular-monolith--microservices-전환-전략>Modular Monolith → Microservices 전환 전략<a hidden class=anchor aria-hidden=true href=#modular-monolith--microservices-전환-전략>#</a></h3><p>Modular Monolith 에서 Microservices Architecture 로 전환할 때는 <strong>단계적 분리 전략</strong>이 필요하다.<br>단순 모듈 → 마이크로서비스 추출까지는 코드, 빌드, 배포, 인프라 모두에서의 점진적 진화가 필수이다.</p><pre class=mermaid>flowchart TD
  A[도메인 모듈화 완료] --&gt; B[계층/의존성 정리 및 경계 확인]
  B --&gt; C[데이터 분리 전략 수립]
  C --&gt; D[빌드/테스트 자동화 분리]
  D --&gt; E[배포 파이프라인 분리]
  E --&gt; F[&#34;독립 서비스로 추출 (MSA)&#34;]
</pre><h4 id=단계별-상세-전략>단계별 상세 전략<a hidden class=anchor aria-hidden=true href=#단계별-상세-전략>#</a></h4><table><thead><tr><th>단계</th><th>구분</th><th>전략</th></tr></thead><tbody><tr><td><strong>1 단계</strong></td><td>코드 분리</td><td>- DDD 기반 <code>Bounded Context</code> 정의<br>- 인터페이스와 구현체 분리<br>- 내부 모듈 간 직접 호출 제거</td></tr><tr><td><strong>2 단계</strong></td><td>의존성 정리</td><td>- DI 기반으로 의존성 역전<br>- 기술적 계층 대신 도메인 기준 계층화<br>- 모듈 간 순환 의존 제거</td></tr><tr><td><strong>3 단계</strong></td><td>데이터 분리</td><td>- 논리적 DB 분리 → 물리적 분리 계획<br>- 데이터 소유권 (Boundary Ownership) 명시<br>Transaction 을 Domain 내부에만 한정</td></tr><tr><td><strong>4 단계</strong></td><td>빌드/테스트 분리</td><td>- 모듈별 테스트 전용 CI 단계 구성<br>- 테스트 시 DB/환경 격리 (Testcontainers, mocks)</td></tr><tr><td><strong>5 단계</strong></td><td>배포 구조 분리</td><td>- 모듈 단위 빌드 (Gradle multi-module, pnpm workspace 등)<br>Docker 이미지 생성 구조 분리<br>- 서비스별 Helm 차트/Manifest 준비</td></tr><tr><td><strong>6 단계</strong></td><td>독립 서비스 추출</td><td>- 각 모듈을 독립 서비스로 분리 배포<br>API Gateway 및 Service Registry 도입<br>- 모듈 간 통신을 HTTP/gRPC or 메시지 브로커로 전환</td></tr></tbody></table><ul><li>모놀리식 코드 구조를 유지하면서도 <strong>경계를 명확히 나누는 것</strong>이 전환의 출발점이다.</li><li>위 전략은 Strangler Fig Pattern 과 결합하여 점진적으로 적용하는 것이 가장 안전하다.</li></ul><h4 id=이벤트-기반-통합-설계>이벤트 기반 통합 설계<a hidden class=anchor aria-hidden=true href=#이벤트-기반-통합-설계>#</a></h4><p>MSA 전환 없이도 Modular Monolith 내부에서 <strong>도메인 이벤트를 활용한 비동기 통합</strong>이 가능하다. 이는 향후 서비스 분리 시에도 그대로 외부 이벤트로 확장될 수 있다.</p><h5 id=설계-구조>설계 구조<a hidden class=anchor aria-hidden=true href=#설계-구조>#</a></h5><pre class=mermaid>sequenceDiagram
  participant ModuleA
  participant EventBus
  participant ModuleB
  participant ModuleC

  ModuleA-&gt;&gt;EventBus: publish(OrderCreatedEvent)
  EventBus-&gt;&gt;ModuleB: handle(OrderCreatedEvent)
  EventBus-&gt;&gt;ModuleC: handle(OrderCreatedEvent)
</pre><h5 id=이벤트-통합-구성-방식>이벤트 통합 구성 방식<a hidden class=anchor aria-hidden=true href=#이벤트-통합-구성-방식>#</a></h5><table><thead><tr><th>요소</th><th>설명</th><th>구현 예시 (Spring 기준)</th></tr></thead><tbody><tr><td><strong>도메인 이벤트 정의</strong></td><td>이벤트 객체 정의 (<code>OrderCreatedEvent</code>)</td><td>POJO, record, DTO</td></tr><tr><td><strong>퍼블리셔</strong></td><td>도메인 로직 이후 이벤트 발행</td><td><code>eventPublisher.publishEvent()</code></td></tr><tr><td><strong>이벤트 버스</strong></td><td>내부 메시지 버스 또는 Observer 패턴</td><td>Spring <code>ApplicationEventPublisher</code></td></tr><tr><td><strong>리스너</strong></td><td>관심 있는 모듈에서 이벤트 수신</td><td><code>@EventListener</code>, <code>@TransactionalEventListener</code></td></tr><tr><td><strong>비동기 처리</strong></td><td>별도 스레드로 처리하거나 큐 기반 처리</td><td><code>@Async</code>, 또는 Kafka 등 메시징 연계</td></tr></tbody></table><h5 id=적용-시-고려사항>적용 시 고려사항<a hidden class=anchor aria-hidden=true href=#적용-시-고려사항>#</a></h5><table><thead><tr><th>고려 항목</th><th>설명</th></tr></thead><tbody><tr><td>트랜잭션 경계</td><td>이벤트는 트랜잭션 성공 이후 발행해야 함 (<code>TransactionalEventListener</code>)</td></tr><tr><td>동기/비동기 처리</td><td>모놀리스 내부에서는 동기/비동기 선택 가능, MSA 전환 시 비동기로 교체 용이</td></tr><tr><td>중복 처리 방지</td><td>이벤트 핸들러에서 멱등성 (idempotency) 확보 필요</td></tr><tr><td>이벤트 저장 여부</td><td>Event Sourcing 이 아닌 경우, 저장은 필수 아님 (추후 확장을 고려해 로그 남길 수도 있음)</td></tr></tbody></table><h5 id=예시-코드>예시 코드<a hidden class=anchor aria-hidden=true href=#예시-코드>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-53-1><a class=lnlinks href=#hl-53-1> 1</a>
</span><span class=lnt id=hl-53-2><a class=lnlinks href=#hl-53-2> 2</a>
</span><span class=lnt id=hl-53-3><a class=lnlinks href=#hl-53-3> 3</a>
</span><span class=lnt id=hl-53-4><a class=lnlinks href=#hl-53-4> 4</a>
</span><span class=lnt id=hl-53-5><a class=lnlinks href=#hl-53-5> 5</a>
</span><span class=lnt id=hl-53-6><a class=lnlinks href=#hl-53-6> 6</a>
</span><span class=lnt id=hl-53-7><a class=lnlinks href=#hl-53-7> 7</a>
</span><span class=lnt id=hl-53-8><a class=lnlinks href=#hl-53-8> 8</a>
</span><span class=lnt id=hl-53-9><a class=lnlinks href=#hl-53-9> 9</a>
</span><span class=lnt id=hl-53-10><a class=lnlinks href=#hl-53-10>10</a>
</span><span class=lnt id=hl-53-11><a class=lnlinks href=#hl-53-11>11</a>
</span><span class=lnt id=hl-53-12><a class=lnlinks href=#hl-53-12>12</a>
</span><span class=lnt id=hl-53-13><a class=lnlinks href=#hl-53-13>13</a>
</span><span class=lnt id=hl-53-14><a class=lnlinks href=#hl-53-14>14</a>
</span><span class=lnt id=hl-53-15><a class=lnlinks href=#hl-53-15>15</a>
</span><span class=lnt id=hl-53-16><a class=lnlinks href=#hl-53-16>16</a>
</span><span class=lnt id=hl-53-17><a class=lnlinks href=#hl-53-17>17</a>
</span><span class=lnt id=hl-53-18><a class=lnlinks href=#hl-53-18>18</a>
</span><span class=lnt id=hl-53-19><a class=lnlinks href=#hl-53-19>19</a>
</span><span class=lnt id=hl-53-20><a class=lnlinks href=#hl-53-20>20</a>
</span><span class=lnt id=hl-53-21><a class=lnlinks href=#hl-53-21>21</a>
</span><span class=lnt id=hl-53-22><a class=lnlinks href=#hl-53-22>22</a>
</span><span class=lnt id=hl-53-23><a class=lnlinks href=#hl-53-23>23</a>
</span><span class=lnt id=hl-53-24><a class=lnlinks href=#hl-53-24>24</a>
</span><span class=lnt id=hl-53-25><a class=lnlinks href=#hl-53-25>25</a>
</span><span class=lnt id=hl-53-26><a class=lnlinks href=#hl-53-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># event.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderCreatedEvent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>user_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>order_id</span> <span class=o>=</span> <span class=n>order_id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_id</span> <span class=o>=</span> <span class=n>user_id</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># publisher.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>EventBus</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>subscribe</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_type</span><span class=p>,</span> <span class=n>handler</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=n>event_type</span><span class=p>,</span> <span class=p>[])</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>handler</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>publish</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>handler</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>subscribers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>event</span><span class=p>),</span> <span class=p>[]):</span>
</span></span><span class=line><span class=cl>            <span class=n>handler</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># listener.py</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>handle_order_created</span><span class=p>(</span><span class=n>event</span><span class=p>:</span> <span class=n>OrderCreatedEvent</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[ModuleB] Handling order: </span><span class=si>{</span><span class=n>event</span><span class=o>.</span><span class=n>order_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># main.py</span>
</span></span><span class=line><span class=cl><span class=n>bus</span> <span class=o>=</span> <span class=n>EventBus</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>bus</span><span class=o>.</span><span class=n>subscribe</span><span class=p>(</span><span class=n>OrderCreatedEvent</span><span class=p>,</span> <span class=n>handle_order_created</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>bus</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>OrderCreatedEvent</span><span class=p>(</span><span class=n>order_id</span><span class=o>=</span><span class=s2>&#34;1234&#34;</span><span class=p>,</span> <span class=n>user_id</span><span class=o>=</span><span class=s2>&#34;5678&#34;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=event-driven-modular-monolith--microservices-로의-점진적-분리-실전-사례>Event-Driven Modular Monolith → Microservices 로의 점진적 분리 실전 사례<a hidden class=anchor aria-hidden=true href=#event-driven-modular-monolith--microservices-로의-점진적-분리-실전-사례>#</a></h4><p>Event-Driven Modular Monolith 는 <strong>MSA 전환의 출발점으로 매우 효과적</strong>이며, 내부 이벤트 퍼블리싱 구조와 Outbox 를 먼저 구성해두면 이후 각 모듈을 서비스로 독립시키는 데 있어서 <strong>위험도 없이 유연한 점진적 분리</strong>가 가능하다. 특히, 이벤트 명세 표준화와 멱등성, 모니터링 체계를 미리 준비하는 것이 성공적인 전환의 핵심이다.</p><pre class=mermaid>flowchart TD
  subgraph Modular Monolith
    A1[Order Module]
    A2[Payment Module]
    A3[Inventory Module]
    A4[Notification Module]
    E1[Internal EventBus]
  end

  E1 --&gt; A2
  E1 --&gt; A3
  E1 --&gt; A4

  subgraph Microservices
    B1[order-service]
    B2[payment-service]
  end

  A1 -.-&gt; B1
  A2 -.-&gt; B2
</pre><p><strong>핵심 개념</strong>:</p><ul><li>처음에는 Internal EventBus 기반의 Event-Driven Modular Monolith</li><li>점차 각 모듈을 MSA 로 분리하되 이벤트 구조는 재사용</li></ul><h5 id=단계별-전환-전략>단계별 전환 전략<a hidden class=anchor aria-hidden=true href=#단계별-전환-전략>#</a></h5><table><thead><tr><th>단계</th><th>설명</th><th>기술/전략</th></tr></thead><tbody><tr><td><strong>1 단계</strong></td><td>모듈 경계 정의 및 이벤트 발행 구조 구성</td><td><code>DomainEvent</code>, <code>EventBus</code>, <code>@EventListener</code></td></tr><tr><td><strong>2 단계</strong></td><td>Outbox 테이블 도입 (트랜잭션 분리)</td><td>Outbox 패턴, Kafka Topic 설계</td></tr><tr><td><strong>3 단계</strong></td><td>메시지 브로커 연동</td><td>Kafka, RabbitMQ, SNS/SQS</td></tr><tr><td><strong>4 단계</strong></td><td>특정 모듈을 독립 서비스로 추출</td><td>Spring Boot App / FastAPI App 별도 실행</td></tr><tr><td><strong>5 단계</strong></td><td>내부 호출 → API 호출 or 메시지 기반 교체</td><td>Feign, HTTP, gRPC, Kafka Consumer</td></tr><tr><td><strong>6 단계</strong></td><td>공유 DB → 모듈별 DB 분리</td><td>Polyglot Persistence 전략</td></tr><tr><td><strong>7 단계</strong></td><td>API Gateway, 서비스 디스커버리 도입</td><td>Kong, Istio, Consul 등</td></tr></tbody></table><h5 id=실전-사례-전자상거래-시스템>실전 사례: 전자상거래 시스템<a hidden class=anchor aria-hidden=true href=#실전-사례-전자상거래-시스템>#</a></h5><h6 id=전환-전-구조-modular-monolith>전환 전 구조 (Modular Monolith)<a hidden class=anchor aria-hidden=true href=#전환-전-구조-modular-monolith>#</a></h6><ul><li><code>order</code> 모듈: 주문 등록, 상태 변경</li><li><code>payment</code> 모듈: 결제 승인 처리</li><li><code>notification</code> 모듈: 이메일/SMS 발송</li><li>이벤트 구조: <code>OrderCreated</code>, <code>PaymentCompleted</code></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-55-1><a class=lnlinks href=#hl-55-1>1</a>
</span><span class=lnt id=hl-55-2><a class=lnlinks href=#hl-55-2>2</a>
</span><span class=lnt id=hl-55-3><a class=lnlinks href=#hl-55-3>3</a>
</span><span class=lnt id=hl-55-4><a class=lnlinks href=#hl-55-4>4</a>
</span><span class=lnt id=hl-55-5><a class=lnlinks href=#hl-55-5>5</a>
</span><span class=lnt id=hl-55-6><a class=lnlinks href=#hl-55-6>6</a>
</span><span class=lnt id=hl-55-7><a class=lnlinks href=#hl-55-7>7</a>
</span><span class=lnt id=hl-55-8><a class=lnlinks href=#hl-55-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># domain event</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderCreatedEvent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>):</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># application layer</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_order</span><span class=p>(</span><span class=err>…</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>save_order</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>event_bus</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>OrderCreatedEvent</span><span class=p>(</span><span class=n>order_id</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=전환-단계-요약>전환 단계 요약<a hidden class=anchor aria-hidden=true href=#전환-단계-요약>#</a></h6><table><thead><tr><th>단계</th><th>구체 예시</th></tr></thead><tbody><tr><td><strong>모듈 → 서비스 추출</strong></td><td><code>payment</code> 모듈 → <code>payment-service</code> 로 분리</td></tr><tr><td><strong>이벤트 발행 전환</strong></td><td>기존 Internal Event → Kafka 발행</td></tr><tr><td><strong>Consumer 구성</strong></td><td><code>payment-service</code> 는 Kafka 에서 <code>OrderCreated</code> 수신</td></tr><tr><td><strong>DB 분리</strong></td><td><code>order-service</code> 와 <code>payment-service</code> 각각 독립 DB</td></tr><tr><td><strong>인증 처리</strong></td><td>JWT 기반 토큰 전달, 내부 인증 연동</td></tr><tr><td><strong>오류 처리</strong></td><td>Retry + DLQ 설정, Kafka consumer 멱등 처리</td></tr></tbody></table><h6 id=주요-구현-예시>주요 구현 예시<a hidden class=anchor aria-hidden=true href=#주요-구현-예시>#</a></h6><ul><li>Python (FastAPI + SQLAlchemy + Kafka 구조)</li><li>CQRS + Outbox 기반 Kafka 발행 구조</li></ul><table><thead><tr><th>구성 요소</th><th>설명</th></tr></thead><tbody><tr><td><code>OrderCreatedEvent</code></td><td>도메인 이벤트 정의</td></tr><tr><td><code>OutboxEvent</code> 테이블</td><td>이벤트 저장소 (내부 DB)</td></tr><tr><td><code>publish_outbox_events</code></td><td>Kafka 발행기 (Batch or Scheduler)</td></tr><tr><td>KafkaConsumer</td><td>Microservice 간 이벤트 수신</td></tr></tbody></table><ol><li><p><code>order-service</code>: 주문 생성 및 Outbox 저장</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-56-1><a class=lnlinks href=#hl-56-1>1</a>
</span><span class=lnt id=hl-56-2><a class=lnlinks href=#hl-56-2>2</a>
</span><span class=lnt id=hl-56-3><a class=lnlinks href=#hl-56-3>3</a>
</span><span class=lnt id=hl-56-4><a class=lnlinks href=#hl-56-4>4</a>
</span><span class=lnt id=hl-56-5><a class=lnlinks href=#hl-56-5>5</a>
</span><span class=lnt id=hl-56-6><a class=lnlinks href=#hl-56-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># domain_event.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderCreatedEvent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>order_id</span> <span class=o>=</span> <span class=n>order_id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>type</span> <span class=o>=</span> <span class=s2>&#34;OrderCreated&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>payload</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;order_id&#34;</span><span class=p>:</span> <span class=n>order_id</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-57-1><a class=lnlinks href=#hl-57-1> 1</a>
</span><span class=lnt id=hl-57-2><a class=lnlinks href=#hl-57-2> 2</a>
</span><span class=lnt id=hl-57-3><a class=lnlinks href=#hl-57-3> 3</a>
</span><span class=lnt id=hl-57-4><a class=lnlinks href=#hl-57-4> 4</a>
</span><span class=lnt id=hl-57-5><a class=lnlinks href=#hl-57-5> 5</a>
</span><span class=lnt id=hl-57-6><a class=lnlinks href=#hl-57-6> 6</a>
</span><span class=lnt id=hl-57-7><a class=lnlinks href=#hl-57-7> 7</a>
</span><span class=lnt id=hl-57-8><a class=lnlinks href=#hl-57-8> 8</a>
</span><span class=lnt id=hl-57-9><a class=lnlinks href=#hl-57-9> 9</a>
</span><span class=lnt id=hl-57-10><a class=lnlinks href=#hl-57-10>10</a>
</span><span class=lnt id=hl-57-11><a class=lnlinks href=#hl-57-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># repository/outbox_repository.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy.orm</span> <span class=kn>import</span> <span class=n>Session</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>models</span> <span class=kn>import</span> <span class=n>OutboxEvent</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>save_outbox_event</span><span class=p>(</span><span class=n>db</span><span class=p>:</span> <span class=n>Session</span><span class=p>,</span> <span class=n>event</span><span class=p>:</span> <span class=n>OrderCreatedEvent</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>outbox</span> <span class=o>=</span> <span class=n>OutboxEvent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>event_type</span><span class=o>=</span><span class=n>event</span><span class=o>.</span><span class=n>type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span><span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>event</span><span class=o>.</span><span class=n>payload</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>status</span><span class=o>=</span><span class=s2>&#34;PENDING&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>outbox</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-58-1><a class=lnlinks href=#hl-58-1>1</a>
</span><span class=lnt id=hl-58-2><a class=lnlinks href=#hl-58-2>2</a>
</span><span class=lnt id=hl-58-3><a class=lnlinks href=#hl-58-3>3</a>
</span><span class=lnt id=hl-58-4><a class=lnlinks href=#hl-58-4>4</a>
</span><span class=lnt id=hl-58-5><a class=lnlinks href=#hl-58-5>5</a>
</span><span class=lnt id=hl-58-6><a class=lnlinks href=#hl-58-6>6</a>
</span><span class=lnt id=hl-58-7><a class=lnlinks href=#hl-58-7>7</a>
</span><span class=lnt id=hl-58-8><a class=lnlinks href=#hl-58-8>8</a>
</span><span class=lnt id=hl-58-9><a class=lnlinks href=#hl-58-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># service/order_service.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>domain_event</span> <span class=kn>import</span> <span class=n>OrderCreatedEvent</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>repository</span> <span class=kn>import</span> <span class=n>order_repository</span><span class=p>,</span> <span class=n>outbox_repository</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_order</span><span class=p>(</span><span class=n>db</span><span class=p>,</span> <span class=n>order_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>order</span> <span class=o>=</span> <span class=n>order_repository</span><span class=o>.</span><span class=n>save_order</span><span class=p>(</span><span class=n>db</span><span class=p>,</span> <span class=n>order_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>event</span> <span class=o>=</span> <span class=n>OrderCreatedEvent</span><span class=p>(</span><span class=n>order</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>outbox_repository</span><span class=o>.</span><span class=n>save_outbox_event</span><span class=p>(</span><span class=n>db</span><span class=p>,</span> <span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>order</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>Outbox Processor (Background Task or Celery Beat)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-59-1><a class=lnlinks href=#hl-59-1> 1</a>
</span><span class=lnt id=hl-59-2><a class=lnlinks href=#hl-59-2> 2</a>
</span><span class=lnt id=hl-59-3><a class=lnlinks href=#hl-59-3> 3</a>
</span><span class=lnt id=hl-59-4><a class=lnlinks href=#hl-59-4> 4</a>
</span><span class=lnt id=hl-59-5><a class=lnlinks href=#hl-59-5> 5</a>
</span><span class=lnt id=hl-59-6><a class=lnlinks href=#hl-59-6> 6</a>
</span><span class=lnt id=hl-59-7><a class=lnlinks href=#hl-59-7> 7</a>
</span><span class=lnt id=hl-59-8><a class=lnlinks href=#hl-59-8> 8</a>
</span><span class=lnt id=hl-59-9><a class=lnlinks href=#hl-59-9> 9</a>
</span><span class=lnt id=hl-59-10><a class=lnlinks href=#hl-59-10>10</a>
</span><span class=lnt id=hl-59-11><a class=lnlinks href=#hl-59-11>11</a>
</span><span class=lnt id=hl-59-12><a class=lnlinks href=#hl-59-12>12</a>
</span><span class=lnt id=hl-59-13><a class=lnlinks href=#hl-59-13>13</a>
</span><span class=lnt id=hl-59-14><a class=lnlinks href=#hl-59-14>14</a>
</span><span class=lnt id=hl-59-15><a class=lnlinks href=#hl-59-15>15</a>
</span><span class=lnt id=hl-59-16><a class=lnlinks href=#hl-59-16>16</a>
</span><span class=lnt id=hl-59-17><a class=lnlinks href=#hl-59-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># task/outbox_processor.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaProducer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>repository</span> <span class=kn>import</span> <span class=n>outbox_repository</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>database</span> <span class=kn>import</span> <span class=n>SessionLocal</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span><span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>publish_outbox_events</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span> <span class=o>=</span> <span class=n>SessionLocal</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>events</span> <span class=o>=</span> <span class=n>outbox_repository</span><span class=o>.</span><span class=n>get_pending_events</span><span class=p>(</span><span class=n>db</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>event</span> <span class=ow>in</span> <span class=n>events</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s2>&#34;order.created&#34;</span><span class=p>,</span> <span class=n>event</span><span class=o>.</span><span class=n>payload</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>outbox_repository</span><span class=o>.</span><span class=n>mark_sent</span><span class=p>(</span><span class=n>db</span><span class=p>,</span> <span class=n>event</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>위 코드는 BackgroundScheduler (e.g. APScheduler), Celery periodic task 로 주기적으로 실행 가능</li></ul></li><li><p><code>payment-service</code>: Kafka Consumer</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-60-1><a class=lnlinks href=#hl-60-1> 1</a>
</span><span class=lnt id=hl-60-2><a class=lnlinks href=#hl-60-2> 2</a>
</span><span class=lnt id=hl-60-3><a class=lnlinks href=#hl-60-3> 3</a>
</span><span class=lnt id=hl-60-4><a class=lnlinks href=#hl-60-4> 4</a>
</span><span class=lnt id=hl-60-5><a class=lnlinks href=#hl-60-5> 5</a>
</span><span class=lnt id=hl-60-6><a class=lnlinks href=#hl-60-6> 6</a>
</span><span class=lnt id=hl-60-7><a class=lnlinks href=#hl-60-7> 7</a>
</span><span class=lnt id=hl-60-8><a class=lnlinks href=#hl-60-8> 8</a>
</span><span class=lnt id=hl-60-9><a class=lnlinks href=#hl-60-9> 9</a>
</span><span class=lnt id=hl-60-10><a class=lnlinks href=#hl-60-10>10</a>
</span><span class=lnt id=hl-60-11><a class=lnlinks href=#hl-60-11>11</a>
</span><span class=lnt id=hl-60-12><a class=lnlinks href=#hl-60-12>12</a>
</span><span class=lnt id=hl-60-13><a class=lnlinks href=#hl-60-13>13</a>
</span><span class=lnt id=hl-60-14><a class=lnlinks href=#hl-60-14>14</a>
</span><span class=lnt id=hl-60-15><a class=lnlinks href=#hl-60-15>15</a>
</span><span class=lnt id=hl-60-16><a class=lnlinks href=#hl-60-16>16</a>
</span><span class=lnt id=hl-60-17><a class=lnlinks href=#hl-60-17>17</a>
</span><span class=lnt id=hl-60-18><a class=lnlinks href=#hl-60-18>18</a>
</span><span class=lnt id=hl-60-19><a class=lnlinks href=#hl-60-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># consumer/payment_consumer.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaConsumer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;order.created&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>group_id</span><span class=o>=</span><span class=s1>&#39;payment-group&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>auto_offset_reset</span><span class=o>=</span><span class=s1>&#39;earliest&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>enable_auto_commit</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>message</span> <span class=ow>in</span> <span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>event</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>message</span><span class=o>.</span><span class=n>value</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s2>&#34;utf-8&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>order_id</span> <span class=o>=</span> <span class=n>event</span><span class=p>[</span><span class=s2>&#34;order_id&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 결제 승인 처리 로직</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Received order.created event for order_id: </span><span class=si>{</span><span class=n>order_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># approve_payment(order_id)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>보조: Outbox 테이블 모델 정의 (SQLAlchemy)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-61-1><a class=lnlinks href=#hl-61-1> 1</a>
</span><span class=lnt id=hl-61-2><a class=lnlinks href=#hl-61-2> 2</a>
</span><span class=lnt id=hl-61-3><a class=lnlinks href=#hl-61-3> 3</a>
</span><span class=lnt id=hl-61-4><a class=lnlinks href=#hl-61-4> 4</a>
</span><span class=lnt id=hl-61-5><a class=lnlinks href=#hl-61-5> 5</a>
</span><span class=lnt id=hl-61-6><a class=lnlinks href=#hl-61-6> 6</a>
</span><span class=lnt id=hl-61-7><a class=lnlinks href=#hl-61-7> 7</a>
</span><span class=lnt id=hl-61-8><a class=lnlinks href=#hl-61-8> 8</a>
</span><span class=lnt id=hl-61-9><a class=lnlinks href=#hl-61-9> 9</a>
</span><span class=lnt id=hl-61-10><a class=lnlinks href=#hl-61-10>10</a>
</span><span class=lnt id=hl-61-11><a class=lnlinks href=#hl-61-11>11</a>
</span><span class=lnt id=hl-61-12><a class=lnlinks href=#hl-61-12>12</a>
</span><span class=lnt id=hl-61-13><a class=lnlinks href=#hl-61-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># models.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy</span> <span class=kn>import</span> <span class=n>Column</span><span class=p>,</span> <span class=n>Integer</span><span class=p>,</span> <span class=n>String</span><span class=p>,</span> <span class=n>Text</span><span class=p>,</span> <span class=n>DateTime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>database</span> <span class=kn>import</span> <span class=n>Base</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OutboxEvent</span><span class=p>(</span><span class=n>Base</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>__tablename__</span> <span class=o>=</span> <span class=s2>&#34;outbox_events&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>id</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>Integer</span><span class=p>,</span> <span class=n>primary_key</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>event_type</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>String</span><span class=p>(</span><span class=mi>100</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>Text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>status</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>String</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span> <span class=n>default</span><span class=o>=</span><span class=s2>&#34;PENDING&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>created_at</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>DateTime</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h4 id=실무-전환-시-고려-사항-및-교훈>실무 전환 시 고려 사항 및 교훈<a hidden class=anchor aria-hidden=true href=#실무-전환-시-고려-사항-및-교훈>#</a></h4><table><thead><tr><th>고려 항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>이벤트 설계의 표준화</strong></td><td>이벤트 이름, 버전, 스키마 관리가 핵심 (예: Avro, JSON Schema)</td></tr><tr><td><strong>멱등성 보장</strong></td><td>Consumer 는 중복 이벤트에 대해 동일 결과 보장</td></tr><tr><td><strong>계약 테스트</strong></td><td>이벤트 기반 통합의 경우 <strong>Event Contract Test</strong> 필요</td></tr><tr><td><strong>모니터링/트레이싱</strong></td><td>Trace ID 전달 필수 (OpenTelemetry, Zipkin 연동)</td></tr><tr><td><strong>DB 분리 및 데이터 동기화</strong></td><td>데이터 중복 허용 → Eventually Consistent 설계 적용</td></tr><tr><td><strong>모놀리스 부분 잔존 허용</strong></td><td>점진적으로 하나씩 서비스화, 나머지는 계속 모듈로 유지 가능</td></tr><tr><td><strong>팀 조직 리디자인 필요</strong></td><td>모듈별 → 서비스별 팀 구성 변경 필요 가능성 있음</td></tr></tbody></table><h4 id=msa-전환-시-메시징-구조-확장-전략>MSA 전환 시 메시징 구조 확장 전략<a hidden class=anchor aria-hidden=true href=#msa-전환-시-메시징-구조-확장-전략>#</a></h4><h5 id=internal-event--external-event-확장-흐름>Internal Event → External Event 확장 흐름<a hidden class=anchor aria-hidden=true href=#internal-event--external-event-확장-흐름>#</a></h5><pre class=mermaid>flowchart TD
  A[Domain Layer] --&gt;|DomainEvent 발행| B(Application Layer)
  B --&gt;|EventBus 전달| C[Internal EventBus]
  C --&gt;|Local handler 실행| D[Other Module]
  C --&gt;|Outbox 저장| E[Outbox Table]
  E --&gt; F[Outbox Processor]
  F --&gt; G[Kafka/RabbitMQ 등 External Broker]
  G --&gt; H[외부 Microservice]
</pre><h5 id=단계별-전략>단계별 전략<a hidden class=anchor aria-hidden=true href=#단계별-전략>#</a></h5><table><thead><tr><th>단계</th><th>설명</th><th>기술 적용 예</th></tr></thead><tbody><tr><td><strong>1 단계</strong></td><td>도메인 이벤트 발행 (<code>OrderCreatedEvent</code>)</td><td>도메인 객체 내부에서 상태 변화 후 발행</td></tr><tr><td><strong>2 단계</strong></td><td>Internal EventBus 에서 핸들링</td><td>Application Layer 에서 다른 모듈 호출 or 저장</td></tr><tr><td><strong>3 단계</strong></td><td>Outbox 테이블에 이벤트 저장</td><td><code>status: PENDING</code> 으로 기록</td></tr><tr><td><strong>4 단계</strong></td><td>비동기 처리기로 외부 브로커 발행</td><td>Kafka, RabbitMQ, AWS SNS 등</td></tr><tr><td><strong>5 단계</strong></td><td>외부 서비스에서 수신 및 후속 처리</td><td>각 서비스의 Consumer 에서 처리</td></tr></tbody></table><h5 id=internal--external-전환-장점>Internal → External 전환 장점<a hidden class=anchor aria-hidden=true href=#internal--external-전환-장점>#</a></h5><table><thead><tr><th>장점</th><th>설명</th></tr></thead><tbody><tr><td><strong>점진적 전환</strong></td><td>기존 internal 로직을 유지하면서 외부 발행만 추가</td></tr><tr><td><strong>테스트 용이성</strong></td><td>Outbox 기록만으로도 로컬 디버깅 가능</td></tr><tr><td><strong>이벤트 재처리 가능성</strong></td><td>실패 시 재시도, DLQ 적용 용이</td></tr><tr><td><strong>계약 기반 설계로 확장성 확보</strong></td><td>이벤트 스키마를 명확히 관리 가능 (Avro, JSON Schema 등)</td></tr></tbody></table><h3 id=주목할-내용>주목할 내용<a hidden class=anchor aria-hidden=true href=#주목할-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>핵심 항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>아키텍처 설계</strong></td><td>모듈 경계 설정</td><td>Bounded Context, Domain Module</td><td>도메인 기반으로 기능 단위를 모듈화하여 책임과 경계를 명확히 설정</td></tr><tr><td></td><td>아키텍처 스타일</td><td>Modular Monolith, Layered Architecture, Clean Architecture, Hexagonal Architecture</td><td>내부 구조를 계층적 또는 포트 - 어댑터 방식으로 구분하여 유연성 확보</td></tr><tr><td></td><td>점진적 마이그레이션 전략</td><td>Strangler Fig Pattern, Service Extraction</td><td>모놀리식 구조를 점진적으로 마이크로서비스로 전환하는 전략</td></tr><tr><td><strong>설계 원칙</strong></td><td>경계 유지</td><td>Interface Segregation, Loose Coupling</td><td>명확한 API 및 의존성 최소화로 모듈 간 결합도 감소</td></tr><tr><td></td><td>모듈화 단위 설계</td><td>Vertical Slice, Shared Kernel</td><td>기능 단위로 전체 계층을 포함하는 구조 또는 공통 코드의 중앙 관리 방식</td></tr><tr><td></td><td>객체지향 설계 원칙</td><td>SOLID, 12-Factor App</td><td>유연한 변경과 재사용을 위한 설계 기준 적용</td></tr><tr><td><strong>구현 기법</strong></td><td>도메인 중심 설계</td><td>DDD, Domain Modeling, Aggregate</td><td>풍부한 도메인 모델을 기반으로 책임을 분산</td></tr><tr><td></td><td>의존성 제어 및 테스트</td><td>Dependency Injection, IoC Container, Architecture Testing</td><td>결합도 제어와 아키텍처 위반 자동 감지로 유지보수성 확보</td></tr><tr><td></td><td>통신 및 데이터 저장</td><td>In-Process Communication, CQRS, Event Sourcing, Event Store</td><td>CQRS+Event 기반의 도메인 흐름 구현</td></tr><tr><td><strong>운영 및 배포</strong></td><td>배포 전략</td><td>단일 배포, CI/CD, Blue-Green, Canary</td><td>모듈 단위이지만 전체를 하나의 패키지로 배포하며 자동화된 배포 전략 적용</td></tr><tr><td></td><td>장애 대응/확장성</td><td>Circuit Breaker, Zero Downtime Deployment</td><td>운영 안정성 확보 및 무중단 서비스 전환 가능</td></tr><tr><td><strong>테스트 전략</strong></td><td>계약 및 경계 테스트</td><td>Contract Testing, Hexagonal Testing</td><td>모듈 간 통신 및 외부 통합 시 계약 검증을 통해 안정성 확보</td></tr><tr><td><strong>프로세스/조직</strong></td><td>협업 및 품질 관리</td><td>설계 표준, 코드 리뷰, Static Analysis Tool</td><td>팀 기반 협업을 위한 표준화와 품질 확보 도구 도입</td></tr><tr><td></td><td>학습/실험 전략</td><td>도메인 기반 PoC, Event Storming</td><td>개념 검증과 설계 실험을 통한 경계 명확화 및 설계 검증</td></tr></tbody></table><ul><li><p><strong>아키텍처 설계</strong>:<br>Modular Monolith 는 도메인 중심으로 명확한 모듈 경계를 설정하고, 내부 아키텍처를 계층적 (Layered), 헥사고날 (Hexagonal) 또는 클린 아키텍처로 구분하여 내부 유연성과 외부로의 확장을 동시에 고려한다. 점진적인 마이그레이션이 가능하도록 설계되어야 한다.</p></li><li><p><strong>설계 원칙</strong>:<br>SOLID 원칙과 Interface Segregation 등을 통해 각 모듈이 독립적으로 유지보수될 수 있도록 하며, 수직 슬라이스 설계는 기능 중심의 응집도 높은 구조를 가능하게 한다. 공통 코드 (Shared Kernel) 는 신중하게 관리되어야 한다.</p></li><li><p><strong>구현 기법</strong>:<br>DDD 기반의 풍부한 도메인 모델링, CQRS 와 Event Sourcing 의 적용을 통해 시스템 상태를 유연하게 관리할 수 있다. IoC 와 DI 는 결합도를 낮추고, 아키텍처 테스트를 통해 설계 위반을 사전에 방지한다.</p></li><li><p><strong>운영 및 배포</strong>:<br>단일 배포 전략이지만, CI/CD, 블루그린 또는 카나리 배포와 결합하여 안정성과 무중단성을 확보한다. 장애 발생 시 빠른 복구를 위한 회로 차단기 (Circuit Breaker) 적용도 중요하다.</p></li><li><p><strong>테스트 전략</strong>:<br>모듈 간 인터페이스 안정성을 위해 Contract Testing 이 필수적이며, 포트 - 어댑터 기반의 헥사고날 테스트는 테스트 격리를 통해 구조 테스트를 가능하게 한다.</p></li><li><p><strong>프로세스/조직</strong>:<br>코드 리뷰, 아키텍처 표준화, 자동화 분석 도구를 통해 품질을 보장하고, 도메인 기반의 POC 나 Event Storming 을 통해 학습 및 구조 실험을 반복할 수 있다.</p></li></ul><h3 id=반드시-학습해야-할-내용>반드시 학습해야 할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야-할-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>1. 소프트웨어 설계 원칙</strong></td><td>Domain-Driven Design (DDD)</td><td>전략적/전술적 패턴, Bounded Context, Aggregates</td><td>비즈니스 도메인 기반의 경계 설계 및 책임 분리 설계</td></tr><tr><td></td><td>모듈 경계 설계</td><td>모듈화 원칙, 응집도·결합도, 내부 문서화</td><td>변경 최소화, 유연한 확장성, 내부 설계 가시화</td></tr><tr><td></td><td>SOLID, 레이어드 아키텍처</td><td>단일 책임, 의존성 분리, 계층 분할</td><td>모듈 내부의 유지보수성과 테스트 가능성 확보</td></tr><tr><td><strong>2. 아키텍처 스타일 및 구조 패턴</strong></td><td>Monolithic vs Microservices</td><td>비교 분석, 전환 전략</td><td>시스템 복잡도, 조직 구조, 도메인 특성 기반 선택</td></tr><tr><td></td><td>Modular Monolith Architecture</td><td>수직 슬라이스, 계층 설계, 내부 모듈 인터페이스</td><td>독립적 변경·배포 가능한 단위로 구조화</td></tr><tr><td></td><td>Hexagonal / Clean Architecture</td><td>의존성 역전, 포트/어댑터 구조, 계층 간 책임 명확화</td><td>내부 비즈니스 로직과 외부 요소의 명확한 분리</td></tr><tr><td><strong>3. 구현 기술 및 통신 방식</strong></td><td>의존성 주입 (Dependency Injection)</td><td>IoC 컨테이너, DI 구현</td><td>모듈 간 결합도 감소 및 테스트 용이성 증가</td></tr><tr><td></td><td>이벤트 기반 통신</td><td>In-process Event Bus, 메시지 브로커</td><td>비동기 확장과 관심사 분리, 마이크로서비스 전환 기반 마련</td></tr><tr><td></td><td>API 및 인터페이스 설계</td><td>REST, RPC, Contract-First</td><td>모듈 간 계약 기반 설계로 통합 테스트 용이</td></tr><tr><td><strong>4. 데이터 및 트랜잭션 설계</strong></td><td>모듈 간 데이터 관리 설계</td><td>데이터 스키마 분리, 레포지토리 분리</td><td>모듈 간 충돌 최소화 및 데이터 일관성 보장</td></tr><tr><td></td><td>Outbox / Saga 패턴</td><td>메시지 전송 원자성, 분산 트랜잭션 대응</td><td>메시지 일관성 및 롤백 지원</td></tr><tr><td><strong>5. 테스트 및 품질 보증</strong></td><td>테스트 전략</td><td>단위/통합 테스트, ArchUnit / NetArchTest</td><td>모듈 경계 보장과 자동화 테스트 전략 수립</td></tr><tr><td></td><td>코드 품질 관리</td><td>정적 분석, Lint, SonarQube</td><td>품질 확보와 기술 부채 예방</td></tr><tr><td><strong>6. 배포 및 운영 전략</strong></td><td>CI/CD 및 배포 자동화</td><td>파이프라인 설계, Blue-Green, Canary</td><td>안전한 배포와 빠른 롤백을 위한 전략</td></tr><tr><td></td><td>모듈 단위 모니터링</td><td>APM, 메트릭, 로그, 트레이싱</td><td>운영 중 이슈 조기 감지 및 분석 용이</td></tr><tr><td></td><td>컨테이너 오케스트레이션</td><td>Docker, Kubernetes, Helm 등</td><td>운영 환경에서의 일관된 실행 및 확장 지원</td></tr><tr><td><strong>7. 시스템 진화 및 전환 전략</strong></td><td>Strangler Fig Pattern</td><td>점진적 리팩토링, 서비스 분리 단계화</td><td>기존 모놀리스를 안정적으로 모듈러 또는 MSA 로 전환</td></tr><tr><td></td><td>Evolutionary Architecture</td><td>적응 가능한 구조, 변경 수용성 설계</td><td>시스템의 장기적인 확장성과 변화 대응 확보</td></tr></tbody></table><ol><li><p><strong>소프트웨어 설계 원칙</strong>:<br>Modular Monolith 아키텍처의 기반은 도메인 주도 설계 (DDD) 와 SOLID 원칙이다. 특히 Bounded Context 및 모듈 경계 정의는 구조적 유지보수성과 확장을 위해 반드시 필요하며, 레이어드 구조를 통해 책임 분리도 강화된다.</p></li><li><p><strong>아키텍처 스타일 및 구조 패턴</strong>:<br>Monolith, Modular Monolith, Microservices 간 차이를 이해하고, Clean/Hexagonal Architecture 등을 통해 유연하고 테스트 가능한 구조를 설계해야 한다. 수직 슬라이스 및 계층화된 모듈화 전략은 핵심 구성이다.</p></li><li><p><strong>구현 기술 및 통신 방식</strong>:<br>의존성 주입과 In-process 이벤트 기반 통신은 모듈 간 유연한 연결을 가능하게 하며, API 인터페이스 설계는 테스트 및 연동을 안전하게 만든다.</p></li><li><p><strong>데이터 및 트랜잭션 설계</strong>:<br>모듈 간 데이터 설계의 핵심은 충돌 방지와 데이터 일관성 유지다. Outbox 와 Saga 는 메시지 기반 트랜잭션 구현에 필수적이다.</p></li><li><p><strong>테스트 및 품질 보증</strong>:<br>단위 및 통합 테스트를 통해 모듈 경계 위반을 감지하고, 정적 분석 도구를 활용하여 코드 품질을 지속적으로 유지해야 한다.</p></li><li><p><strong>배포 및 운영 전략</strong>:<br>CI/CD, Canary Release, APM 등은 모듈별 빠르고 안정적인 배포와 운영 관리를 위한 기반이며, Kubernetes 등의 오케스트레이션 도구는 스케일업/다운을 자동화하는 데 필수적이다.</p></li><li><p><strong>시스템 진화 및 전환 전략</strong>:<br>Strangler Fig Pattern 은 기존 모놀리스를 점진적으로 MSA 나 고도로 모듈화된 구조로 전환할 때 유용하며, Evolutionary Architecture 는 변경에 강한 구조 설계의 방향성을 제공한다.</p></li></ol><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td><strong>아키텍처 스타일</strong></td><td>Monolithic Architecture</td><td>모든 기능이 하나의 코드베이스 및 실행 단위로 구성된 전통적 구조</td></tr><tr><td></td><td>Modular Monolith</td><td>내부적으로 모듈화되어 있지만 단일 배포 단위를 유지하는 구조</td></tr><tr><td></td><td>Microservices Architecture</td><td>서비스 단위로 분산되어 독립적 개발·배포가 가능한 아키텍처</td></tr><tr><td></td><td>Event-Driven Architecture</td><td>이벤트 흐름 기반의 비동기 처리 중심 아키텍처</td></tr><tr><td><strong>설계 원칙</strong></td><td>Bounded Context</td><td>DDD 에서 도메인 경계를 명시적으로 정의하는 논리적 경계</td></tr><tr><td></td><td>Single Responsibility</td><td>하나의 클래스 또는 모듈은 하나의 책임만 가져야 한다는 원칙 (SRP)</td></tr><tr><td></td><td>High Cohesion</td><td>관련된 기능을 하나의 단위로 묶어 응집도를 높이는 설계 원칙</td></tr><tr><td></td><td>Loose Coupling</td><td>모듈 간의 의존성을 줄여 유연성과 유지보수성을 확보하는 원칙</td></tr><tr><td></td><td>Interface Segregation</td><td>클라이언트별로 최소한의 인터페이스만 제공하도록 분리하는 원칙</td></tr><tr><td><strong>구현 기법</strong></td><td>Dependency Injection (DI)</td><td>외부에서 객체의 의존성을 주입하여 유연성을 높이는 방식</td></tr><tr><td></td><td>Event Sourcing</td><td>상태 변경 이력을 이벤트 시퀀스로 저장하는 방식</td></tr><tr><td></td><td>Repository Pattern</td><td>데이터 접근 로직을 캡슐화해 도메인 로직과 분리하는 패턴</td></tr><tr><td></td><td>Factory Pattern</td><td>객체 생성 로직을 분리하여 추상화하는 생성 패턴</td></tr><tr><td></td><td>Vertical Slice</td><td>기능 단위로 계층을 종단 분리하여 모듈화하는 설계 방식</td></tr><tr><td></td><td>Strangler Fig Pattern</td><td>기존 시스템 위에 새로운 구조를 병행하여 점진적으로 교체하는 전략</td></tr><tr><td><strong>통신 패턴</strong></td><td>In-Process Communication</td><td>네트워크 없이 같은 프로세스 내에서 이루어지는 동기 함수 호출 방식</td></tr><tr><td></td><td>Request-Response</td><td>클라이언트 요청에 대해 응답하는 전통적인 동기 통신 방식</td></tr><tr><td></td><td>Publish-Subscribe</td><td>이벤트 기반으로 메시지를 발행하고 여러 구독자가 처리하는 방식</td></tr><tr><td></td><td>Message Queue</td><td>메시지를 임시 저장하여 비동기적으로 처리하는 방식</td></tr><tr><td><strong>데이터 관리</strong></td><td>Shared Database</td><td>여러 모듈이 동일한 데이터베이스를 공유하는 방식</td></tr><tr><td></td><td>Database per Module</td><td>각 모듈이 별도의 DB 를 가지는 설계 방식</td></tr><tr><td></td><td>Event Store</td><td>이벤트를 영구 저장하는 전용 데이터 저장소</td></tr><tr><td></td><td>Projection</td><td>이벤트를 기반으로 읽기 전용 뷰를 생성하는 방식</td></tr><tr><td></td><td>Snapshot</td><td>특정 시점의 Aggregate 상태를 저장한 스냅샷</td></tr><tr><td><strong>운영 전략</strong></td><td>CI/CD</td><td>빌드, 테스트, 배포를 자동화하는 통합 파이프라인</td></tr><tr><td></td><td>Blue-Green Deployment</td><td>두 개의 환경을 번갈아 사용해 무중단 배포를 구현하는 전략</td></tr><tr><td></td><td>Canary Deployment</td><td>일부 트래픽만 새 버전으로 보내는 점진적 배포 방식</td></tr><tr><td></td><td>Zero Downtime Deployment</td><td>가용성 저하 없이 새로운 버전으로 전환하는 배포 방식</td></tr><tr><td></td><td>Circuit Breaker</td><td>장애 발생 시 서비스 연쇄 중단을 방지하는 보호 패턴</td></tr><tr><td><strong>테스트 전략</strong></td><td>Contract Testing</td><td>API 또는 인터페이스 계약을 기준으로 양측 테스트를 수행하는 방식</td></tr><tr><td></td><td>Integration Testing</td><td>모듈 간 상호 작용을 검증하는 테스트 방식</td></tr><tr><td></td><td>End-to-End Testing (E2E)</td><td>사용자 관점에서 시스템 전체의 흐름을 검증하는 테스트 방식</td></tr><tr><td></td><td>TDD (Test Driven Development)</td><td>테스트를 먼저 작성하고 이후 코드를 구현하는 개발 방식</td></tr><tr><td><strong>품질 관리</strong></td><td>Static Analysis Tool</td><td>코드 실행 없이 정적 분석을 통해 문법, 스타일, 보안 문제를 탐지하는 도구</td></tr><tr><td></td><td>Architecture Tests</td><td>아키텍처 규칙 위반, 계층 침범, 의존성 흐름을 검사하는 테스트</td></tr></tbody></table><h3 id=실무-사용-사례별-용어>실무 사용 사례별 용어<a hidden class=anchor aria-hidden=true href=#실무-사용-사례별-용어>#</a></h3><table><thead><tr><th>사용 사례</th><th>관련 용어 (구현 기술/패턴/원칙/전략)</th><th>설명</th></tr></thead><tbody><tr><td><strong>MSA 환경에서의 통신 구성</strong></td><td><code>Request-Response</code>, <code>Publish-Subscribe</code>, <code>Message Queue</code>, <code>Circuit Breaker</code>, <code>API Gateway</code>, <code>Contract Testing</code></td><td>서비스 간 통신은 REST/gRPC 또는 이벤트 방식. 장애 방지를 위해 회로 차단 패턴 (Circuit Breaker) 사용.</td></tr><tr><td><strong>Event-Driven Architecture 구현</strong></td><td><code>Event Sourcing</code>, <code>Event Store</code>, <code>Projection</code>, <code>Snapshot</code>, <code>CQRS</code>, <code>Publish-Subscribe</code></td><td>이벤트 중심 시스템 구성. 상태 저장은 이벤트 저장소를 통해 수행하며, 읽기 모델 분리 (CQRS) 로 성능 향상.</td></tr><tr><td><strong>모놀리식 구조에서의 내부 통신</strong></td><td><code>In-Process Communication</code>, <code>Shared Database</code>, <code>Layered Architecture</code>, <code>Tight Coupling</code></td><td>메서드 호출로 통신하며, DB 공유. 내부 결합도가 높아 구조적 분리 어려움.</td></tr><tr><td><strong>CI/CD 기반 자동화 파이프라인 구성</strong></td><td><code>CI/CD</code>, <code>Blue-Green Deployment</code>, <code>Canary Deployment</code>, <code>Zero Downtime Deployment</code>, <code>Static Analysis Tool</code></td><td>배포 자동화와 품질 확보를 위해 블루그린/카나리 배포와 정적 분석 도구를 함께 적용.</td></tr><tr><td><strong>도메인 중심의 모듈화 설계</strong></td><td><code>Bounded Context</code>, <code>Aggregate</code>, <code>Vertical Slice</code>, <code>DDD</code>, <code>Interface Segregation</code>, <code>Repository Pattern</code></td><td>각 도메인을 기준으로 모듈을 수직 슬라이스로 분리하고, 외부 노출 계약은 인터페이스 기반으로 관리.</td></tr><tr><td><strong>마이크로서비스 전환 전략 적용 시</strong></td><td><code>Strangler Fig Pattern</code>, <code>Modular Monolith</code>, <code>Contract Testing</code>, <code>Anti-corruption Layer</code></td><td>기존 시스템을 점진적으로 교체하기 위한 구조적 접근 방식. 인터페이스 계약 기반 테스트 필수.</td></tr><tr><td><strong>API 통합 시스템 구현 시</strong></td><td><code>Public API</code>, <code>Interface Package</code>, <code>API Gateway</code>, <code>Request-Response</code>, <code>Contract Testing</code></td><td>외부 소비자와 통합 시 명확한 인터페이스 및 테스트가 중요하며, 게이트웨이를 통한 통합 제어 수행.</td></tr><tr><td><strong>복잡한 데이터 변경 및 읽기 분리 처리</strong></td><td><code>CQRS</code>, <code>Event Sourcing</code>, <code>Projection</code>, <code>Repository Pattern</code>, <code>Snapshot</code>, <code>Aggregate</code></td><td>데이터 저장/조회 경로 분리 및 이벤트 흐름 기반 데이터 일관성 처리 방식 적용.</td></tr><tr><td><strong>운영 안정성 확보 목적 시스템 설계</strong></td><td><code>Circuit Breaker</code>, <code>Health Check</code>, <code>Blue-Green Deployment</code>, <code>Zero Downtime Deployment</code>, <code>Monitoring</code></td><td>장애 방지 및 운영 중단 없이 배포하기 위한 전략적 구성.</td></tr><tr><td><strong>고가용성 및 확장 환경 구성</strong></td><td><code>Database per Module</code>, <code>Shared Nothing</code>, <code>Stateless</code>, <code>Horizontal Scaling</code>, <code>Service Discovery</code></td><td>모듈/서비스 단위 독립성과 수평 확장을 위해 데이터 분리, 서비스 디스커버리 필수.</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://www.milanjovanovic.tech/blog/what-is-a-modular-monolith/>Domain‑Driven Design: Tackling Complexity in the Heart of Software (Eric Evans)</a></li><li><a href=https://chatgpt.com/c/688b7c22-6d70-8328-be03-fd0ced620f84#>Building Microservices: Designing Fine‑Grained Systems (Sam Newman)</a></li><li><a href=https://chatgpt.com/c/688b7c22-6d70-8328-be03-fd0ced620f84#>Software Architecture: The Hard Parts (Neal Ford, Mark Richards, Pramod Sadalage, Zhamak Dehghani)</a></li><li><a href=https://chatgpt.com/c/688b7c22-6d70-8328-be03-fd0ced620f84#>Patterns of Enterprise Application Architecture (Martin Fowler)</a></li><li><a href=https://martinfowler.com/articles/microservices.html>마틴 파울러의 마이크로서비스 아티클</a></li><li><a href=https://microservices.io/>마이크로서비스 패턴 웹사이트</a></li><li><a href=https://www.thoughtworks.com/en-us/insights/blog/microservices/modular-monolith-better-way-build-software>Thoughtworks의 모듈러 모놀리틱 아티클</a></li><li><a href=https://www.milanjovanovic.tech/blog/what-is-a-modular-monolith>Milan Jovanović의 모듈러 모놀리틱 시리즈</a></li><li><a href=https://shopify.engineering/deconstructing-monolith-designing-software-maximizes-developer-productivity>Shopify의 모듈러 모놀리틱 경험담</a></li><li><a href=https://spring.io/projects/spring-modulith>Spring Modulith Documentation</a></li></ul><hr></div><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Boundaries</h2></header><div class=entry-content><p>Boundaries 경계 (Boundaries) 는 소프트웨어 디자인과 아키텍처의 핵심 원칙으로, 시스템의 구조와 구성 요소 간의 관계를 정의하는 중요한 아키텍처 원칙이다. 로버트 마틴 (Robert C. Martin) 은 그의 저서 " 클린 아키텍처 (Clean Architecture)" 에서 " 소프트웨어 아키텍처는 내가 경계라고 부르는 선을 그리는 예술 " 이라고 정의했다.
소프트웨어 시스템의 구성 요소 간의 명확한 경계를 설정하여, 각 구성 요소의 책임을 분리하고 상호작용을 정의함으로써 시스템의 복잡성을 관리하고 변경에 유연하게 대응할 수 있도록 한다. 이를 통해 낮은 결합도와 높은 응집도를 확보하며, 유지보수성, 확장성, 보안성, 테스트 용이성 등 시스템 품질을 극대화한다.
...</p></div><footer class=entry-footer><span title='2024-12-21 04:49:00 +0000 UTC'>December 21, 2024</span>&nbsp;·&nbsp;20 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Boundaries" href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/monolithic-architecture/modular-monolithic/boundaries/></a></article></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>