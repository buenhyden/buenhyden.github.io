<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Layered Architecture | hyunyoun's Blog</title><meta name=keywords content="Software-Engineering,Design-and-Architecture,Architecture-Styles,Layered-Architecture,N-Tier,Separation-of-Concerns,Modular-Software-Design"><meta name=description content="전통적인 Layered Architecture 는 Presentation‑Business‑Data 계층으로 책임 분리해 단순성과 유지보수성을 확보하지만, 계층 간 강한 결합과 확장성 한계가 존재한다. 현대적 Layered Architecture(예: Hexagonal, Clean, Onion) 는 포트‑어댑터, 의존성 반전과 같은 원칙을 통해 내부 코어와 인프라 외부 라이브러리를 엄격히 분리하며, 테스트 가능성과 유연성을 크게 개선한다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/monolithic-architecture/layered-architecture/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/monolithic-architecture/layered-architecture/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/monolithic-architecture/layered-architecture/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/monolithic-architecture/layered-architecture/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Layered Architecture"><meta property="og:description" content="전통적인 Layered Architecture 는 Presentation‑Business‑Data 계층으로 책임 분리해 단순성과 유지보수성을 확보하지만, 계층 간 강한 결합과 확장성 한계가 존재한다. 현대적 Layered Architecture(예: Hexagonal, Clean, Onion) 는 포트‑어댑터, 의존성 반전과 같은 원칙을 통해 내부 코어와 인프라 외부 라이브러리를 엄격히 분리하며, 테스트 가능성과 유연성을 크게 개선한다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Layered Architecture"><meta name=twitter:description content="전통적인 Layered Architecture 는 Presentation‑Business‑Data 계층으로 책임 분리해 단순성과 유지보수성을 확보하지만, 계층 간 강한 결합과 확장성 한계가 존재한다. 현대적 Layered Architecture(예: Hexagonal, Clean, Onion) 는 포트‑어댑터, 의존성 반전과 같은 원칙을 통해 내부 코어와 인프라 외부 라이브러리를 엄격히 분리하며, 테스트 가능성과 유연성을 크게 개선한다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HY's Blog","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":5,"name":"Layered Architecture","item":"https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/monolithic-architecture/layered-architecture/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>HY's Blog</a></div><h1>Layered Architecture</h1><div class=post-description>전통적인 Layered Architecture 는 Presentation‑Business‑Data 계층으로 책임 분리해 단순성과 유지보수성을 확보하지만, 계층 간 강한 결합과 확장성 한계가 존재한다. 현대적 Layered Architecture(예: Hexagonal, Clean, Onion) 는 포트‑어댑터, 의존성 반전과 같은 원칙을 통해 내부 코어와 인프라 외부 라이브러리를 엄격히 분리하며, 테스트 가능성과 유연성을 크게 개선한다.</div></header><div class=post-content><h2 id=layered-architecture>Layered Architecture<a hidden class=anchor aria-hidden=true href=#layered-architecture>#</a></h2><p>계층형 아키텍처 (Layered Architecture) 는 각 역할, 책임, 처리 흐름을 명확히 구분하여 복잡한 소프트웨어 시스템을 논리적 계층으로 나누는 구조적 설계 패턴이다.</p><p>전통적인 계층 구조는 단방향 흐름과 명확한 책임 분리를 중심으로 단순성과 빠른 개발 속도를 중시했던 아키텍처다. 하지만 시간이 지나며 계층 간 강한 결합, 테스트의 어려움, 확장성 제약 등의 한계가 드러났고, 특히 계층 간 통신 비용 증가, 변경 시 여러 계층에 걸친 리팩토링 요구, 단단한 결합, 병렬 처리의 어려움 등도 함께 고려해야 할 구조적 문제로 지적되고 있다.</p><p>이러한 한계를 보완하기 위해 등장한 현대적 계층 구조는 동적 재구성, 레이어 간 의존성 최소화, 서비스 기반 접근법, DevOps 자동화 등 최신 개발 환경과 요구의 변화에 유연하게 적응하며, 유지보수성과 확장성을 극대화한다. 특히 도메인 중심의 Hexagonal Architecture, Onion Architecture, Clean Architecture 와 같은 계층화 모델은 테스트 용이성과 변경 유연성을 확보하는 데 효과적이며, 마이크로서비스, DDD, CI/CD 기반 DevOps 환경과도 높은 시너지를 발휘한다.</p><h3 id=등장-배경-및-발전-과정>등장 배경 및 발전 과정<a hidden class=anchor aria-hidden=true href=#등장-배경-및-발전-과정>#</a></h3><h4 id=메인프레임-시대와-계층형-사고의-출현-1950-년대1970-년대>메인프레임 시대와 계층형 사고의 출현 (1950 년대~1970 년대)<a hidden class=anchor aria-hidden=true href=#메인프레임-시대와-계층형-사고의-출현-1950-년대1970-년대>#</a></h4><p><strong>초기 컴퓨팅 환경의 특징</strong></p><ul><li><strong>메인프레임 중심의 컴퓨팅</strong>:<ul><li><strong>IBM System/360 (1964)</strong>: 최초의 계층적 시스템 구조 도입</li><li><strong>배치 처리 시스템</strong>: 펀치카드와 자기 테이프를 통한 입력 처리</li><li><strong>중앙집중식 아키텍처</strong>: 모든 처리가 메인프레임에서 수행</li><li><strong>터미널 시스템</strong>: 더미 터미널을 통한 사용자 인터페이스</li></ul></li></ul><blockquote><p>메인프레임 중심의 컴퓨팅 (Mainframe-Centric Computing)<br>메인프레임 (Mainframe) 은 대량의 데이터 처리, 고가용성, 보안성, 안정성이 요구되는 기업 또는 기관의 핵심 업무 시스템을 수행하기 위해 설계된 <strong>대형 중앙 집중식 컴퓨터 시스템</strong>이다. <strong>메인프레임 중심 컴퓨팅</strong>은 이러한 메인프레임을 <strong>업무 처리의 핵심 허브로 삼아 모든 처리를 중앙화된 방식으로 수행하는 컴퓨팅 모델</strong>이다.</p></blockquote><p><strong>1950 년대 초기 컴퓨터 시스템의 문제점</strong>:</p><ul><li><strong>하드웨어 직접 제어</strong>: 프로그래머가 CPU 명령어, 메모리 주소, I/O 포트를 직접 다뤄야 함</li><li><strong>중복 개발</strong>: 모든 프로그램이 기본적인 I/O 처리를 반복 구현</li><li><strong>하드웨어 의존성</strong>: 다른 컴퓨터로 프로그램 이식 시 전체 재작성 필요</li><li><strong>복잡성 폭발</strong>: 시스템이 커질수록 관리 불가능한 복잡도</li></ul><p><strong>계층화를 통한 문제 해결</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────┐  ← 문제 해결: 사용자가 복잡한 명령어 외울 필요 없음
</span></span><span class=line><span class=cl>│  User Terminal  │    → 표준화된 명령어 인터페이스 제공
</span></span><span class=line><span class=cl>├─────────────────┤
</span></span><span class=line><span class=cl>│  Job Control    │  ← 문제 해결: 작업 스케줄링과 자원 관리 자동화
</span></span><span class=line><span class=cl>│                 │    → 배치 작업 순서, 우선순위, 자원 할당 관리
</span></span><span class=line><span class=cl>├─────────────────┤
</span></span><span class=line><span class=cl>│  Application    │  ← 문제 해결: 비즈니스 로직과 시스템 로직 분리
</span></span><span class=line><span class=cl>│                 │    → 개발자는 하드웨어 걱정 없이 애플리케이션 로직에 집중
</span></span><span class=line><span class=cl>├─────────────────┤
</span></span><span class=line><span class=cl>│  Operating Sys  │  ← 문제 해결: 하드웨어 추상화 및 공통 서비스 제공
</span></span><span class=line><span class=cl>│                 │    → 파일 시스템, 메모리 관리, 프로세스 관리 표준화
</span></span><span class=line><span class=cl>├─────────────────┤
</span></span><span class=line><span class=cl>│  Hardware       │  ← 문제 해결: 물리적 자원의 직접 접근 차단
</span></span><span class=line><span class=cl>└─────────────────┘    → 안전하고 효율적인 하드웨어 사용
</span></span></code></pre></td></tr></table></div></div><ol><li><strong>추상화 (Abstraction)</strong>:<br>계층화 도입 이전에는 프로그래머가 직접 하드웨어 명령어를 작성지만 이후에는 프로그래머는 운영체제 함수만 작성하면 운영체제가 하드웨어 명령어로 반환이 가능하다.</li><li><strong>관심사의 분리 (Separation of Concerns)</strong>:<br>각 계층마다 전문적으로 담당하는 영역이 다르다.</li><li>재사용성과 이식성:<br>하드웨어 변경시, 계층화 이전에는 전체를 재작성해야 했지만 이후에는 하드웨어 추상화 계층만 수정하면 된다.</li></ol><p><strong>현대 소프트웨어 계층화의 뿌리</strong>: 메인프레임 계층화 → 현대 아키텍처 연결</p><pre class=mermaid>graph TD
    subgraph &#34;1960s 메인프레임&#34;
        A1[User Terminal]
        A2[Job Control]
        A3[Application]
        A4[Operating System]
        A5[Hardware]
    end
    
    subgraph &#34;현대 웹 애플리케이션&#34;
        B1[Web Browser]
        B2[Web Server]
        B3[Application Server]
        B4[Database Server]
        B5[Infrastructure]
    end
    
    A1 -.-&gt;|진화| B1
    A2 -.-&gt;|진화| B2
    A3 -.-&gt;|진화| B3
    A4 -.-&gt;|진화| B4
    A5 -.-&gt;|진화| B5
</pre><h4 id=전통적-layered-architecture-의-확립-1980-년대1990-년대>전통적 Layered Architecture 의 확립 (1980 년대~1990 년대)<a hidden class=anchor aria-hidden=true href=#전통적-layered-architecture-의-확립-1980-년대1990-년대>#</a></h4><h5 id=클라이언트---서버-모델의-등장>클라이언트 - 서버 모델의 등장<a hidden class=anchor aria-hidden=true href=#클라이언트---서버-모델의-등장>#</a></h5><p><strong>2-Tier Architecture (1980 년대)</strong>:</p><ul><li><strong>PC 의 보급</strong>: 개인용 컴퓨터가 더미 터미널을 대체</li><li><strong>분산 처리</strong>: 처리 능력이 클라이언트와 서버로 분산</li><li><strong>네트워크 컴퓨팅</strong>: LAN 기술의 발전으로 가능해진 분산 아키텍처</li></ul><p><strong>기술적 동력</strong>:</p><ul><li><strong>관계형 데이터베이스</strong>: Oracle, IBM DB2, SQL Server 등의 상용화</li><li><strong>네트워킹 기술</strong>: TCP/IP 프로토콜 표준화</li><li><strong>GUI 기술</strong>: Windows, Mac OS 의 그래픽 사용자 인터페이스</li></ul><h5 id=3-tier-architecture-의-표준화-1990-년대>3-Tier Architecture 의 표준화 (1990 년대)<a hidden class=anchor aria-hidden=true href=#3-tier-architecture-의-표준화-1990-년대>#</a></h5><p><strong>웹 기술의 영향</strong>:</p><ul><li><strong>World Wide Web (1991)</strong>: 브라우저 - 웹서버 - 데이터베이스 구조</li><li><strong>HTTP 프로토콜</strong>: 무상태 (stateless) 통신 방식</li><li><strong>인터넷 확산</strong>: 전 세계적인 네트워크 연결</li></ul><p><strong>표준 3 계층 구조</strong>:</p><pre class=mermaid>graph TD
    A[Presentation Layer&lt;br/&gt;웹 브라우저, GUI] --&gt; B[Application Layer&lt;br/&gt;웹 서버, 비즈니스 로직]
    B --&gt; C[Data Layer&lt;br/&gt;데이터베이스, 파일 시스템]
    
    A1[사용자 인터페이스] --&gt; B1[비즈니스 규칙 처리]
    B1 --&gt; C1[데이터 저장 및 관리]
</pre><h5 id=엔터프라이즈-표준의-확립-2000-년대-초기>엔터프라이즈 표준의 확립 (2000 년대 초기)<a hidden class=anchor aria-hidden=true href=#엔터프라이즈-표준의-확립-2000-년대-초기>#</a></h5><p><strong>J2EE (Java 2 Platform, Enterprise Edition) 영향</strong>:</p><ul><li><strong>컨테이너 기반</strong>: EJB 컨테이너, 서블릿 컨테이너</li><li><strong>선언적 서비스</strong>: 트랜잭션, 보안, 네이밍 서비스</li><li><strong>표준화</strong>: 업계 전반의 아키텍처 표준 확립</li></ul><p><strong>.NET Framework 의 기여</strong>:</p><ul><li><strong>ASP.NET</strong>: 웹 애플리케이션 개발 표준화</li><li><strong>Windows DNA</strong>: Distributed interNet Architecture</li><li><strong>COM+</strong>: 컴포넌트 기반 서비스</li></ul><h4 id=전통적-아키텍처의-한계와-문제점-인식-2000-년대>전통적 아키텍처의 한계와 문제점 인식 (2000 년대)<a hidden class=anchor aria-hidden=true href=#전통적-아키텍처의-한계와-문제점-인식-2000-년대>#</a></h4><h5 id=구조적-문제점들>구조적 문제점들<a hidden class=anchor aria-hidden=true href=#구조적-문제점들>#</a></h5><p><strong>긴밀한 결합 (Tight Coupling)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 긴밀한 결합의 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderService</span><span class=w> </span><span class=p>{</span><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>MySQLOrderDAO</span><span class=w> </span><span class=n>orderDAO</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>MySQLOrderDAO</span><span class=p>();</span><span class=w> </span><span class=c1>// 구체 클래스에 직접 의존</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>createOrder</span><span class=p>(</span><span class=n>Order</span><span class=w> </span><span class=n>order</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// MySQL 특정 로직에 의존</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>orderDAO</span><span class=p>.</span><span class=na>saveWithTransaction</span><span class=p>(</span><span class=n>order</span><span class=p>);</span><span class=w> </span><span class=c1>// MySQL 트랜잭션 방식에 종속</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 문제: MySQL → PostgreSQL 변경 시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// OrderService까지 수정해야 함 (의존성 전파)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>주요 문제점들</strong>:</p><ul><li><strong>의존성 전파</strong>: 하위 계층 변경이 상위 계층에 영향<ul><li><code>Database Schema 변경 → DAO 변경 → Service 변경 → Controller 변경 → View 변경</code></li></ul></li><li><strong>테스트 어려움</strong>: 데이터베이스 없이 비즈니스 로직 테스트 불가<ul><li>테스트를 위해 실제 DB 설정, 테스트 데이터 준비 등이 필요</li></ul></li><li><strong>기술 종속성</strong>: 특정 데이터베이스나 프레임워크에 강하게 결합</li><li><strong>단일 책임 원칙 위반</strong>: 계층이 여러 책임을 동시에 가짐</li></ul><h5 id=비즈니스-요구사항의-변화>비즈니스 요구사항의 변화<a hidden class=anchor aria-hidden=true href=#비즈니스-요구사항의-변화>#</a></h5><p><strong>복잡성 증가</strong>:</p><ul><li><strong>비즈니스 로직 복잡화</strong>: 단순 CRUD 를 넘어선 복잡한 업무 규칙</li><li><strong>다중 채널</strong>: 웹, 모바일, API 등 다양한 인터페이스 요구</li><li><strong>실시간 처리</strong>: 배치 처리에서 실시간 처리로 변화</li><li><strong>확장성 요구</strong>: 대용량 트래픽과 데이터 처리 필요</li></ul><h4 id=domain-driven-design-의-등장과-패러다임-전환-2003-년>Domain-Driven Design 의 등장과 패러다임 전환 (2003 년)<a hidden class=anchor aria-hidden=true href=#domain-driven-design-의-등장과-패러다임-전환-2003-년>#</a></h4><h5 id=eric-evans-의-혁신적-접근>Eric Evans 의 혁신적 접근<a hidden class=anchor aria-hidden=true href=#eric-evans-의-혁신적-접근>#</a></h5><p><strong>DDD 의 핵심 통찰</strong>:</p><blockquote><p>" 소프트웨어의 핵심은 사용자를 위해 도메인 관련 문제를 해결하는 능력이다. 다른 모든 것들은 부차적이다."</p></blockquote><p><strong>전통적 접근법과의 차이점</strong>:</p><table><thead><tr><th>구분</th><th>전통적 접근법</th><th>DDD 접근법</th></tr></thead><tbody><tr><td>중심 요소</td><td>데이터베이스, 기술 스택</td><td>비즈니스 도메인</td></tr><tr><td>설계 출발점</td><td>데이터 모델링</td><td>도메인 모델링</td></tr><tr><td>의존성 방향</td><td>상위 → 하위 (UI → DB)</td><td>외부 → 내부 (Infrastructure → Domain)</td></tr><tr><td>언어</td><td>기술적 용어 중심</td><td>유비쿼터스 언어</td></tr></tbody></table><p><strong>4 계층 구조 제안</strong>:</p><pre class=mermaid>graph TD
    subgraph &#34;DDD 4-Layer Architecture&#34;
        A[User Interface Layer&lt;br/&gt;사용자 인터페이스]
        B[Application Layer&lt;br/&gt;애플리케이션 서비스]
        C[Domain Layer&lt;br/&gt;도메인 모델, 비즈니스 로직]
        D[Infrastructure Layer&lt;br/&gt;데이터 접근, 외부 서비스]
    end
    
    A --&gt; B
    B --&gt; C
    D -.-&gt; C
    D -.-&gt; B
    D -.-&gt; A
</pre><ul><li><strong>기본 원칙</strong>:<ul><li><strong>의존성 규칙</strong>: 각 계층은 자신보다 아래 계층에만 의존 가능</li><li><strong>Domain Layer 격리</strong>: 도메인 계층은 완전히 격리되어 다른 계층에 의존하지 않음</li><li><strong>Infrastructure Layer 특성</strong>: 모든 계층을 지원하되, 계층들이 Infrastructure 에 의존하지 않도록 역전된 의존성 적용</li></ul></li><li><strong>핵심 설계 원칙</strong><ol><li><strong>Domain Layer 보호</strong>: 가장 중요한 비즈니스 로직이 외부 변화로부터 격리</li><li><strong>의존성 역전</strong>: Infrastructure 가 Domain 인터페이스를 구현</li><li><strong>관심사의 분리</strong>: 각 계층이 명확한 단일 책임을 가짐</li><li><strong>테스트 용이성</strong>: 각 계층을 독립적으로 테스트 가능</li></ol></li></ul><p>이 4 계층 구조는 전통적인 3 계층 구조의 문제점 (비즈니스 로직 분산, 기술 종속성) 을 해결하고, 도메인 중심의 설계를 가능하게 하는 Eric Evans 의 핵심 기여이다.</p><p><strong>계층 간 통신 흐름</strong>:</p><pre class=mermaid>sequenceDiagram
    participant UI as User Interface
    participant App as Application
    participant Dom as Domain
    participant Infra as Infrastructure

    UI-&gt;&gt;App: createOrder(request)
    App-&gt;&gt;Dom: Customer.placeOrder(items)
    Dom-&gt;&gt;Dom: validate business rules
    Dom--&gt;&gt;App: return Order
    App-&gt;&gt;Infra: orderRepository.save(order)
    Infra--&gt;&gt;App: success
    App-&gt;&gt;Infra: eventPublisher.publish(event)
    App--&gt;&gt;UI: return OrderDto
</pre><p><strong>계층별 정리</strong>:</p><table><thead><tr><th>계층</th><th>핵심 기능</th><th>주요 역할</th><th>포함 요소</th><th>의존성</th><th>주의사항</th></tr></thead><tbody><tr><td><strong>User Interface Layer</strong><br>(사용자 인터페이스 계층)</td><td>• 사용자와의 상호작용<br>• 데이터 표시 및 명령 수집<br>• 사용자 명령 해석</td><td>• 사용자 요청 수신<br>• 응답 데이터 렌더링<br>• 입력 검증 (기본적)<br>• 세션 관리</td><td>• 웹 컨트롤러<br>• REST API 엔드포인트<br>• 웹 페이지/템플릿<br>• 모바일 앱 화면<br>• CLI 인터페이스</td><td>Application Layer 에만 의존</td><td>• 비즈니스 로직 포함 금지<br>• 도메인 객체 직접 노출 금지<br>• DTO 사용 권장</td></tr><tr><td><strong>Application Layer</strong><br>(애플리케이션 계층)</td><td>• 유스케이스 조정<br>• 워크플로우 관리<br>• 도메인 객체 협업 조정</td><td>• 비즈니스 프로세스 오케스트레이션<br>• 트랜잭션 관리<br>• 보안 및 권한 검사<br>• 외부 시스템 통합</td><td>• Application Service<br>• Use Case 구현체<br>• Command/Query Handler<br>• DTO (Data Transfer Object)<br>• Application Event</td><td>Domain Layer 에만 의존</td><td>• 비즈니스 규칙 구현 금지<br>• 얇은 (Thin) 계층 유지<br>• 상태를 가지지 않음 (Stateless)</td></tr><tr><td><strong>Domain Layer</strong><br>(도메인 계층)</td><td>• 핵심 비즈니스 로직<br>• 도메인 규칙 구현<br>• 비즈니스 상태 관리</td><td>• 비즈니스 규칙 강제<br>• 도메인 지식 캡슐화<br>• 불변성 보장<br>• 비즈니스 이벤트 발생</td><td>• Entity (엔티티)<br>• Value Object (값 객체)<br>• Aggregate (애그리게이트)<br>• Domain Service<br>• Domain Event<br>• Repository Interface</td><td>다른 계층에 의존하지 않음<br>(완전 격리)</td><td>• 기술적 세부사항 배제<br>• 퍼시스턴스 무시 (Persistence Ignorance)<br>• 인프라 무시 (Infrastructure Ignorance)<br>• 유비쿼터스 언어 사용</td></tr><tr><td><strong>Infrastructure Layer</strong><br>(인프라스트럭처 계층)</td><td>• 기술적 서비스 제공<br>• 외부 시스템 연동<br>• 데이터 영속성</td><td>• 데이터베이스 접근<br>• 외부 API 통신<br>• 메시징/이벤트 처리<br>• 파일 시스템 접근<br>• 네트워크 통신</td><td>• Repository 구현체<br>• Database 설정<br>• External API Client<br>• Message Queue<br>• Email Service<br>• Cache Provider</td><td>모든 계층을 지원하되<br>역전된 의존성 적용</td><td>• 도메인 인터페이스 구현<br>• 구체적 기술에 특화<br>• 교체 가능하도록 설계</td></tr></tbody></table><h5 id=아키텍처-철학의-변화>아키텍처 철학의 변화<a hidden class=anchor aria-hidden=true href=#아키텍처-철학의-변화>#</a></h5><p><strong>도메인 중심 사고</strong>:</p><ul><li><strong>비즈니스 가치 우선</strong>: 기술보다 비즈니스 문제 해결에 집중</li><li><strong>도메인 전문가와의 협업</strong>: 개발자와 비즈니스 사이의 언어 통일</li><li><strong>점진적 학습</strong>: 도메인 이해가 깊어질수록 모델을 개선</li></ul><h4 id=service-oriented-architecture-soa-의-발전-2000-년대-중반>Service-Oriented Architecture (SOA) 의 발전 (2000 년대 중반)<a hidden class=anchor aria-hidden=true href=#service-oriented-architecture-soa-의-발전-2000-년대-중반>#</a></h4><h5 id=soa-의-등장-배경>SOA 의 등장 배경<a hidden class=anchor aria-hidden=true href=#soa-의-등장-배경>#</a></h5><p><strong>기업 환경의 변화</strong>:</p><ul><li><strong>레거시 시스템 통합</strong>: 다양한 시스템들의 상호 운용성 필요</li><li><strong>비즈니스 민첩성</strong>: 빠른 비즈니스 변화에 대응</li><li><strong>재사용성 요구</strong>: 중복 개발 비용 절감</li></ul><p><strong>SOA 핵심 원칙</strong>:</p><ol><li><p>서비스 지향 (Service Orientation)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>비즈니스 기능을 독립적인 서비스로 분리
</span></span><span class=line><span class=cl>예: 고객 관리, 주문 처리, 결제 처리를 각각 별도 서비스로
</span></span></code></pre></td></tr></table></div></div></li><li><p>느슨한 결합 (Loose Coupling)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>서비스 간 최소한의 의존성으로 독립성 확보
</span></span><span class=line><span class=cl>예: 주문 서비스가 고객 서비스의 내부 구현을 알 필요 없음
</span></span></code></pre></td></tr></table></div></div></li><li><p>서비스 재사용성 (Service Reusability)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>한번 만든 서비스를 여러 애플리케이션에서 재사용
</span></span><span class=line><span class=cl>예: 고객 정보 서비스를 웹사이트, 모바일앱, 콜센터에서 공통 사용
</span></span></code></pre></td></tr></table></div></div></li><li><p>서비스 계약 (Service Contract)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>명확한 인터페이스 정의로 서비스 사용 방법 표준화
</span></span><span class=line><span class=cl>예: WSDL을 통한 서비스 명세서 제공
</span></span></code></pre></td></tr></table></div></div></li><li><p>서비스 추상화 (Service Abstraction)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1>1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>서비스 내부 구현 숨기고 인터페이스만 노출
</span></span><span class=line><span class=cl>예: 데이터베이스 변경되어도 서비스 인터페이스는 동일
</span></span></code></pre></td></tr></table></div></div></li><li><p>서비스 조합성 (Service Composability)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1>1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>여러 서비스를 조합하여 복잡한 비즈니스 프로세스 구현
</span></span><span class=line><span class=cl>예: 주문 = 고객 조회 + 재고 확인 + 결제 처리 + 배송 요청
</span></span></code></pre></td></tr></table></div></div></li></ol><h5 id=esb-enterprise-service-bus-의-도입>ESB (Enterprise Service Bus) 의 도입<a hidden class=anchor aria-hidden=true href=#esb-enterprise-service-bus-의-도입>#</a></h5><p><strong>중앙집중식 통합</strong>:</p><ul><li><strong>메시지 라우팅</strong>: 서비스 간 통신 중재</li><li><strong>프로토콜 변환</strong>: 다양한 통신 프로토콜 지원</li><li><strong>서비스 검색</strong>: 동적 서비스 발견 및 바인딩</li></ul><p><strong>SOA 의 한계</strong>:</p><ul><li><strong>복잡성 증가</strong>: ESB 가 단일 장애점 (SPOF) 이 됨</li><li><strong>성능 오버헤드</strong>: 중앙 집중식 처리로 인한 지연</li><li><strong>거버넌스 어려움</strong>: 서비스 간 의존성 관리 복잡</li></ul><h4 id=현대적-아키텍처-패턴의-등장-2005-년2012-년>현대적 아키텍처 패턴의 등장 (2005 년~2012 년)<a hidden class=anchor aria-hidden=true href=#현대적-아키텍처-패턴의-등장-2005-년2012-년>#</a></h4><h5 id=hexagonal-architecture-2005-년>Hexagonal Architecture (2005 년)<a hidden class=anchor aria-hidden=true href=#hexagonal-architecture-2005-년>#</a></h5><p><strong>Alistair Cockburn 의 혁신</strong>:</p><ul><li><strong>포트와 어댑터</strong>: 외부 세계와의 인터페이스 추상화</li><li><strong>비즈니스 로직 격리</strong>: 핵심 로직을 외부 의존성으로부터 분리</li><li><strong>테스트 용이성</strong>: 실제 외부 시스템 없이도 테스트 가능</li></ul><pre class=mermaid>graph TD
    subgraph &#34;Hexagonal Architecture&#34;
        subgraph &#34;Adapters (외부)&#34;
            A1[Web UI]
            A2[REST API]
            A3[Database]
            A4[Message Queue]
        end
        
        subgraph &#34;Ports (인터페이스)&#34;
            P1[Inbound Ports]
            P2[Outbound Ports]
        end
        
        subgraph &#34;Core (비즈니스 로직)&#34;
            C[Domain Logic]
        end
        
        A1 --&gt; P1
        A2 --&gt; P1
        P1 --&gt; C
        C --&gt; P2
        P2 --&gt; A3
        P2 --&gt; A4
    end
</pre><h5 id=onion-architecture-2008-년>Onion Architecture (2008 년)<a hidden class=anchor aria-hidden=true href=#onion-architecture-2008-년>#</a></h5><p><strong>Jeffrey Palermo 의 기여</strong>:</p><ul><li><strong>동심원 구조</strong>: 의존성이 중심을 향해 흐름</li><li><strong>계층의 명확한 정의</strong>: 각 계층의 역할과 책임 명시</li><li><strong>인프라스트럭처 분리</strong>: 외부 관심사를 가장 바깥 계층으로</li></ul><h5 id=clean-architecture-2012-년>Clean Architecture (2012 년)<a hidden class=anchor aria-hidden=true href=#clean-architecture-2012-년>#</a></h5><p><strong>Robert Martin (Uncle Bob) 의 통합</strong>:</p><ul><li><strong>의존성 규칙</strong>: " 소스 코드 의존성은 안쪽으로만 향해야 한다 "</li><li><strong>경계의 명확화</strong>: 각 계층 간 명확한 경계와 계약 정의</li><li><strong>플러그인 아키텍처</strong>: 프레임워크와 도구를 플러그인으로 취급</li></ul><pre class=mermaid>graph TD
    subgraph &#34;Clean Architecture&#34;
        subgraph &#34;Frameworks &amp; Drivers&#34;
            F1[Web Frameworks]
            F2[Database]
            F3[External Interfaces]
        end
        
        subgraph &#34;Interface Adapters&#34;
            I1[Controllers]
            I2[Gateways]
            I3[Presenters]
        end
        
        subgraph &#34;Application Business Rules&#34;
            A[Use Cases]
        end
        
        subgraph &#34;Enterprise Business Rules&#34;
            E[Entities]
        end
        
        F1 --&gt; I1
        F2 --&gt; I2
        F3 --&gt; I3
        I1 --&gt; A
        I2 --&gt; A
        I3 --&gt; A
        A --&gt; E
    end
</pre><h4 id=마이크로서비스-아키텍처의-부상-2010-년대>마이크로서비스 아키텍처의 부상 (2010 년대)<a hidden class=anchor aria-hidden=true href=#마이크로서비스-아키텍처의-부상-2010-년대>#</a></h4><h5 id=클라우드-컴퓨팅의-영향>클라우드 컴퓨팅의 영향<a hidden class=anchor aria-hidden=true href=#클라우드-컴퓨팅의-영향>#</a></h5><p><strong>기술적 기반</strong>:</p><ul><li><strong>컨테이너화</strong>: Docker (2013), Kubernetes (2014)</li><li><strong>클라우드 플랫폼</strong>: AWS, Azure, Google Cloud Platform</li><li><strong>DevOps 문화</strong>: 지속적 통합/배포 (CI/CD)</li></ul><h5 id=msa-의-핵심-특징>MSA 의 핵심 특징<a hidden class=anchor aria-hidden=true href=#msa-의-핵심-특징>#</a></h5><table><thead><tr><th>항목</th><th>세부 특징</th><th>주요 목적</th></tr></thead><tbody><tr><td><strong>서비스 자율성 (Service Autonomy)</strong></td><td>- 독립적 개발, 배포, 확장<br>- 팀 단위 책임 분리</td><td>민첩성, 빠른 릴리스, 팀 생산성</td></tr><tr><td><strong>비즈니스 중심 분해 (Business Capability Focused)</strong></td><td>- 도메인 중심 설계<br>- 바운디드 컨텍스트 기반 경계 설정<br>- 단일 책임 원칙 적용</td><td>도메인 응집성, 유지보수성, 변화 대응력</td></tr><tr><td><strong>분산 데이터 관리 (Decentralized Data Management)</strong></td><td>- 서비스별 DB 소유<br>- 폴리글랏 퍼시스턴스<br>- 이벤트 기반 최종 일관성</td><td>독립성, 확장성, 데이터 주권</td></tr><tr><td><strong>기술 다양성 (Technology Diversity)</strong></td><td>- 언어 및 프레임워크 자유<br>- 각 서비스별 최적화된 스택 선택 가능</td><td>기술 진화 대응, 유연한 선택</td></tr><tr><td><strong>느슨한 결합 (Loose Coupling)</strong></td><td>- API 기반 통신<br>- 구현 은닉<br>- 서비스 간 의존성 최소화</td><td>변경 유연성, 인터페이스 안정성</td></tr><tr><td><strong>장애 격리 및 복원력 (Fault Isolation & Resilience)</strong></td><td>- 장애 격리, 회로 차단기, 중복 인스턴스<br>- 빠른 장애 복구</td><td>시스템 전체 안정성, 가용성 유지</td></tr><tr><td><strong>API 우선 설계 (API-First Design)</strong></td><td>- 계약 기반 설계<br>- REST/gRPC 등 표준 프로토콜<br>- API 게이트웨이 연동</td><td>개발 병렬화, 외부 연동 일관성</td></tr><tr><td><strong>클라우드 네이티브 특성 (Cloud-Native)</strong></td><td>- 컨테이너화, 오케스트레이션, 무상태성, 임시성</td><td>유연한 배포, 수평 확장성, 클라우드 최적화</td></tr><tr><td><strong>분산 거버넌스 (Decentralized Governance)</strong></td><td>- 팀 주도 기술 선택<br>- 최소한의 중앙 표준<br>- DevOps 문화 및 CI/CD</td><td>유연한 조직 운영, 책임 중심 운영</td></tr><tr><td><strong>관찰가능성 (Observability)</strong></td><td>- 분산 추적, 중앙 로그, 메트릭 수집, 헬스체크</td><td>문제 탐지, 성능 분석, 운영 효율성</td></tr></tbody></table><p><strong>SOA 와의 차이점</strong>:</p><table><thead><tr><th>특성</th><th>SOA</th><th>MSA</th></tr></thead><tbody><tr><td>서비스 크기</td><td>큰 비즈니스 기능 단위</td><td>작은 단일 책임 단위</td></tr><tr><td>데이터 관리</td><td>공유 데이터베이스</td><td>서비스별 독립 데이터베이스</td></tr><tr><td>통신 방식</td><td>ESB, SOAP</td><td>HTTP/REST, 메시징</td></tr><tr><td>배포 방식</td><td>모노리틱 배포</td><td>독립적 배포</td></tr><tr><td>거버넌스</td><td>중앙집중식</td><td>분산형</td></tr></tbody></table><h4 id=현대적-계층형-아키텍처의-특징-2010-년대현재>현대적 계층형 아키텍처의 특징 (2010 년대~현재)<a hidden class=anchor aria-hidden=true href=#현대적-계층형-아키텍처의-특징-2010-년대현재>#</a></h4><h5 id=의존성-역전-원칙-dip-적용>의존성 역전 원칙 (DIP) 적용<a hidden class=anchor aria-hidden=true href=#의존성-역전-원칙-dip-적용>#</a></h5><p><strong>전통적 방식 vs 현대적 방식</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1> 1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2> 2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3> 3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4> 4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5> 5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6> 6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7> 7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8> 8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9> 9</a>
</span><span class=lnt id=hl-14-10><a class=lnlinks href=#hl-14-10>10</a>
</span><span class=lnt id=hl-14-11><a class=lnlinks href=#hl-14-11>11</a>
</span><span class=lnt id=hl-14-12><a class=lnlinks href=#hl-14-12>12</a>
</span><span class=lnt id=hl-14-13><a class=lnlinks href=#hl-14-13>13</a>
</span><span class=lnt id=hl-14-14><a class=lnlinks href=#hl-14-14>14</a>
</span><span class=lnt id=hl-14-15><a class=lnlinks href=#hl-14-15>15</a>
</span><span class=lnt id=hl-14-16><a class=lnlinks href=#hl-14-16>16</a>
</span><span class=lnt id=hl-14-17><a class=lnlinks href=#hl-14-17>17</a>
</span><span class=lnt id=hl-14-18><a class=lnlinks href=#hl-14-18>18</a>
</span><span class=lnt id=hl-14-19><a class=lnlinks href=#hl-14-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 전통적 방식 (문제가 있는 코드)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db</span> <span class=o>=</span> <span class=n>MySQLDatabase</span><span class=p>()</span>  <span class=c1># 구체 클래스에 의존</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>email</span> <span class=o>=</span> <span class=n>SMTPEmailService</span><span class=p>()</span>  <span class=c1># 구체 클래스에 의존</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_order</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>order</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>email</span><span class=o>.</span><span class=n>send_confirmation</span><span class=p>(</span><span class=n>order</span><span class=o>.</span><span class=n>customer_email</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 현대적 방식 (의존성 역전 적용)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>repository</span><span class=p>:</span> <span class=n>OrderRepository</span><span class=p>,</span> <span class=n>email_service</span><span class=p>:</span> <span class=n>EmailService</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>repository</span> <span class=o>=</span> <span class=n>repository</span>  <span class=c1># 추상화에 의존</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>email_service</span> <span class=o>=</span> <span class=n>email_service</span>  <span class=c1># 추상화에 의존</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_order</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>repository</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>order</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>email_service</span><span class=o>.</span><span class=n>send_confirmation</span><span class=p>(</span><span class=n>order</span><span class=o>.</span><span class=n>customer_email</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=이벤트-기반-아키텍처-통합>이벤트 기반 아키텍처 통합<a hidden class=anchor aria-hidden=true href=#이벤트-기반-아키텍처-통합>#</a></h5><p><strong>비동기 처리와 이벤트 소싱</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1> 1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2> 2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3> 3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4> 4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5> 5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6> 6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7> 7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8> 8</a>
</span><span class=lnt id=hl-15-9><a class=lnlinks href=#hl-15-9> 9</a>
</span><span class=lnt id=hl-15-10><a class=lnlinks href=#hl-15-10>10</a>
</span><span class=lnt id=hl-15-11><a class=lnlinks href=#hl-15-11>11</a>
</span><span class=lnt id=hl-15-12><a class=lnlinks href=#hl-15-12>12</a>
</span><span class=lnt id=hl-15-13><a class=lnlinks href=#hl-15-13>13</a>
</span><span class=lnt id=hl-15-14><a class=lnlinks href=#hl-15-14>14</a>
</span><span class=lnt id=hl-15-15><a class=lnlinks href=#hl-15-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 현대적 이벤트 기반 처리</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_publisher</span><span class=p>:</span> <span class=n>EventPublisher</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_publisher</span> <span class=o>=</span> <span class=n>event_publisher</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_order</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 도메인 이벤트 발생</span>
</span></span><span class=line><span class=cl>        <span class=n>event</span> <span class=o>=</span> <span class=n>OrderCreatedEvent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>order_id</span><span class=o>=</span><span class=n>order</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>customer_id</span><span class=o>=</span><span class=n>order</span><span class=o>.</span><span class=n>customer_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>amount</span><span class=o>=</span><span class=n>order</span><span class=o>.</span><span class=n>total_amount</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 이벤트 발행 (다른 서비스들이 비동기로 처리)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_publisher</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=클라우드-네이티브-특성>클라우드 네이티브 특성<a hidden class=anchor aria-hidden=true href=#클라우드-네이티브-특성>#</a></h5><p><strong>현대적 배포와 확장</strong>:</p><ul><li><strong>컨테이너 오케스트레이션</strong>: Kubernetes 기반 자동 확장</li><li><strong>서비스 메시</strong>: Istio, Linkerd 를 통한 서비스 간 통신 관리</li><li><strong>관찰가능성</strong>: 분산 추적, 메트릭, 로깅 통합</li><li><strong>복원력</strong>: Circuit Breaker, Bulkhead 패턴 적용</li></ul><h4 id=진화의-핵심-동력과-개선사항>진화의 핵심 동력과 개선사항<a hidden class=anchor aria-hidden=true href=#진화의-핵심-동력과-개선사항>#</a></h4><h5 id=기술적-동력>기술적 동력<a hidden class=anchor aria-hidden=true href=#기술적-동력>#</a></h5><p><strong>1960 년대 → 현재까지의 기술 발전</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1>1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2>2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>메인프레임 → 클라이언트-서버 →   웹   → SOA     → 클라우드 → 마이크로서비스
</span></span><span class=line><span class=cl>     ↓            ↓           ↓      ↓           ↓           ↓
</span></span><span class=line><span class=cl>배치처리   →   대화형처리   →  HTTP → XML/SOAP →  REST   →   컨테이너
</span></span></code></pre></td></tr></table></div></div><h5 id=주요-개선사항>주요 개선사항<a hidden class=anchor aria-hidden=true href=#주요-개선사항>#</a></h5><p><strong>전통적 → 현대적 전환</strong>:</p><table><thead><tr><th>측면</th><th>전통적 접근법</th><th>현대적 접근법</th><th>개선 효과</th></tr></thead><tbody><tr><td><strong>중심 요소</strong></td><td>데이터베이스 중심</td><td>도메인 중심</td><td>비즈니스 가치 극대화</td></tr><tr><td><strong>의존성</strong></td><td>하향식 (UI→DB)</td><td>상향식 (외부→도메인)</td><td>변경 영향도 최소화</td></tr><tr><td><strong>결합도</strong></td><td>긴밀한 결합</td><td>느슨한 결합</td><td>유연성 및 테스트 용이성</td></tr><tr><td><strong>배포</strong></td><td>모노리틱 배포</td><td>독립적 배포</td><td>빠른 출시 및 확장성</td></tr><tr><td><strong>테스트</strong></td><td>통합 테스트 의존</td><td>단위 테스트 중심</td><td>개발 생산성 향상</td></tr><tr><td><strong>확장</strong></td><td>수직적 확장</td><td>수평적 확장</td><td>비용 효율성</td></tr></tbody></table><h5 id=미래-방향성>미래 방향성<a hidden class=anchor aria-hidden=true href=#미래-방향성>#</a></h5><p><strong>2020 년대 이후 트렌드</strong>:</p><ul><li><p><strong>서버리스 아키텍처 (Serverless Architecture) 와 계층 구조의 융합</strong><br>서버리스 컴퓨팅 (Serverless Computing) 기반 환경에서는 계층형 아키텍처의 일부 계층 (예: 프리젠테이션, 비즈니스 로직 계층 등) 을 함수 (Function) 단위로 더 유연하게 분리하고 확장함. 이로 인해 기존 계층 구조의 고정성과 배포 단위를 혁신적으로 변화시키며, 이벤트 중심 처리도 손쉽게 확장할 수 있게 됨.</p></li><li><p><strong>멀티테넌트 (Multi-Tenant) 환경에 최적화된 계층 설계</strong><br>SaaS(Software as a Service) 서비스 등 멀티테넌시 (Multi-Tenancy) 가 필요한 시스템에서는 데이터 액세스 계층과 도메인 계층에 개별 테넌트 분리를 적용하여 확장성과 보안성을 강화함.</p></li><li><p><strong>AI 자동화 연계</strong><br>계층별 AI 모듈 (예: 추천, 예측, 자동 모니터링) 이 삽입됨으로써, 특정 계층 (예: 서비스 계층, 프리젠테이션 계층) 에서 사용자의 행동 또는 상황에 적응하는 자동화 로직을 손쉽게 통합할 수 있음.</p></li><li><p><strong>유연한 계층 전환 및 조합</strong>:<br>시스템 요구에 따라 레이어의 수와 역할을 동적으로 조절할 수 있는 패턴과 도구의 필요성이 높아짐.</p></li><li><p><strong>자동화 도구 및 오케스트레이션 연계</strong>:<br>IaC(Infrastructure as Code, 코드 기반 인프라 자동화), 컨테이너 오케스트레이션 (Kubernetes 등) 과의 통합이 필수화.</p></li><li><p><strong>신속한 장애 복구 및 모니터링</strong>:<br>계층별 장애 감지 및 롤백 전략 (A/B 테스트, Canary 배포 등) 정교화 필요.</p></li></ul><h3 id=계층형-아키텍처와-다른-아키텍처-패턴과의-비교>계층형 아키텍처와 다른 아키텍처 패턴과의 비교<a hidden class=anchor aria-hidden=true href=#계층형-아키텍처와-다른-아키텍처-패턴과의-비교>#</a></h3><table><thead><tr><th>구분</th><th>계층형 (Layered)</th><th>육각형 (Hexagonal)</th><th>클린 (Clean)</th><th>마이크로서비스 (Microservices)</th></tr></thead><tbody><tr><td>구조</td><td>수직/단방향</td><td>입·출력 포트 중심</td><td>도메인 중심, 경계 명확</td><td>서비스 단위 독립</td></tr><tr><td>확장성</td><td>제한적</td><td>유연</td><td>매우 유연</td><td>극대화 가능</td></tr><tr><td>적용</td><td>단순, 전통적 시스템</td><td>복잡 도메인</td><td>대형 시스템, 변화 많은 환경</td><td>클라우드/대규모 시스템</td></tr><tr><td>대표 기술</td><td>웹서비스 초기, 비즈니스 App</td><td>복잡 API/이벤트 기반</td><td>모노리스 - 마이크로서비스 중간</td><td>SaaS, API 게이트웨이 등</td></tr></tbody></table><h3 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h3><p><strong>Layered Architecture 는 시스템의 복잡성을 기능적 책임에 따라 계층화함으로써 구조적 명확성과 유지보수성을 극대화하는 설계 전략이다.</strong> 하지만 시대적 변화와 비즈니스 요구사항의 진화에 따라 그 목적과 접근법이 크게 달라졌다.</p><h4 id=공통-목적>공통 목적<a hidden class=anchor aria-hidden=true href=#공통-목적>#</a></h4><table><thead><tr><th>목적</th><th>설명</th></tr></thead><tbody><tr><td><strong>복잡성 분해</strong></td><td>전체 시스템을 계층 또는 모듈 단위로 나누어 구조화된 설계 가능</td></tr><tr><td><strong>책임 분리</strong></td><td>역할에 따라 컴포넌트 구분 → 관심사 분리 (SoC, Separation of Concerns)</td></tr><tr><td><strong>유지보수성 향상</strong></td><td>기능별 변경이 국지적으로 이루어질 수 있도록 구성</td></tr><tr><td><strong>재사용성 확보</strong></td><td>특정 계층 (서비스, DAO 등) 은 다른 계층에서 반복적으로 활용 가능</td></tr><tr><td><strong>개발 효율화</strong></td><td>역할별 팀 분산 개발, 인터페이스 기반 협업 촉진</td></tr></tbody></table><h4 id=전통적-접근법의-목적-및-필요성-1990-년대2000-년대>전통적 접근법의 목적 및 필요성 (1990 년대~2000 년대)<a hidden class=anchor aria-hidden=true href=#전통적-접근법의-목적-및-필요성-1990-년대2000-년대>#</a></h4><p><strong>등장 배경</strong>:</p><ul><li><strong>클라이언트 - 서버 시대의 도래</strong>: 단일 머신 환경에서 분산 환경으로의 전환</li><li><strong>데이터베이스 중심 사고</strong>: RDBMS 의 보편화로 데이터 저장소가 시스템의 핵심으로 인식</li><li><strong>기술적 복잡성 관리</strong>: UI, 비즈니스 로직, 데이터 접근의 기술적 분리 필요성</li></ul><p><strong>핵심 목적</strong>:</p><table><thead><tr><th>목적 구분</th><th>설명</th><th>해결하는 문제</th></tr></thead><tbody><tr><td><strong>기술적 관심사 분리</strong></td><td>프레젠테이션, 비즈니스, 데이터 계층을 기술적 역할에 따라 분리</td><td>UI 코드와 비즈니스 로직, 데이터 접근 코드의 혼재</td></tr><tr><td><strong>재사용성 확보</strong></td><td>하위 계층 (특히 데이터 계층) 을 여러 상위 계층에서 공유</td><td>중복 코드 작성과 데이터 접근 로직의 분산</td></tr><tr><td><strong>유지보수성 향상</strong></td><td>계층별 독립적 수정을 통한 영향 범위 최소화</td><td>시스템 전체에 파급되는 변경 사항</td></tr><tr><td><strong>팀별 전문화</strong></td><td>프론트엔드, 백엔드, DBA 팀의 역할 분담</td><td>개발자들 간의 책임 영역 불분명</td></tr></tbody></table><p><strong>필요성의 한계</strong>:</p><ul><li><strong>데이터베이스 의존성</strong>: 비즈니스 로직이 데이터베이스 스키마에 강하게 결합</li><li><strong>하향식 의존성</strong>: 상위 계층 변경이 하위 계층까지 영향을 미치는 구조적 문제</li><li><strong>모놀리식 제약</strong>: 전체 시스템이 하나의 배포 단위로 관리되어 확장성 제한</li></ul><h4 id=현대적-접근법의-목적-및-필요성-2000-년대현재>현대적 접근법의 목적 및 필요성 (2000 년대~현재)<a hidden class=anchor aria-hidden=true href=#현대적-접근법의-목적-및-필요성-2000-년대현재>#</a></h4><p><strong>등장 배경</strong>:</p><ul><li><strong>비즈니스 복잡성 증가</strong>: 단순한 CRUD 를 넘어선 복잡한 도메인 로직 처리 필요</li><li><strong>클라우드 네이티브 환경</strong>: 마이크로서비스, 컨테이너화, DevOps 문화의 확산</li><li><strong>지속적 변화 대응</strong>: 애자일 개발과 빠른 비즈니스 요구사항 변화에 대한 대응</li><li><strong>테스트 중심 개발</strong>: TDD, BDD 등 테스트 가능한 아키텍처의 중요성 증대</li></ul><p><strong>핵심 목적</strong>:</p><table><thead><tr><th>목적 구분</th><th>설명</th><th>해결하는 문제</th></tr></thead><tbody><tr><td><strong>비즈니스 중심 설계</strong></td><td>도메인 로직을 아키텍처의 중심에 배치하여 비즈니스 가치 극대화</td><td>기술적 세부사항에 매몰된 비즈니스 로직</td></tr><tr><td><strong>의존성 역전</strong></td><td>외부 시스템 (DB, UI) 이 도메인에 의존하도록 하여 비즈니스 로직의 독립성 확보</td><td>인프라스트럭처 변경이 비즈니스 로직에 미치는 영향</td></tr><tr><td><strong>테스트 용이성</strong></td><td>도메인 로직을 외부 의존성 없이 독립적으로 테스트 가능</td><td>통합 테스트에만 의존하는 테스트 전략의 한계</td></tr><tr><td><strong>진화 가능성</strong></td><td>변화하는 비즈니스 요구사항에 대한 빠르고 안전한 대응</td><td>레거시 시스템의 경직성과 변경 비용</td></tr><tr><td><strong>기술적 독립성</strong></td><td>특정 프레임워크나 데이터베이스에 종속되지 않는 설계</td><td>기술 스택 변경 시 전체 시스템 재작성 필요</td></tr></tbody></table><p><strong>현대적 필요성</strong>:</p><table><thead><tr><th>필요성 구분</th><th>설명</th><th>현대적 해결 방안</th></tr></thead><tbody><tr><td><strong>클라우드 네이티브 대응</strong></td><td>마이크로서비스, 컨테이너, 서버리스 환경에서의 유연한 배포</td><td>도메인별 독립적 서비스 분리 및 API 기반 통신</td></tr><tr><td><strong>DevOps 통합</strong></td><td>CI/CD 파이프라인과 자동화된 테스트 체계 지원</td><td>계층별 독립적 테스트와 배포 가능한 구조</td></tr><tr><td><strong>비즈니스 민첩성</strong></td><td>빠른 요구사항 변화와 실험적 기능 개발 지원</td><td>도메인 중심의 모듈화로 기능별 독립적 개발</td></tr><tr><td><strong>데이터 다양성</strong></td><td>NoSQL, Event Store, 분산 데이터베이스 등 다양한 저장소 활용</td><td>Repository 패턴과 의존성 주입을 통한 저장소 추상화</td></tr></tbody></table><h4 id=접근법별-비교-분석>접근법별 비교 분석<a hidden class=anchor aria-hidden=true href=#접근법별-비교-분석>#</a></h4><table><thead><tr><th>비교 항목</th><th>전통적 접근법</th><th>현대적 접근법</th></tr></thead><tbody><tr><td><strong>중심 개념</strong></td><td>데이터베이스 (Database-Centric)</td><td>도메인 모델 (Domain-Centric)</td></tr><tr><td><strong>의존성 방향</strong></td><td>UI → Business → Data → Database</td><td>Infrastructure → Application → Domain</td></tr><tr><td><strong>변경 전파</strong></td><td>하위 변경이 상위에 영향</td><td>외부 변경이 도메인에 영향 없음</td></tr><tr><td><strong>테스트 전략</strong></td><td>통합 테스트 중심</td><td>단위 테스트 중심</td></tr><tr><td><strong>배포 단위</strong></td><td>모놀리식 전체 배포</td><td>도메인/기능별 독립 배포</td></tr></tbody></table><p>전통적 Layered Architecture 는 <strong>기술적 복잡성 관리</strong>에 중점을 둔 반면, 현대적 접근법은 <strong>비즈니스 복잡성 관리</strong>와 <strong>변화 대응성</strong>에 중점을 둔다. 이러한 패러다임 전환은 단순한 기술적 진화가 아니라, 소프트웨어가 비즈니스에 미치는 영향력 증대와 시장 환경의 급격한 변화에 대한 필연적 대응이라 할 수 있다.</p><p>따라서 현대의 소프트웨어 아키텍트는 프로젝트의 복잡성, 변화 빈도, 팀 구성, 비즈니스 목표 등을 종합적으로 고려하여 적절한 접근법을 선택해야 한다.</p><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><p>Layered Architecture 는 <strong>관심사의 분리 (Separation of Concerns) 를 통해 시스템 복잡성을 체계적으로 관리하는 아키텍처 설계 철학</strong>이다. 시대적 변화에 따라 기술 중심에서 도메인 중심으로 패러다임이 전환되면서 핵심 개념과 실무 적용 방식이 크게 진화했다.</p><h4 id=계층-layer-vs-티어-tier-개념-정립>계층 (Layer) vs. 티어 (Tier) 개념 정립<a hidden class=anchor aria-hidden=true href=#계층-layer-vs-티어-tier-개념-정립>#</a></h4><table><thead><tr><th>구분</th><th>Layer (논리적 계층)</th><th>Tier (물리적 티어)</th></tr></thead><tbody><tr><td><strong>정의</strong></td><td>코드 구조와 기능 단위의 논리적 분리</td><td>서버나 인프라 단위의 물리적 분리</td></tr><tr><td><strong>목적</strong></td><td><strong>관심사 분리 (Separation of Concerns)</strong>, 유지보수성</td><td><strong>스케일링, 배포 최적화</strong>, 성능 향상</td></tr><tr><td><strong>예시</strong></td><td>Presentation, Application, Domain, Infrastructure</td><td>Web Server, App Server, Database Server</td></tr><tr><td><strong>의존성</strong></td><td>논리적 인터페이스 기반 의존</td><td>네트워크 통신 기반 의존</td></tr><tr><td><strong>변경 영향</strong></td><td>컴파일 타임 의존성 관리</td><td>런타임 배포 및 네트워크 고려</td></tr></tbody></table><blockquote><p><strong>핵심</strong>: Layer 는 설계상의 추상화, Tier 는 배포 관점의 구분이며, 하나의 Tier 에 여러 Layer 가 존재할 수 있다.</p></blockquote><h4 id=전통적-layered-architecture-핵심-개념>전통적 Layered Architecture 핵심 개념<a hidden class=anchor aria-hidden=true href=#전통적-layered-architecture-핵심-개념>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>정의</strong></td><td>기술적 관심사를 기준으로 시스템을 <strong>수평 계층으로 분리</strong>하여 구성하는 아키텍처 스타일</td></tr><tr><td><strong>핵심 원칙</strong></td><td>각 계층은 <strong>기술적 책임만 수행</strong>하고, <strong>상위 계층이 하위 계층에만 의존</strong>하며, <strong>계층 간 의존은 하향식</strong></td></tr><tr><td><strong>계층 간 통신 규칙</strong></td><td>인접 계층만 접근 허용 (<code>strict layering</code>), 경우에 따라 생략 가능 (<code>relaxed layering</code>)</td></tr></tbody></table><h5 id=전통적-핵심-개념-상세>전통적 핵심 개념 상세<a hidden class=anchor aria-hidden=true href=#전통적-핵심-개념-상세>#</a></h5><ol><li><p><strong>계층별 기술적 책임 분리 (Technical Layer Responsibility)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1>1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2>2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3>3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4>4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5>5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6>6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7>7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8>8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ Presentation Layer (UI/Controller)  │ ← 사용자 인터페이스 처리
</span></span><span class=line><span class=cl>├─────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ Business Layer (Service/Logic)      │ ← 비즈니스 규칙 실행
</span></span><span class=line><span class=cl>├─────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ Persistence Layer (Repository/DAO)  │ ← 데이터 접근 추상화
</span></span><span class=line><span class=cl>├─────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ Database Layer (RDBMS)              │ ← 데이터 저장소
</span></span><span class=line><span class=cl>└─────────────────────────────────────┘
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>폐쇄 계층 (Closed Layer) 원칙</strong></p><ul><li>요청은 모든 계층을 순차적으로 통과해야 함</li><li>계층 건너뛰기 방지로 격리성 보장</li><li>각 계층의 책임 명확화</li></ul></li><li><p><strong>개방 계층 (Open Layer) 예외</strong></p><ul><li>아키텍처 싱크홀 안티패턴 방지</li><li>부가가치 없는 계층 우회 허용</li><li>성능 최적화를 위한 직접 접근</li></ul></li></ol><h4 id=현대적-domain-centric-architecture-핵심-개념>현대적 Domain-Centric Architecture 핵심 개념<a hidden class=anchor aria-hidden=true href=#현대적-domain-centric-architecture-핵심-개념>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>정의</strong></td><td>비즈니스 도메인을 중심으로 시스템을 <strong>동심원 구조로 분리</strong>하여 구성하는 아키텍처 스타일</td></tr><tr><td><strong>핵심 원칙</strong></td><td>도메인이 <strong>비즈니스 책임의 중심</strong>이며, <strong>외부 계층이 내부 계층에 의존</strong>하고, <strong>의존성은 중심 지향</strong></td></tr><tr><td><strong>계층 간 통신 규칙</strong></td><td>포트와 어댑터를 통한 인터페이스 기반 통신, 의존성 역전 원칙 적용</td></tr></tbody></table><h5 id=현대적-핵심-개념-상세>현대적 핵심 개념 상세<a hidden class=anchor aria-hidden=true href=#현대적-핵심-개념-상세>#</a></h5><ol><li><p><strong>도메인 중심성 (Domain Centricity)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1> 1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2> 2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3> 3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4> 4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5> 5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6> 6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7> 7</a>
</span><span class=lnt id=hl-18-8><a class=lnlinks href=#hl-18-8> 8</a>
</span><span class=lnt id=hl-18-9><a class=lnlinks href=#hl-18-9> 9</a>
</span><span class=lnt id=hl-18-10><a class=lnlinks href=#hl-18-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>        ┌─────────────────────────────────┐
</span></span><span class=line><span class=cl>        │     Infrastructure Layer        │
</span></span><span class=line><span class=cl>        │  ┌─────────────────────────┐    │
</span></span><span class=line><span class=cl>        │  │   Application Layer     │    │
</span></span><span class=line><span class=cl>        │  │  ┌─────────────────┐    │    │
</span></span><span class=line><span class=cl>        │  │  │  Domain Layer   │    │    │ ← 비즈니스 로직 중심
</span></span><span class=line><span class=cl>        │  │  │ (Entities, VOs) │    │    │
</span></span><span class=line><span class=cl>        │  │  └─────────────────┘    │    │
</span></span><span class=line><span class=cl>        │  └─────────────────────────┘    │
</span></span><span class=line><span class=cl>        └─────────────────────────────────┘
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>의존성 역전 원칙 (Dependency Inversion Principle)</strong></p><ul><li><strong>전통적</strong>: UI → Business → Data → Database</li><li><strong>현대적</strong>: Infrastructure → Application → Domain (중심)</li><li>고수준 모듈이 저수준 모듈의 추상화에 의존</li></ul></li><li><p><strong>포트와 어댑터 (Ports and Adapters)</strong></p><ul><li><strong>포트 (Ports)</strong>: 도메인이 정의하는 인터페이스</li><li><strong>어댑터 (Adapters)</strong>: 외부 시스템과의 구체적 연결</li><li>플러그인 가능한 아키텍처 구현</li></ul></li></ol><h4 id=실무-연관성-및-구현-전략>실무 연관성 및 구현 전략<a hidden class=anchor aria-hidden=true href=#실무-연관성-및-구현-전략>#</a></h4><h5 id=전통적-접근법의-실무-연관성>전통적 접근법의 실무 연관성<a hidden class=anchor aria-hidden=true href=#전통적-접근법의-실무-연관성>#</a></h5><table><thead><tr><th>실무 요소</th><th>연관성 및 효과</th><th>한계점</th></tr></thead><tbody><tr><td><strong>팀 분업</strong></td><td>계층별 전문팀 구성 (FE/BE/DBA)</td><td>사일로 현상, 소통 비용 증가</td></tr><tr><td><strong>기술 스택 관리</strong></td><td>계층별 기술 선택의 명확성</td><td>기술 종속성, 교체 어려움</td></tr><tr><td><strong>배포 및 운영</strong></td><td>모놀리식 단위 배포의 단순성</td><td>부분 배포 불가, 확장성 제한</td></tr><tr><td><strong>테스트 전략</strong></td><td>계층별 단위 테스트 가능</td><td>통합 테스트 의존성 높음</td></tr></tbody></table><h5 id=현대적-접근법의-실무-연관성>현대적 접근법의 실무 연관성<a hidden class=anchor aria-hidden=true href=#현대적-접근법의-실무-연관성>#</a></h5><table><thead><tr><th>실무 요소</th><th>연관성 및 효과</th><th>장점</th></tr></thead><tbody><tr><td><strong>도메인 전문성</strong></td><td>비즈니스 전문가와 개발자 협업 강화</td><td>요구사항 - 구현 간 일치성 향상</td></tr><tr><td><strong>마이크로서비스</strong></td><td>도메인별 독립 서비스 분리</td><td>개별 확장 및 배포 가능</td></tr><tr><td><strong>클라우드 네이티브</strong></td><td>컨테이너화된 도메인 서비스</td><td>인프라 독립성, 탄력적 확장</td></tr><tr><td><strong>DevOps 통합</strong></td><td>도메인별 CI/CD 파이프라인</td><td>빠른 배포, 롤백 용이성</td></tr></tbody></table><h5 id=현대적-아키텍처-패턴과의-연관성>현대적 아키텍처 패턴과의 연관성<a hidden class=anchor aria-hidden=true href=#현대적-아키텍처-패턴과의-연관성>#</a></h5><ol><li><p>Clean Architecture 와의 관계</p><ul><li><strong>의존성 규칙</strong>: 외부 계층이 내부 계층에 의존</li><li><strong>엔터프라이즈 비즈니스 규칙</strong>: 도메인 엔티티</li><li><strong>애플리케이션 비즈니스 규칙</strong>: 유스케이스</li></ul></li><li><p>Hexagonal Architecture 와의 관계</p><ul><li><strong>헥사곤 (애플리케이션 코어)</strong>: 비즈니스 로직</li><li><strong>포트</strong>: 애플리케이션과 외부 세계 간의 인터페이스</li><li><strong>어댑터</strong>: 특정 기술에 대한 구현체</li></ul></li><li><p>Onion Architecture 와의 관계</p><ul><li><strong>도메인 모델</strong>: 최내부 계층</li><li><strong>도메인 서비스</strong>: 도메인 로직 포함</li><li><strong>애플리케이션 서비스</strong>: 유스케이스 조정</li><li><strong>인프라스트럭처</strong>: 외부 계층</li></ul></li></ol><h4 id=핵심-개념-비교-분석>핵심 개념 비교 분석<a hidden class=anchor aria-hidden=true href=#핵심-개념-비교-분석>#</a></h4><h5 id=설계-철학-차이>설계 철학 차이<a hidden class=anchor aria-hidden=true href=#설계-철학-차이>#</a></h5><table><thead><tr><th>비교 항목</th><th>전통적 접근법</th><th>현대적 접근법</th></tr></thead><tbody><tr><td><strong>중심 관심사</strong></td><td>기술적 계층 분리</td><td>비즈니스 도메인 보호</td></tr><tr><td><strong>의존성 방향</strong></td><td>하향식 (UI→DB)</td><td>중심 지향 (Infrastructure→Domain)</td></tr><tr><td><strong>변경 전파</strong></td><td>하위 변경이 상위 영향</td><td>외부 변경이 도메인에 무영향</td></tr><tr><td><strong>테스트 전략</strong></td><td>통합 테스트 중심</td><td>도메인 단위 테스트 중심</td></tr><tr><td><strong>배포 단위</strong></td><td>모놀리식 전체</td><td>도메인별 독립</td></tr></tbody></table><h4 id=실무에서의-혼합-접근법>실무에서의 혼합 접근법<a hidden class=anchor aria-hidden=true href=#실무에서의-혼합-접근법>#</a></h4><p>전통적인 Layered Architecture 의 구조적 명확성과 현대적인 Domain-Centric 아키텍처의 유연성과 테스트 용이성을 결합하여 사용하는 것이 효과적이다.</p><p>이 방식은 **도메인 중심 설계 (DDD)**를 중심 코어로 두고, 그 외부는 전통적 계층처럼 <strong>Presentation</strong>, <strong>Persistence</strong>, <strong>Integration</strong> 계층으로 나누는 구조를 취한다. 이로써 <strong>비즈니스 로직의 독립성과 재사용성</strong>을 확보하면서도, <strong>개발자와 인프라 팀에게 익숙한 레이어드 구조</strong>를 유지할 수 있다.</p><h5 id=하이브리드-아키텍처-구조>하이브리드 아키텍처 구조<a hidden class=anchor aria-hidden=true href=#하이브리드-아키텍처-구조>#</a></h5><ul><li><p><strong>Core (도메인 중심 구조)</strong></p><ul><li><code>Domain Layer</code>: Entity, Value Object, Domain Logic</li><li><code>Application Layer</code>: Use Case, Application Service</li></ul></li><li><p><strong>Infrastructure (전통적 구조 적용)</strong></p><ul><li><code>Presentation Layer</code>: REST Controller, GraphQL Resolver 등</li><li><code>Persistence Layer</code>: Repository Implementation (e.g., JPA, ORM)</li><li><code>Integration Layer</code>: 외부 API, 메시지 브로커 어댑터</li></ul></li></ul><pre class=mermaid>graph TD

subgraph &#34;Presentation Layer&#34;
    UI[REST Controller / UI Adapter]
end

subgraph &#34;Application Layer (Use Cases)&#34;
    UC[Use Case / Application Service]
end

subgraph &#34;Domain Layer&#34;
    E[Entities]
    V[Value Objects]
    S[Domain Services]
end

subgraph &#34;Infrastructure Layer&#34;
    DB[&#34;Repository Implementation (JPA/ORM)&#34;]
    EXT[External API Client]
    MSG[Message Queue Adapter]
end

UI --&gt; UC
UC --&gt; S
UC --&gt; E
UC --&gt; V
S --&gt; E
S --&gt; V

DB -.-&gt; UC
EXT -.-&gt; UC
MSG -.-&gt; UC

DB --&gt;|implements| RepoPort[Persistence Port]
EXT --&gt;|implements| APIClientPort[API Port]
MSG --&gt;|implements| MessagePort[Event Port]

RepoPort --&gt; UC
APIClientPort --&gt; UC
MessagePort --&gt; UC
</pre><ul><li>**Use Case 계층 (Application Layer)**는 도메인 계층을 호출하면서 외부 시스템 (Infra) 을 직접 의존하지 않고 <strong>Port 인터페이스</strong>를 통해 접근한다.</li><li><strong>Infrastructure Layer</strong>는 전통적인 방식대로 기술 기반 컴포넌트를 구현하지만, <strong>인터페이스를 구현</strong>하는 방식으로 DIP(Dependency Inversion Principle) 를 만족한다.</li><li><strong>Domain Layer</strong>는 외부 의존이 없는 순수한 비즈니스 로직만 포함한다.</li></ul><h3 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h3><h4 id=전통적-vs-현대적-layered-architecture-비교>전통적 vs. 현대적 Layered Architecture 비교<a hidden class=anchor aria-hidden=true href=#전통적-vs-현대적-layered-architecture-비교>#</a></h4><h5 id=전통적-계층별-기능-및-역할>전통적 계층별 기능 및 역할<a hidden class=anchor aria-hidden=true href=#전통적-계층별-기능-및-역할>#</a></h5><table><thead><tr><th>계층</th><th>주요 기능 (Functions)</th><th>주요 역할 (Roles)</th><th>핵심 특징</th></tr></thead><tbody><tr><td><strong>Presentation Layer</strong></td><td>• UI 렌더링 및 표시<br>• 사용자 입력 수집<br>• 요청 라우팅</td><td>• 사용자와 시스템 간 인터페이스<br>• 비즈니스 계층 접근의 전단 게이트웨이</td><td><strong>기술 중심적 분리</strong></td></tr><tr><td><strong>Business Logic Layer</strong></td><td>• 비즈니스 규칙 실행<br>• 데이터 가공 및 검증<br>• 워크플로우 제어</td><td>• 핵심 업무 로직 구현<br>• 데이터 계층과 UI 계층 중재</td><td><strong>절차적 로직 처리</strong></td></tr><tr><td><strong>Persistence Layer</strong></td><td>• ORM/데이터 매핑<br>• CRUD 연산 수행<br>• 트랜잭션 관리</td><td>• 데이터 접근 추상화<br>• 비즈니스 계층과 DB 격리</td><td><strong>데이터 접근 중심</strong></td></tr><tr><td><strong>Database Layer</strong></td><td>• 데이터 저장 및 검색<br>• 무결성 제약 관리<br>• 인덱싱 및 최적화</td><td>• 최종 데이터 저장소<br>• 영속성 보장</td><td><strong>물리적 저장소</strong></td></tr></tbody></table><p><strong>의존성 방향</strong>: Presentation → Business → Persistence → Database (하향식)</p><h5 id=현대적-계층별-기능-및-역할>현대적 계층별 기능 및 역할<a hidden class=anchor aria-hidden=true href=#현대적-계층별-기능-및-역할>#</a></h5><table><thead><tr><th>계층</th><th>주요 기능 (Functions)</th><th>주요 역할 (Roles)</th><th>핵심 특징</th></tr></thead><tbody><tr><td><strong>Presentation Layer</strong></td><td>• 외부 인터페이스 제공<br>• 요청/응답 어댑팅<br>• 인증 및 권한 검사</td><td>• <strong>어댑터 패턴</strong> 구현<br>• 외부 시스템과의 경계 관리</td><td><strong>인터페이스 어댑터</strong></td></tr><tr><td><strong>Application Layer</strong></td><td>• 유스케이스 조정<br>• 도메인 객체 협업 관리<br>• 트랜잭션 경계 설정</td><td>• <strong>오케스트레이터</strong> 역할<br>• 도메인 로직과 외부 세계 연결</td><td><strong>워크플로우 조정</strong></td></tr><tr><td><strong>Domain Layer</strong></td><td>• 핵심 비즈니스 로직<br>• 도메인 규칙 구현<br>• 엔티티 및 값 객체 관리</td><td>• 비즈니스 지식의 <strong>중심</strong><br>• 도메인 전문가 언어 반영</td><td><strong>도메인 중심성</strong></td></tr><tr><td><strong>Infrastructure Layer</strong></td><td>• 기술적 세부사항 처리<br>• 외부 시스템 연동<br>• 프레임워크 통합</td><td>• <strong>기술적 구현</strong> 담당<br>• 도메인을 외부 세계에 연결</td><td><strong>구현 세부사항</strong></td></tr></tbody></table><p><strong>의존성 방향</strong>: Infrastructure → Application → Domain (중심 지향)</p><h4 id=각-계층의-구체적-책임>각 계층의 구체적 책임<a hidden class=anchor aria-hidden=true href=#각-계층의-구체적-책임>#</a></h4><table><thead><tr><th>계층</th><th>접근 방식</th><th>주요 책임 (Responsibilities)</th></tr></thead><tbody><tr><td><strong>Presentation Layer</strong><br>(프레젠테이션 계층)</td><td>전통적</td><td>- 사용자 입력 처리 및 검증<br>- UI 렌더링, 화면 출력<br>- 세션 및 인증 상태 관리</td></tr><tr><td></td><td>현대적</td><td>- HTTP 요청을 도메인 언어로 변환<br>- 도메인 객체 → JSON/XML 직렬화<br>- API 버전 관리 및 콘텐츠 협상</td></tr><tr><td><strong>Application Layer</strong><br>(애플리케이션 계층)</td><td>공통 (현대 중심)</td><td>- 유스케이스 조정 및 실행 흐름 제어<br>- 트랜잭션 경계 설정<br>- 보안/권한 검사 수행<br>- 도메인 계층 호출 조율<br>- 이벤트 발행 (도메인 이벤트 → 메시지 브로커 등)</td></tr><tr><td><strong>Domain Layer</strong><br>(도메인 계층)</td><td>공통 (현대 중심)</td><td>- 비즈니스 불변식 유지<br>- 핵심 도메인 규칙 및 정책 구현<br>- 엔티티 및 값 객체 설계<br>- 도메인 서비스 구성 및 캡슐화<br>- 상태 기반 의사결정 로직 처리</td></tr><tr><td><strong>Infrastructure Layer</strong><br>(인프라스트럭처 계층)</td><td>공통</td><td>- DB, 메시지 브로커, 외부 API 등과 연동<br>- 기술 세부사항 구현 (JPA, Kafka Adapter 등)<br>- 도메인 Port 구현<br>- 로그, 캐시, 파일 IO 등 기술 기능 제공<br>- SMTP, 인증, 외부 시스템 접근 등 기술 통합</td></tr></tbody></table><ul><li><strong>Presentation Layer</strong>: 시스템 외부와의 접점 → 사용자 및 클라이언트와 통신</li><li><strong>Application Layer</strong>: Use Case 중심 흐름 → 도메인 모델을 조정, 외부 인터페이스를 추상화</li><li><strong>Domain Layer</strong>: 시스템의 핵심 → 순수한 비즈니스 로직과 규칙을 담당</li><li><strong>Infrastructure Layer</strong>: 외부 세계와 통신 → 기술 세부사항 및 외부 리소스 연동</li></ul><h4 id=계층-간-상호작용-패턴>계층 간 상호작용 패턴<a hidden class=anchor aria-hidden=true href=#계층-간-상호작용-패턴>#</a></h4><h5 id=전통적-상호작용>전통적 상호작용<a hidden class=anchor aria-hidden=true href=#전통적-상호작용>#</a></h5><pre class=mermaid>sequenceDiagram
    participant UI as Presentation
    participant BL as Business Logic
    participant DAL as Data Access
    participant DB as Database
    
    UI-&gt;&gt;BL: processRequest(data)
    BL-&gt;&gt;BL: validateBusinessRules(data)
    BL-&gt;&gt;DAL: saveData(processedData)
    DAL-&gt;&gt;DB: INSERT/UPDATE
    DB--&gt;&gt;DAL: result
    DAL--&gt;&gt;BL: savedData
    BL--&gt;&gt;UI: response
</pre><h5 id=현대적-상호작용>현대적 상호작용<a hidden class=anchor aria-hidden=true href=#현대적-상호작용>#</a></h5><pre class=mermaid>sequenceDiagram
    participant P as Presentation
    participant A as Application
    participant D as Domain
    participant I as Infrastructure
    
    P-&gt;&gt;A: executeUseCase(request)
    A-&gt;&gt;D: createDomainObject(data)
    D-&gt;&gt;D: applyBusinessRules()
    A-&gt;&gt;I: persist(domainObject)
    I-&gt;&gt;I: mapToDatabase()
    I--&gt;&gt;A: persistedObject
    A--&gt;&gt;P: response
</pre><h4 id=공통-횡단-관심사-cross-cutting-concerns>공통 횡단 관심사 (Cross-cutting Concerns)<a hidden class=anchor aria-hidden=true href=#공통-횡단-관심사-cross-cutting-concerns>#</a></h4><table><thead><tr><th>관심사</th><th>전통적 접근법</th><th>현대적 접근법</th></tr></thead><tbody><tr><td><strong>보안</strong></td><td>각 계층에서 개별적으로 처리</td><td>인프라에서 일관된 정책 적용</td></tr><tr><td><strong>로깅</strong></td><td>각 계층에 로깅 코드 산재</td><td>AOP 나 데코레이터로 횡단 처리</td></tr><tr><td><strong>트랜잭션</strong></td><td>비즈니스 계층에서 관리</td><td>애플리케이션 계층에서 경계 설정</td></tr><tr><td><strong>예외 처리</strong></td><td>각 계층에서 try-catch</td><td>글로벌 핸들러와 도메인 예외 분리</td></tr><tr><td><strong>캐싱</strong></td><td>데이터 계층 위주</td><td>각 계층 특성에 맞는 캐싱 전략</td></tr></tbody></table><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><p><strong>Layered Architecture 는 구조적 명확성과 운영 효율성을 동시에 추구하는 아키텍처 패턴</strong>이다. <strong>수평적 계층 구분, 단방향 의존성, 관심사의 분리</strong>를 통해 유지보수성과 확장성을 확보하고, 각 계층의 역할과 책임을 <strong>인터페이스 기반으로 독립화</strong>함으로써 <strong>테스트 용이성, 배포 독립성, 팀별 협업, 모듈화</strong>의 장점을 극대화한다.</p><h4 id=구조적-특징>구조적 특징<a hidden class=anchor aria-hidden=true href=#구조적-특징>#</a></h4><table><thead><tr><th>항목</th><th>전통적 Layered Architecture</th><th>현대적 Domain‑Centric Layered Architecture</th></tr></thead><tbody><tr><td><strong>의존성 방향</strong></td><td>상위 → 하위 (Top‑Down), 하위 구현 직접 참조</td><td>외부 → 내부 (Bottom‑Up), 인터페이스 중심 의존성 역전 (DIP)</td></tr><tr><td><strong>계층 구분 기준</strong></td><td>기술 중심 (UI, Service, Persistence, DB 등)</td><td>도메인 중심 (Use Case, Entity, Port, Adapter 등)</td></tr><tr><td><strong>의존성 규칙</strong></td><td>인접 계층만 호출 가능 (<code>strict layering</code>)</td><td>필요 시 인터페이스만 사용 (<code>relaxed layering</code>)</td></tr><tr><td><strong>계층 응집도</strong></td><td>기능적 책임 중심, 다소 기술 중심 분할</td><td>유스케이스/도메인 중심 응집도 높은 설계</td></tr></tbody></table><h4 id=동작적-특징>동작적 특징<a hidden class=anchor aria-hidden=true href=#동작적-특징>#</a></h4><table><thead><tr><th>항목</th><th>전통적 Layered Architecture</th><th>현대적 Layered Architecture</th></tr></thead><tbody><tr><td><strong>요청 흐름 (Flow)</strong></td><td>Presentation → Business → Persistence 순차 흐름</td><td>Controller → Use Case → Domain → Adapter 구조</td></tr><tr><td><strong>계층 간 호출</strong></td><td>계층 간 다이렉트 호출 가능 (가끔 비인접도 허용)</td><td>오직 포트 (인터페이스) 를 통해 호출, 구현 감춤</td></tr><tr><td><strong>트랜잭션 경계 설정</strong></td><td>Service Layer 중심 트랜잭션 처리 (AOP 방식)</td><td>Application / Use Case 레벨에서 명확하게 트랜잭션 경계 처리</td></tr><tr><td><strong>처리 패턴</strong></td><td>순차적 처리 (Sequential)</td><td>이벤트 중심, 수평적 확장, 병렬 처리 구조 지원 가능</td></tr></tbody></table><h5 id=전통적-layered-architecture>전통적 Layered Architecture<a hidden class=anchor aria-hidden=true href=#전통적-layered-architecture>#</a></h5><pre class=mermaid>graph TD
    A[Presentation Layer] --&gt; B[Business Layer]
    B --&gt; C[Persistence Layer] 
    C --&gt; D[Database Layer]
    
    A1[HTTP Request] --&gt; B1[Service Logic]
    B1 --&gt; C1[Data Access]
    C1 --&gt; D1[SQL Database]
</pre><p><strong>특징</strong>:</p><ul><li><strong>순차적 처리</strong>: 요청이 모든 계층을 순차적으로 통과</li><li><strong>폐쇄 계층</strong>: 각 계층을 반드시 거쳐야 함</li><li><strong>동기적 통신</strong>: 계층 간 동기식 호출 방식</li></ul><h5 id=현대적-layered-architecture>현대적 Layered Architecture<a hidden class=anchor aria-hidden=true href=#현대적-layered-architecture>#</a></h5><pre class=mermaid>graph TD
    subgraph &#34;Infrastructure Layer&#34;
        A[REST Controllers]
        B[Database Adapters]
        C[Message Brokers]
    end
    
    subgraph &#34;Application Layer&#34;
        D[Use Cases]
        E[Application Services]
    end
    
    subgraph &#34;Domain Layer&#34;
        F[Domain Entities]
        G[Domain Services]
        H[Business Rules]
    end
    
    A --&gt; D
    B -.-&gt; D
    C -.-&gt; D
    D --&gt; F
    E --&gt; G
    F --&gt; H
</pre><p><strong>특징</strong>:</p><ul><li><strong>비동기 처리</strong>: 계층 간 비동기 통신 지원</li><li><strong>개방/폐쇄 계층</strong>: 상황에 따른 계층 우회 허용</li><li><strong>이벤트 기반</strong>: 도메인 이벤트를 통한 느슨한 결합</li></ul><h4 id=설계-및-운영-관점-특징>설계 및 운영 관점 특징<a hidden class=anchor aria-hidden=true href=#설계-및-운영-관점-특징>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>모듈화 (Modularity)</strong></td><td>계층별 책임 구분으로 코드 응집성 확보 및 재사용성 증대</td></tr><tr><td><strong>테스트 용이성</strong></td><td>각 계층 단위의 단위 테스트 및 통합 테스트 수행 가능</td></tr><tr><td><strong>관심사 분리 (SoC)</strong></td><td>UI, 비즈니스, 데이터 접근, 인프라 등을 명확히 분리 → 코드 이해도와 유지보수성 향상</td></tr><tr><td><strong>유연성과 확장성</strong></td><td>전통적 구조는 기술 중심 고정적 변화, 현대적 구조는 인터페이스 기반 플러그인 방식의 유연성 확보</td></tr><tr><td><strong>표준화 및 협업</strong></td><td>널리 채택된 계층 패턴으로 설계, 문서화, 팀 간 커뮤니케이션 효율 향상</td></tr><tr><td><strong>안정성/복원력</strong></td><td>장애 격리 및 영향 통제 가능한 구조적 설계; 인프라 계층 장애 시 도메인 중심 코어 영향 최소화</td></tr></tbody></table><h4 id=계층별-역할-비교>계층별 역할 비교<a hidden class=anchor aria-hidden=true href=#계층별-역할-비교>#</a></h4><table><thead><tr><th>계층</th><th>전통적 역할</th><th>현대적 역할</th><th>진화 포인트</th></tr></thead><tbody><tr><td><strong>Presentation</strong></td><td>UI 렌더링, 입력 처리</td><td>어댑터 역할, 다중 채널 지원</td><td>RESTful API, GraphQL, WebSocket</td></tr><tr><td><strong>Business</strong></td><td>비즈니스 로직 처리</td><td>유스케이스 조정, 도메인 오케스트레이션</td><td>Use Case 패턴, CQRS</td></tr><tr><td><strong>Domain</strong></td><td>데이터 모델링</td><td>핵심 비즈니스 규칙, 도메인 전문가 언어</td><td>DDD Entities, Value Objects</td></tr><tr><td><strong>Infrastructure</strong></td><td>데이터 접근</td><td>외부 시스템 연동, 기술적 세부사항</td><td>클라우드 네이티브, 마이크로서비스</td></tr></tbody></table><h3 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h3><h4 id=전통적-layered-architecture-원칙-1980-년대2000-년대>전통적 Layered Architecture 원칙 (1980 년대~2000 년대)<a hidden class=anchor aria-hidden=true href=#전통적-layered-architecture-원칙-1980-년대2000-년대>#</a></h4><p><strong>철학적 기반</strong>: 기술적 관심사 중심의 분리 (Technology-Centric Separation)</p><h5 id=설계-원칙-design-principles>설계 원칙 (Design Principles)<a hidden class=anchor aria-hidden=true href=#설계-원칙-design-principles>#</a></h5><table><thead><tr><th>원칙</th><th>정의</th><th>특징</th><th>제약사항</th></tr></thead><tbody><tr><td><strong>Separation of Concerns (SoC)</strong></td><td>기술적 관심사별 계층 분리</td><td>UI, 비즈니스, 데이터 접근 분리</td><td>기술 중심적 분류</td></tr><tr><td><strong>Layered Isolation</strong></td><td>계층 간 격리를 통한 독립성</td><td>각 계층의 독립적 변경 가능</td><td>완전한 격리는 현실적으로 어려움</td></tr><tr><td><strong>Dependency Flow</strong></td><td>상위에서 하위로의 일방향 의존성</td><td>UI → Business → Data → Database</td><td>데이터베이스가 최하위 계층</td></tr></tbody></table><h5 id=구현-원칙-implementation-principles>구현 원칙 (Implementation Principles)<a hidden class=anchor aria-hidden=true href=#구현-원칙-implementation-principles>#</a></h5><table><thead><tr><th>원칙</th><th>설명</th><th>구현 방식</th></tr></thead><tbody><tr><td><strong>Strict Layering</strong></td><td>바로 인접한 하위 계층에만 접근</td><td>순차적 호출만 허용</td></tr><tr><td><strong>Closed Layers</strong></td><td>모든 계층을 순차적으로 통과</td><td>계층 건너뛰기 금지</td></tr><tr><td><strong>Top-Down Control</strong></td><td>상위 계층이 하위 계층 제어</td><td>제어 흐름의 일방향성</td></tr></tbody></table><h4 id=현대적-layered-architecture-원칙-2000-년대현재>현대적 Layered Architecture 원칙 (2000 년대~현재)<a hidden class=anchor aria-hidden=true href=#현대적-layered-architecture-원칙-2000-년대현재>#</a></h4><p><strong>철학적 기반</strong>: 도메인 중심의 분리 (Domain-Centric Separation)</p><h5 id=설계-원칙-architectural-design-principles>설계 원칙 (Architectural Design Principles)<a hidden class=anchor aria-hidden=true href=#설계-원칙-architectural-design-principles>#</a></h5><table><thead><tr><th>원칙</th><th>정의</th><th>현대적 특징</th><th>SOLID 연관성</th></tr></thead><tbody><tr><td><strong>Domain Independence</strong></td><td>도메인의 기술적 독립성</td><td>비즈니스 로직이 중심에 위치</td><td>SRP + OCP</td></tr><tr><td><strong>Dependency Inversion (DIP)</strong></td><td>의존성 방향의 역전</td><td>추상화에 의존, 구체화 금지</td><td>DIP 직접 적용</td></tr><tr><td><strong>Interface Segregation</strong></td><td>인터페이스 분리 원칙</td><td>최소한의 인터페이스만 노출</td><td>ISP 적용</td></tr><tr><td><strong>Single Responsibility</strong></td><td>단일 책임 원칙</td><td>각 계층의 명확한 책임</td><td>SRP 적용</td></tr></tbody></table><h5 id=구현-원칙-implementation--operational-principles>구현 원칙 (Implementation & Operational Principles)<a hidden class=anchor aria-hidden=true href=#구현-원칙-implementation--operational-principles>#</a></h5><table><thead><tr><th>원칙</th><th>설명</th><th>구현 방식</th><th>도구/기법</th></tr></thead><tbody><tr><td><strong>Inversion of Control (IoC)</strong></td><td>제어 역전을 통한 느슨한 결합</td><td>의존성 주입 컨테이너 활용</td><td>Spring IoC,.NET DI</td></tr><tr><td><strong>Contract-First Design</strong></td><td>인터페이스 우선 설계</td><td>구현 전 계약 정의</td><td>API-First 개발</td></tr><tr><td><strong>Abstraction Layers</strong></td><td>추상화 계층을 통한 격리</td><td>포트와 어댑터 패턴</td><td>Hexagonal Architecture</td></tr><tr><td><strong>Dependency Injection</strong></td><td>런타임 의존성 주입</td><td>설정 기반 의존성 해결</td><td>DI Frameworks</td></tr></tbody></table><h4 id=패러다임의-전환>패러다임의 전환<a hidden class=anchor aria-hidden=true href=#패러다임의-전환>#</a></h4><pre class=mermaid>graph LR
    subgraph &#34;전통적 접근법&#34;
        A[UI Layer] --&gt; B[Business Layer]
        B --&gt; C[Data Layer]
        C --&gt; D[Database]
    end
    
    subgraph &#34;현대적 접근법&#34;
        E[Infrastructure] --&gt; F[Application]
        F --&gt; G[Domain]
        H[UI] --&gt; F
        I[Database] --&gt; F
    end
    
    A -.evolution.-&gt; H
    B -.evolution.-&gt; F
    C -.evolution.-&gt; I
    D -.evolution.-&gt; I
</pre><h5 id=주요-변화점>주요 변화점<a hidden class=anchor aria-hidden=true href=#주요-변화점>#</a></h5><table><thead><tr><th>측면</th><th>전통적 접근법</th><th>현대적 접근법</th><th>변화 동력</th></tr></thead><tbody><tr><td><strong>중심 요소</strong></td><td>데이터베이스</td><td>도메인 모델</td><td>DDD 의 영향</td></tr><tr><td><strong>의존성 방향</strong></td><td>하향식 (Top-Down)</td><td>중심 지향 (Inside-Out)</td><td>의존성 역전 원칙</td></tr><tr><td><strong>테스트 용이성</strong></td><td>통합 테스트 의존적</td><td>도메인 독립 테스트</td><td>테스트 주도 개발</td></tr><tr><td><strong>변경 영향도</strong></td><td>계층 간 전파</td><td>도메인 격리</td><td>애자일 개발 방법론</td></tr></tbody></table><h5 id=통합된-핵심-원칙>통합된 핵심 원칙<a hidden class=anchor aria-hidden=true href=#통합된-핵심-원칙>#</a></h5><h6 id=아키텍처-설계-원칙-architecture-design-principles>아키텍처 설계 원칙 (Architecture Design Principles)<a hidden class=anchor aria-hidden=true href=#아키텍처-설계-원칙-architecture-design-principles>#</a></h6><table><thead><tr><th>원칙</th><th>설명</th><th>적용 방법</th><th>검증 기준</th></tr></thead><tbody><tr><td><strong>단일 책임 원칙 (SRP)</strong></td><td>각 계층은 하나의 명확한 책임만 담당</td><td>변경 이유가 단 하나여야 함</td><td>응집도 측정</td></tr><tr><td><strong>개방 - 폐쇄 원칙 (OCP)</strong></td><td>확장에는 열려있고 수정에는 닫혀있음</td><td>인터페이스 기반 확장</td><td>새 기능 추가 시 기존 코드 변경 없음</td></tr><tr><td><strong>의존성 역전 원칙 (DIP)</strong></td><td>상위 모듈이 하위 구현에 의존하지 않음</td><td>추상화에 의존하는 구조</td><td>인터페이스 의존성 분석</td></tr><tr><td><strong>인터페이스 분리 원칙 (ISP)</strong></td><td>필요한 최소한의 인터페이스만 노출</td><td>역할별 인터페이스 분리</td><td>인터페이스 응집도 측정</td></tr><tr><td><strong>관심사의 분리 (SoC)</strong></td><td>서로 다른 책임을 구분하여 설계</td><td>도메인 개념 기반 분리</td><td>기능별 모듈화 정도</td></tr><tr><td><strong>추상화 원칙 (Abstraction)</strong></td><td>구현 세부사항을 숨기고 계약에 집중</td><td>인터페이스 중심 설계</td><td>구현체 교체 가능성</td></tr><tr><td><strong>모듈화 원칙 (Modularity)</strong></td><td>독립된 모듈로 구성, 높은 응집도</td><td>패키지/네임스페이스 분리</td><td>결합도/응집도 측정</td></tr></tbody></table><h6 id=구현-운영-원칙-implementation--operational-principles>구현 운영 원칙 (Implementation & Operational Principles)<a hidden class=anchor aria-hidden=true href=#구현-운영-원칙-implementation--operational-principles>#</a></h6><table><thead><tr><th>원칙</th><th>설명</th><th>구현 기법</th><th>측정 지표</th></tr></thead><tbody><tr><td><strong>계층 격리 원칙 (Layer Isolation)</strong></td><td>독립적 개발·배포 가능한 구조</td><td>마이크로서비스, 컨테이너화</td><td>배포 독립성</td></tr><tr><td><strong>단방향 의존성 (Unidirectional Dependency)</strong></td><td>의존성 방향의 일관성 유지</td><td>의존성 주입, 인터페이스</td><td>순환 의존성 검사</td></tr><tr><td><strong>느슨한 결합 (Low Coupling)</strong></td><td>계층 간 최소한의 상호작용</td><td>이벤트 기반 통신</td><td>결합도 메트릭</td></tr><tr><td><strong>높은 응집도 (High Cohesion)</strong></td><td>계층 내부의 유기적 동작</td><td>도메인 모델링</td><td>응집도 메트릭</td></tr><tr><td><strong>계층 간 인터페이스 명확화</strong></td><td>명확한 API/Interface 정의</td><td>OpenAPI, Contract Testing</td><td>API 호환성 테스트</td></tr><tr><td><strong>적응적 계층화 (Adaptive Layering)</strong></td><td>필요에 따른 계층 우회 허용</td><td>Open Layer Pattern</td><td>성능 최적화 측정</td></tr></tbody></table><h3 id=주요-원리-및-작동-원리>주요 원리 및 작동 원리<a hidden class=anchor aria-hidden=true href=#주요-원리-및-작동-원리>#</a></h3><h4 id=전통적-layered-architecture-작동-원리>전통적 Layered Architecture 작동 원리<a hidden class=anchor aria-hidden=true href=#전통적-layered-architecture-작동-원리>#</a></h4><ul><li><strong>와이어링 방식</strong>: 프레젠테이션 → 비즈니스 → 데이터 액세스 층 순서로 호출 흐름이 내려감. 단순하지만 BLL 이 DAL 구현에 직접 노출됨</li><li><strong>표준 구성</strong>: UI / BLL (Business Logic Layer) / DAL (Data Access Layer) 구조가 일반적</li><li><strong>테스트 어려움</strong>: BLL 테스트 시 실제 DB 없이는 정상적인 검증 어려움, 테스트 환경 구성 복잡</li></ul><pre class=mermaid>graph TD
    A[Presentation Layer] --&gt; B[Business Layer]
    B --&gt; C[Persistence Layer]
    C --&gt; D[Database Layer]
    
    A1[Controller] --&gt; B1[Service]
    B1 --&gt; C1[Repository]
    C1 --&gt; D1[Database]
</pre><p><strong>작동 방식</strong>:</p><ol><li>사용자 요청이 Presentation Layer 로 진입</li><li>Business Layer 에서 비즈니스 로직 처리</li><li>Persistence Layer 를 통한 데이터 접근</li><li>Database Layer 에서 데이터 영속성 처리</li></ol><h4 id=현대적-layered-architecture-작동-원리>현대적 Layered Architecture 작동 원리<a hidden class=anchor aria-hidden=true href=#현대적-layered-architecture-작동-원리>#</a></h4><ul><li><strong>포트 & 어댑터 (Ports & Adapters)</strong> 기반 설계: 애플리케이션이 외부와 소통하는 <strong>포트</strong>는 인터페이스로 정의되고, 이를 구현하는 <strong>어댑터</strong>를 통해 실제 시스템에 연결됨</li><li><strong>의존성 반전 (Dependency Inversion Principle)</strong>: 핵심 비즈니스 로직 (도메인) 은 외부 구현에 의존하지 않으며, 의존은 내부로 향하는 방향만 허용</li><li><strong>내부 코어 보호</strong>: 핵심 도메인 엔티티와 Use Case 는 인프라와 철저히 분리되어 변동에 무관한 안정성 제공</li></ul><pre class=mermaid>graph TD
    subgraph &#34;Infrastructure Layer&#34;
        A[Web Controllers]
        E[Database Adapters]
        F[External APIs]
    end
    
    subgraph &#34;Application Layer&#34;
        B[Use Cases]
        G[Application Services]
    end
    
    subgraph &#34;Domain Layer&#34;
        C[Entities]
        H[Value Objects]
        I[Domain Services]
    end
    
    A --&gt; B
    B --&gt; C
    B --&gt; H
    B --&gt; I
    E -.-&gt; B
    F -.-&gt; B
</pre><p><strong>작동 방식</strong>:</p><ol><li>외부 요청이 Infrastructure Layer 의 어댑터로 진입</li><li>Application Layer 에서 유스케이스 조정</li><li>Domain Layer 의 비즈니스 객체들이 협업하여 처리</li><li>Infrastructure Layer 를 통한 외부 시스템 연동</li></ol><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><h4 id=전통적-구조>전통적 구조<a hidden class=anchor aria-hidden=true href=#전통적-구조>#</a></h4><table><thead><tr><th>구분</th><th>계층 (Layer)</th><th>주요 구성요소</th><th>설명</th></tr></thead><tbody><tr><td><strong>필수</strong></td><td>Presentation Layer</td><td>- MVC Controller<br>- View Template</td><td>사용자 입력 처리, 화면 렌더링, UI 흐름 제어</td></tr><tr><td></td><td>Business Layer</td><td>- Service Class<br>- Business Logic</td><td>도메인 로직 실행, 유스케이스 조정</td></tr><tr><td></td><td>Data Access Layer</td><td>- Repository<br>- DAO (Data Access Object)</td><td>DB 접근 추상화, 데이터 조회/저장 처리</td></tr><tr><td></td><td>Database Layer</td><td>- RDBMS (MySQL, PostgreSQL 등)</td><td>실제 데이터 저장소, 영속성 관리</td></tr><tr><td><strong>선택적</strong></td><td>Service Layer (중첩적 계층)</td><td>- Transaction Manager<br>- Auth Service 등</td><td>트랜잭션 경계 처리, 보안/권한 처리</td></tr><tr><td></td><td>Integration Layer</td><td>- API Client<br>- Messaging Adapter</td><td>외부 API, 메시징 시스템 (Kafka 등) 과의 연동 관리</td></tr></tbody></table><pre class=mermaid>graph TD
    A[&#34;Presentation Layer&lt;br/&gt;(Controller, View)&#34;] --&gt; B[&#34;Business Layer&lt;br/&gt;(Service, Logic)&#34;]
    B --&gt; C[&#34;Data Access Layer&lt;br/&gt;(Repository, DAO)&#34;]
    C --&gt; D[&#34;Database Layer&lt;br/&gt;(RDBMS)&#34;]
    B --&gt; E[&#34;Integration Layer&lt;br/&gt;(API, Messaging)&#34;]:::optional

    classDef optional fill:#fdf6e3,stroke:#ccc,stroke-dasharray: 5 5;
</pre><h4 id=현대적-구조>현대적 구조<a hidden class=anchor aria-hidden=true href=#현대적-구조>#</a></h4><table><thead><tr><th>구분</th><th>계층 (Layer)</th><th>주요 구성요소</th><th>설명</th></tr></thead><tbody><tr><td><strong>필수</strong></td><td><strong>Domain Layer</strong></td><td>- Entity<br>- Value Object<br>- Domain Service</td><td>핵심 비즈니스 규칙과 모델을 표현하는 계층. 불변성과 도메인 로직을 책임짐</td></tr><tr><td></td><td><strong>Application Layer</strong></td><td>- Use Case<br>- Application Service</td><td>도메인 모델을 orchestration 하는 계층. 트랜잭션 경계 설정 및 흐름 조정</td></tr><tr><td></td><td><strong>Infrastructure Layer</strong></td><td>- Adapter (DB, API)<br>- Repository Impl.</td><td>기술 세부사항을 담당하는 계층. 외부 시스템과의 연결 및 구현 포함</td></tr><tr><td><strong>선택적</strong></td><td><strong>Anti-Corruption Layer</strong></td><td>- ACL Adapter<br>- Translator</td><td>레거시 시스템과의 연동 시 도메인 오염 방지를 위한 계층</td></tr><tr><td></td><td><strong>Event Layer</strong></td><td>- Domain Event<br>- Event Publisher/Handler</td><td>도메인 내 이벤트 기반 처리 및 외부 통합을 위한 이벤트 발행/구독 구조</td></tr></tbody></table><pre class=mermaid>graph TD
    subgraph Infrastructure Layer
        INFRA_DB[DB Adapter]
        INFRA_API[External API Adapter]
        INFRA_REPO[Repository Implementation]
        ACL[Anti-Corruption Layer]:::optional
        EVENTS[&#34;Event Layer (Publisher/Handler)&#34;]:::optional
    end

    subgraph Application Layer
        USECASE[Use Case]
        APP_SERVICE[Application Service]
    end

    subgraph Domain Layer
        ENTITY[Entities / Value Objects]
        DOMAIN_SERVICE[Domain Services]
    end

    INFRA_DB --&gt; USECASE
    INFRA_API --&gt; USECASE
    INFRA_REPO --&gt; USECASE
    ACL --&gt; USECASE
    EVENTS --&gt; USECASE

    USECASE --&gt; ENTITY
    USECASE --&gt; DOMAIN_SERVICE

    classDef optional fill:#fdf6e3,stroke:#aaa,stroke-dasharray: 5 5;
</pre><h3 id=전통-vs-현대-layered-architecture-비교>전통 vs. 현대 Layered Architecture 비교<a hidden class=anchor aria-hidden=true href=#전통-vs-현대-layered-architecture-비교>#</a></h3><table><thead><tr><th>구분</th><th>전통적 Layered Architecture</th><th>현대적 Layered Architecture (Hexagonal/Clean/Onion)</th></tr></thead><tbody><tr><td>구조 및 구성 요소</td><td>Presentation → Business → Data Access 계층</td><td>Domain(Core) → Application → Ports → Adapters → Infrastructure</td></tr><tr><td>의존성 방향</td><td>위→아래 단방향, BLL 이 DAL 에 직접 의존</td><td>의존성 반전 원칙 적용: 외부가 내부에 의존, 핵심은 외부 구현 모름</td></tr><tr><td>계층 간 관계</td><td>일방향, 단방향</td><td>동적, 양방향/서비스지향</td></tr><tr><td>결합도</td><td>높음 (잘못 구현시)</td><td>최소화 (의존성 감소)</td></tr><tr><td>테스트 편의성</td><td>BLL 테스트 시 실제 DB 필요하거나 모킹 복잡</td><td>내부 도메인을 외부와 격리해 단일 계층 유닛 테스트 용이</td></tr><tr><td>인프라 독립성</td><td>DAL 구현에 따라 전체 연쇄 영향</td><td>포트와 어댑터로 인프라 교체 가능, 핵심 로직에 영향 없음</td></tr><tr><td>확장 및 유지보수</td><td>계층 경계를 넘어선 통합이 어려움, 무거운 변경</td><td>새로운 어댑터 추가, 기술 변화 대응 쉽고 모듈화 선명</td></tr><tr><td>복잡도 수준</td><td>초기 설계 단순, 작은 프로젝트에 적합</td><td>구조 복잡, 설정 부담, 팀 수준 맞춤 필요</td></tr><tr><td>도전과제</td><td>복잡성 증가시 관리 어려움</td><td>분산, 오케스트레이션</td></tr></tbody></table><h3 id=구현-기법-및-방법>구현 기법 및 방법<a hidden class=anchor aria-hidden=true href=#구현-기법-및-방법>#</a></h3><p>Layered Architecture 의 구현 기법은 시대적 변화와 함께 <strong>전통적 접근법</strong>에서 <strong>현대적 접근법</strong>으로 진화해왔다. 이 변화의 핵심은 <strong>기술 중심적 설계</strong>에서 <strong>도메인 중심적 설계</strong>로의 패러다임 전환이다.</p><table><thead><tr><th>구분</th><th>전통적 구현 기법</th><th>현대적 구현 기법</th></tr></thead><tbody><tr><td>구조</td><td>기술 중심 계층화</td><td>유스케이스/도메인 중심 계층화</td></tr><tr><td>대표 설계 패턴</td><td>MVC, 3-Tier</td><td>Clean, Hexagonal, Onion</td></tr><tr><td>계층간 의존성</td><td>단방향 (상위 → 하위)</td><td>DIP 기반 인터페이스 역전</td></tr><tr><td>트랜잭션 처리</td><td>Service 계층에서 처리</td><td>Application 계층에서 UseCase 단위로 처리</td></tr><tr><td>외부 시스템 연동</td><td>Controller 또는 Service 에서 직접 호출</td><td>Adapter 를 통해 분리</td></tr><tr><td>테스트 전략</td><td>통합 테스트 위주</td><td>단위/통합 테스트 분리, Mocking 기반</td></tr><tr><td>배포 구조</td><td>모놀리식 또는 수직 계층화된 서버</td><td>각 계층 또는 유스케이스 기반의 마이크로서비스화 가능</td></tr></tbody></table><h4 id=전통적-layered-architecture-구현-기법>전통적 Layered Architecture 구현 기법<a hidden class=anchor aria-hidden=true href=#전통적-layered-architecture-구현-기법>#</a></h4><ul><li><strong>기술적 관심사 중심</strong>: 데이터베이스, UI, 비즈니스 로직 등 기술적 요소로 분리</li><li><strong>하향식 의존성</strong>: 상위 계층이 하위 계층에 의존 (UI → Business → Data → Database)</li><li><strong>데이터베이스 중심 설계</strong>: 데이터 모델이 아키텍처의 출발점</li></ul><h5 id=구조적-구현-패턴>구조적 구현 패턴<a hidden class=anchor aria-hidden=true href=#구조적-구현-패턴>#</a></h5><h6 id=기본-3-tier-구조>기본 3-Tier 구조<a hidden class=anchor aria-hidden=true href=#기본-3-tier-구조>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-29-1><a class=lnlinks href=#hl-29-1> 1</a>
</span><span class=lnt id=hl-29-2><a class=lnlinks href=#hl-29-2> 2</a>
</span><span class=lnt id=hl-29-3><a class=lnlinks href=#hl-29-3> 3</a>
</span><span class=lnt id=hl-29-4><a class=lnlinks href=#hl-29-4> 4</a>
</span><span class=lnt id=hl-29-5><a class=lnlinks href=#hl-29-5> 5</a>
</span><span class=lnt id=hl-29-6><a class=lnlinks href=#hl-29-6> 6</a>
</span><span class=lnt id=hl-29-7><a class=lnlinks href=#hl-29-7> 7</a>
</span><span class=lnt id=hl-29-8><a class=lnlinks href=#hl-29-8> 8</a>
</span><span class=lnt id=hl-29-9><a class=lnlinks href=#hl-29-9> 9</a>
</span><span class=lnt id=hl-29-10><a class=lnlinks href=#hl-29-10>10</a>
</span><span class=lnt id=hl-29-11><a class=lnlinks href=#hl-29-11>11</a>
</span><span class=lnt id=hl-29-12><a class=lnlinks href=#hl-29-12>12</a>
</span><span class=lnt id=hl-29-13><a class=lnlinks href=#hl-29-13>13</a>
</span><span class=lnt id=hl-29-14><a class=lnlinks href=#hl-29-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 전통적 3계층 구조</span>
</span></span><span class=line><span class=cl><span class=n>src</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>controllers</span><span class=o>/</span>          <span class=c1># Presentation Layer</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>UserController</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=n>OrderController</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>services</span><span class=o>/</span>            <span class=c1># Business Layer  </span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>UserService</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=n>OrderService</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>repositories</span><span class=o>/</span>        <span class=c1># Data Access Layer</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>UserRepository</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=n>OrderRepository</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>└──</span> <span class=n>models</span><span class=o>/</span>             <span class=c1># Data Models</span>
</span></span><span class=line><span class=cl>    <span class=err>├──</span> <span class=n>User</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>    <span class=err>└──</span> <span class=n>Order</span><span class=o>.</span><span class=n>py</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=mvc-패턴-구현>MVC 패턴 구현<a hidden class=anchor aria-hidden=true href=#mvc-패턴-구현>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-30-1><a class=lnlinks href=#hl-30-1> 1</a>
</span><span class=lnt id=hl-30-2><a class=lnlinks href=#hl-30-2> 2</a>
</span><span class=lnt id=hl-30-3><a class=lnlinks href=#hl-30-3> 3</a>
</span><span class=lnt id=hl-30-4><a class=lnlinks href=#hl-30-4> 4</a>
</span><span class=lnt id=hl-30-5><a class=lnlinks href=#hl-30-5> 5</a>
</span><span class=lnt id=hl-30-6><a class=lnlinks href=#hl-30-6> 6</a>
</span><span class=lnt id=hl-30-7><a class=lnlinks href=#hl-30-7> 7</a>
</span><span class=lnt id=hl-30-8><a class=lnlinks href=#hl-30-8> 8</a>
</span><span class=lnt id=hl-30-9><a class=lnlinks href=#hl-30-9> 9</a>
</span><span class=lnt id=hl-30-10><a class=lnlinks href=#hl-30-10>10</a>
</span><span class=lnt id=hl-30-11><a class=lnlinks href=#hl-30-11>11</a>
</span><span class=lnt id=hl-30-12><a class=lnlinks href=#hl-30-12>12</a>
</span><span class=lnt id=hl-30-13><a class=lnlinks href=#hl-30-13>13</a>
</span><span class=lnt id=hl-30-14><a class=lnlinks href=#hl-30-14>14</a>
</span><span class=lnt id=hl-30-15><a class=lnlinks href=#hl-30-15>15</a>
</span><span class=lnt id=hl-30-16><a class=lnlinks href=#hl-30-16>16</a>
</span><span class=lnt id=hl-30-17><a class=lnlinks href=#hl-30-17>17</a>
</span><span class=lnt id=hl-30-18><a class=lnlinks href=#hl-30-18>18</a>
</span><span class=lnt id=hl-30-19><a class=lnlinks href=#hl-30-19>19</a>
</span><span class=lnt id=hl-30-20><a class=lnlinks href=#hl-30-20>20</a>
</span><span class=lnt id=hl-30-21><a class=lnlinks href=#hl-30-21>21</a>
</span><span class=lnt id=hl-30-22><a class=lnlinks href=#hl-30-22>22</a>
</span><span class=lnt id=hl-30-23><a class=lnlinks href=#hl-30-23>23</a>
</span><span class=lnt id=hl-30-24><a class=lnlinks href=#hl-30-24>24</a>
</span><span class=lnt id=hl-30-25><a class=lnlinks href=#hl-30-25>25</a>
</span><span class=lnt id=hl-30-26><a class=lnlinks href=#hl-30-26>26</a>
</span><span class=lnt id=hl-30-27><a class=lnlinks href=#hl-30-27>27</a>
</span><span class=lnt id=hl-30-28><a class=lnlinks href=#hl-30-28>28</a>
</span><span class=lnt id=hl-30-29><a class=lnlinks href=#hl-30-29>29</a>
</span><span class=lnt id=hl-30-30><a class=lnlinks href=#hl-30-30>30</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Controller (Presentation Layer)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UserController</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_service</span> <span class=o>=</span> <span class=n>UserService</span><span class=p>()</span>  <span class=c1># 직접 의존성 생성</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_user</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>user_data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>user_service</span><span class=o>.</span><span class=n>create_user</span><span class=p>(</span><span class=n>user_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=n>user</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=n>user</span><span class=o>.</span><span class=n>name</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Service (Business Layer)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UserService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_repository</span> <span class=o>=</span> <span class=n>UserRepository</span><span class=p>()</span>  <span class=c1># 직접 의존성 생성</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_user</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 간단한 비즈니스 로직</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=n>User</span><span class=p>(</span><span class=n>user_data</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>],</span> <span class=n>user_data</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>user_repository</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Repository (Data Access Layer)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UserRepository</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db_connection</span> <span class=o>=</span> <span class=n>get_db_connection</span><span class=p>()</span>  <span class=c1># 직접 DB 연결</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>save</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 직접 SQL 실행</span>
</span></span><span class=line><span class=cl>        <span class=n>query</span> <span class=o>=</span> <span class=s2>&#34;INSERT INTO users (name, email) VALUES (?, ?)&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db_connection</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=p>(</span><span class=n>user</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=n>user</span><span class=o>.</span><span class=n>email</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>user</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=의존성-관리-방식>의존성 관리 방식<a hidden class=anchor aria-hidden=true href=#의존성-관리-방식>#</a></h5><h6 id=직접-의존성-생성>직접 의존성 생성<a hidden class=anchor aria-hidden=true href=#직접-의존성-생성>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-31-1><a class=lnlinks href=#hl-31-1>1</a>
</span><span class=lnt id=hl-31-2><a class=lnlinks href=#hl-31-2>2</a>
</span><span class=lnt id=hl-31-3><a class=lnlinks href=#hl-31-3>3</a>
</span><span class=lnt id=hl-31-4><a class=lnlinks href=#hl-31-4>4</a>
</span><span class=lnt id=hl-31-5><a class=lnlinks href=#hl-31-5>5</a>
</span><span class=lnt id=hl-31-6><a class=lnlinks href=#hl-31-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 전통적 방식: 클래스 내부에서 의존성 직접 생성</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_repository</span> <span class=o>=</span> <span class=n>UserRepository</span><span class=p>()</span>      <span class=c1># 강한 결합</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>product_repository</span> <span class=o>=</span> <span class=n>ProductRepository</span><span class=p>()</span> <span class=c1># 강한 결합</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>email_service</span> <span class=o>=</span> <span class=n>EmailService</span><span class=p>()</span>          <span class=c1># 강한 결합</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=factory-패턴-활용>Factory 패턴 활용<a hidden class=anchor aria-hidden=true href=#factory-패턴-활용>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-32-1><a class=lnlinks href=#hl-32-1> 1</a>
</span><span class=lnt id=hl-32-2><a class=lnlinks href=#hl-32-2> 2</a>
</span><span class=lnt id=hl-32-3><a class=lnlinks href=#hl-32-3> 3</a>
</span><span class=lnt id=hl-32-4><a class=lnlinks href=#hl-32-4> 4</a>
</span><span class=lnt id=hl-32-5><a class=lnlinks href=#hl-32-5> 5</a>
</span><span class=lnt id=hl-32-6><a class=lnlinks href=#hl-32-6> 6</a>
</span><span class=lnt id=hl-32-7><a class=lnlinks href=#hl-32-7> 7</a>
</span><span class=lnt id=hl-32-8><a class=lnlinks href=#hl-32-8> 8</a>
</span><span class=lnt id=hl-32-9><a class=lnlinks href=#hl-32-9> 9</a>
</span><span class=lnt id=hl-32-10><a class=lnlinks href=#hl-32-10>10</a>
</span><span class=lnt id=hl-32-11><a class=lnlinks href=#hl-32-11>11</a>
</span><span class=lnt id=hl-32-12><a class=lnlinks href=#hl-32-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Factory를 통한 객체 생성</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ServiceFactory</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_user_service</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>repository</span> <span class=o>=</span> <span class=n>UserRepository</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>UserService</span><span class=p>(</span><span class=n>repository</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_order_service</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>user_repo</span> <span class=o>=</span> <span class=n>UserRepository</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>product_repo</span> <span class=o>=</span> <span class=n>ProductRepository</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>OrderService</span><span class=p>(</span><span class=n>user_repo</span><span class=p>,</span> <span class=n>product_repo</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=데이터-처리-방식>데이터 처리 방식<a hidden class=anchor aria-hidden=true href=#데이터-처리-방식>#</a></h5><h6 id=직접-데이터-전달>직접 데이터 전달<a hidden class=anchor aria-hidden=true href=#직접-데이터-전달>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-33-1><a class=lnlinks href=#hl-33-1>1</a>
</span><span class=lnt id=hl-33-2><a class=lnlinks href=#hl-33-2>2</a>
</span><span class=lnt id=hl-33-3><a class=lnlinks href=#hl-33-3>3</a>
</span><span class=lnt id=hl-33-4><a class=lnlinks href=#hl-33-4>4</a>
</span><span class=lnt id=hl-33-5><a class=lnlinks href=#hl-33-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 계층 간 도메인 객체 직접 전달</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UserController</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_user</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>user_service</span><span class=o>.</span><span class=n>get_user</span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span>  <span class=c1># 도메인 객체 직접 반환</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>user</span>  <span class=c1># 도메인 노출</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=active-record-패턴>Active Record 패턴<a hidden class=anchor aria-hidden=true href=#active-record-패턴>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-34-1><a class=lnlinks href=#hl-34-1> 1</a>
</span><span class=lnt id=hl-34-2><a class=lnlinks href=#hl-34-2> 2</a>
</span><span class=lnt id=hl-34-3><a class=lnlinks href=#hl-34-3> 3</a>
</span><span class=lnt id=hl-34-4><a class=lnlinks href=#hl-34-4> 4</a>
</span><span class=lnt id=hl-34-5><a class=lnlinks href=#hl-34-5> 5</a>
</span><span class=lnt id=hl-34-6><a class=lnlinks href=#hl-34-6> 6</a>
</span><span class=lnt id=hl-34-7><a class=lnlinks href=#hl-34-7> 7</a>
</span><span class=lnt id=hl-34-8><a class=lnlinks href=#hl-34-8> 8</a>
</span><span class=lnt id=hl-34-9><a class=lnlinks href=#hl-34-9> 9</a>
</span><span class=lnt id=hl-34-10><a class=lnlinks href=#hl-34-10>10</a>
</span><span class=lnt id=hl-34-11><a class=lnlinks href=#hl-34-11>11</a>
</span><span class=lnt id=hl-34-12><a class=lnlinks href=#hl-34-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 데이터와 비즈니스 로직이 혼재</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>email</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>email</span> <span class=o>=</span> <span class=n>email</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>save</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>  <span class=c1># 비즈니스 객체가 영속성 책임도 가짐</span>
</span></span><span class=line><span class=cl>        <span class=n>db</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;INSERT INTO users (name, email) VALUES (?, ?)&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                  <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>email</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>validate_email</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>  <span class=c1># 비즈니스 로직</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;@&#39;</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>email</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=현대적-layered-architecture-구현-기법>현대적 Layered Architecture 구현 기법<a hidden class=anchor aria-hidden=true href=#현대적-layered-architecture-구현-기법>#</a></h4><ul><li><strong>도메인 중심 설계</strong>: 비즈니스 도메인이 아키텍처의 중심</li><li><strong>의존성 역전</strong>: 외부 계층이 내부 (도메인) 계층에 의존</li><li><strong>관심사의 명확한 분리</strong>: DDD 원칙 적용</li></ul><p>현대적 Layered Architecture 는 전통적 접근법의 한계를 극복하고 다음과 같은 이점을 제공한다:</p><ol><li><strong>비즈니스 중심성</strong>: 도메인이 기술적 세부사항으로부터 독립</li><li><strong>테스트 용이성</strong>: 의존성 주입을 통한 격리된 단위 테스트</li><li><strong>유연성</strong>: 인터페이스 기반 설계로 구현체 교체 가능</li><li><strong>확장성</strong>: 마이크로서비스로의 자연스러운 전환 지원</li><li><strong>유지보수성</strong>: 명확한 관심사 분리와 단일 책임 원칙 준수</li></ol><p>이러한 변화는 단순한 기술적 개선이 아닌, 소프트웨어 개발 패러다임의 근본적 전환을 의미한다.</p><h5 id=domain-centric-구조적-구현>Domain-Centric 구조적 구현<a hidden class=anchor aria-hidden=true href=#domain-centric-구조적-구현>#</a></h5><h6 id=clean-architecture-기반-구조>Clean Architecture 기반 구조<a hidden class=anchor aria-hidden=true href=#clean-architecture-기반-구조>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-35-1><a class=lnlinks href=#hl-35-1> 1</a>
</span><span class=lnt id=hl-35-2><a class=lnlinks href=#hl-35-2> 2</a>
</span><span class=lnt id=hl-35-3><a class=lnlinks href=#hl-35-3> 3</a>
</span><span class=lnt id=hl-35-4><a class=lnlinks href=#hl-35-4> 4</a>
</span><span class=lnt id=hl-35-5><a class=lnlinks href=#hl-35-5> 5</a>
</span><span class=lnt id=hl-35-6><a class=lnlinks href=#hl-35-6> 6</a>
</span><span class=lnt id=hl-35-7><a class=lnlinks href=#hl-35-7> 7</a>
</span><span class=lnt id=hl-35-8><a class=lnlinks href=#hl-35-8> 8</a>
</span><span class=lnt id=hl-35-9><a class=lnlinks href=#hl-35-9> 9</a>
</span><span class=lnt id=hl-35-10><a class=lnlinks href=#hl-35-10>10</a>
</span><span class=lnt id=hl-35-11><a class=lnlinks href=#hl-35-11>11</a>
</span><span class=lnt id=hl-35-12><a class=lnlinks href=#hl-35-12>12</a>
</span><span class=lnt id=hl-35-13><a class=lnlinks href=#hl-35-13>13</a>
</span><span class=lnt id=hl-35-14><a class=lnlinks href=#hl-35-14>14</a>
</span><span class=lnt id=hl-35-15><a class=lnlinks href=#hl-35-15>15</a>
</span><span class=lnt id=hl-35-16><a class=lnlinks href=#hl-35-16>16</a>
</span><span class=lnt id=hl-35-17><a class=lnlinks href=#hl-35-17>17</a>
</span><span class=lnt id=hl-35-18><a class=lnlinks href=#hl-35-18>18</a>
</span><span class=lnt id=hl-35-19><a class=lnlinks href=#hl-35-19>19</a>
</span><span class=lnt id=hl-35-20><a class=lnlinks href=#hl-35-20>20</a>
</span><span class=lnt id=hl-35-21><a class=lnlinks href=#hl-35-21>21</a>
</span><span class=lnt id=hl-35-22><a class=lnlinks href=#hl-35-22>22</a>
</span><span class=lnt id=hl-35-23><a class=lnlinks href=#hl-35-23>23</a>
</span><span class=lnt id=hl-35-24><a class=lnlinks href=#hl-35-24>24</a>
</span><span class=lnt id=hl-35-25><a class=lnlinks href=#hl-35-25>25</a>
</span><span class=lnt id=hl-35-26><a class=lnlinks href=#hl-35-26>26</a>
</span><span class=lnt id=hl-35-27><a class=lnlinks href=#hl-35-27>27</a>
</span><span class=lnt id=hl-35-28><a class=lnlinks href=#hl-35-28>28</a>
</span><span class=lnt id=hl-35-29><a class=lnlinks href=#hl-35-29>29</a>
</span><span class=lnt id=hl-35-30><a class=lnlinks href=#hl-35-30>30</a>
</span><span class=lnt id=hl-35-31><a class=lnlinks href=#hl-35-31>31</a>
</span><span class=lnt id=hl-35-32><a class=lnlinks href=#hl-35-32>32</a>
</span><span class=lnt id=hl-35-33><a class=lnlinks href=#hl-35-33>33</a>
</span><span class=lnt id=hl-35-34><a class=lnlinks href=#hl-35-34>34</a>
</span><span class=lnt id=hl-35-35><a class=lnlinks href=#hl-35-35>35</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 현대적 도메인 중심 구조</span>
</span></span><span class=line><span class=cl><span class=n>src</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>domain</span><span class=o>/</span>                    <span class=c1># Domain Layer (중심)</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>entities</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>User</span><span class=o>.</span><span class=n>py</span>           <span class=c1># 비즈니스 엔티티</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>Order</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>value_objects</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>Email</span><span class=o>.</span><span class=n>py</span>          <span class=c1># 값 객체</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>services</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>OrderDomainService</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=n>repositories</span><span class=o>/</span>          <span class=c1># 인터페이스만</span>
</span></span><span class=line><span class=cl><span class=err>│</span>       <span class=err>└──</span> <span class=n>IUserRepository</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>application</span><span class=o>/</span>               <span class=c1># Application Layer</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>use_cases</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>CreateUserUseCase</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>ProcessOrderUseCase</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>dtos</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>CreateUserRequest</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>UserResponse</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=n>services</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>       <span class=err>└──</span> <span class=n>ApplicationService</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>infrastructure</span><span class=o>/</span>            <span class=c1># Infrastructure Layer</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>repositories</span><span class=o>/</span>          <span class=c1># 구현체</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>SqlUserRepository</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>MongoOrderRepository</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>external_services</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>EmailService</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=n>persistence</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>       <span class=err>└──</span> <span class=n>database</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>└──</span> <span class=n>presentation</span><span class=o>/</span>              <span class=c1># Presentation Layer</span>
</span></span><span class=line><span class=cl>    <span class=err>├──</span> <span class=n>api</span><span class=o>/</span>
</span></span><span class=line><span class=cl>    <span class=err>│</span>   <span class=err>├──</span> <span class=n>UserController</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>    <span class=err>│</span>   <span class=err>└──</span> <span class=n>OrderController</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>    <span class=err>└──</span> <span class=n>cli</span><span class=o>/</span>
</span></span><span class=line><span class=cl>        <span class=err>└──</span> <span class=n>UserCLI</span><span class=o>.</span><span class=n>py</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=rich-domain-model-구현>Rich Domain Model 구현<a hidden class=anchor aria-hidden=true href=#rich-domain-model-구현>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-36-1><a class=lnlinks href=#hl-36-1> 1</a>
</span><span class=lnt id=hl-36-2><a class=lnlinks href=#hl-36-2> 2</a>
</span><span class=lnt id=hl-36-3><a class=lnlinks href=#hl-36-3> 3</a>
</span><span class=lnt id=hl-36-4><a class=lnlinks href=#hl-36-4> 4</a>
</span><span class=lnt id=hl-36-5><a class=lnlinks href=#hl-36-5> 5</a>
</span><span class=lnt id=hl-36-6><a class=lnlinks href=#hl-36-6> 6</a>
</span><span class=lnt id=hl-36-7><a class=lnlinks href=#hl-36-7> 7</a>
</span><span class=lnt id=hl-36-8><a class=lnlinks href=#hl-36-8> 8</a>
</span><span class=lnt id=hl-36-9><a class=lnlinks href=#hl-36-9> 9</a>
</span><span class=lnt id=hl-36-10><a class=lnlinks href=#hl-36-10>10</a>
</span><span class=lnt id=hl-36-11><a class=lnlinks href=#hl-36-11>11</a>
</span><span class=lnt id=hl-36-12><a class=lnlinks href=#hl-36-12>12</a>
</span><span class=lnt id=hl-36-13><a class=lnlinks href=#hl-36-13>13</a>
</span><span class=lnt id=hl-36-14><a class=lnlinks href=#hl-36-14>14</a>
</span><span class=lnt id=hl-36-15><a class=lnlinks href=#hl-36-15>15</a>
</span><span class=lnt id=hl-36-16><a class=lnlinks href=#hl-36-16>16</a>
</span><span class=lnt id=hl-36-17><a class=lnlinks href=#hl-36-17>17</a>
</span><span class=lnt id=hl-36-18><a class=lnlinks href=#hl-36-18>18</a>
</span><span class=lnt id=hl-36-19><a class=lnlinks href=#hl-36-19>19</a>
</span><span class=lnt id=hl-36-20><a class=lnlinks href=#hl-36-20>20</a>
</span><span class=lnt id=hl-36-21><a class=lnlinks href=#hl-36-21>21</a>
</span><span class=lnt id=hl-36-22><a class=lnlinks href=#hl-36-22>22</a>
</span><span class=lnt id=hl-36-23><a class=lnlinks href=#hl-36-23>23</a>
</span><span class=lnt id=hl-36-24><a class=lnlinks href=#hl-36-24>24</a>
</span><span class=lnt id=hl-36-25><a class=lnlinks href=#hl-36-25>25</a>
</span><span class=lnt id=hl-36-26><a class=lnlinks href=#hl-36-26>26</a>
</span><span class=lnt id=hl-36-27><a class=lnlinks href=#hl-36-27>27</a>
</span><span class=lnt id=hl-36-28><a class=lnlinks href=#hl-36-28>28</a>
</span><span class=lnt id=hl-36-29><a class=lnlinks href=#hl-36-29>29</a>
</span><span class=lnt id=hl-36-30><a class=lnlinks href=#hl-36-30>30</a>
</span><span class=lnt id=hl-36-31><a class=lnlinks href=#hl-36-31>31</a>
</span><span class=lnt id=hl-36-32><a class=lnlinks href=#hl-36-32>32</a>
</span><span class=lnt id=hl-36-33><a class=lnlinks href=#hl-36-33>33</a>
</span><span class=lnt id=hl-36-34><a class=lnlinks href=#hl-36-34>34</a>
</span><span class=lnt id=hl-36-35><a class=lnlinks href=#hl-36-35>35</a>
</span><span class=lnt id=hl-36-36><a class=lnlinks href=#hl-36-36>36</a>
</span><span class=lnt id=hl-36-37><a class=lnlinks href=#hl-36-37>37</a>
</span><span class=lnt id=hl-36-38><a class=lnlinks href=#hl-36-38>38</a>
</span><span class=lnt id=hl-36-39><a class=lnlinks href=#hl-36-39>39</a>
</span><span class=lnt id=hl-36-40><a class=lnlinks href=#hl-36-40>40</a>
</span><span class=lnt id=hl-36-41><a class=lnlinks href=#hl-36-41>41</a>
</span><span class=lnt id=hl-36-42><a class=lnlinks href=#hl-36-42>42</a>
</span><span class=lnt id=hl-36-43><a class=lnlinks href=#hl-36-43>43</a>
</span><span class=lnt id=hl-36-44><a class=lnlinks href=#hl-36-44>44</a>
</span><span class=lnt id=hl-36-45><a class=lnlinks href=#hl-36-45>45</a>
</span><span class=lnt id=hl-36-46><a class=lnlinks href=#hl-36-46>46</a>
</span><span class=lnt id=hl-36-47><a class=lnlinks href=#hl-36-47>47</a>
</span><span class=lnt id=hl-36-48><a class=lnlinks href=#hl-36-48>48</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Domain Layer - 비즈니스 중심 엔티티</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABC</span><span class=p>,</span> <span class=n>abstractmethod</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>.value_objects</span> <span class=kn>import</span> <span class=n>Email</span><span class=p>,</span> <span class=n>Money</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Rich Domain Entity - 비즈니스 로직 포함&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>email</span><span class=p>:</span> <span class=n>Email</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_id</span> <span class=o>=</span> <span class=n>user_id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_name</span> <span class=o>=</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_email</span> <span class=o>=</span> <span class=n>email</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_orders</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Order</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_is_active</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>change_email</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>new_email</span><span class=p>:</span> <span class=n>Email</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;비즈니스 규칙: 이메일 변경&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_is_active</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Inactive user cannot change email&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_email</span> <span class=o>=</span> <span class=n>new_email</span>
</span></span><span class=line><span class=cl>        <span class=c1># 도메인 이벤트 발생</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_domain_events</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>UserEmailChanged</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_id</span><span class=p>,</span> <span class=n>new_email</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>can_place_order</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_amount</span><span class=p>:</span> <span class=n>Money</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;비즈니스 규칙: 주문 가능 여부&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_is_active</span> <span class=ow>and</span> 
</span></span><span class=line><span class=cl>                <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_orders</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>10</span> <span class=ow>and</span> 
</span></span><span class=line><span class=cl>                <span class=n>order_amount</span><span class=o>.</span><span class=n>amount</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Value Object</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Email</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;값 객체 - 불변성과 유효성 보장&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_is_valid</span><span class=p>(</span><span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Invalid email: </span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_value</span> <span class=o>=</span> <span class=n>value</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@property</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>value</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_value</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_is_valid</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>email</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;@&#39;</span> <span class=ow>in</span> <span class=n>email</span> <span class=ow>and</span> <span class=s1>&#39;.&#39;</span> <span class=ow>in</span> <span class=n>email</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;@&#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__eq__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>other</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>other</span><span class=p>,</span> <span class=n>Email</span><span class=p>)</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>_value</span> <span class=o>==</span> <span class=n>other</span><span class=o>.</span><span class=n>_value</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=의존성-주입-및-제어-역전>의존성 주입 및 제어 역전<a hidden class=anchor aria-hidden=true href=#의존성-주입-및-제어-역전>#</a></h5><h6 id=interface-기반-설계>Interface 기반 설계<a hidden class=anchor aria-hidden=true href=#interface-기반-설계>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-37-1><a class=lnlinks href=#hl-37-1> 1</a>
</span><span class=lnt id=hl-37-2><a class=lnlinks href=#hl-37-2> 2</a>
</span><span class=lnt id=hl-37-3><a class=lnlinks href=#hl-37-3> 3</a>
</span><span class=lnt id=hl-37-4><a class=lnlinks href=#hl-37-4> 4</a>
</span><span class=lnt id=hl-37-5><a class=lnlinks href=#hl-37-5> 5</a>
</span><span class=lnt id=hl-37-6><a class=lnlinks href=#hl-37-6> 6</a>
</span><span class=lnt id=hl-37-7><a class=lnlinks href=#hl-37-7> 7</a>
</span><span class=lnt id=hl-37-8><a class=lnlinks href=#hl-37-8> 8</a>
</span><span class=lnt id=hl-37-9><a class=lnlinks href=#hl-37-9> 9</a>
</span><span class=lnt id=hl-37-10><a class=lnlinks href=#hl-37-10>10</a>
</span><span class=lnt id=hl-37-11><a class=lnlinks href=#hl-37-11>11</a>
</span><span class=lnt id=hl-37-12><a class=lnlinks href=#hl-37-12>12</a>
</span><span class=lnt id=hl-37-13><a class=lnlinks href=#hl-37-13>13</a>
</span><span class=lnt id=hl-37-14><a class=lnlinks href=#hl-37-14>14</a>
</span><span class=lnt id=hl-37-15><a class=lnlinks href=#hl-37-15>15</a>
</span><span class=lnt id=hl-37-16><a class=lnlinks href=#hl-37-16>16</a>
</span><span class=lnt id=hl-37-17><a class=lnlinks href=#hl-37-17>17</a>
</span><span class=lnt id=hl-37-18><a class=lnlinks href=#hl-37-18>18</a>
</span><span class=lnt id=hl-37-19><a class=lnlinks href=#hl-37-19>19</a>
</span><span class=lnt id=hl-37-20><a class=lnlinks href=#hl-37-20>20</a>
</span><span class=lnt id=hl-37-21><a class=lnlinks href=#hl-37-21>21</a>
</span><span class=lnt id=hl-37-22><a class=lnlinks href=#hl-37-22>22</a>
</span><span class=lnt id=hl-37-23><a class=lnlinks href=#hl-37-23>23</a>
</span><span class=lnt id=hl-37-24><a class=lnlinks href=#hl-37-24>24</a>
</span><span class=lnt id=hl-37-25><a class=lnlinks href=#hl-37-25>25</a>
</span><span class=lnt id=hl-37-26><a class=lnlinks href=#hl-37-26>26</a>
</span><span class=lnt id=hl-37-27><a class=lnlinks href=#hl-37-27>27</a>
</span><span class=lnt id=hl-37-28><a class=lnlinks href=#hl-37-28>28</a>
</span><span class=lnt id=hl-37-29><a class=lnlinks href=#hl-37-29>29</a>
</span><span class=lnt id=hl-37-30><a class=lnlinks href=#hl-37-30>30</a>
</span><span class=lnt id=hl-37-31><a class=lnlinks href=#hl-37-31>31</a>
</span><span class=lnt id=hl-37-32><a class=lnlinks href=#hl-37-32>32</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Repository Interface (Domain Layer)</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABC</span><span class=p>,</span> <span class=n>abstractmethod</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Optional</span><span class=p>,</span> <span class=n>List</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>IUserRepository</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Repository 인터페이스 - 도메인 계층에 위치&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>save</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user</span><span class=p>:</span> <span class=n>User</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>User</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>find_by_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>User</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>find_by_email</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>email</span><span class=p>:</span> <span class=n>Email</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>User</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Concrete Implementation (Infrastructure Layer)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SqlUserRepository</span><span class=p>(</span><span class=n>IUserRepository</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;구체적 구현 - 인프라스트럭처 계층&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>session</span><span class=p>:</span> <span class=n>AsyncSession</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_session</span> <span class=o>=</span> <span class=n>session</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>save</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user</span><span class=p>:</span> <span class=n>User</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>User</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># ORM을 통한 영속성 처리</span>
</span></span><span class=line><span class=cl>        <span class=n>user_entity</span> <span class=o>=</span> <span class=n>UserEntity</span><span class=o>.</span><span class=n>from_domain</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_session</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>user_entity</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_session</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>user_entity</span><span class=o>.</span><span class=n>to_domain</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=현대적-di-프레임워크-활용>현대적 DI 프레임워크 활용<a hidden class=anchor aria-hidden=true href=#현대적-di-프레임워크-활용>#</a></h6><p><strong>FastAPI 의존성 주입</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-38-1><a class=lnlinks href=#hl-38-1> 1</a>
</span><span class=lnt id=hl-38-2><a class=lnlinks href=#hl-38-2> 2</a>
</span><span class=lnt id=hl-38-3><a class=lnlinks href=#hl-38-3> 3</a>
</span><span class=lnt id=hl-38-4><a class=lnlinks href=#hl-38-4> 4</a>
</span><span class=lnt id=hl-38-5><a class=lnlinks href=#hl-38-5> 5</a>
</span><span class=lnt id=hl-38-6><a class=lnlinks href=#hl-38-6> 6</a>
</span><span class=lnt id=hl-38-7><a class=lnlinks href=#hl-38-7> 7</a>
</span><span class=lnt id=hl-38-8><a class=lnlinks href=#hl-38-8> 8</a>
</span><span class=lnt id=hl-38-9><a class=lnlinks href=#hl-38-9> 9</a>
</span><span class=lnt id=hl-38-10><a class=lnlinks href=#hl-38-10>10</a>
</span><span class=lnt id=hl-38-11><a class=lnlinks href=#hl-38-11>11</a>
</span><span class=lnt id=hl-38-12><a class=lnlinks href=#hl-38-12>12</a>
</span><span class=lnt id=hl-38-13><a class=lnlinks href=#hl-38-13>13</a>
</span><span class=lnt id=hl-38-14><a class=lnlinks href=#hl-38-14>14</a>
</span><span class=lnt id=hl-38-15><a class=lnlinks href=#hl-38-15>15</a>
</span><span class=lnt id=hl-38-16><a class=lnlinks href=#hl-38-16>16</a>
</span><span class=lnt id=hl-38-17><a class=lnlinks href=#hl-38-17>17</a>
</span><span class=lnt id=hl-38-18><a class=lnlinks href=#hl-38-18>18</a>
</span><span class=lnt id=hl-38-19><a class=lnlinks href=#hl-38-19>19</a>
</span><span class=lnt id=hl-38-20><a class=lnlinks href=#hl-38-20>20</a>
</span><span class=lnt id=hl-38-21><a class=lnlinks href=#hl-38-21>21</a>
</span><span class=lnt id=hl-38-22><a class=lnlinks href=#hl-38-22>22</a>
</span><span class=lnt id=hl-38-23><a class=lnlinks href=#hl-38-23>23</a>
</span><span class=lnt id=hl-38-24><a class=lnlinks href=#hl-38-24>24</a>
</span><span class=lnt id=hl-38-25><a class=lnlinks href=#hl-38-25>25</a>
</span><span class=lnt id=hl-38-26><a class=lnlinks href=#hl-38-26>26</a>
</span><span class=lnt id=hl-38-27><a class=lnlinks href=#hl-38-27>27</a>
</span><span class=lnt id=hl-38-28><a class=lnlinks href=#hl-38-28>28</a>
</span><span class=lnt id=hl-38-29><a class=lnlinks href=#hl-38-29>29</a>
</span><span class=lnt id=hl-38-30><a class=lnlinks href=#hl-38-30>30</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># dependencies.py - DI 설정</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>Depends</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy.ext.asyncio</span> <span class=kn>import</span> <span class=n>AsyncSession</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>get_db_session</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=n>AsyncSession</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>with</span> <span class=n>SessionLocal</span><span class=p>()</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=n>session</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_user_repository</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>session</span><span class=p>:</span> <span class=n>AsyncSession</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>get_db_session</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>IUserRepository</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>SqlUserRepository</span><span class=p>(</span><span class=n>session</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_create_user_use_case</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>user_repository</span><span class=p>:</span> <span class=n>IUserRepository</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>get_user_repository</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>CreateUserUseCase</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>CreateUserUseCase</span><span class=p>(</span><span class=n>user_repository</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># controller.py - DI 사용</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>APIRouter</span><span class=p>,</span> <span class=n>Depends</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>router</span> <span class=o>=</span> <span class=n>APIRouter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@router.post</span><span class=p>(</span><span class=s2>&#34;/users&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>create_user</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=p>:</span> <span class=n>CreateUserRequest</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>use_case</span><span class=p>:</span> <span class=n>CreateUserUseCase</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>get_create_user_use_case</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>use_case</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>UserResponse</span><span class=o>.</span><span class=n>from_domain</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>NestJS 의존성 주입</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-39-1><a class=lnlinks href=#hl-39-1> 1</a>
</span><span class=lnt id=hl-39-2><a class=lnlinks href=#hl-39-2> 2</a>
</span><span class=lnt id=hl-39-3><a class=lnlinks href=#hl-39-3> 3</a>
</span><span class=lnt id=hl-39-4><a class=lnlinks href=#hl-39-4> 4</a>
</span><span class=lnt id=hl-39-5><a class=lnlinks href=#hl-39-5> 5</a>
</span><span class=lnt id=hl-39-6><a class=lnlinks href=#hl-39-6> 6</a>
</span><span class=lnt id=hl-39-7><a class=lnlinks href=#hl-39-7> 7</a>
</span><span class=lnt id=hl-39-8><a class=lnlinks href=#hl-39-8> 8</a>
</span><span class=lnt id=hl-39-9><a class=lnlinks href=#hl-39-9> 9</a>
</span><span class=lnt id=hl-39-10><a class=lnlinks href=#hl-39-10>10</a>
</span><span class=lnt id=hl-39-11><a class=lnlinks href=#hl-39-11>11</a>
</span><span class=lnt id=hl-39-12><a class=lnlinks href=#hl-39-12>12</a>
</span><span class=lnt id=hl-39-13><a class=lnlinks href=#hl-39-13>13</a>
</span><span class=lnt id=hl-39-14><a class=lnlinks href=#hl-39-14>14</a>
</span><span class=lnt id=hl-39-15><a class=lnlinks href=#hl-39-15>15</a>
</span><span class=lnt id=hl-39-16><a class=lnlinks href=#hl-39-16>16</a>
</span><span class=lnt id=hl-39-17><a class=lnlinks href=#hl-39-17>17</a>
</span><span class=lnt id=hl-39-18><a class=lnlinks href=#hl-39-18>18</a>
</span><span class=lnt id=hl-39-19><a class=lnlinks href=#hl-39-19>19</a>
</span><span class=lnt id=hl-39-20><a class=lnlinks href=#hl-39-20>20</a>
</span><span class=lnt id=hl-39-21><a class=lnlinks href=#hl-39-21>21</a>
</span><span class=lnt id=hl-39-22><a class=lnlinks href=#hl-39-22>22</a>
</span><span class=lnt id=hl-39-23><a class=lnlinks href=#hl-39-23>23</a>
</span><span class=lnt id=hl-39-24><a class=lnlinks href=#hl-39-24>24</a>
</span><span class=lnt id=hl-39-25><a class=lnlinks href=#hl-39-25>25</a>
</span><span class=lnt id=hl-39-26><a class=lnlinks href=#hl-39-26>26</a>
</span><span class=lnt id=hl-39-27><a class=lnlinks href=#hl-39-27>27</a>
</span><span class=lnt id=hl-39-28><a class=lnlinks href=#hl-39-28>28</a>
</span><span class=lnt id=hl-39-29><a class=lnlinks href=#hl-39-29>29</a>
</span><span class=lnt id=hl-39-30><a class=lnlinks href=#hl-39-30>30</a>
</span><span class=lnt id=hl-39-31><a class=lnlinks href=#hl-39-31>31</a>
</span><span class=lnt id=hl-39-32><a class=lnlinks href=#hl-39-32>32</a>
</span><span class=lnt id=hl-39-33><a class=lnlinks href=#hl-39-33>33</a>
</span><span class=lnt id=hl-39-34><a class=lnlinks href=#hl-39-34>34</a>
</span><span class=lnt id=hl-39-35><a class=lnlinks href=#hl-39-35>35</a>
</span><span class=lnt id=hl-39-36><a class=lnlinks href=#hl-39-36>36</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// user.service.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>Injectable</span><span class=p>,</span> <span class=nx>Inject</span> <span class=p>}</span> <span class=kr>from</span> <span class=s1>&#39;@nestjs/common&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>@Injectable</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>class</span> <span class=nx>UserService</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>constructor</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=kd>@Inject</span><span class=p>(</span><span class=s1>&#39;IUserRepository&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kr>private</span> <span class=kr>readonly</span> <span class=nx>userRepository</span>: <span class=kt>IUserRepository</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=kr>private</span> <span class=kr>readonly</span> <span class=nx>eventBus</span>: <span class=kt>EventBus</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>createUser</span><span class=p>(</span><span class=nx>request</span>: <span class=kt>CreateUserRequest</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>User</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>email</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Email</span><span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>email</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>User</span><span class=p>(</span><span class=nx>generateId</span><span class=p>(),</span> <span class=nx>request</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span> <span class=nx>email</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>savedUser</span> <span class=o>=</span> <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>userRepository</span><span class=p>.</span><span class=nx>save</span><span class=p>(</span><span class=nx>user</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 도메인 이벤트 발행
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>eventBus</span><span class=p>.</span><span class=nx>publishAll</span><span class=p>(</span><span class=nx>user</span><span class=p>.</span><span class=nx>domainEvents</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>savedUser</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// user.module.ts
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>@Module</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>providers</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=nx>UserService</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>provide</span><span class=o>:</span> <span class=s1>&#39;IUserRepository&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>useClass</span>: <span class=kt>SqlUserRepository</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nx>controllers</span><span class=o>:</span> <span class=p>[</span><span class=nx>UserController</span><span class=p>],</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=kr>class</span> <span class=nx>UserModule</span> <span class=p>{}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=use-case-기반-애플리케이션-계층>Use Case 기반 애플리케이션 계층<a hidden class=anchor aria-hidden=true href=#use-case-기반-애플리케이션-계층>#</a></h5><h6 id=use-case-패턴-구현>Use Case 패턴 구현<a hidden class=anchor aria-hidden=true href=#use-case-패턴-구현>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-40-1><a class=lnlinks href=#hl-40-1> 1</a>
</span><span class=lnt id=hl-40-2><a class=lnlinks href=#hl-40-2> 2</a>
</span><span class=lnt id=hl-40-3><a class=lnlinks href=#hl-40-3> 3</a>
</span><span class=lnt id=hl-40-4><a class=lnlinks href=#hl-40-4> 4</a>
</span><span class=lnt id=hl-40-5><a class=lnlinks href=#hl-40-5> 5</a>
</span><span class=lnt id=hl-40-6><a class=lnlinks href=#hl-40-6> 6</a>
</span><span class=lnt id=hl-40-7><a class=lnlinks href=#hl-40-7> 7</a>
</span><span class=lnt id=hl-40-8><a class=lnlinks href=#hl-40-8> 8</a>
</span><span class=lnt id=hl-40-9><a class=lnlinks href=#hl-40-9> 9</a>
</span><span class=lnt id=hl-40-10><a class=lnlinks href=#hl-40-10>10</a>
</span><span class=lnt id=hl-40-11><a class=lnlinks href=#hl-40-11>11</a>
</span><span class=lnt id=hl-40-12><a class=lnlinks href=#hl-40-12>12</a>
</span><span class=lnt id=hl-40-13><a class=lnlinks href=#hl-40-13>13</a>
</span><span class=lnt id=hl-40-14><a class=lnlinks href=#hl-40-14>14</a>
</span><span class=lnt id=hl-40-15><a class=lnlinks href=#hl-40-15>15</a>
</span><span class=lnt id=hl-40-16><a class=lnlinks href=#hl-40-16>16</a>
</span><span class=lnt id=hl-40-17><a class=lnlinks href=#hl-40-17>17</a>
</span><span class=lnt id=hl-40-18><a class=lnlinks href=#hl-40-18>18</a>
</span><span class=lnt id=hl-40-19><a class=lnlinks href=#hl-40-19>19</a>
</span><span class=lnt id=hl-40-20><a class=lnlinks href=#hl-40-20>20</a>
</span><span class=lnt id=hl-40-21><a class=lnlinks href=#hl-40-21>21</a>
</span><span class=lnt id=hl-40-22><a class=lnlinks href=#hl-40-22>22</a>
</span><span class=lnt id=hl-40-23><a class=lnlinks href=#hl-40-23>23</a>
</span><span class=lnt id=hl-40-24><a class=lnlinks href=#hl-40-24>24</a>
</span><span class=lnt id=hl-40-25><a class=lnlinks href=#hl-40-25>25</a>
</span><span class=lnt id=hl-40-26><a class=lnlinks href=#hl-40-26>26</a>
</span><span class=lnt id=hl-40-27><a class=lnlinks href=#hl-40-27>27</a>
</span><span class=lnt id=hl-40-28><a class=lnlinks href=#hl-40-28>28</a>
</span><span class=lnt id=hl-40-29><a class=lnlinks href=#hl-40-29>29</a>
</span><span class=lnt id=hl-40-30><a class=lnlinks href=#hl-40-30>30</a>
</span><span class=lnt id=hl-40-31><a class=lnlinks href=#hl-40-31>31</a>
</span><span class=lnt id=hl-40-32><a class=lnlinks href=#hl-40-32>32</a>
</span><span class=lnt id=hl-40-33><a class=lnlinks href=#hl-40-33>33</a>
</span><span class=lnt id=hl-40-34><a class=lnlinks href=#hl-40-34>34</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Application Layer - Use Case</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CreateUserUseCase</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;단일 책임을 가진 Use Case&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                 <span class=n>user_repository</span><span class=p>:</span> <span class=n>IUserRepository</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>email_service</span><span class=p>:</span> <span class=n>IEmailService</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>event_publisher</span><span class=p>:</span> <span class=n>IEventPublisher</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_user_repository</span> <span class=o>=</span> <span class=n>user_repository</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_email_service</span> <span class=o>=</span> <span class=n>email_service</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_event_publisher</span> <span class=o>=</span> <span class=n>event_publisher</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>execute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>CreateUserRequest</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>CreateUserResponse</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. 입력 검증</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>request</span><span class=o>.</span><span class=n>name</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>request</span><span class=o>.</span><span class=n>email</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>ValidationError</span><span class=p>(</span><span class=s2>&#34;Name and email are required&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. 비즈니스 규칙 검증</span>
</span></span><span class=line><span class=cl>        <span class=n>email</span> <span class=o>=</span> <span class=n>Email</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>email</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>existing_user</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_user_repository</span><span class=o>.</span><span class=n>find_by_email</span><span class=p>(</span><span class=n>email</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>existing_user</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>BusinessRuleViolation</span><span class=p>(</span><span class=s2>&#34;User with this email already exists&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. 도메인 객체 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=n>email</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 4. 영속성 처리</span>
</span></span><span class=line><span class=cl>        <span class=n>saved_user</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_user_repository</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 5. 부수 효과 처리 (이벤트 발행)</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_event_publisher</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>UserCreated</span><span class=p>(</span><span class=n>saved_user</span><span class=o>.</span><span class=n>id</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 6. 응답 생성</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>CreateUserResponse</span><span class=o>.</span><span class=n>from_domain</span><span class=p>(</span><span class=n>saved_user</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=cqrs-패턴-적용>CQRS 패턴 적용<a hidden class=anchor aria-hidden=true href=#cqrs-패턴-적용>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-41-1><a class=lnlinks href=#hl-41-1> 1</a>
</span><span class=lnt id=hl-41-2><a class=lnlinks href=#hl-41-2> 2</a>
</span><span class=lnt id=hl-41-3><a class=lnlinks href=#hl-41-3> 3</a>
</span><span class=lnt id=hl-41-4><a class=lnlinks href=#hl-41-4> 4</a>
</span><span class=lnt id=hl-41-5><a class=lnlinks href=#hl-41-5> 5</a>
</span><span class=lnt id=hl-41-6><a class=lnlinks href=#hl-41-6> 6</a>
</span><span class=lnt id=hl-41-7><a class=lnlinks href=#hl-41-7> 7</a>
</span><span class=lnt id=hl-41-8><a class=lnlinks href=#hl-41-8> 8</a>
</span><span class=lnt id=hl-41-9><a class=lnlinks href=#hl-41-9> 9</a>
</span><span class=lnt id=hl-41-10><a class=lnlinks href=#hl-41-10>10</a>
</span><span class=lnt id=hl-41-11><a class=lnlinks href=#hl-41-11>11</a>
</span><span class=lnt id=hl-41-12><a class=lnlinks href=#hl-41-12>12</a>
</span><span class=lnt id=hl-41-13><a class=lnlinks href=#hl-41-13>13</a>
</span><span class=lnt id=hl-41-14><a class=lnlinks href=#hl-41-14>14</a>
</span><span class=lnt id=hl-41-15><a class=lnlinks href=#hl-41-15>15</a>
</span><span class=lnt id=hl-41-16><a class=lnlinks href=#hl-41-16>16</a>
</span><span class=lnt id=hl-41-17><a class=lnlinks href=#hl-41-17>17</a>
</span><span class=lnt id=hl-41-18><a class=lnlinks href=#hl-41-18>18</a>
</span><span class=lnt id=hl-41-19><a class=lnlinks href=#hl-41-19>19</a>
</span><span class=lnt id=hl-41-20><a class=lnlinks href=#hl-41-20>20</a>
</span><span class=lnt id=hl-41-21><a class=lnlinks href=#hl-41-21>21</a>
</span><span class=lnt id=hl-41-22><a class=lnlinks href=#hl-41-22>22</a>
</span><span class=lnt id=hl-41-23><a class=lnlinks href=#hl-41-23>23</a>
</span><span class=lnt id=hl-41-24><a class=lnlinks href=#hl-41-24>24</a>
</span><span class=lnt id=hl-41-25><a class=lnlinks href=#hl-41-25>25</a>
</span><span class=lnt id=hl-41-26><a class=lnlinks href=#hl-41-26>26</a>
</span><span class=lnt id=hl-41-27><a class=lnlinks href=#hl-41-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Command와 Query 분리</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CreateUserCommand</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>email</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>email</span> <span class=o>=</span> <span class=n>email</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>GetUserQuery</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_id</span> <span class=o>=</span> <span class=n>user_id</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Command Handler</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CreateUserCommandHandler</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_repository</span><span class=p>:</span> <span class=n>IUserRepository</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_user_repository</span> <span class=o>=</span> <span class=n>user_repository</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>handle</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>command</span><span class=p>:</span> <span class=n>CreateUserCommand</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>command</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=n>Email</span><span class=p>(</span><span class=n>command</span><span class=o>.</span><span class=n>email</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>saved_user</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_user_repository</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>saved_user</span><span class=o>.</span><span class=n>id</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Query Handler</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>GetUserQueryHandler</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_read_model</span><span class=p>:</span> <span class=n>IUserReadModel</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_user_read_model</span> <span class=o>=</span> <span class=n>user_read_model</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>handle</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>query</span><span class=p>:</span> <span class=n>GetUserQuery</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>UserDto</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_user_read_model</span><span class=o>.</span><span class=n>get_by_id</span><span class=p>(</span><span class=n>query</span><span class=o>.</span><span class=n>user_id</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=도메인-이벤트-및-event-driven-architecture>도메인 이벤트 및 Event-Driven Architecture<a hidden class=anchor aria-hidden=true href=#도메인-이벤트-및-event-driven-architecture>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-42-1><a class=lnlinks href=#hl-42-1> 1</a>
</span><span class=lnt id=hl-42-2><a class=lnlinks href=#hl-42-2> 2</a>
</span><span class=lnt id=hl-42-3><a class=lnlinks href=#hl-42-3> 3</a>
</span><span class=lnt id=hl-42-4><a class=lnlinks href=#hl-42-4> 4</a>
</span><span class=lnt id=hl-42-5><a class=lnlinks href=#hl-42-5> 5</a>
</span><span class=lnt id=hl-42-6><a class=lnlinks href=#hl-42-6> 6</a>
</span><span class=lnt id=hl-42-7><a class=lnlinks href=#hl-42-7> 7</a>
</span><span class=lnt id=hl-42-8><a class=lnlinks href=#hl-42-8> 8</a>
</span><span class=lnt id=hl-42-9><a class=lnlinks href=#hl-42-9> 9</a>
</span><span class=lnt id=hl-42-10><a class=lnlinks href=#hl-42-10>10</a>
</span><span class=lnt id=hl-42-11><a class=lnlinks href=#hl-42-11>11</a>
</span><span class=lnt id=hl-42-12><a class=lnlinks href=#hl-42-12>12</a>
</span><span class=lnt id=hl-42-13><a class=lnlinks href=#hl-42-13>13</a>
</span><span class=lnt id=hl-42-14><a class=lnlinks href=#hl-42-14>14</a>
</span><span class=lnt id=hl-42-15><a class=lnlinks href=#hl-42-15>15</a>
</span><span class=lnt id=hl-42-16><a class=lnlinks href=#hl-42-16>16</a>
</span><span class=lnt id=hl-42-17><a class=lnlinks href=#hl-42-17>17</a>
</span><span class=lnt id=hl-42-18><a class=lnlinks href=#hl-42-18>18</a>
</span><span class=lnt id=hl-42-19><a class=lnlinks href=#hl-42-19>19</a>
</span><span class=lnt id=hl-42-20><a class=lnlinks href=#hl-42-20>20</a>
</span><span class=lnt id=hl-42-21><a class=lnlinks href=#hl-42-21>21</a>
</span><span class=lnt id=hl-42-22><a class=lnlinks href=#hl-42-22>22</a>
</span><span class=lnt id=hl-42-23><a class=lnlinks href=#hl-42-23>23</a>
</span><span class=lnt id=hl-42-24><a class=lnlinks href=#hl-42-24>24</a>
</span><span class=lnt id=hl-42-25><a class=lnlinks href=#hl-42-25>25</a>
</span><span class=lnt id=hl-42-26><a class=lnlinks href=#hl-42-26>26</a>
</span><span class=lnt id=hl-42-27><a class=lnlinks href=#hl-42-27>27</a>
</span><span class=lnt id=hl-42-28><a class=lnlinks href=#hl-42-28>28</a>
</span><span class=lnt id=hl-42-29><a class=lnlinks href=#hl-42-29>29</a>
</span><span class=lnt id=hl-42-30><a class=lnlinks href=#hl-42-30>30</a>
</span><span class=lnt id=hl-42-31><a class=lnlinks href=#hl-42-31>31</a>
</span><span class=lnt id=hl-42-32><a class=lnlinks href=#hl-42-32>32</a>
</span><span class=lnt id=hl-42-33><a class=lnlinks href=#hl-42-33>33</a>
</span><span class=lnt id=hl-42-34><a class=lnlinks href=#hl-42-34>34</a>
</span><span class=lnt id=hl-42-35><a class=lnlinks href=#hl-42-35>35</a>
</span><span class=lnt id=hl-42-36><a class=lnlinks href=#hl-42-36>36</a>
</span><span class=lnt id=hl-42-37><a class=lnlinks href=#hl-42-37>37</a>
</span><span class=lnt id=hl-42-38><a class=lnlinks href=#hl-42-38>38</a>
</span><span class=lnt id=hl-42-39><a class=lnlinks href=#hl-42-39>39</a>
</span><span class=lnt id=hl-42-40><a class=lnlinks href=#hl-42-40>40</a>
</span><span class=lnt id=hl-42-41><a class=lnlinks href=#hl-42-41>41</a>
</span><span class=lnt id=hl-42-42><a class=lnlinks href=#hl-42-42>42</a>
</span><span class=lnt id=hl-42-43><a class=lnlinks href=#hl-42-43>43</a>
</span><span class=lnt id=hl-42-44><a class=lnlinks href=#hl-42-44>44</a>
</span><span class=lnt id=hl-42-45><a class=lnlinks href=#hl-42-45>45</a>
</span><span class=lnt id=hl-42-46><a class=lnlinks href=#hl-42-46>46</a>
</span><span class=lnt id=hl-42-47><a class=lnlinks href=#hl-42-47>47</a>
</span><span class=lnt id=hl-42-48><a class=lnlinks href=#hl-42-48>48</a>
</span><span class=lnt id=hl-42-49><a class=lnlinks href=#hl-42-49>49</a>
</span><span class=lnt id=hl-42-50><a class=lnlinks href=#hl-42-50>50</a>
</span><span class=lnt id=hl-42-51><a class=lnlinks href=#hl-42-51>51</a>
</span><span class=lnt id=hl-42-52><a class=lnlinks href=#hl-42-52>52</a>
</span><span class=lnt id=hl-42-53><a class=lnlinks href=#hl-42-53>53</a>
</span><span class=lnt id=hl-42-54><a class=lnlinks href=#hl-42-54>54</a>
</span><span class=lnt id=hl-42-55><a class=lnlinks href=#hl-42-55>55</a>
</span><span class=lnt id=hl-42-56><a class=lnlinks href=#hl-42-56>56</a>
</span><span class=lnt id=hl-42-57><a class=lnlinks href=#hl-42-57>57</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Domain Event</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dataclasses</span> <span class=kn>import</span> <span class=n>dataclass</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DomainEvent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>occurred_on</span><span class=p>:</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>    <span class=n>event_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UserCreated</span><span class=p>(</span><span class=n>DomainEvent</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>user_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>email</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Domain Entity with Events</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>email</span><span class=p>:</span> <span class=n>Email</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_id</span> <span class=o>=</span> <span class=n>user_id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_name</span> <span class=o>=</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_email</span> <span class=o>=</span> <span class=n>email</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_domain_events</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>DomainEvent</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>email</span><span class=p>:</span> <span class=n>Email</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=s1>&#39;User&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>user_id</span> <span class=o>=</span> <span class=n>generate_uuid</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=bp>cls</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>email</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 도메인 이벤트 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span><span class=o>.</span><span class=n>_domain_events</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>UserCreated</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>occurred_on</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=n>event_id</span><span class=o>=</span><span class=n>generate_uuid</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=n>user_id</span><span class=o>=</span><span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>name</span><span class=o>=</span><span class=n>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>email</span><span class=o>=</span><span class=n>email</span><span class=o>.</span><span class=n>value</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>user</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@property</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>domain_events</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>DomainEvent</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_domain_events</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>clear_domain_events</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_domain_events</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Event Handler</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UserCreatedEventHandler</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>email_service</span><span class=p>:</span> <span class=n>IEmailService</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_email_service</span> <span class=o>=</span> <span class=n>email_service</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>handle</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>:</span> <span class=n>UserCreated</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_email_service</span><span class=o>.</span><span class=n>send_welcome_email</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>event</span><span class=o>.</span><span class=n>email</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>            <span class=n>event</span><span class=o>.</span><span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=주요-차이점-비교>주요 차이점 비교<a hidden class=anchor aria-hidden=true href=#주요-차이점-비교>#</a></h4><table><thead><tr><th>구분</th><th>전통적 Layered Architecture</th><th>현대적 Layered Architecture</th></tr></thead><tbody><tr><td><strong>설계 철학</strong></td><td>기술 중심 (Database-Centric)</td><td>도메인 중심 (Domain-Centric)</td></tr><tr><td><strong>의존성 방향</strong></td><td>하향식 (UI→DB)</td><td>중심 지향 (외부→도메인)</td></tr><tr><td><strong>계층 구성</strong></td><td>Presentation→Business→Data→DB</td><td>Infrastructure→Application→Domain</td></tr><tr><td><strong>의존성 관리</strong></td><td>직접 생성, Factory 패턴</td><td>DI Container, Interface 기반</td></tr><tr><td><strong>비즈니스 로직</strong></td><td>Service 계층에 절차적 코드</td><td>Rich Domain Model, Use Case</td></tr><tr><td><strong>데이터 전달</strong></td><td>도메인 객체 직접 노출</td><td>DTO/Request-Response 패턴</td></tr><tr><td><strong>테스트 전략</strong></td><td>통합 테스트 중심</td><td>단위 테스트 우선, Mock 활용</td></tr><tr><td><strong>변경 전파</strong></td><td>하위→상위로 전파</td><td>외부 변경이 도메인에 영향 없음</td></tr><tr><td><strong>프레임워크 예시</strong></td><td>Spring MVC, Django, Rails</td><td>Clean Architecture, DDD</td></tr></tbody></table><h4 id=실제-구현-예시-비교>실제 구현 예시 비교<a hidden class=anchor aria-hidden=true href=#실제-구현-예시-비교>#</a></h4><h5 id=전통적-방식---사용자-생성>전통적 방식 - 사용자 생성<a hidden class=anchor aria-hidden=true href=#전통적-방식---사용자-생성>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-43-1><a class=lnlinks href=#hl-43-1> 1</a>
</span><span class=lnt id=hl-43-2><a class=lnlinks href=#hl-43-2> 2</a>
</span><span class=lnt id=hl-43-3><a class=lnlinks href=#hl-43-3> 3</a>
</span><span class=lnt id=hl-43-4><a class=lnlinks href=#hl-43-4> 4</a>
</span><span class=lnt id=hl-43-5><a class=lnlinks href=#hl-43-5> 5</a>
</span><span class=lnt id=hl-43-6><a class=lnlinks href=#hl-43-6> 6</a>
</span><span class=lnt id=hl-43-7><a class=lnlinks href=#hl-43-7> 7</a>
</span><span class=lnt id=hl-43-8><a class=lnlinks href=#hl-43-8> 8</a>
</span><span class=lnt id=hl-43-9><a class=lnlinks href=#hl-43-9> 9</a>
</span><span class=lnt id=hl-43-10><a class=lnlinks href=#hl-43-10>10</a>
</span><span class=lnt id=hl-43-11><a class=lnlinks href=#hl-43-11>11</a>
</span><span class=lnt id=hl-43-12><a class=lnlinks href=#hl-43-12>12</a>
</span><span class=lnt id=hl-43-13><a class=lnlinks href=#hl-43-13>13</a>
</span><span class=lnt id=hl-43-14><a class=lnlinks href=#hl-43-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 전통적 방식: 강한 결합, 절차적 처리</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UserController</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_user</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 직접 DB 접근</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>UserRepository</span><span class=p>()</span><span class=o>.</span><span class=n>find_by_email</span><span class=p>(</span><span class=n>request</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;User exists&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=n>User</span><span class=p>(</span><span class=n>request</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>],</span> <span class=n>request</span><span class=p>[</span><span class=s1>&#39;email&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>  <span class=c1># Active Record 패턴</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 직접 이메일 서비스 호출</span>
</span></span><span class=line><span class=cl>        <span class=n>EmailService</span><span class=p>()</span><span class=o>.</span><span class=n>send_welcome_email</span><span class=p>(</span><span class=n>user</span><span class=o>.</span><span class=n>email</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=n>user</span><span class=o>.</span><span class=n>id</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=현대적-방식---사용자-생성>현대적 방식 - 사용자 생성<a hidden class=anchor aria-hidden=true href=#현대적-방식---사용자-생성>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-44-1><a class=lnlinks href=#hl-44-1> 1</a>
</span><span class=lnt id=hl-44-2><a class=lnlinks href=#hl-44-2> 2</a>
</span><span class=lnt id=hl-44-3><a class=lnlinks href=#hl-44-3> 3</a>
</span><span class=lnt id=hl-44-4><a class=lnlinks href=#hl-44-4> 4</a>
</span><span class=lnt id=hl-44-5><a class=lnlinks href=#hl-44-5> 5</a>
</span><span class=lnt id=hl-44-6><a class=lnlinks href=#hl-44-6> 6</a>
</span><span class=lnt id=hl-44-7><a class=lnlinks href=#hl-44-7> 7</a>
</span><span class=lnt id=hl-44-8><a class=lnlinks href=#hl-44-8> 8</a>
</span><span class=lnt id=hl-44-9><a class=lnlinks href=#hl-44-9> 9</a>
</span><span class=lnt id=hl-44-10><a class=lnlinks href=#hl-44-10>10</a>
</span><span class=lnt id=hl-44-11><a class=lnlinks href=#hl-44-11>11</a>
</span><span class=lnt id=hl-44-12><a class=lnlinks href=#hl-44-12>12</a>
</span><span class=lnt id=hl-44-13><a class=lnlinks href=#hl-44-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 현대적 방식: 느슨한 결합, 도메인 중심</span>
</span></span><span class=line><span class=cl><span class=nd>@router.post</span><span class=p>(</span><span class=s2>&#34;/users&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>create_user</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=p>:</span> <span class=n>CreateUserRequest</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>use_case</span><span class=p>:</span> <span class=n>CreateUserUseCase</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>get_create_user_use_case</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>use_case</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>CreateUserResponse</span><span class=o>.</span><span class=n>from_domain</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>ValidationError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>400</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>BusinessRuleViolation</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>409</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=마이크로서비스와의-연계>마이크로서비스와의 연계<a hidden class=anchor aria-hidden=true href=#마이크로서비스와의-연계>#</a></h4><h5 id=현대적-접근법에서의-마이크로서비스-지원>현대적 접근법에서의 마이크로서비스 지원<a hidden class=anchor aria-hidden=true href=#현대적-접근법에서의-마이크로서비스-지원>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-45-1><a class=lnlinks href=#hl-45-1> 1</a>
</span><span class=lnt id=hl-45-2><a class=lnlinks href=#hl-45-2> 2</a>
</span><span class=lnt id=hl-45-3><a class=lnlinks href=#hl-45-3> 3</a>
</span><span class=lnt id=hl-45-4><a class=lnlinks href=#hl-45-4> 4</a>
</span><span class=lnt id=hl-45-5><a class=lnlinks href=#hl-45-5> 5</a>
</span><span class=lnt id=hl-45-6><a class=lnlinks href=#hl-45-6> 6</a>
</span><span class=lnt id=hl-45-7><a class=lnlinks href=#hl-45-7> 7</a>
</span><span class=lnt id=hl-45-8><a class=lnlinks href=#hl-45-8> 8</a>
</span><span class=lnt id=hl-45-9><a class=lnlinks href=#hl-45-9> 9</a>
</span><span class=lnt id=hl-45-10><a class=lnlinks href=#hl-45-10>10</a>
</span><span class=lnt id=hl-45-11><a class=lnlinks href=#hl-45-11>11</a>
</span><span class=lnt id=hl-45-12><a class=lnlinks href=#hl-45-12>12</a>
</span><span class=lnt id=hl-45-13><a class=lnlinks href=#hl-45-13>13</a>
</span><span class=lnt id=hl-45-14><a class=lnlinks href=#hl-45-14>14</a>
</span><span class=lnt id=hl-45-15><a class=lnlinks href=#hl-45-15>15</a>
</span><span class=lnt id=hl-45-16><a class=lnlinks href=#hl-45-16>16</a>
</span><span class=lnt id=hl-45-17><a class=lnlinks href=#hl-45-17>17</a>
</span><span class=lnt id=hl-45-18><a class=lnlinks href=#hl-45-18>18</a>
</span><span class=lnt id=hl-45-19><a class=lnlinks href=#hl-45-19>19</a>
</span><span class=lnt id=hl-45-20><a class=lnlinks href=#hl-45-20>20</a>
</span><span class=lnt id=hl-45-21><a class=lnlinks href=#hl-45-21>21</a>
</span><span class=lnt id=hl-45-22><a class=lnlinks href=#hl-45-22>22</a>
</span><span class=lnt id=hl-45-23><a class=lnlinks href=#hl-45-23>23</a>
</span><span class=lnt id=hl-45-24><a class=lnlinks href=#hl-45-24>24</a>
</span><span class=lnt id=hl-45-25><a class=lnlinks href=#hl-45-25>25</a>
</span><span class=lnt id=hl-45-26><a class=lnlinks href=#hl-45-26>26</a>
</span><span class=lnt id=hl-45-27><a class=lnlinks href=#hl-45-27>27</a>
</span><span class=lnt id=hl-45-28><a class=lnlinks href=#hl-45-28>28</a>
</span><span class=lnt id=hl-45-29><a class=lnlinks href=#hl-45-29>29</a>
</span><span class=lnt id=hl-45-30><a class=lnlinks href=#hl-45-30>30</a>
</span><span class=lnt id=hl-45-31><a class=lnlinks href=#hl-45-31>31</a>
</span><span class=lnt id=hl-45-32><a class=lnlinks href=#hl-45-32>32</a>
</span><span class=lnt id=hl-45-33><a class=lnlinks href=#hl-45-33>33</a>
</span><span class=lnt id=hl-45-34><a class=lnlinks href=#hl-45-34>34</a>
</span><span class=lnt id=hl-45-35><a class=lnlinks href=#hl-45-35>35</a>
</span><span class=lnt id=hl-45-36><a class=lnlinks href=#hl-45-36>36</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 각 서비스별 독립적인 도메인 계층</span>
</span></span><span class=line><span class=cl><span class=c1># User Service</span>
</span></span><span class=line><span class=cl><span class=n>src</span><span class=o>/</span><span class=n>user_service</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>domain</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>User</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=n>IUserRepository</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>application</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=n>CreateUserUseCase</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>└──</span> <span class=n>infrastructure</span><span class=o>/</span>
</span></span><span class=line><span class=cl>    <span class=err>└──</span> <span class=n>SqlUserRepository</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Order Service  </span>
</span></span><span class=line><span class=cl><span class=n>src</span><span class=o>/</span><span class=n>order_service</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>domain</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>Order</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=n>IOrderRepository</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>application</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=n>ProcessOrderUseCase</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>└──</span> <span class=n>infrastructure</span><span class=o>/</span>
</span></span><span class=line><span class=cl>    <span class=err>└──</span> <span class=n>MongoOrderRepository</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># API Gateway에서 서비스 조합</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UserOrderController</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                 <span class=n>user_service_client</span><span class=p>:</span> <span class=n>UserServiceClient</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                 <span class=n>order_service_client</span><span class=p>:</span> <span class=n>OrderServiceClient</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_user_service</span> <span class=o>=</span> <span class=n>user_service_client</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_order_service</span> <span class=o>=</span> <span class=n>order_service_client</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>create_user_with_initial_order</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 분산 트랜잭션 또는 Saga 패턴 적용</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_user_service</span><span class=o>.</span><span class=n>create_user</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>user_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>order</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>_order_service</span><span class=o>.</span><span class=n>create_order</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>user</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=n>request</span><span class=o>.</span><span class=n>order_data</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;user&#34;</span><span class=p>:</span> <span class=n>user</span><span class=p>,</span> <span class=s2>&#34;order&#34;</span><span class=p>:</span> <span class=n>order</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><h4 id=전통적-layered-architecture-의-장점>전통적 Layered Architecture 의 장점<a hidden class=anchor aria-hidden=true href=#전통적-layered-architecture-의-장점>#</a></h4><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th><th>구현 메커니즘</th></tr></thead><tbody><tr><td><strong>구조적 이점</strong></td><td>계층별 관심사 분리</td><td>기술적 책임에 따른 명확한 역할 구분 (UI, 비즈니스, 데이터)</td><td>수평적 계층화, 하향식 의존성</td></tr><tr><td></td><td>단방향 의존성</td><td>상위 계층이 하위 계층에만 의존하는 예측 가능한 구조</td><td>컴파일 타임 의존성 제어</td></tr><tr><td></td><td>계층 격리</td><td>각 계층의 변경이 인접 계층에만 영향을 미침</td><td>인터페이스 기반 계층 간 통신</td></tr><tr><td><strong>개발 효율성</strong></td><td>팀 기반 병렬 개발</td><td>계층별로 전문 팀이 동시 개발 가능</td><td>기술 스택별 팀 구성</td></tr><tr><td></td><td>표준화된 구조</td><td>업계 표준 패턴으로 학습 곡선 최소화</td><td>MVC, 3-Tier 등 확립된 패턴</td></tr><tr><td></td><td>재사용성</td><td>계층별 컴포넌트를 다른 프로젝트에서 활용</td><td>공통 라이브러리, 프레임워크</td></tr><tr><td><strong>품질 보증</strong></td><td>계층별 테스트</td><td>각 계층을 독립적으로 테스트 가능</td><td>모킹, 스텁을 활용한 단위 테스트</td></tr><tr><td></td><td>유지보수성</td><td>특정 계층의 수정이 다른 계층에 미치는 영향 제한</td><td>캡슐화, 정보 은닉</td></tr><tr><td><strong>운영 측면</strong></td><td>배포 단순성</td><td>단일 단위로 배포하여 운영 복잡성 최소화</td><td>모노리스 배포 모델</td></tr><tr><td></td><td>성능 예측성</td><td>순차적 처리로 성능 특성 예측 가능</td><td>동기적 계층 간 호출</td></tr></tbody></table><h4 id=현대적-domain-centric-layered-architecture-의-장점>현대적 Domain-Centric Layered Architecture 의 장점<a hidden class=anchor aria-hidden=true href=#현대적-domain-centric-layered-architecture-의-장점>#</a></h4><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th><th>구현 메커니즘</th></tr></thead><tbody><tr><td><strong>비즈니스 중심성</strong></td><td>도메인 독립성</td><td>비즈니스 로직이 기술적 세부사항으로부터 완전 격리</td><td>의존성 역전 원칙 (DIP) 적용</td></tr><tr><td></td><td>비즈니스 표현력</td><td>코드 구조가 실제 비즈니스 프로세스를 반영</td><td>유비쿼터스 언어, DDD 전술 패턴</td></tr><tr><td></td><td>도메인 중심 진화</td><td>비즈니스 요구사항 변화에 민첩하게 대응</td><td>도메인 이벤트, 애그리게이트</td></tr><tr><td><strong>아키텍처 품질</strong></td><td>강화된 테스트성</td><td>도메인 로직을 인프라 없이 독립 테스트</td><td>순수 도메인 객체 단위 테스트</td></tr><tr><td></td><td>기술적 유연성</td><td>프레임워크, 데이터베이스 등 기술 스택 교체 용이</td><td>포트와 어댑터 패턴</td></tr><tr><td></td><td>확장성</td><td>개별 계층의 독립적 확장 및 성능 튜닝</td><td>마이크로서비스 아키텍처 대비</td></tr><tr><td><strong>개발 생산성</strong></td><td>명확한 경계</td><td>바운디드 컨텍스트를 통한 명확한 책임 경계</td><td>Clean Architecture, Hexagonal Architecture</td></tr><tr><td></td><td>컴포넌트 재사용</td><td>도메인 로직의 다양한 인터페이스에서 재활용</td><td>멀티 채널 아키텍처 지원</td></tr><tr><td><strong>품질 속성</strong></td><td>보안 강화</td><td>계층별 보안 정책 적용으로 다층 방어</td><td>Zero Trust, 계층별 인증/권한</td></tr><tr><td></td><td>관찰가능성</td><td>계층별 메트릭 수집 및 모니터링</td><td>분산 추적, APM 도구 연동</td></tr><tr><td><strong>현대적 요구사항</strong></td><td>클라우드 네이티브</td><td>컨테이너화, 마이크로서비스 전환 준비</td><td>Kubernetes, 서비스 메시 지원</td></tr><tr><td></td><td>DevOps 통합</td><td>CI/CD 파이프라인과 자연스러운 통합</td><td>계층별 독립 배포 파이프라인</td></tr></tbody></table><h4 id=전통적-vs-현대적-접근법의-핵심-차이점>전통적 vs. 현대적 접근법의 핵심 차이점<a hidden class=anchor aria-hidden=true href=#전통적-vs-현대적-접근법의-핵심-차이점>#</a></h4><h5 id=설계-철학의-차이>설계 철학의 차이<a hidden class=anchor aria-hidden=true href=#설계-철학의-차이>#</a></h5><pre class=mermaid>graph TD
    subgraph &#34;Traditional Layered&#34;
        A[Presentation Layer] --&gt; B[Business Layer]
        B --&gt; C[Data Access Layer]
        C --&gt; D[Database Layer]
    end
    
    subgraph &#34;Modern Domain-Centric&#34;
        E[Infrastructure] --&gt; F[Application]
        G[Infrastructure] --&gt; F
        H[Infrastructure] --&gt; F
        F --&gt; I[Domain Core]
    end
</pre><table><thead><tr><th>측면</th><th>전통적 접근법</th><th>현대적 접근법</th></tr></thead><tbody><tr><td><strong>중심 요소</strong></td><td>데이터베이스/기술 스택</td><td>비즈니스 도메인</td></tr><tr><td><strong>의존성 방향</strong></td><td>하향식 (UI → DB)</td><td>중심 지향 (외부 → 도메인)</td></tr><tr><td><strong>변경 전파</strong></td><td>계단식 영향</td><td>격리된 영향</td></tr><tr><td><strong>테스트 전략</strong></td><td>통합 테스트 중심</td><td>도메인 단위 테스트 중심</td></tr></tbody></table><h4 id=장점별-상세-분석>장점별 상세 분석<a hidden class=anchor aria-hidden=true href=#장점별-상세-분석>#</a></h4><h5 id=관심사-분리-separation-of-concerns>관심사 분리 (Separation of Concerns)<a hidden class=anchor aria-hidden=true href=#관심사-분리-separation-of-concerns>#</a></h5><p><strong>전통적 접근법</strong>:</p><ul><li><strong>메커니즘</strong>: 기술적 책임에 따른 수평 분리</li><li><strong>장점</strong>: 개발자가 특정 기술 영역에 집중 가능</li><li><strong>한계</strong>: 비즈니스 로직이 여러 계층에 산재</li></ul><p><strong>현대적 접근법</strong>:</p><ul><li><strong>메커니즘</strong>: 비즈니스 개념 중심의 수직 분리</li><li><strong>장점</strong>: 비즈니스 로직의 응집도 극대화</li><li><strong>추가 가치</strong>: 도메인 전문가와의 의사소통 개선</li></ul><h5 id=테스트-용이성>테스트 용이성<a hidden class=anchor aria-hidden=true href=#테스트-용이성>#</a></h5><p><strong>전통적 접근법</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-47-1><a class=lnlinks href=#hl-47-1> 1</a>
</span><span class=lnt id=hl-47-2><a class=lnlinks href=#hl-47-2> 2</a>
</span><span class=lnt id=hl-47-3><a class=lnlinks href=#hl-47-3> 3</a>
</span><span class=lnt id=hl-47-4><a class=lnlinks href=#hl-47-4> 4</a>
</span><span class=lnt id=hl-47-5><a class=lnlinks href=#hl-47-5> 5</a>
</span><span class=lnt id=hl-47-6><a class=lnlinks href=#hl-47-6> 6</a>
</span><span class=lnt id=hl-47-7><a class=lnlinks href=#hl-47-7> 7</a>
</span><span class=lnt id=hl-47-8><a class=lnlinks href=#hl-47-8> 8</a>
</span><span class=lnt id=hl-47-9><a class=lnlinks href=#hl-47-9> 9</a>
</span><span class=lnt id=hl-47-10><a class=lnlinks href=#hl-47-10>10</a>
</span><span class=lnt id=hl-47-11><a class=lnlinks href=#hl-47-11>11</a>
</span><span class=lnt id=hl-47-12><a class=lnlinks href=#hl-47-12>12</a>
</span><span class=lnt id=hl-47-13><a class=lnlinks href=#hl-47-13>13</a>
</span><span class=lnt id=hl-47-14><a class=lnlinks href=#hl-47-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 통합 테스트에 의존</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@SpringBootTest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>class</span> <span class=nc>UserServiceTest</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>UserService</span><span class=w> </span><span class=n>userService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@MockBean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>UserRepository</span><span class=w> </span><span class=n>userRepository</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>shouldCreateUser</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 데이터베이스 모킹 필요</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>현대적 접근법</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-48-1><a class=lnlinks href=#hl-48-1> 1</a>
</span><span class=lnt id=hl-48-2><a class=lnlinks href=#hl-48-2> 2</a>
</span><span class=lnt id=hl-48-3><a class=lnlinks href=#hl-48-3> 3</a>
</span><span class=lnt id=hl-48-4><a class=lnlinks href=#hl-48-4> 4</a>
</span><span class=lnt id=hl-48-5><a class=lnlinks href=#hl-48-5> 5</a>
</span><span class=lnt id=hl-48-6><a class=lnlinks href=#hl-48-6> 6</a>
</span><span class=lnt id=hl-48-7><a class=lnlinks href=#hl-48-7> 7</a>
</span><span class=lnt id=hl-48-8><a class=lnlinks href=#hl-48-8> 8</a>
</span><span class=lnt id=hl-48-9><a class=lnlinks href=#hl-48-9> 9</a>
</span><span class=lnt id=hl-48-10><a class=lnlinks href=#hl-48-10>10</a>
</span><span class=lnt id=hl-48-11><a class=lnlinks href=#hl-48-11>11</a>
</span><span class=lnt id=hl-48-12><a class=lnlinks href=#hl-48-12>12</a>
</span><span class=lnt id=hl-48-13><a class=lnlinks href=#hl-48-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 순수 도메인 테스트</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>class</span> <span class=nc>UserTest</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>shouldCreateValidUser</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 외부 의존성 없는 순수 테스트</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Email</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Email</span><span class=p>(</span><span class=s>&#34;test@example.com&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Name</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Name</span><span class=p>(</span><span class=s>&#34;John Doe&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>User</span><span class=w> </span><span class=n>user</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>User</span><span class=p>(</span><span class=n>email</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>assertThat</span><span class=p>(</span><span class=n>user</span><span class=p>.</span><span class=na>getEmail</span><span class=p>()).</span><span class=na>isEqualTo</span><span class=p>(</span><span class=n>email</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=확장성>확장성<a hidden class=anchor aria-hidden=true href=#확장성>#</a></h5><p><strong>전통적 접근법</strong>:</p><ul><li><strong>수직 확장</strong>: 전체 애플리케이션 단위 확장</li><li><strong>제한</strong>: 특정 계층 병목 시 전체 확장 필요</li></ul><p><strong>현대적 접근법</strong>:</p><ul><li><strong>선택적 확장</strong>: 도메인별, 유스케이스별 독립 확장</li><li><strong>마이크로서비스 준비</strong>: 바운디드 컨텍스트 기반 분할 가능</li></ul><h4 id=현대적-요구사항에-대한-대응>현대적 요구사항에 대한 대응<a hidden class=anchor aria-hidden=true href=#현대적-요구사항에-대한-대응>#</a></h4><h5 id=클라우드-네이티브-환경>클라우드 네이티브 환경<a hidden class=anchor aria-hidden=true href=#클라우드-네이티브-환경>#</a></h5><p><strong>전통적 방식의 한계</strong>:</p><ul><li>모노리식 배포로 인한 확장성 제약</li><li>기술 스택 종속성으로 인한 클라우드 마이그레이션 어려움</li></ul><p><strong>현대적 방식의 장점</strong>:</p><ul><li>컨테이너화 친화적 구조</li><li>서비스 메시와의 자연스러운 통합</li><li>클라우드 서비스 (서버리스, 관리형 서비스) 활용 용이</li></ul><h5 id=devsecops-와-보안>DevSecOps 와 보안<a hidden class=anchor aria-hidden=true href=#devsecops-와-보안>#</a></h5><p><strong>계층별 보안 강화</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-49-1><a class=lnlinks href=#hl-49-1> 1</a>
</span><span class=lnt id=hl-49-2><a class=lnlinks href=#hl-49-2> 2</a>
</span><span class=lnt id=hl-49-3><a class=lnlinks href=#hl-49-3> 3</a>
</span><span class=lnt id=hl-49-4><a class=lnlinks href=#hl-49-4> 4</a>
</span><span class=lnt id=hl-49-5><a class=lnlinks href=#hl-49-5> 5</a>
</span><span class=lnt id=hl-49-6><a class=lnlinks href=#hl-49-6> 6</a>
</span><span class=lnt id=hl-49-7><a class=lnlinks href=#hl-49-7> 7</a>
</span><span class=lnt id=hl-49-8><a class=lnlinks href=#hl-49-8> 8</a>
</span><span class=lnt id=hl-49-9><a class=lnlinks href=#hl-49-9> 9</a>
</span><span class=lnt id=hl-49-10><a class=lnlinks href=#hl-49-10>10</a>
</span><span class=lnt id=hl-49-11><a class=lnlinks href=#hl-49-11>11</a>
</span><span class=lnt id=hl-49-12><a class=lnlinks href=#hl-49-12>12</a>
</span><span class=lnt id=hl-49-13><a class=lnlinks href=#hl-49-13>13</a>
</span><span class=lnt id=hl-49-14><a class=lnlinks href=#hl-49-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 현대적 보안 구현 예시</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SecurityLayerManager</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>layer_policies</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;presentation&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;input_validation&#34;</span><span class=p>,</span> <span class=s2>&#34;authentication&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;application&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;authorization&#34;</span><span class=p>,</span> <span class=s2>&#34;rate_limiting&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;domain&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;business_rule_validation&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;infrastructure&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;data_encryption&#34;</span><span class=p>,</span> <span class=s2>&#34;audit_logging&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>apply_security</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>layer</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>operation</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>policies</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>layer_policies</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>layer</span><span class=p>,</span> <span class=p>[])</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>policy</span> <span class=ow>in</span> <span class=n>policies</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>enforce_policy</span><span class=p>(</span><span class=n>policy</span><span class=p>,</span> <span class=n>operation</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h3><h4 id=전통적인-layered-architecture-단점-및-문제점>전통적인 Layered Architecture 단점 및 문제점<a hidden class=anchor aria-hidden=true href=#전통적인-layered-architecture-단점-및-문제점>#</a></h4><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th><th>해결 방안</th></tr></thead><tbody><tr><td><strong>의존성/결합도</strong></td><td>강한 계층 의존성</td><td>BLL (비즈니스 로직) 이 DAL (데이터 접근) 에 직접 의존</td><td>인터페이스 추상화, 의존성 주입 (DI), DIP 적용</td></tr><tr><td><strong>테스트</strong></td><td>테스트 복잡성</td><td>실제 DB 의존으로 단위 테스트 어렵고, mocking 대상이 복잡함</td><td>In-memory DB, 모킹 전략, 테스트 전용 리포지토리 도입</td></tr><tr><td><strong>구조 경직성</strong></td><td>구조의 고정성</td><td>모든 요청이 모든 계층을 거쳐야 하므로 유연한 변경이 어려움</td><td>이벤트 기반 처리, 일부 계층 우회, 계층 간 약결합 유도</td></tr><tr><td><strong>성능/과잉 호출</strong></td><td>계층 과도 통과</td><td>단순한 기능도 모든 계층을 거치면서 불필요한 호출/변환 발생</td><td>DTO 단순화, 계층 축소 또는 통합, Facade 패턴 도입</td></tr><tr><td><strong>개발/운영 효율성</strong></td><td>계층 간 역할 모호</td><td>Controller → Service → DAO 로만 구성되어 도메인 로직이 분산됨</td><td>도메인 중심 설계 도입, 서비스 계층 책임 명확화</td></tr></tbody></table><p>전통적인 구조는 직관적이고 프레임워크 친화적이지만, 비즈니스 로직이 분산되기 쉽고, 계층 간 결합도가 높아 변경이나 테스트에 취약하다. <strong>의존성 주입, 인터페이스 분리, 단순화된 계층 구조</strong>가 주요 해결책이다.</p><h4 id=현대적인-layered-architecture단점-및-문제점>현대적인 Layered Architecture–단점 및 문제점<a hidden class=anchor aria-hidden=true href=#현대적인-layered-architecture단점-및-문제점>#</a></h4><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th><th>해결 방안</th></tr></thead><tbody><tr><td><strong>설계 복잡도</strong></td><td>구조 복잡성</td><td>포트/어댑터/유스케이스/엔티티 등 계층이 많아 설계 진입장벽이 존재</td><td>단계적 도입, 문서화 강화, 팀 수준에 맞춘 구조 설계 적용</td></tr><tr><td><strong>오버엔지니어링</strong></td><td>과도한 추상화</td><td>단순 로직에도 인터페이스/UseCase 분리로 개발 생산성 저하</td><td>구조 간소화, Vertical Slice Architecture 도입</td></tr><tr><td><strong>학습 곡선</strong></td><td>개념적 이해 난이도</td><td>DDD, DIP, SRP 등의 설계 원칙에 대한 높은 이해도 요구</td><td>교육 및 문서 제공, 파일/패키지 기반 시각적 구조 구성</td></tr><tr><td><strong>성능/구현 오버헤드</strong></td><td>이벤트 기반 확산</td><td>Event 기반 설계 시 오류 추적 및 실행 흐름 파악이 어려워질 수 있음</td><td>이벤트 흐름 로깅 도입, Trace 기반 모니터링</td></tr><tr><td><strong>테스트 전략</strong></td><td>계층별 테스트 부담 증가</td><td>각 계층이 인터페이스 기반으로 분리되어 mocking 구성 많아짐</td><td>테스트 템플릿화, 테스트 헬퍼 도입, 도메인 중심 테스트 전략 적용</td></tr></tbody></table><p>현대적 구조는 도메인 주도 설계 (DDD) 에 기반하여 유연성과 유지보수성을 높이지만, <strong>구조가 복잡하고 추상화가 과도</strong>할 수 있어 개발 생산성에 악영향을 줄 수 있다.<br><strong>Vertical Slice, 단계적 도입, 테스트 템플릿화</strong>로 운영 효율성을 확보하는 것이 중요하다.</p><h4 id=공통-해결-전략-요약>공통 해결 전략 요약<a hidden class=anchor aria-hidden=true href=#공통-해결-전략-요약>#</a></h4><ul><li><strong>계층 수를 목적에 맞게 설계</strong>: 작은 프로젝트는 3-Layer, 도메인 중심은 4~5 Layer 구성.</li><li><strong>인터페이스 기반 통신 (DIP)</strong>: 추상화 도입으로 유연성과 교체 용이성 확보.</li><li><strong>테스트 전략 세분화</strong>: Domain, Application, Infra 계층별로 독립 테스트 전략 구성.</li><li><strong>코드 자동 분석 도구</strong>: 정적 분석, 의존성 시각화, 순환 참조 탐지 도구 활용.</li><li><strong>계층 통합/간소화 시도</strong>: 반복적이고 의미 없는 계층 (Sinkhole) 은 통합하거나 생략.</li></ul><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><table><thead><tr><th>카테고리</th><th>도전 과제</th><th>원인 또는 트리거</th><th>영향</th><th>해결 전략 및 기법</th></tr></thead><tbody><tr><td><strong>구조적 문제</strong></td><td>계층 간 결합도 증가</td><td>인터페이스 부족, 하위 구현 직접 호출</td><td>유지보수 어려움, 변경 전파</td><td>DIP 적용, 인터페이스 기반 설계, 의존성 주입</td></tr><tr><td></td><td>계층 침범 및 규칙 위반</td><td>코드 규율 미흡, 계층 우회 호출</td><td>설계 무력화, 모듈 결합도 증가</td><td>코드 리뷰, 정적 분석, AOP, 접근 제어</td></tr><tr><td></td><td>과도한 계층화</td><td>책임 없는 추상화, 불필요 계층 남발</td><td>복잡성 증가, 성능 저하</td><td>계층 최소화, 도메인 중심 계층 정리, 필요 계층만 유지</td></tr><tr><td><strong>운영 및 테스트</strong></td><td>테스트 유지 어려움</td><td>계층 수 증가, Mock 구성 복잡</td><td>테스트 커버리지 저하, 자동화 부담 증가</td><td>계층별 테스트 전략, Mock 프레임워크, Contract 기반 테스트 분리</td></tr><tr><td></td><td>실시간 처리 한계</td><td>동기 구조 기반, 계층 지연</td><td>응답 시간 증가, UX 저하</td><td>비동기 메시지 처리, 이벤트 기반 구조, Redis 등 캐싱 적용</td></tr><tr><td></td><td>트랜잭션 경계 모호</td><td>트랜잭션 책임 분산</td><td>데이터 불일치, 예외 복잡성</td><td>Application Layer 중심 트랜잭션 관리, @Transactional, AOP 사용</td></tr><tr><td><strong>현대화 이슈</strong></td><td>마이크로서비스 전환의 어려움</td><td>모놀리식 강한 결합</td><td>도메인 분할 및 독립 배포 불가</td><td>Strangler Fig, 도메인 별 API 분리, 이벤트 기반 분해</td></tr><tr><td></td><td>클라우드 네이티브 부적합</td><td>상태 보존, 동기 구조, 고정 계층</td><td>확장성 저하, 클라우드 리소스 활용 저하</td><td>서버리스 구조, 컨테이너화, API Gateway + 메시징 기반 아키텍처</td></tr><tr><td></td><td>외부 기술 변화 대응</td><td>다양한 Adapter, DB, 프레임워크 변화 주기</td><td>유지보수 비용 증가, 적시 대응 어려움</td><td>Adapter/Port 설계, Open/Closed 원칙 적용, 테스트 자동화</td></tr><tr><td><strong>아키텍처 유연성</strong></td><td>도메인 로직 누수</td><td>비즈니스 로직이 Service/Infra 계층에 위치</td><td>테스트 어려움, 변경 유연성 저하</td><td>도메인 계층 순수화, DDD 적용, 유스케이스 분리</td></tr><tr><td></td><td>공통 처리 분산</td><td>인증, 로깅 등이 각 계층에 중복됨</td><td>코드 중복, 유지보수 어려움</td><td>AOP, 미들웨어 추출, Cross-cutting 모듈화</td></tr><tr><td></td><td>계층 오버헤드/네트워크 비용 증가</td><td>마이크로서비스 내 계층 구조 동일 적용</td><td>호출 지연, 분산 장애 확산</td><td>BFF, API Composition, GraphQL, 경량 계층 전략 적용</td></tr></tbody></table><ol><li><p><strong>구조적 문제</strong>:<br>Layered Architecture 는 명확한 경계를 기반으로 설계되지만, 계층 간 결합도 증가나 과도한 계층화로 인해 복잡성이 급증할 수 있다. 특히 DIP(Dependency Inversion Principle) 를 적용하지 않으면 구조가 경직되고 변경 비용이 높아진다.</p></li><li><p><strong>운영 및 테스트 측면</strong>:<br>많은 계층은 테스트 환경 구성에 복잡성을 더하고, 계층별 책임이 분산되면 트랜잭션 경계가 모호해진다. 실시간 처리나 CI/CD 환경에서는 각 계층의 상태를 mocking 하거나 병렬로 테스트하기 어려운 문제가 생긴다.</p></li><li><p><strong>현대화 이슈</strong>:<br>마이크로서비스나 클라우드 네이티브 아키텍처로 전환 시, 전통적인 계층 구조는 배포 단위, 확장성, 네트워크 처리에 대한 제약이 발생한다. 이벤트 중심 아키텍처, 서버리스, API Gateway 등을 활용한 리디자인이 필요하다.</p></li><li><p><strong>아키텍처 유연성 부족</strong>:<br>비즈니스 로직이 도메인 외부 계층에 분산되면 핵심 도메인의 테스트 및 유지보수가 어려워지고, 로깅·인증 등 공통 관심사가 중복 처리되면 코드 일관성과 재사용성이 저하된다. 이는 미들웨어 또는 AOP 기반 공통 처리로 해결할 수 있다.</p></li></ol><h3 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th><strong>분류 기준</strong></th><th><strong>유형</strong></th><th><strong>설명</strong></th><th><strong>적용 또는 특징</strong></th></tr></thead><tbody><tr><td><strong>계층 수 기준</strong></td><td>2-Tier</td><td>클라이언트와 데이터베이스 간 직접 통신</td><td>데스크탑, 단순 CRUD 시스템 등</td></tr><tr><td></td><td>3-Tier</td><td>Presentation / Business / Data 계층 분리</td><td>가장 일반적인 웹 애플리케이션 구조</td></tr><tr><td></td><td>4-Tier 이상 (N-Tier)</td><td>Application, Domain, Integration 등 세분화 계층 추가</td><td>대규모 시스템, 모듈화·확장성 강화</td></tr><tr><td><strong>아키텍처 스타일</strong></td><td>Traditional Layered</td><td>하향식 의존, UI → Logic → DB 순서</td><td>빠른 구현과 표준화에 유리, 구조 단순</td></tr><tr><td></td><td>Clean Architecture</td><td>도메인 중심 + Use Case 계층, 의존성 역전 (DIP)</td><td>테스트 용이, 변화에 유연한 아키텍처</td></tr><tr><td></td><td>Onion Architecture</td><td>도메인 모델을 중심으로 동심원 구조 구성</td><td>도메인 보호, 로직 중심 구조</td></tr><tr><td></td><td>Hexagonal Architecture</td><td>내부 (도메인) 와 외부 (인터페이스) 를 포트/어댑터로 명확히 분리</td><td>테스트 용이, 기술 독립성 확보</td></tr><tr><td><strong>계층 간 통신 방식</strong></td><td>Closed Layering</td><td>인접 계층만 호출 가능</td><td>DIP, SRP 준수, 테스트성과 일관성 확보</td></tr><tr><td></td><td>Open Layering</td><td>상위 계층이 모든 하위 계층 직접 접근 가능</td><td>성능 우선 고려 시 유리, 구조 일관성 희생</td></tr><tr><td></td><td>Relaxed (Hybrid) Layering</td><td>기본은 Closed, 필요시 Open 허용</td><td>유연성과 테스트 균형, 실무에서 가장 현실적인 구성</td></tr><tr><td><strong>배포 구조</strong></td><td>Logical Layered</td><td>물리적 서버는 같고, 코드 상에서만 계층 구분</td><td>소규모 시스템, 단일 인스턴스 환경</td></tr><tr><td></td><td>Physical Tiered</td><td>계층마다 별도 서버 또는 컨테이너로 분산 구성</td><td>클라우드/엔터프라이즈 시스템, 보안/확장성 강화</td></tr><tr><td><strong>의존성 방향</strong></td><td>Bottom-Up</td><td>하위 계층에서 상위 계층 호출</td><td>전통적인 Layered 구조에서 흔함</td></tr><tr><td></td><td>Top-Down</td><td>상위 계층이 하위 인터페이스에만 의존 (의존성 역전)</td><td>Clean/Onion/Hexagonal 아키텍처에서 적용</td></tr><tr><td><strong>통신 방식</strong></td><td>Synchronous</td><td>계층 간 직접 요청 - 응답 방식 (REST, RPC)</td><td>순차적 처리 흐름, 응답시간 중요할 때 적합</td></tr><tr><td></td><td>Asynchronous</td><td>이벤트/메시지 기반 비동기 통신</td><td>실시간성/확장성 필요 시 사용 (Kafka, RabbitMQ 등)</td></tr><tr><td><strong>복잡도/적용 범위</strong></td><td>단순 구조</td><td>기본 CRUD, 단일 서비스 구성</td><td>전통 Layered 구조, 빠른 구축/교육 목적</td></tr><tr><td></td><td>복합 구조</td><td>도메인 중심, MSA (Microservice Architecture) 환경</td><td>Clean/Onion/Hexagonal 사용, 유연성과 테스트, 유지보수성 중시</td></tr></tbody></table><ol><li><p><strong>계층 수 기준</strong>:<br>시스템의 크기와 복잡도에 따라 2<del>N 계층으로 나뉜다. 단순한 CRUD 위주의 시스템은 2</del>3 계층이 일반적이며, 대규모 시스템에서는 도메인, 서비스, 통합 계층 등을 추가한 4 계층 이상 구조가 요구된다.</p></li><li><p><strong>아키텍처 스타일</strong>:<br>전통적인 Layered Architecture 는 구현이 쉽고 명확하나, 변화에 취약하다. Clean, Onion, Hexagonal 같은 현대적 아키텍처는 도메인 중심, DIP (의존성 역전 원칙) 적용, 테스트 용이성을 보장하며, 복잡성은 증가하지만 장기적인 유지보수에 강하다.</p></li><li><p><strong>계층 간 통신 방식</strong>:<br>계층 간 호출 제한을 두는 방식 (Closed) 은 안정성과 테스트 용이성이 높고, Open 방식은 개발 속도와 성능 유리하지만 유지보수 리스크가 존재한다. 실무에서는 Closed 기반에 예외적으로 우회 호출을 허용하는 Hybrid 방식이 많이 사용된다.</p></li><li><p><strong>배포 구조</strong>:<br>논리적 계층 분리는 동일 서버 내의 모듈화에 가깝고, 물리적 분리는 각 계층을 별도 인프라 (컨테이너, VM 등) 로 분리하여 클라우드, 보안, 확장성 측면에서 유리하다.</p></li><li><p><strong>의존성 방향</strong>:<br>전통적인 방식은 하위 계층 (데이터) 에 의존하나, 현대적인 방식은 상위 계층 (도메인) 이 하위 구현에 의존하지 않도록 추상화하여 설계한다. 이는 유연성과 테스트성을 크게 향상시킨다.</p></li><li><p><strong>통신 방식</strong>:<br>동기식 통신은 간단하고 직관적이지만, 응답 지연이나 장애 전파 위험이 있다. 반면 비동기식 통신은 복잡하지만 확장성과 복원력 확보에 강점을 가지며, 이벤트 기반 아키텍처와 연계된다.</p></li><li><p><strong>복잡도/적용 범위</strong>:<br>간단한 Layered 구조는 개발이 빠르고 직관적이며 소규모 프로젝트에 적합하다. 복잡한 도메인 요구가 있는 경우엔 도메인 주도 아키텍처로 전환이 필요하며, 이때는 책임 분리와 의존성 통제가 중요하다.</p></li></ol><h4 id=3-계층-vs-n-tier-architecture-비교>3 계층 vs. N-Tier Architecture 비교<a hidden class=anchor aria-hidden=true href=#3-계층-vs-n-tier-architecture-비교>#</a></h4><table><thead><tr><th>항목</th><th>3 계층 아키텍처 (Three-Tier Architecture)</th><th>N 계층 아키텍처 (N-Tier Architecture)</th></tr></thead><tbody><tr><td>정의</td><td>가장 기본적인 계층 구조 (Presentation / Logic / Data)</td><td>필요한 기능별로 계층을 세분화하여 설계한 구조</td></tr><tr><td>계층 수</td><td>일반적으로 3 개 계층</td><td>4 개 이상 계층으로 확장 가능</td></tr><tr><td>구조 예시</td><td>UI → 서비스 → DB</td><td>UI → 서비스 → 도메인 → 인프라 → DB 등 다계층 구성</td></tr><tr><td>사용 목적</td><td>단순한 웹 애플리케이션, API 중심 설계</td><td>대규모 엔터프라이즈 시스템, 보안 및 확장성 고려한 설계</td></tr><tr><td>유지보수</td><td>상대적으로 간단하며 빠르게 유지보수 가능</td><td>각 계층이 독립적이라 유지보수 시 영향도 적으나 초기 설계 복잡</td></tr><tr><td>테스트</td><td>테스트 환경이 간단함</td><td>계층이 많아져 Mock 또는 Stub 사용 필수</td></tr><tr><td>단점</td><td>계층 확장 어려움, 유연성 부족</td><td>계층 증가 시 과도한 복잡도 유발 가능</td></tr></tbody></table><ul><li><strong>3 계층</strong>은 단순성과 빠른 개발을 추구할 때 적합.</li><li><strong>N 계층</strong>은 <strong>보안</strong>, <strong>확장성</strong>, <strong>역할 분리</strong>가 중요한 복잡한 시스템에 적합.</li></ul><h4 id=layered-architecture-vs-clean-architecture>Layered Architecture vs. Clean Architecture<a hidden class=anchor aria-hidden=true href=#layered-architecture-vs-clean-architecture>#</a></h4><table><thead><tr><th>항목</th><th>레이어드 아키텍처 (Layered Architecture)</th><th>클린 아키텍처 (Clean Architecture)</th></tr></thead><tbody><tr><td>핵심 개념</td><td>기능별로 계층 분리 (UI, Logic, DB 등)</td><td>도메인 중심 계층 구조, 의존성은 내부를 향함</td></tr><tr><td>계층 구성</td><td>프레젠테이션 → 비즈니스 로직 → 데이터 액세스</td><td>Entity → UseCase → Interface Adapter → Framework</td></tr><tr><td>의존성 방향</td><td>상위 계층 → 하위 계층으로만 이동</td><td>외부 계층 → 내부 계층으로만 이동 (역전된 의존성)</td></tr><tr><td>주요 원칙</td><td>SRP, OCP, DIP 일부 적용</td><td>SOLID 원칙 전면 적용 (특히 DIP 중심)</td></tr><tr><td>관심사 분리</td><td>기술 중심 (기능 단위 분리)</td><td>도메인 중심 (비즈니스 룰에 집중)</td></tr><tr><td>유연성</td><td>낮은 유연성: UI 와 DB 구조에 종속성 있음</td><td>높은 유연성: UI, DB 등 외부 요소 독립적 변경 가능</td></tr><tr><td>학습 곡선</td><td>낮음 (대부분의 프레임워크에서 기본 제공)</td><td>높음 (개념적 구조와 DI 설계 학습 필요)</td></tr><tr><td>예시 프레임워크</td><td>Spring MVC,.NET MVC 등</td><td>Hexagonal, Onion, Clean Architecture 등</td></tr></tbody></table><ul><li>Clean Architecture 는 Layered Architecture 를 인터페이스 기반으로 개선하여 결합도를 낮추고 핵심 도메인을 외부 변화로부터 보호하는 설계 철학이다.</li></ul><ul><li><strong>Clean vs Layered</strong>: Clean Architecture 는 Layered 구조의 추상화와 의존관리 강화 버전이며, 핵심 도메인의 독립성과 유연성을 강조</li></ul><h4 id=strict-layered-vs-loose-layered>Strict Layered vs. Loose Layered<a hidden class=anchor aria-hidden=true href=#strict-layered-vs-loose-layered>#</a></h4><table><thead><tr><th>구분</th><th>엄격 레이어드 (Strict Layered)</th><th>유연 레이어드 (Loose Layered)</th></tr></thead><tbody><tr><td><strong>정의</strong></td><td>요청이 반드시 인접한 하위 계층을 통해서만 전달되는 구조</td><td>요청이 중간 계층을 건너뛰고 하위 계층에 직접 접근 가능한 구조</td></tr><tr><td><strong>계층 간 접근</strong></td><td>상위 계층은 반드시 바로 아래 계층만 호출 가능</td><td>상위 계층이 하위 여러 계층 (2 단계 이상) 에 직접 접근 가능</td></tr><tr><td><strong>예시 호출 흐름</strong></td><td><code>Presentation → Application → Domain → Persistence</code></td><td><code>Presentation → Domain</code> 또는 <code>Presentation → Persistence</code> 가능</td></tr><tr><td><strong>결합도</strong></td><td>낮음 (명확한 경계 유지)</td><td>상대적으로 높음 (우회 경로로 인해 경계가 약해질 수 있음)</td></tr><tr><td><strong>유지보수성</strong></td><td>높음 (예측 가능한 흐름, 디버깅 용이)</td><td>중간 계층 우회 시 추적 어려움 발생 가능</td></tr><tr><td><strong>성능 최적화</strong></td><td>병목 가능성 존재 (모든 요청이 모든 계층을 통과해야 함)</td><td>성능 향상을 위한 계층 우회 가능</td></tr><tr><td><strong>유연성</strong></td><td>낮음 (구조적 제약이 많음)</td><td>높음 (상황에 따라 계층 스킵 가능)</td></tr><tr><td><strong>테스트 용이성</strong></td><td>용이 (단계별 독립적 테스트 가능)</td><td>우회 경로 존재 시 특정 흐름 테스트 복잡도 증가</td></tr><tr><td><strong>도입 난이도</strong></td><td>높음 (명확한 규칙 설계 필요, 추상화 많음)</td><td>낮음 (개발 유연성 확보 가능)</td></tr><tr><td><strong>적합한 시나리오</strong></td><td>보안/안정성 우선 시스템, 공공 시스템, 규제가 강한 도메인</td><td>성능/속도 우선, MVP, 데이터 분석 시스템 등 민첩성이 중요한 도메인</td></tr></tbody></table><ul><li><p><strong>엄격 레이어드 아키텍처</strong>는 계층 간 <strong>의존성을 철저히 제한</strong>하여 모듈성과 예측 가능성이 매우 뛰어남. 테스트와 디버깅이 용이하며, 시스템이 커질수록 구조적 강점이 발휘됨. 단, <strong>성능 병목</strong>과 <strong>유연성 부족</strong>이 단점.</p></li><li><p><strong>유연 레이어드 아키텍처</strong>는 특정 상황에서 <strong>계층을 스킵하여 성능을 향상</strong>시킬 수 있는 장점이 있으나, <strong>결합도 증가</strong>와 <strong>유지보수 복잡성</strong>의 리스크가 존재함. 실무에서는 대부분 이 모델을 사용하며, <strong>정책적으로 우회 가능한 계층만 허용</strong>하는 절충 모델도 존재함.</p></li></ul><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>고려 항목</strong></th><th><strong>설명</strong></th><th><strong>권장 전략 또는 실천 방법</strong></th></tr></thead><tbody><tr><td><strong>설계</strong></td><td>계층 수 결정</td><td>과도한 계층은 오히려 복잡도를 증가시킴</td><td>3~5 개 계층을 기본으로, 도메인 복잡도 기반 확장</td></tr><tr><td></td><td>책임과 경계 명확화</td><td>계층 간 역할이 모호할 경우 유지보수/협업이 어려움</td><td>SRP(단일 책임 원칙) 적용, 명세 기반 설계, 역할 기준 모듈화</td></tr><tr><td></td><td>인터페이스/계약 설계</td><td>불명확한 계약은 통합 및 테스트에 혼선을 줌</td><td>API/DTO 명세 문서화, Contract-First 개발, 계약 테스트 적용</td></tr><tr><td><strong>구현/코드 구조</strong></td><td>의존성 역전</td><td>구현 계층에 대한 직접 의존은 변경에 취약</td><td>DIP(Dependency Inversion Principle) 적용, Interface + DI 활용</td></tr><tr><td></td><td>순환 참조 방지</td><td>계층 간 상호 참조 발생 시 구조 무너짐</td><td>정적 분석 도구로 의존성 확인, 계층 참조 방향 제한</td></tr><tr><td></td><td>불필요한 계층 제거</td><td>로직 없이 단순 전달하는 계층은 성능 저하의 원인이 됨</td><td>Sinkhole 패턴 제거, 계층 통합 및 경량화</td></tr><tr><td><strong>성능 최적화</strong></td><td>호출 비용 및 응답 지연</td><td>다단계 계층 호출은 처리 비용과 지연 시간 증가</td><td>캐싱 전략, DTO 최적화, 비동기/병렬 처리 도입</td></tr><tr><td></td><td>통신 방식 선택</td><td>실시간성과 시스템 구조에 따라 통신 방식을 달리해야 함</td><td>동기 (REST) ↔ 비동기 (Message Queue, Event) 선택</td></tr><tr><td><strong>테스트 전략</strong></td><td>계층별 단위 테스트</td><td>통합 테스트 중심은 디버깅과 유지보수에 비효율</td><td>Mock, Stub 활용, 유닛 테스트 기반 구조 구성</td></tr><tr><td></td><td>테스트 피라미드 적용</td><td>계층별 테스트 비율이 균형 잡히지 않으면 품질 저하</td><td>단위: 통합:E2E = 70:20:10 비율 유지, 자동화 테스트 도입</td></tr><tr><td><strong>배포/운영 관리</strong></td><td>독립 배포 가능성 확보</td><td>계층 간 의존이 강하면 일부 기능 변경 시 전체 재배포 필요</td><td>모듈 단위 배포 전략, CI/CD, 컨테이너 기반 계층 구성</td></tr><tr><td></td><td>모니터링/문제 추적</td><td>이슈 발생 시 병목 계층 파악 어려움</td><td>APM, 로그 통합, 분산 추적 시스템 (Jaeger 등) 도입</td></tr><tr><td><strong>보안/인증</strong></td><td>접근 통제 및 인증 위치 명확화</td><td>인증, 권한 처리가 분산되면 취약점 증가</td><td>계층별 보안 책임 고정, 인증 게이트웨이 또는 보안 필터 계층 구성</td></tr><tr><td><strong>횡단 관심사 처리</strong></td><td>로깅, 트랜잭션, 보안 중복 처리</td><td>여러 계층에서 중복 로직 발생</td><td>AOP(관점지향 프로그래밍), 미들웨어/공통 컴포넌트로 추출</td></tr><tr><td><strong>문서화/규칙 관리</strong></td><td>설계 문서 및 계층 가이드 정비</td><td>아키텍처 규칙 미준수 시 구조 무너짐</td><td>ADR (Architecture Decision Record), 설계 표준 문서화 및 리뷰 문화 정착</td></tr></tbody></table><ul><li><p><strong>설계</strong><br>Layered Architecture 는 구조 명확성과 유지보수성을 위해 설계 초기에 계층 수를 정리하고, 각 계층의 책임과 역할을 분명히 구분해야 한다. 인터페이스 계약 기반 설계 (Contract-first) 는 계층 간 통신의 일관성과 테스트 품질 확보에 기여한다.</p></li><li><p><strong>구현/코드 구조</strong><br>계층 간 의존성은 반드시 인터페이스를 통해 제어해야 하며, 순환 참조나 구현 의존은 피해야 한다. 불필요한 중간 계층은 제거하거나 간소화하여 성능과 유지보수성을 동시에 개선할 수 있다.</p></li><li><p><strong>성능 최적화</strong><br>다계층 호출 구조는 호출 지연, 오버헤드를 초래하므로 DTO 최적화, 캐싱, 병렬 처리, 비동기 메시징 등으로 대응해야 한다. 특히 실시간성이 중요한 서비스는 통신 방식 자체를 유연하게 선택할 수 있어야 한다.</p></li><li><p><strong>테스트 전략</strong><br>계층 기반 구조는 테스트 전략 수립이 필수이다. 단위 테스트와 통합 테스트는 역할을 분리하고, 테스트 피라미드 원칙에 따라 계층마다 알맞은 수준의 테스트 커버리지를 유지해야 한다.</p></li><li><p><strong>배포 및 운영</strong><br>모든 계층이 단일 배포 단위에 포함되어 있다면, 작은 변경도 전체 시스템 재배포로 이어질 수 있다. 따라서 컨테이너 기반 배포, 모듈화된 빌드 전략, APM 및 로깅 도구로 안정적 운영이 필요하다.</p></li><li><p><strong>보안과 횡단 관심사</strong><br>인증, 권한 부여, 로깅, 트랜잭션 등은 중복되지 않도록 공통 계층으로 위임하여 관리 효율성과 보안성을 동시에 확보한다. AOP 또는 미들웨어 기반 설계가 효과적이다.</p></li><li><p><strong>문서화 및 규칙 관리</strong><br>Layered Architecture 는 계층 간 계약과 구조가 명확해야 하므로, 아키텍처 결정사항 (ADR), 계약 문서, 계층 규칙 등의 문서화는 장기적인 유지보수와 팀 커뮤니케이션에 핵심 역할을 한다.</p></li></ul><h4 id=layered-architecture-설계구현-단계-권장-전략>Layered Architecture 설계·구현 단계 권장 전략<a hidden class=anchor aria-hidden=true href=#layered-architecture-설계구현-단계-권장-전략>#</a></h4><table><thead><tr><th>항목</th><th>설명</th><th>실무 적용 포인트</th></tr></thead><tbody><tr><td><strong>표준 인터페이스 정의</strong></td><td>각 계층 간 의존성을 줄이기 위해 계약 기반 인터페이스 설계 (ex: Presentation ↔ Application ↔ Domain ↔ Infra)</td><td>인터페이스는 명세 수준에서 먼저 정의, 테스트 대상 분리에 효과적</td></tr><tr><td><strong>의존성 주입 (DI/IoC)</strong></td><td>상위 계층이 하위 구현에 직접 의존하지 않도록 제어 역전 (Inversion of Control) 원칙 적용</td><td>프레임워크 (Spring, NestJS 등) 기반 DI Container 적극 활용</td></tr><tr><td><strong>폴더 및 네임스페이스 분리</strong></td><td>코드 구조를 계층별로 구분하여 역할을 명확히 하고 관리 효율화</td><td>ex: <code>/controller</code>, <code>/service</code>, <code>/repository</code>, <code>/domain</code></td></tr><tr><td><strong>단위 테스트 및 Mock 설계</strong></td><td>각 계층을 독립적으로 테스트할 수 있도록 Mock/Stub 을 활용하여 테스트 커버리지와 리팩토링 신뢰성 확보</td><td>테스트 피라미드 구조 활용 (Unit > Integration > E2E)</td></tr></tbody></table><h5 id=아키텍처-설계-전략>아키텍처 설계 전략<a hidden class=anchor aria-hidden=true href=#아키텍처-설계-전략>#</a></h5><table><thead><tr><th>전략 항목</th><th>설명</th><th>권장 기준</th></tr></thead><tbody><tr><td><strong>계층 정의 기준</strong></td><td>기술 기반 또는 유스케이스 (Use Case) 기반 계층 구성</td><td>도메인 주도 설계 (DDD) 환경에서는 Use Case 중심 계층화 권장</td></tr><tr><td><strong>인터페이스 추상화</strong></td><td>Domain ↔ Infrastructure 간 DIP(의존성 역전 원칙) 구현</td><td>테스트 유연성 확보 및 기술 교체 대응력 향상</td></tr><tr><td><strong>DTO ↔ Domain Mapper</strong></td><td>계층 간 데이터 독립성을 위한 Mapper 또는 Adapter 계층 도입</td><td>MapStruct, ModelMapper, 또는 수동 Mapper 구성</td></tr><tr><td><strong>공통 관심사 분리 (AOP)</strong></td><td>인증, 로깅, 예외처리 등 공통 로직은 AOP 기반 또는 Interceptor 등으로 분리 관리</td><td>Spring AOP, Middleware 구성으로 코드 중복 제거</td></tr></tbody></table><h4 id=운영배포-단계-권장-전략>운영·배포 단계 권장 전략<a hidden class=anchor aria-hidden=true href=#운영배포-단계-권장-전략>#</a></h4><table><thead><tr><th>항목</th><th>설명</th><th>실무 적용 포인트</th></tr></thead><tbody><tr><td><strong>계층 단위 롤백/배포</strong></td><td>장애 발생 시 전체가 아닌 계층 또는 모듈 단위로 배포/롤백 가능하도록 구성</td><td>CI/CD 파이프라인 내 계층 단위 배포 Job 구성</td></tr><tr><td><strong>관찰가능성 계층 (Observability)</strong></td><td>로그, 모니터링, 트레이싱 등 운영 정보를 수집하는 미들웨어 또는 전용 계층 구성</td><td>OpenTelemetry, Prometheus, ELK 도입</td></tr><tr><td><strong>자동화된 빌드/배포 (CI/CD)</strong></td><td>계층별 테스트, 빌드, 배포를 자동화하여 배포 안정성과 속도를 향상</td><td>GitHub Actions, Jenkins, GitLab CI 등 단계별 분리 구성</td></tr></tbody></table><h5 id=cicd-와-계층별-배포-전략-cicd--tiered-deployment>CI/CD 와 계층별 배포 전략 (CI/CD & Tiered Deployment)<a hidden class=anchor aria-hidden=true href=#cicd-와-계층별-배포-전략-cicd--tiered-deployment>#</a></h5><p>Layered Architecture 계층별로 독립적인 CI/CD 파이프라인 설계를 통해 <strong>빨리, 안정적으로, 격리된 배포</strong>가 가능하다. Presentation, Application, Domain, Persistence 계층을 개별로 테스트하고 배포하며, 변경 범위를 최소화한다.</p><p><strong>핵심 구성 요소와 흐름</strong>:</p><ul><li><strong>단위 테스트 & 통합 테스트</strong>: 각 계층별 독립 단위 테스트 후, 연계 테스트 수행</li><li><strong>CI 단계</strong>: 코드 커밋 → 계층별 빌드 및 테스트 병렬 실행 → 전체 통합 테스트</li><li><strong>CD 단계</strong>:<ul><li>Presentation Layer: 프론트엔드 또는 API Gateway</li><li>Application/Domain Layer: 서비스 코드</li><li>Persistence Layer: 데이터 접근 서비스</li><li>계층별로 Blue-Green 또는 Canary 배포 적용 가능</li></ul></li></ul><p><strong>효과</strong>:</p><ul><li>계층별 변경 시 전체 배포가 아닌 해당 계층만 재배포 → 롤백/MR 영향 최소화</li><li>모듈별 테스트 자동화로 품질 보장</li><li>전체 실패 리스크 감소 및 배포 빈도 증가</li></ul><p><strong>보안 강화 포인트</strong>:</p><ul><li>CI/CD 환경에서 각 계층 별로 <strong>비밀 관리 (secrets)</strong>, <strong>정적 코드 분석 (SAST)</strong>, <strong>동적 분석 (DAST)</strong> 적용, 권한 제어 및 접근 분리 필요</li></ul><h4 id=성능-최적화-전략>성능 최적화 전략<a hidden class=anchor aria-hidden=true href=#성능-최적화-전략>#</a></h4><table><thead><tr><th>항목</th><th>문제</th><th>최적화 기법</th></tr></thead><tbody><tr><td>계층 호출 오버헤드</td><td>Service → Domain → Infra → DB</td><td>캐시 도입 (예: Redis), CQRS 도입</td></tr><tr><td>병목 I/O</td><td>모든 계층이 동기 처리</td><td>비동기 처리 (Reactor, Kafka 등)</td></tr><tr><td>계층간 중복 로직</td><td>동일한 로직이 여러 계층 존재</td><td>공통 유틸 모듈 또는 전략 패턴으로 통합</td></tr><tr><td>로깅 부하</td><td>계층별 로그 중복</td><td>Structured Logging 도입 및 필터링 전략 적용</td></tr></tbody></table><h4 id=테스트-전략>테스트 전략<a hidden class=anchor aria-hidden=true href=#테스트-전략>#</a></h4><table><thead><tr><th>계층</th><th>테스트 대상</th><th>방식</th><th>도구</th></tr></thead><tbody><tr><td>Presentation</td><td>Controller</td><td>WebMvcTest, MockMvc</td><td>SpringBootTest, RestAssured</td></tr><tr><td>Application</td><td>Service, UseCase</td><td>단위 테스트, Mock Repository</td><td>JUnit, Mockito</td></tr><tr><td>Domain</td><td>Entity, DomainService</td><td>유닛 테스트 중심</td><td>JUnit</td></tr><tr><td>Infrastructure</td><td>Repository, Adapter</td><td>DB 연동 테스트</td><td>Testcontainers, H2DB</td></tr></tbody></table><h4 id=리팩토링-및-구조-개선-전략>리팩토링 및 구조 개선 전략<a hidden class=anchor aria-hidden=true href=#리팩토링-및-구조-개선-전략>#</a></h4><p><strong>구조적 개선 대상</strong>:</p><ul><li>Application 계층이 DB 에 직접 접근</li><li>Domain 계층이 외부 시스템과 직접 연동</li><li>Controller 가 UseCase 를 넘어서 로직을 수행</li></ul><p><strong>개선 전략</strong></p><table><thead><tr><th>대상</th><th>개선 방식</th></tr></thead><tbody><tr><td>Application → DB 직접 접근</td><td>Repository Interface 를 통해 간접 접근으로 전환</td></tr><tr><td>Domain ↔ 외부 연동</td><td>Adapter 를 통한 외부 연동 구조 설계</td></tr><tr><td>Controller 로직 중첩</td><td>흐름 제어만 담당하도록 축소, Service 에 로직 이관</td></tr></tbody></table><h4 id=crosscutting-concerns-처리>Cross‑cutting Concerns 처리<a hidden class=anchor aria-hidden=true href=#crosscutting-concerns-처리>#</a></h4><p>Cross‑cutting concerns 는 여러 계층에 걸쳐 공통적으로 적용되는 기능들 (로그, 인증, 트랜잭션, 캐싱 등) 이다. Layered Architecture 에서 <strong>비즈니스 핵심 로직에 영향을 주지 않도록 분리된 모듈로 관리</strong>해야 한다.</p><p><strong>처리 전략</strong>:</p><ul><li><strong>Layered Architecture</strong>: 인터셉터 또는 미들웨어 계층을 Presentation 또는 Application Layer 상단에 두어 공통 로직 적용</li><li><strong>Clean Architecture</strong>에서는 Infrastructure 계층 또는 외부 툴 파이프라인 (middleware, 데코레이터 등) 을 활용</li></ul><p><strong>적용 방식</strong>:</p><ul><li><strong>Logging</strong>: Middleware 또는 DI 기반 Decorator 로 요청 흐름 추적</li><li><strong>Validation</strong>: Controller 전에 입력 DTO 검증, Domain 규칙 검증 분리</li><li><strong>Caching</strong>: 캐시 조회/적용은 Application 또는 Infrastructure 계층에 적용 (Cache Aside 패턴)</li><li><strong>Transaction 관리</strong>: Application/Service 계층에서 트랜잭션 범위 지정</li></ul><h3 id=최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>항목</strong></th><th><strong>설명</strong></th><th><strong>권장 사항</strong></th></tr></thead><tbody><tr><td><strong>구조 단순화</strong></td><td>계층 수 최적화</td><td>과도한 계층 분리는 복잡성과 호출 오버헤드 유발</td><td>3~5 개 핵심 계층 중심으로 시작하고 도메인 중심 확장 고려</td></tr><tr><td></td><td>인터페이스 단순화</td><td>포트/어댑터 등 추상화 계층 과도 시 오히려 구조 혼란</td><td>Use Case 중심 인터페이스 설계, DTO 기반 데이터 교환</td></tr><tr><td><strong>성능 최적화</strong></td><td>계층 간 통신 최소화</td><td>중복 호출, Sinkhole 계층, 과도한 직렬화 등은 성능 저하 원인</td><td>DTO 최적화, 캐시 적용, 비동기/이벤트 기반 처리 도입</td></tr><tr><td></td><td>병목 제거 및 비동기화</td><td>응답 지연 제거, 비효율적 동기식 처리 제거</td><td>메시지 큐 (RabbitMQ, Kafka), async/await, AOP 병렬화 적용</td></tr><tr><td></td><td>캐싱 전략</td><td>반복 데이터 호출/연산에 의한 부하 해소</td><td>Redis, 메모리 캐시, TTL 정책 및 캐시 무효화 정책</td></tr><tr><td><strong>데이터 최적화</strong></td><td>DB 부하 분산</td><td>읽기/쓰기 병목 발생 시 확장 어려움</td><td>CQRS, Read Replica, 샤딩 전략, 배치 트리거 활용</td></tr><tr><td></td><td>대용량 처리 대응</td><td>대규모 요청 처리에서 메모리·속도 병목 유발 가능</td><td>커서 기반 페이징, 스트리밍 처리 파이프라인 적용</td></tr><tr><td><strong>확장성 설계</strong></td><td>수평 확장 구조</td><td>확장성 없는 계층은 병목 지점이 됨</td><td>Stateless 구조, 세션 외부화, 로드밸런서, 오토스케일링 적용</td></tr><tr><td></td><td>독립 배포 및 모듈화</td><td>계층 간 강한 결합 시 전체 배포 필요, 유지보수 비용 증가</td><td>각 계층별 API 계약 정의, 모듈 단위 배포 전략 수립</td></tr><tr><td><strong>모니터링/관측성</strong></td><td>계층별 메트릭 수집</td><td>지표 수집 없을 시 병목 진단·장애 대응 어려움</td><td>Prometheus, OpenTelemetry, APM 도구 (New Relic 등) 사용</td></tr><tr><td></td><td>분산 추적 및 장애 복구</td><td>요청 흐름 추적·장애 원인 파악이 어려움</td><td>Trace ID 기반 추적, Circuit Breaker, 재시도 정책 적용</td></tr><tr><td><strong>유지보수성 향상</strong></td><td>계층 경계 및 역할 명확화</td><td>책임 중복 또는 누락 발생 가능</td><td>SRP(단일 책임 원칙), 정적 분석 도구 (SonarQube), 인터페이스 기반 의존성 설계</td></tr><tr><td></td><td>문서화 및 아키텍처 기록</td><td>구조 누락 시 팀 내 혼란, 구조 침식 발생</td><td>Swagger, ADR(Architecture Decision Record), 코드 리뷰 문화 구축</td></tr><tr><td><strong>테스트 전략</strong></td><td>계층별 테스트 구조</td><td>통합 테스트 의존 시 디버깅 어려움</td><td>Mock 기반 단위 테스트, 계층별 독립 테스트 환경 구축</td></tr><tr><td><strong>팀 및 운영 전략</strong></td><td>팀 역량 기반 점진적 도입</td><td>과도한 추상화나 계층화는 도입 실패 가능성 존재</td><td>기능 단위 (Vertical Slice) 부터 Clean Architecture 점진 적용</td></tr><tr><td></td><td>자동화 및 배포 일관성</td><td>수동 배포 및 환경 불일치로 인한 장애 증가</td><td>CI/CD 파이프라인, 템플릿 기반 배포 구성, 환경별 설정 관리</td></tr><tr><td><strong>비용 효율성</strong></td><td>리소스 최적화 및 클라우드 운영</td><td>불필요 인스턴스/컨테이너 사용 증가 시 비용 상승</td><td>태깅, 자동 스케일, 서버리스 고려, 비용 시뮬레이터 사용</td></tr></tbody></table><ul><li><p><strong>구조 단순화</strong>:<br>계층은 많을수록 복잡도와 호출 비용이 증가하므로, 프로젝트 규모나 도메인 복잡도에 맞게 최소화하여 유지한다. Port/Adapter 추상화도 필요한 수준까지만 도입한다.</p></li><li><p><strong>성능 최적화</strong>:<br>DTO 최적화, 불필요 계층 제거, 캐시 전략, 비동기 흐름 등은 계층 간 통신 오버헤드를 줄이는 핵심 요소다. 병목이 생기기 쉬운 위치에 프로파일링 도구를 적용해 지속 개선이 필요하다.</p></li><li><p><strong>데이터 최적화</strong>:<br>CQRS 및 스트리밍 기반 데이터 처리는 대규모 트래픽 상황에서도 안정적이고 빠른 데이터 흐름을 유지하는 데 중요하다.</p></li><li><p><strong>확장성과 배포 유연성</strong>:<br>계층 간 결합을 줄이면 마이크로서비스 전환 또는 독립 배포에 유리하다. 세션 외부화 및 무상태 처리 전략은 수평 확장의 필수 조건이다.</p></li><li><p><strong>모니터링과 장애 대응</strong>:<br>계층이 많을수록 분산 추적 및 장애 지점 파악이 어렵기 때문에, Trace 기반 로깅과 Circuit Breaker 등 장애 복원 전략을 함께 구축해야 한다.</p></li><li><p><strong>유지보수성 확보</strong>:<br>아키텍처 침식을 방지하려면 명확한 역할 분리, 문서화, 코드 리뷰 문화가 필요하며, 정적 분석 도구를 통한 지속적인 품질 유지가 중요하다.</p></li><li><p><strong>테스트 전략</strong>:<br>모든 계층을 커버하는 테스트 체계는 유지보수성을 극대화한다. 단위 테스트와 통합 테스트를 분리하고 테스트 더블 (Mock/Stub) 을 적극 활용한다.</p></li><li><p><strong>팀 기반 적용 전략</strong>:<br>설계 경험이 부족한 팀에게는 점진적인 도입 전략이 필수다. 전체 구조보다 Vertical Slice 중심 리팩토링을 통해 점진적 이행을 유도해야 한다.</p></li><li><p><strong>비용 효율화</strong>:<br>클라우드 기반 운영 시 비용 최적화를 위해 사용량 기반 모니터링, 리소스 태깅, 오토스케일링 등을 도입하고, 정기 리사이징 및 서버리스 아키텍처도 고려한다.</p></li></ul><h3 id=클라우드-네이티브-환경에서의-현대적-layered-architecture-진화>클라우드 네이티브 환경에서의 현대적 Layered Architecture 진화<a hidden class=anchor aria-hidden=true href=#클라우드-네이티브-환경에서의-현대적-layered-architecture-진화>#</a></h3><h4 id=클라우드-네이티브-특성과-계층형-아키텍처의-적응>클라우드 네이티브 특성과 계층형 아키텍처의 적응<a hidden class=anchor aria-hidden=true href=#클라우드-네이티브-특성과-계층형-아키텍처의-적응>#</a></h4><p><strong>컨테이너화와 계층 구조</strong>:</p><ul><li><strong>마이크로서비스 기반 계층</strong>: 각 계층이 독립적인 컨테이너로 배포</li><li><strong>서비스 메시 (Service Mesh)</strong>: Istio, Linkerd 를 통한 계층 간 통신 관리</li><li><strong>서버리스 통합</strong>: AWS Lambda, Azure Functions 를 활용한 계층별 서버리스 배포</li></ul><p><strong>Kubernetes 기반 계층 오케스트레이션</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-50-1><a class=lnlinks href=#hl-50-1> 1</a>
</span><span class=lnt id=hl-50-2><a class=lnlinks href=#hl-50-2> 2</a>
</span><span class=lnt id=hl-50-3><a class=lnlinks href=#hl-50-3> 3</a>
</span><span class=lnt id=hl-50-4><a class=lnlinks href=#hl-50-4> 4</a>
</span><span class=lnt id=hl-50-5><a class=lnlinks href=#hl-50-5> 5</a>
</span><span class=lnt id=hl-50-6><a class=lnlinks href=#hl-50-6> 6</a>
</span><span class=lnt id=hl-50-7><a class=lnlinks href=#hl-50-7> 7</a>
</span><span class=lnt id=hl-50-8><a class=lnlinks href=#hl-50-8> 8</a>
</span><span class=lnt id=hl-50-9><a class=lnlinks href=#hl-50-9> 9</a>
</span><span class=lnt id=hl-50-10><a class=lnlinks href=#hl-50-10>10</a>
</span><span class=lnt id=hl-50-11><a class=lnlinks href=#hl-50-11>11</a>
</span><span class=lnt id=hl-50-12><a class=lnlinks href=#hl-50-12>12</a>
</span><span class=lnt id=hl-50-13><a class=lnlinks href=#hl-50-13>13</a>
</span><span class=lnt id=hl-50-14><a class=lnlinks href=#hl-50-14>14</a>
</span><span class=lnt id=hl-50-15><a class=lnlinks href=#hl-50-15>15</a>
</span><span class=lnt id=hl-50-16><a class=lnlinks href=#hl-50-16>16</a>
</span><span class=lnt id=hl-50-17><a class=lnlinks href=#hl-50-17>17</a>
</span><span class=lnt id=hl-50-18><a class=lnlinks href=#hl-50-18>18</a>
</span><span class=lnt id=hl-50-19><a class=lnlinks href=#hl-50-19>19</a>
</span><span class=lnt id=hl-50-20><a class=lnlinks href=#hl-50-20>20</a>
</span><span class=lnt id=hl-50-21><a class=lnlinks href=#hl-50-21>21</a>
</span><span class=lnt id=hl-50-22><a class=lnlinks href=#hl-50-22>22</a>
</span><span class=lnt id=hl-50-23><a class=lnlinks href=#hl-50-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># 현대적 계층 배포 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>application-layer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>layer</span><span class=p>:</span><span class=w> </span><span class=l>application</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>layer</span><span class=p>:</span><span class=w> </span><span class=l>application</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>app-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>myapp/application-layer:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>DOMAIN_SERVICE_URL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://domain-layer-service:8081&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=mach-아키텍처와의-연계>MACH 아키텍처와의 연계<a hidden class=anchor aria-hidden=true href=#mach-아키텍처와의-연계>#</a></h4><p><strong>MACH (Microservices, API-first, Cloud-native, Headless) 원칙</strong>:</p><ul><li><strong>모듈성</strong>: 각 계층의 독립 배포 및 확장</li><li><strong>API 우선</strong>: 계층 간 RESTful/GraphQL API 통신</li><li><strong>클라우드 네이티브</strong>: 클라우드 서비스와의 자연스러운 통합</li><li><strong>헤드리스 접근법</strong>: 프레젠테이션 계층의 다중 채널 지원</li></ul><h3 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>시스템/도메인</strong></th><th><strong>사용 기술 스택</strong></th><th><strong>계층 구성 및 역할</strong></th><th><strong>주요 효과 및 특징</strong></th></tr></thead><tbody><tr><td><strong>웹 애플리케이션</strong></td><td>전자상거래, B2B 플랫폼</td><td>React, Spring Boot, MyBatis, MySQL</td><td>UI / 서비스 / 도메인 / 인프라 계층 분리</td><td>유지보수성 향상, 기능 단위 분리, 유연한 확장</td></tr><tr><td><strong>모바일 백엔드</strong></td><td>모바일 API 서버</td><td>Node.js, Express, MongoDB, React Native</td><td>RESTful API → 서비스 로직 → 영속 계층</td><td>빠른 개발, 확장성 및 모바일 연동 최적화</td></tr><tr><td><strong>엔터프라이즈 시스템</strong></td><td>ERP, 금융, 보험, 공공기관</td><td>Java EE, SAP, Oracle,.NET Framework, Angular</td><td>프레젠테이션 → 도메인 서비스 → 인프라 계층</td><td>보안성, 트랜잭션 정합성 확보, 복잡한 로직 계층화</td></tr><tr><td><strong>콘텐츠 관리</strong></td><td>CMS, 블로그 플랫폼</td><td>Laravel, WordPress, PostgreSQL, PHP</td><td>View / 콘텐츠 로직 / 데이터 계층</td><td>콘텐츠 재사용성 강화, 역할 분리 통한 관리 효율 향상</td></tr><tr><td><strong>마이크로서비스</strong></td><td>주문/결제/배송 MSA 플랫폼</td><td>.NET Core, Spring Cloud, Kafka, gRPC, API Gateway</td><td>Gateway → Application → Domain → Infrastructure</td><td>각 서비스 독립 배포, 메시징 기반 통신, 책임 중심 분산 처리</td></tr><tr><td><strong>헬스케어/규제 산업</strong></td><td>의료정보시스템, 법률/공공 시스템</td><td>Angular,.NET Core, SQL Server, JWT, OAuth2</td><td>환자 UI → 진료 서비스 로직 → 데이터 저장 계층</td><td>보안/법적 요구사항 대응, 민감정보 보호, 인증 계층 강화</td></tr><tr><td><strong>레거시 시스템 현대화</strong></td><td>Java EE 기반 레거시</td><td>Java EE, Hibernate, Oracle, JSP</td><td>Controller → Service → Repository 구조에서 점진적 계층 분리</td><td>레거시 구조에서 점진적 Clean 구조로 이전 가능</td></tr><tr><td><strong>클라우드 기반 시스템</strong></td><td>SaaS, BFF (Backend for Frontend)</td><td>AWS Lambda, Serverless Framework, GraphQL, Redis, SQS</td><td>프론트 최적화 BFF → 서비스 로직 → 비동기 메시징 → 영속 계층</td><td>서버리스 최적화, 비동기 처리, 계층별 자원 격리</td></tr></tbody></table><ul><li><p><strong>웹 애플리케이션</strong>:<br>전통적인 3-Tier 또는 4-Tier 구조를 사용하여, 사용자 인터페이스, 도메인 로직, 영속 계층을 명확히 분리함. 특히 전자상거래에서는 유연한 확장성과 기능별 유지보수가 중요.</p></li><li><p><strong>모바일 백엔드</strong>:<br>RESTful API 를 중심으로 비즈니스 로직과 DB 계층을 분리하여 다양한 클라이언트 (모바일, IoT 등) 대응에 용이. Node.js 기반 경량 계층이 자주 사용됨.</p></li><li><p><strong>엔터프라이즈 시스템</strong>:<br>대규모 시스템에서 Layered Architecture 는 모듈화, 보안, 트랜잭션 처리에 강점을 보이며, 조직 내 여러 팀이 계층별로 협업할 수 있는 구조 제공.</p></li><li><p><strong>콘텐츠 관리 시스템</strong>:<br>콘텐츠 CRUD 처리에 적합한 전통적 계층 구조를 사용. 콘텐츠 재사용성과 보안적 템플릿 처리에 유리하며, 중소형 시스템에 적합.</p></li><li><p><strong>마이크로서비스 플랫폼</strong>:<br>서비스마다 독립된 계층 구조를 가지며, 도메인 주도 설계 (DDD) 와 Hexagonal 구조를 채택해 유연한 API, 메시지 통신, 독립 배포를 실현.</p></li><li><p><strong>헬스케어 및 규제 산업</strong>:<br>보안, 인증, 민감 정보 보호가 중요한 도메인으로, Layered 구조는 보안계층과 서비스 계층의 명확한 분리를 통해 법적 요구사항을 충족함.</p></li><li><p><strong>레거시 시스템 현대화</strong>:<br>기존 계층 구조를 활용하여 점진적으로 Onion/Clean 아키텍처로 이동하는 방식. Hibernate, Repository 추상화 등을 통해 도메인 중심 설계로 이행 가능.</p></li><li><p><strong>클라우드 네이티브 시스템</strong>:<br>BFF 또는 서버리스 환경에서는 전통 계층 구조를 경량화하거나 메시지 중심 구조와 결합해 비동기 확장성과 민첩한 개발을 지원함.</p></li></ul><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><h4 id=사례-1-전자상거래-플랫폼의-주문-관리-시스템>사례 1: 전자상거래 플랫폼의 주문 관리 시스템<a hidden class=anchor aria-hidden=true href=#사례-1-전자상거래-플랫폼의-주문-관리-시스템>#</a></h4><p><strong>시스템 구성</strong>:</p><ul><li>Presentation Layer: REST API Controller</li><li>Application Layer: Order Use Cases</li><li>Domain Layer: Order Aggregate, Product Entity</li><li>Infrastructure Layer: Database Repository, Payment Gateway</li></ul><p><strong>시스템 구성 다이어그램</strong>:</p><pre class=mermaid>graph TB
    subgraph &#34;Infrastructure Layer&#34;
        A[REST Controller]
        B[Database Repository]
        C[Payment Gateway]
        D[Email Service]
    end
    
    subgraph &#34;Application Layer&#34;
        E[Create Order Use Case]
        F[Process Payment Use Case]
        G[Send Notification Use Case]
    end
    
    subgraph &#34;Domain Layer&#34;
        H[Order Aggregate]
        I[Product Entity]
        J[Customer Entity]
        K[Payment Value Object]
    end
    
    A --&gt; E
    E --&gt; H
    E --&gt; I
    E --&gt; J
    B -.-&gt; E
    C -.-&gt; F
    D -.-&gt; G
    F --&gt; K
</pre><p><strong>Workflow</strong>:</p><ul><li>고객이 주문 생성 요청</li><li>REST Controller 가 요청 수신</li><li>Create Order Use Case 실행</li><li>Order Aggregate 가 비즈니스 규칙 검증</li><li>Database Repository 를 통한 데이터 저장</li><li>Payment Gateway 를 통한 결제 처리</li></ul><p><strong>역할</strong>:</p><ul><li>Domain Layer: 주문 생성 규칙, 재고 확인 로직</li><li>Application Layer: 유스케이스 조정, 외부 서비스 호출</li><li>Infrastructure Layer: 데이터 영속성, 외부 API 연동</li></ul><p><strong>유무에 따른 차이점</strong>:</p><ul><li>있는 경우: 명확한 책임 분리, 테스트 용이성, 유지보수성 향상</li><li>없는 경우: 스파게티 코드, 비즈니스 로직 분산, 테스트 어려움</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-52-1><a class=lnlinks href=#hl-52-1> 1</a>
</span><span class=lnt id=hl-52-2><a class=lnlinks href=#hl-52-2> 2</a>
</span><span class=lnt id=hl-52-3><a class=lnlinks href=#hl-52-3> 3</a>
</span><span class=lnt id=hl-52-4><a class=lnlinks href=#hl-52-4> 4</a>
</span><span class=lnt id=hl-52-5><a class=lnlinks href=#hl-52-5> 5</a>
</span><span class=lnt id=hl-52-6><a class=lnlinks href=#hl-52-6> 6</a>
</span><span class=lnt id=hl-52-7><a class=lnlinks href=#hl-52-7> 7</a>
</span><span class=lnt id=hl-52-8><a class=lnlinks href=#hl-52-8> 8</a>
</span><span class=lnt id=hl-52-9><a class=lnlinks href=#hl-52-9> 9</a>
</span><span class=lnt id=hl-52-10><a class=lnlinks href=#hl-52-10>10</a>
</span><span class=lnt id=hl-52-11><a class=lnlinks href=#hl-52-11>11</a>
</span><span class=lnt id=hl-52-12><a class=lnlinks href=#hl-52-12>12</a>
</span><span class=lnt id=hl-52-13><a class=lnlinks href=#hl-52-13>13</a>
</span><span class=lnt id=hl-52-14><a class=lnlinks href=#hl-52-14>14</a>
</span><span class=lnt id=hl-52-15><a class=lnlinks href=#hl-52-15>15</a>
</span><span class=lnt id=hl-52-16><a class=lnlinks href=#hl-52-16>16</a>
</span><span class=lnt id=hl-52-17><a class=lnlinks href=#hl-52-17>17</a>
</span><span class=lnt id=hl-52-18><a class=lnlinks href=#hl-52-18>18</a>
</span><span class=lnt id=hl-52-19><a class=lnlinks href=#hl-52-19>19</a>
</span><span class=lnt id=hl-52-20><a class=lnlinks href=#hl-52-20>20</a>
</span><span class=lnt id=hl-52-21><a class=lnlinks href=#hl-52-21>21</a>
</span><span class=lnt id=hl-52-22><a class=lnlinks href=#hl-52-22>22</a>
</span><span class=lnt id=hl-52-23><a class=lnlinks href=#hl-52-23>23</a>
</span><span class=lnt id=hl-52-24><a class=lnlinks href=#hl-52-24>24</a>
</span><span class=lnt id=hl-52-25><a class=lnlinks href=#hl-52-25>25</a>
</span><span class=lnt id=hl-52-26><a class=lnlinks href=#hl-52-26>26</a>
</span><span class=lnt id=hl-52-27><a class=lnlinks href=#hl-52-27>27</a>
</span><span class=lnt id=hl-52-28><a class=lnlinks href=#hl-52-28>28</a>
</span><span class=lnt id=hl-52-29><a class=lnlinks href=#hl-52-29>29</a>
</span><span class=lnt id=hl-52-30><a class=lnlinks href=#hl-52-30>30</a>
</span><span class=lnt id=hl-52-31><a class=lnlinks href=#hl-52-31>31</a>
</span><span class=lnt id=hl-52-32><a class=lnlinks href=#hl-52-32>32</a>
</span><span class=lnt id=hl-52-33><a class=lnlinks href=#hl-52-33>33</a>
</span><span class=lnt id=hl-52-34><a class=lnlinks href=#hl-52-34>34</a>
</span><span class=lnt id=hl-52-35><a class=lnlinks href=#hl-52-35>35</a>
</span><span class=lnt id=hl-52-36><a class=lnlinks href=#hl-52-36>36</a>
</span><span class=lnt id=hl-52-37><a class=lnlinks href=#hl-52-37>37</a>
</span><span class=lnt id=hl-52-38><a class=lnlinks href=#hl-52-38>38</a>
</span><span class=lnt id=hl-52-39><a class=lnlinks href=#hl-52-39>39</a>
</span><span class=lnt id=hl-52-40><a class=lnlinks href=#hl-52-40>40</a>
</span><span class=lnt id=hl-52-41><a class=lnlinks href=#hl-52-41>41</a>
</span><span class=lnt id=hl-52-42><a class=lnlinks href=#hl-52-42>42</a>
</span><span class=lnt id=hl-52-43><a class=lnlinks href=#hl-52-43>43</a>
</span><span class=lnt id=hl-52-44><a class=lnlinks href=#hl-52-44>44</a>
</span><span class=lnt id=hl-52-45><a class=lnlinks href=#hl-52-45>45</a>
</span><span class=lnt id=hl-52-46><a class=lnlinks href=#hl-52-46>46</a>
</span><span class=lnt id=hl-52-47><a class=lnlinks href=#hl-52-47>47</a>
</span><span class=lnt id=hl-52-48><a class=lnlinks href=#hl-52-48>48</a>
</span><span class=lnt id=hl-52-49><a class=lnlinks href=#hl-52-49>49</a>
</span><span class=lnt id=hl-52-50><a class=lnlinks href=#hl-52-50>50</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Domain Layer</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Order</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>id</span> <span class=o>=</span> <span class=n>generate_id</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>customer_id</span> <span class=o>=</span> <span class=n>customer_id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>items</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=n>OrderStatus</span><span class=o>.</span><span class=n>PENDING</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_item</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>product</span><span class=p>:</span> <span class=n>Product</span><span class=p>,</span> <span class=n>quantity</span><span class=p>:</span> <span class=nb>int</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>quantity</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Quantity must be positive&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>product</span><span class=o>.</span><span class=n>stock</span> <span class=o>&lt;</span> <span class=n>quantity</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>InsufficientStockError</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>item</span> <span class=o>=</span> <span class=n>OrderItem</span><span class=p>(</span><span class=n>product</span><span class=p>,</span> <span class=n>quantity</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>calculate_total</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Money</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>sum</span><span class=p>(</span><span class=n>item</span><span class=o>.</span><span class=n>subtotal</span><span class=p>()</span> <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>items</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Application Layer</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CreateOrderUseCase</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_repo</span><span class=p>:</span> <span class=n>OrderRepository</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                 <span class=n>product_repo</span><span class=p>:</span> <span class=n>ProductRepository</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_order_repo</span> <span class=o>=</span> <span class=n>order_repo</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_product_repo</span> <span class=o>=</span> <span class=n>product_repo</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>execute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>:</span> <span class=n>CreateOrderRequest</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>CreateOrderResponse</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>order</span> <span class=o>=</span> <span class=n>Order</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>customer_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>item_request</span> <span class=ow>in</span> <span class=n>request</span><span class=o>.</span><span class=n>items</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>product</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_product_repo</span><span class=o>.</span><span class=n>find_by_id</span><span class=p>(</span><span class=n>item_request</span><span class=o>.</span><span class=n>product_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>order</span><span class=o>.</span><span class=n>add_item</span><span class=p>(</span><span class=n>product</span><span class=p>,</span> <span class=n>item_request</span><span class=o>.</span><span class=n>quantity</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>saved_order</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_order_repo</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>order</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>CreateOrderResponse</span><span class=p>(</span><span class=n>saved_order</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Infrastructure Layer</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderController</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>create_order_use_case</span><span class=p>:</span> <span class=n>CreateOrderUseCase</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_create_order_use_case</span> <span class=o>=</span> <span class=n>create_order_use_case</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_order</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>request</span> <span class=o>=</span> <span class=n>CreateOrderRequest</span><span class=o>.</span><span class=n>from_dict</span><span class=p>(</span><span class=n>request_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>response</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_create_order_use_case</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;order_id&#34;</span><span class=p>:</span> <span class=n>response</span><span class=o>.</span><span class=n>order_id</span><span class=p>},</span> <span class=mi>201</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>ValidationError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)},</span> <span class=mi>400</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-2-대형-전자상거래-시스템>사례 2: 대형 전자상거래 시스템<a hidden class=anchor aria-hidden=true href=#사례-2-대형-전자상거래-시스템>#</a></h4><p><strong>시나리오</strong>: 대형 전자상거래 시스템의 주문 프로세스를 계층형 아키텍처로 구축<br><strong>시스템 구성</strong>:</p><ul><li>프런트엔드 (프리젠테이션 계층)</li><li>주문 서비스 (비즈니스 계층)</li><li>주문 저장소 (데이터 접근 계층)</li><li>기타 배송/결제 연동 (서비스/통합 계층)</li></ul><pre class=mermaid>flowchart RL
    Customer -- 주문요청 --&gt; UI[웹/모바일 프런트엔드]
    UI --API호출--&gt; BL[&#34;OrderService(비즈니스 계층)&#34;]
    BL --DB조작--&gt; DAL[&#34;OrderRepository(데이터 접근 계층)&#34;]
    BL --서비스연동--&gt; Integration[&#34;배송/결제 API(통합 계층)&#34;]
</pre><p><strong>Workflow</strong>:</p><ul><li>사용자가 주문을 입력 → 프런트엔드가 주문 서비스에 API 호출 → 주문 내역 저장 및 검증 → 결제/배송 시스템 연동 → 응답</li></ul><p><strong>역할</strong>:</p><ul><li>각 계층별로 입력값 검증, 비즈니스 처리, 데이터 저장, 외부 연동이 분리됨</li></ul><p><strong>유무에 따른 차이점</strong>:</p><ul><li>계층형 적용: 각 업무별 독립적 배포 및 변경 가능, 장애/이슈 국소화 가능</li><li>계층형 미적용: 전체 서비스가 단일 동작, 변경 시 전체 영향, 문제점 진단 난이도↑</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-54-1><a class=lnlinks href=#hl-54-1> 1</a>
</span><span class=lnt id=hl-54-2><a class=lnlinks href=#hl-54-2> 2</a>
</span><span class=lnt id=hl-54-3><a class=lnlinks href=#hl-54-3> 3</a>
</span><span class=lnt id=hl-54-4><a class=lnlinks href=#hl-54-4> 4</a>
</span><span class=lnt id=hl-54-5><a class=lnlinks href=#hl-54-5> 5</a>
</span><span class=lnt id=hl-54-6><a class=lnlinks href=#hl-54-6> 6</a>
</span><span class=lnt id=hl-54-7><a class=lnlinks href=#hl-54-7> 7</a>
</span><span class=lnt id=hl-54-8><a class=lnlinks href=#hl-54-8> 8</a>
</span><span class=lnt id=hl-54-9><a class=lnlinks href=#hl-54-9> 9</a>
</span><span class=lnt id=hl-54-10><a class=lnlinks href=#hl-54-10>10</a>
</span><span class=lnt id=hl-54-11><a class=lnlinks href=#hl-54-11>11</a>
</span><span class=lnt id=hl-54-12><a class=lnlinks href=#hl-54-12>12</a>
</span><span class=lnt id=hl-54-13><a class=lnlinks href=#hl-54-13>13</a>
</span><span class=lnt id=hl-54-14><a class=lnlinks href=#hl-54-14>14</a>
</span><span class=lnt id=hl-54-15><a class=lnlinks href=#hl-54-15>15</a>
</span><span class=lnt id=hl-54-16><a class=lnlinks href=#hl-54-16>16</a>
</span><span class=lnt id=hl-54-17><a class=lnlinks href=#hl-54-17>17</a>
</span><span class=lnt id=hl-54-18><a class=lnlinks href=#hl-54-18>18</a>
</span><span class=lnt id=hl-54-19><a class=lnlinks href=#hl-54-19>19</a>
</span><span class=lnt id=hl-54-20><a class=lnlinks href=#hl-54-20>20</a>
</span><span class=lnt id=hl-54-21><a class=lnlinks href=#hl-54-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 프리젠테이션 계층</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderController</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>service</span><span class=p>):</span> <span class=bp>self</span><span class=o>.</span><span class=n>service</span> <span class=o>=</span> <span class=n>service</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>req</span><span class=p>):</span> <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>service</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>req</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 비즈니스 계층</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>repo</span><span class=p>,</span> <span class=n>integration</span><span class=p>):</span> 
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>repo</span> <span class=o>=</span> <span class=n>repo</span><span class=p>;</span> <span class=bp>self</span><span class=o>.</span><span class=n>integration</span> <span class=o>=</span> <span class=n>integration</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_req</span><span class=p>):</span>  
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>repo</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>order_req</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>integration</span><span class=o>.</span><span class=n>notify</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 데이터 접근 계층</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderRepository</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>save</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order</span><span class=p>):</span> <span class=c1># DB 저장 로직 return True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 통합 계층</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DeliveryIntegration</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>notify</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order</span><span class=p>):</span> <span class=c1># 배송 연동 API 호출</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-3-clean-architecture-기반-사용자-등록-기능>사례 3: Clean Architecture 기반 사용자 등록 기능<a hidden class=anchor aria-hidden=true href=#사례-3-clean-architecture-기반-사용자-등록-기능>#</a></h4><p><strong>시나리오</strong>: 유저 이메일/비밀번호로 신규 가입 처리 및 검증 로직</p><p><strong>시스템 구성</strong>:</p><ul><li>Domain Layer (User, EmailValueObject 등 핵심 엔티티)</li><li>Application Layer (RegisterUseCase)</li><li>Interface Adapters (input DTO, output DTO, presenter)</li><li>Infrastructure Layer (DB repository 구현, 암호화 서비스 어댑터)</li></ul><pre class=mermaid>graph TD
  UI --&gt;|RegisterRequest| UseCase
  UseCase --&gt; DomainEntity
  UseCase --&gt;|IUserRepository| Interface
  Interface --&gt; RepoImpl
  RepoImpl --&gt; DB
</pre><p><strong>Workflow</strong>:</p><ul><li>UI 또는 API 가 RegisterRequest 전송</li><li>Application Layer 의 RegisterUseCase 가 호출</li><li>Domain Entity 이메일 중복 검증, 비밀번호 해시 처리</li><li>IUserRepository 인터페이스 호출 → Infrastructure Layer RepoImpl 수행</li><li>결과가 DTO 로 반환</li></ul><p><strong>역할</strong>:</p><ul><li><strong>Domain</strong>: 이메일 규칙·유효성, 유저 생성 로직</li><li><strong>Use Case</strong>: 유스케이스 관리, 흐름 제어, 인터페이스 호출</li><li><strong>Adapter (Interface)</strong>: Use Case 와 Infrastructure 연계 인터페이스</li><li><strong>Infrastructure</strong>: 실제 DB 저장, 해시 서비스 구현</li></ul><p><strong>유무에 따른 차이점</strong>:</p><ul><li>기존 전통적 Layered 에서는 BLL 이 직접 DB 연결, 테스트 어려움</li><li>Clean Architecture 는 IUserRepository 추상화로 인프라 교체 가능, 유닛 테스트용 모킹 제공</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-56-1><a class=lnlinks href=#hl-56-1> 1</a>
</span><span class=lnt id=hl-56-2><a class=lnlinks href=#hl-56-2> 2</a>
</span><span class=lnt id=hl-56-3><a class=lnlinks href=#hl-56-3> 3</a>
</span><span class=lnt id=hl-56-4><a class=lnlinks href=#hl-56-4> 4</a>
</span><span class=lnt id=hl-56-5><a class=lnlinks href=#hl-56-5> 5</a>
</span><span class=lnt id=hl-56-6><a class=lnlinks href=#hl-56-6> 6</a>
</span><span class=lnt id=hl-56-7><a class=lnlinks href=#hl-56-7> 7</a>
</span><span class=lnt id=hl-56-8><a class=lnlinks href=#hl-56-8> 8</a>
</span><span class=lnt id=hl-56-9><a class=lnlinks href=#hl-56-9> 9</a>
</span><span class=lnt id=hl-56-10><a class=lnlinks href=#hl-56-10>10</a>
</span><span class=lnt id=hl-56-11><a class=lnlinks href=#hl-56-11>11</a>
</span><span class=lnt id=hl-56-12><a class=lnlinks href=#hl-56-12>12</a>
</span><span class=lnt id=hl-56-13><a class=lnlinks href=#hl-56-13>13</a>
</span><span class=lnt id=hl-56-14><a class=lnlinks href=#hl-56-14>14</a>
</span><span class=lnt id=hl-56-15><a class=lnlinks href=#hl-56-15>15</a>
</span><span class=lnt id=hl-56-16><a class=lnlinks href=#hl-56-16>16</a>
</span><span class=lnt id=hl-56-17><a class=lnlinks href=#hl-56-17>17</a>
</span><span class=lnt id=hl-56-18><a class=lnlinks href=#hl-56-18>18</a>
</span><span class=lnt id=hl-56-19><a class=lnlinks href=#hl-56-19>19</a>
</span><span class=lnt id=hl-56-20><a class=lnlinks href=#hl-56-20>20</a>
</span><span class=lnt id=hl-56-21><a class=lnlinks href=#hl-56-21>21</a>
</span><span class=lnt id=hl-56-22><a class=lnlinks href=#hl-56-22>22</a>
</span><span class=lnt id=hl-56-23><a class=lnlinks href=#hl-56-23>23</a>
</span><span class=lnt id=hl-56-24><a class=lnlinks href=#hl-56-24>24</a>
</span><span class=lnt id=hl-56-25><a class=lnlinks href=#hl-56-25>25</a>
</span><span class=lnt id=hl-56-26><a class=lnlinks href=#hl-56-26>26</a>
</span><span class=lnt id=hl-56-27><a class=lnlinks href=#hl-56-27>27</a>
</span><span class=lnt id=hl-56-28><a class=lnlinks href=#hl-56-28>28</a>
</span><span class=lnt id=hl-56-29><a class=lnlinks href=#hl-56-29>29</a>
</span><span class=lnt id=hl-56-30><a class=lnlinks href=#hl-56-30>30</a>
</span><span class=lnt id=hl-56-31><a class=lnlinks href=#hl-56-31>31</a>
</span><span class=lnt id=hl-56-32><a class=lnlinks href=#hl-56-32>32</a>
</span><span class=lnt id=hl-56-33><a class=lnlinks href=#hl-56-33>33</a>
</span><span class=lnt id=hl-56-34><a class=lnlinks href=#hl-56-34>34</a>
</span><span class=lnt id=hl-56-35><a class=lnlinks href=#hl-56-35>35</a>
</span><span class=lnt id=hl-56-36><a class=lnlinks href=#hl-56-36>36</a>
</span><span class=lnt id=hl-56-37><a class=lnlinks href=#hl-56-37>37</a>
</span><span class=lnt id=hl-56-38><a class=lnlinks href=#hl-56-38>38</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># domain/entities.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>email</span><span class=p>,</span> <span class=n>password_hash</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>email</span> <span class=o>=</span> <span class=n>email</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>password_hash</span> <span class=o>=</span> <span class=n>password_hash</span>
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create</span><span class=p>(</span><span class=n>email</span><span class=p>,</span> <span class=n>raw_password</span><span class=p>,</span> <span class=n>password_service</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>email</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s1>&#39;@example.com&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Invalid email domain&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>User</span><span class=p>(</span><span class=n>email</span><span class=p>,</span> <span class=n>password_service</span><span class=o>.</span><span class=n>hash</span><span class=p>(</span><span class=n>raw_password</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># application/usecase.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>RegisterUseCase</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_repo</span><span class=p>,</span> <span class=n>password_service</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_repo</span> <span class=o>=</span> <span class=n>user_repo</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>password_service</span> <span class=o>=</span> <span class=n>password_service</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>execute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>email</span><span class=p>,</span> <span class=n>raw_password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>user_repo</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>email</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;success&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Email already exists&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>email</span><span class=p>,</span> <span class=n>raw_password</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>password_service</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_repo</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;success&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s1>&#39;user_email&#39;</span><span class=p>:</span> <span class=n>user</span><span class=o>.</span><span class=n>email</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># infrastructure/repos.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SqlUserRepository</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>db_session</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db</span> <span class=o>=</span> <span class=n>db_session</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>exists</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>email</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>query_user_by_email</span><span class=p>(</span><span class=n>email</span><span class=p>)</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>save</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>insert_user</span><span class=p>({</span> <span class=s1>&#39;email&#39;</span><span class=p>:</span> <span class=n>user</span><span class=o>.</span><span class=n>email</span><span class=p>,</span> <span class=s1>&#39;hash&#39;</span><span class=p>:</span> <span class=n>user</span><span class=o>.</span><span class=n>password_hash</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># infrastructure/services.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>BcryptPasswordService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>hash</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>raw</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=kn>import</span> <span class=nn>bcrypt</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>bcrypt</span><span class=o>.</span><span class=n>hashpw</span><span class=p>(</span><span class=n>raw</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>bcrypt</span><span class=o>.</span><span class=n>gensalt</span><span class=p>())</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-4-온라인-쇼핑몰-시스템>사례 4: 온라인 쇼핑몰 시스템<a hidden class=anchor aria-hidden=true href=#사례-4-온라인-쇼핑몰-시스템>#</a></h4><p><strong>시나리오</strong>: 온라인 쇼핑몰 시스템</p><p><strong>시스템 구성</strong>:</p><ul><li>프레젠테이션 계층: React.js 기반 웹 인터페이스</li><li>비즈니스 계층: Node.js/Express 기반 API 서버</li><li>데이터 접근 계층: Sequelize ORM</li><li>데이터베이스 계층: PostgreSQL</li></ul><pre class=mermaid>graph TB
    subgraph &#34;프레젠테이션 계층&#34;
        UI[웹 브라우저 UI&lt;br/&gt;React.js]
        Mobile[모바일 앱&lt;br/&gt;React Native]
    end
    
    subgraph &#34;비즈니스 계층&#34;
        API[API 서버&lt;br/&gt;Node.js/Express]
        Auth[인증 서비스]
        Order[주문 처리 서비스]
        Payment[결제 서비스]
    end
    
    subgraph &#34;데이터 접근 계층&#34;
        ORM[Sequelize ORM]
        Cache[Redis 캐시]
    end
    
    subgraph &#34;데이터베이스 계층&#34;
        DB[(PostgreSQL)]
        Files[(파일 저장소)]
    end
    
    UI --&gt; API
    Mobile --&gt; API
    API --&gt; Auth
    API --&gt; Order
    API --&gt; Payment
    API --&gt; ORM
    ORM --&gt; Cache
    ORM --&gt; DB
    API --&gt; Files
</pre><p><strong>Workflow</strong>:</p><ul><li>사용자가 상품 검색 요청을 웹 인터페이스에서 입력</li><li>프레젠테이션 계층에서 입력 검증 후 API 서버로 요청 전달</li><li>비즈니스 계층에서 검색 로직 처리 및 인증 확인</li><li>데이터 접근 계층에서 캐시 확인 후 필요시 데이터베이스 조회</li><li>결과를 역순으로 전달하여 사용자 인터페이스에 표시</li></ul><p><strong>역할</strong>:</p><ul><li>프레젠테이션 계층: 사용자 경험 최적화와 입력 검증</li><li>비즈니스 계층: 쇼핑몰 비즈니스 규칙과 워크플로 관리</li><li>데이터 접근 계층: 성능 최적화와 데이터 매핑</li><li>데이터베이스 계층: 데이터 영속성과 무결성 보장</li></ul><p><strong>유무에 따른 차이점</strong>:</p><ul><li>계층형 아키텍처 적용 시: 모듈별 독립 개발, 확장성, 유지보수 용이성</li><li>미적용 시: 개발 속도는 빠르나 장기적 유지보수 어려움, 확장성 제한</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-58-1><a class=lnlinks href=#hl-58-1>  1</a>
</span><span class=lnt id=hl-58-2><a class=lnlinks href=#hl-58-2>  2</a>
</span><span class=lnt id=hl-58-3><a class=lnlinks href=#hl-58-3>  3</a>
</span><span class=lnt id=hl-58-4><a class=lnlinks href=#hl-58-4>  4</a>
</span><span class=lnt id=hl-58-5><a class=lnlinks href=#hl-58-5>  5</a>
</span><span class=lnt id=hl-58-6><a class=lnlinks href=#hl-58-6>  6</a>
</span><span class=lnt id=hl-58-7><a class=lnlinks href=#hl-58-7>  7</a>
</span><span class=lnt id=hl-58-8><a class=lnlinks href=#hl-58-8>  8</a>
</span><span class=lnt id=hl-58-9><a class=lnlinks href=#hl-58-9>  9</a>
</span><span class=lnt id=hl-58-10><a class=lnlinks href=#hl-58-10> 10</a>
</span><span class=lnt id=hl-58-11><a class=lnlinks href=#hl-58-11> 11</a>
</span><span class=lnt id=hl-58-12><a class=lnlinks href=#hl-58-12> 12</a>
</span><span class=lnt id=hl-58-13><a class=lnlinks href=#hl-58-13> 13</a>
</span><span class=lnt id=hl-58-14><a class=lnlinks href=#hl-58-14> 14</a>
</span><span class=lnt id=hl-58-15><a class=lnlinks href=#hl-58-15> 15</a>
</span><span class=lnt id=hl-58-16><a class=lnlinks href=#hl-58-16> 16</a>
</span><span class=lnt id=hl-58-17><a class=lnlinks href=#hl-58-17> 17</a>
</span><span class=lnt id=hl-58-18><a class=lnlinks href=#hl-58-18> 18</a>
</span><span class=lnt id=hl-58-19><a class=lnlinks href=#hl-58-19> 19</a>
</span><span class=lnt id=hl-58-20><a class=lnlinks href=#hl-58-20> 20</a>
</span><span class=lnt id=hl-58-21><a class=lnlinks href=#hl-58-21> 21</a>
</span><span class=lnt id=hl-58-22><a class=lnlinks href=#hl-58-22> 22</a>
</span><span class=lnt id=hl-58-23><a class=lnlinks href=#hl-58-23> 23</a>
</span><span class=lnt id=hl-58-24><a class=lnlinks href=#hl-58-24> 24</a>
</span><span class=lnt id=hl-58-25><a class=lnlinks href=#hl-58-25> 25</a>
</span><span class=lnt id=hl-58-26><a class=lnlinks href=#hl-58-26> 26</a>
</span><span class=lnt id=hl-58-27><a class=lnlinks href=#hl-58-27> 27</a>
</span><span class=lnt id=hl-58-28><a class=lnlinks href=#hl-58-28> 28</a>
</span><span class=lnt id=hl-58-29><a class=lnlinks href=#hl-58-29> 29</a>
</span><span class=lnt id=hl-58-30><a class=lnlinks href=#hl-58-30> 30</a>
</span><span class=lnt id=hl-58-31><a class=lnlinks href=#hl-58-31> 31</a>
</span><span class=lnt id=hl-58-32><a class=lnlinks href=#hl-58-32> 32</a>
</span><span class=lnt id=hl-58-33><a class=lnlinks href=#hl-58-33> 33</a>
</span><span class=lnt id=hl-58-34><a class=lnlinks href=#hl-58-34> 34</a>
</span><span class=lnt id=hl-58-35><a class=lnlinks href=#hl-58-35> 35</a>
</span><span class=lnt id=hl-58-36><a class=lnlinks href=#hl-58-36> 36</a>
</span><span class=lnt id=hl-58-37><a class=lnlinks href=#hl-58-37> 37</a>
</span><span class=lnt id=hl-58-38><a class=lnlinks href=#hl-58-38> 38</a>
</span><span class=lnt id=hl-58-39><a class=lnlinks href=#hl-58-39> 39</a>
</span><span class=lnt id=hl-58-40><a class=lnlinks href=#hl-58-40> 40</a>
</span><span class=lnt id=hl-58-41><a class=lnlinks href=#hl-58-41> 41</a>
</span><span class=lnt id=hl-58-42><a class=lnlinks href=#hl-58-42> 42</a>
</span><span class=lnt id=hl-58-43><a class=lnlinks href=#hl-58-43> 43</a>
</span><span class=lnt id=hl-58-44><a class=lnlinks href=#hl-58-44> 44</a>
</span><span class=lnt id=hl-58-45><a class=lnlinks href=#hl-58-45> 45</a>
</span><span class=lnt id=hl-58-46><a class=lnlinks href=#hl-58-46> 46</a>
</span><span class=lnt id=hl-58-47><a class=lnlinks href=#hl-58-47> 47</a>
</span><span class=lnt id=hl-58-48><a class=lnlinks href=#hl-58-48> 48</a>
</span><span class=lnt id=hl-58-49><a class=lnlinks href=#hl-58-49> 49</a>
</span><span class=lnt id=hl-58-50><a class=lnlinks href=#hl-58-50> 50</a>
</span><span class=lnt id=hl-58-51><a class=lnlinks href=#hl-58-51> 51</a>
</span><span class=lnt id=hl-58-52><a class=lnlinks href=#hl-58-52> 52</a>
</span><span class=lnt id=hl-58-53><a class=lnlinks href=#hl-58-53> 53</a>
</span><span class=lnt id=hl-58-54><a class=lnlinks href=#hl-58-54> 54</a>
</span><span class=lnt id=hl-58-55><a class=lnlinks href=#hl-58-55> 55</a>
</span><span class=lnt id=hl-58-56><a class=lnlinks href=#hl-58-56> 56</a>
</span><span class=lnt id=hl-58-57><a class=lnlinks href=#hl-58-57> 57</a>
</span><span class=lnt id=hl-58-58><a class=lnlinks href=#hl-58-58> 58</a>
</span><span class=lnt id=hl-58-59><a class=lnlinks href=#hl-58-59> 59</a>
</span><span class=lnt id=hl-58-60><a class=lnlinks href=#hl-58-60> 60</a>
</span><span class=lnt id=hl-58-61><a class=lnlinks href=#hl-58-61> 61</a>
</span><span class=lnt id=hl-58-62><a class=lnlinks href=#hl-58-62> 62</a>
</span><span class=lnt id=hl-58-63><a class=lnlinks href=#hl-58-63> 63</a>
</span><span class=lnt id=hl-58-64><a class=lnlinks href=#hl-58-64> 64</a>
</span><span class=lnt id=hl-58-65><a class=lnlinks href=#hl-58-65> 65</a>
</span><span class=lnt id=hl-58-66><a class=lnlinks href=#hl-58-66> 66</a>
</span><span class=lnt id=hl-58-67><a class=lnlinks href=#hl-58-67> 67</a>
</span><span class=lnt id=hl-58-68><a class=lnlinks href=#hl-58-68> 68</a>
</span><span class=lnt id=hl-58-69><a class=lnlinks href=#hl-58-69> 69</a>
</span><span class=lnt id=hl-58-70><a class=lnlinks href=#hl-58-70> 70</a>
</span><span class=lnt id=hl-58-71><a class=lnlinks href=#hl-58-71> 71</a>
</span><span class=lnt id=hl-58-72><a class=lnlinks href=#hl-58-72> 72</a>
</span><span class=lnt id=hl-58-73><a class=lnlinks href=#hl-58-73> 73</a>
</span><span class=lnt id=hl-58-74><a class=lnlinks href=#hl-58-74> 74</a>
</span><span class=lnt id=hl-58-75><a class=lnlinks href=#hl-58-75> 75</a>
</span><span class=lnt id=hl-58-76><a class=lnlinks href=#hl-58-76> 76</a>
</span><span class=lnt id=hl-58-77><a class=lnlinks href=#hl-58-77> 77</a>
</span><span class=lnt id=hl-58-78><a class=lnlinks href=#hl-58-78> 78</a>
</span><span class=lnt id=hl-58-79><a class=lnlinks href=#hl-58-79> 79</a>
</span><span class=lnt id=hl-58-80><a class=lnlinks href=#hl-58-80> 80</a>
</span><span class=lnt id=hl-58-81><a class=lnlinks href=#hl-58-81> 81</a>
</span><span class=lnt id=hl-58-82><a class=lnlinks href=#hl-58-82> 82</a>
</span><span class=lnt id=hl-58-83><a class=lnlinks href=#hl-58-83> 83</a>
</span><span class=lnt id=hl-58-84><a class=lnlinks href=#hl-58-84> 84</a>
</span><span class=lnt id=hl-58-85><a class=lnlinks href=#hl-58-85> 85</a>
</span><span class=lnt id=hl-58-86><a class=lnlinks href=#hl-58-86> 86</a>
</span><span class=lnt id=hl-58-87><a class=lnlinks href=#hl-58-87> 87</a>
</span><span class=lnt id=hl-58-88><a class=lnlinks href=#hl-58-88> 88</a>
</span><span class=lnt id=hl-58-89><a class=lnlinks href=#hl-58-89> 89</a>
</span><span class=lnt id=hl-58-90><a class=lnlinks href=#hl-58-90> 90</a>
</span><span class=lnt id=hl-58-91><a class=lnlinks href=#hl-58-91> 91</a>
</span><span class=lnt id=hl-58-92><a class=lnlinks href=#hl-58-92> 92</a>
</span><span class=lnt id=hl-58-93><a class=lnlinks href=#hl-58-93> 93</a>
</span><span class=lnt id=hl-58-94><a class=lnlinks href=#hl-58-94> 94</a>
</span><span class=lnt id=hl-58-95><a class=lnlinks href=#hl-58-95> 95</a>
</span><span class=lnt id=hl-58-96><a class=lnlinks href=#hl-58-96> 96</a>
</span><span class=lnt id=hl-58-97><a class=lnlinks href=#hl-58-97> 97</a>
</span><span class=lnt id=hl-58-98><a class=lnlinks href=#hl-58-98> 98</a>
</span><span class=lnt id=hl-58-99><a class=lnlinks href=#hl-58-99> 99</a>
</span><span class=lnt id=hl-58-100><a class=lnlinks href=#hl-58-100>100</a>
</span><span class=lnt id=hl-58-101><a class=lnlinks href=#hl-58-101>101</a>
</span><span class=lnt id=hl-58-102><a class=lnlinks href=#hl-58-102>102</a>
</span><span class=lnt id=hl-58-103><a class=lnlinks href=#hl-58-103>103</a>
</span><span class=lnt id=hl-58-104><a class=lnlinks href=#hl-58-104>104</a>
</span><span class=lnt id=hl-58-105><a class=lnlinks href=#hl-58-105>105</a>
</span><span class=lnt id=hl-58-106><a class=lnlinks href=#hl-58-106>106</a>
</span><span class=lnt id=hl-58-107><a class=lnlinks href=#hl-58-107>107</a>
</span><span class=lnt id=hl-58-108><a class=lnlinks href=#hl-58-108>108</a>
</span><span class=lnt id=hl-58-109><a class=lnlinks href=#hl-58-109>109</a>
</span><span class=lnt id=hl-58-110><a class=lnlinks href=#hl-58-110>110</a>
</span><span class=lnt id=hl-58-111><a class=lnlinks href=#hl-58-111>111</a>
</span><span class=lnt id=hl-58-112><a class=lnlinks href=#hl-58-112>112</a>
</span><span class=lnt id=hl-58-113><a class=lnlinks href=#hl-58-113>113</a>
</span><span class=lnt id=hl-58-114><a class=lnlinks href=#hl-58-114>114</a>
</span><span class=lnt id=hl-58-115><a class=lnlinks href=#hl-58-115>115</a>
</span><span class=lnt id=hl-58-116><a class=lnlinks href=#hl-58-116>116</a>
</span><span class=lnt id=hl-58-117><a class=lnlinks href=#hl-58-117>117</a>
</span><span class=lnt id=hl-58-118><a class=lnlinks href=#hl-58-118>118</a>
</span><span class=lnt id=hl-58-119><a class=lnlinks href=#hl-58-119>119</a>
</span><span class=lnt id=hl-58-120><a class=lnlinks href=#hl-58-120>120</a>
</span><span class=lnt id=hl-58-121><a class=lnlinks href=#hl-58-121>121</a>
</span><span class=lnt id=hl-58-122><a class=lnlinks href=#hl-58-122>122</a>
</span><span class=lnt id=hl-58-123><a class=lnlinks href=#hl-58-123>123</a>
</span><span class=lnt id=hl-58-124><a class=lnlinks href=#hl-58-124>124</a>
</span><span class=lnt id=hl-58-125><a class=lnlinks href=#hl-58-125>125</a>
</span><span class=lnt id=hl-58-126><a class=lnlinks href=#hl-58-126>126</a>
</span><span class=lnt id=hl-58-127><a class=lnlinks href=#hl-58-127>127</a>
</span><span class=lnt id=hl-58-128><a class=lnlinks href=#hl-58-128>128</a>
</span><span class=lnt id=hl-58-129><a class=lnlinks href=#hl-58-129>129</a>
</span><span class=lnt id=hl-58-130><a class=lnlinks href=#hl-58-130>130</a>
</span><span class=lnt id=hl-58-131><a class=lnlinks href=#hl-58-131>131</a>
</span><span class=lnt id=hl-58-132><a class=lnlinks href=#hl-58-132>132</a>
</span><span class=lnt id=hl-58-133><a class=lnlinks href=#hl-58-133>133</a>
</span><span class=lnt id=hl-58-134><a class=lnlinks href=#hl-58-134>134</a>
</span><span class=lnt id=hl-58-135><a class=lnlinks href=#hl-58-135>135</a>
</span><span class=lnt id=hl-58-136><a class=lnlinks href=#hl-58-136>136</a>
</span><span class=lnt id=hl-58-137><a class=lnlinks href=#hl-58-137>137</a>
</span><span class=lnt id=hl-58-138><a class=lnlinks href=#hl-58-138>138</a>
</span><span class=lnt id=hl-58-139><a class=lnlinks href=#hl-58-139>139</a>
</span><span class=lnt id=hl-58-140><a class=lnlinks href=#hl-58-140>140</a>
</span><span class=lnt id=hl-58-141><a class=lnlinks href=#hl-58-141>141</a>
</span><span class=lnt id=hl-58-142><a class=lnlinks href=#hl-58-142>142</a>
</span><span class=lnt id=hl-58-143><a class=lnlinks href=#hl-58-143>143</a>
</span><span class=lnt id=hl-58-144><a class=lnlinks href=#hl-58-144>144</a>
</span><span class=lnt id=hl-58-145><a class=lnlinks href=#hl-58-145>145</a>
</span><span class=lnt id=hl-58-146><a class=lnlinks href=#hl-58-146>146</a>
</span><span class=lnt id=hl-58-147><a class=lnlinks href=#hl-58-147>147</a>
</span><span class=lnt id=hl-58-148><a class=lnlinks href=#hl-58-148>148</a>
</span><span class=lnt id=hl-58-149><a class=lnlinks href=#hl-58-149>149</a>
</span><span class=lnt id=hl-58-150><a class=lnlinks href=#hl-58-150>150</a>
</span><span class=lnt id=hl-58-151><a class=lnlinks href=#hl-58-151>151</a>
</span><span class=lnt id=hl-58-152><a class=lnlinks href=#hl-58-152>152</a>
</span><span class=lnt id=hl-58-153><a class=lnlinks href=#hl-58-153>153</a>
</span><span class=lnt id=hl-58-154><a class=lnlinks href=#hl-58-154>154</a>
</span><span class=lnt id=hl-58-155><a class=lnlinks href=#hl-58-155>155</a>
</span><span class=lnt id=hl-58-156><a class=lnlinks href=#hl-58-156>156</a>
</span><span class=lnt id=hl-58-157><a class=lnlinks href=#hl-58-157>157</a>
</span><span class=lnt id=hl-58-158><a class=lnlinks href=#hl-58-158>158</a>
</span><span class=lnt id=hl-58-159><a class=lnlinks href=#hl-58-159>159</a>
</span><span class=lnt id=hl-58-160><a class=lnlinks href=#hl-58-160>160</a>
</span><span class=lnt id=hl-58-161><a class=lnlinks href=#hl-58-161>161</a>
</span><span class=lnt id=hl-58-162><a class=lnlinks href=#hl-58-162>162</a>
</span><span class=lnt id=hl-58-163><a class=lnlinks href=#hl-58-163>163</a>
</span><span class=lnt id=hl-58-164><a class=lnlinks href=#hl-58-164>164</a>
</span><span class=lnt id=hl-58-165><a class=lnlinks href=#hl-58-165>165</a>
</span><span class=lnt id=hl-58-166><a class=lnlinks href=#hl-58-166>166</a>
</span><span class=lnt id=hl-58-167><a class=lnlinks href=#hl-58-167>167</a>
</span><span class=lnt id=hl-58-168><a class=lnlinks href=#hl-58-168>168</a>
</span><span class=lnt id=hl-58-169><a class=lnlinks href=#hl-58-169>169</a>
</span><span class=lnt id=hl-58-170><a class=lnlinks href=#hl-58-170>170</a>
</span><span class=lnt id=hl-58-171><a class=lnlinks href=#hl-58-171>171</a>
</span><span class=lnt id=hl-58-172><a class=lnlinks href=#hl-58-172>172</a>
</span><span class=lnt id=hl-58-173><a class=lnlinks href=#hl-58-173>173</a>
</span><span class=lnt id=hl-58-174><a class=lnlinks href=#hl-58-174>174</a>
</span><span class=lnt id=hl-58-175><a class=lnlinks href=#hl-58-175>175</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 프레젠테이션 계층 - React 컴포넌트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=nx>React</span><span class=p>,</span> <span class=p>{</span> <span class=nx>useState</span><span class=p>,</span> <span class=nx>useEffect</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;react&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>productService</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;../services/productService&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>ProductList</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>products</span><span class=p>,</span> <span class=nx>setProducts</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>([]);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>[</span><span class=nx>loading</span><span class=p>,</span> <span class=nx>setLoading</span><span class=p>]</span> <span class=o>=</span> <span class=nx>useState</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>searchProducts</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>searchTerm</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>setLoading</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 비즈니스 계층 API 호출
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>productService</span><span class=p>.</span><span class=nx>searchProducts</span><span class=p>(</span><span class=nx>searchTerm</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>setProducts</span><span class=p>(</span><span class=nx>result</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;상품 검색 실패:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>finally</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>setLoading</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=o>&lt;</span><span class=nx>input</span> 
</span></span><span class=line><span class=cl>                <span class=nx>type</span><span class=o>=</span><span class=s2>&#34;text&#34;</span> 
</span></span><span class=line><span class=cl>                <span class=nx>onChange</span><span class=o>=</span><span class=p>{(</span><span class=nx>e</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>searchProducts</span><span class=p>(</span><span class=nx>e</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>                <span class=nx>placeholder</span><span class=o>=</span><span class=s2>&#34;상품 검색…&#34;</span>
</span></span><span class=line><span class=cl>            <span class=o>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=nx>loading</span> <span class=o>?</span> <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span><span class=nx>로딩</span> <span class=nx>중</span><span class=err>…</span><span class=o>&lt;</span><span class=err>/div&gt; : </span>
</span></span><span class=line><span class=cl>                <span class=o>&lt;</span><span class=nx>ProductGrid</span> <span class=nx>products</span><span class=o>=</span><span class=p>{</span><span class=nx>products</span><span class=p>}</span> <span class=o>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 비즈니스 계층 - Express 라우터
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>express</span><span class=p>.</span><span class=nx>Router</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>productService</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;../services/productService&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>authMiddleware</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;../middleware/auth&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 상품 검색 API 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>router</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/search&#39;</span><span class=p>,</span> <span class=nx>authMiddleware</span><span class=p>,</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=p>{</span> <span class=nx>q</span><span class=o>:</span> <span class=nx>searchTerm</span><span class=p>,</span> <span class=nx>page</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>limit</span> <span class=o>=</span> <span class=mi>20</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>query</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 입력 검증
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>searchTerm</span> <span class=o>||</span> <span class=nx>searchTerm</span><span class=p>.</span><span class=nx>length</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>400</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;검색어는 2자 이상이어야 합니다.&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 비즈니스 로직 실행
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>productService</span><span class=p>.</span><span class=nx>searchProducts</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>searchTerm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>page</span><span class=o>:</span> <span class=nb>parseInt</span><span class=p>(</span><span class=nx>page</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>limit</span><span class=o>:</span> <span class=nb>parseInt</span><span class=p>(</span><span class=nx>limit</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>userId</span><span class=o>:</span> <span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>.</span><span class=nx>id</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>success</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>data</span><span class=o>:</span> <span class=nx>result</span><span class=p>.</span><span class=nx>products</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>pagination</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>currentPage</span><span class=o>:</span> <span class=nx>page</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>totalPages</span><span class=o>:</span> <span class=nx>result</span><span class=p>.</span><span class=nx>totalPages</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>totalItems</span><span class=o>:</span> <span class=nx>result</span><span class=p>.</span><span class=nx>totalCount</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;상품 검색 오류:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>500</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;내부 서버 오류&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 비즈니스 서비스 계층
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>class</span> <span class=nx>ProductService</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>constructor</span><span class=p>(</span><span class=nx>productRepository</span><span class=p>,</span> <span class=nx>cacheService</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>productRepository</span> <span class=o>=</span> <span class=nx>productRepository</span><span class=p>;</span>  <span class=c1>// 데이터 접근 계층
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>cacheService</span> <span class=o>=</span> <span class=nx>cacheService</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>searchProducts</span><span class=p>({</span> <span class=nx>searchTerm</span><span class=p>,</span> <span class=nx>page</span><span class=p>,</span> <span class=nx>limit</span><span class=p>,</span> <span class=nx>userId</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 캐시 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>cacheKey</span> <span class=o>=</span> <span class=sb>`products:search:</span><span class=si>${</span><span class=nx>searchTerm</span><span class=si>}</span><span class=sb>:</span><span class=si>${</span><span class=nx>page</span><span class=si>}</span><span class=sb>:</span><span class=si>${</span><span class=nx>limit</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>cachedResult</span> <span class=o>=</span> <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>cacheService</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>cacheKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>cachedResult</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>cachedResult</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 비즈니스 규칙 적용
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>searchOptions</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>searchTerm</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>sanitizeSearchTerm</span><span class=p>(</span><span class=nx>searchTerm</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>offset</span><span class=o>:</span> <span class=p>(</span><span class=nx>page</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=nx>limit</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>limit</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>filters</span><span class=o>:</span> <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>getUserPreferences</span><span class=p>(</span><span class=nx>userId</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 데이터 접근 계층 호출
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>products</span> <span class=o>=</span> <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>productRepository</span><span class=p>.</span><span class=nx>searchProducts</span><span class=p>(</span><span class=nx>searchOptions</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>totalCount</span> <span class=o>=</span> <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>productRepository</span><span class=p>.</span><span class=nx>countSearchResults</span><span class=p>(</span><span class=nx>searchOptions</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>products</span><span class=o>:</span> <span class=nx>products</span><span class=p>.</span><span class=nx>map</span><span class=p>(</span><span class=nx>p</span> <span class=p>=&gt;</span> <span class=k>this</span><span class=p>.</span><span class=nx>transformProduct</span><span class=p>(</span><span class=nx>p</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>            <span class=nx>totalCount</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>totalPages</span><span class=o>:</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>ceil</span><span class=p>(</span><span class=nx>totalCount</span> <span class=o>/</span> <span class=nx>limit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 캐시 저장 (5분)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>cacheService</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>cacheKey</span><span class=p>,</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>result</span><span class=p>),</span> <span class=mi>300</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>sanitizeSearchTerm</span><span class=p>(</span><span class=nx>term</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 검색어 정제 로직
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=nx>term</span><span class=p>.</span><span class=nx>trim</span><span class=p>().</span><span class=nx>replace</span><span class=p>(</span><span class=sr>/[&lt;&gt;&#39;&#34;]/g</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>transformProduct</span><span class=p>(</span><span class=nx>product</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 비즈니스 객체를 DTO로 변환
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>id</span><span class=o>:</span> <span class=nx>product</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>name</span><span class=o>:</span> <span class=nx>product</span><span class=p>.</span><span class=nx>name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>price</span><span class=o>:</span> <span class=nx>product</span><span class=p>.</span><span class=nx>price</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>discountedPrice</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>calculateDiscountedPrice</span><span class=p>(</span><span class=nx>product</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>imageUrl</span><span class=o>:</span> <span class=nx>product</span><span class=p>.</span><span class=nx>images</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>?</span><span class=p>.</span><span class=nx>url</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>inStock</span><span class=o>:</span> <span class=nx>product</span><span class=p>.</span><span class=nx>stock</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 데이터 접근 계층 - Repository
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=p>{</span> <span class=nx>Product</span><span class=p>,</span> <span class=nx>Category</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;../models&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>class</span> <span class=nx>ProductRepository</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>searchProducts</span><span class=p>({</span> <span class=nx>searchTerm</span><span class=p>,</span> <span class=nx>offset</span><span class=p>,</span> <span class=nx>limit</span><span class=p>,</span> <span class=nx>filters</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>whereClause</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span><span class=nx>Op</span><span class=p>.</span><span class=nx>or</span><span class=p>]</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=p>{</span> <span class=p>[</span><span class=nx>Op</span><span class=p>.</span><span class=nx>iLike</span><span class=p>]</span><span class=o>:</span> <span class=sb>`%</span><span class=si>${</span><span class=nx>searchTerm</span><span class=si>}</span><span class=sb>%`</span> <span class=p>}</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span> <span class=nx>description</span><span class=o>:</span> <span class=p>{</span> <span class=p>[</span><span class=nx>Op</span><span class=p>.</span><span class=nx>iLike</span><span class=p>]</span><span class=o>:</span> <span class=sb>`%</span><span class=si>${</span><span class=nx>searchTerm</span><span class=si>}</span><span class=sb>%`</span> <span class=p>}</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>isActive</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 필터 조건 추가
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nx>filters</span><span class=p>.</span><span class=nx>categoryIds</span><span class=o>?</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>whereClause</span><span class=p>.</span><span class=nx>categoryId</span> <span class=o>=</span> <span class=p>{</span> <span class=p>[</span><span class=nx>Op</span><span class=p>.</span><span class=k>in</span><span class=p>]</span><span class=o>:</span> <span class=nx>filters</span><span class=p>.</span><span class=nx>categoryIds</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kr>await</span> <span class=nx>Product</span><span class=p>.</span><span class=nx>findAll</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>where</span><span class=o>:</span> <span class=nx>whereClause</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>include</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span> <span class=nx>model</span><span class=o>:</span> <span class=nx>Category</span><span class=p>,</span> <span class=nx>attributes</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span> <span class=nx>model</span><span class=o>:</span> <span class=nx>ProductImage</span><span class=p>,</span> <span class=nx>attributes</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;url&#39;</span><span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>offset</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>limit</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>order</span><span class=o>:</span> <span class=p>[[</span><span class=s1>&#39;createdAt&#39;</span><span class=p>,</span> <span class=s1>&#39;DESC&#39;</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>countSearchResults</span><span class=p>({</span> <span class=nx>searchTerm</span><span class=p>,</span> <span class=nx>filters</span> <span class=p>})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 검색 결과 총 개수 조회
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=kr>await</span> <span class=nx>Product</span><span class=p>.</span><span class=nx>count</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>where</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span><span class=nx>Op</span><span class=p>.</span><span class=nx>or</span><span class=p>]</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=p>{</span> <span class=p>[</span><span class=nx>Op</span><span class=p>.</span><span class=nx>iLike</span><span class=p>]</span><span class=o>:</span> <span class=sb>`%</span><span class=si>${</span><span class=nx>searchTerm</span><span class=si>}</span><span class=sb>%`</span> <span class=p>}</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span> <span class=nx>description</span><span class=o>:</span> <span class=p>{</span> <span class=p>[</span><span class=nx>Op</span><span class=p>.</span><span class=nx>iLike</span><span class=p>]</span><span class=o>:</span> <span class=sb>`%</span><span class=si>${</span><span class=nx>searchTerm</span><span class=si>}</span><span class=sb>%`</span> <span class=p>}</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>isActive</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-5-전자상거래-플랫폼-사례>사례 5: 전자상거래 플랫폼 사례<a hidden class=anchor aria-hidden=true href=#사례-5-전자상거래-플랫폼-사례>#</a></h4><p><strong>시스템 구성</strong>:</p><ul><li>프레젠테이션: React 기반 웹 프론트엔드</li><li>비즈니스: Spring Boot 기반 REST API</li><li>퍼시스턴스: Spring Data JPA + Redis 캐시</li><li>데이터베이스: MySQL (주문/상품) + MongoDB (리뷰/로그)</li></ul><pre class=mermaid>graph TB
    subgraph &#34;프레젠테이션 계층&#34;
        A1[React Web App]
        A2[Mobile App]
        A3[Admin Panel]
    end
    
    subgraph &#34;비즈니스 계층&#34;
        B1[상품 서비스]
        B2[주문 서비스]
        B3[사용자 서비스]
        B4[결제 서비스]
    end
    
    subgraph &#34;퍼시스턴스 계층&#34;
        C1[상품 Repository]
        C2[주문 Repository]
        C3[사용자 Repository]
        C4[Redis Cache]
    end
    
    subgraph &#34;데이터베이스 계층&#34;
        D1[MySQL]
        D2[MongoDB]
        D3[외부 결제 API]
    end
    
    A1 --&gt; B1
    A1 --&gt; B2
    A2 --&gt; B1
    A3 --&gt; B3
    B1 --&gt; C1
    B2 --&gt; C2
    B3 --&gt; C3
    C1 --&gt; D1
    C2 --&gt; D1
    C3 --&gt; D2
    B4 --&gt; D3
</pre><p><strong>Workflow</strong>:</p><ol><li>사용자가 상품 주문 요청</li><li>프레젠테이션 계층에서 요청 검증 및 인증</li><li>비즈니스 계층에서 재고 확인 및 주문 생성</li><li>퍼시스턴스 계층에서 데이터베이스 트랜잭션 처리</li><li>결제 서비스 연동 및 주문 확정</li><li>응답 데이터 반환</li></ol><p><strong>계층화의 역할</strong>:</p><ul><li><strong>프레젠테이션</strong>: 다중 채널 지원 (웹, 모바일, 관리자)</li><li><strong>비즈니스</strong>: 복잡한 주문 로직, 재고 관리, 할인 계산</li><li><strong>퍼시스턴스</strong>: 다중 데이터베이스 추상화, 캐싱 전략</li><li><strong>데이터베이스</strong>: 트랜잭션 보장, 성능 최적화</li></ul><p><strong>기존 아키텍처와의 차이점</strong>:</p><ul><li>전통적 모놀리식 대비: 계층별 독립 배포 가능</li><li>마이크로서비스 대비: 단순한 구조로 초기 개발 속도 빠름</li><li>MVC 패턴 대비: 명확한 비즈니스 로직 분리</li></ul><p><strong>구현 예시</strong>:</p><ul><li><p>프레젠테이션 계층 (Controller)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-60-1><a class=lnlinks href=#hl-60-1> 1</a>
</span><span class=lnt id=hl-60-2><a class=lnlinks href=#hl-60-2> 2</a>
</span><span class=lnt id=hl-60-3><a class=lnlinks href=#hl-60-3> 3</a>
</span><span class=lnt id=hl-60-4><a class=lnlinks href=#hl-60-4> 4</a>
</span><span class=lnt id=hl-60-5><a class=lnlinks href=#hl-60-5> 5</a>
</span><span class=lnt id=hl-60-6><a class=lnlinks href=#hl-60-6> 6</a>
</span><span class=lnt id=hl-60-7><a class=lnlinks href=#hl-60-7> 7</a>
</span><span class=lnt id=hl-60-8><a class=lnlinks href=#hl-60-8> 8</a>
</span><span class=lnt id=hl-60-9><a class=lnlinks href=#hl-60-9> 9</a>
</span><span class=lnt id=hl-60-10><a class=lnlinks href=#hl-60-10>10</a>
</span><span class=lnt id=hl-60-11><a class=lnlinks href=#hl-60-11>11</a>
</span><span class=lnt id=hl-60-12><a class=lnlinks href=#hl-60-12>12</a>
</span><span class=lnt id=hl-60-13><a class=lnlinks href=#hl-60-13>13</a>
</span><span class=lnt id=hl-60-14><a class=lnlinks href=#hl-60-14>14</a>
</span><span class=lnt id=hl-60-15><a class=lnlinks href=#hl-60-15>15</a>
</span><span class=lnt id=hl-60-16><a class=lnlinks href=#hl-60-16>16</a>
</span><span class=lnt id=hl-60-17><a class=lnlinks href=#hl-60-17>17</a>
</span><span class=lnt id=hl-60-18><a class=lnlinks href=#hl-60-18>18</a>
</span><span class=lnt id=hl-60-19><a class=lnlinks href=#hl-60-19>19</a>
</span><span class=lnt id=hl-60-20><a class=lnlinks href=#hl-60-20>20</a>
</span><span class=lnt id=hl-60-21><a class=lnlinks href=#hl-60-21>21</a>
</span><span class=lnt id=hl-60-22><a class=lnlinks href=#hl-60-22>22</a>
</span><span class=lnt id=hl-60-23><a class=lnlinks href=#hl-60-23>23</a>
</span><span class=lnt id=hl-60-24><a class=lnlinks href=#hl-60-24>24</a>
</span><span class=lnt id=hl-60-25><a class=lnlinks href=#hl-60-25>25</a>
</span><span class=lnt id=hl-60-26><a class=lnlinks href=#hl-60-26>26</a>
</span><span class=lnt id=hl-60-27><a class=lnlinks href=#hl-60-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RestController</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RequestMapping</span><span class=p>(</span><span class=s>&#34;/api/orders&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>OrderService</span><span class=w> </span><span class=n>orderService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>OrderController</span><span class=p>(</span><span class=n>OrderService</span><span class=w> </span><span class=n>orderService</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>orderService</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>orderService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 주문 생성 API</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@PostMapping</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>ResponseEntity</span><span class=o>&lt;</span><span class=n>OrderResponseDto</span><span class=o>&gt;</span><span class=w> </span><span class=nf>createOrder</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nd>@Valid</span><span class=w> </span><span class=nd>@RequestBody</span><span class=w> </span><span class=n>OrderRequestDto</span><span class=w> </span><span class=n>request</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 입력 검증 및 DTO 변환</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>OrderResponseDto</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>orderService</span><span class=p>.</span><span class=na>createOrder</span><span class=p>(</span><span class=n>request</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ResponseEntity</span><span class=p>.</span><span class=na>ok</span><span class=p>(</span><span class=n>response</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 주문 조회 API</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/{orderId}&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>ResponseEntity</span><span class=o>&lt;</span><span class=n>OrderResponseDto</span><span class=o>&gt;</span><span class=w> </span><span class=nf>getOrder</span><span class=p>(</span><span class=nd>@PathVariable</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>orderId</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>OrderResponseDto</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>orderService</span><span class=p>.</span><span class=na>getOrder</span><span class=p>(</span><span class=n>orderId</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ResponseEntity</span><span class=p>.</span><span class=na>ok</span><span class=p>(</span><span class=n>response</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>비즈니스 계층 (Service)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-61-1><a class=lnlinks href=#hl-61-1> 1</a>
</span><span class=lnt id=hl-61-2><a class=lnlinks href=#hl-61-2> 2</a>
</span><span class=lnt id=hl-61-3><a class=lnlinks href=#hl-61-3> 3</a>
</span><span class=lnt id=hl-61-4><a class=lnlinks href=#hl-61-4> 4</a>
</span><span class=lnt id=hl-61-5><a class=lnlinks href=#hl-61-5> 5</a>
</span><span class=lnt id=hl-61-6><a class=lnlinks href=#hl-61-6> 6</a>
</span><span class=lnt id=hl-61-7><a class=lnlinks href=#hl-61-7> 7</a>
</span><span class=lnt id=hl-61-8><a class=lnlinks href=#hl-61-8> 8</a>
</span><span class=lnt id=hl-61-9><a class=lnlinks href=#hl-61-9> 9</a>
</span><span class=lnt id=hl-61-10><a class=lnlinks href=#hl-61-10>10</a>
</span><span class=lnt id=hl-61-11><a class=lnlinks href=#hl-61-11>11</a>
</span><span class=lnt id=hl-61-12><a class=lnlinks href=#hl-61-12>12</a>
</span><span class=lnt id=hl-61-13><a class=lnlinks href=#hl-61-13>13</a>
</span><span class=lnt id=hl-61-14><a class=lnlinks href=#hl-61-14>14</a>
</span><span class=lnt id=hl-61-15><a class=lnlinks href=#hl-61-15>15</a>
</span><span class=lnt id=hl-61-16><a class=lnlinks href=#hl-61-16>16</a>
</span><span class=lnt id=hl-61-17><a class=lnlinks href=#hl-61-17>17</a>
</span><span class=lnt id=hl-61-18><a class=lnlinks href=#hl-61-18>18</a>
</span><span class=lnt id=hl-61-19><a class=lnlinks href=#hl-61-19>19</a>
</span><span class=lnt id=hl-61-20><a class=lnlinks href=#hl-61-20>20</a>
</span><span class=lnt id=hl-61-21><a class=lnlinks href=#hl-61-21>21</a>
</span><span class=lnt id=hl-61-22><a class=lnlinks href=#hl-61-22>22</a>
</span><span class=lnt id=hl-61-23><a class=lnlinks href=#hl-61-23>23</a>
</span><span class=lnt id=hl-61-24><a class=lnlinks href=#hl-61-24>24</a>
</span><span class=lnt id=hl-61-25><a class=lnlinks href=#hl-61-25>25</a>
</span><span class=lnt id=hl-61-26><a class=lnlinks href=#hl-61-26>26</a>
</span><span class=lnt id=hl-61-27><a class=lnlinks href=#hl-61-27>27</a>
</span><span class=lnt id=hl-61-28><a class=lnlinks href=#hl-61-28>28</a>
</span><span class=lnt id=hl-61-29><a class=lnlinks href=#hl-61-29>29</a>
</span><span class=lnt id=hl-61-30><a class=lnlinks href=#hl-61-30>30</a>
</span><span class=lnt id=hl-61-31><a class=lnlinks href=#hl-61-31>31</a>
</span><span class=lnt id=hl-61-32><a class=lnlinks href=#hl-61-32>32</a>
</span><span class=lnt id=hl-61-33><a class=lnlinks href=#hl-61-33>33</a>
</span><span class=lnt id=hl-61-34><a class=lnlinks href=#hl-61-34>34</a>
</span><span class=lnt id=hl-61-35><a class=lnlinks href=#hl-61-35>35</a>
</span><span class=lnt id=hl-61-36><a class=lnlinks href=#hl-61-36>36</a>
</span><span class=lnt id=hl-61-37><a class=lnlinks href=#hl-61-37>37</a>
</span><span class=lnt id=hl-61-38><a class=lnlinks href=#hl-61-38>38</a>
</span><span class=lnt id=hl-61-39><a class=lnlinks href=#hl-61-39>39</a>
</span><span class=lnt id=hl-61-40><a class=lnlinks href=#hl-61-40>40</a>
</span><span class=lnt id=hl-61-41><a class=lnlinks href=#hl-61-41>41</a>
</span><span class=lnt id=hl-61-42><a class=lnlinks href=#hl-61-42>42</a>
</span><span class=lnt id=hl-61-43><a class=lnlinks href=#hl-61-43>43</a>
</span><span class=lnt id=hl-61-44><a class=lnlinks href=#hl-61-44>44</a>
</span><span class=lnt id=hl-61-45><a class=lnlinks href=#hl-61-45>45</a>
</span><span class=lnt id=hl-61-46><a class=lnlinks href=#hl-61-46>46</a>
</span><span class=lnt id=hl-61-47><a class=lnlinks href=#hl-61-47>47</a>
</span><span class=lnt id=hl-61-48><a class=lnlinks href=#hl-61-48>48</a>
</span><span class=lnt id=hl-61-49><a class=lnlinks href=#hl-61-49>49</a>
</span><span class=lnt id=hl-61-50><a class=lnlinks href=#hl-61-50>50</a>
</span><span class=lnt id=hl-61-51><a class=lnlinks href=#hl-61-51>51</a>
</span><span class=lnt id=hl-61-52><a class=lnlinks href=#hl-61-52>52</a>
</span><span class=lnt id=hl-61-53><a class=lnlinks href=#hl-61-53>53</a>
</span><span class=lnt id=hl-61-54><a class=lnlinks href=#hl-61-54>54</a>
</span><span class=lnt id=hl-61-55><a class=lnlinks href=#hl-61-55>55</a>
</span><span class=lnt id=hl-61-56><a class=lnlinks href=#hl-61-56>56</a>
</span><span class=lnt id=hl-61-57><a class=lnlinks href=#hl-61-57>57</a>
</span><span class=lnt id=hl-61-58><a class=lnlinks href=#hl-61-58>58</a>
</span><span class=lnt id=hl-61-59><a class=lnlinks href=#hl-61-59>59</a>
</span><span class=lnt id=hl-61-60><a class=lnlinks href=#hl-61-60>60</a>
</span><span class=lnt id=hl-61-61><a class=lnlinks href=#hl-61-61>61</a>
</span><span class=lnt id=hl-61-62><a class=lnlinks href=#hl-61-62>62</a>
</span><span class=lnt id=hl-61-63><a class=lnlinks href=#hl-61-63>63</a>
</span><span class=lnt id=hl-61-64><a class=lnlinks href=#hl-61-64>64</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Transactional</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderService</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>OrderRepository</span><span class=w> </span><span class=n>orderRepository</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>ProductRepository</span><span class=w> </span><span class=n>productRepository</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>PaymentService</span><span class=w> </span><span class=n>paymentService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>OrderService</span><span class=p>(</span><span class=n>OrderRepository</span><span class=w> </span><span class=n>orderRepository</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                       </span><span class=n>ProductRepository</span><span class=w> </span><span class=n>productRepository</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                       </span><span class=n>PaymentService</span><span class=w> </span><span class=n>paymentService</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>orderRepository</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>orderRepository</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>productRepository</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>productRepository</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>paymentService</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>paymentService</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>OrderResponseDto</span><span class=w> </span><span class=nf>createOrder</span><span class=p>(</span><span class=n>OrderRequestDto</span><span class=w> </span><span class=n>request</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 1. 비즈니스 로직: 상품 재고 확인</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Product</span><span class=w> </span><span class=n>product</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>productRepository</span><span class=p>.</span><span class=na>findById</span><span class=p>(</span><span class=n>request</span><span class=p>.</span><span class=na>getProductId</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>orElseThrow</span><span class=p>(()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ProductNotFoundException</span><span class=p>(</span><span class=s>&#34;상품을 찾을 수 없습니다&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>product</span><span class=p>.</span><span class=na>getStock</span><span class=p>()</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>request</span><span class=p>.</span><span class=na>getQuantity</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>InsufficientStockException</span><span class=p>(</span><span class=s>&#34;재고가 부족합니다&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 2. 비즈니스 로직: 주문 총액 계산</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>totalAmount</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>product</span><span class=p>.</span><span class=na>getPrice</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>multiply</span><span class=p>(</span><span class=n>BigDecimal</span><span class=p>.</span><span class=na>valueOf</span><span class=p>(</span><span class=n>request</span><span class=p>.</span><span class=na>getQuantity</span><span class=p>()));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 3. 주문 엔티티 생성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Order</span><span class=w> </span><span class=n>order</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Order</span><span class=p>.</span><span class=na>builder</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>productId</span><span class=p>(</span><span class=n>request</span><span class=p>.</span><span class=na>getProductId</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>quantity</span><span class=p>(</span><span class=n>request</span><span class=p>.</span><span class=na>getQuantity</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>totalAmount</span><span class=p>(</span><span class=n>totalAmount</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>status</span><span class=p>(</span><span class=n>OrderStatus</span><span class=p>.</span><span class=na>PENDING</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 4. 주문 저장</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Order</span><span class=w> </span><span class=n>savedOrder</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>orderRepository</span><span class=p>.</span><span class=na>save</span><span class=p>(</span><span class=n>order</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 5. 결제 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>PaymentResult</span><span class=w> </span><span class=n>paymentResult</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>paymentService</span><span class=p>.</span><span class=na>processPayment</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>savedOrder</span><span class=p>.</span><span class=na>getId</span><span class=p>(),</span><span class=w> </span><span class=n>totalAmount</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>paymentResult</span><span class=p>.</span><span class=na>isSuccess</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>savedOrder</span><span class=p>.</span><span class=na>confirm</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>product</span><span class=p>.</span><span class=na>decreaseStock</span><span class=p>(</span><span class=n>request</span><span class=p>.</span><span class=na>getQuantity</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>savedOrder</span><span class=p>.</span><span class=na>cancel</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>PaymentFailedException</span><span class=p>(</span><span class=s>&#34;결제에 실패했습니다&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 6. DTO 변환하여 반환</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>OrderResponseDto</span><span class=p>.</span><span class=na>from</span><span class=p>(</span><span class=n>savedOrder</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Transactional</span><span class=p>(</span><span class=n>readOnly</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>true</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>OrderResponseDto</span><span class=w> </span><span class=nf>getOrder</span><span class=p>(</span><span class=n>Long</span><span class=w> </span><span class=n>orderId</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Order</span><span class=w> </span><span class=n>order</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>orderRepository</span><span class=p>.</span><span class=na>findById</span><span class=p>(</span><span class=n>orderId</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>orElseThrow</span><span class=p>(()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>OrderNotFoundException</span><span class=p>(</span><span class=s>&#34;주문을 찾을 수 없습니다&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>OrderResponseDto</span><span class=p>.</span><span class=na>from</span><span class=p>(</span><span class=n>order</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>퍼시스턴스 계층 (Repository)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-62-1><a class=lnlinks href=#hl-62-1> 1</a>
</span><span class=lnt id=hl-62-2><a class=lnlinks href=#hl-62-2> 2</a>
</span><span class=lnt id=hl-62-3><a class=lnlinks href=#hl-62-3> 3</a>
</span><span class=lnt id=hl-62-4><a class=lnlinks href=#hl-62-4> 4</a>
</span><span class=lnt id=hl-62-5><a class=lnlinks href=#hl-62-5> 5</a>
</span><span class=lnt id=hl-62-6><a class=lnlinks href=#hl-62-6> 6</a>
</span><span class=lnt id=hl-62-7><a class=lnlinks href=#hl-62-7> 7</a>
</span><span class=lnt id=hl-62-8><a class=lnlinks href=#hl-62-8> 8</a>
</span><span class=lnt id=hl-62-9><a class=lnlinks href=#hl-62-9> 9</a>
</span><span class=lnt id=hl-62-10><a class=lnlinks href=#hl-62-10>10</a>
</span><span class=lnt id=hl-62-11><a class=lnlinks href=#hl-62-11>11</a>
</span><span class=lnt id=hl-62-12><a class=lnlinks href=#hl-62-12>12</a>
</span><span class=lnt id=hl-62-13><a class=lnlinks href=#hl-62-13>13</a>
</span><span class=lnt id=hl-62-14><a class=lnlinks href=#hl-62-14>14</a>
</span><span class=lnt id=hl-62-15><a class=lnlinks href=#hl-62-15>15</a>
</span><span class=lnt id=hl-62-16><a class=lnlinks href=#hl-62-16>16</a>
</span><span class=lnt id=hl-62-17><a class=lnlinks href=#hl-62-17>17</a>
</span><span class=lnt id=hl-62-18><a class=lnlinks href=#hl-62-18>18</a>
</span><span class=lnt id=hl-62-19><a class=lnlinks href=#hl-62-19>19</a>
</span><span class=lnt id=hl-62-20><a class=lnlinks href=#hl-62-20>20</a>
</span><span class=lnt id=hl-62-21><a class=lnlinks href=#hl-62-21>21</a>
</span><span class=lnt id=hl-62-22><a class=lnlinks href=#hl-62-22>22</a>
</span><span class=lnt id=hl-62-23><a class=lnlinks href=#hl-62-23>23</a>
</span><span class=lnt id=hl-62-24><a class=lnlinks href=#hl-62-24>24</a>
</span><span class=lnt id=hl-62-25><a class=lnlinks href=#hl-62-25>25</a>
</span><span class=lnt id=hl-62-26><a class=lnlinks href=#hl-62-26>26</a>
</span><span class=lnt id=hl-62-27><a class=lnlinks href=#hl-62-27>27</a>
</span><span class=lnt id=hl-62-28><a class=lnlinks href=#hl-62-28>28</a>
</span><span class=lnt id=hl-62-29><a class=lnlinks href=#hl-62-29>29</a>
</span><span class=lnt id=hl-62-30><a class=lnlinks href=#hl-62-30>30</a>
</span><span class=lnt id=hl-62-31><a class=lnlinks href=#hl-62-31>31</a>
</span><span class=lnt id=hl-62-32><a class=lnlinks href=#hl-62-32>32</a>
</span><span class=lnt id=hl-62-33><a class=lnlinks href=#hl-62-33>33</a>
</span><span class=lnt id=hl-62-34><a class=lnlinks href=#hl-62-34>34</a>
</span><span class=lnt id=hl-62-35><a class=lnlinks href=#hl-62-35>35</a>
</span><span class=lnt id=hl-62-36><a class=lnlinks href=#hl-62-36>36</a>
</span><span class=lnt id=hl-62-37><a class=lnlinks href=#hl-62-37>37</a>
</span><span class=lnt id=hl-62-38><a class=lnlinks href=#hl-62-38>38</a>
</span><span class=lnt id=hl-62-39><a class=lnlinks href=#hl-62-39>39</a>
</span><span class=lnt id=hl-62-40><a class=lnlinks href=#hl-62-40>40</a>
</span><span class=lnt id=hl-62-41><a class=lnlinks href=#hl-62-41>41</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Repository 인터페이스</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>interface</span> <span class=nc>OrderRepository</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>JpaRepository</span><span class=o>&lt;</span><span class=n>Order</span><span class=p>,</span><span class=w> </span><span class=n>Long</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 커스텀 쿼리 메서드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Order</span><span class=o>&gt;</span><span class=w> </span><span class=nf>findByUserIdAndStatus</span><span class=p>(</span><span class=n>Long</span><span class=w> </span><span class=n>userId</span><span class=p>,</span><span class=w> </span><span class=n>OrderStatus</span><span class=w> </span><span class=n>status</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 복잡한 쿼리를 위한 JPQL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Query</span><span class=p>(</span><span class=s>&#34;SELECT o FROM Order o WHERE o.createdAt BETWEEN :startDate AND :endDate&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Order</span><span class=o>&gt;</span><span class=w> </span><span class=nf>findOrdersByDateRange</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@Param</span><span class=p>(</span><span class=s>&#34;startDate&#34;</span><span class=p>)</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>startDate</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nd>@Param</span><span class=p>(</span><span class=s>&#34;endDate&#34;</span><span class=p>)</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>endDate</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 구체적인 Repository 구현 (필요시)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Repository</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderRepositoryImpl</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@PersistenceContext</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>EntityManager</span><span class=w> </span><span class=n>entityManager</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Order</span><span class=o>&gt;</span><span class=w> </span><span class=nf>findComplexOrders</span><span class=p>(</span><span class=n>OrderSearchCriteria</span><span class=w> </span><span class=n>criteria</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 복잡한 동적 쿼리 구현</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>CriteriaBuilder</span><span class=w> </span><span class=n>cb</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>entityManager</span><span class=p>.</span><span class=na>getCriteriaBuilder</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>CriteriaQuery</span><span class=o>&lt;</span><span class=n>Order</span><span class=o>&gt;</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cb</span><span class=p>.</span><span class=na>createQuery</span><span class=p>(</span><span class=n>Order</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Root</span><span class=o>&lt;</span><span class=n>Order</span><span class=o>&gt;</span><span class=w> </span><span class=n>root</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>query</span><span class=p>.</span><span class=na>from</span><span class=p>(</span><span class=n>Order</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Predicate</span><span class=o>&gt;</span><span class=w> </span><span class=n>predicates</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>criteria</span><span class=p>.</span><span class=na>getUserId</span><span class=p>()</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>predicates</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>cb</span><span class=p>.</span><span class=na>equal</span><span class=p>(</span><span class=n>root</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=s>&#34;userId&#34;</span><span class=p>),</span><span class=w> </span><span class=n>criteria</span><span class=p>.</span><span class=na>getUserId</span><span class=p>()));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>criteria</span><span class=p>.</span><span class=na>getStatus</span><span class=p>()</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>predicates</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>cb</span><span class=p>.</span><span class=na>equal</span><span class=p>(</span><span class=n>root</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=s>&#34;status&#34;</span><span class=p>),</span><span class=w> </span><span class=n>criteria</span><span class=p>.</span><span class=na>getStatus</span><span class=p>()));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>query</span><span class=p>.</span><span class=na>where</span><span class=p>(</span><span class=n>predicates</span><span class=p>.</span><span class=na>toArray</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>Predicate</span><span class=o>[</span><span class=n>0</span><span class=o>]</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>entityManager</span><span class=p>.</span><span class=na>createQuery</span><span class=p>(</span><span class=n>query</span><span class=p>).</span><span class=na>getResultList</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>데이터베이스 계층 (Entity)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-63-1><a class=lnlinks href=#hl-63-1> 1</a>
</span><span class=lnt id=hl-63-2><a class=lnlinks href=#hl-63-2> 2</a>
</span><span class=lnt id=hl-63-3><a class=lnlinks href=#hl-63-3> 3</a>
</span><span class=lnt id=hl-63-4><a class=lnlinks href=#hl-63-4> 4</a>
</span><span class=lnt id=hl-63-5><a class=lnlinks href=#hl-63-5> 5</a>
</span><span class=lnt id=hl-63-6><a class=lnlinks href=#hl-63-6> 6</a>
</span><span class=lnt id=hl-63-7><a class=lnlinks href=#hl-63-7> 7</a>
</span><span class=lnt id=hl-63-8><a class=lnlinks href=#hl-63-8> 8</a>
</span><span class=lnt id=hl-63-9><a class=lnlinks href=#hl-63-9> 9</a>
</span><span class=lnt id=hl-63-10><a class=lnlinks href=#hl-63-10>10</a>
</span><span class=lnt id=hl-63-11><a class=lnlinks href=#hl-63-11>11</a>
</span><span class=lnt id=hl-63-12><a class=lnlinks href=#hl-63-12>12</a>
</span><span class=lnt id=hl-63-13><a class=lnlinks href=#hl-63-13>13</a>
</span><span class=lnt id=hl-63-14><a class=lnlinks href=#hl-63-14>14</a>
</span><span class=lnt id=hl-63-15><a class=lnlinks href=#hl-63-15>15</a>
</span><span class=lnt id=hl-63-16><a class=lnlinks href=#hl-63-16>16</a>
</span><span class=lnt id=hl-63-17><a class=lnlinks href=#hl-63-17>17</a>
</span><span class=lnt id=hl-63-18><a class=lnlinks href=#hl-63-18>18</a>
</span><span class=lnt id=hl-63-19><a class=lnlinks href=#hl-63-19>19</a>
</span><span class=lnt id=hl-63-20><a class=lnlinks href=#hl-63-20>20</a>
</span><span class=lnt id=hl-63-21><a class=lnlinks href=#hl-63-21>21</a>
</span><span class=lnt id=hl-63-22><a class=lnlinks href=#hl-63-22>22</a>
</span><span class=lnt id=hl-63-23><a class=lnlinks href=#hl-63-23>23</a>
</span><span class=lnt id=hl-63-24><a class=lnlinks href=#hl-63-24>24</a>
</span><span class=lnt id=hl-63-25><a class=lnlinks href=#hl-63-25>25</a>
</span><span class=lnt id=hl-63-26><a class=lnlinks href=#hl-63-26>26</a>
</span><span class=lnt id=hl-63-27><a class=lnlinks href=#hl-63-27>27</a>
</span><span class=lnt id=hl-63-28><a class=lnlinks href=#hl-63-28>28</a>
</span><span class=lnt id=hl-63-29><a class=lnlinks href=#hl-63-29>29</a>
</span><span class=lnt id=hl-63-30><a class=lnlinks href=#hl-63-30>30</a>
</span><span class=lnt id=hl-63-31><a class=lnlinks href=#hl-63-31>31</a>
</span><span class=lnt id=hl-63-32><a class=lnlinks href=#hl-63-32>32</a>
</span><span class=lnt id=hl-63-33><a class=lnlinks href=#hl-63-33>33</a>
</span><span class=lnt id=hl-63-34><a class=lnlinks href=#hl-63-34>34</a>
</span><span class=lnt id=hl-63-35><a class=lnlinks href=#hl-63-35>35</a>
</span><span class=lnt id=hl-63-36><a class=lnlinks href=#hl-63-36>36</a>
</span><span class=lnt id=hl-63-37><a class=lnlinks href=#hl-63-37>37</a>
</span><span class=lnt id=hl-63-38><a class=lnlinks href=#hl-63-38>38</a>
</span><span class=lnt id=hl-63-39><a class=lnlinks href=#hl-63-39>39</a>
</span><span class=lnt id=hl-63-40><a class=lnlinks href=#hl-63-40>40</a>
</span><span class=lnt id=hl-63-41><a class=lnlinks href=#hl-63-41>41</a>
</span><span class=lnt id=hl-63-42><a class=lnlinks href=#hl-63-42>42</a>
</span><span class=lnt id=hl-63-43><a class=lnlinks href=#hl-63-43>43</a>
</span><span class=lnt id=hl-63-44><a class=lnlinks href=#hl-63-44>44</a>
</span><span class=lnt id=hl-63-45><a class=lnlinks href=#hl-63-45>45</a>
</span><span class=lnt id=hl-63-46><a class=lnlinks href=#hl-63-46>46</a>
</span><span class=lnt id=hl-63-47><a class=lnlinks href=#hl-63-47>47</a>
</span><span class=lnt id=hl-63-48><a class=lnlinks href=#hl-63-48>48</a>
</span><span class=lnt id=hl-63-49><a class=lnlinks href=#hl-63-49>49</a>
</span><span class=lnt id=hl-63-50><a class=lnlinks href=#hl-63-50>50</a>
</span><span class=lnt id=hl-63-51><a class=lnlinks href=#hl-63-51>51</a>
</span><span class=lnt id=hl-63-52><a class=lnlinks href=#hl-63-52>52</a>
</span><span class=lnt id=hl-63-53><a class=lnlinks href=#hl-63-53>53</a>
</span><span class=lnt id=hl-63-54><a class=lnlinks href=#hl-63-54>54</a>
</span><span class=lnt id=hl-63-55><a class=lnlinks href=#hl-63-55>55</a>
</span><span class=lnt id=hl-63-56><a class=lnlinks href=#hl-63-56>56</a>
</span><span class=lnt id=hl-63-57><a class=lnlinks href=#hl-63-57>57</a>
</span><span class=lnt id=hl-63-58><a class=lnlinks href=#hl-63-58>58</a>
</span><span class=lnt id=hl-63-59><a class=lnlinks href=#hl-63-59>59</a>
</span><span class=lnt id=hl-63-60><a class=lnlinks href=#hl-63-60>60</a>
</span><span class=lnt id=hl-63-61><a class=lnlinks href=#hl-63-61>61</a>
</span><span class=lnt id=hl-63-62><a class=lnlinks href=#hl-63-62>62</a>
</span><span class=lnt id=hl-63-63><a class=lnlinks href=#hl-63-63>63</a>
</span><span class=lnt id=hl-63-64><a class=lnlinks href=#hl-63-64>64</a>
</span><span class=lnt id=hl-63-65><a class=lnlinks href=#hl-63-65>65</a>
</span><span class=lnt id=hl-63-66><a class=lnlinks href=#hl-63-66>66</a>
</span><span class=lnt id=hl-63-67><a class=lnlinks href=#hl-63-67>67</a>
</span><span class=lnt id=hl-63-68><a class=lnlinks href=#hl-63-68>68</a>
</span><span class=lnt id=hl-63-69><a class=lnlinks href=#hl-63-69>69</a>
</span><span class=lnt id=hl-63-70><a class=lnlinks href=#hl-63-70>70</a>
</span><span class=lnt id=hl-63-71><a class=lnlinks href=#hl-63-71>71</a>
</span><span class=lnt id=hl-63-72><a class=lnlinks href=#hl-63-72>72</a>
</span><span class=lnt id=hl-63-73><a class=lnlinks href=#hl-63-73>73</a>
</span><span class=lnt id=hl-63-74><a class=lnlinks href=#hl-63-74>74</a>
</span><span class=lnt id=hl-63-75><a class=lnlinks href=#hl-63-75>75</a>
</span><span class=lnt id=hl-63-76><a class=lnlinks href=#hl-63-76>76</a>
</span><span class=lnt id=hl-63-77><a class=lnlinks href=#hl-63-77>77</a>
</span><span class=lnt id=hl-63-78><a class=lnlinks href=#hl-63-78>78</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;orders&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Order</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@GeneratedValue</span><span class=p>(</span><span class=n>strategy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>GenerationType</span><span class=p>.</span><span class=na>IDENTITY</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;product_id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>nullable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>productId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;user_id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>nullable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>userId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;quantity&#34;</span><span class=p>,</span><span class=w> </span><span class=n>nullable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>quantity</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;total_amount&#34;</span><span class=p>,</span><span class=w> </span><span class=n>nullable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=n>precision</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>10</span><span class=p>,</span><span class=w> </span><span class=n>scale</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>2</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>totalAmount</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Enumerated</span><span class=p>(</span><span class=n>EnumType</span><span class=p>.</span><span class=na>STRING</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;status&#34;</span><span class=p>,</span><span class=w> </span><span class=n>nullable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>OrderStatus</span><span class=w> </span><span class=n>status</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@CreationTimestamp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;created_at&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>createdAt</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@UpdateTimestamp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;updated_at&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>LocalDateTime</span><span class=w> </span><span class=n>updatedAt</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 생성자, getter, setter, 비즈니스 메서드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=nf>Order</span><span class=p>()</span><span class=w> </span><span class=p>{}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Builder</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>Order</span><span class=p>(</span><span class=n>Long</span><span class=w> </span><span class=n>productId</span><span class=p>,</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>userId</span><span class=p>,</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>quantity</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>BigDecimal</span><span class=w> </span><span class=n>totalAmount</span><span class=p>,</span><span class=w> </span><span class=n>OrderStatus</span><span class=w> </span><span class=n>status</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>productId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>productId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>userId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>userId</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>quantity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>quantity</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>totalAmount</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>totalAmount</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>status</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 비즈니스 메서드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>confirm</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=na>status</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>OrderStatus</span><span class=p>.</span><span class=na>PENDING</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>IllegalStateException</span><span class=p>(</span><span class=s>&#34;대기 중인 주문만 확정할 수 있습니다&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>OrderStatus</span><span class=p>.</span><span class=na>CONFIRMED</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>cancel</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=na>status</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>OrderStatus</span><span class=p>.</span><span class=na>CONFIRMED</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>IllegalStateException</span><span class=p>(</span><span class=s>&#34;확정된 주문은 취소할 수 없습니다&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>OrderStatus</span><span class=p>.</span><span class=na>CANCELLED</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 주문 상태 Enum</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>enum</span><span class=w> </span><span class=n>OrderStatus</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PENDING</span><span class=p>(</span><span class=s>&#34;대기&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>CONFIRMED</span><span class=p>(</span><span class=s>&#34;확정&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>CANCELLED</span><span class=p>(</span><span class=s>&#34;취소&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>COMPLETED</span><span class=p>(</span><span class=s>&#34;완료&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>description</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>OrderStatus</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>description</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>description</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>description</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>getDescription</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>description</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ul><h3 id=주제와-관련하여-주목할-내용>주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#주제와-관련하여-주목할-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>핵심 항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>구조 원칙</strong></td><td>계층화 구조</td><td>관심사의 분리 (Separation of Concerns)</td><td>기능/책임에 따라 명확하게 계층 분리</td></tr><tr><td></td><td>책임 분리</td><td>단일 책임 원칙 (SRP)</td><td>각 계층이 하나의 목적/역할만 수행</td></tr><tr><td></td><td>인터페이스 기반 설계</td><td>계약 기반 통신 (계약 명세, API 스펙)</td><td>계층 간 통신을 인터페이스로 추상화</td></tr><tr><td></td><td>의존성 관리</td><td>의존성 역전 원칙 (DIP)</td><td>상위 계층이 추상에 의존하고 하위 계층은 구현에 집중</td></tr><tr><td><strong>설계 패턴</strong></td><td>프레젠테이션 패턴</td><td>MVC, MVVM, MVP</td><td>표현 계층의 책임 분리 및 테스트 용이성 향상</td></tr><tr><td></td><td>퍼시스턴스 패턴</td><td>Repository, Unit of Work</td><td>DB 접근 로직 추상화 및 트랜잭션 관리 일관화</td></tr><tr><td></td><td>비즈니스 로직 패턴</td><td>Service Layer, Use Case Pattern</td><td>도메인과 유스케이스 단위의 명확한 로직 구현</td></tr><tr><td><strong>현대 아키텍처</strong></td><td>도메인 중심 설계</td><td>DDD, Use Case 중심</td><td>도메인에 초점 맞춘 구조로 계층 배치</td></tr><tr><td></td><td>구조 확장 패턴</td><td>Hexagonal, Onion, Clean Architecture</td><td>계층 간 의존 방향을 제어하고 도메인 독립성 확보</td></tr><tr><td></td><td>이벤트 중심 패턴</td><td>Event Sourcing, CQRS</td><td>읽기/쓰기 분리 및 변경 이력 추적</td></tr><tr><td><strong>운영 전략</strong></td><td>테스트 자동화</td><td>단위/통합/E2E 테스트 전략</td><td>계층별 테스트 전략 명확화 및 자동화</td></tr><tr><td></td><td>배포 전략</td><td>CI/CD, Blue-Green, 독립 배포</td><td>각 계층의 독립 릴리즈 및 배포 안정성 확보</td></tr><tr><td></td><td>모니터링 및 품질</td><td>APM, 로깅, 트레이싱</td><td>계층별 성능 병목 식별 및 운영 품질 확보</td></tr><tr><td></td><td>보안 설계</td><td>계층별 인증/인가, 최소 권한 원칙</td><td>보안 경계를 계층별로 정의하여 리스크 최소화</td></tr><tr><td><strong>기술 전략</strong></td><td>API 관리</td><td>API Gateway, API-First</td><td>통합 진입점 구성 및 API 중심 설계 우선</td></tr><tr><td></td><td>캐싱 구조</td><td>다계층 캐싱 (프론트, 백엔드, DB)</td><td>요청 처리 최적화 및 응답 시간 개선</td></tr><tr><td></td><td>확장성 설계</td><td>클라우드 네이티브, 마이크로서비스화</td><td>Layered 구조에서 유연한 확장성과 서비스 전환 지원</td></tr><tr><td><strong>진화 경로</strong></td><td>아키텍처 발전</td><td>3-Layer → Modular → Hexagonal → Clean</td><td>계층 구조의 책임 분리 방식 진화 및 도메인 중심화</td></tr><tr><td></td><td>조직 연계 설계</td><td>Conway&rsquo;s Law 기반 조직 - 구조 정렬</td><td>조직 구조와 아키텍처 구조를 일치시켜 협업 효율성 향상</td></tr></tbody></table><ul><li><p><strong>구조 원칙</strong><br>Layered Architecture 의 핵심은 관심사의 분리와 책임 명확화다. 각 계층은 명확한 역할을 가지며, 인터페이스 기반으로만 통신하도록 하여 의존성과 복잡도를 낮춘다. DIP 의 적용은 도메인 보호와 유연한 계층 교체에 필수적이다.</p></li><li><p><strong>설계 패턴</strong><br>표현 계층에서는 MVC, MVVM 등으로 UI 와 로직을 분리하고, 퍼시스턴스 계층에서는 Repository/UoW 로 DB 접근을 캡슐화한다. 비즈니스 로직은 Service Layer 혹은 Use Case 로 도메인 로직을 정제하여 처리 흐름을 명확하게 한다.</p></li><li><p><strong>현대 아키텍처</strong><br>전통적인 Layered 구조를 발전시켜 도메인을 중심에 두는 Hexagonal, Clean, Onion 아키텍처로 진화해왔으며, 이들은 계층의 방향성과 독립성을 강조한다. CQRS, Event Sourcing 등은 이벤트 기반 시스템과 확장성에 대응하는 데 적합하다.</p></li><li><p><strong>운영 전략</strong><br>Layered 구조는 테스트 자동화와 계층별 CI/CD 파이프라인 구축에 유리하다. APM, 분산 트레이싱 등을 통해 병목을 추적하고, 보안 경계 설정을 통해 각 계층마다 인증·인가 체계를 분리 적용할 수 있다.</p></li><li><p><strong>기술 전략</strong><br>API Gateway 를 통한 통신 집약, API-First 를 통한 설계 주도 접근, 계층별 캐싱 구조는 성능과 유지보수 측면에서 중요한 전략이다. Layered 구조는 클라우드 및 마이크로서비스로의 점진적 전환 기반으로도 적합하다.</p></li><li><p><strong>진화 경로</strong><br>3 계층 아키텍처에서 시작해 모듈화된 구조, Hexagonal/Onion/Clean 아키텍처로 발전하는 과정은 책임 분리의 명확화와 의존성 관리의 엄격화 방향으로 진화해왔음을 보여준다. Conway&rsquo;s Law 기반의 조직 - 아키텍처 정렬은 실무에 필수적이다.</p></li></ul><h3 id=반드시-학습해야-할-내용>반드시 학습해야 할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야-할-내용>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>학습 주제</strong></th><th><strong>핵심 항목</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>아키텍처 개념</strong></td><td>계층 아키텍처의 원리</td><td>SoC, DIP, 계층 최소화 원칙</td><td>관심사의 분리 (SoC), 의존성 역전 (DIP) 및 불필요 계층 제거로 단순하고 테스트 가능한 구조 설계</td></tr><tr><td><strong>설계 원칙</strong></td><td>객체지향 설계 원칙</td><td>SOLID, SRP, OCP, ISP</td><td>계층 간 유연성·독립성을 유지하기 위한 객체지향 기반 원칙</td></tr><tr><td><strong>설계 전략</strong></td><td>도메인 기반 설계</td><td>DDD, Bounded Context, Aggregate, Use Case</td><td>도메인 중심으로 계층을 나누고 비즈니스 규칙과 기술 구현을 분리</td></tr><tr><td><strong>아키텍처 스타일</strong></td><td>현대적 계층화 패턴</td><td>Clean, Onion, Hexagonal, Modular Monolith</td><td>전통 Layered 구조를 개선한 구조로, 도메인 중심성과 테스트 용이성 확보</td></tr><tr><td><strong>계층 간 통신</strong></td><td>API 및 데이터 전달 방식</td><td>REST, gRPC, GraphQL, DTO</td><td>계층 간 경계 명확화 및 표준화된 통신 방식을 통해 통합 용이성 향상</td></tr><tr><td><strong>구현 기술</strong></td><td>의존성 제어 및 추상화</td><td>DI (Dependency Injection), IoC, 인터페이스 분리</td><td>느슨한 결합 및 테스트 가능성 확보를 위한 핵심 기술</td></tr><tr><td></td><td>ORM 기반 DB 접근</td><td>JPA, Hibernate, EF Core</td><td>DB 계층의 추상화를 통해 비즈니스 로직과 인프라 분리</td></tr><tr><td></td><td>웹 및 백엔드 프레임워크</td><td>Spring Boot, Express.js, ASP.NET</td><td>프레임워크별 계층 구성 특성을 이해하고 선택적으로 활용</td></tr><tr><td><strong>테스트 전략</strong></td><td>테스트 계층화</td><td>단위 테스트, 통합 테스트, Mock/Stub</td><td>계층별 독립 테스트 및 계약 기반 검증 전략 구축</td></tr><tr><td><strong>성능 최적화</strong></td><td>병목 해소 전략</td><td>캐싱 (Redis), CQRS, 병렬 처리, 비동기 메시징</td><td>계층 간 성능 저하를 방지하기 위한 기술 기반 최적화 전략 적용</td></tr><tr><td><strong>보안 설계</strong></td><td>보안 계층화 및 인증 관리</td><td>JWT, OAuth2, TLS, 입력 검증, RBAC</td><td>보안은 각 계층에서 책임을 분산하고 일관된 방식으로 처리되어야 함</td></tr><tr><td><strong>운영 및 배포</strong></td><td>배포 전략 및 자동화</td><td>CI/CD (GitHub Actions, GitLab CI), 컨테이너, Kubernetes</td><td>계층별 독립 배포 및 운영 효율성을 위한 클라우드 기반 배포 전략 설계</td></tr><tr><td><strong>관측 및 유지보수</strong></td><td>관측 가능성 및 운영 인프라</td><td>APM, 분산 트레이싱, ELK, OpenTelemetry</td><td>계층 간 병목 분석, 장애 추적, 서비스 가시성 확보를 위한 필수 도구</td></tr><tr><td><strong>횡단 관심사</strong></td><td>공통 기능 분리</td><td>로깅, 트랜잭션, 인증/인가 처리 (AOP, Middleware)</td><td>코드 중복 최소화 및 관심사의 분리 적용으로 코드 품질과 재사용성 향상</td></tr><tr><td><strong>조직 및 협업</strong></td><td>아키텍처 - 팀 연계</td><td>팀 구조 ↔ 아키텍처 정렬 (Conway&rsquo;s Law), 협업 구조 설계</td><td>기술 구조와 조직 구조를 일치시켜 생산성과 품질을 높임</td></tr></tbody></table><ul><li><p><strong>아키텍처 개념과 설계 원칙</strong>:<br>계층형 구조는 관심사 분리와 의존성 방향 제어가 핵심이다. SOLID 원칙과 함께 책임의 경계를 분명히 하고, 과도한 계층 분리를 지양해야 한다.</p></li><li><p><strong>도메인 기반 전략</strong>:<br>DDD (Domain-Driven Design) 를 활용하면 복잡한 비즈니스 로직을 도메인 중심으로 효과적으로 분리할 수 있으며, 이는 Clean/Onion 아키텍처와 밀접하게 연관된다.</p></li><li><p><strong>현대적 아키텍처 스타일</strong>:<br>Hexagonal, Onion, Modular Monolith 등은 전통 Layered 아키텍처의 한계를 보완하며, 테스트 용이성과 기술 독립성을 강화하는 방향으로 발전해왔다.</p></li><li><p><strong>계층 간 통신 및 구현 기술</strong>:<br>API 는 계층 간 경계를 유지하기 위한 핵심 수단이며, 의존성 주입 (DI) 과 인터페이스 분리는 구현 복잡도를 줄이고 테스트 유연성을 확보하는 데 중요하다.</p></li><li><p><strong>테스트 및 최적화</strong>:<br>테스트는 계층마다 독립적으로 이루어져야 하며, 병목은 캐시, CQRS, 비동기 처리 등으로 최소화되어야 한다.</p></li><li><p><strong>보안 및 운영</strong>:<br>계층별 보안은 입력 검증, 인증/인가, 암호화 등으로 강화되어야 하고, 배포는 자동화된 CI/CD 파이프라인과 클라우드 기반 인프라를 활용해 민첩성을 확보한다.</p></li><li><p><strong>유지보수와 관측성</strong>:<br>운영 단계에서는 로그 수집, 트레이싱, APM 도구를 통해 시스템 내부 상태를 가시화하고 장애에 신속히 대응해야 한다.</p></li><li><p><strong>Cross-cutting Concern</strong>:<br>로깅, 인증, 트랜잭션 등 공통 기능은 AOP 나 미들웨어로 분리해 계층의 순수성과 코드 일관성을 유지해야 한다.</p></li><li><p><strong>조직과 아키텍처의 일치</strong>:<br>아키텍처 설계는 팀 구조와도 밀접히 연결되며, 조직의 커뮤니케이션 방식과 아키텍처 방향성이 일치해야 운영과 개발의 효율성이 극대화된다.</p></li></ul><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어 (한글/영문)</th><th>설명</th></tr></thead><tbody><tr><td><strong>아키텍처 스타일</strong></td><td>Layered Architecture</td><td>기능과 책임을 논리적 계층으로 나눈 전통적 아키텍처 스타일</td></tr><tr><td></td><td>N-Tier Architecture</td><td>논리 계층을 물리적으로 분리하여 독립 배포 가능한 다층 구조</td></tr><tr><td></td><td>Clean Architecture</td><td>도메인을 중심으로 설계된 동심원 아키텍처 스타일</td></tr><tr><td></td><td>Hexagonal Architecture</td><td>Port & Adapter 기반, 외부 의존성과 도메인 분리</td></tr><tr><td></td><td>Onion Architecture</td><td>도메인을 중심으로 여러 계층이 감싸는 구조 (Clean 과 유사)</td></tr><tr><td></td><td>Serverless Architecture</td><td>함수 단위 컴퓨팅으로 운영하며 인프라를 숨기는 클라우드 아키텍처</td></tr><tr><td><strong>계층 구성 요소</strong></td><td>Presentation Layer</td><td>사용자 인터페이스 및 입력 처리 계층</td></tr><tr><td></td><td>Application Layer</td><td>유스케이스 조정, 서비스 흐름 제어</td></tr><tr><td></td><td>Domain Layer</td><td>비즈니스 규칙과 도메인 모델 구현 계층</td></tr><tr><td></td><td>Data Access Layer / Persistence Layer</td><td>DB 접근 및 저장 책임을 담당하는 계층</td></tr><tr><td><strong>설계 원칙</strong></td><td>Separation of Concerns (SoC)</td><td>관심사 분리를 통해 책임 분리 및 응집도 향상</td></tr><tr><td></td><td>Single Responsibility Principle (SRP)</td><td>각 모듈/계층은 하나의 책임만 가져야 함</td></tr><tr><td></td><td>Dependency Inversion Principle (DIP)</td><td>고수준 모듈이 저수준 구현이 아닌 추상에 의존</td></tr><tr><td></td><td>Open-Closed Principle (OCP)</td><td>확장에는 열려 있고, 수정에는 닫혀야 함</td></tr><tr><td></td><td>Encapsulation / Abstraction</td><td>계층 내부 구현을 외부로부터 은닉, 추상화된 인터페이스 제공</td></tr><tr><td><strong>설계/구현 패턴</strong></td><td>Service Layer</td><td>유즈케이스 단위 비즈니스 로직 담당</td></tr><tr><td></td><td>DTO (Data Transfer Object)</td><td>계층 간 데이터 전달을 위한 단순 구조체</td></tr><tr><td></td><td>DAO (Data Access Object)</td><td>DB 와의 연결을 추상화하는 객체</td></tr><tr><td></td><td>Repository Pattern</td><td>도메인 객체 중심의 데이터 접근 추상화</td></tr><tr><td></td><td>Dependency Injection (DI)</td><td>의존성을 외부에서 주입하는 구현 방식</td></tr><tr><td></td><td>Inversion of Control (IoC)</td><td>제어 흐름을 프레임워크나 외부로 위임하는 설계 방식</td></tr><tr><td></td><td>Facade Pattern</td><td>복잡한 내부 로직을 단순 인터페이스로 감싸는 패턴</td></tr><tr><td><strong>운영 전략 및 DevOps</strong></td><td>API Gateway</td><td>인증, 라우팅, 보안 정책을 적용하는 중앙 진입점</td></tr><tr><td></td><td>CI/CD</td><td>지속적 통합 및 배포 자동화를 통해 개발 주기 단축</td></tr><tr><td></td><td>Infrastructure as Code (IaC)</td><td>인프라를 코드로 정의하여 버전 관리 및 자동화 가능</td></tr><tr><td></td><td>Container Orchestration</td><td>컨테이너 배포 및 확장, 복구 등을 자동화 (예: Kubernetes)</td></tr><tr><td></td><td>Blue-Green Deployment</td><td>무중단 배포 전략으로 새/이전 버전 병행 운영 후 전환</td></tr><tr><td><strong>성능 최적화 전략</strong></td><td>Caching</td><td>반복되는 데이터를 임시 저장하여 응답 시간 개선</td></tr><tr><td></td><td>Batch Processing</td><td>대량 데이터를 일괄 처리하여 시스템 효율성 확보</td></tr><tr><td></td><td>Autoscaling</td><td>트래픽에 따라 자원을 자동으로 증가/감소</td></tr><tr><td><strong>현대 아키텍처 기법</strong></td><td>Event Sourcing</td><td>상태 변화를 이벤트로 기록하고 재구성하는 패턴</td></tr><tr><td></td><td>CQRS</td><td>읽기/쓰기 모델을 분리하여 성능과 유지보수성 향상</td></tr><tr><td><strong>보안 및 품질</strong></td><td>Authentication / Authorization</td><td>사용자 신원 확인 및 권한 검증</td></tr><tr><td></td><td>Input Validation</td><td>외부 입력에 대한 유효성 및 보안 검증</td></tr><tr><td></td><td>Contract Testing</td><td>API 간 계약 명세 기반의 호환성 테스트</td></tr><tr><td></td><td>Static Analysis</td><td>코드 실행 없이 문법 및 품질 분석</td></tr><tr><td><strong>테스트 기법</strong></td><td>Unit Test</td><td>가장 작은 코드 단위를 테스트</td></tr><tr><td></td><td>Mock</td><td>외부 의존성을 대체하여 독립적인 테스트 환경 구성</td></tr><tr><td><strong>운영/모니터링</strong></td><td>Observability</td><td>메트릭, 로그, 트레이스 기반의 상태 관측 및 분석</td></tr><tr><td></td><td>APM</td><td>애플리케이션 성능을 실시간으로 모니터링하는 시스템</td></tr><tr><td></td><td>Distributed Tracing</td><td>마이크로서비스 간 요청 흐름을 추적하는 기술</td></tr><tr><td><strong>DDD 구성 요소</strong></td><td>Aggregate</td><td>일관성 경계를 가진 도메인 객체 묶음</td></tr><tr><td></td><td>Entity</td><td>고유 식별자가 있는 도메인 객체</td></tr><tr><td></td><td>Value Object</td><td>식별자 없이 값만으로 의미를 가지는 객체</td></tr><tr><td></td><td>Domain Event</td><td>도메인에서 발생한 의미 있는 상태 변화</td></tr><tr><td><strong>계층 인터페이스</strong></td><td>Port</td><td>외부 세계와 내부 도메인을 연결하는 추상화된 인터페이스</td></tr><tr><td></td><td>Adapter</td><td>실제 기술 스택과 포트를 연결하는 구현체</td></tr><tr><td><strong>안티패턴</strong></td><td>Architecture Sinkhole</td><td>처리 없이 계층을 단순 통과하는 설계 오류</td></tr><tr><td></td><td>God Object</td><td>너무 많은 책임을 가진 클래스/객체</td></tr><tr><td></td><td>Tight Coupling</td><td>계층 간 강한 종속으로 인한 유지보수 어려움</td></tr><tr><td><strong>기타 개념</strong></td><td>Conway&rsquo;s Law</td><td>조직의 커뮤니케이션 구조가 시스템 구조에 반영된다는 법칙</td></tr><tr><td></td><td>Multi-Tenancy</td><td>하나의 인스턴스로 여러 고객을 동시에 서비스하는 구조</td></tr><tr><td></td><td>Edge Server</td><td>사용자와 가까운 위치에서 처리하는 서버 (지연 감소 목적)</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://martinfowler.com/articles/enterprisePatterns.html>Martin Fowler – Layered Architecture Pattern</a></li><li><a href=https://learn.microsoft.com/en-us/azure/architecture/guide/architecture-styles/n-tier>Microsoft – The n-Tier Architecture and Layered Architecture Guide</a></li><li><a href=https://en.wikipedia.org/wiki/Strangler_fig_pattern>Strangler Fig Pattern</a></li><li><a href=https://en.wikipedia.org/wiki/Hexagonal_architecture_%28software%29>Hexagonal Architecture (Ports & Adapters)</a></li><li><a href=https://martinfowler.com/eaaCatalog/serviceLayer.html>Service Layer Pattern – Martin Fowler</a></li><li><a href=https://arxiv.org/abs/1503.04916>Systematic Review of Layered Architecture Principles</a></li><li><a href=https://www.redhat.com/en/blog/5-essential-patterns-software-architecture>Red Hat – Layered Architecture Overview</a></li><li><a href=https://medium.com/%40iamprovidence/backend-side-architecture-evolution-n-layered-ddd-hexagon-onion-clean-architecture-643d72444ce4>Backend Evolution: N-Layered → DDD → Hexagonal</a></li><li><a href=https://www.linkedin.com/pulse/clean-hexagonal-traditional-layered-architectures-abdallah-shaaban-vpvwf>Clean/Hexagonal vs Traditional Layered Architectures</a></li></ul><hr></div></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>