<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Multi-tenancy | hyunyoun's Blog</title><meta name=keywords content="System-Design,System-Design-Fundamentals,Multi-tenancy,Tenant-Isolation,SaaS,Resource-Sharing"><meta name=description content="**멀티테넌시(Multi-tenancy)**는 단일 소프트웨어 인스턴스가 다수의 테넌트를 논리적으로 분리된 구조로 서비스하는 아키텍처로, 리소스를 공유하면서도 데이터 격리를 보장한다. 비용 절감, 확장성, 운영 효율성이 강점이며, 보안, 성능 격리, 커스터마이즈 관리가 도전 과제이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/cloud-native-architecture/multi-tenancy/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/cloud-native-architecture/multi-tenancy/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/cloud-native-architecture/multi-tenancy/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/cloud-native-architecture/multi-tenancy/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Multi-tenancy"><meta property="og:description" content="**멀티테넌시(Multi-tenancy)**는 단일 소프트웨어 인스턴스가 다수의 테넌트를 논리적으로 분리된 구조로 서비스하는 아키텍처로, 리소스를 공유하면서도 데이터 격리를 보장한다. 비용 절감, 확장성, 운영 효율성이 강점이며, 보안, 성능 격리, 커스터마이즈 관리가 도전 과제이다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Multi-tenancy"><meta name=twitter:description content="**멀티테넌시(Multi-tenancy)**는 단일 소프트웨어 인스턴스가 다수의 테넌트를 논리적으로 분리된 구조로 서비스하는 아키텍처로, 리소스를 공유하면서도 데이터 격리를 보장한다. 비용 절감, 확장성, 운영 효율성이 강점이며, 보안, 성능 격리, 커스터마이즈 관리가 도전 과제이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HY's Blog","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":5,"name":"Multi-tenancy","item":"https://buenhyden.github.io/posts/system-architecture--design/architecture-styles/cloud-native-architecture/multi-tenancy/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>HY's Blog</a></div><h1>Multi-tenancy</h1><div class=post-description>**멀티테넌시(Multi-tenancy)**는 단일 소프트웨어 인스턴스가 다수의 테넌트를 논리적으로 분리된 구조로 서비스하는 아키텍처로, 리소스를 공유하면서도 데이터 격리를 보장한다. 비용 절감, 확장성, 운영 효율성이 강점이며, 보안, 성능 격리, 커스터마이즈 관리가 도전 과제이다.</div></header><div class=post-content><h2 id=multi-tenancy>Multi-tenancy<a hidden class=anchor aria-hidden=true href=#multi-tenancy>#</a></h2><p>멀티테넌시는 단일 애플리케이션 인스턴스 및 인프라를 여러 고객 (테넌트) 이 공유하면서도, 데이터, 설정, UI 등을 논리적으로 분리해 독립적인 사용자 경험을 제공하는 클라우드 기반 아키텍처이다. 공유 스키마, 개별 스키마, 전용 DB 등 다양한 데이터 격리 모델을 통해 비용 절감과 확장성을 달성하며, 인증·인가, 운영 모니터링, CI/CD 자동화 등 보안 및 운영 전략이 필수적으로 요구된다. 구현 방식에 따라 Soft/Hard Tenancy 또는 Hybrid 모델로 분류되며, SaaS 플랫폼의 효율성과 유연성을 확보하기 위한 핵심 설계 원칙으로 작용한다.</p><h3 id=등장-배경-및-발전-과정>등장 배경 및 발전 과정<a hidden class=anchor aria-hidden=true href=#등장-배경-및-발전-과정>#</a></h3><h4 id=등장-배경>등장 배경<a hidden class=anchor aria-hidden=true href=#등장-배경>#</a></h4><p>멀티테넌시는 <strong>1960 년대 메인프레임 시대의 타임 쉐어링 시스템 (TSS)</strong> 에서 유래한 리소스 공유 개념에서 출발했다.<br>이후 1990 년대에는 <strong>ASP(Application Service Provider)</strong> 모델이 등장하며 웹 기반 애플리케이션을 여러 고객에게 제공하는 시도가 이루어졌으나, 보안과 유지보수의 어려움으로 확산에는 한계가 있었다.<br>2000 년대에 들어서면서 <strong>Salesforce</strong>를 필두로 한 SaaS 모델이 등장했고, 하나의 인프라와 애플리케이션 인스턴스를 여러 고객이 공유하되, <strong>데이터와 설정은 논리적으로 분리</strong>하는 멀티테넌시 아키텍처가 SaaS 의 핵심 패턴으로 자리 잡게 되었다.</p><h4 id=발전-과정>발전 과정<a hidden class=anchor aria-hidden=true href=#발전-과정>#</a></h4><table><thead><tr><th>시기</th><th>발전 단계</th><th>주요 특징</th></tr></thead><tbody><tr><td><strong>1960s~1980s</strong></td><td>타임 쉐어링 개념 도입</td><td>IBM 메인프레임에서 리소스 분할 사용 개념 등장</td></tr><tr><td><strong>1990s~2000s</strong></td><td>ASP → SaaS 진화</td><td>ASP 의 공유 방식 한계를 SaaS 가 아키텍처적 접근으로 극복</td></tr><tr><td><strong>2000s 중반</strong></td><td>Salesforce, Google Apps</td><td>멀티테넌시 기반 SaaS 상용화, 퍼블릭 클라우드 등장</td></tr><tr><td><strong>2010s 초중반</strong></td><td>가상화 → 컨테이너화</td><td>VMware, Docker 기반 논리적 격리 구현 강화</td></tr><tr><td><strong>2010s 후반~현재</strong></td><td>마이크로서비스, 서버리스</td><td>테넌트별 독립성 강화 및 함수 단위 격리 실현</td></tr><tr><td><strong>2020s~</strong></td><td>AI/ML 통합 멀티테넌시</td><td>테넌트 기반 추천 시스템, 예측 모델 API 제공 (예: Amazon Personalize, Google Vertex AI)</td></tr></tbody></table><h3 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h3><h4 id=목적>목적<a hidden class=anchor aria-hidden=true href=#목적>#</a></h4><p>멀티테넌시의 목적은 하나의 애플리케이션 인스턴스와 공통 인프라를 통해 다수의 고객에게 서비스를 제공하면서도, 유지보수, 배포, 업데이트 등을 중앙 집중식으로 처리하여 <strong>운영 효율성과 개발 생산성을 극대화</strong>하는 데 있다. 이를 통해 <strong>서비스 일관성 유지, 비용 절감, 고객 맞춤형 기능 제공</strong>이 가능해진다.</p><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>운영 효율성</strong></td><td>단일 인스턴스 관리로 유지보수, 보안 패치, 배포 등을 중앙에서 일괄 처리함.</td></tr><tr><td><strong>비용 최적화</strong></td><td>인프라, 라이선스, 운영 자원을 공유하여 고객별 TCO 를 절감함.</td></tr><tr><td><strong>서비스 일관성</strong></td><td>하나의 코드베이스로 모든 고객에게 동일한 기능, 품질을 제공함.</td></tr><tr><td><strong>개발 생산성 향상</strong></td><td>코드 통합 및 테스트 자동화를 통해 개발 주기 단축과 품질 향상이 가능함.</td></tr><tr><td><strong>맞춤형 서비스 제공</strong></td><td>설정 기반으로 테넌트별 UI, 기능 등을 동적으로 구성하여 고객 맞춤화 가능함.</td></tr></tbody></table><h4 id=필요성>필요성<a hidden class=anchor aria-hidden=true href=#필요성>#</a></h4><ul><li><strong>비용 최적화</strong>: 인프라, 운영, 라이선스 비용을 다수 고객이 분담하여 TCO 를 절감</li><li><strong>확장성 확보</strong>: 테넌트 증가 시 별도 인프라 없이 빠르게 서비스 확장 가능</li><li><strong>운영 효율성</strong>: 단일 인스턴스 관리로 업데이트, 패치, 모니터링 등 유지보수가 단순화</li><li><strong>비즈니스 민첩성</strong>: 고객별 설정 기반 맞춤 서비스 제공으로 시장 대응력 향상</li><li><strong>보안 및 규제 대응</strong>: 데이터 격리, 인증/인가, 감사 로그 등 보안 요구사항에 유연하게 대응</li><li><strong>글로벌 서비스 및 디지털 전환 대응</strong>: 멀티 리전 운영 및 클라우드 네이티브 전략과의 자연스러운 결합</li></ul><table><thead><tr><th>항목</th><th>설명</th><th></th></tr></thead><tbody><tr><td><strong>확장성 확보</strong></td><td>새로운 테넌트 추가 시 시스템 구조 변경 없이 손쉽게 확장 가능함.</td><td></td></tr><tr><td><strong>운영 자동화</strong></td><td>CI/CD, 모니터링, 테넌트 온보딩 등을 자동화하여 대규모 운영 효율화 가능함.</td><td></td></tr><tr><td><strong>보안 및 규제 준수</strong></td><td>테넌트 간 데이터 격리, 인증/인가, 감사 로그 등을 통해 보안 및 컴플라이언스 대응 가능함.</td><td></td></tr><tr><td><strong>비즈니스 민첩성 확보</strong></td><td>빠른 배포 및 고객 요구사항에 대한 즉각 대응이 가능하여 경쟁 우위 확보에 기여함.</td><td></td></tr><tr><td><strong>디지털 전환 대응</strong></td><td>클라우드 전환, 구독 기반 경제, 글로벌 진출 등 최신 비즈니스 환경에 유연하게 대응 가능함.</td><td></td></tr></tbody></table><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><table><thead><tr><th>개념 항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>테넌트 (Tenant)</strong></td><td>서비스를 이용하는 개별 조직 또는 사용자 그룹으로, 독립된 데이터, 설정, 환경을 가짐</td></tr><tr><td><strong>데이터 격리</strong></td><td>테넌트 간 데이터가 물리적 또는 논리적으로 완전히 분리되어야 하며, 격리 수준은 Shared Table ~ Separate DB 까지 다양함</td></tr><tr><td><strong>리소스 공유</strong></td><td>하나의 애플리케이션 인스턴스, 인프라, 네트워크를 여러 테넌트가 공유</td></tr><tr><td><strong>테넌트 인식</strong></td><td>요청마다 어떤 테넌트 소속인지 인식하고, 해당 테넌트 컨텍스트에 맞는 데이터와 설정을 적용</td></tr><tr><td><strong>보안 및 권한 관리</strong></td><td>RBAC, 인증/인가, 암호화 등을 통해 각 테넌트의 데이터 접근과 제어를 분리</td></tr><tr><td><strong>운영 분리</strong></td><td>로그, 모니터링, SLA, 알림 등을 테넌트 단위로 분리하여 관리</td></tr></tbody></table><h4 id=핵심-개념과-실무-구현-연관성>핵심 개념과 실무 구현 연관성<a hidden class=anchor aria-hidden=true href=#핵심-개념과-실무-구현-연관성>#</a></h4><table><thead><tr><th>항목</th><th>구현 방식 및 설명</th></tr></thead><tbody><tr><td><strong>DB 격리 전략</strong></td><td>Shared Table (Tenant ID), Schema-per-Tenant, Separate DB, Hybrid 전략</td></tr><tr><td><strong>테넌트 컨텍스트 처리</strong></td><td>요청 헤더/토큰에서 Tenant ID 추출 → 미들웨어에서 컨텍스트 삽입 및 전파</td></tr><tr><td><strong>보안 적용</strong></td><td>데이터 at-rest/in-transit 암호화, 테넌트별 접근 제어, 감시 로그 분리</td></tr><tr><td><strong>모니터링/로깅</strong></td><td>Prometheus, Grafana, ELK 등을 활용해 테넌트별 메트릭 수집 및 장애 감지</td></tr><tr><td><strong>CI/CD 전략</strong></td><td>공통 코드 기반 배포, 테넌트별 기능 플래그 및 롤백 전략 적용</td></tr><tr><td><strong>자원 분리/쿼터 관리</strong></td><td>Kubernetes ResourceQuota, DB Connection Pool per tenant</td></tr><tr><td><strong>테넌트 온보딩/해지</strong></td><td>템플릿 기반 자동화 (Helm, Terraform 등), 데이터 보존 및 삭제 정책 필요</td></tr></tbody></table><h4 id=멀티테넌시-계층-구조-설계>멀티테넌시 계층 구조 설계<a hidden class=anchor aria-hidden=true href=#멀티테넌시-계층-구조-설계>#</a></h4><p>멀티테넌시 시스템은 일반적으로 다음과 같은 계층 구조를 기반으로 설계된다:</p><pre class=mermaid>flowchart TD
    UI[Presentation Layer&lt;br/&gt;Web / API Gateway]
    App[Application Layer&lt;br/&gt;Business Logic]
    SVC[Service Layer&lt;br/&gt;Tenant-Aware Services]
    DBL[Persistence Layer&lt;br/&gt;ORM / Query Builder]
    DB[Database Layer&lt;br/&gt;Shared or Separate DB]
    Infra[Infrastructure Layer&lt;br/&gt;Kubernetes, CI/CD, Monitoring]

    UI --&gt; App
    App --&gt; SVC
    SVC --&gt; DBL
    DBL --&gt; DB
    Infra --&gt; App
    Infra --&gt; DB
</pre><h5 id=계층별-구조-및-설명>계층별 구조 및 설명<a hidden class=anchor aria-hidden=true href=#계층별-구조-및-설명>#</a></h5><table><thead><tr><th>계층</th><th>구성 요소</th><th>설명</th><th>멀티테넌시 적용 포인트</th></tr></thead><tbody><tr><td><strong>Presentation Layer</strong></td><td>Web, Mobile, API Gateway</td><td>사용자 인터페이스 및 진입점</td><td>테넌트별 브랜딩, UI 커스터마이징</td></tr><tr><td><strong>Application Layer</strong></td><td>Business Logic, Controllers</td><td>핵심 도메인 로직 처리</td><td>테넌트 인식 (Tenant Context) 삽입 및 기능 분기</td></tr><tr><td><strong>Service Layer</strong></td><td>Service Classes, Middlewares</td><td>로직 추상화 계층</td><td>요청 시 테넌트 ID 추출, RLS, 쿼리 필터 적용</td></tr><tr><td><strong>Persistence Layer</strong></td><td>ORM, Repositories</td><td>DB 접근 계층</td><td>테넌트 식별자 기반 쿼리 조건 자동화</td></tr><tr><td><strong>Database Layer</strong></td><td>RDBMS / NoSQL</td><td>실제 데이터 저장소</td><td>테넌트 격리 전략 적용 (Shared → Separate)</td></tr><tr><td><strong>Infrastructure Layer</strong></td><td>Container, K8s, CI/CD, Monitoring</td><td>실행 환경 및 운영 관리</td><td>테넌트별 네임스페이스, 자원 쿼터, 배포 단위 구성</td></tr></tbody></table><h5 id=계층-설계--사례-매핑-요약>계층 설계 + 사례 매핑 요약<a hidden class=anchor aria-hidden=true href=#계층-설계--사례-매핑-요약>#</a></h5><table><thead><tr><th>계층</th><th>실무 구현 사례 매핑</th></tr></thead><tbody><tr><td><strong>Presentation</strong></td><td>테넌트별 UI 테마 (React + ThemeProvider)</td></tr><tr><td><strong>Application</strong></td><td>테넌트 인식 미들웨어 (FastAPI 에서 Request Scope 활용)</td></tr><tr><td><strong>Service</strong></td><td>기능 플래그 기반 커스터마이징 (LaunchDarkly, Unleash 등)</td></tr><tr><td><strong>Persistence</strong></td><td>DB 스키마 분리 또는 Row-level Security 적용 (PostgreSQL RLS)</td></tr><tr><td><strong>Database</strong></td><td>테넌트별 DB 또는 공유 DB + <code>Tenant_ID</code> 전략</td></tr><tr><td><strong>Infrastructure</strong></td><td>K8s 네임스페이스, ResourceQuota, Prometheus + Grafana</td></tr></tbody></table><h3 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h3><h4 id=주요-기능>주요 기능<a hidden class=anchor aria-hidden=true href=#주요-기능>#</a></h4><p>멀티테넌시 시스템이 제공하는 <strong>구현 메커니즘</strong>이다.</p><table><thead><tr><th>기능 분류</th><th>세부 기능</th><th>설명</th></tr></thead><tbody><tr><td><strong>테넌트 식별</strong></td><td>요청 기반 식별</td><td>도메인, 헤더, 토큰 등을 통한 테넌트 구분</td></tr><tr><td><strong>데이터 격리</strong></td><td>논리적/물리적 분리</td><td>스키마 분리, DB 분리, 쿼리 필터링 등</td></tr><tr><td><strong>인증 및 권한</strong></td><td>RBAC/ABAC 적용</td><td>테넌트 경계 내 사용자 권한 분리</td></tr><tr><td><strong>자원 제어</strong></td><td>CPU/메모리 제한</td><td>Kubernetes ResourceQuota, LimitRange 등 활용</td></tr><tr><td><strong>커스터마이징</strong></td><td>UI/기능/로직 설정</td><td>테넌트 맞춤 워크플로우 및 기능 플래그 지원</td></tr><tr><td><strong>운영 관리</strong></td><td>온보딩/삭제/패치</td><td>라이프사이클 전반 관리 자동화</td></tr><tr><td><strong>모니터링 및 감사</strong></td><td>테넌트 별 로깅/알림</td><td>보안 및 운영 트레이서빌리티 확보</td></tr><tr><td><strong>기능 제어</strong></td><td>테넌트별 기능 활성화</td><td>테넌트마다 특정 기능 on/off 제어</td></tr></tbody></table><h4 id=주요-역할>주요 역할<a hidden class=anchor aria-hidden=true href=#주요-역할>#</a></h4><p>이 기능이 실질적으로 달성하고자 하는 <strong>비즈니스적/운영적 목적</strong>이다.</p><table><thead><tr><th>역할 분류</th><th>설명</th><th>관련 기능</th></tr></thead><tbody><tr><td><strong>보안 경계 제공</strong></td><td>데이터 누출 방지, 사용자 권한 분리</td><td>테넌트 식별, 데이터 격리, 인증/인가</td></tr><tr><td><strong>비용 최적화</strong></td><td>공통 인프라로 운영비 절감</td><td>자원 제어, 공유 인프라 관리</td></tr><tr><td><strong>확장성 확보</strong></td><td>테넌트 증가 시 선형 확장 지원</td><td>온보딩, 기능 토글, 리소스 관리</td></tr><tr><td><strong>운영 효율성</strong></td><td>중앙화된 관리 체계 확보</td><td>모니터링, 감사, 패치, 자동화</td></tr><tr><td><strong>QoS 및 SLA 유지</strong></td><td>성능 보장 및 장애 대응</td><td>모니터링, 리소스 할당, 격리</td></tr><tr><td><strong>비즈니스 유연성 확보</strong></td><td>각기 다른 고객 요구 대응</td><td>커스터마이징, 기능 제어</td></tr></tbody></table><h4 id=각-기능별-구현-기술-스택-매핑>각 기능별 구현 기술 스택 매핑<a hidden class=anchor aria-hidden=true href=#각-기능별-구현-기술-스택-매핑>#</a></h4><table><thead><tr><th>기능 분류</th><th>세부 기능</th><th>주요 기술 스택 및 도구</th></tr></thead><tbody><tr><td><strong>테넌트 식별</strong></td><td>요청 기반 식별</td><td><code>FastAPI/Flask Middleware</code>, <code>JWT</code>, <code>API Gateway</code>, <code>Nginx</code></td></tr><tr><td><strong>데이터 격리</strong></td><td>논리/물리적 분리</td><td>PostgreSQL (Row-level Security), MongoDB, DB-per-tenant 구조, SQLAlchemy</td></tr><tr><td><strong>인증 및 권한 관리</strong></td><td>사용자 인증, 테넌트 경계 분리</td><td><code>OAuth2.0</code>, <code>JWT</code>, <code>Keycloak</code>, <code>Auth0</code>, <code>Cognito</code>, <code>OPA</code></td></tr><tr><td><strong>자원 제어</strong></td><td>CPU/메모리 제한</td><td><code>Kubernetes ResourceQuota</code>, <code>LimitRange</code>, <code>cgroup</code>, <code>vCPU/Memory limit</code></td></tr><tr><td><strong>커스터마이징 관리</strong></td><td>UI/기능/로직 설정</td><td><code>Feature Flags</code>, <code>LaunchDarkly</code>, <code>Unleash</code>, <code>Envoy Filters</code>, 테넌트별 설정 DB</td></tr><tr><td><strong>운영 관리</strong></td><td>온보딩/삭제/패치</td><td><code>Terraform</code>, <code>Helm</code>, <code>Ansible</code>, <code>ArgoCD</code>, <code>GitOps</code></td></tr><tr><td><strong>모니터링 및 감사</strong></td><td>로깅, 알림, 추적</td><td><code>Prometheus</code>, <code>Grafana</code>, <code>Elastic Stack</code>, <code>OpenTelemetry</code>, <code>Fluentd</code>, <code>Alertmanager</code></td></tr><tr><td><strong>기능 제어</strong></td><td>테넌트별 기능 활성화/비활성화</td><td><code>Feature Toggles</code>, <code>LaunchDarkly</code>, <code>Split.io</code>, DB 설정 플래그</td></tr></tbody></table><blockquote><p>각 기능은 SaaS 구조에서 <strong>API Gateway → Middleware → App Layer → Infra Layer</strong>에 걸쳐 구현됨</p></blockquote><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><p>멀티테넌시는 논리적 격리와 물리적 공유를 기반으로 하며, 효율적인 운영, 확장성, 보안, 사용자 맞춤화의 균형을 추구한다. 모든 테넌트는 동일한 코드와 인프라를 사용하지만 데이터, 설정, 권한 등은 분리되어 있어 독립된 사용자 경험이 가능하다. 테넌트별 커스터마이징, 모니터링, 버전 관리, SLA 분리는 확장성 있는 SaaS 운영을 위한 핵심 전략이다.</p><table><thead><tr><th>카테고리</th><th>특징 항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>격리와 보안</strong></td><td>데이터 격리</td><td>테넌트 간 데이터, 설정, 사용자 분리 (Row/Schema/DB)</td></tr><tr><td></td><td>접근 제어 및 인증</td><td>RBAC, OAuth2, 테넌트별 인증/인가 처리</td></tr><tr><td></td><td>투명성 보장</td><td>한 테넌트가 다른 테넌트를 인식하지 못하게 설계</td></tr><tr><td><strong>자원과 효율성</strong></td><td>자원 공유</td><td>서버, DB, 네트워크 등 인프라 자원 공동 사용</td></tr><tr><td></td><td>비용 최적화</td><td>인프라 중복 최소화로 TCO 절감</td></tr><tr><td></td><td>중앙 집중 관리</td><td>단일 코드/플랫폼으로 유지보수와 배포 일괄 처리</td></tr><tr><td></td><td>배포 효율성</td><td>CI/CD 파이프라인을 통해 전체 테넌트에 동시에 업데이트</td></tr><tr><td><strong>확장성과 유연성</strong></td><td>스케일링</td><td>테넌트 증가에 따른 수평/수직 확장 용이</td></tr><tr><td></td><td>커스터마이징 지원</td><td>테넌트별 UI/기능/설정 맞춤화</td></tr><tr><td></td><td>기능 플래그 및 버전 분리</td><td>특정 테넌트에게만 기능 오픈 또는 롤아웃 가능</td></tr><tr><td><strong>운영 및 가시성</strong></td><td>SLA 및 모니터링 분리</td><td>테넌트별 성능 지표 수집, 경보 설정, SLA 트래킹</td></tr><tr><td></td><td>라이프사이클 관리</td><td>온보딩, 해지, 백업/복원, 마이그레이션 절차 존재</td></tr><tr><td></td><td>성능 격리</td><td>과도한 사용으로 인한 타 테넌트 영향 방지를 위한 QoS 설계</td></tr></tbody></table><p>멀티테넌시의 핵심은 <strong>논리적 격리와 자원 공유의 균형</strong>이다. 격리 측면에서는 테넌트별 데이터 보호, 접근 제어, 인증 분리가 필수이며, 자원 측면에서는 서버/DB 를 공유하면서도 비용을 최적화하고 운영을 단순화할 수 있다. 또한, UI/기능 수준의 유연한 커스터마이징, CI/CD 기반의 일괄 배포, SLA 분리 등은 대규모 SaaS 운영의 핵심 전략이다. 마지막으로, 온보딩~해지까지의 전체 테넌트 라이프사이클을 정책적으로 다룰 수 있어야 멀티테넌시의 강점을 극대화할 수 있다.</p><h3 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h3><p>멀티테넌시 시스템의 핵심 원칙은 <strong>강력한 격리</strong>, <strong>보안 중심 설계</strong>, <strong>운영 자동화</strong>, <strong>자원 효율성</strong>, <strong>유연한 커스터마이징</strong>, 그리고 <strong>테넌트 독립성 보장</strong>에 기반한다. 모든 요청은 테넌트 컨텍스트 하에서 처리되며, 자원은 공유하되 논리적으로 철저히 분리되어야 한다. 장애, 성능, 데이터 관점의 격리를 통해 공정한 서비스 품질을 유지하고, 자동화된 온보딩·업데이트·할당 체계를 갖추어야 안정적인 대규모 운영이 가능하다. 보안, 감사, 데이터 주권 등 정책 요소 역시 설계 초기부터 반영되어야 한다.</p><table><thead><tr><th>카테고리</th><th>원칙 항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>격리 원칙</strong></td><td>데이터 격리</td><td>테넌트 간 데이터는 절대 공유되지 않으며, 논리적/물리적 분리 유지</td></tr><tr><td></td><td>성능 격리</td><td>Noisy Neighbor 방지를 위해 자원 할당 제한, Throttling 적용</td></tr><tr><td></td><td>장애 격리</td><td>한 테넌트 장애가 전체 서비스에 영향을 주지 않도록 벌크헤드, Circuit Breaker 적용</td></tr><tr><td><strong>보안 원칙</strong></td><td>최소 권한 원칙 (RBAC)</td><td>테넌트는 자신의 리소스에만 접근 가능하며, 역할 기반으로 제어</td></tr><tr><td></td><td>인증·인가 및 암호화</td><td>OAuth2, JWT, 데이터 암호화 등 보안 메커니즘 기본 설계</td></tr><tr><td></td><td>감사 및 로깅 분리</td><td>테넌트별로 활동 로그, 감사 정보가 구분되어 저장되고 추적 가능</td></tr><tr><td><strong>운영 원칙</strong></td><td>자동화된 프로비저닝</td><td>테넌트 생성, 초기화, 배포가 자동화되어야 대규모 운영 가능</td></tr><tr><td></td><td>버전 및 기능 관리</td><td>기능 플래그, A/B 테스트 등을 통한 선택적 기능 제공</td></tr><tr><td></td><td>아키텍처 반복 검토</td><td>규모, 보안, 격리 요구에 따라 하이브리드 모델로 전환 고려</td></tr><tr><td><strong>유연성 및 효율성</strong></td><td>자원 공유 최적화</td><td>인프라 자원은 최대한 공유하되, 격리와 효율성 균형 유지</td></tr><tr><td></td><td>커스터마이징 가능성</td><td>설정, UI, 워크플로우 수준에서 테넌트 요구에 맞게 맞춤화 가능</td></tr><tr><td><strong>투명성/독립성</strong></td><td>테넌트 독립성 보장</td><td>한 테넌트는 다른 테넌트의 존재조차 인식하지 못하도록 설계</td></tr><tr><td></td><td>컨텍스트 인식 처리</td><td>모든 요청에 테넌트 ID 가 전파되어야 하며, 전체 호출 체인에서 유지되어야 함</td></tr></tbody></table><ul><li><strong>격리 원칙</strong>은 멀티테넌시 시스템의 신뢰성과 안정성을 결정하는 핵심으로, 데이터·장애·성능 등 모든 측면에서 테넌트 간 완전한 분리가 보장되어야 한다.</li><li><strong>보안 원칙</strong>은 인증·인가, RBAC, 암호화, 감사 추적 등 보안 메커니즘이 시스템 전반에 일관되게 적용되어야 함을 의미한다.</li><li><strong>운영 원칙</strong>은 자동화된 테넌트 할당, 기능 제어, 배포 관리 등 지속적 운영과 변화 대응을 위한 핵심 전략을 포함한다.</li><li><strong>유연성과 효율성</strong>은 자원 공유 기반 운영 구조를 유지하면서도 각 테넌트의 맞춤 요구사항을 수용할 수 있는 아키텍처적 유연성을 의미한다.</li><li><strong>투명성/독립성</strong>은 하나의 시스템 내에서 다수의 고객이 존재하더라도 각자가 독립적인 서비스를 받고 있다고 느끼도록 만들어주는 원칙이다.</li></ul><h3 id=주요-원리-및-작동-원리>주요 원리 및 작동 원리<a hidden class=anchor aria-hidden=true href=#주요-원리-및-작동-원리>#</a></h3><h4 id=주요-원리><strong>주요 원리</strong><a hidden class=anchor aria-hidden=true href=#주요-원리>#</a></h4><table><thead><tr><th>원리</th><th>설명</th></tr></thead><tbody><tr><td><strong>Tenant Context 기반 요청 처리</strong></td><td>모든 요청에 포함된 테넌트 식별자 (헤더, 토큰, 도메인 등) 를 기반으로 테넌트 전용 로직/데이터로 라우팅</td></tr><tr><td><strong>데이터 격리</strong></td><td>동일 인프라에서 논리적/물리적으로 테넌트 데이터 분리 (Row filter, 스키마 분리, DB 분리 등)</td></tr><tr><td><strong>자원 공유 vs 독립성 균형</strong></td><td>애플리케이션/인프라는 공유하지만, 데이터와 정책은 테넌트 단위로 분리</td></tr><tr><td><strong>정책 기반 제어</strong></td><td>RBAC/ABAC 기반 인증과 정책 적용으로 테넌트 간 접근 격리</td></tr><tr><td><strong>운영 기능 분리 (Control vs Data)</strong></td><td>테넌트 온보딩/구성은 Control Plane 에서, 요청 처리/비즈니스 로직은 Data Plane 에서 수행</td></tr></tbody></table><pre class=mermaid>graph TD
    Req[Request]
    Req --&gt; ID[테넌트 식별자 추출]
    ID --&gt; CTX[테넌트 컨텍스트 생성]
    CTX --&gt; AUTH[인증 및 권한 확인]
    AUTH --&gt; FILTER[데이터 및 리소스 필터링]
    FILTER --&gt; ROUTE[비즈니스 로직 라우팅]
    ROUTE --&gt; RESP[테넌트 전용 응답 반환]
</pre><h4 id=작동-원리>작동 원리<a hidden class=anchor aria-hidden=true href=#작동-원리>#</a></h4><pre class=mermaid>graph TB
    A[User 요청]
    A --&gt; B[API Gateway]
    B --&gt; C[Tenant Context Resolver]
    C --&gt; D[&#34;Application (Shared Logic)&#34;]
    D --&gt; E{데이터 격리}
    E --&gt; F1[&#34;Shared DB (Row Filter)&#34;]
    E --&gt; F2[Schema per Tenant]
    E --&gt; F3[DB per Tenant]
    D --&gt; G[테넌트 정책/기능 적용]
</pre><h4 id=saas-설계-시-주요-원리-적용-시나리오>SaaS 설계 시 주요 원리 적용 시나리오<a hidden class=anchor aria-hidden=true href=#saas-설계-시-주요-원리-적용-시나리오>#</a></h4><table><thead><tr><th>시나리오</th><th>문제 상황</th><th>적용 원리</th><th>설계 전략</th><th>기술 적용 예시</th></tr></thead><tbody><tr><td><strong>1. 특정 테넌트의 트래픽 스파이크</strong></td><td>테넌트 A 의 사용량 급증으로 다른 테넌트에게 영향 발생</td><td>자원 격리 / QoS / 탄력적 확장</td><td>테넌트별 ResourceQuota 및 Auto-scaling 적용</td><td><code>K8s HPA</code>, <code>Namespace + LimitRange</code>, <code>KEDA</code>, <code>Istio Circuit Breaker</code></td></tr><tr><td><strong>2. 테넌트별 기능 차등 제공 (요금제 플랜별)</strong></td><td>Starter 테넌트는 일부 기능만 사용해야 함</td><td>정책 기반 기능 제어 / 커스터마이징</td><td>Feature Flag + 플랜 정보 기반 조건 분기</td><td><code>LaunchDarkly</code>, <code>Unleash</code>, <code>Flipper</code>, DB 기반 기능 플래그</td></tr><tr><td><strong>3. 테넌트 간 데이터 누출 위험 방지</strong></td><td>테넌트 B 가 테넌트 A 의 데이터에 접근 가능</td><td>데이터 격리 / 인증 - 인가 분리</td><td>테넌트 ID 기반 Row-level Security, SCOPED API 제한</td><td><code>PostgreSQL RLS</code>, <code>SQLAlchemy scoped session</code>, <code>OPA (Open Policy Agent)</code></td></tr><tr><td><strong>4. 신규 테넌트 빠른 온보딩</strong></td><td>수동 설정, DB 프로비저닝으로 온보딩 지연</td><td>온보딩 자동화 / Control Plane 중심 구조</td><td>IaC 기반 테넌트 생성, 자동 DB/스토리지 할당</td><td><code>Terraform</code>, <code>Helm</code>, <code>ArgoCD</code>, Custom SaaS Onboarding API</td></tr><tr><td><strong>5. 테넌트별 설정·테마 분리</strong></td><td>각각의 테넌트가 브랜드별 UI 와 로직 요구</td><td>설정 격리 / 커스터마이징 / 멀티컨피그 지원</td><td>테넌트별 설정 DB 또는 Config Server 연동</td><td><code>Spring Cloud Config</code>, <code>etcd</code>, <code>MongoDB 설정 컬렉션</code>, <code>Theme JSON</code></td></tr><tr><td><strong>6. 운영자 감사 추적 요구</strong></td><td>테넌트별로 어떤 사용자/관리자가 어떤 데이터를 수정했는지 추적 필요</td><td>감사 로깅 / 멀티컨텍스트 추적</td><td>테넌트 ID + 사용자 ID 기반 Trace/Log 저장</td><td><code>ELK Stack</code>, <code>OpenTelemetry</code>, <code>Jaeger</code>, <code>Datadog APM</code></td></tr><tr><td><strong>7. 테넌트별 SLA 충족 (성능 분리)</strong></td><td>고가 요금제 테넌트에게 일정 성능 보장</td><td>우선순위 QoS / 리소스 격리</td><td>QoS Policy + PriorityClass 적용</td><td><code>K8s PriorityClass</code>, <code>Istio RateLimit</code>, <code>Redis 분리 캐시 풀</code></td></tr><tr><td><strong>8. 특정 테넌트 기능 오픈/롤백 요청</strong></td><td>기능 테스트 후 일부 테넌트에서 롤백 필요</td><td>기능 토글 / Canary Release</td><td>테넌트 대상 Canary 적용 및 롤백 가능 설계</td><td><code>Feature Toggle</code>, <code>Flagger</code>, <code>Argo Rollouts</code></td></tr><tr><td><strong>9. 테넌트별 데이터 백업·복구</strong></td><td>테넌트별로 다른 시점으로 복구 원함</td><td>데이터 격리 / 백업 정책 분리</td><td>테넌트 ID 기반 스냅샷/백업 정책 운용</td><td><code>Velero</code>, <code>Percona</code>, <code>S3 버킷 분리</code>, <code>RDS snapshot</code></td></tr><tr><td><strong>10. 테넌트 삭제 시 자원/로그/데이터 정리</strong></td><td>사용 종료 테넌트의 설정, 로그가 계속 남음</td><td>라이프사이클 관리 / 자원 추적</td><td>온보딩처럼 오프보딩도 자동화 구성</td><td><code>Finalizer</code>, <code>K8s Operator</code>, <code>SaaS Lifecycle Controller</code></td></tr></tbody></table><h5 id=시나리오-핵심-요약-매핑>시나리오 핵심 요약 매핑<a hidden class=anchor aria-hidden=true href=#시나리오-핵심-요약-매핑>#</a></h5><table><thead><tr><th>적용 원리</th><th>대표 시나리오 예시</th></tr></thead><tbody><tr><td><strong>테넌트 컨텍스트 기반 처리</strong></td><td>기능 제한, 요청 분기, UI 맞춤화</td></tr><tr><td><strong>자원 격리 / 탄력 확장</strong></td><td>테넌트 스파이크 대응, SLA 보장</td></tr><tr><td><strong>정책 기반 기능 제어</strong></td><td>요금제별 기능 제한, 실험적 기능 배포</td></tr><tr><td><strong>데이터 격리 및 보안</strong></td><td>데이터 누출 방지, 백업/복구 분리</td></tr><tr><td><strong>온보딩/오프보딩 자동화</strong></td><td>신규 등록, 삭제/회수, 설정 정리</td></tr><tr><td><strong>운영 및 감사 로그 분리</strong></td><td>보안 추적, 규정 준수, 테넌트 기반 로깅</td></tr><tr><td><strong>멀티 레벨 설정 관리</strong></td><td>테넌트 + 사용자 + 역할에 따른 설정 분기</td></tr></tbody></table><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><p>멀티테넌시 아키텍처는 하나의 공유된 애플리케이션 인스턴스와 인프라를 여러 고객 (테넌트) 이 동시에 사용하면서도, 각 테넌트의 <strong>데이터, 설정, 인증, UI, 리소스</strong>가 완전히 분리되도록 구성된다.</p><p>핵심 구조는 <strong>애플리케이션 공유 + 데이터 격리 + 테넌트 컨텍스트 처리 + 운영 자동화</strong>를 기반으로 하며, 보안, 확장성, 유연성을 모두 보장해야 한다.</p><p>테넌트 식별은 미들웨어에서 시작되어 전체 요청 흐름에 유지되며, 데이터는 테넌트별로 스키마 혹은 DB 수준에서 분리되고, 자원 사용량은 Kubernetes 기반 쿼터 및 오토스케일링 등으로 통제된다.</p><p>고급 아키텍처에서는 테넌트별 커스터마이징, 과금, 백업, 다중 리전 대응까지 포함하여 설계된다.</p><pre class=mermaid>flowchart TD
    subgraph Client
        Browser[Web/Mobile/API Client]
    end

    subgraph Edge Layer
        Gateway[API Gateway]
        WAF[WAF / Rate Limiter]
    end

    subgraph Middleware Layer
        Middleware[Tenant Context Middleware]
    end

    subgraph App Layer
        App[Shared Application Service]
        Auth[Authentication &amp; Authorization]
        Config[Customization Engine]
        Monitor[Monitoring &amp; Logging]
        Billing[Billing / Usage Tracker]
    end

    subgraph Data Layer
        SharedDB[(Shared DB)]
        SchemaPerTenant[(Schema-per-Tenant)]
        DBPerTenant[(DB-per-Tenant)]
    end

    subgraph Infra Layer
        K8s[Kubernetes + Resource Quota]
        CI[CI/CD + Versioning]
        Backup[Backup &amp; Recovery]
        ShardCtrl[Shard Controller]
    end

    Browser --&gt; Gateway --&gt; WAF --&gt; Middleware
    Middleware --&gt; App
    Middleware --&gt; Auth
    App --&gt; SharedDB
    App --&gt; SchemaPerTenant
    App --&gt; DBPerTenant
    App --&gt; Config
    App --&gt; Monitor
    App --&gt; Billing
    App --&gt; K8s
    App --&gt; ShardCtrl
    App --&gt; CI
    App --&gt; Backup
</pre><h4 id=구성-요소>구성 요소<a hidden class=anchor aria-hidden=true href=#구성-요소>#</a></h4><table><thead><tr><th>구분</th><th>구성 요소</th><th>주요 기능</th><th>설명</th></tr></thead><tbody><tr><td>필수</td><td><strong>Tenant Manager</strong></td><td>등록, 설정, 메타데이터 관리</td><td>테넌트 라이프사이클 관리 자동화</td></tr><tr><td></td><td><strong>Tenant Middleware</strong></td><td>테넌트 ID 추출 및 전파</td><td>요청 흐름에 컨텍스트 삽입</td></tr><tr><td></td><td><strong>Authentication / Authorization</strong></td><td>인증, 인가, RBAC</td><td>테넌트별 사용자/권한 제어</td></tr><tr><td></td><td><strong>App Layer (공유)</strong></td><td>비즈니스 로직 실행</td><td>테넌트 인식 기반 처리</td></tr><tr><td></td><td><strong>Data Isolation Layer</strong></td><td>DB 격리 (Shared/Schema/DB)</td><td>데이터 보안 및 접근 경계 유지</td></tr><tr><td></td><td><strong>Resource Control Layer</strong></td><td>CPU, Memory, DB pool 제어</td><td>QoS, noisy neighbor 방지</td></tr><tr><td>선택</td><td><strong>Customization Engine</strong></td><td>UI, 기능, 정책 구성</td><td>테넌트별 맞춤형 사용자 경험 제공</td></tr><tr><td></td><td><strong>Monitoring & Logging</strong></td><td>로그 수집, 알람, SLA</td><td>테넌트 단위 운영 가시성 확보</td></tr><tr><td></td><td><strong>Billing / Usage Tracker</strong></td><td>사용량 기록 및 과금</td><td>과금 시스템 및 요금제 연동</td></tr><tr><td></td><td><strong>Backup & Recovery</strong></td><td>데이터 복구 및 보존</td><td>테넌트별 재해 복구 및 감사 대응</td></tr><tr><td></td><td><strong>Version Manager</strong></td><td>기능 토글, 롤백</td><td>기능 롤아웃 및 A/B 테스트 지원</td></tr><tr><td></td><td><strong>Shard Controller</strong></td><td>DB 분산 및 라우팅</td><td>대규모 테넌시 확장 대응</td></tr><tr><td></td><td><strong>Multi-region Replicator</strong></td><td>지리적 분산 저장</td><td>데이터 주권 (GDPR 등) 대응</td></tr></tbody></table><h4 id=구성-요소별-장애-대응-전략>구성 요소별 장애 대응 전략<a hidden class=anchor aria-hidden=true href=#구성-요소별-장애-대응-전략>#</a></h4><table><thead><tr><th>구성 요소</th><th>장애 시 영향</th><th>대응 전략</th><th>권장 기술/패턴</th></tr></thead><tbody><tr><td><strong>Tenant Middleware</strong></td><td>테넌트 식별 불가 → 전체 서비스 오류</td><td>기본 테넌트 fallback, 캐시된 테넌트 메타데이터 사용</td><td>Fallback, Circuit Breaker</td></tr><tr><td><strong>Authentication</strong></td><td>인증 실패 → 로그인 불가</td><td>OAuth2 Provider 이중화, 토큰 캐시 적용</td><td>OIDC, Redis Cache, HA Proxy</td></tr><tr><td><strong>Authorization (RBAC)</strong></td><td>권한 부여 실패 → 데이터 노출 또는 접근 거부</td><td>정책 기반 접근 차단, 로깅 + 알람, 비정상 접근 시도 차단</td><td>Policy Engine (OPA), Audit Logs</td></tr><tr><td><strong>App Layer (Shared)</strong></td><td>모든 테넌트에게 영향</td><td>Canary 배포, 테넌트 그룹 롤아웃, 장애 감지 후 롤백</td><td>Feature Toggle, Canary, Blue-Green</td></tr><tr><td><strong>Database Layer</strong></td><td>일부 테넌트 데이터 접근 불가 or 전체 DB 오류</td><td>분리된 스키마/DB 로 영향 최소화, RDS/CloudSQL 이중화</td><td>Read Replica, Failover</td></tr><tr><td><strong>Resource Control</strong></td><td>특정 테넌트 과도한 사용 → 전체 성능 저하</td><td>테넌트별 Rate Limiting, CPU/Memory Quota 설정</td><td>K8s ResourceQuota, Throttling</td></tr><tr><td><strong>Customization Engine</strong></td><td>UI 오류, 기능 설정 실패</td><td>기본 설정 fallback, 설정 저장소 이중화</td><td>Feature Flag Store (e.g., Unleash)</td></tr><tr><td><strong>Monitoring/Logging</strong></td><td>장애 탐지 실패 → 대응 지연</td><td>테넌트별 지표 분리, 실시간 알람, SLO/SLA 기반 대시보드 구성</td><td>Prometheus + Grafana + Alertmanager</td></tr><tr><td><strong>Billing/Usage Tracker</strong></td><td>과금 누락/과금 과다 → 신뢰 손상</td><td>이중 저장 (DB + Log), 비정상 사용량 감지 자동화</td><td>Event Queue, Usage Reconciliation</td></tr><tr><td><strong>Backup/Recovery</strong></td><td>데이터 유실</td><td>테넌트별 증분 백업, 주기적 복원 테스트, PITR 지원</td><td>S3/Blob, Velero, WAL-G</td></tr></tbody></table><ul><li><strong>장애 대응은 격리성 + 이중화 + 모니터링</strong>의 삼박자를 갖춰야 한다. 단일 장애가 전체 테넌트에 전파되지 않도록 <strong>벌크헤드 패턴</strong>, <strong>Circuit Breaker</strong>, <strong>테넌트 그룹화</strong>가 유용하게 작동한다.</li></ul><h3 id=구현-기법-및-방법>구현 기법 및 방법<a hidden class=anchor aria-hidden=true href=#구현-기법-및-방법>#</a></h3><table><thead><tr><th>구분</th><th>정의</th><th>구성 요소</th><th>원리</th><th>목적</th><th>사용 상황</th><th>특징</th></tr></thead><tbody><tr><td><strong>Shared DB / Schema</strong></td><td>단일 DB 와 테이블 공유, <code>tenant_id</code> 컬럼으로 구분</td><td><code>tenant_id</code>, 쿼리 필터</td><td>논리적 분리</td><td>비용 최소화</td><td>개인, 소규모 SaaS</td><td>구현 간단, 보안 낮음</td></tr><tr><td><strong>Shared DB / Separate Schema</strong></td><td>하나의 DB 에 테넌트별 스키마 생성</td><td>스키마별 테이블, ORM Hook</td><td>스키마 단위 논리 분리</td><td>유연한 격리</td><td>중형 고객, 커스터마이징 요구 시</td><td>성능 - 관리 균형</td></tr><tr><td><strong>Separate DB</strong></td><td>테넌트별 개별 DB 인스턴스</td><td>DB-per-tenant, 커넥션 라우터</td><td>물리적 분리</td><td>격리·보안 극대화</td><td>기업 고객, 규제 준수 필요</td><td>비용 높고, 복잡도 큼</td></tr><tr><td><strong>Hybrid</strong></td><td>위 3 가지 혼합 적용</td><td>테넌트 유형별 정책 기반 분류</td><td>정책적 유연성</td><td>비용·보안 균형</td><td>고객 등급 구분 필요 시</td><td>전략적 선택, 설계 복잡</td></tr><tr><td><strong>Tenant-aware 코드</strong></td><td>요청 컨텍스트 기반으로 DB 필터 적용</td><td>미들웨어, Service, ORM</td><td>분기/주입 기반</td><td>모든 계층에 테넌트 컨텍스트 전달</td><td>SaaS 공통</td><td>재사용성 높음</td></tr><tr><td><strong>자원 제어 설정</strong></td><td>테넌트 단위로 리소스 제한 설정</td><td>K8s Quota, DB Pool</td><td>할당 격리</td><td>성능 안정성 확보</td><td>멀티테넌시 확장 시</td><td>클라우드 친화적</td></tr><tr><td><strong>CI/CD 전략</strong></td><td>테넌트 영향 최소화한 배포 전략</td><td>Canary, BG, Migration Tool</td><td>무중단 배포</td><td>고가용성 + 안정성</td><td>SaaS 배포 자동화</td><td>코드 분기 요구</td></tr><tr><td><strong>보안 설정</strong></td><td>테넌트별 보안 경계 설정</td><td>TLS, RLS, RBAC</td><td>통신 + 저장소 보호</td><td>데이터 보호 + 감사</td><td>인증 민감 SaaS</td><td>규제 대응 용이</td></tr></tbody></table><h4 id=shared-schema-방식>Shared Schema 방식<a hidden class=anchor aria-hidden=true href=#shared-schema-방식>#</a></h4><p><strong>시스템 구성 예시</strong>:</p><pre class=mermaid>graph LR
    A[Application] --&gt; B[(Shared Database)]
    B --&gt; C[customers table]
    B --&gt; D[orders table]
    B --&gt; E[products table]
    
    C --&gt; C1[tenant_id + customer_data]
    D --&gt; D1[tenant_id + order_data]
    E --&gt; E1[tenant_id + product_data]
</pre><p><strong>코드 구현 예시</strong>: Python + SQLAlchemy 예시</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2>2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3>3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4>4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5>5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6>6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7>7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8>8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># tenant_context.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>contextvars</span> <span class=kn>import</span> <span class=n>ContextVar</span>
</span></span><span class=line><span class=cl><span class=n>tenant_id</span> <span class=o>=</span> <span class=n>ContextVar</span><span class=p>(</span><span class=s1>&#39;tenant_id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>set_tenant</span><span class=p>(</span><span class=n>tid</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant_id</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=n>tid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_tenant</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>tenant_id</span><span class=o>.</span><span class=n>get</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14>14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15>15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16>16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># models.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy</span> <span class=kn>import</span> <span class=n>Column</span><span class=p>,</span> <span class=n>Integer</span><span class=p>,</span> <span class=n>String</span><span class=p>,</span> <span class=n>ForeignKey</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy.ext.declarative</span> <span class=kn>import</span> <span class=n>declarative_base</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tenant_context</span> <span class=kn>import</span> <span class=n>get_tenant</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Base</span> <span class=o>=</span> <span class=n>declarative_base</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>(</span><span class=n>Base</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>__tablename__</span> <span class=o>=</span> <span class=s1>&#39;users&#39;</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>Integer</span><span class=p>,</span> <span class=n>primary_key</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant_id</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>String</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>email</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>String</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>String</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_tenant_query</span><span class=p>(</span><span class=n>session</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>session</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>User</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>User</span><span class=o>.</span><span class=n>tenant_id</span> <span class=o>==</span> <span class=n>get_tenant</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=separate-schema-방식>Separate Schema 방식<a hidden class=anchor aria-hidden=true href=#separate-schema-방식>#</a></h4><p><strong>시스템 구성 예시</strong>:</p><pre class=mermaid>graph TB
    A[Application] --&gt; B[(Database)]
    B --&gt; C[tenant1 schema]
    B --&gt; D[tenant2 schema]
    B --&gt; E[tenant3 schema]
    
    C --&gt; C1[customers]
    C --&gt; C2[orders]
    D --&gt; D1[customers]
    D --&gt; D2[orders]
</pre><p><strong>코드 구현 예시</strong>: Python + Django Router</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6>6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7>7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8>8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># routers.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TenantRouter</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>db_for_read</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>,</span> <span class=o>**</span><span class=n>hints</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>tenant_schema</span> <span class=o>=</span> <span class=n>get_current_tenant_schema</span><span class=p>()</span>  <span class=c1># 예: &#39;tenant_a&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>tenant_schema</span><span class=si>}</span><span class=s1>_db&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>db_for_write</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>,</span> <span class=o>**</span><span class=n>hints</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>tenant_schema</span> <span class=o>=</span> <span class=n>get_current_tenant_schema</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>tenant_schema</span><span class=si>}</span><span class=s1>_db&#39;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3>3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4>4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5>5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># settings.py</span>
</span></span><span class=line><span class=cl><span class=n>DATABASES</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;tenant_a_db&#39;</span><span class=p>:</span> <span class=p>{</span><span class=err>…</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;tenant_b_db&#39;</span><span class=p>:</span> <span class=p>{</span><span class=err>…</span><span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>DATABASE_ROUTERS</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;routers.TenantRouter&#39;</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=separate-db-방식>Separate DB 방식<a hidden class=anchor aria-hidden=true href=#separate-db-방식>#</a></h4><p><strong>시스템 구성 예시</strong>:</p><pre class=mermaid>graph TB
    A[Application] --&gt; B[Connection Router]
    B --&gt; C[(Tenant A DB)]
    B --&gt; D[(Tenant B DB)]
    B --&gt; E[(Tenant C DB)]
    
    C --&gt; C1[Schema A]
    D --&gt; D1[Schema B]
    E --&gt; E1[Schema C]
</pre><p><strong>코드 구현 예시</strong>: JavaScript + Node.js</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// dbManager.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>connections</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Map</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>getTenantDb</span><span class=p>(</span><span class=nx>tenantId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>connections</span><span class=p>.</span><span class=nx>has</span><span class=p>(</span><span class=nx>tenantId</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>connections</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=nx>tenantId</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=nx>Sequelize</span><span class=p>(</span><span class=sb>`tenant_</span><span class=si>${</span><span class=nx>tenantId</span><span class=si>}</span><span class=sb>_db`</span><span class=p>,</span> <span class=s1>&#39;user&#39;</span><span class=p>,</span> <span class=s1>&#39;pass&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>dialect</span><span class=o>:</span> <span class=s1>&#39;postgres&#39;</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>connections</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>tenantId</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>getTenantDb</span> <span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1>1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2>2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3>3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// usage
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=p>{</span> <span class=nx>getTenantDb</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;./dbManager&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>db</span> <span class=o>=</span> <span class=nx>getTenantDb</span><span class=p>(</span><span class=s1>&#39;tenant_123&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>users</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>db</span><span class=p>.</span><span class=nx>models</span><span class=p>.</span><span class=nx>User</span><span class=p>.</span><span class=nx>findAll</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=k8s-기반-자원-제어>K8s 기반 자원 제어<a hidden class=anchor aria-hidden=true href=#k8s-기반-자원-제어>#</a></h4><p><strong>코드 구현 예시</strong>: Namespace + Limit</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1> 1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2> 2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3> 3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4> 4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5> 5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6> 6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7> 7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8> 8</a>
</span><span class=lnt id=hl-13-9><a class=lnlinks href=#hl-13-9> 9</a>
</span><span class=lnt id=hl-13-10><a class=lnlinks href=#hl-13-10>10</a>
</span><span class=lnt id=hl-13-11><a class=lnlinks href=#hl-13-11>11</a>
</span><span class=lnt id=hl-13-12><a class=lnlinks href=#hl-13-12>12</a>
</span><span class=lnt id=hl-13-13><a class=lnlinks href=#hl-13-13>13</a>
</span><span class=lnt id=hl-13-14><a class=lnlinks href=#hl-13-14>14</a>
</span><span class=lnt id=hl-13-15><a class=lnlinks href=#hl-13-15>15</a>
</span><span class=lnt id=hl-13-16><a class=lnlinks href=#hl-13-16>16</a>
</span><span class=lnt id=hl-13-17><a class=lnlinks href=#hl-13-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Namespace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>tenant-a</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ResourceQuota</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>tenant-a-quota</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>tenant-a</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hard</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>requests.cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>requests.memory</span><span class=p>:</span><span class=w> </span><span class=l>1Gi</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>limits.cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>limits.memory</span><span class=p>:</span><span class=w> </span><span class=l>2Gi</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=shared-vs-separate-모델-선택-기준>Shared vs. Separate 모델 선택 기준<a hidden class=anchor aria-hidden=true href=#shared-vs-separate-모델-선택-기준>#</a></h3><p>주요 모델은 <code>Shared Schema</code>, <code>Separate Schema</code>, <code>Separate Database</code> 로 분류되고, 필요에 따라 <strong>Hybrid 모델</strong>도 구성 가능하다.</p><table><thead><tr><th>기준 항목</th><th>Shared Schema (Row 기반)</th><th>Separate Schema (스키마 기반)</th><th>Separate DB (DB 완전 분리)</th></tr></thead><tbody><tr><td><strong>격리 수준</strong></td><td>낮음</td><td>중간</td><td>높음</td></tr><tr><td><strong>보안/규제 준수</strong></td><td>제한적 (RLS 필요)</td><td>일부 적용 가능</td><td>GDPR, HIPAA 등 고강도 대응 가능</td></tr><tr><td><strong>스키마 유연성</strong></td><td>동일한 스키마 사용 필요</td><td>테넌트별 구조 가능</td><td>완전히 자유롭게 설계 가능</td></tr><tr><td><strong>운영 복잡도</strong></td><td>낮음</td><td>중간</td><td>높음</td></tr><tr><td><strong>마이그레이션 유연성</strong></td><td>낮음</td><td>높음</td><td>매우 높음</td></tr><tr><td><strong>리소스 분리</strong></td><td>공유됨</td><td>일부 분리</td><td>완전 분리</td></tr><tr><td><strong>스케일링 전략</strong></td><td>수평 확장 어려움</td><td>스키마 수준 샤딩 가능</td><td>독립적으로 수평/수직 확장 가능</td></tr><tr><td><strong>비용</strong></td><td>저비용</td><td>중간</td><td>고비용</td></tr><tr><td><strong>테넌트 수 증가 대응력</strong></td><td>수천~수만 테넌트 적합</td><td>수백~천 단위 테넌트 적합</td><td>수~수십 개 대형 고객에 적합</td></tr><tr><td><strong>운영 예시</strong></td><td>SaaS 스타트업, B2C</td><td>SaaS 중견 서비스, B2B</td><td>엔터프라이즈 고객, 금융/공공기관</td></tr></tbody></table><ul><li><strong>모델 선택은 격리 수준 vs 비용/운영 간 Trade-off</strong>가 핵심이다. 민감한 고객이 많다면 <code>Separate DB</code> 또는 <code>Schema</code> 기반이 적합하다.</li></ul><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>운영 효율성</strong></td><td>유지보수 간소화</td><td>단일 코드베이스, 인스턴스로 일괄 관리 가능</td></tr><tr><td></td><td>운영 자동화</td><td>테넌트 등록, 설정, 리소스 할당 등 반복 작업 자동화</td></tr><tr><td></td><td>중앙 집중 관리</td><td>패치, 정책, 설정 등을 전체 테넌트에 동시 적용</td></tr><tr><td><strong>비용 절감</strong></td><td>비용 효율성</td><td>인프라, 운영, 라이선스 비용의 테넌트 간 공유</td></tr><tr><td></td><td>자원 활용 최적화</td><td>유휴 자원 없이 전체 시스템 활용률 상승</td></tr><tr><td><strong>확장성과 민첩성</strong></td><td>수평 확장성</td><td>신규 테넌트 추가 시 즉시 온보딩 가능</td></tr><tr><td></td><td>빠른 배포</td><td>전체 또는 일부 테넌트에 기능 빠르게 배포</td></tr><tr><td></td><td>비즈니스 민첩성</td><td>빠른 시장 대응과 고객 확대에 유리</td></tr><tr><td><strong>서비스 품질/일관성</strong></td><td>일관된 기능 배포</td><td>모든 테넌트에 동일한 업데이트 제공 가능</td></tr><tr><td></td><td>표준화된 서비스 품질</td><td>동일 코드 기반으로 안정성 유지 가능</td></tr><tr><td><strong>분석 및 가시성 향상</strong></td><td>통합 모니터링 및 분석</td><td>테넌트별 로그, 사용량, 과금 등 한눈에 파악 가능</td></tr><tr><td></td><td>데이터 기반 개선</td><td>벤치마크 기반 기능 개선 및 최적화 가능</td></tr><tr><td><strong>사용자 맞춤화 유연성</strong></td><td>기능 토글 및 커스터마이징</td><td>테넌트별 설정/UI/정책 등 유연하게 조정 가능</td></tr></tbody></table><ul><li><strong>운영 효율성</strong>은 멀티테넌시의 가장 큰 강점 중 하나로, 단일 인스턴스로 모든 테넌트를 관리하면서도 패치, 배포, 모니터링을 중앙에서 일괄적으로 처리할 수 있어 유지보수 비용이 현저히 감소한다.</li><li><strong>비용 절감</strong>은 자원을 다수의 테넌트가 공유함으로써 발생하는 경제적 이점으로, 초기 투자와 운영비 부담이 크게 완화된다.</li><li><strong>확장성과 민첩성</strong>은 새로운 고객을 빠르게 온보딩하거나 시장 변화에 민감하게 대응할 수 있게 해주며, SaaS 의 핵심 경쟁력이 된다.</li><li><strong>서비스 품질/일관성</strong>은 모든 테넌트가 동일한 소프트웨어 구조를 사용하기 때문에 기능 배포와 정책 적용의 일관성을 유지할 수 있다.</li><li><strong>분석 및 가시성 향상</strong>은 테넌트 단위의 데이터 수집 및 분석이 가능해 운영 통계, 과금, SLA 관리까지 통합적으로 관리할 수 있게 해준다.</li><li><strong>사용자 맞춤화 유연성</strong>은 테넌트마다 요구되는 UI, 기능, 정책을 설정 기반으로 손쉽게 제어할 수 있어 대규모 사용자 요구사항을 유연하게 수용할 수 있다.</li></ul><h3 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th><th>해결방안</th></tr></thead><tbody><tr><td>보안</td><td>테넌트 간 데이터 유출</td><td>공유 구조에서 잘못된 권한 설정으로 정보 노출</td><td>RLS, RBAC, 암호화, 정기 감사, 접근 로그 추적</td></tr><tr><td>성능</td><td>noisy neighbor</td><td>과도한 리소스 사용으로 다른 테넌트 성능 저하</td><td>ResourceQuota, Rate Limiting, HPA, 분리 캐시</td></tr><tr><td>유연성</td><td>커스터마이징 제약</td><td>공통 인프라에서 테넌트별 요구 반영 어려움</td><td>플러그인 아키텍처, 기능 토글, 테마 설정</td></tr><tr><td>안정성</td><td>SPOF, 장애 전파</td><td>공용 인프라 실패로 전체 다운 가능</td><td>Multi-AZ, Circuit Breaker, 분산/복제 아키텍처</td></tr><tr><td>복잡성</td><td>테넌시 운영 난이도 증가</td><td>테넌트 온보딩, 설정, 배포, 마이그레이션 등 복잡</td><td>IaC 도입, 자동화 스크립트, 테넌트 라이프사이클 관리 도구</td></tr></tbody></table><p>멀티테넌시 구조는 공유 인프라 기반으로 운영 효율성과 비용을 절감하지만, <strong>보안, 성능 간섭, 맞춤화 제약, 장애 전파 위험, 운영 복잡성</strong>이라는 핵심적인 단점을 내포한다. 이러한 단점은 다층 보안, 격리 기술, 자동화 도구, 기능 확장 아키텍처 등을 통해 완화할 수 있다.</p><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th>카테고리</th><th>항목</th><th>원인</th><th>영향</th><th>해결방안</th></tr></thead><tbody><tr><td>데이터</td><td>데이터 유출</td><td>필터링 누락, 권한 설정 오류</td><td>법적 리스크, 고객 신뢰 하락</td><td>Row Filter, 권한 매핑, 자동 보안 테스트</td></tr><tr><td>성능</td><td>성능 병목/저하</td><td>자원 공유, 부하 분산 실패</td><td>응답 지연, SLA 미충족</td><td>샤딩, 캐싱, 쿼터, 분리 DB 또는 서버</td></tr><tr><td>배포</td><td>롤백 곤란</td><td>전체 코드 기반, 잘못된 config 반영</td><td>전체 테넌트 장애 가능성</td><td>Canary, BG 배포, 자동화 테스트, 롤백 스크립트</td></tr><tr><td>식별/설정</td><td>테넌트 라우팅 오류</td><td>미들웨어, 컨텍스트 관리 실패</td><td>데이터 잘못 접근, 보안 위협</td><td>요청 기반 라우팅 강화, fallback, 트래픽 트레이싱</td></tr><tr><td>규정</td><td>지역 규정 위반</td><td>위치 기반 정책 미흡, 데이터 이동 문제</td><td>벌금, 서비스 중단 위험</td><td>리전 분리, 정책 기반 라우팅, DSR 도구 적용</td></tr></tbody></table><p>멀티테넌시 시스템의 문제점은 주로 <strong>데이터 유출, 성능 병목, 배포 리스크, 설정 충돌, 규정 위반</strong>으로 나타난다. 이를 해결하려면 Row-level 보안, 자원 분리, 점진적 배포 전략, 설정 검증 프로세스, 리전 기반 설계 등의 전략적 기술적 조치가 필요하다.</p><h4 id=대응-전략별-기술-매핑>대응 전략별 기술 매핑<a hidden class=anchor aria-hidden=true href=#대응-전략별-기술-매핑>#</a></h4><table><thead><tr><th>대응 전략</th><th>해결 대상 문제</th><th>적용 기술 및 기법</th><th>비고</th></tr></thead><tbody><tr><td><strong>1. 데이터 격리 강화</strong></td><td>데이터 유출, 접근 오류</td><td>Row-Level Security (PostgreSQL), Schema per tenant, DB-per-tenant, OPA (Open Policy Agent)</td><td>RLS + 정책 기반 통제</td></tr><tr><td><strong>2. 성능 격리 및 보호</strong></td><td>noisy neighbor, 리소스 간섭</td><td>Kubernetes ResourceQuota, LimitRange, HPA, KEDA, Istio Rate Limiting</td><td>QOS 중심 테넌시 분리</td></tr><tr><td><strong>3. 기능 커스터마이징</strong></td><td>커스터마이징 제약</td><td>Feature Flag (<code>LaunchDarkly</code>, <code>Unleash</code>), 플러그인 아키텍처, 테마 엔진</td><td>설정 기반 런타임 분기</td></tr><tr><td><strong>4. 장애 확산 방지</strong></td><td>SPOF, 장애 전파</td><td>Circuit Breaker (<code>Istio</code>, <code>Hystrix</code>), Multi-Zone, Multi-Region, Service Mesh Retry</td><td>격리 + 자동 복구</td></tr><tr><td><strong>5. 보안 및 감사 강화</strong></td><td>인증 실패, 감사 불가</td><td>RBAC/ABAC, JWT, OAuth2.0, TLS, OpenTelemetry, Audit Trail, Vault</td><td>신뢰도 향상 핵심</td></tr><tr><td><strong>6. 테넌트 온보딩 자동화</strong></td><td>복잡한 운영, 신규 등록 지연</td><td>Terraform, Helm, ArgoCD, Custom Onboarding API, GitOps</td><td>IaC 중심 운영 자동화</td></tr><tr><td><strong>7. 테넌트 식별 및 컨텍스트 관리</strong></td><td>라우팅 오류, 잘못된 설정 분기</td><td>Middleware (FastAPI/Express), Domain 기반 라우팅, Header 기반 분기, Context Injection</td><td>모든 계층에서 필수</td></tr><tr><td><strong>8. 점진적 배포 전략</strong></td><td>전체 장애 리스크, 롤백 불가</td><td>Canary Deployment, Blue-Green Deployment, Flagger, Argo Rollouts</td><td>CI/CD 핵심 기술</td></tr><tr><td><strong>9. 리소스 동적 확장</strong></td><td>성능 저하, 과부하</td><td>Horizontal Pod Autoscaler, KEDA, Serverless (Knative, AWS Lambda)</td><td>비동기 서비스 최적</td></tr><tr><td><strong>10. 지역/규정 분리 운영</strong></td><td>데이터 거버넌스/법적 규제</td><td>Multi-Region Routing, Regional Policy Enforcement, Compliance Engine (e.g., DSR, GDPR Toolkit)</td><td>SaaS 글로벌 대응 필수</td></tr><tr><td><strong>11. 설정 및 구성 충돌 방지</strong></td><td>테넌트 설정 오류, 변경 충돌</td><td>ConfigMap per tenant, Helm value override, Feature Freeze Pipeline, Change Management Policy</td><td>운영 정합성 확보</td></tr></tbody></table><ul><li><strong>보안/데이터 격리</strong>는 <strong>Row-Level Security, OPA, 암호화, RBAC</strong> 등과 같은 정책 기반 제어로 실현해야 함.</li><li><strong>성능 문제</strong>는 <strong>Kubernetes 자원 제어, Autoscaling, Rate Limiting</strong> 등으로 격리 또는 탄력적으로 대응.</li><li><strong>장애 전파 방지</strong>에는 <strong>Circuit Breaker, Retry, 분산 배치</strong> 등 고가용성 설계가 필수.</li><li><strong>운영 자동화</strong>와 <strong>테넌트 온보딩</strong>은 <strong>IaC + CI/CD</strong> 체계를 결합해 반복 가능하게 구성.</li><li><strong>설정 충돌</strong>이나 <strong>배포 위험</strong>은 <strong>Feature Flag, Canary, Helm override</strong> 등의 <strong>안전한 변경 경로 확보</strong>가 중요.</li><li><strong>글로벌 SaaS</strong>에서는 <strong>리전별 컴플라이언스 분기 처리</strong>를 전략적으로 포함해야 한다.</li></ul><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><table><thead><tr><th>도전 과제</th><th>원인 요약</th><th>영향</th><th>해결 방안 요약</th></tr></thead><tbody><tr><td>데이터 보안 및 규정 준수</td><td>테넌트 격리 미비, 다양한 컴플라이언스 요구사항</td><td>데이터 유출, 규제 위반, 브랜드 신뢰 하락</td><td>암호화, RLS, 정책 제어, 자동 감사 로그</td></tr><tr><td>성능 및 자원 격리</td><td>리소스 경쟁, burst traffic, 성능 격리 미흡</td><td>SLA 위반, 응답 지연</td><td>Rate Limiting, 쿼터, Auto-scaling</td></tr><tr><td>운영 복잡성 및 자동화</td><td>테넌트 수 증가, 버전 분기, 설정 다양화</td><td>배포 장애, 설정 오류, 유지보수 부담 증가</td><td>IaC, GitOps, Helm, 온보딩 자동화</td></tr><tr><td>맞춤화 및 확장성</td><td>요구사항 다양성, 공통 코드의 경직성</td><td>기능 충돌, 유지보수 복잡화</td><td>Feature Toggle, Plugin 구조</td></tr><tr><td>관측성 및 문제 진단</td><td>로그·모니터링 공유로 인한 추적 어려움</td><td>장애 원인 파악 지연, SLA 위반</td><td>APM, 테넌트별 태깅, 모니터링 자동화</td></tr><tr><td>확장성 및 구조 유연성</td><td>스키마 공유 → 독립 구조 전환 시 다운타임 발생</td><td>운영 리스크 증가, 비용 급증</td><td>하이브리드 전략, 리팩토링 도구 사용</td></tr><tr><td>신기술 및 특수 워크로드 대응</td><td>AI, GPU, 엣지 등 비정형 테넌트 증가</td><td>기존 성능 저하, 관리 복잡화</td><td>GPU 격리, 하이브리드 클라우드, regional failover</td></tr></tbody></table><ul><li><p><strong>데이터 보안 및 규정 준수</strong><br>각 테넌트의 데이터가 철저히 분리되고 보안 및 규정 준수를 자동화해야 하는 구조가 필수적이다. 암호화, 접근 제어, 감사 추적은 필수 요소다.</p></li><li><p><strong>성능 및 자원 격리</strong><br>여러 테넌트가 공존할 경우 하나의 테넌트가 시스템 전체에 영향을 미치지 않도록 자원 격리가 선행돼야 한다. Auto-scaling 과 Rate-limiting 은 기본 설계 요소다.</p></li><li><p><strong>운영 복잡성 및 자동화</strong><br>수십, 수백 테넌트를 운영할 때는 수작업 배포나 설정은 치명적이다. IaC, 온보딩 자동화, GitOps 기반 배포 구조가 권장된다.</p></li><li><p><strong>맞춤화 및 확장성</strong><br>테넌트마다 요구가 다를 경우, 플러그인 및 Feature Flag 등 유연한 아키텍처 확장이 중요하다.</p></li><li><p><strong>관측성 및 문제 진단</strong><br>장애 발생 시, 테넌트별로 빠르게 원인을 진단할 수 있어야 하며, 이를 위해 로그와 메트릭은 테넌트 단위로 수집되고 분석돼야 한다.</p></li><li><p><strong>확장성 및 구조 유연성</strong><br>스키마 분리나 인프라 격리로 전환이 필요한 시점이 반드시 오므로, 구조 전환의 유연성과 자동 마이그레이션 도구 준비가 필수다.</p></li><li><p><strong>신기술 및 특수 워크로드 대응</strong><br>GPU, AI, 엣지 등 특수 요구 테넌트는 기존 아키텍처로는 대응이 어려우므로 별도의 격리 및 리전 전략이 요구된다.</p></li></ul><h3 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th>분류 기준</th><th>유형</th><th>설명</th><th>대표 적용 예시</th></tr></thead><tbody><tr><td><strong>데이터 격리 방식</strong></td><td>Shared Schema</td><td>하나의 DB/스키마/테이블을 공유하며, <code>tenant_id</code> 로 구분</td><td>초기형 SaaS, 저비용 플랫폼</td></tr><tr><td></td><td>Separate Schema</td><td>같은 DB 내 테넌트별 스키마 분리</td><td>중소규모 SaaS (B2B)</td></tr><tr><td></td><td>Separate Database</td><td>테넌트마다 독립된 DB 인스턴스를 사용</td><td>고보안 서비스, 금융/의료 등</td></tr><tr><td></td><td>Hybrid</td><td>테이블 일부 공유, 일부는 전용 DB/스키마</td><td>플랜 차등 SaaS, 고급 MSA 구조</td></tr><tr><td><strong>애플리케이션 배포 모델</strong></td><td>Single Instance</td><td>하나의 애플리케이션 인스턴스가 모든 테넌트를 처리</td><td>Slack, Trello</td></tr><tr><td></td><td>Instance per Tenant</td><td>테넌트마다 독립된 앱 인스턴스 운영</td><td>고가치 고객 대상 서비스</td></tr><tr><td></td><td>Hybrid Deployment</td><td>앱 일부는 공유, 일부는 전용 구성</td><td>마이크로서비스 기반 SaaS</td></tr><tr><td><strong>서비스 환경</strong></td><td>Single-Tenant</td><td>단일 고객만을 위한 환경 구성</td><td>내부 시스템, 전용 SaaS 계약</td></tr><tr><td></td><td>Multi-Tenant</td><td>하나의 시스템에서 여러 고객 서비스</td><td>대부분의 SaaS (e.g. Salesforce)</td></tr><tr><td><strong>자원 격리 수준</strong></td><td>완전 공유</td><td>DB, App, 리소스 모두 공유</td><td>MVP, 실험 서비스</td></tr><tr><td></td><td>부분 공유</td><td>DB 는 공유하되, App 또는 리소스는 일부 분리</td><td>중간 단계 SaaS</td></tr><tr><td></td><td>전용 자원</td><td>DB, App, Network 모두 테넌트 전용</td><td>규제 산업, 프라이빗 SaaS</td></tr><tr><td><strong>커스터마이징 수준</strong></td><td>Low Customization</td><td>설정 파일, 테마 수준의 제한적 설정</td><td>저가 요금제, 프리티어 서비스</td></tr><tr><td></td><td>Full Customization</td><td>기능, 로직, UI 전반에 대해 테넌트 단위 커스터마이징 가능</td><td>엔터프라이즈 요금제</td></tr><tr><td><strong>운영 강도</strong></td><td>Soft Multi-Tenancy</td><td>애플리케이션 수준에서 논리적으로만 분리</td><td>컨텍스트 분기 구조 기반 SaaS</td></tr><tr><td></td><td>Hard Multi-Tenancy</td><td>데이터/네트워크/애플리케이션까지 실제 인프라 수준에서 격리</td><td>국가별 거버넌스 준수, 고객 맞춤형 고도화 SaaS</td></tr></tbody></table><ul><li><p><strong>데이터 격리 방식</strong>:<br>멀티테넌시의 핵심인 데이터 분리는 비용 - 보안 - 운영 효율성 간의 균형을 결정하는 요소다. <code>Shared Schema</code> 는 가장 효율적이지만 보안에 취약하며, <code>Separate Database</code> 는 가장 안전하지만 비용이 크다. <code>Hybrid</code> 는 유연한 구조를 지향하는 전략적 방식이다.</p></li><li><p><strong>애플리케이션 배포 모델</strong>:<br>모든 테넌트를 하나의 인스턴스에서 처리하는 방식은 효율적이지만, 장애 격리나 커스터마이징에 한계가 있다. 반면 <code>Instance per Tenant</code> 는 유연성은 높지만 리소스 소비가 크다.</p></li><li><p><strong>서비스 환경</strong>:<br><code>Single-Tenant</code> 는 독립적인 고객을 위한 환경으로 보안 및 맞춤화에 강하고, <code>Multi-Tenant</code> 는 운영 효율성과 빠른 스케일링에 적합하다.</p></li><li><p><strong>자원 공유 수준</strong>:<br>완전 공유는 비용 절감에 유리하나, 성능 간섭과 보안 리스크를 내포하며, 전용 자원은 고객별 SLA 와 규정 준수 요구사항을 만족시킨다.</p></li><li><p><strong>커스터마이징 수준</strong>:<br>요금제 또는 고객 세그먼트에 따라 테넌트별 설정 정도를 나누며, 고가 고객에게는 <code>Full Customization</code> 이 요구되는 경우가 많다.</p></li><li><p><strong>운영 강도 (Soft vs Hard)</strong>:<br>Soft 는 논리적 테넌시 분리로 성능은 좋지만 보안 취약성이 존재하고, Hard 는 인프라 단위의 격리로 가장 강력한 보안을 제공한다. 서비스 특성에 맞게 선택해야 한다.</p></li></ul><h4 id=멀티테넌시-vs-싱글테넌시-비교>멀티테넌시 vs. 싱글테넌시 비교<a hidden class=anchor aria-hidden=true href=#멀티테넌시-vs-싱글테넌시-비교>#</a></h4><table><thead><tr><th>항목</th><th>Multi-Tenancy (멀티테넌시)</th><th>Single-Tenancy (싱글테넌시)</th></tr></thead><tbody><tr><td>인프라 구조</td><td>하나의 인스턴스가 여러 테넌트 공유</td><td>각 테넌트별로 별도 인프라 제공</td></tr><tr><td>운영/관리 비용</td><td>낮음 (자원 공유)</td><td>높음 (개별 유지보수)</td></tr><tr><td>보안 격리</td><td>논리적 격리 → 추가 보안 설정 필요</td><td>물리적/완전한 격리</td></tr><tr><td>맞춤화 (Customization)</td><td>제한적, 기능 토글/설정 위주</td><td>완전 맞춤화 가능</td></tr><tr><td>확장성</td><td>높음, 테넌트 추가 용이</td><td>낮음, 신규 테넌트마다 자원 추가 필요</td></tr><tr><td>장애 전파 위험</td><td>하나의 문제로 전체 영향 가능</td><td>특정 테넌트에만 영향</td></tr><tr><td>배포/업데이트</td><td>전체 테넌트에 일괄 적용 가능</td><td>개별 배포 필요</td></tr><tr><td>컴플라이언스 대응</td><td>보안 및 감사 로그 등 추가 조치 필요</td><td>쉽게 독립 대응 가능</td></tr></tbody></table><p><strong>참고</strong>: 금융, 보건 분야처럼 보안 규제 요구가 높다면 싱글테넌시 고려, 일반 SaaS 서비스는 멀티테넌시가 유리하다.</p><h3 id=테넌트-관리-플랫폼-구축>테넌트 관리 플랫폼 구축<a hidden class=anchor aria-hidden=true href=#테넌트-관리-플랫폼-구축>#</a></h3><ul><li><strong>필요성</strong>: 테넌트 수가 증가하면 수동 관리가 한계에 도달</li><li><strong>기능 예시</strong>:<ul><li>테넌트 생성/수정/삭제 API</li><li>리소스 사용량 대시보드</li><li>테넌트 상태 모니터링, 알림 설정</li></ul></li><li><strong>적용 기술</strong>: Admin UI, Backoffice Portal, Self-service Onboarding</li></ul><h3 id=테넌트-id-전달-방식>테넌트 ID 전달 방식<a hidden class=anchor aria-hidden=true href=#테넌트-id-전달-방식>#</a></h3><table><thead><tr><th>방식</th><th>설명</th></tr></thead><tbody><tr><td>Header 기반</td><td>Authorization, X-Tenant-ID 등 사용자 요청 헤더 이용</td></tr><tr><td>Subdomain 기반</td><td><code>tenant-name.app.com</code> 형태로 DNS 라우팅으로 테넌트 식별</td></tr><tr><td>URL Path 기반</td><td><code>/tenant-a/api/…</code> 형태로 Path Variable 처리</td></tr><tr><td>Token 기반</td><td>JWT 등 인증 토큰에 포함된 tenant_id 추출</td></tr></tbody></table><ul><li><strong>실무 권장</strong>: 내부 시스템용은 Header 기반, 퍼블릭 SaaS 는 Subdomain 기반이 가장 많이 사용됨</li></ul><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>카테고리</th><th>고려사항</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>아키텍처 및 설계</td><td>테넌트 식별 전략</td><td>URL, Header, JWT 등으로 테넌트 구분</td><td>서브도메인 + JWT 기반 식별 추천</td></tr><tr><td></td><td>데이터 격리 수준</td><td>Row/Schema/DB 분리 방식 선택</td><td>민감도·규모에 따라 하이브리드 모델 채택</td></tr><tr><td>보안 및 데이터 격리</td><td>접근 제어</td><td>테넌트별 인증/인가 분리</td><td>OAuth2, SSO, RBAC 활용</td></tr><tr><td></td><td>데이터 보호 및 암호화</td><td>테넌트 간 데이터 유출 방지</td><td>TLS, Key Vault, 암호화 정책</td></tr><tr><td>테넌트 관리</td><td>온보딩 자동화</td><td>신규 테넌트 생성 및 초기 설정 자동화</td><td>IaC, API 기반 프로비저닝</td></tr><tr><td></td><td>오프보딩 전략</td><td>테넌트 삭제 시 데이터 및 리소스 정리</td><td>백업 후 삭제, Soft Deletion 고려</td></tr><tr><td>자동화 및 운영</td><td>배포 자동화</td><td>테넌트별 Helm/Terraform 구성 가능</td><td>GitOps 및 IaC 표준화</td></tr><tr><td></td><td>리소스 관리</td><td>Namespace/Quota 기반 리소스 격리</td><td>Kubernetes ResourceQuota 적용</td></tr><tr><td>성능 및 자원 격리</td><td>QoS 분리</td><td>특정 테넌트 스파이크 대응</td><td>HPA, Rate Limiting, Circuit Breaker</td></tr><tr><td></td><td>캐싱 전략</td><td>테넌트별 캐시 격리 필요</td><td>Key Prefix 기반 분리 캐싱</td></tr><tr><td>모니터링 및 감사</td><td>로그/지표 분리</td><td>테넌트 단위 로깅/메트릭 수집</td><td>Loki + Prometheus + Labels 활용</td></tr><tr><td></td><td>접근 감사</td><td>보안/컴플라이언스 대응</td><td>접근 기록 추적, 규정 기반 알림</td></tr><tr><td>사용자 경험</td><td>커스터마이징</td><td>UI/기능/정책 차별화</td><td>Feature Flag, 테마 분기 처리</td></tr><tr><td>테스트 및 에러처리</td><td>크로스 테넌시 검증</td><td>격리 위반 탐지 테스트</td><td>자동화된 통합 테스트 필요</td></tr><tr><td></td><td>장애 격리</td><td>하나의 장애가 타 테넌트로 확산 방지</td><td>Bulkhead, Circuit Breaker</td></tr><tr><td>과금 및 요금제</td><td>사용량 추적</td><td>기능, 리소스 사용량 측정</td><td>테넌트 ID 기반 메트릭 연계</td></tr><tr><td></td><td>플랜 기반 기능 제한</td><td>요금제에 따라 기능 차등 제공</td><td>Plan-Tier Flag + 미들웨어 필터링</td></tr></tbody></table><ul><li><p><strong>아키텍처 및 설계</strong>: 테넌트 식별/데이터 분리를 구조적으로 명확히 해야 전체 시스템 일관성과 보안을 확보할 수 있다.</p></li><li><p><strong>보안 및 격리</strong>: 인증과 데이터 보호는 다층적 구조로 구성하고, 테넌트 스코프의 강제 검증이 필수다.</p></li><li><p><strong>테넌트 관리</strong>: 자동화된 온보딩과 신뢰성 있는 오프보딩 체계는 운영 복잡성을 줄여준다.</p></li><li><p><strong>자동화 운영</strong>: IaC 기반 Helm/Terraform 스크립트는 일관된 배포와 복구에 필수다.</p></li><li><p><strong>성능 격리</strong>: 테넌트 간 자원 간섭을 막기 위한 Rate Limit, 캐시 분리 등은 필수 성능 보장 메커니즘이다.</p></li><li><p><strong>모니터링</strong>: 테넌트별 지표, 로그, 알림을 별도로 수집하고 분석해야 SLA 준수를 보장할 수 있다.</p></li><li><p><strong>사용자 경험</strong>: 커스터마이징은 기능 플래그나 메타데이터로 분기해야 유지보수가 용이하다.</p></li><li><p><strong>테스트 및 에러 처리</strong>: 장애 확산을 막고 테넌트 경계 테스트를 자동화하는 구조를 갖추는 것이 중요하다.</p></li><li><p><strong>과금 전략</strong>: 사용량 기반 과금과 요금제 기반 제한은 시스템 연동 구조로 설계되어야 자동화가 가능하다.</p></li></ul><h4 id=ddd-기반-테넌트-경계-설계>DDD 기반 테넌트 경계 설계<a hidden class=anchor aria-hidden=true href=#ddd-기반-테넌트-경계-설계>#</a></h4><p>** 도메인 주도 설계 (DDD)** 를 활용하여 <strong>테넌트 간 경계를 명확히</strong> 하고 <strong>업무 중심으로 모델을 분리</strong></p><pre class=mermaid>graph TD
  Tenant1 --&gt; AppContext1 --&gt; Domain1
  Tenant2 --&gt; AppContext2 --&gt; Domain2
  Domain1 --&gt; SharedKernel
  Domain2 --&gt; SharedKernel
</pre><table><thead><tr><th>주제</th><th>주요 포인트 요약</th></tr></thead><tbody><tr><td>DevOps 전략</td><td>테넌트 온보딩 자동화, CI/CD 분기, 모니터링 격리</td></tr><tr><td>요금제/과금 처리</td><td>사용량 추적 + Stripe 연동, 과금 정책 관리</td></tr><tr><td>DDD 설계</td><td>테넌트마다 Bounded Context 정의, 도메인 분리 관리</td></tr></tbody></table><h5 id=전략-구성>전략 구성<a hidden class=anchor aria-hidden=true href=#전략-구성>#</a></h5><table><thead><tr><th>항목</th><th>설계 내용</th></tr></thead><tbody><tr><td><strong>Bounded Context</strong></td><td>각 테넌트를 독립된 컨텍스트로 분리 (ex: 병원 vs 학교)</td></tr><tr><td><strong>Shared Kernel</strong></td><td>공통 도메인 모델 (예: 결제, 알림) 은 공유 가능</td></tr><tr><td><strong>Anti-Corruption Layer (ACL)</strong></td><td>외부 시스템 또는 다른 테넌트 간 인터페이스</td></tr><tr><td><strong>테넌트별 Ubiquitous Language</strong></td><td>각 도메인 용어를 명확히 정의하여 혼동 방지</td></tr></tbody></table><h5 id=예시-테넌트마다-도메인-다르게-설계>예시: 테넌트마다 도메인 다르게 설계<a hidden class=anchor aria-hidden=true href=#예시-테넌트마다-도메인-다르게-설계>#</a></h5><h6 id=병원-테넌트>병원 테넌트<a hidden class=anchor aria-hidden=true href=#병원-테넌트>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1>1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2>2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Patient</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>medical_record</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=err>…</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=학교-테넌트>학교 테넌트<a hidden class=anchor aria-hidden=true href=#학교-테넌트>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1>1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2>2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Student</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>enrollment_info</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=err>…</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=공통-커널-결제>공통 커널 (결제)<a hidden class=anchor aria-hidden=true href=#공통-커널-결제>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1>1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2>2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Subscription</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>plan_id</span><span class=p>,</span> <span class=n>start_date</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=err>…</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=적용-팁>적용 팁<a hidden class=anchor aria-hidden=true href=#적용-팁>#</a></h5><table><thead><tr><th>개념</th><th>설명</th></tr></thead><tbody><tr><td>코드 구조 분리</td><td><code>src/tenant_a/domain/</code>, <code>src/tenant_b/domain/</code> 등으로 명확히 나눔</td></tr><tr><td>독립 배포 가능성</td><td>각 도메인 컨텍스트를 마이크로서비스 또는 모듈로 배포</td></tr><tr><td>계약 기반 통신 정의</td><td>도메인 간 Contract-first API 설계 적용 (OpenAPI 등)</td></tr></tbody></table><h5 id=멀티테넌시-시스템-설계-시-의사결정-가이드>멀티테넌시 시스템 설계 시 의사결정 가이드<a hidden class=anchor aria-hidden=true href=#멀티테넌시-시스템-설계-시-의사결정-가이드>#</a></h5><pre class=mermaid>graph TD
  A[시스템 요구사항 정의] --&gt; B{보안/규제 필요 여부}
  B --&gt;|높음| C[Single-Tenancy 또는 DB 격리 구조]
  B --&gt;|보통| D{테넌트 수}
  D --&gt;|많음| E[Shared Schema 또는 Shared DB/Schema]
  D --&gt;|적음| F[Separate Schema 또는 DB]
  C --&gt; G[통합 또는 분리 배포 전략 설계]
  E --&gt; G
  F --&gt; G
  G --&gt; H[테넌트 Onboarding 자동화]
  H --&gt; I[리소스 제한/분리 정책 수립]
</pre><h4 id=확장성과-유지보수를-위한-전략>확장성과 유지보수를 위한 전략<a hidden class=anchor aria-hidden=true href=#확장성과-유지보수를-위한-전략>#</a></h4><table><thead><tr><th>카테고리</th><th>전략</th><th>설명</th></tr></thead><tbody><tr><td>수평 확장</td><td>앱 서버 및 데이터 샤딩</td><td>테넌트 증가 시 별도 샤드 혹은 클러스터 추가</td></tr><tr><td>버전 관리</td><td>기능 토글, A/B 테스트</td><td>테넌트별 기능 릴리즈 조절, 장애 영향 최소화</td></tr><tr><td>모듈화</td><td>핵심 모듈 공통화, 테넌트 확장 포인트 제공</td><td>공통 기능 유지하며 테넌트 전용 기능 추가 가능</td></tr><tr><td>서비스 분리</td><td>마이크로서비스 아키텍처</td><td>Control Plane 과 Data Plane 분리, 유지보수 분산</td></tr></tbody></table><h4 id=멀티테넌시-마이그레이션-전략>멀티테넌시 마이그레이션 전략<a hidden class=anchor aria-hidden=true href=#멀티테넌시-마이그레이션-전략>#</a></h4><p><strong>목표</strong>: Shared Schema 에서 Separate Schema 또는 DB 로 전환</p><table><thead><tr><th>단계</th><th>설명</th><th>도구 / 전략</th></tr></thead><tbody><tr><td>1. 테넌트 사용 패턴 분석</td><td>리소스 사용량, 성장률 등 분석</td><td>Logging + Prometheus</td></tr><tr><td>2. 이관 대상 테넌트 선정</td><td>트래픽 높은 테넌트부터 선택</td><td>기준: IOPS, 데이터량</td></tr><tr><td>3. 데이터 마이그레이션</td><td>기존 테이블 → 새 스키마 or DB</td><td>Flyway, Liquibase, custom script</td></tr><tr><td>4. 트래픽 전환</td><td>기존 인스턴스 → 새로운 인스턴스로 요청 분기</td><td>Nginx proxy, tenant-aware routing</td></tr><tr><td>5. 모니터링 및 롤백 체계 구축</td><td>이관 후 상태 확인</td><td>Canary 방식, rollback plan</td></tr><tr><td>6. 점진적 이관 반복</td><td>전체 이관까지 반복</td><td>일정 관리 도구와 함께 병렬 작업</td></tr></tbody></table><blockquote><p>하이브리드 구조를 유지하면서 상황에 따라 유연하게 전환할 수 있도록 설계해야 다운타임 없이 확장 가능합니다.</p></blockquote><h4 id=성능-튜닝-포인트-및-운영-최적화-전략>성능 튜닝 포인트 및 운영 최적화 전략<a hidden class=anchor aria-hidden=true href=#성능-튜닝-포인트-및-운영-최적화-전략>#</a></h4><table><thead><tr><th>범주</th><th>전략</th><th>상세 설명</th></tr></thead><tbody><tr><td>DB 튜닝</td><td>인덱싱 + 파티셔닝</td><td><code>tenant_id</code>, <code>created_at</code> 기준 복합 인덱스 추천</td></tr><tr><td>API 응답 속도</td><td>캐시 적용</td><td>Redis + per-tenant key policy 적용</td></tr><tr><td>리소스 관리</td><td>Kubernetes + ResourceQuota</td><td>테넌트별 CPU/Memory 리미트 설정</td></tr><tr><td>비동기 처리</td><td>메시지 큐 활용</td><td>Kafka, RabbitMQ 로 분석/알림 로직 분리</td></tr><tr><td>에러 추적</td><td>테넌트 ID 기반 로깅</td><td><code>tenant_id</code> 포함된 로깅 구조 필수</td></tr><tr><td>SLA 분리</td><td>테넌트 Tier 별 QoS 설정</td><td>Premium 테넌트에 우선 트래픽 배정</td></tr><tr><td>대시보드</td><td>테넌트별 모니터링</td><td>Grafana + Loki + Prometheus 조합</td></tr></tbody></table><h4 id=보안-및-규제-대응-전략>보안 및 규제 대응 전략<a hidden class=anchor aria-hidden=true href=#보안-및-규제-대응-전략>#</a></h4><table><thead><tr><th>항목</th><th>전략</th><th>설명</th></tr></thead><tbody><tr><td>인증/인가</td><td>OAuth2, OpenID Connect</td><td>테넌트 내 사용자 계정 격리 및 접근 제어</td></tr><tr><td>RBAC 적용</td><td>Role-Based Access Control</td><td>테넌트별 역할 기반 권한 설정 및 정책 관리</td></tr><tr><td>데이터 암호화</td><td>TDE, AES-256, TLS</td><td>저장/전송 시 데이터 암호화</td></tr><tr><td>로깅 및 감사</td><td>테넌트 단위 감사 로그 수집</td><td>규제 요구에 따른 테넌트별 접근 이력 저장</td></tr><tr><td>규제 대응</td><td>GDPR/HIPAA 인증 체크리스트</td><td>데이터 위치, 삭제 요청 등 규정 대응 자동화 시스템 필요</td></tr></tbody></table><h4 id=멀티테넌시-saas-운영-시-devops-전략>멀티테넌시 SaaS 운영 시 DevOps 전략<a hidden class=anchor aria-hidden=true href=#멀티테넌시-saas-운영-시-devops-전략>#</a></h4><p>멀티테넌시 환경에서 <strong>테넌트 수 증가</strong>, <strong>고객 맞춤형 설정</strong>, <strong>리소스 분리</strong>를 DevOps 관점에서 자동화·최적화하는 전략</p><h5 id=핵심-전략-정리>핵심 전략 정리<a hidden class=anchor aria-hidden=true href=#핵심-전략-정리>#</a></h5><table><thead><tr><th>전략 항목</th><th>적용 방안 예시</th></tr></thead><tbody><tr><td><strong>테넌트 온보딩 자동화</strong></td><td>Terraform + Helm + GitOps 기반 Namespace, 리소스 자동 생성</td></tr><tr><td><strong>CI/CD 파이프라인</strong></td><td>ArgoCD / GitHub Actions / GitLab CI → 테넌트별 릴리즈 분기</td></tr><tr><td><strong>버전 관리</strong></td><td>Feature Flag, 테넌트별 브랜치 전략</td></tr><tr><td><strong>로깅 및 모니터링</strong></td><td>테넌트 ID 기반 로그 필터링, Grafana Dashboard per tenant</td></tr><tr><td><strong>보안 및 접근 제어</strong></td><td>테넌트별 IAM Policy, Secret 관리 (Vault / AWS Secrets Manager)</td></tr><tr><td><strong>멀티테넌시 환경 테스트</strong></td><td>테넌트 스텁 (Mock Tenant), 테스트용 테넌트 자동 생성 스크립트 포함</td></tr><tr><td><strong>스케일링 및 오토스케일링</strong></td><td>테넌트 traffic 기반 HPA (Horizontal Pod Autoscaler) 적용</td></tr></tbody></table><h5 id=예시-gitops-기반-테넌트-배포>예시: GitOps 기반 테넌트 배포<a hidden class=anchor aria-hidden=true href=#예시-gitops-기반-테넌트-배포>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1>1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2>2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3>3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4>4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 신규 테넌트 생성 자동화 (예: devops/tenants/tenant-a-values.yaml)</span>
</span></span><span class=line><span class=cl>helm upgrade --install tenant-a ./charts/app <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --namespace tenant-a <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --create-namespace <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -f tenants/tenant-a-values.yaml
</span></span></code></pre></td></tr></table></div></div><h5 id=보안-전략>보안 전략<a hidden class=anchor aria-hidden=true href=#보안-전략>#</a></h5><ul><li><strong>테넌트마다 KMS Key 분리</strong></li><li><strong>JWT 에 테넌트 context 포함</strong></li><li><strong>Vault → tenant_id 기준으로 Secret path 분리</strong></li></ul><h5 id=모니터링-구성-prometheus--loki--grafana>모니터링 구성 (Prometheus + Loki + Grafana)<a hidden class=anchor aria-hidden=true href=#모니터링-구성-prometheus--loki--grafana>#</a></h5><ul><li>각 로그/메트릭에 <code>tenant_id</code> 라벨 포함</li><li>Grafana Dashboard 에서 테넌트별 필터 제공</li></ul><h4 id=멀티테넌시-구조에서-테넌트별-요금제-과금-billing-처리>멀티테넌시 구조에서 테넌트별 요금제, 과금 (Billing) 처리<a hidden class=anchor aria-hidden=true href=#멀티테넌시-구조에서-테넌트별-요금제-과금-billing-처리>#</a></h4><p>테넌트의 <strong>리소스 사용량 기반 요금 산정</strong> 및 <strong>구간별 요금제 제공</strong></p><h5 id=구조-다이어그램>구조 다이어그램<a hidden class=anchor aria-hidden=true href=#구조-다이어그램>#</a></h5><pre class=mermaid>graph TD
  Tenant --&gt; UsageTracker
  UsageTracker --&gt; BillingEngine
  BillingEngine --&gt; PaymentGateway
  BillingEngine --&gt; InvoiceDB
  AdminPortal --&gt; BillingEngine
</pre><h5 id=요금제-처리-전략>요금제 처리 전략<a hidden class=anchor aria-hidden=true href=#요금제-처리-전략>#</a></h5><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>요금제 모델링</td><td>Free, Basic, Pro, Enterprise 요금제 구조 정의</td></tr><tr><td>사용량 측정</td><td>API 호출 수, 저장 용량, 배치 실행 횟수 등 추적</td></tr><tr><td>요금 산정 방식</td><td>Subscription (월정액) + Overage (초과 사용량) 혼합</td></tr><tr><td>과금 처리</td><td>Stripe, Toss, Paypal 등과 통합</td></tr><tr><td>테넌트별 리포트 제공</td><td>사용량 + 과금 내역 통합 대시보드 제공</td></tr></tbody></table><h6 id=사용량-수집-예시-prometheus--pushgateway>사용량 수집 예시 (Prometheus + Pushgateway)<a hidden class=anchor aria-hidden=true href=#사용량-수집-예시-prometheus--pushgateway>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 테넌트별 API 호출 수 증가</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>prometheus_client</span> <span class=kn>import</span> <span class=n>Counter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>api_requests</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;api_requests_total&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;Total API requests per tenant&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=s1>&#39;tenant_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>api_requests</span><span class=o>.</span><span class=n>labels</span><span class=p>(</span><span class=n>tenant_id</span><span class=o>=</span><span class=s1>&#39;tenant_a&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>inc</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=stripe-기반-subscription-연동-예시>Stripe 기반 Subscription 연동 예시<a hidden class=anchor aria-hidden=true href=#stripe-기반-subscription-연동-예시>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1> 1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2> 2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3> 3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4> 4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5> 5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6> 6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7> 7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8> 8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9> 9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>stripe</span>
</span></span><span class=line><span class=cl><span class=n>stripe</span><span class=o>.</span><span class=n>api_key</span> <span class=o>=</span> <span class=s2>&#34;sk_test_…&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_customer_and_subscription</span><span class=p>(</span><span class=n>email</span><span class=p>,</span> <span class=n>plan_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>customer</span> <span class=o>=</span> <span class=n>stripe</span><span class=o>.</span><span class=n>Customer</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=n>email</span><span class=o>=</span><span class=n>email</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>subscription</span> <span class=o>=</span> <span class=n>stripe</span><span class=o>.</span><span class=n>Subscription</span><span class=o>.</span><span class=n>create</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>customer</span><span class=o>=</span><span class=n>customer</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>items</span><span class=o>=</span><span class=p>[{</span><span class=s2>&#34;price&#34;</span><span class=p>:</span> <span class=n>plan_id</span><span class=p>}],</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>subscription</span><span class=o>.</span><span class=n>id</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=테넌트-과금-처리-고려-사항>테넌트 과금 처리 고려 사항<a hidden class=anchor aria-hidden=true href=#테넌트-과금-처리-고려-사항>#</a></h5><table><thead><tr><th>항목</th><th>고려 사항</th></tr></thead><tbody><tr><td>VAT / 세금 반영</td><td>지역별 과금 정책 포함 필요</td></tr><tr><td>청구 실패/재시도 처리</td><td>Grace period, Retry, Notification 전략</td></tr><tr><td>고지서 / PDF 인보이스 제공</td><td>자동화 PDF 생성 및 이메일 발송</td></tr><tr><td>환불 / 크레딧 처리</td><td>월 단위 프로레이션 처리 구현 필요</td></tr></tbody></table><h5 id=요금제에-따른-멀티테넌시-아키텍처-매핑>요금제에 따른 멀티테넌시 아키텍처 매핑<a hidden class=anchor aria-hidden=true href=#요금제에-따른-멀티테넌시-아키텍처-매핑>#</a></h5><p>요금제는 테넌트의 <strong>기능 요구</strong>, <strong>보안 요구</strong>, <strong>성능 요구</strong>에 따라 멀티테넌시 아키텍처를 <strong>다단계로 구분</strong>하여 설계할 수 있다.</p><table><thead><tr><th>요금제 수준</th><th>주요 특징</th><th>권장 멀티테넌시 구조</th><th>기술 구성 요소</th></tr></thead><tbody><tr><td><strong>Free Tier</strong></td><td>비용 민감, 트래픽 낮음, 기능 제한적</td><td><strong>Shared DB / Shared Schema</strong> + <strong>Single App Instance</strong></td><td>FastAPI/Flask, SQLite/PostgreSQL (공유), <code>tenant_id</code> 필터링</td></tr><tr><td><strong>Starter / Basic</strong></td><td>소규모 팀, 트래픽 증가 시작, 보안은 기본</td><td><strong>Shared DB / Separate Schema</strong> + Shared App</td><td>PostgreSQL, Schema Routing, Helm value override</td></tr><tr><td><strong>Pro / Business</strong></td><td>보안 요구 증가, 일부 기능 커스터마이징 필요</td><td><strong>Separate DB</strong> + Shared App with Feature Toggle</td><td>PostgreSQL/MySQL, DB-per-tenant, LaunchDarkly, ArgoCD</td></tr><tr><td><strong>Enterprise</strong></td><td>SLA 보장, 커스터마이징 강함, 법적 규정 요구</td><td><strong>Separate DB + Isolated App Instance</strong> + Dedicated Namespace</td><td>Dedicated DB/Pod, K8s Namespace, Terraform, Vault</td></tr><tr><td><strong>Gov/Regulated</strong></td><td>데이터 지역 요구, 감사 추적 필수</td><td><strong>Hard Multi-Tenancy</strong> (Multi-Region / Multi-AZ)</td><td>Region-based Isolation, OPA, OpenTelemetry, Regional Helm Chart</td></tr></tbody></table><h3 id=최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>카테고리</th><th>최적화 항목</th><th>설명</th><th>권장 사항</th></tr></thead><tbody><tr><td>쿼리 및 DB 최적화</td><td>인덱스 전략</td><td>테넌트/사용자별 인덱스 적용, 쿼리 슬로우 로그 분석</td><td>복합 인덱스, 파티셔닝, 슬로우 쿼리 감사 도입</td></tr><tr><td></td><td>쿼리 효율화</td><td>N+1 문제 방지 및 배치 처리 적용</td><td>ORM 최적화, Read Replica 활용 등</td></tr><tr><td>캐싱 전략</td><td>테넌트별 캐시</td><td>캐시 네임스페이스 분리로 데이터 충돌 방지</td><td>Redis, Memcached 기반 분산 캐시 및 TTL 설계 적용</td></tr><tr><td>리소스 관리 및 격리</td><td>리소스 할당</td><td>테넌트별 자원 동적 할당 및 예측적 스케일링</td><td>HPA, VPA, ML 예측 기반 할당</td></tr><tr><td></td><td>noisy neighbor 대응</td><td>과도한 리소스 점유 방지</td><td>QOS, Rate Limit, Kubernetes ResourceQuota 적용</td></tr><tr><td>보안 및 접근 제어</td><td>권한 관리</td><td>최소 권한 원칙, RBAC 구성</td><td>사용자/테넌트/역할 기반 권한 분리 및 점검</td></tr><tr><td></td><td>데이터 암호화</td><td>저장/전송 시 암호화 및 키 관리</td><td>TLS, KMS 연동, 테넌트별 키 격리 구조</td></tr><tr><td>확장성 및 배포 전략</td><td>배포 정책</td><td>기능 추가/수정 시 전 테넌트 동시 배포 방지</td><td>Canary, Blue-Green, Feature Flag 전략 활용</td></tr><tr><td></td><td>수평/수직 확장</td><td>테넌트 수 증가에 따른 유연한 확장 구조 설계</td><td>마이크로서비스 기반 확장, 컨테이너 기반 인프라</td></tr><tr><td>장애 대응 및 회복력</td><td>장애 격리</td><td>하나의 테넌트 장애가 전체 시스템에 영향 주지 않도록 설계</td><td>Circuit Breaker, 테넌트별 장애 경계 설계</td></tr><tr><td></td><td>복구 전략</td><td>시스템 다운 시 자동 복구 및 롤백 지원</td><td>Auto Rollback, Failover, Multi-Region 배포</td></tr><tr><td>관측성 및 운영 자동화</td><td>로그 및 메트릭</td><td>테넌트 구분 가능한 로그/지표 수집 및 모니터링</td><td>테넌트 ID 포함 로그 구조, APM 연동, 중앙 로그 집계 시스템 적용</td></tr><tr><td></td><td>운영 자동화</td><td>테넌트 온보딩, 배포, 스케일링 자동화</td><td>GitOps, Terraform, Helm 등 IaC 적용</td></tr><tr><td>국제화 및 SLA 고려</td><td>테넌트별 SLA</td><td>중요 테넌트에 대한 QoS 보장 설계</td><td>우선순위 스케줄링, 리소스 예약 구조, VIP 테넌트 분리 처리</td></tr><tr><td></td><td>다국어/시간대 지원</td><td>글로벌 테넌트를 위한 시간/언어/지역 설정 전략</td><td>i18n, Timezone-aware 서비스, 지역별 데이터 배치 설계</td></tr></tbody></table><ul><li><p><strong>쿼리 및 DB 최적화</strong>는 테넌트 수 증가에 따른 성능 저하 방지를 위한 가장 핵심적인 영역으로, 파티셔닝 및 슬로우 쿼리 분석이 중요하다.</p></li><li><p><strong>캐싱 전략</strong>은 테넌트 간 데이터 충돌 방지와 성능 향상 측면에서 테넌트 분리 네임스페이스 및 TTL 제어가 필수적이다.</p></li><li><p><strong>리소스 관리 및 격리</strong>는 noisy neighbor 방지 및 사용량 기반 유연한 확장을 위한 기반이며, 자동 스케일링과 정책 기반 리소스 할당이 권장된다.</p></li><li><p><strong>보안 및 접근 제어</strong>는 다중 테넌트를 보호하는 핵심 요소로, RBAC 및 암호화 체계 설계가 중요하다.</p></li><li><p><strong>확장성 및 배포 전략</strong>은 고도화된 SaaS 의 핵심 운영 전략으로, 배포 충돌 방지와 유연한 기능 롤아웃 설계가 필요하다.</p></li><li><p><strong>장애 대응 및 회복력</strong>은 테넌트 장애 격리 및 전체 시스템 안정성을 위한 설계 요소로, 패턴 및 리전 분산 구조가 효과적이다.</p></li><li><p><strong>관측성 및 운영 자동화</strong>는 운영 복잡도를 낮추고 대응 속도를 높이기 위한 핵심 요소이며, 로그, 모니터링, IaC 도입이 중요하다.</p></li><li><p><strong>국제화 및 SLA 고려</strong>는 글로벌 SaaS 환경 및 중요 고객 대응을 위한 전략으로, 설정 유연성과 우선순위 기반 리소스 보장이 필요하다.</p></li></ul><h4 id=saas-성장-단계에-따른-테넌시-분리-전략-변화>SaaS 성장 단계에 따른 테넌시 분리 전략 변화<a hidden class=anchor aria-hidden=true href=#saas-성장-단계에-따른-테넌시-분리-전략-변화>#</a></h4><p>SaaS 시스템은 <strong>비용 중심 → 유연성 중심 → 보안/규제 중심</strong>으로 성장함에 따라 멀티테넌시 구조를 점진적으로 진화시켜야 한다.</p><ul><li>초기에는 <code>Shared Schema + 단일 앱 인스턴스</code> 로 시작해, 요구에 따라 <code>Schema 분리 → DB 분리 → 인스턴스 분리</code> 로 진화하는 것이 이상적이다.</li><li><strong>SaaS 성장 전략</strong>은 테넌시 구조를 단계적으로 고도화하여, <strong>낮은 비용, 높은 보안, 빠른 확장성</strong>을 균형 있게 확보해야 한다.</li><li>기술적 전환은 항상 <strong>자동화 (IaC, Helm, Terraform)</strong> 및 **정책 중심 설계 (OPA, Feature Flag)**와 함께 이루어져야 한다.</li></ul><table><thead><tr><th>SaaS 성장 단계</th><th>조직 특징</th><th>테넌시 전략 변화</th><th>핵심 전환 포인트</th></tr></thead><tbody><tr><td><strong>1 단계: MVP / 초기 출시</strong></td><td>빠른 배포, 비용 제한, 적은 고객 수</td><td>Shared DB / Shared Schema + 단일 앱 인스턴스</td><td><code>tenant_id</code> 필터 도입, 단일 config</td></tr><tr><td><strong>2 단계: Product Market Fit</strong></td><td>고객 증가, 기능 요구 다양화</td><td>Shared DB / Separate Schema + 기능 토글 도입</td><td>Schema Router, Feature Flag 시스템 도입</td></tr><tr><td><strong>3 단계: 확장/스케일링</strong></td><td>대형 고객 유입, 성능·보안 요구 상승</td><td>Separate DB + Shared App + 리소스 할당 분리</td><td>DB-per-tenant, ResourceQuota, CI/CD 분리</td></tr><tr><td><strong>4 단계: 엔터프라이즈 진출</strong></td><td>SLA 계약, 지역 규제 대응</td><td>Separate DB + Isolated App + 전용 모듈 구조</td><td>Dedicated Namespace, Compliance Monitoring</td></tr><tr><td><strong>5 단계: 다국가/다규제 대응</strong></td><td>데이터 거버넌스, 현지 규제, 감사 요구</td><td>Multi-Region Hard Multi-Tenancy + 분산 운영</td><td>리전별 클러스터, 암호화 정책, Regional Failover</td></tr></tbody></table><h5 id=성장-단계-기준-아키텍처-분기>성장 단계 기준 아키텍처 분기<a hidden class=anchor aria-hidden=true href=#성장-단계-기준-아키텍처-분기>#</a></h5><pre class=mermaid>flowchart TD
    Start([Start: MVP])
    PMF([2단계: Product-Market Fit])
    Scale([3단계: 확장기])
    Enterprise([4단계: 엔터프라이즈 대응])
    Regulated([5단계: 규제 산업/다국가])

    Start --&gt; PMF
    PMF --&gt; Scale
    Scale --&gt; Enterprise
    Enterprise --&gt; Regulated

    Start --&gt;|Shared Schema| A1[Low-cost Multi-tenancy]
    PMF --&gt;|Shared DB + Separate Schema| A2[기능 토글, 설정 기반 분기]
    Scale --&gt;|DB-per-Tenant| A3[성능/보안 분리]
    Enterprise --&gt;|App + DB 격리| A4[Dedicated Namespace]
    Regulated --&gt;|Multi-Region / HA| A5[Hard Multi-Tenancy]
</pre><h3 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h3><table><thead><tr><th>카테고리</th><th>적용 사례</th><th>목적 및 구성 설명</th><th>기대 효과</th></tr></thead><tbody><tr><td>SaaS 플랫폼</td><td>CRM, 업무관리 SaaS</td><td>하나의 앱에서 테넌트별 사용자·설정·데이터 분리</td><td>비용 95% 절감, 99.9% 가용성 확보</td></tr><tr><td>B2B 클라우드 서비스</td><td>회계 소프트웨어, 분석 대시보드</td><td>기업 고객 대상 기능 제공, API 인증, 빠른 온보딩 지원</td><td>80% 운영비 절감, 빠른 배포</td></tr><tr><td>교육 플랫폼 (LMS)</td><td>학교/기관별 학습 관리 시스템</td><td>학교별 분리된 환경 제공, 공통 콘텐츠 리포트·분석 공유</td><td>60% 인프라 절감, 운영 일관성 강화</td></tr><tr><td>전자상거래 플랫폼</td><td>다중 브랜드 쇼핑몰 운영</td><td>브랜드별 UI·상품·설정 제공, 테넌트별 주문·재고·결제 관리</td><td>확장성 10 배 증가, 개발 시간 70% 단축</td></tr><tr><td>보안 중심 SaaS</td><td>금융·공공 SaaS</td><td>테넌트 간 완전한 데이터 격리, 강력한 접근 제어, 로그 감사</td><td>컴플라이언스 준수, 정보 보호 강화</td></tr><tr><td>커스터마이징 가능한 SaaS</td><td>Feature Flag 기반</td><td>기능별 온/오프, 테넌트별 설정 저장, A/B 테스트 가능</td><td>맞춤형 기능 제공, 기능 롤아웃 최적화</td></tr><tr><td>멀티리전/오케스트레이션 환경</td><td>게임서버, Cloud Composer</td><td>지역/팀별 격리된 배포 파이프라인 유지, CI/CD 자동화</td><td>확장성 확보, 운영 정책 표준화</td></tr><tr><td>헬스케어 플랫폼</td><td>병원/클리닉별 데이터 격리</td><td>환자정보, 진단이력, 의사 권한 등 테넌트별로 격리</td><td>보안 강화, 민감정보 분리, HIPAA 준수</td></tr><tr><td>IoT 및 데이터 분석 플랫폼</td><td>센서 기반 플랫폼, 리포팅 도구</td><td>각 기업별 센서 및 데이터 수집 분리, 대시보드 커스터마이징</td><td>실시간 데이터 분석, 스토리지 절감</td></tr></tbody></table><ul><li><p><strong>SaaS 플랫폼</strong>은 다수의 고객 (테넌트) 을 대상으로 하는 일반적 구조로, 운영 효율성과 배포 전략 측면에서 가장 대표적인 멀티테넌시 활용 사례다.</p></li><li><p><strong>B2B 클라우드 서비스</strong>는 특정 도메인 (회계, 데이터 시각화 등) 에 특화된 기능을 각 테넌트에게 분리 제공하면서도 공통 인프라를 유지한다.</p></li><li><p><strong>교육 플랫폼</strong>은 학습 콘텐츠를 공유하면서도 학교/기관마다의 학사 운영 환경을 완전히 분리하여 멀티테넌시 설계가 자연스럽게 적용된다.</p></li><li><p><strong>전자상거래 플랫폼</strong>은 브랜드 단위 또는 테넌트 단위의 UI, 상품 카탈로그, 결제 모듈이 분리되어야 하므로 고도의 설정 분리 구조가 요구된다.</p></li><li><p><strong>보안 중심 SaaS</strong>는 금융, 헬스케어, 공공기관과 같은 민감 데이터를 다루는 환경으로, 데이터 격리, 키 관리, 감사 로그가 필수적이다.</p></li><li><p><strong>커스터마이징 가능한 SaaS</strong>는 기능 온/오프, 플래그 기반 설정 등을 통해 고객별 니즈에 맞춘 차별화된 서비스를 제공한다.</p></li><li><p><strong>멀티리전/오케스트레이션 환경</strong>은 고가용성과 글로벌 사용자 대응이 핵심으로, 지역/조직별 배포, 성능 분산 구조 설계가 필요하다.</p></li><li><p><strong>헬스케어 플랫폼</strong>은 규정 준수 (HIPAA 등) 를 위한 강력한 격리 전략과 역할 기반 접근 제어가 중점이다.</p></li><li><p><strong>IoT 및 데이터 분석 플랫폼</strong>은 실시간 분석과 대시보드 분리로 테넌트마다 다른 데이터를 처리하고 시각화하는 구조가 일반적이다.</p></li></ul><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><h4 id=사례-1-교육-플랫폼>사례 1: 교육 플랫폼<a hidden class=anchor aria-hidden=true href=#사례-1-교육-플랫폼>#</a></h4><p><strong>시나리오</strong>: 여러 학교 또는 기관이 동일 LMS(학습관리 시스템) 를 사용하되, 각 기관은 자체 정보와 대시보드, 사용자 관리 등을 독립적으로 갖고자 함.</p><p><strong>시스템 구성</strong>:</p><ul><li>Control plane: 테넌트 온보딩, 인증/권한관리, 요금 청구</li><li>Data plane: 테넌트별 스키마 혹은 DB 격리 + 공통 앱 서버</li><li>Middleware: 요청 시 테넌트 context 삽입</li><li>분석 레이어: 중앙 로그 분석 및 테넌트별 리포트</li></ul><pre class=mermaid>graph LR
  User --&gt; LB
  LB --&gt; Middleware --&gt; AppServer
  AppServer --&gt; SchemaA[(DB Schema A)]
  AppServer --&gt; SchemaB[(DB Schema B)]
  AppServer --&gt; SchemaC[(DB Schema C)]
  AppServer --&gt; CentralAnalytics[(Analytics DB)]
  ControlPlane --&gt; Middleware
</pre><p><strong>Workflow</strong>:</p><ul><li>사용자 로그인 → 멀티테넌트 미들웨어가 tenant-id 식별</li><li>요청은 해당 테넌트 스키마로 라우팅</li><li>분석 이벤트는 중앙 데이터베이스 수집</li></ul><p><strong>역할</strong>:</p><ul><li>Middleware: tenant-id 기반 요청 분기</li><li>AppServer: 공통 비즈니스 로직 실행</li><li>DB Layer: 테넌트 데이터 분리 처리</li><li>ControlPlane: 관리 API, 분석, 온보딩</li></ul><p><strong>유무에 따른 차이점</strong>:</p><ul><li>Multi‑tenant 도입 시: 단일 코드 유지, 공통 업데이트, 리포트 일관성</li><li>Single‑tenant 시: 각 테넌트 별 서버 관리 필요, 운영 복잡도 증가</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1> 1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2> 2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3> 3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4> 4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5> 5</a>
</span><span class=lnt id=hl-25-6><a class=lnlinks href=#hl-25-6> 6</a>
</span><span class=lnt id=hl-25-7><a class=lnlinks href=#hl-25-7> 7</a>
</span><span class=lnt id=hl-25-8><a class=lnlinks href=#hl-25-8> 8</a>
</span><span class=lnt id=hl-25-9><a class=lnlinks href=#hl-25-9> 9</a>
</span><span class=lnt id=hl-25-10><a class=lnlinks href=#hl-25-10>10</a>
</span><span class=lnt id=hl-25-11><a class=lnlinks href=#hl-25-11>11</a>
</span><span class=lnt id=hl-25-12><a class=lnlinks href=#hl-25-12>12</a>
</span><span class=lnt id=hl-25-13><a class=lnlinks href=#hl-25-13>13</a>
</span><span class=lnt id=hl-25-14><a class=lnlinks href=#hl-25-14>14</a>
</span><span class=lnt id=hl-25-15><a class=lnlinks href=#hl-25-15>15</a>
</span><span class=lnt id=hl-25-16><a class=lnlinks href=#hl-25-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># tenant-aware 미들웨어 예시 (Python Flask)</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>request</span><span class=p>,</span> <span class=n>g</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>tenant_middleware</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>g</span><span class=o>.</span><span class=n>tenant_id</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;X-Tenant-ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>valid_tenant</span><span class=p>(</span><span class=n>g</span><span class=o>.</span><span class=n>tenant_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>abort</span><span class=p>(</span><span class=mi>403</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.before_request</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>before</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant_middleware</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/data&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>data</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span> <span class=o>=</span> <span class=n>get_db_connection</span><span class=p>(</span><span class=n>tenant_id</span><span class=o>=</span><span class=n>g</span><span class=o>.</span><span class=n>tenant_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s2>&#34;SELECT * FROM items WHERE tenant_id=</span><span class=si>%s</span><span class=s2>&#34;</span><span class=p>,</span> <span class=n>g</span><span class=o>.</span><span class=n>tenant_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-2-전자상거래-플랫폼을-위한-멀티-테넌트-재고-관리-시스템>사례 2: 전자상거래 플랫폼을 위한 멀티 테넌트 재고 관리 시스템<a hidden class=anchor aria-hidden=true href=#사례-2-전자상거래-플랫폼을-위한-멀티-테넌트-재고-관리-시스템>#</a></h4><p><strong>시나리오</strong>: 전자상거래 플랫폼을 위한 멀티 테넌트 재고 관리 시스템</p><p><strong>시스템 구성</strong>:</p><ul><li>API Gateway (Kong/Nginx)</li><li>마이크로서비스 아키텍처 (Node.js/Express)</li><li>PostgreSQL 데이터베이스 (Row-Level Security)</li><li>Redis 캐시 (테넌트별 네임스페이스)</li><li>Elasticsearch 검색 엔진</li><li>Docker 컨테이너화</li></ul><pre class=mermaid>graph TB
    subgraph &#34;Client Layer&#34;
        CA[Store A Client]
        CB[Store B Client] 
        CC[Store C Client]
    end
    
    subgraph &#34;API Gateway&#34;
        GW[Kong Gateway]
        AUTH[JWT Authentication]
    end
    
    subgraph &#34;Application Services&#34;
        INV[Inventory Service]
        ORD[Order Service]
        PROD[Product Service]
    end
    
    subgraph &#34;Data Layer&#34;
        PG[(PostgreSQL with RLS)]
        RD[(Redis Cache)]
        ES[(Elasticsearch)]
    end
    
    CA --&gt; GW
    CB --&gt; GW
    CC --&gt; GW
    
    GW --&gt; AUTH
    AUTH --&gt; INV
    AUTH --&gt; ORD
    AUTH --&gt; PROD
    
    INV --&gt; PG
    ORD --&gt; PG
    PROD --&gt; PG
    
    INV --&gt; RD
    ORD --&gt; RD
    PROD --&gt; ES
</pre><p><strong>Workflow</strong>:</p><ul><li>클라이언트 요청 시 JWT 토큰에서 테넌트 ID 추출</li><li>API Gateway 에서 테넌트별 라우팅 및 인증 처리</li><li>마이크로서비스에서 테넌트 컨텍스트 설정</li><li>PostgreSQL RLS 를 통한 자동 데이터 필터링</li><li>Redis 에서 테넌트별 네임스페이스로 캐시 관리</li><li>Elasticsearch 에서 테넌트별 인덱스로 검색 처리</li></ul><p><strong>역할</strong>:</p><ul><li>API Gateway: 테넌트 식별 및 초기 인증/인가</li><li>마이크로서비스: 비즈니스 로직과 테넌트 컨텍스트 관리</li><li>데이터베이스: Row-Level Security 를 통한 데이터 격리</li><li>캐시 시스템: 성능 최적화와 테넌트별 격리</li></ul><p><strong>유무에 따른 차이점</strong>:</p><ul><li><strong>멀티 테넌시 적용 시</strong>: 단일 인스턴스로 1000+ 스토어 지원, 95% 비용 절감</li><li><strong>단일 테넌시</strong>: 스토어별 독립 배포 필요, 관리 복잡성 10 배 증가</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-27-1><a class=lnlinks href=#hl-27-1> 1</a>
</span><span class=lnt id=hl-27-2><a class=lnlinks href=#hl-27-2> 2</a>
</span><span class=lnt id=hl-27-3><a class=lnlinks href=#hl-27-3> 3</a>
</span><span class=lnt id=hl-27-4><a class=lnlinks href=#hl-27-4> 4</a>
</span><span class=lnt id=hl-27-5><a class=lnlinks href=#hl-27-5> 5</a>
</span><span class=lnt id=hl-27-6><a class=lnlinks href=#hl-27-6> 6</a>
</span><span class=lnt id=hl-27-7><a class=lnlinks href=#hl-27-7> 7</a>
</span><span class=lnt id=hl-27-8><a class=lnlinks href=#hl-27-8> 8</a>
</span><span class=lnt id=hl-27-9><a class=lnlinks href=#hl-27-9> 9</a>
</span><span class=lnt id=hl-27-10><a class=lnlinks href=#hl-27-10>10</a>
</span><span class=lnt id=hl-27-11><a class=lnlinks href=#hl-27-11>11</a>
</span><span class=lnt id=hl-27-12><a class=lnlinks href=#hl-27-12>12</a>
</span><span class=lnt id=hl-27-13><a class=lnlinks href=#hl-27-13>13</a>
</span><span class=lnt id=hl-27-14><a class=lnlinks href=#hl-27-14>14</a>
</span><span class=lnt id=hl-27-15><a class=lnlinks href=#hl-27-15>15</a>
</span><span class=lnt id=hl-27-16><a class=lnlinks href=#hl-27-16>16</a>
</span><span class=lnt id=hl-27-17><a class=lnlinks href=#hl-27-17>17</a>
</span><span class=lnt id=hl-27-18><a class=lnlinks href=#hl-27-18>18</a>
</span><span class=lnt id=hl-27-19><a class=lnlinks href=#hl-27-19>19</a>
</span><span class=lnt id=hl-27-20><a class=lnlinks href=#hl-27-20>20</a>
</span><span class=lnt id=hl-27-21><a class=lnlinks href=#hl-27-21>21</a>
</span><span class=lnt id=hl-27-22><a class=lnlinks href=#hl-27-22>22</a>
</span><span class=lnt id=hl-27-23><a class=lnlinks href=#hl-27-23>23</a>
</span><span class=lnt id=hl-27-24><a class=lnlinks href=#hl-27-24>24</a>
</span><span class=lnt id=hl-27-25><a class=lnlinks href=#hl-27-25>25</a>
</span><span class=lnt id=hl-27-26><a class=lnlinks href=#hl-27-26>26</a>
</span><span class=lnt id=hl-27-27><a class=lnlinks href=#hl-27-27>27</a>
</span><span class=lnt id=hl-27-28><a class=lnlinks href=#hl-27-28>28</a>
</span><span class=lnt id=hl-27-29><a class=lnlinks href=#hl-27-29>29</a>
</span><span class=lnt id=hl-27-30><a class=lnlinks href=#hl-27-30>30</a>
</span><span class=lnt id=hl-27-31><a class=lnlinks href=#hl-27-31>31</a>
</span><span class=lnt id=hl-27-32><a class=lnlinks href=#hl-27-32>32</a>
</span><span class=lnt id=hl-27-33><a class=lnlinks href=#hl-27-33>33</a>
</span><span class=lnt id=hl-27-34><a class=lnlinks href=#hl-27-34>34</a>
</span><span class=lnt id=hl-27-35><a class=lnlinks href=#hl-27-35>35</a>
</span><span class=lnt id=hl-27-36><a class=lnlinks href=#hl-27-36>36</a>
</span><span class=lnt id=hl-27-37><a class=lnlinks href=#hl-27-37>37</a>
</span><span class=lnt id=hl-27-38><a class=lnlinks href=#hl-27-38>38</a>
</span><span class=lnt id=hl-27-39><a class=lnlinks href=#hl-27-39>39</a>
</span><span class=lnt id=hl-27-40><a class=lnlinks href=#hl-27-40>40</a>
</span><span class=lnt id=hl-27-41><a class=lnlinks href=#hl-27-41>41</a>
</span><span class=lnt id=hl-27-42><a class=lnlinks href=#hl-27-42>42</a>
</span><span class=lnt id=hl-27-43><a class=lnlinks href=#hl-27-43>43</a>
</span><span class=lnt id=hl-27-44><a class=lnlinks href=#hl-27-44>44</a>
</span><span class=lnt id=hl-27-45><a class=lnlinks href=#hl-27-45>45</a>
</span><span class=lnt id=hl-27-46><a class=lnlinks href=#hl-27-46>46</a>
</span><span class=lnt id=hl-27-47><a class=lnlinks href=#hl-27-47>47</a>
</span><span class=lnt id=hl-27-48><a class=lnlinks href=#hl-27-48>48</a>
</span><span class=lnt id=hl-27-49><a class=lnlinks href=#hl-27-49>49</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Express.js 멀티 테넌트 미들웨어
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>tenantMiddleware</span> <span class=o>=</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>authorization</span><span class=o>?</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>decoded</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>token</span><span class=p>,</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>JWT_SECRET</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 테넌트 컨텍스트 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>req</span><span class=p>.</span><span class=nx>tenant</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>id</span><span class=o>:</span> <span class=nx>decoded</span><span class=p>.</span><span class=nx>tenant_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>name</span><span class=o>:</span> <span class=nx>decoded</span><span class=p>.</span><span class=nx>tenant_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>schema</span><span class=o>:</span> <span class=sb>`tenant_</span><span class=si>${</span><span class=nx>decoded</span><span class=p>.</span><span class=nx>tenant_id</span><span class=si>}</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// PostgreSQL RLS 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>req</span><span class=p>.</span><span class=nx>db</span><span class=p>.</span><span class=nx>query</span><span class=p>(</span><span class=s1>&#39;SET row_security = on&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>req</span><span class=p>.</span><span class=nx>db</span><span class=p>.</span><span class=nx>query</span><span class=p>(</span><span class=s1>&#39;SET current_tenant = $1&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>req</span><span class=p>.</span><span class=nx>tenant</span><span class=p>.</span><span class=nx>id</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Invalid tenant context&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 테넌트별 재고 조회 API
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/api/inventory&#39;</span><span class=p>,</span> <span class=nx>tenantMiddleware</span><span class=p>,</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// RLS가 자동으로 테넌트 필터 적용
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>inventory</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>req</span><span class=p>.</span><span class=nx>db</span><span class=p>.</span><span class=nx>query</span><span class=p>(</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>            SELECT product_id, quantity, location 
</span></span></span><span class=line><span class=cl><span class=sb>            FROM inventory 
</span></span></span><span class=line><span class=cl><span class=sb>            WHERE status = &#39;active&#39;
</span></span></span><span class=line><span class=cl><span class=sb>        `</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>(</span><span class=nx>inventory</span><span class=p>.</span><span class=nx>rows</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>500</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Database error&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Redis 캐시 (테넌트별 네임스페이스)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>getCacheKey</span> <span class=o>=</span> <span class=p>(</span><span class=nx>tenantId</span><span class=p>,</span> <span class=nx>key</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=sb>`tenant:</span><span class=si>${</span><span class=nx>tenantId</span><span class=si>}</span><span class=sb>:</span><span class=si>${</span><span class=nx>key</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cacheGet</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>tenantId</span><span class=p>,</span> <span class=nx>key</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kr>await</span> <span class=nx>redis</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>getCacheKey</span><span class=p>(</span><span class=nx>tenantId</span><span class=p>,</span> <span class=nx>key</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cacheSet</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>tenantId</span><span class=p>,</span> <span class=nx>key</span><span class=p>,</span> <span class=nx>value</span><span class=p>,</span> <span class=nx>ttl</span> <span class=o>=</span> <span class=mi>3600</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kr>await</span> <span class=nx>redis</span><span class=p>.</span><span class=nx>setex</span><span class=p>(</span><span class=nx>getCacheKey</span><span class=p>(</span><span class=nx>tenantId</span><span class=p>,</span> <span class=nx>key</span><span class=p>),</span> <span class=nx>ttl</span><span class=p>,</span> <span class=nx>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-3-saas-회계-서비스>사례 3: SaaS 회계 서비스<a hidden class=anchor aria-hidden=true href=#사례-3-saas-회계-서비스>#</a></h4><p><strong>시나리오</strong>: 다수 기업에 SaaS 회계 서비스를 제공하는 클라우드 애플리케이션. 각 기업의 데이터는 완전히 분리 (스키마/테이블 기반), 테넌트별 맞춤 기능 지원, 통합 인증/권한 제어.</p><p><strong>시스템 구성</strong>:</p><ul><li>프론트엔드: 테넌트별 로그인, UI 커스텀 마이징</li><li>API 서버: 테넌트 인증 및 데이터 접근 제어</li><li>데이터베이스: 테넌트별 스키마/테이블/행 분리</li><li>모니터링 및 관리 시스템</li></ul><pre class=mermaid>graph TD
    A[User/Company A] --&gt; B[Custom UI/API]
    A2[User/Company B] --&gt; B2[Custom UI/API]
    B -- Tenant Auth --&gt; C[App Logic]
    B2 -- Tenant Auth --&gt; C
    C -- Schema A --&gt; D[DB Schema A]
    C -- Schema B --&gt; D2[DB Schema B]
    C -.-&gt; E[Monitoring &amp; Management]
</pre><p><strong>Workflow</strong>:</p><ul><li>사용자는 테넌트 지정 로그인 → 인증 → 요청마다 테넌트 식별 → 해당 데이터만 접근 → 커스텀 기능만 보임</li></ul><p><strong>역할</strong>:</p><ul><li>사용자 인증 및 권한 제어, 테넌트별 데이터 보장, 비용 절감, 빠른 신규 서비스 도입</li></ul><p><strong>유무에 따른 차이점</strong>:</p><ul><li>멀티테넌시 적용 시 신규 고객 추가·자원 확장이 손쉽고 비용이 절감됨</li><li>미적용 시 각 테넌트 별도 시스템·DB 필요, 관리 복잡도·비용 증가</li></ul><p><strong>구현 예시</strong>: Python + PostgreSQL Row Level Security</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-29-1><a class=lnlinks href=#hl-29-1> 1</a>
</span><span class=lnt id=hl-29-2><a class=lnlinks href=#hl-29-2> 2</a>
</span><span class=lnt id=hl-29-3><a class=lnlinks href=#hl-29-3> 3</a>
</span><span class=lnt id=hl-29-4><a class=lnlinks href=#hl-29-4> 4</a>
</span><span class=lnt id=hl-29-5><a class=lnlinks href=#hl-29-5> 5</a>
</span><span class=lnt id=hl-29-6><a class=lnlinks href=#hl-29-6> 6</a>
</span><span class=lnt id=hl-29-7><a class=lnlinks href=#hl-29-7> 7</a>
</span><span class=lnt id=hl-29-8><a class=lnlinks href=#hl-29-8> 8</a>
</span><span class=lnt id=hl-29-9><a class=lnlinks href=#hl-29-9> 9</a>
</span><span class=lnt id=hl-29-10><a class=lnlinks href=#hl-29-10>10</a>
</span><span class=lnt id=hl-29-11><a class=lnlinks href=#hl-29-11>11</a>
</span><span class=lnt id=hl-29-12><a class=lnlinks href=#hl-29-12>12</a>
</span><span class=lnt id=hl-29-13><a class=lnlinks href=#hl-29-13>13</a>
</span><span class=lnt id=hl-29-14><a class=lnlinks href=#hl-29-14>14</a>
</span><span class=lnt id=hl-29-15><a class=lnlinks href=#hl-29-15>15</a>
</span><span class=lnt id=hl-29-16><a class=lnlinks href=#hl-29-16>16</a>
</span><span class=lnt id=hl-29-17><a class=lnlinks href=#hl-29-17>17</a>
</span><span class=lnt id=hl-29-18><a class=lnlinks href=#hl-29-18>18</a>
</span><span class=lnt id=hl-29-19><a class=lnlinks href=#hl-29-19>19</a>
</span><span class=lnt id=hl-29-20><a class=lnlinks href=#hl-29-20>20</a>
</span><span class=lnt id=hl-29-21><a class=lnlinks href=#hl-29-21>21</a>
</span><span class=lnt id=hl-29-22><a class=lnlinks href=#hl-29-22>22</a>
</span><span class=lnt id=hl-29-23><a class=lnlinks href=#hl-29-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># PostgreSQL에서 테넌트별 데이터 RLS 적용 예시</span>
</span></span><span class=line><span class=cl><span class=o>--</span> <span class=n>테넌트</span> <span class=nb>id</span> <span class=n>필드를</span> <span class=n>포함한</span> <span class=n>테이블</span> <span class=n>생성</span>
</span></span><span class=line><span class=cl><span class=n>CREATE</span> <span class=n>TABLE</span> <span class=n>records</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span> <span class=n>SERIAL</span> <span class=n>PRIMARY</span> <span class=n>KEY</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant_id</span> <span class=n>INT</span> <span class=n>NOT</span> <span class=n>NULL</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=n>TEXT</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>--</span> <span class=n>row</span><span class=o>-</span><span class=n>level</span> <span class=n>security</span> <span class=n>정책</span> <span class=n>활성화</span>
</span></span><span class=line><span class=cl><span class=n>ALTER</span> <span class=n>TABLE</span> <span class=n>records</span> <span class=n>ENABLE</span> <span class=n>ROW</span> <span class=n>LEVEL</span> <span class=n>SECURITY</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>--</span> <span class=n>RLS</span> <span class=n>정책</span> <span class=n>정의</span><span class=p>:</span> <span class=n>자신의</span> <span class=n>테넌트</span> <span class=n>데이터만</span> <span class=n>접근</span> <span class=n>가능</span>
</span></span><span class=line><span class=cl><span class=n>CREATE</span> <span class=n>POLICY</span> <span class=n>tenant_isolation_policy</span> <span class=n>ON</span> <span class=n>records</span>
</span></span><span class=line><span class=cl>    <span class=n>USING</span> <span class=p>(</span><span class=n>tenant_id</span> <span class=o>=</span> <span class=n>current_setting</span><span class=p>(</span><span class=s1>&#39;app.current_tenant&#39;</span><span class=p>)::</span><span class=n>INT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>--</span> <span class=n>코드에서</span> <span class=n>쿼리</span> <span class=n>실행</span> <span class=n>전</span> <span class=n>테넌트</span> <span class=n>정보</span> <span class=n>설정</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>psycopg2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>run_as_tenant</span><span class=p>(</span><span class=n>tenant_id</span><span class=p>,</span> <span class=n>sql</span><span class=p>,</span> <span class=n>params</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=n>psycopg2</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=o>...</span><span class=p>)</span> <span class=k>as</span> <span class=n>conn</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=n>conn</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span> <span class=k>as</span> <span class=n>cur</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>cur</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;SET app.current_tenant = </span><span class=si>{</span><span class=n>tenant_id</span><span class=si>}</span><span class=s2>;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>cur</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>sql</span><span class=p>,</span> <span class=n>params</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-4-진료-기록-saas>사례 4: 진료 기록 SaaS<a hidden class=anchor aria-hidden=true href=#사례-4-진료-기록-saas>#</a></h4><p><strong>시나리오</strong>: 여러 병원에 진료 기록 SaaS 를 제공하면서 테넌트별 데이터 격리와 맞춤 UI 를 지원</p><p><strong>시스템 구성</strong>:</p><ul><li>공통 API 게이트웨이</li><li>Flask 기반 REST 서비스</li><li>PostgreSQL - Separate Schema 방식</li><li>Redis 캐시</li><li>Vault 로 암호화 키 관리</li></ul><pre class=mermaid>graph TD
  PatientClient --&gt; API_Gateway
  API_Gateway --&gt; TenantMiddleware
  TenantMiddleware --&gt; FlaskService
  FlaskService --&gt; Pg[PostgreSQL]
  Pg --&gt; Schema_TenantA
  Pg --&gt; Schema_TenantB
  FlaskService --&gt; RedisCache
  FlaskService --&gt; Vault[Key Vault]
</pre><p><strong>Workflow</strong>:</p><ul><li>클라이언트 인증 → API Gateway → Middleware 로 테넌트 식별 → Schema 기반 쿼리 수행 → 캐시 조회/비즈니스 로직 실행 → 응답 반환</li></ul><p><strong>역할</strong>:</p><ul><li>Middleware 는 테넌트 컨텍스트 관리</li><li>FlaskService 는 테넌트 -aware 비즈니스 로직 수행</li><li>Separate Schema 는 테넌트 간 데이터 독립성 보장</li><li>Vault 는 암호화 키 안전 관리</li></ul><p><strong>유무에 따른 차이점</strong>:</p><ul><li><strong>있을 경우</strong>: 병원별 데이터 철저 분리, 맞춤 UI 가능, 보안 감사 가능</li><li><strong>없을 경우</strong>: 데이터 혼합 위험, 보안 취약, 병원 요구사항 대응 어려움</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-31-1><a class=lnlinks href=#hl-31-1> 1</a>
</span><span class=lnt id=hl-31-2><a class=lnlinks href=#hl-31-2> 2</a>
</span><span class=lnt id=hl-31-3><a class=lnlinks href=#hl-31-3> 3</a>
</span><span class=lnt id=hl-31-4><a class=lnlinks href=#hl-31-4> 4</a>
</span><span class=lnt id=hl-31-5><a class=lnlinks href=#hl-31-5> 5</a>
</span><span class=lnt id=hl-31-6><a class=lnlinks href=#hl-31-6> 6</a>
</span><span class=lnt id=hl-31-7><a class=lnlinks href=#hl-31-7> 7</a>
</span><span class=lnt id=hl-31-8><a class=lnlinks href=#hl-31-8> 8</a>
</span><span class=lnt id=hl-31-9><a class=lnlinks href=#hl-31-9> 9</a>
</span><span class=lnt id=hl-31-10><a class=lnlinks href=#hl-31-10>10</a>
</span><span class=lnt id=hl-31-11><a class=lnlinks href=#hl-31-11>11</a>
</span><span class=lnt id=hl-31-12><a class=lnlinks href=#hl-31-12>12</a>
</span><span class=lnt id=hl-31-13><a class=lnlinks href=#hl-31-13>13</a>
</span><span class=lnt id=hl-31-14><a class=lnlinks href=#hl-31-14>14</a>
</span><span class=lnt id=hl-31-15><a class=lnlinks href=#hl-31-15>15</a>
</span><span class=lnt id=hl-31-16><a class=lnlinks href=#hl-31-16>16</a>
</span><span class=lnt id=hl-31-17><a class=lnlinks href=#hl-31-17>17</a>
</span><span class=lnt id=hl-31-18><a class=lnlinks href=#hl-31-18>18</a>
</span><span class=lnt id=hl-31-19><a class=lnlinks href=#hl-31-19>19</a>
</span><span class=lnt id=hl-31-20><a class=lnlinks href=#hl-31-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># middleware.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>request</span><span class=p>,</span> <span class=n>g</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>tenant_middleware</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>token</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;Authorization&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant_id</span> <span class=o>=</span> <span class=n>parse_tenant_from_token</span><span class=p>(</span><span class=n>token</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>tenant_id</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>abort</span><span class=p>(</span><span class=mi>401</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>g</span><span class=o>.</span><span class=n>tenant_id</span> <span class=o>=</span> <span class=n>tenant_id</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># service.py</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_patient_records</span><span class=p>(</span><span class=n>patient_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>tid</span> <span class=o>=</span> <span class=n>g</span><span class=o>.</span><span class=n>tenant_id</span>
</span></span><span class=line><span class=cl>    <span class=c1># 테넌트별 schema 지정</span>
</span></span><span class=line><span class=cl>    <span class=n>query</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;SELECT * FROM schema_</span><span class=si>{</span><span class=n>tid</span><span class=si>}</span><span class=s2>.patient WHERE id=%s&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>db</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=p>(</span><span class=n>patient_id</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># customization.py</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_dashboard_settings</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>tid</span> <span class=o>=</span> <span class=n>g</span><span class=o>.</span><span class=n>tenant_id</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>customization_store</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>tid</span><span class=p>,</span> <span class=n>default_settings</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-5-saas-기반-프로젝트-관리-플랫폼>사례 5: SaaS 기반 프로젝트 관리 플랫폼<a hidden class=anchor aria-hidden=true href=#사례-5-saas-기반-프로젝트-관리-플랫폼>#</a></h4><p><strong>시나리오</strong>: 글로벌 SaaS 기반 프로젝트 관리 플랫폼</p><p><strong>시스템 구성</strong>:</p><ul><li>Frontend: React 기반 웹 애플리케이션 (테넌트별 브랜딩)</li><li>API Gateway: Kong 또는 AWS API Gateway (테넌트 라우팅)</li><li>Backend Services: Node.js 마이크로서비스 (Docker 컨테이너)</li><li>Database: PostgreSQL (테넌트별 스키마 분리)</li><li>Cache: Redis (테넌트별 네임스페이스)</li><li>Message Queue: Apache Kafka (테넌트 태깅)</li><li>Monitoring: Prometheus + Grafana (테넌트별 메트릭)</li></ul><pre class=mermaid>graph TB
    subgraph &#34;Client Layer&#34;
        WEB[Web App - Tenant A]
        WEB2[Web App - Tenant B]
    end
    
    subgraph &#34;API Layer&#34;
        GATEWAY[API Gateway]
        AUTH[Auth Service]
    end
    
    subgraph &#34;Service Layer&#34;
        PROJECT[Project Service]
        USER[User Service]
        NOTIFY[Notification Service]
    end
    
    subgraph &#34;Data Layer&#34;
        DB[(PostgreSQL)]
        REDIS[(Redis Cache)]
        KAFKA[Kafka Queue]
    end
    
    WEB --&gt; GATEWAY
    WEB2 --&gt; GATEWAY
    GATEWAY --&gt; AUTH
    GATEWAY --&gt; PROJECT
    GATEWAY --&gt; USER
    GATEWAY --&gt; NOTIFY
    
    PROJECT --&gt; DB
    USER --&gt; DB
    NOTIFY --&gt; KAFKA
    
    PROJECT --&gt; REDIS
    USER --&gt; REDIS
</pre><p><strong>Workflow</strong>:</p><ul><li>사용자 로그인 → 테넌트 식별 → JWT 토큰에 테넌트 ID 포함</li><li>API 요청 → 게이트웨이에서 테넌트 검증 → 해당 스키마로 라우팅</li><li>데이터 조회 → 테넌트별 스키마에서 데이터 반환</li><li>알림 발송 → 테넌트별 설정에 따른 개인화된 메시지</li></ul><p><strong>역할</strong>:</p><ul><li><strong>API Gateway</strong>: 테넌트 식별과 라우팅, 인증 및 Rate Limiting</li><li><strong>마이크로서비스</strong>: 테넌트 컨텍스트 유지하며 비즈니스 로직 처리</li><li><strong>데이터베이스</strong>: 스키마별 데이터 격리와 테넌트별 설정 저장</li><li><strong>캐시 시스템</strong>: 테넌트별 세션 관리와 성능 최적화</li></ul><p><strong>유무에 따른 차이점</strong>:</p><ul><li><strong>Multi-tenancy 적용</strong>: 100 개 테넌트를 1 개 인스턴스로 서비스, 월 운영비 $10,000</li><li><strong>Single-tenancy</strong>: 100 개 독립 인스턴스 필요, 월 운영비 $150,000</li><li><strong>확장성</strong>: 새 테넌트 추가 시 5 분 vs 2-3 일 소요</li><li><strong>유지보수</strong>: 1 회 배포로 모든 테넌트 업데이트 vs 100 회 개별 배포</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-33-1><a class=lnlinks href=#hl-33-1> 1</a>
</span><span class=lnt id=hl-33-2><a class=lnlinks href=#hl-33-2> 2</a>
</span><span class=lnt id=hl-33-3><a class=lnlinks href=#hl-33-3> 3</a>
</span><span class=lnt id=hl-33-4><a class=lnlinks href=#hl-33-4> 4</a>
</span><span class=lnt id=hl-33-5><a class=lnlinks href=#hl-33-5> 5</a>
</span><span class=lnt id=hl-33-6><a class=lnlinks href=#hl-33-6> 6</a>
</span><span class=lnt id=hl-33-7><a class=lnlinks href=#hl-33-7> 7</a>
</span><span class=lnt id=hl-33-8><a class=lnlinks href=#hl-33-8> 8</a>
</span><span class=lnt id=hl-33-9><a class=lnlinks href=#hl-33-9> 9</a>
</span><span class=lnt id=hl-33-10><a class=lnlinks href=#hl-33-10>10</a>
</span><span class=lnt id=hl-33-11><a class=lnlinks href=#hl-33-11>11</a>
</span><span class=lnt id=hl-33-12><a class=lnlinks href=#hl-33-12>12</a>
</span><span class=lnt id=hl-33-13><a class=lnlinks href=#hl-33-13>13</a>
</span><span class=lnt id=hl-33-14><a class=lnlinks href=#hl-33-14>14</a>
</span><span class=lnt id=hl-33-15><a class=lnlinks href=#hl-33-15>15</a>
</span><span class=lnt id=hl-33-16><a class=lnlinks href=#hl-33-16>16</a>
</span><span class=lnt id=hl-33-17><a class=lnlinks href=#hl-33-17>17</a>
</span><span class=lnt id=hl-33-18><a class=lnlinks href=#hl-33-18>18</a>
</span><span class=lnt id=hl-33-19><a class=lnlinks href=#hl-33-19>19</a>
</span><span class=lnt id=hl-33-20><a class=lnlinks href=#hl-33-20>20</a>
</span><span class=lnt id=hl-33-21><a class=lnlinks href=#hl-33-21>21</a>
</span><span class=lnt id=hl-33-22><a class=lnlinks href=#hl-33-22>22</a>
</span><span class=lnt id=hl-33-23><a class=lnlinks href=#hl-33-23>23</a>
</span><span class=lnt id=hl-33-24><a class=lnlinks href=#hl-33-24>24</a>
</span><span class=lnt id=hl-33-25><a class=lnlinks href=#hl-33-25>25</a>
</span><span class=lnt id=hl-33-26><a class=lnlinks href=#hl-33-26>26</a>
</span><span class=lnt id=hl-33-27><a class=lnlinks href=#hl-33-27>27</a>
</span><span class=lnt id=hl-33-28><a class=lnlinks href=#hl-33-28>28</a>
</span><span class=lnt id=hl-33-29><a class=lnlinks href=#hl-33-29>29</a>
</span><span class=lnt id=hl-33-30><a class=lnlinks href=#hl-33-30>30</a>
</span><span class=lnt id=hl-33-31><a class=lnlinks href=#hl-33-31>31</a>
</span><span class=lnt id=hl-33-32><a class=lnlinks href=#hl-33-32>32</a>
</span><span class=lnt id=hl-33-33><a class=lnlinks href=#hl-33-33>33</a>
</span><span class=lnt id=hl-33-34><a class=lnlinks href=#hl-33-34>34</a>
</span><span class=lnt id=hl-33-35><a class=lnlinks href=#hl-33-35>35</a>
</span><span class=lnt id=hl-33-36><a class=lnlinks href=#hl-33-36>36</a>
</span><span class=lnt id=hl-33-37><a class=lnlinks href=#hl-33-37>37</a>
</span><span class=lnt id=hl-33-38><a class=lnlinks href=#hl-33-38>38</a>
</span><span class=lnt id=hl-33-39><a class=lnlinks href=#hl-33-39>39</a>
</span><span class=lnt id=hl-33-40><a class=lnlinks href=#hl-33-40>40</a>
</span><span class=lnt id=hl-33-41><a class=lnlinks href=#hl-33-41>41</a>
</span><span class=lnt id=hl-33-42><a class=lnlinks href=#hl-33-42>42</a>
</span><span class=lnt id=hl-33-43><a class=lnlinks href=#hl-33-43>43</a>
</span><span class=lnt id=hl-33-44><a class=lnlinks href=#hl-33-44>44</a>
</span><span class=lnt id=hl-33-45><a class=lnlinks href=#hl-33-45>45</a>
</span><span class=lnt id=hl-33-46><a class=lnlinks href=#hl-33-46>46</a>
</span><span class=lnt id=hl-33-47><a class=lnlinks href=#hl-33-47>47</a>
</span><span class=lnt id=hl-33-48><a class=lnlinks href=#hl-33-48>48</a>
</span><span class=lnt id=hl-33-49><a class=lnlinks href=#hl-33-49>49</a>
</span><span class=lnt id=hl-33-50><a class=lnlinks href=#hl-33-50>50</a>
</span><span class=lnt id=hl-33-51><a class=lnlinks href=#hl-33-51>51</a>
</span><span class=lnt id=hl-33-52><a class=lnlinks href=#hl-33-52>52</a>
</span><span class=lnt id=hl-33-53><a class=lnlinks href=#hl-33-53>53</a>
</span><span class=lnt id=hl-33-54><a class=lnlinks href=#hl-33-54>54</a>
</span><span class=lnt id=hl-33-55><a class=lnlinks href=#hl-33-55>55</a>
</span><span class=lnt id=hl-33-56><a class=lnlinks href=#hl-33-56>56</a>
</span><span class=lnt id=hl-33-57><a class=lnlinks href=#hl-33-57>57</a>
</span><span class=lnt id=hl-33-58><a class=lnlinks href=#hl-33-58>58</a>
</span><span class=lnt id=hl-33-59><a class=lnlinks href=#hl-33-59>59</a>
</span><span class=lnt id=hl-33-60><a class=lnlinks href=#hl-33-60>60</a>
</span><span class=lnt id=hl-33-61><a class=lnlinks href=#hl-33-61>61</a>
</span><span class=lnt id=hl-33-62><a class=lnlinks href=#hl-33-62>62</a>
</span><span class=lnt id=hl-33-63><a class=lnlinks href=#hl-33-63>63</a>
</span><span class=lnt id=hl-33-64><a class=lnlinks href=#hl-33-64>64</a>
</span><span class=lnt id=hl-33-65><a class=lnlinks href=#hl-33-65>65</a>
</span><span class=lnt id=hl-33-66><a class=lnlinks href=#hl-33-66>66</a>
</span><span class=lnt id=hl-33-67><a class=lnlinks href=#hl-33-67>67</a>
</span><span class=lnt id=hl-33-68><a class=lnlinks href=#hl-33-68>68</a>
</span><span class=lnt id=hl-33-69><a class=lnlinks href=#hl-33-69>69</a>
</span><span class=lnt id=hl-33-70><a class=lnlinks href=#hl-33-70>70</a>
</span><span class=lnt id=hl-33-71><a class=lnlinks href=#hl-33-71>71</a>
</span><span class=lnt id=hl-33-72><a class=lnlinks href=#hl-33-72>72</a>
</span><span class=lnt id=hl-33-73><a class=lnlinks href=#hl-33-73>73</a>
</span><span class=lnt id=hl-33-74><a class=lnlinks href=#hl-33-74>74</a>
</span><span class=lnt id=hl-33-75><a class=lnlinks href=#hl-33-75>75</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Tenant Context Middleware</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TenantContextMiddleware</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>app</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>app</span> <span class=o>=</span> <span class=n>app</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=fm>__call__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>scope</span><span class=p>,</span> <span class=n>receive</span><span class=p>,</span> <span class=n>send</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Extract tenant from subdomain or header</span>
</span></span><span class=line><span class=cl>        <span class=n>host</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=n>scope</span><span class=p>[</span><span class=s2>&#34;headers&#34;</span><span class=p>])</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;host&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>tenant_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>extract_tenant_from_host</span><span class=p>(</span><span class=n>host</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Set tenant context for the request</span>
</span></span><span class=line><span class=cl>        <span class=n>scope</span><span class=p>[</span><span class=s2>&#34;tenant_id&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>tenant_id</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Add tenant to database connection</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=n>get_tenant_db_connection</span><span class=p>(</span><span class=n>tenant_id</span><span class=p>)</span> <span class=k>as</span> <span class=n>db</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>scope</span><span class=p>[</span><span class=s2>&#34;db&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>db</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>app</span><span class=p>(</span><span class=n>scope</span><span class=p>,</span> <span class=n>receive</span><span class=p>,</span> <span class=n>send</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>extract_tenant_from_host</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>host</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Extract from subdomain: tenant1.myapp.com</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;.&#34;</span> <span class=ow>in</span> <span class=n>host</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>host</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;.&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;default&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tenant-aware Database Service</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ProjectService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>db_connection</span><span class=p>,</span> <span class=n>tenant_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db</span> <span class=o>=</span> <span class=n>db_connection</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>tenant_id</span> <span class=o>=</span> <span class=n>tenant_id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>schema</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;tenant_</span><span class=si>{</span><span class=n>tenant_id</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>get_projects</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>query</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        SELECT * FROM </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>schema</span><span class=si>}</span><span class=s2>.projects 
</span></span></span><span class=line><span class=cl><span class=s2>        WHERE user_id = %s AND tenant_id = %s
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>fetch_all</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=p>[</span><span class=n>user_id</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>tenant_id</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>create_project</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>project_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>project_data</span><span class=p>[</span><span class=s2>&#34;tenant_id&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tenant_id</span>
</span></span><span class=line><span class=cl>        <span class=n>query</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        INSERT INTO </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>schema</span><span class=si>}</span><span class=s2>.projects 
</span></span></span><span class=line><span class=cl><span class=s2>        (name, description, tenant_id, created_at)
</span></span></span><span class=line><span class=cl><span class=s2>        VALUES (%s, %s, %s, %s)
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=n>project_data</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>project_data</span><span class=p>[</span><span class=s2>&#34;description&#34;</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>            <span class=n>project_data</span><span class=p>[</span><span class=s2>&#34;tenant_id&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tenant Configuration Management</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TenantConfigService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>redis_client</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>redis</span> <span class=o>=</span> <span class=n>redis_client</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>get_tenant_config</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tenant_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>config</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>redis</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;tenant:</span><span class=si>{</span><span class=n>tenant_id</span><span class=si>}</span><span class=s2>:config&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>config</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>config</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Fallback to database</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>load_config_from_db</span><span class=p>(</span><span class=n>tenant_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>update_tenant_config</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>tenant_id</span><span class=p>,</span> <span class=n>config</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Update cache</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>redis</span><span class=o>.</span><span class=n>set</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>f</span><span class=s2>&#34;tenant:</span><span class=si>{</span><span class=n>tenant_id</span><span class=si>}</span><span class=s2>:config&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>            <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>config</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>ex</span><span class=o>=</span><span class=mi>3600</span>  <span class=c1># 1 hour TTL</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Persist to database</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>save_config_to_db</span><span class=p>(</span><span class=n>tenant_id</span><span class=p>,</span> <span class=n>config</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-6-b2b-saas-서비스>사례 6: B2B SaaS 서비스<a hidden class=anchor aria-hidden=true href=#사례-6-b2b-saas-서비스>#</a></h4><p><strong>시나리오:</strong> 국내외 B2B SaaS 서비스에서, 고객사별로 데이터는 논리적으로 격리하고, 동일한 앱 인스턴스와 인프라를 공유함.</p><p><strong>시스템 구성:</strong></p><ul><li>공통 App 인스턴스</li><li>Shared DB, tenant_id 기반 row-level 데이터 분리</li><li>인증/인가 모듈</li><li>Logging, Monitoring, Billing 등</li></ul><pre class=mermaid>graph TD
    GW[API Gateway]
    APP[Shared App Instance]
    AUTH[Auth Service]
    DB[Shared DB]
    LOG[Log/Monitor]
    BILL[Billing Engine]

    GW --&gt; APP
    GW --&gt; AUTH
    APP --&gt; DB
    APP --&gt; LOG
    APP --&gt; BILL
</pre><p><strong>Workflow:</strong></p><ul><li>사용자가 GW 로 인증 요청</li><li>인증/인가 확인 후 App 에 접근</li><li>App 에서 tenant_id 로 데이터 분리 처리</li><li>운영, 장애 모니터링 및 과금도 tenant 단위로 수행</li></ul><p><strong>역할:</strong></p><ul><li>GW: 요청 라우팅 및 인증</li><li>APP: 서비스 로직 실행, 테넌트별 분기</li><li>DB: row-level 데이터 격리</li><li>LOG/BILL: 테넌트별 모니터링, 과금</li></ul><p><strong>유무에 따른 차이점:</strong></p><ul><li>미적용 시: 데이터 유출 가능성·비용 증가·운영 복잡성 증가.</li><li>적용 시: 보안적 데이터 분리·운영 효율화·비용 절감.</li></ul><p><strong>구현 예시</strong>: Python, Flask + SQLAlchemy</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-35-1><a class=lnlinks href=#hl-35-1> 1</a>
</span><span class=lnt id=hl-35-2><a class=lnlinks href=#hl-35-2> 2</a>
</span><span class=lnt id=hl-35-3><a class=lnlinks href=#hl-35-3> 3</a>
</span><span class=lnt id=hl-35-4><a class=lnlinks href=#hl-35-4> 4</a>
</span><span class=lnt id=hl-35-5><a class=lnlinks href=#hl-35-5> 5</a>
</span><span class=lnt id=hl-35-6><a class=lnlinks href=#hl-35-6> 6</a>
</span><span class=lnt id=hl-35-7><a class=lnlinks href=#hl-35-7> 7</a>
</span><span class=lnt id=hl-35-8><a class=lnlinks href=#hl-35-8> 8</a>
</span><span class=lnt id=hl-35-9><a class=lnlinks href=#hl-35-9> 9</a>
</span><span class=lnt id=hl-35-10><a class=lnlinks href=#hl-35-10>10</a>
</span><span class=lnt id=hl-35-11><a class=lnlinks href=#hl-35-11>11</a>
</span><span class=lnt id=hl-35-12><a class=lnlinks href=#hl-35-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 테넌트 분리 기반 쿼리 예시</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>g</span><span class=p>,</span> <span class=n>request</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy.orm</span> <span class=kn>import</span> <span class=n>Session</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_current_tenant</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 인증 미들웨어에서 tenant_id 추출 후 g.tenant에 저장</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>g</span><span class=o>.</span><span class=n>tenant</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fetch_user_data</span><span class=p>(</span><span class=n>user_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>db</span><span class=p>:</span> <span class=n>Session</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant_id</span> <span class=o>=</span> <span class=n>get_current_tenant</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># Row-level Security: tenant_id 필터 적용</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>db</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>User</span><span class=p>)</span><span class=o>.</span><span class=n>filter_by</span><span class=p>(</span><span class=nb>id</span><span class=o>=</span><span class=n>user_id</span><span class=p>,</span> <span class=n>tenant_id</span><span class=o>=</span><span class=n>tenant_id</span><span class=p>)</span><span class=o>.</span><span class=n>first</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-7-fastapi-기반-멀티테넌시-구조-설계>사례 7: FastAPI 기반 멀티테넌시 구조 설계<a hidden class=anchor aria-hidden=true href=#사례-7-fastapi-기반-멀티테넌시-구조-설계>#</a></h4><ul><li>Header 기반 테넌트 식별 (<code>X-Tenant-ID</code>)</li><li>SQLAlchemy + Dependency Injection 방식</li><li>Pydantic 모델 사용</li><li>Shared Schema 방식</li></ul><p><strong>구조</strong>:</p><pre class=mermaid>graph TD
  Client --&gt; API[FastAPI API]
  API --&gt; Middleware
  Middleware --&gt; ServiceLayer
  ServiceLayer --&gt; DBLayer[SQLAlchemy ORM]
  DBLayer --&gt; SharedDB[PostgreSQL]
</pre><p><strong>디렉토리 구조</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-37-1><a class=lnlinks href=#hl-37-1>1</a>
</span><span class=lnt id=hl-37-2><a class=lnlinks href=#hl-37-2>2</a>
</span><span class=lnt id=hl-37-3><a class=lnlinks href=#hl-37-3>3</a>
</span><span class=lnt id=hl-37-4><a class=lnlinks href=#hl-37-4>4</a>
</span><span class=lnt id=hl-37-5><a class=lnlinks href=#hl-37-5>5</a>
</span><span class=lnt id=hl-37-6><a class=lnlinks href=#hl-37-6>6</a>
</span><span class=lnt id=hl-37-7><a class=lnlinks href=#hl-37-7>7</a>
</span><span class=lnt id=hl-37-8><a class=lnlinks href=#hl-37-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>fastapi_app/
</span></span><span class=line><span class=cl>├── main.py
</span></span><span class=line><span class=cl>├── dependencies.py
</span></span><span class=line><span class=cl>├── db.py
</span></span><span class=line><span class=cl>├── models.py
</span></span><span class=line><span class=cl>├── schemas.py
</span></span><span class=line><span class=cl>└── routers/
</span></span><span class=line><span class=cl>    └── customer.py
</span></span></code></pre></td></tr></table></div></div><p><strong>코드 예시</strong>:</p><ul><li><p>main.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-38-1><a class=lnlinks href=#hl-38-1>1</a>
</span><span class=lnt id=hl-38-2><a class=lnlinks href=#hl-38-2>2</a>
</span><span class=lnt id=hl-38-3><a class=lnlinks href=#hl-38-3>3</a>
</span><span class=lnt id=hl-38-4><a class=lnlinks href=#hl-38-4>4</a>
</span><span class=lnt id=hl-38-5><a class=lnlinks href=#hl-38-5>5</a>
</span><span class=lnt id=hl-38-6><a class=lnlinks href=#hl-38-6>6</a>
</span><span class=lnt id=hl-38-7><a class=lnlinks href=#hl-38-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>routers</span> <span class=kn>import</span> <span class=n>customer</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dependencies</span> <span class=kn>import</span> <span class=n>tenant_dependency</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>(</span><span class=n>dependencies</span><span class=o>=</span><span class=p>[</span><span class=n>tenant_dependency</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>include_router</span><span class=p>(</span><span class=n>customer</span><span class=o>.</span><span class=n>router</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>dependencies.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-39-1><a class=lnlinks href=#hl-39-1> 1</a>
</span><span class=lnt id=hl-39-2><a class=lnlinks href=#hl-39-2> 2</a>
</span><span class=lnt id=hl-39-3><a class=lnlinks href=#hl-39-3> 3</a>
</span><span class=lnt id=hl-39-4><a class=lnlinks href=#hl-39-4> 4</a>
</span><span class=lnt id=hl-39-5><a class=lnlinks href=#hl-39-5> 5</a>
</span><span class=lnt id=hl-39-6><a class=lnlinks href=#hl-39-6> 6</a>
</span><span class=lnt id=hl-39-7><a class=lnlinks href=#hl-39-7> 7</a>
</span><span class=lnt id=hl-39-8><a class=lnlinks href=#hl-39-8> 8</a>
</span><span class=lnt id=hl-39-9><a class=lnlinks href=#hl-39-9> 9</a>
</span><span class=lnt id=hl-39-10><a class=lnlinks href=#hl-39-10>10</a>
</span><span class=lnt id=hl-39-11><a class=lnlinks href=#hl-39-11>11</a>
</span><span class=lnt id=hl-39-12><a class=lnlinks href=#hl-39-12>12</a>
</span><span class=lnt id=hl-39-13><a class=lnlinks href=#hl-39-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>Request</span><span class=p>,</span> <span class=n>HTTPException</span><span class=p>,</span> <span class=n>Depends</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>contextvars</span> <span class=kn>import</span> <span class=n>ContextVar</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tenant_context</span><span class=p>:</span> <span class=n>ContextVar</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=n>ContextVar</span><span class=p>(</span><span class=s2>&#34;tenant_id&#34;</span><span class=p>,</span> <span class=n>default</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>tenant_dependency</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant_id</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;X-Tenant-ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>tenant_id</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>400</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Missing tenant header&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant_context</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=n>tenant_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_current_tenant</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>tenant_context</span><span class=o>.</span><span class=n>get</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>db.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-40-1><a class=lnlinks href=#hl-40-1>1</a>
</span><span class=lnt id=hl-40-2><a class=lnlinks href=#hl-40-2>2</a>
</span><span class=lnt id=hl-40-3><a class=lnlinks href=#hl-40-3>3</a>
</span><span class=lnt id=hl-40-4><a class=lnlinks href=#hl-40-4>4</a>
</span><span class=lnt id=hl-40-5><a class=lnlinks href=#hl-40-5>5</a>
</span><span class=lnt id=hl-40-6><a class=lnlinks href=#hl-40-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy</span> <span class=kn>import</span> <span class=n>create_engine</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy.orm</span> <span class=kn>import</span> <span class=n>sessionmaker</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>SQLALCHEMY_DATABASE_URL</span> <span class=o>=</span> <span class=s2>&#34;postgresql://user:password@localhost/tenantdb&#34;</span>
</span></span><span class=line><span class=cl><span class=n>engine</span> <span class=o>=</span> <span class=n>create_engine</span><span class=p>(</span><span class=n>SQLALCHEMY_DATABASE_URL</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>SessionLocal</span> <span class=o>=</span> <span class=n>sessionmaker</span><span class=p>(</span><span class=n>autocommit</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>autoflush</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>bind</span><span class=o>=</span><span class=n>engine</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>models.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-41-1><a class=lnlinks href=#hl-41-1> 1</a>
</span><span class=lnt id=hl-41-2><a class=lnlinks href=#hl-41-2> 2</a>
</span><span class=lnt id=hl-41-3><a class=lnlinks href=#hl-41-3> 3</a>
</span><span class=lnt id=hl-41-4><a class=lnlinks href=#hl-41-4> 4</a>
</span><span class=lnt id=hl-41-5><a class=lnlinks href=#hl-41-5> 5</a>
</span><span class=lnt id=hl-41-6><a class=lnlinks href=#hl-41-6> 6</a>
</span><span class=lnt id=hl-41-7><a class=lnlinks href=#hl-41-7> 7</a>
</span><span class=lnt id=hl-41-8><a class=lnlinks href=#hl-41-8> 8</a>
</span><span class=lnt id=hl-41-9><a class=lnlinks href=#hl-41-9> 9</a>
</span><span class=lnt id=hl-41-10><a class=lnlinks href=#hl-41-10>10</a>
</span><span class=lnt id=hl-41-11><a class=lnlinks href=#hl-41-11>11</a>
</span><span class=lnt id=hl-41-12><a class=lnlinks href=#hl-41-12>12</a>
</span><span class=lnt id=hl-41-13><a class=lnlinks href=#hl-41-13>13</a>
</span><span class=lnt id=hl-41-14><a class=lnlinks href=#hl-41-14>14</a>
</span><span class=lnt id=hl-41-15><a class=lnlinks href=#hl-41-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy</span> <span class=kn>import</span> <span class=n>Column</span><span class=p>,</span> <span class=n>Integer</span><span class=p>,</span> <span class=n>String</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy.ext.declarative</span> <span class=kn>import</span> <span class=n>declarative_base</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dependencies</span> <span class=kn>import</span> <span class=n>get_current_tenant</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Base</span> <span class=o>=</span> <span class=n>declarative_base</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Customer</span><span class=p>(</span><span class=n>Base</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>__tablename__</span> <span class=o>=</span> <span class=s2>&#34;customers&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>Integer</span><span class=p>,</span> <span class=n>primary_key</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>String</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant_id</span> <span class=o>=</span> <span class=n>Column</span><span class=p>(</span><span class=n>String</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>filter_by_tenant</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>db</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>db</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=bp>cls</span><span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>tenant_id</span> <span class=o>==</span> <span class=n>get_current_tenant</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>routers/customer.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-42-1><a class=lnlinks href=#hl-42-1> 1</a>
</span><span class=lnt id=hl-42-2><a class=lnlinks href=#hl-42-2> 2</a>
</span><span class=lnt id=hl-42-3><a class=lnlinks href=#hl-42-3> 3</a>
</span><span class=lnt id=hl-42-4><a class=lnlinks href=#hl-42-4> 4</a>
</span><span class=lnt id=hl-42-5><a class=lnlinks href=#hl-42-5> 5</a>
</span><span class=lnt id=hl-42-6><a class=lnlinks href=#hl-42-6> 6</a>
</span><span class=lnt id=hl-42-7><a class=lnlinks href=#hl-42-7> 7</a>
</span><span class=lnt id=hl-42-8><a class=lnlinks href=#hl-42-8> 8</a>
</span><span class=lnt id=hl-42-9><a class=lnlinks href=#hl-42-9> 9</a>
</span><span class=lnt id=hl-42-10><a class=lnlinks href=#hl-42-10>10</a>
</span><span class=lnt id=hl-42-11><a class=lnlinks href=#hl-42-11>11</a>
</span><span class=lnt id=hl-42-12><a class=lnlinks href=#hl-42-12>12</a>
</span><span class=lnt id=hl-42-13><a class=lnlinks href=#hl-42-13>13</a>
</span><span class=lnt id=hl-42-14><a class=lnlinks href=#hl-42-14>14</a>
</span><span class=lnt id=hl-42-15><a class=lnlinks href=#hl-42-15>15</a>
</span><span class=lnt id=hl-42-16><a class=lnlinks href=#hl-42-16>16</a>
</span><span class=lnt id=hl-42-17><a class=lnlinks href=#hl-42-17>17</a>
</span><span class=lnt id=hl-42-18><a class=lnlinks href=#hl-42-18>18</a>
</span><span class=lnt id=hl-42-19><a class=lnlinks href=#hl-42-19>19</a>
</span><span class=lnt id=hl-42-20><a class=lnlinks href=#hl-42-20>20</a>
</span><span class=lnt id=hl-42-21><a class=lnlinks href=#hl-42-21>21</a>
</span><span class=lnt id=hl-42-22><a class=lnlinks href=#hl-42-22>22</a>
</span><span class=lnt id=hl-42-23><a class=lnlinks href=#hl-42-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>APIRouter</span><span class=p>,</span> <span class=n>Depends</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>db</span> <span class=kn>import</span> <span class=n>SessionLocal</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>models</span> <span class=kn>import</span> <span class=n>Customer</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pydantic</span> <span class=kn>import</span> <span class=n>BaseModel</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>router</span> <span class=o>=</span> <span class=n>APIRouter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CustomerCreate</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@router.post</span><span class=p>(</span><span class=s2>&#34;/customers&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_customer</span><span class=p>(</span><span class=n>data</span><span class=p>:</span> <span class=n>CustomerCreate</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span> <span class=o>=</span> <span class=n>SessionLocal</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant_id</span> <span class=o>=</span> <span class=n>get_current_tenant</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>new_customer</span> <span class=o>=</span> <span class=n>Customer</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=n>data</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=n>tenant_id</span><span class=o>=</span><span class=n>tenant_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>new_customer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=n>new_customer</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=n>new_customer</span><span class=o>.</span><span class=n>name</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@router.get</span><span class=p>(</span><span class=s2>&#34;/customers&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>list_customers</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span> <span class=o>=</span> <span class=n>SessionLocal</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>Customer</span><span class=o>.</span><span class=n>filter_by_tenant</span><span class=p>(</span><span class=n>db</span><span class=p>)</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h4 id=사례-8-flask--celery-로-테넌트별-비동기-작업-처리>사례 8: Flask + Celery 로 테넌트별 비동기 작업 처리<a hidden class=anchor aria-hidden=true href=#사례-8-flask--celery-로-테넌트별-비동기-작업-처리>#</a></h4><p><strong>시나리오</strong>:</p><ul><li>각 테넌트별 비동기 이메일 발송, 리포트 생성 등을 Celery 로 처리</li><li>테넌트 context 를 Task 에 전달하여 분기 처리</li></ul><p><strong>구조</strong>:</p><pre class=mermaid>graph TD
  Flask --&gt; CeleryTaskQueue --&gt; Worker
  Worker --&gt; DB
  Worker --&gt; EmailAPI
</pre><p><strong>디렉토리 구조</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-44-1><a class=lnlinks href=#hl-44-1>1</a>
</span><span class=lnt id=hl-44-2><a class=lnlinks href=#hl-44-2>2</a>
</span><span class=lnt id=hl-44-3><a class=lnlinks href=#hl-44-3>3</a>
</span><span class=lnt id=hl-44-4><a class=lnlinks href=#hl-44-4>4</a>
</span><span class=lnt id=hl-44-5><a class=lnlinks href=#hl-44-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>flask_app/
</span></span><span class=line><span class=cl>├── app.py
</span></span><span class=line><span class=cl>├── tasks.py
</span></span><span class=line><span class=cl>├── celery_worker.py
</span></span><span class=line><span class=cl>└── config.py
</span></span></code></pre></td></tr></table></div></div><p><strong>구현 예시</strong>:</p><ul><li><p>config.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-45-1><a class=lnlinks href=#hl-45-1>1</a>
</span><span class=lnt id=hl-45-2><a class=lnlinks href=#hl-45-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>broker_url</span> <span class=o>=</span> <span class=s1>&#39;redis://localhost:6379/0&#39;</span>
</span></span><span class=line><span class=cl><span class=n>result_backend</span> <span class=o>=</span> <span class=s1>&#39;redis://localhost:6379/0&#39;</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>tasks.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-46-1><a class=lnlinks href=#hl-46-1> 1</a>
</span><span class=lnt id=hl-46-2><a class=lnlinks href=#hl-46-2> 2</a>
</span><span class=lnt id=hl-46-3><a class=lnlinks href=#hl-46-3> 3</a>
</span><span class=lnt id=hl-46-4><a class=lnlinks href=#hl-46-4> 4</a>
</span><span class=lnt id=hl-46-5><a class=lnlinks href=#hl-46-5> 5</a>
</span><span class=lnt id=hl-46-6><a class=lnlinks href=#hl-46-6> 6</a>
</span><span class=lnt id=hl-46-7><a class=lnlinks href=#hl-46-7> 7</a>
</span><span class=lnt id=hl-46-8><a class=lnlinks href=#hl-46-8> 8</a>
</span><span class=lnt id=hl-46-9><a class=lnlinks href=#hl-46-9> 9</a>
</span><span class=lnt id=hl-46-10><a class=lnlinks href=#hl-46-10>10</a>
</span><span class=lnt id=hl-46-11><a class=lnlinks href=#hl-46-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>celery</span> <span class=kn>import</span> <span class=n>Celery</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>config</span> <span class=kn>import</span> <span class=n>broker_url</span><span class=p>,</span> <span class=n>result_backend</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>celery</span> <span class=o>=</span> <span class=n>Celery</span><span class=p>(</span><span class=vm>__name__</span><span class=p>,</span> <span class=n>broker</span><span class=o>=</span><span class=n>broker_url</span><span class=p>,</span> <span class=n>backend</span><span class=o>=</span><span class=n>result_backend</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@celery.task</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_email</span><span class=p>(</span><span class=n>tenant_id</span><span class=p>,</span> <span class=n>to</span><span class=p>,</span> <span class=n>subject</span><span class=p>,</span> <span class=n>body</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 테넌트 ID 기반 설정 분기</span>
</span></span><span class=line><span class=cl>    <span class=n>smtp_config</span> <span class=o>=</span> <span class=n>get_smtp_config</span><span class=p>(</span><span class=n>tenant_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=n>tenant_id</span><span class=si>}</span><span class=s2>] 이메일 발송: </span><span class=si>{</span><span class=n>to</span><span class=si>}</span><span class=s2> / </span><span class=si>{</span><span class=n>subject</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 실제 이메일 전송 로직 수행</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>app.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-47-1><a class=lnlinks href=#hl-47-1> 1</a>
</span><span class=lnt id=hl-47-2><a class=lnlinks href=#hl-47-2> 2</a>
</span><span class=lnt id=hl-47-3><a class=lnlinks href=#hl-47-3> 3</a>
</span><span class=lnt id=hl-47-4><a class=lnlinks href=#hl-47-4> 4</a>
</span><span class=lnt id=hl-47-5><a class=lnlinks href=#hl-47-5> 5</a>
</span><span class=lnt id=hl-47-6><a class=lnlinks href=#hl-47-6> 6</a>
</span><span class=lnt id=hl-47-7><a class=lnlinks href=#hl-47-7> 7</a>
</span><span class=lnt id=hl-47-8><a class=lnlinks href=#hl-47-8> 8</a>
</span><span class=lnt id=hl-47-9><a class=lnlinks href=#hl-47-9> 9</a>
</span><span class=lnt id=hl-47-10><a class=lnlinks href=#hl-47-10>10</a>
</span><span class=lnt id=hl-47-11><a class=lnlinks href=#hl-47-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tasks</span> <span class=kn>import</span> <span class=n>send_email</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/send-email&#34;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;POST&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>trigger_email</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant_id</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;X-Tenant-ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>send_email</span><span class=o>.</span><span class=n>delay</span><span class=p>(</span><span class=n>tenant_id</span><span class=p>,</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;to&#34;</span><span class=p>],</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;subject&#34;</span><span class=p>],</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;body&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;queued&#34;</span><span class=p>}),</span> <span class=mi>202</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>celery_worker.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-48-1><a class=lnlinks href=#hl-48-1>1</a>
</span><span class=lnt id=hl-48-2><a class=lnlinks href=#hl-48-2>2</a>
</span><span class=lnt id=hl-48-3><a class=lnlinks href=#hl-48-3>3</a>
</span><span class=lnt id=hl-48-4><a class=lnlinks href=#hl-48-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tasks</span> <span class=kn>import</span> <span class=n>celery</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>celery</span><span class=o>.</span><span class=n>worker_main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h4 id=사례-9-테넌트별-rbac-역할-기반-접근-제어>사례 9: 테넌트별 RBAC (역할 기반 접근 제어)<a hidden class=anchor aria-hidden=true href=#사례-9-테넌트별-rbac-역할-기반-접근-제어>#</a></h4><ul><li>각 테넌트 안에서 사용자에게 <strong>역할 (Role)</strong> 을 부여하고, 그 역할에 따라 <strong>자원 접근을 제한</strong></li><li>테넌트 간 사용자는 절대 교차 접근 불가</li></ul><p><strong>RBAC 모델 구조</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-49-1><a class=lnlinks href=#hl-49-1>1</a>
</span><span class=lnt id=hl-49-2><a class=lnlinks href=#hl-49-2>2</a>
</span><span class=lnt id=hl-49-3><a class=lnlinks href=#hl-49-3>3</a>
</span><span class=lnt id=hl-49-4><a class=lnlinks href=#hl-49-4>4</a>
</span><span class=lnt id=hl-49-5><a class=lnlinks href=#hl-49-5>5</a>
</span><span class=lnt id=hl-49-6><a class=lnlinks href=#hl-49-6>6</a>
</span><span class=lnt id=hl-49-7><a class=lnlinks href=#hl-49-7>7</a>
</span><span class=lnt id=hl-49-8><a class=lnlinks href=#hl-49-8>8</a>
</span><span class=lnt id=hl-49-9><a class=lnlinks href=#hl-49-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Role Table 예시</span>
</span></span><span class=line><span class=cl><span class=n>Role</span><span class=p>:</span> <span class=nb>id</span> <span class=o>|</span> <span class=n>name</span> <span class=o>|</span> <span class=n>tenant_id</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># User Table</span>
</span></span><span class=line><span class=cl><span class=n>User</span><span class=p>:</span> <span class=nb>id</span> <span class=o>|</span> <span class=n>username</span> <span class=o>|</span> <span class=n>tenant_id</span> <span class=o>|</span> <span class=n>role_id</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Permission Table (선택)</span>
</span></span><span class=line><span class=cl><span class=n>Permission</span><span class=p>:</span> <span class=nb>id</span> <span class=o>|</span> <span class=n>action</span> <span class=o>|</span> <span class=n>resource</span>
</span></span><span class=line><span class=cl><span class=n>RolePermission</span><span class=p>:</span> <span class=n>role_id</span> <span class=o>|</span> <span class=n>permission_id</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>FastAPI 예시</strong>: RBAC + 테넌시 결합</p><ul><li><p>auth/rbac.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-50-1><a class=lnlinks href=#hl-50-1>1</a>
</span><span class=lnt id=hl-50-2><a class=lnlinks href=#hl-50-2>2</a>
</span><span class=lnt id=hl-50-3><a class=lnlinks href=#hl-50-3>3</a>
</span><span class=lnt id=hl-50-4><a class=lnlinks href=#hl-50-4>4</a>
</span><span class=lnt id=hl-50-5><a class=lnlinks href=#hl-50-5>5</a>
</span><span class=lnt id=hl-50-6><a class=lnlinks href=#hl-50-6>6</a>
</span><span class=lnt id=hl-50-7><a class=lnlinks href=#hl-50-7>7</a>
</span><span class=lnt id=hl-50-8><a class=lnlinks href=#hl-50-8>8</a>
</span><span class=lnt id=hl-50-9><a class=lnlinks href=#hl-50-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>HTTPException</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>has_permission</span><span class=p>(</span><span class=n>user</span><span class=p>,</span> <span class=n>permission</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>permission</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>user</span><span class=p>[</span><span class=s2>&#34;permissions&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>403</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Access denied&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>is_same_tenant</span><span class=p>(</span><span class=n>user</span><span class=p>,</span> <span class=n>tenant_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>user</span><span class=p>[</span><span class=s2>&#34;tenant_id&#34;</span><span class=p>]</span> <span class=o>!=</span> <span class=n>tenant_id</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span><span class=n>status_code</span><span class=o>=</span><span class=mi>403</span><span class=p>,</span> <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Tenant mismatch&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>main.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-51-1><a class=lnlinks href=#hl-51-1>1</a>
</span><span class=lnt id=hl-51-2><a class=lnlinks href=#hl-51-2>2</a>
</span><span class=lnt id=hl-51-3><a class=lnlinks href=#hl-51-3>3</a>
</span><span class=lnt id=hl-51-4><a class=lnlinks href=#hl-51-4>4</a>
</span><span class=lnt id=hl-51-5><a class=lnlinks href=#hl-51-5>5</a>
</span><span class=lnt id=hl-51-6><a class=lnlinks href=#hl-51-6>6</a>
</span><span class=lnt id=hl-51-7><a class=lnlinks href=#hl-51-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/admin/users&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_users</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>current_user</span><span class=p>:</span> <span class=nb>dict</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>get_current_user</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant_id</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;X-Tenant-ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>is_same_tenant</span><span class=p>(</span><span class=n>current_user</span><span class=p>,</span> <span class=n>tenant_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>has_permission</span><span class=p>(</span><span class=n>current_user</span><span class=p>,</span> <span class=s2>&#34;view_users&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># DB 조회 및 응답</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;message&#34;</span><span class=p>:</span> <span class=s2>&#34;Access granted&#34;</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><p><strong>Django 예시</strong>: RBAC + Middleware 기반</p><ul><li><p>models.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-52-1><a class=lnlinks href=#hl-52-1> 1</a>
</span><span class=lnt id=hl-52-2><a class=lnlinks href=#hl-52-2> 2</a>
</span><span class=lnt id=hl-52-3><a class=lnlinks href=#hl-52-3> 3</a>
</span><span class=lnt id=hl-52-4><a class=lnlinks href=#hl-52-4> 4</a>
</span><span class=lnt id=hl-52-5><a class=lnlinks href=#hl-52-5> 5</a>
</span><span class=lnt id=hl-52-6><a class=lnlinks href=#hl-52-6> 6</a>
</span><span class=lnt id=hl-52-7><a class=lnlinks href=#hl-52-7> 7</a>
</span><span class=lnt id=hl-52-8><a class=lnlinks href=#hl-52-8> 8</a>
</span><span class=lnt id=hl-52-9><a class=lnlinks href=#hl-52-9> 9</a>
</span><span class=lnt id=hl-52-10><a class=lnlinks href=#hl-52-10>10</a>
</span><span class=lnt id=hl-52-11><a class=lnlinks href=#hl-52-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Role</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ForeignKey</span><span class=p>(</span><span class=s2>&#34;Tenant&#34;</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=n>models</span><span class=o>.</span><span class=n>CASCADE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>(</span><span class=n>AbstractUser</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ForeignKey</span><span class=p>(</span><span class=s2>&#34;Tenant&#34;</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=n>models</span><span class=o>.</span><span class=n>CASCADE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>role</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ForeignKey</span><span class=p>(</span><span class=s2>&#34;Role&#34;</span><span class=p>,</span> <span class=n>on_delete</span><span class=o>=</span><span class=n>models</span><span class=o>.</span><span class=n>SET_NULL</span><span class=p>,</span> <span class=n>null</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Permission</span><span class=p>(</span><span class=n>models</span><span class=o>.</span><span class=n>Model</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>code</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>CharField</span><span class=p>(</span><span class=n>max_length</span><span class=o>=</span><span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>role</span> <span class=o>=</span> <span class=n>models</span><span class=o>.</span><span class=n>ManyToManyField</span><span class=p>(</span><span class=n>Role</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>decorators.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-53-1><a class=lnlinks href=#hl-53-1> 1</a>
</span><span class=lnt id=hl-53-2><a class=lnlinks href=#hl-53-2> 2</a>
</span><span class=lnt id=hl-53-3><a class=lnlinks href=#hl-53-3> 3</a>
</span><span class=lnt id=hl-53-4><a class=lnlinks href=#hl-53-4> 4</a>
</span><span class=lnt id=hl-53-5><a class=lnlinks href=#hl-53-5> 5</a>
</span><span class=lnt id=hl-53-6><a class=lnlinks href=#hl-53-6> 6</a>
</span><span class=lnt id=hl-53-7><a class=lnlinks href=#hl-53-7> 7</a>
</span><span class=lnt id=hl-53-8><a class=lnlinks href=#hl-53-8> 8</a>
</span><span class=lnt id=hl-53-9><a class=lnlinks href=#hl-53-9> 9</a>
</span><span class=lnt id=hl-53-10><a class=lnlinks href=#hl-53-10>10</a>
</span><span class=lnt id=hl-53-11><a class=lnlinks href=#hl-53-11>11</a>
</span><span class=lnt id=hl-53-12><a class=lnlinks href=#hl-53-12>12</a>
</span><span class=lnt id=hl-53-13><a class=lnlinks href=#hl-53-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.http</span> <span class=kn>import</span> <span class=n>JsonResponse</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>tenant_rbac</span><span class=p>(</span><span class=n>permission_code</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>decorator</span><span class=p>(</span><span class=n>view_func</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>_wrapped_view</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>user</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>user</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>user</span><span class=o>.</span><span class=n>tenant</span><span class=o>.</span><span class=n>id</span> <span class=o>!=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;X-Tenant-ID&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>JsonResponse</span><span class=p>({</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;Tenant mismatch&#34;</span><span class=p>},</span> <span class=n>status</span><span class=o>=</span><span class=mi>403</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>user</span><span class=o>.</span><span class=n>role</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>user</span><span class=o>.</span><span class=n>role</span><span class=o>.</span><span class=n>permission_set</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>code</span><span class=o>=</span><span class=n>permission_code</span><span class=p>)</span><span class=o>.</span><span class=n>exists</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>JsonResponse</span><span class=p>({</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;Access Denied&#34;</span><span class=p>},</span> <span class=n>status</span><span class=o>=</span><span class=mi>403</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>view_func</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>_wrapped_view</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>decorator</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>views.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-54-1><a class=lnlinks href=#hl-54-1>1</a>
</span><span class=lnt id=hl-54-2><a class=lnlinks href=#hl-54-2>2</a>
</span><span class=lnt id=hl-54-3><a class=lnlinks href=#hl-54-3>3</a>
</span><span class=lnt id=hl-54-4><a class=lnlinks href=#hl-54-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@tenant_rbac</span><span class=p>(</span><span class=s2>&#34;manage_users&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>admin_users</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 접근 허용된 사용자만 여기 도달</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><p><strong>RBAC 적용 팁</strong>:</p><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>역할 설계</td><td>테넌트마다 &ldquo;admin&rdquo;, &ldquo;editor&rdquo;, &ldquo;viewer&rdquo; 등 역할 명확히 구분</td></tr><tr><td>자원 보호</td><td>모든 뷰/API 에서 <code>테넌트 + 역할</code> 을 기준으로 체크 필요</td></tr><tr><td>정책 변경</td><td>테넌트 관리자에게 UI 제공하여 권한 변경 가능하게 함</td></tr><tr><td>시스템 관리자</td><td>글로벌 관리자 권한은 특별 케이스로 분기</td></tr></tbody></table><h4 id=사례-10-멀티테넌시-multi-tenancy-환경에서-celery-queue-분리-전략>사례 10: 멀티테넌시 (Multi-Tenancy) 환경에서 Celery Queue 분리 전략<a hidden class=anchor aria-hidden=true href=#사례-10-멀티테넌시-multi-tenancy-환경에서-celery-queue-분리-전략>#</a></h4><p><strong>시나리오</strong>: 멀티테넌시 (Multi-Tenancy) 환경에서 Celery Queue 분리 전략 (QoS 기반 Multi-Queue 구성) 에 대한 심화 설계</p><p><strong>목적</strong>:</p><ul><li>테넌트 간 비동기 작업 처리 충돌 방지</li><li>프리미엄/일반 고객 간 SLA 차등 적용 (속도, 우선순위)</li><li>큐를 통한 <strong>트래픽 분산</strong>, <strong>장애 격리</strong>, <strong>성능 보장</strong> 달성</li></ul><p><strong>아키텍처</strong>:</p><pre class=mermaid>graph TD
  UserA[Premium Tenant A] --&gt; API
  UserB[Basic Tenant B] --&gt; API
  API --&gt; Redis
  Redis --&gt; CeleryWorkerHigh[celery@premium_queue]
  Redis --&gt; CeleryWorkerLow[celery@basic_queue]
  CeleryWorkerHigh --&gt; DB
  CeleryWorkerLow --&gt; DB
</pre><ul><li>Premium 테넌트 요청은 <code>premium_queue</code> 로 분리 처리</li><li>일반 테넌트는 <code>basic_queue</code> 에서 후순위로 처리</li><li>각 워커는 독립적인 처리 성능, 우선순위 설정 가능</li></ul><p><strong>설정 및 구성 전략</strong>:</p><ol><li><p>Celery 작업 큐 선언 (FastAPI / Django 공통)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-56-1><a class=lnlinks href=#hl-56-1> 1</a>
</span><span class=lnt id=hl-56-2><a class=lnlinks href=#hl-56-2> 2</a>
</span><span class=lnt id=hl-56-3><a class=lnlinks href=#hl-56-3> 3</a>
</span><span class=lnt id=hl-56-4><a class=lnlinks href=#hl-56-4> 4</a>
</span><span class=lnt id=hl-56-5><a class=lnlinks href=#hl-56-5> 5</a>
</span><span class=lnt id=hl-56-6><a class=lnlinks href=#hl-56-6> 6</a>
</span><span class=lnt id=hl-56-7><a class=lnlinks href=#hl-56-7> 7</a>
</span><span class=lnt id=hl-56-8><a class=lnlinks href=#hl-56-8> 8</a>
</span><span class=lnt id=hl-56-9><a class=lnlinks href=#hl-56-9> 9</a>
</span><span class=lnt id=hl-56-10><a class=lnlinks href=#hl-56-10>10</a>
</span><span class=lnt id=hl-56-11><a class=lnlinks href=#hl-56-11>11</a>
</span><span class=lnt id=hl-56-12><a class=lnlinks href=#hl-56-12>12</a>
</span><span class=lnt id=hl-56-13><a class=lnlinks href=#hl-56-13>13</a>
</span><span class=lnt id=hl-56-14><a class=lnlinks href=#hl-56-14>14</a>
</span><span class=lnt id=hl-56-15><a class=lnlinks href=#hl-56-15>15</a>
</span><span class=lnt id=hl-56-16><a class=lnlinks href=#hl-56-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># tasks.py</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>celery</span> <span class=kn>import</span> <span class=n>Celery</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>celery</span> <span class=o>=</span> <span class=n>Celery</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;app&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>broker</span><span class=o>=</span><span class=s2>&#34;redis://localhost:6379/0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>backend</span><span class=o>=</span><span class=s2>&#34;redis://localhost:6379/1&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@celery.task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;tasks.send_email&#34;</span><span class=p>,</span> <span class=n>queue</span><span class=o>=</span><span class=s2>&#34;basic&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_email_basic</span><span class=p>(</span><span class=n>tenant_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[BASIC] Email task for </span><span class=si>{</span><span class=n>tenant_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@celery.task</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;tasks.send_email_premium&#34;</span><span class=p>,</span> <span class=n>queue</span><span class=o>=</span><span class=s2>&#34;premium&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>send_email_premium</span><span class=p>(</span><span class=n>tenant_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[PREMIUM] Email task for </span><span class=si>{</span><span class=n>tenant_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>워커 별 큐 구분 실행</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-57-1><a class=lnlinks href=#hl-57-1>1</a>
</span><span class=lnt id=hl-57-2><a class=lnlinks href=#hl-57-2>2</a>
</span><span class=lnt id=hl-57-3><a class=lnlinks href=#hl-57-3>3</a>
</span><span class=lnt id=hl-57-4><a class=lnlinks href=#hl-57-4>4</a>
</span><span class=lnt id=hl-57-5><a class=lnlinks href=#hl-57-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># basic 테넌트 전용 워커</span>
</span></span><span class=line><span class=cl>celery -A tasks worker --loglevel<span class=o>=</span>info -Q basic -n worker.basic
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># premium 테넌트 전용 워커 (우선 처리)</span>
</span></span><span class=line><span class=cl>celery -A tasks worker --loglevel<span class=o>=</span>info -Q premium -n worker.premium --concurrency<span class=o>=</span><span class=m>8</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>워커 간 <strong>컨커런시</strong> 수 차등 설정 가능 (<code>--concurrency</code>)</li><li>스케일링도 독립적 설정 (예: Premium 은 더 많은 worker pod)</li></ul></li><li><p>QoS 기반 분기 처리 (API 레이어)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-58-1><a class=lnlinks href=#hl-58-1> 1</a>
</span><span class=lnt id=hl-58-2><a class=lnlinks href=#hl-58-2> 2</a>
</span><span class=lnt id=hl-58-3><a class=lnlinks href=#hl-58-3> 3</a>
</span><span class=lnt id=hl-58-4><a class=lnlinks href=#hl-58-4> 4</a>
</span><span class=lnt id=hl-58-5><a class=lnlinks href=#hl-58-5> 5</a>
</span><span class=lnt id=hl-58-6><a class=lnlinks href=#hl-58-6> 6</a>
</span><span class=lnt id=hl-58-7><a class=lnlinks href=#hl-58-7> 7</a>
</span><span class=lnt id=hl-58-8><a class=lnlinks href=#hl-58-8> 8</a>
</span><span class=lnt id=hl-58-9><a class=lnlinks href=#hl-58-9> 9</a>
</span><span class=lnt id=hl-58-10><a class=lnlinks href=#hl-58-10>10</a>
</span><span class=lnt id=hl-58-11><a class=lnlinks href=#hl-58-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@app.post</span><span class=p>(</span><span class=s2>&#34;/notify&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>notify</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant_id</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;X-Tenant-ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>tenant_type</span> <span class=o>=</span> <span class=n>get_tenant_tier</span><span class=p>(</span><span class=n>tenant_id</span><span class=p>)</span>  <span class=c1># &#34;premium&#34; or &#34;basic&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>tenant_type</span> <span class=o>==</span> <span class=s2>&#34;premium&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>send_email_premium</span><span class=o>.</span><span class=n>delay</span><span class=p>(</span><span class=n>tenant_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>send_email_basic</span><span class=o>.</span><span class=n>delay</span><span class=p>(</span><span class=n>tenant_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;queued&#34;</span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>Redis 설정 최적화 (선택사항)</p><ul><li>Redis 는 하나의 브로커를 사용하되, 큐 이름 기준으로 논리적 격리</li><li>또는 Redis 클러스터 구성 시 큐별 물리적 분리 가능 (고급 QoS 필요 시)</li></ul></li></ol><p><strong>큐 분리 전략 설계</strong>:</p><table><thead><tr><th>항목</th><th>전략</th><th>설명</th></tr></thead><tbody><tr><td>큐 분리 기준</td><td>테넌트 등급 (Premium, Basic)</td><td>서비스 정책 기반 분리</td></tr><tr><td>워커 분리 방식</td><td><code>-Q</code> 파라미터로 큐명 지정</td><td>리소스 고립 + 스케일 자유</td></tr><tr><td>우선순위 보장</td><td>큐당 워커 컨커런시 차등화</td><td>Premium 처리 속도 보장</td></tr><tr><td>트래픽 보호</td><td>큐 오버로드 시 <code>prefetch_limit</code>, rate-limit</td><td>Redis QoS 기능 활용</td></tr><tr><td>장애 대응</td><td>큐별 retry 정책 개별 설정</td><td>Basic 은 느리게, Premium 은 즉시 재시도</td></tr><tr><td>멀티노드 분산 구성</td><td>Kubernetes + Horizontal Pod Autoscaler</td><td>큐별 오토스케일링 설정 가능</td></tr></tbody></table><p><strong>추가 고급 전략</strong>:</p><table><thead><tr><th>전략</th><th>설명</th></tr></thead><tbody><tr><td>Celery Routing (Task Router)</td><td><code>task_routes</code> 설정으로 동적 큐 지정 가능</td></tr><tr><td>Priority Queue (Redis Priority)</td><td>Celery 5.x 부터 <code>priority</code> 지원, 메모리 큐 사용</td></tr><tr><td>테넌트 샤딩 + 큐 분리</td><td>테넌트 별 task 처리 노드를 샤딩하고 전용 큐 할당</td></tr><tr><td>Dead-letter Queue 구성</td><td>특정 큐 실패 task 는 DLQ 로 이동 후 재처리</td></tr></tbody></table><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-59-1><a class=lnlinks href=#hl-59-1>1</a>
</span><span class=lnt id=hl-59-2><a class=lnlinks href=#hl-59-2>2</a>
</span><span class=lnt id=hl-59-3><a class=lnlinks href=#hl-59-3>3</a>
</span><span class=lnt id=hl-59-4><a class=lnlinks href=#hl-59-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>celery</span><span class=o>.</span><span class=n>conf</span><span class=o>.</span><span class=n>task_routes</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;tasks.*_premium&#34;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;queue&#34;</span><span class=p>:</span> <span class=s2>&#34;premium&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;tasks.*_basic&#34;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;queue&#34;</span><span class=p>:</span> <span class=s2>&#34;basic&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>운영 팁</strong>:</p><table><thead><tr><th>항목</th><th>권장 전략</th></tr></thead><tbody><tr><td>모니터링</td><td>Flower / Prometheus / Grafana 연동</td></tr><tr><td>로깅</td><td>테넌트 ID + Queue name 포함</td></tr><tr><td>Alerting</td><td>큐 backlog, 처리 시간 모니터링</td></tr><tr><td>Load Simulation</td><td><code>Locust</code>, <code>k6</code>, <code>Blazemeter</code> 등으로 멀티 큐 성능 테스트</td></tr><tr><td>큐 간 failover</td><td>Celery + kombu router 로 복구 로직 구현 가능</td></tr></tbody></table><hr><h2 id=정리-및-학습-가이드>정리 및 학습 가이드<a hidden class=anchor aria-hidden=true href=#정리-및-학습-가이드>#</a></h2><h3 id=내용-정리>내용 정리<a hidden class=anchor aria-hidden=true href=#내용-정리>#</a></h3><p><strong>멀티테넌시 (Multi-Tenancy)</strong> 는 단일 애플리케이션 인스턴스로 여러 고객 (테넌트) 을 서비스하는 SaaS 및 클라우드 환경의 핵심 아키텍처이다.<br>이 구조는 <strong>비용 효율성</strong>, <strong>빠른 확장성</strong>, <strong>유지보수 단순화</strong> 등의 이점을 제공하며, 핵심적으로 다음 원칙을 충족해야 한다:</p><ul><li><strong>테넌트 식별 및 격리</strong>: URL, Header, 토큰 등을 통한 식별과 DB/Schema/Row 수준의 격리</li><li><strong>성능 격리</strong>: 리소스 제한, Rate Limiting, HPA 등을 통한 스파이크 대응</li><li><strong>보안 및 규정 준수</strong>: GDPR, HIPAA 등 글로벌 법규 대응과 데이터 거주지 관리</li><li><strong>운영 자동화</strong>: Helm, Terraform, GitOps 기반 DevOps 파이프라인</li><li><strong>사용자 커스터마이징</strong>: 기능 플래그, 테마 분리, 정책 기반 기능 제한</li><li><strong>테넌트 수명주기 관리</strong>: Onboarding → Plan 관리 → Offboarding</li></ul><h4 id=최신-기술-동향-분석>최신 기술 동향 분석<a hidden class=anchor aria-hidden=true href=#최신-기술-동향-분석>#</a></h4><table><thead><tr><th>기술</th><th>동향 및 적용 방식</th></tr></thead><tbody><tr><td><strong>Kubernetes 기반 격리</strong></td><td>Namespace, ResourceQuota, NetworkPolicy 로 논리적/물리적 격리 구현</td></tr><tr><td><strong>Service Mesh</strong></td><td>Istio, Linkerd 를 통한 테넌트 트래픽 제어 및 가시성 확보</td></tr><tr><td><strong>플러그인 아키텍처</strong></td><td>테넌트별 확장 기능/모듈 동적 로딩 구조 적용</td></tr><tr><td><strong>서버리스 멀티테넌시</strong></td><td>Lambda, Cloud Functions 에서 함수 단위 격리 운영</td></tr><tr><td><strong>eBPF 기반 격리</strong></td><td>커널 수준 패킷 필터링으로 테넌트 간 네트워크 트래픽 분리</td></tr><tr><td><strong>AI/ML 활용</strong></td><td>테넌트별 사용 패턴 분석 → 이상 감지 및 정책 최적화</td></tr><tr><td><strong>멀티클라우드 대응</strong></td><td>CSP 간 테넌시 일관성 확보 위한 API 기반 연동 (e.g. GKE + AKS + EKS)</td></tr><tr><td><strong>자동화 도구</strong></td><td>Terraform Module, Helm Chart, ArgoCD, Kustomize 등으로 온보딩/배포 자동화</td></tr></tbody></table><h3 id=학습-항목-정리>학습 항목 정리<a hidden class=anchor aria-hidden=true href=#학습-항목-정리>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th><th>중요도</th></tr></thead><tbody><tr><td>아키텍처</td><td>분리 전략</td><td>스키마/DB/서버 분리</td><td>테넌트 별 논리적/물리적 분리를 통한 격리 구현</td><td>기본</td></tr><tr><td></td><td>설계 패턴</td><td>CQRS, Event Sourcing</td><td>명령/조회 분리 및 이벤트 로그 기반 상태 관리 구조</td><td>심화</td></tr><tr><td></td><td>API 라우팅</td><td>테넌트 기반 라우팅 전략</td><td>테넌트별 경로 분기 및 인증 연계 API 게이트웨이 패턴 적용</td><td>실무</td></tr><tr><td>데이터베이스</td><td>격리 방식</td><td>스키마/테이블/행 분리</td><td>성능/보안 요구사항에 따른 데이터베이스 논리적 분리 전략 선택</td><td>기본</td></tr><tr><td></td><td>분산 전략</td><td>샤딩, 파티셔닝</td><td>수평적 분산과 병렬 처리를 통한 확장성과 성능 확보</td><td>심화</td></tr><tr><td>인증/보안</td><td>인증/인가</td><td>OAuth 2.0, SAML Federation</td><td>테넌트별 사용자 인증 및 엔터프라이즈 통합 인증</td><td>기본</td></tr><tr><td></td><td>접근 제어</td><td>RBAC</td><td>리소스 수준에서 테넌트 간 경계 명확히 설정</td><td>실무</td></tr><tr><td></td><td>데이터 보호</td><td>암호화, 마스킹</td><td>저장/전송 데이터의 안전성 확보</td><td>기본</td></tr><tr><td>성능 최적화</td><td>캐싱 전략</td><td>멀티 레벨 캐시</td><td>Redis 등 활용한 테넌트/쿼리 기반 캐시 설계</td><td>실무</td></tr><tr><td></td><td>로드밸런싱</td><td>테넌트 인식 LB</td><td>테넌트 별 요청 분산으로 안정성 확보</td><td>실무</td></tr><tr><td>운영/DevOps</td><td>배포 자동화</td><td>CI/CD, Canary Release</td><td>기능 변경의 점진적 적용 및 테넌트별 롤백 지원</td><td>실무</td></tr><tr><td></td><td>인프라 관리</td><td>IaC, 프로비저닝 자동화</td><td>Terraform, Helm 등으로 구성 및 변경 관리</td><td>실무</td></tr><tr><td></td><td>모니터링/로깅</td><td>APM, 로그 격리</td><td>테넌트별 장애 추적 및 분석을 위한 메트릭, 로깅 분리</td><td>실무</td></tr><tr><td>컴플라이언스</td><td>데이터 규정</td><td>GDPR, HIPAA</td><td>데이터 위치/보관 정책 및 감사 기록 준수 체계 구축</td><td>기본</td></tr><tr><td>격리성</td><td>자원 경쟁 해결</td><td>Noise Neighbor 방지</td><td>리소스 쿼터, 우선순위 큐, 워크로드 분산 등으로 영향 최소화</td><td>실무</td></tr><tr><td>SLA 관리</td><td>서비스 수준</td><td>SLA 정책, 예측 스케일링</td><td>테넌트 중요도에 따른 성능 보장 및 ML 기반 자원 관리</td><td>심화</td></tr></tbody></table><ul><li><p><strong>아키텍처</strong>: 멀티테넌시 확장성과 유지보수를 위해 스키마/DB 분리 전략과 CQRS/Event 기반 설계는 핵심이다. 특히 API 게이트웨이 기반 라우팅은 실무 적용의 중심이 된다.</p></li><li><p><strong>보안</strong>: OAuth 2.0 및 SAML 기반 인증, RBAC 기반 접근 제어, 데이터 암호화/마스킹은 모든 멀티테넌시 환경에서 필수적인 보안 수단이다.</p></li><li><p><strong>데이터베이스</strong>: 테넌트 격리에 따른 스키마/테이블/행 분리 전략은 설계 초기부터 결정되어야 하며, 샤딩/파티셔닝은 고성능 운영의 열쇠다.</p></li><li><p><strong>운영/DevOps</strong>: 테넌트별 CI/CD 와 Canary Release 전략은 안전한 배포의 기본이며, IaC 기반 인프라 자동화는 유지보수 효율성을 높인다.</p></li><li><p><strong>성능 최적화</strong>: 캐싱, 로드밸런싱, 자원 분산을 통해 테넌트 증가에 따른 성능 저하를 방지할 수 있다.</p></li><li><p><strong>컴플라이언스</strong>: GDPR, HIPAA 같은 규정은 테넌시 구조의 설계 원칙에 영향을 주므로 초기에 반영해야 한다.</p></li><li><p><strong>격리성과 SLA</strong>: 노이즈 네이버 방지, 예측 기반 스케일링, 테넌트별 SLA 정책은 안정성과 신뢰성을 위한 필수 구성이다.</p></li></ul><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>대분류</th><th>중분류</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td><strong>1. 기본 개념</strong></td><td>구조 정의</td><td>Tenant</td><td>SaaS 시스템 내 개별 고객 단위 (조직, 기업, 사용자 집합 등)</td></tr><tr><td></td><td>구조 정의</td><td>Tenancy</td><td>테넌트들이 자원을 공유하는 방식과 정도</td></tr><tr><td></td><td>구조 정의</td><td>Multi-tenancy</td><td>하나의 시스템 인스턴스에서 여러 테넌트를 서비스하는 구조</td></tr><tr><td></td><td>식별자</td><td>Tenant ID</td><td>각 테넌트를 고유하게 식별하는 ID, 데이터 분리 및 라우팅에 사용</td></tr><tr><td></td><td>라우팅</td><td>Tenant-aware Routing</td><td>요청 시 어떤 테넌트인지 파악하여 적절히 처리</td></tr><tr><td></td><td>컨텍스트 전파</td><td>Tenant Context</td><td>요청 처리 과정에서 테넌트 정보를 유지/전파하는 메커니즘</td></tr><tr><td></td><td>데이터 분리</td><td>행 기반 분리</td><td><code>tenant_id</code> 필드를 통해 테이블을 논리적으로 분리</td></tr><tr><td></td><td>데이터 분리</td><td>스키마 분리</td><td>각 테넌트별 별도의 DB 스키마 운영</td></tr><tr><td></td><td>데이터 분리</td><td>데이터베이스 분리 (Separate DB)</td><td>각 테넌트가 독립된 DB 를 사용하는 구조</td></tr><tr><td><strong>2. 아키텍처</strong></td><td>분산/격리 전략</td><td>샤딩 (Sharding)</td><td>데이터를 수평으로 분할하여 여러 노드/DB 에 분산 저장</td></tr><tr><td></td><td>분산/격리 전략</td><td>파티셔닝 (Partitioning)</td><td>테이블을 논리적으로 나누는 방식</td></tr><tr><td></td><td>장애 전파 방지</td><td>벌크헤드 패턴 (Bulkhead Pattern)</td><td>장애가 전체 시스템에 영향을 주지 않도록 격리 설계</td></tr><tr><td></td><td>구성 전략</td><td>Control Plane</td><td>설정, 온보딩, 모니터링 등 중앙제어 영역</td></tr><tr><td></td><td>구성 전략</td><td>Data Plane</td><td>실제 애플리케이션의 요청 및 데이터 처리 영역</td></tr><tr><td></td><td>프로비저닝</td><td>자동 프로비저닝 (Auto Provisioning)</td><td>신규 테넌트 등록 및 자원 할당 자동화 절차</td></tr><tr><td><strong>3. 운영 전략</strong></td><td>성능</td><td>Noisy Neighbor</td><td>한 테넌트의 자원 과소비가 다른 테넌트에 악영향을 주는 현상</td></tr><tr><td></td><td>성능</td><td>스로틀링 (Throttling)</td><td>요청량을 제한하여 시스템 부하를 조절</td></tr><tr><td></td><td>성능</td><td>백프레셔 (Backpressure)</td><td>하위 시스템의 과부하를 상위로 전파하여 부하 제어</td></tr><tr><td></td><td>확장성</td><td>오토 스케일링 (Auto Scaling)</td><td>부하에 따라 리소스를 자동 확장 또는 축소</td></tr><tr><td></td><td>기능 제어</td><td>Feature Flag</td><td>테넌트별 기능 활성화/비활성화 조건 제어 기능</td></tr><tr><td></td><td>버전 관리</td><td>Canary Release</td><td>일부 테넌트에게만 변경 사항 배포하는 전략</td></tr><tr><td><strong>4. 보안 및 인증</strong></td><td>권한 제어</td><td>RBAC (Role-Based Access Control)</td><td>사용자 역할에 따른 권한 제어 정책</td></tr><tr><td></td><td>데이터 접근</td><td>RLS (Row-Level Security)</td><td>DB 수준에서 행 단위 접근 제어</td></tr><tr><td></td><td>인증 통합</td><td>SSO (Single Sign-On)</td><td>하나의 인증으로 여러 시스템 접근 가능</td></tr><tr><td></td><td>설계 철학</td><td>Zero Trust</td><td>모든 접근을 검증하는 보안 아키텍처</td></tr><tr><td></td><td>규제 준수</td><td>데이터 주권 (Data Sovereignty)</td><td>데이터 저장 위치의 법적 관할권 준수 요구사항</td></tr><tr><td></td><td>규제 준수</td><td>데이터 레지던시 (Data Residency)</td><td>데이터가 물리적으로 저장되는 위치의 규정 요구사항</td></tr><tr><td><strong>5. 관측 및 모니터링</strong></td><td>성능 모니터링</td><td>APM (Application Performance Monitoring)</td><td>애플리케이션 성능 및 지표를 실시간 추적</td></tr><tr><td></td><td>커널 수준 트레이싱</td><td>eBPF</td><td>리눅스 커널에서 안전한 고성능 데이터 수집 방식</td></tr><tr><td><strong>6. 구현 기술</strong></td><td>인프라 자동화</td><td>IaC (Infrastructure as Code)</td><td>인프라를 코드로 정의하고 자동화하는 DevOps 원칙</td></tr><tr><td></td><td>운영 도구</td><td>Helm, Terraform</td><td>IaC 도구로 Helm 은 Kubernetes, Terraform 은 클라우드 전체 대상</td></tr><tr><td></td><td>컨테이너 환경</td><td>컨테이너 오케스트레이션</td><td>Kubernetes 등으로 컨테이너 배포 및 확장 관리</td></tr><tr><td></td><td>서비스 프록시</td><td>서비스 메시 (Service Mesh)</td><td>마이크로서비스 간 트래픽, 인증, 로깅 등을 통합 제어</td></tr><tr><td><strong>7. 서비스 계약</strong></td><td>SLA</td><td>서비스 수준 계약</td><td>테넌트별 보장되는 성능/가용성/지원 수준 명시</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://workos.com/blog/what-is-multi-tenancy-pros-cons-best-practices>What is multi‑tenancy? Pros, cons, and best practices (WorkOS)</a></li><li><a href=https://www.bytebase.com/blog/multi-tenant-database-architecture-patterns-explained/>Multi-Tenant Database Architecture Patterns Explained (Bytebase)</a></li><li><a href=https://frontegg.com/guides/multi-tenant-architecture>Multi‑Tenant Architecture: How It Works, Pros, and Cons (Frontegg)</a></li><li><a href=https://learn.microsoft.com/en-us/azure/azure-sql/database/saas-tenancy-app-design-patterns>Multitenant SaaS patterns – Azure SQL Database (Microsoft)</a></li><li><a href=https://dev.to/shiviyer/how-to-build-multi-tenancy-in-postgresql-for-developing-saas-applications-p81>How to build multi‑tenancy in PostgreSQL for SaaS applications (dev.to)</a></li><li><a href=https://medium.com/@sohail_saifi/developing-multi-tenant-applications-challenges-and-best-practices-2cec1fc22e1f>Developing Multi‑Tenant Applications: Challenges and Best Practices (Medium)</a></li></ul><hr></div></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>