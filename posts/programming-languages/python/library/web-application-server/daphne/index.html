<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>daphne | hyunyoun's Blog</title><meta name=keywords content="Programming-Languages,Python,Library,Web-Application-Server,Daphne"><meta name=description content="Daphne는 Django Channels를 위해 개발된 HTTP, HTTP2 및 WebSocket 프로토콜 서버이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/daphne/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/daphne/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/daphne/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="daphne"><meta property="og:description" content="Daphne는 Django Channels를 위해 개발된 HTTP, HTTP2 및 WebSocket 프로토콜 서버이다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-30T08:44:00+00:00"><meta property="article:modified_time" content="2024-11-30T08:44:00+00:00"><meta property="article:tag" content="Programming-Languages"><meta property="article:tag" content="Python"><meta property="article:tag" content="Library"><meta property="article:tag" content="Web-Application-Server"><meta property="article:tag" content="Daphne"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="daphne"><meta name=twitter:description content="Daphne는 Django Channels를 위해 개발된 HTTP, HTTP2 및 WebSocket 프로토콜 서버이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Computer Science and Engineering","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Programming Languages","item":""},{"@type":"ListItem","position":3,"name":"Python","item":"https://buenhyden.github.io/posts/programming-languages/python/"},{"@type":"ListItem","position":4,"name":"Libraries of Python","item":""},{"@type":"ListItem","position":5,"name":"Python Web Application Server","item":"https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/"},{"@type":"ListItem","position":6,"name":"daphne","item":"https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/daphne/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"daphne","name":"daphne","description":"Daphne는 Django Channels를 위해 개발된 HTTP, HTTP2 및 WebSocket 프로토콜 서버이다.","keywords":["Programming-Languages","Python","Library","Web-Application-Server","Daphne"],"articleBody":"Daphne Daphne는 Django Channels를 위해 개발된 HTTP, HTTP2 및 WebSocket 프로토콜 서버이다.\nDjango 프로젝트 팀에 의해 유지 관리되며 ASGI(Asynchronous Server Gateway Interface) 서버의 참조 구현으로 작동한다.\nDjango Channels와 함께 사용할 때, Redis나 다른 백엔드를 channel layer로 사용하여 실시간 통신을 구현할 수 있다.\n이는 MongoDB의 Change Streams이나 MySQL의 CDC(Change Data Capture)와 같은 실시간 데이터 동기화 기능을 구현할 때 유용하다.\nDaphne의 주요 특징 프로토콜 지원: Daphne는 HTTP, HTTP2, WebSocket 프로토콜을 모두 지원한다. 자동 프로토콜 협상: Daphne는 들어오는 요청을 자동으로 분석하여 적절한 프로토콜로 처리한다. ASGI 호환성: ASGI 애플리케이션과 호환되며, 특히 Django Channels를 위해 설계되었다. 개발 및 프로덕션 사용: Daphne는 개발 환경과 프로덕션 환경 모두에서 사용할 수 있다. Daphne 설치 pip를 사용하여 Daphne를 설치한다:\n1 pip install daphne Django 프로젝트의 settings.py 파일에 Daphne를 추가한다:\n1 2 3 4 INSTALLED_APPS = [ 'daphne', # 다른 앱들… ] Daphne 설정 settings.py 파일에 ASGI 애플리케이션 설정을 추가한다:\n1 ASGI_APPLICATION = \"myproject.asgi:application\" 프로젝트의 asgi.py 파일을 다음과 같이 구성한다:\n1 2 3 4 5 6 import os from django.core.asgi import get_asgi_application os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'myproject.settings') application = get_asgi_application() Daphne 실행 Django 프로젝트에서 Daphne를 실행하려면 다음 명령을 사용한다:\n1 daphne myproject.asgi:application 기본적으로 Daphne는 localhost:8000에서 실행되지만, 바인딩 주소와 포트를 지정할 수 있다:\n1 daphne -b 0.0.0.0 -p 8001 myproject.asgi:application 주의사항 및 팁 정적 파일 처리: Daphne는 정적 파일 처리에 최적화되어 있지 않으므로, 프로덕션 환경에서는 Nginx와 같은 웹 서버를 함께 사용하는 것이 좋다. 환경 변수 설정: Daphne 실행 시 DJANGO_SETTINGS_MODULE 환경 변수를 설정해야 할 수 있다. 성능 고려사항: 대규모 프로덕션 환경에서는 여러 Daphne 인스턴스를 실행하고 로드 밸런서를 사용하는 것이 좋다. 보안: Daphne를 직접 인터넷에 노출시키는 것보다는 Nginx나 Apache와 같은 검증된 웹 서버 뒤에 두는 것이 보안상 좋다. 프로덕션 환경 설정 프로덕션 환경에서는 Daphne를 데몬으로 실행하고 Nginx와 함께 사용하는 것이 좋다:\nsystemd 서비스 파일을 생성하여 Daphne를 데몬으로 실행한다. Nginx를 리버스 프록시로 설정하여 정적 파일 처리와 요청 라우팅을 담당하게 한다. WebSocket 요청은 Nginx에서 Daphne로 프록시한다. Nginx와 함께 사용할 때는 다음과 같은 설정도 고려해야 한다:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # /etc/nginx/sites-available/myproject server { listen 80; server_name example.com; location / { proxy_pass http://0.0.0.0:8001; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \"upgrade\"; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; } } Daphne 환경 설정 Daphne의 설정은 크게 서버 동작, 성능, 보안, 로깅의 네 가지 카테고리로 나눌 수 있다.\n각각의 설정이 어떤 의미를 가지는지 살펴보겠습니다.\n다양한 설정 옵션 기본 서버 설정 이러한 설정들은 서버의 기본 동작을 결정한다.\n1 2 3 4 5 6 7 8 # daphne_settings.py DAPHNE_SERVER = { 'bind': '0.0.0.0', # 서버가 바인딩할 주소 'port': 8000, # 리스닝 포트 'unix_socket': '/tmp/daphne.sock', # Unix 소켓 경로 (선택적) 'fd': None, # 파일 디스크립터 (선택적) 'access_log': True, # 접근 로그 활성화 } 최적화 설정 성능과 관련된 설정들은 서버의 처리 능력과 응답 시간에 직접적인 영향을 미친다:\n1 2 3 4 5 6 7 8 # performance_settings.py DAPHNE_PERFORMANCE = { 'application_close_timeout': 10, # 애플리케이션 종료 대기 시간(초) 'websocket_timeout': 86400, # WebSocket 연결 타임아웃(초) 'http_timeout': 120, # HTTP 요청 타임아웃(초) 'ping_interval': 20, # WebSocket ping 간격(초) 'max_request_size': 1048576, # 최대 요청 크기(바이트) } 보안 설정 보안 관련 설정은 서버의 안전성을 확보하는 데 중요하다:\n1 2 3 4 5 6 7 8 # security_settings.py DAPHNE_SECURITY = { 'proxy_headers': True, # 프록시 헤더 처리 활성화 'ssl_cert_file': '/path/to/cert.pem', # SSL 인증서 경로 'ssl_key_file': '/path/to/key.pem', # SSL 키 파일 경로 'ssl_verify_client': False, # 클라이언트 인증서 검증 'websocket_handshake_timeout': 20, # WebSocket 핸드셰이크 타임아웃 } 로깅 설정 로깅은 서버 모니터링과 문제 해결에 필수적이다:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 # logging_settings.py import logging DAPHNE_LOGGING = { 'log_level': 'INFO', # 로그 레벨 설정 'access_log_format': '%(h)s %(l)s %(u)s %(t)s \"%(r)s\" %(s)s %(b)s \"%(f)s\" \"%(a)s\"', 'error_log': '/var/log/daphne/error.log', # 에러 로그 경로 'access_log': '/var/log/daphne/access.log', # 접근 로그 경로 'log_colors': True, # 로그 색상 활성화 } # 로그 핸들러 설정 logging.basicConfig( level=logging.INFO, format='%(asctime)s [%(levelname)s] %(message)s', handlers=[ logging.FileHandler('daphne.log'), logging.StreamHandler() ] ) Channel Layer 설정 Django Channels와 함께 사용할 때의 Channel Layer 설정이다:\n1 2 3 4 5 6 7 8 9 10 11 # channels_settings.py CHANNEL_LAYERS = { 'default': { 'BACKEND': 'channels_redis.core.RedisChannelLayer', 'CONFIG': { 'hosts': [('redis', 6379)], 'capacity': 1000, # 채널당 최대 메시지 수 'expiry': 60, # 메시지 만료 시간(초) }, }, } 리소스 관리 설정 시스템 리소스 사용과 관련된 설정:\n1 2 3 4 5 6 7 8 # resource_settings.py DAPHNE_RESOURCES = { 'worker_connections': 1000, # 워커당 최대 연결 수 'limit_request_line': 4094, # 요청 라인 길이 제한 'limit_request_fields': 100, # 요청 필드 수 제한 'limit_request_field_size': 8190, # 요청 필드 크기 제한 'graceful_timeout': 30, # 그레이스풀 종료 타임아웃 } 프로덕션 환경 설정 실제 운영 환경에서 사용할 때의 추가 설정들:\n1 2 3 4 5 6 7 8 9 10 # production_settings.py DAPHNE_PRODUCTION = { 'proxy_protocol': False, # PROXY 프로토콜 지원 'proxy_protocol_ports': [443], # PROXY 프로토콜 사용 포트 'http_keepalive': True, # HTTP keepalive 활성화 'http_keepalive_timeout': 5, # keepalive 타임아웃(초) 'statsd_host': 'localhost', # statsd 호스트 'statsd_port': 8125, # statsd 포트 'statsd_prefix': 'daphne', # statsd 메트릭 접두사 } 에러 핸들링 설정 에러 처리와 관련된 설정들:\n1 2 3 4 5 6 7 # error_handling_settings.py DAPHNE_ERROR_HANDLING = { 'debug': False, # 디버그 모드 비활성화 'error_template': 'errors/500.html', # 에러 페이지 템플릿 'reload': False, # 코드 변경 시 자동 리로드 'verbosity': 1, # 로그 상세도 } 이러한 설정들은 서버의 용도와 환경에 따라 적절히 조정되어야 한다.\n특히 실제 운영 환경에서는 보안과 성능 관련 설정에 주의를 기울여야 한다.\n또한, 모니터링과 로깅 설정을 통해 서버의 상태를 지속적으로 관찰하고 문제가 발생했을 때 신속하게 대응할 수 있도록 해야 한다.\n각 설정값들은 서버의 규모, 트래픽 패턴, 하드웨어 리소스 등을 고려하여 최적화되어야 하며, 정기적인 성능 테스트를 통해 조정될 필요가 있다.\n시스템 서비스 등록 Systemd 서비스 파일을 작성 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 [Unit] Description=Daphne ASGI Server After=network.target [Service] Type=simple User=www-data Group=www-data WorkingDirectory=/path/to/your/project Environment=DJANGO_SETTINGS_MODULE=myproject.settings Environment=PYTHONPATH=/path/to/your/project ExecStart=/path/to/virtualenv/bin/daphne \\ -b 0.0.0.0 \\ -p 8001 \\ --access-log /var/log/daphne/access.log \\ --proxy-headers \\ myproject.asgi:application # 자동 재시작 설정 Restart=always RestartSec=5 # 시스템 리소스 제한 LimitNOFILE=65535 [Install] WantedBy=multi-user.target 서비스 파일을 시스템에 등록하고 활성화하는 방법 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # 서비스 파일 복사 sudo cp daphne.service /etc/systemd/system/ # systemd 데몬 리로드 sudo systemctl daemon-reload # 서비스 시작 sudo systemctl start daphne # 부팅 시 자동 시작 설정 sudo systemctl enable daphne # 서비스 상태 확인 sudo systemctl status daphne 참고 및 출처 GitHub - django/daphne: Django Channels HTTP/WebSocket server\n","wordCount":"1055","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2024-11-30T08:44:00Z","dateModified":"2024-11-30T08:44:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/daphne/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>Computer Science and Engineering</a>&nbsp;»&nbsp;<a href>Programming Languages</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/programming-languages/python/>Python</a>&nbsp;»&nbsp;<a href>Libraries of Python</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/>Python Web Application Server</a></div><h1 class="post-title entry-hint-parent">daphne</h1><div class=post-description>Daphne는 Django Channels를 위해 개발된 HTTP, HTTP2 및 WebSocket 프로토콜 서버이다.</div><div class=post-meta><span title='2024-11-30 08:44:00 +0000 UTC'>November 30, 2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/Programming%20Languages/Python/Library/Web%20Application%20Server/daphne.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#daphne>Daphne</a><ul><li><a href=#daphne의-주요-특징>Daphne의 주요 특징</a></li><li><a href=#daphne-설치>Daphne 설치</a></li><li><a href=#daphne-설정>Daphne 설정</a></li><li><a href=#daphne-실행>Daphne 실행</a></li><li><a href=#주의사항-및-팁>주의사항 및 팁</a></li><li><a href=#프로덕션-환경-설정>프로덕션 환경 설정</a></li><li><a href=#daphne-환경-설정>Daphne 환경 설정</a></li></ul></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=daphne>Daphne<a hidden class=anchor aria-hidden=true href=#daphne>#</a></h2><p>Daphne는 Django Channels를 위해 개발된 HTTP, HTTP2 및 WebSocket 프로토콜 서버이다.<br>Django 프로젝트 팀에 의해 유지 관리되며 ASGI(Asynchronous Server Gateway Interface) 서버의 참조 구현으로 작동한다.</p><p>Django Channels와 함께 사용할 때, Redis나 다른 백엔드를 channel layer로 사용하여 실시간 통신을 구현할 수 있다.<br>이는 MongoDB의 Change Streams이나 MySQL의 CDC(Change Data Capture)와 같은 실시간 데이터 동기화 기능을 구현할 때 유용하다.</p><h3 id=daphne의-주요-특징>Daphne의 주요 특징<a hidden class=anchor aria-hidden=true href=#daphne의-주요-특징>#</a></h3><ol><li><strong>프로토콜 지원</strong>: Daphne는 HTTP, HTTP2, WebSocket 프로토콜을 모두 지원한다.</li><li><strong>자동 프로토콜 협상</strong>: Daphne는 들어오는 요청을 자동으로 분석하여 적절한 프로토콜로 처리한다.</li><li><strong>ASGI 호환성</strong>: ASGI 애플리케이션과 호환되며, 특히 Django Channels를 위해 설계되었다.</li><li><strong>개발 및 프로덕션 사용</strong>: Daphne는 개발 환경과 프로덕션 환경 모두에서 사용할 수 있다.</li></ol><h3 id=daphne-설치>Daphne 설치<a hidden class=anchor aria-hidden=true href=#daphne-설치>#</a></h3><ol><li><p>pip를 사용하여 Daphne를 설치한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip install daphne
</span></span></code></pre></td></tr></table></div></div></li><li><p>Django 프로젝트의 <code>settings.py</code> 파일에 Daphne를 추가한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>INSTALLED_APPS</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;daphne&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=c1># 다른 앱들…</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=daphne-설정>Daphne 설정<a hidden class=anchor aria-hidden=true href=#daphne-설정>#</a></h3><ol><li><p><code>settings.py</code> 파일에 ASGI 애플리케이션 설정을 추가한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>ASGI_APPLICATION</span> <span class=o>=</span> <span class=s2>&#34;myproject.asgi:application&#34;</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>프로젝트의 <code>asgi.py</code> 파일을 다음과 같이 구성한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4>4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5>5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>django.core.asgi</span> <span class=kn>import</span> <span class=n>get_asgi_application</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>setdefault</span><span class=p>(</span><span class=s1>&#39;DJANGO_SETTINGS_MODULE&#39;</span><span class=p>,</span> <span class=s1>&#39;myproject.settings&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>application</span> <span class=o>=</span> <span class=n>get_asgi_application</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=daphne-실행>Daphne 실행<a hidden class=anchor aria-hidden=true href=#daphne-실행>#</a></h3><p>Django 프로젝트에서 Daphne를 실행하려면 다음 명령을 사용한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>daphne myproject.asgi:application
</span></span></code></pre></td></tr></table></div></div><p>기본적으로 Daphne는 localhost:8000에서 실행되지만, 바인딩 주소와 포트를 지정할 수 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>daphne -b 0.0.0.0 -p <span class=m>8001</span> myproject.asgi:application
</span></span></code></pre></td></tr></table></div></div><h3 id=주의사항-및-팁>주의사항 및 팁<a hidden class=anchor aria-hidden=true href=#주의사항-및-팁>#</a></h3><ol><li><strong>정적 파일 처리</strong>: Daphne는 정적 파일 처리에 최적화되어 있지 않으므로, 프로덕션 환경에서는 Nginx와 같은 웹 서버를 함께 사용하는 것이 좋다.</li><li><strong>환경 변수 설정</strong>: Daphne 실행 시 DJANGO_SETTINGS_MODULE 환경 변수를 설정해야 할 수 있다.</li><li><strong>성능 고려사항</strong>: 대규모 프로덕션 환경에서는 여러 Daphne 인스턴스를 실행하고 로드 밸런서를 사용하는 것이 좋다.</li><li><strong>보안</strong>: Daphne를 직접 인터넷에 노출시키는 것보다는 Nginx나 Apache와 같은 검증된 웹 서버 뒤에 두는 것이 보안상 좋다.</li></ol><h3 id=프로덕션-환경-설정>프로덕션 환경 설정<a hidden class=anchor aria-hidden=true href=#프로덕션-환경-설정>#</a></h3><p>프로덕션 환경에서는 Daphne를 데몬으로 실행하고 Nginx와 함께 사용하는 것이 좋다:</p><ol><li>systemd 서비스 파일을 생성하여 Daphne를 데몬으로 실행한다.</li><li>Nginx를 리버스 프록시로 설정하여 정적 파일 처리와 요청 라우팅을 담당하게 한다.</li><li>WebSocket 요청은 Nginx에서 Daphne로 프록시한다.</li></ol><p>Nginx와 함께 사용할 때는 다음과 같은 설정도 고려해야 한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14>14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15>15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># /etc/nginx/sites-available/myproject
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>listen</span> <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>server_name</span> <span class=s>example.com</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_pass</span> <span class=s>http://0.0.0.0:8001</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_http_version</span> <span class=mi>1</span><span class=s>.1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_set_header</span> <span class=s>Upgrade</span> <span class=nv>$http_upgrade</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_set_header</span> <span class=s>Connection</span> <span class=s>&#34;upgrade&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_set_header</span> <span class=s>Host</span> <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_set_header</span> <span class=s>X-Real-IP</span> <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_set_header</span> <span class=s>X-Forwarded-For</span> <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>proxy_set_header</span> <span class=s>X-Forwarded-Proto</span> <span class=nv>$scheme</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=daphne-환경-설정>Daphne 환경 설정<a hidden class=anchor aria-hidden=true href=#daphne-환경-설정>#</a></h3><p>Daphne의 설정은 크게 서버 동작, 성능, 보안, 로깅의 네 가지 카테고리로 나눌 수 있다.<br>각각의 설정이 어떤 의미를 가지는지 살펴보겠습니다.</p><h4 id=다양한-설정-옵션>다양한 설정 옵션<a hidden class=anchor aria-hidden=true href=#다양한-설정-옵션>#</a></h4><h5 id=기본-서버-설정>기본 서버 설정<a hidden class=anchor aria-hidden=true href=#기본-서버-설정>#</a></h5><p>이러한 설정들은 서버의 기본 동작을 결정한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2>2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3>3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4>4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5>5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6>6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7>7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># daphne_settings.py</span>
</span></span><span class=line><span class=cl><span class=n>DAPHNE_SERVER</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;bind&#39;</span><span class=p>:</span> <span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span>  <span class=c1># 서버가 바인딩할 주소</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;port&#39;</span><span class=p>:</span> <span class=mi>8000</span><span class=p>,</span>       <span class=c1># 리스닝 포트</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;unix_socket&#39;</span><span class=p>:</span> <span class=s1>&#39;/tmp/daphne.sock&#39;</span><span class=p>,</span>  <span class=c1># Unix 소켓 경로 (선택적)</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;fd&#39;</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span>         <span class=c1># 파일 디스크립터 (선택적)</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;access_log&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=c1># 접근 로그 활성화</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=최적화-설정>최적화 설정<a hidden class=anchor aria-hidden=true href=#최적화-설정>#</a></h5><p>성능과 관련된 설정들은 서버의 처리 능력과 응답 시간에 직접적인 영향을 미친다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6>6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7>7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># performance_settings.py</span>
</span></span><span class=line><span class=cl><span class=n>DAPHNE_PERFORMANCE</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;application_close_timeout&#39;</span><span class=p>:</span> <span class=mi>10</span><span class=p>,</span>  <span class=c1># 애플리케이션 종료 대기 시간(초)</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;websocket_timeout&#39;</span><span class=p>:</span> <span class=mi>86400</span><span class=p>,</span>      <span class=c1># WebSocket 연결 타임아웃(초)</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;http_timeout&#39;</span><span class=p>:</span> <span class=mi>120</span><span class=p>,</span>             <span class=c1># HTTP 요청 타임아웃(초)</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;ping_interval&#39;</span><span class=p>:</span> <span class=mi>20</span><span class=p>,</span>             <span class=c1># WebSocket ping 간격(초)</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;max_request_size&#39;</span><span class=p>:</span> <span class=mi>1048576</span><span class=p>,</span>     <span class=c1># 최대 요청 크기(바이트)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=보안-설정>보안 설정<a hidden class=anchor aria-hidden=true href=#보안-설정>#</a></h5><p>보안 관련 설정은 서버의 안전성을 확보하는 데 중요하다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3>3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4>4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5>5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6>6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7>7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># security_settings.py</span>
</span></span><span class=line><span class=cl><span class=n>DAPHNE_SECURITY</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;proxy_headers&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>  <span class=c1># 프록시 헤더 처리 활성화</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;ssl_cert_file&#39;</span><span class=p>:</span> <span class=s1>&#39;/path/to/cert.pem&#39;</span><span class=p>,</span>  <span class=c1># SSL 인증서 경로</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;ssl_key_file&#39;</span><span class=p>:</span> <span class=s1>&#39;/path/to/key.pem&#39;</span><span class=p>,</span>    <span class=c1># SSL 키 파일 경로</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;ssl_verify_client&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>  <span class=c1># 클라이언트 인증서 검증</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;websocket_handshake_timeout&#39;</span><span class=p>:</span> <span class=mi>20</span><span class=p>,</span>  <span class=c1># WebSocket 핸드셰이크 타임아웃</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=로깅-설정>로깅 설정<a hidden class=anchor aria-hidden=true href=#로깅-설정>#</a></h5><p>로깅은 서버 모니터링과 문제 해결에 필수적이다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span><span class=lnt id=hl-10-16><a class=lnlinks href=#hl-10-16>16</a>
</span><span class=lnt id=hl-10-17><a class=lnlinks href=#hl-10-17>17</a>
</span><span class=lnt id=hl-10-18><a class=lnlinks href=#hl-10-18>18</a>
</span><span class=lnt id=hl-10-19><a class=lnlinks href=#hl-10-19>19</a>
</span><span class=lnt id=hl-10-20><a class=lnlinks href=#hl-10-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># logging_settings.py</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>DAPHNE_LOGGING</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;log_level&#39;</span><span class=p>:</span> <span class=s1>&#39;INFO&#39;</span><span class=p>,</span>  <span class=c1># 로그 레벨 설정</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;access_log_format&#39;</span><span class=p>:</span> <span class=s1>&#39;</span><span class=si>%(h)s</span><span class=s1> </span><span class=si>%(l)s</span><span class=s1> </span><span class=si>%(u)s</span><span class=s1> </span><span class=si>%(t)s</span><span class=s1> &#34;</span><span class=si>%(r)s</span><span class=s1>&#34; </span><span class=si>%(s)s</span><span class=s1> </span><span class=si>%(b)s</span><span class=s1> &#34;</span><span class=si>%(f)s</span><span class=s1>&#34; &#34;</span><span class=si>%(a)s</span><span class=s1>&#34;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;error_log&#39;</span><span class=p>:</span> <span class=s1>&#39;/var/log/daphne/error.log&#39;</span><span class=p>,</span>  <span class=c1># 에러 로그 경로</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;access_log&#39;</span><span class=p>:</span> <span class=s1>&#39;/var/log/daphne/access.log&#39;</span><span class=p>,</span> <span class=c1># 접근 로그 경로</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;log_colors&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>  <span class=c1># 로그 색상 활성화</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 로그 핸들러 설정</span>
</span></span><span class=line><span class=cl><span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> [</span><span class=si>%(levelname)s</span><span class=s1>] </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>handlers</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>FileHandler</span><span class=p>(</span><span class=s1>&#39;daphne.log&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>logging</span><span class=o>.</span><span class=n>StreamHandler</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=channel-layer-설정>Channel Layer 설정<a hidden class=anchor aria-hidden=true href=#channel-layer-설정>#</a></h5><p>Django Channels와 함께 사용할 때의 Channel Layer 설정이다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># channels_settings.py</span>
</span></span><span class=line><span class=cl><span class=n>CHANNEL_LAYERS</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;BACKEND&#39;</span><span class=p>:</span> <span class=s1>&#39;channels_redis.core.RedisChannelLayer&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;CONFIG&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;hosts&#39;</span><span class=p>:</span> <span class=p>[(</span><span class=s1>&#39;redis&#39;</span><span class=p>,</span> <span class=mi>6379</span><span class=p>)],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;capacity&#39;</span><span class=p>:</span> <span class=mi>1000</span><span class=p>,</span>  <span class=c1># 채널당 최대 메시지 수</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;expiry&#39;</span><span class=p>:</span> <span class=mi>60</span><span class=p>,</span>     <span class=c1># 메시지 만료 시간(초)</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=리소스-관리-설정>리소스 관리 설정<a hidden class=anchor aria-hidden=true href=#리소스-관리-설정>#</a></h5><p>시스템 리소스 사용과 관련된 설정:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1>1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2>2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3>3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4>4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5>5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6>6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7>7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># resource_settings.py</span>
</span></span><span class=line><span class=cl><span class=n>DAPHNE_RESOURCES</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;worker_connections&#39;</span><span class=p>:</span> <span class=mi>1000</span><span class=p>,</span>  <span class=c1># 워커당 최대 연결 수</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;limit_request_line&#39;</span><span class=p>:</span> <span class=mi>4094</span><span class=p>,</span>  <span class=c1># 요청 라인 길이 제한</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;limit_request_fields&#39;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span> <span class=c1># 요청 필드 수 제한</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;limit_request_field_size&#39;</span><span class=p>:</span> <span class=mi>8190</span><span class=p>,</span>  <span class=c1># 요청 필드 크기 제한</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;graceful_timeout&#39;</span><span class=p>:</span> <span class=mi>30</span><span class=p>,</span>  <span class=c1># 그레이스풀 종료 타임아웃</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=프로덕션-환경-설정-1>프로덕션 환경 설정<a hidden class=anchor aria-hidden=true href=#프로덕션-환경-설정-1>#</a></h5><p>실제 운영 환경에서 사용할 때의 추가 설정들:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1> 1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2> 2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3> 3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4> 4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5> 5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6> 6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7> 7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8> 8</a>
</span><span class=lnt id=hl-13-9><a class=lnlinks href=#hl-13-9> 9</a>
</span><span class=lnt id=hl-13-10><a class=lnlinks href=#hl-13-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># production_settings.py</span>
</span></span><span class=line><span class=cl><span class=n>DAPHNE_PRODUCTION</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;proxy_protocol&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>  <span class=c1># PROXY 프로토콜 지원</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;proxy_protocol_ports&#39;</span><span class=p>:</span> <span class=p>[</span><span class=mi>443</span><span class=p>],</span>  <span class=c1># PROXY 프로토콜 사용 포트</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;http_keepalive&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>  <span class=c1># HTTP keepalive 활성화</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;http_keepalive_timeout&#39;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span>  <span class=c1># keepalive 타임아웃(초)</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;statsd_host&#39;</span><span class=p>:</span> <span class=s1>&#39;localhost&#39;</span><span class=p>,</span>  <span class=c1># statsd 호스트</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;statsd_port&#39;</span><span class=p>:</span> <span class=mi>8125</span><span class=p>,</span>  <span class=c1># statsd 포트</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;statsd_prefix&#39;</span><span class=p>:</span> <span class=s1>&#39;daphne&#39;</span><span class=p>,</span>  <span class=c1># statsd 메트릭 접두사</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=에러-핸들링-설정>에러 핸들링 설정<a hidden class=anchor aria-hidden=true href=#에러-핸들링-설정>#</a></h5><p>에러 처리와 관련된 설정들:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1>1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2>2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3>3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4>4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5>5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6>6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># error_handling_settings.py</span>
</span></span><span class=line><span class=cl><span class=n>DAPHNE_ERROR_HANDLING</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;debug&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>  <span class=c1># 디버그 모드 비활성화</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;error_template&#39;</span><span class=p>:</span> <span class=s1>&#39;errors/500.html&#39;</span><span class=p>,</span>  <span class=c1># 에러 페이지 템플릿</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;reload&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>  <span class=c1># 코드 변경 시 자동 리로드</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;verbosity&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>  <span class=c1># 로그 상세도</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>이러한 설정들은 서버의 용도와 환경에 따라 적절히 조정되어야 한다.<br>특히 실제 운영 환경에서는 보안과 성능 관련 설정에 주의를 기울여야 한다.<br>또한, 모니터링과 로깅 설정을 통해 서버의 상태를 지속적으로 관찰하고 문제가 발생했을 때 신속하게 대응할 수 있도록 해야 한다.</p><p>각 설정값들은 서버의 규모, 트래픽 패턴, 하드웨어 리소스 등을 고려하여 최적화되어야 하며, 정기적인 성능 테스트를 통해 조정될 필요가 있다.</p><h4 id=시스템-서비스-등록>시스템 서비스 등록<a hidden class=anchor aria-hidden=true href=#시스템-서비스-등록>#</a></h4><h5 id=systemd-서비스-파일을-작성>Systemd 서비스 파일을 작성<a hidden class=anchor aria-hidden=true href=#systemd-서비스-파일을-작성>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1> 1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2> 2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3> 3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4> 4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5> 5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6> 6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7> 7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8> 8</a>
</span><span class=lnt id=hl-15-9><a class=lnlinks href=#hl-15-9> 9</a>
</span><span class=lnt id=hl-15-10><a class=lnlinks href=#hl-15-10>10</a>
</span><span class=lnt id=hl-15-11><a class=lnlinks href=#hl-15-11>11</a>
</span><span class=lnt id=hl-15-12><a class=lnlinks href=#hl-15-12>12</a>
</span><span class=lnt id=hl-15-13><a class=lnlinks href=#hl-15-13>13</a>
</span><span class=lnt id=hl-15-14><a class=lnlinks href=#hl-15-14>14</a>
</span><span class=lnt id=hl-15-15><a class=lnlinks href=#hl-15-15>15</a>
</span><span class=lnt id=hl-15-16><a class=lnlinks href=#hl-15-16>16</a>
</span><span class=lnt id=hl-15-17><a class=lnlinks href=#hl-15-17>17</a>
</span><span class=lnt id=hl-15-18><a class=lnlinks href=#hl-15-18>18</a>
</span><span class=lnt id=hl-15-19><a class=lnlinks href=#hl-15-19>19</a>
</span><span class=lnt id=hl-15-20><a class=lnlinks href=#hl-15-20>20</a>
</span><span class=lnt id=hl-15-21><a class=lnlinks href=#hl-15-21>21</a>
</span><span class=lnt id=hl-15-22><a class=lnlinks href=#hl-15-22>22</a>
</span><span class=lnt id=hl-15-23><a class=lnlinks href=#hl-15-23>23</a>
</span><span class=lnt id=hl-15-24><a class=lnlinks href=#hl-15-24>24</a>
</span><span class=lnt id=hl-15-25><a class=lnlinks href=#hl-15-25>25</a>
</span><span class=lnt id=hl-15-26><a class=lnlinks href=#hl-15-26>26</a>
</span><span class=lnt id=hl-15-27><a class=lnlinks href=#hl-15-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[Unit]</span>
</span></span><span class=line><span class=cl><span class=na>Description</span><span class=o>=</span><span class=s>Daphne ASGI Server</span>
</span></span><span class=line><span class=cl><span class=na>After</span><span class=o>=</span><span class=s>network.target</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>[Service]</span>
</span></span><span class=line><span class=cl><span class=na>Type</span><span class=o>=</span><span class=s>simple</span>
</span></span><span class=line><span class=cl><span class=na>User</span><span class=o>=</span><span class=s>www-data</span>
</span></span><span class=line><span class=cl><span class=na>Group</span><span class=o>=</span><span class=s>www-data</span>
</span></span><span class=line><span class=cl><span class=na>WorkingDirectory</span><span class=o>=</span><span class=s>/path/to/your/project</span>
</span></span><span class=line><span class=cl><span class=na>Environment</span><span class=o>=</span><span class=s>DJANGO_SETTINGS_MODULE=myproject.settings</span>
</span></span><span class=line><span class=cl><span class=na>Environment</span><span class=o>=</span><span class=s>PYTHONPATH=/path/to/your/project</span>
</span></span><span class=line><span class=cl><span class=na>ExecStart</span><span class=o>=</span><span class=s>/path/to/virtualenv/bin/daphne \
</span></span></span><span class=line><span class=cl><span class=s>    -b 0.0.0.0 \
</span></span></span><span class=line><span class=cl><span class=s>    -p 8001 \
</span></span></span><span class=line><span class=cl><span class=s>    --access-log /var/log/daphne/access.log \
</span></span></span><span class=line><span class=cl><span class=s>    --proxy-headers \
</span></span></span><span class=line><span class=cl><span class=s>    myproject.asgi:application</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 자동 재시작 설정</span>
</span></span><span class=line><span class=cl><span class=na>Restart</span><span class=o>=</span><span class=s>always</span>
</span></span><span class=line><span class=cl><span class=na>RestartSec</span><span class=o>=</span><span class=s>5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 시스템 리소스 제한</span>
</span></span><span class=line><span class=cl><span class=na>LimitNOFILE</span><span class=o>=</span><span class=s>65535</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>[Install]</span>
</span></span><span class=line><span class=cl><span class=na>WantedBy</span><span class=o>=</span><span class=s>multi-user.target</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=서비스-파일을-시스템에-등록하고-활성화하는-방법>서비스 파일을 시스템에 등록하고 활성화하는 방법<a hidden class=anchor aria-hidden=true href=#서비스-파일을-시스템에-등록하고-활성화하는-방법>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11>11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12>12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13>13</a>
</span><span class=lnt id=hl-16-14><a class=lnlinks href=#hl-16-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 서비스 파일 복사</span>
</span></span><span class=line><span class=cl>sudo cp daphne.service /etc/systemd/system/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># systemd 데몬 리로드</span>
</span></span><span class=line><span class=cl>sudo systemctl daemon-reload
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 서비스 시작</span>
</span></span><span class=line><span class=cl>sudo systemctl start daphne
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 부팅 시 자동 시작 설정</span>
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> daphne
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 서비스 상태 확인</span>
</span></span><span class=line><span class=cl>sudo systemctl status daphne
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><p><a href=https://github.com/django/daphne>GitHub - django/daphne: Django Channels HTTP/WebSocket server</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/programming-languages/>Programming-Languages</a></li><li><a href=https://buenhyden.github.io/tags/python/>Python</a></li><li><a href=https://buenhyden.github.io/tags/library/>Library</a></li><li><a href=https://buenhyden.github.io/tags/web-application-server/>Web-Application-Server</a></li><li><a href=https://buenhyden.github.io/tags/daphne/>Daphne</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/programming-languages/python/library/database/sqlalchemy/><span class=title>« Prev</span><br><span>SQLAlchemy</span>
</a><a class=next href=https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/uvicorn/><span class=title>Next »</span><br><span>uvicorn</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>