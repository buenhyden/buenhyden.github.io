<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>UWSGI | hyunyoun's Blog</title>
<meta name=keywords content="Programming-Languages,Python,Library,Web-Application-Server,UWSGI"><meta name=description content="파이썬 웹 애플리케이션을 위한 강력하고 유연한 애플리케이션 서버"><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/uwsgi/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.9a2bbe2d8b5afa9d4df22976abb7b72f1f7f1c467d2b30f03090108f9496ae6c.css integrity="sha256-miu+LYta+p1N8il2q7e3Lx9/HEZ9KzDwMJAQj5SWrmw=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/uwsgi/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/uwsgi/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="UWSGI"><meta property="og:description" content="파이썬 웹 애플리케이션을 위한 강력하고 유연한 애플리케이션 서버"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-05T03:36:00+00:00"><meta property="article:modified_time" content="2024-11-05T03:36:00+00:00"><meta property="article:tag" content="Programming-Languages"><meta property="article:tag" content="Python"><meta property="article:tag" content="Library"><meta property="article:tag" content="Web-Application-Server"><meta property="article:tag" content="UWSGI"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="UWSGI"><meta name=twitter:description content="파이썬 웹 애플리케이션을 위한 강력하고 유연한 애플리케이션 서버"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Programming Languages","item":"https://buenhyden.github.io/posts/programming-languages/"},{"@type":"ListItem","position":3,"name":"Python","item":"https://buenhyden.github.io/posts/programming-languages/python/"},{"@type":"ListItem","position":5,"name":"Python Web Application Server","item":"https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/"},{"@type":"ListItem","position":6,"name":"UWSGI","item":"https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/uwsgi/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"UWSGI","name":"UWSGI","description":"파이썬 웹 애플리케이션을 위한 강력하고 유연한 애플리케이션 서버","keywords":["Programming-Languages","Python","Library","Web-Application-Server","UWSGI"],"articleBody":"UWSGI uWSGI는 파이썬 웹 애플리케이션을 위한 강력하고 유연한 애플리케이션 서버이다.\nWSGI(Web Server Gateway Interface) 프로토콜을 구현하여 웹 서버와 파이썬 웹 애플리케이션 간의 표준화된 인터페이스를 제공한다.\n적절한 설정과 튜닝을 통해 고성능, 안정성, 확장성을 제공하여 프로덕션 환경에서 파이썬 웹 애플리케이션을 효과적으로 운영할 수 있게 해준다.\nuWSGI의 주요 특징 다양한 프로토콜 지원: HTTP, FastCGI, SCGI 등 여러 프로토콜을 지원한다. 고성능: 멀티 프로세싱과 멀티스레딩을 지원하여 높은 동시성과 성능을 제공한다. 유연성: 다양한 설정 옵션을 통해 세밀한 성능 튜닝이 가능한다. 플러그인 아키텍처: C, C++, Python 등 다양한 언어로 플러그인을 개발할 수 있어 확장성이 뛰어나다. 프로세스 관리: 마스터 프로세스가 워커 프로세스를 효율적으로 관리한다. uWSGI의 장점 높은 성능: 효율적인 리소스 관리로 높은 처리량을 제공한다. 안정성: 마스터 프로세스가 워커 프로세스를 관리하여 안정적인 운영이 가능하다. 유연성: 다양한 설정 옵션으로 다양한 환경에 적응할 수 있다. 확장성: 플러그인 아키텍처를 통해 기능을 확장할 수 있다. uWSGI의 작동 방식 웹 서버(예: Nginx)가 클라이언트로부터 요청을 받는다. 웹 서버는 이 요청을 uWSGI 서버로 전달한다. uWSGI는 요청을 파이썬 애플리케이션(예: Django, Flask)에 전달한다. 파이썬 애플리케이션이 요청을 처리하고 응답을 생성한다. uWSGI는 이 응답을 웹 서버로 반환하고, 웹 서버는 최종적으로 클라이언트에게 응답을 전송한다. uWSGI의 로드밸런싱 uWSGI는 내장된 로드 밸런싱 기능을 제공하여 여러 워커 프로세스 간에 요청을 효율적으로 분산시킬 수 있다.\nuWSGI의 로드 밸런싱은 다음과 같이 작동한다:\n마스터 프로세스와 워커 프로세스\nuWSGI는 마스터 프로세스를 생성하고, 이 마스터 프로세스가 여러 워커 프로세스를 fork한다.\n각 워커 프로세스는 독립적인 Python 인터프리터 인스턴스를 가지며, 자체 GIL(Global Interpreter Lock)을 갖는다. 요청 분배 마스터 프로세스가 들어오는 HTTP 요청을 받는다다. 마스터 프로세스는 사전 정의된 로드 밸런싱 알고리즘에 따라 요청을 워커 프로세스 중 하나에 할당한다. 선택된 워커 프로세스가 요청을 처리하고 응답을 반환한다. 로드 밸런싱 알고리즘\nuWSGI는 다양한 로드 밸런싱 알고리즘을 지원한다다: Round Robin: 요청을 순차적으로 각 워커에 분배한다. Least Connections: 현재 가장 적은 연결을 처리 중인 워커에 새 요청을 할당한다. IP Hash: 클라이언트 IP 주소를 기반으로 요청을 특정 워커에 할당한다. 동적 스케일링\nuWSGI의 ‘cheaper’ 서브시스템을 사용하면 트래픽 변화에 따라 워커 프로세스 수를 동적으로 조절할 수 있다.\n이를 통해 리소스 사용을 최적화하고 예상치 못한 트래픽 급증에 대비할 수 있다. 장애 대응\nuWSGI는 워커 프로세스의 상태를 모니터링하고, 특정 워커가 응답하지 않거나 문제가 발생하면 해당 워커를 재시작하거나 트래픽을 다른 워커로 리다이렉트한다. uWSGI의 로드 밸런싱 기능은 단일 서버 내에서 효과적으로 작동하며, 복잡한 설정 없이도 애플리케이션의 성능과 안정성을 향상시킬 수 있다.\n그러나 대규모 분산 환경에서는 Nginx와 같은 전용 로드 밸런서와 함께 사용하는 것이 일반적이다.\nuWSGI의 로드 밸런싱 기능을 설정하기 위해서는:\n마스터 프로세스 활성화 워커 프로세스 설정 로드 밸런싱 알고리즘 선택 동적 스케일링 설정 소켓 설정\n등을 통해 여러 워커 프로세스간에 요청을 효과적으로 분산시킬 수 있다. uWSGI의 로드 밸런싱 기능을 사용할 때는:\n워커 프로세스 수 설정:\n단순히 CPU 코어 수의 2배로 설정하는 것은 충분하지 않다.\n애플리케이션과 시스템 특성에 맞게 실험을 통해 최적의 워커 수를 찾아야 한다. 메모리 사용량 모니터링:\nmemory-report 옵션을 사용하여 메모리 사용량을 지속적으로 확인해야 한다. 버퍼 크기 조정:\n기본 버퍼 크기(4096바이트)가 부족할 경우 “invalid request block size” 오류가 발생할 수 있으므로 buffer-size 옵션으로 조정이 필요한다. 동적 스케일링 설정:\ncheaper 서브시스템을 활용하여 트래픽 변화에 따라 워커 수를 자동으로 조절할 수 있다. 커널의 로드 밸런싱 활용:\n특별한 경우가 아니라면 커널의 기본 로드 밸런싱을 신뢰하는 것이 좋다.\n균등 분배가 필요하다면 CPU 어피니티 옵션을 고려해볼 수 있다. 프록시 타임아웃 설정:\n리로드 시간이 길어질 경우 프록시의 연결 타임아웃을 적절히 조정해야 한다. 워커 재활용:\nmax-requests, max-worker-lifetime, reload-on-rss 등의 옵션을 사용하여 워커를 주기적으로 재시작함으로써 메모리 누수 등의 문제를 예방할 수 있다.\n이러한 요소들을 주의해야 하며, 이들을 고려하여 uWSGI의 로드 밸런싱을 구성하고, 지속적인 모니터링과 튜닝을 통해 최적의 성능을 얻을 수 있다. uWSGI와 Nginx의 조합 uWSGI와 Nginx를 함께 사용하면 다음과 같은 주요 장점들이 있다:\n성능 향상 정적 파일 처리: Nginx가 정적 파일을 더 효율적으로 처리하여 uWSGI의 부하를 줄인다. 고성능 처리: Nginx는 수천 개의 동시 연결을 처리할 수 있는 안정적인 웹 서버이다. 캐싱: Nginx는 동적 콘텐츠 캐싱을 구현하여 서버 부하를 줄일 수 있다. 보안 강화 DDoS 방어: Nginx가 요청을 필터링하고 제한하여 uWSGI 서버를 보호한다. SSL 종료: Nginx가 SSL 연결을 처리하여 uWSGI의 부담을 줄인다. 유연성 및 확장성 로드 밸런싱: Nginx가 여러 uWSGI 인스턴스 간에 요청을 분산시킬 수 있다. 리버스 프록시: Nginx가 uWSGI 앞에서 리버스 프록시 역할을 수행한다. 추가 기능 HTTP 기능: Nginx는 압축, ETag, 액세스 로깅 등 다양한 HTTP 기능을 제공한다. URL 라우팅: Nginx를 통해 복잡한 URL 라우팅을 구현할 수 있다.\n이러한 장점들로 인해 Nginx와 uWSGI를 함께 사용하면 더 안정적이고 확장 가능한 웹 애플리케이션 배포가 가능해진다. uWSGI 환경 설정 uWSGI는 다양한 설정 옵션을 제공한다.\n고려할 사항 uWSGI를 설정하는데 있어 서버 환경과 애플리케이션의 특성에 따라 적절히 조정되어야 한다.\n특히 Django나 Flask 애플리케이션의 경우, 다음과 같은 점들을 고려해야 한다.\nDjango 애플리케이션의 경우 static 파일 서빙: 1 2 static-map = /static=/path/to/static static-expires = /* 7776000 Flask 애플리케이션의 경우 WSGI 호출 규칙: 1 2 callable = app wsgi-file = app.py 개발 환경과 프로덕션 환경의 구분: 1 2 3 4 5 6 7 8 # 개발 환경 python-autoreload = 1 py-auto-reload = 1 # 프로덕션 환경 disable-logging = true master = true vacuum = true 프로세스와 스레드 설정은 서버의 CPU 코어 수와 메모리를 고려하여 설정해야 한다. 일반적으로 CPU 코어 수에 맞춰 프로세스를 설정하는 것이 좋다. 소켓 설정에서는 Nginx와 같은 웹서버와 연동할 때는 Unix 소켓을, 직접 HTTP 서비스를 제공할 때는 http 옵션을 사용한다. 로드 밸런싱 설정은 트래픽 패턴에 따라 조정이 필요하다. cheaper 옵션으로 동적으로 워커 수를 조절할 수 있다. 메모리 관련 설정은 서버의 전체 메모리를 고려하여 설정해야 한다. reload-on-rss로 메모리 누수를 방지할 수 있다. 로깅 설정은 디버깅과 모니터링을 위해 중요하다. logto로 별도의 로그 파일을 지정하고, log-maxsize로 로그 파일 크기를 제한할 수 있다. 다양한 설정 옵션 기본 프로젝트 설정 프로젝트의 기본적인 실행 환경을 설정하는 옵션.\nDjango나 Flask 애플리케이션을 실행하기 위한 필수적인 설정들이 포함된다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 [uwsgi] # 프로젝트 기본 설정 chdir = /path/to/your/project # 프로젝트 루트 디렉토리 설정 module = myproject.wsgi:application # WSGI 애플리케이션 모듈 경로 pythonpath = /path/to/your/project # Python 패키지 검색 경로 추가 env = DJANGO_SETTINGS_MODULE=myproject.settings # 환경변수 설정 # 가상환경 설정 home = /path/to/virtualenv # 가상환경 경로 virtualenv = /path/to/virtualenv # 가상환경 경로 (home과 동일한 역할) # 실행 권한 설정 uid = www-data # 실행 사용자 gid = www-data # 실행 그룹 프로세스 및 스레드 관리 서버의 동시성과 성능을 제어하는 핵심적인 설정.\nCPU 자원을 효율적으로 활용하기 위한 다양한 옵션들을 제공한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # 마스터 프로세스 설정 master = true # 마스터 프로세스 활성화 pidfile = /tmp/project-master.pid # 마스터 프로세스 PID 파일 위치 # 워커 프로세스 설정 processes = 4 # 생성할 워커 프로세스 수 enable-threads = true # 스레드 지원 활성화 threads = 2 # 프로세스당 스레드 수 thread-stacksize = 512 # 스레드 스택 크기 (KB) # 프로세스 관리 max-requests = 5000 # 워커당 최대 요청 처리 수 max-worker-lifetime = 3600 # 워커 프로세스 최대 수명 (초) reload-on-rss = 2048 # 메모리 사용량에 따른 리로드 (MB) worker-reload-mercy = 60 # 워커 종료 대기 시간 (초) 네트워크 및 프로토콜 설정 네트워크 연결과 관련된 설정.\nNginx와의 연동이나 독립 실행 시의 통신 방식을 정의한다.\n1 2 3 4 5 6 7 8 9 10 11 # 소켓 설정 socket = /tmp/uwsgi.sock # Unix 소켓 파일 경로 chmod-socket = 666 # 소켓 파일 권한 http = :8000 # HTTP 포트 바인딩 http-keepalive = true # HTTP keepalive 지원 http-timeout = 65 # HTTP 요청 타임아웃 (초) # 버퍼 설정 buffer-size = 32768 # 요청 버퍼 크기 post-buffering = 16384 # POST 요청 버퍼 크기 socket-timeout = 30 # 소켓 타임아웃 (초) 리소스 관리 및 제한 서버 리소스 사용을 제어하고 모니터링하기 위한 설정.\n1 2 3 4 5 6 7 8 9 10 11 12 13 # 메모리 제한 limit-as = 256 # 프로세스당 메모리 제한 (MB) reload-on-rss = 200 # RSS 기반 리로드 임계값 (MB) memory-report = true # 메모리 사용량 보고 활성화 # CPU 제한 harakiri = 30 # 요청 처리 제한 시간 (초) harakiri-verbose = true # 상세한 harakiri 로그 cpu-affinity = 1 # CPU 코어 할당 # 파일 설명자 제한 listen = 2048 # 리스닝 큐 크기 max-fd = 51200 # 최대 파일 설명자 수 로깅 및 디버깅 애플리케이션 모니터링과 문제 해결을 위한 로깅 설정.\n1 2 3 4 5 6 7 8 9 10 # 로그 파일 설정 logto = /var/log/uwsgi/%n.log # 로그 파일 경로 log-maxsize = 20971520 # 로그 파일 최대 크기 (bytes) log-backupname = /var/log/uwsgi/%n.old.log # 백업 로그 파일명 # 로그 레벨 설정 log-4xx = true # 4xx 에러 로깅 log-5xx = true # 5xx 에러 로깅 log-slow = true # 느린 요청 로깅 log-date = true # 타임스탬프 포함 자동 재시작 및 리로드 애플리케이션의 안정성과 지속성을 보장하기 위한 설정.\n1 2 3 4 5 6 7 8 9 # 자동 재시작 설정 auto-procname = true # 프로세스 이름 자동 설정 touch-reload = /path/to/project/reload # 파일 변경 시 재시작 py-auto-reload = 1 # Python 파일 변경 감지 reload-mercy = 8 # 리로드 대기 시간 (초) # 재시작 조건 설정 max-requests = 1000 # 최대 요청 수 도달 시 재시작 max-worker-lifetime = 3600 # 워커 최대 수명 (초) 성능 최적화 애플리케이션의 성능을 향상시키기 위한 고급 설정.\n1 2 3 4 5 6 7 8 9 10 # 캐시 설정 cache2 = name=mycache,items=100 # 캐시 설정 cache-blocksize = 64 # 캐시 블록 크기 cache-store = /tmp/uwsgicache # 캐시 저장 위치 # 스레드 풀 설정 cheaper = 2 # 최소 프로세스 수 cheaper-algo = spare # 프로세스 스케일링 알고리즘 cheaper-step = 1 # 스케일링 단계 cheaper-idle = 60 # 스케일링을 축소하기 위해 필요한 유휴 시간 시스템 서비스 등록 Systemd 서비스 파일을 작성 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 [Unit] Description=uWSGI instance to serve myproject After=network.target [Service] User=www-data Group=www-data WorkingDirectory=/path/to/project Environment=\"PATH=/path/to/project/venv/bin\" ExecStart=/path/to/project/venv/bin/uwsgi --ini /path/to/project/uwsgi.ini ExecReload=/bin/kill -HUP $MAINPID KillSignal=SIGQUIT Type=notify NotifyAccess=all Restart=always RestartSec=5 StandardError=syslog StandardOutput=syslog [Install] WantedBy=multi-user.target 서비스 파일을 시스템에 등록하고 활성화하는 방법 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # 서비스 파일 복사 sudo cp uwsgi.service /etc/systemd/system/ # systemd 데몬 리로드 sudo systemctl daemon-reload # 서비스 시작 sudo systemctl start uwsgi # 부팅 시 자동 시작 설정 sudo systemctl enable uwsgi # 서비스 상태 확인 sudo systemctl status uwsgi 참고 및 출처 Fetching Title#htpu\n","wordCount":"1631","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2024-11-05T03:36:00Z","dateModified":"2024-11-05T03:36:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/uwsgi/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>posts</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/programming-languages/>Programming Languages</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/programming-languages/python/>Python</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/>Python Web Application Server</a></div><h1 class="post-title entry-hint-parent">UWSGI</h1><div class=post-description>파이썬 웹 애플리케이션을 위한 강력하고 유연한 애플리케이션 서버</div><div class=post-meta><span title='2024-11-05 03:36:00 +0000 UTC'>November 5, 2024</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1631 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/Programming%20Languages/Python/Library/Web%20Application%20Server/UWSGI.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#uwsgi>UWSGI</a><ul><li><a href=#uwsgi의-주요-특징>uWSGI의 주요 특징</a></li><li><a href=#uwsgi의-장점>uWSGI의 장점</a></li><li><a href=#uwsgi의-작동-방식>uWSGI의 작동 방식</a></li><li><a href=#uwsgi의-로드밸런싱>uWSGI의 로드밸런싱</a></li><li><a href=#uwsgi와-nginx의-조합>uWSGI와 Nginx의 조합</a></li><li><a href=#uwsgi-환경-설정>uWSGI 환경 설정</a></li></ul></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=uwsgi>UWSGI<a hidden class=anchor aria-hidden=true href=#uwsgi>#</a></h2><p>uWSGI는 파이썬 웹 애플리케이션을 위한 강력하고 유연한 애플리케이션 서버이다.<br>WSGI(Web Server Gateway Interface) 프로토콜을 구현하여 웹 서버와 파이썬 웹 애플리케이션 간의 표준화된 인터페이스를 제공한다.</p><p>적절한 설정과 튜닝을 통해 고성능, 안정성, 확장성을 제공하여 프로덕션 환경에서 파이썬 웹 애플리케이션을 효과적으로 운영할 수 있게 해준다.</p><h3 id=uwsgi의-주요-특징>uWSGI의 주요 특징<a hidden class=anchor aria-hidden=true href=#uwsgi의-주요-특징>#</a></h3><ol><li>다양한 프로토콜 지원: HTTP, FastCGI, SCGI 등 여러 프로토콜을 지원한다.</li><li>고성능: 멀티 프로세싱과 멀티스레딩을 지원하여 높은 동시성과 성능을 제공한다.</li><li>유연성: 다양한 설정 옵션을 통해 세밀한 성능 튜닝이 가능한다.</li><li>플러그인 아키텍처: C, C++, Python 등 다양한 언어로 플러그인을 개발할 수 있어 확장성이 뛰어나다.</li><li>프로세스 관리: 마스터 프로세스가 워커 프로세스를 효율적으로 관리한다.</li></ol><h3 id=uwsgi의-장점>uWSGI의 장점<a hidden class=anchor aria-hidden=true href=#uwsgi의-장점>#</a></h3><ol><li>높은 성능: 효율적인 리소스 관리로 높은 처리량을 제공한다.</li><li>안정성: 마스터 프로세스가 워커 프로세스를 관리하여 안정적인 운영이 가능하다.</li><li>유연성: 다양한 설정 옵션으로 다양한 환경에 적응할 수 있다.</li><li>확장성: 플러그인 아키텍처를 통해 기능을 확장할 수 있다.</li></ol><h3 id=uwsgi의-작동-방식>uWSGI의 작동 방식<a hidden class=anchor aria-hidden=true href=#uwsgi의-작동-방식>#</a></h3><ol><li>웹 서버(예: Nginx)가 클라이언트로부터 요청을 받는다.</li><li>웹 서버는 이 요청을 uWSGI 서버로 전달한다.</li><li>uWSGI는 요청을 파이썬 애플리케이션(예: Django, Flask)에 전달한다.</li><li>파이썬 애플리케이션이 요청을 처리하고 응답을 생성한다.</li><li>uWSGI는 이 응답을 웹 서버로 반환하고, 웹 서버는 최종적으로 클라이언트에게 응답을 전송한다.</li></ol><h3 id=uwsgi의-로드밸런싱>uWSGI의 로드밸런싱<a hidden class=anchor aria-hidden=true href=#uwsgi의-로드밸런싱>#</a></h3><p>uWSGI는 내장된 로드 밸런싱 기능을 제공하여 여러 워커 프로세스 간에 요청을 효율적으로 분산시킬 수 있다.</p><p>uWSGI의 로드 밸런싱은 다음과 같이 작동한다:</p><ol><li>마스터 프로세스와 워커 프로세스<br>uWSGI는 마스터 프로세스를 생성하고, 이 마스터 프로세스가 여러 워커 프로세스를 fork한다.<br>각 워커 프로세스는 독립적인 Python 인터프리터 인스턴스를 가지며, 자체 GIL(Global Interpreter Lock)을 갖는다.</li><li>요청 분배<ol><li>마스터 프로세스가 들어오는 HTTP 요청을 받는다다.</li><li>마스터 프로세스는 사전 정의된 로드 밸런싱 알고리즘에 따라 요청을 워커 프로세스 중 하나에 할당한다.</li><li>선택된 워커 프로세스가 요청을 처리하고 응답을 반환한다.</li></ol></li><li>로드 밸런싱 알고리즘<br>uWSGI는 다양한 로드 밸런싱 알고리즘을 지원한다다:<ul><li>Round Robin: 요청을 순차적으로 각 워커에 분배한다.</li><li>Least Connections: 현재 가장 적은 연결을 처리 중인 워커에 새 요청을 할당한다.</li><li>IP Hash: 클라이언트 IP 주소를 기반으로 요청을 특정 워커에 할당한다.</li></ul></li><li>동적 스케일링<br>uWSGI의 &lsquo;cheaper&rsquo; 서브시스템을 사용하면 트래픽 변화에 따라 워커 프로세스 수를 동적으로 조절할 수 있다.<br>이를 통해 리소스 사용을 최적화하고 예상치 못한 트래픽 급증에 대비할 수 있다.</li><li>장애 대응<br>uWSGI는 워커 프로세스의 상태를 모니터링하고, 특정 워커가 응답하지 않거나 문제가 발생하면 해당 워커를 재시작하거나 트래픽을 다른 워커로 리다이렉트한다.</li></ol><p>uWSGI의 로드 밸런싱 기능은 단일 서버 내에서 효과적으로 작동하며, 복잡한 설정 없이도 애플리케이션의 성능과 안정성을 향상시킬 수 있다.<br>그러나 대규모 분산 환경에서는 Nginx와 같은 전용 로드 밸런서와 함께 사용하는 것이 일반적이다.</p><p>uWSGI의 로드 밸런싱 기능을 설정하기 위해서는:</p><ol><li>마스터 프로세스 활성화</li><li>워커 프로세스 설정</li><li>로드 밸런싱 알고리즘 선택</li><li>동적 스케일링 설정</li><li>소켓 설정<br>등을 통해 여러 워커 프로세스간에 요청을 효과적으로 분산시킬 수 있다.</li></ol><p>uWSGI의 로드 밸런싱 기능을 사용할 때는:</p><ol><li>워커 프로세스 수 설정:<br>단순히 CPU 코어 수의 2배로 설정하는 것은 충분하지 않다.<br>애플리케이션과 시스템 특성에 맞게 실험을 통해 최적의 워커 수를 찾아야 한다.</li><li>메모리 사용량 모니터링:<br>memory-report 옵션을 사용하여 메모리 사용량을 지속적으로 확인해야 한다.</li><li>버퍼 크기 조정:<br>기본 버퍼 크기(4096바이트)가 부족할 경우 &ldquo;invalid request block size&rdquo; 오류가 발생할 수 있으므로 buffer-size 옵션으로 조정이 필요한다.</li><li>동적 스케일링 설정:<br>cheaper 서브시스템을 활용하여 트래픽 변화에 따라 워커 수를 자동으로 조절할 수 있다.</li><li>커널의 로드 밸런싱 활용:<br>특별한 경우가 아니라면 커널의 기본 로드 밸런싱을 신뢰하는 것이 좋다.<br>균등 분배가 필요하다면 CPU 어피니티 옵션을 고려해볼 수 있다.</li><li>프록시 타임아웃 설정:<br>리로드 시간이 길어질 경우 프록시의 연결 타임아웃을 적절히 조정해야 한다.</li><li>워커 재활용:<br>max-requests, max-worker-lifetime, reload-on-rss 등의 옵션을 사용하여 워커를 주기적으로 재시작함으로써 메모리 누수 등의 문제를 예방할 수 있다.<br> 이러한 요소들을 주의해야 하며, 이들을 고려하여 uWSGI의 로드 밸런싱을 구성하고, 지속적인 모니터링과 튜닝을 통해 최적의 성능을 얻을 수 있다.</li></ol><h3 id=uwsgi와-nginx의-조합>uWSGI와 Nginx의 조합<a hidden class=anchor aria-hidden=true href=#uwsgi와-nginx의-조합>#</a></h3><p>uWSGI와 Nginx를 함께 사용하면 다음과 같은 주요 장점들이 있다:</p><ol><li>성능 향상<ol><li>정적 파일 처리: Nginx가 정적 파일을 더 효율적으로 처리하여 uWSGI의 부하를 줄인다.</li><li>고성능 처리: Nginx는 수천 개의 동시 연결을 처리할 수 있는 안정적인 웹 서버이다.</li><li>캐싱: Nginx는 동적 콘텐츠 캐싱을 구현하여 서버 부하를 줄일 수 있다.</li></ol></li><li>보안 강화<ol><li>DDoS 방어: Nginx가 요청을 필터링하고 제한하여 uWSGI 서버를 보호한다.</li><li>SSL 종료: Nginx가 SSL 연결을 처리하여 uWSGI의 부담을 줄인다.</li></ol></li><li>유연성 및 확장성<ol><li>로드 밸런싱: Nginx가 여러 uWSGI 인스턴스 간에 요청을 분산시킬 수 있다.</li><li>리버스 프록시: Nginx가 uWSGI 앞에서 리버스 프록시 역할을 수행한다.</li></ol></li><li>추가 기능<ol><li>HTTP 기능: Nginx는 압축, ETag, 액세스 로깅 등 다양한 HTTP 기능을 제공한다.</li><li>URL 라우팅: Nginx를 통해 복잡한 URL 라우팅을 구현할 수 있다.<br>이러한 장점들로 인해 Nginx와 uWSGI를 함께 사용하면 더 안정적이고 확장 가능한 웹 애플리케이션 배포가 가능해진다.</li></ol></li></ol><h3 id=uwsgi-환경-설정>uWSGI 환경 설정<a hidden class=anchor aria-hidden=true href=#uwsgi-환경-설정>#</a></h3><p>uWSGI는 다양한 설정 옵션을 제공한다.</p><h4 id=고려할-사항>고려할 사항<a hidden class=anchor aria-hidden=true href=#고려할-사항>#</a></h4><p>uWSGI를 설정하는데 있어 서버 환경과 애플리케이션의 특성에 따라 적절히 조정되어야 한다.<br>특히 Django나 Flask 애플리케이션의 경우, 다음과 같은 점들을 고려해야 한다.</p><ol><li>Django 애플리케이션의 경우 static 파일 서빙:</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=na>static-map</span> <span class=o>=</span> <span class=s>/static=/path/to/static</span>
</span></span><span class=line><span class=cl><span class=na>static-expires</span> <span class=o>=</span> <span class=s>/* 7776000</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>Flask 애플리케이션의 경우 WSGI 호출 규칙:</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=na>callable</span> <span class=o>=</span> <span class=s>app</span>
</span></span><span class=line><span class=cl><span class=na>wsgi-file</span> <span class=o>=</span> <span class=s>app.py</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>개발 환경과 프로덕션 환경의 구분:</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3>3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4>4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5>5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6>6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7>7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=c1># 개발 환경</span>
</span></span><span class=line><span class=cl><span class=na>python-autoreload</span> <span class=o>=</span> <span class=s>1</span>
</span></span><span class=line><span class=cl><span class=na>py-auto-reload</span> <span class=o>=</span> <span class=s>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 프로덕션 환경</span>
</span></span><span class=line><span class=cl><span class=na>disable-logging</span> <span class=o>=</span> <span class=s>true</span>
</span></span><span class=line><span class=cl><span class=na>master</span> <span class=o>=</span> <span class=s>true</span>
</span></span><span class=line><span class=cl><span class=na>vacuum</span> <span class=o>=</span> <span class=s>true</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>프로세스와 스레드 설정은 서버의 CPU 코어 수와 메모리를 고려하여 설정해야 한다. 일반적으로 CPU 코어 수에 맞춰 프로세스를 설정하는 것이 좋다.<ul><li>소켓 설정에서는 Nginx와 같은 웹서버와 연동할 때는 Unix 소켓을, 직접 HTTP 서비스를 제공할 때는 http 옵션을 사용한다.</li><li>로드 밸런싱 설정은 트래픽 패턴에 따라 조정이 필요하다. cheaper 옵션으로 동적으로 워커 수를 조절할 수 있다.</li><li>메모리 관련 설정은 서버의 전체 메모리를 고려하여 설정해야 한다. reload-on-rss로 메모리 누수를 방지할 수 있다.</li><li>로깅 설정은 디버깅과 모니터링을 위해 중요하다. logto로 별도의 로그 파일을 지정하고, log-maxsize로 로그 파일 크기를 제한할 수 있다.</li></ul></li></ol><h4 id=다양한-설정-옵션>다양한 설정 옵션<a hidden class=anchor aria-hidden=true href=#다양한-설정-옵션>#</a></h4><h5 id=기본-프로젝트-설정>기본 프로젝트 설정<a hidden class=anchor aria-hidden=true href=#기본-프로젝트-설정>#</a></h5><p>프로젝트의 기본적인 실행 환경을 설정하는 옵션.<br>Django나 Flask 애플리케이션을 실행하기 위한 필수적인 설정들이 포함된다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[uwsgi]</span>
</span></span><span class=line><span class=cl><span class=c1># 프로젝트 기본 설정</span>
</span></span><span class=line><span class=cl><span class=na>chdir</span> <span class=o>=</span> <span class=s>/path/to/your/project           # 프로젝트 루트 디렉토리 설정</span>
</span></span><span class=line><span class=cl><span class=na>module</span> <span class=o>=</span> <span class=s>myproject.wsgi:application     # WSGI 애플리케이션 모듈 경로</span>
</span></span><span class=line><span class=cl><span class=na>pythonpath</span> <span class=o>=</span> <span class=s>/path/to/your/project      # Python 패키지 검색 경로 추가</span>
</span></span><span class=line><span class=cl><span class=na>env</span> <span class=o>=</span> <span class=s>DJANGO_SETTINGS_MODULE=myproject.settings  # 환경변수 설정</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 가상환경 설정</span>
</span></span><span class=line><span class=cl><span class=na>home</span> <span class=o>=</span> <span class=s>/path/to/virtualenv              # 가상환경 경로</span>
</span></span><span class=line><span class=cl><span class=na>virtualenv</span> <span class=o>=</span> <span class=s>/path/to/virtualenv        # 가상환경 경로 (home과 동일한 역할)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 실행 권한 설정</span>
</span></span><span class=line><span class=cl><span class=na>uid</span> <span class=o>=</span> <span class=s>www-data                          # 실행 사용자</span>
</span></span><span class=line><span class=cl><span class=na>gid</span> <span class=o>=</span> <span class=s>www-data                          # 실행 그룹</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=프로세스-및-스레드-관리>프로세스 및 스레드 관리<a hidden class=anchor aria-hidden=true href=#프로세스-및-스레드-관리>#</a></h5><p>서버의 동시성과 성능을 제어하는 핵심적인 설정.<br>CPU 자원을 효율적으로 활용하기 위한 다양한 옵션들을 제공한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=c1># 마스터 프로세스 설정</span>
</span></span><span class=line><span class=cl><span class=na>master</span> <span class=o>=</span> <span class=s>true                           # 마스터 프로세스 활성화</span>
</span></span><span class=line><span class=cl><span class=na>pidfile</span> <span class=o>=</span> <span class=s>/tmp/project-master.pid       # 마스터 프로세스 PID 파일 위치</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 워커 프로세스 설정</span>
</span></span><span class=line><span class=cl><span class=na>processes</span> <span class=o>=</span> <span class=s>4                           # 생성할 워커 프로세스 수</span>
</span></span><span class=line><span class=cl><span class=na>enable-threads</span> <span class=o>=</span> <span class=s>true                   # 스레드 지원 활성화</span>
</span></span><span class=line><span class=cl><span class=na>threads</span> <span class=o>=</span> <span class=s>2                             # 프로세스당 스레드 수</span>
</span></span><span class=line><span class=cl><span class=na>thread-stacksize</span> <span class=o>=</span> <span class=s>512                  # 스레드 스택 크기 (KB)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 프로세스 관리</span>
</span></span><span class=line><span class=cl><span class=na>max-requests</span> <span class=o>=</span> <span class=s>5000                     # 워커당 최대 요청 처리 수</span>
</span></span><span class=line><span class=cl><span class=na>max-worker-lifetime</span> <span class=o>=</span> <span class=s>3600              # 워커 프로세스 최대 수명 (초)</span>
</span></span><span class=line><span class=cl><span class=na>reload-on-rss</span> <span class=o>=</span> <span class=s>2048                   # 메모리 사용량에 따른 리로드 (MB)</span>
</span></span><span class=line><span class=cl><span class=na>worker-reload-mercy</span> <span class=o>=</span> <span class=s>60               # 워커 종료 대기 시간 (초)</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=네트워크-및-프로토콜-설정>네트워크 및 프로토콜 설정<a hidden class=anchor aria-hidden=true href=#네트워크-및-프로토콜-설정>#</a></h5><p>네트워크 연결과 관련된 설정.<br>Nginx와의 연동이나 독립 실행 시의 통신 방식을 정의한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=c1># 소켓 설정</span>
</span></span><span class=line><span class=cl><span class=na>socket</span> <span class=o>=</span> <span class=s>/tmp/uwsgi.sock               # Unix 소켓 파일 경로</span>
</span></span><span class=line><span class=cl><span class=na>chmod-socket</span> <span class=o>=</span> <span class=s>666                      # 소켓 파일 권한</span>
</span></span><span class=line><span class=cl><span class=na>http</span> <span class=o>=</span> <span class=s>:8000                           # HTTP 포트 바인딩</span>
</span></span><span class=line><span class=cl><span class=na>http-keepalive</span> <span class=o>=</span> <span class=s>true                  # HTTP keepalive 지원</span>
</span></span><span class=line><span class=cl><span class=na>http-timeout</span> <span class=o>=</span> <span class=s>65                      # HTTP 요청 타임아웃 (초)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 버퍼 설정</span>
</span></span><span class=line><span class=cl><span class=na>buffer-size</span> <span class=o>=</span> <span class=s>32768                    # 요청 버퍼 크기</span>
</span></span><span class=line><span class=cl><span class=na>post-buffering</span> <span class=o>=</span> <span class=s>16384                 # POST 요청 버퍼 크기</span>
</span></span><span class=line><span class=cl><span class=na>socket-timeout</span> <span class=o>=</span> <span class=s>30                    # 소켓 타임아웃 (초)</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=리소스-관리-및-제한>리소스 관리 및 제한<a hidden class=anchor aria-hidden=true href=#리소스-관리-및-제한>#</a></h5><p>서버 리소스 사용을 제어하고 모니터링하기 위한 설정.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=c1># 메모리 제한</span>
</span></span><span class=line><span class=cl><span class=na>limit-as</span> <span class=o>=</span> <span class=s>256                         # 프로세스당 메모리 제한 (MB)</span>
</span></span><span class=line><span class=cl><span class=na>reload-on-rss</span> <span class=o>=</span> <span class=s>200                    # RSS 기반 리로드 임계값 (MB)</span>
</span></span><span class=line><span class=cl><span class=na>memory-report</span> <span class=o>=</span> <span class=s>true                   # 메모리 사용량 보고 활성화</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CPU 제한</span>
</span></span><span class=line><span class=cl><span class=na>harakiri</span> <span class=o>=</span> <span class=s>30                          # 요청 처리 제한 시간 (초)</span>
</span></span><span class=line><span class=cl><span class=na>harakiri-verbose</span> <span class=o>=</span> <span class=s>true                # 상세한 harakiri 로그</span>
</span></span><span class=line><span class=cl><span class=na>cpu-affinity</span> <span class=o>=</span> <span class=s>1                       # CPU 코어 할당</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 파일 설명자 제한</span>
</span></span><span class=line><span class=cl><span class=na>listen</span> <span class=o>=</span> <span class=s>2048                          # 리스닝 큐 크기</span>
</span></span><span class=line><span class=cl><span class=na>max-fd</span> <span class=o>=</span> <span class=s>51200                         # 최대 파일 설명자 수</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=로깅-및-디버깅>로깅 및 디버깅<a hidden class=anchor aria-hidden=true href=#로깅-및-디버깅>#</a></h5><p>애플리케이션 모니터링과 문제 해결을 위한 로깅 설정.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=c1># 로그 파일 설정</span>
</span></span><span class=line><span class=cl><span class=na>logto</span> <span class=o>=</span> <span class=s>/var/log/uwsgi/%n.log         # 로그 파일 경로</span>
</span></span><span class=line><span class=cl><span class=na>log-maxsize</span> <span class=o>=</span> <span class=s>20971520                 # 로그 파일 최대 크기 (bytes)</span>
</span></span><span class=line><span class=cl><span class=na>log-backupname</span> <span class=o>=</span> <span class=s>/var/log/uwsgi/%n.old.log  # 백업 로그 파일명</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 로그 레벨 설정</span>
</span></span><span class=line><span class=cl><span class=na>log-4xx</span> <span class=o>=</span> <span class=s>true                         # 4xx 에러 로깅</span>
</span></span><span class=line><span class=cl><span class=na>log-5xx</span> <span class=o>=</span> <span class=s>true                         # 5xx 에러 로깅</span>
</span></span><span class=line><span class=cl><span class=na>log-slow</span> <span class=o>=</span> <span class=s>true                        # 느린 요청 로깅</span>
</span></span><span class=line><span class=cl><span class=na>log-date</span> <span class=o>=</span> <span class=s>true                        # 타임스탬프 포함</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=자동-재시작-및-리로드>자동 재시작 및 리로드<a hidden class=anchor aria-hidden=true href=#자동-재시작-및-리로드>#</a></h5><p>애플리케이션의 안정성과 지속성을 보장하기 위한 설정.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6>6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7>7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8>8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=c1># 자동 재시작 설정</span>
</span></span><span class=line><span class=cl><span class=na>auto-procname</span> <span class=o>=</span> <span class=s>true                   # 프로세스 이름 자동 설정</span>
</span></span><span class=line><span class=cl><span class=na>touch-reload</span> <span class=o>=</span> <span class=s>/path/to/project/reload # 파일 변경 시 재시작</span>
</span></span><span class=line><span class=cl><span class=na>py-auto-reload</span> <span class=o>=</span> <span class=s>1                     # Python 파일 변경 감지</span>
</span></span><span class=line><span class=cl><span class=na>reload-mercy</span> <span class=o>=</span> <span class=s>8                       # 리로드 대기 시간 (초)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 재시작 조건 설정</span>
</span></span><span class=line><span class=cl><span class=na>max-requests</span> <span class=o>=</span> <span class=s>1000                    # 최대 요청 수 도달 시 재시작</span>
</span></span><span class=line><span class=cl><span class=na>max-worker-lifetime</span> <span class=o>=</span> <span class=s>3600             # 워커 최대 수명 (초)</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=성능-최적화>성능 최적화<a hidden class=anchor aria-hidden=true href=#성능-최적화>#</a></h5><p>애플리케이션의 성능을 향상시키기 위한 고급 설정.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=c1># 캐시 설정</span>
</span></span><span class=line><span class=cl><span class=na>cache2</span> <span class=o>=</span> <span class=s>name=mycache,items=100        # 캐시 설정</span>
</span></span><span class=line><span class=cl><span class=na>cache-blocksize</span> <span class=o>=</span> <span class=s>64                   # 캐시 블록 크기</span>
</span></span><span class=line><span class=cl><span class=na>cache-store</span> <span class=o>=</span> <span class=s>/tmp/uwsgicache         # 캐시 저장 위치</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 스레드 풀 설정</span>
</span></span><span class=line><span class=cl><span class=na>cheaper</span> <span class=o>=</span> <span class=s>2                            # 최소 프로세스 수</span>
</span></span><span class=line><span class=cl><span class=na>cheaper-algo</span> <span class=o>=</span> <span class=s>spare                   # 프로세스 스케일링 알고리즘</span>
</span></span><span class=line><span class=cl><span class=na>cheaper-step</span> <span class=o>=</span> <span class=s>1                       # 스케일링 단계</span>
</span></span><span class=line><span class=cl><span class=na>cheaper-idle</span> <span class=o>=</span> <span class=s>60                      # 스케일링을 축소하기 위해 필요한 유휴 시간</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=시스템-서비스-등록>시스템 서비스 등록<a hidden class=anchor aria-hidden=true href=#시스템-서비스-등록>#</a></h4><h5 id=systemd-서비스-파일을-작성>Systemd 서비스 파일을 작성<a hidden class=anchor aria-hidden=true href=#systemd-서비스-파일을-작성>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span><span class=lnt id=hl-10-16><a class=lnlinks href=#hl-10-16>16</a>
</span><span class=lnt id=hl-10-17><a class=lnlinks href=#hl-10-17>17</a>
</span><span class=lnt id=hl-10-18><a class=lnlinks href=#hl-10-18>18</a>
</span><span class=lnt id=hl-10-19><a class=lnlinks href=#hl-10-19>19</a>
</span><span class=lnt id=hl-10-20><a class=lnlinks href=#hl-10-20>20</a>
</span><span class=lnt id=hl-10-21><a class=lnlinks href=#hl-10-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[Unit]</span>
</span></span><span class=line><span class=cl><span class=na>Description</span><span class=o>=</span><span class=s>uWSGI instance to serve myproject</span>
</span></span><span class=line><span class=cl><span class=na>After</span><span class=o>=</span><span class=s>network.target</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>[Service]</span>
</span></span><span class=line><span class=cl><span class=na>User</span><span class=o>=</span><span class=s>www-data</span>
</span></span><span class=line><span class=cl><span class=na>Group</span><span class=o>=</span><span class=s>www-data</span>
</span></span><span class=line><span class=cl><span class=na>WorkingDirectory</span><span class=o>=</span><span class=s>/path/to/project</span>
</span></span><span class=line><span class=cl><span class=na>Environment</span><span class=o>=</span><span class=s>&#34;PATH=/path/to/project/venv/bin&#34;</span>
</span></span><span class=line><span class=cl><span class=na>ExecStart</span><span class=o>=</span><span class=s>/path/to/project/venv/bin/uwsgi --ini /path/to/project/uwsgi.ini</span>
</span></span><span class=line><span class=cl><span class=na>ExecReload</span><span class=o>=</span><span class=s>/bin/kill -HUP $MAINPID</span>
</span></span><span class=line><span class=cl><span class=na>KillSignal</span><span class=o>=</span><span class=s>SIGQUIT</span>
</span></span><span class=line><span class=cl><span class=na>Type</span><span class=o>=</span><span class=s>notify</span>
</span></span><span class=line><span class=cl><span class=na>NotifyAccess</span><span class=o>=</span><span class=s>all</span>
</span></span><span class=line><span class=cl><span class=na>Restart</span><span class=o>=</span><span class=s>always</span>
</span></span><span class=line><span class=cl><span class=na>RestartSec</span><span class=o>=</span><span class=s>5</span>
</span></span><span class=line><span class=cl><span class=na>StandardError</span><span class=o>=</span><span class=s>syslog</span>
</span></span><span class=line><span class=cl><span class=na>StandardOutput</span><span class=o>=</span><span class=s>syslog</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>[Install]</span>
</span></span><span class=line><span class=cl><span class=na>WantedBy</span><span class=o>=</span><span class=s>multi-user.target</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=서비스-파일을-시스템에-등록하고-활성화하는-방법>서비스 파일을 시스템에 등록하고 활성화하는 방법<a hidden class=anchor aria-hidden=true href=#서비스-파일을-시스템에-등록하고-활성화하는-방법>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 서비스 파일 복사</span>
</span></span><span class=line><span class=cl>sudo cp uwsgi.service /etc/systemd/system/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># systemd 데몬 리로드</span>
</span></span><span class=line><span class=cl>sudo systemctl daemon-reload
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 서비스 시작</span>
</span></span><span class=line><span class=cl>sudo systemctl start uwsgi
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 부팅 시 자동 시작 설정</span>
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> uwsgi
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 서비스 상태 확인</span>
</span></span><span class=line><span class=cl>sudo systemctl status uwsgi
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><p><a href=https://uwsgi-docs.readthedocs.io/en/latest/>Fetching Title#htpu</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/programming-languages/>Programming-Languages</a></li><li><a href=https://buenhyden.github.io/tags/python/>Python</a></li><li><a href=https://buenhyden.github.io/tags/library/>Library</a></li><li><a href=https://buenhyden.github.io/tags/web-application-server/>Web-Application-Server</a></li><li><a href=https://buenhyden.github.io/tags/uwsgi/>UWSGI</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/programming-languages/python/library/web-application-server/gunicorn/><span class=title>« Prev</span><br><span>gunicorn</span>
</a><a class=next href=https://buenhyden.github.io/posts/programming-languages/python/library/data-validation/pydantic/><span class=title>Next »</span><br><span>pydantic</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>