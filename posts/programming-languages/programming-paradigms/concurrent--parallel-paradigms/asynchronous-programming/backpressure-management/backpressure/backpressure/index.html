<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Backpressure | hyunyoun's Blog</title><meta name=keywords content="Backend Development,Migration-Strategies,Backpressure"><meta name=description content="**Backpressure**는 데이터 처리 시스템에서 수신 측이 송신 측에게 자신의 처리 용량을 알려 데이터 흐름을 제어하는 메커니즘이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/programming-languages/programming-paradigms/concurrent--parallel-paradigms/asynchronous-programming/backpressure-management/backpressure/backpressure/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/programming-languages/programming-paradigms/concurrent--parallel-paradigms/asynchronous-programming/backpressure-management/backpressure/backpressure/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/programming-languages/programming-paradigms/concurrent--parallel-paradigms/asynchronous-programming/backpressure-management/backpressure/backpressure/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Backpressure"><meta property="og:description" content="**Backpressure**는 데이터 처리 시스템에서 수신 측이 송신 측에게 자신의 처리 용량을 알려 데이터 흐름을 제어하는 메커니즘이다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-04-01T15:16:00+00:00"><meta property="article:modified_time" content="2025-04-01T15:16:00+00:00"><meta property="article:tag" content="Backend-Development"><meta property="article:tag" content="Migration-Strategies"><meta property="article:tag" content="Backpressure"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Backpressure"><meta name=twitter:description content="**Backpressure**는 데이터 처리 시스템에서 수신 측이 송신 측에게 자신의 처리 용량을 알려 데이터 흐름을 제어하는 메커니즘이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Backpressure","item":"https://buenhyden.github.io/posts/programming-languages/programming-paradigms/concurrent--parallel-paradigms/asynchronous-programming/backpressure-management/backpressure/backpressure/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Backpressure","name":"Backpressure","description":"**Backpressure**는 데이터 처리 시스템에서 수신 측이 송신 측에게 자신의 처리 용량을 알려 데이터 흐름을 제어하는 메커니즘이다.","keywords":["Backend Development","Migration-Strategies","Backpressure"],"articleBody":"Backpressure Backpressure는 데이터 처리 시스템에서 수신 측이 송신 측에게 자신의 처리 용량을 알려 데이터 흐름을 제어하는 메커니즘이다. 이는 시스템이 과부하 없이 안정적으로 작동하도록 하며, 특히 분산 시스템이나 대규모 데이터 스트리밍 환경에서 필수적이다.\n백프레셔의 기본 개념과 원리 백프레셔는 수신 구성 요소가 송신 구성 요소에게 데이터 처리 능력을 신호로 알려주는 흐름 제어 메커니즘이다. 이름의 유래는 파이프나 유체 시스템에서 역압력(back pressure)이 발생하는 물리적 현상에서 왔다.\n핵심 원리 수신측 제어: 데이터를 수신하는 시스템이 처리 가능한 양을 송신 시스템에 알림 피드백 루프: 송신측과 수신측 사이의 지속적인 커뮤니케이션 자기 조절: 시스템이 자체적으로 처리 속도를 조절하는 메커니즘 물리적 아날로그 물리적 시스템에서의 백프레셔 개념을 이해하면 소프트웨어에서의 적용이 더 명확해진다.\n물이 흐르는 파이프를 생각해보면:\n파이프 A가 파이프 B보다 더 빠르게 물을 보내면, 연결 지점에서 압력이 증가한다. 이 압력이 파이프 A로 전달되어 자연스럽게 흐름이 감소한다. 결과적으로 시스템은 가장 느린 구성 요소의 속도에 맞춰 동작한다. 소프트웨어 시스템에서도 이와 유사한 메커니즘이 필요하다. 데이터 생산자가 소비자보다 빠르게 생성하면, 소비자는 처리 능력을 알려 생산자가 속도를 조절하도록 한다.\n백프레셔가 필요한 이유와 문제점 백프레셔가 없는 시스템에서는 다양한 문제가 발생할 수 있다:\n주요 문제점 메모리 오버플로: 처리되지 않은 데이터가 메모리에 계속 쌓여 시스템 장애 유발 지연 증가: 처리 대기 중인 데이터가 증가하면서 응답 시간 증가 시스템 불안정: 리소스 부족으로 인한 예측 불가능한 동작과 장애 연쇄 실패: 한 구성 요소의 과부하가 전체 시스템으로 확산 시나리오 예시 웹 서버가 데이터베이스보다 훨씬 빠르게 요청을 생성하는 상황을 생각해보면:\n백프레셔 없음: 데이터베이스 연결 풀이 고갈되고, 요청이 계속 대기열에 쌓이며, 결국 메모리 부족으로 서버 충돌 백프레셔 적용: 데이터베이스가 과부하 상태임을 웹 서버에 알리고, 웹 서버는 일시적으로 새 요청 수락을 제한 Backpressure 발생 원인 생산자-소비자 불균형: Producer가 초당 1,000개의 메시지를 전송하지만 Consumer는 700개만 처리 가능한 경우. 리소스 제약: CPU, 메모리, 디스크 I/O 부족으로 인한 처리 지연. 네트워크 병목 현상: 대역폭 제한 또는 높은 레이턴시로 인한 데이터 누적. 비효율적인 로직: 복잡한 알고리즘으로 인한 처리 속도 저하. 백프레셔 구현 전략 백프레셔는 다양한 방식으로 구현될 수 있으며, 각 접근법은 특정 상황에 적합하다:\n버퍼링과 블로킹 가장 기본적인 백프레셔 형태로, 제한된 버퍼를 사용하고 가득 차면 생산자를 차단한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 // 자바에서 BlockingQueue를 사용한 백프레셔 예시 import java.util.concurrent.ArrayBlockingQueue; import java.util.concurrent.BlockingQueue; class Producer implements Runnable { private final BlockingQueue\u003cInteger\u003e queue; Producer(BlockingQueue\u003cInteger\u003e queue) { this.queue = queue; } @Override public void run() { try { for (int i = 0; i \u003c 100; i++) { // queue.put()은 공간이 생길 때까지 블로킹됨 - 자연스러운 백프레셔 queue.put(i); System.out.println(\"생산: \" + i); // 생산자가 소비자보다 빠른 상황 시뮬레이션 Thread.sleep(10); } } catch (InterruptedException e) { Thread.currentThread().interrupt(); } } } class Consumer implements Runnable { private final BlockingQueue\u003cInteger\u003e queue; Consumer(BlockingQueue\u003cInteger\u003e queue) { this.queue = queue; } @Override public void run() { try { while (true) { // 소비자는 더 느리게 처리 Thread.sleep(100); Integer value = queue.take(); System.out.println(\"소비: \" + value); } } catch (InterruptedException e) { Thread.currentThread().interrupt(); } } } // 메인 클래스 public class BackpressureExample { public static void main(String[] args) { // 크기가 10인 제한된 큐 - 백프레셔 메커니즘 역할 BlockingQueue\u003cInteger\u003e queue = new ArrayBlockingQueue\u003c\u003e(10); new Thread(new Producer(queue)).start(); new Thread(new Consumer(queue)).start(); } } 이 예제에서 큐가 가득 차면 put() 메서드는 자동으로 차단되어 생산자가 기다리게 된다. 이것이 가장 기본적인 형태의 백프레셔이다.\n푸시 기반 Vs 풀 기반 백프레셔 데이터 전송 방향에 따라 두 가지 주요 접근 방식이 있다:\n푸시 기반 (생산자 주도)\n생산자가 소비자에게 데이터를 전송 소비자는 처리 가능 여부를 생산자에게 알림 예: TCP 흐름 제어, RxJava의 Flowable 풀 기반 (소비자 주도)\n소비자가 처리할 준비가 되었을 때 데이터 요청 생산자는 요청된 양만큼만 생성 예: Iterator 패턴, JDK의 Flow API 비차단 백프레셔 전략 블로킹이 적합하지 않은 상황(예: 싱글 스레드, 비동기 시스템)에서는 다양한 비차단 전략이 사용된다:\n버퍼링 후 드롭\n버퍼가 가득 차면 새 항목 삭제 변형: 가장 오래된 항목 삭제, 우선순위 기반 삭제 샘플링\n일정 비율의 항목만 처리, 나머지는 무시 모든 데이터가 동등하게 중요하지 않을 때 유용 스로틀링\n특정 비율로 처리량 제한 예: 초당 최대 1000개 메시지만 허용 리액티브 프로그래밍에서의 백프레셔 리액티브 프로그래밍은 백프레셔 메커니즘이 가장 발전한 분야 중 하나이다:\nRxJava의 백프레셔 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 // RxJava 백프레셔 예시 import io.reactivex.rxjava3.core.Flowable; import io.reactivex.rxjava3.schedulers.Schedulers; import org.reactivestreams.Subscriber; import org.reactivestreams.Subscription; public class RxJavaBackpressureExample { public static void main(String[] args) throws InterruptedException { // 무한 시퀀스 생성 (잠재적으로 매우 빠름) Flowable\u003cInteger\u003e flowable = Flowable.range(1, Integer.MAX_VALUE) .onBackpressureBuffer(1000) // 백프레셔 전략 지정 - 1000개 버퍼 .observeOn(Schedulers.computation()); // 느린 소비자 구현 flowable.subscribe(new Subscriber\u003cInteger\u003e() { private Subscription subscription; @Override public void onSubscribe(Subscription s) { this.subscription = s; // 초기 요청 - 백프레셔의 핵심 부분 s.request(10); } @Override public void onNext(Integer value) { System.out.println(\"처리 중: \" + value); try { // 느린 처리 시뮬레이션 Thread.sleep(100); } catch (InterruptedException e) { Thread.currentThread().interrupt(); } // 항목을 처리한 후 1개 더 요청 - 소비자가 페이스 제어 subscription.request(1); } @Override public void onError(Throwable t) { t.printStackTrace(); } @Override public void onComplete() { System.out.println(\"완료!\"); } }); // 메인 스레드가 종료되지 않도록 대기 Thread.sleep(10000); } } RxJava는 다양한 백프레셔 전략을 제공한다:\nonBackpressureBuffer(): 지정된 크기의 버퍼 사용 onBackpressureDrop(): 처리할 수 없는 항목 삭제 onBackpressureLatest(): 최신 항목만 유지, 나머지 삭제 Project Reactor Spring WebFlux 등에서 사용되는 Reactor도 유사한 백프레셔 메커니즘을 제공한다:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 // Reactor 백프레셔 예시 import reactor.core.publisher.Flux; public class ReactorBackpressureExample { public static void main(String[] args) throws InterruptedException { // 백프레셔 지원 스트림 생성 Flux\u003cInteger\u003e flux = Flux.range(1, 100) .log() // 이벤트 로깅 .limitRate(10); // 백프레셔 - 한 번에 최대 10개 요청 // 구독 및 소비 flux.subscribe(value -\u003e { try { // 느린 소비자 시뮬레이션 Thread.sleep(100); System.out.println(\"처리됨: \" + value); } catch (InterruptedException e) { Thread.currentThread().interrupt(); } }); // 메인 스레드 대기 Thread.sleep(15000); } } Reactor의 limitRate()는 소비자가 한 번에 요청할 수 있는 항목 수를 제한하는 간단한 백프레셔 메커니즘을 제공한다.\n메시징 시스템에서의 백프레셔 메시지 큐와 스트리밍 플랫폼은 백프레셔에 매우 의존한다:\nKafka의 백프레셔 Kafka 소비자는 풀 기반 모델로 백프레셔를 구현한다:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 // Kafka 소비자 백프레셔 예시 import org.apache.kafka.clients.consumer.*; import java.time.Duration; import java.util.*; public class KafkaConsumerBackpressure { public static void main(String[] args) { Properties props = new Properties(); props.put(\"bootstrap.servers\", \"localhost:9092\"); props.put(\"group.id\", \"backpressure-group\"); props.put(\"key.deserializer\", \"org.apache.kafka.common.serialization.StringDeserializer\"); props.put(\"value.deserializer\", \"org.apache.kafka.common.serialization.StringDeserializer\"); // 백프레셔와 관련된 중요 설정 props.put(\"max.poll.records\", 10); // 한 번에 최대 10개 레코드 처리 props.put(\"enable.auto.commit\", \"false\"); // 수동 커밋 사용 KafkaConsumer\u003cString, String\u003e consumer = new KafkaConsumer\u003c\u003e(props); consumer.subscribe(Arrays.asList(\"topic-with-backpressure\")); try { while (true) { // 소비자가 처리 속도 제어 - 백프레셔의 핵심 ConsumerRecords\u003cString, String\u003e records = consumer.poll(Duration.ofMillis(100)); for (ConsumerRecord\u003cString, String\u003e record : records) { // 메시지 처리 - 실제 구현에서는 시간이 걸리는 작업 System.out.println(\"처리: \" + record.value()); slowOperation(); // 가정: 시간이 걸리는 작업 } // 처리 완료 후 커밋 - 다음 배치를 가져오기 전에 consumer.commitSync(); } } finally { consumer.close(); } } static void slowOperation() { try { Thread.sleep(200); // 느린 처리 시뮬레이션 } catch (InterruptedException e) { Thread.currentThread().interrupt(); } } } Kafka 소비자는 max.poll.records와 수동 커밋을 통해 처리 속도를 제어한다. 소비자가 다 처리하기 전까지는 새 메시지를 가져오지 않는다.\nRabbitMQ의 백프레셔 RabbitMQ는 prefetch count를 통해 백프레셔를 구현한다:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 // RabbitMQ 백프레셔 예시 import com.rabbitmq.client.*; public class RabbitMQBackpressure { private final static String QUEUE_NAME = \"backpressure_queue\"; public static void main(String[] args) throws Exception { ConnectionFactory factory = new ConnectionFactory(); factory.setHost(\"localhost\"); Connection connection = factory.newConnection(); Channel channel = connection.createChannel(); channel.queueDeclare(QUEUE_NAME, true, false, false, null); // 백프레셔 설정 - 한 번에 처리할 수 있는 메시지 수 제한 int prefetchCount = 10; channel.basicQos(prefetchCount); System.out.println(\"메시지 수신 대기 중…\"); // 소비자 설정 DeliverCallback deliverCallback = (consumerTag, delivery) -\u003e { String message = new String(delivery.getBody(), \"UTF-8\"); System.out.println(\"메시지 수신: \" + message); try { // 시간이 걸리는 작업 시뮬레이션 Thread.sleep(500); } catch (InterruptedException e) { Thread.currentThread().interrupt(); } finally { System.out.println(\"메시지 처리 완료: \" + message); // 수동 확인 - 메시지 처리 완료 후에만 승인 channel.basicAck(delivery.getEnvelope().getDeliveryTag(), false); } }; // autoAck를 false로 설정하여 수동 확인 모드 사용 channel.basicConsume(QUEUE_NAME, false, deliverCallback, consumerTag -\u003e {}); } } RabbitMQ의 basicQos 메서드는 소비자가 동시에 처리할 수 있는 메시지 수를 제한한다. 메시지를 처리한 후에만 basicAck를 호출하여 확인함으로써 백프레셔를 구현한다.\n네트워크 프로토콜에서의 백프레셔 네트워크 수준의 백프레셔는 시스템 안정성에 중요하다:\nTCP 흐름 제어\nTCP는 기본적인 형태의 백프레셔를 제공한다:\n수신 윈도우(receive window)를 통해 수신측의 버퍼 가용성 광고 슬라이딩 윈도우 메커니즘으로 과부하 방지 혼잡 제어 알고리즘으로 네트워크 용량에 적응 HTTP/2 흐름 제어\nHTTP/2는 TCP 위에 추가적인 백프레셔 메커니즘을 도입했다:\n스트림별 흐름 제어 수신측이 WINDOW_UPDATE 프레임으로 처리 가능한 데이터 양 알림 중앙집중식 우선순위 지정으로 중요 리소스 먼저 처리 gRPC 백프레셔\ngRPC는 HTTP/2 기반으로 백프레셔를 상속하며 추가 기능을 제공한다:\n스트리밍 RPC에서 클라이언트/서버 모두 처리 속도 제어 가능 양방향 스트리밍에서 양쪽 모두 백프레셔 적용 서버 스트리밍 RPC에서 클라이언트가 처리 속도 조절 백프레셔 패턴 및 설계 원칙 효과적인 백프레셔 구현을 위한 일반적인 패턴과 원칙:\n버퍼 관리\n유한 버퍼: 항상 크기 제한 있는 버퍼 사용 버퍼 크기 설정: 처리 시간과 지연 사이 적절한 균형 찾기 모니터링: 버퍼 사용률 모니터링으로 문제 조기 감지 대기열 정책\nFIFO 대기열: 가장 기본적인 형태 우선순위 대기열: 중요한 항목 먼저 처리 지연 대기열: 처리 시간이 다른 항목 관리 알림 메커니즘\n신호 기반: 특정 임계값에 도달하면 생산자에게 알림 토큰 기반: 소비자가 토큰 발행, 생산자는 토큰당 하나의 항목 전송 피드백 루프: 시스템 상태에 따라 생산 속도 동적 조정 Backpressure 구현 사례 1. Node.js 스트림 highWaterMark 설정: 기본값 16KB에서 처리량 조절 가능.\ndrain 이벤트: 쓰기 버퍼가 비워지면 자동으로 데이터 전송 재개.\n1 2 3 4 5 6 const stream = fs.createWriteStream('file.txt'); stream.write(data, () =\u003e { if (!stream.write(data)) { stream.once('drain', resumeProcessing); } }); 2. Apache Storm ZooKeeper 피드백: Bolt의 큐가 가득 차면 ZooKeeper에 상태 기록, Spout이 전송 중지. 3. AWS Kinesis PutRecordBatch 제한: 샤드당 초당 최대 1,000개 레코드 처리로 백프레셔 강제 적용. Backpressure Vs. Throttling 특성 Backpressure Throttling 제어 주체 Consumer-driven Producer-driven 적응성 실시간 동적 조절 사전 정의된 정적 제한 사용 사례 데이터 파이프라인, 스트리밍 API 호출 제한, 리소스 보호 장점 리소스 사용 최적화 구현 간단성 백프레셔 구현 시 도전 과제 및 해결책 백프레셔를 구현할 때 발생하는 일반적인 문제와 해결책:\n데드락 방지\n문제: 생산자와 소비자가 서로 기다리는 데드락 상황 해결책: 비차단 대기열, 타임아웃, 서킷 브레이커 패턴 리소스 관리\n문제: 버퍼가 많아질수록 메모리 사용량 증가 해결책: 적절한 버퍼 크기 선택, 메모리 사용량 모니터링 부하 테스트\n문제: 백프레셔가 효과적인지 확인하기 어려움 해결책: 카오스 엔지니어링 접근 방식, 부하 테스트로 검증 모니터링 및 디버깅\n문제: 백프레셔 메커니즘의 내부 상태 파악 어려움 해결책: 상세 로깅, 메트릭 수집, 대시보드 구축 백프레셔와 관련된 패턴 및 기술 백프레셔와 함께 자주 사용되는 패턴과 기술:\n서킷 브레이커 패턴 서킷 브레이커는 백프레셔와 상호 보완적으로 작동한다:\n백프레셔: 처리 속도를 제어하여 과부하 방지 서킷 브레이커: 장애 발생 시 호출 차단으로 연쇄 실패 방지 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 // 서킷 브레이커와 백프레셔 조합 예시 (간소화) public class ServiceWithBackpressureAndCircuitBreaker { private final CircuitBreaker circuitBreaker; private final Semaphore backpressureSemaphore; public ServiceWithBackpressureAndCircuitBreaker(int concurrencyLimit) { this.circuitBreaker = new CircuitBreaker(/* 설정 */); this.backpressureSemaphore = new Semaphore(concurrencyLimit); } public Response processRequest(Request request) throws Exception { // 백프레셔: 동시 요청 수 제한 if (!backpressureSemaphore.tryAcquire()) { throw new OverloadException(\"서비스 과부하, 나중에 다시 시도하세요\"); } try { // 서킷 브레이커: 의존성 호출 보호 return circuitBreaker.execute(() -\u003e { // 실제 서비스 호출 return callExternalService(request); }); } finally { backpressureSemaphore.release(); } } private Response callExternalService(Request request) { // 외부 서비스 호출 구현 return new Response(); } // 내부 클래스들 (실제 구현에서는 별도 파일이어야 함) static class Request {} static class Response {} static class OverloadException extends Exception { public OverloadException(String message) { super(message); } } // 간소화된 서킷 브레이커 구현 static class CircuitBreaker { // 실제 구현은 더 복잡함 public \u003cT\u003e T execute(Supplier\u003cT\u003e supplier) { return supplier.get(); } } } 벌크헤드 패턴 시스템을 격리된 구획으로 분리하여 장애 전파를 방지한다:\n각 구획에 별도의 백프레셔 메커니즘 적용 리소스 할당량 설정으로 과부하 방지 한 구획의 실패가 전체 시스템에 영향 미치지 않음 스로틀링과 레이트 리미팅 백프레셔와 함께 사용하여 시스템 부하 관리:\n스로틀링: 전체 처리량 제한 레이트 리미팅: 클라이언트별 요청 제한 백프레셔: 시스템 용량에 따른 처리 속도 조절 백프레셔 패턴의 발전 백프레셔는 소프트웨어 설계와 시스템 아키텍처에서 점점 더 중요한 개념이 되고 있으며, 그 적용 범위가 확장되고 있다:\n반응형 시스템의 핵심 원칙\n반응형 매니페스토(Reactive Manifesto)는 백프레셔를 반응형 시스템의 핵심 원칙으로 강조한다:\n응답성: 백프레셔는 시스템이 부하 하에서도 응답을 유지하도록 도움 복원성: 과부하 방지를 통한 시스템 안정성 향상 탄력성: 부하 변화에 적응하는 능력 메시지 기반: 비동기 메시지 전달을 통한 결합도 감소 클라우드 네이티브 애플리케이션\n클라우드 환경에서 백프레셔는 더욱 중요해지고 있다:\n자동 확장: 백프레셔 메트릭을 자동 확장 트리거로 활용 서비스 메시: 시스템 전반의 백프레셔 관리 컨테이너 조정: 리소스 한계 설정을 통한 컨테이너 수준 백프레셔 이벤트 기반 아키텍처\n이벤트 스트리밍 플랫폼에서 백프레셔는 데이터 흐름 관리에 필수적이다:\n소비자 그룹 오프셋 관리: 소비자 속도에 맞춘 이벤트 처리 파티셔닝: 백프레셔 단위를 개별 파티션으로 세분화 병렬 처리: 처리 용량을 최대화하면서 과부하 방지 용어 정리 용어 설명 참고 및 출처 ","wordCount":"2240","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2025-04-01T15:16:00Z","dateModified":"2025-04-01T15:16:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/programming-languages/programming-paradigms/concurrent--parallel-paradigms/asynchronous-programming/backpressure-management/backpressure/backpressure/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a></div><h1 class="post-title entry-hint-parent">Backpressure</h1><div class=post-description>**Backpressure**는 데이터 처리 시스템에서 수신 측이 송신 측에게 자신의 처리 용량을 알려 데이터 흐름을 제어하는 메커니즘이다.</div><div class=post-meta><span title='2025-04-01 15:16:00 +0000 UTC'>April 1, 2025</span>&nbsp;·&nbsp;11 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/Programming%20Languages/Programming%20Paradigms/Concurrent%20&%20Parallel%20Paradigms/Asynchronous%20Programming/Backpressure%20Management/Backpressure/Backpressure.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#backpressure>Backpressure</a><ul><li><a href=#백프레셔의-기본-개념과-원리>백프레셔의 기본 개념과 원리</a></li><li><a href=#백프레셔가-필요한-이유와-문제점>백프레셔가 필요한 이유와 문제점</a></li><li><a href=#backpressure-발생-원인><strong>Backpressure 발생 원인</strong></a></li><li><a href=#백프레셔-구현-전략>백프레셔 구현 전략</a></li><li><a href=#리액티브-프로그래밍에서의-백프레셔>리액티브 프로그래밍에서의 백프레셔</a></li><li><a href=#메시징-시스템에서의-백프레셔>메시징 시스템에서의 백프레셔</a></li><li><a href=#네트워크-프로토콜에서의-백프레셔>네트워크 프로토콜에서의 백프레셔</a></li><li><a href=#백프레셔-패턴-및-설계-원칙>백프레셔 패턴 및 설계 원칙</a></li><li><a href=#backpressure-구현-사례><strong>Backpressure 구현 사례</strong></a></li><li><a href=#backpressure-vs-throttling><strong>Backpressure Vs. Throttling</strong></a></li><li><a href=#백프레셔-구현-시-도전-과제-및-해결책>백프레셔 구현 시 도전 과제 및 해결책</a></li><li><a href=#백프레셔와-관련된-패턴-및-기술>백프레셔와 관련된 패턴 및 기술</a></li><li><a href=#백프레셔-패턴의-발전>백프레셔 패턴의 발전</a></li></ul></li><li><a href=#용어-정리>용어 정리</a></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=backpressure>Backpressure<a hidden class=anchor aria-hidden=true href=#backpressure>#</a></h2><p><strong>Backpressure</strong>는 데이터 처리 시스템에서 수신 측이 송신 측에게 자신의 처리 용량을 알려 데이터 흐름을 제어하는 메커니즘이다. 이는 시스템이 과부하 없이 안정적으로 작동하도록 하며, 특히 분산 시스템이나 대규모 데이터 스트리밍 환경에서 필수적이다.</p><h3 id=백프레셔의-기본-개념과-원리>백프레셔의 기본 개념과 원리<a hidden class=anchor aria-hidden=true href=#백프레셔의-기본-개념과-원리>#</a></h3><p>백프레셔는 수신 구성 요소가 송신 구성 요소에게 데이터 처리 능력을 신호로 알려주는 흐름 제어 메커니즘이다. 이름의 유래는 파이프나 유체 시스템에서 역압력(back pressure)이 발생하는 물리적 현상에서 왔다.</p><h4 id=핵심-원리>핵심 원리<a hidden class=anchor aria-hidden=true href=#핵심-원리>#</a></h4><ul><li><strong>수신측 제어</strong>: 데이터를 수신하는 시스템이 처리 가능한 양을 송신 시스템에 알림</li><li><strong>피드백 루프</strong>: 송신측과 수신측 사이의 지속적인 커뮤니케이션</li><li><strong>자기 조절</strong>: 시스템이 자체적으로 처리 속도를 조절하는 메커니즘</li></ul><h4 id=물리적-아날로그>물리적 아날로그<a hidden class=anchor aria-hidden=true href=#물리적-아날로그>#</a></h4><p>물리적 시스템에서의 백프레셔 개념을 이해하면 소프트웨어에서의 적용이 더 명확해진다.</p><p>물이 흐르는 파이프를 생각해보면:</p><ol><li>파이프 A가 파이프 B보다 더 빠르게 물을 보내면, 연결 지점에서 압력이 증가한다.</li><li>이 압력이 파이프 A로 전달되어 자연스럽게 흐름이 감소한다.</li><li>결과적으로 시스템은 가장 느린 구성 요소의 속도에 맞춰 동작한다.</li></ol><p>소프트웨어 시스템에서도 이와 유사한 메커니즘이 필요하다. 데이터 생산자가 소비자보다 빠르게 생성하면, 소비자는 처리 능력을 알려 생산자가 속도를 조절하도록 한다.</p><h3 id=백프레셔가-필요한-이유와-문제점>백프레셔가 필요한 이유와 문제점<a hidden class=anchor aria-hidden=true href=#백프레셔가-필요한-이유와-문제점>#</a></h3><p>백프레셔가 없는 시스템에서는 다양한 문제가 발생할 수 있다:</p><h4 id=주요-문제점>주요 문제점<a hidden class=anchor aria-hidden=true href=#주요-문제점>#</a></h4><ul><li><strong>메모리 오버플로</strong>: 처리되지 않은 데이터가 메모리에 계속 쌓여 시스템 장애 유발</li><li><strong>지연 증가</strong>: 처리 대기 중인 데이터가 증가하면서 응답 시간 증가</li><li><strong>시스템 불안정</strong>: 리소스 부족으로 인한 예측 불가능한 동작과 장애</li><li><strong>연쇄 실패</strong>: 한 구성 요소의 과부하가 전체 시스템으로 확산</li></ul><h4 id=시나리오-예시>시나리오 예시<a hidden class=anchor aria-hidden=true href=#시나리오-예시>#</a></h4><p>웹 서버가 데이터베이스보다 훨씬 빠르게 요청을 생성하는 상황을 생각해보면:</p><ol><li>백프레셔 없음: 데이터베이스 연결 풀이 고갈되고, 요청이 계속 대기열에 쌓이며, 결국 메모리 부족으로 서버 충돌</li><li>백프레셔 적용: 데이터베이스가 과부하 상태임을 웹 서버에 알리고, 웹 서버는 일시적으로 새 요청 수락을 제한</li></ol><h3 id=backpressure-발생-원인><strong>Backpressure 발생 원인</strong><a hidden class=anchor aria-hidden=true href=#backpressure-발생-원인>#</a></h3><ol><li><strong>생산자-소비자 불균형</strong>:<ul><li>Producer가 초당 1,000개의 메시지를 전송하지만 Consumer는 700개만 처리 가능한 경우.</li></ul></li><li><strong>리소스 제약</strong>:<ul><li>CPU, 메모리, 디스크 I/O 부족으로 인한 처리 지연.</li></ul></li><li><strong>네트워크 병목 현상</strong>:<ul><li>대역폭 제한 또는 높은 레이턴시로 인한 데이터 누적.</li></ul></li><li><strong>비효율적인 로직</strong>:<ul><li>복잡한 알고리즘으로 인한 처리 속도 저하.</li></ul></li></ol><h3 id=백프레셔-구현-전략>백프레셔 구현 전략<a hidden class=anchor aria-hidden=true href=#백프레셔-구현-전략>#</a></h3><p>백프레셔는 다양한 방식으로 구현될 수 있으며, 각 접근법은 특정 상황에 적합하다:</p><h4 id=버퍼링과-블로킹>버퍼링과 블로킹<a hidden class=anchor aria-hidden=true href=#버퍼링과-블로킹>#</a></h4><p>가장 기본적인 백프레셔 형태로, 제한된 버퍼를 사용하고 가득 차면 생산자를 차단한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21>21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22>22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23>23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24>24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25>25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26>26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27>27</a>
</span><span class=lnt id=hl-0-28><a class=lnlinks href=#hl-0-28>28</a>
</span><span class=lnt id=hl-0-29><a class=lnlinks href=#hl-0-29>29</a>
</span><span class=lnt id=hl-0-30><a class=lnlinks href=#hl-0-30>30</a>
</span><span class=lnt id=hl-0-31><a class=lnlinks href=#hl-0-31>31</a>
</span><span class=lnt id=hl-0-32><a class=lnlinks href=#hl-0-32>32</a>
</span><span class=lnt id=hl-0-33><a class=lnlinks href=#hl-0-33>33</a>
</span><span class=lnt id=hl-0-34><a class=lnlinks href=#hl-0-34>34</a>
</span><span class=lnt id=hl-0-35><a class=lnlinks href=#hl-0-35>35</a>
</span><span class=lnt id=hl-0-36><a class=lnlinks href=#hl-0-36>36</a>
</span><span class=lnt id=hl-0-37><a class=lnlinks href=#hl-0-37>37</a>
</span><span class=lnt id=hl-0-38><a class=lnlinks href=#hl-0-38>38</a>
</span><span class=lnt id=hl-0-39><a class=lnlinks href=#hl-0-39>39</a>
</span><span class=lnt id=hl-0-40><a class=lnlinks href=#hl-0-40>40</a>
</span><span class=lnt id=hl-0-41><a class=lnlinks href=#hl-0-41>41</a>
</span><span class=lnt id=hl-0-42><a class=lnlinks href=#hl-0-42>42</a>
</span><span class=lnt id=hl-0-43><a class=lnlinks href=#hl-0-43>43</a>
</span><span class=lnt id=hl-0-44><a class=lnlinks href=#hl-0-44>44</a>
</span><span class=lnt id=hl-0-45><a class=lnlinks href=#hl-0-45>45</a>
</span><span class=lnt id=hl-0-46><a class=lnlinks href=#hl-0-46>46</a>
</span><span class=lnt id=hl-0-47><a class=lnlinks href=#hl-0-47>47</a>
</span><span class=lnt id=hl-0-48><a class=lnlinks href=#hl-0-48>48</a>
</span><span class=lnt id=hl-0-49><a class=lnlinks href=#hl-0-49>49</a>
</span><span class=lnt id=hl-0-50><a class=lnlinks href=#hl-0-50>50</a>
</span><span class=lnt id=hl-0-51><a class=lnlinks href=#hl-0-51>51</a>
</span><span class=lnt id=hl-0-52><a class=lnlinks href=#hl-0-52>52</a>
</span><span class=lnt id=hl-0-53><a class=lnlinks href=#hl-0-53>53</a>
</span><span class=lnt id=hl-0-54><a class=lnlinks href=#hl-0-54>54</a>
</span><span class=lnt id=hl-0-55><a class=lnlinks href=#hl-0-55>55</a>
</span><span class=lnt id=hl-0-56><a class=lnlinks href=#hl-0-56>56</a>
</span><span class=lnt id=hl-0-57><a class=lnlinks href=#hl-0-57>57</a>
</span><span class=lnt id=hl-0-58><a class=lnlinks href=#hl-0-58>58</a>
</span><span class=lnt id=hl-0-59><a class=lnlinks href=#hl-0-59>59</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 자바에서 BlockingQueue를 사용한 백프레셔 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.concurrent.ArrayBlockingQueue</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.concurrent.BlockingQueue</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>class</span> <span class=nc>Producer</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Runnable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>BlockingQueue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=w> </span><span class=n>queue</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Producer</span><span class=p>(</span><span class=n>BlockingQueue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=w> </span><span class=n>queue</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>queue</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>queue</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>run</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>100</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// queue.put()은 공간이 생길 때까지 블로킹됨 - 자연스러운 백프레셔</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>queue</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>i</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;생산: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>i</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 생산자가 소비자보다 빠른 상황 시뮬레이션</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Thread</span><span class=p>.</span><span class=na>sleep</span><span class=p>(</span><span class=n>10</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>InterruptedException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Thread</span><span class=p>.</span><span class=na>currentThread</span><span class=p>().</span><span class=na>interrupt</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>class</span> <span class=nc>Consumer</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Runnable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>BlockingQueue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=w> </span><span class=n>queue</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Consumer</span><span class=p>(</span><span class=n>BlockingQueue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=w> </span><span class=n>queue</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>queue</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>queue</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>run</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=kc>true</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 소비자는 더 느리게 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Thread</span><span class=p>.</span><span class=na>sleep</span><span class=p>(</span><span class=n>100</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Integer</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>queue</span><span class=p>.</span><span class=na>take</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;소비: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>value</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>InterruptedException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Thread</span><span class=p>.</span><span class=na>currentThread</span><span class=p>().</span><span class=na>interrupt</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 메인 클래스</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>BackpressureExample</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 크기가 10인 제한된 큐 - 백프레셔 메커니즘 역할</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>BlockingQueue</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=w> </span><span class=n>queue</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ArrayBlockingQueue</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>10</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>new</span><span class=w> </span><span class=n>Thread</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>Producer</span><span class=p>(</span><span class=n>queue</span><span class=p>)).</span><span class=na>start</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>new</span><span class=w> </span><span class=n>Thread</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>Consumer</span><span class=p>(</span><span class=n>queue</span><span class=p>)).</span><span class=na>start</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>이 예제에서 큐가 가득 차면 <code>put()</code> 메서드는 자동으로 차단되어 생산자가 기다리게 된다. 이것이 가장 기본적인 형태의 백프레셔이다.</p><h4 id=푸시-기반-vs-풀-기반-백프레셔>푸시 기반 Vs 풀 기반 백프레셔<a hidden class=anchor aria-hidden=true href=#푸시-기반-vs-풀-기반-백프레셔>#</a></h4><p>데이터 전송 방향에 따라 두 가지 주요 접근 방식이 있다:</p><ol><li><p>푸시 기반 (생산자 주도)</p><ul><li>생산자가 소비자에게 데이터를 전송</li><li>소비자는 처리 가능 여부를 생산자에게 알림</li><li>예: TCP 흐름 제어, RxJava의 Flowable</li></ul></li><li><p>풀 기반 (소비자 주도)</p><ul><li>소비자가 처리할 준비가 되었을 때 데이터 요청</li><li>생산자는 요청된 양만큼만 생성</li><li>예: Iterator 패턴, JDK의 Flow API</li></ul></li></ol><h4 id=비차단-백프레셔-전략>비차단 백프레셔 전략<a hidden class=anchor aria-hidden=true href=#비차단-백프레셔-전략>#</a></h4><p>블로킹이 적합하지 않은 상황(예: 싱글 스레드, 비동기 시스템)에서는 다양한 비차단 전략이 사용된다:</p><ol><li><p>버퍼링 후 드롭</p><ul><li>버퍼가 가득 차면 새 항목 삭제</li><li>변형: 가장 오래된 항목 삭제, 우선순위 기반 삭제</li></ul></li><li><p>샘플링</p><ul><li>일정 비율의 항목만 처리, 나머지는 무시</li><li>모든 데이터가 동등하게 중요하지 않을 때 유용</li></ul></li><li><p>스로틀링</p><ul><li>특정 비율로 처리량 제한</li><li>예: 초당 최대 1000개 메시지만 허용</li></ul></li></ol><h3 id=리액티브-프로그래밍에서의-백프레셔>리액티브 프로그래밍에서의 백프레셔<a hidden class=anchor aria-hidden=true href=#리액티브-프로그래밍에서의-백프레셔>#</a></h3><p>리액티브 프로그래밍은 백프레셔 메커니즘이 가장 발전한 분야 중 하나이다:</p><h4 id=rxjava의-백프레셔>RxJava의 백프레셔<a hidden class=anchor aria-hidden=true href=#rxjava의-백프레셔>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16>16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17>17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18>18</a>
</span><span class=lnt id=hl-1-19><a class=lnlinks href=#hl-1-19>19</a>
</span><span class=lnt id=hl-1-20><a class=lnlinks href=#hl-1-20>20</a>
</span><span class=lnt id=hl-1-21><a class=lnlinks href=#hl-1-21>21</a>
</span><span class=lnt id=hl-1-22><a class=lnlinks href=#hl-1-22>22</a>
</span><span class=lnt id=hl-1-23><a class=lnlinks href=#hl-1-23>23</a>
</span><span class=lnt id=hl-1-24><a class=lnlinks href=#hl-1-24>24</a>
</span><span class=lnt id=hl-1-25><a class=lnlinks href=#hl-1-25>25</a>
</span><span class=lnt id=hl-1-26><a class=lnlinks href=#hl-1-26>26</a>
</span><span class=lnt id=hl-1-27><a class=lnlinks href=#hl-1-27>27</a>
</span><span class=lnt id=hl-1-28><a class=lnlinks href=#hl-1-28>28</a>
</span><span class=lnt id=hl-1-29><a class=lnlinks href=#hl-1-29>29</a>
</span><span class=lnt id=hl-1-30><a class=lnlinks href=#hl-1-30>30</a>
</span><span class=lnt id=hl-1-31><a class=lnlinks href=#hl-1-31>31</a>
</span><span class=lnt id=hl-1-32><a class=lnlinks href=#hl-1-32>32</a>
</span><span class=lnt id=hl-1-33><a class=lnlinks href=#hl-1-33>33</a>
</span><span class=lnt id=hl-1-34><a class=lnlinks href=#hl-1-34>34</a>
</span><span class=lnt id=hl-1-35><a class=lnlinks href=#hl-1-35>35</a>
</span><span class=lnt id=hl-1-36><a class=lnlinks href=#hl-1-36>36</a>
</span><span class=lnt id=hl-1-37><a class=lnlinks href=#hl-1-37>37</a>
</span><span class=lnt id=hl-1-38><a class=lnlinks href=#hl-1-38>38</a>
</span><span class=lnt id=hl-1-39><a class=lnlinks href=#hl-1-39>39</a>
</span><span class=lnt id=hl-1-40><a class=lnlinks href=#hl-1-40>40</a>
</span><span class=lnt id=hl-1-41><a class=lnlinks href=#hl-1-41>41</a>
</span><span class=lnt id=hl-1-42><a class=lnlinks href=#hl-1-42>42</a>
</span><span class=lnt id=hl-1-43><a class=lnlinks href=#hl-1-43>43</a>
</span><span class=lnt id=hl-1-44><a class=lnlinks href=#hl-1-44>44</a>
</span><span class=lnt id=hl-1-45><a class=lnlinks href=#hl-1-45>45</a>
</span><span class=lnt id=hl-1-46><a class=lnlinks href=#hl-1-46>46</a>
</span><span class=lnt id=hl-1-47><a class=lnlinks href=#hl-1-47>47</a>
</span><span class=lnt id=hl-1-48><a class=lnlinks href=#hl-1-48>48</a>
</span><span class=lnt id=hl-1-49><a class=lnlinks href=#hl-1-49>49</a>
</span><span class=lnt id=hl-1-50><a class=lnlinks href=#hl-1-50>50</a>
</span><span class=lnt id=hl-1-51><a class=lnlinks href=#hl-1-51>51</a>
</span><span class=lnt id=hl-1-52><a class=lnlinks href=#hl-1-52>52</a>
</span><span class=lnt id=hl-1-53><a class=lnlinks href=#hl-1-53>53</a>
</span><span class=lnt id=hl-1-54><a class=lnlinks href=#hl-1-54>54</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// RxJava 백프레셔 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>io.reactivex.rxjava3.core.Flowable</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>io.reactivex.rxjava3.schedulers.Schedulers</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.reactivestreams.Subscriber</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.reactivestreams.Subscription</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>RxJavaBackpressureExample</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>InterruptedException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 무한 시퀀스 생성 (잠재적으로 매우 빠름)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Flowable</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=w> </span><span class=n>flowable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Flowable</span><span class=p>.</span><span class=na>range</span><span class=p>(</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>Integer</span><span class=p>.</span><span class=na>MAX_VALUE</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>onBackpressureBuffer</span><span class=p>(</span><span class=n>1000</span><span class=p>)</span><span class=w> </span><span class=c1>// 백프레셔 전략 지정 - 1000개 버퍼</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>observeOn</span><span class=p>(</span><span class=n>Schedulers</span><span class=p>.</span><span class=na>computation</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 느린 소비자 구현</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>flowable</span><span class=p>.</span><span class=na>subscribe</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>Subscriber</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kd>private</span><span class=w> </span><span class=n>Subscription</span><span class=w> </span><span class=n>subscription</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onSubscribe</span><span class=p>(</span><span class=n>Subscription</span><span class=w> </span><span class=n>s</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>this</span><span class=p>.</span><span class=na>subscription</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>s</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 초기 요청 - 백프레셔의 핵심 부분</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>s</span><span class=p>.</span><span class=na>request</span><span class=p>(</span><span class=n>10</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onNext</span><span class=p>(</span><span class=n>Integer</span><span class=w> </span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;처리 중: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>value</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=c1>// 느린 처리 시뮬레이션</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>Thread</span><span class=p>.</span><span class=na>sleep</span><span class=p>(</span><span class=n>100</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>InterruptedException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>Thread</span><span class=p>.</span><span class=na>currentThread</span><span class=p>().</span><span class=na>interrupt</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 항목을 처리한 후 1개 더 요청 - 소비자가 페이스 제어</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>subscription</span><span class=p>.</span><span class=na>request</span><span class=p>(</span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onError</span><span class=p>(</span><span class=n>Throwable</span><span class=w> </span><span class=n>t</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>t</span><span class=p>.</span><span class=na>printStackTrace</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onComplete</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;완료!&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 메인 스레드가 종료되지 않도록 대기</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Thread</span><span class=p>.</span><span class=na>sleep</span><span class=p>(</span><span class=n>10000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>RxJava는 다양한 백프레셔 전략을 제공한다:</p><ul><li><strong>onBackpressureBuffer()</strong>: 지정된 크기의 버퍼 사용</li><li><strong>onBackpressureDrop()</strong>: 처리할 수 없는 항목 삭제</li><li><strong>onBackpressureLatest()</strong>: 최신 항목만 유지, 나머지 삭제</li></ul><h4 id=project-reactor>Project Reactor<a hidden class=anchor aria-hidden=true href=#project-reactor>#</a></h4><p>Spring WebFlux 등에서 사용되는 Reactor도 유사한 백프레셔 메커니즘을 제공한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span><span class=lnt id=hl-2-21><a class=lnlinks href=#hl-2-21>21</a>
</span><span class=lnt id=hl-2-22><a class=lnlinks href=#hl-2-22>22</a>
</span><span class=lnt id=hl-2-23><a class=lnlinks href=#hl-2-23>23</a>
</span><span class=lnt id=hl-2-24><a class=lnlinks href=#hl-2-24>24</a>
</span><span class=lnt id=hl-2-25><a class=lnlinks href=#hl-2-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Reactor 백프레셔 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>reactor.core.publisher.Flux</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ReactorBackpressureExample</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>InterruptedException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 백프레셔 지원 스트림 생성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Flux</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=w> </span><span class=n>flux</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Flux</span><span class=p>.</span><span class=na>range</span><span class=p>(</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>100</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>log</span><span class=p>()</span><span class=w> </span><span class=c1>// 이벤트 로깅</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>limitRate</span><span class=p>(</span><span class=n>10</span><span class=p>);</span><span class=w> </span><span class=c1>// 백프레셔 - 한 번에 최대 10개 요청</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 구독 및 소비</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>flux</span><span class=p>.</span><span class=na>subscribe</span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 느린 소비자 시뮬레이션</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Thread</span><span class=p>.</span><span class=na>sleep</span><span class=p>(</span><span class=n>100</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;처리됨: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>value</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>InterruptedException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Thread</span><span class=p>.</span><span class=na>currentThread</span><span class=p>().</span><span class=na>interrupt</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 메인 스레드 대기</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Thread</span><span class=p>.</span><span class=na>sleep</span><span class=p>(</span><span class=n>15000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Reactor의 <code>limitRate()</code>는 소비자가 한 번에 요청할 수 있는 항목 수를 제한하는 간단한 백프레셔 메커니즘을 제공한다.</p><h3 id=메시징-시스템에서의-백프레셔>메시징 시스템에서의 백프레셔<a hidden class=anchor aria-hidden=true href=#메시징-시스템에서의-백프레셔>#</a></h3><p>메시지 큐와 스트리밍 플랫폼은 백프레셔에 매우 의존한다:</p><h4 id=kafka의-백프레셔>Kafka의 백프레셔<a hidden class=anchor aria-hidden=true href=#kafka의-백프레셔>#</a></h4><p>Kafka 소비자는 풀 기반 모델로 백프레셔를 구현한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16>16</a>
</span><span class=lnt id=hl-3-17><a class=lnlinks href=#hl-3-17>17</a>
</span><span class=lnt id=hl-3-18><a class=lnlinks href=#hl-3-18>18</a>
</span><span class=lnt id=hl-3-19><a class=lnlinks href=#hl-3-19>19</a>
</span><span class=lnt id=hl-3-20><a class=lnlinks href=#hl-3-20>20</a>
</span><span class=lnt id=hl-3-21><a class=lnlinks href=#hl-3-21>21</a>
</span><span class=lnt id=hl-3-22><a class=lnlinks href=#hl-3-22>22</a>
</span><span class=lnt id=hl-3-23><a class=lnlinks href=#hl-3-23>23</a>
</span><span class=lnt id=hl-3-24><a class=lnlinks href=#hl-3-24>24</a>
</span><span class=lnt id=hl-3-25><a class=lnlinks href=#hl-3-25>25</a>
</span><span class=lnt id=hl-3-26><a class=lnlinks href=#hl-3-26>26</a>
</span><span class=lnt id=hl-3-27><a class=lnlinks href=#hl-3-27>27</a>
</span><span class=lnt id=hl-3-28><a class=lnlinks href=#hl-3-28>28</a>
</span><span class=lnt id=hl-3-29><a class=lnlinks href=#hl-3-29>29</a>
</span><span class=lnt id=hl-3-30><a class=lnlinks href=#hl-3-30>30</a>
</span><span class=lnt id=hl-3-31><a class=lnlinks href=#hl-3-31>31</a>
</span><span class=lnt id=hl-3-32><a class=lnlinks href=#hl-3-32>32</a>
</span><span class=lnt id=hl-3-33><a class=lnlinks href=#hl-3-33>33</a>
</span><span class=lnt id=hl-3-34><a class=lnlinks href=#hl-3-34>34</a>
</span><span class=lnt id=hl-3-35><a class=lnlinks href=#hl-3-35>35</a>
</span><span class=lnt id=hl-3-36><a class=lnlinks href=#hl-3-36>36</a>
</span><span class=lnt id=hl-3-37><a class=lnlinks href=#hl-3-37>37</a>
</span><span class=lnt id=hl-3-38><a class=lnlinks href=#hl-3-38>38</a>
</span><span class=lnt id=hl-3-39><a class=lnlinks href=#hl-3-39>39</a>
</span><span class=lnt id=hl-3-40><a class=lnlinks href=#hl-3-40>40</a>
</span><span class=lnt id=hl-3-41><a class=lnlinks href=#hl-3-41>41</a>
</span><span class=lnt id=hl-3-42><a class=lnlinks href=#hl-3-42>42</a>
</span><span class=lnt id=hl-3-43><a class=lnlinks href=#hl-3-43>43</a>
</span><span class=lnt id=hl-3-44><a class=lnlinks href=#hl-3-44>44</a>
</span><span class=lnt id=hl-3-45><a class=lnlinks href=#hl-3-45>45</a>
</span><span class=lnt id=hl-3-46><a class=lnlinks href=#hl-3-46>46</a>
</span><span class=lnt id=hl-3-47><a class=lnlinks href=#hl-3-47>47</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Kafka 소비자 백프레셔 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.apache.kafka.clients.consumer.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.time.Duration</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>KafkaConsumerBackpressure</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Properties</span><span class=w> </span><span class=n>props</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Properties</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;bootstrap.servers&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;localhost:9092&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;group.id&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;backpressure-group&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;key.deserializer&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;org.apache.kafka.common.serialization.StringDeserializer&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;value.deserializer&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;org.apache.kafka.common.serialization.StringDeserializer&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 백프레셔와 관련된 중요 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;max.poll.records&#34;</span><span class=p>,</span><span class=w> </span><span class=n>10</span><span class=p>);</span><span class=w> </span><span class=c1>// 한 번에 최대 10개 레코드 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;enable.auto.commit&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;false&#34;</span><span class=p>);</span><span class=w> </span><span class=c1>// 수동 커밋 사용</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>KafkaConsumer</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>consumer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>KafkaConsumer</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>props</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>consumer</span><span class=p>.</span><span class=na>subscribe</span><span class=p>(</span><span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=s>&#34;topic-with-backpressure&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=kc>true</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 소비자가 처리 속도 제어 - 백프레셔의 핵심</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>ConsumerRecords</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>records</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>consumer</span><span class=p>.</span><span class=na>poll</span><span class=p>(</span><span class=n>Duration</span><span class=p>.</span><span class=na>ofMillis</span><span class=p>(</span><span class=n>100</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>ConsumerRecord</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>record</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>records</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=c1>// 메시지 처리 - 실제 구현에서는 시간이 걸리는 작업</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;처리: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>record</span><span class=p>.</span><span class=na>value</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>slowOperation</span><span class=p>();</span><span class=w> </span><span class=c1>// 가정: 시간이 걸리는 작업</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 처리 완료 후 커밋 - 다음 배치를 가져오기 전에</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>consumer</span><span class=p>.</span><span class=na>commitSync</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>consumer</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>slowOperation</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Thread</span><span class=p>.</span><span class=na>sleep</span><span class=p>(</span><span class=n>200</span><span class=p>);</span><span class=w> </span><span class=c1>// 느린 처리 시뮬레이션</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>InterruptedException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Thread</span><span class=p>.</span><span class=na>currentThread</span><span class=p>().</span><span class=na>interrupt</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Kafka 소비자는 <code>max.poll.records</code>와 수동 커밋을 통해 처리 속도를 제어한다. 소비자가 다 처리하기 전까지는 새 메시지를 가져오지 않는다.</p><h4 id=rabbitmq의-백프레셔>RabbitMQ의 백프레셔<a hidden class=anchor aria-hidden=true href=#rabbitmq의-백프레셔>#</a></h4><p>RabbitMQ는 prefetch count를 통해 백프레셔를 구현한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span><span class=lnt id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a>
</span><span class=lnt id=hl-4-19><a class=lnlinks href=#hl-4-19>19</a>
</span><span class=lnt id=hl-4-20><a class=lnlinks href=#hl-4-20>20</a>
</span><span class=lnt id=hl-4-21><a class=lnlinks href=#hl-4-21>21</a>
</span><span class=lnt id=hl-4-22><a class=lnlinks href=#hl-4-22>22</a>
</span><span class=lnt id=hl-4-23><a class=lnlinks href=#hl-4-23>23</a>
</span><span class=lnt id=hl-4-24><a class=lnlinks href=#hl-4-24>24</a>
</span><span class=lnt id=hl-4-25><a class=lnlinks href=#hl-4-25>25</a>
</span><span class=lnt id=hl-4-26><a class=lnlinks href=#hl-4-26>26</a>
</span><span class=lnt id=hl-4-27><a class=lnlinks href=#hl-4-27>27</a>
</span><span class=lnt id=hl-4-28><a class=lnlinks href=#hl-4-28>28</a>
</span><span class=lnt id=hl-4-29><a class=lnlinks href=#hl-4-29>29</a>
</span><span class=lnt id=hl-4-30><a class=lnlinks href=#hl-4-30>30</a>
</span><span class=lnt id=hl-4-31><a class=lnlinks href=#hl-4-31>31</a>
</span><span class=lnt id=hl-4-32><a class=lnlinks href=#hl-4-32>32</a>
</span><span class=lnt id=hl-4-33><a class=lnlinks href=#hl-4-33>33</a>
</span><span class=lnt id=hl-4-34><a class=lnlinks href=#hl-4-34>34</a>
</span><span class=lnt id=hl-4-35><a class=lnlinks href=#hl-4-35>35</a>
</span><span class=lnt id=hl-4-36><a class=lnlinks href=#hl-4-36>36</a>
</span><span class=lnt id=hl-4-37><a class=lnlinks href=#hl-4-37>37</a>
</span><span class=lnt id=hl-4-38><a class=lnlinks href=#hl-4-38>38</a>
</span><span class=lnt id=hl-4-39><a class=lnlinks href=#hl-4-39>39</a>
</span><span class=lnt id=hl-4-40><a class=lnlinks href=#hl-4-40>40</a>
</span><span class=lnt id=hl-4-41><a class=lnlinks href=#hl-4-41>41</a>
</span><span class=lnt id=hl-4-42><a class=lnlinks href=#hl-4-42>42</a>
</span><span class=lnt id=hl-4-43><a class=lnlinks href=#hl-4-43>43</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// RabbitMQ 백프레셔 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>com.rabbitmq.client.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>RabbitMQBackpressure</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>QUEUE_NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;backpressure_queue&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>ConnectionFactory</span><span class=w> </span><span class=n>factory</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ConnectionFactory</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>factory</span><span class=p>.</span><span class=na>setHost</span><span class=p>(</span><span class=s>&#34;localhost&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Connection</span><span class=w> </span><span class=n>connection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>factory</span><span class=p>.</span><span class=na>newConnection</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Channel</span><span class=w> </span><span class=n>channel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connection</span><span class=p>.</span><span class=na>createChannel</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>channel</span><span class=p>.</span><span class=na>queueDeclare</span><span class=p>(</span><span class=n>QUEUE_NAME</span><span class=p>,</span><span class=w> </span><span class=kc>true</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 백프레셔 설정 - 한 번에 처리할 수 있는 메시지 수 제한</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kt>int</span><span class=w> </span><span class=n>prefetchCount</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>10</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>channel</span><span class=p>.</span><span class=na>basicQos</span><span class=p>(</span><span class=n>prefetchCount</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;메시지 수신 대기 중…&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 소비자 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>DeliverCallback</span><span class=w> </span><span class=n>deliverCallback</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>consumerTag</span><span class=p>,</span><span class=w> </span><span class=n>delivery</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>String</span><span class=w> </span><span class=n>message</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>String</span><span class=p>(</span><span class=n>delivery</span><span class=p>.</span><span class=na>getBody</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;UTF-8&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;메시지 수신: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>message</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 시간이 걸리는 작업 시뮬레이션</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Thread</span><span class=p>.</span><span class=na>sleep</span><span class=p>(</span><span class=n>500</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>InterruptedException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>Thread</span><span class=p>.</span><span class=na>currentThread</span><span class=p>().</span><span class=na>interrupt</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;메시지 처리 완료: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>message</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 수동 확인 - 메시지 처리 완료 후에만 승인</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>channel</span><span class=p>.</span><span class=na>basicAck</span><span class=p>(</span><span class=n>delivery</span><span class=p>.</span><span class=na>getEnvelope</span><span class=p>().</span><span class=na>getDeliveryTag</span><span class=p>(),</span><span class=w> </span><span class=kc>false</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// autoAck를 false로 설정하여 수동 확인 모드 사용</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>channel</span><span class=p>.</span><span class=na>basicConsume</span><span class=p>(</span><span class=n>QUEUE_NAME</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=n>deliverCallback</span><span class=p>,</span><span class=w> </span><span class=n>consumerTag</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>RabbitMQ의 <code>basicQos</code> 메서드는 소비자가 동시에 처리할 수 있는 메시지 수를 제한한다. 메시지를 처리한 후에만 <code>basicAck</code>를 호출하여 확인함으로써 백프레셔를 구현한다.</p><h3 id=네트워크-프로토콜에서의-백프레셔>네트워크 프로토콜에서의 백프레셔<a hidden class=anchor aria-hidden=true href=#네트워크-프로토콜에서의-백프레셔>#</a></h3><p>네트워크 수준의 백프레셔는 시스템 안정성에 중요하다:</p><ol><li><p>TCP 흐름 제어<br>TCP는 기본적인 형태의 백프레셔를 제공한다:</p><ul><li>수신 윈도우(receive window)를 통해 수신측의 버퍼 가용성 광고</li><li>슬라이딩 윈도우 메커니즘으로 과부하 방지</li><li>혼잡 제어 알고리즘으로 네트워크 용량에 적응</li></ul></li><li><p>HTTP/2 흐름 제어<br>HTTP/2는 TCP 위에 추가적인 백프레셔 메커니즘을 도입했다:</p><ul><li>스트림별 흐름 제어</li><li>수신측이 WINDOW_UPDATE 프레임으로 처리 가능한 데이터 양 알림</li><li>중앙집중식 우선순위 지정으로 중요 리소스 먼저 처리</li></ul></li><li><p>gRPC 백프레셔<br>gRPC는 HTTP/2 기반으로 백프레셔를 상속하며 추가 기능을 제공한다:</p><ul><li>스트리밍 RPC에서 클라이언트/서버 모두 처리 속도 제어 가능</li><li>양방향 스트리밍에서 양쪽 모두 백프레셔 적용</li><li>서버 스트리밍 RPC에서 클라이언트가 처리 속도 조절</li></ul></li></ol><h3 id=백프레셔-패턴-및-설계-원칙>백프레셔 패턴 및 설계 원칙<a hidden class=anchor aria-hidden=true href=#백프레셔-패턴-및-설계-원칙>#</a></h3><p>효과적인 백프레셔 구현을 위한 일반적인 패턴과 원칙:</p><ol><li><p>버퍼 관리</p><ul><li><strong>유한 버퍼</strong>: 항상 크기 제한 있는 버퍼 사용</li><li><strong>버퍼 크기 설정</strong>: 처리 시간과 지연 사이 적절한 균형 찾기</li><li><strong>모니터링</strong>: 버퍼 사용률 모니터링으로 문제 조기 감지</li></ul></li><li><p>대기열 정책</p><ul><li><strong>FIFO 대기열</strong>: 가장 기본적인 형태</li><li><strong>우선순위 대기열</strong>: 중요한 항목 먼저 처리</li><li><strong>지연 대기열</strong>: 처리 시간이 다른 항목 관리</li></ul></li><li><p>알림 메커니즘</p><ul><li><strong>신호 기반</strong>: 특정 임계값에 도달하면 생산자에게 알림</li><li><strong>토큰 기반</strong>: 소비자가 토큰 발행, 생산자는 토큰당 하나의 항목 전송</li><li><strong>피드백 루프</strong>: 시스템 상태에 따라 생산 속도 동적 조정</li></ul></li></ol><h3 id=backpressure-구현-사례><strong>Backpressure 구현 사례</strong><a hidden class=anchor aria-hidden=true href=#backpressure-구현-사례>#</a></h3><h4 id=1-nodejs-스트림>1. <strong>Node.js 스트림</strong><a hidden class=anchor aria-hidden=true href=#1-nodejs-스트림>#</a></h4><ul><li><p><code>highWaterMark</code> 설정: 기본값 16KB에서 처리량 조절 가능.</p></li><li><p><code>drain</code> 이벤트: 쓰기 버퍼가 비워지면 자동으로 데이터 전송 재개.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2>2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3>3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4>4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5>5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>stream</span> <span class=o>=</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>createWriteStream</span><span class=p>(</span><span class=s1>&#39;file.txt&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>stream</span><span class=p>.</span><span class=nx>write</span><span class=p>(</span><span class=nx>data</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>stream</span><span class=p>.</span><span class=nx>write</span><span class=p>(</span><span class=nx>data</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>stream</span><span class=p>.</span><span class=nx>once</span><span class=p>(</span><span class=s1>&#39;drain&#39;</span><span class=p>,</span> <span class=nx>resumeProcessing</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h4 id=2-apache-storm>2. <strong>Apache Storm</strong><a hidden class=anchor aria-hidden=true href=#2-apache-storm>#</a></h4><ul><li><strong>ZooKeeper 피드백</strong>: Bolt의 큐가 가득 차면 ZooKeeper에 상태 기록, Spout이 전송 중지.</li></ul><h4 id=3-aws-kinesis>3. <strong>AWS Kinesis</strong><a hidden class=anchor aria-hidden=true href=#3-aws-kinesis>#</a></h4><ul><li><strong>PutRecordBatch 제한</strong>: 샤드당 초당 최대 1,000개 레코드 처리로 백프레셔 강제 적용.</li></ul><hr><h3 id=backpressure-vs-throttling><strong>Backpressure Vs. Throttling</strong><a hidden class=anchor aria-hidden=true href=#backpressure-vs-throttling>#</a></h3><table><thead><tr><th>특성</th><th>Backpressure</th><th>Throttling</th></tr></thead><tbody><tr><td><strong>제어 주체</strong></td><td>Consumer-driven</td><td>Producer-driven</td></tr><tr><td><strong>적응성</strong></td><td>실시간 동적 조절</td><td>사전 정의된 정적 제한</td></tr><tr><td><strong>사용 사례</strong></td><td>데이터 파이프라인, 스트리밍</td><td>API 호출 제한, 리소스 보호</td></tr><tr><td><strong>장점</strong></td><td>리소스 사용 최적화</td><td>구현 간단성</td></tr></tbody></table><h3 id=백프레셔-구현-시-도전-과제-및-해결책>백프레셔 구현 시 도전 과제 및 해결책<a hidden class=anchor aria-hidden=true href=#백프레셔-구현-시-도전-과제-및-해결책>#</a></h3><p>백프레셔를 구현할 때 발생하는 일반적인 문제와 해결책:</p><ol><li><p>데드락 방지</p><ul><li><strong>문제</strong>: 생산자와 소비자가 서로 기다리는 데드락 상황</li><li><strong>해결책</strong>: 비차단 대기열, 타임아웃, 서킷 브레이커 패턴</li></ul></li><li><p>리소스 관리</p><ul><li><strong>문제</strong>: 버퍼가 많아질수록 메모리 사용량 증가</li><li><strong>해결책</strong>: 적절한 버퍼 크기 선택, 메모리 사용량 모니터링</li></ul></li><li><p>부하 테스트</p><ul><li><strong>문제</strong>: 백프레셔가 효과적인지 확인하기 어려움</li><li><strong>해결책</strong>: 카오스 엔지니어링 접근 방식, 부하 테스트로 검증</li></ul></li><li><p>모니터링 및 디버깅</p><ul><li><strong>문제</strong>: 백프레셔 메커니즘의 내부 상태 파악 어려움</li><li><strong>해결책</strong>: 상세 로깅, 메트릭 수집, 대시보드 구축</li></ul></li></ol><h3 id=백프레셔와-관련된-패턴-및-기술>백프레셔와 관련된 패턴 및 기술<a hidden class=anchor aria-hidden=true href=#백프레셔와-관련된-패턴-및-기술>#</a></h3><p>백프레셔와 함께 자주 사용되는 패턴과 기술:</p><h4 id=서킷-브레이커-패턴>서킷 브레이커 패턴<a hidden class=anchor aria-hidden=true href=#서킷-브레이커-패턴>#</a></h4><p>서킷 브레이커는 백프레셔와 상호 보완적으로 작동한다:</p><ul><li>백프레셔: 처리 속도를 제어하여 과부하 방지</li><li>서킷 브레이커: 장애 발생 시 호출 차단으로 연쇄 실패 방지</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14>14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15>15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16>16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17>17</a>
</span><span class=lnt id=hl-6-18><a class=lnlinks href=#hl-6-18>18</a>
</span><span class=lnt id=hl-6-19><a class=lnlinks href=#hl-6-19>19</a>
</span><span class=lnt id=hl-6-20><a class=lnlinks href=#hl-6-20>20</a>
</span><span class=lnt id=hl-6-21><a class=lnlinks href=#hl-6-21>21</a>
</span><span class=lnt id=hl-6-22><a class=lnlinks href=#hl-6-22>22</a>
</span><span class=lnt id=hl-6-23><a class=lnlinks href=#hl-6-23>23</a>
</span><span class=lnt id=hl-6-24><a class=lnlinks href=#hl-6-24>24</a>
</span><span class=lnt id=hl-6-25><a class=lnlinks href=#hl-6-25>25</a>
</span><span class=lnt id=hl-6-26><a class=lnlinks href=#hl-6-26>26</a>
</span><span class=lnt id=hl-6-27><a class=lnlinks href=#hl-6-27>27</a>
</span><span class=lnt id=hl-6-28><a class=lnlinks href=#hl-6-28>28</a>
</span><span class=lnt id=hl-6-29><a class=lnlinks href=#hl-6-29>29</a>
</span><span class=lnt id=hl-6-30><a class=lnlinks href=#hl-6-30>30</a>
</span><span class=lnt id=hl-6-31><a class=lnlinks href=#hl-6-31>31</a>
</span><span class=lnt id=hl-6-32><a class=lnlinks href=#hl-6-32>32</a>
</span><span class=lnt id=hl-6-33><a class=lnlinks href=#hl-6-33>33</a>
</span><span class=lnt id=hl-6-34><a class=lnlinks href=#hl-6-34>34</a>
</span><span class=lnt id=hl-6-35><a class=lnlinks href=#hl-6-35>35</a>
</span><span class=lnt id=hl-6-36><a class=lnlinks href=#hl-6-36>36</a>
</span><span class=lnt id=hl-6-37><a class=lnlinks href=#hl-6-37>37</a>
</span><span class=lnt id=hl-6-38><a class=lnlinks href=#hl-6-38>38</a>
</span><span class=lnt id=hl-6-39><a class=lnlinks href=#hl-6-39>39</a>
</span><span class=lnt id=hl-6-40><a class=lnlinks href=#hl-6-40>40</a>
</span><span class=lnt id=hl-6-41><a class=lnlinks href=#hl-6-41>41</a>
</span><span class=lnt id=hl-6-42><a class=lnlinks href=#hl-6-42>42</a>
</span><span class=lnt id=hl-6-43><a class=lnlinks href=#hl-6-43>43</a>
</span><span class=lnt id=hl-6-44><a class=lnlinks href=#hl-6-44>44</a>
</span><span class=lnt id=hl-6-45><a class=lnlinks href=#hl-6-45>45</a>
</span><span class=lnt id=hl-6-46><a class=lnlinks href=#hl-6-46>46</a>
</span><span class=lnt id=hl-6-47><a class=lnlinks href=#hl-6-47>47</a>
</span><span class=lnt id=hl-6-48><a class=lnlinks href=#hl-6-48>48</a>
</span><span class=lnt id=hl-6-49><a class=lnlinks href=#hl-6-49>49</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 서킷 브레이커와 백프레셔 조합 예시 (간소화)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ServiceWithBackpressureAndCircuitBreaker</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>CircuitBreaker</span><span class=w> </span><span class=n>circuitBreaker</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Semaphore</span><span class=w> </span><span class=n>backpressureSemaphore</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>ServiceWithBackpressureAndCircuitBreaker</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>concurrencyLimit</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>circuitBreaker</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>CircuitBreaker</span><span class=p>(</span><span class=cm>/* 설정 */</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>backpressureSemaphore</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Semaphore</span><span class=p>(</span><span class=n>concurrencyLimit</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Response</span><span class=w> </span><span class=nf>processRequest</span><span class=p>(</span><span class=n>Request</span><span class=w> </span><span class=n>request</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 백프레셔: 동시 요청 수 제한</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>backpressureSemaphore</span><span class=p>.</span><span class=na>tryAcquire</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>OverloadException</span><span class=p>(</span><span class=s>&#34;서비스 과부하, 나중에 다시 시도하세요&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 서킷 브레이커: 의존성 호출 보호</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>circuitBreaker</span><span class=p>.</span><span class=na>execute</span><span class=p>(()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c1>// 실제 서비스 호출</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=n>callExternalService</span><span class=p>(</span><span class=n>request</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>backpressureSemaphore</span><span class=p>.</span><span class=na>release</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Response</span><span class=w> </span><span class=nf>callExternalService</span><span class=p>(</span><span class=n>Request</span><span class=w> </span><span class=n>request</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 외부 서비스 호출 구현</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Response</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 내부 클래스들 (실제 구현에서는 별도 파일이어야 함)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=kd>class</span> <span class=nc>Request</span><span class=w> </span><span class=p>{}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=kd>class</span> <span class=nc>Response</span><span class=w> </span><span class=p>{}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=kd>class</span> <span class=nc>OverloadException</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>public</span><span class=w> </span><span class=nf>OverloadException</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>message</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kd>super</span><span class=p>(</span><span class=n>message</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 간소화된 서킷 브레이커 구현</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>static</span><span class=w> </span><span class=kd>class</span> <span class=nc>CircuitBreaker</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 실제 구현은 더 복잡함</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kd>public</span><span class=w> </span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=nf>execute</span><span class=p>(</span><span class=n>Supplier</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=n>supplier</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>supplier</span><span class=p>.</span><span class=na>get</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=벌크헤드-패턴>벌크헤드 패턴<a hidden class=anchor aria-hidden=true href=#벌크헤드-패턴>#</a></h4><p>시스템을 격리된 구획으로 분리하여 장애 전파를 방지한다:</p><ul><li>각 구획에 별도의 백프레셔 메커니즘 적용</li><li>리소스 할당량 설정으로 과부하 방지</li><li>한 구획의 실패가 전체 시스템에 영향 미치지 않음</li></ul><h4 id=스로틀링과-레이트-리미팅>스로틀링과 레이트 리미팅<a hidden class=anchor aria-hidden=true href=#스로틀링과-레이트-리미팅>#</a></h4><p>백프레셔와 함께 사용하여 시스템 부하 관리:</p><ul><li>스로틀링: 전체 처리량 제한</li><li>레이트 리미팅: 클라이언트별 요청 제한</li><li>백프레셔: 시스템 용량에 따른 처리 속도 조절</li></ul><h3 id=백프레셔-패턴의-발전>백프레셔 패턴의 발전<a hidden class=anchor aria-hidden=true href=#백프레셔-패턴의-발전>#</a></h3><p>백프레셔는 소프트웨어 설계와 시스템 아키텍처에서 점점 더 중요한 개념이 되고 있으며, 그 적용 범위가 확장되고 있다:</p><ol><li><p>반응형 시스템의 핵심 원칙<br>반응형 매니페스토(Reactive Manifesto)는 백프레셔를 반응형 시스템의 핵심 원칙으로 강조한다:</p><ul><li><strong>응답성</strong>: 백프레셔는 시스템이 부하 하에서도 응답을 유지하도록 도움</li><li><strong>복원성</strong>: 과부하 방지를 통한 시스템 안정성 향상</li><li><strong>탄력성</strong>: 부하 변화에 적응하는 능력</li><li><strong>메시지 기반</strong>: 비동기 메시지 전달을 통한 결합도 감소</li></ul></li><li><p>클라우드 네이티브 애플리케이션<br>클라우드 환경에서 백프레셔는 더욱 중요해지고 있다:</p><ul><li><strong>자동 확장</strong>: 백프레셔 메트릭을 자동 확장 트리거로 활용</li><li><strong>서비스 메시</strong>: 시스템 전반의 백프레셔 관리</li><li><strong>컨테이너 조정</strong>: 리소스 한계 설정을 통한 컨테이너 수준 백프레셔</li></ul></li><li><p>이벤트 기반 아키텍처<br>이벤트 스트리밍 플랫폼에서 백프레셔는 데이터 흐름 관리에 필수적이다:</p><ul><li><strong>소비자 그룹 오프셋 관리</strong>: 소비자 속도에 맞춘 이벤트 처리</li><li><strong>파티셔닝</strong>: 백프레셔 단위를 개별 파티션으로 세분화</li><li><strong>병렬 처리</strong>: 처리 용량을 최대화하면서 과부하 방지</li></ul></li></ol><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/backend-development/>Backend-Development</a></li><li><a href=https://buenhyden.github.io/tags/migration-strategies/>Migration-Strategies</a></li><li><a href=https://buenhyden.github.io/tags/backpressure/>Backpressure</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/system-architecture--design/distributed-systems/reliability--resilience/fault-tolerance/circuit-breaker/circuit-breaker/><span class=title>« Prev</span><br><span>Circuit Breaker</span>
</a><a class=next href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-formats/jwt/jwt-vs-openid-connect/><span class=title>Next »</span><br><span>JWT vs. OpenID Connect</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>