<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Stream Processing | hyunyoun's Blog</title><meta name=keywords content="Software-Engineering,Design-and-Architecture,Architecture-Styles-and-Patterns,Architecture-Styles,Data-Flow,Processing-Types,Stream-Processing,Real-Time-Data,Event-Driven-Architecture"><meta name=description content="스트림 처리 (Stream Processing) 는 변화하는 데이터를 실시간으로 연속적으로 분석·처리하는 기술로, 이벤트 기반 시스템에서 높은 처리량·낮은 지연을 달성한다. 실시간 모니터링, 이상탐지, 알림, 데이터 파이프라인 방식으로 활용되며, Kafka, Flink, Spark Streaming 등이 주요 구현체이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/data--database-systems/data-architecture/processing-paradigms/stream-processing/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/data--database-systems/data-architecture/processing-paradigms/stream-processing/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/data--database-systems/data-architecture/processing-paradigms/stream-processing/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/data--database-systems/data-architecture/processing-paradigms/stream-processing/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Stream Processing"><meta property="og:description" content="스트림 처리 (Stream Processing) 는 변화하는 데이터를 실시간으로 연속적으로 분석·처리하는 기술로, 이벤트 기반 시스템에서 높은 처리량·낮은 지연을 달성한다. 실시간 모니터링, 이상탐지, 알림, 데이터 파이프라인 방식으로 활용되며, Kafka, Flink, Spark Streaming 등이 주요 구현체이다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Stream Processing"><meta name=twitter:description content="스트림 처리 (Stream Processing) 는 변화하는 데이터를 실시간으로 연속적으로 분석·처리하는 기술로, 이벤트 기반 시스템에서 높은 처리량·낮은 지연을 달성한다. 실시간 모니터링, 이상탐지, 알림, 데이터 파이프라인 방식으로 활용되며, Kafka, Flink, Spark Streaming 등이 주요 구현체이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HY's Blog","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":5,"name":"Stream Processing","item":"https://buenhyden.github.io/posts/data--database-systems/data-architecture/processing-paradigms/stream-processing/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>HY's Blog</a></div><h1>Stream Processing</h1><div class=post-description>스트림 처리 (Stream Processing) 는 변화하는 데이터를 실시간으로 연속적으로 분석·처리하는 기술로, 이벤트 기반 시스템에서 높은 처리량·낮은 지연을 달성한다. 실시간 모니터링, 이상탐지, 알림, 데이터 파이프라인 방식으로 활용되며, Kafka, Flink, Spark Streaming 등이 주요 구현체이다.</div></header><div class=post-content><h2 id=stream-processing>Stream Processing<a hidden class=anchor aria-hidden=true href=#stream-processing>#</a></h2><p>스트림 처리 (Stream Processing) 는 데이터가 시스템에 입력됨과 동시에 실시간으로 연속 처리되어 즉시 응답이나 알림을 생성하는 기술이다. 배치 처리와 달리 지연 시간을 최소화하고, 이벤트 기반 아키텍처 (Event-Driven Architecture) 하에서 높은 처리량과 확장성을 확보할 수 있다. 주요 구성은 데이터 소스, 메시지 브로커, 스트림 엔진, 싱크 (Sink) 로 이루어지며, 실무에서는 실시간 모니터링, 이상 탐지, 실시간 추천 등에 활용된다. Kafka, Flink, Spark Streaming, Amazon Kinesis 같은 플랫폼이 대표적이며, 구현 시 일관성, 오류 처리, 확장성, 상태관리 등을 고려해야 한다.</p><h3 id=배경>배경<a hidden class=anchor aria-hidden=true href=#배경>#</a></h3><p>Stream Processing 의 등장 배경은 다음과 같다:</p><ul><li><strong>1990 년대 초</strong>: 스탠포드 대학의 David Luckham 교수가 CEP (Complex Event Processing) 개념을 도입하여 실시간 이벤트 처리의 이론적 기반을 마련했다.</li><li><strong>2000 년대</strong>: 인터넷과 모바일 기술의 발달로 실시간 데이터 처리 요구가 증가했으며, 센서 융합 (Sensor Fusion) 에서 발전된 개념들이 적용되기 시작했다.</li><li><strong>2010 년대</strong>: 빅데이터와 IoT 의 급속한 성장으로 전통적인 배치 처리 방식의 한계가 드러났다. 2014 년 Jay Kreps 가 Kappa Architecture 를 제안하면서 스트림 중심 처리가 주목받기 시작했다.</li><li><strong>현재</strong>: 클라우드 서비스와 오픈소스 소프트웨어의 발달로 비용 효율적인 스트림 처리 솔루션이 보편화되었다.</li></ul><h3 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h3><p><strong>주요 목적</strong>:</p><ul><li><strong>실시간 의사결정 지원</strong>: 비즈니스 환경에서 즉각적인 대응이 필요한 상황에 대한 신속한 인사이트 제공</li><li><strong>사용자 경험 개선</strong>: 실시간 개인화, 추천 시스템을 통한 향상된 사용자 경험</li><li><strong>운영 효율성 향상</strong>: 시스템 모니터링, 이상 탐지를 통한 사전 예방적 조치</li><li><strong>수익 최적화</strong>: 실시간 가격 조정, 동적 광고 배치를 통한 수익 극대화</li></ul><p><strong>필요성</strong>:</p><ul><li><strong>데이터 볼륨 증가</strong>: 2025 년까지 전 세계 스트림 데이터가 463 제타바이트에 도달할 것으로 예상</li><li><strong>경쟁 우위 확보</strong>: 실시간 분석을 통한 시장 대응력 향상</li><li><strong>규제 요구사항</strong>: 금융, 의료 등 분야에서 실시간 모니터링 의무화</li><li><strong>고객 기대치 상승</strong>: 즉각적인 서비스와 개인화된 경험에 대한 요구 증가</li></ul><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><p><strong>Stream Processing (스트림 처리)</strong> 는 연속적으로 생성되는 데이터 스트림을 실시간으로 수집, 처리, 분석하는 컴퓨팅 패러다임이다. 기존의 배치 처리가 데이터를 일정 시간 수집 후 한꺼번에 처리하는 것과 달리, 스트림 처리는 데이터가 생성되는 즉시 개별적으로 또는 작은 단위로 처리한다.</p><p><strong>핵심 특성</strong>:</p><ul><li><strong>연속성 (Continuous)</strong>: 끝이 없는 무한한 데이터 스트림을 처리</li><li><strong>실시간성 (Real-time)</strong>: 데이터 도착 즉시 처리하여 낮은 지연시간 제공</li><li><strong>이벤트 중심 (Event-driven)</strong>: 개별 이벤트에 반응하여 처리 로직 실행</li><li><strong>확장성 (Scalable)</strong>: 분산 처리를 통한 높은 처리량과 내결함성 제공</li></ul><h4 id=스트림-처리와-배치-처리의-차이>스트림 처리와 배치 처리의 차이<a hidden class=anchor aria-hidden=true href=#스트림-처리와-배치-처리의-차이>#</a></h4><pre class=mermaid>graph TB
    subgraph &#34;배치 처리 (Batch Processing)&#34;
        A[데이터 수집] --&gt; B[대기]
        B --&gt; C[배치 단위로 처리]
        C --&gt; D[결과 저장]
        D --&gt; E[다음 배치 대기]
        E --&gt; B
    end
    
    subgraph &#34;스트림 처리 (Stream Processing)&#34;
        F[데이터 생성] --&gt; G[즉시 수집]
        G --&gt; H[실시간 처리]
        H --&gt; I[즉시 결과 출력]
        I --&gt; J[다음 이벤트 대기]
        J --&gt; F
    end
    
    style A fill:#ffebee
    style C fill:#ffebee
    style F fill:#e8f5e8
    style H fill:#e8f5e8
</pre><h4 id=실무에서-구현하기-위해-필요한-내용들>실무에서 구현하기 위해 필요한 내용들<a hidden class=anchor aria-hidden=true href=#실무에서-구현하기-위해-필요한-내용들>#</a></h4><p><strong>기술적 측면</strong>:</p><ul><li><strong>메시지 브로커</strong>: Apache Kafka, Amazon Kinesis, Apache Pulsar</li><li><strong>스트림 처리 엔진</strong>: Apache Flink, Apache Spark Streaming, Apache Storm</li><li><strong>저장소</strong>: Apache Cassandra, MongoDB, Elasticsearch</li><li><strong>모니터링</strong>: 메트릭 수집, 로깅, 알림 시스템</li></ul><p><strong>설계 측면</strong>:</p><ul><li><strong>이벤트 스키마 설계</strong>: 데이터 구조와 버전 관리</li><li><strong>시간 관리</strong>: Event Time vs Processing Time 처리</li><li><strong>상태 관리</strong>: 분산 환경에서의 상태 유지 및 복구</li><li><strong>배압 처리</strong>: 처리 속도와 데이터 유입 속도 균형</li></ul><h4 id=실무-적용과의-연관성>실무 적용과의 연관성<a hidden class=anchor aria-hidden=true href=#실무-적용과의-연관성>#</a></h4><table><thead><tr><th>실무 영역</th><th>연관성 설명</th></tr></thead><tbody><tr><td><strong>데이터 파이프라인 구성</strong></td><td>실시간 이벤트 전처리, 정제, 필터링 등</td></tr><tr><td><strong>실시간 알림 및 모니터링</strong></td><td>이상 탐지, 시스템 상태 모니터링</td></tr><tr><td><strong>실시간 분석 대시보드</strong></td><td>웹 대시보드에 실시간 데이터 시각화</td></tr><tr><td><strong>실시간 추천 시스템</strong></td><td>사용자 행동을 기반으로 즉각적인 피드백 생성</td></tr><tr><td><strong>IoT 센서 데이터 처리</strong></td><td>수백만 개의 센서에서 실시간 수집되는 데이터 처리</td></tr></tbody></table><h3 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h3><p><strong>데이터 수집 (Data Ingestion)</strong>:</p><ul><li>다양한 소스 (IoT 센서, 웹 애플리케이션, 소셜 미디어) 로부터 실시간 데이터 수집</li><li>프로토콜 지원: HTTP, MQTT, WebSocket, Apache Kafka</li></ul><p><strong>실시간 처리 (Real-time Processing)</strong>:</p><ul><li>필터링, 변환, 집계, 조인 등의 연산을 실시간으로 수행</li><li>상태 기반 처리를 통한 복잡한 이벤트 패턴 감지</li></ul><p><strong>결과 배포 (Result Distribution)</strong>:</p><ul><li>처리된 결과를 다양한 목적지로 실시간 전송</li><li>대시보드, 알림 시스템, 다른 애플리케이션으로 데이터 스트리밍</li></ul><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><table><thead><tr><th>특징</th><th>설명</th></tr></thead><tbody><tr><td><strong>낮은 지연시간</strong></td><td>밀리초 단위의 처리 지연시간으로 즉각적인 응답 제공</td></tr><tr><td><strong>높은 처리량</strong></td><td>초당 수백만 개의 이벤트 처리 가능</td></tr><tr><td><strong>내결함성</strong></td><td>시스템 장애 시에도 데이터 손실 없이 처리 계속</td></tr><tr><td><strong>확장성</strong></td><td>수평적 확장을 통한 처리 용량 증대</td></tr><tr><td><strong>일관성</strong></td><td>Exactly-once, At-least-once 등 다양한 배송 보장</td></tr></tbody></table><h3 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h3><ol><li><p><strong>실시간 처리 (Real-Time Processing)</strong><br>→ 가능한 짧은 시간 내에 데이터에 반응</p></li><li><p><strong>연속 처리 (Continuous Computation)</strong><br>→ 데이터는 무한 스트림 형태로 계속 처리됨</p></li><li><p><strong>이벤트 기반 설계 (Event-Driven Architecture)</strong><br>→ 외부 이벤트가 트리거가 되어 처리 흐름 제어</p></li><li><p><strong>상태 일관성 유지 (Exactly-Once / At-Least-Once)</strong><br>→ 처리 정확도를 위한 메시지 중복 방지</p></li><li><p><strong>장애 허용 및 복구 (Fault Tolerance)</strong><br>→ 스트림 중단 없는 안정적인 서비스 운영</p></li></ol><h3 id=주요-원리>주요 원리<a hidden class=anchor aria-hidden=true href=#주요-원리>#</a></h3><ol><li><p><strong>이벤트 시간 처리 (Event Time Processing)</strong></p><ul><li>데이터가 실제로 발생한 시점을 기준으로 처리</li><li>늦게 도착하는 데이터 (Late Arriving Data) 처리를 위한 워터마크 사용</li></ul></li><li><p><strong>상태 관리 (State Management)</strong></p><ul><li>이벤트 간의 관계를 유지하기 위한 분산 상태 저장소 활용</li><li>체크포인팅을 통한 장애 복구 지원</li></ul></li><li><p><strong>백프레셰어 관리 (Backpressure Handling)</strong></p><ul><li>데이터 유입 속도와 처리 속도의 불균형 해결</li><li>동적 처리량 조절을 통한 시스템 안정성 확보</li></ul></li></ol><h3 id=작동-원리-및-방식>작동 원리 및 방식<a hidden class=anchor aria-hidden=true href=#작동-원리-및-방식>#</a></h3><p>데이터 소스에서 발생한 이벤트가 스트림 프로세서로 전달되고, 다양한 연산 후 싱크로 저장/전송</p><pre class=mermaid>graph LR
    subgraph &#34;데이터 소스&#34;
        A[IoT 센서]
        B[웹 애플리케이션]
        C[모바일 앱]
        D[데이터베이스 변경]
    end
    
    subgraph &#34;데이터 수집 계층&#34;
        E[메시지 브로커&lt;br/&gt;Apache Kafka]
    end
    
    subgraph &#34;스트림 처리 엔진&#34;
        F[데이터 파티셔닝]
        G[이벤트 처리]
        H[상태 관리]
        I[윈도우 연산]
    end
    
    subgraph &#34;결과 저장/배포&#34;
        J[실시간 대시보드]
        K[알림 시스템]
        L[데이터베이스]
        M[다른 애플리케이션]
    end
    
    A --&gt; E
    B --&gt; E
    C --&gt; E
    D --&gt; E
    
    E --&gt; F
    F --&gt; G
    G --&gt; H
    H --&gt; I
    
    I --&gt; J
    I --&gt; K
    I --&gt; L
    I --&gt; M
    
    style E fill:#e1f5fe
    style G fill:#f3e5f5
    style J fill:#e8f5e8
</pre><ol><li><p><strong>데이터 수집 단계</strong></p><ul><li>다양한 데이터 소스에서 실시간으로 이벤트 생성</li><li>메시지 브로커가 이벤트를 수집하고 큐에 저장</li><li>파티셔닝을 통해 병렬 처리 준비</li></ul></li><li><p><strong>처리 단계</strong></p><ul><li>스트림 처리 엔진이 이벤트를 순차적으로 소비</li><li>비즈니스 로직에 따른 필터링, 변환, 집계 수행</li><li>윈도우 연산을 통한 시간 기반 그룹핑</li></ul></li><li><p><strong>결과 배포 단계</strong></p><ul><li>처리된 결과를 목적지 시스템으로 전송</li><li>실시간 대시보드 업데이트, 알림 발송</li><li>영구 저장을 위한 데이터베이스 저장</li></ul></li></ol><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><pre class=mermaid>graph TD
    subgraph &#34;데이터 수집 계층 (Ingestion Layer)&#34;
        A[IoT 센서]
        B[웹 로그]
        C[모바일 이벤트]
        D[Database CDC]
        E[사용자 클릭]
    end
    
    subgraph &#34;메시징 계층 (Messaging Layer)&#34;
        F[Apache Kafka&lt;br/&gt;파티션 1]
        G[Apache Kafka&lt;br/&gt;파티션 2]
        H[Apache Kafka&lt;br/&gt;파티션 N]
    end
    
    subgraph &#34;처리 계층 (Processing Layer)&#34;
        I[Flink TaskManager 1]
        J[Flink TaskManager 2]
        K[Flink TaskManager N]
        
        subgraph &#34;처리 연산&#34;
            L[필터링]
            M[변환]
            N[집계]
            O[조인]
            P[윈도우 연산]
        end
    end
    
    subgraph &#34;상태 관리 (State Management)&#34;
        Q[체크포인트]
        R[상태 저장소]
        S[장애 복구]
    end
    
    subgraph &#34;결과 계층 (Serving Layer)&#34;
        T[실시간 대시보드]
        U[알림 시스템]
        V[데이터 웨어하우스]
        W[실시간 API]
    end
    
    A --&gt; F
    B --&gt; F
    C --&gt; G
    D --&gt; G
    E --&gt; H
    
    F --&gt; I
    G --&gt; J
    H --&gt; K
    
    I --&gt; L
    J --&gt; M
    K --&gt; N
    L --&gt; O
    M --&gt; P
    
    I -.-&gt; Q
    J -.-&gt; R
    K -.-&gt; S
    
    P --&gt; T
    O --&gt; U
    N --&gt; V
    M --&gt; W
    
    style F fill:#e3f2fd
    style I fill:#f3e5f5
    style Q fill:#fff3e0
    style T fill:#e8f5e8
</pre><h4 id=시스템-구성요소>시스템 구성요소<a hidden class=anchor aria-hidden=true href=#시스템-구성요소>#</a></h4><table><thead><tr><th>구분</th><th>구성 요소</th><th>기능</th><th>역할</th><th>주요 특징</th><th>대표 기술</th></tr></thead><tbody><tr><td><strong>필수</strong></td><td><strong>데이터 소스 (Data Sources)</strong></td><td>실시간 이벤트 생성</td><td>스트림 파이프라인의 시작점</td><td>다양한 소스 연동 가능, 실시간 트리거</td><td>IoT 센서, 웹 서버 로그, 금융 거래 시스템 등</td></tr><tr><td></td><td><strong>메시지 브로커 (Message Broker)</strong></td><td>데이터 버퍼링, 파티셔닝, 복제</td><td>생산자 ↔ 소비자 간 비동기 통신 중재</td><td>높은 처리량, 내결함성, 확장성</td><td>Apache Kafka, Amazon Kinesis, Apache Pulsar</td></tr><tr><td></td><td><strong>스트림 처리 엔진 (Stream Processing Engine)</strong></td><td>실시간 데이터 처리, 분석, 집계</td><td>비즈니스 로직 실행 및 이벤트 흐름 처리</td><td>낮은 지연시간, 상태 관리, 내결함성</td><td>Apache Flink, Spark Streaming, Apache Storm</td></tr><tr><td><strong>선택</strong></td><td><strong>상태 저장소 (State Store)</strong></td><td>중간 상태 저장 및 세션/윈도우 관리</td><td>상태 기반 연산, 장애 시 복구 정보 유지</td><td>빠른 조회, 분산 저장, TTL 지원</td><td>Redis, Apache Cassandra, RocksDB, MongoDB</td></tr><tr><td></td><td><strong>모니터링 시스템 (Monitoring System)</strong></td><td>메트릭 수집, 로깅, 알림</td><td>시스템 성능 진단 및 장애 대응</td><td>실시간 시각화, 이상 탐지, Alert 지원</td><td>Prometheus, Grafana, Elastic Stack</td></tr></tbody></table><h3 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>기법</strong></th><th><strong>정의 및 구성 요소</strong></th><th><strong>적용 목적 / 해결 문제</strong></th><th><strong>대표 적용 사례</strong></th></tr></thead><tbody><tr><td><strong>시간 기반 처리</strong></td><td>Windowing</td><td>Tumbling, Sliding, Session 윈도우로 스트림을 시간 단위로 나누어 집계</td><td>실시간 집계 및 시간 기반 분석</td><td>클릭 수 집계, 방문 세션 분석 등</td></tr><tr><td></td><td>Event Time Processing</td><td>이벤트 발생 시점을 기준으로 처리</td><td>순서 정렬, 지연 데이터 처리</td><td>IoT 센서 데이터 기준 정렬</td></tr><tr><td></td><td>Watermarking</td><td>늦게 도착하는 이벤트를 처리하기 위한 시간 기준선 설정</td><td>늦은 이벤트 허용, 정확한 시간 정렬 보장</td><td>Kafka + Flink 융합</td></tr><tr><td><strong>상태 기반 처리</strong></td><td>Stateful Processing</td><td>상태를 저장하며 이전 이벤트와 연관된 처리를 수행</td><td>패턴 인식, 세션 집계, 멱등성 처리 등</td><td>로그인 이후 행동 추적</td></tr><tr><td></td><td>Stateless Processing</td><td>상태 없이 이벤트 단위로 독립 처리</td><td>단순 변환, 필터링 등 경량 처리</td><td>필터, 변환, 정규화 처리 등</td></tr><tr><td><strong>신뢰성 및 보장</strong></td><td>Exactly-once Guarantee</td><td>중복 없이 정확히 1 회만 처리 (체크포인트 기반)</td><td>중복/유실 없는 신뢰성 확보</td><td>금융 거래, 결제 처리 등</td></tr><tr><td></td><td>At-least/At-most-once</td><td>Kafka/Ack 기반 최소 또는 최대 1 회 처리 보장</td><td>중복 허용 or 유실 허용 상황 대응</td><td>로그 수집, 센서 모니터링 등</td></tr><tr><td></td><td>Checkpointing</td><td>처리 상태와 오프셋을 주기적으로 저장</td><td>장애 복구, 재처리 최소화</td><td>Flink 의 상태 스냅샷</td></tr><tr><td><strong>처리 안정성</strong></td><td>Backpressure Handling</td><td>입력 처리량 > 소비 처리량 시 흐름 제어</td><td>메모리 폭주 방지, 시스템 안정화</td><td>Kafka 소비자 속도 조절</td></tr><tr><td><strong>아키텍처 전략</strong></td><td>Lambda Architecture</td><td>배치 + 스트림 분리 아키텍처 (Batch Layer, Speed Layer, Serving Layer)</td><td>정확성과 실시간성 동시 확보</td><td>Netflix 추천 시스템 등</td></tr><tr><td></td><td>Kappa Architecture</td><td>전체를 스트림 기반으로 통합하여 처리</td><td>아키텍처 단순화, 재처리 유연화</td><td>Uber 실시간 가격 계산</td></tr><tr><td></td><td>Event Sourcing</td><td>상태 변경을 불변 이벤트로 저장</td><td>시간여행, 감사 추적, 재처리 유연성</td><td>커맨드 추적, 사용자 변경 이력 관리</td></tr><tr><td></td><td>CQRS</td><td>명령 (Command) 과 조회 (Query) 를 분리한 아키텍처</td><td>읽기/쓰기 성능 분리, 읽기 모델 최적화</td><td>대규모 조회/쓰기 분리 시스템</td></tr></tbody></table><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>1. 실시간성 및 반응성</strong></td><td><strong>실시간 통찰력 제공</strong></td><td>데이터 발생 즉시 처리하여 즉각적인 인사이트 도출 가능</td></tr><tr><td></td><td><strong>낮은 지연 시간</strong></td><td>밀리초 단위의 이벤트 기반 처리로 사용자 경험 향상</td></tr><tr><td></td><td><strong>실시간 대응</strong></td><td>이벤트 발생 시 즉시 반응 가능한 시스템 설계</td></tr><tr><td></td><td><strong>지연 최소화</strong></td><td>배치보다 빠른 처리로 실시간 모니터링, 경고 등 즉각적인 조치 가능</td></tr><tr><td><strong>2. 확장성 및 유연성</strong></td><td><strong>수평 확장성</strong></td><td>Kafka, Flink 등 분산 아키텍처 기반으로 노드 추가를 통한 처리량 확장 용이</td></tr><tr><td></td><td><strong>이벤트 기반 처리 모델</strong></td><td>비동기적 이벤트 흐름을 중심으로 구성되어 느슨한 결합, 유연한 확장성 확보</td></tr><tr><td></td><td><strong>다양한 연산 지원</strong></td><td>필터링, 집계, 윈도우 연산, 변환 등 복잡한 실시간 연산 처리 가능</td></tr><tr><td></td><td><strong>다양한 데이터 소스 처리</strong></td><td>JSON, Avro, 로그, 센서 등 이질적인 소스 간 통합 처리 가능</td></tr><tr><td><strong>3. 신뢰성 및 내결함성</strong></td><td><strong>장애 복구 가능성</strong></td><td>상태 기반 연산, 체크포인트, 재처리 로직을 통해 장애 발생 시 데이터 유실 없이 복원 가능</td></tr><tr><td></td><td><strong>상태 기반 연산 지원</strong></td><td>세션 윈도우, 이벤트 시간 기반 집계 등 상태를 기반으로 한 복잡한 처리 로직 수행 가능</td></tr><tr><td></td><td><strong>Exactly-once 보장 가능</strong></td><td>멱등성, 트랜잭션 로그, 상태 저장소 조합으로 중복 없이 정확한 결과 보장</td></tr><tr><td><strong>4. 비용 최적화</strong></td><td><strong>탄력적 스케일링</strong></td><td>필요 시 리소스를 자동으로 증설/축소하여 자원 낭비를 줄이고 효율적인 운영 가능</td></tr><tr><td></td><td><strong>운영 비용 절감</strong></td><td>배치 기반 인프라 대비 실시간 이벤트 기반 처리로 더 적은 리소스에서 운영 가능</td></tr><tr><td><strong>5. 비즈니스 가치 창출</strong></td><td><strong>빠른 의사결정 지원</strong></td><td>실시간 데이터 분석을 통해 비즈니스 이벤트에 즉시 대응하고 경쟁력 확보 가능</td></tr><tr><td></td><td><strong>고객 경험 개선</strong></td><td>사용자 행동 기반 실시간 추천, 반응성 개선으로 UX 극대화 가능</td></tr><tr><td></td><td><strong>운영 자동화 촉진</strong></td><td>실시간 모니터링 및 자동 경고로 운영 프로세스 자동화 가능</td></tr></tbody></table><h3 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td><strong>복잡성 증가</strong></td><td>분산 환경 및 실시간 처리 특성으로 인해 시스템 구성 및 운영이 복잡함</td><td>스트림 처리 전용 프레임워크 (Flink, Beam) 사용, 설계 표준화, DevOps 기반 자동화</td></tr><tr><td><strong>장애 복구 어려움</strong></td><td>실시간 상태 기반 처리를 위한 복구가 배치보다 복잡하고 민감함</td><td>정기적 체크포인트, 상태 저장소 활용 (RocksDB, Kafka Store 등)</td></tr><tr><td><strong>일관성 보장 어려움</strong></td><td>Exactly-once 처리 보장을 위한 트랜잭션, 멱등성, 중복 제거 등 구현 난이도 높음</td><td>멱등성 처리, 중복 제거 로직 구현, 트랜잭션 로그 기반 처리</td></tr><tr><td><strong>디버깅 및 테스트 어려움</strong></td><td>실시간 흐름 중 오류 재현이 어렵고 테스트 환경 구성이 까다로움</td><td>Mock Stream, 시뮬레이터 기반 테스트 도입, 분산 추적 시스템 사용 (OpenTelemetry 등)</td></tr><tr><td><strong>높은 초기 비용</strong></td><td>인프라, 운영 인력, 기술 적응을 위한 초기 투자 비용 발생</td><td>클라우드 기반 SaaS 사용 (AWS Kinesis, Confluent 등), 단계적 도입</td></tr><tr><td><strong>데이터 순서 보장 어려움</strong></td><td>이벤트의 순서가 네트워크 지연 등으로 변경되어 처리 순서가 어긋날 수 있음</td><td>Event-time 처리, Watermark 설정, Reordering 버퍼 도입</td></tr></tbody></table><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 방법 및 기법</th></tr></thead><tbody><tr><td>문제점</td><td><strong>백프레셔</strong></td><td>데이터 유입 속도 > 처리 속도</td><td>처리 지연, 메모리 부족, OOM 발생</td><td>큐 크기 모니터링, Throughput 추적</td><td>자동 스케일링, 적절한 배치 크기 조정</td><td>동적 배압 제어, 로드 밸런싱</td></tr><tr><td>문제점</td><td><strong>데이터 순서 불일치</strong></td><td>네트워크 지연, 멀티 파티션 처리</td><td>잘못된 집계 및 로직 실행</td><td>타임스탬프 비교, 로그 분석</td><td>단일 파티션 처리, 파티션 키 설계</td><td>순서 재정렬 알고리즘, Reordering Buffer</td></tr><tr><td>문제점</td><td><strong>데이터 유실</strong></td><td>버퍼 오버플로우, 네트워크 장애 등</td><td>중요한 이벤트 손실</td><td>지연 로그, 에러 트래킹</td><td>메시지 브로커 활용 (Kafka 등), 재처리 보장</td><td>재전송 큐, Dead Letter Queue</td></tr><tr><td>문제점</td><td><strong>데이터 중복</strong></td><td>재시도 또는 중복 수신 처리</td><td>결과 왜곡, 중복 집계</td><td>로그 비교, 중복 감지 로직</td><td>Exactly-once 처리 보장</td><td>체크포인트 기반 처리, 멱등성 처리</td></tr><tr><td>문제점</td><td><strong>상태 손실</strong></td><td>장애 발생 중 상태 저장 실패</td><td>세션 윈도우, 집계 불가</td><td>Checkpoint 존재 여부 점검</td><td>외부 상태 저장소 사용, 정기 스냅샷 설정</td><td>상태 복원 전략 수립, RocksDB 튜닝</td></tr><tr><td>문제점</td><td><strong>핫 파티션</strong></td><td>특정 파티션 키에 데이터 집중</td><td>특정 노드 병목, 성능 저하</td><td>파티션별 처리량 모니터링</td><td>균등 분산 키 설계</td><td>파티션 키 리밸런싱, 해시 기반 분산 처리</td></tr><tr><td>문제점</td><td><strong>리소스 과소/과다 할당</strong></td><td>트래픽 예측 실패, 고정 자원 할당</td><td>처리 지연 또는 자원 낭비</td><td>CPU/메모리 추적</td><td>오토스케일링, 예측 기반 자원 계획</td><td>동적 스케일링 설계, 리소스 할당 정책 설정</td></tr><tr><td>문제점</td><td><strong>스키마 불일치/변경</strong></td><td>메시지 포맷 변경, 직렬화 호환성 부족</td><td>역직렬화 오류, 파이프라인 중단</td><td>메시지 실패 로그 확인</td><td>Schema Registry 사용, 버전 관리 설계</td><td>Avro/Protobuf + 호환성 정책 적용</td></tr></tbody></table><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><table><thead><tr><th>카테고리</th><th>도전 과제</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 전략 및 기술</th></tr></thead><tbody><tr><td><strong>1. 성능</strong></td><td><strong>지연 증가 및 처리량 병목</strong></td><td>대량 이벤트 유입, 병렬 처리 부족</td><td>처리 지연, 메시지 유실</td><td>Throughput 모니터링, Lag 측정</td><td>오토스케일링, 파티셔닝</td><td>분산 처리 엔진 구성, Backpressure 제어</td></tr><tr><td></td><td><strong>초저지연 요구 대응</strong></td><td>엔드 투 엔드 처리 경로 지연</td><td>실시간성 저하, SLA 불충족</td><td>지연 시간 추적 (Watermark 등)</td><td>최소 버퍼링, 싱글 hop 처리</td><td>Task 병합, 단일 노드 기반 연산</td></tr><tr><td><strong>2. 정확성</strong></td><td><strong>Exactly-once 성능 저하</strong></td><td>트랜잭션 처리, 상태 관리 비용</td><td>처리량 감소, 시스템 부하 증가</td><td>Output 확인, Checkpoint 확인</td><td>상황별 적절한 처리 보장 수준 선택</td><td>적응형 체크포인팅, 가벼운 상태 처리 전략</td></tr><tr><td></td><td><strong>이벤트 순서 불일치</strong></td><td>네트워크 지연, 브로커 재전송 등</td><td>집계 오류, 중복 처리</td><td>이벤트 시간 로그 분석, 타임스탬프 비교</td><td>Watermark 설정, 지연 허용 처리</td><td>Event-time 기반 처리, Reordering Buffer 적용</td></tr><tr><td><strong>3. 상태 관리</strong></td><td><strong>상태 손실/복구 실패</strong></td><td>장애 발생, 체크포인트 누락</td><td>세션 연산 불가, 재처리 불가능</td><td>Checkpoint 상태 주기 점검</td><td>상태 TTL, 스냅샷 주기 설정</td><td>RocksDB 등 상태 저장소 튜닝, Externalized Checkpoint</td></tr><tr><td></td><td><strong>상태 크기 폭증</strong></td><td>장기 상태 보존, 비정상 TTL 설정</td><td>메모리 부족, GC 과부하</td><td>메모리 프로파일링</td><td>상태 TTL, 중간 상태 정리 정책 도입</td><td>압축 저장, 상태 파티셔닝 적용</td></tr><tr><td><strong>4. 운영 및 확장성</strong></td><td><strong>스케일링 불균형</strong></td><td>파티셔닝 전략 미흡, 노드 간 부하 불균형</td><td>일부 노드 병목, 리소스 낭비</td><td>리소스 사용률 비교, 메트릭 시각화</td><td>Range/Hash 파티셔닝, 워커 수 조정</td><td>파티션 리밸런싱, Adaptive Scaling</td></tr><tr><td></td><td><strong>운영 자동화 부족</strong></td><td>수동 운영, 장애 감지/복구 지연</td><td>MTTR 증가, 운영 비용 상승</td><td>알람 로그 분석, 장애 시뮬레이션</td><td>장애 시나리오 기반 자동 복구</td><td>Auto Healing, Self-Healing Operator 적용</td></tr><tr><td><strong>5. 유지보수/보안</strong></td><td><strong>실시간 테스트 어려움</strong></td><td>실시간 입력 모의 환경 부족</td><td>배포 후 오류 탐지 지연</td><td>Mock Stream 기반 테스트 로그 추적</td><td>테스트 스트림 생성, CI/CD 통합 테스트</td><td>시뮬레이터 도입, Local Flink 환경 기반 유닛 테스트</td></tr><tr><td></td><td><strong>민감 정보 유출 위험</strong></td><td>암호화 미적용, 실시간 데이터 접근 제어 부재</td><td>개인정보 노출, 컴플라이언스 위반</td><td>Audit log 분석, 액세스 기록 추적</td><td>암호화, 데이터 마스킹 적용</td><td>TLS, OAuth, Homomorphic Encryption</td></tr><tr><td><strong>6. 스키마/인프라 관리</strong></td><td><strong>스키마 진화 및 호환성</strong></td><td>데이터 포맷 변경, 비호환 메시지 전파</td><td>파이프라인 중단, 역직렬화 오류</td><td>메시지 형식 로그, Schema Registry 이벤트</td><td>스키마 버전 관리, 백워드 호환성 유지</td><td>Avro, Protobuf + Schema Registry 연동 적용</td></tr><tr><td></td><td><strong>다중 클러스터/리전 관리</strong></td><td>데이터 주권, 지역적 분산 처리 요구</td><td>네트워크 지연, 데이터 정합성 불일치</td><td>각 리전 간 지연 측정, 데이터 일관성 검사</td><td>엣지 컴퓨팅, 글로벌 리플리케이션 전략 적용</td><td>Federated Stream Processing, Geo-replication 적용</td></tr></tbody></table><h3 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th><strong>분류 기준</strong></th><th><strong>유형</strong></th><th><strong>설명</strong></th><th><strong>대표 사용 사례</strong></th></tr></thead><tbody><tr><td><strong>처리 방식</strong></td><td>실시간 처리 (Real-time)</td><td>이벤트 도착 즉시 밀리초 단위로 처리</td><td>사기 탐지, 주식 트레이딩</td></tr><tr><td></td><td>준실시간 처리</td><td>수 초 내 반응성을 유지하면서 실시간에 가깝게 처리</td><td>개인화 추천, 알림 시스템</td></tr><tr><td></td><td>마이크로배치 처리</td><td>일정 시간 단위 (초~분) 로 소규모 배치로 처리</td><td>로그 집계, 리포트 생성</td></tr><tr><td><strong>상태 관리 모델</strong></td><td>Stateless</td><td>상태 저장 없이 개별 이벤트만 처리</td><td>필터링, 단순 변환</td></tr><tr><td></td><td>Stateful</td><td>상태를 저장하여 과거 이벤트와 연관된 복잡한 연산 수행</td><td>윈도우 집계, 세션 분석, 패턴 감지</td></tr><tr><td><strong>시간 처리 기준</strong></td><td>Event Time</td><td>이벤트가 실제 발생한 시점을 기준으로 처리</td><td>정확한 시계열 분석, 순서 보장 필요 시스템</td></tr><tr><td></td><td>Processing Time</td><td>이벤트가 시스템에 도달한 시점을 기준으로 처리</td><td>지연 허용 가능한 일반 이벤트 처리</td></tr><tr><td></td><td>Ingestion Time</td><td>이벤트 수집 시점을 기준으로 처리 (일부 프레임워크에서만 지원)</td><td>빠른 전처리 중심 파이프라인</td></tr><tr><td><strong>윈도우 유형</strong></td><td>Tumbling Window</td><td>고정 길이 시간 구간별로 비중첩 처리</td><td>1 분 단위 트래픽 집계 등</td></tr><tr><td></td><td>Sliding Window</td><td>고정 간격으로 슬라이딩하며 구간 중첩 처리</td><td>5 초 간격으로 1 분 단위 평균값 갱신 등</td></tr><tr><td></td><td>Session Window</td><td>비정형 세션 간격 기반 윈도우 처리</td><td>사용자 세션 분석, 비정기 행동 이벤트 집계</td></tr><tr><td><strong>처리 보장 모델</strong></td><td>At-most-once</td><td>한 번 이하로 처리, 중복은 없지만 유실 가능성 존재</td><td>센서 데이터 수집, 유실 감수 가능한 로그 처리</td></tr><tr><td></td><td>At-least-once</td><td>한 번 이상 처리되며 중복 가능성 있음</td><td>이벤트 로깅, 경고 시스템</td></tr><tr><td></td><td>Exactly-once</td><td>정확히 한 번만 처리, 중복/유실 모두 없음</td><td>금융 거래, 청구/과금 시스템</td></tr><tr><td><strong>인프라 구조</strong></td><td>단일 노드 (Single Node)</td><td>단일 머신에서 처리, 간단한 워크로드에 적합</td><td>테스트 환경, 로컬 처리 파이프라인</td></tr><tr><td></td><td>분산 처리 (Distributed)</td><td>클러스터 기반 다중 노드에서 병렬 처리</td><td>대용량 이벤트 스트림 처리, 고가용성 요구 시스템</td></tr><tr><td><strong>아키텍처 스타일</strong></td><td>Lambda Architecture</td><td>배치 + 스트림을 조합하여 데이터 처리</td><td>빅데이터 분석 + 실시간 탐지 병행 시스템</td></tr><tr><td></td><td>Kappa Architecture</td><td>모든 데이터를 스트림 기반으로 단순화하여 처리</td><td>실시간 중심 파이프라인, 이벤트 로그 재처리 시스템</td></tr><tr><td><strong>기술 프레임워크</strong></td><td>Apache Kafka Streams</td><td>Kafka 기반 스트림 처리 내장 라이브러리</td><td>로그 처리, 트랜잭션 집계</td></tr><tr><td></td><td>Apache Flink</td><td>상태 기반 고성능 스트림 처리 엔진</td><td>Exactly-once, 윈도우 기반 분석</td></tr><tr><td></td><td>Spark Structured Streaming</td><td>마이크로배치 기반 스트림 처리 엔진</td><td>준실시간 로그 분석, ETL 처리</td></tr><tr><td></td><td>Apache Beam</td><td>스트리밍/배치 모두 지원하는 추상화 프레임워크</td><td>Google Dataflow 기반 통합 처리</td></tr></tbody></table><h3 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h3><table><thead><tr><th>산업 분야</th><th>사용 목적 / 사례</th><th>주요 기술 조합</th><th>기대 효과 및 가치 창출</th></tr></thead><tbody><tr><td><strong>금융</strong></td><td>이상 거래 탐지, 실시간 사기 방지</td><td><strong>Kafka + Flink</strong>, Spark Streaming</td><td>사기 탐지율 99% 향상, 보안 강화, 금융 손실 최소화</td></tr><tr><td><strong>전자상거래</strong></td><td>실시간 행동 기반 개인화 추천</td><td><strong>Kafka Streams + Redis</strong>, Flink</td><td>클릭률 25% 증가, 구매 전환율 향상</td></tr><tr><td><strong>IoT/제조</strong></td><td>센서 기반 예측 유지보수, 실시간 장비 상태 분석</td><td><strong>Apache Storm + Cassandra</strong>, AWS Kinesis</td><td>다운타임 30% 감소, 설비 수명 연장, 유지보수 비용 절감</td></tr><tr><td><strong>미디어/콘텐츠</strong></td><td>실시간 콘텐츠 분석 및 분류</td><td><strong>Spark Streaming + Elasticsearch</strong></td><td>콘텐츠 배치 효율성 40% 향상, 사용자 관심사 기반 콘텐츠 추천</td></tr><tr><td><strong>통신</strong></td><td>네트워크 품질 모니터링, 실시간 장애 탐지</td><td><strong>Apache Samza + InfluxDB</strong>, Flink</td><td>장애 대응 시간 50% 단축, QoS 향상</td></tr><tr><td><strong>게임/엔터테인먼트</strong></td><td>실시간 플레이어 이벤트 분석, 행동 기반 피드백</td><td><strong>Kafka + Flink</strong></td><td>사용자 리텐션 증대, 이벤트 기반 보상/분석 기능 강화</td></tr><tr><td><strong>리테일/유통</strong></td><td>재고 실시간 추적 및 자동 발주</td><td><strong>Kafka + ksqlDB</strong>, AWS Lambda</td><td>오버셀링 방지, 자동 발주 시스템 고도화</td></tr><tr><td><strong>클라우드 인프라</strong></td><td>실시간 로그 분석 및 장애 알림</td><td><strong>Kafka + Elastic Stack(Logstash + Kibana)</strong></td><td>알림/대시보드 통한 장애 감지 속도 향상, 운영 자동화</td></tr><tr><td><strong>IoT (스마트시티 등)</strong></td><td>실시간 센서 이벤트 감지 및 환경 제어</td><td><strong>AWS Kinesis + Lambda</strong>, MQTT + Spark</td><td>즉각적 알림 및 정책 반응, 에너지 효율화</td></tr><tr><td><strong>AI/ML 파이프라인</strong></td><td>스트림 기반 모델 학습 및 추론</td><td><strong>Kafka + TensorFlow Serving</strong>, Flink</td><td>실시간 예측, 사용자 반응 기반 자동 피드백</td></tr></tbody></table><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><h4 id=사례-1-전자상거래-플랫폼의-실시간-사기-탐지-시스템>사례 1: 전자상거래 플랫폼의 실시간 사기 탐지 시스템<a hidden class=anchor aria-hidden=true href=#사례-1-전자상거래-플랫폼의-실시간-사기-탐지-시스템>#</a></h4><p>대규모 전자상거래 플랫폼에서 고객의 로그인, 결제, 주소 변경 등 다양한 이벤트를 <strong>Kafka → Flink → Redis → 알림 시스템</strong>의 구조로 실시간 분석하여 <strong>의심스러운 거래를 감지</strong>하고 실시간으로 차단하거나 관리자에게 알림을 전송한다.</p><p><strong>시스템 구성</strong>:</p><pre class=mermaid>graph TD
    A[사용자 행동 이벤트] --&gt; B[Kafka Topic]
    B --&gt; C[Flink Job - 사기 탐지 모델]
    C --&gt; D1[&#34;Redis (임시 상태 저장)&#34;]
    C --&gt; D2[&#34;Alert Manager (Slack, Email)&#34;]
    D2 --&gt; E[보안팀 알림 발송]
</pre><p><strong>Workflow 설명</strong>:</p><ol><li>고객 이벤트 (로그인, 결제 등) 가 Kafka 토픽으로 수집</li><li>Flink 에서 연속적으로 이벤트 스트림을 분석</li><li>ML 기반 사기 감지 모델이 실시간 추론</li><li>이상 탐지 시 Redis 에 사용자 세션 저장</li><li>Alert Manager 를 통해 Slack/이메일로 관리자에게 즉시 통보</li></ol><p><strong>해당 주제 (스트림 처리) 의 역할</strong>:</p><table><thead><tr><th>역할</th><th>설명</th></tr></thead><tbody><tr><td>이벤트 처리</td><td>Kafka 를 통해 수만 건의 실시간 이벤트를 수집</td></tr><tr><td>실시간 분석</td><td>Flink 에서 상태 기반 분석 및 이상 패턴 탐지</td></tr><tr><td>알림 트리거</td><td>탐지 결과에 따라 실시간 알림 발송</td></tr><tr><td>확장성 보장</td><td>병렬로 이벤트 처리 가능하여 수요 급증에 유연 대응</td></tr></tbody></table><h4 id=사례-2-실시간-금융-거래-이상-탐지>사례 2: 실시간 금융 거래 이상 탐지<a hidden class=anchor aria-hidden=true href=#사례-2-실시간-금융-거래-이상-탐지>#</a></h4><p><strong>시스템 구성</strong>: 거래 데이터 소스 → 메시지 브로커 (Kafka) → 스트림 프로세서 (Flink) → 상태 저장소 (Redis) → 알림/대시보드</p><p><strong>Workflow</strong>:</p><ol><li>거래 발생 시 Kafka 로 이벤트 전송</li><li>Flink 에서 실시간 집계 및 이상 패턴 탐지</li><li>이상 거래 감지 시 Redis 에 상태 저장 및 알림 전송</li><li>대시보드에 실시간 표시</li></ol><pre class=mermaid>flowchart LR
    거래[거래 발생] --&gt; Kafka
    Kafka --&gt; Flink
    Flink --&gt; Redis
    Flink --&gt; Alert[알림/대시보드]
</pre><p><strong>Stream Processing 의 역할</strong>: 거래 이벤트를 실시간으로 분석하여 이상 거래를 즉시 탐지 및 대응</p><p><strong>유무 차이점</strong>: 스트림 처리 미적용 시 실시간 탐지 불가, 사후 대응만 가능</p><h4 id=사례-3-evo-banco-의-실시간-사기-탐지-시스템>사례 3: EVO Banco 의 실시간 사기 탐지 시스템<a hidden class=anchor aria-hidden=true href=#사례-3-evo-banco-의-실시간-사기-탐지-시스템>#</a></h4><p><strong>시스템 구성</strong>:</p><ul><li><strong>데이터 소스</strong>: 카드 거래, 로그인 이벤트, 위치 정보</li><li><strong>메시지 브로커</strong>: Apache Kafka (다중 파티션)</li><li><strong>스트림 처리</strong>: Apache Flink (CEP 엔진)</li><li><strong>머신러닝</strong>: 실시간 위험 점수 계산</li><li><strong>알림 시스템</strong>: 실시간 블로킹 및 알림</li></ul><pre class=mermaid>sequenceDiagram
    participant Customer as 고객
    participant ATM as ATM/카드단말기
    participant Kafka as Apache Kafka
    participant Flink as Flink CEP Engine
    participant ML as ML 모델
    participant Risk as 위험 점수 계산
    participant Alert as 알림 시스템
    participant Block as 거래 차단
    
    Customer-&gt;&gt;ATM: 카드 거래 시도
    ATM-&gt;&gt;Kafka: 거래 이벤트 전송
    Kafka-&gt;&gt;Flink: 실시간 이벤트 스트림
    
    Flink-&gt;&gt;Flink: 거래 패턴 분석
    Note over Flink: - 위치 이상 탐지&lt;br/&gt;- 거래 빈도 확인&lt;br/&gt;- 거래 금액 패턴
    
    Flink-&gt;&gt;ML: 특성 데이터 전송
    ML-&gt;&gt;Risk: 위험 점수 계산
    Risk-&gt;&gt;Flink: 위험 점수 반환
    
    alt 위험 점수 &gt; 임계값
        Flink-&gt;&gt;Block: 거래 즉시 차단
        Flink-&gt;&gt;Alert: 고위험 알림 발송
        Block-&gt;&gt;ATM: 거래 거부
        ATM-&gt;&gt;Customer: 거래 실패 안내
    else 정상 거래
        Flink-&gt;&gt;ATM: 거래 승인
        ATM-&gt;&gt;Customer: 거래 완료
    end
</pre><p><strong>Stream Processing 의 역할</strong>:</p><ol><li><strong>실시간 이벤트 수집</strong>: 카드 거래, 로그인, 위치 변경 등 모든 이벤트를 실시간 수집</li><li><strong>패턴 분석</strong>: 복잡한 이벤트 패턴 (CEP) 을 통해 의심스러운 행동 감지</li><li><strong>머신러닝 통합</strong>: 실시간으로 위험 점수를 계산하고 업데이트</li><li><strong>즉시 대응</strong>: 위험 거래를 밀리초 단위로 차단</li></ol><p><strong>도입 전후 차이점</strong>:</p><ul><li><strong>도입 전</strong>: 배치 처리로 하루 뒤 사기 발견, 주간 사기 손실 대규모 발생</li><li><strong>도입 후</strong>: 실시간 탐지로 99% 사기 손실 감소, 고객 신뢰도 향상</li></ul><p>좋아. 이번에는 <strong>Apache Flink 스트림 처리 시스템</strong>에 대해 **Observability 3 대 축 (Metrics, Logs, Traces)**을 <strong>DevOps 관점에서 완전하게 통합</strong>한 심화 아키텍처를 구성하고, 각 구성 요소의 역할, 연동 방식, 구현 예시까지 체계적으로 정리해줄게.</p><h3 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h3><h4 id=observability-통합>Observability 통합<a hidden class=anchor aria-hidden=true href=#observability-통합>#</a></h4><h5 id=아키텍처-구성>아키텍처 구성<a hidden class=anchor aria-hidden=true href=#아키텍처-구성>#</a></h5><pre class=mermaid>flowchart TD
  subgraph Processing
    A1[Flink JobManager] --&gt;|Metrics Exporter| B1[Prometheus]
    A1 --&gt;|Application Logs| C1[Loki]
    A1 --&gt;|Tracing Instrumentation| D1[Jaeger Agent]
    A2[Flink TaskManager] --&gt;|Metrics Exporter| B1
    A2 --&gt;|Logs| C1
    A2 --&gt;|Traces| D1
  end

  subgraph Observability
    B1 --&gt; E1[Grafana - Metrics Panel]
    C1 --&gt; E1
    D1 --&gt; E1
    B1 --&gt; F1[Alertmanager]
  end
</pre><table><thead><tr><th>범주</th><th>구성 요소</th><th>역할 및 기능</th></tr></thead><tbody><tr><td><strong>Metrics</strong></td><td>Flink + Prometheus</td><td>처리량, 지연 시간, 백프레셔 등의 메트릭 수집 및 알림 기반 데이터 제공</td></tr><tr><td><strong>Logs</strong></td><td>Loki + Grafana</td><td>Flink 로그 수집 (stdout/stderr or logback) 및 시각화 (로그 레벨 필터링, 검색 등)</td></tr><tr><td><strong>Traces</strong></td><td>Jaeger</td><td>Flink 연산자 및 커스텀 코드의 분산 트레이싱 추적 (예: Kafka I/O → Flink 처리 시간 분석)</td></tr><tr><td><strong>Alerting</strong></td><td>Alertmanager</td><td>지연/오류율 상승 시 Slack/Email/PagerDuty 등으로 자동 알림</td></tr></tbody></table><h5 id=구현-상세>구현 상세<a hidden class=anchor aria-hidden=true href=#구현-상세>#</a></h5><h6 id=metrics-prometheus--flink>Metrics: Prometheus + Flink<a hidden class=anchor aria-hidden=true href=#metrics-prometheus--flink>#</a></h6><p><strong>Flink 설정</strong> (<code>flink-conf.yaml</code>):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>metrics.reporter.prom.class</span><span class=p>:</span><span class=w> </span><span class=l>org.apache.flink.metrics.prometheus.PrometheusReporter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>metrics.reporter.prom.port</span><span class=p>:</span><span class=w> </span><span class=m>9249</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>Prometheus 설정</strong> (<code>prometheus.yml</code>):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;flink&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;jobmanager:9249&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;taskmanager:9249&#39;</span><span class=p>]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>Grafana Dashboard</strong>: Flink Metrics → 처리량, 백프레셔, task 별 처리 지연시간 등 시각화</p><h6 id=logs-loki--promtail--grafana>Logs: Loki + Promtail + Grafana<a hidden class=anchor aria-hidden=true href=#logs-loki--promtail--grafana>#</a></h6><p><strong>Loki 구성 (<code>docker-compose.yml</code> 예시)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>loki</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>grafana/loki:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=s2>&#34;3100:3100&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>promtail</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>grafana/promtail:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>/var/log:/var/log</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>./promtail-config.yaml:/etc/promtail/promtail.yaml</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>Promtail 설정 (<code>promtail-config.yaml</code> 예시)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span><span class=lnt id=hl-10-16><a class=lnlinks href=#hl-10-16>16</a>
</span><span class=lnt id=hl-10-17><a class=lnlinks href=#hl-10-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>server</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>http_listen_port</span><span class=p>:</span><span class=w> </span><span class=m>9080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>positions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>filename</span><span class=p>:</span><span class=w> </span><span class=l>/tmp/positions.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>clients</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>http://loki:3100/loki/api/v1/push</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=l>flink_logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>localhost</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>job</span><span class=p>:</span><span class=w> </span><span class=l>flink</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>__path__</span><span class=p>:</span><span class=w> </span><span class=l>/flink/log/*.log</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>Grafana 에서 Logs 탭에 Loki 연결 → 실시간 로그 확인 가능</strong></p><h6 id=traces-jaeger-연동>Traces: Jaeger 연동<a hidden class=anchor aria-hidden=true href=#traces-jaeger-연동>#</a></h6><p><strong>방법 1: Flink + OpenTelemetry SDK 사용</strong></p><p>Flink 애플리케이션 코드에서 Jaeger 트레이스를 수동 삽입:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry</span> <span class=kn>import</span> <span class=n>trace</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.exporter.jaeger.thrift</span> <span class=kn>import</span> <span class=n>JaegerExporter</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.sdk.trace</span> <span class=kn>import</span> <span class=n>TracerProvider</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.sdk.trace.export</span> <span class=kn>import</span> <span class=n>BatchSpanProcessor</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Jaeger 설정</span>
</span></span><span class=line><span class=cl><span class=n>trace</span><span class=o>.</span><span class=n>set_tracer_provider</span><span class=p>(</span><span class=n>TracerProvider</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>jaeger_exporter</span> <span class=o>=</span> <span class=n>JaegerExporter</span><span class=p>(</span><span class=n>agent_host_name</span><span class=o>=</span><span class=s2>&#34;jaeger&#34;</span><span class=p>,</span> <span class=n>agent_port</span><span class=o>=</span><span class=mi>6831</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>trace</span><span class=o>.</span><span class=n>get_tracer_provider</span><span class=p>()</span><span class=o>.</span><span class=n>add_span_processor</span><span class=p>(</span><span class=n>BatchSpanProcessor</span><span class=p>(</span><span class=n>jaeger_exporter</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tracer</span> <span class=o>=</span> <span class=n>trace</span><span class=o>.</span><span class=n>get_tracer</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>tracer</span><span class=o>.</span><span class=n>start_as_current_span</span><span class=p>(</span><span class=s2>&#34;process_event&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Flink 내부 연산 로직 처리</span>
</span></span><span class=line><span class=cl>    <span class=n>process_event</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Jaeger 구성 (<code>docker-compose.yml</code>)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1>1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2>2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3>3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4>4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>jaegertracing/all-in-one:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=s2>&#34;16686:16686&#34;</span><span class=w>  </span><span class=c># UI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=s2>&#34;6831:6831/udp&#34;</span><span class=w> </span><span class=c># Agent Port</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>Grafana → Jaeger 연동 (Data Source 추가) → 분산 추적 시각화</strong></p><h6 id=alerting-alertmanager>Alerting: Alertmanager<a hidden class=anchor aria-hidden=true href=#alerting-alertmanager>#</a></h6><p><strong>Prometheus 설정 (<code>prometheus.yml</code>):</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1>1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2>2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3>3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4>4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5>5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6>6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7>7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>alerting</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>alertmanagers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=s1>&#39;alertmanager:9093&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>rule_files</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=s1>&#39;alert_rules.yml&#39;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>Alert Rule 예시 (<code>alert_rules.yml</code>)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1> 1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2> 2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3> 3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4> 4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5> 5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6> 6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7> 7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8> 8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9> 9</a>
</span><span class=lnt id=hl-14-10><a class=lnlinks href=#hl-14-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>groups</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>flink_alerts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>alert</span><span class=p>:</span><span class=w> </span><span class=l>HighLatency</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>expr</span><span class=p>:</span><span class=w> </span><span class=l>histogram_quantile(0.95, rate(taskmanager_job_task_operator_latency_ms_bucket[5m])) &gt; 500</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>for</span><span class=p>:</span><span class=w> </span><span class=l>1m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class=l>warning</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;High latency detected in Flink pipeline&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>Alertmanager 구성</strong> (<code>docker-compose.yml</code>):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1>1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2>2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3>3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4>4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5>5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>alertmanager</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>prom/alertmanager</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=s2>&#34;9093:9093&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>./alertmanager.yml:/etc/alertmanager/alertmanager.yml</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>알림 채널 예: Slack, Email, PagerDuty 등</strong></p><h5 id=grafana-구성-예시>Grafana 구성 예시<a hidden class=anchor aria-hidden=true href=#grafana-구성-예시>#</a></h5><ul><li><p><strong>대시보드 탭</strong>:</p><ul><li>처리량, 지연 시간, 백프레셔 상태 (Prometheus)</li><li>최근 에러 로그 (Loki)</li><li>Flink Task 트레이싱 히스토리 (Jaeger)</li></ul></li><li><p><strong>알림 탭</strong>:</p><ul><li>지연 시간 초과 / 에러율 증가 등 알림 조건 목록</li></ul></li><li><p><strong>Explore 탭</strong>:</p><ul><li>로그 쿼리 (<code>{job="flink", level="ERROR"}</code> 등)</li></ul></li></ul><h4 id=kubernetes-기반-observability-통합>Kubernetes 기반 Observability 통합<a hidden class=anchor aria-hidden=true href=#kubernetes-기반-observability-통합>#</a></h4><h5 id=아키텍처-구성-1>아키텍처 구성<a hidden class=anchor aria-hidden=true href=#아키텍처-구성-1>#</a></h5><pre class=mermaid>flowchart LR
    subgraph K8s Cluster
        A[&#34;Flink Cluster (JobManager, TaskManager)&#34;] --&gt;|Metrics Exporter| B[Prometheus Operator]
        A --&gt;|Logs via sidecar| C[Grafana Agent or Fluent Bit]
        A --&gt;|Tracing SDK| D[OpenTelemetry Collector]
    end

    B --&gt; E[Grafana]
    C --&gt; E
    D --&gt; E
    B --&gt; F[Alertmanager]
    D --&gt; G[Jaeger Backend]
</pre><table><thead><tr><th>구성 요소</th><th>역할</th><th>구현 방식</th></tr></thead><tbody><tr><td><strong>Prometheus Operator</strong></td><td>Flink 메트릭 자동 수집</td><td><code>ServiceMonitor</code> CRD 사용</td></tr><tr><td><strong>Fluent Bit / Grafana Agent</strong></td><td>로그 수집</td><td>sidecar 또는 DaemonSet</td></tr><tr><td><strong>OpenTelemetry Collector</strong></td><td>Trace 수집 및 전달</td><td>sidecar 또는 DaemonSet</td></tr><tr><td><strong>Jaeger</strong></td><td>Trace 저장 및 시각화</td><td>All-in-one 배포 또는 Remote Storage</td></tr><tr><td><strong>Grafana</strong></td><td>통합 대시보드</td><td>Logs + Metrics + Traces</td></tr></tbody></table><h5 id=flink-배포-deployment--service>Flink 배포 (Deployment + Service)<a hidden class=anchor aria-hidden=true href=#flink-배포-deployment--service>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1> 1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2> 2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3> 3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4> 4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5> 5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6> 6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7> 7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8> 8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9> 9</a>
</span><span class=lnt id=hl-17-10><a class=lnlinks href=#hl-17-10>10</a>
</span><span class=lnt id=hl-17-11><a class=lnlinks href=#hl-17-11>11</a>
</span><span class=lnt id=hl-17-12><a class=lnlinks href=#hl-17-12>12</a>
</span><span class=lnt id=hl-17-13><a class=lnlinks href=#hl-17-13>13</a>
</span><span class=lnt id=hl-17-14><a class=lnlinks href=#hl-17-14>14</a>
</span><span class=lnt id=hl-17-15><a class=lnlinks href=#hl-17-15>15</a>
</span><span class=lnt id=hl-17-16><a class=lnlinks href=#hl-17-16>16</a>
</span><span class=lnt id=hl-17-17><a class=lnlinks href=#hl-17-17>17</a>
</span><span class=lnt id=hl-17-18><a class=lnlinks href=#hl-17-18>18</a>
</span><span class=lnt id=hl-17-19><a class=lnlinks href=#hl-17-19>19</a>
</span><span class=lnt id=hl-17-20><a class=lnlinks href=#hl-17-20>20</a>
</span><span class=lnt id=hl-17-21><a class=lnlinks href=#hl-17-21>21</a>
</span><span class=lnt id=hl-17-22><a class=lnlinks href=#hl-17-22>22</a>
</span><span class=lnt id=hl-17-23><a class=lnlinks href=#hl-17-23>23</a>
</span><span class=lnt id=hl-17-24><a class=lnlinks href=#hl-17-24>24</a>
</span><span class=lnt id=hl-17-25><a class=lnlinks href=#hl-17-25>25</a>
</span><span class=lnt id=hl-17-26><a class=lnlinks href=#hl-17-26>26</a>
</span><span class=lnt id=hl-17-27><a class=lnlinks href=#hl-17-27>27</a>
</span><span class=lnt id=hl-17-28><a class=lnlinks href=#hl-17-28>28</a>
</span><span class=lnt id=hl-17-29><a class=lnlinks href=#hl-17-29>29</a>
</span><span class=lnt id=hl-17-30><a class=lnlinks href=#hl-17-30>30</a>
</span><span class=lnt id=hl-17-31><a class=lnlinks href=#hl-17-31>31</a>
</span><span class=lnt id=hl-17-32><a class=lnlinks href=#hl-17-32>32</a>
</span><span class=lnt id=hl-17-33><a class=lnlinks href=#hl-17-33>33</a>
</span><span class=lnt id=hl-17-34><a class=lnlinks href=#hl-17-34>34</a>
</span><span class=lnt id=hl-17-35><a class=lnlinks href=#hl-17-35>35</a>
</span><span class=lnt id=hl-17-36><a class=lnlinks href=#hl-17-36>36</a>
</span><span class=lnt id=hl-17-37><a class=lnlinks href=#hl-17-37>37</a>
</span><span class=lnt id=hl-17-38><a class=lnlinks href=#hl-17-38>38</a>
</span><span class=lnt id=hl-17-39><a class=lnlinks href=#hl-17-39>39</a>
</span><span class=lnt id=hl-17-40><a class=lnlinks href=#hl-17-40>40</a>
</span><span class=lnt id=hl-17-41><a class=lnlinks href=#hl-17-41>41</a>
</span><span class=lnt id=hl-17-42><a class=lnlinks href=#hl-17-42>42</a>
</span><span class=lnt id=hl-17-43><a class=lnlinks href=#hl-17-43>43</a>
</span><span class=lnt id=hl-17-44><a class=lnlinks href=#hl-17-44>44</a>
</span><span class=lnt id=hl-17-45><a class=lnlinks href=#hl-17-45>45</a>
</span><span class=lnt id=hl-17-46><a class=lnlinks href=#hl-17-46>46</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>flink-jobmanager</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>flink-jobmanager</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>flink-jobmanager</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>prometheus.io/scrape</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>prometheus.io/port</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;9249&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>jobmanager</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>flink:1.17</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>8081</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>9249</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>JOB_MANAGER_RPC_ADDRESS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>flink-jobmanager</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>config-volume</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/opt/flink/conf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>config-volume</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>configMap</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>flink-config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>flink-jobmanager</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>flink-jobmanager</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>web</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>8081</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>9249</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=prometheus-operator-와-servicemonitor>Prometheus Operator 와 ServiceMonitor<a hidden class=anchor aria-hidden=true href=#prometheus-operator-와-servicemonitor>#</a></h5><p><strong><code>ServiceMonitor</code> 로 Flink 메트릭 수집</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1> 1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2> 2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3> 3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4> 4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5> 5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6> 6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7> 7</a>
</span><span class=lnt id=hl-18-8><a class=lnlinks href=#hl-18-8> 8</a>
</span><span class=lnt id=hl-18-9><a class=lnlinks href=#hl-18-9> 9</a>
</span><span class=lnt id=hl-18-10><a class=lnlinks href=#hl-18-10>10</a>
</span><span class=lnt id=hl-18-11><a class=lnlinks href=#hl-18-11>11</a>
</span><span class=lnt id=hl-18-12><a class=lnlinks href=#hl-18-12>12</a>
</span><span class=lnt id=hl-18-13><a class=lnlinks href=#hl-18-13>13</a>
</span><span class=lnt id=hl-18-14><a class=lnlinks href=#hl-18-14>14</a>
</span><span class=lnt id=hl-18-15><a class=lnlinks href=#hl-18-15>15</a>
</span><span class=lnt id=hl-18-16><a class=lnlinks href=#hl-18-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>monitoring.coreos.com/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ServiceMonitor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>flink-servicemonitor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>release</span><span class=p>:</span><span class=w> </span><span class=l>prometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>flink-jobmanager</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>endpoints</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=l>metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=l>15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespaceSelector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchNames</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>default</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>❗ <code>Prometheus Operator</code> 가 설치되어 있어야 하며, <code>release: prometheus</code> 라벨은 <code>Prometheus</code> CRD 와 일치해야 한다.</p></blockquote><p><strong>Prometheus + Grafana Operator 설치</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install kube-prometheus-stack prometheus-community/kube-prometheus-stack
</span></span></code></pre></td></tr></table></div></div><h5 id=opentelemetry-정식-연동>OpenTelemetry 정식 연동<a hidden class=anchor aria-hidden=true href=#opentelemetry-정식-연동>#</a></h5><h6 id=flink-애플리케이션에-opentelemetry-sdk-연동>Flink 애플리케이션에 OpenTelemetry SDK 연동<a hidden class=anchor aria-hidden=true href=#flink-애플리케이션에-opentelemetry-sdk-연동>#</a></h6><p><strong>Python 예시 (PyFlink 기준)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1> 1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2> 2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3> 3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4> 4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5> 5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6> 6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7> 7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8> 8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9> 9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10>10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11>11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12>12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13>13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14>14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15>15</a>
</span><span class=lnt id=hl-20-16><a class=lnlinks href=#hl-20-16>16</a>
</span><span class=lnt id=hl-20-17><a class=lnlinks href=#hl-20-17>17</a>
</span><span class=lnt id=hl-20-18><a class=lnlinks href=#hl-20-18>18</a>
</span><span class=lnt id=hl-20-19><a class=lnlinks href=#hl-20-19>19</a>
</span><span class=lnt id=hl-20-20><a class=lnlinks href=#hl-20-20>20</a>
</span><span class=lnt id=hl-20-21><a class=lnlinks href=#hl-20-21>21</a>
</span><span class=lnt id=hl-20-22><a class=lnlinks href=#hl-20-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry</span> <span class=kn>import</span> <span class=n>trace</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.sdk.resources</span> <span class=kn>import</span> <span class=n>Resource</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.sdk.trace</span> <span class=kn>import</span> <span class=n>TracerProvider</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.sdk.trace.export</span> <span class=kn>import</span> <span class=n>BatchSpanProcessor</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry.exporter.otlp.proto.grpc.trace_exporter</span> <span class=kn>import</span> <span class=n>OTLPSpanExporter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>resource</span> <span class=o>=</span> <span class=n>Resource</span><span class=p>(</span><span class=n>attributes</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;service.name&#34;</span><span class=p>:</span> <span class=s2>&#34;flink-stream-job&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;service.namespace&#34;</span><span class=p>:</span> <span class=s2>&#34;streaming&#34;</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>provider</span> <span class=o>=</span> <span class=n>TracerProvider</span><span class=p>(</span><span class=n>resource</span><span class=o>=</span><span class=n>resource</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>trace</span><span class=o>.</span><span class=n>set_tracer_provider</span><span class=p>(</span><span class=n>provider</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>otlp_exporter</span> <span class=o>=</span> <span class=n>OTLPSpanExporter</span><span class=p>(</span><span class=n>endpoint</span><span class=o>=</span><span class=s2>&#34;otel-collector:4317&#34;</span><span class=p>,</span> <span class=n>insecure</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>provider</span><span class=o>.</span><span class=n>add_span_processor</span><span class=p>(</span><span class=n>BatchSpanProcessor</span><span class=p>(</span><span class=n>otlp_exporter</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tracer</span> <span class=o>=</span> <span class=n>trace</span><span class=o>.</span><span class=n>get_tracer</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=n>tracer</span><span class=o>.</span><span class=n>start_as_current_span</span><span class=p>(</span><span class=s2>&#34;window_processing&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># Flink 연산자 또는 사용자 정의 함수 처리</span>
</span></span><span class=line><span class=cl>    <span class=n>process_event</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=otel-collector-구성-예시>OTEL Collector 구성 예시<a hidden class=anchor aria-hidden=true href=#otel-collector-구성-예시>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span><span class=lnt id=hl-21-11><a class=lnlinks href=#hl-21-11>11</a>
</span><span class=lnt id=hl-21-12><a class=lnlinks href=#hl-21-12>12</a>
</span><span class=lnt id=hl-21-13><a class=lnlinks href=#hl-21-13>13</a>
</span><span class=lnt id=hl-21-14><a class=lnlinks href=#hl-21-14>14</a>
</span><span class=lnt id=hl-21-15><a class=lnlinks href=#hl-21-15>15</a>
</span><span class=lnt id=hl-21-16><a class=lnlinks href=#hl-21-16>16</a>
</span><span class=lnt id=hl-21-17><a class=lnlinks href=#hl-21-17>17</a>
</span><span class=lnt id=hl-21-18><a class=lnlinks href=#hl-21-18>18</a>
</span><span class=lnt id=hl-21-19><a class=lnlinks href=#hl-21-19>19</a>
</span><span class=lnt id=hl-21-20><a class=lnlinks href=#hl-21-20>20</a>
</span><span class=lnt id=hl-21-21><a class=lnlinks href=#hl-21-21>21</a>
</span><span class=lnt id=hl-21-22><a class=lnlinks href=#hl-21-22>22</a>
</span><span class=lnt id=hl-21-23><a class=lnlinks href=#hl-21-23>23</a>
</span><span class=lnt id=hl-21-24><a class=lnlinks href=#hl-21-24>24</a>
</span><span class=lnt id=hl-21-25><a class=lnlinks href=#hl-21-25>25</a>
</span><span class=lnt id=hl-21-26><a class=lnlinks href=#hl-21-26>26</a>
</span><span class=lnt id=hl-21-27><a class=lnlinks href=#hl-21-27>27</a>
</span><span class=lnt id=hl-21-28><a class=lnlinks href=#hl-21-28>28</a>
</span><span class=lnt id=hl-21-29><a class=lnlinks href=#hl-21-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c>######  OpenTelemetry Collector 구성 (OTEL → Jaeger)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=cp>**Collector</span><span class=w> </span><span class=l>ConfigMap**</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>```yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ConfigMap</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>otel-collector-config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>data</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>collector-config.yaml</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>    receivers:
</span></span></span><span class=line><span class=cl><span class=sd>      otlp:
</span></span></span><span class=line><span class=cl><span class=sd>        protocols:
</span></span></span><span class=line><span class=cl><span class=sd>          grpc:
</span></span></span><span class=line><span class=cl><span class=sd>          http:
</span></span></span><span class=line><span class=cl><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>    exporters:
</span></span></span><span class=line><span class=cl><span class=sd>      jaeger:
</span></span></span><span class=line><span class=cl><span class=sd>        endpoint: jaeger-collector.default.svc.cluster.local:14250
</span></span></span><span class=line><span class=cl><span class=sd>        tls:
</span></span></span><span class=line><span class=cl><span class=sd>          insecure: true
</span></span></span><span class=line><span class=cl><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>    service:
</span></span></span><span class=line><span class=cl><span class=sd>      pipelines:
</span></span></span><span class=line><span class=cl><span class=sd>        traces:
</span></span></span><span class=line><span class=cl><span class=sd>          receivers: [otlp]
</span></span></span><span class=line><span class=cl><span class=sd>          exporters: [jaeger]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>Collector Deployment</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1> 1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2> 2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3> 3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4> 4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5> 5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6> 6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7> 7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8> 8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9> 9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10>10</a>
</span><span class=lnt id=hl-22-11><a class=lnlinks href=#hl-22-11>11</a>
</span><span class=lnt id=hl-22-12><a class=lnlinks href=#hl-22-12>12</a>
</span><span class=lnt id=hl-22-13><a class=lnlinks href=#hl-22-13>13</a>
</span><span class=lnt id=hl-22-14><a class=lnlinks href=#hl-22-14>14</a>
</span><span class=lnt id=hl-22-15><a class=lnlinks href=#hl-22-15>15</a>
</span><span class=lnt id=hl-22-16><a class=lnlinks href=#hl-22-16>16</a>
</span><span class=lnt id=hl-22-17><a class=lnlinks href=#hl-22-17>17</a>
</span><span class=lnt id=hl-22-18><a class=lnlinks href=#hl-22-18>18</a>
</span><span class=lnt id=hl-22-19><a class=lnlinks href=#hl-22-19>19</a>
</span><span class=lnt id=hl-22-20><a class=lnlinks href=#hl-22-20>20</a>
</span><span class=lnt id=hl-22-21><a class=lnlinks href=#hl-22-21>21</a>
</span><span class=lnt id=hl-22-22><a class=lnlinks href=#hl-22-22>22</a>
</span><span class=lnt id=hl-22-23><a class=lnlinks href=#hl-22-23>23</a>
</span><span class=lnt id=hl-22-24><a class=lnlinks href=#hl-22-24>24</a>
</span><span class=lnt id=hl-22-25><a class=lnlinks href=#hl-22-25>25</a>
</span><span class=lnt id=hl-22-26><a class=lnlinks href=#hl-22-26>26</a>
</span><span class=lnt id=hl-22-27><a class=lnlinks href=#hl-22-27>27</a>
</span><span class=lnt id=hl-22-28><a class=lnlinks href=#hl-22-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>otel-collector</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>otel-collector</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>otel-collector</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>otel-collector</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>otel/opentelemetry-collector:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>args</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;--config=/conf/collector-config.yaml&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>4317</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>55681</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/conf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>configMap</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>otel-collector-config</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>OpenTelemetry Collector 설치</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1>1</a>
</span><span class=lnt id=hl-23-2><a class=lnlinks href=#hl-23-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add open-telemetry https://open-telemetry.github.io/opentelemetry-helm-charts
</span></span><span class=line><span class=cl>helm install otel open-telemetry/opentelemetry-collector
</span></span></code></pre></td></tr></table></div></div><h5 id=loki--promtail-로그-수집-설정>Loki + Promtail 로그 수집 설정<a hidden class=anchor aria-hidden=true href=#loki--promtail-로그-수집-설정>#</a></h5><p><strong>Promtail DaemonSet 설정</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1> 1</a>
</span><span class=lnt id=hl-24-2><a class=lnlinks href=#hl-24-2> 2</a>
</span><span class=lnt id=hl-24-3><a class=lnlinks href=#hl-24-3> 3</a>
</span><span class=lnt id=hl-24-4><a class=lnlinks href=#hl-24-4> 4</a>
</span><span class=lnt id=hl-24-5><a class=lnlinks href=#hl-24-5> 5</a>
</span><span class=lnt id=hl-24-6><a class=lnlinks href=#hl-24-6> 6</a>
</span><span class=lnt id=hl-24-7><a class=lnlinks href=#hl-24-7> 7</a>
</span><span class=lnt id=hl-24-8><a class=lnlinks href=#hl-24-8> 8</a>
</span><span class=lnt id=hl-24-9><a class=lnlinks href=#hl-24-9> 9</a>
</span><span class=lnt id=hl-24-10><a class=lnlinks href=#hl-24-10>10</a>
</span><span class=lnt id=hl-24-11><a class=lnlinks href=#hl-24-11>11</a>
</span><span class=lnt id=hl-24-12><a class=lnlinks href=#hl-24-12>12</a>
</span><span class=lnt id=hl-24-13><a class=lnlinks href=#hl-24-13>13</a>
</span><span class=lnt id=hl-24-14><a class=lnlinks href=#hl-24-14>14</a>
</span><span class=lnt id=hl-24-15><a class=lnlinks href=#hl-24-15>15</a>
</span><span class=lnt id=hl-24-16><a class=lnlinks href=#hl-24-16>16</a>
</span><span class=lnt id=hl-24-17><a class=lnlinks href=#hl-24-17>17</a>
</span><span class=lnt id=hl-24-18><a class=lnlinks href=#hl-24-18>18</a>
</span><span class=lnt id=hl-24-19><a class=lnlinks href=#hl-24-19>19</a>
</span><span class=lnt id=hl-24-20><a class=lnlinks href=#hl-24-20>20</a>
</span><span class=lnt id=hl-24-21><a class=lnlinks href=#hl-24-21>21</a>
</span><span class=lnt id=hl-24-22><a class=lnlinks href=#hl-24-22>22</a>
</span><span class=lnt id=hl-24-23><a class=lnlinks href=#hl-24-23>23</a>
</span><span class=lnt id=hl-24-24><a class=lnlinks href=#hl-24-24>24</a>
</span><span class=lnt id=hl-24-25><a class=lnlinks href=#hl-24-25>25</a>
</span><span class=lnt id=hl-24-26><a class=lnlinks href=#hl-24-26>26</a>
</span><span class=lnt id=hl-24-27><a class=lnlinks href=#hl-24-27>27</a>
</span><span class=lnt id=hl-24-28><a class=lnlinks href=#hl-24-28>28</a>
</span><span class=lnt id=hl-24-29><a class=lnlinks href=#hl-24-29>29</a>
</span><span class=lnt id=hl-24-30><a class=lnlinks href=#hl-24-30>30</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>DaemonSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>promtail</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>promtail</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>promtail</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>promtail</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>grafana/promtail:2.9.2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>args</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- -<span class=l>config.file=/etc/promtail/promtail.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/var/log</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/etc/promtail</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>hostPath</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/var/log</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>configMap</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>promtail-config</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>Promtail ConfigMap</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1> 1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2> 2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3> 3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4> 4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5> 5</a>
</span><span class=lnt id=hl-25-6><a class=lnlinks href=#hl-25-6> 6</a>
</span><span class=lnt id=hl-25-7><a class=lnlinks href=#hl-25-7> 7</a>
</span><span class=lnt id=hl-25-8><a class=lnlinks href=#hl-25-8> 8</a>
</span><span class=lnt id=hl-25-9><a class=lnlinks href=#hl-25-9> 9</a>
</span><span class=lnt id=hl-25-10><a class=lnlinks href=#hl-25-10>10</a>
</span><span class=lnt id=hl-25-11><a class=lnlinks href=#hl-25-11>11</a>
</span><span class=lnt id=hl-25-12><a class=lnlinks href=#hl-25-12>12</a>
</span><span class=lnt id=hl-25-13><a class=lnlinks href=#hl-25-13>13</a>
</span><span class=lnt id=hl-25-14><a class=lnlinks href=#hl-25-14>14</a>
</span><span class=lnt id=hl-25-15><a class=lnlinks href=#hl-25-15>15</a>
</span><span class=lnt id=hl-25-16><a class=lnlinks href=#hl-25-16>16</a>
</span><span class=lnt id=hl-25-17><a class=lnlinks href=#hl-25-17>17</a>
</span><span class=lnt id=hl-25-18><a class=lnlinks href=#hl-25-18>18</a>
</span><span class=lnt id=hl-25-19><a class=lnlinks href=#hl-25-19>19</a>
</span><span class=lnt id=hl-25-20><a class=lnlinks href=#hl-25-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ConfigMap</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>promtail-config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>data</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>promtail.yaml</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>    server:
</span></span></span><span class=line><span class=cl><span class=sd>      http_listen_port: 9080
</span></span></span><span class=line><span class=cl><span class=sd>    positions:
</span></span></span><span class=line><span class=cl><span class=sd>      filename: /tmp/positions.yaml
</span></span></span><span class=line><span class=cl><span class=sd>    clients:
</span></span></span><span class=line><span class=cl><span class=sd>      - url: http://loki:3100/loki/api/v1/push
</span></span></span><span class=line><span class=cl><span class=sd>    scrape_configs:
</span></span></span><span class=line><span class=cl><span class=sd>      - job_name: flink_logs
</span></span></span><span class=line><span class=cl><span class=sd>        static_configs:
</span></span></span><span class=line><span class=cl><span class=sd>          - targets:
</span></span></span><span class=line><span class=cl><span class=sd>              - localhost
</span></span></span><span class=line><span class=cl><span class=sd>            labels:
</span></span></span><span class=line><span class=cl><span class=sd>              job: flink
</span></span></span><span class=line><span class=cl><span class=sd>              __path__: /flink/log/*.log</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>Loki + Grafana Agent</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-26-1><a class=lnlinks href=#hl-26-1>1</a>
</span><span class=lnt id=hl-26-2><a class=lnlinks href=#hl-26-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add grafana https://grafana.github.io/helm-charts
</span></span><span class=line><span class=cl>helm install loki grafana/loki-stack
</span></span></code></pre></td></tr></table></div></div><h5 id=grafana-에서-통합-대시보드-구성>Grafana 에서 통합 대시보드 구성<a hidden class=anchor aria-hidden=true href=#grafana-에서-통합-대시보드-구성>#</a></h5><ul><li><p><strong>Data Sources 등록</strong></p><ul><li>Prometheus: <code>http://prometheus-k8s.monitoring.svc.cluster.local:9090</code></li><li>Loki: <code>http://loki.monitoring.svc.cluster.local:3100</code></li><li>Jaeger: <code>http://jaeger-query.default.svc.cluster.local:16686</code></li></ul></li><li><p><strong>Dashboard</strong></p><ul><li><code>Flink Streaming Metrics Dashboard</code></li><li><code>Logs by job name</code></li><li><code>Trace Spans Timeline Panel</code></li></ul></li></ul><h5 id=alertmanager-연동-기본-구성>Alertmanager 연동 (기본 구성)<a hidden class=anchor aria-hidden=true href=#alertmanager-연동-기본-구성>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-27-1><a class=lnlinks href=#hl-27-1> 1</a>
</span><span class=lnt id=hl-27-2><a class=lnlinks href=#hl-27-2> 2</a>
</span><span class=lnt id=hl-27-3><a class=lnlinks href=#hl-27-3> 3</a>
</span><span class=lnt id=hl-27-4><a class=lnlinks href=#hl-27-4> 4</a>
</span><span class=lnt id=hl-27-5><a class=lnlinks href=#hl-27-5> 5</a>
</span><span class=lnt id=hl-27-6><a class=lnlinks href=#hl-27-6> 6</a>
</span><span class=lnt id=hl-27-7><a class=lnlinks href=#hl-27-7> 7</a>
</span><span class=lnt id=hl-27-8><a class=lnlinks href=#hl-27-8> 8</a>
</span><span class=lnt id=hl-27-9><a class=lnlinks href=#hl-27-9> 9</a>
</span><span class=lnt id=hl-27-10><a class=lnlinks href=#hl-27-10>10</a>
</span><span class=lnt id=hl-27-11><a class=lnlinks href=#hl-27-11>11</a>
</span><span class=lnt id=hl-27-12><a class=lnlinks href=#hl-27-12>12</a>
</span><span class=lnt id=hl-27-13><a class=lnlinks href=#hl-27-13>13</a>
</span><span class=lnt id=hl-27-14><a class=lnlinks href=#hl-27-14>14</a>
</span><span class=lnt id=hl-27-15><a class=lnlinks href=#hl-27-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ConfigMap</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>alertmanager-config</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>data</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>alertmanager.yml</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>    global:
</span></span></span><span class=line><span class=cl><span class=sd>      resolve_timeout: 5m
</span></span></span><span class=line><span class=cl><span class=sd>    route:
</span></span></span><span class=line><span class=cl><span class=sd>      receiver: slack-notifications
</span></span></span><span class=line><span class=cl><span class=sd>    receivers:
</span></span></span><span class=line><span class=cl><span class=sd>      - name: slack-notifications
</span></span></span><span class=line><span class=cl><span class=sd>        slack_configs:
</span></span></span><span class=line><span class=cl><span class=sd>          - api_url: https://hooks.slack.com/services/XXXXXX
</span></span></span><span class=line><span class=cl><span class=sd>            channel: &#34;#flink-alerts&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=정리>정리<a hidden class=anchor aria-hidden=true href=#정리>#</a></h5><table><thead><tr><th>구성 요소</th><th>구현 예시 형태</th><th>비고</th></tr></thead><tbody><tr><td>Flink Metrics</td><td><code>Deployment</code>, <code>Service</code>, <code>ServiceMonitor</code></td><td>Prometheus scrape</td></tr><tr><td>Logs</td><td><code>Promtail</code> + <code>Loki</code> ConfigMap 및 DaemonSet</td><td>로그 연동</td></tr><tr><td>Traces</td><td><code>OTEL Collector</code> + 애플리케이션 SDK</td><td>OTLP + Jaeger</td></tr><tr><td>Grafana</td><td>Dashboards 수동 생성 혹은 JSON import</td><td>종합 시각화</td></tr><tr><td>Alerts</td><td>Alertmanager + Slack</td><td>경고 자동화</td></tr></tbody></table><h4 id=python-실시간-사기-탐지-스트림-처리기>Python: 실시간 사기 탐지 스트림 처리기<a hidden class=anchor aria-hidden=true href=#python-실시간-사기-탐지-스트림-처리기>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-28-1><a class=lnlinks href=#hl-28-1>  1</a>
</span><span class=lnt id=hl-28-2><a class=lnlinks href=#hl-28-2>  2</a>
</span><span class=lnt id=hl-28-3><a class=lnlinks href=#hl-28-3>  3</a>
</span><span class=lnt id=hl-28-4><a class=lnlinks href=#hl-28-4>  4</a>
</span><span class=lnt id=hl-28-5><a class=lnlinks href=#hl-28-5>  5</a>
</span><span class=lnt id=hl-28-6><a class=lnlinks href=#hl-28-6>  6</a>
</span><span class=lnt id=hl-28-7><a class=lnlinks href=#hl-28-7>  7</a>
</span><span class=lnt id=hl-28-8><a class=lnlinks href=#hl-28-8>  8</a>
</span><span class=lnt id=hl-28-9><a class=lnlinks href=#hl-28-9>  9</a>
</span><span class=lnt id=hl-28-10><a class=lnlinks href=#hl-28-10> 10</a>
</span><span class=lnt id=hl-28-11><a class=lnlinks href=#hl-28-11> 11</a>
</span><span class=lnt id=hl-28-12><a class=lnlinks href=#hl-28-12> 12</a>
</span><span class=lnt id=hl-28-13><a class=lnlinks href=#hl-28-13> 13</a>
</span><span class=lnt id=hl-28-14><a class=lnlinks href=#hl-28-14> 14</a>
</span><span class=lnt id=hl-28-15><a class=lnlinks href=#hl-28-15> 15</a>
</span><span class=lnt id=hl-28-16><a class=lnlinks href=#hl-28-16> 16</a>
</span><span class=lnt id=hl-28-17><a class=lnlinks href=#hl-28-17> 17</a>
</span><span class=lnt id=hl-28-18><a class=lnlinks href=#hl-28-18> 18</a>
</span><span class=lnt id=hl-28-19><a class=lnlinks href=#hl-28-19> 19</a>
</span><span class=lnt id=hl-28-20><a class=lnlinks href=#hl-28-20> 20</a>
</span><span class=lnt id=hl-28-21><a class=lnlinks href=#hl-28-21> 21</a>
</span><span class=lnt id=hl-28-22><a class=lnlinks href=#hl-28-22> 22</a>
</span><span class=lnt id=hl-28-23><a class=lnlinks href=#hl-28-23> 23</a>
</span><span class=lnt id=hl-28-24><a class=lnlinks href=#hl-28-24> 24</a>
</span><span class=lnt id=hl-28-25><a class=lnlinks href=#hl-28-25> 25</a>
</span><span class=lnt id=hl-28-26><a class=lnlinks href=#hl-28-26> 26</a>
</span><span class=lnt id=hl-28-27><a class=lnlinks href=#hl-28-27> 27</a>
</span><span class=lnt id=hl-28-28><a class=lnlinks href=#hl-28-28> 28</a>
</span><span class=lnt id=hl-28-29><a class=lnlinks href=#hl-28-29> 29</a>
</span><span class=lnt id=hl-28-30><a class=lnlinks href=#hl-28-30> 30</a>
</span><span class=lnt id=hl-28-31><a class=lnlinks href=#hl-28-31> 31</a>
</span><span class=lnt id=hl-28-32><a class=lnlinks href=#hl-28-32> 32</a>
</span><span class=lnt id=hl-28-33><a class=lnlinks href=#hl-28-33> 33</a>
</span><span class=lnt id=hl-28-34><a class=lnlinks href=#hl-28-34> 34</a>
</span><span class=lnt id=hl-28-35><a class=lnlinks href=#hl-28-35> 35</a>
</span><span class=lnt id=hl-28-36><a class=lnlinks href=#hl-28-36> 36</a>
</span><span class=lnt id=hl-28-37><a class=lnlinks href=#hl-28-37> 37</a>
</span><span class=lnt id=hl-28-38><a class=lnlinks href=#hl-28-38> 38</a>
</span><span class=lnt id=hl-28-39><a class=lnlinks href=#hl-28-39> 39</a>
</span><span class=lnt id=hl-28-40><a class=lnlinks href=#hl-28-40> 40</a>
</span><span class=lnt id=hl-28-41><a class=lnlinks href=#hl-28-41> 41</a>
</span><span class=lnt id=hl-28-42><a class=lnlinks href=#hl-28-42> 42</a>
</span><span class=lnt id=hl-28-43><a class=lnlinks href=#hl-28-43> 43</a>
</span><span class=lnt id=hl-28-44><a class=lnlinks href=#hl-28-44> 44</a>
</span><span class=lnt id=hl-28-45><a class=lnlinks href=#hl-28-45> 45</a>
</span><span class=lnt id=hl-28-46><a class=lnlinks href=#hl-28-46> 46</a>
</span><span class=lnt id=hl-28-47><a class=lnlinks href=#hl-28-47> 47</a>
</span><span class=lnt id=hl-28-48><a class=lnlinks href=#hl-28-48> 48</a>
</span><span class=lnt id=hl-28-49><a class=lnlinks href=#hl-28-49> 49</a>
</span><span class=lnt id=hl-28-50><a class=lnlinks href=#hl-28-50> 50</a>
</span><span class=lnt id=hl-28-51><a class=lnlinks href=#hl-28-51> 51</a>
</span><span class=lnt id=hl-28-52><a class=lnlinks href=#hl-28-52> 52</a>
</span><span class=lnt id=hl-28-53><a class=lnlinks href=#hl-28-53> 53</a>
</span><span class=lnt id=hl-28-54><a class=lnlinks href=#hl-28-54> 54</a>
</span><span class=lnt id=hl-28-55><a class=lnlinks href=#hl-28-55> 55</a>
</span><span class=lnt id=hl-28-56><a class=lnlinks href=#hl-28-56> 56</a>
</span><span class=lnt id=hl-28-57><a class=lnlinks href=#hl-28-57> 57</a>
</span><span class=lnt id=hl-28-58><a class=lnlinks href=#hl-28-58> 58</a>
</span><span class=lnt id=hl-28-59><a class=lnlinks href=#hl-28-59> 59</a>
</span><span class=lnt id=hl-28-60><a class=lnlinks href=#hl-28-60> 60</a>
</span><span class=lnt id=hl-28-61><a class=lnlinks href=#hl-28-61> 61</a>
</span><span class=lnt id=hl-28-62><a class=lnlinks href=#hl-28-62> 62</a>
</span><span class=lnt id=hl-28-63><a class=lnlinks href=#hl-28-63> 63</a>
</span><span class=lnt id=hl-28-64><a class=lnlinks href=#hl-28-64> 64</a>
</span><span class=lnt id=hl-28-65><a class=lnlinks href=#hl-28-65> 65</a>
</span><span class=lnt id=hl-28-66><a class=lnlinks href=#hl-28-66> 66</a>
</span><span class=lnt id=hl-28-67><a class=lnlinks href=#hl-28-67> 67</a>
</span><span class=lnt id=hl-28-68><a class=lnlinks href=#hl-28-68> 68</a>
</span><span class=lnt id=hl-28-69><a class=lnlinks href=#hl-28-69> 69</a>
</span><span class=lnt id=hl-28-70><a class=lnlinks href=#hl-28-70> 70</a>
</span><span class=lnt id=hl-28-71><a class=lnlinks href=#hl-28-71> 71</a>
</span><span class=lnt id=hl-28-72><a class=lnlinks href=#hl-28-72> 72</a>
</span><span class=lnt id=hl-28-73><a class=lnlinks href=#hl-28-73> 73</a>
</span><span class=lnt id=hl-28-74><a class=lnlinks href=#hl-28-74> 74</a>
</span><span class=lnt id=hl-28-75><a class=lnlinks href=#hl-28-75> 75</a>
</span><span class=lnt id=hl-28-76><a class=lnlinks href=#hl-28-76> 76</a>
</span><span class=lnt id=hl-28-77><a class=lnlinks href=#hl-28-77> 77</a>
</span><span class=lnt id=hl-28-78><a class=lnlinks href=#hl-28-78> 78</a>
</span><span class=lnt id=hl-28-79><a class=lnlinks href=#hl-28-79> 79</a>
</span><span class=lnt id=hl-28-80><a class=lnlinks href=#hl-28-80> 80</a>
</span><span class=lnt id=hl-28-81><a class=lnlinks href=#hl-28-81> 81</a>
</span><span class=lnt id=hl-28-82><a class=lnlinks href=#hl-28-82> 82</a>
</span><span class=lnt id=hl-28-83><a class=lnlinks href=#hl-28-83> 83</a>
</span><span class=lnt id=hl-28-84><a class=lnlinks href=#hl-28-84> 84</a>
</span><span class=lnt id=hl-28-85><a class=lnlinks href=#hl-28-85> 85</a>
</span><span class=lnt id=hl-28-86><a class=lnlinks href=#hl-28-86> 86</a>
</span><span class=lnt id=hl-28-87><a class=lnlinks href=#hl-28-87> 87</a>
</span><span class=lnt id=hl-28-88><a class=lnlinks href=#hl-28-88> 88</a>
</span><span class=lnt id=hl-28-89><a class=lnlinks href=#hl-28-89> 89</a>
</span><span class=lnt id=hl-28-90><a class=lnlinks href=#hl-28-90> 90</a>
</span><span class=lnt id=hl-28-91><a class=lnlinks href=#hl-28-91> 91</a>
</span><span class=lnt id=hl-28-92><a class=lnlinks href=#hl-28-92> 92</a>
</span><span class=lnt id=hl-28-93><a class=lnlinks href=#hl-28-93> 93</a>
</span><span class=lnt id=hl-28-94><a class=lnlinks href=#hl-28-94> 94</a>
</span><span class=lnt id=hl-28-95><a class=lnlinks href=#hl-28-95> 95</a>
</span><span class=lnt id=hl-28-96><a class=lnlinks href=#hl-28-96> 96</a>
</span><span class=lnt id=hl-28-97><a class=lnlinks href=#hl-28-97> 97</a>
</span><span class=lnt id=hl-28-98><a class=lnlinks href=#hl-28-98> 98</a>
</span><span class=lnt id=hl-28-99><a class=lnlinks href=#hl-28-99> 99</a>
</span><span class=lnt id=hl-28-100><a class=lnlinks href=#hl-28-100>100</a>
</span><span class=lnt id=hl-28-101><a class=lnlinks href=#hl-28-101>101</a>
</span><span class=lnt id=hl-28-102><a class=lnlinks href=#hl-28-102>102</a>
</span><span class=lnt id=hl-28-103><a class=lnlinks href=#hl-28-103>103</a>
</span><span class=lnt id=hl-28-104><a class=lnlinks href=#hl-28-104>104</a>
</span><span class=lnt id=hl-28-105><a class=lnlinks href=#hl-28-105>105</a>
</span><span class=lnt id=hl-28-106><a class=lnlinks href=#hl-28-106>106</a>
</span><span class=lnt id=hl-28-107><a class=lnlinks href=#hl-28-107>107</a>
</span><span class=lnt id=hl-28-108><a class=lnlinks href=#hl-28-108>108</a>
</span><span class=lnt id=hl-28-109><a class=lnlinks href=#hl-28-109>109</a>
</span><span class=lnt id=hl-28-110><a class=lnlinks href=#hl-28-110>110</a>
</span><span class=lnt id=hl-28-111><a class=lnlinks href=#hl-28-111>111</a>
</span><span class=lnt id=hl-28-112><a class=lnlinks href=#hl-28-112>112</a>
</span><span class=lnt id=hl-28-113><a class=lnlinks href=#hl-28-113>113</a>
</span><span class=lnt id=hl-28-114><a class=lnlinks href=#hl-28-114>114</a>
</span><span class=lnt id=hl-28-115><a class=lnlinks href=#hl-28-115>115</a>
</span><span class=lnt id=hl-28-116><a class=lnlinks href=#hl-28-116>116</a>
</span><span class=lnt id=hl-28-117><a class=lnlinks href=#hl-28-117>117</a>
</span><span class=lnt id=hl-28-118><a class=lnlinks href=#hl-28-118>118</a>
</span><span class=lnt id=hl-28-119><a class=lnlinks href=#hl-28-119>119</a>
</span><span class=lnt id=hl-28-120><a class=lnlinks href=#hl-28-120>120</a>
</span><span class=lnt id=hl-28-121><a class=lnlinks href=#hl-28-121>121</a>
</span><span class=lnt id=hl-28-122><a class=lnlinks href=#hl-28-122>122</a>
</span><span class=lnt id=hl-28-123><a class=lnlinks href=#hl-28-123>123</a>
</span><span class=lnt id=hl-28-124><a class=lnlinks href=#hl-28-124>124</a>
</span><span class=lnt id=hl-28-125><a class=lnlinks href=#hl-28-125>125</a>
</span><span class=lnt id=hl-28-126><a class=lnlinks href=#hl-28-126>126</a>
</span><span class=lnt id=hl-28-127><a class=lnlinks href=#hl-28-127>127</a>
</span><span class=lnt id=hl-28-128><a class=lnlinks href=#hl-28-128>128</a>
</span><span class=lnt id=hl-28-129><a class=lnlinks href=#hl-28-129>129</a>
</span><span class=lnt id=hl-28-130><a class=lnlinks href=#hl-28-130>130</a>
</span><span class=lnt id=hl-28-131><a class=lnlinks href=#hl-28-131>131</a>
</span><span class=lnt id=hl-28-132><a class=lnlinks href=#hl-28-132>132</a>
</span><span class=lnt id=hl-28-133><a class=lnlinks href=#hl-28-133>133</a>
</span><span class=lnt id=hl-28-134><a class=lnlinks href=#hl-28-134>134</a>
</span><span class=lnt id=hl-28-135><a class=lnlinks href=#hl-28-135>135</a>
</span><span class=lnt id=hl-28-136><a class=lnlinks href=#hl-28-136>136</a>
</span><span class=lnt id=hl-28-137><a class=lnlinks href=#hl-28-137>137</a>
</span><span class=lnt id=hl-28-138><a class=lnlinks href=#hl-28-138>138</a>
</span><span class=lnt id=hl-28-139><a class=lnlinks href=#hl-28-139>139</a>
</span><span class=lnt id=hl-28-140><a class=lnlinks href=#hl-28-140>140</a>
</span><span class=lnt id=hl-28-141><a class=lnlinks href=#hl-28-141>141</a>
</span><span class=lnt id=hl-28-142><a class=lnlinks href=#hl-28-142>142</a>
</span><span class=lnt id=hl-28-143><a class=lnlinks href=#hl-28-143>143</a>
</span><span class=lnt id=hl-28-144><a class=lnlinks href=#hl-28-144>144</a>
</span><span class=lnt id=hl-28-145><a class=lnlinks href=#hl-28-145>145</a>
</span><span class=lnt id=hl-28-146><a class=lnlinks href=#hl-28-146>146</a>
</span><span class=lnt id=hl-28-147><a class=lnlinks href=#hl-28-147>147</a>
</span><span class=lnt id=hl-28-148><a class=lnlinks href=#hl-28-148>148</a>
</span><span class=lnt id=hl-28-149><a class=lnlinks href=#hl-28-149>149</a>
</span><span class=lnt id=hl-28-150><a class=lnlinks href=#hl-28-150>150</a>
</span><span class=lnt id=hl-28-151><a class=lnlinks href=#hl-28-151>151</a>
</span><span class=lnt id=hl-28-152><a class=lnlinks href=#hl-28-152>152</a>
</span><span class=lnt id=hl-28-153><a class=lnlinks href=#hl-28-153>153</a>
</span><span class=lnt id=hl-28-154><a class=lnlinks href=#hl-28-154>154</a>
</span><span class=lnt id=hl-28-155><a class=lnlinks href=#hl-28-155>155</a>
</span><span class=lnt id=hl-28-156><a class=lnlinks href=#hl-28-156>156</a>
</span><span class=lnt id=hl-28-157><a class=lnlinks href=#hl-28-157>157</a>
</span><span class=lnt id=hl-28-158><a class=lnlinks href=#hl-28-158>158</a>
</span><span class=lnt id=hl-28-159><a class=lnlinks href=#hl-28-159>159</a>
</span><span class=lnt id=hl-28-160><a class=lnlinks href=#hl-28-160>160</a>
</span><span class=lnt id=hl-28-161><a class=lnlinks href=#hl-28-161>161</a>
</span><span class=lnt id=hl-28-162><a class=lnlinks href=#hl-28-162>162</a>
</span><span class=lnt id=hl-28-163><a class=lnlinks href=#hl-28-163>163</a>
</span><span class=lnt id=hl-28-164><a class=lnlinks href=#hl-28-164>164</a>
</span><span class=lnt id=hl-28-165><a class=lnlinks href=#hl-28-165>165</a>
</span><span class=lnt id=hl-28-166><a class=lnlinks href=#hl-28-166>166</a>
</span><span class=lnt id=hl-28-167><a class=lnlinks href=#hl-28-167>167</a>
</span><span class=lnt id=hl-28-168><a class=lnlinks href=#hl-28-168>168</a>
</span><span class=lnt id=hl-28-169><a class=lnlinks href=#hl-28-169>169</a>
</span><span class=lnt id=hl-28-170><a class=lnlinks href=#hl-28-170>170</a>
</span><span class=lnt id=hl-28-171><a class=lnlinks href=#hl-28-171>171</a>
</span><span class=lnt id=hl-28-172><a class=lnlinks href=#hl-28-172>172</a>
</span><span class=lnt id=hl-28-173><a class=lnlinks href=#hl-28-173>173</a>
</span><span class=lnt id=hl-28-174><a class=lnlinks href=#hl-28-174>174</a>
</span><span class=lnt id=hl-28-175><a class=lnlinks href=#hl-28-175>175</a>
</span><span class=lnt id=hl-28-176><a class=lnlinks href=#hl-28-176>176</a>
</span><span class=lnt id=hl-28-177><a class=lnlinks href=#hl-28-177>177</a>
</span><span class=lnt id=hl-28-178><a class=lnlinks href=#hl-28-178>178</a>
</span><span class=lnt id=hl-28-179><a class=lnlinks href=#hl-28-179>179</a>
</span><span class=lnt id=hl-28-180><a class=lnlinks href=#hl-28-180>180</a>
</span><span class=lnt id=hl-28-181><a class=lnlinks href=#hl-28-181>181</a>
</span><span class=lnt id=hl-28-182><a class=lnlinks href=#hl-28-182>182</a>
</span><span class=lnt id=hl-28-183><a class=lnlinks href=#hl-28-183>183</a>
</span><span class=lnt id=hl-28-184><a class=lnlinks href=#hl-28-184>184</a>
</span><span class=lnt id=hl-28-185><a class=lnlinks href=#hl-28-185>185</a>
</span><span class=lnt id=hl-28-186><a class=lnlinks href=#hl-28-186>186</a>
</span><span class=lnt id=hl-28-187><a class=lnlinks href=#hl-28-187>187</a>
</span><span class=lnt id=hl-28-188><a class=lnlinks href=#hl-28-188>188</a>
</span><span class=lnt id=hl-28-189><a class=lnlinks href=#hl-28-189>189</a>
</span><span class=lnt id=hl-28-190><a class=lnlinks href=#hl-28-190>190</a>
</span><span class=lnt id=hl-28-191><a class=lnlinks href=#hl-28-191>191</a>
</span><span class=lnt id=hl-28-192><a class=lnlinks href=#hl-28-192>192</a>
</span><span class=lnt id=hl-28-193><a class=lnlinks href=#hl-28-193>193</a>
</span><span class=lnt id=hl-28-194><a class=lnlinks href=#hl-28-194>194</a>
</span><span class=lnt id=hl-28-195><a class=lnlinks href=#hl-28-195>195</a>
</span><span class=lnt id=hl-28-196><a class=lnlinks href=#hl-28-196>196</a>
</span><span class=lnt id=hl-28-197><a class=lnlinks href=#hl-28-197>197</a>
</span><span class=lnt id=hl-28-198><a class=lnlinks href=#hl-28-198>198</a>
</span><span class=lnt id=hl-28-199><a class=lnlinks href=#hl-28-199>199</a>
</span><span class=lnt id=hl-28-200><a class=lnlinks href=#hl-28-200>200</a>
</span><span class=lnt id=hl-28-201><a class=lnlinks href=#hl-28-201>201</a>
</span><span class=lnt id=hl-28-202><a class=lnlinks href=#hl-28-202>202</a>
</span><span class=lnt id=hl-28-203><a class=lnlinks href=#hl-28-203>203</a>
</span><span class=lnt id=hl-28-204><a class=lnlinks href=#hl-28-204>204</a>
</span><span class=lnt id=hl-28-205><a class=lnlinks href=#hl-28-205>205</a>
</span><span class=lnt id=hl-28-206><a class=lnlinks href=#hl-28-206>206</a>
</span><span class=lnt id=hl-28-207><a class=lnlinks href=#hl-28-207>207</a>
</span><span class=lnt id=hl-28-208><a class=lnlinks href=#hl-28-208>208</a>
</span><span class=lnt id=hl-28-209><a class=lnlinks href=#hl-28-209>209</a>
</span><span class=lnt id=hl-28-210><a class=lnlinks href=#hl-28-210>210</a>
</span><span class=lnt id=hl-28-211><a class=lnlinks href=#hl-28-211>211</a>
</span><span class=lnt id=hl-28-212><a class=lnlinks href=#hl-28-212>212</a>
</span><span class=lnt id=hl-28-213><a class=lnlinks href=#hl-28-213>213</a>
</span><span class=lnt id=hl-28-214><a class=lnlinks href=#hl-28-214>214</a>
</span><span class=lnt id=hl-28-215><a class=lnlinks href=#hl-28-215>215</a>
</span><span class=lnt id=hl-28-216><a class=lnlinks href=#hl-28-216>216</a>
</span><span class=lnt id=hl-28-217><a class=lnlinks href=#hl-28-217>217</a>
</span><span class=lnt id=hl-28-218><a class=lnlinks href=#hl-28-218>218</a>
</span><span class=lnt id=hl-28-219><a class=lnlinks href=#hl-28-219>219</a>
</span><span class=lnt id=hl-28-220><a class=lnlinks href=#hl-28-220>220</a>
</span><span class=lnt id=hl-28-221><a class=lnlinks href=#hl-28-221>221</a>
</span><span class=lnt id=hl-28-222><a class=lnlinks href=#hl-28-222>222</a>
</span><span class=lnt id=hl-28-223><a class=lnlinks href=#hl-28-223>223</a>
</span><span class=lnt id=hl-28-224><a class=lnlinks href=#hl-28-224>224</a>
</span><span class=lnt id=hl-28-225><a class=lnlinks href=#hl-28-225>225</a>
</span><span class=lnt id=hl-28-226><a class=lnlinks href=#hl-28-226>226</a>
</span><span class=lnt id=hl-28-227><a class=lnlinks href=#hl-28-227>227</a>
</span><span class=lnt id=hl-28-228><a class=lnlinks href=#hl-28-228>228</a>
</span><span class=lnt id=hl-28-229><a class=lnlinks href=#hl-28-229>229</a>
</span><span class=lnt id=hl-28-230><a class=lnlinks href=#hl-28-230>230</a>
</span><span class=lnt id=hl-28-231><a class=lnlinks href=#hl-28-231>231</a>
</span><span class=lnt id=hl-28-232><a class=lnlinks href=#hl-28-232>232</a>
</span><span class=lnt id=hl-28-233><a class=lnlinks href=#hl-28-233>233</a>
</span><span class=lnt id=hl-28-234><a class=lnlinks href=#hl-28-234>234</a>
</span><span class=lnt id=hl-28-235><a class=lnlinks href=#hl-28-235>235</a>
</span><span class=lnt id=hl-28-236><a class=lnlinks href=#hl-28-236>236</a>
</span><span class=lnt id=hl-28-237><a class=lnlinks href=#hl-28-237>237</a>
</span><span class=lnt id=hl-28-238><a class=lnlinks href=#hl-28-238>238</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pyflink.datastream</span> <span class=kn>import</span> <span class=n>StreamExecutionEnvironment</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pyflink.table</span> <span class=kn>import</span> <span class=n>StreamTableEnvironment</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pyflink.common.serialization</span> <span class=kn>import</span> <span class=n>SimpleStringSchema</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pyflink.datastream.connectors</span> <span class=kn>import</span> <span class=n>FlinkKafkaConsumer</span><span class=p>,</span> <span class=n>FlinkKafkaProducer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>FraudDetectionProcessor</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;실시간 사기 탐지 스트림 처리기&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Flink 실행 환경 설정</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>env</span> <span class=o>=</span> <span class=n>StreamExecutionEnvironment</span><span class=o>.</span><span class=n>get_execution_environment</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>env</span><span class=o>.</span><span class=n>set_parallelism</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span>  <span class=c1># 병렬 처리 수 설정</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 체크포인팅 활성화 (장애 복구용)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>env</span><span class=o>.</span><span class=n>enable_checkpointing</span><span class=p>(</span><span class=mi>10000</span><span class=p>)</span>  <span class=c1># 10초마다 체크포인트</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 테이블 환경 설정</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>table_env</span> <span class=o>=</span> <span class=n>StreamTableEnvironment</span><span class=o>.</span><span class=n>create</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>env</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 사기 탐지 규칙 저장소 (상태 관리)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>fraud_patterns</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_kafka_source</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;카프카에서 거래 이벤트 스트림 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>properties</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;bootstrap.servers&#39;</span><span class=p>:</span> <span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;group.id&#39;</span><span class=p>:</span> <span class=s1>&#39;fraud-detection-group&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;auto.offset.reset&#39;</span><span class=p>:</span> <span class=s1>&#39;latest&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 카프카 컨슈머 생성 (거래 이벤트 토픽에서 데이터 수신)</span>
</span></span><span class=line><span class=cl>        <span class=n>kafka_consumer</span> <span class=o>=</span> <span class=n>FlinkKafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>topics</span><span class=o>=</span><span class=s1>&#39;transaction-events&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>deserialization_schema</span><span class=o>=</span><span class=n>SimpleStringSchema</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>properties</span><span class=o>=</span><span class=n>properties</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>env</span><span class=o>.</span><span class=n>add_source</span><span class=p>(</span><span class=n>kafka_consumer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>parse_transaction_event</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event_json</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;거래 이벤트 JSON 파싱 및 구조화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>event</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>event_json</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;transaction_id&#39;</span><span class=p>:</span> <span class=n>event</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;transaction_id&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>event</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user_id&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;amount&#39;</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>event</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;amount&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;location&#39;</span><span class=p>:</span> <span class=n>event</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;location&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>fromisoformat</span><span class=p>(</span><span class=n>event</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;timestamp&#39;</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;card_number&#39;</span><span class=p>:</span> <span class=n>event</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;card_number&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;merchant_category&#39;</span><span class=p>:</span> <span class=n>event</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;merchant_category&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;이벤트 파싱 오류: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>detect_velocity_fraud</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>transaction</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;거래 빈도 기반 사기 탐지&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>user_id</span> <span class=o>=</span> <span class=n>transaction</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>current_time</span> <span class=o>=</span> <span class=n>transaction</span><span class=p>[</span><span class=s1>&#39;timestamp&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 사용자별 최근 거래 이력 관리 (상태 저장)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user_id</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>fraud_patterns</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>fraud_patterns</span><span class=p>[</span><span class=n>user_id</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>user_transactions</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>fraud_patterns</span><span class=p>[</span><span class=n>user_id</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 최근 5분 내 거래 수 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>recent_transactions</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=n>t</span> <span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=n>user_transactions</span> 
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>current_time</span> <span class=o>-</span> <span class=n>t</span><span class=p>[</span><span class=s1>&#39;timestamp&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>&lt;</span> <span class=mi>300</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 5분 내 5회 이상 거래 시 의심</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>recent_transactions</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>5</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>True</span><span class=p>,</span> <span class=s2>&#34;높은 거래 빈도 감지&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 현재 거래를 이력에 추가</span>
</span></span><span class=line><span class=cl>        <span class=n>user_transactions</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>transaction</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 메모리 최적화: 1시간 이상 된 거래 제거</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>fraud_patterns</span><span class=p>[</span><span class=n>user_id</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=n>t</span> <span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=n>user_transactions</span> 
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>current_time</span> <span class=o>-</span> <span class=n>t</span><span class=p>[</span><span class=s1>&#39;timestamp&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>&lt;</span> <span class=mi>3600</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;정상&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>detect_location_fraud</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>transaction</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;위치 기반 사기 탐지&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>user_id</span> <span class=o>=</span> <span class=n>transaction</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>current_location</span> <span class=o>=</span> <span class=n>transaction</span><span class=p>[</span><span class=s1>&#39;location&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>current_time</span> <span class=o>=</span> <span class=n>transaction</span><span class=p>[</span><span class=s1>&#39;timestamp&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user_id</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>fraud_patterns</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;신규 사용자&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>user_transactions</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>fraud_patterns</span><span class=p>[</span><span class=n>user_id</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 최근 1시간 내 거래 중 다른 위치에서의 거래 확인</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>prev_transaction</span> <span class=ow>in</span> <span class=n>user_transactions</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>time_diff</span> <span class=o>=</span> <span class=p>(</span><span class=n>current_time</span> <span class=o>-</span> <span class=n>prev_transaction</span><span class=p>[</span><span class=s1>&#39;timestamp&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 1시간 내 거래 중 위치가 다른 경우</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>time_diff</span> <span class=o>&lt;</span> <span class=mi>3600</span> <span class=ow>and</span> <span class=n>prev_transaction</span><span class=p>[</span><span class=s1>&#39;location&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=n>current_location</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># 물리적으로 불가능한 이동 시간 계산 (간단한 예시)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_travel_time</span><span class=p>(</span><span class=n>prev_transaction</span><span class=p>[</span><span class=s1>&#39;location&#39;</span><span class=p>],</span> <span class=n>current_location</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>time_diff</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=kc>True</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&#34;불가능한 위치 이동: </span><span class=si>{</span><span class=n>prev_transaction</span><span class=p>[</span><span class=s1>&#39;location&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> -&gt; </span><span class=si>{</span><span class=n>current_location</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;정상&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>calculate_travel_time</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>location1</span><span class=p>,</span> <span class=n>location2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;두 위치 간 최소 이동 시간 계산 (간단한 예시)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 실제로는 지리적 거리와 교통수단을 고려한 복잡한 계산 필요</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>location1</span> <span class=o>!=</span> <span class=n>location2</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=mi>1800</span>  <span class=c1># 30분 최소 이동 시간 가정</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>detect_amount_fraud</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>transaction</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;거래 금액 기반 사기 탐지&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>user_id</span> <span class=o>=</span> <span class=n>transaction</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>amount</span> <span class=o>=</span> <span class=n>transaction</span><span class=p>[</span><span class=s1>&#39;amount&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 사용자별 평균 거래 금액 계산</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user_id</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>fraud_patterns</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;신규 사용자&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>user_transactions</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>fraud_patterns</span><span class=p>[</span><span class=n>user_id</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>user_transactions</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>5</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;거래 이력 부족&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 최근 30일 평균 거래 금액 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>recent_amounts</span> <span class=o>=</span> <span class=p>[</span><span class=n>t</span><span class=p>[</span><span class=s1>&#39;amount&#39;</span><span class=p>]</span> <span class=k>for</span> <span class=n>t</span> <span class=ow>in</span> <span class=n>user_transactions</span><span class=p>[</span><span class=o>-</span><span class=mi>30</span><span class=p>:]]</span>
</span></span><span class=line><span class=cl>        <span class=n>avg_amount</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=n>recent_amounts</span><span class=p>)</span> <span class=o>/</span> <span class=nb>len</span><span class=p>(</span><span class=n>recent_amounts</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 평균의 5배 이상이면 의심</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>amount</span> <span class=o>&gt;</span> <span class=n>avg_amount</span> <span class=o>*</span> <span class=mi>5</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>True</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&#34;비정상적 고액 거래: </span><span class=si>{</span><span class=n>amount</span><span class=si>}</span><span class=s2> (평균: </span><span class=si>{</span><span class=n>avg_amount</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>)&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;정상&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>calculate_risk_score</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>fraud_results</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;여러 탐지 결과를 종합하여 위험 점수 계산&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>risk_score</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>risk_factors</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>is_fraud</span><span class=p>,</span> <span class=n>reason</span> <span class=ow>in</span> <span class=n>fraud_results</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>is_fraud</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=s2>&#34;빈도&#34;</span> <span class=ow>in</span> <span class=n>reason</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>risk_score</span> <span class=o>+=</span> <span class=mi>40</span>
</span></span><span class=line><span class=cl>                <span class=k>elif</span> <span class=s2>&#34;위치&#34;</span> <span class=ow>in</span> <span class=n>reason</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>risk_score</span> <span class=o>+=</span> <span class=mi>35</span>
</span></span><span class=line><span class=cl>                <span class=k>elif</span> <span class=s2>&#34;고액&#34;</span> <span class=ow>in</span> <span class=n>reason</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>risk_score</span> <span class=o>+=</span> <span class=mi>25</span>
</span></span><span class=line><span class=cl>                <span class=n>risk_factors</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>reason</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>min</span><span class=p>(</span><span class=n>risk_score</span><span class=p>,</span> <span class=mi>100</span><span class=p>),</span> <span class=n>risk_factors</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_transaction</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>transaction_event</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;거래 이벤트 처리 메인 로직&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>transaction</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>parse_transaction_event</span><span class=p>(</span><span class=n>transaction_event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>transaction</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 다양한 사기 탐지 규칙 적용</span>
</span></span><span class=line><span class=cl>        <span class=n>fraud_checks</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>detect_velocity_fraud</span><span class=p>(</span><span class=n>transaction</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>detect_location_fraud</span><span class=p>(</span><span class=n>transaction</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>detect_amount_fraud</span><span class=p>(</span><span class=n>transaction</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 위험 점수 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>risk_score</span><span class=p>,</span> <span class=n>risk_factors</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>calculate_risk_score</span><span class=p>(</span><span class=n>fraud_checks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 결과 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;transaction_id&#39;</span><span class=p>:</span> <span class=n>transaction</span><span class=p>[</span><span class=s1>&#39;transaction_id&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>transaction</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;risk_score&#39;</span><span class=p>:</span> <span class=n>risk_score</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;risk_factors&#39;</span><span class=p>:</span> <span class=n>risk_factors</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>transaction</span><span class=p>[</span><span class=s1>&#39;timestamp&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>isoformat</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;action&#39;</span><span class=p>:</span> <span class=s1>&#39;BLOCK&#39;</span> <span class=k>if</span> <span class=n>risk_score</span> <span class=o>&gt;</span> <span class=mi>70</span> <span class=k>else</span> <span class=s1>&#39;ALLOW&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_kafka_sink</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;처리 결과를 카프카로 전송&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>properties</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;bootstrap.servers&#39;</span><span class=p>:</span> <span class=s1>&#39;localhost:9092&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 사기 탐지 결과를 별도 토픽으로 전송</span>
</span></span><span class=line><span class=cl>        <span class=n>kafka_producer</span> <span class=o>=</span> <span class=n>FlinkKafkaProducer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>topic</span><span class=o>=</span><span class=s1>&#39;fraud-detection-results&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>serialization_schema</span><span class=o>=</span><span class=n>SimpleStringSchema</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>producer_config</span><span class=o>=</span><span class=n>properties</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>kafka_producer</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>run</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;스트림 처리 파이프라인 실행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 데이터 소스 생성</span>
</span></span><span class=line><span class=cl>            <span class=n>transaction_stream</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>create_kafka_source</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 거래 이벤트 처리 및 사기 탐지</span>
</span></span><span class=line><span class=cl>            <span class=n>fraud_detection_stream</span> <span class=o>=</span> <span class=n>transaction_stream</span><span class=o>.</span><span class=n>map</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>process_transaction</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>output_type</span><span class=o>=</span><span class=n>Types</span><span class=o>.</span><span class=n>STRING</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>)</span>  <span class=c1># None 결과 제외</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 결과를 카프카로 전송</span>
</span></span><span class=line><span class=cl>            <span class=n>fraud_detection_stream</span><span class=o>.</span><span class=n>add_sink</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>create_kafka_sink</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 실행 시작</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>env</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;Real-time Fraud Detection&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>logging</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;스트림 처리 오류: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 로깅 설정</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 사기 탐지 프로세서 생성 및 실행</span>
</span></span><span class=line><span class=cl>    <span class=n>fraud_detector</span> <span class=o>=</span> <span class=n>FraudDetectionProcessor</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;실시간 사기 탐지 시스템 시작…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>fraud_detector</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=python-apache-kafka--faust-실시간-거래-이상-탐지>Python, Apache Kafka + Faust: 실시간 거래 이상 탐지<a hidden class=anchor aria-hidden=true href=#python-apache-kafka--faust-실시간-거래-이상-탐지>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-29-1><a class=lnlinks href=#hl-29-1> 1</a>
</span><span class=lnt id=hl-29-2><a class=lnlinks href=#hl-29-2> 2</a>
</span><span class=lnt id=hl-29-3><a class=lnlinks href=#hl-29-3> 3</a>
</span><span class=lnt id=hl-29-4><a class=lnlinks href=#hl-29-4> 4</a>
</span><span class=lnt id=hl-29-5><a class=lnlinks href=#hl-29-5> 5</a>
</span><span class=lnt id=hl-29-6><a class=lnlinks href=#hl-29-6> 6</a>
</span><span class=lnt id=hl-29-7><a class=lnlinks href=#hl-29-7> 7</a>
</span><span class=lnt id=hl-29-8><a class=lnlinks href=#hl-29-8> 8</a>
</span><span class=lnt id=hl-29-9><a class=lnlinks href=#hl-29-9> 9</a>
</span><span class=lnt id=hl-29-10><a class=lnlinks href=#hl-29-10>10</a>
</span><span class=lnt id=hl-29-11><a class=lnlinks href=#hl-29-11>11</a>
</span><span class=lnt id=hl-29-12><a class=lnlinks href=#hl-29-12>12</a>
</span><span class=lnt id=hl-29-13><a class=lnlinks href=#hl-29-13>13</a>
</span><span class=lnt id=hl-29-14><a class=lnlinks href=#hl-29-14>14</a>
</span><span class=lnt id=hl-29-15><a class=lnlinks href=#hl-29-15>15</a>
</span><span class=lnt id=hl-29-16><a class=lnlinks href=#hl-29-16>16</a>
</span><span class=lnt id=hl-29-17><a class=lnlinks href=#hl-29-17>17</a>
</span><span class=lnt id=hl-29-18><a class=lnlinks href=#hl-29-18>18</a>
</span><span class=lnt id=hl-29-19><a class=lnlinks href=#hl-29-19>19</a>
</span><span class=lnt id=hl-29-20><a class=lnlinks href=#hl-29-20>20</a>
</span><span class=lnt id=hl-29-21><a class=lnlinks href=#hl-29-21>21</a>
</span><span class=lnt id=hl-29-22><a class=lnlinks href=#hl-29-22>22</a>
</span><span class=lnt id=hl-29-23><a class=lnlinks href=#hl-29-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Faust 기반 실시간 거래 이상 탐지 예시</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>faust</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 거래 데이터 모델 정의</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Transaction</span><span class=p>(</span><span class=n>faust</span><span class=o>.</span><span class=n>Record</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>user_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>amount</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>timestamp</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>faust</span><span class=o>.</span><span class=n>App</span><span class=p>(</span><span class=s1>&#39;fraud-detection&#39;</span><span class=p>,</span> <span class=n>broker</span><span class=o>=</span><span class=s1>&#39;kafka://localhost:9092&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>transactions</span> <span class=o>=</span> <span class=n>app</span><span class=o>.</span><span class=n>topic</span><span class=p>(</span><span class=s1>&#39;transactions&#39;</span><span class=p>,</span> <span class=n>value_type</span><span class=o>=</span><span class=n>Transaction</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 이상 거래 탐지 함수</span>
</span></span><span class=line><span class=cl><span class=nd>@app.agent</span><span class=p>(</span><span class=n>transactions</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>detect_fraud</span><span class=p>(</span><span class=n>transactions</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>for</span> <span class=n>tx</span> <span class=ow>in</span> <span class=n>transactions</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 예시: 1000 이상 거래는 이상 거래로 간주</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>tx</span><span class=o>.</span><span class=n>amount</span> <span class=o>&gt;</span> <span class=mi>1000</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;이상 거래 감지: </span><span class=si>{</span><span class=n>tx</span><span class=o>.</span><span class=n>user_id</span><span class=si>}</span><span class=s2>, 금액: </span><span class=si>{</span><span class=n>tx</span><span class=o>.</span><span class=n>amount</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># 알림, DB 저장 등 추가 처리 가능</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=kafka--flink-기반-python-구현-예시-이상-거래-탐지>Kafka + Flink 기반 Python 구현 예시: 이상 거래 탐지<a hidden class=anchor aria-hidden=true href=#kafka--flink-기반-python-구현-예시-이상-거래-탐지>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-30-1><a class=lnlinks href=#hl-30-1> 1</a>
</span><span class=lnt id=hl-30-2><a class=lnlinks href=#hl-30-2> 2</a>
</span><span class=lnt id=hl-30-3><a class=lnlinks href=#hl-30-3> 3</a>
</span><span class=lnt id=hl-30-4><a class=lnlinks href=#hl-30-4> 4</a>
</span><span class=lnt id=hl-30-5><a class=lnlinks href=#hl-30-5> 5</a>
</span><span class=lnt id=hl-30-6><a class=lnlinks href=#hl-30-6> 6</a>
</span><span class=lnt id=hl-30-7><a class=lnlinks href=#hl-30-7> 7</a>
</span><span class=lnt id=hl-30-8><a class=lnlinks href=#hl-30-8> 8</a>
</span><span class=lnt id=hl-30-9><a class=lnlinks href=#hl-30-9> 9</a>
</span><span class=lnt id=hl-30-10><a class=lnlinks href=#hl-30-10>10</a>
</span><span class=lnt id=hl-30-11><a class=lnlinks href=#hl-30-11>11</a>
</span><span class=lnt id=hl-30-12><a class=lnlinks href=#hl-30-12>12</a>
</span><span class=lnt id=hl-30-13><a class=lnlinks href=#hl-30-13>13</a>
</span><span class=lnt id=hl-30-14><a class=lnlinks href=#hl-30-14>14</a>
</span><span class=lnt id=hl-30-15><a class=lnlinks href=#hl-30-15>15</a>
</span><span class=lnt id=hl-30-16><a class=lnlinks href=#hl-30-16>16</a>
</span><span class=lnt id=hl-30-17><a class=lnlinks href=#hl-30-17>17</a>
</span><span class=lnt id=hl-30-18><a class=lnlinks href=#hl-30-18>18</a>
</span><span class=lnt id=hl-30-19><a class=lnlinks href=#hl-30-19>19</a>
</span><span class=lnt id=hl-30-20><a class=lnlinks href=#hl-30-20>20</a>
</span><span class=lnt id=hl-30-21><a class=lnlinks href=#hl-30-21>21</a>
</span><span class=lnt id=hl-30-22><a class=lnlinks href=#hl-30-22>22</a>
</span><span class=lnt id=hl-30-23><a class=lnlinks href=#hl-30-23>23</a>
</span><span class=lnt id=hl-30-24><a class=lnlinks href=#hl-30-24>24</a>
</span><span class=lnt id=hl-30-25><a class=lnlinks href=#hl-30-25>25</a>
</span><span class=lnt id=hl-30-26><a class=lnlinks href=#hl-30-26>26</a>
</span><span class=lnt id=hl-30-27><a class=lnlinks href=#hl-30-27>27</a>
</span><span class=lnt id=hl-30-28><a class=lnlinks href=#hl-30-28>28</a>
</span><span class=lnt id=hl-30-29><a class=lnlinks href=#hl-30-29>29</a>
</span><span class=lnt id=hl-30-30><a class=lnlinks href=#hl-30-30>30</a>
</span><span class=lnt id=hl-30-31><a class=lnlinks href=#hl-30-31>31</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># PyFlink 예시: Kafka에서 실시간 거래 데이터 수신 후 이상 거래 탐지</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pyflink.datastream</span> <span class=kn>import</span> <span class=n>StreamExecutionEnvironment</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pyflink.common.serialization</span> <span class=kn>import</span> <span class=n>SimpleStringSchema</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pyflink.datastream.connectors</span> <span class=kn>import</span> <span class=n>FlinkKafkaConsumer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. 실행 환경 설정</span>
</span></span><span class=line><span class=cl><span class=n>env</span> <span class=o>=</span> <span class=n>StreamExecutionEnvironment</span><span class=o>.</span><span class=n>get_execution_environment</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Kafka에서 데이터 읽기</span>
</span></span><span class=line><span class=cl><span class=n>kafka_props</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;bootstrap.servers&#39;</span><span class=p>:</span> <span class=s1>&#39;localhost:9092&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;group.id&#39;</span><span class=p>:</span> <span class=s1>&#39;fraud-detection-group&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>consumer</span> <span class=o>=</span> <span class=n>FlinkKafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>topics</span><span class=o>=</span><span class=s1>&#39;transactions&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>deserialization_schema</span><span class=o>=</span><span class=n>SimpleStringSchema</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>properties</span><span class=o>=</span><span class=n>kafka_props</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. 스트림 데이터 수신</span>
</span></span><span class=line><span class=cl><span class=n>stream</span> <span class=o>=</span> <span class=n>env</span><span class=o>.</span><span class=n>add_source</span><span class=p>(</span><span class=n>consumer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. 거래 데이터를 기준으로 필터링 - 예: 1000달러 이상이면 의심 거래</span>
</span></span><span class=line><span class=cl><span class=n>suspicious</span> <span class=o>=</span> <span class=n>stream</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=k>lambda</span> <span class=n>tx</span><span class=p>:</span> <span class=nb>float</span><span class=p>(</span><span class=n>tx</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;,&#34;</span><span class=p>)[</span><span class=mi>2</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 5. 콘솔 출력 (또는 다른 Sink 사용 가능)</span>
</span></span><span class=line><span class=cl><span class=n>suspicious</span><span class=o>.</span><span class=n>print</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 6. 실행</span>
</span></span><span class=line><span class=cl><span class=n>env</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;Fraud Detection Stream Job&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>고려 사항</strong></th><th><strong>설명</strong></th><th><strong>주요 리스크/문제</strong></th><th><strong>권장 사항</strong></th></tr></thead><tbody><tr><td><strong>아키텍처 및 확장성</strong></td><td>시스템 확장성 계획</td><td>처리량 증가에 대비한 수평 확장 설계</td><td>병목 발생, 리소스 부족</td><td>메시지 브로커 + 파티셔닝 기반 분산 설계, 오토스케일링 적용</td></tr><tr><td></td><td>내결함성 (Fault Tolerance)</td><td>장애 발생 시에도 시스템이 지속적으로 동작할 수 있도록 설계</td><td>단일 장애점 발생, 전체 중단</td><td>다중 AZ 배포, 체크포인트 + 상태 저장소, DLQ 구성</td></tr><tr><td></td><td>비용 효율성 관리</td><td>리소스 사용에 따른 비용 예측 및 제어</td><td>과도한 인프라 비용 발생</td><td>리소스 최적화 + 스팟 인스턴스 + 스케일링 정책 적용</td></tr><tr><td><strong>데이터 구조/무결성</strong></td><td>스키마 진화 및 호환성</td><td>스트림 데이터 구조가 변경될 경우의 대응 전략</td><td>파싱 오류, 호환 불가</td><td>Schema Registry 도입, 스키마 버전 관리 정책 적용</td></tr><tr><td></td><td>데이터 품질 검증</td><td>실시간 스트림의 정합성/정확성 확보</td><td>이상 데이터 처리 실패, ML 모델 성능 저하</td><td>데이터 프로파일링, 유효성 검사, 사전 필터링 적용</td></tr><tr><td><strong>신뢰성 및 처리 보장</strong></td><td>Exactly-once 처리</td><td>이벤트가 중복 없이 정확히 한 번만 처리되도록 보장</td><td>중복 처리, 유실 처리, 순서 불일치</td><td>Flink, Kafka Streams 의 Exactly-once 모드 사용</td></tr><tr><td></td><td>처리 순서 보장</td><td>시간 기반 집계 시 순서 불일치 문제 대응</td><td>집계 오류, 중복/누락 집계</td><td>Event-time + Watermark 기반 처리</td></tr><tr><td></td><td>멱등성 처리</td><td>동일 이벤트가 재처리되어도 결과에 영향 없도록 설계</td><td>데이터 중복 생성, 부정확한 결과</td><td>멱등한 소비자 로직 구현, 중복 감지 키 사용</td></tr><tr><td></td><td>상태 저장 전략</td><td>상태 기반 연산 시 상태 저장소 설계 방식</td><td>메모리 과부하, 장애 시 상태 유실</td><td>RocksDB, Redis 등 외부 상태 스토어 사용</td></tr><tr><td><strong>오류 및 장애 대응</strong></td><td>Dead Letter Queue 설정</td><td>실패 이벤트를 별도로 수집하여 재처리</td><td>전체 스트림 중단, 데이터 손실</td><td>DLQ 구성 및 알림 설정, 문제 발생 시 수동 개입 허용</td></tr><tr><td></td><td>체크포인트 및 재시도 설계</td><td>장애 발생 시 복구 지점 확보 및 자동 재처리</td><td>상태 복구 실패, 중복 처리</td><td>주기적 체크포인트, 지연 기반 재시도 로직 구성</td></tr><tr><td><strong>운영 및 가시성</strong></td><td>실시간 모니터링 및 알림</td><td>성능 지표/상태 실시간 확인 및 이상 징후 대응</td><td>장애 발생 감지 지연, SLA 위반</td><td>Prometheus + Grafana, CloudWatch, 알림 연동</td></tr><tr><td></td><td>테스트 전략</td><td>실시간 처리 환경에서의 테스트 자동화 및 시뮬레이션</td><td>운영 환경 반영 어려움, 릴리즈 오류</td><td>샘플 로그 기반 Mock 처리, Kafka Test Topics 구성</td></tr></tbody></table><h3 id=최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>카테고리</th><th>최적화 항목</th><th>설명</th><th>권장사항 및 전략</th></tr></thead><tbody><tr><td><strong>1. 성능 최적화</strong></td><td><strong>처리량/지연 시간</strong></td><td>이벤트 폭주 시 병목 발생, 낮은 처리량은 지연 초래</td><td>파티셔닝, 병렬 처리 수 조정, 비동기 처리, 적절한 버퍼 설정</td></tr><tr><td></td><td><strong>네트워크 최적화</strong></td><td>데이터 전송량 증가 시 처리 지연 발생</td><td>데이터 압축 적용, Avro/Protobuf 등 경량 직렬화 포맷 사용</td></tr><tr><td></td><td><strong>Sink 처리 최적화</strong></td><td>DB 또는 외부 저장소로 직접 출력 시 병목 발생</td><td>Batch Sink 활용, Buffering Sink 설계, Async I/O 도입</td></tr><tr><td></td><td><strong>Backpressure 감지</strong></td><td>소비자보다 빠른 생산자 속도로 인해 시스템 압력 발생</td><td>모니터링 및 경고 설정, 처리량 제한 및 흐름 제어 (Rate Limiting) 적용</td></tr><tr><td><strong>2. 리소스 효율화</strong></td><td><strong>CPU 사용률 최적화</strong></td><td>연산 과다, 불필요한 계산으로 CPU 부하 증가</td><td>비동기 처리, 코루틴 활용, CPU 캐시 친화적 연산 적용</td></tr><tr><td></td><td><strong>메모리 관리</strong></td><td>상태 또는 버퍼 크기 증가로 OOM 발생 가능</td><td>TTL 설정, 상태 압축, 메모리 프로파일링, 불필요한 상태 제거</td></tr><tr><td></td><td><strong>리소스 자동 조정</strong></td><td>부하에 따라 자원 할당이 고정되어 있으면 낭비 또는 부족 발생</td><td>Auto-scaling, Horizontal/Vertical 스케일 조정 전략 도입</td></tr><tr><td></td><td><strong>스토리지 I/O 최적화</strong></td><td>상태 저장 또는 로그 기록에서 디스크 병목 발생</td><td>SSD, RocksDB 튜닝, 인덱싱, 파티셔닝, GC 주기 조정</td></tr><tr><td><strong>3. 상태 관리 최적화</strong></td><td><strong>상태 저장 성능</strong></td><td>상태 크기 증가로 인한 GC 및 디스크 병목</td><td>외부 상태 저장소 사용, RocksDB 설정 최적화, 주기적 스냅샷</td></tr><tr><td></td><td><strong>체크포인트 주기 조절</strong></td><td>너무 잦으면 오버헤드, 너무 드물면 복구 어려움</td><td>시스템 상황에 맞는 체크포인트 주기 설정, 증분 체크포인트 활용</td></tr><tr><td></td><td><strong>상태 TTL 및 압축</strong></td><td>오래된 상태 유지로 메모리/디스크 낭비</td><td>TTL 정책 설정, 상태 TTL 만료 후 정리, 상태 압축 알고리즘 적용</td></tr><tr><td><strong>4. 알고리즘/전략 최적화</strong></td><td><strong>윈도우 연산 최적화</strong></td><td>불필요한 중복 연산 또는 비효율적 윈도우 설정</td><td>데이터 특성 기반 슬라이딩/텀블링 윈도우 선택, 근사 집계 알고리즘 활용 (e.g. HyperLogLog)</td></tr><tr><td></td><td><strong>조인 최적화</strong></td><td>다중 스트림 조인에서 자원 과다 소모</td><td>Bloom Filter 활용, Pre-filtering, 조인 순서 최적화</td></tr><tr><td></td><td><strong>데이터 파티셔닝</strong></td><td>키 기반 분산 불균형 시 일부 파티션 병목 유발</td><td>해시 파티셔닝, Range 파티셔닝 설계, Sharding 기반 분산 처리</td></tr><tr><td><strong>5. 운영 및 장애 대응</strong></td><td><strong>배포 전략</strong></td><td>실시간 서비스 중단 없이 새 버전 배포 필요</td><td>블루 - 그린, 카나리 배포, 롤백 전략 자동화</td></tr><tr><td></td><td><strong>장애 감지 및 복구</strong></td><td>장애 인지 및 복구 지연 시 데이터 유실 또는 지연 확대</td><td>헬스 체크 자동화, 알람 설정, 장애 복구 시나리오 사전 검증</td></tr><tr><td></td><td><strong>모니터링 및 추적</strong></td><td>시스템 병목 또는 오류 추적 어려움</td><td>OpenTelemetry, Prometheus, Grafana 연계로 메트릭/로그/트레이스 통합 관측 적용</td></tr></tbody></table><h3 id=주제와-관련하여-주목할-내용>주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#주제와-관련하여-주목할-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>1. 설계 요소 및 처리 모델</strong></td><td>스트림 처리</td><td>실시간 처리</td><td>이벤트가 발생하는 즉시 처리되는 저지연 데이터 처리 방식</td></tr><tr><td></td><td>처리 보장</td><td>Exactly-once</td><td>중복 없이 정확히 한 번만 처리하는 모델로, 금융/로그 시스템 필수</td></tr><tr><td></td><td>시간 처리 모델</td><td>Event-time, Processing-time</td><td>이벤트 발생 기준 시간 기반 처리로 시간 일관성 보장</td></tr><tr><td></td><td>윈도우 연산</td><td>Tumbling, Sliding, Session 등</td><td>시간/이벤트 기준 집계를 위한 핵심 연산 기법</td></tr><tr><td></td><td>체크포인트</td><td>중간 상태 저장</td><td>장애 시 빠른 복구 및 상태 재구성 가능</td></tr><tr><td><strong>2. 핵심 기술 컴포넌트</strong></td><td>메시지 브로커</td><td>Apache Kafka</td><td>분산 이벤트 스트림 처리의 핵심 브로커 플랫폼</td></tr><tr><td></td><td>스트림 처리 엔진</td><td>Apache Flink, Kafka Streams</td><td>상태 기반 스트림 처리 지원, CEP, 창 기반 처리 가능</td></tr><tr><td></td><td>마이크로 배치 처리</td><td>Spark Structured Streaming</td><td>배치 기반이지만 준실시간 처리를 지원하는 모델</td></tr><tr><td><strong>3. 아키텍처 및 설계 패턴</strong></td><td>아키텍처 모델</td><td>Kappa Architecture</td><td>순수 스트림 중심의 단순하고 실시간성 높은 구조</td></tr><tr><td></td><td>이벤트 소싱</td><td>상태 이벤트 기반 모델</td><td>상태 변경을 이벤트로 기록하여 추적/복원 가능</td></tr><tr><td></td><td>CQRS / Saga</td><td>분산 트랜잭션 및 명령 - 조회 분리 패턴</td><td>마이크로서비스에서 확장성과 일관성을 동시에 보장</td></tr><tr><td><strong>4. 최신 기술 동향</strong></td><td>엣지 스트림 처리</td><td>Edge Computing</td><td>IoT 현장에서의 저지연 실시간 데이터 처리</td></tr><tr><td></td><td>경량 실행 엔진</td><td>WebAssembly</td><td>브라우저/서버에서 경량화된 고성능 연산 지원</td></tr><tr><td></td><td>서버리스 처리</td><td>Serverless Streaming</td><td>이벤트 기반 자원 자동 할당 및 확장 처리 방식</td></tr><tr><td></td><td>멀티 클라우드 처리</td><td>Multi-Cloud</td><td>특정 벤더에 종속되지 않는 스트림 처리 구조</td></tr><tr><td><strong>5. AI/ML 통합</strong></td><td>자동화된 모델 생성</td><td>AutoML</td><td>실시간 스트림 데이터를 기반으로 한 모델 자동 학습 및 업데이트</td></tr><tr><td></td><td>분산 학습</td><td>Federated Learning</td><td>개인 정보 보호 기반의 실시간 학습 아키텍처</td></tr><tr><td><strong>6. 보안 및 프라이버시</strong></td><td>통계적 보호 기법</td><td>Differential Privacy</td><td>데이터 개인 정보 보호를 위한 노이즈 삽입 기반 처리 방식</td></tr><tr><td></td><td>암호 기반 계산</td><td>Homomorphic Encryption</td><td>암호화된 상태에서 연산을 수행하여 원본 노출 없이 분석 가능</td></tr><tr><td><strong>7. 표준화 및 관측성</strong></td><td>분산 추적 표준</td><td>OpenTelemetry</td><td>스트리밍 시스템의 추적, 메트릭, 로그 통합 관측 프레임워크</td></tr><tr><td></td><td>이벤트 정의 표준</td><td>CloudEvents</td><td>이벤트 기반 시스템 간 상호 운용성 확보를 위한 포맷 표준</td></tr></tbody></table><h3 id=반드시-학습해야할-내용>반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야할-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>1. 핵심 개념</strong></td><td>분산 시스템 개념</td><td>CAP 정리</td><td>일관성 (Consistency), 가용성 (Availability), 분할 내성 (Partition Tolerance) 의 트레이드오프 이해</td></tr><tr><td></td><td>스트림 처리 모델</td><td>Stateless vs Stateful</td><td>상태 유무에 따른 처리 전략: 메모리 기반 vs 상태 저장소 기반</td></tr><tr><td></td><td>처리 보장</td><td>Exactly-once, At-least-once</td><td>중복/유실 없는 데이터 처리를 보장하는 전략</td></tr><tr><td></td><td>이벤트 기반 아키텍처</td><td>이벤트 소싱</td><td>상태 변경을 이벤트로 저장하고 재구성하는 방식</td></tr><tr><td></td><td>아키텍처 모델 비교</td><td>Lambda vs Kappa</td><td>배치 + 스트림 혼합 (Lambda) vs 순수 스트림 (Kappa)</td></tr><tr><td><strong>2. 구현 기술 및 프레임워크</strong></td><td>메시지 브로커</td><td>Apache Kafka, RabbitMQ</td><td>메시지 큐를 통한 비동기 데이터 처리 및 버퍼링</td></tr><tr><td></td><td>스트림 처리 엔진</td><td>Apache Flink, Kafka Streams, Faust</td><td>실시간 스트림 데이터를 처리하는 주요 엔진 및 프레임워크</td></tr><tr><td></td><td>Kafka Streams API</td><td>고수준 DSL 기반의 메시지 처리 API</td><td>Kafka 기반의 상태 저장 스트림 처리 구현 가능</td></tr><tr><td></td><td>Flink CEP</td><td>Complex Event Processing</td><td>Flink 기반의 복합 이벤트 패턴 탐지 처리</td></tr><tr><td></td><td>상태 저장소</td><td>RocksDB, 외부 Key-Value Store</td><td>Stateful 처리 시 필요한 상태 유지 및 복구 기반</td></tr><tr><td><strong>3. 아키텍처 및 패턴</strong></td><td>명령 - 조회 분리 패턴 (CQRS)</td><td>CQRS 패턴</td><td>읽기 (Read) 와 쓰기 (Write) 를 분리하여 확장성과 성능 확보</td></tr><tr><td></td><td>분산 트랜잭션 관리</td><td>Saga Pattern</td><td>마이크로서비스 간 트랜잭션 보장을 위한 순차/보상 기반 패턴</td></tr><tr><td><strong>4. 성능 최적화 및 제어</strong></td><td>부하 제어</td><td>Backpressure</td><td>소비자 처리 속도가 느릴 경우 생산 속도를 제어하는 메커니즘</td></tr><tr><td></td><td>윈도우 연산</td><td>슬라이딩, 텀블링, 세션 윈도우</td><td>시간/이벤트 기반의 집계 및 분석 단위 구분</td></tr><tr><td></td><td>처리량/지연 시간 분석</td><td>Throughput, Latency Metrics</td><td>실시간 성능 최적화를 위한 핵심 지표 수집 및 분석</td></tr><tr><td><strong>5. 테스트 및 운영</strong></td><td>테스트 전략</td><td>Stream Unit/Integration Testing</td><td>실시간 처리 플로우에 대한 테스트 전략 정립</td></tr><tr><td></td><td>분산 추적</td><td>Tracing (OpenTelemetry 등)</td><td>분산 환경에서 요청 흐름 추적 및 병목 지점 진단</td></tr><tr><td></td><td>메트릭 수집 및 모니터링</td><td>Prometheus, Grafana, CloudWatch</td><td>성능 지표 및 이상 탐지를 위한 실시간 시각화 및 경고 시스템</td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th><strong>카테고리</strong></th><th><strong>용어</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>기본 개념</strong></td><td>Stream Processing</td><td>실시간으로 연속적으로 데이터 이벤트를 처리하는 방식</td></tr><tr><td></td><td>Batch Processing</td><td>일정량의 데이터를 모아서 일괄 처리하는 방식</td></tr><tr><td></td><td>Stateless</td><td>상태 없이 각 이벤트를 독립적으로 처리</td></tr><tr><td></td><td>Stateful</td><td>상태를 저장하며 과거 이벤트와 연관된 처리를 수행</td></tr><tr><td><strong>시간 처리 모델</strong></td><td>Event Time</td><td>이벤트가 실제로 발생한 시간</td></tr><tr><td></td><td>Processing Time</td><td>시스템에서 이벤트가 처리된 시간</td></tr><tr><td></td><td>Watermark</td><td>늦게 도착한 이벤트를 처리하기 위한 시간 기준선</td></tr><tr><td><strong>처리 방식</strong></td><td>Exactly-once</td><td>이벤트를 정확히 한 번만 처리 (중복/손실 없음)</td></tr><tr><td></td><td>At-least-once</td><td>이벤트를 한 번 이상 처리 (중복 가능성 있음)</td></tr><tr><td></td><td>At-most-once</td><td>이벤트를 최대 한 번만 처리 (유실 가능성 있음)</td></tr><tr><td><strong>핵심 연산/기능</strong></td><td>Windowing</td><td>시간 또는 이벤트 기준으로 스트림을 유한한 창 (window) 으로 분할 후 집계 처리</td></tr><tr><td></td><td>Checkpointing</td><td>장애 발생 시 복구를 위한 상태 저장 지점 설정</td></tr><tr><td></td><td>Partitioning</td><td>데이터를 키나 범위 기준으로 분할하여 병렬 처리 유도</td></tr><tr><td></td><td>Backpressure</td><td>생산자 - 소비자 간 처리 속도 불균형 발생 시 시스템 부하 조절 메커니즘</td></tr><tr><td></td><td>CEP (Complex Event Processing)</td><td>이벤트 간의 복합 관계를 분석하여 고차원 패턴 탐지 처리</td></tr><tr><td><strong>성능 지표</strong></td><td>Throughput</td><td>단위 시간당 처리 가능한 이벤트 수</td></tr><tr><td></td><td>Latency</td><td>이벤트가 입력된 시점부터 처리 완료까지 걸리는 시간</td></tr><tr><td><strong>기술 및 도구</strong></td><td>Kafka</td><td>고성능 분산 메시지 브로커, 토픽 기반의 퍼블리시/서브스크라이브 지원</td></tr><tr><td></td><td>Topic</td><td>Kafka 에서 이벤트가 게시되는 단위 논리 채널</td></tr><tr><td></td><td>Flink</td><td>상태 기반 실시간 처리 스트림 엔진, Exactly-once 지원</td></tr><tr><td></td><td>Spark Streaming</td><td>마이크로배치 기반 스트림 처리 엔진</td></tr><tr><td></td><td>Faust</td><td>Python 기반 스트림 처리 마이크로프레임워크</td></tr><tr><td><strong>아키텍처/패턴</strong></td><td>Lambda Architecture</td><td>배치 + 스트림 처리를 결합한 아키텍처 구조</td></tr><tr><td></td><td>Kappa Architecture</td><td>모든 처리를 스트림 기반으로 단순화한 아키텍처 구조</td></tr><tr><td></td><td>Event Sourcing</td><td>모든 상태 변경을 이벤트 로그로 저장하는 패턴</td></tr><tr><td></td><td>State Store</td><td>상태 기반 처리 시, 상태 값을 저장하고 참조하기 위한 저장소</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://www.geeksforgeeks.org/stream-processing-system-design-architecture/>Stream Processing System Design Architecture - GeeksforGeeks</a></li><li><a href=https://www.redpanda.com/guides/fundamentals-of-data-engineering-stream-processing>Stream processing fundamentals—Concepts, challenges, and best practices - Redpanda</a></li><li><a href=https://hazelcast.com/foundations/event-driven-architecture/stream-processing/>What Is Stream Processing? A Layman&rsquo;s Overview - Hazelcast</a></li><li><a href=https://addepto.com/blog/stream-data-model-and-architecture/>Stream Data Model and Architecture: The Ultimate Guide for 2025 - Addepto</a></li><li><a href=https://estuary.dev/blog/data-streaming-architecture/>Data Streaming Architecture: Components, Process, & Diagrams - Estuary</a></li><li><a href=https://martinfowler.com/articles/201701-stream-processing.html>Stream Processing 개념 및 비교 - Martin Fowler</a></li><li><a href=https://www.confluent.io/learn/batch-vs-real-time-stream-processing/>Stream Processing vs. Batch Processing - Confluent</a></li><li><a href=https://aws.amazon.com/streaming-data/>Real-time Stream Processing on AWS</a></li><li><a href=https://cloud.google.com/solutions/stream-analytics>Google Cloud Streaming Analytics</a></li><li><a href=https://www.kai-waehner.de/blog/2021/09/23/real-time-kappa-architecture-mainstream-replacing-batch-lambda/>Kappa Architecture is Mainstream Replacing Lambda - Kai Waehner</a></li><li><a href=https://www.confluent.io/use-case/fraud-detection/>Real-Time Fraud Detection and Prevention - Confluent</a></li><li><a href=https://www.confluent.io/what-is-stream-processing/>실시간 데이터 처리 아키텍처 - Confluent</a></li><li><a href=https://flink.apache.org/>Apache Flink 공식 문서</a></li><li><a href=https://nightlies.apache.org/flink/flink-docs-master/docs/concepts/overview/>Apache Flink Concepts - 최신 문서</a></li><li><a href=https://kafka.apache.org/documentation/streams/>Kafka Streams 공식 문서</a></li><li><a href=https://kafka.apache.org/documentation/>Apache Kafka 공식 문서</a></li><li><a href=https://beam.apache.org/documentation/programming-guide/>Apache Beam Programming Guide</a></li><li><a href=https://www.onehouse.ai/blog/apache-spark-structured-streaming-vs-apache-flink-vs-apache-kafka-streams-comparing-stream-processing-engines>Apache Flink vs Kafka Streams vs Spark Structured Streaming - Onehouse</a></li><li><a href=https://faust.readthedocs.io/en/latest/>Faust 공식 문서 (Python 기반 Stream Processing)</a></li></ul><hr></div></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2026 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>