<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Pipe-and-Filter | hyunyoun's Blog</title><meta name=keywords content="Software-Engineering,Design-and-Architecture,Architecture-Styles-and-Patterns,Architecture-Styles,Data-Flow,Styles,Pipe-and-Filter,Modular-Design"><meta name=description content="Pipe-and-Filter 는 데이터를 여러 독립적인 처리 단계 (필터) 로 분할하고, 각 필터를 파이프를 통해 연결하여 데이터가 연속적으로 흐르며 가공되는 구조이다. 높은 모듈성, 재사용성, 확장성을 갖추어 데이터 처리 파이프라인, 컴파일러, ETL 등 다양한 분야에서 활용된다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/data--database-systems/data-architecture/data-processing-architecture/data-flow-styles/pipe-and-filter/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.d522c866f0cc9c20ae4fa73a0a8c07f0af4c36af75bcbcd3e90558446f681077.css integrity="sha256-1SLIZvDMnCCuT6c6CowH8K9MNq91vLzT6QVYRG9oEHc=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/data--database-systems/data-architecture/data-processing-architecture/data-flow-styles/pipe-and-filter/index.xml title=rss><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/data--database-systems/data-architecture/data-processing-architecture/data-flow-styles/pipe-and-filter/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/data--database-systems/data-architecture/data-processing-architecture/data-flow-styles/pipe-and-filter/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Pipe-and-Filter"><meta property="og:description" content="Pipe-and-Filter 는 데이터를 여러 독립적인 처리 단계 (필터) 로 분할하고, 각 필터를 파이프를 통해 연결하여 데이터가 연속적으로 흐르며 가공되는 구조이다. 높은 모듈성, 재사용성, 확장성을 갖추어 데이터 처리 파이프라인, 컴파일러, ETL 등 다양한 분야에서 활용된다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Pipe-and-Filter"><meta name=twitter:description content="Pipe-and-Filter 는 데이터를 여러 독립적인 처리 단계 (필터) 로 분할하고, 각 필터를 파이프를 통해 연결하여 데이터가 연속적으로 흐르며 가공되는 구조이다. 높은 모듈성, 재사용성, 확장성을 갖추어 데이터 처리 파이프라인, 컴파일러, ETL 등 다양한 분야에서 활용된다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HY's Blog","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":6,"name":"Pipe-and-Filter","item":"https://buenhyden.github.io/posts/data--database-systems/data-architecture/data-processing-architecture/data-flow-styles/pipe-and-filter/"}]}</script></head><body class=list id=top><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>HY's Blog</a></div><h1>Pipe-and-Filter</h1><div class=post-description>Pipe-and-Filter 는 데이터를 여러 독립적인 처리 단계 (필터) 로 분할하고, 각 필터를 파이프를 통해 연결하여 데이터가 연속적으로 흐르며 가공되는 구조이다. 높은 모듈성, 재사용성, 확장성을 갖추어 데이터 처리 파이프라인, 컴파일러, ETL 등 다양한 분야에서 활용된다.</div></header><div class=post-content><h2 id=pipe-and-filter>Pipe-and-Filter<a hidden class=anchor aria-hidden=true href=#pipe-and-filter>#</a></h2><p>Pipe-and-Filter 는 데이터를 처리 흐름에 따라 독립된 필터 (Filter) 모듈로 나누고, 각 모듈 간 데이터를 파이프 (Pipe) 를 통해 전달하며 시스템 전체를 구성하는 아키텍처 스타일이다. 각 필터는 특정 작업 (검증, 변환, 집계 등) 에 집중하며, 파이프는 데이터를 순서대로 전달한다. 이런 설계는 <strong>모듈성</strong>, <strong>재사용성</strong>, <strong>조합성</strong> 등을 극대화해 유지보수와 확장을 용이하게 한다. 반면, 필터의 수가 많아질수록 오버헤드, 지연 (latency), 디버깅 복잡도, 포맷 호환 문제 등이 발생할 수 있다. 실무에서는 컴파일러, Unix 셸 명령어, ETL 파이프라인, 미디어 처리 시스템 등에 주로 적용된다.</p><h3 id=배경>배경<a hidden class=anchor aria-hidden=true href=#배경>#</a></h3><p>Pipe-and-Filter 는 1970 년대 Unix 운영체제의 파이프라인 철학에서 기원했다. Doug McIlroy 가 제안한 " 작은 프로그램들을 조합하여 복잡한 작업을 수행한다 " 는 Unix 철학이 이 아키텍처의 기반이 되었다. 이후 소프트웨어 공학 분야에서 정형화되어 Garlan 과 Shaw 의 소프트웨어 아키텍처 연구를 통해 체계적으로 정리되었다.</p><h3 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h3><p><strong>주요 목적</strong>:</p><ul><li><strong>복잡성 분해</strong><ul><li>복잡한 데이터 처리 작업을 단순한 단계로 분할</li><li>각 단계의 독립적 구현 및 관리</li><li>전체 시스템의 이해도 향상</li></ul></li><li><strong>재사용성 증대</strong><ul><li>공통 필터의 여러 파이프라인에서 재사용</li><li>개발 시간 단축 및 일관성 확보</li><li>표준화된 컴포넌트 라이브러리 구축</li></ul></li><li><strong>확장성 확보</strong><ul><li>개별 필터의 독립적 확장</li><li>병렬 처리를 통한 성능 향상</li><li>클라우드 환경에서의 탄력적 스케일링</li></ul></li></ul><p><strong>필요성</strong>:</p><ul><li><strong>데이터 처리 복잡성 증가</strong><ul><li>빅데이터 시대의 대용량 데이터 처리</li><li>실시간 스트림 처리 요구사항 증가</li><li>다양한 데이터 형식 및 소스의 통합</li></ul></li><li><strong>시스템 유연성 요구</strong><ul><li>비즈니스 요구사항의 빈번한 변경</li><li>새로운 데이터 처리 로직의 빠른 적용</li><li>레거시 시스템과의 통합 필요성</li></ul></li></ul><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><p>Pipe-and-Filter 는 데이터 스트림을 일련의 처리 단계로 나누는 아키텍처 스타일이다. 각 단계는 &ldquo;Filter&rdquo; 로 구현되며, 처리 결과는 &ldquo;Pipe&rdquo; 를 통해 다음 필터로 전달된다.</p><p>이와 같은 특성을 가지고 있다:</p><ul><li><strong>모듈성 (Modularity)</strong>: 각 필터는 고립되어 있어 변경이나 유지보수가 쉽다.</li><li><strong>재사용성 (Reusability)</strong>: 입력/출력 인터페이스만 맞으면 필터를 다양한 파이프라인에 재사용할 수 있다.</li><li><strong>조합성 (Composability)</strong>: 필터를 조합하거나 순서를 변경해 새로운 파이프라인을 구성할 수 있다.</li><li><strong>병렬 처리 가능성 (Parallelism)</strong>: 독립적인 필터 실행 덕분에 병렬화되어 처리량을 늘릴 수 있다.</li></ul><h4 id=기본-개념>기본 개념<a hidden class=anchor aria-hidden=true href=#기본-개념>#</a></h4><ol><li><p><strong>파이프 (Pipe)</strong></p><ul><li>데이터 전송을 담당하는 커넥터 또는 채널</li><li>한 필터의 출력을 다음 필터의 입력으로 연결</li><li>데이터 스트림의 순서와 동기화 보장</li><li>구현 방식: 메시지 큐, 소켓, 공유 메모리, 파일 시스템</li></ul></li><li><p><strong>필터 (Filter)</strong></p><ul><li>독립적인 데이터 처리 컴포넌트</li><li>입력 데이터를 받아 변환, 가공, 검증 후 출력</li><li>상태를 가지지 않는 순수 함수적 특성 (Stateless)</li><li>재사용 가능하고 교체 가능한 모듈</li></ul></li><li><p><strong>데이터 소스 (Data Source)</strong></p><ul><li>파이프라인의 시작점</li><li>외부 시스템, 파일, 사용자 입력 등에서 데이터 제공</li><li>초기 데이터를 첫 번째 필터로 전송</li></ul></li><li><p><strong>데이터 싱크 (Data Sink)</strong></p><ul><li>파이프라인의 종료점</li><li>최종 처리된 데이터를 외부 시스템, 파일, 화면 등에 출력</li><li>결과 데이터의 최종 목적지</li></ul></li></ol><h4 id=심화-개념>심화 개념<a hidden class=anchor aria-hidden=true href=#심화-개념>#</a></h4><ol><li><p><strong>포트 (Port)</strong></p><ul><li>필터와 파이프 간의 연결점</li><li>입력 포트 (Sink Port): 데이터가 들어오는 지점</li><li>출력 포트 (Source Port): 데이터가 나가는 지점</li><li>데이터 타입과 프로토콜 협상 지원</li></ul></li><li><p><strong>버퍼링 (Buffering)</strong></p><ul><li>파이프에서 데이터를 임시 저장하는 메커니즘</li><li>필터 간 처리 속도 차이 조절</li><li>백프레셔 (Backpressure) 처리</li></ul></li><li><p><strong>라우팅 (Routing)</strong></p><ul><li>조건부 데이터 흐름 제어</li><li>분기 및 병합 패턴 지원</li><li>동적 경로 선택</li></ul></li></ol><h4 id=실무-구현-연관성>실무 구현 연관성<a hidden class=anchor aria-hidden=true href=#실무-구현-연관성>#</a></h4><ol><li><p><strong>스트림 처리 시스템과의 연관성:</strong></p><ul><li>Apache Kafka Streams, Apache Flink 의 핵심 설계 패러다임</li><li>실시간 데이터 처리 파이프라인 구축의 기본 원칙</li><li>마이크로서비스 아키텍처에서 데이터 흐름 설계</li></ul></li><li><p><strong>미디어 처리 시스템과의 연관성:</strong></p><ul><li>GStreamer, FFmpeg 의 핵심 아키텍처</li><li>비디오/오디오 인코딩/디코딩 파이프라인</li><li>실시간 멀티미디어 스트리밍</li></ul></li><li><p><strong>컴파일러 설계와의 연관성:</strong></p><ul><li>렉시컬 분석 → 구문 분석 → 의미 분석 → 코드 생성</li><li>각 단계가 독립적인 필터로 구현</li><li>최적화 패스의 모듈화</li></ul></li></ol><h4 id=실무-연계>실무 연계<a hidden class=anchor aria-hidden=true href=#실무-연계>#</a></h4><table><thead><tr><th>활용 분야</th><th>적용 방식 및 특징</th></tr></thead><tbody><tr><td><strong>데이터 처리</strong></td><td>ETL 파이프라인, 스트림 처리 시스템에서 필터를 연산 모듈로 사용</td></tr><tr><td><strong>이미지/비디오 처리</strong></td><td>GStreamer, FFmpeg 와 같은 프레임워크에서 필터 체인으로 변환 수행</td></tr><tr><td><strong>컴파일러 설계</strong></td><td>Lexer → Parser → Optimizer 등의 모듈 연결</td></tr><tr><td><strong>IoT 처리</strong></td><td>센서 데이터 → 필터 처리 → 전송 → 경보 시스템 등으로 처리 단계화 가능</td></tr></tbody></table><h3 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h3><ol><li><p><strong>시스템 분해 기능:</strong></p><ul><li>복잡한 처리 로직을 독립적인 단위로 분해</li><li>각 필터가 단일 책임을 갖도록 설계</li><li>관심사의 분리 (Separation of Concerns) 구현</li></ul></li><li><p><strong>데이터 흐름 제어:</strong></p><ul><li>순차적 데이터 처리 흐름 관리</li><li>데이터 변환 체인 구성</li><li>오류 전파 및 복구 메커니즘</li></ul></li><li><p><strong>조합성 제공:</strong></p><ul><li>필터들의 다양한 조합으로 새로운 기능 창출</li><li>런타임 구성 변경 지원</li><li>플러그인 아키텍처 구현</li></ul></li></ol><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><ol><li><p><strong>독립성 (Independence):</strong></p><ul><li>각 필터는 다른 필터와 독립적으로 동작</li><li>필터 간 직접적인 상태 공유 없음</li><li>인터페이스를 통한 느슨한 결합</li></ul></li><li><p><strong>순차성 (Sequential Processing):</strong></p><ul><li>데이터가 파이프라인을 따라 순차적으로 흐름</li><li>각 단계에서 점진적인 데이터 변환</li><li>선형적 데이터 흐름 패턴</li></ul></li><li><p><strong>투명성 (Transparency):</strong></p><ul><li>각 필터는 이전/다음 필터를 알 필요 없음</li><li>데이터 소스와 싱크의 추상화</li><li>구현 세부사항 은닉</li></ul></li></ol><h3 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h3><ol><li><p><strong>단일 책임 원칙 (Single Responsibility Principle):</strong></p><ul><li>각 필터는 하나의 명확한 기능만 수행</li><li>응집도 높은 컴포넌트 설계</li><li>기능별 독립적 테스트 가능</li></ul></li><li><p><strong>개방 - 폐쇄 원칙 (Open-Closed Principle):</strong></p><ul><li>새로운 필터 추가에는 열려있음</li><li>기존 필터 수정에는 닫혀있음</li><li>확장 가능한 아키텍처 구현</li></ul></li><li><p><strong>의존성 역전 원칙 (Dependency Inversion Principle):</strong></p><ul><li>필터는 추상화된 인터페이스에 의존</li><li>구체적 구현이 아닌 계약에 의존</li><li>유연한 컴포넌트 교체 가능</li></ul></li></ol><h3 id=주요-원리>주요 원리<a hidden class=anchor aria-hidden=true href=#주요-원리>#</a></h3><ol><li><p><strong>필터 독립성</strong></p><ul><li><strong>무상태 (stateless)</strong>: 필터는 상태를 공유하지 않아야 하며, 내부 로직만 수행.</li><li><strong>블라인드 연결</strong>: 필터는 &rsquo; 위/아래 필터 &rsquo; 이름을 알 필요 없음.</li></ul></li><li><p><strong>데이터 스트림 처리</strong></p><ul><li>입력을 읽어 바로 출력 → 파이프 단계마다 대기 없는 흐름</li><li><strong>유형</strong>: 배치형 (batch-sequential) 또는 스트림 (streaming) 형태로 구현 가능</li></ul></li><li><p>병렬성 및 확장성</p><ul><li>각 필터는 독립 실행 가능 → 다중 인스턴스로 확장 가능</li><li>병렬성에는 버퍼, 직렬화 비용 고려 필요</li></ul></li></ol><h3 id=작동-원리-및-방식>작동 원리 및 방식<a hidden class=anchor aria-hidden=true href=#작동-원리-및-방식>#</a></h3><h4 id=핵심-원리>핵심 원리<a hidden class=anchor aria-hidden=true href=#핵심-원리>#</a></h4><p><strong>데이터 흐름 원리:</strong></p><ol><li><strong>순방향 흐름:</strong> 데이터는 소스에서 싱크로 한 방향으로 흐름</li><li><strong>변환 체인:</strong> 각 필터에서 데이터가 점진적으로 변환</li><li><strong>비동기 처리:</strong> 필터들이 독립적으로 병렬 처리 가능</li></ol><h4 id=작동-방식>작동 방식<a hidden class=anchor aria-hidden=true href=#작동-방식>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sequenceDiagram
</span></span><span class=line><span class=cl>    participant Source
</span></span><span class=line><span class=cl>    participant Filter1
</span></span><span class=line><span class=cl>    participant Filter2
</span></span><span class=line><span class=cl>    participant Filter3
</span></span><span class=line><span class=cl>    participant Sink
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Source-&gt;&gt;Filter1: 데이터 스트림 전송
</span></span><span class=line><span class=cl>    Filter1-&gt;&gt;Filter2: 처리된 데이터 전송
</span></span><span class=line><span class=cl>    Filter2-&gt;&gt;Filter3: 추가 처리 후 전송
</span></span><span class=line><span class=cl>    Filter3-&gt;&gt;Sink: 최종 결과 출력
</span></span></code></pre></td></tr></table></div></div><ul><li>각 Filter 는 입력이 들어오면 즉시 처리하고 다음 단계로 넘김</li><li>동기/비동기 처리 모두 가능 (Pipe 구성 방식에 따라)</li><li>Stateless 처리 시 확장성 높고, Stateful 처리 시 파이프라인에서 병렬성 관리 필요</li><li><strong>동기화 메커니즘</strong>:<ul><li><strong>Push 모델:</strong> 업스트림 필터가 다운스트림으로 데이터 전송</li><li><strong>Pull 모델:</strong> 다운스트림 필터가 업스트림에서 데이터 요청</li><li><strong>하이브리드 모델:</strong> 상황에 따라 두 모델을 혼합 사용</li></ul></li></ul><h3 id=10-구조-및-아키텍처>10. 구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#10-구조-및-아키텍처>#</a></h3><h4 id=구성-요소>구성 요소<a hidden class=anchor aria-hidden=true href=#구성-요소>#</a></h4><table><thead><tr><th>구성 요소</th><th>설명</th><th>기능/특징</th><th>필수 여부</th></tr></thead><tbody><tr><td>Pump</td><td>소스</td><td>데이터 스트림 시작</td><td>필수</td></tr><tr><td>Pipe</td><td>전달 채널</td><td>필터 간 데이터 전송, 버퍼링</td><td>필수</td></tr><tr><td>Filter</td><td>처리 모듈</td><td>transform, validate, enrich 등</td><td>필수</td></tr><tr><td>Sink</td><td>결과 소비</td><td>파일, DB, API 등에 최종 저장</td><td>필수</td></tr><tr><td>버퍼/큐</td><td>비동기 처리</td><td>처리 불일치 보완, 고성능 지원</td><td>선택</td></tr><tr><td>메시징 시스템</td><td>비동기, 장애 대응</td><td>Kafka, RabbitMQ 기반 파이프</td><td>선택</td></tr><tr><td>모니터링/로깅</td><td>상태 추적</td><td>필터 간 메트릭, 장애 탐지</td><td>선택</td></tr><tr><td>컨트롤러/오케스트레이터</td><td>파이프라인 구성 관리</td><td>YAML/DSL 기반 연결 정의</td><td>선택</td></tr></tbody></table><ul><li>필터는 <strong>무상태 (stateless)</strong> 로 설계돼야 유연한 재배포와 병렬 실행이 용이하다.</li><li>Pipe 는 <strong>단방향 흐름</strong>을 보장해야 하며, 직렬화/역직렬화 비용을 감안하여 설계해야 한다.</li></ul><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><p>Pipe-and-Filter 아키텍처는 아래 세 가지 구성 요소를 중심으로 구성된다:</p><ul><li><strong>Filter (필터)</strong>: 독립적으로 데이터를 처리하는 모듈</li><li><strong>Pipe (파이프)</strong>: 데이터 흐름 경로 (스트림, 큐, 채널 등)</li><li><strong>Pipeline (파이프라인)</strong>: 연속적인 Filter + Pipe 의 조합</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>graph LR
</span></span><span class=line><span class=cl>    A[Data Source] --&gt; B[Pipe 1]
</span></span><span class=line><span class=cl>    B --&gt; C[Filter 1]
</span></span><span class=line><span class=cl>    C --&gt; D[Pipe 2]
</span></span><span class=line><span class=cl>    D --&gt; E[Filter 2]
</span></span><span class=line><span class=cl>    E --&gt; F[Pipe 3]
</span></span><span class=line><span class=cl>    F --&gt; G[Filter 3]
</span></span><span class=line><span class=cl>    G --&gt; H[Pipe 4]
</span></span><span class=line><span class=cl>    H --&gt; I[Data Sink]
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    style A fill:#e1f5fe
</span></span><span class=line><span class=cl>    style C fill:#f3e5f5
</span></span><span class=line><span class=cl>    style E fill:#f3e5f5
</span></span><span class=line><span class=cl>    style G fill:#f3e5f5
</span></span><span class=line><span class=cl>    style I fill:#e8f5e8
</span></span></code></pre></td></tr></table></div></div><h4 id=구성요소>구성요소<a hidden class=anchor aria-hidden=true href=#구성요소>#</a></h4><table><thead><tr><th>구분</th><th>구성요소</th><th>기능</th><th>역할</th><th>특징</th></tr></thead><tbody><tr><td><strong>필수</strong></td><td><strong>데이터 소스 (Data Source)</strong></td><td>초기 데이터를 파이프라인에 공급</td><td>외부 시스템 (파일, API 등) 로부터 데이터 수신</td><td>파이프라인 시작점, 데이터 생성/수신 담당</td></tr><tr><td></td><td><strong>필터 (Filter)</strong></td><td>데이터 변환 및 처리 수행</td><td>입력을 받아 변환 후 출력 생성</td><td>상태 없음, 모듈화 가능, 독립 실행 가능</td></tr><tr><td></td><td><strong>파이프 (Pipe)</strong></td><td>필터 간 데이터 전달</td><td>데이터 흐름 전달 및 형식 표준화 역할</td><td>버퍼링, 동기화, 데이터 타입 통합 지원</td></tr><tr><td></td><td><strong>데이터 싱크 (Data Sink)</strong></td><td>처리된 데이터 최종 수집</td><td>외부 저장소/시스템으로 결과 데이터 전송</td><td>파이프라인 종료점, 결과 저장/출력 담당</td></tr><tr><td><strong>선택</strong></td><td><strong>스플리터 (Splitter)</strong></td><td>데이터 스트림을 여러 경로로 분기</td><td>병렬 처리 또는 라우팅 분기점</td><td>조건부 분기, 복사 및 분산 지원</td></tr><tr><td></td><td><strong>집계기 (Aggregator)</strong></td><td>다중 스트림을 하나로 병합</td><td>분산 처리된 결과 통합</td><td>데이터 정합성 보장, 순서 제어, 병합 처리</td></tr><tr><td></td><td><strong>라우터 (Router)</strong></td><td>조건 기반 라우팅 수행</td><td>동적 처리 경로 선택, 부하 분산</td><td>규칙 기반 조건 분기, 우선순위 분기</td></tr><tr><td></td><td><strong>트랜스포머 (Transformer)</strong></td><td>데이터 포맷/스키마 변환 수행</td><td>인코딩 변경, 형식 변환, 스키마 매핑</td><td>양방향 변환 가능, 복잡한 구조도 처리 가능</td></tr></tbody></table><ul><li>각 Filter 는 이전 단계로부터 데이터를 받아 처리하고, Pipe 를 통해 다음 Filter 로 전달</li><li>Pipe 는 단방향이며, 일반적으로 상태를 가지지 않음</li><li>병렬 확장 시 각 Filter 는 독립적으로 실행 가능</li></ul><h4 id=구성-요소-상세-분석>구성 요소 상세 분석<a hidden class=anchor aria-hidden=true href=#구성-요소-상세-분석>#</a></h4><h5 id=필터-상세-구조>필터 상세 구조<a hidden class=anchor aria-hidden=true href=#필터-상세-구조>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>graph TB
</span></span><span class=line><span class=cl>    subgraph &#34;Filter Internal Structure&#34;
</span></span><span class=line><span class=cl>        A[Input Port] --&gt; B[Input Validation]
</span></span><span class=line><span class=cl>        B --&gt; C[Processing Logic]
</span></span><span class=line><span class=cl>        C --&gt; D[Output Generation]
</span></span><span class=line><span class=cl>        D --&gt; E[Output Port]
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        F[Configuration] --&gt; C
</span></span><span class=line><span class=cl>        G[Error Handler] --&gt; C
</span></span><span class=line><span class=cl>        H[Monitoring] --&gt; C
</span></span><span class=line><span class=cl>    end
</span></span></code></pre></td></tr></table></div></div><table><thead><tr><th>구성 요소</th><th>주요 기능</th><th>세부 설명</th></tr></thead><tbody><tr><td><strong>입력 포트 (Input Port)</strong></td><td>데이터 수신 인터페이스</td><td>외부 파이프 또는 소스로부터 데이터 수신</td></tr><tr><td></td><td>데이터 형식 검증</td><td>입력 데이터가 기대하는 스키마 또는 포맷인지 확인</td></tr><tr><td></td><td>버퍼링 관리</td><td>처리 지연 또는 병목에 대비해 버퍼에 저장</td></tr><tr><td><strong>처리 로직 (Processing Logic)</strong></td><td>핵심 비즈니스 로직 수행</td><td>데이터 필터링, 변환, 계산 등의 로직 구현</td></tr><tr><td></td><td>상태 없는 처리</td><td>외부 상태 의존성 없이 순수 함수 기반 처리 권장</td></tr><tr><td></td><td>예외 처리</td><td>오류 발생 시 예외 감지 및 로깅/우회 처리</td></tr><tr><td><strong>출력 포트 (Output Port)</strong></td><td>처리 결과 전송</td><td>다음 필터 또는 싱크로 데이터 전달</td></tr><tr><td></td><td>형식 표준화</td><td>출력 데이터의 스키마 및 포맷 정렬</td></tr><tr><td></td><td>품질 보증 (Validation)</td><td>누락, 중복, 무결성 등 출력 데이터 검증</td></tr></tbody></table><h5 id=파이프-상세-구조>파이프 상세 구조<a hidden class=anchor aria-hidden=true href=#파이프-상세-구조>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>graph TB
</span></span><span class=line><span class=cl>    subgraph &#34;Pipe Internal Structure&#34;
</span></span><span class=line><span class=cl>        A[Input Interface] --&gt; B[Buffer Management]
</span></span><span class=line><span class=cl>        B --&gt; C[Data Serialization]
</span></span><span class=line><span class=cl>        C --&gt; D[Transport Layer]
</span></span><span class=line><span class=cl>        D --&gt; E[Data Deserialization]
</span></span><span class=line><span class=cl>        E --&gt; F[Output Interface]
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        G[Flow Control] --&gt; B
</span></span><span class=line><span class=cl>        H[Error Recovery] --&gt; D
</span></span><span class=line><span class=cl>        I[Monitoring] --&gt; D
</span></span><span class=line><span class=cl>    end
</span></span></code></pre></td></tr></table></div></div><table><thead><tr><th>구성 요소</th><th>주요 기능</th><th>세부 설명</th></tr></thead><tbody><tr><td><strong>버퍼 관리 (Buffer Management)</strong></td><td>데이터 임시 저장</td><td>필터 간 처리 속도 차이 완충을 위해 임시 저장소 역할 수행</td></tr><tr><td></td><td>흐름 제어</td><td>과도한 데이터 유입을 제어해 시스템 안정성 확보 (flow control)</td></tr><tr><td></td><td>백프레셔 처리</td><td>처리 병목 시 upstream 으로 신호 전달하여 속도 조절 (backpressure)</td></tr><tr><td><strong>전송 계층 (Transport Layer)</strong></td><td>네트워크 통신</td><td>필터 간 데이터 전송 시 네트워크 경로 확보 및 관리</td></tr><tr><td></td><td>프로토콜 처리</td><td>TCP, UDP, HTTP 등 다양한 통신 프로토콜 지원</td></tr><tr><td></td><td>안정성 보장</td><td>전송 실패 시 재시도, 순서 보장, 신뢰성 있는 전달 보장</td></tr><tr><td><strong>직렬화 / 역직렬화 (Serialization / Deserialization)</strong></td><td>데이터 형식 변환</td><td>객체 ↔ 바이트 스트림 또는 JSON, Avro 등 포맷 간 변환</td></tr><tr><td></td><td>압축 / 압축 해제</td><td>대역폭 절감 또는 저장 공간 최적화를 위한 처리</td></tr><tr><td></td><td>인코딩 / 디코딩</td><td>문자 인코딩, 바이너리 ↔ 텍스트 포맷 처리 등</td></tr></tbody></table><h3 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>구현 기법</strong></th><th><strong>정의 / 구성 요소</strong></th><th><strong>핵심 목적</strong></th><th><strong>실제 예시</strong></th></tr></thead><tbody><tr><td><strong>1. 실행 모델 기반</strong></td><td><strong>동기식 파이프라인</strong></td><td>필터가 순차적으로 실행되며, 이전 필터가 끝나야 다음으로 전달 (blocking I/O)</td><td>단순성, 순차 처리, 디버깅 용이</td><td>`cat file</td></tr><tr><td></td><td><strong>비동기식 파이프라인</strong></td><td>필터 간 큐/채널을 사용하여 독립 실행 (non-blocking, 병렬 처리 가능)</td><td>처리량 증가, 지연 허용, 확장성 확보</td><td>Kafka Streams, Node.js Streams, Python Queue 기반 파이프라인</td></tr><tr><td></td><td><strong>스트림 기반 처리</strong></td><td>연속적인 데이터 스트림을 필터로 전달하며 흐름 중심 처리 (windowing, backpressure 포함)</td><td>실시간 스트림 분석, 저지연 처리</td><td>Apache Flink, Node.js Transform Stream</td></tr><tr><td></td><td><strong>이벤트 기반 파이프라인</strong></td><td>이벤트 트리거에 따라 필터 실행 (event-driven consumer)</td><td>유연성, 느슨한 결합, 이벤트 처리 구조화</td><td>AWS Lambda + SQS, Kafka + Lambda</td></tr><tr><td><strong>2. 시스템 구조 기반</strong></td><td><strong>분산 처리 구조</strong></td><td>필터를 마이크로서비스 또는 컨테이너로 분리, 노드 간 메시지 큐로 연결</td><td>확장성, 장애 격리, 고가용성</td><td>Apache Flink Cluster, Celery + Redis</td></tr><tr><td></td><td><strong>서버리스 기반 구성</strong></td><td>각 필터를 Function 단위로 분리, 클라우드 이벤트로 실행</td><td>비용 효율성, 유지보수 최소화</td><td>AWS Lambda + EventBridge, Azure Durable Functions</td></tr><tr><td><strong>3. 최적화 전략 기반</strong></td><td><strong>Filter Fusion</strong></td><td>다수 필터 연산을 하나의 노드로 통합, 연산 비용 및 컨텍스트 전환 최소화</td><td>성능 최적화, 연산 병합</td><td>Spark Stage Fusion, Flink Operator Chain</td></tr><tr><td></td><td><strong>Buffered Pipes</strong></td><td>파이프 내부에 버퍼 큐를 도입하여 프로듀서-컨슈머 간 처리 속도 차이 완화</td><td>비동기 처리, 유실 방지, 흐름 제어</td><td>Node.js Stream, Akka Streams</td></tr><tr><td></td><td><strong>Parallel Filters</strong></td><td>동일 필터를 다수 인스턴스로 병렬 배치하여 throughput 개선</td><td>대용량 처리, 리소스 분산</td><td>FastAPI + Celery, Beam ParDo with MultiWorkers</td></tr><tr><td><strong>4. 구현 방식 기반</strong></td><td><strong>함수형 파이프라인</strong></td><td>불변 데이터 + 고차 함수 + 체이닝 기반 필터 구성</td><td>재사용성, 테스트 용이성</td><td>JavaScript <code>compose</code>, Python <code>functools</code>, F# pipeline</td></tr><tr><td></td><td><strong>프로그래밍 라이브러리 기반</strong></td><td>언어 내장 스트림 API 또는 체이닝 메커니즘 활용</td><td>간결한 표현식, 가독성</td><td>Java Stream API, RxJS,.NET LINQ</td></tr><tr><td><strong>5. 인프라/도구 기반</strong></td><td><strong>워크플로우 엔진 기반</strong></td><td>GUI 또는 DSL 기반으로 필터를 시각적 또는 선언적으로 정의</td><td>배치 자동화, 단계 의존성 관리</td><td>Apache NiFi, Airflow, Spring Cloud Data Flow</td></tr><tr><td></td><td><strong>메시지 큐 기반 처리</strong></td><td>필터 간 Kafka, RabbitMQ, SQS 등 메시지 큐로 연결</td><td>비동기성, 느슨한 결합, 처리 병렬화</td><td>Kafka + Consumer Group, RabbitMQ Worker Pattern</td></tr><tr><td><strong>6. 특수 목적 처리</strong></td><td><strong>컴파일러 필터 체인</strong></td><td>어휘 → 구문 → 의미 분석 → IR 생성 등 순차 필터 구성</td><td>구조적 처리, 분리된 책임</td><td>GCC, Clang, Babel</td></tr><tr><td></td><td><strong>멀티미디어 필터 체인</strong></td><td>이미지/비디오 처리 필터 체인 구성</td><td>실시간 필터링, 효과 적용</td><td>GStreamer, FFmpeg</td></tr></tbody></table><h4 id=동기식-파이프라인-synchronous-pipeline>동기식 파이프라인 (Synchronous Pipeline)<a hidden class=anchor aria-hidden=true href=#동기식-파이프라인-synchronous-pipeline>#</a></h4><p><strong>정의:</strong> 각 필터가 순차적으로 실행되는 구현 방식</p><p><strong>구성:</strong></p><ul><li>단일 스레드에서 모든 필터 실행</li><li>필터 간 직접적인 메서드 호출</li><li>간단한 데이터 전달 메커니즘</li></ul><p><strong>목적:</strong> 간단한 데이터 변환 체인 구현</p><p><strong>실제 예시:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span><span class=lnt id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a>
</span><span class=lnt id=hl-4-19><a class=lnlinks href=#hl-4-19>19</a>
</span><span class=lnt id=hl-4-20><a class=lnlinks href=#hl-4-20>20</a>
</span><span class=lnt id=hl-4-21><a class=lnlinks href=#hl-4-21>21</a>
</span><span class=lnt id=hl-4-22><a class=lnlinks href=#hl-4-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 동기식 파이프라인 예시</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SyncPipeline</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>filters</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_filter</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>filter_func</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>filter_func</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>execute</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>filter_func</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>=</span> <span class=n>filter_func</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>pipeline</span> <span class=o>=</span> <span class=n>SyncPipeline</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>upper</span><span class=p>())</span>  <span class=c1># 대문자 변환</span>
</span></span><span class=line><span class=cl><span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>  <span class=c1># 공백 제거</span>
</span></span><span class=line><span class=cl><span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span> <span class=s1>&#39;_&#39;</span><span class=p>))</span>  <span class=c1># 공백을 언더스코어로 변경</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;  hello world  &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>  <span class=c1># &#34;HELLO_WORLD&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=비동기식-파이프라인-asynchronous-pipeline>비동기식 파이프라인 (Asynchronous Pipeline)<a hidden class=anchor aria-hidden=true href=#비동기식-파이프라인-asynchronous-pipeline>#</a></h4><p><strong>정의:</strong> 각 필터가 독립적인 스레드나 프로세스에서 실행</p><p><strong>구성:</strong></p><ul><li>멀티스레딩 또는 멀티프로세싱</li><li>큐나 채널을 통한 필터 간 통신</li><li>병렬 처리를 통한 성능 향상</li></ul><p><strong>목적:</strong> 고성능 실시간 데이터 처리</p><p><strong>실제 예시:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16>16</a>
</span><span class=lnt id=hl-5-17><a class=lnlinks href=#hl-5-17>17</a>
</span><span class=lnt id=hl-5-18><a class=lnlinks href=#hl-5-18>18</a>
</span><span class=lnt id=hl-5-19><a class=lnlinks href=#hl-5-19>19</a>
</span><span class=lnt id=hl-5-20><a class=lnlinks href=#hl-5-20>20</a>
</span><span class=lnt id=hl-5-21><a class=lnlinks href=#hl-5-21>21</a>
</span><span class=lnt id=hl-5-22><a class=lnlinks href=#hl-5-22>22</a>
</span><span class=lnt id=hl-5-23><a class=lnlinks href=#hl-5-23>23</a>
</span><span class=lnt id=hl-5-24><a class=lnlinks href=#hl-5-24>24</a>
</span><span class=lnt id=hl-5-25><a class=lnlinks href=#hl-5-25>25</a>
</span><span class=lnt id=hl-5-26><a class=lnlinks href=#hl-5-26>26</a>
</span><span class=lnt id=hl-5-27><a class=lnlinks href=#hl-5-27>27</a>
</span><span class=lnt id=hl-5-28><a class=lnlinks href=#hl-5-28>28</a>
</span><span class=lnt id=hl-5-29><a class=lnlinks href=#hl-5-29>29</a>
</span><span class=lnt id=hl-5-30><a class=lnlinks href=#hl-5-30>30</a>
</span><span class=lnt id=hl-5-31><a class=lnlinks href=#hl-5-31>31</a>
</span><span class=lnt id=hl-5-32><a class=lnlinks href=#hl-5-32>32</a>
</span><span class=lnt id=hl-5-33><a class=lnlinks href=#hl-5-33>33</a>
</span><span class=lnt id=hl-5-34><a class=lnlinks href=#hl-5-34>34</a>
</span><span class=lnt id=hl-5-35><a class=lnlinks href=#hl-5-35>35</a>
</span><span class=lnt id=hl-5-36><a class=lnlinks href=#hl-5-36>36</a>
</span><span class=lnt id=hl-5-37><a class=lnlinks href=#hl-5-37>37</a>
</span><span class=lnt id=hl-5-38><a class=lnlinks href=#hl-5-38>38</a>
</span><span class=lnt id=hl-5-39><a class=lnlinks href=#hl-5-39>39</a>
</span><span class=lnt id=hl-5-40><a class=lnlinks href=#hl-5-40>40</a>
</span><span class=lnt id=hl-5-41><a class=lnlinks href=#hl-5-41>41</a>
</span><span class=lnt id=hl-5-42><a class=lnlinks href=#hl-5-42>42</a>
</span><span class=lnt id=hl-5-43><a class=lnlinks href=#hl-5-43>43</a>
</span><span class=lnt id=hl-5-44><a class=lnlinks href=#hl-5-44>44</a>
</span><span class=lnt id=hl-5-45><a class=lnlinks href=#hl-5-45>45</a>
</span><span class=lnt id=hl-5-46><a class=lnlinks href=#hl-5-46>46</a>
</span><span class=lnt id=hl-5-47><a class=lnlinks href=#hl-5-47>47</a>
</span><span class=lnt id=hl-5-48><a class=lnlinks href=#hl-5-48>48</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>asyncio</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>queue</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>threading</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AsyncPipeline</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>filters</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>queues</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_filter</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>filter_func</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>filter_func</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>queues</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>queue</span><span class=o>.</span><span class=n>Queue</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>worker</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>filter_func</span><span class=p>,</span> <span class=n>input_queue</span><span class=p>,</span> <span class=n>output_queue</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>data</span> <span class=o>=</span> <span class=n>input_queue</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>timeout</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>data</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>  <span class=c1># 종료 신호</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span>
</span></span><span class=line><span class=cl>                <span class=n>result</span> <span class=o>=</span> <span class=n>filter_func</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>output_queue</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>output_queue</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>input_queue</span><span class=o>.</span><span class=n>task_done</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=n>queue</span><span class=o>.</span><span class=n>Empty</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>execute_async</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data_stream</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 워커 스레드 시작</span>
</span></span><span class=line><span class=cl>        <span class=n>threads</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>filter_func</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>input_queue</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>queues</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>output_queue</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>queues</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=k>if</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>queues</span><span class=p>)</span> <span class=k>else</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>thread</span> <span class=o>=</span> <span class=n>threading</span><span class=o>.</span><span class=n>Thread</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>target</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>worker</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                <span class=n>args</span><span class=o>=</span><span class=p>(</span><span class=n>filter_func</span><span class=p>,</span> <span class=n>input_queue</span><span class=p>,</span> <span class=n>output_queue</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>thread</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>threads</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>thread</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 데이터 입력</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>data_stream</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>queues</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 스레드 종료</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>thread</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>threads</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>queues</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>thread</span><span class=o>.</span><span class=n>join</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=스트림-기반-파이프라인-stream-based-pipeline>스트림 기반 파이프라인 (Stream-based Pipeline)<a hidden class=anchor aria-hidden=true href=#스트림-기반-파이프라인-stream-based-pipeline>#</a></h4><p><strong>정의:</strong> 연속적인 데이터 스트림을 처리하는 구현 방식</p><p><strong>구성:</strong></p><ul><li>무한 데이터 스트림 처리</li><li>백프레셔 (Backpressure) 처리</li><li>윈도우 기반 집계 및 처리</li></ul><p><strong>목적:</strong> 실시간 스트림 데이터 처리</p><p><strong>실제 예시:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14>14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15>15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16>16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17>17</a>
</span><span class=lnt id=hl-6-18><a class=lnlinks href=#hl-6-18>18</a>
</span><span class=lnt id=hl-6-19><a class=lnlinks href=#hl-6-19>19</a>
</span><span class=lnt id=hl-6-20><a class=lnlinks href=#hl-6-20>20</a>
</span><span class=lnt id=hl-6-21><a class=lnlinks href=#hl-6-21>21</a>
</span><span class=lnt id=hl-6-22><a class=lnlinks href=#hl-6-22>22</a>
</span><span class=lnt id=hl-6-23><a class=lnlinks href=#hl-6-23>23</a>
</span><span class=lnt id=hl-6-24><a class=lnlinks href=#hl-6-24>24</a>
</span><span class=lnt id=hl-6-25><a class=lnlinks href=#hl-6-25>25</a>
</span><span class=lnt id=hl-6-26><a class=lnlinks href=#hl-6-26>26</a>
</span><span class=lnt id=hl-6-27><a class=lnlinks href=#hl-6-27>27</a>
</span><span class=lnt id=hl-6-28><a class=lnlinks href=#hl-6-28>28</a>
</span><span class=lnt id=hl-6-29><a class=lnlinks href=#hl-6-29>29</a>
</span><span class=lnt id=hl-6-30><a class=lnlinks href=#hl-6-30>30</a>
</span><span class=lnt id=hl-6-31><a class=lnlinks href=#hl-6-31>31</a>
</span><span class=lnt id=hl-6-32><a class=lnlinks href=#hl-6-32>32</a>
</span><span class=lnt id=hl-6-33><a class=lnlinks href=#hl-6-33>33</a>
</span><span class=lnt id=hl-6-34><a class=lnlinks href=#hl-6-34>34</a>
</span><span class=lnt id=hl-6-35><a class=lnlinks href=#hl-6-35>35</a>
</span><span class=lnt id=hl-6-36><a class=lnlinks href=#hl-6-36>36</a>
</span><span class=lnt id=hl-6-37><a class=lnlinks href=#hl-6-37>37</a>
</span><span class=lnt id=hl-6-38><a class=lnlinks href=#hl-6-38>38</a>
</span><span class=lnt id=hl-6-39><a class=lnlinks href=#hl-6-39>39</a>
</span><span class=lnt id=hl-6-40><a class=lnlinks href=#hl-6-40>40</a>
</span><span class=lnt id=hl-6-41><a class=lnlinks href=#hl-6-41>41</a>
</span><span class=lnt id=hl-6-42><a class=lnlinks href=#hl-6-42>42</a>
</span><span class=lnt id=hl-6-43><a class=lnlinks href=#hl-6-43>43</a>
</span><span class=lnt id=hl-6-44><a class=lnlinks href=#hl-6-44>44</a>
</span><span class=lnt id=hl-6-45><a class=lnlinks href=#hl-6-45>45</a>
</span><span class=lnt id=hl-6-46><a class=lnlinks href=#hl-6-46>46</a>
</span><span class=lnt id=hl-6-47><a class=lnlinks href=#hl-6-47>47</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Node.js 스트림 기반 파이프라인
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=p>{</span> <span class=nx>Transform</span><span class=p>,</span> <span class=nx>Readable</span><span class=p>,</span> <span class=nx>Writable</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;stream&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>class</span> <span class=nx>UpperCaseFilter</span> <span class=kr>extends</span> <span class=nx>Transform</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>_transform</span><span class=p>(</span><span class=nx>chunk</span><span class=p>,</span> <span class=nx>encoding</span><span class=p>,</span> <span class=nx>callback</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 데이터를 대문자로 변환
</span></span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>chunk</span><span class=p>.</span><span class=nx>toString</span><span class=p>().</span><span class=nx>toUpperCase</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=nx>callback</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>class</span> <span class=nx>WordCountFilter</span> <span class=kr>extends</span> <span class=nx>Transform</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>constructor</span><span class=p>(</span><span class=nx>options</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>super</span><span class=p>(</span><span class=nx>options</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>wordCount</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>_transform</span><span class=p>(</span><span class=nx>chunk</span><span class=p>,</span> <span class=nx>encoding</span><span class=p>,</span> <span class=nx>callback</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 단어 수 계산
</span></span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>words</span> <span class=o>=</span> <span class=nx>chunk</span><span class=p>.</span><span class=nx>toString</span><span class=p>().</span><span class=nx>split</span><span class=p>(</span><span class=sr>/\s+/</span><span class=p>).</span><span class=nx>filter</span><span class=p>(</span><span class=nx>w</span> <span class=p>=&gt;</span> <span class=nx>w</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>wordCount</span> <span class=o>+=</span> <span class=nx>words</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=sb>`Words: </span><span class=si>${</span><span class=k>this</span><span class=p>.</span><span class=nx>wordCount</span><span class=si>}</span><span class=sb>\n`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>callback</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 파이프라인 구성
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>inputStream</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Readable</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>read</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;hello world\n&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s1>&#39;pipe and filter\n&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span> <span class=c1>// 스트림 종료
</span></span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>outputStream</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Writable</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>write</span><span class=p>(</span><span class=nx>chunk</span><span class=p>,</span> <span class=nx>encoding</span><span class=p>,</span> <span class=nx>callback</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Output:&#39;</span><span class=p>,</span> <span class=nx>chunk</span><span class=p>.</span><span class=nx>toString</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=nx>callback</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 파이프라인 실행
</span></span></span><span class=line><span class=cl><span class=nx>inputStream</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>pipe</span><span class=p>(</span><span class=k>new</span> <span class=nx>UpperCaseFilter</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>pipe</span><span class=p>(</span><span class=k>new</span> <span class=nx>WordCountFilter</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>pipe</span><span class=p>(</span><span class=nx>outputStream</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=이벤트-기반-파이프라인-event-driven-pipeline>이벤트 기반 파이프라인 (Event-driven Pipeline)<a hidden class=anchor aria-hidden=true href=#이벤트-기반-파이프라인-event-driven-pipeline>#</a></h4><p><strong>정의:</strong> 이벤트 발생에 따라 필터가 활성화되는 구현 방식</p><p><strong>구성:</strong></p><ul><li>이벤트 버스 또는 메시지 브로커 활용</li><li>느슨한 결합의 필터 컴포넌트</li><li>동적 파이프라인 구성</li></ul><p><strong>목적:</strong> 유연하고 확장 가능한 이벤트 처리</p><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>1. 설계적 장점</strong></td><td><strong>모듈성 (Modularity)</strong></td><td>각 필터는 단일 책임을 갖는 독립 모듈로 구성되어 변경에 유연하고, 유지보수에 강함</td></tr><tr><td></td><td><strong>재사용성 (Reusability)</strong></td><td>범용적으로 설계된 필터는 다양한 파이프라인에서 재활용 가능하며, 라이브러리화가 용이함</td></tr><tr><td></td><td><strong>유연성 (Flexibility)</strong></td><td>필터 순서 변경, 조건 분기, 동적 구성 등을 통해 다양한 흐름 구성 가능</td></tr><tr><td></td><td><strong>조합성 (Composability)</strong></td><td>필터를 조합하여 복잡한 기능을 단순한 단계로 구성할 수 있음</td></tr><tr><td><strong>2. 운영/개발 편의성</strong></td><td><strong>테스트 용이성 (Testability)</strong></td><td>각 필터 단위로 독립 테스트가 가능하며, 입출력 명확성 덕분에 유닛 테스트가 쉬움</td></tr><tr><td></td><td><strong>디버깅 편의성</strong></td><td>필터 간 경계에서 중간 데이터를 확인할 수 있어 문제 추적이 쉬움</td></tr><tr><td></td><td><strong>독립 배포 (Deployability)</strong></td><td>필터를 컨테이너 등으로 독립 배포해 장애를 격리하고 점진적 릴리즈 가능</td></tr><tr><td><strong>3. 확장성과 유연성</strong></td><td><strong>확장성 (Scalability)</strong></td><td>Stateless 한 필터는 수평 확장이 용이하고, 병렬 파이프라인 구성에도 적합</td></tr><tr><td></td><td><strong>분산 처리 (Distributed Processing)</strong></td><td>각 필터를 서로 다른 노드에 분산 배치해 확장성과 복원력을 향상시킬 수 있음</td></tr><tr><td></td><td><strong>동적 라우팅/구성 가능성</strong></td><td>Dispatcher 혹은 조건 기반 분기로 필터 실행 흐름을 유연하게 구성 가능</td></tr><tr><td><strong>4. 성능 최적화</strong></td><td><strong>병렬 처리 (Parallelism)</strong></td><td>필터가 독립적으로 실행되어 병렬 처리 가능, Throughput 을 높이기 쉬움</td></tr><tr><td></td><td><strong>리소스 분리 및 격리</strong></td><td>각 필터는 독립 실행이 가능하여 자원 할당/격리가 용이하며 성능 이슈를 국소화할 수 있음</td></tr><tr><td></td><td><strong>데이터 흐름 가시화</strong></td><td>파이프라인이 시각화되어 설계 구조의 명확성과 운영 추적성이 향상됨</td></tr></tbody></table><h3 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결 방안 및 전략</th></tr></thead><tbody><tr><td>설계적 한계</td><td><strong>복잡성 증가</strong></td><td>필터 수가 많아질수록 전체 시스템의 흐름 파악과 테스트, 변경이 어려워짐</td><td>필터 그룹화, 표준 인터페이스 정의, 구성 자동화</td></tr><tr><td>성능</td><td><strong>성능 오버헤드</strong></td><td>필터 간 데이터 복사, 직렬화/역직렬화, 파이프 I/O 등으로 인한 성능 저하</td><td>Zero-Copy, 병렬 처리, 로컬 캐싱, 배치 처리</td></tr><tr><td>상태 관리</td><td><strong>전역 상태 공유 제한</strong></td><td>각 필터는 Stateless 하게 설계되므로 복잡한 상태 공유 또는 흐름 기반 알고리즘 구현이 어려움</td><td>외부 상태 저장소 사용 (Redis 등), 컨텍스트 전달 구조 적용</td></tr><tr><td>유지보수</td><td><strong>디버깅 어려움</strong></td><td>분산된 필터 환경에서 장애 추적 및 중간 데이터 확인이 어려움</td><td>통합 로깅, 분산 추적 시스템 (OpenTelemetry, Zipkin)</td></tr><tr><td>형식 일관성</td><td><strong>데이터 포맷 제한</strong></td><td>필터 간 데이터 포맷 불일치 시 오류 발생 가능성 높음</td><td>Avro/Protobuf 등 표준 스키마 적용, 어댑터 필터 도입</td></tr><tr><td>테스트</td><td><strong>제어 흐름 제한</strong></td><td>조건 분기, 반복 등 복잡한 로직 구현이 제한적</td><td>조건 필터, 라우터/분기 필터, 루프백 필터 설계</td></tr><tr><td>운영</td><td><strong>높은 지연 (Latency)</strong></td><td>필터 수가 많아질수록 동기 흐름에서 누적 지연 발생 가능</td><td>비동기 처리, 경량 필터 분할, 병렬 처리 구조 설계</td></tr></tbody></table><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th>구분</th><th>문제 항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방안</th><th>해결 방안 및 기법</th></tr></thead><tbody><tr><td>성능</td><td><strong>병목 필터</strong></td><td>특정 필터 처리 성능 저하</td><td>전체 처리 속도 감소</td><td>Prometheus/Grafana 지표, 단계별 처리 시간 추적</td><td>병렬 처리, 필터 분리</td><td>필터 병렬화, 캐시 적용</td></tr><tr><td>신뢰성</td><td><strong>데이터 손실</strong></td><td>파이프 버퍼 오버플로우, 필터 장애</td><td>데이터 유실, 결과 불일치</td><td>로그 분석, 재시도 횟수 모니터링</td><td>버퍼 크기 조정, 신뢰성 높은 큐 사용</td><td>트랜잭션 처리, 재처리 메커니즘, WAL 적용</td></tr><tr><td>안정성</td><td><strong>백프레셔 (Backpressure)</strong></td><td>다운스트림 필터의 느린 처리 속도</td><td>시스템 과부하, 메모리 고갈</td><td>큐 길이 모니터링, 처리량 측정</td><td>적응형 버퍼, 처리량 기반 Throttle 설정</td><td>플로우 제어, Drop 정책, 버퍼 리사이징</td></tr><tr><td>통신</td><td><strong>포맷 불일치</strong></td><td>필터 간 데이터 스키마 불일치</td><td>필터 간 통신 오류</td><td>계약 기반 테스트, 포맷 검증 로직</td><td>Typed Pipe, 스키마 레지스트리</td><td>데이터 변환 필터, Adaptor 도입</td></tr><tr><td>안정성</td><td><strong>오류 전파 부족</strong></td><td>필터 간 느슨한 결합 구조로 오류 감지가 어렵고 전파되지 않음</td><td>시스템 오류 탐지 실패</td><td>Error Logging, Dead Letter Queue 설정</td><td>필터별 오류 처리, Retry/Circuit Breaker</td><td>재시도 정책, DLQ 격리</td></tr><tr><td>일관성</td><td><strong>순서 보장 실패</strong></td><td>병렬 처리나 비동기 흐름에서 메시지 순서가 어긋남</td><td>결과 불일치, 동기화 오류 발생</td><td>메시지 ID 추적, Sequence Log</td><td>Ordered Queue, 파티셔닝 설계</td><td>Reorder Buffer, 순서 복원 로직</td></tr><tr><td>안정성</td><td><strong>데드락</strong></td><td>순환 대기, 자원 고갈 등으로 필터 간 상호 대기 발생</td><td>전체 파이프라인 정지</td><td>스레드/버퍼 상태 모니터링</td><td>자원 우선순위 지정, 타임아웃 설정</td><td>데드락 탐지 알고리즘, 자원 순서화</td></tr><tr><td>확장성</td><td><strong>지연 누적</strong></td><td>각 필터의 처리 지연이 누적되어 전체 응답 시간 증가</td><td>실시간 요구 미충족, 성능 SLA 위반</td><td>엔드투엔드 타이밍 측정</td><td>병렬 처리 구조 설계, 캐싱 전략 적용</td><td>필터 재구성, 사전 처리 (Preprocessing) 도입</td></tr></tbody></table><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>항목</strong></th><th><strong>원인</strong></th><th><strong>영향</strong></th><th><strong>대응 전략</strong></th></tr></thead><tbody><tr><td><strong>1. 성능 및 확장성</strong></td><td>병목 현상 (Bottleneck)</td><td>필터 간 처리 속도 불균형, 단일 필터 과부하</td><td>처리량 감소, 지연 증가, 자원 낭비</td><td>병렬 필터 배치, 부하 테스트, 필터 분리 또는 로드밸런싱</td></tr><tr><td></td><td>멀티스테이지 오버헤드</td><td>파이프라인 단계 증가로 인한 컨텍스트 스위칭 및 전송 비용</td><td>실시간 요구 미충족, 성능 저하</td><td>Filter Fusion, 캐시 최적화, 단계를 축소한 재설계</td></tr><tr><td></td><td>메모리 누수</td><td>장기 실행 필터에서 해제 누락, GC 미흡</td><td>시스템 자원 고갈, 크래시 위험</td><td>메모리 풀 도입, 프로파일링 도구 사용, 리소스 해제 자동화</td></tr><tr><td></td><td>상태 기반 확장성 제약</td><td>필터 내부 상태 유지 (Stateful)</td><td>수평 확장 제한, 상태 불일치 위험</td><td>외부 상태 저장소 (예: Redis, DB) 분리 및 스냅샷 주기화</td></tr><tr><td><strong>2. 안정성 및 복구력</strong></td><td>데이터 정합성 오류</td><td>비동기 처리 중 순서 변경, 중복 처리, 실패 전파</td><td>데이터 손상, 로직 오류 발생</td><td>Exactly-once 처리 보장, 메시지 순서화 (Ordered Queue), 이벤트 소싱 도입</td></tr><tr><td></td><td>상태 유실</td><td>시스템 재시작, 필터 충돌 시 휘발성 메모리 상태 소실</td><td>데이터 손실, 재처리 불가</td><td>외부 상태 저장소, Checkpoint, Drain & Replay 전략 적용</td></tr><tr><td></td><td>흐름 중단</td><td>필터 단일 장애 발생 시 전체 파이프라인 정지</td><td>전체 서비스 중단, 복구 시간 증가</td><td>Circuit Breaker, Retry + Fallback, 필터별 독립 실행 환경</td></tr><tr><td></td><td>네트워크/노드 장애</td><td>클러스터 내 통신 실패, 서비스 장애</td><td>중단, 일시적 비가용 상태</td><td>자동 재시작, 서비스 메시 (Canary Routing), 장애 허용 설계</td></tr><tr><td><strong>3. 관찰성 및 모니터링</strong></td><td>로그 분산 및 추적 불가</td><td>필터 간 모듈화로 로그가 여러 위치에 존재, 상관관계 파악 어려움</td><td>원인 분석 지연, 문제 해결 시간 증가</td><td>중앙 집중 로깅 (ELK, Loki), 분산 트레이싱 (OpenTelemetry, Zipkin)</td></tr><tr><td></td><td>실시간 모니터링 미비</td><td>메트릭 노출 미흡, 지표 수집 구조 없음</td><td>성능 이상 탐지 지연, SLA 위반</td><td>표준화된 메트릭 (Prometheus), 대시보드 구성 (Grafana), 경고 시스템</td></tr><tr><td></td><td>복잡도 증가로 시각화 어려움</td><td>필터 수 증가, 구조 복잡화</td><td>구조 파악 곤란, 유지보수 어려움</td><td>파이프라인 다이어그램 자동 생성, 의존성 그래프 도구 도입</td></tr><tr><td><strong>4. 구성 및 배포 관리</strong></td><td>필터 버전 불일치</td><td>독립 배포로 인한 스키마/계약 불일치</td><td>다운스트림 오류, 데이터 손상</td><td>API 계약 기반 개발, JSON Schema/Avro 사용, Schema Registry 연동</td></tr><tr><td></td><td>설정 일관성 부족</td><td>필터 구성/환경 변수 누락</td><td>파이프라인 오작동, 디버깅 어려움</td><td>공통 구성 템플릿화, CI/CD 환경변수 검증 자동화</td></tr><tr><td></td><td>배포 복잡성</td><td>필터 수 증가로 Helm/K8s manifest 증가</td><td>관리 포인트 증가, 오류 가능성 상승</td><td>GitOps 기반 배포 자동화, 필터 템플릿 통합</td></tr><tr><td><strong>5. 동적 구성 대응성</strong></td><td>실시간 필터 추가/제거 제한</td><td>정적 설정 기반 파이프라인 설계</td><td>유연성 부족, 빠른 대응 불가</td><td>동적 구성 가능 엔진 (NiFi, Spring Cloud Data Flow), 런타임 재구성 API 도입</td></tr><tr><td></td><td>파이프라인 단계 간 강한 결합성</td><td>출력 - 입력 간 인터페이스 강결합</td><td>변경 시 전체 영향, 반복 배포 필요</td><td>이벤트 기반 구조 (Pub/Sub), 메시지 포맷 표준화 (e.g., Avro + Schema Evolution)</td></tr><tr><td><strong>6. 데이터 처리 특수성</strong></td><td>무한 스트림 처리 시 지연 관리</td><td>처리량 증가에 따른 메모리 증가, backpressure 대응 미흡</td><td>처리 중단, 데이터 유실 위험</td><td>윈도우 기반 집계, Watermark 설계, Kafka/Flink 기반 backpressure 지원</td></tr><tr><td></td><td>데이터 포맷 불일치</td><td>이기종 시스템 간 포맷 차이, encoding 문제</td><td>파싱 실패, 필터 작동 불가</td><td>포맷 표준화 (JSON/Avro/Parquet), 포맷 변환 필터 삽입</td></tr></tbody></table><h3 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th><strong>분류 기준</strong></th><th><strong>유형</strong></th><th><strong>설명</strong></th><th><strong>적용 사례</strong></th></tr></thead><tbody><tr><td><strong>1. 데이터 흐름 방식</strong></td><td>선형 파이프라인 (Linear)</td><td>필터가 일방향으로 순차적으로 연결되어 데이터가 흐름</td><td>ETL 처리, 컴파일러</td></tr><tr><td></td><td>분기 파이프라인 (Branching)</td><td>특정 조건이나 흐름에 따라 여러 필터로 분기됨</td><td>라우팅 기반 데이터 흐름</td></tr><tr><td></td><td>병합 파이프라인 (Merging)</td><td>여러 입력을 하나로 통합하여 후속 필터에 전달</td><td>로그 집계, 데이터 통합</td></tr><tr><td></td><td>피드백 루프 (Feedback Loop)</td><td>결과를 초기 필터로 다시 전달하는 구조, 반복 처리를 위한 설계</td><td>머신러닝 재학습, 정제 반복처리 구조</td></tr><tr><td><strong>2. 실행 방식</strong></td><td>동기식 (Synchronous)</td><td>순차적으로 처리되며 각 필터는 이전 필터의 완료를 기다림</td><td>전통적 Unix 파이프라인</td></tr><tr><td></td><td>비동기식 (Asynchronous)</td><td>각 필터가 독립적으로 병렬 실행되며, 큐 또는 채널을 통해 데이터 전달</td><td>Kafka + Flink 기반 처리</td></tr><tr><td></td><td>하이브리드 (Hybrid)</td><td>일부 필터는 동기, 일부는 비동기로 구성된 복합 구조</td><td>이벤트 기반 워크플로우</td></tr><tr><td><strong>3. 상태 관리 방식</strong></td><td>Stateless Filter</td><td>상태를 저장하지 않고 입력만으로 처리, 재시작 및 병렬 처리에 유리</td><td>단순 필터링, 변환</td></tr><tr><td></td><td>Stateful Filter</td><td>내부 상태 (세션, 누적값 등) 를 유지하며 처리, 외부 상태 저장소 필요</td><td>집계, 세션 관리, 윈도우 기반 연산</td></tr><tr><td><strong>4. 데이터 처리 단위</strong></td><td>배치 기반 (Batch-oriented)</td><td>일정 단위로 데이터를 모아서 일괄 처리</td><td>일일 통계, 보고서 생성</td></tr><tr><td></td><td>스트림 기반 (Stream-oriented)</td><td>데이터가 발생할 때마다 즉시 처리 (low-latency)</td><td>실시간 모니터링, IoT</td></tr><tr><td></td><td>이벤트 기반 (Event-driven)</td><td>비동기 이벤트 발생 시 필터가 트리거됨</td><td>CEP, 실시간 알림 시스템</td></tr><tr><td><strong>5. 파이프 연결 구조</strong></td><td>단방향 (One-way)</td><td>입력 → 출력으로만 흐름이 존재하며 단방향 전파</td><td>대부분의 ETL 파이프라인</td></tr><tr><td></td><td>양방향 (Two-way)</td><td>제어 신호 혹은 응답이 반대 방향으로도 흐를 수 있음</td><td>제어 피드백 기반 시스템</td></tr><tr><td></td><td>Push 기반</td><td>데이터 생산자가 즉시 데이터를 다음 필터로 전달</td><td>Kafka Producer → Consumer 구조</td></tr><tr><td></td><td>Pull 기반</td><td>소비자가 필요할 때 상위 필터로부터 데이터를 요청</td><td>Flow Control 기반 처리 구조</td></tr><tr><td><strong>6. 필터 활성화 모델</strong></td><td>Active Filter</td><td>필터가 자체적으로 데이터를 가져오고 처리</td><td>Kafka Consumer Worker 구조</td></tr><tr><td></td><td>Passive Filter</td><td>외부 트리거나 파이프가 데이터를 전달해줄 때만 처리</td><td>파이프 지향 모델</td></tr><tr><td><strong>7. 배포 및 실행 모델</strong></td><td>모놀리식 구조 (Monolithic)</td><td>단일 프로세스 내에 모든 필터 포함, 간단하지만 유연성 부족</td><td>내장형 로컬 파이프라인</td></tr><tr><td></td><td>분산 시스템 구조 (Distributed)</td><td>각 필터가 독립 노드 또는 컨테이너에서 실행, 스케일링 및 장애 격리에 유리</td><td>Kafka + Flink 클러스터</td></tr><tr><td></td><td>마이크로서비스 구조 (Microservice)</td><td>각 필터를 개별 마이크로서비스로 배포하여 유연성과 확장성 강화</td><td>Kubernetes 기반 이벤트 파이프라인</td></tr><tr><td><strong>8. 구현 방식</strong></td><td>소프트웨어 기반</td><td>프로그래밍 언어의 스트림 처리 API 혹은 메시지 기반 미들웨어 활용</td><td>Java Stream, Node.js Stream</td></tr><tr><td></td><td>하드웨어 기반</td><td>CPU/GPU 등에서의 물리적 연산 파이프 구조 사용</td><td>CPU 파이프라인, 디지털 신호 처리기 DSP</td></tr></tbody></table><h4 id=아키텍처-패턴-유형>아키텍처 패턴 유형<a hidden class=anchor aria-hidden=true href=#아키텍처-패턴-유형>#</a></h4><p><strong>선형 파이프라인 (Linear Pipeline)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>graph LR
</span></span><span class=line><span class=cl>    A[Source] --&gt; B[Filter1] --&gt; C[Filter2] --&gt; D[Filter3] --&gt; E[Sink]
</span></span></code></pre></td></tr></table></div></div><p><strong>분기 파이프라인 (Branching Pipeline)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6>6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>graph TD
</span></span><span class=line><span class=cl>    A[Source] --&gt; B[Splitter]
</span></span><span class=line><span class=cl>    B --&gt; C[Filter1]
</span></span><span class=line><span class=cl>    B --&gt; D[Filter2]
</span></span><span class=line><span class=cl>    C --&gt; E[Aggregator]
</span></span><span class=line><span class=cl>    D --&gt; E
</span></span><span class=line><span class=cl>    E --&gt; F[Sink]
</span></span></code></pre></td></tr></table></div></div><p><strong>복합 파이프라인 (Complex Pipeline)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3>3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4>4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5>5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6>6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7>7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8>8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>graph TD
</span></span><span class=line><span class=cl>    A[Source1] --&gt; C[Filter1]
</span></span><span class=line><span class=cl>    B[Source2] --&gt; C
</span></span><span class=line><span class=cl>    C --&gt; D{Router}
</span></span><span class=line><span class=cl>    D --&gt; E[Filter2]
</span></span><span class=line><span class=cl>    D --&gt; F[Filter3]
</span></span><span class=line><span class=cl>    E --&gt; G[Aggregator]
</span></span><span class=line><span class=cl>    F --&gt; G
</span></span><span class=line><span class=cl>    G --&gt; H[Sink]
</span></span></code></pre></td></tr></table></div></div><h3 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h3><table><thead><tr><th><strong>도메인</strong></th><th><strong>활용 목적</strong></th><th><strong>기술 및 구성 요소</strong></th><th><strong>핵심 효과</strong></th></tr></thead><tbody><tr><td><strong>ETL / 데이터 파이프라인</strong></td><td>데이터 수집, 정제, 집계, 적재</td><td>Apache NiFi, Apache Flink, Spark, Spring Cloud Data Flow, Talend</td><td>유연한 구성, 코드 재사용성 ↑, 처리 시간 단축, 대용량 처리 최적화</td></tr><tr><td><strong>로그 처리 / 보안 분석</strong></td><td>실시간 로그 필터링, 정제, 이상 탐지</td><td>Kafka, Flink, ELK Stack, Splunk, Promtail, Fluent Bit</td><td>실시간 처리, 보안 강화, 로그 통합 및 알림 기반 대응</td></tr><tr><td><strong>스트리밍 분석 / 실시간 처리</strong></td><td>실시간 이벤트 흐름 분석, 반응형 처리</td><td>Kafka, Storm, Flink, Apache Pulsar, InfluxDB, MQTT</td><td>저지연 인사이트, 상태 기반 알림, IoT/센서 기반 분석 지원</td></tr><tr><td><strong>컴파일러 / 코드 변환</strong></td><td>소스코드 분석, 변환, 최적화</td><td>GCC, LLVM, Lexer → Parser → IR Optimizer → Code Generator</td><td>코드 유지보수 용이, 다중 타겟 지원, 구조적 최적화</td></tr><tr><td><strong>이미지/비디오 처리</strong></td><td>미디어 인코딩, 리사이징, 필터 효과 적용</td><td>FFmpeg, GStreamer, ImageMagick, OpenCV</td><td>자동화된 처리, 실시간 스트림 적용, 품질 보정 및 압축 최적화</td></tr><tr><td><strong>웹 애플리케이션</strong></td><td>HTTP 요청 흐름 전처리 및 후처리</td><td>FastAPI Middleware, Express.js, ASP.NET Core 미들웨어 체인</td><td>요청별 모듈화 구성, 보안 처리 분리, 유지보수 효율화</td></tr><tr><td><strong>IoT 시스템</strong></td><td>센서 데이터 수집 → 필터링 → 트리거 실행</td><td>MQTT, Apache NiFi, AWS IoT Core, InfluxDB</td><td>이벤트 기반 경고 시스템, 실시간 분석, 엣지 연산 구성 가능</td></tr><tr><td><strong>Unix/Linux Shell</strong></td><td>텍스트 기반 데이터 흐름 처리</td><td><code>cat</code>, <code>grep</code>, <code>awk</code>, <code>sort</code>, <code>uniq</code> 등의 Unix 파이프 조합</td><td>스크립트화 통한 자동화, 복잡한 처리 간소화, 데이터 전처리 간편화</td></tr></tbody></table><h4 id=기술-흐름별-파이프라인-구성-예시>기술 흐름별 파이프라인 구성 예시<a hidden class=anchor aria-hidden=true href=#기술-흐름별-파이프라인-구성-예시>#</a></h4><table><thead><tr><th><strong>파이프라인 유형</strong></th><th><strong>구성 단계 (예시)</strong></th></tr></thead><tbody><tr><td><strong>ETL 파이프라인</strong></td><td>Extractor → Transformer → Validator → Loader</td></tr><tr><td><strong>로그 처리 파이프라인</strong></td><td>Log Collector → Filter → Enricher → Aggregator → Storage</td></tr><tr><td><strong>스트리밍 분석 파이프라인</strong></td><td>Producer → Processor (e.g., Windowing) → Alert Generator → Notifier</td></tr><tr><td><strong>미디어 처리 파이프라인</strong></td><td>Decoder → Filter (Noise Reduction) → Transcoder → Stream Output</td></tr><tr><td><strong>컴파일러 파이프라인</strong></td><td>Lexer → Parser → IR Generator → Optimizer → Code Generator</td></tr><tr><td><strong>웹 요청 처리 파이프라인</strong></td><td>Parser → Auth Middleware → Routing → Business Logic Handler → Response Formatter</td></tr><tr><td><strong>이미지 처리 파이프라인</strong></td><td>Capture → Resize → Color Correct → Filter → Store/Display</td></tr><tr><td><strong>보안 분석 파이프라인</strong></td><td>Packet Capture → Protocol Parser → Threat Analyzer → Alert System → Audit Log</td></tr></tbody></table><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><h4 id=사례-1-영상-처리-파이프라인-ffmpeg-기반>사례 1: 영상 처리 파이프라인 (FFmpeg 기반)<a hidden class=anchor aria-hidden=true href=#사례-1-영상-처리-파이프라인-ffmpeg-기반>#</a></h4><p><strong>구성도</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1>1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2>2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3>3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4>4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5>5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6>6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>graph LR
</span></span><span class=line><span class=cl>    I[Input Video] --&gt; D1[Decode Filter]
</span></span><span class=line><span class=cl>    D1 --&gt; F1[Filter: Crop]
</span></span><span class=line><span class=cl>    F1 --&gt; F2[Filter: Scale]
</span></span><span class=line><span class=cl>    F2 --&gt; F3[Filter: Overlay Watermark]
</span></span><span class=line><span class=cl>    F3 --&gt; E1[Encode Filter]
</span></span><span class=line><span class=cl>    E1 --&gt; O[Output File]
</span></span></code></pre></td></tr></table></div></div><ul><li>입력된 영상은 디코딩 후 Crop, Scale, Watermark 필터를 순차적으로 통과</li><li>각 필터는 FFmpeg 의 필터 체인으로 구성됨</li><li>최종 인코딩된 결과가 출력 파일로 저장됨</li></ul><p><strong>Pipe-and-Filter 의 역할</strong>:</p><ul><li>각 처리 단계는 독립적으로 수행되며, 필터 체인 방식으로 구성</li><li>성능 튜닝: 하드웨어 가속 필터 삽입 가능</li><li>병렬 처리로 고해상도 영상도 실시간 처리 가능</li></ul><p><strong>유무 비교</strong></p><table><thead><tr><th>기준</th><th>Pipe-and-Filter 사용</th><th>미사용</th></tr></thead><tbody><tr><td>처리 흐름</td><td>명확한 모듈 분리 및 재사용 가능</td><td>처리 순서 변경 어려움</td></tr><tr><td>확장성</td><td>필터만 추가하면 기능 확장 가능</td><td>전체 시스템 수정 필요</td></tr><tr><td>유지보수</td><td>개별 필터만 테스트 가능</td><td>전체 로직 수정 필요</td></tr></tbody></table><h4 id=사례-2-실시간-주문-처리-시스템>사례 2: 실시간 주문 처리 시스템<a hidden class=anchor aria-hidden=true href=#사례-2-실시간-주문-처리-시스템>#</a></h4><p><strong>시스템 구성</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>graph LR
</span></span><span class=line><span class=cl>    subgraph &#34;Order Processing Pipeline&#34;
</span></span><span class=line><span class=cl>        A[Order Source] --&gt; B[Validation Filter]
</span></span><span class=line><span class=cl>        B --&gt; C[Fraud Detection Filter]
</span></span><span class=line><span class=cl>        C --&gt; D[Inventory Check Filter]
</span></span><span class=line><span class=cl>        D --&gt; E[Payment Processing Filter]
</span></span><span class=line><span class=cl>        E --&gt; F[Notification Filter]
</span></span><span class=line><span class=cl>        F --&gt; G[Order Completion Sink]
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        H[Audit Log] --&gt; B
</span></span><span class=line><span class=cl>        H --&gt; C
</span></span><span class=line><span class=cl>        H --&gt; D
</span></span><span class=line><span class=cl>        H --&gt; E
</span></span><span class=line><span class=cl>        H --&gt; F
</span></span><span class=line><span class=cl>    end
</span></span></code></pre></td></tr></table></div></div><p><strong>시스템 워크플로우</strong>:</p><ol><li><p>주문 수신 (Order Source)</p><ul><li>웹 애플리케이션에서 주문 데이터 수신</li><li>JSON 형식으로 표준화</li><li>초기 메타데이터 추가</li></ul></li><li><p>주문 검증 (Validation Filter)</p><ul><li>필수 필드 존재 여부 확인</li><li>데이터 형식 검증</li><li>비즈니스 규칙 적용</li></ul></li><li><p>사기 탐지 (Fraud Detection Filter)</p><ul><li>머신러닝 모델을 통한 이상 패턴 감지</li><li>블랙리스트 확인</li><li>위험도 점수 계산</li></ul></li><li><p>재고 확인 (Inventory Check Filter)</p><ul><li>실시간 재고 수량 조회</li><li>재고 예약 처리</li><li>배송 가능 여부 판단</li></ul></li><li><p>결제 처리 (Payment Processing Filter)</p><ul><li>결제 게이트웨이 연동</li><li>결제 승인 요청</li><li>결제 결과 처리</li></ul></li><li><p>알림 발송 (Notification Filter)</p><ul><li>고객 알림 메시지 생성</li><li>이메일/SMS 발송</li><li>내부 시스템 알림</li></ul></li></ol><p><strong>Pipe-and-Filter 패턴의 역할</strong>:</p><ul><li><strong>독립성</strong>: 각 필터가 독립적으로 작동하여 하나의 필터 장애가 전체 시스템에 미치는 영향을 최소화</li><li><strong>확장성</strong>: 주문량 증가 시 특정 필터 (예: 결제 처리) 의 인스턴스를 추가하여 병목 현상 해결</li><li><strong>유연성</strong>: 새로운 비즈니스 요구사항 (예: 할인 적용 필터) 추가 시 기존 필터 수정 없이 파이프라인에 삽입</li><li><strong>모니터링</strong>: 각 단계별 처리 시간, 성공률, 오류율을 독립적으로 모니터링</li></ul><p><strong>패턴 유무에 따른 차이점</strong>:</p><ul><li><strong>Pipe-and-Filter 패턴 적용 시:</strong><ul><li>각 처리 단계의 독립적 스케일링 가능</li><li>새로운 검증 로직 추가 시 기존 코드 수정 불필요</li><li>단계별 성능 모니터링 및 최적화 가능</li><li>장애 발생 시 특정 필터만 복구하면 됨</li></ul></li><li><strong>단일 모듈 구조 시:</strong><ul><li>전체 주문 처리 로직이 하나의 서비스에 결합</li><li>특정 기능 수정 시 전체 시스템 재배포 필요</li><li>병목 지점 식별 및 개선 어려움</li><li>장애 시 전체 주문 처리 시스템 중단</li></ul></li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1>  1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2>  2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3>  3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4>  4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5>  5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6>  6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7>  7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8>  8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9>  9</a>
</span><span class=lnt id=hl-12-10><a class=lnlinks href=#hl-12-10> 10</a>
</span><span class=lnt id=hl-12-11><a class=lnlinks href=#hl-12-11> 11</a>
</span><span class=lnt id=hl-12-12><a class=lnlinks href=#hl-12-12> 12</a>
</span><span class=lnt id=hl-12-13><a class=lnlinks href=#hl-12-13> 13</a>
</span><span class=lnt id=hl-12-14><a class=lnlinks href=#hl-12-14> 14</a>
</span><span class=lnt id=hl-12-15><a class=lnlinks href=#hl-12-15> 15</a>
</span><span class=lnt id=hl-12-16><a class=lnlinks href=#hl-12-16> 16</a>
</span><span class=lnt id=hl-12-17><a class=lnlinks href=#hl-12-17> 17</a>
</span><span class=lnt id=hl-12-18><a class=lnlinks href=#hl-12-18> 18</a>
</span><span class=lnt id=hl-12-19><a class=lnlinks href=#hl-12-19> 19</a>
</span><span class=lnt id=hl-12-20><a class=lnlinks href=#hl-12-20> 20</a>
</span><span class=lnt id=hl-12-21><a class=lnlinks href=#hl-12-21> 21</a>
</span><span class=lnt id=hl-12-22><a class=lnlinks href=#hl-12-22> 22</a>
</span><span class=lnt id=hl-12-23><a class=lnlinks href=#hl-12-23> 23</a>
</span><span class=lnt id=hl-12-24><a class=lnlinks href=#hl-12-24> 24</a>
</span><span class=lnt id=hl-12-25><a class=lnlinks href=#hl-12-25> 25</a>
</span><span class=lnt id=hl-12-26><a class=lnlinks href=#hl-12-26> 26</a>
</span><span class=lnt id=hl-12-27><a class=lnlinks href=#hl-12-27> 27</a>
</span><span class=lnt id=hl-12-28><a class=lnlinks href=#hl-12-28> 28</a>
</span><span class=lnt id=hl-12-29><a class=lnlinks href=#hl-12-29> 29</a>
</span><span class=lnt id=hl-12-30><a class=lnlinks href=#hl-12-30> 30</a>
</span><span class=lnt id=hl-12-31><a class=lnlinks href=#hl-12-31> 31</a>
</span><span class=lnt id=hl-12-32><a class=lnlinks href=#hl-12-32> 32</a>
</span><span class=lnt id=hl-12-33><a class=lnlinks href=#hl-12-33> 33</a>
</span><span class=lnt id=hl-12-34><a class=lnlinks href=#hl-12-34> 34</a>
</span><span class=lnt id=hl-12-35><a class=lnlinks href=#hl-12-35> 35</a>
</span><span class=lnt id=hl-12-36><a class=lnlinks href=#hl-12-36> 36</a>
</span><span class=lnt id=hl-12-37><a class=lnlinks href=#hl-12-37> 37</a>
</span><span class=lnt id=hl-12-38><a class=lnlinks href=#hl-12-38> 38</a>
</span><span class=lnt id=hl-12-39><a class=lnlinks href=#hl-12-39> 39</a>
</span><span class=lnt id=hl-12-40><a class=lnlinks href=#hl-12-40> 40</a>
</span><span class=lnt id=hl-12-41><a class=lnlinks href=#hl-12-41> 41</a>
</span><span class=lnt id=hl-12-42><a class=lnlinks href=#hl-12-42> 42</a>
</span><span class=lnt id=hl-12-43><a class=lnlinks href=#hl-12-43> 43</a>
</span><span class=lnt id=hl-12-44><a class=lnlinks href=#hl-12-44> 44</a>
</span><span class=lnt id=hl-12-45><a class=lnlinks href=#hl-12-45> 45</a>
</span><span class=lnt id=hl-12-46><a class=lnlinks href=#hl-12-46> 46</a>
</span><span class=lnt id=hl-12-47><a class=lnlinks href=#hl-12-47> 47</a>
</span><span class=lnt id=hl-12-48><a class=lnlinks href=#hl-12-48> 48</a>
</span><span class=lnt id=hl-12-49><a class=lnlinks href=#hl-12-49> 49</a>
</span><span class=lnt id=hl-12-50><a class=lnlinks href=#hl-12-50> 50</a>
</span><span class=lnt id=hl-12-51><a class=lnlinks href=#hl-12-51> 51</a>
</span><span class=lnt id=hl-12-52><a class=lnlinks href=#hl-12-52> 52</a>
</span><span class=lnt id=hl-12-53><a class=lnlinks href=#hl-12-53> 53</a>
</span><span class=lnt id=hl-12-54><a class=lnlinks href=#hl-12-54> 54</a>
</span><span class=lnt id=hl-12-55><a class=lnlinks href=#hl-12-55> 55</a>
</span><span class=lnt id=hl-12-56><a class=lnlinks href=#hl-12-56> 56</a>
</span><span class=lnt id=hl-12-57><a class=lnlinks href=#hl-12-57> 57</a>
</span><span class=lnt id=hl-12-58><a class=lnlinks href=#hl-12-58> 58</a>
</span><span class=lnt id=hl-12-59><a class=lnlinks href=#hl-12-59> 59</a>
</span><span class=lnt id=hl-12-60><a class=lnlinks href=#hl-12-60> 60</a>
</span><span class=lnt id=hl-12-61><a class=lnlinks href=#hl-12-61> 61</a>
</span><span class=lnt id=hl-12-62><a class=lnlinks href=#hl-12-62> 62</a>
</span><span class=lnt id=hl-12-63><a class=lnlinks href=#hl-12-63> 63</a>
</span><span class=lnt id=hl-12-64><a class=lnlinks href=#hl-12-64> 64</a>
</span><span class=lnt id=hl-12-65><a class=lnlinks href=#hl-12-65> 65</a>
</span><span class=lnt id=hl-12-66><a class=lnlinks href=#hl-12-66> 66</a>
</span><span class=lnt id=hl-12-67><a class=lnlinks href=#hl-12-67> 67</a>
</span><span class=lnt id=hl-12-68><a class=lnlinks href=#hl-12-68> 68</a>
</span><span class=lnt id=hl-12-69><a class=lnlinks href=#hl-12-69> 69</a>
</span><span class=lnt id=hl-12-70><a class=lnlinks href=#hl-12-70> 70</a>
</span><span class=lnt id=hl-12-71><a class=lnlinks href=#hl-12-71> 71</a>
</span><span class=lnt id=hl-12-72><a class=lnlinks href=#hl-12-72> 72</a>
</span><span class=lnt id=hl-12-73><a class=lnlinks href=#hl-12-73> 73</a>
</span><span class=lnt id=hl-12-74><a class=lnlinks href=#hl-12-74> 74</a>
</span><span class=lnt id=hl-12-75><a class=lnlinks href=#hl-12-75> 75</a>
</span><span class=lnt id=hl-12-76><a class=lnlinks href=#hl-12-76> 76</a>
</span><span class=lnt id=hl-12-77><a class=lnlinks href=#hl-12-77> 77</a>
</span><span class=lnt id=hl-12-78><a class=lnlinks href=#hl-12-78> 78</a>
</span><span class=lnt id=hl-12-79><a class=lnlinks href=#hl-12-79> 79</a>
</span><span class=lnt id=hl-12-80><a class=lnlinks href=#hl-12-80> 80</a>
</span><span class=lnt id=hl-12-81><a class=lnlinks href=#hl-12-81> 81</a>
</span><span class=lnt id=hl-12-82><a class=lnlinks href=#hl-12-82> 82</a>
</span><span class=lnt id=hl-12-83><a class=lnlinks href=#hl-12-83> 83</a>
</span><span class=lnt id=hl-12-84><a class=lnlinks href=#hl-12-84> 84</a>
</span><span class=lnt id=hl-12-85><a class=lnlinks href=#hl-12-85> 85</a>
</span><span class=lnt id=hl-12-86><a class=lnlinks href=#hl-12-86> 86</a>
</span><span class=lnt id=hl-12-87><a class=lnlinks href=#hl-12-87> 87</a>
</span><span class=lnt id=hl-12-88><a class=lnlinks href=#hl-12-88> 88</a>
</span><span class=lnt id=hl-12-89><a class=lnlinks href=#hl-12-89> 89</a>
</span><span class=lnt id=hl-12-90><a class=lnlinks href=#hl-12-90> 90</a>
</span><span class=lnt id=hl-12-91><a class=lnlinks href=#hl-12-91> 91</a>
</span><span class=lnt id=hl-12-92><a class=lnlinks href=#hl-12-92> 92</a>
</span><span class=lnt id=hl-12-93><a class=lnlinks href=#hl-12-93> 93</a>
</span><span class=lnt id=hl-12-94><a class=lnlinks href=#hl-12-94> 94</a>
</span><span class=lnt id=hl-12-95><a class=lnlinks href=#hl-12-95> 95</a>
</span><span class=lnt id=hl-12-96><a class=lnlinks href=#hl-12-96> 96</a>
</span><span class=lnt id=hl-12-97><a class=lnlinks href=#hl-12-97> 97</a>
</span><span class=lnt id=hl-12-98><a class=lnlinks href=#hl-12-98> 98</a>
</span><span class=lnt id=hl-12-99><a class=lnlinks href=#hl-12-99> 99</a>
</span><span class=lnt id=hl-12-100><a class=lnlinks href=#hl-12-100>100</a>
</span><span class=lnt id=hl-12-101><a class=lnlinks href=#hl-12-101>101</a>
</span><span class=lnt id=hl-12-102><a class=lnlinks href=#hl-12-102>102</a>
</span><span class=lnt id=hl-12-103><a class=lnlinks href=#hl-12-103>103</a>
</span><span class=lnt id=hl-12-104><a class=lnlinks href=#hl-12-104>104</a>
</span><span class=lnt id=hl-12-105><a class=lnlinks href=#hl-12-105>105</a>
</span><span class=lnt id=hl-12-106><a class=lnlinks href=#hl-12-106>106</a>
</span><span class=lnt id=hl-12-107><a class=lnlinks href=#hl-12-107>107</a>
</span><span class=lnt id=hl-12-108><a class=lnlinks href=#hl-12-108>108</a>
</span><span class=lnt id=hl-12-109><a class=lnlinks href=#hl-12-109>109</a>
</span><span class=lnt id=hl-12-110><a class=lnlinks href=#hl-12-110>110</a>
</span><span class=lnt id=hl-12-111><a class=lnlinks href=#hl-12-111>111</a>
</span><span class=lnt id=hl-12-112><a class=lnlinks href=#hl-12-112>112</a>
</span><span class=lnt id=hl-12-113><a class=lnlinks href=#hl-12-113>113</a>
</span><span class=lnt id=hl-12-114><a class=lnlinks href=#hl-12-114>114</a>
</span><span class=lnt id=hl-12-115><a class=lnlinks href=#hl-12-115>115</a>
</span><span class=lnt id=hl-12-116><a class=lnlinks href=#hl-12-116>116</a>
</span><span class=lnt id=hl-12-117><a class=lnlinks href=#hl-12-117>117</a>
</span><span class=lnt id=hl-12-118><a class=lnlinks href=#hl-12-118>118</a>
</span><span class=lnt id=hl-12-119><a class=lnlinks href=#hl-12-119>119</a>
</span><span class=lnt id=hl-12-120><a class=lnlinks href=#hl-12-120>120</a>
</span><span class=lnt id=hl-12-121><a class=lnlinks href=#hl-12-121>121</a>
</span><span class=lnt id=hl-12-122><a class=lnlinks href=#hl-12-122>122</a>
</span><span class=lnt id=hl-12-123><a class=lnlinks href=#hl-12-123>123</a>
</span><span class=lnt id=hl-12-124><a class=lnlinks href=#hl-12-124>124</a>
</span><span class=lnt id=hl-12-125><a class=lnlinks href=#hl-12-125>125</a>
</span><span class=lnt id=hl-12-126><a class=lnlinks href=#hl-12-126>126</a>
</span><span class=lnt id=hl-12-127><a class=lnlinks href=#hl-12-127>127</a>
</span><span class=lnt id=hl-12-128><a class=lnlinks href=#hl-12-128>128</a>
</span><span class=lnt id=hl-12-129><a class=lnlinks href=#hl-12-129>129</a>
</span><span class=lnt id=hl-12-130><a class=lnlinks href=#hl-12-130>130</a>
</span><span class=lnt id=hl-12-131><a class=lnlinks href=#hl-12-131>131</a>
</span><span class=lnt id=hl-12-132><a class=lnlinks href=#hl-12-132>132</a>
</span><span class=lnt id=hl-12-133><a class=lnlinks href=#hl-12-133>133</a>
</span><span class=lnt id=hl-12-134><a class=lnlinks href=#hl-12-134>134</a>
</span><span class=lnt id=hl-12-135><a class=lnlinks href=#hl-12-135>135</a>
</span><span class=lnt id=hl-12-136><a class=lnlinks href=#hl-12-136>136</a>
</span><span class=lnt id=hl-12-137><a class=lnlinks href=#hl-12-137>137</a>
</span><span class=lnt id=hl-12-138><a class=lnlinks href=#hl-12-138>138</a>
</span><span class=lnt id=hl-12-139><a class=lnlinks href=#hl-12-139>139</a>
</span><span class=lnt id=hl-12-140><a class=lnlinks href=#hl-12-140>140</a>
</span><span class=lnt id=hl-12-141><a class=lnlinks href=#hl-12-141>141</a>
</span><span class=lnt id=hl-12-142><a class=lnlinks href=#hl-12-142>142</a>
</span><span class=lnt id=hl-12-143><a class=lnlinks href=#hl-12-143>143</a>
</span><span class=lnt id=hl-12-144><a class=lnlinks href=#hl-12-144>144</a>
</span><span class=lnt id=hl-12-145><a class=lnlinks href=#hl-12-145>145</a>
</span><span class=lnt id=hl-12-146><a class=lnlinks href=#hl-12-146>146</a>
</span><span class=lnt id=hl-12-147><a class=lnlinks href=#hl-12-147>147</a>
</span><span class=lnt id=hl-12-148><a class=lnlinks href=#hl-12-148>148</a>
</span><span class=lnt id=hl-12-149><a class=lnlinks href=#hl-12-149>149</a>
</span><span class=lnt id=hl-12-150><a class=lnlinks href=#hl-12-150>150</a>
</span><span class=lnt id=hl-12-151><a class=lnlinks href=#hl-12-151>151</a>
</span><span class=lnt id=hl-12-152><a class=lnlinks href=#hl-12-152>152</a>
</span><span class=lnt id=hl-12-153><a class=lnlinks href=#hl-12-153>153</a>
</span><span class=lnt id=hl-12-154><a class=lnlinks href=#hl-12-154>154</a>
</span><span class=lnt id=hl-12-155><a class=lnlinks href=#hl-12-155>155</a>
</span><span class=lnt id=hl-12-156><a class=lnlinks href=#hl-12-156>156</a>
</span><span class=lnt id=hl-12-157><a class=lnlinks href=#hl-12-157>157</a>
</span><span class=lnt id=hl-12-158><a class=lnlinks href=#hl-12-158>158</a>
</span><span class=lnt id=hl-12-159><a class=lnlinks href=#hl-12-159>159</a>
</span><span class=lnt id=hl-12-160><a class=lnlinks href=#hl-12-160>160</a>
</span><span class=lnt id=hl-12-161><a class=lnlinks href=#hl-12-161>161</a>
</span><span class=lnt id=hl-12-162><a class=lnlinks href=#hl-12-162>162</a>
</span><span class=lnt id=hl-12-163><a class=lnlinks href=#hl-12-163>163</a>
</span><span class=lnt id=hl-12-164><a class=lnlinks href=#hl-12-164>164</a>
</span><span class=lnt id=hl-12-165><a class=lnlinks href=#hl-12-165>165</a>
</span><span class=lnt id=hl-12-166><a class=lnlinks href=#hl-12-166>166</a>
</span><span class=lnt id=hl-12-167><a class=lnlinks href=#hl-12-167>167</a>
</span><span class=lnt id=hl-12-168><a class=lnlinks href=#hl-12-168>168</a>
</span><span class=lnt id=hl-12-169><a class=lnlinks href=#hl-12-169>169</a>
</span><span class=lnt id=hl-12-170><a class=lnlinks href=#hl-12-170>170</a>
</span><span class=lnt id=hl-12-171><a class=lnlinks href=#hl-12-171>171</a>
</span><span class=lnt id=hl-12-172><a class=lnlinks href=#hl-12-172>172</a>
</span><span class=lnt id=hl-12-173><a class=lnlinks href=#hl-12-173>173</a>
</span><span class=lnt id=hl-12-174><a class=lnlinks href=#hl-12-174>174</a>
</span><span class=lnt id=hl-12-175><a class=lnlinks href=#hl-12-175>175</a>
</span><span class=lnt id=hl-12-176><a class=lnlinks href=#hl-12-176>176</a>
</span><span class=lnt id=hl-12-177><a class=lnlinks href=#hl-12-177>177</a>
</span><span class=lnt id=hl-12-178><a class=lnlinks href=#hl-12-178>178</a>
</span><span class=lnt id=hl-12-179><a class=lnlinks href=#hl-12-179>179</a>
</span><span class=lnt id=hl-12-180><a class=lnlinks href=#hl-12-180>180</a>
</span><span class=lnt id=hl-12-181><a class=lnlinks href=#hl-12-181>181</a>
</span><span class=lnt id=hl-12-182><a class=lnlinks href=#hl-12-182>182</a>
</span><span class=lnt id=hl-12-183><a class=lnlinks href=#hl-12-183>183</a>
</span><span class=lnt id=hl-12-184><a class=lnlinks href=#hl-12-184>184</a>
</span><span class=lnt id=hl-12-185><a class=lnlinks href=#hl-12-185>185</a>
</span><span class=lnt id=hl-12-186><a class=lnlinks href=#hl-12-186>186</a>
</span><span class=lnt id=hl-12-187><a class=lnlinks href=#hl-12-187>187</a>
</span><span class=lnt id=hl-12-188><a class=lnlinks href=#hl-12-188>188</a>
</span><span class=lnt id=hl-12-189><a class=lnlinks href=#hl-12-189>189</a>
</span><span class=lnt id=hl-12-190><a class=lnlinks href=#hl-12-190>190</a>
</span><span class=lnt id=hl-12-191><a class=lnlinks href=#hl-12-191>191</a>
</span><span class=lnt id=hl-12-192><a class=lnlinks href=#hl-12-192>192</a>
</span><span class=lnt id=hl-12-193><a class=lnlinks href=#hl-12-193>193</a>
</span><span class=lnt id=hl-12-194><a class=lnlinks href=#hl-12-194>194</a>
</span><span class=lnt id=hl-12-195><a class=lnlinks href=#hl-12-195>195</a>
</span><span class=lnt id=hl-12-196><a class=lnlinks href=#hl-12-196>196</a>
</span><span class=lnt id=hl-12-197><a class=lnlinks href=#hl-12-197>197</a>
</span><span class=lnt id=hl-12-198><a class=lnlinks href=#hl-12-198>198</a>
</span><span class=lnt id=hl-12-199><a class=lnlinks href=#hl-12-199>199</a>
</span><span class=lnt id=hl-12-200><a class=lnlinks href=#hl-12-200>200</a>
</span><span class=lnt id=hl-12-201><a class=lnlinks href=#hl-12-201>201</a>
</span><span class=lnt id=hl-12-202><a class=lnlinks href=#hl-12-202>202</a>
</span><span class=lnt id=hl-12-203><a class=lnlinks href=#hl-12-203>203</a>
</span><span class=lnt id=hl-12-204><a class=lnlinks href=#hl-12-204>204</a>
</span><span class=lnt id=hl-12-205><a class=lnlinks href=#hl-12-205>205</a>
</span><span class=lnt id=hl-12-206><a class=lnlinks href=#hl-12-206>206</a>
</span><span class=lnt id=hl-12-207><a class=lnlinks href=#hl-12-207>207</a>
</span><span class=lnt id=hl-12-208><a class=lnlinks href=#hl-12-208>208</a>
</span><span class=lnt id=hl-12-209><a class=lnlinks href=#hl-12-209>209</a>
</span><span class=lnt id=hl-12-210><a class=lnlinks href=#hl-12-210>210</a>
</span><span class=lnt id=hl-12-211><a class=lnlinks href=#hl-12-211>211</a>
</span><span class=lnt id=hl-12-212><a class=lnlinks href=#hl-12-212>212</a>
</span><span class=lnt id=hl-12-213><a class=lnlinks href=#hl-12-213>213</a>
</span><span class=lnt id=hl-12-214><a class=lnlinks href=#hl-12-214>214</a>
</span><span class=lnt id=hl-12-215><a class=lnlinks href=#hl-12-215>215</a>
</span><span class=lnt id=hl-12-216><a class=lnlinks href=#hl-12-216>216</a>
</span><span class=lnt id=hl-12-217><a class=lnlinks href=#hl-12-217>217</a>
</span><span class=lnt id=hl-12-218><a class=lnlinks href=#hl-12-218>218</a>
</span><span class=lnt id=hl-12-219><a class=lnlinks href=#hl-12-219>219</a>
</span><span class=lnt id=hl-12-220><a class=lnlinks href=#hl-12-220>220</a>
</span><span class=lnt id=hl-12-221><a class=lnlinks href=#hl-12-221>221</a>
</span><span class=lnt id=hl-12-222><a class=lnlinks href=#hl-12-222>222</a>
</span><span class=lnt id=hl-12-223><a class=lnlinks href=#hl-12-223>223</a>
</span><span class=lnt id=hl-12-224><a class=lnlinks href=#hl-12-224>224</a>
</span><span class=lnt id=hl-12-225><a class=lnlinks href=#hl-12-225>225</a>
</span><span class=lnt id=hl-12-226><a class=lnlinks href=#hl-12-226>226</a>
</span><span class=lnt id=hl-12-227><a class=lnlinks href=#hl-12-227>227</a>
</span><span class=lnt id=hl-12-228><a class=lnlinks href=#hl-12-228>228</a>
</span><span class=lnt id=hl-12-229><a class=lnlinks href=#hl-12-229>229</a>
</span><span class=lnt id=hl-12-230><a class=lnlinks href=#hl-12-230>230</a>
</span><span class=lnt id=hl-12-231><a class=lnlinks href=#hl-12-231>231</a>
</span><span class=lnt id=hl-12-232><a class=lnlinks href=#hl-12-232>232</a>
</span><span class=lnt id=hl-12-233><a class=lnlinks href=#hl-12-233>233</a>
</span><span class=lnt id=hl-12-234><a class=lnlinks href=#hl-12-234>234</a>
</span><span class=lnt id=hl-12-235><a class=lnlinks href=#hl-12-235>235</a>
</span><span class=lnt id=hl-12-236><a class=lnlinks href=#hl-12-236>236</a>
</span><span class=lnt id=hl-12-237><a class=lnlinks href=#hl-12-237>237</a>
</span><span class=lnt id=hl-12-238><a class=lnlinks href=#hl-12-238>238</a>
</span><span class=lnt id=hl-12-239><a class=lnlinks href=#hl-12-239>239</a>
</span><span class=lnt id=hl-12-240><a class=lnlinks href=#hl-12-240>240</a>
</span><span class=lnt id=hl-12-241><a class=lnlinks href=#hl-12-241>241</a>
</span><span class=lnt id=hl-12-242><a class=lnlinks href=#hl-12-242>242</a>
</span><span class=lnt id=hl-12-243><a class=lnlinks href=#hl-12-243>243</a>
</span><span class=lnt id=hl-12-244><a class=lnlinks href=#hl-12-244>244</a>
</span><span class=lnt id=hl-12-245><a class=lnlinks href=#hl-12-245>245</a>
</span><span class=lnt id=hl-12-246><a class=lnlinks href=#hl-12-246>246</a>
</span><span class=lnt id=hl-12-247><a class=lnlinks href=#hl-12-247>247</a>
</span><span class=lnt id=hl-12-248><a class=lnlinks href=#hl-12-248>248</a>
</span><span class=lnt id=hl-12-249><a class=lnlinks href=#hl-12-249>249</a>
</span><span class=lnt id=hl-12-250><a class=lnlinks href=#hl-12-250>250</a>
</span><span class=lnt id=hl-12-251><a class=lnlinks href=#hl-12-251>251</a>
</span><span class=lnt id=hl-12-252><a class=lnlinks href=#hl-12-252>252</a>
</span><span class=lnt id=hl-12-253><a class=lnlinks href=#hl-12-253>253</a>
</span><span class=lnt id=hl-12-254><a class=lnlinks href=#hl-12-254>254</a>
</span><span class=lnt id=hl-12-255><a class=lnlinks href=#hl-12-255>255</a>
</span><span class=lnt id=hl-12-256><a class=lnlinks href=#hl-12-256>256</a>
</span><span class=lnt id=hl-12-257><a class=lnlinks href=#hl-12-257>257</a>
</span><span class=lnt id=hl-12-258><a class=lnlinks href=#hl-12-258>258</a>
</span><span class=lnt id=hl-12-259><a class=lnlinks href=#hl-12-259>259</a>
</span><span class=lnt id=hl-12-260><a class=lnlinks href=#hl-12-260>260</a>
</span><span class=lnt id=hl-12-261><a class=lnlinks href=#hl-12-261>261</a>
</span><span class=lnt id=hl-12-262><a class=lnlinks href=#hl-12-262>262</a>
</span><span class=lnt id=hl-12-263><a class=lnlinks href=#hl-12-263>263</a>
</span><span class=lnt id=hl-12-264><a class=lnlinks href=#hl-12-264>264</a>
</span><span class=lnt id=hl-12-265><a class=lnlinks href=#hl-12-265>265</a>
</span><span class=lnt id=hl-12-266><a class=lnlinks href=#hl-12-266>266</a>
</span><span class=lnt id=hl-12-267><a class=lnlinks href=#hl-12-267>267</a>
</span><span class=lnt id=hl-12-268><a class=lnlinks href=#hl-12-268>268</a>
</span><span class=lnt id=hl-12-269><a class=lnlinks href=#hl-12-269>269</a>
</span><span class=lnt id=hl-12-270><a class=lnlinks href=#hl-12-270>270</a>
</span><span class=lnt id=hl-12-271><a class=lnlinks href=#hl-12-271>271</a>
</span><span class=lnt id=hl-12-272><a class=lnlinks href=#hl-12-272>272</a>
</span><span class=lnt id=hl-12-273><a class=lnlinks href=#hl-12-273>273</a>
</span><span class=lnt id=hl-12-274><a class=lnlinks href=#hl-12-274>274</a>
</span><span class=lnt id=hl-12-275><a class=lnlinks href=#hl-12-275>275</a>
</span><span class=lnt id=hl-12-276><a class=lnlinks href=#hl-12-276>276</a>
</span><span class=lnt id=hl-12-277><a class=lnlinks href=#hl-12-277>277</a>
</span><span class=lnt id=hl-12-278><a class=lnlinks href=#hl-12-278>278</a>
</span><span class=lnt id=hl-12-279><a class=lnlinks href=#hl-12-279>279</a>
</span><span class=lnt id=hl-12-280><a class=lnlinks href=#hl-12-280>280</a>
</span><span class=lnt id=hl-12-281><a class=lnlinks href=#hl-12-281>281</a>
</span><span class=lnt id=hl-12-282><a class=lnlinks href=#hl-12-282>282</a>
</span><span class=lnt id=hl-12-283><a class=lnlinks href=#hl-12-283>283</a>
</span><span class=lnt id=hl-12-284><a class=lnlinks href=#hl-12-284>284</a>
</span><span class=lnt id=hl-12-285><a class=lnlinks href=#hl-12-285>285</a>
</span><span class=lnt id=hl-12-286><a class=lnlinks href=#hl-12-286>286</a>
</span><span class=lnt id=hl-12-287><a class=lnlinks href=#hl-12-287>287</a>
</span><span class=lnt id=hl-12-288><a class=lnlinks href=#hl-12-288>288</a>
</span><span class=lnt id=hl-12-289><a class=lnlinks href=#hl-12-289>289</a>
</span><span class=lnt id=hl-12-290><a class=lnlinks href=#hl-12-290>290</a>
</span><span class=lnt id=hl-12-291><a class=lnlinks href=#hl-12-291>291</a>
</span><span class=lnt id=hl-12-292><a class=lnlinks href=#hl-12-292>292</a>
</span><span class=lnt id=hl-12-293><a class=lnlinks href=#hl-12-293>293</a>
</span><span class=lnt id=hl-12-294><a class=lnlinks href=#hl-12-294>294</a>
</span><span class=lnt id=hl-12-295><a class=lnlinks href=#hl-12-295>295</a>
</span><span class=lnt id=hl-12-296><a class=lnlinks href=#hl-12-296>296</a>
</span><span class=lnt id=hl-12-297><a class=lnlinks href=#hl-12-297>297</a>
</span><span class=lnt id=hl-12-298><a class=lnlinks href=#hl-12-298>298</a>
</span><span class=lnt id=hl-12-299><a class=lnlinks href=#hl-12-299>299</a>
</span><span class=lnt id=hl-12-300><a class=lnlinks href=#hl-12-300>300</a>
</span><span class=lnt id=hl-12-301><a class=lnlinks href=#hl-12-301>301</a>
</span><span class=lnt id=hl-12-302><a class=lnlinks href=#hl-12-302>302</a>
</span><span class=lnt id=hl-12-303><a class=lnlinks href=#hl-12-303>303</a>
</span><span class=lnt id=hl-12-304><a class=lnlinks href=#hl-12-304>304</a>
</span><span class=lnt id=hl-12-305><a class=lnlinks href=#hl-12-305>305</a>
</span><span class=lnt id=hl-12-306><a class=lnlinks href=#hl-12-306>306</a>
</span><span class=lnt id=hl-12-307><a class=lnlinks href=#hl-12-307>307</a>
</span><span class=lnt id=hl-12-308><a class=lnlinks href=#hl-12-308>308</a>
</span><span class=lnt id=hl-12-309><a class=lnlinks href=#hl-12-309>309</a>
</span><span class=lnt id=hl-12-310><a class=lnlinks href=#hl-12-310>310</a>
</span><span class=lnt id=hl-12-311><a class=lnlinks href=#hl-12-311>311</a>
</span><span class=lnt id=hl-12-312><a class=lnlinks href=#hl-12-312>312</a>
</span><span class=lnt id=hl-12-313><a class=lnlinks href=#hl-12-313>313</a>
</span><span class=lnt id=hl-12-314><a class=lnlinks href=#hl-12-314>314</a>
</span><span class=lnt id=hl-12-315><a class=lnlinks href=#hl-12-315>315</a>
</span><span class=lnt id=hl-12-316><a class=lnlinks href=#hl-12-316>316</a>
</span><span class=lnt id=hl-12-317><a class=lnlinks href=#hl-12-317>317</a>
</span><span class=lnt id=hl-12-318><a class=lnlinks href=#hl-12-318>318</a>
</span><span class=lnt id=hl-12-319><a class=lnlinks href=#hl-12-319>319</a>
</span><span class=lnt id=hl-12-320><a class=lnlinks href=#hl-12-320>320</a>
</span><span class=lnt id=hl-12-321><a class=lnlinks href=#hl-12-321>321</a>
</span><span class=lnt id=hl-12-322><a class=lnlinks href=#hl-12-322>322</a>
</span><span class=lnt id=hl-12-323><a class=lnlinks href=#hl-12-323>323</a>
</span><span class=lnt id=hl-12-324><a class=lnlinks href=#hl-12-324>324</a>
</span><span class=lnt id=hl-12-325><a class=lnlinks href=#hl-12-325>325</a>
</span><span class=lnt id=hl-12-326><a class=lnlinks href=#hl-12-326>326</a>
</span><span class=lnt id=hl-12-327><a class=lnlinks href=#hl-12-327>327</a>
</span><span class=lnt id=hl-12-328><a class=lnlinks href=#hl-12-328>328</a>
</span><span class=lnt id=hl-12-329><a class=lnlinks href=#hl-12-329>329</a>
</span><span class=lnt id=hl-12-330><a class=lnlinks href=#hl-12-330>330</a>
</span><span class=lnt id=hl-12-331><a class=lnlinks href=#hl-12-331>331</a>
</span><span class=lnt id=hl-12-332><a class=lnlinks href=#hl-12-332>332</a>
</span><span class=lnt id=hl-12-333><a class=lnlinks href=#hl-12-333>333</a>
</span><span class=lnt id=hl-12-334><a class=lnlinks href=#hl-12-334>334</a>
</span><span class=lnt id=hl-12-335><a class=lnlinks href=#hl-12-335>335</a>
</span><span class=lnt id=hl-12-336><a class=lnlinks href=#hl-12-336>336</a>
</span><span class=lnt id=hl-12-337><a class=lnlinks href=#hl-12-337>337</a>
</span><span class=lnt id=hl-12-338><a class=lnlinks href=#hl-12-338>338</a>
</span><span class=lnt id=hl-12-339><a class=lnlinks href=#hl-12-339>339</a>
</span><span class=lnt id=hl-12-340><a class=lnlinks href=#hl-12-340>340</a>
</span><span class=lnt id=hl-12-341><a class=lnlinks href=#hl-12-341>341</a>
</span><span class=lnt id=hl-12-342><a class=lnlinks href=#hl-12-342>342</a>
</span><span class=lnt id=hl-12-343><a class=lnlinks href=#hl-12-343>343</a>
</span><span class=lnt id=hl-12-344><a class=lnlinks href=#hl-12-344>344</a>
</span><span class=lnt id=hl-12-345><a class=lnlinks href=#hl-12-345>345</a>
</span><span class=lnt id=hl-12-346><a class=lnlinks href=#hl-12-346>346</a>
</span><span class=lnt id=hl-12-347><a class=lnlinks href=#hl-12-347>347</a>
</span><span class=lnt id=hl-12-348><a class=lnlinks href=#hl-12-348>348</a>
</span><span class=lnt id=hl-12-349><a class=lnlinks href=#hl-12-349>349</a>
</span><span class=lnt id=hl-12-350><a class=lnlinks href=#hl-12-350>350</a>
</span><span class=lnt id=hl-12-351><a class=lnlinks href=#hl-12-351>351</a>
</span><span class=lnt id=hl-12-352><a class=lnlinks href=#hl-12-352>352</a>
</span><span class=lnt id=hl-12-353><a class=lnlinks href=#hl-12-353>353</a>
</span><span class=lnt id=hl-12-354><a class=lnlinks href=#hl-12-354>354</a>
</span><span class=lnt id=hl-12-355><a class=lnlinks href=#hl-12-355>355</a>
</span><span class=lnt id=hl-12-356><a class=lnlinks href=#hl-12-356>356</a>
</span><span class=lnt id=hl-12-357><a class=lnlinks href=#hl-12-357>357</a>
</span><span class=lnt id=hl-12-358><a class=lnlinks href=#hl-12-358>358</a>
</span><span class=lnt id=hl-12-359><a class=lnlinks href=#hl-12-359>359</a>
</span><span class=lnt id=hl-12-360><a class=lnlinks href=#hl-12-360>360</a>
</span><span class=lnt id=hl-12-361><a class=lnlinks href=#hl-12-361>361</a>
</span><span class=lnt id=hl-12-362><a class=lnlinks href=#hl-12-362>362</a>
</span><span class=lnt id=hl-12-363><a class=lnlinks href=#hl-12-363>363</a>
</span><span class=lnt id=hl-12-364><a class=lnlinks href=#hl-12-364>364</a>
</span><span class=lnt id=hl-12-365><a class=lnlinks href=#hl-12-365>365</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>Pipe-and-Filter 패턴을 활용한 실시간 주문 처리 시스템 구현
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>이 예시는 전자상거래 주문 처리를 위한 파이프라인을 보여줍니다.
</span></span></span><span class=line><span class=cl><span class=s2>각 필터는 독립적인 처리 단계를 담당하며, 파이프를 통해 연결됩니다.
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>abc</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Any</span><span class=p>,</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>List</span><span class=p>,</span> <span class=n>Optional</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dataclasses</span> <span class=kn>import</span> <span class=n>dataclass</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>enum</span> <span class=kn>import</span> <span class=n>Enum</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>asyncio</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>concurrent.futures</span> <span class=kn>import</span> <span class=n>ThreadPoolExecutor</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 데이터 모델 정의</span>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderData</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;주문 데이터 모델&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>order_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>customer_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>product_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>quantity</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>    <span class=n>price</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>payment_method</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>metadata</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>__post_init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>metadata</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>metadata</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ProcessingStatus</span><span class=p>(</span><span class=n>Enum</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;처리 상태 열거형&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>SUCCESS</span> <span class=o>=</span> <span class=s2>&#34;success&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>FAILED</span> <span class=o>=</span> <span class=s2>&#34;failed&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>RETRY</span> <span class=o>=</span> <span class=s2>&#34;retry&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ProcessingResult</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;처리 결과 클래스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>status</span><span class=p>:</span> <span class=n>ProcessingStatus</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>OrderData</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=n>error_message</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=n>retry_count</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 추상 필터 인터페이스</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Filter</span><span class=p>(</span><span class=n>abc</span><span class=o>.</span><span class=n>ABC</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;필터 추상 클래스 - 모든 필터가 구현해야 하는 인터페이스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Filter.</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>processed_count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>error_count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abc.abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>OrderData</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ProcessingResult</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터 처리 메서드 - 각 필터에서 구현&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_stats</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;필터 통계 정보 반환&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;processed&#34;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>processed_count</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;errors&#34;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>error_count</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;success_rate&#34;</span><span class=p>:</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>processed_count</span> <span class=o>-</span> <span class=bp>self</span><span class=o>.</span><span class=n>error_count</span><span class=p>)</span> <span class=o>/</span> <span class=nb>max</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>processed_count</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 구체적인 필터 구현들</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderValidationFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;주문 검증 필터 - 주문 데이터의 유효성을 검사&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=s2>&#34;OrderValidation&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>OrderData</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ProcessingResult</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;주문 데이터 검증 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Validating order: </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>order_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 필수 필드 검증</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=nb>all</span><span class=p>([</span><span class=n>data</span><span class=o>.</span><span class=n>order_id</span><span class=p>,</span> <span class=n>data</span><span class=o>.</span><span class=n>customer_id</span><span class=p>,</span> <span class=n>data</span><span class=o>.</span><span class=n>product_id</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Missing required fields&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 수량 및 가격 검증</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>quantity</span> <span class=o>&lt;=</span> <span class=mi>0</span> <span class=ow>or</span> <span class=n>data</span><span class=o>.</span><span class=n>price</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Invalid quantity or price&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 검증 완료 메타데이터 추가</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s2>&#34;validated_at&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s2>&#34;validation_status&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;passed&#34;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>processed_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>ProcessingResult</span><span class=p>(</span><span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>SUCCESS</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>error_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Validation failed for order </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>order_id</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>ProcessingResult</span><span class=p>(</span><span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>FAILED</span><span class=p>,</span> <span class=n>error_message</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>FraudDetectionFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;사기 탐지 필터 - 의심스러운 주문을 탐지&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=s2>&#34;FraudDetection&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>suspicious_customers</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;CUST999&#34;</span><span class=p>,</span> <span class=s2>&#34;CUST666&#34;</span><span class=p>}</span>  <span class=c1># 시뮬레이션용 블랙리스트</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>OrderData</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ProcessingResult</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;사기 탐지 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fraud detection for order: </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>order_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 시뮬레이션: 머신러닝 모델 호출 (비동기 처리)</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>  <span class=c1># 모델 추론 시간 시뮬레이션</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 간단한 규칙 기반 사기 탐지</span>
</span></span><span class=line><span class=cl>            <span class=n>risk_score</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 블랙리스트 고객 확인</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>customer_id</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>suspicious_customers</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>risk_score</span> <span class=o>+=</span> <span class=mi>80</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 고액 주문 확인</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>price</span> <span class=o>&gt;</span> <span class=mi>10000</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>risk_score</span> <span class=o>+=</span> <span class=mi>30</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 대량 주문 확인</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>data</span><span class=o>.</span><span class=n>quantity</span> <span class=o>&gt;</span> <span class=mi>100</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>risk_score</span> <span class=o>+=</span> <span class=mi>20</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>data</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s2>&#34;risk_score&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>risk_score</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s2>&#34;fraud_checked_at&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>risk_score</span> <span class=o>&gt;</span> <span class=mi>70</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>error_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>ProcessingResult</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>FAILED</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                    <span class=n>error_message</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;High fraud risk: </span><span class=si>{</span><span class=n>risk_score</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>processed_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>ProcessingResult</span><span class=p>(</span><span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>SUCCESS</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>error_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Fraud detection failed for order </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>order_id</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>ProcessingResult</span><span class=p>(</span><span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>FAILED</span><span class=p>,</span> <span class=n>error_message</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>InventoryCheckFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;재고 확인 필터 - 상품 재고를 확인하고 예약&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=s2>&#34;InventoryCheck&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 시뮬레이션용 재고 데이터</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>inventory</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;PROD001&#34;</span><span class=p>:</span> <span class=mi>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;PROD002&#34;</span><span class=p>:</span> <span class=mi>50</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;PROD003&#34;</span><span class=p>:</span> <span class=mi>0</span>  <span class=c1># 품절 상품</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>OrderData</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ProcessingResult</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;재고 확인 및 예약 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Checking inventory for order: </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>order_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 시뮬레이션: 데이터베이스 조회</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.05</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>current_stock</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>inventory</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>product_id</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>current_stock</span> <span class=o>&lt;</span> <span class=n>data</span><span class=o>.</span><span class=n>quantity</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>error_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>ProcessingResult</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>FAILED</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>error_message</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;Insufficient stock. Available: </span><span class=si>{</span><span class=n>current_stock</span><span class=si>}</span><span class=s2>, Requested: </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>quantity</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 재고 예약 (실제로는 데이터베이스 트랜잭션 처리)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>inventory</span><span class=p>[</span><span class=n>data</span><span class=o>.</span><span class=n>product_id</span><span class=p>]</span> <span class=o>-=</span> <span class=n>data</span><span class=o>.</span><span class=n>quantity</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>data</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s2>&#34;inventory_reserved&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>quantity</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s2>&#34;remaining_stock&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>inventory</span><span class=p>[</span><span class=n>data</span><span class=o>.</span><span class=n>product_id</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s2>&#34;inventory_checked_at&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>processed_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>ProcessingResult</span><span class=p>(</span><span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>SUCCESS</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>error_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Inventory check failed for order </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>order_id</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>ProcessingResult</span><span class=p>(</span><span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>FAILED</span><span class=p>,</span> <span class=n>error_message</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>PaymentProcessingFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;결제 처리 필터 - 결제 게이트웨이와 연동하여 결제 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=s2>&#34;PaymentProcessing&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>OrderData</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ProcessingResult</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;결제 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Processing payment for order: </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>order_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 시뮬레이션: 외부 결제 게이트웨이 호출</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.2</span><span class=p>)</span>  <span class=c1># 네트워크 지연 시뮬레이션</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>total_amount</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>price</span> <span class=o>*</span> <span class=n>data</span><span class=o>.</span><span class=n>quantity</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 간단한 결제 시뮬레이션 (90% 성공률)</span>
</span></span><span class=line><span class=cl>            <span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>random</span><span class=o>.</span><span class=n>random</span><span class=p>()</span> <span class=o>&lt;</span> <span class=mf>0.9</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>transaction_id</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;TXN_</span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>order_id</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>())</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=n>data</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s2>&#34;payment_status&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;completed&#34;</span>
</span></span><span class=line><span class=cl>                <span class=n>data</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s2>&#34;transaction_id&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>transaction_id</span>
</span></span><span class=line><span class=cl>                <span class=n>data</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s2>&#34;total_amount&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>total_amount</span>
</span></span><span class=line><span class=cl>                <span class=n>data</span><span class=o>.</span><span class=n>metadata</span><span class=p>[</span><span class=s2>&#34;payment_processed_at&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>processed_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>ProcessingResult</span><span class=p>(</span><span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>SUCCESS</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>error_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>ProcessingResult</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>RETRY</span><span class=p>,</span>  <span class=c1># 결제 실패는 재시도 가능</span>
</span></span><span class=line><span class=cl>                    <span class=n>error_message</span><span class=o>=</span><span class=s2>&#34;Payment gateway error&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>error_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Payment processing failed for order </span><span class=si>{</span><span class=n>data</span><span class=o>.</span><span class=n>order_id</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>ProcessingResult</span><span class=p>(</span><span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>FAILED</span><span class=p>,</span> <span class=n>error_message</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 파이프라인 클래스</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderProcessingPipeline</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;주문 처리 파이프라인 - 여러 필터를 연결하여 순차적으로 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Filter</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s2>&#34;Pipeline&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>executor</span> <span class=o>=</span> <span class=n>ThreadPoolExecutor</span><span class=p>(</span><span class=n>max_workers</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_filter</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>filter_instance</span><span class=p>:</span> <span class=n>Filter</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=s1>&#39;OrderProcessingPipeline&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;필터를 파이프라인에 추가 (체이닝 방식)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>filter_instance</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process_order</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order</span><span class=p>:</span> <span class=n>OrderData</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ProcessingResult</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;단일 주문을 파이프라인을 통해 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Starting pipeline processing for order: </span><span class=si>{</span><span class=n>order</span><span class=o>.</span><span class=n>order_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>current_data</span> <span class=o>=</span> <span class=n>order</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>filter_instance</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>filter_instance</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>current_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>result</span><span class=o>.</span><span class=n>status</span> <span class=o>==</span> <span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>SUCCESS</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>current_data</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>data</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Filter </span><span class=si>{</span><span class=n>filter_instance</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> completed successfully&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>elif</span> <span class=n>result</span><span class=o>.</span><span class=n>status</span> <span class=o>==</span> <span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>RETRY</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=c1># 재시도 로직 (간단한 구현)</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Filter </span><span class=si>{</span><span class=n>filter_instance</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> requires retry: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>error_message</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># 재시도 대기</span>
</span></span><span class=line><span class=cl>                    <span class=n>result</span> <span class=o>=</span> <span class=k>await</span> <span class=n>filter_instance</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>current_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>result</span><span class=o>.</span><span class=n>status</span> <span class=o>!=</span> <span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>SUCCESS</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>                    <span class=n>current_data</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>data</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Filter </span><span class=si>{</span><span class=n>filter_instance</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> failed: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>error_message</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Unexpected error in filter </span><span class=si>{</span><span class=n>filter_instance</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>ProcessingResult</span><span class=p>(</span><span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>FAILED</span><span class=p>,</span> <span class=n>error_message</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Pipeline processing completed for order: </span><span class=si>{</span><span class=n>order</span><span class=o>.</span><span class=n>order_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>ProcessingResult</span><span class=p>(</span><span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>SUCCESS</span><span class=p>,</span> <span class=n>current_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process_batch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>orders</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>OrderData</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>ProcessingResult</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;여러 주문을 병렬로 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Processing batch of </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>orders</span><span class=p>)</span><span class=si>}</span><span class=s2> orders&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>tasks</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>process_order</span><span class=p>(</span><span class=n>order</span><span class=p>)</span> <span class=k>for</span> <span class=n>order</span> <span class=ow>in</span> <span class=n>orders</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span><span class=o>*</span><span class=n>tasks</span><span class=p>,</span> <span class=n>return_exceptions</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 예외 처리</span>
</span></span><span class=line><span class=cl>        <span class=n>processed_results</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>result</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>results</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>result</span><span class=p>,</span> <span class=ne>Exception</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>processed_results</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>ProcessingResult</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>FAILED</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>error_message</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;Batch processing error: </span><span class=si>{</span><span class=n>result</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>processed_results</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>processed_results</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_pipeline_stats</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;파이프라인 전체 통계 정보 반환&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>stats</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>filter_instance</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>stats</span><span class=p>[</span><span class=n>filter_instance</span><span class=o>.</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>filter_instance</span><span class=o>.</span><span class=n>get_stats</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>stats</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시 및 테스트</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;메인 실행 함수 - 파이프라인 설정 및 테스트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 로깅 설정</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> - </span><span class=si>%(name)s</span><span class=s1> - </span><span class=si>%(levelname)s</span><span class=s1> - </span><span class=si>%(message)s</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 파이프라인 구성</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>OrderProcessingPipeline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>OrderValidationFilter</span><span class=p>())</span> \
</span></span><span class=line><span class=cl>           <span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>FraudDetectionFilter</span><span class=p>())</span> \
</span></span><span class=line><span class=cl>           <span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>InventoryCheckFilter</span><span class=p>())</span> \
</span></span><span class=line><span class=cl>           <span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>PaymentProcessingFilter</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 테스트 주문 데이터 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>test_orders</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=n>OrderData</span><span class=p>(</span><span class=s2>&#34;ORD001&#34;</span><span class=p>,</span> <span class=s2>&#34;CUST001&#34;</span><span class=p>,</span> <span class=s2>&#34;PROD001&#34;</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mf>100.0</span><span class=p>,</span> <span class=s2>&#34;credit_card&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>OrderData</span><span class=p>(</span><span class=s2>&#34;ORD002&#34;</span><span class=p>,</span> <span class=s2>&#34;CUST002&#34;</span><span class=p>,</span> <span class=s2>&#34;PROD002&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mf>50.0</span><span class=p>,</span> <span class=s2>&#34;debit_card&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>OrderData</span><span class=p>(</span><span class=s2>&#34;ORD003&#34;</span><span class=p>,</span> <span class=s2>&#34;CUST999&#34;</span><span class=p>,</span> <span class=s2>&#34;PROD001&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mf>200.0</span><span class=p>,</span> <span class=s2>&#34;credit_card&#34;</span><span class=p>),</span>  <span class=c1># 사기 위험</span>
</span></span><span class=line><span class=cl>        <span class=n>OrderData</span><span class=p>(</span><span class=s2>&#34;ORD004&#34;</span><span class=p>,</span> <span class=s2>&#34;CUST003&#34;</span><span class=p>,</span> <span class=s2>&#34;PROD003&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mf>75.0</span><span class=p>,</span> <span class=s2>&#34;paypal&#34;</span><span class=p>),</span>  <span class=c1># 재고 부족</span>
</span></span><span class=line><span class=cl>        <span class=n>OrderData</span><span class=p>(</span><span class=s2>&#34;ORD005&#34;</span><span class=p>,</span> <span class=s2>&#34;CUST004&#34;</span><span class=p>,</span> <span class=s2>&#34;PROD001&#34;</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mf>25000.0</span><span class=p>,</span> <span class=s2>&#34;credit_card&#34;</span><span class=p>),</span>  <span class=c1># 고위험 + 대량</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 배치 처리 실행</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=== Starting Order Processing Pipeline ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>results</span> <span class=o>=</span> <span class=k>await</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>process_batch</span><span class=p>(</span><span class=n>test_orders</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>processing_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 결과 출력</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>=== Processing Results (Total time: </span><span class=si>{</span><span class=n>processing_time</span><span class=si>:</span><span class=s2>f</span><span class=si>}</span><span class=s2>s) ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>result</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>results</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>order</span> <span class=o>=</span> <span class=n>test_orders</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Order </span><span class=si>{</span><span class=n>order</span><span class=o>.</span><span class=n>order_id</span><span class=si>}</span><span class=s2>:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  Status: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>status</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>result</span><span class=o>.</span><span class=n>status</span> <span class=o>==</span> <span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>SUCCESS</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  Metadata: </span><span class=si>{</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>result</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>metadata</span><span class=p>,</span> <span class=n>indent</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  Error: </span><span class=si>{</span><span class=n>result</span><span class=o>.</span><span class=n>error_message</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 파이프라인 통계 출력</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>=== Pipeline Statistics ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>stats</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>get_pipeline_stats</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>filter_name</span><span class=p>,</span> <span class=n>filter_stats</span> <span class=ow>in</span> <span class=n>stats</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>filter_name</span><span class=si>}</span><span class=s2>:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  Processed: </span><span class=si>{</span><span class=n>filter_stats</span><span class=p>[</span><span class=s1>&#39;processed&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  Errors: </span><span class=si>{</span><span class=n>filter_stats</span><span class=p>[</span><span class=s1>&#39;errors&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  Success Rate: </span><span class=si>{</span><span class=n>filter_stats</span><span class=p>[</span><span class=s1>&#39;success_rate&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>%</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 비동기 실행</span>
</span></span><span class=line><span class=cl>    <span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>main</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-3-로그-데이터-정제-및-분석-파이프라인>사례 3: 로그 데이터 정제 및 분석 파이프라인<a hidden class=anchor aria-hidden=true href=#사례-3-로그-데이터-정제-및-분석-파이프라인>#</a></h4><p><strong>시스템 구성</strong>: 로그 소스 → 파싱 필터 → 정제 필터 → 분석 필터 → 저장소 → 모니터링/알림</p><p><strong>Workflow</strong></p><ol><li>로그 소스에서 데이터 수집</li><li>파싱 필터에서 구조화</li><li>정제 필터에서 불필요 정보 제거</li><li>분석 필터에서 패턴 분석 및 통계 산출</li><li>결과를 저장소에 적재, 모니터링 시스템 연동</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1>1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2>2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3>3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4>4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5>5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>flowchart LR
</span></span><span class=line><span class=cl>    S[로그 소스] --&gt; P[파싱 필터]
</span></span><span class=line><span class=cl>    P --&gt; C[정제 필터]
</span></span><span class=line><span class=cl>    C --&gt; A[분석 필터]
</span></span><span class=line><span class=cl>    A --&gt; D[저장소]
</span></span><span class=line><span class=cl>    D --&gt; M[모니터링/알림]
</span></span></code></pre></td></tr></table></div></div><p><strong>Pipe-and-Filter Architecture 의 역할</strong>: 각 단계가 독립적으로 구현되어 유지보수와 확장 용이, 장애 발생 시 단계별로 문제 격리 가능</p><p><strong>유무에 따른 차이점</strong>: 미적용 시, 단일 모놀리식 구조로 인해 유지보수, 확장, 장애 대응이 어려움</p><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1> 1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2> 2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3> 3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4> 4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5> 5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6> 6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7> 7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8> 8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9> 9</a>
</span><span class=lnt id=hl-14-10><a class=lnlinks href=#hl-14-10>10</a>
</span><span class=lnt id=hl-14-11><a class=lnlinks href=#hl-14-11>11</a>
</span><span class=lnt id=hl-14-12><a class=lnlinks href=#hl-14-12>12</a>
</span><span class=lnt id=hl-14-13><a class=lnlinks href=#hl-14-13>13</a>
</span><span class=lnt id=hl-14-14><a class=lnlinks href=#hl-14-14>14</a>
</span><span class=lnt id=hl-14-15><a class=lnlinks href=#hl-14-15>15</a>
</span><span class=lnt id=hl-14-16><a class=lnlinks href=#hl-14-16>16</a>
</span><span class=lnt id=hl-14-17><a class=lnlinks href=#hl-14-17>17</a>
</span><span class=lnt id=hl-14-18><a class=lnlinks href=#hl-14-18>18</a>
</span><span class=lnt id=hl-14-19><a class=lnlinks href=#hl-14-19>19</a>
</span><span class=lnt id=hl-14-20><a class=lnlinks href=#hl-14-20>20</a>
</span><span class=lnt id=hl-14-21><a class=lnlinks href=#hl-14-21>21</a>
</span><span class=lnt id=hl-14-22><a class=lnlinks href=#hl-14-22>22</a>
</span><span class=lnt id=hl-14-23><a class=lnlinks href=#hl-14-23>23</a>
</span><span class=lnt id=hl-14-24><a class=lnlinks href=#hl-14-24>24</a>
</span><span class=lnt id=hl-14-25><a class=lnlinks href=#hl-14-25>25</a>
</span><span class=lnt id=hl-14-26><a class=lnlinks href=#hl-14-26>26</a>
</span><span class=lnt id=hl-14-27><a class=lnlinks href=#hl-14-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Pipe-and-Filter 구조의 간단한 로그 처리 파이프라인 예시</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>parse_filter</span><span class=p>(</span><span class=n>logs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 파싱: 로그를 구조화된 딕셔너리로 변환</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>log</span> <span class=ow>in</span> <span class=n>logs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>yield</span> <span class=p>{</span><span class=s2>&#34;raw&#34;</span><span class=p>:</span> <span class=n>log</span><span class=p>,</span> <span class=s2>&#34;parsed&#34;</span><span class=p>:</span> <span class=n>log</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34; &#34;</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>clean_filter</span><span class=p>(</span><span class=n>parsed_logs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 정제: 불필요한 정보 제거</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>log</span> <span class=ow>in</span> <span class=n>parsed_logs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;ERROR&#34;</span> <span class=ow>in</span> <span class=n>log</span><span class=p>[</span><span class=s2>&#34;parsed&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=k>yield</span> <span class=n>log</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>analyze_filter</span><span class=p>(</span><span class=n>cleaned_logs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 분석: 에러 로그 카운트</span>
</span></span><span class=line><span class=cl>    <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>log</span> <span class=ow>in</span> <span class=n>cleaned_logs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>yield</span> <span class=p>{</span><span class=s2>&#34;error_count&#34;</span><span class=p>:</span> <span class=n>count</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 파이프라인 실행</span>
</span></span><span class=line><span class=cl><span class=n>logs</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;2023-01-01 INFO Start&#34;</span><span class=p>,</span> <span class=s2>&#34;2023-01-01 ERROR Fail&#34;</span><span class=p>,</span> <span class=s2>&#34;2023-01-01 ERROR Crash&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>parsed</span> <span class=o>=</span> <span class=n>parse_filter</span><span class=p>(</span><span class=n>logs</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>cleaned</span> <span class=o>=</span> <span class=n>clean_filter</span><span class=p>(</span><span class=n>parsed</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>analyzed</span> <span class=o>=</span> <span class=n>analyze_filter</span><span class=p>(</span><span class=n>cleaned</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>result</span> <span class=ow>in</span> <span class=n>analyzed</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>  <span class=c1># {&#39;error_count&#39;: 2}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>설명</strong>: 각 단계가 독립 함수 (필터) 로 구현되어, 입력 데이터를 순차적으로 변환 및 분석</li></ul><h4 id=사례-4-실시간-로그-변환-시스템>사례 4: 실시간 로그 변환 시스템<a hidden class=anchor aria-hidden=true href=#사례-4-실시간-로그-변환-시스템>#</a></h4><ul><li><p><strong>배경</strong>: 웹 서버가 생성하는 JSON 로그를 실시간으로 처리해 통계용 DB 적재</p></li><li><p><strong>구성</strong>:</p><ul><li>Source(Log burst) → Filter1(파싱) → Filter2(필터링) → Filter3(포맷 변환) → Sink(DB)</li></ul></li><li><p><strong>워크플로</strong>:</p><ol><li>JSON 수신</li><li>이상 로그 제거</li><li>필요 필드 추출 및 변환</li><li>배치 또는 스트리밍 적재</li></ol></li><li><p><strong>Pipe-and-Filter 적용</strong>:</p><ul><li><strong>장점</strong>: 로그 포맷 변경이나 필터 추가 시 유연한 확장 가능</li><li><strong>비교</strong>: monolithic 처리 구조 대비 훨씬 확장성과 유지보수 측면에서 우수</li></ul></li><li><p><strong>시스템 구성 도식</strong>:</p></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1>1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>graph LR
</span></span><span class=line><span class=cl>  LogSource --&gt; ParseFilter --&gt; CleanFilter --&gt; TransformFilter --&gt; DBSink
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-5-apache-nifi-를-활용한-iot-데이터-파이프라인>사례 5: Apache NiFi 를 활용한 IoT 데이터 파이프라인<a hidden class=anchor aria-hidden=true href=#사례-5-apache-nifi-를-활용한-iot-데이터-파이프라인>#</a></h4><p>Apache NiFi 는 대표적인 Pipe-and-Filter Architecture 기반의 데이터 통합 플랫폼.<br>IoT 센서 데이터를 실시간으로 수집, 처리, 분석하는 시스템에서 활용되었다.</p><p><strong>시스템 구성:</strong></p><ul><li><strong>데이터 소스:</strong> 온도, 습도, 압력 센서 (MQTT 프로토콜)</li><li><strong>수집 계층:</strong> NiFi ConsumeMQTT 프로세서</li><li><strong>처리 계층:</strong> 데이터 변환, 검증, 집계 프로세서들</li><li><strong>저장 계층:</strong> InfluxDB, Elasticsearch</li><li><strong>시각화:</strong> Grafana 대시보드</li></ul><p><strong>시스템 구성 다이어그램:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11>11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12>12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13>13</a>
</span><span class=lnt id=hl-16-14><a class=lnlinks href=#hl-16-14>14</a>
</span><span class=lnt id=hl-16-15><a class=lnlinks href=#hl-16-15>15</a>
</span><span class=lnt id=hl-16-16><a class=lnlinks href=#hl-16-16>16</a>
</span><span class=lnt id=hl-16-17><a class=lnlinks href=#hl-16-17>17</a>
</span><span class=lnt id=hl-16-18><a class=lnlinks href=#hl-16-18>18</a>
</span><span class=lnt id=hl-16-19><a class=lnlinks href=#hl-16-19>19</a>
</span><span class=lnt id=hl-16-20><a class=lnlinks href=#hl-16-20>20</a>
</span><span class=lnt id=hl-16-21><a class=lnlinks href=#hl-16-21>21</a>
</span><span class=lnt id=hl-16-22><a class=lnlinks href=#hl-16-22>22</a>
</span><span class=lnt id=hl-16-23><a class=lnlinks href=#hl-16-23>23</a>
</span><span class=lnt id=hl-16-24><a class=lnlinks href=#hl-16-24>24</a>
</span><span class=lnt id=hl-16-25><a class=lnlinks href=#hl-16-25>25</a>
</span><span class=lnt id=hl-16-26><a class=lnlinks href=#hl-16-26>26</a>
</span><span class=lnt id=hl-16-27><a class=lnlinks href=#hl-16-27>27</a>
</span><span class=lnt id=hl-16-28><a class=lnlinks href=#hl-16-28>28</a>
</span><span class=lnt id=hl-16-29><a class=lnlinks href=#hl-16-29>29</a>
</span><span class=lnt id=hl-16-30><a class=lnlinks href=#hl-16-30>30</a>
</span><span class=lnt id=hl-16-31><a class=lnlinks href=#hl-16-31>31</a>
</span><span class=lnt id=hl-16-32><a class=lnlinks href=#hl-16-32>32</a>
</span><span class=lnt id=hl-16-33><a class=lnlinks href=#hl-16-33>33</a>
</span><span class=lnt id=hl-16-34><a class=lnlinks href=#hl-16-34>34</a>
</span><span class=lnt id=hl-16-35><a class=lnlinks href=#hl-16-35>35</a>
</span><span class=lnt id=hl-16-36><a class=lnlinks href=#hl-16-36>36</a>
</span><span class=lnt id=hl-16-37><a class=lnlinks href=#hl-16-37>37</a>
</span><span class=lnt id=hl-16-38><a class=lnlinks href=#hl-16-38>38</a>
</span><span class=lnt id=hl-16-39><a class=lnlinks href=#hl-16-39>39</a>
</span><span class=lnt id=hl-16-40><a class=lnlinks href=#hl-16-40>40</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>graph TB
</span></span><span class=line><span class=cl>    subgraph &#34;IoT Sensor Network&#34;
</span></span><span class=line><span class=cl>        S1[Temperature Sensor]
</span></span><span class=line><span class=cl>        S2[Humidity Sensor]
</span></span><span class=line><span class=cl>        S3[Pressure Sensor]
</span></span><span class=line><span class=cl>    end
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    subgraph &#34;NiFi Pipeline&#34;
</span></span><span class=line><span class=cl>        MQTT[ConsumeMQTT]
</span></span><span class=line><span class=cl>        JSON[EvaluateJsonPath]
</span></span><span class=line><span class=cl>        SPLIT[SplitJson]
</span></span><span class=line><span class=cl>        ROUTE[RouteOnAttribute]
</span></span><span class=line><span class=cl>        TRANS[JoltTransformJSON]
</span></span><span class=line><span class=cl>        VALID[ValidateRecord]
</span></span><span class=line><span class=cl>        ENRICH[EnrichData]
</span></span><span class=line><span class=cl>        AGG[MergeRecord]
</span></span><span class=line><span class=cl>    end
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    subgraph &#34;Storage &amp; Analytics&#34;
</span></span><span class=line><span class=cl>        INFLUX[InfluxDB]
</span></span><span class=line><span class=cl>        ES[Elasticsearch]
</span></span><span class=line><span class=cl>        GRAFANA[Grafana]
</span></span><span class=line><span class=cl>    end
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    S1 --&gt; MQTT
</span></span><span class=line><span class=cl>    S2 --&gt; MQTT
</span></span><span class=line><span class=cl>    S3 --&gt; MQTT
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    MQTT --&gt; JSON
</span></span><span class=line><span class=cl>    JSON --&gt; SPLIT
</span></span><span class=line><span class=cl>    SPLIT --&gt; ROUTE
</span></span><span class=line><span class=cl>    ROUTE --&gt; TRANS
</span></span><span class=line><span class=cl>    TRANS --&gt; VALID
</span></span><span class=line><span class=cl>    VALID --&gt; ENRICH
</span></span><span class=line><span class=cl>    ENRICH --&gt; AGG
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    AGG --&gt; INFLUX
</span></span><span class=line><span class=cl>    AGG --&gt; ES
</span></span><span class=line><span class=cl>    INFLUX --&gt; GRAFANA
</span></span><span class=line><span class=cl>    ES --&gt; GRAFANA
</span></span></code></pre></td></tr></table></div></div><p><strong>Workflow:</strong></p><ol><li><strong>데이터 수집:</strong> MQTT 브로커에서 센서 데이터 실시간 구독</li><li><strong>데이터 파싱:</strong> JSON 구조 분석 및 필드 추출</li><li><strong>데이터 분할:</strong> 센서 타입별로 데이터 스트림 분리</li><li><strong>조건부 라우팅:</strong> 센서 타입에 따른 처리 경로 선택</li><li><strong>데이터 변환:</strong> 표준 포맷으로 스키마 변환</li><li><strong>데이터 검증:</strong> 범위 체크 및 이상 데이터 필터링</li><li><strong>데이터 보강:</strong> 메타데이터 추가 (위치 정보, 타임스탬프)</li><li><strong>배치 처리:</strong> 시계열 데이터를 배치 단위로 그룹화</li><li><strong>데이터 저장:</strong> 실시간 데이터베이스와 검색 엔진에 병렬 저장</li></ol><p><strong>Pipe-and-Filter Architecture 의 역할:</strong></p><ul><li><strong>모듈성:</strong> 각 NiFi 프로세서가 독립적인 필터 역할</li><li><strong>재사용성:</strong> 동일한 프로세서를 다른 데이터 타입에 재활용</li><li><strong>확장성:</strong> 새로운 센서 타입 추가 시 프로세서만 추가</li><li><strong>신뢰성:</strong> 각 단계별 오류 처리 및 복구 메커니즘</li><li><strong>모니터링:</strong> 실시간 데이터 흐름 시각화 및 성능 모니터링</li></ul><p><strong>아키텍처 유무에 따른 차이점:</strong></p><ul><li><strong>Pipe-and-Filter 적용 시:</strong><ul><li>각 처리 단계가 명확히 분리되어 디버깅 용이</li><li>새로운 요구사항에 대한 빠른 대응 가능</li><li>실시간 모니터링과 성능 튜닝 지원</li><li>장애 발생 시 특정 단계에서 복구 가능</li></ul></li><li><strong>기존 모놀리식 접근 시:</strong><ul><li>전체 시스템을 하나의 애플리케이션으로 개발 필요</li><li>요구사항 변경 시 전체 코드 수정 필요</li><li>특정 부분의 성능 문제 파악 어려움</li><li>장애 발생 시 전체 시스템 재시작 필요</li></ul></li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1>  1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2>  2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3>  3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4>  4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5>  5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6>  6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7>  7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8>  8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9>  9</a>
</span><span class=lnt id=hl-17-10><a class=lnlinks href=#hl-17-10> 10</a>
</span><span class=lnt id=hl-17-11><a class=lnlinks href=#hl-17-11> 11</a>
</span><span class=lnt id=hl-17-12><a class=lnlinks href=#hl-17-12> 12</a>
</span><span class=lnt id=hl-17-13><a class=lnlinks href=#hl-17-13> 13</a>
</span><span class=lnt id=hl-17-14><a class=lnlinks href=#hl-17-14> 14</a>
</span><span class=lnt id=hl-17-15><a class=lnlinks href=#hl-17-15> 15</a>
</span><span class=lnt id=hl-17-16><a class=lnlinks href=#hl-17-16> 16</a>
</span><span class=lnt id=hl-17-17><a class=lnlinks href=#hl-17-17> 17</a>
</span><span class=lnt id=hl-17-18><a class=lnlinks href=#hl-17-18> 18</a>
</span><span class=lnt id=hl-17-19><a class=lnlinks href=#hl-17-19> 19</a>
</span><span class=lnt id=hl-17-20><a class=lnlinks href=#hl-17-20> 20</a>
</span><span class=lnt id=hl-17-21><a class=lnlinks href=#hl-17-21> 21</a>
</span><span class=lnt id=hl-17-22><a class=lnlinks href=#hl-17-22> 22</a>
</span><span class=lnt id=hl-17-23><a class=lnlinks href=#hl-17-23> 23</a>
</span><span class=lnt id=hl-17-24><a class=lnlinks href=#hl-17-24> 24</a>
</span><span class=lnt id=hl-17-25><a class=lnlinks href=#hl-17-25> 25</a>
</span><span class=lnt id=hl-17-26><a class=lnlinks href=#hl-17-26> 26</a>
</span><span class=lnt id=hl-17-27><a class=lnlinks href=#hl-17-27> 27</a>
</span><span class=lnt id=hl-17-28><a class=lnlinks href=#hl-17-28> 28</a>
</span><span class=lnt id=hl-17-29><a class=lnlinks href=#hl-17-29> 29</a>
</span><span class=lnt id=hl-17-30><a class=lnlinks href=#hl-17-30> 30</a>
</span><span class=lnt id=hl-17-31><a class=lnlinks href=#hl-17-31> 31</a>
</span><span class=lnt id=hl-17-32><a class=lnlinks href=#hl-17-32> 32</a>
</span><span class=lnt id=hl-17-33><a class=lnlinks href=#hl-17-33> 33</a>
</span><span class=lnt id=hl-17-34><a class=lnlinks href=#hl-17-34> 34</a>
</span><span class=lnt id=hl-17-35><a class=lnlinks href=#hl-17-35> 35</a>
</span><span class=lnt id=hl-17-36><a class=lnlinks href=#hl-17-36> 36</a>
</span><span class=lnt id=hl-17-37><a class=lnlinks href=#hl-17-37> 37</a>
</span><span class=lnt id=hl-17-38><a class=lnlinks href=#hl-17-38> 38</a>
</span><span class=lnt id=hl-17-39><a class=lnlinks href=#hl-17-39> 39</a>
</span><span class=lnt id=hl-17-40><a class=lnlinks href=#hl-17-40> 40</a>
</span><span class=lnt id=hl-17-41><a class=lnlinks href=#hl-17-41> 41</a>
</span><span class=lnt id=hl-17-42><a class=lnlinks href=#hl-17-42> 42</a>
</span><span class=lnt id=hl-17-43><a class=lnlinks href=#hl-17-43> 43</a>
</span><span class=lnt id=hl-17-44><a class=lnlinks href=#hl-17-44> 44</a>
</span><span class=lnt id=hl-17-45><a class=lnlinks href=#hl-17-45> 45</a>
</span><span class=lnt id=hl-17-46><a class=lnlinks href=#hl-17-46> 46</a>
</span><span class=lnt id=hl-17-47><a class=lnlinks href=#hl-17-47> 47</a>
</span><span class=lnt id=hl-17-48><a class=lnlinks href=#hl-17-48> 48</a>
</span><span class=lnt id=hl-17-49><a class=lnlinks href=#hl-17-49> 49</a>
</span><span class=lnt id=hl-17-50><a class=lnlinks href=#hl-17-50> 50</a>
</span><span class=lnt id=hl-17-51><a class=lnlinks href=#hl-17-51> 51</a>
</span><span class=lnt id=hl-17-52><a class=lnlinks href=#hl-17-52> 52</a>
</span><span class=lnt id=hl-17-53><a class=lnlinks href=#hl-17-53> 53</a>
</span><span class=lnt id=hl-17-54><a class=lnlinks href=#hl-17-54> 54</a>
</span><span class=lnt id=hl-17-55><a class=lnlinks href=#hl-17-55> 55</a>
</span><span class=lnt id=hl-17-56><a class=lnlinks href=#hl-17-56> 56</a>
</span><span class=lnt id=hl-17-57><a class=lnlinks href=#hl-17-57> 57</a>
</span><span class=lnt id=hl-17-58><a class=lnlinks href=#hl-17-58> 58</a>
</span><span class=lnt id=hl-17-59><a class=lnlinks href=#hl-17-59> 59</a>
</span><span class=lnt id=hl-17-60><a class=lnlinks href=#hl-17-60> 60</a>
</span><span class=lnt id=hl-17-61><a class=lnlinks href=#hl-17-61> 61</a>
</span><span class=lnt id=hl-17-62><a class=lnlinks href=#hl-17-62> 62</a>
</span><span class=lnt id=hl-17-63><a class=lnlinks href=#hl-17-63> 63</a>
</span><span class=lnt id=hl-17-64><a class=lnlinks href=#hl-17-64> 64</a>
</span><span class=lnt id=hl-17-65><a class=lnlinks href=#hl-17-65> 65</a>
</span><span class=lnt id=hl-17-66><a class=lnlinks href=#hl-17-66> 66</a>
</span><span class=lnt id=hl-17-67><a class=lnlinks href=#hl-17-67> 67</a>
</span><span class=lnt id=hl-17-68><a class=lnlinks href=#hl-17-68> 68</a>
</span><span class=lnt id=hl-17-69><a class=lnlinks href=#hl-17-69> 69</a>
</span><span class=lnt id=hl-17-70><a class=lnlinks href=#hl-17-70> 70</a>
</span><span class=lnt id=hl-17-71><a class=lnlinks href=#hl-17-71> 71</a>
</span><span class=lnt id=hl-17-72><a class=lnlinks href=#hl-17-72> 72</a>
</span><span class=lnt id=hl-17-73><a class=lnlinks href=#hl-17-73> 73</a>
</span><span class=lnt id=hl-17-74><a class=lnlinks href=#hl-17-74> 74</a>
</span><span class=lnt id=hl-17-75><a class=lnlinks href=#hl-17-75> 75</a>
</span><span class=lnt id=hl-17-76><a class=lnlinks href=#hl-17-76> 76</a>
</span><span class=lnt id=hl-17-77><a class=lnlinks href=#hl-17-77> 77</a>
</span><span class=lnt id=hl-17-78><a class=lnlinks href=#hl-17-78> 78</a>
</span><span class=lnt id=hl-17-79><a class=lnlinks href=#hl-17-79> 79</a>
</span><span class=lnt id=hl-17-80><a class=lnlinks href=#hl-17-80> 80</a>
</span><span class=lnt id=hl-17-81><a class=lnlinks href=#hl-17-81> 81</a>
</span><span class=lnt id=hl-17-82><a class=lnlinks href=#hl-17-82> 82</a>
</span><span class=lnt id=hl-17-83><a class=lnlinks href=#hl-17-83> 83</a>
</span><span class=lnt id=hl-17-84><a class=lnlinks href=#hl-17-84> 84</a>
</span><span class=lnt id=hl-17-85><a class=lnlinks href=#hl-17-85> 85</a>
</span><span class=lnt id=hl-17-86><a class=lnlinks href=#hl-17-86> 86</a>
</span><span class=lnt id=hl-17-87><a class=lnlinks href=#hl-17-87> 87</a>
</span><span class=lnt id=hl-17-88><a class=lnlinks href=#hl-17-88> 88</a>
</span><span class=lnt id=hl-17-89><a class=lnlinks href=#hl-17-89> 89</a>
</span><span class=lnt id=hl-17-90><a class=lnlinks href=#hl-17-90> 90</a>
</span><span class=lnt id=hl-17-91><a class=lnlinks href=#hl-17-91> 91</a>
</span><span class=lnt id=hl-17-92><a class=lnlinks href=#hl-17-92> 92</a>
</span><span class=lnt id=hl-17-93><a class=lnlinks href=#hl-17-93> 93</a>
</span><span class=lnt id=hl-17-94><a class=lnlinks href=#hl-17-94> 94</a>
</span><span class=lnt id=hl-17-95><a class=lnlinks href=#hl-17-95> 95</a>
</span><span class=lnt id=hl-17-96><a class=lnlinks href=#hl-17-96> 96</a>
</span><span class=lnt id=hl-17-97><a class=lnlinks href=#hl-17-97> 97</a>
</span><span class=lnt id=hl-17-98><a class=lnlinks href=#hl-17-98> 98</a>
</span><span class=lnt id=hl-17-99><a class=lnlinks href=#hl-17-99> 99</a>
</span><span class=lnt id=hl-17-100><a class=lnlinks href=#hl-17-100>100</a>
</span><span class=lnt id=hl-17-101><a class=lnlinks href=#hl-17-101>101</a>
</span><span class=lnt id=hl-17-102><a class=lnlinks href=#hl-17-102>102</a>
</span><span class=lnt id=hl-17-103><a class=lnlinks href=#hl-17-103>103</a>
</span><span class=lnt id=hl-17-104><a class=lnlinks href=#hl-17-104>104</a>
</span><span class=lnt id=hl-17-105><a class=lnlinks href=#hl-17-105>105</a>
</span><span class=lnt id=hl-17-106><a class=lnlinks href=#hl-17-106>106</a>
</span><span class=lnt id=hl-17-107><a class=lnlinks href=#hl-17-107>107</a>
</span><span class=lnt id=hl-17-108><a class=lnlinks href=#hl-17-108>108</a>
</span><span class=lnt id=hl-17-109><a class=lnlinks href=#hl-17-109>109</a>
</span><span class=lnt id=hl-17-110><a class=lnlinks href=#hl-17-110>110</a>
</span><span class=lnt id=hl-17-111><a class=lnlinks href=#hl-17-111>111</a>
</span><span class=lnt id=hl-17-112><a class=lnlinks href=#hl-17-112>112</a>
</span><span class=lnt id=hl-17-113><a class=lnlinks href=#hl-17-113>113</a>
</span><span class=lnt id=hl-17-114><a class=lnlinks href=#hl-17-114>114</a>
</span><span class=lnt id=hl-17-115><a class=lnlinks href=#hl-17-115>115</a>
</span><span class=lnt id=hl-17-116><a class=lnlinks href=#hl-17-116>116</a>
</span><span class=lnt id=hl-17-117><a class=lnlinks href=#hl-17-117>117</a>
</span><span class=lnt id=hl-17-118><a class=lnlinks href=#hl-17-118>118</a>
</span><span class=lnt id=hl-17-119><a class=lnlinks href=#hl-17-119>119</a>
</span><span class=lnt id=hl-17-120><a class=lnlinks href=#hl-17-120>120</a>
</span><span class=lnt id=hl-17-121><a class=lnlinks href=#hl-17-121>121</a>
</span><span class=lnt id=hl-17-122><a class=lnlinks href=#hl-17-122>122</a>
</span><span class=lnt id=hl-17-123><a class=lnlinks href=#hl-17-123>123</a>
</span><span class=lnt id=hl-17-124><a class=lnlinks href=#hl-17-124>124</a>
</span><span class=lnt id=hl-17-125><a class=lnlinks href=#hl-17-125>125</a>
</span><span class=lnt id=hl-17-126><a class=lnlinks href=#hl-17-126>126</a>
</span><span class=lnt id=hl-17-127><a class=lnlinks href=#hl-17-127>127</a>
</span><span class=lnt id=hl-17-128><a class=lnlinks href=#hl-17-128>128</a>
</span><span class=lnt id=hl-17-129><a class=lnlinks href=#hl-17-129>129</a>
</span><span class=lnt id=hl-17-130><a class=lnlinks href=#hl-17-130>130</a>
</span><span class=lnt id=hl-17-131><a class=lnlinks href=#hl-17-131>131</a>
</span><span class=lnt id=hl-17-132><a class=lnlinks href=#hl-17-132>132</a>
</span><span class=lnt id=hl-17-133><a class=lnlinks href=#hl-17-133>133</a>
</span><span class=lnt id=hl-17-134><a class=lnlinks href=#hl-17-134>134</a>
</span><span class=lnt id=hl-17-135><a class=lnlinks href=#hl-17-135>135</a>
</span><span class=lnt id=hl-17-136><a class=lnlinks href=#hl-17-136>136</a>
</span><span class=lnt id=hl-17-137><a class=lnlinks href=#hl-17-137>137</a>
</span><span class=lnt id=hl-17-138><a class=lnlinks href=#hl-17-138>138</a>
</span><span class=lnt id=hl-17-139><a class=lnlinks href=#hl-17-139>139</a>
</span><span class=lnt id=hl-17-140><a class=lnlinks href=#hl-17-140>140</a>
</span><span class=lnt id=hl-17-141><a class=lnlinks href=#hl-17-141>141</a>
</span><span class=lnt id=hl-17-142><a class=lnlinks href=#hl-17-142>142</a>
</span><span class=lnt id=hl-17-143><a class=lnlinks href=#hl-17-143>143</a>
</span><span class=lnt id=hl-17-144><a class=lnlinks href=#hl-17-144>144</a>
</span><span class=lnt id=hl-17-145><a class=lnlinks href=#hl-17-145>145</a>
</span><span class=lnt id=hl-17-146><a class=lnlinks href=#hl-17-146>146</a>
</span><span class=lnt id=hl-17-147><a class=lnlinks href=#hl-17-147>147</a>
</span><span class=lnt id=hl-17-148><a class=lnlinks href=#hl-17-148>148</a>
</span><span class=lnt id=hl-17-149><a class=lnlinks href=#hl-17-149>149</a>
</span><span class=lnt id=hl-17-150><a class=lnlinks href=#hl-17-150>150</a>
</span><span class=lnt id=hl-17-151><a class=lnlinks href=#hl-17-151>151</a>
</span><span class=lnt id=hl-17-152><a class=lnlinks href=#hl-17-152>152</a>
</span><span class=lnt id=hl-17-153><a class=lnlinks href=#hl-17-153>153</a>
</span><span class=lnt id=hl-17-154><a class=lnlinks href=#hl-17-154>154</a>
</span><span class=lnt id=hl-17-155><a class=lnlinks href=#hl-17-155>155</a>
</span><span class=lnt id=hl-17-156><a class=lnlinks href=#hl-17-156>156</a>
</span><span class=lnt id=hl-17-157><a class=lnlinks href=#hl-17-157>157</a>
</span><span class=lnt id=hl-17-158><a class=lnlinks href=#hl-17-158>158</a>
</span><span class=lnt id=hl-17-159><a class=lnlinks href=#hl-17-159>159</a>
</span><span class=lnt id=hl-17-160><a class=lnlinks href=#hl-17-160>160</a>
</span><span class=lnt id=hl-17-161><a class=lnlinks href=#hl-17-161>161</a>
</span><span class=lnt id=hl-17-162><a class=lnlinks href=#hl-17-162>162</a>
</span><span class=lnt id=hl-17-163><a class=lnlinks href=#hl-17-163>163</a>
</span><span class=lnt id=hl-17-164><a class=lnlinks href=#hl-17-164>164</a>
</span><span class=lnt id=hl-17-165><a class=lnlinks href=#hl-17-165>165</a>
</span><span class=lnt id=hl-17-166><a class=lnlinks href=#hl-17-166>166</a>
</span><span class=lnt id=hl-17-167><a class=lnlinks href=#hl-17-167>167</a>
</span><span class=lnt id=hl-17-168><a class=lnlinks href=#hl-17-168>168</a>
</span><span class=lnt id=hl-17-169><a class=lnlinks href=#hl-17-169>169</a>
</span><span class=lnt id=hl-17-170><a class=lnlinks href=#hl-17-170>170</a>
</span><span class=lnt id=hl-17-171><a class=lnlinks href=#hl-17-171>171</a>
</span><span class=lnt id=hl-17-172><a class=lnlinks href=#hl-17-172>172</a>
</span><span class=lnt id=hl-17-173><a class=lnlinks href=#hl-17-173>173</a>
</span><span class=lnt id=hl-17-174><a class=lnlinks href=#hl-17-174>174</a>
</span><span class=lnt id=hl-17-175><a class=lnlinks href=#hl-17-175>175</a>
</span><span class=lnt id=hl-17-176><a class=lnlinks href=#hl-17-176>176</a>
</span><span class=lnt id=hl-17-177><a class=lnlinks href=#hl-17-177>177</a>
</span><span class=lnt id=hl-17-178><a class=lnlinks href=#hl-17-178>178</a>
</span><span class=lnt id=hl-17-179><a class=lnlinks href=#hl-17-179>179</a>
</span><span class=lnt id=hl-17-180><a class=lnlinks href=#hl-17-180>180</a>
</span><span class=lnt id=hl-17-181><a class=lnlinks href=#hl-17-181>181</a>
</span><span class=lnt id=hl-17-182><a class=lnlinks href=#hl-17-182>182</a>
</span><span class=lnt id=hl-17-183><a class=lnlinks href=#hl-17-183>183</a>
</span><span class=lnt id=hl-17-184><a class=lnlinks href=#hl-17-184>184</a>
</span><span class=lnt id=hl-17-185><a class=lnlinks href=#hl-17-185>185</a>
</span><span class=lnt id=hl-17-186><a class=lnlinks href=#hl-17-186>186</a>
</span><span class=lnt id=hl-17-187><a class=lnlinks href=#hl-17-187>187</a>
</span><span class=lnt id=hl-17-188><a class=lnlinks href=#hl-17-188>188</a>
</span><span class=lnt id=hl-17-189><a class=lnlinks href=#hl-17-189>189</a>
</span><span class=lnt id=hl-17-190><a class=lnlinks href=#hl-17-190>190</a>
</span><span class=lnt id=hl-17-191><a class=lnlinks href=#hl-17-191>191</a>
</span><span class=lnt id=hl-17-192><a class=lnlinks href=#hl-17-192>192</a>
</span><span class=lnt id=hl-17-193><a class=lnlinks href=#hl-17-193>193</a>
</span><span class=lnt id=hl-17-194><a class=lnlinks href=#hl-17-194>194</a>
</span><span class=lnt id=hl-17-195><a class=lnlinks href=#hl-17-195>195</a>
</span><span class=lnt id=hl-17-196><a class=lnlinks href=#hl-17-196>196</a>
</span><span class=lnt id=hl-17-197><a class=lnlinks href=#hl-17-197>197</a>
</span><span class=lnt id=hl-17-198><a class=lnlinks href=#hl-17-198>198</a>
</span><span class=lnt id=hl-17-199><a class=lnlinks href=#hl-17-199>199</a>
</span><span class=lnt id=hl-17-200><a class=lnlinks href=#hl-17-200>200</a>
</span><span class=lnt id=hl-17-201><a class=lnlinks href=#hl-17-201>201</a>
</span><span class=lnt id=hl-17-202><a class=lnlinks href=#hl-17-202>202</a>
</span><span class=lnt id=hl-17-203><a class=lnlinks href=#hl-17-203>203</a>
</span><span class=lnt id=hl-17-204><a class=lnlinks href=#hl-17-204>204</a>
</span><span class=lnt id=hl-17-205><a class=lnlinks href=#hl-17-205>205</a>
</span><span class=lnt id=hl-17-206><a class=lnlinks href=#hl-17-206>206</a>
</span><span class=lnt id=hl-17-207><a class=lnlinks href=#hl-17-207>207</a>
</span><span class=lnt id=hl-17-208><a class=lnlinks href=#hl-17-208>208</a>
</span><span class=lnt id=hl-17-209><a class=lnlinks href=#hl-17-209>209</a>
</span><span class=lnt id=hl-17-210><a class=lnlinks href=#hl-17-210>210</a>
</span><span class=lnt id=hl-17-211><a class=lnlinks href=#hl-17-211>211</a>
</span><span class=lnt id=hl-17-212><a class=lnlinks href=#hl-17-212>212</a>
</span><span class=lnt id=hl-17-213><a class=lnlinks href=#hl-17-213>213</a>
</span><span class=lnt id=hl-17-214><a class=lnlinks href=#hl-17-214>214</a>
</span><span class=lnt id=hl-17-215><a class=lnlinks href=#hl-17-215>215</a>
</span><span class=lnt id=hl-17-216><a class=lnlinks href=#hl-17-216>216</a>
</span><span class=lnt id=hl-17-217><a class=lnlinks href=#hl-17-217>217</a>
</span><span class=lnt id=hl-17-218><a class=lnlinks href=#hl-17-218>218</a>
</span><span class=lnt id=hl-17-219><a class=lnlinks href=#hl-17-219>219</a>
</span><span class=lnt id=hl-17-220><a class=lnlinks href=#hl-17-220>220</a>
</span><span class=lnt id=hl-17-221><a class=lnlinks href=#hl-17-221>221</a>
</span><span class=lnt id=hl-17-222><a class=lnlinks href=#hl-17-222>222</a>
</span><span class=lnt id=hl-17-223><a class=lnlinks href=#hl-17-223>223</a>
</span><span class=lnt id=hl-17-224><a class=lnlinks href=#hl-17-224>224</a>
</span><span class=lnt id=hl-17-225><a class=lnlinks href=#hl-17-225>225</a>
</span><span class=lnt id=hl-17-226><a class=lnlinks href=#hl-17-226>226</a>
</span><span class=lnt id=hl-17-227><a class=lnlinks href=#hl-17-227>227</a>
</span><span class=lnt id=hl-17-228><a class=lnlinks href=#hl-17-228>228</a>
</span><span class=lnt id=hl-17-229><a class=lnlinks href=#hl-17-229>229</a>
</span><span class=lnt id=hl-17-230><a class=lnlinks href=#hl-17-230>230</a>
</span><span class=lnt id=hl-17-231><a class=lnlinks href=#hl-17-231>231</a>
</span><span class=lnt id=hl-17-232><a class=lnlinks href=#hl-17-232>232</a>
</span><span class=lnt id=hl-17-233><a class=lnlinks href=#hl-17-233>233</a>
</span><span class=lnt id=hl-17-234><a class=lnlinks href=#hl-17-234>234</a>
</span><span class=lnt id=hl-17-235><a class=lnlinks href=#hl-17-235>235</a>
</span><span class=lnt id=hl-17-236><a class=lnlinks href=#hl-17-236>236</a>
</span><span class=lnt id=hl-17-237><a class=lnlinks href=#hl-17-237>237</a>
</span><span class=lnt id=hl-17-238><a class=lnlinks href=#hl-17-238>238</a>
</span><span class=lnt id=hl-17-239><a class=lnlinks href=#hl-17-239>239</a>
</span><span class=lnt id=hl-17-240><a class=lnlinks href=#hl-17-240>240</a>
</span><span class=lnt id=hl-17-241><a class=lnlinks href=#hl-17-241>241</a>
</span><span class=lnt id=hl-17-242><a class=lnlinks href=#hl-17-242>242</a>
</span><span class=lnt id=hl-17-243><a class=lnlinks href=#hl-17-243>243</a>
</span><span class=lnt id=hl-17-244><a class=lnlinks href=#hl-17-244>244</a>
</span><span class=lnt id=hl-17-245><a class=lnlinks href=#hl-17-245>245</a>
</span><span class=lnt id=hl-17-246><a class=lnlinks href=#hl-17-246>246</a>
</span><span class=lnt id=hl-17-247><a class=lnlinks href=#hl-17-247>247</a>
</span><span class=lnt id=hl-17-248><a class=lnlinks href=#hl-17-248>248</a>
</span><span class=lnt id=hl-17-249><a class=lnlinks href=#hl-17-249>249</a>
</span><span class=lnt id=hl-17-250><a class=lnlinks href=#hl-17-250>250</a>
</span><span class=lnt id=hl-17-251><a class=lnlinks href=#hl-17-251>251</a>
</span><span class=lnt id=hl-17-252><a class=lnlinks href=#hl-17-252>252</a>
</span><span class=lnt id=hl-17-253><a class=lnlinks href=#hl-17-253>253</a>
</span><span class=lnt id=hl-17-254><a class=lnlinks href=#hl-17-254>254</a>
</span><span class=lnt id=hl-17-255><a class=lnlinks href=#hl-17-255>255</a>
</span><span class=lnt id=hl-17-256><a class=lnlinks href=#hl-17-256>256</a>
</span><span class=lnt id=hl-17-257><a class=lnlinks href=#hl-17-257>257</a>
</span><span class=lnt id=hl-17-258><a class=lnlinks href=#hl-17-258>258</a>
</span><span class=lnt id=hl-17-259><a class=lnlinks href=#hl-17-259>259</a>
</span><span class=lnt id=hl-17-260><a class=lnlinks href=#hl-17-260>260</a>
</span><span class=lnt id=hl-17-261><a class=lnlinks href=#hl-17-261>261</a>
</span><span class=lnt id=hl-17-262><a class=lnlinks href=#hl-17-262>262</a>
</span><span class=lnt id=hl-17-263><a class=lnlinks href=#hl-17-263>263</a>
</span><span class=lnt id=hl-17-264><a class=lnlinks href=#hl-17-264>264</a>
</span><span class=lnt id=hl-17-265><a class=lnlinks href=#hl-17-265>265</a>
</span><span class=lnt id=hl-17-266><a class=lnlinks href=#hl-17-266>266</a>
</span><span class=lnt id=hl-17-267><a class=lnlinks href=#hl-17-267>267</a>
</span><span class=lnt id=hl-17-268><a class=lnlinks href=#hl-17-268>268</a>
</span><span class=lnt id=hl-17-269><a class=lnlinks href=#hl-17-269>269</a>
</span><span class=lnt id=hl-17-270><a class=lnlinks href=#hl-17-270>270</a>
</span><span class=lnt id=hl-17-271><a class=lnlinks href=#hl-17-271>271</a>
</span><span class=lnt id=hl-17-272><a class=lnlinks href=#hl-17-272>272</a>
</span><span class=lnt id=hl-17-273><a class=lnlinks href=#hl-17-273>273</a>
</span><span class=lnt id=hl-17-274><a class=lnlinks href=#hl-17-274>274</a>
</span><span class=lnt id=hl-17-275><a class=lnlinks href=#hl-17-275>275</a>
</span><span class=lnt id=hl-17-276><a class=lnlinks href=#hl-17-276>276</a>
</span><span class=lnt id=hl-17-277><a class=lnlinks href=#hl-17-277>277</a>
</span><span class=lnt id=hl-17-278><a class=lnlinks href=#hl-17-278>278</a>
</span><span class=lnt id=hl-17-279><a class=lnlinks href=#hl-17-279>279</a>
</span><span class=lnt id=hl-17-280><a class=lnlinks href=#hl-17-280>280</a>
</span><span class=lnt id=hl-17-281><a class=lnlinks href=#hl-17-281>281</a>
</span><span class=lnt id=hl-17-282><a class=lnlinks href=#hl-17-282>282</a>
</span><span class=lnt id=hl-17-283><a class=lnlinks href=#hl-17-283>283</a>
</span><span class=lnt id=hl-17-284><a class=lnlinks href=#hl-17-284>284</a>
</span><span class=lnt id=hl-17-285><a class=lnlinks href=#hl-17-285>285</a>
</span><span class=lnt id=hl-17-286><a class=lnlinks href=#hl-17-286>286</a>
</span><span class=lnt id=hl-17-287><a class=lnlinks href=#hl-17-287>287</a>
</span><span class=lnt id=hl-17-288><a class=lnlinks href=#hl-17-288>288</a>
</span><span class=lnt id=hl-17-289><a class=lnlinks href=#hl-17-289>289</a>
</span><span class=lnt id=hl-17-290><a class=lnlinks href=#hl-17-290>290</a>
</span><span class=lnt id=hl-17-291><a class=lnlinks href=#hl-17-291>291</a>
</span><span class=lnt id=hl-17-292><a class=lnlinks href=#hl-17-292>292</a>
</span><span class=lnt id=hl-17-293><a class=lnlinks href=#hl-17-293>293</a>
</span><span class=lnt id=hl-17-294><a class=lnlinks href=#hl-17-294>294</a>
</span><span class=lnt id=hl-17-295><a class=lnlinks href=#hl-17-295>295</a>
</span><span class=lnt id=hl-17-296><a class=lnlinks href=#hl-17-296>296</a>
</span><span class=lnt id=hl-17-297><a class=lnlinks href=#hl-17-297>297</a>
</span><span class=lnt id=hl-17-298><a class=lnlinks href=#hl-17-298>298</a>
</span><span class=lnt id=hl-17-299><a class=lnlinks href=#hl-17-299>299</a>
</span><span class=lnt id=hl-17-300><a class=lnlinks href=#hl-17-300>300</a>
</span><span class=lnt id=hl-17-301><a class=lnlinks href=#hl-17-301>301</a>
</span><span class=lnt id=hl-17-302><a class=lnlinks href=#hl-17-302>302</a>
</span><span class=lnt id=hl-17-303><a class=lnlinks href=#hl-17-303>303</a>
</span><span class=lnt id=hl-17-304><a class=lnlinks href=#hl-17-304>304</a>
</span><span class=lnt id=hl-17-305><a class=lnlinks href=#hl-17-305>305</a>
</span><span class=lnt id=hl-17-306><a class=lnlinks href=#hl-17-306>306</a>
</span><span class=lnt id=hl-17-307><a class=lnlinks href=#hl-17-307>307</a>
</span><span class=lnt id=hl-17-308><a class=lnlinks href=#hl-17-308>308</a>
</span><span class=lnt id=hl-17-309><a class=lnlinks href=#hl-17-309>309</a>
</span><span class=lnt id=hl-17-310><a class=lnlinks href=#hl-17-310>310</a>
</span><span class=lnt id=hl-17-311><a class=lnlinks href=#hl-17-311>311</a>
</span><span class=lnt id=hl-17-312><a class=lnlinks href=#hl-17-312>312</a>
</span><span class=lnt id=hl-17-313><a class=lnlinks href=#hl-17-313>313</a>
</span><span class=lnt id=hl-17-314><a class=lnlinks href=#hl-17-314>314</a>
</span><span class=lnt id=hl-17-315><a class=lnlinks href=#hl-17-315>315</a>
</span><span class=lnt id=hl-17-316><a class=lnlinks href=#hl-17-316>316</a>
</span><span class=lnt id=hl-17-317><a class=lnlinks href=#hl-17-317>317</a>
</span><span class=lnt id=hl-17-318><a class=lnlinks href=#hl-17-318>318</a>
</span><span class=lnt id=hl-17-319><a class=lnlinks href=#hl-17-319>319</a>
</span><span class=lnt id=hl-17-320><a class=lnlinks href=#hl-17-320>320</a>
</span><span class=lnt id=hl-17-321><a class=lnlinks href=#hl-17-321>321</a>
</span><span class=lnt id=hl-17-322><a class=lnlinks href=#hl-17-322>322</a>
</span><span class=lnt id=hl-17-323><a class=lnlinks href=#hl-17-323>323</a>
</span><span class=lnt id=hl-17-324><a class=lnlinks href=#hl-17-324>324</a>
</span><span class=lnt id=hl-17-325><a class=lnlinks href=#hl-17-325>325</a>
</span><span class=lnt id=hl-17-326><a class=lnlinks href=#hl-17-326>326</a>
</span><span class=lnt id=hl-17-327><a class=lnlinks href=#hl-17-327>327</a>
</span><span class=lnt id=hl-17-328><a class=lnlinks href=#hl-17-328>328</a>
</span><span class=lnt id=hl-17-329><a class=lnlinks href=#hl-17-329>329</a>
</span><span class=lnt id=hl-17-330><a class=lnlinks href=#hl-17-330>330</a>
</span><span class=lnt id=hl-17-331><a class=lnlinks href=#hl-17-331>331</a>
</span><span class=lnt id=hl-17-332><a class=lnlinks href=#hl-17-332>332</a>
</span><span class=lnt id=hl-17-333><a class=lnlinks href=#hl-17-333>333</a>
</span><span class=lnt id=hl-17-334><a class=lnlinks href=#hl-17-334>334</a>
</span><span class=lnt id=hl-17-335><a class=lnlinks href=#hl-17-335>335</a>
</span><span class=lnt id=hl-17-336><a class=lnlinks href=#hl-17-336>336</a>
</span><span class=lnt id=hl-17-337><a class=lnlinks href=#hl-17-337>337</a>
</span><span class=lnt id=hl-17-338><a class=lnlinks href=#hl-17-338>338</a>
</span><span class=lnt id=hl-17-339><a class=lnlinks href=#hl-17-339>339</a>
</span><span class=lnt id=hl-17-340><a class=lnlinks href=#hl-17-340>340</a>
</span><span class=lnt id=hl-17-341><a class=lnlinks href=#hl-17-341>341</a>
</span><span class=lnt id=hl-17-342><a class=lnlinks href=#hl-17-342>342</a>
</span><span class=lnt id=hl-17-343><a class=lnlinks href=#hl-17-343>343</a>
</span><span class=lnt id=hl-17-344><a class=lnlinks href=#hl-17-344>344</a>
</span><span class=lnt id=hl-17-345><a class=lnlinks href=#hl-17-345>345</a>
</span><span class=lnt id=hl-17-346><a class=lnlinks href=#hl-17-346>346</a>
</span><span class=lnt id=hl-17-347><a class=lnlinks href=#hl-17-347>347</a>
</span><span class=lnt id=hl-17-348><a class=lnlinks href=#hl-17-348>348</a>
</span><span class=lnt id=hl-17-349><a class=lnlinks href=#hl-17-349>349</a>
</span><span class=lnt id=hl-17-350><a class=lnlinks href=#hl-17-350>350</a>
</span><span class=lnt id=hl-17-351><a class=lnlinks href=#hl-17-351>351</a>
</span><span class=lnt id=hl-17-352><a class=lnlinks href=#hl-17-352>352</a>
</span><span class=lnt id=hl-17-353><a class=lnlinks href=#hl-17-353>353</a>
</span><span class=lnt id=hl-17-354><a class=lnlinks href=#hl-17-354>354</a>
</span><span class=lnt id=hl-17-355><a class=lnlinks href=#hl-17-355>355</a>
</span><span class=lnt id=hl-17-356><a class=lnlinks href=#hl-17-356>356</a>
</span><span class=lnt id=hl-17-357><a class=lnlinks href=#hl-17-357>357</a>
</span><span class=lnt id=hl-17-358><a class=lnlinks href=#hl-17-358>358</a>
</span><span class=lnt id=hl-17-359><a class=lnlinks href=#hl-17-359>359</a>
</span><span class=lnt id=hl-17-360><a class=lnlinks href=#hl-17-360>360</a>
</span><span class=lnt id=hl-17-361><a class=lnlinks href=#hl-17-361>361</a>
</span><span class=lnt id=hl-17-362><a class=lnlinks href=#hl-17-362>362</a>
</span><span class=lnt id=hl-17-363><a class=lnlinks href=#hl-17-363>363</a>
</span><span class=lnt id=hl-17-364><a class=lnlinks href=#hl-17-364>364</a>
</span><span class=lnt id=hl-17-365><a class=lnlinks href=#hl-17-365>365</a>
</span><span class=lnt id=hl-17-366><a class=lnlinks href=#hl-17-366>366</a>
</span><span class=lnt id=hl-17-367><a class=lnlinks href=#hl-17-367>367</a>
</span><span class=lnt id=hl-17-368><a class=lnlinks href=#hl-17-368>368</a>
</span><span class=lnt id=hl-17-369><a class=lnlinks href=#hl-17-369>369</a>
</span><span class=lnt id=hl-17-370><a class=lnlinks href=#hl-17-370>370</a>
</span><span class=lnt id=hl-17-371><a class=lnlinks href=#hl-17-371>371</a>
</span><span class=lnt id=hl-17-372><a class=lnlinks href=#hl-17-372>372</a>
</span><span class=lnt id=hl-17-373><a class=lnlinks href=#hl-17-373>373</a>
</span><span class=lnt id=hl-17-374><a class=lnlinks href=#hl-17-374>374</a>
</span><span class=lnt id=hl-17-375><a class=lnlinks href=#hl-17-375>375</a>
</span><span class=lnt id=hl-17-376><a class=lnlinks href=#hl-17-376>376</a>
</span><span class=lnt id=hl-17-377><a class=lnlinks href=#hl-17-377>377</a>
</span><span class=lnt id=hl-17-378><a class=lnlinks href=#hl-17-378>378</a>
</span><span class=lnt id=hl-17-379><a class=lnlinks href=#hl-17-379>379</a>
</span><span class=lnt id=hl-17-380><a class=lnlinks href=#hl-17-380>380</a>
</span><span class=lnt id=hl-17-381><a class=lnlinks href=#hl-17-381>381</a>
</span><span class=lnt id=hl-17-382><a class=lnlinks href=#hl-17-382>382</a>
</span><span class=lnt id=hl-17-383><a class=lnlinks href=#hl-17-383>383</a>
</span><span class=lnt id=hl-17-384><a class=lnlinks href=#hl-17-384>384</a>
</span><span class=lnt id=hl-17-385><a class=lnlinks href=#hl-17-385>385</a>
</span><span class=lnt id=hl-17-386><a class=lnlinks href=#hl-17-386>386</a>
</span><span class=lnt id=hl-17-387><a class=lnlinks href=#hl-17-387>387</a>
</span><span class=lnt id=hl-17-388><a class=lnlinks href=#hl-17-388>388</a>
</span><span class=lnt id=hl-17-389><a class=lnlinks href=#hl-17-389>389</a>
</span><span class=lnt id=hl-17-390><a class=lnlinks href=#hl-17-390>390</a>
</span><span class=lnt id=hl-17-391><a class=lnlinks href=#hl-17-391>391</a>
</span><span class=lnt id=hl-17-392><a class=lnlinks href=#hl-17-392>392</a>
</span><span class=lnt id=hl-17-393><a class=lnlinks href=#hl-17-393>393</a>
</span><span class=lnt id=hl-17-394><a class=lnlinks href=#hl-17-394>394</a>
</span><span class=lnt id=hl-17-395><a class=lnlinks href=#hl-17-395>395</a>
</span><span class=lnt id=hl-17-396><a class=lnlinks href=#hl-17-396>396</a>
</span><span class=lnt id=hl-17-397><a class=lnlinks href=#hl-17-397>397</a>
</span><span class=lnt id=hl-17-398><a class=lnlinks href=#hl-17-398>398</a>
</span><span class=lnt id=hl-17-399><a class=lnlinks href=#hl-17-399>399</a>
</span><span class=lnt id=hl-17-400><a class=lnlinks href=#hl-17-400>400</a>
</span><span class=lnt id=hl-17-401><a class=lnlinks href=#hl-17-401>401</a>
</span><span class=lnt id=hl-17-402><a class=lnlinks href=#hl-17-402>402</a>
</span><span class=lnt id=hl-17-403><a class=lnlinks href=#hl-17-403>403</a>
</span><span class=lnt id=hl-17-404><a class=lnlinks href=#hl-17-404>404</a>
</span><span class=lnt id=hl-17-405><a class=lnlinks href=#hl-17-405>405</a>
</span><span class=lnt id=hl-17-406><a class=lnlinks href=#hl-17-406>406</a>
</span><span class=lnt id=hl-17-407><a class=lnlinks href=#hl-17-407>407</a>
</span><span class=lnt id=hl-17-408><a class=lnlinks href=#hl-17-408>408</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>IoT 센서 데이터 처리 파이프라인 구현 예시
</span></span></span><span class=line><span class=cl><span class=s2>Pipe-and-Filter Architecture를 활용한 실시간 데이터 처리
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>queue</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>threading</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABC</span><span class=p>,</span> <span class=n>abstractmethod</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Any</span><span class=p>,</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>List</span><span class=p>,</span> <span class=n>Optional</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 파이프 인터페이스 정의</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Pipe</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;필터 간 데이터 전송을 담당하는 파이프 클래스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>buffer_size</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>100</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>queue</span> <span class=o>=</span> <span class=n>queue</span><span class=o>.</span><span class=n>Queue</span><span class=p>(</span><span class=n>maxsize</span><span class=o>=</span><span class=n>buffer_size</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>closed</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>send</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터를 파이프에 전송&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>closed</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>queue</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>block</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>queue</span><span class=o>.</span><span class=n>Full</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>receive</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>timeout</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>1.0</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;파이프에서 데이터를 수신&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>queue</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>timeout</span><span class=o>=</span><span class=n>timeout</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>queue</span><span class=o>.</span><span class=n>Empty</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>close</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;파이프 종료&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>closed</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 필터 기본 클래스</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Filter</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;모든 필터의 기본 클래스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>input_pipe</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Pipe</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>output_pipe</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Pipe</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>running</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>thread</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=n>threading</span><span class=o>.</span><span class=n>Thread</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>connect_input</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>pipe</span><span class=p>:</span> <span class=n>Pipe</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;입력 파이프 연결&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>input_pipe</span> <span class=o>=</span> <span class=n>pipe</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>connect_output</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>pipe</span><span class=p>:</span> <span class=n>Pipe</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;출력 파이프 연결&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>output_pipe</span> <span class=o>=</span> <span class=n>pipe</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터 처리 로직 (서브클래스에서 구현)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>run</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;필터 실행 메인 루프&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>running</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=bp>self</span><span class=o>.</span><span class=n>running</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>input_pipe</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>input_pipe</span><span class=o>.</span><span class=n>receive</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>data</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>processed_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>processed_data</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>output_pipe</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>success</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>output_pipe</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>processed_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                        <span class=k>if</span> <span class=ow>not</span> <span class=n>success</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Output pipe full, dropping data&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>start</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;필터 시작&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>thread</span> <span class=o>=</span> <span class=n>threading</span><span class=o>.</span><span class=n>Thread</span><span class=p>(</span><span class=n>target</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>run</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>thread</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>stop</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;필터 종료&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>running</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>thread</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>thread</span><span class=o>.</span><span class=n>join</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 소스 필터 - MQTT 센서 데이터 시뮬레이션</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SensorSourceFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;IoT 센서 데이터를 생성하는 소스 필터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>sensor_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>sensor_type</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;SensorSource-</span><span class=si>{</span><span class=n>sensor_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>sensor_id</span> <span class=o>=</span> <span class=n>sensor_id</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>sensor_type</span> <span class=o>=</span> <span class=n>sensor_type</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>data_counter</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 소스 필터는 입력 데이터를 처리하지 않음</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>run</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;센서 데이터 생성 및 전송&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>running</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=bp>self</span><span class=o>.</span><span class=n>running</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 센서 데이터 시뮬레이션</span>
</span></span><span class=line><span class=cl>            <span class=n>sensor_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;sensor_id&#34;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>sensor_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;sensor_type&#34;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>sensor_type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;timestamp&#34;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;value&#34;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_generate_sensor_value</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;sequence&#34;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>data_counter</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>output_pipe</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>success</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>output_pipe</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>sensor_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>success</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>data_counter</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Generated: </span><span class=si>{</span><span class=n>sensor_data</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Output pipe full&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>  <span class=c1># 2초마다 데이터 생성</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_generate_sensor_value</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>float</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;센서 타입에 따른 값 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>sensor_type</span> <span class=o>==</span> <span class=s2>&#34;temperature&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nb>round</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=mf>20.0</span><span class=p>,</span> <span class=mf>30.0</span><span class=p>),</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>sensor_type</span> <span class=o>==</span> <span class=s2>&#34;humidity&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nb>round</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=mf>40.0</span><span class=p>,</span> <span class=mf>80.0</span><span class=p>),</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=bp>self</span><span class=o>.</span><span class=n>sensor_type</span> <span class=o>==</span> <span class=s2>&#34;pressure&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nb>round</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=mf>1000.0</span><span class=p>,</span> <span class=mf>1020.0</span><span class=p>),</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># JSON 파싱 필터</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>JsonParseFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;JSON 데이터를 파싱하고 검증하는 필터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=s2>&#34;JsonParser&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;JSON 데이터 파싱 및 구조 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>parsed_data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>parsed_data</span> <span class=o>=</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 필수 필드 검증</span>
</span></span><span class=line><span class=cl>            <span class=n>required_fields</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;sensor_id&#34;</span><span class=p>,</span> <span class=s2>&#34;sensor_type&#34;</span><span class=p>,</span> <span class=s2>&#34;timestamp&#34;</span><span class=p>,</span> <span class=s2>&#34;value&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>field</span> <span class=ow>in</span> <span class=n>required_fields</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>field</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>parsed_data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Missing field: </span><span class=si>{</span><span class=n>field</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Parsed: </span><span class=si>{</span><span class=n>parsed_data</span><span class=p>[</span><span class=s1>&#39;sensor_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>parsed_data</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>json</span><span class=o>.</span><span class=n>JSONDecodeError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] JSON parse error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Processing error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 데이터 검증 필터</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ValidationFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;센서 데이터 값의 유효성을 검증하는 필터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=s2>&#34;Validator&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 센서 타입별 유효 범위 정의</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>valid_ranges</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;temperature&#34;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.0</span><span class=p>,</span> <span class=mf>50.0</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;humidity&#34;</span><span class=p>:</span> <span class=p>(</span><span class=mf>0.0</span><span class=p>,</span> <span class=mf>100.0</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;pressure&#34;</span><span class=p>:</span> <span class=p>(</span><span class=mf>950.0</span><span class=p>,</span> <span class=mf>1050.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터 값 범위 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>sensor_type</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;sensor_type&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>value</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s2>&#34;value&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>sensor_type</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>valid_ranges</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>min_val</span><span class=p>,</span> <span class=n>max_val</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>valid_ranges</span><span class=p>[</span><span class=n>sensor_type</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>min_val</span> <span class=o>&lt;=</span> <span class=n>value</span> <span class=o>&lt;=</span> <span class=n>max_val</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Valid: </span><span class=si>{</span><span class=n>sensor_type</span><span class=si>}</span><span class=s2>=</span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Invalid range: </span><span class=si>{</span><span class=n>sensor_type</span><span class=si>}</span><span class=s2>=</span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Unknown sensor type: </span><span class=si>{</span><span class=n>sensor_type</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=p>(</span><span class=ne>KeyError</span><span class=p>,</span> <span class=ne>ValueError</span><span class=p>,</span> <span class=ne>TypeError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Validation error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 데이터 변환 필터</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TransformFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;데이터 형식을 표준화하는 변환 필터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=s2>&#34;Transformer&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터를 표준 형식으로 변환&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 표준 형식으로 데이터 변환</span>
</span></span><span class=line><span class=cl>            <span class=n>transformed_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;sensor_id&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;type&#34;</span><span class=p>:</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;sensor_type&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;timestamp&#34;</span><span class=p>:</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;timestamp&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;measurement&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;value&#34;</span><span class=p>:</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;value&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;unit&#34;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_unit</span><span class=p>(</span><span class=n>data</span><span class=p>[</span><span class=s2>&#34;sensor_type&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;metadata&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;sequence&#34;</span><span class=p>:</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;sequence&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;processed_at&#34;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Transformed: </span><span class=si>{</span><span class=n>transformed_data</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>transformed_data</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Transform error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_get_unit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>sensor_type</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;센서 타입에 따른 단위 반환&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>units</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;temperature&#34;</span><span class=p>:</span> <span class=s2>&#34;°C&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;humidity&#34;</span><span class=p>:</span> <span class=s2>&#34;%&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;pressure&#34;</span><span class=p>:</span> <span class=s2>&#34;hPa&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>units</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>sensor_type</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 라우터 필터</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>RouterFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;센서 타입에 따라 데이터를 다른 경로로 라우팅&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=s2>&#34;Router&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>output_pipes</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Pipe</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_route</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>sensor_type</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>pipe</span><span class=p>:</span> <span class=n>Pipe</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;특정 센서 타입에 대한 출력 파이프 추가&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>output_pipes</span><span class=p>[</span><span class=n>sensor_type</span><span class=p>]</span> <span class=o>=</span> <span class=n>pipe</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;센서 타입에 따른 라우팅&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>sensor_type</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s2>&#34;type&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>sensor_type</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>output_pipes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>success</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>output_pipes</span><span class=p>[</span><span class=n>sensor_type</span><span class=p>]</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>success</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Routed </span><span class=si>{</span><span class=n>sensor_type</span><span class=si>}</span><span class=s2> data&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Route pipe full for </span><span class=si>{</span><span class=n>sensor_type</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] No route for </span><span class=si>{</span><span class=n>sensor_type</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 라우터는 원본 데이터를 변경하지 않고 전달만 함</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Routing error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 싱크 필터</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>DatabaseSinkFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;처리된 데이터를 데이터베이스에 저장하는 싱크 필터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>db_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;DatabaseSink-</span><span class=si>{</span><span class=n>db_name</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db_name</span> <span class=o>=</span> <span class=n>db_name</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>stored_count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터베이스에 데이터 저장 (시뮬레이션)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 실제 구현에서는 데이터베이스 연결 및 저장 수행</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Storing to </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>db_name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> = </span><span class=si>{</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;measurement&#39;</span><span class=p>][</span><span class=s1>&#39;value&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>stored_count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 싱크 필터는 출력이 없음</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>] Storage error: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 파이프라인 관리자</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Pipeline</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;전체 파이프라인을 관리하는 클래스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Filter</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pipes</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Pipe</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_filter</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>filter_instance</span><span class=p>:</span> <span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;필터를 파이프라인에 추가&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>filter_instance</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_pipe</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>pipe</span><span class=p>:</span> <span class=n>Pipe</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;파이프를 파이프라인에 추가&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pipes</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>pipe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>connect</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>source_filter</span><span class=p>:</span> <span class=n>Filter</span><span class=p>,</span> <span class=n>target_filter</span><span class=p>:</span> <span class=n>Filter</span><span class=p>,</span> <span class=n>pipe</span><span class=p>:</span> <span class=n>Pipe</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;두 필터를 파이프로 연결&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>source_filter</span><span class=o>.</span><span class=n>connect_output</span><span class=p>(</span><span class=n>pipe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>target_filter</span><span class=o>.</span><span class=n>connect_input</span><span class=p>(</span><span class=n>pipe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>add_pipe</span><span class=p>(</span><span class=n>pipe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>start</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;전체 파이프라인 시작&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Starting pipeline…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>filter_instance</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>filter_instance</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Pipeline started!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>stop</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;전체 파이프라인 종료&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Stopping pipeline…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>filter_instance</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>filter_instance</span><span class=o>.</span><span class=n>stop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>pipe</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>pipes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>pipe</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Pipeline stopped!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메인 실행 예제</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;IoT 데이터 처리 파이프라인 실행 예제&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 파이프라인 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 필터 인스턴스 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>temp_source</span> <span class=o>=</span> <span class=n>SensorSourceFilter</span><span class=p>(</span><span class=s2>&#34;TEMP_01&#34;</span><span class=p>,</span> <span class=s2>&#34;temperature&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>humidity_source</span> <span class=o>=</span> <span class=n>SensorSourceFilter</span><span class=p>(</span><span class=s2>&#34;HUM_01&#34;</span><span class=p>,</span> <span class=s2>&#34;humidity&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>json_parser</span> <span class=o>=</span> <span class=n>JsonParseFilter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>validator</span> <span class=o>=</span> <span class=n>ValidationFilter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>transformer</span> <span class=o>=</span> <span class=n>TransformFilter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>router</span> <span class=o>=</span> <span class=n>RouterFilter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>temp_sink</span> <span class=o>=</span> <span class=n>DatabaseSinkFilter</span><span class=p>(</span><span class=s2>&#34;TemperatureDB&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>humidity_sink</span> <span class=o>=</span> <span class=n>DatabaseSinkFilter</span><span class=p>(</span><span class=s2>&#34;HumidityDB&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 파이프 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>temp_to_parser</span> <span class=o>=</span> <span class=n>Pipe</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>humidity_to_parser</span> <span class=o>=</span> <span class=n>Pipe</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>parser_to_validator</span> <span class=o>=</span> <span class=n>Pipe</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>validator_to_transformer</span> <span class=o>=</span> <span class=n>Pipe</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>transformer_to_router</span> <span class=o>=</span> <span class=n>Pipe</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>temp_route_pipe</span> <span class=o>=</span> <span class=n>Pipe</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>humidity_route_pipe</span> <span class=o>=</span> <span class=n>Pipe</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 필터들을 파이프라인에 추가</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>temp_source</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>humidity_source</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>json_parser</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>validator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>transformer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>router</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>temp_sink</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>humidity_sink</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 파이프라인 연결</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>temp_source</span><span class=p>,</span> <span class=n>json_parser</span><span class=p>,</span> <span class=n>temp_to_parser</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>humidity_source</span><span class=p>,</span> <span class=n>json_parser</span><span class=p>,</span> <span class=n>humidity_to_parser</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>json_parser</span><span class=p>,</span> <span class=n>validator</span><span class=p>,</span> <span class=n>parser_to_validator</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>validator</span><span class=p>,</span> <span class=n>transformer</span><span class=p>,</span> <span class=n>validator_to_transformer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>transformer</span><span class=p>,</span> <span class=n>router</span><span class=p>,</span> <span class=n>transformer_to_router</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 라우터 설정</span>
</span></span><span class=line><span class=cl>    <span class=n>router</span><span class=o>.</span><span class=n>add_route</span><span class=p>(</span><span class=s2>&#34;temperature&#34;</span><span class=p>,</span> <span class=n>temp_route_pipe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>router</span><span class=o>.</span><span class=n>add_route</span><span class=p>(</span><span class=s2>&#34;humidity&#34;</span><span class=p>,</span> <span class=n>humidity_route_pipe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>temp_sink</span><span class=o>.</span><span class=n>connect_input</span><span class=p>(</span><span class=n>temp_route_pipe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>humidity_sink</span><span class=o>.</span><span class=n>connect_input</span><span class=p>(</span><span class=n>humidity_route_pipe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>add_pipe</span><span class=p>(</span><span class=n>temp_route_pipe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>add_pipe</span><span class=p>(</span><span class=n>humidity_route_pipe</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 파이프라인 시작</span>
</span></span><span class=line><span class=cl>        <span class=n>pipeline</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 30초간 실행</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Pipeline running for 30 seconds…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>KeyboardInterrupt</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Received interrupt signal&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 파이프라인 종료</span>
</span></span><span class=line><span class=cl>        <span class=n>pipeline</span><span class=o>.</span><span class=n>stop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=사례-6-이미지-처리-파이프라인>사례 6: 이미지 처리 파이프라인<a hidden class=anchor aria-hidden=true href=#사례-6-이미지-처리-파이프라인>#</a></h4><p><strong>시스템 구성</strong>: S3(소스) → Lambda(리사이징) → Lambda(워터마킹) → S3(싱크)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1>1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2>2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3>3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4>4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>flowchart LR
</span></span><span class=line><span class=cl>    U[사용자 업로드] --&gt; S3[S3 저장소]
</span></span><span class=line><span class=cl>    S3 --&gt; L1[Lambda: 리사이징]
</span></span><span class=line><span class=cl>    L1 --&gt; L2[Lambda: 워터마킹]
</span></span><span class=line><span class=cl>    L2 --&gt; S3R[결과 S3 저장소]
</span></span></code></pre></td></tr></table></div></div><p><strong>Workflow</strong>: 사용자가 이미지를 업로드하면, S3 이벤트로 Lambda 함수 (필터) 가 순차적으로 호출되어 리사이징, 워터마킹 후 결과를 저장</p><p><strong>Pipe-and-Filter 역할</strong>: 각 Lambda 함수가 독립적인 필터로 동작, 파이프는 S3 이벤트 및 데이터 전달 역할</p><p><strong>유무에 따른 차이점</strong>: Pipe-and-Filter 구조 미도입 시, 모든 처리가 하나의 모놀리식 함수에서 이루어져 유지보수와 확장성이 저하됨. 도입 시 각 단계가 분리되어 관리, 확장, 장애 대응이 용이함.</p><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12>12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13>13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14>14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15>15</a>
</span><span class=lnt id=hl-19-16><a class=lnlinks href=#hl-19-16>16</a>
</span><span class=lnt id=hl-19-17><a class=lnlinks href=#hl-19-17>17</a>
</span><span class=lnt id=hl-19-18><a class=lnlinks href=#hl-19-18>18</a>
</span><span class=lnt id=hl-19-19><a class=lnlinks href=#hl-19-19>19</a>
</span><span class=lnt id=hl-19-20><a class=lnlinks href=#hl-19-20>20</a>
</span><span class=lnt id=hl-19-21><a class=lnlinks href=#hl-19-21>21</a>
</span><span class=lnt id=hl-19-22><a class=lnlinks href=#hl-19-22>22</a>
</span><span class=lnt id=hl-19-23><a class=lnlinks href=#hl-19-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Pipe-and-Filter 구조의 간단한 예시</span>
</span></span><span class=line><span class=cl><span class=c1># 각 필터는 독립적으로 동작하며, 파이프 역할은 함수 호출로 구현</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>resize_filter</span><span class=p>(</span><span class=n>image</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 이미지 리사이징 필터</span>
</span></span><span class=line><span class=cl>    <span class=c1># (실제 구현은 생략)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;리사이징(</span><span class=si>{</span><span class=n>image</span><span class=si>}</span><span class=s2>)&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>watermark_filter</span><span class=p>(</span><span class=n>image</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 워터마킹 필터</span>
</span></span><span class=line><span class=cl>    <span class=c1># (실제 구현은 생략)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;워터마킹(</span><span class=si>{</span><span class=n>image</span><span class=si>}</span><span class=s2>)&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>pipeline</span><span class=p>(</span><span class=n>image</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 파이프라인: 필터를 순차적으로 적용</span>
</span></span><span class=line><span class=cl>    <span class=n>image</span> <span class=o>=</span> <span class=n>resize_filter</span><span class=p>(</span><span class=n>image</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>image</span> <span class=o>=</span> <span class=n>watermark_filter</span><span class=p>(</span><span class=n>image</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>image</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>input_image</span> <span class=o>=</span> <span class=s2>&#34;input.jpg&#34;</span>
</span></span><span class=line><span class=cl><span class=n>output_image</span> <span class=o>=</span> <span class=n>pipeline</span><span class=p>(</span><span class=n>input_image</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>output_image</span><span class=p>)</span>  <span class=c1># 출력: 워터마킹(리사이징(input.jpg))</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>각 함수가 필터 역할을 하며, 파이프라인 함수가 파이프 역할을 수행합니다.</li></ul><h3 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1>  1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2>  2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3>  3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4>  4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5>  5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6>  6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7>  7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8>  8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9>  9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10> 10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11> 11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12> 12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13> 13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14> 14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15> 15</a>
</span><span class=lnt id=hl-20-16><a class=lnlinks href=#hl-20-16> 16</a>
</span><span class=lnt id=hl-20-17><a class=lnlinks href=#hl-20-17> 17</a>
</span><span class=lnt id=hl-20-18><a class=lnlinks href=#hl-20-18> 18</a>
</span><span class=lnt id=hl-20-19><a class=lnlinks href=#hl-20-19> 19</a>
</span><span class=lnt id=hl-20-20><a class=lnlinks href=#hl-20-20> 20</a>
</span><span class=lnt id=hl-20-21><a class=lnlinks href=#hl-20-21> 21</a>
</span><span class=lnt id=hl-20-22><a class=lnlinks href=#hl-20-22> 22</a>
</span><span class=lnt id=hl-20-23><a class=lnlinks href=#hl-20-23> 23</a>
</span><span class=lnt id=hl-20-24><a class=lnlinks href=#hl-20-24> 24</a>
</span><span class=lnt id=hl-20-25><a class=lnlinks href=#hl-20-25> 25</a>
</span><span class=lnt id=hl-20-26><a class=lnlinks href=#hl-20-26> 26</a>
</span><span class=lnt id=hl-20-27><a class=lnlinks href=#hl-20-27> 27</a>
</span><span class=lnt id=hl-20-28><a class=lnlinks href=#hl-20-28> 28</a>
</span><span class=lnt id=hl-20-29><a class=lnlinks href=#hl-20-29> 29</a>
</span><span class=lnt id=hl-20-30><a class=lnlinks href=#hl-20-30> 30</a>
</span><span class=lnt id=hl-20-31><a class=lnlinks href=#hl-20-31> 31</a>
</span><span class=lnt id=hl-20-32><a class=lnlinks href=#hl-20-32> 32</a>
</span><span class=lnt id=hl-20-33><a class=lnlinks href=#hl-20-33> 33</a>
</span><span class=lnt id=hl-20-34><a class=lnlinks href=#hl-20-34> 34</a>
</span><span class=lnt id=hl-20-35><a class=lnlinks href=#hl-20-35> 35</a>
</span><span class=lnt id=hl-20-36><a class=lnlinks href=#hl-20-36> 36</a>
</span><span class=lnt id=hl-20-37><a class=lnlinks href=#hl-20-37> 37</a>
</span><span class=lnt id=hl-20-38><a class=lnlinks href=#hl-20-38> 38</a>
</span><span class=lnt id=hl-20-39><a class=lnlinks href=#hl-20-39> 39</a>
</span><span class=lnt id=hl-20-40><a class=lnlinks href=#hl-20-40> 40</a>
</span><span class=lnt id=hl-20-41><a class=lnlinks href=#hl-20-41> 41</a>
</span><span class=lnt id=hl-20-42><a class=lnlinks href=#hl-20-42> 42</a>
</span><span class=lnt id=hl-20-43><a class=lnlinks href=#hl-20-43> 43</a>
</span><span class=lnt id=hl-20-44><a class=lnlinks href=#hl-20-44> 44</a>
</span><span class=lnt id=hl-20-45><a class=lnlinks href=#hl-20-45> 45</a>
</span><span class=lnt id=hl-20-46><a class=lnlinks href=#hl-20-46> 46</a>
</span><span class=lnt id=hl-20-47><a class=lnlinks href=#hl-20-47> 47</a>
</span><span class=lnt id=hl-20-48><a class=lnlinks href=#hl-20-48> 48</a>
</span><span class=lnt id=hl-20-49><a class=lnlinks href=#hl-20-49> 49</a>
</span><span class=lnt id=hl-20-50><a class=lnlinks href=#hl-20-50> 50</a>
</span><span class=lnt id=hl-20-51><a class=lnlinks href=#hl-20-51> 51</a>
</span><span class=lnt id=hl-20-52><a class=lnlinks href=#hl-20-52> 52</a>
</span><span class=lnt id=hl-20-53><a class=lnlinks href=#hl-20-53> 53</a>
</span><span class=lnt id=hl-20-54><a class=lnlinks href=#hl-20-54> 54</a>
</span><span class=lnt id=hl-20-55><a class=lnlinks href=#hl-20-55> 55</a>
</span><span class=lnt id=hl-20-56><a class=lnlinks href=#hl-20-56> 56</a>
</span><span class=lnt id=hl-20-57><a class=lnlinks href=#hl-20-57> 57</a>
</span><span class=lnt id=hl-20-58><a class=lnlinks href=#hl-20-58> 58</a>
</span><span class=lnt id=hl-20-59><a class=lnlinks href=#hl-20-59> 59</a>
</span><span class=lnt id=hl-20-60><a class=lnlinks href=#hl-20-60> 60</a>
</span><span class=lnt id=hl-20-61><a class=lnlinks href=#hl-20-61> 61</a>
</span><span class=lnt id=hl-20-62><a class=lnlinks href=#hl-20-62> 62</a>
</span><span class=lnt id=hl-20-63><a class=lnlinks href=#hl-20-63> 63</a>
</span><span class=lnt id=hl-20-64><a class=lnlinks href=#hl-20-64> 64</a>
</span><span class=lnt id=hl-20-65><a class=lnlinks href=#hl-20-65> 65</a>
</span><span class=lnt id=hl-20-66><a class=lnlinks href=#hl-20-66> 66</a>
</span><span class=lnt id=hl-20-67><a class=lnlinks href=#hl-20-67> 67</a>
</span><span class=lnt id=hl-20-68><a class=lnlinks href=#hl-20-68> 68</a>
</span><span class=lnt id=hl-20-69><a class=lnlinks href=#hl-20-69> 69</a>
</span><span class=lnt id=hl-20-70><a class=lnlinks href=#hl-20-70> 70</a>
</span><span class=lnt id=hl-20-71><a class=lnlinks href=#hl-20-71> 71</a>
</span><span class=lnt id=hl-20-72><a class=lnlinks href=#hl-20-72> 72</a>
</span><span class=lnt id=hl-20-73><a class=lnlinks href=#hl-20-73> 73</a>
</span><span class=lnt id=hl-20-74><a class=lnlinks href=#hl-20-74> 74</a>
</span><span class=lnt id=hl-20-75><a class=lnlinks href=#hl-20-75> 75</a>
</span><span class=lnt id=hl-20-76><a class=lnlinks href=#hl-20-76> 76</a>
</span><span class=lnt id=hl-20-77><a class=lnlinks href=#hl-20-77> 77</a>
</span><span class=lnt id=hl-20-78><a class=lnlinks href=#hl-20-78> 78</a>
</span><span class=lnt id=hl-20-79><a class=lnlinks href=#hl-20-79> 79</a>
</span><span class=lnt id=hl-20-80><a class=lnlinks href=#hl-20-80> 80</a>
</span><span class=lnt id=hl-20-81><a class=lnlinks href=#hl-20-81> 81</a>
</span><span class=lnt id=hl-20-82><a class=lnlinks href=#hl-20-82> 82</a>
</span><span class=lnt id=hl-20-83><a class=lnlinks href=#hl-20-83> 83</a>
</span><span class=lnt id=hl-20-84><a class=lnlinks href=#hl-20-84> 84</a>
</span><span class=lnt id=hl-20-85><a class=lnlinks href=#hl-20-85> 85</a>
</span><span class=lnt id=hl-20-86><a class=lnlinks href=#hl-20-86> 86</a>
</span><span class=lnt id=hl-20-87><a class=lnlinks href=#hl-20-87> 87</a>
</span><span class=lnt id=hl-20-88><a class=lnlinks href=#hl-20-88> 88</a>
</span><span class=lnt id=hl-20-89><a class=lnlinks href=#hl-20-89> 89</a>
</span><span class=lnt id=hl-20-90><a class=lnlinks href=#hl-20-90> 90</a>
</span><span class=lnt id=hl-20-91><a class=lnlinks href=#hl-20-91> 91</a>
</span><span class=lnt id=hl-20-92><a class=lnlinks href=#hl-20-92> 92</a>
</span><span class=lnt id=hl-20-93><a class=lnlinks href=#hl-20-93> 93</a>
</span><span class=lnt id=hl-20-94><a class=lnlinks href=#hl-20-94> 94</a>
</span><span class=lnt id=hl-20-95><a class=lnlinks href=#hl-20-95> 95</a>
</span><span class=lnt id=hl-20-96><a class=lnlinks href=#hl-20-96> 96</a>
</span><span class=lnt id=hl-20-97><a class=lnlinks href=#hl-20-97> 97</a>
</span><span class=lnt id=hl-20-98><a class=lnlinks href=#hl-20-98> 98</a>
</span><span class=lnt id=hl-20-99><a class=lnlinks href=#hl-20-99> 99</a>
</span><span class=lnt id=hl-20-100><a class=lnlinks href=#hl-20-100>100</a>
</span><span class=lnt id=hl-20-101><a class=lnlinks href=#hl-20-101>101</a>
</span><span class=lnt id=hl-20-102><a class=lnlinks href=#hl-20-102>102</a>
</span><span class=lnt id=hl-20-103><a class=lnlinks href=#hl-20-103>103</a>
</span><span class=lnt id=hl-20-104><a class=lnlinks href=#hl-20-104>104</a>
</span><span class=lnt id=hl-20-105><a class=lnlinks href=#hl-20-105>105</a>
</span><span class=lnt id=hl-20-106><a class=lnlinks href=#hl-20-106>106</a>
</span><span class=lnt id=hl-20-107><a class=lnlinks href=#hl-20-107>107</a>
</span><span class=lnt id=hl-20-108><a class=lnlinks href=#hl-20-108>108</a>
</span><span class=lnt id=hl-20-109><a class=lnlinks href=#hl-20-109>109</a>
</span><span class=lnt id=hl-20-110><a class=lnlinks href=#hl-20-110>110</a>
</span><span class=lnt id=hl-20-111><a class=lnlinks href=#hl-20-111>111</a>
</span><span class=lnt id=hl-20-112><a class=lnlinks href=#hl-20-112>112</a>
</span><span class=lnt id=hl-20-113><a class=lnlinks href=#hl-20-113>113</a>
</span><span class=lnt id=hl-20-114><a class=lnlinks href=#hl-20-114>114</a>
</span><span class=lnt id=hl-20-115><a class=lnlinks href=#hl-20-115>115</a>
</span><span class=lnt id=hl-20-116><a class=lnlinks href=#hl-20-116>116</a>
</span><span class=lnt id=hl-20-117><a class=lnlinks href=#hl-20-117>117</a>
</span><span class=lnt id=hl-20-118><a class=lnlinks href=#hl-20-118>118</a>
</span><span class=lnt id=hl-20-119><a class=lnlinks href=#hl-20-119>119</a>
</span><span class=lnt id=hl-20-120><a class=lnlinks href=#hl-20-120>120</a>
</span><span class=lnt id=hl-20-121><a class=lnlinks href=#hl-20-121>121</a>
</span><span class=lnt id=hl-20-122><a class=lnlinks href=#hl-20-122>122</a>
</span><span class=lnt id=hl-20-123><a class=lnlinks href=#hl-20-123>123</a>
</span><span class=lnt id=hl-20-124><a class=lnlinks href=#hl-20-124>124</a>
</span><span class=lnt id=hl-20-125><a class=lnlinks href=#hl-20-125>125</a>
</span><span class=lnt id=hl-20-126><a class=lnlinks href=#hl-20-126>126</a>
</span><span class=lnt id=hl-20-127><a class=lnlinks href=#hl-20-127>127</a>
</span><span class=lnt id=hl-20-128><a class=lnlinks href=#hl-20-128>128</a>
</span><span class=lnt id=hl-20-129><a class=lnlinks href=#hl-20-129>129</a>
</span><span class=lnt id=hl-20-130><a class=lnlinks href=#hl-20-130>130</a>
</span><span class=lnt id=hl-20-131><a class=lnlinks href=#hl-20-131>131</a>
</span><span class=lnt id=hl-20-132><a class=lnlinks href=#hl-20-132>132</a>
</span><span class=lnt id=hl-20-133><a class=lnlinks href=#hl-20-133>133</a>
</span><span class=lnt id=hl-20-134><a class=lnlinks href=#hl-20-134>134</a>
</span><span class=lnt id=hl-20-135><a class=lnlinks href=#hl-20-135>135</a>
</span><span class=lnt id=hl-20-136><a class=lnlinks href=#hl-20-136>136</a>
</span><span class=lnt id=hl-20-137><a class=lnlinks href=#hl-20-137>137</a>
</span><span class=lnt id=hl-20-138><a class=lnlinks href=#hl-20-138>138</a>
</span><span class=lnt id=hl-20-139><a class=lnlinks href=#hl-20-139>139</a>
</span><span class=lnt id=hl-20-140><a class=lnlinks href=#hl-20-140>140</a>
</span><span class=lnt id=hl-20-141><a class=lnlinks href=#hl-20-141>141</a>
</span><span class=lnt id=hl-20-142><a class=lnlinks href=#hl-20-142>142</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABC</span><span class=p>,</span> <span class=n>abstractmethod</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Any</span><span class=p>,</span> <span class=n>List</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>queue</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>threading</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 필터의 기본 인터페이스</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Filter</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>input_pipe</span> <span class=o>=</span> <span class=n>queue</span><span class=o>.</span><span class=n>Queue</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>output_pipe</span> <span class=o>=</span> <span class=n>queue</span><span class=o>.</span><span class=n>Queue</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_is_running</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_thread</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터를 처리하는 추상 메서드&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>start</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;필터 처리를 시작&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_is_running</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_thread</span> <span class=o>=</span> <span class=n>threading</span><span class=o>.</span><span class=n>Thread</span><span class=p>(</span><span class=n>target</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>_run</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_thread</span><span class=o>.</span><span class=n>daemon</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_thread</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>stop</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;필터 처리를 중지&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_is_running</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>_thread</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_thread</span><span class=o>.</span><span class=n>join</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_run</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;필터의 메인 처리 루프&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=bp>self</span><span class=o>.</span><span class=n>_is_running</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># 입력 파이프에서 데이터를 가져옴</span>
</span></span><span class=line><span class=cl>                <span class=n>data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>input_pipe</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>timeout</span><span class=o>=</span><span class=mf>1.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>data</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>  <span class=c1># 종료 시그널</span>
</span></span><span class=line><span class=cl>                    <span class=k>break</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>                <span class=c1># 데이터 처리 및 결과를 출력 파이프로 전달</span>
</span></span><span class=line><span class=cl>                <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>result</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>output_pipe</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=n>queue</span><span class=o>.</span><span class=n>Empty</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error in </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 구체적인 필터 구현</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TextNormalizationFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;텍스트를 정규화하는 필터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>text</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 소문자로 변환하고 앞뒤 공백 제거</span>
</span></span><span class=line><span class=cl>        <span class=n>normalized</span> <span class=o>=</span> <span class=n>text</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>: Normalized text to &#39;</span><span class=si>{</span><span class=n>normalized</span><span class=si>}</span><span class=s2>&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>normalized</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>PunctuationRemovalFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;구두점을 제거하는 필터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>text</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 기본적인 구두점 제거</span>
</span></span><span class=line><span class=cl>        <span class=n>cleaned</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>char</span> <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>text</span> <span class=k>if</span> <span class=n>char</span><span class=o>.</span><span class=n>isalnum</span><span class=p>()</span> <span class=ow>or</span> <span class=n>char</span><span class=o>.</span><span class=n>isspace</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>: Removed punctuation -&gt; &#39;</span><span class=si>{</span><span class=n>cleaned</span><span class=si>}</span><span class=s2>&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>cleaned</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>WordCountFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;단어 수를 세는 필터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>text</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 단어별 출현 횟수 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>words</span> <span class=o>=</span> <span class=n>text</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>word_count</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>words</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>word_count</span><span class=p>[</span><span class=n>word</span><span class=p>]</span> <span class=o>=</span> <span class=n>word_count</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>word</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>: Counted words -&gt; </span><span class=si>{</span><span class=n>word_count</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>word_count</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 파이프라인 관리자</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Pipeline</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Filter</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_filter</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=nb>filter</span><span class=p>:</span> <span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;파이프라인에 필터 추가&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 이전 필터의 출력을 현재 필터의 입력으로 연결</span>
</span></span><span class=line><span class=cl>            <span class=n>prev_filter</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=nb>filter</span><span class=o>.</span><span class=n>input_pipe</span> <span class=o>=</span> <span class=n>prev_filter</span><span class=o>.</span><span class=n>output_pipe</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>filter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>start</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;모든 필터 시작&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Starting pipeline…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=nb>filter</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>filter</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>stop</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;모든 필터 중지&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Stopping pipeline…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=nb>filter</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>filter</span><span class=o>.</span><span class=n>stop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Any</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터 처리 시작&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=c1># 첫 번째 필터에 데이터 입력</span>
</span></span><span class=line><span class=cl>        <span class=n>first_filter</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>first_filter</span><span class=o>.</span><span class=n>input_pipe</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 마지막 필터의 결과 반환</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>filters</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>output_pipe</span><span class=o>.</span><span class=n>get</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 파이프라인 생성 및 필터 추가</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>Pipeline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>TextNormalizationFilter</span><span class=p>(</span><span class=s2>&#34;Normalizer&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>PunctuationRemovalFilter</span><span class=p>(</span><span class=s2>&#34;PunctuationCleaner&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>add_filter</span><span class=p>(</span><span class=n>WordCountFilter</span><span class=p>(</span><span class=s2>&#34;WordCounter&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 파이프라인 시작</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 테스트 데이터 처리</span>
</span></span><span class=line><span class=cl>        <span class=n>input_text</span> <span class=o>=</span> <span class=s2>&#34;Hello, World! Hello, Python… Hello, Pipe-Filter Pattern!&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Processing text: &#39;</span><span class=si>{</span><span class=n>input_text</span><span class=si>}</span><span class=s2>&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>input_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Final result: </span><span class=si>{</span><span class=n>result</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 파이프라인 종료</span>
</span></span><span class=line><span class=cl>        <span class=n>pipeline</span><span class=o>.</span><span class=n>stop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=기타-사항>기타 사항<a hidden class=anchor aria-hidden=true href=#기타-사항>#</a></h3><h4 id=보안-고려사항>보안 고려사항<a hidden class=anchor aria-hidden=true href=#보안-고려사항>#</a></h4><p><strong>데이터 암호화</strong></p><ul><li>필터 간 민감한 데이터 전송 시 암호화 적용</li><li>저장 데이터 암호화 및 키 관리</li><li>SSL/TLS 를 통한 전송 구간 보안</li></ul><p><strong>접근 제어</strong></p><ul><li>필터별 권한 관리 체계</li><li>API 인증 및 인가 메커니즘</li><li>감사 로그 및 보안 모니터링</li></ul><h4 id=테스트-전략>테스트 전략<a hidden class=anchor aria-hidden=true href=#테스트-전략>#</a></h4><p><strong>단위 테스트</strong></p><ul><li>각 필터의 독립적 테스트</li><li>모킹을 통한 의존성 격리</li><li>경계값 및 예외 상황 테스트</li></ul><p><strong>통합 테스트</strong></p><ul><li>전체 파이프라인의 End-to-End 테스트</li><li>성능 테스트 및 부하 테스트</li><li>장애 시나리오 테스트</li></ul><h4 id=문서화-및-거버넌스>문서화 및 거버넌스<a hidden class=anchor aria-hidden=true href=#문서화-및-거버넌스>#</a></h4><p><strong>아키텍처 문서</strong></p><ul><li>파이프라인 구조도 및 데이터 흐름도</li><li>각 필터의 입출력 명세</li><li>운영 가이드 및 트러블슈팅 문서</li></ul><p><strong>개발 가이드라인</strong></p><ul><li>필터 개발 표준 및 베스트 프랙티스</li><li>코드 리뷰 체크리스트</li><li>성능 최적화 가이드</li></ul><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th><strong>분류</strong></th><th><strong>고려 항목</strong></th><th><strong>설명</strong></th><th><strong>권장 전략</strong></th></tr></thead><tbody><tr><td><strong>설계</strong></td><td>필터 크기 / 역할 분리</td><td>필터가 지나치게 작으면 오버헤드 발생, 크면 재사용성 저하</td><td>단일 책임 원칙 (SRP) 을 유지하되 성능 고려하여 적절한 기능 단위 분할</td></tr><tr><td></td><td>데이터 포맷 표준화</td><td>필터 간 포맷 불일치 시 오류 발생, 유지보수 어려움</td><td>Avro/Protobuf 등 스키마 기반 포맷 사용, Schema Registry 도입</td></tr><tr><td></td><td>인터페이스 정의</td><td>느슨한 결합을 위한 명확한 입력/출력 계약 필요</td><td>인터페이스 명세 문서화, OpenAPI 또는 gRPC 사용 시 IDL 로 정의</td></tr><tr><td></td><td>처리 순서 보장</td><td>필터의 순서가 의미에 따라 논리적으로 중요함</td><td>흐름 정의 문서화, 순서 변경 허용 시 영향도 분석 및 테스트 체계 구축</td></tr><tr><td></td><td>상태 관리</td><td>상태 공유로 인해 병렬화/확장성 저하 위험 존재</td><td>Stateless 기본, 필요 시 외부 상태 저장소 (Redis 등) 사용</td></tr><tr><td><strong>구현</strong></td><td>오류 격리 / 복구</td><td>한 필터 오류로 전체 시스템 중단 방지 필요</td><td>Circuit Breaker, DLQ(Dead Letter Queue), 재시도 로직 적용</td></tr><tr><td></td><td>백프레셔 / 버퍼링 관리</td><td>처리 속도 차이로 인한 메모리 폭증 및 병목 발생 가능</td><td>적응형 버퍼 크기, 비동기 큐, Flow Control, Bounded Channel 등 적용</td></tr><tr><td></td><td>병렬 처리 및 확장</td><td>각 필터를 병렬로 실행하여 처리량 향상</td><td>필터별 병렬 워커 수 조정, CPU 및 메시지 부하 기반 Autoscaling</td></tr><tr><td></td><td>비동기 처리</td><td>I/O 중심 필터에서 동기 방식은 성능 저하 유발</td><td>asyncio, Reactor, Kafka Consumer 등 논블로킹 방식 사용</td></tr><tr><td></td><td>테스트 자동화</td><td>필터 단위 및 전체 흐름 테스트 중요</td><td>Unit Test (pytest, JUnit), E2E Test + Mocking 구성</td></tr><tr><td><strong>운영</strong></td><td>관찰성 (Observability)</td><td>문제 원인 추적 및 성능 병목 분석을 위한 가시성 필요</td><td>Prometheus, Grafana, OpenTelemetry, Zipkin 연동</td></tr><tr><td></td><td>구조화된 로깅</td><td>로그 검색/추적 어려움, 분산 환경에서는 상관 관계 파악 필요</td><td>JSON 기반 로그, Trace/Correlation ID 포함, 중앙 로그 수집 (ELK, Loki 등)</td></tr><tr><td></td><td>에러 처리 및 알림 체계 구축</td><td>장애 발생 시 빠른 인지와 복구 중요</td><td>Alertmanager, Slack/PagerDuty 연동, SLA 기반 에러 레벨 설정</td></tr><tr><td></td><td>운영 자동화</td><td>배포/스케일링/복구 자동화 필요</td><td>Kubernetes Job/CronJob, Helm, CI/CD 파이프라인 활용</td></tr><tr><td><strong>보안</strong></td><td>데이터 보호</td><td>민감한 데이터 전송 시 보안 미흡은 치명적</td><td>전송 중 암호화 (TLS), 저장소 암호화 (AES), 인증/인가 기반 API 보안</td></tr><tr><td></td><td>인증/인가</td><td>각 필터 또는 인터페이스 호출 시 무분별한 접근 방지</td><td>OAuth 2.0, JWT, API Gateway 인증 정책 적용</td></tr><tr><td><strong>확장성</strong></td><td>유연한 확장 설계</td><td>요구사항 변화에 따른 필터 추가/제거의 용이성 확보</td><td>마이크로서비스 형태 배포, Loose Coupling 구조 유지, 서비스 레지스트리 도입</td></tr><tr><td></td><td>수평 확장</td><td>부하 증가 대응을 위한 스케일 아웃 구조 필요</td><td>Kubernetes + Horizontal Pod Autoscaler, Sharding, Partitioning 전략 적용</td></tr></tbody></table><ul><li><strong>설계 관점</strong>에서는 <em>명확한 인터페이스</em>, <em>단일 책임 필터</em>, _ 상태 분리 설계 _ 가 핵심.</li><li><strong>구현 관점</strong>에서는 <em>비동기화</em>, <em>오류 격리</em>, <em>테스트 자동화</em> 등 모듈화 기반 품질 확보 전략이 필요.</li><li><strong>운영 관점</strong>에서는 <em>관찰성 강화</em>, <em>로깅 구조화</em>, _ 자동화된 알림 시스템 _ 이 요구됨.</li><li><strong>보안·확장성</strong> 측면에서는 <em>암호화</em>, <em>인증/인가 통합</em>, _ 마이크로서비스 기반 확장 전략 _ 이 필수적.</li></ul><h3 id=최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th><strong>최적화 영역</strong></th><th><strong>구체 항목</strong></th><th><strong>설명</strong></th><th><strong>권장 전략 및 적용 기법</strong></th></tr></thead><tbody><tr><td><strong>성능 최적화</strong></td><td>메모리 관리</td><td>불필요한 데이터 복사, GC 부하 등으로 인한 성능 저하 방지</td><td>Zero-copy, 객체 재사용, 메모리 풀</td></tr><tr><td></td><td>CPU 효율성</td><td>필터 로직 복잡도, 연산 병목에 따른 CPU 자원 낭비 방지</td><td>연산 병합, JIT, SIMD, 핫스팟 최적화</td></tr><tr><td></td><td>네트워크 효율화</td><td>분산 필터 간 통신 시 전송량 및 지연 최소화</td><td>압축, 배치 전송, CDN, 커넥션 풀링</td></tr><tr><td></td><td>데이터 복사 최소화</td><td>파이프 간 참조 전달을 통해 처리 비용 절감</td><td>Pass-by-reference 처리 방식 적용</td></tr><tr><td><strong>처리량 향상</strong></td><td>병렬 처리</td><td>필터 단위 병렬화 또는 내부 병렬 처리를 통해 전체 처리량 향상</td><td>워커 풀, 멀티스레드, 멀티프로세스, async I/O</td></tr><tr><td></td><td>배치 처리</td><td>단일 레코드 대신 일정 단위로 묶어 처리하여 I/O 및 처리 비용 감소</td><td>윈도우 기반 집계, 버퍼 기반 배치 실행</td></tr><tr><td></td><td>상태 최소화</td><td>상태 유지 시 성능 저하 우려, 외부 저장소 활용 권장</td><td>상태 분리, Redis/DB 연동, CQRS 활용</td></tr><tr><td><strong>지연 시간 감소</strong></td><td>실시간 처리 최적화</td><td>실시간 스트림 처리 시 지연 최소화 필요</td><td>인메모리 처리, 사전 할당, NoGC 환경</td></tr><tr><td></td><td>캐싱 전략</td><td>자주 사용하는 데이터를 필터 앞단에서 캐싱하여 응답 속도 향상</td><td>LRU, 계층 캐싱, local/distributed cache</td></tr><tr><td></td><td>로깅 최적화</td><td>과도한 로그 출력은 지연 증가 및 디스크/CPU 사용률 상승 원인</td><td>수준별 로깅, 핵심 이벤트 중심 로그 설정</td></tr><tr><td><strong>리소스 관리</strong></td><td>리소스 사용량 관리</td><td>필터별 자원 과소/과다 할당 방지 및 유휴 자원 활용</td><td>리소스 쿼터 설정, JVM/Container 리밋 조정</td></tr><tr><td></td><td>자동 스케일링</td><td>처리량에 따라 유동적으로 필터 수를 확장/축소</td><td>HPA, KEDA, 워커 큐 기반 스케일링</td></tr><tr><td></td><td>버퍼 크기 최적화</td><td>파이프 간 데이터 흐름 최적화를 위한 버퍼 동적 조정</td><td>처리율 기반 버퍼 크기 튜닝, backpressure 연동</td></tr><tr><td><strong>운영 안정성</strong></td><td>병목 분석</td><td>특정 필터가 전체 흐름을 제한하는 경우 성능 급락 유발 가능</td><td>병목 필터 분리, 병렬 처리, 필터 분해</td></tr><tr><td></td><td>장애 격리 및 복구</td><td>특정 필터 실패가 전체 파이프라인에 영향을 미치지 않도록 설계</td><td>Circuit Breaker, DLQ, Checkpointing</td></tr><tr><td></td><td>순서 보장</td><td>병렬 처리 또는 메시지 재전송 시 순서 변경으로 인한 데이터 정합성 문제 가능</td><td>메시지 ID, 정렬 버퍼, 순차 큐 처리</td></tr><tr><td><strong>품질/테스트</strong></td><td>단위 테스트 자동화</td><td>필터 단위 검증 없이 전체 파이프라인만 검증할 경우 문제 추적이 어려움</td><td>필터 단위 테스트 작성, CI/CD 연동</td></tr><tr><td></td><td>성능 테스트</td><td>실제 처리량, 지연 시간에 대한 사전 검증 부족 시 운영 중 장애 유발 가능</td><td>부하 테스트, 지표 기반 벤치마킹 (JMeter, k6 등)</td></tr></tbody></table><h3 id=주제와-관련하여-주목할-내용>주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#주제와-관련하여-주목할-내용>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>주제</strong></th><th><strong>항목</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>1. 아키텍처 구조</strong></td><td>아키텍처 스타일</td><td>Pipe-and-Filter</td><td>모듈화, 재사용성, 병렬 처리에 적합한 흐름 기반 아키텍처 스타일</td></tr><tr><td></td><td>데이터 흐름</td><td>일방향 / 양방향</td><td>데이터가 일직선으로 또는 양방향으로 이동 가능</td></tr><tr><td></td><td>데이터 처리 모델</td><td>Stateless / Stateful Filter</td><td>필터의 상태 여부에 따라 구현 방식과 테스트 전략이 달라짐</td></tr><tr><td></td><td>동기화 구조</td><td>동기 / 비동기 / 버퍼 기반</td><td>파이프의 연결 방식 및 처리 흐름을 제어하는 구조</td></tr><tr><td><strong>2. 구현 전략</strong></td><td>모듈화</td><td>필터 분리 및 독립성</td><td>각 필터는 독립적으로 개발/배포 가능하며, 테스트 단위로도 활용 가능</td></tr><tr><td></td><td>병렬 처리</td><td>필터 병렬 실행 및 수평 확장</td><td>멀티 스레드, 워커 풀, 컨테이너 기반 병렬 실행 가능</td></tr><tr><td></td><td>데이터 포맷 일관성</td><td>표준화된 인터페이스</td><td>필터 간 데이터 형식 일관성 확보 필요 (예: JSON Schema, Avro 등)</td></tr><tr><td></td><td>장애 대응</td><td>예외 격리, DLQ, 백프레셔 등</td><td>각 필터 단위로 장애를 격리하고 처리 실패 시 별도 처리 가능</td></tr><tr><td><strong>3. 실무 적용 분야</strong></td><td>데이터 처리 파이프라인</td><td>ETL, CDC, 로그 집계, 센서 데이터 등</td><td>대용량 배치 및 실시간 스트림 처리 모두에 활용 가능</td></tr><tr><td></td><td>멀티미디어 처리</td><td>이미지, 오디오, 비디오 파이프라인</td><td>GStreamer 기반 필터 적용 예시 존재</td></tr><tr><td></td><td>스트림 처리</td><td>실시간 데이터 스트림</td><td>Kafka Streams, Flink 등 연계 가능</td></tr><tr><td></td><td>반응형 프로그래밍</td><td>Reactive Streams, 백프레셔</td><td>실시간 시스템에서 유연한 흐름 제어 가능</td></tr><tr><td><strong>4. 기술 스택 연계</strong></td><td>프레임워크</td><td>Kafka Streams, Flink, GStreamer</td><td>필터 - 파이프 구조 기반으로 다양한 도메인에 활용 가능</td></tr><tr><td></td><td>서버리스 아키텍처</td><td>AWS Lambda</td><td>필터를 함수형으로 구현하여 유연하고 탄력적인 확장 가능</td></tr><tr><td></td><td>Container Orchestration</td><td>Kubernetes, Docker</td><td>필터 단위를 컨테이너로 배포 및 스케일링</td></tr><tr><td></td><td>Service Mesh</td><td>Istio, Linkerd 등</td><td>필터 간 통신을 추적하고 정책 기반 제어 가능</td></tr><tr><td><strong>5. 운영 및 품질 관리</strong></td><td>Observability</td><td>분산 추적 (Tracing), APM</td><td>파이프라인 가시성 확보 및 병목 원인 추적</td></tr><tr><td></td><td>CI/CD</td><td>Pipeline as Code</td><td>파이프라인 구성을 코드로 관리 및 자동 배포 가능</td></tr><tr><td></td><td>데이터 계보 및 스키마 관리</td><td>Data Lineage, Schema Registry</td><td>데이터 흐름 추적 및 필터 간 스키마 호환성 보장</td></tr><tr><td></td><td>예외 처리 및 복구 전략</td><td>DLQ, Circuit Breaker</td><td>장애 시 데이터 유실 없이 복구 가능하도록 설계</td></tr><tr><td><strong>6. 아키텍처 패턴 연계</strong></td><td>Event Sourcing</td><td>이벤트 저장 기반의 처리 패턴</td><td>파이프라인의 이벤트 기반 설계에 활용</td></tr><tr><td></td><td>CQRS</td><td>읽기/쓰기 분리 구조</td><td>처리 성능 최적화 및 필터 역할 분리</td></tr><tr><td></td><td>Event-Driven Architecture</td><td>이벤트 기반 마이크로서비스 확장</td><td>필터 간 느슨한 결합 유지에 효과적</td></tr><tr><td></td><td>Data Mesh / Orchestration</td><td>도메인 중심 데이터 파이프라인 설계</td><td>복잡한 엔터프라이즈 데이터 흐름 관리에 활용</td></tr></tbody></table><ul><li><strong>Pipe-and-Filter</strong>는 단순 아키텍처 스타일을 넘어 <strong>프로그래밍 모델, 운영 전략, DevOps/Observability, 그리고 데이터 거버넌스까지 포괄</strong>하는 구조로 진화 가능.</li><li>Kafka, Flink, GStreamer 등은 이 스타일을 실현한 <strong>대표 프레임워크/엔진</strong>으로, 도메인에 따라 유연한 적용이 가능함.</li><li><strong>Stateless vs Stateful</strong>, <strong>Push vs Pull</strong>, <strong>동기 vs 비동기</strong> 구조는 설계 성능에 결정적 영향을 미치므로 아키텍처 초기 설계 시 명확히 구분해야 함.</li></ul><h3 id=반드시-학습해야할-내용>반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야할-내용>#</a></h3><table><thead><tr><th><strong>대분류</strong></th><th><strong>중분류</strong></th><th><strong>핵심 항목</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>기초 이론</strong></td><td>소프트웨어 아키텍처 개념</td><td>Data-Flow Architecture</td><td>흐름 기반 처리 아키텍처의 상위 개념으로, Pipe-and-Filter 포함됨</td></tr><tr><td></td><td>아키텍처 비교 분석</td><td>Pipeline Pattern</td><td>유사 구조의 구현 패턴 (필터 체인 등) 과 비교 분석</td></tr><tr><td></td><td>운영체제 기초</td><td>Unix Pipe Mechanism</td><td>Unix/Linux 파이프 기반 동작 원리와 필터 개념 이해</td></tr><tr><td></td><td>분산 시스템 이론</td><td>CAP Theorem</td><td>Pipe-and-Filter 아키텍처의 분산 처리 시 일관성/가용성/분할 허용성 고려 사항</td></tr><tr><td></td><td>통합 패턴</td><td>Enterprise Integration Patterns</td><td>시스템 간 통합에서 필터 및 메시지 흐름 구성에 활용되는 패턴 집합</td></tr><tr><td><strong>핵심 설계 원칙</strong></td><td>객체지향 설계 원칙</td><td>SOLID - SRP</td><td>각 필터는 단일 책임 원칙 (SRP) 을 따라야 유지보수성 확보 가능</td></tr><tr><td></td><td>상태 관리 전략</td><td>Stateless vs Stateful Filters</td><td>필터의 상태 유지 여부에 따른 처리 방식, 병렬화/확장성 전략</td></tr><tr><td></td><td>동시성 모델</td><td>Thread-safe Filter Design</td><td>멀티스레드 환경에서의 안전한 필터 설계 원칙</td></tr><tr><td></td><td>흐름 제어</td><td>Backpressure, Buffering</td><td>처리 지연 방지 및 흐름 안정화를 위한 핵심 제어 전략</td></tr><tr><td><strong>구현 기술</strong></td><td>비동기/동기 프로그래밍</td><td>Async / Await, Threading</td><td>필터 동작의 실행 방식과 흐름 컨트롤 방식에 대한 이해</td></tr><tr><td></td><td>스트림 처리 프레임워크</td><td>Apache Flink, Kafka Streams</td><td>실시간 필터 기반 스트림 처리 구현 기술</td></tr><tr><td></td><td>미디어 파이프라인</td><td>GStreamer, FFmpeg</td><td>오디오/비디오 스트리밍 처리에서의 필터 파이프 구조 구현</td></tr><tr><td></td><td>메시지 큐</td><td>Apache Kafka, RabbitMQ</td><td>필터 간 비동기 메시지 전달을 위한 인프라 기술</td></tr><tr><td><strong>테스트 및 운영</strong></td><td>단위 및 통합 테스트</td><td>필터 단위 테스트 전략</td><td>각 필터의 유닛 테스트 구성과 파이프라인 전체 테스트 전략</td></tr><tr><td></td><td>모니터링/로깅</td><td>Prometheus, Grafana, 로그 수집기</td><td>파이프라인 상태 추적 및 성능 모니터링 체계 구축</td></tr><tr><td></td><td>장애 대응</td><td>체크포인트, 재처리 전략</td><td>중간 상태 저장 및 장애 복구를 위한 설계 기법</td></tr><tr><td><strong>실무 적용 사례</strong></td><td>데이터 파이프라인</td><td>ETL, 로그 처리</td><td>실무에서 Pipe-and-Filter 기반으로 구성되는 처리 흐름의 대표적 적용 사례</td></tr><tr><td></td><td>컴파일러</td><td>Lexer → Parser → Optimizer</td><td>소스 코드 처리에서 Pipe-and-Filter 구조가 적용되는 대표 사례</td></tr><tr><td></td><td>IoT, 이벤트 기반 시스템</td><td>센서 수집 → 필터 → 알림</td><td>이벤트 기반 데이터 흐름에 필터 체인을 적용한 실시간 처리 예시</td></tr></tbody></table><ul><li><strong>Data-Flow Architecture</strong>는 Pipe-and-Filter 의 상위 개념이며, <strong>분산 시스템, 스트림 처리, ETL</strong> 등 다양한 도메인에서 적용됨.</li><li>설계 시 필터의 <strong>책임 분리, 상태 관리, 동시성 고려, 흐름 제어</strong>를 기반으로 한 패턴 적용이 중요함.</li><li>실무에서는 <strong>Apache Flink, GStreamer, Kafka, Prometheus</strong> 등의 도구와 결합되어 활용됨.</li><li>테스트와 운영까지 고려한 <strong>엔드 - 투 - 엔드 품질 확보 전략</strong>이 필요함 (테스트 자동화, 로깅, 복구 전략 등 포함).</li></ul><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th><strong>카테고리</strong></th><th><strong>용어</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>아키텍처 개념</strong></td><td>Pipe-and-Filter Architecture</td><td>데이터 흐름을 처리하는 여러 ** 필터 (Filter)** 와 이를 연결하는 ** 파이프 (Pipe)** 로 구성된 구조. 각 필터는 독립적으로 실행되며 파이프는 데이터 전송을 담당함.</td></tr><tr><td><strong>구성 요소</strong></td><td>Filter</td><td>입력 데이터를 변환하거나 처리한 뒤 출력하는 독립적 처리 단위. Stateless 또는 Stateful 구조로 구현될 수 있음.</td></tr><tr><td></td><td>Pipe</td><td>필터 간 데이터를 전달하는 연결 경로. 직렬, 병렬, 버퍼링 구조로 구성 가능함.</td></tr><tr><td></td><td>Source (Pump)</td><td>데이터 파이프라인의 시작점에서 데이터를 생성하거나 수집하는 요소.</td></tr><tr><td></td><td>Sink</td><td>파이프라인의 종료점에서 결과 데이터를 소비하거나 저장하는 요소.</td></tr><tr><td></td><td>Buffer</td><td>필터 간 데이터 흐름을 조절하기 위한 임시 저장 공간. 비동기 처리나 병렬성을 지원함.</td></tr><tr><td></td><td>Splitter</td><td>하나의 데이터 스트림을 여러 개로 분기하는 역할을 수행하는 구성 요소.</td></tr><tr><td></td><td>Aggregator</td><td>여러 데이터 스트림을 하나로 통합하여 처리하는 필터.</td></tr><tr><td><strong>처리 모델</strong></td><td>Stateless Filter</td><td>내부 상태를 저장하지 않고 입력만으로 처리하는 단순 구조. 병렬 처리 및 테스트에 적합함.</td></tr><tr><td></td><td>Stateful Filter</td><td>세션, 집계 등 내부 상태를 유지하면서 처리하는 구조. 외부 저장소 (RocksDB 등) 와 연계됨.</td></tr><tr><td></td><td>Push-based Processing</td><td>상위 필터가 데이터를 생성하여 하위 필터로 즉시 전달하는 방식. 실시간/스트림 처리에 적합.</td></tr><tr><td></td><td>Pull-based Processing</td><td>하위 필터가 필요 시 상위 필터로부터 데이터를 요청하는 방식. 제어 흐름 관리에 유리함.</td></tr><tr><td><strong>최적화 및 성능</strong></td><td>Backpressure</td><td>데이터 생산과 소비 속도 차이로 인한 병목 현상을 제어하는 메커니즘.</td></tr><tr><td></td><td>Flow Control</td><td>전체 파이프라인의 데이터 흐름을 조절하여 시스템의 안정성과 처리량 보장.</td></tr><tr><td></td><td>Zero-Copy</td><td>데이터 복사를 줄여 처리 속도 및 효율성을 높이는 성능 최적화 기법.</td></tr><tr><td></td><td>Throughput</td><td>단위 시간당 처리 가능한 데이터 양. 병렬 처리 구조와 밀접한 연관이 있음.</td></tr><tr><td></td><td>Latency</td><td>데이터가 시스템을 통과하는 데 걸리는 시간. 파이프라인 단계 수 및 병렬성 영향 받음.</td></tr><tr><td><strong>운영 및 장애 처리</strong></td><td>Checkpoint</td><td>상태 저장 및 장애 발생 시 복구 가능한 중간 저장 지점. 스트림 처리 엔진에서 필수 요소.</td></tr><tr><td></td><td>Dead Letter Queue (DLQ)</td><td>처리 실패한 메시지를 별도로 저장하여 재처리나 분석에 활용하는 큐.</td></tr><tr><td></td><td>Circuit Breaker</td><td>장애 발생 시 전체 시스템 확산을 방지하고, 부분 장애를 격리하는 보호 패턴.</td></tr><tr><td></td><td>Idempotency</td><td>동일한 연산을 여러 번 수행해도 결과가 동일한 성질. 메시지 중복 처리에 필수.</td></tr><tr><td><strong>모니터링 및 추적</strong></td><td>Logging / Monitoring</td><td>각 필터/파이프 상태를 추적하고, 운영 지표를 수집하여 장애를 조기에 감지함.</td></tr><tr><td></td><td>Distributed Tracing</td><td>분산된 필터 간 처리 경로 전체를 추적하여 성능 병목, 지연 등을 분석하는 기법.</td></tr><tr><td></td><td>Correlation ID</td><td>서로 다른 필터 또는 시스템 간 이벤트를 식별하고 추적할 수 있도록 해주는 고유 ID.</td></tr><tr><td><strong>데이터 품질/보안</strong></td><td>Schema Registry</td><td>필터 간 주고받는 데이터의 스키마를 중앙에서 관리하고 검증하는 시스템.</td></tr><tr><td></td><td>Data Lineage</td><td>데이터의 생성부터 소멸까지의 흐름을 추적하여 변경 이력, 출처, 품질 보장 등을 확인함.</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><h3 id=개념-및-아키텍처-설명>개념 및 아키텍처 설명<a hidden class=anchor aria-hidden=true href=#개념-및-아키텍처-설명>#</a></h3><ul><li><a href=https://www.geeksforgeeks.org/pipe-and-filter-architecture-system-design/>Pipe and Filter Architecture - GeeksforGeeks</a></li><li><a href=https://learn.microsoft.com/en-us/azure/architecture/patterns/pipes-and-filters>Pipes and Filters Pattern - Azure Architecture Center</a></li><li><a href=https://medium.com/@tkchandravadhana/pipe-and-filter-architecture-style-f0e317df4c85>Pipe-and-Filter Architecture Style - Medium (Chandravadhana TK)</a></li><li><a href=https://kisztof.medium.com/mastering-the-pipes-and-filters-architecture-5743ed26f5e0>Mastering the Pipes and Filters Architecture - Medium (Krzysztof Słomka)</a></li><li><a href=https://handbook.chaineapp.com/handbook/engineering/resources/architecture/the-pipes-and-filters-design-pattern>What is the Pipes and Filters Design Pattern? - Chaine Handbook</a></li><li><a href=https://medium.com/@tanyuryan/software-architecture-pipe-and-filter-899a7e00c1eb>Pipe and Filter Architecture - Tanyuryan (Medium)</a></li><li><a href=https://www.enterpriseintegrationpatterns.com/patterns/messaging/PipesAndFilters.html>Enterprise Integration Patterns - Pipes and Filters</a></li><li><a href=https://cs.uwaterloo.ca/~m2nagapp/courses/CS446/1195/Arch_Design_Activity/PipeFilter.pdf>Pipe & Filter Pattern - University of Waterloo (PDF)</a></li><li><a href=https://en.wikipedia.org/wiki/Pipeline_%28Unix%29>Pipes and Filters - Wikipedia (Unix context)</a></li><li><a href=https://www.linkedin.com/pulse/pipe-filter-architecture-suraj-kumar-0horc>Pipe and Filter Architecture Overview - LinkedIn</a></li></ul><h3 id=관련-구현-도구-및-프레임워크>관련 구현 도구 및 프레임워크<a hidden class=anchor aria-hidden=true href=#관련-구현-도구-및-프레임워크>#</a></h3><ul><li><a href=https://nifi.apache.org/docs/nifi-docs/html/overview.html>Apache NiFi Overview</a></li><li><a href=https://nifi.apache.org/docs.html>Apache NiFi 공식 문서</a></li><li><a href=https://gstreamer.freedesktop.org/>GStreamer 공식 사이트</a></li><li><a href=https://gstreamer.freedesktop.org/documentation/fundamentals/architecture.html>GStreamer Architecture Overview</a></li><li><a href=https://ffmpeg.org/ffmpeg-filters.html>FFmpeg Filters Documentation</a></li><li><a href=https://nightlies.apache.org/flink/flink-docs-master/>Apache Flink Documentation</a></li></ul><h3 id=아키텍처-분류-및-관련-이론>아키텍처 분류 및 관련 이론<a hidden class=anchor aria-hidden=true href=#아키텍처-분류-및-관련-이론>#</a></h3><ul><li><a href=https://martinfowler.com/architecture/>Software Architecture Patterns - Martin Fowler</a></li><li><a href=https://resources.sei.cmu.edu/asset_files/WhitePaper/2013_019_001_29791.pdf>SEI CMU Whitepaper - Data Flow Architecture (PDF)</a></li><li><a href=https://en.wikipedia.org/wiki/Dataflow_architecture>Dataflow Architecture - Wikipedia</a></li></ul><h3 id=보조-자료-및-실전-블로그>보조 자료 및 실전 블로그<a hidden class=anchor aria-hidden=true href=#보조-자료-및-실전-블로그>#</a></h3><ul><li><a href=https://medium.com/@nadaralp16/mastering-pipes-and-filters-a-messaging-system-pattern-adcfe7ec1c83>Pipes and Filters in Messaging - Medium (nadaralp16)</a></li><li><a href=https://www.gaurgaurav.com/patterns/pipes-and-filters/>Pipes and Filters Pattern - Streamlining Data Processing (gaurgaurav.com)</a></li><li><a href=https://blog.doubleslash.de/en/software-technologien/pipes-and-filters/>Pipe and Filter Architecture - Easily Expandable (doubleslash Blog)</a></li><li><a href=https://www.modernescpp.com/index.php/pipes-and-filters/>Pipes-and-Filters vs. Layers Pattern - ModernesCpp</a></li></ul><hr></div></main><footer class=footer><span>&copy; 2026 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>