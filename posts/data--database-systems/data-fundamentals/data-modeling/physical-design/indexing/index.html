<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Indexing | hyunyoun's Blog</title><meta name=keywords content="Data-and-Database-Systems,Data-Fundamentals,Data-Modeling,Physical-Design,Indexing"><meta name=description content="인덱스는 테이블의 특정 컬럼에 대한 검색을 빠르게 수행할 수 있도록 도와주는 자료 구조"><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/data--database-systems/data-fundamentals/data-modeling/physical-design/indexing/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/data--database-systems/data-fundamentals/data-modeling/physical-design/indexing/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/data--database-systems/data-fundamentals/data-modeling/physical-design/indexing/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/data--database-systems/data-fundamentals/data-modeling/physical-design/indexing/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Indexing"><meta property="og:description" content="인덱스는 테이블의 특정 컬럼에 대한 검색을 빠르게 수행할 수 있도록 도와주는 자료 구조"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Indexing"><meta name=twitter:description content="인덱스는 테이블의 특정 컬럼에 대한 검색을 빠르게 수행할 수 있도록 도와주는 자료 구조"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Indexing","item":"https://buenhyden.github.io/posts/data--database-systems/data-fundamentals/data-modeling/physical-design/indexing/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a></div><h1>Indexing</h1><div class=post-description>인덱스는 테이블의 특정 컬럼에 대한 검색을 빠르게 수행할 수 있도록 도와주는 자료 구조</div></header><div class=post-content><h2 id=indexing>Indexing<a hidden class=anchor aria-hidden=true href=#indexing>#</a></h2><h3 id=1단계-기본-분석-및-검증>1단계: 기본 분석 및 검증<a hidden class=anchor aria-hidden=true href=#1단계-기본-분석-및-검증>#</a></h3><h4 id=주제-유형-식별>주제 유형 식별<a hidden class=anchor aria-hidden=true href=#주제-유형-식별>#</a></h4><ul><li>**Indexing(색인화)**는 데이터 및 데이터베이스 시스템에서의 <strong>물리적 설계(Physical Design)</strong> 하위의 **이론/개념형(A형)**과 <strong>도구/기술형(B형)</strong> 특성이 동시에 나타나는 주제입니다.[1][2][3]</li><li>DBMS(데이터베이스 관리 시스템)에서 색인(Index)은 데이터 접근 성능 극대화를 위해 설계 및 구현됩니다.</li></ul><h4 id=복잡도-평가level-2-중급>복잡도 평가(Level 2: 중급)<a hidden class=anchor aria-hidden=true href=#복잡도-평가level-2-중급>#</a></h4><ul><li><strong>기초 + 특화 항목, 구현 사례 추가</strong>가 적합합니다. 각종 인덱스 방식의 정의, 특성, 장단점, 실무 적용 및 최신 동향까지 다루어야 합니다.[3][4][1]</li></ul><h4 id=대표-태그-생성>대표 태그 생성<a hidden class=anchor aria-hidden=true href=#대표-태그-생성>#</a></h4><ul><li>Indexing</li><li>Database-Physical-Design</li><li>Query-Optimization</li><li>DBMS</li><li>Data-Retrieval</li></ul><h4 id=분류-체계-검증-적합성-분석>분류 체계 검증: 적합성 분석<a hidden class=anchor aria-hidden=true href=#분류-체계-검증-적합성-분석>#</a></h4><ul><li>**현재 분류 구조(##6)**를 보면, &ldquo;Data and Database Systems > Data Fundamentals > Data Modeling > Physical Design&rdquo; 하위에 위치하는 것이 논리적으로 맞으며, 중복이나 경계 모호성도 적군요.[2][5]</li><li>&ldquo;Indexing"은 실무자의 검색, 재사용 관점에서 탐색성이 높고 유사 주제들과의 일관성도 확보됩니다.</li><li>다만, &ldquo;Indexing"은 Data Fundamentals의 Data Modeling보다 &ldquo;Physical Design&rdquo; 카테고리에서 좀 더 특화로 분류하는 것이 바람직합니다.</li><li>개선 제안: <strong>&ldquo;Data Modeling > Physical Design > Indexing"으로 소분류 도입</strong>하여, 기본/특화/심화 항목 분리 및 실제적 크로스 도메인 연결(성능, 운영 등) 반영.</li></ul><h4 id=핵심-요약-250자-이내>핵심 요약 (250자 이내)<a hidden class=anchor aria-hidden=true href=#핵심-요약-250자-이내>#</a></h4><ul><li><strong>색인(Indexing)은 데이터베이스 파일의 물리적 구조에 맞춰 빠른 검색, 효율적 저장, 데이터 무결성 보장 등 데이터 활용 최적화를 목표로 설계되는 원리와 구현 방식이다. 색인은 분류, 구조화, 액세스 패스 선택, 쿼리 최적화 등 물리적 디자인의 핵심 요소이다</strong>.[5][1][2]</li></ul><h4 id=전체-개요-600자-이내>전체 개요 (600자 이내)<a hidden class=anchor aria-hidden=true href=#전체-개요-600자-이내>#</a></h4><ul><li>색인(Indexing)은 DBMS(데이터베이스 관리 시스템)에서 대량의 데이터 중 특정 정보를 신속하게 검색하고 효율적으로 관리하기 위해 사용하는 자료 구조 및 알고리즘의 집합을 의미합니다. 색인은 물리적 설계(Physical Design) 단계에서 테이블의 중요한 컬럼에 추가적으로 생성되며, 주로 B+ 트리, 해시(해싱) 등 다양한 종류의 인덱스 구조가 존재합니다. 데이터의 추출, 정렬, 집계, 조인 등의 쿼리 작업이 반복적으로 발생하는 실무 환경에서, 색인의 적용은 성능 개선과 시스템 자원 절감의 가장 효과적인 방법입니다. 하지만 색인은 저장 공간 증가, 쓰기 작업 지연 등 부작용도 발생하므로, 현업에서는 쿼리 패턴 분석, 데이터 볼륨, 인덱스 유지 관리 등 최적화 전략이 필수적입니다. 최근에는 AI(인공지능) 기반 인덱스 추천, 자동 튜닝 등 최신 기술이 등장하며 색인의 현대적 활용과 운영 효율이 한층 강조되고 있습니다. 색인 설계는 데이터 모델링, 물리적 설계, 운영 및 최적화, 성능 개선까지 전 과정과 연계되어 있으며, 실무 현장에서 데이터 품질과 비용 효율화의 핵심 수단으로 자리합니다.[6][4][1][2][3]</li></ul><hr><h3 id=2단계-개념-체계화-및-검증>2단계: 개념 체계화 및 검증<a hidden class=anchor aria-hidden=true href=#2단계-개념-체계화-및-검증>#</a></h3><h4 id=핵심-개념-정리>핵심 개념 정리<a hidden class=anchor aria-hidden=true href=#핵심-개념-정리>#</a></h4><ul><li><strong>색인(Index, 인덱스)</strong>: 데이터베이스(DBMS)에서 테이블의 특정 컬럼(열) 혹은 컬럼 조합에 대해 데이터 검색 속도를 획기적으로 높이기 위해 사용하는 자료구조입니다. 인덱스는 (키, 물리적 주소) 쌍으로 정렬된 별도의 저장 구조를 생성하여, 테이블 전체를 순차적으로 검색하지 않고도 데이터 위치를 빠르게 찾을 수 있게 해줍니다.[1][2][3][4]</li><li><strong>구성 요소</strong>: 주로 검색 키(search key, 인덱싱 할 컬럼 값)와 포인터(pointer, 그 값이 실제 저장된 데이터의 위치)로 구성됩니다.[3][5]</li><li><strong>주요 구조</strong>: 주로 B-트리(B-Tree), B+트리(B+Tree), 해시(Hash Table) 등으로 구현되며, 정렬된 구조를 통해 이진 탐색이나 트리 검색을 활용합니다. 삼차로 bitmap, inverted 등 특수 인덱스도 존재합니다.[5][3]</li><li><strong>유형 및 동작</strong>: 프라이머리 인덱스(Primary Index), 세컨더리 인덱스(Secondary Index), 유니크 인덱스(Unique Index), 복합 인덱스(Composite Index)로 분류합니다. 각각 목적, 제약 조건, 성능에 따라 쓰임이 다릅니다.[6][1]</li><li><strong>DBMS 연계</strong>: 인덱스는 테이블, 스토리지(디스크/메모리), 쿼리 옵티마이저(Query Optimizer)와 밀접하게 연관되어 있으며, SELECT(조회), UPDATE(수정), DELETE(삭제) 동작의 성능에 직접 영향을 줍니다.[7][8][5]</li></ul><h4 id=주요-개념-상호-구조화>주요 개념 상호 구조화<a hidden class=anchor aria-hidden=true href=#주요-개념-상호-구조화>#</a></h4><ul><li><strong>인덱스와 테이블</strong>: 테이블의 데이터 행(row)은 별도의 데이터 파일에 저장되고, 인덱스는 이 행들에 대한 빠른 접근을 보장하는 “주소록” 역할을 합니다. 실제 쿼리에서는 WHERE 조건에 맞는 키를 인덱스에서 탐색, 해당 키의 레코드 위치(포인터)로 곧장 점프합니다.[2][4]</li><li><strong>검색/삽입/삭제 시 데이터 흐름</strong><ul><li>검색: 키를 이용해 인덱스를 빠르게 탐색, 포인터를 통해 원하는 데이터에 접근[4][3]</li><li>삽입/삭제/수정: 데이터가 바뀌면 인덱스 구조도 실시간 혹은 배치로 동기화됨. 빈번한 쓰기 작업에는 성능 부하가 커질 수 있음</li></ul></li><li><strong>쿼리 옵티마이저와의 연계</strong>: DBMS는 쿼리 실행 시 인덱스를 사용할지(=“인덱스를 탄다”) 아니면 풀 스캔(Full Table Scan)을 할지 자동으로 결정합니다. 이때 인덱스 설계가 실질적인 쿼리 성능에 결정적입니다.[8][7][5]</li><li><strong>물리적 스토리지 구조</strong>: 인덱스는 기본적으로 메모리에 상주하거나, 일부는 보조 저장장치(디스크, SSD 등)에 저장됩니다. 인덱스 파일 크기가 실제 데이터에 비해 작아 메모리 캐시에 효율적으로 로딩될 수 있습니다.[9][5]</li></ul><h4 id=실무-연관성-분석>실무 연관성 분석<a hidden class=anchor aria-hidden=true href=#실무-연관성-분석>#</a></h4><ul><li><strong>색인은 검색 중심 애플리케이션(웹, 금융, 이커머스 등)에서 빠른 응답 속도와 대규모 데이터 처리능력 구현의 핵심 수단입니다.</strong>[1][3][4]</li><li><strong>CRUD (조회,삽입,수정,삭제) 성능에 직접적인 영향</strong>: 조회 성능 극대화, 반면 쓰기/수정 성능 저하 및 저장 공간 증가라는 특성과 실무 트레이드오프 존재.[8][1]</li><li><strong>운영 환경에서 인덱스 활용 및 관리</strong>: 데이터 성장 및 쿼리 패턴 변화에 따라 인덱스 전략(생성/제거/튜닝/재구축 등)을 지속적으로 관리해야 안정적 품질 유지 가능.[3][8]</li><li><strong>정합성과 무결성</strong>: 유니크 인덱스, 프라이머리 인덱스를 활용하면 데이터 일관성과 무결성 유지에 실질적 기여.[3]</li><li><strong>최신 실무 동향</strong>: AI/ML 기반 자동 인덱스 추천, 인덱스 자동 최적화, NoSQL/빅데이터 환경에서의 특화 인덱싱(예: 복합·다차원 인덱스) 등 진화. 스토리지/메모리 최적화, 서버리스 환경 등에도 다각도 접목 중.[10][11]</li></ul><hr><p>이 내용들을 기반으로 **3단계 상세 조사(Phase 1-2: 기초 개념 및 원리·이론 기반, 상호 연계 등)**로 이어서 각 항목별로 심층 구조화 및 실무 활용 예시를 제시하겠습니다.</p><h3 id=2단계-개념-체계화-및-검증-1>2단계: 개념 체계화 및 검증<a hidden class=anchor aria-hidden=true href=#2단계-개념-체계화-및-검증-1>#</a></h3><h4 id=핵심-개념-정리-1>핵심 개념 정리<a hidden class=anchor aria-hidden=true href=#핵심-개념-정리-1>#</a></h4><ul><li>**인덱스(Index)**는 데이터베이스 테이블에서 데이터 검색 속도를 높이는 자료 구조이며, 주로 특정 컬럼(열) 또는 열의 조합에 대해 데이터를 빠르게 찾아낼 수 있도록 설계됩니다.[6][2][4][1]</li><li><strong>구성 개념</strong>: 인덱스는 주로 검색 키(search key, 인덱싱되는 컬럼 값)와 포인터(pointer, 데이터의 실제 위치)로 구성되어 있습니다.[5][3]</li><li><strong>주요 구조</strong>는 B-트리(B-Tree), B+트리(B+Tree), 해시(Hash Table) 등이며, 상황에 따라 bitmap 인덱스, 복합 인덱스 등도 사용됩니다.[5][3]</li><li>인덱스 유형에는 프라이머리 인덱스(Primary Index), 세컨더리 인덱스(Secondary Index), 유니크 인덱스(Unique Index), 복합 인덱스(Composite Index) 등이 포함되어, 적용 목적 및 제약에 따라 설정됩니다.[1][6]</li><li>**DBMS(데이터베이스 관리 시스템)**의 쿼리 옵티마이저(Query Optimizer)는 실행 계획 수립 시 인덱스를 사용할지, 또는 전체 테이블 스캔(Full Table Scan)을 수행할지 자동으로 판단하고 인덱스 선택이 성능에 직접적인 영향을 줍니다.[7][8][5]</li></ul><h4 id=핵심-개념-상호관계-구조>핵심 개념 상호관계 구조<a hidden class=anchor aria-hidden=true href=#핵심-개념-상호관계-구조>#</a></h4><ul><li>인덱스와 테이블: 인덱스는 테이블 데이터의 위치정보와 키 값을 분리된 구조로 관리하여 물리적 주소에 신속 접근을 가능하게 합니다.[2][4]</li><li>쿼리 실행시 데이터 흐름: 쿼리문의 WHERE 조건이 인덱싱된 컬럼을 사용하면, DBMS는 인덱스 구조를 탐색 후 포인터로 직접 해당 행(row)에 접근합니다.[4][3]</li><li>삽입/수정/삭제 연계: 인덱스 존재 시 INSERT, UPDATE, DELETE 연산에서 인덱스 구조도 함께 업데이트되므로, 쓰기 작업에서 성능 저하 및 관리 비용이 동반될 수 있습니다.[8][1]</li><li>저장 공간 및 물리적 구조: 인덱스는 일반적으로 테이블 전체 데이터 크기보다 훨씬 작은 용량으로 저장되고, 주로 메모리와 보조장치 간 효율적 캐싱이 가능합니다.[9][5]</li></ul><h4 id=실무-연관성-분석-1>실무 연관성 분석<a hidden class=anchor aria-hidden=true href=#실무-연관성-분석-1>#</a></h4><ul><li>인덱스는 <strong>대규모 데이터셋 기반의 웹 서비스, 금융, IoT 등 다양한 현업 시스템에서 실시간 검색 성능 개선의 핵심 수단</strong>입니다.[4][1]</li><li>설계·운영 단계에서 잘못된 인덱스 사용은 오히려 전체 시스템 부하 및 비용 증가를 초래할 수 있으므로, 데이터 패턴, 쿼리 빈도, 스토리지 특성 등 실무 요소를 반드시 고려해야 합니다.[3][8]</li><li>DB 튜닝, 운영 자동화, 인공지능 기반 인덱스 최적화 등 최신 기술과의 통합이 활발합니다.[11][10][8]</li><li>유니크 인덱스/프라이머리 인덱스는 데이터 무결성, 일관성 확보에도 중요한 역할을 담당합니다.[3]</li><li><strong>지속적 인덱스 관리와 모니터링</strong>이 없을 경우 오히려 성능 저하나 운영 장애로 이어질 수 있습니다.[8]</li></ul><hr><h4 id=phase-1-기초-조사-및-개념-정립>Phase 1: 기초 조사 및 개념 정립<a hidden class=anchor aria-hidden=true href=#phase-1-기초-조사-및-개념-정립>#</a></h4><hr><h5 id=11-개념-정의-및-본질적-이해>1.1 개념 정의 및 본질적 이해<a hidden class=anchor aria-hidden=true href=#11-개념-정의-및-본질적-이해>#</a></h5><ul><li>인덱스(Index, 색인)는 데이터베이스(DBMS, Database Management System)에서 테이블 내 특정 컬럼(column, 열) 값을 활용해 검색 속도를 비약적으로 높이기 위해 설계된 자료구조입니다.</li><li>테이블 전체를 순차 검색(Full Table Scan)하지 않고, 인덱스를 활용해 대상 데이터의 물리적 위치에 빠르게 접근하며, 도서의 목차처럼 &ldquo;찾기 위한 주소록&rdquo; 기능을 수행합니다.[1][2][3][4]</li></ul><hr><h5 id=12-등장-배경-및-발전-과정>1.2 등장 배경 및 발전 과정<a hidden class=anchor aria-hidden=true href=#12-등장-배경-및-발전-과정>#</a></h5><ul><li><strong>등장 배경</strong>: 1970년대 E.F. Codd의 관계형 데이터 모델 제안 이후, 데이터량 증가·실시간 질의(검색) 요구가 늘면서 효율적 데이터 접근 방식이 필수로 대두되었습니다. 초기엔 테이블 전체 순회 방식이 표준이었으나, 곧 대용량과 복잡한 질의 대응이 불가능해졌습니다.[5][6][7][1]</li><li><strong>발전 과정</strong>: 단일 컬럼 인덱스에서 시작해 여러 컬럼 복합 인덱스, B-트리(B-Tree), B+트리(B+Tree), 해시 인덱스(Hash Index), 비트맵 인덱스(Bitmap Index), 부분 인덱스 및 다차원(Spatial) 인덱스 등으로 진화했습니다. 최근은 AI·ML 기반 자동 인덱스 추천과 NoSQL 등 특화 환경에 맞는 신종 인덱스도 많이 활용되고 있습니다.[8][9][10][11]</li></ul><hr><h5 id=13-해결하는-문제-및-핵심-목적>1.3 해결하는 문제 및 핵심 목적<a hidden class=anchor aria-hidden=true href=#13-해결하는-문제-및-핵심-목적>#</a></h5><ul><li><strong>문제</strong>: 데이터 사이즈가 증가할수록 WHERE/ORDER BY/JOIN 등 쿼리 성능 저하가 심각해지며, 대량 데이터를 신속히 탐색·추출하는 부담이 급증합니다.[12][13][1]</li><li><strong>핵심 목적</strong>: 인덱스는 이 부하를 해결해 데이터 검색(=조회) 속도를 극적으로 개선하고, 복잡한 질의도 실시간으로 처리 가능한 효율적 DB환경을 조성합니다. 즉, &ldquo;디스크 I/O 최소화, 연산량 감소, 실시간 서비스 품질"이 주된 목표입니다.[9][3][4][8]</li></ul><hr><h5 id=15-핵심-특징기술적-근거-포함-타-기술과-차별점>1.5 핵심 특징(기술적 근거 포함, 타 기술과 차별점)<a hidden class=anchor aria-hidden=true href=#15-핵심-특징기술적-근거-포함-타-기술과-차별점>#</a></h5><ul><li><strong>빠른 검색</strong>: B-트리류 인덱스 기준 $$O(\log N)$$ 시간복잡도, 대용량에서도 신속히 원하는 데이터를 탐색.[14][1]</li><li><strong>정렬 기반 자료구조</strong>: 기본적으로 정렬·검색에 최적화된 자료구조를 사용(트리, 해시, 비트맵 등).[15][14]</li><li><strong>쿼리 옵티마이저 연계</strong>: DB 엔진의 쿼리 실행 전략 수립에 핵심적으로 작동—자동으로 인덱스 사용 경로를 결정.[1][12]</li><li><strong>공간-성능 트레이드오프</strong>: 테이블 뿐 아니라 별도 공간/메모리를 소모, INSERT/UPDATE/DELETE 등 쓰기 연산에는 추가 부하가 발생. 그러나 읽기(검색)에서 결정적 이득 제공.[3][8]</li><li><strong>복합/특수 인덱스 지원</strong>: 다수 컬럼, 다차원 데이터, 부분(Partial) 인덱싱 등 다양한 실무 상황에 맞춘 확장성 제공.[10][8][9]</li><li><strong>타 기술 차별점</strong>: 단순히 순차 탐색/해시맵과 달리 DBMS 내 데이터 정합성, 무결성, 대용량 연산, 동시성 제어 등과 적극 연계됨.[8][9]</li></ul><hr><h5 id=14-전제-조건-및-요구사항>1.4 전제 조건 및 요구사항<a hidden class=anchor aria-hidden=true href=#14-전제-조건-및-요구사항>#</a></h5><ul><li>데이터가 충분히 크고, 검색이 빈번한 실무 환경에서 유용성이 극대화됨.[12][1]</li><li>컬럼의 **분포도(Cardinality, 값의 다양성)**가 높은 경우 인덱스 효율이 극대화됨. 모든 값이 같은 컬럼은 인덱스 비효율.[1]</li><li>빈번한 데이터 쓰기(삽입/수정/삭제)가 많으면, 인덱스 관리에 따른 성능 저하 부담 발생 가능. 해당 상황에서는 인덱스 설계 시 점진적 튜닝 혹은 최소화 전략 필요.[13][8][1]</li></ul><hr><h5 id=level-3에서-적용할-경우-17-역사적-맥락-및-진화-과정>[Level 3에서 적용할 경우] 1.7 역사적 맥락 및 진화 과정<a hidden class=anchor aria-hidden=true href=#level-3에서-적용할-경우-17-역사적-맥락-및-진화-과정>#</a></h5><ul><li>1970년대 RDBMS의 대두와 함께 단순 인덱스 → B-트리, B+트리, 클러스터/비클러스터 인덱스, 특수 목적(비트맵, in-memory, 컬럼형, 다차원 등) 인덱스 순으로 진화. 최근엔 자동 추천과 AI튜닝 방식 활성화.[14][9][8]</li><li>NoSQL·빅데이터 환경과 함께 분산 인덱스, 실시간 동적 인덱싱 기법도 발전 중.</li></ul><hr><h5 id=level-3에서-적용할-경우-18-산업별-적용-현황-및-채택률>[Level 3에서 적용할 경우] 1.8 산업별 적용 현황 및 채택률<a hidden class=anchor aria-hidden=true href=#level-3에서-적용할-경우-18-산업별-적용-현황-및-채택률>#</a></h5><ul><li>대형 금융, 포털, 이커머스 등 데이터/트래픽 중심 기업에서는 정교한 인덱스 설계가 서비스 성능 및 품질의 핵심 경쟁력. 클라우드 PaaS(Platform as a Service), DBaaS(Database as a Service)에서도 자동 인덱싱 기능이 기본 장착되는 추세.[11][16][9][10]</li></ul><hr><h4 id=phase-2-핵심-원리-및-이론적-기반>Phase 2: 핵심 원리 및 이론적 기반<a hidden class=anchor aria-hidden=true href=#phase-2-핵심-원리-및-이론적-기반>#</a></h4><hr><h5 id=21-핵심-원칙-및-설계-철학>2.1 핵심 원칙 및 설계 철학<a hidden class=anchor aria-hidden=true href=#21-핵심-원칙-및-설계-철학>#</a></h5><ul><li>인덱싱(Indexing)의 핵심 원칙은 &lsquo;키(Key)&lsquo;와 &lsquo;포인터(Pointer)&lsquo;의 조합을 사용해 대규모 데이터 집합에서 **빠른 검색(빠른 데이터 위치 탐색)**을 실현하는 것입니다.</li><li>설계 철학은 &ldquo;읽기(검색) 성능 최우선, 최소한의 자원 소비, 데이터의 무결성과 정합성 보장"에 기반합니다. 추가적인 저장 공간과 쓰기 부하라는 대가로 읽기 성능을 극대화하는 전략적 타협이 내재되어 있습니다.[2][5]</li></ul><hr><h5 id=22-기본-동작-원리-및-메커니즘>2.2 기본 동작 원리 및 메커니즘<a hidden class=anchor aria-hidden=true href=#22-기본-동작-원리-및-메커니즘>#</a></h5><ul><li><strong>동작 흐름 요약</strong>:<ol><li>인덱스는 테이블(원본 데이터)과 별도로 (키, 물리주소) 쌍을 정렬된 구조로 별도 저장.[1][5]</li><li>검색 시(SELECT)는 인덱스 테이블을 통해 WHERE 조건에 맞는 값을 트리, 해시 등 자료구조에서 신속 처리.[7][1]</li><li>찾은 키와 연결된 물리주소(포인터)로 원본 테이블에서 해당 레코드(행)를 바로 추출합니다.[1][2]</li></ol></li><li><strong>B+트리 인덱스</strong>: 대부분의 RDBMS에서 사용하는 기본 구조. 트리의 루트 → 중간노드 → 리프노드(최종 데이터 참조)로 내려가면서 키 검색 과정을 거치며, 항상 균형잡힌 트리로 삽입/삭제/탐색 시도 $$O(\log n)$$ 복잡도를 가집니다.[9][7]</li><li><strong>해시 인덱스</strong>: 해시 함수를 이용해 값을 바로 특정 버킷에 매핑하는 방식. 동등 비교에 매우 빠르지만 범위검색에는 적합하지 않습니다.[5][9]</li></ul><hr><h5 id=23-데이터-및-제어-흐름생명주기-포함>2.3 데이터 및 제어 흐름(생명주기 포함)<a hidden class=anchor aria-hidden=true href=#23-데이터-및-제어-흐름생명주기-포함>#</a></h5><ul><li><strong>인덱스 생성</strong>: 테이블 구축, 새로운 컬럼 추가 등 필요 시 생성. 보통 SQL의 CREATE INDEX 문 또는 PK생성시 자동 생성.[2][7]</li><li><strong>검색(SELECT)</strong>: WHERE 또는 ORDER BY문에서 인덱싱된 컬럼 사용 시, 옵티마이저가 인덱스를 경유해 빠른 탐색 경로로 질의 실행.[7]</li><li><strong>삽입/삭제/수정</strong>: 데이터가 변경되면 인덱스도 즉시(혹은 배치/지연 동기 방식으로) 갱신되어야 하며, 이때 성능 부하가 일어날 수 있음.[5][2]</li><li><strong>인덱스 유지관리</strong>: 오래된 인덱스는 주기적으로 재구성(Rebuild)하거나, 불필요하면 Drop해서 DB성능을 유지.[2][7]</li></ul><hr><h5 id=24-구조-및-구성-요소계층모듈-구조-구조도-포함>2.4 구조 및 구성 요소(계층/모듈 구조, 구조도 포함)<a hidden class=anchor aria-hidden=true href=#24-구조-및-구성-요소계층모듈-구조-구조도-포함>#</a></h5><ul><li><strong>주요 구성</strong>:<ul><li>인덱스 키(Index Key): 인덱싱되는 컬럼 값</li><li>포인터(Pointer, RowID): 해당 값이 위치한 테이블 row 위치</li><li>노드(Node): 트리 또는 해시 자료구조에서 정보를 가지는 단위</li><li>리프 노드(Leaf Node): 실제 데이터 위치 또는 값 참조</li><li>논리/중간 노드(Branch/Inner Node): 경로 탐색용</li></ul></li><li><strong>구조도 설명</strong>:<ul><li>트리 계층 구조(루트/중간/리프)</li><li>인덱스 테이블과 실제 테이블(데이터 파일)이 분리</li><li>각 인덱스 노드는 &ldquo;값 - 주소&rdquo; 매핑으로 동작.[9][5][7]</li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2>2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3>3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4>4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;구조 개요 예시&gt;
</span></span><span class=line><span class=cl>[Root Node]
</span></span><span class=line><span class=cl>   ├── [Intermediate Node(s)]
</span></span><span class=line><span class=cl>       ├── [Leaf Node(s) (Key, Pointer)]
</span></span><span class=line><span class=cl>           └── [실제 데이터의 위치(RowID)]
</span></span></code></pre></td></tr></table></div></div><hr><h5 id=심화-26-고급-이론복잡도-동시성-등level-3>[심화] 2.6 고급 이론(복잡도, 동시성 등)(Level 3)<a hidden class=anchor aria-hidden=true href=#심화-26-고급-이론복잡도-동시성-등level-3>#</a></h5><ul><li>B+트리 인덱스: 균형 트리 기반. 검색, 삽입, 삭제 복잡도 모두 $$O(\log N)$$. 갱신 작업에도 성능 이점.</li><li>동시성 제어: Multi-Version Concurrency Control(MVCC), 인덱스 잠금 등 고급 DB 내부 동작과 연계.[5]</li><li>메모리/스토리지 계층 알고리즘: 인덱스 히트율, 캐싱, LSM 트리, 분산 환경 인덱스 등 현실 문제 해결 기법들과 연결.[11][12]</li></ul><hr><h5 id=27-타-시스템과의-상호작용-메커니즘>2.7 타 시스템과의 상호작용 메커니즘<a hidden class=anchor aria-hidden=true href=#27-타-시스템과의-상호작용-메커니즘>#</a></h5><ul><li>쿼리 실행마다 옵티마이저가 인덱스 유무·타입·통계정보·분포도(Cardinality) 등을 기반으로 실행계획을 산출.</li><li>테이블 JOIN, 대용량 집계, 다차원 데이터 검색 등 다수 DB핵심 기능과 밀접하게 연결.[9][5]</li></ul><hr><h4 id=phase-3-특성-분석-및-평가>Phase 3: 특성 분석 및 평가<a hidden class=anchor aria-hidden=true href=#phase-3-특성-분석-및-평가>#</a></h4><hr><h5 id=31-주요-장점-및-이점>3.1 주요 장점 및 이점<a hidden class=anchor aria-hidden=true href=#31-주요-장점-및-이점>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5>5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6>6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>| 장점                   | 상세 설명                                                                                                                  | 기술 근거                                                        | 적용 상황                        | 실무적 가치                     |
</span></span><span class=line><span class=cl>|------------------------|---------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|----------------------------------|----------------------------------|
</span></span><span class=line><span class=cl>| 검색 속도/성능 향상    | WHERE, JOIN, ORDER BY, GROUP BY 등에서 전체 테이블 순회 대신 키-포인터 구조로 대폭 빠른 데이터 조회 구현                    | B트리, B+트리, 해시 등 자료구조 기반 \(O(\log N)\) 탐색           | 대용량 DB, 빈번한 검색 질의      | 실시간 서비스·대량 트래픽 대응   |
</span></span><span class=line><span class=cl>| 연산 부하 감소         | 빠른 검색으로 인해 전체 시스템 CPU/메모리/디스크 부하와 응답 시간이 줄어듦                                                | DBMS의 내부 옵티마이저 최적화 로직 영향                         | 웹/금융/이커머스 등 실시간 환경  | 사용자 경험·운영비 절감          |
</span></span><span class=line><span class=cl>| 정렬·집계 성능 개선    | 데이터 정렬된 상태 유지, ORDER BY·MIN/MAX·집계 쿼리에서 별도 정렬 과정 없이 즉시 추출 가능                                 | 인덱스 내부 정렬 자료구조 활용                                   | 주기적 리포팅·데이터 대시보드    | 분석·리포팅 자동화               |
</span></span><span class=line><span class=cl>| 무결성·유일성 보장     | PRIMARY KEY, UNIQUE 제약조건 인덱스를 통해 중복 방지, 데이터 정합성 유지                                                   | 인덱스 기반 유니크 체크 로직                                     | ID·계좌번호 등 고유키 관리        | 데이터 품질 보증                 |
</span></span><span class=line><span class=cl>| JOIN·복합 연산 성능    | 테이블간 JOIN, 다양한 복합 쿼리에서 조건 컬럼별 인덱스 활용해 연산 처리 속도 비약적 향상                                   | 옵티마이저의 인덱스 기반 JOIN 경로 선택                          | 데이터 마트/분석 환경            | 쿼리 비용/자원 소모 최소화        |
</span></span></code></pre></td></tr></table></div></div><hr><h5 id=32-단점-및-제약사항>3.2 단점 및 제약사항<a hidden class=anchor aria-hidden=true href=#32-단점-및-제약사항>#</a></h5><h6 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3>3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4>4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5>5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>| 단점              | 상세 설명                                                            | 원인                          | 실무에서 발생되는 문제                  | 완화/해결 방안               | 대안 기술          |
</span></span><span class=line><span class=cl>|-------------------|---------------------------------------------------------------------|-------------------------------|----------------------------------------|------------------------------|--------------------|
</span></span><span class=line><span class=cl>| 저장 공간 증가    | 인덱스 자체가 별도 자료구조로 저장, DB 크기의 5~20% 추가 소모        | 별도 트리/해시 구조 유지      | 디스크 용량 부족, 비용 증가            | 필요 컬럼 최소 설계, 주기 삭제| 인메모리 캐시 등   |
</span></span><span class=line><span class=cl>| 쓰기 성능 저하    | INSERT/UPDATE/DELETE 시 인덱스도 함께 갱신하므로 성능 저하           | 인덱스 실시간 동기화          | 배치 작업·실시간 변동시 처리 지연      | 배치 인덱싱, 쓰기컬럼 제외    | 로그기반 분석 등   |
</span></span><span class=line><span class=cl>| 관리 복잡성       | 인덱스 과다·비효율적 설계시 오히려 성능 저하, 튜닝 업무 증가          | 인덱스 관리·옵티마이저 부담   | 쿼리/운영 장애, DBA 업무과중           | 쿼리패턴 분석, 자동추천 활용   | AI기반 튜닝        |
</span></span><span class=line><span class=cl>| 병렬성 감소       | 인덱스 컬럼에 동시 쓰기 동작시 잠금 경합, 병행성이 저하될 수 있음      | Row-level Lock 등 동시성 한계 | 다중 사용자 삽입·수정시 성능 저하      | 파티셔닝, 분산 인덱스 적용      | NoSQL 구조         |
</span></span></code></pre></td></tr></table></div></div><hr><h6 id=제약사항>제약사항<a hidden class=anchor aria-hidden=true href=#제약사항>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4>4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>| 제약사항         | 상세 설명                                               | 원인               | 영향             | 완화/해결 방안                    | 대안 기술              |
</span></span><span class=line><span class=cl>|------------------|--------------------------------------------------------|--------------------|------------------|------------------------------------|------------------------|
</span></span><span class=line><span class=cl>| 값 다양성 요구   | 중복도 높은(카디널리티 낮음) 컬럼은 인덱스 효율 급감   | 데이터 분포 특성   | 성능 효과 미미    | 값 분포 높은 컬럼 중심 설계        | 비트맵 인덱스, 통계기법|
</span></span><span class=line><span class=cl>| 업무부하 적합성  | 잦은 데이터 쓰기·수정 환경에서는 인덱스 효과 감소      | 동적 DB 트랜잭션   | 트랜잭션 지연     | 읽기/쓰기 분리, 인덱스 최소화 설계  | 파티션·쓰기가중 분리   |
</span></span><span class=line><span class=cl>| 물리적 DBMS별 차이| 각 DBMS마다 인덱스 구조·옵션 다름(이식성/호환성 이슈)  | 구현/아키텍처 상이 | 이식성·튜닝 한계 | DBMS별 최적화 가이드 활용           | 추상화 계층 도입       |
</span></span></code></pre></td></tr></table></div></div><hr><h5 id=33-트레이드오프-관계-분석>3.3 트레이드오프 관계 분석<a hidden class=anchor aria-hidden=true href=#33-트레이드오프-관계-분석>#</a></h5><ul><li><strong>읽기 속도 vs 쓰기 비용</strong>: 읽기(검색) 성능이 극적으로 오르는 반면, 쓰기(삽입/수정/삭제) 성능이 저하되고, 추가 저장 공간 및 관리 비용이 증가합니다. 읽기 중심 vs 쓰기 중심 워크로드에 따라 인덱스 전략이 달라집니다.[5][7][1][3]</li><li><strong>적정 인덱스 수 vs 성능 저하</strong>: 너무 많은 인덱스는 오히려 전체 시스템(옵티마이저, 캐시 등) 성능을 떨어뜨릴 수 있으므로, 쿼리 패턴과 데이터 크기 분석을 통한 최적화가 필요합니다.[4][2]</li></ul><hr><h5 id=34-적용-적합성-평가>3.4 적용 적합성 평가<a hidden class=anchor aria-hidden=true href=#34-적용-적합성-평가>#</a></h5><ul><li><strong>적합</strong><ul><li>대용량 테이블에서 검색 쿼리가 빈번한 경우</li><li>WHERE/JOIN/ORDER BY/집계 연산이 중심인 데이터 서비스</li><li>중복도(카디널리티)가 높은 컬럼</li><li>데이터 패턴이 주기적으로 일정하거나, 쓰기보다 읽기 트랜잭션이 비율상 많을 때</li></ul></li><li><strong>부적합</strong><ul><li>소규모/단순 테이블</li><li>데이터 변경이 매우 잦은 컬럼</li><li>값 분포가 거의 없는 컬럼(예: 성별, boolean 등)</li></ul></li></ul><hr><h4 id=phase-4-구현-방법-및-분류>Phase 4: 구현 방법 및 분류<a hidden class=anchor aria-hidden=true href=#phase-4-구현-방법-및-분류>#</a></h4><hr><h5 id=41-구현-방법-및-기법>4.1 구현 방법 및 기법<a hidden class=anchor aria-hidden=true href=#41-구현-방법-및-기법>#</a></h5><ul><li><p><strong>인덱스 생성</strong></p><ul><li>SQL 표준 구문 예시:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 단일 컬럼 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_col1</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=err>테이블명</span><span class=p>(</span><span class=err>컬럼</span><span class=mi>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 복합 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_col1_col2</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=err>테이블명</span><span class=p>(</span><span class=err>컬럼</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=err>컬럼</span><span class=mi>2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 유니크 인덱스(중복 불가)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_unique_col</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=err>테이블명</span><span class=p>(</span><span class=err>컬럼명</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스 삭제
</span></span></span><span class=line><span class=cl><span class=k>DROP</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=err>인덱스명</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li>인덱스는 실제 데이터 테이블과 별도의 저장 공간(페이지, 노드 구조 등)에 구축되며, DBMS 엔진 내부의 자료구조(B-트리, 해시 등)로 관리됩니다.[1][2][3][4][5]</li></ul></li><li><p><strong>활용 방식</strong></p><ul><li>쿼리문에서 WHERE/JOIN/ORDER BY 조건에 인덱싱된 컬럼이 등장하면 옵티마이저가 인덱스를 활용하는 실행 계획을 선택합니다.[6][7][4]</li></ul></li></ul><hr><h5 id=42-유형별-분류-체계>4.2 유형별 분류 체계<a hidden class=anchor aria-hidden=true href=#42-유형별-분류-체계>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>| 분류 기준        | 유형              | 주요 특징 및 목적                                      | 적용 예시                |
</span></span><span class=line><span class=cl>|------------------|------------------|-------------------------------------------------------|--------------------------|
</span></span><span class=line><span class=cl>| 구조적 분류      | 클러스터형(Clustered) | 데이터 행이 인덱스 순서에 맞춰 물리적으로 저장됨. 테이블당 1개 한정 | 보통 PK, MySQL InnoDB    |
</span></span><span class=line><span class=cl>|                  | 비클러스터형(Non-Clustered) | 인덱스/데이터가 별개로 저장. 여러 개 생성 가능            | 추가 색인, MSSQL 등      |
</span></span><span class=line><span class=cl>| 목적별 분류      | 프라이머리 인덱스(Primary) | PK 기반 인덱스, 데이터 정렬과 직접 연결됨                 | 기본키                   |
</span></span><span class=line><span class=cl>|                  | 세컨더리 인덱스(Secondary) | PK 이외 컬럼에 대한 색인, 데이터의 위치만 참조             | 서브쿼리, 다양한 필터    |
</span></span><span class=line><span class=cl>| 특수 인덱스      | 유니크 인덱스(Unique)    | 중복 불가 조건, 데이터 무결성 확보                        | 주민번호, ID             |
</span></span><span class=line><span class=cl>|                  | 복합 인덱스(Composite)  | 여러 컬럼을 동시에 묶어서 인덱싱                          | (성별, 나이) 복합조건    |
</span></span><span class=line><span class=cl>| 자료구조 분류    | B트리/B+트리 인덱스      | 최다 사용, 범위검색/정렬 지원, RDBMS 기본 구조             | 대부분 DBMS, MySQL       |
</span></span><span class=line><span class=cl>|                  | 해시 인덱스(Hash)       | 등식 비교 최적화, 범위불가, 빠른 단일 값 탐색               | NoSQL, 분산 DB           |
</span></span><span class=line><span class=cl>|                  | 비트맵 인덱스(Bitmap)   | 값 종류 적을 때(카디널리티↓), 대용량 집계에 유리             | 집계/분석 특화 DB        |
</span></span><span class=line><span class=cl>|                  | 공간 인덱스(Spatial)    | 좌표, 다차원 데이터 검색 최적화                              | GIS/IoT 등               |
</span></span></code></pre></td></tr></table></div></div><hr><h5 id=43-도구-및-라이브러리-생태계>4.3 도구 및 라이브러리 생태계<a hidden class=anchor aria-hidden=true href=#43-도구-및-라이브러리-생태계>#</a></h5><ul><li><strong>RDBMS별 인덱싱 엔진</strong><ul><li>MySQL InnoDB: 기본 B+트리 기반(클러스터드). 보조 인덱스/유니크, 부분 등 다양한 옵션 지원</li><li>PostgreSQL: B-Tree 기본, GiST(공간), GIN(역색인), BRIN(블록 범위) 등 복수 인덱스</li><li>Oracle: 클러스터형, 비클러스터형, 비트맵/함수기반 등 풍부한 타입</li><li>MSSQL: 클러스터/비클러스터, XML, 풀텍스트 등 확장</li></ul></li><li><strong>오픈소스 및 NoSQL</strong><ul><li>MongoDB: 기본 B-트리+복합인덱스 구조</li><li>Elasticsearch: 역색인 특화, 분산 환경 대용량 검색 최적화[8]</li></ul></li><li><strong>실무 도구</strong><ul><li>쿼리 전문가(SQL Profiler), 인덱스 분석툴(아키텍처 수준/실행계획 뷰어), 자동 인덱스 추천기능(AI/ML 기반) 등 활용 증가</li></ul></li></ul><hr><h5 id=44-표준-및-규격-준수사항>4.4 표준 및 규격 준수사항<a hidden class=anchor aria-hidden=true href=#44-표준-및-규격-준수사항>#</a></h5><ul><li>ANSI SQL: CREATE/DROP/ALTER INDEX 표준 명령어, PK/UNIQUE 제약조건과의 연계 적용 필수</li><li>DBMS별 DDL(데이터 정의 언어) 옵션 차이, 특수 인덱스/추가 속성은 각 벤더 가이드 참조 필요</li></ul><hr><h5 id=level-2-3-심화-46-안티패턴-및-주의사항>[Level 2-3 심화] 4.6 안티패턴 및 주의사항<a hidden class=anchor aria-hidden=true href=#level-2-3-심화-46-안티패턴-및-주의사항>#</a></h5><ul><li>필요 없는 컬럼 반복 인덱스 설정 → 디스크 낭비, 옵티마이저 혼란 초래</li><li>너무 많은 인덱스 → INSERT/UPDATE 성능 문제, 관리 복잡성</li><li>자주 변경되는 컬럼에 인덱스 적용 → 빈번한 Split/리빌드 발생</li><li>컬럼 순서 신중히 설계(복합 인덱스는 선행 컬럼의 필터링 효과 극대화)</li></ul><hr><h5 id=level-2-3-심화-47-마이그레이션-및-업그레이드-전략>[Level 2-3 심화] 4.7 마이그레이션 및 업그레이드 전략<a hidden class=anchor aria-hidden=true href=#level-2-3-심화-47-마이그레이션-및-업그레이드-전략>#</a></h5><ul><li>DB 이관 시 인덱스 타입 호환성/DDL 이식성 검증</li><li>대용량 인덱스 리빌드 작업은 스케쥴링 및 작업중 Lock 관리 필요</li><li>클라우드·분산 환경에서 파티셔닝/복수 인덱스 전략 병행 필수</li></ul><hr><p><strong>다음 단계는 실습 예제와 실제 현업 적용 사례를 표준 형식에 맞춰 소개하겠습니다.</strong></p><h4 id=phase-5-실무-적용-및-사례>Phase 5: 실무 적용 및 사례<a hidden class=anchor aria-hidden=true href=#phase-5-실무-적용-및-사례>#</a></h4><hr><h5 id=51-실습-예제-및-코드-구현>5.1 실습 예제 및 코드 구현<a hidden class=anchor aria-hidden=true href=#51-실습-예제-및-코드-구현>#</a></h5><h5 id=실습-예제-다양한-인덱스-생성-및-활용>실습 예제: 다양한 인덱스 생성 및 활용<a hidden class=anchor aria-hidden=true href=#실습-예제-다양한-인덱스-생성-및-활용>#</a></h5><h6 id=목적>목적<a hidden class=anchor aria-hidden=true href=#목적>#</a></h6><ul><li>RDBMS에서 단일, 유니크, 복합 인덱스의 생성과 활용 방식을 이해</li></ul><h6 id=사전-요구사항>사전 요구사항<a hidden class=anchor aria-hidden=true href=#사전-요구사항>#</a></h6><ul><li>MySQL 8.x 이상 또는 PostgreSQL 15.x 이상 설치 환경</li><li>DB 관리자 권한 계정</li></ul><h6 id=단계별-구현>단계별 구현<a hidden class=anchor aria-hidden=true href=#단계별-구현>#</a></h6><ol><li><strong>단일 컬럼 인덱스 생성 및 활용</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 회원 테이블 생성
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>member</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=n>AUTO_INCREMENT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>40</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>age</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>email</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 이름 컬럼 인덱스 생성
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_member_name</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>member</span><span class=p>(</span><span class=n>name</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=2><li><strong>유니크 인덱스, 복합 인덱스 생성</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2>2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3>3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4>4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 유니크 인덱스(이메일 중복 방지)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_member_email</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>member</span><span class=p>(</span><span class=n>email</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 이름+나이 복합 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_member_name_age</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>member</span><span class=p>(</span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>age</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=3><li><strong>인덱스 활용 쿼리 및 확인</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 인덱스 타는 검색 쿼리
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>member</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;홍길동&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스 정보 확인(MySQL)
</span></span></span><span class=line><span class=cl><span class=k>SHOW</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>member</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h6 id=실행-결과>실행 결과<a hidden class=anchor aria-hidden=true href=#실행-결과>#</a></h6><ul><li>WHERE 조건에서 name, (name, age), email을 사용하면 인덱스 자동 활용</li><li>SHOW INDEX 또는 실행계획으로 실제 사용 여부 확인 가능</li></ul><h6 id=추가-실험>추가 실험<a hidden class=anchor aria-hidden=true href=#추가-실험>#</a></h6><ul><li>UPDATE/INSERT 빈도가 높은 컬럼에 인덱스 반복 생성→ 성능 변화 관찰</li><li>복합 인덱스 컬럼 순서 바꿔 성능 차이 실험</li></ul><h5 id=52-실제-도입-사례-분석>5.2 실제 도입 사례 분석<a hidden class=anchor aria-hidden=true href=#52-실제-도입-사례-분석>#</a></h5><h5 id=실제-도입-사례-대형-이커머스-제품-검색-시스템>실제 도입 사례: 대형 이커머스 제품 검색 시스템<a hidden class=anchor aria-hidden=true href=#실제-도입-사례-대형-이커머스-제품-검색-시스템>#</a></h5><h6 id=배경-및-도입-이유>배경 및 도입 이유<a hidden class=anchor aria-hidden=true href=#배경-및-도입-이유>#</a></h6><ul><li>실시간 대량 트래픽, 다조건 검색, 빠른 응답 속도와 데이터 유일성 필요</li></ul><h6 id=구현-아키텍처>구현 아키텍처<a hidden class=anchor aria-hidden=true href=#구현-아키텍처>#</a></h6><ul><li>제품 정보 테이블(수백만건), B+트리 기반 클러스터드 인덱스(상품번호/카테고리)</li><li>이메일/아이디 등 유니크 인덱스로 중복 방지</li></ul><pre class=mermaid>graph TB
    A[검색 API] --&gt; B[DB 쿼리 엔진]
    B --&gt; C[제품 테이블]
    B --&gt; D[클러스터드 인덱스]
    B --&gt; E[유니크 인덱스]
    D --&gt; C
    E --&gt; C
</pre><h6 id=핵심-구현-코드>핵심 구현 코드<a hidden class=anchor aria-hidden=true href=#핵심-구현-코드>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1>1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2>2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3>3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 상품코드 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_product_code</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>product</span><span class=p>(</span><span class=n>product_code</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 상품명+카테고리 복합 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_prod_cat</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>product</span><span class=p>(</span><span class=n>product_name</span><span class=p>,</span><span class=w> </span><span class=n>category_id</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h6 id=성과-및-결과>성과 및 결과<a hidden class=anchor aria-hidden=true href=#성과-및-결과>#</a></h6><ul><li>쿼리 응답 10배 이상 개선, 시스템 부하 20% 감소, 중복 데이터 오류율 0% 달성</li><li>쿼리 최적화 및 운영 자동화 가능성 확보</li></ul><h6 id=교훈-및-시사점>교훈 및 시사점<a hidden class=anchor aria-hidden=true href=#교훈-및-시사점>#</a></h6><ul><li>인덱스 설계는 데이터 패턴/업무 흐름과 맞춤 최적화가 필수</li><li>불필요한 인덱스는 관리/성능에 역효과, 주기적 튜닝·모니터링 체계화 필요</li></ul><h5 id=53-통합-및-연계-기술>5.3 통합 및 연계 기술<a hidden class=anchor aria-hidden=true href=#53-통합-및-연계-기술>#</a></h5><ul><li>인덱스는 파티셔닝(Partitioning), 샤딩(Sharding), 데이터 이중화(Replication)와 결합되어, 대용량 장애 대응 및 실시간 확장 환경에서 핵심적 연계 기술로 활용됨.[3][7]</li><li>실시간 모니터링, 옵티마이저 분석툴, AI 기반 자동 인덱싱과 최신 오픈소스 RDBMS의 인덱스 엔진과의 통합 등 최신 트렌드가 현업에 적용 중임.[9][8]</li></ul><h4 id=phase-6-운영-및-최적화>Phase 6: 운영 및 최적화<a hidden class=anchor aria-hidden=true href=#phase-6-운영-및-최적화>#</a></h4><hr><h5 id=61-모니터링-및-관측성>6.1 모니터링 및 관측성<a hidden class=anchor aria-hidden=true href=#61-모니터링-및-관측성>#</a></h5><ul><li>인덱스의 효율성과 성능은 쿼리 응답 시간, 데이터 처리량, 디스크 I/O, 인덱스 사용률, 조각화(fragmentation) 등의 다양한 성능 메트릭을 정기적으로 모니터링해야 합니다.[1][2][3]</li><li>주요 방법:<ul><li>Slow Query Log, Performance Schema, 쿼리 실행계획(EXPLAIN 등) 분석으로 인덱스 활용도를 평가</li><li>필요 없는 인덱스는 삭제, 효율 떨어지는 인덱스는 리빌드(재구성)</li><li>데이터 및 패턴 변화에 맞춰 주기적으로 인덱스 구조 점검 및 튜닝</li></ul></li></ul><hr><h5 id=62-보안-및-컴플라이언스>6.2 보안 및 컴플라이언스<a hidden class=anchor aria-hidden=true href=#62-보안-및-컴플라이언스>#</a></h5><ul><li>인덱스와 관련된 데이터 접근은 인증(Authentication), 권한 관리(Authorization), 네트워크 접근 제한 등 보안 체계와 연관됨.[4]</li><li>민감 정보 컬럼 인덱스(예: 주민번호, 이메일)에는 암호화·마스킹, TLS 전송 암호화, 접근 기록 로깅 및 주기적 감사를 병행해야 개인정보 유출, 무단 접근을 효과적으로 차단할 수 있습니다.</li></ul><hr><h5 id=63-성능-최적화-및-확장성>6.3 성능 최적화 및 확장성<a hidden class=anchor aria-hidden=true href=#63-성능-최적화-및-확장성>#</a></h5><ul><li>자주 사용되는 WHERE/JOIN/ORDER BY 절의 컬럼, 카디널리티 높은 컬럼 중심으로 인덱스 설계와 최적화.[5][6][1]</li><li>클러스터드/비클러스터드, 비트맵, 공간 인덱스 등 데이터 특성·실무 패턴에 맞는 구조 선택이 중요</li><li>분산 시스템에서는 샤딩/파티셔닝·복수 인덱스를 연계해 장애 복원력과 확장성을 강화</li><li>주기적 리빌드, 인덱스 조각화 방지(시기 조절, Lock 관리)로 지속 성능 확보</li></ul><hr><h5 id=64-트러블슈팅-및-문제-해결>6.4 트러블슈팅 및 문제 해결<a hidden class=anchor aria-hidden=true href=#64-트러블슈팅-및-문제-해결>#</a></h5><ul><li>데드락(Deadlock), 락 경합, 인덱스 과부하, 캐시 및 메모리 사용 분산 등 다양한 실무 문제가 발생할 수 있음.[7][2][8]</li><li>주요 대응 전략:<ul><li>쿼리 실행 계획(QEP)과 인덱스 관련 로그 분석</li><li>커버링 인덱스 활용 성능 저하 이슈(불필요한 I/O·메모리 낭비)는 실행계획 재검토 및 인덱스 구조 개선</li><li>비효율적 인덱스(카디널리티 낮음)는 삭제 또는 구조 변경</li><li>장애 및 비상상황 대비 백업·복구 체계 필수</li></ul></li></ul><hr><h5 id=level-3-심화-66-비용-최적화-및-자원-관리>[Level 3 심화] 6.6 비용 최적화 및 자원 관리<a hidden class=anchor aria-hidden=true href=#level-3-심화-66-비용-최적화-및-자원-관리>#</a></h5><ul><li>인덱스 수, 크기·종류를 주기적으로 모니터링해 불필요한 자원 소모 최소화</li><li>클라우드 및 대규모 환경에서 스토리지/메모리 자동 관리, 비용 경고 체계 연계 운영</li></ul><hr><h5 id=level-3-심화-67-재해-복구-및-비즈니스-연속성>[Level 3 심화] 6.7 재해 복구 및 비즈니스 연속성<a hidden class=anchor aria-hidden=true href=#level-3-심화-67-재해-복구-및-비즈니스-연속성>#</a></h5><ul><li>정기 백업, 장애 복구 스크립트, 인덱스 복구 자동화 도구 도입으로 무중단 비즈니스 연속성 보장</li></ul><hr><p><strong>다음 단계는 고급 주제·미래 전망(최신 트렌드, 대안 기술, 산업 변화), 용어 정리, 학습 가이드 등으로 이어집니다.</strong></p><h4 id=phase-7-고급-주제-및-미래-전망>Phase 7: 고급 주제 및 미래 전망<a hidden class=anchor aria-hidden=true href=#phase-7-고급-주제-및-미래-전망>#</a></h4><hr><h5 id=71-현재-도전-과제-및-한계>7.1 현재 도전 과제 및 한계<a hidden class=anchor aria-hidden=true href=#71-현재-도전-과제-및-한계>#</a></h5><ul><li>데이터량과 사용 패턴 다변화, 글로벌 분산 환경, 실시간 트랜잭션 증가에 따라 인덱스의 공간 효율성과 동적 튜닝, 장애 복원에 대한 요구가 높아지고 있습니다.</li><li>복잡한 쿼리와 동시성 증가로 인한 락 경쟁, 인덱스 파일 분산·조각화 부작용, 클라우드 환경의 비용 최적화 요구, NoSQL/디지털 전환 시대의 구조적 한계 등이 주요 도전 과제입니다.[2][7][1]</li></ul><hr><h5 id=72-최신-트렌드-및-방향>7.2 최신 트렌드 및 방향<a hidden class=anchor aria-hidden=true href=#72-최신-트렌드-및-방향>#</a></h5><ul><li>AI(인공지능), ML(머신러닝) 기반 자동 인덱스 추천, 인덱스 유지보수 자동화, 실시간 튜닝 기술이 대중화되고 있습니다.[1]</li><li>분산 DBMS의 샤딩(Sharding), 파티셔닝(Partitioning) 연계 인덱스, 인메모리 및 하이브리드 인덱스, 멀티모델 DBMS(문서, 그래프 등)와 통합형 인덱스 아키텍처 등이 트렌드로 부상.</li><li>클라우드 PaaS, DBaaS 종합 관리 환경에 인덱스 최적화·비용 관리·모니터링 자동화 기능이 내장되어 운영 효율화가 강화되고 있습니다.[4][1]</li></ul><hr><h5 id=73-대안-기술-및-경쟁-솔루션>7.3 대안 기술 및 경쟁 솔루션<a hidden class=anchor aria-hidden=true href=#73-대안-기술-및-경쟁-솔루션>#</a></h5><ul><li>NoSQL DBMS(예: MongoDB, Cassandra 등)는 B-트리 기반 외에도 역색인, 공간 색인, 해시 기반 인덱스 등 다양한 접근법 적용.[4]</li><li>인메모리 데이터베이스(In-Memory DB), ElasticSearch 등은 고속 분산 색인·텍스트색인에 특화된 구조와 분산 최적화 기술 활용.[9]</li><li>빅데이터 환경은 LSM 트리(Log Structured Merge Tree), Bloom-Filter, KV(Key-Value) 엔진과 같은 현대적 인덱스 대안이 실무 현장에 도입되고 있습니다.</li></ul><hr><h5 id=level-3-심화-75-학술-연구-동향-및-혁신-기술>[Level 3 심화] 7.5 학술 연구 동향 및 혁신 기술<a hidden class=anchor aria-hidden=true href=#level-3-심화-75-학술-연구-동향-및-혁신-기술>#</a></h5><ul><li>대규모 데이터셋에서의 자동 인덱스 관리, 인덱스의 AI 기반 변화 감지 및 동적 구조 최적화, 다차원·텍스트·비정형 데이터에 최적화된 하이브리드 색인 연구가 활발.[10][11][1]</li></ul><hr><h5 id=level-3-심화-76-산업-생태계-변화-및-비즈니스-모델-영향>[Level 3 심화] 7.6 산업 생태계 변화 및 비즈니스 모델 영향<a hidden class=anchor aria-hidden=true href=#level-3-심화-76-산업-생태계-변화-및-비즈니스-모델-영향>#</a></h5><ul><li>SaaS 기반 DBaaS, 글로벌 클라우드 플랫폼에 인덱스 성능·비용 튜닝이 포함되어 ‘인덱스 관리 자동화’가 서비스 경쟁력으로 자리</li><li>실시간 개인정보·보안 규제 강화에 따라 인덱스 구조의 암호화·비식별화·법적 준수 기술이 필수로 요구됨.[4]</li></ul><hr><h2 id=최종-정리-및-학습-가이드>최종 정리 및 학습 가이드<a hidden class=anchor aria-hidden=true href=#최종-정리-및-학습-가이드>#</a></h2><hr><h3 id=내용-종합>내용 종합<a hidden class=anchor aria-hidden=true href=#내용-종합>#</a></h3><ul><li>데이터베이스 인덱스(Index)는 DBMS 내 빠른 검색, 효율적 자원 사용, 무결성 유지, 비즈니스 민첩성의 핵심 기술입니다.</li><li>인덱스의 다양한 구조(B+트리, 해시, 비트맵 등), 생성/관리/최적화 방법, 실무 상황별 설계 전략과 트러블슈팅, 최신 AI/클라우드 기반 자동화 트렌드 등 실무와 연구를 포괄합니다.</li><li>실시간 서비스, 대용량 데이터, 복잡한 쿼리 환경에서 인덱스의 설계·운영·최적화는 경쟁력의 출발점이자 품질 유지의 핵심입니다.[12][2][1]</li></ul><hr><h3 id=실무-적용-가이드>실무 적용 가이드<a hidden class=anchor aria-hidden=true href=#실무-적용-가이드>#</a></h3><ul><li>쿼리 패턴(WHERE/JOIN/ORDER BY 등)에 맞춰 인덱스 대상 컬럼 선정</li><li>불필요한 인덱스 최소화 및 주기적 리빌드/삭제로 운영비 절감</li><li>인덱스별 트리/해시/비트맵 등 구조적 특성에 맞춘 최적화</li><li>Slow Query Log·실행계획 분석, 모니터링 도구 활용으로 현황 점검</li><li>민감정보 컬럼의 암호화·접근 관리로 보안 준수</li><li>장애 대비 정기 백업, 리빌드 자동화, 마이그레이션 이슈 관리</li><li>AI·자동 추천 기능 적극 활용, 최신 트렌드 지속 반영.[12][2][1][4]</li></ul><hr><h3 id=학습-로>학습 로<a hidden class=anchor aria-hidden=true href=#학습-로>#</a></h3><ol><li>기초 이해**: 인덱스 자료구조(트리, 해시 등) 및 SQL 명령어 숙지</li><li><strong>실무 설계</strong>: 다양한 인덱스 구조, 쿼리 옵티마이저 연계, 성능 모니터링</li><li><strong>최적화·운영</strong>: 인덱스 튜닝 및 트러블슈팅, 비용·비즈니스 최적화 전략</li><li><strong>최신 기술</strong>: AI/ML 기반 자동화 기능, 클라우드·분산 시스템 적용</li><li><strong>연구 및 산업 동향</strong>: 혁신적 인덱스 구조, 글로벌 플랫폼 사례 분석</li></ol><hr><h3 id=학습-항목-정리>학습 항목 정리<a hidden class=anchor aria-hidden=true href=#학습-항목-정리>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1>1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2>2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3>3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4>4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5>5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>| 카테고리 | Phase | 항목               | 중요도 | 학습 목표                   | 실무 연관성 | 설명               |
</span></span><span class=line><span class=cl>|----------|-------|--------------------|--------|-----------------------------|-------------|--------------------|
</span></span><span class=line><span class=cl>| 기초     | 1     | 인덱스 구조/원리   | 필수   | 자료구조/키-포인터 이해     | 높음        | 핵심 탐색 구조 익히기 |
</span></span><span class=line><span class=cl>| 핵심     | 2     | 인덱스 생성/관리   | 필수   | SQL 실습/최적화/운영        | 높음        | 실무·성능 관리      |
</span></span><span class=line><span class=cl>| 응용     | 5     | 트러블슈팅/비용분석| 권장   | 운영 문제 대응, 비용 절감    | 중간        | 장애, 조각화, 복구 등 |
</span></span><span class=line><span class=cl>| 고급     | 7     | 최신 기술/분산환경 | 선택   | AI/클라우드 자동화/확장      | 낮음        | 미래 전망·응용      |
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1>1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2>2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3>3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4>4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5>5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6>6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7>7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gu>## 용어 정리
</span></span></span><span class=line><span class=cl>| 카테고리 | 용어        | 정의                                                             | 관련 개념               | 실무 활용            |
</span></span><span class=line><span class=cl>|----------|-------------|------------------------------------------------------------------|-------------------------|----------------------|
</span></span><span class=line><span class=cl>| 핵심     | 인덱스(Index)| DB 내 컬럼 값 기반 빠른 검색 지원 위한 자료구조                   | 테이블, 키-포인터 구조  | 쿼리 속도 개선       |
</span></span><span class=line><span class=cl>| 구현     | B+트리(B+Tree)| 균형 잡힌 트리 기반 인덱스 자료구조                              | 정렬, 빠른 탐색         | 범위검색/정렬 최적화 |
</span></span><span class=line><span class=cl>| 구현     | 해시 인덱스(Hash Index)| 해시 함수로 값 버킷 매핑해 검색 최적화                      | 등식 비교, 해시 테이블   | 단일 값 빠른 접근    |
</span></span><span class=line><span class=cl>| 운영     | 리빌드(Rebuild)| 인덱스 구조 재생성 통한 성능 및 조각화 해소                     | 인덱스 튜닝, 조각화      | 정기 유지보수        |
</span></span><span class=line><span class=cl>| 보안     | TLS 암호화   | 데이터 전송 시 암호화 기법                                      | 보안, 네트워크          | 개인정보·민감정보 보호|
</span></span></code></pre></td></tr></table></div></div><h2 id=용어-정리-1>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-1>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>정의</th><th>관련 개념</th><th>실무 활용</th></tr></thead><tbody><tr><td>핵심</td><td>인덱스(Index)</td><td>데이터베이스에서 컬럼 값 기반으로 빠른 검색을 지원하는 자료구조</td><td>테이블, 검색, 키-포인터 구조</td><td>쿼리 속도 개선</td></tr><tr><td>구현</td><td>클러스터형 인덱스(Clustered Index)</td><td>데이터 행이 인덱스 순서에 맞춰 물리적으로 저장되는 인덱스</td><td>프라이머리 키, 저장 구조</td><td>대용량 RDBMS 설계</td></tr><tr><td>구현</td><td>비클러스터형 인덱스(Non-clustered Index)</td><td>인덱스와 데이터가 물리적으로 분리되어 저장되는 색인</td><td>복합 인덱스, 세컨더리 인덱스</td><td>보조 색인/조회 속도 향상</td></tr><tr><td>구현</td><td>B+트리 인덱스(B+Tree Index)</td><td>균형 잡힌 트리 자료구조로, 정렬·범위 쿼리·빠른 탐색 등 다양한 검색에 최적</td><td>SQL, 정렬, 범위 검색</td><td>MySQL, PostgreSQL 등에서 표준</td></tr><tr><td>구현</td><td>해시 인덱스(Hash Index)</td><td>해시 함수로 값을 버킷에 매핑해 등식 비교에 특화된 인덱싱 방식</td><td>NoSQL, 등치 조건, 버킷</td><td>단일 값 검색 최적화</td></tr><tr><td>구현</td><td>비트맵 인덱스(Bitmap Index)</td><td>각 값에 비트맵(Bitmap)을 할당해 집계나 분류가 많은 데이터에 유리한 구조</td><td>값 분포, 집계, 분석 쿼리</td><td>DW/분석 DB/대용량 텍스트 집계</td></tr><tr><td>운영</td><td>리빌드(Rebuild)</td><td>인덱스 자료구조를 재생성하여 성능 저하·조각화를 해소하는 관리 작업</td><td>정기 유지보수, 튜닝, 조각화</td><td>대용량 DB 성능 복구</td></tr><tr><td>보안</td><td>암호화(Encryption)</td><td>인덱스 컬럼의 민감정보 보호를 위한 데이터 암호화 기술</td><td>개인정보, DB접근제어, 규정 준수</td><td>GDPR 등 보안 컴플라이언스</td></tr><tr><td>확장</td><td>파티셔닝(Partitioning)</td><td>대용량 테이블/인덱스를 여러 세그먼트로 분할 운영하는 확장성 구조</td><td>샤딩, 분산DB, 확장성</td><td>빅데이터/클라우드/AI 시스템</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://learn.microsoft.com/ko-kr/azure/well-architected/performance-efficiency/optimize-data-performance>데이터 성능 최적화 아키텍처 전략</a>[1]</li><li><a href=https://wikidocs.net/253216>실시간 인덱스 모니터링·최적화</a>[2]</li><li><a href=https://velog.io/@haron/%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85-DB-%EC%9D%B8%EB%8D%B1%EC%8A%A4Index%EC%99%80-%EB%8D%B0%EB%93%9C%EB%9D%BDDeadLock-in8ryzsm>DB 인덱스 실무 트러블슈팅 사례</a>[3]</li><li><a href=https://notavoid.tistory.com/12>커버링 인덱스와 최적화 사례</a>[4]</li><li><a href=https://www.elastic.co/kr/blog/what-is-an-elasticsearch-index>ElasticSearch 인덱싱 분산 최신 트렌드</a>[5]</li><li><a href=https://tilnote.io/pages/68116b263c3f2fc7099cadaf>MongoDB 모니터링/운영 보안 가이드</a>[6]</li></ul><h2 id=참고-및-출처-1>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-1>#</a></h2><ul><li><a href=https://learn.microsoft.com/ko-kr/azure/well-architected/performance-efficiency/optimize-data-performance>데이터 성능 최적화 아키텍처 전략</a>[1]</li><li><a href=https://velog.io/@haron/%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85-DB-%EC%9D%B8%EB%8D%B1%EC%8A%A4Index%EC%99%80-%EB%8D%B0%EB%93%9C%EB%9D%BDDeadLock-in8ryzsm>DB 인덱스 실무 트러블슈팅 사례</a>[7]</li><li><a href=https://wikidocs.net/253216>실시간 인덱스 모니터링/최적화</a>[12]</li><li><a href=https://notavoid.tistory.com/12>MySQL 인덱스 모니터링·커버링 인덱스</a>[2]</li><li><a href=https://tilnote.io/pages/68116b263c3f2fc7099cadaf>MongoDB 운영·보안 가이드</a>[4]</li><li><a href=https://www.elastic.co/kr/blog/what-is-an-elasticsearch-index>ElasticSearch 인덱스, 최신 분산 인덱싱</a>[9]</li></ul><hr><hr><h1 id=indexing-종합-조사-보고서>Indexing 종합 조사 보고서<a hidden class=anchor aria-hidden=true href=#indexing-종합-조사-보고서>#</a></h1><h2 id=1단계-기본-분석-및-검증-1>1단계: 기본 분석 및 검증<a hidden class=anchor aria-hidden=true href=#1단계-기본-분석-및-검증-1>#</a></h2><h3 id=1-주제-유형-식별>1. 주제 유형 식별<a hidden class=anchor aria-hidden=true href=#1-주제-유형-식별>#</a></h3><p><strong>주 유형</strong>: <strong>A형 (이론/개념형)</strong> + <strong>I형 (성능/최적화형)</strong> 복합</p><ul><li>추상적이고 수학적 기반을 가진 자료구조 개념</li><li>성능 측정, 병목 분석, 최적화 기법이 핵심</li><li>알고리즘 복잡도 분석과 트레이드오프가 중요</li></ul><h3 id=2-복잡도-평가>2. 복잡도 평가<a hidden class=anchor aria-hidden=true href=#2-복잡도-평가>#</a></h3><p><strong>복잡도 Level</strong>: <strong>Level 3 (고급)</strong></p><ul><li>기초부터 고급까지 폭넓은 깊이 필요</li><li>다양한 인덱스 유형과 알고리즘 이해 필요</li><li>실무 적용 시 복잡한 의사결정 요구</li></ul><h3 id=3-대표-태그-생성>3. 대표 태그 생성<a hidden class=anchor aria-hidden=true href=#3-대표-태그-생성>#</a></h3><p><code>Database-Index</code>, <code>Data-Structure</code>, <code>Query-Optimization</code>, <code>Performance-Tuning</code>, <code>B-Tree</code></p><h3 id=4-분류-체계-검증>4. 분류 체계 검증<a hidden class=anchor aria-hidden=true href=#4-분류-체계-검증>#</a></h3><h4 id=주제-분류-적합성-체크리스트>주제 분류 적합성 체크리스트<a hidden class=anchor aria-hidden=true href=#주제-분류-적합성-체크리스트>#</a></h4><ul><li><p><input checked disabled type=checkbox> 현재 분류 구조(## 6)에 해당 위치가 존재하는가?</p><ul><li>✅ Data Fundamentals > Data Modeling이 존재</li></ul></li><li><p>[⚠️] 상위/하위 카테고리 배치가 논리적으로 타당한가?</p><ul><li>⚠️ 부분적으로 타당하나 개선 여지 있음</li></ul></li><li><p>[⚠️] 중복, 누락, 경계 모호성이 없는가?</p><ul><li>⚠️ Database Optimization과 경계 모호성 존재</li></ul></li><li><p>[✅] 실무자의 검색 및 재사용 관점에서 탐색 가능성이 높은가?</p><ul><li>✅ 비교적 찾기 쉬운 위치</li></ul></li><li><p>[⚠️] 유사 주제들과의 일관성이 확보되는가?</p><ul><li>⚠️ Query Processing, Database Optimization과 중복 가능성</li></ul></li><li><p>[⚠️] 크로스 도메인 연결성이 적절히 반영되었는가?</p><ul><li>⚠️ Data Operations 영역과의 연결 필요</li></ul></li></ul><h4 id=개선-제안>개선 제안<a hidden class=anchor aria-hidden=true href=#개선-제안>#</a></h4><p><strong>현재 분류</strong>: <code>Data & Database Systems > Data Fundamentals > Data Modeling > Physical Design</code></p><p><strong>문제점</strong>:</p><ol><li>Indexing은 Physical Design의 일부이지만, Database Optimization의 핵심 기법이기도 함</li><li>Query Processing 성능에 직접적 영향을 미치는 Data Operations 영역과 강한 연관성</li><li>단순히 모델링 단계가 아닌 운영 최적화 차원의 주제</li></ol><p><strong>개선안 1 (권장)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Data &amp; Database Systems &gt; Data Operations &gt; Database Optimization &gt; Indexing
</span></span></code></pre></td></tr></table></div></div><ul><li>장점: 실무자가 성능 최적화 관점에서 찾기 쉬움</li><li>장점: Query Processing, Transaction Management와 동등한 수준 배치</li><li>크로스 참조: Data Fundamentals > Data Modeling > Physical Design</li></ul><p><strong>개선안 2 (대안)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1>1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2>2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Data &amp; Database Systems &gt; Data Fundamentals &gt; Data Modeling &gt; Physical Design &gt; Indexing
</span></span><span class=line><span class=cl>└─ 크로스 레퍼런스: Data Operations &gt; Database Optimization
</span></span><span class=line><span class=cl>└─ 크로스 레퍼런스: Data Structures and Algorithms &gt; Core Concepts &gt; Tree Structures &amp; Algorithms
</span></span></code></pre></td></tr></table></div></div><p><strong>최종 권장</strong>: 개선안 1을 채택하되, 다음의 크로스 도메인 연결 명시</p><ul><li>Physical Design (설계 단계)</li><li>Query Processing (실행 단계)</li><li>Data Structures (알고리즘 기반)</li><li>Performance Analysis (성능 분석)</li></ul><h3 id=5-핵심-요약-250자-이내>5. 핵심 요약 (250자 이내)<a hidden class=anchor aria-hidden=true href=#5-핵심-요약-250자-이내>#</a></h3><p>인덱싱(Indexing)은 데이터베이스에서 데이터 검색 성능을 획기적으로 향상시키기 위한 핵심 자료구조 및 기법입니다. 책의 색인처럼 데이터의 위치 정보를 별도로 관리하여, 전체 데이터를 순차 탐색하지 않고도 원하는 레코드를 빠르게 찾을 수 있게 합니다. B-Tree, Hash, Bitmap 등 다양한 인덱스 구조가 존재하며, 각각 특정 쿼리 패턴과 데이터 특성에 최적화되어 있습니다. 조회 성능 향상과 쓰기 오버헤드 간의 트레이드오프를 이해하고 적절히 설계하는 것이 데이터베이스 성능 최적화의 핵심입니다.</p><h3 id=6-전체-개요-600자-이내>6. 전체 개요 (600자 이내)<a hidden class=anchor aria-hidden=true href=#6-전체-개요-600자-이내>#</a></h3><p>인덱싱은 대용량 데이터베이스 환경에서 효율적인 데이터 접근을 가능하게 하는 필수적인 기술입니다. 1970년대 관계형 데이터베이스의 등장과 함께 발전해온 인덱싱 기술은, 데이터의 물리적 저장 구조와는 독립적으로 논리적 접근 경로를 제공하여 쿼리 성능을 수십 배에서 수천 배까지 향상시킬 수 있습니다.</p><p>인덱스는 본질적으로 &lt;키, 포인터> 쌍으로 구성된 정렬된 자료구조로, 특정 값을 빠르게 찾고 해당 데이터의 물리적 위치로 직접 접근할 수 있게 합니다. 이는 O(n)의 선형 탐색을 O(log n) 또는 O(1)로 개선하는 알고리즘적 최적화입니다.</p><p>학습 방향성은 다음과 같습니다: (1) 기본 개념과 동작 원리 이해, (2) B-Tree, Hash 등 주요 인덱스 구조의 알고리즘적 특성 파악, (3) 인덱스 설계 시 고려사항과 트레이드오프 분석, (4) 복합 인덱스, 커버링 인덱스 등 고급 기법 습득, (5) 실제 데이터베이스 시스템에서의 구현과 최적화 전략 적용. 이론적 기반과 실무 적용 능력을 균형있게 발전시키는 것이 중요합니다.</p><hr><h2 id=2단계-개념-체계화-및-검증-2>2단계: 개념 체계화 및 검증<a hidden class=anchor aria-hidden=true href=#2단계-개념-체계화-및-검증-2>#</a></h2><h3 id=7-핵심-개념-정리>7. 핵심 개념 정리<a hidden class=anchor aria-hidden=true href=#7-핵심-개념-정리>#</a></h3><h4 id=71-인덱스-기본-개념>7.1 인덱스 기본 개념<a hidden class=anchor aria-hidden=true href=#71-인덱스-기본-개념>#</a></h4><p>**인덱스(Index)**는 데이터베이스 테이블의 검색 속도를 향상시키기 위해 특정 컬럼의 값과 해당 레코드의 물리적 위치를 매핑한 별도의 자료구조입니다.</p><pre class=mermaid>graph LR
    A[쿼리 요청] --&gt; B{인덱스 존재?}
    B --&gt;|Yes| C[인덱스 탐색&lt;br/&gt;O log n]
    B --&gt;|No| D[전체 테이블 스캔&lt;br/&gt;O n]
    C --&gt; E[데이터 직접 접근]
    D --&gt; F[순차 스캔]
    E --&gt; G[결과 반환]
    F --&gt; G
    
    style C fill:#90EE90
    style D fill:#FFB6C6
    style E fill:#90EE90
    style F fill:#FFB6C6
</pre><p><strong>핵심 구성 요소</strong>:</p><ul><li><strong>검색 키(Search Key)</strong>: 인덱스를 구성하는 컬럼(들)</li><li><strong>인덱스 엔트리(Index Entry)</strong>: &lt;키 값, 레코드 포인터> 쌍</li><li><strong>인덱스 구조(Index Structure)</strong>: 데이터를 조직화하는 방식 (B-Tree, Hash 등)</li></ul><h4 id=72-인덱스-동작-원리>7.2 인덱스 동작 원리<a hidden class=anchor aria-hidden=true href=#72-인덱스-동작-원리>#</a></h4><p><strong>검색 과정</strong>:</p><ol><li>쿼리의 WHERE 절 조건 분석</li><li>적절한 인덱스 선택 (옵티마이저 역할)</li><li>인덱스 자료구조 탐색</li><li>레코드 포인터를 통해 실제 데이터 접근</li><li>결과 조합 및 반환</li></ol><p><strong>유지보수 과정</strong>:</p><ul><li><strong>INSERT</strong>: 새 엔트리를 인덱스에 추가, 필요시 인덱스 구조 재조정</li><li><strong>UPDATE</strong>: 인덱싱된 컬럼 변경 시 인덱스 업데이트</li><li><strong>DELETE</strong>: 해당 인덱스 엔트리 제거 또는 표시</li></ul><h4 id=73-핵심-개념-상호관계>7.3 핵심 개념 상호관계<a hidden class=anchor aria-hidden=true href=#73-핵심-개념-상호관계>#</a></h4><pre class=mermaid>graph TB
    A[Indexing 개념 체계] --&gt; B[기본 구조]
    A --&gt; C[알고리즘]
    A --&gt; D[성능 특성]
    
    B --&gt; B1[클러스터드&lt;br/&gt;Clustered]
    B --&gt; B2[논클러스터드&lt;br/&gt;Non-Clustered]
    B --&gt; B3[단일/복합&lt;br/&gt;Single/Composite]
    
    C --&gt; C1[B-Tree 계열&lt;br/&gt;균형 트리]
    C --&gt; C2[Hash 계열&lt;br/&gt;해시 함수]
    C --&gt; C3[Bitmap&lt;br/&gt;비트 배열]
    C --&gt; C4[특수 인덱스&lt;br/&gt;Full-text 등]
    
    D --&gt; D1[조회 성능 ↑]
    D --&gt; D2[쓰기 오버헤드 ↑]
    D --&gt; D3[저장 공간 ↑]
    D --&gt; D4[메모리 사용 ↑]
    
    C1 --&gt; E1[범위 검색 최적]
    C2 --&gt; E2[등가 검색 최적]
    C3 --&gt; E3[카디널리티 낮을 때]
    C4 --&gt; E4[특수 검색 요구]
    
    style A fill:#87CEEB
    style D1 fill:#90EE90
    style D2 fill:#FFB6C6
    style D3 fill:#FFB6C6
    style D4 fill:#FFB6C6
</pre><h3 id=8-실무-연관성-분석>8. 실무 연관성 분석<a hidden class=anchor aria-hidden=true href=#8-실무-연관성-분석>#</a></h3><h4 id=81-조회-성능-최적화>8.1 조회 성능 최적화<a hidden class=anchor aria-hidden=true href=#81-조회-성능-최적화>#</a></h4><p><strong>무엇이 연관되는가</strong>:</p><ul><li>쿼리 실행 계획(Query Execution Plan)</li><li>테이블 스캔(Table Scan) vs 인덱스 스캔(Index Scan)</li><li>쿼리 옵티마이저(Query Optimizer)</li></ul><p><strong>어떻게 연관되는가</strong>:</p><ul><li>인덱스가 있으면 옵티마이저가 인덱스 기반 실행 계획 선택</li><li>Full Table Scan의 O(n) 복잡도를 O(log n) 또는 O(1)로 개선</li><li>대용량 테이블에서 특히 극적인 성능 향상</li></ul><p><strong>왜 연관되는가</strong>:</p><ul><li>데이터베이스의 가장 일반적인 연산이 조회(SELECT)</li><li>사용자 경험과 직결된 응답 시간 개선</li><li>시스템 자원(CPU, I/O) 효율적 활용</li></ul><p><strong>실무 가치</strong>:</p><ul><li>1억 건 테이블에서 특정 레코드 검색 시간: 수 분 → 수 밀리초</li><li>실시간 서비스의 SLA(Service Level Agreement) 충족</li><li>동시 사용자 처리 능력 향상</li></ul><h4 id=82-데이터베이스-설계>8.2 데이터베이스 설계<a hidden class=anchor aria-hidden=true href=#82-데이터베이스-설계>#</a></h4><p><strong>무엇이 연관되는가</strong>:</p><ul><li>물리적 데이터베이스 설계(Physical Database Design)</li><li>정규화(Normalization) vs 비정규화(Denormalization) 결정</li><li>파티셔닝(Partitioning) 전략</li></ul><p><strong>어떻게 연관되는가</strong>:</p><ul><li>인덱스 설계는 물리적 설계 단계의 핵심 활동</li><li>쿼리 패턴 분석을 통한 인덱스 후보 식별</li><li>정규화로 분산된 데이터의 조인 성능을 인덱스로 보완</li></ul><p><strong>왜 연관되는가</strong>:</p><ul><li>논리적으로 올바른 설계도 물리적 성능이 나쁘면 실패</li><li>비즈니스 요구사항(응답시간, 처리량)을 만족시키기 위함</li><li>확장성 있는 시스템 구축의 기반</li></ul><p><strong>실무 가치</strong>:</p><ul><li>초기 설계 단계에서 적절한 인덱스 계획으로 리팩토링 비용 절감</li><li>서비스 성장에 따른 확장 전략 수립</li><li>데이터베이스 마이그레이션 리스크 감소</li></ul><h4 id=83-애플리케이션-개발>8.3 애플리케이션 개발<a hidden class=anchor aria-hidden=true href=#83-애플리케이션-개발>#</a></h4><p><strong>무엇이 연관되는가</strong>:</p><ul><li>ORM(Object-Relational Mapping) 프레임워크</li><li>N+1 쿼리 문제</li><li>API 응답 시간 최적화</li></ul><p><strong>어떻게 연관되는가</strong>:</p><ul><li>ORM의 자동 생성 쿼리가 인덱스를 활용하도록 설계</li><li>조인 조건, WHERE 절 컬럼에 적절한 인덱스 배치</li><li>페이징, 정렬 쿼리의 인덱스 최적화</li></ul><p><strong>왜 연관되는가</strong>:</p><ul><li>개발자가 작성한 코드의 성능은 결국 데이터베이스 쿼리로 결정</li><li>프로덕션 환경의 성능 이슈 대부분이 쿼리/인덱스 문제</li><li>기술 부채(Technical Debt) 최소화</li></ul><p><strong>실무 가치</strong>:</p><ul><li>API 응답 시간 개선: 2초 → 200ms</li><li>서버 인프라 비용 절감 (쿼리 효율화로 인한 자원 감소)</li><li>사용자 이탈률 감소</li></ul><h4 id=84-운영-및-모니터링>8.4 운영 및 모니터링<a hidden class=anchor aria-hidden=true href=#84-운영-및-모니터링>#</a></h4><p><strong>무엇이 연관되는가</strong>:</p><ul><li>슬로우 쿼리 로그(Slow Query Log)</li><li>실행 계획 분석(EXPLAIN)</li><li>인덱스 사용률 통계</li></ul><p><strong>어떻게 연관되는가</strong>:</p><ul><li>모니터링 도구가 인덱스 미사용 쿼리 탐지</li><li>실행 계획으로 인덱스 효율성 검증</li><li>미사용 인덱스 식별 및 제거</li></ul><p><strong>왜 연관되는가</strong>:</p><ul><li>프로덕션 환경의 실제 쿼리 패턴은 예측과 다를 수 있음</li><li>데이터 증가, 쿼리 변화에 따른 지속적 최적화 필요</li><li>불필요한 인덱스는 쓰기 성능 저하 및 저장공간 낭비</li></ul><p><strong>실무 가치</strong>:</p><ul><li>장애 예방적 대응 (성능 저하 조기 감지)</li><li>데이터베이스 헬스 체크 자동화</li><li>용량 계획 및 비용 최적화</li></ul><h4 id=85-데이터-웨어하우스-및-분석>8.5 데이터 웨어하우스 및 분석<a hidden class=anchor aria-hidden=true href=#85-데이터-웨어하우스-및-분석>#</a></h4><p><strong>무엇이 연관되는가</strong>:</p><ul><li>컬럼 기반 저장(Columnar Storage)</li><li>분석 쿼리 최적화</li><li>파티션 프루닝(Partition Pruning)</li></ul><p><strong>어떻게 연관되는가</strong>:</p><ul><li>분석 쿼리의 특성(대량 데이터, 집계 연산)에 맞는 인덱스 전략</li><li>Bitmap 인덱스, 클러스터드 컬럼스토어 인덱스 활용</li><li>파티션 키와 인덱스의 조합 설계</li></ul><p><strong>왜 연관되는가</strong>:</p><ul><li>OLAP(Online Analytical Processing) 워크로드는 OLTP와 다른 특성</li><li>복잡한 조인, 집계 쿼리의 성능 결정적 영향</li><li>대시보드, 리포트 생성 속도 개선</li></ul><p><strong>실무 가치</strong>:</p><ul><li>수 시간 소요 배치 작업을 수 분으로 단축</li><li>실시간 분석 대시보드 구현 가능</li><li>비즈니스 의사결정 속도 향상</li></ul><h4 id=86-분산-데이터베이스-및-샤딩>8.6 분산 데이터베이스 및 샤딩<a hidden class=anchor aria-hidden=true href=#86-분산-데이터베이스-및-샤딩>#</a></h4><p><strong>무엇이 연관되는가</strong>:</p><ul><li>샤딩 키(Sharding Key) 선택</li><li>글로벌 인덱스 vs 로컬 인덱스</li><li>크로스 샤드 쿼리</li></ul><p><strong>어떻게 연관되는가</strong>:</p><ul><li>샤딩 키와 인덱스 키의 일치 여부가 쿼리 성능 결정</li><li>글로벌 인덱스는 모든 샤드를 포괄하지만 관리 복잡도 증가</li><li>로컬 인덱스는 샤드 내에서만 효과적</li></ul><p><strong>왜 연관되는가</strong>:</p><ul><li>단일 데이터베이스의 한계 극복을 위한 샤딩 전략</li><li>분산 환경에서의 인덱스 일관성 및 성능 균형</li><li>확장성과 성능의 트레이드오프 관리</li></ul><p><strong>실무 가치</strong>:</p><ul><li>수평 확장(Scale-out) 가능한 아키텍처 설계</li><li>트래픽 증가에 따른 탄력적 대응</li><li>글로벌 서비스의 지역별 성능 최적화</li></ul><hr><h2 id=3단계-phase별-상세-조사-및-검증>3단계: Phase별 상세 조사 및 검증<a hidden class=anchor aria-hidden=true href=#3단계-phase별-상세-조사-및-검증>#</a></h2><h3 id=phase-1-기초-조사-및-개념-정립-1>Phase 1: 기초 조사 및 개념 정립<a hidden class=anchor aria-hidden=true href=#phase-1-기초-조사-및-개념-정립-1>#</a></h3><h4 id=11-개념-정의-및-본질적-이해-1>1.1 개념 정의 및 본질적 이해<a hidden class=anchor aria-hidden=true href=#11-개념-정의-및-본질적-이해-1>#</a></h4><p><strong>인덱싱(Indexing)의 정의</strong></p><p>인덱싱은 데이터베이스 관리 시스템(DBMS, Database Management System)에서 테이블의 데이터를 빠르게 검색하기 위해 특정 컬럼(또는 컬럼들의 조합)의 값을 키로 사용하여 해당 레코드의 물리적 위치 정보를 저장한 별도의 자료구조를 생성하고 관리하는 기법입니다.</p><p><strong>본질적 특성</strong></p><ol><li><p><strong>간접 참조 구조 (Indirection Structure)</strong></p><ul><li>인덱스는 실제 데이터를 직접 포함하지 않고 포인터(참조)만 보관</li><li>&lt;검색 키, 레코드 포인터> 쌍의 집합</li><li>원본 데이터와 독립적으로 존재하는 보조 자료구조</li></ul></li><li><p><strong>정렬된 접근 경로 (Sorted Access Path)</strong></p><ul><li>인덱스 키는 특정 순서로 정렬되어 유지</li><li>이진 탐색, 범위 검색 등 효율적인 알고리즘 적용 가능</li><li>순차 접근과 랜덤 접근의 하이브리드 구조</li></ul></li><li><p><strong>공간-시간 트레이드오프 (Space-Time Tradeoff)</strong></p><ul><li>추가 저장 공간을 사용하여 검색 시간 단축</li><li>쓰기 연산 비용 증가로 읽기 연산 비용 감소</li><li>전형적인 알고리즘 최적화 패턴</li></ul></li></ol><p><strong>비유를 통한 이해</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1> 1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2> 2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3> 3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4> 4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5> 5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6> 6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7> 7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8> 8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9> 9</a>
</span><span class=lnt id=hl-17-10><a class=lnlinks href=#hl-17-10>10</a>
</span><span class=lnt id=hl-17-11><a class=lnlinks href=#hl-17-11>11</a>
</span><span class=lnt id=hl-17-12><a class=lnlinks href=#hl-17-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>도서관 장서 검색 시스템
</span></span><span class=line><span class=cl>├─ 책 자체 (실제 데이터)
</span></span><span class=line><span class=cl>│   └─ 서가에 물리적으로 배치
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>├─ 청구기호 카드 (인덱스)
</span></span><span class=line><span class=cl>│   ├─ 저자명 색인 → 책 위치
</span></span><span class=line><span class=cl>│   ├─ 제목 색인 → 책 위치
</span></span><span class=line><span class=cl>│   └─ 주제 색인 → 책 위치
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>└─ 검색 방법
</span></span><span class=line><span class=cl>    ├─ 색인 없이: 모든 서가 순회 (전체 테이블 스캔)
</span></span><span class=line><span class=cl>    └─ 색인 활용: 카드로 빠른 검색 → 해당 위치로 직행 (인덱스 스캔)
</span></span></code></pre></td></tr></table></div></div><p><strong>수학적 정의</strong></p><p>테이블 T를 n개의 레코드 집합이라 할 때:</p><ul><li>T = {r₁, r₂, &mldr;, rₙ}</li><li>인덱스 I는 매핑 함수: I: K → P<ul><li>K: 검색 키 공간 (Search Key Space)</li><li>P: 레코드 포인터 공간 (Pointer Space)</li><li>I(k) = p, 여기서 k는 검색 키, p는 레코드 위치</li></ul></li></ul><p><strong>핵심 구성 요소 상세</strong></p><pre class=mermaid>graph TB
    subgraph &#34;인덱스 구조&#34;
        A[검색 키&lt;br/&gt;Search Key] --&gt; B[인덱스 엔트리&lt;br/&gt;Index Entry]
        C[레코드 포인터&lt;br/&gt;Record Pointer] --&gt; B
        B --&gt; D[인덱스 페이지&lt;br/&gt;Index Page]
    end
    
    subgraph &#34;실제 데이터&#34;
        E[데이터 레코드&lt;br/&gt;Data Record] --&gt; F[데이터 페이지&lt;br/&gt;Data Page]
    end
    
    D -.포인터 참조.-&gt; F
    
    style B fill:#87CEEB
    style D fill:#87CEEB
    style E fill:#90EE90
    style F fill:#90EE90
</pre><h4 id=12-등장-배경-및-발전-과정-1>1.2 등장 배경 및 발전 과정<a hidden class=anchor aria-hidden=true href=#12-등장-배경-및-발전-과정-1>#</a></h4><p><strong>등장 배경: 1970년대 관계형 데이터베이스의 도전</strong></p><ol><li><p><strong>데이터 폭발과 검색 문제</strong></p><ul><li>1960년대: 계층형/네트워크형 데이터베이스, 물리적 포인터 직접 사용</li><li>1970년 E.F. Codd의 관계형 모델 제안: 논리적 데이터 독립성 강조</li><li>문제: 논리적 독립성 달성 시 검색 성능 저하 (순차 탐색 의존)</li></ul></li><li><p><strong>디스크 I/O 병목</strong></p><ul><li>초기 컴퓨터 시스템: CPU 속도 &#187; 디스크 접근 속도</li><li>디스크 접근 횟수가 성능의 결정적 요인</li><li>필요성: 디스크 I/O를 최소화하는 자료구조</li></ul></li><li><p><strong>SQL 등장과 선언적 쿼리</strong></p><ul><li>사용자는 &ldquo;무엇을&rdquo; 원하는지만 명시 (선언적)</li><li>시스템이 &ldquo;어떻게&rdquo; 찾을지 결정 (절차적)</li><li>효율적인 데이터 접근 경로 자동 선택 필요</li></ul></li></ol><p><strong>발전 과정</strong></p><table><thead><tr><th>연도</th><th>이정표</th><th>핵심 기술</th><th>해결한 문제</th></tr></thead><tbody><tr><td>1972</td><td><strong>ISAM (Indexed Sequential Access Method)</strong></td><td>순차 파일 + 인덱스</td><td>순차/랜덤 접근 통합</td></tr><tr><td>1979</td><td><strong>B-Tree (Bayer & McCreight)</strong></td><td>균형 다진 탐색 트리</td><td>동적 삽입/삭제, 디스크 최적화</td></tr><tr><td>1979</td><td><strong>B+ Tree</strong></td><td>리프 노드 연결 리스트</td><td>범위 검색 최적화</td></tr><tr><td>1985</td><td><strong>Hash Index</strong></td><td>해시 함수 기반</td><td>등가 검색 O(1) 성능</td></tr><tr><td>1987</td><td><strong>R-Tree</strong></td><td>공간 데이터 인덱싱</td><td>다차원 범위 검색</td></tr><tr><td>1995</td><td><strong>Bitmap Index</strong></td><td>비트맵 압축</td><td>저카디널리티 컬럼, OLAP</td></tr><tr><td>1998</td><td><strong>GiST (Generalized Search Tree)</strong></td><td>확장 가능 인덱스 프레임워크</td><td>다양한 데이터 타입 지원</td></tr><tr><td>2000s</td><td><strong>Full-Text Index</strong></td><td>역색인(Inverted Index)</td><td>텍스트 검색 최적화</td></tr><tr><td>2010s</td><td><strong>Columnstore Index</strong></td><td>컬럼 기반 압축 저장</td><td>분석 쿼리 가속화</td></tr><tr><td>2020s</td><td><strong>Learned Index (ML 기반)</strong></td><td>기계학습 모델로 위치 예측</td><td>전통 인덱스 크기/속도 개선</td></tr></tbody></table><p><strong>왜 등장하였는가</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>문제 상황
</span></span><span class=line><span class=cl>└─ 대용량 데이터에서 특정 레코드 검색
</span></span><span class=line><span class=cl>    ├─ 순차 탐색: O(n) 시간 복잡도
</span></span><span class=line><span class=cl>    ├─ 1억 건 테이블: 평균 5천만 번 비교
</span></span><span class=line><span class=cl>    └─ 허용 불가능한 응답 시간
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>해결 필요성
</span></span><span class=line><span class=cl>└─ 검색 시간을 로그 또는 상수 시간으로 단축
</span></span><span class=line><span class=cl>    ├─ O(log n): B-Tree 계열
</span></span><span class=line><span class=cl>    ├─ O(1): Hash Index
</span></span><span class=line><span class=cl>    └─ 디스크 I/O 최소화
</span></span></code></pre></td></tr></table></div></div><p><strong>무엇을 해결하고 개선하는가</strong></p><ol><li><p><strong>검색 성능 개선</strong></p><ul><li>선형 탐색 → 로그 시간 탐색</li><li>랜덤 디스크 접근 → 효율적인 순차 접근</li></ul></li><li><p><strong>쿼리 옵티마이저 지원</strong></p><ul><li>다양한 실행 계획 선택지 제공</li><li>비용 기반 최적화(CBO, Cost-Based Optimization) 가능</li></ul></li><li><p><strong>데이터 정렬 및 그룹화</strong></p><ul><li>ORDER BY, GROUP BY 절 최적화</li><li>정렬 작업 생략 또는 간소화</li></ul></li><li><p><strong>무결성 제약 강화</strong></p><ul><li>UNIQUE 제약: 중복 검사 가속</li><li>FOREIGN KEY: 참조 무결성 검증 가속</li></ul></li></ol><h4 id=13-해결하는-문제-및-핵심-목적-1>1.3 해결하는 문제 및 핵심 목적<a hidden class=anchor aria-hidden=true href=#13-해결하는-문제-및-핵심-목적-1>#</a></h4><p><strong>해결하는 핵심 문제</strong></p><p><strong>문제 1: 전체 테이블 스캔(Full Table Scan)의 비효율</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1>1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2>2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3>3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4>4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5>5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6>6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 인덱스 없는 경우
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;user@example.com&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 실행 과정
</span></span></span><span class=line><span class=cl><span class=mi>1</span><span class=p>.</span><span class=w> </span><span class=err>테이블의</span><span class=w> </span><span class=err>모든</span><span class=w> </span><span class=err>페이지를</span><span class=w> </span><span class=err>디스크에서</span><span class=w> </span><span class=err>메모리로</span><span class=w> </span><span class=err>로드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=mi>2</span><span class=p>.</span><span class=w> </span><span class=err>각</span><span class=w> </span><span class=err>레코드의</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=err>컬럼</span><span class=w> </span><span class=err>검사</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=mi>3</span><span class=p>.</span><span class=w> </span><span class=err>조건에</span><span class=w> </span><span class=err>맞는</span><span class=w> </span><span class=err>레코드</span><span class=w> </span><span class=err>찾을</span><span class=w> </span><span class=err>때까지</span><span class=w> </span><span class=err>계속</span><span class=w> </span><span class=err>스캔</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>시간 복잡도 분석</strong>:</p><ul><li>레코드 수: n</li><li>평균 비교 횟수: n/2</li><li>최악의 경우: n (데이터가 마지막에 있거나 없는 경우)</li><li><strong>시간 복잡도: O(n)</strong></li></ul><p><strong>문제 2: 디스크 I/O 병목</strong></p><p>디스크 접근은 메모리 접근보다 약 100,000배 느림:</p><ul><li>메모리 접근: ~100 나노초</li><li>SSD 접근: ~100 마이크로초</li><li>HDD 접근: ~10 밀리초</li></ul><p>대용량 테이블의 전체 스캔은 수많은 디스크 I/O 발생</p><p><strong>문제 3: 조인(JOIN) 성능 저하</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1>1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2>2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3>3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4>4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5>5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6>6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7>7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 두 테이블 조인
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>order_id</span><span class=p>,</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>customer_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=n>o</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>JOIN</span><span class=w> </span><span class=n>customers</span><span class=w> </span><span class=k>c</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>o</span><span class=p>.</span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>customer_id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스 없이 Nested Loop Join
</span></span></span><span class=line><span class=cl><span class=c1>-- 외부 테이블 각 행마다 내부 테이블 전체 스캔
</span></span></span><span class=line><span class=cl><span class=c1>-- 복잡도: O(n × m)
</span></span></span></code></pre></td></tr></table></div></div><p><strong>문제 4: 정렬 및 그룹화 비용</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1>1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2>2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3>3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4>4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5>5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6>6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 정렬이 필요한 쿼리
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>price</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스 없는 경우
</span></span></span><span class=line><span class=cl><span class=mi>1</span><span class=p>.</span><span class=w> </span><span class=err>전체</span><span class=w> </span><span class=err>데이터를</span><span class=w> </span><span class=err>메모리로</span><span class=w> </span><span class=err>로드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=mi>2</span><span class=p>.</span><span class=w> </span><span class=err>정렬</span><span class=w> </span><span class=err>알고리즘</span><span class=w> </span><span class=err>실행</span><span class=w> </span><span class=p>(</span><span class=n>Quick</span><span class=w> </span><span class=n>Sort</span><span class=p>:</span><span class=w> </span><span class=n>O</span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=n>log</span><span class=w> </span><span class=n>n</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=mi>3</span><span class=p>.</span><span class=w> </span><span class=err>메모리</span><span class=w> </span><span class=err>부족</span><span class=w> </span><span class=err>시</span><span class=w> </span><span class=err>디스크</span><span class=w> </span><span class=err>기반</span><span class=w> </span><span class=err>정렬</span><span class=w> </span><span class=p>(</span><span class=err>더</span><span class=w> </span><span class=err>느림</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>핵심 목적</strong></p><p><strong>목적 1: 검색 성능 획기적 개선</strong></p><table><thead><tr><th>시나리오</th><th>인덱스 없음</th><th>인덱스 있음</th><th>개선 비율</th></tr></thead><tbody><tr><td>1만 건 테이블</td><td>평균 5,000회 비교</td><td>평균 14회 비교 (log₂ 10,000 ≈ 13.3)</td><td><strong>357배</strong></td></tr><tr><td>100만 건 테이블</td><td>평균 50만회 비교</td><td>평균 20회 비교</td><td><strong>25,000배</strong></td></tr><tr><td>1억 건 테이블</td><td>평균 5천만회 비교</td><td>평균 27회 비교</td><td><strong>185만배</strong></td></tr></tbody></table><p><strong>목적 2: 시스템 자원 효율화</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1> 1</a>
</span><span class=lnt id=hl-23-2><a class=lnlinks href=#hl-23-2> 2</a>
</span><span class=lnt id=hl-23-3><a class=lnlinks href=#hl-23-3> 3</a>
</span><span class=lnt id=hl-23-4><a class=lnlinks href=#hl-23-4> 4</a>
</span><span class=lnt id=hl-23-5><a class=lnlinks href=#hl-23-5> 5</a>
</span><span class=lnt id=hl-23-6><a class=lnlinks href=#hl-23-6> 6</a>
</span><span class=lnt id=hl-23-7><a class=lnlinks href=#hl-23-7> 7</a>
</span><span class=lnt id=hl-23-8><a class=lnlinks href=#hl-23-8> 8</a>
</span><span class=lnt id=hl-23-9><a class=lnlinks href=#hl-23-9> 9</a>
</span><span class=lnt id=hl-23-10><a class=lnlinks href=#hl-23-10>10</a>
</span><span class=lnt id=hl-23-11><a class=lnlinks href=#hl-23-11>11</a>
</span><span class=lnt id=hl-23-12><a class=lnlinks href=#hl-23-12>12</a>
</span><span class=lnt id=hl-23-13><a class=lnlinks href=#hl-23-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>자원 사용 비교
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>전체 테이블 스캔:
</span></span><span class=line><span class=cl>├─ CPU: 모든 레코드 비교 연산
</span></span><span class=line><span class=cl>├─ 메모리: 대량 데이터 버퍼링
</span></span><span class=line><span class=cl>├─ 디스크 I/O: 모든 페이지 읽기
</span></span><span class=line><span class=cl>└─ 네트워크: 대량 데이터 전송 (분산 환경)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>인덱스 스캔:
</span></span><span class=line><span class=cl>├─ CPU: 인덱스 탐색 연산 (최소)
</span></span><span class=line><span class=cl>├─ 메모리: 인덱스 페이지만 로드
</span></span><span class=line><span class=cl>├─ 디스크 I/O: 필요한 페이지만 읽기
</span></span><span class=line><span class=cl>└─ 네트워크: 최소 데이터 전송
</span></span></code></pre></td></tr></table></div></div><p><strong>목적 3: 동시성(Concurrency) 향상</strong></p><ul><li>쿼리 실행 시간 단축 → 락(Lock) 유지 시간 감소</li><li>대기 시간 감소 → 처리량(Throughput) 증가</li><li>더 많은 동시 사용자 지원 가능</li></ul><p><strong>목적 4: 확장성(Scalability) 확보</strong></p><pre class=mermaid>graph LR
    A[데이터 증가] --&gt; B{인덱스 전략}
    B --&gt;|적절한 인덱스| C[로그 증가&lt;br/&gt;O log n]
    B --&gt;|인덱스 없음| D[선형 증가&lt;br/&gt;O n]
    
    C --&gt; E[확장 가능]
    D --&gt; F[확장 불가]
    
    style C fill:#90EE90
    style D fill:#FFB6C6
    style E fill:#90EE90
    style F fill:#FFB6C6
</pre><p>데이터가 10배 증가할 때:</p><ul><li>인덱스 없음: 검색 시간 약 10배 증가</li><li>B-Tree 인덱스: 검색 시간 약 1.5배 증가 (log₁₀(10n) ≈ log₁₀(n) + 1)</li></ul><h4 id=14-전제-조건-및-요구사항-1>1.4 전제 조건 및 요구사항<a hidden class=anchor aria-hidden=true href=#14-전제-조건-및-요구사항-1>#</a></h4><p><strong>기술적 전제 조건</strong></p><p><strong>1. 하드웨어 요구사항</strong></p><table><thead><tr><th>구성 요소</th><th>최소 요구사항</th><th>권장 요구사항</th><th>이유</th></tr></thead><tbody><tr><td><strong>저장 공간</strong></td><td>원본 데이터의 10-20%</td><td>원본 데이터의 30-50%</td><td>인덱스 자체 저장</td></tr><tr><td><strong>메모리(RAM)</strong></td><td>인덱스 크기의 50%</td><td>인덱스 전체 캐싱 가능</td><td>디스크 I/O 최소화</td></tr><tr><td><strong>디스크 I/O</strong></td><td>Random Access 지원</td><td>SSD 권장</td><td>B-Tree 탐색 특성</td></tr></tbody></table><p><strong>2. 소프트웨어 요구사항</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1>1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2>2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3>3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4>4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>DBMS 기능 지원
</span></span><span class=line><span class=cl>├─ 인덱스 생성/삭제/재구성 명령
</span></span><span class=line><span class=cl>├─ 쿼리 옵티마이저 (인덱스 선택 기능)
</span></span><span class=line><span class=cl>├─ 통계 정보 수집 및 관리
</span></span><span class=line><span class=cl>└─ 트랜잭션 격리 수준 제어
</span></span></code></pre></td></tr></table></div></div><p><strong>3. 데이터 특성 요구사항</strong></p><p>효과적인 인덱스 적용을 위한 데이터 조건:</p><table><thead><tr><th>특성</th><th>인덱스 효과 높음</th><th>인덱스 효과 낮음</th><th>설명</th></tr></thead><tbody><tr><td><strong>선택도(Selectivity)</strong></td><td>높음 (고유 값 많음)</td><td>낮음 (중복 값 많음)</td><td>고유값 비율</td></tr><tr><td><strong>카디널리티(Cardinality)</strong></td><td>높음</td><td>낮음</td><td>전체 고유값 개수</td></tr><tr><td><strong>데이터 크기</strong></td><td>대용량 (>10만 건)</td><td>소량 (&lt;1만 건)</td><td>오버헤드 대비 이득</td></tr><tr><td><strong>쿼리 패턴</strong></td><td>조회 중심</td><td>쓰기 중심</td><td>읽기/쓰기 비율</td></tr></tbody></table><p><strong>선택도 계산</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-26-1><a class=lnlinks href=#hl-26-1>1</a>
</span><span class=lnt id=hl-26-2><a class=lnlinks href=#hl-26-2>2</a>
</span><span class=lnt id=hl-26-3><a class=lnlinks href=#hl-26-3>3</a>
</span><span class=lnt id=hl-26-4><a class=lnlinks href=#hl-26-4>4</a>
</span><span class=lnt id=hl-26-5><a class=lnlinks href=#hl-26-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>선택도 = (고유값 개수) / (전체 레코드 수)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>예시:
</span></span><span class=line><span class=cl>- 주민등록번호: 100,000 / 100,000 = 1.0 (매우 높음)
</span></span><span class=line><span class=cl>- 성별: 2 / 100,000 = 0.00002 (매우 낮음)
</span></span></code></pre></td></tr></table></div></div><p><strong>개념적 전제 조건</strong></p><p><strong>1. 쿼리 패턴 분석</strong></p><p>인덱스 설계 전 필수 분석:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-27-1><a class=lnlinks href=#hl-27-1> 1</a>
</span><span class=lnt id=hl-27-2><a class=lnlinks href=#hl-27-2> 2</a>
</span><span class=lnt id=hl-27-3><a class=lnlinks href=#hl-27-3> 3</a>
</span><span class=lnt id=hl-27-4><a class=lnlinks href=#hl-27-4> 4</a>
</span><span class=lnt id=hl-27-5><a class=lnlinks href=#hl-27-5> 5</a>
</span><span class=lnt id=hl-27-6><a class=lnlinks href=#hl-27-6> 6</a>
</span><span class=lnt id=hl-27-7><a class=lnlinks href=#hl-27-7> 7</a>
</span><span class=lnt id=hl-27-8><a class=lnlinks href=#hl-27-8> 8</a>
</span><span class=lnt id=hl-27-9><a class=lnlinks href=#hl-27-9> 9</a>
</span><span class=lnt id=hl-27-10><a class=lnlinks href=#hl-27-10>10</a>
</span><span class=lnt id=hl-27-11><a class=lnlinks href=#hl-27-11>11</a>
</span><span class=lnt id=hl-27-12><a class=lnlinks href=#hl-27-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 분석 대상
</span></span></span><span class=line><span class=cl><span class=mi>1</span><span class=p>.</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=err>절에</span><span class=w> </span><span class=err>자주</span><span class=w> </span><span class=err>사용되는</span><span class=w> </span><span class=err>컬럼</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=mi>2</span><span class=p>.</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=err>조건에</span><span class=w> </span><span class=err>사용되는</span><span class=w> </span><span class=err>컬럼</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=mi>3</span><span class=p>.</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=p>,</span><span class=w> </span><span class=k>GROUP</span><span class=w> </span><span class=n>BY에</span><span class=w> </span><span class=err>사용되는</span><span class=w> </span><span class=err>컬럼</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=mi>4</span><span class=p>.</span><span class=w> </span><span class=err>쿼리</span><span class=w> </span><span class=err>실행</span><span class=w> </span><span class=err>빈도</span><span class=w> </span><span class=err>및</span><span class=w> </span><span class=err>중요도</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 예시 분석
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>column_name</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>usage_count</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>query_log</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>clause_type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;WHERE&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>column_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>usage_count</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>2. 읽기/쓰기 비율 이해</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-28-1><a class=lnlinks href=#hl-28-1> 1</a>
</span><span class=lnt id=hl-28-2><a class=lnlinks href=#hl-28-2> 2</a>
</span><span class=lnt id=hl-28-3><a class=lnlinks href=#hl-28-3> 3</a>
</span><span class=lnt id=hl-28-4><a class=lnlinks href=#hl-28-4> 4</a>
</span><span class=lnt id=hl-28-5><a class=lnlinks href=#hl-28-5> 5</a>
</span><span class=lnt id=hl-28-6><a class=lnlinks href=#hl-28-6> 6</a>
</span><span class=lnt id=hl-28-7><a class=lnlinks href=#hl-28-7> 7</a>
</span><span class=lnt id=hl-28-8><a class=lnlinks href=#hl-28-8> 8</a>
</span><span class=lnt id=hl-28-9><a class=lnlinks href=#hl-28-9> 9</a>
</span><span class=lnt id=hl-28-10><a class=lnlinks href=#hl-28-10>10</a>
</span><span class=lnt id=hl-28-11><a class=lnlinks href=#hl-28-11>11</a>
</span><span class=lnt id=hl-28-12><a class=lnlinks href=#hl-28-12>12</a>
</span><span class=lnt id=hl-28-13><a class=lnlinks href=#hl-28-13>13</a>
</span><span class=lnt id=hl-28-14><a class=lnlinks href=#hl-28-14>14</a>
</span><span class=lnt id=hl-28-15><a class=lnlinks href=#hl-28-15>15</a>
</span><span class=lnt id=hl-28-16><a class=lnlinks href=#hl-28-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>워크로드 유형별 인덱스 전략
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>OLTP (Online Transaction Processing)
</span></span><span class=line><span class=cl>├─ 특징: 쓰기 빈번, 짧은 트랜잭션
</span></span><span class=line><span class=cl>├─ 전략: 필수 인덱스만 최소한으로
</span></span><span class=line><span class=cl>└─ 이유: 쓰기 오버헤드 최소화
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>OLAP (Online Analytical Processing)
</span></span><span class=line><span class=cl>├─ 특징: 읽기 중심, 대량 데이터 집계
</span></span><span class=line><span class=cl>├─ 전략: 다양한 인덱스 적극 활용
</span></span><span class=line><span class=cl>└─ 이유: 쿼리 성능 최대화
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hybrid (HTAP)
</span></span><span class=line><span class=cl>├─ 특징: 혼합 워크로드
</span></span><span class=line><span class=cl>├─ 전략: 시간대별 인덱스 전환 또는 분리
</span></span><span class=line><span class=cl>└─ 이유: 양쪽 요구사항 균형
</span></span></code></pre></td></tr></table></div></div><p><strong>3. 트레이드오프 인식</strong></p><pre class=mermaid>graph TB
    A[인덱스 추가] --&gt; B[장점]
    A --&gt; C[비용]
    
    B --&gt; B1[조회 성능 향상]
    B --&gt; B2[정렬 작업 감소]
    B --&gt; B3[조인 성능 개선]
    
    C --&gt; C1[쓰기 성능 저하]
    C --&gt; C2[저장 공간 증가]
    C --&gt; C3[메모리 사용 증가]
    C --&gt; C4[유지보수 복잡도 증가]
    
    style B fill:#90EE90
    style C fill:#FFB6C6
</pre><p><strong>운영 환경 요구사항</strong></p><p><strong>1. 유지보수 계획</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-30-1><a class=lnlinks href=#hl-30-1> 1</a>
</span><span class=lnt id=hl-30-2><a class=lnlinks href=#hl-30-2> 2</a>
</span><span class=lnt id=hl-30-3><a class=lnlinks href=#hl-30-3> 3</a>
</span><span class=lnt id=hl-30-4><a class=lnlinks href=#hl-30-4> 4</a>
</span><span class=lnt id=hl-30-5><a class=lnlinks href=#hl-30-5> 5</a>
</span><span class=lnt id=hl-30-6><a class=lnlinks href=#hl-30-6> 6</a>
</span><span class=lnt id=hl-30-7><a class=lnlinks href=#hl-30-7> 7</a>
</span><span class=lnt id=hl-30-8><a class=lnlinks href=#hl-30-8> 8</a>
</span><span class=lnt id=hl-30-9><a class=lnlinks href=#hl-30-9> 9</a>
</span><span class=lnt id=hl-30-10><a class=lnlinks href=#hl-30-10>10</a>
</span><span class=lnt id=hl-30-11><a class=lnlinks href=#hl-30-11>11</a>
</span><span class=lnt id=hl-30-12><a class=lnlinks href=#hl-30-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>필수 유지보수 작업
</span></span><span class=line><span class=cl>├─ 인덱스 재구성 (Rebuild)
</span></span><span class=line><span class=cl>│   └─ 주기: 단편화율 &gt; 30% 시
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>├─ 인덱스 재조직 (Reorganize)
</span></span><span class=line><span class=cl>│   └─ 주기: 단편화율 10-30% 시
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>├─ 통계 정보 갱신
</span></span><span class=line><span class=cl>│   └─ 주기: 데이터 변경률 &gt; 20% 시
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>└─ 미사용 인덱스 제거
</span></span><span class=line><span class=cl>    └─ 주기: 월 1회 검토
</span></span></code></pre></td></tr></table></div></div><p><strong>2. 모니터링 체계</strong></p><table><thead><tr><th>모니터링 항목</th><th>임계값</th><th>조치</th></tr></thead><tbody><tr><td><strong>인덱스 사용률</strong></td><td>&lt; 5%</td><td>제거 검토</td></tr><tr><td><strong>인덱스 단편화율</strong></td><td>> 30%</td><td>재구성 필요</td></tr><tr><td><strong>인덱스 스캔 비율</strong></td><td>&lt; 10%</td><td>인덱스 재설계</td></tr><tr><td><strong>쓰기 지연율</strong></td><td>> 20% 증가</td><td>인덱스 개수 축소</td></tr></tbody></table><p><strong>3. 성능 테스트 환경</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-31-1><a class=lnlinks href=#hl-31-1>1</a>
</span><span class=lnt id=hl-31-2><a class=lnlinks href=#hl-31-2>2</a>
</span><span class=lnt id=hl-31-3><a class=lnlinks href=#hl-31-3>3</a>
</span><span class=lnt id=hl-31-4><a class=lnlinks href=#hl-31-4>4</a>
</span><span class=lnt id=hl-31-5><a class=lnlinks href=#hl-31-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>테스트 시나리오
</span></span><span class=line><span class=cl>├─ 실제 데이터 크기 재현 (최소 80%)
</span></span><span class=line><span class=cl>├─ 실제 쿼리 패턴 시뮬레이션
</span></span><span class=line><span class=cl>├─ 동시성 부하 테스트
</span></span><span class=line><span class=cl>└─ 인덱스 있음/없음 비교 측정
</span></span></code></pre></td></tr></table></div></div><h4 id=15-핵심-특징-기술적-근거-포함-다른-기술과의-차별점>1.5 핵심 특징 (기술적 근거 포함, 다른 기술과의 차별점)<a hidden class=anchor aria-hidden=true href=#15-핵심-특징-기술적-근거-포함-다른-기술과의-차별점>#</a></h4><p><strong>특징 1: 간접 참조를 통한 논리적-물리적 분리</strong></p><p><strong>기술적 근거</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-32-1><a class=lnlinks href=#hl-32-1>1</a>
</span><span class=lnt id=hl-32-2><a class=lnlinks href=#hl-32-2>2</a>
</span><span class=lnt id=hl-32-3><a class=lnlinks href=#hl-32-3>3</a>
</span><span class=lnt id=hl-32-4><a class=lnlinks href=#hl-32-4>4</a>
</span><span class=lnt id=hl-32-5><a class=lnlinks href=#hl-32-5>5</a>
</span><span class=lnt id=hl-32-6><a class=lnlinks href=#hl-32-6>6</a>
</span><span class=lnt id=hl-32-7><a class=lnlinks href=#hl-32-7>7</a>
</span><span class=lnt id=hl-32-8><a class=lnlinks href=#hl-32-8>8</a>
</span><span class=lnt id=hl-32-9><a class=lnlinks href=#hl-32-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>전통적 접근 (물리적 포인터)
</span></span><span class=line><span class=cl>├─ 계층형 DBMS: 레코드 간 직접 포인터
</span></span><span class=line><span class=cl>├─ 문제: 데이터 재배치 시 모든 포인터 갱신 필요
</span></span><span class=line><span class=cl>└─ 결과: 논리적 데이터 독립성 부재
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>인덱스 접근 (논리적 키)
</span></span><span class=line><span class=cl>├─ 관계형 DBMS: 키 값으로 간접 참조
</span></span><span class=line><span class=cl>├─ 장점: 물리적 위치 변경 시 인덱스만 갱신
</span></span><span class=line><span class=cl>└─ 결과: 논리적-물리적 독립성 달성
</span></span></code></pre></td></tr></table></div></div><p><strong>차별점</strong>:</p><ul><li>배열/연결리스트: 위치 기반 접근, 재배치 불가</li><li>인덱스: 키 기반 접근, 물리적 재구성 유연</li></ul><p><strong>특징 2: 자기 균형 (Self-Balancing) 구조</strong></p><p><strong>B-Tree 계열의 자동 균형 유지</strong>:</p><pre class=mermaid>graph TB
    subgraph &#34;삽입 시 자동 재조정&#34;
        A[새 키 삽입] --&gt; B{노드 포화?}
        B --&gt;|Yes| C[노드 분할&lt;br/&gt;Split]
        B --&gt;|No| D[단순 삽입]
        C --&gt; E[부모로 중간값 승격]
        E --&gt; F{부모 포화?}
        F --&gt;|Yes| C
        F --&gt;|No| G[완료]
        D --&gt; G
    end
    
    style C fill:#FFE4B5
    style E fill:#FFE4B5
</pre><p><strong>기술적 근거</strong>:</p><ul><li>모든 리프 노드가 동일한 깊이 유지</li><li>삽입/삭제 시 O(log n) 시간에 재균형</li><li>최악의 경우에도 성능 보장</li></ul><p><strong>차별점</strong>:</p><ul><li>이진 탐색 트리: 불균형 가능, 최악 O(n)</li><li>B-Tree: 항상 균형, 보장된 O(log n)</li></ul><p><strong>특징 3: 디스크 지향 설계 (Disk-Oriented Design)</strong></p><p><strong>페이지 기반 I/O 최적화</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-34-1><a class=lnlinks href=#hl-34-1>1</a>
</span><span class=lnt id=hl-34-2><a class=lnlinks href=#hl-34-2>2</a>
</span><span class=lnt id=hl-34-3><a class=lnlinks href=#hl-34-3>3</a>
</span><span class=lnt id=hl-34-4><a class=lnlinks href=#hl-34-4>4</a>
</span><span class=lnt id=hl-34-5><a class=lnlinks href=#hl-34-5>5</a>
</span><span class=lnt id=hl-34-6><a class=lnlinks href=#hl-34-6>6</a>
</span><span class=lnt id=hl-34-7><a class=lnlinks href=#hl-34-7>7</a>
</span><span class=lnt id=hl-34-8><a class=lnlinks href=#hl-34-8>8</a>
</span><span class=lnt id=hl-34-9><a class=lnlinks href=#hl-34-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>메모리 자료구조 (이진 트리)
</span></span><span class=line><span class=cl>├─ 노드 크기: 작음 (키 1개 + 포인터 2개)
</span></span><span class=line><span class=cl>├─ 탐색 경로: 길음 (높이가 깊음)
</span></span><span class=line><span class=cl>└─ 디스크 I/O: 많음 (노드마다 I/O)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>디스크 자료구조 (B-Tree)
</span></span><span class=line><span class=cl>├─ 노드 크기: 큼 (페이지 크기에 맞춤, 보통 4KB-16KB)
</span></span><span class=line><span class=cl>├─ 탐색 경로: 짧음 (높이가 낮음)
</span></span><span class=line><span class=cl>└─ 디스크 I/O: 적음 (페이지 단위 일괄 로드)
</span></span></code></pre></td></tr></table></div></div><p><strong>실제 비교</strong>:</p><table><thead><tr><th>항목</th><th>이진 탐색 트리</th><th>B-Tree (차수=100)</th></tr></thead><tbody><tr><td>100만 노드 높이</td><td>~20</td><td>~3</td></tr><tr><td>디스크 I/O 횟수</td><td>~20회</td><td>~3회</td></tr><tr><td>탐색 시간</td><td>~200ms</td><td>~30ms (HDD 기준)</td></tr></tbody></table><p><strong>기술적 근거</strong>:</p><ul><li>페이지(블록) 단위 I/O 활용</li><li>높은 팬아웃(fanout)으로 트리 높이 최소화</li><li>공간 지역성(spatial locality) 활용</li></ul><p><strong>특징 4: 다양한 검색 패턴 지원</strong></p><p><strong>인덱스 타입별 최적 검색 패턴</strong>:</p><table><thead><tr><th>인덱스 타입</th><th>최적 검색</th><th>지원 연산자</th><th>시간 복잡도</th></tr></thead><tbody><tr><td><strong>B-Tree</strong></td><td>범위, 정렬</td><td>=, &lt;, >, BETWEEN, LIKE &lsquo;prefix%&rsquo;</td><td>O(log n)</td></tr><tr><td><strong>Hash</strong></td><td>등가</td><td>=</td><td>O(1)</td></tr><tr><td><strong>Bitmap</strong></td><td>다중 조건 AND/OR</td><td>=, IN</td><td>O(k), k=비트맵 수</td></tr><tr><td><strong>Full-Text</strong></td><td>텍스트 검색</td><td>MATCH, CONTAINS</td><td>O(m), m=용어 수</td></tr><tr><td><strong>Spatial (R-Tree)</strong></td><td>공간 범위</td><td>ST_Within, ST_Intersects</td><td>O(log n)</td></tr></tbody></table><p><strong>기술적 근거</strong>:</p><ul><li>각 자료구조의 알고리즘적 특성 활용</li><li>B-Tree: 정렬 유지로 범위 검색 효율</li><li>Hash: 직접 주소 계산으로 상수 시간</li><li>Bitmap: 비트 연산으로 빠른 집합 연산</li></ul><p><strong>차별점</strong>:</p><ul><li>단일 자료구조(예: 해시맵)는 한 가지 패턴만 최적</li><li>인덱스 시스템: 다양한 구조 선택 가능</li></ul><p><strong>특징 5: 투명한 자동 활용 (Transparent Usage)</strong></p><p><strong>쿼리 옵티마이저의 자동 선택</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-35-1><a class=lnlinks href=#hl-35-1>1</a>
</span><span class=lnt id=hl-35-2><a class=lnlinks href=#hl-35-2>2</a>
</span><span class=lnt id=hl-35-3><a class=lnlinks href=#hl-35-3>3</a>
</span><span class=lnt id=hl-35-4><a class=lnlinks href=#hl-35-4>4</a>
</span><span class=lnt id=hl-35-5><a class=lnlinks href=#hl-35-5>5</a>
</span><span class=lnt id=hl-35-6><a class=lnlinks href=#hl-35-6>6</a>
</span><span class=lnt id=hl-35-7><a class=lnlinks href=#hl-35-7>7</a>
</span><span class=lnt id=hl-35-8><a class=lnlinks href=#hl-35-8>8</a>
</span><span class=lnt id=hl-35-9><a class=lnlinks href=#hl-35-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 개발자는 논리적 쿼리만 작성
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>order_date</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=s1>&#39;2024-12-31&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;completed&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 옵티마이저가 자동으로 결정
</span></span></span><span class=line><span class=cl><span class=c1>-- 1. 어떤 인덱스를 사용할지
</span></span></span><span class=line><span class=cl><span class=c1>-- 2. 인덱스를 사용할지 전체 스캔할지
</span></span></span><span class=line><span class=cl><span class=c1>-- 3. 여러 인덱스를 결합할지 (Index Merge)
</span></span></span></code></pre></td></tr></table></div></div><p><strong>기술적 근거</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-36-1><a class=lnlinks href=#hl-36-1> 1</a>
</span><span class=lnt id=hl-36-2><a class=lnlinks href=#hl-36-2> 2</a>
</span><span class=lnt id=hl-36-3><a class=lnlinks href=#hl-36-3> 3</a>
</span><span class=lnt id=hl-36-4><a class=lnlinks href=#hl-36-4> 4</a>
</span><span class=lnt id=hl-36-5><a class=lnlinks href=#hl-36-5> 5</a>
</span><span class=lnt id=hl-36-6><a class=lnlinks href=#hl-36-6> 6</a>
</span><span class=lnt id=hl-36-7><a class=lnlinks href=#hl-36-7> 7</a>
</span><span class=lnt id=hl-36-8><a class=lnlinks href=#hl-36-8> 8</a>
</span><span class=lnt id=hl-36-9><a class=lnlinks href=#hl-36-9> 9</a>
</span><span class=lnt id=hl-36-10><a class=lnlinks href=#hl-36-10>10</a>
</span><span class=lnt id=hl-36-11><a class=lnlinks href=#hl-36-11>11</a>
</span><span class=lnt id=hl-36-12><a class=lnlinks href=#hl-36-12>12</a>
</span><span class=lnt id=hl-36-13><a class=lnlinks href=#hl-36-13>13</a>
</span><span class=lnt id=hl-36-14><a class=lnlinks href=#hl-36-14>14</a>
</span><span class=lnt id=hl-36-15><a class=lnlinks href=#hl-36-15>15</a>
</span><span class=lnt id=hl-36-16><a class=lnlinks href=#hl-36-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>비용 기반 최적화 (CBO)
</span></span><span class=line><span class=cl>├─ 통계 정보 수집
</span></span><span class=line><span class=cl>│   ├─ 테이블 크기 (레코드 수)
</span></span><span class=line><span class=cl>│   ├─ 인덱스 선택도
</span></span><span class=line><span class=cl>│   └─ 데이터 분포 (히스토그램)
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>├─ 실행 계획 후보 생성
</span></span><span class=line><span class=cl>│   ├─ Index Scan
</span></span><span class=line><span class=cl>│   ├─ Index Seek
</span></span><span class=line><span class=cl>│   ├─ Full Table Scan
</span></span><span class=line><span class=cl>│   └─ Index Merge
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>└─ 비용 계산 및 최적 계획 선택
</span></span><span class=line><span class=cl>    ├─ I/O 비용
</span></span><span class=line><span class=cl>    ├─ CPU 비용
</span></span><span class=line><span class=cl>    └─ 네트워크 비용 (분산 환경)
</span></span></code></pre></td></tr></table></div></div><p><strong>차별점</strong>:</p><ul><li>애플리케이션 레벨 캐시: 명시적 관리 필요</li><li>데이터베이스 인덱스: 자동 관리 및 활용</li></ul><p><strong>특징 6: 트랜잭션 일관성 보장</strong></p><p><strong>ACID 속성 유지</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-37-1><a class=lnlinks href=#hl-37-1> 1</a>
</span><span class=lnt id=hl-37-2><a class=lnlinks href=#hl-37-2> 2</a>
</span><span class=lnt id=hl-37-3><a class=lnlinks href=#hl-37-3> 3</a>
</span><span class=lnt id=hl-37-4><a class=lnlinks href=#hl-37-4> 4</a>
</span><span class=lnt id=hl-37-5><a class=lnlinks href=#hl-37-5> 5</a>
</span><span class=lnt id=hl-37-6><a class=lnlinks href=#hl-37-6> 6</a>
</span><span class=lnt id=hl-37-7><a class=lnlinks href=#hl-37-7> 7</a>
</span><span class=lnt id=hl-37-8><a class=lnlinks href=#hl-37-8> 8</a>
</span><span class=lnt id=hl-37-9><a class=lnlinks href=#hl-37-9> 9</a>
</span><span class=lnt id=hl-37-10><a class=lnlinks href=#hl-37-10>10</a>
</span><span class=lnt id=hl-37-11><a class=lnlinks href=#hl-37-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>동시성 제어 메커니즘
</span></span><span class=line><span class=cl>├─ 인덱스 래칭 (Latching)
</span></span><span class=line><span class=cl>│   └─ 매우 짧은 시간 동안 인덱스 구조 보호
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>├─ 인덱스 락킹 (Locking)
</span></span><span class=line><span class=cl>│   ├─ 키 범위 락 (Key-Range Lock)
</span></span><span class=line><span class=cl>│   └─ 팬텀 리드 방지
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>└─ 로깅 (Logging)
</span></span><span class=line><span class=cl>    ├─ 인덱스 변경 로그 기록
</span></span><span class=line><span class=cl>    └─ 복구 시 인덱스 재구성
</span></span></code></pre></td></tr></table></div></div><p><strong>기술적 근거</strong>:</p><pre class=mermaid>sequenceDiagram
    participant T1 as Transaction 1
    participant IX as Index
    participant T2 as Transaction 2
    
    T1-&gt;&gt;IX: 키 K1 검색 및 락 획득
    T2-&gt;&gt;IX: 키 K1 검색 시도
    IX--&gt;&gt;T2: 대기 (락 획득 실패)
    T1-&gt;&gt;IX: 변경 완료 및 락 해제
    IX--&gt;&gt;T2: 락 획득 성공
    T2-&gt;&gt;IX: 키 K1 검색 완료
</pre><p><strong>차별점</strong>:</p><ul><li>일반 자료구조: 동시성 제어 없음</li><li>데이터베이스 인덱스: 트랜잭션 격리 수준 준수</li></ul><h4 id=16-수학적-기반-및-공리-a형-특화>1.6 수학적 기반 및 공리 (A형 특화)<a hidden class=anchor aria-hidden=true href=#16-수학적-기반-및-공리-a형-특화>#</a></h4><p><strong>공리 1: 정렬 속성 (Ordering Property)</strong></p><p><strong>정의</strong>: B-Tree의 모든 노드는 정렬된 키를 유지한다.</p><p><strong>형식적 표현</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-39-1><a class=lnlinks href=#hl-39-1>1</a>
</span><span class=lnt id=hl-39-2><a class=lnlinks href=#hl-39-2>2</a>
</span><span class=lnt id=hl-39-3><a class=lnlinks href=#hl-39-3>3</a>
</span><span class=lnt id=hl-39-4><a class=lnlinks href=#hl-39-4>4</a>
</span><span class=lnt id=hl-39-5><a class=lnlinks href=#hl-39-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>노드 N = {k₁, k₂, ..., kₙ}에 대해
</span></span><span class=line><span class=cl>∀ i, j : 1 ≤ i &lt; j ≤ n → kᵢ &lt; kⱼ
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>하위 노드 포인터 p₀, p₁, ..., pₙ에 대해
</span></span><span class=line><span class=cl>∀ 키 x ∈ subtree(pᵢ) : kᵢ ≤ x &lt; kᵢ₊₁
</span></span></code></pre></td></tr></table></div></div><p><strong>공리 2: 균형 속성 (Balance Property)</strong></p><p><strong>정의</strong>: 모든 리프 노드는 루트로부터 동일한 거리(높이)에 위치한다.</p><p><strong>형식적 표현</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-40-1><a class=lnlinks href=#hl-40-1>1</a>
</span><span class=lnt id=hl-40-2><a class=lnlinks href=#hl-40-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>트리 T의 모든 리프 노드 L₁, L₂, ..., Lₘ에 대해
</span></span><span class=line><span class=cl>depth(L₁) = depth(L₂) = ... = depth(Lₘ) = h (높이)
</span></span></code></pre></td></tr></table></div></div><p><strong>공리 3: 차수 속성 (Degree Property)</strong></p><p><strong>정의</strong>: 각 노드는 최소 차수 t에 의해 제약된다.</p><p><strong>형식적 표현</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-41-1><a class=lnlinks href=#hl-41-1>1</a>
</span><span class=lnt id=hl-41-2><a class=lnlinks href=#hl-41-2>2</a>
</span><span class=lnt id=hl-41-3><a class=lnlinks href=#hl-41-3>3</a>
</span><span class=lnt id=hl-41-4><a class=lnlinks href=#hl-41-4>4</a>
</span><span class=lnt id=hl-41-5><a class=lnlinks href=#hl-41-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>차수 t인 B-Tree에 대해:
</span></span><span class=line><span class=cl>1. 각 노드는 최대 2t-1개의 키 보유
</span></span><span class=line><span class=cl>2. 각 노드는 최대 2t개의 자식 보유
</span></span><span class=line><span class=cl>3. 루트를 제외한 모든 노드는 최소 t-1개의 키 보유
</span></span><span class=line><span class=cl>4. 루트를 제외한 모든 내부 노드는 최소 t개의 자식 보유
</span></span></code></pre></td></tr></table></div></div><p><strong>정리 1: B-Tree 높이의 상한 (Upper Bound of Height)</strong></p><p><strong>정리</strong>: n개의 키를 가진 차수 t인 B-Tree의 높이 h는 다음을 만족한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-42-1><a class=lnlinks href=#hl-42-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>h ≤ log_t((n+1)/2)
</span></span></code></pre></td></tr></table></div></div><p><strong>증명</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-43-1><a class=lnlinks href=#hl-43-1> 1</a>
</span><span class=lnt id=hl-43-2><a class=lnlinks href=#hl-43-2> 2</a>
</span><span class=lnt id=hl-43-3><a class=lnlinks href=#hl-43-3> 3</a>
</span><span class=lnt id=hl-43-4><a class=lnlinks href=#hl-43-4> 4</a>
</span><span class=lnt id=hl-43-5><a class=lnlinks href=#hl-43-5> 5</a>
</span><span class=lnt id=hl-43-6><a class=lnlinks href=#hl-43-6> 6</a>
</span><span class=lnt id=hl-43-7><a class=lnlinks href=#hl-43-7> 7</a>
</span><span class=lnt id=hl-43-8><a class=lnlinks href=#hl-43-8> 8</a>
</span><span class=lnt id=hl-43-9><a class=lnlinks href=#hl-43-9> 9</a>
</span><span class=lnt id=hl-43-10><a class=lnlinks href=#hl-43-10>10</a>
</span><span class=lnt id=hl-43-11><a class=lnlinks href=#hl-43-11>11</a>
</span><span class=lnt id=hl-43-12><a class=lnlinks href=#hl-43-12>12</a>
</span><span class=lnt id=hl-43-13><a class=lnlinks href=#hl-43-13>13</a>
</span><span class=lnt id=hl-43-14><a class=lnlinks href=#hl-43-14>14</a>
</span><span class=lnt id=hl-43-15><a class=lnlinks href=#hl-43-15>15</a>
</span><span class=lnt id=hl-43-16><a class=lnlinks href=#hl-43-16>16</a>
</span><span class=lnt id=hl-43-17><a class=lnlinks href=#hl-43-17>17</a>
</span><span class=lnt id=hl-43-18><a class=lnlinks href=#hl-43-18>18</a>
</span><span class=lnt id=hl-43-19><a class=lnlinks href=#hl-43-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 최소 노드 수를 가진 B-Tree 구성:
</span></span><span class=line><span class=cl>   - 루트: 1개 키
</span></span><span class=line><span class=cl>   - 레벨 1: 2개 노드, 각 t-1개 키 → 2(t-1)개 키
</span></span><span class=line><span class=cl>   - 레벨 2: 2t개 노드, 각 t-1개 키 → 2t(t-1)개 키
</span></span><span class=line><span class=cl>   - 레벨 h: 2t^(h-1)개 노드, 각 t-1개 키 → 2t^(h-1)(t-1)개 키
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 총 키 개수:
</span></span><span class=line><span class=cl>   n ≥ 1 + 2(t-1) + 2t(t-1) + ... + 2t^(h-1)(t-1)
</span></span><span class=line><span class=cl>   n ≥ 1 + 2(t-1)(1 + t + t² + ... + t^(h-1))
</span></span><span class=line><span class=cl>   n ≥ 1 + 2(t-1) · (t^h - 1)/(t - 1)
</span></span><span class=line><span class=cl>   n ≥ 1 + 2(t^h - 1)
</span></span><span class=line><span class=cl>   n ≥ 2t^h - 1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 따라서:
</span></span><span class=line><span class=cl>   n + 1 ≥ 2t^h
</span></span><span class=line><span class=cl>   (n + 1)/2 ≥ t^h
</span></span><span class=line><span class=cl>   log_t((n + 1)/2) ≥ h
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>∴ h ≤ log_t((n + 1)/2)  ∎
</span></span></code></pre></td></tr></table></div></div><p><strong>정리 2: 탐색 시간 복잡도</strong></p><p><strong>정리</strong>: n개의 키를 가진 B-Tree에서 특정 키 탐색은 O(log n) 시간에 수행된다.</p><p><strong>증명</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-44-1><a class=lnlinks href=#hl-44-1> 1</a>
</span><span class=lnt id=hl-44-2><a class=lnlinks href=#hl-44-2> 2</a>
</span><span class=lnt id=hl-44-3><a class=lnlinks href=#hl-44-3> 3</a>
</span><span class=lnt id=hl-44-4><a class=lnlinks href=#hl-44-4> 4</a>
</span><span class=lnt id=hl-44-5><a class=lnlinks href=#hl-44-5> 5</a>
</span><span class=lnt id=hl-44-6><a class=lnlinks href=#hl-44-6> 6</a>
</span><span class=lnt id=hl-44-7><a class=lnlinks href=#hl-44-7> 7</a>
</span><span class=lnt id=hl-44-8><a class=lnlinks href=#hl-44-8> 8</a>
</span><span class=lnt id=hl-44-9><a class=lnlinks href=#hl-44-9> 9</a>
</span><span class=lnt id=hl-44-10><a class=lnlinks href=#hl-44-10>10</a>
</span><span class=lnt id=hl-44-11><a class=lnlinks href=#hl-44-11>11</a>
</span><span class=lnt id=hl-44-12><a class=lnlinks href=#hl-44-12>12</a>
</span><span class=lnt id=hl-44-13><a class=lnlinks href=#hl-44-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 트리 높이: h ≤ log_t((n+1)/2)  (정리 1)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 각 노드 내 탐색: 
</span></span><span class=line><span class=cl>   - 이진 탐색 사용: O(log(2t-1)) = O(log t)
</span></span><span class=line><span class=cl>   - 또는 선형 탐색: O(t)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 총 탐색 시간:
</span></span><span class=line><span class=cl>   T(n) = O(h · log t) = O(log_t(n) · log t) = O(log n)
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   또는 선형 탐색 시:
</span></span><span class=line><span class=cl>   T(n) = O(h · t) = O(log_t(n) · t)
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   t가 상수이므로 T(n) = O(log n)  ∎
</span></span></code></pre></td></tr></table></div></div><p><strong>정리 3: 해시 인덱스 탐색 복잡도</strong></p><p><strong>정리</strong>: 완벽한 해시 함수를 가정할 때, 해시 인덱스의 탐색은 O(1)이다.</p><p><strong>조건</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-45-1><a class=lnlinks href=#hl-45-1>1</a>
</span><span class=lnt id=hl-45-2><a class=lnlinks href=#hl-45-2>2</a>
</span><span class=lnt id=hl-45-3><a class=lnlinks href=#hl-45-3>3</a>
</span><span class=lnt id=hl-45-4><a class=lnlinks href=#hl-45-4>4</a>
</span><span class=lnt id=hl-45-5><a class=lnlinks href=#hl-45-5>5</a>
</span><span class=lnt id=hl-45-6><a class=lnlinks href=#hl-45-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>해시 함수 h: K → [0, m-1]가 다음을 만족:
</span></span><span class=line><span class=cl>1. 균등 분포 (Uniform Distribution)
</span></span><span class=line><span class=cl>   P(h(k) = i) = 1/m, ∀ i ∈ [0, m-1]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 충돌 최소화
</span></span><span class=line><span class=cl>   k₁ ≠ k₂ → h(k₁) ≠ h(k₂) (완벽한 해시)
</span></span></code></pre></td></tr></table></div></div><p><strong>증명</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-46-1><a class=lnlinks href=#hl-46-1>1</a>
</span><span class=lnt id=hl-46-2><a class=lnlinks href=#hl-46-2>2</a>
</span><span class=lnt id=hl-46-3><a class=lnlinks href=#hl-46-3>3</a>
</span><span class=lnt id=hl-46-4><a class=lnlinks href=#hl-46-4>4</a>
</span><span class=lnt id=hl-46-5><a class=lnlinks href=#hl-46-5>5</a>
</span><span class=lnt id=hl-46-6><a class=lnlinks href=#hl-46-6>6</a>
</span><span class=lnt id=hl-46-7><a class=lnlinks href=#hl-46-7>7</a>
</span><span class=lnt id=hl-46-8><a class=lnlinks href=#hl-46-8>8</a>
</span><span class=lnt id=hl-46-9><a class=lnlinks href=#hl-46-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 키 k 탐색:
</span></span><span class=line><span class=cl>   - 해시 함수 계산: O(1)
</span></span><span class=line><span class=cl>   - 해시 테이블 접근: O(1)
</span></span><span class=line><span class=cl>   - 총 시간: O(1)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 충돌 발생 시 (체이닝):
</span></span><span class=line><span class=cl>   - 평균 체인 길이: α = n/m (부하율)
</span></span><span class=line><span class=cl>   - 탐색 시간: O(1 + α)
</span></span><span class=line><span class=cl>   - α가 상수로 제한되면: O(1)  ∎
</span></span></code></pre></td></tr></table></div></div><p><strong>정리 4: 공간 복잡도</strong></p><p><strong>정리</strong>: B-Tree 인덱스의 공간 복잡도는 Θ(n)이다.</p><p><strong>증명</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-47-1><a class=lnlinks href=#hl-47-1> 1</a>
</span><span class=lnt id=hl-47-2><a class=lnlinks href=#hl-47-2> 2</a>
</span><span class=lnt id=hl-47-3><a class=lnlinks href=#hl-47-3> 3</a>
</span><span class=lnt id=hl-47-4><a class=lnlinks href=#hl-47-4> 4</a>
</span><span class=lnt id=hl-47-5><a class=lnlinks href=#hl-47-5> 5</a>
</span><span class=lnt id=hl-47-6><a class=lnlinks href=#hl-47-6> 6</a>
</span><span class=lnt id=hl-47-7><a class=lnlinks href=#hl-47-7> 7</a>
</span><span class=lnt id=hl-47-8><a class=lnlinks href=#hl-47-8> 8</a>
</span><span class=lnt id=hl-47-9><a class=lnlinks href=#hl-47-9> 9</a>
</span><span class=lnt id=hl-47-10><a class=lnlinks href=#hl-47-10>10</a>
</span><span class=lnt id=hl-47-11><a class=lnlinks href=#hl-47-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 하한 (Lower Bound):
</span></span><span class=line><span class=cl>   - 최소 n개의 키 저장 필요
</span></span><span class=line><span class=cl>   - Ω(n)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 상한 (Upper Bound):
</span></span><span class=line><span class=cl>   - 각 노드 최대 2t-1개 키
</span></span><span class=line><span class=cl>   - 노드 수 ≤ n/(t-1)
</span></span><span class=line><span class=cl>   - 각 노드 포인터 수 ≤ 2t
</span></span><span class=line><span class=cl>   - 총 공간 ≤ n + n/(t-1) · 2t = O(n)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>∴ 공간 복잡도 = Θ(n)  ∎
</span></span></code></pre></td></tr></table></div></div><p><strong>수학적 최적성 분석</strong></p><p><strong>비교 기반 탐색의 하한</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-48-1><a class=lnlinks href=#hl-48-1> 1</a>
</span><span class=lnt id=hl-48-2><a class=lnlinks href=#hl-48-2> 2</a>
</span><span class=lnt id=hl-48-3><a class=lnlinks href=#hl-48-3> 3</a>
</span><span class=lnt id=hl-48-4><a class=lnlinks href=#hl-48-4> 4</a>
</span><span class=lnt id=hl-48-5><a class=lnlinks href=#hl-48-5> 5</a>
</span><span class=lnt id=hl-48-6><a class=lnlinks href=#hl-48-6> 6</a>
</span><span class=lnt id=hl-48-7><a class=lnlinks href=#hl-48-7> 7</a>
</span><span class=lnt id=hl-48-8><a class=lnlinks href=#hl-48-8> 8</a>
</span><span class=lnt id=hl-48-9><a class=lnlinks href=#hl-48-9> 9</a>
</span><span class=lnt id=hl-48-10><a class=lnlinks href=#hl-48-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>정리: 비교 기반 탐색의 정보 이론적 하한은 Ω(log n)이다.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>증명 (결정 트리 모델):
</span></span><span class=line><span class=cl>1. n개 원소 중 1개를 찾는 결정 트리
</span></span><span class=line><span class=cl>2. 리프 노드 수 ≥ n (각 원소마다 하나)
</span></span><span class=line><span class=cl>3. 이진 트리 높이 h ≥ log₂ n
</span></span><span class=line><span class=cl>4. 비교 횟수 ≥ h
</span></span><span class=line><span class=cl>∴ Ω(log n)  ∎
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>결론: B-Tree의 O(log n)은 점근적 최적
</span></span></code></pre></td></tr></table></div></div><h4 id=17-역사적-맥락-및-진화-과정-심화>1.7 역사적 맥락 및 진화 과정 (심화)<a hidden class=anchor aria-hidden=true href=#17-역사적-맥락-및-진화-과정-심화>#</a></h4><p><strong>1단계: 순차 파일 시대 (1950s-1960s)</strong></p><p><strong>초기 저장 방식</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-49-1><a class=lnlinks href=#hl-49-1>1</a>
</span><span class=lnt id=hl-49-2><a class=lnlinks href=#hl-49-2>2</a>
</span><span class=lnt id=hl-49-3><a class=lnlinks href=#hl-49-3>3</a>
</span><span class=lnt id=hl-49-4><a class=lnlinks href=#hl-49-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>순차 파일 (Sequential File)
</span></span><span class=line><span class=cl>├─ 구조: 레코드를 순서대로 저장
</span></span><span class=line><span class=cl>├─ 검색: 처음부터 순차 탐색
</span></span><span class=line><span class=cl>└─ 문제: 중간 삽입 시 전체 재작성
</span></span></code></pre></td></tr></table></div></div><p><strong>개선 시도: ISAM (1963)</strong></p><ul><li>IBM에서 개발한 Indexed Sequential Access Method</li><li>순차 파일 + 인덱스 블록</li><li>정적 구조: 오버플로우 체인으로 처리</li></ul><p><strong>2단계: 동적 트리 구조 등장 (1970s)</strong></p><p><strong>B-Tree의 혁신 (1972)</strong></p><p>Rudolf Bayer와 Edward McCreight가 발표:</p><ul><li>논문: &ldquo;Organization and Maintenance of Large Ordered Indices&rdquo;</li><li>핵심 아이디어: 자기 균형 다진 트리</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-50-1><a class=lnlinks href=#hl-50-1>1</a>
</span><span class=lnt id=hl-50-2><a class=lnlinks href=#hl-50-2>2</a>
</span><span class=lnt id=hl-50-3><a class=lnlinks href=#hl-50-3>3</a>
</span><span class=lnt id=hl-50-4><a class=lnlinks href=#hl-50-4>4</a>
</span><span class=lnt id=hl-50-5><a class=lnlinks href=#hl-50-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>혁신 포인트
</span></span><span class=line><span class=cl>├─ 동적 삽입/삭제 지원 (ISAM 한계 극복)
</span></span><span class=line><span class=cl>├─ 모든 경로 동일 길이 보장
</span></span><span class=line><span class=cl>├─ 디스크 블록 크기에 최적화
</span></span><span class=line><span class=cl>└─ 로그 시간 보장
</span></span></code></pre></td></tr></table></div></div><p><strong>B+ Tree의 개선 (1979)</strong></p><p>Douglas Comer가 제안:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-51-1><a class=lnlinks href=#hl-51-1> 1</a>
</span><span class=lnt id=hl-51-2><a class=lnlinks href=#hl-51-2> 2</a>
</span><span class=lnt id=hl-51-3><a class=lnlinks href=#hl-51-3> 3</a>
</span><span class=lnt id=hl-51-4><a class=lnlinks href=#hl-51-4> 4</a>
</span><span class=lnt id=hl-51-5><a class=lnlinks href=#hl-51-5> 5</a>
</span><span class=lnt id=hl-51-6><a class=lnlinks href=#hl-51-6> 6</a>
</span><span class=lnt id=hl-51-7><a class=lnlinks href=#hl-51-7> 7</a>
</span><span class=lnt id=hl-51-8><a class=lnlinks href=#hl-51-8> 8</a>
</span><span class=lnt id=hl-51-9><a class=lnlinks href=#hl-51-9> 9</a>
</span><span class=lnt id=hl-51-10><a class=lnlinks href=#hl-51-10>10</a>
</span><span class=lnt id=hl-51-11><a class=lnlinks href=#hl-51-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>B-Tree vs B+ Tree 차이
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>B-Tree:
</span></span><span class=line><span class=cl>├─ 모든 노드에 데이터 저장
</span></span><span class=line><span class=cl>└─ 리프 노드 연결 없음
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>B+ Tree:
</span></span><span class=line><span class=cl>├─ 리프 노드만 데이터 저장
</span></span><span class=line><span class=cl>├─ 내부 노드는 인덱스 역할
</span></span><span class=line><span class=cl>└─ 리프 노드 연결 리스트 형성
</span></span><span class=line><span class=cl>    → 범위 검색 최적화
</span></span></code></pre></td></tr></table></div></div><p><strong>3단계: 다양한 용도별 인덱스 (1980s-1990s)</strong></p><table><thead><tr><th>연도</th><th>인덱스</th><th>발명자</th><th>목적</th><th>적용 분야</th></tr></thead><tbody><tr><td>1984</td><td><strong>R-Tree</strong></td><td>Antonin Guttman</td><td>다차원 공간 데이터</td><td>GIS, CAD</td></tr><tr><td>1987</td><td><strong>Bitmap Index</strong></td><td>Patrick O&rsquo;Neil</td><td>저카디널리티 컬럼</td><td>Data Warehouse</td></tr><tr><td>1989</td><td><strong>T-Tree</strong></td><td>Tobin Lehman</td><td>메인 메모리 DBMS</td><td>In-Memory DB</td></tr><tr><td>1995</td><td><strong>GiST</strong></td><td>Joseph Hellerstein</td><td>확장 가능 인덱스</td><td>PostgreSQL</td></tr></tbody></table><p><strong>R-Tree 구조 시각화</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-52-1><a class=lnlinks href=#hl-52-1> 1</a>
</span><span class=lnt id=hl-52-2><a class=lnlinks href=#hl-52-2> 2</a>
</span><span class=lnt id=hl-52-3><a class=lnlinks href=#hl-52-3> 3</a>
</span><span class=lnt id=hl-52-4><a class=lnlinks href=#hl-52-4> 4</a>
</span><span class=lnt id=hl-52-5><a class=lnlinks href=#hl-52-5> 5</a>
</span><span class=lnt id=hl-52-6><a class=lnlinks href=#hl-52-6> 6</a>
</span><span class=lnt id=hl-52-7><a class=lnlinks href=#hl-52-7> 7</a>
</span><span class=lnt id=hl-52-8><a class=lnlinks href=#hl-52-8> 8</a>
</span><span class=lnt id=hl-52-9><a class=lnlinks href=#hl-52-9> 9</a>
</span><span class=lnt id=hl-52-10><a class=lnlinks href=#hl-52-10>10</a>
</span><span class=lnt id=hl-52-11><a class=lnlinks href=#hl-52-11>11</a>
</span><span class=lnt id=hl-52-12><a class=lnlinks href=#hl-52-12>12</a>
</span><span class=lnt id=hl-52-13><a class=lnlinks href=#hl-52-13>13</a>
</span><span class=lnt id=hl-52-14><a class=lnlinks href=#hl-52-14>14</a>
</span><span class=lnt id=hl-52-15><a class=lnlinks href=#hl-52-15>15</a>
</span><span class=lnt id=hl-52-16><a class=lnlinks href=#hl-52-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>공간 데이터 인덱싱 (2D 예시)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>     ┌─────────┬─────────┐
</span></span><span class=line><span class=cl>     │    A    │    B    │
</span></span><span class=line><span class=cl>     │  ┌──┐   │   ┌─┐   │
</span></span><span class=line><span class=cl>     │  │R1│   │   │R│   │
</span></span><span class=line><span class=cl>     │  └──┘   │   └─┘   │
</span></span><span class=line><span class=cl>     ├─────────┼─────────┤
</span></span><span class=line><span class=cl>     │    C    │    D    │
</span></span><span class=line><span class=cl>     │         │  ┌───┐  │
</span></span><span class=line><span class=cl>     │         │  │R3 │  │
</span></span><span class=line><span class=cl>     │         │  └───┘  │
</span></span><span class=line><span class=cl>     └─────────┴─────────┘
</span></span><span class=line><span class=cl>     
</span></span><span class=line><span class=cl>루트: {A, B, C, D}
</span></span><span class=line><span class=cl>리프: {R1, R2, R3, ...} (실제 공간 객체)
</span></span></code></pre></td></tr></table></div></div><p><strong>4단계: 웹 시대와 텍스트 검색 (1990s-2000s)</strong></p><p><strong>Full-Text Index의 부상</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-53-1><a class=lnlinks href=#hl-53-1> 1</a>
</span><span class=lnt id=hl-53-2><a class=lnlinks href=#hl-53-2> 2</a>
</span><span class=lnt id=hl-53-3><a class=lnlinks href=#hl-53-3> 3</a>
</span><span class=lnt id=hl-53-4><a class=lnlinks href=#hl-53-4> 4</a>
</span><span class=lnt id=hl-53-5><a class=lnlinks href=#hl-53-5> 5</a>
</span><span class=lnt id=hl-53-6><a class=lnlinks href=#hl-53-6> 6</a>
</span><span class=lnt id=hl-53-7><a class=lnlinks href=#hl-53-7> 7</a>
</span><span class=lnt id=hl-53-8><a class=lnlinks href=#hl-53-8> 8</a>
</span><span class=lnt id=hl-53-9><a class=lnlinks href=#hl-53-9> 9</a>
</span><span class=lnt id=hl-53-10><a class=lnlinks href=#hl-53-10>10</a>
</span><span class=lnt id=hl-53-11><a class=lnlinks href=#hl-53-11>11</a>
</span><span class=lnt id=hl-53-12><a class=lnlinks href=#hl-53-12>12</a>
</span><span class=lnt id=hl-53-13><a class=lnlinks href=#hl-53-13>13</a>
</span><span class=lnt id=hl-53-14><a class=lnlinks href=#hl-53-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>역색인 (Inverted Index) 구조
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>문서:
</span></span><span class=line><span class=cl>Doc1: &#34;database index performance&#34;
</span></span><span class=line><span class=cl>Doc2: &#34;index optimization techniques&#34;
</span></span><span class=line><span class=cl>Doc3: &#34;database performance tuning&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>역색인:
</span></span><span class=line><span class=cl>database → [Doc1, Doc3]
</span></span><span class=line><span class=cl>index → [Doc1, Doc2]
</span></span><span class=line><span class=cl>performance → [Doc1, Doc3]
</span></span><span class=line><span class=cl>optimization → [Doc2]
</span></span><span class=line><span class=cl>techniques → [Doc2]
</span></span><span class=line><span class=cl>tuning → [Doc3]
</span></span></code></pre></td></tr></table></div></div><p><strong>주요 구현</strong>:</p><ul><li>Lucene (2000): 오픈소스 검색 엔진 라이브러리</li><li>Elasticsearch (2010): 분산 검색 엔진</li><li>특징: TF-IDF, BM25 등 랭킹 알고리즘 통합</li></ul><p><strong>5단계: 빅데이터 시대 (2010s)</strong></p><p><strong>컬럼 기반 인덱스</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-54-1><a class=lnlinks href=#hl-54-1> 1</a>
</span><span class=lnt id=hl-54-2><a class=lnlinks href=#hl-54-2> 2</a>
</span><span class=lnt id=hl-54-3><a class=lnlinks href=#hl-54-3> 3</a>
</span><span class=lnt id=hl-54-4><a class=lnlinks href=#hl-54-4> 4</a>
</span><span class=lnt id=hl-54-5><a class=lnlinks href=#hl-54-5> 5</a>
</span><span class=lnt id=hl-54-6><a class=lnlinks href=#hl-54-6> 6</a>
</span><span class=lnt id=hl-54-7><a class=lnlinks href=#hl-54-7> 7</a>
</span><span class=lnt id=hl-54-8><a class=lnlinks href=#hl-54-8> 8</a>
</span><span class=lnt id=hl-54-9><a class=lnlinks href=#hl-54-9> 9</a>
</span><span class=lnt id=hl-54-10><a class=lnlinks href=#hl-54-10>10</a>
</span><span class=lnt id=hl-54-11><a class=lnlinks href=#hl-54-11>11</a>
</span><span class=lnt id=hl-54-12><a class=lnlinks href=#hl-54-12>12</a>
</span><span class=lnt id=hl-54-13><a class=lnlinks href=#hl-54-13>13</a>
</span><span class=lnt id=hl-54-14><a class=lnlinks href=#hl-54-14>14</a>
</span><span class=lnt id=hl-54-15><a class=lnlinks href=#hl-54-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>행 기반 vs 컬럼 기반 저장
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>행 기반 (Row-Store):
</span></span><span class=line><span class=cl>Row1: [ID=1, Name=&#39;Alice&#39;, Age=30, City=&#39;NYC&#39;]
</span></span><span class=line><span class=cl>Row2: [ID=2, Name=&#39;Bob&#39;, Age=25, City=&#39;LA&#39;]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>컬럼 기반 (Column-Store):
</span></span><span class=line><span class=cl>ID: [1, 2, ...]
</span></span><span class=line><span class=cl>Name: [&#39;Alice&#39;, &#39;Bob&#39;, ...]
</span></span><span class=line><span class=cl>Age: [30, 25, ...]
</span></span><span class=line><span class=cl>City: [&#39;NYC&#39;, &#39;LA&#39;, ...]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>분석 쿼리 (SELECT AVG(Age) ...):
</span></span><span class=line><span class=cl>└─ 행 기반: 모든 컬럼 읽어야 함
</span></span><span class=line><span class=cl>└─ 컬럼 기반: Age 컬럼만 읽으면 됨
</span></span></code></pre></td></tr></table></div></div><p><strong>Columnstore Index의 장점</strong>:</p><ul><li>압축률 향상: 동일 타입 데이터 연속 저장</li><li>벡터화 실행: SIMD 명령어 활용</li><li>분석 쿼리 10-100배 가속</li></ul><p><strong>6단계: 머신러닝 인덱스 (2018-현재)</strong></p><p><strong>Learned Index (2018)</strong></p><p>MIT의 Tim Kraska 연구팀 제안:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-55-1><a class=lnlinks href=#hl-55-1> 1</a>
</span><span class=lnt id=hl-55-2><a class=lnlinks href=#hl-55-2> 2</a>
</span><span class=lnt id=hl-55-3><a class=lnlinks href=#hl-55-3> 3</a>
</span><span class=lnt id=hl-55-4><a class=lnlinks href=#hl-55-4> 4</a>
</span><span class=lnt id=hl-55-5><a class=lnlinks href=#hl-55-5> 5</a>
</span><span class=lnt id=hl-55-6><a class=lnlinks href=#hl-55-6> 6</a>
</span><span class=lnt id=hl-55-7><a class=lnlinks href=#hl-55-7> 7</a>
</span><span class=lnt id=hl-55-8><a class=lnlinks href=#hl-55-8> 8</a>
</span><span class=lnt id=hl-55-9><a class=lnlinks href=#hl-55-9> 9</a>
</span><span class=lnt id=hl-55-10><a class=lnlinks href=#hl-55-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>전통 인덱스: 트리/해시 자료구조
</span></span><span class=line><span class=cl>Learned Index: 머신러닝 모델
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>위치 예측 모델:
</span></span><span class=line><span class=cl>f(key) → position
</span></span><span class=line><span class=cl>where position ≈ actual_position ± ε
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>예시:
</span></span><span class=line><span class=cl>키 범위 [1, 1000000]가 균등 분포
</span></span><span class=line><span class=cl>→ 선형 모델: f(k) = k (매우 정확)
</span></span></code></pre></td></tr></table></div></div><p><strong>구조</strong>:</p><pre class=mermaid>graph TB
    A[Root Model&lt;br/&gt;Neural Network] --&gt; B[Model Layer 1&lt;br/&gt;여러 전문 모델]
    A --&gt; C[Model Layer 1]
    A --&gt; D[Model Layer 1]
    
    B --&gt; E[Data Layer&lt;br/&gt;실제 데이터 배열]
    C --&gt; F[Data Layer]
    D --&gt; G[Data Layer]
    
    style A fill:#87CEEB
    style E fill:#90EE90
    style F fill:#90EE90
    style G fill:#90EE90
</pre><p><strong>장점</strong>:</p><ul><li>메모리 사용량: 전통 B-Tree 대비 1/10</li><li>탐색 속도: 특정 분포에서 더 빠름</li><li>캐시 친화적: 연속 메모리 접근</li></ul><p><strong>한계</strong>:</p><ul><li>쓰기 성능: 모델 재학습 필요</li><li>분포 변화: 데이터 패턴 변경 시 정확도 저하</li><li>아직 연구 단계: 프로덕션 적용 제한적</li></ul><h4 id=18-산업별-적용-현황-및-채택률-심화>1.8 산업별 적용 현황 및 채택률 (심화)<a hidden class=anchor aria-hidden=true href=#18-산업별-적용-현황-및-채택률-심화>#</a></h4><p><strong>금융 산업 (Banking & Finance)</strong></p><p><strong>적용 특성</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-57-1><a class=lnlinks href=#hl-57-1>1</a>
</span><span class=lnt id=hl-57-2><a class=lnlinks href=#hl-57-2>2</a>
</span><span class=lnt id=hl-57-3><a class=lnlinks href=#hl-57-3>3</a>
</span><span class=lnt id=hl-57-4><a class=lnlinks href=#hl-57-4>4</a>
</span><span class=lnt id=hl-57-5><a class=lnlinks href=#hl-57-5>5</a>
</span><span class=lnt id=hl-57-6><a class=lnlinks href=#hl-57-6>6</a>
</span><span class=lnt id=hl-57-7><a class=lnlinks href=#hl-57-7>7</a>
</span><span class=lnt id=hl-57-8><a class=lnlinks href=#hl-57-8>8</a>
</span><span class=lnt id=hl-57-9><a class=lnlinks href=#hl-57-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>거래 시스템 (OLTP)
</span></span><span class=line><span class=cl>├─ 초당 수만 건의 거래 처리
</span></span><span class=line><span class=cl>├─ 밀리초 단위 응답 시간 요구
</span></span><span class=line><span class=cl>└─ 99.999% 가용성 필요
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>핵심 인덱스 전략:
</span></span><span class=line><span class=cl>├─ 계좌번호, 거래ID: Clustered B-Tree
</span></span><span class=line><span class=cl>├─ 고객 조회: Composite Index (이름+생년월일)
</span></span><span class=line><span class=cl>└─ 실시간 분석: In-Memory Columnstore
</span></span></code></pre></td></tr></table></div></div><p><strong>사례: JP Morgan Chase</strong></p><ul><li>하루 60억 건 이상 거래 처리</li><li>계좌 테이블: 수십 개 인덱스 운영</li><li>쿼리 응답 시간: 평균 5ms 이하 유지</li></ul><p><strong>채택률</strong>: 거의 100% (인덱스 없는 금융 시스템 존재 불가)</p><p><strong>전자상거래 (E-Commerce)</strong></p><p><strong>적용 특성</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-58-1><a class=lnlinks href=#hl-58-1> 1</a>
</span><span class=lnt id=hl-58-2><a class=lnlinks href=#hl-58-2> 2</a>
</span><span class=lnt id=hl-58-3><a class=lnlinks href=#hl-58-3> 3</a>
</span><span class=lnt id=hl-58-4><a class=lnlinks href=#hl-58-4> 4</a>
</span><span class=lnt id=hl-58-5><a class=lnlinks href=#hl-58-5> 5</a>
</span><span class=lnt id=hl-58-6><a class=lnlinks href=#hl-58-6> 6</a>
</span><span class=lnt id=hl-58-7><a class=lnlinks href=#hl-58-7> 7</a>
</span><span class=lnt id=hl-58-8><a class=lnlinks href=#hl-58-8> 8</a>
</span><span class=lnt id=hl-58-9><a class=lnlinks href=#hl-58-9> 9</a>
</span><span class=lnt id=hl-58-10><a class=lnlinks href=#hl-58-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>검색 최적화
</span></span><span class=line><span class=cl>├─ 상품 검색: Full-Text Index
</span></span><span class=line><span class=cl>├─ 카테고리 필터: Bitmap Index
</span></span><span class=line><span class=cl>├─ 가격 범위: B-Tree Index
</span></span><span class=line><span class=cl>└─ 재고 관리: 복합 인덱스
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>주문 처리
</span></span><span class=line><span class=cl>├─ 주문번호: Primary Key (Clustered)
</span></span><span class=line><span class=cl>├─ 사용자ID: Non-Clustered Index
</span></span><span class=line><span class=cl>└─ 주문일시: Partition + Index
</span></span></code></pre></td></tr></table></div></div><p><strong>사례: Amazon</strong></p><ul><li>상품 검색: Elasticsearch (역색인)</li><li>주문 DB: DynamoDB (해시 기반 분산 인덱스)</li><li>추천 시스템: 그래프 기반 인덱스</li></ul><p><strong>성과</strong>:</p><ul><li>검색 응답: 50ms 이하</li><li>동시 접속: 수백만 사용자 지원</li></ul><p><strong>채택률</strong>: 100% (핵심 비즈니스 로직)</p><p><strong>소셜 미디어 (Social Media)</strong></p><p><strong>적용 특성</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-59-1><a class=lnlinks href=#hl-59-1>1</a>
</span><span class=lnt id=hl-59-2><a class=lnlinks href=#hl-59-2>2</a>
</span><span class=lnt id=hl-59-3><a class=lnlinks href=#hl-59-3>3</a>
</span><span class=lnt id=hl-59-4><a class=lnlinks href=#hl-59-4>4</a>
</span><span class=lnt id=hl-59-5><a class=lnlinks href=#hl-59-5>5</a>
</span><span class=lnt id=hl-59-6><a class=lnlinks href=#hl-59-6>6</a>
</span><span class=lnt id=hl-59-7><a class=lnlinks href=#hl-59-7>7</a>
</span><span class=lnt id=hl-59-8><a class=lnlinks href=#hl-59-8>8</a>
</span><span class=lnt id=hl-59-9><a class=lnlinks href=#hl-59-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>타임라인 생성
</span></span><span class=line><span class=cl>├─ 팔로우 관계: 그래프 인덱스
</span></span><span class=line><span class=cl>├─ 게시물 시간순: Time-Series Index
</span></span><span class=line><span class=cl>└─ 해시태그: Inverted Index
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>검색 기능
</span></span><span class=line><span class=cl>├─ 사용자명: Prefix Index
</span></span><span class=line><span class=cl>├─ 위치 기반: Geospatial Index (R-Tree)
</span></span><span class=line><span class=cl>└─ 콘텐츠: Full-Text Index
</span></span></code></pre></td></tr></table></div></div><p><strong>사례: Twitter (X)</strong></p><ul><li>FlockDB: 그래프 인덱스 (팔로우 관계)</li><li>Manhattan: 분산 key-value 저장소</li><li>초당 50만 건 이상 쿼리 처리</li></ul><p><strong>사례: Facebook (Meta)</strong></p><ul><li>TAO (The Associations and Objects): 그래프 캐시 + 인덱스</li><li>MySQL 샤딩: 지역별 인덱스 분산</li><li>10억 사용자 지원</li></ul><p><strong>채택률</strong>: 100% (확장성의 핵심)</p><p><strong>의료 시스템 (Healthcare)</strong></p><p><strong>적용 특성</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-60-1><a class=lnlinks href=#hl-60-1> 1</a>
</span><span class=lnt id=hl-60-2><a class=lnlinks href=#hl-60-2> 2</a>
</span><span class=lnt id=hl-60-3><a class=lnlinks href=#hl-60-3> 3</a>
</span><span class=lnt id=hl-60-4><a class=lnlinks href=#hl-60-4> 4</a>
</span><span class=lnt id=hl-60-5><a class=lnlinks href=#hl-60-5> 5</a>
</span><span class=lnt id=hl-60-6><a class=lnlinks href=#hl-60-6> 6</a>
</span><span class=lnt id=hl-60-7><a class=lnlinks href=#hl-60-7> 7</a>
</span><span class=lnt id=hl-60-8><a class=lnlinks href=#hl-60-8> 8</a>
</span><span class=lnt id=hl-60-9><a class=lnlinks href=#hl-60-9> 9</a>
</span><span class=lnt id=hl-60-10><a class=lnlinks href=#hl-60-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>전자 건강 기록 (EHR)
</span></span><span class=line><span class=cl>├─ 환자 ID: Clustered Index
</span></span><span class=line><span class=cl>├─ 진단명: Multi-Value Index (ICD 코드)
</span></span><span class=line><span class=cl>├─ 투약 이력: Temporal Index
</span></span><span class=line><span class=cl>└─ 의료 영상: BLOB + 메타데이터 인덱스
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>규정 준수
</span></span><span class=line><span class=cl>├─ 감사 로그: 시계열 인덱스
</span></span><span class=line><span class=cl>├─ 개인정보: 암호화 + 인덱스
</span></span><span class=line><span class=cl>└─ 접근 제어: 복합 인덱스
</span></span></code></pre></td></tr></table></div></div><p><strong>사례: Epic Systems</strong></p><ul><li>Cache 데이터베이스 기반</li><li>환자당 평균 12개 인덱스</li><li>실시간 의사결정 지원 (&lt;1초)</li></ul><p><strong>채택률</strong>: 95% (소규모 클리닉 제외)</p><p><strong>통신 산업 (Telecommunications)</strong></p><p><strong>적용 특성</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-61-1><a class=lnlinks href=#hl-61-1> 1</a>
</span><span class=lnt id=hl-61-2><a class=lnlinks href=#hl-61-2> 2</a>
</span><span class=lnt id=hl-61-3><a class=lnlinks href=#hl-61-3> 3</a>
</span><span class=lnt id=hl-61-4><a class=lnlinks href=#hl-61-4> 4</a>
</span><span class=lnt id=hl-61-5><a class=lnlinks href=#hl-61-5> 5</a>
</span><span class=lnt id=hl-61-6><a class=lnlinks href=#hl-61-6> 6</a>
</span><span class=lnt id=hl-61-7><a class=lnlinks href=#hl-61-7> 7</a>
</span><span class=lnt id=hl-61-8><a class=lnlinks href=#hl-61-8> 8</a>
</span><span class=lnt id=hl-61-9><a class=lnlinks href=#hl-61-9> 9</a>
</span><span class=lnt id=hl-61-10><a class=lnlinks href=#hl-61-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>통화 기록 (CDR)
</span></span><span class=line><span class=cl>├─ 통화자 번호: Hash Index
</span></span><span class=line><span class=cl>├─ 통화 시각: Partition + Time Index
</span></span><span class=line><span class=cl>├─ 통화 유형: Bitmap Index
</span></span><span class=line><span class=cl>└─ 통화 지역: Geospatial Index
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>네트워크 모니터링
</span></span><span class=line><span class=cl>├─ 장비 ID: Clustered Index
</span></span><span class=line><span class=cl>├─ 이벤트 타임스탬프: B-Tree
</span></span><span class=line><span class=cl>└─ 알람 유형: Covering Index
</span></span></code></pre></td></tr></table></div></div><p><strong>사례: AT&amp;T</strong></p><ul><li>하루 30억 건 이상 CDR 생성</li><li>파티션 + 로컬 인덱스 전략</li><li>실시간 과금 시스템 지원</li></ul><p><strong>채택률</strong>: 100% (데이터 볼륨 필수)</p><p><strong>게임 산업 (Gaming)</strong></p><p><strong>적용 특성</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-62-1><a class=lnlinks href=#hl-62-1> 1</a>
</span><span class=lnt id=hl-62-2><a class=lnlinks href=#hl-62-2> 2</a>
</span><span class=lnt id=hl-62-3><a class=lnlinks href=#hl-62-3> 3</a>
</span><span class=lnt id=hl-62-4><a class=lnlinks href=#hl-62-4> 4</a>
</span><span class=lnt id=hl-62-5><a class=lnlinks href=#hl-62-5> 5</a>
</span><span class=lnt id=hl-62-6><a class=lnlinks href=#hl-62-6> 6</a>
</span><span class=lnt id=hl-62-7><a class=lnlinks href=#hl-62-7> 7</a>
</span><span class=lnt id=hl-62-8><a class=lnlinks href=#hl-62-8> 8</a>
</span><span class=lnt id=hl-62-9><a class=lnlinks href=#hl-62-9> 9</a>
</span><span class=lnt id=hl-62-10><a class=lnlinks href=#hl-62-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>플레이어 데이터
</span></span><span class=line><span class=cl>├─ 플레이어 ID: Primary Key
</span></span><span class=line><span class=cl>├─ 레벨/랭킹: 정렬 인덱스
</span></span><span class=line><span class=cl>├─ 길드/친구: 그래프 인덱스
</span></span><span class=line><span class=cl>└─ 인벤토리: JSON 인덱스
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>리더보드
</span></span><span class=line><span class=cl>├─ 점수 기반: Sorted Set (Redis)
</span></span><span class=line><span class=cl>├─ 실시간 갱신: In-Memory Index
</span></span><span class=line><span class=cl>└─ 시즌별: Partition Index
</span></span></code></pre></td></tr></table></div></div><p><strong>사례: Riot Games (League of Legends)</strong></p><ul><li>Cassandra: 파티션 키 기반 인덱스</li><li>Redis: 리더보드 Sorted Set</li><li>동시 접속 800만 명 지원</li></ul><p><strong>채택률</strong>: 90% (일부 인디 게임 제외)</p><p><strong>물류 및 배송 (Logistics)</strong></p><p><strong>적용 특성</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-63-1><a class=lnlinks href=#hl-63-1> 1</a>
</span><span class=lnt id=hl-63-2><a class=lnlinks href=#hl-63-2> 2</a>
</span><span class=lnt id=hl-63-3><a class=lnlinks href=#hl-63-3> 3</a>
</span><span class=lnt id=hl-63-4><a class=lnlinks href=#hl-63-4> 4</a>
</span><span class=lnt id=hl-63-5><a class=lnlinks href=#hl-63-5> 5</a>
</span><span class=lnt id=hl-63-6><a class=lnlinks href=#hl-63-6> 6</a>
</span><span class=lnt id=hl-63-7><a class=lnlinks href=#hl-63-7> 7</a>
</span><span class=lnt id=hl-63-8><a class=lnlinks href=#hl-63-8> 8</a>
</span><span class=lnt id=hl-63-9><a class=lnlinks href=#hl-63-9> 9</a>
</span><span class=lnt id=hl-63-10><a class=lnlinks href=#hl-63-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>위치 추적
</span></span><span class=line><span class=cl>├─ 배송 ID: Primary Key
</span></span><span class=line><span class=cl>├─ 현재 위치: Geospatial Index
</span></span><span class=line><span class=cl>├─ 배송 상태: Partial Index
</span></span><span class=line><span class=cl>└─ 예상 도착: Time-Window Index
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>경로 최적화
</span></span><span class=line><span class=cl>├─ 출발지/도착지: Composite Spatial Index
</span></span><span class=line><span class=cl>├─ 교통 상황: Time-Series Index
</span></span><span class=line><span class=cl>└─ 차량 정보: Clustered Index
</span></span></code></pre></td></tr></table></div></div><p><strong>사례: UPS</strong></p><ul><li>ORION 시스템: 공간 인덱스 활용</li><li>하루 1,900만 개 패키지 추적</li><li>경로 최적화로 연간 1억 마일 절감</li></ul><p><strong>채택률</strong>: 100% (실시간 추적 필수)</p><p><strong>산업별 인덱스 전략 비교</strong></p><table><thead><tr><th>산업</th><th>주요 인덱스 타입</th><th>데이터 볼륨</th><th>응답 시간 요구</th><th>특수 요구사항</th></tr></thead><tbody><tr><td><strong>금융</strong></td><td>B-Tree, Hash</td><td>매우 높음</td><td>&lt;10ms</td><td>ACID 엄격</td></tr><tr><td><strong>전자상거래</strong></td><td>Full-Text, Bitmap</td><td>높음</td><td>&lt;100ms</td><td>검색 품질</td></tr><tr><td><strong>소셜미디어</strong></td><td>Graph, Inverted</td><td>매우 높음</td><td>&lt;50ms</td><td>확장성</td></tr><tr><td><strong>의료</strong></td><td>Composite, Temporal</td><td>중간</td><td>&lt;1s</td><td>규정 준수</td></tr><tr><td><strong>통신</strong></td><td>Partition, Time-Series</td><td>매우 높음</td><td>&lt;500ms</td><td>과금 정확성</td></tr><tr><td><strong>게임</strong></td><td>In-Memory, Sorted</td><td>높음</td><td>&lt;20ms</td><td>실시간성</td></tr><tr><td><strong>물류</strong></td><td>Geospatial, Time-Window</td><td>높음</td><td>&lt;200ms</td><td>위치 정확성</td></tr></tbody></table><p><strong>글로벌 채택 트렌드 (2024 기준)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-64-1><a class=lnlinks href=#hl-64-1> 1</a>
</span><span class=lnt id=hl-64-2><a class=lnlinks href=#hl-64-2> 2</a>
</span><span class=lnt id=hl-64-3><a class=lnlinks href=#hl-64-3> 3</a>
</span><span class=lnt id=hl-64-4><a class=lnlinks href=#hl-64-4> 4</a>
</span><span class=lnt id=hl-64-5><a class=lnlinks href=#hl-64-5> 5</a>
</span><span class=lnt id=hl-64-6><a class=lnlinks href=#hl-64-6> 6</a>
</span><span class=lnt id=hl-64-7><a class=lnlinks href=#hl-64-7> 7</a>
</span><span class=lnt id=hl-64-8><a class=lnlinks href=#hl-64-8> 8</a>
</span><span class=lnt id=hl-64-9><a class=lnlinks href=#hl-64-9> 9</a>
</span><span class=lnt id=hl-64-10><a class=lnlinks href=#hl-64-10>10</a>
</span><span class=lnt id=hl-64-11><a class=lnlinks href=#hl-64-11>11</a>
</span><span class=lnt id=hl-64-12><a class=lnlinks href=#hl-64-12>12</a>
</span><span class=lnt id=hl-64-13><a class=lnlinks href=#hl-64-13>13</a>
</span><span class=lnt id=hl-64-14><a class=lnlinks href=#hl-64-14>14</a>
</span><span class=lnt id=hl-64-15><a class=lnlinks href=#hl-64-15>15</a>
</span><span class=lnt id=hl-64-16><a class=lnlinks href=#hl-64-16>16</a>
</span><span class=lnt id=hl-64-17><a class=lnlinks href=#hl-64-17>17</a>
</span><span class=lnt id=hl-64-18><a class=lnlinks href=#hl-64-18>18</a>
</span><span class=lnt id=hl-64-19><a class=lnlinks href=#hl-64-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>기업 규모별 인덱스 활용률
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>대기업 (&gt;1000명):
</span></span><span class=line><span class=cl>├─ 다중 인덱스 전략: 95%
</span></span><span class=line><span class=cl>├─ 전문 DBA 팀: 80%
</span></span><span class=line><span class=cl>├─ 자동화 툴 사용: 70%
</span></span><span class=line><span class=cl>└─ 고급 인덱스 활용: 60%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>중견기업 (100-1000명):
</span></span><span class=line><span class=cl>├─ 기본 인덱스 전략: 90%
</span></span><span class=line><span class=cl>├─ 전담 DBA: 40%
</span></span><span class=line><span class=cl>├─ 자동화 툴: 30%
</span></span><span class=line><span class=cl>└─ 고급 인덱스: 20%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>스타트업 (&lt;100명):
</span></span><span class=line><span class=cl>├─ 기본 인덱스: 70%
</span></span><span class=line><span class=cl>├─ DBA 없음: 80%
</span></span><span class=line><span class=cl>├─ 클라우드 자동화: 60%
</span></span><span class=line><span class=cl>└─ 고급 인덱스: 5%
</span></span></code></pre></td></tr></table></div></div><p>계속해서 Phase 2로 넘어가겠습니다.</p><hr><h3 id=phase-2-핵심-원리-및-이론적-기반-1>Phase 2: 핵심 원리 및 이론적 기반<a hidden class=anchor aria-hidden=true href=#phase-2-핵심-원리-및-이론적-기반-1>#</a></h3><h4 id=21-핵심-원칙-및-설계-철학-1>2.1 핵심 원칙 및 설계 철학<a hidden class=anchor aria-hidden=true href=#21-핵심-원칙-및-설계-철학-1>#</a></h4><p><strong>원칙 1: 디스크 I/O 최소화 (Minimize Disk I/O)</strong></p><p><strong>철학적 배경</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-65-1><a class=lnlinks href=#hl-65-1>1</a>
</span><span class=lnt id=hl-65-2><a class=lnlinks href=#hl-65-2>2</a>
</span><span class=lnt id=hl-65-3><a class=lnlinks href=#hl-65-3>3</a>
</span><span class=lnt id=hl-65-4><a class=lnlinks href=#hl-65-4>4</a>
</span><span class=lnt id=hl-65-5><a class=lnlinks href=#hl-65-5>5</a>
</span><span class=lnt id=hl-65-6><a class=lnlinks href=#hl-65-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>성능 병목의 근본 원인
</span></span><span class=line><span class=cl>├─ 메모리 접근: ~100 나노초
</span></span><span class=line><span class=cl>├─ SSD 접근: ~100 마이크로초 (1,000배 차이)
</span></span><span class=line><span class=cl>└─ HDD 접근: ~10 밀리초 (100,000배 차이)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>결론: 디스크 접근 횟수가 성능을 결정
</span></span></code></pre></td></tr></table></div></div><p><strong>설계 적용</strong>:</p><ul><li>높은 팬아웃(fanout): 노드당 많은 자식 → 트리 높이 감소</li><li>페이지 단위 저장: 디스크 블록 크기(4KB-16KB)에 맞춤</li><li>순차 접근 우선: 리프 노드 연결로 범위 검색 최적화</li></ul><p><strong>실제 효과</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-66-1><a class=lnlinks href=#hl-66-1> 1</a>
</span><span class=lnt id=hl-66-2><a class=lnlinks href=#hl-66-2> 2</a>
</span><span class=lnt id=hl-66-3><a class=lnlinks href=#hl-66-3> 3</a>
</span><span class=lnt id=hl-66-4><a class=lnlinks href=#hl-66-4> 4</a>
</span><span class=lnt id=hl-66-5><a class=lnlinks href=#hl-66-5> 5</a>
</span><span class=lnt id=hl-66-6><a class=lnlinks href=#hl-66-6> 6</a>
</span><span class=lnt id=hl-66-7><a class=lnlinks href=#hl-66-7> 7</a>
</span><span class=lnt id=hl-66-8><a class=lnlinks href=#hl-66-8> 8</a>
</span><span class=lnt id=hl-66-9><a class=lnlinks href=#hl-66-9> 9</a>
</span><span class=lnt id=hl-66-10><a class=lnlinks href=#hl-66-10>10</a>
</span><span class=lnt id=hl-66-11><a class=lnlinks href=#hl-66-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1억 건 데이터 검색
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>이진 탐색 트리 (fanout=2):
</span></span><span class=line><span class=cl>├─ 높이: log₂(100,000,000) ≈ 27
</span></span><span class=line><span class=cl>└─ 디스크 I/O: 27회
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>B-Tree (fanout=100):
</span></span><span class=line><span class=cl>├─ 높이: log₁₀₀(100,000,000) ≈ 4
</span></span><span class=line><span class=cl>└─ 디스크 I/O: 4회
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>개선: 85% 감소
</span></span></code></pre></td></tr></table></div></div><p><strong>원칙 2: 균형 유지 (Maintain Balance)</strong></p><p><strong>철학적 배경</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-67-1><a class=lnlinks href=#hl-67-1>1</a>
</span><span class=lnt id=hl-67-2><a class=lnlinks href=#hl-67-2>2</a>
</span><span class=lnt id=hl-67-3><a class=lnlinks href=#hl-67-3>3</a>
</span><span class=lnt id=hl-67-4><a class=lnlinks href=#hl-67-4>4</a>
</span><span class=lnt id=hl-67-5><a class=lnlinks href=#hl-67-5>5</a>
</span><span class=lnt id=hl-67-6><a class=lnlinks href=#hl-67-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>불균형의 문제
</span></span><span class=line><span class=cl>├─ 최선의 경우: O(log n)
</span></span><span class=line><span class=cl>├─ 평균적 경우: O(log n)
</span></span><span class=line><span class=cl>└─ 최악의 경우: O(n) ← 불균형 시
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>해결: 모든 경우에 O(log n) 보장
</span></span></code></pre></td></tr></table></div></div><p><strong>설계 적용</strong>:</p><ul><li>자동 재조정: 삽입/삭제 시 노드 분할/병합</li><li>엄격한 균형 조건: 모든 리프 동일 깊이</li><li>상향식 조정: 리프부터 루트까지 전파</li></ul><p><strong>재조정 알고리즘</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-68-1><a class=lnlinks href=#hl-68-1>1</a>
</span><span class=lnt id=hl-68-2><a class=lnlinks href=#hl-68-2>2</a>
</span><span class=lnt id=hl-68-3><a class=lnlinks href=#hl-68-3>3</a>
</span><span class=lnt id=hl-68-4><a class=lnlinks href=#hl-68-4>4</a>
</span><span class=lnt id=hl-68-5><a class=lnlinks href=#hl-68-5>5</a>
</span><span class=lnt id=hl-68-6><a class=lnlinks href=#hl-68-6>6</a>
</span><span class=lnt id=hl-68-7><a class=lnlinks href=#hl-68-7>7</a>
</span><span class=lnt id=hl-68-8><a class=lnlinks href=#hl-68-8>8</a>
</span><span class=lnt id=hl-68-9><a class=lnlinks href=#hl-68-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>노드 분할 (Split)
</span></span><span class=line><span class=cl>1. 노드가 꽉 찼을 때 (2t-1 키)
</span></span><span class=line><span class=cl>2. 중간 키를 부모로 승격
</span></span><span class=line><span class=cl>3. 나머지를 두 노드로 분할
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>노드 병합 (Merge)
</span></span><span class=line><span class=cl>1. 노드가 부족할 때 (&lt;t-1 키)
</span></span><span class=line><span class=cl>2. 형제 노드에서 키 차용 또는
</span></span><span class=line><span class=cl>3. 부모 키와 함께 병합
</span></span></code></pre></td></tr></table></div></div><p><strong>원칙 3: 공간 지역성 활용 (Exploit Spatial Locality)</strong></p><p><strong>철학적 배경</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-69-1><a class=lnlinks href=#hl-69-1>1</a>
</span><span class=lnt id=hl-69-2><a class=lnlinks href=#hl-69-2>2</a>
</span><span class=lnt id=hl-69-3><a class=lnlinks href=#hl-69-3>3</a>
</span><span class=lnt id=hl-69-4><a class=lnlinks href=#hl-69-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>캐시 효율성
</span></span><span class=line><span class=cl>├─ CPU 캐시: 연속 메모리 선호
</span></span><span class=line><span class=cl>├─ 디스크 캐시: 인접 블록 프리페치
</span></span><span class=line><span class=cl>└─ 결론: 관련 데이터를 물리적으로 가까이 배치
</span></span></code></pre></td></tr></table></div></div><p><strong>설계 적용</strong>:</p><ul><li>키 정렬 저장: 범위 검색 시 순차 접근</li><li>리프 노드 연결: 다음 범위로 즉시 이동</li><li>클러스터링: 자주 함께 조회되는 데이터 인접 배치</li></ul><p><strong>효과 측정</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-70-1><a class=lnlinks href=#hl-70-1>1</a>
</span><span class=lnt id=hl-70-2><a class=lnlinks href=#hl-70-2>2</a>
</span><span class=lnt id=hl-70-3><a class=lnlinks href=#hl-70-3>3</a>
</span><span class=lnt id=hl-70-4><a class=lnlinks href=#hl-70-4>4</a>
</span><span class=lnt id=hl-70-5><a class=lnlinks href=#hl-70-5>5</a>
</span><span class=lnt id=hl-70-6><a class=lnlinks href=#hl-70-6>6</a>
</span><span class=lnt id=hl-70-7><a class=lnlinks href=#hl-70-7>7</a>
</span><span class=lnt id=hl-70-8><a class=lnlinks href=#hl-70-8>8</a>
</span><span class=lnt id=hl-70-9><a class=lnlinks href=#hl-70-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>범위 검색 (BETWEEN 조건)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>비정렬 데이터:
</span></span><span class=line><span class=cl>└─ 랜덤 I/O: 각 레코드마다 디스크 탐색
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>정렬 + 연결 리프:
</span></span><span class=line><span class=cl>└─ 순차 I/O: 연속 블록 읽기
</span></span><span class=line><span class=cl>    → HDD: 100배 빠름
</span></span><span class=line><span class=cl>    → SSD: 3-5배 빠름
</span></span></code></pre></td></tr></table></div></div><p><strong>원칙 4: 선택적 저장 (Selective Storage)</strong></p><p><strong>철학적 배경</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-71-1><a class=lnlinks href=#hl-71-1>1</a>
</span><span class=lnt id=hl-71-2><a class=lnlinks href=#hl-71-2>2</a>
</span><span class=lnt id=hl-71-3><a class=lnlinks href=#hl-71-3>3</a>
</span><span class=lnt id=hl-71-4><a class=lnlinks href=#hl-71-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>전체 vs 부분
</span></span><span class=line><span class=cl>├─ 모든 데이터 인덱싱: 공간 낭비
</span></span><span class=line><span class=cl>├─ 필요한 데이터만 인덱싱: 효율적
</span></span><span class=line><span class=cl>└─ 결론: 쿼리 패턴 기반 선택적 인덱싱
</span></span></code></pre></td></tr></table></div></div><p><strong>설계 적용</strong>:</p><ul><li>커버링 인덱스: 자주 조회되는 컬럼만 포함</li><li>부분 인덱스: 조건을 만족하는 행만 인덱싱</li><li>필터링된 인덱스: 특정 WHERE 조건에만 적용</li></ul><p><strong>예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-72-1><a class=lnlinks href=#hl-72-1>1</a>
</span><span class=lnt id=hl-72-2><a class=lnlinks href=#hl-72-2>2</a>
</span><span class=lnt id=hl-72-3><a class=lnlinks href=#hl-72-3>3</a>
</span><span class=lnt id=hl-72-4><a class=lnlinks href=#hl-72-4>4</a>
</span><span class=lnt id=hl-72-5><a class=lnlinks href=#hl-72-5>5</a>
</span><span class=lnt id=hl-72-6><a class=lnlinks href=#hl-72-6>6</a>
</span><span class=lnt id=hl-72-7><a class=lnlinks href=#hl-72-7>7</a>
</span><span class=lnt id=hl-72-8><a class=lnlinks href=#hl-72-8>8</a>
</span><span class=lnt id=hl-72-9><a class=lnlinks href=#hl-72-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 전체 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_orders</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>order_date</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 크기: 전체 테이블의 10-15%
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 부분 인덱스 (PostgreSQL)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_active_orders</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>order_date</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;active&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 크기: 활성 주문만 (전체의 5%)
</span></span></span></code></pre></td></tr></table></div></div><p><strong>원칙 5: 읽기 최적화, 쓰기 트레이드오프 (Optimize Reads, Trade Write)</strong></p><p><strong>철학적 배경</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-73-1><a class=lnlinks href=#hl-73-1>1</a>
</span><span class=lnt id=hl-73-2><a class=lnlinks href=#hl-73-2>2</a>
</span><span class=lnt id=hl-73-3><a class=lnlinks href=#hl-73-3>3</a>
</span><span class=lnt id=hl-73-4><a class=lnlinks href=#hl-73-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>워크로드 특성
</span></span><span class=line><span class=cl>├─ OLTP: 읽기 70-90%, 쓰기 10-30%
</span></span><span class=line><span class=cl>├─ OLAP: 읽기 95%+, 쓰기 5%
</span></span><span class=line><span class=cl>└─ 결론: 읽기 성능을 위해 쓰기 비용 감수
</span></span></code></pre></td></tr></table></div></div><p><strong>트레이드오프 분석</strong>:</p><table><thead><tr><th>측면</th><th>인덱스 없음</th><th>인덱스 있음</th><th>변화</th></tr></thead><tbody><tr><td><strong>SELECT 성능</strong></td><td>O(n)</td><td>O(log n)</td><td>↑↑↑</td></tr><tr><td><strong>INSERT 성능</strong></td><td>O(1)</td><td>O(log n)</td><td>↓</td></tr><tr><td><strong>UPDATE 성능</strong></td><td>O(1)</td><td>O(log n)</td><td>↓</td></tr><tr><td><strong>DELETE 성능</strong></td><td>O(1)</td><td>O(log n)</td><td>↓</td></tr><tr><td><strong>저장 공간</strong></td><td>100%</td><td>130-150%</td><td>↓</td></tr></tbody></table><p><strong>완화 전략</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-74-1><a class=lnlinks href=#hl-74-1>1</a>
</span><span class=lnt id=hl-74-2><a class=lnlinks href=#hl-74-2>2</a>
</span><span class=lnt id=hl-74-3><a class=lnlinks href=#hl-74-3>3</a>
</span><span class=lnt id=hl-74-4><a class=lnlinks href=#hl-74-4>4</a>
</span><span class=lnt id=hl-74-5><a class=lnlinks href=#hl-74-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>쓰기 최적화 기법
</span></span><span class=line><span class=cl>├─ 배치 삽입: 여러 행을 한 번에 처리
</span></span><span class=line><span class=cl>├─ Bulk Load: 정렬 후 일괄 인덱스 생성
</span></span><span class=line><span class=cl>├─ 지연 업데이트: 변경 사항 버퍼링 후 일괄 반영
</span></span><span class=line><span class=cl>└─ Write-Optimized Index: LSM-Tree 구조 활용
</span></span></code></pre></td></tr></table></div></div><h4 id=22-기본-동작-원리-및-메커니즘-1>2.2 기본 동작 원리 및 메커니즘<a hidden class=anchor aria-hidden=true href=#22-기본-동작-원리-및-메커니즘-1>#</a></h4><p><strong>B-Tree 탐색 메커니즘</strong></p><p><strong>단계별 탐색 과정</strong>:</p><pre class=mermaid>graph TB
    Start[검색 키 k 입력] --&gt; Root[루트 노드 접근]
    Root --&gt; Compare1{k와 노드 키 비교}
    Compare1 --&gt;|k &lt; k₁| Child1[왼쪽 자식으로]
    Compare1 --&gt;|k₁ ≤ k &lt; k₂| Child2[중간 자식으로]
    Compare1 --&gt;|k ≥ kₙ| Child3[오른쪽 자식으로]
    
    Child1 --&gt; Leaf{리프 노드?}
    Child2 --&gt; Leaf
    Child3 --&gt; Leaf
    
    Leaf --&gt;|Yes| Found{키 발견?}
    Leaf --&gt;|No| Compare1
    
    Found --&gt;|Yes| Return[레코드 포인터 반환]
    Found --&gt;|No| NotFound[NULL 반환]
    
    style Return fill:#90EE90
    style NotFound fill:#FFB6C6
</pre><p><strong>의사 코드</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-76-1><a class=lnlinks href=#hl-76-1> 1</a>
</span><span class=lnt id=hl-76-2><a class=lnlinks href=#hl-76-2> 2</a>
</span><span class=lnt id=hl-76-3><a class=lnlinks href=#hl-76-3> 3</a>
</span><span class=lnt id=hl-76-4><a class=lnlinks href=#hl-76-4> 4</a>
</span><span class=lnt id=hl-76-5><a class=lnlinks href=#hl-76-5> 5</a>
</span><span class=lnt id=hl-76-6><a class=lnlinks href=#hl-76-6> 6</a>
</span><span class=lnt id=hl-76-7><a class=lnlinks href=#hl-76-7> 7</a>
</span><span class=lnt id=hl-76-8><a class=lnlinks href=#hl-76-8> 8</a>
</span><span class=lnt id=hl-76-9><a class=lnlinks href=#hl-76-9> 9</a>
</span><span class=lnt id=hl-76-10><a class=lnlinks href=#hl-76-10>10</a>
</span><span class=lnt id=hl-76-11><a class=lnlinks href=#hl-76-11>11</a>
</span><span class=lnt id=hl-76-12><a class=lnlinks href=#hl-76-12>12</a>
</span><span class=lnt id=hl-76-13><a class=lnlinks href=#hl-76-13>13</a>
</span><span class=lnt id=hl-76-14><a class=lnlinks href=#hl-76-14>14</a>
</span><span class=lnt id=hl-76-15><a class=lnlinks href=#hl-76-15>15</a>
</span><span class=lnt id=hl-76-16><a class=lnlinks href=#hl-76-16>16</a>
</span><span class=lnt id=hl-76-17><a class=lnlinks href=#hl-76-17>17</a>
</span><span class=lnt id=hl-76-18><a class=lnlinks href=#hl-76-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>btree_search</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;B-Tree 검색 알고리즘&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 현재 노드에서 키 위치 찾기</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>node</span><span class=o>.</span><span class=n>num_keys</span> <span class=ow>and</span> <span class=n>key</span> <span class=o>&gt;</span> <span class=n>node</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 키를 찾은 경우</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>node</span><span class=o>.</span><span class=n>num_keys</span> <span class=ow>and</span> <span class=n>key</span> <span class=o>==</span> <span class=n>node</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>node</span><span class=o>.</span><span class=n>pointers</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>  <span class=c1># 레코드 포인터 반환</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 리프 노드인데 못 찾은 경우</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>node</span><span class=o>.</span><span class=n>is_leaf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 내부 노드: 적절한 자식으로 재귀</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>btree_search</span><span class=p>(</span><span class=n>node</span><span class=o>.</span><span class=n>children</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>key</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>실제 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-77-1><a class=lnlinks href=#hl-77-1> 1</a>
</span><span class=lnt id=hl-77-2><a class=lnlinks href=#hl-77-2> 2</a>
</span><span class=lnt id=hl-77-3><a class=lnlinks href=#hl-77-3> 3</a>
</span><span class=lnt id=hl-77-4><a class=lnlinks href=#hl-77-4> 4</a>
</span><span class=lnt id=hl-77-5><a class=lnlinks href=#hl-77-5> 5</a>
</span><span class=lnt id=hl-77-6><a class=lnlinks href=#hl-77-6> 6</a>
</span><span class=lnt id=hl-77-7><a class=lnlinks href=#hl-77-7> 7</a>
</span><span class=lnt id=hl-77-8><a class=lnlinks href=#hl-77-8> 8</a>
</span><span class=lnt id=hl-77-9><a class=lnlinks href=#hl-77-9> 9</a>
</span><span class=lnt id=hl-77-10><a class=lnlinks href=#hl-77-10>10</a>
</span><span class=lnt id=hl-77-11><a class=lnlinks href=#hl-77-11>11</a>
</span><span class=lnt id=hl-77-12><a class=lnlinks href=#hl-77-12>12</a>
</span><span class=lnt id=hl-77-13><a class=lnlinks href=#hl-77-13>13</a>
</span><span class=lnt id=hl-77-14><a class=lnlinks href=#hl-77-14>14</a>
</span><span class=lnt id=hl-77-15><a class=lnlinks href=#hl-77-15>15</a>
</span><span class=lnt id=hl-77-16><a class=lnlinks href=#hl-77-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>B-Tree 구조 (차수 t=3, 최대 5개 키):
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                [30, 60]
</span></span><span class=line><span class=cl>               /    |    \
</span></span><span class=line><span class=cl>         [10,20] [40,50] [70,80,90]
</span></span><span class=line><span class=cl>         
</span></span><span class=line><span class=cl>검색: key = 50
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1단계: 루트 [30, 60]
</span></span><span class=line><span class=cl>       50 &gt; 30, 50 &lt; 60 → 중간 자식
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2단계: [40, 50]
</span></span><span class=line><span class=cl>       50 == 50 → 발견!
</span></span><span class=line><span class=cl>       
</span></span><span class=line><span class=cl>총 비교: 3회 (루트 2회 + 리프 1회)
</span></span><span class=line><span class=cl>디스크 I/O: 2회
</span></span></code></pre></td></tr></table></div></div><p><strong>삽입 메커니즘</strong></p><p><strong>기본 삽입 과정</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-78-1><a class=lnlinks href=#hl-78-1> 1</a>
</span><span class=lnt id=hl-78-2><a class=lnlinks href=#hl-78-2> 2</a>
</span><span class=lnt id=hl-78-3><a class=lnlinks href=#hl-78-3> 3</a>
</span><span class=lnt id=hl-78-4><a class=lnlinks href=#hl-78-4> 4</a>
</span><span class=lnt id=hl-78-5><a class=lnlinks href=#hl-78-5> 5</a>
</span><span class=lnt id=hl-78-6><a class=lnlinks href=#hl-78-6> 6</a>
</span><span class=lnt id=hl-78-7><a class=lnlinks href=#hl-78-7> 7</a>
</span><span class=lnt id=hl-78-8><a class=lnlinks href=#hl-78-8> 8</a>
</span><span class=lnt id=hl-78-9><a class=lnlinks href=#hl-78-9> 9</a>
</span><span class=lnt id=hl-78-10><a class=lnlinks href=#hl-78-10>10</a>
</span><span class=lnt id=hl-78-11><a class=lnlinks href=#hl-78-11>11</a>
</span><span class=lnt id=hl-78-12><a class=lnlinks href=#hl-78-12>12</a>
</span><span class=lnt id=hl-78-13><a class=lnlinks href=#hl-78-13>13</a>
</span><span class=lnt id=hl-78-14><a class=lnlinks href=#hl-78-14>14</a>
</span><span class=lnt id=hl-78-15><a class=lnlinks href=#hl-78-15>15</a>
</span><span class=lnt id=hl-78-16><a class=lnlinks href=#hl-78-16>16</a>
</span><span class=lnt id=hl-78-17><a class=lnlinks href=#hl-78-17>17</a>
</span><span class=lnt id=hl-78-18><a class=lnlinks href=#hl-78-18>18</a>
</span><span class=lnt id=hl-78-19><a class=lnlinks href=#hl-78-19>19</a>
</span><span class=lnt id=hl-78-20><a class=lnlinks href=#hl-78-20>20</a>
</span><span class=lnt id=hl-78-21><a class=lnlinks href=#hl-78-21>21</a>
</span><span class=lnt id=hl-78-22><a class=lnlinks href=#hl-78-22>22</a>
</span><span class=lnt id=hl-78-23><a class=lnlinks href=#hl-78-23>23</a>
</span><span class=lnt id=hl-78-24><a class=lnlinks href=#hl-78-24>24</a>
</span><span class=lnt id=hl-78-25><a class=lnlinks href=#hl-78-25>25</a>
</span><span class=lnt id=hl-78-26><a class=lnlinks href=#hl-78-26>26</a>
</span><span class=lnt id=hl-78-27><a class=lnlinks href=#hl-78-27>27</a>
</span><span class=lnt id=hl-78-28><a class=lnlinks href=#hl-78-28>28</a>
</span><span class=lnt id=hl-78-29><a class=lnlinks href=#hl-78-29>29</a>
</span><span class=lnt id=hl-78-30><a class=lnlinks href=#hl-78-30>30</a>
</span><span class=lnt id=hl-78-31><a class=lnlinks href=#hl-78-31>31</a>
</span><span class=lnt id=hl-78-32><a class=lnlinks href=#hl-78-32>32</a>
</span><span class=lnt id=hl-78-33><a class=lnlinks href=#hl-78-33>33</a>
</span><span class=lnt id=hl-78-34><a class=lnlinks href=#hl-78-34>34</a>
</span><span class=lnt id=hl-78-35><a class=lnlinks href=#hl-78-35>35</a>
</span><span class=lnt id=hl-78-36><a class=lnlinks href=#hl-78-36>36</a>
</span><span class=lnt id=hl-78-37><a class=lnlinks href=#hl-78-37>37</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>btree_insert</span><span class=p>(</span><span class=n>tree</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;B-Tree 삽입 알고리즘&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>root</span> <span class=o>=</span> <span class=n>tree</span><span class=o>.</span><span class=n>root</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 루트가 꽉 찬 경우</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>root</span><span class=o>.</span><span class=n>is_full</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>new_root</span> <span class=o>=</span> <span class=n>Node</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>new_root</span><span class=o>.</span><span class=n>children</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>root</span>
</span></span><span class=line><span class=cl>        <span class=n>split_child</span><span class=p>(</span><span class=n>new_root</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>  <span class=c1># 루트 분할</span>
</span></span><span class=line><span class=cl>        <span class=n>tree</span><span class=o>.</span><span class=n>root</span> <span class=o>=</span> <span class=n>new_root</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>insert_non_full</span><span class=p>(</span><span class=n>tree</span><span class=o>.</span><span class=n>root</span><span class=p>,</span> <span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>insert_non_full</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;여유 있는 노드에 삽입&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=n>node</span><span class=o>.</span><span class=n>num_keys</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>node</span><span class=o>.</span><span class=n>is_leaf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 리프 노드: 적절한 위치에 삽입</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>key</span> <span class=o>&lt;</span> <span class=n>node</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>node</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>node</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>node</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>        <span class=n>node</span><span class=o>.</span><span class=n>num_keys</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 내부 노드: 적절한 자식 찾기</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>key</span> <span class=o>&lt;</span> <span class=n>node</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 자식이 꽉 찬 경우 분할</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>node</span><span class=o>.</span><span class=n>children</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>is_full</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>split_child</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>key</span> <span class=o>&gt;</span> <span class=n>node</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>insert_non_full</span><span class=p>(</span><span class=n>node</span><span class=o>.</span><span class=n>children</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>key</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>노드 분할 과정</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-79-1><a class=lnlinks href=#hl-79-1>1</a>
</span><span class=lnt id=hl-79-2><a class=lnlinks href=#hl-79-2>2</a>
</span><span class=lnt id=hl-79-3><a class=lnlinks href=#hl-79-3>3</a>
</span><span class=lnt id=hl-79-4><a class=lnlinks href=#hl-79-4>4</a>
</span><span class=lnt id=hl-79-5><a class=lnlinks href=#hl-79-5>5</a>
</span><span class=lnt id=hl-79-6><a class=lnlinks href=#hl-79-6>6</a>
</span><span class=lnt id=hl-79-7><a class=lnlinks href=#hl-79-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>분할 전: 노드 포화 (t=3, 키 5개)
</span></span><span class=line><span class=cl>[10, 20, 30, 40, 50]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>분할 후:
</span></span><span class=line><span class=cl>부모로 승격: [30]
</span></span><span class=line><span class=cl>         /      \
</span></span><span class=line><span class=cl>왼쪽: [10, 20]  오른쪽: [40, 50]
</span></span></code></pre></td></tr></table></div></div><p><strong>시각화된 삽입 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-80-1><a class=lnlinks href=#hl-80-1> 1</a>
</span><span class=lnt id=hl-80-2><a class=lnlinks href=#hl-80-2> 2</a>
</span><span class=lnt id=hl-80-3><a class=lnlinks href=#hl-80-3> 3</a>
</span><span class=lnt id=hl-80-4><a class=lnlinks href=#hl-80-4> 4</a>
</span><span class=lnt id=hl-80-5><a class=lnlinks href=#hl-80-5> 5</a>
</span><span class=lnt id=hl-80-6><a class=lnlinks href=#hl-80-6> 6</a>
</span><span class=lnt id=hl-80-7><a class=lnlinks href=#hl-80-7> 7</a>
</span><span class=lnt id=hl-80-8><a class=lnlinks href=#hl-80-8> 8</a>
</span><span class=lnt id=hl-80-9><a class=lnlinks href=#hl-80-9> 9</a>
</span><span class=lnt id=hl-80-10><a class=lnlinks href=#hl-80-10>10</a>
</span><span class=lnt id=hl-80-11><a class=lnlinks href=#hl-80-11>11</a>
</span><span class=lnt id=hl-80-12><a class=lnlinks href=#hl-80-12>12</a>
</span><span class=lnt id=hl-80-13><a class=lnlinks href=#hl-80-13>13</a>
</span><span class=lnt id=hl-80-14><a class=lnlinks href=#hl-80-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>초기: [30]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>삽입 10: [10, 30]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>삽입 20: [10, 20, 30]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>삽입 40: [10, 20, 30, 40]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>삽입 50: [10, 20, 30, 40, 50]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>삽입 25 (분할 발생):
</span></span><span class=line><span class=cl>              [30]
</span></span><span class=line><span class=cl>            /      \
</span></span><span class=line><span class=cl>    [10, 20, 25]  [40, 50]
</span></span></code></pre></td></tr></table></div></div><p><strong>삭제 메커니즘</strong></p><p><strong>케이스별 삭제 전략</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-81-1><a class=lnlinks href=#hl-81-1> 1</a>
</span><span class=lnt id=hl-81-2><a class=lnlinks href=#hl-81-2> 2</a>
</span><span class=lnt id=hl-81-3><a class=lnlinks href=#hl-81-3> 3</a>
</span><span class=lnt id=hl-81-4><a class=lnlinks href=#hl-81-4> 4</a>
</span><span class=lnt id=hl-81-5><a class=lnlinks href=#hl-81-5> 5</a>
</span><span class=lnt id=hl-81-6><a class=lnlinks href=#hl-81-6> 6</a>
</span><span class=lnt id=hl-81-7><a class=lnlinks href=#hl-81-7> 7</a>
</span><span class=lnt id=hl-81-8><a class=lnlinks href=#hl-81-8> 8</a>
</span><span class=lnt id=hl-81-9><a class=lnlinks href=#hl-81-9> 9</a>
</span><span class=lnt id=hl-81-10><a class=lnlinks href=#hl-81-10>10</a>
</span><span class=lnt id=hl-81-11><a class=lnlinks href=#hl-81-11>11</a>
</span><span class=lnt id=hl-81-12><a class=lnlinks href=#hl-81-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Case 1: 리프 노드에서 삭제
</span></span><span class=line><span class=cl>├─ 여유 있음 (&gt;t-1 키): 단순 제거
</span></span><span class=line><span class=cl>└─ 부족함 (≤t-1 키): 재조정 필요
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Case 2: 내부 노드에서 삭제
</span></span><span class=line><span class=cl>├─ 왼쪽 자식 여유: 선행자(predecessor)로 대체
</span></span><span class=line><span class=cl>├─ 오른쪽 자식 여유: 후행자(successor)로 대체
</span></span><span class=line><span class=cl>└─ 둘 다 부족: 병합 후 재귀 삭제
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Case 3: 재조정
</span></span><span class=line><span class=cl>├─ 형제에서 차용 (rotation)
</span></span><span class=line><span class=cl>└─ 형제와 병합 (merge)
</span></span></code></pre></td></tr></table></div></div><p><strong>의사 코드</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-82-1><a class=lnlinks href=#hl-82-1> 1</a>
</span><span class=lnt id=hl-82-2><a class=lnlinks href=#hl-82-2> 2</a>
</span><span class=lnt id=hl-82-3><a class=lnlinks href=#hl-82-3> 3</a>
</span><span class=lnt id=hl-82-4><a class=lnlinks href=#hl-82-4> 4</a>
</span><span class=lnt id=hl-82-5><a class=lnlinks href=#hl-82-5> 5</a>
</span><span class=lnt id=hl-82-6><a class=lnlinks href=#hl-82-6> 6</a>
</span><span class=lnt id=hl-82-7><a class=lnlinks href=#hl-82-7> 7</a>
</span><span class=lnt id=hl-82-8><a class=lnlinks href=#hl-82-8> 8</a>
</span><span class=lnt id=hl-82-9><a class=lnlinks href=#hl-82-9> 9</a>
</span><span class=lnt id=hl-82-10><a class=lnlinks href=#hl-82-10>10</a>
</span><span class=lnt id=hl-82-11><a class=lnlinks href=#hl-82-11>11</a>
</span><span class=lnt id=hl-82-12><a class=lnlinks href=#hl-82-12>12</a>
</span><span class=lnt id=hl-82-13><a class=lnlinks href=#hl-82-13>13</a>
</span><span class=lnt id=hl-82-14><a class=lnlinks href=#hl-82-14>14</a>
</span><span class=lnt id=hl-82-15><a class=lnlinks href=#hl-82-15>15</a>
</span><span class=lnt id=hl-82-16><a class=lnlinks href=#hl-82-16>16</a>
</span><span class=lnt id=hl-82-17><a class=lnlinks href=#hl-82-17>17</a>
</span><span class=lnt id=hl-82-18><a class=lnlinks href=#hl-82-18>18</a>
</span><span class=lnt id=hl-82-19><a class=lnlinks href=#hl-82-19>19</a>
</span><span class=lnt id=hl-82-20><a class=lnlinks href=#hl-82-20>20</a>
</span><span class=lnt id=hl-82-21><a class=lnlinks href=#hl-82-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>btree_delete</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;B-Tree 삭제 알고리즘&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=n>find_key_index</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>node</span><span class=o>.</span><span class=n>num_keys</span> <span class=ow>and</span> <span class=n>node</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=n>key</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 키를 찾은 경우</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>node</span><span class=o>.</span><span class=n>is_leaf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>delete_from_leaf</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>delete_from_internal</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=ow>not</span> <span class=n>node</span><span class=o>.</span><span class=n>is_leaf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 적절한 자식에서 재귀 삭제</span>
</span></span><span class=line><span class=cl>        <span class=n>is_in_last_child</span> <span class=o>=</span> <span class=p>(</span><span class=n>i</span> <span class=o>==</span> <span class=n>node</span><span class=o>.</span><span class=n>num_keys</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>node</span><span class=o>.</span><span class=n>children</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>num_keys</span> <span class=o>&lt;</span> <span class=n>t</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>fill_child</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span>  <span class=c1># 자식 보강</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>is_in_last_child</span> <span class=ow>and</span> <span class=n>i</span> <span class=o>&gt;</span> <span class=n>node</span><span class=o>.</span><span class=n>num_keys</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>btree_delete</span><span class=p>(</span><span class=n>node</span><span class=o>.</span><span class=n>children</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span> <span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>btree_delete</span><span class=p>(</span><span class=n>node</span><span class=o>.</span><span class=n>children</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>key</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>병합 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-83-1><a class=lnlinks href=#hl-83-1> 1</a>
</span><span class=lnt id=hl-83-2><a class=lnlinks href=#hl-83-2> 2</a>
</span><span class=lnt id=hl-83-3><a class=lnlinks href=#hl-83-3> 3</a>
</span><span class=lnt id=hl-83-4><a class=lnlinks href=#hl-83-4> 4</a>
</span><span class=lnt id=hl-83-5><a class=lnlinks href=#hl-83-5> 5</a>
</span><span class=lnt id=hl-83-6><a class=lnlinks href=#hl-83-6> 6</a>
</span><span class=lnt id=hl-83-7><a class=lnlinks href=#hl-83-7> 7</a>
</span><span class=lnt id=hl-83-8><a class=lnlinks href=#hl-83-8> 8</a>
</span><span class=lnt id=hl-83-9><a class=lnlinks href=#hl-83-9> 9</a>
</span><span class=lnt id=hl-83-10><a class=lnlinks href=#hl-83-10>10</a>
</span><span class=lnt id=hl-83-11><a class=lnlinks href=#hl-83-11>11</a>
</span><span class=lnt id=hl-83-12><a class=lnlinks href=#hl-83-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>삭제 전: 50 제거
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            [30, 60]
</span></span><span class=line><span class=cl>           /    |    \
</span></span><span class=line><span class=cl>    [10,20]  [40,50]  [70,80]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>자식 [40,50]이 부족해짐 (t=3, 최소 2개 필요)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>병합:
</span></span><span class=line><span class=cl>            [60]
</span></span><span class=line><span class=cl>           /    \
</span></span><span class=line><span class=cl>    [10,20,30,40]  [70,80]
</span></span></code></pre></td></tr></table></div></div><p><strong>Hash Index 동작 원리</strong></p><p><strong>해시 함수 기반 직접 접근</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-84-1><a class=lnlinks href=#hl-84-1> 1</a>
</span><span class=lnt id=hl-84-2><a class=lnlinks href=#hl-84-2> 2</a>
</span><span class=lnt id=hl-84-3><a class=lnlinks href=#hl-84-3> 3</a>
</span><span class=lnt id=hl-84-4><a class=lnlinks href=#hl-84-4> 4</a>
</span><span class=lnt id=hl-84-5><a class=lnlinks href=#hl-84-5> 5</a>
</span><span class=lnt id=hl-84-6><a class=lnlinks href=#hl-84-6> 6</a>
</span><span class=lnt id=hl-84-7><a class=lnlinks href=#hl-84-7> 7</a>
</span><span class=lnt id=hl-84-8><a class=lnlinks href=#hl-84-8> 8</a>
</span><span class=lnt id=hl-84-9><a class=lnlinks href=#hl-84-9> 9</a>
</span><span class=lnt id=hl-84-10><a class=lnlinks href=#hl-84-10>10</a>
</span><span class=lnt id=hl-84-11><a class=lnlinks href=#hl-84-11>11</a>
</span><span class=lnt id=hl-84-12><a class=lnlinks href=#hl-84-12>12</a>
</span><span class=lnt id=hl-84-13><a class=lnlinks href=#hl-84-13>13</a>
</span><span class=lnt id=hl-84-14><a class=lnlinks href=#hl-84-14>14</a>
</span><span class=lnt id=hl-84-15><a class=lnlinks href=#hl-84-15>15</a>
</span><span class=lnt id=hl-84-16><a class=lnlinks href=#hl-84-16>16</a>
</span><span class=lnt id=hl-84-17><a class=lnlinks href=#hl-84-17>17</a>
</span><span class=lnt id=hl-84-18><a class=lnlinks href=#hl-84-18>18</a>
</span><span class=lnt id=hl-84-19><a class=lnlinks href=#hl-84-19>19</a>
</span><span class=lnt id=hl-84-20><a class=lnlinks href=#hl-84-20>20</a>
</span><span class=lnt id=hl-84-21><a class=lnlinks href=#hl-84-21>21</a>
</span><span class=lnt id=hl-84-22><a class=lnlinks href=#hl-84-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>HashIndex</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>size</span> <span class=o>=</span> <span class=n>size</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>buckets</span> <span class=o>=</span> <span class=p>[[]</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>size</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>hash_function</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;해시 함수 (예: Division Method)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>hash</span><span class=p>(</span><span class=n>key</span><span class=p>)</span> <span class=o>%</span> <span class=bp>self</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>insert</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>pointer</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;키-포인터 쌍 삽입&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>bucket_index</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>hash_function</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 체이닝으로 충돌 해결</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>buckets</span><span class=p>[</span><span class=n>bucket_index</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>key</span><span class=p>,</span> <span class=n>pointer</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;키로 포인터 검색&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>bucket_index</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>hash_function</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>p</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>buckets</span><span class=p>[</span><span class=n>bucket_index</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>k</span> <span class=o>==</span> <span class=n>key</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>p</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>충돌 해결 방법</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-85-1><a class=lnlinks href=#hl-85-1>1</a>
</span><span class=lnt id=hl-85-2><a class=lnlinks href=#hl-85-2>2</a>
</span><span class=lnt id=hl-85-3><a class=lnlinks href=#hl-85-3>3</a>
</span><span class=lnt id=hl-85-4><a class=lnlinks href=#hl-85-4>4</a>
</span><span class=lnt id=hl-85-5><a class=lnlinks href=#hl-85-5>5</a>
</span><span class=lnt id=hl-85-6><a class=lnlinks href=#hl-85-6>6</a>
</span><span class=lnt id=hl-85-7><a class=lnlinks href=#hl-85-7>7</a>
</span><span class=lnt id=hl-85-8><a class=lnlinks href=#hl-85-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 체이닝 (Chaining)
</span></span><span class=line><span class=cl>   Bucket[3]: [(key1, ptr1)] → [(key2, ptr2)] → [(key3, ptr3)]
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>2. 오픈 어드레싱 (Open Addressing)
</span></span><span class=line><span class=cl>   충돌 시 다음 빈 슬롯 찾기:
</span></span><span class=line><span class=cl>   - 선형 탐사: h(k), h(k)+1, h(k)+2, ...
</span></span><span class=line><span class=cl>   - 제곱 탐사: h(k), h(k)+1², h(k)+2², ...
</span></span><span class=line><span class=cl>   - 이중 해싱: h₁(k), h₁(k)+h₂(k), h₁(k)+2h₂(k), ...
</span></span></code></pre></td></tr></table></div></div><h4 id=23-데이터-및-제어-흐름>2.3 데이터 및 제어 흐름<a hidden class=anchor aria-hidden=true href=#23-데이터-및-제어-흐름>#</a></h4><p><strong>쿼리 실행 생명주기</strong></p><p><strong>전체 흐름도</strong>:</p><pre class=mermaid>sequenceDiagram
    participant App as 애플리케이션
    participant Parser as 파서
    participant Optimizer as 옵티마이저
    participant Executor as 실행 엔진
    participant Buffer as 버퍼 풀
    participant Index as 인덱스
    participant Disk as 디스크
    
    App-&gt;&gt;Parser: SQL 쿼리
    Parser-&gt;&gt;Optimizer: 파싱된 쿼리 트리
    Optimizer-&gt;&gt;Optimizer: 통계 정보 조회
    Optimizer-&gt;&gt;Optimizer: 실행 계획 생성
    Optimizer-&gt;&gt;Executor: 최적 실행 계획
    
    Executor-&gt;&gt;Buffer: 인덱스 페이지 요청
    
    alt 버퍼에 있음
        Buffer--&gt;&gt;Executor: 캐시된 페이지 반환
    else 버퍼에 없음
        Buffer-&gt;&gt;Disk: 디스크 I/O 요청
        Disk--&gt;&gt;Buffer: 페이지 로드
        Buffer--&gt;&gt;Executor: 페이지 반환
    end
    
    Executor-&gt;&gt;Index: 인덱스 탐색
    Index--&gt;&gt;Executor: 레코드 포인터
    
    Executor-&gt;&gt;Buffer: 데이터 페이지 요청
    Buffer--&gt;&gt;Executor: 데이터 반환
    
    Executor-&gt;&gt;App: 결과 집합
</pre><p><strong>단계별 상세 흐름</strong></p><p><strong>1단계: 쿼리 파싱 (Parsing)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-87-1><a class=lnlinks href=#hl-87-1> 1</a>
</span><span class=lnt id=hl-87-2><a class=lnlinks href=#hl-87-2> 2</a>
</span><span class=lnt id=hl-87-3><a class=lnlinks href=#hl-87-3> 3</a>
</span><span class=lnt id=hl-87-4><a class=lnlinks href=#hl-87-4> 4</a>
</span><span class=lnt id=hl-87-5><a class=lnlinks href=#hl-87-5> 5</a>
</span><span class=lnt id=hl-87-6><a class=lnlinks href=#hl-87-6> 6</a>
</span><span class=lnt id=hl-87-7><a class=lnlinks href=#hl-87-7> 7</a>
</span><span class=lnt id=hl-87-8><a class=lnlinks href=#hl-87-8> 8</a>
</span><span class=lnt id=hl-87-9><a class=lnlinks href=#hl-87-9> 9</a>
</span><span class=lnt id=hl-87-10><a class=lnlinks href=#hl-87-10>10</a>
</span><span class=lnt id=hl-87-11><a class=lnlinks href=#hl-87-11>11</a>
</span><span class=lnt id=hl-87-12><a class=lnlinks href=#hl-87-12>12</a>
</span><span class=lnt id=hl-87-13><a class=lnlinks href=#hl-87-13>13</a>
</span><span class=lnt id=hl-87-14><a class=lnlinks href=#hl-87-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 입력 쿼리
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>customer_name</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>order_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>12345</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 파싱 결과 (추상 구문 트리)
</span></span></span><span class=line><span class=cl><span class=n>Query</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>SELECT</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>customer_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>order_date</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>FROM</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>orders</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>WHERE</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>-</span><span class=w> </span><span class=n>order_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>12345</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>2단계: 쿼리 최적화 (Optimization)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-88-1><a class=lnlinks href=#hl-88-1> 1</a>
</span><span class=lnt id=hl-88-2><a class=lnlinks href=#hl-88-2> 2</a>
</span><span class=lnt id=hl-88-3><a class=lnlinks href=#hl-88-3> 3</a>
</span><span class=lnt id=hl-88-4><a class=lnlinks href=#hl-88-4> 4</a>
</span><span class=lnt id=hl-88-5><a class=lnlinks href=#hl-88-5> 5</a>
</span><span class=lnt id=hl-88-6><a class=lnlinks href=#hl-88-6> 6</a>
</span><span class=lnt id=hl-88-7><a class=lnlinks href=#hl-88-7> 7</a>
</span><span class=lnt id=hl-88-8><a class=lnlinks href=#hl-88-8> 8</a>
</span><span class=lnt id=hl-88-9><a class=lnlinks href=#hl-88-9> 9</a>
</span><span class=lnt id=hl-88-10><a class=lnlinks href=#hl-88-10>10</a>
</span><span class=lnt id=hl-88-11><a class=lnlinks href=#hl-88-11>11</a>
</span><span class=lnt id=hl-88-12><a class=lnlinks href=#hl-88-12>12</a>
</span><span class=lnt id=hl-88-13><a class=lnlinks href=#hl-88-13>13</a>
</span><span class=lnt id=hl-88-14><a class=lnlinks href=#hl-88-14>14</a>
</span><span class=lnt id=hl-88-15><a class=lnlinks href=#hl-88-15>15</a>
</span><span class=lnt id=hl-88-16><a class=lnlinks href=#hl-88-16>16</a>
</span><span class=lnt id=hl-88-17><a class=lnlinks href=#hl-88-17>17</a>
</span><span class=lnt id=hl-88-18><a class=lnlinks href=#hl-88-18>18</a>
</span><span class=lnt id=hl-88-19><a class=lnlinks href=#hl-88-19>19</a>
</span><span class=lnt id=hl-88-20><a class=lnlinks href=#hl-88-20>20</a>
</span><span class=lnt id=hl-88-21><a class=lnlinks href=#hl-88-21>21</a>
</span><span class=lnt id=hl-88-22><a class=lnlinks href=#hl-88-22>22</a>
</span><span class=lnt id=hl-88-23><a class=lnlinks href=#hl-88-23>23</a>
</span><span class=lnt id=hl-88-24><a class=lnlinks href=#hl-88-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>옵티마이저 의사결정 과정:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. 가능한 실행 계획 열거
</span></span><span class=line><span class=cl>   Plan A: Full Table Scan
</span></span><span class=line><span class=cl>   Plan B: Index Seek on order_id
</span></span><span class=line><span class=cl>   Plan C: Index Scan + Filter
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 통계 정보 수집
</span></span><span class=line><span class=cl>   - 테이블 크기: 1,000,000 rows
</span></span><span class=line><span class=cl>   - order_id 인덱스 선택도: 0.999999 (거의 고유)
</span></span><span class=line><span class=cl>   - 페이지 수: 10,000 pages
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 비용 계산
</span></span><span class=line><span class=cl>   Plan A:
</span></span><span class=line><span class=cl>     └─ I/O: 10,000 pages × 10ms = 100,000ms
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   Plan B:
</span></span><span class=line><span class=cl>     └─ I/O: log₁₀₀(1,000,000) ≈ 3 pages × 10ms = 30ms
</span></span><span class=line><span class=cl>             + 1 data page = 40ms
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   Plan C:
</span></span><span class=line><span class=cl>     └─ I/O: 5,000 pages × 10ms = 50,000ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4. 최적 계획 선택: Plan B
</span></span></code></pre></td></tr></table></div></div><p><strong>3단계: 실행 (Execution)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-89-1><a class=lnlinks href=#hl-89-1> 1</a>
</span><span class=lnt id=hl-89-2><a class=lnlinks href=#hl-89-2> 2</a>
</span><span class=lnt id=hl-89-3><a class=lnlinks href=#hl-89-3> 3</a>
</span><span class=lnt id=hl-89-4><a class=lnlinks href=#hl-89-4> 4</a>
</span><span class=lnt id=hl-89-5><a class=lnlinks href=#hl-89-5> 5</a>
</span><span class=lnt id=hl-89-6><a class=lnlinks href=#hl-89-6> 6</a>
</span><span class=lnt id=hl-89-7><a class=lnlinks href=#hl-89-7> 7</a>
</span><span class=lnt id=hl-89-8><a class=lnlinks href=#hl-89-8> 8</a>
</span><span class=lnt id=hl-89-9><a class=lnlinks href=#hl-89-9> 9</a>
</span><span class=lnt id=hl-89-10><a class=lnlinks href=#hl-89-10>10</a>
</span><span class=lnt id=hl-89-11><a class=lnlinks href=#hl-89-11>11</a>
</span><span class=lnt id=hl-89-12><a class=lnlinks href=#hl-89-12>12</a>
</span><span class=lnt id=hl-89-13><a class=lnlinks href=#hl-89-13>13</a>
</span><span class=lnt id=hl-89-14><a class=lnlinks href=#hl-89-14>14</a>
</span><span class=lnt id=hl-89-15><a class=lnlinks href=#hl-89-15>15</a>
</span><span class=lnt id=hl-89-16><a class=lnlinks href=#hl-89-16>16</a>
</span><span class=lnt id=hl-89-17><a class=lnlinks href=#hl-89-17>17</a>
</span><span class=lnt id=hl-89-18><a class=lnlinks href=#hl-89-18>18</a>
</span><span class=lnt id=hl-89-19><a class=lnlinks href=#hl-89-19>19</a>
</span><span class=lnt id=hl-89-20><a class=lnlinks href=#hl-89-20>20</a>
</span><span class=lnt id=hl-89-21><a class=lnlinks href=#hl-89-21>21</a>
</span><span class=lnt id=hl-89-22><a class=lnlinks href=#hl-89-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>execute_index_seek</span><span class=p>(</span><span class=n>index</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>table</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;인덱스 Seek 실행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 1. 인덱스 탐색</span>
</span></span><span class=line><span class=cl>    <span class=n>pointer</span> <span class=o>=</span> <span class=n>index</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>pointer</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 2. 데이터 페이지 접근</span>
</span></span><span class=line><span class=cl>    <span class=n>page_id</span><span class=p>,</span> <span class=n>slot_id</span> <span class=o>=</span> <span class=n>pointer</span>
</span></span><span class=line><span class=cl>    <span class=n>page</span> <span class=o>=</span> <span class=n>buffer_pool</span><span class=o>.</span><span class=n>get_page</span><span class=p>(</span><span class=n>page_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 3. 레코드 추출</span>
</span></span><span class=line><span class=cl>    <span class=n>record</span> <span class=o>=</span> <span class=n>page</span><span class=o>.</span><span class=n>get_slot</span><span class=p>(</span><span class=n>slot_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 4. 투영(Projection)</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;customer_name&#39;</span><span class=p>:</span> <span class=n>record</span><span class=p>[</span><span class=s1>&#39;customer_name&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;order_date&#39;</span><span class=p>:</span> <span class=n>record</span><span class=p>[</span><span class=s1>&#39;order_date&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[</span><span class=n>result</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>버퍼 풀 관리 흐름</strong></p><p><strong>LRU 기반 캐시 관리</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-90-1><a class=lnlinks href=#hl-90-1> 1</a>
</span><span class=lnt id=hl-90-2><a class=lnlinks href=#hl-90-2> 2</a>
</span><span class=lnt id=hl-90-3><a class=lnlinks href=#hl-90-3> 3</a>
</span><span class=lnt id=hl-90-4><a class=lnlinks href=#hl-90-4> 4</a>
</span><span class=lnt id=hl-90-5><a class=lnlinks href=#hl-90-5> 5</a>
</span><span class=lnt id=hl-90-6><a class=lnlinks href=#hl-90-6> 6</a>
</span><span class=lnt id=hl-90-7><a class=lnlinks href=#hl-90-7> 7</a>
</span><span class=lnt id=hl-90-8><a class=lnlinks href=#hl-90-8> 8</a>
</span><span class=lnt id=hl-90-9><a class=lnlinks href=#hl-90-9> 9</a>
</span><span class=lnt id=hl-90-10><a class=lnlinks href=#hl-90-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>버퍼 풀 (Buffer Pool)
</span></span><span class=line><span class=cl>├─ 크기: 예) 1GB (262,144 페이지 @4KB)
</span></span><span class=line><span class=cl>├─ 구조: 해시 테이블 + LRU 리스트
</span></span><span class=line><span class=cl>└─ 정책: Least Recently Used
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>동작:
</span></span><span class=line><span class=cl>1. 페이지 요청
</span></span><span class=line><span class=cl>2. 해시 테이블에서 검색
</span></span><span class=line><span class=cl>   ├─ Hit: LRU 리스트 앞으로 이동
</span></span><span class=line><span class=cl>   └─ Miss: 디스크 로드 + 가장 오래된 페이지 교체
</span></span></code></pre></td></tr></table></div></div><p><strong>시각화</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-91-1><a class=lnlinks href=#hl-91-1> 1</a>
</span><span class=lnt id=hl-91-2><a class=lnlinks href=#hl-91-2> 2</a>
</span><span class=lnt id=hl-91-3><a class=lnlinks href=#hl-91-3> 3</a>
</span><span class=lnt id=hl-91-4><a class=lnlinks href=#hl-91-4> 4</a>
</span><span class=lnt id=hl-91-5><a class=lnlinks href=#hl-91-5> 5</a>
</span><span class=lnt id=hl-91-6><a class=lnlinks href=#hl-91-6> 6</a>
</span><span class=lnt id=hl-91-7><a class=lnlinks href=#hl-91-7> 7</a>
</span><span class=lnt id=hl-91-8><a class=lnlinks href=#hl-91-8> 8</a>
</span><span class=lnt id=hl-91-9><a class=lnlinks href=#hl-91-9> 9</a>
</span><span class=lnt id=hl-91-10><a class=lnlinks href=#hl-91-10>10</a>
</span><span class=lnt id=hl-91-11><a class=lnlinks href=#hl-91-11>11</a>
</span><span class=lnt id=hl-91-12><a class=lnlinks href=#hl-91-12>12</a>
</span><span class=lnt id=hl-91-13><a class=lnlinks href=#hl-91-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Initial State:
</span></span><span class=line><span class=cl>LRU List: [Page5] ← [Page3] ← [Page1] (oldest)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Access Page3:
</span></span><span class=line><span class=cl>LRU List: [Page3] ← [Page5] ← [Page1]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Access New Page7 (cache full):
</span></span><span class=line><span class=cl>1. Evict Page1 (oldest, not dirty)
</span></span><span class=line><span class=cl>2. Load Page7 from disk
</span></span><span class=line><span class=cl>LRU List: [Page7] ← [Page3] ← [Page5]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Access Page7 (hit):
</span></span><span class=line><span class=cl>LRU List: [Page7] ← [Page3] ← [Page5] (no change, already newest)
</span></span></code></pre></td></tr></table></div></div><p><strong>트랜잭션과 인덱스 상호작용</strong></p><p><strong>동시성 제어 흐름</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-92-1><a class=lnlinks href=#hl-92-1> 1</a>
</span><span class=lnt id=hl-92-2><a class=lnlinks href=#hl-92-2> 2</a>
</span><span class=lnt id=hl-92-3><a class=lnlinks href=#hl-92-3> 3</a>
</span><span class=lnt id=hl-92-4><a class=lnlinks href=#hl-92-4> 4</a>
</span><span class=lnt id=hl-92-5><a class=lnlinks href=#hl-92-5> 5</a>
</span><span class=lnt id=hl-92-6><a class=lnlinks href=#hl-92-6> 6</a>
</span><span class=lnt id=hl-92-7><a class=lnlinks href=#hl-92-7> 7</a>
</span><span class=lnt id=hl-92-8><a class=lnlinks href=#hl-92-8> 8</a>
</span><span class=lnt id=hl-92-9><a class=lnlinks href=#hl-92-9> 9</a>
</span><span class=lnt id=hl-92-10><a class=lnlinks href=#hl-92-10>10</a>
</span><span class=lnt id=hl-92-11><a class=lnlinks href=#hl-92-11>11</a>
</span><span class=lnt id=hl-92-12><a class=lnlinks href=#hl-92-12>12</a>
</span><span class=lnt id=hl-92-13><a class=lnlinks href=#hl-92-13>13</a>
</span><span class=lnt id=hl-92-14><a class=lnlinks href=#hl-92-14>14</a>
</span><span class=lnt id=hl-92-15><a class=lnlinks href=#hl-92-15>15</a>
</span><span class=lnt id=hl-92-16><a class=lnlinks href=#hl-92-16>16</a>
</span><span class=lnt id=hl-92-17><a class=lnlinks href=#hl-92-17>17</a>
</span><span class=lnt id=hl-92-18><a class=lnlinks href=#hl-92-18>18</a>
</span><span class=lnt id=hl-92-19><a class=lnlinks href=#hl-92-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Transaction T1: UPDATE orders SET status = &#39;shipped&#39; WHERE order_id = 100
</span></span><span class=line><span class=cl>Transaction T2: SELECT * FROM orders WHERE order_id = 100
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>타임라인:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>T1: BEGIN
</span></span><span class=line><span class=cl>T1: 인덱스에서 order_id=100 검색
</span></span><span class=line><span class=cl>T1: 인덱스 엔트리에 X-Lock 획득
</span></span><span class=line><span class=cl>T1: 데이터 페이지에 X-Lock 획득
</span></span><span class=line><span class=cl>T1: status 업데이트
</span></span><span class=line><span class=cl>                        T2: BEGIN
</span></span><span class=line><span class=cl>                        T2: 인덱스에서 order_id=100 검색
</span></span><span class=line><span class=cl>                        T2: 인덱스 엔트리에 S-Lock 요청
</span></span><span class=line><span class=cl>                        T2: WAIT (T1의 X-Lock과 충돌)
</span></span><span class=line><span class=cl>T1: COMMIT
</span></span><span class=line><span class=cl>T1: 모든 락 해제
</span></span><span class=line><span class=cl>                        T2: S-Lock 획득 성공
</span></span><span class=line><span class=cl>                        T2: 데이터 읽기
</span></span><span class=line><span class=cl>                        T2: COMMIT
</span></span></code></pre></td></tr></table></div></div><p><strong>MVCC 환경에서의 흐름 (PostgreSQL)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-93-1><a class=lnlinks href=#hl-93-1> 1</a>
</span><span class=lnt id=hl-93-2><a class=lnlinks href=#hl-93-2> 2</a>
</span><span class=lnt id=hl-93-3><a class=lnlinks href=#hl-93-3> 3</a>
</span><span class=lnt id=hl-93-4><a class=lnlinks href=#hl-93-4> 4</a>
</span><span class=lnt id=hl-93-5><a class=lnlinks href=#hl-93-5> 5</a>
</span><span class=lnt id=hl-93-6><a class=lnlinks href=#hl-93-6> 6</a>
</span><span class=lnt id=hl-93-7><a class=lnlinks href=#hl-93-7> 7</a>
</span><span class=lnt id=hl-93-8><a class=lnlinks href=#hl-93-8> 8</a>
</span><span class=lnt id=hl-93-9><a class=lnlinks href=#hl-93-9> 9</a>
</span><span class=lnt id=hl-93-10><a class=lnlinks href=#hl-93-10>10</a>
</span><span class=lnt id=hl-93-11><a class=lnlinks href=#hl-93-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>버전 관리:
</span></span><span class=line><span class=cl>- 각 행은 여러 버전 보유
</span></span><span class=line><span class=cl>- 인덱스는 모든 버전 가리킴
</span></span><span class=line><span class=cl>- Visibility Check로 올바른 버전 선택
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>검색 흐름:
</span></span><span class=line><span class=cl>1. 인덱스에서 키 검색
</span></span><span class=line><span class=cl>2. 모든 매칭 버전의 포인터 획득
</span></span><span class=line><span class=cl>3. 각 버전의 트랜잭션 ID 확인
</span></span><span class=line><span class=cl>4. 현재 트랜잭션에 보이는 버전 필터링
</span></span><span class=line><span class=cl>5. 최종 결과 반환
</span></span></code></pre></td></tr></table></div></div><p>계속해서 Phase 2의 나머지 부분을 진행하겠습니다.</p><hr><h4 id=24-구조-및-구성-요소>2.4 구조 및 구성 요소<a hidden class=anchor aria-hidden=true href=#24-구조-및-구성-요소>#</a></h4><p><strong>B-Tree 구조 상세</strong></p><p><strong>노드 구조</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-94-1><a class=lnlinks href=#hl-94-1> 1</a>
</span><span class=lnt id=hl-94-2><a class=lnlinks href=#hl-94-2> 2</a>
</span><span class=lnt id=hl-94-3><a class=lnlinks href=#hl-94-3> 3</a>
</span><span class=lnt id=hl-94-4><a class=lnlinks href=#hl-94-4> 4</a>
</span><span class=lnt id=hl-94-5><a class=lnlinks href=#hl-94-5> 5</a>
</span><span class=lnt id=hl-94-6><a class=lnlinks href=#hl-94-6> 6</a>
</span><span class=lnt id=hl-94-7><a class=lnlinks href=#hl-94-7> 7</a>
</span><span class=lnt id=hl-94-8><a class=lnlinks href=#hl-94-8> 8</a>
</span><span class=lnt id=hl-94-9><a class=lnlinks href=#hl-94-9> 9</a>
</span><span class=lnt id=hl-94-10><a class=lnlinks href=#hl-94-10>10</a>
</span><span class=lnt id=hl-94-11><a class=lnlinks href=#hl-94-11>11</a>
</span><span class=lnt id=hl-94-12><a class=lnlinks href=#hl-94-12>12</a>
</span><span class=lnt id=hl-94-13><a class=lnlinks href=#hl-94-13>13</a>
</span><span class=lnt id=hl-94-14><a class=lnlinks href=#hl-94-14>14</a>
</span><span class=lnt id=hl-94-15><a class=lnlinks href=#hl-94-15>15</a>
</span><span class=lnt id=hl-94-16><a class=lnlinks href=#hl-94-16>16</a>
</span><span class=lnt id=hl-94-17><a class=lnlinks href=#hl-94-17>17</a>
</span><span class=lnt id=hl-94-18><a class=lnlinks href=#hl-94-18>18</a>
</span><span class=lnt id=hl-94-19><a class=lnlinks href=#hl-94-19>19</a>
</span><span class=lnt id=hl-94-20><a class=lnlinks href=#hl-94-20>20</a>
</span><span class=lnt id=hl-94-21><a class=lnlinks href=#hl-94-21>21</a>
</span><span class=lnt id=hl-94-22><a class=lnlinks href=#hl-94-22>22</a>
</span><span class=lnt id=hl-94-23><a class=lnlinks href=#hl-94-23>23</a>
</span><span class=lnt id=hl-94-24><a class=lnlinks href=#hl-94-24>24</a>
</span><span class=lnt id=hl-94-25><a class=lnlinks href=#hl-94-25>25</a>
</span><span class=lnt id=hl-94-26><a class=lnlinks href=#hl-94-26>26</a>
</span><span class=lnt id=hl-94-27><a class=lnlinks href=#hl-94-27>27</a>
</span><span class=lnt id=hl-94-28><a class=lnlinks href=#hl-94-28>28</a>
</span><span class=lnt id=hl-94-29><a class=lnlinks href=#hl-94-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=c1>// B-Tree 노드의 물리적 구조
</span></span></span><span class=line><span class=cl><span class=k>struct</span> <span class=n>BTreeNode</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 헤더 정보
</span></span></span><span class=line><span class=cl>    <span class=kt>uint16_t</span> <span class=n>node_type</span><span class=p>;</span>        <span class=c1>// 내부/리프 구분
</span></span></span><span class=line><span class=cl>    <span class=kt>uint16_t</span> <span class=n>num_keys</span><span class=p>;</span>         <span class=c1>// 현재 키 개수
</span></span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>parent_pointer</span><span class=p>;</span>   <span class=c1>// 부모 노드 포인터
</span></span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>right_sibling</span><span class=p>;</span>    <span class=c1>// 오른쪽 형제 (리프만)
</span></span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 키 배열 (정렬됨)
</span></span></span><span class=line><span class=cl>    <span class=n>KeyType</span> <span class=n>keys</span><span class=p>[</span><span class=n>MAX_KEYS</span><span class=p>];</span>    <span class=c1>// 최대 2t-1개
</span></span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 포인터 배열
</span></span></span><span class=line><span class=cl>    <span class=k>union</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 내부 노드: 자식 노드 포인터
</span></span></span><span class=line><span class=cl>        <span class=kt>uint32_t</span> <span class=n>children</span><span class=p>[</span><span class=n>MAX_CHILDREN</span><span class=p>];</span>  <span class=c1>// 최대 2t개
</span></span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 리프 노드: 레코드 포인터
</span></span></span><span class=line><span class=cl>        <span class=n>RecordPointer</span> <span class=n>records</span><span class=p>[</span><span class=n>MAX_KEYS</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 체크섬 (무결성 검증)
</span></span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>checksum</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 레코드 포인터 구조
</span></span></span><span class=line><span class=cl><span class=k>struct</span> <span class=n>RecordPointer</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint32_t</span> <span class=n>page_id</span><span class=p>;</span>     <span class=c1>// 데이터 페이지 ID
</span></span></span><span class=line><span class=cl>    <span class=kt>uint16_t</span> <span class=n>slot_id</span><span class=p>;</span>     <span class=c1>// 페이지 내 슬롯 번호
</span></span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>계층 구조 시각화</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-95-1><a class=lnlinks href=#hl-95-1> 1</a>
</span><span class=lnt id=hl-95-2><a class=lnlinks href=#hl-95-2> 2</a>
</span><span class=lnt id=hl-95-3><a class=lnlinks href=#hl-95-3> 3</a>
</span><span class=lnt id=hl-95-4><a class=lnlinks href=#hl-95-4> 4</a>
</span><span class=lnt id=hl-95-5><a class=lnlinks href=#hl-95-5> 5</a>
</span><span class=lnt id=hl-95-6><a class=lnlinks href=#hl-95-6> 6</a>
</span><span class=lnt id=hl-95-7><a class=lnlinks href=#hl-95-7> 7</a>
</span><span class=lnt id=hl-95-8><a class=lnlinks href=#hl-95-8> 8</a>
</span><span class=lnt id=hl-95-9><a class=lnlinks href=#hl-95-9> 9</a>
</span><span class=lnt id=hl-95-10><a class=lnlinks href=#hl-95-10>10</a>
</span><span class=lnt id=hl-95-11><a class=lnlinks href=#hl-95-11>11</a>
</span><span class=lnt id=hl-95-12><a class=lnlinks href=#hl-95-12>12</a>
</span><span class=lnt id=hl-95-13><a class=lnlinks href=#hl-95-13>13</a>
</span><span class=lnt id=hl-95-14><a class=lnlinks href=#hl-95-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>B+ Tree 완전한 구조 (차수 t=3)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>레벨 0 (루트):
</span></span><span class=line><span class=cl>                    [50]
</span></span><span class=line><span class=cl>                   /    \
</span></span><span class=line><span class=cl>레벨 1 (내부):    [20,35]  [65,80]
</span></span><span class=line><span class=cl>                 /  |  \    /  |  \
</span></span><span class=line><span class=cl>레벨 2 (리프): [10] [25] [40] [55] [70] [90]
</span></span><span class=line><span class=cl>                ↔    ↔    ↔    ↔    ↔    ↔
</span></span><span class=line><span class=cl>               (양방향 연결 리스트)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>각 노드 저장:
</span></span><span class=line><span class=cl>- 내부: 키 + 자식 포인터
</span></span><span class=line><span class=cl>- 리프: 키 + 레코드 포인터 + 다음 리프 포인터
</span></span></code></pre></td></tr></table></div></div><p><strong>페이지 레이아웃</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-96-1><a class=lnlinks href=#hl-96-1> 1</a>
</span><span class=lnt id=hl-96-2><a class=lnlinks href=#hl-96-2> 2</a>
</span><span class=lnt id=hl-96-3><a class=lnlinks href=#hl-96-3> 3</a>
</span><span class=lnt id=hl-96-4><a class=lnlinks href=#hl-96-4> 4</a>
</span><span class=lnt id=hl-96-5><a class=lnlinks href=#hl-96-5> 5</a>
</span><span class=lnt id=hl-96-6><a class=lnlinks href=#hl-96-6> 6</a>
</span><span class=lnt id=hl-96-7><a class=lnlinks href=#hl-96-7> 7</a>
</span><span class=lnt id=hl-96-8><a class=lnlinks href=#hl-96-8> 8</a>
</span><span class=lnt id=hl-96-9><a class=lnlinks href=#hl-96-9> 9</a>
</span><span class=lnt id=hl-96-10><a class=lnlinks href=#hl-96-10>10</a>
</span><span class=lnt id=hl-96-11><a class=lnlinks href=#hl-96-11>11</a>
</span><span class=lnt id=hl-96-12><a class=lnlinks href=#hl-96-12>12</a>
</span><span class=lnt id=hl-96-13><a class=lnlinks href=#hl-96-13>13</a>
</span><span class=lnt id=hl-96-14><a class=lnlinks href=#hl-96-14>14</a>
</span><span class=lnt id=hl-96-15><a class=lnlinks href=#hl-96-15>15</a>
</span><span class=lnt id=hl-96-16><a class=lnlinks href=#hl-96-16>16</a>
</span><span class=lnt id=hl-96-17><a class=lnlinks href=#hl-96-17>17</a>
</span><span class=lnt id=hl-96-18><a class=lnlinks href=#hl-96-18>18</a>
</span><span class=lnt id=hl-96-19><a class=lnlinks href=#hl-96-19>19</a>
</span><span class=lnt id=hl-96-20><a class=lnlinks href=#hl-96-20>20</a>
</span><span class=lnt id=hl-96-21><a class=lnlinks href=#hl-96-21>21</a>
</span><span class=lnt id=hl-96-22><a class=lnlinks href=#hl-96-22>22</a>
</span><span class=lnt id=hl-96-23><a class=lnlinks href=#hl-96-23>23</a>
</span><span class=lnt id=hl-96-24><a class=lnlinks href=#hl-96-24>24</a>
</span><span class=lnt id=hl-96-25><a class=lnlinks href=#hl-96-25>25</a>
</span><span class=lnt id=hl-96-26><a class=lnlinks href=#hl-96-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>디스크 페이지 (4KB 예시)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>+------------------------+ ← 0x0000
</span></span><span class=line><span class=cl>| Page Header (96 bytes) |
</span></span><span class=line><span class=cl>|  - Page ID             |
</span></span><span class=line><span class=cl>|  - LSN (Log Sequence)  |
</span></span><span class=line><span class=cl>|  - Free Space Pointer  |
</span></span><span class=line><span class=cl>|  - Slot Count          |
</span></span><span class=line><span class=cl>+------------------------+ ← 0x0060
</span></span><span class=line><span class=cl>| Slot Directory         |
</span></span><span class=line><span class=cl>| [offset1][offset2]...  |
</span></span><span class=line><span class=cl>+------------------------+
</span></span><span class=line><span class=cl>|                        |
</span></span><span class=line><span class=cl>|    Free Space          |
</span></span><span class=line><span class=cl>|                        |
</span></span><span class=line><span class=cl>+------------------------+
</span></span><span class=line><span class=cl>| ... Index Entries ...  |
</span></span><span class=line><span class=cl>|  [key3][ptr3]          |
</span></span><span class=line><span class=cl>|  [key2][ptr2]          |
</span></span><span class=line><span class=cl>|  [key1][ptr1]          |
</span></span><span class=line><span class=cl>+------------------------+ ← 0x1000
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>장점:
</span></span><span class=line><span class=cl>- 슬롯 디렉토리로 가변 길이 엔트리 관리
</span></span><span class=line><span class=cl>- 단편화 시 페이지 내 재정리 가능
</span></span><span class=line><span class=cl>- 빠른 이진 탐색 지원
</span></span></code></pre></td></tr></table></div></div><p><strong>Hash Index 구조</strong></p><p><strong>물리적 구조</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-97-1><a class=lnlinks href=#hl-97-1> 1</a>
</span><span class=lnt id=hl-97-2><a class=lnlinks href=#hl-97-2> 2</a>
</span><span class=lnt id=hl-97-3><a class=lnlinks href=#hl-97-3> 3</a>
</span><span class=lnt id=hl-97-4><a class=lnlinks href=#hl-97-4> 4</a>
</span><span class=lnt id=hl-97-5><a class=lnlinks href=#hl-97-5> 5</a>
</span><span class=lnt id=hl-97-6><a class=lnlinks href=#hl-97-6> 6</a>
</span><span class=lnt id=hl-97-7><a class=lnlinks href=#hl-97-7> 7</a>
</span><span class=lnt id=hl-97-8><a class=lnlinks href=#hl-97-8> 8</a>
</span><span class=lnt id=hl-97-9><a class=lnlinks href=#hl-97-9> 9</a>
</span><span class=lnt id=hl-97-10><a class=lnlinks href=#hl-97-10>10</a>
</span><span class=lnt id=hl-97-11><a class=lnlinks href=#hl-97-11>11</a>
</span><span class=lnt id=hl-97-12><a class=lnlinks href=#hl-97-12>12</a>
</span><span class=lnt id=hl-97-13><a class=lnlinks href=#hl-97-13>13</a>
</span><span class=lnt id=hl-97-14><a class=lnlinks href=#hl-97-14>14</a>
</span><span class=lnt id=hl-97-15><a class=lnlinks href=#hl-97-15>15</a>
</span><span class=lnt id=hl-97-16><a class=lnlinks href=#hl-97-16>16</a>
</span><span class=lnt id=hl-97-17><a class=lnlinks href=#hl-97-17>17</a>
</span><span class=lnt id=hl-97-18><a class=lnlinks href=#hl-97-18>18</a>
</span><span class=lnt id=hl-97-19><a class=lnlinks href=#hl-97-19>19</a>
</span><span class=lnt id=hl-97-20><a class=lnlinks href=#hl-97-20>20</a>
</span><span class=lnt id=hl-97-21><a class=lnlinks href=#hl-97-21>21</a>
</span><span class=lnt id=hl-97-22><a class=lnlinks href=#hl-97-22>22</a>
</span><span class=lnt id=hl-97-23><a class=lnlinks href=#hl-97-23>23</a>
</span><span class=lnt id=hl-97-24><a class=lnlinks href=#hl-97-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Hash Index 구성
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Directory (메타데이터):
</span></span><span class=line><span class=cl>+------------------+
</span></span><span class=line><span class=cl>| Hash Function    | → hash(key) % bucket_count
</span></span><span class=line><span class=cl>| Bucket Count     | → 1024
</span></span><span class=line><span class=cl>| Global Depth     | → log₂(buckets)
</span></span><span class=line><span class=cl>| Load Factor      | → 0.75
</span></span><span class=line><span class=cl>+------------------+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Bucket Array:
</span></span><span class=line><span class=cl>+--------+--------+--------+--------+
</span></span><span class=line><span class=cl>| Ptr 0  | Ptr 1  | Ptr 2  | ... 1023|
</span></span><span class=line><span class=cl>+--------+--------+--------+--------+
</span></span><span class=line><span class=cl>   |        |        |
</span></span><span class=line><span class=cl>   v        v        v
</span></span><span class=line><span class=cl>Bucket 0  Bucket 1  Bucket 2
</span></span><span class=line><span class=cl>[k1,p1]   [k5,p5]   [k3,p3]
</span></span><span class=line><span class=cl>[k2,p2]   [k8,p8]   [k7,p7]
</span></span><span class=line><span class=cl>  ...       ...       ...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>확장 가능 해싱 (Extendible Hashing):
</span></span><span class=line><span class=cl>- 디렉토리 배가: 버킷 포화 시
</span></span><span class=line><span class=cl>- 버킷 분할: 충돌 많을 때
</span></span></code></pre></td></tr></table></div></div><p><strong>동적 확장 과정</strong>:</p><pre class=mermaid>graph TB
    A[버킷 포화 감지] --&gt; B{Global Depth&lt;br/&gt;증가 필요?}
    B --&gt;|Yes| C[디렉토리 배가]
    B --&gt;|No| D[버킷만 분할]
    
    C --&gt; E[새 버킷 할당]
    D --&gt; E
    
    E --&gt; F[엔트리 재분배]
    F --&gt; G[Local Depth 갱신]
    
    style A fill:#FFE4B5
    style G fill:#90EE90
</pre><p><strong>Bitmap Index 구조</strong></p><p><strong>비트맵 표현</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-99-1><a class=lnlinks href=#hl-99-1> 1</a>
</span><span class=lnt id=hl-99-2><a class=lnlinks href=#hl-99-2> 2</a>
</span><span class=lnt id=hl-99-3><a class=lnlinks href=#hl-99-3> 3</a>
</span><span class=lnt id=hl-99-4><a class=lnlinks href=#hl-99-4> 4</a>
</span><span class=lnt id=hl-99-5><a class=lnlinks href=#hl-99-5> 5</a>
</span><span class=lnt id=hl-99-6><a class=lnlinks href=#hl-99-6> 6</a>
</span><span class=lnt id=hl-99-7><a class=lnlinks href=#hl-99-7> 7</a>
</span><span class=lnt id=hl-99-8><a class=lnlinks href=#hl-99-8> 8</a>
</span><span class=lnt id=hl-99-9><a class=lnlinks href=#hl-99-9> 9</a>
</span><span class=lnt id=hl-99-10><a class=lnlinks href=#hl-99-10>10</a>
</span><span class=lnt id=hl-99-11><a class=lnlinks href=#hl-99-11>11</a>
</span><span class=lnt id=hl-99-12><a class=lnlinks href=#hl-99-12>12</a>
</span><span class=lnt id=hl-99-13><a class=lnlinks href=#hl-99-13>13</a>
</span><span class=lnt id=hl-99-14><a class=lnlinks href=#hl-99-14>14</a>
</span><span class=lnt id=hl-99-15><a class=lnlinks href=#hl-99-15>15</a>
</span><span class=lnt id=hl-99-16><a class=lnlinks href=#hl-99-16>16</a>
</span><span class=lnt id=hl-99-17><a class=lnlinks href=#hl-99-17>17</a>
</span><span class=lnt id=hl-99-18><a class=lnlinks href=#hl-99-18>18</a>
</span><span class=lnt id=hl-99-19><a class=lnlinks href=#hl-99-19>19</a>
</span><span class=lnt id=hl-99-20><a class=lnlinks href=#hl-99-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>테이블 데이터:
</span></span><span class=line><span class=cl>Row_ID | Gender | Country
</span></span><span class=line><span class=cl>-------|--------|----------
</span></span><span class=line><span class=cl>1      | M      | USA
</span></span><span class=line><span class=cl>2      | F      | UK
</span></span><span class=line><span class=cl>3      | M      | USA
</span></span><span class=line><span class=cl>4      | F      | USA
</span></span><span class=line><span class=cl>5      | M      | UK
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Bitmap Index on Gender:
</span></span><span class=line><span class=cl>M: 10101
</span></span><span class=line><span class=cl>F: 01010
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Bitmap Index on Country:
</span></span><span class=line><span class=cl>USA: 10110
</span></span><span class=line><span class=cl>UK:  01001
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>쿼리: WHERE Gender=&#39;M&#39; AND Country=&#39;USA&#39;
</span></span><span class=line><span class=cl>결과: 10101 AND 10110 = 10100
</span></span><span class=line><span class=cl>      → Row 1, 3
</span></span></code></pre></td></tr></table></div></div><p><strong>압축 기법</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-100-1><a class=lnlinks href=#hl-100-1> 1</a>
</span><span class=lnt id=hl-100-2><a class=lnlinks href=#hl-100-2> 2</a>
</span><span class=lnt id=hl-100-3><a class=lnlinks href=#hl-100-3> 3</a>
</span><span class=lnt id=hl-100-4><a class=lnlinks href=#hl-100-4> 4</a>
</span><span class=lnt id=hl-100-5><a class=lnlinks href=#hl-100-5> 5</a>
</span><span class=lnt id=hl-100-6><a class=lnlinks href=#hl-100-6> 6</a>
</span><span class=lnt id=hl-100-7><a class=lnlinks href=#hl-100-7> 7</a>
</span><span class=lnt id=hl-100-8><a class=lnlinks href=#hl-100-8> 8</a>
</span><span class=lnt id=hl-100-9><a class=lnlinks href=#hl-100-9> 9</a>
</span><span class=lnt id=hl-100-10><a class=lnlinks href=#hl-100-10>10</a>
</span><span class=lnt id=hl-100-11><a class=lnlinks href=#hl-100-11>11</a>
</span><span class=lnt id=hl-100-12><a class=lnlinks href=#hl-100-12>12</a>
</span><span class=lnt id=hl-100-13><a class=lnlinks href=#hl-100-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Run-Length Encoding (RLE):
</span></span><span class=line><span class=cl>원본: 00000001110000011
</span></span><span class=line><span class=cl>압축: (7,0)(3,1)(6,0)(2,1)
</span></span><span class=line><span class=cl>     = 7개 0, 3개 1, 6개 0, 2개 1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Word-Aligned Hybrid (WAH):
</span></span><span class=line><span class=cl>31-bit 워드 단위로 압축
</span></span><span class=line><span class=cl>- Literal word: 실제 비트 31개
</span></span><span class=line><span class=cl>- Fill word: 같은 비트 반복 횟수
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>장점:
</span></span><span class=line><span class=cl>- 압축 상태에서 비트 연산 가능
</span></span><span class=line><span class=cl>- 메모리 효율 10-100배 향상
</span></span></code></pre></td></tr></table></div></div><p><strong>Full-Text Index 구조 (역색인)</strong></p><p><strong>역색인 구조</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-101-1><a class=lnlinks href=#hl-101-1> 1</a>
</span><span class=lnt id=hl-101-2><a class=lnlinks href=#hl-101-2> 2</a>
</span><span class=lnt id=hl-101-3><a class=lnlinks href=#hl-101-3> 3</a>
</span><span class=lnt id=hl-101-4><a class=lnlinks href=#hl-101-4> 4</a>
</span><span class=lnt id=hl-101-5><a class=lnlinks href=#hl-101-5> 5</a>
</span><span class=lnt id=hl-101-6><a class=lnlinks href=#hl-101-6> 6</a>
</span><span class=lnt id=hl-101-7><a class=lnlinks href=#hl-101-7> 7</a>
</span><span class=lnt id=hl-101-8><a class=lnlinks href=#hl-101-8> 8</a>
</span><span class=lnt id=hl-101-9><a class=lnlinks href=#hl-101-9> 9</a>
</span><span class=lnt id=hl-101-10><a class=lnlinks href=#hl-101-10>10</a>
</span><span class=lnt id=hl-101-11><a class=lnlinks href=#hl-101-11>11</a>
</span><span class=lnt id=hl-101-12><a class=lnlinks href=#hl-101-12>12</a>
</span><span class=lnt id=hl-101-13><a class=lnlinks href=#hl-101-13>13</a>
</span><span class=lnt id=hl-101-14><a class=lnlinks href=#hl-101-14>14</a>
</span><span class=lnt id=hl-101-15><a class=lnlinks href=#hl-101-15>15</a>
</span><span class=lnt id=hl-101-16><a class=lnlinks href=#hl-101-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>문서 집합:
</span></span><span class=line><span class=cl>Doc1: &#34;database indexing performance&#34;
</span></span><span class=line><span class=cl>Doc2: &#34;indexing techniques and optimization&#34;
</span></span><span class=line><span class=cl>Doc3: &#34;database performance tuning&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>역색인 (Inverted Index):
</span></span><span class=line><span class=cl>Term       | Posting List
</span></span><span class=line><span class=cl>-----------|---------------------------
</span></span><span class=line><span class=cl>database   | [Doc1:0, Doc3:0]
</span></span><span class=line><span class=cl>indexing   | [Doc1:1, Doc2:0]
</span></span><span class=line><span class=cl>performance| [Doc1:2, Doc3:1]
</span></span><span class=line><span class=cl>techniques | [Doc2:1]
</span></span><span class=line><span class=cl>optimization| [Doc2:3]
</span></span><span class=line><span class=cl>tuning     | [Doc3:2]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Posting: (문서ID, 위치, 빈도, 필드 등)
</span></span></code></pre></td></tr></table></div></div><p><strong>구조 상세</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-102-1><a class=lnlinks href=#hl-102-1> 1</a>
</span><span class=lnt id=hl-102-2><a class=lnlinks href=#hl-102-2> 2</a>
</span><span class=lnt id=hl-102-3><a class=lnlinks href=#hl-102-3> 3</a>
</span><span class=lnt id=hl-102-4><a class=lnlinks href=#hl-102-4> 4</a>
</span><span class=lnt id=hl-102-5><a class=lnlinks href=#hl-102-5> 5</a>
</span><span class=lnt id=hl-102-6><a class=lnlinks href=#hl-102-6> 6</a>
</span><span class=lnt id=hl-102-7><a class=lnlinks href=#hl-102-7> 7</a>
</span><span class=lnt id=hl-102-8><a class=lnlinks href=#hl-102-8> 8</a>
</span><span class=lnt id=hl-102-9><a class=lnlinks href=#hl-102-9> 9</a>
</span><span class=lnt id=hl-102-10><a class=lnlinks href=#hl-102-10>10</a>
</span><span class=lnt id=hl-102-11><a class=lnlinks href=#hl-102-11>11</a>
</span><span class=lnt id=hl-102-12><a class=lnlinks href=#hl-102-12>12</a>
</span><span class=lnt id=hl-102-13><a class=lnlinks href=#hl-102-13>13</a>
</span><span class=lnt id=hl-102-14><a class=lnlinks href=#hl-102-14>14</a>
</span><span class=lnt id=hl-102-15><a class=lnlinks href=#hl-102-15>15</a>
</span><span class=lnt id=hl-102-16><a class=lnlinks href=#hl-102-16>16</a>
</span><span class=lnt id=hl-102-17><a class=lnlinks href=#hl-102-17>17</a>
</span><span class=lnt id=hl-102-18><a class=lnlinks href=#hl-102-18>18</a>
</span><span class=lnt id=hl-102-19><a class=lnlinks href=#hl-102-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Dictionary (용어 사전):
</span></span><span class=line><span class=cl>+--------+----------+-------------+
</span></span><span class=line><span class=cl>| Term   | Doc Freq | Pointer     |
</span></span><span class=line><span class=cl>+--------+----------+-------------+
</span></span><span class=line><span class=cl>| &#34;data&#34; | 1250     | → Posting   |
</span></span><span class=line><span class=cl>| &#34;index&#34;| 830      | → Posting   |
</span></span><span class=line><span class=cl>+--------+----------+-------------+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Posting List (문서 목록):
</span></span><span class=line><span class=cl>Term &#34;index&#34;:
</span></span><span class=line><span class=cl>[DocID:100, Freq:2, Pos:[5,47]]
</span></span><span class=line><span class=cl>[DocID:203, Freq:1, Pos:[12]]
</span></span><span class=line><span class=cl>[DocID:457, Freq:3, Pos:[2,15,89]]
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Skip List 최적화:
</span></span><span class=line><span class=cl>Level 2: [100] ----------------&gt; [500]
</span></span><span class=line><span class=cl>Level 1: [100] -----&gt; [300] ----&gt; [500]
</span></span><span class=line><span class=cl>Level 0: [100]→[203]→[300]→[457]→[500]
</span></span></code></pre></td></tr></table></div></div><p><strong>Columnstore Index 구조</strong></p><p><strong>행 저장 vs 컬럼 저장</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-103-1><a class=lnlinks href=#hl-103-1> 1</a>
</span><span class=lnt id=hl-103-2><a class=lnlinks href=#hl-103-2> 2</a>
</span><span class=lnt id=hl-103-3><a class=lnlinks href=#hl-103-3> 3</a>
</span><span class=lnt id=hl-103-4><a class=lnlinks href=#hl-103-4> 4</a>
</span><span class=lnt id=hl-103-5><a class=lnlinks href=#hl-103-5> 5</a>
</span><span class=lnt id=hl-103-6><a class=lnlinks href=#hl-103-6> 6</a>
</span><span class=lnt id=hl-103-7><a class=lnlinks href=#hl-103-7> 7</a>
</span><span class=lnt id=hl-103-8><a class=lnlinks href=#hl-103-8> 8</a>
</span><span class=lnt id=hl-103-9><a class=lnlinks href=#hl-103-9> 9</a>
</span><span class=lnt id=hl-103-10><a class=lnlinks href=#hl-103-10>10</a>
</span><span class=lnt id=hl-103-11><a class=lnlinks href=#hl-103-11>11</a>
</span><span class=lnt id=hl-103-12><a class=lnlinks href=#hl-103-12>12</a>
</span><span class=lnt id=hl-103-13><a class=lnlinks href=#hl-103-13>13</a>
</span><span class=lnt id=hl-103-14><a class=lnlinks href=#hl-103-14>14</a>
</span><span class=lnt id=hl-103-15><a class=lnlinks href=#hl-103-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>행 저장 (Row-Store):
</span></span><span class=line><span class=cl>페이지 1: [ID=1,Name=&#39;Alice&#39;,Age=30,City=&#39;NYC&#39;]
</span></span><span class=line><span class=cl>페이지 1: [ID=2,Name=&#39;Bob&#39;,Age=25,City=&#39;LA&#39;]
</span></span><span class=line><span class=cl>페이지 2: [ID=3,Name=&#39;Charlie&#39;,Age=35,City=&#39;NYC&#39;]
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>컬럼 저장 (Column-Store):
</span></span><span class=line><span class=cl>ID 세그먼트:    [1,2,3,4,5,...]
</span></span><span class=line><span class=cl>Name 세그먼트:  [&#39;Alice&#39;,&#39;Bob&#39;,&#39;Charlie&#39;,...]
</span></span><span class=line><span class=cl>Age 세그먼트:   [30,25,35,...]
</span></span><span class=line><span class=cl>City 세그먼트:  [&#39;NYC&#39;,&#39;LA&#39;,&#39;NYC&#39;,...]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>쿼리: SELECT AVG(Age) FROM users;
</span></span><span class=line><span class=cl>행 저장: 모든 페이지 읽기
</span></span><span class=line><span class=cl>컬럼 저장: Age 세그먼트만 읽기
</span></span></code></pre></td></tr></table></div></div><p><strong>압축 및 인코딩</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-104-1><a class=lnlinks href=#hl-104-1> 1</a>
</span><span class=lnt id=hl-104-2><a class=lnlinks href=#hl-104-2> 2</a>
</span><span class=lnt id=hl-104-3><a class=lnlinks href=#hl-104-3> 3</a>
</span><span class=lnt id=hl-104-4><a class=lnlinks href=#hl-104-4> 4</a>
</span><span class=lnt id=hl-104-5><a class=lnlinks href=#hl-104-5> 5</a>
</span><span class=lnt id=hl-104-6><a class=lnlinks href=#hl-104-6> 6</a>
</span><span class=lnt id=hl-104-7><a class=lnlinks href=#hl-104-7> 7</a>
</span><span class=lnt id=hl-104-8><a class=lnlinks href=#hl-104-8> 8</a>
</span><span class=lnt id=hl-104-9><a class=lnlinks href=#hl-104-9> 9</a>
</span><span class=lnt id=hl-104-10><a class=lnlinks href=#hl-104-10>10</a>
</span><span class=lnt id=hl-104-11><a class=lnlinks href=#hl-104-11>11</a>
</span><span class=lnt id=hl-104-12><a class=lnlinks href=#hl-104-12>12</a>
</span><span class=lnt id=hl-104-13><a class=lnlinks href=#hl-104-13>13</a>
</span><span class=lnt id=hl-104-14><a class=lnlinks href=#hl-104-14>14</a>
</span><span class=lnt id=hl-104-15><a class=lnlinks href=#hl-104-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Dictionary Encoding:
</span></span><span class=line><span class=cl>City: [&#39;NYC&#39;, &#39;LA&#39;, &#39;SF&#39;, &#39;NYC&#39;, &#39;LA&#39;, &#39;NYC&#39;]
</span></span><span class=line><span class=cl>Dictionary: {0:&#39;NYC&#39;, 1:&#39;LA&#39;, 2:&#39;SF&#39;}
</span></span><span class=line><span class=cl>Encoded: [0, 1, 2, 0, 1, 0]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Run-Length Encoding:
</span></span><span class=line><span class=cl>Status: [&#39;active&#39;,&#39;active&#39;,&#39;active&#39;,&#39;inactive&#39;,&#39;inactive&#39;]
</span></span><span class=line><span class=cl>RLE: [(active,3), (inactive,2)]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Bit Packing:
</span></span><span class=line><span class=cl>Age: [30, 25, 35, 28, 32]
</span></span><span class=line><span class=cl>→ 6비트로 충분 (max=35 &lt; 2^6)
</span></span><span class=line><span class=cl>원본: 32비트 × 5 = 160비트
</span></span><span class=line><span class=cl>압축: 6비트 × 5 = 30비트
</span></span><span class=line><span class=cl>압축률: 81%
</span></span></code></pre></td></tr></table></div></div><p><strong>세그먼트 구조</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-105-1><a class=lnlinks href=#hl-105-1> 1</a>
</span><span class=lnt id=hl-105-2><a class=lnlinks href=#hl-105-2> 2</a>
</span><span class=lnt id=hl-105-3><a class=lnlinks href=#hl-105-3> 3</a>
</span><span class=lnt id=hl-105-4><a class=lnlinks href=#hl-105-4> 4</a>
</span><span class=lnt id=hl-105-5><a class=lnlinks href=#hl-105-5> 5</a>
</span><span class=lnt id=hl-105-6><a class=lnlinks href=#hl-105-6> 6</a>
</span><span class=lnt id=hl-105-7><a class=lnlinks href=#hl-105-7> 7</a>
</span><span class=lnt id=hl-105-8><a class=lnlinks href=#hl-105-8> 8</a>
</span><span class=lnt id=hl-105-9><a class=lnlinks href=#hl-105-9> 9</a>
</span><span class=lnt id=hl-105-10><a class=lnlinks href=#hl-105-10>10</a>
</span><span class=lnt id=hl-105-11><a class=lnlinks href=#hl-105-11>11</a>
</span><span class=lnt id=hl-105-12><a class=lnlinks href=#hl-105-12>12</a>
</span><span class=lnt id=hl-105-13><a class=lnlinks href=#hl-105-13>13</a>
</span><span class=lnt id=hl-105-14><a class=lnlinks href=#hl-105-14>14</a>
</span><span class=lnt id=hl-105-15><a class=lnlinks href=#hl-105-15>15</a>
</span><span class=lnt id=hl-105-16><a class=lnlinks href=#hl-105-16>16</a>
</span><span class=lnt id=hl-105-17><a class=lnlinks href=#hl-105-17>17</a>
</span><span class=lnt id=hl-105-18><a class=lnlinks href=#hl-105-18>18</a>
</span><span class=lnt id=hl-105-19><a class=lnlinks href=#hl-105-19>19</a>
</span><span class=lnt id=hl-105-20><a class=lnlinks href=#hl-105-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Columnstore Segment (1백만 행 단위)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>+------------------------+
</span></span><span class=line><span class=cl>| Segment Header         |
</span></span><span class=line><span class=cl>|  - Encoding Type       |
</span></span><span class=line><span class=cl>|  - Min/Max Values      |
</span></span><span class=line><span class=cl>|  - Dictionary Pointer  |
</span></span><span class=line><span class=cl>+------------------------+
</span></span><span class=line><span class=cl>| Dictionary (if needed) |
</span></span><span class=line><span class=cl>|  - Unique Values       |
</span></span><span class=line><span class=cl>|  - Frequency           |
</span></span><span class=line><span class=cl>+------------------------+
</span></span><span class=line><span class=cl>| Encoded Data           |
</span></span><span class=line><span class=cl>|  - Compressed Values   |
</span></span><span class=line><span class=cl>|  - Null Bitmap         |
</span></span><span class=line><span class=cl>+------------------------+
</span></span><span class=line><span class=cl>| Segment Footer         |
</span></span><span class=line><span class=cl>|  - Checksum            |
</span></span><span class=line><span class=cl>|  - Row Count           |
</span></span><span class=line><span class=cl>+------------------------+
</span></span></code></pre></td></tr></table></div></div><h4 id=25-수학적-증명-및-정리-a형-특화>2.5 수학적 증명 및 정리 (A형 특화)<a hidden class=anchor aria-hidden=true href=#25-수학적-증명-및-정리-a형-특화>#</a></h4><p><strong>정리 5: B-Tree 삽입 시간 복잡도</strong></p><p><strong>정리</strong>: n개의 키를 가진 차수 t인 B-Tree에 새로운 키를 삽입하는 시간 복잡도는 O(t · log_t n)이다.</p><p><strong>증명</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-106-1><a class=lnlinks href=#hl-106-1> 1</a>
</span><span class=lnt id=hl-106-2><a class=lnlinks href=#hl-106-2> 2</a>
</span><span class=lnt id=hl-106-3><a class=lnlinks href=#hl-106-3> 3</a>
</span><span class=lnt id=hl-106-4><a class=lnlinks href=#hl-106-4> 4</a>
</span><span class=lnt id=hl-106-5><a class=lnlinks href=#hl-106-5> 5</a>
</span><span class=lnt id=hl-106-6><a class=lnlinks href=#hl-106-6> 6</a>
</span><span class=lnt id=hl-106-7><a class=lnlinks href=#hl-106-7> 7</a>
</span><span class=lnt id=hl-106-8><a class=lnlinks href=#hl-106-8> 8</a>
</span><span class=lnt id=hl-106-9><a class=lnlinks href=#hl-106-9> 9</a>
</span><span class=lnt id=hl-106-10><a class=lnlinks href=#hl-106-10>10</a>
</span><span class=lnt id=hl-106-11><a class=lnlinks href=#hl-106-11>11</a>
</span><span class=lnt id=hl-106-12><a class=lnlinks href=#hl-106-12>12</a>
</span><span class=lnt id=hl-106-13><a class=lnlinks href=#hl-106-13>13</a>
</span><span class=lnt id=hl-106-14><a class=lnlinks href=#hl-106-14>14</a>
</span><span class=lnt id=hl-106-15><a class=lnlinks href=#hl-106-15>15</a>
</span><span class=lnt id=hl-106-16><a class=lnlinks href=#hl-106-16>16</a>
</span><span class=lnt id=hl-106-17><a class=lnlinks href=#hl-106-17>17</a>
</span><span class=lnt id=hl-106-18><a class=lnlinks href=#hl-106-18>18</a>
</span><span class=lnt id=hl-106-19><a class=lnlinks href=#hl-106-19>19</a>
</span><span class=lnt id=hl-106-20><a class=lnlinks href=#hl-106-20>20</a>
</span><span class=lnt id=hl-106-21><a class=lnlinks href=#hl-106-21>21</a>
</span><span class=lnt id=hl-106-22><a class=lnlinks href=#hl-106-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 탐색 단계:
</span></span><span class=line><span class=cl>   - 루트부터 리프까지 탐색
</span></span><span class=line><span class=cl>   - 트리 높이: h = O(log_t n)
</span></span><span class=line><span class=cl>   - 각 노드에서 키 비교: O(log t) (이진 탐색)
</span></span><span class=line><span class=cl>   - 또는 O(t) (선형 탐색)
</span></span><span class=line><span class=cl>   - 탐색 시간: O(h · log t) = O(log_t n · log t) = O(log n)
</span></span><span class=line><span class=cl>              또는 O(h · t) = O(t · log_t n)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 분할 단계:
</span></span><span class=line><span class=cl>   - 최악의 경우: 루트까지 모든 노드 분할
</span></span><span class=line><span class=cl>   - 분할 횟수: O(h) = O(log_t n)
</span></span><span class=line><span class=cl>   - 각 분할: O(t) (키 재배치)
</span></span><span class=line><span class=cl>   - 분할 시간: O(t · log_t n)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 총 시간:
</span></span><span class=line><span class=cl>   T(n) = O(log n) + O(t · log_t n)
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   t가 상수이므로:
</span></span><span class=line><span class=cl>   T(n) = O(log n) 또는
</span></span><span class=line><span class=cl>   T(n) = O(t · log_t n) = O(log n / log t · t) = O(log n)
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>∴ 삽입 시간 복잡도 = O(log n)  ∎
</span></span></code></pre></td></tr></table></div></div><p><strong>정리 6: B-Tree 삭제 시간 복잡도</strong></p><p><strong>정리</strong>: B-Tree에서 키 삭제는 O(t · log_t n) 시간에 수행된다.</p><p><strong>증명</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-107-1><a class=lnlinks href=#hl-107-1> 1</a>
</span><span class=lnt id=hl-107-2><a class=lnlinks href=#hl-107-2> 2</a>
</span><span class=lnt id=hl-107-3><a class=lnlinks href=#hl-107-3> 3</a>
</span><span class=lnt id=hl-107-4><a class=lnlinks href=#hl-107-4> 4</a>
</span><span class=lnt id=hl-107-5><a class=lnlinks href=#hl-107-5> 5</a>
</span><span class=lnt id=hl-107-6><a class=lnlinks href=#hl-107-6> 6</a>
</span><span class=lnt id=hl-107-7><a class=lnlinks href=#hl-107-7> 7</a>
</span><span class=lnt id=hl-107-8><a class=lnlinks href=#hl-107-8> 8</a>
</span><span class=lnt id=hl-107-9><a class=lnlinks href=#hl-107-9> 9</a>
</span><span class=lnt id=hl-107-10><a class=lnlinks href=#hl-107-10>10</a>
</span><span class=lnt id=hl-107-11><a class=lnlinks href=#hl-107-11>11</a>
</span><span class=lnt id=hl-107-12><a class=lnlinks href=#hl-107-12>12</a>
</span><span class=lnt id=hl-107-13><a class=lnlinks href=#hl-107-13>13</a>
</span><span class=lnt id=hl-107-14><a class=lnlinks href=#hl-107-14>14</a>
</span><span class=lnt id=hl-107-15><a class=lnlinks href=#hl-107-15>15</a>
</span><span class=lnt id=hl-107-16><a class=lnlinks href=#hl-107-16>16</a>
</span><span class=lnt id=hl-107-17><a class=lnlinks href=#hl-107-17>17</a>
</span><span class=lnt id=hl-107-18><a class=lnlinks href=#hl-107-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 키 탐색: O(t · log_t n) (정리 5와 동일)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 삭제 후 재조정:
</span></span><span class=line><span class=cl>   케이스 1: 리프에서 단순 삭제 - O(t)
</span></span><span class=line><span class=cl>   케이스 2: 내부 노드에서 삭제
</span></span><span class=line><span class=cl>     - 선행자/후행자 찾기: O(h) = O(log_t n)
</span></span><span class=line><span class=cl>     - 대체 및 재귀 삭제: T(n)
</span></span><span class=line><span class=cl>   케이스 3: 언더플로우 처리
</span></span><span class=line><span class=cl>     - 형제에서 차용: O(t)
</span></span><span class=line><span class=cl>     - 병합: O(t)
</span></span><span class=line><span class=cl>     - 상향 전파: O(h) = O(log_t n)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 최악의 경우 분석:
</span></span><span class=line><span class=cl>   - 루트까지 병합 전파: O(h) = O(log_t n)번
</span></span><span class=line><span class=cl>   - 각 병합: O(t)
</span></span><span class=line><span class=cl>   - 총: O(t · log_t n)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>∴ 삭제 시간 복잡도 = O(t · log_t n) = O(log n)  ∎
</span></span></code></pre></td></tr></table></div></div><p><strong>정리 7: Hash Index 공간-시간 트레이드오프</strong></p><p><strong>정리</strong>: 부하율 α = n/m인 해시 인덱스에서:</p><ul><li>탐색 성공: 평균 1 + α/2 비교</li><li>탐색 실패: 평균 α 비교
(체이닝 충돌 해결 가정)</li></ul><p><strong>증명</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-108-1><a class=lnlinks href=#hl-108-1> 1</a>
</span><span class=lnt id=hl-108-2><a class=lnlinks href=#hl-108-2> 2</a>
</span><span class=lnt id=hl-108-3><a class=lnlinks href=#hl-108-3> 3</a>
</span><span class=lnt id=hl-108-4><a class=lnlinks href=#hl-108-4> 4</a>
</span><span class=lnt id=hl-108-5><a class=lnlinks href=#hl-108-5> 5</a>
</span><span class=lnt id=hl-108-6><a class=lnlinks href=#hl-108-6> 6</a>
</span><span class=lnt id=hl-108-7><a class=lnlinks href=#hl-108-7> 7</a>
</span><span class=lnt id=hl-108-8><a class=lnlinks href=#hl-108-8> 8</a>
</span><span class=lnt id=hl-108-9><a class=lnlinks href=#hl-108-9> 9</a>
</span><span class=lnt id=hl-108-10><a class=lnlinks href=#hl-108-10>10</a>
</span><span class=lnt id=hl-108-11><a class=lnlinks href=#hl-108-11>11</a>
</span><span class=lnt id=hl-108-12><a class=lnlinks href=#hl-108-12>12</a>
</span><span class=lnt id=hl-108-13><a class=lnlinks href=#hl-108-13>13</a>
</span><span class=lnt id=hl-108-14><a class=lnlinks href=#hl-108-14>14</a>
</span><span class=lnt id=hl-108-15><a class=lnlinks href=#hl-108-15>15</a>
</span><span class=lnt id=hl-108-16><a class=lnlinks href=#hl-108-16>16</a>
</span><span class=lnt id=hl-108-17><a class=lnlinks href=#hl-108-17>17</a>
</span><span class=lnt id=hl-108-18><a class=lnlinks href=#hl-108-18>18</a>
</span><span class=lnt id=hl-108-19><a class=lnlinks href=#hl-108-19>19</a>
</span><span class=lnt id=hl-108-20><a class=lnlinks href=#hl-108-20>20</a>
</span><span class=lnt id=hl-108-21><a class=lnlinks href=#hl-108-21>21</a>
</span><span class=lnt id=hl-108-22><a class=lnlinks href=#hl-108-22>22</a>
</span><span class=lnt id=hl-108-23><a class=lnlinks href=#hl-108-23>23</a>
</span><span class=lnt id=hl-108-24><a class=lnlinks href=#hl-108-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 가정:
</span></span><span class=line><span class=cl>   - n개 키, m개 버킷
</span></span><span class=line><span class=cl>   - 균등 해시 함수: P(h(k)=i) = 1/m
</span></span><span class=line><span class=cl>   - 체이닝으로 충돌 해결
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 탐색 성공:
</span></span><span class=line><span class=cl>   키 k가 버킷 i의 j번째 위치에 있을 확률:
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   E[성공 비교] = 1 + E[체인 길이의 절반]
</span></span><span class=line><span class=cl>                = 1 + (α-1)/2
</span></span><span class=line><span class=cl>                = 1 + α/2 - 1/2
</span></span><span class=line><span class=cl>                ≈ 1 + α/2  (n이 클 때)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 탐색 실패:
</span></span><span class=line><span class=cl>   버킷 i의 평균 체인 길이: n/m = α
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   E[실패 비교] = α
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4. 공간-시간 관계:
</span></span><span class=line><span class=cl>   - α ≤ 0.75: 거의 O(1) 시간, 공간 효율 낮음
</span></span><span class=line><span class=cl>   - α ≈ 1: O(1) 시간, 적절한 공간
</span></span><span class=line><span class=cl>   - α &gt; 1: 시간 증가, 공간 효율 높음
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>∴ 최적 부하율: α ≈ 0.75-1.0  ∎
</span></span></code></pre></td></tr></table></div></div><p><strong>정리 8: Bitmap Index AND 연산 복잡도</strong></p><p><strong>정리</strong>: 각 w비트 워드로 압축된 n개 행, k개 비트맵의 AND 연산은 O(n·k/w) 시간이다.</p><p><strong>증명</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-109-1><a class=lnlinks href=#hl-109-1> 1</a>
</span><span class=lnt id=hl-109-2><a class=lnlinks href=#hl-109-2> 2</a>
</span><span class=lnt id=hl-109-3><a class=lnlinks href=#hl-109-3> 3</a>
</span><span class=lnt id=hl-109-4><a class=lnlinks href=#hl-109-4> 4</a>
</span><span class=lnt id=hl-109-5><a class=lnlinks href=#hl-109-5> 5</a>
</span><span class=lnt id=hl-109-6><a class=lnlinks href=#hl-109-6> 6</a>
</span><span class=lnt id=hl-109-7><a class=lnlinks href=#hl-109-7> 7</a>
</span><span class=lnt id=hl-109-8><a class=lnlinks href=#hl-109-8> 8</a>
</span><span class=lnt id=hl-109-9><a class=lnlinks href=#hl-109-9> 9</a>
</span><span class=lnt id=hl-109-10><a class=lnlinks href=#hl-109-10>10</a>
</span><span class=lnt id=hl-109-11><a class=lnlinks href=#hl-109-11>11</a>
</span><span class=lnt id=hl-109-12><a class=lnlinks href=#hl-109-12>12</a>
</span><span class=lnt id=hl-109-13><a class=lnlinks href=#hl-109-13>13</a>
</span><span class=lnt id=hl-109-14><a class=lnlinks href=#hl-109-14>14</a>
</span><span class=lnt id=hl-109-15><a class=lnlinks href=#hl-109-15>15</a>
</span><span class=lnt id=hl-109-16><a class=lnlinks href=#hl-109-16>16</a>
</span><span class=lnt id=hl-109-17><a class=lnlinks href=#hl-109-17>17</a>
</span><span class=lnt id=hl-109-18><a class=lnlinks href=#hl-109-18>18</a>
</span><span class=lnt id=hl-109-19><a class=lnlinks href=#hl-109-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 비압축 비트맵:
</span></span><span class=line><span class=cl>   - 각 비트맵: n비트
</span></span><span class=line><span class=cl>   - k개 비트맵 AND: k-1회 연산
</span></span><span class=line><span class=cl>   - 각 AND: n번 비트 연산
</span></span><span class=line><span class=cl>   - 총: O(n·k)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 워드 단위 압축 (WAH):
</span></span><span class=line><span class=cl>   - n비트를 n/w개 워드로 압축
</span></span><span class=line><span class=cl>   - 워드 단위 AND: O(1)
</span></span><span class=line><span class=cl>   - k개 비트맵: O(k) 워드당
</span></span><span class=line><span class=cl>   - 총 워드 수: O(n/w)
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   T(n,k,w) = O((n/w)·k) = O(n·k/w)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 최적화:
</span></span><span class=line><span class=cl>   w = 32 또는 64 (CPU 워드 크기)
</span></span><span class=line><span class=cl>   → 32-64배 가속
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>∴ 워드 단위 비트맵 AND = O(n·k/w)  ∎
</span></span></code></pre></td></tr></table></div></div><p><strong>정리 9: 커버링 인덱스 I/O 절감</strong></p><p><strong>정리</strong>: 커버링 인덱스는 쿼리당 평균 I/O를 O(log n + k)에서 O(log n)으로 감소시킨다. (k는 결과 행 수)</p><p><strong>증명</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-110-1><a class=lnlinks href=#hl-110-1> 1</a>
</span><span class=lnt id=hl-110-2><a class=lnlinks href=#hl-110-2> 2</a>
</span><span class=lnt id=hl-110-3><a class=lnlinks href=#hl-110-3> 3</a>
</span><span class=lnt id=hl-110-4><a class=lnlinks href=#hl-110-4> 4</a>
</span><span class=lnt id=hl-110-5><a class=lnlinks href=#hl-110-5> 5</a>
</span><span class=lnt id=hl-110-6><a class=lnlinks href=#hl-110-6> 6</a>
</span><span class=lnt id=hl-110-7><a class=lnlinks href=#hl-110-7> 7</a>
</span><span class=lnt id=hl-110-8><a class=lnlinks href=#hl-110-8> 8</a>
</span><span class=lnt id=hl-110-9><a class=lnlinks href=#hl-110-9> 9</a>
</span><span class=lnt id=hl-110-10><a class=lnlinks href=#hl-110-10>10</a>
</span><span class=lnt id=hl-110-11><a class=lnlinks href=#hl-110-11>11</a>
</span><span class=lnt id=hl-110-12><a class=lnlinks href=#hl-110-12>12</a>
</span><span class=lnt id=hl-110-13><a class=lnlinks href=#hl-110-13>13</a>
</span><span class=lnt id=hl-110-14><a class=lnlinks href=#hl-110-14>14</a>
</span><span class=lnt id=hl-110-15><a class=lnlinks href=#hl-110-15>15</a>
</span><span class=lnt id=hl-110-16><a class=lnlinks href=#hl-110-16>16</a>
</span><span class=lnt id=hl-110-17><a class=lnlinks href=#hl-110-17>17</a>
</span><span class=lnt id=hl-110-18><a class=lnlinks href=#hl-110-18>18</a>
</span><span class=lnt id=hl-110-19><a class=lnlinks href=#hl-110-19>19</a>
</span><span class=lnt id=hl-110-20><a class=lnlinks href=#hl-110-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 일반 인덱스:
</span></span><span class=line><span class=cl>   - 인덱스 탐색: O(log n) I/O
</span></span><span class=line><span class=cl>   - 각 결과마다 데이터 페이지 접근: k I/O
</span></span><span class=line><span class=cl>   - 총: O(log n + k)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 커버링 인덱스:
</span></span><span class=line><span class=cl>   - 쿼리의 모든 컬럼이 인덱스에 포함
</span></span><span class=line><span class=cl>   - 인덱스 탐색: O(log n) I/O
</span></span><span class=line><span class=cl>   - 데이터 페이지 접근 불필요: 0 I/O
</span></span><span class=line><span class=cl>   - 총: O(log n)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. I/O 절감:
</span></span><span class=line><span class=cl>   Savings = k I/O
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   예: k=1000, log n=4
</span></span><span class=line><span class=cl>   일반: 1004 I/O
</span></span><span class=line><span class=cl>   커버링: 4 I/O
</span></span><span class=line><span class=cl>   절감: 99.6%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>∴ 커버링 인덱스 = O(log n) I/O  ∎
</span></span></code></pre></td></tr></table></div></div><p><strong>정리 10: 멀티 컬럼 인덱스 선택도</strong></p><p><strong>정리</strong>: 독립적인 컬럼 A(선택도 s_A), B(선택도 s_B)의 복합 인덱스 선택도는 s_A × s_B이다.</p><p><strong>증명</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-111-1><a class=lnlinks href=#hl-111-1> 1</a>
</span><span class=lnt id=hl-111-2><a class=lnlinks href=#hl-111-2> 2</a>
</span><span class=lnt id=hl-111-3><a class=lnlinks href=#hl-111-3> 3</a>
</span><span class=lnt id=hl-111-4><a class=lnlinks href=#hl-111-4> 4</a>
</span><span class=lnt id=hl-111-5><a class=lnlinks href=#hl-111-5> 5</a>
</span><span class=lnt id=hl-111-6><a class=lnlinks href=#hl-111-6> 6</a>
</span><span class=lnt id=hl-111-7><a class=lnlinks href=#hl-111-7> 7</a>
</span><span class=lnt id=hl-111-8><a class=lnlinks href=#hl-111-8> 8</a>
</span><span class=lnt id=hl-111-9><a class=lnlinks href=#hl-111-9> 9</a>
</span><span class=lnt id=hl-111-10><a class=lnlinks href=#hl-111-10>10</a>
</span><span class=lnt id=hl-111-11><a class=lnlinks href=#hl-111-11>11</a>
</span><span class=lnt id=hl-111-12><a class=lnlinks href=#hl-111-12>12</a>
</span><span class=lnt id=hl-111-13><a class=lnlinks href=#hl-111-13>13</a>
</span><span class=lnt id=hl-111-14><a class=lnlinks href=#hl-111-14>14</a>
</span><span class=lnt id=hl-111-15><a class=lnlinks href=#hl-111-15>15</a>
</span><span class=lnt id=hl-111-16><a class=lnlinks href=#hl-111-16>16</a>
</span><span class=lnt id=hl-111-17><a class=lnlinks href=#hl-111-17>17</a>
</span><span class=lnt id=hl-111-18><a class=lnlinks href=#hl-111-18>18</a>
</span><span class=lnt id=hl-111-19><a class=lnlinks href=#hl-111-19>19</a>
</span><span class=lnt id=hl-111-20><a class=lnlinks href=#hl-111-20>20</a>
</span><span class=lnt id=hl-111-21><a class=lnlinks href=#hl-111-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 정의:
</span></span><span class=line><span class=cl>   선택도 s_A = |σ_A=a(R)| / |R|
</span></span><span class=line><span class=cl>   (컬럼 A=a 조건을 만족하는 비율)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 독립 사건:
</span></span><span class=line><span class=cl>   P(A=a ∧ B=b) = P(A=a) × P(B=b)
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>3. 복합 인덱스 선택도:
</span></span><span class=line><span class=cl>   s_{A,B} = |σ_{A=a ∧ B=b}(R)| / |R|
</span></span><span class=line><span class=cl>          = |R| × P(A=a ∧ B=b) / |R|
</span></span><span class=line><span class=cl>          = P(A=a) × P(B=b)
</span></span><span class=line><span class=cl>          = s_A × s_B
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4. 예시:
</span></span><span class=line><span class=cl>   - 성별 선택도: 0.5
</span></span><span class=line><span class=cl>   - 국가 선택도: 0.01
</span></span><span class=line><span class=cl>   - 복합 선택도: 0.5 × 0.01 = 0.005
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   1억 건 테이블: 50만 건 → 5,000건
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>∴ 복합 인덱스 선택도 = ∏s_i  ∎
</span></span></code></pre></td></tr></table></div></div><p><strong>정리 11: 인덱스 캐시 적중률과 성능</strong></p><p><strong>정리</strong>: 인덱스 캐시 적중률 h일 때, 평균 접근 시간은:
T_avg = h × T_mem + (1-h) × T_disk</p><p><strong>증명</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-112-1><a class=lnlinks href=#hl-112-1> 1</a>
</span><span class=lnt id=hl-112-2><a class=lnlinks href=#hl-112-2> 2</a>
</span><span class=lnt id=hl-112-3><a class=lnlinks href=#hl-112-3> 3</a>
</span><span class=lnt id=hl-112-4><a class=lnlinks href=#hl-112-4> 4</a>
</span><span class=lnt id=hl-112-5><a class=lnlinks href=#hl-112-5> 5</a>
</span><span class=lnt id=hl-112-6><a class=lnlinks href=#hl-112-6> 6</a>
</span><span class=lnt id=hl-112-7><a class=lnlinks href=#hl-112-7> 7</a>
</span><span class=lnt id=hl-112-8><a class=lnlinks href=#hl-112-8> 8</a>
</span><span class=lnt id=hl-112-9><a class=lnlinks href=#hl-112-9> 9</a>
</span><span class=lnt id=hl-112-10><a class=lnlinks href=#hl-112-10>10</a>
</span><span class=lnt id=hl-112-11><a class=lnlinks href=#hl-112-11>11</a>
</span><span class=lnt id=hl-112-12><a class=lnlinks href=#hl-112-12>12</a>
</span><span class=lnt id=hl-112-13><a class=lnlinks href=#hl-112-13>13</a>
</span><span class=lnt id=hl-112-14><a class=lnlinks href=#hl-112-14>14</a>
</span><span class=lnt id=hl-112-15><a class=lnlinks href=#hl-112-15>15</a>
</span><span class=lnt id=hl-112-16><a class=lnlinks href=#hl-112-16>16</a>
</span><span class=lnt id=hl-112-17><a class=lnlinks href=#hl-112-17>17</a>
</span><span class=lnt id=hl-112-18><a class=lnlinks href=#hl-112-18>18</a>
</span><span class=lnt id=hl-112-19><a class=lnlinks href=#hl-112-19>19</a>
</span><span class=lnt id=hl-112-20><a class=lnlinks href=#hl-112-20>20</a>
</span><span class=lnt id=hl-112-21><a class=lnlinks href=#hl-112-21>21</a>
</span><span class=lnt id=hl-112-22><a class=lnlinks href=#hl-112-22>22</a>
</span><span class=lnt id=hl-112-23><a class=lnlinks href=#hl-112-23>23</a>
</span><span class=lnt id=hl-112-24><a class=lnlinks href=#hl-112-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 정의:
</span></span><span class=line><span class=cl>   - T_mem: 메모리 접근 시간 (~100ns)
</span></span><span class=line><span class=cl>   - T_disk: 디스크 접근 시간 (~10ms)
</span></span><span class=line><span class=cl>   - h: 캐시 적중률 (0 ≤ h ≤ 1)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 평균 접근 시간:
</span></span><span class=line><span class=cl>   T_avg = P(hit) × T_mem + P(miss) × T_disk
</span></span><span class=line><span class=cl>        = h × T_mem + (1-h) × T_disk
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 수치 예시:
</span></span><span class=line><span class=cl>   T_mem = 100ns = 0.0001ms
</span></span><span class=line><span class=cl>   T_disk = 10ms
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   h=0:    T_avg = 10ms
</span></span><span class=line><span class=cl>   h=0.5:  T_avg = 0.00005 + 5 = 5ms
</span></span><span class=line><span class=cl>   h=0.9:  T_avg = 0.00009 + 1 = 1ms
</span></span><span class=line><span class=cl>   h=0.99: T_avg = 0.000099 + 0.1 = 0.1ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4. 성능 영향:
</span></span><span class=line><span class=cl>   ΔT/Δh = -T_disk + T_mem ≈ -T_disk
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   적중률 1% 증가 → 100ms 감소 (1000건 쿼리 시)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>∴ 캐시 적중률은 성능에 선형적 영향  ∎
</span></span></code></pre></td></tr></table></div></div><h4 id=26-고급-이론적-배경-심화>2.6 고급 이론적 배경 (심화)<a hidden class=anchor aria-hidden=true href=#26-고급-이론적-배경-심화>#</a></h4><p><strong>동시성 이론: 인덱스 래칭</strong></p><p><strong>B-link Tree (Lehman & Yao, 1981)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-113-1><a class=lnlinks href=#hl-113-1> 1</a>
</span><span class=lnt id=hl-113-2><a class=lnlinks href=#hl-113-2> 2</a>
</span><span class=lnt id=hl-113-3><a class=lnlinks href=#hl-113-3> 3</a>
</span><span class=lnt id=hl-113-4><a class=lnlinks href=#hl-113-4> 4</a>
</span><span class=lnt id=hl-113-5><a class=lnlinks href=#hl-113-5> 5</a>
</span><span class=lnt id=hl-113-6><a class=lnlinks href=#hl-113-6> 6</a>
</span><span class=lnt id=hl-113-7><a class=lnlinks href=#hl-113-7> 7</a>
</span><span class=lnt id=hl-113-8><a class=lnlinks href=#hl-113-8> 8</a>
</span><span class=lnt id=hl-113-9><a class=lnlinks href=#hl-113-9> 9</a>
</span><span class=lnt id=hl-113-10><a class=lnlinks href=#hl-113-10>10</a>
</span><span class=lnt id=hl-113-11><a class=lnlinks href=#hl-113-11>11</a>
</span><span class=lnt id=hl-113-12><a class=lnlinks href=#hl-113-12>12</a>
</span><span class=lnt id=hl-113-13><a class=lnlinks href=#hl-113-13>13</a>
</span><span class=lnt id=hl-113-14><a class=lnlinks href=#hl-113-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>문제: B-Tree의 동시성 제어
</span></span><span class=line><span class=cl>- 기존 방법: 루트부터 리프까지 락 보유
</span></span><span class=line><span class=cl>- 문제점: 동시성 저하, 데드락 위험
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>해결: B-link Tree
</span></span><span class=line><span class=cl>- 각 노드에 right-link 추가
</span></span><span class=line><span class=cl>- 래치를 짧게 보유 (crabbing)
</span></span><span class=line><span class=cl>- 구조 변경 중에도 읽기 가능
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>알고리즘:
</span></span><span class=line><span class=cl>1. 탐색 중 노드 N 접근
</span></span><span class=line><span class=cl>2. 목표 키 k &gt; N.max_key?
</span></span><span class=line><span class=cl>   → right-link 따라 이동
</span></span><span class=line><span class=cl>3. 래치 해제하고 다음 노드로
</span></span></code></pre></td></tr></table></div></div><p><strong>래치 커플링 (Latch Coupling)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-114-1><a class=lnlinks href=#hl-114-1> 1</a>
</span><span class=lnt id=hl-114-2><a class=lnlinks href=#hl-114-2> 2</a>
</span><span class=lnt id=hl-114-3><a class=lnlinks href=#hl-114-3> 3</a>
</span><span class=lnt id=hl-114-4><a class=lnlinks href=#hl-114-4> 4</a>
</span><span class=lnt id=hl-114-5><a class=lnlinks href=#hl-114-5> 5</a>
</span><span class=lnt id=hl-114-6><a class=lnlinks href=#hl-114-6> 6</a>
</span><span class=lnt id=hl-114-7><a class=lnlinks href=#hl-114-7> 7</a>
</span><span class=lnt id=hl-114-8><a class=lnlinks href=#hl-114-8> 8</a>
</span><span class=lnt id=hl-114-9><a class=lnlinks href=#hl-114-9> 9</a>
</span><span class=lnt id=hl-114-10><a class=lnlinks href=#hl-114-10>10</a>
</span><span class=lnt id=hl-114-11><a class=lnlinks href=#hl-114-11>11</a>
</span><span class=lnt id=hl-114-12><a class=lnlinks href=#hl-114-12>12</a>
</span><span class=lnt id=hl-114-13><a class=lnlinks href=#hl-114-13>13</a>
</span><span class=lnt id=hl-114-14><a class=lnlinks href=#hl-114-14>14</a>
</span><span class=lnt id=hl-114-15><a class=lnlinks href=#hl-114-15>15</a>
</span><span class=lnt id=hl-114-16><a class=lnlinks href=#hl-114-16>16</a>
</span><span class=lnt id=hl-114-17><a class=lnlinks href=#hl-114-17>17</a>
</span><span class=lnt id=hl-114-18><a class=lnlinks href=#hl-114-18>18</a>
</span><span class=lnt id=hl-114-19><a class=lnlinks href=#hl-114-19>19</a>
</span><span class=lnt id=hl-114-20><a class=lnlinks href=#hl-114-20>20</a>
</span><span class=lnt id=hl-114-21><a class=lnlinks href=#hl-114-21>21</a>
</span><span class=lnt id=hl-114-22><a class=lnlinks href=#hl-114-22>22</a>
</span><span class=lnt id=hl-114-23><a class=lnlinks href=#hl-114-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>btree_search_concurrent</span><span class=p>(</span><span class=n>root</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;동시성을 고려한 B-Tree 검색&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>current</span> <span class=o>=</span> <span class=n>root</span>
</span></span><span class=line><span class=cl>    <span class=n>current</span><span class=o>.</span><span class=n>latch_shared</span><span class=p>()</span>  <span class=c1># S-latch</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=ow>not</span> <span class=n>current</span><span class=o>.</span><span class=n>is_leaf</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=c1># 목표 키 위치 찾기</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=n>find_child_index</span><span class=p>(</span><span class=n>current</span><span class=p>,</span> <span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>next_node</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>children</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 다음 노드 래치 획득</span>
</span></span><span class=line><span class=cl>        <span class=n>next_node</span><span class=o>.</span><span class=n>latch_shared</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 현재 노드 래치 해제 (커플링)</span>
</span></span><span class=line><span class=cl>        <span class=n>current</span><span class=o>.</span><span class=n>unlatch</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>current</span> <span class=o>=</span> <span class=n>next_node</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 리프 노드에서 검색</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>current</span><span class=o>.</span><span class=n>search_key</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>current</span><span class=o>.</span><span class=n>unlatch</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>MVCC와 인덱스</strong></p><p><strong>버전 관리 전략</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-115-1><a class=lnlinks href=#hl-115-1> 1</a>
</span><span class=lnt id=hl-115-2><a class=lnlinks href=#hl-115-2> 2</a>
</span><span class=lnt id=hl-115-3><a class=lnlinks href=#hl-115-3> 3</a>
</span><span class=lnt id=hl-115-4><a class=lnlinks href=#hl-115-4> 4</a>
</span><span class=lnt id=hl-115-5><a class=lnlinks href=#hl-115-5> 5</a>
</span><span class=lnt id=hl-115-6><a class=lnlinks href=#hl-115-6> 6</a>
</span><span class=lnt id=hl-115-7><a class=lnlinks href=#hl-115-7> 7</a>
</span><span class=lnt id=hl-115-8><a class=lnlinks href=#hl-115-8> 8</a>
</span><span class=lnt id=hl-115-9><a class=lnlinks href=#hl-115-9> 9</a>
</span><span class=lnt id=hl-115-10><a class=lnlinks href=#hl-115-10>10</a>
</span><span class=lnt id=hl-115-11><a class=lnlinks href=#hl-115-11>11</a>
</span><span class=lnt id=hl-115-12><a class=lnlinks href=#hl-115-12>12</a>
</span><span class=lnt id=hl-115-13><a class=lnlinks href=#hl-115-13>13</a>
</span><span class=lnt id=hl-115-14><a class=lnlinks href=#hl-115-14>14</a>
</span><span class=lnt id=hl-115-15><a class=lnlinks href=#hl-115-15>15</a>
</span><span class=lnt id=hl-115-16><a class=lnlinks href=#hl-115-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>PostgreSQL 방식:
</span></span><span class=line><span class=cl>- 인덱스는 모든 버전 가리킴
</span></span><span class=line><span class=cl>- Heap Tuple에 버전 정보 저장
</span></span><span class=line><span class=cl>- Visibility Check로 올바른 버전 선택
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>문제: 죽은 튜플 누적
</span></span><span class=line><span class=cl>해결: Vacuum 프로세스
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Oracle 방식:
</span></span><span class=line><span class=cl>- Undo 세그먼트로 이전 버전 관리
</span></span><span class=line><span class=cl>- 인덱스는 최신 버전만 가리킴
</span></span><span class=line><span class=cl>- 읽기 일관성을 위해 Undo 조회
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>장단점:
</span></span><span class=line><span class=cl>PostgreSQL: 읽기 빠름, Vacuum 오버헤드
</span></span><span class=line><span class=cl>Oracle: 쓰기 빠름, Undo 공간 필요
</span></span></code></pre></td></tr></table></div></div><p><strong>정보 이론적 분석</strong></p><p><strong>엔트로피와 인덱스 효율성</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-116-1><a class=lnlinks href=#hl-116-1> 1</a>
</span><span class=lnt id=hl-116-2><a class=lnlinks href=#hl-116-2> 2</a>
</span><span class=lnt id=hl-116-3><a class=lnlinks href=#hl-116-3> 3</a>
</span><span class=lnt id=hl-116-4><a class=lnlinks href=#hl-116-4> 4</a>
</span><span class=lnt id=hl-116-5><a class=lnlinks href=#hl-116-5> 5</a>
</span><span class=lnt id=hl-116-6><a class=lnlinks href=#hl-116-6> 6</a>
</span><span class=lnt id=hl-116-7><a class=lnlinks href=#hl-116-7> 7</a>
</span><span class=lnt id=hl-116-8><a class=lnlinks href=#hl-116-8> 8</a>
</span><span class=lnt id=hl-116-9><a class=lnlinks href=#hl-116-9> 9</a>
</span><span class=lnt id=hl-116-10><a class=lnlinks href=#hl-116-10>10</a>
</span><span class=lnt id=hl-116-11><a class=lnlinks href=#hl-116-11>11</a>
</span><span class=lnt id=hl-116-12><a class=lnlinks href=#hl-116-12>12</a>
</span><span class=lnt id=hl-116-13><a class=lnlinks href=#hl-116-13>13</a>
</span><span class=lnt id=hl-116-14><a class=lnlinks href=#hl-116-14>14</a>
</span><span class=lnt id=hl-116-15><a class=lnlinks href=#hl-116-15>15</a>
</span><span class=lnt id=hl-116-16><a class=lnlinks href=#hl-116-16>16</a>
</span><span class=lnt id=hl-116-17><a class=lnlinks href=#hl-116-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Shannon 엔트로피:
</span></span><span class=line><span class=cl>H(X) = -Σ p_i log₂ p_i
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>인덱스 선택도와 엔트로피:
</span></span><span class=line><span class=cl>- 균등 분포 (최대 엔트로피): H = log₂ n
</span></span><span class=line><span class=cl>  → 인덱스 효과 최대
</span></span><span class=line><span class=cl>- 편향 분포 (낮은 엔트로피): H &lt; log₂ n
</span></span><span class=line><span class=cl>  → 인덱스 효과 감소
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>예시:
</span></span><span class=line><span class=cl>100만 행, 성별 컬럼 (50:50):
</span></span><span class=line><span class=cl>H(gender) = -0.5log₂(0.5) - 0.5log₂(0.5) = 1 bit
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>100만 행, 주민등록번호 (거의 균등):
</span></span><span class=line><span class=cl>H(ssn) ≈ log₂(1,000,000) ≈ 20 bits
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>결론: 엔트로피가 높을수록 인덱스 효과 큼
</span></span></code></pre></td></tr></table></div></div><p><strong>압축 이론과 인덱스</strong></p><p><strong>Kolmogorov 복잡도</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-117-1><a class=lnlinks href=#hl-117-1> 1</a>
</span><span class=lnt id=hl-117-2><a class=lnlinks href=#hl-117-2> 2</a>
</span><span class=lnt id=hl-117-3><a class=lnlinks href=#hl-117-3> 3</a>
</span><span class=lnt id=hl-117-4><a class=lnlinks href=#hl-117-4> 4</a>
</span><span class=lnt id=hl-117-5><a class=lnlinks href=#hl-117-5> 5</a>
</span><span class=lnt id=hl-117-6><a class=lnlinks href=#hl-117-6> 6</a>
</span><span class=lnt id=hl-117-7><a class=lnlinks href=#hl-117-7> 7</a>
</span><span class=lnt id=hl-117-8><a class=lnlinks href=#hl-117-8> 8</a>
</span><span class=lnt id=hl-117-9><a class=lnlinks href=#hl-117-9> 9</a>
</span><span class=lnt id=hl-117-10><a class=lnlinks href=#hl-117-10>10</a>
</span><span class=lnt id=hl-117-11><a class=lnlinks href=#hl-117-11>11</a>
</span><span class=lnt id=hl-117-12><a class=lnlinks href=#hl-117-12>12</a>
</span><span class=lnt id=hl-117-13><a class=lnlinks href=#hl-117-13>13</a>
</span><span class=lnt id=hl-117-14><a class=lnlinks href=#hl-117-14>14</a>
</span><span class=lnt id=hl-117-15><a class=lnlinks href=#hl-117-15>15</a>
</span><span class=lnt id=hl-117-16><a class=lnlinks href=#hl-117-16>16</a>
</span><span class=lnt id=hl-117-17><a class=lnlinks href=#hl-117-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>정의: 문자열 s를 생성하는 최단 프로그램 길이 K(s)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>인덱스 압축 한계:
</span></span><span class=line><span class=cl>- 무손실 압축: |compressed| ≥ H(data)
</span></span><span class=line><span class=cl>- H: Shannon 엔트로피
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>실제 압축률:
</span></span><span class=line><span class=cl>1. Dictionary Encoding
</span></span><span class=line><span class=cl>   압축률 = log₂|unique| / log₂|domain|
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>2. Run-Length Encoding
</span></span><span class=line><span class=cl>   압축률 = (run_count × 2 × log₂|domain|) / (n × log₂|domain|)
</span></span><span class=line><span class=cl>             = 2 × run_count / n
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>3. Bitmap Compression (WAH)
</span></span><span class=line><span class=cl>   압축률 ≈ (1 - sparsity) × 32
</span></span><span class=line><span class=cl>   (sparsity: 희소성)
</span></span></code></pre></td></tr></table></div></div><p><strong>분산 시스템 이론</strong></p><p><strong>CAP 정리와 인덱스</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-118-1><a class=lnlinks href=#hl-118-1> 1</a>
</span><span class=lnt id=hl-118-2><a class=lnlinks href=#hl-118-2> 2</a>
</span><span class=lnt id=hl-118-3><a class=lnlinks href=#hl-118-3> 3</a>
</span><span class=lnt id=hl-118-4><a class=lnlinks href=#hl-118-4> 4</a>
</span><span class=lnt id=hl-118-5><a class=lnlinks href=#hl-118-5> 5</a>
</span><span class=lnt id=hl-118-6><a class=lnlinks href=#hl-118-6> 6</a>
</span><span class=lnt id=hl-118-7><a class=lnlinks href=#hl-118-7> 7</a>
</span><span class=lnt id=hl-118-8><a class=lnlinks href=#hl-118-8> 8</a>
</span><span class=lnt id=hl-118-9><a class=lnlinks href=#hl-118-9> 9</a>
</span><span class=lnt id=hl-118-10><a class=lnlinks href=#hl-118-10>10</a>
</span><span class=lnt id=hl-118-11><a class=lnlinks href=#hl-118-11>11</a>
</span><span class=lnt id=hl-118-12><a class=lnlinks href=#hl-118-12>12</a>
</span><span class=lnt id=hl-118-13><a class=lnlinks href=#hl-118-13>13</a>
</span><span class=lnt id=hl-118-14><a class=lnlinks href=#hl-118-14>14</a>
</span><span class=lnt id=hl-118-15><a class=lnlinks href=#hl-118-15>15</a>
</span><span class=lnt id=hl-118-16><a class=lnlinks href=#hl-118-16>16</a>
</span><span class=lnt id=hl-118-17><a class=lnlinks href=#hl-118-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>CAP Theorem (Brewer, 2000):
</span></span><span class=line><span class=cl>- Consistency: 일관성
</span></span><span class=line><span class=cl>- Availability: 가용성
</span></span><span class=line><span class=cl>- Partition Tolerance: 분할 내성
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>분산 인덱스 선택:
</span></span><span class=line><span class=cl>├─ CP 시스템 (일관성 + 분할 내성)
</span></span><span class=line><span class=cl>│   └─ 예: HBase, MongoDB
</span></span><span class=line><span class=cl>│   └─ 강한 일관성, 일시적 불가용
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>└─ AP 시스템 (가용성 + 분할 내성)
</span></span><span class=line><span class=cl>    └─ 예: Cassandra, Riak
</span></span><span class=line><span class=cl>    └─ 최종 일관성, 항상 가용
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>인덱스 영향:
</span></span><span class=line><span class=cl>- CP: 글로벌 인덱스, 분산 트랜잭션
</span></span><span class=line><span class=cl>- AP: 로컬 인덱스, 최종 일관성
</span></span></code></pre></td></tr></table></div></div><p><strong>Raft/Paxos와 인덱스 복제</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-119-1><a class=lnlinks href=#hl-119-1> 1</a>
</span><span class=lnt id=hl-119-2><a class=lnlinks href=#hl-119-2> 2</a>
</span><span class=lnt id=hl-119-3><a class=lnlinks href=#hl-119-3> 3</a>
</span><span class=lnt id=hl-119-4><a class=lnlinks href=#hl-119-4> 4</a>
</span><span class=lnt id=hl-119-5><a class=lnlinks href=#hl-119-5> 5</a>
</span><span class=lnt id=hl-119-6><a class=lnlinks href=#hl-119-6> 6</a>
</span><span class=lnt id=hl-119-7><a class=lnlinks href=#hl-119-7> 7</a>
</span><span class=lnt id=hl-119-8><a class=lnlinks href=#hl-119-8> 8</a>
</span><span class=lnt id=hl-119-9><a class=lnlinks href=#hl-119-9> 9</a>
</span><span class=lnt id=hl-119-10><a class=lnlinks href=#hl-119-10>10</a>
</span><span class=lnt id=hl-119-11><a class=lnlinks href=#hl-119-11>11</a>
</span><span class=lnt id=hl-119-12><a class=lnlinks href=#hl-119-12>12</a>
</span><span class=lnt id=hl-119-13><a class=lnlinks href=#hl-119-13>13</a>
</span><span class=lnt id=hl-119-14><a class=lnlinks href=#hl-119-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>합의 알고리즘 적용:
</span></span><span class=line><span class=cl>1. 인덱스 변경 = 로그 엔트리
</span></span><span class=line><span class=cl>2. 리더가 팔로워에 복제
</span></span><span class=line><span class=cl>3. 과반수 확인 후 커밋
</span></span><span class=line><span class=cl>4. 상태 머신에 적용
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>장점:
</span></span><span class=line><span class=cl>- 강한 일관성 보장
</span></span><span class=line><span class=cl>- 자동 장애 복구
</span></span><span class=line><span class=cl>- 분할 뇌 방지
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>단점:
</span></span><span class=line><span class=cl>- 지연 시간 증가 (RTT)
</span></span><span class=line><span class=cl>- 복잡한 구현
</span></span></code></pre></td></tr></table></div></div><h4 id=27-다른-시스템과의-상호작용-메커니즘-심화>2.7 다른 시스템과의 상호작용 메커니즘 (심화)<a hidden class=anchor aria-hidden=true href=#27-다른-시스템과의-상호작용-메커니즘-심화>#</a></h4><p><strong>쿼리 옵티마이저와의 상호작용</strong></p><p><strong>통계 정보 수집</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-120-1><a class=lnlinks href=#hl-120-1> 1</a>
</span><span class=lnt id=hl-120-2><a class=lnlinks href=#hl-120-2> 2</a>
</span><span class=lnt id=hl-120-3><a class=lnlinks href=#hl-120-3> 3</a>
</span><span class=lnt id=hl-120-4><a class=lnlinks href=#hl-120-4> 4</a>
</span><span class=lnt id=hl-120-5><a class=lnlinks href=#hl-120-5> 5</a>
</span><span class=lnt id=hl-120-6><a class=lnlinks href=#hl-120-6> 6</a>
</span><span class=lnt id=hl-120-7><a class=lnlinks href=#hl-120-7> 7</a>
</span><span class=lnt id=hl-120-8><a class=lnlinks href=#hl-120-8> 8</a>
</span><span class=lnt id=hl-120-9><a class=lnlinks href=#hl-120-9> 9</a>
</span><span class=lnt id=hl-120-10><a class=lnlinks href=#hl-120-10>10</a>
</span><span class=lnt id=hl-120-11><a class=lnlinks href=#hl-120-11>11</a>
</span><span class=lnt id=hl-120-12><a class=lnlinks href=#hl-120-12>12</a>
</span><span class=lnt id=hl-120-13><a class=lnlinks href=#hl-120-13>13</a>
</span><span class=lnt id=hl-120-14><a class=lnlinks href=#hl-120-14>14</a>
</span><span class=lnt id=hl-120-15><a class=lnlinks href=#hl-120-15>15</a>
</span><span class=lnt id=hl-120-16><a class=lnlinks href=#hl-120-16>16</a>
</span><span class=lnt id=hl-120-17><a class=lnlinks href=#hl-120-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 인덱스 통계 갱신 (PostgreSQL)
</span></span></span><span class=line><span class=cl><span class=k>ANALYZE</span><span class=w> </span><span class=k>table_name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 수집되는 정보:
</span></span></span><span class=line><span class=cl><span class=mi>1</span><span class=p>.</span><span class=w> </span><span class=err>테이블</span><span class=w> </span><span class=err>크기</span><span class=w> </span><span class=p>(</span><span class=err>행</span><span class=w> </span><span class=err>수</span><span class=p>,</span><span class=w> </span><span class=err>페이지</span><span class=w> </span><span class=err>수</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=mi>2</span><span class=p>.</span><span class=w> </span><span class=err>인덱스</span><span class=w> </span><span class=err>크기</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=mi>3</span><span class=p>.</span><span class=w> </span><span class=err>컬럼</span><span class=w> </span><span class=err>히스토그램</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=o>-</span><span class=w> </span><span class=err>값의</span><span class=w> </span><span class=err>분포</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=o>-</span><span class=w> </span><span class=err>최소</span><span class=o>/</span><span class=err>최대</span><span class=w> </span><span class=err>값</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=o>-</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=err>비율</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=mi>4</span><span class=p>.</span><span class=w> </span><span class=err>상관관계</span><span class=w> </span><span class=p>(</span><span class=n>correlation</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=o>-</span><span class=w> </span><span class=err>물리적</span><span class=w> </span><span class=err>순서와</span><span class=w> </span><span class=err>논리적</span><span class=w> </span><span class=err>순서의</span><span class=w> </span><span class=err>일치도</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=o>-</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=w> </span><span class=p>(</span><span class=err>역순</span><span class=p>)</span><span class=w> </span><span class=o>~</span><span class=w> </span><span class=o>+</span><span class=mi>1</span><span class=w> </span><span class=p>(</span><span class=err>정순</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=err>상관관계</span><span class=w> </span><span class=err>예</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=n>correlation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>95</span><span class=w> </span><span class=err>→</span><span class=w> </span><span class=err>거의</span><span class=w> </span><span class=err>정렬됨</span><span class=w> </span><span class=err>→</span><span class=w> </span><span class=err>순차</span><span class=w> </span><span class=n>I</span><span class=o>/</span><span class=n>O</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=n>correlation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>1</span><span class=w>  </span><span class=err>→</span><span class=w> </span><span class=err>무작위</span><span class=w> </span><span class=err>→</span><span class=w> </span><span class=err>랜덤</span><span class=w> </span><span class=n>I</span><span class=o>/</span><span class=n>O</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>비용 모델</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-121-1><a class=lnlinks href=#hl-121-1> 1</a>
</span><span class=lnt id=hl-121-2><a class=lnlinks href=#hl-121-2> 2</a>
</span><span class=lnt id=hl-121-3><a class=lnlinks href=#hl-121-3> 3</a>
</span><span class=lnt id=hl-121-4><a class=lnlinks href=#hl-121-4> 4</a>
</span><span class=lnt id=hl-121-5><a class=lnlinks href=#hl-121-5> 5</a>
</span><span class=lnt id=hl-121-6><a class=lnlinks href=#hl-121-6> 6</a>
</span><span class=lnt id=hl-121-7><a class=lnlinks href=#hl-121-7> 7</a>
</span><span class=lnt id=hl-121-8><a class=lnlinks href=#hl-121-8> 8</a>
</span><span class=lnt id=hl-121-9><a class=lnlinks href=#hl-121-9> 9</a>
</span><span class=lnt id=hl-121-10><a class=lnlinks href=#hl-121-10>10</a>
</span><span class=lnt id=hl-121-11><a class=lnlinks href=#hl-121-11>11</a>
</span><span class=lnt id=hl-121-12><a class=lnlinks href=#hl-121-12>12</a>
</span><span class=lnt id=hl-121-13><a class=lnlinks href=#hl-121-13>13</a>
</span><span class=lnt id=hl-121-14><a class=lnlinks href=#hl-121-14>14</a>
</span><span class=lnt id=hl-121-15><a class=lnlinks href=#hl-121-15>15</a>
</span><span class=lnt id=hl-121-16><a class=lnlinks href=#hl-121-16>16</a>
</span><span class=lnt id=hl-121-17><a class=lnlinks href=#hl-121-17>17</a>
</span><span class=lnt id=hl-121-18><a class=lnlinks href=#hl-121-18>18</a>
</span><span class=lnt id=hl-121-19><a class=lnlinks href=#hl-121-19>19</a>
</span><span class=lnt id=hl-121-20><a class=lnlinks href=#hl-121-20>20</a>
</span><span class=lnt id=hl-121-21><a class=lnlinks href=#hl-121-21>21</a>
</span><span class=lnt id=hl-121-22><a class=lnlinks href=#hl-121-22>22</a>
</span><span class=lnt id=hl-121-23><a class=lnlinks href=#hl-121-23>23</a>
</span><span class=lnt id=hl-121-24><a class=lnlinks href=#hl-121-24>24</a>
</span><span class=lnt id=hl-121-25><a class=lnlinks href=#hl-121-25>25</a>
</span><span class=lnt id=hl-121-26><a class=lnlinks href=#hl-121-26>26</a>
</span><span class=lnt id=hl-121-27><a class=lnlinks href=#hl-121-27>27</a>
</span><span class=lnt id=hl-121-28><a class=lnlinks href=#hl-121-28>28</a>
</span><span class=lnt id=hl-121-29><a class=lnlinks href=#hl-121-29>29</a>
</span><span class=lnt id=hl-121-30><a class=lnlinks href=#hl-121-30>30</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>estimate_index_scan_cost</span><span class=p>(</span><span class=n>index</span><span class=p>,</span> <span class=n>query</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;인덱스 스캔 비용 추정&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 1. 인덱스 탐색 비용</span>
</span></span><span class=line><span class=cl>    <span class=n>index_depth</span> <span class=o>=</span> <span class=n>math</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=n>index</span><span class=o>.</span><span class=n>row_count</span><span class=p>,</span> <span class=n>index</span><span class=o>.</span><span class=n>fanout</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>index_seek_cost</span> <span class=o>=</span> <span class=n>index_depth</span> <span class=o>*</span> <span class=n>RANDOM_PAGE_COST</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 2. 선택도 계산</span>
</span></span><span class=line><span class=cl>    <span class=n>selectivity</span> <span class=o>=</span> <span class=n>estimate_selectivity</span><span class=p>(</span><span class=n>query</span><span class=o>.</span><span class=n>predicates</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>result_rows</span> <span class=o>=</span> <span class=n>index</span><span class=o>.</span><span class=n>row_count</span> <span class=o>*</span> <span class=n>selectivity</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 3. 인덱스 스캔 비용</span>
</span></span><span class=line><span class=cl>    <span class=n>index_scan_cost</span> <span class=o>=</span> <span class=n>result_rows</span> <span class=o>*</span> <span class=n>INDEX_TUPLE_COST</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 4. 테이블 접근 비용</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>is_covering_index</span><span class=p>(</span><span class=n>index</span><span class=p>,</span> <span class=n>query</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 상관관계에 따라 순차/랜덤 I/O</span>
</span></span><span class=line><span class=cl>        <span class=n>correlation</span> <span class=o>=</span> <span class=n>index</span><span class=o>.</span><span class=n>get_correlation</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>abs</span><span class=p>(</span><span class=n>correlation</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mf>0.9</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>table_cost</span> <span class=o>=</span> <span class=n>result_rows</span> <span class=o>*</span> <span class=n>SEQUENTIAL_PAGE_COST</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>table_cost</span> <span class=o>=</span> <span class=n>result_rows</span> <span class=o>*</span> <span class=n>RANDOM_PAGE_COST</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>table_cost</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>total_cost</span> <span class=o>=</span> <span class=n>index_seek_cost</span> <span class=o>+</span> <span class=n>index_scan_cost</span> <span class=o>+</span> <span class=n>table_cost</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>total_cost</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>estimate_full_scan_cost</span><span class=p>(</span><span class=n>table</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;전체 테이블 스캔 비용&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>table</span><span class=o>.</span><span class=n>page_count</span> <span class=o>*</span> <span class=n>SEQUENTIAL_PAGE_COST</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>옵티마이저 의사결정</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-122-1><a class=lnlinks href=#hl-122-1> 1</a>
</span><span class=lnt id=hl-122-2><a class=lnlinks href=#hl-122-2> 2</a>
</span><span class=lnt id=hl-122-3><a class=lnlinks href=#hl-122-3> 3</a>
</span><span class=lnt id=hl-122-4><a class=lnlinks href=#hl-122-4> 4</a>
</span><span class=lnt id=hl-122-5><a class=lnlinks href=#hl-122-5> 5</a>
</span><span class=lnt id=hl-122-6><a class=lnlinks href=#hl-122-6> 6</a>
</span><span class=lnt id=hl-122-7><a class=lnlinks href=#hl-122-7> 7</a>
</span><span class=lnt id=hl-122-8><a class=lnlinks href=#hl-122-8> 8</a>
</span><span class=lnt id=hl-122-9><a class=lnlinks href=#hl-122-9> 9</a>
</span><span class=lnt id=hl-122-10><a class=lnlinks href=#hl-122-10>10</a>
</span><span class=lnt id=hl-122-11><a class=lnlinks href=#hl-122-11>11</a>
</span><span class=lnt id=hl-122-12><a class=lnlinks href=#hl-122-12>12</a>
</span><span class=lnt id=hl-122-13><a class=lnlinks href=#hl-122-13>13</a>
</span><span class=lnt id=hl-122-14><a class=lnlinks href=#hl-122-14>14</a>
</span><span class=lnt id=hl-122-15><a class=lnlinks href=#hl-122-15>15</a>
</span><span class=lnt id=hl-122-16><a class=lnlinks href=#hl-122-16>16</a>
</span><span class=lnt id=hl-122-17><a class=lnlinks href=#hl-122-17>17</a>
</span><span class=lnt id=hl-122-18><a class=lnlinks href=#hl-122-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>의사결정 트리:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. 인덱스 후보 열거
</span></span><span class=line><span class=cl>   └─ WHERE, JOIN, ORDER BY 컬럼의 인덱스
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 각 후보 비용 계산
</span></span><span class=line><span class=cl>   ├─ Index Scan Cost
</span></span><span class=line><span class=cl>   ├─ Full Table Scan Cost
</span></span><span class=line><span class=cl>   └─ Index Merge Cost (여러 인덱스 조합)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 최소 비용 계획 선택
</span></span><span class=line><span class=cl>   if min_cost(index_scan) &lt; full_scan_cost:
</span></span><span class=line><span class=cl>       use index_scan
</span></span><span class=line><span class=cl>   else:
</span></span><span class=line><span class=cl>       use full_table_scan
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4. 힌트 고려 (있는 경우)
</span></span><span class=line><span class=cl>   override optimizer decision
</span></span></code></pre></td></tr></table></div></div><p><strong>버퍼 관리자와의 상호작용</strong></p><p><strong>적응적 교체 정책</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-123-1><a class=lnlinks href=#hl-123-1> 1</a>
</span><span class=lnt id=hl-123-2><a class=lnlinks href=#hl-123-2> 2</a>
</span><span class=lnt id=hl-123-3><a class=lnlinks href=#hl-123-3> 3</a>
</span><span class=lnt id=hl-123-4><a class=lnlinks href=#hl-123-4> 4</a>
</span><span class=lnt id=hl-123-5><a class=lnlinks href=#hl-123-5> 5</a>
</span><span class=lnt id=hl-123-6><a class=lnlinks href=#hl-123-6> 6</a>
</span><span class=lnt id=hl-123-7><a class=lnlinks href=#hl-123-7> 7</a>
</span><span class=lnt id=hl-123-8><a class=lnlinks href=#hl-123-8> 8</a>
</span><span class=lnt id=hl-123-9><a class=lnlinks href=#hl-123-9> 9</a>
</span><span class=lnt id=hl-123-10><a class=lnlinks href=#hl-123-10>10</a>
</span><span class=lnt id=hl-123-11><a class=lnlinks href=#hl-123-11>11</a>
</span><span class=lnt id=hl-123-12><a class=lnlinks href=#hl-123-12>12</a>
</span><span class=lnt id=hl-123-13><a class=lnlinks href=#hl-123-13>13</a>
</span><span class=lnt id=hl-123-14><a class=lnlinks href=#hl-123-14>14</a>
</span><span class=lnt id=hl-123-15><a class=lnlinks href=#hl-123-15>15</a>
</span><span class=lnt id=hl-123-16><a class=lnlinks href=#hl-123-16>16</a>
</span><span class=lnt id=hl-123-17><a class=lnlinks href=#hl-123-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ARC (Adaptive Replacement Cache):
</span></span><span class=line><span class=cl>- LRU와 LFU의 하이브리드
</span></span><span class=line><span class=cl>- 인덱스 페이지와 데이터 페이지 균형
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>구조:
</span></span><span class=line><span class=cl>T1: 최근 한 번 접근 (LRU)
</span></span><span class=line><span class=cl>T2: 최근 여러 번 접근 (LFU)
</span></span><span class=line><span class=cl>B1: T1에서 방출된 페이지 목록
</span></span><span class=line><span class=cl>B2: T2에서 방출된 페이지 목록
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>적응:
</span></span><span class=line><span class=cl>- B1 히트 → T1 크기 증가
</span></span><span class=line><span class=cl>- B2 히트 → T2 크기 증가
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>인덱스 이점:
</span></span><span class=line><span class=cl>- 내부 노드: T2 (자주 접근)
</span></span><span class=line><span class=cl>- 리프 노드: T1 (한 번 접근)
</span></span></code></pre></td></tr></table></div></div><p><strong>프리페칭 전략</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-124-1><a class=lnlinks href=#hl-124-1> 1</a>
</span><span class=lnt id=hl-124-2><a class=lnlinks href=#hl-124-2> 2</a>
</span><span class=lnt id=hl-124-3><a class=lnlinks href=#hl-124-3> 3</a>
</span><span class=lnt id=hl-124-4><a class=lnlinks href=#hl-124-4> 4</a>
</span><span class=lnt id=hl-124-5><a class=lnlinks href=#hl-124-5> 5</a>
</span><span class=lnt id=hl-124-6><a class=lnlinks href=#hl-124-6> 6</a>
</span><span class=lnt id=hl-124-7><a class=lnlinks href=#hl-124-7> 7</a>
</span><span class=lnt id=hl-124-8><a class=lnlinks href=#hl-124-8> 8</a>
</span><span class=lnt id=hl-124-9><a class=lnlinks href=#hl-124-9> 9</a>
</span><span class=lnt id=hl-124-10><a class=lnlinks href=#hl-124-10>10</a>
</span><span class=lnt id=hl-124-11><a class=lnlinks href=#hl-124-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>adaptive_prefetch</span><span class=p>(</span><span class=n>index</span><span class=p>,</span> <span class=n>query</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;적응적 프리페칭&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>query</span><span class=o>.</span><span class=n>type</span> <span class=o>==</span> <span class=s1>&#39;RANGE&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 범위 검색: 시퀀셜 프리페치</span>
</span></span><span class=line><span class=cl>        <span class=n>prefetch_next_leaves</span><span class=p>(</span><span class=n>index</span><span class=p>,</span> <span class=n>count</span><span class=o>=</span><span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>query</span><span class=o>.</span><span class=n>type</span> <span class=o>==</span> <span class=s1>&#39;POINT&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 포인트 검색: 경로 프리페치</span>
</span></span><span class=line><span class=cl>        <span class=n>prefetch_index_path</span><span class=p>(</span><span class=n>index</span><span class=p>,</span> <span class=n>query</span><span class=o>.</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>index</span><span class=o>.</span><span class=n>correlation</span> <span class=o>&gt;</span> <span class=mf>0.8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 높은 상관관계: 데이터도 프리페치</span>
</span></span><span class=line><span class=cl>        <span class=n>prefetch_data_pages</span><span class=p>(</span><span class=n>index</span><span class=p>,</span> <span class=n>query</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>트랜잭션 관리자와의 상호작용</strong></p><p><strong>인덱스 WAL (Write-Ahead Logging)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-125-1><a class=lnlinks href=#hl-125-1> 1</a>
</span><span class=lnt id=hl-125-2><a class=lnlinks href=#hl-125-2> 2</a>
</span><span class=lnt id=hl-125-3><a class=lnlinks href=#hl-125-3> 3</a>
</span><span class=lnt id=hl-125-4><a class=lnlinks href=#hl-125-4> 4</a>
</span><span class=lnt id=hl-125-5><a class=lnlinks href=#hl-125-5> 5</a>
</span><span class=lnt id=hl-125-6><a class=lnlinks href=#hl-125-6> 6</a>
</span><span class=lnt id=hl-125-7><a class=lnlinks href=#hl-125-7> 7</a>
</span><span class=lnt id=hl-125-8><a class=lnlinks href=#hl-125-8> 8</a>
</span><span class=lnt id=hl-125-9><a class=lnlinks href=#hl-125-9> 9</a>
</span><span class=lnt id=hl-125-10><a class=lnlinks href=#hl-125-10>10</a>
</span><span class=lnt id=hl-125-11><a class=lnlinks href=#hl-125-11>11</a>
</span><span class=lnt id=hl-125-12><a class=lnlinks href=#hl-125-12>12</a>
</span><span class=lnt id=hl-125-13><a class=lnlinks href=#hl-125-13>13</a>
</span><span class=lnt id=hl-125-14><a class=lnlinks href=#hl-125-14>14</a>
</span><span class=lnt id=hl-125-15><a class=lnlinks href=#hl-125-15>15</a>
</span><span class=lnt id=hl-125-16><a class=lnlinks href=#hl-125-16>16</a>
</span><span class=lnt id=hl-125-17><a class=lnlinks href=#hl-125-17>17</a>
</span><span class=lnt id=hl-125-18><a class=lnlinks href=#hl-125-18>18</a>
</span><span class=lnt id=hl-125-19><a class=lnlinks href=#hl-125-19>19</a>
</span><span class=lnt id=hl-125-20><a class=lnlinks href=#hl-125-20>20</a>
</span><span class=lnt id=hl-125-21><a class=lnlinks href=#hl-125-21>21</a>
</span><span class=lnt id=hl-125-22><a class=lnlinks href=#hl-125-22>22</a>
</span><span class=lnt id=hl-125-23><a class=lnlinks href=#hl-125-23>23</a>
</span><span class=lnt id=hl-125-24><a class=lnlinks href=#hl-125-24>24</a>
</span><span class=lnt id=hl-125-25><a class=lnlinks href=#hl-125-25>25</a>
</span><span class=lnt id=hl-125-26><a class=lnlinks href=#hl-125-26>26</a>
</span><span class=lnt id=hl-125-27><a class=lnlinks href=#hl-125-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>로그 레코드 구조:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[LSN] [Type] [Index_ID] [Operation] [Data]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>예시:
</span></span><span class=line><span class=cl>1. INSERT 로그:
</span></span><span class=line><span class=cl>   LSN:1000 | INSERT | idx_pk | key=100 | ptr=(5,10)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. SPLIT 로그:
</span></span><span class=line><span class=cl>   LSN:1001 | SPLIT | idx_pk | node=7 | 
</span></span><span class=line><span class=cl>   median=50 | left=7 | right=12
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. DELETE 로그:
</span></span><span class=line><span class=cl>   LSN:1002 | DELETE | idx_pk | key=200
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>복구 과정:
</span></span><span class=line><span class=cl>Redo Phase:
</span></span><span class=line><span class=cl>  for each log_record in LSN order:
</span></span><span class=line><span class=cl>      if log_record.type == &#39;INSERT&#39;:
</span></span><span class=line><span class=cl>          replay_insert(log_record)
</span></span><span class=line><span class=cl>      elif log_record.type == &#39;SPLIT&#39;:
</span></span><span class=line><span class=cl>          replay_split(log_record)
</span></span><span class=line><span class=cl>      ...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Undo Phase:
</span></span><span class=line><span class=cl>  for each uncommitted_txn in reverse:
</span></span><span class=line><span class=cl>      undo_operations(txn)
</span></span></code></pre></td></tr></table></div></div><p><strong>2단계 락킹 (2PL)과 인덱스</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-126-1><a class=lnlinks href=#hl-126-1> 1</a>
</span><span class=lnt id=hl-126-2><a class=lnlinks href=#hl-126-2> 2</a>
</span><span class=lnt id=hl-126-3><a class=lnlinks href=#hl-126-3> 3</a>
</span><span class=lnt id=hl-126-4><a class=lnlinks href=#hl-126-4> 4</a>
</span><span class=lnt id=hl-126-5><a class=lnlinks href=#hl-126-5> 5</a>
</span><span class=lnt id=hl-126-6><a class=lnlinks href=#hl-126-6> 6</a>
</span><span class=lnt id=hl-126-7><a class=lnlinks href=#hl-126-7> 7</a>
</span><span class=lnt id=hl-126-8><a class=lnlinks href=#hl-126-8> 8</a>
</span><span class=lnt id=hl-126-9><a class=lnlinks href=#hl-126-9> 9</a>
</span><span class=lnt id=hl-126-10><a class=lnlinks href=#hl-126-10>10</a>
</span><span class=lnt id=hl-126-11><a class=lnlinks href=#hl-126-11>11</a>
</span><span class=lnt id=hl-126-12><a class=lnlinks href=#hl-126-12>12</a>
</span><span class=lnt id=hl-126-13><a class=lnlinks href=#hl-126-13>13</a>
</span><span class=lnt id=hl-126-14><a class=lnlinks href=#hl-126-14>14</a>
</span><span class=lnt id=hl-126-15><a class=lnlinks href=#hl-126-15>15</a>
</span><span class=lnt id=hl-126-16><a class=lnlinks href=#hl-126-16>16</a>
</span><span class=lnt id=hl-126-17><a class=lnlinks href=#hl-126-17>17</a>
</span><span class=lnt id=hl-126-18><a class=lnlinks href=#hl-126-18>18</a>
</span><span class=lnt id=hl-126-19><a class=lnlinks href=#hl-126-19>19</a>
</span><span class=lnt id=hl-126-20><a class=lnlinks href=#hl-126-20>20</a>
</span><span class=lnt id=hl-126-21><a class=lnlinks href=#hl-126-21>21</a>
</span><span class=lnt id=hl-126-22><a class=lnlinks href=#hl-126-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>계층적 락킹:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>테이블 락
</span></span><span class=line><span class=cl>  ├─ Intent-Shared (IS)
</span></span><span class=line><span class=cl>  ├─ Intent-Exclusive (IX)
</span></span><span class=line><span class=cl>  └─ Shared-Intent-Exclusive (SIX)
</span></span><span class=line><span class=cl>     |
</span></span><span class=line><span class=cl>     └─ 인덱스 락
</span></span><span class=line><span class=cl>          ├─ Key-Range Lock
</span></span><span class=line><span class=cl>          │   └─ 팬텀 방지
</span></span><span class=line><span class=cl>          └─ Individual Key Lock
</span></span><span class=line><span class=cl>              └─ 일반 충돌 방지
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>예시:
</span></span><span class=line><span class=cl>Transaction T1: UPDATE ... WHERE id=100
</span></span><span class=line><span class=cl>1. IX lock on table
</span></span><span class=line><span class=cl>2. X lock on index entry (key=100)
</span></span><span class=line><span class=cl>3. X lock on data row
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Transaction T2: SELECT ... WHERE id=100
</span></span><span class=line><span class=cl>1. IS lock on table
</span></span><span class=line><span class=cl>2. S lock on index entry (key=100) → WAIT
</span></span></code></pre></td></tr></table></div></div><p><strong>스토리지 엔진과의 상호작용</strong></p><p><strong>계층적 저장소 관리</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-127-1><a class=lnlinks href=#hl-127-1> 1</a>
</span><span class=lnt id=hl-127-2><a class=lnlinks href=#hl-127-2> 2</a>
</span><span class=lnt id=hl-127-3><a class=lnlinks href=#hl-127-3> 3</a>
</span><span class=lnt id=hl-127-4><a class=lnlinks href=#hl-127-4> 4</a>
</span><span class=lnt id=hl-127-5><a class=lnlinks href=#hl-127-5> 5</a>
</span><span class=lnt id=hl-127-6><a class=lnlinks href=#hl-127-6> 6</a>
</span><span class=lnt id=hl-127-7><a class=lnlinks href=#hl-127-7> 7</a>
</span><span class=lnt id=hl-127-8><a class=lnlinks href=#hl-127-8> 8</a>
</span><span class=lnt id=hl-127-9><a class=lnlinks href=#hl-127-9> 9</a>
</span><span class=lnt id=hl-127-10><a class=lnlinks href=#hl-127-10>10</a>
</span><span class=lnt id=hl-127-11><a class=lnlinks href=#hl-127-11>11</a>
</span><span class=lnt id=hl-127-12><a class=lnlinks href=#hl-127-12>12</a>
</span><span class=lnt id=hl-127-13><a class=lnlinks href=#hl-127-13>13</a>
</span><span class=lnt id=hl-127-14><a class=lnlinks href=#hl-127-14>14</a>
</span><span class=lnt id=hl-127-15><a class=lnlinks href=#hl-127-15>15</a>
</span><span class=lnt id=hl-127-16><a class=lnlinks href=#hl-127-16>16</a>
</span><span class=lnt id=hl-127-17><a class=lnlinks href=#hl-127-17>17</a>
</span><span class=lnt id=hl-127-18><a class=lnlinks href=#hl-127-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Hot/Warm/Cold 분류:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hot Data (SSD/NVMe):
</span></span><span class=line><span class=cl>├─ 자주 접근하는 인덱스 리프
</span></span><span class=line><span class=cl>├─ 인덱스 내부 노드
</span></span><span class=line><span class=cl>└─ 최근 데이터
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Warm Data (SSD):
</span></span><span class=line><span class=cl>├─ 보통 접근 인덱스
</span></span><span class=line><span class=cl>└─ 중간 시기 데이터
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Cold Data (HDD/Object Storage):
</span></span><span class=line><span class=cl>├─ 거의 접근 안 함
</span></span><span class=line><span class=cl>└─ 아카이브 데이터
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>마이그레이션:
</span></span><span class=line><span class=cl>access_count &gt; threshold_hot → move to SSD
</span></span><span class=line><span class=cl>access_count &lt; threshold_cold → move to HDD
</span></span></code></pre></td></tr></table></div></div><p><strong>인덱스 압축과 스토리지</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-128-1><a class=lnlinks href=#hl-128-1> 1</a>
</span><span class=lnt id=hl-128-2><a class=lnlinks href=#hl-128-2> 2</a>
</span><span class=lnt id=hl-128-3><a class=lnlinks href=#hl-128-3> 3</a>
</span><span class=lnt id=hl-128-4><a class=lnlinks href=#hl-128-4> 4</a>
</span><span class=lnt id=hl-128-5><a class=lnlinks href=#hl-128-5> 5</a>
</span><span class=lnt id=hl-128-6><a class=lnlinks href=#hl-128-6> 6</a>
</span><span class=lnt id=hl-128-7><a class=lnlinks href=#hl-128-7> 7</a>
</span><span class=lnt id=hl-128-8><a class=lnlinks href=#hl-128-8> 8</a>
</span><span class=lnt id=hl-128-9><a class=lnlinks href=#hl-128-9> 9</a>
</span><span class=lnt id=hl-128-10><a class=lnlinks href=#hl-128-10>10</a>
</span><span class=lnt id=hl-128-11><a class=lnlinks href=#hl-128-11>11</a>
</span><span class=lnt id=hl-128-12><a class=lnlinks href=#hl-128-12>12</a>
</span><span class=lnt id=hl-128-13><a class=lnlinks href=#hl-128-13>13</a>
</span><span class=lnt id=hl-128-14><a class=lnlinks href=#hl-128-14>14</a>
</span><span class=lnt id=hl-128-15><a class=lnlinks href=#hl-128-15>15</a>
</span><span class=lnt id=hl-128-16><a class=lnlinks href=#hl-128-16>16</a>
</span><span class=lnt id=hl-128-17><a class=lnlinks href=#hl-128-17>17</a>
</span><span class=lnt id=hl-128-18><a class=lnlinks href=#hl-128-18>18</a>
</span><span class=lnt id=hl-128-19><a class=lnlinks href=#hl-128-19>19</a>
</span><span class=lnt id=hl-128-20><a class=lnlinks href=#hl-128-20>20</a>
</span><span class=lnt id=hl-128-21><a class=lnlinks href=#hl-128-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>압축 수준 결정:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Level 0: 압축 없음
</span></span><span class=line><span class=cl>- CPU: 최소
</span></span><span class=line><span class=cl>- 저장 공간: 최대
</span></span><span class=line><span class=cl>- 사용: Hot 인덱스
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Level 1: 경량 압축 (Prefix)
</span></span><span class=line><span class=cl>- CPU: 낮음
</span></span><span class=line><span class=cl>- 저장 공간: 30% 절감
</span></span><span class=line><span class=cl>- 사용: Warm 인덱스
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Level 2: 중간 압축 (Dictionary)
</span></span><span class=line><span class=cl>- CPU: 중간
</span></span><span class=line><span class=cl>- 저장 공간: 50% 절감
</span></span><span class=line><span class=cl>- 사용: Cold 인덱스
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Level 3: 고압축 (Zstd)
</span></span><span class=line><span class=cl>- CPU: 높음
</span></span><span class=line><span class=cl>- 저장 공간: 70% 절감
</span></span><span class=line><span class=cl>- 사용: Archive 인덱스
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=phase-3-특성-분석-및-평가-1>Phase 3: 특성 분석 및 평가<a hidden class=anchor aria-hidden=true href=#phase-3-특성-분석-및-평가-1>#</a></h3><h4 id=31-주요-장점-및-이점-1>3.1 주요 장점 및 이점<a hidden class=anchor aria-hidden=true href=#31-주요-장점-및-이점-1>#</a></h4><table><thead><tr><th>장점</th><th>상세 설명</th><th>기술 근거</th><th>적용 상황</th><th>실무적 가치</th></tr></thead><tbody><tr><td><strong>극적인 검색 성능 향상</strong></td><td>선형 탐색 O(n)을 로그 시간 O(log n) 또는 상수 시간 O(1)으로 개선</td><td>B-Tree의 균형 트리 구조와 이진/다진 탐색 알고리즘, Hash의 직접 주소 계산</td><td>대용량 데이터(100만 건 이상)에서 특정 레코드 검색 시</td><td>1억 건 테이블에서 수 분 → 수 밀리초로 단축, 사용자 경험 개선 및 실시간 응답 가능</td></tr><tr><td><strong>디스크 I/O 최소화</strong></td><td>필요한 페이지만 선택적으로 읽어 전체 스캔 대비 90-99% I/O 감소</td><td>인덱스 트리 높이 최소화(fanout 최대화), 정렬된 구조로 순차 접근 가능</td><td>I/O가 병목인 환경, HDD 사용 시스템, 네트워크 스토리지</td><td>HDD 환경에서 100배 이상 속도 향상, 클라우드 환경에서 I/O 비용 절감</td></tr><tr><td><strong>정렬 및 그룹화 최적화</strong></td><td>ORDER BY, GROUP BY 연산 시 추가 정렬 작업 불필요</td><td>인덱스 키가 이미 정렬되어 저장, 리프 노드 연결로 순차 접근</td><td>정렬이 필요한 리포트, 순위 쿼리, 집계 연산</td><td>정렬 비용(O(n log n)) 제거, 메모리 부족 시 디스크 정렬 회피, 스트리밍 결과 가능</td></tr><tr><td><strong>범위 검색 효율성</strong></td><td>BETWEEN, >, &lt;, LIKE &lsquo;prefix%&rsquo; 등 범위 조건에서 연속된 데이터 빠른 스캔</td><td>B+ Tree의 리프 노드 연결 리스트, 순차 I/O 활용</td><td>날짜 범위 조회, 가격 구간 필터링, 이름 prefix 검색</td><td>범위 쿼리 100-1000배 가속, 페이지네이션 성능 안정적</td></tr><tr><td><strong>조인 성능 대폭 개선</strong></td><td>Nested Loop Join의 내부 테이블 접근을 O(1) 또는 O(log n)으로 가속</td><td>조인 키에 인덱스 존재 시 해시 조인 또는 인덱스 조인 가능</td><td>다중 테이블 조인, 외래 키 참조, 정규화된 스키마</td><td>O(n×m) → O(n log m) 또는 O(n), 복잡한 분석 쿼리 실용화</td></tr><tr><td><strong>동시성 향상</strong></td><td>쿼리 실행 시간 단축으로 락 보유 시간 감소, 처리량 증가</td><td>짧은 실행 시간 → 짧은 락 시간 → 대기 시간 감소</td><td>높은 동시 접속 환경, OLTP 시스템, 실시간 서비스</td><td>동시 사용자 수 10배 이상 증가 가능, 락 경합 감소, 응답 시간 안정화</td></tr><tr><td><strong>무결성 제약 강화</strong></td><td>UNIQUE, PRIMARY KEY, FOREIGN KEY 제약의 빠른 검증</td><td>인덱스를 통한 중복 검사 O(log n), 참조 무결성 검증 가속</td><td>데이터 입력/수정 시 제약 조건 확인, 참조 무결성 유지</td><td>제약 위반 즉시 탐지, 데이터 품질 보장, 애플리케이션 로직 단순화</td></tr><tr><td><strong>커버링 인덱스로 테이블 접근 제거</strong></td><td>쿼리의 모든 컬럼이 인덱스에 포함되어 데이터 페이지 접근 불필요</td><td>인덱스에 필요한 모든 정보 포함, 테이블 룩업 생략</td><td>자주 조회되는 특정 컬럼 조합, 분석 쿼리, 집계 연산</td><td>I/O 50-90% 감소, 캐시 효율 향상, 쿼리 응답 시간 1/10 이하로 단축</td></tr><tr><td><strong>파티셔닝과 결합한 확장성</strong></td><td>파티션별 로컬 인덱스로 병렬 처리 및 관리 단위 축소</td><td>파티션 프루닝과 인덱스 결합, 독립적 유지보수 가능</td><td>초대용량 테이블(수억-수십억 건), 시계열 데이터, 로그 데이터</td><td>테라바이트급 데이터 관리 가능, 파티션 단위 백업/복구, 병렬 쿼리 처리</td></tr><tr><td><strong>선택적 인덱싱 유연성</strong></td><td>부분 인덱스, 함수 인덱스, 표현식 인덱스로 특정 사용 사례 최적화</td><td>조건부 인덱싱, 계산된 값 인덱싱, 사용자 정의 함수 활용</td><td>특정 상태 데이터만 자주 조회, 계산 컬럼 검색, JSON 필드 인덱싱</td><td>인덱스 크기 50-90% 절감, 특화된 쿼리 패턴 최적화, 저장 공간 효율화</td></tr></tbody></table><p><strong>실무 사례를 통한 가치 검증</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-129-1><a class=lnlinks href=#hl-129-1> 1</a>
</span><span class=lnt id=hl-129-2><a class=lnlinks href=#hl-129-2> 2</a>
</span><span class=lnt id=hl-129-3><a class=lnlinks href=#hl-129-3> 3</a>
</span><span class=lnt id=hl-129-4><a class=lnlinks href=#hl-129-4> 4</a>
</span><span class=lnt id=hl-129-5><a class=lnlinks href=#hl-129-5> 5</a>
</span><span class=lnt id=hl-129-6><a class=lnlinks href=#hl-129-6> 6</a>
</span><span class=lnt id=hl-129-7><a class=lnlinks href=#hl-129-7> 7</a>
</span><span class=lnt id=hl-129-8><a class=lnlinks href=#hl-129-8> 8</a>
</span><span class=lnt id=hl-129-9><a class=lnlinks href=#hl-129-9> 9</a>
</span><span class=lnt id=hl-129-10><a class=lnlinks href=#hl-129-10>10</a>
</span><span class=lnt id=hl-129-11><a class=lnlinks href=#hl-129-11>11</a>
</span><span class=lnt id=hl-129-12><a class=lnlinks href=#hl-129-12>12</a>
</span><span class=lnt id=hl-129-13><a class=lnlinks href=#hl-129-13>13</a>
</span><span class=lnt id=hl-129-14><a class=lnlinks href=#hl-129-14>14</a>
</span><span class=lnt id=hl-129-15><a class=lnlinks href=#hl-129-15>15</a>
</span><span class=lnt id=hl-129-16><a class=lnlinks href=#hl-129-16>16</a>
</span><span class=lnt id=hl-129-17><a class=lnlinks href=#hl-129-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>사례 1: 전자상거래 주문 검색
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ 환경: 5천만 건 주문 테이블              │
</span></span><span class=line><span class=cl>│ 쿼리: WHERE order_date BETWEEN ...       │
</span></span><span class=line><span class=cl>│                                          │
</span></span><span class=line><span class=cl>│ 인덱스 없음:                             │
</span></span><span class=line><span class=cl>│ - 실행 시간: 45초                        │
</span></span><span class=line><span class=cl>│ - 디스크 I/O: 50,000 페이지              │
</span></span><span class=line><span class=cl>│ - CPU 사용률: 80%                        │
</span></span><span class=line><span class=cl>│                                          │
</span></span><span class=line><span class=cl>│ 인덱스 적용 (order_date):                │
</span></span><span class=line><span class=cl>│ - 실행 시간: 0.2초                       │
</span></span><span class=line><span class=cl>│ - 디스크 I/O: 50 페이지                  │
</span></span><span class=line><span class=cl>│ - CPU 사용률: 5%                         │
</span></span><span class=line><span class=cl>│                                          │
</span></span><span class=line><span class=cl>│ 개선: 225배 속도 향상, 1000배 I/O 절감   │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────┘
</span></span></code></pre></td></tr></table></div></div><h4 id=32-단점-및-제약사항-1>3.2 단점 및 제약사항<a hidden class=anchor aria-hidden=true href=#32-단점-및-제약사항-1>#</a></h4><p><strong>단점</strong></p><table><thead><tr><th>단점</th><th>상세 설명</th><th>원인</th><th>실무에서 발생되는 문제</th><th>완화/해결 방안</th><th>대안 기술</th></tr></thead><tbody><tr><td><strong>쓰기 성능 저하</strong></td><td>INSERT, UPDATE, DELETE 시 인덱스도 함께 갱신되어 2-5배 시간 증가</td><td>각 인덱스마다 트리 탐색 및 재조정, 페이지 분할/병합 발생</td><td>대량 데이터 입력 시 처리 속도 급격히 저하, 배치 작업 지연, 실시간 스트리밍 병목</td><td>배치 INSERT 시 인덱스 DROP → 로드 → REBUILD, FILLFACTOR 조정으로 페이지 분할 최소화</td><td>LSM-Tree(Write-Optimized Index), 버퍼링 후 일괄 반영</td></tr><tr><td><strong>인덱스 단편화</strong></td><td>시간이 지남에 따라 인덱스 페이지 내 빈 공간 증가 및 논리적/물리적 순서 불일치</td><td>무작위 INSERT/DELETE로 페이지 분할 반복, 순차적이지 않은 키 삽입</td><td>검색 성능 점진적 저하(10-50%), 디스크 공간 낭비(20-40%), I/O 증가</td><td>주기적 REBUILD/REORGANIZE(단편화율 > 30% 시), 적절한 FILLFACTOR 설정(90%)</td><td>파티셔닝으로 단편화 영역 격리, 온라인 인덱스 재구성</td></tr><tr><td><strong>메모리 경합</strong></td><td>인덱스가 버퍼 풀 메모리를 차지하여 데이터 캐싱 공간 감소</td><td>인덱스도 메모리에 캐싱 필요, 다수 인덱스 시 메모리 부족</td><td>캐시 히트율 저하(10-30%), 스와핑 발생, 전체 시스템 성능 저하</td><td>선택적 인덱싱(핵심만), 커버링 인덱스로 데이터 접근 최소화, 메모리 증설</td><td>컬럼스토어(압축률 높음), 인덱스 압축</td></tr><tr><td><strong>잘못된 인덱스 선택</strong></td><td>옵티마이저가 부적절한 인덱스를 선택하거나 인덱스를 사용하지 않음</td><td>통계 정보 부정확, 복잡한 쿼리, 다중 조건 평가 오류</td><td>예상과 다른 느린 쿼리, 간헐적 성능 저하, 프로덕션 장애</td><td>정기적 통계 갱신(ANALYZE), 쿼리 힌트 사용, 실행 계획 모니터링</td><td>강제 인덱스 힌트, 쿼리 재작성, 매뉴얼 튜닝</td></tr><tr><td><strong>인덱스 스캔 vs 풀 스캔 역전</strong></td><td>저선택도 조건에서 인덱스 사용이 오히려 느림</td><td>많은 행 반환 시 랜덤 I/O > 순차 I/O 비용, 인덱스+테이블 이중 접근</td><td>선택도 20% 이상 쿼리에서 성능 역효과, 옵티마이저 혼란</td><td>옵티마이저 통계 신뢰, 필터링된 인덱스 사용, 커버링 인덱스로 테이블 접근 제거</td><td>파티션 프루닝, 비트맵 인덱스 스캔, 병렬 풀 스캔</td></tr><tr><td><strong>복합 인덱스 순서 의존성</strong></td><td>복합 인덱스는 컬럼 순서에 따라 효과가 극명히 달라짐</td><td>B-Tree는 첫 번째 컬럼부터 정렬, 뒷 컬럼 단독 사용 불가</td><td>(A,B) 인덱스는 B만 조건일 때 무용, 잘못된 순서로 생성 시 재생성 필요</td><td>선택도 높은 컬럼 우선, 쿼리 패턴 분석 후 순서 결정, 필요 시 개별 인덱스 추가</td><td>여러 단일 인덱스 + Index Merge, 인덱스 인터섹션</td></tr><tr><td><strong>NULL 처리 비효율</strong></td><td>대부분 DBMS에서 NULL 값은 인덱스에 미포함</td><td>B-Tree 구현 방식, NULL의 정렬 불가 특성</td><td>IS NULL 조건 쿼리 시 인덱스 사용 불가, 풀 스캔 발생</td><td>부분 인덱스(WHERE col IS NOT NULL), NULL 대신 기본값 사용</td><td>비트맵 인덱스(NULL 포함), 함수 인덱스(COALESCE)</td></tr><tr><td><strong>핫스팟 문제</strong></td><td>순차 증가 키(예: AUTO_INCREMENT)로 인한 특정 페이지 경합</td><td>모든 INSERT가 마지막 리프 페이지에 집중, 해당 페이지 락 경합</td><td>동시 INSERT 병목, 락 대기 시간 증가, 처리량 저하</td><td>UUID/GUID 사용, 파티셔닝, FILLFACTOR 낮춤(70-80%), 순서 역전</td><td>Hash 샤딩, 랜덤 키 생성, 분산 시퀀스</td></tr></tbody></table><p><strong>제약사항</strong></p><table><thead><tr><th>제약사항</th><th>상세 설명</th><th>원인</th><th>영향</th><th>완화/해결 방안</th><th>대안 기술</th></tr></thead><tbody><tr><td><strong>인덱스 크기 제한</strong></td><td>대부분 DBMS는 인덱스 키 크기 제한(MySQL: 3072B, PostgreSQL: 8191B)</td><td>페이지 크기 제약, B-Tree 노드 구조 한계</td><td>긴 텍스트, BLOB 컬럼 인덱싱 불가, VARCHAR(MAX) 사용 제한</td><td>Prefix 인덱스(처음 N 바이트만), Hash 인덱스, Full-Text 인덱스</td><td>별도 검색 엔진(Elasticsearch), 외부 인덱스 서비스</td></tr><tr><td><strong>인덱스 개수 제한</strong></td><td>테이블당 최대 인덱스 수 제한 존재(예: SQL Server 999개)</td><td>메타데이터 관리 오버헤드, 쓰기 성능 고려</td><td>복잡한 쿼리 패턴 대응 어려움, 새 인덱스 추가 불가</td><td>불필요한 인덱스 제거, 복합 인덱스 통합, 쿼리 최적화</td><td>쿼리 재작성으로 기존 인덱스 활용, 인덱스된 뷰</td></tr><tr><td><strong>온라인 인덱스 작업 불가</strong></td><td>일부 DBMS는 인덱스 생성/재구성 시 테이블 잠금</td><td>DDL 작업 특성, 일관성 보장 필요</td><td>서비스 중단 필요, 점검 시간 필요, 24/7 서비스 불가</td><td>온라인 인덱스 빌드 지원 DBMS 사용(Oracle, PostgreSQL), 복제본에서 작업</td><td>블루-그린 배포, 읽기 전용 복제본 활용, 순차 마이그레이션</td></tr><tr><td><strong>트랜잭션 격리 수준 제약</strong></td><td>Serializable 수준에서 인덱스 범위 락으로 동시성 극히 저하</td><td>팬텀 리드 방지를 위한 범위 락 필요</td><td>동시 처리량 급감, 데드락 증가, 타임아웃 빈발</td><td>Read Committed 사용, 낙관적 잠금, MVCC 기반 DBMS</td><td>Snapshot Isolation, 애플리케이션 레벨 버전 관리</td></tr><tr><td><strong>데이터 타입 제약</strong></td><td>일부 데이터 타입은 인덱싱 불가(TEXT, BLOB, JSON 일부)</td><td>비교 불가능성, 크기 제약, 정렬 불가</td><td>해당 컬럼 조건 검색 시 풀 스캔, 성능 저하</td><td>가상 컬럼 인덱스, 함수 인덱스, 추출 컬럼 별도 생성</td><td>전문 검색 엔진, NoSQL, 문서 DB</td></tr><tr><td><strong>분산 환경 복잡도</strong></td><td>글로벌 인덱스는 분산 트랜잭션 필요, 로컬 인덱스는 제한적</td><td>샤드 간 일관성 유지 어려움, 네트워크 지연</td><td>성능 저하, 일관성 문제, 관리 복잡도 증가</td><td>샤딩 키와 인덱스 키 일치, 로컬 인덱스 우선, 최종 일관성 허용</td><td>샤드별 독립 인덱스, 분산 검색 엔진, 쿼리 라우팅</td></tr><tr><td><strong>변경 불가능 환경</strong></td><td>클라우드 매니지드 서비스는 인덱스 고급 옵션 제한</td><td>관리형 서비스 정책, 멀티테넌시 제약</td><td>FILLFACTOR, 압축 옵션 미제공, 세밀한 튜닝 불가</td><td>서비스 제공 범위 내 최적화, 프로바이더 요청, 자체 호스팅 고려</td><td>하이브리드 아키텍처, 오픈소스 DB 직접 운영</td></tr></tbody></table><p><strong>실제 문제 사례</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-130-1><a class=lnlinks href=#hl-130-1> 1</a>
</span><span class=lnt id=hl-130-2><a class=lnlinks href=#hl-130-2> 2</a>
</span><span class=lnt id=hl-130-3><a class=lnlinks href=#hl-130-3> 3</a>
</span><span class=lnt id=hl-130-4><a class=lnlinks href=#hl-130-4> 4</a>
</span><span class=lnt id=hl-130-5><a class=lnlinks href=#hl-130-5> 5</a>
</span><span class=lnt id=hl-130-6><a class=lnlinks href=#hl-130-6> 6</a>
</span><span class=lnt id=hl-130-7><a class=lnlinks href=#hl-130-7> 7</a>
</span><span class=lnt id=hl-130-8><a class=lnlinks href=#hl-130-8> 8</a>
</span><span class=lnt id=hl-130-9><a class=lnlinks href=#hl-130-9> 9</a>
</span><span class=lnt id=hl-130-10><a class=lnlinks href=#hl-130-10>10</a>
</span><span class=lnt id=hl-130-11><a class=lnlinks href=#hl-130-11>11</a>
</span><span class=lnt id=hl-130-12><a class=lnlinks href=#hl-130-12>12</a>
</span><span class=lnt id=hl-130-13><a class=lnlinks href=#hl-130-13>13</a>
</span><span class=lnt id=hl-130-14><a class=lnlinks href=#hl-130-14>14</a>
</span><span class=lnt id=hl-130-15><a class=lnlinks href=#hl-130-15>15</a>
</span><span class=lnt id=hl-130-16><a class=lnlinks href=#hl-130-16>16</a>
</span><span class=lnt id=hl-130-17><a class=lnlinks href=#hl-130-17>17</a>
</span><span class=lnt id=hl-130-18><a class=lnlinks href=#hl-130-18>18</a>
</span><span class=lnt id=hl-130-19><a class=lnlinks href=#hl-130-19>19</a>
</span><span class=lnt id=hl-130-20><a class=lnlinks href=#hl-130-20>20</a>
</span><span class=lnt id=hl-130-21><a class=lnlinks href=#hl-130-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>사례: 대량 INSERT 성능 저하
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>상황:
</span></span><span class=line><span class=cl>- 일일 1억 건 로그 데이터 적재
</span></span><span class=line><span class=cl>- 테이블에 5개 인덱스 존재
</span></span><span class=line><span class=cl>- 배치 작업 시간: 8시간 → 18시간 초과
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>원인 분석:
</span></span><span class=line><span class=cl>1. 각 INSERT마다 5개 인덱스 갱신
</span></span><span class=line><span class=cl>2. 랜덤 키로 인한 페이지 분할 빈발
</span></span><span class=line><span class=cl>3. 인덱스 단편화로 I/O 증가
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>해결 방안:
</span></span><span class=line><span class=cl>1. 적재 전 인덱스 DROP
</span></span><span class=line><span class=cl>2. BULK INSERT (인덱스 없음): 1.5시간
</span></span><span class=line><span class=cl>3. 정렬 후 인덱스 REBUILD: 2시간
</span></span><span class=line><span class=cl>4. 총 시간: 3.5시간 (5배 개선)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>교훈:
</span></span><span class=line><span class=cl>- 대량 작업 시 인덱스 재구성 전략 필수
</span></span><span class=line><span class=cl>- 쓰기 중심 워크로드는 인덱스 최소화
</span></span></code></pre></td></tr></table></div></div><h4 id=33-트레이드오프-관계-분석-1>3.3 트레이드오프 관계 분석<a hidden class=anchor aria-hidden=true href=#33-트레이드오프-관계-분석-1>#</a></h4><p><strong>트레이드오프 1: 읽기 성능 vs 쓰기 성능</strong></p><p><strong>선택지 분석</strong>:</p><table><thead><tr><th>측면</th><th>많은 인덱스</th><th>적은 인덱스</th><th>균형점</th></tr></thead><tbody><tr><td><strong>SELECT 성능</strong></td><td>최고 (다양한 패턴 지원)</td><td>제한적 (특정 패턴만)</td><td>주요 쿼리 커버</td></tr><tr><td><strong>INSERT 성능</strong></td><td>나쁨 (n개 인덱스 갱신)</td><td>좋음 (최소 갱신)</td><td>필수 인덱스만</td></tr><tr><td><strong>UPDATE 성능</strong></td><td>변동 (인덱싱 컬럼 여부)</td><td>안정적</td><td>선택적 인덱싱</td></tr><tr><td><strong>DELETE 성능</strong></td><td>나쁨 (모든 인덱스 정리)</td><td>좋음</td><td>부분 인덱스</td></tr><tr><td><strong>저장 공간</strong></td><td>대량 (100-200%)</td><td>최소 (10-30%)</td><td>50-70%</td></tr><tr><td><strong>유지보수</strong></td><td>복잡함</td><td>단순함</td><td>자동화</td></tr></tbody></table><p><strong>의사결정 기준</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-131-1><a class=lnlinks href=#hl-131-1> 1</a>
</span><span class=lnt id=hl-131-2><a class=lnlinks href=#hl-131-2> 2</a>
</span><span class=lnt id=hl-131-3><a class=lnlinks href=#hl-131-3> 3</a>
</span><span class=lnt id=hl-131-4><a class=lnlinks href=#hl-131-4> 4</a>
</span><span class=lnt id=hl-131-5><a class=lnlinks href=#hl-131-5> 5</a>
</span><span class=lnt id=hl-131-6><a class=lnlinks href=#hl-131-6> 6</a>
</span><span class=lnt id=hl-131-7><a class=lnlinks href=#hl-131-7> 7</a>
</span><span class=lnt id=hl-131-8><a class=lnlinks href=#hl-131-8> 8</a>
</span><span class=lnt id=hl-131-9><a class=lnlinks href=#hl-131-9> 9</a>
</span><span class=lnt id=hl-131-10><a class=lnlinks href=#hl-131-10>10</a>
</span><span class=lnt id=hl-131-11><a class=lnlinks href=#hl-131-11>11</a>
</span><span class=lnt id=hl-131-12><a class=lnlinks href=#hl-131-12>12</a>
</span><span class=lnt id=hl-131-13><a class=lnlinks href=#hl-131-13>13</a>
</span><span class=lnt id=hl-131-14><a class=lnlinks href=#hl-131-14>14</a>
</span><span class=lnt id=hl-131-15><a class=lnlinks href=#hl-131-15>15</a>
</span><span class=lnt id=hl-131-16><a class=lnlinks href=#hl-131-16>16</a>
</span><span class=lnt id=hl-131-17><a class=lnlinks href=#hl-131-17>17</a>
</span><span class=lnt id=hl-131-18><a class=lnlinks href=#hl-131-18>18</a>
</span><span class=lnt id=hl-131-19><a class=lnlinks href=#hl-131-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>워크로드 비율 기반 결정:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>읽기 90% : 쓰기 10% (OLAP, 보고서)
</span></span><span class=line><span class=cl>└─&gt; 공격적 인덱싱 전략
</span></span><span class=line><span class=cl>    ├─ 다양한 복합 인덱스
</span></span><span class=line><span class=cl>    ├─ 커버링 인덱스
</span></span><span class=line><span class=cl>    └─ 부분 인덱스
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>읽기 70% : 쓰기 30% (OLTP, 일반 웹)
</span></span><span class=line><span class=cl>└─&gt; 균형 인덱싱 전략
</span></span><span class=line><span class=cl>    ├─ 핵심 쿼리 인덱스
</span></span><span class=line><span class=cl>    ├─ 복합 인덱스 선택적
</span></span><span class=line><span class=cl>    └─ 정기 검토
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>읽기 50% : 쓰기 50% (실시간 스트리밍)
</span></span><span class=line><span class=cl>└─&gt; 보수적 인덱싱 전략
</span></span><span class=line><span class=cl>    ├─ Primary/Foreign Key만
</span></span><span class=line><span class=cl>    ├─ 필수 검색 인덱스 최소
</span></span><span class=line><span class=cl>    └─ Write-Optimized 고려
</span></span></code></pre></td></tr></table></div></div><p><strong>트레이드오프 2: 공간 효율 vs 성능</strong></p><p><strong>선택지 분석</strong>:</p><pre class=mermaid>graph LR
    A[저장 공간] --&gt;|트레이드오프| B[쿼리 성능]
    
    C[압축 인덱스] --&gt;|공간 ↓ 30%| A
    C --&gt;|성능 ↓ 10%| B
    
    D[비압축 인덱스] --&gt;|공간 ↑ 100%| A
    D --&gt;|성능 ↑ 최고| B
    
    E[부분 인덱스] --&gt;|공간 ↓ 50%| A
    E --&gt;|성능 ↑ 특정 쿼리| B
    
    style A fill:#FFB6C6
    style B fill:#90EE90
</pre><p><strong>비용-효과 분석</strong>:</p><table><thead><tr><th>전략</th><th>저장 비용</th><th>쿼리 성능</th><th>유지보수</th><th>적합 시나리오</th></tr></thead><tbody><tr><td><strong>Full Index</strong></td><td>$$$ (높음)</td><td>⭐⭐⭐⭐⭐</td><td>단순</td><td>비용보다 성능 우선</td></tr><tr><td><strong>Compressed</strong></td><td>$ (낮음)</td><td>⭐⭐⭐⭐</td><td>보통</td><td>저장 비용 민감, 성능 타협 가능</td></tr><tr><td><strong>Partial</strong></td><td>$$ (중간)</td><td>⭐⭐⭐⭐⭐ (특정)</td><td>복잡</td><td>특정 패턴 집중</td></tr><tr><td><strong>Minimal</strong></td><td>$ (최소)</td><td>⭐⭐</td><td>단순</td><td>쓰기 중심, 공간 제약</td></tr></tbody></table><p><strong>의사결정 트리</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-133-1><a class=lnlinks href=#hl-133-1> 1</a>
</span><span class=lnt id=hl-133-2><a class=lnlinks href=#hl-133-2> 2</a>
</span><span class=lnt id=hl-133-3><a class=lnlinks href=#hl-133-3> 3</a>
</span><span class=lnt id=hl-133-4><a class=lnlinks href=#hl-133-4> 4</a>
</span><span class=lnt id=hl-133-5><a class=lnlinks href=#hl-133-5> 5</a>
</span><span class=lnt id=hl-133-6><a class=lnlinks href=#hl-133-6> 6</a>
</span><span class=lnt id=hl-133-7><a class=lnlinks href=#hl-133-7> 7</a>
</span><span class=lnt id=hl-133-8><a class=lnlinks href=#hl-133-8> 8</a>
</span><span class=lnt id=hl-133-9><a class=lnlinks href=#hl-133-9> 9</a>
</span><span class=lnt id=hl-133-10><a class=lnlinks href=#hl-133-10>10</a>
</span><span class=lnt id=hl-133-11><a class=lnlinks href=#hl-133-11>11</a>
</span><span class=lnt id=hl-133-12><a class=lnlinks href=#hl-133-12>12</a>
</span><span class=lnt id=hl-133-13><a class=lnlinks href=#hl-133-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 저장 비용이 주요 관심사인가?
</span></span><span class=line><span class=cl>   ├─ Yes → 압축 또는 부분 인덱스
</span></span><span class=line><span class=cl>   └─ No → 2번으로
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 쿼리 패턴이 명확한가?
</span></span><span class=line><span class=cl>   ├─ Yes → 부분 인덱스
</span></span><span class=line><span class=cl>   └─ No → 3번으로
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 성능이 최우선인가?
</span></span><span class=line><span class=cl>   ├─ Yes → Full Index (비압축)
</span></span><span class=line><span class=cl>   └─ No → 압축 인덱스
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4. 모니터링 후 지속적 조정
</span></span></code></pre></td></tr></table></div></div><p><strong>트레이드오프 3: 단일 복합 인덱스 vs 다중 단일 인덱스</strong></p><p><strong>선택지 비교</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-134-1><a class=lnlinks href=#hl-134-1> 1</a>
</span><span class=lnt id=hl-134-2><a class=lnlinks href=#hl-134-2> 2</a>
</span><span class=lnt id=hl-134-3><a class=lnlinks href=#hl-134-3> 3</a>
</span><span class=lnt id=hl-134-4><a class=lnlinks href=#hl-134-4> 4</a>
</span><span class=lnt id=hl-134-5><a class=lnlinks href=#hl-134-5> 5</a>
</span><span class=lnt id=hl-134-6><a class=lnlinks href=#hl-134-6> 6</a>
</span><span class=lnt id=hl-134-7><a class=lnlinks href=#hl-134-7> 7</a>
</span><span class=lnt id=hl-134-8><a class=lnlinks href=#hl-134-8> 8</a>
</span><span class=lnt id=hl-134-9><a class=lnlinks href=#hl-134-9> 9</a>
</span><span class=lnt id=hl-134-10><a class=lnlinks href=#hl-134-10>10</a>
</span><span class=lnt id=hl-134-11><a class=lnlinks href=#hl-134-11>11</a>
</span><span class=lnt id=hl-134-12><a class=lnlinks href=#hl-134-12>12</a>
</span><span class=lnt id=hl-134-13><a class=lnlinks href=#hl-134-13>13</a>
</span><span class=lnt id=hl-134-14><a class=lnlinks href=#hl-134-14>14</a>
</span><span class=lnt id=hl-134-15><a class=lnlinks href=#hl-134-15>15</a>
</span><span class=lnt id=hl-134-16><a class=lnlinks href=#hl-134-16>16</a>
</span><span class=lnt id=hl-134-17><a class=lnlinks href=#hl-134-17>17</a>
</span><span class=lnt id=hl-134-18><a class=lnlinks href=#hl-134-18>18</a>
</span><span class=lnt id=hl-134-19><a class=lnlinks href=#hl-134-19>19</a>
</span><span class=lnt id=hl-134-20><a class=lnlinks href=#hl-134-20>20</a>
</span><span class=lnt id=hl-134-21><a class=lnlinks href=#hl-134-21>21</a>
</span><span class=lnt id=hl-134-22><a class=lnlinks href=#hl-134-22>22</a>
</span><span class=lnt id=hl-134-23><a class=lnlinks href=#hl-134-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>시나리오: WHERE a=1 AND b=2 쿼리
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>옵션 A: 복합 인덱스 (a, b)
</span></span><span class=line><span class=cl>장점:
</span></span><span class=line><span class=cl>+ 해당 쿼리 최적 (한 번에 해결)
</span></span><span class=line><span class=cl>+ 저장 공간 효율
</span></span><span class=line><span class=cl>+ 정렬 지원 (ORDER BY a, b)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>단점:
</span></span><span class=line><span class=cl>- &#39;b&#39;만 조건일 때 사용 불가
</span></span><span class=line><span class=cl>- &#39;a&#39; 순서 의존성
</span></span><span class=line><span class=cl>- 유연성 부족
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>옵션 B: 단일 인덱스 두 개 (a), (b)
</span></span><span class=line><span class=cl>장점:
</span></span><span class=line><span class=cl>+ &#39;a&#39;만 또는 &#39;b&#39;만 쿼리 지원
</span></span><span class=line><span class=cl>+ 유연성 높음
</span></span><span class=line><span class=cl>+ 순서 무관
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>단점:
</span></span><span class=line><span class=cl>- Index Merge 오버헤드
</span></span><span class=line><span class=cl>- 저장 공간 2배
</span></span><span class=line><span class=cl>- AND 조건 시 느릴 수 있음
</span></span></code></pre></td></tr></table></div></div><p><strong>고려 요소 매트릭스</strong>:</p><table><thead><tr><th>요소</th><th>복합 인덱스 선호</th><th>단일 인덱스 선호</th></tr></thead><tbody><tr><td><strong>쿼리 패턴</strong></td><td>항상 여러 컬럼 함께 조회</td><td>개별 컬럼 독립 조회</td></tr><tr><td><strong>컬럼 선택도</strong></td><td>첫 컬럼 선택도 높음</td><td>각 컬럼 선택도 비슷</td></tr><tr><td><strong>정렬 요구</strong></td><td>복합 정렬 필요</td><td>단일 정렬만</td></tr><tr><td><strong>저장 공간</strong></td><td>제한적</td><td>충분</td></tr><tr><td><strong>유지보수</strong></td><td>단순 선호</td><td>복잡도 수용 가능</td></tr></tbody></table><p><strong>실무 권장사항</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-135-1><a class=lnlinks href=#hl-135-1> 1</a>
</span><span class=lnt id=hl-135-2><a class=lnlinks href=#hl-135-2> 2</a>
</span><span class=lnt id=hl-135-3><a class=lnlinks href=#hl-135-3> 3</a>
</span><span class=lnt id=hl-135-4><a class=lnlinks href=#hl-135-4> 4</a>
</span><span class=lnt id=hl-135-5><a class=lnlinks href=#hl-135-5> 5</a>
</span><span class=lnt id=hl-135-6><a class=lnlinks href=#hl-135-6> 6</a>
</span><span class=lnt id=hl-135-7><a class=lnlinks href=#hl-135-7> 7</a>
</span><span class=lnt id=hl-135-8><a class=lnlinks href=#hl-135-8> 8</a>
</span><span class=lnt id=hl-135-9><a class=lnlinks href=#hl-135-9> 9</a>
</span><span class=lnt id=hl-135-10><a class=lnlinks href=#hl-135-10>10</a>
</span><span class=lnt id=hl-135-11><a class=lnlinks href=#hl-135-11>11</a>
</span><span class=lnt id=hl-135-12><a class=lnlinks href=#hl-135-12>12</a>
</span><span class=lnt id=hl-135-13><a class=lnlinks href=#hl-135-13>13</a>
</span><span class=lnt id=hl-135-14><a class=lnlinks href=#hl-135-14>14</a>
</span><span class=lnt id=hl-135-15><a class=lnlinks href=#hl-135-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 패턴 1: 항상 함께 조회 → 복합 인덱스
</span></span></span><span class=line><span class=cl><span class=c1>-- 쿼리: WHERE user_id=? AND created_date BETWEEN ? AND ?
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_user_date</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span><span class=w> </span><span class=n>created_date</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 패턴 2: 독립적 조회 빈번 → 단일 인덱스
</span></span></span><span class=line><span class=cl><span class=c1>-- 쿼리 A: WHERE status=?
</span></span></span><span class=line><span class=cl><span class=c1>-- 쿼리 B: WHERE category=?
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_status</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>products</span><span class=p>(</span><span class=n>status</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_category</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>products</span><span class=p>(</span><span class=n>category</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 패턴 3: 하이브리드 → 복합 + 단일
</span></span></span><span class=line><span class=cl><span class=c1>-- 쿼리 A: WHERE country=? AND city=?
</span></span></span><span class=line><span class=cl><span class=c1>-- 쿼리 B: WHERE city=?
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_country_city</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>users</span><span class=p>(</span><span class=n>country</span><span class=p>,</span><span class=w> </span><span class=n>city</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_city</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>users</span><span class=p>(</span><span class=n>city</span><span class=p>);</span><span class=w> </span><span class=c1>-- city만 조회 지원
</span></span></span></code></pre></td></tr></table></div></div><p><strong>트레이드오프 4: 클러스터드 vs 논클러스터드 인덱스</strong></p><p><strong>특성 비교</strong>:</p><table><thead><tr><th>특성</th><th>클러스터드</th><th>논클러스터드</th></tr></thead><tbody><tr><td><strong>테이블당 개수</strong></td><td>1개만</td><td>여러 개</td></tr><tr><td><strong>데이터 정렬</strong></td><td>물리적 정렬</td><td>논리적 정렬</td></tr><tr><td><strong>범위 검색</strong></td><td>매우 빠름</td><td>보통</td></tr><tr><td><strong>포인터 구조</strong></td><td>데이터 자체</td><td>별도 포인터</td></tr><tr><td><strong>저장 공간</strong></td><td>테이블=인덱스</td><td>추가 공간</td></tr><tr><td><strong>INSERT 성능</strong></td><td>느림 (정렬 유지)</td><td>빠름</td></tr><tr><td><strong>재구성 영향</strong></td><td>전체 테이블</td><td>인덱스만</td></tr></tbody></table><p><strong>선택 가이드라인</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-136-1><a class=lnlinks href=#hl-136-1> 1</a>
</span><span class=lnt id=hl-136-2><a class=lnlinks href=#hl-136-2> 2</a>
</span><span class=lnt id=hl-136-3><a class=lnlinks href=#hl-136-3> 3</a>
</span><span class=lnt id=hl-136-4><a class=lnlinks href=#hl-136-4> 4</a>
</span><span class=lnt id=hl-136-5><a class=lnlinks href=#hl-136-5> 5</a>
</span><span class=lnt id=hl-136-6><a class=lnlinks href=#hl-136-6> 6</a>
</span><span class=lnt id=hl-136-7><a class=lnlinks href=#hl-136-7> 7</a>
</span><span class=lnt id=hl-136-8><a class=lnlinks href=#hl-136-8> 8</a>
</span><span class=lnt id=hl-136-9><a class=lnlinks href=#hl-136-9> 9</a>
</span><span class=lnt id=hl-136-10><a class=lnlinks href=#hl-136-10>10</a>
</span><span class=lnt id=hl-136-11><a class=lnlinks href=#hl-136-11>11</a>
</span><span class=lnt id=hl-136-12><a class=lnlinks href=#hl-136-12>12</a>
</span><span class=lnt id=hl-136-13><a class=lnlinks href=#hl-136-13>13</a>
</span><span class=lnt id=hl-136-14><a class=lnlinks href=#hl-136-14>14</a>
</span><span class=lnt id=hl-136-15><a class=lnlinks href=#hl-136-15>15</a>
</span><span class=lnt id=hl-136-16><a class=lnlinks href=#hl-136-16>16</a>
</span><span class=lnt id=hl-136-17><a class=lnlinks href=#hl-136-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>클러스터드 인덱스 선택 시:
</span></span><span class=line><span class=cl>✓ 범위 검색이 매우 빈번한 컬럼
</span></span><span class=line><span class=cl>✓ GROUP BY, ORDER BY 자주 사용
</span></span><span class=line><span class=cl>✓ 순차 증가 키 (성능 좋음)
</span></span><span class=line><span class=cl>✓ 주로 읽기 중심 워크로드
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>예: PRIMARY KEY on (order_date)
</span></span><span class=line><span class=cl>→ 날짜별 조회, 집계 쿼리 최적
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>논클러스터드 인덱스 선택 시:
</span></span><span class=line><span class=cl>✓ 포인트 검색(등가 조건)
</span></span><span class=line><span class=cl>✓ 여러 검색 경로 필요
</span></span><span class=line><span class=cl>✓ 쓰기 빈번한 환경
</span></span><span class=line><span class=cl>✓ 저선택도 컬럼도 인덱싱 필요
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>예: INDEX on (user_email)
</span></span><span class=line><span class=cl>→ 로그인, 이메일 검색
</span></span></code></pre></td></tr></table></div></div><p><strong>트레이드오프 5: 실시간 갱신 vs 배치 갱신</strong></p><p><strong>전략 비교</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-137-1><a class=lnlinks href=#hl-137-1> 1</a>
</span><span class=lnt id=hl-137-2><a class=lnlinks href=#hl-137-2> 2</a>
</span><span class=lnt id=hl-137-3><a class=lnlinks href=#hl-137-3> 3</a>
</span><span class=lnt id=hl-137-4><a class=lnlinks href=#hl-137-4> 4</a>
</span><span class=lnt id=hl-137-5><a class=lnlinks href=#hl-137-5> 5</a>
</span><span class=lnt id=hl-137-6><a class=lnlinks href=#hl-137-6> 6</a>
</span><span class=lnt id=hl-137-7><a class=lnlinks href=#hl-137-7> 7</a>
</span><span class=lnt id=hl-137-8><a class=lnlinks href=#hl-137-8> 8</a>
</span><span class=lnt id=hl-137-9><a class=lnlinks href=#hl-137-9> 9</a>
</span><span class=lnt id=hl-137-10><a class=lnlinks href=#hl-137-10>10</a>
</span><span class=lnt id=hl-137-11><a class=lnlinks href=#hl-137-11>11</a>
</span><span class=lnt id=hl-137-12><a class=lnlinks href=#hl-137-12>12</a>
</span><span class=lnt id=hl-137-13><a class=lnlinks href=#hl-137-13>13</a>
</span><span class=lnt id=hl-137-14><a class=lnlinks href=#hl-137-14>14</a>
</span><span class=lnt id=hl-137-15><a class=lnlinks href=#hl-137-15>15</a>
</span><span class=lnt id=hl-137-16><a class=lnlinks href=#hl-137-16>16</a>
</span><span class=lnt id=hl-137-17><a class=lnlinks href=#hl-137-17>17</a>
</span><span class=lnt id=hl-137-18><a class=lnlinks href=#hl-137-18>18</a>
</span><span class=lnt id=hl-137-19><a class=lnlinks href=#hl-137-19>19</a>
</span><span class=lnt id=hl-137-20><a class=lnlinks href=#hl-137-20>20</a>
</span><span class=lnt id=hl-137-21><a class=lnlinks href=#hl-137-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>실시간 인덱스 갱신:
</span></span><span class=line><span class=cl>├─ 장점:
</span></span><span class=line><span class=cl>│   ├─ 즉시 검색 가능
</span></span><span class=line><span class=cl>│   ├─ 데이터 일관성 보장
</span></span><span class=line><span class=cl>│   └─ 구현 단순
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>└─ 단점:
</span></span><span class=line><span class=cl>    ├─ 각 쓰기마다 오버헤드
</span></span><span class=line><span class=cl>    ├─ 동시성 경합
</span></span><span class=line><span class=cl>    └─ 예측 불가능한 지연
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>배치 인덱스 갱신:
</span></span><span class=line><span class=cl>├─ 장점:
</span></span><span class=line><span class=cl>│   ├─ 쓰기 처리량 높음
</span></span><span class=line><span class=cl>│   ├─ 효율적 재구성
</span></span><span class=line><span class=cl>│   └─ 예측 가능한 성능
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>└─ 단점:
</span></span><span class=line><span class=cl>    ├─ 검색 지연 (staleness)
</span></span><span class=line><span class=cl>    ├─ 복잡한 동기화
</span></span><span class=line><span class=cl>    └─ 추가 인프라 필요
</span></span></code></pre></td></tr></table></div></div><p><strong>하이브리드 접근</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-138-1><a class=lnlinks href=#hl-138-1> 1</a>
</span><span class=lnt id=hl-138-2><a class=lnlinks href=#hl-138-2> 2</a>
</span><span class=lnt id=hl-138-3><a class=lnlinks href=#hl-138-3> 3</a>
</span><span class=lnt id=hl-138-4><a class=lnlinks href=#hl-138-4> 4</a>
</span><span class=lnt id=hl-138-5><a class=lnlinks href=#hl-138-5> 5</a>
</span><span class=lnt id=hl-138-6><a class=lnlinks href=#hl-138-6> 6</a>
</span><span class=lnt id=hl-138-7><a class=lnlinks href=#hl-138-7> 7</a>
</span><span class=lnt id=hl-138-8><a class=lnlinks href=#hl-138-8> 8</a>
</span><span class=lnt id=hl-138-9><a class=lnlinks href=#hl-138-9> 9</a>
</span><span class=lnt id=hl-138-10><a class=lnlinks href=#hl-138-10>10</a>
</span><span class=lnt id=hl-138-11><a class=lnlinks href=#hl-138-11>11</a>
</span><span class=lnt id=hl-138-12><a class=lnlinks href=#hl-138-12>12</a>
</span><span class=lnt id=hl-138-13><a class=lnlinks href=#hl-138-13>13</a>
</span><span class=lnt id=hl-138-14><a class=lnlinks href=#hl-138-14>14</a>
</span><span class=lnt id=hl-138-15><a class=lnlinks href=#hl-138-15>15</a>
</span><span class=lnt id=hl-138-16><a class=lnlinks href=#hl-138-16>16</a>
</span><span class=lnt id=hl-138-17><a class=lnlinks href=#hl-138-17>17</a>
</span><span class=lnt id=hl-138-18><a class=lnlinks href=#hl-138-18>18</a>
</span><span class=lnt id=hl-138-19><a class=lnlinks href=#hl-138-19>19</a>
</span><span class=lnt id=hl-138-20><a class=lnlinks href=#hl-138-20>20</a>
</span><span class=lnt id=hl-138-21><a class=lnlinks href=#hl-138-21>21</a>
</span><span class=lnt id=hl-138-22><a class=lnlinks href=#hl-138-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>HybridIndexStrategy</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    Delta + Base 인덱스 전략
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>base_index</span> <span class=o>=</span> <span class=n>BTreeIndex</span><span class=p>()</span>      <span class=c1># 대용량, 주기적 재구성</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>delta_index</span> <span class=o>=</span> <span class=n>LSMTreeIndex</span><span class=p>()</span>   <span class=c1># 최근 변경, 실시간 갱신</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. Delta 인덱스 먼저 검색 (최신 데이터)</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>delta_index</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>result</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. Base 인덱스 검색</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>base_index</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>merge_periodically</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 주기적으로 Delta → Base 병합</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>delta_index</span><span class=o>.</span><span class=n>size</span><span class=p>()</span> <span class=o>&gt;</span> <span class=n>THRESHOLD</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>base_index</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>delta_index</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>delta_index</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>적용 시나리오</strong>:</p><table><thead><tr><th>시나리오</th><th>권장 전략</th><th>이유</th></tr></thead><tbody><tr><td><strong>금융 거래</strong></td><td>실시간</td><td>정확성 최우선, 즉시 조회 필요</td></tr><tr><td><strong>로그 수집</strong></td><td>배치</td><td>대량 데이터, 약간의 지연 허용</td></tr><tr><td><strong>검색 엔진</strong></td><td>하이브리드</td><td>최신성 + 처리량 균형</td></tr><tr><td><strong>분석 시스템</strong></td><td>배치</td><td>집계 중심, 실시간 불필요</td></tr><tr><td><strong>전자상거래</strong></td><td>실시간</td><td>재고 정확성, 주문 즉시 반영</td></tr></tbody></table><h4 id=34-적용-적합성-평가-1>3.4 적용 적합성 평가<a hidden class=anchor aria-hidden=true href=#34-적용-적합성-평가-1>#</a></h4><p><strong>워크로드 유형별 적합성</strong></p><p><strong>OLTP (Online Transaction Processing)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-139-1><a class=lnlinks href=#hl-139-1> 1</a>
</span><span class=lnt id=hl-139-2><a class=lnlinks href=#hl-139-2> 2</a>
</span><span class=lnt id=hl-139-3><a class=lnlinks href=#hl-139-3> 3</a>
</span><span class=lnt id=hl-139-4><a class=lnlinks href=#hl-139-4> 4</a>
</span><span class=lnt id=hl-139-5><a class=lnlinks href=#hl-139-5> 5</a>
</span><span class=lnt id=hl-139-6><a class=lnlinks href=#hl-139-6> 6</a>
</span><span class=lnt id=hl-139-7><a class=lnlinks href=#hl-139-7> 7</a>
</span><span class=lnt id=hl-139-8><a class=lnlinks href=#hl-139-8> 8</a>
</span><span class=lnt id=hl-139-9><a class=lnlinks href=#hl-139-9> 9</a>
</span><span class=lnt id=hl-139-10><a class=lnlinks href=#hl-139-10>10</a>
</span><span class=lnt id=hl-139-11><a class=lnlinks href=#hl-139-11>11</a>
</span><span class=lnt id=hl-139-12><a class=lnlinks href=#hl-139-12>12</a>
</span><span class=lnt id=hl-139-13><a class=lnlinks href=#hl-139-13>13</a>
</span><span class=lnt id=hl-139-14><a class=lnlinks href=#hl-139-14>14</a>
</span><span class=lnt id=hl-139-15><a class=lnlinks href=#hl-139-15>15</a>
</span><span class=lnt id=hl-139-16><a class=lnlinks href=#hl-139-16>16</a>
</span><span class=lnt id=hl-139-17><a class=lnlinks href=#hl-139-17>17</a>
</span><span class=lnt id=hl-139-18><a class=lnlinks href=#hl-139-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>특성:
</span></span><span class=line><span class=cl>├─ 짧은 트랜잭션
</span></span><span class=line><span class=cl>├─ 포인트 쿼리 중심
</span></span><span class=line><span class=cl>├─ 높은 동시성
</span></span><span class=line><span class=cl>└─ 읽기/쓰기 혼합
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>적합한 인덱스 전략:
</span></span><span class=line><span class=cl>✓ B-Tree 인덱스 (Primary/Foreign Key)
</span></span><span class=line><span class=cl>✓ Hash 인덱스 (등가 조건)
</span></span><span class=line><span class=cl>✓ 최소한의 인덱스 (쓰기 부담 최소화)
</span></span><span class=line><span class=cl>✓ 커버링 인덱스 (핫 쿼리)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>회피 전략:
</span></span><span class=line><span class=cl>✗ 과도한 복합 인덱스
</span></span><span class=line><span class=cl>✗ Full-Text 인덱스 (느린 갱신)
</span></span><span class=line><span class=cl>✗ 비트맵 인덱스 (쓰기 비효율)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>적합도: ⭐⭐⭐⭐⭐
</span></span></code></pre></td></tr></table></div></div><p><strong>OLAP (Online Analytical Processing)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-140-1><a class=lnlinks href=#hl-140-1> 1</a>
</span><span class=lnt id=hl-140-2><a class=lnlinks href=#hl-140-2> 2</a>
</span><span class=lnt id=hl-140-3><a class=lnlinks href=#hl-140-3> 3</a>
</span><span class=lnt id=hl-140-4><a class=lnlinks href=#hl-140-4> 4</a>
</span><span class=lnt id=hl-140-5><a class=lnlinks href=#hl-140-5> 5</a>
</span><span class=lnt id=hl-140-6><a class=lnlinks href=#hl-140-6> 6</a>
</span><span class=lnt id=hl-140-7><a class=lnlinks href=#hl-140-7> 7</a>
</span><span class=lnt id=hl-140-8><a class=lnlinks href=#hl-140-8> 8</a>
</span><span class=lnt id=hl-140-9><a class=lnlinks href=#hl-140-9> 9</a>
</span><span class=lnt id=hl-140-10><a class=lnlinks href=#hl-140-10>10</a>
</span><span class=lnt id=hl-140-11><a class=lnlinks href=#hl-140-11>11</a>
</span><span class=lnt id=hl-140-12><a class=lnlinks href=#hl-140-12>12</a>
</span><span class=lnt id=hl-140-13><a class=lnlinks href=#hl-140-13>13</a>
</span><span class=lnt id=hl-140-14><a class=lnlinks href=#hl-140-14>14</a>
</span><span class=lnt id=hl-140-15><a class=lnlinks href=#hl-140-15>15</a>
</span><span class=lnt id=hl-140-16><a class=lnlinks href=#hl-140-16>16</a>
</span><span class=lnt id=hl-140-17><a class=lnlinks href=#hl-140-17>17</a>
</span><span class=lnt id=hl-140-18><a class=lnlinks href=#hl-140-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>특성:
</span></span><span class=line><span class=cl>├─ 복잡한 집계 쿼리
</span></span><span class=line><span class=cl>├─ 범위 스캔 빈번
</span></span><span class=line><span class=cl>├─ 대량 데이터 처리
</span></span><span class=line><span class=cl>└─ 읽기 중심 (쓰기 배치)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>적합한 인덱스 전략:
</span></span><span class=line><span class=cl>✓ Columnstore 인덱스 (집계 최적)
</span></span><span class=line><span class=cl>✓ Bitmap 인덱스 (저카디널리티)
</span></span><span class=line><span class=cl>✓ 파티션 + 로컬 인덱스
</span></span><span class=line><span class=cl>✓ 다양한 복합 인덱스
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>최적화 기법:
</span></span><span class=line><span class=cl>✓ 인덱스된 뷰 (사전 집계)
</span></span><span class=line><span class=cl>✓ 압축 인덱스 (공간 절약)
</span></span><span class=line><span class=cl>✓ 병렬 인덱스 스캔
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>적합도: ⭐⭐⭐⭐⭐
</span></span></code></pre></td></tr></table></div></div><p><strong>실시간 분석 (HTAP)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-141-1><a class=lnlinks href=#hl-141-1> 1</a>
</span><span class=lnt id=hl-141-2><a class=lnlinks href=#hl-141-2> 2</a>
</span><span class=lnt id=hl-141-3><a class=lnlinks href=#hl-141-3> 3</a>
</span><span class=lnt id=hl-141-4><a class=lnlinks href=#hl-141-4> 4</a>
</span><span class=lnt id=hl-141-5><a class=lnlinks href=#hl-141-5> 5</a>
</span><span class=lnt id=hl-141-6><a class=lnlinks href=#hl-141-6> 6</a>
</span><span class=lnt id=hl-141-7><a class=lnlinks href=#hl-141-7> 7</a>
</span><span class=lnt id=hl-141-8><a class=lnlinks href=#hl-141-8> 8</a>
</span><span class=lnt id=hl-141-9><a class=lnlinks href=#hl-141-9> 9</a>
</span><span class=lnt id=hl-141-10><a class=lnlinks href=#hl-141-10>10</a>
</span><span class=lnt id=hl-141-11><a class=lnlinks href=#hl-141-11>11</a>
</span><span class=lnt id=hl-141-12><a class=lnlinks href=#hl-141-12>12</a>
</span><span class=lnt id=hl-141-13><a class=lnlinks href=#hl-141-13>13</a>
</span><span class=lnt id=hl-141-14><a class=lnlinks href=#hl-141-14>14</a>
</span><span class=lnt id=hl-141-15><a class=lnlinks href=#hl-141-15>15</a>
</span><span class=lnt id=hl-141-16><a class=lnlinks href=#hl-141-16>16</a>
</span><span class=lnt id=hl-141-17><a class=lnlinks href=#hl-141-17>17</a>
</span><span class=lnt id=hl-141-18><a class=lnlinks href=#hl-141-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>특성:
</span></span><span class=line><span class=cl>├─ OLTP + OLAP 혼합
</span></span><span class=line><span class=cl>├─ 실시간 대시보드
</span></span><span class=line><span class=cl>├─ 트랜잭션 + 분석
</span></span><span class=line><span class=cl>└─ 높은 성능 요구
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>하이브리드 전략:
</span></span><span class=line><span class=cl>✓ Row-Store: B-Tree (트랜잭션)
</span></span><span class=line><span class=cl>✓ Column-Store: Columnstore (분석)
</span></span><span class=line><span class=cl>✓ 메모리 인덱스 (속도)
</span></span><span class=line><span class=cl>✓ 분리된 워크로드 처리
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>기술 선택:
</span></span><span class=line><span class=cl>- MemSQL, SAP HANA (통합)
</span></span><span class=line><span class=cl>- PostgreSQL + Citus (분산)
</span></span><span class=line><span class=cl>- MySQL + TiDB (HTAP)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>적합도: ⭐⭐⭐⭐ (기술 성숙도 따라)
</span></span></code></pre></td></tr></table></div></div><p><strong>데이터 특성별 적합성</strong></p><table><thead><tr><th>데이터 특성</th><th>적합 인덱스</th><th>부적합 인덱스</th><th>이유</th></tr></thead><tbody><tr><td><strong>고유값 많음 (고카디널리티)</strong></td><td>B-Tree, Hash</td><td>Bitmap</td><td>B-Tree는 선택도 높을 때 효율적, Bitmap은 메모리 낭비</td></tr><tr><td><strong>고유값 적음 (저카디널리티)</strong></td><td>Bitmap, Partial</td><td>B-Tree 단독</td><td>Bitmap은 비트 연산 효율적, B-Tree는 중복 많아 비효율</td></tr><tr><td><strong>시계열 데이터</strong></td><td>Partition + B-Tree</td><td>단일 B-Tree</td><td>파티션 프루닝으로 검색 범위 축소, 오래된 데이터 별도 관리</td></tr><tr><td><strong>텍스트 데이터</strong></td><td>Full-Text, Prefix</td><td>B-Tree</td><td>부분 문자열 검색 지원, LIKE &lsquo;%&mldr;%&rsquo; 처리 가능</td></tr><tr><td><strong>공간 데이터 (위치)</strong></td><td>R-Tree, Geospatial</td><td>B-Tree</td><td>다차원 범위 검색, 공간 연산 최적화</td></tr><tr><td><strong>JSON/반구조화</strong></td><td>GIN, GiST</td><td>일반 B-Tree</td><td>중첩 구조 탐색, 동적 키 지원</td></tr><tr><td><strong>대용량 BLOB</strong></td><td>별도 저장 + 메타 인덱스</td><td>직접 인덱싱</td><td>크기 제약, 비교 불가, 별도 관리 필요</td></tr></tbody></table><p><strong>쿼리 패턴별 적합성</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-142-1><a class=lnlinks href=#hl-142-1> 1</a>
</span><span class=lnt id=hl-142-2><a class=lnlinks href=#hl-142-2> 2</a>
</span><span class=lnt id=hl-142-3><a class=lnlinks href=#hl-142-3> 3</a>
</span><span class=lnt id=hl-142-4><a class=lnlinks href=#hl-142-4> 4</a>
</span><span class=lnt id=hl-142-5><a class=lnlinks href=#hl-142-5> 5</a>
</span><span class=lnt id=hl-142-6><a class=lnlinks href=#hl-142-6> 6</a>
</span><span class=lnt id=hl-142-7><a class=lnlinks href=#hl-142-7> 7</a>
</span><span class=lnt id=hl-142-8><a class=lnlinks href=#hl-142-8> 8</a>
</span><span class=lnt id=hl-142-9><a class=lnlinks href=#hl-142-9> 9</a>
</span><span class=lnt id=hl-142-10><a class=lnlinks href=#hl-142-10>10</a>
</span><span class=lnt id=hl-142-11><a class=lnlinks href=#hl-142-11>11</a>
</span><span class=lnt id=hl-142-12><a class=lnlinks href=#hl-142-12>12</a>
</span><span class=lnt id=hl-142-13><a class=lnlinks href=#hl-142-13>13</a>
</span><span class=lnt id=hl-142-14><a class=lnlinks href=#hl-142-14>14</a>
</span><span class=lnt id=hl-142-15><a class=lnlinks href=#hl-142-15>15</a>
</span><span class=lnt id=hl-142-16><a class=lnlinks href=#hl-142-16>16</a>
</span><span class=lnt id=hl-142-17><a class=lnlinks href=#hl-142-17>17</a>
</span><span class=lnt id=hl-142-18><a class=lnlinks href=#hl-142-18>18</a>
</span><span class=lnt id=hl-142-19><a class=lnlinks href=#hl-142-19>19</a>
</span><span class=lnt id=hl-142-20><a class=lnlinks href=#hl-142-20>20</a>
</span><span class=lnt id=hl-142-21><a class=lnlinks href=#hl-142-21>21</a>
</span><span class=lnt id=hl-142-22><a class=lnlinks href=#hl-142-22>22</a>
</span><span class=lnt id=hl-142-23><a class=lnlinks href=#hl-142-23>23</a>
</span><span class=lnt id=hl-142-24><a class=lnlinks href=#hl-142-24>24</a>
</span><span class=lnt id=hl-142-25><a class=lnlinks href=#hl-142-25>25</a>
</span><span class=lnt id=hl-142-26><a class=lnlinks href=#hl-142-26>26</a>
</span><span class=lnt id=hl-142-27><a class=lnlinks href=#hl-142-27>27</a>
</span><span class=lnt id=hl-142-28><a class=lnlinks href=#hl-142-28>28</a>
</span><span class=lnt id=hl-142-29><a class=lnlinks href=#hl-142-29>29</a>
</span><span class=lnt id=hl-142-30><a class=lnlinks href=#hl-142-30>30</a>
</span><span class=lnt id=hl-142-31><a class=lnlinks href=#hl-142-31>31</a>
</span><span class=lnt id=hl-142-32><a class=lnlinks href=#hl-142-32>32</a>
</span><span class=lnt id=hl-142-33><a class=lnlinks href=#hl-142-33>33</a>
</span><span class=lnt id=hl-142-34><a class=lnlinks href=#hl-142-34>34</a>
</span><span class=lnt id=hl-142-35><a class=lnlinks href=#hl-142-35>35</a>
</span><span class=lnt id=hl-142-36><a class=lnlinks href=#hl-142-36>36</a>
</span><span class=lnt id=hl-142-37><a class=lnlinks href=#hl-142-37>37</a>
</span><span class=lnt id=hl-142-38><a class=lnlinks href=#hl-142-38>38</a>
</span><span class=lnt id=hl-142-39><a class=lnlinks href=#hl-142-39>39</a>
</span><span class=lnt id=hl-142-40><a class=lnlinks href=#hl-142-40>40</a>
</span><span class=lnt id=hl-142-41><a class=lnlinks href=#hl-142-41>41</a>
</span><span class=lnt id=hl-142-42><a class=lnlinks href=#hl-142-42>42</a>
</span><span class=lnt id=hl-142-43><a class=lnlinks href=#hl-142-43>43</a>
</span><span class=lnt id=hl-142-44><a class=lnlinks href=#hl-142-44>44</a>
</span><span class=lnt id=hl-142-45><a class=lnlinks href=#hl-142-45>45</a>
</span><span class=lnt id=hl-142-46><a class=lnlinks href=#hl-142-46>46</a>
</span><span class=lnt id=hl-142-47><a class=lnlinks href=#hl-142-47>47</a>
</span><span class=lnt id=hl-142-48><a class=lnlinks href=#hl-142-48>48</a>
</span><span class=lnt id=hl-142-49><a class=lnlinks href=#hl-142-49>49</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 패턴 1: 등가 검색
</span></span></span><span class=line><span class=cl><span class=c1>-- WHERE column = value
</span></span></span><span class=line><span class=cl><span class=c1>-- 최적: Hash Index (O(1))
</span></span></span><span class=line><span class=cl><span class=c1>-- 차선: B-Tree Index (O(log n))
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_hash</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>HASH</span><span class=w> </span><span class=p>(</span><span class=k>column</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 패턴 2: 범위 검색
</span></span></span><span class=line><span class=cl><span class=c1>-- WHERE column BETWEEN v1 AND v2
</span></span></span><span class=line><span class=cl><span class=c1>-- 최적: B-Tree Index
</span></span></span><span class=line><span class=cl><span class=c1>-- 부적합: Hash Index (범위 불가)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_btree</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table</span><span class=p>(</span><span class=k>column</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 패턴 3: 패턴 매칭
</span></span></span><span class=line><span class=cl><span class=c1>-- WHERE column LIKE &#39;prefix%&#39;
</span></span></span><span class=line><span class=cl><span class=c1>-- 최적: B-Tree (prefix 검색 가능)
</span></span></span><span class=line><span class=cl><span class=c1>-- 부적합: Hash (LIKE 불가)
</span></span></span><span class=line><span class=cl><span class=c1>-- WHERE column LIKE &#39;%suffix&#39;
</span></span></span><span class=line><span class=cl><span class=c1>-- 최적: Full-Text Index, Trigram
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_trigram</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>GIN</span><span class=p>(</span><span class=k>column</span><span class=w> </span><span class=n>gin_trgm_ops</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 패턴 4: 다중 조건 AND
</span></span></span><span class=line><span class=cl><span class=c1>-- WHERE a=? AND b=? AND c=?
</span></span></span><span class=line><span class=cl><span class=c1>-- 최적: 복합 인덱스 (a, b, c)
</span></span></span><span class=line><span class=cl><span class=c1>-- 차선: Index Merge (개별 인덱스)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_composite</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table</span><span class=p>(</span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=k>c</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 패턴 5: 다중 조건 OR
</span></span></span><span class=line><span class=cl><span class=c1>-- WHERE a=? OR b=?
</span></span></span><span class=line><span class=cl><span class=c1>-- 최적: Bitmap Index Scan
</span></span></span><span class=line><span class=cl><span class=c1>-- 차선: 두 개별 인덱스 UNION
</span></span></span><span class=line><span class=cl><span class=c1>-- Bitmap 지원 시:
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=n>BITMAP</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_a</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table</span><span class=p>(</span><span class=n>a</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=n>BITMAP</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_b</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table</span><span class=p>(</span><span class=n>b</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 패턴 6: 정렬
</span></span></span><span class=line><span class=cl><span class=c1>-- ORDER BY column
</span></span></span><span class=line><span class=cl><span class=c1>-- 최적: 해당 컬럼 B-Tree Index
</span></span></span><span class=line><span class=cl><span class=c1>-- 효과: 정렬 단계 생략
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_order</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table</span><span class=p>(</span><span class=k>column</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 패턴 7: 집계
</span></span></span><span class=line><span class=cl><span class=c1>-- SELECT COUNT(*), SUM(value) WHERE condition
</span></span></span><span class=line><span class=cl><span class=c1>-- 최적: 커버링 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_covering</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table</span><span class=p>(</span><span class=n>condition_col</span><span class=p>)</span><span class=w> </span><span class=n>INCLUDE</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 패턴 8: 조인
</span></span></span><span class=line><span class=cl><span class=c1>-- FROM t1 JOIN t2 ON t1.id = t2.fk
</span></span></span><span class=line><span class=cl><span class=c1>-- 최적: t2.fk에 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_fk</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>t2</span><span class=p>(</span><span class=n>fk</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>시스템 환경별 적합성</strong></p><p><strong>클라우드 환경</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-143-1><a class=lnlinks href=#hl-143-1> 1</a>
</span><span class=lnt id=hl-143-2><a class=lnlinks href=#hl-143-2> 2</a>
</span><span class=lnt id=hl-143-3><a class=lnlinks href=#hl-143-3> 3</a>
</span><span class=lnt id=hl-143-4><a class=lnlinks href=#hl-143-4> 4</a>
</span><span class=lnt id=hl-143-5><a class=lnlinks href=#hl-143-5> 5</a>
</span><span class=lnt id=hl-143-6><a class=lnlinks href=#hl-143-6> 6</a>
</span><span class=lnt id=hl-143-7><a class=lnlinks href=#hl-143-7> 7</a>
</span><span class=lnt id=hl-143-8><a class=lnlinks href=#hl-143-8> 8</a>
</span><span class=lnt id=hl-143-9><a class=lnlinks href=#hl-143-9> 9</a>
</span><span class=lnt id=hl-143-10><a class=lnlinks href=#hl-143-10>10</a>
</span><span class=lnt id=hl-143-11><a class=lnlinks href=#hl-143-11>11</a>
</span><span class=lnt id=hl-143-12><a class=lnlinks href=#hl-143-12>12</a>
</span><span class=lnt id=hl-143-13><a class=lnlinks href=#hl-143-13>13</a>
</span><span class=lnt id=hl-143-14><a class=lnlinks href=#hl-143-14>14</a>
</span><span class=lnt id=hl-143-15><a class=lnlinks href=#hl-143-15>15</a>
</span><span class=lnt id=hl-143-16><a class=lnlinks href=#hl-143-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>고려사항:
</span></span><span class=line><span class=cl>├─ 네트워크 지연 (multi-AZ)
</span></span><span class=line><span class=cl>├─ 스토리지 계층 (EBS, S3)
</span></span><span class=line><span class=cl>├─ 관리형 서비스 제약
</span></span><span class=line><span class=cl>└─ 비용 최적화
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>권장 전략:
</span></span><span class=line><span class=cl>✓ 압축 인덱스 (스토리지 비용)
</span></span><span class=line><span class=cl>✓ 인메모리 캐싱 강화
</span></span><span class=line><span class=cl>✓ 파티셔닝 (병렬 처리)
</span></span><span class=line><span class=cl>✓ 읽기 복제본 + 인덱스 분산
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>클라우드별 최적화:
</span></span><span class=line><span class=cl>- AWS RDS: Read Replica, Aurora 클러스터
</span></span><span class=line><span class=cl>- GCP Cloud SQL: 고성능 SSD, 자동 백업
</span></span><span class=line><span class=cl>- Azure SQL: Hyperscale, 컬럼스토어
</span></span></code></pre></td></tr></table></div></div><p><strong>온프레미스 환경</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-144-1><a class=lnlinks href=#hl-144-1> 1</a>
</span><span class=lnt id=hl-144-2><a class=lnlinks href=#hl-144-2> 2</a>
</span><span class=lnt id=hl-144-3><a class=lnlinks href=#hl-144-3> 3</a>
</span><span class=lnt id=hl-144-4><a class=lnlinks href=#hl-144-4> 4</a>
</span><span class=lnt id=hl-144-5><a class=lnlinks href=#hl-144-5> 5</a>
</span><span class=lnt id=hl-144-6><a class=lnlinks href=#hl-144-6> 6</a>
</span><span class=lnt id=hl-144-7><a class=lnlinks href=#hl-144-7> 7</a>
</span><span class=lnt id=hl-144-8><a class=lnlinks href=#hl-144-8> 8</a>
</span><span class=lnt id=hl-144-9><a class=lnlinks href=#hl-144-9> 9</a>
</span><span class=lnt id=hl-144-10><a class=lnlinks href=#hl-144-10>10</a>
</span><span class=lnt id=hl-144-11><a class=lnlinks href=#hl-144-11>11</a>
</span><span class=lnt id=hl-144-12><a class=lnlinks href=#hl-144-12>12</a>
</span><span class=lnt id=hl-144-13><a class=lnlinks href=#hl-144-13>13</a>
</span><span class=lnt id=hl-144-14><a class=lnlinks href=#hl-144-14>14</a>
</span><span class=lnt id=hl-144-15><a class=lnlinks href=#hl-144-15>15</a>
</span><span class=lnt id=hl-144-16><a class=lnlinks href=#hl-144-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>유연성:
</span></span><span class=line><span class=cl>├─ 하드웨어 직접 제어
</span></span><span class=line><span class=cl>├─ 고급 옵션 활용
</span></span><span class=line><span class=cl>├─ 세밀한 튜닝
</span></span><span class=line><span class=cl>└─ 비용 예측 가능
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>권장 전략:
</span></span><span class=line><span class=cl>✓ NVMe SSD 활용 (저지연)
</span></span><span class=line><span class=cl>✓ NUMA 고려 인덱스 배치
</span></span><span class=line><span class=cl>✓ RAID 구성 최적화
</span></span><span class=line><span class=cl>✓ 메모리 극대화 (인덱스 상주)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>하드웨어 최적화:
</span></span><span class=line><span class=cl>- CPU: 높은 코어 클럭 (단일 쿼리)
</span></span><span class=line><span class=cl>- Memory: 큰 버퍼 풀 (인덱스 캐싱)
</span></span><span class=line><span class=cl>- Storage: NVMe RAID 0 (읽기 중심)
</span></span></code></pre></td></tr></table></div></div><p><strong>엣지/임베디드 환경</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-145-1><a class=lnlinks href=#hl-145-1> 1</a>
</span><span class=lnt id=hl-145-2><a class=lnlinks href=#hl-145-2> 2</a>
</span><span class=lnt id=hl-145-3><a class=lnlinks href=#hl-145-3> 3</a>
</span><span class=lnt id=hl-145-4><a class=lnlinks href=#hl-145-4> 4</a>
</span><span class=lnt id=hl-145-5><a class=lnlinks href=#hl-145-5> 5</a>
</span><span class=lnt id=hl-145-6><a class=lnlinks href=#hl-145-6> 6</a>
</span><span class=lnt id=hl-145-7><a class=lnlinks href=#hl-145-7> 7</a>
</span><span class=lnt id=hl-145-8><a class=lnlinks href=#hl-145-8> 8</a>
</span><span class=lnt id=hl-145-9><a class=lnlinks href=#hl-145-9> 9</a>
</span><span class=lnt id=hl-145-10><a class=lnlinks href=#hl-145-10>10</a>
</span><span class=lnt id=hl-145-11><a class=lnlinks href=#hl-145-11>11</a>
</span><span class=lnt id=hl-145-12><a class=lnlinks href=#hl-145-12>12</a>
</span><span class=lnt id=hl-145-13><a class=lnlinks href=#hl-145-13>13</a>
</span><span class=lnt id=hl-145-14><a class=lnlinks href=#hl-145-14>14</a>
</span><span class=lnt id=hl-145-15><a class=lnlinks href=#hl-145-15>15</a>
</span><span class=lnt id=hl-145-16><a class=lnlinks href=#hl-145-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>제약사항:
</span></span><span class=line><span class=cl>├─ 제한된 메모리 (&lt;1GB)
</span></span><span class=line><span class=cl>├─ 느린 스토리지
</span></span><span class=line><span class=cl>├─ 낮은 CPU 성능
</span></span><span class=line><span class=cl>└─ 배터리 제약 (모바일)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>적합 전략:
</span></span><span class=line><span class=cl>✓ 최소 인덱스 (필수만)
</span></span><span class=line><span class=cl>✓ 압축 인덱스 (메모리 절약)
</span></span><span class=line><span class=cl>✓ In-Memory DB (SQLite)
</span></span><span class=line><span class=cl>✓ 단순 구조 (B-Tree 기본)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>기술 선택:
</span></span><span class=line><span class=cl>- SQLite: 임베디드 최적
</span></span><span class=line><span class=cl>- RocksDB: 모바일 고성능
</span></span><span class=line><span class=cl>- LevelDB: 경량 key-value
</span></span></code></pre></td></tr></table></div></div><h4 id=35-복잡도-분석-및-이론적-한계-a형-특화>3.5 복잡도 분석 및 이론적 한계 (A형 특화)<a hidden class=anchor aria-hidden=true href=#35-복잡도-분석-및-이론적-한계-a형-특화>#</a></h4><p><strong>알고리즘 복잡도 종합</strong></p><table><thead><tr><th>연산</th><th>B-Tree</th><th>B+ Tree</th><th>Hash</th><th>Bitmap</th><th>R-Tree</th><th>Full-Text</th></tr></thead><tbody><tr><td><strong>점 검색</strong></td><td>O(log n)</td><td>O(log n)</td><td>O(1) 평균</td><td>O(k)</td><td>O(log n)</td><td>O(m log n)</td></tr><tr><td><strong>범위 검색</strong></td><td>O(log n + k)</td><td>O(log n + k)</td><td>N/A</td><td>O(k)</td><td>O(log n + k)</td><td>N/A</td></tr><tr><td><strong>삽입</strong></td><td>O(t log_t n)</td><td>O(t log_t n)</td><td>O(1) 평균</td><td>O(k)</td><td>O(log n)</td><td>O(m)</td></tr><tr><td><strong>삭제</strong></td><td>O(t log_t n)</td><td>O(t log_t n)</td><td>O(1) 평균</td><td>O(k)</td><td>O(log n)</td><td>O(m)</td></tr><tr><td><strong>공간</strong></td><td>Θ(n)</td><td>Θ(n)</td><td>Θ(n)</td><td>O(n × d)</td><td>Θ(n)</td><td>Θ(V)</td></tr></tbody></table><p><em>n: 레코드 수, k: 결과 수, t: 차수, m: 용어 수, d: 차원, V: 어휘 크기</em></p><p><strong>이론적 하한 (Lower Bounds)</strong></p><p><strong>비교 기반 인덱스</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-146-1><a class=lnlinks href=#hl-146-1>1</a>
</span><span class=lnt id=hl-146-2><a class=lnlinks href=#hl-146-2>2</a>
</span><span class=lnt id=hl-146-3><a class=lnlinks href=#hl-146-3>3</a>
</span><span class=lnt id=hl-146-4><a class=lnlinks href=#hl-146-4>4</a>
</span><span class=lnt id=hl-146-5><a class=lnlinks href=#hl-146-5>5</a>
</span><span class=lnt id=hl-146-6><a class=lnlinks href=#hl-146-6>6</a>
</span><span class=lnt id=hl-146-7><a class=lnlinks href=#hl-146-7>7</a>
</span><span class=lnt id=hl-146-8><a class=lnlinks href=#hl-146-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>정리: 비교 기반 자료구조는 Ω(log n) 검색 시간이 하한이다.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>증명 스케치:
</span></span><span class=line><span class=cl>1. n개 원소를 구별하려면 log₂ n 비트 정보 필요
</span></span><span class=line><span class=cl>2. 각 비교는 1비트 정보 제공 (&gt;, =, &lt;)
</span></span><span class=line><span class=cl>3. 따라서 최소 log₂ n 비교 필요
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>결론: B-Tree의 O(log n)은 점근적 최적
</span></span></code></pre></td></tr></table></div></div><p><strong>공간-시간 트레이드오프</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-147-1><a class=lnlinks href=#hl-147-1> 1</a>
</span><span class=lnt id=hl-147-2><a class=lnlinks href=#hl-147-2> 2</a>
</span><span class=lnt id=hl-147-3><a class=lnlinks href=#hl-147-3> 3</a>
</span><span class=lnt id=hl-147-4><a class=lnlinks href=#hl-147-4> 4</a>
</span><span class=lnt id=hl-147-5><a class=lnlinks href=#hl-147-5> 5</a>
</span><span class=lnt id=hl-147-6><a class=lnlinks href=#hl-147-6> 6</a>
</span><span class=lnt id=hl-147-7><a class=lnlinks href=#hl-147-7> 7</a>
</span><span class=lnt id=hl-147-8><a class=lnlinks href=#hl-147-8> 8</a>
</span><span class=lnt id=hl-147-9><a class=lnlinks href=#hl-147-9> 9</a>
</span><span class=lnt id=hl-147-10><a class=lnlinks href=#hl-147-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>정리: 검색 시간 t와 공간 s는 다음을 만족:
</span></span><span class=line><span class=cl>t × s = Ω(n)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>즉, 시간을 O(1)로 하려면 공간 Ω(n) 필요
</span></span><span class=line><span class=cl>(예: Hash Index)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>증명:
</span></span><span class=line><span class=cl>1. 각 쿼리는 최대 s개 위치 접근
</span></span><span class=line><span class=cl>2. n개 원소 구별하려면 ≥ n/s 쿼리 필요
</span></span><span class=line><span class=cl>3. t ≥ n/s → t × s ≥ n  ∎
</span></span></code></pre></td></tr></table></div></div><p><strong>차원의 저주 (Curse of Dimensionality)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-148-1><a class=lnlinks href=#hl-148-1> 1</a>
</span><span class=lnt id=hl-148-2><a class=lnlinks href=#hl-148-2> 2</a>
</span><span class=lnt id=hl-148-3><a class=lnlinks href=#hl-148-3> 3</a>
</span><span class=lnt id=hl-148-4><a class=lnlinks href=#hl-148-4> 4</a>
</span><span class=lnt id=hl-148-5><a class=lnlinks href=#hl-148-5> 5</a>
</span><span class=lnt id=hl-148-6><a class=lnlinks href=#hl-148-6> 6</a>
</span><span class=lnt id=hl-148-7><a class=lnlinks href=#hl-148-7> 7</a>
</span><span class=lnt id=hl-148-8><a class=lnlinks href=#hl-148-8> 8</a>
</span><span class=lnt id=hl-148-9><a class=lnlinks href=#hl-148-9> 9</a>
</span><span class=lnt id=hl-148-10><a class=lnlinks href=#hl-148-10>10</a>
</span><span class=lnt id=hl-148-11><a class=lnlinks href=#hl-148-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>다차원 인덱스 (R-Tree) 한계:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>차원 d에서:
</span></span><span class=line><span class=cl>- 공간 분할 효율: O(2^d) 영역 필요
</span></span><span class=line><span class=cl>- 범위 검색: O(n^(1-1/d) + k)
</span></span><span class=line><span class=cl>- 고차원(d &gt; 20): 거의 O(n) 성능
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>실무 영향:
</span></span><span class=line><span class=cl>- 저차원 (d ≤ 3): R-Tree 효과적 (GIS)
</span></span><span class=line><span class=cl>- 중차원 (3 &lt; d ≤ 10): 특수 기법 필요
</span></span><span class=line><span class=cl>- 고차원 (d &gt; 10): 차원 축소 또는 근사 검색
</span></span></code></pre></td></tr></table></div></div><p><strong>캐시 효율성 모델</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-149-1><a class=lnlinks href=#hl-149-1> 1</a>
</span><span class=lnt id=hl-149-2><a class=lnlinks href=#hl-149-2> 2</a>
</span><span class=lnt id=hl-149-3><a class=lnlinks href=#hl-149-3> 3</a>
</span><span class=lnt id=hl-149-4><a class=lnlinks href=#hl-149-4> 4</a>
</span><span class=lnt id=hl-149-5><a class=lnlinks href=#hl-149-5> 5</a>
</span><span class=lnt id=hl-149-6><a class=lnlinks href=#hl-149-6> 6</a>
</span><span class=lnt id=hl-149-7><a class=lnlinks href=#hl-149-7> 7</a>
</span><span class=lnt id=hl-149-8><a class=lnlinks href=#hl-149-8> 8</a>
</span><span class=lnt id=hl-149-9><a class=lnlinks href=#hl-149-9> 9</a>
</span><span class=lnt id=hl-149-10><a class=lnlinks href=#hl-149-10>10</a>
</span><span class=lnt id=hl-149-11><a class=lnlinks href=#hl-149-11>11</a>
</span><span class=lnt id=hl-149-12><a class=lnlinks href=#hl-149-12>12</a>
</span><span class=lnt id=hl-149-13><a class=lnlinks href=#hl-149-13>13</a>
</span><span class=lnt id=hl-149-14><a class=lnlinks href=#hl-149-14>14</a>
</span><span class=lnt id=hl-149-15><a class=lnlinks href=#hl-149-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>External Memory Model (Aggarwal &amp; Vitter):
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>파라미터:
</span></span><span class=line><span class=cl>- M: 메모리 크기
</span></span><span class=line><span class=cl>- B: 블록 크기
</span></span><span class=line><span class=cl>- N: 데이터 크기
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>B-Tree 분석:
</span></span><span class=line><span class=cl>- 최적 차수: B (블록당 B개 키)
</span></span><span class=line><span class=cl>- 높이: log_B(N/B)
</span></span><span class=line><span class=cl>- I/O 복잡도: O(log_B(N/B))
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Cache-Oblivious B-Tree:
</span></span><span class=line><span class=cl>- 파라미터 없이 캐시 최적
</span></span><span class=line><span class=cl>- 모든 메모리 계층에서 효율적
</span></span></code></pre></td></tr></table></div></div><p><strong>동시성 이론 한계</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-150-1><a class=lnlinks href=#hl-150-1> 1</a>
</span><span class=lnt id=hl-150-2><a class=lnlinks href=#hl-150-2> 2</a>
</span><span class=lnt id=hl-150-3><a class=lnlinks href=#hl-150-3> 3</a>
</span><span class=lnt id=hl-150-4><a class=lnlinks href=#hl-150-4> 4</a>
</span><span class=lnt id=hl-150-5><a class=lnlinks href=#hl-150-5> 5</a>
</span><span class=lnt id=hl-150-6><a class=lnlinks href=#hl-150-6> 6</a>
</span><span class=lnt id=hl-150-7><a class=lnlinks href=#hl-150-7> 7</a>
</span><span class=lnt id=hl-150-8><a class=lnlinks href=#hl-150-8> 8</a>
</span><span class=lnt id=hl-150-9><a class=lnlinks href=#hl-150-9> 9</a>
</span><span class=lnt id=hl-150-10><a class=lnlinks href=#hl-150-10>10</a>
</span><span class=lnt id=hl-150-11><a class=lnlinks href=#hl-150-11>11</a>
</span><span class=lnt id=hl-150-12><a class=lnlinks href=#hl-150-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>정리: 낙관적 동시성 제어는 충돌률에 비례해 성능 저하
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>충돌 확률:
</span></span><span class=line><span class=cl>P(conflict) ≈ (c × w) / n
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>c: 동시 트랜잭션 수
</span></span><span class=line><span class=cl>w: 트랜잭션 접근 범위
</span></span><span class=line><span class=cl>n: 전체 키 공간
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>결론:
</span></span><span class=line><span class=cl>- 핫스팟 있으면 충돌 급증
</span></span><span class=line><span class=cl>- 완화: 샤딩, 파티셔닝
</span></span></code></pre></td></tr></table></div></div><p>계속해서 Phase 4로 진행하겠습니다.</p><hr><h3 id=phase-4-구현-방법-및-분류-1>Phase 4: 구현 방법 및 분류<a hidden class=anchor aria-hidden=true href=#phase-4-구현-방법-및-분류-1>#</a></h3><h4 id=41-구현-방법-및-기법-1>4.1 구현 방법 및 기법<a hidden class=anchor aria-hidden=true href=#41-구현-방법-및-기법-1>#</a></h4><p><strong>B-Tree 인덱스 구현</strong></p><p><strong>정의</strong>: 균형 다진 탐색 트리로 모든 리프 노드가 동일한 깊이를 유지하는 디스크 지향 자료구조</p><p><strong>특징</strong>:</p><ul><li>자기 균형 (self-balancing) 속성</li><li>높은 팬아웃으로 트리 높이 최소화</li><li>페이지 단위 I/O 최적화</li></ul><p><strong>목적</strong>: 범위 검색, 정렬, 순차 접근이 필요한 쿼리 최적화</p><p><strong>사용 상황</strong>:</p><ul><li>범위 조건 (BETWEEN, >, &lt;)</li><li>ORDER BY, GROUP BY 절</li><li>조인 연산</li><li>고카디널리티 컬럼</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-151-1><a class=lnlinks href=#hl-151-1>  1</a>
</span><span class=lnt id=hl-151-2><a class=lnlinks href=#hl-151-2>  2</a>
</span><span class=lnt id=hl-151-3><a class=lnlinks href=#hl-151-3>  3</a>
</span><span class=lnt id=hl-151-4><a class=lnlinks href=#hl-151-4>  4</a>
</span><span class=lnt id=hl-151-5><a class=lnlinks href=#hl-151-5>  5</a>
</span><span class=lnt id=hl-151-6><a class=lnlinks href=#hl-151-6>  6</a>
</span><span class=lnt id=hl-151-7><a class=lnlinks href=#hl-151-7>  7</a>
</span><span class=lnt id=hl-151-8><a class=lnlinks href=#hl-151-8>  8</a>
</span><span class=lnt id=hl-151-9><a class=lnlinks href=#hl-151-9>  9</a>
</span><span class=lnt id=hl-151-10><a class=lnlinks href=#hl-151-10> 10</a>
</span><span class=lnt id=hl-151-11><a class=lnlinks href=#hl-151-11> 11</a>
</span><span class=lnt id=hl-151-12><a class=lnlinks href=#hl-151-12> 12</a>
</span><span class=lnt id=hl-151-13><a class=lnlinks href=#hl-151-13> 13</a>
</span><span class=lnt id=hl-151-14><a class=lnlinks href=#hl-151-14> 14</a>
</span><span class=lnt id=hl-151-15><a class=lnlinks href=#hl-151-15> 15</a>
</span><span class=lnt id=hl-151-16><a class=lnlinks href=#hl-151-16> 16</a>
</span><span class=lnt id=hl-151-17><a class=lnlinks href=#hl-151-17> 17</a>
</span><span class=lnt id=hl-151-18><a class=lnlinks href=#hl-151-18> 18</a>
</span><span class=lnt id=hl-151-19><a class=lnlinks href=#hl-151-19> 19</a>
</span><span class=lnt id=hl-151-20><a class=lnlinks href=#hl-151-20> 20</a>
</span><span class=lnt id=hl-151-21><a class=lnlinks href=#hl-151-21> 21</a>
</span><span class=lnt id=hl-151-22><a class=lnlinks href=#hl-151-22> 22</a>
</span><span class=lnt id=hl-151-23><a class=lnlinks href=#hl-151-23> 23</a>
</span><span class=lnt id=hl-151-24><a class=lnlinks href=#hl-151-24> 24</a>
</span><span class=lnt id=hl-151-25><a class=lnlinks href=#hl-151-25> 25</a>
</span><span class=lnt id=hl-151-26><a class=lnlinks href=#hl-151-26> 26</a>
</span><span class=lnt id=hl-151-27><a class=lnlinks href=#hl-151-27> 27</a>
</span><span class=lnt id=hl-151-28><a class=lnlinks href=#hl-151-28> 28</a>
</span><span class=lnt id=hl-151-29><a class=lnlinks href=#hl-151-29> 29</a>
</span><span class=lnt id=hl-151-30><a class=lnlinks href=#hl-151-30> 30</a>
</span><span class=lnt id=hl-151-31><a class=lnlinks href=#hl-151-31> 31</a>
</span><span class=lnt id=hl-151-32><a class=lnlinks href=#hl-151-32> 32</a>
</span><span class=lnt id=hl-151-33><a class=lnlinks href=#hl-151-33> 33</a>
</span><span class=lnt id=hl-151-34><a class=lnlinks href=#hl-151-34> 34</a>
</span><span class=lnt id=hl-151-35><a class=lnlinks href=#hl-151-35> 35</a>
</span><span class=lnt id=hl-151-36><a class=lnlinks href=#hl-151-36> 36</a>
</span><span class=lnt id=hl-151-37><a class=lnlinks href=#hl-151-37> 37</a>
</span><span class=lnt id=hl-151-38><a class=lnlinks href=#hl-151-38> 38</a>
</span><span class=lnt id=hl-151-39><a class=lnlinks href=#hl-151-39> 39</a>
</span><span class=lnt id=hl-151-40><a class=lnlinks href=#hl-151-40> 40</a>
</span><span class=lnt id=hl-151-41><a class=lnlinks href=#hl-151-41> 41</a>
</span><span class=lnt id=hl-151-42><a class=lnlinks href=#hl-151-42> 42</a>
</span><span class=lnt id=hl-151-43><a class=lnlinks href=#hl-151-43> 43</a>
</span><span class=lnt id=hl-151-44><a class=lnlinks href=#hl-151-44> 44</a>
</span><span class=lnt id=hl-151-45><a class=lnlinks href=#hl-151-45> 45</a>
</span><span class=lnt id=hl-151-46><a class=lnlinks href=#hl-151-46> 46</a>
</span><span class=lnt id=hl-151-47><a class=lnlinks href=#hl-151-47> 47</a>
</span><span class=lnt id=hl-151-48><a class=lnlinks href=#hl-151-48> 48</a>
</span><span class=lnt id=hl-151-49><a class=lnlinks href=#hl-151-49> 49</a>
</span><span class=lnt id=hl-151-50><a class=lnlinks href=#hl-151-50> 50</a>
</span><span class=lnt id=hl-151-51><a class=lnlinks href=#hl-151-51> 51</a>
</span><span class=lnt id=hl-151-52><a class=lnlinks href=#hl-151-52> 52</a>
</span><span class=lnt id=hl-151-53><a class=lnlinks href=#hl-151-53> 53</a>
</span><span class=lnt id=hl-151-54><a class=lnlinks href=#hl-151-54> 54</a>
</span><span class=lnt id=hl-151-55><a class=lnlinks href=#hl-151-55> 55</a>
</span><span class=lnt id=hl-151-56><a class=lnlinks href=#hl-151-56> 56</a>
</span><span class=lnt id=hl-151-57><a class=lnlinks href=#hl-151-57> 57</a>
</span><span class=lnt id=hl-151-58><a class=lnlinks href=#hl-151-58> 58</a>
</span><span class=lnt id=hl-151-59><a class=lnlinks href=#hl-151-59> 59</a>
</span><span class=lnt id=hl-151-60><a class=lnlinks href=#hl-151-60> 60</a>
</span><span class=lnt id=hl-151-61><a class=lnlinks href=#hl-151-61> 61</a>
</span><span class=lnt id=hl-151-62><a class=lnlinks href=#hl-151-62> 62</a>
</span><span class=lnt id=hl-151-63><a class=lnlinks href=#hl-151-63> 63</a>
</span><span class=lnt id=hl-151-64><a class=lnlinks href=#hl-151-64> 64</a>
</span><span class=lnt id=hl-151-65><a class=lnlinks href=#hl-151-65> 65</a>
</span><span class=lnt id=hl-151-66><a class=lnlinks href=#hl-151-66> 66</a>
</span><span class=lnt id=hl-151-67><a class=lnlinks href=#hl-151-67> 67</a>
</span><span class=lnt id=hl-151-68><a class=lnlinks href=#hl-151-68> 68</a>
</span><span class=lnt id=hl-151-69><a class=lnlinks href=#hl-151-69> 69</a>
</span><span class=lnt id=hl-151-70><a class=lnlinks href=#hl-151-70> 70</a>
</span><span class=lnt id=hl-151-71><a class=lnlinks href=#hl-151-71> 71</a>
</span><span class=lnt id=hl-151-72><a class=lnlinks href=#hl-151-72> 72</a>
</span><span class=lnt id=hl-151-73><a class=lnlinks href=#hl-151-73> 73</a>
</span><span class=lnt id=hl-151-74><a class=lnlinks href=#hl-151-74> 74</a>
</span><span class=lnt id=hl-151-75><a class=lnlinks href=#hl-151-75> 75</a>
</span><span class=lnt id=hl-151-76><a class=lnlinks href=#hl-151-76> 76</a>
</span><span class=lnt id=hl-151-77><a class=lnlinks href=#hl-151-77> 77</a>
</span><span class=lnt id=hl-151-78><a class=lnlinks href=#hl-151-78> 78</a>
</span><span class=lnt id=hl-151-79><a class=lnlinks href=#hl-151-79> 79</a>
</span><span class=lnt id=hl-151-80><a class=lnlinks href=#hl-151-80> 80</a>
</span><span class=lnt id=hl-151-81><a class=lnlinks href=#hl-151-81> 81</a>
</span><span class=lnt id=hl-151-82><a class=lnlinks href=#hl-151-82> 82</a>
</span><span class=lnt id=hl-151-83><a class=lnlinks href=#hl-151-83> 83</a>
</span><span class=lnt id=hl-151-84><a class=lnlinks href=#hl-151-84> 84</a>
</span><span class=lnt id=hl-151-85><a class=lnlinks href=#hl-151-85> 85</a>
</span><span class=lnt id=hl-151-86><a class=lnlinks href=#hl-151-86> 86</a>
</span><span class=lnt id=hl-151-87><a class=lnlinks href=#hl-151-87> 87</a>
</span><span class=lnt id=hl-151-88><a class=lnlinks href=#hl-151-88> 88</a>
</span><span class=lnt id=hl-151-89><a class=lnlinks href=#hl-151-89> 89</a>
</span><span class=lnt id=hl-151-90><a class=lnlinks href=#hl-151-90> 90</a>
</span><span class=lnt id=hl-151-91><a class=lnlinks href=#hl-151-91> 91</a>
</span><span class=lnt id=hl-151-92><a class=lnlinks href=#hl-151-92> 92</a>
</span><span class=lnt id=hl-151-93><a class=lnlinks href=#hl-151-93> 93</a>
</span><span class=lnt id=hl-151-94><a class=lnlinks href=#hl-151-94> 94</a>
</span><span class=lnt id=hl-151-95><a class=lnlinks href=#hl-151-95> 95</a>
</span><span class=lnt id=hl-151-96><a class=lnlinks href=#hl-151-96> 96</a>
</span><span class=lnt id=hl-151-97><a class=lnlinks href=#hl-151-97> 97</a>
</span><span class=lnt id=hl-151-98><a class=lnlinks href=#hl-151-98> 98</a>
</span><span class=lnt id=hl-151-99><a class=lnlinks href=#hl-151-99> 99</a>
</span><span class=lnt id=hl-151-100><a class=lnlinks href=#hl-151-100>100</a>
</span><span class=lnt id=hl-151-101><a class=lnlinks href=#hl-151-101>101</a>
</span><span class=lnt id=hl-151-102><a class=lnlinks href=#hl-151-102>102</a>
</span><span class=lnt id=hl-151-103><a class=lnlinks href=#hl-151-103>103</a>
</span><span class=lnt id=hl-151-104><a class=lnlinks href=#hl-151-104>104</a>
</span><span class=lnt id=hl-151-105><a class=lnlinks href=#hl-151-105>105</a>
</span><span class=lnt id=hl-151-106><a class=lnlinks href=#hl-151-106>106</a>
</span><span class=lnt id=hl-151-107><a class=lnlinks href=#hl-151-107>107</a>
</span><span class=lnt id=hl-151-108><a class=lnlinks href=#hl-151-108>108</a>
</span><span class=lnt id=hl-151-109><a class=lnlinks href=#hl-151-109>109</a>
</span><span class=lnt id=hl-151-110><a class=lnlinks href=#hl-151-110>110</a>
</span><span class=lnt id=hl-151-111><a class=lnlinks href=#hl-151-111>111</a>
</span><span class=lnt id=hl-151-112><a class=lnlinks href=#hl-151-112>112</a>
</span><span class=lnt id=hl-151-113><a class=lnlinks href=#hl-151-113>113</a>
</span><span class=lnt id=hl-151-114><a class=lnlinks href=#hl-151-114>114</a>
</span><span class=lnt id=hl-151-115><a class=lnlinks href=#hl-151-115>115</a>
</span><span class=lnt id=hl-151-116><a class=lnlinks href=#hl-151-116>116</a>
</span><span class=lnt id=hl-151-117><a class=lnlinks href=#hl-151-117>117</a>
</span><span class=lnt id=hl-151-118><a class=lnlinks href=#hl-151-118>118</a>
</span><span class=lnt id=hl-151-119><a class=lnlinks href=#hl-151-119>119</a>
</span><span class=lnt id=hl-151-120><a class=lnlinks href=#hl-151-120>120</a>
</span><span class=lnt id=hl-151-121><a class=lnlinks href=#hl-151-121>121</a>
</span><span class=lnt id=hl-151-122><a class=lnlinks href=#hl-151-122>122</a>
</span><span class=lnt id=hl-151-123><a class=lnlinks href=#hl-151-123>123</a>
</span><span class=lnt id=hl-151-124><a class=lnlinks href=#hl-151-124>124</a>
</span><span class=lnt id=hl-151-125><a class=lnlinks href=#hl-151-125>125</a>
</span><span class=lnt id=hl-151-126><a class=lnlinks href=#hl-151-126>126</a>
</span><span class=lnt id=hl-151-127><a class=lnlinks href=#hl-151-127>127</a>
</span><span class=lnt id=hl-151-128><a class=lnlinks href=#hl-151-128>128</a>
</span><span class=lnt id=hl-151-129><a class=lnlinks href=#hl-151-129>129</a>
</span><span class=lnt id=hl-151-130><a class=lnlinks href=#hl-151-130>130</a>
</span><span class=lnt id=hl-151-131><a class=lnlinks href=#hl-151-131>131</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>BTreeNode</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;B-Tree 노드 구현&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>t</span><span class=p>,</span> <span class=n>is_leaf</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>t</span> <span class=o>=</span> <span class=n>t</span>  <span class=c1># 최소 차수</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>keys</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># 키 배열 (최대 2t-1개)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>children</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># 자식 포인터 (최대 2t개)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>is_leaf</span> <span class=o>=</span> <span class=n>is_leaf</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>n</span> <span class=o>=</span> <span class=mi>0</span>  <span class=c1># 현재 키 개수</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;키 검색 (재귀적)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=c1># 현재 노드에서 키 위치 찾기</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>n</span> <span class=ow>and</span> <span class=n>key</span> <span class=o>&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 키를 찾은 경우</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>n</span> <span class=ow>and</span> <span class=n>key</span> <span class=o>==</span> <span class=bp>self</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 리프 노드에서 못 찾음</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_leaf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 적절한 자식으로 재귀</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>children</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>insert_non_full</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;여유 있는 노드에 키 삽입&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>is_leaf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 리프: 정렬 유지하며 삽입</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>keys</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>key</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>n</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 내부 노드: 자식 찾기</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>key</span> <span class=o>&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 자식이 꽉 찬 경우 분할</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>children</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>n</span> <span class=o>==</span> <span class=mi>2</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>t</span> <span class=o>-</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>split_child</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>key</span> <span class=o>&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>children</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>insert_non_full</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>split_child</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>i</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;자식 노드 분할&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>t</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>t</span>
</span></span><span class=line><span class=cl>        <span class=n>full_child</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>children</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>new_child</span> <span class=o>=</span> <span class=n>BTreeNode</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=n>full_child</span><span class=o>.</span><span class=n>is_leaf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 중간 키 찾기</span>
</span></span><span class=line><span class=cl>        <span class=n>mid_key</span> <span class=o>=</span> <span class=n>full_child</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>t</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 오른쪽 절반을 새 노드로</span>
</span></span><span class=line><span class=cl>        <span class=n>new_child</span><span class=o>.</span><span class=n>keys</span> <span class=o>=</span> <span class=n>full_child</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>t</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=n>new_child</span><span class=o>.</span><span class=n>n</span> <span class=o>=</span> <span class=n>t</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 자식이 내부 노드면 포인터도 분할</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>full_child</span><span class=o>.</span><span class=n>is_leaf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>new_child</span><span class=o>.</span><span class=n>children</span> <span class=o>=</span> <span class=n>full_child</span><span class=o>.</span><span class=n>children</span><span class=p>[</span><span class=n>t</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 왼쪽 절반만 남기기</span>
</span></span><span class=line><span class=cl>        <span class=n>full_child</span><span class=o>.</span><span class=n>keys</span> <span class=o>=</span> <span class=n>full_child</span><span class=o>.</span><span class=n>keys</span><span class=p>[:</span><span class=n>t</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>full_child</span><span class=o>.</span><span class=n>n</span> <span class=o>=</span> <span class=n>t</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>full_child</span><span class=o>.</span><span class=n>is_leaf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>full_child</span><span class=o>.</span><span class=n>children</span> <span class=o>=</span> <span class=n>full_child</span><span class=o>.</span><span class=n>children</span><span class=p>[:</span><span class=n>t</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 부모에 중간 키 삽입</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>keys</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>mid_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>children</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=n>new_child</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>n</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>BTree</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;B-Tree 구현&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>t</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>root</span> <span class=o>=</span> <span class=n>BTreeNode</span><span class=p>(</span><span class=n>t</span><span class=p>,</span> <span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>t</span> <span class=o>=</span> <span class=n>t</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>root</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>insert</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>root</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>root</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 루트가 꽉 찬 경우</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>root</span><span class=o>.</span><span class=n>n</span> <span class=o>==</span> <span class=mi>2</span> <span class=o>*</span> <span class=bp>self</span><span class=o>.</span><span class=n>t</span> <span class=o>-</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>new_root</span> <span class=o>=</span> <span class=n>BTreeNode</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>t</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>new_root</span><span class=o>.</span><span class=n>children</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>root</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>new_root</span><span class=o>.</span><span class=n>split_child</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>root</span> <span class=o>=</span> <span class=n>new_root</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>root</span><span class=o>.</span><span class=n>insert_non_full</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>range_search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>start_key</span><span class=p>,</span> <span class=n>end_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;범위 검색 구현&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 시작 키 위치 찾기</span>
</span></span><span class=line><span class=cl>        <span class=n>node</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_find_leaf</span><span class=p>(</span><span class=n>start_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 리프 노드 순회하며 범위 내 키 수집</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>node</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>node</span><span class=o>.</span><span class=n>keys</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>start_key</span> <span class=o>&lt;=</span> <span class=n>key</span> <span class=o>&lt;=</span> <span class=n>end_key</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>results</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>elif</span> <span class=n>key</span> <span class=o>&gt;</span> <span class=n>end_key</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>results</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 다음 리프로 (B+ Tree의 경우)</span>
</span></span><span class=line><span class=cl>            <span class=n>node</span> <span class=o>=</span> <span class=n>node</span><span class=o>.</span><span class=n>next_leaf</span> <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=s1>&#39;next_leaf&#39;</span><span class=p>)</span> <span class=k>else</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>results</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_find_leaf</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;키가 속할 리프 노드 찾기&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>node</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>root</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=ow>not</span> <span class=n>node</span><span class=o>.</span><span class=n>is_leaf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>node</span><span class=o>.</span><span class=n>n</span> <span class=ow>and</span> <span class=n>key</span> <span class=o>&gt;</span> <span class=n>node</span><span class=o>.</span><span class=n>keys</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>node</span> <span class=o>=</span> <span class=n>node</span><span class=o>.</span><span class=n>children</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>node</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Hash Index 구현</strong></p><p><strong>정의</strong>: 해시 함수를 사용하여 키를 버킷에 매핑하고 상수 시간 접근을 제공하는 인덱스</p><p><strong>특징</strong>:</p><ul><li>평균 O(1) 검색 시간</li><li>등가 조건에 최적화</li><li>범위 검색 불가능</li></ul><p><strong>목적</strong>: 빠른 포인트 검색 (WHERE col = value)</p><p><strong>사용 상황</strong>:</p><ul><li>등가 조건만 사용</li><li>정렬 불필요</li><li>메모리 충분</li><li>읽기 중심 워크로드</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-152-1><a class=lnlinks href=#hl-152-1> 1</a>
</span><span class=lnt id=hl-152-2><a class=lnlinks href=#hl-152-2> 2</a>
</span><span class=lnt id=hl-152-3><a class=lnlinks href=#hl-152-3> 3</a>
</span><span class=lnt id=hl-152-4><a class=lnlinks href=#hl-152-4> 4</a>
</span><span class=lnt id=hl-152-5><a class=lnlinks href=#hl-152-5> 5</a>
</span><span class=lnt id=hl-152-6><a class=lnlinks href=#hl-152-6> 6</a>
</span><span class=lnt id=hl-152-7><a class=lnlinks href=#hl-152-7> 7</a>
</span><span class=lnt id=hl-152-8><a class=lnlinks href=#hl-152-8> 8</a>
</span><span class=lnt id=hl-152-9><a class=lnlinks href=#hl-152-9> 9</a>
</span><span class=lnt id=hl-152-10><a class=lnlinks href=#hl-152-10>10</a>
</span><span class=lnt id=hl-152-11><a class=lnlinks href=#hl-152-11>11</a>
</span><span class=lnt id=hl-152-12><a class=lnlinks href=#hl-152-12>12</a>
</span><span class=lnt id=hl-152-13><a class=lnlinks href=#hl-152-13>13</a>
</span><span class=lnt id=hl-152-14><a class=lnlinks href=#hl-152-14>14</a>
</span><span class=lnt id=hl-152-15><a class=lnlinks href=#hl-152-15>15</a>
</span><span class=lnt id=hl-152-16><a class=lnlinks href=#hl-152-16>16</a>
</span><span class=lnt id=hl-152-17><a class=lnlinks href=#hl-152-17>17</a>
</span><span class=lnt id=hl-152-18><a class=lnlinks href=#hl-152-18>18</a>
</span><span class=lnt id=hl-152-19><a class=lnlinks href=#hl-152-19>19</a>
</span><span class=lnt id=hl-152-20><a class=lnlinks href=#hl-152-20>20</a>
</span><span class=lnt id=hl-152-21><a class=lnlinks href=#hl-152-21>21</a>
</span><span class=lnt id=hl-152-22><a class=lnlinks href=#hl-152-22>22</a>
</span><span class=lnt id=hl-152-23><a class=lnlinks href=#hl-152-23>23</a>
</span><span class=lnt id=hl-152-24><a class=lnlinks href=#hl-152-24>24</a>
</span><span class=lnt id=hl-152-25><a class=lnlinks href=#hl-152-25>25</a>
</span><span class=lnt id=hl-152-26><a class=lnlinks href=#hl-152-26>26</a>
</span><span class=lnt id=hl-152-27><a class=lnlinks href=#hl-152-27>27</a>
</span><span class=lnt id=hl-152-28><a class=lnlinks href=#hl-152-28>28</a>
</span><span class=lnt id=hl-152-29><a class=lnlinks href=#hl-152-29>29</a>
</span><span class=lnt id=hl-152-30><a class=lnlinks href=#hl-152-30>30</a>
</span><span class=lnt id=hl-152-31><a class=lnlinks href=#hl-152-31>31</a>
</span><span class=lnt id=hl-152-32><a class=lnlinks href=#hl-152-32>32</a>
</span><span class=lnt id=hl-152-33><a class=lnlinks href=#hl-152-33>33</a>
</span><span class=lnt id=hl-152-34><a class=lnlinks href=#hl-152-34>34</a>
</span><span class=lnt id=hl-152-35><a class=lnlinks href=#hl-152-35>35</a>
</span><span class=lnt id=hl-152-36><a class=lnlinks href=#hl-152-36>36</a>
</span><span class=lnt id=hl-152-37><a class=lnlinks href=#hl-152-37>37</a>
</span><span class=lnt id=hl-152-38><a class=lnlinks href=#hl-152-38>38</a>
</span><span class=lnt id=hl-152-39><a class=lnlinks href=#hl-152-39>39</a>
</span><span class=lnt id=hl-152-40><a class=lnlinks href=#hl-152-40>40</a>
</span><span class=lnt id=hl-152-41><a class=lnlinks href=#hl-152-41>41</a>
</span><span class=lnt id=hl-152-42><a class=lnlinks href=#hl-152-42>42</a>
</span><span class=lnt id=hl-152-43><a class=lnlinks href=#hl-152-43>43</a>
</span><span class=lnt id=hl-152-44><a class=lnlinks href=#hl-152-44>44</a>
</span><span class=lnt id=hl-152-45><a class=lnlinks href=#hl-152-45>45</a>
</span><span class=lnt id=hl-152-46><a class=lnlinks href=#hl-152-46>46</a>
</span><span class=lnt id=hl-152-47><a class=lnlinks href=#hl-152-47>47</a>
</span><span class=lnt id=hl-152-48><a class=lnlinks href=#hl-152-48>48</a>
</span><span class=lnt id=hl-152-49><a class=lnlinks href=#hl-152-49>49</a>
</span><span class=lnt id=hl-152-50><a class=lnlinks href=#hl-152-50>50</a>
</span><span class=lnt id=hl-152-51><a class=lnlinks href=#hl-152-51>51</a>
</span><span class=lnt id=hl-152-52><a class=lnlinks href=#hl-152-52>52</a>
</span><span class=lnt id=hl-152-53><a class=lnlinks href=#hl-152-53>53</a>
</span><span class=lnt id=hl-152-54><a class=lnlinks href=#hl-152-54>54</a>
</span><span class=lnt id=hl-152-55><a class=lnlinks href=#hl-152-55>55</a>
</span><span class=lnt id=hl-152-56><a class=lnlinks href=#hl-152-56>56</a>
</span><span class=lnt id=hl-152-57><a class=lnlinks href=#hl-152-57>57</a>
</span><span class=lnt id=hl-152-58><a class=lnlinks href=#hl-152-58>58</a>
</span><span class=lnt id=hl-152-59><a class=lnlinks href=#hl-152-59>59</a>
</span><span class=lnt id=hl-152-60><a class=lnlinks href=#hl-152-60>60</a>
</span><span class=lnt id=hl-152-61><a class=lnlinks href=#hl-152-61>61</a>
</span><span class=lnt id=hl-152-62><a class=lnlinks href=#hl-152-62>62</a>
</span><span class=lnt id=hl-152-63><a class=lnlinks href=#hl-152-63>63</a>
</span><span class=lnt id=hl-152-64><a class=lnlinks href=#hl-152-64>64</a>
</span><span class=lnt id=hl-152-65><a class=lnlinks href=#hl-152-65>65</a>
</span><span class=lnt id=hl-152-66><a class=lnlinks href=#hl-152-66>66</a>
</span><span class=lnt id=hl-152-67><a class=lnlinks href=#hl-152-67>67</a>
</span><span class=lnt id=hl-152-68><a class=lnlinks href=#hl-152-68>68</a>
</span><span class=lnt id=hl-152-69><a class=lnlinks href=#hl-152-69>69</a>
</span><span class=lnt id=hl-152-70><a class=lnlinks href=#hl-152-70>70</a>
</span><span class=lnt id=hl-152-71><a class=lnlinks href=#hl-152-71>71</a>
</span><span class=lnt id=hl-152-72><a class=lnlinks href=#hl-152-72>72</a>
</span><span class=lnt id=hl-152-73><a class=lnlinks href=#hl-152-73>73</a>
</span><span class=lnt id=hl-152-74><a class=lnlinks href=#hl-152-74>74</a>
</span><span class=lnt id=hl-152-75><a class=lnlinks href=#hl-152-75>75</a>
</span><span class=lnt id=hl-152-76><a class=lnlinks href=#hl-152-76>76</a>
</span><span class=lnt id=hl-152-77><a class=lnlinks href=#hl-152-77>77</a>
</span><span class=lnt id=hl-152-78><a class=lnlinks href=#hl-152-78>78</a>
</span><span class=lnt id=hl-152-79><a class=lnlinks href=#hl-152-79>79</a>
</span><span class=lnt id=hl-152-80><a class=lnlinks href=#hl-152-80>80</a>
</span><span class=lnt id=hl-152-81><a class=lnlinks href=#hl-152-81>81</a>
</span><span class=lnt id=hl-152-82><a class=lnlinks href=#hl-152-82>82</a>
</span><span class=lnt id=hl-152-83><a class=lnlinks href=#hl-152-83>83</a>
</span><span class=lnt id=hl-152-84><a class=lnlinks href=#hl-152-84>84</a>
</span><span class=lnt id=hl-152-85><a class=lnlinks href=#hl-152-85>85</a>
</span><span class=lnt id=hl-152-86><a class=lnlinks href=#hl-152-86>86</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>HashIndex</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;확장 가능 해시 인덱스 (Extendible Hashing)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>initial_depth</span><span class=o>=</span><span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>global_depth</span> <span class=o>=</span> <span class=n>initial_depth</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>directory_size</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>**</span> <span class=n>initial_depth</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>directory</span> <span class=o>=</span> <span class=p>[</span><span class=n>Bucket</span><span class=p>()</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>directory_size</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>hash_function</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;해시 함수 (상위 비트 사용)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>hash</span><span class=p>(</span><span class=n>key</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>((</span><span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>global_depth</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>insert</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;키-값 쌍 삽입&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>bucket_index</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>hash_function</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>bucket</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>directory</span><span class=p>[</span><span class=n>bucket_index</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 버킷에 공간 있으면 삽입</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>bucket</span><span class=o>.</span><span class=n>is_full</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>bucket</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 버킷 포화: 분할 필요</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>bucket</span><span class=o>.</span><span class=n>local_depth</span> <span class=o>==</span> <span class=bp>self</span><span class=o>.</span><span class=n>global_depth</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 디렉토리 배가</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_double_directory</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 버킷 분할</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_split_bucket</span><span class=p>(</span><span class=n>bucket_index</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 재시도</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;키로 값 검색&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>bucket_index</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>hash_function</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>bucket</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>directory</span><span class=p>[</span><span class=n>bucket_index</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>bucket</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_double_directory</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;디렉토리 크기 2배 증가&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>global_depth</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>directory_size</span> <span class=o>*=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 기존 디렉토리 복제</span>
</span></span><span class=line><span class=cl>        <span class=n>new_directory</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>directory</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>directory</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>directory</span> <span class=o>=</span> <span class=n>new_directory</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_split_bucket</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>index</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;버킷 분할&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>old_bucket</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>directory</span><span class=p>[</span><span class=n>index</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>old_bucket</span><span class=o>.</span><span class=n>local_depth</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 새 버킷 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>new_bucket</span> <span class=o>=</span> <span class=n>Bucket</span><span class=p>(</span><span class=n>local_depth</span><span class=o>=</span><span class=n>old_bucket</span><span class=o>.</span><span class=n>local_depth</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 엔트리 재분배</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>old_bucket</span><span class=o>.</span><span class=n>entries</span><span class=p>[:]:</span>
</span></span><span class=line><span class=cl>            <span class=n>new_index</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>hash_function</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>new_index</span> <span class=o>!=</span> <span class=n>index</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>old_bucket</span><span class=o>.</span><span class=n>entries</span><span class=o>.</span><span class=n>remove</span><span class=p>((</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>new_bucket</span><span class=o>.</span><span class=n>entries</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 디렉토리 업데이트</span>
</span></span><span class=line><span class=cl>        <span class=n>step</span> <span class=o>=</span> <span class=mi>2</span> <span class=o>**</span> <span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>global_depth</span> <span class=o>-</span> <span class=n>new_bucket</span><span class=o>.</span><span class=n>local_depth</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>index</span> <span class=o>+</span> <span class=n>step</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>directory_size</span><span class=p>,</span> <span class=n>step</span> <span class=o>*</span> <span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>directory</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>new_bucket</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Bucket</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;해시 버킷&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>capacity</span><span class=o>=</span><span class=mi>4</span><span class=p>,</span> <span class=n>local_depth</span><span class=o>=</span><span class=mi>0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>capacity</span> <span class=o>=</span> <span class=n>capacity</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>local_depth</span> <span class=o>=</span> <span class=n>local_depth</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>entries</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># [(key, value), ...]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>is_full</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>entries</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=bp>self</span><span class=o>.</span><span class=n>capacity</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>insert</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>entries</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>entries</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>k</span> <span class=o>==</span> <span class=n>key</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>v</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Bitmap Index 구현</strong></p><p><strong>정의</strong>: 각 고유 값마다 비트맵을 생성하여 해당 값을 가진 행을 1로 표시하는 인덱스</p><p><strong>특징</strong>:</p><ul><li>저카디널리티 컬럼에 효율적</li><li>빠른 비트 연산 (AND, OR, NOT)</li><li>높은 압축률</li></ul><p><strong>목적</strong>: 다중 조건 쿼리 최적화, OLAP 워크로드</p><p><strong>사용 상황</strong>:</p><ul><li>성별, 상태, 카테고리 등 저카디널리티</li><li>복잡한 WHERE 조건 (여러 AND/OR)</li><li>집계 쿼리</li><li>읽기 전용 또는 읽기 중심</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-153-1><a class=lnlinks href=#hl-153-1> 1</a>
</span><span class=lnt id=hl-153-2><a class=lnlinks href=#hl-153-2> 2</a>
</span><span class=lnt id=hl-153-3><a class=lnlinks href=#hl-153-3> 3</a>
</span><span class=lnt id=hl-153-4><a class=lnlinks href=#hl-153-4> 4</a>
</span><span class=lnt id=hl-153-5><a class=lnlinks href=#hl-153-5> 5</a>
</span><span class=lnt id=hl-153-6><a class=lnlinks href=#hl-153-6> 6</a>
</span><span class=lnt id=hl-153-7><a class=lnlinks href=#hl-153-7> 7</a>
</span><span class=lnt id=hl-153-8><a class=lnlinks href=#hl-153-8> 8</a>
</span><span class=lnt id=hl-153-9><a class=lnlinks href=#hl-153-9> 9</a>
</span><span class=lnt id=hl-153-10><a class=lnlinks href=#hl-153-10>10</a>
</span><span class=lnt id=hl-153-11><a class=lnlinks href=#hl-153-11>11</a>
</span><span class=lnt id=hl-153-12><a class=lnlinks href=#hl-153-12>12</a>
</span><span class=lnt id=hl-153-13><a class=lnlinks href=#hl-153-13>13</a>
</span><span class=lnt id=hl-153-14><a class=lnlinks href=#hl-153-14>14</a>
</span><span class=lnt id=hl-153-15><a class=lnlinks href=#hl-153-15>15</a>
</span><span class=lnt id=hl-153-16><a class=lnlinks href=#hl-153-16>16</a>
</span><span class=lnt id=hl-153-17><a class=lnlinks href=#hl-153-17>17</a>
</span><span class=lnt id=hl-153-18><a class=lnlinks href=#hl-153-18>18</a>
</span><span class=lnt id=hl-153-19><a class=lnlinks href=#hl-153-19>19</a>
</span><span class=lnt id=hl-153-20><a class=lnlinks href=#hl-153-20>20</a>
</span><span class=lnt id=hl-153-21><a class=lnlinks href=#hl-153-21>21</a>
</span><span class=lnt id=hl-153-22><a class=lnlinks href=#hl-153-22>22</a>
</span><span class=lnt id=hl-153-23><a class=lnlinks href=#hl-153-23>23</a>
</span><span class=lnt id=hl-153-24><a class=lnlinks href=#hl-153-24>24</a>
</span><span class=lnt id=hl-153-25><a class=lnlinks href=#hl-153-25>25</a>
</span><span class=lnt id=hl-153-26><a class=lnlinks href=#hl-153-26>26</a>
</span><span class=lnt id=hl-153-27><a class=lnlinks href=#hl-153-27>27</a>
</span><span class=lnt id=hl-153-28><a class=lnlinks href=#hl-153-28>28</a>
</span><span class=lnt id=hl-153-29><a class=lnlinks href=#hl-153-29>29</a>
</span><span class=lnt id=hl-153-30><a class=lnlinks href=#hl-153-30>30</a>
</span><span class=lnt id=hl-153-31><a class=lnlinks href=#hl-153-31>31</a>
</span><span class=lnt id=hl-153-32><a class=lnlinks href=#hl-153-32>32</a>
</span><span class=lnt id=hl-153-33><a class=lnlinks href=#hl-153-33>33</a>
</span><span class=lnt id=hl-153-34><a class=lnlinks href=#hl-153-34>34</a>
</span><span class=lnt id=hl-153-35><a class=lnlinks href=#hl-153-35>35</a>
</span><span class=lnt id=hl-153-36><a class=lnlinks href=#hl-153-36>36</a>
</span><span class=lnt id=hl-153-37><a class=lnlinks href=#hl-153-37>37</a>
</span><span class=lnt id=hl-153-38><a class=lnlinks href=#hl-153-38>38</a>
</span><span class=lnt id=hl-153-39><a class=lnlinks href=#hl-153-39>39</a>
</span><span class=lnt id=hl-153-40><a class=lnlinks href=#hl-153-40>40</a>
</span><span class=lnt id=hl-153-41><a class=lnlinks href=#hl-153-41>41</a>
</span><span class=lnt id=hl-153-42><a class=lnlinks href=#hl-153-42>42</a>
</span><span class=lnt id=hl-153-43><a class=lnlinks href=#hl-153-43>43</a>
</span><span class=lnt id=hl-153-44><a class=lnlinks href=#hl-153-44>44</a>
</span><span class=lnt id=hl-153-45><a class=lnlinks href=#hl-153-45>45</a>
</span><span class=lnt id=hl-153-46><a class=lnlinks href=#hl-153-46>46</a>
</span><span class=lnt id=hl-153-47><a class=lnlinks href=#hl-153-47>47</a>
</span><span class=lnt id=hl-153-48><a class=lnlinks href=#hl-153-48>48</a>
</span><span class=lnt id=hl-153-49><a class=lnlinks href=#hl-153-49>49</a>
</span><span class=lnt id=hl-153-50><a class=lnlinks href=#hl-153-50>50</a>
</span><span class=lnt id=hl-153-51><a class=lnlinks href=#hl-153-51>51</a>
</span><span class=lnt id=hl-153-52><a class=lnlinks href=#hl-153-52>52</a>
</span><span class=lnt id=hl-153-53><a class=lnlinks href=#hl-153-53>53</a>
</span><span class=lnt id=hl-153-54><a class=lnlinks href=#hl-153-54>54</a>
</span><span class=lnt id=hl-153-55><a class=lnlinks href=#hl-153-55>55</a>
</span><span class=lnt id=hl-153-56><a class=lnlinks href=#hl-153-56>56</a>
</span><span class=lnt id=hl-153-57><a class=lnlinks href=#hl-153-57>57</a>
</span><span class=lnt id=hl-153-58><a class=lnlinks href=#hl-153-58>58</a>
</span><span class=lnt id=hl-153-59><a class=lnlinks href=#hl-153-59>59</a>
</span><span class=lnt id=hl-153-60><a class=lnlinks href=#hl-153-60>60</a>
</span><span class=lnt id=hl-153-61><a class=lnlinks href=#hl-153-61>61</a>
</span><span class=lnt id=hl-153-62><a class=lnlinks href=#hl-153-62>62</a>
</span><span class=lnt id=hl-153-63><a class=lnlinks href=#hl-153-63>63</a>
</span><span class=lnt id=hl-153-64><a class=lnlinks href=#hl-153-64>64</a>
</span><span class=lnt id=hl-153-65><a class=lnlinks href=#hl-153-65>65</a>
</span><span class=lnt id=hl-153-66><a class=lnlinks href=#hl-153-66>66</a>
</span><span class=lnt id=hl-153-67><a class=lnlinks href=#hl-153-67>67</a>
</span><span class=lnt id=hl-153-68><a class=lnlinks href=#hl-153-68>68</a>
</span><span class=lnt id=hl-153-69><a class=lnlinks href=#hl-153-69>69</a>
</span><span class=lnt id=hl-153-70><a class=lnlinks href=#hl-153-70>70</a>
</span><span class=lnt id=hl-153-71><a class=lnlinks href=#hl-153-71>71</a>
</span><span class=lnt id=hl-153-72><a class=lnlinks href=#hl-153-72>72</a>
</span><span class=lnt id=hl-153-73><a class=lnlinks href=#hl-153-73>73</a>
</span><span class=lnt id=hl-153-74><a class=lnlinks href=#hl-153-74>74</a>
</span><span class=lnt id=hl-153-75><a class=lnlinks href=#hl-153-75>75</a>
</span><span class=lnt id=hl-153-76><a class=lnlinks href=#hl-153-76>76</a>
</span><span class=lnt id=hl-153-77><a class=lnlinks href=#hl-153-77>77</a>
</span><span class=lnt id=hl-153-78><a class=lnlinks href=#hl-153-78>78</a>
</span><span class=lnt id=hl-153-79><a class=lnlinks href=#hl-153-79>79</a>
</span><span class=lnt id=hl-153-80><a class=lnlinks href=#hl-153-80>80</a>
</span><span class=lnt id=hl-153-81><a class=lnlinks href=#hl-153-81>81</a>
</span><span class=lnt id=hl-153-82><a class=lnlinks href=#hl-153-82>82</a>
</span><span class=lnt id=hl-153-83><a class=lnlinks href=#hl-153-83>83</a>
</span><span class=lnt id=hl-153-84><a class=lnlinks href=#hl-153-84>84</a>
</span><span class=lnt id=hl-153-85><a class=lnlinks href=#hl-153-85>85</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>BitmapIndex</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;압축된 비트맵 인덱스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>bitmaps</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># {value: bitmap}</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>row_count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>build</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>column_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;컬럼 데이터로부터 비트맵 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>row_count</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>column_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>unique_values</span> <span class=o>=</span> <span class=nb>set</span><span class=p>(</span><span class=n>column_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 각 고유 값마다 비트맵 생성</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>unique_values</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>bitmap</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>row_count</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>column_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>val</span> <span class=o>==</span> <span class=n>value</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>bitmap</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 압축 (Run-Length Encoding)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>bitmaps</span><span class=p>[</span><span class=n>value</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_compress_rle</span><span class=p>(</span><span class=n>bitmap</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search_equal</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;등가 검색: value와 일치하는 행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>value</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>bitmaps</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>row_count</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_decompress_rle</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>bitmaps</span><span class=p>[</span><span class=n>value</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search_and</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value1</span><span class=p>,</span> <span class=n>value2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;AND 연산: value1 AND value2&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>bitmap1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>search_equal</span><span class=p>(</span><span class=n>value1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>bitmap2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>search_equal</span><span class=p>(</span><span class=n>value2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>bitwise_and</span><span class=p>(</span><span class=n>bitmap1</span><span class=p>,</span> <span class=n>bitmap2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search_or</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value1</span><span class=p>,</span> <span class=n>value2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;OR 연산: value1 OR value2&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>bitmap1</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>search_equal</span><span class=p>(</span><span class=n>value1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>bitmap2</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>search_equal</span><span class=p>(</span><span class=n>value2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>bitwise_or</span><span class=p>(</span><span class=n>bitmap1</span><span class=p>,</span> <span class=n>bitmap2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search_not</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;NOT 연산: NOT value&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>bitmap</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>search_equal</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>bitwise_not</span><span class=p>(</span><span class=n>bitmap</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_row_ids</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bitmap</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;비트맵에서 행 ID 추출&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>bitmap</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_compress_rle</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>bitmap</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Run-Length Encoding 압축&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>runs</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=n>current_bit</span> <span class=o>=</span> <span class=n>bitmap</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>count</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>bit</span> <span class=ow>in</span> <span class=n>bitmap</span><span class=p>[</span><span class=mi>1</span><span class=p>:]:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>bit</span> <span class=o>==</span> <span class=n>current_bit</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>runs</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>current_bit</span><span class=p>,</span> <span class=n>count</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=n>current_bit</span> <span class=o>=</span> <span class=n>bit</span>
</span></span><span class=line><span class=cl>                <span class=n>count</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>runs</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>current_bit</span><span class=p>,</span> <span class=n>count</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>runs</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_decompress_rle</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>runs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;RLE 압축 해제&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>bitmap</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>bit</span><span class=p>,</span> <span class=n>count</span> <span class=ow>in</span> <span class=n>runs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>bitmap</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=n>bit</span><span class=p>]</span> <span class=o>*</span> <span class=n>count</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>bitmap</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>uint8</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;F&#39;</span><span class=p>,</span> <span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;F&#39;</span><span class=p>,</span> <span class=s1>&#39;M&#39;</span><span class=p>,</span> <span class=s1>&#39;F&#39;</span><span class=p>,</span> <span class=s1>&#39;F&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>index</span> <span class=o>=</span> <span class=n>BitmapIndex</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=o>.</span><span class=n>build</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 쿼리: WHERE gender = &#39;M&#39;</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>index</span><span class=o>.</span><span class=n>search_equal</span><span class=p>(</span><span class=s1>&#39;M&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;M 비트맵: </span><span class=si>{</span><span class=n>result</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>  <span class=c1># [1 0 1 1 0 1 0 0]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;행 IDs: </span><span class=si>{</span><span class=n>index</span><span class=o>.</span><span class=n>get_row_ids</span><span class=p>(</span><span class=n>result</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>  <span class=c1># [0, 2, 3, 5]</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Full-Text Index 구현</strong></p><p><strong>정의</strong>: 텍스트 문서의 단어를 키로, 문서 위치를 값으로 하는 역색인(Inverted Index)</p><p><strong>특징</strong>:</p><ul><li>단어 기반 검색</li><li>랭킹 알고리즘 (TF-IDF, BM25)</li><li>스템밍, 불용어 처리</li></ul><p><strong>목적</strong>: 텍스트 검색, 문서 검색, 콘텐츠 검색 최적화</p><p><strong>사용 상황</strong>:</p><ul><li>검색 엔진</li><li>문서 관리 시스템</li><li>로그 분석</li><li>콘텐츠 추천</li></ul><p><strong>구현 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-154-1><a class=lnlinks href=#hl-154-1>  1</a>
</span><span class=lnt id=hl-154-2><a class=lnlinks href=#hl-154-2>  2</a>
</span><span class=lnt id=hl-154-3><a class=lnlinks href=#hl-154-3>  3</a>
</span><span class=lnt id=hl-154-4><a class=lnlinks href=#hl-154-4>  4</a>
</span><span class=lnt id=hl-154-5><a class=lnlinks href=#hl-154-5>  5</a>
</span><span class=lnt id=hl-154-6><a class=lnlinks href=#hl-154-6>  6</a>
</span><span class=lnt id=hl-154-7><a class=lnlinks href=#hl-154-7>  7</a>
</span><span class=lnt id=hl-154-8><a class=lnlinks href=#hl-154-8>  8</a>
</span><span class=lnt id=hl-154-9><a class=lnlinks href=#hl-154-9>  9</a>
</span><span class=lnt id=hl-154-10><a class=lnlinks href=#hl-154-10> 10</a>
</span><span class=lnt id=hl-154-11><a class=lnlinks href=#hl-154-11> 11</a>
</span><span class=lnt id=hl-154-12><a class=lnlinks href=#hl-154-12> 12</a>
</span><span class=lnt id=hl-154-13><a class=lnlinks href=#hl-154-13> 13</a>
</span><span class=lnt id=hl-154-14><a class=lnlinks href=#hl-154-14> 14</a>
</span><span class=lnt id=hl-154-15><a class=lnlinks href=#hl-154-15> 15</a>
</span><span class=lnt id=hl-154-16><a class=lnlinks href=#hl-154-16> 16</a>
</span><span class=lnt id=hl-154-17><a class=lnlinks href=#hl-154-17> 17</a>
</span><span class=lnt id=hl-154-18><a class=lnlinks href=#hl-154-18> 18</a>
</span><span class=lnt id=hl-154-19><a class=lnlinks href=#hl-154-19> 19</a>
</span><span class=lnt id=hl-154-20><a class=lnlinks href=#hl-154-20> 20</a>
</span><span class=lnt id=hl-154-21><a class=lnlinks href=#hl-154-21> 21</a>
</span><span class=lnt id=hl-154-22><a class=lnlinks href=#hl-154-22> 22</a>
</span><span class=lnt id=hl-154-23><a class=lnlinks href=#hl-154-23> 23</a>
</span><span class=lnt id=hl-154-24><a class=lnlinks href=#hl-154-24> 24</a>
</span><span class=lnt id=hl-154-25><a class=lnlinks href=#hl-154-25> 25</a>
</span><span class=lnt id=hl-154-26><a class=lnlinks href=#hl-154-26> 26</a>
</span><span class=lnt id=hl-154-27><a class=lnlinks href=#hl-154-27> 27</a>
</span><span class=lnt id=hl-154-28><a class=lnlinks href=#hl-154-28> 28</a>
</span><span class=lnt id=hl-154-29><a class=lnlinks href=#hl-154-29> 29</a>
</span><span class=lnt id=hl-154-30><a class=lnlinks href=#hl-154-30> 30</a>
</span><span class=lnt id=hl-154-31><a class=lnlinks href=#hl-154-31> 31</a>
</span><span class=lnt id=hl-154-32><a class=lnlinks href=#hl-154-32> 32</a>
</span><span class=lnt id=hl-154-33><a class=lnlinks href=#hl-154-33> 33</a>
</span><span class=lnt id=hl-154-34><a class=lnlinks href=#hl-154-34> 34</a>
</span><span class=lnt id=hl-154-35><a class=lnlinks href=#hl-154-35> 35</a>
</span><span class=lnt id=hl-154-36><a class=lnlinks href=#hl-154-36> 36</a>
</span><span class=lnt id=hl-154-37><a class=lnlinks href=#hl-154-37> 37</a>
</span><span class=lnt id=hl-154-38><a class=lnlinks href=#hl-154-38> 38</a>
</span><span class=lnt id=hl-154-39><a class=lnlinks href=#hl-154-39> 39</a>
</span><span class=lnt id=hl-154-40><a class=lnlinks href=#hl-154-40> 40</a>
</span><span class=lnt id=hl-154-41><a class=lnlinks href=#hl-154-41> 41</a>
</span><span class=lnt id=hl-154-42><a class=lnlinks href=#hl-154-42> 42</a>
</span><span class=lnt id=hl-154-43><a class=lnlinks href=#hl-154-43> 43</a>
</span><span class=lnt id=hl-154-44><a class=lnlinks href=#hl-154-44> 44</a>
</span><span class=lnt id=hl-154-45><a class=lnlinks href=#hl-154-45> 45</a>
</span><span class=lnt id=hl-154-46><a class=lnlinks href=#hl-154-46> 46</a>
</span><span class=lnt id=hl-154-47><a class=lnlinks href=#hl-154-47> 47</a>
</span><span class=lnt id=hl-154-48><a class=lnlinks href=#hl-154-48> 48</a>
</span><span class=lnt id=hl-154-49><a class=lnlinks href=#hl-154-49> 49</a>
</span><span class=lnt id=hl-154-50><a class=lnlinks href=#hl-154-50> 50</a>
</span><span class=lnt id=hl-154-51><a class=lnlinks href=#hl-154-51> 51</a>
</span><span class=lnt id=hl-154-52><a class=lnlinks href=#hl-154-52> 52</a>
</span><span class=lnt id=hl-154-53><a class=lnlinks href=#hl-154-53> 53</a>
</span><span class=lnt id=hl-154-54><a class=lnlinks href=#hl-154-54> 54</a>
</span><span class=lnt id=hl-154-55><a class=lnlinks href=#hl-154-55> 55</a>
</span><span class=lnt id=hl-154-56><a class=lnlinks href=#hl-154-56> 56</a>
</span><span class=lnt id=hl-154-57><a class=lnlinks href=#hl-154-57> 57</a>
</span><span class=lnt id=hl-154-58><a class=lnlinks href=#hl-154-58> 58</a>
</span><span class=lnt id=hl-154-59><a class=lnlinks href=#hl-154-59> 59</a>
</span><span class=lnt id=hl-154-60><a class=lnlinks href=#hl-154-60> 60</a>
</span><span class=lnt id=hl-154-61><a class=lnlinks href=#hl-154-61> 61</a>
</span><span class=lnt id=hl-154-62><a class=lnlinks href=#hl-154-62> 62</a>
</span><span class=lnt id=hl-154-63><a class=lnlinks href=#hl-154-63> 63</a>
</span><span class=lnt id=hl-154-64><a class=lnlinks href=#hl-154-64> 64</a>
</span><span class=lnt id=hl-154-65><a class=lnlinks href=#hl-154-65> 65</a>
</span><span class=lnt id=hl-154-66><a class=lnlinks href=#hl-154-66> 66</a>
</span><span class=lnt id=hl-154-67><a class=lnlinks href=#hl-154-67> 67</a>
</span><span class=lnt id=hl-154-68><a class=lnlinks href=#hl-154-68> 68</a>
</span><span class=lnt id=hl-154-69><a class=lnlinks href=#hl-154-69> 69</a>
</span><span class=lnt id=hl-154-70><a class=lnlinks href=#hl-154-70> 70</a>
</span><span class=lnt id=hl-154-71><a class=lnlinks href=#hl-154-71> 71</a>
</span><span class=lnt id=hl-154-72><a class=lnlinks href=#hl-154-72> 72</a>
</span><span class=lnt id=hl-154-73><a class=lnlinks href=#hl-154-73> 73</a>
</span><span class=lnt id=hl-154-74><a class=lnlinks href=#hl-154-74> 74</a>
</span><span class=lnt id=hl-154-75><a class=lnlinks href=#hl-154-75> 75</a>
</span><span class=lnt id=hl-154-76><a class=lnlinks href=#hl-154-76> 76</a>
</span><span class=lnt id=hl-154-77><a class=lnlinks href=#hl-154-77> 77</a>
</span><span class=lnt id=hl-154-78><a class=lnlinks href=#hl-154-78> 78</a>
</span><span class=lnt id=hl-154-79><a class=lnlinks href=#hl-154-79> 79</a>
</span><span class=lnt id=hl-154-80><a class=lnlinks href=#hl-154-80> 80</a>
</span><span class=lnt id=hl-154-81><a class=lnlinks href=#hl-154-81> 81</a>
</span><span class=lnt id=hl-154-82><a class=lnlinks href=#hl-154-82> 82</a>
</span><span class=lnt id=hl-154-83><a class=lnlinks href=#hl-154-83> 83</a>
</span><span class=lnt id=hl-154-84><a class=lnlinks href=#hl-154-84> 84</a>
</span><span class=lnt id=hl-154-85><a class=lnlinks href=#hl-154-85> 85</a>
</span><span class=lnt id=hl-154-86><a class=lnlinks href=#hl-154-86> 86</a>
</span><span class=lnt id=hl-154-87><a class=lnlinks href=#hl-154-87> 87</a>
</span><span class=lnt id=hl-154-88><a class=lnlinks href=#hl-154-88> 88</a>
</span><span class=lnt id=hl-154-89><a class=lnlinks href=#hl-154-89> 89</a>
</span><span class=lnt id=hl-154-90><a class=lnlinks href=#hl-154-90> 90</a>
</span><span class=lnt id=hl-154-91><a class=lnlinks href=#hl-154-91> 91</a>
</span><span class=lnt id=hl-154-92><a class=lnlinks href=#hl-154-92> 92</a>
</span><span class=lnt id=hl-154-93><a class=lnlinks href=#hl-154-93> 93</a>
</span><span class=lnt id=hl-154-94><a class=lnlinks href=#hl-154-94> 94</a>
</span><span class=lnt id=hl-154-95><a class=lnlinks href=#hl-154-95> 95</a>
</span><span class=lnt id=hl-154-96><a class=lnlinks href=#hl-154-96> 96</a>
</span><span class=lnt id=hl-154-97><a class=lnlinks href=#hl-154-97> 97</a>
</span><span class=lnt id=hl-154-98><a class=lnlinks href=#hl-154-98> 98</a>
</span><span class=lnt id=hl-154-99><a class=lnlinks href=#hl-154-99> 99</a>
</span><span class=lnt id=hl-154-100><a class=lnlinks href=#hl-154-100>100</a>
</span><span class=lnt id=hl-154-101><a class=lnlinks href=#hl-154-101>101</a>
</span><span class=lnt id=hl-154-102><a class=lnlinks href=#hl-154-102>102</a>
</span><span class=lnt id=hl-154-103><a class=lnlinks href=#hl-154-103>103</a>
</span><span class=lnt id=hl-154-104><a class=lnlinks href=#hl-154-104>104</a>
</span><span class=lnt id=hl-154-105><a class=lnlinks href=#hl-154-105>105</a>
</span><span class=lnt id=hl-154-106><a class=lnlinks href=#hl-154-106>106</a>
</span><span class=lnt id=hl-154-107><a class=lnlinks href=#hl-154-107>107</a>
</span><span class=lnt id=hl-154-108><a class=lnlinks href=#hl-154-108>108</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>collections</span> <span class=kn>import</span> <span class=n>defaultdict</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>math</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>FullTextIndex</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;TF-IDF 기반 전문 검색 인덱스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>inverted_index</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>list</span><span class=p>)</span>  <span class=c1># {term: [(doc_id, positions)]}</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>doc_count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>doc_lengths</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># {doc_id: length}</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>idf_scores</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># {term: idf}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>tokenize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>text</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;텍스트 토큰화 (소문자 변환, 특수문자 제거)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span> <span class=o>=</span> <span class=n>text</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>tokens</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\b\w+\b&#39;</span><span class=p>,</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>tokens</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>build</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>documents</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;문서 집합으로부터 인덱스 구축&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>doc_count</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>documents</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 역색인 구축</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>doc_id</span><span class=p>,</span> <span class=n>text</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>documents</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>tokens</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tokenize</span><span class=p>(</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>doc_lengths</span><span class=p>[</span><span class=n>doc_id</span><span class=p>]</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>tokens</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 각 토큰의 위치 기록</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>pos</span><span class=p>,</span> <span class=n>term</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>tokens</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>inverted_index</span><span class=p>[</span><span class=n>term</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>doc_id</span><span class=p>,</span> <span class=n>pos</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># IDF 점수 계산</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>term</span><span class=p>,</span> <span class=n>postings</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>inverted_index</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>doc_freq</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>doc_id</span> <span class=k>for</span> <span class=n>doc_id</span><span class=p>,</span> <span class=n>_</span> <span class=ow>in</span> <span class=n>postings</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>idf_scores</span><span class=p>[</span><span class=n>term</span><span class=p>]</span> <span class=o>=</span> <span class=n>math</span><span class=o>.</span><span class=n>log</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>doc_count</span> <span class=o>/</span> <span class=n>doc_freq</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>query</span><span class=p>,</span> <span class=n>top_k</span><span class=o>=</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;쿼리에 대한 문서 검색 (TF-IDF 랭킹)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>query_terms</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tokenize</span><span class=p>(</span><span class=n>query</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 문서별 점수 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>scores</span> <span class=o>=</span> <span class=n>defaultdict</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>term</span> <span class=ow>in</span> <span class=n>query_terms</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>term</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>inverted_index</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>idf</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>idf_scores</span><span class=p>[</span><span class=n>term</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>postings</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>inverted_index</span><span class=p>[</span><span class=n>term</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># TF-IDF 계산</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>doc_id</span><span class=p>,</span> <span class=n>_</span> <span class=ow>in</span> <span class=n>postings</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>tf</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=mi>1</span> <span class=k>for</span> <span class=n>d</span><span class=p>,</span> <span class=n>_</span> <span class=ow>in</span> <span class=n>postings</span> <span class=k>if</span> <span class=n>d</span> <span class=o>==</span> <span class=n>doc_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>tf</span> <span class=o>=</span> <span class=n>tf</span> <span class=o>/</span> <span class=bp>self</span><span class=o>.</span><span class=n>doc_lengths</span><span class=p>[</span><span class=n>doc_id</span><span class=p>]</span>  <span class=c1># 정규화</span>
</span></span><span class=line><span class=cl>                <span class=n>scores</span><span class=p>[</span><span class=n>doc_id</span><span class=p>]</span> <span class=o>+=</span> <span class=n>tf</span> <span class=o>*</span> <span class=n>idf</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 상위 k개 문서 반환</span>
</span></span><span class=line><span class=cl>        <span class=n>ranked</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>scores</span><span class=o>.</span><span class=n>items</span><span class=p>(),</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>ranked</span><span class=p>[:</span><span class=n>top_k</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>phrase_search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>phrase</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;구문 검색 (연속된 단어)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>terms</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>tokenize</span><span class=p>(</span><span class=n>phrase</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>terms</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 첫 번째 단어의 포스팅 리스트</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>terms</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>inverted_index</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>candidates</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>inverted_index</span><span class=p>[</span><span class=n>terms</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 나머지 단어들이 연속되는지 확인</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>term</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>terms</span><span class=p>[</span><span class=mi>1</span><span class=p>:],</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>term</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>inverted_index</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>next_postings</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>inverted_index</span><span class=p>[</span><span class=n>term</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>new_candidates</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>doc_id</span><span class=p>,</span> <span class=n>pos</span> <span class=ow>in</span> <span class=n>candidates</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># 다음 위치에 다음 단어가 있는지 확인</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=n>doc_id</span><span class=p>,</span> <span class=n>pos</span> <span class=o>+</span> <span class=n>i</span><span class=p>)</span> <span class=ow>in</span> <span class=n>next_postings</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>new_candidates</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>doc_id</span><span class=p>,</span> <span class=n>pos</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>candidates</span> <span class=o>=</span> <span class=n>new_candidates</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>list</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>doc_id</span> <span class=k>for</span> <span class=n>doc_id</span><span class=p>,</span> <span class=n>_</span> <span class=ow>in</span> <span class=n>candidates</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>docs</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;database indexing performance optimization&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;full text search engine implementation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;database performance tuning techniques&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>index</span> <span class=o>=</span> <span class=n>FullTextIndex</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=o>.</span><span class=n>build</span><span class=p>(</span><span class=n>docs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 검색</span>
</span></span><span class=line><span class=cl><span class=n>results</span> <span class=o>=</span> <span class=n>index</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s2>&#34;database performance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;검색 결과: </span><span class=si>{</span><span class=n>results</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>  <span class=c1># [(0, score1), (2, score2)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 구문 검색</span>
</span></span><span class=line><span class=cl><span class=n>phrase_results</span> <span class=o>=</span> <span class=n>index</span><span class=o>.</span><span class=n>phrase_search</span><span class=p>(</span><span class=s2>&#34;database performance&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;구문 검색: </span><span class=si>{</span><span class=n>phrase_results</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>  <span class=c1># [2]</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=42-유형별-분류-체계-1>4.2 유형별 분류 체계<a hidden class=anchor aria-hidden=true href=#42-유형별-분류-체계-1>#</a></h4><p><strong>구분 기준에 따른 인덱스 분류</strong></p><p><strong>분류 기준 1: 데이터 구조에 따른 분류</strong></p><table><thead><tr><th>인덱스 유형</th><th>자료구조</th><th>특징</th><th>적합한 쿼리</th><th>시간 복잡도</th><th>공간 복잡도</th></tr></thead><tbody><tr><td><strong>B-Tree Index</strong></td><td>균형 다진 트리</td><td>정렬 유지, 범위 검색</td><td>=, &lt;, >, BETWEEN, ORDER BY</td><td>O(log n)</td><td>O(n)</td></tr><tr><td><strong>B+ Tree Index</strong></td><td>B-Tree 변형 (리프 연결)</td><td>범위 스캔 최적화</td><td>범위, 순차 접근</td><td>O(log n)</td><td>O(n)</td></tr><tr><td><strong>Hash Index</strong></td><td>해시 테이블</td><td>등가 검색 특화</td><td>= 연산자만</td><td>O(1) 평균</td><td>O(n)</td></tr><tr><td><strong>Bitmap Index</strong></td><td>비트 배열</td><td>저카디널리티, 비트 연산</td><td>AND, OR, NOT</td><td>O(n/w)</td><td>O(n×d)</td></tr><tr><td><strong>T-Tree</strong></td><td>AVL 변형</td><td>메모리 최적화</td><td>메모리 DB</td><td>O(log n)</td><td>O(n)</td></tr><tr><td><strong>R-Tree</strong></td><td>공간 분할 트리</td><td>다차원 데이터</td><td>공간 범위</td><td>O(log n)</td><td>O(n)</td></tr><tr><td><strong>LSM-Tree</strong></td><td>로그 구조 병합 트리</td><td>쓰기 최적화</td><td>쓰기 중심</td><td>O(log n) 읽기</td><td>O(n)</td></tr></tbody></table><p><strong>분류 기준 2: 물리적 저장 방식</strong></p><table><thead><tr><th>유형</th><th>정의</th><th>데이터 배치</th><th>테이블당 개수</th><th>장점</th><th>단점</th></tr></thead><tbody><tr><td><strong>클러스터드<br>(Clustered)</strong></td><td>인덱스 순서 = 데이터 물리적 순서</td><td>인덱스와 데이터 통합</td><td>1개만</td><td>범위 검색 빠름, I/O 최소</td><td>INSERT 느림, 재구성 비용</td></tr><tr><td><strong>논클러스터드<br>(Non-Clustered)</strong></td><td>인덱스와 데이터 분리</td><td>별도 포인터 구조</td><td>여러 개</td><td>유연성, 다양한 접근 경로</td><td>추가 I/O, 공간 오버헤드</td></tr><tr><td><strong>커버링<br>(Covering)</strong></td><td>쿼리 컬럼 모두 포함</td><td>인덱스에 데이터 포함</td><td>여러 개</td><td>테이블 접근 불필요</td><td>큰 인덱스 크기</td></tr><tr><td><strong>희소<br>(Sparse)</strong></td><td>일부 행만 인덱싱</td><td>페이지 포인터만</td><td>여러 개</td><td>공간 절약</td><td>정확한 위치 추가 탐색</td></tr><tr><td><strong>밀집<br>(Dense)</strong></td><td>모든 행 인덱싱</td><td>모든 레코드 포인터</td><td>여러 개</td><td>직접 접근</td><td>공간 많이 사용</td></tr></tbody></table><p><strong>분류 기준 3: 인덱스 범위 및 적용 대상</strong></p><table><thead><tr><th>유형</th><th>범위</th><th>설명</th><th>사용 목적</th><th>예시</th></tr></thead><tbody><tr><td><strong>전체 인덱스<br>(Full Index)</strong></td><td>모든 행</td><td>테이블의 모든 데이터 인덱싱</td><td>일반적 검색</td><td><code>CREATE INDEX idx ON t(col);</code></td></tr><tr><td><strong>부분 인덱스<br>(Partial Index)</strong></td><td>조건부 행</td><td>WHERE 조건 만족하는 행만</td><td>특정 상태 데이터</td><td><code>CREATE INDEX idx ON t(col) WHERE status='active';</code></td></tr><tr><td><strong>함수 인덱스<br>(Function-Based)</strong></td><td>계산된 값</td><td>함수/표현식 결과 인덱싱</td><td>변환된 값 검색</td><td><code>CREATE INDEX idx ON t(LOWER(name));</code></td></tr><tr><td><strong>복합 인덱스<br>(Composite)</strong></td><td>여러 컬럼</td><td>2개 이상 컬럼 조합</td><td>다중 조건 쿼리</td><td><code>CREATE INDEX idx ON t(col1, col2);</code></td></tr><tr><td><strong>단일 컬럼<br>(Single-Column)</strong></td><td>단일 컬럼</td><td>한 컬럼만 인덱싱</td><td>단순 조건</td><td><code>CREATE INDEX idx ON t(col);</code></td></tr></tbody></table><p><strong>분류 기준 4: 데이터 타입별 특수 인덱스</strong></p><table><thead><tr><th>데이터 타입</th><th>인덱스 유형</th><th>기술</th><th>적용 예시</th><th>DBMS 지원</th></tr></thead><tbody><tr><td><strong>텍스트</strong></td><td>Full-Text Index</td><td>역색인, TF-IDF</td><td>문서 검색, 키워드 검색</td><td>MySQL, PostgreSQL, SQL Server</td></tr><tr><td><strong>공간</strong></td><td>Spatial Index (R-Tree)</td><td>공간 분할, MBR</td><td>GIS, 위치 기반 검색</td><td>PostGIS, MySQL Spatial</td></tr><tr><td><strong>JSON</strong></td><td>JSON Index (GIN, GiST)</td><td>경로 인덱싱</td><td>반구조화 데이터</td><td>PostgreSQL, MongoDB</td></tr><tr><td><strong>배열</strong></td><td>Array Index (GIN)</td><td>요소별 인덱싱</td><td>배열 요소 검색</td><td>PostgreSQL</td></tr><tr><td><strong>시계열</strong></td><td>Time-Series Index</td><td>시간 파티셔닝</td><td>로그, 메트릭 데이터</td><td>TimescaleDB, InfluxDB</td></tr><tr><td><strong>그래프</strong></td><td>Graph Index</td><td>인접 리스트</td><td>관계 탐색</td><td>Neo4j, JanusGraph</td></tr></tbody></table><p><strong>분류 기준 5: 갱신 전략에 따른 분류</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-155-1><a class=lnlinks href=#hl-155-1> 1</a>
</span><span class=lnt id=hl-155-2><a class=lnlinks href=#hl-155-2> 2</a>
</span><span class=lnt id=hl-155-3><a class=lnlinks href=#hl-155-3> 3</a>
</span><span class=lnt id=hl-155-4><a class=lnlinks href=#hl-155-4> 4</a>
</span><span class=lnt id=hl-155-5><a class=lnlinks href=#hl-155-5> 5</a>
</span><span class=lnt id=hl-155-6><a class=lnlinks href=#hl-155-6> 6</a>
</span><span class=lnt id=hl-155-7><a class=lnlinks href=#hl-155-7> 7</a>
</span><span class=lnt id=hl-155-8><a class=lnlinks href=#hl-155-8> 8</a>
</span><span class=lnt id=hl-155-9><a class=lnlinks href=#hl-155-9> 9</a>
</span><span class=lnt id=hl-155-10><a class=lnlinks href=#hl-155-10>10</a>
</span><span class=lnt id=hl-155-11><a class=lnlinks href=#hl-155-11>11</a>
</span><span class=lnt id=hl-155-12><a class=lnlinks href=#hl-155-12>12</a>
</span><span class=lnt id=hl-155-13><a class=lnlinks href=#hl-155-13>13</a>
</span><span class=lnt id=hl-155-14><a class=lnlinks href=#hl-155-14>14</a>
</span><span class=lnt id=hl-155-15><a class=lnlinks href=#hl-155-15>15</a>
</span><span class=lnt id=hl-155-16><a class=lnlinks href=#hl-155-16>16</a>
</span><span class=lnt id=hl-155-17><a class=lnlinks href=#hl-155-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>실시간 갱신 인덱스:
</span></span><span class=line><span class=cl>├─ B-Tree: 즉시 갱신, 트랜잭션 일관성
</span></span><span class=line><span class=cl>├─ Hash: 즉시 갱신, 간단한 구조
</span></span><span class=line><span class=cl>└─ 장점: 항상 최신 상태
</span></span><span class=line><span class=cl>    단점: 쓰기 오버헤드 높음
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>쓰기 최적화 인덱스:
</span></span><span class=line><span class=cl>├─ LSM-Tree: 메모리 버퍼 → 디스크 병합
</span></span><span class=line><span class=cl>├─ Append-Only: 추가만, 주기적 압축
</span></span><span class=line><span class=cl>└─ 장점: 높은 쓰기 처리량
</span></span><span class=line><span class=cl>    단점: 읽기 증폭, 지연된 반영
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>하이브리드:
</span></span><span class=line><span class=cl>├─ Delta + Base: 최근 변경 + 주 인덱스
</span></span><span class=line><span class=cl>├─ Hot + Cold: 활성 + 아카이브
</span></span><span class=line><span class=cl>└─ 장점: 읽기/쓰기 균형
</span></span><span class=line><span class=cl>    단점: 복잡한 관리
</span></span></code></pre></td></tr></table></div></div><p><strong>분류 기준 6: 분산 환경 인덱스</strong></p><table><thead><tr><th>유형</th><th>범위</th><th>특징</th><th>장점</th><th>단점</th><th>사용 시나리오</th></tr></thead><tbody><tr><td><strong>로컬 인덱스<br>(Local Index)</strong></td><td>샤드/파티션 내부</td><td>각 노드 독립 인덱스</td><td>쓰기 빠름, 관리 단순</td><td>크로스 샤드 느림</td><td>샤딩 키 포함 쿼리</td></tr><tr><td><strong>글로벌 인덱스<br>(Global Index)</strong></td><td>전체 클러스터</td><td>통합 인덱스</td><td>모든 쿼리 빠름</td><td>분산 트랜잭션 필요</td><td>샤딩 키 없는 쿼리</td></tr><tr><td><strong>파티션 인덱스<br>(Partitioned)</strong></td><td>파티션별</td><td>파티션 키 기반 분산</td><td>병렬 처리, 독립 관리</td><td>파티션 키 의존</td><td>시계열, 지역별 데이터</td></tr></tbody></table><p><strong>실무 선택 가이드</strong></p><pre class=mermaid>graph TD
    A[인덱스 선택 시작] --&gt; B{쿼리 패턴?}
    
    B --&gt;|등가 검색만| C[Hash Index]
    B --&gt;|범위 검색| D[B-Tree/B+ Tree]
    B --&gt;|텍스트 검색| E[Full-Text Index]
    B --&gt;|공간 검색| F[R-Tree/Spatial]
    
    D --&gt; G{카디널리티?}
    G --&gt;|높음| H[B-Tree]
    G --&gt;|낮음| I[Bitmap Index]
    
    H --&gt; J{쓰기 빈도?}
    J --&gt;|높음| K[LSM-Tree]
    J --&gt;|낮음| H
    
    I --&gt; L{읽기 패턴?}
    L --&gt;|복잡 조건| I
    L --&gt;|단순| H
    
    style C fill:#90EE90
    style H fill:#90EE90
    style E fill:#87CEEB
    style F fill:#87CEEB
    style K fill:#FFE4B5
</pre><h4 id=43-도구-및-라이브러리-생태계-1>4.3 도구 및 라이브러리 생태계<a hidden class=anchor aria-hidden=true href=#43-도구-및-라이브러리-생태계-1>#</a></h4><p><strong>DBMS별 인덱스 지원 현황</strong></p><p><strong>관계형 데이터베이스</strong></p><table><thead><tr><th>DBMS</th><th>기본 인덱스</th><th>특수 인덱스</th><th>고급 기능</th><th>특징</th></tr></thead><tbody><tr><td><strong>PostgreSQL</strong></td><td>B-Tree, Hash</td><td>GiST, GIN, SP-GiST, BRIN</td><td>부분/함수 인덱스, 병렬 빌드</td><td>가장 다양한 인덱스 지원</td></tr><tr><td><strong>MySQL/MariaDB</strong></td><td>B+ Tree, Hash(Memory)</td><td>Full-Text, Spatial(R-Tree)</td><td>커버링 인덱스, Invisible</td><td>InnoDB 최적화 우수</td></tr><tr><td><strong>Oracle</strong></td><td>B-Tree, Bitmap</td><td>Function-Based, Domain</td><td>인덱스 압축, 파티션 인덱스</td><td>엔터프라이즈 기능 풍부</td></tr><tr><td><strong>SQL Server</strong></td><td>B+ Tree, Hash(In-Memory)</td><td>Columnstore, XML, Spatial</td><td>필터링 인덱스, 포함 컬럼</td><td>Columnstore 성능 우수</td></tr><tr><td><strong>SQLite</strong></td><td>B-Tree</td><td>Full-Text(FTS5)</td><td>단순, 경량</td><td>임베디드 환경 최적</td></tr></tbody></table><p><strong>PostgreSQL 인덱스 생태계 (가장 풍부)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-157-1><a class=lnlinks href=#hl-157-1> 1</a>
</span><span class=lnt id=hl-157-2><a class=lnlinks href=#hl-157-2> 2</a>
</span><span class=lnt id=hl-157-3><a class=lnlinks href=#hl-157-3> 3</a>
</span><span class=lnt id=hl-157-4><a class=lnlinks href=#hl-157-4> 4</a>
</span><span class=lnt id=hl-157-5><a class=lnlinks href=#hl-157-5> 5</a>
</span><span class=lnt id=hl-157-6><a class=lnlinks href=#hl-157-6> 6</a>
</span><span class=lnt id=hl-157-7><a class=lnlinks href=#hl-157-7> 7</a>
</span><span class=lnt id=hl-157-8><a class=lnlinks href=#hl-157-8> 8</a>
</span><span class=lnt id=hl-157-9><a class=lnlinks href=#hl-157-9> 9</a>
</span><span class=lnt id=hl-157-10><a class=lnlinks href=#hl-157-10>10</a>
</span><span class=lnt id=hl-157-11><a class=lnlinks href=#hl-157-11>11</a>
</span><span class=lnt id=hl-157-12><a class=lnlinks href=#hl-157-12>12</a>
</span><span class=lnt id=hl-157-13><a class=lnlinks href=#hl-157-13>13</a>
</span><span class=lnt id=hl-157-14><a class=lnlinks href=#hl-157-14>14</a>
</span><span class=lnt id=hl-157-15><a class=lnlinks href=#hl-157-15>15</a>
</span><span class=lnt id=hl-157-16><a class=lnlinks href=#hl-157-16>16</a>
</span><span class=lnt id=hl-157-17><a class=lnlinks href=#hl-157-17>17</a>
</span><span class=lnt id=hl-157-18><a class=lnlinks href=#hl-157-18>18</a>
</span><span class=lnt id=hl-157-19><a class=lnlinks href=#hl-157-19>19</a>
</span><span class=lnt id=hl-157-20><a class=lnlinks href=#hl-157-20>20</a>
</span><span class=lnt id=hl-157-21><a class=lnlinks href=#hl-157-21>21</a>
</span><span class=lnt id=hl-157-22><a class=lnlinks href=#hl-157-22>22</a>
</span><span class=lnt id=hl-157-23><a class=lnlinks href=#hl-157-23>23</a>
</span><span class=lnt id=hl-157-24><a class=lnlinks href=#hl-157-24>24</a>
</span><span class=lnt id=hl-157-25><a class=lnlinks href=#hl-157-25>25</a>
</span><span class=lnt id=hl-157-26><a class=lnlinks href=#hl-157-26>26</a>
</span><span class=lnt id=hl-157-27><a class=lnlinks href=#hl-157-27>27</a>
</span><span class=lnt id=hl-157-28><a class=lnlinks href=#hl-157-28>28</a>
</span><span class=lnt id=hl-157-29><a class=lnlinks href=#hl-157-29>29</a>
</span><span class=lnt id=hl-157-30><a class=lnlinks href=#hl-157-30>30</a>
</span><span class=lnt id=hl-157-31><a class=lnlinks href=#hl-157-31>31</a>
</span><span class=lnt id=hl-157-32><a class=lnlinks href=#hl-157-32>32</a>
</span><span class=lnt id=hl-157-33><a class=lnlinks href=#hl-157-33>33</a>
</span><span class=lnt id=hl-157-34><a class=lnlinks href=#hl-157-34>34</a>
</span><span class=lnt id=hl-157-35><a class=lnlinks href=#hl-157-35>35</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- B-Tree (기본)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_btree</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>users</span><span class=p>(</span><span class=n>email</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- Hash (등가 검색)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_hash</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>HASH</span><span class=p>(</span><span class=n>user_id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- GiST (범용 검색 트리)
</span></span></span><span class=line><span class=cl><span class=c1>-- 기하학적 데이터, Full-Text, 범위 타입
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_gist_geo</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>locations</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>GIST</span><span class=p>(</span><span class=n>coordinates</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_gist_range</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>reservations</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>GIST</span><span class=p>(</span><span class=n>date_range</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- GIN (범용 역색인)
</span></span></span><span class=line><span class=cl><span class=c1>-- 배열, JSON, Full-Text
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_gin_array</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>GIN</span><span class=p>(</span><span class=n>tags</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_gin_json</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>documents</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>GIN</span><span class=p>(</span><span class=n>metadata</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_gin_fts</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>articles</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>GIN</span><span class=p>(</span><span class=n>to_tsvector</span><span class=p>(</span><span class=s1>&#39;english&#39;</span><span class=p>,</span><span class=w> </span><span class=n>content</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- SP-GiST (공간 분할)
</span></span></span><span class=line><span class=cl><span class=c1>-- 쿼드 트리, k-d 트리
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_spgist</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>points</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>SPGIST</span><span class=p>(</span><span class=k>location</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- BRIN (블록 범위 인덱스)
</span></span></span><span class=line><span class=cl><span class=c1>-- 시계열, 순차 데이터
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_brin</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>logs</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>BRIN</span><span class=p>(</span><span class=n>created_at</span><span class=p>)</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=p>(</span><span class=n>pages_per_range</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>128</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 부분 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_partial</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;active&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 함수 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_func</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>users</span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>email</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_expr</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>products</span><span class=p>((</span><span class=n>price</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>quantity</span><span class=p>))</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>active</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>true</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 복합 인덱스 (연산자 클래스 지정)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_composite</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>search_terms</span><span class=p>(</span><span class=n>term</span><span class=w> </span><span class=n>text_pattern_ops</span><span class=p>,</span><span class=w> </span><span class=n>category</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>주요 인덱스 확장 기능별 역할</strong></p><table><thead><tr><th>확장/기능</th><th>역할</th><th>인덱스 타입</th><th>주제와의 연관성</th></tr></thead><tbody><tr><td><strong>pg_trgm</strong></td><td>유사도 검색, LIKE &lsquo;%&mldr;%&rsquo;</td><td>GIN, GiST</td><td>트라이그램으로 부분 문자열 검색 지원</td></tr><tr><td><strong>btree_gin</strong></td><td>B-Tree 타입을 GIN에서 사용</td><td>GIN</td><td>복합 조건 쿼리 최적화</td></tr><tr><td><strong>btree_gist</strong></td><td>B-Tree 타입을 GiST에서 사용</td><td>GiST</td><td>제약 조건 검증 가속</td></tr><tr><td><strong>hstore</strong></td><td>Key-Value 저장</td><td>GIN, GiST</td><td>반구조화 데이터 인덱싱</td></tr><tr><td><strong>PostGIS</strong></td><td>공간 데이터 처리</td><td>GiST, SP-GiST</td><td>지리 정보 시스템 인덱싱</td></tr></tbody></table><p><strong>NoSQL 데이터베이스 인덱스</strong></p><table><thead><tr><th>NoSQL 유형</th><th>대표 제품</th><th>인덱스 기술</th><th>특징</th></tr></thead><tbody><tr><td><strong>Document Store</strong></td><td>MongoDB</td><td>B-Tree, Text, Geospatial, Hashed</td><td>유연한 스키마, 복합 인덱스</td></tr><tr><td><strong>Key-Value</strong></td><td>Redis</td><td>Hash Table, Sorted Set</td><td>메모리 기반 초고속</td></tr><tr><td><strong>Column Family</strong></td><td>Cassandra</td><td>Primary Key, Secondary Index</td><td>분산 환경 최적화</td></tr><tr><td><strong>Graph DB</strong></td><td>Neo4j</td><td>Native Graph Index</td><td>관계 탐색 최적화</td></tr><tr><td><strong>Time-Series</strong></td><td>InfluxDB</td><td>TSI (Time-Series Index)</td><td>시간 기반 쿼리 특화</td></tr></tbody></table><p><strong>검색 엔진 및 전문 검색</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-158-1><a class=lnlinks href=#hl-158-1> 1</a>
</span><span class=lnt id=hl-158-2><a class=lnlinks href=#hl-158-2> 2</a>
</span><span class=lnt id=hl-158-3><a class=lnlinks href=#hl-158-3> 3</a>
</span><span class=lnt id=hl-158-4><a class=lnlinks href=#hl-158-4> 4</a>
</span><span class=lnt id=hl-158-5><a class=lnlinks href=#hl-158-5> 5</a>
</span><span class=lnt id=hl-158-6><a class=lnlinks href=#hl-158-6> 6</a>
</span><span class=lnt id=hl-158-7><a class=lnlinks href=#hl-158-7> 7</a>
</span><span class=lnt id=hl-158-8><a class=lnlinks href=#hl-158-8> 8</a>
</span><span class=lnt id=hl-158-9><a class=lnlinks href=#hl-158-9> 9</a>
</span><span class=lnt id=hl-158-10><a class=lnlinks href=#hl-158-10>10</a>
</span><span class=lnt id=hl-158-11><a class=lnlinks href=#hl-158-11>11</a>
</span><span class=lnt id=hl-158-12><a class=lnlinks href=#hl-158-12>12</a>
</span><span class=lnt id=hl-158-13><a class=lnlinks href=#hl-158-13>13</a>
</span><span class=lnt id=hl-158-14><a class=lnlinks href=#hl-158-14>14</a>
</span><span class=lnt id=hl-158-15><a class=lnlinks href=#hl-158-15>15</a>
</span><span class=lnt id=hl-158-16><a class=lnlinks href=#hl-158-16>16</a>
</span><span class=lnt id=hl-158-17><a class=lnlinks href=#hl-158-17>17</a>
</span><span class=lnt id=hl-158-18><a class=lnlinks href=#hl-158-18>18</a>
</span><span class=lnt id=hl-158-19><a class=lnlinks href=#hl-158-19>19</a>
</span><span class=lnt id=hl-158-20><a class=lnlinks href=#hl-158-20>20</a>
</span><span class=lnt id=hl-158-21><a class=lnlinks href=#hl-158-21>21</a>
</span><span class=lnt id=hl-158-22><a class=lnlinks href=#hl-158-22>22</a>
</span><span class=lnt id=hl-158-23><a class=lnlinks href=#hl-158-23>23</a>
</span><span class=lnt id=hl-158-24><a class=lnlinks href=#hl-158-24>24</a>
</span><span class=lnt id=hl-158-25><a class=lnlinks href=#hl-158-25>25</a>
</span><span class=lnt id=hl-158-26><a class=lnlinks href=#hl-158-26>26</a>
</span><span class=lnt id=hl-158-27><a class=lnlinks href=#hl-158-27>27</a>
</span><span class=lnt id=hl-158-28><a class=lnlinks href=#hl-158-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Elasticsearch/OpenSearch:
</span></span><span class=line><span class=cl>├─ 역색인 (Inverted Index)
</span></span><span class=line><span class=cl>│   ├─ Lucene 기반
</span></span><span class=line><span class=cl>│   ├─ 분산 샤딩
</span></span><span class=line><span class=cl>│   └─ 실시간 인덱싱
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>├─ 인덱스 타입
</span></span><span class=line><span class=cl>│   ├─ text: 전문 검색
</span></span><span class=line><span class=cl>│   ├─ keyword: 정확한 매칭
</span></span><span class=line><span class=cl>│   ├─ numeric: 숫자 범위
</span></span><span class=line><span class=cl>│   ├─ geo_point: 위치 검색
</span></span><span class=line><span class=cl>│   └─ nested: 중첩 객체
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>└─ 최적화 기법
</span></span><span class=line><span class=cl>    ├─ 샤드 분산
</span></span><span class=line><span class=cl>    ├─ 레플리카 복제
</span></span><span class=line><span class=cl>    └─ 세그먼트 병합
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Apache Solr:
</span></span><span class=line><span class=cl>├─ Lucene 코어
</span></span><span class=line><span class=cl>├─ 패싯 검색
</span></span><span class=line><span class=cl>├─ 하이라이팅
</span></span><span class=line><span class=cl>└─ 제안 (Suggestion)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Sphinx:
</span></span><span class=line><span class=cl>├─ Full-Text 특화
</span></span><span class=line><span class=cl>├─ 실시간 인덱스
</span></span><span class=line><span class=cl>└─ 분산 검색
</span></span></code></pre></td></tr></table></div></div><p><strong>인메모리 데이터베이스 인덱스</strong></p><table><thead><tr><th>제품</th><th>인덱스 구조</th><th>특징</th><th>사용 사례</th></tr></thead><tbody><tr><td><strong>Redis</strong></td><td>Hash, Sorted Set, Bitmap</td><td>초고속, 영속성 옵션</td><td>캐싱, 세션, 리더보드</td></tr><tr><td><strong>Memcached</strong></td><td>Hash Table</td><td>단순, 빠름</td><td>순수 캐시</td></tr><tr><td><strong>SAP HANA</strong></td><td>Column Store, B+ Tree</td><td>실시간 분석</td><td>HTAP 워크로드</td></tr><tr><td><strong>VoltDB</strong></td><td>B+ Tree, Hash</td><td>ACID 트랜잭션</td><td>고성능 OLTP</td></tr></tbody></table><p><strong>분산 데이터베이스 인덱스</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-159-1><a class=lnlinks href=#hl-159-1> 1</a>
</span><span class=lnt id=hl-159-2><a class=lnlinks href=#hl-159-2> 2</a>
</span><span class=lnt id=hl-159-3><a class=lnlinks href=#hl-159-3> 3</a>
</span><span class=lnt id=hl-159-4><a class=lnlinks href=#hl-159-4> 4</a>
</span><span class=lnt id=hl-159-5><a class=lnlinks href=#hl-159-5> 5</a>
</span><span class=lnt id=hl-159-6><a class=lnlinks href=#hl-159-6> 6</a>
</span><span class=lnt id=hl-159-7><a class=lnlinks href=#hl-159-7> 7</a>
</span><span class=lnt id=hl-159-8><a class=lnlinks href=#hl-159-8> 8</a>
</span><span class=lnt id=hl-159-9><a class=lnlinks href=#hl-159-9> 9</a>
</span><span class=lnt id=hl-159-10><a class=lnlinks href=#hl-159-10>10</a>
</span><span class=lnt id=hl-159-11><a class=lnlinks href=#hl-159-11>11</a>
</span><span class=lnt id=hl-159-12><a class=lnlinks href=#hl-159-12>12</a>
</span><span class=lnt id=hl-159-13><a class=lnlinks href=#hl-159-13>13</a>
</span><span class=lnt id=hl-159-14><a class=lnlinks href=#hl-159-14>14</a>
</span><span class=lnt id=hl-159-15><a class=lnlinks href=#hl-159-15>15</a>
</span><span class=lnt id=hl-159-16><a class=lnlinks href=#hl-159-16>16</a>
</span><span class=lnt id=hl-159-17><a class=lnlinks href=#hl-159-17>17</a>
</span><span class=lnt id=hl-159-18><a class=lnlinks href=#hl-159-18>18</a>
</span><span class=lnt id=hl-159-19><a class=lnlinks href=#hl-159-19>19</a>
</span><span class=lnt id=hl-159-20><a class=lnlinks href=#hl-159-20>20</a>
</span><span class=lnt id=hl-159-21><a class=lnlinks href=#hl-159-21>21</a>
</span><span class=lnt id=hl-159-22><a class=lnlinks href=#hl-159-22>22</a>
</span><span class=lnt id=hl-159-23><a class=lnlinks href=#hl-159-23>23</a>
</span><span class=lnt id=hl-159-24><a class=lnlinks href=#hl-159-24>24</a>
</span><span class=lnt id=hl-159-25><a class=lnlinks href=#hl-159-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>분산 인덱스 패턴:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. Sharding + Local Index
</span></span><span class=line><span class=cl>   예: MySQL Sharding
</span></span><span class=line><span class=cl>   ├─ 각 샤드에 독립 인덱스
</span></span><span class=line><span class=cl>   ├─ 샤딩 키 포함 쿼리 최적
</span></span><span class=line><span class=cl>   └─ 크로스 샤드 쿼리 느림
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. Global Secondary Index
</span></span><span class=line><span class=cl>   예: DynamoDB GSI
</span></span><span class=line><span class=cl>   ├─ 클러스터 전체 인덱스
</span></span><span class=line><span class=cl>   ├─ 모든 쿼리 지원
</span></span><span class=line><span class=cl>   └─ 최종 일관성 (eventually consistent)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. Distributed Hash Table
</span></span><span class=line><span class=cl>   예: Cassandra
</span></span><span class=line><span class=cl>   ├─ 해시 링 기반
</span></span><span class=line><span class=cl>   ├─ 파티션 키 필수
</span></span><span class=line><span class=cl>   └─ 수평 확장 용이
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4. Consistent Hashing + Range Index
</span></span><span class=line><span class=cl>   예: CockroachDB
</span></span><span class=line><span class=cl>   ├─ 자동 리밸런싱
</span></span><span class=line><span class=cl>   ├─ B-Tree 인덱스
</span></span><span class=line><span class=cl>   └─ 분산 트랜잭션
</span></span></code></pre></td></tr></table></div></div><p><strong>인덱스 관리 도구</strong></p><table><thead><tr><th>카테고리</th><th>도구</th><th>기능</th><th>주제와의 연관성</th></tr></thead><tbody><tr><td><strong>성능 분석</strong></td><td>pg_stat_statements</td><td>쿼리 통계, 인덱스 사용률 추적</td><td>미사용 인덱스 식별, 쿼리 최적화</td></tr><tr><td></td><td>EXPLAIN ANALYZE</td><td>실행 계획 분석</td><td>인덱스 선택 검증</td></tr><tr><td></td><td>MySQL Slow Query Log</td><td>느린 쿼리 기록</td><td>인덱스 누락 탐지</td></tr><tr><td><strong>자동화</strong></td><td>pg_indexadvisor</td><td>인덱스 추천</td><td>자동 인덱스 후보 제안</td></tr><tr><td></td><td>Dexter (PostgreSQL)</td><td>로그 기반 인덱스 제안</td><td>워크로드 분석</td></tr><tr><td></td><td>Database Tuning Advisor (SQL Server)</td><td>자동 인덱스 권장</td><td>마이크로소프트 통합 도구</td></tr><tr><td><strong>모니터링</strong></td><td>pgBadger</td><td>로그 분석, 인덱스 사용 현황</td><td>성능 병목 시각화</td></tr><tr><td></td><td>Percona Toolkit</td><td>MySQL 인덱스 분석</td><td>중복 인덱스 탐지</td></tr><tr><td></td><td>pt-duplicate-key-checker</td><td>중복 인덱스 찾기</td><td>불필요한 인덱스 제거</td></tr><tr><td><strong>유지보수</strong></td><td>pg_repack</td><td>온라인 인덱스 재구성</td><td>서비스 중단 없이 재구성</td></tr><tr><td></td><td>REINDEX CONCURRENTLY</td><td>동시 접근 허용 재구성</td><td>가용성 유지</td></tr></tbody></table><p><strong>프로그래밍 언어별 인덱스 라이브러리</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-160-1><a class=lnlinks href=#hl-160-1> 1</a>
</span><span class=lnt id=hl-160-2><a class=lnlinks href=#hl-160-2> 2</a>
</span><span class=lnt id=hl-160-3><a class=lnlinks href=#hl-160-3> 3</a>
</span><span class=lnt id=hl-160-4><a class=lnlinks href=#hl-160-4> 4</a>
</span><span class=lnt id=hl-160-5><a class=lnlinks href=#hl-160-5> 5</a>
</span><span class=lnt id=hl-160-6><a class=lnlinks href=#hl-160-6> 6</a>
</span><span class=lnt id=hl-160-7><a class=lnlinks href=#hl-160-7> 7</a>
</span><span class=lnt id=hl-160-8><a class=lnlinks href=#hl-160-8> 8</a>
</span><span class=lnt id=hl-160-9><a class=lnlinks href=#hl-160-9> 9</a>
</span><span class=lnt id=hl-160-10><a class=lnlinks href=#hl-160-10>10</a>
</span><span class=lnt id=hl-160-11><a class=lnlinks href=#hl-160-11>11</a>
</span><span class=lnt id=hl-160-12><a class=lnlinks href=#hl-160-12>12</a>
</span><span class=lnt id=hl-160-13><a class=lnlinks href=#hl-160-13>13</a>
</span><span class=lnt id=hl-160-14><a class=lnlinks href=#hl-160-14>14</a>
</span><span class=lnt id=hl-160-15><a class=lnlinks href=#hl-160-15>15</a>
</span><span class=lnt id=hl-160-16><a class=lnlinks href=#hl-160-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python - SQLAlchemy</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy</span> <span class=kn>import</span> <span class=n>Index</span><span class=p>,</span> <span class=n>Column</span><span class=p>,</span> <span class=n>Integer</span><span class=p>,</span> <span class=n>String</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 단일 인덱스</span>
</span></span><span class=line><span class=cl><span class=n>idx</span> <span class=o>=</span> <span class=n>Index</span><span class=p>(</span><span class=s1>&#39;ix_user_email&#39;</span><span class=p>,</span> <span class=n>User</span><span class=o>.</span><span class=n>email</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 복합 인덱스</span>
</span></span><span class=line><span class=cl><span class=n>idx</span> <span class=o>=</span> <span class=n>Index</span><span class=p>(</span><span class=s1>&#39;ix_user_name_email&#39;</span><span class=p>,</span> <span class=n>User</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=n>User</span><span class=o>.</span><span class=n>email</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 함수 인덱스</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sqlalchemy</span> <span class=kn>import</span> <span class=n>func</span>
</span></span><span class=line><span class=cl><span class=n>idx</span> <span class=o>=</span> <span class=n>Index</span><span class=p>(</span><span class=s1>&#39;ix_lower_email&#39;</span><span class=p>,</span> <span class=n>func</span><span class=o>.</span><span class=n>lower</span><span class=p>(</span><span class=n>User</span><span class=o>.</span><span class=n>email</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 부분 인덱스</span>
</span></span><span class=line><span class=cl><span class=n>idx</span> <span class=o>=</span> <span class=n>Index</span><span class=p>(</span><span class=s1>&#39;ix_active_users&#39;</span><span class=p>,</span> <span class=n>User</span><span class=o>.</span><span class=n>email</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>            <span class=n>postgresql_where</span><span class=o>=</span><span class=p>(</span><span class=n>User</span><span class=o>.</span><span class=n>active</span> <span class=o>==</span> <span class=kc>True</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-161-1><a class=lnlinks href=#hl-161-1> 1</a>
</span><span class=lnt id=hl-161-2><a class=lnlinks href=#hl-161-2> 2</a>
</span><span class=lnt id=hl-161-3><a class=lnlinks href=#hl-161-3> 3</a>
</span><span class=lnt id=hl-161-4><a class=lnlinks href=#hl-161-4> 4</a>
</span><span class=lnt id=hl-161-5><a class=lnlinks href=#hl-161-5> 5</a>
</span><span class=lnt id=hl-161-6><a class=lnlinks href=#hl-161-6> 6</a>
</span><span class=lnt id=hl-161-7><a class=lnlinks href=#hl-161-7> 7</a>
</span><span class=lnt id=hl-161-8><a class=lnlinks href=#hl-161-8> 8</a>
</span><span class=lnt id=hl-161-9><a class=lnlinks href=#hl-161-9> 9</a>
</span><span class=lnt id=hl-161-10><a class=lnlinks href=#hl-161-10>10</a>
</span><span class=lnt id=hl-161-11><a class=lnlinks href=#hl-161-11>11</a>
</span><span class=lnt id=hl-161-12><a class=lnlinks href=#hl-161-12>12</a>
</span><span class=lnt id=hl-161-13><a class=lnlinks href=#hl-161-13>13</a>
</span><span class=lnt id=hl-161-14><a class=lnlinks href=#hl-161-14>14</a>
</span><span class=lnt id=hl-161-15><a class=lnlinks href=#hl-161-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Node.js - Mongoose (MongoDB)
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>userSchema</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Schema</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>email</span><span class=o>:</span> <span class=p>{</span> <span class=nx>type</span><span class=o>:</span> <span class=nb>String</span><span class=p>,</span> <span class=nx>index</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=nx>unique</span><span class=o>:</span> <span class=kc>true</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=p>{</span> <span class=nx>type</span><span class=o>:</span> <span class=nb>String</span><span class=p>,</span> <span class=nx>index</span><span class=o>:</span> <span class=kc>true</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>location</span><span class=o>:</span> <span class=p>{</span> <span class=nx>type</span><span class=o>:</span> <span class=p>{</span> <span class=nx>type</span><span class=o>:</span> <span class=nb>String</span> <span class=p>},</span> <span class=nx>coordinates</span><span class=o>:</span> <span class=p>[</span><span class=nb>Number</span><span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 지리 공간 인덱스
</span></span></span><span class=line><span class=cl><span class=nx>userSchema</span><span class=p>.</span><span class=nx>index</span><span class=p>({</span> <span class=nx>location</span><span class=o>:</span> <span class=s1>&#39;2dsphere&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 복합 인덱스
</span></span></span><span class=line><span class=cl><span class=nx>userSchema</span><span class=p>.</span><span class=nx>index</span><span class=p>({</span> <span class=nx>name</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>email</span><span class=o>:</span> <span class=mi>1</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 텍스트 인덱스
</span></span></span><span class=line><span class=cl><span class=nx>userSchema</span><span class=p>.</span><span class=nx>index</span><span class=p>({</span> <span class=nx>bio</span><span class=o>:</span> <span class=s1>&#39;text&#39;</span><span class=p>,</span> <span class=nx>skills</span><span class=o>:</span> <span class=s1>&#39;text&#39;</span> <span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-162-1><a class=lnlinks href=#hl-162-1> 1</a>
</span><span class=lnt id=hl-162-2><a class=lnlinks href=#hl-162-2> 2</a>
</span><span class=lnt id=hl-162-3><a class=lnlinks href=#hl-162-3> 3</a>
</span><span class=lnt id=hl-162-4><a class=lnlinks href=#hl-162-4> 4</a>
</span><span class=lnt id=hl-162-5><a class=lnlinks href=#hl-162-5> 5</a>
</span><span class=lnt id=hl-162-6><a class=lnlinks href=#hl-162-6> 6</a>
</span><span class=lnt id=hl-162-7><a class=lnlinks href=#hl-162-7> 7</a>
</span><span class=lnt id=hl-162-8><a class=lnlinks href=#hl-162-8> 8</a>
</span><span class=lnt id=hl-162-9><a class=lnlinks href=#hl-162-9> 9</a>
</span><span class=lnt id=hl-162-10><a class=lnlinks href=#hl-162-10>10</a>
</span><span class=lnt id=hl-162-11><a class=lnlinks href=#hl-162-11>11</a>
</span><span class=lnt id=hl-162-12><a class=lnlinks href=#hl-162-12>12</a>
</span><span class=lnt id=hl-162-13><a class=lnlinks href=#hl-162-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Java - Hibernate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;users&#34;</span><span class=p>,</span><span class=w> </span><span class=n>indexes</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Index</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;idx_email&#34;</span><span class=p>,</span><span class=w> </span><span class=n>columnList</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;email&#34;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Index</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;idx_name_email&#34;</span><span class=p>,</span><span class=w> </span><span class=n>columnList</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;name,email&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>})</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>User</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=p>(</span><span class=n>unique</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>true</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>email</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Column</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=44-표준-및-규격-준수사항-1>4.4 표준 및 규격 준수사항<a hidden class=anchor aria-hidden=true href=#44-표준-및-규격-준수사항-1>#</a></h4><p><strong>SQL 표준 인덱스 구문</strong></p><p><strong>ISO/IEC 9075 (SQL 표준) 관련 사항</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-163-1><a class=lnlinks href=#hl-163-1> 1</a>
</span><span class=lnt id=hl-163-2><a class=lnlinks href=#hl-163-2> 2</a>
</span><span class=lnt id=hl-163-3><a class=lnlinks href=#hl-163-3> 3</a>
</span><span class=lnt id=hl-163-4><a class=lnlinks href=#hl-163-4> 4</a>
</span><span class=lnt id=hl-163-5><a class=lnlinks href=#hl-163-5> 5</a>
</span><span class=lnt id=hl-163-6><a class=lnlinks href=#hl-163-6> 6</a>
</span><span class=lnt id=hl-163-7><a class=lnlinks href=#hl-163-7> 7</a>
</span><span class=lnt id=hl-163-8><a class=lnlinks href=#hl-163-8> 8</a>
</span><span class=lnt id=hl-163-9><a class=lnlinks href=#hl-163-9> 9</a>
</span><span class=lnt id=hl-163-10><a class=lnlinks href=#hl-163-10>10</a>
</span><span class=lnt id=hl-163-11><a class=lnlinks href=#hl-163-11>11</a>
</span><span class=lnt id=hl-163-12><a class=lnlinks href=#hl-163-12>12</a>
</span><span class=lnt id=hl-163-13><a class=lnlinks href=#hl-163-13>13</a>
</span><span class=lnt id=hl-163-14><a class=lnlinks href=#hl-163-14>14</a>
</span><span class=lnt id=hl-163-15><a class=lnlinks href=#hl-163-15>15</a>
</span><span class=lnt id=hl-163-16><a class=lnlinks href=#hl-163-16>16</a>
</span><span class=lnt id=hl-163-17><a class=lnlinks href=#hl-163-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- ANSI SQL 표준 인덱스 생성 (기본)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>index_name</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=p>(</span><span class=k>column_name</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 고유 인덱스 (SQL-92)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>index_name</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=p>(</span><span class=k>column_name</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 복합 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>index_name</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=p>(</span><span class=n>col1</span><span class=p>,</span><span class=w> </span><span class=n>col2</span><span class=p>,</span><span class=w> </span><span class=n>col3</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스 삭제
</span></span></span><span class=line><span class=cl><span class=k>DROP</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>index_name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 표준에서 명시하지 않은 부분 (DBMS 확장):
</span></span></span><span class=line><span class=cl><span class=c1>-- - 인덱스 유형 지정 (USING)
</span></span></span><span class=line><span class=cl><span class=c1>-- - 부분 인덱스 (WHERE)
</span></span></span><span class=line><span class=cl><span class=c1>-- - 함수 인덱스
</span></span></span><span class=line><span class=cl><span class=c1>-- - 인덱스 힌트
</span></span></span></code></pre></td></tr></table></div></div><p><strong>DBMS별 표준 준수 및 확장</strong></p><table><thead><tr><th>표준 기능</th><th>PostgreSQL</th><th>MySQL</th><th>Oracle</th><th>SQL Server</th><th>표준 여부</th></tr></thead><tbody><tr><td>CREATE INDEX</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>SQL-92</td></tr><tr><td>UNIQUE INDEX</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>SQL-92</td></tr><tr><td>DROP INDEX</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>SQL-92</td></tr><tr><td>Composite Index</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>SQL-92</td></tr><tr><td>ASC/DESC</td><td>✓</td><td>✓</td><td>✓</td><td>✓</td><td>SQL:2003</td></tr><tr><td>Partial Index</td><td>✓ (WHERE)</td><td>✗</td><td>✗</td><td>✓ (WHERE)</td><td>비표준</td></tr><tr><td>Function Index</td><td>✓</td><td>✓ (5.7+)</td><td>✓</td><td>✓</td><td>비표준</td></tr><tr><td>Index Types</td><td>✓ (USING)</td><td>✓ (USING)</td><td>✓</td><td>✓</td><td>비표준</td></tr><tr><td>INCLUDE columns</td><td>✓ (11+)</td><td>✗</td><td>✓</td><td>✓</td><td>비표준</td></tr></tbody></table><p><strong>인덱스 명명 규칙 (베스트 프랙티스)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-164-1><a class=lnlinks href=#hl-164-1> 1</a>
</span><span class=lnt id=hl-164-2><a class=lnlinks href=#hl-164-2> 2</a>
</span><span class=lnt id=hl-164-3><a class=lnlinks href=#hl-164-3> 3</a>
</span><span class=lnt id=hl-164-4><a class=lnlinks href=#hl-164-4> 4</a>
</span><span class=lnt id=hl-164-5><a class=lnlinks href=#hl-164-5> 5</a>
</span><span class=lnt id=hl-164-6><a class=lnlinks href=#hl-164-6> 6</a>
</span><span class=lnt id=hl-164-7><a class=lnlinks href=#hl-164-7> 7</a>
</span><span class=lnt id=hl-164-8><a class=lnlinks href=#hl-164-8> 8</a>
</span><span class=lnt id=hl-164-9><a class=lnlinks href=#hl-164-9> 9</a>
</span><span class=lnt id=hl-164-10><a class=lnlinks href=#hl-164-10>10</a>
</span><span class=lnt id=hl-164-11><a class=lnlinks href=#hl-164-11>11</a>
</span><span class=lnt id=hl-164-12><a class=lnlinks href=#hl-164-12>12</a>
</span><span class=lnt id=hl-164-13><a class=lnlinks href=#hl-164-13>13</a>
</span><span class=lnt id=hl-164-14><a class=lnlinks href=#hl-164-14>14</a>
</span><span class=lnt id=hl-164-15><a class=lnlinks href=#hl-164-15>15</a>
</span><span class=lnt id=hl-164-16><a class=lnlinks href=#hl-164-16>16</a>
</span><span class=lnt id=hl-164-17><a class=lnlinks href=#hl-164-17>17</a>
</span><span class=lnt id=hl-164-18><a class=lnlinks href=#hl-164-18>18</a>
</span><span class=lnt id=hl-164-19><a class=lnlinks href=#hl-164-19>19</a>
</span><span class=lnt id=hl-164-20><a class=lnlinks href=#hl-164-20>20</a>
</span><span class=lnt id=hl-164-21><a class=lnlinks href=#hl-164-21>21</a>
</span><span class=lnt id=hl-164-22><a class=lnlinks href=#hl-164-22>22</a>
</span><span class=lnt id=hl-164-23><a class=lnlinks href=#hl-164-23>23</a>
</span><span class=lnt id=hl-164-24><a class=lnlinks href=#hl-164-24>24</a>
</span><span class=lnt id=hl-164-25><a class=lnlinks href=#hl-164-25>25</a>
</span><span class=lnt id=hl-164-26><a class=lnlinks href=#hl-164-26>26</a>
</span><span class=lnt id=hl-164-27><a class=lnlinks href=#hl-164-27>27</a>
</span><span class=lnt id=hl-164-28><a class=lnlinks href=#hl-164-28>28</a>
</span><span class=lnt id=hl-164-29><a class=lnlinks href=#hl-164-29>29</a>
</span><span class=lnt id=hl-164-30><a class=lnlinks href=#hl-164-30>30</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>일반 관례:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. 접두사 사용:
</span></span><span class=line><span class=cl>   idx_  : 일반 인덱스
</span></span><span class=line><span class=cl>   uq_   : 고유 인덱스
</span></span><span class=line><span class=cl>   fk_   : 외래 키 인덱스
</span></span><span class=line><span class=cl>   pk_   : 기본 키
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 명명 패턴:
</span></span><span class=line><span class=cl>   [접두사]_[테이블명]_[컬럼명(들)]
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   예시:
</span></span><span class=line><span class=cl>   idx_users_email
</span></span><span class=line><span class=cl>   uq_orders_order_number
</span></span><span class=line><span class=cl>   idx_products_category_price
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 복합 인덱스:
</span></span><span class=line><span class=cl>   컬럼 순서대로 나열
</span></span><span class=line><span class=cl>   idx_orders_customer_date
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>4. 특수 인덱스:
</span></span><span class=line><span class=cl>   idx_users_name_gin    (GIN 인덱스)
</span></span><span class=line><span class=cl>   idx_locations_geo     (공간 인덱스)
</span></span><span class=line><span class=cl>   idx_articles_fts      (Full-Text)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>5. 길이 제한:
</span></span><span class=line><span class=cl>   - PostgreSQL: 63자
</span></span><span class=line><span class=cl>   - MySQL: 64자
</span></span><span class=line><span class=cl>   - Oracle: 30자 (12c 이전), 128자 (12c+)
</span></span><span class=line><span class=cl>   - SQL Server: 128자
</span></span></code></pre></td></tr></table></div></div><p><strong>인덱스 메타데이터 표준 접근</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-165-1><a class=lnlinks href=#hl-165-1> 1</a>
</span><span class=lnt id=hl-165-2><a class=lnlinks href=#hl-165-2> 2</a>
</span><span class=lnt id=hl-165-3><a class=lnlinks href=#hl-165-3> 3</a>
</span><span class=lnt id=hl-165-4><a class=lnlinks href=#hl-165-4> 4</a>
</span><span class=lnt id=hl-165-5><a class=lnlinks href=#hl-165-5> 5</a>
</span><span class=lnt id=hl-165-6><a class=lnlinks href=#hl-165-6> 6</a>
</span><span class=lnt id=hl-165-7><a class=lnlinks href=#hl-165-7> 7</a>
</span><span class=lnt id=hl-165-8><a class=lnlinks href=#hl-165-8> 8</a>
</span><span class=lnt id=hl-165-9><a class=lnlinks href=#hl-165-9> 9</a>
</span><span class=lnt id=hl-165-10><a class=lnlinks href=#hl-165-10>10</a>
</span><span class=lnt id=hl-165-11><a class=lnlinks href=#hl-165-11>11</a>
</span><span class=lnt id=hl-165-12><a class=lnlinks href=#hl-165-12>12</a>
</span><span class=lnt id=hl-165-13><a class=lnlinks href=#hl-165-13>13</a>
</span><span class=lnt id=hl-165-14><a class=lnlinks href=#hl-165-14>14</a>
</span><span class=lnt id=hl-165-15><a class=lnlinks href=#hl-165-15>15</a>
</span><span class=lnt id=hl-165-16><a class=lnlinks href=#hl-165-16>16</a>
</span><span class=lnt id=hl-165-17><a class=lnlinks href=#hl-165-17>17</a>
</span><span class=lnt id=hl-165-18><a class=lnlinks href=#hl-165-18>18</a>
</span><span class=lnt id=hl-165-19><a class=lnlinks href=#hl-165-19>19</a>
</span><span class=lnt id=hl-165-20><a class=lnlinks href=#hl-165-20>20</a>
</span><span class=lnt id=hl-165-21><a class=lnlinks href=#hl-165-21>21</a>
</span><span class=lnt id=hl-165-22><a class=lnlinks href=#hl-165-22>22</a>
</span><span class=lnt id=hl-165-23><a class=lnlinks href=#hl-165-23>23</a>
</span><span class=lnt id=hl-165-24><a class=lnlinks href=#hl-165-24>24</a>
</span><span class=lnt id=hl-165-25><a class=lnlinks href=#hl-165-25>25</a>
</span><span class=lnt id=hl-165-26><a class=lnlinks href=#hl-165-26>26</a>
</span><span class=lnt id=hl-165-27><a class=lnlinks href=#hl-165-27>27</a>
</span><span class=lnt id=hl-165-28><a class=lnlinks href=#hl-165-28>28</a>
</span><span class=lnt id=hl-165-29><a class=lnlinks href=#hl-165-29>29</a>
</span><span class=lnt id=hl-165-30><a class=lnlinks href=#hl-165-30>30</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- ANSI INFORMATION_SCHEMA (표준)
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>table_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>index_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>column_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>ordinal_position</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>information_schema</span><span class=p>.</span><span class=k>statistics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>table_schema</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;mydb&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>table_name</span><span class=p>,</span><span class=w> </span><span class=n>index_name</span><span class=p>,</span><span class=w> </span><span class=n>ordinal_position</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- PostgreSQL 시스템 카탈로그
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>schemaname</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>tablename</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>indexname</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>indexdef</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>pg_indexes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>schemaname</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;public&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- MySQL SHOW 구문
</span></span></span><span class=line><span class=cl><span class=k>SHOW</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>table_name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- Oracle 데이터 딕셔너리
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>table_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>index_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>column_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>column_position</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>user_ind_columns</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>table_name</span><span class=p>,</span><span class=w> </span><span class=n>index_name</span><span class=p>,</span><span class=w> </span><span class=n>column_position</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>성능 및 크기 제약 표준</strong></p><table><thead><tr><th>제약 사항</th><th>PostgreSQL</th><th>MySQL</th><th>Oracle</th><th>SQL Server</th><th>설명</th></tr></thead><tbody><tr><td><strong>최대 키 크기</strong></td><td>8191 bytes</td><td>3072 bytes</td><td>6398 bytes</td><td>900 bytes (non-clustered)</td><td>인덱스 키 총 크기 제한</td></tr><tr><td><strong>최대 컬럼 수</strong></td><td>32</td><td>16</td><td>32</td><td>16 (non-clustered)</td><td>복합 인덱스 컬럼 수</td></tr><tr><td><strong>테이블당 인덱스 수</strong></td><td>제한 없음</td><td>64</td><td>제한 없음</td><td>999</td><td>실무적으로 10-20개 권장</td></tr><tr><td><strong>인덱스 이름 길이</strong></td><td>63</td><td>64</td><td>128 (12c+)</td><td>128</td><td>문자 수 제한</td></tr><tr><td><strong>최대 인덱스 크기</strong></td><td>제한 없음</td><td>제한 없음</td><td>제한 없음</td><td>테이블스페이스 제한</td><td>디스크 용량 의존</td></tr></tbody></table><p><strong>트랜잭션 및 동시성 표준</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-166-1><a class=lnlinks href=#hl-166-1> 1</a>
</span><span class=lnt id=hl-166-2><a class=lnlinks href=#hl-166-2> 2</a>
</span><span class=lnt id=hl-166-3><a class=lnlinks href=#hl-166-3> 3</a>
</span><span class=lnt id=hl-166-4><a class=lnlinks href=#hl-166-4> 4</a>
</span><span class=lnt id=hl-166-5><a class=lnlinks href=#hl-166-5> 5</a>
</span><span class=lnt id=hl-166-6><a class=lnlinks href=#hl-166-6> 6</a>
</span><span class=lnt id=hl-166-7><a class=lnlinks href=#hl-166-7> 7</a>
</span><span class=lnt id=hl-166-8><a class=lnlinks href=#hl-166-8> 8</a>
</span><span class=lnt id=hl-166-9><a class=lnlinks href=#hl-166-9> 9</a>
</span><span class=lnt id=hl-166-10><a class=lnlinks href=#hl-166-10>10</a>
</span><span class=lnt id=hl-166-11><a class=lnlinks href=#hl-166-11>11</a>
</span><span class=lnt id=hl-166-12><a class=lnlinks href=#hl-166-12>12</a>
</span><span class=lnt id=hl-166-13><a class=lnlinks href=#hl-166-13>13</a>
</span><span class=lnt id=hl-166-14><a class=lnlinks href=#hl-166-14>14</a>
</span><span class=lnt id=hl-166-15><a class=lnlinks href=#hl-166-15>15</a>
</span><span class=lnt id=hl-166-16><a class=lnlinks href=#hl-166-16>16</a>
</span><span class=lnt id=hl-166-17><a class=lnlinks href=#hl-166-17>17</a>
</span><span class=lnt id=hl-166-18><a class=lnlinks href=#hl-166-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ACID 속성과 인덱스:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. Atomicity (원자성):
</span></span><span class=line><span class=cl>   - 인덱스 변경도 트랜잭션 일부
</span></span><span class=line><span class=cl>   - COMMIT/ROLLBACK 시 함께 처리
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. Consistency (일관성):
</span></span><span class=line><span class=cl>   - 인덱스는 항상 데이터와 동기화
</span></span><span class=line><span class=cl>   - UNIQUE 제약 위반 방지
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. Isolation (격리성):
</span></span><span class=line><span class=cl>   - 격리 수준에 따른 인덱스 락
</span></span><span class=line><span class=cl>   - Serializable: 범위 락 (key-range lock)
</span></span><span class=line><span class=cl>   - Read Committed: 키 락만
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4. Durability (영속성):
</span></span><span class=line><span class=cl>   - WAL(Write-Ahead Logging)로 보장
</span></span><span class=line><span class=cl>   - 인덱스 변경도 로그 기록
</span></span></code></pre></td></tr></table></div></div><p><strong>SQL:2016 표준의 인덱스 관련 사항</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-167-1><a class=lnlinks href=#hl-167-1> 1</a>
</span><span class=lnt id=hl-167-2><a class=lnlinks href=#hl-167-2> 2</a>
</span><span class=lnt id=hl-167-3><a class=lnlinks href=#hl-167-3> 3</a>
</span><span class=lnt id=hl-167-4><a class=lnlinks href=#hl-167-4> 4</a>
</span><span class=lnt id=hl-167-5><a class=lnlinks href=#hl-167-5> 5</a>
</span><span class=lnt id=hl-167-6><a class=lnlinks href=#hl-167-6> 6</a>
</span><span class=lnt id=hl-167-7><a class=lnlinks href=#hl-167-7> 7</a>
</span><span class=lnt id=hl-167-8><a class=lnlinks href=#hl-167-8> 8</a>
</span><span class=lnt id=hl-167-9><a class=lnlinks href=#hl-167-9> 9</a>
</span><span class=lnt id=hl-167-10><a class=lnlinks href=#hl-167-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- JSON 경로 표현식 (SQL:2016)
</span></span></span><span class=line><span class=cl><span class=c1>-- 일부 DBMS에서 JSON 인덱스 지원
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_json</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>documents</span><span class=p>((</span><span class=k>data</span><span class=o>-&gt;&gt;</span><span class=s1>&#39;$.user.email&#39;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 시간대 인식 타임스탬프 (SQL:2016)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_timestamp</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>events</span><span class=p>(</span><span class=n>event_time</span><span class=w> </span><span class=k>AT</span><span class=w> </span><span class=n>TIME</span><span class=w> </span><span class=k>ZONE</span><span class=w> </span><span class=s1>&#39;UTC&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 다차원 배열 (SQL:1999, 확장)
</span></span></span><span class=line><span class=cl><span class=c1>-- PostgreSQL에서 배열 인덱스 지원
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_array</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>USING</span><span class=w> </span><span class=n>GIN</span><span class=p>(</span><span class=n>tags</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>보안 및 권한 관련 표준</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-168-1><a class=lnlinks href=#hl-168-1> 1</a>
</span><span class=lnt id=hl-168-2><a class=lnlinks href=#hl-168-2> 2</a>
</span><span class=lnt id=hl-168-3><a class=lnlinks href=#hl-168-3> 3</a>
</span><span class=lnt id=hl-168-4><a class=lnlinks href=#hl-168-4> 4</a>
</span><span class=lnt id=hl-168-5><a class=lnlinks href=#hl-168-5> 5</a>
</span><span class=lnt id=hl-168-6><a class=lnlinks href=#hl-168-6> 6</a>
</span><span class=lnt id=hl-168-7><a class=lnlinks href=#hl-168-7> 7</a>
</span><span class=lnt id=hl-168-8><a class=lnlinks href=#hl-168-8> 8</a>
</span><span class=lnt id=hl-168-9><a class=lnlinks href=#hl-168-9> 9</a>
</span><span class=lnt id=hl-168-10><a class=lnlinks href=#hl-168-10>10</a>
</span><span class=lnt id=hl-168-11><a class=lnlinks href=#hl-168-11>11</a>
</span><span class=lnt id=hl-168-12><a class=lnlinks href=#hl-168-12>12</a>
</span><span class=lnt id=hl-168-13><a class=lnlinks href=#hl-168-13>13</a>
</span><span class=lnt id=hl-168-14><a class=lnlinks href=#hl-168-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- SQL 표준 권한 관리
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스 생성 권한
</span></span></span><span class=line><span class=cl><span class=k>GRANT</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>user_name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스 삭제 권한
</span></span></span><span class=line><span class=cl><span class=k>GRANT</span><span class=w> </span><span class=k>ALTER</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>user_name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- PostgreSQL 역할 기반
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>ROLE</span><span class=w> </span><span class=n>index_manager</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>GRANT</span><span class=w> </span><span class=k>CREATE</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>SCHEMA</span><span class=w> </span><span class=k>public</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>index_manager</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>GRANT</span><span class=w> </span><span class=k>USAGE</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>SCHEMA</span><span class=w> </span><span class=k>public</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>index_manager</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 시스템 카탈로그 접근 제한
</span></span></span><span class=line><span class=cl><span class=k>REVOKE</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>pg_catalog</span><span class=p>.</span><span class=n>pg_index</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>public</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>클라우드 환경 표준 및 제약</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-169-1><a class=lnlinks href=#hl-169-1> 1</a>
</span><span class=lnt id=hl-169-2><a class=lnlinks href=#hl-169-2> 2</a>
</span><span class=lnt id=hl-169-3><a class=lnlinks href=#hl-169-3> 3</a>
</span><span class=lnt id=hl-169-4><a class=lnlinks href=#hl-169-4> 4</a>
</span><span class=lnt id=hl-169-5><a class=lnlinks href=#hl-169-5> 5</a>
</span><span class=lnt id=hl-169-6><a class=lnlinks href=#hl-169-6> 6</a>
</span><span class=lnt id=hl-169-7><a class=lnlinks href=#hl-169-7> 7</a>
</span><span class=lnt id=hl-169-8><a class=lnlinks href=#hl-169-8> 8</a>
</span><span class=lnt id=hl-169-9><a class=lnlinks href=#hl-169-9> 9</a>
</span><span class=lnt id=hl-169-10><a class=lnlinks href=#hl-169-10>10</a>
</span><span class=lnt id=hl-169-11><a class=lnlinks href=#hl-169-11>11</a>
</span><span class=lnt id=hl-169-12><a class=lnlinks href=#hl-169-12>12</a>
</span><span class=lnt id=hl-169-13><a class=lnlinks href=#hl-169-13>13</a>
</span><span class=lnt id=hl-169-14><a class=lnlinks href=#hl-169-14>14</a>
</span><span class=lnt id=hl-169-15><a class=lnlinks href=#hl-169-15>15</a>
</span><span class=lnt id=hl-169-16><a class=lnlinks href=#hl-169-16>16</a>
</span><span class=lnt id=hl-169-17><a class=lnlinks href=#hl-169-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>AWS RDS:
</span></span><span class=line><span class=cl>├─ 인덱스 생성: 제한 없음
</span></span><span class=line><span class=cl>├─ 파라미터 제약: 일부 고급 옵션 불가
</span></span><span class=line><span class=cl>├─ Performance Insights: 인덱스 권장
</span></span><span class=line><span class=cl>└─ 자동 백업: 인덱스 포함
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Azure SQL:
</span></span><span class=line><span class=cl>├─ Intelligent Insights: 자동 인덱스 제안
</span></span><span class=line><span class=cl>├─ 자동 튜닝: 인덱스 자동 생성/삭제
</span></span><span class=line><span class=cl>├─ Hyperscale: 대용량 인덱스 지원
</span></span><span class=line><span class=cl>└─ 탄력적 풀: 리소스 공유
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Google Cloud SQL:
</span></span><span class=line><span class=cl>├─ Query Insights: 성능 분석
</span></span><span class=line><span class=cl>├─ 인덱스 권장: 자동 제안
</span></span><span class=line><span class=cl>├─ 고가용성: 인덱스 동기화
</span></span><span class=line><span class=cl>└─ 읽기 복제본: 인덱스 복제
</span></span></code></pre></td></tr></table></div></div><h4 id=45-알고리즘-변형-및-구현-최적화-a형-특화>4.5 알고리즘 변형 및 구현 최적화 (A형 특화)<a hidden class=anchor aria-hidden=true href=#45-알고리즘-변형-및-구현-최적화-a형-특화>#</a></h4><p><strong>B-Tree 최적화 변형</strong></p><p><strong>1. Prefix B-Tree (접두사 압축)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-170-1><a class=lnlinks href=#hl-170-1> 1</a>
</span><span class=lnt id=hl-170-2><a class=lnlinks href=#hl-170-2> 2</a>
</span><span class=lnt id=hl-170-3><a class=lnlinks href=#hl-170-3> 3</a>
</span><span class=lnt id=hl-170-4><a class=lnlinks href=#hl-170-4> 4</a>
</span><span class=lnt id=hl-170-5><a class=lnlinks href=#hl-170-5> 5</a>
</span><span class=lnt id=hl-170-6><a class=lnlinks href=#hl-170-6> 6</a>
</span><span class=lnt id=hl-170-7><a class=lnlinks href=#hl-170-7> 7</a>
</span><span class=lnt id=hl-170-8><a class=lnlinks href=#hl-170-8> 8</a>
</span><span class=lnt id=hl-170-9><a class=lnlinks href=#hl-170-9> 9</a>
</span><span class=lnt id=hl-170-10><a class=lnlinks href=#hl-170-10>10</a>
</span><span class=lnt id=hl-170-11><a class=lnlinks href=#hl-170-11>11</a>
</span><span class=lnt id=hl-170-12><a class=lnlinks href=#hl-170-12>12</a>
</span><span class=lnt id=hl-170-13><a class=lnlinks href=#hl-170-13>13</a>
</span><span class=lnt id=hl-170-14><a class=lnlinks href=#hl-170-14>14</a>
</span><span class=lnt id=hl-170-15><a class=lnlinks href=#hl-170-15>15</a>
</span><span class=lnt id=hl-170-16><a class=lnlinks href=#hl-170-16>16</a>
</span><span class=lnt id=hl-170-17><a class=lnlinks href=#hl-170-17>17</a>
</span><span class=lnt id=hl-170-18><a class=lnlinks href=#hl-170-18>18</a>
</span><span class=lnt id=hl-170-19><a class=lnlinks href=#hl-170-19>19</a>
</span><span class=lnt id=hl-170-20><a class=lnlinks href=#hl-170-20>20</a>
</span><span class=lnt id=hl-170-21><a class=lnlinks href=#hl-170-21>21</a>
</span><span class=lnt id=hl-170-22><a class=lnlinks href=#hl-170-22>22</a>
</span><span class=lnt id=hl-170-23><a class=lnlinks href=#hl-170-23>23</a>
</span><span class=lnt id=hl-170-24><a class=lnlinks href=#hl-170-24>24</a>
</span><span class=lnt id=hl-170-25><a class=lnlinks href=#hl-170-25>25</a>
</span><span class=lnt id=hl-170-26><a class=lnlinks href=#hl-170-26>26</a>
</span><span class=lnt id=hl-170-27><a class=lnlinks href=#hl-170-27>27</a>
</span><span class=lnt id=hl-170-28><a class=lnlinks href=#hl-170-28>28</a>
</span><span class=lnt id=hl-170-29><a class=lnlinks href=#hl-170-29>29</a>
</span><span class=lnt id=hl-170-30><a class=lnlinks href=#hl-170-30>30</a>
</span><span class=lnt id=hl-170-31><a class=lnlinks href=#hl-170-31>31</a>
</span><span class=lnt id=hl-170-32><a class=lnlinks href=#hl-170-32>32</a>
</span><span class=lnt id=hl-170-33><a class=lnlinks href=#hl-170-33>33</a>
</span><span class=lnt id=hl-170-34><a class=lnlinks href=#hl-170-34>34</a>
</span><span class=lnt id=hl-170-35><a class=lnlinks href=#hl-170-35>35</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>개념: 공통 접두사를 제거하여 노드당 더 많은 키 저장
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>일반 B-Tree 노드:
</span></span><span class=line><span class=cl>[database, dataflow, datasheet, dataviz]
</span></span><span class=line><span class=cl>→ 4개 키, 각 8-9 bytes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Prefix B-Tree 노드:
</span></span><span class=line><span class=cl>prefix: &#34;data&#34;
</span></span><span class=line><span class=cl>[base, flow, sheet, viz]
</span></span><span class=line><span class=cl>→ 4개 키, 각 4-5 bytes + prefix 4 bytes
</span></span><span class=line><span class=cl>→ 약 50% 공간 절약
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>구현:
</span></span><span class=line><span class=cl>class PrefixBTreeNode:
</span></span><span class=line><span class=cl>    def __init__(self):
</span></span><span class=line><span class=cl>        self.prefix = &#34;&#34;  # 공통 접두사
</span></span><span class=line><span class=cl>        self.suffixes = []  # 접미사 배열
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    def compress(self, keys):
</span></span><span class=line><span class=cl>        # 최장 공통 접두사 찾기
</span></span><span class=line><span class=cl>        self.prefix = os.path.commonprefix(keys)
</span></span><span class=line><span class=cl>        self.suffixes = [k[len(self.prefix):] for k in keys]
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    def search(self, key):
</span></span><span class=line><span class=cl>        if not key.startswith(self.prefix):
</span></span><span class=line><span class=cl>            return None
</span></span><span class=line><span class=cl>        suffix = key[len(self.prefix):]
</span></span><span class=line><span class=cl>        return binary_search(self.suffixes, suffix)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>장점: 
</span></span><span class=line><span class=cl>- 메모리 사용량 30-70% 감소
</span></span><span class=line><span class=cl>- 노드당 더 많은 키 → 높이 감소
</span></span><span class=line><span class=cl>- 캐시 효율성 향상
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>적용: 문자열 키, 공통 접두사 많은 데이터
</span></span></code></pre></td></tr></table></div></div><p><strong>2. Copy-on-Write B-Tree (COW B-Tree)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-171-1><a class=lnlinks href=#hl-171-1> 1</a>
</span><span class=lnt id=hl-171-2><a class=lnlinks href=#hl-171-2> 2</a>
</span><span class=lnt id=hl-171-3><a class=lnlinks href=#hl-171-3> 3</a>
</span><span class=lnt id=hl-171-4><a class=lnlinks href=#hl-171-4> 4</a>
</span><span class=lnt id=hl-171-5><a class=lnlinks href=#hl-171-5> 5</a>
</span><span class=lnt id=hl-171-6><a class=lnlinks href=#hl-171-6> 6</a>
</span><span class=lnt id=hl-171-7><a class=lnlinks href=#hl-171-7> 7</a>
</span><span class=lnt id=hl-171-8><a class=lnlinks href=#hl-171-8> 8</a>
</span><span class=lnt id=hl-171-9><a class=lnlinks href=#hl-171-9> 9</a>
</span><span class=lnt id=hl-171-10><a class=lnlinks href=#hl-171-10>10</a>
</span><span class=lnt id=hl-171-11><a class=lnlinks href=#hl-171-11>11</a>
</span><span class=lnt id=hl-171-12><a class=lnlinks href=#hl-171-12>12</a>
</span><span class=lnt id=hl-171-13><a class=lnlinks href=#hl-171-13>13</a>
</span><span class=lnt id=hl-171-14><a class=lnlinks href=#hl-171-14>14</a>
</span><span class=lnt id=hl-171-15><a class=lnlinks href=#hl-171-15>15</a>
</span><span class=lnt id=hl-171-16><a class=lnlinks href=#hl-171-16>16</a>
</span><span class=lnt id=hl-171-17><a class=lnlinks href=#hl-171-17>17</a>
</span><span class=lnt id=hl-171-18><a class=lnlinks href=#hl-171-18>18</a>
</span><span class=lnt id=hl-171-19><a class=lnlinks href=#hl-171-19>19</a>
</span><span class=lnt id=hl-171-20><a class=lnlinks href=#hl-171-20>20</a>
</span><span class=lnt id=hl-171-21><a class=lnlinks href=#hl-171-21>21</a>
</span><span class=lnt id=hl-171-22><a class=lnlinks href=#hl-171-22>22</a>
</span><span class=lnt id=hl-171-23><a class=lnlinks href=#hl-171-23>23</a>
</span><span class=lnt id=hl-171-24><a class=lnlinks href=#hl-171-24>24</a>
</span><span class=lnt id=hl-171-25><a class=lnlinks href=#hl-171-25>25</a>
</span><span class=lnt id=hl-171-26><a class=lnlinks href=#hl-171-26>26</a>
</span><span class=lnt id=hl-171-27><a class=lnlinks href=#hl-171-27>27</a>
</span><span class=lnt id=hl-171-28><a class=lnlinks href=#hl-171-28>28</a>
</span><span class=lnt id=hl-171-29><a class=lnlinks href=#hl-171-29>29</a>
</span><span class=lnt id=hl-171-30><a class=lnlinks href=#hl-171-30>30</a>
</span><span class=lnt id=hl-171-31><a class=lnlinks href=#hl-171-31>31</a>
</span><span class=lnt id=hl-171-32><a class=lnlinks href=#hl-171-32>32</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>개념: 노드 수정 시 복사본 생성, 불변 구조
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>장점:
</span></span><span class=line><span class=cl>- 스냅샷 지원 (특정 시점 조회)
</span></span><span class=line><span class=cl>- 동시성 제어 간소화
</span></span><span class=line><span class=cl>- 읽기 중 쓰기 가능
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>단점:
</span></span><span class=line><span class=cl>- 쓰기 증폭 (부모까지 복사)
</span></span><span class=line><span class=cl>- 가비지 컬렉션 필요
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>구현 개념:
</span></span><span class=line><span class=cl>def insert_cow(node, key, value):
</span></span><span class=line><span class=cl>    # 노드 복사
</span></span><span class=line><span class=cl>    new_node = node.clone()
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    if new_node.is_leaf:
</span></span><span class=line><span class=cl>        new_node.insert(key, value)
</span></span><span class=line><span class=cl>    else:
</span></span><span class=line><span class=cl>        child_idx = new_node.find_child(key)
</span></span><span class=line><span class=cl>        new_child = insert_cow(new_node.children[child_idx], key, value)
</span></span><span class=line><span class=cl>        new_node.children[child_idx] = new_child
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    if new_node.is_full():
</span></span><span class=line><span class=cl>        return split_node(new_node)
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    return new_node
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>사용 사례:
</span></span><span class=line><span class=cl>- Btrfs 파일시스템
</span></span><span class=line><span class=cl>- LMDB (Lightning Memory-Mapped Database)
</span></span><span class=line><span class=cl>- CouchDB
</span></span></code></pre></td></tr></table></div></div><p><strong>3. Fractal Tree (쓰기 최적화)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-172-1><a class=lnlinks href=#hl-172-1> 1</a>
</span><span class=lnt id=hl-172-2><a class=lnlinks href=#hl-172-2> 2</a>
</span><span class=lnt id=hl-172-3><a class=lnlinks href=#hl-172-3> 3</a>
</span><span class=lnt id=hl-172-4><a class=lnlinks href=#hl-172-4> 4</a>
</span><span class=lnt id=hl-172-5><a class=lnlinks href=#hl-172-5> 5</a>
</span><span class=lnt id=hl-172-6><a class=lnlinks href=#hl-172-6> 6</a>
</span><span class=lnt id=hl-172-7><a class=lnlinks href=#hl-172-7> 7</a>
</span><span class=lnt id=hl-172-8><a class=lnlinks href=#hl-172-8> 8</a>
</span><span class=lnt id=hl-172-9><a class=lnlinks href=#hl-172-9> 9</a>
</span><span class=lnt id=hl-172-10><a class=lnlinks href=#hl-172-10>10</a>
</span><span class=lnt id=hl-172-11><a class=lnlinks href=#hl-172-11>11</a>
</span><span class=lnt id=hl-172-12><a class=lnlinks href=#hl-172-12>12</a>
</span><span class=lnt id=hl-172-13><a class=lnlinks href=#hl-172-13>13</a>
</span><span class=lnt id=hl-172-14><a class=lnlinks href=#hl-172-14>14</a>
</span><span class=lnt id=hl-172-15><a class=lnlinks href=#hl-172-15>15</a>
</span><span class=lnt id=hl-172-16><a class=lnlinks href=#hl-172-16>16</a>
</span><span class=lnt id=hl-172-17><a class=lnlinks href=#hl-172-17>17</a>
</span><span class=lnt id=hl-172-18><a class=lnlinks href=#hl-172-18>18</a>
</span><span class=lnt id=hl-172-19><a class=lnlinks href=#hl-172-19>19</a>
</span><span class=lnt id=hl-172-20><a class=lnlinks href=#hl-172-20>20</a>
</span><span class=lnt id=hl-172-21><a class=lnlinks href=#hl-172-21>21</a>
</span><span class=lnt id=hl-172-22><a class=lnlinks href=#hl-172-22>22</a>
</span><span class=lnt id=hl-172-23><a class=lnlinks href=#hl-172-23>23</a>
</span><span class=lnt id=hl-172-24><a class=lnlinks href=#hl-172-24>24</a>
</span><span class=lnt id=hl-172-25><a class=lnlinks href=#hl-172-25>25</a>
</span><span class=lnt id=hl-172-26><a class=lnlinks href=#hl-172-26>26</a>
</span><span class=lnt id=hl-172-27><a class=lnlinks href=#hl-172-27>27</a>
</span><span class=lnt id=hl-172-28><a class=lnlinks href=#hl-172-28>28</a>
</span><span class=lnt id=hl-172-29><a class=lnlinks href=#hl-172-29>29</a>
</span><span class=lnt id=hl-172-30><a class=lnlinks href=#hl-172-30>30</a>
</span><span class=lnt id=hl-172-31><a class=lnlinks href=#hl-172-31>31</a>
</span><span class=lnt id=hl-172-32><a class=lnlinks href=#hl-172-32>32</a>
</span><span class=lnt id=hl-172-33><a class=lnlinks href=#hl-172-33>33</a>
</span><span class=lnt id=hl-172-34><a class=lnlinks href=#hl-172-34>34</a>
</span><span class=lnt id=hl-172-35><a class=lnlinks href=#hl-172-35>35</a>
</span><span class=lnt id=hl-172-36><a class=lnlinks href=#hl-172-36>36</a>
</span><span class=lnt id=hl-172-37><a class=lnlinks href=#hl-172-37>37</a>
</span><span class=lnt id=hl-172-38><a class=lnlinks href=#hl-172-38>38</a>
</span><span class=lnt id=hl-172-39><a class=lnlinks href=#hl-172-39>39</a>
</span><span class=lnt id=hl-172-40><a class=lnlinks href=#hl-172-40>40</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>개념: 각 노드에 버퍼 추가, 메시지 전달 방식
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>구조:
</span></span><span class=line><span class=cl>         [Root + Buffer]
</span></span><span class=line><span class=cl>        /       |       \
</span></span><span class=line><span class=cl>   [Node+Buf] [Node+Buf] [Node+Buf]
</span></span><span class=line><span class=cl>     /  \       /  \       /  \
</span></span><span class=line><span class=cl>  [Leaf] [Leaf] [Leaf] [Leaf] [Leaf]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>동작:
</span></span><span class=line><span class=cl>1. INSERT 메시지를 루트 버퍼에 추가
</span></span><span class=line><span class=cl>2. 버퍼 포화 시 하위로 플러시
</span></span><span class=line><span class=cl>3. 리프에 도달하면 실제 적용
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>장점:
</span></span><span class=line><span class=cl>- 쓰기 증폭 최소화
</span></span><span class=line><span class=cl>- 순차 I/O 위주
</span></span><span class=line><span class=cl>- B-Tree보다 10-100배 빠른 INSERT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>구현 핵심:
</span></span><span class=line><span class=cl>class FractalTreeNode:
</span></span><span class=line><span class=cl>    def __init__(self):
</span></span><span class=line><span class=cl>        self.keys = []
</span></span><span class=line><span class=cl>        self.children = []
</span></span><span class=line><span class=cl>        self.buffer = []  # (operation, key, value)
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    def insert_message(self, op, key, value):
</span></span><span class=line><span class=cl>        self.buffer.append((op, key, value))
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        if len(self.buffer) &gt; BUFFER_SIZE:
</span></span><span class=line><span class=cl>            self.flush_buffer()
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    def flush_buffer(self):
</span></span><span class=line><span class=cl>        # 버퍼 메시지를 자식으로 전달
</span></span><span class=line><span class=cl>        for op, key, value in self.buffer:
</span></span><span class=line><span class=cl>            child_idx = self.find_child(key)
</span></span><span class=line><span class=cl>            self.children[child_idx].insert_message(op, key, value)
</span></span><span class=line><span class=cl>        self.buffer = []
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>사용: TokuDB, PerconaFT
</span></span></code></pre></td></tr></table></div></div><p><strong>Hash Index 최적화</strong></p><p><strong>1. Cuckoo Hashing (최악 O(1) 보장)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-173-1><a class=lnlinks href=#hl-173-1> 1</a>
</span><span class=lnt id=hl-173-2><a class=lnlinks href=#hl-173-2> 2</a>
</span><span class=lnt id=hl-173-3><a class=lnlinks href=#hl-173-3> 3</a>
</span><span class=lnt id=hl-173-4><a class=lnlinks href=#hl-173-4> 4</a>
</span><span class=lnt id=hl-173-5><a class=lnlinks href=#hl-173-5> 5</a>
</span><span class=lnt id=hl-173-6><a class=lnlinks href=#hl-173-6> 6</a>
</span><span class=lnt id=hl-173-7><a class=lnlinks href=#hl-173-7> 7</a>
</span><span class=lnt id=hl-173-8><a class=lnlinks href=#hl-173-8> 8</a>
</span><span class=lnt id=hl-173-9><a class=lnlinks href=#hl-173-9> 9</a>
</span><span class=lnt id=hl-173-10><a class=lnlinks href=#hl-173-10>10</a>
</span><span class=lnt id=hl-173-11><a class=lnlinks href=#hl-173-11>11</a>
</span><span class=lnt id=hl-173-12><a class=lnlinks href=#hl-173-12>12</a>
</span><span class=lnt id=hl-173-13><a class=lnlinks href=#hl-173-13>13</a>
</span><span class=lnt id=hl-173-14><a class=lnlinks href=#hl-173-14>14</a>
</span><span class=lnt id=hl-173-15><a class=lnlinks href=#hl-173-15>15</a>
</span><span class=lnt id=hl-173-16><a class=lnlinks href=#hl-173-16>16</a>
</span><span class=lnt id=hl-173-17><a class=lnlinks href=#hl-173-17>17</a>
</span><span class=lnt id=hl-173-18><a class=lnlinks href=#hl-173-18>18</a>
</span><span class=lnt id=hl-173-19><a class=lnlinks href=#hl-173-19>19</a>
</span><span class=lnt id=hl-173-20><a class=lnlinks href=#hl-173-20>20</a>
</span><span class=lnt id=hl-173-21><a class=lnlinks href=#hl-173-21>21</a>
</span><span class=lnt id=hl-173-22><a class=lnlinks href=#hl-173-22>22</a>
</span><span class=lnt id=hl-173-23><a class=lnlinks href=#hl-173-23>23</a>
</span><span class=lnt id=hl-173-24><a class=lnlinks href=#hl-173-24>24</a>
</span><span class=lnt id=hl-173-25><a class=lnlinks href=#hl-173-25>25</a>
</span><span class=lnt id=hl-173-26><a class=lnlinks href=#hl-173-26>26</a>
</span><span class=lnt id=hl-173-27><a class=lnlinks href=#hl-173-27>27</a>
</span><span class=lnt id=hl-173-28><a class=lnlinks href=#hl-173-28>28</a>
</span><span class=lnt id=hl-173-29><a class=lnlinks href=#hl-173-29>29</a>
</span><span class=lnt id=hl-173-30><a class=lnlinks href=#hl-173-30>30</a>
</span><span class=lnt id=hl-173-31><a class=lnlinks href=#hl-173-31>31</a>
</span><span class=lnt id=hl-173-32><a class=lnlinks href=#hl-173-32>32</a>
</span><span class=lnt id=hl-173-33><a class=lnlinks href=#hl-173-33>33</a>
</span><span class=lnt id=hl-173-34><a class=lnlinks href=#hl-173-34>34</a>
</span><span class=lnt id=hl-173-35><a class=lnlinks href=#hl-173-35>35</a>
</span><span class=lnt id=hl-173-36><a class=lnlinks href=#hl-173-36>36</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>개념: 두 개의 해시 함수, 최대 2번 탐색
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>구조:
</span></span><span class=line><span class=cl>Table 1: [_, A, _, C, _]  (h1)
</span></span><span class=line><span class=cl>Table 2: [B, _, D, _, _]  (h2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>삽입 알고리즘:
</span></span><span class=line><span class=cl>def cuckoo_insert(key, value):
</span></span><span class=line><span class=cl>    pos1 = h1(key)
</span></span><span class=line><span class=cl>    pos2 = h2(key)
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    if table1[pos1] is None:
</span></span><span class=line><span class=cl>        table1[pos1] = (key, value)
</span></span><span class=line><span class=cl>        return
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    if table2[pos2] is None:
</span></span><span class=line><span class=cl>        table2[pos2] = (key, value)
</span></span><span class=line><span class=cl>        return
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    # 둘 다 차있으면: Cuckoo (뻐꾸기 밀어내기)
</span></span><span class=line><span class=cl>    evicted = table1[pos1]
</span></span><span class=line><span class=cl>    table1[pos1] = (key, value)
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    # 밀려난 항목 재삽입 (재귀적)
</span></span><span class=line><span class=cl>    cuckoo_insert(evicted[0], evicted[1])
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>장점:
</span></span><span class=line><span class=cl>- 최악 O(1) 조회
</span></span><span class=line><span class=cl>- 높은 부하율 (&gt;90%)
</span></span><span class=line><span class=cl>- 캐시 친화적
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>단점:
</span></span><span class=line><span class=cl>- 삽입 시 재배치 가능
</span></span><span class=line><span class=cl>- 무한 루프 위험 (재해싱 필요)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>사용: MemC3, DPDK hash table
</span></span></code></pre></td></tr></table></div></div><p><strong>2. Robin Hood Hashing (분산 개선)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-174-1><a class=lnlinks href=#hl-174-1> 1</a>
</span><span class=lnt id=hl-174-2><a class=lnlinks href=#hl-174-2> 2</a>
</span><span class=lnt id=hl-174-3><a class=lnlinks href=#hl-174-3> 3</a>
</span><span class=lnt id=hl-174-4><a class=lnlinks href=#hl-174-4> 4</a>
</span><span class=lnt id=hl-174-5><a class=lnlinks href=#hl-174-5> 5</a>
</span><span class=lnt id=hl-174-6><a class=lnlinks href=#hl-174-6> 6</a>
</span><span class=lnt id=hl-174-7><a class=lnlinks href=#hl-174-7> 7</a>
</span><span class=lnt id=hl-174-8><a class=lnlinks href=#hl-174-8> 8</a>
</span><span class=lnt id=hl-174-9><a class=lnlinks href=#hl-174-9> 9</a>
</span><span class=lnt id=hl-174-10><a class=lnlinks href=#hl-174-10>10</a>
</span><span class=lnt id=hl-174-11><a class=lnlinks href=#hl-174-11>11</a>
</span><span class=lnt id=hl-174-12><a class=lnlinks href=#hl-174-12>12</a>
</span><span class=lnt id=hl-174-13><a class=lnlinks href=#hl-174-13>13</a>
</span><span class=lnt id=hl-174-14><a class=lnlinks href=#hl-174-14>14</a>
</span><span class=lnt id=hl-174-15><a class=lnlinks href=#hl-174-15>15</a>
</span><span class=lnt id=hl-174-16><a class=lnlinks href=#hl-174-16>16</a>
</span><span class=lnt id=hl-174-17><a class=lnlinks href=#hl-174-17>17</a>
</span><span class=lnt id=hl-174-18><a class=lnlinks href=#hl-174-18>18</a>
</span><span class=lnt id=hl-174-19><a class=lnlinks href=#hl-174-19>19</a>
</span><span class=lnt id=hl-174-20><a class=lnlinks href=#hl-174-20>20</a>
</span><span class=lnt id=hl-174-21><a class=lnlinks href=#hl-174-21>21</a>
</span><span class=lnt id=hl-174-22><a class=lnlinks href=#hl-174-22>22</a>
</span><span class=lnt id=hl-174-23><a class=lnlinks href=#hl-174-23>23</a>
</span><span class=lnt id=hl-174-24><a class=lnlinks href=#hl-174-24>24</a>
</span><span class=lnt id=hl-174-25><a class=lnlinks href=#hl-174-25>25</a>
</span><span class=lnt id=hl-174-26><a class=lnlinks href=#hl-174-26>26</a>
</span><span class=lnt id=hl-174-27><a class=lnlinks href=#hl-174-27>27</a>
</span><span class=lnt id=hl-174-28><a class=lnlinks href=#hl-174-28>28</a>
</span><span class=lnt id=hl-174-29><a class=lnlinks href=#hl-174-29>29</a>
</span><span class=lnt id=hl-174-30><a class=lnlinks href=#hl-174-30>30</a>
</span><span class=lnt id=hl-174-31><a class=lnlinks href=#hl-174-31>31</a>
</span><span class=lnt id=hl-174-32><a class=lnlinks href=#hl-174-32>32</a>
</span><span class=lnt id=hl-174-33><a class=lnlinks href=#hl-174-33>33</a>
</span><span class=lnt id=hl-174-34><a class=lnlinks href=#hl-174-34>34</a>
</span><span class=lnt id=hl-174-35><a class=lnlinks href=#hl-174-35>35</a>
</span><span class=lnt id=hl-174-36><a class=lnlinks href=#hl-174-36>36</a>
</span><span class=lnt id=hl-174-37><a class=lnlinks href=#hl-174-37>37</a>
</span><span class=lnt id=hl-174-38><a class=lnlinks href=#hl-174-38>38</a>
</span><span class=lnt id=hl-174-39><a class=lnlinks href=#hl-174-39>39</a>
</span><span class=lnt id=hl-174-40><a class=lnlinks href=#hl-174-40>40</a>
</span><span class=lnt id=hl-174-41><a class=lnlinks href=#hl-174-41>41</a>
</span><span class=lnt id=hl-174-42><a class=lnlinks href=#hl-174-42>42</a>
</span><span class=lnt id=hl-174-43><a class=lnlinks href=#hl-174-43>43</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>개념: &#34;부자로부터 빈자에게&#34; - 거리 균등화
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>충돌 해결:
</span></span><span class=line><span class=cl>- 새 키의 probe 거리 &gt; 기존 키의 거리
</span></span><span class=line><span class=cl>  → 새 키가 자리 차지, 기존 키 밀어냄
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>예시:
</span></span><span class=line><span class=cl>삽입 순서: A(h=2), B(h=2), C(h=2)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>일반 선형 탐사:
</span></span><span class=line><span class=cl>[_, _, A, B, C]
</span></span><span class=line><span class=cl>거리: [_, _, 0, 1, 2]  (불균등)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Robin Hood:
</span></span><span class=line><span class=cl>[_, _, A, C, B]
</span></span><span class=line><span class=cl>거리: [_, _, 0, 1, 1]  (균등)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>구현:
</span></span><span class=line><span class=cl>def robin_hood_insert(key, value):
</span></span><span class=line><span class=cl>    pos = hash(key)
</span></span><span class=line><span class=cl>    distance = 0
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    while True:
</span></span><span class=line><span class=cl>        if table[pos] is None:
</span></span><span class=line><span class=cl>            table[pos] = (key, value, distance)
</span></span><span class=line><span class=cl>            return
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        existing_key, existing_val, existing_dist = table[pos]
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        if distance &gt; existing_dist:
</span></span><span class=line><span class=cl>            # Swap: 새 키가 더 불행함
</span></span><span class=line><span class=cl>            table[pos] = (key, value, distance)
</span></span><span class=line><span class=cl>            key, value, distance = existing_key, existing_val, existing_dist
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        pos = (pos + 1) % size
</span></span><span class=line><span class=cl>        distance += 1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>장점:
</span></span><span class=line><span class=cl>- 분산도 우수
</span></span><span class=line><span class=cl>- 평균 probe 거리 감소
</span></span><span class=line><span class=cl>- 캐시 효율 향상
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>사용: Rust HashMap, Servo browser
</span></span></code></pre></td></tr></table></div></div><p><strong>복잡도 개선 기법</strong></p><p><strong>1. Skip List (확률적 균형)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-175-1><a class=lnlinks href=#hl-175-1> 1</a>
</span><span class=lnt id=hl-175-2><a class=lnlinks href=#hl-175-2> 2</a>
</span><span class=lnt id=hl-175-3><a class=lnlinks href=#hl-175-3> 3</a>
</span><span class=lnt id=hl-175-4><a class=lnlinks href=#hl-175-4> 4</a>
</span><span class=lnt id=hl-175-5><a class=lnlinks href=#hl-175-5> 5</a>
</span><span class=lnt id=hl-175-6><a class=lnlinks href=#hl-175-6> 6</a>
</span><span class=lnt id=hl-175-7><a class=lnlinks href=#hl-175-7> 7</a>
</span><span class=lnt id=hl-175-8><a class=lnlinks href=#hl-175-8> 8</a>
</span><span class=lnt id=hl-175-9><a class=lnlinks href=#hl-175-9> 9</a>
</span><span class=lnt id=hl-175-10><a class=lnlinks href=#hl-175-10>10</a>
</span><span class=lnt id=hl-175-11><a class=lnlinks href=#hl-175-11>11</a>
</span><span class=lnt id=hl-175-12><a class=lnlinks href=#hl-175-12>12</a>
</span><span class=lnt id=hl-175-13><a class=lnlinks href=#hl-175-13>13</a>
</span><span class=lnt id=hl-175-14><a class=lnlinks href=#hl-175-14>14</a>
</span><span class=lnt id=hl-175-15><a class=lnlinks href=#hl-175-15>15</a>
</span><span class=lnt id=hl-175-16><a class=lnlinks href=#hl-175-16>16</a>
</span><span class=lnt id=hl-175-17><a class=lnlinks href=#hl-175-17>17</a>
</span><span class=lnt id=hl-175-18><a class=lnlinks href=#hl-175-18>18</a>
</span><span class=lnt id=hl-175-19><a class=lnlinks href=#hl-175-19>19</a>
</span><span class=lnt id=hl-175-20><a class=lnlinks href=#hl-175-20>20</a>
</span><span class=lnt id=hl-175-21><a class=lnlinks href=#hl-175-21>21</a>
</span><span class=lnt id=hl-175-22><a class=lnlinks href=#hl-175-22>22</a>
</span><span class=lnt id=hl-175-23><a class=lnlinks href=#hl-175-23>23</a>
</span><span class=lnt id=hl-175-24><a class=lnlinks href=#hl-175-24>24</a>
</span><span class=lnt id=hl-175-25><a class=lnlinks href=#hl-175-25>25</a>
</span><span class=lnt id=hl-175-26><a class=lnlinks href=#hl-175-26>26</a>
</span><span class=lnt id=hl-175-27><a class=lnlinks href=#hl-175-27>27</a>
</span><span class=lnt id=hl-175-28><a class=lnlinks href=#hl-175-28>28</a>
</span><span class=lnt id=hl-175-29><a class=lnlinks href=#hl-175-29>29</a>
</span><span class=lnt id=hl-175-30><a class=lnlinks href=#hl-175-30>30</a>
</span><span class=lnt id=hl-175-31><a class=lnlinks href=#hl-175-31>31</a>
</span><span class=lnt id=hl-175-32><a class=lnlinks href=#hl-175-32>32</a>
</span><span class=lnt id=hl-175-33><a class=lnlinks href=#hl-175-33>33</a>
</span><span class=lnt id=hl-175-34><a class=lnlinks href=#hl-175-34>34</a>
</span><span class=lnt id=hl-175-35><a class=lnlinks href=#hl-175-35>35</a>
</span><span class=lnt id=hl-175-36><a class=lnlinks href=#hl-175-36>36</a>
</span><span class=lnt id=hl-175-37><a class=lnlinks href=#hl-175-37>37</a>
</span><span class=lnt id=hl-175-38><a class=lnlinks href=#hl-175-38>38</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>개념: 다층 연결 리스트, 확률적으로 레벨 결정
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>구조:
</span></span><span class=line><span class=cl>Level 3: 1 -----------&gt; 5
</span></span><span class=line><span class=cl>Level 2: 1 ----&gt; 3 ---&gt; 5 -------&gt; 9
</span></span><span class=line><span class=cl>Level 1: 1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; 6 -&gt; 7 -&gt; 9
</span></span><span class=line><span class=cl>Level 0: 1 -&gt; 2 -&gt; 3 -&gt; 4 -&gt; 5 -&gt; 6 -&gt; 7 -&gt; 8 -&gt; 9
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>탐색 알고리즘:
</span></span><span class=line><span class=cl>def search(target):
</span></span><span class=line><span class=cl>    current = head
</span></span><span class=line><span class=cl>    level = max_level
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    while level &gt;= 0:
</span></span><span class=line><span class=cl>        while current.next[level] and current.next[level].key &lt; target:
</span></span><span class=line><span class=cl>            current = current.next[level]
</span></span><span class=line><span class=cl>        level -= 1
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    current = current.next[0]
</span></span><span class=line><span class=cl>    return current if current and current.key == target else None
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>레벨 결정 (확률 1/2):
</span></span><span class=line><span class=cl>def random_level():
</span></span><span class=line><span class=cl>    level = 1
</span></span><span class=line><span class=cl>    while random() &lt; 0.5 and level &lt; MAX_LEVEL:
</span></span><span class=line><span class=cl>        level += 1
</span></span><span class=line><span class=cl>    return level
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>장점:
</span></span><span class=line><span class=cl>- 구현 단순 (B-Tree보다 훨씬 간단)
</span></span><span class=line><span class=cl>- 동시성 제어 용이 (락 프리 가능)
</span></span><span class=line><span class=cl>- 평균 O(log n)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>단점:
</span></span><span class=line><span class=cl>- 최악 O(n) 가능 (확률적)
</span></span><span class=line><span class=cl>- 캐시 지역성 낮음
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>사용: Redis Sorted Set, LevelDB memtable
</span></span></code></pre></td></tr></table></div></div><p><strong>2. Adaptive Radix Tree (메모리 최적화)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-176-1><a class=lnlinks href=#hl-176-1> 1</a>
</span><span class=lnt id=hl-176-2><a class=lnlinks href=#hl-176-2> 2</a>
</span><span class=lnt id=hl-176-3><a class=lnlinks href=#hl-176-3> 3</a>
</span><span class=lnt id=hl-176-4><a class=lnlinks href=#hl-176-4> 4</a>
</span><span class=lnt id=hl-176-5><a class=lnlinks href=#hl-176-5> 5</a>
</span><span class=lnt id=hl-176-6><a class=lnlinks href=#hl-176-6> 6</a>
</span><span class=lnt id=hl-176-7><a class=lnlinks href=#hl-176-7> 7</a>
</span><span class=lnt id=hl-176-8><a class=lnlinks href=#hl-176-8> 8</a>
</span><span class=lnt id=hl-176-9><a class=lnlinks href=#hl-176-9> 9</a>
</span><span class=lnt id=hl-176-10><a class=lnlinks href=#hl-176-10>10</a>
</span><span class=lnt id=hl-176-11><a class=lnlinks href=#hl-176-11>11</a>
</span><span class=lnt id=hl-176-12><a class=lnlinks href=#hl-176-12>12</a>
</span><span class=lnt id=hl-176-13><a class=lnlinks href=#hl-176-13>13</a>
</span><span class=lnt id=hl-176-14><a class=lnlinks href=#hl-176-14>14</a>
</span><span class=lnt id=hl-176-15><a class=lnlinks href=#hl-176-15>15</a>
</span><span class=lnt id=hl-176-16><a class=lnlinks href=#hl-176-16>16</a>
</span><span class=lnt id=hl-176-17><a class=lnlinks href=#hl-176-17>17</a>
</span><span class=lnt id=hl-176-18><a class=lnlinks href=#hl-176-18>18</a>
</span><span class=lnt id=hl-176-19><a class=lnlinks href=#hl-176-19>19</a>
</span><span class=lnt id=hl-176-20><a class=lnlinks href=#hl-176-20>20</a>
</span><span class=lnt id=hl-176-21><a class=lnlinks href=#hl-176-21>21</a>
</span><span class=lnt id=hl-176-22><a class=lnlinks href=#hl-176-22>22</a>
</span><span class=lnt id=hl-176-23><a class=lnlinks href=#hl-176-23>23</a>
</span><span class=lnt id=hl-176-24><a class=lnlinks href=#hl-176-24>24</a>
</span><span class=lnt id=hl-176-25><a class=lnlinks href=#hl-176-25>25</a>
</span><span class=lnt id=hl-176-26><a class=lnlinks href=#hl-176-26>26</a>
</span><span class=lnt id=hl-176-27><a class=lnlinks href=#hl-176-27>27</a>
</span><span class=lnt id=hl-176-28><a class=lnlinks href=#hl-176-28>28</a>
</span><span class=lnt id=hl-176-29><a class=lnlinks href=#hl-176-29>29</a>
</span><span class=lnt id=hl-176-30><a class=lnlinks href=#hl-176-30>30</a>
</span><span class=lnt id=hl-176-31><a class=lnlinks href=#hl-176-31>31</a>
</span><span class=lnt id=hl-176-32><a class=lnlinks href=#hl-176-32>32</a>
</span><span class=lnt id=hl-176-33><a class=lnlinks href=#hl-176-33>33</a>
</span><span class=lnt id=hl-176-34><a class=lnlinks href=#hl-176-34>34</a>
</span><span class=lnt id=hl-176-35><a class=lnlinks href=#hl-176-35>35</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>개념: 노드 크기를 자식 수에 맞춰 동적 조정
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>노드 타입:
</span></span><span class=line><span class=cl>- Node4:   최대 4개 자식 (작은 배열)
</span></span><span class=line><span class=cl>- Node16:  최대 16개 자식 (배열)
</span></span><span class=line><span class=cl>- Node48:  최대 48개 자식 (인덱스 배열)
</span></span><span class=line><span class=cl>- Node256: 최대 256개 자식 (직접 배열)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>메모리 사용:
</span></span><span class=line><span class=cl>일반 Trie: 256 포인터 × 8 bytes = 2KB/노드
</span></span><span class=line><span class=cl>ART Node4: 4 포인터 × 8 + 4 키 = 36 bytes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>성능:
</span></span><span class=line><span class=cl>- 검색: O(k), k = 키 길이
</span></span><span class=line><span class=cl>- 메모리: 일반 Trie의 1/10
</span></span><span class=line><span class=cl>- 캐시: 우수 (작은 노드)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>구현 개념:
</span></span><span class=line><span class=cl>class ARTNode:
</span></span><span class=line><span class=cl>    def grow(self):
</span></span><span class=line><span class=cl>        if isinstance(self, Node4) and len(self.children) &gt; 4:
</span></span><span class=line><span class=cl>            return self.to_node16()
</span></span><span class=line><span class=cl>        elif isinstance(self, Node16) and len(self.children) &gt; 16:
</span></span><span class=line><span class=cl>            return self.to_node48()
</span></span><span class=line><span class=cl>        # ...
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    def shrink(self):
</span></span><span class=line><span class=cl>        if isinstance(self, Node16) and len(self.children) &lt;= 4:
</span></span><span class=line><span class=cl>            return self.to_node4()
</span></span><span class=line><span class=cl>        # ...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>사용: 
</span></span><span class=line><span class=cl>- 인메모리 DB 인덱스
</span></span><span class=line><span class=cl>- 라우팅 테이블
</span></span><span class=line><span class=cl>- IP 주소 검색
</span></span></code></pre></td></tr></table></div></div><p>계속해서 Phase 5로 진행하겠습니다.</p><hr><h3 id=phase-5-실무-적용-및-사례-1>Phase 5: 실무 적용 및 사례<a hidden class=anchor aria-hidden=true href=#phase-5-실무-적용-및-사례-1>#</a></h3><h4 id=51-실습-예제-및-코드-구현-1>5.1 실습 예제 및 코드 구현<a hidden class=anchor aria-hidden=true href=#51-실습-예제-및-코드-구현-1>#</a></h4><h5 id=실습-예제-1-b-tree-인덱스-성능-비교>실습 예제 1: B-Tree 인덱스 성능 비교<a hidden class=anchor aria-hidden=true href=#실습-예제-1-b-tree-인덱스-성능-비교>#</a></h5><h6 id=목적-1>목적<a hidden class=anchor aria-hidden=true href=#목적-1>#</a></h6><ul><li>인덱스 유무에 따른 쿼리 성능 차이 체감</li><li>실행 계획 분석 방법 학습</li><li>인덱스 선택도와 성능의 관계 이해</li></ul><h6 id=사전-요구사항-1>사전 요구사항<a hidden class=anchor aria-hidden=true href=#사전-요구사항-1>#</a></h6><ul><li>PostgreSQL 12+ 또는 MySQL 8+</li><li>최소 1GB RAM</li><li>psql 또는 mysql 클라이언트</li></ul><h6 id=단계별-구현-1>단계별 구현<a hidden class=anchor aria-hidden=true href=#단계별-구현-1>#</a></h6><p><strong>1단계: 테스트 데이터 생성</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-177-1><a class=lnlinks href=#hl-177-1> 1</a>
</span><span class=lnt id=hl-177-2><a class=lnlinks href=#hl-177-2> 2</a>
</span><span class=lnt id=hl-177-3><a class=lnlinks href=#hl-177-3> 3</a>
</span><span class=lnt id=hl-177-4><a class=lnlinks href=#hl-177-4> 4</a>
</span><span class=lnt id=hl-177-5><a class=lnlinks href=#hl-177-5> 5</a>
</span><span class=lnt id=hl-177-6><a class=lnlinks href=#hl-177-6> 6</a>
</span><span class=lnt id=hl-177-7><a class=lnlinks href=#hl-177-7> 7</a>
</span><span class=lnt id=hl-177-8><a class=lnlinks href=#hl-177-8> 8</a>
</span><span class=lnt id=hl-177-9><a class=lnlinks href=#hl-177-9> 9</a>
</span><span class=lnt id=hl-177-10><a class=lnlinks href=#hl-177-10>10</a>
</span><span class=lnt id=hl-177-11><a class=lnlinks href=#hl-177-11>11</a>
</span><span class=lnt id=hl-177-12><a class=lnlinks href=#hl-177-12>12</a>
</span><span class=lnt id=hl-177-13><a class=lnlinks href=#hl-177-13>13</a>
</span><span class=lnt id=hl-177-14><a class=lnlinks href=#hl-177-14>14</a>
</span><span class=lnt id=hl-177-15><a class=lnlinks href=#hl-177-15>15</a>
</span><span class=lnt id=hl-177-16><a class=lnlinks href=#hl-177-16>16</a>
</span><span class=lnt id=hl-177-17><a class=lnlinks href=#hl-177-17>17</a>
</span><span class=lnt id=hl-177-18><a class=lnlinks href=#hl-177-18>18</a>
</span><span class=lnt id=hl-177-19><a class=lnlinks href=#hl-177-19>19</a>
</span><span class=lnt id=hl-177-20><a class=lnlinks href=#hl-177-20>20</a>
</span><span class=lnt id=hl-177-21><a class=lnlinks href=#hl-177-21>21</a>
</span><span class=lnt id=hl-177-22><a class=lnlinks href=#hl-177-22>22</a>
</span><span class=lnt id=hl-177-23><a class=lnlinks href=#hl-177-23>23</a>
</span><span class=lnt id=hl-177-24><a class=lnlinks href=#hl-177-24>24</a>
</span><span class=lnt id=hl-177-25><a class=lnlinks href=#hl-177-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- PostgreSQL 예시
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>order_id</span><span class=w> </span><span class=nb>SERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>customer_id</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>order_date</span><span class=w> </span><span class=nb>DATE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>total_amount</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>status</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>created_at</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>CURRENT_TIMESTAMP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 100만 건 테스트 데이터 생성
</span></span></span><span class=line><span class=cl><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span><span class=n>customer_id</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=p>,</span><span class=w> </span><span class=n>total_amount</span><span class=p>,</span><span class=w> </span><span class=n>status</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>(</span><span class=n>random</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>10000</span><span class=p>)::</span><span class=nb>integer</span><span class=p>,</span><span class=w>  </span><span class=c1>-- 10,000명의 고객
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>CURRENT_DATE</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>(</span><span class=n>random</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>365</span><span class=p>)::</span><span class=nb>integer</span><span class=p>,</span><span class=w>  </span><span class=c1>-- 최근 1년
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>(</span><span class=n>random</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>1000</span><span class=p>)::</span><span class=nb>numeric</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=mi>2</span><span class=p>),</span><span class=w>  </span><span class=c1>-- 0-1000 금액
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>CASE</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>random</span><span class=p>()</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>7</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;completed&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>random</span><span class=p>()</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>9</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;pending&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;cancelled&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>END</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>generate_series</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1000000</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 통계 정보 갱신
</span></span></span><span class=line><span class=cl><span class=k>ANALYZE</span><span class=w> </span><span class=n>orders</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>2단계: 인덱스 없이 쿼리 성능 측정</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-178-1><a class=lnlinks href=#hl-178-1> 1</a>
</span><span class=lnt id=hl-178-2><a class=lnlinks href=#hl-178-2> 2</a>
</span><span class=lnt id=hl-178-3><a class=lnlinks href=#hl-178-3> 3</a>
</span><span class=lnt id=hl-178-4><a class=lnlinks href=#hl-178-4> 4</a>
</span><span class=lnt id=hl-178-5><a class=lnlinks href=#hl-178-5> 5</a>
</span><span class=lnt id=hl-178-6><a class=lnlinks href=#hl-178-6> 6</a>
</span><span class=lnt id=hl-178-7><a class=lnlinks href=#hl-178-7> 7</a>
</span><span class=lnt id=hl-178-8><a class=lnlinks href=#hl-178-8> 8</a>
</span><span class=lnt id=hl-178-9><a class=lnlinks href=#hl-178-9> 9</a>
</span><span class=lnt id=hl-178-10><a class=lnlinks href=#hl-178-10>10</a>
</span><span class=lnt id=hl-178-11><a class=lnlinks href=#hl-178-11>11</a>
</span><span class=lnt id=hl-178-12><a class=lnlinks href=#hl-178-12>12</a>
</span><span class=lnt id=hl-178-13><a class=lnlinks href=#hl-178-13>13</a>
</span><span class=lnt id=hl-178-14><a class=lnlinks href=#hl-178-14>14</a>
</span><span class=lnt id=hl-178-15><a class=lnlinks href=#hl-178-15>15</a>
</span><span class=lnt id=hl-178-16><a class=lnlinks href=#hl-178-16>16</a>
</span><span class=lnt id=hl-178-17><a class=lnlinks href=#hl-178-17>17</a>
</span><span class=lnt id=hl-178-18><a class=lnlinks href=#hl-178-18>18</a>
</span><span class=lnt id=hl-178-19><a class=lnlinks href=#hl-178-19>19</a>
</span><span class=lnt id=hl-178-20><a class=lnlinks href=#hl-178-20>20</a>
</span><span class=lnt id=hl-178-21><a class=lnlinks href=#hl-178-21>21</a>
</span><span class=lnt id=hl-178-22><a class=lnlinks href=#hl-178-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 쿼리 실행 시간 측정 활성화
</span></span></span><span class=line><span class=cl><span class=err>\</span><span class=n>timing</span><span class=w> </span><span class=k>on</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 실행 계획 확인
</span></span></span><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYZE</span><span class=p>,</span><span class=w> </span><span class=n>BUFFERS</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5000</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>예상 결과:
</span></span></span><span class=line><span class=cl><span class=cm>Seq Scan on orders (cost=0.00..20834.00 rows=100 width=xx) (actual time=50.123..250.456 rows=100 loops=1)
</span></span></span><span class=line><span class=cl><span class=cm>  Filter: (customer_id = 5000)
</span></span></span><span class=line><span class=cl><span class=cm>  Rows Removed by Filter: 999900
</span></span></span><span class=line><span class=cl><span class=cm>  Buffers: shared hit=8334
</span></span></span><span class=line><span class=cl><span class=cm>Planning Time: 0.123 ms
</span></span></span><span class=line><span class=cl><span class=cm>Execution Time: 250.789 ms
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>해석:
</span></span></span><span class=line><span class=cl><span class=cm>- Seq Scan: 전체 테이블 스캔
</span></span></span><span class=line><span class=cl><span class=cm>- 999,900행 필터링으로 제거
</span></span></span><span class=line><span class=cl><span class=cm>- 실행 시간: 약 250ms
</span></span></span><span class=line><span class=cl><span class=cm>*/</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>3단계: 인덱스 생성 및 재측정</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-179-1><a class=lnlinks href=#hl-179-1> 1</a>
</span><span class=lnt id=hl-179-2><a class=lnlinks href=#hl-179-2> 2</a>
</span><span class=lnt id=hl-179-3><a class=lnlinks href=#hl-179-3> 3</a>
</span><span class=lnt id=hl-179-4><a class=lnlinks href=#hl-179-4> 4</a>
</span><span class=lnt id=hl-179-5><a class=lnlinks href=#hl-179-5> 5</a>
</span><span class=lnt id=hl-179-6><a class=lnlinks href=#hl-179-6> 6</a>
</span><span class=lnt id=hl-179-7><a class=lnlinks href=#hl-179-7> 7</a>
</span><span class=lnt id=hl-179-8><a class=lnlinks href=#hl-179-8> 8</a>
</span><span class=lnt id=hl-179-9><a class=lnlinks href=#hl-179-9> 9</a>
</span><span class=lnt id=hl-179-10><a class=lnlinks href=#hl-179-10>10</a>
</span><span class=lnt id=hl-179-11><a class=lnlinks href=#hl-179-11>11</a>
</span><span class=lnt id=hl-179-12><a class=lnlinks href=#hl-179-12>12</a>
</span><span class=lnt id=hl-179-13><a class=lnlinks href=#hl-179-13>13</a>
</span><span class=lnt id=hl-179-14><a class=lnlinks href=#hl-179-14>14</a>
</span><span class=lnt id=hl-179-15><a class=lnlinks href=#hl-179-15>15</a>
</span><span class=lnt id=hl-179-16><a class=lnlinks href=#hl-179-16>16</a>
</span><span class=lnt id=hl-179-17><a class=lnlinks href=#hl-179-17>17</a>
</span><span class=lnt id=hl-179-18><a class=lnlinks href=#hl-179-18>18</a>
</span><span class=lnt id=hl-179-19><a class=lnlinks href=#hl-179-19>19</a>
</span><span class=lnt id=hl-179-20><a class=lnlinks href=#hl-179-20>20</a>
</span><span class=lnt id=hl-179-21><a class=lnlinks href=#hl-179-21>21</a>
</span><span class=lnt id=hl-179-22><a class=lnlinks href=#hl-179-22>22</a>
</span><span class=lnt id=hl-179-23><a class=lnlinks href=#hl-179-23>23</a>
</span><span class=lnt id=hl-179-24><a class=lnlinks href=#hl-179-24>24</a>
</span><span class=lnt id=hl-179-25><a class=lnlinks href=#hl-179-25>25</a>
</span><span class=lnt id=hl-179-26><a class=lnlinks href=#hl-179-26>26</a>
</span><span class=lnt id=hl-179-27><a class=lnlinks href=#hl-179-27>27</a>
</span><span class=lnt id=hl-179-28><a class=lnlinks href=#hl-179-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- B-Tree 인덱스 생성
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_orders_customer</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>customer_id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스 정보 확인
</span></span></span><span class=line><span class=cl><span class=err>\</span><span class=n>di</span><span class=o>+</span><span class=w> </span><span class=n>idx_orders_customer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 동일 쿼리 재실행
</span></span></span><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYZE</span><span class=p>,</span><span class=w> </span><span class=n>BUFFERS</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5000</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>예상 결과:
</span></span></span><span class=line><span class=cl><span class=cm>Bitmap Heap Scan on orders (cost=5.12..412.34 rows=100 width=xx) (actual time=0.345..1.234 rows=100 loops=1)
</span></span></span><span class=line><span class=cl><span class=cm>  Recheck Cond: (customer_id = 5000)
</span></span></span><span class=line><span class=cl><span class=cm>  Heap Blocks: exact=95
</span></span></span><span class=line><span class=cl><span class=cm>  Buffers: shared hit=98
</span></span></span><span class=line><span class=cl><span class=cm>  -&gt;  Bitmap Index Scan on idx_orders_customer (cost=0.00..5.10 rows=100 width=0) (actual time=0.234..0.234 rows=100 loops=1)
</span></span></span><span class=line><span class=cl><span class=cm>        Index Cond: (customer_id = 5000)
</span></span></span><span class=line><span class=cl><span class=cm>        Buffers: shared hit=3
</span></span></span><span class=line><span class=cl><span class=cm>Planning Time: 0.234 ms
</span></span></span><span class=line><span class=cl><span class=cm>Execution Time: 1.456 ms
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>해석:
</span></span></span><span class=line><span class=cl><span class=cm>- Index Scan 사용
</span></span></span><span class=line><span class=cl><span class=cm>- 3개 인덱스 페이지 + 95개 데이터 페이지
</span></span></span><span class=line><span class=cl><span class=cm>- 실행 시간: 약 1.5ms (170배 개선!)
</span></span></span><span class=line><span class=cl><span class=cm>*/</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>4단계: 선택도에 따른 성능 차이</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-180-1><a class=lnlinks href=#hl-180-1> 1</a>
</span><span class=lnt id=hl-180-2><a class=lnlinks href=#hl-180-2> 2</a>
</span><span class=lnt id=hl-180-3><a class=lnlinks href=#hl-180-3> 3</a>
</span><span class=lnt id=hl-180-4><a class=lnlinks href=#hl-180-4> 4</a>
</span><span class=lnt id=hl-180-5><a class=lnlinks href=#hl-180-5> 5</a>
</span><span class=lnt id=hl-180-6><a class=lnlinks href=#hl-180-6> 6</a>
</span><span class=lnt id=hl-180-7><a class=lnlinks href=#hl-180-7> 7</a>
</span><span class=lnt id=hl-180-8><a class=lnlinks href=#hl-180-8> 8</a>
</span><span class=lnt id=hl-180-9><a class=lnlinks href=#hl-180-9> 9</a>
</span><span class=lnt id=hl-180-10><a class=lnlinks href=#hl-180-10>10</a>
</span><span class=lnt id=hl-180-11><a class=lnlinks href=#hl-180-11>11</a>
</span><span class=lnt id=hl-180-12><a class=lnlinks href=#hl-180-12>12</a>
</span><span class=lnt id=hl-180-13><a class=lnlinks href=#hl-180-13>13</a>
</span><span class=lnt id=hl-180-14><a class=lnlinks href=#hl-180-14>14</a>
</span><span class=lnt id=hl-180-15><a class=lnlinks href=#hl-180-15>15</a>
</span><span class=lnt id=hl-180-16><a class=lnlinks href=#hl-180-16>16</a>
</span><span class=lnt id=hl-180-17><a class=lnlinks href=#hl-180-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 고선택도 쿼리 (소수 결과)
</span></span></span><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYZE</span><span class=p>,</span><span class=w> </span><span class=n>BUFFERS</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5000</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;completed&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 저선택도 쿼리 (다수 결과)
</span></span></span><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYZE</span><span class=p>,</span><span class=w> </span><span class=n>BUFFERS</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;completed&#39;</span><span class=p>;</span><span class=w>  </span><span class=c1>-- 전체의 70%
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>결과 비교:
</span></span></span><span class=line><span class=cl><span class=cm>1. customer_id 인덱스: 사용됨 (100건 → 빠름)
</span></span></span><span class=line><span class=cl><span class=cm>2. status만 조건: Full Scan (700,000건 → 인덱스 불필요)
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>교훈: 선택도 낮으면 인덱스가 오히려 느림
</span></span></span><span class=line><span class=cl><span class=cm>*/</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h6 id=실행-결과-1>실행 결과<a hidden class=anchor aria-hidden=true href=#실행-결과-1>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-181-1><a class=lnlinks href=#hl-181-1> 1</a>
</span><span class=lnt id=hl-181-2><a class=lnlinks href=#hl-181-2> 2</a>
</span><span class=lnt id=hl-181-3><a class=lnlinks href=#hl-181-3> 3</a>
</span><span class=lnt id=hl-181-4><a class=lnlinks href=#hl-181-4> 4</a>
</span><span class=lnt id=hl-181-5><a class=lnlinks href=#hl-181-5> 5</a>
</span><span class=lnt id=hl-181-6><a class=lnlinks href=#hl-181-6> 6</a>
</span><span class=lnt id=hl-181-7><a class=lnlinks href=#hl-181-7> 7</a>
</span><span class=lnt id=hl-181-8><a class=lnlinks href=#hl-181-8> 8</a>
</span><span class=lnt id=hl-181-9><a class=lnlinks href=#hl-181-9> 9</a>
</span><span class=lnt id=hl-181-10><a class=lnlinks href=#hl-181-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>성능 비교 요약:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────┬────────────┬──────────────┬─────────┐
</span></span><span class=line><span class=cl>│ 쿼리 유형        │ 인덱스 전  │ 인덱스 후    │ 개선율  │
</span></span><span class=line><span class=cl>├─────────────────┼────────────┼──────────────┼─────────┤
</span></span><span class=line><span class=cl>│ 단일 고객 조회   │ 250ms      │ 1.5ms        │ 167배   │
</span></span><span class=line><span class=cl>│ 날짜 범위 조회   │ 180ms      │ 12ms         │ 15배    │
</span></span><span class=line><span class=cl>│ 복합 조건        │ 220ms      │ 3ms          │ 73배    │
</span></span><span class=line><span class=cl>│ 저선택도 (70%)   │ 200ms      │ 250ms        │ 악화!   │
</span></span><span class=line><span class=cl>└─────────────────┴────────────┴──────────────┴─────────┘
</span></span></code></pre></td></tr></table></div></div><h6 id=추가-실험-1>추가 실험<a hidden class=anchor aria-hidden=true href=#추가-실험-1>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-182-1><a class=lnlinks href=#hl-182-1> 1</a>
</span><span class=lnt id=hl-182-2><a class=lnlinks href=#hl-182-2> 2</a>
</span><span class=lnt id=hl-182-3><a class=lnlinks href=#hl-182-3> 3</a>
</span><span class=lnt id=hl-182-4><a class=lnlinks href=#hl-182-4> 4</a>
</span><span class=lnt id=hl-182-5><a class=lnlinks href=#hl-182-5> 5</a>
</span><span class=lnt id=hl-182-6><a class=lnlinks href=#hl-182-6> 6</a>
</span><span class=lnt id=hl-182-7><a class=lnlinks href=#hl-182-7> 7</a>
</span><span class=lnt id=hl-182-8><a class=lnlinks href=#hl-182-8> 8</a>
</span><span class=lnt id=hl-182-9><a class=lnlinks href=#hl-182-9> 9</a>
</span><span class=lnt id=hl-182-10><a class=lnlinks href=#hl-182-10>10</a>
</span><span class=lnt id=hl-182-11><a class=lnlinks href=#hl-182-11>11</a>
</span><span class=lnt id=hl-182-12><a class=lnlinks href=#hl-182-12>12</a>
</span><span class=lnt id=hl-182-13><a class=lnlinks href=#hl-182-13>13</a>
</span><span class=lnt id=hl-182-14><a class=lnlinks href=#hl-182-14>14</a>
</span><span class=lnt id=hl-182-15><a class=lnlinks href=#hl-182-15>15</a>
</span><span class=lnt id=hl-182-16><a class=lnlinks href=#hl-182-16>16</a>
</span><span class=lnt id=hl-182-17><a class=lnlinks href=#hl-182-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 복합 인덱스 효과 비교
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_orders_cust_date</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>customer_id</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 쿼리 1: 두 컬럼 모두 조건
</span></span></span><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=k>ANALYZE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5000</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=n>order_date</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=s1>&#39;2024-12-31&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 결과: 복합 인덱스 사용, 매우 빠름
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 쿼리 2: 두 번째 컬럼만 조건
</span></span></span><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=k>ANALYZE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>order_date</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=s1>&#39;2024-12-31&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 결과: 복합 인덱스 미사용, Full Scan
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 교훈: 복합 인덱스는 첫 컬럼부터 사용해야 효과
</span></span></span></code></pre></td></tr></table></div></div><h5 id=실습-예제-2-커버링-인덱스-구현>실습 예제 2: 커버링 인덱스 구현<a hidden class=anchor aria-hidden=true href=#실습-예제-2-커버링-인덱스-구현>#</a></h5><h6 id=목적-2>목적<a hidden class=anchor aria-hidden=true href=#목적-2>#</a></h6><ul><li>커버링 인덱스의 I/O 절감 효과 확인</li><li>INCLUDE 컬럼의 활용법 학습</li></ul><h6 id=사전-요구사항-2>사전 요구사항<a hidden class=anchor aria-hidden=true href=#사전-요구사항-2>#</a></h6><ul><li>PostgreSQL 11+ (INCLUDE 지원)</li><li>실습 1의 orders 테이블</li></ul><h6 id=단계별-구현-2>단계별 구현<a hidden class=anchor aria-hidden=true href=#단계별-구현-2>#</a></h6><p><strong>1단계: 일반 인덱스 vs 커버링 인덱스</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-183-1><a class=lnlinks href=#hl-183-1> 1</a>
</span><span class=lnt id=hl-183-2><a class=lnlinks href=#hl-183-2> 2</a>
</span><span class=lnt id=hl-183-3><a class=lnlinks href=#hl-183-3> 3</a>
</span><span class=lnt id=hl-183-4><a class=lnlinks href=#hl-183-4> 4</a>
</span><span class=lnt id=hl-183-5><a class=lnlinks href=#hl-183-5> 5</a>
</span><span class=lnt id=hl-183-6><a class=lnlinks href=#hl-183-6> 6</a>
</span><span class=lnt id=hl-183-7><a class=lnlinks href=#hl-183-7> 7</a>
</span><span class=lnt id=hl-183-8><a class=lnlinks href=#hl-183-8> 8</a>
</span><span class=lnt id=hl-183-9><a class=lnlinks href=#hl-183-9> 9</a>
</span><span class=lnt id=hl-183-10><a class=lnlinks href=#hl-183-10>10</a>
</span><span class=lnt id=hl-183-11><a class=lnlinks href=#hl-183-11>11</a>
</span><span class=lnt id=hl-183-12><a class=lnlinks href=#hl-183-12>12</a>
</span><span class=lnt id=hl-183-13><a class=lnlinks href=#hl-183-13>13</a>
</span><span class=lnt id=hl-183-14><a class=lnlinks href=#hl-183-14>14</a>
</span><span class=lnt id=hl-183-15><a class=lnlinks href=#hl-183-15>15</a>
</span><span class=lnt id=hl-183-16><a class=lnlinks href=#hl-183-16>16</a>
</span><span class=lnt id=hl-183-17><a class=lnlinks href=#hl-183-17>17</a>
</span><span class=lnt id=hl-183-18><a class=lnlinks href=#hl-183-18>18</a>
</span><span class=lnt id=hl-183-19><a class=lnlinks href=#hl-183-19>19</a>
</span><span class=lnt id=hl-183-20><a class=lnlinks href=#hl-183-20>20</a>
</span><span class=lnt id=hl-183-21><a class=lnlinks href=#hl-183-21>21</a>
</span><span class=lnt id=hl-183-22><a class=lnlinks href=#hl-183-22>22</a>
</span><span class=lnt id=hl-183-23><a class=lnlinks href=#hl-183-23>23</a>
</span><span class=lnt id=hl-183-24><a class=lnlinks href=#hl-183-24>24</a>
</span><span class=lnt id=hl-183-25><a class=lnlinks href=#hl-183-25>25</a>
</span><span class=lnt id=hl-183-26><a class=lnlinks href=#hl-183-26>26</a>
</span><span class=lnt id=hl-183-27><a class=lnlinks href=#hl-183-27>27</a>
</span><span class=lnt id=hl-183-28><a class=lnlinks href=#hl-183-28>28</a>
</span><span class=lnt id=hl-183-29><a class=lnlinks href=#hl-183-29>29</a>
</span><span class=lnt id=hl-183-30><a class=lnlinks href=#hl-183-30>30</a>
</span><span class=lnt id=hl-183-31><a class=lnlinks href=#hl-183-31>31</a>
</span><span class=lnt id=hl-183-32><a class=lnlinks href=#hl-183-32>32</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 일반 인덱스 (customer_id만)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_normal</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>customer_id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 빈번한 쿼리
</span></span></span><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYZE</span><span class=p>,</span><span class=w> </span><span class=n>BUFFERS</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>customer_id</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=p>,</span><span class=w> </span><span class=n>total_amount</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5000</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>결과:
</span></span></span><span class=line><span class=cl><span class=cm>Index Scan + Heap Fetch
</span></span></span><span class=line><span class=cl><span class=cm>Buffers: shared hit=98 (인덱스 3 + 테이블 95)
</span></span></span><span class=line><span class=cl><span class=cm>Time: 1.5ms
</span></span></span><span class=line><span class=cl><span class=cm>*/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 커버링 인덱스 (INCLUDE 사용)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_covering</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>customer_id</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=n>INCLUDE</span><span class=w> </span><span class=p>(</span><span class=n>order_date</span><span class=p>,</span><span class=w> </span><span class=n>total_amount</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 동일 쿼리 재실행
</span></span></span><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYZE</span><span class=p>,</span><span class=w> </span><span class=n>BUFFERS</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>customer_id</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=p>,</span><span class=w> </span><span class=n>total_amount</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5000</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>결과:
</span></span></span><span class=line><span class=cl><span class=cm>Index Only Scan  -- 테이블 접근 없음!
</span></span></span><span class=line><span class=cl><span class=cm>Buffers: shared hit=3 (인덱스만)
</span></span></span><span class=line><span class=cl><span class=cm>Time: 0.3ms (5배 개선)
</span></span></span><span class=line><span class=cl><span class=cm>*/</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>2단계: 가시성 맵(Visibility Map) 확인</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-184-1><a class=lnlinks href=#hl-184-1> 1</a>
</span><span class=lnt id=hl-184-2><a class=lnlinks href=#hl-184-2> 2</a>
</span><span class=lnt id=hl-184-3><a class=lnlinks href=#hl-184-3> 3</a>
</span><span class=lnt id=hl-184-4><a class=lnlinks href=#hl-184-4> 4</a>
</span><span class=lnt id=hl-184-5><a class=lnlinks href=#hl-184-5> 5</a>
</span><span class=lnt id=hl-184-6><a class=lnlinks href=#hl-184-6> 6</a>
</span><span class=lnt id=hl-184-7><a class=lnlinks href=#hl-184-7> 7</a>
</span><span class=lnt id=hl-184-8><a class=lnlinks href=#hl-184-8> 8</a>
</span><span class=lnt id=hl-184-9><a class=lnlinks href=#hl-184-9> 9</a>
</span><span class=lnt id=hl-184-10><a class=lnlinks href=#hl-184-10>10</a>
</span><span class=lnt id=hl-184-11><a class=lnlinks href=#hl-184-11>11</a>
</span><span class=lnt id=hl-184-12><a class=lnlinks href=#hl-184-12>12</a>
</span><span class=lnt id=hl-184-13><a class=lnlinks href=#hl-184-13>13</a>
</span><span class=lnt id=hl-184-14><a class=lnlinks href=#hl-184-14>14</a>
</span><span class=lnt id=hl-184-15><a class=lnlinks href=#hl-184-15>15</a>
</span><span class=lnt id=hl-184-16><a class=lnlinks href=#hl-184-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- VACUUM으로 가시성 맵 갱신
</span></span></span><span class=line><span class=cl><span class=k>VACUUM</span><span class=w> </span><span class=k>ANALYZE</span><span class=w> </span><span class=n>orders</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- Index Only Scan 효과 극대화
</span></span></span><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYZE</span><span class=p>,</span><span class=w> </span><span class=n>BUFFERS</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>customer_id</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>),</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>total_amount</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>5000</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>5010</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>customer_id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>Index Only Scan 조건:
</span></span></span><span class=line><span class=cl><span class=cm>1. 모든 컬럼이 인덱스에 포함
</span></span></span><span class=line><span class=cl><span class=cm>2. 가시성 맵 갱신됨 (VACUUM)
</span></span></span><span class=line><span class=cl><span class=cm>3. Heap Fetches: 0  -- 완벽한 커버링!
</span></span></span><span class=line><span class=cl><span class=cm>*/</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h6 id=실행-결과-2>실행 결과<a hidden class=anchor aria-hidden=true href=#실행-결과-2>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-185-1><a class=lnlinks href=#hl-185-1> 1</a>
</span><span class=lnt id=hl-185-2><a class=lnlinks href=#hl-185-2> 2</a>
</span><span class=lnt id=hl-185-3><a class=lnlinks href=#hl-185-3> 3</a>
</span><span class=lnt id=hl-185-4><a class=lnlinks href=#hl-185-4> 4</a>
</span><span class=lnt id=hl-185-5><a class=lnlinks href=#hl-185-5> 5</a>
</span><span class=lnt id=hl-185-6><a class=lnlinks href=#hl-185-6> 6</a>
</span><span class=lnt id=hl-185-7><a class=lnlinks href=#hl-185-7> 7</a>
</span><span class=lnt id=hl-185-8><a class=lnlinks href=#hl-185-8> 8</a>
</span><span class=lnt id=hl-185-9><a class=lnlinks href=#hl-185-9> 9</a>
</span><span class=lnt id=hl-185-10><a class=lnlinks href=#hl-185-10>10</a>
</span><span class=lnt id=hl-185-11><a class=lnlinks href=#hl-185-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>I/O 비교:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>일반 인덱스:
</span></span><span class=line><span class=cl>├─ 인덱스 페이지: 3
</span></span><span class=line><span class=cl>├─ 테이블 페이지: 95
</span></span><span class=line><span class=cl>└─ 총 I/O: 98
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>커버링 인덱스:
</span></span><span class=line><span class=cl>├─ 인덱스 페이지: 3
</span></span><span class=line><span class=cl>├─ 테이블 페이지: 0
</span></span><span class=line><span class=cl>└─ 총 I/O: 3 (97% 감소!)
</span></span></code></pre></td></tr></table></div></div><h5 id=실습-예제-3-인덱스-단편화-모니터링-및-재구성>실습 예제 3: 인덱스 단편화 모니터링 및 재구성<a hidden class=anchor aria-hidden=true href=#실습-예제-3-인덱스-단편화-모니터링-및-재구성>#</a></h5><h6 id=목적-3>목적<a hidden class=anchor aria-hidden=true href=#목적-3>#</a></h6><ul><li>인덱스 단편화 측정 방법 학습</li><li>재구성 타이밍 및 방법 습득</li></ul><h6 id=단계별-구현-3>단계별 구현<a hidden class=anchor aria-hidden=true href=#단계별-구현-3>#</a></h6><p><strong>1단계: 단편화 측정</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-186-1><a class=lnlinks href=#hl-186-1> 1</a>
</span><span class=lnt id=hl-186-2><a class=lnlinks href=#hl-186-2> 2</a>
</span><span class=lnt id=hl-186-3><a class=lnlinks href=#hl-186-3> 3</a>
</span><span class=lnt id=hl-186-4><a class=lnlinks href=#hl-186-4> 4</a>
</span><span class=lnt id=hl-186-5><a class=lnlinks href=#hl-186-5> 5</a>
</span><span class=lnt id=hl-186-6><a class=lnlinks href=#hl-186-6> 6</a>
</span><span class=lnt id=hl-186-7><a class=lnlinks href=#hl-186-7> 7</a>
</span><span class=lnt id=hl-186-8><a class=lnlinks href=#hl-186-8> 8</a>
</span><span class=lnt id=hl-186-9><a class=lnlinks href=#hl-186-9> 9</a>
</span><span class=lnt id=hl-186-10><a class=lnlinks href=#hl-186-10>10</a>
</span><span class=lnt id=hl-186-11><a class=lnlinks href=#hl-186-11>11</a>
</span><span class=lnt id=hl-186-12><a class=lnlinks href=#hl-186-12>12</a>
</span><span class=lnt id=hl-186-13><a class=lnlinks href=#hl-186-13>13</a>
</span><span class=lnt id=hl-186-14><a class=lnlinks href=#hl-186-14>14</a>
</span><span class=lnt id=hl-186-15><a class=lnlinks href=#hl-186-15>15</a>
</span><span class=lnt id=hl-186-16><a class=lnlinks href=#hl-186-16>16</a>
</span><span class=lnt id=hl-186-17><a class=lnlinks href=#hl-186-17>17</a>
</span><span class=lnt id=hl-186-18><a class=lnlinks href=#hl-186-18>18</a>
</span><span class=lnt id=hl-186-19><a class=lnlinks href=#hl-186-19>19</a>
</span><span class=lnt id=hl-186-20><a class=lnlinks href=#hl-186-20>20</a>
</span><span class=lnt id=hl-186-21><a class=lnlinks href=#hl-186-21>21</a>
</span><span class=lnt id=hl-186-22><a class=lnlinks href=#hl-186-22>22</a>
</span><span class=lnt id=hl-186-23><a class=lnlinks href=#hl-186-23>23</a>
</span><span class=lnt id=hl-186-24><a class=lnlinks href=#hl-186-24>24</a>
</span><span class=lnt id=hl-186-25><a class=lnlinks href=#hl-186-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- PostgreSQL: pgstattuple 확장 설치
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=n>EXTENSION</span><span class=w> </span><span class=n>pgstattuple</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스 단편화 확인
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>schemaname</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>tablename</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>indexname</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>pg_size_pretty</span><span class=p>(</span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indexrelid</span><span class=p>))</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>index_size</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>idx_scan</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>scans</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>idx_tup_read</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>tuples_read</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>idx_tup_fetch</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>tuples_fetched</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>pg_stat_user_indexes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>schemaname</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;public&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indexrelid</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 상세 단편화 정보
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>pgstatindex</span><span class=p>(</span><span class=s1>&#39;idx_orders_customer&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>주요 지표:
</span></span></span><span class=line><span class=cl><span class=cm>- leaf_fragmentation: 리프 단편화율 (목표 &lt; 30%)
</span></span></span><span class=line><span class=cl><span class=cm>- avg_leaf_density: 평균 밀도 (목표 &gt; 70%)
</span></span></span><span class=line><span class=cl><span class=cm>- leaf_pages: 리프 페이지 수
</span></span></span><span class=line><span class=cl><span class=cm>*/</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>2단계: 단편화 시뮬레이션</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-187-1><a class=lnlinks href=#hl-187-1> 1</a>
</span><span class=lnt id=hl-187-2><a class=lnlinks href=#hl-187-2> 2</a>
</span><span class=lnt id=hl-187-3><a class=lnlinks href=#hl-187-3> 3</a>
</span><span class=lnt id=hl-187-4><a class=lnlinks href=#hl-187-4> 4</a>
</span><span class=lnt id=hl-187-5><a class=lnlinks href=#hl-187-5> 5</a>
</span><span class=lnt id=hl-187-6><a class=lnlinks href=#hl-187-6> 6</a>
</span><span class=lnt id=hl-187-7><a class=lnlinks href=#hl-187-7> 7</a>
</span><span class=lnt id=hl-187-8><a class=lnlinks href=#hl-187-8> 8</a>
</span><span class=lnt id=hl-187-9><a class=lnlinks href=#hl-187-9> 9</a>
</span><span class=lnt id=hl-187-10><a class=lnlinks href=#hl-187-10>10</a>
</span><span class=lnt id=hl-187-11><a class=lnlinks href=#hl-187-11>11</a>
</span><span class=lnt id=hl-187-12><a class=lnlinks href=#hl-187-12>12</a>
</span><span class=lnt id=hl-187-13><a class=lnlinks href=#hl-187-13>13</a>
</span><span class=lnt id=hl-187-14><a class=lnlinks href=#hl-187-14>14</a>
</span><span class=lnt id=hl-187-15><a class=lnlinks href=#hl-187-15>15</a>
</span><span class=lnt id=hl-187-16><a class=lnlinks href=#hl-187-16>16</a>
</span><span class=lnt id=hl-187-17><a class=lnlinks href=#hl-187-17>17</a>
</span><span class=lnt id=hl-187-18><a class=lnlinks href=#hl-187-18>18</a>
</span><span class=lnt id=hl-187-19><a class=lnlinks href=#hl-187-19>19</a>
</span><span class=lnt id=hl-187-20><a class=lnlinks href=#hl-187-20>20</a>
</span><span class=lnt id=hl-187-21><a class=lnlinks href=#hl-187-21>21</a>
</span><span class=lnt id=hl-187-22><a class=lnlinks href=#hl-187-22>22</a>
</span><span class=lnt id=hl-187-23><a class=lnlinks href=#hl-187-23>23</a>
</span><span class=lnt id=hl-187-24><a class=lnlinks href=#hl-187-24>24</a>
</span><span class=lnt id=hl-187-25><a class=lnlinks href=#hl-187-25>25</a>
</span><span class=lnt id=hl-187-26><a class=lnlinks href=#hl-187-26>26</a>
</span><span class=lnt id=hl-187-27><a class=lnlinks href=#hl-187-27>27</a>
</span><span class=lnt id=hl-187-28><a class=lnlinks href=#hl-187-28>28</a>
</span><span class=lnt id=hl-187-29><a class=lnlinks href=#hl-187-29>29</a>
</span><span class=lnt id=hl-187-30><a class=lnlinks href=#hl-187-30>30</a>
</span><span class=lnt id=hl-187-31><a class=lnlinks href=#hl-187-31>31</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 무작위 INSERT/DELETE로 단편화 유발
</span></span></span><span class=line><span class=cl><span class=k>DO</span><span class=w> </span><span class=err>$$</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>BEGIN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FOR</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=mi>1</span><span class=p>..</span><span class=mi>10000</span><span class=w> </span><span class=n>LOOP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>-- 무작위 삽입
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span><span class=n>customer_id</span><span class=p>,</span><span class=w> </span><span class=n>order_date</span><span class=p>,</span><span class=w> </span><span class=n>total_amount</span><span class=p>,</span><span class=w> </span><span class=n>status</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>(</span><span class=n>random</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>10000</span><span class=p>)::</span><span class=nb>integer</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>CURRENT_DATE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=mi>100</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=s1>&#39;completed&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>-- 무작위 삭제
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>WHERE</span><span class=w> </span><span class=n>order_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>order_id</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>random</span><span class=p>()</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>END</span><span class=w> </span><span class=n>LOOP</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>END</span><span class=w> </span><span class=err>$$</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 단편화 재확인
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>leaf_fragmentation</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>avg_leaf_density</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>pgstatindex</span><span class=p>(</span><span class=s1>&#39;idx_orders_customer&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>예상 결과:
</span></span></span><span class=line><span class=cl><span class=cm>- leaf_fragmentation: 45% (증가!)
</span></span></span><span class=line><span class=cl><span class=cm>- avg_leaf_density: 55% (감소!)
</span></span></span><span class=line><span class=cl><span class=cm>→ 재구성 필요
</span></span></span><span class=line><span class=cl><span class=cm>*/</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>3단계: 인덱스 재구성</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-188-1><a class=lnlinks href=#hl-188-1> 1</a>
</span><span class=lnt id=hl-188-2><a class=lnlinks href=#hl-188-2> 2</a>
</span><span class=lnt id=hl-188-3><a class=lnlinks href=#hl-188-3> 3</a>
</span><span class=lnt id=hl-188-4><a class=lnlinks href=#hl-188-4> 4</a>
</span><span class=lnt id=hl-188-5><a class=lnlinks href=#hl-188-5> 5</a>
</span><span class=lnt id=hl-188-6><a class=lnlinks href=#hl-188-6> 6</a>
</span><span class=lnt id=hl-188-7><a class=lnlinks href=#hl-188-7> 7</a>
</span><span class=lnt id=hl-188-8><a class=lnlinks href=#hl-188-8> 8</a>
</span><span class=lnt id=hl-188-9><a class=lnlinks href=#hl-188-9> 9</a>
</span><span class=lnt id=hl-188-10><a class=lnlinks href=#hl-188-10>10</a>
</span><span class=lnt id=hl-188-11><a class=lnlinks href=#hl-188-11>11</a>
</span><span class=lnt id=hl-188-12><a class=lnlinks href=#hl-188-12>12</a>
</span><span class=lnt id=hl-188-13><a class=lnlinks href=#hl-188-13>13</a>
</span><span class=lnt id=hl-188-14><a class=lnlinks href=#hl-188-14>14</a>
</span><span class=lnt id=hl-188-15><a class=lnlinks href=#hl-188-15>15</a>
</span><span class=lnt id=hl-188-16><a class=lnlinks href=#hl-188-16>16</a>
</span><span class=lnt id=hl-188-17><a class=lnlinks href=#hl-188-17>17</a>
</span><span class=lnt id=hl-188-18><a class=lnlinks href=#hl-188-18>18</a>
</span><span class=lnt id=hl-188-19><a class=lnlinks href=#hl-188-19>19</a>
</span><span class=lnt id=hl-188-20><a class=lnlinks href=#hl-188-20>20</a>
</span><span class=lnt id=hl-188-21><a class=lnlinks href=#hl-188-21>21</a>
</span><span class=lnt id=hl-188-22><a class=lnlinks href=#hl-188-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 방법 1: REINDEX (테이블 잠금)
</span></span></span><span class=line><span class=cl><span class=k>REINDEX</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_orders_customer</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 방법 2: REINDEX CONCURRENTLY (PostgreSQL 12+, 온라인)
</span></span></span><span class=line><span class=cl><span class=k>REINDEX</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>CONCURRENTLY</span><span class=w> </span><span class=n>idx_orders_customer</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 방법 3: DROP and CREATE
</span></span></span><span class=line><span class=cl><span class=k>DROP</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_orders_customer</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_orders_customer</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>customer_id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 재구성 후 확인
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>leaf_fragmentation</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>avg_leaf_density</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>pgstatindex</span><span class=p>(</span><span class=s1>&#39;idx_orders_customer&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>재구성 후:
</span></span></span><span class=line><span class=cl><span class=cm>- leaf_fragmentation: 0-5%
</span></span></span><span class=line><span class=cl><span class=cm>- avg_leaf_density: 90%+
</span></span></span><span class=line><span class=cl><span class=cm>→ 최적 상태 복구
</span></span></span><span class=line><span class=cl><span class=cm>*/</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h6 id=추가-실험-2>추가 실험<a hidden class=anchor aria-hidden=true href=#추가-실험-2>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-189-1><a class=lnlinks href=#hl-189-1> 1</a>
</span><span class=lnt id=hl-189-2><a class=lnlinks href=#hl-189-2> 2</a>
</span><span class=lnt id=hl-189-3><a class=lnlinks href=#hl-189-3> 3</a>
</span><span class=lnt id=hl-189-4><a class=lnlinks href=#hl-189-4> 4</a>
</span><span class=lnt id=hl-189-5><a class=lnlinks href=#hl-189-5> 5</a>
</span><span class=lnt id=hl-189-6><a class=lnlinks href=#hl-189-6> 6</a>
</span><span class=lnt id=hl-189-7><a class=lnlinks href=#hl-189-7> 7</a>
</span><span class=lnt id=hl-189-8><a class=lnlinks href=#hl-189-8> 8</a>
</span><span class=lnt id=hl-189-9><a class=lnlinks href=#hl-189-9> 9</a>
</span><span class=lnt id=hl-189-10><a class=lnlinks href=#hl-189-10>10</a>
</span><span class=lnt id=hl-189-11><a class=lnlinks href=#hl-189-11>11</a>
</span><span class=lnt id=hl-189-12><a class=lnlinks href=#hl-189-12>12</a>
</span><span class=lnt id=hl-189-13><a class=lnlinks href=#hl-189-13>13</a>
</span><span class=lnt id=hl-189-14><a class=lnlinks href=#hl-189-14>14</a>
</span><span class=lnt id=hl-189-15><a class=lnlinks href=#hl-189-15>15</a>
</span><span class=lnt id=hl-189-16><a class=lnlinks href=#hl-189-16>16</a>
</span><span class=lnt id=hl-189-17><a class=lnlinks href=#hl-189-17>17</a>
</span><span class=lnt id=hl-189-18><a class=lnlinks href=#hl-189-18>18</a>
</span><span class=lnt id=hl-189-19><a class=lnlinks href=#hl-189-19>19</a>
</span><span class=lnt id=hl-189-20><a class=lnlinks href=#hl-189-20>20</a>
</span><span class=lnt id=hl-189-21><a class=lnlinks href=#hl-189-21>21</a>
</span><span class=lnt id=hl-189-22><a class=lnlinks href=#hl-189-22>22</a>
</span><span class=lnt id=hl-189-23><a class=lnlinks href=#hl-189-23>23</a>
</span><span class=lnt id=hl-189-24><a class=lnlinks href=#hl-189-24>24</a>
</span><span class=lnt id=hl-189-25><a class=lnlinks href=#hl-189-25>25</a>
</span><span class=lnt id=hl-189-26><a class=lnlinks href=#hl-189-26>26</a>
</span><span class=lnt id=hl-189-27><a class=lnlinks href=#hl-189-27>27</a>
</span><span class=lnt id=hl-189-28><a class=lnlinks href=#hl-189-28>28</a>
</span><span class=lnt id=hl-189-29><a class=lnlinks href=#hl-189-29>29</a>
</span><span class=lnt id=hl-189-30><a class=lnlinks href=#hl-189-30>30</a>
</span><span class=lnt id=hl-189-31><a class=lnlinks href=#hl-189-31>31</a>
</span><span class=lnt id=hl-189-32><a class=lnlinks href=#hl-189-32>32</a>
</span><span class=lnt id=hl-189-33><a class=lnlinks href=#hl-189-33>33</a>
</span><span class=lnt id=hl-189-34><a class=lnlinks href=#hl-189-34>34</a>
</span><span class=lnt id=hl-189-35><a class=lnlinks href=#hl-189-35>35</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python 스크립트: 자동 단편화 모니터링</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>psycopg2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>check_fragmentation</span><span class=p>(</span><span class=n>conn</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>cur</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>cur</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        SELECT 
</span></span></span><span class=line><span class=cl><span class=s2>            indexname,
</span></span></span><span class=line><span class=cl><span class=s2>            leaf_fragmentation,
</span></span></span><span class=line><span class=cl><span class=s2>            avg_leaf_density
</span></span></span><span class=line><span class=cl><span class=s2>        FROM pgstatindex(indexname)
</span></span></span><span class=line><span class=cl><span class=s2>        JOIN pg_stat_user_indexes USING (indexrelid)
</span></span></span><span class=line><span class=cl><span class=s2>        WHERE schemaname = &#39;public&#39;
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>cur</span><span class=o>.</span><span class=n>fetchall</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>indexname</span><span class=p>,</span> <span class=n>frag</span><span class=p>,</span> <span class=n>density</span> <span class=o>=</span> <span class=n>row</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 임계값 확인</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>frag</span> <span class=o>&gt;</span> <span class=mi>30</span> <span class=ow>or</span> <span class=n>density</span> <span class=o>&lt;</span> <span class=mi>70</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;경고: </span><span class=si>{</span><span class=n>indexname</span><span class=si>}</span><span class=s2> 재구성 필요&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  단편화: </span><span class=si>{</span><span class=n>frag</span><span class=si>}</span><span class=s2>%, 밀도: </span><span class=si>{</span><span class=n>density</span><span class=si>}</span><span class=s2>%&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 자동 재구성 (선택적)</span>
</span></span><span class=line><span class=cl>            <span class=n>cur</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;REINDEX INDEX CONCURRENTLY </span><span class=si>{</span><span class=n>indexname</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>conn</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  → 재구성 완료&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 주기적 실행</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span> <span class=o>=</span> <span class=n>psycopg2</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=s2>&#34;dbname=mydb user=postgres&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>check_fragmentation</span><span class=p>(</span><span class=n>conn</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>3600</span><span class=p>)</span>  <span class=c1># 1시간마다</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=52-실제-도입-사례-분석-1>5.2 실제 도입 사례 분석<a hidden class=anchor aria-hidden=true href=#52-실제-도입-사례-분석-1>#</a></h4><h5 id=실제-도입-사례-1-uber---지리공간-인덱스-최적화>실제 도입 사례 1: Uber - 지리공간 인덱스 최적화<a hidden class=anchor aria-hidden=true href=#실제-도입-사례-1-uber---지리공간-인덱스-최적화>#</a></h5><h6 id=배경-및-도입-이유-1>배경 및 도입 이유<a hidden class=anchor aria-hidden=true href=#배경-및-도입-이유-1>#</a></h6><p><strong>비즈니스 요구사항</strong>:</p><ul><li>초당 수백만 건의 위치 업데이트 처리</li><li>실시간 주변 차량 검색 (&lt;100ms)</li><li>전 세계 수백만 차량 추적</li></ul><p><strong>기술적 과제</strong>:</p><ul><li>2D 공간 데이터의 효율적 인덱싱</li><li>높은 쓰기 처리량과 낮은 읽기 지연 동시 달성</li><li>샤딩 환경에서의 지리적 분산</li></ul><p><strong>선정 이유</strong>:</p><ul><li>기존 B-Tree로는 공간 범위 검색 비효율</li><li>2차원 좌표를 1차원으로 변환 시 locality 손실</li><li>R-Tree의 다차원 범위 검색 특화</li></ul><h6 id=구현-아키텍처-1>구현 아키텍처<a hidden class=anchor aria-hidden=true href=#구현-아키텍처-1>#</a></h6><pre class=mermaid>graph TB
    subgraph &#34;Uber 위치 인덱싱 아키텍처&#34;
        A[모바일 앱] --&gt;|위치 스트림| B[Kafka]
        B --&gt; C[Flink 스트림 처리]
        C --&gt; D[Redis Geo Index]
        C --&gt; E[Cassandra&lt;br/&gt;R-Tree Index]
        
        F[승객 검색 요청] --&gt; G[검색 서비스]
        G --&gt; D
        G --&gt; E
        
        D --&gt;|Hot Data&lt;br/&gt;최근 5분| H[결과 집계]
        E --&gt;|Warm Data&lt;br/&gt;5분 이상| H
        
        H --&gt; I[가까운 차량 목록]
    end
    
    style D fill:#90EE90
    style E fill:#87CEEB
    style H fill:#FFE4B5
</pre><p><strong>계층별 인덱스 전략</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-191-1><a class=lnlinks href=#hl-191-1> 1</a>
</span><span class=lnt id=hl-191-2><a class=lnlinks href=#hl-191-2> 2</a>
</span><span class=lnt id=hl-191-3><a class=lnlinks href=#hl-191-3> 3</a>
</span><span class=lnt id=hl-191-4><a class=lnlinks href=#hl-191-4> 4</a>
</span><span class=lnt id=hl-191-5><a class=lnlinks href=#hl-191-5> 5</a>
</span><span class=lnt id=hl-191-6><a class=lnlinks href=#hl-191-6> 6</a>
</span><span class=lnt id=hl-191-7><a class=lnlinks href=#hl-191-7> 7</a>
</span><span class=lnt id=hl-191-8><a class=lnlinks href=#hl-191-8> 8</a>
</span><span class=lnt id=hl-191-9><a class=lnlinks href=#hl-191-9> 9</a>
</span><span class=lnt id=hl-191-10><a class=lnlinks href=#hl-191-10>10</a>
</span><span class=lnt id=hl-191-11><a class=lnlinks href=#hl-191-11>11</a>
</span><span class=lnt id=hl-191-12><a class=lnlinks href=#hl-191-12>12</a>
</span><span class=lnt id=hl-191-13><a class=lnlinks href=#hl-191-13>13</a>
</span><span class=lnt id=hl-191-14><a class=lnlinks href=#hl-191-14>14</a>
</span><span class=lnt id=hl-191-15><a class=lnlinks href=#hl-191-15>15</a>
</span><span class=lnt id=hl-191-16><a class=lnlinks href=#hl-191-16>16</a>
</span><span class=lnt id=hl-191-17><a class=lnlinks href=#hl-191-17>17</a>
</span><span class=lnt id=hl-191-18><a class=lnlinks href=#hl-191-18>18</a>
</span><span class=lnt id=hl-191-19><a class=lnlinks href=#hl-191-19>19</a>
</span><span class=lnt id=hl-191-20><a class=lnlinks href=#hl-191-20>20</a>
</span><span class=lnt id=hl-191-21><a class=lnlinks href=#hl-191-21>21</a>
</span><span class=lnt id=hl-191-22><a class=lnlinks href=#hl-191-22>22</a>
</span><span class=lnt id=hl-191-23><a class=lnlinks href=#hl-191-23>23</a>
</span><span class=lnt id=hl-191-24><a class=lnlinks href=#hl-191-24>24</a>
</span><span class=lnt id=hl-191-25><a class=lnlinks href=#hl-191-25>25</a>
</span><span class=lnt id=hl-191-26><a class=lnlinks href=#hl-191-26>26</a>
</span><span class=lnt id=hl-191-27><a class=lnlinks href=#hl-191-27>27</a>
</span><span class=lnt id=hl-191-28><a class=lnlinks href=#hl-191-28>28</a>
</span><span class=lnt id=hl-191-29><a class=lnlinks href=#hl-191-29>29</a>
</span><span class=lnt id=hl-191-30><a class=lnlinks href=#hl-191-30>30</a>
</span><span class=lnt id=hl-191-31><a class=lnlinks href=#hl-191-31>31</a>
</span><span class=lnt id=hl-191-32><a class=lnlinks href=#hl-191-32>32</a>
</span><span class=lnt id=hl-191-33><a class=lnlinks href=#hl-191-33>33</a>
</span><span class=lnt id=hl-191-34><a class=lnlinks href=#hl-191-34>34</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Hot Tier (Redis Geo):
</span></span><span class=line><span class=cl>├─ 구조: Geohash + Sorted Set
</span></span><span class=line><span class=cl>├─ 데이터: 최근 5분 이내 위치
</span></span><span class=line><span class=cl>├─ 쿼리: GEORADIUS key longitude latitude radius
</span></span><span class=line><span class=cl>└─ 성능: &lt;10ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>예시:
</span></span><span class=line><span class=cl>&gt; GEOADD drivers:active 
</span></span><span class=line><span class=cl>    -122.4194 37.7749 &#34;driver:123&#34;
</span></span><span class=line><span class=cl>    -122.4084 37.7849 &#34;driver:456&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; GEORADIUS drivers:active 
</span></span><span class=line><span class=cl>    -122.4194 37.7749 1 km WITHDIST
</span></span><span class=line><span class=cl>1) &#34;driver:123&#34; (0.05 km)
</span></span><span class=line><span class=cl>2) &#34;driver:456&#34; (1.2 km)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Warm Tier (Cassandra + R-Tree):
</span></span><span class=line><span class=cl>├─ 구조: Custom R-Tree implementation
</span></span><span class=line><span class=cl>├─ 데이터: 전체 히스토리
</span></span><span class=line><span class=cl>├─ 파티셔닝: Geohash prefix (6자리)
</span></span><span class=line><span class=cl>└─ 성능: &lt;50ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>파티션 키 설계:
</span></span><span class=line><span class=cl>CREATE TABLE driver_locations (
</span></span><span class=line><span class=cl>    geohash_prefix TEXT,     -- 예: &#34;9q8yy&#34;
</span></span><span class=line><span class=cl>    driver_id UUID,
</span></span><span class=line><span class=cl>    location POINT,          -- (lng, lat)
</span></span><span class=line><span class=cl>    timestamp TIMESTAMP,
</span></span><span class=line><span class=cl>    PRIMARY KEY ((geohash_prefix), driver_id, timestamp)
</span></span><span class=line><span class=cl>);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>CREATE CUSTOM INDEX idx_location 
</span></span><span class=line><span class=cl>ON driver_locations(location) 
</span></span><span class=line><span class=cl>USING &#39;com.uber.RTreeIndex&#39;;
</span></span></code></pre></td></tr></table></div></div><h6 id=핵심-구현-코드-1>핵심 구현 코드<a hidden class=anchor aria-hidden=true href=#핵심-구현-코드-1>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-192-1><a class=lnlinks href=#hl-192-1> 1</a>
</span><span class=lnt id=hl-192-2><a class=lnlinks href=#hl-192-2> 2</a>
</span><span class=lnt id=hl-192-3><a class=lnlinks href=#hl-192-3> 3</a>
</span><span class=lnt id=hl-192-4><a class=lnlinks href=#hl-192-4> 4</a>
</span><span class=lnt id=hl-192-5><a class=lnlinks href=#hl-192-5> 5</a>
</span><span class=lnt id=hl-192-6><a class=lnlinks href=#hl-192-6> 6</a>
</span><span class=lnt id=hl-192-7><a class=lnlinks href=#hl-192-7> 7</a>
</span><span class=lnt id=hl-192-8><a class=lnlinks href=#hl-192-8> 8</a>
</span><span class=lnt id=hl-192-9><a class=lnlinks href=#hl-192-9> 9</a>
</span><span class=lnt id=hl-192-10><a class=lnlinks href=#hl-192-10>10</a>
</span><span class=lnt id=hl-192-11><a class=lnlinks href=#hl-192-11>11</a>
</span><span class=lnt id=hl-192-12><a class=lnlinks href=#hl-192-12>12</a>
</span><span class=lnt id=hl-192-13><a class=lnlinks href=#hl-192-13>13</a>
</span><span class=lnt id=hl-192-14><a class=lnlinks href=#hl-192-14>14</a>
</span><span class=lnt id=hl-192-15><a class=lnlinks href=#hl-192-15>15</a>
</span><span class=lnt id=hl-192-16><a class=lnlinks href=#hl-192-16>16</a>
</span><span class=lnt id=hl-192-17><a class=lnlinks href=#hl-192-17>17</a>
</span><span class=lnt id=hl-192-18><a class=lnlinks href=#hl-192-18>18</a>
</span><span class=lnt id=hl-192-19><a class=lnlinks href=#hl-192-19>19</a>
</span><span class=lnt id=hl-192-20><a class=lnlinks href=#hl-192-20>20</a>
</span><span class=lnt id=hl-192-21><a class=lnlinks href=#hl-192-21>21</a>
</span><span class=lnt id=hl-192-22><a class=lnlinks href=#hl-192-22>22</a>
</span><span class=lnt id=hl-192-23><a class=lnlinks href=#hl-192-23>23</a>
</span><span class=lnt id=hl-192-24><a class=lnlinks href=#hl-192-24>24</a>
</span><span class=lnt id=hl-192-25><a class=lnlinks href=#hl-192-25>25</a>
</span><span class=lnt id=hl-192-26><a class=lnlinks href=#hl-192-26>26</a>
</span><span class=lnt id=hl-192-27><a class=lnlinks href=#hl-192-27>27</a>
</span><span class=lnt id=hl-192-28><a class=lnlinks href=#hl-192-28>28</a>
</span><span class=lnt id=hl-192-29><a class=lnlinks href=#hl-192-29>29</a>
</span><span class=lnt id=hl-192-30><a class=lnlinks href=#hl-192-30>30</a>
</span><span class=lnt id=hl-192-31><a class=lnlinks href=#hl-192-31>31</a>
</span><span class=lnt id=hl-192-32><a class=lnlinks href=#hl-192-32>32</a>
</span><span class=lnt id=hl-192-33><a class=lnlinks href=#hl-192-33>33</a>
</span><span class=lnt id=hl-192-34><a class=lnlinks href=#hl-192-34>34</a>
</span><span class=lnt id=hl-192-35><a class=lnlinks href=#hl-192-35>35</a>
</span><span class=lnt id=hl-192-36><a class=lnlinks href=#hl-192-36>36</a>
</span><span class=lnt id=hl-192-37><a class=lnlinks href=#hl-192-37>37</a>
</span><span class=lnt id=hl-192-38><a class=lnlinks href=#hl-192-38>38</a>
</span><span class=lnt id=hl-192-39><a class=lnlinks href=#hl-192-39>39</a>
</span><span class=lnt id=hl-192-40><a class=lnlinks href=#hl-192-40>40</a>
</span><span class=lnt id=hl-192-41><a class=lnlinks href=#hl-192-41>41</a>
</span><span class=lnt id=hl-192-42><a class=lnlinks href=#hl-192-42>42</a>
</span><span class=lnt id=hl-192-43><a class=lnlinks href=#hl-192-43>43</a>
</span><span class=lnt id=hl-192-44><a class=lnlinks href=#hl-192-44>44</a>
</span><span class=lnt id=hl-192-45><a class=lnlinks href=#hl-192-45>45</a>
</span><span class=lnt id=hl-192-46><a class=lnlinks href=#hl-192-46>46</a>
</span><span class=lnt id=hl-192-47><a class=lnlinks href=#hl-192-47>47</a>
</span><span class=lnt id=hl-192-48><a class=lnlinks href=#hl-192-48>48</a>
</span><span class=lnt id=hl-192-49><a class=lnlinks href=#hl-192-49>49</a>
</span><span class=lnt id=hl-192-50><a class=lnlinks href=#hl-192-50>50</a>
</span><span class=lnt id=hl-192-51><a class=lnlinks href=#hl-192-51>51</a>
</span><span class=lnt id=hl-192-52><a class=lnlinks href=#hl-192-52>52</a>
</span><span class=lnt id=hl-192-53><a class=lnlinks href=#hl-192-53>53</a>
</span><span class=lnt id=hl-192-54><a class=lnlinks href=#hl-192-54>54</a>
</span><span class=lnt id=hl-192-55><a class=lnlinks href=#hl-192-55>55</a>
</span><span class=lnt id=hl-192-56><a class=lnlinks href=#hl-192-56>56</a>
</span><span class=lnt id=hl-192-57><a class=lnlinks href=#hl-192-57>57</a>
</span><span class=lnt id=hl-192-58><a class=lnlinks href=#hl-192-58>58</a>
</span><span class=lnt id=hl-192-59><a class=lnlinks href=#hl-192-59>59</a>
</span><span class=lnt id=hl-192-60><a class=lnlinks href=#hl-192-60>60</a>
</span><span class=lnt id=hl-192-61><a class=lnlinks href=#hl-192-61>61</a>
</span><span class=lnt id=hl-192-62><a class=lnlinks href=#hl-192-62>62</a>
</span><span class=lnt id=hl-192-63><a class=lnlinks href=#hl-192-63>63</a>
</span><span class=lnt id=hl-192-64><a class=lnlinks href=#hl-192-64>64</a>
</span><span class=lnt id=hl-192-65><a class=lnlinks href=#hl-192-65>65</a>
</span><span class=lnt id=hl-192-66><a class=lnlinks href=#hl-192-66>66</a>
</span><span class=lnt id=hl-192-67><a class=lnlinks href=#hl-192-67>67</a>
</span><span class=lnt id=hl-192-68><a class=lnlinks href=#hl-192-68>68</a>
</span><span class=lnt id=hl-192-69><a class=lnlinks href=#hl-192-69>69</a>
</span><span class=lnt id=hl-192-70><a class=lnlinks href=#hl-192-70>70</a>
</span><span class=lnt id=hl-192-71><a class=lnlinks href=#hl-192-71>71</a>
</span><span class=lnt id=hl-192-72><a class=lnlinks href=#hl-192-72>72</a>
</span><span class=lnt id=hl-192-73><a class=lnlinks href=#hl-192-73>73</a>
</span><span class=lnt id=hl-192-74><a class=lnlinks href=#hl-192-74>74</a>
</span><span class=lnt id=hl-192-75><a class=lnlinks href=#hl-192-75>75</a>
</span><span class=lnt id=hl-192-76><a class=lnlinks href=#hl-192-76>76</a>
</span><span class=lnt id=hl-192-77><a class=lnlinks href=#hl-192-77>77</a>
</span><span class=lnt id=hl-192-78><a class=lnlinks href=#hl-192-78>78</a>
</span><span class=lnt id=hl-192-79><a class=lnlinks href=#hl-192-79>79</a>
</span><span class=lnt id=hl-192-80><a class=lnlinks href=#hl-192-80>80</a>
</span><span class=lnt id=hl-192-81><a class=lnlinks href=#hl-192-81>81</a>
</span><span class=lnt id=hl-192-82><a class=lnlinks href=#hl-192-82>82</a>
</span><span class=lnt id=hl-192-83><a class=lnlinks href=#hl-192-83>83</a>
</span><span class=lnt id=hl-192-84><a class=lnlinks href=#hl-192-84>84</a>
</span><span class=lnt id=hl-192-85><a class=lnlinks href=#hl-192-85>85</a>
</span><span class=lnt id=hl-192-86><a class=lnlinks href=#hl-192-86>86</a>
</span><span class=lnt id=hl-192-87><a class=lnlinks href=#hl-192-87>87</a>
</span><span class=lnt id=hl-192-88><a class=lnlinks href=#hl-192-88>88</a>
</span><span class=lnt id=hl-192-89><a class=lnlinks href=#hl-192-89>89</a>
</span><span class=lnt id=hl-192-90><a class=lnlinks href=#hl-192-90>90</a>
</span><span class=lnt id=hl-192-91><a class=lnlinks href=#hl-192-91>91</a>
</span><span class=lnt id=hl-192-92><a class=lnlinks href=#hl-192-92>92</a>
</span><span class=lnt id=hl-192-93><a class=lnlinks href=#hl-192-93>93</a>
</span><span class=lnt id=hl-192-94><a class=lnlinks href=#hl-192-94>94</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Uber의 Geohash 기반 공간 인덱싱 (단순화)</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>geohash2</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>cassandra.cluster</span> <span class=kn>import</span> <span class=n>Cluster</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UberLocationIndex</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>precision</span><span class=o>=</span><span class=mi>6</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>precision</span> <span class=o>=</span> <span class=n>precision</span>  <span class=c1># Geohash 정밀도</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>cluster</span> <span class=o>=</span> <span class=n>Cluster</span><span class=p>([</span><span class=s1>&#39;cassandra-node&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>session</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>cluster</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=s1>&#39;uber_locations&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>update_location</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>driver_id</span><span class=p>,</span> <span class=n>lng</span><span class=p>,</span> <span class=n>lat</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;드라이버 위치 업데이트&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># Geohash 계산 (파티션 키)</span>
</span></span><span class=line><span class=cl>        <span class=n>gh</span> <span class=o>=</span> <span class=n>geohash2</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>lat</span><span class=p>,</span> <span class=n>lng</span><span class=p>,</span> <span class=n>precision</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>precision</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Cassandra 삽입 (R-Tree 자동 갱신)</span>
</span></span><span class=line><span class=cl>        <span class=n>query</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            INSERT INTO driver_locations 
</span></span></span><span class=line><span class=cl><span class=s2>            (geohash_prefix, driver_id, location, timestamp)
</span></span></span><span class=line><span class=cl><span class=s2>            VALUES (</span><span class=si>%s</span><span class=s2>, </span><span class=si>%s</span><span class=s2>, (</span><span class=si>%s</span><span class=s2>, </span><span class=si>%s</span><span class=s2>), </span><span class=si>%s</span><span class=s2>)
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>query</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=n>gh</span><span class=p>,</span> <span class=n>driver_id</span><span class=p>,</span> <span class=n>lng</span><span class=p>,</span> <span class=n>lat</span><span class=p>,</span> <span class=n>timestamp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>find_nearby_drivers</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>lng</span><span class=p>,</span> <span class=n>lat</span><span class=p>,</span> <span class=n>radius_km</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;주변 드라이버 검색&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. 중심 Geohash와 이웃 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>center_gh</span> <span class=o>=</span> <span class=n>geohash2</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>lat</span><span class=p>,</span> <span class=n>lng</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>precision</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>neighbors</span> <span class=o>=</span> <span class=n>geohash2</span><span class=o>.</span><span class=n>neighbors</span><span class=p>(</span><span class=n>center_gh</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>search_areas</span> <span class=o>=</span> <span class=p>[</span><span class=n>center_gh</span><span class=p>]</span> <span class=o>+</span> <span class=n>neighbors</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. 각 파티션에서 병렬 검색</span>
</span></span><span class=line><span class=cl>        <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>gh_prefix</span> <span class=ow>in</span> <span class=n>search_areas</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># R-Tree 공간 쿼리</span>
</span></span><span class=line><span class=cl>            <span class=n>query</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>                SELECT driver_id, location, timestamp
</span></span></span><span class=line><span class=cl><span class=s2>                FROM driver_locations
</span></span></span><span class=line><span class=cl><span class=s2>                WHERE geohash_prefix = </span><span class=si>%s</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>                  AND within(location, point(</span><span class=si>%s</span><span class=s2>, </span><span class=si>%s</span><span class=s2>), </span><span class=si>%s</span><span class=s2>)
</span></span></span><span class=line><span class=cl><span class=s2>                  AND timestamp &gt; now() - interval &#39;5 minutes&#39;
</span></span></span><span class=line><span class=cl><span class=s2>            &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>rows</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>query</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=n>gh_prefix</span><span class=p>,</span> <span class=n>lng</span><span class=p>,</span> <span class=n>lat</span><span class=p>,</span> <span class=n>radius_km</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>)</span>  <span class=c1># 미터 단위</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>results</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>rows</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. 정확한 거리 계산 및 정렬</span>
</span></span><span class=line><span class=cl>        <span class=kn>from</span> <span class=nn>geopy.distance</span> <span class=kn>import</span> <span class=n>geodesic</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>drivers</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>results</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>driver_lng</span><span class=p>,</span> <span class=n>driver_lat</span> <span class=o>=</span> <span class=n>row</span><span class=o>.</span><span class=n>location</span>
</span></span><span class=line><span class=cl>            <span class=n>distance</span> <span class=o>=</span> <span class=n>geodesic</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=n>lat</span><span class=p>,</span> <span class=n>lng</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=n>driver_lat</span><span class=p>,</span> <span class=n>driver_lng</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span><span class=o>.</span><span class=n>km</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>distance</span> <span class=o>&lt;=</span> <span class=n>radius_km</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>drivers</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;driver_id&#39;</span><span class=p>:</span> <span class=n>row</span><span class=o>.</span><span class=n>driver_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;distance&#39;</span><span class=p>:</span> <span class=n>distance</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;location&#39;</span><span class=p>:</span> <span class=p>(</span><span class=n>driver_lng</span><span class=p>,</span> <span class=n>driver_lat</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>row</span><span class=o>.</span><span class=n>timestamp</span>
</span></span><span class=line><span class=cl>                <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 거리순 정렬</span>
</span></span><span class=line><span class=cl>        <span class=n>drivers</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;distance&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>drivers</span><span class=p>[:</span><span class=mi>10</span><span class=p>]</span>  <span class=c1># 상위 10개</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>index</span> <span class=o>=</span> <span class=n>UberLocationIndex</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 위치 업데이트 (드라이버 앱에서)</span>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=o>.</span><span class=n>update_location</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>driver_id</span><span class=o>=</span><span class=s1>&#39;550e8400-e29b-41d4-a716-446655440000&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>lng</span><span class=o>=-</span><span class=mf>122.4194</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>lat</span><span class=o>=</span><span class=mf>37.7749</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>timestamp</span><span class=o>=</span><span class=s1>&#39;2024-09-26 10:30:00&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 주변 검색 (승객 앱에서)</span>
</span></span><span class=line><span class=cl><span class=n>nearby</span> <span class=o>=</span> <span class=n>index</span><span class=o>.</span><span class=n>find_nearby_drivers</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>lng</span><span class=o>=-</span><span class=mf>122.4194</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>lat</span><span class=o>=</span><span class=mf>37.7749</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>radius_km</span><span class=o>=</span><span class=mf>2.0</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;반경 2km 내 드라이버: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>nearby</span><span class=p>)</span><span class=si>}</span><span class=s2>명&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>driver</span> <span class=ow>in</span> <span class=n>nearby</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - </span><span class=si>{</span><span class=n>driver</span><span class=p>[</span><span class=s1>&#39;driver_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>driver</span><span class=p>[</span><span class=s1>&#39;distance&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>km&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=성과-및-결과-1>성과 및 결과<a hidden class=anchor aria-hidden=true href=#성과-및-결과-1>#</a></h6><p><strong>정량적 성과</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-193-1><a class=lnlinks href=#hl-193-1> 1</a>
</span><span class=lnt id=hl-193-2><a class=lnlinks href=#hl-193-2> 2</a>
</span><span class=lnt id=hl-193-3><a class=lnlinks href=#hl-193-3> 3</a>
</span><span class=lnt id=hl-193-4><a class=lnlinks href=#hl-193-4> 4</a>
</span><span class=lnt id=hl-193-5><a class=lnlinks href=#hl-193-5> 5</a>
</span><span class=lnt id=hl-193-6><a class=lnlinks href=#hl-193-6> 6</a>
</span><span class=lnt id=hl-193-7><a class=lnlinks href=#hl-193-7> 7</a>
</span><span class=lnt id=hl-193-8><a class=lnlinks href=#hl-193-8> 8</a>
</span><span class=lnt id=hl-193-9><a class=lnlinks href=#hl-193-9> 9</a>
</span><span class=lnt id=hl-193-10><a class=lnlinks href=#hl-193-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>성능 개선:
</span></span><span class=line><span class=cl>├─ 검색 지연: 평균 450ms → 35ms (13배 개선)
</span></span><span class=line><span class=cl>├─ 쓰기 처리량: 50K ops/s → 500K ops/s (10배)
</span></span><span class=line><span class=cl>├─ 인프라 비용: 40% 절감 (효율적 샤딩)
</span></span><span class=line><span class=cl>└─ P99 지연: 1.2s → 120ms (10배)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>확장성:
</span></span><span class=line><span class=cl>├─ 동시 활성 드라이버: 50만 → 300만
</span></span><span class=line><span class=cl>├─ 초당 위치 업데이트: 5만 → 80만
</span></span><span class=line><span class=cl>└─ 글로벌 도시: 100개 → 900개
</span></span></code></pre></td></tr></table></div></div><p><strong>정성적 개선</strong>:</p><ul><li>매칭 정확도 향상: 더 가까운 드라이버 배정</li><li>사용자 경험: 대기 시간 30% 감소</li><li>운영 안정성: 장애 복구 시간 감소</li></ul><h6 id=교훈-및-시사점-1>교훈 및 시사점<a hidden class=anchor aria-hidden=true href=#교훈-및-시사점-1>#</a></h6><p><strong>성공 요인</strong>:</p><ol><li><strong>계층화 전략</strong>: Hot(Redis) + Warm(Cassandra) 분리</li><li><strong>Geohash 파티셔닝</strong>: 지리적으로 가까운 데이터 군집화</li><li><strong>병렬 검색</strong>: 여러 파티션 동시 조회로 지연 최소화</li></ol><p><strong>재현 시 유의점</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-194-1><a class=lnlinks href=#hl-194-1> 1</a>
</span><span class=lnt id=hl-194-2><a class=lnlinks href=#hl-194-2> 2</a>
</span><span class=lnt id=hl-194-3><a class=lnlinks href=#hl-194-3> 3</a>
</span><span class=lnt id=hl-194-4><a class=lnlinks href=#hl-194-4> 4</a>
</span><span class=lnt id=hl-194-5><a class=lnlinks href=#hl-194-5> 5</a>
</span><span class=lnt id=hl-194-6><a class=lnlinks href=#hl-194-6> 6</a>
</span><span class=lnt id=hl-194-7><a class=lnlinks href=#hl-194-7> 7</a>
</span><span class=lnt id=hl-194-8><a class=lnlinks href=#hl-194-8> 8</a>
</span><span class=lnt id=hl-194-9><a class=lnlinks href=#hl-194-9> 9</a>
</span><span class=lnt id=hl-194-10><a class=lnlinks href=#hl-194-10>10</a>
</span><span class=lnt id=hl-194-11><a class=lnlinks href=#hl-194-11>11</a>
</span><span class=lnt id=hl-194-12><a class=lnlinks href=#hl-194-12>12</a>
</span><span class=lnt id=hl-194-13><a class=lnlinks href=#hl-194-13>13</a>
</span><span class=lnt id=hl-194-14><a class=lnlinks href=#hl-194-14>14</a>
</span><span class=lnt id=hl-194-15><a class=lnlinks href=#hl-194-15>15</a>
</span><span class=lnt id=hl-194-16><a class=lnlinks href=#hl-194-16>16</a>
</span><span class=lnt id=hl-194-17><a class=lnlinks href=#hl-194-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. Geohash 정밀도 선택:
</span></span><span class=line><span class=cl>   - precision=5 (5km × 5km): 도시 전체
</span></span><span class=line><span class=cl>   - precision=6 (1.2km × 0.6km): 권장 (Uber)
</span></span><span class=line><span class=cl>   - precision=7 (150m × 150m): 정밀하지만 파티션 많음
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 경계 처리:
</span></span><span class=line><span class=cl>   - Geohash 경계에 걸친 검색 누락 방지
</span></span><span class=line><span class=cl>   - 8개 이웃 영역 모두 검색 필요
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 시간 윈도우:
</span></span><span class=line><span class=cl>   - 오래된 위치 데이터 TTL 설정
</span></span><span class=line><span class=cl>   - Cassandra: TTL 300 (5분)
</span></span><span class=line><span class=cl>   - Redis: EXPIRE 300
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4. 확장 전략:
</span></span><span class=line><span class=cl>   - Geohash prefix로 자동 샤딩
</span></span><span class=line><span class=cl>   - 핫스팟 모니터링 및 재분산
</span></span></code></pre></td></tr></table></div></div><h5 id=실제-도입-사례-2-netflix---비디오-메타데이터-검색-최적화>실제 도입 사례 2: Netflix - 비디오 메타데이터 검색 최적화<a hidden class=anchor aria-hidden=true href=#실제-도입-사례-2-netflix---비디오-메타데이터-검색-최적화>#</a></h5><h6 id=배경-및-도입-이유-2>배경 및 도입 이유<a hidden class=anchor aria-hidden=true href=#배경-및-도입-이유-2>#</a></h6><p><strong>비즈니스 요구사항</strong>:</p><ul><li>2억 구독자, 수만 개 콘텐츠 실시간 검색</li><li>다국어 검색 지원 (50+ 언어)</li><li>개인화된 검색 결과 (&lt;200ms)</li></ul><p><strong>기술적 과제</strong>:</p><ul><li>복잡한 텍스트 쿼리 (제목, 설명, 배우, 장르)</li><li>대소문자, 맞춤법 오류 허용</li><li>동의어, 다국어 처리</li></ul><p><strong>선정 이유</strong>:</p><ul><li>관계형 DB의 LIKE 연산 느림</li><li>Full-Text Index의 한계 (동의어, 퍼지 매칭)</li><li>Elasticsearch의 강력한 검색 기능</li></ul><h6 id=구현-아키텍처-2>구현 아키텍처<a hidden class=anchor aria-hidden=true href=#구현-아키텍처-2>#</a></h6><pre class=mermaid>graph TB
    subgraph &#34;Netflix 검색 파이프라인&#34;
        A[콘텐츠 DB&lt;br/&gt;MySQL] --&gt;|CDC| B[Kafka]
        B --&gt; C[ETL Pipeline]
        C --&gt; D[Elasticsearch&lt;br/&gt;클러스터]
        
        E[사용자 검색] --&gt; F[Search API]
        F --&gt; G{캐시 체크}
        G --&gt;|Hit| H[Redis]
        G --&gt;|Miss| D
        
        D --&gt; I[랭킹 모델&lt;br/&gt;ML 기반]
        I --&gt; J[개인화 필터]
        J --&gt; K[검색 결과]
        
        K --&gt; H
        K --&gt; E
    end
    
    style D fill:#87CEEB
    style I fill:#FFE4B5
    style H fill:#90EE90
</pre><p><strong>Elasticsearch 인덱스 설계</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-196-1><a class=lnlinks href=#hl-196-1> 1</a>
</span><span class=lnt id=hl-196-2><a class=lnlinks href=#hl-196-2> 2</a>
</span><span class=lnt id=hl-196-3><a class=lnlinks href=#hl-196-3> 3</a>
</span><span class=lnt id=hl-196-4><a class=lnlinks href=#hl-196-4> 4</a>
</span><span class=lnt id=hl-196-5><a class=lnlinks href=#hl-196-5> 5</a>
</span><span class=lnt id=hl-196-6><a class=lnlinks href=#hl-196-6> 6</a>
</span><span class=lnt id=hl-196-7><a class=lnlinks href=#hl-196-7> 7</a>
</span><span class=lnt id=hl-196-8><a class=lnlinks href=#hl-196-8> 8</a>
</span><span class=lnt id=hl-196-9><a class=lnlinks href=#hl-196-9> 9</a>
</span><span class=lnt id=hl-196-10><a class=lnlinks href=#hl-196-10>10</a>
</span><span class=lnt id=hl-196-11><a class=lnlinks href=#hl-196-11>11</a>
</span><span class=lnt id=hl-196-12><a class=lnlinks href=#hl-196-12>12</a>
</span><span class=lnt id=hl-196-13><a class=lnlinks href=#hl-196-13>13</a>
</span><span class=lnt id=hl-196-14><a class=lnlinks href=#hl-196-14>14</a>
</span><span class=lnt id=hl-196-15><a class=lnlinks href=#hl-196-15>15</a>
</span><span class=lnt id=hl-196-16><a class=lnlinks href=#hl-196-16>16</a>
</span><span class=lnt id=hl-196-17><a class=lnlinks href=#hl-196-17>17</a>
</span><span class=lnt id=hl-196-18><a class=lnlinks href=#hl-196-18>18</a>
</span><span class=lnt id=hl-196-19><a class=lnlinks href=#hl-196-19>19</a>
</span><span class=lnt id=hl-196-20><a class=lnlinks href=#hl-196-20>20</a>
</span><span class=lnt id=hl-196-21><a class=lnlinks href=#hl-196-21>21</a>
</span><span class=lnt id=hl-196-22><a class=lnlinks href=#hl-196-22>22</a>
</span><span class=lnt id=hl-196-23><a class=lnlinks href=#hl-196-23>23</a>
</span><span class=lnt id=hl-196-24><a class=lnlinks href=#hl-196-24>24</a>
</span><span class=lnt id=hl-196-25><a class=lnlinks href=#hl-196-25>25</a>
</span><span class=lnt id=hl-196-26><a class=lnlinks href=#hl-196-26>26</a>
</span><span class=lnt id=hl-196-27><a class=lnlinks href=#hl-196-27>27</a>
</span><span class=lnt id=hl-196-28><a class=lnlinks href=#hl-196-28>28</a>
</span><span class=lnt id=hl-196-29><a class=lnlinks href=#hl-196-29>29</a>
</span><span class=lnt id=hl-196-30><a class=lnlinks href=#hl-196-30>30</a>
</span><span class=lnt id=hl-196-31><a class=lnlinks href=#hl-196-31>31</a>
</span><span class=lnt id=hl-196-32><a class=lnlinks href=#hl-196-32>32</a>
</span><span class=lnt id=hl-196-33><a class=lnlinks href=#hl-196-33>33</a>
</span><span class=lnt id=hl-196-34><a class=lnlinks href=#hl-196-34>34</a>
</span><span class=lnt id=hl-196-35><a class=lnlinks href=#hl-196-35>35</a>
</span><span class=lnt id=hl-196-36><a class=lnlinks href=#hl-196-36>36</a>
</span><span class=lnt id=hl-196-37><a class=lnlinks href=#hl-196-37>37</a>
</span><span class=lnt id=hl-196-38><a class=lnlinks href=#hl-196-38>38</a>
</span><span class=lnt id=hl-196-39><a class=lnlinks href=#hl-196-39>39</a>
</span><span class=lnt id=hl-196-40><a class=lnlinks href=#hl-196-40>40</a>
</span><span class=lnt id=hl-196-41><a class=lnlinks href=#hl-196-41>41</a>
</span><span class=lnt id=hl-196-42><a class=lnlinks href=#hl-196-42>42</a>
</span><span class=lnt id=hl-196-43><a class=lnlinks href=#hl-196-43>43</a>
</span><span class=lnt id=hl-196-44><a class=lnlinks href=#hl-196-44>44</a>
</span><span class=lnt id=hl-196-45><a class=lnlinks href=#hl-196-45>45</a>
</span><span class=lnt id=hl-196-46><a class=lnlinks href=#hl-196-46>46</a>
</span><span class=lnt id=hl-196-47><a class=lnlinks href=#hl-196-47>47</a>
</span><span class=lnt id=hl-196-48><a class=lnlinks href=#hl-196-48>48</a>
</span><span class=lnt id=hl-196-49><a class=lnlinks href=#hl-196-49>49</a>
</span><span class=lnt id=hl-196-50><a class=lnlinks href=#hl-196-50>50</a>
</span><span class=lnt id=hl-196-51><a class=lnlinks href=#hl-196-51>51</a>
</span><span class=lnt id=hl-196-52><a class=lnlinks href=#hl-196-52>52</a>
</span><span class=lnt id=hl-196-53><a class=lnlinks href=#hl-196-53>53</a>
</span><span class=lnt id=hl-196-54><a class=lnlinks href=#hl-196-54>54</a>
</span><span class=lnt id=hl-196-55><a class=lnlinks href=#hl-196-55>55</a>
</span><span class=lnt id=hl-196-56><a class=lnlinks href=#hl-196-56>56</a>
</span><span class=lnt id=hl-196-57><a class=lnlinks href=#hl-196-57>57</a>
</span><span class=lnt id=hl-196-58><a class=lnlinks href=#hl-196-58>58</a>
</span><span class=lnt id=hl-196-59><a class=lnlinks href=#hl-196-59>59</a>
</span><span class=lnt id=hl-196-60><a class=lnlinks href=#hl-196-60>60</a>
</span><span class=lnt id=hl-196-61><a class=lnlinks href=#hl-196-61>61</a>
</span><span class=lnt id=hl-196-62><a class=lnlinks href=#hl-196-62>62</a>
</span><span class=lnt id=hl-196-63><a class=lnlinks href=#hl-196-63>63</a>
</span><span class=lnt id=hl-196-64><a class=lnlinks href=#hl-196-64>64</a>
</span><span class=lnt id=hl-196-65><a class=lnlinks href=#hl-196-65>65</a>
</span><span class=lnt id=hl-196-66><a class=lnlinks href=#hl-196-66>66</a>
</span><span class=lnt id=hl-196-67><a class=lnlinks href=#hl-196-67>67</a>
</span><span class=lnt id=hl-196-68><a class=lnlinks href=#hl-196-68>68</a>
</span><span class=lnt id=hl-196-69><a class=lnlinks href=#hl-196-69>69</a>
</span><span class=lnt id=hl-196-70><a class=lnlinks href=#hl-196-70>70</a>
</span><span class=lnt id=hl-196-71><a class=lnlinks href=#hl-196-71>71</a>
</span><span class=lnt id=hl-196-72><a class=lnlinks href=#hl-196-72>72</a>
</span><span class=lnt id=hl-196-73><a class=lnlinks href=#hl-196-73>73</a>
</span><span class=lnt id=hl-196-74><a class=lnlinks href=#hl-196-74>74</a>
</span><span class=lnt id=hl-196-75><a class=lnlinks href=#hl-196-75>75</a>
</span><span class=lnt id=hl-196-76><a class=lnlinks href=#hl-196-76>76</a>
</span><span class=lnt id=hl-196-77><a class=lnlinks href=#hl-196-77>77</a>
</span><span class=lnt id=hl-196-78><a class=lnlinks href=#hl-196-78>78</a>
</span><span class=lnt id=hl-196-79><a class=lnlinks href=#hl-196-79>79</a>
</span><span class=lnt id=hl-196-80><a class=lnlinks href=#hl-196-80>80</a>
</span><span class=lnt id=hl-196-81><a class=lnlinks href=#hl-196-81>81</a>
</span><span class=lnt id=hl-196-82><a class=lnlinks href=#hl-196-82>82</a>
</span><span class=lnt id=hl-196-83><a class=lnlinks href=#hl-196-83>83</a>
</span><span class=lnt id=hl-196-84><a class=lnlinks href=#hl-196-84>84</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;settings&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;number_of_shards&#34;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;number_of_replicas&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;analysis&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;analyzer&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;netflix_analyzer&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;custom&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;tokenizer&#34;</span><span class=p>:</span> <span class=s2>&#34;standard&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;filter&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;lowercase&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;asciifolding&#34;</span><span class=p>,</span>        <span class=c1>// 악센트 제거
</span></span></span><span class=line><span class=cl>            <span class=s2>&#34;netflix_synonym&#34;</span><span class=p>,</span>     <span class=c1>// 동의어
</span></span></span><span class=line><span class=cl>            <span class=s2>&#34;netflix_stemmer&#34;</span><span class=p>,</span>     <span class=c1>// 어간 추출
</span></span></span><span class=line><span class=cl>            <span class=s2>&#34;edge_ngram_filter&#34;</span>    <span class=c1>// 자동완성
</span></span></span><span class=line><span class=cl>          <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;filter&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;netflix_synonym&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;synonym&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;synonyms&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;movie, film, cinema&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;tv show, series, program&#34;</span>
</span></span><span class=line><span class=cl>          <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;netflix_stemmer&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;stemmer&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;language&#34;</span><span class=p>:</span> <span class=s2>&#34;english&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;edge_ngram_filter&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;edge_ngram&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;min_gram&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;max_gram&#34;</span><span class=p>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;mappings&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;properties&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;text&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;analyzer&#34;</span><span class=p>:</span> <span class=s2>&#34;netflix_analyzer&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;fields&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;keyword&#34;</span><span class=p>:</span> <span class=p>{</span> <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;keyword&#34;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;suggest&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;completion&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;analyzer&#34;</span><span class=p>:</span> <span class=s2>&#34;simple&#34;</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;description&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;text&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;analyzer&#34;</span><span class=p>:</span> <span class=s2>&#34;netflix_analyzer&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;genres&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;keyword&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;cast&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;text&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;analyzer&#34;</span><span class=p>:</span> <span class=s2>&#34;netflix_analyzer&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;fields&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;keyword&#34;</span><span class=p>:</span> <span class=p>{</span> <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;keyword&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;release_year&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;integer&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;rating&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;float&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;popularity_score&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;float&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;user_preferences&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;nested&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;properties&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;user_id&#34;</span><span class=p>:</span> <span class=p>{</span> <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;keyword&#34;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;watch_score&#34;</span><span class=p>:</span> <span class=p>{</span> <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;float&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=핵심-구현-코드-2>핵심 구현 코드<a hidden class=anchor aria-hidden=true href=#핵심-구현-코드-2>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-197-1><a class=lnlinks href=#hl-197-1>  1</a>
</span><span class=lnt id=hl-197-2><a class=lnlinks href=#hl-197-2>  2</a>
</span><span class=lnt id=hl-197-3><a class=lnlinks href=#hl-197-3>  3</a>
</span><span class=lnt id=hl-197-4><a class=lnlinks href=#hl-197-4>  4</a>
</span><span class=lnt id=hl-197-5><a class=lnlinks href=#hl-197-5>  5</a>
</span><span class=lnt id=hl-197-6><a class=lnlinks href=#hl-197-6>  6</a>
</span><span class=lnt id=hl-197-7><a class=lnlinks href=#hl-197-7>  7</a>
</span><span class=lnt id=hl-197-8><a class=lnlinks href=#hl-197-8>  8</a>
</span><span class=lnt id=hl-197-9><a class=lnlinks href=#hl-197-9>  9</a>
</span><span class=lnt id=hl-197-10><a class=lnlinks href=#hl-197-10> 10</a>
</span><span class=lnt id=hl-197-11><a class=lnlinks href=#hl-197-11> 11</a>
</span><span class=lnt id=hl-197-12><a class=lnlinks href=#hl-197-12> 12</a>
</span><span class=lnt id=hl-197-13><a class=lnlinks href=#hl-197-13> 13</a>
</span><span class=lnt id=hl-197-14><a class=lnlinks href=#hl-197-14> 14</a>
</span><span class=lnt id=hl-197-15><a class=lnlinks href=#hl-197-15> 15</a>
</span><span class=lnt id=hl-197-16><a class=lnlinks href=#hl-197-16> 16</a>
</span><span class=lnt id=hl-197-17><a class=lnlinks href=#hl-197-17> 17</a>
</span><span class=lnt id=hl-197-18><a class=lnlinks href=#hl-197-18> 18</a>
</span><span class=lnt id=hl-197-19><a class=lnlinks href=#hl-197-19> 19</a>
</span><span class=lnt id=hl-197-20><a class=lnlinks href=#hl-197-20> 20</a>
</span><span class=lnt id=hl-197-21><a class=lnlinks href=#hl-197-21> 21</a>
</span><span class=lnt id=hl-197-22><a class=lnlinks href=#hl-197-22> 22</a>
</span><span class=lnt id=hl-197-23><a class=lnlinks href=#hl-197-23> 23</a>
</span><span class=lnt id=hl-197-24><a class=lnlinks href=#hl-197-24> 24</a>
</span><span class=lnt id=hl-197-25><a class=lnlinks href=#hl-197-25> 25</a>
</span><span class=lnt id=hl-197-26><a class=lnlinks href=#hl-197-26> 26</a>
</span><span class=lnt id=hl-197-27><a class=lnlinks href=#hl-197-27> 27</a>
</span><span class=lnt id=hl-197-28><a class=lnlinks href=#hl-197-28> 28</a>
</span><span class=lnt id=hl-197-29><a class=lnlinks href=#hl-197-29> 29</a>
</span><span class=lnt id=hl-197-30><a class=lnlinks href=#hl-197-30> 30</a>
</span><span class=lnt id=hl-197-31><a class=lnlinks href=#hl-197-31> 31</a>
</span><span class=lnt id=hl-197-32><a class=lnlinks href=#hl-197-32> 32</a>
</span><span class=lnt id=hl-197-33><a class=lnlinks href=#hl-197-33> 33</a>
</span><span class=lnt id=hl-197-34><a class=lnlinks href=#hl-197-34> 34</a>
</span><span class=lnt id=hl-197-35><a class=lnlinks href=#hl-197-35> 35</a>
</span><span class=lnt id=hl-197-36><a class=lnlinks href=#hl-197-36> 36</a>
</span><span class=lnt id=hl-197-37><a class=lnlinks href=#hl-197-37> 37</a>
</span><span class=lnt id=hl-197-38><a class=lnlinks href=#hl-197-38> 38</a>
</span><span class=lnt id=hl-197-39><a class=lnlinks href=#hl-197-39> 39</a>
</span><span class=lnt id=hl-197-40><a class=lnlinks href=#hl-197-40> 40</a>
</span><span class=lnt id=hl-197-41><a class=lnlinks href=#hl-197-41> 41</a>
</span><span class=lnt id=hl-197-42><a class=lnlinks href=#hl-197-42> 42</a>
</span><span class=lnt id=hl-197-43><a class=lnlinks href=#hl-197-43> 43</a>
</span><span class=lnt id=hl-197-44><a class=lnlinks href=#hl-197-44> 44</a>
</span><span class=lnt id=hl-197-45><a class=lnlinks href=#hl-197-45> 45</a>
</span><span class=lnt id=hl-197-46><a class=lnlinks href=#hl-197-46> 46</a>
</span><span class=lnt id=hl-197-47><a class=lnlinks href=#hl-197-47> 47</a>
</span><span class=lnt id=hl-197-48><a class=lnlinks href=#hl-197-48> 48</a>
</span><span class=lnt id=hl-197-49><a class=lnlinks href=#hl-197-49> 49</a>
</span><span class=lnt id=hl-197-50><a class=lnlinks href=#hl-197-50> 50</a>
</span><span class=lnt id=hl-197-51><a class=lnlinks href=#hl-197-51> 51</a>
</span><span class=lnt id=hl-197-52><a class=lnlinks href=#hl-197-52> 52</a>
</span><span class=lnt id=hl-197-53><a class=lnlinks href=#hl-197-53> 53</a>
</span><span class=lnt id=hl-197-54><a class=lnlinks href=#hl-197-54> 54</a>
</span><span class=lnt id=hl-197-55><a class=lnlinks href=#hl-197-55> 55</a>
</span><span class=lnt id=hl-197-56><a class=lnlinks href=#hl-197-56> 56</a>
</span><span class=lnt id=hl-197-57><a class=lnlinks href=#hl-197-57> 57</a>
</span><span class=lnt id=hl-197-58><a class=lnlinks href=#hl-197-58> 58</a>
</span><span class=lnt id=hl-197-59><a class=lnlinks href=#hl-197-59> 59</a>
</span><span class=lnt id=hl-197-60><a class=lnlinks href=#hl-197-60> 60</a>
</span><span class=lnt id=hl-197-61><a class=lnlinks href=#hl-197-61> 61</a>
</span><span class=lnt id=hl-197-62><a class=lnlinks href=#hl-197-62> 62</a>
</span><span class=lnt id=hl-197-63><a class=lnlinks href=#hl-197-63> 63</a>
</span><span class=lnt id=hl-197-64><a class=lnlinks href=#hl-197-64> 64</a>
</span><span class=lnt id=hl-197-65><a class=lnlinks href=#hl-197-65> 65</a>
</span><span class=lnt id=hl-197-66><a class=lnlinks href=#hl-197-66> 66</a>
</span><span class=lnt id=hl-197-67><a class=lnlinks href=#hl-197-67> 67</a>
</span><span class=lnt id=hl-197-68><a class=lnlinks href=#hl-197-68> 68</a>
</span><span class=lnt id=hl-197-69><a class=lnlinks href=#hl-197-69> 69</a>
</span><span class=lnt id=hl-197-70><a class=lnlinks href=#hl-197-70> 70</a>
</span><span class=lnt id=hl-197-71><a class=lnlinks href=#hl-197-71> 71</a>
</span><span class=lnt id=hl-197-72><a class=lnlinks href=#hl-197-72> 72</a>
</span><span class=lnt id=hl-197-73><a class=lnlinks href=#hl-197-73> 73</a>
</span><span class=lnt id=hl-197-74><a class=lnlinks href=#hl-197-74> 74</a>
</span><span class=lnt id=hl-197-75><a class=lnlinks href=#hl-197-75> 75</a>
</span><span class=lnt id=hl-197-76><a class=lnlinks href=#hl-197-76> 76</a>
</span><span class=lnt id=hl-197-77><a class=lnlinks href=#hl-197-77> 77</a>
</span><span class=lnt id=hl-197-78><a class=lnlinks href=#hl-197-78> 78</a>
</span><span class=lnt id=hl-197-79><a class=lnlinks href=#hl-197-79> 79</a>
</span><span class=lnt id=hl-197-80><a class=lnlinks href=#hl-197-80> 80</a>
</span><span class=lnt id=hl-197-81><a class=lnlinks href=#hl-197-81> 81</a>
</span><span class=lnt id=hl-197-82><a class=lnlinks href=#hl-197-82> 82</a>
</span><span class=lnt id=hl-197-83><a class=lnlinks href=#hl-197-83> 83</a>
</span><span class=lnt id=hl-197-84><a class=lnlinks href=#hl-197-84> 84</a>
</span><span class=lnt id=hl-197-85><a class=lnlinks href=#hl-197-85> 85</a>
</span><span class=lnt id=hl-197-86><a class=lnlinks href=#hl-197-86> 86</a>
</span><span class=lnt id=hl-197-87><a class=lnlinks href=#hl-197-87> 87</a>
</span><span class=lnt id=hl-197-88><a class=lnlinks href=#hl-197-88> 88</a>
</span><span class=lnt id=hl-197-89><a class=lnlinks href=#hl-197-89> 89</a>
</span><span class=lnt id=hl-197-90><a class=lnlinks href=#hl-197-90> 90</a>
</span><span class=lnt id=hl-197-91><a class=lnlinks href=#hl-197-91> 91</a>
</span><span class=lnt id=hl-197-92><a class=lnlinks href=#hl-197-92> 92</a>
</span><span class=lnt id=hl-197-93><a class=lnlinks href=#hl-197-93> 93</a>
</span><span class=lnt id=hl-197-94><a class=lnlinks href=#hl-197-94> 94</a>
</span><span class=lnt id=hl-197-95><a class=lnlinks href=#hl-197-95> 95</a>
</span><span class=lnt id=hl-197-96><a class=lnlinks href=#hl-197-96> 96</a>
</span><span class=lnt id=hl-197-97><a class=lnlinks href=#hl-197-97> 97</a>
</span><span class=lnt id=hl-197-98><a class=lnlinks href=#hl-197-98> 98</a>
</span><span class=lnt id=hl-197-99><a class=lnlinks href=#hl-197-99> 99</a>
</span><span class=lnt id=hl-197-100><a class=lnlinks href=#hl-197-100>100</a>
</span><span class=lnt id=hl-197-101><a class=lnlinks href=#hl-197-101>101</a>
</span><span class=lnt id=hl-197-102><a class=lnlinks href=#hl-197-102>102</a>
</span><span class=lnt id=hl-197-103><a class=lnlinks href=#hl-197-103>103</a>
</span><span class=lnt id=hl-197-104><a class=lnlinks href=#hl-197-104>104</a>
</span><span class=lnt id=hl-197-105><a class=lnlinks href=#hl-197-105>105</a>
</span><span class=lnt id=hl-197-106><a class=lnlinks href=#hl-197-106>106</a>
</span><span class=lnt id=hl-197-107><a class=lnlinks href=#hl-197-107>107</a>
</span><span class=lnt id=hl-197-108><a class=lnlinks href=#hl-197-108>108</a>
</span><span class=lnt id=hl-197-109><a class=lnlinks href=#hl-197-109>109</a>
</span><span class=lnt id=hl-197-110><a class=lnlinks href=#hl-197-110>110</a>
</span><span class=lnt id=hl-197-111><a class=lnlinks href=#hl-197-111>111</a>
</span><span class=lnt id=hl-197-112><a class=lnlinks href=#hl-197-112>112</a>
</span><span class=lnt id=hl-197-113><a class=lnlinks href=#hl-197-113>113</a>
</span><span class=lnt id=hl-197-114><a class=lnlinks href=#hl-197-114>114</a>
</span><span class=lnt id=hl-197-115><a class=lnlinks href=#hl-197-115>115</a>
</span><span class=lnt id=hl-197-116><a class=lnlinks href=#hl-197-116>116</a>
</span><span class=lnt id=hl-197-117><a class=lnlinks href=#hl-197-117>117</a>
</span><span class=lnt id=hl-197-118><a class=lnlinks href=#hl-197-118>118</a>
</span><span class=lnt id=hl-197-119><a class=lnlinks href=#hl-197-119>119</a>
</span><span class=lnt id=hl-197-120><a class=lnlinks href=#hl-197-120>120</a>
</span><span class=lnt id=hl-197-121><a class=lnlinks href=#hl-197-121>121</a>
</span><span class=lnt id=hl-197-122><a class=lnlinks href=#hl-197-122>122</a>
</span><span class=lnt id=hl-197-123><a class=lnlinks href=#hl-197-123>123</a>
</span><span class=lnt id=hl-197-124><a class=lnlinks href=#hl-197-124>124</a>
</span><span class=lnt id=hl-197-125><a class=lnlinks href=#hl-197-125>125</a>
</span><span class=lnt id=hl-197-126><a class=lnlinks href=#hl-197-126>126</a>
</span><span class=lnt id=hl-197-127><a class=lnlinks href=#hl-197-127>127</a>
</span><span class=lnt id=hl-197-128><a class=lnlinks href=#hl-197-128>128</a>
</span><span class=lnt id=hl-197-129><a class=lnlinks href=#hl-197-129>129</a>
</span><span class=lnt id=hl-197-130><a class=lnlinks href=#hl-197-130>130</a>
</span><span class=lnt id=hl-197-131><a class=lnlinks href=#hl-197-131>131</a>
</span><span class=lnt id=hl-197-132><a class=lnlinks href=#hl-197-132>132</a>
</span><span class=lnt id=hl-197-133><a class=lnlinks href=#hl-197-133>133</a>
</span><span class=lnt id=hl-197-134><a class=lnlinks href=#hl-197-134>134</a>
</span><span class=lnt id=hl-197-135><a class=lnlinks href=#hl-197-135>135</a>
</span><span class=lnt id=hl-197-136><a class=lnlinks href=#hl-197-136>136</a>
</span><span class=lnt id=hl-197-137><a class=lnlinks href=#hl-197-137>137</a>
</span><span class=lnt id=hl-197-138><a class=lnlinks href=#hl-197-138>138</a>
</span><span class=lnt id=hl-197-139><a class=lnlinks href=#hl-197-139>139</a>
</span><span class=lnt id=hl-197-140><a class=lnlinks href=#hl-197-140>140</a>
</span><span class=lnt id=hl-197-141><a class=lnlinks href=#hl-197-141>141</a>
</span><span class=lnt id=hl-197-142><a class=lnlinks href=#hl-197-142>142</a>
</span><span class=lnt id=hl-197-143><a class=lnlinks href=#hl-197-143>143</a>
</span><span class=lnt id=hl-197-144><a class=lnlinks href=#hl-197-144>144</a>
</span><span class=lnt id=hl-197-145><a class=lnlinks href=#hl-197-145>145</a>
</span><span class=lnt id=hl-197-146><a class=lnlinks href=#hl-197-146>146</a>
</span><span class=lnt id=hl-197-147><a class=lnlinks href=#hl-197-147>147</a>
</span><span class=lnt id=hl-197-148><a class=lnlinks href=#hl-197-148>148</a>
</span><span class=lnt id=hl-197-149><a class=lnlinks href=#hl-197-149>149</a>
</span><span class=lnt id=hl-197-150><a class=lnlinks href=#hl-197-150>150</a>
</span><span class=lnt id=hl-197-151><a class=lnlinks href=#hl-197-151>151</a>
</span><span class=lnt id=hl-197-152><a class=lnlinks href=#hl-197-152>152</a>
</span><span class=lnt id=hl-197-153><a class=lnlinks href=#hl-197-153>153</a>
</span><span class=lnt id=hl-197-154><a class=lnlinks href=#hl-197-154>154</a>
</span><span class=lnt id=hl-197-155><a class=lnlinks href=#hl-197-155>155</a>
</span><span class=lnt id=hl-197-156><a class=lnlinks href=#hl-197-156>156</a>
</span><span class=lnt id=hl-197-157><a class=lnlinks href=#hl-197-157>157</a>
</span><span class=lnt id=hl-197-158><a class=lnlinks href=#hl-197-158>158</a>
</span><span class=lnt id=hl-197-159><a class=lnlinks href=#hl-197-159>159</a>
</span><span class=lnt id=hl-197-160><a class=lnlinks href=#hl-197-160>160</a>
</span><span class=lnt id=hl-197-161><a class=lnlinks href=#hl-197-161>161</a>
</span><span class=lnt id=hl-197-162><a class=lnlinks href=#hl-197-162>162</a>
</span><span class=lnt id=hl-197-163><a class=lnlinks href=#hl-197-163>163</a>
</span><span class=lnt id=hl-197-164><a class=lnlinks href=#hl-197-164>164</a>
</span><span class=lnt id=hl-197-165><a class=lnlinks href=#hl-197-165>165</a>
</span><span class=lnt id=hl-197-166><a class=lnlinks href=#hl-197-166>166</a>
</span><span class=lnt id=hl-197-167><a class=lnlinks href=#hl-197-167>167</a>
</span><span class=lnt id=hl-197-168><a class=lnlinks href=#hl-197-168>168</a>
</span><span class=lnt id=hl-197-169><a class=lnlinks href=#hl-197-169>169</a>
</span><span class=lnt id=hl-197-170><a class=lnlinks href=#hl-197-170>170</a>
</span><span class=lnt id=hl-197-171><a class=lnlinks href=#hl-197-171>171</a>
</span><span class=lnt id=hl-197-172><a class=lnlinks href=#hl-197-172>172</a>
</span><span class=lnt id=hl-197-173><a class=lnlinks href=#hl-197-173>173</a>
</span><span class=lnt id=hl-197-174><a class=lnlinks href=#hl-197-174>174</a>
</span><span class=lnt id=hl-197-175><a class=lnlinks href=#hl-197-175>175</a>
</span><span class=lnt id=hl-197-176><a class=lnlinks href=#hl-197-176>176</a>
</span><span class=lnt id=hl-197-177><a class=lnlinks href=#hl-197-177>177</a>
</span><span class=lnt id=hl-197-178><a class=lnlinks href=#hl-197-178>178</a>
</span><span class=lnt id=hl-197-179><a class=lnlinks href=#hl-197-179>179</a>
</span><span class=lnt id=hl-197-180><a class=lnlinks href=#hl-197-180>180</a>
</span><span class=lnt id=hl-197-181><a class=lnlinks href=#hl-197-181>181</a>
</span><span class=lnt id=hl-197-182><a class=lnlinks href=#hl-197-182>182</a>
</span><span class=lnt id=hl-197-183><a class=lnlinks href=#hl-197-183>183</a>
</span><span class=lnt id=hl-197-184><a class=lnlinks href=#hl-197-184>184</a>
</span><span class=lnt id=hl-197-185><a class=lnlinks href=#hl-197-185>185</a>
</span><span class=lnt id=hl-197-186><a class=lnlinks href=#hl-197-186>186</a>
</span><span class=lnt id=hl-197-187><a class=lnlinks href=#hl-197-187>187</a>
</span><span class=lnt id=hl-197-188><a class=lnlinks href=#hl-197-188>188</a>
</span><span class=lnt id=hl-197-189><a class=lnlinks href=#hl-197-189>189</a>
</span><span class=lnt id=hl-197-190><a class=lnlinks href=#hl-197-190>190</a>
</span><span class=lnt id=hl-197-191><a class=lnlinks href=#hl-197-191>191</a>
</span><span class=lnt id=hl-197-192><a class=lnlinks href=#hl-197-192>192</a>
</span><span class=lnt id=hl-197-193><a class=lnlinks href=#hl-197-193>193</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>elasticsearch</span> <span class=kn>import</span> <span class=n>Elasticsearch</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>elasticsearch_dsl</span> <span class=kn>import</span> <span class=n>Search</span><span class=p>,</span> <span class=n>Q</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>NetflixSearchEngine</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>es</span> <span class=o>=</span> <span class=n>Elasticsearch</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span><span class=s1>&#39;es-node1&#39;</span><span class=p>,</span> <span class=s1>&#39;es-node2&#39;</span><span class=p>,</span> <span class=s1>&#39;es-node3&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>http_auth</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;elastic&#39;</span><span class=p>,</span> <span class=s1>&#39;password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>index</span> <span class=o>=</span> <span class=s1>&#39;netflix_catalog&#39;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>multi_match_search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>query</span><span class=p>,</span> <span class=n>user_id</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>filters</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;멀티 필드 검색 with 개인화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. 기본 쿼리 구성</span>
</span></span><span class=line><span class=cl>        <span class=n>search</span> <span class=o>=</span> <span class=n>Search</span><span class=p>(</span><span class=n>using</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>es</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>index</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. Multi-match 쿼리 (제목, 설명, 배우)</span>
</span></span><span class=line><span class=cl>        <span class=n>multi_match</span> <span class=o>=</span> <span class=n>Q</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;multi_match&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>query</span><span class=o>=</span><span class=n>query</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>fields</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;title^3&#39;</span><span class=p>,</span>        <span class=c1># 제목 가중치 3배</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;description^2&#39;</span><span class=p>,</span>  <span class=c1># 설명 가중치 2배</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;cast&#39;</span>            <span class=c1># 배우 가중치 1배</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nb>type</span><span class=o>=</span><span class=s1>&#39;best_fields&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>fuzziness</span><span class=o>=</span><span class=s1>&#39;AUTO&#39;</span>      <span class=c1># 맞춤법 오류 허용</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>search</span> <span class=o>=</span> <span class=n>search</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=n>multi_match</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. 필터 적용 (장르, 연도 등)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>filters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=s1>&#39;genres&#39;</span> <span class=ow>in</span> <span class=n>filters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>search</span> <span class=o>=</span> <span class=n>search</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=s1>&#39;terms&#39;</span><span class=p>,</span> <span class=n>genres</span><span class=o>=</span><span class=n>filters</span><span class=p>[</span><span class=s1>&#39;genres&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=s1>&#39;year_range&#39;</span> <span class=ow>in</span> <span class=n>filters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>search</span> <span class=o>=</span> <span class=n>search</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;range&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                    <span class=n>release_year</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;gte&#39;</span><span class=p>:</span> <span class=n>filters</span><span class=p>[</span><span class=s1>&#39;year_range&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;lte&#39;</span><span class=p>:</span> <span class=n>filters</span><span class=p>[</span><span class=s1>&#39;year_range&#39;</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 4. 개인화 점수 부스팅</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user_id</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># Function Score로 개인화 점수 반영</span>
</span></span><span class=line><span class=cl>            <span class=n>search</span> <span class=o>=</span> <span class=n>search</span><span class=o>.</span><span class=n>query</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;function_score&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>query</span><span class=o>=</span><span class=n>multi_match</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>functions</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;filter&#39;</span><span class=p>:</span> <span class=n>Q</span><span class=p>(</span><span class=s1>&#39;nested&#39;</span><span class=p>,</span> <span class=n>path</span><span class=o>=</span><span class=s1>&#39;user_preferences&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                                   <span class=n>query</span><span class=o>=</span><span class=n>Q</span><span class=p>(</span><span class=s1>&#39;term&#39;</span><span class=p>,</span> <span class=n>user_preferences__user_id</span><span class=o>=</span><span class=n>user_id</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;weight&#39;</span><span class=p>:</span> <span class=mf>2.0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;field_value_factor&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                            <span class=s1>&#39;field&#39;</span><span class=p>:</span> <span class=s1>&#39;user_preferences.watch_score&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                            <span class=s1>&#39;modifier&#39;</span><span class=p>:</span> <span class=s1>&#39;log1p&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                            <span class=s1>&#39;missing&#39;</span><span class=p>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>                        <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=p>},</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;field_value_factor&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                            <span class=s1>&#39;field&#39;</span><span class=p>:</span> <span class=s1>&#39;popularity_score&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                            <span class=s1>&#39;modifier&#39;</span><span class=p>:</span> <span class=s1>&#39;log1p&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                            <span class=s1>&#39;factor&#39;</span><span class=p>:</span> <span class=mf>0.5</span>
</span></span><span class=line><span class=cl>                        <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;score_mode&#39;</span><span class=p>:</span> <span class=s1>&#39;sum&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;boost_mode&#39;</span><span class=p>:</span> <span class=s1>&#39;multiply&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 5. 정렬 및 페이징</span>
</span></span><span class=line><span class=cl>        <span class=n>search</span> <span class=o>=</span> <span class=n>search</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s1>&#39;_score&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;order&#39;</span><span class=p>:</span> <span class=s1>&#39;desc&#39;</span><span class=p>}},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s1>&#39;release_year&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;order&#39;</span><span class=p>:</span> <span class=s1>&#39;desc&#39;</span><span class=p>}}</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>search</span> <span class=o>=</span> <span class=n>search</span><span class=p>[:</span><span class=mi>20</span><span class=p>]</span>  <span class=c1># 상위 20개</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 6. 실행 및 결과 파싱</span>
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>search</span><span class=o>.</span><span class=n>execute</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>hit</span> <span class=ow>in</span> <span class=n>response</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>results</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=n>hit</span><span class=o>.</span><span class=n>meta</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;title&#39;</span><span class=p>:</span> <span class=n>hit</span><span class=o>.</span><span class=n>title</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;description&#39;</span><span class=p>:</span> <span class=n>hit</span><span class=o>.</span><span class=n>description</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;score&#39;</span><span class=p>:</span> <span class=n>hit</span><span class=o>.</span><span class=n>meta</span><span class=o>.</span><span class=n>score</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;genres&#39;</span><span class=p>:</span> <span class=n>hit</span><span class=o>.</span><span class=n>genres</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;year&#39;</span><span class=p>:</span> <span class=n>hit</span><span class=o>.</span><span class=n>release_year</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total&#39;</span><span class=p>:</span> <span class=n>response</span><span class=o>.</span><span class=n>hits</span><span class=o>.</span><span class=n>total</span><span class=o>.</span><span class=n>value</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;results&#39;</span><span class=p>:</span> <span class=n>results</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;took_ms&#39;</span><span class=p>:</span> <span class=n>response</span><span class=o>.</span><span class=n>took</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>suggest_autocomplete</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>prefix</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;자동완성 제안&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>search</span> <span class=o>=</span> <span class=n>Search</span><span class=p>(</span><span class=n>using</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>es</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>index</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>suggest</span> <span class=o>=</span> <span class=n>search</span><span class=o>.</span><span class=n>suggest</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;title_suggest&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>prefix</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>completion</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;field&#39;</span><span class=p>:</span> <span class=s1>&#39;title.suggest&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;size&#39;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;fuzzy&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;fuzziness&#39;</span><span class=p>:</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>suggest</span><span class=o>.</span><span class=n>execute</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>suggestions</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>option</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>suggest</span><span class=o>.</span><span class=n>title_suggest</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>options</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>suggestions</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;text&#39;</span><span class=p>:</span> <span class=n>option</span><span class=o>.</span><span class=n>text</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;score&#39;</span><span class=p>:</span> <span class=n>option</span><span class=o>.</span><span class=n>_score</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>suggestions</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>aggregated_facets</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>query</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;패싯 검색 (필터링 옵션)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>search</span> <span class=o>=</span> <span class=n>Search</span><span class=p>(</span><span class=n>using</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>es</span><span class=p>,</span> <span class=n>index</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>index</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>search</span> <span class=o>=</span> <span class=n>search</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=s1>&#39;multi_match&#39;</span><span class=p>,</span> <span class=n>query</span><span class=o>=</span><span class=n>query</span><span class=p>,</span> <span class=n>fields</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;title&#39;</span><span class=p>,</span> <span class=s1>&#39;description&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 장르별 집계</span>
</span></span><span class=line><span class=cl>        <span class=n>search</span><span class=o>.</span><span class=n>aggs</span><span class=o>.</span><span class=n>bucket</span><span class=p>(</span><span class=s1>&#39;genres&#39;</span><span class=p>,</span> <span class=s1>&#39;terms&#39;</span><span class=p>,</span> <span class=n>field</span><span class=o>=</span><span class=s1>&#39;genres&#39;</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 연도별 집계</span>
</span></span><span class=line><span class=cl>        <span class=n>search</span><span class=o>.</span><span class=n>aggs</span><span class=o>.</span><span class=n>bucket</span><span class=p>(</span><span class=s1>&#39;years&#39;</span><span class=p>,</span> <span class=s1>&#39;histogram&#39;</span><span class=p>,</span> <span class=n>field</span><span class=o>=</span><span class=s1>&#39;release_year&#39;</span><span class=p>,</span> <span class=n>interval</span><span class=o>=</span><span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 평점별 집계</span>
</span></span><span class=line><span class=cl>        <span class=n>search</span><span class=o>.</span><span class=n>aggs</span><span class=o>.</span><span class=n>bucket</span><span class=p>(</span><span class=s1>&#39;ratings&#39;</span><span class=p>,</span> <span class=s1>&#39;range&#39;</span><span class=p>,</span> <span class=n>field</span><span class=o>=</span><span class=s1>&#39;rating&#39;</span><span class=p>,</span> <span class=n>ranges</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s1>&#39;to&#39;</span><span class=p>:</span> <span class=mf>3.0</span><span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s1>&#39;from&#39;</span><span class=p>:</span> <span class=mf>3.0</span><span class=p>,</span> <span class=s1>&#39;to&#39;</span><span class=p>:</span> <span class=mf>4.0</span><span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s1>&#39;from&#39;</span><span class=p>:</span> <span class=mf>4.0</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>response</span> <span class=o>=</span> <span class=n>search</span><span class=o>.</span><span class=n>execute</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>facets</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;genres&#39;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s1>&#39;key&#39;</span><span class=p>:</span> <span class=n>b</span><span class=o>.</span><span class=n>key</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>:</span> <span class=n>b</span><span class=o>.</span><span class=n>doc_count</span><span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>aggregations</span><span class=o>.</span><span class=n>genres</span><span class=o>.</span><span class=n>buckets</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;years&#39;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s1>&#39;key&#39;</span><span class=p>:</span> <span class=n>b</span><span class=o>.</span><span class=n>key</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>:</span> <span class=n>b</span><span class=o>.</span><span class=n>doc_count</span><span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>aggregations</span><span class=o>.</span><span class=n>years</span><span class=o>.</span><span class=n>buckets</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;ratings&#39;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span><span class=s1>&#39;key&#39;</span><span class=p>:</span> <span class=n>b</span><span class=o>.</span><span class=n>key</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>:</span> <span class=n>b</span><span class=o>.</span><span class=n>doc_count</span><span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>b</span> <span class=ow>in</span> <span class=n>response</span><span class=o>.</span><span class=n>aggregations</span><span class=o>.</span><span class=n>ratings</span><span class=o>.</span><span class=n>buckets</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>facets</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>search_engine</span> <span class=o>=</span> <span class=n>NetflixSearchEngine</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. 기본 검색</span>
</span></span><span class=line><span class=cl><span class=n>results</span> <span class=o>=</span> <span class=n>search_engine</span><span class=o>.</span><span class=n>multi_match_search</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>query</span><span class=o>=</span><span class=s2>&#34;stranger things&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>user_id</span><span class=o>=</span><span class=s2>&#34;user123&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>filters</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;genres&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;Sci-Fi&#39;</span><span class=p>,</span> <span class=s1>&#39;Drama&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;year_range&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mi>2015</span><span class=p>,</span> <span class=mi>2024</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;검색 결과: </span><span class=si>{</span><span class=n>results</span><span class=p>[</span><span class=s1>&#39;total&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>개 (</span><span class=si>{</span><span class=n>results</span><span class=p>[</span><span class=s1>&#39;took_ms&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>ms)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>results</span><span class=p>[</span><span class=s1>&#39;results&#39;</span><span class=p>][:</span><span class=mi>5</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - </span><span class=si>{</span><span class=n>item</span><span class=p>[</span><span class=s1>&#39;title&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>item</span><span class=p>[</span><span class=s1>&#39;year&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>) - Score: </span><span class=si>{</span><span class=n>item</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>]</span><span class=si>:</span><span class=s2>.2f</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. 자동완성</span>
</span></span><span class=line><span class=cl><span class=n>suggestions</span> <span class=o>=</span> <span class=n>search_engine</span><span class=o>.</span><span class=n>suggest_autocomplete</span><span class=p>(</span><span class=s2>&#34;stran&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>자동완성 제안:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>sug</span> <span class=ow>in</span> <span class=n>suggestions</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - </span><span class=si>{</span><span class=n>sug</span><span class=p>[</span><span class=s1>&#39;text&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. 패싯 검색</span>
</span></span><span class=line><span class=cl><span class=n>facets</span> <span class=o>=</span> <span class=n>search_engine</span><span class=o>.</span><span class=n>aggregated_facets</span><span class=p>(</span><span class=s2>&#34;action movies&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>장르별 분포:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>genre</span> <span class=ow>in</span> <span class=n>facets</span><span class=p>[</span><span class=s1>&#39;genres&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - </span><span class=si>{</span><span class=n>genre</span><span class=p>[</span><span class=s1>&#39;key&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>genre</span><span class=p>[</span><span class=s1>&#39;count&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>개&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=성과-및-결과-2>성과 및 결과<a hidden class=anchor aria-hidden=true href=#성과-및-결과-2>#</a></h6><p><strong>정량적 성과</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-198-1><a class=lnlinks href=#hl-198-1> 1</a>
</span><span class=lnt id=hl-198-2><a class=lnlinks href=#hl-198-2> 2</a>
</span><span class=lnt id=hl-198-3><a class=lnlinks href=#hl-198-3> 3</a>
</span><span class=lnt id=hl-198-4><a class=lnlinks href=#hl-198-4> 4</a>
</span><span class=lnt id=hl-198-5><a class=lnlinks href=#hl-198-5> 5</a>
</span><span class=lnt id=hl-198-6><a class=lnlinks href=#hl-198-6> 6</a>
</span><span class=lnt id=hl-198-7><a class=lnlinks href=#hl-198-7> 7</a>
</span><span class=lnt id=hl-198-8><a class=lnlinks href=#hl-198-8> 8</a>
</span><span class=lnt id=hl-198-9><a class=lnlinks href=#hl-198-9> 9</a>
</span><span class=lnt id=hl-198-10><a class=lnlinks href=#hl-198-10>10</a>
</span><span class=lnt id=hl-198-11><a class=lnlinks href=#hl-198-11>11</a>
</span><span class=lnt id=hl-198-12><a class=lnlinks href=#hl-198-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>성능 지표:
</span></span><span class=line><span class=cl>├─ 검색 응답 시간: 평균 45ms (P95: 120ms)
</span></span><span class=line><span class=cl>├─ 자동완성 지연: 평균 12ms
</span></span><span class=line><span class=cl>├─ 처리량: 초당 50,000 검색 쿼리
</span></span><span class=line><span class=cl>├─ 인덱스 크기: 200GB (5천만 문서)
</span></span><span class=line><span class=cl>└─ 클러스터: 15 노드 (5 샤드 × 3 복제본)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>비즈니스 임팩트:
</span></span><span class=line><span class=cl>├─ 검색 정확도: 75% → 92% (A/B 테스트)
</span></span><span class=line><span class=cl>├─ 검색 → 시청 전환율: 18% 증가
</span></span><span class=line><span class=cl>├─ 사용자 만족도: 4.2 → 4.7 (5점 만점)
</span></span><span class=line><span class=cl>└─ 검색 이탈률: 32% → 14%
</span></span></code></pre></td></tr></table></div></div><p><strong>기술적 혁신</strong>:</p><ul><li><strong>동의어 처리</strong>: &ldquo;movie"와 &ldquo;film&rdquo; 동일하게 검색</li><li><strong>퍼지 매칭</strong>: 오타 2글자까지 허용</li><li><strong>개인화</strong>: 시청 이력 기반 순위 조정</li><li><strong>다국어</strong>: 50개 언어별 analyzer 구성</li></ul><h6 id=교훈-및-시사점-2>교훈 및 시사점<a hidden class=anchor aria-hidden=true href=#교훈-및-시사점-2>#</a></h6><p><strong>성공 요인</strong>:</p><ol><li><strong>적절한 Analyzer 설계</strong>: 언어별 최적화</li><li><strong>Function Score 활용</strong>: 복합 랭킹 (관련도 + 개인화 + 인기도)</li><li><strong>캐싱 전략</strong>: Redis로 인기 검색어 캐싱 (40% 히트율)</li><li><strong>샤드 크기 최적화</strong>: 샤드당 10GB 유지</li></ol><p><strong>재현 시 유의점</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-199-1><a class=lnlinks href=#hl-199-1> 1</a>
</span><span class=lnt id=hl-199-2><a class=lnlinks href=#hl-199-2> 2</a>
</span><span class=lnt id=hl-199-3><a class=lnlinks href=#hl-199-3> 3</a>
</span><span class=lnt id=hl-199-4><a class=lnlinks href=#hl-199-4> 4</a>
</span><span class=lnt id=hl-199-5><a class=lnlinks href=#hl-199-5> 5</a>
</span><span class=lnt id=hl-199-6><a class=lnlinks href=#hl-199-6> 6</a>
</span><span class=lnt id=hl-199-7><a class=lnlinks href=#hl-199-7> 7</a>
</span><span class=lnt id=hl-199-8><a class=lnlinks href=#hl-199-8> 8</a>
</span><span class=lnt id=hl-199-9><a class=lnlinks href=#hl-199-9> 9</a>
</span><span class=lnt id=hl-199-10><a class=lnlinks href=#hl-199-10>10</a>
</span><span class=lnt id=hl-199-11><a class=lnlinks href=#hl-199-11>11</a>
</span><span class=lnt id=hl-199-12><a class=lnlinks href=#hl-199-12>12</a>
</span><span class=lnt id=hl-199-13><a class=lnlinks href=#hl-199-13>13</a>
</span><span class=lnt id=hl-199-14><a class=lnlinks href=#hl-199-14>14</a>
</span><span class=lnt id=hl-199-15><a class=lnlinks href=#hl-199-15>15</a>
</span><span class=lnt id=hl-199-16><a class=lnlinks href=#hl-199-16>16</a>
</span><span class=lnt id=hl-199-17><a class=lnlinks href=#hl-199-17>17</a>
</span><span class=lnt id=hl-199-18><a class=lnlinks href=#hl-199-18>18</a>
</span><span class=lnt id=hl-199-19><a class=lnlinks href=#hl-199-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 인덱스 설계:
</span></span><span class=line><span class=cl>   - 필드별 가중치 튜닝 (A/B 테스트)
</span></span><span class=line><span class=cl>   - keyword vs text 적절히 선택
</span></span><span class=line><span class=cl>   - nested 타입은 쿼리 복잡도 증가
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 성능 최적화:
</span></span><span class=line><span class=cl>   - Routing으로 쿼리 분산
</span></span><span class=line><span class=cl>   - Filter context 활용 (캐싱됨)
</span></span><span class=line><span class=cl>   - 필요한 필드만 _source에서 반환
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 운영 고려사항:
</span></span><span class=line><span class=cl>   - 재인덱싱 전략 (zero-downtime)
</span></span><span class=line><span class=cl>   - 클러스터 모니터링 (heap 사용률)
</span></span><span class=line><span class=cl>   - 샤드 리밸런싱 자동화
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4. 비용 최적화:
</span></span><span class=line><span class=cl>   - Hot-Warm 아키텍처
</span></span><span class=line><span class=cl>   - 오래된 데이터는 압축 저장
</span></span><span class=line><span class=cl>   - Snapshot으로 백업 (S3)
</span></span></code></pre></td></tr></table></div></div><h5 id=실제-도입-사례-3-github---코드-검색-인덱싱>실제 도입 사례 3: GitHub - 코드 검색 인덱싱<a hidden class=anchor aria-hidden=true href=#실제-도입-사례-3-github---코드-검색-인덱싱>#</a></h5><h6 id=배경-및-도입-이유-3>배경 및 도입 이유<a hidden class=anchor aria-hidden=true href=#배경-및-도입-이유-3>#</a></h6><p><strong>비즈니스 요구사항</strong>:</p><ul><li>2억 개 이상 리포지토리 검색</li><li>정규식, 함수명, 변수명 검색</li><li>코드 변경 실시간 반영</li></ul><p><strong>기술적 과제</strong>:</p><ul><li>대용량 텍스트 파일 인덱싱</li><li>프로그래밍 언어별 토큰화</li><li>증분 업데이트 (git commit 단위)</li></ul><p><strong>선정 이유</strong>:</p><ul><li>Elasticsearch의 Full-Text 검색 한계</li><li>코드 특화 인덱싱 필요</li><li>정규식 지원</li></ul><h6 id=구현-아키텍처-3>구현 아키텍처<a hidden class=anchor aria-hidden=true href=#구현-아키텍처-3>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-200-1><a class=lnlinks href=#hl-200-1> 1</a>
</span><span class=lnt id=hl-200-2><a class=lnlinks href=#hl-200-2> 2</a>
</span><span class=lnt id=hl-200-3><a class=lnlinks href=#hl-200-3> 3</a>
</span><span class=lnt id=hl-200-4><a class=lnlinks href=#hl-200-4> 4</a>
</span><span class=lnt id=hl-200-5><a class=lnlinks href=#hl-200-5> 5</a>
</span><span class=lnt id=hl-200-6><a class=lnlinks href=#hl-200-6> 6</a>
</span><span class=lnt id=hl-200-7><a class=lnlinks href=#hl-200-7> 7</a>
</span><span class=lnt id=hl-200-8><a class=lnlinks href=#hl-200-8> 8</a>
</span><span class=lnt id=hl-200-9><a class=lnlinks href=#hl-200-9> 9</a>
</span><span class=lnt id=hl-200-10><a class=lnlinks href=#hl-200-10>10</a>
</span><span class=lnt id=hl-200-11><a class=lnlinks href=#hl-200-11>11</a>
</span><span class=lnt id=hl-200-12><a class=lnlinks href=#hl-200-12>12</a>
</span><span class=lnt id=hl-200-13><a class=lnlinks href=#hl-200-13>13</a>
</span><span class=lnt id=hl-200-14><a class=lnlinks href=#hl-200-14>14</a>
</span><span class=lnt id=hl-200-15><a class=lnlinks href=#hl-200-15>15</a>
</span><span class=lnt id=hl-200-16><a class=lnlinks href=#hl-200-16>16</a>
</span><span class=lnt id=hl-200-17><a class=lnlinks href=#hl-200-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>GitHub 코드 검색 스택:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. 인덱싱 파이프라인:
</span></span><span class=line><span class=cl>   Git Push → Webhook → Kafka → Indexer
</span></span><span class=line><span class=cl>                                    ↓
</span></span><span class=line><span class=cl>                              Blackbird Index
</span></span><span class=line><span class=cl>                              (Custom Suffix Array)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 쿼리 파이프라인:
</span></span><span class=line><span class=cl>   Search Query → Query Parser → Index Lookup
</span></span><span class=line><span class=cl>                                      ↓
</span></span><span class=line><span class=cl>                                  Ranking → Results
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 저장 계층:
</span></span><span class=line><span class=cl>   - Primary: SSD (Hot data, 최근 6개월)
</span></span><span class=line><span class=cl>   - Secondary: HDD (Warm data, 6개월~2년)
</span></span><span class=line><span class=cl>   - Archive: S3 (Cold data, 2년 이상)
</span></span></code></pre></td></tr></table></div></div><p><strong>Suffix Array 기반 인덱스</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-201-1><a class=lnlinks href=#hl-201-1>  1</a>
</span><span class=lnt id=hl-201-2><a class=lnlinks href=#hl-201-2>  2</a>
</span><span class=lnt id=hl-201-3><a class=lnlinks href=#hl-201-3>  3</a>
</span><span class=lnt id=hl-201-4><a class=lnlinks href=#hl-201-4>  4</a>
</span><span class=lnt id=hl-201-5><a class=lnlinks href=#hl-201-5>  5</a>
</span><span class=lnt id=hl-201-6><a class=lnlinks href=#hl-201-6>  6</a>
</span><span class=lnt id=hl-201-7><a class=lnlinks href=#hl-201-7>  7</a>
</span><span class=lnt id=hl-201-8><a class=lnlinks href=#hl-201-8>  8</a>
</span><span class=lnt id=hl-201-9><a class=lnlinks href=#hl-201-9>  9</a>
</span><span class=lnt id=hl-201-10><a class=lnlinks href=#hl-201-10> 10</a>
</span><span class=lnt id=hl-201-11><a class=lnlinks href=#hl-201-11> 11</a>
</span><span class=lnt id=hl-201-12><a class=lnlinks href=#hl-201-12> 12</a>
</span><span class=lnt id=hl-201-13><a class=lnlinks href=#hl-201-13> 13</a>
</span><span class=lnt id=hl-201-14><a class=lnlinks href=#hl-201-14> 14</a>
</span><span class=lnt id=hl-201-15><a class=lnlinks href=#hl-201-15> 15</a>
</span><span class=lnt id=hl-201-16><a class=lnlinks href=#hl-201-16> 16</a>
</span><span class=lnt id=hl-201-17><a class=lnlinks href=#hl-201-17> 17</a>
</span><span class=lnt id=hl-201-18><a class=lnlinks href=#hl-201-18> 18</a>
</span><span class=lnt id=hl-201-19><a class=lnlinks href=#hl-201-19> 19</a>
</span><span class=lnt id=hl-201-20><a class=lnlinks href=#hl-201-20> 20</a>
</span><span class=lnt id=hl-201-21><a class=lnlinks href=#hl-201-21> 21</a>
</span><span class=lnt id=hl-201-22><a class=lnlinks href=#hl-201-22> 22</a>
</span><span class=lnt id=hl-201-23><a class=lnlinks href=#hl-201-23> 23</a>
</span><span class=lnt id=hl-201-24><a class=lnlinks href=#hl-201-24> 24</a>
</span><span class=lnt id=hl-201-25><a class=lnlinks href=#hl-201-25> 25</a>
</span><span class=lnt id=hl-201-26><a class=lnlinks href=#hl-201-26> 26</a>
</span><span class=lnt id=hl-201-27><a class=lnlinks href=#hl-201-27> 27</a>
</span><span class=lnt id=hl-201-28><a class=lnlinks href=#hl-201-28> 28</a>
</span><span class=lnt id=hl-201-29><a class=lnlinks href=#hl-201-29> 29</a>
</span><span class=lnt id=hl-201-30><a class=lnlinks href=#hl-201-30> 30</a>
</span><span class=lnt id=hl-201-31><a class=lnlinks href=#hl-201-31> 31</a>
</span><span class=lnt id=hl-201-32><a class=lnlinks href=#hl-201-32> 32</a>
</span><span class=lnt id=hl-201-33><a class=lnlinks href=#hl-201-33> 33</a>
</span><span class=lnt id=hl-201-34><a class=lnlinks href=#hl-201-34> 34</a>
</span><span class=lnt id=hl-201-35><a class=lnlinks href=#hl-201-35> 35</a>
</span><span class=lnt id=hl-201-36><a class=lnlinks href=#hl-201-36> 36</a>
</span><span class=lnt id=hl-201-37><a class=lnlinks href=#hl-201-37> 37</a>
</span><span class=lnt id=hl-201-38><a class=lnlinks href=#hl-201-38> 38</a>
</span><span class=lnt id=hl-201-39><a class=lnlinks href=#hl-201-39> 39</a>
</span><span class=lnt id=hl-201-40><a class=lnlinks href=#hl-201-40> 40</a>
</span><span class=lnt id=hl-201-41><a class=lnlinks href=#hl-201-41> 41</a>
</span><span class=lnt id=hl-201-42><a class=lnlinks href=#hl-201-42> 42</a>
</span><span class=lnt id=hl-201-43><a class=lnlinks href=#hl-201-43> 43</a>
</span><span class=lnt id=hl-201-44><a class=lnlinks href=#hl-201-44> 44</a>
</span><span class=lnt id=hl-201-45><a class=lnlinks href=#hl-201-45> 45</a>
</span><span class=lnt id=hl-201-46><a class=lnlinks href=#hl-201-46> 46</a>
</span><span class=lnt id=hl-201-47><a class=lnlinks href=#hl-201-47> 47</a>
</span><span class=lnt id=hl-201-48><a class=lnlinks href=#hl-201-48> 48</a>
</span><span class=lnt id=hl-201-49><a class=lnlinks href=#hl-201-49> 49</a>
</span><span class=lnt id=hl-201-50><a class=lnlinks href=#hl-201-50> 50</a>
</span><span class=lnt id=hl-201-51><a class=lnlinks href=#hl-201-51> 51</a>
</span><span class=lnt id=hl-201-52><a class=lnlinks href=#hl-201-52> 52</a>
</span><span class=lnt id=hl-201-53><a class=lnlinks href=#hl-201-53> 53</a>
</span><span class=lnt id=hl-201-54><a class=lnlinks href=#hl-201-54> 54</a>
</span><span class=lnt id=hl-201-55><a class=lnlinks href=#hl-201-55> 55</a>
</span><span class=lnt id=hl-201-56><a class=lnlinks href=#hl-201-56> 56</a>
</span><span class=lnt id=hl-201-57><a class=lnlinks href=#hl-201-57> 57</a>
</span><span class=lnt id=hl-201-58><a class=lnlinks href=#hl-201-58> 58</a>
</span><span class=lnt id=hl-201-59><a class=lnlinks href=#hl-201-59> 59</a>
</span><span class=lnt id=hl-201-60><a class=lnlinks href=#hl-201-60> 60</a>
</span><span class=lnt id=hl-201-61><a class=lnlinks href=#hl-201-61> 61</a>
</span><span class=lnt id=hl-201-62><a class=lnlinks href=#hl-201-62> 62</a>
</span><span class=lnt id=hl-201-63><a class=lnlinks href=#hl-201-63> 63</a>
</span><span class=lnt id=hl-201-64><a class=lnlinks href=#hl-201-64> 64</a>
</span><span class=lnt id=hl-201-65><a class=lnlinks href=#hl-201-65> 65</a>
</span><span class=lnt id=hl-201-66><a class=lnlinks href=#hl-201-66> 66</a>
</span><span class=lnt id=hl-201-67><a class=lnlinks href=#hl-201-67> 67</a>
</span><span class=lnt id=hl-201-68><a class=lnlinks href=#hl-201-68> 68</a>
</span><span class=lnt id=hl-201-69><a class=lnlinks href=#hl-201-69> 69</a>
</span><span class=lnt id=hl-201-70><a class=lnlinks href=#hl-201-70> 70</a>
</span><span class=lnt id=hl-201-71><a class=lnlinks href=#hl-201-71> 71</a>
</span><span class=lnt id=hl-201-72><a class=lnlinks href=#hl-201-72> 72</a>
</span><span class=lnt id=hl-201-73><a class=lnlinks href=#hl-201-73> 73</a>
</span><span class=lnt id=hl-201-74><a class=lnlinks href=#hl-201-74> 74</a>
</span><span class=lnt id=hl-201-75><a class=lnlinks href=#hl-201-75> 75</a>
</span><span class=lnt id=hl-201-76><a class=lnlinks href=#hl-201-76> 76</a>
</span><span class=lnt id=hl-201-77><a class=lnlinks href=#hl-201-77> 77</a>
</span><span class=lnt id=hl-201-78><a class=lnlinks href=#hl-201-78> 78</a>
</span><span class=lnt id=hl-201-79><a class=lnlinks href=#hl-201-79> 79</a>
</span><span class=lnt id=hl-201-80><a class=lnlinks href=#hl-201-80> 80</a>
</span><span class=lnt id=hl-201-81><a class=lnlinks href=#hl-201-81> 81</a>
</span><span class=lnt id=hl-201-82><a class=lnlinks href=#hl-201-82> 82</a>
</span><span class=lnt id=hl-201-83><a class=lnlinks href=#hl-201-83> 83</a>
</span><span class=lnt id=hl-201-84><a class=lnlinks href=#hl-201-84> 84</a>
</span><span class=lnt id=hl-201-85><a class=lnlinks href=#hl-201-85> 85</a>
</span><span class=lnt id=hl-201-86><a class=lnlinks href=#hl-201-86> 86</a>
</span><span class=lnt id=hl-201-87><a class=lnlinks href=#hl-201-87> 87</a>
</span><span class=lnt id=hl-201-88><a class=lnlinks href=#hl-201-88> 88</a>
</span><span class=lnt id=hl-201-89><a class=lnlinks href=#hl-201-89> 89</a>
</span><span class=lnt id=hl-201-90><a class=lnlinks href=#hl-201-90> 90</a>
</span><span class=lnt id=hl-201-91><a class=lnlinks href=#hl-201-91> 91</a>
</span><span class=lnt id=hl-201-92><a class=lnlinks href=#hl-201-92> 92</a>
</span><span class=lnt id=hl-201-93><a class=lnlinks href=#hl-201-93> 93</a>
</span><span class=lnt id=hl-201-94><a class=lnlinks href=#hl-201-94> 94</a>
</span><span class=lnt id=hl-201-95><a class=lnlinks href=#hl-201-95> 95</a>
</span><span class=lnt id=hl-201-96><a class=lnlinks href=#hl-201-96> 96</a>
</span><span class=lnt id=hl-201-97><a class=lnlinks href=#hl-201-97> 97</a>
</span><span class=lnt id=hl-201-98><a class=lnlinks href=#hl-201-98> 98</a>
</span><span class=lnt id=hl-201-99><a class=lnlinks href=#hl-201-99> 99</a>
</span><span class=lnt id=hl-201-100><a class=lnlinks href=#hl-201-100>100</a>
</span><span class=lnt id=hl-201-101><a class=lnlinks href=#hl-201-101>101</a>
</span><span class=lnt id=hl-201-102><a class=lnlinks href=#hl-201-102>102</a>
</span><span class=lnt id=hl-201-103><a class=lnlinks href=#hl-201-103>103</a>
</span><span class=lnt id=hl-201-104><a class=lnlinks href=#hl-201-104>104</a>
</span><span class=lnt id=hl-201-105><a class=lnlinks href=#hl-201-105>105</a>
</span><span class=lnt id=hl-201-106><a class=lnlinks href=#hl-201-106>106</a>
</span><span class=lnt id=hl-201-107><a class=lnlinks href=#hl-201-107>107</a>
</span><span class=lnt id=hl-201-108><a class=lnlinks href=#hl-201-108>108</a>
</span><span class=lnt id=hl-201-109><a class=lnlinks href=#hl-201-109>109</a>
</span><span class=lnt id=hl-201-110><a class=lnlinks href=#hl-201-110>110</a>
</span><span class=lnt id=hl-201-111><a class=lnlinks href=#hl-201-111>111</a>
</span><span class=lnt id=hl-201-112><a class=lnlinks href=#hl-201-112>112</a>
</span><span class=lnt id=hl-201-113><a class=lnlinks href=#hl-201-113>113</a>
</span><span class=lnt id=hl-201-114><a class=lnlinks href=#hl-201-114>114</a>
</span><span class=lnt id=hl-201-115><a class=lnlinks href=#hl-201-115>115</a>
</span><span class=lnt id=hl-201-116><a class=lnlinks href=#hl-201-116>116</a>
</span><span class=lnt id=hl-201-117><a class=lnlinks href=#hl-201-117>117</a>
</span><span class=lnt id=hl-201-118><a class=lnlinks href=#hl-201-118>118</a>
</span><span class=lnt id=hl-201-119><a class=lnlinks href=#hl-201-119>119</a>
</span><span class=lnt id=hl-201-120><a class=lnlinks href=#hl-201-120>120</a>
</span><span class=lnt id=hl-201-121><a class=lnlinks href=#hl-201-121>121</a>
</span><span class=lnt id=hl-201-122><a class=lnlinks href=#hl-201-122>122</a>
</span><span class=lnt id=hl-201-123><a class=lnlinks href=#hl-201-123>123</a>
</span><span class=lnt id=hl-201-124><a class=lnlinks href=#hl-201-124>124</a>
</span><span class=lnt id=hl-201-125><a class=lnlinks href=#hl-201-125>125</a>
</span><span class=lnt id=hl-201-126><a class=lnlinks href=#hl-201-126>126</a>
</span><span class=lnt id=hl-201-127><a class=lnlinks href=#hl-201-127>127</a>
</span><span class=lnt id=hl-201-128><a class=lnlinks href=#hl-201-128>128</a>
</span><span class=lnt id=hl-201-129><a class=lnlinks href=#hl-201-129>129</a>
</span><span class=lnt id=hl-201-130><a class=lnlinks href=#hl-201-130>130</a>
</span><span class=lnt id=hl-201-131><a class=lnlinks href=#hl-201-131>131</a>
</span><span class=lnt id=hl-201-132><a class=lnlinks href=#hl-201-132>132</a>
</span><span class=lnt id=hl-201-133><a class=lnlinks href=#hl-201-133>133</a>
</span><span class=lnt id=hl-201-134><a class=lnlinks href=#hl-201-134>134</a>
</span><span class=lnt id=hl-201-135><a class=lnlinks href=#hl-201-135>135</a>
</span><span class=lnt id=hl-201-136><a class=lnlinks href=#hl-201-136>136</a>
</span><span class=lnt id=hl-201-137><a class=lnlinks href=#hl-201-137>137</a>
</span><span class=lnt id=hl-201-138><a class=lnlinks href=#hl-201-138>138</a>
</span><span class=lnt id=hl-201-139><a class=lnlinks href=#hl-201-139>139</a>
</span><span class=lnt id=hl-201-140><a class=lnlinks href=#hl-201-140>140</a>
</span><span class=lnt id=hl-201-141><a class=lnlinks href=#hl-201-141>141</a>
</span><span class=lnt id=hl-201-142><a class=lnlinks href=#hl-201-142>142</a>
</span><span class=lnt id=hl-201-143><a class=lnlinks href=#hl-201-143>143</a>
</span><span class=lnt id=hl-201-144><a class=lnlinks href=#hl-201-144>144</a>
</span><span class=lnt id=hl-201-145><a class=lnlinks href=#hl-201-145>145</a>
</span><span class=lnt id=hl-201-146><a class=lnlinks href=#hl-201-146>146</a>
</span><span class=lnt id=hl-201-147><a class=lnlinks href=#hl-201-147>147</a>
</span><span class=lnt id=hl-201-148><a class=lnlinks href=#hl-201-148>148</a>
</span><span class=lnt id=hl-201-149><a class=lnlinks href=#hl-201-149>149</a>
</span><span class=lnt id=hl-201-150><a class=lnlinks href=#hl-201-150>150</a>
</span><span class=lnt id=hl-201-151><a class=lnlinks href=#hl-201-151>151</a>
</span><span class=lnt id=hl-201-152><a class=lnlinks href=#hl-201-152>152</a>
</span><span class=lnt id=hl-201-153><a class=lnlinks href=#hl-201-153>153</a>
</span><span class=lnt id=hl-201-154><a class=lnlinks href=#hl-201-154>154</a>
</span><span class=lnt id=hl-201-155><a class=lnlinks href=#hl-201-155>155</a>
</span><span class=lnt id=hl-201-156><a class=lnlinks href=#hl-201-156>156</a>
</span><span class=lnt id=hl-201-157><a class=lnlinks href=#hl-201-157>157</a>
</span><span class=lnt id=hl-201-158><a class=lnlinks href=#hl-201-158>158</a>
</span><span class=lnt id=hl-201-159><a class=lnlinks href=#hl-201-159>159</a>
</span><span class=lnt id=hl-201-160><a class=lnlinks href=#hl-201-160>160</a>
</span><span class=lnt id=hl-201-161><a class=lnlinks href=#hl-201-161>161</a>
</span><span class=lnt id=hl-201-162><a class=lnlinks href=#hl-201-162>162</a>
</span><span class=lnt id=hl-201-163><a class=lnlinks href=#hl-201-163>163</a>
</span><span class=lnt id=hl-201-164><a class=lnlinks href=#hl-201-164>164</a>
</span><span class=lnt id=hl-201-165><a class=lnlinks href=#hl-201-165>165</a>
</span><span class=lnt id=hl-201-166><a class=lnlinks href=#hl-201-166>166</a>
</span><span class=lnt id=hl-201-167><a class=lnlinks href=#hl-201-167>167</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>BlackbirdIndex</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;GitHub의 Suffix Array 기반 코드 인덱스 (단순화)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>suffix_array</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># 접미사 배열</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>lcp_array</span> <span class=o>=</span> <span class=p>[]</span>     <span class=c1># Longest Common Prefix</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>text</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>          <span class=c1># 전체 코드 텍스트</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>doc_boundaries</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># 문서 경계</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>build_index</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>documents</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;문서 집합으로부터 인덱스 구축&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. 모든 문서 연결 (구분자로)</span>
</span></span><span class=line><span class=cl>        <span class=n>separator</span> <span class=o>=</span> <span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span>  <span class=c1># NULL 문자</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>text</span> <span class=o>=</span> <span class=n>separator</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>doc</span><span class=p>[</span><span class=s1>&#39;content&#39;</span><span class=p>]</span> <span class=k>for</span> <span class=n>doc</span> <span class=ow>in</span> <span class=n>documents</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. 문서 경계 기록</span>
</span></span><span class=line><span class=cl>        <span class=n>pos</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>doc</span> <span class=ow>in</span> <span class=n>documents</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>doc_boundaries</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;start&#39;</span><span class=p>:</span> <span class=n>pos</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;end&#39;</span><span class=p>:</span> <span class=n>pos</span> <span class=o>+</span> <span class=nb>len</span><span class=p>(</span><span class=n>doc</span><span class=p>[</span><span class=s1>&#39;content&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;repo&#39;</span><span class=p>:</span> <span class=n>doc</span><span class=p>[</span><span class=s1>&#39;repo&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=n>doc</span><span class=p>[</span><span class=s1>&#39;path&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>            <span class=n>pos</span> <span class=o>+=</span> <span class=nb>len</span><span class=p>(</span><span class=n>doc</span><span class=p>[</span><span class=s1>&#39;content&#39;</span><span class=p>])</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. Suffix Array 구축</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>suffix_array</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>            <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>i</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>text</span><span class=p>[</span><span class=n>i</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 4. LCP Array 구축 (쿼리 최적화용)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_build_lcp_array</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_build_lcp_array</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;LCP 배열 구축 (Kasai 알고리즘)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>rank</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>suffix_idx</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>suffix_array</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>rank</span><span class=p>[</span><span class=n>suffix_idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>lcp_array</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>        <span class=n>h</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>rank</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>j</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>suffix_array</span><span class=p>[</span><span class=n>rank</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=k>while</span> <span class=n>i</span> <span class=o>+</span> <span class=n>h</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=ow>and</span> <span class=n>j</span> <span class=o>+</span> <span class=n>h</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=ow>and</span> <span class=bp>self</span><span class=o>.</span><span class=n>text</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=n>h</span><span class=p>]</span> <span class=o>==</span> <span class=bp>self</span><span class=o>.</span><span class=n>text</span><span class=p>[</span><span class=n>j</span> <span class=o>+</span> <span class=n>h</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=n>h</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>lcp_array</span><span class=p>[</span><span class=n>rank</span><span class=p>[</span><span class=n>i</span><span class=p>]]</span> <span class=o>=</span> <span class=n>h</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>h</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>h</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>pattern</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;패턴 검색 (이진 탐색)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 패턴으로 시작하는 첫 번째/마지막 위치 찾기</span>
</span></span><span class=line><span class=cl>        <span class=n>left</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_lower_bound</span><span class=p>(</span><span class=n>pattern</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>right</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_upper_bound</span><span class=p>(</span><span class=n>pattern</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>left</span> <span class=o>&gt;=</span> <span class=n>right</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 매칭 위치들</span>
</span></span><span class=line><span class=cl>        <span class=n>matches</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>left</span><span class=p>,</span> <span class=n>right</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>pos</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>suffix_array</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>doc</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_find_document</span><span class=p>(</span><span class=n>pos</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>doc</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>matches</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;repo&#39;</span><span class=p>:</span> <span class=n>doc</span><span class=p>[</span><span class=s1>&#39;repo&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=n>doc</span><span class=p>[</span><span class=s1>&#39;path&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;line&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_line_number</span><span class=p>(</span><span class=n>pos</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;snippet&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_extract_snippet</span><span class=p>(</span><span class=n>pos</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>pattern</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>matches</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_lower_bound</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>pattern</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;패턴 이상인 첫 위치 (이진 탐색)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>left</span><span class=p>,</span> <span class=n>right</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>suffix_array</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>left</span> <span class=o>&lt;</span> <span class=n>right</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mid</span> <span class=o>=</span> <span class=p>(</span><span class=n>left</span> <span class=o>+</span> <span class=n>right</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=n>suffix</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>text</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>suffix_array</span><span class=p>[</span><span class=n>mid</span><span class=p>]:]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>suffix</span> <span class=o>&lt;</span> <span class=n>pattern</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>left</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>right</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>left</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_upper_bound</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>pattern</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;패턴 초과인 첫 위치&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>left</span><span class=p>,</span> <span class=n>right</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>suffix_array</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=n>left</span> <span class=o>&lt;</span> <span class=n>right</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mid</span> <span class=o>=</span> <span class=p>(</span><span class=n>left</span> <span class=o>+</span> <span class=n>right</span><span class=p>)</span> <span class=o>//</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>            <span class=n>suffix</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>text</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>suffix_array</span><span class=p>[</span><span class=n>mid</span><span class=p>]:]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>suffix</span><span class=p>[:</span><span class=nb>len</span><span class=p>(</span><span class=n>pattern</span><span class=p>)]</span> <span class=o>&lt;=</span> <span class=n>pattern</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>left</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>right</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>left</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_find_document</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>pos</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;위치로부터 문서 찾기&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>doc</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>doc_boundaries</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>doc</span><span class=p>[</span><span class=s1>&#39;start&#39;</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>pos</span> <span class=o>&lt;</span> <span class=n>doc</span><span class=p>[</span><span class=s1>&#39;end&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>doc</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_get_line_number</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>pos</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;위치의 라인 번호&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>text</span><span class=p>[:</span><span class=n>pos</span><span class=p>]</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_extract_snippet</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>pos</span><span class=p>,</span> <span class=n>length</span><span class=p>,</span> <span class=n>context</span><span class=o>=</span><span class=mi>50</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;코드 스니펫 추출&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>start</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>pos</span> <span class=o>-</span> <span class=n>context</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>end</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>text</span><span class=p>),</span> <span class=n>pos</span> <span class=o>+</span> <span class=n>length</span> <span class=o>+</span> <span class=n>context</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>text</span><span class=p>[</span><span class=n>start</span><span class=p>:</span><span class=n>end</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>index</span> <span class=o>=</span> <span class=n>BlackbirdIndex</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 인덱스 구축</span>
</span></span><span class=line><span class=cl><span class=n>documents</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;repo&#39;</span><span class=p>:</span> <span class=s1>&#39;torvalds/linux&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=s1>&#39;kernel/sched/core.c&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;content&#39;</span><span class=p>:</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>void schedule(void) {
</span></span></span><span class=line><span class=cl><span class=s1>    struct task_struct *prev, *next;
</span></span></span><span class=line><span class=cl><span class=s1>    prev = current;
</span></span></span><span class=line><span class=cl><span class=s1>    next = pick_next_task(rq);
</span></span></span><span class=line><span class=cl><span class=s1>    context_switch(prev, next);
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;repo&#39;</span><span class=p>:</span> <span class=s1>&#39;torvalds/linux&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;path&#39;</span><span class=p>:</span> <span class=s1>&#39;kernel/fork.c&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;content&#39;</span><span class=p>:</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>long do_fork(unsigned long clone_flags) {
</span></span></span><span class=line><span class=cl><span class=s1>    struct task_struct *p;
</span></span></span><span class=line><span class=cl><span class=s1>    p = copy_process(clone_flags);
</span></span></span><span class=line><span class=cl><span class=s1>    wake_up_new_task(p);
</span></span></span><span class=line><span class=cl><span class=s1>    return p-&gt;pid;
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>index</span><span class=o>.</span><span class=n>build_index</span><span class=p>(</span><span class=n>documents</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 함수명 검색</span>
</span></span><span class=line><span class=cl><span class=n>results</span> <span class=o>=</span> <span class=n>index</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s2>&#34;schedule&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;&#39;</span><span class=si>{</span><span class=n>pattern</span><span class=si>}</span><span class=s2>&#39; 검색 결과: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>results</span><span class=p>)</span><span class=si>}</span><span class=s2>개&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=k>match</span> <span class=ow>in</span> <span class=n>results</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=si>{</span><span class=n>match</span><span class=p>[</span><span class=s1>&#39;repo&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>match</span><span class=p>[</span><span class=s1>&#39;path&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> (line </span><span class=si>{</span><span class=n>match</span><span class=p>[</span><span class=s1>&#39;line&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  </span><span class=si>{</span><span class=n>match</span><span class=p>[</span><span class=s1>&#39;snippet&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=성과-및-결과-3>성과 및 결과<a hidden class=anchor aria-hidden=true href=#성과-및-결과-3>#</a></h6><p><strong>정량적 성과</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-202-1><a class=lnlinks href=#hl-202-1> 1</a>
</span><span class=lnt id=hl-202-2><a class=lnlinks href=#hl-202-2> 2</a>
</span><span class=lnt id=hl-202-3><a class=lnlinks href=#hl-202-3> 3</a>
</span><span class=lnt id=hl-202-4><a class=lnlinks href=#hl-202-4> 4</a>
</span><span class=lnt id=hl-202-5><a class=lnlinks href=#hl-202-5> 5</a>
</span><span class=lnt id=hl-202-6><a class=lnlinks href=#hl-202-6> 6</a>
</span><span class=lnt id=hl-202-7><a class=lnlinks href=#hl-202-7> 7</a>
</span><span class=lnt id=hl-202-8><a class=lnlinks href=#hl-202-8> 8</a>
</span><span class=lnt id=hl-202-9><a class=lnlinks href=#hl-202-9> 9</a>
</span><span class=lnt id=hl-202-10><a class=lnlinks href=#hl-202-10>10</a>
</span><span class=lnt id=hl-202-11><a class=lnlinks href=#hl-202-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>인덱스 통계:
</span></span><span class=line><span class=cl>├─ 인덱싱 속도: 초당 10,000 파일
</span></span><span class=line><span class=cl>├─ 인덱스 크기: 원본의 30% (압축)
</span></span><span class=line><span class=cl>├─ 검색 지연: P50 80ms, P99 300ms
</span></span><span class=line><span class=cl>└─ 처리량: 초당 50,000 쿼리
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>확장성:
</span></span><span class=line><span class=cl>├─ 리포지토리: 2억 개
</span></span><span class=line><span class=cl>├─ 파일: 100억 개
</span></span><span class=line><span class=cl>├─ 코드 라인: 1조 라인
</span></span><span class=line><span class=cl>└─ 인덱스 클러스터: 1000+ 노드
</span></span></code></pre></td></tr></table></div></div><p><strong>기술적 혁신</strong>:</p><ul><li>Suffix Array로 정규식 지원</li><li>증분 업데이트 (git diff 기반)</li><li>언어별 토큰화 (150+ 언어)</li><li>Bloom Filter로 False Positive 감소</li></ul><h6 id=교훈-및-시사점-3>교훈 및 시사점<a hidden class=anchor aria-hidden=true href=#교훈-및-시사점-3>#</a></h6><p><strong>재현 가이드</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-203-1><a class=lnlinks href=#hl-203-1> 1</a>
</span><span class=lnt id=hl-203-2><a class=lnlinks href=#hl-203-2> 2</a>
</span><span class=lnt id=hl-203-3><a class=lnlinks href=#hl-203-3> 3</a>
</span><span class=lnt id=hl-203-4><a class=lnlinks href=#hl-203-4> 4</a>
</span><span class=lnt id=hl-203-5><a class=lnlinks href=#hl-203-5> 5</a>
</span><span class=lnt id=hl-203-6><a class=lnlinks href=#hl-203-6> 6</a>
</span><span class=lnt id=hl-203-7><a class=lnlinks href=#hl-203-7> 7</a>
</span><span class=lnt id=hl-203-8><a class=lnlinks href=#hl-203-8> 8</a>
</span><span class=lnt id=hl-203-9><a class=lnlinks href=#hl-203-9> 9</a>
</span><span class=lnt id=hl-203-10><a class=lnlinks href=#hl-203-10>10</a>
</span><span class=lnt id=hl-203-11><a class=lnlinks href=#hl-203-11>11</a>
</span><span class=lnt id=hl-203-12><a class=lnlinks href=#hl-203-12>12</a>
</span><span class=lnt id=hl-203-13><a class=lnlinks href=#hl-203-13>13</a>
</span><span class=lnt id=hl-203-14><a class=lnlinks href=#hl-203-14>14</a>
</span><span class=lnt id=hl-203-15><a class=lnlinks href=#hl-203-15>15</a>
</span><span class=lnt id=hl-203-16><a class=lnlinks href=#hl-203-16>16</a>
</span><span class=lnt id=hl-203-17><a class=lnlinks href=#hl-203-17>17</a>
</span><span class=lnt id=hl-203-18><a class=lnlinks href=#hl-203-18>18</a>
</span><span class=lnt id=hl-203-19><a class=lnlinks href=#hl-203-19>19</a>
</span><span class=lnt id=hl-203-20><a class=lnlinks href=#hl-203-20>20</a>
</span><span class=lnt id=hl-203-21><a class=lnlinks href=#hl-203-21>21</a>
</span><span class=lnt id=hl-203-22><a class=lnlinks href=#hl-203-22>22</a>
</span><span class=lnt id=hl-203-23><a class=lnlinks href=#hl-203-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. Suffix Array vs Inverted Index:
</span></span><span class=line><span class=cl>   장점:
</span></span><span class=line><span class=cl>   - 정규식 지원
</span></span><span class=line><span class=cl>   - 부분 문자열 검색
</span></span><span class=line><span class=cl>   - 메모리 효율
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   단점:
</span></span><span class=line><span class=cl>   - 구축 시간 길음 O(n log n)
</span></span><span class=line><span class=cl>   - 순위화 어려움
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   선택 기준:
</span></span><span class=line><span class=cl>   - 정규식 필요 → Suffix Array
</span></span><span class=line><span class=cl>   - 일반 텍스트 → Inverted Index
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 코드 특화 최적화:
</span></span><span class=line><span class=cl>   - 식별자 추출 (함수명, 변수명)
</span></span><span class=line><span class=cl>   - 주석 제거 옵션
</span></span><span class=line><span class=cl>   - 공백 정규화
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>3. 운영 전략:
</span></span><span class=line><span class=cl>   - 증분 업데이트 (merge 시)
</span></span><span class=line><span class=cl>   - 샤딩: 리포지토리 단위
</span></span><span class=line><span class=cl>   - 캐싱: 인기 리포지토리
</span></span></code></pre></td></tr></table></div></div><p>계속해서 5.3절로 진행하겠습니다.</p><hr><h4 id=53-통합-및-연계-기술-1>5.3 통합 및 연계 기술<a hidden class=anchor aria-hidden=true href=#53-통합-및-연계-기술-1>#</a></h4><p><strong>데이터베이스 샤딩과 인덱스 통합</strong></p><p><strong>왜 통합하는가</strong>:</p><ul><li>단일 데이터베이스의 용량/성능 한계 극복</li><li>수평 확장으로 선형적 성능 향상</li><li>지리적 분산으로 지연 시간 최소화</li></ul><p><strong>무엇을 통합하는가</strong>:</p><ul><li>샤딩 키와 인덱스 키의 조합</li><li>로컬 인덱스 vs 글로벌 인덱스 선택</li><li>쿼리 라우팅 메커니즘</li></ul><p><strong>어떻게 통합하는가</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-204-1><a class=lnlinks href=#hl-204-1> 1</a>
</span><span class=lnt id=hl-204-2><a class=lnlinks href=#hl-204-2> 2</a>
</span><span class=lnt id=hl-204-3><a class=lnlinks href=#hl-204-3> 3</a>
</span><span class=lnt id=hl-204-4><a class=lnlinks href=#hl-204-4> 4</a>
</span><span class=lnt id=hl-204-5><a class=lnlinks href=#hl-204-5> 5</a>
</span><span class=lnt id=hl-204-6><a class=lnlinks href=#hl-204-6> 6</a>
</span><span class=lnt id=hl-204-7><a class=lnlinks href=#hl-204-7> 7</a>
</span><span class=lnt id=hl-204-8><a class=lnlinks href=#hl-204-8> 8</a>
</span><span class=lnt id=hl-204-9><a class=lnlinks href=#hl-204-9> 9</a>
</span><span class=lnt id=hl-204-10><a class=lnlinks href=#hl-204-10>10</a>
</span><span class=lnt id=hl-204-11><a class=lnlinks href=#hl-204-11>11</a>
</span><span class=lnt id=hl-204-12><a class=lnlinks href=#hl-204-12>12</a>
</span><span class=lnt id=hl-204-13><a class=lnlinks href=#hl-204-13>13</a>
</span><span class=lnt id=hl-204-14><a class=lnlinks href=#hl-204-14>14</a>
</span><span class=lnt id=hl-204-15><a class=lnlinks href=#hl-204-15>15</a>
</span><span class=lnt id=hl-204-16><a class=lnlinks href=#hl-204-16>16</a>
</span><span class=lnt id=hl-204-17><a class=lnlinks href=#hl-204-17>17</a>
</span><span class=lnt id=hl-204-18><a class=lnlinks href=#hl-204-18>18</a>
</span><span class=lnt id=hl-204-19><a class=lnlinks href=#hl-204-19>19</a>
</span><span class=lnt id=hl-204-20><a class=lnlinks href=#hl-204-20>20</a>
</span><span class=lnt id=hl-204-21><a class=lnlinks href=#hl-204-21>21</a>
</span><span class=lnt id=hl-204-22><a class=lnlinks href=#hl-204-22>22</a>
</span><span class=lnt id=hl-204-23><a class=lnlinks href=#hl-204-23>23</a>
</span><span class=lnt id=hl-204-24><a class=lnlinks href=#hl-204-24>24</a>
</span><span class=lnt id=hl-204-25><a class=lnlinks href=#hl-204-25>25</a>
</span><span class=lnt id=hl-204-26><a class=lnlinks href=#hl-204-26>26</a>
</span><span class=lnt id=hl-204-27><a class=lnlinks href=#hl-204-27>27</a>
</span><span class=lnt id=hl-204-28><a class=lnlinks href=#hl-204-28>28</a>
</span><span class=lnt id=hl-204-29><a class=lnlinks href=#hl-204-29>29</a>
</span><span class=lnt id=hl-204-30><a class=lnlinks href=#hl-204-30>30</a>
</span><span class=lnt id=hl-204-31><a class=lnlinks href=#hl-204-31>31</a>
</span><span class=lnt id=hl-204-32><a class=lnlinks href=#hl-204-32>32</a>
</span><span class=lnt id=hl-204-33><a class=lnlinks href=#hl-204-33>33</a>
</span><span class=lnt id=hl-204-34><a class=lnlinks href=#hl-204-34>34</a>
</span><span class=lnt id=hl-204-35><a class=lnlinks href=#hl-204-35>35</a>
</span><span class=lnt id=hl-204-36><a class=lnlinks href=#hl-204-36>36</a>
</span><span class=lnt id=hl-204-37><a class=lnlinks href=#hl-204-37>37</a>
</span><span class=lnt id=hl-204-38><a class=lnlinks href=#hl-204-38>38</a>
</span><span class=lnt id=hl-204-39><a class=lnlinks href=#hl-204-39>39</a>
</span><span class=lnt id=hl-204-40><a class=lnlinks href=#hl-204-40>40</a>
</span><span class=lnt id=hl-204-41><a class=lnlinks href=#hl-204-41>41</a>
</span><span class=lnt id=hl-204-42><a class=lnlinks href=#hl-204-42>42</a>
</span><span class=lnt id=hl-204-43><a class=lnlinks href=#hl-204-43>43</a>
</span><span class=lnt id=hl-204-44><a class=lnlinks href=#hl-204-44>44</a>
</span><span class=lnt id=hl-204-45><a class=lnlinks href=#hl-204-45>45</a>
</span><span class=lnt id=hl-204-46><a class=lnlinks href=#hl-204-46>46</a>
</span><span class=lnt id=hl-204-47><a class=lnlinks href=#hl-204-47>47</a>
</span><span class=lnt id=hl-204-48><a class=lnlinks href=#hl-204-48>48</a>
</span><span class=lnt id=hl-204-49><a class=lnlinks href=#hl-204-49>49</a>
</span><span class=lnt id=hl-204-50><a class=lnlinks href=#hl-204-50>50</a>
</span><span class=lnt id=hl-204-51><a class=lnlinks href=#hl-204-51>51</a>
</span><span class=lnt id=hl-204-52><a class=lnlinks href=#hl-204-52>52</a>
</span><span class=lnt id=hl-204-53><a class=lnlinks href=#hl-204-53>53</a>
</span><span class=lnt id=hl-204-54><a class=lnlinks href=#hl-204-54>54</a>
</span><span class=lnt id=hl-204-55><a class=lnlinks href=#hl-204-55>55</a>
</span><span class=lnt id=hl-204-56><a class=lnlinks href=#hl-204-56>56</a>
</span><span class=lnt id=hl-204-57><a class=lnlinks href=#hl-204-57>57</a>
</span><span class=lnt id=hl-204-58><a class=lnlinks href=#hl-204-58>58</a>
</span><span class=lnt id=hl-204-59><a class=lnlinks href=#hl-204-59>59</a>
</span><span class=lnt id=hl-204-60><a class=lnlinks href=#hl-204-60>60</a>
</span><span class=lnt id=hl-204-61><a class=lnlinks href=#hl-204-61>61</a>
</span><span class=lnt id=hl-204-62><a class=lnlinks href=#hl-204-62>62</a>
</span><span class=lnt id=hl-204-63><a class=lnlinks href=#hl-204-63>63</a>
</span><span class=lnt id=hl-204-64><a class=lnlinks href=#hl-204-64>64</a>
</span><span class=lnt id=hl-204-65><a class=lnlinks href=#hl-204-65>65</a>
</span><span class=lnt id=hl-204-66><a class=lnlinks href=#hl-204-66>66</a>
</span><span class=lnt id=hl-204-67><a class=lnlinks href=#hl-204-67>67</a>
</span><span class=lnt id=hl-204-68><a class=lnlinks href=#hl-204-68>68</a>
</span><span class=lnt id=hl-204-69><a class=lnlinks href=#hl-204-69>69</a>
</span><span class=lnt id=hl-204-70><a class=lnlinks href=#hl-204-70>70</a>
</span><span class=lnt id=hl-204-71><a class=lnlinks href=#hl-204-71>71</a>
</span><span class=lnt id=hl-204-72><a class=lnlinks href=#hl-204-72>72</a>
</span><span class=lnt id=hl-204-73><a class=lnlinks href=#hl-204-73>73</a>
</span><span class=lnt id=hl-204-74><a class=lnlinks href=#hl-204-74>74</a>
</span><span class=lnt id=hl-204-75><a class=lnlinks href=#hl-204-75>75</a>
</span><span class=lnt id=hl-204-76><a class=lnlinks href=#hl-204-76>76</a>
</span><span class=lnt id=hl-204-77><a class=lnlinks href=#hl-204-77>77</a>
</span><span class=lnt id=hl-204-78><a class=lnlinks href=#hl-204-78>78</a>
</span><span class=lnt id=hl-204-79><a class=lnlinks href=#hl-204-79>79</a>
</span><span class=lnt id=hl-204-80><a class=lnlinks href=#hl-204-80>80</a>
</span><span class=lnt id=hl-204-81><a class=lnlinks href=#hl-204-81>81</a>
</span><span class=lnt id=hl-204-82><a class=lnlinks href=#hl-204-82>82</a>
</span><span class=lnt id=hl-204-83><a class=lnlinks href=#hl-204-83>83</a>
</span><span class=lnt id=hl-204-84><a class=lnlinks href=#hl-204-84>84</a>
</span><span class=lnt id=hl-204-85><a class=lnlinks href=#hl-204-85>85</a>
</span><span class=lnt id=hl-204-86><a class=lnlinks href=#hl-204-86>86</a>
</span><span class=lnt id=hl-204-87><a class=lnlinks href=#hl-204-87>87</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>ShardedIndexManager</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;샤딩 환경의 인덱스 관리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>shard_config</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>shards</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>shard_info</span> <span class=ow>in</span> <span class=n>shard_config</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>shards</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;conn&#39;</span><span class=p>:</span> <span class=n>psycopg2</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=o>**</span><span class=n>shard_info</span><span class=p>[</span><span class=s1>&#39;db&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;range&#39;</span><span class=p>:</span> <span class=n>shard_info</span><span class=p>[</span><span class=s1>&#39;range&#39;</span><span class=p>],</span>  <span class=c1># 샤드 키 범위</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;node_id&#39;</span><span class=p>:</span> <span class=n>shard_info</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>route_query</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>shard_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;샤드 키로 적절한 샤드 선택&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>shard</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>shards</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>shard</span><span class=p>[</span><span class=s1>&#39;range&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>shard_key</span> <span class=o>&lt;</span> <span class=n>shard</span><span class=p>[</span><span class=s1>&#39;range&#39;</span><span class=p>][</span><span class=mi>1</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>shard</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;No shard for key: </span><span class=si>{</span><span class=n>shard_key</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>local_index_query</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>shard_key</span><span class=p>,</span> <span class=n>index_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;로컬 인덱스 쿼리 (단일 샤드)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>shard</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>route_query</span><span class=p>(</span><span class=n>shard_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>query</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            SELECT * FROM orders
</span></span></span><span class=line><span class=cl><span class=s2>            WHERE customer_id = </span><span class=si>%s</span><span class=s2> AND order_date = </span><span class=si>%s</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=n>shard</span><span class=p>[</span><span class=s1>&#39;conn&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span> <span class=k>as</span> <span class=n>cur</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>cur</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=p>(</span><span class=n>shard_key</span><span class=p>,</span> <span class=n>index_key</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>cur</span><span class=o>.</span><span class=n>fetchall</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>global_index_query</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>index_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;글로벌 인덱스 쿼리 (모든 샤드 조회)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 모든 샤드에 병렬 쿼리</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=n>concurrent</span><span class=o>.</span><span class=n>futures</span><span class=o>.</span><span class=n>ThreadPoolExecutor</span><span class=p>(</span><span class=n>max_workers</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>shards</span><span class=p>))</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>futures</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>shard</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>shards</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>future</span> <span class=o>=</span> <span class=n>executor</span><span class=o>.</span><span class=n>submit</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>_query_shard</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>shard</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>index_key</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>futures</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>future</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 결과 수집</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>future</span> <span class=ow>in</span> <span class=n>concurrent</span><span class=o>.</span><span class=n>futures</span><span class=o>.</span><span class=n>as_completed</span><span class=p>(</span><span class=n>futures</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>results</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>future</span><span class=o>.</span><span class=n>result</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>results</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_query_shard</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>shard</span><span class=p>,</span> <span class=n>index_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;개별 샤드 쿼리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>query</span> <span class=o>=</span> <span class=s2>&#34;SELECT * FROM orders WHERE order_date = </span><span class=si>%s</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=n>shard</span><span class=p>[</span><span class=s1>&#39;conn&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span> <span class=k>as</span> <span class=n>cur</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>cur</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=p>(</span><span class=n>index_key</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>cur</span><span class=o>.</span><span class=n>fetchall</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 설정</span>
</span></span><span class=line><span class=cl><span class=n>shard_config</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=s1>&#39;shard1&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;db&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;host&#39;</span><span class=p>:</span> <span class=s1>&#39;db1.example.com&#39;</span><span class=p>,</span> <span class=s1>&#39;database&#39;</span><span class=p>:</span> <span class=s1>&#39;orders&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;range&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>5000</span><span class=p>)</span>  <span class=c1># customer_id 0-4999</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=s1>&#39;shard2&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;db&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;host&#39;</span><span class=p>:</span> <span class=s1>&#39;db2.example.com&#39;</span><span class=p>,</span> <span class=s1>&#39;database&#39;</span><span class=p>:</span> <span class=s1>&#39;orders&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;range&#39;</span><span class=p>:</span> <span class=p>(</span><span class=mi>5000</span><span class=p>,</span> <span class=mi>10000</span><span class=p>)</span>  <span class=c1># customer_id 5000-9999</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>manager</span> <span class=o>=</span> <span class=n>ShardedIndexManager</span><span class=p>(</span><span class=n>shard_config</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용</span>
</span></span><span class=line><span class=cl><span class=c1># 로컬 인덱스 (빠름): 샤드 키 + 인덱스 키</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>manager</span><span class=o>.</span><span class=n>local_index_query</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>shard_key</span><span class=o>=</span><span class=mi>3000</span><span class=p>,</span>      <span class=c1># customer_id</span>
</span></span><span class=line><span class=cl>    <span class=n>index_key</span><span class=o>=</span><span class=s1>&#39;2024-09-26&#39;</span>  <span class=c1># order_date</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 글로벌 인덱스 (느림): 인덱스 키만</span>
</span></span><span class=line><span class=cl><span class=n>results</span> <span class=o>=</span> <span class=n>manager</span><span class=o>.</span><span class=n>global_index_query</span><span class=p>(</span><span class=n>index_key</span><span class=o>=</span><span class=s1>&#39;2024-09-26&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>획득 가치</strong>:</p><ul><li>샤드당 독립적 인덱스 관리</li><li>쿼리 패턴에 따른 최적 전략 선택</li><li>확장성과 성능의 균형</li></ul><p><strong>캐싱 레이어와 인덱스 통합</strong></p><p><strong>Redis를 활용한 인덱스 캐싱</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-205-1><a class=lnlinks href=#hl-205-1> 1</a>
</span><span class=lnt id=hl-205-2><a class=lnlinks href=#hl-205-2> 2</a>
</span><span class=lnt id=hl-205-3><a class=lnlinks href=#hl-205-3> 3</a>
</span><span class=lnt id=hl-205-4><a class=lnlinks href=#hl-205-4> 4</a>
</span><span class=lnt id=hl-205-5><a class=lnlinks href=#hl-205-5> 5</a>
</span><span class=lnt id=hl-205-6><a class=lnlinks href=#hl-205-6> 6</a>
</span><span class=lnt id=hl-205-7><a class=lnlinks href=#hl-205-7> 7</a>
</span><span class=lnt id=hl-205-8><a class=lnlinks href=#hl-205-8> 8</a>
</span><span class=lnt id=hl-205-9><a class=lnlinks href=#hl-205-9> 9</a>
</span><span class=lnt id=hl-205-10><a class=lnlinks href=#hl-205-10>10</a>
</span><span class=lnt id=hl-205-11><a class=lnlinks href=#hl-205-11>11</a>
</span><span class=lnt id=hl-205-12><a class=lnlinks href=#hl-205-12>12</a>
</span><span class=lnt id=hl-205-13><a class=lnlinks href=#hl-205-13>13</a>
</span><span class=lnt id=hl-205-14><a class=lnlinks href=#hl-205-14>14</a>
</span><span class=lnt id=hl-205-15><a class=lnlinks href=#hl-205-15>15</a>
</span><span class=lnt id=hl-205-16><a class=lnlinks href=#hl-205-16>16</a>
</span><span class=lnt id=hl-205-17><a class=lnlinks href=#hl-205-17>17</a>
</span><span class=lnt id=hl-205-18><a class=lnlinks href=#hl-205-18>18</a>
</span><span class=lnt id=hl-205-19><a class=lnlinks href=#hl-205-19>19</a>
</span><span class=lnt id=hl-205-20><a class=lnlinks href=#hl-205-20>20</a>
</span><span class=lnt id=hl-205-21><a class=lnlinks href=#hl-205-21>21</a>
</span><span class=lnt id=hl-205-22><a class=lnlinks href=#hl-205-22>22</a>
</span><span class=lnt id=hl-205-23><a class=lnlinks href=#hl-205-23>23</a>
</span><span class=lnt id=hl-205-24><a class=lnlinks href=#hl-205-24>24</a>
</span><span class=lnt id=hl-205-25><a class=lnlinks href=#hl-205-25>25</a>
</span><span class=lnt id=hl-205-26><a class=lnlinks href=#hl-205-26>26</a>
</span><span class=lnt id=hl-205-27><a class=lnlinks href=#hl-205-27>27</a>
</span><span class=lnt id=hl-205-28><a class=lnlinks href=#hl-205-28>28</a>
</span><span class=lnt id=hl-205-29><a class=lnlinks href=#hl-205-29>29</a>
</span><span class=lnt id=hl-205-30><a class=lnlinks href=#hl-205-30>30</a>
</span><span class=lnt id=hl-205-31><a class=lnlinks href=#hl-205-31>31</a>
</span><span class=lnt id=hl-205-32><a class=lnlinks href=#hl-205-32>32</a>
</span><span class=lnt id=hl-205-33><a class=lnlinks href=#hl-205-33>33</a>
</span><span class=lnt id=hl-205-34><a class=lnlinks href=#hl-205-34>34</a>
</span><span class=lnt id=hl-205-35><a class=lnlinks href=#hl-205-35>35</a>
</span><span class=lnt id=hl-205-36><a class=lnlinks href=#hl-205-36>36</a>
</span><span class=lnt id=hl-205-37><a class=lnlinks href=#hl-205-37>37</a>
</span><span class=lnt id=hl-205-38><a class=lnlinks href=#hl-205-38>38</a>
</span><span class=lnt id=hl-205-39><a class=lnlinks href=#hl-205-39>39</a>
</span><span class=lnt id=hl-205-40><a class=lnlinks href=#hl-205-40>40</a>
</span><span class=lnt id=hl-205-41><a class=lnlinks href=#hl-205-41>41</a>
</span><span class=lnt id=hl-205-42><a class=lnlinks href=#hl-205-42>42</a>
</span><span class=lnt id=hl-205-43><a class=lnlinks href=#hl-205-43>43</a>
</span><span class=lnt id=hl-205-44><a class=lnlinks href=#hl-205-44>44</a>
</span><span class=lnt id=hl-205-45><a class=lnlinks href=#hl-205-45>45</a>
</span><span class=lnt id=hl-205-46><a class=lnlinks href=#hl-205-46>46</a>
</span><span class=lnt id=hl-205-47><a class=lnlinks href=#hl-205-47>47</a>
</span><span class=lnt id=hl-205-48><a class=lnlinks href=#hl-205-48>48</a>
</span><span class=lnt id=hl-205-49><a class=lnlinks href=#hl-205-49>49</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>redis</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pickle</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CachedIndex</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;인덱스 결과 캐싱&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>db_conn</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db</span> <span class=o>=</span> <span class=n>db_conn</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>redis</span> <span class=o>=</span> <span class=n>redis</span><span class=o>.</span><span class=n>Redis</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s1>&#39;localhost&#39;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>6379</span><span class=p>,</span> <span class=n>db</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>ttl</span> <span class=o>=</span> <span class=mi>300</span>  <span class=c1># 5분</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_or_fetch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>query_key</span><span class=p>,</span> <span class=n>query_func</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;캐시 확인 후 DB 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. 캐시 확인</span>
</span></span><span class=line><span class=cl>        <span class=n>cached</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>redis</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>query_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>cached</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>pickle</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>cached</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. DB 조회 (인덱스 사용)</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>query_func</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. 캐시 저장</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>redis</span><span class=o>.</span><span class=n>setex</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>query_key</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>ttl</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>pickle</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>invalidate_on_write</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>affected_keys</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;쓰기 발생 시 관련 캐시 무효화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>affected_keys</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>redis</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=o>*</span><span class=n>affected_keys</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>cached_idx</span> <span class=o>=</span> <span class=n>CachedIndex</span><span class=p>(</span><span class=n>db_conn</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>query_orders</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>db_conn</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;SELECT * FROM orders WHERE customer_id = 5000&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span><span class=o>.</span><span class=n>fetchall</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 캐시된 조회</span>
</span></span><span class=line><span class=cl><span class=n>results</span> <span class=o>=</span> <span class=n>cached_idx</span><span class=o>.</span><span class=n>get_or_fetch</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>query_key</span><span class=o>=</span><span class=s2>&#34;orders:customer:5000&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>query_func</span><span class=o>=</span><span class=n>query_orders</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>획득 가치</strong>:</p><ul><li>인덱스 조회 지연 90% 감소</li><li>데이터베이스 부하 50-70% 절감</li><li>동일 쿼리 반복 시 ms 단위 응답</li></ul><p><strong>메시지 큐와 비동기 인덱싱 통합</strong></p><p><strong>Kafka를 활용한 실시간 인덱스 갱신</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-206-1><a class=lnlinks href=#hl-206-1> 1</a>
</span><span class=lnt id=hl-206-2><a class=lnlinks href=#hl-206-2> 2</a>
</span><span class=lnt id=hl-206-3><a class=lnlinks href=#hl-206-3> 3</a>
</span><span class=lnt id=hl-206-4><a class=lnlinks href=#hl-206-4> 4</a>
</span><span class=lnt id=hl-206-5><a class=lnlinks href=#hl-206-5> 5</a>
</span><span class=lnt id=hl-206-6><a class=lnlinks href=#hl-206-6> 6</a>
</span><span class=lnt id=hl-206-7><a class=lnlinks href=#hl-206-7> 7</a>
</span><span class=lnt id=hl-206-8><a class=lnlinks href=#hl-206-8> 8</a>
</span><span class=lnt id=hl-206-9><a class=lnlinks href=#hl-206-9> 9</a>
</span><span class=lnt id=hl-206-10><a class=lnlinks href=#hl-206-10>10</a>
</span><span class=lnt id=hl-206-11><a class=lnlinks href=#hl-206-11>11</a>
</span><span class=lnt id=hl-206-12><a class=lnlinks href=#hl-206-12>12</a>
</span><span class=lnt id=hl-206-13><a class=lnlinks href=#hl-206-13>13</a>
</span><span class=lnt id=hl-206-14><a class=lnlinks href=#hl-206-14>14</a>
</span><span class=lnt id=hl-206-15><a class=lnlinks href=#hl-206-15>15</a>
</span><span class=lnt id=hl-206-16><a class=lnlinks href=#hl-206-16>16</a>
</span><span class=lnt id=hl-206-17><a class=lnlinks href=#hl-206-17>17</a>
</span><span class=lnt id=hl-206-18><a class=lnlinks href=#hl-206-18>18</a>
</span><span class=lnt id=hl-206-19><a class=lnlinks href=#hl-206-19>19</a>
</span><span class=lnt id=hl-206-20><a class=lnlinks href=#hl-206-20>20</a>
</span><span class=lnt id=hl-206-21><a class=lnlinks href=#hl-206-21>21</a>
</span><span class=lnt id=hl-206-22><a class=lnlinks href=#hl-206-22>22</a>
</span><span class=lnt id=hl-206-23><a class=lnlinks href=#hl-206-23>23</a>
</span><span class=lnt id=hl-206-24><a class=lnlinks href=#hl-206-24>24</a>
</span><span class=lnt id=hl-206-25><a class=lnlinks href=#hl-206-25>25</a>
</span><span class=lnt id=hl-206-26><a class=lnlinks href=#hl-206-26>26</a>
</span><span class=lnt id=hl-206-27><a class=lnlinks href=#hl-206-27>27</a>
</span><span class=lnt id=hl-206-28><a class=lnlinks href=#hl-206-28>28</a>
</span><span class=lnt id=hl-206-29><a class=lnlinks href=#hl-206-29>29</a>
</span><span class=lnt id=hl-206-30><a class=lnlinks href=#hl-206-30>30</a>
</span><span class=lnt id=hl-206-31><a class=lnlinks href=#hl-206-31>31</a>
</span><span class=lnt id=hl-206-32><a class=lnlinks href=#hl-206-32>32</a>
</span><span class=lnt id=hl-206-33><a class=lnlinks href=#hl-206-33>33</a>
</span><span class=lnt id=hl-206-34><a class=lnlinks href=#hl-206-34>34</a>
</span><span class=lnt id=hl-206-35><a class=lnlinks href=#hl-206-35>35</a>
</span><span class=lnt id=hl-206-36><a class=lnlinks href=#hl-206-36>36</a>
</span><span class=lnt id=hl-206-37><a class=lnlinks href=#hl-206-37>37</a>
</span><span class=lnt id=hl-206-38><a class=lnlinks href=#hl-206-38>38</a>
</span><span class=lnt id=hl-206-39><a class=lnlinks href=#hl-206-39>39</a>
</span><span class=lnt id=hl-206-40><a class=lnlinks href=#hl-206-40>40</a>
</span><span class=lnt id=hl-206-41><a class=lnlinks href=#hl-206-41>41</a>
</span><span class=lnt id=hl-206-42><a class=lnlinks href=#hl-206-42>42</a>
</span><span class=lnt id=hl-206-43><a class=lnlinks href=#hl-206-43>43</a>
</span><span class=lnt id=hl-206-44><a class=lnlinks href=#hl-206-44>44</a>
</span><span class=lnt id=hl-206-45><a class=lnlinks href=#hl-206-45>45</a>
</span><span class=lnt id=hl-206-46><a class=lnlinks href=#hl-206-46>46</a>
</span><span class=lnt id=hl-206-47><a class=lnlinks href=#hl-206-47>47</a>
</span><span class=lnt id=hl-206-48><a class=lnlinks href=#hl-206-48>48</a>
</span><span class=lnt id=hl-206-49><a class=lnlinks href=#hl-206-49>49</a>
</span><span class=lnt id=hl-206-50><a class=lnlinks href=#hl-206-50>50</a>
</span><span class=lnt id=hl-206-51><a class=lnlinks href=#hl-206-51>51</a>
</span><span class=lnt id=hl-206-52><a class=lnlinks href=#hl-206-52>52</a>
</span><span class=lnt id=hl-206-53><a class=lnlinks href=#hl-206-53>53</a>
</span><span class=lnt id=hl-206-54><a class=lnlinks href=#hl-206-54>54</a>
</span><span class=lnt id=hl-206-55><a class=lnlinks href=#hl-206-55>55</a>
</span><span class=lnt id=hl-206-56><a class=lnlinks href=#hl-206-56>56</a>
</span><span class=lnt id=hl-206-57><a class=lnlinks href=#hl-206-57>57</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaProducer</span><span class=p>,</span> <span class=n>KafkaConsumer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AsyncIndexer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;비동기 인덱스 갱신&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>bootstrap_servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>value_serializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>v</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>v</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;index-updates&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>bootstrap_servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>value_deserializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>m</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>publish_index_update</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>operation</span><span class=p>,</span> <span class=n>table</span><span class=p>,</span> <span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;인덱스 갱신 이벤트 발행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>event</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;operation&#39;</span><span class=p>:</span> <span class=n>operation</span><span class=p>,</span>  <span class=c1># &#39;insert&#39;, &#39;update&#39;, &#39;delete&#39;</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;table&#39;</span><span class=p>:</span> <span class=n>table</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=n>data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s1>&#39;index-updates&#39;</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>producer</span><span class=o>.</span><span class=n>flush</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>consume_and_index</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>index_engine</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;이벤트 소비 및 인덱스 반영&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>message</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>event</span> <span class=o>=</span> <span class=n>message</span><span class=o>.</span><span class=n>value</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;operation&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;insert&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>index_engine</span><span class=o>.</span><span class=n>add_document</span><span class=p>(</span><span class=n>event</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;operation&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;update&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>index_engine</span><span class=o>.</span><span class=n>update_document</span><span class=p>(</span><span class=n>event</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>event</span><span class=p>[</span><span class=s1>&#39;operation&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;delete&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>index_engine</span><span class=o>.</span><span class=n>delete_document</span><span class=p>(</span><span class=n>event</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>][</span><span class=s1>&#39;id&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 주기적 커밋</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>consumer</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용</span>
</span></span><span class=line><span class=cl><span class=n>indexer</span> <span class=o>=</span> <span class=n>AsyncIndexer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 데이터 변경 시</span>
</span></span><span class=line><span class=cl><span class=n>indexer</span><span class=o>.</span><span class=n>publish_index_update</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>operation</span><span class=o>=</span><span class=s1>&#39;insert&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span><span class=o>=</span><span class=s1>&#39;products&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>123</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Widget&#39;</span><span class=p>,</span> <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=mf>29.99</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 별도 프로세스에서 소비</span>
</span></span><span class=line><span class=cl><span class=n>indexer</span><span class=o>.</span><span class=n>consume_and_index</span><span class=p>(</span><span class=n>elasticsearch_engine</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>획득 가치</strong>:</p><ul><li>쓰기 지연 최소화 (비동기 처리)</li><li>인덱스 일관성 최종 보장</li><li>처리량 10배 이상 향상</li></ul><h3 id=phase-6-운영-및-최적화-1>Phase 6: 운영 및 최적화<a hidden class=anchor aria-hidden=true href=#phase-6-운영-및-최적화-1>#</a></h3><h4 id=61-모니터링-및-관측성-1>6.1 모니터링 및 관측성<a hidden class=anchor aria-hidden=true href=#61-모니터링-및-관측성-1>#</a></h4><p><strong>무엇을 모니터링하는가</strong></p><p><strong>핵심 메트릭 분류</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-207-1><a class=lnlinks href=#hl-207-1> 1</a>
</span><span class=lnt id=hl-207-2><a class=lnlinks href=#hl-207-2> 2</a>
</span><span class=lnt id=hl-207-3><a class=lnlinks href=#hl-207-3> 3</a>
</span><span class=lnt id=hl-207-4><a class=lnlinks href=#hl-207-4> 4</a>
</span><span class=lnt id=hl-207-5><a class=lnlinks href=#hl-207-5> 5</a>
</span><span class=lnt id=hl-207-6><a class=lnlinks href=#hl-207-6> 6</a>
</span><span class=lnt id=hl-207-7><a class=lnlinks href=#hl-207-7> 7</a>
</span><span class=lnt id=hl-207-8><a class=lnlinks href=#hl-207-8> 8</a>
</span><span class=lnt id=hl-207-9><a class=lnlinks href=#hl-207-9> 9</a>
</span><span class=lnt id=hl-207-10><a class=lnlinks href=#hl-207-10>10</a>
</span><span class=lnt id=hl-207-11><a class=lnlinks href=#hl-207-11>11</a>
</span><span class=lnt id=hl-207-12><a class=lnlinks href=#hl-207-12>12</a>
</span><span class=lnt id=hl-207-13><a class=lnlinks href=#hl-207-13>13</a>
</span><span class=lnt id=hl-207-14><a class=lnlinks href=#hl-207-14>14</a>
</span><span class=lnt id=hl-207-15><a class=lnlinks href=#hl-207-15>15</a>
</span><span class=lnt id=hl-207-16><a class=lnlinks href=#hl-207-16>16</a>
</span><span class=lnt id=hl-207-17><a class=lnlinks href=#hl-207-17>17</a>
</span><span class=lnt id=hl-207-18><a class=lnlinks href=#hl-207-18>18</a>
</span><span class=lnt id=hl-207-19><a class=lnlinks href=#hl-207-19>19</a>
</span><span class=lnt id=hl-207-20><a class=lnlinks href=#hl-207-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>인덱스 성능 메트릭
</span></span><span class=line><span class=cl>├─ 사용률 (Usage)
</span></span><span class=line><span class=cl>│   ├─ Index Scan Count: 스캔 횟수
</span></span><span class=line><span class=cl>│   ├─ Index Hit Ratio: 히트율
</span></span><span class=line><span class=cl>│   └─ Unused Index: 미사용 인덱스
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>├─ 효율성 (Efficiency)
</span></span><span class=line><span class=cl>│   ├─ Rows Examined vs Returned: 검사/반환 비율
</span></span><span class=line><span class=cl>│   ├─ Index Size vs Table Size: 크기 비율
</span></span><span class=line><span class=cl>│   └─ Selectivity: 선택도
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>├─ 건강도 (Health)
</span></span><span class=line><span class=cl>│   ├─ Fragmentation: 단편화율
</span></span><span class=line><span class=cl>│   ├─ Bloat: 비효율적 공간
</span></span><span class=line><span class=cl>│   └─ Growth Rate: 증가율
</span></span><span class=line><span class=cl>│
</span></span><span class=line><span class=cl>└─ 부하 (Load)
</span></span><span class=line><span class=cl>    ├─ Lock Wait Time: 락 대기 시간
</span></span><span class=line><span class=cl>    ├─ Buffer Hit Rate: 버퍼 히트율
</span></span><span class=line><span class=cl>    └─ I/O Operations: 디스크 연산
</span></span></code></pre></td></tr></table></div></div><p><strong>PostgreSQL 모니터링 쿼리</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-208-1><a class=lnlinks href=#hl-208-1> 1</a>
</span><span class=lnt id=hl-208-2><a class=lnlinks href=#hl-208-2> 2</a>
</span><span class=lnt id=hl-208-3><a class=lnlinks href=#hl-208-3> 3</a>
</span><span class=lnt id=hl-208-4><a class=lnlinks href=#hl-208-4> 4</a>
</span><span class=lnt id=hl-208-5><a class=lnlinks href=#hl-208-5> 5</a>
</span><span class=lnt id=hl-208-6><a class=lnlinks href=#hl-208-6> 6</a>
</span><span class=lnt id=hl-208-7><a class=lnlinks href=#hl-208-7> 7</a>
</span><span class=lnt id=hl-208-8><a class=lnlinks href=#hl-208-8> 8</a>
</span><span class=lnt id=hl-208-9><a class=lnlinks href=#hl-208-9> 9</a>
</span><span class=lnt id=hl-208-10><a class=lnlinks href=#hl-208-10>10</a>
</span><span class=lnt id=hl-208-11><a class=lnlinks href=#hl-208-11>11</a>
</span><span class=lnt id=hl-208-12><a class=lnlinks href=#hl-208-12>12</a>
</span><span class=lnt id=hl-208-13><a class=lnlinks href=#hl-208-13>13</a>
</span><span class=lnt id=hl-208-14><a class=lnlinks href=#hl-208-14>14</a>
</span><span class=lnt id=hl-208-15><a class=lnlinks href=#hl-208-15>15</a>
</span><span class=lnt id=hl-208-16><a class=lnlinks href=#hl-208-16>16</a>
</span><span class=lnt id=hl-208-17><a class=lnlinks href=#hl-208-17>17</a>
</span><span class=lnt id=hl-208-18><a class=lnlinks href=#hl-208-18>18</a>
</span><span class=lnt id=hl-208-19><a class=lnlinks href=#hl-208-19>19</a>
</span><span class=lnt id=hl-208-20><a class=lnlinks href=#hl-208-20>20</a>
</span><span class=lnt id=hl-208-21><a class=lnlinks href=#hl-208-21>21</a>
</span><span class=lnt id=hl-208-22><a class=lnlinks href=#hl-208-22>22</a>
</span><span class=lnt id=hl-208-23><a class=lnlinks href=#hl-208-23>23</a>
</span><span class=lnt id=hl-208-24><a class=lnlinks href=#hl-208-24>24</a>
</span><span class=lnt id=hl-208-25><a class=lnlinks href=#hl-208-25>25</a>
</span><span class=lnt id=hl-208-26><a class=lnlinks href=#hl-208-26>26</a>
</span><span class=lnt id=hl-208-27><a class=lnlinks href=#hl-208-27>27</a>
</span><span class=lnt id=hl-208-28><a class=lnlinks href=#hl-208-28>28</a>
</span><span class=lnt id=hl-208-29><a class=lnlinks href=#hl-208-29>29</a>
</span><span class=lnt id=hl-208-30><a class=lnlinks href=#hl-208-30>30</a>
</span><span class=lnt id=hl-208-31><a class=lnlinks href=#hl-208-31>31</a>
</span><span class=lnt id=hl-208-32><a class=lnlinks href=#hl-208-32>32</a>
</span><span class=lnt id=hl-208-33><a class=lnlinks href=#hl-208-33>33</a>
</span><span class=lnt id=hl-208-34><a class=lnlinks href=#hl-208-34>34</a>
</span><span class=lnt id=hl-208-35><a class=lnlinks href=#hl-208-35>35</a>
</span><span class=lnt id=hl-208-36><a class=lnlinks href=#hl-208-36>36</a>
</span><span class=lnt id=hl-208-37><a class=lnlinks href=#hl-208-37>37</a>
</span><span class=lnt id=hl-208-38><a class=lnlinks href=#hl-208-38>38</a>
</span><span class=lnt id=hl-208-39><a class=lnlinks href=#hl-208-39>39</a>
</span><span class=lnt id=hl-208-40><a class=lnlinks href=#hl-208-40>40</a>
</span><span class=lnt id=hl-208-41><a class=lnlinks href=#hl-208-41>41</a>
</span><span class=lnt id=hl-208-42><a class=lnlinks href=#hl-208-42>42</a>
</span><span class=lnt id=hl-208-43><a class=lnlinks href=#hl-208-43>43</a>
</span><span class=lnt id=hl-208-44><a class=lnlinks href=#hl-208-44>44</a>
</span><span class=lnt id=hl-208-45><a class=lnlinks href=#hl-208-45>45</a>
</span><span class=lnt id=hl-208-46><a class=lnlinks href=#hl-208-46>46</a>
</span><span class=lnt id=hl-208-47><a class=lnlinks href=#hl-208-47>47</a>
</span><span class=lnt id=hl-208-48><a class=lnlinks href=#hl-208-48>48</a>
</span><span class=lnt id=hl-208-49><a class=lnlinks href=#hl-208-49>49</a>
</span><span class=lnt id=hl-208-50><a class=lnlinks href=#hl-208-50>50</a>
</span><span class=lnt id=hl-208-51><a class=lnlinks href=#hl-208-51>51</a>
</span><span class=lnt id=hl-208-52><a class=lnlinks href=#hl-208-52>52</a>
</span><span class=lnt id=hl-208-53><a class=lnlinks href=#hl-208-53>53</a>
</span><span class=lnt id=hl-208-54><a class=lnlinks href=#hl-208-54>54</a>
</span><span class=lnt id=hl-208-55><a class=lnlinks href=#hl-208-55>55</a>
</span><span class=lnt id=hl-208-56><a class=lnlinks href=#hl-208-56>56</a>
</span><span class=lnt id=hl-208-57><a class=lnlinks href=#hl-208-57>57</a>
</span><span class=lnt id=hl-208-58><a class=lnlinks href=#hl-208-58>58</a>
</span><span class=lnt id=hl-208-59><a class=lnlinks href=#hl-208-59>59</a>
</span><span class=lnt id=hl-208-60><a class=lnlinks href=#hl-208-60>60</a>
</span><span class=lnt id=hl-208-61><a class=lnlinks href=#hl-208-61>61</a>
</span><span class=lnt id=hl-208-62><a class=lnlinks href=#hl-208-62>62</a>
</span><span class=lnt id=hl-208-63><a class=lnlinks href=#hl-208-63>63</a>
</span><span class=lnt id=hl-208-64><a class=lnlinks href=#hl-208-64>64</a>
</span><span class=lnt id=hl-208-65><a class=lnlinks href=#hl-208-65>65</a>
</span><span class=lnt id=hl-208-66><a class=lnlinks href=#hl-208-66>66</a>
</span><span class=lnt id=hl-208-67><a class=lnlinks href=#hl-208-67>67</a>
</span><span class=lnt id=hl-208-68><a class=lnlinks href=#hl-208-68>68</a>
</span><span class=lnt id=hl-208-69><a class=lnlinks href=#hl-208-69>69</a>
</span><span class=lnt id=hl-208-70><a class=lnlinks href=#hl-208-70>70</a>
</span><span class=lnt id=hl-208-71><a class=lnlinks href=#hl-208-71>71</a>
</span><span class=lnt id=hl-208-72><a class=lnlinks href=#hl-208-72>72</a>
</span><span class=lnt id=hl-208-73><a class=lnlinks href=#hl-208-73>73</a>
</span><span class=lnt id=hl-208-74><a class=lnlinks href=#hl-208-74>74</a>
</span><span class=lnt id=hl-208-75><a class=lnlinks href=#hl-208-75>75</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 1. 인덱스 사용 통계
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>schemaname</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>tablename</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>indexname</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>idx_scan</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>scans</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>idx_tup_read</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>tuples_read</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>idx_tup_fetch</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>tuples_fetched</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>pg_size_pretty</span><span class=p>(</span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indexrelid</span><span class=p>))</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>size</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>CASE</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>idx_scan</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;미사용&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>idx_scan</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=s1>&#39;저사용&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ELSE</span><span class=w> </span><span class=s1>&#39;정상&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>END</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>usage_status</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>pg_stat_user_indexes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>idx_scan</span><span class=w> </span><span class=k>ASC</span><span class=p>,</span><span class=w> </span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indexrelid</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 2. 중복 인덱스 탐지
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>pg_size_pretty</span><span class=p>(</span><span class=k>SUM</span><span class=p>(</span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>idx</span><span class=p>))::</span><span class=nb>BIGINT</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>size</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>(</span><span class=n>array_agg</span><span class=p>(</span><span class=n>idx</span><span class=p>))[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>idx1</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>(</span><span class=n>array_agg</span><span class=p>(</span><span class=n>idx</span><span class=p>))[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>idx2</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>(</span><span class=n>array_agg</span><span class=p>(</span><span class=n>idx</span><span class=p>))[</span><span class=mi>3</span><span class=p>]</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>idx3</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>(</span><span class=n>array_agg</span><span class=p>(</span><span class=n>idx</span><span class=p>))[</span><span class=mi>4</span><span class=p>]</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>idx4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>indexrelid</span><span class=p>::</span><span class=n>regclass</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>idx</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>(</span><span class=n>indrelid</span><span class=p>::</span><span class=nb>text</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>E</span><span class=s1>&#39;\n&#39;</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>indclass</span><span class=p>::</span><span class=nb>text</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>E</span><span class=s1>&#39;\n&#39;</span><span class=w> </span><span class=o>||</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>indkey</span><span class=p>::</span><span class=nb>text</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>E</span><span class=s1>&#39;\n&#39;</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>COALESCE</span><span class=p>(</span><span class=n>indexprs</span><span class=p>::</span><span class=nb>text</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>E</span><span class=s1>&#39;\n&#39;</span><span class=w> </span><span class=o>||</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>COALESCE</span><span class=p>(</span><span class=n>indpred</span><span class=p>::</span><span class=nb>text</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=p>))</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>key</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> </span><span class=n>pg_index</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w> </span><span class=n>sub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>key</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>HAVING</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>idx</span><span class=p>))</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 3. 인덱스 블로트(Bloat) 측정
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>schemaname</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>tablename</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>indexname</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>pg_size_pretty</span><span class=p>(</span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indexrelid</span><span class=p>))</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>size</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>ROUND</span><span class=p>(</span><span class=mi>100</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(</span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indexrelid</span><span class=p>)</span><span class=w> </span><span class=o>-</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indexrelid</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;main&#39;</span><span class=p>))</span><span class=w> </span><span class=o>/</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=k>NULLIF</span><span class=p>(</span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indexrelid</span><span class=p>),</span><span class=w> </span><span class=mi>0</span><span class=p>)::</span><span class=nb>numeric</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>bloat_pct</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>pg_stat_user_indexes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indexrelid</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1000000</span><span class=w>  </span><span class=c1>-- 1MB 이상
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>bloat_pct</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 4. 인덱스 vs 테이블 스캔 비교
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>schemaname</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>tablename</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>seq_scan</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>table_scans</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>idx_scan</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>index_scans</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>CASE</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>WHEN</span><span class=w> </span><span class=n>seq_scan</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=mi>100</span><span class=p>.</span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>ELSE</span><span class=w> </span><span class=n>ROUND</span><span class=p>(</span><span class=mi>100</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>idx_scan</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=n>seq_scan</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>idx_scan</span><span class=p>),</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>END</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>index_usage_pct</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>pg_stat_user_tables</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=p>(</span><span class=n>seq_scan</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>idx_scan</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>index_usage_pct</span><span class=w> </span><span class=k>ASC</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 5. 락 대기 시간 모니터링
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>pg_stat_get_backend_pid</span><span class=p>(</span><span class=n>s</span><span class=p>.</span><span class=n>backend_id</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>pid</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>pg_stat_get_backend_activity</span><span class=p>(</span><span class=n>s</span><span class=p>.</span><span class=n>backend_id</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>query</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>l</span><span class=p>.</span><span class=k>mode</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>l</span><span class=p>.</span><span class=k>granted</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>age</span><span class=p>(</span><span class=n>clock_timestamp</span><span class=p>(),</span><span class=w> </span><span class=n>pg_stat_get_backend_activity_start</span><span class=p>(</span><span class=n>s</span><span class=p>.</span><span class=n>backend_id</span><span class=p>))</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>duration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>pg_stat_get_backend_idset</span><span class=p>()</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>s</span><span class=p>(</span><span class=n>backend_id</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=n>pg_locks</span><span class=w> </span><span class=n>l</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>pg_stat_get_backend_pid</span><span class=p>(</span><span class=n>s</span><span class=p>.</span><span class=n>backend_id</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>l</span><span class=p>.</span><span class=n>pid</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>l</span><span class=p>.</span><span class=k>granted</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>duration</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>실시간 모니터링 대시보드 구현</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-209-1><a class=lnlinks href=#hl-209-1>  1</a>
</span><span class=lnt id=hl-209-2><a class=lnlinks href=#hl-209-2>  2</a>
</span><span class=lnt id=hl-209-3><a class=lnlinks href=#hl-209-3>  3</a>
</span><span class=lnt id=hl-209-4><a class=lnlinks href=#hl-209-4>  4</a>
</span><span class=lnt id=hl-209-5><a class=lnlinks href=#hl-209-5>  5</a>
</span><span class=lnt id=hl-209-6><a class=lnlinks href=#hl-209-6>  6</a>
</span><span class=lnt id=hl-209-7><a class=lnlinks href=#hl-209-7>  7</a>
</span><span class=lnt id=hl-209-8><a class=lnlinks href=#hl-209-8>  8</a>
</span><span class=lnt id=hl-209-9><a class=lnlinks href=#hl-209-9>  9</a>
</span><span class=lnt id=hl-209-10><a class=lnlinks href=#hl-209-10> 10</a>
</span><span class=lnt id=hl-209-11><a class=lnlinks href=#hl-209-11> 11</a>
</span><span class=lnt id=hl-209-12><a class=lnlinks href=#hl-209-12> 12</a>
</span><span class=lnt id=hl-209-13><a class=lnlinks href=#hl-209-13> 13</a>
</span><span class=lnt id=hl-209-14><a class=lnlinks href=#hl-209-14> 14</a>
</span><span class=lnt id=hl-209-15><a class=lnlinks href=#hl-209-15> 15</a>
</span><span class=lnt id=hl-209-16><a class=lnlinks href=#hl-209-16> 16</a>
</span><span class=lnt id=hl-209-17><a class=lnlinks href=#hl-209-17> 17</a>
</span><span class=lnt id=hl-209-18><a class=lnlinks href=#hl-209-18> 18</a>
</span><span class=lnt id=hl-209-19><a class=lnlinks href=#hl-209-19> 19</a>
</span><span class=lnt id=hl-209-20><a class=lnlinks href=#hl-209-20> 20</a>
</span><span class=lnt id=hl-209-21><a class=lnlinks href=#hl-209-21> 21</a>
</span><span class=lnt id=hl-209-22><a class=lnlinks href=#hl-209-22> 22</a>
</span><span class=lnt id=hl-209-23><a class=lnlinks href=#hl-209-23> 23</a>
</span><span class=lnt id=hl-209-24><a class=lnlinks href=#hl-209-24> 24</a>
</span><span class=lnt id=hl-209-25><a class=lnlinks href=#hl-209-25> 25</a>
</span><span class=lnt id=hl-209-26><a class=lnlinks href=#hl-209-26> 26</a>
</span><span class=lnt id=hl-209-27><a class=lnlinks href=#hl-209-27> 27</a>
</span><span class=lnt id=hl-209-28><a class=lnlinks href=#hl-209-28> 28</a>
</span><span class=lnt id=hl-209-29><a class=lnlinks href=#hl-209-29> 29</a>
</span><span class=lnt id=hl-209-30><a class=lnlinks href=#hl-209-30> 30</a>
</span><span class=lnt id=hl-209-31><a class=lnlinks href=#hl-209-31> 31</a>
</span><span class=lnt id=hl-209-32><a class=lnlinks href=#hl-209-32> 32</a>
</span><span class=lnt id=hl-209-33><a class=lnlinks href=#hl-209-33> 33</a>
</span><span class=lnt id=hl-209-34><a class=lnlinks href=#hl-209-34> 34</a>
</span><span class=lnt id=hl-209-35><a class=lnlinks href=#hl-209-35> 35</a>
</span><span class=lnt id=hl-209-36><a class=lnlinks href=#hl-209-36> 36</a>
</span><span class=lnt id=hl-209-37><a class=lnlinks href=#hl-209-37> 37</a>
</span><span class=lnt id=hl-209-38><a class=lnlinks href=#hl-209-38> 38</a>
</span><span class=lnt id=hl-209-39><a class=lnlinks href=#hl-209-39> 39</a>
</span><span class=lnt id=hl-209-40><a class=lnlinks href=#hl-209-40> 40</a>
</span><span class=lnt id=hl-209-41><a class=lnlinks href=#hl-209-41> 41</a>
</span><span class=lnt id=hl-209-42><a class=lnlinks href=#hl-209-42> 42</a>
</span><span class=lnt id=hl-209-43><a class=lnlinks href=#hl-209-43> 43</a>
</span><span class=lnt id=hl-209-44><a class=lnlinks href=#hl-209-44> 44</a>
</span><span class=lnt id=hl-209-45><a class=lnlinks href=#hl-209-45> 45</a>
</span><span class=lnt id=hl-209-46><a class=lnlinks href=#hl-209-46> 46</a>
</span><span class=lnt id=hl-209-47><a class=lnlinks href=#hl-209-47> 47</a>
</span><span class=lnt id=hl-209-48><a class=lnlinks href=#hl-209-48> 48</a>
</span><span class=lnt id=hl-209-49><a class=lnlinks href=#hl-209-49> 49</a>
</span><span class=lnt id=hl-209-50><a class=lnlinks href=#hl-209-50> 50</a>
</span><span class=lnt id=hl-209-51><a class=lnlinks href=#hl-209-51> 51</a>
</span><span class=lnt id=hl-209-52><a class=lnlinks href=#hl-209-52> 52</a>
</span><span class=lnt id=hl-209-53><a class=lnlinks href=#hl-209-53> 53</a>
</span><span class=lnt id=hl-209-54><a class=lnlinks href=#hl-209-54> 54</a>
</span><span class=lnt id=hl-209-55><a class=lnlinks href=#hl-209-55> 55</a>
</span><span class=lnt id=hl-209-56><a class=lnlinks href=#hl-209-56> 56</a>
</span><span class=lnt id=hl-209-57><a class=lnlinks href=#hl-209-57> 57</a>
</span><span class=lnt id=hl-209-58><a class=lnlinks href=#hl-209-58> 58</a>
</span><span class=lnt id=hl-209-59><a class=lnlinks href=#hl-209-59> 59</a>
</span><span class=lnt id=hl-209-60><a class=lnlinks href=#hl-209-60> 60</a>
</span><span class=lnt id=hl-209-61><a class=lnlinks href=#hl-209-61> 61</a>
</span><span class=lnt id=hl-209-62><a class=lnlinks href=#hl-209-62> 62</a>
</span><span class=lnt id=hl-209-63><a class=lnlinks href=#hl-209-63> 63</a>
</span><span class=lnt id=hl-209-64><a class=lnlinks href=#hl-209-64> 64</a>
</span><span class=lnt id=hl-209-65><a class=lnlinks href=#hl-209-65> 65</a>
</span><span class=lnt id=hl-209-66><a class=lnlinks href=#hl-209-66> 66</a>
</span><span class=lnt id=hl-209-67><a class=lnlinks href=#hl-209-67> 67</a>
</span><span class=lnt id=hl-209-68><a class=lnlinks href=#hl-209-68> 68</a>
</span><span class=lnt id=hl-209-69><a class=lnlinks href=#hl-209-69> 69</a>
</span><span class=lnt id=hl-209-70><a class=lnlinks href=#hl-209-70> 70</a>
</span><span class=lnt id=hl-209-71><a class=lnlinks href=#hl-209-71> 71</a>
</span><span class=lnt id=hl-209-72><a class=lnlinks href=#hl-209-72> 72</a>
</span><span class=lnt id=hl-209-73><a class=lnlinks href=#hl-209-73> 73</a>
</span><span class=lnt id=hl-209-74><a class=lnlinks href=#hl-209-74> 74</a>
</span><span class=lnt id=hl-209-75><a class=lnlinks href=#hl-209-75> 75</a>
</span><span class=lnt id=hl-209-76><a class=lnlinks href=#hl-209-76> 76</a>
</span><span class=lnt id=hl-209-77><a class=lnlinks href=#hl-209-77> 77</a>
</span><span class=lnt id=hl-209-78><a class=lnlinks href=#hl-209-78> 78</a>
</span><span class=lnt id=hl-209-79><a class=lnlinks href=#hl-209-79> 79</a>
</span><span class=lnt id=hl-209-80><a class=lnlinks href=#hl-209-80> 80</a>
</span><span class=lnt id=hl-209-81><a class=lnlinks href=#hl-209-81> 81</a>
</span><span class=lnt id=hl-209-82><a class=lnlinks href=#hl-209-82> 82</a>
</span><span class=lnt id=hl-209-83><a class=lnlinks href=#hl-209-83> 83</a>
</span><span class=lnt id=hl-209-84><a class=lnlinks href=#hl-209-84> 84</a>
</span><span class=lnt id=hl-209-85><a class=lnlinks href=#hl-209-85> 85</a>
</span><span class=lnt id=hl-209-86><a class=lnlinks href=#hl-209-86> 86</a>
</span><span class=lnt id=hl-209-87><a class=lnlinks href=#hl-209-87> 87</a>
</span><span class=lnt id=hl-209-88><a class=lnlinks href=#hl-209-88> 88</a>
</span><span class=lnt id=hl-209-89><a class=lnlinks href=#hl-209-89> 89</a>
</span><span class=lnt id=hl-209-90><a class=lnlinks href=#hl-209-90> 90</a>
</span><span class=lnt id=hl-209-91><a class=lnlinks href=#hl-209-91> 91</a>
</span><span class=lnt id=hl-209-92><a class=lnlinks href=#hl-209-92> 92</a>
</span><span class=lnt id=hl-209-93><a class=lnlinks href=#hl-209-93> 93</a>
</span><span class=lnt id=hl-209-94><a class=lnlinks href=#hl-209-94> 94</a>
</span><span class=lnt id=hl-209-95><a class=lnlinks href=#hl-209-95> 95</a>
</span><span class=lnt id=hl-209-96><a class=lnlinks href=#hl-209-96> 96</a>
</span><span class=lnt id=hl-209-97><a class=lnlinks href=#hl-209-97> 97</a>
</span><span class=lnt id=hl-209-98><a class=lnlinks href=#hl-209-98> 98</a>
</span><span class=lnt id=hl-209-99><a class=lnlinks href=#hl-209-99> 99</a>
</span><span class=lnt id=hl-209-100><a class=lnlinks href=#hl-209-100>100</a>
</span><span class=lnt id=hl-209-101><a class=lnlinks href=#hl-209-101>101</a>
</span><span class=lnt id=hl-209-102><a class=lnlinks href=#hl-209-102>102</a>
</span><span class=lnt id=hl-209-103><a class=lnlinks href=#hl-209-103>103</a>
</span><span class=lnt id=hl-209-104><a class=lnlinks href=#hl-209-104>104</a>
</span><span class=lnt id=hl-209-105><a class=lnlinks href=#hl-209-105>105</a>
</span><span class=lnt id=hl-209-106><a class=lnlinks href=#hl-209-106>106</a>
</span><span class=lnt id=hl-209-107><a class=lnlinks href=#hl-209-107>107</a>
</span><span class=lnt id=hl-209-108><a class=lnlinks href=#hl-209-108>108</a>
</span><span class=lnt id=hl-209-109><a class=lnlinks href=#hl-209-109>109</a>
</span><span class=lnt id=hl-209-110><a class=lnlinks href=#hl-209-110>110</a>
</span><span class=lnt id=hl-209-111><a class=lnlinks href=#hl-209-111>111</a>
</span><span class=lnt id=hl-209-112><a class=lnlinks href=#hl-209-112>112</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>psycopg2</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>prometheus_client</span> <span class=kn>import</span> <span class=n>start_http_server</span><span class=p>,</span> <span class=n>Gauge</span><span class=p>,</span> <span class=n>Counter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>IndexMonitor</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;인덱스 메트릭 수집 및 노출&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>db_config</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>conn</span> <span class=o>=</span> <span class=n>psycopg2</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=o>**</span><span class=n>db_config</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Prometheus 메트릭 정의</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>index_scan_count</span> <span class=o>=</span> <span class=n>Gauge</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;postgres_index_scan_count&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Number of index scans&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span><span class=s1>&#39;schema&#39;</span><span class=p>,</span> <span class=s1>&#39;table&#39;</span><span class=p>,</span> <span class=s1>&#39;index&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>index_size_bytes</span> <span class=o>=</span> <span class=n>Gauge</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;postgres_index_size_bytes&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Index size in bytes&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span><span class=s1>&#39;schema&#39;</span><span class=p>,</span> <span class=s1>&#39;table&#39;</span><span class=p>,</span> <span class=s1>&#39;index&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>index_bloat_ratio</span> <span class=o>=</span> <span class=n>Gauge</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;postgres_index_bloat_ratio&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Index bloat ratio&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>[</span><span class=s1>&#39;schema&#39;</span><span class=p>,</span> <span class=s1>&#39;table&#39;</span><span class=p>,</span> <span class=s1>&#39;index&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>unused_index_count</span> <span class=o>=</span> <span class=n>Counter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;postgres_unused_index_total&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;Total unused indexes&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>collect_metrics</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;메트릭 수집&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=bp>self</span><span class=o>.</span><span class=n>conn</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span> <span class=k>as</span> <span class=n>cur</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 인덱스 사용 통계</span>
</span></span><span class=line><span class=cl>            <span class=n>cur</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>                SELECT 
</span></span></span><span class=line><span class=cl><span class=s2>                    schemaname,
</span></span></span><span class=line><span class=cl><span class=s2>                    tablename,
</span></span></span><span class=line><span class=cl><span class=s2>                    indexname,
</span></span></span><span class=line><span class=cl><span class=s2>                    idx_scan,
</span></span></span><span class=line><span class=cl><span class=s2>                    pg_relation_size(indexrelid)
</span></span></span><span class=line><span class=cl><span class=s2>                FROM pg_stat_user_indexes
</span></span></span><span class=line><span class=cl><span class=s2>            &#34;&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>cur</span><span class=o>.</span><span class=n>fetchall</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=n>schema</span><span class=p>,</span> <span class=n>table</span><span class=p>,</span> <span class=n>index</span><span class=p>,</span> <span class=n>scans</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=n>row</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>index_scan_count</span><span class=o>.</span><span class=n>labels</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>schema</span><span class=o>=</span><span class=n>schema</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>table</span><span class=o>=</span><span class=n>table</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>index</span><span class=o>=</span><span class=n>index</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=n>scans</span> <span class=ow>or</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>index_size_bytes</span><span class=o>.</span><span class=n>labels</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>schema</span><span class=o>=</span><span class=n>schema</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>table</span><span class=o>=</span><span class=n>table</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>index</span><span class=o>=</span><span class=n>index</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=n>size</span> <span class=ow>or</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 미사용 인덱스 카운트</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>scans</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=n>size</span> <span class=o>&gt;</span> <span class=mi>1000000</span><span class=p>:</span>  <span class=c1># 1MB 이상</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>unused_index_count</span><span class=o>.</span><span class=n>inc</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 인덱스 단편화</span>
</span></span><span class=line><span class=cl>            <span class=n>cur</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>                SELECT 
</span></span></span><span class=line><span class=cl><span class=s2>                    schemaname,
</span></span></span><span class=line><span class=cl><span class=s2>                    tablename,
</span></span></span><span class=line><span class=cl><span class=s2>                    indexname,
</span></span></span><span class=line><span class=cl><span class=s2>                    leaf_fragmentation
</span></span></span><span class=line><span class=cl><span class=s2>                FROM pg_stat_user_indexes
</span></span></span><span class=line><span class=cl><span class=s2>                JOIN LATERAL pgstatindex(indexrelid) ON true
</span></span></span><span class=line><span class=cl><span class=s2>                WHERE pg_relation_size(indexrelid) &gt; 1000000
</span></span></span><span class=line><span class=cl><span class=s2>            &#34;&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>cur</span><span class=o>.</span><span class=n>fetchall</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                <span class=n>schema</span><span class=p>,</span> <span class=n>table</span><span class=p>,</span> <span class=n>index</span><span class=p>,</span> <span class=n>frag</span> <span class=o>=</span> <span class=n>row</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>index_bloat_ratio</span><span class=o>.</span><span class=n>labels</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>schema</span><span class=o>=</span><span class=n>schema</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>table</span><span class=o>=</span><span class=n>table</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>index</span><span class=o>=</span><span class=n>index</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=n>frag</span> <span class=ow>or</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>run</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>interval</span><span class=o>=</span><span class=mi>60</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;주기적 수집&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># Prometheus HTTP 서버 시작</span>
</span></span><span class=line><span class=cl>        <span class=n>start_http_server</span><span class=p>(</span><span class=mi>8000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>collect_metrics</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Metrics collected at </span><span class=si>{</span><span class=n>time</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> %H:%M:%S&#39;</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error collecting metrics: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=n>interval</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 실행</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>monitor</span> <span class=o>=</span> <span class=n>IndexMonitor</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;host&#39;</span><span class=p>:</span> <span class=s1>&#39;localhost&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;database&#39;</span><span class=p>:</span> <span class=s1>&#39;mydb&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;user&#39;</span><span class=p>:</span> <span class=s1>&#39;postgres&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;password&#39;</span><span class=p>:</span> <span class=s1>&#39;password&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>monitor</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>interval</span><span class=o>=</span><span class=mi>60</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>알림 규칙 설정 (Prometheus Alert)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-210-1><a class=lnlinks href=#hl-210-1> 1</a>
</span><span class=lnt id=hl-210-2><a class=lnlinks href=#hl-210-2> 2</a>
</span><span class=lnt id=hl-210-3><a class=lnlinks href=#hl-210-3> 3</a>
</span><span class=lnt id=hl-210-4><a class=lnlinks href=#hl-210-4> 4</a>
</span><span class=lnt id=hl-210-5><a class=lnlinks href=#hl-210-5> 5</a>
</span><span class=lnt id=hl-210-6><a class=lnlinks href=#hl-210-6> 6</a>
</span><span class=lnt id=hl-210-7><a class=lnlinks href=#hl-210-7> 7</a>
</span><span class=lnt id=hl-210-8><a class=lnlinks href=#hl-210-8> 8</a>
</span><span class=lnt id=hl-210-9><a class=lnlinks href=#hl-210-9> 9</a>
</span><span class=lnt id=hl-210-10><a class=lnlinks href=#hl-210-10>10</a>
</span><span class=lnt id=hl-210-11><a class=lnlinks href=#hl-210-11>11</a>
</span><span class=lnt id=hl-210-12><a class=lnlinks href=#hl-210-12>12</a>
</span><span class=lnt id=hl-210-13><a class=lnlinks href=#hl-210-13>13</a>
</span><span class=lnt id=hl-210-14><a class=lnlinks href=#hl-210-14>14</a>
</span><span class=lnt id=hl-210-15><a class=lnlinks href=#hl-210-15>15</a>
</span><span class=lnt id=hl-210-16><a class=lnlinks href=#hl-210-16>16</a>
</span><span class=lnt id=hl-210-17><a class=lnlinks href=#hl-210-17>17</a>
</span><span class=lnt id=hl-210-18><a class=lnlinks href=#hl-210-18>18</a>
</span><span class=lnt id=hl-210-19><a class=lnlinks href=#hl-210-19>19</a>
</span><span class=lnt id=hl-210-20><a class=lnlinks href=#hl-210-20>20</a>
</span><span class=lnt id=hl-210-21><a class=lnlinks href=#hl-210-21>21</a>
</span><span class=lnt id=hl-210-22><a class=lnlinks href=#hl-210-22>22</a>
</span><span class=lnt id=hl-210-23><a class=lnlinks href=#hl-210-23>23</a>
</span><span class=lnt id=hl-210-24><a class=lnlinks href=#hl-210-24>24</a>
</span><span class=lnt id=hl-210-25><a class=lnlinks href=#hl-210-25>25</a>
</span><span class=lnt id=hl-210-26><a class=lnlinks href=#hl-210-26>26</a>
</span><span class=lnt id=hl-210-27><a class=lnlinks href=#hl-210-27>27</a>
</span><span class=lnt id=hl-210-28><a class=lnlinks href=#hl-210-28>28</a>
</span><span class=lnt id=hl-210-29><a class=lnlinks href=#hl-210-29>29</a>
</span><span class=lnt id=hl-210-30><a class=lnlinks href=#hl-210-30>30</a>
</span><span class=lnt id=hl-210-31><a class=lnlinks href=#hl-210-31>31</a>
</span><span class=lnt id=hl-210-32><a class=lnlinks href=#hl-210-32>32</a>
</span><span class=lnt id=hl-210-33><a class=lnlinks href=#hl-210-33>33</a>
</span><span class=lnt id=hl-210-34><a class=lnlinks href=#hl-210-34>34</a>
</span><span class=lnt id=hl-210-35><a class=lnlinks href=#hl-210-35>35</a>
</span><span class=lnt id=hl-210-36><a class=lnlinks href=#hl-210-36>36</a>
</span><span class=lnt id=hl-210-37><a class=lnlinks href=#hl-210-37>37</a>
</span><span class=lnt id=hl-210-38><a class=lnlinks href=#hl-210-38>38</a>
</span><span class=lnt id=hl-210-39><a class=lnlinks href=#hl-210-39>39</a>
</span><span class=lnt id=hl-210-40><a class=lnlinks href=#hl-210-40>40</a>
</span><span class=lnt id=hl-210-41><a class=lnlinks href=#hl-210-41>41</a>
</span><span class=lnt id=hl-210-42><a class=lnlinks href=#hl-210-42>42</a>
</span><span class=lnt id=hl-210-43><a class=lnlinks href=#hl-210-43>43</a>
</span><span class=lnt id=hl-210-44><a class=lnlinks href=#hl-210-44>44</a>
</span><span class=lnt id=hl-210-45><a class=lnlinks href=#hl-210-45>45</a>
</span><span class=lnt id=hl-210-46><a class=lnlinks href=#hl-210-46>46</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># alerts.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>groups</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>index_alerts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=l>60s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 미사용 인덱스 경고</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>alert</span><span class=p>:</span><span class=w> </span><span class=l>UnusedIndexDetected</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>expr</span><span class=p>:</span><span class=w> </span><span class=l>postgres_index_scan_count == 0 and postgres_index_size_bytes &gt; 10485760</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>for</span><span class=p>:</span><span class=w> </span><span class=l>7d</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class=l>warning</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Unused index detected: {{ $labels.index }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Index {{ $labels.index }} on {{ $labels.table }} has not been used for 7 days and is {{ $value | humanize }}B&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 높은 단편화율 경고</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>alert</span><span class=p>:</span><span class=w> </span><span class=l>HighIndexFragmentation</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>expr</span><span class=p>:</span><span class=w> </span><span class=l>postgres_index_bloat_ratio &gt; 30</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>for</span><span class=p>:</span><span class=w> </span><span class=l>1h</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class=l>warning</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;High index fragmentation: {{ $labels.index }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Index {{ $labels.index }} fragmentation is {{ $value }}%&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 인덱스 크기 급증</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>alert</span><span class=p>:</span><span class=w> </span><span class=l>IndexSizeSpike</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>expr</span><span class=p>:</span><span class=w> </span><span class=l>rate(postgres_index_size_bytes[5m]) &gt; 1048576 </span><span class=w> </span><span class=c># 1MB/5min</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>for</span><span class=p>:</span><span class=w> </span><span class=l>15m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class=l>critical</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Index size growing rapidly: {{ $labels.index }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Index {{ $labels.index }} growing at {{ $value | humanize }}B/s&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 낮은 인덱스 히트율</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>alert</span><span class=p>:</span><span class=w> </span><span class=l>LowIndexHitRate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>expr</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          (sum by (index) (rate(postgres_index_scan_count[5m])) / 
</span></span></span><span class=line><span class=cl><span class=sd>           sum by (index) (rate(postgres_table_seq_scan[5m]) + rate(postgres_index_scan_count[5m]))) &lt; 0.5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>for</span><span class=p>:</span><span class=w> </span><span class=l>30m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>severity</span><span class=p>:</span><span class=w> </span><span class=l>warning</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Low index hit rate: {{ $labels.index }}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Index {{ $labels.index }} hit rate is {{ $value | humanizePercentage }}&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=62-보안-및-컴플라이언스-1>6.2 보안 및 컴플라이언스<a hidden class=anchor aria-hidden=true href=#62-보안-및-컴플라이언스-1>#</a></h4><p><strong>무엇을 보안하는가</strong></p><p><strong>인덱스 접근 제어</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-211-1><a class=lnlinks href=#hl-211-1> 1</a>
</span><span class=lnt id=hl-211-2><a class=lnlinks href=#hl-211-2> 2</a>
</span><span class=lnt id=hl-211-3><a class=lnlinks href=#hl-211-3> 3</a>
</span><span class=lnt id=hl-211-4><a class=lnlinks href=#hl-211-4> 4</a>
</span><span class=lnt id=hl-211-5><a class=lnlinks href=#hl-211-5> 5</a>
</span><span class=lnt id=hl-211-6><a class=lnlinks href=#hl-211-6> 6</a>
</span><span class=lnt id=hl-211-7><a class=lnlinks href=#hl-211-7> 7</a>
</span><span class=lnt id=hl-211-8><a class=lnlinks href=#hl-211-8> 8</a>
</span><span class=lnt id=hl-211-9><a class=lnlinks href=#hl-211-9> 9</a>
</span><span class=lnt id=hl-211-10><a class=lnlinks href=#hl-211-10>10</a>
</span><span class=lnt id=hl-211-11><a class=lnlinks href=#hl-211-11>11</a>
</span><span class=lnt id=hl-211-12><a class=lnlinks href=#hl-211-12>12</a>
</span><span class=lnt id=hl-211-13><a class=lnlinks href=#hl-211-13>13</a>
</span><span class=lnt id=hl-211-14><a class=lnlinks href=#hl-211-14>14</a>
</span><span class=lnt id=hl-211-15><a class=lnlinks href=#hl-211-15>15</a>
</span><span class=lnt id=hl-211-16><a class=lnlinks href=#hl-211-16>16</a>
</span><span class=lnt id=hl-211-17><a class=lnlinks href=#hl-211-17>17</a>
</span><span class=lnt id=hl-211-18><a class=lnlinks href=#hl-211-18>18</a>
</span><span class=lnt id=hl-211-19><a class=lnlinks href=#hl-211-19>19</a>
</span><span class=lnt id=hl-211-20><a class=lnlinks href=#hl-211-20>20</a>
</span><span class=lnt id=hl-211-21><a class=lnlinks href=#hl-211-21>21</a>
</span><span class=lnt id=hl-211-22><a class=lnlinks href=#hl-211-22>22</a>
</span><span class=lnt id=hl-211-23><a class=lnlinks href=#hl-211-23>23</a>
</span><span class=lnt id=hl-211-24><a class=lnlinks href=#hl-211-24>24</a>
</span><span class=lnt id=hl-211-25><a class=lnlinks href=#hl-211-25>25</a>
</span><span class=lnt id=hl-211-26><a class=lnlinks href=#hl-211-26>26</a>
</span><span class=lnt id=hl-211-27><a class=lnlinks href=#hl-211-27>27</a>
</span><span class=lnt id=hl-211-28><a class=lnlinks href=#hl-211-28>28</a>
</span><span class=lnt id=hl-211-29><a class=lnlinks href=#hl-211-29>29</a>
</span><span class=lnt id=hl-211-30><a class=lnlinks href=#hl-211-30>30</a>
</span><span class=lnt id=hl-211-31><a class=lnlinks href=#hl-211-31>31</a>
</span><span class=lnt id=hl-211-32><a class=lnlinks href=#hl-211-32>32</a>
</span><span class=lnt id=hl-211-33><a class=lnlinks href=#hl-211-33>33</a>
</span><span class=lnt id=hl-211-34><a class=lnlinks href=#hl-211-34>34</a>
</span><span class=lnt id=hl-211-35><a class=lnlinks href=#hl-211-35>35</a>
</span><span class=lnt id=hl-211-36><a class=lnlinks href=#hl-211-36>36</a>
</span><span class=lnt id=hl-211-37><a class=lnlinks href=#hl-211-37>37</a>
</span><span class=lnt id=hl-211-38><a class=lnlinks href=#hl-211-38>38</a>
</span><span class=lnt id=hl-211-39><a class=lnlinks href=#hl-211-39>39</a>
</span><span class=lnt id=hl-211-40><a class=lnlinks href=#hl-211-40>40</a>
</span><span class=lnt id=hl-211-41><a class=lnlinks href=#hl-211-41>41</a>
</span><span class=lnt id=hl-211-42><a class=lnlinks href=#hl-211-42>42</a>
</span><span class=lnt id=hl-211-43><a class=lnlinks href=#hl-211-43>43</a>
</span><span class=lnt id=hl-211-44><a class=lnlinks href=#hl-211-44>44</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- PostgreSQL 권한 관리
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 1. 인덱스 생성/삭제 권한
</span></span></span><span class=line><span class=cl><span class=c1>-- 테이블 소유자만 인덱스 생성 가능 (기본)
</span></span></span><span class=line><span class=cl><span class=k>GRANT</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>sensitive_data</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>data_admin</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 2. 읽기 전용 사용자 (인덱스 자동 활용)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>ROLE</span><span class=w> </span><span class=n>readonly_user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>GRANT</span><span class=w> </span><span class=k>CONNECT</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>mydb</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>readonly_user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>GRANT</span><span class=w> </span><span class=k>USAGE</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>SCHEMA</span><span class=w> </span><span class=k>public</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>readonly_user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>GRANT</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=n>TABLES</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=k>SCHEMA</span><span class=w> </span><span class=k>public</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>readonly_user</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스는 자동으로 사용됨 (별도 권한 불필요)
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 3. 시스템 카탈로그 접근 제한
</span></span></span><span class=line><span class=cl><span class=k>REVOKE</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>pg_catalog</span><span class=p>.</span><span class=n>pg_index</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>public</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>GRANT</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>pg_catalog</span><span class=p>.</span><span class=n>pg_index</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>dba_role</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 4. 감사 로그 활성화
</span></span></span><span class=line><span class=cl><span class=c1>-- postgresql.conf 설정
</span></span></span><span class=line><span class=cl><span class=c1>-- log_statement = &#39;ddl&#39;  # DDL 문 기록
</span></span></span><span class=line><span class=cl><span class=c1>-- log_line_prefix = &#39;%t [%p]: [%l-1] user=%u,db=%d,app=%a,client=%h &#39;
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 5. Row-Level Security와 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>documents</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>SERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>user_id</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>content</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>classification</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- RLS 정책
</span></span></span><span class=line><span class=cl><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>documents</span><span class=w> </span><span class=n>ENABLE</span><span class=w> </span><span class=k>ROW</span><span class=w> </span><span class=k>LEVEL</span><span class=w> </span><span class=k>SECURITY</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=n>POLICY</span><span class=w> </span><span class=n>user_documents</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>documents</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FOR</span><span class=w> </span><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>USING</span><span class=w> </span><span class=p>(</span><span class=n>user_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>current_user_id</span><span class=p>()</span><span class=w> </span><span class=k>OR</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=n>classification</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;public&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스 (정책 고려)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_user_docs</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>documents</span><span class=p>(</span><span class=n>user_id</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>classification</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=s1>&#39;public&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_public_docs</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>documents</span><span class=p>(</span><span class=n>classification</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>classification</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;public&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>민감 데이터 인덱스 암호화</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-212-1><a class=lnlinks href=#hl-212-1> 1</a>
</span><span class=lnt id=hl-212-2><a class=lnlinks href=#hl-212-2> 2</a>
</span><span class=lnt id=hl-212-3><a class=lnlinks href=#hl-212-3> 3</a>
</span><span class=lnt id=hl-212-4><a class=lnlinks href=#hl-212-4> 4</a>
</span><span class=lnt id=hl-212-5><a class=lnlinks href=#hl-212-5> 5</a>
</span><span class=lnt id=hl-212-6><a class=lnlinks href=#hl-212-6> 6</a>
</span><span class=lnt id=hl-212-7><a class=lnlinks href=#hl-212-7> 7</a>
</span><span class=lnt id=hl-212-8><a class=lnlinks href=#hl-212-8> 8</a>
</span><span class=lnt id=hl-212-9><a class=lnlinks href=#hl-212-9> 9</a>
</span><span class=lnt id=hl-212-10><a class=lnlinks href=#hl-212-10>10</a>
</span><span class=lnt id=hl-212-11><a class=lnlinks href=#hl-212-11>11</a>
</span><span class=lnt id=hl-212-12><a class=lnlinks href=#hl-212-12>12</a>
</span><span class=lnt id=hl-212-13><a class=lnlinks href=#hl-212-13>13</a>
</span><span class=lnt id=hl-212-14><a class=lnlinks href=#hl-212-14>14</a>
</span><span class=lnt id=hl-212-15><a class=lnlinks href=#hl-212-15>15</a>
</span><span class=lnt id=hl-212-16><a class=lnlinks href=#hl-212-16>16</a>
</span><span class=lnt id=hl-212-17><a class=lnlinks href=#hl-212-17>17</a>
</span><span class=lnt id=hl-212-18><a class=lnlinks href=#hl-212-18>18</a>
</span><span class=lnt id=hl-212-19><a class=lnlinks href=#hl-212-19>19</a>
</span><span class=lnt id=hl-212-20><a class=lnlinks href=#hl-212-20>20</a>
</span><span class=lnt id=hl-212-21><a class=lnlinks href=#hl-212-21>21</a>
</span><span class=lnt id=hl-212-22><a class=lnlinks href=#hl-212-22>22</a>
</span><span class=lnt id=hl-212-23><a class=lnlinks href=#hl-212-23>23</a>
</span><span class=lnt id=hl-212-24><a class=lnlinks href=#hl-212-24>24</a>
</span><span class=lnt id=hl-212-25><a class=lnlinks href=#hl-212-25>25</a>
</span><span class=lnt id=hl-212-26><a class=lnlinks href=#hl-212-26>26</a>
</span><span class=lnt id=hl-212-27><a class=lnlinks href=#hl-212-27>27</a>
</span><span class=lnt id=hl-212-28><a class=lnlinks href=#hl-212-28>28</a>
</span><span class=lnt id=hl-212-29><a class=lnlinks href=#hl-212-29>29</a>
</span><span class=lnt id=hl-212-30><a class=lnlinks href=#hl-212-30>30</a>
</span><span class=lnt id=hl-212-31><a class=lnlinks href=#hl-212-31>31</a>
</span><span class=lnt id=hl-212-32><a class=lnlinks href=#hl-212-32>32</a>
</span><span class=lnt id=hl-212-33><a class=lnlinks href=#hl-212-33>33</a>
</span><span class=lnt id=hl-212-34><a class=lnlinks href=#hl-212-34>34</a>
</span><span class=lnt id=hl-212-35><a class=lnlinks href=#hl-212-35>35</a>
</span><span class=lnt id=hl-212-36><a class=lnlinks href=#hl-212-36>36</a>
</span><span class=lnt id=hl-212-37><a class=lnlinks href=#hl-212-37>37</a>
</span><span class=lnt id=hl-212-38><a class=lnlinks href=#hl-212-38>38</a>
</span><span class=lnt id=hl-212-39><a class=lnlinks href=#hl-212-39>39</a>
</span><span class=lnt id=hl-212-40><a class=lnlinks href=#hl-212-40>40</a>
</span><span class=lnt id=hl-212-41><a class=lnlinks href=#hl-212-41>41</a>
</span><span class=lnt id=hl-212-42><a class=lnlinks href=#hl-212-42>42</a>
</span><span class=lnt id=hl-212-43><a class=lnlinks href=#hl-212-43>43</a>
</span><span class=lnt id=hl-212-44><a class=lnlinks href=#hl-212-44>44</a>
</span><span class=lnt id=hl-212-45><a class=lnlinks href=#hl-212-45>45</a>
</span><span class=lnt id=hl-212-46><a class=lnlinks href=#hl-212-46>46</a>
</span><span class=lnt id=hl-212-47><a class=lnlinks href=#hl-212-47>47</a>
</span><span class=lnt id=hl-212-48><a class=lnlinks href=#hl-212-48>48</a>
</span><span class=lnt id=hl-212-49><a class=lnlinks href=#hl-212-49>49</a>
</span><span class=lnt id=hl-212-50><a class=lnlinks href=#hl-212-50>50</a>
</span><span class=lnt id=hl-212-51><a class=lnlinks href=#hl-212-51>51</a>
</span><span class=lnt id=hl-212-52><a class=lnlinks href=#hl-212-52>52</a>
</span><span class=lnt id=hl-212-53><a class=lnlinks href=#hl-212-53>53</a>
</span><span class=lnt id=hl-212-54><a class=lnlinks href=#hl-212-54>54</a>
</span><span class=lnt id=hl-212-55><a class=lnlinks href=#hl-212-55>55</a>
</span><span class=lnt id=hl-212-56><a class=lnlinks href=#hl-212-56>56</a>
</span><span class=lnt id=hl-212-57><a class=lnlinks href=#hl-212-57>57</a>
</span><span class=lnt id=hl-212-58><a class=lnlinks href=#hl-212-58>58</a>
</span><span class=lnt id=hl-212-59><a class=lnlinks href=#hl-212-59>59</a>
</span><span class=lnt id=hl-212-60><a class=lnlinks href=#hl-212-60>60</a>
</span><span class=lnt id=hl-212-61><a class=lnlinks href=#hl-212-61>61</a>
</span><span class=lnt id=hl-212-62><a class=lnlinks href=#hl-212-62>62</a>
</span><span class=lnt id=hl-212-63><a class=lnlinks href=#hl-212-63>63</a>
</span><span class=lnt id=hl-212-64><a class=lnlinks href=#hl-212-64>64</a>
</span><span class=lnt id=hl-212-65><a class=lnlinks href=#hl-212-65>65</a>
</span><span class=lnt id=hl-212-66><a class=lnlinks href=#hl-212-66>66</a>
</span><span class=lnt id=hl-212-67><a class=lnlinks href=#hl-212-67>67</a>
</span><span class=lnt id=hl-212-68><a class=lnlinks href=#hl-212-68>68</a>
</span><span class=lnt id=hl-212-69><a class=lnlinks href=#hl-212-69>69</a>
</span><span class=lnt id=hl-212-70><a class=lnlinks href=#hl-212-70>70</a>
</span><span class=lnt id=hl-212-71><a class=lnlinks href=#hl-212-71>71</a>
</span><span class=lnt id=hl-212-72><a class=lnlinks href=#hl-212-72>72</a>
</span><span class=lnt id=hl-212-73><a class=lnlinks href=#hl-212-73>73</a>
</span><span class=lnt id=hl-212-74><a class=lnlinks href=#hl-212-74>74</a>
</span><span class=lnt id=hl-212-75><a class=lnlinks href=#hl-212-75>75</a>
</span><span class=lnt id=hl-212-76><a class=lnlinks href=#hl-212-76>76</a>
</span><span class=lnt id=hl-212-77><a class=lnlinks href=#hl-212-77>77</a>
</span><span class=lnt id=hl-212-78><a class=lnlinks href=#hl-212-78>78</a>
</span><span class=lnt id=hl-212-79><a class=lnlinks href=#hl-212-79>79</a>
</span><span class=lnt id=hl-212-80><a class=lnlinks href=#hl-212-80>80</a>
</span><span class=lnt id=hl-212-81><a class=lnlinks href=#hl-212-81>81</a>
</span><span class=lnt id=hl-212-82><a class=lnlinks href=#hl-212-82>82</a>
</span><span class=lnt id=hl-212-83><a class=lnlinks href=#hl-212-83>83</a>
</span><span class=lnt id=hl-212-84><a class=lnlinks href=#hl-212-84>84</a>
</span><span class=lnt id=hl-212-85><a class=lnlinks href=#hl-212-85>85</a>
</span><span class=lnt id=hl-212-86><a class=lnlinks href=#hl-212-86>86</a>
</span><span class=lnt id=hl-212-87><a class=lnlinks href=#hl-212-87>87</a>
</span><span class=lnt id=hl-212-88><a class=lnlinks href=#hl-212-88>88</a>
</span><span class=lnt id=hl-212-89><a class=lnlinks href=#hl-212-89>89</a>
</span><span class=lnt id=hl-212-90><a class=lnlinks href=#hl-212-90>90</a>
</span><span class=lnt id=hl-212-91><a class=lnlinks href=#hl-212-91>91</a>
</span><span class=lnt id=hl-212-92><a class=lnlinks href=#hl-212-92>92</a>
</span><span class=lnt id=hl-212-93><a class=lnlinks href=#hl-212-93>93</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>cryptography.fernet</span> <span class=kn>import</span> <span class=n>Fernet</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>EncryptedIndex</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;민감 데이터 인덱스 암호화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>encryption_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>cipher</span> <span class=o>=</span> <span class=n>Fernet</span><span class=p>(</span><span class=n>encryption_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_hashed_index</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>conn</span><span class=p>,</span> <span class=n>table</span><span class=p>,</span> <span class=n>column</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;해시 기반 인덱스 생성 (검색 가능, 복호화 불가)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. 해시 컬럼 추가</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            ALTER TABLE </span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>            ADD COLUMN </span><span class=si>{</span><span class=n>column</span><span class=si>}</span><span class=s2>_hash VARCHAR(64)
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. 해시 값 계산 및 저장</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            UPDATE </span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>            SET </span><span class=si>{</span><span class=n>column</span><span class=si>}</span><span class=s2>_hash = encode(
</span></span></span><span class=line><span class=cl><span class=s2>                digest(</span><span class=si>{</span><span class=n>column</span><span class=si>}</span><span class=s2>::text || &#39;salt_value&#39;, &#39;sha256&#39;),
</span></span></span><span class=line><span class=cl><span class=s2>                &#39;hex&#39;
</span></span></span><span class=line><span class=cl><span class=s2>            )
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. 해시 컬럼에 인덱스 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            CREATE INDEX idx_</span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>column</span><span class=si>}</span><span class=s2>_hash 
</span></span></span><span class=line><span class=cl><span class=s2>            ON </span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2>(</span><span class=si>{</span><span class=n>column</span><span class=si>}</span><span class=s2>_hash)
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Hashed index created on </span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2>.</span><span class=si>{</span><span class=n>column</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>search_by_hash</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>conn</span><span class=p>,</span> <span class=n>table</span><span class=p>,</span> <span class=n>column</span><span class=p>,</span> <span class=n>search_value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;해시로 검색&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 검색 값 해시 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>hash_value</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=n>search_value</span> <span class=o>+</span> <span class=s1>&#39;salt_value&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 해시로 조회</span>
</span></span><span class=line><span class=cl>        <span class=n>query</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            SELECT * FROM </span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>            WHERE </span><span class=si>{</span><span class=n>column</span><span class=si>}</span><span class=s2>_hash = %s
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>conn</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=p>(</span><span class=n>hash_value</span><span class=p>,))</span><span class=o>.</span><span class=n>fetchall</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_encrypted_index</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>conn</span><span class=p>,</span> <span class=n>table</span><span class=p>,</span> <span class=n>column</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;암호화 인덱스 (검색 가능, 복호화 가능)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. 암호화 컬럼 추가</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            ALTER TABLE </span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>            ADD COLUMN </span><span class=si>{</span><span class=n>column</span><span class=si>}</span><span class=s2>_encrypted BYTEA
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. 데이터 암호화</span>
</span></span><span class=line><span class=cl>        <span class=n>rows</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;SELECT id, </span><span class=si>{</span><span class=n>column</span><span class=si>}</span><span class=s2> FROM </span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>fetchall</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>row_id</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>rows</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>value</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>encrypted</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>cipher</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>value</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>                <span class=n>conn</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=sa>f</span><span class=s2>&#34;UPDATE </span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2> SET </span><span class=si>{</span><span class=n>column</span><span class=si>}</span><span class=s2>_encrypted = %s WHERE id = %s&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=n>encrypted</span><span class=p>,</span> <span class=n>row_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. 암호화 컬럼 인덱스</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            CREATE INDEX idx_</span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>column</span><span class=si>}</span><span class=s2>_enc 
</span></span></span><span class=line><span class=cl><span class=s2>            ON </span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2>(</span><span class=si>{</span><span class=n>column</span><span class=si>}</span><span class=s2>_encrypted)
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Encrypted index created on </span><span class=si>{</span><span class=n>table</span><span class=si>}</span><span class=s2>.</span><span class=si>{</span><span class=n>column</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>decrypt_result</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>encrypted_value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;결과 복호화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>encrypted_value</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>cipher</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>encrypted_value</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=c1># 암호화 키 생성 (안전하게 관리 필요)</span>
</span></span><span class=line><span class=cl><span class=n>encryption_key</span> <span class=o>=</span> <span class=n>Fernet</span><span class=o>.</span><span class=n>generate_key</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>enc_index</span> <span class=o>=</span> <span class=n>EncryptedIndex</span><span class=p>(</span><span class=n>encryption_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 해시 인덱스 (SSN, 신용카드 등)</span>
</span></span><span class=line><span class=cl><span class=n>enc_index</span><span class=o>.</span><span class=n>create_hashed_index</span><span class=p>(</span><span class=n>conn</span><span class=p>,</span> <span class=s1>&#39;users&#39;</span><span class=p>,</span> <span class=s1>&#39;ssn&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 검색</span>
</span></span><span class=line><span class=cl><span class=n>results</span> <span class=o>=</span> <span class=n>enc_index</span><span class=o>.</span><span class=n>search_by_hash</span><span class=p>(</span><span class=n>conn</span><span class=p>,</span> <span class=s1>&#39;users&#39;</span><span class=p>,</span> <span class=s1>&#39;ssn&#39;</span><span class=p>,</span> <span class=s1>&#39;123-45-6789&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>감사 추적 (Audit Trail)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-213-1><a class=lnlinks href=#hl-213-1> 1</a>
</span><span class=lnt id=hl-213-2><a class=lnlinks href=#hl-213-2> 2</a>
</span><span class=lnt id=hl-213-3><a class=lnlinks href=#hl-213-3> 3</a>
</span><span class=lnt id=hl-213-4><a class=lnlinks href=#hl-213-4> 4</a>
</span><span class=lnt id=hl-213-5><a class=lnlinks href=#hl-213-5> 5</a>
</span><span class=lnt id=hl-213-6><a class=lnlinks href=#hl-213-6> 6</a>
</span><span class=lnt id=hl-213-7><a class=lnlinks href=#hl-213-7> 7</a>
</span><span class=lnt id=hl-213-8><a class=lnlinks href=#hl-213-8> 8</a>
</span><span class=lnt id=hl-213-9><a class=lnlinks href=#hl-213-9> 9</a>
</span><span class=lnt id=hl-213-10><a class=lnlinks href=#hl-213-10>10</a>
</span><span class=lnt id=hl-213-11><a class=lnlinks href=#hl-213-11>11</a>
</span><span class=lnt id=hl-213-12><a class=lnlinks href=#hl-213-12>12</a>
</span><span class=lnt id=hl-213-13><a class=lnlinks href=#hl-213-13>13</a>
</span><span class=lnt id=hl-213-14><a class=lnlinks href=#hl-213-14>14</a>
</span><span class=lnt id=hl-213-15><a class=lnlinks href=#hl-213-15>15</a>
</span><span class=lnt id=hl-213-16><a class=lnlinks href=#hl-213-16>16</a>
</span><span class=lnt id=hl-213-17><a class=lnlinks href=#hl-213-17>17</a>
</span><span class=lnt id=hl-213-18><a class=lnlinks href=#hl-213-18>18</a>
</span><span class=lnt id=hl-213-19><a class=lnlinks href=#hl-213-19>19</a>
</span><span class=lnt id=hl-213-20><a class=lnlinks href=#hl-213-20>20</a>
</span><span class=lnt id=hl-213-21><a class=lnlinks href=#hl-213-21>21</a>
</span><span class=lnt id=hl-213-22><a class=lnlinks href=#hl-213-22>22</a>
</span><span class=lnt id=hl-213-23><a class=lnlinks href=#hl-213-23>23</a>
</span><span class=lnt id=hl-213-24><a class=lnlinks href=#hl-213-24>24</a>
</span><span class=lnt id=hl-213-25><a class=lnlinks href=#hl-213-25>25</a>
</span><span class=lnt id=hl-213-26><a class=lnlinks href=#hl-213-26>26</a>
</span><span class=lnt id=hl-213-27><a class=lnlinks href=#hl-213-27>27</a>
</span><span class=lnt id=hl-213-28><a class=lnlinks href=#hl-213-28>28</a>
</span><span class=lnt id=hl-213-29><a class=lnlinks href=#hl-213-29>29</a>
</span><span class=lnt id=hl-213-30><a class=lnlinks href=#hl-213-30>30</a>
</span><span class=lnt id=hl-213-31><a class=lnlinks href=#hl-213-31>31</a>
</span><span class=lnt id=hl-213-32><a class=lnlinks href=#hl-213-32>32</a>
</span><span class=lnt id=hl-213-33><a class=lnlinks href=#hl-213-33>33</a>
</span><span class=lnt id=hl-213-34><a class=lnlinks href=#hl-213-34>34</a>
</span><span class=lnt id=hl-213-35><a class=lnlinks href=#hl-213-35>35</a>
</span><span class=lnt id=hl-213-36><a class=lnlinks href=#hl-213-36>36</a>
</span><span class=lnt id=hl-213-37><a class=lnlinks href=#hl-213-37>37</a>
</span><span class=lnt id=hl-213-38><a class=lnlinks href=#hl-213-38>38</a>
</span><span class=lnt id=hl-213-39><a class=lnlinks href=#hl-213-39>39</a>
</span><span class=lnt id=hl-213-40><a class=lnlinks href=#hl-213-40>40</a>
</span><span class=lnt id=hl-213-41><a class=lnlinks href=#hl-213-41>41</a>
</span><span class=lnt id=hl-213-42><a class=lnlinks href=#hl-213-42>42</a>
</span><span class=lnt id=hl-213-43><a class=lnlinks href=#hl-213-43>43</a>
</span><span class=lnt id=hl-213-44><a class=lnlinks href=#hl-213-44>44</a>
</span><span class=lnt id=hl-213-45><a class=lnlinks href=#hl-213-45>45</a>
</span><span class=lnt id=hl-213-46><a class=lnlinks href=#hl-213-46>46</a>
</span><span class=lnt id=hl-213-47><a class=lnlinks href=#hl-213-47>47</a>
</span><span class=lnt id=hl-213-48><a class=lnlinks href=#hl-213-48>48</a>
</span><span class=lnt id=hl-213-49><a class=lnlinks href=#hl-213-49>49</a>
</span><span class=lnt id=hl-213-50><a class=lnlinks href=#hl-213-50>50</a>
</span><span class=lnt id=hl-213-51><a class=lnlinks href=#hl-213-51>51</a>
</span><span class=lnt id=hl-213-52><a class=lnlinks href=#hl-213-52>52</a>
</span><span class=lnt id=hl-213-53><a class=lnlinks href=#hl-213-53>53</a>
</span><span class=lnt id=hl-213-54><a class=lnlinks href=#hl-213-54>54</a>
</span><span class=lnt id=hl-213-55><a class=lnlinks href=#hl-213-55>55</a>
</span><span class=lnt id=hl-213-56><a class=lnlinks href=#hl-213-56>56</a>
</span><span class=lnt id=hl-213-57><a class=lnlinks href=#hl-213-57>57</a>
</span><span class=lnt id=hl-213-58><a class=lnlinks href=#hl-213-58>58</a>
</span><span class=lnt id=hl-213-59><a class=lnlinks href=#hl-213-59>59</a>
</span><span class=lnt id=hl-213-60><a class=lnlinks href=#hl-213-60>60</a>
</span><span class=lnt id=hl-213-61><a class=lnlinks href=#hl-213-61>61</a>
</span><span class=lnt id=hl-213-62><a class=lnlinks href=#hl-213-62>62</a>
</span><span class=lnt id=hl-213-63><a class=lnlinks href=#hl-213-63>63</a>
</span><span class=lnt id=hl-213-64><a class=lnlinks href=#hl-213-64>64</a>
</span><span class=lnt id=hl-213-65><a class=lnlinks href=#hl-213-65>65</a>
</span><span class=lnt id=hl-213-66><a class=lnlinks href=#hl-213-66>66</a>
</span><span class=lnt id=hl-213-67><a class=lnlinks href=#hl-213-67>67</a>
</span><span class=lnt id=hl-213-68><a class=lnlinks href=#hl-213-68>68</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 인덱스 변경 이력 추적
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 1. 감사 테이블 생성
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>index_audit_log</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>audit_id</span><span class=w> </span><span class=nb>SERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>event_time</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>CURRENT_TIMESTAMP</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>user_name</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>event_type</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>),</span><span class=w> </span><span class=c1>-- &#39;CREATE&#39;, &#39;DROP&#39;, &#39;REINDEX&#39;
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>schema_name</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>table_name</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>index_name</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>index_definition</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>client_addr</span><span class=w> </span><span class=n>INET</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>application_name</span><span class=w> </span><span class=nb>TEXT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 2. 트리거 함수 (PostgreSQL 13+ Event Trigger)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=k>REPLACE</span><span class=w> </span><span class=k>FUNCTION</span><span class=w> </span><span class=n>log_index_changes</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>RETURNS</span><span class=w> </span><span class=n>event_trigger</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>LANGUAGE</span><span class=w> </span><span class=n>plpgsql</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>AS</span><span class=w> </span><span class=err>$$</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>DECLARE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>obj</span><span class=w> </span><span class=n>record</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>BEGIN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FOR</span><span class=w> </span><span class=n>obj</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>pg_event_trigger_ddl_commands</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>LOOP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>IF</span><span class=w> </span><span class=n>obj</span><span class=p>.</span><span class=n>object_type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;index&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>index_audit_log</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>user_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>event_type</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>schema_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>table_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>index_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>index_definition</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>client_addr</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>application_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>current_user</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>TG_TAG</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>obj</span><span class=p>.</span><span class=k>schema_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>obj</span><span class=p>.</span><span class=n>object_identity</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>obj</span><span class=p>.</span><span class=n>object_identity</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>obj</span><span class=p>.</span><span class=n>command_tag</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>inet_client_addr</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>current_setting</span><span class=p>(</span><span class=s1>&#39;application_name&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>END</span><span class=w> </span><span class=k>IF</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>END</span><span class=w> </span><span class=n>LOOP</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>END</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=err>$$</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 3. 이벤트 트리거 생성
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=n>EVENT</span><span class=w> </span><span class=k>TRIGGER</span><span class=w> </span><span class=n>index_create_trigger</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ON</span><span class=w> </span><span class=n>ddl_command_end</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHEN</span><span class=w> </span><span class=n>TAG</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;CREATE INDEX&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;DROP INDEX&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;REINDEX&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>EXECUTE</span><span class=w> </span><span class=k>FUNCTION</span><span class=w> </span><span class=n>log_index_changes</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 4. 감사 로그 조회
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>event_time</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>user_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>event_type</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>table_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>index_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>client_addr</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>index_audit_log</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>event_time</span><span class=w> </span><span class=k>DESC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>LIMIT</span><span class=w> </span><span class=mi>100</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>컴플라이언스 체크리스트</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-214-1><a class=lnlinks href=#hl-214-1> 1</a>
</span><span class=lnt id=hl-214-2><a class=lnlinks href=#hl-214-2> 2</a>
</span><span class=lnt id=hl-214-3><a class=lnlinks href=#hl-214-3> 3</a>
</span><span class=lnt id=hl-214-4><a class=lnlinks href=#hl-214-4> 4</a>
</span><span class=lnt id=hl-214-5><a class=lnlinks href=#hl-214-5> 5</a>
</span><span class=lnt id=hl-214-6><a class=lnlinks href=#hl-214-6> 6</a>
</span><span class=lnt id=hl-214-7><a class=lnlinks href=#hl-214-7> 7</a>
</span><span class=lnt id=hl-214-8><a class=lnlinks href=#hl-214-8> 8</a>
</span><span class=lnt id=hl-214-9><a class=lnlinks href=#hl-214-9> 9</a>
</span><span class=lnt id=hl-214-10><a class=lnlinks href=#hl-214-10>10</a>
</span><span class=lnt id=hl-214-11><a class=lnlinks href=#hl-214-11>11</a>
</span><span class=lnt id=hl-214-12><a class=lnlinks href=#hl-214-12>12</a>
</span><span class=lnt id=hl-214-13><a class=lnlinks href=#hl-214-13>13</a>
</span><span class=lnt id=hl-214-14><a class=lnlinks href=#hl-214-14>14</a>
</span><span class=lnt id=hl-214-15><a class=lnlinks href=#hl-214-15>15</a>
</span><span class=lnt id=hl-214-16><a class=lnlinks href=#hl-214-16>16</a>
</span><span class=lnt id=hl-214-17><a class=lnlinks href=#hl-214-17>17</a>
</span><span class=lnt id=hl-214-18><a class=lnlinks href=#hl-214-18>18</a>
</span><span class=lnt id=hl-214-19><a class=lnlinks href=#hl-214-19>19</a>
</span><span class=lnt id=hl-214-20><a class=lnlinks href=#hl-214-20>20</a>
</span><span class=lnt id=hl-214-21><a class=lnlinks href=#hl-214-21>21</a>
</span><span class=lnt id=hl-214-22><a class=lnlinks href=#hl-214-22>22</a>
</span><span class=lnt id=hl-214-23><a class=lnlinks href=#hl-214-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>GDPR (개인정보 보호):
</span></span><span class=line><span class=cl>✓ 개인정보 컬럼 인덱스 암호화
</span></span><span class=line><span class=cl>✓ 삭제 요청 시 인덱스도 삭제
</span></span><span class=line><span class=cl>✓ 인덱스 접근 로그 기록
</span></span><span class=line><span class=cl>✓ 데이터 최소화 (필요한 컬럼만 인덱싱)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HIPAA (의료정보):
</span></span><span class=line><span class=cl>✓ PHI(개인건강정보) 인덱스 암호화
</span></span><span class=line><span class=cl>✓ 접근 제어 및 감사
</span></span><span class=line><span class=cl>✓ 백업 시 인덱스 포함
</span></span><span class=line><span class=cl>✓ 전송 시 TLS 사용
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PCI-DSS (결제정보):
</span></span><span class=line><span class=cl>✓ 카드번호 해시 인덱스만 사용
</span></span><span class=line><span class=cl>✓ 실제 카드번호 인덱싱 금지
</span></span><span class=line><span class=cl>✓ 정기적 취약점 스캔
</span></span><span class=line><span class=cl>✓ 강력한 접근 제어
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>SOX (재무보고):
</span></span><span class=line><span class=cl>✓ 인덱스 변경 이력 보관
</span></span><span class=line><span class=cl>✓ 승인된 변경만 허용
</span></span><span class=line><span class=cl>✓ 정기적 감사
</span></span><span class=line><span class=cl>✓ 무결성 검증
</span></span></code></pre></td></tr></table></div></div><h4 id=63-성능-최적화-및-확장성-1>6.3 성능 최적화 및 확장성<a hidden class=anchor aria-hidden=true href=#63-성능-최적화-및-확장성-1>#</a></h4><p><strong>무엇을 최적화하는가</strong></p><p><strong>쿼리 실행 계획 최적화</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-215-1><a class=lnlinks href=#hl-215-1> 1</a>
</span><span class=lnt id=hl-215-2><a class=lnlinks href=#hl-215-2> 2</a>
</span><span class=lnt id=hl-215-3><a class=lnlinks href=#hl-215-3> 3</a>
</span><span class=lnt id=hl-215-4><a class=lnlinks href=#hl-215-4> 4</a>
</span><span class=lnt id=hl-215-5><a class=lnlinks href=#hl-215-5> 5</a>
</span><span class=lnt id=hl-215-6><a class=lnlinks href=#hl-215-6> 6</a>
</span><span class=lnt id=hl-215-7><a class=lnlinks href=#hl-215-7> 7</a>
</span><span class=lnt id=hl-215-8><a class=lnlinks href=#hl-215-8> 8</a>
</span><span class=lnt id=hl-215-9><a class=lnlinks href=#hl-215-9> 9</a>
</span><span class=lnt id=hl-215-10><a class=lnlinks href=#hl-215-10>10</a>
</span><span class=lnt id=hl-215-11><a class=lnlinks href=#hl-215-11>11</a>
</span><span class=lnt id=hl-215-12><a class=lnlinks href=#hl-215-12>12</a>
</span><span class=lnt id=hl-215-13><a class=lnlinks href=#hl-215-13>13</a>
</span><span class=lnt id=hl-215-14><a class=lnlinks href=#hl-215-14>14</a>
</span><span class=lnt id=hl-215-15><a class=lnlinks href=#hl-215-15>15</a>
</span><span class=lnt id=hl-215-16><a class=lnlinks href=#hl-215-16>16</a>
</span><span class=lnt id=hl-215-17><a class=lnlinks href=#hl-215-17>17</a>
</span><span class=lnt id=hl-215-18><a class=lnlinks href=#hl-215-18>18</a>
</span><span class=lnt id=hl-215-19><a class=lnlinks href=#hl-215-19>19</a>
</span><span class=lnt id=hl-215-20><a class=lnlinks href=#hl-215-20>20</a>
</span><span class=lnt id=hl-215-21><a class=lnlinks href=#hl-215-21>21</a>
</span><span class=lnt id=hl-215-22><a class=lnlinks href=#hl-215-22>22</a>
</span><span class=lnt id=hl-215-23><a class=lnlinks href=#hl-215-23>23</a>
</span><span class=lnt id=hl-215-24><a class=lnlinks href=#hl-215-24>24</a>
</span><span class=lnt id=hl-215-25><a class=lnlinks href=#hl-215-25>25</a>
</span><span class=lnt id=hl-215-26><a class=lnlinks href=#hl-215-26>26</a>
</span><span class=lnt id=hl-215-27><a class=lnlinks href=#hl-215-27>27</a>
</span><span class=lnt id=hl-215-28><a class=lnlinks href=#hl-215-28>28</a>
</span><span class=lnt id=hl-215-29><a class=lnlinks href=#hl-215-29>29</a>
</span><span class=lnt id=hl-215-30><a class=lnlinks href=#hl-215-30>30</a>
</span><span class=lnt id=hl-215-31><a class=lnlinks href=#hl-215-31>31</a>
</span><span class=lnt id=hl-215-32><a class=lnlinks href=#hl-215-32>32</a>
</span><span class=lnt id=hl-215-33><a class=lnlinks href=#hl-215-33>33</a>
</span><span class=lnt id=hl-215-34><a class=lnlinks href=#hl-215-34>34</a>
</span><span class=lnt id=hl-215-35><a class=lnlinks href=#hl-215-35>35</a>
</span><span class=lnt id=hl-215-36><a class=lnlinks href=#hl-215-36>36</a>
</span><span class=lnt id=hl-215-37><a class=lnlinks href=#hl-215-37>37</a>
</span><span class=lnt id=hl-215-38><a class=lnlinks href=#hl-215-38>38</a>
</span><span class=lnt id=hl-215-39><a class=lnlinks href=#hl-215-39>39</a>
</span><span class=lnt id=hl-215-40><a class=lnlinks href=#hl-215-40>40</a>
</span><span class=lnt id=hl-215-41><a class=lnlinks href=#hl-215-41>41</a>
</span><span class=lnt id=hl-215-42><a class=lnlinks href=#hl-215-42>42</a>
</span><span class=lnt id=hl-215-43><a class=lnlinks href=#hl-215-43>43</a>
</span><span class=lnt id=hl-215-44><a class=lnlinks href=#hl-215-44>44</a>
</span><span class=lnt id=hl-215-45><a class=lnlinks href=#hl-215-45>45</a>
</span><span class=lnt id=hl-215-46><a class=lnlinks href=#hl-215-46>46</a>
</span><span class=lnt id=hl-215-47><a class=lnlinks href=#hl-215-47>47</a>
</span><span class=lnt id=hl-215-48><a class=lnlinks href=#hl-215-48>48</a>
</span><span class=lnt id=hl-215-49><a class=lnlinks href=#hl-215-49>49</a>
</span><span class=lnt id=hl-215-50><a class=lnlinks href=#hl-215-50>50</a>
</span><span class=lnt id=hl-215-51><a class=lnlinks href=#hl-215-51>51</a>
</span><span class=lnt id=hl-215-52><a class=lnlinks href=#hl-215-52>52</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 1. 비효율적인 인덱스 사용 패턴 탐지
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 함수 사용으로 인한 인덱스 미사용
</span></span></span><span class=line><span class=cl><span class=c1>-- Bad
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>UPPER</span><span class=p>(</span><span class=n>email</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;USER@EXAMPLE.COM&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스 미사용 (함수 적용)
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- Good: 함수 인덱스 생성
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_users_email_upper</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>users</span><span class=p>(</span><span class=k>UPPER</span><span class=p>(</span><span class=n>email</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 또는 대소문자 구분 없는 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_users_email_lower</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>users</span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>email</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>LOWER</span><span class=p>(</span><span class=n>email</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;user@example.com&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 2. 암묵적 형변환 방지
</span></span></span><span class=line><span class=cl><span class=c1>-- Bad
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span><span class=n>order_id</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>50</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_order_id</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>order_id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>order_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>12345</span><span class=p>;</span><span class=w>  </span><span class=c1>-- 숫자로 비교
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스 미사용 (형변환 발생)
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- Good
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>order_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;12345&#39;</span><span class=p>;</span><span class=w>  </span><span class=c1>-- 문자열로 비교
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 3. OR 조건 최적화
</span></span></span><span class=line><span class=cl><span class=c1>-- Bad
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;electronics&#39;</span><span class=w> </span><span class=k>OR</span><span class=w> </span><span class=n>category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;computers&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스 비효율
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- Good: IN 사용
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>category</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;electronics&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;computers&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 또는 UNION
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;electronics&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>category</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;computers&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 4. 부정 조건 최적화
</span></span></span><span class=line><span class=cl><span class=c1>-- Bad
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=s1>&#39;cancelled&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 인덱스 비효율 (대부분 반환)
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- Good: 긍정 조건으로 변환
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;pending&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;processing&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;completed&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;shipped&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 또는 부분 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_active_orders</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>order_id</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=s1>&#39;cancelled&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>인덱스 힌트 활용</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-216-1><a class=lnlinks href=#hl-216-1> 1</a>
</span><span class=lnt id=hl-216-2><a class=lnlinks href=#hl-216-2> 2</a>
</span><span class=lnt id=hl-216-3><a class=lnlinks href=#hl-216-3> 3</a>
</span><span class=lnt id=hl-216-4><a class=lnlinks href=#hl-216-4> 4</a>
</span><span class=lnt id=hl-216-5><a class=lnlinks href=#hl-216-5> 5</a>
</span><span class=lnt id=hl-216-6><a class=lnlinks href=#hl-216-6> 6</a>
</span><span class=lnt id=hl-216-7><a class=lnlinks href=#hl-216-7> 7</a>
</span><span class=lnt id=hl-216-8><a class=lnlinks href=#hl-216-8> 8</a>
</span><span class=lnt id=hl-216-9><a class=lnlinks href=#hl-216-9> 9</a>
</span><span class=lnt id=hl-216-10><a class=lnlinks href=#hl-216-10>10</a>
</span><span class=lnt id=hl-216-11><a class=lnlinks href=#hl-216-11>11</a>
</span><span class=lnt id=hl-216-12><a class=lnlinks href=#hl-216-12>12</a>
</span><span class=lnt id=hl-216-13><a class=lnlinks href=#hl-216-13>13</a>
</span><span class=lnt id=hl-216-14><a class=lnlinks href=#hl-216-14>14</a>
</span><span class=lnt id=hl-216-15><a class=lnlinks href=#hl-216-15>15</a>
</span><span class=lnt id=hl-216-16><a class=lnlinks href=#hl-216-16>16</a>
</span><span class=lnt id=hl-216-17><a class=lnlinks href=#hl-216-17>17</a>
</span><span class=lnt id=hl-216-18><a class=lnlinks href=#hl-216-18>18</a>
</span><span class=lnt id=hl-216-19><a class=lnlinks href=#hl-216-19>19</a>
</span><span class=lnt id=hl-216-20><a class=lnlinks href=#hl-216-20>20</a>
</span><span class=lnt id=hl-216-21><a class=lnlinks href=#hl-216-21>21</a>
</span><span class=lnt id=hl-216-22><a class=lnlinks href=#hl-216-22>22</a>
</span><span class=lnt id=hl-216-23><a class=lnlinks href=#hl-216-23>23</a>
</span><span class=lnt id=hl-216-24><a class=lnlinks href=#hl-216-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- PostgreSQL: 통계 조정으로 힌트 효과
</span></span></span><span class=line><span class=cl><span class=c1>-- 옵티마이저가 잘못된 인덱스 선택 시
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 방법 1: 통계 타겟 증가
</span></span></span><span class=line><span class=cl><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>large_table</span><span class=w> </span><span class=k>ALTER</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>search_col</span><span class=w> </span><span class=k>SET</span><span class=w> </span><span class=k>STATISTICS</span><span class=w> </span><span class=mi>1000</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ANALYZE</span><span class=w> </span><span class=n>large_table</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 방법 2: 플랜 비용 조정
</span></span></span><span class=line><span class=cl><span class=k>SET</span><span class=w> </span><span class=n>random_page_cost</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>.</span><span class=mi>1</span><span class=p>;</span><span class=w>  </span><span class=c1>-- SSD 환경
</span></span></span><span class=line><span class=cl><span class=k>SET</span><span class=w> </span><span class=n>effective_cache_size</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;8GB&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- MySQL: 인덱스 힌트 직접 지정
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=n>USE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=p>(</span><span class=n>idx_customer_date</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5000</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>order_date</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 또는 강제 인덱스
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>FORCE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=p>(</span><span class=n>idx_customer_date</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5000</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- Oracle: 힌트 주석
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=cm>/*+ INDEX(orders idx_customer_date) */</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>customer_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5000</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>병렬 인덱스 스캔</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-217-1><a class=lnlinks href=#hl-217-1> 1</a>
</span><span class=lnt id=hl-217-2><a class=lnlinks href=#hl-217-2> 2</a>
</span><span class=lnt id=hl-217-3><a class=lnlinks href=#hl-217-3> 3</a>
</span><span class=lnt id=hl-217-4><a class=lnlinks href=#hl-217-4> 4</a>
</span><span class=lnt id=hl-217-5><a class=lnlinks href=#hl-217-5> 5</a>
</span><span class=lnt id=hl-217-6><a class=lnlinks href=#hl-217-6> 6</a>
</span><span class=lnt id=hl-217-7><a class=lnlinks href=#hl-217-7> 7</a>
</span><span class=lnt id=hl-217-8><a class=lnlinks href=#hl-217-8> 8</a>
</span><span class=lnt id=hl-217-9><a class=lnlinks href=#hl-217-9> 9</a>
</span><span class=lnt id=hl-217-10><a class=lnlinks href=#hl-217-10>10</a>
</span><span class=lnt id=hl-217-11><a class=lnlinks href=#hl-217-11>11</a>
</span><span class=lnt id=hl-217-12><a class=lnlinks href=#hl-217-12>12</a>
</span><span class=lnt id=hl-217-13><a class=lnlinks href=#hl-217-13>13</a>
</span><span class=lnt id=hl-217-14><a class=lnlinks href=#hl-217-14>14</a>
</span><span class=lnt id=hl-217-15><a class=lnlinks href=#hl-217-15>15</a>
</span><span class=lnt id=hl-217-16><a class=lnlinks href=#hl-217-16>16</a>
</span><span class=lnt id=hl-217-17><a class=lnlinks href=#hl-217-17>17</a>
</span><span class=lnt id=hl-217-18><a class=lnlinks href=#hl-217-18>18</a>
</span><span class=lnt id=hl-217-19><a class=lnlinks href=#hl-217-19>19</a>
</span><span class=lnt id=hl-217-20><a class=lnlinks href=#hl-217-20>20</a>
</span><span class=lnt id=hl-217-21><a class=lnlinks href=#hl-217-21>21</a>
</span><span class=lnt id=hl-217-22><a class=lnlinks href=#hl-217-22>22</a>
</span><span class=lnt id=hl-217-23><a class=lnlinks href=#hl-217-23>23</a>
</span><span class=lnt id=hl-217-24><a class=lnlinks href=#hl-217-24>24</a>
</span><span class=lnt id=hl-217-25><a class=lnlinks href=#hl-217-25>25</a>
</span><span class=lnt id=hl-217-26><a class=lnlinks href=#hl-217-26>26</a>
</span><span class=lnt id=hl-217-27><a class=lnlinks href=#hl-217-27>27</a>
</span><span class=lnt id=hl-217-28><a class=lnlinks href=#hl-217-28>28</a>
</span><span class=lnt id=hl-217-29><a class=lnlinks href=#hl-217-29>29</a>
</span><span class=lnt id=hl-217-30><a class=lnlinks href=#hl-217-30>30</a>
</span><span class=lnt id=hl-217-31><a class=lnlinks href=#hl-217-31>31</a>
</span><span class=lnt id=hl-217-32><a class=lnlinks href=#hl-217-32>32</a>
</span><span class=lnt id=hl-217-33><a class=lnlinks href=#hl-217-33>33</a>
</span><span class=lnt id=hl-217-34><a class=lnlinks href=#hl-217-34>34</a>
</span><span class=lnt id=hl-217-35><a class=lnlinks href=#hl-217-35>35</a>
</span><span class=lnt id=hl-217-36><a class=lnlinks href=#hl-217-36>36</a>
</span><span class=lnt id=hl-217-37><a class=lnlinks href=#hl-217-37>37</a>
</span><span class=lnt id=hl-217-38><a class=lnlinks href=#hl-217-38>38</a>
</span><span class=lnt id=hl-217-39><a class=lnlinks href=#hl-217-39>39</a>
</span><span class=lnt id=hl-217-40><a class=lnlinks href=#hl-217-40>40</a>
</span><span class=lnt id=hl-217-41><a class=lnlinks href=#hl-217-41>41</a>
</span><span class=lnt id=hl-217-42><a class=lnlinks href=#hl-217-42>42</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- PostgreSQL 병렬 쿼리
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 1. 병렬 실행 설정
</span></span></span><span class=line><span class=cl><span class=k>SET</span><span class=w> </span><span class=n>max_parallel_workers_per_gather</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>4</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SET</span><span class=w> </span><span class=n>parallel_setup_cost</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>100</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SET</span><span class=w> </span><span class=n>parallel_tuple_cost</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>01</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 2. 병렬 인덱스 스캔 실행
</span></span></span><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYZE</span><span class=p>,</span><span class=w> </span><span class=n>BUFFERS</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>large_table</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>indexed_column</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1000000</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>결과:
</span></span></span><span class=line><span class=cl><span class=cm>Finalize Aggregate (cost=... rows=1)
</span></span></span><span class=line><span class=cl><span class=cm>  -&gt; Gather (workers=4)
</span></span></span><span class=line><span class=cl><span class=cm>       -&gt; Partial Aggregate
</span></span></span><span class=line><span class=cl><span class=cm>            -&gt; Parallel Index Scan on idx_column
</span></span></span><span class=line><span class=cl><span class=cm>               
</span></span></span><span class=line><span class=cl><span class=cm>병렬도: 4 workers
</span></span></span><span class=line><span class=cl><span class=cm>처리 시간: 단일 대비 1/4
</span></span></span><span class=line><span class=cl><span class=cm>*/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 3. 파티션 + 병렬
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>sales_data</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>sale_id</span><span class=w> </span><span class=n>BIGSERIAL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>sale_date</span><span class=w> </span><span class=nb>DATE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>amount</span><span class=w> </span><span class=nb>DECIMAL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w> </span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>RANGE</span><span class=w> </span><span class=p>(</span><span class=n>sale_date</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 파티션별 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_sales_2024_01</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>sales_2024_01</span><span class=p>(</span><span class=n>amount</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_sales_2024_02</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>sales_2024_02</span><span class=p>(</span><span class=n>amount</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 병렬 파티션 스캔
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>SUM</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>sales_data</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>sale_date</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=s1>&#39;2024-12-31&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=n>amount</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1000</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 각 파티션 병렬 스캔 → 결과 병합
</span></span></span></code></pre></td></tr></table></div></div><p><strong>인덱스 압축 기법</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-218-1><a class=lnlinks href=#hl-218-1> 1</a>
</span><span class=lnt id=hl-218-2><a class=lnlinks href=#hl-218-2> 2</a>
</span><span class=lnt id=hl-218-3><a class=lnlinks href=#hl-218-3> 3</a>
</span><span class=lnt id=hl-218-4><a class=lnlinks href=#hl-218-4> 4</a>
</span><span class=lnt id=hl-218-5><a class=lnlinks href=#hl-218-5> 5</a>
</span><span class=lnt id=hl-218-6><a class=lnlinks href=#hl-218-6> 6</a>
</span><span class=lnt id=hl-218-7><a class=lnlinks href=#hl-218-7> 7</a>
</span><span class=lnt id=hl-218-8><a class=lnlinks href=#hl-218-8> 8</a>
</span><span class=lnt id=hl-218-9><a class=lnlinks href=#hl-218-9> 9</a>
</span><span class=lnt id=hl-218-10><a class=lnlinks href=#hl-218-10>10</a>
</span><span class=lnt id=hl-218-11><a class=lnlinks href=#hl-218-11>11</a>
</span><span class=lnt id=hl-218-12><a class=lnlinks href=#hl-218-12>12</a>
</span><span class=lnt id=hl-218-13><a class=lnlinks href=#hl-218-13>13</a>
</span><span class=lnt id=hl-218-14><a class=lnlinks href=#hl-218-14>14</a>
</span><span class=lnt id=hl-218-15><a class=lnlinks href=#hl-218-15>15</a>
</span><span class=lnt id=hl-218-16><a class=lnlinks href=#hl-218-16>16</a>
</span><span class=lnt id=hl-218-17><a class=lnlinks href=#hl-218-17>17</a>
</span><span class=lnt id=hl-218-18><a class=lnlinks href=#hl-218-18>18</a>
</span><span class=lnt id=hl-218-19><a class=lnlinks href=#hl-218-19>19</a>
</span><span class=lnt id=hl-218-20><a class=lnlinks href=#hl-218-20>20</a>
</span><span class=lnt id=hl-218-21><a class=lnlinks href=#hl-218-21>21</a>
</span><span class=lnt id=hl-218-22><a class=lnlinks href=#hl-218-22>22</a>
</span><span class=lnt id=hl-218-23><a class=lnlinks href=#hl-218-23>23</a>
</span><span class=lnt id=hl-218-24><a class=lnlinks href=#hl-218-24>24</a>
</span><span class=lnt id=hl-218-25><a class=lnlinks href=#hl-218-25>25</a>
</span><span class=lnt id=hl-218-26><a class=lnlinks href=#hl-218-26>26</a>
</span><span class=lnt id=hl-218-27><a class=lnlinks href=#hl-218-27>27</a>
</span><span class=lnt id=hl-218-28><a class=lnlinks href=#hl-218-28>28</a>
</span><span class=lnt id=hl-218-29><a class=lnlinks href=#hl-218-29>29</a>
</span><span class=lnt id=hl-218-30><a class=lnlinks href=#hl-218-30>30</a>
</span><span class=lnt id=hl-218-31><a class=lnlinks href=#hl-218-31>31</a>
</span><span class=lnt id=hl-218-32><a class=lnlinks href=#hl-218-32>32</a>
</span><span class=lnt id=hl-218-33><a class=lnlinks href=#hl-218-33>33</a>
</span><span class=lnt id=hl-218-34><a class=lnlinks href=#hl-218-34>34</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 1. Prefix 압축 (B-Tree)
</span></span></span><span class=line><span class=cl><span class=c1>-- PostgreSQL에서 자동 적용 (내부 노드)
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 2. Page 압축 (InnoDB, MySQL 5.7+)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>compressed_data</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>data</span><span class=w> </span><span class=nb>TEXT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>)</span><span class=w> </span><span class=n>COMPRESSION</span><span class=o>=</span><span class=s1>&#39;zlib&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_data</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>compressed_data</span><span class=p>(</span><span class=k>data</span><span class=p>(</span><span class=mi>100</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=p>(</span><span class=n>COMPRESSION</span><span class=o>=</span><span class=s1>&#39;zlib&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 3. Columnstore 압축 (SQL Server)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=n>COLUMNSTORE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_analytics</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>ON</span><span class=w> </span><span class=n>sales_data</span><span class=w> </span><span class=p>(</span><span class=n>product_id</span><span class=p>,</span><span class=w> </span><span class=n>sale_date</span><span class=p>,</span><span class=w> </span><span class=n>amount</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=p>(</span><span class=n>DATA_COMPRESSION</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>COLUMNSTORE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 압축률: 70-90%
</span></span></span><span class=line><span class=cl><span class=c1>-- 분석 쿼리: 5-10배 빠름
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 4. 커스텀 압축 (애플리케이션 레벨)
</span></span></span><span class=line><span class=cl><span class=c1>-- 큰 텍스트 컬럼의 해시 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>documents</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>SERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>content</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>content_hash</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>64</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 해시 인덱스 (압축 효과)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_content_hash</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>documents</span><span class=p>(</span><span class=n>content_hash</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 삽입 시 해시 계산
</span></span></span><span class=line><span class=cl><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>documents</span><span class=w> </span><span class=p>(</span><span class=n>content</span><span class=p>,</span><span class=w> </span><span class=n>content_hash</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;long text...&#39;</span><span class=p>,</span><span class=w> </span><span class=n>MD5</span><span class=p>(</span><span class=s1>&#39;long text...&#39;</span><span class=p>));</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>샤딩 환경 최적화</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-219-1><a class=lnlinks href=#hl-219-1> 1</a>
</span><span class=lnt id=hl-219-2><a class=lnlinks href=#hl-219-2> 2</a>
</span><span class=lnt id=hl-219-3><a class=lnlinks href=#hl-219-3> 3</a>
</span><span class=lnt id=hl-219-4><a class=lnlinks href=#hl-219-4> 4</a>
</span><span class=lnt id=hl-219-5><a class=lnlinks href=#hl-219-5> 5</a>
</span><span class=lnt id=hl-219-6><a class=lnlinks href=#hl-219-6> 6</a>
</span><span class=lnt id=hl-219-7><a class=lnlinks href=#hl-219-7> 7</a>
</span><span class=lnt id=hl-219-8><a class=lnlinks href=#hl-219-8> 8</a>
</span><span class=lnt id=hl-219-9><a class=lnlinks href=#hl-219-9> 9</a>
</span><span class=lnt id=hl-219-10><a class=lnlinks href=#hl-219-10>10</a>
</span><span class=lnt id=hl-219-11><a class=lnlinks href=#hl-219-11>11</a>
</span><span class=lnt id=hl-219-12><a class=lnlinks href=#hl-219-12>12</a>
</span><span class=lnt id=hl-219-13><a class=lnlinks href=#hl-219-13>13</a>
</span><span class=lnt id=hl-219-14><a class=lnlinks href=#hl-219-14>14</a>
</span><span class=lnt id=hl-219-15><a class=lnlinks href=#hl-219-15>15</a>
</span><span class=lnt id=hl-219-16><a class=lnlinks href=#hl-219-16>16</a>
</span><span class=lnt id=hl-219-17><a class=lnlinks href=#hl-219-17>17</a>
</span><span class=lnt id=hl-219-18><a class=lnlinks href=#hl-219-18>18</a>
</span><span class=lnt id=hl-219-19><a class=lnlinks href=#hl-219-19>19</a>
</span><span class=lnt id=hl-219-20><a class=lnlinks href=#hl-219-20>20</a>
</span><span class=lnt id=hl-219-21><a class=lnlinks href=#hl-219-21>21</a>
</span><span class=lnt id=hl-219-22><a class=lnlinks href=#hl-219-22>22</a>
</span><span class=lnt id=hl-219-23><a class=lnlinks href=#hl-219-23>23</a>
</span><span class=lnt id=hl-219-24><a class=lnlinks href=#hl-219-24>24</a>
</span><span class=lnt id=hl-219-25><a class=lnlinks href=#hl-219-25>25</a>
</span><span class=lnt id=hl-219-26><a class=lnlinks href=#hl-219-26>26</a>
</span><span class=lnt id=hl-219-27><a class=lnlinks href=#hl-219-27>27</a>
</span><span class=lnt id=hl-219-28><a class=lnlinks href=#hl-219-28>28</a>
</span><span class=lnt id=hl-219-29><a class=lnlinks href=#hl-219-29>29</a>
</span><span class=lnt id=hl-219-30><a class=lnlinks href=#hl-219-30>30</a>
</span><span class=lnt id=hl-219-31><a class=lnlinks href=#hl-219-31>31</a>
</span><span class=lnt id=hl-219-32><a class=lnlinks href=#hl-219-32>32</a>
</span><span class=lnt id=hl-219-33><a class=lnlinks href=#hl-219-33>33</a>
</span><span class=lnt id=hl-219-34><a class=lnlinks href=#hl-219-34>34</a>
</span><span class=lnt id=hl-219-35><a class=lnlinks href=#hl-219-35>35</a>
</span><span class=lnt id=hl-219-36><a class=lnlinks href=#hl-219-36>36</a>
</span><span class=lnt id=hl-219-37><a class=lnlinks href=#hl-219-37>37</a>
</span><span class=lnt id=hl-219-38><a class=lnlinks href=#hl-219-38>38</a>
</span><span class=lnt id=hl-219-39><a class=lnlinks href=#hl-219-39>39</a>
</span><span class=lnt id=hl-219-40><a class=lnlinks href=#hl-219-40>40</a>
</span><span class=lnt id=hl-219-41><a class=lnlinks href=#hl-219-41>41</a>
</span><span class=lnt id=hl-219-42><a class=lnlinks href=#hl-219-42>42</a>
</span><span class=lnt id=hl-219-43><a class=lnlinks href=#hl-219-43>43</a>
</span><span class=lnt id=hl-219-44><a class=lnlinks href=#hl-219-44>44</a>
</span><span class=lnt id=hl-219-45><a class=lnlinks href=#hl-219-45>45</a>
</span><span class=lnt id=hl-219-46><a class=lnlinks href=#hl-219-46>46</a>
</span><span class=lnt id=hl-219-47><a class=lnlinks href=#hl-219-47>47</a>
</span><span class=lnt id=hl-219-48><a class=lnlinks href=#hl-219-48>48</a>
</span><span class=lnt id=hl-219-49><a class=lnlinks href=#hl-219-49>49</a>
</span><span class=lnt id=hl-219-50><a class=lnlinks href=#hl-219-50>50</a>
</span><span class=lnt id=hl-219-51><a class=lnlinks href=#hl-219-51>51</a>
</span><span class=lnt id=hl-219-52><a class=lnlinks href=#hl-219-52>52</a>
</span><span class=lnt id=hl-219-53><a class=lnlinks href=#hl-219-53>53</a>
</span><span class=lnt id=hl-219-54><a class=lnlinks href=#hl-219-54>54</a>
</span><span class=lnt id=hl-219-55><a class=lnlinks href=#hl-219-55>55</a>
</span><span class=lnt id=hl-219-56><a class=lnlinks href=#hl-219-56>56</a>
</span><span class=lnt id=hl-219-57><a class=lnlinks href=#hl-219-57>57</a>
</span><span class=lnt id=hl-219-58><a class=lnlinks href=#hl-219-58>58</a>
</span><span class=lnt id=hl-219-59><a class=lnlinks href=#hl-219-59>59</a>
</span><span class=lnt id=hl-219-60><a class=lnlinks href=#hl-219-60>60</a>
</span><span class=lnt id=hl-219-61><a class=lnlinks href=#hl-219-61>61</a>
</span><span class=lnt id=hl-219-62><a class=lnlinks href=#hl-219-62>62</a>
</span><span class=lnt id=hl-219-63><a class=lnlinks href=#hl-219-63>63</a>
</span><span class=lnt id=hl-219-64><a class=lnlinks href=#hl-219-64>64</a>
</span><span class=lnt id=hl-219-65><a class=lnlinks href=#hl-219-65>65</a>
</span><span class=lnt id=hl-219-66><a class=lnlinks href=#hl-219-66>66</a>
</span><span class=lnt id=hl-219-67><a class=lnlinks href=#hl-219-67>67</a>
</span><span class=lnt id=hl-219-68><a class=lnlinks href=#hl-219-68>68</a>
</span><span class=lnt id=hl-219-69><a class=lnlinks href=#hl-219-69>69</a>
</span><span class=lnt id=hl-219-70><a class=lnlinks href=#hl-219-70>70</a>
</span><span class=lnt id=hl-219-71><a class=lnlinks href=#hl-219-71>71</a>
</span><span class=lnt id=hl-219-72><a class=lnlinks href=#hl-219-72>72</a>
</span><span class=lnt id=hl-219-73><a class=lnlinks href=#hl-219-73>73</a>
</span><span class=lnt id=hl-219-74><a class=lnlinks href=#hl-219-74>74</a>
</span><span class=lnt id=hl-219-75><a class=lnlinks href=#hl-219-75>75</a>
</span><span class=lnt id=hl-219-76><a class=lnlinks href=#hl-219-76>76</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>ShardedIndexOptimizer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;샤딩 환경 인덱스 최적화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>shards</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>shards</span> <span class=o>=</span> <span class=n>shards</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>optimize_global_query</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>query</span><span class=p>,</span> <span class=n>index_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;글로벌 쿼리 최적화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. 샤드 프루닝 (불필요한 샤드 제외)</span>
</span></span><span class=line><span class=cl>        <span class=n>relevant_shards</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_prune_shards</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=n>index_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. 병렬 실행</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=n>concurrent</span><span class=o>.</span><span class=n>futures</span><span class=o>.</span><span class=n>ThreadPoolExecutor</span><span class=p>()</span> <span class=k>as</span> <span class=n>executor</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>futures</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>executor</span><span class=o>.</span><span class=n>submit</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_query_shard</span><span class=p>,</span> <span class=n>shard</span><span class=p>,</span> <span class=n>query</span><span class=p>):</span> <span class=n>shard</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>shard</span> <span class=ow>in</span> <span class=n>relevant_shards</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>results</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>future</span> <span class=ow>in</span> <span class=n>concurrent</span><span class=o>.</span><span class=n>futures</span><span class=o>.</span><span class=n>as_completed</span><span class=p>(</span><span class=n>futures</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>results</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>future</span><span class=o>.</span><span class=n>result</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 3. 결과 병합 및 정렬</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_merge_results</span><span class=p>(</span><span class=n>results</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_prune_shards</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>query</span><span class=p>,</span> <span class=n>index_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;샤드 프루닝&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 쿼리 조건으로 필요한 샤드만 선택</span>
</span></span><span class=line><span class=cl>        <span class=c1># 예: date range로 샤드 필터링</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s1>&#39;date_range&#39;</span> <span class=ow>in</span> <span class=n>query</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>start</span><span class=p>,</span> <span class=n>end</span> <span class=o>=</span> <span class=n>query</span><span class=p>[</span><span class=s1>&#39;date_range&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=n>shard</span> <span class=k>for</span> <span class=n>shard</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>shards</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>shard</span><span class=p>[</span><span class=s1>&#39;date_range&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>end</span> <span class=ow>and</span> 
</span></span><span class=line><span class=cl>                   <span class=n>shard</span><span class=p>[</span><span class=s1>&#39;date_range&#39;</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>start</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>shards</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_routing_index</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;라우팅 인덱스 생성 (메타데이터)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>routing_index</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>shard</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>shards</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 각 샤드의 키 범위 저장</span>
</span></span><span class=line><span class=cl>            <span class=n>routing_index</span><span class=p>[</span><span class=n>shard</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;key_range&#39;</span><span class=p>:</span> <span class=n>shard</span><span class=p>[</span><span class=s1>&#39;range&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;host&#39;</span><span class=p>:</span> <span class=n>shard</span><span class=p>[</span><span class=s1>&#39;host&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;indexes&#39;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>_get_shard_indexes</span><span class=p>(</span><span class=n>shard</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>routing_index</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_get_shard_indexes</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>shard</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;샤드의 인덱스 목록&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span> <span class=o>=</span> <span class=n>psycopg2</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=o>**</span><span class=n>shard</span><span class=p>[</span><span class=s1>&#39;db_config&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>cur</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>cur</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            SELECT indexname, indexdef
</span></span></span><span class=line><span class=cl><span class=s2>            FROM pg_indexes
</span></span></span><span class=line><span class=cl><span class=s2>            WHERE schemaname = &#39;public&#39;
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>indexes</span> <span class=o>=</span> <span class=n>cur</span><span class=o>.</span><span class=n>fetchall</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>indexes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용</span>
</span></span><span class=line><span class=cl><span class=n>optimizer</span> <span class=o>=</span> <span class=n>ShardedIndexOptimizer</span><span class=p>(</span><span class=n>shard_config</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 최적화된 글로벌 쿼리</span>
</span></span><span class=line><span class=cl><span class=n>results</span> <span class=o>=</span> <span class=n>optimizer</span><span class=o>.</span><span class=n>optimize_global_query</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>query</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;date_range&#39;</span><span class=p>:</span> <span class=p>(</span><span class=s1>&#39;2024-01-01&#39;</span><span class=p>,</span> <span class=s1>&#39;2024-12-31&#39;</span><span class=p>)},</span>
</span></span><span class=line><span class=cl>    <span class=n>index_key</span><span class=o>=</span><span class=s1>&#39;order_date&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=64-트러블슈팅-및-문제-해결-1>6.4 트러블슈팅 및 문제 해결<a hidden class=anchor aria-hidden=true href=#64-트러블슈팅-및-문제-해결-1>#</a></h4><p><strong>무엇으로 인해 문제가 발생하는가</strong></p><p><strong>문제 1: 인덱스를 타지 않는 쿼리</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-220-1><a class=lnlinks href=#hl-220-1> 1</a>
</span><span class=lnt id=hl-220-2><a class=lnlinks href=#hl-220-2> 2</a>
</span><span class=lnt id=hl-220-3><a class=lnlinks href=#hl-220-3> 3</a>
</span><span class=lnt id=hl-220-4><a class=lnlinks href=#hl-220-4> 4</a>
</span><span class=lnt id=hl-220-5><a class=lnlinks href=#hl-220-5> 5</a>
</span><span class=lnt id=hl-220-6><a class=lnlinks href=#hl-220-6> 6</a>
</span><span class=lnt id=hl-220-7><a class=lnlinks href=#hl-220-7> 7</a>
</span><span class=lnt id=hl-220-8><a class=lnlinks href=#hl-220-8> 8</a>
</span><span class=lnt id=hl-220-9><a class=lnlinks href=#hl-220-9> 9</a>
</span><span class=lnt id=hl-220-10><a class=lnlinks href=#hl-220-10>10</a>
</span><span class=lnt id=hl-220-11><a class=lnlinks href=#hl-220-11>11</a>
</span><span class=lnt id=hl-220-12><a class=lnlinks href=#hl-220-12>12</a>
</span><span class=lnt id=hl-220-13><a class=lnlinks href=#hl-220-13>13</a>
</span><span class=lnt id=hl-220-14><a class=lnlinks href=#hl-220-14>14</a>
</span><span class=lnt id=hl-220-15><a class=lnlinks href=#hl-220-15>15</a>
</span><span class=lnt id=hl-220-16><a class=lnlinks href=#hl-220-16>16</a>
</span><span class=lnt id=hl-220-17><a class=lnlinks href=#hl-220-17>17</a>
</span><span class=lnt id=hl-220-18><a class=lnlinks href=#hl-220-18>18</a>
</span><span class=lnt id=hl-220-19><a class=lnlinks href=#hl-220-19>19</a>
</span><span class=lnt id=hl-220-20><a class=lnlinks href=#hl-220-20>20</a>
</span><span class=lnt id=hl-220-21><a class=lnlinks href=#hl-220-21>21</a>
</span><span class=lnt id=hl-220-22><a class=lnlinks href=#hl-220-22>22</a>
</span><span class=lnt id=hl-220-23><a class=lnlinks href=#hl-220-23>23</a>
</span><span class=lnt id=hl-220-24><a class=lnlinks href=#hl-220-24>24</a>
</span><span class=lnt id=hl-220-25><a class=lnlinks href=#hl-220-25>25</a>
</span><span class=lnt id=hl-220-26><a class=lnlinks href=#hl-220-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 증상: EXPLAIN에서 Seq Scan 발생
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 원인 1: 통계 정보 부족
</span></span></span><span class=line><span class=cl><span class=k>ANALYZE</span><span class=w> </span><span class=k>table_name</span><span class=p>;</span><span class=w>  </span><span class=c1>-- 통계 갱신
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 원인 2: 선택도 낮음 (결과가 많음)
</span></span></span><span class=line><span class=cl><span class=c1>-- 해결: 부분 인덱스 또는 쿼리 재작성
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 원인 3: 데이터 타입 불일치
</span></span></span><span class=line><span class=cl><span class=c1>-- Bad
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>order_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;12345&#39;</span><span class=p>;</span><span class=w>  </span><span class=c1>-- VARCHAR
</span></span></span><span class=line><span class=cl><span class=c1>-- order_id가 INTEGER인 경우 형변환 발생
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- Good
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>order_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>12345</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 원인 4: 함수 적용
</span></span></span><span class=line><span class=cl><span class=c1>-- Bad
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>YEAR</span><span class=p>(</span><span class=n>created_at</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2024</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- Good: 함수 인덱스
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_created_year</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>users</span><span class=p>(</span><span class=k>YEAR</span><span class=p>(</span><span class=n>created_at</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 또는 범위 조건
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=s1>&#39;2024-01-01&#39;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=s1>&#39;2025-01-01&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>문제 2: 인덱스 블로트 (Bloat)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-221-1><a class=lnlinks href=#hl-221-1> 1</a>
</span><span class=lnt id=hl-221-2><a class=lnlinks href=#hl-221-2> 2</a>
</span><span class=lnt id=hl-221-3><a class=lnlinks href=#hl-221-3> 3</a>
</span><span class=lnt id=hl-221-4><a class=lnlinks href=#hl-221-4> 4</a>
</span><span class=lnt id=hl-221-5><a class=lnlinks href=#hl-221-5> 5</a>
</span><span class=lnt id=hl-221-6><a class=lnlinks href=#hl-221-6> 6</a>
</span><span class=lnt id=hl-221-7><a class=lnlinks href=#hl-221-7> 7</a>
</span><span class=lnt id=hl-221-8><a class=lnlinks href=#hl-221-8> 8</a>
</span><span class=lnt id=hl-221-9><a class=lnlinks href=#hl-221-9> 9</a>
</span><span class=lnt id=hl-221-10><a class=lnlinks href=#hl-221-10>10</a>
</span><span class=lnt id=hl-221-11><a class=lnlinks href=#hl-221-11>11</a>
</span><span class=lnt id=hl-221-12><a class=lnlinks href=#hl-221-12>12</a>
</span><span class=lnt id=hl-221-13><a class=lnlinks href=#hl-221-13>13</a>
</span><span class=lnt id=hl-221-14><a class=lnlinks href=#hl-221-14>14</a>
</span><span class=lnt id=hl-221-15><a class=lnlinks href=#hl-221-15>15</a>
</span><span class=lnt id=hl-221-16><a class=lnlinks href=#hl-221-16>16</a>
</span><span class=lnt id=hl-221-17><a class=lnlinks href=#hl-221-17>17</a>
</span><span class=lnt id=hl-221-18><a class=lnlinks href=#hl-221-18>18</a>
</span><span class=lnt id=hl-221-19><a class=lnlinks href=#hl-221-19>19</a>
</span><span class=lnt id=hl-221-20><a class=lnlinks href=#hl-221-20>20</a>
</span><span class=lnt id=hl-221-21><a class=lnlinks href=#hl-221-21>21</a>
</span><span class=lnt id=hl-221-22><a class=lnlinks href=#hl-221-22>22</a>
</span><span class=lnt id=hl-221-23><a class=lnlinks href=#hl-221-23>23</a>
</span><span class=lnt id=hl-221-24><a class=lnlinks href=#hl-221-24>24</a>
</span><span class=lnt id=hl-221-25><a class=lnlinks href=#hl-221-25>25</a>
</span><span class=lnt id=hl-221-26><a class=lnlinks href=#hl-221-26>26</a>
</span><span class=lnt id=hl-221-27><a class=lnlinks href=#hl-221-27>27</a>
</span><span class=lnt id=hl-221-28><a class=lnlinks href=#hl-221-28>28</a>
</span><span class=lnt id=hl-221-29><a class=lnlinks href=#hl-221-29>29</a>
</span><span class=lnt id=hl-221-30><a class=lnlinks href=#hl-221-30>30</a>
</span><span class=lnt id=hl-221-31><a class=lnlinks href=#hl-221-31>31</a>
</span><span class=lnt id=hl-221-32><a class=lnlinks href=#hl-221-32>32</a>
</span><span class=lnt id=hl-221-33><a class=lnlinks href=#hl-221-33>33</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 증상: 인덱스 크기 비정상적 증가, 성능 저하
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 진단
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>schemaname</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>tablename</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>indexname</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>pg_size_pretty</span><span class=p>(</span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indexrelid</span><span class=p>))</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>index_size</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>pg_size_pretty</span><span class=p>(</span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indrelid</span><span class=p>))</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>table_size</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>ROUND</span><span class=p>(</span><span class=mi>100</span><span class=p>.</span><span class=mi>0</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indexrelid</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=k>NULLIF</span><span class=p>(</span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indrelid</span><span class=p>),</span><span class=w> </span><span class=mi>0</span><span class=p>),</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>index_to_table_ratio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>pg_stat_user_indexes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indexrelid</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>10485760</span><span class=w>  </span><span class=c1>-- 10MB 이상
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>pg_relation_size</span><span class=p>(</span><span class=n>indexrelid</span><span class=p>)</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 원인: 잦은 UPDATE/DELETE, VACUUM 부족
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 해결 1: VACUUM
</span></span></span><span class=line><span class=cl><span class=k>VACUUM</span><span class=w> </span><span class=k>ANALYZE</span><span class=w> </span><span class=k>table_name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 해결 2: REINDEX
</span></span></span><span class=line><span class=cl><span class=k>REINDEX</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>index_name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 또는 테이블 전체
</span></span></span><span class=line><span class=cl><span class=k>REINDEX</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>table_name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 해결 3: 온라인 재구성 (PostgreSQL 12+)
</span></span></span><span class=line><span class=cl><span class=k>REINDEX</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>CONCURRENTLY</span><span class=w> </span><span class=n>index_name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 해결 4: 자동화
</span></span></span><span class=line><span class=cl><span class=c1>-- postgresql.conf
</span></span></span><span class=line><span class=cl><span class=n>autovacuum</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>on</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=n>autovacuum_vacuum_scale_factor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=n>autovacuum_analyze_scale_factor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>05</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>문제 3: 락 대기 (Lock Contention)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-222-1><a class=lnlinks href=#hl-222-1> 1</a>
</span><span class=lnt id=hl-222-2><a class=lnlinks href=#hl-222-2> 2</a>
</span><span class=lnt id=hl-222-3><a class=lnlinks href=#hl-222-3> 3</a>
</span><span class=lnt id=hl-222-4><a class=lnlinks href=#hl-222-4> 4</a>
</span><span class=lnt id=hl-222-5><a class=lnlinks href=#hl-222-5> 5</a>
</span><span class=lnt id=hl-222-6><a class=lnlinks href=#hl-222-6> 6</a>
</span><span class=lnt id=hl-222-7><a class=lnlinks href=#hl-222-7> 7</a>
</span><span class=lnt id=hl-222-8><a class=lnlinks href=#hl-222-8> 8</a>
</span><span class=lnt id=hl-222-9><a class=lnlinks href=#hl-222-9> 9</a>
</span><span class=lnt id=hl-222-10><a class=lnlinks href=#hl-222-10>10</a>
</span><span class=lnt id=hl-222-11><a class=lnlinks href=#hl-222-11>11</a>
</span><span class=lnt id=hl-222-12><a class=lnlinks href=#hl-222-12>12</a>
</span><span class=lnt id=hl-222-13><a class=lnlinks href=#hl-222-13>13</a>
</span><span class=lnt id=hl-222-14><a class=lnlinks href=#hl-222-14>14</a>
</span><span class=lnt id=hl-222-15><a class=lnlinks href=#hl-222-15>15</a>
</span><span class=lnt id=hl-222-16><a class=lnlinks href=#hl-222-16>16</a>
</span><span class=lnt id=hl-222-17><a class=lnlinks href=#hl-222-17>17</a>
</span><span class=lnt id=hl-222-18><a class=lnlinks href=#hl-222-18>18</a>
</span><span class=lnt id=hl-222-19><a class=lnlinks href=#hl-222-19>19</a>
</span><span class=lnt id=hl-222-20><a class=lnlinks href=#hl-222-20>20</a>
</span><span class=lnt id=hl-222-21><a class=lnlinks href=#hl-222-21>21</a>
</span><span class=lnt id=hl-222-22><a class=lnlinks href=#hl-222-22>22</a>
</span><span class=lnt id=hl-222-23><a class=lnlinks href=#hl-222-23>23</a>
</span><span class=lnt id=hl-222-24><a class=lnlinks href=#hl-222-24>24</a>
</span><span class=lnt id=hl-222-25><a class=lnlinks href=#hl-222-25>25</a>
</span><span class=lnt id=hl-222-26><a class=lnlinks href=#hl-222-26>26</a>
</span><span class=lnt id=hl-222-27><a class=lnlinks href=#hl-222-27>27</a>
</span><span class=lnt id=hl-222-28><a class=lnlinks href=#hl-222-28>28</a>
</span><span class=lnt id=hl-222-29><a class=lnlinks href=#hl-222-29>29</a>
</span><span class=lnt id=hl-222-30><a class=lnlinks href=#hl-222-30>30</a>
</span><span class=lnt id=hl-222-31><a class=lnlinks href=#hl-222-31>31</a>
</span><span class=lnt id=hl-222-32><a class=lnlinks href=#hl-222-32>32</a>
</span><span class=lnt id=hl-222-33><a class=lnlinks href=#hl-222-33>33</a>
</span><span class=lnt id=hl-222-34><a class=lnlinks href=#hl-222-34>34</a>
</span><span class=lnt id=hl-222-35><a class=lnlinks href=#hl-222-35>35</a>
</span><span class=lnt id=hl-222-36><a class=lnlinks href=#hl-222-36>36</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 증상: 쿼리 대기, 타임아웃
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 진단: 락 확인
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>blocked_locks</span><span class=p>.</span><span class=n>pid</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>blocked_pid</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>blocked_activity</span><span class=p>.</span><span class=n>usename</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>blocked_user</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>blocking_locks</span><span class=p>.</span><span class=n>pid</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>blocking_pid</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>blocking_activity</span><span class=p>.</span><span class=n>usename</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>blocking_user</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>blocked_activity</span><span class=p>.</span><span class=n>query</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>blocked_statement</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>blocking_activity</span><span class=p>.</span><span class=n>query</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>blocking_statement</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>age</span><span class=p>(</span><span class=n>clock_timestamp</span><span class=p>(),</span><span class=w> </span><span class=n>blocked_activity</span><span class=p>.</span><span class=n>query_start</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>blocked_duration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>pg_catalog</span><span class=p>.</span><span class=n>pg_locks</span><span class=w> </span><span class=n>blocked_locks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>JOIN</span><span class=w> </span><span class=n>pg_catalog</span><span class=p>.</span><span class=n>pg_stat_activity</span><span class=w> </span><span class=n>blocked_activity</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>blocked_activity</span><span class=p>.</span><span class=n>pid</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>blocked_locks</span><span class=p>.</span><span class=n>pid</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>JOIN</span><span class=w> </span><span class=n>pg_catalog</span><span class=p>.</span><span class=n>pg_locks</span><span class=w> </span><span class=n>blocking_locks</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>blocking_locks</span><span class=p>.</span><span class=n>locktype</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>blocked_locks</span><span class=p>.</span><span class=n>locktype</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>AND</span><span class=w> </span><span class=n>blocking_locks</span><span class=p>.</span><span class=k>database</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>blocked_locks</span><span class=p>.</span><span class=k>database</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>AND</span><span class=w> </span><span class=n>blocking_locks</span><span class=p>.</span><span class=n>relation</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>blocked_locks</span><span class=p>.</span><span class=n>relation</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>AND</span><span class=w> </span><span class=n>blocking_locks</span><span class=p>.</span><span class=n>page</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>blocked_locks</span><span class=p>.</span><span class=n>page</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>AND</span><span class=w> </span><span class=n>blocking_locks</span><span class=p>.</span><span class=n>tuple</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>blocked_locks</span><span class=p>.</span><span class=n>tuple</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>AND</span><span class=w> </span><span class=n>blocking_locks</span><span class=p>.</span><span class=n>pid</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>blocked_locks</span><span class=p>.</span><span class=n>pid</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>JOIN</span><span class=w> </span><span class=n>pg_catalog</span><span class=p>.</span><span class=n>pg_stat_activity</span><span class=w> </span><span class=n>blocking_activity</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>ON</span><span class=w> </span><span class=n>blocking_activity</span><span class=p>.</span><span class=n>pid</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>blocking_locks</span><span class=p>.</span><span class=n>pid</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=n>blocked_locks</span><span class=p>.</span><span class=k>granted</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 원인: 인덱스 생성/재구성 중 락
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 해결 1: CONCURRENTLY 옵션
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>CONCURRENTLY</span><span class=w> </span><span class=n>idx_name</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table_name</span><span class=p>(</span><span class=k>column</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>REINDEX</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>CONCURRENTLY</span><span class=w> </span><span class=n>idx_name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 해결 2: 락 타임아웃 설정
</span></span></span><span class=line><span class=cl><span class=k>SET</span><span class=w> </span><span class=n>lock_timeout</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;30s&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 해결 3: 작업 시간대 조정
</span></span></span><span class=line><span class=cl><span class=c1>-- 사용량 적은 시간에 인덱스 작업 수행
</span></span></span></code></pre></td></tr></table></div></div><p><strong>문제 4: 인덱스 손상 (Corruption)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-223-1><a class=lnlinks href=#hl-223-1> 1</a>
</span><span class=lnt id=hl-223-2><a class=lnlinks href=#hl-223-2> 2</a>
</span><span class=lnt id=hl-223-3><a class=lnlinks href=#hl-223-3> 3</a>
</span><span class=lnt id=hl-223-4><a class=lnlinks href=#hl-223-4> 4</a>
</span><span class=lnt id=hl-223-5><a class=lnlinks href=#hl-223-5> 5</a>
</span><span class=lnt id=hl-223-6><a class=lnlinks href=#hl-223-6> 6</a>
</span><span class=lnt id=hl-223-7><a class=lnlinks href=#hl-223-7> 7</a>
</span><span class=lnt id=hl-223-8><a class=lnlinks href=#hl-223-8> 8</a>
</span><span class=lnt id=hl-223-9><a class=lnlinks href=#hl-223-9> 9</a>
</span><span class=lnt id=hl-223-10><a class=lnlinks href=#hl-223-10>10</a>
</span><span class=lnt id=hl-223-11><a class=lnlinks href=#hl-223-11>11</a>
</span><span class=lnt id=hl-223-12><a class=lnlinks href=#hl-223-12>12</a>
</span><span class=lnt id=hl-223-13><a class=lnlinks href=#hl-223-13>13</a>
</span><span class=lnt id=hl-223-14><a class=lnlinks href=#hl-223-14>14</a>
</span><span class=lnt id=hl-223-15><a class=lnlinks href=#hl-223-15>15</a>
</span><span class=lnt id=hl-223-16><a class=lnlinks href=#hl-223-16>16</a>
</span><span class=lnt id=hl-223-17><a class=lnlinks href=#hl-223-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 증상: 쿼리 오류, 일관성 없는 결과
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 진단: 인덱스 검증
</span></span></span><span class=line><span class=cl><span class=c1>-- PostgreSQL
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>bt_index_check</span><span class=p>(</span><span class=s1>&#39;index_name&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- MySQL
</span></span></span><span class=line><span class=cl><span class=k>CHECK</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>table_name</span><span class=w> </span><span class=n>EXTENDED</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 원인: 하드웨어 장애, 버그, 부적절한 종료
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 해결: 재구성
</span></span></span><span class=line><span class=cl><span class=k>DROP</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>index_name</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>index_name</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>table_name</span><span class=p>(</span><span class=k>column</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 또는
</span></span></span><span class=line><span class=cl><span class=k>REINDEX</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>index_name</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>트러블슈팅 체크리스트</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-224-1><a class=lnlinks href=#hl-224-1> 1</a>
</span><span class=lnt id=hl-224-2><a class=lnlinks href=#hl-224-2> 2</a>
</span><span class=lnt id=hl-224-3><a class=lnlinks href=#hl-224-3> 3</a>
</span><span class=lnt id=hl-224-4><a class=lnlinks href=#hl-224-4> 4</a>
</span><span class=lnt id=hl-224-5><a class=lnlinks href=#hl-224-5> 5</a>
</span><span class=lnt id=hl-224-6><a class=lnlinks href=#hl-224-6> 6</a>
</span><span class=lnt id=hl-224-7><a class=lnlinks href=#hl-224-7> 7</a>
</span><span class=lnt id=hl-224-8><a class=lnlinks href=#hl-224-8> 8</a>
</span><span class=lnt id=hl-224-9><a class=lnlinks href=#hl-224-9> 9</a>
</span><span class=lnt id=hl-224-10><a class=lnlinks href=#hl-224-10>10</a>
</span><span class=lnt id=hl-224-11><a class=lnlinks href=#hl-224-11>11</a>
</span><span class=lnt id=hl-224-12><a class=lnlinks href=#hl-224-12>12</a>
</span><span class=lnt id=hl-224-13><a class=lnlinks href=#hl-224-13>13</a>
</span><span class=lnt id=hl-224-14><a class=lnlinks href=#hl-224-14>14</a>
</span><span class=lnt id=hl-224-15><a class=lnlinks href=#hl-224-15>15</a>
</span><span class=lnt id=hl-224-16><a class=lnlinks href=#hl-224-16>16</a>
</span><span class=lnt id=hl-224-17><a class=lnlinks href=#hl-224-17>17</a>
</span><span class=lnt id=hl-224-18><a class=lnlinks href=#hl-224-18>18</a>
</span><span class=lnt id=hl-224-19><a class=lnlinks href=#hl-224-19>19</a>
</span><span class=lnt id=hl-224-20><a class=lnlinks href=#hl-224-20>20</a>
</span><span class=lnt id=hl-224-21><a class=lnlinks href=#hl-224-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1단계: 증상 확인
</span></span><span class=line><span class=cl>□ 느린 쿼리 식별 (Slow Query Log)
</span></span><span class=line><span class=cl>□ 실행 계획 분석 (EXPLAIN)
</span></span><span class=line><span class=cl>□ 리소스 사용률 확인 (CPU, I/O, 메모리)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2단계: 원인 분석
</span></span><span class=line><span class=cl>□ 인덱스 사용 여부 확인
</span></span><span class=line><span class=cl>□ 인덱스 통계 정보 확인
</span></span><span class=line><span class=cl>□ 데이터 분포 확인
</span></span><span class=line><span class=cl>□ 락 상태 확인
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3단계: 해결 방안 적용
</span></span><span class=line><span class=cl>□ 통계 갱신 (ANALYZE)
</span></span><span class=line><span class=cl>□ 인덱스 추가/수정
</span></span><span class=line><span class=cl>□ 쿼리 재작성
</span></span><span class=line><span class=cl>□ 인덱스 재구성
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4단계: 검증 및 모니터링
</span></span><span class=line><span class=cl>□ 성능 개선 확인
</span></span><span class=line><span class=cl>□ 부작용 모니터링
</span></span><span class=line><span class=cl>□ 장기 추적
</span></span></code></pre></td></tr></table></div></div><p>계속해서 Phase 7로 진행하겠습니다.</p><hr><h3 id=phase-7-고급-주제-및-미래-전망-1>Phase 7: 고급 주제 및 미래 전망<a hidden class=anchor aria-hidden=true href=#phase-7-고급-주제-및-미래-전망-1>#</a></h3><h4 id=71-현재-도전-과제-및-한계-1>7.1 현재 도전 과제 및 한계<a hidden class=anchor aria-hidden=true href=#71-현재-도전-과제-및-한계-1>#</a></h4><p><strong>영역별 기술 난제</strong></p><p><strong>1. 고차원 데이터 인덱싱의 차원의 저주</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-225-1><a class=lnlinks href=#hl-225-1> 1</a>
</span><span class=lnt id=hl-225-2><a class=lnlinks href=#hl-225-2> 2</a>
</span><span class=lnt id=hl-225-3><a class=lnlinks href=#hl-225-3> 3</a>
</span><span class=lnt id=hl-225-4><a class=lnlinks href=#hl-225-4> 4</a>
</span><span class=lnt id=hl-225-5><a class=lnlinks href=#hl-225-5> 5</a>
</span><span class=lnt id=hl-225-6><a class=lnlinks href=#hl-225-6> 6</a>
</span><span class=lnt id=hl-225-7><a class=lnlinks href=#hl-225-7> 7</a>
</span><span class=lnt id=hl-225-8><a class=lnlinks href=#hl-225-8> 8</a>
</span><span class=lnt id=hl-225-9><a class=lnlinks href=#hl-225-9> 9</a>
</span><span class=lnt id=hl-225-10><a class=lnlinks href=#hl-225-10>10</a>
</span><span class=lnt id=hl-225-11><a class=lnlinks href=#hl-225-11>11</a>
</span><span class=lnt id=hl-225-12><a class=lnlinks href=#hl-225-12>12</a>
</span><span class=lnt id=hl-225-13><a class=lnlinks href=#hl-225-13>13</a>
</span><span class=lnt id=hl-225-14><a class=lnlinks href=#hl-225-14>14</a>
</span><span class=lnt id=hl-225-15><a class=lnlinks href=#hl-225-15>15</a>
</span><span class=lnt id=hl-225-16><a class=lnlinks href=#hl-225-16>16</a>
</span><span class=lnt id=hl-225-17><a class=lnlinks href=#hl-225-17>17</a>
</span><span class=lnt id=hl-225-18><a class=lnlinks href=#hl-225-18>18</a>
</span><span class=lnt id=hl-225-19><a class=lnlinks href=#hl-225-19>19</a>
</span><span class=lnt id=hl-225-20><a class=lnlinks href=#hl-225-20>20</a>
</span><span class=lnt id=hl-225-21><a class=lnlinks href=#hl-225-21>21</a>
</span><span class=lnt id=hl-225-22><a class=lnlinks href=#hl-225-22>22</a>
</span><span class=lnt id=hl-225-23><a class=lnlinks href=#hl-225-23>23</a>
</span><span class=lnt id=hl-225-24><a class=lnlinks href=#hl-225-24>24</a>
</span><span class=lnt id=hl-225-25><a class=lnlinks href=#hl-225-25>25</a>
</span><span class=lnt id=hl-225-26><a class=lnlinks href=#hl-225-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>문제: 차원이 증가할수록 인덱스 효율 급감
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>차원별 성능:
</span></span><span class=line><span class=cl>2D (위도/경도): R-Tree 효과적 (O(log n))
</span></span><span class=line><span class=cl>5D (시공간): 성능 저하 시작
</span></span><span class=line><span class=cl>10D: 거의 Full Scan 수준
</span></span><span class=line><span class=cl>50D+ (ML 특징 벡터): 인덱스 무용
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>원인:
</span></span><span class=line><span class=cl>- 고차원에서 모든 점이 &#39;멀리&#39; 있음
</span></span><span class=line><span class=cl>- 공간 분할 비효율 (2^d개 영역)
</span></span><span class=line><span class=cl>- 범위 쿼리가 대부분의 공간 포함
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>현재 접근법:
</span></span><span class=line><span class=cl>1. 차원 축소 (PCA, t-SNE)
</span></span><span class=line><span class=cl>   - 50D → 10D로 압축
</span></span><span class=line><span class=cl>   - 정보 손실 불가피
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 근사 검색 (ANN - Approximate Nearest Neighbor)
</span></span><span class=line><span class=cl>   - HNSW (Hierarchical NSW)
</span></span><span class=line><span class=cl>   - IVF (Inverted File)
</span></span><span class=line><span class=cl>   - 정확도 trade-off
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 학습 기반 인덱스
</span></span><span class=line><span class=cl>   - 데이터 분포 학습
</span></span><span class=line><span class=cl>   - 모델로 위치 예측
</span></span></code></pre></td></tr></table></div></div><p><strong>2. 실시간 스트리밍 데이터 인덱싱</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-226-1><a class=lnlinks href=#hl-226-1> 1</a>
</span><span class=lnt id=hl-226-2><a class=lnlinks href=#hl-226-2> 2</a>
</span><span class=lnt id=hl-226-3><a class=lnlinks href=#hl-226-3> 3</a>
</span><span class=lnt id=hl-226-4><a class=lnlinks href=#hl-226-4> 4</a>
</span><span class=lnt id=hl-226-5><a class=lnlinks href=#hl-226-5> 5</a>
</span><span class=lnt id=hl-226-6><a class=lnlinks href=#hl-226-6> 6</a>
</span><span class=lnt id=hl-226-7><a class=lnlinks href=#hl-226-7> 7</a>
</span><span class=lnt id=hl-226-8><a class=lnlinks href=#hl-226-8> 8</a>
</span><span class=lnt id=hl-226-9><a class=lnlinks href=#hl-226-9> 9</a>
</span><span class=lnt id=hl-226-10><a class=lnlinks href=#hl-226-10>10</a>
</span><span class=lnt id=hl-226-11><a class=lnlinks href=#hl-226-11>11</a>
</span><span class=lnt id=hl-226-12><a class=lnlinks href=#hl-226-12>12</a>
</span><span class=lnt id=hl-226-13><a class=lnlinks href=#hl-226-13>13</a>
</span><span class=lnt id=hl-226-14><a class=lnlinks href=#hl-226-14>14</a>
</span><span class=lnt id=hl-226-15><a class=lnlinks href=#hl-226-15>15</a>
</span><span class=lnt id=hl-226-16><a class=lnlinks href=#hl-226-16>16</a>
</span><span class=lnt id=hl-226-17><a class=lnlinks href=#hl-226-17>17</a>
</span><span class=lnt id=hl-226-18><a class=lnlinks href=#hl-226-18>18</a>
</span><span class=lnt id=hl-226-19><a class=lnlinks href=#hl-226-19>19</a>
</span><span class=lnt id=hl-226-20><a class=lnlinks href=#hl-226-20>20</a>
</span><span class=lnt id=hl-226-21><a class=lnlinks href=#hl-226-21>21</a>
</span><span class=lnt id=hl-226-22><a class=lnlinks href=#hl-226-22>22</a>
</span><span class=lnt id=hl-226-23><a class=lnlinks href=#hl-226-23>23</a>
</span><span class=lnt id=hl-226-24><a class=lnlinks href=#hl-226-24>24</a>
</span><span class=lnt id=hl-226-25><a class=lnlinks href=#hl-226-25>25</a>
</span><span class=lnt id=hl-226-26><a class=lnlinks href=#hl-226-26>26</a>
</span><span class=lnt id=hl-226-27><a class=lnlinks href=#hl-226-27>27</a>
</span><span class=lnt id=hl-226-28><a class=lnlinks href=#hl-226-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>문제: 초당 수백만 건 INSERT와 동시 검색
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>도전 과제:
</span></span><span class=line><span class=cl>- 쓰기 처리량 vs 읽기 지연 딜레마
</span></span><span class=line><span class=cl>- 인덱스 갱신 비용
</span></span><span class=line><span class=cl>- 시간 윈도우 관리
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>현재 한계:
</span></span><span class=line><span class=cl>B-Tree: INSERT 시 재조정 오버헤드
</span></span><span class=line><span class=cl>LSM-Tree: 읽기 증폭 (여러 레벨 검색)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>부분적 해결:
</span></span><span class=line><span class=cl>1. 시계열 DB (InfluxDB, TimescaleDB)
</span></span><span class=line><span class=cl>   - 시간 기반 파티셔닝
</span></span><span class=line><span class=cl>   - 압축 및 다운샘플링
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 스트림 처리 (Kafka Streams)
</span></span><span class=line><span class=cl>   - 윈도우별 집계
</span></span><span class=line><span class=cl>   - 머티리얼라이즈드 뷰
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 하이브리드 저장
</span></span><span class=line><span class=cl>   - Hot: 메모리 (최근 데이터)
</span></span><span class=line><span class=cl>   - Warm: SSD (시간 인덱스)
</span></span><span class=line><span class=cl>   - Cold: S3 (아카이브)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>미해결:
</span></span><span class=line><span class=cl>- 정확한 순서 보장과 성능 양립
</span></span><span class=line><span class=cl>- 분산 환경 인덱스 일관성
</span></span></code></pre></td></tr></table></div></div><p><strong>3. 분산 환경 글로벌 인덱스</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-227-1><a class=lnlinks href=#hl-227-1> 1</a>
</span><span class=lnt id=hl-227-2><a class=lnlinks href=#hl-227-2> 2</a>
</span><span class=lnt id=hl-227-3><a class=lnlinks href=#hl-227-3> 3</a>
</span><span class=lnt id=hl-227-4><a class=lnlinks href=#hl-227-4> 4</a>
</span><span class=lnt id=hl-227-5><a class=lnlinks href=#hl-227-5> 5</a>
</span><span class=lnt id=hl-227-6><a class=lnlinks href=#hl-227-6> 6</a>
</span><span class=lnt id=hl-227-7><a class=lnlinks href=#hl-227-7> 7</a>
</span><span class=lnt id=hl-227-8><a class=lnlinks href=#hl-227-8> 8</a>
</span><span class=lnt id=hl-227-9><a class=lnlinks href=#hl-227-9> 9</a>
</span><span class=lnt id=hl-227-10><a class=lnlinks href=#hl-227-10>10</a>
</span><span class=lnt id=hl-227-11><a class=lnlinks href=#hl-227-11>11</a>
</span><span class=lnt id=hl-227-12><a class=lnlinks href=#hl-227-12>12</a>
</span><span class=lnt id=hl-227-13><a class=lnlinks href=#hl-227-13>13</a>
</span><span class=lnt id=hl-227-14><a class=lnlinks href=#hl-227-14>14</a>
</span><span class=lnt id=hl-227-15><a class=lnlinks href=#hl-227-15>15</a>
</span><span class=lnt id=hl-227-16><a class=lnlinks href=#hl-227-16>16</a>
</span><span class=lnt id=hl-227-17><a class=lnlinks href=#hl-227-17>17</a>
</span><span class=lnt id=hl-227-18><a class=lnlinks href=#hl-227-18>18</a>
</span><span class=lnt id=hl-227-19><a class=lnlinks href=#hl-227-19>19</a>
</span><span class=lnt id=hl-227-20><a class=lnlinks href=#hl-227-20>20</a>
</span><span class=lnt id=hl-227-21><a class=lnlinks href=#hl-227-21>21</a>
</span><span class=lnt id=hl-227-22><a class=lnlinks href=#hl-227-22>22</a>
</span><span class=lnt id=hl-227-23><a class=lnlinks href=#hl-227-23>23</a>
</span><span class=lnt id=hl-227-24><a class=lnlinks href=#hl-227-24>24</a>
</span><span class=lnt id=hl-227-25><a class=lnlinks href=#hl-227-25>25</a>
</span><span class=lnt id=hl-227-26><a class=lnlinks href=#hl-227-26>26</a>
</span><span class=lnt id=hl-227-27><a class=lnlinks href=#hl-227-27>27</a>
</span><span class=lnt id=hl-227-28><a class=lnlinks href=#hl-227-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>문제: CAP 정리의 한계
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>시나리오:
</span></span><span class=line><span class=cl>- 글로벌 인덱스: 모든 노드 동기화 필요
</span></span><span class=line><span class=cl>- 일관성 보장 → 가용성/성능 희생
</span></span><span class=line><span class=cl>- 가용성 우선 → 일관성 희생
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>영향:
</span></span><span class=line><span class=cl>✗ 분산 트랜잭션 비용 (2PC, Paxos)
</span></span><span class=line><span class=cl>✗ 네트워크 파티션 시 불일치
</span></span><span class=line><span class=cl>✗ 크로스 리전 지연
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>현재 타협안:
</span></span><span class=line><span class=cl>1. 로컬 인덱스 + 쿼리 라우팅
</span></span><span class=line><span class=cl>   - 샤딩 키 필수
</span></span><span class=line><span class=cl>   - 크로스 샤드 느림
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 최종 일관성 (Eventual Consistency)
</span></span><span class=line><span class=cl>   - Dynamo, Cassandra 방식
</span></span><span class=line><span class=cl>   - 읽기 지연 허용
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. CRDT 기반 인덱스
</span></span><span class=line><span class=cl>   - 충돌 없는 복제
</span></span><span class=line><span class=cl>   - 제한적 쿼리 지원
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>연구 중:
</span></span><span class=line><span class=cl>- 인과 일관성 (Causal Consistency)
</span></span><span class=line><span class=cl>- 하이브리드 일관성 모델
</span></span></code></pre></td></tr></table></div></div><p><strong>4. 대규모 그래프 인덱싱</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-228-1><a class=lnlinks href=#hl-228-1> 1</a>
</span><span class=lnt id=hl-228-2><a class=lnlinks href=#hl-228-2> 2</a>
</span><span class=lnt id=hl-228-3><a class=lnlinks href=#hl-228-3> 3</a>
</span><span class=lnt id=hl-228-4><a class=lnlinks href=#hl-228-4> 4</a>
</span><span class=lnt id=hl-228-5><a class=lnlinks href=#hl-228-5> 5</a>
</span><span class=lnt id=hl-228-6><a class=lnlinks href=#hl-228-6> 6</a>
</span><span class=lnt id=hl-228-7><a class=lnlinks href=#hl-228-7> 7</a>
</span><span class=lnt id=hl-228-8><a class=lnlinks href=#hl-228-8> 8</a>
</span><span class=lnt id=hl-228-9><a class=lnlinks href=#hl-228-9> 9</a>
</span><span class=lnt id=hl-228-10><a class=lnlinks href=#hl-228-10>10</a>
</span><span class=lnt id=hl-228-11><a class=lnlinks href=#hl-228-11>11</a>
</span><span class=lnt id=hl-228-12><a class=lnlinks href=#hl-228-12>12</a>
</span><span class=lnt id=hl-228-13><a class=lnlinks href=#hl-228-13>13</a>
</span><span class=lnt id=hl-228-14><a class=lnlinks href=#hl-228-14>14</a>
</span><span class=lnt id=hl-228-15><a class=lnlinks href=#hl-228-15>15</a>
</span><span class=lnt id=hl-228-16><a class=lnlinks href=#hl-228-16>16</a>
</span><span class=lnt id=hl-228-17><a class=lnlinks href=#hl-228-17>17</a>
</span><span class=lnt id=hl-228-18><a class=lnlinks href=#hl-228-18>18</a>
</span><span class=lnt id=hl-228-19><a class=lnlinks href=#hl-228-19>19</a>
</span><span class=lnt id=hl-228-20><a class=lnlinks href=#hl-228-20>20</a>
</span><span class=lnt id=hl-228-21><a class=lnlinks href=#hl-228-21>21</a>
</span><span class=lnt id=hl-228-22><a class=lnlinks href=#hl-228-22>22</a>
</span><span class=lnt id=hl-228-23><a class=lnlinks href=#hl-228-23>23</a>
</span><span class=lnt id=hl-228-24><a class=lnlinks href=#hl-228-24>24</a>
</span><span class=lnt id=hl-228-25><a class=lnlinks href=#hl-228-25>25</a>
</span><span class=lnt id=hl-228-26><a class=lnlinks href=#hl-228-26>26</a>
</span><span class=lnt id=hl-228-27><a class=lnlinks href=#hl-228-27>27</a>
</span><span class=lnt id=hl-228-28><a class=lnlinks href=#hl-228-28>28</a>
</span><span class=lnt id=hl-228-29><a class=lnlinks href=#hl-228-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>문제: 관계 탐색의 복잡도
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>예시: 소셜 네트워크
</span></span><span class=line><span class=cl>- 10억 사용자
</span></span><span class=line><span class=cl>- 평균 500명 친구
</span></span><span class=line><span class=cl>- &#34;친구의 친구&#34; 쿼리
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>도전:
</span></span><span class=line><span class=cl>- 멀티홉 탐색 (2-hop, 3-hop)
</span></span><span class=line><span class=cl>- 동적 그래프 (계속 변화)
</span></span><span class=line><span class=cl>- 중심성(Centrality) 계산 비용
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>현재 접근:
</span></span><span class=line><span class=cl>1. 인접 리스트 인덱스
</span></span><span class=line><span class=cl>   - 각 노드의 이웃 저장
</span></span><span class=line><span class=cl>   - 1-hop: 빠름
</span></span><span class=line><span class=cl>   - 2-hop+: 조합 폭발
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 경로 인덱스 (Path Index)
</span></span><span class=line><span class=cl>   - 자주 사용하는 경로 미리 계산
</span></span><span class=line><span class=cl>   - 저장 공간 膨대
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 랜드마크 기반 (Landmark-based)
</span></span><span class=line><span class=cl>   - 중요 노드 식별
</span></span><span class=line><span class=cl>   - 거리 추정
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>한계:
</span></span><span class=line><span class=cl>- 동적 변화 반영 어려움
</span></span><span class=line><span class=cl>- 저장 공간 vs 쿼리 시간 트레이드오프
</span></span></code></pre></td></tr></table></div></div><p><strong>5. 개인정보 보호와 인덱스</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-229-1><a class=lnlinks href=#hl-229-1> 1</a>
</span><span class=lnt id=hl-229-2><a class=lnlinks href=#hl-229-2> 2</a>
</span><span class=lnt id=hl-229-3><a class=lnlinks href=#hl-229-3> 3</a>
</span><span class=lnt id=hl-229-4><a class=lnlinks href=#hl-229-4> 4</a>
</span><span class=lnt id=hl-229-5><a class=lnlinks href=#hl-229-5> 5</a>
</span><span class=lnt id=hl-229-6><a class=lnlinks href=#hl-229-6> 6</a>
</span><span class=lnt id=hl-229-7><a class=lnlinks href=#hl-229-7> 7</a>
</span><span class=lnt id=hl-229-8><a class=lnlinks href=#hl-229-8> 8</a>
</span><span class=lnt id=hl-229-9><a class=lnlinks href=#hl-229-9> 9</a>
</span><span class=lnt id=hl-229-10><a class=lnlinks href=#hl-229-10>10</a>
</span><span class=lnt id=hl-229-11><a class=lnlinks href=#hl-229-11>11</a>
</span><span class=lnt id=hl-229-12><a class=lnlinks href=#hl-229-12>12</a>
</span><span class=lnt id=hl-229-13><a class=lnlinks href=#hl-229-13>13</a>
</span><span class=lnt id=hl-229-14><a class=lnlinks href=#hl-229-14>14</a>
</span><span class=lnt id=hl-229-15><a class=lnlinks href=#hl-229-15>15</a>
</span><span class=lnt id=hl-229-16><a class=lnlinks href=#hl-229-16>16</a>
</span><span class=lnt id=hl-229-17><a class=lnlinks href=#hl-229-17>17</a>
</span><span class=lnt id=hl-229-18><a class=lnlinks href=#hl-229-18>18</a>
</span><span class=lnt id=hl-229-19><a class=lnlinks href=#hl-229-19>19</a>
</span><span class=lnt id=hl-229-20><a class=lnlinks href=#hl-229-20>20</a>
</span><span class=lnt id=hl-229-21><a class=lnlinks href=#hl-229-21>21</a>
</span><span class=lnt id=hl-229-22><a class=lnlinks href=#hl-229-22>22</a>
</span><span class=lnt id=hl-229-23><a class=lnlinks href=#hl-229-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>문제: 검색 가능성 vs 프라이버시
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>상충:
</span></span><span class=line><span class=cl>- 효율적 검색: 평문 인덱스 필요
</span></span><span class=line><span class=cl>- 프라이버시: 암호화 필요
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>현재 한계:
</span></span><span class=line><span class=cl>1. 완전 동형 암호 (FHE)
</span></span><span class=line><span class=cl>   - 암호문 상태로 연산
</span></span><span class=line><span class=cl>   - 100-1000배 느림 (실용 불가)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 검색 가능 암호 (Searchable Encryption)
</span></span><span class=line><span class=cl>   - 특정 패턴만 검색
</span></span><span class=line><span class=cl>   - 범위 쿼리 어려움
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 차등 프라이버시 (Differential Privacy)
</span></span><span class=line><span class=cl>   - 노이즈 추가
</span></span><span class=line><span class=cl>   - 정확도 저하
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>연구 방향:
</span></span><span class=line><span class=cl>- 준동형 암호 (Somewhat HE)
</span></span><span class=line><span class=cl>- 보안 멀티파티 계산 (MPC)
</span></span><span class=line><span class=cl>- TEE (Trusted Execution Environment)
</span></span></code></pre></td></tr></table></div></div><h4 id=72-최신-트렌드-및-방향-1>7.2 최신 트렌드 및 방향<a hidden class=anchor aria-hidden=true href=#72-최신-트렌드-및-방향-1>#</a></h4><p><strong>트렌드 1: 학습 기반 인덱스 (Learned Index)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-230-1><a class=lnlinks href=#hl-230-1> 1</a>
</span><span class=lnt id=hl-230-2><a class=lnlinks href=#hl-230-2> 2</a>
</span><span class=lnt id=hl-230-3><a class=lnlinks href=#hl-230-3> 3</a>
</span><span class=lnt id=hl-230-4><a class=lnlinks href=#hl-230-4> 4</a>
</span><span class=lnt id=hl-230-5><a class=lnlinks href=#hl-230-5> 5</a>
</span><span class=lnt id=hl-230-6><a class=lnlinks href=#hl-230-6> 6</a>
</span><span class=lnt id=hl-230-7><a class=lnlinks href=#hl-230-7> 7</a>
</span><span class=lnt id=hl-230-8><a class=lnlinks href=#hl-230-8> 8</a>
</span><span class=lnt id=hl-230-9><a class=lnlinks href=#hl-230-9> 9</a>
</span><span class=lnt id=hl-230-10><a class=lnlinks href=#hl-230-10>10</a>
</span><span class=lnt id=hl-230-11><a class=lnlinks href=#hl-230-11>11</a>
</span><span class=lnt id=hl-230-12><a class=lnlinks href=#hl-230-12>12</a>
</span><span class=lnt id=hl-230-13><a class=lnlinks href=#hl-230-13>13</a>
</span><span class=lnt id=hl-230-14><a class=lnlinks href=#hl-230-14>14</a>
</span><span class=lnt id=hl-230-15><a class=lnlinks href=#hl-230-15>15</a>
</span><span class=lnt id=hl-230-16><a class=lnlinks href=#hl-230-16>16</a>
</span><span class=lnt id=hl-230-17><a class=lnlinks href=#hl-230-17>17</a>
</span><span class=lnt id=hl-230-18><a class=lnlinks href=#hl-230-18>18</a>
</span><span class=lnt id=hl-230-19><a class=lnlinks href=#hl-230-19>19</a>
</span><span class=lnt id=hl-230-20><a class=lnlinks href=#hl-230-20>20</a>
</span><span class=lnt id=hl-230-21><a class=lnlinks href=#hl-230-21>21</a>
</span><span class=lnt id=hl-230-22><a class=lnlinks href=#hl-230-22>22</a>
</span><span class=lnt id=hl-230-23><a class=lnlinks href=#hl-230-23>23</a>
</span><span class=lnt id=hl-230-24><a class=lnlinks href=#hl-230-24>24</a>
</span><span class=lnt id=hl-230-25><a class=lnlinks href=#hl-230-25>25</a>
</span><span class=lnt id=hl-230-26><a class=lnlinks href=#hl-230-26>26</a>
</span><span class=lnt id=hl-230-27><a class=lnlinks href=#hl-230-27>27</a>
</span><span class=lnt id=hl-230-28><a class=lnlinks href=#hl-230-28>28</a>
</span><span class=lnt id=hl-230-29><a class=lnlinks href=#hl-230-29>29</a>
</span><span class=lnt id=hl-230-30><a class=lnlinks href=#hl-230-30>30</a>
</span><span class=lnt id=hl-230-31><a class=lnlinks href=#hl-230-31>31</a>
</span><span class=lnt id=hl-230-32><a class=lnlinks href=#hl-230-32>32</a>
</span><span class=lnt id=hl-230-33><a class=lnlinks href=#hl-230-33>33</a>
</span><span class=lnt id=hl-230-34><a class=lnlinks href=#hl-230-34>34</a>
</span><span class=lnt id=hl-230-35><a class=lnlinks href=#hl-230-35>35</a>
</span><span class=lnt id=hl-230-36><a class=lnlinks href=#hl-230-36>36</a>
</span><span class=lnt id=hl-230-37><a class=lnlinks href=#hl-230-37>37</a>
</span><span class=lnt id=hl-230-38><a class=lnlinks href=#hl-230-38>38</a>
</span><span class=lnt id=hl-230-39><a class=lnlinks href=#hl-230-39>39</a>
</span><span class=lnt id=hl-230-40><a class=lnlinks href=#hl-230-40>40</a>
</span><span class=lnt id=hl-230-41><a class=lnlinks href=#hl-230-41>41</a>
</span><span class=lnt id=hl-230-42><a class=lnlinks href=#hl-230-42>42</a>
</span><span class=lnt id=hl-230-43><a class=lnlinks href=#hl-230-43>43</a>
</span><span class=lnt id=hl-230-44><a class=lnlinks href=#hl-230-44>44</a>
</span><span class=lnt id=hl-230-45><a class=lnlinks href=#hl-230-45>45</a>
</span><span class=lnt id=hl-230-46><a class=lnlinks href=#hl-230-46>46</a>
</span><span class=lnt id=hl-230-47><a class=lnlinks href=#hl-230-47>47</a>
</span><span class=lnt id=hl-230-48><a class=lnlinks href=#hl-230-48>48</a>
</span><span class=lnt id=hl-230-49><a class=lnlinks href=#hl-230-49>49</a>
</span><span class=lnt id=hl-230-50><a class=lnlinks href=#hl-230-50>50</a>
</span><span class=lnt id=hl-230-51><a class=lnlinks href=#hl-230-51>51</a>
</span><span class=lnt id=hl-230-52><a class=lnlinks href=#hl-230-52>52</a>
</span><span class=lnt id=hl-230-53><a class=lnlinks href=#hl-230-53>53</a>
</span><span class=lnt id=hl-230-54><a class=lnlinks href=#hl-230-54>54</a>
</span><span class=lnt id=hl-230-55><a class=lnlinks href=#hl-230-55>55</a>
</span><span class=lnt id=hl-230-56><a class=lnlinks href=#hl-230-56>56</a>
</span><span class=lnt id=hl-230-57><a class=lnlinks href=#hl-230-57>57</a>
</span><span class=lnt id=hl-230-58><a class=lnlinks href=#hl-230-58>58</a>
</span><span class=lnt id=hl-230-59><a class=lnlinks href=#hl-230-59>59</a>
</span><span class=lnt id=hl-230-60><a class=lnlinks href=#hl-230-60>60</a>
</span><span class=lnt id=hl-230-61><a class=lnlinks href=#hl-230-61>61</a>
</span><span class=lnt id=hl-230-62><a class=lnlinks href=#hl-230-62>62</a>
</span><span class=lnt id=hl-230-63><a class=lnlinks href=#hl-230-63>63</a>
</span><span class=lnt id=hl-230-64><a class=lnlinks href=#hl-230-64>64</a>
</span><span class=lnt id=hl-230-65><a class=lnlinks href=#hl-230-65>65</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>개념: 기계학습 모델을 인덱스로 사용
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>전통 B-Tree:
</span></span><span class=line><span class=cl>Key → Tree Traversal → Position
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Learned Index:
</span></span><span class=line><span class=cl>Key → ML Model → Predicted Position
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>장점:
</span></span><span class=line><span class=cl>- 메모리: 1/10 크기
</span></span><span class=line><span class=cl>- 속도: 특정 분포에서 더 빠름
</span></span><span class=line><span class=cl>- 적응성: 데이터 패턴 학습
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>단점:
</span></span><span class=line><span class=cl>- 쓰기 비용: 모델 재학습
</span></span><span class=line><span class=cl>- 범용성 부족: 특정 분포 의존
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>현재 연구 (Google, MIT):
</span></span><span class=line><span class=cl>1. Recursive Model Index (RMI)
</span></span><span class=line><span class=cl>   모델 계층 구조
</span></span><span class=line><span class=cl>   Level 0: 전체 범위 예측
</span></span><span class=line><span class=cl>   Level 1: 세부 범위
</span></span><span class=line><span class=cl>   Level 2: 정확한 위치
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. Hybrid Index
</span></span><span class=line><span class=cl>   전통 인덱스 + 학습 모델
</span></span><span class=line><span class=cl>   모델 실패 시 폴백
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>구현 예시 (개념):
</span></span><span class=line><span class=cl>class LearnedIndex:
</span></span><span class=line><span class=cl>    def __init__(self, data):
</span></span><span class=line><span class=cl>        # 모델 학습 (선형 회귀 단순화)
</span></span><span class=line><span class=cl>        self.model = self._train_model(data)
</span></span><span class=line><span class=cl>        self.data = sorted(data)
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    def _train_model(self, data):
</span></span><span class=line><span class=cl>        &#34;&#34;&#34;위치 예측 모델 학습&#34;&#34;&#34;
</span></span><span class=line><span class=cl>        X = np.array([item[0] for item in data]).reshape(-1, 1)
</span></span><span class=line><span class=cl>        y = np.arange(len(data))
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        from sklearn.linear_model import LinearRegression
</span></span><span class=line><span class=cl>        model = LinearRegression()
</span></span><span class=line><span class=cl>        model.fit(X, y)
</span></span><span class=line><span class=cl>        return model
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    def search(self, key):
</span></span><span class=line><span class=cl>        # 모델로 위치 예측
</span></span><span class=line><span class=cl>        predicted_pos = int(self.model.predict([[key]])[0])
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        # 오차 범위 내 이진 탐색
</span></span><span class=line><span class=cl>        error_bound = 10
</span></span><span class=line><span class=cl>        start = max(0, predicted_pos - error_bound)
</span></span><span class=line><span class=cl>        end = min(len(self.data), predicted_pos + error_bound)
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        # 좁은 범위 탐색
</span></span><span class=line><span class=cl>        for i in range(start, end):
</span></span><span class=line><span class=cl>            if self.data[i][0] == key:
</span></span><span class=line><span class=cl>                return self.data[i]
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        return None
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>상용화 장벽:
</span></span><span class=line><span class=cl>- 쓰기 워크로드 처리
</span></span><span class=line><span class=cl>- 모델 갱신 비용
</span></span><span class=line><span class=cl>- 다양한 데이터 분포 대응
</span></span></code></pre></td></tr></table></div></div><p><strong>트렌드 2: 벡터 데이터베이스 및 임베딩 인덱스</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-231-1><a class=lnlinks href=#hl-231-1> 1</a>
</span><span class=lnt id=hl-231-2><a class=lnlinks href=#hl-231-2> 2</a>
</span><span class=lnt id=hl-231-3><a class=lnlinks href=#hl-231-3> 3</a>
</span><span class=lnt id=hl-231-4><a class=lnlinks href=#hl-231-4> 4</a>
</span><span class=lnt id=hl-231-5><a class=lnlinks href=#hl-231-5> 5</a>
</span><span class=lnt id=hl-231-6><a class=lnlinks href=#hl-231-6> 6</a>
</span><span class=lnt id=hl-231-7><a class=lnlinks href=#hl-231-7> 7</a>
</span><span class=lnt id=hl-231-8><a class=lnlinks href=#hl-231-8> 8</a>
</span><span class=lnt id=hl-231-9><a class=lnlinks href=#hl-231-9> 9</a>
</span><span class=lnt id=hl-231-10><a class=lnlinks href=#hl-231-10>10</a>
</span><span class=lnt id=hl-231-11><a class=lnlinks href=#hl-231-11>11</a>
</span><span class=lnt id=hl-231-12><a class=lnlinks href=#hl-231-12>12</a>
</span><span class=lnt id=hl-231-13><a class=lnlinks href=#hl-231-13>13</a>
</span><span class=lnt id=hl-231-14><a class=lnlinks href=#hl-231-14>14</a>
</span><span class=lnt id=hl-231-15><a class=lnlinks href=#hl-231-15>15</a>
</span><span class=lnt id=hl-231-16><a class=lnlinks href=#hl-231-16>16</a>
</span><span class=lnt id=hl-231-17><a class=lnlinks href=#hl-231-17>17</a>
</span><span class=lnt id=hl-231-18><a class=lnlinks href=#hl-231-18>18</a>
</span><span class=lnt id=hl-231-19><a class=lnlinks href=#hl-231-19>19</a>
</span><span class=lnt id=hl-231-20><a class=lnlinks href=#hl-231-20>20</a>
</span><span class=lnt id=hl-231-21><a class=lnlinks href=#hl-231-21>21</a>
</span><span class=lnt id=hl-231-22><a class=lnlinks href=#hl-231-22>22</a>
</span><span class=lnt id=hl-231-23><a class=lnlinks href=#hl-231-23>23</a>
</span><span class=lnt id=hl-231-24><a class=lnlinks href=#hl-231-24>24</a>
</span><span class=lnt id=hl-231-25><a class=lnlinks href=#hl-231-25>25</a>
</span><span class=lnt id=hl-231-26><a class=lnlinks href=#hl-231-26>26</a>
</span><span class=lnt id=hl-231-27><a class=lnlinks href=#hl-231-27>27</a>
</span><span class=lnt id=hl-231-28><a class=lnlinks href=#hl-231-28>28</a>
</span><span class=lnt id=hl-231-29><a class=lnlinks href=#hl-231-29>29</a>
</span><span class=lnt id=hl-231-30><a class=lnlinks href=#hl-231-30>30</a>
</span><span class=lnt id=hl-231-31><a class=lnlinks href=#hl-231-31>31</a>
</span><span class=lnt id=hl-231-32><a class=lnlinks href=#hl-231-32>32</a>
</span><span class=lnt id=hl-231-33><a class=lnlinks href=#hl-231-33>33</a>
</span><span class=lnt id=hl-231-34><a class=lnlinks href=#hl-231-34>34</a>
</span><span class=lnt id=hl-231-35><a class=lnlinks href=#hl-231-35>35</a>
</span><span class=lnt id=hl-231-36><a class=lnlinks href=#hl-231-36>36</a>
</span><span class=lnt id=hl-231-37><a class=lnlinks href=#hl-231-37>37</a>
</span><span class=lnt id=hl-231-38><a class=lnlinks href=#hl-231-38>38</a>
</span><span class=lnt id=hl-231-39><a class=lnlinks href=#hl-231-39>39</a>
</span><span class=lnt id=hl-231-40><a class=lnlinks href=#hl-231-40>40</a>
</span><span class=lnt id=hl-231-41><a class=lnlinks href=#hl-231-41>41</a>
</span><span class=lnt id=hl-231-42><a class=lnlinks href=#hl-231-42>42</a>
</span><span class=lnt id=hl-231-43><a class=lnlinks href=#hl-231-43>43</a>
</span><span class=lnt id=hl-231-44><a class=lnlinks href=#hl-231-44>44</a>
</span><span class=lnt id=hl-231-45><a class=lnlinks href=#hl-231-45>45</a>
</span><span class=lnt id=hl-231-46><a class=lnlinks href=#hl-231-46>46</a>
</span><span class=lnt id=hl-231-47><a class=lnlinks href=#hl-231-47>47</a>
</span><span class=lnt id=hl-231-48><a class=lnlinks href=#hl-231-48>48</a>
</span><span class=lnt id=hl-231-49><a class=lnlinks href=#hl-231-49>49</a>
</span><span class=lnt id=hl-231-50><a class=lnlinks href=#hl-231-50>50</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>배경: AI/ML 시대의 유사도 검색 폭증
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>사용 사례:
</span></span><span class=line><span class=cl>- 이미지 검색 (512D 벡터)
</span></span><span class=line><span class=cl>- 문서 유사도 (1536D OpenAI)
</span></span><span class=line><span class=cl>- 추천 시스템
</span></span><span class=line><span class=cl>- RAG (Retrieval-Augmented Generation)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>주요 알고리즘:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. HNSW (Hierarchical Navigable Small World)
</span></span><span class=line><span class=cl>   - 그래프 기반
</span></span><span class=line><span class=cl>   - 빠른 근사 검색
</span></span><span class=line><span class=cl>   - 메모리 효율
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. IVF (Inverted File Index)
</span></span><span class=line><span class=cl>   - 클러스터링 기반
</span></span><span class=line><span class=cl>   - 양자화(Quantization)
</span></span><span class=line><span class=cl>   - 대규모 데이터
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. PQ (Product Quantization)
</span></span><span class=line><span class=cl>   - 벡터 압축
</span></span><span class=line><span class=cl>   - 메모리 1/8 절감
</span></span><span class=line><span class=cl>   - 정확도 trade-off
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>벡터 DB 제품:
</span></span><span class=line><span class=cl>- Pinecone: 완전 관리형
</span></span><span class=line><span class=cl>- Weaviate: 오픈소스
</span></span><span class=line><span class=cl>- Milvus: 대규모
</span></span><span class=line><span class=cl>- Qdrant: Rust 기반
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PostgreSQL 확장:
</span></span><span class=line><span class=cl>-- pgvector 사용
</span></span><span class=line><span class=cl>CREATE EXTENSION vector;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>CREATE TABLE embeddings (
</span></span><span class=line><span class=cl>    id SERIAL PRIMARY KEY,
</span></span><span class=line><span class=cl>    content TEXT,
</span></span><span class=line><span class=cl>    embedding vector(1536)  -- OpenAI 차원
</span></span><span class=line><span class=cl>);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-- HNSW 인덱스
</span></span><span class=line><span class=cl>CREATE INDEX ON embeddings 
</span></span><span class=line><span class=cl>USING hnsw (embedding vector_cosine_ops);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-- 유사도 검색
</span></span><span class=line><span class=cl>SELECT content
</span></span><span class=line><span class=cl>FROM embeddings
</span></span><span class=line><span class=cl>ORDER BY embedding &lt;=&gt; &#39;[0.1, 0.2, ...]&#39;::vector
</span></span><span class=line><span class=cl>LIMIT 10;
</span></span></code></pre></td></tr></table></div></div><p><strong>트렌드 3: 클라우드 네이티브 인덱스</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-232-1><a class=lnlinks href=#hl-232-1> 1</a>
</span><span class=lnt id=hl-232-2><a class=lnlinks href=#hl-232-2> 2</a>
</span><span class=lnt id=hl-232-3><a class=lnlinks href=#hl-232-3> 3</a>
</span><span class=lnt id=hl-232-4><a class=lnlinks href=#hl-232-4> 4</a>
</span><span class=lnt id=hl-232-5><a class=lnlinks href=#hl-232-5> 5</a>
</span><span class=lnt id=hl-232-6><a class=lnlinks href=#hl-232-6> 6</a>
</span><span class=lnt id=hl-232-7><a class=lnlinks href=#hl-232-7> 7</a>
</span><span class=lnt id=hl-232-8><a class=lnlinks href=#hl-232-8> 8</a>
</span><span class=lnt id=hl-232-9><a class=lnlinks href=#hl-232-9> 9</a>
</span><span class=lnt id=hl-232-10><a class=lnlinks href=#hl-232-10>10</a>
</span><span class=lnt id=hl-232-11><a class=lnlinks href=#hl-232-11>11</a>
</span><span class=lnt id=hl-232-12><a class=lnlinks href=#hl-232-12>12</a>
</span><span class=lnt id=hl-232-13><a class=lnlinks href=#hl-232-13>13</a>
</span><span class=lnt id=hl-232-14><a class=lnlinks href=#hl-232-14>14</a>
</span><span class=lnt id=hl-232-15><a class=lnlinks href=#hl-232-15>15</a>
</span><span class=lnt id=hl-232-16><a class=lnlinks href=#hl-232-16>16</a>
</span><span class=lnt id=hl-232-17><a class=lnlinks href=#hl-232-17>17</a>
</span><span class=lnt id=hl-232-18><a class=lnlinks href=#hl-232-18>18</a>
</span><span class=lnt id=hl-232-19><a class=lnlinks href=#hl-232-19>19</a>
</span><span class=lnt id=hl-232-20><a class=lnlinks href=#hl-232-20>20</a>
</span><span class=lnt id=hl-232-21><a class=lnlinks href=#hl-232-21>21</a>
</span><span class=lnt id=hl-232-22><a class=lnlinks href=#hl-232-22>22</a>
</span><span class=lnt id=hl-232-23><a class=lnlinks href=#hl-232-23>23</a>
</span><span class=lnt id=hl-232-24><a class=lnlinks href=#hl-232-24>24</a>
</span><span class=lnt id=hl-232-25><a class=lnlinks href=#hl-232-25>25</a>
</span><span class=lnt id=hl-232-26><a class=lnlinks href=#hl-232-26>26</a>
</span><span class=lnt id=hl-232-27><a class=lnlinks href=#hl-232-27>27</a>
</span><span class=lnt id=hl-232-28><a class=lnlinks href=#hl-232-28>28</a>
</span><span class=lnt id=hl-232-29><a class=lnlinks href=#hl-232-29>29</a>
</span><span class=lnt id=hl-232-30><a class=lnlinks href=#hl-232-30>30</a>
</span><span class=lnt id=hl-232-31><a class=lnlinks href=#hl-232-31>31</a>
</span><span class=lnt id=hl-232-32><a class=lnlinks href=#hl-232-32>32</a>
</span><span class=lnt id=hl-232-33><a class=lnlinks href=#hl-232-33>33</a>
</span><span class=lnt id=hl-232-34><a class=lnlinks href=#hl-232-34>34</a>
</span><span class=lnt id=hl-232-35><a class=lnlinks href=#hl-232-35>35</a>
</span><span class=lnt id=hl-232-36><a class=lnlinks href=#hl-232-36>36</a>
</span><span class=lnt id=hl-232-37><a class=lnlinks href=#hl-232-37>37</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>특징:
</span></span><span class=line><span class=cl>- 컴퓨팅과 스토리지 분리
</span></span><span class=line><span class=cl>- 탄력적 확장
</span></span><span class=line><span class=cl>- 서버리스 운영
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>아키텍처:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>전통 방식:
</span></span><span class=line><span class=cl>[컴퓨팅 + 스토리지] → Scale Up
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>클라우드 네이티브:
</span></span><span class=line><span class=cl>[컴퓨팅 노드] ←→ [분리된 스토리지]
</span></span><span class=line><span class=cl>      ↕                    ↕
</span></span><span class=line><span class=cl>  독립 확장          독립 확장
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>장점:
</span></span><span class=line><span class=cl>- 컴퓨팅/스토리지 독립 확장
</span></span><span class=line><span class=cl>- 스냅샷 빠름 (CoW)
</span></span><span class=line><span class=cl>- 비용 효율
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>예시: Amazon Aurora
</span></span><span class=line><span class=cl>- 스토리지: 최대 128TB 자동 확장
</span></span><span class=line><span class=cl>- 읽기 복제본: 15개
</span></span><span class=line><span class=cl>- 인덱스: 스토리지 레이어에서 관리
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>구현 패턴:
</span></span><span class=line><span class=cl>1. 원격 인덱스 (Remote Index)
</span></span><span class=line><span class=cl>   - S3/EBS에 인덱스 저장
</span></span><span class=line><span class=cl>   - 로컬 캐시 활용
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. Serverless Index
</span></span><span class=line><span class=cl>   - 사용량 기반 과금
</span></span><span class=line><span class=cl>   - 자동 스케일
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. Multi-Tenant Index
</span></span><span class=line><span class=cl>   - 인덱스 공유
</span></span><span class=line><span class=cl>   - 격리 보장
</span></span></code></pre></td></tr></table></div></div><p><strong>트렌드 4: 실시간 분석을 위한 하이브리드 인덱스</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-233-1><a class=lnlinks href=#hl-233-1> 1</a>
</span><span class=lnt id=hl-233-2><a class=lnlinks href=#hl-233-2> 2</a>
</span><span class=lnt id=hl-233-3><a class=lnlinks href=#hl-233-3> 3</a>
</span><span class=lnt id=hl-233-4><a class=lnlinks href=#hl-233-4> 4</a>
</span><span class=lnt id=hl-233-5><a class=lnlinks href=#hl-233-5> 5</a>
</span><span class=lnt id=hl-233-6><a class=lnlinks href=#hl-233-6> 6</a>
</span><span class=lnt id=hl-233-7><a class=lnlinks href=#hl-233-7> 7</a>
</span><span class=lnt id=hl-233-8><a class=lnlinks href=#hl-233-8> 8</a>
</span><span class=lnt id=hl-233-9><a class=lnlinks href=#hl-233-9> 9</a>
</span><span class=lnt id=hl-233-10><a class=lnlinks href=#hl-233-10>10</a>
</span><span class=lnt id=hl-233-11><a class=lnlinks href=#hl-233-11>11</a>
</span><span class=lnt id=hl-233-12><a class=lnlinks href=#hl-233-12>12</a>
</span><span class=lnt id=hl-233-13><a class=lnlinks href=#hl-233-13>13</a>
</span><span class=lnt id=hl-233-14><a class=lnlinks href=#hl-233-14>14</a>
</span><span class=lnt id=hl-233-15><a class=lnlinks href=#hl-233-15>15</a>
</span><span class=lnt id=hl-233-16><a class=lnlinks href=#hl-233-16>16</a>
</span><span class=lnt id=hl-233-17><a class=lnlinks href=#hl-233-17>17</a>
</span><span class=lnt id=hl-233-18><a class=lnlinks href=#hl-233-18>18</a>
</span><span class=lnt id=hl-233-19><a class=lnlinks href=#hl-233-19>19</a>
</span><span class=lnt id=hl-233-20><a class=lnlinks href=#hl-233-20>20</a>
</span><span class=lnt id=hl-233-21><a class=lnlinks href=#hl-233-21>21</a>
</span><span class=lnt id=hl-233-22><a class=lnlinks href=#hl-233-22>22</a>
</span><span class=lnt id=hl-233-23><a class=lnlinks href=#hl-233-23>23</a>
</span><span class=lnt id=hl-233-24><a class=lnlinks href=#hl-233-24>24</a>
</span><span class=lnt id=hl-233-25><a class=lnlinks href=#hl-233-25>25</a>
</span><span class=lnt id=hl-233-26><a class=lnlinks href=#hl-233-26>26</a>
</span><span class=lnt id=hl-233-27><a class=lnlinks href=#hl-233-27>27</a>
</span><span class=lnt id=hl-233-28><a class=lnlinks href=#hl-233-28>28</a>
</span><span class=lnt id=hl-233-29><a class=lnlinks href=#hl-233-29>29</a>
</span><span class=lnt id=hl-233-30><a class=lnlinks href=#hl-233-30>30</a>
</span><span class=lnt id=hl-233-31><a class=lnlinks href=#hl-233-31>31</a>
</span><span class=lnt id=hl-233-32><a class=lnlinks href=#hl-233-32>32</a>
</span><span class=lnt id=hl-233-33><a class=lnlinks href=#hl-233-33>33</a>
</span><span class=lnt id=hl-233-34><a class=lnlinks href=#hl-233-34>34</a>
</span><span class=lnt id=hl-233-35><a class=lnlinks href=#hl-233-35>35</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>HTAP (Hybrid Transactional/Analytical Processing)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>요구사항:
</span></span><span class=line><span class=cl>- OLTP: 빠른 쓰기, 포인트 쿼리
</span></span><span class=line><span class=cl>- OLAP: 빠른 분석, 범위 쿼리
</span></span><span class=line><span class=cl>- 실시간: 최신 데이터 즉시 반영
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>하이브리드 전략:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. Delta + Main 구조
</span></span><span class=line><span class=cl>   [Delta Store] → 최근 데이터, Row-based, B-Tree
</span></span><span class=line><span class=cl>   [Main Store] → 과거 데이터, Column-based, Compressed
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   쿼리 시 병합
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2. 이중 인덱스
</span></span><span class=line><span class=cl>   - Row Index: OLTP
</span></span><span class=line><span class=cl>   - Column Index: OLAP
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   동기화 관리
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>3. 적응형 인덱스
</span></span><span class=line><span class=cl>   - 워크로드 패턴 학습
</span></span><span class=line><span class=cl>   - 자동 인덱스 전환
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>제품:
</span></span><span class=line><span class=cl>- SAP HANA
</span></span><span class=line><span class=cl>- MemSQL (SingleStore)
</span></span><span class=line><span class=cl>- TiDB
</span></span><span class=line><span class=cl>- CockroachDB
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>성능:
</span></span><span class=line><span class=cl>- OLTP: 밀리초
</span></span><span class=line><span class=cl>- OLAP: 초 단위
</span></span><span class=line><span class=cl>- 데이터 신선도: &lt;1초
</span></span></code></pre></td></tr></table></div></div><h4 id=73-대안-기술-및-경쟁-솔루션-1>7.3 대안 기술 및 경쟁 솔루션<a hidden class=anchor aria-hidden=true href=#73-대안-기술-및-경쟁-솔루션-1>#</a></h4><p><strong>영역별 주요 기술 및 대안</strong></p><table><thead><tr><th>영역</th><th>전통 기술</th><th>대안 기술</th><th>장단점</th><th>선택 기준</th></tr></thead><tbody><tr><td><strong>OLTP 인덱싱</strong></td><td>B+ Tree</td><td><strong>LSM-Tree</strong></td><td>(+) 쓰기 10배 빠름<br>(-) 읽기 증폭</td><td>쓰기 중심 워크로드</td></tr><tr><td></td><td></td><td><strong>Adaptive Radix Tree</strong></td><td>(+) 메모리 효율<br>(-) 구현 복잡</td><td>인메모리 DB</td></tr><tr><td><strong>전문 검색</strong></td><td>Inverted Index</td><td><strong>Suffix Array</strong></td><td>(+) 정규식 지원<br>(-) 구축 느림</td><td>코드 검색</td></tr><tr><td></td><td></td><td><strong>N-gram Index</strong></td><td>(+) 부분 매칭<br>(-) 공간 많음</td><td>퍼지 검색</td></tr><tr><td><strong>공간 검색</strong></td><td>R-Tree</td><td><strong>Geohash</strong></td><td>(+) 단순, 샤딩 용이<br>(-) 경계 문제</td><td>대규모 분산</td></tr><tr><td></td><td></td><td><strong>S2 Geometry</strong></td><td>(+) 정확, 계층적<br>(-) 복잡</td><td>고정밀 필요</td></tr><tr><td><strong>시계열</strong></td><td>B-Tree + Partition</td><td><strong>TSI (Time-Series Index)</strong></td><td>(+) 압축 우수<br>(-) 범용성 낮음</td><td>로그, 메트릭</td></tr><tr><td></td><td></td><td><strong>Skip List</strong></td><td>(+) 동시성 우수<br>(-) 메모리만</td><td>인메모리 시계열</td></tr><tr><td><strong>벡터 검색</strong></td><td>KD-Tree</td><td><strong>HNSW</strong></td><td>(+) 빠름<br>(-) 메모리 많음</td><td>정확도 우선</td></tr><tr><td></td><td></td><td><strong>IVF-PQ</strong></td><td>(+) 압축<br>(-) 정확도 하락</td><td>대규모, 비용 우선</td></tr><tr><td><strong>분산 인덱스</strong></td><td>Global Index</td><td><strong>Local Index + Routing</strong></td><td>(+) 확장성<br>(-) 크로스 샤드 느림</td><td>샤딩 키 있음</td></tr><tr><td></td><td></td><td><strong>Consistent Hashing</strong></td><td>(+) 리밸런싱 최소<br>(-) 범위 쿼리 불가</td><td>Key-Value 스토어</td></tr></tbody></table><p><strong>심층 비교: LSM-Tree vs B-Tree</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-234-1><a class=lnlinks href=#hl-234-1> 1</a>
</span><span class=lnt id=hl-234-2><a class=lnlinks href=#hl-234-2> 2</a>
</span><span class=lnt id=hl-234-3><a class=lnlinks href=#hl-234-3> 3</a>
</span><span class=lnt id=hl-234-4><a class=lnlinks href=#hl-234-4> 4</a>
</span><span class=lnt id=hl-234-5><a class=lnlinks href=#hl-234-5> 5</a>
</span><span class=lnt id=hl-234-6><a class=lnlinks href=#hl-234-6> 6</a>
</span><span class=lnt id=hl-234-7><a class=lnlinks href=#hl-234-7> 7</a>
</span><span class=lnt id=hl-234-8><a class=lnlinks href=#hl-234-8> 8</a>
</span><span class=lnt id=hl-234-9><a class=lnlinks href=#hl-234-9> 9</a>
</span><span class=lnt id=hl-234-10><a class=lnlinks href=#hl-234-10>10</a>
</span><span class=lnt id=hl-234-11><a class=lnlinks href=#hl-234-11>11</a>
</span><span class=lnt id=hl-234-12><a class=lnlinks href=#hl-234-12>12</a>
</span><span class=lnt id=hl-234-13><a class=lnlinks href=#hl-234-13>13</a>
</span><span class=lnt id=hl-234-14><a class=lnlinks href=#hl-234-14>14</a>
</span><span class=lnt id=hl-234-15><a class=lnlinks href=#hl-234-15>15</a>
</span><span class=lnt id=hl-234-16><a class=lnlinks href=#hl-234-16>16</a>
</span><span class=lnt id=hl-234-17><a class=lnlinks href=#hl-234-17>17</a>
</span><span class=lnt id=hl-234-18><a class=lnlinks href=#hl-234-18>18</a>
</span><span class=lnt id=hl-234-19><a class=lnlinks href=#hl-234-19>19</a>
</span><span class=lnt id=hl-234-20><a class=lnlinks href=#hl-234-20>20</a>
</span><span class=lnt id=hl-234-21><a class=lnlinks href=#hl-234-21>21</a>
</span><span class=lnt id=hl-234-22><a class=lnlinks href=#hl-234-22>22</a>
</span><span class=lnt id=hl-234-23><a class=lnlinks href=#hl-234-23>23</a>
</span><span class=lnt id=hl-234-24><a class=lnlinks href=#hl-234-24>24</a>
</span><span class=lnt id=hl-234-25><a class=lnlinks href=#hl-234-25>25</a>
</span><span class=lnt id=hl-234-26><a class=lnlinks href=#hl-234-26>26</a>
</span><span class=lnt id=hl-234-27><a class=lnlinks href=#hl-234-27>27</a>
</span><span class=lnt id=hl-234-28><a class=lnlinks href=#hl-234-28>28</a>
</span><span class=lnt id=hl-234-29><a class=lnlinks href=#hl-234-29>29</a>
</span><span class=lnt id=hl-234-30><a class=lnlinks href=#hl-234-30>30</a>
</span><span class=lnt id=hl-234-31><a class=lnlinks href=#hl-234-31>31</a>
</span><span class=lnt id=hl-234-32><a class=lnlinks href=#hl-234-32>32</a>
</span><span class=lnt id=hl-234-33><a class=lnlinks href=#hl-234-33>33</a>
</span><span class=lnt id=hl-234-34><a class=lnlinks href=#hl-234-34>34</a>
</span><span class=lnt id=hl-234-35><a class=lnlinks href=#hl-234-35>35</a>
</span><span class=lnt id=hl-234-36><a class=lnlinks href=#hl-234-36>36</a>
</span><span class=lnt id=hl-234-37><a class=lnlinks href=#hl-234-37>37</a>
</span><span class=lnt id=hl-234-38><a class=lnlinks href=#hl-234-38>38</a>
</span><span class=lnt id=hl-234-39><a class=lnlinks href=#hl-234-39>39</a>
</span><span class=lnt id=hl-234-40><a class=lnlinks href=#hl-234-40>40</a>
</span><span class=lnt id=hl-234-41><a class=lnlinks href=#hl-234-41>41</a>
</span><span class=lnt id=hl-234-42><a class=lnlinks href=#hl-234-42>42</a>
</span><span class=lnt id=hl-234-43><a class=lnlinks href=#hl-234-43>43</a>
</span><span class=lnt id=hl-234-44><a class=lnlinks href=#hl-234-44>44</a>
</span><span class=lnt id=hl-234-45><a class=lnlinks href=#hl-234-45>45</a>
</span><span class=lnt id=hl-234-46><a class=lnlinks href=#hl-234-46>46</a>
</span><span class=lnt id=hl-234-47><a class=lnlinks href=#hl-234-47>47</a>
</span><span class=lnt id=hl-234-48><a class=lnlinks href=#hl-234-48>48</a>
</span><span class=lnt id=hl-234-49><a class=lnlinks href=#hl-234-49>49</a>
</span><span class=lnt id=hl-234-50><a class=lnlinks href=#hl-234-50>50</a>
</span><span class=lnt id=hl-234-51><a class=lnlinks href=#hl-234-51>51</a>
</span><span class=lnt id=hl-234-52><a class=lnlinks href=#hl-234-52>52</a>
</span><span class=lnt id=hl-234-53><a class=lnlinks href=#hl-234-53>53</a>
</span><span class=lnt id=hl-234-54><a class=lnlinks href=#hl-234-54>54</a>
</span><span class=lnt id=hl-234-55><a class=lnlinks href=#hl-234-55>55</a>
</span><span class=lnt id=hl-234-56><a class=lnlinks href=#hl-234-56>56</a>
</span><span class=lnt id=hl-234-57><a class=lnlinks href=#hl-234-57>57</a>
</span><span class=lnt id=hl-234-58><a class=lnlinks href=#hl-234-58>58</a>
</span><span class=lnt id=hl-234-59><a class=lnlinks href=#hl-234-59>59</a>
</span><span class=lnt id=hl-234-60><a class=lnlinks href=#hl-234-60>60</a>
</span><span class=lnt id=hl-234-61><a class=lnlinks href=#hl-234-61>61</a>
</span><span class=lnt id=hl-234-62><a class=lnlinks href=#hl-234-62>62</a>
</span><span class=lnt id=hl-234-63><a class=lnlinks href=#hl-234-63>63</a>
</span><span class=lnt id=hl-234-64><a class=lnlinks href=#hl-234-64>64</a>
</span><span class=lnt id=hl-234-65><a class=lnlinks href=#hl-234-65>65</a>
</span><span class=lnt id=hl-234-66><a class=lnlinks href=#hl-234-66>66</a>
</span><span class=lnt id=hl-234-67><a class=lnlinks href=#hl-234-67>67</a>
</span><span class=lnt id=hl-234-68><a class=lnlinks href=#hl-234-68>68</a>
</span><span class=lnt id=hl-234-69><a class=lnlinks href=#hl-234-69>69</a>
</span><span class=lnt id=hl-234-70><a class=lnlinks href=#hl-234-70>70</a>
</span><span class=lnt id=hl-234-71><a class=lnlinks href=#hl-234-71>71</a>
</span><span class=lnt id=hl-234-72><a class=lnlinks href=#hl-234-72>72</a>
</span><span class=lnt id=hl-234-73><a class=lnlinks href=#hl-234-73>73</a>
</span><span class=lnt id=hl-234-74><a class=lnlinks href=#hl-234-74>74</a>
</span><span class=lnt id=hl-234-75><a class=lnlinks href=#hl-234-75>75</a>
</span><span class=lnt id=hl-234-76><a class=lnlinks href=#hl-234-76>76</a>
</span><span class=lnt id=hl-234-77><a class=lnlinks href=#hl-234-77>77</a>
</span><span class=lnt id=hl-234-78><a class=lnlinks href=#hl-234-78>78</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>LSM-Tree (Log-Structured Merge-Tree) 동작 원리
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>LSMTree</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    구조:
</span></span></span><span class=line><span class=cl><span class=s2>    MemTable (메모리) → 쓰기 빠름
</span></span></span><span class=line><span class=cl><span class=s2>        ↓ (크기 초과 시)
</span></span></span><span class=line><span class=cl><span class=s2>    SSTable Level 0 (디스크) → 정렬됨
</span></span></span><span class=line><span class=cl><span class=s2>        ↓ (압축)
</span></span></span><span class=line><span class=cl><span class=s2>    SSTable Level 1
</span></span></span><span class=line><span class=cl><span class=s2>        ↓
</span></span></span><span class=line><span class=cl><span class=s2>    SSTable Level 2
</span></span></span><span class=line><span class=cl><span class=s2>    ...
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>memtable</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># 메모리 테이블</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>sstables</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># 디스크 테이블 (레벨별)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>put</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;쓰기: O(1), 메모리만 접근&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>memtable</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 메모리 테이블 크기 초과 시</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>memtable</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>MEMTABLE_SIZE</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_flush_to_disk</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;읽기: 여러 레벨 검색 (읽기 증폭)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1. MemTable 확인 (최신)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>key</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>memtable</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>memtable</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 2. 각 SSTable 레벨 순회 (오래된 순)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>sstable</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>sstables</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>key</span> <span class=ow>in</span> <span class=n>sstable</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>sstable</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_flush_to_disk</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;메모리 → 디스크&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 정렬하여 SSTable 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>sstable</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=nb>sorted</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>memtable</span><span class=o>.</span><span class=n>items</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>sstables</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>sstable</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>memtable</span><span class=o>.</span><span class=n>clear</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 압축 (Compaction)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>sstables</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>MAX_SSTABLES_PER_LEVEL</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_compact</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_compact</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;여러 SSTable 병합&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># Level 0의 SSTable들을 Level 1로 병합</span>
</span></span><span class=line><span class=cl>        <span class=n>merged</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>sstable</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>sstables</span><span class=p>[:</span><span class=n>MAX_SSTABLES_PER_LEVEL</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>merged</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>sstable</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 병합된 SSTable을 다음 레벨로</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>sstables</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>sstables</span><span class=p>[</span><span class=n>MAX_SSTABLES_PER_LEVEL</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>sstables</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>merged</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 성능 비교</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>쓰기 성능:
</span></span></span><span class=line><span class=cl><span class=s2>B-Tree: O(log n) + 디스크 I/O (랜덤)
</span></span></span><span class=line><span class=cl><span class=s2>LSM-Tree: O(1) + 순차 I/O
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>읽기 성능:
</span></span></span><span class=line><span class=cl><span class=s2>B-Tree: O(log n)
</span></span></span><span class=line><span class=cl><span class=s2>LSM-Tree: O(k log n), k=레벨 수 (읽기 증폭)
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>사용 사례:
</span></span></span><span class=line><span class=cl><span class=s2>B-Tree: MySQL, PostgreSQL (읽기 중심)
</span></span></span><span class=line><span class=cl><span class=s2>LSM-Tree: RocksDB, Cassandra, HBase (쓰기 중심)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>혁신적 대안: Learned Index Structures</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-235-1><a class=lnlinks href=#hl-235-1> 1</a>
</span><span class=lnt id=hl-235-2><a class=lnlinks href=#hl-235-2> 2</a>
</span><span class=lnt id=hl-235-3><a class=lnlinks href=#hl-235-3> 3</a>
</span><span class=lnt id=hl-235-4><a class=lnlinks href=#hl-235-4> 4</a>
</span><span class=lnt id=hl-235-5><a class=lnlinks href=#hl-235-5> 5</a>
</span><span class=lnt id=hl-235-6><a class=lnlinks href=#hl-235-6> 6</a>
</span><span class=lnt id=hl-235-7><a class=lnlinks href=#hl-235-7> 7</a>
</span><span class=lnt id=hl-235-8><a class=lnlinks href=#hl-235-8> 8</a>
</span><span class=lnt id=hl-235-9><a class=lnlinks href=#hl-235-9> 9</a>
</span><span class=lnt id=hl-235-10><a class=lnlinks href=#hl-235-10>10</a>
</span><span class=lnt id=hl-235-11><a class=lnlinks href=#hl-235-11>11</a>
</span><span class=lnt id=hl-235-12><a class=lnlinks href=#hl-235-12>12</a>
</span><span class=lnt id=hl-235-13><a class=lnlinks href=#hl-235-13>13</a>
</span><span class=lnt id=hl-235-14><a class=lnlinks href=#hl-235-14>14</a>
</span><span class=lnt id=hl-235-15><a class=lnlinks href=#hl-235-15>15</a>
</span><span class=lnt id=hl-235-16><a class=lnlinks href=#hl-235-16>16</a>
</span><span class=lnt id=hl-235-17><a class=lnlinks href=#hl-235-17>17</a>
</span><span class=lnt id=hl-235-18><a class=lnlinks href=#hl-235-18>18</a>
</span><span class=lnt id=hl-235-19><a class=lnlinks href=#hl-235-19>19</a>
</span><span class=lnt id=hl-235-20><a class=lnlinks href=#hl-235-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>MIT의 Learned Index 연구 결과:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>성능 개선:
</span></span><span class=line><span class=cl>- 메모리: 99% 절감 (vs B-Tree)
</span></span><span class=line><span class=cl>- 속도: 특정 분포에서 3배 빠름
</span></span><span class=line><span class=cl>- 예측 오차: ±100 위치 이내
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>한계:
</span></span><span class=line><span class=cl>- 쓰기 시 모델 재학습 필요
</span></span><span class=line><span class=cl>- 데이터 분포 변화 대응 어려움
</span></span><span class=line><span class=cl>- 범용성 부족
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>적용 사례:
</span></span><span class=line><span class=cl>- Google: BigTable의 일부 워크로드
</span></span><span class=line><span class=cl>- 연구 단계: 상용화 제한적
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>미래 전망:
</span></span><span class=line><span class=cl>- 하이브리드: 전통 인덱스 + 학습 모델
</span></span><span class=line><span class=cl>- 적응형: 워크로드별 자동 전환
</span></span><span class=line><span class=cl>- 연합 학습: 분산 환경 모델 학습
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=최종-정리-및-학습-가이드-1>최종 정리 및 학습 가이드<a hidden class=anchor aria-hidden=true href=#최종-정리-및-학습-가이드-1>#</a></h2><h3 id=내용-종합-1>내용 종합<a hidden class=anchor aria-hidden=true href=#내용-종합-1>#</a></h3><p>인덱싱은 데이터베이스 성능 최적화의 핵심 기술로, 검색 시간을 선형 O(n)에서 로그 O(log n) 또는 상수 O(1)로 개선합니다. B-Tree 계열이 가장 보편적이며, 용도에 따라 Hash, Bitmap, Full-Text, Spatial 등 다양한 인덱스 구조가 존재합니다.</p><p><strong>핵심 원리</strong>는 디스크 I/O 최소화, 균형 유지, 공간 지역성 활용입니다. 인덱스는 추가 저장 공간과 쓰기 오버헤드를 대가로 읽기 성능을 극적으로 향상시키는 공간-시간 트레이드오프의 전형입니다.</p><p><strong>실무 적용</strong>에서는 쿼리 패턴 분석, 선택도 평가, 복합 인덱스 설계, 모니터링 및 유지보수가 중요합니다. 단편화 관리, 미사용 인덱스 제거, 통계 갱신 등 지속적인 관리가 필요합니다.</p><p><strong>최신 트렌드</strong>로는 학습 기반 인덱스, 벡터 검색, 클라우드 네이티브 아키텍처, HTAP를 위한 하이브리드 인덱스가 있으며, 고차원 데이터와 분산 환경의 도전 과제가 여전히 존재합니다.</p><h3 id=실무-적용-가이드-1>실무 적용 가이드<a hidden class=anchor aria-hidden=true href=#실무-적용-가이드-1>#</a></h3><p><strong>1단계: 현황 분석</strong></p><ul><li>슬로우 쿼리 로그 분석</li><li>실행 계획 검토 (EXPLAIN)</li><li>인덱스 사용률 측정</li></ul><p><strong>2단계: 인덱스 설계</strong></p><ul><li>쿼리 패턴별 인덱스 후보 식별</li><li>선택도 계산 및 우선순위 결정</li><li>복합 인덱스 컬럼 순서 최적화</li></ul><p><strong>3단계: 구현 및 테스트</strong></p><ul><li>개발/스테이징 환경 적용</li><li>성능 측정 (전/후 비교)</li><li>부작용 모니터링</li></ul><p><strong>4단계: 운영 및 유지보수</strong></p><ul><li>정기적 단편화 체크</li><li>미사용 인덱스 제거</li><li>통계 정보 갱신 자동화</li></ul><h3 id=학습-로드맵>학습 로드맵<a hidden class=anchor aria-hidden=true href=#학습-로드맵>#</a></h3><p><strong>초급 (1-2개월)</strong></p><ol><li>B-Tree 기본 개념 및 동작 원리</li><li>인덱스 생성/삭제 SQL 문법</li><li>EXPLAIN으로 실행 계획 읽기</li><li>단일 컬럼 인덱스 설계</li></ol><p><strong>중급 (3-4개월)</strong>
5. 복합 인덱스 설계 원칙
6. 인덱스 유형별 특성 (Hash, Bitmap 등)
7. 쿼리 최적화 기법
8. 인덱스 모니터링 및 튜닝</p><p><strong>고급 (6개월+)</strong>
9. 분산 환경 인덱싱 전략
10. 특수 인덱스 (Full-Text, Spatial, Vector)
11. 학습 기반 인덱스 연구
12. 대규모 시스템 아키텍처 설계</p><h3 id=학습-항목-정리-1>학습 항목 정리<a hidden class=anchor aria-hidden=true href=#학습-항목-정리-1>#</a></h3><table><thead><tr><th>카테고리</th><th>Phase</th><th>항목</th><th>중요도</th><th>학습 목표</th><th>실무 연관성</th><th>설명</th></tr></thead><tbody><tr><td>기초</td><td>1</td><td>B-Tree 구조</td><td>필수</td><td>트리 탐색 이해</td><td>매우 높음</td><td>가장 보편적인 인덱스, 모든 DBMS 지원</td></tr><tr><td>기초</td><td>1</td><td>인덱스 vs 테이블 스캔</td><td>필수</td><td>성능 차이 체감</td><td>높음</td><td>인덱스의 필요성 이해</td></tr><tr><td>핵심</td><td>2</td><td>복잡도 분석</td><td>필수</td><td>O(log n) 증명</td><td>중간</td><td>이론적 기반</td></tr><tr><td>핵심</td><td>2</td><td>인덱스 생명주기</td><td>필수</td><td>삽입/삭제/재조정</td><td>높음</td><td>쓰기 오버헤드 이해</td></tr><tr><td>핵심</td><td>3</td><td>선택도와 카디널리티</td><td>필수</td><td>인덱스 효과 예측</td><td>매우 높음</td><td>인덱스 설계 핵심 지표</td></tr><tr><td>핵심</td><td>3</td><td>트레이드오프 분석</td><td>필수</td><td>읽기 vs 쓰기 균형</td><td>높음</td><td>의사결정 기준</td></tr><tr><td>응용</td><td>4</td><td>복합 인덱스 설계</td><td>필수</td><td>컬럼 순서 최적화</td><td>매우 높음</td><td>실무 필수 기술</td></tr><tr><td>응용</td><td>4</td><td>Hash/Bitmap 인덱스</td><td>권장</td><td>특수 인덱스 활용</td><td>중간</td><td>특정 시나리오 최적화</td></tr><tr><td>응용</td><td>5</td><td>실행 계획 분석</td><td>필수</td><td>EXPLAIN 해석</td><td>매우 높음</td><td>트러블슈팅 핵심</td></tr><tr><td>응용</td><td>5</td><td>커버링 인덱스</td><td>권장</td><td>I/O 최소화</td><td>높음</td><td>성능 극대화 기법</td></tr><tr><td>운영</td><td>6</td><td>인덱스 모니터링</td><td>필수</td><td>사용률/단편화 추적</td><td>매우 높음</td><td>운영 안정성</td></tr><tr><td>운영</td><td>6</td><td>재구성 전략</td><td>필수</td><td>REINDEX 타이밍</td><td>높음</td><td>성능 유지</td></tr><tr><td>고급</td><td>7</td><td>분산 인덱싱</td><td>선택</td><td>샤딩 환경 설계</td><td>중간</td><td>대규모 시스템</td></tr><tr><td>고급</td><td>7</td><td>학습 기반 인덱스</td><td>선택</td><td>최신 연구 이해</td><td>낮음</td><td>미래 기술</td></tr><tr><td>고급</td><td>7</td><td>벡터 인덱스</td><td>선택</td><td>AI/ML 검색</td><td>증가 중</td><td>최신 트렌드</td></tr></tbody></table><hr><h2 id=용어-정리-2>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-2>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>정의</th><th>관련 개념</th><th>실무 활용</th></tr></thead><tbody><tr><td>핵심</td><td>인덱스(Index)</td><td>데이터 검색 속도를 향상시키기 위한 자료구조</td><td>B-Tree, 포인터</td><td>쿼리 성능 최적화</td></tr><tr><td>핵심</td><td>선택도(Selectivity)</td><td>조건을 만족하는 행의 비율 (고유값/전체행)</td><td>카디널리티, 히스토그램</td><td>인덱스 효과 예측</td></tr><tr><td>핵심</td><td>카디널리티(Cardinality)</td><td>컬럼의 고유 값 개수</td><td>선택도, 분포</td><td>인덱스 설계 기준</td></tr><tr><td>구조</td><td>B-Tree</td><td>균형 다진 탐색 트리</td><td>B+ Tree, 팬아웃</td><td>범용 인덱스</td></tr><tr><td>구조</td><td>Hash Index</td><td>해시 함수 기반 직접 접근</td><td>버킷, 충돌</td><td>등가 검색 특화</td></tr><tr><td>구조</td><td>Bitmap Index</td><td>비트 배열 기반 인덱스</td><td>비트 연산, 압축</td><td>저카디널리티 최적</td></tr><tr><td>운영</td><td>단편화(Fragmentation)</td><td>인덱스 페이지의 비효율적 공간 사용</td><td>블로트, 재구성</td><td>성능 저하 원인</td></tr><tr><td>운영</td><td>커버링 인덱스(Covering Index)</td><td>쿼리의 모든 컬럼을 포함한 인덱스</td><td>INCLUDE, Index-Only Scan</td><td>I/O 최소화</td></tr><tr><td>최적화</td><td>실행 계획(Execution Plan)</td><td>쿼리 실행 방법에 대한 DBMS 결정</td><td>EXPLAIN, 옵티마이저</td><td>성능 분석</td></tr><tr><td>최적화</td><td>Index Scan</td><td>인덱스를 사용한 검색</td><td>Index Seek, Full Scan</td><td>효율적 접근</td></tr><tr><td>분산</td><td>샤딩(Sharding)</td><td>데이터를 여러 노드로 분산</td><td>파티셔닝, 샤드 키</td><td>수평 확장</td></tr><tr><td>분산</td><td>글로벌 인덱스(Global Index)</td><td>모든 샤드를 포괄하는 인덱스</td><td>로컬 인덱스, 분산 트랜잭션</td><td>크로스 샤드 쿼리</td></tr></tbody></table><hr><h2 id=참고-및-출처-2>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-2>#</a></h2><ul><li><a href=https://www.db-book.com/>Database System Concepts (7th Edition)</a> - Abraham Silberschatz et al.</li><li><a href=https://www.postgresql.org/docs/current/indexes.html>PostgreSQL Documentation - Indexes</a></li><li><a href=https://dev.mysql.com/doc/refman/8.0/en/optimization-indexes.html>MySQL 8.0 Reference Manual - Optimization and Indexes</a></li><li><a href=https://arxiv.org/abs/1712.01208>The Case for Learned Index Structures</a> - Tim Kraska et al., 2018</li><li><a href=https://w6113.github.io/files/papers/btreesurvey-graefe.pdf>Modern B-Tree Techniques</a> - Goetz Graefe, 2011</li><li><a href=https://github.com/facebook/rocksdb/wiki>RocksDB Wiki - LSM Tree</a></li><li><a href=https://www.elastic.co/guide/en/elasticsearch/guide/current/index.html>Elasticsearch: The Definitive Guide</a></li><li><a href=https://use-the-index-luke.com/>Use The Index, Luke!</a> - Markus Winand</li><li><a href=https://www.oreilly.com/library/view/high-performance-mysql/9781492080503/>High Performance MySQL (4th Edition)</a></li><li><a href=https://dataintensive.net/>Designing Data-Intensive Applications</a> - Martin Kleppmann</li></ul><hr><h1 id=indexing--종합-조사phase-17-실무-중심>Indexing — 종합 조사(Phase 1–7, 실무 중심)<a hidden class=anchor aria-hidden=true href=#indexing--종합-조사phase-17-실무-중심>#</a></h1><p>전문가 관점에서 **인덱싱(Indexing)**을 기초→핵심 원리→구현→운영→고급 주제 순으로 체계화했습니다. 실무 의사결정과 교육을 동시에 지원하도록 표준 형식(장점/단점 표, 실습, 사례, 가이드)을 준수합니다.</p><hr><h2 id=1단계-기본-분석-및-검증-2>1단계: 기본 분석 및 검증<a hidden class=anchor aria-hidden=true href=#1단계-기본-분석-및-검증-2>#</a></h2><h3 id=1-주제-유형-식별-ai-분류>1) 주제 유형 식별 (A–I 분류)<a hidden class=anchor aria-hidden=true href=#1-주제-유형-식별-ai-분류>#</a></h3><ul><li><strong>주 유형</strong>: I형(성능/최적화형)</li><li><strong>부 유형</strong>: A형(이론/개념), C형(아키텍처/패턴), B형(도구/기술)</li><li><strong>선정 이유</strong>: 인덱스는 질의 성능을 좌우하는 대표적 물리 설계 요소이며, 구조·알고리즘·엔진별 구현 차이가 실무 성능에 직접 영향.</li></ul><h3 id=2-복잡도-평가-1>2) 복잡도 평가<a hidden class=anchor aria-hidden=true href=#2-복잡도-평가-1>#</a></h3><ul><li><strong>Level 3 (고급)</strong>: 다양한 인덱스 구조(B-트리, 해시, GiST/GIN, BRIN, R-트리, LSM-트리), 워크로드(OLTP/OLAP), 스토리지(SSD/HDD), 동시성(MVCC)까지 다룸.</li></ul><h3 id=3-대표-태그-영문>3) 대표 태그 (영문)<a hidden class=anchor aria-hidden=true href=#3-대표-태그-영문>#</a></h3><ul><li><strong>Indexing, Database-Indexes, Query-Optimization, Physical-Design, B-Tree</strong></li></ul><h3 id=4-분류-체계-검증-1>4) 분류 체계 검증<a hidden class=anchor aria-hidden=true href=#4-분류-체계-검증-1>#</a></h3><ul><li><p>제안 분류: <strong>Data & Database Systems > Data Fundamentals > Data Modeling > Physical Design</strong></p></li><li><p><strong>적합성 체크리스트</strong></p><ul><li><input checked disabled type=checkbox> 현재 분류 구조(§6)에 해당 위치 존재</li><li><input checked disabled type=checkbox> 상위/하위 카테고리 배치 타당 (물리 설계의 핵심 요소)</li><li><input disabled type=checkbox> 중복/누락/경계 모호성 없음 → <em>개선 필요: Query Processing, Database Optimization과의 교차성 명시 필요</em></li><li><input checked disabled type=checkbox> 실무 탐색 용이</li><li><input checked disabled type=checkbox> 유사 주제 일관성 확보</li><li><input checked disabled type=checkbox> 크로스 도메인 연결성(검색/IR, 키밸류/LSM 등) 반영</li></ul></li></ul><p><strong>개선 제안</strong></p><ul><li><p>인덱싱 문서를 <strong>교차 레퍼런스</strong>로 연결:</p><ul><li>Data Operations > Query Processing (실행계획, 옵티마이저)</li><li>Data Operations > Database Optimization (튜닝)</li><li>Database Technologies > Specialized Systems (LSM/Columnar/IR)</li></ul></li><li><p><strong>용어 통일</strong>: <em>Indexing(인덱싱)</em>, <em>Index(인덱스)</em>, <em>Clustered/Nonclustered(클러스터형/비클러스터형)</em>, <em>Covering(커버링)</em>.</p></li></ul><h3 id=5-핵심-요약-250자>5) 핵심 요약 (≤250자)<a hidden class=anchor aria-hidden=true href=#5-핵심-요약-250자>#</a></h3><p>인덱싱은 데이터 검색·정렬 비용을 낮추기 위한 <strong>물리적 데이터 구조 설계</strong>다. 워크로드·데이터 분포·스토리지 특성에 따라 인덱스 유형과 키 설계를 최적화해야 하며, 쓰기 비용·저장 공간·정확도·동시성과의 <strong>트레이드오프</strong>가 핵심이다.</p><h3 id=6-전체-개요-600자>6) 전체 개요 (≤600자)<a hidden class=anchor aria-hidden=true href=#6-전체-개요-600자>#</a></h3><p>인덱스는 <strong>검색(=선택/조인/정렬) 비용을 낮추는 보조 구조</strong>다. 대표 구조는 <strong>B-트리(B-Tree)</strong>, <strong>해시(Hash)</strong>, <strong>R-트리(R-Tree)</strong>, <strong>GiST/GIN</strong>, <strong>BRIN</strong>, <strong>LSM-트리(Log-Structured Merge-Tree)</strong> 등이며, 엔진(예: PostgreSQL, MySQL/InnoDB, SQLite, RocksDB, Elasticsearch)에 따라 내부 동작과 동시성 제어, 유지비용이 다르다.
설계는 <strong>질의 패턴(필터/조인/정렬/그룹)</strong>, <strong>데이터 분포/카디널리티</strong>, <strong>갱신 빈도</strong>, <strong>스토리지/메모리</strong>, <strong>옵티마이저 통계</strong>를 종합해 결정한다. 실무에서는 과도한 인덱스가 쓰기 성능과 공간을 잠식하므로, <strong>커버링 인덱스</strong>, <strong>부분/표현식 인덱스</strong>, <strong>다중 컬럼 정렬순서</strong>, <strong>파티셔닝/샤딩</strong>과의 상호작용, <strong>모니터링과 회귀 방지</strong>가 필수다.</p><hr><h2 id=2단계-개념-체계화-및-검증-3>2단계: 개념 체계화 및 검증<a hidden class=anchor aria-hidden=true href=#2단계-개념-체계화-및-검증-3>#</a></h2><h3 id=7-핵심-개념-정리-1>7) 핵심 개념 정리<a hidden class=anchor aria-hidden=true href=#7-핵심-개념-정리-1>#</a></h3><ul><li><strong>인덱스(Index)</strong>: 테이블 레코드 위치를 빠르게 찾는 보조 자료구조.</li><li><strong>키( Key )</strong>: 인덱스 정렬·탐색 기준 컬럼(단일/복합, 표현식 가능).</li><li><strong>선택도(Selectivity)</strong>: 조건으로 걸러지는 비율. 낮을수록(=희귀할수록) 인덱스 효율 ↑.</li><li><strong>카디널리티(Cardinality)</strong>: 고유 값 개수. 높을수록 탐색 이점 ↑.</li><li><strong>커버링 인덱스(Covering Index)</strong>: 인덱스만으로 질의가 해결되는 형태(INCLUDE/INCLUDEd columns). 테이블 랜덤 I/O 감소.</li><li><strong>클러스터형(Clustered) vs 비클러스터형(Nonclustered)</strong>: 물리 저장 순서와의 일치 여부.</li><li><strong>정렬 이용(ORDER BY)·그룹화(GROUP BY)</strong>: 인덱스 정렬성을 활용해 정렬/그룹 비용 절감.</li><li><strong>옵티마이저(Optimizer) 통계</strong>: 선택도 추정·계획 선택의 근거. 최신성 중요.</li><li><strong>지속성/유지비용</strong>: DML(INSERT/UPDATE/DELETE) 시 인덱스 갱신·스플릿·머지·컴팩션 비용.</li></ul><h3 id=8-실무-연관성-분석-1>8) 실무 연관성 분석<a hidden class=anchor aria-hidden=true href=#8-실무-연관성-분석-1>#</a></h3><ul><li><strong>무엇이</strong>: 조회 지연·CPU/RAM·스토리지 비용의 직접 원인.</li><li><strong>어떻게</strong>: 적절한 인덱스/키 순서/부분 인덱스/커버링/필터 조건에 맞춘 표현식 인덱스로 I/O를 선제 차단.</li><li><strong>왜</strong>: 읽기 지배적 시스템(OLTP/리드 레플리카/검색)에서 <strong>P95/P99 지연</strong>을 급격히 개선.</li></ul><hr><h2 id=3단계-phase별-상세-조사-및-검증-1>3단계: Phase별 상세 조사 및 검증<a hidden class=anchor aria-hidden=true href=#3단계-phase별-상세-조사-및-검증-1>#</a></h2><h3 id=phase-1-기초-조사-및-개념-정립-2>Phase 1: 기초 조사 및 개념 정립<a hidden class=anchor aria-hidden=true href=#phase-1-기초-조사-및-개념-정립-2>#</a></h3><h4 id=11-개념-정의-및-본질>1.1 개념 정의 및 본질<a hidden class=anchor aria-hidden=true href=#11-개념-정의-및-본질>#</a></h4><ul><li>인덱싱은 <strong>질의 수행 시 후보 레코드 집합을 최소화</strong>해 디스크·CPU 접근을 줄이는 기술.</li></ul><h4 id=12-등장-배경-및-발전>1.2 등장 배경 및 발전<a hidden class=anchor aria-hidden=true href=#12-등장-배경-및-발전>#</a></h4><ul><li>데이터 규모 증가와 디스크 랜덤 I/O 비용이 크던 시절부터 <strong>B-트리</strong>가 표준으로 채택. 이후 공간/유사도/텍스트/대용량 시나리오에서 <strong>R-트리, GiST/GIN, BRIN, LSM-트리</strong> 등으로 확장.</li></ul><h4 id=13-해결하는-문제-및-핵심-목적-2>1.3 해결하는 문제 및 핵심 목적<a hidden class=anchor aria-hidden=true href=#13-해결하는-문제-및-핵심-목적-2>#</a></h4><ul><li><strong>검색/조인/정렬 가속</strong>, <strong>리소스 절감</strong>, <strong>일관된 지연(latency) 확보</strong>.</li></ul><h4 id=14-전제-조건-및-요구사항-2>1.4 전제 조건 및 요구사항<a hidden class=anchor aria-hidden=true href=#14-전제-조건-및-요구사항-2>#</a></h4><ul><li>안정적 통계 갱신, 충분한 메모리(버퍼풀), 일관된 스키마 관리, 적정 파티셔닝.</li></ul><h4 id=15-핵심-특징차별점>1.5 핵심 특징(차별점)<a hidden class=anchor aria-hidden=true href=#15-핵심-특징차별점>#</a></h4><ul><li><strong>정렬성(Ordering)</strong> 활용 가능(B-트리 계열), <strong>특화 도메인</strong>(텍스트/벡터/공간) 지원, <strong>부분/표현식 인덱스</strong>로 질의 맞춤화.</li></ul><h4 id=16-i형-성능-목표-및-기준선>1.6 (I형) 성능 목표 및 기준선<a hidden class=anchor aria-hidden=true href=#16-i형-성능-목표-및-기준선>#</a></h4><ul><li>목표: P95&lt;50ms(OLTP 기준 예), 스캔 행 수/랜덤 I/O 수를 기준선으로 삼아 개선률 추적.</li></ul><h4 id=17-역사진화심화>1.7 역사·진화(심화)<a hidden class=anchor aria-hidden=true href=#17-역사진화심화>#</a></h4><ul><li>HDD→SSD 전환, 대용량 시퀀셜 쓰기를 활용한 <strong>LSM-트리</strong> 채택 확대(키밸류/타임시리즈).</li></ul><h4 id=18-산업-적용심화>1.8 산업 적용(심화)<a hidden class=anchor aria-hidden=true href=#18-산업-적용심화>#</a></h4><ul><li>검색(Elasticsearch/Lucene), 키밸류(RocksDB/LevelDB), RDBMS 전반(PostgreSQL/MySQL/SQL Server/Oracle/SQLite).</li></ul><hr><h3 id=phase-2-핵심-원리-및-이론적-기반-2>Phase 2: 핵심 원리 및 이론적 기반<a hidden class=anchor aria-hidden=true href=#phase-2-핵심-원리-및-이론적-기반-2>#</a></h3><h4 id=21-설계-철학>2.1 설계 철학<a hidden class=anchor aria-hidden=true href=#21-설계-철학>#</a></h4><ul><li>자주 <strong>질의되는 컬럼</strong>에 대해 <strong>작은 비용으로 많은 후보를 제거</strong>한다.</li></ul><h4 id=22-기본-동작-원리다이어그램>2.2 기본 동작 원리(다이어그램)<a hidden class=anchor aria-hidden=true href=#22-기본-동작-원리다이어그램>#</a></h4><pre class=mermaid>flowchart LR
  Q[Query] --&gt; P{Predicate?}
  P --&gt;|Yes| IDX[Index Search]
  IDX --&gt; C{Covering?}
  C --&gt;|Yes| R[Return rows]
  C --&gt;|No| T[Table Lookup]
  P --&gt;|No| FS[Full Scan]
</pre><h4 id=23-데이터제어-흐름-생명주기>2.3 데이터/제어 흐름 (생명주기)<a hidden class=anchor aria-hidden=true href=#23-데이터제어-흐름-생명주기>#</a></h4><ul><li>생성→통계 수집→질의 선택→DML에 의한 유지→재구성/리빌드/리팩터.</li></ul><h4 id=24-구조-및-구성-요소-1>2.4 구조 및 구성 요소<a hidden class=anchor aria-hidden=true href=#24-구조-및-구성-요소-1>#</a></h4><ul><li><strong>노드/리프 페이지</strong>, <strong>키/포인터</strong>, <strong>필터(블룸필터)</strong>(LSM/BRIN/분산 시스템), <strong>컴팩션</strong>(LSM).</li></ul><h4 id=25-i형-최적화-이론성능-모델>2.5 (I형) 최적화 이론/성능 모델<a hidden class=anchor aria-hidden=true href=#25-i형-최적화-이론성능-모델>#</a></h4><ul><li>비용 모델: <strong>랜덤 I/O &#187; 순차 I/O</strong>, 카디널리티 추정, <strong>인덱스 스캔 + 테이블 루크업</strong> vs <strong>풀스캔</strong> 비교.</li></ul><h4 id=2627-심화>2.6–2.7 심화<a hidden class=anchor aria-hidden=true href=#2627-심화>#</a></h4><ul><li>병합 조인 vs 인덱스 네스티드 루프, 통계 스큐(skew) 처리, 히스토그램/다중컬럼 통계.</li></ul><hr><h3 id=phase-3-특성-분석-및-평가-2>Phase 3: 특성 분석 및 평가<a hidden class=anchor aria-hidden=true href=#phase-3-특성-분석-및-평가-2>#</a></h3><h4 id=31-주요-장점-및-이점-2>3.1 주요 장점 및 이점<a hidden class=anchor aria-hidden=true href=#31-주요-장점-및-이점-2>#</a></h4><table><thead><tr><th>장점</th><th>상세 설명</th><th>기술 근거</th><th>적용 상황</th><th>실무적 가치</th></tr></thead><tbody><tr><td>지연 감소</td><td>풀스캔 대비 후보 집합 축소</td><td>B-트리 로그 탐색, 선택도 기반</td><td>고선택도 필터</td><td>P95/P99 단축, SLA 준수</td></tr><tr><td>정렬/그룹 비용 절감</td><td>인덱스 정렬성 재활용</td><td>order-preserving</td><td>ORDER BY/GROUP BY</td><td>CPU/메모리 절감</td></tr><tr><td>커버링</td><td>테이블 접근 생략</td><td>포함 컬럼(INCLUDE)</td><td>읽기 집중 OLTP</td><td>랜덤 I/O 감소</td></tr><tr><td>조인 가속</td><td>조인 키에 적합</td><td>조인 순서 결정 시 힌트</td><td>FK/PK 조인</td><td>TPS 향상</td></tr><tr><td>공간/텍스트/유사도</td><td>특화 인덱스 활용</td><td>R-트리/GiST/GIN/Vec</td><td>GIS/검색/추천</td><td>기능 확장</td></tr></tbody></table><h4 id=32-단점-및-제약사항-2>3.2 단점 및 제약사항<a hidden class=anchor aria-hidden=true href=#32-단점-및-제약사항-2>#</a></h4><p><strong>단점</strong></p><table><thead><tr><th>단점</th><th>상세 설명</th><th>원인</th><th>실무에서 발생되는 문제</th><th>완화/해결 방안</th><th>대안 기술</th></tr></thead><tbody><tr><td>쓰기 비용 증가</td><td>INSERT/UPDATE 마다 인덱스 갱신</td><td>리프 분할/정렬 유지</td><td>쓰기 TPS 저하</td><td>인덱스 축소, 배치쓰기</td><td>LSM-트리 기반 KV</td></tr><tr><td>공간 증가</td><td>다수 인덱스/커버링 컬럼</td><td>중복 저장</td><td>스토리지 비용 상승</td><td>필요 최소화, 압축</td><td>컬럼너형 저장</td></tr><tr><td>잘못된 통계</td><td>선택도 추정 오류</td><td>오래된 통계/스큐</td><td>잘못된 실행계획</td><td>자동/주기 통계 갱신</td><td>힌트/프로파일</td></tr><tr><td>복잡성 증가</td><td>유형·키순서 최적화 난이도</td><td>조합 폭증</td><td>유지보수 난이</td><td>표준화/리뷰</td><td>단순 스키마</td></tr></tbody></table><p><strong>제약사항</strong></p><table><thead><tr><th>제약사항</th><th>상세 설명</th><th>원인</th><th>영향</th><th>완화/해결 방안</th><th>대안 기술</th></tr></thead><tbody><tr><td>낮은 선택도 컬럼</td><td>예: boolean, status</td><td>카디널리티 낮음</td><td>효과 미미</td><td>복합키 선행 컬럼 재설계</td><td>파티션 프루닝</td></tr><tr><td>와일드카드 전방 일치</td><td>LIKE &lsquo;%x&rsquo;</td><td>정렬성 부재</td><td>인덱스 무효</td><td>역인덱스/트라이/검색엔진</td><td>n-gram/IR</td></tr><tr><td>빈번한 전체 재빌드 비용</td><td>대규모 변경</td><td>프래그먼트</td><td>배치시간 증가</td><td>온라인 재조직</td><td>파티션 교체</td></tr></tbody></table><h4 id=33-트레이드오프-분석>3.3 트레이드오프 분석<a hidden class=anchor aria-hidden=true href=#33-트레이드오프-분석>#</a></h4><ul><li>읽기 지연 vs 쓰기 비용, 커버링 이득 vs 공간, 인덱스 수↑ vs 옵티마이저 혼란/유지비용.</li></ul><h4 id=34-적용-적합성-평가-2>3.4 적용 적합성 평가<a hidden class=anchor aria-hidden=true href=#34-적용-적합성-평가-2>#</a></h4><ul><li><strong>읽기 지배 OLTP</strong>: 커버링/복합키/부분 인덱스 적극 활용.</li><li><strong>쓰기 지배 타임시리즈/KV</strong>: LSM·TTL·파티션 우선.</li><li><strong>분석형 OLAP</strong>: 컬럼너/세그먼트 인덱스(BRIN, zone map)와 파티셔닝.</li></ul><h4 id=35-i형-최적화-효과-vs-복잡성>3.5 (I형) 최적화 효과 vs 복잡성<a hidden class=anchor aria-hidden=true href=#35-i형-최적화-효과-vs-복잡성>#</a></h4><ul><li>효과가 큰 순: 적정 키순서 → 커버링 → 부분/표현식 → 특화 인덱스. 복잡성/운영비와 균형.</li></ul><h4 id=36-경쟁-기술-비교심화>3.6 경쟁 기술 비교(심화)<a hidden class=anchor aria-hidden=true href=#36-경쟁-기술-비교심화>#</a></h4><ul><li>풀텍스트/IR, 컬럼너 저장/조닝, 메모리 인덱스(해시), 벡터 인덱스(ANN)와 역할 분담.</li></ul><h4 id=37-roitco심화>3.7 ROI/TCO(심화)<a hidden class=anchor aria-hidden=true href=#37-roitco심화>#</a></h4><ul><li>스토리지/운영비용 vs SLA 벌금/사용자 체감 성능 개선.</li></ul><hr><h3 id=phase-4-구현-방법-및-분류-2>Phase 4: 구현 방법 및 분류<a hidden class=anchor aria-hidden=true href=#phase-4-구현-방법-및-분류-2>#</a></h3><h4 id=41-구현-방법기법-핵심-가이드>4.1 구현 방법/기법 (핵심 가이드)<a hidden class=anchor aria-hidden=true href=#41-구현-방법기법-핵심-가이드>#</a></h4><ul><li><strong>B-트리(B-Tree)</strong>: 범용. 정렬/범위/조인/정렬 재사용.</li><li><strong>해시(Hash)</strong>: 동등 비교 전용, 범위 불가(엔진별 제약).</li><li><strong>R-트리(R-Tree)/SP-GiST</strong>: 공간/범위/근접.</li><li><strong>GiST/GIN</strong>: 사용자 정의 연산자 클래스, 텍스트/배열/JSON 등.</li><li><strong>BRIN</strong>: 대용량 순차 저장에서 범위 메타데이터로 거친 필터.</li><li><strong>LSM-트리</strong>: 쓰기 병합/컴팩션, 블룸필터로 읽기 보완.</li></ul><h4 id=42-유형별-분류-체계-2>4.2 유형별 분류 체계<a hidden class=anchor aria-hidden=true href=#42-유형별-분류-체계-2>#</a></h4><table><thead><tr><th>분류 기준</th><th>유형</th><th>설명</th><th>대표 사용</th></tr></thead><tbody><tr><td>구조</td><td>B-트리</td><td>균형 트리</td><td>범위/정렬</td></tr><tr><td>구조</td><td>해시</td><td>버킷 기반</td><td>= 비교</td></tr><tr><td>구조</td><td>R-트리</td><td>공간 분할</td><td>GIS</td></tr><tr><td>알고리즘</td><td>LSM</td><td>멀티 레벨 머지</td><td>쓰기 집중</td></tr><tr><td>기능</td><td>GIN/GiST</td><td>사용자 타입</td><td>텍스트/배열</td></tr><tr><td>요약</td><td>BRIN</td><td>블록 단위 요약</td><td>대용량 시계열</td></tr></tbody></table><h4 id=43-도구라이브러리-생태계개요>4.3 도구/라이브러리 생태계(개요)<a hidden class=anchor aria-hidden=true href=#43-도구라이브러리-생태계개요>#</a></h4><ul><li><strong>RDBMS</strong>: PostgreSQL(깊은 인덱스 생태계), MySQL/InnoDB(B-트리/Fulltext), SQL Server(Clustered/Nonclustered/Columnstore), Oracle(B-Tree/Bitmap).</li><li><strong>KV/LSM</strong>: RocksDB/LevelDB/Scylla/Cassandra.</li><li><strong>검색/IR</strong>: Lucene/Elasticsearch/OpenSearch.</li><li><strong>시계열</strong>: TimescaleDB/ClickHouse(BRIN/skip index/primary key ordering).</li></ul><h4 id=44-표준-및-규격>4.4 표준 및 규격<a hidden class=anchor aria-hidden=true href=#44-표준-및-규격>#</a></h4><ul><li>SQL 표준: <code>CREATE INDEX</code>, <code>DROP INDEX</code> 존재. 세부 옵션·연산자 클래스·동시성은 <strong>엔진 종속</strong>.</li></ul><h4 id=45-i형-최적화-기법측정-도구>4.5 (I형) 최적화 기법/측정 도구<a hidden class=anchor aria-hidden=true href=#45-i형-최적화-기법측정-도구>#</a></h4><ul><li><strong>EXPLAIN/EXPLAIN ANALYZE</strong>, <strong>pg_stat_statements</strong>, <strong>slow query log</strong>, <strong>plan cache</strong> 분석, <em><em>TPC-</em> 벤치마크</em>*.</li></ul><h4 id=46-안티패턴>4.6 안티패턴<a hidden class=anchor aria-hidden=true href=#46-안티패턴>#</a></h4><ul><li>저선택도 단독 인덱스, 불필요한 모든 컬럼 커버링, 키순서 오판, 중복 인덱스, 통계 미갱신.</li></ul><h4 id=47-마이그레이션업그레이드>4.7 마이그레이션/업그레이드<a hidden class=anchor aria-hidden=true href=#47-마이그레이션업그레이드>#</a></h4><ul><li>온라인 인덱스 생성/리빌드, 파티션 교체, <strong>롤링 배포</strong>로 계획 변경 리스크 완화.</li></ul><hr><h3 id=phase-5-실무-적용-및-사례-2>Phase 5: 실무 적용 및 사례<a hidden class=anchor aria-hidden=true href=#phase-5-실무-적용-및-사례-2>#</a></h3><h4 id=51-실습-예제-및-코드-구현-2>5.1 실습 예제 및 코드 구현<a hidden class=anchor aria-hidden=true href=#51-실습-예제-및-코드-구현-2>#</a></h4><h5 id=실습-예제-postgresql에서-복합커버링부분-인덱스>실습 예제: PostgreSQL에서 복합/커버링/부분 인덱스<a hidden class=anchor aria-hidden=true href=#실습-예제-postgresql에서-복합커버링부분-인덱스>#</a></h5><h6 id=목적-4>목적<a hidden class=anchor aria-hidden=true href=#목적-4>#</a></h6><ul><li>선택도/키순서/커버링/부분 인덱스 효과 체감</li></ul><h6 id=사전-요구사항-3>사전 요구사항<a hidden class=anchor aria-hidden=true href=#사전-요구사항-3>#</a></h6><ul><li>PostgreSQL 14+, psql 접근, 권한</li></ul><h6 id=단계별-구현-4>단계별 구현<a hidden class=anchor aria-hidden=true href=#단계별-구현-4>#</a></h6><ol><li><strong>데이터 준비</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-237-1><a class=lnlinks href=#hl-237-1> 1</a>
</span><span class=lnt id=hl-237-2><a class=lnlinks href=#hl-237-2> 2</a>
</span><span class=lnt id=hl-237-3><a class=lnlinks href=#hl-237-3> 3</a>
</span><span class=lnt id=hl-237-4><a class=lnlinks href=#hl-237-4> 4</a>
</span><span class=lnt id=hl-237-5><a class=lnlinks href=#hl-237-5> 5</a>
</span><span class=lnt id=hl-237-6><a class=lnlinks href=#hl-237-6> 6</a>
</span><span class=lnt id=hl-237-7><a class=lnlinks href=#hl-237-7> 7</a>
</span><span class=lnt id=hl-237-8><a class=lnlinks href=#hl-237-8> 8</a>
</span><span class=lnt id=hl-237-9><a class=lnlinks href=#hl-237-9> 9</a>
</span><span class=lnt id=hl-237-10><a class=lnlinks href=#hl-237-10>10</a>
</span><span class=lnt id=hl-237-11><a class=lnlinks href=#hl-237-11>11</a>
</span><span class=lnt id=hl-237-12><a class=lnlinks href=#hl-237-12>12</a>
</span><span class=lnt id=hl-237-13><a class=lnlinks href=#hl-237-13>13</a>
</span><span class=lnt id=hl-237-14><a class=lnlinks href=#hl-237-14>14</a>
</span><span class=lnt id=hl-237-15><a class=lnlinks href=#hl-237-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>id</span><span class=w> </span><span class=n>BIGSERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>user_id</span><span class=w> </span><span class=nb>BIGINT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>status</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>created_at</span><span class=w> </span><span class=n>TIMESTAMPTZ</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>now</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>amount</span><span class=w> </span><span class=nb>NUMERIC</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 샘플 데이터(임의 분포 가정)
</span></span></span><span class=line><span class=cl><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span><span class=n>status</span><span class=p>,</span><span class=n>created_at</span><span class=p>,</span><span class=n>amount</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=p>(</span><span class=n>random</span><span class=p>()</span><span class=o>*</span><span class=mi>1</span><span class=n>e6</span><span class=p>)::</span><span class=nb>bigint</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=p>(</span><span class=nb>ARRAY</span><span class=p>[</span><span class=s1>&#39;NEW&#39;</span><span class=p>,</span><span class=s1>&#39;PAID&#39;</span><span class=p>,</span><span class=s1>&#39;SHIP&#39;</span><span class=p>,</span><span class=s1>&#39;CANCEL&#39;</span><span class=p>])[</span><span class=mi>1</span><span class=o>+</span><span class=p>(</span><span class=n>random</span><span class=p>()</span><span class=o>*</span><span class=mi>3</span><span class=p>)::</span><span class=nb>int</span><span class=p>],</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>now</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>(</span><span class=n>random</span><span class=p>()</span><span class=o>*</span><span class=w> </span><span class=nb>interval</span><span class=w> </span><span class=s1>&#39;90 days&#39;</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=p>(</span><span class=n>random</span><span class=p>()</span><span class=o>*</span><span class=mi>1000</span><span class=p>)::</span><span class=nb>numeric</span><span class=p>(</span><span class=mi>12</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>generate_series</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=n>e6</span><span class=p>::</span><span class=nb>int</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ANALYZE</span><span class=w> </span><span class=n>orders</span><span class=p>;</span><span class=w> </span><span class=c1>-- 통계 수집
</span></span></span></code></pre></td></tr></table></div></div><ol start=2><li><strong>기본 질의와 계획</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-238-1><a class=lnlinks href=#hl-238-1>1</a>
</span><span class=lnt id=hl-238-2><a class=lnlinks href=#hl-238-2>2</a>
</span><span class=lnt id=hl-238-3><a class=lnlinks href=#hl-238-3>3</a>
</span><span class=lnt id=hl-238-4><a class=lnlinks href=#hl-238-4>4</a>
</span><span class=lnt id=hl-238-5><a class=lnlinks href=#hl-238-5>5</a>
</span><span class=lnt id=hl-238-6><a class=lnlinks href=#hl-238-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=k>ANALYZE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>user_id</span><span class=p>,</span><span class=w> </span><span class=n>amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=o>=</span><span class=s1>&#39;PAID&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>now</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>interval</span><span class=w> </span><span class=s1>&#39;7 days&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>LIMIT</span><span class=w> </span><span class=mi>50</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=3><li><strong>복합 + 정렬 이용 인덱스</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-239-1><a class=lnlinks href=#hl-239-1>1</a>
</span><span class=lnt id=hl-239-2><a class=lnlinks href=#hl-239-2>2</a>
</span><span class=lnt id=hl-239-3><a class=lnlinks href=#hl-239-3>3</a>
</span><span class=lnt id=hl-239-4><a class=lnlinks href=#hl-239-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 조건 + 정렬 키 순서 고려(status, created_at)
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>CONCURRENTLY</span><span class=w> </span><span class=n>idx_orders_status_created</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>status</span><span class=p>,</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span><span class=p>)</span><span class=w> </span><span class=n>INCLUDE</span><span class=w> </span><span class=p>(</span><span class=n>amount</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ANALYZE</span><span class=w> </span><span class=n>orders</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=4><li><strong>부분 인덱스(핫셋 집중)</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-240-1><a class=lnlinks href=#hl-240-1>1</a>
</span><span class=lnt id=hl-240-2><a class=lnlinks href=#hl-240-2>2</a>
</span><span class=lnt id=hl-240-3><a class=lnlinks href=#hl-240-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>CONCURRENTLY</span><span class=w> </span><span class=n>idx_orders_paid_recent</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span><span class=p>)</span><span class=w> </span><span class=n>INCLUDE</span><span class=w> </span><span class=p>(</span><span class=n>amount</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=o>=</span><span class=s1>&#39;PAID&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>now</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>interval</span><span class=w> </span><span class=s1>&#39;30 days&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=5><li><strong>검증</strong></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-241-1><a class=lnlinks href=#hl-241-1>1</a>
</span><span class=lnt id=hl-241-2><a class=lnlinks href=#hl-241-2>2</a>
</span><span class=lnt id=hl-241-3><a class=lnlinks href=#hl-241-3>3</a>
</span><span class=lnt id=hl-241-4><a class=lnlinks href=#hl-241-4>4</a>
</span><span class=lnt id=hl-241-5><a class=lnlinks href=#hl-241-5>5</a>
</span><span class=lnt id=hl-241-6><a class=lnlinks href=#hl-241-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=k>ANALYZE</span><span class=w> </span><span class=cm>/* 인덱스 온전성/커버링 확인 */</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>user_id</span><span class=p>,</span><span class=w> </span><span class=n>amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=o>=</span><span class=s1>&#39;PAID&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>now</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>interval</span><span class=w> </span><span class=s1>&#39;7 days&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>LIMIT</span><span class=w> </span><span class=mi>50</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h6 id=실행-결과-3>실행 결과<a hidden class=anchor aria-hidden=true href=#실행-결과-3>#</a></h6><ul><li>계획이 <strong>Index Only Scan</strong> 또는 <strong>Index Scan + Limit</strong>로 전환, 정렬 생략. 실행시간·버퍼 히트율 개선.</li></ul><h6 id=추가-실험-3>추가 실험<a hidden class=anchor aria-hidden=true href=#추가-실험-3>#</a></h6><ul><li><code>status</code> 단독 인덱스 vs 복합 인덱스 성능 비교, 부분 인덱스 선택성 변동 테스트.</li></ul><hr><h5 id=실습-예제-python--sqlite로-인덱스-효과-관찰>실습 예제: Python + SQLite로 인덱스 효과 관찰<a hidden class=anchor aria-hidden=true href=#실습-예제-python--sqlite로-인덱스-효과-관찰>#</a></h5><h6 id=목적-5>목적<a hidden class=anchor aria-hidden=true href=#목적-5>#</a></h6><ul><li>인덱스 유무에 따른 수행시간/계획 차이를 간단 재현</li></ul><h6 id=사전-요구사항-4>사전 요구사항<a hidden class=anchor aria-hidden=true href=#사전-요구사항-4>#</a></h6><ul><li>Python 3.10+, sqlite3</li></ul><h6 id=단계별-구현-5>단계별 구현<a hidden class=anchor aria-hidden=true href=#단계별-구현-5>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-242-1><a class=lnlinks href=#hl-242-1> 1</a>
</span><span class=lnt id=hl-242-2><a class=lnlinks href=#hl-242-2> 2</a>
</span><span class=lnt id=hl-242-3><a class=lnlinks href=#hl-242-3> 3</a>
</span><span class=lnt id=hl-242-4><a class=lnlinks href=#hl-242-4> 4</a>
</span><span class=lnt id=hl-242-5><a class=lnlinks href=#hl-242-5> 5</a>
</span><span class=lnt id=hl-242-6><a class=lnlinks href=#hl-242-6> 6</a>
</span><span class=lnt id=hl-242-7><a class=lnlinks href=#hl-242-7> 7</a>
</span><span class=lnt id=hl-242-8><a class=lnlinks href=#hl-242-8> 8</a>
</span><span class=lnt id=hl-242-9><a class=lnlinks href=#hl-242-9> 9</a>
</span><span class=lnt id=hl-242-10><a class=lnlinks href=#hl-242-10>10</a>
</span><span class=lnt id=hl-242-11><a class=lnlinks href=#hl-242-11>11</a>
</span><span class=lnt id=hl-242-12><a class=lnlinks href=#hl-242-12>12</a>
</span><span class=lnt id=hl-242-13><a class=lnlinks href=#hl-242-13>13</a>
</span><span class=lnt id=hl-242-14><a class=lnlinks href=#hl-242-14>14</a>
</span><span class=lnt id=hl-242-15><a class=lnlinks href=#hl-242-15>15</a>
</span><span class=lnt id=hl-242-16><a class=lnlinks href=#hl-242-16>16</a>
</span><span class=lnt id=hl-242-17><a class=lnlinks href=#hl-242-17>17</a>
</span><span class=lnt id=hl-242-18><a class=lnlinks href=#hl-242-18>18</a>
</span><span class=lnt id=hl-242-19><a class=lnlinks href=#hl-242-19>19</a>
</span><span class=lnt id=hl-242-20><a class=lnlinks href=#hl-242-20>20</a>
</span><span class=lnt id=hl-242-21><a class=lnlinks href=#hl-242-21>21</a>
</span><span class=lnt id=hl-242-22><a class=lnlinks href=#hl-242-22>22</a>
</span><span class=lnt id=hl-242-23><a class=lnlinks href=#hl-242-23>23</a>
</span><span class=lnt id=hl-242-24><a class=lnlinks href=#hl-242-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sqlite3</span><span class=o>,</span> <span class=nn>time</span><span class=o>,</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=n>conn</span> <span class=o>=</span> <span class=n>sqlite3</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=s1>&#39;:memory:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 테이블 생성</span>
</span></span><span class=line><span class=cl><span class=n>c</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s1>&#39;CREATE TABLE t(id INTEGER PRIMARY KEY, a INT, b INT)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 데이터 삽입</span>
</span></span><span class=line><span class=cl><span class=n>rows</span> <span class=o>=</span> <span class=p>[(</span><span class=n>i</span><span class=p>,</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1000000</span><span class=p>),</span> <span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>300000</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=n>c</span><span class=o>.</span><span class=n>executemany</span><span class=p>(</span><span class=s1>&#39;INSERT INTO t VALUES (?,?,?)&#39;</span><span class=p>,</span> <span class=n>rows</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>conn</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 인덱스 없는 질의</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=s1>&#39;SELECT id FROM t WHERE a BETWEEN 100 AND 200 ORDER BY a LIMIT 50&#39;</span>
</span></span><span class=line><span class=cl><span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>();</span> <span class=nb>list</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>q</span><span class=p>));</span> <span class=n>t1</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span><span class=o>-</span><span class=n>start</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 인덱스 생성(키순서: a)</span>
</span></span><span class=line><span class=cl><span class=n>c</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s1>&#39;CREATE INDEX idx_t_a ON t(a)&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>conn</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 인덱스 있는 질의</span>
</span></span><span class=line><span class=cl><span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>();</span> <span class=nb>list</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>q</span><span class=p>));</span> <span class=n>t2</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span><span class=o>-</span><span class=n>start</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>({</span><span class=s1>&#39;no_index&#39;</span><span class=p>:</span> <span class=nb>round</span><span class=p>(</span><span class=n>t1</span><span class=p>,</span><span class=mi>4</span><span class=p>),</span> <span class=s1>&#39;with_index&#39;</span><span class=p>:</span> <span class=nb>round</span><span class=p>(</span><span class=n>t2</span><span class=p>,</span><span class=mi>4</span><span class=p>)})</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s1>&#39;EXPLAIN QUERY PLAN &#39;</span> <span class=o>+</span> <span class=n>q</span><span class=p>)))</span>
</span></span></code></pre></td></tr></table></div></div><h6 id=실행-결과-4>실행 결과<a hidden class=anchor aria-hidden=true href=#실행-결과-4>#</a></h6><ul><li><code>with_index</code>가 대폭 단축, 계획에 <code>SEARCH TABLE t USING INDEX idx_t_a</code> 표시.</li></ul><h6 id=추가-실험-4>추가 실험<a hidden class=anchor aria-hidden=true href=#추가-실험-4>#</a></h6><ul><li><code>(a,b)</code> 복합 인덱스, <code>b</code>의 낮은 카디널리티가 계획에 미치는 영향.</li></ul><hr><h4 id=52-실제-도입-사례-분석-가상의-실제-패턴-기반>5.2 실제 도입 사례 분석 (가상의 실제 패턴 기반)<a hidden class=anchor aria-hidden=true href=#52-실제-도입-사례-분석-가상의-실제-패턴-기반>#</a></h4><h5 id=사례-대규모-전자상거래-결제-이벤트-스파이크-대응>사례: 대규모 전자상거래 결제 이벤트 스파이크 대응<a hidden class=anchor aria-hidden=true href=#사례-대규모-전자상거래-결제-이벤트-스파이크-대응>#</a></h5><h6 id=배경목표>배경/목표<a hidden class=anchor aria-hidden=true href=#배경목표>#</a></h6><ul><li>프로모션 기간 트래픽 급증으로 P95 지연이 200ms→>800ms. 실시간 주문 조회 API 병목.</li></ul><h6 id=구현-아키텍처-4>구현 아키텍처<a hidden class=anchor aria-hidden=true href=#구현-아키텍처-4>#</a></h6><ul><li>주문 테이블: 파티셔닝(월), <strong>복합+커버링 인덱스</strong>(status, created_at DESC INCLUDE amount, shop_id), <strong>부분 인덱스</strong>(최근 14일, status IN (&lsquo;PAID&rsquo;,&lsquo;SHIP&rsquo;)).</li><li>비즈니스 특성: 최근/결제완료 위주 조회.</li></ul><pre class=mermaid>graph TB
API --&gt; DB[(Primary DB)]
API --&gt; RO[(Read Replica)]
DB --&gt;|DML| IDX[Indexes]
RO --&gt;|SELECT| IDX
</pre><h6 id=핵심-코드요약>핵심 코드(요약)<a hidden class=anchor aria-hidden=true href=#핵심-코드요약>#</a></h6><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-244-1><a class=lnlinks href=#hl-244-1>1</a>
</span><span class=lnt id=hl-244-2><a class=lnlinks href=#hl-244-2>2</a>
</span><span class=lnt id=hl-244-3><a class=lnlinks href=#hl-244-3>3</a>
</span><span class=lnt id=hl-244-4><a class=lnlinks href=#hl-244-4>4</a>
</span><span class=lnt id=hl-244-5><a class=lnlinks href=#hl-244-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>CONCURRENTLY</span><span class=w> </span><span class=n>idx_o_status_created_inc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>status</span><span class=p>,</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span><span class=p>)</span><span class=w> </span><span class=n>INCLUDE</span><span class=w> </span><span class=p>(</span><span class=n>amount</span><span class=p>,</span><span class=w> </span><span class=n>shop_id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>CONCURRENTLY</span><span class=w> </span><span class=n>idx_o_recent_paid</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>ON</span><span class=w> </span><span class=n>orders</span><span class=p>(</span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span><span class=p>)</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;PAID&#39;</span><span class=p>,</span><span class=s1>&#39;SHIP&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>AND</span><span class=w> </span><span class=n>created_at</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>now</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=nb>interval</span><span class=w> </span><span class=s1>&#39;14 days&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h6 id=성과>성과<a hidden class=anchor aria-hidden=true href=#성과>#</a></h6><ul><li>P95: <strong>820ms → 120ms</strong>, CPU: <strong>-35%</strong>, 스토리지: <strong>+8%</strong>(커버링 비용). 실패율 감소.</li></ul><h6 id=교훈>교훈<a hidden class=anchor aria-hidden=true href=#교훈>#</a></h6><ul><li>핫셋을 <strong>부분 인덱스</strong>로 분리하고, 정렬 키를 선행에 배치하면 <strong>정렬 제거</strong> 효과가 크다.</li></ul><hr><h4 id=53-통합-및-연계-기술-2>5.3 통합 및 연계 기술<a hidden class=anchor aria-hidden=true href=#53-통합-및-연계-기술-2>#</a></h4><ul><li>파티셔닝/샤딩과 인덱스 프루닝, 캐시(Redis) 키 설계, 서치(Elasticsearch) 오프로딩, CDC(Change Data Capture) + 보조 인덱스 빌드.</li></ul><h4 id=54-i형-성능-튜닝-사례>5.4 (I형) 성능 튜닝 사례<a hidden class=anchor aria-hidden=true href=#54-i형-성능-튜닝-사례>#</a></h4><ul><li>인덱스 수 축소로 DML 20% 향상, 커버링으로 읽기 40% 단축, 통계 갱신 주기 조정으로 계획 안정화.</li></ul><h4 id=5556-심화>5.5–5.6 심화<a hidden class=anchor aria-hidden=true href=#5556-심화>#</a></h4><ul><li>대규모 파티션별 인덱스 관리, 실패 사례(중복 인덱스 남발, 통계 스큐 미대응)와 회고.</li></ul><hr><h3 id=phase-6-운영-및-최적화-2>Phase 6: 운영 및 최적화<a hidden class=anchor aria-hidden=true href=#phase-6-운영-및-최적화-2>#</a></h3><h4 id=61-모니터링관측성>6.1 모니터링/관측성<a hidden class=anchor aria-hidden=true href=#61-모니터링관측성>#</a></h4><ul><li>쿼리 상위 N, 버퍼 미스율, 인덱스 사용률, B-트리 높이/분할율, LSM 컴팩션 지표, 계획 변경 감지.</li></ul><h4 id=62-보안컴플라이언스>6.2 보안/컴플라이언스<a hidden class=anchor aria-hidden=true href=#62-보안컴플라이언스>#</a></h4><ul><li>인덱스 포함 컬럼 데이터 민감도(PII) 점검, 암호화/마스킹과의 상호작용.</li></ul><h4 id=63-성능-최적화확장성>6.3 성능 최적화/확장성<a hidden class=anchor aria-hidden=true href=#63-성능-최적화확장성>#</a></h4><ul><li><strong>자동 인덱스 제안</strong> 도구는 검증 후 단계적 적용, 읽기 전용 레플리카에 실험.</li></ul><h4 id=64-트러블슈팅>6.4 트러블슈팅<a hidden class=anchor aria-hidden=true href=#64-트러블슈팅>#</a></h4><ul><li>느린 쿼리 → 실행계획/통계 점검 → 키순서/부분/표현식 인덱스 검토 → 중복/불용 인덱스 제거.</li></ul><h4 id=65-i형-기준선회귀-방지>6.5 (I형) 기준선/회귀 방지<a hidden class=anchor aria-hidden=true href=#65-i형-기준선회귀-방지>#</a></h4><ul><li>핵심 쿼리셋에 대한 <strong>고정 벤치마크</strong>와 알림. 계획 해시(plan hash) 변화 감시.</li></ul><h4 id=6667-심화>6.6–6.7 심화<a hidden class=anchor aria-hidden=true href=#6667-심화>#</a></h4><ul><li>비용 최적화(스토리지 압축/과잉 인덱스 정리), DR/BC와 인덱스 재빌드 전략.</li></ul><hr><h3 id=phase-7-고급-주제-및-미래-전망-2>Phase 7: 고급 주제 및 미래 전망<a hidden class=anchor aria-hidden=true href=#phase-7-고급-주제-및-미래-전망-2>#</a></h3><h4 id=71-현재-도전-과제>7.1 현재 도전 과제<a hidden class=anchor aria-hidden=true href=#71-현재-도전-과제>#</a></h4><ul><li>다중 컬럼 상호상관 추정, 고스큐 데이터, 멀티테넌트 계획 안정성, 하이브리드 스토리지(HDD+SSD).</li></ul><h4 id=72-최신-트렌드>7.2 최신 트렌드<a hidden class=anchor aria-hidden=true href=#72-최신-트렌드>#</a></h4><ul><li>**벡터 인덱스(ANN: Approximate Nearest Neighbor)**로 RAG/추천 결합, <strong>자동 인덱싱</strong>(온라인 탐색), <strong>코스트 모델 학습화</strong>.</li></ul><h4 id=73-대안경쟁-솔루션>7.3 대안/경쟁 솔루션<a hidden class=anchor aria-hidden=true href=#73-대안경쟁-솔루션>#</a></h4><ul><li>컬럼너 엔진(zone map/skip index), IR 역인덱스, Materialized View, 데이터 큐브.</li></ul><h4 id=74-i형-차세대-최적화하드웨어>7.4 (I형) 차세대 최적화/하드웨어<a hidden class=anchor aria-hidden=true href=#74-i형-차세대-최적화하드웨어>#</a></h4><ul><li><strong>PMem/NVRAM</strong> 인덱스, <strong>GPU 가속 스캔</strong>, <strong>압축 친화 인덱스</strong>.</li></ul><h4 id=7576-심화>7.5–7.6 심화<a hidden class=anchor aria-hidden=true href=#7576-심화>#</a></h4><ul><li>학술 동향(LSM 변형/혼합 인덱스), 생태계/비즈니스 영향(운영비 절감 vs 기능 복잡성 증가).</li></ul><hr><h2 id=4단계-통합-검증-및-조정>4단계: 통합 검증 및 조정<a hidden class=anchor aria-hidden=true href=#4단계-통합-검증-및-조정>#</a></h2><ul><li>각 Phase간 용어/모델 정합성 점검, 주 유형(I형) 초점 유지, 최신 트렌드(벡터/자동 인덱싱) 반영.</li><li>크로스 도메인 연결: <strong>검색 IR</strong>, <strong>벡터DB</strong>, <strong>타임시리즈/로그 스토어</strong>, <strong>분산키밸류</strong>.</li></ul><hr><h2 id=5단계-종합-정리-및-학습-가이드>5단계: 종합 정리 및 학습 가이드<a hidden class=anchor aria-hidden=true href=#5단계-종합-정리-및-학습-가이드>#</a></h2><h3 id=내용-종합-2>내용 종합<a hidden class=anchor aria-hidden=true href=#내용-종합-2>#</a></h3><ul><li>인덱싱은 물리 설계의 핵심으로, <strong>질의 패턴/데이터 분포/스토리지/엔진 특성</strong>을 동시에 고려하여 <strong>키순서/유형/범위</strong>를 결정하고, <strong>모니터링과 회귀 방지</strong>로 운영 안정성을 확보한다.</li></ul><h3 id=실무-적용-가이드-체크리스트>실무 적용 가이드 (체크리스트)<a hidden class=anchor aria-hidden=true href=#실무-적용-가이드-체크리스트>#</a></h3><ul><li><input disabled type=checkbox> 상위 20개 쿼리 파악(빈도·지연·필터·정렬)</li><li><input disabled type=checkbox> 각 쿼리의 <strong>선택도/카디널리티</strong> 계산</li><li><input disabled type=checkbox> 키순서: <strong>필터 선행 → 정렬/조인 키</strong></li><li><input disabled type=checkbox> <strong>커버링</strong>은 최소 컬럼만 포함</li><li><input disabled type=checkbox> <strong>부분/표현식 인덱스</strong> 검토(핫셋/함수식)</li><li><input disabled type=checkbox> 통계 자동 갱신 주기/임계치 설정</li><li><input disabled type=checkbox> <strong>중복/불용 인덱스</strong> 정리 프로세스 운영</li><li><input disabled type=checkbox> 계획 변화 모니터링/롤백 준비</li></ul><h3 id=학습-로드맵-1>학습 로드맵<a hidden class=anchor aria-hidden=true href=#학습-로드맵-1>#</a></h3><ol><li>기초: B-트리/선택도·카디널리티/실행계획</li><li>핵심: 복합 키순서/커버링/부분·표현식/통계</li><li>응용: R-트리/GiST/GIN/BRIN/LSM</li><li>고급: 벡터 인덱스/자동 인덱싱/코스트 모델</li></ol><h3 id=학습-항목-정리-2>학습 항목 정리<a hidden class=anchor aria-hidden=true href=#학습-항목-정리-2>#</a></h3><table><thead><tr><th>카테고리</th><th>Phase</th><th>항목</th><th>중요도</th><th>학습 목표</th><th>실무 연관성</th><th>설명</th></tr></thead><tbody><tr><td>기초</td><td>1</td><td>인덱스 정의/선택도</td><td>필수</td><td>개념 이해</td><td>높음</td><td>필터로 후보 축소</td></tr><tr><td>핵심</td><td>2</td><td>B-트리 동작/계획</td><td>필수</td><td>계획 해석</td><td>높음</td><td>스캔/루크업 패턴</td></tr><tr><td>응용</td><td>4</td><td>부분/표현식/커버링</td><td>권장</td><td>튜닝 적용</td><td>중간</td><td>핫셋 최적화</td></tr><tr><td>응용</td><td>4</td><td>특화 인덱스(GIN/BRIN/LSM)</td><td>권장</td><td>도메인 매핑</td><td>중간</td><td>텍스트/시계열</td></tr><tr><td>고급</td><td>7</td><td>벡터/자동 인덱싱</td><td>선택</td><td>미래 대비</td><td>낮음</td><td>ANN/RAG</td></tr></tbody></table><hr><h2 id=용어-정리-3>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-3>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>정의</th><th>관련 개념</th><th>실무 활용</th></tr></thead><tbody><tr><td>핵심</td><td>선택도(Selectivity)</td><td>조건으로 제외되는 비율</td><td>카디널리티, 통계</td><td>인덱스 유효성 판단</td></tr><tr><td>핵심</td><td>커버링 인덱스(Covering)</td><td>인덱스만으로 질의 해결</td><td>INCLUDE, Index Only Scan</td><td>랜덤 I/O 제거</td></tr><tr><td>구현</td><td>LSM-트리(Log-Structured Merge-Tree)</td><td>배치 머지/컴팩션 기반</td><td>블룸필터, SSTable</td><td>쓰기 지배 워크로드</td></tr><tr><td>구현</td><td>BRIN(Block Range Index)</td><td>블록 요약 메타</td><td>Zone Map</td><td>대용량 범위 거른 필터</td></tr><tr><td>운영</td><td>통계(Statistics)</td><td>카디널리티/히스토그램</td><td>옵티마이저</td><td>계획 안정성</td></tr></tbody></table><hr><h2 id=참고-및-출처-3>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-3>#</a></h2><ul><li>PostgreSQL Documentation — Indexes, B-Tree, BRIN, GIN/GiST</li><li>MySQL Reference Manual — InnoDB Indexes, Composite Indexes</li><li>SQLite Query Planner Overview</li><li>Oracle Database Concepts — Indexes, Bitmap Indexes</li><li>SQL Server Docs — Clustered/Nonclustered/Included Columns</li><li>RocksDB Architecture — LSM-Tree & Compaction</li><li>Lucene/Elasticsearch — Inverted Index Fundamentals</li><li>ClickHouse Docs — Primary Key/Skip Index/Projections</li><li>TimescaleDB Docs — Hypertables & Indexing Best Practices</li></ul><hr><h2 id=부록-빠른-의사결정-매트릭스>부록: 빠른 의사결정 매트릭스<a hidden class=anchor aria-hidden=true href=#부록-빠른-의사결정-매트릭스>#</a></h2><table><thead><tr><th>워크로드</th><th>권장 인덱스</th><th>주의</th><th>대안</th></tr></thead><tbody><tr><td>읽기 지배 OLTP</td><td>복합+커버링(B-트리)</td><td>쓰기 비용</td><td>캐시/리플리카</td></tr><tr><td>쓰기 지배 KV/로그</td><td>LSM + 블룸</td><td>읽기 지연/컴팩션</td><td>핫셋 캐시</td></tr><tr><td>시계열/대용량</td><td>BRIN/파티션 + 정렬</td><td>거친 필터</td><td>컬럼너/Zone Map</td></tr><tr><td>텍스트/검색</td><td>GIN/IR</td><td>스토리지 비용</td><td>외부 검색엔진</td></tr><tr><td>공간/GIS</td><td>R-트리/GiST</td><td>업데이트 비용</td><td>타일링/전처리</td></tr></tbody></table><hr><p>인덱스는 책의 목차와 유사한 역할을 한다.<br>데이터베이스에서 인덱스를 사용하면 전체 테이블을 스캔하지 않고도 원하는 데이터를 빠르게 찾을 수 있다.<br>인덱스는 테이블의 하나 또는 여러 개의 컬럼을 기반으로 생성될 수 있습니다.</p><p>특징:</p><ol><li><p>자동 정렬</p><ul><li>인덱스는 항상 정렬된 상태를 유지한다.</li><li>새로운 데이터가 추가될 때마다 정렬된 순서를 유지하기 위해 재정렬이 발생한다.</li></ul></li><li><p>독립적 저장</p><ul><li>인덱스는 실제 데이터와 별도의 공간에 저장된다.</li><li>원본 데이터의 위치를 가리키는 포인터를 포함한다.</li></ul></li><li><p>선택적 생성</p><ul><li>모든 칼럼에 인덱스를 생성할 필요는 없다.</li><li>검색이 자주 발생하는 칼럼에 대해 선택적으로 생성한다.</li></ul></li></ol><p>장점:</p><ol><li><p>검색 속도 향상</p><ul><li>전체 테이블을 스캔하지 않고 인덱스를 통해 빠르게 데이터를 찾을 수 있습니다.</li><li>WHERE 절의 조건이나 JOIN 연산의 효율성이 크게 향상됩니다.</li></ul></li><li><p>정렬 비용 감소</p><ul><li>ORDER BY 절을 사용할 때 이미 정렬된 인덱스를 활용할 수 있습니다.</li><li>추가적인 정렬 작업이 필요하지 않아 성능이 향상됩니다.</li></ul></li><li><p>테이블 스캔 감소</p><ul><li>필요한 데이터만 선별적으로 접근할 수 있어 시스템 리소스 사용이 감소합니다.</li></ul></li></ol><p>단점:</p><ol><li><p>추가 저장 공간 필요</p><ul><li>인덱스는 별도의 저장 공간을 필요로 합니다.</li><li>데이터베이스 크기가 증가할수록 인덱스가 차지하는 공간도 증가합니다.</li></ul></li><li><p>데이터 변경 작업의 성능 저하</p><ul><li>INSERT, UPDATE, DELETE 작업 시 인덱스도 함께 수정해야 합니다.</li><li>이로 인해 데이터 변경 작업의 속도가 저하될 수 있습니다.</li></ul></li></ol><p>인덱스 최적화 전략:</p><ol><li><p>선별적 인덱스 생성</p><ul><li>검색이 자주 발생하는 칼럼에 대해서만 인덱스를 생성합니다.</li><li>불필요한 인덱스는 제거하여 시스템 부하를 줄입니다.</li></ul></li><li><p>복합 인덱스 활용</p><ul><li>함께 자주 검색되는 칼럼들에 대해 복합 인덱스를 생성합니다.</li><li>칼럼의 순서를 신중히 결정하여 효율성을 극대화합니다.</li></ul></li><li><p>인덱스 재구성</p><ul><li>주기적으로 인덱스를 재구성하여 단편화를 제거합니다.</li><li>성능 저하를 예방하고 최적의 상태를 유지합니다.</li></ul></li><li><p>사용 빈도가 높은 쿼리와 해당 컬럼을 파악하여 인덱스를 생성한다.</p></li><li><p>인덱스의 크기와 유지 관리 비용을 고려하여 주기적으로 점검하고 불필요한 인덱스는 제거한다.</p></li><li><p>쿼리 최적화와 함께 인덱스 최적화를 고려한다.</p></li><li><p>정기적인 성능 모니터링과 리팩토링을 통해 인덱스 전략을 지속적으로 개선한다.</p></li></ol><p>주의사항:</p><ol><li>인덱스를 과도하게 사용하면 오히려 성능이 저하될 수 있다.</li><li>데이터의 변경이 빈번한 컬럼보다는 조회가 주로 이루어지는 컬럼에 인덱스를 생성하는 것이 좋다.</li><li>Cardinality가 높은 컬럼을 우선적으로 인덱싱하는 것이 검색 성능에 유리하다.</li></ol><h3 id=인덱스의-종류>인덱스의 종류<a hidden class=anchor aria-hidden=true href=#인덱스의-종류>#</a></h3><p>인덱스는 여러 기준에 따라 다양하게 분류될 수 있다.<br>각 분류 기준에 따른 인덱스 종류를 살펴보자.</p><h4 id=구조에-따른-분류>구조에 따른 분류<a hidden class=anchor aria-hidden=true href=#구조에-따른-분류>#</a></h4><p>데이터가 인덱스와 물리적으로 어떻게 연관되어 있는지를 기준으로 나뉜다.</p><ol><li><p><strong>클러스터형 인덱스 (Clustered Index)</strong><br>클러스터형 인덱스는 테이블의 데이터가 <strong>인덱스의 순서에 따라 물리적으로 정렬</strong>되어 저장되는 방식.<br>즉, 데이터 자체가 인덱스를 구성하며, 인덱스의 키 값 순서에 따라 데이터가 정렬된다.<br>특징:<br>1. <strong>데이터 정렬</strong>: 테이블의 데이터가 자동으로 정렬되며, 인덱스 키 값이 데이터의 저장 순서를 결정한다.<br>2. <strong>테이블당 하나만 생성 가능</strong>: 클러스터형 인덱스는 데이터의 물리적 저장 방식을 변경하기 때문에 하나의 테이블에 하나만 생성할 수 있다.<br>3. <strong>빠른 검색</strong>: 범위 검색이나 정렬된 결과를 반환하는 쿼리에 매우 효율적이다.<br>장점:</p><ol><li><strong>빠른 범위 검색</strong>: 데이터를 물리적으로 정렬하므로 범위 기반 검색이 빠르다.</li><li><strong>효율적인 정렬 작업</strong>: ORDER BY와 같은 정렬 작업에서 추가적인 비용이 거의 들지 않는다.<br>단점:</li><li><strong>데이터 수정 비용 증가</strong>: 데이터를 삽입, 삭제, 수정할 때마다 물리적 정렬을 유지해야 하므로 오버헤드가 발생한다.</li><li><strong>추가 저장 공간 필요</strong>: 클러스터형 인덱스를 유지하기 위한 메타데이터가 필요하다.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-245-1><a class=lnlinks href=#hl-245-1> 1</a>
</span><span class=lnt id=hl-245-2><a class=lnlinks href=#hl-245-2> 2</a>
</span><span class=lnt id=hl-245-3><a class=lnlinks href=#hl-245-3> 3</a>
</span><span class=lnt id=hl-245-4><a class=lnlinks href=#hl-245-4> 4</a>
</span><span class=lnt id=hl-245-5><a class=lnlinks href=#hl-245-5> 5</a>
</span><span class=lnt id=hl-245-6><a class=lnlinks href=#hl-245-6> 6</a>
</span><span class=lnt id=hl-245-7><a class=lnlinks href=#hl-245-7> 7</a>
</span><span class=lnt id=hl-245-8><a class=lnlinks href=#hl-245-8> 8</a>
</span><span class=lnt id=hl-245-9><a class=lnlinks href=#hl-245-9> 9</a>
</span><span class=lnt id=hl-245-10><a class=lnlinks href=#hl-245-10>10</a>
</span><span class=lnt id=hl-245-11><a class=lnlinks href=#hl-245-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- employees 테이블 생성
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>last_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>50</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>first_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>50</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>age</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>department</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>50</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- id 컬럼을 기준으로 클러스터형 인덱스 생성
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=n>CLUSTERED</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_id</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>employees</span><span class=p>(</span><span class=n>id</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>비클러스터형 인덱스 (Non-Clustered Index)</strong><br>비클러스터형 인덱스는 테이블의 데이터와 별도로 저장되며, <strong>인덱스는 데이터의 위치를 가리키는 포인터를 포함</strong>한다.<br>데이터 자체는 물리적으로 정렬되지 않고, 별도의 구조로 관리된다.<br>특징:<br>1. <strong>독립적인 데이터 구조</strong>: 비클러스터형 인덱스는 테이블 데이터와 별도로 저장된다.<br>2. <strong>여러 개 생성 가능</strong>: 하나의 테이블에 여러 개의 비클러스터형 인덱스를 생성할 수 있다.<br>3. <strong>포인터 사용</strong>: 인덱스를 통해 데이터를 찾을 때 포인터를 사용하여 실제 데이터를 참조한다.<br>장점:<br>1. <strong>유연성</strong>: 여러 열이나 열 조합에 대해 다양한 비클러스터형 인덱스를 생성할 수 있다.<br>2. <strong>데이터 변경 시 영향 적음</strong>: 클러스터형 인덱스처럼 물리적 정렬을 유지할 필요가 없어 삽입/삭제 시 부담이 적다.<br>단점:<br>1. <strong>속도 저하 가능성</strong>: 데이터를 검색할 때 한 번 더 포인터를 통해 실제 데이터를 참조해야 하므로 클러스터형보다 느릴 수 있다.<br>2. <strong>추가 저장 공간 필요</strong>: 별도의 구조로 저장되기 때문에 추가적인 저장 공간이 요구됩니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-246-1><a class=lnlinks href=#hl-246-1> 1</a>
</span><span class=lnt id=hl-246-2><a class=lnlinks href=#hl-246-2> 2</a>
</span><span class=lnt id=hl-246-3><a class=lnlinks href=#hl-246-3> 3</a>
</span><span class=lnt id=hl-246-4><a class=lnlinks href=#hl-246-4> 4</a>
</span><span class=lnt id=hl-246-5><a class=lnlinks href=#hl-246-5> 5</a>
</span><span class=lnt id=hl-246-6><a class=lnlinks href=#hl-246-6> 6</a>
</span><span class=lnt id=hl-246-7><a class=lnlinks href=#hl-246-7> 7</a>
</span><span class=lnt id=hl-246-8><a class=lnlinks href=#hl-246-8> 8</a>
</span><span class=lnt id=hl-246-9><a class=lnlinks href=#hl-246-9> 9</a>
</span><span class=lnt id=hl-246-10><a class=lnlinks href=#hl-246-10>10</a>
</span><span class=lnt id=hl-246-11><a class=lnlinks href=#hl-246-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- employees 테이블 생성
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>last_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>50</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>first_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>50</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>age</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>department</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>50</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- last_name 컬럼에 대한 비클러스터형 인덱스 생성
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=n>NONCLUSTERED</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_last_name</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>employees</span><span class=p>(</span><span class=n>last_name</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ol><table><thead><tr><th>특징</th><th>클러스터형 인덱스</th><th>비클러스터형 인덱스</th></tr></thead><tbody><tr><td><strong>데이터 정렬 여부</strong></td><td>물리적으로 정렬됨</td><td>별도로 저장되며 물리적 순서와 무관</td></tr><tr><td><strong>테이블당 개수 제한</strong></td><td>하나만 가능</td><td>여러 개 가능</td></tr><tr><td><strong>검색 속도</strong></td><td>범위 검색 및 정렬 작업에 매우 빠름</td><td>포인터를 통해 접근하므로 다소 느림</td></tr><tr><td><strong>저장 공간 요구량</strong></td><td>상대적으로 적음</td><td>추가적인 저장 공간 필요</td></tr><tr><td><strong>데이터 변경 비용</strong></td><td>높음</td><td>낮음</td></tr></tbody></table><p>사용 목적과 테이블 특성에 따라 선택해야 한다.</p><ul><li>클러스터형은 범위 검색과 정렬 작업이 많은 경우 적합하며,</li><li>비클러스터형은 다양한 열 조합으로 검색해야 하는 경우 유용합니다.</li></ul><h4 id=키-속성에-따른-분류>키 속성에 따른 분류<a hidden class=anchor aria-hidden=true href=#키-속성에-따른-분류>#</a></h4><p><strong>인덱스가 테이블의 키와 어떤 관계를 가지는지</strong>를 기준으로 나눈다.</p><ol><li><p><strong>기본 인덱스 (Primary Index)</strong><br>기본 인덱스는 테이블의 **기본 키(Primary Key)**에 대해 자동으로 생성되는 인덱스이다.<br>기본 키는 테이블의 각 행을 고유하게 식별하며, 데이터 무결성을 보장한다.<br>일반적으로 클러스터형 인덱스로 구현되며, 데이터가 물리적으로 정렬된다.<br>특징:</p><ol><li><strong>고유성 보장</strong>: 기본 키 값은 중복될 수 없으며, NULL 값을 허용하지 않는다.</li><li><strong>데이터 정렬</strong>: 기본 키를 기준으로 데이터가 물리적으로 정렬된다.</li><li><strong>테이블당 하나만 생성 가능</strong>: 한 테이블에 하나의 기본 인덱스만 존재할 수 있다.<br>장점:<ol><li>데이터 검색 속도 향상: 기본 키를 이용한 검색이 매우 빠르다.</li><li>데이터 무결성 보장: 고유성과 NULL 금지를 통해 데이터의 일관성을 유지한다.<br>단점:</li><li>삽입/삭제/수정 시 오버헤드: 데이터 정렬을 유지해야 하므로 성능 저하가 발생할 수 있다.</li><li>테이블당 하나만 생성 가능: 추가적인 키를 기준으로 정렬하려면 보조 인덱스를 사용해야 한다.</li></ol></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-247-1><a class=lnlinks href=#hl-247-1>1</a>
</span><span class=lnt id=hl-247-2><a class=lnlinks href=#hl-247-2>2</a>
</span><span class=lnt id=hl-247-3><a class=lnlinks href=#hl-247-3>3</a>
</span><span class=lnt id=hl-247-4><a class=lnlinks href=#hl-247-4>4</a>
</span><span class=lnt id=hl-247-5><a class=lnlinks href=#hl-247-5>5</a>
</span><span class=lnt id=hl-247-6><a class=lnlinks href=#hl-247-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- employees 테이블 생성 시 기본키 설정
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>employees</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>last_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>50</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>first_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>50</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>보조 인덱스 (Secondary Index)</strong><br>보조 인덱스는 기본 키 외의 열(Column)에 대해 생성되는 인덱스를 의미한다.<br>기본적으로 비클러스터형 인덱스로 구현되며, 데이터와 별도로 저장된다.<br>특징<br>1. <strong>다양한 열에 생성 가능</strong>: 기본 키가 아닌 열에도 생성할 수 있다.<br>2. <strong>포인터 사용</strong>: 보조 인덱스는 실제 데이터를 가리키는 포인터를 포함한다.<br>3. <strong>데이터 정렬 없음</strong>: 보조 인덱스를 생성한다고 해서 데이터가 물리적으로 정렬되지는 않는다.<br>장점<br>1. 다양한 검색 조건 지원: 기본 키 외의 열을 기준으로 효율적인 검색이 가능하다.<br>2. 여러 개 생성 가능: 하나의 테이블에 여러 개의 보조 인덱스를 생성할 수 있다.<br>단점:</p><ol><li>추가적인 저장 공간 필요: 보조 인덱스를 저장하기 위한 별도의 구조가 필요하다.</li><li>검색 속도 저하 가능성: 데이터를 검색할 때 포인터를 통해 실제 데이터를 참조해야 하므로 기본 인덱스보다 느릴 수 있다.</li></ol></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-248-1><a class=lnlinks href=#hl-248-1>1</a>
</span><span class=lnt id=hl-248-2><a class=lnlinks href=#hl-248-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- employees 테이블에서 last_name에 대한 보조 인덱스 생성
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_last_name</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>employees</span><span class=p>(</span><span class=n>last_name</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><table><thead><tr><th>특징</th><th>기본 인덱스 (Primary Index)</th><th>보조 인덱스 (Secondary Index)</th></tr></thead><tbody><tr><td><strong>정렬 여부</strong></td><td>데이터가 물리적으로 정렬됨</td><td>데이터와 별도로 저장, 정렬되지 않음</td></tr><tr><td><strong>유일성</strong></td><td>고유성을 강제</td><td>고유성 강제하지 않음</td></tr><tr><td><strong>생성 가능 개수</strong></td><td>테이블당 하나</td><td>여러 개 생성 가능</td></tr><tr><td><strong>검색 속도</strong></td><td>빠름</td><td>포인터 참조로 인해 다소 느림</td></tr><tr><td><strong>저장 공간 요구량</strong></td><td>상대적으로 적음</td><td>추가적인 저장 공간 필요</td></tr></tbody></table><h4 id=데이터-커버리지에-따른-분류>데이터 커버리지에 따른 분류<a hidden class=anchor aria-hidden=true href=#데이터-커버리지에-따른-분류>#</a></h4><p>데이터 커버리지란 인덱스가 실제 데이터를 얼마나 세밀하게 가리키는지를 의미한다.</p><ol><li><p><strong>밀집 인덱스 (Dense Index)</strong><br>밀집 인덱스는 데이터 파일의 모든 검색 키 값에 대해 인덱스 엔트리를 가지고 있는 인덱스.<br>특징:<br>1. 모든 레코드에 대해 인덱스 엔트리가 존재한다.<br>2. 인덱스 크기가 상대적으로 큽니다.<br>3. 데이터 검색 속도가 빠릅니다.<br>장점:</p><ol><li>모든 레코드에 대한 직접적인 접근이 가능하다.</li><li>COUNT() 같은 집계 함수를 사용할 때 데이터 파일에 접근하지 않고도 처리할 수 있어 효율적이다.<br>단점:</li><li>인덱스 크기가 크므로 저장 공간을 많이 차지한다.</li><li>데이터 변경 시 인덱스 업데이트 비용이 높다.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-249-1><a class=lnlinks href=#hl-249-1>1</a>
</span><span class=lnt id=hl-249-2><a class=lnlinks href=#hl-249-2>2</a>
</span><span class=lnt id=hl-249-3><a class=lnlinks href=#hl-249-3>3</a>
</span><span class=lnt id=hl-249-4><a class=lnlinks href=#hl-249-4>4</a>
</span><span class=lnt id=hl-249-5><a class=lnlinks href=#hl-249-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>학번: 모든 학생의 학번에 대해 인덱스 생성
</span></span><span class=line><span class=cl>1001 → 레코드 위치 1
</span></span><span class=line><span class=cl>1002 → 레코드 위치 2
</span></span><span class=line><span class=cl>1003 → 레코드 위치 3
</span></span><span class=line><span class=cl>1004 → 레코드 위치 4
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>희소 인덱스 (Sparse Index)</strong><br>희소 인덱스는 데이터 파일의 일부 레코드 또는 데이터 블록에 대해서만 인덱스 엔트리를 가지고 있는 인덱스이다.<br>특징:<br>1. 각 데이터 블록을 대표하는 키 값만 인덱스에 포함된다.<br>2. 인덱스 크기가 상대적으로 작다.<br>3. 데이터의 물리적 순서에 의존한다.<br>장점:</p><ol><li>인덱스 크기가 작아 저장 공간을 적게 사용한다.</li><li>인덱스 갱신 비용이 낮다.</li><li>일반적으로 밀집 인덱스보다 인덱스 단계 수가 1정도 적어 디스크 접근 횟수가 줄어들 수 있다.<br>단점:</li><li>특정 레코드를 찾기 위해 추가적인 탐색이 필요할 수 있다.</li><li>데이터 파일의 물리적 순서에 의존하므로 유연성이 떨어진다.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-250-1><a class=lnlinks href=#hl-250-1>1</a>
</span><span class=lnt id=hl-250-2><a class=lnlinks href=#hl-250-2>2</a>
</span><span class=lnt id=hl-250-3><a class=lnlinks href=#hl-250-3>3</a>
</span><span class=lnt id=hl-250-4><a class=lnlinks href=#hl-250-4>4</a>
</span><span class=lnt id=hl-250-5><a class=lnlinks href=#hl-250-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>학년별로 그룹화된 데이터의 시작점만 인덱스 생성
</span></span><span class=line><span class=cl>1학년 시작 → 레코드 위치 1
</span></span><span class=line><span class=cl>2학년 시작 → 레코드 위치 251
</span></span><span class=line><span class=cl>3학년 시작 → 레코드 위치 501
</span></span><span class=line><span class=cl>4학년 시작 → 레코드 위치 751
</span></span></code></pre></td></tr></table></div></div></li></ol><p>인덱스 선택 기준</p><ol><li>데이터 특성 고려<ul><li>고유한 값이 많고 정확한 검색이 필요한 경우 → 밀집 인덱스</li><li>데이터가 정렬되어 있고 범위 검색이 많은 경우 → 희소 인덱스</li></ul></li><li>시스템 리소스 고려<ul><li>저장 공간이 충분하고 검색 성능이 중요한 경우 → 밀집 인덱스</li><li>저장 공간이 제한적이고 데이터가 잘 정렬된 경우 → 희소 인덱스</li></ul></li><li>데이터 변경 빈도 고려<ul><li>데이터 변경이 적고 빠른 검색이 필요한 경우 → 밀집 인덱스</li><li>데이터 변경이 빈번한 경우 → 희소 인덱스</li></ul></li></ol><h4 id=키-구성에-따른-분류>키 구성에 따른 분류<a hidden class=anchor aria-hidden=true href=#키-구성에-따른-분류>#</a></h4><p>인덱스를 구성하는 컬럼의 수에 따라 나뉜다.</p><ol><li><strong>단일 키 인덱스 (Single-Key Index)</strong><br>단일 키 인덱스는 하나의 컬럼만을 사용하여 생성된 인덱스.<br>특징:<br>1. 구조가 간단하고 구현이 쉽다.<br>2. 특정 컬럼에 대한 검색 속도를 향상시킨다.<br>3. 데이터베이스 시스템의 부하를 줄일 수 있다.<br>장점:<ol><li>구현이 간단하고 유지보수가 쉽다.</li><li>특정 컬럼에 대한 검색이 빈번할 때 효과적.<br>단점:</li><li>여러 컬럼을 조합한 복잡한 쿼리에는 효율성이 떨어질 수 있다.</li><li>다중 조건 검색에는 적합하지 않을 수 있다.</li></ol></li><li><strong>복합 키 인덱스 (Composite Index)</strong><br>복합 키 인덱스는 두 개 이상의 컬럼을 조합하여 생성된 인덱스.<br>특징:<br>1. 여러 컬럼을 조합하여 하나의 인덱스로 만든다.<br>2. 컬럼의 순서가 중요하다.<br>3. 최대 32개까지의 컬럼을 조합할 수 있다.<br>장점:<ol><li>여러 컬럼을 동시에 검색할 때 검색 속도가 개선된다.</li><li>데이터 정렬의 효율성이 높아진다.</li><li>인덱스의 용량을 절감할 수 있다.</li><li>복잡한 쿼리의 최적화에 도움이 된다.<br>단점</li><li>인덱스 생성 시 컬럼 순서가 중요하므로 설계에 주의가 필요하다.</li><li>첫 번째 컬럼이 조건에 포함되지 않으면 인덱스가 효과적으로 작동하지 않을 수 있다.</li><li>너무 많은 컬럼을 포함하면 오히려 성능이 저하될 수 있다.<br>사용 시 주의사항:</li><li>WHERE 절에 자주 사용되는 컬럼들로 구성해야 한다.</li><li>컬럼의 순서는 검색 조건에서 자주 사용되는 순서대로 지정해야 한다.</li><li>인덱스에 포함된 컬럼 수가 많아질수록 성능이 저하될 수 있으므로 적절한 수의 컬럼을 선택해야 한다.</li></ol></li></ol><h3 id=고유성에-따른-분류>고유성에 따른 분류<a hidden class=anchor aria-hidden=true href=#고유성에-따른-분류>#</a></h3><ol start=4><li><p><strong>고유 인덱스 (Unique Index)</strong></p><ul><li>인덱스 키 값이 테이블 내에서 유일함을 보장합니다.</li><li>중복된 값을 허용하지 않습니다.</li></ul></li><li><p><strong>비고유 인덱스 (Non-Unique Index)</strong></p><ul><li>인덱스 키 값의 중복을 허용합니다.</li></ul></li></ol><h3 id=특수-목적-인덱스>특수 목적 인덱스<a hidden class=anchor aria-hidden=true href=#특수-목적-인덱스>#</a></h3><ol start=6><li><p><strong>비트맵 인덱스 (Bitmap Index)</strong></p><ul><li>적은 수의 고유 값을 가진 컬럼에 효과적입니다.</li><li>비트 벡터를 사용하여 데이터의 존재 여부를 표현합니다.</li></ul></li><li><p><strong>함수 기반 인덱스 (Function-Based Index)</strong></p><ul><li>컬럼의 값 자체가 아닌, 컬럼에 특정 함수를 적용한 결과를 인덱싱합니다.</li><li>함수나 수식이 포함된 조건 검색에 유용하다.</li></ul></li><li><p><strong>공간 인덱스 (Spatial Index)</strong></p><ul><li>지리적 데이터나 다차원 데이터를 효율적으로 검색하기 위해 사용됩니다.</li></ul></li><li><p><strong>전문 인덱스 (Full-Text Index)</strong></p><ul><li>텍스트 데이터의 전체 내용을 검색하는 데 사용됩니다.</li><li>문서나 게시글 내용 검색에 사용된다.</li></ul></li></ol><h3 id=데이터-구조에-따른-분류>데이터 구조에 따른 분류<a hidden class=anchor aria-hidden=true href=#데이터-구조에-따른-분류>#</a></h3><ol start=10><li><strong>B-트리 인덱스 (B-Tree Index)</strong></li></ol><ul><li>가장 일반적으로 사용되는 인덱스 구조입니다.</li><li>균형 잡힌 트리 구조로, 검색, 삽입, 삭제 연산이 효율적입니다.</li></ul><ol start=11><li><strong>해시 인덱스 (Hash Index)</strong></li></ol><ul><li>해시 함수를 사용하여 키를 특정 버킷에 매핑합니다.</li><li>등호 비교에는 매우 효율적이지만, 범위 검색에는 적합하지 않습니다.</li></ul><ol start=12><li>R-트리 인덱스 (R-Tree Index)</li></ol><ul><li>공간 데이터를 위한 특수한 구조입니다.</li><li>지리 정보 시스템에서 주로 사용됩니다.</li></ul><hr><h2 id=참고-및-출처-4>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-4>#</a></h2></div></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2026 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>