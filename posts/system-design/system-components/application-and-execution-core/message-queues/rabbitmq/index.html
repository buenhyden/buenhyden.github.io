<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>RabbitMQ | hyunyoun's Blog</title><meta name=keywords content="Backend-Development,Event-and-Message-Brokers,Message-Broker-Systems,RabbitMQ"><meta name=description content="rlang 언어로 작성된 오픈 소스 메시지 브로커 시스템으로, AMQP(Advanced Message Queuing Protocol)를 구현하고 있다"><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/system-design/system-components/application-and-execution-core/message-queues/rabbitmq/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/system-design/system-components/application-and-execution-core/message-queues/rabbitmq/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/system-design/system-components/application-and-execution-core/message-queues/rabbitmq/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/system-design/system-components/application-and-execution-core/message-queues/rabbitmq/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="RabbitMQ"><meta property="og:description" content="rlang 언어로 작성된 오픈 소스 메시지 브로커 시스템으로, AMQP(Advanced Message Queuing Protocol)를 구현하고 있다"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="RabbitMQ"><meta name=twitter:description content="rlang 언어로 작성된 오픈 소스 메시지 브로커 시스템으로, AMQP(Advanced Message Queuing Protocol)를 구현하고 있다"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"기록하고 기억하고 활용하자.","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"System Design","item":"https://buenhyden.github.io/posts/system-design/"},{"@type":"ListItem","position":3,"name":"System Components","item":""},{"@type":"ListItem","position":4,"name":"Application and Execution Core","item":"https://buenhyden.github.io/posts/system-design/system-components/application-and-execution-core/"},{"@type":"ListItem","position":5,"name":"Messaging Queues","item":"https://buenhyden.github.io/posts/system-design/system-components/application-and-execution-core/message-queues/"},{"@type":"ListItem","position":6,"name":"RabbitMQ","item":"https://buenhyden.github.io/posts/system-design/system-components/application-and-execution-core/message-queues/rabbitmq/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>기록하고 기억하고 활용하자.</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/system-design/>System Design</a>&nbsp;»&nbsp;<a href>System Components</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/system-design/system-components/application-and-execution-core/>Application and Execution Core</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/system-design/system-components/application-and-execution-core/message-queues/>Messaging Queues</a></div><h1>RabbitMQ</h1><div class=post-description>rlang 언어로 작성된 오픈 소스 메시지 브로커 시스템으로, AMQP(Advanced Message Queuing Protocol)를 구현하고 있다</div></header><div class=post-content><h2 id=rabbitmq>RabbitMQ<a hidden class=anchor aria-hidden=true href=#rabbitmq>#</a></h2><hr><h2 id=1-태그>1. 태그<a hidden class=anchor aria-hidden=true href=#1-태그>#</a></h2><ul><li>Message-Broker</li><li>Messaging-Queue</li><li>Pub-Sub</li><li>Distributed-Systems</li></ul><hr><h2 id=2-분류-구조-분석-및-평가>2. 분류 구조 분석 및 평가<a hidden class=anchor aria-hidden=true href=#2-분류-구조-분석-및-평가>#</a></h2><h3 id=분석-결과>분석 결과<a hidden class=anchor aria-hidden=true href=#분석-결과>#</a></h3><p>현재 “Computer Science and Engineering > Systems and Infrastructure > Infrastructure > Infrastructure Components > Messaging Systems > Implementations > Event Streaming Platforms > Messaging Queue” 구조는 RabbitMQ(래빗MQ)의 역할과 사용 환경을 잘 반영함.<br>RabbitMQ는 대표적인 메시지 브로커이며, 큐 기반 메시징(Messaging Queue, MQ) 솔루션이다. Event Streaming Platform(이벤트 스트리밍 플랫폼)은 Kafka(카프카) 등과 함께 RabbitMQ도 분산 메시지 처리 및 이벤트 기반 시스템 구축에서 활용되기에 넓은 범주상 일치한다.<br>즉, 메시징 시스템 내 구현체(Implementation) 중, 큐 기반 메시징 플랫폼(Messaging Queue)으로 RabbitMQ를 분류하는 패러다임이 현대 실무/이론 모두에 적합하다.</p><hr><h2 id=3-요약-설명-200자-내외>3. 요약 설명 (200자 내외)<a hidden class=anchor aria-hidden=true href=#3-요약-설명-200자-내외>#</a></h2><p>RabbitMQ(래빗MQ)는 AMQP(Advanced Message Queuing Protocol) 프로토콜 기반의 오픈소스 분산 메시지 브로커로, 생산자와 소비자 간의 비동기 메시지 전송과 큐잉, 라우팅 등 다양한 메시징 패턴을 지원한다.<br>고가용성, 플러그인 기반 확장성, 다양한 언어·플랫폼 호환성으로 마이크로서비스, 이벤트 기반 시스템 등 많은 인프라의 핵심 메시징 중개자로 활용되고 있다.</p><hr><h2 id=4-개요-250자-내외>4. 개요 (250자 내외)<a hidden class=anchor aria-hidden=true href=#4-개요-250자-내외>#</a></h2><p>RabbitMQ(래빗MQ)는 안정적 메시지 송수신 및 비동기 처리, 유연한 라우팅 기능을 제공하는 오픈소스 메시징 큐 시스템이다.<br>AMQP, MQTT, STOMP 등 표준 프로토콜 지원과 함께 단순 큐잉(Queue)부터 발행/구독(Pub/Sub), 라우터, 딜레이 큐 등 복잡한 메시지 라우팅 패턴을 지원한다.<br>메시지 영속성, 클러스터링, 고가용성 및 보안·모니터링 도구를 통해서 신뢰성 있는 서비스 아키텍처 구축이 가능하다.<br>마이크로서비스, IoT, 실시간 처리, 데이터 연동, 일괄 처리(배치) 등 다양한 현대적 시스템의 기반 인프라로 자리매김했다.</p><hr><h2 id=5-핵심-개념>5. 핵심 개념<a hidden class=anchor aria-hidden=true href=#5-핵심-개념>#</a></h2><h3 id=이론-및-실무-필수-개념><em>이론 및 실무 필수 개념</em><a hidden class=anchor aria-hidden=true href=#이론-및-실무-필수-개념>#</a></h3><ul><li><strong>RabbitMQ(래빗MQ)</strong>: 분산·클러스터 환경에서도 신뢰성 있게 각종 메시지를 큐잉, 트랜잭션 및 라우팅하는 메시지 브로커.</li><li><strong>AMQP(Advanced Message Queuing Protocol, 고급 메시지 큐 프로토콜)</strong>: RabbitMQ의 핵심 표준 프로토콜로, 메시지 송수신 구조, 교환기(Exchange), 큐(Queue), 바인딩(Binding) 등 메시지 패턴 정의를 뒷받침한다.</li><li><strong>Producer(생산자)</strong>: 메시지를 생성하고 RabbitMQ로 전송하는 서비스 또는 엔드포인트.</li><li><strong>Consumer(소비자)</strong>: 큐나 Exchange에서 메시지를 읽어 처리하는 유닛.</li><li><strong>Exchange(교환기)</strong>: 수신한 메시지를 바인딩/규칙에 따라 큐로 라우팅하는 논리적 엔터티.</li><li><strong>Queue(큐)</strong>: 메시지가 누적되어 소비자가 처리할 때까지 대기하는 저장 공간.</li><li><strong>Routing(라우팅)</strong>: 메시지의 목적지 큐 결정 과정(Direct, Topic, Fanout, Header 등 다양한 패턴)</li><li><strong>Acknowledgement(확인 응답)</strong>: 메시지 손실 방지(신뢰성) 및 중복 방지(트랜잭션) 기능 지원</li></ul><h3 id=실무-연관성-분석><em>실무 연관성 분석</em><a hidden class=anchor aria-hidden=true href=#실무-연관성-분석>#</a></h3><ul><li>서비스간 결합도 완화, 비동기 처리, 장애 복원·확장성, 트랜잭션 균형 등 다양한 실용적 메시징 요구를 충족.</li><li>실제 프로젝트에서는 MSA(Microservice Architecture) 이벤트 중계, 비동기 태스크 분산, IoT 센서 메시지 처리, Batch 작업 스케줄링 등에서 핵심적.</li><li>메시지 순서 보장, 장애/재전송/영속성, QoS 조절을 위한 ack/buffer/TTL 적용이 매우 중요하다.</li></ul><hr><h2 id=6-세부-분석>6. 세부 분석<a hidden class=anchor aria-hidden=true href=#6-세부-분석>#</a></h2><h3 id=1-배경>1) 배경<a hidden class=anchor aria-hidden=true href=#1-배경>#</a></h3><ul><li>전통적 메시징 시스템(JMS, MSMQ 등) 한계(표준화/호환성, 유연성 부족) 극복 및 분산 환경 대응을 위해 개발됨.</li><li>2007년 Erlang 기반으로 출시되어 현재는 다양한 언어와 인프라에 대응.</li><li>AMQP, MQTT 등 메시징 표준 프로토콜의 폭넓은 채택이 RabbitMQ의 인기, 도입 확산을 견인.</li></ul><h3 id=2-목적-및-필요성>2) 목적 및 필요성<a hidden class=anchor aria-hidden=true href=#2-목적-및-필요성>#</a></h3><ul><li>비동기 처리, 비견고한 네트워크 환경에서의 메시지 신뢰성 확보</li><li>서비스 분리(MSA 등)로 인한 느슨한 결합, 서비스 지연·장애 분화</li><li>Producer/Consumer간 트래픽 부하·처리량 불일치 해소(버퍼, 큐잉)</li><li>대용량 데이터 동기화, 실시간 이벤트 전달, 태스크/작업 처리용 분산 백엔드 구현</li></ul><h3 id=3-주요-기능-및-역할>3) 주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#3-주요-기능-및-역할>#</a></h3><ul><li>메시지 큐잉·분배(Queueing, Distributing)</li><li>다양한 라우팅 패턴(Direct, Fanout, Topic, Header)</li><li>메시지 영속화(Persistence) 및 Redeliver(재전송)</li><li>처리 성공/실패 등 ACK/NACK 기반 트랜잭션 제어</li><li>클러스터, 미러 큐(고가용성), 관리 대시보드, 인증/SSL 등 보안</li></ul><h3 id=4-특징>4) 특징<a hidden class=anchor aria-hidden=true href=#4-특징>#</a></h3><ul><li>멀티프로토콜(AQMP, MQTT, STOMP) 지원</li><li>플러그인 기반 아키텍처(모니터링, delay queue 등 용이)</li><li>강력한 호환성 및 다양한 클라이언트 라이브러리(언어/플랫폼별 지원)</li><li>트랜잭션, 메시지 TTL(수명)/Dead Letter Queue(사망 큐) 내장</li><li>분산·클러스터링·고가용성(HA) 지원</li></ul><h3 id=5-핵심-원칙-및-주요-원리>5) 핵심 원칙 및 주요 원리<a hidden class=anchor aria-hidden=true href=#5-핵심-원칙-및-주요-원리>#</a></h3><ul><li><strong>Send→Exchange→Queue→Consumer</strong>의 구조: 메시지는 반드시 Exchange를 통해 큐로 라우팅됨</li><li>Exchange는 바인딩과 라우팅 패턴으로 동작(Direct·Topic·Fanout·Header)</li><li>메시지는 큐에서 대기 후, Consumer의 요청 또는 Pull/Push 모델로 소비됨</li><li>Ack(확인 응답) 메커니즘으로 메시지 유실 방지</li><li>클러스터/미러링으로 장애 복원력 제공</li></ul><h4 id=다이어그램--작동-원리>다이어그램 – 작동 원리<a hidden class=anchor aria-hidden=true href=#다이어그램--작동-원리>#</a></h4><pre class=mermaid>sequenceDiagram
    participant P as Producer(생산자)
    participant E as Exchange(교환기)
    participant Q as Queue(큐)
    participant C as Consumer(소비자)
    P-&gt;&gt;E: 메시지 전송(Publish)
    E-&gt;&gt;Q: 바인딩/라우팅 규칙에 따라 메시지 전달
    Q-&gt;&gt;C: 메시지 전달(Pull/Push)
    C-&gt;&gt;Q: Ack(메시지 처리 완료 응답)
</pre><p><strong>설명</strong><br>생산자는 메시지를 Exchange로 송신, Exchange가 라우팅 규칙에 따라 메시지를 큐로 분배, Consumer가 큐에서 메시지 소비 후 처리 결과를 Ack로 보고.</p><h3 id=6-구조-및-아키텍처>6) 구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#6-구조-및-아키텍처>#</a></h3><h4 id=구성요소>구성요소<a hidden class=anchor aria-hidden=true href=#구성요소>#</a></h4><table><thead><tr><th>구성요소</th><th>필수/선택</th><th>기능/역할</th></tr></thead><tbody><tr><td>Producer</td><td>필수</td><td>메시지 생성 후 Exchange로 송신</td></tr><tr><td>Exchange</td><td>필수</td><td>메시지 라우팅 및 큐 전달</td></tr><tr><td>Queue</td><td>필수</td><td>메시지 임시 저장, 소비자에게 차례로 전달</td></tr><tr><td>Consumer</td><td>필수</td><td>메시지 처리 및 Ack/Nack 반환</td></tr><tr><td>Binding</td><td>필수</td><td>Exchange와 Queue 간 라우팅 규칙 설정</td></tr><tr><td>Message</td><td>필수</td><td>송수신 및 처리 대상이 되는 데이터 단위</td></tr><tr><td>Policy/Plugin</td><td>선택</td><td>큐 정책, 지연 큐, 관리 툴 등 확장/제어</td></tr><tr><td>Management</td><td>선택</td><td>웹 UI, 모니터링 등 관리대시보드, Authentication 등</td></tr><tr><td>Cluster/HA</td><td>선택</td><td>고가용성, 미러큐 구현</td></tr></tbody></table><h4 id=아키텍처-다이어그램>아키텍처 다이어그램<a hidden class=anchor aria-hidden=true href=#아키텍처-다이어그램>#</a></h4><pre class=mermaid>flowchart LR
    Producer1[Producer]
    Producer2[Producer]
    Exchange[Exchange]
    Queue1[Queue #1]
    Queue2[Queue #2]
    Consumer1[Consumer #1]
    Consumer2[Consumer #2]
    Producer1 --&gt; Exchange
    Producer2 --&gt; Exchange
    Exchange -- Direct/Topic/Fanout/Header --&gt; Queue1
    Exchange -- Direct/Topic/Fanout/Header --&gt; Queue2
    Queue1 --&gt; Consumer1
    Queue2 --&gt; Consumer2
</pre><p><strong>설명</strong><br>Producer가 Exchange로 메시지 전송, Exchange가 규칙(Binding)에 따라 여러 Queue로 메시지 분배, Consumer가 각 큐에서 메시지를 소비, Ack 전송.</p><h4 id=필수선택-구성요소-표>필수/선택 구성요소 표<a hidden class=anchor aria-hidden=true href=#필수선택-구성요소-표>#</a></h4><table><thead><tr><th>구분</th><th>구성 요소</th><th>기능 및 역할</th><th>특징</th></tr></thead><tbody><tr><td>필수</td><td>Producer</td><td>메시지 생산</td><td>서비스/애플리케이션 등</td></tr><tr><td>필수</td><td>Exchange</td><td>메시지 라우팅</td><td>Direct/Topic/Fanout/Headers</td></tr><tr><td>필수</td><td>Queue</td><td>메시지 대기·임시저장</td><td>FIFO 원칙 준수</td></tr><tr><td>필수</td><td>Consumer</td><td>메시지 처리</td><td></td></tr><tr><td>필수</td><td>Binding</td><td>라우팅 규칙</td><td>Exchange-Queue 연결</td></tr><tr><td>선택</td><td>Plugins</td><td>기능 확장</td><td>미러 큐, delay queue 등</td></tr><tr><td>선택</td><td>Management</td><td>운영/보안/모니터링</td><td>웹 UI 및 API</td></tr><tr><td>선택</td><td>Cluster/HA</td><td>고가용성, 미러링</td><td>다중 노드, 장애 복구</td></tr></tbody></table><h3 id=7-구현-기법>7) 구현 기법<a hidden class=anchor aria-hidden=true href=#7-구현-기법>#</a></h3><ul><li><strong>AMQP 기반 송수신</strong>: 표준 클라이언트 라이브러리(Python pika, Node amqplib 등)로 Exchange Publish/Consume 구현</li><li><strong>라우팅 패턴 활용</strong>: Direct(정확한 매칭), Fanout(전체 브로드캐스트), Topic(글로벌 패턴), Headers(헤더값 기준)</li><li><strong>ACK/NACK 사용</strong>: 메시지 신뢰성 보장(acknowledge/on failure 재전송)</li><li><strong>퍼시스턴스 설정</strong>: 영속 메시지, 큐/Exchange durability</li><li><strong>플러그인 연동</strong>: delay queue, 미러 큐, dead-letter queue, 모니터링 등 다양한 플러그인 활용</li></ul><h4 id=예시-시나리오>예시 시나리오<a hidden class=anchor aria-hidden=true href=#예시-시나리오>#</a></h4><ul><li>결제 주문 요청(Producer) → Direct Exchange → ‘order-paid’ Queue → Task Worker(Consumer) → ACK 후 DB 저장</li></ul><h3 id=8-장점>8) 장점<a hidden class=anchor aria-hidden=true href=#8-장점>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>장점</td><td>신뢰성</td><td>영속성, ACK/NACK, 재전송으로 데이터 유실 최소화</td></tr><tr><td>장점</td><td>유연성</td><td>다양한 라우팅 패턴, 확장 가능한 큐 설계</td></tr><tr><td>장점</td><td>언어/플랫폼 호환</td><td>다양한 언어, 환경 지원(플러그인, API)</td></tr><tr><td>장점</td><td>관리 용이성</td><td>웹 UI, 정책 관리, 모니터링 툴 내장</td></tr><tr><td>장점</td><td>고가용성</td><td>클러스터링, 미러 큐로 장애 대응 쉽다</td></tr><tr><td>장점</td><td>표준 프로토콜</td><td>AMQP 등 국제 표준 지원</td></tr></tbody></table><h3 id=9-단점과-문제점-그리고-해결방안>9) 단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#9-단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>단점</td><td>대용량 처리 한계</td><td>초대용량·고속 처리(수백MB/s 이상)에 구조적 한계</td><td>Kafka 등 병렬 스트리밍 병행 사용, 클러스터 확장</td></tr><tr><td>단점</td><td>메시지 순서 불보장</td><td>큐/consumer 병렬 동작·ACK 지연시 순서 보장 안됨</td><td>메시지 그룹화·동기화 큐 사용, 설계 시 주의</td></tr><tr><td>단점</td><td>네트워크 자원 사용</td><td>대량 연결/메시지시 브로커 부담 증가</td><td>최적화, 클러스터 노드 분산</td></tr><tr><td>단점</td><td>지연시간</td><td>내부 큐/IO 지연 발생시 응답 지연</td><td>고성능 디스크, 프리페칭(prefetch) 설정</td></tr></tbody></table><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 방법 및 기법</th></tr></thead><tbody><tr><td>문제점</td><td>메시지 유실</td><td>서버 장애, 미처리 메시지 불안정성</td><td>데이터 손실</td><td>관제 로그, 미처리 큐 확인</td><td>미러 큐, 퍼시스턴스</td><td>장애 브로커 자동 복구, 미러링, requeue</td></tr><tr><td>문제점</td><td>중복처리</td><td>ACK 누락/오류/Consumer 재시작</td><td>반복 처리(중복 결과)</td><td>로그 및 Broker 상태</td><td>idempotent 설계, ACK 최적화</td><td>Producer, Consumer 중복방지 설계</td></tr><tr><td>문제점</td><td>큐 적체</td><td>Consumer 속도 느림, 임계치 초과</td><td>처리 지연, 리소스 부족</td><td>대시보드 모니터링</td><td>Consumer 증설, prefetch 조정</td><td>워커 수 확장, 큐 분리</td></tr><tr><td>문제점</td><td>보안 취약</td><td>인증·암호화 미설정</td><td>정보 유출</td><td>보안 모니터링 도구</td><td>SSL/TLS 적용</td><td>IP 화이트리스트, 정책 강화</td></tr></tbody></table><h3 id=10-도전-과제>10) 도전 과제<a hidden class=anchor aria-hidden=true href=#10-도전-과제>#</a></h3><table><thead><tr><th>카테고리</th><th>과제</th><th>원인</th><th>영향</th><th>탐지/진단</th><th>예방 방법</th><th>해결 방법</th></tr></thead><tbody><tr><td>확장성</td><td>초대용량 처리</td><td>단일 큐, 브로커 한계</td><td>성능저하, 지연</td><td>리소스 모니터링</td><td>큐 분산, 파티셔닝</td><td>Kafka 등 보완 도입</td></tr><tr><td>신뢰성</td><td>장애대응 자동화</td><td>수동 Failover 구조</td><td>다운타임 확대</td><td>클러스터 진단</td><td>자동대응 툴</td><td>오케스트레이션</td></tr><tr><td>통합</td><td>이기종 시스템과 연동</td><td>다양한 프로토콜 필요</td><td>비용·복잡성 증가</td><td>커넥터 상태 추적</td><td>공통 표준 적용</td><td>plugin 연동, Event Mesh</td></tr></tbody></table><h3 id=11-분류-기준에-따른-종류-및-유형>11) 분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#11-분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th>분류 기준</th><th>유형</th><th>설명</th></tr></thead><tbody><tr><td>라우팅 패턴</td><td>Direct Exchange</td><td>라우팅 키로 큐 매핑 (포인트 투 포인트)</td></tr><tr><td>라우팅 패턴</td><td>Fanout Exchange</td><td>바운드된 모든 큐로 메시지 브로드캐스트</td></tr><tr><td>라우팅 패턴</td><td>Topic Exchange</td><td>패턴, 와일드카드 기반 동적 라우팅</td></tr><tr><td>라우팅 패턴</td><td>Headers Exchange</td><td>헤더 값 기반 라우팅</td></tr><tr><td>인프라 구조</td><td>단일 노드</td><td>개발, 소규모 테스트용 단일 서버</td></tr><tr><td>인프라 구조</td><td>클러스터/미러 큐(HA)</td><td>고가용성·장애 복원용 멀티노드</td></tr><tr><td>배포 형태</td><td>온프렘(자체 구축)</td><td>온프레미스, 내부 서버</td></tr><tr><td>배포 형태</td><td>클라우드 매니지드</td><td>AWS MQ 등 관리형 서비스</td></tr><tr><td>프로토콜</td><td>AMQP</td><td>표준 큐잉 프로토콜 지원</td></tr><tr><td>프로토콜</td><td>MQTT, STOMP</td><td>IoT, 웹 등 용도별 프로토콜 선택</td></tr></tbody></table><h3 id=12-실무-사용-예시>12) 실무 사용 예시<a hidden class=anchor aria-hidden=true href=#12-실무-사용-예시>#</a></h3><table><thead><tr><th>활용 분야</th><th>결합 시스템</th><th>목적</th><th>효과</th></tr></thead><tbody><tr><td>주문/결제 시스템</td><td>Spring, NodeJS, DB</td><td>주문 알림, 이벤트 동기화</td><td>실시간 프로세스 균형, 장애 격리</td></tr><tr><td>비동기 태스크 처리</td><td>Celery, Python, API</td><td>대용량 작업 분산 처리</td><td>빠른 응답, 처리 서버 부하 분산</td></tr><tr><td>IoT 메시지 송수신</td><td>MQTT, Web, DB</td><td>센서 데이터 유입 및 분석</td><td>실시간 이벤트 처리, 데이터 누락 방지</td></tr><tr><td>로그 집계/분배</td><td>Fluentd, Filebeat</td><td>다양한 서비스 로그 연계</td><td>연동 시스템 표준화, 분석 촉진</td></tr></tbody></table><h3 id=13-활용-사례>13) 활용 사례<a hidden class=anchor aria-hidden=true href=#13-활용-사례>#</a></h3><h4 id=비동기-주문-처리---결제-시스템-예시>[비동기 주문 처리 - 결제 시스템 예시]<a hidden class=anchor aria-hidden=true href=#비동기-주문-처리---결제-시스템-예시>#</a></h4><p><strong>시스템 구성</strong></p><ul><li>주문(웹/앱) Producer ⇒ RabbitMQ [Exchange/Queue] ⇒ 비동기 태스크 Consumer(결제, 이메일 알림 등)</li></ul><h4 id=구성-다이어그램>구성 다이어그램<a hidden class=anchor aria-hidden=true href=#구성-다이어그램>#</a></h4><pre class=mermaid>flowchart LR
    App[Order API/Producer]
    Ex[Exchange]
    Q[Order Queue]
    Worker[Consumer(Worker)]
    DB[DB/알림/이메일]

    App --&gt; Ex
    Ex --&gt; Q
    Q --&gt; Worker
    Worker --&gt; DB
</pre><p><strong>설명</strong><br>주문 발생시, Producer가 Exchange에 메시지 발행, Exchange가 라우팅 규칙에 따라 Order Queue로 전달, Worker Consumer가 큐 잔여 메시지 처리.</p><h4 id=workflow>Workflow<a hidden class=anchor aria-hidden=true href=#workflow>#</a></h4><ol><li>주문 요청 발생 → Exchange publish</li><li>라우팅 바인딩 적용, 큐에 적재</li><li>Consumer가 메시지 poll, ACK 후 응답</li><li>주문 처리, 결제 API/DB/이메일 연계</li></ol><h4 id=rabbitmq-유무-차이>RabbitMQ 유무 차이<a hidden class=anchor aria-hidden=true href=#rabbitmq-유무-차이>#</a></h4><ul><li>사용: 부하 분산·장애 분리, 처리 지연 최소화, 메시지 유실 방지</li><li>미사용: 결합도 및 장애 파급, 대량 트래픽시 전체 장애 위험</li></ul><h3 id=14-구현-예시-python-pika-예시>14) 구현 예시 (Python pika 예시)<a hidden class=anchor aria-hidden=true href=#14-구현-예시-python-pika-예시>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16>16</a>
</span><span class=lnt id=hl-3-17><a class=lnlinks href=#hl-3-17>17</a>
</span><span class=lnt id=hl-3-18><a class=lnlinks href=#hl-3-18>18</a>
</span><span class=lnt id=hl-3-19><a class=lnlinks href=#hl-3-19>19</a>
</span><span class=lnt id=hl-3-20><a class=lnlinks href=#hl-3-20>20</a>
</span><span class=lnt id=hl-3-21><a class=lnlinks href=#hl-3-21>21</a>
</span><span class=lnt id=hl-3-22><a class=lnlinks href=#hl-3-22>22</a>
</span><span class=lnt id=hl-3-23><a class=lnlinks href=#hl-3-23>23</a>
</span><span class=lnt id=hl-3-24><a class=lnlinks href=#hl-3-24>24</a>
</span><span class=lnt id=hl-3-25><a class=lnlinks href=#hl-3-25>25</a>
</span><span class=lnt id=hl-3-26><a class=lnlinks href=#hl-3-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python pika를 사용한 RabbitMQ 메시지 송신/수신 예시</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pika</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Producer : 메시지 발행</span>
</span></span><span class=line><span class=cl><span class=n>connection</span> <span class=o>=</span> <span class=n>pika</span><span class=o>.</span><span class=n>BlockingConnection</span><span class=p>(</span><span class=n>pika</span><span class=o>.</span><span class=n>ConnectionParameters</span><span class=p>(</span><span class=s1>&#39;localhost&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>channel</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>channel</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>exchange_declare</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;orders&#39;</span><span class=p>,</span> <span class=n>exchange_type</span><span class=o>=</span><span class=s1>&#39;direct&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_declare</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;order_queue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_bind</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;orders&#39;</span><span class=p>,</span> <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;order_queue&#39;</span><span class=p>,</span> <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;pay&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>basic_publish</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;orders&#39;</span><span class=p>,</span> <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;pay&#39;</span><span class=p>,</span> <span class=n>body</span><span class=o>=</span><span class=s1>&#39;pay for order#1001&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;메시지 전송 완료&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>connection</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Consumer : 메시지 수신</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>callback</span><span class=p>(</span><span class=n>ch</span><span class=p>,</span> <span class=n>method</span><span class=p>,</span> <span class=n>properties</span><span class=p>,</span> <span class=n>body</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;수신 메시지: </span><span class=si>{</span><span class=n>body</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># (처리 코드 삽입, 처리 성공 시 ack)</span>
</span></span><span class=line><span class=cl>    <span class=n>ch</span><span class=o>.</span><span class=n>basic_ack</span><span class=p>(</span><span class=n>delivery_tag</span><span class=o>=</span><span class=n>method</span><span class=o>.</span><span class=n>delivery_tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>connection</span> <span class=o>=</span> <span class=n>pika</span><span class=o>.</span><span class=n>BlockingConnection</span><span class=p>(</span><span class=n>pika</span><span class=o>.</span><span class=n>ConnectionParameters</span><span class=p>(</span><span class=s1>&#39;localhost&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>channel</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>channel</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_declare</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;order_queue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>basic_consume</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;order_queue&#39;</span><span class=p>,</span> <span class=n>on_message_callback</span><span class=o>=</span><span class=n>callback</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Consumer 대기 중...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>start_consuming</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>각 코드는 메시지 송수신 및 큐, Exchange, ACK 등 RabbitMQ MQ의 주요 흐름·구조 반영.</p></blockquote><h3 id=15-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>15) 실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#15-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>항목</th><th>내용</th><th>권장사항</th></tr></thead><tbody><tr><td>큐 설계</td><td>큐/Exchange/라우팅키 설계 적정성</td><td>메시지 흐름 분석 및 계층별 설계</td></tr><tr><td>영속성 및 HA</td><td>장애 대비, 퍼시스턴스/미러 큐 적용 여부</td><td>Durable 큐, 미러링 활성화</td></tr><tr><td>모니터링</td><td>큐 길이, 처리현황 상시 모니터</td><td>대시보드, 알림 도구 연동</td></tr><tr><td>사망 큐, TTL</td><td>유실, 적체 방지</td><td>Dead Letter Queue, TTL 정책 적용</td></tr><tr><td>보안</td><td>SSL/인증/권한 관리 강화</td><td>암호화, 사용자, 정책 분리</td></tr></tbody></table><h3 id=16-최적화-고려사항-및-주의할-점>16) 최적화 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#16-최적화-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>항목</th><th>내용</th><th>권장사항</th></tr></thead><tbody><tr><td>prefetch 설정</td><td>Consumer가 처리 가능한 메시지 수 최적화</td><td>처리능력 고려 prefetch count 적용</td></tr><tr><td>큐 분산</td><td>대용량 데이터/부하 분산</td><td>여러 큐·Exchange 설계 활용</td></tr><tr><td>퍼시스턴스 정책</td><td>디스크/메모리/네트워크 균형</td><td>Durability, Lazy Queue 등 조정</td></tr><tr><td>ack/nack 전략</td><td>중복/누락 방지, 재시도 방안</td><td>정확한 ack, 적절한 error handling</td></tr><tr><td>클러스터 구성</td><td>노드간 리소스 분산/복제 유지</td><td>Node balance, HA proxy 적용</td></tr></tbody></table><hr><h2 id=9-주목할-내용-요약>9. 주목할 내용 요약<a hidden class=anchor aria-hidden=true href=#9-주목할-내용-요약>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>이론</td><td>메시징 패턴</td><td>큐/Exchange 구조</td><td>RabbitMQ 기본 원리</td></tr><tr><td>실무</td><td>신뢰성/확장</td><td>영속·HA/미러 큐</td><td>장애대응·서비스 확장 근간</td></tr><tr><td>통합</td><td>멀티프로토콜</td><td>AMQP, MQTT 등</td><td>이기종·IoT 연동 등 유연성</td></tr><tr><td>최적화</td><td>운영/모니터링</td><td>대시보드/지표</td><td>실시간 운영 안정성</td></tr></tbody></table><hr><h2 id=10-반드시-학습해야-할-내용>10. 반드시 학습해야 할 내용<a hidden class=anchor aria-hidden=true href=#10-반드시-학습해야-할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>기본</td><td>AMQP</td><td>메시징 구조/프로토콜</td><td>Exchange, Queue, Binding 원리</td></tr><tr><td>구조</td><td>Exchange 종류</td><td>Direct/Topic/Fanout 등의 라우팅 원리</td><td></td></tr><tr><td>운영</td><td>고가용성(HA)</td><td>미러 큐, 클러스터링</td><td>장애시 처리 및 복구</td></tr><tr><td>보안</td><td>인증·암호화</td><td>SSL, 권한관리</td><td>실서비스 환경 준비</td></tr><tr><td>통합</td><td>플러그인 관리</td><td>delay queue, monitoring 등 연동</td><td></td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>메시징</td><td>AMQP(Advanced Message Queuing Protocol)</td><td>표준 메시지 큐잉 프로토콜, RabbitMQ 핵심 프로토콜</td></tr><tr><td>메시징</td><td>Exchange(교환기)</td><td>큐로 라우팅 담당 논리적 엔터티, 여러 유형 존재</td></tr><tr><td>메시징</td><td>Queue(큐)</td><td>메시지 대기 및 임시 저장 구조</td></tr><tr><td>메시징</td><td>Routing Key(라우팅 키)</td><td>메시지 라우팅을 위한 식별자</td></tr><tr><td>메시징</td><td>Ack/Nack(확인/실패 응답)</td><td>처리 성공/실패 통보 신호</td></tr><tr><td>아키텍처</td><td>미러 큐(Mirror Queue)</td><td>고가용성 위해 복제 적용된 큐</td></tr><tr><td>아키텍처</td><td>Dead Letter Queue(사망 큐)</td><td>실패, 만료 메시지 격리 큐</td></tr><tr><td>운영</td><td>Prefetch</td><td>Consumer가 한 번에 미리 받을 메시지 수</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://www.rabbitmq.com/documentation.html>RabbitMQ 공식 문서</a></li><li><a href=https://www.rabbitmq.com/getstarted.html>RabbitMQ의 구성 및 사용방법</a></li><li><a href=https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol>AMQP 위키피디아 소개</a></li><li><a href=https://www.rabbitmq.com/clustering.html>RabbitMQ Cluster/HA 공식 가이드</a></li><li><a href=https://www.confluent.io/blog/kafka-fastest-messaging-system/>RabbitMQ, Kafka, SQS 비교 - Confluent Docs</a></li></ul><p>아래는 <strong>RabbitMQ</strong>에 대한 심도 있는 정리 첫 번째 부분입니다. 진행한 항목은 다음과 같습니다:</p><hr><h2 id=1--태그>1. 🏷️ 태그<a hidden class=anchor aria-hidden=true href=#1--태그>#</a></h2><ul><li><strong>Message-Broker</strong></li><li><strong>AMQP-Queue</strong></li><li><strong>Distributed-Messaging</strong></li><li><strong>High-Availability</strong></li></ul><hr><h2 id=2-분류-구조-분석>2. 분류 구조 분석<a hidden class=anchor aria-hidden=true href=#2-분류-구조-분석>#</a></h2><p>현재 구조:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Infrastructure Components &gt; Messaging Systems &gt; Implementations &gt; Event Streaming Platforms &gt; Messaging Queue
</span></span></code></pre></td></tr></table></div></div><p>RabbitMQ는 **메시지 브로커(큐 기반)**로 분류된 구조에 적합하며, AMQP 지원, 고가용성, 클러스터링 기능을 포함하므로 해당 분류 구조는 <strong>정확히 적절</strong>하다고 판단됩니다.</p><hr><h2 id=3-요약-200자>3. 요약 (≈200자)<a hidden class=anchor aria-hidden=true href=#3-요약-200자>#</a></h2><p>RabbitMQ는 AMQP 기반의 오픈소스 메시 브로커로, Producer에서 보낸 메시지를 Exchange→Queue 형태로 라우팅한 후 Consumer에게 전달합니다. 클러스터링, 미러/쿼럼 큐, 퍼블리셔 확인(Publisher Confirms), 소비자 ACK, Dead-Letter, TTL 등 고급 안정성 기능을 제공하며, 다중 언어·프로토콜 지원과 확장성 덕분에 분산 시스템 통합과 비동기 처리에 폭넓게 사용됩니다. (<a href="https://en.wikipedia.org/wiki/RabbitMQ?utm_source=chatgpt.com" title=RabbitMQ>위키백과</a>)</p><hr><h2 id=4-개요-250자>4. 개요 (≈250자)<a hidden class=anchor aria-hidden=true href=#4-개요-250자>#</a></h2><p>RabbitMQ는 신뢰성 높은 비동기 메시징 시스템으로, Publisher가 보낸 메시지를 교환기(Exchange)를 통해 다양한 유형의 큐로 라우팅하고, Consumer는 이를 받아 처리합니다. AMQP 0-9-1 표준을 기반으로 다채로운 Exchange(Formats): Direct, Topic, Fanout, Headers를 지원하며, HA 큐(미러링 및 쿼럼), 클러스터링, 퍼블리셔 확인, ACK/NACK, Dead-Letter, TTL 같은 메시지 안전성 기능을 포괄합니다. 또한 HA 클러스터와 재난복구 설계를 위한 Federation 및 Shovel 플러그인을 지원하여 글로벌 분산 환경에서도 사용이 적합합니다. (<a href="https://www.rabbitmq.com/tutorials/amqp-concepts?utm_source=chatgpt.com" title="AMQP 0-9-1 Model Explained - RabbitMQ">RabbitMQ</a>)</p><hr><h2 id=5-핵심-개념-1>5. 핵심 개념<a hidden class=anchor aria-hidden=true href=#5-핵심-개념-1>#</a></h2><p>다음은 RabbitMQ의 핵심 개념 정리입니다:</p><ul><li><strong>Producer</strong>: 메시지를 생성하여 Exchange에 발행 (<a href="https://medium.com/cwan-engineering/rabbitmq-concepts-and-best-practices-aa3c699d6f08?utm_source=chatgpt.com" title="RabbitMQ: Concepts and Best Practices | cwan-engineering - Medium">Medium</a>)</li><li><strong>Exchange</strong>: 메시지를 여러 큐에 라우팅하는 핵심 로직. Direct, Fanout, Topic, Headers 타입 (<a href="https://www.rabbitmq.com/tutorials/amqp-concepts?utm_source=chatgpt.com" title="AMQP 0-9-1 Model Explained - RabbitMQ">RabbitMQ</a>)</li><li><strong>Binding</strong>: Exchange와 Queue 간 라우팅 규칙. Routing Key 또는 Headers를 기준으로 설정 (<a href="https://www.rabbitmq.com/tutorials/amqp-concepts?utm_source=chatgpt.com" title="AMQP 0-9-1 Model Explained - RabbitMQ">RabbitMQ</a>)</li><li><strong>Queue</strong>: FIFO 메시지 저장소. Classic, Mirrored, Quorum, Stream 유형 지원 (<a href="https://www.cloudamqp.com/blog/rabbitmq-queue-types.html?utm_source=chatgpt.com" title="RabbitMQ Queue Types Explained - CloudAMQP">CloudAMQP</a>)</li><li><strong>Consumer</strong>: 메시지를 Queue에서 받아 처리하고 ACK/NACK 전송</li><li><strong>Connection & Channel</strong>: TCP 연결 하나에 여러 채널을 통해 경량 통신 (<a href="https://medium.com/cwan-engineering/rabbitmq-concepts-and-best-practices-aa3c699d6f08?utm_source=chatgpt.com" title="RabbitMQ: Concepts and Best Practices | cwan-engineering - Medium">Medium</a>)</li><li><strong>Virtual Host</strong>: 리소스와 권한의 격리 단위 (<a href="https://medium.com/cwan-engineering/rabbitmq-concepts-and-best-practices-aa3c699d6f08?utm_source=chatgpt.com" title="RabbitMQ: Concepts and Best Practices | cwan-engineering - Medium">Medium</a>)</li><li><strong>Publisher Confirms</strong>: 퍼블리셔 측에서 Publish 성공 여부 확인 기능 (<a href="https://www.rabbitmq.com/docs/reliability?utm_source=chatgpt.com" title="Reliability Guide | RabbitMQ">RabbitMQ</a>)</li><li><strong>ACK/NACK</strong>: Consumer 처리 확인 또는 재전송 요청 (<a href="https://www.rabbitmq.com/tutorials/amqp-concepts?utm_source=chatgpt.com" title="AMQP 0-9-1 Model Explained - RabbitMQ">RabbitMQ</a>)</li><li><strong>Mirrored & Quorum Queues</strong>: 고가용성 위한 큐 복제 방식. Mirrored는 다중 노드 동기복제, Quorum은 Raft 기반 복제 (<a href="https://www.cloudamqp.com/blog/rabbitmq-queue-types.html?utm_source=chatgpt.com" title="RabbitMQ Queue Types Explained - CloudAMQP">CloudAMQP</a>)</li><li><strong>Dead-Letter Queue (DLQ)</strong>: 처리 실패 메시지를 재분류·관찰하기 위한 대체 큐 (<a href="https://en.wikipedia.org/wiki/Dead_letter_queue?utm_source=chatgpt.com" title="Dead letter queue">위키백과</a>)</li><li><strong>Federation & Shovel</strong>: 멀티 클러스터 간 메시지 공유 및 전송 플러그인 (<a href="https://www.rabbitmq.com/blog/2020/07/07/disaster-recovery-and-high-availability-101?utm_source=chatgpt.com" title="Disaster Recovery and High Availability 101 - RabbitMQ">RabbitMQ</a>)</li></ul><h3 id=51-실무-연관성>5.1 실무 연관성<a hidden class=anchor aria-hidden=true href=#51-실무-연관성>#</a></h3><ul><li><strong>비동기 태스크 처리</strong>: 리소스 소비 작업(이미지 처리, 이메일 발송 등)을 백그라운드로 처리하여 응답 시간 단축</li><li><strong>마이크로서비스 간 통신</strong>: 비동기·신뢰성 기반의 서비스 간 메시징 구현</li><li><strong>안정성 강화</strong>: 메시지 영속성과 확인/재전송, DLQ 등을 통한 장애 회복 및 데이터 유실 방지</li><li><strong>HA 및 DR</strong>: 클러스터링·미러/쿼럼 큐 등으로 클러스터 내·외 복제 및 장애 대비</li></ul><hr><p>다음에는 <strong>배경, 목적 및 필요성</strong>, <strong>주요 기능 및 역할</strong>, <strong>특징</strong>, <strong>운영 원리 및 구조·아키텍처</strong>—특히 클러스터·큐 유형 포함한 다이어그램—으로 이어가겠습니다. 어떤 부분부터 더 깊게 분석해드릴까요?</p><hr><h2 id=6-배경-및-목적필요성-background--purpose>6. 배경 및 목적·필요성 (Background & Purpose)<a hidden class=anchor aria-hidden=true href=#6-배경-및-목적필요성-background--purpose>#</a></h2><p><strong>배경</strong>
RabbitMQ는 2007년 Erlang 기반으로 개발된 오픈소스 메시지 브로커로, AMQP(Advanced Message Queuing Protocol) 0-9-1 표준을 구현한 대표적인 시스템입니다. 당시 배치 중심의 시스템 통합 방식은 동기적 의존성과 지연 문제로 인해 마이크로서비스, IoT 등 분산 환경에서는 한계가 있었습니다. RabbitMQ는 이러한 문제를 해결하고자 비동기 메시징, 고가용성, 확장성을 제공하며 운영되었습니다 (<a href="https://en.wikipedia.org/wiki/RabbitMQ?utm_source=chatgpt.com" title=RabbitMQ>Confluent</a>).</p><p><strong>목적 및 필요성</strong></p><ul><li><strong>비동기 통합</strong>: Producer와 Consumer의 느슨한 결합으로 리소스 부담 최소화</li><li><strong>신뢰성 보장</strong>: 퍼블리셔 확인, ACK/NACK, DLQ 등 내결함성 및 복구 메커니즘 제공 (<a href="https://www.rabbitmq.com/tutorials/amqp-concepts?utm_source=chatgpt.com" title="AMQP 0-9-1 Model Explained - RabbitMQ">Lumigo</a>)</li><li><strong>라우팅 유연성</strong>: Exchange와 Binding을 통해 Direct, Topic, Fanout, Headers 등 다양한 패턴 지원 (<a href="https://medium.com/cwan-engineering/rabbitmq-concepts-and-best-practices-aa3c699d6f08?utm_source=chatgpt.com" title="RabbitMQ: Concepts and Best Practices | cwan-engineering - Medium">CloudAMQP</a>)</li><li><strong>확장성·HA</strong>: 클러스터링 및 미러/쿼럼 큐로 고가용성과 장애 복구 구성 (<a href="https://www.cloudamqp.com/blog/rabbitmq-queue-types.html?utm_source=chatgpt.com" title="RabbitMQ Queue Types Explained - CloudAMQP">RabbitMQ</a>)</li></ul><hr><h2 id=7-주요-기능-및-역할-key-functions--roles>7. 주요 기능 및 역할 (Key Functions & Roles)<a hidden class=anchor aria-hidden=true href=#7-주요-기능-및-역할-key-functions--roles>#</a></h2><table><thead><tr><th>기능</th><th>설명</th></tr></thead><tbody><tr><td><strong>Exchange 라우팅</strong></td><td>Direct, Fanout, Topic, Headers를 통한 메시지 정밀 분배 (<a href="https://www.rabbitmq.com/docs/reliability?utm_source=chatgpt.com" title="Reliability Guide | RabbitMQ">RabbitMQ</a>)</td></tr><tr><td><strong>메시지 영속성</strong></td><td>Durable 메시지 저장 옵션 및 클러스터 고가용성 보장</td></tr><tr><td><strong>퍼블리셔 확인</strong></td><td>메시지 정상 발행 시 확인(Ack) 받아 신뢰성 확보</td></tr><tr><td><strong>Consumer ACK/NACK</strong></td><td>소비 성공·실패 제어 및 재처리 처리 가능</td></tr><tr><td><strong>Dead‑Letter Queue</strong></td><td>처리 실패 메시지 별도 저장 및 분석</td></tr><tr><td><strong>TTL 설정</strong></td><td>메시지 및 큐에 시간 제한 적용 및 자동 삭제</td></tr><tr><td><strong>클러스터링 / HA 큐</strong></td><td>노드 장애 대응, 데이터 복제, 장애 복구 지원</td></tr><tr><td><strong>플러그인 기능</strong></td><td>Federation, Shovel, MQTT/STOMP 등 프로토콜 확장 플러그인</td></tr></tbody></table><hr><h2 id=8-특징-characteristics>8. 특징 (Characteristics)<a hidden class=anchor aria-hidden=true href=#8-특징-characteristics>#</a></h2><ol><li><p><strong>AMQP 표준 준수</strong>
RabbitMQ는 AMQP 0-9-1을 완전 지원하며, AMQP 1.0, MQTT, STOMP 등 다양한 프로토콜도 플러그인 형태로 지원 (<a href="https://en.wikipedia.org/wiki/Dead_letter_queue?utm_source=chatgpt.com" title="Dead letter queue">위키백과</a>).</p></li><li><p><strong>라우팅 유연성</strong>
Exchange와 Binding을 자유롭게 설정해 복잡한 메시징 패턴을 손쉽게 구성 가능 (<a href="https://medium.com/cwan-engineering/rabbitmq-concepts-and-best-practices-aa3c699d6f08?utm_source=chatgpt.com" title="RabbitMQ: Concepts and Best Practices | cwan-engineering - Medium">CloudAMQP</a>).</p></li><li><p><strong>ACK/NACK 기반 신뢰성 처리</strong>
퍼블리셔와 소비자 양측의 ACK 체계를 통해 안정적인 메시지 처리 보장 .</p></li><li><p><strong>HA 및 클러스터링 지원</strong>
미러/쿼럼 큐 기반으로 노드 장애 발생 시 자동 전환 및 복제 구조 유지 (<a href="https://www.rabbitmq.com/blog/2020/07/07/disaster-recovery-and-high-availability-101?utm_source=chatgpt.com" title="Disaster Recovery and High Availability 101 - RabbitMQ">RabbitMQ</a>).</p></li><li><p><strong>확장성과 다양한 클라우드·컨테이너 환경</strong>
도커 및 쿠버네티스 환경에서도 쉽게 배포 가능하며 다양한 Discovery 방법을 통한 노드 구성 지원 (<a href="https://en.wikipedia.org/wiki/RabbitMQ?utm_source=chatgpt.com" title=RabbitMQ>Confluent</a>).</p></li><li><p><strong>플러그인 기반 확장성</strong>
Federation, Shovel, Management UI 등 다양한 기능 추가 가능 (<a href="https://en.wikipedia.org/wiki/Dead_letter_queue?utm_source=chatgpt.com" title="Dead letter queue">위키백과</a>).</p></li></ol><hr><h2 id=9-핵심-원칙-core-principles>9. 핵심 원칙 (Core Principles)<a hidden class=anchor aria-hidden=true href=#9-핵심-원칙-core-principles>#</a></h2><ul><li><strong>메시지 라우팅 분리(Domain Decoupling)</strong>: Exchange와 Queue 간 경로 분리를 통해 시스템 간 LOOSLY-COUPLED 통신 구현.</li><li><strong>ACK 기반 신뢰성</strong>: ACK/NACK를 통한 신뢰성과 정확한 전송.</li><li><strong>영속성과 내구성</strong>: Durable 옵션으로 메시지 유실 없이 디스크 저장.</li><li><strong>고가용성 우선 설계</strong>: 미러/쿼럼 큐와 클러스터링을 통한 장애 대비.</li><li><strong>플러그인 아키텍처</strong>: 유연한 확장성 제공, 특정 기능 도입 적용 용이.</li></ul><hr><h2 id=10-작동-원리-및-방식-operational-flow>10. 작동 원리 및 방식 (Operational Flow)<a hidden class=anchor aria-hidden=true href=#10-작동-원리-및-방식-operational-flow>#</a></h2><pre class=mermaid>flowchart LR
  Producer --&gt;|Publish| Exchange
  Exchange --&gt;|Routing| Queue1
  Exchange --&gt;|Routing| Queue2
  Queue1 --&gt; Consumer1
  Queue2 --&gt; Consumer2
  Consumer1 --&gt;|ACK| Broker
  Consumer2 --&gt;|NACK/DLQ| DeadLetterQueue
</pre><ol><li>Producer가 Exchange에 메시지 발행</li><li>Exchange가 Binding 규칙에 따라 메시지 전달</li><li>Consumer가 메시지를 처리하고 ACK/NACK 전송</li><li>NACK 시 메시지는 DLQ로 이동, ACK 시 처리 완료</li></ol><hr><p>다음 단계는 <strong>구조·아키텍처</strong>, <strong>구현 기법</strong>, <strong>장단점</strong>, <strong>실무 사례</strong> 등으로 이어집니다. 원하시는 항목부터 말씀해 주세요!</p><hr><h2 id=11-구조-및-아키텍처-architecture--components>11. 구조 및 아키텍처 (Architecture & Components)<a hidden class=anchor aria-hidden=true href=#11-구조-및-아키텍처-architecture--components>#</a></h2><pre class=mermaid>graph TD
  subgraph Cluster[RabbitMQ Cluster]
    N1[Node1] &amp; N2[Node2] &amp; N3[Node3]
  end
  subgraph Logical
    Exchange --&gt; Queue
  end
  Producer --&gt; Exchange
  Exchange --&gt; N1
  Exchange --&gt; N2
  Exchange --&gt; N3
  Queue:::ha --&gt; Consumer
  Queue:::dlq --&gt; DeadLetterQueue
  style Queue:::ha fill:#def
  style Queue:::dlq fill:#fdd
</pre><h3 id=필수-구성-요소>필수 구성 요소<a hidden class=anchor aria-hidden=true href=#필수-구성-요소>#</a></h3><ul><li><strong>Node (브로커)</strong>: Erlang 기반 RabbitMQ 인스턴스들로 구성된 클러스터. 노드 간 메시지·Exchange·Binding 등의 메타데이터 공유 (<a href="https://en.wikipedia.org/wiki/RabbitMQ?utm_source=chatgpt.com" title=RabbitMQ>RabbitMQ</a>).</li><li><strong>Exchange</strong>: Direct, Fanout, Topic, Headers 유형을 사용해 메시지 라우팅 역할 수행 .</li><li><strong>Queue (Classic, Mirrored, Quorum)</strong>: 메시지 저장소로, 미러/쿼럼 큐는 장애 대응용 복제를 제공 (<a href="https://www.rabbitmq.com/tutorials/amqp-concepts?utm_source=chatgpt.com" title="AMQP 0-9-1 Model Explained - RabbitMQ">RabbitMQ</a>).</li><li><strong>Binding</strong>: Exchange → Queue 간 라우팅 룰 표현 (routing key, header 기준) (<a href="https://medium.com/cwan-engineering/rabbitmq-concepts-and-best-practices-aa3c699d6f08?utm_source=chatgpt.com" title="RabbitMQ: Concepts and Best Practices | cwan-engineering - Medium">DevOps.dev</a>).</li><li><strong>Connection & Channel</strong>: TCP 연결 위에 다수의 채널 활용해 경량 통신 구현 .</li><li><strong>DLQ (Dead-Letter Queue)</strong>: 처리 실패 메시지 저장 및 분석용 (<a href="https://www.cloudamqp.com/blog/rabbitmq-queue-types.html?utm_source=chatgpt.com" title="RabbitMQ Queue Types Explained - CloudAMQP">위키백과</a>).</li></ul><h3 id=선택-구성-요소>선택 구성 요소<a hidden class=anchor aria-hidden=true href=#선택-구성-요소>#</a></h3><ul><li><strong>Federation & Shovel</strong>: 클러스터 간 메시지 공유/전송 (멀티 리전 지원) (<a href="https://www.rabbitmq.com/tutorials/amqp-concepts?utm_source=chatgpt.com" title="AMQP 0-9-1 Model Explained - RabbitMQ">RabbitMQ</a>).</li><li><strong>Plugins (MQTT, STOMP)</strong>: 다양한 프로토콜 지원 및 기능 확장 (<a href="https://www.cloudamqp.com/blog/rabbitmq-queue-types.html?utm_source=chatgpt.com" title="RabbitMQ Queue Types Explained - CloudAMQP">위키백과</a>).</li><li><strong>Kubernetes Operator</strong>: 클러스터 배포/관리를 위한 자동화 장치 (<a href="https://www.rabbitmq.com/docs/reliability?utm_source=chatgpt.com" title="Reliability Guide | RabbitMQ">InfraCloud</a>).</li></ul><hr><h2 id=12-구현-기법-implementation-techniques>12. 구현 기법 (Implementation Techniques)<a hidden class=anchor aria-hidden=true href=#12-구현-기법-implementation-techniques>#</a></h2><ol><li><p><strong>Publisher Confirms</strong></p><ul><li>발행 시 <code>confirmSelect()</code> 설정 후 싱크/비동기로 <code>basicAck</code> 수신 (<a href="https://en.wikipedia.org/wiki/Dead_letter_queue?utm_source=chatgpt.com" title="Dead letter queue">RabbitMQ</a>).</li><li>개별, 배치, 콜백 기반 방식 제공하며, 배치 방식은 처리량 향상에 유리 .</li></ul></li><li><p><strong>Consumer ACK/NACK & 재시도</strong></p><ul><li><code>autoAck=false</code> 설정 후 수동으로 <code>ack</code>, 실패 시 <code>nack</code>, 처리 불가 시 DLQ 적용 (<a href="https://www.rabbitmq.com/blog/2020/07/07/disaster-recovery-and-high-availability-101?utm_source=chatgpt.com" title="Disaster Recovery and High Availability 101 - RabbitMQ">RabbitMQ</a>).</li></ul></li><li><p><strong>미러/쿼럼 큐 구성</strong></p><ul><li>레거시 클러스터링: Mirrored 큐 (AP/CP 구성 선택 가능)</li><li>최신 방식: Quorum 큐 (Raft 기반 CP 방식, 과반 복제 보장) (<a href="https://www.rabbitmq.com/tutorials/amqp-concepts?utm_source=chatgpt.com" title="AMQP 0-9-1 Model Explained - RabbitMQ">RabbitMQ</a>, <a href="https://scalegrid.io/blog/scaling-rabbitmq/?utm_source=chatgpt.com" title="Best Practices For Scaling RabbitMQ - ScaleGrid">ScaleGrid</a>).</li></ul></li><li><p><strong>클러스터 노드 구성</strong></p><ul><li>최소 3노드 권장, AZ 내 배포, 랙 인식 통한 장애권 분리 고려 .</li></ul></li><li><p><strong>Federation & Shovel</strong></p><ul><li>멀티 클러스터 메시지 연동을 위한 비동기 전송 방식 .</li></ul></li></ol><hr><h2 id=13-장점-advantages>13. 장점 (Advantages)<a hidden class=anchor aria-hidden=true href=#13-장점-advantages>#</a></h2><table><thead><tr><th>구분</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>장점</td><td><strong>표준 AMQP 준수</strong></td><td>다양한 언어·프로토콜 지원</td></tr><tr><td></td><td><strong>라우팅 유연성</strong></td><td>Exchange 유형으로 다양한 패턴 구성 가능</td></tr><tr><td></td><td><strong>신뢰성 확보</strong></td><td>Publisher Confirms, ACK/NACK, DLQ 등</td></tr><tr><td></td><td><strong>고가용성</strong></td><td>클러스터링 + 복제 큐로 장애耐性</td></tr><tr><td></td><td><strong>확장성</strong></td><td>Channel, 노드 수 확장으로 처리량 향상</td></tr><tr><td></td><td><strong>플러그인 기반 확장</strong></td><td>MQTT, STOMP, Federation, Shovel 등</td></tr></tbody></table><hr><h2 id=14-단점-및-문제점-disadvantages--issues>14. 단점 및 문제점 (Disadvantages & Issues)<a hidden class=anchor aria-hidden=true href=#14-단점-및-문제점-disadvantages--issues>#</a></h2><h3 id=단점-1>단점<a hidden class=anchor aria-hidden=true href=#단점-1>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>단점</td><td><strong>메모리 자원 요구</strong></td><td>오브젝트 기반 Erlang 구조로 소비자 수 많을 경우 과부하</td><td>Lazy Queue, 채널 수 제한 설정 (<a href="https://stackoverflow.com/questions/34127214/acknowledgement-of-message-received-from-rabbitmq-queue-using-amqp?utm_source=chatgpt.com" title="Acknowledgement of message received from rabbitmq queue using ...">Stack Overflow</a>, <a href="https://jack-vanlightly.com/blog/2017/3/10/rabbitmq-the-different-failures-on-basicpublish?utm_source=chatgpt.com" title="Types of Publishing Failures - RabbitMq Publishing Part 1">Jack Vanlightly</a>, <a href="https://www.cloudamqp.com/blog/rabbitmq-queue-types.html?utm_source=chatgpt.com" title="RabbitMQ Queue Types Explained - CloudAMQP">위키백과</a>, <a href="https://www.cloudamqp.com/blog/part3-rabbitmq-best-practice-for-high-availability.html?utm_source=chatgpt.com" title="Part 3: RabbitMQ Best Practice for High Availability - CloudAMQP">CloudAMQP</a>)</td></tr><tr><td></td><td><strong>멀티 데이터센터 클러스터링 제한</strong></td><td>WAN 환경에서는 분리된 클러스터 구성이 권장됨</td><td>Federation, Shovel로 대체</td></tr><tr><td></td><td><strong>운영 설정 복잡</strong></td><td>클러스터 정책, HA 큐 타입, Binding 구성 등</td><td>클라우드 Operator 또는 관리 UI 활용</td></tr></tbody></table><h3 id=문제점-1>문제점<a hidden class=anchor aria-hidden=true href=#문제점-1>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>원인</th><th>영향</th><th>탐지 방법</th><th>예방 방법</th><th>해결 기법</th></tr></thead><tbody><tr><td>문제점</td><td><strong>백프레셔(지연)</strong></td><td>긴 큐, 느린 Consumer</td><td>지연 증가, 처리량 저하</td><td>큐 길이 모니터링</td><td>퀘이 시스템 최적화, Lazy 큐 사용 (<a href="https://www.cloudamqp.com/blog/part3-rabbitmq-best-practice-for-high-availability.html?utm_source=chatgpt.com" title="Part 3: RabbitMQ Best Practice for High Availability - CloudAMQP">CloudAMQP</a>)</td><td>Consumer 병렬화, prefetch 조정</td></tr><tr><td></td><td><strong>메시지 누락 가능성</strong></td><td>퍼블리셔 Publish 실패 후 ack 없음</td><td>데이터 유실</td><td>Publisher Confirm 모니터링</td><td>confirm 사용, 배치 기반 발행</td><td>배치 재시도, 로그 기반 재발행</td></tr><tr><td></td><td><strong>노드 장애 시 데이터 손실</strong></td><td>비동기 Mirrored 큐 또는 불완전 복제</td><td>일부 메시지 유실</td><td>Replica 상태 탐지</td><td>Quorum 큐, 과반 복제 구성</td><td>Quorum 기반 교체, 정책 점검</td></tr><tr><td></td><td><strong>클러스터 균열(splits)</strong></td><td>장애 후 재조인 처리 지연</td><td>split-brain 상황 발생</td><td>클러스터 상태 모니터링</td><td>노드 수 홀짝 구성, 랙 인식 구성</td><td>클러스터 재구성 및 동기 복구</td></tr></tbody></table><hr><p>다음으로 <strong>도전 과제</strong>, <strong>분류 기준에 따른 유형</strong>, <strong>실무 예시 및 활용 사례</strong>, <strong>구현 예시 코드</strong>, <strong>최적화/고려사항</strong>, <strong>용어 정리</strong>, <strong>참고 자료</strong>를 이어서 작업할 수 있습니다. 진행하길 원하시는 섹션을 말씀해 주세요!</p><p>알겠습니다! 이어서 <strong>15. 도전 과제</strong>, <strong>16. 분류 기준에 따른 종류 및 유형</strong>, <strong>17. 실무 사용 예시</strong>, <strong>18. 활용 사례</strong>, <strong>19. 구현 예시</strong>, <strong>20–22. 실무 적용 고려사항 및 최적화</strong>, 그리고 <strong>용어 정리</strong>와 <strong>참고 자료</strong> 순으로 정리합니다.</p><hr><h2 id=15-도전-과제-challenges>15. 도전 과제 (Challenges)<a hidden class=anchor aria-hidden=true href=#15-도전-과제-challenges>#</a></h2><table><thead><tr><th>카테고리</th><th>항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 기법</th></tr></thead><tbody><tr><td>성능 한계</td><td>메모리·채널 소모 과다</td><td>다수 Consumer/채널, Prefetch 미조정</td><td>브로커 OOM, 응답 지연</td><td>Erlang VM 지표, Channel/GCTime 확인</td><td>채널 수 제한, prefetch 설정</td><td>Lazy Queue, Consumer 스레드 조정</td></tr><tr><td>HA 구성</td><td>멀티 DC 동기복제 어려움</td><td>네트워크 지연, RabbitMQ 클러스터 자체 지원 한계</td><td>메시지 일관성·가용성 저해</td><td>Federation Shovel 지연 모니터링</td><td>WAN 큐 분리, 교차 DC 원칙 적용</td><td>Federation, Shovel, Quorum 큐 도입</td></tr><tr><td>데이터 무결성</td><td>퍼블리셔 실패 후 ACK 누락</td><td>비동기 발행, Publisher Confirms 미사용</td><td>메시지 손실 가능성</td><td>Confirm ack 누락, 로그 지표 분석</td><td>모든 메시지 Confirm 자동 적용</td><td>재전송 로직, DLQ 재처리</td></tr><tr><td>장애 복구</td><td>split-brain 또는 복제 불일치</td><td>네트워크 분할 또는 복구 지연</td><td>클러스터 불안정 상태, 데이터 누락</td><td>클러스터 상태 알람, Node 리스트 감시</td><td>노드 홀짝 구성, 정기 상태 점검</td><td>재조인 이후 자동 동기화, 복제 재설정 스크립트</td></tr></tbody></table><hr><h2 id=16-분류-기준에-따른-종류-및-유형-types-by-classification>16. 분류 기준에 따른 종류 및 유형 (Types by Classification)<a hidden class=anchor aria-hidden=true href=#16-분류-기준에-따른-종류-및-유형-types-by-classification>#</a></h2><table><thead><tr><th>기준</th><th>유형</th><th>설명</th></tr></thead><tbody><tr><td>Queue 유형</td><td>Classic, Mirrored, Quorum</td><td>단순 큐 vs 노드 복제 큐 vs Raft 기반 고가용 큐</td></tr><tr><td>라우팅/Topology</td><td>Direct, Fanout, Topic, Headers</td><td>Exchange 유형에 따른 다양한 라우팅 모델 지원</td></tr><tr><td>클러스터 구성</td><td>Standalone, Clustered</td><td>단일 노드 vs HA 클러스터 환경</td></tr><tr><td>프로토콜 지원</td><td>AMQP(-0-9-1/1.0), MQTT, STOMP</td><td>다양한 통신 규격을 Plugin으로 지원</td></tr><tr><td>복제 방식</td><td>Synchronous vs Asynchronous</td><td>즉시 복제 vs 지연 허용 복제 방식</td></tr></tbody></table><hr><h2 id=17-실무-사용-예시-use-cases>17. 실무 사용 예시 (Use Cases)<a hidden class=anchor aria-hidden=true href=#17-실무-사용-예시-use-cases>#</a></h2><table><thead><tr><th>사용 목적</th><th>함께 쓰는 기술</th><th>기대 효과</th></tr></thead><tbody><tr><td>이메일 배치 처리</td><td>RabbitMQ + Spring Boot</td><td>응답성 향상 및 배치 안정성 확보</td></tr><tr><td>이미지 리사이징</td><td>RabbitMQ + Docker 컨슈머</td><td>비동기 처리로 웹 서버 부하 감소</td></tr><tr><td>주문 시스템</td><td>RabbitMQ + Microservices</td><td>주문 유실 방지 및 서비스 간 결합 낮춤</td></tr><tr><td>IoT 센서 이벤트 처리</td><td>MQTT 플러그인 + RabbitMQ</td><td>IoT 디바이스 이벤트 스트림 통합</td></tr></tbody></table><hr><h2 id=18-활용-사례--이미지-처리-파이프라인>18. 활용 사례 – 이미지 처리 파이프라인<a hidden class=anchor aria-hidden=true href=#18-활용-사례--이미지-처리-파이프라인>#</a></h2><h3 id=시스템-구성--워크플로우>시스템 구성 & 워크플로우<a hidden class=anchor aria-hidden=true href=#시스템-구성--워크플로우>#</a></h3><pre class=mermaid>graph LR
  UserUI[사용자 웹/모바일] --&gt;|이미지 업로드| AppServer
  AppServer --&gt;|메시지 발행| Exchange[Direct Exchange]
  Exchange --&gt;|route=resize| ResizeQueue
  ResizeQueue --&gt;|Consumer| ResizeService
  ResizeService --&gt;|이미지 처리 후 저장| CDN/DB
  ResizeService --&gt;|ACK| Broker
</pre><ul><li><p><strong>동작</strong>:</p><ol><li>사용자가 이미지를 업로드 → AppServer가 메시지를 발행</li><li>ResizeService가 큐에서 메시지를 읽고 이미지 리사이징 처리</li><li>처리된 이미지는 CDN에 저장, ACK 전송</li></ol></li><li><p><strong>RabbitMQ 미사용 시</strong>:</p><ul><li>동기 작업으로 응답 타임아웃/느림 발생</li><li>작업 실패 시 재시도 및 복구 어려움</li></ul></li></ul><hr><h2 id=19-구현-예시--python-pika-라이브러리>19. 구현 예시 – Python (pika 라이브러리)<a hidden class=anchor aria-hidden=true href=#19-구현-예시--python-pika-라이브러리>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1> 1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2> 2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3> 3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4> 4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5> 5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6> 6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7> 7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8> 8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9> 9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10>10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11>11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12>12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13>13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14>14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15>15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16>16</a>
</span><span class=lnt id=hl-8-17><a class=lnlinks href=#hl-8-17>17</a>
</span><span class=lnt id=hl-8-18><a class=lnlinks href=#hl-8-18>18</a>
</span><span class=lnt id=hl-8-19><a class=lnlinks href=#hl-8-19>19</a>
</span><span class=lnt id=hl-8-20><a class=lnlinks href=#hl-8-20>20</a>
</span><span class=lnt id=hl-8-21><a class=lnlinks href=#hl-8-21>21</a>
</span><span class=lnt id=hl-8-22><a class=lnlinks href=#hl-8-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pika</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 연결 및 채널 생성</span>
</span></span><span class=line><span class=cl><span class=n>conn</span> <span class=o>=</span> <span class=n>pika</span><span class=o>.</span><span class=n>BlockingConnection</span><span class=p>(</span><span class=n>pika</span><span class=o>.</span><span class=n>ConnectionParameters</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s1>&#39;rabbitmq&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>ch</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>channel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Exchange 및 Queue 선언, Binding</span>
</span></span><span class=line><span class=cl><span class=n>ch</span><span class=o>.</span><span class=n>exchange_declare</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;images&#39;</span><span class=p>,</span> <span class=n>exchange_type</span><span class=o>=</span><span class=s1>&#39;direct&#39;</span><span class=p>,</span> <span class=n>durable</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ch</span><span class=o>.</span><span class=n>queue_declare</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;resize_queue&#39;</span><span class=p>,</span> <span class=n>durable</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ch</span><span class=o>.</span><span class=n>queue_bind</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;images&#39;</span><span class=p>,</span> <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;resize_queue&#39;</span><span class=p>,</span> <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;resize&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메시지 수신 콜백</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>callback</span><span class=p>(</span><span class=n>ch</span><span class=p>,</span> <span class=n>method</span><span class=p>,</span> <span class=n>properties</span><span class=p>,</span> <span class=n>body</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>img_path</span> <span class=o>=</span> <span class=n>body</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># 이미지 리사이징 로직 (예: PIL 사용)</span>
</span></span><span class=line><span class=cl>    <span class=n>resize_image</span><span class=p>(</span><span class=n>img_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>ch</span><span class=o>.</span><span class=n>basic_ack</span><span class=p>(</span><span class=n>delivery_tag</span><span class=o>=</span><span class=n>method</span><span class=o>.</span><span class=n>delivery_tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ch</span><span class=o>.</span><span class=n>basic_qos</span><span class=p>(</span><span class=n>prefetch_count</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ch</span><span class=o>.</span><span class=n>basic_consume</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;resize_queue&#39;</span><span class=p>,</span> <span class=n>on_message_callback</span><span class=o>=</span><span class=n>callback</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ch</span><span class=o>.</span><span class=n>start_consuming</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><p><strong>구현 포인트</strong></p><ul><li><code>durable=True</code> – 메시지·큐 영속성 보장</li><li><code>prefetch_count=1</code> – Consumer 당 하나씩 처리하여 균형 유지</li><li><code>basic_ack()</code> – 메시지 처리가 완료된 후 ACK</li></ul></li></ul><hr><h2 id=20-실무-적용-고려사항-및-주의할-점>20. 실무 적용 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#20-실무-적용-고려사항-및-주의할-점>#</a></h2><table><thead><tr><th>항목</th><th>고려/주의 사항</th><th>권장 방안</th></tr></thead><tbody><tr><td>메시지 내구성</td><td>durable exchange/queue 및 persistent 몸체 설정</td><td>필수 설정으로 구성</td></tr><tr><td>Channel/Connection 부하 관리</td><td>채널 수, 연결 수 제한</td><td>채널 재사용, 커넥션 풀 빌딩</td></tr><tr><td>Dead-Letter(재처리) 정책</td><td>재시도 실패 시 DLQ로 라우팅</td><td>max-length, dead-letter 정책 설정</td></tr><tr><td>Prefetch 설정</td><td>성능 저하 방지 및 부하 분산</td><td>prefetch_count 설정</td></tr><tr><td>클러스터 구성</td><td>AZ 간 네트워크 지연 고려</td><td>quorum queue / federation 구성</td></tr><tr><td>모니터링 및 알람</td><td>큐 길이, 메시지 처리 속도, 노드 상태</td><td>Prometheus + Grafana 지표 통합</td></tr><tr><td>리소스 제한</td><td>Erlang VM 메모리 관리, Channel 과다 사용</td><td>메모리 제한 정책, lazy queue</td></tr></tbody></table><hr><h2 id=21-최적화-고려사항-및-권장-기법>21. 최적화 고려사항 및 권장 기법<a hidden class=anchor aria-hidden=true href=#21-최적화-고려사항-및-권장-기법>#</a></h2><table><thead><tr><th>항목</th><th>최적화 방향</th><th>권장 기법</th></tr></thead><tbody><tr><td>메시지 페이로드</td><td>크기 최소화 및 스트리밍</td><td>파일은 CDN/외부 저장소에, 메시지에는 URL</td></tr><tr><td>큐 유형</td><td>메시지 패턴에 맞는 큐 선택</td><td>classic vs quorom vs mirrored 큐</td></tr><tr><td>채널 재사용</td><td>낮은 오버헤드 유지를 위한 구조</td><td>채널 풀링 라이브러리 활용</td></tr><tr><td>Prefetch/Batch 설정</td><td>효율적 소비 및 리소스 사용 조절</td><td>prefetch, ack 타이밍 조정</td></tr><tr><td>Monitoring</td><td>성능 병목점 탐지</td><td>latencies, queue depths, node health</td></tr></tbody></table><hr><h2 id=22-용어-정리>22. 용어 정리<a hidden class=anchor aria-hidden=true href=#22-용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>메시징</td><td>Exchange</td><td>메시지 라우팅을 담당하는 AMQP 교환기</td></tr><tr><td></td><td>Binding</td><td>Exchange와 Queue 사이의 라우팅 규칙</td></tr><tr><td></td><td>Queue</td><td>메시지를 저장하고 Consumer에 전달하는 버퍼</td></tr><tr><td>레이어</td><td>Channel</td><td>TCP 연결 위의 경량 통신 논리 스트림</td></tr><tr><td>신뢰성</td><td>Publisher Confirms</td><td>메시지 발행 성공 여부를 확인하는 메커니즘</td></tr><tr><td></td><td>DLQ (Dead-Letter Queue)</td><td>실패 메시지를 별도 큐로 보관하여 추적 가능</td></tr><tr><td>HA</td><td>Mirrored Queue</td><td>노드 간 메시지 동기 복제를 위해 사용</td></tr><tr><td></td><td>Quorum Queue</td><td>Raft 기반 다중 노드 복제 큐로 고가용성 제공</td></tr><tr><td>확장성</td><td>Federation & Shovel</td><td>클러스터 간 메시지 전달 및 복제를 위한 플러그인</td></tr></tbody></table><hr><h2 id=23-참고-및-출처>23. 참고 및 출처<a hidden class=anchor aria-hidden=true href=#23-참고-및-출처>#</a></h2><ul><li><a href=http://www.google.co.kr>RabbitMQ official AMQP concepts</a></li><li><a href=http://www.google.co.kr>CloudAMQP: RabbitMQ Queue Types</a></li><li><a href=http://www.google.co.kr>RabbitMQ blog: HA and Federation/Shovel overview</a></li><li><a href=http://www.google.co.kr>StackOverflow discussions on RabbitMQ performance</a></li><li><a href=http://www.google.co.kr>Pika Python library documentation for RabbitMQ</a></li></ul><hr><p>좋습니다. 이어서 마지막 정리인 <strong>주제와 관련하여 주목할 내용</strong>, <strong>반드시 학습해야 할 내용</strong>을 표로 정리하고 마무리하겠습니다.</p><hr><h2 id=24-주제와-관련하여-주목할-내용>24. 주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#24-주제와-관련하여-주목할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>메시징 아키텍처</td><td>AMQP 프로토콜</td><td>AMQP 0-9-1</td><td>RabbitMQ가 사용하는 기본 프로토콜로 메시지 라우팅, 보안, 확인(ACK) 등을 정의</td></tr><tr><td>큐 설계</td><td>Queue 유형</td><td>Quorum Queue</td><td>고가용성을 보장하는 Raft 합의 기반 메시지 큐 유형</td></tr><tr><td>고가용성</td><td>클러스터링</td><td>Mirrored Queue</td><td>복수 노드에 동일한 메시지를 복제하여 장애 대응</td></tr><tr><td>모니터링</td><td>운영 도구</td><td>Prometheus + Grafana</td><td>RabbitMQ의 큐 길이, 처리량, 에러율 등을 실시간 시각화 및 알림 설정 가능</td></tr><tr><td>트래픽 분산</td><td>Prefetch 설정</td><td>QoS 조절</td><td>처리 성능 최적화를 위한 소비자 수 및 버퍼 조절</td></tr><tr><td>신뢰성</td><td>메시지 영속화</td><td>Persistent Messages</td><td>서버 재시작 시에도 유실되지 않도록 디스크에 저장</td></tr><tr><td>통합</td><td>Federation</td><td>원격 브로커 연결</td><td>서로 다른 리전에 위치한 RabbitMQ 인스턴스 간의 메시지 연동</td></tr><tr><td>성능 최적화</td><td>Lazy Queue</td><td>디스크 우선 메시지 저장</td><td>메모리 부족 시 디스크에 저장하여 처리 안정성 강화</td></tr></tbody></table><hr><h2 id=25-반드시-학습해야-할-내용>25. 반드시 학습해야 할 내용<a hidden class=anchor aria-hidden=true href=#25-반드시-학습해야-할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>메시징 시스템</td><td>AMQP</td><td>Exchange / Routing Key</td><td>메시지의 목적지 결정에 필요한 라우팅 정보</td></tr><tr><td>고가용성 전략</td><td>Quorum Queue</td><td>Raft Consensus</td><td>복수 노드가 동일한 상태를 유지하는 분산 합의 알고리즘</td></tr><tr><td>장애 복구 전략</td><td>Dead-Letter Queue</td><td>DLQ 정책 설정</td><td>메시지 실패 시 재시도 및 추적을 위한 보조 큐</td></tr><tr><td>운영 최적화</td><td>Monitoring</td><td>Queue Depth, Ack Latency</td><td>처리 지연, 누락 등을 예방하기 위한 모니터링 지표</td></tr><tr><td>스케일 아웃 설계</td><td>Channel & Connection</td><td>효율적인 채널 관리</td><td>과도한 채널 사용 시 리소스 병목 발생 가능</td></tr><tr><td>멀티 브로커 통신</td><td>Federation & Shovel</td><td>브로커 간 메시지 복제</td><td>WAN/다중 클러스터 환경에서 데이터 일관성 유지</td></tr></tbody></table><hr><h2 id=용어-정리-1>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-1>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>프로토콜</td><td>AMQP</td><td>Advanced Message Queuing Protocol. 메시지 전달 규칙 정의</td></tr><tr><td>큐 구성</td><td>Exchange</td><td>메시지를 Queue로 라우팅하는 구성 요소</td></tr><tr><td>큐 구성</td><td>Routing Key</td><td>Exchange에서 메시지를 특정 Queue로 전달하기 위한 키</td></tr><tr><td>고가용성</td><td>Mirrored Queue</td><td>여러 노드에 메시지를 복제하여 하나가 죽어도 서비스 유지</td></tr><tr><td>고가용성</td><td>Quorum Queue</td><td>과반수 노드가 살아있을 때만 메시지를 처리하는 큐</td></tr><tr><td>신뢰성</td><td>DLQ</td><td>메시지 소비 실패 시 저장되는 특별한 큐</td></tr><tr><td>최적화</td><td>Lazy Queue</td><td>메시지를 메모리 대신 디스크에 저장하여 리소스 절약</td></tr><tr><td>확장성</td><td>Federation</td><td>다른 브로커로 메시지를 전파하는 기능</td></tr><tr><td>운영</td><td>Prefetch</td><td>소비자가 한번에 처리할 수 있는 메시지 수 제한</td></tr></tbody></table><hr><h2 id=참고-및-출처-1>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-1>#</a></h2><ul><li><a href=https://www.rabbitmq.com/documentation.html>RabbitMQ 공식 문서: 개요</a></li><li><a href=https://www.cloudamqp.com/blog/part3-rabbitmq-best-practice-for-high-availability.html>CloudAMQP: RabbitMQ Queue Types</a></li><li><a href=https://www.rabbitmq.com/federation.html>RabbitMQ Federation & Shovel 개요</a></li><li><a href=https://pika.readthedocs.io/en/stable/>Pika 공식 문서 (Python RabbitMQ Client)</a></li><li><a href=https://scalegrid.io/blog/scaling-rabbitmq/>ScaleGrid: Scaling RabbitMQ</a></li><li><a href=https://jack-vanlightly.com/blog/2017/3/10/rabbitmq-the-different-failures-on-basicpublish>Jack Vanlightly 블로그 – RabbitMQ Failures</a></li></ul><hr><p>깊이 있는 RabbitMQ 조사와 분석을 단계별로 진행하겠습니다.</p><h2 id=1-주제-태그>1. 주제 태그<a hidden class=anchor aria-hidden=true href=#1-주제-태그>#</a></h2><ul><li>Message-Broker</li><li>Distributed-Systems</li><li>AMQP-Protocol</li><li>Asynchronous-Communication</li></ul><h2 id=2-분류-구조-검토>2. 분류 구조 검토<a hidden class=anchor aria-hidden=true href=#2-분류-구조-검토>#</a></h2><p>제시된 &ldquo;Computer Science and Engineering > Systems and Infrastructure > Infrastructure > Infrastructure Components > Messaging Systems > Implementations > Event Streaming Platforms > Messaging Queue&rdquo; 분류는 적절합니다.</p><p><strong>근거:</strong></p><ul><li>RabbitMQ는 시스템 간 비동기 통신을 위한 인프라 구성 요소</li><li>메시징 시스템의 구체적인 구현체</li><li>분산 시스템에서 메시지 큐잉 기능 제공</li></ul><h2 id=3-주제-요약-설명-200자>3. 주제 요약 설명 (200자)<a hidden class=anchor aria-hidden=true href=#3-주제-요약-설명-200자>#</a></h2><p>RabbitMQ는 AMQP (Advanced Message Queuing Protocol)를 구현한 오픈소스 메시지 브로커로, 애플리케이션 간 안정적이고 확장 가능한 비동기 메시지 전달을 지원합니다. 높은 가용성과 내구성을 제공하며, 다양한 메시징 패턴과 라우팅 기능을 통해 분산 시스템에서 서비스 간 결합도를 낮추고 확장성을 향상시킵니다.</p><h2 id=4-개요-250자-1>4. 개요 (250자)<a hidden class=anchor aria-hidden=true href=#4-개요-250자-1>#</a></h2><p>RabbitMQ는 Erlang으로 개발된 메시지 브로커로, 프로듀서 (Producer)와 컨슈머 (Consumer) 간의 메시지 전달을 중개합니다. Exchange, Queue, Binding 등의 핵심 구성 요소를 통해 복잡한 라우팅 로직을 구현할 수 있으며, 클러스터링, 페더레이션, 높은 가용성 등의 기능을 제공합니다. 마이크로서비스 아키텍처에서 서비스 간 통신, 작업 큐잉, 이벤트 기반 아키텍처 구현에 널리 사용됩니다.</p><hr><h1 id=제1부-핵심-개념-및-기본-원리>제1부: 핵심 개념 및 기본 원리<a hidden class=anchor aria-hidden=true href=#제1부-핵심-개념-및-기본-원리>#</a></h1><h2 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h2><h3 id=메시지-브로커-message-broker>메시지 브로커 (Message Broker)<a hidden class=anchor aria-hidden=true href=#메시지-브로커-message-broker>#</a></h3><p>RabbitMQ는 메시지 브로커로서 애플리케이션 간 메시지 전달을 중개하는 역할을 합니다. 송신자 (프로듀서)와 수신자 (컨슈머) 사이에서 메시지를 안전하게 저장하고 전달하여 시스템 간 결합도를 낮춥니다.</p><h3 id=amqp-advanced-message-queuing-protocol>AMQP (Advanced Message Queuing Protocol)<a hidden class=anchor aria-hidden=true href=#amqp-advanced-message-queuing-protocol>#</a></h3><p>RabbitMQ의 핵심 통신 프로토콜로, 메시지 지향 미들웨어를 위한 오픈 표준입니다. 메시지 라우팅, 큐잉, 안정성, 보안 등을 정의합니다.</p><h3 id=비동기-통신-asynchronous-communication>비동기 통신 (Asynchronous Communication)<a hidden class=anchor aria-hidden=true href=#비동기-통신-asynchronous-communication>#</a></h3><p>메시지 송신자와 수신자가 동시에 활성화되지 않아도 통신이 가능한 방식입니다. 시스템 간 느슨한 결합을 통해 확장성과 내결함성을 향상시킵니다.</p><h3 id=영속성-persistence>영속성 (Persistence)<a hidden class=anchor aria-hidden=true href=#영속성-persistence>#</a></h3><p>메시지와 큐를 디스크에 저장하여 브로커가 재시작되어도 데이터가 유지되도록 하는 기능입니다.</p><h3 id=실무-구현-연관성>실무 구현 연관성<a hidden class=anchor aria-hidden=true href=#실무-구현-연관성>#</a></h3><ul><li><strong>확장성</strong>: 메시지 큐를 통해 시스템 부하 분산 및 처리 능력 확장</li><li><strong>내결함성</strong>: 메시지 영속성과 확인 메커니즘으로 데이터 손실 방지</li><li><strong>유연성</strong>: 다양한 exchange 타입과 라우팅 키를 통한 복잡한 메시지 라우팅</li><li><strong>모니터링</strong>: 관리 인터페이스와 메트릭을 통한 시스템 상태 추적</li></ul><h2 id=배경>배경<a hidden class=anchor aria-hidden=true href=#배경>#</a></h2><h3 id=등장-배경>등장 배경<a hidden class=anchor aria-hidden=true href=#등장-배경>#</a></h3><ul><li><strong>분산 시스템의 복잡성</strong>: 마이크로서비스 아키텍처의 확산으로 서비스 간 통신 복잡도 증가</li><li><strong>동기 통신의 한계</strong>: 직접적인 HTTP 호출로 인한 강한 결합도와 장애 전파 문제</li><li><strong>확장성 요구사항</strong>: 높은 처리량과 가용성이 필요한 웹 애플리케이션 증가</li></ul><h3 id=기술적-배경>기술적 배경<a hidden class=anchor aria-hidden=true href=#기술적-배경>#</a></h3><ul><li><strong>Erlang 기반</strong>: 높은 동시성과 내결함성을 제공하는 Erlang 언어로 개발</li><li><strong>AMQP 표준</strong>: 벤더 중립적인 메시징 프로토콜 필요성</li><li><strong>오픈소스 생태계</strong>: 상용 솔루션의 대안으로 오픈소스 메시징 솔루션 요구</li></ul><h2 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h2><h3 id=주요-목적>주요 목적<a hidden class=anchor aria-hidden=true href=#주요-목적>#</a></h3><ol><li><strong>서비스 간 결합도 감소</strong>: 직접 통신 대신 메시지 브로커를 통한 간접 통신</li><li><strong>비동기 처리</strong>: 시간이 오래 걸리는 작업의 백그라운드 처리</li><li><strong>부하 분산</strong>: 여러 워커 인스턴스에 작업 분산</li><li><strong>시스템 안정성</strong>: 메시지 영속성과 확인 메커니즘을 통한 데이터 보호</li></ol><h3 id=필요성>필요성<a hidden class=anchor aria-hidden=true href=#필요성>#</a></h3><ul><li><strong>확장성</strong>: 트래픽 증가에 따른 시스템 확장 필요성</li><li><strong>신뢰성</strong>: 메시지 손실 방지와 전달 보장</li><li><strong>유연성</strong>: 다양한 메시징 패턴 지원 필요</li><li><strong>관리 효율성</strong>: 중앙 집중식 메시지 관리 및 모니터링</li></ul><h2 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h2><h3 id=핵심-기능>핵심 기능<a hidden class=anchor aria-hidden=true href=#핵심-기능>#</a></h3><ol><li><strong>메시지 라우팅</strong>: Exchange와 라우팅 키를 통한 지능적 메시지 전달</li><li><strong>큐 관리</strong>: 메시지 저장, 순서 보장, 우선순위 처리</li><li><strong>클러스터링</strong>: 여러 노드를 통한 고가용성 구현</li><li><strong>페더레이션</strong>: 지리적으로 분산된 브로커 간 연결</li><li><strong>보안</strong>: 사용자 인증, 권한 관리, SSL/TLS 지원</li></ol><h3 id=주요-역할>주요 역할<a hidden class=anchor aria-hidden=true href=#주요-역할>#</a></h3><ul><li><strong>메시지 중개자</strong>: 프로듀서와 컨슈머 간 메시지 전달</li><li><strong>부하 분산기</strong>: 여러 워커에 작업 분산</li><li><strong>데이터 버퍼</strong>: 처리 속도 차이를 완충하는 임시 저장소</li><li><strong>시스템 격리</strong>: 서비스 간 장애 전파 방지</li></ul><h2 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h2><h3 id=기술적-특징>기술적 특징<a hidden class=anchor aria-hidden=true href=#기술적-특징>#</a></h3><ul><li><strong>Erlang/OTP 기반</strong>: 높은 동시성과 내결함성</li><li><strong>AMQP 0.9.1 구현</strong>: 표준 프로토콜 지원</li><li><strong>플러그인 아키텍처</strong>: 확장 가능한 모듈식 구조</li><li><strong>관리 UI</strong>: 웹 기반 관리 인터페이스 제공</li></ul><h3 id=운영-특징>운영 특징<a hidden class=anchor aria-hidden=true href=#운영-특징>#</a></h3><ul><li><strong>높은 가용성</strong>: 클러스터링과 미러링 지원</li><li><strong>확장성</strong>: 수평적 확장 가능</li><li><strong>모니터링</strong>: 실시간 메트릭과 알림 기능</li><li><strong>다양한 클라이언트</strong>: 여러 프로그래밍 언어 지원</li></ul><hr><h1 id=제2부-구조-및-아키텍처>제2부: 구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#제2부-구조-및-아키텍처>#</a></h1><h2 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h2><h3 id=1-메시지-지향-아키텍처-message-oriented-architecture>1. 메시지 지향 아키텍처 (Message-Oriented Architecture)<a hidden class=anchor aria-hidden=true href=#1-메시지-지향-아키텍처-message-oriented-architecture>#</a></h3><p>메시지를 통한 시스템 간 통신으로 느슨한 결합 구현</p><h3 id=2-안정성-우선-reliability-first>2. 안정성 우선 (Reliability First)<a hidden class=anchor aria-hidden=true href=#2-안정성-우선-reliability-first>#</a></h3><p>메시지 전달 보장과 영속성을 통한 데이터 안전성 확보</p><h3 id=3-유연한-라우팅-flexible-routing>3. 유연한 라우팅 (Flexible Routing)<a hidden class=anchor aria-hidden=true href=#3-유연한-라우팅-flexible-routing>#</a></h3><p>다양한 exchange 타입과 바인딩을 통한 복잡한 라우팅 로직 지원</p><h3 id=4-확장성-scalability>4. 확장성 (Scalability)<a hidden class=anchor aria-hidden=true href=#4-확장성-scalability>#</a></h3><p>클러스터링과 페더레이션을 통한 수평적 확장</p><h2 id=주요-원리>주요 원리<a hidden class=anchor aria-hidden=true href=#주요-원리>#</a></h2><h3 id=1-프로듀서-컨슈머-모델>1. 프로듀서-컨슈머 모델<a hidden class=anchor aria-hidden=true href=#1-프로듀서-컨슈머-모델>#</a></h3><pre class=mermaid>graph LR
    A[Producer] --&gt; B[Exchange] --&gt; C[Queue] --&gt; D[Consumer]
    B --&gt; E[Queue] --&gt; F[Consumer]
    B --&gt; G[Queue] --&gt; H[Consumer]
</pre><h3 id=2-exchange-라우팅-원리>2. Exchange 라우팅 원리<a hidden class=anchor aria-hidden=true href=#2-exchange-라우팅-원리>#</a></h3><pre class=mermaid>graph TD
    A[Producer] --&gt; B[Exchange]
    B --&gt; C[Routing Key 매칭]
    C --&gt; D[Queue 1]
    C --&gt; E[Queue 2]
    C --&gt; F[Queue 3]
    D --&gt; G[Consumer 1]
    E --&gt; H[Consumer 2]
    F --&gt; I[Consumer 3]
</pre><h2 id=작동-원리-및-방식>작동 원리 및 방식<a hidden class=anchor aria-hidden=true href=#작동-원리-및-방식>#</a></h2><h3 id=메시지-전달-과정>메시지 전달 과정<a hidden class=anchor aria-hidden=true href=#메시지-전달-과정>#</a></h3><ol><li><strong>메시지 발행</strong>: 프로듀서가 exchange에 메시지 발행</li><li><strong>라우팅</strong>: Exchange가 라우팅 키와 바인딩 규칙에 따라 큐 결정</li><li><strong>큐잉</strong>: 메시지가 대상 큐에 저장</li><li><strong>전달</strong>: 컨슈머가 큐에서 메시지 수신</li><li><strong>확인</strong>: 메시지 처리 완료 후 ACK 전송</li></ol><h3 id=플로우-다이어그램>플로우 다이어그램<a hidden class=anchor aria-hidden=true href=#플로우-다이어그램>#</a></h3><pre class=mermaid>sequenceDiagram
    participant P as Producer
    participant E as Exchange
    participant Q as Queue
    participant C as Consumer
    
    P-&gt;&gt;E: 메시지 발행
    E-&gt;&gt;Q: 라우팅 규칙에 따라 큐에 저장
    Q-&gt;&gt;C: 메시지 전달
    C-&gt;&gt;Q: ACK 응답
    Q-&gt;&gt;E: 메시지 삭제 확인
</pre><h2 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h2><h3 id=전체-아키텍처>전체 아키텍처<a hidden class=anchor aria-hidden=true href=#전체-아키텍처>#</a></h3><pre class=mermaid>graph TB
    subgraph &#34;RabbitMQ 클러스터&#34;
        A[관리 노드] --&gt; B[브로커 노드 1]
        A --&gt; C[브로커 노드 2]
        A --&gt; D[브로커 노드 3]
        
        subgraph &#34;브로커 노드 구성&#34;
            E[Exchange] --&gt; F[Queue 1]
            E --&gt; G[Queue 2]
            E --&gt; H[Queue 3]
            F --&gt; I[Consumer 1]
            G --&gt; J[Consumer 2]
            H --&gt; K[Consumer 3]
        end
    end
    
    L[Producer Apps] --&gt; E
    M[Management UI] --&gt; A
</pre><h3 id=구성-요소>구성 요소<a hidden class=anchor aria-hidden=true href=#구성-요소>#</a></h3><h4 id=필수-구성요소>필수 구성요소<a hidden class=anchor aria-hidden=true href=#필수-구성요소>#</a></h4><p><strong>1. Exchange (교환기)</strong></p><ul><li><strong>기능</strong>: 메시지 라우팅 규칙 정의</li><li><strong>역할</strong>: 프로듀서로부터 메시지 수신 후 큐로 라우팅</li><li><strong>특징</strong>: 다양한 타입 지원 (Direct, Topic, Fanout, Headers)</li></ul><p><strong>2. Queue (큐)</strong></p><ul><li><strong>기능</strong>: 메시지 저장소 역할</li><li><strong>역할</strong>: 메시지 임시 저장 및 컨슈머에게 전달</li><li><strong>특징</strong>: FIFO 순서 보장, 영속성 지원</li></ul><p><strong>3. Binding (바인딩)</strong></p><ul><li><strong>기능</strong>: Exchange와 Queue 간 연결 관계 정의</li><li><strong>역할</strong>: 라우팅 규칙 설정</li><li><strong>특징</strong>: 라우팅 키 패턴 매칭</li></ul><p><strong>4. Connection (연결)</strong></p><ul><li><strong>기능</strong>: 클라이언트와 브로커 간 TCP 연결</li><li><strong>역할</strong>: 물리적 통신 채널 제공</li><li><strong>특징</strong>: 인증 및 보안 처리</li></ul><p><strong>5. Channel (채널)</strong></p><ul><li><strong>기능</strong>: 연결 내의 가상 통신 채널</li><li><strong>역할</strong>: 멀티플렉싱을 통한 효율적 통신</li><li><strong>특징</strong>: 경량 통신 단위</li></ul><h4 id=선택-구성요소>선택 구성요소<a hidden class=anchor aria-hidden=true href=#선택-구성요소>#</a></h4><p><strong>1. 클러스터 (Cluster)</strong></p><ul><li><strong>기능</strong>: 여러 노드를 하나의 논리적 브로커로 구성</li><li><strong>역할</strong>: 고가용성과 확장성 제공</li><li><strong>특징</strong>: 자동 장애 복구, 부하 분산</li></ul><p><strong>2. 페더레이션 (Federation)</strong></p><ul><li><strong>기능</strong>: 지리적으로 분산된 브로커 간 연결</li><li><strong>역할</strong>: WAN 환경에서 메시지 전달</li><li><strong>특징</strong>: 네트워크 최적화, 지연 허용</li></ul><p><strong>3. 쇼벨 (Shovel)</strong></p><ul><li><strong>기능</strong>: 브로커 간 메시지 이동</li><li><strong>역할</strong>: 데이터 마이그레이션, 백업</li><li><strong>특징</strong>: 유연한 메시지 변환</li></ul><p><strong>4. 관리 플러그인</strong></p><ul><li><strong>기능</strong>: 웹 기반 관리 인터페이스</li><li><strong>역할</strong>: 모니터링, 설정 관리</li><li><strong>특징</strong>: RESTful API 제공</li></ul><hr><h1 id=제3부-구현-및-실무-활용>제3부: 구현 및 실무 활용<a hidden class=anchor aria-hidden=true href=#제3부-구현-및-실무-활용>#</a></h1><h2 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h2><h3 id=1-직접-메시징-direct-messaging>1. 직접 메시징 (Direct Messaging)<a hidden class=anchor aria-hidden=true href=#1-직접-메시징-direct-messaging>#</a></h3><p><strong>정의</strong>: 라우팅 키와 큐 이름이 정확히 일치하는 메시지 전달 방식</p><p><strong>구성</strong>:</p><ul><li>Direct Exchange</li><li>라우팅 키 기반 바인딩</li><li>일대일 메시지 전달</li></ul><p><strong>목적</strong>: 특정 대상에게 정확한 메시지 전달</p><p><strong>실제 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1>1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2>2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3>3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4>4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5>5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6>6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7>7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8>8</a>
</span><span class=lnt id=hl-13-9><a class=lnlinks href=#hl-13-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 시스템 구성: 주문 처리 시스템</span>
</span></span><span class=line><span class=cl><span class=c1># 시나리오: 특정 지역의 주문을 해당 지역 처리 센터로 전달</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_declare</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;orders_seoul&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_declare</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;orders_busan&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>exchange_declare</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;order_router&#39;</span><span class=p>,</span> <span class=n>exchange_type</span><span class=o>=</span><span class=s1>&#39;direct&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 바인딩 설정</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_bind</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;order_router&#39;</span><span class=p>,</span> <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;orders_seoul&#39;</span><span class=p>,</span> <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;seoul&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_bind</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;order_router&#39;</span><span class=p>,</span> <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;orders_busan&#39;</span><span class=p>,</span> <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;busan&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=2-주제-기반-라우팅-topic-based-routing>2. 주제 기반 라우팅 (Topic-based Routing)<a hidden class=anchor aria-hidden=true href=#2-주제-기반-라우팅-topic-based-routing>#</a></h3><p><strong>정의</strong>: 패턴 매칭을 통한 유연한 메시지 라우팅</p><p><strong>구성</strong>:</p><ul><li>Topic Exchange</li><li>와일드카드 패턴 (*, #)</li><li>계층적 라우팅 키</li></ul><p><strong>목적</strong>: 복잡한 라우팅 로직 구현</p><p><strong>실제 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1>1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2>2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3>3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4>4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5>5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6>6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 시스템 구성: 로그 수집 시스템</span>
</span></span><span class=line><span class=cl><span class=c1># 시나리오: 로그 레벨과 모듈에 따른 분산 처리</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>exchange_declare</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;logs&#39;</span><span class=p>,</span> <span class=n>exchange_type</span><span class=o>=</span><span class=s1>&#39;topic&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 패턴 기반 바인딩</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_bind</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;logs&#39;</span><span class=p>,</span> <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;error_logs&#39;</span><span class=p>,</span> <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;*.error.*&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_bind</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;logs&#39;</span><span class=p>,</span> <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;auth_logs&#39;</span><span class=p>,</span> <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;auth.*&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=3-발행-구독-패턴-publish-subscribe>3. 발행-구독 패턴 (Publish-Subscribe)<a hidden class=anchor aria-hidden=true href=#3-발행-구독-패턴-publish-subscribe>#</a></h3><p><strong>정의</strong>: 하나의 메시지를 여러 구독자에게 동시 전달</p><p><strong>구성</strong>:</p><ul><li>Fanout Exchange</li><li>모든 바인딩된 큐에 전달</li><li>브로드캐스트 메시징</li></ul><p><strong>목적</strong>: 이벤트 기반 아키텍처 구현</p><p><strong>실제 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1>1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2>2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3>3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4>4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5>5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 시스템 구성: 실시간 알림 시스템</span>
</span></span><span class=line><span class=cl><span class=c1># 시나리오: 새 게시글을 모든 알림 채널에 전송</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>exchange_declare</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;notifications&#39;</span><span class=p>,</span> <span class=n>exchange_type</span><span class=o>=</span><span class=s1>&#39;fanout&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_bind</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;notifications&#39;</span><span class=p>,</span> <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;email_notifications&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_bind</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;notifications&#39;</span><span class=p>,</span> <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;push_notifications&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_bind</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;notifications&#39;</span><span class=p>,</span> <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;sms_notifications&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=4-작업-큐-패턴-work-queue-pattern>4. 작업 큐 패턴 (Work Queue Pattern)<a hidden class=anchor aria-hidden=true href=#4-작업-큐-패턴-work-queue-pattern>#</a></h3><p><strong>정의</strong>: 시간 소모적인 작업을 여러 워커에 분산 처리</p><p><strong>구성</strong>:</p><ul><li>단일 큐</li><li>여러 컨슈머 (워커)</li><li>라운드 로빈 분산</li></ul><p><strong>목적</strong>: 부하 분산과 병렬 처리</p><p><strong>실제 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1>1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2>2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3>3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 시스템 구성: 이미지 처리 시스템</span>
</span></span><span class=line><span class=cl><span class=c1># 시나리오: 업로드된 이미지를 여러 워커가 병렬 처리</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_declare</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;image_processing&#39;</span><span class=p>,</span> <span class=n>durable</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>basic_qos</span><span class=p>(</span><span class=n>prefetch_count</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># 워커당 하나씩 처리</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h2><table><thead><tr><th>구분</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>장점</td><td>높은 신뢰성</td><td>메시지 영속성과 확인 메커니즘으로 데이터 손실 방지</td></tr><tr><td></td><td>확장성</td><td>클러스터링과 페더레이션을 통한 수평적 확장 지원</td></tr><tr><td></td><td>유연한 라우팅</td><td>다양한 Exchange 타입으로 복잡한 메시지 라우팅 구현</td></tr><tr><td></td><td>관리 용이성</td><td>웹 기반 관리 UI와 RESTful API 제공</td></tr><tr><td></td><td>다양한 프로토콜 지원</td><td>AMQP, MQTT, STOMP 등 다중 프로토콜 지원</td></tr><tr><td></td><td>성능 최적화</td><td>Erlang 기반의 높은 동시성과 처리량</td></tr></tbody></table><h2 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h2><h3 id=단점-2>단점<a hidden class=anchor aria-hidden=true href=#단점-2>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>단점</td><td>복잡성</td><td>초기 설정과 구성이 복잡함</td><td>표준화된 설정 템플릿 사용, 단계별 구축</td></tr><tr><td></td><td>메모리 사용량</td><td>Erlang VM의 높은 메모리 사용량</td><td>적절한 메모리 할당, 모니터링 강화</td></tr><tr><td></td><td>단일 장애점</td><td>중앙 집중식 구조로 브로커 장애 시 전체 영향</td><td>클러스터링, 미러링 구성</td></tr><tr><td></td><td>학습 곡선</td><td>AMQP와 RabbitMQ 개념 학습 필요</td><td>체계적인 교육, 문서화</td></tr></tbody></table><h3 id=문제점-2>문제점<a hidden class=anchor aria-hidden=true href=#문제점-2>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 방법 및 기법</th></tr></thead><tbody><tr><td>문제점</td><td>메시지 적체</td><td>컨슈머 처리 속도 저하</td><td>메모리 부족, 성능 저하</td><td>큐 길이 모니터링</td><td>적절한 프리페치 설정</td><td>컨슈머 인스턴스 증가</td></tr><tr><td></td><td>메모리 누수</td><td>미확인 메시지 누적</td><td>브로커 메모리 부족</td><td>메모리 사용량 추적</td><td>적절한 TTL 설정</td><td>메시지 확인 로직 개선</td></tr><tr><td></td><td>네트워크 파티션</td><td>클러스터 노드 간 통신 장애</td><td>데이터 불일치</td><td>클러스터 상태 모니터링</td><td>네트워크 이중화</td><td>파티션 핸들링 정책 설정</td></tr><tr><td></td><td>디스크 부족</td><td>영속성 메시지 과도한 저장</td><td>브로커 중단</td><td>디스크 사용량 모니터링</td><td>정기적인 메시지 정리</td><td>디스크 확장, 메시지 보관 정책 수정</td></tr></tbody></table><h2 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h2><h3 id=1-성능-최적화>1. 성능 최적화<a hidden class=anchor aria-hidden=true href=#1-성능-최적화>#</a></h3><p><strong>원인</strong>: 높은 처리량 요구사항과 레이턴시 민감성
<strong>영향</strong>: 시스템 전체 성능 저하
<strong>해결 방법</strong>:</p><ul><li>메시지 배치 처리</li><li>적절한 프리페치 설정</li><li>클러스터 최적화</li></ul><h3 id=2-데이터-일관성>2. 데이터 일관성<a hidden class=anchor aria-hidden=true href=#2-데이터-일관성>#</a></h3><p><strong>원인</strong>: 분산 환경에서의 메시지 순서 보장
<strong>영향</strong>: 비즈니스 로직 오류
<strong>해결 방법</strong>:</p><ul><li>단일 큐 사용</li><li>메시지 시퀀싱</li><li>이벤트 소싱 패턴</li></ul><h3 id=3-보안-강화>3. 보안 강화<a hidden class=anchor aria-hidden=true href=#3-보안-강화>#</a></h3><p><strong>원인</strong>: 메시지 데이터의 민감성
<strong>영향</strong>: 데이터 유출 위험
<strong>해결 방법</strong>:</p><ul><li>메시지 암호화</li><li>접근 제어 강화</li><li>감사 로깅</li></ul><h3 id=4-모니터링과-관찰-가능성>4. 모니터링과 관찰 가능성<a hidden class=anchor aria-hidden=true href=#4-모니터링과-관찰-가능성>#</a></h3><p><strong>원인</strong>: 복잡한 메시징 플로우
<strong>영향</strong>: 장애 진단 어려움
<strong>해결 방법</strong>:</p><ul><li>분산 추적</li><li>메트릭 수집</li><li>로그 통합</li></ul><h2 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h2><table><thead><tr><th>분류 기준</th><th>종류</th><th>설명</th></tr></thead><tbody><tr><td>Exchange 타입</td><td>Direct</td><td>정확한 라우팅 키 매칭</td></tr><tr><td></td><td>Topic</td><td>패턴 기반 라우팅</td></tr><tr><td></td><td>Fanout</td><td>브로드캐스트 메시징</td></tr><tr><td></td><td>Headers</td><td>헤더 기반 라우팅</td></tr><tr><td>큐 타입</td><td>Classic</td><td>기본 큐 타입</td></tr><tr><td></td><td>Quorum</td><td>고가용성 큐</td></tr><tr><td></td><td>Stream</td><td>스트리밍 큐</td></tr><tr><td>배포 형태</td><td>Standalone</td><td>단일 노드 배포</td></tr><tr><td></td><td>Cluster</td><td>다중 노드 클러스터</td></tr><tr><td></td><td>Federation</td><td>지리적 분산</td></tr><tr><td>사용 패턴</td><td>Work Queue</td><td>작업 분산</td></tr><tr><td></td><td>Publish/Subscribe</td><td>이벤트 브로드캐스트</td></tr><tr><td></td><td>RPC</td><td>원격 프로시저 호출</td></tr><tr><td></td><td>Routing</td><td>선택적 라우팅</td></tr></tbody></table><hr><h1 id=제4부-실무-활용-및-최적화>제4부: 실무 활용 및 최적화<a hidden class=anchor aria-hidden=true href=#제4부-실무-활용-및-최적화>#</a></h1><h2 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h2><table><thead><tr><th>사용 목적</th><th>함께 사용하는 기술</th><th>효과</th></tr></thead><tbody><tr><td>마이크로서비스 통신</td><td>Spring Boot, Docker, Kubernetes</td><td>서비스 간 결합도 감소, 확장성 향상</td></tr><tr><td>비동기 작업 처리</td><td>Celery, Redis, Python</td><td>응답 시간 단축, 사용자 경험 개선</td></tr><tr><td>이벤트 기반 아키텍처</td><td>Apache Kafka, Event Sourcing</td><td>시스템 유연성 증가, 실시간 처리</td></tr><tr><td>데이터 파이프라인</td><td>Apache Airflow, ETL Tools</td><td>데이터 처리 안정성, 배치 작업 자동화</td></tr><tr><td>로그 수집 시스템</td><td>ELK Stack, Fluentd</td><td>중앙 집중식 로그 관리, 분석 효율성</td></tr><tr><td>알림 시스템</td><td>Firebase, SendGrid, Twilio</td><td>실시간 알림 전달, 다채널 지원</td></tr></tbody></table><h2 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h2><h3 id=전자상거래-주문-처리-시스템>전자상거래 주문 처리 시스템<a hidden class=anchor aria-hidden=true href=#전자상거래-주문-처리-시스템>#</a></h3><p><strong>시스템 구성</strong>:</p><ul><li>주문 서비스 (Order Service)</li><li>재고 관리 서비스 (Inventory Service)</li><li>결제 서비스 (Payment Service)</li><li>배송 서비스 (Shipping Service)</li><li>알림 서비스 (Notification Service)</li></ul><p><strong>시스템 구성 다이어그램</strong>:</p><pre class=mermaid>graph TD
    A[주문 생성] --&gt; B[주문 Exchange]
    B --&gt; C[재고 확인 Queue]
    B --&gt; D[결제 처리 Queue]
    B --&gt; E[알림 Queue]
    
    C --&gt; F[재고 서비스]
    D --&gt; G[결제 서비스]
    E --&gt; H[알림 서비스]
    
    F --&gt; I[재고 결과 Exchange]
    G --&gt; J[결제 결과 Exchange]
    
    I --&gt; K[배송 준비 Queue]
    J --&gt; K
    
    K --&gt; L[배송 서비스]
    L --&gt; M[배송 알림 Queue]
    M --&gt; H
</pre><p><strong>Workflow</strong>:</p><ol><li>고객이 주문을 생성하면 주문 서비스가 주문 정보를 Exchange에 발행</li><li>재고 확인, 결제 처리, 알림 전송 큐로 메시지 라우팅</li><li>각 서비스가 독립적으로 작업 처리</li><li>재고 확인과 결제 완료 후 배송 서비스 활성화</li><li>배송 상태 변경 시 고객에게 알림 전송</li></ol><p><strong>RabbitMQ의 역할</strong>:</p><ul><li>서비스 간 느슨한 결합 제공</li><li>비동기 처리를 통한 응답 시간 단축</li><li>장애 시 메시지 보존으로 데이터 손실 방지</li><li>트래픽 급증 시 메시지 버퍼링</li></ul><p><strong>RabbitMQ 유무에 따른 차이점</strong>:</p><p><em>RabbitMQ 없이</em>:</p><ul><li>서비스 간 직접 HTTP 호출</li><li>동기 처리로 인한 긴 응답 시간</li><li>하나의 서비스 장애 시 전체 프로세스 중단</li><li>트래픽 급증 시 시스템 과부하</li></ul><p><em>RabbitMQ 사용</em>:</p><ul><li>비동기 메시지 기반 통신</li><li>빠른 응답 시간 (주문 접수 즉시 응답)</li><li>서비스 장애 시 메시지 보존 및 재처리</li><li>자동 부하 분산 및 확장성</li></ul><h2 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h2><h3 id=주문-처리-시스템-구현>주문 처리 시스템 구현<a hidden class=anchor aria-hidden=true href=#주문-처리-시스템-구현>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1>  1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2>  2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3>  3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4>  4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5>  5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6>  6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7>  7</a>
</span><span class=lnt id=hl-18-8><a class=lnlinks href=#hl-18-8>  8</a>
</span><span class=lnt id=hl-18-9><a class=lnlinks href=#hl-18-9>  9</a>
</span><span class=lnt id=hl-18-10><a class=lnlinks href=#hl-18-10> 10</a>
</span><span class=lnt id=hl-18-11><a class=lnlinks href=#hl-18-11> 11</a>
</span><span class=lnt id=hl-18-12><a class=lnlinks href=#hl-18-12> 12</a>
</span><span class=lnt id=hl-18-13><a class=lnlinks href=#hl-18-13> 13</a>
</span><span class=lnt id=hl-18-14><a class=lnlinks href=#hl-18-14> 14</a>
</span><span class=lnt id=hl-18-15><a class=lnlinks href=#hl-18-15> 15</a>
</span><span class=lnt id=hl-18-16><a class=lnlinks href=#hl-18-16> 16</a>
</span><span class=lnt id=hl-18-17><a class=lnlinks href=#hl-18-17> 17</a>
</span><span class=lnt id=hl-18-18><a class=lnlinks href=#hl-18-18> 18</a>
</span><span class=lnt id=hl-18-19><a class=lnlinks href=#hl-18-19> 19</a>
</span><span class=lnt id=hl-18-20><a class=lnlinks href=#hl-18-20> 20</a>
</span><span class=lnt id=hl-18-21><a class=lnlinks href=#hl-18-21> 21</a>
</span><span class=lnt id=hl-18-22><a class=lnlinks href=#hl-18-22> 22</a>
</span><span class=lnt id=hl-18-23><a class=lnlinks href=#hl-18-23> 23</a>
</span><span class=lnt id=hl-18-24><a class=lnlinks href=#hl-18-24> 24</a>
</span><span class=lnt id=hl-18-25><a class=lnlinks href=#hl-18-25> 25</a>
</span><span class=lnt id=hl-18-26><a class=lnlinks href=#hl-18-26> 26</a>
</span><span class=lnt id=hl-18-27><a class=lnlinks href=#hl-18-27> 27</a>
</span><span class=lnt id=hl-18-28><a class=lnlinks href=#hl-18-28> 28</a>
</span><span class=lnt id=hl-18-29><a class=lnlinks href=#hl-18-29> 29</a>
</span><span class=lnt id=hl-18-30><a class=lnlinks href=#hl-18-30> 30</a>
</span><span class=lnt id=hl-18-31><a class=lnlinks href=#hl-18-31> 31</a>
</span><span class=lnt id=hl-18-32><a class=lnlinks href=#hl-18-32> 32</a>
</span><span class=lnt id=hl-18-33><a class=lnlinks href=#hl-18-33> 33</a>
</span><span class=lnt id=hl-18-34><a class=lnlinks href=#hl-18-34> 34</a>
</span><span class=lnt id=hl-18-35><a class=lnlinks href=#hl-18-35> 35</a>
</span><span class=lnt id=hl-18-36><a class=lnlinks href=#hl-18-36> 36</a>
</span><span class=lnt id=hl-18-37><a class=lnlinks href=#hl-18-37> 37</a>
</span><span class=lnt id=hl-18-38><a class=lnlinks href=#hl-18-38> 38</a>
</span><span class=lnt id=hl-18-39><a class=lnlinks href=#hl-18-39> 39</a>
</span><span class=lnt id=hl-18-40><a class=lnlinks href=#hl-18-40> 40</a>
</span><span class=lnt id=hl-18-41><a class=lnlinks href=#hl-18-41> 41</a>
</span><span class=lnt id=hl-18-42><a class=lnlinks href=#hl-18-42> 42</a>
</span><span class=lnt id=hl-18-43><a class=lnlinks href=#hl-18-43> 43</a>
</span><span class=lnt id=hl-18-44><a class=lnlinks href=#hl-18-44> 44</a>
</span><span class=lnt id=hl-18-45><a class=lnlinks href=#hl-18-45> 45</a>
</span><span class=lnt id=hl-18-46><a class=lnlinks href=#hl-18-46> 46</a>
</span><span class=lnt id=hl-18-47><a class=lnlinks href=#hl-18-47> 47</a>
</span><span class=lnt id=hl-18-48><a class=lnlinks href=#hl-18-48> 48</a>
</span><span class=lnt id=hl-18-49><a class=lnlinks href=#hl-18-49> 49</a>
</span><span class=lnt id=hl-18-50><a class=lnlinks href=#hl-18-50> 50</a>
</span><span class=lnt id=hl-18-51><a class=lnlinks href=#hl-18-51> 51</a>
</span><span class=lnt id=hl-18-52><a class=lnlinks href=#hl-18-52> 52</a>
</span><span class=lnt id=hl-18-53><a class=lnlinks href=#hl-18-53> 53</a>
</span><span class=lnt id=hl-18-54><a class=lnlinks href=#hl-18-54> 54</a>
</span><span class=lnt id=hl-18-55><a class=lnlinks href=#hl-18-55> 55</a>
</span><span class=lnt id=hl-18-56><a class=lnlinks href=#hl-18-56> 56</a>
</span><span class=lnt id=hl-18-57><a class=lnlinks href=#hl-18-57> 57</a>
</span><span class=lnt id=hl-18-58><a class=lnlinks href=#hl-18-58> 58</a>
</span><span class=lnt id=hl-18-59><a class=lnlinks href=#hl-18-59> 59</a>
</span><span class=lnt id=hl-18-60><a class=lnlinks href=#hl-18-60> 60</a>
</span><span class=lnt id=hl-18-61><a class=lnlinks href=#hl-18-61> 61</a>
</span><span class=lnt id=hl-18-62><a class=lnlinks href=#hl-18-62> 62</a>
</span><span class=lnt id=hl-18-63><a class=lnlinks href=#hl-18-63> 63</a>
</span><span class=lnt id=hl-18-64><a class=lnlinks href=#hl-18-64> 64</a>
</span><span class=lnt id=hl-18-65><a class=lnlinks href=#hl-18-65> 65</a>
</span><span class=lnt id=hl-18-66><a class=lnlinks href=#hl-18-66> 66</a>
</span><span class=lnt id=hl-18-67><a class=lnlinks href=#hl-18-67> 67</a>
</span><span class=lnt id=hl-18-68><a class=lnlinks href=#hl-18-68> 68</a>
</span><span class=lnt id=hl-18-69><a class=lnlinks href=#hl-18-69> 69</a>
</span><span class=lnt id=hl-18-70><a class=lnlinks href=#hl-18-70> 70</a>
</span><span class=lnt id=hl-18-71><a class=lnlinks href=#hl-18-71> 71</a>
</span><span class=lnt id=hl-18-72><a class=lnlinks href=#hl-18-72> 72</a>
</span><span class=lnt id=hl-18-73><a class=lnlinks href=#hl-18-73> 73</a>
</span><span class=lnt id=hl-18-74><a class=lnlinks href=#hl-18-74> 74</a>
</span><span class=lnt id=hl-18-75><a class=lnlinks href=#hl-18-75> 75</a>
</span><span class=lnt id=hl-18-76><a class=lnlinks href=#hl-18-76> 76</a>
</span><span class=lnt id=hl-18-77><a class=lnlinks href=#hl-18-77> 77</a>
</span><span class=lnt id=hl-18-78><a class=lnlinks href=#hl-18-78> 78</a>
</span><span class=lnt id=hl-18-79><a class=lnlinks href=#hl-18-79> 79</a>
</span><span class=lnt id=hl-18-80><a class=lnlinks href=#hl-18-80> 80</a>
</span><span class=lnt id=hl-18-81><a class=lnlinks href=#hl-18-81> 81</a>
</span><span class=lnt id=hl-18-82><a class=lnlinks href=#hl-18-82> 82</a>
</span><span class=lnt id=hl-18-83><a class=lnlinks href=#hl-18-83> 83</a>
</span><span class=lnt id=hl-18-84><a class=lnlinks href=#hl-18-84> 84</a>
</span><span class=lnt id=hl-18-85><a class=lnlinks href=#hl-18-85> 85</a>
</span><span class=lnt id=hl-18-86><a class=lnlinks href=#hl-18-86> 86</a>
</span><span class=lnt id=hl-18-87><a class=lnlinks href=#hl-18-87> 87</a>
</span><span class=lnt id=hl-18-88><a class=lnlinks href=#hl-18-88> 88</a>
</span><span class=lnt id=hl-18-89><a class=lnlinks href=#hl-18-89> 89</a>
</span><span class=lnt id=hl-18-90><a class=lnlinks href=#hl-18-90> 90</a>
</span><span class=lnt id=hl-18-91><a class=lnlinks href=#hl-18-91> 91</a>
</span><span class=lnt id=hl-18-92><a class=lnlinks href=#hl-18-92> 92</a>
</span><span class=lnt id=hl-18-93><a class=lnlinks href=#hl-18-93> 93</a>
</span><span class=lnt id=hl-18-94><a class=lnlinks href=#hl-18-94> 94</a>
</span><span class=lnt id=hl-18-95><a class=lnlinks href=#hl-18-95> 95</a>
</span><span class=lnt id=hl-18-96><a class=lnlinks href=#hl-18-96> 96</a>
</span><span class=lnt id=hl-18-97><a class=lnlinks href=#hl-18-97> 97</a>
</span><span class=lnt id=hl-18-98><a class=lnlinks href=#hl-18-98> 98</a>
</span><span class=lnt id=hl-18-99><a class=lnlinks href=#hl-18-99> 99</a>
</span><span class=lnt id=hl-18-100><a class=lnlinks href=#hl-18-100>100</a>
</span><span class=lnt id=hl-18-101><a class=lnlinks href=#hl-18-101>101</a>
</span><span class=lnt id=hl-18-102><a class=lnlinks href=#hl-18-102>102</a>
</span><span class=lnt id=hl-18-103><a class=lnlinks href=#hl-18-103>103</a>
</span><span class=lnt id=hl-18-104><a class=lnlinks href=#hl-18-104>104</a>
</span><span class=lnt id=hl-18-105><a class=lnlinks href=#hl-18-105>105</a>
</span><span class=lnt id=hl-18-106><a class=lnlinks href=#hl-18-106>106</a>
</span><span class=lnt id=hl-18-107><a class=lnlinks href=#hl-18-107>107</a>
</span><span class=lnt id=hl-18-108><a class=lnlinks href=#hl-18-108>108</a>
</span><span class=lnt id=hl-18-109><a class=lnlinks href=#hl-18-109>109</a>
</span><span class=lnt id=hl-18-110><a class=lnlinks href=#hl-18-110>110</a>
</span><span class=lnt id=hl-18-111><a class=lnlinks href=#hl-18-111>111</a>
</span><span class=lnt id=hl-18-112><a class=lnlinks href=#hl-18-112>112</a>
</span><span class=lnt id=hl-18-113><a class=lnlinks href=#hl-18-113>113</a>
</span><span class=lnt id=hl-18-114><a class=lnlinks href=#hl-18-114>114</a>
</span><span class=lnt id=hl-18-115><a class=lnlinks href=#hl-18-115>115</a>
</span><span class=lnt id=hl-18-116><a class=lnlinks href=#hl-18-116>116</a>
</span><span class=lnt id=hl-18-117><a class=lnlinks href=#hl-18-117>117</a>
</span><span class=lnt id=hl-18-118><a class=lnlinks href=#hl-18-118>118</a>
</span><span class=lnt id=hl-18-119><a class=lnlinks href=#hl-18-119>119</a>
</span><span class=lnt id=hl-18-120><a class=lnlinks href=#hl-18-120>120</a>
</span><span class=lnt id=hl-18-121><a class=lnlinks href=#hl-18-121>121</a>
</span><span class=lnt id=hl-18-122><a class=lnlinks href=#hl-18-122>122</a>
</span><span class=lnt id=hl-18-123><a class=lnlinks href=#hl-18-123>123</a>
</span><span class=lnt id=hl-18-124><a class=lnlinks href=#hl-18-124>124</a>
</span><span class=lnt id=hl-18-125><a class=lnlinks href=#hl-18-125>125</a>
</span><span class=lnt id=hl-18-126><a class=lnlinks href=#hl-18-126>126</a>
</span><span class=lnt id=hl-18-127><a class=lnlinks href=#hl-18-127>127</a>
</span><span class=lnt id=hl-18-128><a class=lnlinks href=#hl-18-128>128</a>
</span><span class=lnt id=hl-18-129><a class=lnlinks href=#hl-18-129>129</a>
</span><span class=lnt id=hl-18-130><a class=lnlinks href=#hl-18-130>130</a>
</span><span class=lnt id=hl-18-131><a class=lnlinks href=#hl-18-131>131</a>
</span><span class=lnt id=hl-18-132><a class=lnlinks href=#hl-18-132>132</a>
</span><span class=lnt id=hl-18-133><a class=lnlinks href=#hl-18-133>133</a>
</span><span class=lnt id=hl-18-134><a class=lnlinks href=#hl-18-134>134</a>
</span><span class=lnt id=hl-18-135><a class=lnlinks href=#hl-18-135>135</a>
</span><span class=lnt id=hl-18-136><a class=lnlinks href=#hl-18-136>136</a>
</span><span class=lnt id=hl-18-137><a class=lnlinks href=#hl-18-137>137</a>
</span><span class=lnt id=hl-18-138><a class=lnlinks href=#hl-18-138>138</a>
</span><span class=lnt id=hl-18-139><a class=lnlinks href=#hl-18-139>139</a>
</span><span class=lnt id=hl-18-140><a class=lnlinks href=#hl-18-140>140</a>
</span><span class=lnt id=hl-18-141><a class=lnlinks href=#hl-18-141>141</a>
</span><span class=lnt id=hl-18-142><a class=lnlinks href=#hl-18-142>142</a>
</span><span class=lnt id=hl-18-143><a class=lnlinks href=#hl-18-143>143</a>
</span><span class=lnt id=hl-18-144><a class=lnlinks href=#hl-18-144>144</a>
</span><span class=lnt id=hl-18-145><a class=lnlinks href=#hl-18-145>145</a>
</span><span class=lnt id=hl-18-146><a class=lnlinks href=#hl-18-146>146</a>
</span><span class=lnt id=hl-18-147><a class=lnlinks href=#hl-18-147>147</a>
</span><span class=lnt id=hl-18-148><a class=lnlinks href=#hl-18-148>148</a>
</span><span class=lnt id=hl-18-149><a class=lnlinks href=#hl-18-149>149</a>
</span><span class=lnt id=hl-18-150><a class=lnlinks href=#hl-18-150>150</a>
</span><span class=lnt id=hl-18-151><a class=lnlinks href=#hl-18-151>151</a>
</span><span class=lnt id=hl-18-152><a class=lnlinks href=#hl-18-152>152</a>
</span><span class=lnt id=hl-18-153><a class=lnlinks href=#hl-18-153>153</a>
</span><span class=lnt id=hl-18-154><a class=lnlinks href=#hl-18-154>154</a>
</span><span class=lnt id=hl-18-155><a class=lnlinks href=#hl-18-155>155</a>
</span><span class=lnt id=hl-18-156><a class=lnlinks href=#hl-18-156>156</a>
</span><span class=lnt id=hl-18-157><a class=lnlinks href=#hl-18-157>157</a>
</span><span class=lnt id=hl-18-158><a class=lnlinks href=#hl-18-158>158</a>
</span><span class=lnt id=hl-18-159><a class=lnlinks href=#hl-18-159>159</a>
</span><span class=lnt id=hl-18-160><a class=lnlinks href=#hl-18-160>160</a>
</span><span class=lnt id=hl-18-161><a class=lnlinks href=#hl-18-161>161</a>
</span><span class=lnt id=hl-18-162><a class=lnlinks href=#hl-18-162>162</a>
</span><span class=lnt id=hl-18-163><a class=lnlinks href=#hl-18-163>163</a>
</span><span class=lnt id=hl-18-164><a class=lnlinks href=#hl-18-164>164</a>
</span><span class=lnt id=hl-18-165><a class=lnlinks href=#hl-18-165>165</a>
</span><span class=lnt id=hl-18-166><a class=lnlinks href=#hl-18-166>166</a>
</span><span class=lnt id=hl-18-167><a class=lnlinks href=#hl-18-167>167</a>
</span><span class=lnt id=hl-18-168><a class=lnlinks href=#hl-18-168>168</a>
</span><span class=lnt id=hl-18-169><a class=lnlinks href=#hl-18-169>169</a>
</span><span class=lnt id=hl-18-170><a class=lnlinks href=#hl-18-170>170</a>
</span><span class=lnt id=hl-18-171><a class=lnlinks href=#hl-18-171>171</a>
</span><span class=lnt id=hl-18-172><a class=lnlinks href=#hl-18-172>172</a>
</span><span class=lnt id=hl-18-173><a class=lnlinks href=#hl-18-173>173</a>
</span><span class=lnt id=hl-18-174><a class=lnlinks href=#hl-18-174>174</a>
</span><span class=lnt id=hl-18-175><a class=lnlinks href=#hl-18-175>175</a>
</span><span class=lnt id=hl-18-176><a class=lnlinks href=#hl-18-176>176</a>
</span><span class=lnt id=hl-18-177><a class=lnlinks href=#hl-18-177>177</a>
</span><span class=lnt id=hl-18-178><a class=lnlinks href=#hl-18-178>178</a>
</span><span class=lnt id=hl-18-179><a class=lnlinks href=#hl-18-179>179</a>
</span><span class=lnt id=hl-18-180><a class=lnlinks href=#hl-18-180>180</a>
</span><span class=lnt id=hl-18-181><a class=lnlinks href=#hl-18-181>181</a>
</span><span class=lnt id=hl-18-182><a class=lnlinks href=#hl-18-182>182</a>
</span><span class=lnt id=hl-18-183><a class=lnlinks href=#hl-18-183>183</a>
</span><span class=lnt id=hl-18-184><a class=lnlinks href=#hl-18-184>184</a>
</span><span class=lnt id=hl-18-185><a class=lnlinks href=#hl-18-185>185</a>
</span><span class=lnt id=hl-18-186><a class=lnlinks href=#hl-18-186>186</a>
</span><span class=lnt id=hl-18-187><a class=lnlinks href=#hl-18-187>187</a>
</span><span class=lnt id=hl-18-188><a class=lnlinks href=#hl-18-188>188</a>
</span><span class=lnt id=hl-18-189><a class=lnlinks href=#hl-18-189>189</a>
</span><span class=lnt id=hl-18-190><a class=lnlinks href=#hl-18-190>190</a>
</span><span class=lnt id=hl-18-191><a class=lnlinks href=#hl-18-191>191</a>
</span><span class=lnt id=hl-18-192><a class=lnlinks href=#hl-18-192>192</a>
</span><span class=lnt id=hl-18-193><a class=lnlinks href=#hl-18-193>193</a>
</span><span class=lnt id=hl-18-194><a class=lnlinks href=#hl-18-194>194</a>
</span><span class=lnt id=hl-18-195><a class=lnlinks href=#hl-18-195>195</a>
</span><span class=lnt id=hl-18-196><a class=lnlinks href=#hl-18-196>196</a>
</span><span class=lnt id=hl-18-197><a class=lnlinks href=#hl-18-197>197</a>
</span><span class=lnt id=hl-18-198><a class=lnlinks href=#hl-18-198>198</a>
</span><span class=lnt id=hl-18-199><a class=lnlinks href=#hl-18-199>199</a>
</span><span class=lnt id=hl-18-200><a class=lnlinks href=#hl-18-200>200</a>
</span><span class=lnt id=hl-18-201><a class=lnlinks href=#hl-18-201>201</a>
</span><span class=lnt id=hl-18-202><a class=lnlinks href=#hl-18-202>202</a>
</span><span class=lnt id=hl-18-203><a class=lnlinks href=#hl-18-203>203</a>
</span><span class=lnt id=hl-18-204><a class=lnlinks href=#hl-18-204>204</a>
</span><span class=lnt id=hl-18-205><a class=lnlinks href=#hl-18-205>205</a>
</span><span class=lnt id=hl-18-206><a class=lnlinks href=#hl-18-206>206</a>
</span><span class=lnt id=hl-18-207><a class=lnlinks href=#hl-18-207>207</a>
</span><span class=lnt id=hl-18-208><a class=lnlinks href=#hl-18-208>208</a>
</span><span class=lnt id=hl-18-209><a class=lnlinks href=#hl-18-209>209</a>
</span><span class=lnt id=hl-18-210><a class=lnlinks href=#hl-18-210>210</a>
</span><span class=lnt id=hl-18-211><a class=lnlinks href=#hl-18-211>211</a>
</span><span class=lnt id=hl-18-212><a class=lnlinks href=#hl-18-212>212</a>
</span><span class=lnt id=hl-18-213><a class=lnlinks href=#hl-18-213>213</a>
</span><span class=lnt id=hl-18-214><a class=lnlinks href=#hl-18-214>214</a>
</span><span class=lnt id=hl-18-215><a class=lnlinks href=#hl-18-215>215</a>
</span><span class=lnt id=hl-18-216><a class=lnlinks href=#hl-18-216>216</a>
</span><span class=lnt id=hl-18-217><a class=lnlinks href=#hl-18-217>217</a>
</span><span class=lnt id=hl-18-218><a class=lnlinks href=#hl-18-218>218</a>
</span><span class=lnt id=hl-18-219><a class=lnlinks href=#hl-18-219>219</a>
</span><span class=lnt id=hl-18-220><a class=lnlinks href=#hl-18-220>220</a>
</span><span class=lnt id=hl-18-221><a class=lnlinks href=#hl-18-221>221</a>
</span><span class=lnt id=hl-18-222><a class=lnlinks href=#hl-18-222>222</a>
</span><span class=lnt id=hl-18-223><a class=lnlinks href=#hl-18-223>223</a>
</span><span class=lnt id=hl-18-224><a class=lnlinks href=#hl-18-224>224</a>
</span><span class=lnt id=hl-18-225><a class=lnlinks href=#hl-18-225>225</a>
</span><span class=lnt id=hl-18-226><a class=lnlinks href=#hl-18-226>226</a>
</span><span class=lnt id=hl-18-227><a class=lnlinks href=#hl-18-227>227</a>
</span><span class=lnt id=hl-18-228><a class=lnlinks href=#hl-18-228>228</a>
</span><span class=lnt id=hl-18-229><a class=lnlinks href=#hl-18-229>229</a>
</span><span class=lnt id=hl-18-230><a class=lnlinks href=#hl-18-230>230</a>
</span><span class=lnt id=hl-18-231><a class=lnlinks href=#hl-18-231>231</a>
</span><span class=lnt id=hl-18-232><a class=lnlinks href=#hl-18-232>232</a>
</span><span class=lnt id=hl-18-233><a class=lnlinks href=#hl-18-233>233</a>
</span><span class=lnt id=hl-18-234><a class=lnlinks href=#hl-18-234>234</a>
</span><span class=lnt id=hl-18-235><a class=lnlinks href=#hl-18-235>235</a>
</span><span class=lnt id=hl-18-236><a class=lnlinks href=#hl-18-236>236</a>
</span><span class=lnt id=hl-18-237><a class=lnlinks href=#hl-18-237>237</a>
</span><span class=lnt id=hl-18-238><a class=lnlinks href=#hl-18-238>238</a>
</span><span class=lnt id=hl-18-239><a class=lnlinks href=#hl-18-239>239</a>
</span><span class=lnt id=hl-18-240><a class=lnlinks href=#hl-18-240>240</a>
</span><span class=lnt id=hl-18-241><a class=lnlinks href=#hl-18-241>241</a>
</span><span class=lnt id=hl-18-242><a class=lnlinks href=#hl-18-242>242</a>
</span><span class=lnt id=hl-18-243><a class=lnlinks href=#hl-18-243>243</a>
</span><span class=lnt id=hl-18-244><a class=lnlinks href=#hl-18-244>244</a>
</span><span class=lnt id=hl-18-245><a class=lnlinks href=#hl-18-245>245</a>
</span><span class=lnt id=hl-18-246><a class=lnlinks href=#hl-18-246>246</a>
</span><span class=lnt id=hl-18-247><a class=lnlinks href=#hl-18-247>247</a>
</span><span class=lnt id=hl-18-248><a class=lnlinks href=#hl-18-248>248</a>
</span><span class=lnt id=hl-18-249><a class=lnlinks href=#hl-18-249>249</a>
</span><span class=lnt id=hl-18-250><a class=lnlinks href=#hl-18-250>250</a>
</span><span class=lnt id=hl-18-251><a class=lnlinks href=#hl-18-251>251</a>
</span><span class=lnt id=hl-18-252><a class=lnlinks href=#hl-18-252>252</a>
</span><span class=lnt id=hl-18-253><a class=lnlinks href=#hl-18-253>253</a>
</span><span class=lnt id=hl-18-254><a class=lnlinks href=#hl-18-254>254</a>
</span><span class=lnt id=hl-18-255><a class=lnlinks href=#hl-18-255>255</a>
</span><span class=lnt id=hl-18-256><a class=lnlinks href=#hl-18-256>256</a>
</span><span class=lnt id=hl-18-257><a class=lnlinks href=#hl-18-257>257</a>
</span><span class=lnt id=hl-18-258><a class=lnlinks href=#hl-18-258>258</a>
</span><span class=lnt id=hl-18-259><a class=lnlinks href=#hl-18-259>259</a>
</span><span class=lnt id=hl-18-260><a class=lnlinks href=#hl-18-260>260</a>
</span><span class=lnt id=hl-18-261><a class=lnlinks href=#hl-18-261>261</a>
</span><span class=lnt id=hl-18-262><a class=lnlinks href=#hl-18-262>262</a>
</span><span class=lnt id=hl-18-263><a class=lnlinks href=#hl-18-263>263</a>
</span><span class=lnt id=hl-18-264><a class=lnlinks href=#hl-18-264>264</a>
</span><span class=lnt id=hl-18-265><a class=lnlinks href=#hl-18-265>265</a>
</span><span class=lnt id=hl-18-266><a class=lnlinks href=#hl-18-266>266</a>
</span><span class=lnt id=hl-18-267><a class=lnlinks href=#hl-18-267>267</a>
</span><span class=lnt id=hl-18-268><a class=lnlinks href=#hl-18-268>268</a>
</span><span class=lnt id=hl-18-269><a class=lnlinks href=#hl-18-269>269</a>
</span><span class=lnt id=hl-18-270><a class=lnlinks href=#hl-18-270>270</a>
</span><span class=lnt id=hl-18-271><a class=lnlinks href=#hl-18-271>271</a>
</span><span class=lnt id=hl-18-272><a class=lnlinks href=#hl-18-272>272</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pika</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>Any</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderProcessor</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;주문 처리 시스템의 RabbitMQ 구현&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>rabbitmq_url</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;amqp://localhost&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        RabbitMQ 연결 초기화
</span></span></span><span class=line><span class=cl><span class=s2>        Args:
</span></span></span><span class=line><span class=cl><span class=s2>            rabbitmq_url: RabbitMQ 서버 URL
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>connection</span> <span class=o>=</span> <span class=n>pika</span><span class=o>.</span><span class=n>BlockingConnection</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>pika</span><span class=o>.</span><span class=n>URLParameters</span><span class=p>(</span><span class=n>rabbitmq_url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>connection</span><span class=o>.</span><span class=n>channel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_setup_exchanges_and_queues</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_setup_exchanges_and_queues</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Exchange와 Queue 설정&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 주문 Exchange 선언 (Topic 타입으로 유연한 라우팅)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>exchange_declare</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;order_events&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>exchange_type</span><span class=o>=</span><span class=s1>&#39;topic&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>durable</span><span class=o>=</span><span class=kc>True</span>  <span class=c1># 브로커 재시작 시에도 유지</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 결제 결과 Exchange 선언</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>exchange_declare</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;payment_results&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>exchange_type</span><span class=o>=</span><span class=s1>&#39;direct&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>durable</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 각 서비스별 Queue 선언</span>
</span></span><span class=line><span class=cl>        <span class=n>queues</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;inventory_check&#39;</span><span class=p>,</span>    <span class=c1># 재고 확인</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;payment_processing&#39;</span><span class=p>,</span> <span class=c1># 결제 처리</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;shipping_preparation&#39;</span><span class=p>,</span> <span class=c1># 배송 준비</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;notification_service&#39;</span>  <span class=c1># 알림 전송</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>queue_name</span> <span class=ow>in</span> <span class=n>queues</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>queue_declare</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>queue</span><span class=o>=</span><span class=n>queue_name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>durable</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>  <span class=c1># 메시지 영속성</span>
</span></span><span class=line><span class=cl>                <span class=n>arguments</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;x-max-priority&#39;</span><span class=p>:</span> <span class=mi>10</span><span class=p>}</span>  <span class=c1># 우선순위 큐</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 바인딩 설정</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>queue_bind</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;order_events&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;inventory_check&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;order.created&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>queue_bind</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;order_events&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;payment_processing&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;order.created&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>queue_bind</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;payment_results&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;shipping_preparation&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;payment.success&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>publish_order_created</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_data</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        새 주문 생성 이벤트 발행
</span></span></span><span class=line><span class=cl><span class=s2>        Args:
</span></span></span><span class=line><span class=cl><span class=s2>            order_data: 주문 데이터 (주문ID, 고객정보, 상품정보 등)
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>message</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;event_type&#39;</span><span class=p>:</span> <span class=s1>&#39;order_created&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=n>order_data</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=n>order_data</span><span class=p>[</span><span class=s1>&#39;customer_id&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;items&#39;</span><span class=p>:</span> <span class=n>order_data</span><span class=p>[</span><span class=s1>&#39;items&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;total_amount&#39;</span><span class=p>:</span> <span class=n>order_data</span><span class=p>[</span><span class=s1>&#39;total_amount&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 메시지 발행 (Topic Exchange 사용)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>basic_publish</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;order_events&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;order.created&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>body</span><span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>message</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>properties</span><span class=o>=</span><span class=n>pika</span><span class=o>.</span><span class=n>BasicProperties</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>delivery_mode</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span>  <span class=c1># 메시지 영속성</span>
</span></span><span class=line><span class=cl>                <span class=n>priority</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span>       <span class=c1># 우선순위 설정</span>
</span></span><span class=line><span class=cl>                <span class=n>headers</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;source&#39;</span><span class=p>:</span> <span class=s1>&#39;order_service&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;주문 생성 이벤트 발행: </span><span class=si>{</span><span class=n>order_data</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_inventory_check</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>callback_func</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        재고 확인 처리
</span></span></span><span class=line><span class=cl><span class=s2>        Args:
</span></span></span><span class=line><span class=cl><span class=s2>            callback_func: 재고 확인 로직을 처리하는 콜백 함수
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>wrapper</span><span class=p>(</span><span class=n>ch</span><span class=p>,</span> <span class=n>method</span><span class=p>,</span> <span class=n>properties</span><span class=p>,</span> <span class=n>body</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># 메시지 파싱</span>
</span></span><span class=line><span class=cl>                <span class=n>message</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>order_id</span> <span class=o>=</span> <span class=n>message</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;재고 확인 처리 시작: </span><span class=si>{</span><span class=n>order_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 실제 재고 확인 로직 실행</span>
</span></span><span class=line><span class=cl>                <span class=n>inventory_result</span> <span class=o>=</span> <span class=n>callback_func</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>inventory_result</span><span class=p>[</span><span class=s1>&#39;success&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=c1># 재고 확인 성공 시 다음 단계 진행</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>_publish_inventory_confirmed</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=c1># 재고 부족 시 주문 취소 처리</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>_publish_order_cancelled</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=s1>&#39;재고 부족&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 메시지 처리 완료 확인</span>
</span></span><span class=line><span class=cl>                <span class=n>ch</span><span class=o>.</span><span class=n>basic_ack</span><span class=p>(</span><span class=n>delivery_tag</span><span class=o>=</span><span class=n>method</span><span class=o>.</span><span class=n>delivery_tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;재고 확인 처리 중 오류: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=c1># 처리 실패 시 재시도를 위해 NACK</span>
</span></span><span class=line><span class=cl>                <span class=n>ch</span><span class=o>.</span><span class=n>basic_nack</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>delivery_tag</span><span class=o>=</span><span class=n>method</span><span class=o>.</span><span class=n>delivery_tag</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>requeue</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 컨슈머 설정</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>basic_qos</span><span class=p>(</span><span class=n>prefetch_count</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># 한 번에 하나씩 처리</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>basic_consume</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;inventory_check&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>on_message_callback</span><span class=o>=</span><span class=n>wrapper</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;재고 확인 서비스 시작...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>start_consuming</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_payment</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>callback_func</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>        결제 처리
</span></span></span><span class=line><span class=cl><span class=s2>        Args:
</span></span></span><span class=line><span class=cl><span class=s2>            callback_func: 결제 로직을 처리하는 콜백 함수
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>wrapper</span><span class=p>(</span><span class=n>ch</span><span class=p>,</span> <span class=n>method</span><span class=p>,</span> <span class=n>properties</span><span class=p>,</span> <span class=n>body</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>message</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>order_id</span> <span class=o>=</span> <span class=n>message</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;결제 처리 시작: </span><span class=si>{</span><span class=n>order_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=c1># 실제 결제 처리 로직 실행</span>
</span></span><span class=line><span class=cl>                <span class=n>payment_result</span> <span class=o>=</span> <span class=n>callback_func</span><span class=p>(</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>payment_result</span><span class=p>[</span><span class=s1>&#39;success&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>                    <span class=c1># 결제 성공 시 배송 준비 메시지 발행</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>basic_publish</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                        <span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;payment_results&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;payment.success&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=n>body</span><span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                            <span class=o>**</span><span class=n>message</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                            <span class=s1>&#39;payment_id&#39;</span><span class=p>:</span> <span class=n>payment_result</span><span class=p>[</span><span class=s1>&#39;payment_id&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                            <span class=s1>&#39;payment_method&#39;</span><span class=p>:</span> <span class=n>payment_result</span><span class=p>[</span><span class=s1>&#39;payment_method&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                        <span class=p>}),</span>
</span></span><span class=line><span class=cl>                        <span class=n>properties</span><span class=o>=</span><span class=n>pika</span><span class=o>.</span><span class=n>BasicProperties</span><span class=p>(</span><span class=n>delivery_mode</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=c1># 결제 실패 시 주문 취소</span>
</span></span><span class=line><span class=cl>                    <span class=bp>self</span><span class=o>.</span><span class=n>_publish_order_cancelled</span><span class=p>(</span><span class=n>message</span><span class=p>,</span> <span class=s1>&#39;결제 실패&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=n>ch</span><span class=o>.</span><span class=n>basic_ack</span><span class=p>(</span><span class=n>delivery_tag</span><span class=o>=</span><span class=n>method</span><span class=o>.</span><span class=n>delivery_tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>            <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;결제 처리 중 오류: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>ch</span><span class=o>.</span><span class=n>basic_nack</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>delivery_tag</span><span class=o>=</span><span class=n>method</span><span class=o>.</span><span class=n>delivery_tag</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>requeue</span><span class=o>=</span><span class=kc>True</span>
</span></span><span class=line><span class=cl>                <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>basic_qos</span><span class=p>(</span><span class=n>prefetch_count</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>basic_consume</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;payment_processing&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>on_message_callback</span><span class=o>=</span><span class=n>wrapper</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;결제 처리 서비스 시작...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>start_consuming</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_publish_inventory_confirmed</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_message</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;재고 확인 완료 이벤트 발행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>basic_publish</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;order_events&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;order.inventory_confirmed&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>body</span><span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>order_message</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>properties</span><span class=o>=</span><span class=n>pika</span><span class=o>.</span><span class=n>BasicProperties</span><span class=p>(</span><span class=n>delivery_mode</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_publish_order_cancelled</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_message</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>],</span> <span class=n>reason</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;주문 취소 이벤트 발행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>cancel_message</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=o>**</span><span class=n>order_message</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;cancellation_reason&#39;</span><span class=p>:</span> <span class=n>reason</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;cancelled_at&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>channel</span><span class=o>.</span><span class=n>basic_publish</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;order_events&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;order.cancelled&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>body</span><span class=o>=</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>cancel_message</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=n>properties</span><span class=o>=</span><span class=n>pika</span><span class=o>.</span><span class=n>BasicProperties</span><span class=p>(</span><span class=n>delivery_mode</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>close_connection</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;연결 종료&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>connection</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 주문 처리 시스템 초기화</span>
</span></span><span class=line><span class=cl>    <span class=n>processor</span> <span class=o>=</span> <span class=n>OrderProcessor</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 새 주문 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>order_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;order_id&#39;</span><span class=p>:</span> <span class=s1>&#39;ORD-2024-001&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;customer_id&#39;</span><span class=p>:</span> <span class=s1>&#39;CUST-12345&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;items&#39;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s1>&#39;product_id&#39;</span><span class=p>:</span> <span class=s1>&#39;PROD-001&#39;</span><span class=p>,</span> <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=mf>29.99</span><span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span><span class=s1>&#39;product_id&#39;</span><span class=p>:</span> <span class=s1>&#39;PROD-002&#39;</span><span class=p>,</span> <span class=s1>&#39;quantity&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=mf>19.99</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;total_amount&#39;</span><span class=p>:</span> <span class=mf>79.97</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 주문 생성 이벤트 발행</span>
</span></span><span class=line><span class=cl>    <span class=n>processor</span><span class=o>.</span><span class=n>publish_order_created</span><span class=p>(</span><span class=n>order_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 재고 확인 로직 정의</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>check_inventory</span><span class=p>(</span><span class=n>message</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 실제 재고 확인 로직 구현</span>
</span></span><span class=line><span class=cl>        <span class=n>order_id</span> <span class=o>=</span> <span class=n>message</span><span class=p>[</span><span class=s1>&#39;order_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>items</span> <span class=o>=</span> <span class=n>message</span><span class=p>[</span><span class=s1>&#39;items&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 간단한 재고 확인 시뮬레이션</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>items</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>item</span><span class=p>[</span><span class=s1>&#39;quantity&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>:</span>  <span class=c1># 재고 부족 시뮬레이션</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;success&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=s1>&#39;reason&#39;</span><span class=p>:</span> <span class=s1>&#39;재고 부족&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;success&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s1>&#39;inventory_reserved&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 결제 처리 로직 정의</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_payment_logic</span><span class=p>(</span><span class=n>message</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 실제 결제 처리 로직 구현</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;success&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;payment_id&#39;</span><span class=p>:</span> <span class=s1>&#39;PAY-2024-001&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;payment_method&#39;</span><span class=p>:</span> <span class=s1>&#39;credit_card&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 서비스 시작 (실제 환경에서는 별도 프로세스로 실행)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># processor.process_inventory_check(check_inventory)</span>
</span></span><span class=line><span class=cl>        <span class=c1># processor.process_payment(process_payment_logic)</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>KeyboardInterrupt</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;서비스 종료...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>processor</span><span class=o>.</span><span class=n>close_connection</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h2><table><thead><tr><th>구분</th><th>항목</th><th>고려사항</th><th>권장사항</th></tr></thead><tbody><tr><td>설계</td><td>메시지 구조</td><td>확장 가능하고 하위 호환성 있는 스키마</td><td>JSON Schema 사용, 버전 관리</td></tr><tr><td></td><td>큐 네이밍</td><td>일관된 명명 규칙</td><td>서비스명.작업명 형태 사용</td></tr><tr><td></td><td>Exchange 선택</td><td>적절한 Exchange 타입 선택</td><td>라우팅 복잡도에 따른 타입 결정</td></tr><tr><td>운영</td><td>모니터링</td><td>큐 길이, 처리량, 오류율 추적</td><td>Prometheus, Grafana 연동</td></tr><tr><td></td><td>백업</td><td>중요한 메시지 백업 전략</td><td>정기적인 큐 내용 백업</td></tr><tr><td></td><td>보안</td><td>접근 제어 및 데이터 암호화</td><td>TLS 사용, 사용자 권한 관리</td></tr><tr><td>성능</td><td>배치 처리</td><td>메시지 배치 처리로 성능 향상</td><td>적절한 배치 크기 설정</td></tr><tr><td></td><td>프리페치</td><td>컨슈머 프리페치 설정 최적화</td><td>처리 시간에 따른 조정</td></tr><tr><td></td><td>클러스터링</td><td>고가용성을 위한 클러스터 구성</td><td>최소 3개 노드 구성</td></tr></tbody></table><h2 id=최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점>#</a></h2><table><thead><tr><th>구분</th><th>항목</th><th>고려사항</th><th>권장사항</th></tr></thead><tbody><tr><td>메모리</td><td>메시지 TTL</td><td>메시지 생존 시간 설정</td><td>비즈니스 요구사항에 따른 TTL 설정</td></tr><tr><td></td><td>큐 길이 제한</td><td>큐 최대 길이 설정</td><td>x-max-length 속성 사용</td></tr><tr><td></td><td>메시지 크기</td><td>큐 최대 메시지 크기 제한</td><td>큰 데이터는 외부 저장소 활용</td></tr><tr><td>네트워크</td><td>연결 풀링</td><td>연결 재사용으로 오버헤드 감소</td><td>연결 풀 라이브러리 사용</td></tr><tr><td></td><td>배치 확인</td><td>메시지 배치 확인으로 성능 향상</td><td>basic_ack 배치 처리</td></tr><tr><td></td><td>압축</td><td>메시지 압축으로 네트워크 사용량 감소</td><td>gzip 압축 적용</td></tr><tr><td>디스크</td><td>영속성 선택</td><td>필요한 메시지만 영속성 적용</td><td>중요도에 따른 선택적 적용</td></tr><tr><td></td><td>로그 로테이션</td><td>로그 파일 크기 관리</td><td>자동 로그 로테이션 설정</td></tr><tr><td></td><td>SSD 사용</td><td>빠른 디스크 I/O를 위한 SSD 사용</td><td>고성능 스토리지 사용</td></tr></tbody></table><h2 id=주제와-관련하여-주목할-내용>주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#주제와-관련하여-주목할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>아키텍처</td><td>메시지 패턴</td><td>Saga 패턴</td><td>분산 트랜잭션 관리를 위한 패턴</td></tr><tr><td></td><td>이벤트 소싱</td><td>Event Sourcing</td><td>상태 변경을 이벤트로 저장하는 패턴</td></tr><tr><td></td><td>CQRS</td><td>Command Query Responsibility Segregation</td><td>명령과 조회 책임 분리</td></tr><tr><td>기술</td><td>프로토콜</td><td>AMQP 1.0</td><td>차세대 AMQP 프로토콜</td></tr><tr><td></td><td>스트리밍</td><td>RabbitMQ Streams</td><td>로그 기반 스트리밍 큐</td></tr><tr><td></td><td>페더레이션</td><td>Multi-DC 설정</td><td>다중 데이터센터 연동</td></tr><tr><td>운영</td><td>모니터링</td><td>분산 추적</td><td>메시지 플로우 추적</td></tr><tr><td></td><td>보안</td><td>OAuth2 통합</td><td>현대적인 인증 방식</td></tr><tr><td></td><td>백업</td><td>재해 복구</td><td>비즈니스 연속성 보장</td></tr><tr><td>성능</td><td>최적화</td><td>메시지 압축</td><td>네트워크 대역폭 절약</td></tr><tr><td></td><td>확장성</td><td>자동 스케일링</td><td>부하에 따른 자동 확장</td></tr><tr><td></td><td>캐싱</td><td>메시지 캐싱</td><td>자주 사용되는 메시지 캐싱</td></tr></tbody></table><h2 id=반드시-학습해야할-내용>반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>기초</td><td>AMQP 프로토콜</td><td>메시지 프로토콜</td><td>메시지 큐잉 표준 프로토콜</td></tr><tr><td></td><td>메시지 브로커</td><td>중개자 패턴</td><td>시스템 간 메시지 중개 역할</td></tr><tr><td></td><td>비동기 통신</td><td>비동기 처리</td><td>동기 vs 비동기 통신 차이점</td></tr><tr><td>아키텍처</td><td>Exchange 타입</td><td>라우팅 방식</td><td>Direct, Topic, Fanout, Headers</td></tr><tr><td></td><td>큐 관리</td><td>메시지 저장소</td><td>큐 생성, 관리, 삭제</td></tr><tr><td></td><td>바인딩</td><td>연결 관계</td><td>Exchange와 Queue 연결</td></tr><tr><td>고급</td><td>클러스터링</td><td>고가용성</td><td>다중 노드 클러스터 구성</td></tr><tr><td></td><td>페더레이션</td><td>분산 환경</td><td>지리적 분산 브로커 연결</td></tr><tr><td></td><td>미러링</td><td>복제</td><td>큐 미러링을 통한 데이터 복제</td></tr><tr><td>운영</td><td>모니터링</td><td>상태 추적</td><td>성능 메트릭 수집 및 분석</td></tr><tr><td></td><td>보안</td><td>접근 제어</td><td>사용자 인증 및 권한 관리</td></tr><tr><td></td><td>백업</td><td>데이터 보호</td><td>메시지 및 설정 백업</td></tr><tr><td>개발</td><td>클라이언트 라이브러리</td><td>프로그래밍</td><td>다양한 언어별 클라이언트</td></tr><tr><td></td><td>메시지 직렬화</td><td>데이터 변환</td><td>JSON, MessagePack, Protobuf</td></tr><tr><td></td><td>오류 처리</td><td>예외 상황</td><td>재시도, 데드 레터 큐</td></tr></tbody></table><hr><h2 id=용어-정리-2>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-2>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>프로토콜</td><td>AMQP (Advanced Message Queuing Protocol)</td><td>메시지 지향 미들웨어를 위한 오픈 표준 프로토콜</td></tr><tr><td></td><td>MQTT (Message Queuing Telemetry Transport)</td><td>경량 메시징 프로토콜, IoT 환경에 적합</td></tr><tr><td></td><td>STOMP (Simple Text Oriented Messaging Protocol)</td><td>단순 텍스트 기반 메시징 프로토콜</td></tr><tr><td>구성 요소</td><td>Vhost (Virtual Host)</td><td>논리적인 브로커 분리 단위</td></tr><tr><td></td><td>TTL (Time To Live)</td><td>메시지 생존 시간</td></tr><tr><td></td><td>DLX (Dead Letter Exchange)</td><td>처리 실패 메시지 전달 Exchange</td></tr><tr><td></td><td>DLQ (Dead Letter Queue)</td><td>처리 실패 메시지 저장 큐</td></tr><tr><td>운영</td><td>HA (High Availability)</td><td>고가용성</td></tr><tr><td></td><td>QoS (Quality of Service)</td><td>서비스 품질</td></tr><tr><td></td><td>Prefetch</td><td>미리 가져올 메시지 개수</td></tr><tr><td></td><td>Acknowledgment</td><td>메시지 수신 확인</td></tr><tr><td>패턴</td><td>Publisher/Subscriber</td><td>발행자/구독자 패턴</td></tr><tr><td></td><td>Request/Reply</td><td>요청/응답 패턴</td></tr><tr><td></td><td>Work Queue</td><td>작업 큐 패턴</td></tr><tr><td></td><td>RPC (Remote Procedure Call)</td><td>원격 프로시저 호출</td></tr></tbody></table><hr><h2 id=참고-및-출처-2>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-2>#</a></h2><ul><li><a href=https://www.rabbitmq.com/documentation.html>RabbitMQ 공식 문서</a></li><li><a href=https://www.rabbitmq.com/tutorials/amqp-concepts.html>AMQP 0-9-1 모델 설명</a></li><li><a href=https://www.rabbitmq.com/getstarted.html>RabbitMQ 튜토리얼</a></li><li><a href=https://www.rabbitmq.com/clustering.html>RabbitMQ 클러스터링 가이드</a></li><li><a href=https://www.rabbitmq.com/production-checklist.html>RabbitMQ 성능 최적화</a></li><li><a href=https://www.rabbitmq.com/monitoring.html>RabbitMQ 모니터링</a></li><li><a href=https://www.erlang.org/doc/>Erlang OTP 문서</a></li><li><a href=https://www.enterpriseintegrationpatterns.com/patterns/messaging/>메시지 큐잉 패턴</a></li></ul><hr><p>RabbitMQ는 Erlang 언어로 작성된 오픈 소스 메시지 브로커 시스템으로, AMQP(Advanced Message Queuing Protocol)를 구현하고 있다. 2007년에 처음 출시되었으며, 현재는 VMware의 자회사인 Pivotal Software에서 관리하고 있다. RabbitMQ는 안정성, 확장성, 다양한 메시징 패턴 지원 등으로 인해 많은 기업들이 메시지 기반 아키텍처의 핵심 컴포넌트로 채택하고 있다.</p><h3 id=주요-특징>주요 특징<a hidden class=anchor aria-hidden=true href=#주요-특징>#</a></h3><ul><li><strong>표준 프로토콜 지원</strong>: AMQP 0-9-1을 기본으로 하며, STOMP, MQTT, HTTP 등 다양한 프로토콜을 플러그인을 통해 지원한다.</li><li><strong>유연한 라우팅</strong>: Exchange와 바인딩을 통한 강력하고 유연한 메시지 라우팅 기능을 제공한다.</li><li><strong>클러스터링</strong>: 높은 가용성과 처리량을 위한 내장 클러스터링 기능을 제공한다.</li><li><strong>관리 인터페이스</strong>: 직관적인 웹 기반 관리 UI와 HTTP API를 제공한다.</li><li><strong>플러그인 아키텍처</strong>: 기능을 확장할 수 있는 다양한 플러그인을 지원한다.</li><li><strong>다양한 언어 지원</strong>: Java, Python, Ruby, PHP, C#, JavaScript 등 다양한 언어의 클라이언트 라이브러리를 제공한다.</li></ul><h3 id=rabbitmq의-주요-사용-사례>RabbitMQ의 주요 사용 사례<a hidden class=anchor aria-hidden=true href=#rabbitmq의-주요-사용-사례>#</a></h3><ul><li><strong>비동기 처리</strong>: 시간이 오래 걸리는 작업을 비동기적으로 처리할 수 있다.</li><li><strong>서비스 간 통신</strong>: 마이크로서비스 아키텍처에서 서비스 간 통신 채널로 활용된다.</li><li><strong>부하 분산</strong>: 작업을 여러 워커에게 분산시켜 시스템의 부하를 균등하게 분배한다.</li><li><strong>이벤트 기반 아키텍처</strong>: 이벤트를 생성하고 소비하는 이벤트 기반 시스템의 기반이 된다.</li><li><strong>데이터 스트리밍</strong>: 실시간 데이터 스트림을 처리하는 데 사용된다.</li></ul><h3 id=rabbitmq의-핵심-개념>RabbitMQ의 핵심 개념<a hidden class=anchor aria-hidden=true href=#rabbitmq의-핵심-개념>#</a></h3><ol><li><p>AMQP 프로토콜<br>AMQP(Advanced Message Queuing Protocol)는 메시지 지향 미들웨어를 위한 개방형 표준 프로토콜이다. AMQP의 주요 개념을 이해하는 것은 RabbitMQ를 효과적으로 사용하기 위한 기본이다.</p></li><li><p>RabbitMQ 아키텍처<br>RabbitMQ의 아키텍처는 다음 구성 요소로 이루어져 있다:</p><ol><li>프로듀서(Producer)<br>메시지를 생성하여 RabbitMQ로 전송하는 애플리케이션이다. 프로듀서는 메시지를 생성하고 Exchange에 발행한다.</li><li>컨슈머(Consumer)<br>RabbitMQ로부터 메시지를 수신하고 처리하는 애플리케이션이다. 컨슈머는 큐에서 메시지를 구독하여 처리한다.</li><li>Exchange<br>프로듀서로부터 받은 메시지를 큐로 라우팅하는 라우터 역할을 한다. Exchange 타입에 따라 메시지 라우팅 방식이 달라진다.<br>Exchange 타입:</li></ol><ul><li><strong>Direct Exchange</strong>: 라우팅 키가 정확히 일치하는 큐에 메시지를 전달한다.</li><li><strong>Fanout Exchange</strong>: 바인딩된 모든 큐에 메시지를 브로드캐스트한다.</li><li><strong>Topic Exchange</strong>: 라우팅 키 패턴이 일치하는 큐에 메시지를 전달한다.</li><li><strong>Headers Exchange</strong>: 메시지 헤더 속성을 기반으로 라우팅한다.</li></ul><ol start=4><li>큐(Queue)<br>메시지가 저장되는 버퍼이다. 컨슈머는 큐에서 메시지를 가져와 처리한다. 큐는 FIFO(First In, First Out) 방식으로 작동한다.</li><li>바인딩(Binding)<br>Exchange와 큐 사이의 관계를 정의한다. 바인딩은 라우팅 키(Routing Key)를 사용하여 Exchange가 메시지를 어떤 큐로 전달할지 결정하는 규칙을 설정한다.</li><li>가상 호스트(Virtual Host)<br>리소스(Exchange, 큐 등)를 논리적으로 그룹화하는 네임스페이스이다. 가상 호스트는 자체 사용자 권한을 가지며, 서로 다른 애플리케이션이 같은 RabbitMQ 서버를 공유할 수 있게 한다.</li></ol></li><li><p>메시징 패턴<br>RabbitMQ에서 구현할 수 있는 주요 메시징 패턴:</p><ol><li><p>작업 큐(Work Queue)<br>시간이 오래 걸리는 작업을 여러 워커에게 분산시키는 패턴이다. 라운드 로빈 방식으로 작업을 분배한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12>12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13>13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14>14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15>15</a>
</span><span class=lnt id=hl-19-16><a class=lnlinks href=#hl-19-16>16</a>
</span><span class=lnt id=hl-19-17><a class=lnlinks href=#hl-19-17>17</a>
</span><span class=lnt id=hl-19-18><a class=lnlinks href=#hl-19-18>18</a>
</span><span class=lnt id=hl-19-19><a class=lnlinks href=#hl-19-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>## Python 작업 큐 예제 (생산자)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pika</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>connection</span> <span class=o>=</span> <span class=n>pika</span><span class=o>.</span><span class=n>BlockingConnection</span><span class=p>(</span><span class=n>pika</span><span class=o>.</span><span class=n>ConnectionParameters</span><span class=p>(</span><span class=s1>&#39;localhost&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>channel</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>channel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_declare</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;task_queue&#39;</span><span class=p>,</span> <span class=n>durable</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>message</span> <span class=o>=</span> <span class=s2>&#34;복잡한 작업 내용…&#34;</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>basic_publish</span><span class=p>(</span>
</span></span><span class=line><span class=cl><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;task_queue&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=n>body</span><span class=o>=</span><span class=n>message</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=n>properties</span><span class=o>=</span><span class=n>pika</span><span class=o>.</span><span class=n>BasicProperties</span><span class=p>(</span><span class=n>delivery_mode</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>  <span class=c1># 메시지 지속성 설정</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34; [x] </span><span class=si>{</span><span class=n>message</span><span class=si>}</span><span class=s2> 전송됨&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>connection</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1> 1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2> 2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3> 3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4> 4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5> 5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6> 6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7> 7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8> 8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9> 9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10>10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11>11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12>12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13>13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14>14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15>15</a>
</span><span class=lnt id=hl-20-16><a class=lnlinks href=#hl-20-16>16</a>
</span><span class=lnt id=hl-20-17><a class=lnlinks href=#hl-20-17>17</a>
</span><span class=lnt id=hl-20-18><a class=lnlinks href=#hl-20-18>18</a>
</span><span class=lnt id=hl-20-19><a class=lnlinks href=#hl-20-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python 작업 큐 예제 (소비자)</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pika</span><span class=o>,</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>connection</span> <span class=o>=</span> <span class=n>pika</span><span class=o>.</span><span class=n>BlockingConnection</span><span class=p>(</span><span class=n>pika</span><span class=o>.</span><span class=n>ConnectionParameters</span><span class=p>(</span><span class=s1>&#39;localhost&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>channel</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>channel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_declare</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;task_queue&#39;</span><span class=p>,</span> <span class=n>durable</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39; [*] 메시지를 기다리는 중. 종료하려면 CTRL+C를 누르세요&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>callback</span><span class=p>(</span><span class=n>ch</span><span class=p>,</span> <span class=n>method</span><span class=p>,</span> <span class=n>properties</span><span class=p>,</span> <span class=n>body</span><span class=p>):</span>
</span></span><span class=line><span class=cl> <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34; [x] </span><span class=si>{</span><span class=n>body</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2> 수신됨&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=n>body</span><span class=o>.</span><span class=n>count</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;.&#39;</span><span class=p>))</span>  <span class=c1># 메시지 내 점의 개수만큼 대기</span>
</span></span><span class=line><span class=cl> <span class=nb>print</span><span class=p>(</span><span class=s2>&#34; [x] 완료&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=n>ch</span><span class=o>.</span><span class=n>basic_ack</span><span class=p>(</span><span class=n>delivery_tag</span><span class=o>=</span><span class=n>method</span><span class=o>.</span><span class=n>delivery_tag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>basic_qos</span><span class=p>(</span><span class=n>prefetch_count</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># 워커에게 한 번에 하나의 메시지만 할당</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>basic_consume</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;task_queue&#39;</span><span class=p>,</span> <span class=n>on_message_callback</span><span class=o>=</span><span class=n>callback</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>start_consuming</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li><p>구독(Publish/Subscribe)<br>하나의 메시지를 여러 소비자에게 브로드캐스트하는 패턴이다. Fanout Exchange를 사용한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span><span class=lnt id=hl-21-11><a class=lnlinks href=#hl-21-11>11</a>
</span><span class=lnt id=hl-21-12><a class=lnlinks href=#hl-21-12>12</a>
</span><span class=lnt id=hl-21-13><a class=lnlinks href=#hl-21-13>13</a>
</span><span class=lnt id=hl-21-14><a class=lnlinks href=#hl-21-14>14</a>
</span><span class=lnt id=hl-21-15><a class=lnlinks href=#hl-21-15>15</a>
</span><span class=lnt id=hl-21-16><a class=lnlinks href=#hl-21-16>16</a>
</span><span class=lnt id=hl-21-17><a class=lnlinks href=#hl-21-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python 발행/구독 예제 (발행자)</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pika</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>connection</span> <span class=o>=</span> <span class=n>pika</span><span class=o>.</span><span class=n>BlockingConnection</span><span class=p>(</span><span class=n>pika</span><span class=o>.</span><span class=n>ConnectionParameters</span><span class=p>(</span><span class=s1>&#39;localhost&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>channel</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>channel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>exchange_declare</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;logs&#39;</span><span class=p>,</span> <span class=n>exchange_type</span><span class=o>=</span><span class=s1>&#39;fanout&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>message</span> <span class=o>=</span> <span class=s2>&#34;정보: 이것은 로그 메시지입니다.&#34;</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>basic_publish</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;logs&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>body</span><span class=o>=</span><span class=n>message</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34; [x] </span><span class=si>{</span><span class=n>message</span><span class=si>}</span><span class=s2> 전송됨&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>connection</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1> 1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2> 2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3> 3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4> 4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5> 5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6> 6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7> 7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8> 8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9> 9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10>10</a>
</span><span class=lnt id=hl-22-11><a class=lnlinks href=#hl-22-11>11</a>
</span><span class=lnt id=hl-22-12><a class=lnlinks href=#hl-22-12>12</a>
</span><span class=lnt id=hl-22-13><a class=lnlinks href=#hl-22-13>13</a>
</span><span class=lnt id=hl-22-14><a class=lnlinks href=#hl-22-14>14</a>
</span><span class=lnt id=hl-22-15><a class=lnlinks href=#hl-22-15>15</a>
</span><span class=lnt id=hl-22-16><a class=lnlinks href=#hl-22-16>16</a>
</span><span class=lnt id=hl-22-17><a class=lnlinks href=#hl-22-17>17</a>
</span><span class=lnt id=hl-22-18><a class=lnlinks href=#hl-22-18>18</a>
</span><span class=lnt id=hl-22-19><a class=lnlinks href=#hl-22-19>19</a>
</span><span class=lnt id=hl-22-20><a class=lnlinks href=#hl-22-20>20</a>
</span><span class=lnt id=hl-22-21><a class=lnlinks href=#hl-22-21>21</a>
</span><span class=lnt id=hl-22-22><a class=lnlinks href=#hl-22-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python 발행/구독 예제 (구독자)</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pika</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>connection</span> <span class=o>=</span> <span class=n>pika</span><span class=o>.</span><span class=n>BlockingConnection</span><span class=p>(</span><span class=n>pika</span><span class=o>.</span><span class=n>ConnectionParameters</span><span class=p>(</span><span class=s1>&#39;localhost&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>channel</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>channel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>exchange_declare</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;logs&#39;</span><span class=p>,</span> <span class=n>exchange_type</span><span class=o>=</span><span class=s1>&#39;fanout&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>channel</span><span class=o>.</span><span class=n>queue_declare</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>exclusive</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>queue_name</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>method</span><span class=o>.</span><span class=n>queue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_bind</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;logs&#39;</span><span class=p>,</span> <span class=n>queue</span><span class=o>=</span><span class=n>queue_name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39; [*] 로그를 기다리는 중. 종료하려면 CTRL+C를 누르세요&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>callback</span><span class=p>(</span><span class=n>ch</span><span class=p>,</span> <span class=n>method</span><span class=p>,</span> <span class=n>properties</span><span class=p>,</span> <span class=n>body</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34; [x] </span><span class=si>{</span><span class=n>body</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>basic_consume</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>queue</span><span class=o>=</span><span class=n>queue_name</span><span class=p>,</span> <span class=n>on_message_callback</span><span class=o>=</span><span class=n>callback</span><span class=p>,</span> <span class=n>auto_ack</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>start_consuming</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div></li></ol></li><li><p>라우팅(Routing)<br>특정 기준에 따라 메시지를 선택적으로 수신하는 패턴이다. Direct Exchange를 사용한다.</p></li><li><p>토픽(Topic)<br>여러 기준에 따라 메시지를 패턴 매칭으로 라우팅하는 패턴이다. Topic Exchange를 사용한다.</p></li><li><p>RPC(Remote Procedure Call)<br>클라이언트가 요청을 보내고 응답을 기다리는 동기적인 패턴이다.</p></li></ol></li></ol><h3 id=rabbitmq-설치-및-기본-구성>RabbitMQ 설치 및 기본 구성<a hidden class=anchor aria-hidden=true href=#rabbitmq-설치-및-기본-구성>#</a></h3><h4 id=단독-서버-설치>단독 서버 설치<a hidden class=anchor aria-hidden=true href=#단독-서버-설치>#</a></h4><h5 id=linux에-설치>Linux에 설치<a hidden class=anchor aria-hidden=true href=#linux에-설치>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1>1</a>
</span><span class=lnt id=hl-23-2><a class=lnlinks href=#hl-23-2>2</a>
</span><span class=lnt id=hl-23-3><a class=lnlinks href=#hl-23-3>3</a>
</span><span class=lnt id=hl-23-4><a class=lnlinks href=#hl-23-4>4</a>
</span><span class=lnt id=hl-23-5><a class=lnlinks href=#hl-23-5>5</a>
</span><span class=lnt id=hl-23-6><a class=lnlinks href=#hl-23-6>6</a>
</span><span class=lnt id=hl-23-7><a class=lnlinks href=#hl-23-7>7</a>
</span><span class=lnt id=hl-23-8><a class=lnlinks href=#hl-23-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Debian/Ubuntu</span>
</span></span><span class=line><span class=cl>sudo apt-get install rabbitmq-server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 서비스 시작</span>
</span></span><span class=line><span class=cl>sudo systemctl start rabbitmq-server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 부팅 시 자동 시작</span>
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> rabbitmq-server
</span></span></code></pre></td></tr></table></div></div><h5 id=docker를-사용한-설치>Docker를 사용한 설치<a hidden class=anchor aria-hidden=true href=#docker를-사용한-설치>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1>1</a>
</span><span class=lnt id=hl-24-2><a class=lnlinks href=#hl-24-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># RabbitMQ 도커 이미지 실행</span>
</span></span><span class=line><span class=cl>docker run -d --name my-rabbit -p 5672:5672 -p 15672:15672 rabbitmq:3-management
</span></span></code></pre></td></tr></table></div></div><h4 id=관리-인터페이스-활성화>관리 인터페이스 활성화<a hidden class=anchor aria-hidden=true href=#관리-인터페이스-활성화>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1>1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2>2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3>3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4>4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5>5</a>
</span><span class=lnt id=hl-25-6><a class=lnlinks href=#hl-25-6>6</a>
</span><span class=lnt id=hl-25-7><a class=lnlinks href=#hl-25-7>7</a>
</span><span class=lnt id=hl-25-8><a class=lnlinks href=#hl-25-8>8</a>
</span><span class=lnt id=hl-25-9><a class=lnlinks href=#hl-25-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 관리 플러그인 활성화</span>
</span></span><span class=line><span class=cl>sudo rabbitmq-plugins <span class=nb>enable</span> rabbitmq_management
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용자 추가</span>
</span></span><span class=line><span class=cl>sudo rabbitmqctl add_user admin strongpassword
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 관리자 권한 부여</span>
</span></span><span class=line><span class=cl>sudo rabbitmqctl set_user_tags admin administrator
</span></span><span class=line><span class=cl>sudo rabbitmqctl set_permissions -p / admin <span class=s2>&#34;.*&#34;</span> <span class=s2>&#34;.*&#34;</span> <span class=s2>&#34;.*&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>관리 인터페이스는 <a href=http://localhost:15672>http://localhost:15672</a>에서> 접근할 수 있으며, 기본 사용자 이름과 비밀번호는 guest/guest이다(로컬호스트에서만 작동).</p><h3 id=클러스터-설정>클러스터 설정<a hidden class=anchor aria-hidden=true href=#클러스터-설정>#</a></h3><h4 id=기본-클러스터-설정>기본 클러스터 설정<a hidden class=anchor aria-hidden=true href=#기본-클러스터-설정>#</a></h4><p>클러스터는 최소 3개의 노드로 구성하는 것이 좋다. 각 노드에서 RabbitMQ를 설치한 후 다음 단계를 따른다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-26-1><a class=lnlinks href=#hl-26-1> 1</a>
</span><span class=lnt id=hl-26-2><a class=lnlinks href=#hl-26-2> 2</a>
</span><span class=lnt id=hl-26-3><a class=lnlinks href=#hl-26-3> 3</a>
</span><span class=lnt id=hl-26-4><a class=lnlinks href=#hl-26-4> 4</a>
</span><span class=lnt id=hl-26-5><a class=lnlinks href=#hl-26-5> 5</a>
</span><span class=lnt id=hl-26-6><a class=lnlinks href=#hl-26-6> 6</a>
</span><span class=lnt id=hl-26-7><a class=lnlinks href=#hl-26-7> 7</a>
</span><span class=lnt id=hl-26-8><a class=lnlinks href=#hl-26-8> 8</a>
</span><span class=lnt id=hl-26-9><a class=lnlinks href=#hl-26-9> 9</a>
</span><span class=lnt id=hl-26-10><a class=lnlinks href=#hl-26-10>10</a>
</span><span class=lnt id=hl-26-11><a class=lnlinks href=#hl-26-11>11</a>
</span><span class=lnt id=hl-26-12><a class=lnlinks href=#hl-26-12>12</a>
</span><span class=lnt id=hl-26-13><a class=lnlinks href=#hl-26-13>13</a>
</span><span class=lnt id=hl-26-14><a class=lnlinks href=#hl-26-14>14</a>
</span><span class=lnt id=hl-26-15><a class=lnlinks href=#hl-26-15>15</a>
</span><span class=lnt id=hl-26-16><a class=lnlinks href=#hl-26-16>16</a>
</span><span class=lnt id=hl-26-17><a class=lnlinks href=#hl-26-17>17</a>
</span><span class=lnt id=hl-26-18><a class=lnlinks href=#hl-26-18>18</a>
</span><span class=lnt id=hl-26-19><a class=lnlinks href=#hl-26-19>19</a>
</span><span class=lnt id=hl-26-20><a class=lnlinks href=#hl-26-20>20</a>
</span><span class=lnt id=hl-26-21><a class=lnlinks href=#hl-26-21>21</a>
</span><span class=lnt id=hl-26-22><a class=lnlinks href=#hl-26-22>22</a>
</span><span class=lnt id=hl-26-23><a class=lnlinks href=#hl-26-23>23</a>
</span><span class=lnt id=hl-26-24><a class=lnlinks href=#hl-26-24>24</a>
</span><span class=lnt id=hl-26-25><a class=lnlinks href=#hl-26-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 노드 1에서 Erlang 쿠키 확인</span>
</span></span><span class=line><span class=cl>cat /var/lib/rabbitmq/.erlang.cookie
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 모든 노드에서 동일한 Erlang 쿠키 설정</span>
</span></span><span class=line><span class=cl><span class=c1># 노드 2, 3에서:</span>
</span></span><span class=line><span class=cl>sudo service rabbitmq-server stop
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;ERLANG_COOKIE_FROM_NODE_1&#34;</span> <span class=p>|</span> sudo tee /var/lib/rabbitmq/.erlang.cookie
</span></span><span class=line><span class=cl>sudo chown rabbitmq:rabbitmq /var/lib/rabbitmq/.erlang.cookie
</span></span><span class=line><span class=cl>sudo chmod <span class=m>400</span> /var/lib/rabbitmq/.erlang.cookie
</span></span><span class=line><span class=cl>sudo service rabbitmq-server start
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 노드 2에서 노드 1에 조인</span>
</span></span><span class=line><span class=cl>sudo rabbitmqctl stop_app
</span></span><span class=line><span class=cl>sudo rabbitmqctl reset
</span></span><span class=line><span class=cl>sudo rabbitmqctl join_cluster rabbit@node1
</span></span><span class=line><span class=cl>sudo rabbitmqctl start_app
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 노드 3에서도 동일하게 수행</span>
</span></span><span class=line><span class=cl>sudo rabbitmqctl stop_app
</span></span><span class=line><span class=cl>sudo rabbitmqctl reset
</span></span><span class=line><span class=cl>sudo rabbitmqctl join_cluster rabbit@node1
</span></span><span class=line><span class=cl>sudo rabbitmqctl start_app
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 클러스터 상태 확인</span>
</span></span><span class=line><span class=cl>sudo rabbitmqctl cluster_status
</span></span></code></pre></td></tr></table></div></div><h4 id=고가용성-설정>고가용성 설정<a hidden class=anchor aria-hidden=true href=#고가용성-설정>#</a></h4><p>미러링 큐를 통해 고가용성을 확보할 수 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-27-1><a class=lnlinks href=#hl-27-1>1</a>
</span><span class=lnt id=hl-27-2><a class=lnlinks href=#hl-27-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 모든 큐를 자동으로 미러링하는 정책 설정</span>
</span></span><span class=line><span class=cl>sudo rabbitmqctl set_policy ha-all <span class=s2>&#34;^&#34;</span> <span class=s1>&#39;{&#34;ha-mode&#34;:&#34;all&#34;}&#39;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=주요-구성-파일>주요 구성 파일<a hidden class=anchor aria-hidden=true href=#주요-구성-파일>#</a></h4><p>RabbitMQ의 주요 구성 파일은 다음과 같다:</p><ul><li><code>/etc/rabbitmq/rabbitmq.conf</code>: 기본 구성 파일</li><li><code>/etc/rabbitmq/advanced.config</code>: 고급 Erlang 구성</li><li><code>/etc/rabbitmq/rabbitmq-env.conf</code>: 환경 변수 설정</li></ul><p>중요한 구성 매개변수:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-28-1><a class=lnlinks href=#hl-28-1>1</a>
</span><span class=lnt id=hl-28-2><a class=lnlinks href=#hl-28-2>2</a>
</span><span class=lnt id=hl-28-3><a class=lnlinks href=#hl-28-3>3</a>
</span><span class=lnt id=hl-28-4><a class=lnlinks href=#hl-28-4>4</a>
</span><span class=lnt id=hl-28-5><a class=lnlinks href=#hl-28-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rabbitmq.conf 예제
</span></span><span class=line><span class=cl>listeners.tcp.default = 5672
</span></span><span class=line><span class=cl>management.tcp.port = 15672
</span></span><span class=line><span class=cl>vm_memory_high_watermark.relative = 0.4
</span></span><span class=line><span class=cl>disk_free_limit.absolute = 1GB
</span></span></code></pre></td></tr></table></div></div><h3 id=rabbitmq-클라이언트-프로그래밍>RabbitMQ 클라이언트 프로그래밍<a hidden class=anchor aria-hidden=true href=#rabbitmq-클라이언트-프로그래밍>#</a></h3><h4 id=java-클라이언트>Java 클라이언트<a hidden class=anchor aria-hidden=true href=#java-클라이언트>#</a></h4><p>의존성 추가 (Maven):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-29-1><a class=lnlinks href=#hl-29-1>1</a>
</span><span class=lnt id=hl-29-2><a class=lnlinks href=#hl-29-2>2</a>
</span><span class=lnt id=hl-29-3><a class=lnlinks href=#hl-29-3>3</a>
</span><span class=lnt id=hl-29-4><a class=lnlinks href=#hl-29-4>4</a>
</span><span class=lnt id=hl-29-5><a class=lnlinks href=#hl-29-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>com.rabbitmq<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>amqp-client<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>5.15.0<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>기본 생산자 코드:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-30-1><a class=lnlinks href=#hl-30-1> 1</a>
</span><span class=lnt id=hl-30-2><a class=lnlinks href=#hl-30-2> 2</a>
</span><span class=lnt id=hl-30-3><a class=lnlinks href=#hl-30-3> 3</a>
</span><span class=lnt id=hl-30-4><a class=lnlinks href=#hl-30-4> 4</a>
</span><span class=lnt id=hl-30-5><a class=lnlinks href=#hl-30-5> 5</a>
</span><span class=lnt id=hl-30-6><a class=lnlinks href=#hl-30-6> 6</a>
</span><span class=lnt id=hl-30-7><a class=lnlinks href=#hl-30-7> 7</a>
</span><span class=lnt id=hl-30-8><a class=lnlinks href=#hl-30-8> 8</a>
</span><span class=lnt id=hl-30-9><a class=lnlinks href=#hl-30-9> 9</a>
</span><span class=lnt id=hl-30-10><a class=lnlinks href=#hl-30-10>10</a>
</span><span class=lnt id=hl-30-11><a class=lnlinks href=#hl-30-11>11</a>
</span><span class=lnt id=hl-30-12><a class=lnlinks href=#hl-30-12>12</a>
</span><span class=lnt id=hl-30-13><a class=lnlinks href=#hl-30-13>13</a>
</span><span class=lnt id=hl-30-14><a class=lnlinks href=#hl-30-14>14</a>
</span><span class=lnt id=hl-30-15><a class=lnlinks href=#hl-30-15>15</a>
</span><span class=lnt id=hl-30-16><a class=lnlinks href=#hl-30-16>16</a>
</span><span class=lnt id=hl-30-17><a class=lnlinks href=#hl-30-17>17</a>
</span><span class=lnt id=hl-30-18><a class=lnlinks href=#hl-30-18>18</a>
</span><span class=lnt id=hl-30-19><a class=lnlinks href=#hl-30-19>19</a>
</span><span class=lnt id=hl-30-20><a class=lnlinks href=#hl-30-20>20</a>
</span><span class=lnt id=hl-30-21><a class=lnlinks href=#hl-30-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>com.rabbitmq.client.Channel</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>com.rabbitmq.client.Connection</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>com.rabbitmq.client.ConnectionFactory</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Producer</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>QUEUE_NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;hello&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>ConnectionFactory</span><span class=w> </span><span class=n>factory</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ConnectionFactory</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>factory</span><span class=p>.</span><span class=na>setHost</span><span class=p>(</span><span class=s>&#34;localhost&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>(</span><span class=n>Connection</span><span class=w> </span><span class=n>connection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>factory</span><span class=p>.</span><span class=na>newConnection</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>             </span><span class=n>Channel</span><span class=w> </span><span class=n>channel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connection</span><span class=p>.</span><span class=na>createChannel</span><span class=p>())</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>channel</span><span class=p>.</span><span class=na>queueDeclare</span><span class=p>(</span><span class=n>QUEUE_NAME</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>String</span><span class=w> </span><span class=n>message</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;Hello World!&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>channel</span><span class=p>.</span><span class=na>basicPublish</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=n>QUEUE_NAME</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>message</span><span class=p>.</span><span class=na>getBytes</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34; [x] Sent &#39;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>message</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;&#39;&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>기본 소비자 코드:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-31-1><a class=lnlinks href=#hl-31-1> 1</a>
</span><span class=lnt id=hl-31-2><a class=lnlinks href=#hl-31-2> 2</a>
</span><span class=lnt id=hl-31-3><a class=lnlinks href=#hl-31-3> 3</a>
</span><span class=lnt id=hl-31-4><a class=lnlinks href=#hl-31-4> 4</a>
</span><span class=lnt id=hl-31-5><a class=lnlinks href=#hl-31-5> 5</a>
</span><span class=lnt id=hl-31-6><a class=lnlinks href=#hl-31-6> 6</a>
</span><span class=lnt id=hl-31-7><a class=lnlinks href=#hl-31-7> 7</a>
</span><span class=lnt id=hl-31-8><a class=lnlinks href=#hl-31-8> 8</a>
</span><span class=lnt id=hl-31-9><a class=lnlinks href=#hl-31-9> 9</a>
</span><span class=lnt id=hl-31-10><a class=lnlinks href=#hl-31-10>10</a>
</span><span class=lnt id=hl-31-11><a class=lnlinks href=#hl-31-11>11</a>
</span><span class=lnt id=hl-31-12><a class=lnlinks href=#hl-31-12>12</a>
</span><span class=lnt id=hl-31-13><a class=lnlinks href=#hl-31-13>13</a>
</span><span class=lnt id=hl-31-14><a class=lnlinks href=#hl-31-14>14</a>
</span><span class=lnt id=hl-31-15><a class=lnlinks href=#hl-31-15>15</a>
</span><span class=lnt id=hl-31-16><a class=lnlinks href=#hl-31-16>16</a>
</span><span class=lnt id=hl-31-17><a class=lnlinks href=#hl-31-17>17</a>
</span><span class=lnt id=hl-31-18><a class=lnlinks href=#hl-31-18>18</a>
</span><span class=lnt id=hl-31-19><a class=lnlinks href=#hl-31-19>19</a>
</span><span class=lnt id=hl-31-20><a class=lnlinks href=#hl-31-20>20</a>
</span><span class=lnt id=hl-31-21><a class=lnlinks href=#hl-31-21>21</a>
</span><span class=lnt id=hl-31-22><a class=lnlinks href=#hl-31-22>22</a>
</span><span class=lnt id=hl-31-23><a class=lnlinks href=#hl-31-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>com.rabbitmq.client.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Consumer</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>QUEUE_NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;hello&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>ConnectionFactory</span><span class=w> </span><span class=n>factory</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ConnectionFactory</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>factory</span><span class=p>.</span><span class=na>setHost</span><span class=p>(</span><span class=s>&#34;localhost&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Connection</span><span class=w> </span><span class=n>connection</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>factory</span><span class=p>.</span><span class=na>newConnection</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Channel</span><span class=w> </span><span class=n>channel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connection</span><span class=p>.</span><span class=na>createChannel</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>channel</span><span class=p>.</span><span class=na>queueDeclare</span><span class=p>(</span><span class=n>QUEUE_NAME</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34; [*] Waiting for messages. To exit press CTRL+C&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>DeliverCallback</span><span class=w> </span><span class=n>deliverCallback</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>consumerTag</span><span class=p>,</span><span class=w> </span><span class=n>delivery</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>String</span><span class=w> </span><span class=n>message</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>String</span><span class=p>(</span><span class=n>delivery</span><span class=p>.</span><span class=na>getBody</span><span class=p>(),</span><span class=w> </span><span class=s>&#34;UTF-8&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34; [x] Received &#39;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>message</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;&#39;&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>channel</span><span class=p>.</span><span class=na>basicConsume</span><span class=p>(</span><span class=n>QUEUE_NAME</span><span class=p>,</span><span class=w> </span><span class=kc>true</span><span class=p>,</span><span class=w> </span><span class=n>deliverCallback</span><span class=p>,</span><span class=w> </span><span class=n>consumerTag</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=spring-amqp-사용>Spring AMQP 사용<a hidden class=anchor aria-hidden=true href=#spring-amqp-사용>#</a></h4><p>Spring Boot 애플리케이션에서는 Spring AMQP를 통해 더 쉽게 RabbitMQ를 사용할 수 있다.</p><p>의존성 추가 (Gradle):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-32-1><a class=lnlinks href=#hl-32-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>implementation</span> <span class=s1>&#39;org.springframework.boot:spring-boot-starter-amqp&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>RabbitMQ 구성:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-33-1><a class=lnlinks href=#hl-33-1> 1</a>
</span><span class=lnt id=hl-33-2><a class=lnlinks href=#hl-33-2> 2</a>
</span><span class=lnt id=hl-33-3><a class=lnlinks href=#hl-33-3> 3</a>
</span><span class=lnt id=hl-33-4><a class=lnlinks href=#hl-33-4> 4</a>
</span><span class=lnt id=hl-33-5><a class=lnlinks href=#hl-33-5> 5</a>
</span><span class=lnt id=hl-33-6><a class=lnlinks href=#hl-33-6> 6</a>
</span><span class=lnt id=hl-33-7><a class=lnlinks href=#hl-33-7> 7</a>
</span><span class=lnt id=hl-33-8><a class=lnlinks href=#hl-33-8> 8</a>
</span><span class=lnt id=hl-33-9><a class=lnlinks href=#hl-33-9> 9</a>
</span><span class=lnt id=hl-33-10><a class=lnlinks href=#hl-33-10>10</a>
</span><span class=lnt id=hl-33-11><a class=lnlinks href=#hl-33-11>11</a>
</span><span class=lnt id=hl-33-12><a class=lnlinks href=#hl-33-12>12</a>
</span><span class=lnt id=hl-33-13><a class=lnlinks href=#hl-33-13>13</a>
</span><span class=lnt id=hl-33-14><a class=lnlinks href=#hl-33-14>14</a>
</span><span class=lnt id=hl-33-15><a class=lnlinks href=#hl-33-15>15</a>
</span><span class=lnt id=hl-33-16><a class=lnlinks href=#hl-33-16>16</a>
</span><span class=lnt id=hl-33-17><a class=lnlinks href=#hl-33-17>17</a>
</span><span class=lnt id=hl-33-18><a class=lnlinks href=#hl-33-18>18</a>
</span><span class=lnt id=hl-33-19><a class=lnlinks href=#hl-33-19>19</a>
</span><span class=lnt id=hl-33-20><a class=lnlinks href=#hl-33-20>20</a>
</span><span class=lnt id=hl-33-21><a class=lnlinks href=#hl-33-21>21</a>
</span><span class=lnt id=hl-33-22><a class=lnlinks href=#hl-33-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.amqp.core.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.context.annotation.Bean</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.context.annotation.Configuration</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>RabbitMQConfig</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Queue</span><span class=w> </span><span class=nf>helloQueue</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Queue</span><span class=p>(</span><span class=s>&#34;hello&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>DirectExchange</span><span class=w> </span><span class=nf>exchange</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>DirectExchange</span><span class=p>(</span><span class=s>&#34;direct-exchange&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Binding</span><span class=w> </span><span class=nf>binding</span><span class=p>(</span><span class=n>Queue</span><span class=w> </span><span class=n>helloQueue</span><span class=p>,</span><span class=w> </span><span class=n>DirectExchange</span><span class=w> </span><span class=n>exchange</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>BindingBuilder</span><span class=p>.</span><span class=na>bind</span><span class=p>(</span><span class=n>helloQueue</span><span class=p>).</span><span class=na>to</span><span class=p>(</span><span class=n>exchange</span><span class=p>).</span><span class=na>with</span><span class=p>(</span><span class=s>&#34;hello&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>메시지 생산자:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-34-1><a class=lnlinks href=#hl-34-1> 1</a>
</span><span class=lnt id=hl-34-2><a class=lnlinks href=#hl-34-2> 2</a>
</span><span class=lnt id=hl-34-3><a class=lnlinks href=#hl-34-3> 3</a>
</span><span class=lnt id=hl-34-4><a class=lnlinks href=#hl-34-4> 4</a>
</span><span class=lnt id=hl-34-5><a class=lnlinks href=#hl-34-5> 5</a>
</span><span class=lnt id=hl-34-6><a class=lnlinks href=#hl-34-6> 6</a>
</span><span class=lnt id=hl-34-7><a class=lnlinks href=#hl-34-7> 7</a>
</span><span class=lnt id=hl-34-8><a class=lnlinks href=#hl-34-8> 8</a>
</span><span class=lnt id=hl-34-9><a class=lnlinks href=#hl-34-9> 9</a>
</span><span class=lnt id=hl-34-10><a class=lnlinks href=#hl-34-10>10</a>
</span><span class=lnt id=hl-34-11><a class=lnlinks href=#hl-34-11>11</a>
</span><span class=lnt id=hl-34-12><a class=lnlinks href=#hl-34-12>12</a>
</span><span class=lnt id=hl-34-13><a class=lnlinks href=#hl-34-13>13</a>
</span><span class=lnt id=hl-34-14><a class=lnlinks href=#hl-34-14>14</a>
</span><span class=lnt id=hl-34-15><a class=lnlinks href=#hl-34-15>15</a>
</span><span class=lnt id=hl-34-16><a class=lnlinks href=#hl-34-16>16</a>
</span><span class=lnt id=hl-34-17><a class=lnlinks href=#hl-34-17>17</a>
</span><span class=lnt id=hl-34-18><a class=lnlinks href=#hl-34-18>18</a>
</span><span class=lnt id=hl-34-19><a class=lnlinks href=#hl-34-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.amqp.core.Queue</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.amqp.rabbit.core.RabbitTemplate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.beans.factory.annotation.Autowired</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.stereotype.Service</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>RabbitMQSender</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>RabbitTemplate</span><span class=w> </span><span class=n>rabbitTemplate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Queue</span><span class=w> </span><span class=n>queue</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>send</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>message</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>rabbitTemplate</span><span class=p>.</span><span class=na>convertAndSend</span><span class=p>(</span><span class=s>&#34;direct-exchange&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;hello&#34;</span><span class=p>,</span><span class=w> </span><span class=n>message</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;메시지 전송됨: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>message</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>메시지 소비자:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-35-1><a class=lnlinks href=#hl-35-1> 1</a>
</span><span class=lnt id=hl-35-2><a class=lnlinks href=#hl-35-2> 2</a>
</span><span class=lnt id=hl-35-3><a class=lnlinks href=#hl-35-3> 3</a>
</span><span class=lnt id=hl-35-4><a class=lnlinks href=#hl-35-4> 4</a>
</span><span class=lnt id=hl-35-5><a class=lnlinks href=#hl-35-5> 5</a>
</span><span class=lnt id=hl-35-6><a class=lnlinks href=#hl-35-6> 6</a>
</span><span class=lnt id=hl-35-7><a class=lnlinks href=#hl-35-7> 7</a>
</span><span class=lnt id=hl-35-8><a class=lnlinks href=#hl-35-8> 8</a>
</span><span class=lnt id=hl-35-9><a class=lnlinks href=#hl-35-9> 9</a>
</span><span class=lnt id=hl-35-10><a class=lnlinks href=#hl-35-10>10</a>
</span><span class=lnt id=hl-35-11><a class=lnlinks href=#hl-35-11>11</a>
</span><span class=lnt id=hl-35-12><a class=lnlinks href=#hl-35-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.amqp.rabbit.annotation.RabbitListener</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.stereotype.Component</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Component</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>RabbitMQReceiver</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@RabbitListener</span><span class=p>(</span><span class=n>queues</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;hello&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>receiveMessage</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>message</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;메시지 수신됨: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>message</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 메시지 처리 로직</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=nodejs-클라이언트>Node.js 클라이언트<a hidden class=anchor aria-hidden=true href=#nodejs-클라이언트>#</a></h4><p>Amqplib 설치:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-36-1><a class=lnlinks href=#hl-36-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npm install amqplib
</span></span></code></pre></td></tr></table></div></div><p>기본 생산자 코드:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-37-1><a class=lnlinks href=#hl-37-1> 1</a>
</span><span class=lnt id=hl-37-2><a class=lnlinks href=#hl-37-2> 2</a>
</span><span class=lnt id=hl-37-3><a class=lnlinks href=#hl-37-3> 3</a>
</span><span class=lnt id=hl-37-4><a class=lnlinks href=#hl-37-4> 4</a>
</span><span class=lnt id=hl-37-5><a class=lnlinks href=#hl-37-5> 5</a>
</span><span class=lnt id=hl-37-6><a class=lnlinks href=#hl-37-6> 6</a>
</span><span class=lnt id=hl-37-7><a class=lnlinks href=#hl-37-7> 7</a>
</span><span class=lnt id=hl-37-8><a class=lnlinks href=#hl-37-8> 8</a>
</span><span class=lnt id=hl-37-9><a class=lnlinks href=#hl-37-9> 9</a>
</span><span class=lnt id=hl-37-10><a class=lnlinks href=#hl-37-10>10</a>
</span><span class=lnt id=hl-37-11><a class=lnlinks href=#hl-37-11>11</a>
</span><span class=lnt id=hl-37-12><a class=lnlinks href=#hl-37-12>12</a>
</span><span class=lnt id=hl-37-13><a class=lnlinks href=#hl-37-13>13</a>
</span><span class=lnt id=hl-37-14><a class=lnlinks href=#hl-37-14>14</a>
</span><span class=lnt id=hl-37-15><a class=lnlinks href=#hl-37-15>15</a>
</span><span class=lnt id=hl-37-16><a class=lnlinks href=#hl-37-16>16</a>
</span><span class=lnt id=hl-37-17><a class=lnlinks href=#hl-37-17>17</a>
</span><span class=lnt id=hl-37-18><a class=lnlinks href=#hl-37-18>18</a>
</span><span class=lnt id=hl-37-19><a class=lnlinks href=#hl-37-19>19</a>
</span><span class=lnt id=hl-37-20><a class=lnlinks href=#hl-37-20>20</a>
</span><span class=lnt id=hl-37-21><a class=lnlinks href=#hl-37-21>21</a>
</span><span class=lnt id=hl-37-22><a class=lnlinks href=#hl-37-22>22</a>
</span><span class=lnt id=hl-37-23><a class=lnlinks href=#hl-37-23>23</a>
</span><span class=lnt id=hl-37-24><a class=lnlinks href=#hl-37-24>24</a>
</span><span class=lnt id=hl-37-25><a class=lnlinks href=#hl-37-25>25</a>
</span><span class=lnt id=hl-37-26><a class=lnlinks href=#hl-37-26>26</a>
</span><span class=lnt id=hl-37-27><a class=lnlinks href=#hl-37-27>27</a>
</span><span class=lnt id=hl-37-28><a class=lnlinks href=#hl-37-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>amqp</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;amqplib/callback_api&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>amqp</span><span class=p>.</span><span class=nx>connect</span><span class=p>(</span><span class=s1>&#39;amqp://localhost&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>error0</span><span class=p>,</span> <span class=nx>connection</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>error0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=nx>error0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>connection</span><span class=p>.</span><span class=nx>createChannel</span><span class=p>((</span><span class=nx>error1</span><span class=p>,</span> <span class=nx>channel</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>error1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=nx>error1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>queue</span> <span class=o>=</span> <span class=s1>&#39;hello&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>msg</span> <span class=o>=</span> <span class=s1>&#39;Hello World!&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>channel</span><span class=p>.</span><span class=nx>assertQueue</span><span class=p>(</span><span class=nx>queue</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>durable</span><span class=o>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>channel</span><span class=p>.</span><span class=nx>sendToQueue</span><span class=p>(</span><span class=nx>queue</span><span class=p>,</span> <span class=nx>Buffer</span><span class=p>.</span><span class=nx>from</span><span class=p>(</span><span class=nx>msg</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34; [x] Sent %s&#34;</span><span class=p>,</span> <span class=nx>msg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>connection</span><span class=p>.</span><span class=nx>close</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=nx>process</span><span class=p>.</span><span class=nx>exit</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span> <span class=mi>500</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>기본 소비자 코드:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-38-1><a class=lnlinks href=#hl-38-1> 1</a>
</span><span class=lnt id=hl-38-2><a class=lnlinks href=#hl-38-2> 2</a>
</span><span class=lnt id=hl-38-3><a class=lnlinks href=#hl-38-3> 3</a>
</span><span class=lnt id=hl-38-4><a class=lnlinks href=#hl-38-4> 4</a>
</span><span class=lnt id=hl-38-5><a class=lnlinks href=#hl-38-5> 5</a>
</span><span class=lnt id=hl-38-6><a class=lnlinks href=#hl-38-6> 6</a>
</span><span class=lnt id=hl-38-7><a class=lnlinks href=#hl-38-7> 7</a>
</span><span class=lnt id=hl-38-8><a class=lnlinks href=#hl-38-8> 8</a>
</span><span class=lnt id=hl-38-9><a class=lnlinks href=#hl-38-9> 9</a>
</span><span class=lnt id=hl-38-10><a class=lnlinks href=#hl-38-10>10</a>
</span><span class=lnt id=hl-38-11><a class=lnlinks href=#hl-38-11>11</a>
</span><span class=lnt id=hl-38-12><a class=lnlinks href=#hl-38-12>12</a>
</span><span class=lnt id=hl-38-13><a class=lnlinks href=#hl-38-13>13</a>
</span><span class=lnt id=hl-38-14><a class=lnlinks href=#hl-38-14>14</a>
</span><span class=lnt id=hl-38-15><a class=lnlinks href=#hl-38-15>15</a>
</span><span class=lnt id=hl-38-16><a class=lnlinks href=#hl-38-16>16</a>
</span><span class=lnt id=hl-38-17><a class=lnlinks href=#hl-38-17>17</a>
</span><span class=lnt id=hl-38-18><a class=lnlinks href=#hl-38-18>18</a>
</span><span class=lnt id=hl-38-19><a class=lnlinks href=#hl-38-19>19</a>
</span><span class=lnt id=hl-38-20><a class=lnlinks href=#hl-38-20>20</a>
</span><span class=lnt id=hl-38-21><a class=lnlinks href=#hl-38-21>21</a>
</span><span class=lnt id=hl-38-22><a class=lnlinks href=#hl-38-22>22</a>
</span><span class=lnt id=hl-38-23><a class=lnlinks href=#hl-38-23>23</a>
</span><span class=lnt id=hl-38-24><a class=lnlinks href=#hl-38-24>24</a>
</span><span class=lnt id=hl-38-25><a class=lnlinks href=#hl-38-25>25</a>
</span><span class=lnt id=hl-38-26><a class=lnlinks href=#hl-38-26>26</a>
</span><span class=lnt id=hl-38-27><a class=lnlinks href=#hl-38-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>amqp</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;amqplib/callback_api&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>amqp</span><span class=p>.</span><span class=nx>connect</span><span class=p>(</span><span class=s1>&#39;amqp://localhost&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>error0</span><span class=p>,</span> <span class=nx>connection</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>error0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=nx>error0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>connection</span><span class=p>.</span><span class=nx>createChannel</span><span class=p>((</span><span class=nx>error1</span><span class=p>,</span> <span class=nx>channel</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>error1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=nx>error1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>queue</span> <span class=o>=</span> <span class=s1>&#39;hello&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>channel</span><span class=p>.</span><span class=nx>assertQueue</span><span class=p>(</span><span class=nx>queue</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>durable</span><span class=o>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34; [*] Waiting for messages in %s. To exit press CTRL+C&#34;</span><span class=p>,</span> <span class=nx>queue</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>channel</span><span class=p>.</span><span class=nx>consume</span><span class=p>(</span><span class=nx>queue</span><span class=p>,</span> <span class=p>(</span><span class=nx>msg</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34; [x] Received %s&#34;</span><span class=p>,</span> <span class=nx>msg</span><span class=p>.</span><span class=nx>content</span><span class=p>.</span><span class=nx>toString</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>noAck</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=고급-rabbitmq-기능>고급 RabbitMQ 기능<a hidden class=anchor aria-hidden=true href=#고급-rabbitmq-기능>#</a></h3><h4 id=메시지-내구성>메시지 내구성<a hidden class=anchor aria-hidden=true href=#메시지-내구성>#</a></h4><p>메시지가 유실되지 않도록 내구성을 보장하는 방법:</p><ol><li><p><strong>지속적인 큐 선언</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-39-1><a class=lnlinks href=#hl-39-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>channel</span><span class=p>.</span><span class=na>queueDeclare</span><span class=p>(</span><span class=n>QUEUE_NAME</span><span class=p>,</span><span class=w> </span><span class=kc>true</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>);</span><span class=w>  </span><span class=c1>// durable=true</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>지속적인 메시지 발행</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-40-1><a class=lnlinks href=#hl-40-1>1</a>
</span><span class=lnt id=hl-40-2><a class=lnlinks href=#hl-40-2>2</a>
</span><span class=lnt id=hl-40-3><a class=lnlinks href=#hl-40-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>channel</span><span class=p>.</span><span class=na>basicPublish</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=n>QUEUE_NAME</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>MessageProperties</span><span class=p>.</span><span class=na>PERSISTENT_TEXT_PLAIN</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>message</span><span class=p>.</span><span class=na>getBytes</span><span class=p>());</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>메시지 확인(Acknowledge)</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-41-1><a class=lnlinks href=#hl-41-1>1</a>
</span><span class=lnt id=hl-41-2><a class=lnlinks href=#hl-41-2>2</a>
</span><span class=lnt id=hl-41-3><a class=lnlinks href=#hl-41-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>channel</span><span class=p>.</span><span class=na>basicConsume</span><span class=p>(</span><span class=n>QUEUE_NAME</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=n>deliverCallback</span><span class=p>,</span><span class=w> </span><span class=n>consumerTag</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 처리 후 명시적으로 확인</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>channel</span><span class=p>.</span><span class=na>basicAck</span><span class=p>(</span><span class=n>delivery</span><span class=p>.</span><span class=na>getEnvelope</span><span class=p>().</span><span class=na>getDeliveryTag</span><span class=p>(),</span><span class=w> </span><span class=kc>false</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ol><h4 id=메시지-제어>메시지 제어<a hidden class=anchor aria-hidden=true href=#메시지-제어>#</a></h4><h5 id=프리페치-카운트prefetch-count>프리페치 카운트(Prefetch Count)<a hidden class=anchor aria-hidden=true href=#프리페치-카운트prefetch-count>#</a></h5><p>한 번에 처리할 수 있는 메시지 수를 제한한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-42-1><a class=lnlinks href=#hl-42-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>channel</span><span class=p>.</span><span class=na>basicQos</span><span class=p>(</span><span class=n>1</span><span class=p>);</span><span class=w>  </span><span class=c1>// 한 번에 하나의 메시지만 처리</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=메시지-ttltime-to-live>메시지 TTL(Time to Live)<a hidden class=anchor aria-hidden=true href=#메시지-ttltime-to-live>#</a></h5><p>메시지의 유효 기간을 설정한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-43-1><a class=lnlinks href=#hl-43-1>1</a>
</span><span class=lnt id=hl-43-2><a class=lnlinks href=#hl-43-2>2</a>
</span><span class=lnt id=hl-43-3><a class=lnlinks href=#hl-43-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>&gt;</span><span class=w> </span><span class=n>args</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>HashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>args</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;x-message-ttl&#34;</span><span class=p>,</span><span class=w> </span><span class=n>60000</span><span class=p>);</span><span class=w>  </span><span class=c1>// 60초 후 만료</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>channel</span><span class=p>.</span><span class=na>queueDeclare</span><span class=p>(</span><span class=n>QUEUE_NAME</span><span class=p>,</span><span class=w> </span><span class=kc>true</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=n>args</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=데드-레터-익스체인지dead-letter-exchange>데드 레터 익스체인지(Dead Letter Exchange)<a hidden class=anchor aria-hidden=true href=#데드-레터-익스체인지dead-letter-exchange>#</a></h5><p>처리할 수 없는 메시지를 특별한 큐로 보낸다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-44-1><a class=lnlinks href=#hl-44-1>1</a>
</span><span class=lnt id=hl-44-2><a class=lnlinks href=#hl-44-2>2</a>
</span><span class=lnt id=hl-44-3><a class=lnlinks href=#hl-44-3>3</a>
</span><span class=lnt id=hl-44-4><a class=lnlinks href=#hl-44-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>&gt;</span><span class=w> </span><span class=n>args</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>HashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>args</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;x-dead-letter-exchange&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;dead-letter-exchange&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>args</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;x-dead-letter-routing-key&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;dead-letter&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>channel</span><span class=p>.</span><span class=na>queueDeclare</span><span class=p>(</span><span class=n>QUEUE_NAME</span><span class=p>,</span><span class=w> </span><span class=kc>true</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=n>args</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=교환기-유형과-바인딩-전략>교환기 유형과 바인딩 전략<a hidden class=anchor aria-hidden=true href=#교환기-유형과-바인딩-전략>#</a></h4><h5 id=direct-exchange>Direct Exchange<a hidden class=anchor aria-hidden=true href=#direct-exchange>#</a></h5><p>정확한 라우팅 키 일치에 기반한 라우팅:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-45-1><a class=lnlinks href=#hl-45-1>1</a>
</span><span class=lnt id=hl-45-2><a class=lnlinks href=#hl-45-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>channel</span><span class=p>.</span><span class=na>exchangeDeclare</span><span class=p>(</span><span class=s>&#34;direct_logs&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;direct&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>channel</span><span class=p>.</span><span class=na>queueBind</span><span class=p>(</span><span class=n>queueName</span><span class=p>,</span><span class=w> </span><span class=s>&#34;direct_logs&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;error&#34;</span><span class=p>);</span><span class=w>  </span><span class=c1>// error 메시지만 수신</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=topic-exchange>Topic Exchange<a hidden class=anchor aria-hidden=true href=#topic-exchange>#</a></h5><p>패턴 매칭을 사용한 라우팅:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-46-1><a class=lnlinks href=#hl-46-1>1</a>
</span><span class=lnt id=hl-46-2><a class=lnlinks href=#hl-46-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>channel</span><span class=p>.</span><span class=na>exchangeDeclare</span><span class=p>(</span><span class=s>&#34;topic_logs&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;topic&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>channel</span><span class=p>.</span><span class=na>queueBind</span><span class=p>(</span><span class=n>queueName</span><span class=p>,</span><span class=w> </span><span class=s>&#34;topic_logs&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;kern.*&#34;</span><span class=p>);</span><span class=w>  </span><span class=c1>// kern으로 시작하는 모든 메시지</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>패턴에서:</p><ul><li><code>*</code>: 정확히 하나의 단어와 일치</li><li><code>#</code>: 0개 이상의 단어와 일치</li></ul><h5 id=headers-exchange>Headers Exchange<a hidden class=anchor aria-hidden=true href=#headers-exchange>#</a></h5><p>메시지 헤더에 기반한 라우팅:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-47-1><a class=lnlinks href=#hl-47-1>1</a>
</span><span class=lnt id=hl-47-2><a class=lnlinks href=#hl-47-2>2</a>
</span><span class=lnt id=hl-47-3><a class=lnlinks href=#hl-47-3>3</a>
</span><span class=lnt id=hl-47-4><a class=lnlinks href=#hl-47-4>4</a>
</span><span class=lnt id=hl-47-5><a class=lnlinks href=#hl-47-5>5</a>
</span><span class=lnt id=hl-47-6><a class=lnlinks href=#hl-47-6>6</a>
</span><span class=lnt id=hl-47-7><a class=lnlinks href=#hl-47-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>channel</span><span class=p>.</span><span class=na>exchangeDeclare</span><span class=p>(</span><span class=s>&#34;header_exchange&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;headers&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>&gt;</span><span class=w> </span><span class=n>bindingArgs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>HashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>bindingArgs</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;x-match&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;all&#34;</span><span class=p>);</span><span class=w>  </span><span class=c1>// all: 모든 헤더 일치, any: 하나라도 일치</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>bindingArgs</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;format&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;pdf&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>bindingArgs</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;type&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;report&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>channel</span><span class=p>.</span><span class=na>queueBind</span><span class=p>(</span><span class=n>queueName</span><span class=p>,</span><span class=w> </span><span class=s>&#34;header_exchange&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=n>bindingArgs</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=플러그인을-통한-기능-확장>플러그인을 통한 기능 확장<a hidden class=anchor aria-hidden=true href=#플러그인을-통한-기능-확장>#</a></h4><p>RabbitMQ는 플러그인을 통해 기능을 확장할 수 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-48-1><a class=lnlinks href=#hl-48-1>1</a>
</span><span class=lnt id=hl-48-2><a class=lnlinks href=#hl-48-2>2</a>
</span><span class=lnt id=hl-48-3><a class=lnlinks href=#hl-48-3>3</a>
</span><span class=lnt id=hl-48-4><a class=lnlinks href=#hl-48-4>4</a>
</span><span class=lnt id=hl-48-5><a class=lnlinks href=#hl-48-5>5</a>
</span><span class=lnt id=hl-48-6><a class=lnlinks href=#hl-48-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 플러그인 목록 보기</span>
</span></span><span class=line><span class=cl>rabbitmq-plugins list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 플러그인 활성화</span>
</span></span><span class=line><span class=cl>rabbitmq-plugins <span class=nb>enable</span> rabbitmq_shovel
</span></span><span class=line><span class=cl>rabbitmq-plugins <span class=nb>enable</span> rabbitmq_delayed_message_exchange
</span></span></code></pre></td></tr></table></div></div><p>유용한 플러그인:</p><ul><li><code>rabbitmq_management</code>: 웹 기반 관리 인터페이스</li><li><code>rabbitmq_shovel</code>: 브로커 간 메시지 전송</li><li><code>rabbitmq_federation</code>: 브로커 간 토폴로지 연결</li><li><code>rabbitmq_delayed_message_exchange</code>: 지연 메시지 전송</li><li><code>rabbitmq_mqtt</code>: MQTT 프로토콜 지원</li><li><code>rabbitmq_web_stomp</code>: WebSocket을 통한 STOMP 지원</li></ul><h3 id=최적화-및-모니터링>최적화 및 모니터링<a hidden class=anchor aria-hidden=true href=#최적화-및-모니터링>#</a></h3><h2 id=61-성능-튜닝>6.1 성능 튜닝<a hidden class=anchor aria-hidden=true href=#61-성능-튜닝>#</a></h2><h3 id=611-메모리-관리>6.1.1 메모리 관리<a hidden class=anchor aria-hidden=true href=#611-메모리-관리>#</a></h3><p>RabbitMQ는 기본적으로 사용 가능한 시스템 메모리의 40%를 사용하도록 설정되어 있습니다. 이 값은 조정 가능합니다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-49-1><a class=lnlinks href=#hl-49-1>1</a>
</span><span class=lnt id=hl-49-2><a class=lnlinks href=#hl-49-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rabbitmq.conf
</span></span><span class=line><span class=cl>vm_memory_high_watermark.relative = 0.6  # 메모리의 60%까지 사용
</span></span></code></pre></td></tr></table></div></div><p>또는 절대값으로 설정:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-50-1><a class=lnlinks href=#hl-50-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>vm_memory_high_watermark.absolute = 2GB
</span></span></code></pre></td></tr></table></div></div><h3 id=612-디스크-공간-관리>6.1.2 디스크 공간 관리<a hidden class=anchor aria-hidden=true href=#612-디스크-공간-관리>#</a></h3><p>RabbitMQ는 디스크 공간이 부족하면 메시지 수락을 중지합니다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-51-1><a class=lnlinks href=#hl-51-1>1</a>
</span><span class=lnt id=hl-51-2><a class=lnlinks href=#hl-51-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rabbitmq.conf
</span></span><span class=line><span class=cl>disk_free_limit.absolute = 5GB
</span></span></code></pre></td></tr></table></div></div><h3 id=613-큐-최적화>6.1.3 큐 최적화<a hidden class=anchor aria-hidden=true href=#613-큐-최적화>#</a></h3><p>큐 타입과 큐 인자를 사용하여 성능을 최적화할 수 있습니다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-52-1><a class=lnlinks href=#hl-52-1>1</a>
</span><span class=lnt id=hl-52-2><a class=lnlinks href=#hl-52-2>2</a>
</span><span class=lnt id=hl-52-3><a class=lnlinks href=#hl-52-3>3</a>
</span><span class=lnt id=hl-52-4><a class=lnlinks href=#hl-52-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>&gt;</span><span class=w> </span><span class=n>args</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>HashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>args</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;x-queue-type&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;quorum&#34;</span><span class=p>);</span><span class=w>  </span><span class=c1>// 쿼럼 큐 사용 (3.8 이상)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>args</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;x-max-length&#34;</span><span class=p>,</span><span class=w> </span><span class=n>10000</span><span class=p>);</span><span class=w>     </span><span class=c1>// 큐 길이 제한</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>channel</span><span class=p>.</span><span class=na>queueDeclare</span><span class=p>(</span><span class=n>QUEUE_NAME</span><span class=p>,</span><span class=w> </span><span class=kc>true</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=n>args</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=614-채널-및-연결-관리>6.1.4 채널 및 연결 관리<a hidden class=anchor aria-hidden=true href=#614-채널-및-연결-관리>#</a></h3><ul><li>채널을 재사용하세요 (생성 비용이 높음)</li><li>필요 이상으로 많은 연결을 맺지 마세요</li><li>연결 풀을 사용하여 효율적으로 관리하세요</li></ul><h3 id=615-배치-처리>6.1.5 배치 처리<a hidden class=anchor aria-hidden=true href=#615-배치-처리>#</a></h3><p>성능을 위해 메시지를 배치로 발행하고 소비합니다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-53-1><a class=lnlinks href=#hl-53-1>1</a>
</span><span class=lnt id=hl-53-2><a class=lnlinks href=#hl-53-2>2</a>
</span><span class=lnt id=hl-53-3><a class=lnlinks href=#hl-53-3>3</a>
</span><span class=lnt id=hl-53-4><a class=lnlinks href=#hl-53-4>4</a>
</span><span class=lnt id=hl-53-5><a class=lnlinks href=#hl-53-5>5</a>
</span><span class=lnt id=hl-53-6><a class=lnlinks href=#hl-53-6>6</a>
</span><span class=lnt id=hl-53-7><a class=lnlinks href=#hl-53-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 배치 발행</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>batchSize</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>channel</span><span class=p>.</span><span class=na>basicPublish</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=n>QUEUE_NAME</span><span class=p>,</span><span class=w> </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>messages</span><span class=o>[</span><span class=n>i</span><span class=o>]</span><span class=p>.</span><span class=na>getBytes</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 배치 소비</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>channel</span><span class=p>.</span><span class=na>basicQos</span><span class=p>(</span><span class=n>100</span><span class=p>);</span><span class=w>  </span><span class=c1>// 한 번에 100개 메시지 처리</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=62-모니터링>6.2 모니터링<a hidden class=anchor aria-hidden=true href=#62-모니터링>#</a></h2><h3 id=621-관리-ui-사용>6.2.1 관리 UI 사용<a hidden class=anchor aria-hidden=true href=#621-관리-ui-사용>#</a></h3><p>웹 관리 인터페이스(<a href=http://localhost:15672>http://localhost:15672</a>)에서> 다양한 메트릭을 모니터링할 수 있습니다:</p><ul><li>큐, 연결, 채널 상태</li><li>메시지 처리량</li><li>노드 자원 사용량</li><li>클러스터 상태</li></ul><h3 id=622-http-api-사용>6.2.2 HTTP API 사용<a hidden class=anchor aria-hidden=true href=#622-http-api-사용>#</a></h3><p>HTTP API를 통해 프로그래밍 방식으로 모니터링할 수 있습니다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-54-1><a class=lnlinks href=#hl-54-1>1</a>
</span><span class=lnt id=hl-54-2><a class=lnlinks href=#hl-54-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 큐 상태 확인</span>
</span></span><span class=line><span class=cl>curl -u guest:guest http://localhost:15672/api/queues/%2F/my_queue
</span></span></code></pre></td></tr></table></div></div><h3 id=623-prometheus-및-grafana-통합>6.2.3 Prometheus 및 Grafana 통합<a hidden class=anchor aria-hidden=true href=#623-prometheus-및-grafana-통합>#</a></h3><p>RabbitMQ Prometheus 플러그인을 사용하여 더 강력한 모니터링을 구성할 수 있습니다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-55-1><a class=lnlinks href=#hl-55-1>1</a>
</span><span class=lnt id=hl-55-2><a class=lnlinks href=#hl-55-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Prometheus 플러그인 활성화</span>
</span></span><span class=line><span class=cl>rabbitmq-plugins <span class=nb>enable</span> rabbitmq_prometheus
</span></span></code></pre></td></tr></table></div></div><p>Prometheus 설정:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-56-1><a class=lnlinks href=#hl-56-1>1</a>
</span><span class=lnt id=hl-56-2><a class=lnlinks href=#hl-56-2>2</a>
</span><span class=lnt id=hl-56-3><a class=lnlinks href=#hl-56-3>3</a>
</span><span class=lnt id=hl-56-4><a class=lnlinks href=#hl-56-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;rabbitmq&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;rabbitmq:15692&#39;</span><span class=p>]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>그런 다음 Grafana에서 RabbitMQ 대시보드를 가져와 사용할 수 있습니다.</p><h2 id=63-성능-테스트>6.3 성능 테스트<a hidden class=anchor aria-hidden=true href=#63-성능-테스트>#</a></h2><p>PerfTest 도구를 사용하여 RabbitMQ 성능을 테스트할 수 있습니다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-57-1><a class=lnlinks href=#hl-57-1>1</a>
</span><span class=lnt id=hl-57-2><a class=lnlinks href=#hl-57-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 성능 테스트 실행</span>
</span></span><span class=line><span class=cl>./runjava com.rabbitmq.perf.PerfTest -h amqp://localhost -x <span class=m>1</span> -y <span class=m>1</span> -u <span class=s2>&#34;throughput-test&#34;</span> -a --id <span class=s2>&#34;test 1&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>중요한 성능 지표:</p><ul><li>초당 메시지 수</li><li>소비자 및 생산자 지연 시간</li><li>메모리 및 CPU 사용량</li><li>디스크 I/O</li></ul><h3 id=rabbitmq의-장애-처리-및-고가용성>RabbitMQ의 장애 처리 및 고가용성<a hidden class=anchor aria-hidden=true href=#rabbitmq의-장애-처리-및-고가용성>#</a></h3><h4 id=장애-시나리오-및-처리>장애 시나리오 및 처리<a hidden class=anchor aria-hidden=true href=#장애-시나리오-및-처리>#</a></h4><h5 id=브로커-장애>브로커 장애<a hidden class=anchor aria-hidden=true href=#브로커-장애>#</a></h5><p>브로커 노드가 실패할 경우 클러스터의 다른 노드가 작업을 인계받는다. 미러링된 큐를 사용하면 데이터 손실을 방지할 수 있다. 미러링 큐는 모든 메시지의 복사본을 여러 노드에 유지하여 노드 장애 시에도 메시지를 사용할 수 있게 한다.</p><p>RabbitMQ 3.8 이후 버전에서는 쿼럼 큐(Quorum Queues)라는 새로운 고가용성 큐 타입을 제공한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-58-1><a class=lnlinks href=#hl-58-1>1</a>
</span><span class=lnt id=hl-58-2><a class=lnlinks href=#hl-58-2>2</a>
</span><span class=lnt id=hl-58-3><a class=lnlinks href=#hl-58-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>&gt;</span><span class=w> </span><span class=n>args</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>HashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>args</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;x-queue-type&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;quorum&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>channel</span><span class=p>.</span><span class=na>queueDeclare</span><span class=p>(</span><span class=s>&#34;ha-queue&#34;</span><span class=p>,</span><span class=w> </span><span class=kc>true</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=n>args</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>쿼럼 큐는 Raft 합의 프로토콜을 사용하여 더 강력한 일관성과 내결함성을 제공한다.</p><h5 id=네트워크-분할>네트워크 분할<a hidden class=anchor aria-hidden=true href=#네트워크-분할>#</a></h5><p>네트워크 분할(Network Partition) 또는 &ldquo;브레인 스플릿(Brain Split)&ldquo;이 발생하면 RabbitMQ 클러스터가 여러 부분으로 나뉘어 각각 독립적으로 작동하게 된다. 이 문제를 해결하기 위한 정책을 구성할 수 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-59-1><a class=lnlinks href=#hl-59-1>1</a>
</span><span class=lnt id=hl-59-2><a class=lnlinks href=#hl-59-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rabbitmq.conf
</span></span><span class=line><span class=cl>cluster_partition_handling = autoheal  # 자동 복구 모드
</span></span></code></pre></td></tr></table></div></div><p>가능한 설정:</p><ul><li><code>ignore</code>: 분할을 무시하고 각 부분이 독립적으로 작동</li><li><code>autoheal</code>: 자동으로 복구 시도 (소수 파티션을 재시작)</li><li><code>pause_minority</code>: 소수 파티션 노드를 일시 중지</li></ul><h5 id=디스크-공간-부족>디스크 공간 부족<a hidden class=anchor aria-hidden=true href=#디스크-공간-부족>#</a></h5><p>디스크 공간이 부족하면 RabbitMQ는 새 메시지의 수락을 중지한다.</p><p>이를 위한 조치:</p><ul><li>중요하지 않은 메시지 제거</li><li>오래된 메시지 제거를 위한 TTL 설정</li><li>디스크 경보 임계값 조정</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-60-1><a class=lnlinks href=#hl-60-1>1</a>
</span><span class=lnt id=hl-60-2><a class=lnlinks href=#hl-60-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 디스크 경보 임계값 조정</span>
</span></span><span class=line><span class=cl>rabbitmqctl set_disk_free_limit 5GB
</span></span></code></pre></td></tr></table></div></div><h5 id=메모리-경보>메모리 경보<a hidden class=anchor aria-hidden=true href=#메모리-경보>#</a></h5><p>메모리 사용량이 높으면 RabbitMQ는 생산자의 속도를 제한한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-61-1><a class=lnlinks href=#hl-61-1>1</a>
</span><span class=lnt id=hl-61-2><a class=lnlinks href=#hl-61-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 메모리 경보 임계값 조정</span>
</span></span><span class=line><span class=cl>rabbitmqctl set_vm_memory_high_watermark 0.6
</span></span></code></pre></td></tr></table></div></div><h4 id=고가용성-구성>고가용성 구성<a hidden class=anchor aria-hidden=true href=#고가용성-구성>#</a></h4><h5 id=클러스터링>클러스터링<a hidden class=anchor aria-hidden=true href=#클러스터링>#</a></h5><p>기본 RabbitMQ 클러스터는 메타데이터를 복제하지만 큐의 내용은 복제하지 않는다. 높은 가용성을 위해서는 미러링 큐나 쿼럼 큐를 사용해야 한다.</p><h5 id=미러링-큐-정책>미러링 큐 정책<a hidden class=anchor aria-hidden=true href=#미러링-큐-정책>#</a></h5><p>관리 UI 또는 CLI를 통해 미러링 정책을 설정할 수 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-62-1><a class=lnlinks href=#hl-62-1>1</a>
</span><span class=lnt id=hl-62-2><a class=lnlinks href=#hl-62-2>2</a>
</span><span class=lnt id=hl-62-3><a class=lnlinks href=#hl-62-3>3</a>
</span><span class=lnt id=hl-62-4><a class=lnlinks href=#hl-62-4>4</a>
</span><span class=lnt id=hl-62-5><a class=lnlinks href=#hl-62-5>5</a>
</span><span class=lnt id=hl-62-6><a class=lnlinks href=#hl-62-6>6</a>
</span><span class=lnt id=hl-62-7><a class=lnlinks href=#hl-62-7>7</a>
</span><span class=lnt id=hl-62-8><a class=lnlinks href=#hl-62-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 모든 큐를 모든 노드에 미러링</span>
</span></span><span class=line><span class=cl>rabbitmqctl set_policy ha-all <span class=s2>&#34;.*&#34;</span> <span class=s1>&#39;{&#34;ha-mode&#34;:&#34;all&#34;}&#39;</span> --apply-to queues
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 모든 큐를 특정 수의 노드에 미러링</span>
</span></span><span class=line><span class=cl>rabbitmqctl set_policy ha-two <span class=s2>&#34;.*&#34;</span> <span class=s1>&#39;{&#34;ha-mode&#34;:&#34;exactly&#34;,&#34;ha-params&#34;:2}&#39;</span> --apply-to queues
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 대기열 이름이 &#34;ha.&#34;로 시작하는 큐만 미러링</span>
</span></span><span class=line><span class=cl>rabbitmqctl set_policy ha-match <span class=s2>&#34;^ha\.&#34;</span> <span class=s1>&#39;{&#34;ha-mode&#34;:&#34;all&#34;}&#39;</span> --apply-to queues
</span></span></code></pre></td></tr></table></div></div><h5 id=쿼럼-큐>쿼럼 큐<a hidden class=anchor aria-hidden=true href=#쿼럼-큐>#</a></h5><p>쿼럼 큐는 Raft 합의 알고리즘을 사용하여 메시지의 일관성을 보장한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-63-1><a class=lnlinks href=#hl-63-1>1</a>
</span><span class=lnt id=hl-63-2><a class=lnlinks href=#hl-63-2>2</a>
</span><span class=lnt id=hl-63-3><a class=lnlinks href=#hl-63-3>3</a>
</span><span class=lnt id=hl-63-4><a class=lnlinks href=#hl-63-4>4</a>
</span><span class=lnt id=hl-63-5><a class=lnlinks href=#hl-63-5>5</a>
</span><span class=lnt id=hl-63-6><a class=lnlinks href=#hl-63-6>6</a>
</span><span class=lnt id=hl-63-7><a class=lnlinks href=#hl-63-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 쿼럼 큐 선언 (클라이언트에서)</span>
</span></span><span class=line><span class=cl>Map&lt;String, Object&gt; <span class=nv>args</span> <span class=o>=</span> new HashMap&lt;&gt;<span class=o>()</span><span class=p>;</span>
</span></span><span class=line><span class=cl>args.put<span class=o>(</span><span class=s2>&#34;x-queue-type&#34;</span>, <span class=s2>&#34;quorum&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>channel.queueDeclare<span class=o>(</span><span class=s2>&#34;critical-queue&#34;</span>, true, false, false, args<span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 또는 정책을 통해 설정</span>
</span></span><span class=line><span class=cl>rabbitmqctl set_policy quorum-queues <span class=s2>&#34;^critical\.&#34;</span> <span class=s1>&#39;{&#34;x-queue-type&#34;:&#34;quorum&#34;}&#39;</span> --apply-to queues
</span></span></code></pre></td></tr></table></div></div><p>쿼럼 큐의 특징:</p><ul><li>강력한 내구성과 일관성</li><li>브로커 장애에 더 잘 대응</li><li>제한된 기능 (예: 임시 큐 지원 안 함)</li><li>미러링 큐보다 더 효율적인 리소스 사용</li></ul><h5 id=가용성-영역-간-배포>가용성 영역 간 배포<a hidden class=anchor aria-hidden=true href=#가용성-영역-간-배포>#</a></h5><p>클라우드 환경에서는 여러 가용성 영역(AZ)에 걸쳐 RabbitMQ 노드를 배포하여 전체 AZ 장애에도 서비스를 유지할 수 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-64-1><a class=lnlinks href=#hl-64-1>1</a>
</span><span class=lnt id=hl-64-2><a class=lnlinks href=#hl-64-2>2</a>
</span><span class=lnt id=hl-64-3><a class=lnlinks href=#hl-64-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>노드 1: AZ-1
</span></span><span class=line><span class=cl>노드 2: AZ-2
</span></span><span class=line><span class=cl>노드 3: AZ-3
</span></span></code></pre></td></tr></table></div></div><p>이 설정은 AZ 간 네트워크 지연을 고려해야 한다.</p><h5 id=페더레이션-플러그인>페더레이션 플러그인<a hidden class=anchor aria-hidden=true href=#페더레이션-플러그인>#</a></h5><p>federation 플러그인을 사용하면 지역적으로 분산된 브로커 간에 메시지를 전달할 수 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-65-1><a class=lnlinks href=#hl-65-1>1</a>
</span><span class=lnt id=hl-65-2><a class=lnlinks href=#hl-65-2>2</a>
</span><span class=lnt id=hl-65-3><a class=lnlinks href=#hl-65-3>3</a>
</span><span class=lnt id=hl-65-4><a class=lnlinks href=#hl-65-4>4</a>
</span><span class=lnt id=hl-65-5><a class=lnlinks href=#hl-65-5>5</a>
</span><span class=lnt id=hl-65-6><a class=lnlinks href=#hl-65-6>6</a>
</span><span class=lnt id=hl-65-7><a class=lnlinks href=#hl-65-7>7</a>
</span><span class=lnt id=hl-65-8><a class=lnlinks href=#hl-65-8>8</a>
</span><span class=lnt id=hl-65-9><a class=lnlinks href=#hl-65-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 페더레이션 플러그인 활성화</span>
</span></span><span class=line><span class=cl>rabbitmq-plugins <span class=nb>enable</span> rabbitmq_federation
</span></span><span class=line><span class=cl>rabbitmq-plugins <span class=nb>enable</span> rabbitmq_federation_management
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 업스트림 설정</span>
</span></span><span class=line><span class=cl>rabbitmqctl set_parameter federation-upstream my-upstream <span class=s1>&#39;{&#34;uri&#34;:&#34;amqp://remote-host&#34;}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 정책 설정</span>
</span></span><span class=line><span class=cl>rabbitmqctl set_policy federate-me <span class=s2>&#34;^federated\.&#34;</span> <span class=s1>&#39;{&#34;federation-upstream-set&#34;:&#34;all&#34;}&#39;</span> --apply-to exchanges
</span></span></code></pre></td></tr></table></div></div><h4 id=백업-및-복구-전략>백업 및 복구 전략<a hidden class=anchor aria-hidden=true href=#백업-및-복구-전략>#</a></h4><h5 id=정의-백업>정의 백업<a hidden class=anchor aria-hidden=true href=#정의-백업>#</a></h5><p>RabbitMQ의 토폴로지 정의(exchanges, queues, bindings, policies)를 백업하는 것이 중요하다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-66-1><a class=lnlinks href=#hl-66-1>1</a>
</span><span class=lnt id=hl-66-2><a class=lnlinks href=#hl-66-2>2</a>
</span><span class=lnt id=hl-66-3><a class=lnlinks href=#hl-66-3>3</a>
</span><span class=lnt id=hl-66-4><a class=lnlinks href=#hl-66-4>4</a>
</span><span class=lnt id=hl-66-5><a class=lnlinks href=#hl-66-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 정의 내보내기</span>
</span></span><span class=line><span class=cl>rabbitmqctl export_definitions /path/to/definitions.json
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 정의 가져오기</span>
</span></span><span class=line><span class=cl>rabbitmqctl import_definitions /path/to/definitions.json
</span></span></code></pre></td></tr></table></div></div><h5 id=메시지-백업>메시지 백업<a hidden class=anchor aria-hidden=true href=#메시지-백업>#</a></h5><p>메시지 백업을 위한 몇 가지 전략:</p><ul><li>쇼벨 플러그인을 사용하여 중요한 메시지를 백업 큐로 복사</li><li>중요한 메시지를 소비하여 외부 스토리지에 저장</li><li>미러링 큐 사용으로 메시지 복제</li></ul><h3 id=보안-및-인증>보안 및 인증<a hidden class=anchor aria-hidden=true href=#보안-및-인증>#</a></h3><h4 id=사용자-관리-및-권한>사용자 관리 및 권한<a hidden class=anchor aria-hidden=true href=#사용자-관리-및-권한>#</a></h4><p>RabbitMQ는 사용자 계정과 권한을 관리하는 기본 시스템을 제공한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-67-1><a class=lnlinks href=#hl-67-1>1</a>
</span><span class=lnt id=hl-67-2><a class=lnlinks href=#hl-67-2>2</a>
</span><span class=lnt id=hl-67-3><a class=lnlinks href=#hl-67-3>3</a>
</span><span class=lnt id=hl-67-4><a class=lnlinks href=#hl-67-4>4</a>
</span><span class=lnt id=hl-67-5><a class=lnlinks href=#hl-67-5>5</a>
</span><span class=lnt id=hl-67-6><a class=lnlinks href=#hl-67-6>6</a>
</span><span class=lnt id=hl-67-7><a class=lnlinks href=#hl-67-7>7</a>
</span><span class=lnt id=hl-67-8><a class=lnlinks href=#hl-67-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 사용자 생성</span>
</span></span><span class=line><span class=cl>rabbitmqctl add_user myuser mypassword
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 태그 설정 (관리자, 모니터링 등)</span>
</span></span><span class=line><span class=cl>rabbitmqctl set_user_tags myuser administrator
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 권한 설정 (vhost, configure, write, read)</span>
</span></span><span class=line><span class=cl>rabbitmqctl set_permissions -p / myuser <span class=s2>&#34;.*&#34;</span> <span class=s2>&#34;.*&#34;</span> <span class=s2>&#34;.*&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>권한 패턴은 정규식을 사용하여 리소스에 대한 액세스를 제어한다:</p><ul><li>Configure: 리소스 생성 및 삭제</li><li>Write: 메시지 발행</li><li>Read: 메시지 소비</li></ul><h4 id=ssltls-구성>SSL/TLS 구성<a hidden class=anchor aria-hidden=true href=#ssltls-구성>#</a></h4><p>보안 통신을 위해 SSL/TLS를 구성할 수 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-68-1><a class=lnlinks href=#hl-68-1>1</a>
</span><span class=lnt id=hl-68-2><a class=lnlinks href=#hl-68-2>2</a>
</span><span class=lnt id=hl-68-3><a class=lnlinks href=#hl-68-3>3</a>
</span><span class=lnt id=hl-68-4><a class=lnlinks href=#hl-68-4>4</a>
</span><span class=lnt id=hl-68-5><a class=lnlinks href=#hl-68-5>5</a>
</span><span class=lnt id=hl-68-6><a class=lnlinks href=#hl-68-6>6</a>
</span><span class=lnt id=hl-68-7><a class=lnlinks href=#hl-68-7>7</a>
</span><span class=lnt id=hl-68-8><a class=lnlinks href=#hl-68-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rabbitmq.conf
</span></span><span class=line><span class=cl>ssl_options.cacertfile = /path/to/ca_certificate.pem
</span></span><span class=line><span class=cl>ssl_options.certfile = /path/to/server_certificate.pem
</span></span><span class=line><span class=cl>ssl_options.keyfile = /path/to/server_key.pem
</span></span><span class=line><span class=cl>ssl_options.verify = verify_peer
</span></span><span class=line><span class=cl>ssl_options.fail_if_no_peer_cert = true
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>listeners.ssl.default = 5671
</span></span></code></pre></td></tr></table></div></div><p>클라이언트 측 설정:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-69-1><a class=lnlinks href=#hl-69-1>1</a>
</span><span class=lnt id=hl-69-2><a class=lnlinks href=#hl-69-2>2</a>
</span><span class=lnt id=hl-69-3><a class=lnlinks href=#hl-69-3>3</a>
</span><span class=lnt id=hl-69-4><a class=lnlinks href=#hl-69-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>ConnectionFactory</span><span class=w> </span><span class=n>factory</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ConnectionFactory</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>factory</span><span class=p>.</span><span class=na>setHost</span><span class=p>(</span><span class=s>&#34;localhost&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>factory</span><span class=p>.</span><span class=na>setPort</span><span class=p>(</span><span class=n>5671</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>factory</span><span class=p>.</span><span class=na>useSslProtocol</span><span class=p>(</span><span class=s>&#34;TLSv1.2&#34;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=ldap-통합>LDAP 통합<a hidden class=anchor aria-hidden=true href=#ldap-통합>#</a></h4><p>LDAP 플러그인을 사용하여 기존 디렉토리 서비스와 통합할 수 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-70-1><a class=lnlinks href=#hl-70-1>1</a>
</span><span class=lnt id=hl-70-2><a class=lnlinks href=#hl-70-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># LDAP 플러그인 활성화</span>
</span></span><span class=line><span class=cl>rabbitmq-plugins <span class=nb>enable</span> rabbitmq_auth_backend_ldap
</span></span></code></pre></td></tr></table></div></div><p>구성 예제:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-71-1><a class=lnlinks href=#hl-71-1> 1</a>
</span><span class=lnt id=hl-71-2><a class=lnlinks href=#hl-71-2> 2</a>
</span><span class=lnt id=hl-71-3><a class=lnlinks href=#hl-71-3> 3</a>
</span><span class=lnt id=hl-71-4><a class=lnlinks href=#hl-71-4> 4</a>
</span><span class=lnt id=hl-71-5><a class=lnlinks href=#hl-71-5> 5</a>
</span><span class=lnt id=hl-71-6><a class=lnlinks href=#hl-71-6> 6</a>
</span><span class=lnt id=hl-71-7><a class=lnlinks href=#hl-71-7> 7</a>
</span><span class=lnt id=hl-71-8><a class=lnlinks href=#hl-71-8> 8</a>
</span><span class=lnt id=hl-71-9><a class=lnlinks href=#hl-71-9> 9</a>
</span><span class=lnt id=hl-71-10><a class=lnlinks href=#hl-71-10>10</a>
</span><span class=lnt id=hl-71-11><a class=lnlinks href=#hl-71-11>11</a>
</span><span class=lnt id=hl-71-12><a class=lnlinks href=#hl-71-12>12</a>
</span><span class=lnt id=hl-71-13><a class=lnlinks href=#hl-71-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># rabbitmq.conf
</span></span><span class=line><span class=cl>auth_backends.1 = ldap
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># LDAP 서버 설정
</span></span><span class=line><span class=cl>auth_ldap.servers.1 = ldap.example.com
</span></span><span class=line><span class=cl>auth_ldap.port = 389
</span></span><span class=line><span class=cl>auth_ldap.user_dn_pattern = cn=${username},ou=People,dc=example,dc=com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 가상 호스트 액세스 제어
</span></span><span class=line><span class=cl>auth_ldap.vhost_access_query = {in_group, &#34;cn=rabbitmq,ou=Groups,dc=example,dc=com&#34;}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 태그 쿼리
</span></span><span class=line><span class=cl>auth_ldap.tag_queries.administrator = {in_group, &#34;cn=rabbitmq-admin,ou=Groups,dc=example,dc=com&#34;}
</span></span></code></pre></td></tr></table></div></div><h3 id=실무-적용-전략과-패턴>실무 적용 전략과 패턴<a hidden class=anchor aria-hidden=true href=#실무-적용-전략과-패턴>#</a></h3><h4 id=큐-설계-패턴>큐 설계 패턴<a hidden class=anchor aria-hidden=true href=#큐-설계-패턴>#</a></h4><h5 id=작업-큐-패턴>작업 큐 패턴<a hidden class=anchor aria-hidden=true href=#작업-큐-패턴>#</a></h5><p>시간이 오래 걸리는 작업을 비동기적으로 처리한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-72-1><a class=lnlinks href=#hl-72-1>1</a>
</span><span class=lnt id=hl-72-2><a class=lnlinks href=#hl-72-2>2</a>
</span><span class=lnt id=hl-72-3><a class=lnlinks href=#hl-72-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>클라이언트 -&gt; 작업 큐 -&gt; 워커 1
</span></span><span class=line><span class=cl>                     -&gt; 워커 2
</span></span><span class=line><span class=cl>                     -&gt; 워커 3
</span></span></code></pre></td></tr></table></div></div><p>구현 시 고려사항:</p><ul><li>작업 큐는 내구성이 있어야 함(durable)</li><li>메시지는 지속적이어야 함(persistent)</li><li>공정한 작업 분배를 위해 prefetch 설정</li><li>명시적인 확인(ack)으로 안전하게 처리</li></ul><h5 id=발행구독-패턴>발행/구독 패턴<a hidden class=anchor aria-hidden=true href=#발행구독-패턴>#</a></h5><p>이벤트를 여러 소비자에게 브로드캐스트한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-73-1><a class=lnlinks href=#hl-73-1>1</a>
</span><span class=lnt id=hl-73-2><a class=lnlinks href=#hl-73-2>2</a>
</span><span class=lnt id=hl-73-3><a class=lnlinks href=#hl-73-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>발행자 -&gt; Fanout Exchange -&gt; 큐 1 -&gt; 소비자 1
</span></span><span class=line><span class=cl>                          -&gt; 큐 2 -&gt; 소비자 2
</span></span><span class=line><span class=cl>                          -&gt; 큐 3 -&gt; 소비자 3
</span></span></code></pre></td></tr></table></div></div><p>사용 사례:</p><ul><li>로그 전파</li><li>실시간 업데이트</li><li>다중 시스템 동기화</li></ul><h5 id=요청응답-패턴>요청/응답 패턴<a hidden class=anchor aria-hidden=true href=#요청응답-패턴>#</a></h5><p>RPC 스타일 통신을 구현한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-74-1><a class=lnlinks href=#hl-74-1>1</a>
</span><span class=lnt id=hl-74-2><a class=lnlinks href=#hl-74-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>클라이언트 -&gt; 요청 큐 -&gt; 서버
</span></span><span class=line><span class=cl>         &lt;- 응답 큐 &lt;-
</span></span></code></pre></td></tr></table></div></div><p>구현:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-75-1><a class=lnlinks href=#hl-75-1> 1</a>
</span><span class=lnt id=hl-75-2><a class=lnlinks href=#hl-75-2> 2</a>
</span><span class=lnt id=hl-75-3><a class=lnlinks href=#hl-75-3> 3</a>
</span><span class=lnt id=hl-75-4><a class=lnlinks href=#hl-75-4> 4</a>
</span><span class=lnt id=hl-75-5><a class=lnlinks href=#hl-75-5> 5</a>
</span><span class=lnt id=hl-75-6><a class=lnlinks href=#hl-75-6> 6</a>
</span><span class=lnt id=hl-75-7><a class=lnlinks href=#hl-75-7> 7</a>
</span><span class=lnt id=hl-75-8><a class=lnlinks href=#hl-75-8> 8</a>
</span><span class=lnt id=hl-75-9><a class=lnlinks href=#hl-75-9> 9</a>
</span><span class=lnt id=hl-75-10><a class=lnlinks href=#hl-75-10>10</a>
</span><span class=lnt id=hl-75-11><a class=lnlinks href=#hl-75-11>11</a>
</span><span class=lnt id=hl-75-12><a class=lnlinks href=#hl-75-12>12</a>
</span><span class=lnt id=hl-75-13><a class=lnlinks href=#hl-75-13>13</a>
</span><span class=lnt id=hl-75-14><a class=lnlinks href=#hl-75-14>14</a>
</span><span class=lnt id=hl-75-15><a class=lnlinks href=#hl-75-15>15</a>
</span><span class=lnt id=hl-75-16><a class=lnlinks href=#hl-75-16>16</a>
</span><span class=lnt id=hl-75-17><a class=lnlinks href=#hl-75-17>17</a>
</span><span class=lnt id=hl-75-18><a class=lnlinks href=#hl-75-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 클라이언트 측</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>corrId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>UUID</span><span class=p>.</span><span class=na>randomUUID</span><span class=p>().</span><span class=na>toString</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>AMQP</span><span class=p>.</span><span class=na>BasicProperties</span><span class=w> </span><span class=n>props</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>AMQP</span><span class=p>.</span><span class=na>BasicProperties</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>Builder</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>correlationId</span><span class=p>(</span><span class=n>corrId</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>replyTo</span><span class=p>(</span><span class=n>replyQueueName</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>channel</span><span class=p>.</span><span class=na>basicPublish</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=n>requestQueueName</span><span class=p>,</span><span class=w> </span><span class=n>props</span><span class=p>,</span><span class=w> </span><span class=n>message</span><span class=p>.</span><span class=na>getBytes</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 서버 측</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=c1>// 요청 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>channel</span><span class=p>.</span><span class=na>basicPublish</span><span class=p>(</span><span class=s>&#34;&#34;</span><span class=p>,</span><span class=w> </span><span class=n>properties</span><span class=p>.</span><span class=na>getReplyTo</span><span class=p>(),</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>new</span><span class=w> </span><span class=n>AMQP</span><span class=p>.</span><span class=na>BasicProperties</span><span class=p>.</span><span class=na>Builder</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>correlationId</span><span class=p>(</span><span class=n>properties</span><span class=p>.</span><span class=na>getCorrelationId</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>.</span><span class=na>build</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>response</span><span class=p>.</span><span class=na>getBytes</span><span class=p>());</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=경쟁-소비자-패턴>경쟁 소비자 패턴<a hidden class=anchor aria-hidden=true href=#경쟁-소비자-패턴>#</a></h5><p>여러 소비자가 동일한 큐에서 메시지를 경쟁적으로 소비한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-76-1><a class=lnlinks href=#hl-76-1>1</a>
</span><span class=lnt id=hl-76-2><a class=lnlinks href=#hl-76-2>2</a>
</span><span class=lnt id=hl-76-3><a class=lnlinks href=#hl-76-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>생산자 -&gt; 큐 -&gt; 소비자 1
</span></span><span class=line><span class=cl>             -&gt; 소비자 2
</span></span><span class=line><span class=cl>             -&gt; 소비자 3
</span></span></code></pre></td></tr></table></div></div><p>이 패턴은 부하 분산에 유용하다. 각 메시지는 하나의 소비자에게만 전달된다.</p><h4 id=메시지-및-라우팅-전략>메시지 및 라우팅 전략<a hidden class=anchor aria-hidden=true href=#메시지-및-라우팅-전략>#</a></h4><h5 id=콘텐츠-기반-라우팅>콘텐츠 기반 라우팅<a hidden class=anchor aria-hidden=true href=#콘텐츠-기반-라우팅>#</a></h5><p>메시지 내용에 따라 다른 큐로 라우팅한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-77-1><a class=lnlinks href=#hl-77-1>1</a>
</span><span class=lnt id=hl-77-2><a class=lnlinks href=#hl-77-2>2</a>
</span><span class=lnt id=hl-77-3><a class=lnlinks href=#hl-77-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>생산자 -&gt; Topic Exchange -&gt; Routing Pattern &#34;*.error&#34; -&gt; 오류 처리 큐
</span></span><span class=line><span class=cl>                         -&gt; Routing Pattern &#34;*.warning&#34; -&gt; 경고 처리 큐
</span></span><span class=line><span class=cl>                         -&gt; Routing Pattern &#34;*.info&#34; -&gt; 정보 처리 큐
</span></span></code></pre></td></tr></table></div></div><h5 id=계층적-토픽>계층적 토픽<a hidden class=anchor aria-hidden=true href=#계층적-토픽>#</a></h5><p>계층적 구조를 사용하여 메시지를 조직한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-78-1><a class=lnlinks href=#hl-78-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>region.service.severity
</span></span></code></pre></td></tr></table></div></div><p>예:</p><ul><li><code>us-east.orders.error</code>: 미국 동부 지역의 주문 서비스 오류</li><li><code>eu-west.payments.info</code>: EU 서부 지역의 결제 서비스 정보</li></ul><h5 id=시간-지연-메시지>시간 지연 메시지<a hidden class=anchor aria-hidden=true href=#시간-지연-메시지>#</a></h5><p>scheduled-messages 플러그인 또는 TTL과 데드 레터 교환기를 사용하여 지연된 처리를 구현한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-79-1><a class=lnlinks href=#hl-79-1> 1</a>
</span><span class=lnt id=hl-79-2><a class=lnlinks href=#hl-79-2> 2</a>
</span><span class=lnt id=hl-79-3><a class=lnlinks href=#hl-79-3> 3</a>
</span><span class=lnt id=hl-79-4><a class=lnlinks href=#hl-79-4> 4</a>
</span><span class=lnt id=hl-79-5><a class=lnlinks href=#hl-79-5> 5</a>
</span><span class=lnt id=hl-79-6><a class=lnlinks href=#hl-79-6> 6</a>
</span><span class=lnt id=hl-79-7><a class=lnlinks href=#hl-79-7> 7</a>
</span><span class=lnt id=hl-79-8><a class=lnlinks href=#hl-79-8> 8</a>
</span><span class=lnt id=hl-79-9><a class=lnlinks href=#hl-79-9> 9</a>
</span><span class=lnt id=hl-79-10><a class=lnlinks href=#hl-79-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 지연 교환기 선언 (플러그인 필요)
</span></span><span class=line><span class=cl>channel.exchangeDeclare(&#34;delayed&#34;, &#34;x-delayed-message&#34;, true, false, 
</span></span><span class=line><span class=cl>    Map.of(&#34;x-delayed-type&#34;, &#34;direct&#34;));
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 지연 메시지 전송
</span></span><span class=line><span class=cl>channel.basicPublish(&#34;delayed&#34;, routingKey,
</span></span><span class=line><span class=cl>    new AMQP.BasicProperties.Builder()
</span></span><span class=line><span class=cl>        .headers(Map.of(&#34;x-delay&#34;, 5000))  // 5초 지연
</span></span><span class=line><span class=cl>        .build(),
</span></span><span class=line><span class=cl>    message.getBytes());
</span></span></code></pre></td></tr></table></div></div><h4 id=마이크로서비스-통합-패턴>마이크로서비스 통합 패턴<a hidden class=anchor aria-hidden=true href=#마이크로서비스-통합-패턴>#</a></h4><h5 id=이벤트-기반-통신>이벤트 기반 통신<a hidden class=anchor aria-hidden=true href=#이벤트-기반-통신>#</a></h5><p>서비스 간 느슨한 결합을 위해 이벤트를 사용한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-80-1><a class=lnlinks href=#hl-80-1>1</a>
</span><span class=lnt id=hl-80-2><a class=lnlinks href=#hl-80-2>2</a>
</span><span class=lnt id=hl-80-3><a class=lnlinks href=#hl-80-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>주문 서비스 -&gt; &#34;주문 생성&#34; 이벤트 -&gt; 재고 서비스
</span></span><span class=line><span class=cl>                                  -&gt; 결제 서비스
</span></span><span class=line><span class=cl>                                  -&gt; 배송 서비스
</span></span></code></pre></td></tr></table></div></div><p>이 패턴은 서비스의 독립적인 확장과 변경을 가능하게 한다.</p><h5 id=장애-격리>장애 격리<a hidden class=anchor aria-hidden=true href=#장애-격리>#</a></h5><p>Circuit Breaker 패턴을 RabbitMQ와 함께 사용하여 장애 전파를 방지한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-81-1><a class=lnlinks href=#hl-81-1> 1</a>
</span><span class=lnt id=hl-81-2><a class=lnlinks href=#hl-81-2> 2</a>
</span><span class=lnt id=hl-81-3><a class=lnlinks href=#hl-81-3> 3</a>
</span><span class=lnt id=hl-81-4><a class=lnlinks href=#hl-81-4> 4</a>
</span><span class=lnt id=hl-81-5><a class=lnlinks href=#hl-81-5> 5</a>
</span><span class=lnt id=hl-81-6><a class=lnlinks href=#hl-81-6> 6</a>
</span><span class=lnt id=hl-81-7><a class=lnlinks href=#hl-81-7> 7</a>
</span><span class=lnt id=hl-81-8><a class=lnlinks href=#hl-81-8> 8</a>
</span><span class=lnt id=hl-81-9><a class=lnlinks href=#hl-81-9> 9</a>
</span><span class=lnt id=hl-81-10><a class=lnlinks href=#hl-81-10>10</a>
</span><span class=lnt id=hl-81-11><a class=lnlinks href=#hl-81-11>11</a>
</span><span class=lnt id=hl-81-12><a class=lnlinks href=#hl-81-12>12</a>
</span><span class=lnt id=hl-81-13><a class=lnlinks href=#hl-81-13>13</a>
</span><span class=lnt id=hl-81-14><a class=lnlinks href=#hl-81-14>14</a>
</span><span class=lnt id=hl-81-15><a class=lnlinks href=#hl-81-15>15</a>
</span><span class=lnt id=hl-81-16><a class=lnlinks href=#hl-81-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 메시지 처리 실패 시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>processMessage</span><span class=p>(</span><span class=n>message</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 재시도 횟수 초과</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>getRetryCount</span><span class=p>(</span><span class=n>message</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>MAX_RETRIES</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 데드 레터 큐로 전송</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>channel</span><span class=p>.</span><span class=na>basicPublish</span><span class=p>(</span><span class=s>&#34;dead-letter-exchange&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;failed-messages&#34;</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=kc>null</span><span class=p>,</span><span class=w> </span><span class=n>message</span><span class=p>.</span><span class=na>getBytes</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 재시도 큐로 전송</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>&gt;</span><span class=w> </span><span class=n>headers</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>HashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>headers</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;x-retry-count&#34;</span><span class=p>,</span><span class=w> </span><span class=n>getRetryCount</span><span class=p>(</span><span class=n>message</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>channel</span><span class=p>.</span><span class=na>basicPublish</span><span class=p>(</span><span class=s>&#34;retry-exchange&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;retry.messages&#34;</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>new</span><span class=w> </span><span class=n>AMQP</span><span class=p>.</span><span class=na>BasicProperties</span><span class=p>.</span><span class=na>Builder</span><span class=p>().</span><span class=na>headers</span><span class=p>(</span><span class=n>headers</span><span class=p>).</span><span class=na>build</span><span class=p>(),</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>message</span><span class=p>.</span><span class=na>getBytes</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=cqrscommand-query-responsibility-segregation>CQRS(Command Query Responsibility Segregation)<a hidden class=anchor aria-hidden=true href=#cqrscommand-query-responsibility-segregation>#</a></h5><p>명령과 쿼리를 분리하는 CQRS 패턴에서 RabbitMQ는 명령 측과 쿼리 측 사이의 통신을 지원한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-82-1><a class=lnlinks href=#hl-82-1>1</a>
</span><span class=lnt id=hl-82-2><a class=lnlinks href=#hl-82-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>클라이언트 -&gt; 명령 -&gt; 명령 핸들러 -&gt; &#34;상태 변경&#34; 이벤트 -&gt; 이벤트 핸들러 -&gt; 쿼리 데이터베이스 업데이트
</span></span><span class=line><span class=cl>클라이언트 &lt;- 쿼리 &lt;- 쿼리 핸들러 &lt;----------------------
</span></span></code></pre></td></tr></table></div></div><h3 id=실전-운영-및-대규모-배포>실전 운영 및 대규모 배포<a hidden class=anchor aria-hidden=true href=#실전-운영-및-대규모-배포>#</a></h3><h4 id=클러스터-크기-조정>클러스터 크기 조정<a hidden class=anchor aria-hidden=true href=#클러스터-크기-조정>#</a></h4><p>클러스터 크기를 결정하는 요소:</p><ul><li>메시지 처리량</li><li>메시지 크기</li><li>큐 수</li><li>연결 및 채널 수</li><li>필요한 복제 수준</li></ul><p>일반적인 경험적 규칙:</p><ul><li>최소 3개 노드로 시작 (내결함성을 위해)</li><li>개별 노드가 50-70% CPU 사용률에 도달하면 확장</li><li>메모리 사용량이 시스템 메모리의 50%를 초과하지 않도록 유지</li></ul><h4 id=자동화-배포>자동화 배포<a hidden class=anchor aria-hidden=true href=#자동화-배포>#</a></h4><p>Ansible, Chef, Puppet과 같은 구성 관리 도구를 사용하여 RabbitMQ 배포를 자동화할 수 있다.</p><p>Ansible Playbook 예제:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-83-1><a class=lnlinks href=#hl-83-1> 1</a>
</span><span class=lnt id=hl-83-2><a class=lnlinks href=#hl-83-2> 2</a>
</span><span class=lnt id=hl-83-3><a class=lnlinks href=#hl-83-3> 3</a>
</span><span class=lnt id=hl-83-4><a class=lnlinks href=#hl-83-4> 4</a>
</span><span class=lnt id=hl-83-5><a class=lnlinks href=#hl-83-5> 5</a>
</span><span class=lnt id=hl-83-6><a class=lnlinks href=#hl-83-6> 6</a>
</span><span class=lnt id=hl-83-7><a class=lnlinks href=#hl-83-7> 7</a>
</span><span class=lnt id=hl-83-8><a class=lnlinks href=#hl-83-8> 8</a>
</span><span class=lnt id=hl-83-9><a class=lnlinks href=#hl-83-9> 9</a>
</span><span class=lnt id=hl-83-10><a class=lnlinks href=#hl-83-10>10</a>
</span><span class=lnt id=hl-83-11><a class=lnlinks href=#hl-83-11>11</a>
</span><span class=lnt id=hl-83-12><a class=lnlinks href=#hl-83-12>12</a>
</span><span class=lnt id=hl-83-13><a class=lnlinks href=#hl-83-13>13</a>
</span><span class=lnt id=hl-83-14><a class=lnlinks href=#hl-83-14>14</a>
</span><span class=lnt id=hl-83-15><a class=lnlinks href=#hl-83-15>15</a>
</span><span class=lnt id=hl-83-16><a class=lnlinks href=#hl-83-16>16</a>
</span><span class=lnt id=hl-83-17><a class=lnlinks href=#hl-83-17>17</a>
</span><span class=lnt id=hl-83-18><a class=lnlinks href=#hl-83-18>18</a>
</span><span class=lnt id=hl-83-19><a class=lnlinks href=#hl-83-19>19</a>
</span><span class=lnt id=hl-83-20><a class=lnlinks href=#hl-83-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>hosts</span><span class=p>:</span><span class=w> </span><span class=l>rabbitmq_nodes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tasks</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Add RabbitMQ repository</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>apt_repository</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class=l>deb https://dl.bintray.com/rabbitmq/debian {{ ansible_distribution_release }} main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>present</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Install RabbitMQ</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>apt</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>rabbitmq-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>present</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Enable management plugin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>rabbitmq_plugin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>names</span><span class=p>:</span><span class=w> </span><span class=l>rabbitmq_management</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>state</span><span class=p>:</span><span class=w> </span><span class=l>enabled</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Configure cluster</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 클러스터 구성 단계</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=대규모-배포-사례-연구>대규모 배포 사례 연구<a hidden class=anchor aria-hidden=true href=#대규모-배포-사례-연구>#</a></h3><ol><li><p>대용량 트래픽 처리<br>대량의 메시지를 처리하는 시스템의 접근 방식:</p><ul><li>메시지 배치 처리</li><li>토픽 샤딩(여러 토픽으로 분할)</li><li>컨슈머 그룹을 사용한 병렬 처리</li><li>하드웨어 최적화(SSD, 충분한 메모리, 좋은 네트워크)</li></ul></li><li><p>글로벌 분산 시스템<br>여러 지역에 분산된 RabbitMQ 클러스터 간 통신:</p><ul><li>federation 플러그인을 사용한 메시지 복제</li><li>지역적으로 가까운 클러스터에 우선 연결</li><li>샤딩 전략을 통한 지역별 데이터 분산</li></ul></li><li><p>고가용성 구성<br>1.99% 이상의 가용성을 달성하기 위한 전략:</p><ul><li>여러 가용성 영역에 걸친 최소 3노드 클러스터</li><li>적절한 모니터링 및 자동 복구 메커니즘</li><li>자동 장애 조치를 위한 로드 밸런서 구성</li><li>클라이언트 측의 재시도 및 장애 복구 전략</li></ul></li></ol><h3 id=최신-동향-및-미래-방향>최신 동향 및 미래 방향<a hidden class=anchor aria-hidden=true href=#최신-동향-및-미래-방향>#</a></h3><h4 id=스트림-큐>스트림 큐<a hidden class=anchor aria-hidden=true href=#스트림-큐>#</a></h4><p>RabbitMQ 3.9부터 도입된 스트림 큐는 Kafka와 유사한 로그 기반 메시징 모델을 제공한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-84-1><a class=lnlinks href=#hl-84-1>1</a>
</span><span class=lnt id=hl-84-2><a class=lnlinks href=#hl-84-2>2</a>
</span><span class=lnt id=hl-84-3><a class=lnlinks href=#hl-84-3>3</a>
</span><span class=lnt id=hl-84-4><a class=lnlinks href=#hl-84-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>&gt;</span><span class=w> </span><span class=n>args</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>HashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>args</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;x-queue-type&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;stream&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>args</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;x-max-length-bytes&#34;</span><span class=p>,</span><span class=w> </span><span class=n>20_000_000_000L</span><span class=p>);</span><span class=w>  </span><span class=c1>// 20GB</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>channel</span><span class=p>.</span><span class=na>queueDeclare</span><span class=p>(</span><span class=s>&#34;my-stream&#34;</span><span class=p>,</span><span class=w> </span><span class=kc>true</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=n>args</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>스트림 큐의 장점:</p><ul><li>더 높은 처리량</li><li>더 큰 백로그 지원</li><li>긴 기간 메시지 보존</li></ul><h4 id=서버리스-통합>서버리스 통합<a hidden class=anchor aria-hidden=true href=#서버리스-통합>#</a></h4><p>RabbitMQ를 서버리스 함수와 통합하는 패턴이 증가하고 있다:</p><ul><li>AWS Lambda + RabbitMQ</li><li>Azure Functions + RabbitMQ</li><li>Google Cloud Functions + RabbitMQ</li></ul><h4 id=컨테이너화-및-쿠버네티스>컨테이너화 및 쿠버네티스<a hidden class=anchor aria-hidden=true href=#컨테이너화-및-쿠버네티스>#</a></h4><p>쿠버네티스에서 RabbitMQ를 실행하기 위한 최신 접근 방식:</p><ul><li>RabbitMQ 쿠버네티스 오퍼레이터 사용</li><li>스테이트풀셋(StatefulSet)으로 배포</li><li>볼륨 클레임 템플릿(PersistentVolumeClaim)으로 데이터 영속성 확보</li><li>커스텀 리소스 정의(CRD)를 통한 선언적 관리</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-85-1><a class=lnlinks href=#hl-85-1> 1</a>
</span><span class=lnt id=hl-85-2><a class=lnlinks href=#hl-85-2> 2</a>
</span><span class=lnt id=hl-85-3><a class=lnlinks href=#hl-85-3> 3</a>
</span><span class=lnt id=hl-85-4><a class=lnlinks href=#hl-85-4> 4</a>
</span><span class=lnt id=hl-85-5><a class=lnlinks href=#hl-85-5> 5</a>
</span><span class=lnt id=hl-85-6><a class=lnlinks href=#hl-85-6> 6</a>
</span><span class=lnt id=hl-85-7><a class=lnlinks href=#hl-85-7> 7</a>
</span><span class=lnt id=hl-85-8><a class=lnlinks href=#hl-85-8> 8</a>
</span><span class=lnt id=hl-85-9><a class=lnlinks href=#hl-85-9> 9</a>
</span><span class=lnt id=hl-85-10><a class=lnlinks href=#hl-85-10>10</a>
</span><span class=lnt id=hl-85-11><a class=lnlinks href=#hl-85-11>11</a>
</span><span class=lnt id=hl-85-12><a class=lnlinks href=#hl-85-12>12</a>
</span><span class=lnt id=hl-85-13><a class=lnlinks href=#hl-85-13>13</a>
</span><span class=lnt id=hl-85-14><a class=lnlinks href=#hl-85-14>14</a>
</span><span class=lnt id=hl-85-15><a class=lnlinks href=#hl-85-15>15</a>
</span><span class=lnt id=hl-85-16><a class=lnlinks href=#hl-85-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>rabbitmq.com/v1beta1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>RabbitmqCluster</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>production-rabbitmq</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>2Gi</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>4Gi</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>persistence</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>storageClassName</span><span class=p>:</span><span class=w> </span><span class=l>fast</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>storage</span><span class=p>:</span><span class=w> </span><span class=l>20Gi</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=이벤트-메시-및-클라우드-네이티브-메시징>이벤트 메시 및 클라우드 네이티브 메시징<a hidden class=anchor aria-hidden=true href=#이벤트-메시-및-클라우드-네이티브-메시징>#</a></h4><p>분산 시스템에서 이벤트 메시로 RabbitMQ를 사용하는 추세가 증가하고 있다:</p><ul><li>서비스 간 비동기 통신</li><li>이벤트 기반 아키텍처 지원</li><li>도메인 주도 설계(DDD)와의 통합</li><li>클라우드 네이티브 애플리케이션의 백본</li></ul><hr><h2 id=용어-정리-3>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-3>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><hr><h2 id=참고-및-출처-3>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-3>#</a></h2><h3 id=공식-문서-및-튜토리얼>공식 문서 및 튜토리얼<a hidden class=anchor aria-hidden=true href=#공식-문서-및-튜토리얼>#</a></h3><ul><li><a href=https://www.rabbitmq.com/docs>공식 문서 바로가기</a></li><li><a href=https://www.rabbitmq.com/tutorials>튜토리얼 바로가기</a></li><li><a href=https://www.rabbitmq.com/>RabbitMQ 공식 홈페이지</a></li></ul><h3 id=실습-및-단계별-가이드>실습 및 단계별 가이드<a hidden class=anchor aria-hidden=true href=#실습-및-단계별-가이드>#</a></h3><ul><li><a href=https://dev.to/felipepaz/getting-started-with-rabbitmq-and-python-a-practical-guide-57fi>Getting Started with RabbitMQ and Python: A Practical Guide (dev.to)</a></li><li><a href=https://www.rabbitmq.com/tutorials>RabbitMQ 튜토리얼(AMQP 0-9-1, 다양한 언어 예제)</a></li><li><a href=https://www.rabbitmq.com/docs/installation.html>RabbitMQ 설치 가이드 및 관리 문서</a></li></ul><h3 id=참고-도서-및-자료>참고 도서 및 자료<a hidden class=anchor aria-hidden=true href=#참고-도서-및-자료>#</a></h3><ul><li><a href=https://www.rabbitmq.com/blog/2012/05/29/jason-and-alvaros-excellent-rabbit-book>RabbitMQ in Action (Manning)</a></li><li><a href=https://www.manning.com/books/rabbitmq-in-depth>RabbitMQ in Depth (Manning)</a></li><li><a href=https://www.goodreads.com/shelf/show/rabbitmq>RabbitMQ 관련 인기 도서 목록 (Goodreads)</a></li><li><a href=https://www.cloudamqp.com/rabbitmq_ebook.html>CloudAMQP: 무료 RabbitMQ 입문 eBook</a></li></ul><h2 id=-rabbitmq-구조-및-실전-설정-가이드>✅ RabbitMQ 구조 및 실전 설정 가이드<a hidden class=anchor aria-hidden=true href=#-rabbitmq-구조-및-실전-설정-가이드>#</a></h2><hr><h3 id=1-개요>1. 개요<a hidden class=anchor aria-hidden=true href=#1-개요>#</a></h3><p>RabbitMQ 는 오픈소스 메시지 브로커로, **AMQP (Advanced Message Queuing Protocol)** 를 기반으로 하며, 다양한 메시징 패턴을 지원하고 확장성과 안정성이 뛰어나 실무에서 널리 사용됩니다. 이 가이드에서는 <strong>구조, 핵심 개념, 실전 설정, 운영 노하우</strong>를 다룹니다.</p><hr><h3 id=2-핵심-구조-및-아키텍처>2. 핵심 구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#2-핵심-구조-및-아키텍처>#</a></h3><pre class=mermaid>flowchart TD
    A[Producer] --&gt; B[Exchange]
    B --&gt;|Routing Key| C1[Queue 1]
    B --&gt;|Routing Key| C2[Queue 2]
    C1 --&gt; D1[Consumer 1]
    C2 --&gt; D2[Consumer 2]
</pre><h4 id=-구성-요소-요약>📌 구성 요소 요약<a hidden class=anchor aria-hidden=true href=#-구성-요소-요약>#</a></h4><table><thead><tr><th>구성 요소</th><th>설명</th></tr></thead><tbody><tr><td><strong>Producer</strong></td><td>메시지를 발행하는 클라이언트</td></tr><tr><td><strong>Exchange</strong></td><td>메시지를 큐로 라우팅</td></tr><tr><td><strong>Queue</strong></td><td>메시지를 저장하는 버퍼 (FIFO)</td></tr><tr><td><strong>Consumer</strong></td><td>큐에서 메시지를 읽는 클라이언트</td></tr><tr><td><strong>Routing Key</strong></td><td>Exchange → Queue 로 메시지를 라우팅하는 기준</td></tr></tbody></table><hr><h3 id=3-exchange-타입별-동작-방식>3. Exchange 타입별 동작 방식<a hidden class=anchor aria-hidden=true href=#3-exchange-타입별-동작-방식>#</a></h3><table><thead><tr><th>Exchange Type</th><th>설명</th><th>예시</th></tr></thead><tbody><tr><td><strong>Direct</strong></td><td>Routing Key 와 정확히 일치하는 큐에만 전달</td><td>&ldquo;order.created&rdquo;</td></tr><tr><td><strong>Fanout</strong></td><td>Routing Key 무시, 모든 바인딩 큐에 브로드캐스트</td><td>로그 수집</td></tr><tr><td><strong>Topic</strong></td><td>와일드카드 패턴 기반</td><td>&ldquo;order.*&rdquo;, &ldquo;user.#&rdquo;</td></tr><tr><td><strong>Headers</strong></td><td>Header 속성 기반 라우팅</td><td>복잡한 조건 매칭</td></tr></tbody></table><hr><h3 id=4-실전-설정-항목>4. 실전 설정 항목<a hidden class=anchor aria-hidden=true href=#4-실전-설정-항목>#</a></h3><h4 id=41-기본-설치-방법>4.1 기본 설치 방법<a hidden class=anchor aria-hidden=true href=#41-기본-설치-방법>#</a></h4><h5 id=a-docker-기반-설치>A. Docker 기반 설치<a hidden class=anchor aria-hidden=true href=#a-docker-기반-설치>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-87-1><a class=lnlinks href=#hl-87-1>1</a>
</span><span class=lnt id=hl-87-2><a class=lnlinks href=#hl-87-2>2</a>
</span><span class=lnt id=hl-87-3><a class=lnlinks href=#hl-87-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run -d --hostname rabbit --name rabbitmq <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -p 5672:5672 -p 15672:15672 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  rabbitmq:3-management
</span></span></code></pre></td></tr></table></div></div><ul><li><code>5672</code>: AMQP 포트</li><li><code>15672</code>: Management UI</li></ul><h5 id=b-kubernetes-설정-helm>B. Kubernetes 설정 (helm)<a hidden class=anchor aria-hidden=true href=#b-kubernetes-설정-helm>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-88-1><a class=lnlinks href=#hl-88-1>1</a>
</span><span class=lnt id=hl-88-2><a class=lnlinks href=#hl-88-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add bitnami https://charts.bitnami.com/bitnami
</span></span><span class=line><span class=cl>helm install my-rabbitmq bitnami/rabbitmq
</span></span></code></pre></td></tr></table></div></div><hr><h4 id=42-사용자-및-권한-설정>4.2 사용자 및 권한 설정<a hidden class=anchor aria-hidden=true href=#42-사용자-및-권한-설정>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-89-1><a class=lnlinks href=#hl-89-1>1</a>
</span><span class=lnt id=hl-89-2><a class=lnlinks href=#hl-89-2>2</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rabbitmqctl add_user dev_user dev_pass
</span></span><span class=line><span class=cl>rabbitmqctl set_permissions -p / dev_user <span class=s2>&#34;.*&#34;</span> <span class=s2>&#34;.*&#34;</span> <span class=s2>&#34;.*&#34;</span>
</span></span></code></pre></td></tr></table></div></div><hr><h4 id=43-queue-설정-ttl-dlq>4.3 Queue 설정 (TTL, DLQ)<a hidden class=anchor aria-hidden=true href=#43-queue-설정-ttl-dlq>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-90-1><a class=lnlinks href=#hl-90-1>1</a>
</span><span class=lnt id=hl-90-2><a class=lnlinks href=#hl-90-2>2</a>
</span><span class=lnt id=hl-90-3><a class=lnlinks href=#hl-90-3>3</a>
</span><span class=lnt id=hl-90-4><a class=lnlinks href=#hl-90-4>4</a>
</span><span class=lnt id=hl-90-5><a class=lnlinks href=#hl-90-5>5</a>
</span><span class=lnt id=hl-90-6><a class=lnlinks href=#hl-90-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># TTL + DLQ 설정</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;x-message-ttl&#34;</span>: 60000,  <span class=c1># 메시지 TTL 60초</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;x-dead-letter-exchange&#34;</span>: <span class=s2>&#34;dead_exchange&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;x-dead-letter-routing-key&#34;</span>: <span class=s2>&#34;dead_key&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h4 id=44-클러스터링-구조>4.4 클러스터링 구조<a hidden class=anchor aria-hidden=true href=#44-클러스터링-구조>#</a></h4><pre class=mermaid>graph LR
  A[Node 1] --&gt;|Mirror| B[Node 2]
  A --&gt;|Queue Sync| C[Node 3]
</pre><ul><li><strong>Classic Mirrored Queue</strong>: 모든 노드에 복제</li><li><strong>Quorum Queue</strong>: Paxos 기반 고가용 큐</li></ul><hr><h3 id=5-운영-시-고려사항>5. 운영 시 고려사항<a hidden class=anchor aria-hidden=true href=#5-운영-시-고려사항>#</a></h3><table><thead><tr><th>항목</th><th>설명</th><th>권장 설정</th></tr></thead><tbody><tr><td><strong>모니터링</strong></td><td>연결 수, 큐 길이, Ack 실패</td><td>Prometheus, Grafana, RabbitMQ Exporter</td></tr><tr><td><strong>퍼포먼스</strong></td><td>높은 TPS 시 메시지 유실 우려</td><td>QoS 설정, Prefetch count 튜닝</td></tr><tr><td><strong>보안</strong></td><td>인증, 암호화 필요</td><td>TLS, 사용자 권한 분리</td></tr><tr><td><strong>장애 대응</strong></td><td>Consumer 실패, 메시지 누락</td><td>DLQ 구성, Retry Policy 도입</td></tr></tbody></table><hr><h3 id=6-예시-메시지-큐-생성-및-라우팅>6. 예시: 메시지 큐 생성 및 라우팅<a hidden class=anchor aria-hidden=true href=#6-예시-메시지-큐-생성-및-라우팅>#</a></h3><h4 id=python-pika>Python (pika)<a hidden class=anchor aria-hidden=true href=#python-pika>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-92-1><a class=lnlinks href=#hl-92-1> 1</a>
</span><span class=lnt id=hl-92-2><a class=lnlinks href=#hl-92-2> 2</a>
</span><span class=lnt id=hl-92-3><a class=lnlinks href=#hl-92-3> 3</a>
</span><span class=lnt id=hl-92-4><a class=lnlinks href=#hl-92-4> 4</a>
</span><span class=lnt id=hl-92-5><a class=lnlinks href=#hl-92-5> 5</a>
</span><span class=lnt id=hl-92-6><a class=lnlinks href=#hl-92-6> 6</a>
</span><span class=lnt id=hl-92-7><a class=lnlinks href=#hl-92-7> 7</a>
</span><span class=lnt id=hl-92-8><a class=lnlinks href=#hl-92-8> 8</a>
</span><span class=lnt id=hl-92-9><a class=lnlinks href=#hl-92-9> 9</a>
</span><span class=lnt id=hl-92-10><a class=lnlinks href=#hl-92-10>10</a>
</span><span class=lnt id=hl-92-11><a class=lnlinks href=#hl-92-11>11</a>
</span><span class=lnt id=hl-92-12><a class=lnlinks href=#hl-92-12>12</a>
</span><span class=lnt id=hl-92-13><a class=lnlinks href=#hl-92-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pika</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 연결 설정</span>
</span></span><span class=line><span class=cl><span class=n>connection</span> <span class=o>=</span> <span class=n>pika</span><span class=o>.</span><span class=n>BlockingConnection</span><span class=p>(</span><span class=n>pika</span><span class=o>.</span><span class=n>ConnectionParameters</span><span class=p>(</span><span class=s1>&#39;localhost&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>channel</span> <span class=o>=</span> <span class=n>connection</span><span class=o>.</span><span class=n>channel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 큐, 익스체인지 선언</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>exchange_declare</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;logs&#39;</span><span class=p>,</span> <span class=n>exchange_type</span><span class=o>=</span><span class=s1>&#39;fanout&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_declare</span><span class=p>(</span><span class=n>queue</span><span class=o>=</span><span class=s1>&#39;log_queue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>queue_bind</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;logs&#39;</span><span class=p>,</span> <span class=n>queue</span><span class=o>=</span><span class=s1>&#39;log_queue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메시지 전송</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>basic_publish</span><span class=p>(</span><span class=n>exchange</span><span class=o>=</span><span class=s1>&#39;logs&#39;</span><span class=p>,</span> <span class=n>routing_key</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>body</span><span class=o>=</span><span class=s1>&#39;Hello Log&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=7-실제-사용-시나리오>7. 실제 사용 시나리오<a hidden class=anchor aria-hidden=true href=#7-실제-사용-시나리오>#</a></h3><table><thead><tr><th>분야</th><th>사용 목적</th><th>설명</th></tr></thead><tbody><tr><td>전자상거래</td><td>주문 처리 비동기화</td><td>결제 → 주문 시스템 간 연결</td></tr><tr><td>IoT</td><td>센서 데이터 처리</td><td>게이트웨이 → 중앙 처리기</td></tr><tr><td>로그 수집</td><td>Fanout 기반 수집</td><td>여러 로그 분석기로 병렬 분배</td></tr><tr><td>마이크로서비스</td><td>서비스 간 통신</td><td>느슨한 결합 구조 구성</td></tr></tbody></table><hr><h3 id=8-결론-및-확장-방향>8. 결론 및 확장 방향<a hidden class=anchor aria-hidden=true href=#8-결론-및-확장-방향>#</a></h3><ul><li><strong>RabbitMQ 는 다양한 메시징 시나리오에 유연하게 대응할 수 있는 브로커</strong>로서, 마이크로서비스, IoT, 이벤트 기반 처리 등 여러 분야에 적합합니다.</li><li>실전 운영에서는 <strong>라우팅 설계, 큐 정책 설정, 장애 대응 메커니즘 (DLQ/Retry)</strong> 등을 통해 신뢰성과 가용성을 확보하는 것이 중요합니다.</li></ul><hr><h3 id=-다음-심화-주제-제안>✅ 다음 심화 주제 제안<a hidden class=anchor aria-hidden=true href=#-다음-심화-주제-제안>#</a></h3><ol><li>메시지 포맷 관리 (Avro/Protobuf + 스키마 레지스트리)</li><li>메시지 보장 전략 실습 (Exactly-once / At-least-once)</li><li>Kafka 와 RabbitMQ 비교 실전</li><li>실시간 스트리밍 설계 (Kafka Streams / GCP Pub/Sub + Dataflow)</li></ol></div></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>