<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>CORS | hyunyoun's Blog</title><meta name=keywords content="System-and-Software-Architecture,MSA-Patterns,Security,CORS"><meta name=description content="CORS는 웹 브라우저에서 구현된 보안 메커니즘으로, 다른 출처(도메인, 프로토콜, 포트)의 리소스에 접근할 수 있도록 허용하는 체계이다. 이는 동일 출처 정책(Same-Origin Policy)의 제한을 안전하게 우회할 수 있게 해준다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/security--compliance/application-security/web-application-security/client-side-security/cors/cors/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.d522c866f0cc9c20ae4fa73a0a8c07f0af4c36af75bcbcd3e90558446f681077.css integrity="sha256-1SLIZvDMnCCuT6c6CowH8K9MNq91vLzT6QVYRG9oEHc=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/security--compliance/application-security/web-application-security/client-side-security/cors/cors/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/security--compliance/application-security/web-application-security/client-side-security/cors/cors/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="CORS"><meta property="og:description" content="CORS는 웹 브라우저에서 구현된 보안 메커니즘으로, 다른 출처(도메인, 프로토콜, 포트)의 리소스에 접근할 수 있도록 허용하는 체계이다. 이는 동일 출처 정책(Same-Origin Policy)의 제한을 안전하게 우회할 수 있게 해준다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-18T12:08:00+00:00"><meta property="article:modified_time" content="2024-11-18T12:08:00+00:00"><meta property="article:tag" content="System-and-Software-Architecture"><meta property="article:tag" content="MSA-Patterns"><meta property="article:tag" content="Security"><meta property="article:tag" content="CORS"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="CORS"><meta name=twitter:description content="CORS는 웹 브라우저에서 구현된 보안 메커니즘으로, 다른 출처(도메인, 프로토콜, 포트)의 리소스에 접근할 수 있도록 허용하는 체계이다. 이는 동일 출처 정책(Same-Origin Policy)의 제한을 안전하게 우회할 수 있게 해준다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HY's Blog","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":7,"name":"CORS","item":"https://buenhyden.github.io/posts/security--compliance/application-security/web-application-security/client-side-security/cors/cors/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"CORS","name":"CORS","description":"CORS는 웹 브라우저에서 구현된 보안 메커니즘으로, 다른 출처(도메인, 프로토콜, 포트)의 리소스에 접근할 수 있도록 허용하는 체계이다. 이는 동일 출처 정책(Same-Origin Policy)의 제한을 안전하게 우회할 수 있게 해준다.","keywords":["System-and-Software-Architecture","MSA-Patterns","Security","CORS"],"articleBody":"CORS 마이크로서비스 아키텍처(MSA) 패턴의 보안 측면에서 CORS(Cross-Origin Resource Sharing)는 매우 중요한 역할을 한다.\nCORS는 웹 브라우저에서 구현된 보안 메커니즘으로, 다른 출처(도메인, 프로토콜, 포트)의 리소스에 접근할 수 있도록 허용하는 체계이다. 이는 동일 출처 정책(Same-Origin Policy)의 제한을 안전하게 우회할 수 있게 해준다.\nCORS는 MSA 환경에서 안전하고 유연한 리소스 공유를 가능하게 하는 핵심 메커니즘으로 올바르게 구현된 CORS는 마이크로서비스 간의 안전한 통신을 보장하며, 전체 시스템의 보안을 강화한다.\nCORS의 작동 원리 브라우저가 다른 출처로 HTTP 요청을 보낼 때 Origin 헤더를 추가한다. 서버는 Access-Control-Allow-Origin 헤더로 응답하여 해당 출처의 접근을 허용할지 결정한다. 브라우저는 이 헤더를 확인하여 요청을 허용하거나 차단한다. Origin의 정의\nOrigin은 다음 세 가지 요소로 구성된다:\n프로토콜: 예를 들어, http 또는 https 호스트명: 예를 들어, example.com 포트 번호: 예를 들어, 80 또는 443\n두 URL의 프로토콜, 호스트명, 포트 번호가 모두 동일하면 동일 출처로 간주되며, 하나라도 다르면 교차 출처로 간주된다. 브라우저의 CORS 요청 유형 브라우저는 요청의 성격에 따라 다음과 같은 방식으로 CORS 요청을 처리한다:\n단순 요청(Simple Request): GET, HEAD, POST 메서드 중 하나를 사용하고, 특정 조건을 만족하는 요청이다. 이러한 요청은 사전 검증 없이 바로 서버로 전송된다. 프리플라이트 요청(Preflight Request): 클라이언트가 실제 요청을 보내기 전에 OPTIONS 메서드를 사용하여 서버의 CORS 정책을 확인하는 요청이다. 이는 안전하지 않은 메서드나 헤더를 사용할 때 발생한다. 자격 증명 포함 요청(Credentialed Request): 쿠키나 인증 헤더와 같은 자격 증명을 포함한 요청이다. 서버는 Access-Control-Allow-Credentials 헤더를 통해 이러한 요청을 허용할지 결정한다. CORS의 중요성 보안 강화: 무단 접근과 잠재적 공격으로부터 웹 애플리케이션을 보호한다. 유연성: 프론트엔드와 백엔드의 분리, 마이크로서비스 아키텍처 구현을 가능하게 한다. API 통합: 외부 API와의 안전한 통신을 가능하게 한다. MSA에서의 CORS 활용 MSA 환경에서 CORS는 더욱 복잡한 역할을 수행한다:\nAPI 게이트웨이: 중앙 진입점으로 작용하여 모든 하위 서비스에 대한 CORS 정책을 관리한다. 일관된 보안 정책: 게이트웨이에서 CORS를 관리함으로써 모든 마이크로서비스에 대해 일관된 보안 정책을 적용할 수 있다. 세분화된 접근 제어: 공개 서비스와 민감한 서비스에 대해 다른 CORS 요구사항을 적용할 수 있다. CORS 구현 시 주의사항 구체적인 출처 지정: 가능한 한 구체적으로 허용할 출처를 지정한다. 와일드카드 사용 주의: ‘*‘를 사용한 모든 출처 허용은 보안 위험을 초래할 수 있다. 자격 증명 처리: Access-Control-Allow-Credentials 헤더를 신중하게 사용한다. 프리플라이트 요청 처리: OPTIONS 메서드에 대한 적절한 응답을 구현한다. 보안 모범 사례 정기적인 감사: CORS 정책을 정기적으로 검토하고 업데이트한다. 환경 변수 사용: 개발 및 프로덕션 설정을 쉽게 전환할 수 있도록 환경 변수를 사용한다. 철저한 테스트: 다양한 시나리오에서 CORS 구성을 테스트한다. 최신 보안 권장 사항 준수: CORS 구현을 최신 보안 권장 사항에 맞춰 유지한다. 구현 예시 Node.js/Express를 사용한 CORS 구현 예시\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 // CORS 미들웨어 구현 const cors = (options = {}) =\u003e { return (req, res, next) =\u003e { // 1. Origin 검증 const requestOrigin = req.headers.origin; const allowedOrigins = options.origins || ['http://localhost:3000']; if (allowedOrigins.includes(requestOrigin)) { // 허용된 출처인 경우 res.setHeader('Access-Control-Allow-Origin', requestOrigin); } else { // 허용되지 않은 출처인 경우 return res.status(403).json({ error: '허용되지 않은 출처입니다.' }); } // 2. 메서드 검증 const allowedMethods = options.methods || ['GET', 'POST', 'PUT', 'DELETE']; res.setHeader('Access-Control-Allow-Methods', allowedMethods.join(', ')); // 3. 헤더 검증 const allowedHeaders = options.headers || ['Content-Type', 'Authorization']; res.setHeader('Access-Control-Allow-Headers', allowedHeaders.join(', ')); // 4. 자격 증명 (Credentials) 설정 if (options.credentials) { res.setHeader('Access-Control-Allow-Credentials', 'true'); } // 5. Preflight 요청 처리 if (req.method === 'OPTIONS') { return res.status(204).end(); } next(); }; } 참고 및 출처 ","wordCount":"542","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2024-11-18T12:08:00Z","dateModified":"2024-11-18T12:08:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/security--compliance/application-security/web-application-security/client-side-security/cors/cors/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>HY's Blog</a></div><h1 class="post-title entry-hint-parent">CORS</h1><div class=post-description>CORS는 웹 브라우저에서 구현된 보안 메커니즘으로, 다른 출처(도메인, 프로토콜, 포트)의 리소스에 접근할 수 있도록 허용하는 체계이다. 이는 동일 출처 정책(Same-Origin Policy)의 제한을 안전하게 우회할 수 있게 해준다.</div><div class=post-meta><span title='2024-11-18 12:08:00 +0000 UTC'>November 18, 2024</span>&nbsp;·&nbsp;<span>3 min</span>&nbsp;·&nbsp;<span>Me</span>&nbsp;|&nbsp;<span>
<a href=https://github.com/buenhyden/blog-data/main/content/posts/Security%20&%20Compliance/Application%20Security/Web%20Application%20Security/Client-Side%20Security/CORS/cors.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#cors>CORS</a><ul><li><a href=#cors의-작동-원리>CORS의 작동 원리</a></li><li><a href=#cors의-중요성>CORS의 중요성</a></li><li><a href=#msa에서의-cors-활용>MSA에서의 CORS 활용</a></li><li><a href=#cors-구현-시-주의사항>CORS 구현 시 주의사항</a></li><li><a href=#보안-모범-사례>보안 모범 사례</a></li><li><a href=#구현-예시>구현 예시</a></li></ul></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=cors>CORS<a hidden class=anchor aria-hidden=true href=#cors>#</a></h2><p>마이크로서비스 아키텍처(MSA) 패턴의 보안 측면에서 CORS(Cross-Origin Resource Sharing)는 매우 중요한 역할을 한다.</p><p>CORS는 웹 브라우저에서 구현된 보안 메커니즘으로, 다른 출처(도메인, 프로토콜, 포트)의 리소스에 접근할 수 있도록 허용하는 체계이다. 이는 동일 출처 정책(Same-Origin Policy)의 제한을 안전하게 우회할 수 있게 해준다.</p><p>CORS는 MSA 환경에서 안전하고 유연한 리소스 공유를 가능하게 하는 핵심 메커니즘으로 올바르게 구현된 CORS는 마이크로서비스 간의 안전한 통신을 보장하며, 전체 시스템의 보안을 강화한다.</p><h3 id=cors의-작동-원리>CORS의 작동 원리<a hidden class=anchor aria-hidden=true href=#cors의-작동-원리>#</a></h3><ol><li>브라우저가 다른 출처로 HTTP 요청을 보낼 때 Origin 헤더를 추가한다.</li><li>서버는 Access-Control-Allow-Origin 헤더로 응답하여 해당 출처의 접근을 허용할지 결정한다.</li><li>브라우저는 이 헤더를 확인하여 요청을 허용하거나 차단한다.</li></ol><blockquote><p>Origin의 정의<br>Origin은 다음 세 가지 요소로 구성된다:</p><ul><li><strong>프로토콜</strong>: 예를 들어, <code>http</code> 또는 <code>https</code></li><li><strong>호스트명</strong>: 예를 들어, <code>example.com</code></li><li><strong>포트 번호</strong>: 예를 들어, <code>80</code> 또는 <code>443</code><br>두 URL의 프로토콜, 호스트명, 포트 번호가 모두 동일하면 동일 출처로 간주되며, 하나라도 다르면 교차 출처로 간주된다.</li></ul></blockquote><h4 id=브라우저의-cors-요청-유형>브라우저의 CORS 요청 유형<a hidden class=anchor aria-hidden=true href=#브라우저의-cors-요청-유형>#</a></h4><p>브라우저는 요청의 성격에 따라 다음과 같은 방식으로 CORS 요청을 처리한다:</p><ul><li><strong>단순 요청(Simple Request)</strong>: GET, HEAD, POST 메서드 중 하나를 사용하고, 특정 조건을 만족하는 요청이다. 이러한 요청은 사전 검증 없이 바로 서버로 전송된다.</li><li><strong>프리플라이트 요청(Preflight Request)</strong>: 클라이언트가 실제 요청을 보내기 전에 OPTIONS 메서드를 사용하여 서버의 CORS 정책을 확인하는 요청이다. 이는 안전하지 않은 메서드나 헤더를 사용할 때 발생한다.</li><li><strong>자격 증명 포함 요청(Credentialed Request)</strong>: 쿠키나 인증 헤더와 같은 자격 증명을 포함한 요청이다. 서버는 <code>Access-Control-Allow-Credentials</code> 헤더를 통해 이러한 요청을 허용할지 결정한다.</li></ul><h3 id=cors의-중요성>CORS의 중요성<a hidden class=anchor aria-hidden=true href=#cors의-중요성>#</a></h3><ol><li><strong>보안 강화</strong>: 무단 접근과 잠재적 공격으로부터 웹 애플리케이션을 보호한다.</li><li><strong>유연성</strong>: 프론트엔드와 백엔드의 분리, 마이크로서비스 아키텍처 구현을 가능하게 한다.</li><li><strong>API 통합</strong>: 외부 API와의 안전한 통신을 가능하게 한다.</li></ol><h3 id=msa에서의-cors-활용>MSA에서의 CORS 활용<a hidden class=anchor aria-hidden=true href=#msa에서의-cors-활용>#</a></h3><p>MSA 환경에서 CORS는 더욱 복잡한 역할을 수행한다:</p><ol><li><strong>API 게이트웨이</strong>: 중앙 진입점으로 작용하여 모든 하위 서비스에 대한 CORS 정책을 관리한다.</li><li><strong>일관된 보안 정책</strong>: 게이트웨이에서 CORS를 관리함으로써 모든 마이크로서비스에 대해 일관된 보안 정책을 적용할 수 있다.</li><li><strong>세분화된 접근 제어</strong>: 공개 서비스와 민감한 서비스에 대해 다른 CORS 요구사항을 적용할 수 있다.</li></ol><h3 id=cors-구현-시-주의사항>CORS 구현 시 주의사항<a hidden class=anchor aria-hidden=true href=#cors-구현-시-주의사항>#</a></h3><ol><li><strong>구체적인 출처 지정</strong>: 가능한 한 구체적으로 허용할 출처를 지정한다.</li><li><strong>와일드카드 사용 주의</strong>: &lsquo;*&lsquo;를 사용한 모든 출처 허용은 보안 위험을 초래할 수 있다.</li><li><strong>자격 증명 처리</strong>: Access-Control-Allow-Credentials 헤더를 신중하게 사용한다.</li><li><strong>프리플라이트 요청 처리</strong>: OPTIONS 메서드에 대한 적절한 응답을 구현한다.</li></ol><h3 id=보안-모범-사례>보안 모범 사례<a hidden class=anchor aria-hidden=true href=#보안-모범-사례>#</a></h3><ol><li><strong>정기적인 감사</strong>: CORS 정책을 정기적으로 검토하고 업데이트한다.</li><li><strong>환경 변수 사용</strong>: 개발 및 프로덕션 설정을 쉽게 전환할 수 있도록 환경 변수를 사용한다.</li><li><strong>철저한 테스트</strong>: 다양한 시나리오에서 CORS 구성을 테스트한다.</li><li><strong>최신 보안 권장 사항 준수</strong>: CORS 구현을 최신 보안 권장 사항에 맞춰 유지한다.</li></ol><h3 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h3><p><code>Node.js/Express</code>를 사용한 CORS 구현 예시</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21>21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22>22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23>23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24>24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25>25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26>26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27>27</a>
</span><span class=lnt id=hl-0-28><a class=lnlinks href=#hl-0-28>28</a>
</span><span class=lnt id=hl-0-29><a class=lnlinks href=#hl-0-29>29</a>
</span><span class=lnt id=hl-0-30><a class=lnlinks href=#hl-0-30>30</a>
</span><span class=lnt id=hl-0-31><a class=lnlinks href=#hl-0-31>31</a>
</span><span class=lnt id=hl-0-32><a class=lnlinks href=#hl-0-32>32</a>
</span><span class=lnt id=hl-0-33><a class=lnlinks href=#hl-0-33>33</a>
</span><span class=lnt id=hl-0-34><a class=lnlinks href=#hl-0-34>34</a>
</span><span class=lnt id=hl-0-35><a class=lnlinks href=#hl-0-35>35</a>
</span><span class=lnt id=hl-0-36><a class=lnlinks href=#hl-0-36>36</a>
</span><span class=lnt id=hl-0-37><a class=lnlinks href=#hl-0-37>37</a>
</span><span class=lnt id=hl-0-38><a class=lnlinks href=#hl-0-38>38</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// CORS 미들웨어 구현
</span></span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cors</span> <span class=o>=</span> <span class=p>(</span><span class=nx>options</span> <span class=o>=</span> <span class=p>{})</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 1. Origin 검증
</span></span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>requestOrigin</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>origin</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>allowedOrigins</span> <span class=o>=</span> <span class=nx>options</span><span class=p>.</span><span class=nx>origins</span> <span class=o>||</span> <span class=p>[</span><span class=s1>&#39;http://localhost:3000&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>allowedOrigins</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=nx>requestOrigin</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 허용된 출처인 경우
</span></span></span><span class=line><span class=cl>            <span class=nx>res</span><span class=p>.</span><span class=nx>setHeader</span><span class=p>(</span><span class=s1>&#39;Access-Control-Allow-Origin&#39;</span><span class=p>,</span> <span class=nx>requestOrigin</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 허용되지 않은 출처인 경우
</span></span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>403</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;허용되지 않은 출처입니다.&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 2. 메서드 검증
</span></span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>allowedMethods</span> <span class=o>=</span> <span class=nx>options</span><span class=p>.</span><span class=nx>methods</span> <span class=o>||</span> <span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span> <span class=s1>&#39;PUT&#39;</span><span class=p>,</span> <span class=s1>&#39;DELETE&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>setHeader</span><span class=p>(</span><span class=s1>&#39;Access-Control-Allow-Methods&#39;</span><span class=p>,</span> <span class=nx>allowedMethods</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=s1>&#39;, &#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 3. 헤더 검증
</span></span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>allowedHeaders</span> <span class=o>=</span> <span class=nx>options</span><span class=p>.</span><span class=nx>headers</span> <span class=o>||</span> <span class=p>[</span><span class=s1>&#39;Content-Type&#39;</span><span class=p>,</span> <span class=s1>&#39;Authorization&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>setHeader</span><span class=p>(</span><span class=s1>&#39;Access-Control-Allow-Headers&#39;</span><span class=p>,</span> <span class=nx>allowedHeaders</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=s1>&#39;, &#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 4. 자격 증명 (Credentials) 설정
</span></span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>options</span><span class=p>.</span><span class=nx>credentials</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>res</span><span class=p>.</span><span class=nx>setHeader</span><span class=p>(</span><span class=s1>&#39;Access-Control-Allow-Credentials&#39;</span><span class=p>,</span> <span class=s1>&#39;true&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 5. Preflight 요청 처리
</span></span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>method</span> <span class=o>===</span> <span class=s1>&#39;OPTIONS&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>204</span><span class=p>).</span><span class=nx>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/system-and-software-architecture/>System-and-Software-Architecture</a></li><li><a href=https://buenhyden.github.io/tags/msa-patterns/>MSA-Patterns</a></li><li><a href=https://buenhyden.github.io/tags/security/>Security</a></li><li><a href=https://buenhyden.github.io/tags/cors/>CORS</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/security--compliance/application-security/api-security/api-gateway-security/api-keys/api-key-authentication/><span class=title>« Prev</span><br><span>API Key Authentication</span>
</a><a class=next href=https://buenhyden.github.io/posts/networking--protocols/core-protocols/application-layer/protocols/identity--directory--aaa/federation--authorization/oauth-2.x/oauth2-oidc/><span class=title>Next »</span><br><span>OAuth2/OIDC (OpenID Connect)</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>