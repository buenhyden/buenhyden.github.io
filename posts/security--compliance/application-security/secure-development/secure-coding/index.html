<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>보안 코딩 (Secure Coding) | hyunyoun's Blog</title><meta name=keywords content="System-and-Software-Architecture,Secure-Coding"><meta name=description content="Secure Coding은 소프트웨어 개발 과정에서 보안 취약점을 최소화하고 안전한 소프트웨어를 만들기 위한 코딩 기법이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/security--compliance/application-security/secure-development/secure-coding/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/security--compliance/application-security/secure-development/secure-coding/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/security--compliance/application-security/secure-development/secure-coding/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/security--compliance/application-security/secure-development/secure-coding/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="보안 코딩 (Secure Coding)"><meta property="og:description" content="Secure Coding은 소프트웨어 개발 과정에서 보안 취약점을 최소화하고 안전한 소프트웨어를 만들기 위한 코딩 기법이다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="보안 코딩 (Secure Coding)"><meta name=twitter:description content="Secure Coding은 소프트웨어 개발 과정에서 보안 취약점을 최소화하고 안전한 소프트웨어를 만들기 위한 코딩 기법이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HY's Blog","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":3,"name":"보안 코딩 (Secure Coding)","item":"https://buenhyden.github.io/posts/security--compliance/application-security/secure-development/secure-coding/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>HY's Blog</a></div><h1>보안 코딩 (Secure Coding)</h1><div class=post-description>Secure Coding은 소프트웨어 개발 과정에서 보안 취약점을 최소화하고 안전한 소프트웨어를 만들기 위한 코딩 기법이다.</div></header><div class=post-content><h2 id=보안-코딩-secure-coding>보안 코딩 (Secure Coding)<a hidden class=anchor aria-hidden=true href=#보안-코딩-secure-coding>#</a></h2><p>아래는 요청하신 " 보안 코딩 (Secure Coding)" 주제에 대한 체계적이고 심층적인 분석입니다.</p><hr><h2 id=1-적절한-태그>1. 적절한 태그<a hidden class=anchor aria-hidden=true href=#1-적절한-태그>#</a></h2><ul><li>Secure-Coding</li><li>Application-Security</li><li>Software-Engineering</li><li>Cyber-Security</li></ul><hr><h2 id=2-카테고리-계층-구조-분석>2. 카테고리 계층 구조 분석<a hidden class=anchor aria-hidden=true href=#2-카테고리-계층-구조-분석>#</a></h2><p><strong>분류:</strong><br>Computer Science and Engineering > Software Engineering > Software Engineering Foundations</p><p><strong>근거 및 분석:</strong><br>보안 코딩 (Secure Coding) 은 소프트웨어의 보안 취약점을 사전에 방지하는 실천법으로, 소프트웨어 공학 (Software Engineering) 의 핵심 원칙 중 하나입니다. 소프트웨어 공학은 소프트웨어 개발의 전체 생명주기 (Software Development Life Cycle, SDLC) 를 다루며, 그 안에 소프트웨어 공학 기초 (Software Engineering Foundations) 가 포함됩니다. 보안 코딩은 SDLC 전반에 걸쳐 적용되어야 하므로, 이 분류는 적절합니다 [1][2][3].</p><hr><h2 id=3-주제-요약-200-자-내외>3. 주제 요약 (200 자 내외)<a hidden class=anchor aria-hidden=true href=#3-주제-요약-200-자-내외>#</a></h2><p>보안 코딩은 소프트웨어 개발 전 과정에서 보안 취약점을 사전에 방지하기 위해 코드 작성 시 지켜야 할 원칙과 기법을 적용하는 실천법이다. 입력 검증, 인증, 암호화, 오류 처리 등이 핵심이다 [1][2][3].</p><hr><h2 id=4-전체-개요-250-자-내외>4. 전체 개요 (250 자 내외)<a hidden class=anchor aria-hidden=true href=#4-전체-개요-250-자-내외>#</a></h2><p>보안 코딩은 소프트웨어 개발 과정에서 보안 위협을 사전에 차단하기 위한 모든 실천법을 의미한다. 입력 검증, 인증, 암호화, 최소 권한 원칙 등 다양한 보안 기법이 적용되며, SDLC 전반에 걸쳐 보안을 내재화함으로써 데이터와 시스템의 무결성, 기밀성, 가용성을 보장한다 [1][2][3].</p><hr><h2 id=5-핵심-개념>5. 핵심 개념<a hidden class=anchor aria-hidden=true href=#5-핵심-개념>#</a></h2><p><strong>이론 및 실무, 기본과 심화를 통틀어 반드시 알아야 하는 내용</strong></p><ul><li><strong>보안 코딩 (Secure Coding):</strong> 소프트웨어 개발 시 코드를 작성하면서 보안 취약점이 발생하지 않도록 설계하고 구현하는 실천법 [1][2][4].</li><li><strong>보안 취약점:</strong> 입력 검증 부족, 인증/인가 오류, 암호화 미흡, 오류 처리 미비 등으로 인해 발생하는 위협 요소 [5][6][7].</li><li><strong>보안 원칙:</strong> 최소 권한 원칙 (Principle of Least Privilege), 입력 검증 (Input Validation), 출력 인코딩 (Output Encoding), 인증 및 권한 부여 (Authentication & Authorization), 암호화 (Encryption), 오류 처리 (Error Handling), 보안 표준 준수 등 [5][1][8].</li><li><strong>실무 구현:</strong> SDLC 전반 (설계, 개발, 테스트, 배포, 유지보수) 에 보안을 내재화하고, 정적/동적 코드 분석, 보안 테스팅, 코드 리뷰, 보안 교육 등으로 취약점을 사전에 차단 [1][2][3].</li><li><strong>관련성:</strong> 실무에서는 보안 코딩이 소프트웨어의 신뢰성, 데이터 보호, 법적/규제 준수, 조직의 평판 유지에 직접적으로 영향을 미침 [9][10][11].</li></ul><hr><h2 id=6-주제와-관련하여-조사할-내용>6. 주제와 관련하여 조사할 내용<a hidden class=anchor aria-hidden=true href=#6-주제와-관련하여-조사할-내용>#</a></h2><h3 id=1-핵심-개념>1) 핵심 개념<a hidden class=anchor aria-hidden=true href=#1-핵심-개념>#</a></h3><ul><li><strong>정의:</strong> 보안 코딩은 소프트웨어 개발 시 보안 취약점을 사전에 방지하는 코드 작성 실천법 [1][2][4].</li><li><strong>실무 연관성:</strong> 개발자 교육, 보안 표준 준수, 코드 리뷰, 자동화된 보안 테스트 등이 필요 [1][2][3].</li></ul><h3 id=2-배경>2) 배경<a hidden class=anchor aria-hidden=true href=#2-배경>#</a></h3><ul><li><strong>배경:</strong> 사이버 공격의 증가, 데이터 유출, 규제 강화 등으로 인해 소프트웨어 보안의 중요성이 커짐 [1][10][11].</li><li><strong>역사적 맥락:</strong> 과거에는 보안이 개발 후반에 고려되었으나, 최근에는 개발 초기부터 보안을 내재화하는 &lsquo;Shift-Left&rsquo; 접근이 표준화됨 [7][11][3].</li></ul><h3 id=3-목적-및-필요성>3) 목적 및 필요성<a hidden class=anchor aria-hidden=true href=#3-목적-및-필요성>#</a></h3><ul><li><strong>목적:</strong> 소프트웨어의 보안 취약점을 사전에 차단하여 데이터와 시스템을 보호 [1][2][4].</li><li><strong>필요성:</strong> 데이터 유출, 서비스 중단, 법적 책임, 평판 손상 등 위험을 예방 [9][10][11].</li></ul><h3 id=4-주요-기능-및-역할>4) 주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#4-주요-기능-및-역할>#</a></h3><ul><li><strong>입력 검증:</strong> 악의적 입력 차단 [1][6][12].</li><li><strong>인증/인가:</strong> 사용자 식별 및 권한 관리 [5][2][12].</li><li><strong>암호화:</strong> 데이터 보호 [5][2][8].</li><li><strong>오류 처리:</strong> 민감 정보 노출 방지 [5][2][12].</li><li><strong>최소 권한 원칙:</strong> 권한 남용 방지 [5][13][4].</li></ul><h3 id=5-특징>5) 특징<a hidden class=anchor aria-hidden=true href=#5-특징>#</a></h3><ul><li><strong>프로세스 내재화:</strong> SDLC 전반에 보안 내재 [1][2][7].</li><li><strong>지속적 개선:</strong> 새로운 위협에 대응하기 위한 교육 및 업데이트 [5][1][7].</li><li><strong>자동화:</strong> 정적/동적 코드 분석 도구 활용 [11][7][3].</li></ul><h3 id=6-핵심-원칙>6) 핵심 원칙<a hidden class=anchor aria-hidden=true href=#6-핵심-원칙>#</a></h3><ul><li><strong>최소 권한 원칙:</strong> 필요한 권한만 부여 [5][13][4].</li><li><strong>입력 검증:</strong> 모든 입력에 대해 엄격한 검증 [1][6][12].</li><li><strong>출력 인코딩:</strong> 악의적 코드 실행 방지 [8][12][7].</li><li><strong>인증/인가:</strong> 강력한 사용자 관리 [5][2][12].</li><li><strong>암호화:</strong> 데이터 보호 [5][2][8].</li><li><strong>오류 처리:</strong> 민감 정보 노출 방지 [5][2][12].</li></ul><h3 id=7-주요-원리>7) 주요 원리<a hidden class=anchor aria-hidden=true href=#7-주요-원리>#</a></h3><ul><li><strong>신뢰하지 않는 입력:</strong> 모든 입력은 검증되어야 함 [1][6][12].</li><li><strong>보안 설계:</strong> 아키텍처 단계에서 보안 고려 [1][7][14].</li><li><strong>지속적 테스트:</strong> 코드 리뷰, 자동화 테스트 [11][7][3].</li></ul><h3 id=8-작동-원리>8) 작동 원리<a hidden class=anchor aria-hidden=true href=#8-작동-원리>#</a></h3><ul><li><strong>입력 검증:</strong> 사용자 입력을 서버에서 검증 [1][6][12].</li><li><strong>인증/인가:</strong> 사용자 식별 및 권한 확인 [5][2][12].</li><li><strong>암호화:</strong> 데이터 저장 및 전송 시 암호화 [5][2][8].</li><li><strong>오류 처리:</strong> 오류 발생 시 민감 정보 노출 방지 [5][2][12].</li></ul><h4 id=다이어그램-보안-코딩-작동-원리>다이어그램: 보안 코딩 작동 원리<a hidden class=anchor aria-hidden=true href=#다이어그램-보안-코딩-작동-원리>#</a></h4><pre class=mermaid>flowchart TD
    A[사용자 입력] --&gt; B[입력 검증]
    B --&gt; C[인증/인가]
    C --&gt; D[암호화]
    D --&gt; E[처리]
    E --&gt; F[출력 인코딩]
    F --&gt; G[오류 처리]
    G --&gt; H[결과 반환]
</pre><h3 id=9-구조-및-아키텍처>9) 구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#9-구조-및-아키텍처>#</a></h3><ul><li><strong>구성 요소:</strong><ul><li><strong>입력 검증 모듈</strong></li><li><strong>인증/인가 모듈</strong></li><li><strong>암호화 모듈</strong></li><li><strong>오류 처리 모듈</strong></li><li><strong>로그 및 모니터링 모듈</strong></li></ul></li><li><strong>기능 및 역할:</strong><ul><li><strong>입력 검증:</strong> 악의적 입력 차단</li><li><strong>인증/인가:</strong> 사용자 식별 및 권한 관리</li><li><strong>암호화:</strong> 데이터 보호</li><li><strong>오류 처리:</strong> 민감 정보 노출 방지</li><li><strong>로그 및 모니터링:</strong> 이상 징후 탐지 및 대응</li></ul></li><li><strong>필수 구성요소:</strong> 입력 검증, 인증/인가, 암호화, 오류 처리</li><li><strong>선택 구성요소:</strong> 로그 및 모니터링, 보안 테스트 자동화</li></ul><h4 id=다이어그램-보안-코딩-구조>다이어그램: 보안 코딩 구조<a hidden class=anchor aria-hidden=true href=#다이어그램-보안-코딩-구조>#</a></h4><pre class=mermaid>graph TD
    A[입력 검증] --&gt; B[인증/인가]
    B --&gt; C[암호화]
    C --&gt; D[처리]
    D --&gt; E[출력 인코딩]
    E --&gt; F[오류 처리]
    F --&gt; G[로그 및 모니터링]
</pre><h3 id=10-구현-기법>10) 구현 기법<a hidden class=anchor aria-hidden=true href=#10-구현-기법>#</a></h3><ul><li><strong>입력 검증:</strong> 서버측 검증, 화이트리스트 방식, 정규표현식, 타입/길이/범위 검사 [1][6][12].</li><li><strong>인증/인가:</strong> 강력한 패스워드 정책, MFA, 세션 관리, RBAC[5][2][12].</li><li><strong>암호화:</strong> TLS, AES, HSM, 키 관리 [5][2][8].</li><li><strong>오류 처리:</strong> 민감 정보 노출 방지, 로그 관리 [5][2][12].</li><li><strong>보안 테스트:</strong> 정적/동적 코드 분석, 침투 테스트 [11][7][3].</li></ul><h3 id=11-장점>11) 장점<a hidden class=anchor aria-hidden=true href=#11-장점>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>장점</td><td>취약점 예방</td><td>보안 취약점을 사전에 차단하여 공격을 예방</td></tr><tr><td></td><td>데이터 보호</td><td>사용자 데이터의 무결성, 기밀성, 가용성 보장</td></tr><tr><td></td><td>법적/규제 준수</td><td>GDPR, CCPA 등 데이터 보호 규제 준수</td></tr><tr><td></td><td>평판 유지</td><td>보안 사고로 인한 평판 손상 방지</td></tr><tr><td></td><td>개발 효율성</td><td>초기 보안 내재화로 후속 보안 패치 비용 절감</td></tr></tbody></table><h3 id=12-단점과-문제점-그리고-해결방안>12) 단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#12-단점과-문제점-그리고-해결방안>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>단점</td><td>개발 비용 증가</td><td>보안 코드 작성 및 테스트로 인한 초기 개발 비용 증가</td><td>자동화 도구 활용, 교육 강화</td></tr><tr><td></td><td>학습 곡선</td><td>보안 지식 부족으로 인한 학습 부담</td><td>지속적 교육, 멘토링</td></tr><tr><td></td><td>복잡성 증가</td><td>보안 코드로 인한 시스템 복잡성 증가</td><td>모듈화, 문서화, 코드 리뷰</td></tr></tbody></table><table><thead><tr><th>구분</th><th>항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 방법 및 기법</th></tr></thead><tbody><tr><td>문제점</td><td>입력 검증 미흡</td><td>사용자 입력 검증 미흡</td><td>SQL Injection, XSS</td><td>코드 분석, 테스트</td><td>입력 검증 강화</td><td>화이트리스트 방식 적용</td></tr><tr><td></td><td>인증/인가 오류</td><td>권한 관리 미흡</td><td>권한 상승, 데이터 유출</td><td>로그 분석, 테스트</td><td>RBAC, MFA 도입</td><td>강력한 인증/인가 적용</td></tr><tr><td></td><td>암호화 미흡</td><td>데이터 암호화 미흡</td><td>데이터 유출</td><td>코드 분석, 테스트</td><td>암호화 정책 강화</td><td>TLS, AES 적용</td></tr><tr><td></td><td>오류 처리 미흡</td><td>오류 메시지 노출</td><td>민감 정보 노출</td><td>코드 분석, 테스트</td><td>오류 처리 강화</td><td>오류 메시지 숨김</td></tr></tbody></table><h3 id=13-도전-과제>13) 도전 과제<a hidden class=anchor aria-hidden=true href=#13-도전-과제>#</a></h3><ul><li><strong>신규 위협 대응:</strong> AI, 자동화 공격 등 신규 위협에 대한 지속적 대응 필요 [10][7].</li><li><strong>오픈소스/서드파티 리스크:</strong> 오픈소스 라이브러리 보안 취약점 관리 [10][7].</li><li><strong>클라우드/DevSecOps:</strong> 클라우드 환경, CI/CD 파이프라인 보안 강화 [10][7].</li><li><strong>보안 인식 부족:</strong> 개발자 보안 인식 및 교육 필요 [9][11][3].</li></ul><h3 id=14-분류-기준에-따른-종류-및-유형>14) 분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#14-분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th>분류 기준</th><th>종류/유형</th><th>설명</th></tr></thead><tbody><tr><td>적용 단계</td><td>설계/개발/테스트/배포</td><td>SDLC 단계별 보안 코딩 적용</td></tr><tr><td>기술 영역</td><td>웹/모바일/클라우드/IoT</td><td>플랫폼별 보안 코딩 적용</td></tr><tr><td>보안 표준</td><td>OWASP, CERT, NIST</td><td>국제 표준에 따른 보안 코딩 적용</td></tr></tbody></table><h3 id=15-실무-사용-예시>15) 실무 사용 예시<a hidden class=anchor aria-hidden=true href=#15-실무-사용-예시>#</a></h3><table><thead><tr><th>사용 목적</th><th>함께 사용되는 기술/도구</th><th>효과</th></tr></thead><tbody><tr><td>웹 애플리케이션</td><td>입력 검증, 인증, 암호화</td><td>SQL Injection, XSS 방지</td></tr><tr><td>모바일 앱</td><td>데이터 암호화, 인증</td><td>데이터 유출 방지</td></tr><tr><td>클라우드 서비스</td><td>IAM, 암호화, 로그 관리</td><td>권한 관리, 데이터 보호</td></tr></tbody></table><h3 id=16-활용-사례>16) 활용 사례<a hidden class=anchor aria-hidden=true href=#16-활용-사례>#</a></h3><p><strong>사례: 웹 애플리케이션 보안 강화</strong></p><ul><li><strong>시스템 구성:</strong> 사용자 입력 → 입력 검증 → 인증/인가 → 데이터 처리 → 출력 인코딩 → 오류 처리 → 결과 반환</li><li><strong>Workflow:</strong><ol><li>사용자가 데이터 입력</li><li>서버에서 입력 검증</li><li>인증/인가 확인</li><li>데이터 처리</li><li>출력 인코딩</li><li>오류 발생 시 민감 정보 노출 방지</li><li>결과 반환</li></ol></li><li><strong>보안 코딩 역할:</strong> SQL Injection, XSS, 권한 상승 등 보안 취약점 방지</li><li><strong>차이점:</strong> 보안 코딩 미적용 시 데이터 유출, 서비스 중단, 평판 손상 등 심각한 피해 발생 가능</li></ul><h4 id=다이어그램-웹-애플리케이션-보안-코딩-workflow>다이어그램: 웹 애플리케이션 보안 코딩 Workflow<a hidden class=anchor aria-hidden=true href=#다이어그램-웹-애플리케이션-보안-코딩-workflow>#</a></h4><pre class=mermaid>flowchart TD
    A[사용자 입력] --&gt; B[입력 검증]
    B --&gt; C[인증/인가]
    C --&gt; D[데이터 처리]
    D --&gt; E[출력 인코딩]
    E --&gt; F[오류 처리]
    F --&gt; G[결과 반환]
</pre><h3 id=17-구현-예시-python>17) 구현 예시 (Python)<a hidden class=anchor aria-hidden=true href=#17-구현-예시-python>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16>16</a>
</span><span class=lnt id=hl-3-17><a class=lnlinks href=#hl-3-17>17</a>
</span><span class=lnt id=hl-3-18><a class=lnlinks href=#hl-3-18>18</a>
</span><span class=lnt id=hl-3-19><a class=lnlinks href=#hl-3-19>19</a>
</span><span class=lnt id=hl-3-20><a class=lnlinks href=#hl-3-20>20</a>
</span><span class=lnt id=hl-3-21><a class=lnlinks href=#hl-3-21>21</a>
</span><span class=lnt id=hl-3-22><a class=lnlinks href=#hl-3-22>22</a>
</span><span class=lnt id=hl-3-23><a class=lnlinks href=#hl-3-23>23</a>
</span><span class=lnt id=hl-3-24><a class=lnlinks href=#hl-3-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>escape</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 입력 검증 및 출력 인코딩 예시</span>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/submit&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>submit</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 입력 검증: 알파벳, 숫자만 허용</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>name</span><span class=o>.</span><span class=n>isalnum</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;잘못된 입력입니다.&#34;</span><span class=p>,</span> <span class=mi>400</span>
</span></span><span class=line><span class=cl>    <span class=c1># 출력 인코딩</span>
</span></span><span class=line><span class=cl>    <span class=n>safe_name</span> <span class=o>=</span> <span class=n>escape</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 패스워드 해싱 예시</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>password</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>hashed</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;패스워드가 필요합니다.&#34;</span><span class=p>,</span> <span class=mi>400</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=sa>f</span><span class=s2>&#34;안녕하세요, </span><span class=si>{</span><span class=n>safe_name</span><span class=si>}</span><span class=s2>! 패스워드 해시: </span><span class=si>{</span><span class=n>hashed</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>이 코드는 입력 검증, 출력 인코딩, 패스워드 해싱 등 보안 코딩의 핵심 원칙을 반영합니다 [15][3].</p></blockquote><h3 id=18-도전-과제>18) 도전 과제<a hidden class=anchor aria-hidden=true href=#18-도전-과제>#</a></h3><table><thead><tr><th>카테고리</th><th>과제 내용</th><th>원인/영향/진단/예방/해결방법</th></tr></thead><tbody><tr><td>신규 위협 대응</td><td>AI, 자동화 공격</td><td>지속적 교육, 자동화 도구 활용, 위협 모델링</td></tr><tr><td>오픈소스 리스크</td><td>오픈소스 취약점</td><td>취약점 관리, 정기적 업데이트, SBOM 활용</td></tr><tr><td>클라우드 보안</td><td>클라우드 설정 오류</td><td>DevSecOps, 자동화 테스트, IAM 강화</td></tr><tr><td>보안 인식 부족</td><td>개발자 보안 인식 미흡</td><td>교육, 멘토링, 보안 문화 조성</td></tr></tbody></table><h3 id=19-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>19) 실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#19-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>항목</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>지속적 교육</td><td>보안 위협과 최신 기법에 대한 교육 필요</td><td>정기적 교육, 멘토링</td></tr><tr><td>자동화 도구 활용</td><td>코드 분석, 테스트 자동화로 효율성 향상</td><td>SAST/DAST 도구 도입</td></tr><tr><td>보안 표준 준수</td><td>OWASP, CERT 등 국제 표준 준수</td><td>표준 문서 참고, 코드 리뷰</td></tr><tr><td>오픈소스 관리</td><td>오픈소스 취약점 관리 필요</td><td>취약점 스캔, 정기적 업데이트</td></tr><tr><td>보안 문화 조성</td><td>조직 전체의 보안 인식 제고</td><td>보안 정책 수립, 인센티브 제공</td></tr></tbody></table><h3 id=20-최적화하기-위한-고려사항-및-주의할-점>20) 최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#20-최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>항목</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>모듈화</td><td>보안 기능 모듈화로 유지보수성 향상</td><td>모듈화 설계, 문서화</td></tr><tr><td>자동화</td><td>보안 테스트, 배포 자동화로 효율성 향상</td><td>CI/CD 파이프라인 구축</td></tr><tr><td>지속적 개선</td><td>신규 위협에 대한 지속적 대응</td><td>위협 모델링, 교육</td></tr><tr><td>성능 영향 최소화</td><td>보안 기능이 성능에 미치는 영향 최소화</td><td>성능 테스트, 최적화</td></tr></tbody></table><h3 id=21-기타-사항>21) 기타 사항<a hidden class=anchor aria-hidden=true href=#21-기타-사항>#</a></h3><ul><li><strong>보안 코딩은 개발자 개인의 책임뿐 아니라 조직 전체의 문화로 자리잡아야 함</strong></li><li><strong>보안 코딩은 법적/규제 준수, 평판 유지, 비즈니스 연속성에 필수적임</strong></li><li><strong>최신 보안 위협과 트렌드에 대한 지속적 학습이 필요함</strong></li></ul><hr><h2 id=9-주제와-관련하여-주목할-내용>9. 주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#9-주제와-관련하여-주목할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>보안 원칙</td><td>최소 권한</td><td>Principle of Least Privilege</td><td>필요한 권한만 부여하여 취약점 최소화</td></tr><tr><td>입력 검증</td><td>화이트리스트</td><td>Input Validation</td><td>허용된 입력만 받아들여 악의적 입력 차단</td></tr><tr><td>인증/인가</td><td>RBAC, MFA</td><td>Authentication</td><td>사용자 식별 및 권한 관리, 다중 인증 적용</td></tr><tr><td>암호화</td><td>TLS, AES</td><td>Encryption</td><td>데이터 저장 및 전송 시 암호화</td></tr><tr><td>오류 처리</td><td>민감 정보 노출 방지</td><td>Error Handling</td><td>오류 발생 시 민감 정보 노출 방지</td></tr><tr><td>보안 테스트</td><td>SAST, DAST</td><td>Security Testing</td><td>정적/동적 코드 분석으로 취약점 탐지</td></tr><tr><td>보안 표준</td><td>OWASP, CERT</td><td>Security Standards</td><td>국제 보안 표준 준수</td></tr></tbody></table><hr><h2 id=10-반드시-학습해야-할-내용>10. 반드시 학습해야 할 내용<a hidden class=anchor aria-hidden=true href=#10-반드시-학습해야-할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>보안 원칙</td><td>최소 권한</td><td>Principle of Least Privilege</td><td>권한 관리의 기본 원칙</td></tr><tr><td>입력 검증</td><td>화이트리스트</td><td>Input Validation</td><td>악의적 입력 차단을 위한 필수 기법</td></tr><tr><td>인증/인가</td><td>RBAC, MFA</td><td>Authentication</td><td>사용자 식별 및 권한 관리, 다중 인증 적용</td></tr><tr><td>암호화</td><td>TLS, AES</td><td>Encryption</td><td>데이터 보호를 위한 암호화</td></tr><tr><td>오류 처리</td><td>민감 정보 노출 방지</td><td>Error Handling</td><td>오류 발생 시 민감 정보 노출 방지</td></tr><tr><td>보안 테스트</td><td>SAST, DAST</td><td>Security Testing</td><td>코드 취약점 탐지를 위한 자동화 도구</td></tr><tr><td>보안 표준</td><td>OWASP, CERT</td><td>Security Standards</td><td>국제 보안 표준 준수</td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>보안 원칙</td><td>최소 권한 원칙</td><td>사용자/프로세스에게 필요한 최소한의 권한만 부여하는 원칙</td></tr><tr><td>입력 검증</td><td>화이트리스트</td><td>허용된 입력만 받아들이는 검증 방식</td></tr><tr><td>인증/인가</td><td>RBAC</td><td>역할 기반 접근 제어</td></tr><tr><td>인증/인가</td><td>MFA</td><td>다중 인증</td></tr><tr><td>암호화</td><td>TLS</td><td>전송 계층 보안 프로토콜</td></tr><tr><td>암호화</td><td>AES</td><td>고급 암호화 표준</td></tr><tr><td>오류 처리</td><td>민감 정보 노출 방지</td><td>오류 발생 시 민감 정보가 노출되지 않도록 처리</td></tr><tr><td>보안 테스트</td><td>SAST</td><td>정적 애플리케이션 보안 테스트</td></tr><tr><td>보안 테스트</td><td>DAST</td><td>동적 애플리케이션 보안 테스트</td></tr><tr><td>보안 표준</td><td>OWASP</td><td>Open Web Application Security Project</td></tr><tr><td>보안 표준</td><td>CERT</td><td>소프트웨어 보안 표준 및 가이드라인</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://securityboulevard.com/2025/04/secure-coding-practices-guide-principles-vulnerabilities-and-verification/>보안 코딩의 원리와 취약점, 검증 방법 가이드</a></li><li><a href=https://www.sonarsource.com/learn/secure-coding/>보안 코딩이란? Sonar 설명</a></li><li><a href=https://www.appsecengineer.com/blog/the-art-of-secure-coding>보안 코딩 핵심 개념 및 실무 적용, AppSecEngineer</a></li><li><a href=https://github.com/sahildari/secure-coding-examples>보안 코딩 예시 코드, GitHub</a></li><li><a href=https://www.veracode.com/sites/default/files/pdf/resources/guides/secure-coding-best-practices-handbook-veracode-guide.pdf>보안 코딩 핸드북, Veracode</a></li><li><a href=https://www.jit.io/resources/app-security/secure-coding-top-risks-best-practices-and-techniques>보안 코딩 실무 적용 및 도전 과제, Jit.io</a></li><li><a href=https://www.securecodewarrior.com/article/platform-architecture-diagram>보안 코딩 실무 적용, Secure Code Warrior</a></li><li><a href=https://dev.to/godofgeeks/secure-coding-practices-599d>보안 코딩 실무 적용 및 장단점, dev.to</a></li><li><a href=https://www.checkpoint.com/cyber-hub/cloud-security/what-is-secure-coding/>보안 코딩의 중요성 및 표준, Check Point</a></li><li><a href=https://cheatsheetseries.owasp.org/cheatsheets/Secure_Cloud_Architecture_Cheat_Sheet.html>보안 코딩 표준, OWASP</a></li><li><a href=https://bluegoatcyber.com/blog/the-importance-of-security-architecture-diagrams/>보안 아키텍처 다이어그램 설명, Blue Goat Cyber</a></li></ul><p>아래는 요청하신 <strong>" 보안 코딩 (Secure Coding)"</strong> 주제에 대한 체계적인 조사 및 분석의 <strong>작업 1~4</strong> 단계 결과입니다. 이후 단계에서 점진적으로 상세 내용을 채워나가겠습니다.</p><hr><h2 id=1--태그-제안-영문하이픈-표기>1. ✅ 태그 제안 (영문‑하이픈 표기)<a hidden class=anchor aria-hidden=true href=#1--태그-제안-영문하이픈-표기>#</a></h2><ul><li><code>Secure-Coding</code></li><li><code>Application-Security</code></li><li><code>Secure-Development</code></li><li><code>Software-Hardening</code></li></ul><hr><h2 id=2-분류-구조-적절성-분석>2. 분류 구조 적절성 분석<a hidden class=anchor aria-hidden=true href=#2-분류-구조-적절성-분석>#</a></h2><p>현재 분류:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2>2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Computer Science and Engineering 
</span></span><span class=line><span class=cl> └─ Software Engineering 
</span></span><span class=line><span class=cl>     └─ Software Engineering Foundations
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>근거</strong>:<ul><li>보안 코딩은 소프트웨어 개발 (Software Engineering) 의 핵심 요소로, SW 품질·신뢰성 향상을 위해 필수.</li><li>기초 Foundations 범주 안에 포함되어야 할 이론 + 실무 주제이며, 맞는 구조입니다.</li></ul></li><li><strong>제안</strong>:<ul><li>상위 수준으로 <code>Software Security</code> 나 <code>Application Security</code> 를 추가하면 더 명확할 수 있습니다.</li></ul></li></ul><hr><h2 id=3-200-자-내외-요약>3. 200 자 내외 요약<a hidden class=anchor aria-hidden=true href=#3-200-자-내외-요약>#</a></h2><p>보안 코딩은 소프트웨어 설계·개발 단계에서 취약점을 사전에 제거하고, 입력 검증·에러 처리·인증/인가 등 원칙을 적용해 안전성을 보장하는 실무 중심 기법입니다.</p><hr><h2 id=4-250-자-개요>4. 250 자 개요<a hidden class=anchor aria-hidden=true href=#4-250-자-개요>#</a></h2><p>보안 코딩은 개발 라이프사이클 (Lifecycle) 의 모든 단계에서 취약점 (Vulnerability) 을 차단하고, 안전한 소프트웨어를 구축하기 위한 실전 전략입니다. 주요 원칙으로는 입력 검증, 경계 검사, 적절한 에러 처리, 최소 권한 원칙 (Principle of Least Privilege), 암호화 등이 있으며, 정적·동적 분석 도구 기반 자동화 기법과 코드 리뷰, 테스트를 통해 안전성을 강화합니다. 적용 시 조직문화, 개발 도구와 프로세스 연계, 성능 및 운영환경 고려 등이 중요합니다.</p><hr><p>이후 <strong>5</strong> 단계부터 차례로 본격적인 조사 및 분석 (핵심 개념, 배경, 목적, 원칙, 구조·아키텍처, 구현 기법, 장‑단점, 실무 적용 등) 을 진행하겠습니다.<br>특히 mermaid 다이어그램, 표, 예시 코드 포함해 깊이 있게 다룰 예정이며 단계별 확인이 필요하시면 언제든 피드백 주세요.</p><p>다음은 <strong>5 단계부터</strong> 시작하는 " 보안 코딩 (Secure Coding)" 주제에 대한 심화 분석입니다.</p><hr><h2 id=5--핵심-개념>5. 🔐 핵심 개념<a hidden class=anchor aria-hidden=true href=#5--핵심-개념>#</a></h2><p>보안 코딩에서 반드시 알아야 할 핵심 개념은 다음과 같습니다.</p><table><thead><tr><th>개념</th><th>설명</th></tr></thead><tbody><tr><td>입력 검증 (Input Validation)</td><td>유효성 검사, 화이트리스트/블랙리스트 기반 검사</td></tr><tr><td>경계 검사 (Boundary Checking)</td><td>버퍼 오버플로 방지, 인덱스 검증</td></tr><tr><td>최소 권한 원칙 (Least Privilege)</td><td>최소 권한으로 실행, 권한 상승 방지</td></tr><tr><td>인증·인가 (Authentication & Authorization)</td><td>신원 확인 및 권한 제어</td></tr><tr><td>예외 및 에러 처리 (Error Handling)</td><td>민감 정보 노출 방지 및 일관된 에러 대응</td></tr><tr><td>암호화 (Cryptography)</td><td>데이터 기밀성·무결성 확보</td></tr><tr><td>로깅 및 모니터링 (Logging & Monitoring)</td><td>감사 추적, 이상 징후 탐지</td></tr><tr><td>세션 관리 (Session Management)</td><td>세션 고정 방지, 세션 타임아웃 설정</td></tr><tr><td>보안 라이브러리 사용</td><td>안전한 API·라이브러리 활용</td></tr><tr><td>코드 분석 (Static/Dynamic Analysis)</td><td>도구 기반 취약점 검색</td></tr></tbody></table><h3 id=51-실무-구현-연관성-분석>5.1 실무 구현 연관성 분석<a hidden class=anchor aria-hidden=true href=#51-실무-구현-연관성-분석>#</a></h3><ul><li><strong>입력 검증</strong>: SQL Injection 및 XSS 예방 (예: PreparedStatement, Param Binding)</li><li><strong>경계 검사</strong>: 메모리 언어 (C/C++), ArrayIndexOutOfBounds 방지</li><li><strong>최소 권한</strong>: 데이터베이스 계정 구분, 마이크로서비스 접근 권한 분리</li><li><strong>인증·인가</strong>: OAuth, JWT, RBAC/ABAC 구조 설계</li><li><strong>예외 처리</strong>: 상세 에러 메시지 제거, 사용자 친화적 Error Page 설계</li><li><strong>암호화</strong>: HTTPS/TLS, AES, RSA, 키 관리 시스템 (KMS) 연동</li><li><strong>로깅</strong>: Sentry, ELK/EFK 기반 보안 이벤트 모니터링</li><li><strong>세션 관리</strong>: HttpOnly, Secure 쿠키, CSRF 토큰 활용</li><li><strong>보안 라이브러리</strong>: OWASP ESAPI, Spring Security, helmet.js</li><li><strong>코드 분석</strong>: SonarQube, Fortify, Veracode, SAST/DAST 통합</li></ul><hr><h2 id=6--5-주제와-관련하여-조사할-내용---기타-필수-내용>6. &ldquo;## 5. 주제와 관련하여 조사할 내용 " + 기타 필수 내용<a hidden class=anchor aria-hidden=true href=#6--5-주제와-관련하여-조사할-내용---기타-필수-내용>#</a></h2><h3 id=61-배경>6.1 배경<a hidden class=anchor aria-hidden=true href=#61-배경>#</a></h3><ul><li><strong>소프트웨어 취약점 증가</strong>: OWASP Top 10, CWE 등 보고서 기반</li><li><strong>법·규제 강화</strong>: GDPR, PCI-DSS, ISO/IEC 27001 영향</li></ul><h3 id=62-목적-및-필요성>6.2 목적 및 필요성<a hidden class=anchor aria-hidden=true href=#62-목적-및-필요성>#</a></h3><ul><li>사용자·서비스 보호, 신뢰성 확보</li><li>개발·운영 비용 절감 (사전 예방 → 사고 대응 비용 절감)</li><li>법률 준수 및 브랜드 평판 유지</li></ul><h3 id=63-주요-기능-및-역할>6.3 주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#63-주요-기능-및-역할>#</a></h3><ul><li>취약점 분석</li><li>정책 수립 (코딩 표준/가이드라인)</li><li>교육·문화 형성</li><li>보안 테스트 (정적/동적, 펜테스트)</li><li>보안 자동화 (CI/CD 보안 체크)</li></ul><h3 id=64-특징>6.4 특징<a hidden class=anchor aria-hidden=true href=#64-특징>#</a></h3><ul><li>Proactive vs Reactive (사전 예방 중심)</li><li>통합적 접근 (설계→개발→배포→운영)</li><li>반복적 개선 (지속적 코드 리뷰·펜테스트·CI/CD 연동)</li></ul><h3 id=65-핵심-원칙-변경-없음>6.5 핵심 원칙 (변경 없음)<a hidden class=anchor aria-hidden=true href=#65-핵심-원칙-변경-없음>#</a></h3><h3 id=66-주요-원리-변경-없음>6.6 주요 원리 (변경 없음)<a hidden class=anchor aria-hidden=true href=#66-주요-원리-변경-없음>#</a></h3><h3 id=67-작동-원리-변경-없음>6.7 작동 원리 (변경 없음)<a hidden class=anchor aria-hidden=true href=#67-작동-원리-변경-없음>#</a></h3><hr><p>다음 단계 (7 단계 이후) 에서는 <strong>구조·아키텍처</strong>, <strong>구현 기법</strong>, <strong>장·단점</strong>, <strong>실무 예시</strong>, <strong>도전 과제</strong>, <strong>구현 예시</strong> 등으로 확장하여 작성하겠습니다. 특정 부분부터 더 원하시면 말씀 주세요!</p><p>다음은 <strong>7 단계부터</strong> 이어지는 " 보안 코딩 (Secure Coding)&rdquo; 주제의 심화 분석입니다.</p><hr><h2 id=7--6-주제에-대한-추가-조사-내용->7. &ldquo;## 6. 주제에 대한 추가 조사 내용 "<a hidden class=anchor aria-hidden=true href=#7--6-주제에-대한-추가-조사-내용->#</a></h2><p>현재 특별히 추가로 조사해야 할 외부 항목은 없으며, 기본 주제 범주 내에서 충분히 분석된 상태입니다.<br>필요 시 최신 동향 (예: 동적토큰 검증 강화, 공급망 보안 연계 등) 을 반영할 수 있습니다.</p><hr><h2 id=8-추가로-알아야-할-내용>8. 추가로 알아야 할 내용<a hidden class=anchor aria-hidden=true href=#8-추가로-알아야-할-내용>#</a></h2><ul><li><strong>SBOM (Software Bill of Materials)</strong>: 서드파티 라이브러리의 보안 상태 추적 및 관리</li><li><strong>소프트웨어 공급망 공격 보호</strong>: SLSA(Supply-chain Levels for Software Artifacts) / Sigstore 활용</li><li><strong>RASP (Runtime Application Self-Protection)</strong>: 애플리케이션 내 보안 모니터링/차단</li><li><strong>Shift-left 및 DevSecOps</strong>: 보안 활동을 개발 초기로 이동시키기 위한 조직 문화 및 자동화 툴 체계</li></ul><hr><h2 id=9-주목할-내용>9. 주목할 내용<a hidden class=anchor aria-hidden=true href=#9-주목할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>조직 문화</td><td>DevSecOps</td><td>Shift-left</td><td>CI/CD 전 단계에서 보안 수행 자동화 및 문화 정착</td></tr><tr><td>보안 분석</td><td>SAST/DAST/IAST</td><td>도구 활용</td><td>코드·앱·런타임 수준에서 공격 포인트 사전 탐지</td></tr><tr><td>라이브러리 관리</td><td>SBOM</td><td>취약점 추적</td><td>설치된 컴포넌트 전수 목록 기반 취약점 모니터링</td></tr><tr><td>런타임 보호</td><td>RASP</td><td>실시간 방어</td><td>런타임 시 위협 감지/차단 및 로그 전송</td></tr></tbody></table><hr><h2 id=10-반드시-학습해야-할-내용-1>10. 반드시 학습해야 할 내용<a hidden class=anchor aria-hidden=true href=#10-반드시-학습해야-할-내용-1>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>인증/인가</td><td>OAuth2/OpenID Connect</td><td>토큰 기반 인증</td><td>현대 웹/API 서비스에서 널리 사용되는 안전한 인증 기법</td></tr><tr><td>키 관리</td><td>HSM / KMS</td><td>비밀 관리</td><td>안전한 암호 키 저장 및 순환 (KMS 연동)</td></tr><tr><td>코드 분석</td><td>SAST / DAST</td><td>정적·동적 분석</td><td>자동 도구를 사용한 취약점 사전 탐지</td></tr><tr><td>CI/CD</td><td>보안 자동화</td><td>파이프라인</td><td>린 (Lean) 방식으로 보안 적용, 릴리즈에서 즉시 배제</td></tr></tbody></table><hr><h2 id=11--구조-및-아키텍처-구성-요소-포함>11. 🧩 구조 및 아키텍처 (구성 요소 포함)<a hidden class=anchor aria-hidden=true href=#11--구조-및-아키텍처-구성-요소-포함>#</a></h2><h3 id=111-텍스트-다이어그램-mermaid>11.1 텍스트 다이어그램 (mermaid)<a hidden class=anchor aria-hidden=true href=#111-텍스트-다이어그램-mermaid>#</a></h3><p>/*</p><pre class=mermaid>graph LR
  A[코드 작성 단계] --&gt; B[정적분석 (SAST)]
  B --&gt; C[코드 리뷰 &amp; 보안가이드 검토]
  C --&gt; D[테스트 (유닛/통합 + 보안 테스트)]
  D --&gt; E[빌드/배포(CI/CD)]
  E --&gt; F[동적분석 (DAST/IAST)]
  F --&gt; G[런타임 보호 (RASP), 로깅/모니터링]
  G --&gt; H[피드백 → 코드 작성 단계]
</pre><p>*/</p><h3 id=112-구성-요소별-설명>11.2 구성 요소별 설명<a hidden class=anchor aria-hidden=true href=#112-구성-요소별-설명>#</a></h3><table><thead><tr><th>구성요소</th><th>카테고리</th><th>기능/역할</th><th>필수 여부</th></tr></thead><tbody><tr><td>SAST 도구</td><td>정적 분석</td><td>코드 취약점 탐지 (예: SQLi, XSS)</td><td>필수</td></tr><tr><td>코드 리뷰</td><td>검토 프로세스</td><td>경험 기반 및 시스템적 오류 방지</td><td>필수</td></tr><tr><td>보안 테스트</td><td>동적, IAST</td><td>런타임 테스트 수행, 취약점 실증</td><td>필수</td></tr><tr><td>CI/CD</td><td>자동화 배포</td><td>보안 검사 자동 수행, 빠른 피드백</td><td>필수</td></tr><tr><td>DAST/IAST</td><td>런타임 분석</td><td>시뮬레이션 공격 및 문제 탐지</td><td>선택</td></tr><tr><td>RASP</td><td>런타임 보호</td><td>실시간 위협 차단 및 알림</td><td>선택</td></tr><tr><td>로깅/모니터링</td><td>운영 보안</td><td>이상 징후 탐지 및 감사</td><td>필수</td></tr><tr><td>SBOM/KMS</td><td>공급망 및 키관리</td><td>외부 의존 컴포넌트 및 키 보안</td><td>필수</td></tr></tbody></table><hr><h2 id=12-구현-기법>12. 구현 기법<a hidden class=anchor aria-hidden=true href=#12-구현-기법>#</a></h2><table><thead><tr><th>기법</th><th>정의</th><th>목적</th><th>실제 예시</th></tr></thead><tbody><tr><td>PreparedStatement</td><td>SQL 파라미터화</td><td>SQLi 방지</td><td>Java <code>PreparedStatement</code></td></tr><tr><td>Output Encoding</td><td>출력 안전화</td><td>XSS 예방</td><td>HTML 엔티티 변환</td></tr><tr><td>CSP (Content Security Policy)</td><td>브라우저 보안표준</td><td>스크립트/리소스 제한</td><td>HTTP Header 설정</td></tr><tr><td>Secure Defaults</td><td>보안 기본 설정</td><td>안전한 시스템 상태</td><td>Spring Security 디폴트</td></tr><tr><td>Dependency Scanning</td><td>의존성 취약점 분석</td><td>취약 라이브러리 탐지</td><td>OWASP Dependency-Check</td></tr></tbody></table><hr><h2 id=13-장단점-및-해결-방안>13. 장단점 및 해결 방안<a hidden class=anchor aria-hidden=true href=#13-장단점-및-해결-방안>#</a></h2><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>장점</td><td>취약점 감소</td><td>자동 분석 + 정적 분석으로 초기 단계 취약점 방지</td></tr><tr><td></td><td>비용 절감</td><td>사전 발견으로 사고 대응 비용 억제</td></tr><tr><td></td><td>규제 준수</td><td>감사·컴플라이언스 수행 용이</td></tr><tr><td></td><td>신뢰성 향상</td><td>사용자 신뢰 및 시장 경쟁력 강화</td></tr></tbody></table><h3 id=단점문제점해결방안>단점·문제점·해결방안<a hidden class=anchor aria-hidden=true href=#단점문제점해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>단점</td><td>초기 비용</td><td>도구 및 프로세스 구축에 자원 소요</td><td>단계적 도입, 내부 오픈소스 활용</td></tr><tr><td></td><td>성능 영향</td><td>분석 도구 사용 시 빌드 지연</td><td>병렬 처리, 백그라운드 실행</td></tr><tr><td></td><td>기술 장벽</td><td>보안 가이드·도구 사용 미숙</td><td>교육 강화, 문서화, 코드 리뷰 문화</td></tr></tbody></table><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>원인</th><th>영향</th><th>탐지/진단</th><th>예방</th><th>해결</th></tr></thead><tbody><tr><td>문제점</td><td>False Positive</td><td>규칙 기반 부족</td><td>개발자 혼란</td><td>분석 결과 검토</td><td>예외 설정, 규칙 조정</td><td>규칙 튜닝</td></tr><tr><td></td><td>Misconfiguration</td><td>배포 설정 오류</td><td>보안 취약</td><td>검수/테스트 실패</td><td>보안 체크리스트</td><td>CI/CD 보안 게이트 적용</td></tr><tr><td></td><td>민감정보 노출</td><td>로깅 오류</td><td>개인정보 유출</td><td>로그 검토</td><td>마스킹/암호화</td><td>로거 설정 강화</td></tr></tbody></table><hr><h2 id=14-실무-사용-예시>14. 실무 사용 예시<a hidden class=anchor aria-hidden=true href=#14-실무-사용-예시>#</a></h2><table><thead><tr><th>사용 목적</th><th>도구/방법</th><th>기대 효과</th></tr></thead><tbody><tr><td>코드 취약점 탐지</td><td>SAST (SonarQube)</td><td>SQLi 등 자동 탐지</td></tr><tr><td>런타임 테스트</td><td>DAST (OWASP ZAP)</td><td>실제 공격 시나리오 검증</td></tr><tr><td>의존성 검증</td><td>SBOM + Dependency-Check</td><td>알려진 취약점 자동 알림</td></tr><tr><td>배포 자동화</td><td>CI/CD + 보안 게이트</td><td>릴리즈 전 보안 체크 자동화</td></tr></tbody></table><hr><h2 id=15-활용-사례>15. 활용 사례<a hidden class=anchor aria-hidden=true href=#15-활용-사례>#</a></h2><p><strong>기업 A 웹서비스</strong></p><ul><li><p>구성: Spring Boot 백엔드 + React 프론트 + CI/CD(Jenkins)</p></li><li><p>적용:</p><ol><li>코드 커밋 시 SonarQube SAST</li><li>병합 전 OWASP ZAP DAST 수행</li><li>의존성 스캔 + SBOM 생성</li><li>배포 시 RASP 탑재</li></ol></li><li><p>차이점: 보안 미적용 시 테스트 실패/운영 사고 증가 → 대응 시간·비용 증가</p></li></ul><h3 id=시스템-구성-다이어그램-텍스트>시스템 구성 다이어그램 (텍스트)<a hidden class=anchor aria-hidden=true href=#시스템-구성-다이어그램-텍스트>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2>2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3>3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4>4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Dev → Git → Jenkins
</span></span><span class=line><span class=cl>           ├─ SAST 분석
</span></span><span class=line><span class=cl>           ├─ DAST 테스트
</span></span><span class=line><span class=cl>           ├─ 의존성 검사 → SBOM 생성
</span></span><span class=line><span class=cl>           └─ 배포 → RASP 활성화 + 로깅→ ELK
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=16-구현-예시-javascript>16. 구현 예시 (JavaScript)<a hidden class=anchor aria-hidden=true href=#16-구현-예시-javascript>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2>2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3>3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4>4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5>5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6>6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7>7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8>8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// SQL Injection 방지
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>mysql</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;mysql2/promise&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>getUser</span><span class=p>(</span><span class=nx>email</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>conn</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>mysql</span><span class=p>.</span><span class=nx>createConnection</span><span class=p>({</span><span class=cm>/*config*/</span><span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>[</span><span class=nx>rows</span><span class=p>]</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>conn</span><span class=p>.</span><span class=nx>execute</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;SELECT id, name FROM users WHERE email = ?&#39;</span><span class=p>,</span> <span class=p>[</span><span class=nx>email</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>rows</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=17-도전-과제>17. 도전 과제<a hidden class=anchor aria-hidden=true href=#17-도전-과제>#</a></h2><table><thead><tr><th>카테고리</th><th>과제</th><th>원인</th><th>영향</th><th>탐지/진단</th><th>예방/해결</th></tr></thead><tbody><tr><td>공급망</td><td>라이브러리 취약점</td><td>퍼블릭 의존 증가</td><td>원격 코드 실행</td><td>SBOM 비교</td><td>SLSA, Sigstore</td></tr><tr><td>런타임</td><td>RASP 우회</td><td>복잡한 공격</td><td>무감지 공격</td><td>모의 해킹</td><td>RASP 튜닝</td></tr><tr><td>컬처</td><td>DevSecOps 정착</td><td>조직 저항</td><td>도입 지연</td><td>리소스 증가</td><td>교육 + 리더십 지원</td></tr></tbody></table><hr><h2 id=18-분류-기준에-따른-종류>18. 분류 기준에 따른 종류<a hidden class=anchor aria-hidden=true href=#18-분류-기준에-따른-종류>#</a></h2><table><thead><tr><th>기준</th><th>유형</th><th>설명</th></tr></thead><tbody><tr><td>분석 시점</td><td>SAST / DAST / IAST / RASP</td><td>코드/실행/실시간 분석 분류</td></tr><tr><td>적용 단계</td><td>Design / Dev / Test / Deploy / Operate</td><td>라이프사이클별 보안 활동</td></tr><tr><td>관리 대상</td><td>코드, 의존성, 설정, 런타임</td><td>보호 대상 요소별 분류</td></tr></tbody></table><hr><h2 id=19-실무-적용-고려사항-및-권장사항>19. 실무 적용 고려사항 및 권장사항<a hidden class=anchor aria-hidden=true href=#19-실무-적용-고려사항-및-권장사항>#</a></h2><table><thead><tr><th>항목</th><th>주의 사항</th><th>권장사항</th></tr></thead><tbody><tr><td>도구 도입</td><td>전담 인력 부재</td><td>초기 PoC + 교육</td></tr><tr><td>파이프라인</td><td>분석 병목</td><td>비동기 분석 + 피드백 설정</td></tr><tr><td>의존성 관리</td><td>직접 스캔 안됨</td><td>SBOM + 정기 스캔</td></tr><tr><td>오류처리</td><td>상세 메시지 노출</td><td>사용자에게 일반 메시지, 내부에는 로그 남김</td></tr></tbody></table><hr><h2 id=20-최적화-위한-고려사항-및-권장사항>20. 최적화 위한 고려사항 및 권장사항<a hidden class=anchor aria-hidden=true href=#20-최적화-위한-고려사항-및-권장사항>#</a></h2><table><thead><tr><th>항목</th><th>주의 사항</th><th>권장사항</th></tr></thead><tbody><tr><td>분석 속도</td><td>빌드 시간 지연</td><td>증분 분석, 캐싱 활용</td></tr><tr><td>분석 정확도</td><td>과도한 오탐</td><td>규칙 튜닝, 예외 관리</td></tr><tr><td>성능 영향</td><td>런타임 오버헤드</td><td>RASP 비동기로 수집하고 배치 전처리</td></tr></tbody></table><hr><hr><h2 id=-용어-정리>📝 용어 정리<a hidden class=anchor aria-hidden=true href=#-용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>인증/인가</td><td>OAuth2</td><td>안전한 권한 위임 프레임워크</td></tr><tr><td>고급 분석</td><td>SAST</td><td>정적 코드 분석 기법</td></tr><tr><td>고급 분석</td><td>DAST</td><td>실행 중인 앱의 동적 보안 테스트</td></tr><tr><td>공급망</td><td>SBOM</td><td>패키지 구성 물질 목록</td></tr><tr><td>런타임 보안</td><td>RASP</td><td>실행 중 애플리케이션 자가 방어 체계</td></tr><tr><td>CI/CD</td><td>DevSecOps</td><td>개발과 보안의 통합 문화</td></tr></tbody></table><hr><h2 id=-참고-및-출처>📚 참고 및 출처<a hidden class=anchor aria-hidden=true href=#-참고-및-출처>#</a></h2><ul><li>OWASP, SonarQube 공식 문서</li><li><a href=https://owasp.org/www-project-top-ten/>https://owasp.org/www-project-top-ten/</a></li><li><a href=https://slsa.dev/>https://slsa.dev/</a></li><li>Spring Security 공식 가이드</li></ul><hr><p>다음은 <strong>JavaScript 예시</strong>에 이어 <strong>Python 기반의 구현 예시</strong>, 그리고 <strong>코드 리뷰 체크리스트</strong>를 포함한 추가 내용입니다.</p><hr><h2 id=21--구현-예시-python>21. 🐍 구현 예시 (Python)<a hidden class=anchor aria-hidden=true href=#21--구현-예시-python>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1> 1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2> 2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3> 3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4> 4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5> 5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6> 6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7> 7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8> 8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9> 9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10>10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11>11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12>12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13>13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14>14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15>15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16>16</a>
</span><span class=lnt id=hl-8-17><a class=lnlinks href=#hl-8-17>17</a>
</span><span class=lnt id=hl-8-18><a class=lnlinks href=#hl-8-18>18</a>
</span><span class=lnt id=hl-8-19><a class=lnlinks href=#hl-8-19>19</a>
</span><span class=lnt id=hl-8-20><a class=lnlinks href=#hl-8-20>20</a>
</span><span class=lnt id=hl-8-21><a class=lnlinks href=#hl-8-21>21</a>
</span><span class=lnt id=hl-8-22><a class=lnlinks href=#hl-8-22>22</a>
</span><span class=lnt id=hl-8-23><a class=lnlinks href=#hl-8-23>23</a>
</span><span class=lnt id=hl-8-24><a class=lnlinks href=#hl-8-24>24</a>
</span><span class=lnt id=hl-8-25><a class=lnlinks href=#hl-8-25>25</a>
</span><span class=lnt id=hl-8-26><a class=lnlinks href=#hl-8-26>26</a>
</span><span class=lnt id=hl-8-27><a class=lnlinks href=#hl-8-27>27</a>
</span><span class=lnt id=hl-8-28><a class=lnlinks href=#hl-8-28>28</a>
</span><span class=lnt id=hl-8-29><a class=lnlinks href=#hl-8-29>29</a>
</span><span class=lnt id=hl-8-30><a class=lnlinks href=#hl-8-30>30</a>
</span><span class=lnt id=hl-8-31><a class=lnlinks href=#hl-8-31>31</a>
</span><span class=lnt id=hl-8-32><a class=lnlinks href=#hl-8-32>32</a>
</span><span class=lnt id=hl-8-33><a class=lnlinks href=#hl-8-33>33</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>psycopg2</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>psycopg2</span> <span class=kn>import</span> <span class=n>sql</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_db_connection</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>psycopg2</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>dbname</span><span class=o>=</span><span class=s1>&#39;appdb&#39;</span><span class=p>,</span> <span class=n>user</span><span class=o>=</span><span class=s1>&#39;appuser&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span><span class=o>=</span><span class=s1>&#39;securepass&#39;</span><span class=p>,</span> <span class=n>host</span><span class=o>=</span><span class=s1>&#39;db.local&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/user&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_user</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>email</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;email&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 입력 검증: 화이트리스트 기반 이메일 패턴 확인</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^[\w\.-]+@[\w\.-]+\.\w+$&#39;</span><span class=p>,</span> <span class=n>email</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Invalid email&#39;</span><span class=p>}),</span> <span class=mi>400</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>conn</span> <span class=o>=</span> <span class=n>get_db_connection</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>cur</span> <span class=o>=</span> <span class=n>conn</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># PreparedStatement 형태로 파라미터 바인딩</span>
</span></span><span class=line><span class=cl>    <span class=n>query</span> <span class=o>=</span> <span class=n>sql</span><span class=o>.</span><span class=n>SQL</span><span class=p>(</span><span class=s2>&#34;SELECT id, name FROM users WHERE email = </span><span class=si>%s</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>cur</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=p>(</span><span class=n>email</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>    <span class=n>row</span> <span class=o>=</span> <span class=n>cur</span><span class=o>.</span><span class=n>fetchone</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>cur</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>conn</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>row</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;User not found&#39;</span><span class=p>}),</span> <span class=mi>404</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 안전한 응답: 민감 정보 비노출</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=n>row</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=n>row</span><span class=p>[</span><span class=mi>1</span><span class=p>]}),</span> <span class=mi>200</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>핵심 포인트 요약</strong></p><ul><li>화이트리스트 기반 입력 검증</li><li>psycopg2 라이브러리의 파라미터 바인딩 사용 (<code>%s</code>) 으로 SQL 주입 방지</li><li>에러 메시지에서 내부 구조 및 정보 노출 방지</li></ul><hr><h2 id=22--코드-리뷰-체크리스트>22. ✅ 코드 리뷰 체크리스트<a hidden class=anchor aria-hidden=true href=#22--코드-리뷰-체크리스트>#</a></h2><table><thead><tr><th>카테고리</th><th>점검 항목</th><th>설명</th></tr></thead><tbody><tr><td>입력 검증</td><td>화이트리스트 기반인가?</td><td>정규식 또는 타입 제약 사용 여부</td></tr><tr><td>출력 인코딩</td><td>HTML/JS 응답 시 필요 적용됐는가?</td><td>예: 인코딩 라이브러리 적용 여부</td></tr><tr><td>에러 처리</td><td>민감 데이터 노출 여부 확인</td><td>실제 시스템 정보 노출 여부 점검</td></tr><tr><td>자원 관리</td><td>커넥션, 파일 등 종료 여부</td><td><code>finally</code> 또는 context manager 사용 여부</td></tr><tr><td>의존성</td><td>취약 패키지 사용 여부</td><td><code>requirements.txt</code> 버전 고정 및 스캔 유무</td></tr><tr><td>인증/인가</td><td>권한 확인 로직 정확성</td><td>API 접근 제어 구현 여부</td></tr><tr><td>로깅</td><td>로깅 수준 및 포맷 점검</td><td>예외 로그, 보안 로그 포함 여부</td></tr><tr><td>설정</td><td>보안 설정 제어 여부</td><td>Debug 모드, 인증 설정, HTTPS 등</td></tr></tbody></table><hr><h2 id=23--구체-구현-예시-csp-설정-flask--helmet>23. 🔎 구체 구현 예시: CSP 설정 (Flask + Helmet)<a hidden class=anchor aria-hidden=true href=#23--구체-구현-예시-csp-설정-flask--helmet>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11>11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12>12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13>13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14>14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15>15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>Response</span>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.after_request</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>apply_csp</span><span class=p>(</span><span class=n>response</span><span class=p>:</span> <span class=n>Response</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># CSP 헤더 설정: 스크립트는 self만 허용, 스타일은 self + CDN 허용</span>
</span></span><span class=line><span class=cl>    <span class=n>csp</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;default-src &#39;self&#39;; &#34;</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;script-src &#39;self&#39;; &#34;</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;style-src &#39;self&#39; https://cdn.example.com; &#34;</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;img-src &#39;self&#39; data:; &#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>response</span><span class=o>.</span><span class=n>headers</span><span class=p>[</span><span class=s1>&#39;Content-Security-Policy&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>csp</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>response</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 이후 앱 라우팅 및 실행...</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>주요 효과</strong>:</p><ul><li>XSS 와 인라인 스크립트 공격 방지</li><li>외부 리소스 제약으로 콘텐츠 무결성 강화</li></ul><hr><h2 id=24--보안-자동화-파이프라인-샘플>24. 📈 보안 자동화 파이프라인 샘플<a hidden class=anchor aria-hidden=true href=#24--보안-자동화-파이프라인-샘플>#</a></h2><p><strong>Jenkinsfile (Declarative Pipeline)</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span><span class=lnt id=hl-10-16><a class=lnlinks href=#hl-10-16>16</a>
</span><span class=lnt id=hl-10-17><a class=lnlinks href=#hl-10-17>17</a>
</span><span class=lnt id=hl-10-18><a class=lnlinks href=#hl-10-18>18</a>
</span><span class=lnt id=hl-10-19><a class=lnlinks href=#hl-10-19>19</a>
</span><span class=lnt id=hl-10-20><a class=lnlinks href=#hl-10-20>20</a>
</span><span class=lnt id=hl-10-21><a class=lnlinks href=#hl-10-21>21</a>
</span><span class=lnt id=hl-10-22><a class=lnlinks href=#hl-10-22>22</a>
</span><span class=lnt id=hl-10-23><a class=lnlinks href=#hl-10-23>23</a>
</span><span class=lnt id=hl-10-24><a class=lnlinks href=#hl-10-24>24</a>
</span><span class=lnt id=hl-10-25><a class=lnlinks href=#hl-10-25>25</a>
</span><span class=lnt id=hl-10-26><a class=lnlinks href=#hl-10-26>26</a>
</span><span class=lnt id=hl-10-27><a class=lnlinks href=#hl-10-27>27</a>
</span><span class=lnt id=hl-10-28><a class=lnlinks href=#hl-10-28>28</a>
</span><span class=lnt id=hl-10-29><a class=lnlinks href=#hl-10-29>29</a>
</span><span class=lnt id=hl-10-30><a class=lnlinks href=#hl-10-30>30</a>
</span><span class=lnt id=hl-10-31><a class=lnlinks href=#hl-10-31>31</a>
</span><span class=lnt id=hl-10-32><a class=lnlinks href=#hl-10-32>32</a>
</span><span class=lnt id=hl-10-33><a class=lnlinks href=#hl-10-33>33</a>
</span><span class=lnt id=hl-10-34><a class=lnlinks href=#hl-10-34>34</a>
</span><span class=lnt id=hl-10-35><a class=lnlinks href=#hl-10-35>35</a>
</span><span class=lnt id=hl-10-36><a class=lnlinks href=#hl-10-36>36</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>pipeline</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=n>agent</span> <span class=n>any</span>
</span></span><span class=line><span class=cl>  <span class=n>stages</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Checkout&#39;</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>steps</span> <span class=o>{</span> <span class=n>checkout</span> <span class=n>scm</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;SAST Analysis&#39;</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>steps</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>sh</span> <span class=s1>&#39;./gradlew sonarqube&#39;</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Dependency Scan&#39;</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>steps</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>sh</span> <span class=s1>&#39;dependency-check --project MyApp -f XML -o dependency-report.xml&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>publishHTML</span> <span class=nl>target:</span> <span class=o>[</span><span class=nl>reportDir:</span> <span class=s1>&#39;.&#39;</span><span class=o>,</span> <span class=nl>reportFiles:</span> <span class=s1>&#39;dependency-report.xml&#39;</span><span class=o>,</span> <span class=nl>reportName:</span> <span class=s1>&#39;Dependency Report&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;DAST&#39;</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>steps</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>sh</span> <span class=s1>&#39;zap-baseline.py -t http://localhost:8080 -r zap_report.html&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>publishHTML</span> <span class=nl>target:</span> <span class=o>[</span><span class=nl>reportDir:</span> <span class=s1>&#39;.&#39;</span><span class=o>,</span> <span class=nl>reportFiles:</span> <span class=s1>&#39;zap_report.html&#39;</span><span class=o>,</span> <span class=nl>reportName:</span> <span class=s1>&#39;DAST Report&#39;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Build &amp; Deploy&#39;</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>steps</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>sh</span> <span class=s1>&#39;./gradlew build&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>sh</span> <span class=s1>&#39;./deploy.sh&#39;</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=n>post</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>always</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>archiveArtifacts</span> <span class=nl>artifacts:</span> <span class=s1>&#39;*.xml, *.html&#39;</span><span class=o>,</span> <span class=nl>allowEmptyArchive:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=25--정리-및-권장사항>25. 🧾 정리 및 권장사항<a hidden class=anchor aria-hidden=true href=#25--정리-및-권장사항>#</a></h2><ul><li><p><strong>교육과 멘토링</strong>:<br>신규 개발자 대상 정기 워크숍 및 코드 리뷰 세션 필수.</p></li><li><p><strong>자동화</strong>:<br>DevSecOps 기반 CI/CD 내 SAST/DAST/SBOM 통합 → 보안 편의성 및 신뢰성 확보.</p></li><li><p><strong>문서화</strong>:<br>코드 리뷰 체크리스트, 보안 정책, 암호화 키 정책 등 문서화 유도.</p></li><li><p><strong>최적화</strong>:</p><ul><li>배치 분석으로 빌드 시간 최소화</li><li>규칙 튜닝 및 오탐 방지</li><li>RASP 는 로그만 비동기 → 수집 후 차단 전략 선택</li></ul></li></ul><hr><p>이해를 돕기 위해 추가로 <strong>Python 심화 예제</strong>, <strong>보안 성능 최적화 방안</strong>, <strong>케이스별 가이드</strong> 등이 필요하시면 말씀주세요!</p><p>다음은 <strong>추가 요청하신 Python 심화 예제</strong>, <strong>성능 최적화 방안</strong>, <strong>케이스별 가이드</strong>까지 보안 코딩의 실무 적용 측면을 심화한 내용입니다.</p><hr><h2 id=26--python-심화-예제-파일-업로드-보안-처리>26. 🐍 Python 심화 예제: 파일 업로드 보안 처리<a hidden class=anchor aria-hidden=true href=#26--python-심화-예제-파일-업로드-보안-처리>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15>15</a>
</span><span class=lnt id=hl-11-16><a class=lnlinks href=#hl-11-16>16</a>
</span><span class=lnt id=hl-11-17><a class=lnlinks href=#hl-11-17>17</a>
</span><span class=lnt id=hl-11-18><a class=lnlinks href=#hl-11-18>18</a>
</span><span class=lnt id=hl-11-19><a class=lnlinks href=#hl-11-19>19</a>
</span><span class=lnt id=hl-11-20><a class=lnlinks href=#hl-11-20>20</a>
</span><span class=lnt id=hl-11-21><a class=lnlinks href=#hl-11-21>21</a>
</span><span class=lnt id=hl-11-22><a class=lnlinks href=#hl-11-22>22</a>
</span><span class=lnt id=hl-11-23><a class=lnlinks href=#hl-11-23>23</a>
</span><span class=lnt id=hl-11-24><a class=lnlinks href=#hl-11-24>24</a>
</span><span class=lnt id=hl-11-25><a class=lnlinks href=#hl-11-25>25</a>
</span><span class=lnt id=hl-11-26><a class=lnlinks href=#hl-11-26>26</a>
</span><span class=lnt id=hl-11-27><a class=lnlinks href=#hl-11-27>27</a>
</span><span class=lnt id=hl-11-28><a class=lnlinks href=#hl-11-28>28</a>
</span><span class=lnt id=hl-11-29><a class=lnlinks href=#hl-11-29>29</a>
</span><span class=lnt id=hl-11-30><a class=lnlinks href=#hl-11-30>30</a>
</span><span class=lnt id=hl-11-31><a class=lnlinks href=#hl-11-31>31</a>
</span><span class=lnt id=hl-11-32><a class=lnlinks href=#hl-11-32>32</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>abort</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>werkzeug.utils</span> <span class=kn>import</span> <span class=n>secure_filename</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;UPLOAD_FOLDER&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s1>&#39;/secure/uploads&#39;</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;MAX_CONTENT_LENGTH&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=mi>5</span> <span class=o>*</span> <span class=mi>1024</span> <span class=o>*</span> <span class=mi>1024</span>  <span class=c1># 5 MB 제한</span>
</span></span><span class=line><span class=cl><span class=n>ALLOWED_EXTENSIONS</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;png&#39;</span><span class=p>,</span> <span class=s1>&#39;jpg&#39;</span><span class=p>,</span> <span class=s1>&#39;jpeg&#39;</span><span class=p>,</span> <span class=s1>&#39;gif&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>allowed_file</span><span class=p>(</span><span class=n>filename</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;.&#39;</span> <span class=ow>in</span> <span class=n>filename</span> <span class=ow>and</span> \
</span></span><span class=line><span class=cl>           <span class=n>filename</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>in</span> <span class=n>ALLOWED_EXTENSIONS</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/upload&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>upload_file</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;file&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>request</span><span class=o>.</span><span class=n>files</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>abort</span><span class=p>(</span><span class=mi>400</span><span class=p>,</span> <span class=s1>&#39;No file part&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>file</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>files</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>file</span><span class=o>.</span><span class=n>filename</span> <span class=o>==</span> <span class=s1>&#39;&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>abort</span><span class=p>(</span><span class=mi>400</span><span class=p>,</span> <span class=s1>&#39;No selected file&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>file</span> <span class=ow>and</span> <span class=n>allowed_file</span><span class=p>(</span><span class=n>file</span><span class=o>.</span><span class=n>filename</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>filename</span> <span class=o>=</span> <span class=n>secure_filename</span><span class=p>(</span><span class=n>file</span><span class=o>.</span><span class=n>filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>filepath</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;UPLOAD_FOLDER&#39;</span><span class=p>],</span> <span class=n>filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 디렉터리 검증 및 권한 설정</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;UPLOAD_FOLDER&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>            <span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>app</span><span class=o>.</span><span class=n>config</span><span class=p>[</span><span class=s1>&#39;UPLOAD_FOLDER&#39;</span><span class=p>],</span> <span class=n>exist_ok</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># 저장</span>
</span></span><span class=line><span class=cl>        <span class=n>file</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>filepath</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;success&#39;</span><span class=p>,</span> <span class=s1>&#39;filename&#39;</span><span class=p>:</span> <span class=n>filename</span><span class=p>},</span> <span class=mi>201</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>abort</span><span class=p>(</span><span class=mi>400</span><span class=p>,</span> <span class=s1>&#39;Invalid file type&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>보안 포인트 정리</strong></p><ul><li>확장자 기반 화이트리스트 필터링</li><li><code>secure_filename()</code> 을 통한 경로 조작 예방</li><li>업로드 크기 제한, 디렉터리 존재 확인 및 생성, 권한 설정</li></ul><hr><h2 id=27--성능-최적화-고려사항>27. ⚙️ 성능 최적화 고려사항<a hidden class=anchor aria-hidden=true href=#27--성능-최적화-고려사항>#</a></h2><table><thead><tr><th>항목</th><th>고려사항</th><th>권장 방안</th></tr></thead><tbody><tr><td>빌드 지연</td><td>정적 분석 도구가 전체 코드 검사</td><td>증분 분석 + 백그라운드 실행</td></tr><tr><td>오탐율</td><td>분석 지연 및 개발 피로 초래</td><td>규칙 조정 + 스킵 태그 활용</td></tr><tr><td>런타임 오버헤드</td><td>RASP 나 로깅 과부하 가능성</td><td>비동기 로깅 + 샘플링 정책 적용</td></tr><tr><td>의존성 이미지</td><td>SBOM 생성과 스캔 연산</td><td>CI 중 병렬 처리 + 캐싱 활용</td></tr></tbody></table><hr><h2 id=28--케이스별-보안-코딩-가이드>28. ✅ 케이스별 보안 코딩 가이드<a hidden class=anchor aria-hidden=true href=#28--케이스별-보안-코딩-가이드>#</a></h2><table><thead><tr><th>시나리오</th><th>위협</th><th>주요 대응</th><th>코드 적용 포인트</th><th></th></tr></thead><tbody><tr><td>로그인 API</td><td>브루트포스, SQLi, 세션 하이재킹</td><td>Rate Limiting, PreparedStatement, HttpOnly 쿠키</td><td>Flask-Limiter, SQL 파라미터바인딩, Secure 쿠키</td><td></td></tr><tr><td>파일 업로드</td><td>경로 조작, 악성 파일</td><td>화이트리스트, secure_filename, MIME/시그니처 체크</td><td>위 예시 코드 + 파일 검증 추가</td><td></td></tr><tr><td>OAuth 토큰</td><td>토큰 탈취, 무효 토큰</td><td>HTTPS, JWT 서명 검증, 리프레시 토큰 관리</td><td>flask-jwt-extended 사용, 토큰 적재기</td><td></td></tr><tr><td>크로스 사이트</td><td>XSS, CSRF</td><td>CSP 설정, 출력 인코딩, CSRF 토큰 적용</td><td>`{{ user_input</td><td>e }}`, Flask-WTF CSRF</td></tr></tbody></table><hr><h2 id=29--핵심-보안-체크리스트-정리>29. 📊 핵심 보안 체크리스트 정리<a hidden class=anchor aria-hidden=true href=#29--핵심-보안-체크리스트-정리>#</a></h2><h3 id=개발-초기>개발 초기<a hidden class=anchor aria-hidden=true href=#개발-초기>#</a></h3><ul><li>입력값 검증 및 화이트리스트 설계</li><li>보안 라이브러리/프레임워크 적용</li></ul><h3 id=빌드-및-cicd>빌드 및 CI/CD<a hidden class=anchor aria-hidden=true href=#빌드-및-cicd>#</a></h3><ul><li>증분 SAST 스캔 + 규칙 튜닝</li><li>SBOM 생성 및 의존성 자동 스캔</li><li>DAST 자동화 테스트 포함</li></ul><h3 id=배포-및-운영>배포 및 운영<a hidden class=anchor aria-hidden=true href=#배포-및-운영>#</a></h3><ul><li>RASP 또는 WAF 구성</li><li>CSP 및 보안 헤더 설정</li><li>민감 정보 마스킹 로깅</li><li>보안 이벤트 모니터링 및 대응 플랜 구성</li></ul><hr><h2 id=30--요약-정리-전체-단계>30. 🎯 요약 정리 (전체 단계)<a hidden class=anchor aria-hidden=true href=#30--요약-정리-전체-단계>#</a></h2><ol><li><strong>설계</strong>: 위협 모델링 + 최소 권한 설계 + 입력/출력 경계 정의</li><li><strong>개발</strong>: 입력 검증·인증/인가·에러처리·암호화 준수</li><li><strong>검증</strong>: 자동 + 수동 분석 (SAST/DAST/code review)</li><li><strong>배포</strong>: CI/CD 를 활용한 보안 자동화 + RASP/WAF 적용</li><li><strong>운영</strong>: 로깅·모니터링·침해 대응 체계 구축</li></ol><hr><p>이상으로 <strong>보안 코딩</strong>에 대한 Python 심화 예제, 성능 최적화, 케이스별 구체 가이드까지 모든 핵심 요소를 정리했습니다. 추가적으로 <strong>테스트 코드 예제, 위협 모델링 문서 템플릿, 사례 중심 워크플로우</strong> 등 필요한 부분이 있으시면 언제든 요청 주세요!</p><p>네, IT 백엔드 개발자로서 " 보안 코딩 (Secure Coding)&rdquo; 에 대해 체계적으로 조사하고 분석해드리겠습니다. 먼저 최신 정보를 수집하기 위해 웹 검색을 진행하겠습니다.</p><h2 id=보안-코딩-secure-coding-조사-및-분석-보고서>보안 코딩 (Secure Coding) 조사 및 분석 보고서<a hidden class=anchor aria-hidden=true href=#보안-코딩-secure-coding-조사-및-분석-보고서>#</a></h2><h3 id=1-태그-생성>1. 태그 생성<a hidden class=anchor aria-hidden=true href=#1-태그-생성>#</a></h3><ul><li><strong>Secure-Coding</strong></li><li><strong>Application-Security</strong></li><li><strong>SAST-DAST-Tools</strong></li><li><strong>OWASP-Standards</strong></li></ul><h3 id=2-주제-분류-검토>2. 주제 분류 검토<a hidden class=anchor aria-hidden=true href=#2-주제-분류-검토>#</a></h3><p><strong>요청된 분류</strong>: &ldquo;Computer Science and Engineering > Software Engineering > Software Engineering Foundations&rdquo;</p><p><strong>분석 결과</strong>: 해당 분류는 적절하지만, 보다 정확한 분류는 다음과 같습니다.</p><p><strong>권장 분류</strong>: &ldquo;Computer Science and Engineering > Software Engineering > <strong>Software Security and Quality Assurance</strong>&rdquo;</p><p><strong>근거</strong>: 보안 코딩은 소프트웨어 엔지니어링의 기초보다는 소프트웨어의 보안과 품질 보증에 특화된 전문 영역에 해당합니다. 이는 보안 취약점 예방, 위험 관리, 그리고 품질 보증 프로세스와 직접적으로 연관되어 있습니다.</p><h3 id=3-주제-요약-200-자-내외-1>3. 주제 요약 (200 자 내외)<a hidden class=anchor aria-hidden=true href=#3-주제-요약-200-자-내외-1>#</a></h3><p>보안 코딩 (Secure Coding) 은 소프트웨어 개발 과정에서 보안 취약점을 사전에 예방하고, 악성 공격으로부터 애플리케이션을 보호하는 개발 방법론입니다. OWASP Top 10 과 같은 표준을 기반으로 입력 검증, 인증/인가, 암호화 등의 보안 원칙을 코드 작성 단계부터 적용하여 안전하고 신뢰할 수 있는 소프트웨어를 구축하는 것이 핵심입니다.</p><h3 id=4-전체-개요-250-자-내외-1>4. 전체 개요 (250 자 내외)<a hidden class=anchor aria-hidden=true href=#4-전체-개요-250-자-내외-1>#</a></h3><p>본 보고서는 2025 년 현재 보안 코딩의 핵심 개념, 구현 방법론, 도구 및 기술들을 종합적으로 분석합니다. SSDLC (Secure Software Development Life Cycle) 프레임워크를 중심으로 SAST/DAST 도구, OWASP 표준, DevSecOps 통합 등 현대적 보안 개발 환경의 모든 측면을 다룹니다. AI 기반 자동화 도구와 클라우드 네이티브 환경에서의 보안 고려사항까지 포함하여 실무진이 효과적으로 적용할 수 있는 포괄적인 가이드를 제공합니다.</p><hr><h3 id=5-핵심-개념-1>5. 핵심 개념<a hidden class=anchor aria-hidden=true href=#5-핵심-개념-1>#</a></h3><p>보안 코딩의 핵심 개념은 다음과 같은 이론적 기반과 실무적 접근법으로 구성됩니다:</p><h4 id=51-기본-보안-원칙>5.1 기본 보안 원칙<a hidden class=anchor aria-hidden=true href=#51-기본-보안-원칙>#</a></h4><p><strong>기밀성 (Confidentiality)</strong>: 권한이 없는 사용자의 정보 접근 차단<br><strong>무결성 (Integrity)</strong>: 데이터의 정확성과 일관성 보장<br><strong>가용성 (Availability)</strong>: 정당한 사용자의 서비스 접근 보장<br><strong>인증 (Authentication)</strong>: 사용자 신원 확인<br><strong>인가 (Authorization)</strong>: 권한 기반 접근 제어<br><strong>부인방지 (Non-repudiation)</strong>: 행위에 대한 책임 추적</p><h4 id=52-보안-개발-생명주기-ssdlc>5.2 보안 개발 생명주기 (SSDLC)<a hidden class=anchor aria-hidden=true href=#52-보안-개발-생명주기-ssdlc>#</a></h4><pre class=mermaid>graph TD
    A[요구사항 분석&lt;br/&gt;Requirements Analysis] --&gt; B[위협 모델링&lt;br/&gt;Threat Modeling]
    B --&gt; C[보안 설계&lt;br/&gt;Secure Design]
    C --&gt; D[보안 코딩&lt;br/&gt;Secure Coding]
    D --&gt; E[보안 테스팅&lt;br/&gt;Security Testing]
    E --&gt; F[배포 및 운영&lt;br/&gt;Deployment &amp; Operations]
    F --&gt; G[모니터링&lt;br/&gt;Monitoring]
    G --&gt; A
    
    D --&gt; D1[SAST 검사&lt;br/&gt;Static Analysis]
    D --&gt; D2[코드 리뷰&lt;br/&gt;Code Review]
    D --&gt; D3[의존성 검사&lt;br/&gt;Dependency Check]
    
    E --&gt; E1[DAST 검사&lt;br/&gt;Dynamic Analysis]
    E --&gt; E2[침투 테스트&lt;br/&gt;Penetration Testing]
    E --&gt; E3[취약점 평가&lt;br/&gt;Vulnerability Assessment]
    
    style A fill:#e1f5fe
    style D fill:#fff3e0
    style E fill:#f3e5f5
</pre><h4 id=53-실무-구현을-위한-연관성-분석>5.3 실무 구현을 위한 연관성 분석<a hidden class=anchor aria-hidden=true href=#53-실무-구현을-위한-연관성-분석>#</a></h4><p><strong>개발 단계별 보안 통합</strong>:</p><ul><li><strong>설계 단계</strong>: 보안 아키텍처 패턴, 위협 모델링 기법 적용</li><li><strong>구현 단계</strong>: 안전한 코딩 표준, 라이브러리 사용 가이드 준수</li><li><strong>테스트 단계</strong>: 자동화된 보안 검사 도구 (SAST/DAST) 통합</li><li><strong>배포 단계</strong>: 보안 구성 관리, 컨테이너 보안 적용</li><li><strong>운영 단계</strong>: 실시간 모니터링, 로그 분석, 인시던트 대응</li></ul><hr><h3 id=6-주요-조사-내용>6. 주요 조사 내용<a hidden class=anchor aria-hidden=true href=#6-주요-조사-내용>#</a></h3><h4 id=61-배경-1>6.1 배경<a hidden class=anchor aria-hidden=true href=#61-배경-1>#</a></h4><p>보안 코딩의 필요성은 사이버 공격의 급증과 소프트웨어 의존도 증가에서 비롯됩니다. 2025 년 현재 글로벌 사이버보안 지출이 1.75 조 달러에 달할 것으로 예상되며, 소프트웨어 취약점으로 인한 데이터 유출 사건이 연간 수천 건 발생하고 있습니다. 특히 클라우드 네이티브 환경과 AI/ML 시스템의 확산으로 새로운 보안 위협이 등장하고 있어, 개발 초기 단계부터의 보안 고려가 필수가 되었습니다.</p><h4 id=62-목적-및-필요성-1>6.2 목적 및 필요성<a hidden class=anchor aria-hidden=true href=#62-목적-및-필요성-1>#</a></h4><p><strong>목적</strong>:</p><ul><li>소프트웨어 취약점으로 인한 보안 사고 예방</li><li>개발 비용 절감 (배포 후 수정 비용이 개발 단계 대비 15 배 증가)</li><li>법적 규제 준수 (GDPR, PCI DSS, SOX 등)</li><li>사용자 신뢰도 및 기업 명성 보호</li></ul><p><strong>필요성</strong>:</p><ul><li><strong>비용 효율성</strong>: 개발 단계에서의 보안 결함 수정은 배포 후 대비 100 배 저렴</li><li><strong>규제 준수</strong>: 점점 강화되는 데이터 보호 규정 대응</li><li><strong>디지털 전환</strong>: 클라우드, IoT, AI 환경에서의 새로운 위협 대응</li></ul><h4 id=63-주요-기능-및-역할-1>6.3 주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#63-주요-기능-및-역할-1>#</a></h4><p><strong>핵심 기능</strong>:</p><ol><li><strong>취약점 예방</strong>: 일반적인 보안 결함 사전 차단</li><li><strong>위험 관리</strong>: 비즈니스 영향도 기반 우선순위 설정</li><li><strong>품질 향상</strong>: 코드의 전반적인 품질과 유지보수성 개선</li><li><strong>규정 준수</strong>: 산업별 보안 표준 충족</li></ol><p><strong>주요 역할</strong>:</p><ul><li><strong>개발자</strong>: 보안 코딩 가이드라인 준수, 취약점 수정</li><li><strong>보안팀</strong>: 정책 수립, 도구 선정, 교육 제공</li><li><strong>품질보증</strong>: 보안 테스트 수행, 결함 검증</li><li><strong>운영팀</strong>: 모니터링, 인시던트 대응</li></ul><h4 id=64-특징-1>6.4 특징<a hidden class=anchor aria-hidden=true href=#64-특징-1>#</a></h4><p><strong>주요 특징</strong>:</p><ul><li><strong>Shift-Left 접근법</strong>: 개발 초기 단계부터 보안 적용</li><li><strong>자동화 중심</strong>: CI/CD 파이프라인 통합으로 효율성 향상</li><li><strong>다층 방어</strong>: 여러 보안 기법의 조합 사용</li><li><strong>지속적 개선</strong>: 피드백 루프를 통한 보안 수준 향상</li></ul><h4 id=65-핵심-원칙>6.5 핵심 원칙<a hidden class=anchor aria-hidden=true href=#65-핵심-원칙>#</a></h4><p><strong>보안 코딩의 10 대 원칙</strong>:</p><pre class=mermaid>mindmap
  root((보안 코딩&lt;br/&gt;핵심 원칙))
    방어적 프로그래밍
      입력 검증
      오류 처리
      예외 상황 대비
    최소 권한 원칙
      필요 최소한 권한
      역할 기반 접근제어
      권한 분리
    심층 방어
      다층 보안 통제
      중복 보안 메커니즘
      실패 시 안전
    보안 기본값
      Secure by Default
      기본 설정 보안화
      옵트아웃 방식
    완전한 중재
      모든 접근 검증
      우회 경로 차단
      포괄적 인가
    개방적 설계
      보안 투명성
      표준 암호화
      검증 가능성
    최소 공통 메커니즘
      공유 자원 최소화
      격리된 실행환경
      독립적 보안 도메인
    심리적 수용성
      사용자 친화적
      간단한 보안 절차
      투명한 보안 정책
</pre><h4 id=66-구조-및-아키텍처>6.6 구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#66-구조-및-아키텍처>#</a></h4><p>보안 코딩 아키텍처는 다음과 같은 필수 및 선택 구성요소로 이루어집니다:</p><pre class=mermaid>graph TB
    subgraph &#34;개발 환경 (Development Environment)&#34;
        IDE[통합개발환경&lt;br/&gt;IDE Security Plugins]
        CR[코드 리뷰 도구&lt;br/&gt;Code Review Tools]
        VCS[버전 관리&lt;br/&gt;Version Control]
    end
    
    subgraph &#34;CI/CD 파이프라인 (CI/CD Pipeline)&#34;
        SAST[정적 분석&lt;br/&gt;SAST Tools]
        SCA[의존성 검사&lt;br/&gt;SCA Tools]
        SECRETS[시크릿 검사&lt;br/&gt;Secret Scanning]
        BUILD[빌드 검증&lt;br/&gt;Build Verification]
    end
    
    subgraph &#34;테스트 환경 (Testing Environment)&#34;
        DAST[동적 분석&lt;br/&gt;DAST Tools]
        IAST[대화형 분석&lt;br/&gt;IAST Tools]
        PENTEST[침투 테스트&lt;br/&gt;Penetration Testing]
    end
    
    subgraph &#34;배포 환경 (Deployment Environment)&#34;
        RASP[런타임 보호&lt;br/&gt;RASP Solutions]
        WAF[웹 방화벽&lt;br/&gt;Web Application Firewall]
        MONITORING[모니터링&lt;br/&gt;Security Monitoring]
    end
    
    subgraph &#34;정책 및 관리 (Policy &amp; Management)&#34;
        POLICY[보안 정책&lt;br/&gt;Security Policies]
        TRAINING[교육&lt;br/&gt;Security Training]
        METRICS[메트릭&lt;br/&gt;Security Metrics]
    end
    
    IDE --&gt; VCS
    VCS --&gt; SAST
    SAST --&gt; SCA
    SCA --&gt; SECRETS
    SECRETS --&gt; BUILD
    BUILD --&gt; DAST
    DAST --&gt; IAST
    IAST --&gt; PENTEST
    PENTEST --&gt; RASP
    RASP --&gt; WAF
    WAF --&gt; MONITORING
    
    POLICY --&gt; IDE
    POLICY --&gt; SAST
    POLICY --&gt; DAST
    TRAINING --&gt; IDE
    MONITORING --&gt; METRICS
    
    style SAST fill:#ffeb3b
    style DAST fill:#4caf50
    style POLICY fill:#f44336
    style MONITORING fill:#2196f3
</pre><h5 id=661-필수-구성요소>6.6.1 필수 구성요소<a hidden class=anchor aria-hidden=true href=#661-필수-구성요소>#</a></h5><table><thead><tr><th>구성요소</th><th>기능</th><th>역할</th><th>특징</th></tr></thead><tbody><tr><td><strong>SAST 도구</strong></td><td>정적 코드 분석</td><td>소스코드 취약점 검출</td><td>개발 단계 조기 발견, CI/CD 통합</td></tr><tr><td><strong>보안 정책</strong></td><td>가이드라인 제공</td><td>개발 표준 정의</td><td>OWASP 기반, 업계 표준 준수</td></tr><tr><td><strong>코드 리뷰</strong></td><td>동료 검토</td><td>휴먼 팩터 보완</td><td>자동화 도구 한계 극복</td></tr><tr><td><strong>입력 검증</strong></td><td>데이터 무결성</td><td>인젝션 공격 방지</td><td>화이트리스트 기반 검증</td></tr><tr><td><strong>인증/인가</strong></td><td>접근 제어</td><td>권한 관리</td><td>Multi-factor 인증, RBAC</td></tr><tr><td><strong>암호화</strong></td><td>데이터 보호</td><td>기밀성 보장</td><td>표준 알고리즘 사용</td></tr><tr><td><strong>로깅/모니터링</strong></td><td>추적 가능성</td><td>보안 이벤트 감지</td><td>실시간 알림, 포렌식 지원</td></tr><tr><td><strong>오류 처리</strong></td><td>정보 누출 방지</td><td>안전한 실패</td><td>사용자 정의 오류 메시지</td></tr></tbody></table><h5 id=662-선택-구성요소>6.6.2 선택 구성요소<a hidden class=anchor aria-hidden=true href=#662-선택-구성요소>#</a></h5><table><thead><tr><th>구성요소</th><th>기능</th><th>역할</th><th>특징</th></tr></thead><tbody><tr><td><strong>DAST 도구</strong></td><td>동적 분석</td><td>런타임 취약점 검출</td><td>실제 공격 시뮬레이션</td></tr><tr><td><strong>IAST 도구</strong></td><td>대화형 분석</td><td>SAST/DAST 보완</td><td>높은 정확도, 낮은 오탐</td></tr><tr><td><strong>RASP 도구</strong></td><td>런타임 보호</td><td>실시간 공격 차단</td><td>애플리케이션 내장형</td></tr><tr><td><strong>WAF</strong></td><td>웹 방화벽</td><td>네트워크 레벨 보호</td><td>외부 위협 차단</td></tr><tr><td><strong>SCA 도구</strong></td><td>의존성 분석</td><td>오픈소스 취약점 관리</td><td>라이선스 관리 포함</td></tr><tr><td><strong>Fuzzing 도구</strong></td><td>무작위 테스트</td><td>예상치 못한 취약점 발견</td><td>자동화된 테스트 케이스 생성</td></tr><tr><td><strong>Threat Modeling 도구</strong></td><td>위협 분석</td><td>설계 단계 보안</td><td>시각화된 위협 맵</td></tr></tbody></table><h4 id=67-구현-기법>6.7 구현 기법<a hidden class=anchor aria-hidden=true href=#67-구현-기법>#</a></h4><h5 id=671-입력-검증-input-validation>6.7.1 입력 검증 (Input Validation)<a hidden class=anchor aria-hidden=true href=#671-입력-검증-input-validation>#</a></h5><p><strong>정의</strong>: 모든 외부 입력에 대한 검증 및 무결성 확인<br><strong>구성</strong>: 화이트리스트 검증, 데이터 타입 확인, 길이 제한, 특수문자 필터링<br><strong>목적</strong>: SQL 인젝션, XSS, 버퍼 오버플로 등 인젝션 공격 방지</p><p><strong>실제 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1> 1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2> 2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3> 3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4> 4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5> 5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6> 6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7> 7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8> 8</a>
</span><span class=lnt id=hl-15-9><a class=lnlinks href=#hl-15-9> 9</a>
</span><span class=lnt id=hl-15-10><a class=lnlinks href=#hl-15-10>10</a>
</span><span class=lnt id=hl-15-11><a class=lnlinks href=#hl-15-11>11</a>
</span><span class=lnt id=hl-15-12><a class=lnlinks href=#hl-15-12>12</a>
</span><span class=lnt id=hl-15-13><a class=lnlinks href=#hl-15-13>13</a>
</span><span class=lnt id=hl-15-14><a class=lnlinks href=#hl-15-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 안전하지 않은 코드</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>search_user</span><span class=p>(</span><span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>query</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;SELECT * FROM users WHERE id = </span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>execute_query</span><span class=p>(</span><span class=n>query</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 안전한 코드</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>search_user</span><span class=p>(</span><span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 입력 검증</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=nb>int</span><span class=p>)</span> <span class=ow>or</span> <span class=n>user_id</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Invalid user ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 파라미터화된 쿼리 사용</span>
</span></span><span class=line><span class=cl>    <span class=n>query</span> <span class=o>=</span> <span class=s2>&#34;SELECT * FROM users WHERE id = ?&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>execute_query</span><span class=p>(</span><span class=n>query</span><span class=p>,</span> <span class=p>(</span><span class=n>user_id</span><span class=p>,))</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=672-보안-인증-및-세션-관리>6.7.2 보안 인증 및 세션 관리<a hidden class=anchor aria-hidden=true href=#672-보안-인증-및-세션-관리>#</a></h5><p><strong>정의</strong>: 사용자 신원 확인 및 세션 생명주기 관리<br><strong>구성</strong>: Multi-factor 인증, 세션 토큰 관리, 세션 타임아웃, 안전한 로그아웃<br><strong>목적</strong>: 무단 접근 방지, 세션 하이재킹 방지</p><p><strong>시스템 구성 예시</strong>:</p><ul><li><strong>인증 서버</strong>: OAuth 2.0/OpenID Connect 기반</li><li><strong>세션 저장소</strong>: Redis/Memcached (분산 환경)</li><li><strong>토큰 관리</strong>: JWT (JSON Web Token) 활용</li><li><strong>보안 강화</strong>: Rate limiting, Account lockout</li></ul><h5 id=673-암호화-구현>6.7.3 암호화 구현<a hidden class=anchor aria-hidden=true href=#673-암호화-구현>#</a></h5><p><strong>정의</strong>: 데이터의 기밀성과 무결성을 보장하는 암호화 기법<br><strong>구성</strong>: 대칭/비대칭 암호화, 해시 함수, 디지털 서명, 키 관리<br><strong>목적</strong>: 저장 및 전송 데이터 보호</p><p><strong>구현 시나리오</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11>11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12>12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13>13</a>
</span><span class=lnt id=hl-16-14><a class=lnlinks href=#hl-16-14>14</a>
</span><span class=lnt id=hl-16-15><a class=lnlinks href=#hl-16-15>15</a>
</span><span class=lnt id=hl-16-16><a class=lnlinks href=#hl-16-16>16</a>
</span><span class=lnt id=hl-16-17><a class=lnlinks href=#hl-16-17>17</a>
</span><span class=lnt id=hl-16-18><a class=lnlinks href=#hl-16-18>18</a>
</span><span class=lnt id=hl-16-19><a class=lnlinks href=#hl-16-19>19</a>
</span><span class=lnt id=hl-16-20><a class=lnlinks href=#hl-16-20>20</a>
</span><span class=lnt id=hl-16-21><a class=lnlinks href=#hl-16-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>cryptography.fernet</span> <span class=kn>import</span> <span class=n>Fernet</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>bcrypt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SecurityManager</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>encryption_key</span> <span class=o>=</span> <span class=n>Fernet</span><span class=o>.</span><span class=n>generate_key</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>cipher_suite</span> <span class=o>=</span> <span class=n>Fernet</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>encryption_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>encrypt_sensitive_data</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;민감한 데이터 암호화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>cipher_suite</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>hash_password</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;비밀번호 해시화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>salt</span> <span class=o>=</span> <span class=n>bcrypt</span><span class=o>.</span><span class=n>gensalt</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>bcrypt</span><span class=o>.</span><span class=n>hashpw</span><span class=p>(</span><span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span> <span class=n>salt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>verify_password</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>password</span><span class=p>,</span> <span class=n>hashed</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;비밀번호 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>bcrypt</span><span class=o>.</span><span class=n>checkpw</span><span class=p>(</span><span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span> <span class=n>hashed</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=68-장점>6.8 장점<a hidden class=anchor aria-hidden=true href=#68-장점>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>장점</td><td>조기 취약점 발견</td><td>SSDLC 통합으로 개발 단계에서 보안 결함을 사전에 식별하여 수정 비용을 최대 100 배 절감</td></tr><tr><td>장점</td><td>자동화된 보안 검사</td><td>CI/CD 파이프라인 통합으로 인적 오류를 줄이고 일관된 보안 품질 보장</td></tr><tr><td>장점</td><td>규정 준수 용이성</td><td>OWASP, NIST 등 표준 프레임워크 기반으로 각종 보안 규정 충족</td></tr><tr><td>장점</td><td>개발자 보안 역량 강화</td><td>지속적인 보안 교육과 피드백을 통해 개발팀의 보안 인식 및 기술 수준 향상</td></tr><tr><td>장점</td><td>비용 효율성</td><td>사후 보안 패치 대비 사전 예방으로 전체 개발 및 운영 비용 절감</td></tr><tr><td>장점</td><td>고객 신뢰도 증대</td><td>안정적인 보안 수준으로 데이터 유출 사고 방지 및 브랜드 신뢰성 확보</td></tr></tbody></table><h4 id=69-단점과-문제점-그리고-해결방안>6.9 단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#69-단점과-문제점-그리고-해결방안>#</a></h4><h5 id=단점-1>단점<a hidden class=anchor aria-hidden=true href=#단점-1>#</a></h5><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>단점</td><td>초기 구축 비용 증가</td><td>보안 도구 도입, 교육, 프로세스 구축에 상당한 초기 투자 필요</td><td>단계적 도입, ROI 분석 기반 우선순위 설정, 오픈소스 도구 활용</td></tr><tr><td>단점</td><td>개발 속도 지연</td><td>추가적인 보안 검사 및 리뷰 과정으로 개발 일정 연장</td><td>CI/CD 파이프라인 최적화, 병렬 처리, 자동화 확대</td></tr><tr><td>단점</td><td>높은 오탐률</td><td>SAST/DAST 도구의 False Positive 로 인한 개발자 피로도 증가</td><td>AI 기반 필터링, 정확한 도구 설정, 점진적 튜닝</td></tr><tr><td>단점</td><td>전문 인력 부족</td><td>보안 전문가와 보안 개발자의 부족으로 효과적 운영 어려움</td><td>내부 교육 강화, 외부 컨설팅 활용, 자동화 도구 의존도 증가</td></tr></tbody></table><h5 id=문제점-1>문제점<a hidden class=anchor aria-hidden=true href=#문제점-1>#</a></h5><table><thead><tr><th>구분</th><th>항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 방법 및 기법</th></tr></thead><tbody><tr><td>문제점</td><td>도구 간 중복 및 충돌</td><td>여러 보안 도구의 비체계적 도입</td><td>개발 효율성 저하, 결과 해석 혼란</td><td>도구별 결과 비교 분석</td><td>통합 플랫폼 사용, 도구 표준화</td><td>중앙집중식 보안 오케스트레이션 구축</td></tr><tr><td>문제점</td><td>레거시 시스템 통합 어려움</td><td>기존 시스템의 보안 기능 부재</td><td>전체 보안 수준 저하</td><td>취약점 스캔, 리스크 평가</td><td>단계적 마이그레이션 계획</td><td>래퍼 기반 보안 계층 추가, API 게이트웨이 활용</td></tr><tr><td>문제점</td><td>성능 영향</td><td>보안 검사로 인한 시스템 부하</td><td>사용자 경험 저하</td><td>성능 모니터링, 프로파일링</td><td>비동기 처리, 캐싱 전략</td><td>최적화된 알고리즘, 하드웨어 가속</td></tr><tr><td>문제점</td><td>보안 정책 준수 미흡</td><td>개발자의 보안 인식 부족</td><td>취약점 지속 발생</td><td>코드 스캔, 컴플라이언스 체크</td><td>정기 교육, 인센티브 제도</td><td>자동화된 정책 강제 적용, 개발 프로세스 내장</td></tr></tbody></table><h4 id=610-도전-과제>6.10 도전 과제<a hidden class=anchor aria-hidden=true href=#610-도전-과제>#</a></h4><h5 id=6101-기술적-도전-과제>6.10.1 기술적 도전 과제<a hidden class=anchor aria-hidden=true href=#6101-기술적-도전-과제>#</a></h5><p><strong>AI/ML 보안</strong>:</p><ul><li><strong>원인</strong>: 새로운 AI/ML 시스템의 고유한 취약점 (모델 포이즈닝, 적대적 공격)</li><li><strong>영향</strong>: 예측 불가능한 보안 위험, 전통적 보안 도구의 한계</li><li><strong>해결 방법</strong>: AI 특화 보안 도구 개발, 모델 검증 프레임워크 구축</li></ul><p><strong>클라우드 네이티브 보안</strong>:</p><ul><li><strong>원인</strong>: 컨테이너, 마이크로서비스, 서버리스 환경의 복잡성</li><li><strong>영향</strong>: 공격 표면 확대, 보안 경계 모호화</li><li><strong>해결 방법</strong>: 컨테이너 보안 스캔, 제로 트러스트 아키텍처 도입</li></ul><h5 id=6102-조직적-도전-과제>6.10.2 조직적 도전 과제<a hidden class=anchor aria-hidden=true href=#6102-조직적-도전-과제>#</a></h5><p><strong>DevSecOps 문화 정착</strong>:</p><ul><li><strong>원인</strong>: 기존 개발 문화와 보안 요구사항 간 충돌</li><li><strong>영향</strong>: 보안 도입 저항, 일관성 없는 적용</li><li><strong>해결 방법</strong>: 점진적 문화 변화, 성공 사례 공유, 인센티브 제도</li></ul><h4 id=611-분류-기준에-따른-종류-및-유형>6.11 분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#611-분류-기준에-따른-종류-및-유형>#</a></h4><table><thead><tr><th>분류 기준</th><th>종류/유형</th><th>설명</th><th>적용 범위</th></tr></thead><tbody><tr><td><strong>적용 시점</strong></td><td>Shift-Left Security</td><td>개발 초기 단계 보안 적용</td><td>요구사항, 설계, 코딩</td></tr><tr><td></td><td>Shift-Right Security</td><td>운영 단계 보안 모니터링</td><td>배포, 운영, 모니터링</td></tr><tr><td><strong>분석 방법</strong></td><td>정적 분석 (SAST)</td><td>소스코드 기반 취약점 검출</td><td>코딩, 빌드 단계</td></tr><tr><td></td><td>동적 분석 (DAST)</td><td>런타임 환경 취약점 검출</td><td>테스트, 배포 단계</td></tr><tr><td></td><td>대화형 분석 (IAST)</td><td>정적 + 동적 결합 분석</td><td>테스트 단계</td></tr><tr><td><strong>보안 영역</strong></td><td>웹 애플리케이션 보안</td><td>OWASP Top 10 기반 보안</td><td>웹 서비스, SPA</td></tr><tr><td></td><td>모바일 앱 보안</td><td>모바일 플랫폼 특화 보안</td><td>iOS, Android 앱</td></tr><tr><td></td><td>API 보안</td><td>REST, GraphQL API 보안</td><td>마이크로서비스, API</td></tr><tr><td></td><td>클라우드 보안</td><td>클라우드 네이티브 보안</td><td>컨테이너, 서버리스</td></tr><tr><td><strong>자동화 수준</strong></td><td>완전 자동화</td><td>CI/CD 통합 자동 검사</td><td>대규모 개발 조직</td></tr><tr><td></td><td>반자동화</td><td>도구 지원 + 수동 검토</td><td>중소규모 프로젝트</td></tr><tr><td></td><td>수동 보안</td><td>전문가 수동 검토</td><td>고보안 요구 시스템</td></tr></tbody></table><h4 id=612-실무-사용-예시>6.12 실무 사용 예시<a hidden class=anchor aria-hidden=true href=#612-실무-사용-예시>#</a></h4><table><thead><tr><th>사용 목적</th><th>함께 사용하는 기술</th><th>효과</th></tr></thead><tbody><tr><td><strong>금융 서비스 보안</strong></td><td>PCI DSS 준수, 암호화, 다단계 인증</td><td>금융 규정 준수, 고객 데이터 보호</td></tr><tr><td><strong>헬스케어 시스템</strong></td><td>HIPAA 준수, 접근 제어, 감사 로깅</td><td>환자 정보 보호, 의료 규정 준수</td></tr><tr><td><strong>전자상거래 플랫폼</strong></td><td>결제 보안, 개인정보 보호, 사기 탐지</td><td>고객 신뢰 확보, 매출 손실 방지</td></tr><tr><td><strong>클라우드 SaaS</strong></td><td>OAuth 2.0, API 보안, 다중 테넌시</td><td>서비스 가용성 보장, 고객 데이터 격리</td></tr><tr><td><strong>IoT 디바이스</strong></td><td>펌웨어 보안, 통신 암호화, 디바이스 인증</td><td>디바이스 무결성, 네트워크 보안</td></tr><tr><td><strong>기업 내부 시스템</strong></td><td>Active Directory 연동, VPN, 네트워크 분할</td><td>내부 정보 보호, 접근 권한 관리</td></tr></tbody></table><h4 id=613-활용-사례>6.13 활용 사례<a hidden class=anchor aria-hidden=true href=#613-활용-사례>#</a></h4><p><strong>사례: 대형 전자상거래 플랫폼의 보안 코딩 적용</strong></p><h5 id=시스템-구성>시스템 구성<a hidden class=anchor aria-hidden=true href=#시스템-구성>#</a></h5><pre class=mermaid>graph TB
    subgraph &#34;클라이언트 계층&#34;
        WEB[웹 브라우저]
        MOBILE[모바일 앱]
        API_CLIENT[써드파티 클라이언트]
    end
    
    subgraph &#34;보안 계층&#34;
        WAF[웹 방화벽&lt;br/&gt;DDoS 보호]
        LB[로드밸런서&lt;br/&gt;SSL 종료]
        GATEWAY[API 게이트웨이&lt;br/&gt;인증/인가]
    end
    
    subgraph &#34;애플리케이션 계층&#34;
        AUTH[인증 서비스&lt;br/&gt;OAuth 2.0]
        PRODUCT[상품 서비스]
        ORDER[주문 서비스]
        PAYMENT[결제 서비스&lt;br/&gt;PCI DSS 준수]
        USER[사용자 서비스]
    end
    
    subgraph &#34;데이터 계층&#34;
        CACHE[(Redis&lt;br/&gt;세션 캐시)]
        DB[(PostgreSQL&lt;br/&gt;암호화된 데이터)]
        AUDIT[(감사 로그&lt;br/&gt;Elasticsearch)]
    end
    
    subgraph &#34;모니터링 계층&#34;
        SIEM[보안 모니터링&lt;br/&gt;SIEM]
        METRICS[메트릭 수집&lt;br/&gt;Prometheus]
        ALERT[알림 시스템&lt;br/&gt;PagerDuty]
    end
    
    WEB --&gt; WAF
    MOBILE --&gt; WAF
    API_CLIENT --&gt; WAF
    WAF --&gt; LB
    LB --&gt; GATEWAY
    GATEWAY --&gt; AUTH
    GATEWAY --&gt; PRODUCT
    GATEWAY --&gt; ORDER
    GATEWAY --&gt; PAYMENT
    GATEWAY --&gt; USER
    
    AUTH --&gt; CACHE
    PRODUCT --&gt; DB
    ORDER --&gt; DB
    PAYMENT --&gt; DB
    USER --&gt; DB
    
    AUTH --&gt; AUDIT
    PAYMENT --&gt; AUDIT
    ORDER --&gt; AUDIT
    
    AUDIT --&gt; SIEM
    DB --&gt; METRICS
    SIEM --&gt; ALERT
    
    style WAF fill:#f44336
    style GATEWAY fill:#ff9800
    style PAYMENT fill:#4caf50
    style AUDIT fill:#2196f3
</pre><h5 id=workflow>Workflow<a hidden class=anchor aria-hidden=true href=#workflow>#</a></h5><pre class=mermaid>sequenceDiagram
    participant Dev as 개발자
    participant IDE as IDE
    participant Git as Git Repository
    participant CI as CI/CD Pipeline
    participant SAST as SAST 도구
    participant QA as QA 환경
    participant DAST as DAST 도구
    participant Prod as 프로덕션
    participant MON as 모니터링
    
    Dev-&gt;&gt;IDE: 코드 작성
    IDE-&gt;&gt;Dev: 실시간 보안 검사
    Dev-&gt;&gt;Git: 코드 커밋
    Git-&gt;&gt;CI: 빌드 트리거
    CI-&gt;&gt;SAST: 정적 분석 실행
    SAST-&gt;&gt;CI: 취약점 리포트
    
    alt 취약점 발견
        CI-&gt;&gt;Dev: 빌드 실패 알림
        Dev-&gt;&gt;IDE: 취약점 수정
        Dev-&gt;&gt;Git: 수정 사항 커밋
    else 정적 분석 통과
        CI-&gt;&gt;QA: 배포
        QA-&gt;&gt;DAST: 동적 분석 실행
        DAST-&gt;&gt;QA: 런타임 취약점 검사
        
        alt 동적 분석 통과
            QA-&gt;&gt;Prod: 프로덕션 배포
            Prod-&gt;&gt;MON: 보안 이벤트 모니터링
            MON-&gt;&gt;Dev: 이상 징후 알림
        else 취약점 발견
            DAST-&gt;&gt;Dev: 취약점 리포트
            Dev-&gt;&gt;IDE: 수정 작업
        end
    end
</pre><h5 id=보안-코딩의-역할>보안 코딩의 역할<a hidden class=anchor aria-hidden=true href=#보안-코딩의-역할>#</a></h5><p><strong>1. 사전 예방적 보안</strong>:</p><ul><li><strong>입력 검증</strong>: 모든 사용자 입력에 대한 서버사이드 검증으로 인젝션 공격 방지</li><li><strong>인증/인가</strong>: OAuth 2.0 기반 토큰 인증과 RBAC 으로 권한 관리</li><li><strong>암호화</strong>: 민감한 데이터의 AES-256 암호화 및 전송 시 TLS 1.3 적용</li></ul><p><strong>2. 자동화된 보안 검사</strong>:</p><ul><li><strong>CI/CD 통합</strong>: SonarQube, Checkmarx 를 통한 자동 취약점 검출</li><li><strong>의존성 관리</strong>: OWASP Dependency Check 로 서드파티 라이브러리 취약점 모니터링</li></ul><p><strong>3. 실시간 보안 모니터링</strong>:</p><ul><li><strong>SIEM 연동</strong>: 보안 이벤트 실시간 감지 및 대응</li><li><strong>이상 행위 탐지</strong>: 머신러닝 기반 사용자 행동 분석</li></ul><h5 id=보안-코딩-유무에-따른-차이점>보안 코딩 유무에 따른 차이점<a hidden class=anchor aria-hidden=true href=#보안-코딩-유무에-따른-차이점>#</a></h5><table><thead><tr><th>항목</th><th>보안 코딩 적용</th><th>보안 코딩 미적용</th><th>차이점</th></tr></thead><tbody><tr><td><strong>취약점 발견 시점</strong></td><td>개발 단계에서 80% 조기 발견</td><td>운영 단계에서 사후 발견</td><td>수정 비용 100 배 차이</td></tr><tr><td><strong>보안 사고 발생률</strong></td><td>연간 2-3 건 (경미한 수준)</td><td>연간 15-20 건 (중대한 수준)</td><td>사고 발생률 85% 감소</td></tr><tr><td><strong>개발 속도</strong></td><td>초기 20% 감소 후 안정화</td><td>단기적으로 빠름</td><td>장기적으로는 보안 코딩이 효율적</td></tr><tr><td><strong>고객 신뢰도</strong></td><td>99.9% 서비스 가용성</td><td>보안 사고로 인한 신뢰도 하락</td><td>브랜드 가치 유지</td></tr><tr><td><strong>규정 준수 비용</strong></td><td>자동화로 30% 절감</td><td>수동 감사로 높은 비용</td><td>컴플라이언스 효율성 향상</td></tr></tbody></table><h4 id=614-구현-예시>6.14 구현 예시<a hidden class=anchor aria-hidden=true href=#614-구현-예시>#</a></h4><p>다음은 전자상거래 플랫폼에서 사용된 보안 코딩 구현 예시입니다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1>  1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2>  2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3>  3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4>  4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5>  5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6>  6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7>  7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8>  8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9>  9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10> 10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11> 11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12> 12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13> 13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14> 14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15> 15</a>
</span><span class=lnt id=hl-19-16><a class=lnlinks href=#hl-19-16> 16</a>
</span><span class=lnt id=hl-19-17><a class=lnlinks href=#hl-19-17> 17</a>
</span><span class=lnt id=hl-19-18><a class=lnlinks href=#hl-19-18> 18</a>
</span><span class=lnt id=hl-19-19><a class=lnlinks href=#hl-19-19> 19</a>
</span><span class=lnt id=hl-19-20><a class=lnlinks href=#hl-19-20> 20</a>
</span><span class=lnt id=hl-19-21><a class=lnlinks href=#hl-19-21> 21</a>
</span><span class=lnt id=hl-19-22><a class=lnlinks href=#hl-19-22> 22</a>
</span><span class=lnt id=hl-19-23><a class=lnlinks href=#hl-19-23> 23</a>
</span><span class=lnt id=hl-19-24><a class=lnlinks href=#hl-19-24> 24</a>
</span><span class=lnt id=hl-19-25><a class=lnlinks href=#hl-19-25> 25</a>
</span><span class=lnt id=hl-19-26><a class=lnlinks href=#hl-19-26> 26</a>
</span><span class=lnt id=hl-19-27><a class=lnlinks href=#hl-19-27> 27</a>
</span><span class=lnt id=hl-19-28><a class=lnlinks href=#hl-19-28> 28</a>
</span><span class=lnt id=hl-19-29><a class=lnlinks href=#hl-19-29> 29</a>
</span><span class=lnt id=hl-19-30><a class=lnlinks href=#hl-19-30> 30</a>
</span><span class=lnt id=hl-19-31><a class=lnlinks href=#hl-19-31> 31</a>
</span><span class=lnt id=hl-19-32><a class=lnlinks href=#hl-19-32> 32</a>
</span><span class=lnt id=hl-19-33><a class=lnlinks href=#hl-19-33> 33</a>
</span><span class=lnt id=hl-19-34><a class=lnlinks href=#hl-19-34> 34</a>
</span><span class=lnt id=hl-19-35><a class=lnlinks href=#hl-19-35> 35</a>
</span><span class=lnt id=hl-19-36><a class=lnlinks href=#hl-19-36> 36</a>
</span><span class=lnt id=hl-19-37><a class=lnlinks href=#hl-19-37> 37</a>
</span><span class=lnt id=hl-19-38><a class=lnlinks href=#hl-19-38> 38</a>
</span><span class=lnt id=hl-19-39><a class=lnlinks href=#hl-19-39> 39</a>
</span><span class=lnt id=hl-19-40><a class=lnlinks href=#hl-19-40> 40</a>
</span><span class=lnt id=hl-19-41><a class=lnlinks href=#hl-19-41> 41</a>
</span><span class=lnt id=hl-19-42><a class=lnlinks href=#hl-19-42> 42</a>
</span><span class=lnt id=hl-19-43><a class=lnlinks href=#hl-19-43> 43</a>
</span><span class=lnt id=hl-19-44><a class=lnlinks href=#hl-19-44> 44</a>
</span><span class=lnt id=hl-19-45><a class=lnlinks href=#hl-19-45> 45</a>
</span><span class=lnt id=hl-19-46><a class=lnlinks href=#hl-19-46> 46</a>
</span><span class=lnt id=hl-19-47><a class=lnlinks href=#hl-19-47> 47</a>
</span><span class=lnt id=hl-19-48><a class=lnlinks href=#hl-19-48> 48</a>
</span><span class=lnt id=hl-19-49><a class=lnlinks href=#hl-19-49> 49</a>
</span><span class=lnt id=hl-19-50><a class=lnlinks href=#hl-19-50> 50</a>
</span><span class=lnt id=hl-19-51><a class=lnlinks href=#hl-19-51> 51</a>
</span><span class=lnt id=hl-19-52><a class=lnlinks href=#hl-19-52> 52</a>
</span><span class=lnt id=hl-19-53><a class=lnlinks href=#hl-19-53> 53</a>
</span><span class=lnt id=hl-19-54><a class=lnlinks href=#hl-19-54> 54</a>
</span><span class=lnt id=hl-19-55><a class=lnlinks href=#hl-19-55> 55</a>
</span><span class=lnt id=hl-19-56><a class=lnlinks href=#hl-19-56> 56</a>
</span><span class=lnt id=hl-19-57><a class=lnlinks href=#hl-19-57> 57</a>
</span><span class=lnt id=hl-19-58><a class=lnlinks href=#hl-19-58> 58</a>
</span><span class=lnt id=hl-19-59><a class=lnlinks href=#hl-19-59> 59</a>
</span><span class=lnt id=hl-19-60><a class=lnlinks href=#hl-19-60> 60</a>
</span><span class=lnt id=hl-19-61><a class=lnlinks href=#hl-19-61> 61</a>
</span><span class=lnt id=hl-19-62><a class=lnlinks href=#hl-19-62> 62</a>
</span><span class=lnt id=hl-19-63><a class=lnlinks href=#hl-19-63> 63</a>
</span><span class=lnt id=hl-19-64><a class=lnlinks href=#hl-19-64> 64</a>
</span><span class=lnt id=hl-19-65><a class=lnlinks href=#hl-19-65> 65</a>
</span><span class=lnt id=hl-19-66><a class=lnlinks href=#hl-19-66> 66</a>
</span><span class=lnt id=hl-19-67><a class=lnlinks href=#hl-19-67> 67</a>
</span><span class=lnt id=hl-19-68><a class=lnlinks href=#hl-19-68> 68</a>
</span><span class=lnt id=hl-19-69><a class=lnlinks href=#hl-19-69> 69</a>
</span><span class=lnt id=hl-19-70><a class=lnlinks href=#hl-19-70> 70</a>
</span><span class=lnt id=hl-19-71><a class=lnlinks href=#hl-19-71> 71</a>
</span><span class=lnt id=hl-19-72><a class=lnlinks href=#hl-19-72> 72</a>
</span><span class=lnt id=hl-19-73><a class=lnlinks href=#hl-19-73> 73</a>
</span><span class=lnt id=hl-19-74><a class=lnlinks href=#hl-19-74> 74</a>
</span><span class=lnt id=hl-19-75><a class=lnlinks href=#hl-19-75> 75</a>
</span><span class=lnt id=hl-19-76><a class=lnlinks href=#hl-19-76> 76</a>
</span><span class=lnt id=hl-19-77><a class=lnlinks href=#hl-19-77> 77</a>
</span><span class=lnt id=hl-19-78><a class=lnlinks href=#hl-19-78> 78</a>
</span><span class=lnt id=hl-19-79><a class=lnlinks href=#hl-19-79> 79</a>
</span><span class=lnt id=hl-19-80><a class=lnlinks href=#hl-19-80> 80</a>
</span><span class=lnt id=hl-19-81><a class=lnlinks href=#hl-19-81> 81</a>
</span><span class=lnt id=hl-19-82><a class=lnlinks href=#hl-19-82> 82</a>
</span><span class=lnt id=hl-19-83><a class=lnlinks href=#hl-19-83> 83</a>
</span><span class=lnt id=hl-19-84><a class=lnlinks href=#hl-19-84> 84</a>
</span><span class=lnt id=hl-19-85><a class=lnlinks href=#hl-19-85> 85</a>
</span><span class=lnt id=hl-19-86><a class=lnlinks href=#hl-19-86> 86</a>
</span><span class=lnt id=hl-19-87><a class=lnlinks href=#hl-19-87> 87</a>
</span><span class=lnt id=hl-19-88><a class=lnlinks href=#hl-19-88> 88</a>
</span><span class=lnt id=hl-19-89><a class=lnlinks href=#hl-19-89> 89</a>
</span><span class=lnt id=hl-19-90><a class=lnlinks href=#hl-19-90> 90</a>
</span><span class=lnt id=hl-19-91><a class=lnlinks href=#hl-19-91> 91</a>
</span><span class=lnt id=hl-19-92><a class=lnlinks href=#hl-19-92> 92</a>
</span><span class=lnt id=hl-19-93><a class=lnlinks href=#hl-19-93> 93</a>
</span><span class=lnt id=hl-19-94><a class=lnlinks href=#hl-19-94> 94</a>
</span><span class=lnt id=hl-19-95><a class=lnlinks href=#hl-19-95> 95</a>
</span><span class=lnt id=hl-19-96><a class=lnlinks href=#hl-19-96> 96</a>
</span><span class=lnt id=hl-19-97><a class=lnlinks href=#hl-19-97> 97</a>
</span><span class=lnt id=hl-19-98><a class=lnlinks href=#hl-19-98> 98</a>
</span><span class=lnt id=hl-19-99><a class=lnlinks href=#hl-19-99> 99</a>
</span><span class=lnt id=hl-19-100><a class=lnlinks href=#hl-19-100>100</a>
</span><span class=lnt id=hl-19-101><a class=lnlinks href=#hl-19-101>101</a>
</span><span class=lnt id=hl-19-102><a class=lnlinks href=#hl-19-102>102</a>
</span><span class=lnt id=hl-19-103><a class=lnlinks href=#hl-19-103>103</a>
</span><span class=lnt id=hl-19-104><a class=lnlinks href=#hl-19-104>104</a>
</span><span class=lnt id=hl-19-105><a class=lnlinks href=#hl-19-105>105</a>
</span><span class=lnt id=hl-19-106><a class=lnlinks href=#hl-19-106>106</a>
</span><span class=lnt id=hl-19-107><a class=lnlinks href=#hl-19-107>107</a>
</span><span class=lnt id=hl-19-108><a class=lnlinks href=#hl-19-108>108</a>
</span><span class=lnt id=hl-19-109><a class=lnlinks href=#hl-19-109>109</a>
</span><span class=lnt id=hl-19-110><a class=lnlinks href=#hl-19-110>110</a>
</span><span class=lnt id=hl-19-111><a class=lnlinks href=#hl-19-111>111</a>
</span><span class=lnt id=hl-19-112><a class=lnlinks href=#hl-19-112>112</a>
</span><span class=lnt id=hl-19-113><a class=lnlinks href=#hl-19-113>113</a>
</span><span class=lnt id=hl-19-114><a class=lnlinks href=#hl-19-114>114</a>
</span><span class=lnt id=hl-19-115><a class=lnlinks href=#hl-19-115>115</a>
</span><span class=lnt id=hl-19-116><a class=lnlinks href=#hl-19-116>116</a>
</span><span class=lnt id=hl-19-117><a class=lnlinks href=#hl-19-117>117</a>
</span><span class=lnt id=hl-19-118><a class=lnlinks href=#hl-19-118>118</a>
</span><span class=lnt id=hl-19-119><a class=lnlinks href=#hl-19-119>119</a>
</span><span class=lnt id=hl-19-120><a class=lnlinks href=#hl-19-120>120</a>
</span><span class=lnt id=hl-19-121><a class=lnlinks href=#hl-19-121>121</a>
</span><span class=lnt id=hl-19-122><a class=lnlinks href=#hl-19-122>122</a>
</span><span class=lnt id=hl-19-123><a class=lnlinks href=#hl-19-123>123</a>
</span><span class=lnt id=hl-19-124><a class=lnlinks href=#hl-19-124>124</a>
</span><span class=lnt id=hl-19-125><a class=lnlinks href=#hl-19-125>125</a>
</span><span class=lnt id=hl-19-126><a class=lnlinks href=#hl-19-126>126</a>
</span><span class=lnt id=hl-19-127><a class=lnlinks href=#hl-19-127>127</a>
</span><span class=lnt id=hl-19-128><a class=lnlinks href=#hl-19-128>128</a>
</span><span class=lnt id=hl-19-129><a class=lnlinks href=#hl-19-129>129</a>
</span><span class=lnt id=hl-19-130><a class=lnlinks href=#hl-19-130>130</a>
</span><span class=lnt id=hl-19-131><a class=lnlinks href=#hl-19-131>131</a>
</span><span class=lnt id=hl-19-132><a class=lnlinks href=#hl-19-132>132</a>
</span><span class=lnt id=hl-19-133><a class=lnlinks href=#hl-19-133>133</a>
</span><span class=lnt id=hl-19-134><a class=lnlinks href=#hl-19-134>134</a>
</span><span class=lnt id=hl-19-135><a class=lnlinks href=#hl-19-135>135</a>
</span><span class=lnt id=hl-19-136><a class=lnlinks href=#hl-19-136>136</a>
</span><span class=lnt id=hl-19-137><a class=lnlinks href=#hl-19-137>137</a>
</span><span class=lnt id=hl-19-138><a class=lnlinks href=#hl-19-138>138</a>
</span><span class=lnt id=hl-19-139><a class=lnlinks href=#hl-19-139>139</a>
</span><span class=lnt id=hl-19-140><a class=lnlinks href=#hl-19-140>140</a>
</span><span class=lnt id=hl-19-141><a class=lnlinks href=#hl-19-141>141</a>
</span><span class=lnt id=hl-19-142><a class=lnlinks href=#hl-19-142>142</a>
</span><span class=lnt id=hl-19-143><a class=lnlinks href=#hl-19-143>143</a>
</span><span class=lnt id=hl-19-144><a class=lnlinks href=#hl-19-144>144</a>
</span><span class=lnt id=hl-19-145><a class=lnlinks href=#hl-19-145>145</a>
</span><span class=lnt id=hl-19-146><a class=lnlinks href=#hl-19-146>146</a>
</span><span class=lnt id=hl-19-147><a class=lnlinks href=#hl-19-147>147</a>
</span><span class=lnt id=hl-19-148><a class=lnlinks href=#hl-19-148>148</a>
</span><span class=lnt id=hl-19-149><a class=lnlinks href=#hl-19-149>149</a>
</span><span class=lnt id=hl-19-150><a class=lnlinks href=#hl-19-150>150</a>
</span><span class=lnt id=hl-19-151><a class=lnlinks href=#hl-19-151>151</a>
</span><span class=lnt id=hl-19-152><a class=lnlinks href=#hl-19-152>152</a>
</span><span class=lnt id=hl-19-153><a class=lnlinks href=#hl-19-153>153</a>
</span><span class=lnt id=hl-19-154><a class=lnlinks href=#hl-19-154>154</a>
</span><span class=lnt id=hl-19-155><a class=lnlinks href=#hl-19-155>155</a>
</span><span class=lnt id=hl-19-156><a class=lnlinks href=#hl-19-156>156</a>
</span><span class=lnt id=hl-19-157><a class=lnlinks href=#hl-19-157>157</a>
</span><span class=lnt id=hl-19-158><a class=lnlinks href=#hl-19-158>158</a>
</span><span class=lnt id=hl-19-159><a class=lnlinks href=#hl-19-159>159</a>
</span><span class=lnt id=hl-19-160><a class=lnlinks href=#hl-19-160>160</a>
</span><span class=lnt id=hl-19-161><a class=lnlinks href=#hl-19-161>161</a>
</span><span class=lnt id=hl-19-162><a class=lnlinks href=#hl-19-162>162</a>
</span><span class=lnt id=hl-19-163><a class=lnlinks href=#hl-19-163>163</a>
</span><span class=lnt id=hl-19-164><a class=lnlinks href=#hl-19-164>164</a>
</span><span class=lnt id=hl-19-165><a class=lnlinks href=#hl-19-165>165</a>
</span><span class=lnt id=hl-19-166><a class=lnlinks href=#hl-19-166>166</a>
</span><span class=lnt id=hl-19-167><a class=lnlinks href=#hl-19-167>167</a>
</span><span class=lnt id=hl-19-168><a class=lnlinks href=#hl-19-168>168</a>
</span><span class=lnt id=hl-19-169><a class=lnlinks href=#hl-19-169>169</a>
</span><span class=lnt id=hl-19-170><a class=lnlinks href=#hl-19-170>170</a>
</span><span class=lnt id=hl-19-171><a class=lnlinks href=#hl-19-171>171</a>
</span><span class=lnt id=hl-19-172><a class=lnlinks href=#hl-19-172>172</a>
</span><span class=lnt id=hl-19-173><a class=lnlinks href=#hl-19-173>173</a>
</span><span class=lnt id=hl-19-174><a class=lnlinks href=#hl-19-174>174</a>
</span><span class=lnt id=hl-19-175><a class=lnlinks href=#hl-19-175>175</a>
</span><span class=lnt id=hl-19-176><a class=lnlinks href=#hl-19-176>176</a>
</span><span class=lnt id=hl-19-177><a class=lnlinks href=#hl-19-177>177</a>
</span><span class=lnt id=hl-19-178><a class=lnlinks href=#hl-19-178>178</a>
</span><span class=lnt id=hl-19-179><a class=lnlinks href=#hl-19-179>179</a>
</span><span class=lnt id=hl-19-180><a class=lnlinks href=#hl-19-180>180</a>
</span><span class=lnt id=hl-19-181><a class=lnlinks href=#hl-19-181>181</a>
</span><span class=lnt id=hl-19-182><a class=lnlinks href=#hl-19-182>182</a>
</span><span class=lnt id=hl-19-183><a class=lnlinks href=#hl-19-183>183</a>
</span><span class=lnt id=hl-19-184><a class=lnlinks href=#hl-19-184>184</a>
</span><span class=lnt id=hl-19-185><a class=lnlinks href=#hl-19-185>185</a>
</span><span class=lnt id=hl-19-186><a class=lnlinks href=#hl-19-186>186</a>
</span><span class=lnt id=hl-19-187><a class=lnlinks href=#hl-19-187>187</a>
</span><span class=lnt id=hl-19-188><a class=lnlinks href=#hl-19-188>188</a>
</span><span class=lnt id=hl-19-189><a class=lnlinks href=#hl-19-189>189</a>
</span><span class=lnt id=hl-19-190><a class=lnlinks href=#hl-19-190>190</a>
</span><span class=lnt id=hl-19-191><a class=lnlinks href=#hl-19-191>191</a>
</span><span class=lnt id=hl-19-192><a class=lnlinks href=#hl-19-192>192</a>
</span><span class=lnt id=hl-19-193><a class=lnlinks href=#hl-19-193>193</a>
</span><span class=lnt id=hl-19-194><a class=lnlinks href=#hl-19-194>194</a>
</span><span class=lnt id=hl-19-195><a class=lnlinks href=#hl-19-195>195</a>
</span><span class=lnt id=hl-19-196><a class=lnlinks href=#hl-19-196>196</a>
</span><span class=lnt id=hl-19-197><a class=lnlinks href=#hl-19-197>197</a>
</span><span class=lnt id=hl-19-198><a class=lnlinks href=#hl-19-198>198</a>
</span><span class=lnt id=hl-19-199><a class=lnlinks href=#hl-19-199>199</a>
</span><span class=lnt id=hl-19-200><a class=lnlinks href=#hl-19-200>200</a>
</span><span class=lnt id=hl-19-201><a class=lnlinks href=#hl-19-201>201</a>
</span><span class=lnt id=hl-19-202><a class=lnlinks href=#hl-19-202>202</a>
</span><span class=lnt id=hl-19-203><a class=lnlinks href=#hl-19-203>203</a>
</span><span class=lnt id=hl-19-204><a class=lnlinks href=#hl-19-204>204</a>
</span><span class=lnt id=hl-19-205><a class=lnlinks href=#hl-19-205>205</a>
</span><span class=lnt id=hl-19-206><a class=lnlinks href=#hl-19-206>206</a>
</span><span class=lnt id=hl-19-207><a class=lnlinks href=#hl-19-207>207</a>
</span><span class=lnt id=hl-19-208><a class=lnlinks href=#hl-19-208>208</a>
</span><span class=lnt id=hl-19-209><a class=lnlinks href=#hl-19-209>209</a>
</span><span class=lnt id=hl-19-210><a class=lnlinks href=#hl-19-210>210</a>
</span><span class=lnt id=hl-19-211><a class=lnlinks href=#hl-19-211>211</a>
</span><span class=lnt id=hl-19-212><a class=lnlinks href=#hl-19-212>212</a>
</span><span class=lnt id=hl-19-213><a class=lnlinks href=#hl-19-213>213</a>
</span><span class=lnt id=hl-19-214><a class=lnlinks href=#hl-19-214>214</a>
</span><span class=lnt id=hl-19-215><a class=lnlinks href=#hl-19-215>215</a>
</span><span class=lnt id=hl-19-216><a class=lnlinks href=#hl-19-216>216</a>
</span><span class=lnt id=hl-19-217><a class=lnlinks href=#hl-19-217>217</a>
</span><span class=lnt id=hl-19-218><a class=lnlinks href=#hl-19-218>218</a>
</span><span class=lnt id=hl-19-219><a class=lnlinks href=#hl-19-219>219</a>
</span><span class=lnt id=hl-19-220><a class=lnlinks href=#hl-19-220>220</a>
</span><span class=lnt id=hl-19-221><a class=lnlinks href=#hl-19-221>221</a>
</span><span class=lnt id=hl-19-222><a class=lnlinks href=#hl-19-222>222</a>
</span><span class=lnt id=hl-19-223><a class=lnlinks href=#hl-19-223>223</a>
</span><span class=lnt id=hl-19-224><a class=lnlinks href=#hl-19-224>224</a>
</span><span class=lnt id=hl-19-225><a class=lnlinks href=#hl-19-225>225</a>
</span><span class=lnt id=hl-19-226><a class=lnlinks href=#hl-19-226>226</a>
</span><span class=lnt id=hl-19-227><a class=lnlinks href=#hl-19-227>227</a>
</span><span class=lnt id=hl-19-228><a class=lnlinks href=#hl-19-228>228</a>
</span><span class=lnt id=hl-19-229><a class=lnlinks href=#hl-19-229>229</a>
</span><span class=lnt id=hl-19-230><a class=lnlinks href=#hl-19-230>230</a>
</span><span class=lnt id=hl-19-231><a class=lnlinks href=#hl-19-231>231</a>
</span><span class=lnt id=hl-19-232><a class=lnlinks href=#hl-19-232>232</a>
</span><span class=lnt id=hl-19-233><a class=lnlinks href=#hl-19-233>233</a>
</span><span class=lnt id=hl-19-234><a class=lnlinks href=#hl-19-234>234</a>
</span><span class=lnt id=hl-19-235><a class=lnlinks href=#hl-19-235>235</a>
</span><span class=lnt id=hl-19-236><a class=lnlinks href=#hl-19-236>236</a>
</span><span class=lnt id=hl-19-237><a class=lnlinks href=#hl-19-237>237</a>
</span><span class=lnt id=hl-19-238><a class=lnlinks href=#hl-19-238>238</a>
</span><span class=lnt id=hl-19-239><a class=lnlinks href=#hl-19-239>239</a>
</span><span class=lnt id=hl-19-240><a class=lnlinks href=#hl-19-240>240</a>
</span><span class=lnt id=hl-19-241><a class=lnlinks href=#hl-19-241>241</a>
</span><span class=lnt id=hl-19-242><a class=lnlinks href=#hl-19-242>242</a>
</span><span class=lnt id=hl-19-243><a class=lnlinks href=#hl-19-243>243</a>
</span><span class=lnt id=hl-19-244><a class=lnlinks href=#hl-19-244>244</a>
</span><span class=lnt id=hl-19-245><a class=lnlinks href=#hl-19-245>245</a>
</span><span class=lnt id=hl-19-246><a class=lnlinks href=#hl-19-246>246</a>
</span><span class=lnt id=hl-19-247><a class=lnlinks href=#hl-19-247>247</a>
</span><span class=lnt id=hl-19-248><a class=lnlinks href=#hl-19-248>248</a>
</span><span class=lnt id=hl-19-249><a class=lnlinks href=#hl-19-249>249</a>
</span><span class=lnt id=hl-19-250><a class=lnlinks href=#hl-19-250>250</a>
</span><span class=lnt id=hl-19-251><a class=lnlinks href=#hl-19-251>251</a>
</span><span class=lnt id=hl-19-252><a class=lnlinks href=#hl-19-252>252</a>
</span><span class=lnt id=hl-19-253><a class=lnlinks href=#hl-19-253>253</a>
</span><span class=lnt id=hl-19-254><a class=lnlinks href=#hl-19-254>254</a>
</span><span class=lnt id=hl-19-255><a class=lnlinks href=#hl-19-255>255</a>
</span><span class=lnt id=hl-19-256><a class=lnlinks href=#hl-19-256>256</a>
</span><span class=lnt id=hl-19-257><a class=lnlinks href=#hl-19-257>257</a>
</span><span class=lnt id=hl-19-258><a class=lnlinks href=#hl-19-258>258</a>
</span><span class=lnt id=hl-19-259><a class=lnlinks href=#hl-19-259>259</a>
</span><span class=lnt id=hl-19-260><a class=lnlinks href=#hl-19-260>260</a>
</span><span class=lnt id=hl-19-261><a class=lnlinks href=#hl-19-261>261</a>
</span><span class=lnt id=hl-19-262><a class=lnlinks href=#hl-19-262>262</a>
</span><span class=lnt id=hl-19-263><a class=lnlinks href=#hl-19-263>263</a>
</span><span class=lnt id=hl-19-264><a class=lnlinks href=#hl-19-264>264</a>
</span><span class=lnt id=hl-19-265><a class=lnlinks href=#hl-19-265>265</a>
</span><span class=lnt id=hl-19-266><a class=lnlinks href=#hl-19-266>266</a>
</span><span class=lnt id=hl-19-267><a class=lnlinks href=#hl-19-267>267</a>
</span><span class=lnt id=hl-19-268><a class=lnlinks href=#hl-19-268>268</a>
</span><span class=lnt id=hl-19-269><a class=lnlinks href=#hl-19-269>269</a>
</span><span class=lnt id=hl-19-270><a class=lnlinks href=#hl-19-270>270</a>
</span><span class=lnt id=hl-19-271><a class=lnlinks href=#hl-19-271>271</a>
</span><span class=lnt id=hl-19-272><a class=lnlinks href=#hl-19-272>272</a>
</span><span class=lnt id=hl-19-273><a class=lnlinks href=#hl-19-273>273</a>
</span><span class=lnt id=hl-19-274><a class=lnlinks href=#hl-19-274>274</a>
</span><span class=lnt id=hl-19-275><a class=lnlinks href=#hl-19-275>275</a>
</span><span class=lnt id=hl-19-276><a class=lnlinks href=#hl-19-276>276</a>
</span><span class=lnt id=hl-19-277><a class=lnlinks href=#hl-19-277>277</a>
</span><span class=lnt id=hl-19-278><a class=lnlinks href=#hl-19-278>278</a>
</span><span class=lnt id=hl-19-279><a class=lnlinks href=#hl-19-279>279</a>
</span><span class=lnt id=hl-19-280><a class=lnlinks href=#hl-19-280>280</a>
</span><span class=lnt id=hl-19-281><a class=lnlinks href=#hl-19-281>281</a>
</span><span class=lnt id=hl-19-282><a class=lnlinks href=#hl-19-282>282</a>
</span><span class=lnt id=hl-19-283><a class=lnlinks href=#hl-19-283>283</a>
</span><span class=lnt id=hl-19-284><a class=lnlinks href=#hl-19-284>284</a>
</span><span class=lnt id=hl-19-285><a class=lnlinks href=#hl-19-285>285</a>
</span><span class=lnt id=hl-19-286><a class=lnlinks href=#hl-19-286>286</a>
</span><span class=lnt id=hl-19-287><a class=lnlinks href=#hl-19-287>287</a>
</span><span class=lnt id=hl-19-288><a class=lnlinks href=#hl-19-288>288</a>
</span><span class=lnt id=hl-19-289><a class=lnlinks href=#hl-19-289>289</a>
</span><span class=lnt id=hl-19-290><a class=lnlinks href=#hl-19-290>290</a>
</span><span class=lnt id=hl-19-291><a class=lnlinks href=#hl-19-291>291</a>
</span><span class=lnt id=hl-19-292><a class=lnlinks href=#hl-19-292>292</a>
</span><span class=lnt id=hl-19-293><a class=lnlinks href=#hl-19-293>293</a>
</span><span class=lnt id=hl-19-294><a class=lnlinks href=#hl-19-294>294</a>
</span><span class=lnt id=hl-19-295><a class=lnlinks href=#hl-19-295>295</a>
</span><span class=lnt id=hl-19-296><a class=lnlinks href=#hl-19-296>296</a>
</span><span class=lnt id=hl-19-297><a class=lnlinks href=#hl-19-297>297</a>
</span><span class=lnt id=hl-19-298><a class=lnlinks href=#hl-19-298>298</a>
</span><span class=lnt id=hl-19-299><a class=lnlinks href=#hl-19-299>299</a>
</span><span class=lnt id=hl-19-300><a class=lnlinks href=#hl-19-300>300</a>
</span><span class=lnt id=hl-19-301><a class=lnlinks href=#hl-19-301>301</a>
</span><span class=lnt id=hl-19-302><a class=lnlinks href=#hl-19-302>302</a>
</span><span class=lnt id=hl-19-303><a class=lnlinks href=#hl-19-303>303</a>
</span><span class=lnt id=hl-19-304><a class=lnlinks href=#hl-19-304>304</a>
</span><span class=lnt id=hl-19-305><a class=lnlinks href=#hl-19-305>305</a>
</span><span class=lnt id=hl-19-306><a class=lnlinks href=#hl-19-306>306</a>
</span><span class=lnt id=hl-19-307><a class=lnlinks href=#hl-19-307>307</a>
</span><span class=lnt id=hl-19-308><a class=lnlinks href=#hl-19-308>308</a>
</span><span class=lnt id=hl-19-309><a class=lnlinks href=#hl-19-309>309</a>
</span><span class=lnt id=hl-19-310><a class=lnlinks href=#hl-19-310>310</a>
</span><span class=lnt id=hl-19-311><a class=lnlinks href=#hl-19-311>311</a>
</span><span class=lnt id=hl-19-312><a class=lnlinks href=#hl-19-312>312</a>
</span><span class=lnt id=hl-19-313><a class=lnlinks href=#hl-19-313>313</a>
</span><span class=lnt id=hl-19-314><a class=lnlinks href=#hl-19-314>314</a>
</span><span class=lnt id=hl-19-315><a class=lnlinks href=#hl-19-315>315</a>
</span><span class=lnt id=hl-19-316><a class=lnlinks href=#hl-19-316>316</a>
</span><span class=lnt id=hl-19-317><a class=lnlinks href=#hl-19-317>317</a>
</span><span class=lnt id=hl-19-318><a class=lnlinks href=#hl-19-318>318</a>
</span><span class=lnt id=hl-19-319><a class=lnlinks href=#hl-19-319>319</a>
</span><span class=lnt id=hl-19-320><a class=lnlinks href=#hl-19-320>320</a>
</span><span class=lnt id=hl-19-321><a class=lnlinks href=#hl-19-321>321</a>
</span><span class=lnt id=hl-19-322><a class=lnlinks href=#hl-19-322>322</a>
</span><span class=lnt id=hl-19-323><a class=lnlinks href=#hl-19-323>323</a>
</span><span class=lnt id=hl-19-324><a class=lnlinks href=#hl-19-324>324</a>
</span><span class=lnt id=hl-19-325><a class=lnlinks href=#hl-19-325>325</a>
</span><span class=lnt id=hl-19-326><a class=lnlinks href=#hl-19-326>326</a>
</span><span class=lnt id=hl-19-327><a class=lnlinks href=#hl-19-327>327</a>
</span><span class=lnt id=hl-19-328><a class=lnlinks href=#hl-19-328>328</a>
</span><span class=lnt id=hl-19-329><a class=lnlinks href=#hl-19-329>329</a>
</span><span class=lnt id=hl-19-330><a class=lnlinks href=#hl-19-330>330</a>
</span><span class=lnt id=hl-19-331><a class=lnlinks href=#hl-19-331>331</a>
</span><span class=lnt id=hl-19-332><a class=lnlinks href=#hl-19-332>332</a>
</span><span class=lnt id=hl-19-333><a class=lnlinks href=#hl-19-333>333</a>
</span><span class=lnt id=hl-19-334><a class=lnlinks href=#hl-19-334>334</a>
</span><span class=lnt id=hl-19-335><a class=lnlinks href=#hl-19-335>335</a>
</span><span class=lnt id=hl-19-336><a class=lnlinks href=#hl-19-336>336</a>
</span><span class=lnt id=hl-19-337><a class=lnlinks href=#hl-19-337>337</a>
</span><span class=lnt id=hl-19-338><a class=lnlinks href=#hl-19-338>338</a>
</span><span class=lnt id=hl-19-339><a class=lnlinks href=#hl-19-339>339</a>
</span><span class=lnt id=hl-19-340><a class=lnlinks href=#hl-19-340>340</a>
</span><span class=lnt id=hl-19-341><a class=lnlinks href=#hl-19-341>341</a>
</span><span class=lnt id=hl-19-342><a class=lnlinks href=#hl-19-342>342</a>
</span><span class=lnt id=hl-19-343><a class=lnlinks href=#hl-19-343>343</a>
</span><span class=lnt id=hl-19-344><a class=lnlinks href=#hl-19-344>344</a>
</span><span class=lnt id=hl-19-345><a class=lnlinks href=#hl-19-345>345</a>
</span><span class=lnt id=hl-19-346><a class=lnlinks href=#hl-19-346>346</a>
</span><span class=lnt id=hl-19-347><a class=lnlinks href=#hl-19-347>347</a>
</span><span class=lnt id=hl-19-348><a class=lnlinks href=#hl-19-348>348</a>
</span><span class=lnt id=hl-19-349><a class=lnlinks href=#hl-19-349>349</a>
</span><span class=lnt id=hl-19-350><a class=lnlinks href=#hl-19-350>350</a>
</span><span class=lnt id=hl-19-351><a class=lnlinks href=#hl-19-351>351</a>
</span><span class=lnt id=hl-19-352><a class=lnlinks href=#hl-19-352>352</a>
</span><span class=lnt id=hl-19-353><a class=lnlinks href=#hl-19-353>353</a>
</span><span class=lnt id=hl-19-354><a class=lnlinks href=#hl-19-354>354</a>
</span><span class=lnt id=hl-19-355><a class=lnlinks href=#hl-19-355>355</a>
</span><span class=lnt id=hl-19-356><a class=lnlinks href=#hl-19-356>356</a>
</span><span class=lnt id=hl-19-357><a class=lnlinks href=#hl-19-357>357</a>
</span><span class=lnt id=hl-19-358><a class=lnlinks href=#hl-19-358>358</a>
</span><span class=lnt id=hl-19-359><a class=lnlinks href=#hl-19-359>359</a>
</span><span class=lnt id=hl-19-360><a class=lnlinks href=#hl-19-360>360</a>
</span><span class=lnt id=hl-19-361><a class=lnlinks href=#hl-19-361>361</a>
</span><span class=lnt id=hl-19-362><a class=lnlinks href=#hl-19-362>362</a>
</span><span class=lnt id=hl-19-363><a class=lnlinks href=#hl-19-363>363</a>
</span><span class=lnt id=hl-19-364><a class=lnlinks href=#hl-19-364>364</a>
</span><span class=lnt id=hl-19-365><a class=lnlinks href=#hl-19-365>365</a>
</span><span class=lnt id=hl-19-366><a class=lnlinks href=#hl-19-366>366</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>전자상거래 플랫폼 보안 코딩 구현 예시
</span></span></span><span class=line><span class=cl><span class=s2>Security Coding Implementation for E-commerce Platform
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>secrets</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>jwt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>bcrypt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span><span class=p>,</span> <span class=n>timedelta</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Optional</span><span class=p>,</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>Any</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>cryptography.fernet</span> <span class=kn>import</span> <span class=n>Fernet</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 보안 로깅 설정</span>
</span></span><span class=line><span class=cl><span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> - </span><span class=si>%(name)s</span><span class=s1> - </span><span class=si>%(levelname)s</span><span class=s1> - </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>security_logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s1>&#39;security&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SecurityManager</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;보안 관리자 클래스 - 암호화, 인증, 검증 기능 제공&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>encryption_key</span> <span class=o>=</span> <span class=n>Fernet</span><span class=o>.</span><span class=n>generate_key</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>cipher_suite</span> <span class=o>=</span> <span class=n>Fernet</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>encryption_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>jwt_secret</span> <span class=o>=</span> <span class=n>secrets</span><span class=o>.</span><span class=n>token_urlsafe</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>hash_password</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>password</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;비밀번호 해시화 - bcrypt 사용&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_validate_password_strength</span><span class=p>(</span><span class=n>password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Password does not meet security requirements&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>salt</span> <span class=o>=</span> <span class=n>bcrypt</span><span class=o>.</span><span class=n>gensalt</span><span class=p>(</span><span class=n>rounds</span><span class=o>=</span><span class=mi>12</span><span class=p>)</span>  <span class=c1># 보안 강도 12라운드</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>bcrypt</span><span class=o>.</span><span class=n>hashpw</span><span class=p>(</span><span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span> <span class=n>salt</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>verify_password</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>password</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>hashed</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;비밀번호 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>bcrypt</span><span class=o>.</span><span class=n>checkpw</span><span class=p>(</span><span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span> <span class=n>hashed</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>security_logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Password verification failed: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_validate_password_strength</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>password</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;비밀번호 강도 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>password</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>8</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;[A-Z]&#39;</span><span class=p>,</span> <span class=n>password</span><span class=p>):</span>  <span class=c1># 대문자</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;[a-z]&#39;</span><span class=p>,</span> <span class=n>password</span><span class=p>):</span>  <span class=c1># 소문자</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;[0-9]&#39;</span><span class=p>,</span> <span class=n>password</span><span class=p>):</span>  <span class=c1># 숫자</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;[!@#$%^&amp;*(),.?&#34;:</span><span class=si>{}</span><span class=s1>|&lt;&gt;]&#39;</span><span class=p>,</span> <span class=n>password</span><span class=p>):</span>  <span class=c1># 특수문자</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>encrypt_sensitive_data</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;민감한 데이터 암호화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>cipher_suite</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>security_logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Encryption failed: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>decrypt_sensitive_data</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>encrypted_data</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;암호화된 데이터 복호화&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>cipher_suite</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>encrypted_data</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>security_logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Decryption failed: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>generate_jwt_token</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>email</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;JWT 토큰 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;email&#39;</span><span class=p>:</span> <span class=n>email</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;exp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>+</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>hours</span><span class=o>=</span><span class=mi>24</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;iat&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;jti&#39;</span><span class=p>:</span> <span class=n>secrets</span><span class=o>.</span><span class=n>token_urlsafe</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>  <span class=c1># 토큰 고유 ID</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jwt</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>payload</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>jwt_secret</span><span class=p>,</span> <span class=n>algorithm</span><span class=o>=</span><span class=s1>&#39;HS256&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>verify_jwt_token</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>token</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;JWT 토큰 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>payload</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>jwt_secret</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;HS256&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>payload</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>ExpiredSignatureError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>security_logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s2>&#34;JWT token expired&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>InvalidTokenError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>security_logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Invalid JWT token: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>InputValidator</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;입력 검증 클래스 - 모든 사용자 입력에 대한 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>validate_email</span><span class=p>(</span><span class=n>email</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;이메일 형식 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>pattern</span> <span class=o>=</span> <span class=sa>r</span><span class=s1>&#39;^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>email</span><span class=p>)</span> <span class=ow>or</span> <span class=nb>len</span><span class=p>(</span><span class=n>email</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>254</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>validate_phone</span><span class=p>(</span><span class=n>phone</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;전화번호 검증 (한국 형식)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>pattern</span> <span class=o>=</span> <span class=sa>r</span><span class=s1>&#39;^01[0-9]-\d{3,4}-\d</span><span class=si>{4}</span><span class=s1>$&#39;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>bool</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>phone</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>sanitize_string</span><span class=p>(</span><span class=n>input_str</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>max_length</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>255</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;문자열 무해화 - XSS 방지&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>input_str</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Input must be a string&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 길이 제한</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>input_str</span><span class=p>)</span> <span class=o>&gt;</span> <span class=n>max_length</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Input exceeds maximum length of </span><span class=si>{</span><span class=n>max_length</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># HTML 태그 제거</span>
</span></span><span class=line><span class=cl>        <span class=n>clean_str</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;&lt;[^&gt;]*&gt;&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>input_str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 특수문자 이스케이프</span>
</span></span><span class=line><span class=cl>        <span class=n>escape_chars</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;&lt;&#39;</span><span class=p>:</span> <span class=s1>&#39;&amp;lt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;&gt;&#39;</span><span class=p>:</span> <span class=s1>&#39;&amp;gt;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;&#34;&#39;</span><span class=p>:</span> <span class=s1>&#39;&amp;quot;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;&#39;&#34;</span><span class=p>:</span> <span class=s1>&#39;&amp;#x27;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;&amp;&#39;</span><span class=p>:</span> <span class=s1>&#39;&amp;amp;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>char</span><span class=p>,</span> <span class=n>escape</span> <span class=ow>in</span> <span class=n>escape_chars</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=n>clean_str</span> <span class=o>=</span> <span class=n>clean_str</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>char</span><span class=p>,</span> <span class=n>escape</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>clean_str</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>validate_sql_injection</span><span class=p>(</span><span class=n>query_param</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;SQL 인젝션 패턴 검사&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>dangerous_patterns</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=sa>r</span><span class=s2>&#34;(\b(SELECT|INSERT|UPDATE|DELETE|DROP|UNION|ALTER)\b)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=sa>r</span><span class=s2>&#34;(--|/\*|\*/)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=sa>r</span><span class=s2>&#34;(\b(OR|AND)\s+\d+\s*=\s*\d+)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=sa>r</span><span class=s2>&#34;(\bEXEC\b|\bEXECUTE\b)&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>pattern</span> <span class=ow>in</span> <span class=n>dangerous_patterns</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>pattern</span><span class=p>,</span> <span class=n>query_param</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>IGNORECASE</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>security_logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Potential SQL injection detected: </span><span class=si>{</span><span class=n>query_param</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>PaymentSecurityHandler</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;결제 보안 처리 클래스 - PCI DSS 준수&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>security_manager</span><span class=p>:</span> <span class=n>SecurityManager</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>security_manager</span> <span class=o>=</span> <span class=n>security_manager</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>validator</span> <span class=o>=</span> <span class=n>InputValidator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>process_payment</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>card_number</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>cvv</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>amount</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>user_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;안전한 결제 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 입력 검증</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_validate_card_number</span><span class=p>(</span><span class=n>card_number</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Invalid card number format&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_validate_cvv</span><span class=p>(</span><span class=n>cvv</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Invalid CVV format&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>_validate_amount</span><span class=p>(</span><span class=n>amount</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Invalid payment amount&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 카드 번호 마스킹 (로깅용)</span>
</span></span><span class=line><span class=cl>        <span class=n>masked_card</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_mask_card_number</span><span class=p>(</span><span class=n>card_number</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 결제 정보 암호화</span>
</span></span><span class=line><span class=cl>        <span class=n>encrypted_card</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>security_manager</span><span class=o>.</span><span class=n>encrypt_sensitive_data</span><span class=p>(</span><span class=n>card_number</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 결제 처리 로그 (민감정보 제외)</span>
</span></span><span class=line><span class=cl>        <span class=n>security_logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Payment processing initiated - User: </span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>, &#34;</span>
</span></span><span class=line><span class=cl>                           <span class=sa>f</span><span class=s2>&#34;Card: </span><span class=si>{</span><span class=n>masked_card</span><span class=si>}</span><span class=s2>, Amount: </span><span class=si>{</span><span class=n>amount</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 실제 결제 처리 (모의)</span>
</span></span><span class=line><span class=cl>        <span class=n>transaction_id</span> <span class=o>=</span> <span class=n>secrets</span><span class=o>.</span><span class=n>token_urlsafe</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 감사 로그 저장</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_log_payment_audit</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=n>masked_card</span><span class=p>,</span> <span class=n>amount</span><span class=p>,</span> <span class=n>transaction_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;transaction_id&#39;</span><span class=p>:</span> <span class=n>transaction_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;success&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;amount&#39;</span><span class=p>:</span> <span class=n>amount</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;masked_card&#39;</span><span class=p>:</span> <span class=n>masked_card</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_validate_card_number</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>card_number</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;카드 번호 유효성 검사 (Luhn 알고리즘)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 숫자만 추출</span>
</span></span><span class=line><span class=cl>        <span class=n>card_number</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\D&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>card_number</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>card_number</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>13</span> <span class=ow>or</span> <span class=nb>len</span><span class=p>(</span><span class=n>card_number</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>19</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Luhn 알고리즘 검증</span>
</span></span><span class=line><span class=cl>        <span class=n>total</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>reverse_digits</span> <span class=o>=</span> <span class=n>card_number</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>digit</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>reverse_digits</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>n</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>digit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>i</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>n</span> <span class=o>*=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>n</span> <span class=o>&gt;</span> <span class=mi>9</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>n</span> <span class=o>=</span> <span class=n>n</span> <span class=o>//</span> <span class=mi>10</span> <span class=o>+</span> <span class=n>n</span> <span class=o>%</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>            <span class=n>total</span> <span class=o>+=</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>total</span> <span class=o>%</span> <span class=mi>10</span> <span class=o>==</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_validate_cvv</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>cvv</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;CVV 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>bool</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;^\d{3,4}$&#39;</span><span class=p>,</span> <span class=n>cvv</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_validate_amount</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>amount</span><span class=p>:</span> <span class=nb>float</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;결제 금액 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>amount</span><span class=p>,</span> <span class=p>(</span><span class=nb>int</span><span class=p>,</span> <span class=nb>float</span><span class=p>))</span> <span class=ow>and</span> <span class=mi>0</span> <span class=o>&lt;</span> <span class=n>amount</span> <span class=o>&lt;=</span> <span class=mi>10000000</span>  <span class=c1># 최대 1천만원</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_mask_card_number</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>card_number</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;카드 번호 마스킹&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>clean_number</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;\D&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>card_number</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>clean_number</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=s1>&#39;*&#39;</span> <span class=o>*</span> <span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>clean_number</span><span class=p>)</span> <span class=o>-</span> <span class=mi>4</span><span class=p>)</span> <span class=o>+</span> <span class=n>clean_number</span><span class=p>[</span><span class=o>-</span><span class=mi>4</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;*&#39;</span> <span class=o>*</span> <span class=nb>len</span><span class=p>(</span><span class=n>clean_number</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_log_payment_audit</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>masked_card</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>amount</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>transaction_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;결제 감사 로그&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>audit_entry</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;masked_card&#39;</span><span class=p>:</span> <span class=n>masked_card</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;amount&#39;</span><span class=p>:</span> <span class=n>amount</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;transaction_id&#39;</span><span class=p>:</span> <span class=n>transaction_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;action&#39;</span><span class=p>:</span> <span class=s1>&#39;payment_processed&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>security_logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;AUDIT: </span><span class=si>{</span><span class=n>audit_entry</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SessionManager</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;세션 관리 클래스 - 안전한 세션 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>security_manager</span><span class=p>:</span> <span class=n>SecurityManager</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>security_manager</span> <span class=o>=</span> <span class=n>security_manager</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>active_sessions</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># 실제로는 Redis 등 외부 저장소 사용</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>max_session_duration</span> <span class=o>=</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>hours</span><span class=o>=</span><span class=mi>24</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_session</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>email</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>ip_address</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;새 세션 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>session_id</span> <span class=o>=</span> <span class=n>secrets</span><span class=o>.</span><span class=n>token_urlsafe</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>jwt_token</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>security_manager</span><span class=o>.</span><span class=n>generate_jwt_token</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=n>email</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>session_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;email&#39;</span><span class=p>:</span> <span class=n>email</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;ip_address&#39;</span><span class=p>:</span> <span class=n>ip_address</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;created_at&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;last_activity&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;jwt_token&#39;</span><span class=p>:</span> <span class=n>jwt_token</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>active_sessions</span><span class=p>[</span><span class=n>session_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>session_data</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>security_logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Session created - User: </span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>, IP: </span><span class=si>{</span><span class=n>ip_address</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>session_id</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>validate_session</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>session_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>ip_address</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;세션 유효성 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>session</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>active_sessions</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>session_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>session</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># IP 주소 검증 (세션 하이재킹 방지)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>session</span><span class=p>[</span><span class=s1>&#39;ip_address&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=n>ip_address</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>security_logger</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Session hijacking attempt detected - &#34;</span>
</span></span><span class=line><span class=cl>                                  <span class=sa>f</span><span class=s2>&#34;Session IP: </span><span class=si>{</span><span class=n>session</span><span class=p>[</span><span class=s1>&#39;ip_address&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>, &#34;</span>
</span></span><span class=line><span class=cl>                                  <span class=sa>f</span><span class=s2>&#34;Request IP: </span><span class=si>{</span><span class=n>ip_address</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>destroy_session</span><span class=p>(</span><span class=n>session_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 세션 만료 검증</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>-</span> <span class=n>session</span><span class=p>[</span><span class=s1>&#39;created_at&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=bp>self</span><span class=o>.</span><span class=n>max_session_duration</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>security_logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Session expired - User: </span><span class=si>{</span><span class=n>session</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>destroy_session</span><span class=p>(</span><span class=n>session_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># JWT 토큰 검증</span>
</span></span><span class=line><span class=cl>        <span class=n>jwt_payload</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>security_manager</span><span class=o>.</span><span class=n>verify_jwt_token</span><span class=p>(</span><span class=n>session</span><span class=p>[</span><span class=s1>&#39;jwt_token&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>jwt_payload</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>destroy_session</span><span class=p>(</span><span class=n>session_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 마지막 활동 시간 업데이트</span>
</span></span><span class=line><span class=cl>        <span class=n>session</span><span class=p>[</span><span class=s1>&#39;last_activity&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>session</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>destroy_session</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>session_id</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;세션 삭제&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>session_id</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>active_sessions</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>user_id</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>active_sessions</span><span class=p>[</span><span class=n>session_id</span><span class=p>]</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user_id&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>active_sessions</span><span class=p>[</span><span class=n>session_id</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>security_logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Session destroyed - User: </span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>demo_secure_ecommerce</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;보안 전자상거래 시스템 데모&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 보안 관리자 초기화</span>
</span></span><span class=line><span class=cl>    <span class=n>security_manager</span> <span class=o>=</span> <span class=n>SecurityManager</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>payment_handler</span> <span class=o>=</span> <span class=n>PaymentSecurityHandler</span><span class=p>(</span><span class=n>security_manager</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>session_manager</span> <span class=o>=</span> <span class=n>SessionManager</span><span class=p>(</span><span class=n>security_manager</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>validator</span> <span class=o>=</span> <span class=n>InputValidator</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=== 보안 전자상거래 시스템 데모 ===</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 1. 사용자 등록 (비밀번호 해시화)</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=s2>&#34;SecurePass123!&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>hashed_password</span> <span class=o>=</span> <span class=n>security_manager</span><span class=o>.</span><span class=n>hash_password</span><span class=p>(</span><span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;1. 비밀번호 해시화 완료: </span><span class=si>{</span><span class=n>hashed_password</span><span class=p>[:</span><span class=mi>50</span><span class=p>]</span><span class=si>}</span><span class=s2>…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 2. 이메일 검증</span>
</span></span><span class=line><span class=cl>    <span class=n>email</span> <span class=o>=</span> <span class=s2>&#34;user@example.com&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>is_valid_email</span> <span class=o>=</span> <span class=n>validator</span><span class=o>.</span><span class=n>validate_email</span><span class=p>(</span><span class=n>email</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;2. 이메일 검증 결과: </span><span class=si>{</span><span class=n>is_valid_email</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 3. 세션 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>session_id</span> <span class=o>=</span> <span class=n>session_manager</span><span class=o>.</span><span class=n>create_session</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>email</span><span class=p>,</span> <span class=s2>&#34;192.168.1.100&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;3. 세션 생성 완료: </span><span class=si>{</span><span class=n>session_id</span><span class=p>[:</span><span class=mi>20</span><span class=p>]</span><span class=si>}</span><span class=s2>…&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 4. 입력 문자열 무해화</span>
</span></span><span class=line><span class=cl>    <span class=n>user_input</span> <span class=o>=</span> <span class=s2>&#34;&lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt;Hello World&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>sanitized</span> <span class=o>=</span> <span class=n>validator</span><span class=o>.</span><span class=n>sanitize_string</span><span class=p>(</span><span class=n>user_input</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;4. 입력 무해화: &#39;</span><span class=si>{</span><span class=n>user_input</span><span class=si>}</span><span class=s2>&#39; -&gt; &#39;</span><span class=si>{</span><span class=n>sanitized</span><span class=si>}</span><span class=s2>&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 5. 결제 처리 (카드 정보 암호화)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>payment_result</span> <span class=o>=</span> <span class=n>payment_handler</span><span class=o>.</span><span class=n>process_payment</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>card_number</span><span class=o>=</span><span class=s2>&#34;4532123456789012&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>cvv</span><span class=o>=</span><span class=s2>&#34;123&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>amount</span><span class=o>=</span><span class=mf>99.99</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>user_id</span><span class=o>=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;5. 결제 처리 완료: </span><span class=si>{</span><span class=n>payment_result</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;5. 결제 처리 실패: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 6. 세션 검증</span>
</span></span><span class=line><span class=cl>    <span class=n>session_data</span> <span class=o>=</span> <span class=n>session_manager</span><span class=o>.</span><span class=n>validate_session</span><span class=p>(</span><span class=n>session_id</span><span class=p>,</span> <span class=s2>&#34;192.168.1.100&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>session_data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;6. 세션 검증 성공: User </span><span class=si>{</span><span class=n>session_data</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;6. 세션 검증 실패&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>demo_secure_ecommerce</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=615-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>6.15 실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#615-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h4><table><thead><tr><th>카테고리</th><th>고려사항</th><th>주의할 점</th><th>권장사항</th></tr></thead><tbody><tr><td><strong>조직 문화</strong></td><td>개발팀과 보안팀 간 협업 체계 구축</td><td>보안을 장애물로 인식하는 문화</td><td>보안 챔피언 제도 운영, 성공 사례 공유</td></tr><tr><td><strong>도구 선택</strong></td><td>개발 환경과 기술 스택에 적합한 도구 선정</td><td>과도한 도구 도입으로 인한 복잡성 증가</td><td>POC 를 통한 점진적 도입, 통합 플랫폼 우선 고려</td></tr><tr><td><strong>교육 및 훈련</strong></td><td>개발자 보안 역량 강화 프로그램</td><td>일회성 교육으로 끝나는 형식적 접근</td><td>지속적 학습 환경 조성, 실습 중심 교육</td></tr><tr><td><strong>프로세스 통합</strong></td><td>CI/CD 파이프라인에 보안 검사 단계 포함</td><td>개발 속도 저하에 대한 우려</td><td>병렬 처리, 증분 스캔, 우선순위 기반 수정</td></tr><tr><td><strong>메트릭 관리</strong></td><td>보안 성과 지표 정의 및 측정</td><td>정량적 측정의 어려움</td><td>KPI 설정 (취약점 수, MTTR, 커버리지 등)</td></tr><tr><td><strong>예산 계획</strong></td><td>초기 투자 비용과 ROI 계산</td><td>단기적 비용 부담</td><td>단계적 투자, 오픈소스 도구 활용</td></tr></tbody></table><h4 id=616-최적화하기-위한-고려사항-및-주의할-점>6.16 최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#616-최적화하기-위한-고려사항-및-주의할-점>#</a></h4><table><thead><tr><th>카테고리</th><th>최적화 방법</th><th>주의할 점</th><th>권장사항</th></tr></thead><tbody><tr><td><strong>성능 최적화</strong></td><td>비동기 보안 검사, 캐싱 활용</td><td>보안과 성능 간 트레이드오프</td><td>임계 경로 분석, 지연 로딩 적용</td></tr><tr><td><strong>도구 통합</strong></td><td>중앙집중식 보안 오케스트레이션</td><td>벤더 종속성 증가 위험</td><td>표준 API 사용, 멀티 벤더 전략</td></tr><tr><td><strong>자동화 확대</strong></td><td>ML/AI 기반 취약점 우선순위화</td><td>과도한 자동화로 인한 맥락 손실</td><td>인간 검토 단계 유지, 점진적 자동화</td></tr><tr><td><strong>클라우드 최적화</strong></td><td>클라우드 네이티브 보안 서비스 활용</td><td>클라우드 종속성 및 비용 증가</td><td>하이브리드 접근법, 비용 모니터링</td></tr><tr><td><strong>DevSecOps 성숙도</strong></td><td>문화적 변화와 기술적 개선 균형</td><td>급진적 변화로 인한 조직 저항</td><td>점진적 변화, 성공 사례 확산</td></tr><tr><td><strong>규모 확장성</strong></td><td>마이크로서비스 아키텍처 대응</td><td>분산 환경에서의 보안 복잡성</td><td>서비스 메시 활용, 중앙화된 정책 관리</td></tr></tbody></table><hr><h3 id=7-주제와-관련하여-주목할-내용>7. 주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#7-주제와-관련하여-주목할-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>새로운 기술</strong></td><td>AI/ML 보안</td><td>적대적 공격 (Adversarial Attacks)</td><td>AI 모델을 속이는 공격 기법과 대응 방안</td></tr><tr><td><strong>새로운 기술</strong></td><td>제로 트러스트</td><td>신뢰하지 않고 검증</td><td>모든 접근을 의심하고 지속적으로 검증하는 보안 모델</td></tr><tr><td><strong>도구 발전</strong></td><td>AI 기반 SAST</td><td>자동화된 취약점 수정</td><td>ChatGPT, GitHub Copilot 등을 활용한 코드 수정 제안</td></tr><tr><td><strong>표준 진화</strong></td><td>OWASP Top 10 2025</td><td>LLM 보안 위험</td><td>대규모 언어 모델 관련 새로운 보안 위험 카테고리</td></tr><tr><td><strong>클라우드 보안</strong></td><td>컨테이너 보안</td><td>이미지 스캔 및 런타임 보호</td><td>Docker, Kubernetes 환경의 보안 강화 기법</td></tr><tr><td><strong>규제 동향</strong></td><td>EU 사이버 복원력 법</td><td>소프트웨어 제품 보안 요구사항</td><td>2025 년부터 시행되는 새로운 EU 규제</td></tr><tr><td><strong>개발 방법론</strong></td><td>Shift-Left Security</td><td>개발 초기 보안 통합</td><td>설계 단계부터 보안을 고려하는 접근법</td></tr><tr><td><strong>측정 및 평가</strong></td><td>보안 메트릭</td><td>MTTR, 취약점 밀도</td><td>보안 성과를 정량적으로 측정하는 지표들</td></tr></tbody></table><hr><h3 id=8-반드시-학습해야할-내용>8. 반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#8-반드시-학습해야할-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>기본 보안 원칙</strong></td><td>CIA 트라이어드</td><td>기밀성, 무결성, 가용성</td><td>정보보안의 3 대 기본 원칙</td></tr><tr><td><strong>취약점 분류</strong></td><td>OWASP Top 10</td><td>웹 애플리케이션 10 대 위험</td><td>가장 일반적인 웹 보안 취약점</td></tr><tr><td><strong>암호화 기술</strong></td><td>대칭/비대칭 암호화</td><td>AES, RSA, 해시 함수</td><td>데이터 보호를 위한 암호화 기법</td></tr><tr><td><strong>인증/인가</strong></td><td>OAuth 2.0, JWT</td><td>토큰 기반 인증</td><td>현대적 인증 메커니즘</td></tr><tr><td><strong>보안 테스팅</strong></td><td>SAST/DAST/IAST</td><td>정적/동적/대화형 분석</td><td>자동화된 보안 테스트 도구</td></tr><tr><td><strong>보안 아키텍처</strong></td><td>Defense in Depth</td><td>다층 방어 전략</td><td>여러 보안 계층을 통한 종합적 보호</td></tr><tr><td><strong>사고 대응</strong></td><td>CSIRT 프로세스</td><td>인시던트 대응 절차</td><td>보안 사고 발생 시 체계적 대응 방법</td></tr><tr><td><strong>규정 준수</strong></td><td>GDPR, PCI DSS</td><td>개인정보보호, 카드정보보호</td><td>주요 보안 규정 요구사항</td></tr><tr><td><strong>보안 개발</strong></td><td>SSDLC</td><td>보안 개발 생명주기</td><td>전체 개발 과정에서의 보안 통합</td></tr><tr><td><strong>위협 모델링</strong></td><td>STRIDE, PASTA</td><td>위협 분석 방법론</td><td>체계적인 보안 위험 분석 기법</td></tr></tbody></table><hr><h3 id=용어-정리-1>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-1>#</a></h3><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td><strong>분석 도구</strong></td><td>SAST (Static Application Security Testing)</td><td>소스코드를 분석하여 취약점을 찾는 정적 보안 테스팅</td></tr><tr><td><strong>분석 도구</strong></td><td>DAST (Dynamic Application Security Testing)</td><td>실행 중인 애플리케이션을 테스트하는 동적 보안 테스팅</td></tr><tr><td><strong>분석 도구</strong></td><td>IAST (Interactive Application Security Testing)</td><td>SAST 와 DAST 를 결합한 대화형 보안 테스팅</td></tr><tr><td><strong>분석 도구</strong></td><td>SCA (Software Composition Analysis)</td><td>오픈소스 구성요소의 취약점을 분석하는 도구</td></tr><tr><td><strong>보안 프레임워크</strong></td><td>OWASP (Open Web Application Security Project)</td><td>웹 애플리케이션 보안 향상을 위한 비영리 재단</td></tr><tr><td><strong>보안 프레임워크</strong></td><td>NIST SSDF (Secure Software Development Framework)</td><td>미국 표준기술연구소의 보안 소프트웨어 개발 프레임워크</td></tr><tr><td><strong>개발 방법론</strong></td><td>DevSecOps</td><td>개발, 보안, 운영을 통합한 소프트웨어 개발 방법론</td></tr><tr><td><strong>개발 방법론</strong></td><td>Shift-Left Security</td><td>개발 생명주기 초기 단계로 보안을 이동시키는 접근법</td></tr><tr><td><strong>보안 원칙</strong></td><td>Defense in Depth</td><td>여러 보안 계층을 통한 심층 방어 전략</td></tr><tr><td><strong>보안 원칙</strong></td><td>Zero Trust</td><td>모든 접근을 의심하고 지속적으로 검증하는 보안 모델</td></tr><tr><td><strong>보안 원칙</strong></td><td>Principle of Least Privilege</td><td>최소 권한 원칙 - 필요한 최소한의 권한만 부여</td></tr><tr><td><strong>인증/인가</strong></td><td>OAuth 2.0</td><td>인증 및 인가를 위한 개방형 표준 프로토콜</td></tr><tr><td><strong>인증/인가</strong></td><td>JWT (JSON Web Token)</td><td>클레임을 안전하게 전송하기 위한 JSON 기반 토큰</td></tr><tr><td><strong>인증/인가</strong></td><td>RBAC (Role-Based Access Control)</td><td>역할 기반 접근 제어</td></tr><tr><td><strong>인증/인가</strong></td><td>MFA (Multi-Factor Authentication)</td><td>다단계 인증</td></tr><tr><td><strong>암호화</strong></td><td>AES (Advanced Encryption Standard)</td><td>고급 암호화 표준 - 대칭키 암호화 알고리즘</td></tr><tr><td><strong>암호화</strong></td><td>RSA</td><td>공개키 암호화 알고리즘</td></tr><tr><td><strong>암호화</strong></td><td>TLS (Transport Layer Security)</td><td>전송 계층 보안 프로토콜</td></tr><tr><td><strong>보안 취약점</strong></td><td>SQL Injection</td><td>데이터베이스 쿼리에 악의적 코드를 삽입하는 공격</td></tr><tr><td><strong>보안 취약점</strong></td><td>XSS (Cross-Site Scripting)</td><td>웹사이트에 악성 스크립트를 삽입하는 공격</td></tr><tr><td><strong>보안 취약점</strong></td><td>CSRF (Cross-Site Request Forgery)</td><td>사용자가 의도하지 않은 요청을 전송하도록 하는 공격</td></tr><tr><td><strong>보안 도구</strong></td><td>WAF (Web Application Firewall)</td><td>웹 애플리케이션을 보호하는 방화벽</td></tr><tr><td><strong>보안 도구</strong></td><td>RASP (Runtime Application Self-Protection)</td><td>애플리케이션 내장형 실시간 보호 솔루션</td></tr><tr><td><strong>보안 도구</strong></td><td>SIEM (Security Information and Event Management)</td><td>보안 정보 및 이벤트 관리 시스템</td></tr></tbody></table><hr><h3 id=참고-및-출처-1>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-1>#</a></h3><ul><li><a href=https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/>OWASP Secure Coding Practices-Quick Reference Guide</a></li><li><a href=https://csrc.nist.gov/projects/ssdf>NIST Secure Software Development Framework (SSDF)</a></li><li><a href=https://thinksys.com/devsecops/secure-software-development/>Unlocking Secure Software Development Practices 2025: Bulletproof Your Code</a></li><li><a href=https://www.securityjourney.com/post/industry-trends-in-secure-coding-what-your-team-needs-to-know-in-2025>Industry Trends in Secure Coding: What Your Team Needs to Know in 2025</a></li><li><a href=https://www.conquer-your-risk.com/2025/04/04/top-6-defensive-programming-trends-to-watch-in-2025/>Top 6 Secure Coding Trends to Watch in 2025 - Conquer your risk</a></li><li><a href=https://xygeni.io/blog/secure-coding-practices-checklist/>Secure Coding Practices Checklist for 2025 | Xygeni</a></li><li><a href=https://www.infosectrain.com/blog/top-sast-tools-in-2025/>Top SAST Tools in 2025</a></li><li><a href=https://www.ox.security/sast-and-dast-tools-still-essential-security-solutions-in-2025/>SAST and DAST Tools: Still Essential Security Testing Tools in 2025 - OX Security</a></li><li><a href=https://github.blog/enterprise-software/secure-software-development/the-architecture-of-sast-tools-an-explainer-for-developers/>The architecture of SAST tools: An explainer for developers - The GitHub Blog</a></li><li><a href=https://www.aikido.dev/blog/top-10-ai-powered-sast-tools-in-2025>Top 10 AI-powered SAST tools in 2025</a></li></ul><hr><p>보안 코딩은 소프트웨어 개발 과정에서 보안 취약점을 최소화하는 코딩 기법과 원칙을 적용하는 관행이다.<br>이는 소프트웨어가 처음부터 보안을 고려하여 설계되고 구현되도록 하여 침해, 데이터 유출, 무단 접근 및 기타 보안 위협으로부터 시스템을 보호하는 것을 목표로 한다.</p><p>보안 코딩은 소프트웨어 개발의 필수적인 부분이다. 점점 더 연결된 디지털 세계에서 안전한 소프트웨어를 구축하는 것은 모든 개발자의 기본적인 책임이 되었다.</p><p>효과적인 보안 코딩을 위해서는 다음 원칙을 따라야 한다:</p><ol><li><strong>보안은 설계부터</strong>: 개발 초기 단계부터 보안을 고려.</li><li><strong>심층 방어</strong>: 여러 보안 계층을 구현하여 단일 실패 지점을 방지.</li><li><strong>최소 권한</strong>: 필요한 최소한의 권한만 부여.</li><li><strong>기본적으로 안전</strong>: 명시적인 권한 부여 없이는 접근을 거부.</li><li><strong>지속적인 학습</strong>: 새로운 위협과 방어 기법에 대해 계속 배운다.</li></ol><p>보안 코딩은 일회성 작업이 아니라 지속적인 과정이다.<br>모든 개발자가 보안 코딩 원칙과 기법을 이해하고 실천하면, 더 안전한 디지털 생태계를 구축하는 데 기여할 수 있다.</p><p>소프트웨어의 보안은 가장 취약한 구성 요소의 강도에 의해 결정됩니다. 따라서 코드의 모든 부분에서 보안 모범 사례를 일관되게 적용하는 것이 중요하다. 이를 통해 개인 정보, 기업 데이터, 그리고 전체 시스템의 무결성을 보호할 수 있다.</p><h4 id=보안-코딩의-중요성>보안 코딩의 중요성<a hidden class=anchor aria-hidden=true href=#보안-코딩의-중요성>#</a></h4><p>현대 디지털 환경에서 보안 코딩이 중요한 이유는 다음과 같다:</p><ol><li><strong>데이터 보호</strong>: 민감한 개인정보, 금융 데이터, 기업 기밀 등을 무단 접근과 유출로부터 보호한다.</li><li><strong>비용 절감</strong>: 개발 초기 단계에서 보안을 고려하는 것이 나중에 취약점을 수정하는 것보다 비용 효율적이다. IBM 에 따르면, 설계 단계에서 보안 결함을 해결하는 비용은 운영 단계에서 해결하는 비용의 약 6 분의 1 이다.</li><li><strong>법적 규정 준수</strong>: GDPR, HIPAA, PCI DSS 와 같은 다양한 규제 프레임워크는 기업이 특정 보안 표준을 준수할 것을 요구한다..</li><li><strong>평판 보호</strong>: 보안 위반은 기업의 평판에 심각한 손상을 초래할 수 있으며, 고객 신뢰 상실로 이어질 수 있다.</li><li><strong>비즈니스 연속성</strong>: 보안 사고는 서비스 중단, 데이터 손실, 법적 제재 등을 초래하여 비즈니스 운영에 심각한 영향을 미칠 수 있다.</li></ol><h4 id=주요-보안-취약점>주요 보안 취약점<a hidden class=anchor aria-hidden=true href=#주요-보안-취약점>#</a></h4><p>OWASP(Open Web Application Security Project) 는 가장 일반적인 웹 애플리케이션 보안 위험 목록인 &ldquo;OWASP Top 10&rdquo; 을 발표한다.<br>2021 년 기준 OWASP Top 10 은 다음과 같다:</p><ol><li><strong>취약한 접근 제어 (Broken Access Control)</strong>: 사용자가 권한 없이 다른 사용자의 계정, 파일, 데이터에 접근할 수 있는 경우.</li><li><strong>암호화 실패 (Cryptographic Failures)</strong>: 민감한 데이터를 충분히 보호하지 않거나 암호화가 약하게 구현된 경우.</li><li><strong>인젝션 (Injection)</strong>: SQL, NoSQL, OS, LDAP 인젝션 등이 이에 해당한다. 신뢰할 수 없는 데이터가 명령어나 쿼리의 일부로 해석기에 전송될 때 발생한다.</li><li><strong>불안전한 설계 (Insecure Design)</strong>: 설계 단계에서 보안을 충분히 고려하지 않은 경우이다.</li><li><strong>보안 설정 오류 (Security Misconfiguration)</strong>: 기본 설정이나 불완전한 설정, 개방된 클라우드 저장소, 불필요한 HTTP 헤더 등이 포함된다.</li><li><strong>취약하고 오래된 구성요소 (Vulnerable and Outdated Components)</strong>: 취약점이 알려진 오래된 라이브러리, 프레임워크, 소프트웨어 모듈을 사용하는 경우이다.</li><li><strong>식별 및 인증 실패 (Identification and Authentication Failures)</strong>: 사용자 신원, 인증, 세션 관리 관련 함수가 잘못 구현되어 공격자가 비밀번호, 키, 세션 토큰을 탈취하거나 다른 구현 결함을 악용할 수 있는 경우.</li><li><strong>소프트웨어 및 데이터 무결성 실패 (Software and Data Integrity Failures)</strong>: 코드와 인프라가 소프트웨어 업데이트, 중요 데이터, CI/CD 파이프라인 등과 관련된 무결성 검증 없이 작동하는 경우.</li><li><strong>보안 로깅 및 모니터링 실패 (Security Logging and Monitoring Failures)</strong>: 로깅과 모니터링이 부족하거나 효과적인 대응이 이루어지지 않는 경우.</li><li><strong>서버 측 요청 위조 (Server-Side Request Forgery)</strong>: 웹 애플리케이션이 사용자가 제공한 URL 의 유효성을 검사하지 않고 원격 리소스를 가져올 때 발생.</li></ol><h4 id=보안-코딩-원칙>보안 코딩 원칙<a hidden class=anchor aria-hidden=true href=#보안-코딩-원칙>#</a></h4><p>안전한 소프트웨어를 개발하기 위한 핵심 원칙은 다음과 같다:</p><ol><li><p>최소 권한의 원칙 (Principle of Least Privilege)<br>사용자, 프로그램, 프로세스는 작업을 수행하는 데 필요한 최소한의 권한만 부여받아야 한다.<br>이는 권한 오용의 영향을 제한하고 취약점 발생 시 피해를 최소화한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1> 1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2> 2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3> 3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4> 4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5> 5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6> 6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7> 7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8> 8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9> 9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10>10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11>11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12>12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13>13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14>14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Java에서 최소 권한 원칙 적용 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 필요할 때만 관리자 권한 상승</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>performTask</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 일반 권한으로 작업 수행</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>regularWork</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 필요한 경우에만 임시적으로 권한 상승</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SecurityManager</span><span class=p>.</span><span class=na>elevatePrivileges</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>privilegedWork</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 권한 작업 완료 후 즉시 권한 원복</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SecurityManager</span><span class=p>.</span><span class=na>dropPrivileges</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>심층 방어 (Defense in Depth)<br>단일 보안 제어에 의존하지 않고 여러 방어 계층을 구현하여 한 계층이 뚫리더라도 다른 계층이 보호를 유지하도록 한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span><span class=lnt id=hl-21-11><a class=lnlinks href=#hl-21-11>11</a>
</span><span class=lnt id=hl-21-12><a class=lnlinks href=#hl-21-12>12</a>
</span><span class=lnt id=hl-21-13><a class=lnlinks href=#hl-21-13>13</a>
</span><span class=lnt id=hl-21-14><a class=lnlinks href=#hl-21-14>14</a>
</span><span class=lnt id=hl-21-15><a class=lnlinks href=#hl-21-15>15</a>
</span><span class=lnt id=hl-21-16><a class=lnlinks href=#hl-21-16>16</a>
</span><span class=lnt id=hl-21-17><a class=lnlinks href=#hl-21-17>17</a>
</span><span class=lnt id=hl-21-18><a class=lnlinks href=#hl-21-18>18</a>
</span><span class=lnt id=hl-21-19><a class=lnlinks href=#hl-21-19>19</a>
</span><span class=lnt id=hl-21-20><a class=lnlinks href=#hl-21-20>20</a>
</span><span class=lnt id=hl-21-21><a class=lnlinks href=#hl-21-21>21</a>
</span><span class=lnt id=hl-21-22><a class=lnlinks href=#hl-21-22>22</a>
</span><span class=lnt id=hl-21-23><a class=lnlinks href=#hl-21-23>23</a>
</span><span class=lnt id=hl-21-24><a class=lnlinks href=#hl-21-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python에서 심층 방어 예시</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>process_user_request</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 1단계: 입력 검증</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>validate_request_format</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;Invalid request format&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 2단계: 인증</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>authenticate_user</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>user_id</span><span class=p>,</span> <span class=n>request</span><span class=o>.</span><span class=n>token</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>log_authentication_failure</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;Authentication failed&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 3단계: 권한 부여</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>authorize_action</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>user_id</span><span class=p>,</span> <span class=n>request</span><span class=o>.</span><span class=n>action</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>log_authorization_failure</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;Unauthorized action&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 4단계: 입력 샌드박스 처리 및 이스케이프</span>
</span></span><span class=line><span class=cl>    <span class=n>sanitized_data</span> <span class=o>=</span> <span class=n>sanitize_input</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 5단계: 실행 및 모니터링</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>execute_action</span><span class=p>(</span><span class=n>sanitized_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>log_action_execution</span><span class=p>(</span><span class=n>request</span><span class=p>,</span> <span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>안전한 기본값 (Secure by Default)<br>소프트웨어는 기본적으로 보안을 유지하도록 구성해야 한다.<br>사용자가 새 기능을 활성화할 때까지 안전한 상태를 유지해야 한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1> 1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2> 2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3> 3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4> 4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5> 5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6> 6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7> 7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8> 8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9> 9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10>10</a>
</span><span class=lnt id=hl-22-11><a class=lnlinks href=#hl-22-11>11</a>
</span><span class=lnt id=hl-22-12><a class=lnlinks href=#hl-22-12>12</a>
</span><span class=lnt id=hl-22-13><a class=lnlinks href=#hl-22-13>13</a>
</span><span class=lnt id=hl-22-14><a class=lnlinks href=#hl-22-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// JavaScript에서 안전한 기본값 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>createUserConfig</span> <span class=o>=</span> <span class=p>(</span><span class=nx>userOptions</span> <span class=o>=</span> <span class=p>{})</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 안전한 기본값을 먼저 정의
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>defaultConfig</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>allowExternalConnections</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>enableEncryption</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>maxLoginAttempts</span><span class=o>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>sessionTimeout</span><span class=o>:</span> <span class=mi>15</span> <span class=o>*</span> <span class=mi>60</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>,</span> <span class=c1>// 15분
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>requireStrongPasswords</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 사용자 옵션으로 기본값 덮어쓰기
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=p>{</span> <span class=err>…</span><span class=nx>defaultConfig</span><span class=p>,</span> <span class=err>…</span><span class=nx>userOptions</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>데이터 검증 (Data Validation)<br>모든 입력 데이터는 사용하기 전에 유효성을 검사해야 한다. 이는 클라이언트와 서버 측 모두에서 수행해야 한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1> 1</a>
</span><span class=lnt id=hl-23-2><a class=lnlinks href=#hl-23-2> 2</a>
</span><span class=lnt id=hl-23-3><a class=lnlinks href=#hl-23-3> 3</a>
</span><span class=lnt id=hl-23-4><a class=lnlinks href=#hl-23-4> 4</a>
</span><span class=lnt id=hl-23-5><a class=lnlinks href=#hl-23-5> 5</a>
</span><span class=lnt id=hl-23-6><a class=lnlinks href=#hl-23-6> 6</a>
</span><span class=lnt id=hl-23-7><a class=lnlinks href=#hl-23-7> 7</a>
</span><span class=lnt id=hl-23-8><a class=lnlinks href=#hl-23-8> 8</a>
</span><span class=lnt id=hl-23-9><a class=lnlinks href=#hl-23-9> 9</a>
</span><span class=lnt id=hl-23-10><a class=lnlinks href=#hl-23-10>10</a>
</span><span class=lnt id=hl-23-11><a class=lnlinks href=#hl-23-11>11</a>
</span><span class=lnt id=hl-23-12><a class=lnlinks href=#hl-23-12>12</a>
</span><span class=lnt id=hl-23-13><a class=lnlinks href=#hl-23-13>13</a>
</span><span class=lnt id=hl-23-14><a class=lnlinks href=#hl-23-14>14</a>
</span><span class=lnt id=hl-23-15><a class=lnlinks href=#hl-23-15>15</a>
</span><span class=lnt id=hl-23-16><a class=lnlinks href=#hl-23-16>16</a>
</span><span class=lnt id=hl-23-17><a class=lnlinks href=#hl-23-17>17</a>
</span><span class=lnt id=hl-23-18><a class=lnlinks href=#hl-23-18>18</a>
</span><span class=lnt id=hl-23-19><a class=lnlinks href=#hl-23-19>19</a>
</span><span class=lnt id=hl-23-20><a class=lnlinks href=#hl-23-20>20</a>
</span><span class=lnt id=hl-23-21><a class=lnlinks href=#hl-23-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=c1>// C#에서 데이터 검증 예시</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>void</span> <span class=n>ProcessUserInput</span><span class=p>(</span><span class=kt>string</span> <span class=n>username</span><span class=p>,</span> <span class=kt>string</span> <span class=n>email</span><span class=p>,</span> <span class=kt>int</span> <span class=n>age</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 빈 값 체크</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=kt>string</span><span class=p>.</span><span class=n>IsNullOrEmpty</span><span class=p>(</span><span class=n>username</span><span class=p>)</span> <span class=p>||</span> <span class=kt>string</span><span class=p>.</span><span class=n>IsNullOrEmpty</span><span class=p>(</span><span class=n>email</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=n>ArgumentException</span><span class=p>(</span><span class=s>&#34;Username and email are required&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 형식 검증</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>Regex</span><span class=p>.</span><span class=n>IsMatch</span><span class=p>(</span><span class=n>username</span><span class=p>,</span> <span class=s>&#34;^[a-zA-Z0-9_]{3,20}$&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=n>ArgumentException</span><span class=p>(</span><span class=s>&#34;Username must be 3-20 alphanumeric characters or underscores&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>Regex</span><span class=p>.</span><span class=n>IsMatch</span><span class=p>(</span><span class=n>email</span><span class=p>,</span> <span class=s>@&#34;^[^@\s]+@[^@\s]+\.[^@\s]+$&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=n>ArgumentException</span><span class=p>(</span><span class=s>&#34;Invalid email format&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 범위 검증</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>age</span> <span class=p>&lt;</span> <span class=m>18</span> <span class=p>||</span> <span class=n>age</span> <span class=p>&gt;</span> <span class=m>120</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=k>new</span> <span class=n>ArgumentException</span><span class=p>(</span><span class=s>&#34;Age must be between 18 and 120&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 검증 통과 후 처리</span>
</span></span><span class=line><span class=cl>    <span class=n>SaveUserData</span><span class=p>(</span><span class=n>username</span><span class=p>,</span> <span class=n>email</span><span class=p>,</span> <span class=n>age</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>적절한 인증 및 인가 (Proper Authentication and Authorization)<br>사용자 신원을 확인하고 (인증) 해당 사용자가 특정 리소스나 기능에 접근할 수 있는 권한이 있는지 (인가) 확인하는 강력한 메커니즘을 구현한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1> 1</a>
</span><span class=lnt id=hl-24-2><a class=lnlinks href=#hl-24-2> 2</a>
</span><span class=lnt id=hl-24-3><a class=lnlinks href=#hl-24-3> 3</a>
</span><span class=lnt id=hl-24-4><a class=lnlinks href=#hl-24-4> 4</a>
</span><span class=lnt id=hl-24-5><a class=lnlinks href=#hl-24-5> 5</a>
</span><span class=lnt id=hl-24-6><a class=lnlinks href=#hl-24-6> 6</a>
</span><span class=lnt id=hl-24-7><a class=lnlinks href=#hl-24-7> 7</a>
</span><span class=lnt id=hl-24-8><a class=lnlinks href=#hl-24-8> 8</a>
</span><span class=lnt id=hl-24-9><a class=lnlinks href=#hl-24-9> 9</a>
</span><span class=lnt id=hl-24-10><a class=lnlinks href=#hl-24-10>10</a>
</span><span class=lnt id=hl-24-11><a class=lnlinks href=#hl-24-11>11</a>
</span><span class=lnt id=hl-24-12><a class=lnlinks href=#hl-24-12>12</a>
</span><span class=lnt id=hl-24-13><a class=lnlinks href=#hl-24-13>13</a>
</span><span class=lnt id=hl-24-14><a class=lnlinks href=#hl-24-14>14</a>
</span><span class=lnt id=hl-24-15><a class=lnlinks href=#hl-24-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python Flask에서 인증 및 인가 예시</span>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/admin/dashboard&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>admin_dashboard</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 인증: 사용자가 로그인되어 있는지 확인</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>current_user</span><span class=o>.</span><span class=n>is_authenticated</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;login&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 인가: 사용자가 관리자 권한을 가지고 있는지 확인</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>current_user</span><span class=o>.</span><span class=n>has_role</span><span class=p>(</span><span class=s1>&#39;admin&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>flash</span><span class=p>(</span><span class=s1>&#39;Unauthorized access attempt recorded&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>log_security_event</span><span class=p>(</span><span class=s1>&#39;unauthorized_access&#39;</span><span class=p>,</span> <span class=n>user</span><span class=o>=</span><span class=n>current_user</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;home&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 인증 및 인가 성공</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;admin/dashboard.html&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>실패 안전 (Fail Secure)<br>오류가 발생할 경우, 시스템은 안전한 상태로 되돌아가야 한다.<br>오류가 보안을 약화시키거나 민감한 정보를 노출해서는 안 된다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1> 1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2> 2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3> 3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4> 4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5> 5</a>
</span><span class=lnt id=hl-25-6><a class=lnlinks href=#hl-25-6> 6</a>
</span><span class=lnt id=hl-25-7><a class=lnlinks href=#hl-25-7> 7</a>
</span><span class=lnt id=hl-25-8><a class=lnlinks href=#hl-25-8> 8</a>
</span><span class=lnt id=hl-25-9><a class=lnlinks href=#hl-25-9> 9</a>
</span><span class=lnt id=hl-25-10><a class=lnlinks href=#hl-25-10>10</a>
</span><span class=lnt id=hl-25-11><a class=lnlinks href=#hl-25-11>11</a>
</span><span class=lnt id=hl-25-12><a class=lnlinks href=#hl-25-12>12</a>
</span><span class=lnt id=hl-25-13><a class=lnlinks href=#hl-25-13>13</a>
</span><span class=lnt id=hl-25-14><a class=lnlinks href=#hl-25-14>14</a>
</span><span class=lnt id=hl-25-15><a class=lnlinks href=#hl-25-15>15</a>
</span><span class=lnt id=hl-25-16><a class=lnlinks href=#hl-25-16>16</a>
</span><span class=lnt id=hl-25-17><a class=lnlinks href=#hl-25-17>17</a>
</span><span class=lnt id=hl-25-18><a class=lnlinks href=#hl-25-18>18</a>
</span><span class=lnt id=hl-25-19><a class=lnlinks href=#hl-25-19>19</a>
</span><span class=lnt id=hl-25-20><a class=lnlinks href=#hl-25-20>20</a>
</span><span class=lnt id=hl-25-21><a class=lnlinks href=#hl-25-21>21</a>
</span><span class=lnt id=hl-25-22><a class=lnlinks href=#hl-25-22>22</a>
</span><span class=lnt id=hl-25-23><a class=lnlinks href=#hl-25-23>23</a>
</span><span class=lnt id=hl-25-24><a class=lnlinks href=#hl-25-24>24</a>
</span><span class=lnt id=hl-25-25><a class=lnlinks href=#hl-25-25>25</a>
</span><span class=lnt id=hl-25-26><a class=lnlinks href=#hl-25-26>26</a>
</span><span class=lnt id=hl-25-27><a class=lnlinks href=#hl-25-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Java에서 실패 안전 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>processTransaction</span><span class=p>(</span><span class=n>Transaction</span><span class=w> </span><span class=n>transaction</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 트랜잭션 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>validateTransaction</span><span class=p>(</span><span class=n>transaction</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>authorizeTransaction</span><span class=p>(</span><span class=n>transaction</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>completeTransaction</span><span class=p>(</span><span class=n>transaction</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>logSuccess</span><span class=p>(</span><span class=n>transaction</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>ValidationException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 유효성 검사 실패 - 안전하게 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>logError</span><span class=p>(</span><span class=s>&#34;Validation error&#34;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>notifyUser</span><span class=p>(</span><span class=s>&#34;Transaction could not be processed&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>AuthorizationException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 권한 부여 실패 - 안전하게 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>logError</span><span class=p>(</span><span class=s>&#34;Authorization error&#34;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>notifyUser</span><span class=p>(</span><span class=s>&#34;Transaction not authorized&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 예상치 못한 오류 - 안전하게 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>logError</span><span class=p>(</span><span class=s>&#34;Unexpected error in transaction&#34;</span><span class=p>,</span><span class=w> </span><span class=n>e</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>rollbackTransaction</span><span class=p>(</span><span class=n>transaction</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>notifyUser</span><span class=p>(</span><span class=s>&#34;System error occurred, transaction cancelled&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>notifyAdmin</span><span class=p>(</span><span class=s>&#34;Unexpected transaction error&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>비밀 유지하지 않기 (No Security Through Obscurity)<br>암호화 알고리즘, 키, 비밀번호와 같은 핵심 보안 요소는 시스템의 비공개 부분에 의존해서는 안 된다.<br>시스템은 내부 작동이 노출되더라도 안전해야 한다.</p></li><li><p>완전한 중개 (Complete Mediation)<br>모든 리소스 접근은 각 접근 시도마다 인증과 인가를 거쳐야 한다.<br>이전 접근 결정에 의존하는 캐싱 메커니즘은 신중하게 설계해야 한다.</p></li></ol><h4 id=보안-코딩-관행>보안 코딩 관행<a hidden class=anchor aria-hidden=true href=#보안-코딩-관행>#</a></h4><p>효과적인 보안 코딩을 위한 주요 실천 사항:</p><ol><li><p>코드 리뷰<br>보안에 중점을 둔 코드 리뷰 프로세스를 구현한다.<br>이는 보안 결함을 조기에 발견하고 수정하는 데 도움이 된다.</p></li><li><p>정적 코드 분석<br>정적 분석 도구를 사용하여 실행 전에 코드에서 보안 취약점을 식별한다:</p><ul><li>Java: FindBugs, SonarQube, Checkmarx</li><li>Python: Bandit, PyLint</li><li>JavaScript: ESLint, SonarQube</li><li>C/C++: Coverity, Cppcheck</li></ul></li><li><p>동적 분석<br>애플리케이션이 실행 중일 때 보안 취약점을 발견하기 위해 동적 분석을 수행한다:</p><ul><li>퍼징 (Fuzzing): 무작위 또는 조작된 입력으로 프로그램을 테스트하여 충돌이나 취약점 발견</li><li>침투 테스트: 실제 공격자처럼 시스템을 테스트</li><li>보안 스캐닝: OWASP ZAP, Burp Suite 와 같은 도구를 사용하여 웹 애플리케이션 취약점 스캔</li></ul></li><li><p>의존성 관리<br>모든 라이브러리와 프레임워크를 정기적으로 업데이트하고 알려진 취약점이 있는 종속성을 모니터링한다:</p><ul><li>Node.js: <code>npm audit</code></li><li>Java: OWASP Dependency Check</li><li>Python: Safety</li></ul></li><li><p>안전한 배포 프로세스<br>배포 과정의 각 단계에서 보안을 통합한다:</p><ul><li>개발 환경에서 보안 시작</li><li>CI/CD 파이프라인에 자동화된 보안 테스트 통합</li><li>안전한 코드 서명 및 확인</li><li>취약점 모니터링을 위한 지속적인 감사</li></ul></li></ol><h4 id=언어별-보안-코딩-기법>언어별 보안 코딩 기법<a hidden class=anchor aria-hidden=true href=#언어별-보안-코딩-기법>#</a></h4><p>각 프로그래밍 언어는 자체적인 보안 위험과 모범 사례를 가지고 있다:</p><h5 id=java>Java<a hidden class=anchor aria-hidden=true href=#java>#</a></h5><p>Java 는 메모리 안전성 기능이 내장되어 있지만 여전히 주의해야 할 사항이 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-26-1><a class=lnlinks href=#hl-26-1> 1</a>
</span><span class=lnt id=hl-26-2><a class=lnlinks href=#hl-26-2> 2</a>
</span><span class=lnt id=hl-26-3><a class=lnlinks href=#hl-26-3> 3</a>
</span><span class=lnt id=hl-26-4><a class=lnlinks href=#hl-26-4> 4</a>
</span><span class=lnt id=hl-26-5><a class=lnlinks href=#hl-26-5> 5</a>
</span><span class=lnt id=hl-26-6><a class=lnlinks href=#hl-26-6> 6</a>
</span><span class=lnt id=hl-26-7><a class=lnlinks href=#hl-26-7> 7</a>
</span><span class=lnt id=hl-26-8><a class=lnlinks href=#hl-26-8> 8</a>
</span><span class=lnt id=hl-26-9><a class=lnlinks href=#hl-26-9> 9</a>
</span><span class=lnt id=hl-26-10><a class=lnlinks href=#hl-26-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT * FROM users WHERE username = &#39;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>userInput</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;&#39;&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Statement</span><span class=w> </span><span class=n>stmt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connection</span><span class=p>.</span><span class=na>createStatement</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>ResultSet</span><span class=w> </span><span class=n>rs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stmt</span><span class=p>.</span><span class=na>executeQuery</span><span class=p>(</span><span class=n>query</span><span class=p>);</span><span class=w>  </span><span class=c1>// SQL 인젝션 위험</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 안전한 코드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT * FROM users WHERE username = ?&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>PreparedStatement</span><span class=w> </span><span class=n>stmt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connection</span><span class=p>.</span><span class=na>prepareStatement</span><span class=p>(</span><span class=n>query</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>stmt</span><span class=p>.</span><span class=na>setString</span><span class=p>(</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>userInput</span><span class=p>);</span><span class=w>  </span><span class=c1>// 파라미터화된 쿼리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>ResultSet</span><span class=w> </span><span class=n>rs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stmt</span><span class=p>.</span><span class=na>executeQuery</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol><li><strong>입력 검증</strong>: 모든 사용자 입력을 신뢰하지 말고 검증한다.</li><li><strong>매개변수화된 쿼리</strong>: SQL 인젝션을 방지하기 위해 항상 PreparedStatement 를 사용한다.</li><li><strong>안전한 직렬화</strong>: <code>readObject()</code> 메서드를 오버라이드하여 안전한 역직렬화를 보장한다.</li><li><strong>접근 제어</strong>: 클래스와 메서드에 적절한 접근 수정자 (private, protected 등) 를 사용한다.</li></ol><h5 id=python>Python<a hidden class=anchor aria-hidden=true href=#python>#</a></h5><p>Python 은 사용하기 쉽지만 몇 가지 주의할 보안 문제가 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-27-1><a class=lnlinks href=#hl-27-1>1</a>
</span><span class=lnt id=hl-27-2><a class=lnlinks href=#hl-27-2>2</a>
</span><span class=lnt id=hl-27-3><a class=lnlinks href=#hl-27-3>3</a>
</span><span class=lnt id=hl-27-4><a class=lnlinks href=#hl-27-4>4</a>
</span><span class=lnt id=hl-27-5><a class=lnlinks href=#hl-27-5>5</a>
</span><span class=lnt id=hl-27-6><a class=lnlinks href=#hl-27-6>6</a>
</span><span class=lnt id=hl-27-7><a class=lnlinks href=#hl-27-7>7</a>
</span><span class=lnt id=hl-27-8><a class=lnlinks href=#hl-27-8>8</a>
</span><span class=lnt id=hl-27-9><a class=lnlinks href=#hl-27-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 안전하지 않은 코드</span>
</span></span><span class=line><span class=cl><span class=n>user_data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user_input&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>eval</span><span class=p>(</span><span class=n>user_data</span><span class=p>)</span>  <span class=c1># 코드 인젝션 위험</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 안전한 코드</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>ast</span>
</span></span><span class=line><span class=cl><span class=n>user_data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user_input&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># 안전한 평가를 위해 ast.literal_eval 사용</span>
</span></span><span class=line><span class=cl><span class=n>safe_data</span> <span class=o>=</span> <span class=n>ast</span><span class=o>.</span><span class=n>literal_eval</span><span class=p>(</span><span class=n>user_data</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ol><li><strong>안전하지 않은 함수 사용 자제</strong>: <code>eval()</code>, <code>exec()</code>, <code>os.system()</code> 등의 사용을 피하거나 신중하게 사용한다.</li><li><strong>매개변수화된 SQL</strong>: SQL 인젝션 방지를 위해 ORM 이나 매개변수화된 쿼리를 사용한다.</li><li><strong>패키지 보안</strong>: 신뢰할 수 있는 소스의 라이브러리만 사용하고 정기적으로 업데이트한다.</li><li><strong>YAML 보안</strong>: 안전하지 않은 YAML 로더 대신 <code>yaml.safe_load()</code> 를 사용한다.</li></ol><h5 id=javascriptnodejs>JavaScript/Node.js<a hidden class=anchor aria-hidden=true href=#javascriptnodejs>#</a></h5><p>웹 환경에서 JavaScript 는 고유한 보안 문제를 가지고 있다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-28-1><a class=lnlinks href=#hl-28-1>1</a>
</span><span class=lnt id=hl-28-2><a class=lnlinks href=#hl-28-2>2</a>
</span><span class=lnt id=hl-28-3><a class=lnlinks href=#hl-28-3>3</a>
</span><span class=lnt id=hl-28-4><a class=lnlinks href=#hl-28-4>4</a>
</span><span class=lnt id=hl-28-5><a class=lnlinks href=#hl-28-5>5</a>
</span><span class=lnt id=hl-28-6><a class=lnlinks href=#hl-28-6>6</a>
</span><span class=lnt id=hl-28-7><a class=lnlinks href=#hl-28-7>7</a>
</span><span class=lnt id=hl-28-8><a class=lnlinks href=#hl-28-8>8</a>
</span><span class=lnt id=hl-28-9><a class=lnlinks href=#hl-28-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>userInput</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>input</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>html</span> <span class=o>=</span> <span class=s1>&#39;&lt;div&gt;&#39;</span> <span class=o>+</span> <span class=nx>userInput</span> <span class=o>+</span> <span class=s1>&#39;&lt;/div&gt;&#39;</span><span class=p>;</span>  <span class=c1>// XSS 위험
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 안전한 코드
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>userInput</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>input</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>DOMPurify</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;dompurify&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cleanHtml</span> <span class=o>=</span> <span class=nx>DOMPurify</span><span class=p>.</span><span class=nx>sanitize</span><span class=p>(</span><span class=nx>userInput</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>html</span> <span class=o>=</span> <span class=s1>&#39;&lt;div&gt;&#39;</span> <span class=o>+</span> <span class=nx>cleanHtml</span> <span class=o>+</span> <span class=s1>&#39;&lt;/div&gt;&#39;</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><ol><li><strong>크로스 사이트 스크립팅 (XSS) 방지</strong>: 사용자 입력을 출력할 때 항상 이스케이프 처리한다.</li><li><strong>CSRF 방지</strong>: 상태 변경 요청에 고유한 토큰을 사용한다.</li><li><strong>안전한 의존성 관리</strong>: 정기적으로 npm 패키지를 감사하고 업데이트한다.</li><li><strong>컨텐츠 보안 정책 (CSP)</strong>: 스크립트 실행을 제한하는 CSP 헤더를 구현한다.</li></ol><h4 id=보안-코딩의-언어별-도구-및-프레임워크>보안 코딩의 언어별 도구 및 프레임워크<a hidden class=anchor aria-hidden=true href=#보안-코딩의-언어별-도구-및-프레임워크>#</a></h4><h5 id=java-보안-도구>Java 보안 도구<a hidden class=anchor aria-hidden=true href=#java-보안-도구>#</a></h5><ol><li><p><strong>Spring Security</strong>: 인증, 권한 부여, 보안 취약점 방지를 위한 강력한 프레임워크</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-29-1><a class=lnlinks href=#hl-29-1> 1</a>
</span><span class=lnt id=hl-29-2><a class=lnlinks href=#hl-29-2> 2</a>
</span><span class=lnt id=hl-29-3><a class=lnlinks href=#hl-29-3> 3</a>
</span><span class=lnt id=hl-29-4><a class=lnlinks href=#hl-29-4> 4</a>
</span><span class=lnt id=hl-29-5><a class=lnlinks href=#hl-29-5> 5</a>
</span><span class=lnt id=hl-29-6><a class=lnlinks href=#hl-29-6> 6</a>
</span><span class=lnt id=hl-29-7><a class=lnlinks href=#hl-29-7> 7</a>
</span><span class=lnt id=hl-29-8><a class=lnlinks href=#hl-29-8> 8</a>
</span><span class=lnt id=hl-29-9><a class=lnlinks href=#hl-29-9> 9</a>
</span><span class=lnt id=hl-29-10><a class=lnlinks href=#hl-29-10>10</a>
</span><span class=lnt id=hl-29-11><a class=lnlinks href=#hl-29-11>11</a>
</span><span class=lnt id=hl-29-12><a class=lnlinks href=#hl-29-12>12</a>
</span><span class=lnt id=hl-29-13><a class=lnlinks href=#hl-29-13>13</a>
</span><span class=lnt id=hl-29-14><a class=lnlinks href=#hl-29-14>14</a>
</span><span class=lnt id=hl-29-15><a class=lnlinks href=#hl-29-15>15</a>
</span><span class=lnt id=hl-29-16><a class=lnlinks href=#hl-29-16>16</a>
</span><span class=lnt id=hl-29-17><a class=lnlinks href=#hl-29-17>17</a>
</span><span class=lnt id=hl-29-18><a class=lnlinks href=#hl-29-18>18</a>
</span><span class=lnt id=hl-29-19><a class=lnlinks href=#hl-29-19>19</a>
</span><span class=lnt id=hl-29-20><a class=lnlinks href=#hl-29-20>20</a>
</span><span class=lnt id=hl-29-21><a class=lnlinks href=#hl-29-21>21</a>
</span><span class=lnt id=hl-29-22><a class=lnlinks href=#hl-29-22>22</a>
</span><span class=lnt id=hl-29-23><a class=lnlinks href=#hl-29-23>23</a>
</span><span class=lnt id=hl-29-24><a class=lnlinks href=#hl-29-24>24</a>
</span><span class=lnt id=hl-29-25><a class=lnlinks href=#hl-29-25>25</a>
</span><span class=lnt id=hl-29-26><a class=lnlinks href=#hl-29-26>26</a>
</span><span class=lnt id=hl-29-27><a class=lnlinks href=#hl-29-27>27</a>
</span><span class=lnt id=hl-29-28><a class=lnlinks href=#hl-29-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Spring Security 기본 구성 예제</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableWebSecurity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>SecurityConfig</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>WebSecurityConfigurerAdapter</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>configure</span><span class=p>(</span><span class=n>HttpSecurity</span><span class=w> </span><span class=n>http</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>http</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>authorizeRequests</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>antMatchers</span><span class=p>(</span><span class=s>&#34;/&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;/home&#34;</span><span class=p>).</span><span class=na>permitAll</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>antMatchers</span><span class=p>(</span><span class=s>&#34;/admin/**&#34;</span><span class=p>).</span><span class=na>hasRole</span><span class=p>(</span><span class=s>&#34;ADMIN&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>anyRequest</span><span class=p>().</span><span class=na>authenticated</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>and</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>formLogin</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>loginPage</span><span class=p>(</span><span class=s>&#34;/login&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>permitAll</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>and</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>logout</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>permitAll</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>and</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>csrf</span><span class=p>()</span><span class=w>  </span><span class=c1>// CSRF 보호 활성화</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>and</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>headers</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>contentSecurityPolicy</span><span class=p>(</span><span class=s>&#34;default-src &#39;self&#39;&#34;</span><span class=p>)</span><span class=w>  </span><span class=c1>// CSP 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>and</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>frameOptions</span><span class=p>().</span><span class=na>deny</span><span class=p>();</span><span class=w>  </span><span class=c1>// 클릭재킹 방지</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p><strong>OWASP Dependency-Check</strong>: Maven 및 Gradle 플러그인으로 프로젝트 종속성의 알려진 취약점을 스캔</p></li><li><p><strong>FindBugs/SpotBugs</strong>: 정적 코드 분석 도구로 잠재적 버그와 보안 취약점 탐지</p></li><li><p><strong>SonarQube</strong>: 코드 품질 및 보안 규칙 위반 검사</p></li></ol><h5 id=python-보안-도구>Python 보안 도구<a hidden class=anchor aria-hidden=true href=#python-보안-도구>#</a></h5><ol><li><p><strong>Bandit</strong>: Python 코드에서 일반적인 보안 이슈를 찾는 정적 분석 도구</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-30-1><a class=lnlinks href=#hl-30-1>1</a>
</span><span class=lnt id=hl-30-2><a class=lnlinks href=#hl-30-2>2</a>
</span><span class=lnt id=hl-30-3><a class=lnlinks href=#hl-30-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Bandit 사용 예시</span>
</span></span><span class=line><span class=cl>pip install bandit
</span></span><span class=line><span class=cl>bandit -r path/to/your/code
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Flask-Security</strong>: Flask 애플리케이션에 보안 기능 추가</p></li><li><p><strong>Django Security Middleware</strong>: 기본적으로 XSS, CSRF, 클릭재킹 등에 대한 보호 제공</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-31-1><a class=lnlinks href=#hl-31-1> 1</a>
</span><span class=lnt id=hl-31-2><a class=lnlinks href=#hl-31-2> 2</a>
</span><span class=lnt id=hl-31-3><a class=lnlinks href=#hl-31-3> 3</a>
</span><span class=lnt id=hl-31-4><a class=lnlinks href=#hl-31-4> 4</a>
</span><span class=lnt id=hl-31-5><a class=lnlinks href=#hl-31-5> 5</a>
</span><span class=lnt id=hl-31-6><a class=lnlinks href=#hl-31-6> 6</a>
</span><span class=lnt id=hl-31-7><a class=lnlinks href=#hl-31-7> 7</a>
</span><span class=lnt id=hl-31-8><a class=lnlinks href=#hl-31-8> 8</a>
</span><span class=lnt id=hl-31-9><a class=lnlinks href=#hl-31-9> 9</a>
</span><span class=lnt id=hl-31-10><a class=lnlinks href=#hl-31-10>10</a>
</span><span class=lnt id=hl-31-11><a class=lnlinks href=#hl-31-11>11</a>
</span><span class=lnt id=hl-31-12><a class=lnlinks href=#hl-31-12>12</a>
</span><span class=lnt id=hl-31-13><a class=lnlinks href=#hl-31-13>13</a>
</span><span class=lnt id=hl-31-14><a class=lnlinks href=#hl-31-14>14</a>
</span><span class=lnt id=hl-31-15><a class=lnlinks href=#hl-31-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Django settings.py 보안 설정 예시</span>
</span></span><span class=line><span class=cl><span class=n>MIDDLEWARE</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;django.middleware.security.SecurityMiddleware&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=c1># 기타 미들웨어…</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 보안 설정</span>
</span></span><span class=line><span class=cl><span class=n>SECURE_HSTS_SECONDS</span> <span class=o>=</span> <span class=mi>3600</span>
</span></span><span class=line><span class=cl><span class=n>SECURE_HSTS_INCLUDE_SUBDOMAINS</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=n>SECURE_CONTENT_TYPE_NOSNIFF</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=n>SECURE_BROWSER_XSS_FILTER</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=n>SECURE_SSL_REDIRECT</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=n>SESSION_COOKIE_SECURE</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=n>CSRF_COOKIE_SECURE</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl><span class=n>X_FRAME_OPTIONS</span> <span class=o>=</span> <span class=s1>&#39;DENY&#39;</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>Safety</strong>: 설치된 Python 패키지에서 알려진 보안 취약점 확인</p></li></ol><h5 id=javascriptnodejs-보안-도구>JavaScript/Node.js 보안 도구<a hidden class=anchor aria-hidden=true href=#javascriptnodejs-보안-도구>#</a></h5><ol><li><p><strong>Helmet.js</strong>: HTTP 헤더 설정을 통해 Express.js 애플리케이션의 보안 강화</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-32-1><a class=lnlinks href=#hl-32-1> 1</a>
</span><span class=lnt id=hl-32-2><a class=lnlinks href=#hl-32-2> 2</a>
</span><span class=lnt id=hl-32-3><a class=lnlinks href=#hl-32-3> 3</a>
</span><span class=lnt id=hl-32-4><a class=lnlinks href=#hl-32-4> 4</a>
</span><span class=lnt id=hl-32-5><a class=lnlinks href=#hl-32-5> 5</a>
</span><span class=lnt id=hl-32-6><a class=lnlinks href=#hl-32-6> 6</a>
</span><span class=lnt id=hl-32-7><a class=lnlinks href=#hl-32-7> 7</a>
</span><span class=lnt id=hl-32-8><a class=lnlinks href=#hl-32-8> 8</a>
</span><span class=lnt id=hl-32-9><a class=lnlinks href=#hl-32-9> 9</a>
</span><span class=lnt id=hl-32-10><a class=lnlinks href=#hl-32-10>10</a>
</span><span class=lnt id=hl-32-11><a class=lnlinks href=#hl-32-11>11</a>
</span><span class=lnt id=hl-32-12><a class=lnlinks href=#hl-32-12>12</a>
</span><span class=lnt id=hl-32-13><a class=lnlinks href=#hl-32-13>13</a>
</span><span class=lnt id=hl-32-14><a class=lnlinks href=#hl-32-14>14</a>
</span><span class=lnt id=hl-32-15><a class=lnlinks href=#hl-32-15>15</a>
</span><span class=lnt id=hl-32-16><a class=lnlinks href=#hl-32-16>16</a>
</span><span class=lnt id=hl-32-17><a class=lnlinks href=#hl-32-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Helmet.js 사용 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>helmet</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;helmet&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 기본 보안 헤더 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>helmet</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 특정 보안 정책 추가 구성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=nx>helmet</span><span class=p>.</span><span class=nx>contentSecurityPolicy</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>directives</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>defaultSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>scriptSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>,</span> <span class=s2>&#34;trusted-cdn.com&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>ESLint 와 보안 플러그인</strong>: 보안 관련 코드 품질 문제 감지</p></li><li><p><strong>npm audit</strong>: 프로젝트 종속성의 알려진 취약점 스캔</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-33-1><a class=lnlinks href=#hl-33-1>1</a>
</span><span class=lnt id=hl-33-2><a class=lnlinks href=#hl-33-2>2</a>
</span><span class=lnt id=hl-33-3><a class=lnlinks href=#hl-33-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># npm audit 사용 예시</span>
</span></span><span class=line><span class=cl>npm audit
</span></span><span class=line><span class=cl>npm audit fix  <span class=c1># 가능한 경우 취약점 자동 수정</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>OWASP ZAP</strong>: 웹 애플리케이션 보안 취약점 탐지 및 테스트</p></li></ol><h4 id=일반적인-보안-코딩-실수-및-방지법>일반적인 보안 코딩 실수 및 방지법<a hidden class=anchor aria-hidden=true href=#일반적인-보안-코딩-실수-및-방지법>#</a></h4><h5 id=하드코딩된-비밀-hardcoded-secrets>하드코딩된 비밀 (Hardcoded Secrets)<a hidden class=anchor aria-hidden=true href=#하드코딩된-비밀-hardcoded-secrets>#</a></h5><p><strong>문제</strong>: 소스 코드에 API 키, 비밀번호, 암호화 키 등을 직접 포함시키는 것은 코드가 노출될 경우 심각한 보안 위험을 초래한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-34-1><a class=lnlinks href=#hl-34-1>1</a>
</span><span class=lnt id=hl-34-2><a class=lnlinks href=#hl-34-2>2</a>
</span><span class=lnt id=hl-34-3><a class=lnlinks href=#hl-34-3>3</a>
</span><span class=lnt id=hl-34-4><a class=lnlinks href=#hl-34-4>4</a>
</span><span class=lnt id=hl-34-5><a class=lnlinks href=#hl-34-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드 - 하드코딩된 비밀</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>DatabaseConnection</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>DB_PASSWORD</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SuperSecretP@ssw0rd&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// ...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>해결책</strong>: 환경 변수, 보안 키 저장소, 암호화된 구성 파일 등을 사용하여 민감한 정보를 코드와 분리한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-35-1><a class=lnlinks href=#hl-35-1>1</a>
</span><span class=lnt id=hl-35-2><a class=lnlinks href=#hl-35-2>2</a>
</span><span class=lnt id=hl-35-3><a class=lnlinks href=#hl-35-3>3</a>
</span><span class=lnt id=hl-35-4><a class=lnlinks href=#hl-35-4>4</a>
</span><span class=lnt id=hl-35-5><a class=lnlinks href=#hl-35-5>5</a>
</span><span class=lnt id=hl-35-6><a class=lnlinks href=#hl-35-6>6</a>
</span><span class=lnt id=hl-35-7><a class=lnlinks href=#hl-35-7>7</a>
</span><span class=lnt id=hl-35-8><a class=lnlinks href=#hl-35-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 안전한 코드 - 외부 구성 사용</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>DatabaseConnection</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>getDbPassword</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 환경 변수, 보안 키 저장소 또는 암호화된 구성 파일에서 가져오기</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>System</span><span class=p>.</span><span class=na>getenv</span><span class=p>(</span><span class=s>&#34;DB_PASSWORD&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// ...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=부적절한-오류-처리-improper-error-handling>부적절한 오류 처리 (Improper Error Handling)<a hidden class=anchor aria-hidden=true href=#부적절한-오류-처리-improper-error-handling>#</a></h5><p><strong>문제</strong>: 상세한 오류 메시지가 사용자에게 노출되면 시스템 내부 정보를 유출할 수 있다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-36-1><a class=lnlinks href=#hl-36-1>1</a>
</span><span class=lnt id=hl-36-2><a class=lnlinks href=#hl-36-2>2</a>
</span><span class=lnt id=hl-36-3><a class=lnlinks href=#hl-36-3>3</a>
</span><span class=lnt id=hl-36-4><a class=lnlinks href=#hl-36-4>4</a>
</span><span class=lnt id=hl-36-5><a class=lnlinks href=#hl-36-5>5</a>
</span><span class=lnt id=hl-36-6><a class=lnlinks href=#hl-36-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드 - 상세한 오류 정보 노출
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 데이터베이스 작업
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>Exception</span> <span class=nv>$e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s2>&#34;Error: &#34;</span> <span class=o>.</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getMessage</span><span class=p>()</span> <span class=o>.</span> <span class=s2>&#34; in &#34;</span> <span class=o>.</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getFile</span><span class=p>()</span> <span class=o>.</span> <span class=s2>&#34; on line &#34;</span> <span class=o>.</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getLine</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>해결책</strong>: 사용자에게는 일반적인 오류 메시지를 표시하고, 상세한 오류 정보는 로그에만 기록한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-37-1><a class=lnlinks href=#hl-37-1> 1</a>
</span><span class=lnt id=hl-37-2><a class=lnlinks href=#hl-37-2> 2</a>
</span><span class=lnt id=hl-37-3><a class=lnlinks href=#hl-37-3> 3</a>
</span><span class=lnt id=hl-37-4><a class=lnlinks href=#hl-37-4> 4</a>
</span><span class=lnt id=hl-37-5><a class=lnlinks href=#hl-37-5> 5</a>
</span><span class=lnt id=hl-37-6><a class=lnlinks href=#hl-37-6> 6</a>
</span><span class=lnt id=hl-37-7><a class=lnlinks href=#hl-37-7> 7</a>
</span><span class=lnt id=hl-37-8><a class=lnlinks href=#hl-37-8> 8</a>
</span><span class=lnt id=hl-37-9><a class=lnlinks href=#hl-37-9> 9</a>
</span><span class=lnt id=hl-37-10><a class=lnlinks href=#hl-37-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// 안전한 코드 - 일반적인 오류 메시지 표시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 데이터베이스 작업
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>Exception</span> <span class=nv>$e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 로그에만 상세 정보 기록
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>error_log</span><span class=p>(</span><span class=s2>&#34;Database error: &#34;</span> <span class=o>.</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getMessage</span><span class=p>()</span> <span class=o>.</span> <span class=s2>&#34; in &#34;</span> <span class=o>.</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getFile</span><span class=p>()</span> <span class=o>.</span> <span class=s2>&#34; on line &#34;</span> <span class=o>.</span> <span class=nv>$e</span><span class=o>-&gt;</span><span class=na>getLine</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 사용자에게는 일반적인 메시지 표시
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>echo</span> <span class=s2>&#34;An error occurred processing your request. Please try again later.&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=안전하지-않은-직접-객체-참조-insecure-direct-object-references>안전하지 않은 직접 객체 참조 (Insecure Direct Object References)<a hidden class=anchor aria-hidden=true href=#안전하지-않은-직접-객체-참조-insecure-direct-object-references>#</a></h5><p><strong>문제</strong>: 사용자가 직접 데이터베이스 키나 파일 이름과 같은 내부 객체 참조를 조작할 수 있는 경우 발생.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-38-1><a class=lnlinks href=#hl-38-1>1</a>
</span><span class=lnt id=hl-38-2><a class=lnlinks href=#hl-38-2>2</a>
</span><span class=lnt id=hl-38-3><a class=lnlinks href=#hl-38-3>3</a>
</span><span class=lnt id=hl-38-4><a class=lnlinks href=#hl-38-4>4</a>
</span><span class=lnt id=hl-38-5><a class=lnlinks href=#hl-38-5>5</a>
</span><span class=lnt id=hl-38-6><a class=lnlinks href=#hl-38-6>6</a>
</span><span class=lnt id=hl-38-7><a class=lnlinks href=#hl-38-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드 - 객체 ID 직접 사용
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/documents/:id&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>documentId</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>params</span><span class=p>.</span><span class=nx>id</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 권한 검사 없이 문서 반환
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nb>document</span> <span class=o>=</span> <span class=nx>getDocumentById</span><span class=p>(</span><span class=nx>documentId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>(</span><span class=nb>document</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>해결책</strong>: 사용자 입력을 간접적인 참조로 매핑하고, 접근 제어 검사를 시행.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-39-1><a class=lnlinks href=#hl-39-1> 1</a>
</span><span class=lnt id=hl-39-2><a class=lnlinks href=#hl-39-2> 2</a>
</span><span class=lnt id=hl-39-3><a class=lnlinks href=#hl-39-3> 3</a>
</span><span class=lnt id=hl-39-4><a class=lnlinks href=#hl-39-4> 4</a>
</span><span class=lnt id=hl-39-5><a class=lnlinks href=#hl-39-5> 5</a>
</span><span class=lnt id=hl-39-6><a class=lnlinks href=#hl-39-6> 6</a>
</span><span class=lnt id=hl-39-7><a class=lnlinks href=#hl-39-7> 7</a>
</span><span class=lnt id=hl-39-8><a class=lnlinks href=#hl-39-8> 8</a>
</span><span class=lnt id=hl-39-9><a class=lnlinks href=#hl-39-9> 9</a>
</span><span class=lnt id=hl-39-10><a class=lnlinks href=#hl-39-10>10</a>
</span><span class=lnt id=hl-39-11><a class=lnlinks href=#hl-39-11>11</a>
</span><span class=lnt id=hl-39-12><a class=lnlinks href=#hl-39-12>12</a>
</span><span class=lnt id=hl-39-13><a class=lnlinks href=#hl-39-13>13</a>
</span><span class=lnt id=hl-39-14><a class=lnlinks href=#hl-39-14>14</a>
</span><span class=lnt id=hl-39-15><a class=lnlinks href=#hl-39-15>15</a>
</span><span class=lnt id=hl-39-16><a class=lnlinks href=#hl-39-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 안전한 코드 - 권한 검사 추가
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/documents/:id&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>documentId</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>params</span><span class=p>.</span><span class=nx>id</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 현재 로그인한 사용자 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>currentUser</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 사용자가 해당 문서에 접근할 권한이 있는지 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>hasAccessToDocument</span><span class=p>(</span><span class=nx>currentUser</span><span class=p>,</span> <span class=nx>documentId</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>403</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Access denied&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 권한이 확인된 후 문서 반환
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nb>document</span> <span class=o>=</span> <span class=nx>getDocumentById</span><span class=p>(</span><span class=nx>documentId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>(</span><span class=nb>document</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=안전하지-않은-역직렬화-insecure-deserialization>안전하지 않은 역직렬화 (Insecure Deserialization)<a hidden class=anchor aria-hidden=true href=#안전하지-않은-역직렬화-insecure-deserialization>#</a></h5><p><strong>문제</strong>: 신뢰할 수 없는 소스의 데이터를 검증 없이 역직렬화하면 원격 코드 실행, 서비스 거부 등의 공격에 취약해진다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-40-1><a class=lnlinks href=#hl-40-1>1</a>
</span><span class=lnt id=hl-40-2><a class=lnlinks href=#hl-40-2>2</a>
</span><span class=lnt id=hl-40-3><a class=lnlinks href=#hl-40-3>3</a>
</span><span class=lnt id=hl-40-4><a class=lnlinks href=#hl-40-4>4</a>
</span><span class=lnt id=hl-40-5><a class=lnlinks href=#hl-40-5>5</a>
</span><span class=lnt id=hl-40-6><a class=lnlinks href=#hl-40-6>6</a>
</span><span class=lnt id=hl-40-7><a class=lnlinks href=#hl-40-7>7</a>
</span><span class=lnt id=hl-40-8><a class=lnlinks href=#hl-40-8>8</a>
</span><span class=lnt id=hl-40-9><a class=lnlinks href=#hl-40-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드 - 검증 없는 역직렬화</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=nf>deserializeObject</span><span class=p>(</span><span class=kt>byte</span><span class=o>[]</span><span class=w> </span><span class=n>data</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>(</span><span class=n>ByteArrayInputStream</span><span class=w> </span><span class=n>bais</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ByteArrayInputStream</span><span class=p>(</span><span class=n>data</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>ObjectInputStream</span><span class=w> </span><span class=n>ois</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ObjectInputStream</span><span class=p>(</span><span class=n>bais</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ois</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span><span class=w>  </span><span class=c1>// 위험한 역직렬화</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>null</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>해결책</strong>: 역직렬화 전에 데이터를 검증하고, 안전한 대안 (JSON 등) 을 사용하거나 신뢰할 수 있는 소스의 데이터만 역직렬화한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-41-1><a class=lnlinks href=#hl-41-1> 1</a>
</span><span class=lnt id=hl-41-2><a class=lnlinks href=#hl-41-2> 2</a>
</span><span class=lnt id=hl-41-3><a class=lnlinks href=#hl-41-3> 3</a>
</span><span class=lnt id=hl-41-4><a class=lnlinks href=#hl-41-4> 4</a>
</span><span class=lnt id=hl-41-5><a class=lnlinks href=#hl-41-5> 5</a>
</span><span class=lnt id=hl-41-6><a class=lnlinks href=#hl-41-6> 6</a>
</span><span class=lnt id=hl-41-7><a class=lnlinks href=#hl-41-7> 7</a>
</span><span class=lnt id=hl-41-8><a class=lnlinks href=#hl-41-8> 8</a>
</span><span class=lnt id=hl-41-9><a class=lnlinks href=#hl-41-9> 9</a>
</span><span class=lnt id=hl-41-10><a class=lnlinks href=#hl-41-10>10</a>
</span><span class=lnt id=hl-41-11><a class=lnlinks href=#hl-41-11>11</a>
</span><span class=lnt id=hl-41-12><a class=lnlinks href=#hl-41-12>12</a>
</span><span class=lnt id=hl-41-13><a class=lnlinks href=#hl-41-13>13</a>
</span><span class=lnt id=hl-41-14><a class=lnlinks href=#hl-41-14>14</a>
</span><span class=lnt id=hl-41-15><a class=lnlinks href=#hl-41-15>15</a>
</span><span class=lnt id=hl-41-16><a class=lnlinks href=#hl-41-16>16</a>
</span><span class=lnt id=hl-41-17><a class=lnlinks href=#hl-41-17>17</a>
</span><span class=lnt id=hl-41-18><a class=lnlinks href=#hl-41-18>18</a>
</span><span class=lnt id=hl-41-19><a class=lnlinks href=#hl-41-19>19</a>
</span><span class=lnt id=hl-41-20><a class=lnlinks href=#hl-41-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 안전한 코드 - 타입 필터링과 검증</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=nf>deserializeObject</span><span class=p>(</span><span class=kt>byte</span><span class=o>[]</span><span class=w> </span><span class=n>data</span><span class=p>,</span><span class=w> </span><span class=n>Class</span><span class=o>&lt;?&gt;</span><span class=w> </span><span class=n>expectedType</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>(</span><span class=n>ByteArrayInputStream</span><span class=w> </span><span class=n>bais</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ByteArrayInputStream</span><span class=p>(</span><span class=n>data</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>ObjectInputStreamWithFilter</span><span class=w> </span><span class=n>ois</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ObjectInputStreamWithFilter</span><span class=p>(</span><span class=n>bais</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 허용된 클래스만 역직렬화 허용</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>ois</span><span class=p>.</span><span class=na>setObjectInputFilter</span><span class=p>(</span><span class=n>info</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Class</span><span class=o>&lt;?&gt;</span><span class=w> </span><span class=n>clazz</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>info</span><span class=p>.</span><span class=na>serialClass</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>clazz</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>!</span><span class=n>expectedType</span><span class=p>.</span><span class=na>isAssignableFrom</span><span class=p>(</span><span class=n>clazz</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=n>ObjectInputFilter</span><span class=p>.</span><span class=na>Status</span><span class=p>.</span><span class=na>REJECTED</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>ObjectInputFilter</span><span class=p>.</span><span class=na>Status</span><span class=p>.</span><span class=na>ALLOWED</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ois</span><span class=p>.</span><span class=na>readObject</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 오류 로깅</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=kc>null</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=안전한-웹-통신-구현>안전한 웹 통신 구현<a hidden class=anchor aria-hidden=true href=#안전한-웹-통신-구현>#</a></h4><ol><li><p>HTTPS 구현<br>모든 웹 애플리케이션은 HTTPS 를 사용하여 전송 계층 보안을 보장해야 한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-42-1><a class=lnlinks href=#hl-42-1> 1</a>
</span><span class=lnt id=hl-42-2><a class=lnlinks href=#hl-42-2> 2</a>
</span><span class=lnt id=hl-42-3><a class=lnlinks href=#hl-42-3> 3</a>
</span><span class=lnt id=hl-42-4><a class=lnlinks href=#hl-42-4> 4</a>
</span><span class=lnt id=hl-42-5><a class=lnlinks href=#hl-42-5> 5</a>
</span><span class=lnt id=hl-42-6><a class=lnlinks href=#hl-42-6> 6</a>
</span><span class=lnt id=hl-42-7><a class=lnlinks href=#hl-42-7> 7</a>
</span><span class=lnt id=hl-42-8><a class=lnlinks href=#hl-42-8> 8</a>
</span><span class=lnt id=hl-42-9><a class=lnlinks href=#hl-42-9> 9</a>
</span><span class=lnt id=hl-42-10><a class=lnlinks href=#hl-42-10>10</a>
</span><span class=lnt id=hl-42-11><a class=lnlinks href=#hl-42-11>11</a>
</span><span class=lnt id=hl-42-12><a class=lnlinks href=#hl-42-12>12</a>
</span><span class=lnt id=hl-42-13><a class=lnlinks href=#hl-42-13>13</a>
</span><span class=lnt id=hl-42-14><a class=lnlinks href=#hl-42-14>14</a>
</span><span class=lnt id=hl-42-15><a class=lnlinks href=#hl-42-15>15</a>
</span><span class=lnt id=hl-42-16><a class=lnlinks href=#hl-42-16>16</a>
</span><span class=lnt id=hl-42-17><a class=lnlinks href=#hl-42-17>17</a>
</span><span class=lnt id=hl-42-18><a class=lnlinks href=#hl-42-18>18</a>
</span><span class=lnt id=hl-42-19><a class=lnlinks href=#hl-42-19>19</a>
</span><span class=lnt id=hl-42-20><a class=lnlinks href=#hl-42-20>20</a>
</span><span class=lnt id=hl-42-21><a class=lnlinks href=#hl-42-21>21</a>
</span><span class=lnt id=hl-42-22><a class=lnlinks href=#hl-42-22>22</a>
</span><span class=lnt id=hl-42-23><a class=lnlinks href=#hl-42-23>23</a>
</span><span class=lnt id=hl-42-24><a class=lnlinks href=#hl-42-24>24</a>
</span><span class=lnt id=hl-42-25><a class=lnlinks href=#hl-42-25>25</a>
</span><span class=lnt id=hl-42-26><a class=lnlinks href=#hl-42-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Node.js에서 HTTPS 서버 구현
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>https</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;https&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>fs</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;fs&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// SSL 인증서 로드
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>key</span><span class=o>:</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;path/to/private/key.pem&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>cert</span><span class=o>:</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;path/to/certificate.pem&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>ciphers</span><span class=o>:</span> <span class=s1>&#39;TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256&#39;</span><span class=p>,</span> <span class=c1>// 강력한 암호화 알고리즘 지정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>minVersion</span><span class=o>:</span> <span class=s1>&#39;TLSv1.2&#39;</span> <span class=c1>// 최소 TLS 버전 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// HTTPS 서버 생성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>https</span><span class=p>.</span><span class=nx>createServer</span><span class=p>(</span><span class=nx>options</span><span class=p>,</span> <span class=nx>app</span><span class=p>).</span><span class=nx>listen</span><span class=p>(</span><span class=mi>443</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;HTTPS server running on port 443&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// HTTP에서 HTTPS로 리다이렉션
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>http</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;http&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>http</span><span class=p>.</span><span class=nx>createServer</span><span class=p>((</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>writeHead</span><span class=p>(</span><span class=mi>301</span><span class=p>,</span> <span class=p>{</span> <span class=s1>&#39;Location&#39;</span><span class=o>:</span> <span class=s1>&#39;https://&#39;</span> <span class=o>+</span> <span class=nx>req</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>host</span> <span class=o>+</span> <span class=nx>req</span><span class=p>.</span><span class=nx>url</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}).</span><span class=nx>listen</span><span class=p>(</span><span class=mi>80</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>보안 쿠키 설정<br>쿠키에는 Secure, HttpOnly, SameSite 플래그를 설정하여 보안을 강화해야 한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-43-1><a class=lnlinks href=#hl-43-1> 1</a>
</span><span class=lnt id=hl-43-2><a class=lnlinks href=#hl-43-2> 2</a>
</span><span class=lnt id=hl-43-3><a class=lnlinks href=#hl-43-3> 3</a>
</span><span class=lnt id=hl-43-4><a class=lnlinks href=#hl-43-4> 4</a>
</span><span class=lnt id=hl-43-5><a class=lnlinks href=#hl-43-5> 5</a>
</span><span class=lnt id=hl-43-6><a class=lnlinks href=#hl-43-6> 6</a>
</span><span class=lnt id=hl-43-7><a class=lnlinks href=#hl-43-7> 7</a>
</span><span class=lnt id=hl-43-8><a class=lnlinks href=#hl-43-8> 8</a>
</span><span class=lnt id=hl-43-9><a class=lnlinks href=#hl-43-9> 9</a>
</span><span class=lnt id=hl-43-10><a class=lnlinks href=#hl-43-10>10</a>
</span><span class=lnt id=hl-43-11><a class=lnlinks href=#hl-43-11>11</a>
</span><span class=lnt id=hl-43-12><a class=lnlinks href=#hl-43-12>12</a>
</span><span class=lnt id=hl-43-13><a class=lnlinks href=#hl-43-13>13</a>
</span><span class=lnt id=hl-43-14><a class=lnlinks href=#hl-43-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Express.js에서 보안 쿠키 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>session</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express-session&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>session</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>secret</span><span class=o>:</span> <span class=s1>&#39;your-secret-key&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>resave</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>saveUninitialized</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>cookie</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>secure</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>        <span class=c1>// HTTPS에서만 쿠키 전송
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>httpOnly</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>      <span class=c1>// JavaScript에서 쿠키 접근 방지
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>sameSite</span><span class=o>:</span> <span class=s1>&#39;strict&#39;</span><span class=p>,</span>  <span class=c1>// CSRF 공격 방지
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>maxAge</span><span class=o>:</span> <span class=mi>3600000</span>      <span class=c1>// 쿠키 만료 시간 (1시간)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}));</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>CORS(Cross-Origin Resource Sharing) 올바르게 구성<br>허용된 도메인에서만 리소스 접근을 허용하도록 CORS 를 구성한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-44-1><a class=lnlinks href=#hl-44-1> 1</a>
</span><span class=lnt id=hl-44-2><a class=lnlinks href=#hl-44-2> 2</a>
</span><span class=lnt id=hl-44-3><a class=lnlinks href=#hl-44-3> 3</a>
</span><span class=lnt id=hl-44-4><a class=lnlinks href=#hl-44-4> 4</a>
</span><span class=lnt id=hl-44-5><a class=lnlinks href=#hl-44-5> 5</a>
</span><span class=lnt id=hl-44-6><a class=lnlinks href=#hl-44-6> 6</a>
</span><span class=lnt id=hl-44-7><a class=lnlinks href=#hl-44-7> 7</a>
</span><span class=lnt id=hl-44-8><a class=lnlinks href=#hl-44-8> 8</a>
</span><span class=lnt id=hl-44-9><a class=lnlinks href=#hl-44-9> 9</a>
</span><span class=lnt id=hl-44-10><a class=lnlinks href=#hl-44-10>10</a>
</span><span class=lnt id=hl-44-11><a class=lnlinks href=#hl-44-11>11</a>
</span><span class=lnt id=hl-44-12><a class=lnlinks href=#hl-44-12>12</a>
</span><span class=lnt id=hl-44-13><a class=lnlinks href=#hl-44-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Express.js에서 CORS 구성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>cors</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;cors&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 특정 출처만 허용
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>corsOptions</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>origin</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;https://trusted-site.com&#39;</span><span class=p>,</span> <span class=s1>&#39;https://another-trusted-site.com&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nx>methods</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=s1>&#39;POST&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nx>allowedHeaders</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;Content-Type&#39;</span><span class=p>,</span> <span class=s1>&#39;Authorization&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nx>credentials</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>maxAge</span><span class=o>:</span> <span class=mi>86400</span>  <span class=c1>// 프리플라이트 요청 캐싱 시간
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>cors</span><span class=p>(</span><span class=nx>corsOptions</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>콘텐츠 보안 정책 (CSP) 구현<br>CSP 는 XSS 공격과 같은 코드 인젝션 공격을 방지하는 데 도움이 된다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-45-1><a class=lnlinks href=#hl-45-1> 1</a>
</span><span class=lnt id=hl-45-2><a class=lnlinks href=#hl-45-2> 2</a>
</span><span class=lnt id=hl-45-3><a class=lnlinks href=#hl-45-3> 3</a>
</span><span class=lnt id=hl-45-4><a class=lnlinks href=#hl-45-4> 4</a>
</span><span class=lnt id=hl-45-5><a class=lnlinks href=#hl-45-5> 5</a>
</span><span class=lnt id=hl-45-6><a class=lnlinks href=#hl-45-6> 6</a>
</span><span class=lnt id=hl-45-7><a class=lnlinks href=#hl-45-7> 7</a>
</span><span class=lnt id=hl-45-8><a class=lnlinks href=#hl-45-8> 8</a>
</span><span class=lnt id=hl-45-9><a class=lnlinks href=#hl-45-9> 9</a>
</span><span class=lnt id=hl-45-10><a class=lnlinks href=#hl-45-10>10</a>
</span><span class=lnt id=hl-45-11><a class=lnlinks href=#hl-45-11>11</a>
</span><span class=lnt id=hl-45-12><a class=lnlinks href=#hl-45-12>12</a>
</span><span class=lnt id=hl-45-13><a class=lnlinks href=#hl-45-13>13</a>
</span><span class=lnt id=hl-45-14><a class=lnlinks href=#hl-45-14>14</a>
</span><span class=lnt id=hl-45-15><a class=lnlinks href=#hl-45-15>15</a>
</span><span class=lnt id=hl-45-16><a class=lnlinks href=#hl-45-16>16</a>
</span><span class=lnt id=hl-45-17><a class=lnlinks href=#hl-45-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Express.js에서 CSP 헤더 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>helmet</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;helmet&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>helmet</span><span class=p>.</span><span class=nx>contentSecurityPolicy</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>directives</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>defaultSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>],</span>  <span class=c1>// 기본적으로 같은 출처의 리소스만 허용
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>scriptSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>,</span> <span class=s1>&#39;trusted-scripts.com&#39;</span><span class=p>],</span>  <span class=c1>// 스크립트 허용 출처
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>styleSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>,</span> <span class=s1>&#39;trusted-styles.com&#39;</span><span class=p>,</span> <span class=s2>&#34;&#39;unsafe-inline&#39;&#34;</span><span class=p>],</span>  <span class=c1>// 스타일 허용 출처
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>imgSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>,</span> <span class=s1>&#39;data:&#39;</span><span class=p>,</span> <span class=s1>&#39;trusted-images.com&#39;</span><span class=p>],</span>  <span class=c1>// 이미지 허용 출처
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>connectSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>,</span> <span class=s1>&#39;api.trusted-site.com&#39;</span><span class=p>],</span>  <span class=c1>// AJAX, WebSocket 허용 출처
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>fontSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>,</span> <span class=s1>&#39;fonts.googleapis.com&#39;</span><span class=p>],</span>  <span class=c1>// 폰트 허용 출처
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>objectSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;none&#39;&#34;</span><span class=p>],</span>  <span class=c1>// &lt;object&gt;, &lt;embed&gt;, &lt;applet&gt; 태그 차단
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>mediaSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;self&#39;&#34;</span><span class=p>],</span>  <span class=c1>// 오디오/비디오 허용 출처
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>frameSrc</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;&#39;none&#39;&#34;</span><span class=p>],</span>  <span class=c1>// &lt;frame&gt;, &lt;iframe&gt; 차단
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>reportUri</span><span class=o>:</span> <span class=s1>&#39;/csp-violation-report&#39;</span>  <span class=c1>// 위반 보고 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}));</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h4 id=클라우드-환경에서의-보안-코딩>클라우드 환경에서의 보안 코딩<a hidden class=anchor aria-hidden=true href=#클라우드-환경에서의-보안-코딩>#</a></h4><p>클라우드 환경은 추가적인 보안 고려사항이 필요하다:</p><ol><li><p>안전한 클라우드 구성</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-46-1><a class=lnlinks href=#hl-46-1> 1</a>
</span><span class=lnt id=hl-46-2><a class=lnlinks href=#hl-46-2> 2</a>
</span><span class=lnt id=hl-46-3><a class=lnlinks href=#hl-46-3> 3</a>
</span><span class=lnt id=hl-46-4><a class=lnlinks href=#hl-46-4> 4</a>
</span><span class=lnt id=hl-46-5><a class=lnlinks href=#hl-46-5> 5</a>
</span><span class=lnt id=hl-46-6><a class=lnlinks href=#hl-46-6> 6</a>
</span><span class=lnt id=hl-46-7><a class=lnlinks href=#hl-46-7> 7</a>
</span><span class=lnt id=hl-46-8><a class=lnlinks href=#hl-46-8> 8</a>
</span><span class=lnt id=hl-46-9><a class=lnlinks href=#hl-46-9> 9</a>
</span><span class=lnt id=hl-46-10><a class=lnlinks href=#hl-46-10>10</a>
</span><span class=lnt id=hl-46-11><a class=lnlinks href=#hl-46-11>11</a>
</span><span class=lnt id=hl-46-12><a class=lnlinks href=#hl-46-12>12</a>
</span><span class=lnt id=hl-46-13><a class=lnlinks href=#hl-46-13>13</a>
</span><span class=lnt id=hl-46-14><a class=lnlinks href=#hl-46-14>14</a>
</span><span class=lnt id=hl-46-15><a class=lnlinks href=#hl-46-15>15</a>
</span><span class=lnt id=hl-46-16><a class=lnlinks href=#hl-46-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># AWS CloudFormation 보안 구성 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>Resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>S3Bucket</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Type</span><span class=p>:</span><span class=w> </span><span class=l>AWS::S3::Bucket</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Properties</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>BucketName</span><span class=p>:</span><span class=w> </span><span class=l>my-secure-bucket</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>AccessControl</span><span class=p>:</span><span class=w> </span><span class=l>Private</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PublicAccessBlockConfiguration</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>BlockPublicAcls</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>BlockPublicPolicy</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>IgnorePublicAcls</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>RestrictPublicBuckets</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>BucketEncryption</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ServerSideEncryptionConfiguration</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=nt>ServerSideEncryptionByDefault</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>SSEAlgorithm</span><span class=p>:</span><span class=w> </span><span class=l>AES256</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>권한 관리 (IAM)<br>최소 권한 원칙을 적용하여 필요한 권한만 부여:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-47-1><a class=lnlinks href=#hl-47-1> 1</a>
</span><span class=lnt id=hl-47-2><a class=lnlinks href=#hl-47-2> 2</a>
</span><span class=lnt id=hl-47-3><a class=lnlinks href=#hl-47-3> 3</a>
</span><span class=lnt id=hl-47-4><a class=lnlinks href=#hl-47-4> 4</a>
</span><span class=lnt id=hl-47-5><a class=lnlinks href=#hl-47-5> 5</a>
</span><span class=lnt id=hl-47-6><a class=lnlinks href=#hl-47-6> 6</a>
</span><span class=lnt id=hl-47-7><a class=lnlinks href=#hl-47-7> 7</a>
</span><span class=lnt id=hl-47-8><a class=lnlinks href=#hl-47-8> 8</a>
</span><span class=lnt id=hl-47-9><a class=lnlinks href=#hl-47-9> 9</a>
</span><span class=lnt id=hl-47-10><a class=lnlinks href=#hl-47-10>10</a>
</span><span class=lnt id=hl-47-11><a class=lnlinks href=#hl-47-11>11</a>
</span><span class=lnt id=hl-47-12><a class=lnlinks href=#hl-47-12>12</a>
</span><span class=lnt id=hl-47-13><a class=lnlinks href=#hl-47-13>13</a>
</span><span class=lnt id=hl-47-14><a class=lnlinks href=#hl-47-14>14</a>
</span><span class=lnt id=hl-47-15><a class=lnlinks href=#hl-47-15>15</a>
</span><span class=lnt id=hl-47-16><a class=lnlinks href=#hl-47-16>16</a>
</span><span class=lnt id=hl-47-17><a class=lnlinks href=#hl-47-17>17</a>
</span><span class=lnt id=hl-47-18><a class=lnlinks href=#hl-47-18>18</a>
</span><span class=lnt id=hl-47-19><a class=lnlinks href=#hl-47-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=c1>// AWS IAM 정책 예시 - 최소 권한
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;Version&#34;</span><span class=p>:</span> <span class=s2>&#34;2012-10-17&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;Statement&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Effect&#34;</span><span class=p>:</span> <span class=s2>&#34;Allow&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Action&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;s3:GetObject&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;s3:PutObject&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>],</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Resource&#34;</span><span class=p>:</span> <span class=s2>&#34;arn:aws:s3:::my-bucket/my-app/*&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Condition&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;StringEquals&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;aws:SourceVpc&#34;</span><span class=p>:</span> <span class=s2>&#34;vpc-12345678&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>보안 네트워킹<br>클라우드 네트워크를 안전하게 구성:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-48-1><a class=lnlinks href=#hl-48-1> 1</a>
</span><span class=lnt id=hl-48-2><a class=lnlinks href=#hl-48-2> 2</a>
</span><span class=lnt id=hl-48-3><a class=lnlinks href=#hl-48-3> 3</a>
</span><span class=lnt id=hl-48-4><a class=lnlinks href=#hl-48-4> 4</a>
</span><span class=lnt id=hl-48-5><a class=lnlinks href=#hl-48-5> 5</a>
</span><span class=lnt id=hl-48-6><a class=lnlinks href=#hl-48-6> 6</a>
</span><span class=lnt id=hl-48-7><a class=lnlinks href=#hl-48-7> 7</a>
</span><span class=lnt id=hl-48-8><a class=lnlinks href=#hl-48-8> 8</a>
</span><span class=lnt id=hl-48-9><a class=lnlinks href=#hl-48-9> 9</a>
</span><span class=lnt id=hl-48-10><a class=lnlinks href=#hl-48-10>10</a>
</span><span class=lnt id=hl-48-11><a class=lnlinks href=#hl-48-11>11</a>
</span><span class=lnt id=hl-48-12><a class=lnlinks href=#hl-48-12>12</a>
</span><span class=lnt id=hl-48-13><a class=lnlinks href=#hl-48-13>13</a>
</span><span class=lnt id=hl-48-14><a class=lnlinks href=#hl-48-14>14</a>
</span><span class=lnt id=hl-48-15><a class=lnlinks href=#hl-48-15>15</a>
</span><span class=lnt id=hl-48-16><a class=lnlinks href=#hl-48-16>16</a>
</span><span class=lnt id=hl-48-17><a class=lnlinks href=#hl-48-17>17</a>
</span><span class=lnt id=hl-48-18><a class=lnlinks href=#hl-48-18>18</a>
</span><span class=lnt id=hl-48-19><a class=lnlinks href=#hl-48-19>19</a>
</span><span class=lnt id=hl-48-20><a class=lnlinks href=#hl-48-20>20</a>
</span><span class=lnt id=hl-48-21><a class=lnlinks href=#hl-48-21>21</a>
</span><span class=lnt id=hl-48-22><a class=lnlinks href=#hl-48-22>22</a>
</span><span class=lnt id=hl-48-23><a class=lnlinks href=#hl-48-23>23</a>
</span><span class=lnt id=hl-48-24><a class=lnlinks href=#hl-48-24>24</a>
</span><span class=lnt id=hl-48-25><a class=lnlinks href=#hl-48-25>25</a>
</span><span class=lnt id=hl-48-26><a class=lnlinks href=#hl-48-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># AWS CloudFormation을 사용한 보안 VPC 구성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>Resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>MyVPC</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Type</span><span class=p>:</span><span class=w> </span><span class=l>AWS::EC2::VPC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Properties</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>CidrBlock</span><span class=p>:</span><span class=w> </span><span class=m>10.0.0.0</span><span class=l>/16</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>EnableDnsSupport</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>EnableDnsHostnames</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>PrivateSubnet</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Type</span><span class=p>:</span><span class=w> </span><span class=l>AWS::EC2::Subnet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Properties</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>VpcId</span><span class=p>:</span><span class=w> </span>!<span class=l>Ref MyVPC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>CidrBlock</span><span class=p>:</span><span class=w> </span><span class=m>10.0.1.0</span><span class=l>/24</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>MapPublicIpOnLaunch</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>SecurityGroup</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Type</span><span class=p>:</span><span class=w> </span><span class=l>AWS::EC2::SecurityGroup</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>Properties</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>GroupDescription</span><span class=p>:</span><span class=w> </span><span class=l>Restricted Security Group</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>VpcId</span><span class=p>:</span><span class=w> </span>!<span class=l>Ref MyVPC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>SecurityGroupIngress</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>IpProtocol</span><span class=p>:</span><span class=w> </span><span class=l>tcp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>FromPort</span><span class=p>:</span><span class=w> </span><span class=m>443</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ToPort</span><span class=p>:</span><span class=w> </span><span class=m>443</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>CidrIp</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=l>/0</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>비밀 관리<br>AWS Secrets Manager, Azure Key Vault, Google Secret Manager 와 같은 클라우드 비밀 관리 서비스를 사용:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-49-1><a class=lnlinks href=#hl-49-1> 1</a>
</span><span class=lnt id=hl-49-2><a class=lnlinks href=#hl-49-2> 2</a>
</span><span class=lnt id=hl-49-3><a class=lnlinks href=#hl-49-3> 3</a>
</span><span class=lnt id=hl-49-4><a class=lnlinks href=#hl-49-4> 4</a>
</span><span class=lnt id=hl-49-5><a class=lnlinks href=#hl-49-5> 5</a>
</span><span class=lnt id=hl-49-6><a class=lnlinks href=#hl-49-6> 6</a>
</span><span class=lnt id=hl-49-7><a class=lnlinks href=#hl-49-7> 7</a>
</span><span class=lnt id=hl-49-8><a class=lnlinks href=#hl-49-8> 8</a>
</span><span class=lnt id=hl-49-9><a class=lnlinks href=#hl-49-9> 9</a>
</span><span class=lnt id=hl-49-10><a class=lnlinks href=#hl-49-10>10</a>
</span><span class=lnt id=hl-49-11><a class=lnlinks href=#hl-49-11>11</a>
</span><span class=lnt id=hl-49-12><a class=lnlinks href=#hl-49-12>12</a>
</span><span class=lnt id=hl-49-13><a class=lnlinks href=#hl-49-13>13</a>
</span><span class=lnt id=hl-49-14><a class=lnlinks href=#hl-49-14>14</a>
</span><span class=lnt id=hl-49-15><a class=lnlinks href=#hl-49-15>15</a>
</span><span class=lnt id=hl-49-16><a class=lnlinks href=#hl-49-16>16</a>
</span><span class=lnt id=hl-49-17><a class=lnlinks href=#hl-49-17>17</a>
</span><span class=lnt id=hl-49-18><a class=lnlinks href=#hl-49-18>18</a>
</span><span class=lnt id=hl-49-19><a class=lnlinks href=#hl-49-19>19</a>
</span><span class=lnt id=hl-49-20><a class=lnlinks href=#hl-49-20>20</a>
</span><span class=lnt id=hl-49-21><a class=lnlinks href=#hl-49-21>21</a>
</span><span class=lnt id=hl-49-22><a class=lnlinks href=#hl-49-22>22</a>
</span><span class=lnt id=hl-49-23><a class=lnlinks href=#hl-49-23>23</a>
</span><span class=lnt id=hl-49-24><a class=lnlinks href=#hl-49-24>24</a>
</span><span class=lnt id=hl-49-25><a class=lnlinks href=#hl-49-25>25</a>
</span><span class=lnt id=hl-49-26><a class=lnlinks href=#hl-49-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># AWS Secrets Manager 사용 예시</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>boto3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_secret</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>secret_name</span> <span class=o>=</span> <span class=s2>&#34;my-app/database-credentials&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>region_name</span> <span class=o>=</span> <span class=s2>&#34;us-west-2&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>session</span> <span class=o>=</span> <span class=n>boto3</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>client</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>client</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>service_name</span><span class=o>=</span><span class=s1>&#39;secretsmanager&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>region_name</span><span class=o>=</span><span class=n>region_name</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>get_secret_value_response</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>get_secret_value</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>SecretId</span><span class=o>=</span><span class=n>secret_name</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 복호화된 비밀 정보 반환</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s1>&#39;SecretString&#39;</span> <span class=ow>in</span> <span class=n>get_secret_value_response</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>secret</span> <span class=o>=</span> <span class=n>get_secret_value_response</span><span class=p>[</span><span class=s1>&#39;SecretString&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>secret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 오류 처리</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>e</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h4 id=마이크로서비스-및-api-보안>마이크로서비스 및 API 보안<a hidden class=anchor aria-hidden=true href=#마이크로서비스-및-api-보안>#</a></h4><p>마이크로서비스 아키텍처에서의 보안 고려사항:</p><ol><li><p>API 게이트웨이 보안</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-50-1><a class=lnlinks href=#hl-50-1> 1</a>
</span><span class=lnt id=hl-50-2><a class=lnlinks href=#hl-50-2> 2</a>
</span><span class=lnt id=hl-50-3><a class=lnlinks href=#hl-50-3> 3</a>
</span><span class=lnt id=hl-50-4><a class=lnlinks href=#hl-50-4> 4</a>
</span><span class=lnt id=hl-50-5><a class=lnlinks href=#hl-50-5> 5</a>
</span><span class=lnt id=hl-50-6><a class=lnlinks href=#hl-50-6> 6</a>
</span><span class=lnt id=hl-50-7><a class=lnlinks href=#hl-50-7> 7</a>
</span><span class=lnt id=hl-50-8><a class=lnlinks href=#hl-50-8> 8</a>
</span><span class=lnt id=hl-50-9><a class=lnlinks href=#hl-50-9> 9</a>
</span><span class=lnt id=hl-50-10><a class=lnlinks href=#hl-50-10>10</a>
</span><span class=lnt id=hl-50-11><a class=lnlinks href=#hl-50-11>11</a>
</span><span class=lnt id=hl-50-12><a class=lnlinks href=#hl-50-12>12</a>
</span><span class=lnt id=hl-50-13><a class=lnlinks href=#hl-50-13>13</a>
</span><span class=lnt id=hl-50-14><a class=lnlinks href=#hl-50-14>14</a>
</span><span class=lnt id=hl-50-15><a class=lnlinks href=#hl-50-15>15</a>
</span><span class=lnt id=hl-50-16><a class=lnlinks href=#hl-50-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Express.js에서 API 게이트웨이 보안 미들웨어
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>rateLimit</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express-rate-limit&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>helmet</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;helmet&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 속도 제한 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>apiLimiter</span> <span class=o>=</span> <span class=nx>rateLimit</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>windowMs</span><span class=o>:</span> <span class=mi>15</span> <span class=o>*</span> <span class=mi>60</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>,</span>  <span class=c1>// 15분
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>max</span><span class=o>:</span> <span class=mi>100</span><span class=p>,</span>  <span class=c1>// 15분당 최대 100개 요청
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>standardHeaders</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>  <span class=c1>// RateLimit 헤더 반환
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>legacyHeaders</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>  <span class=c1>// X-RateLimit 헤더 비활성화
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;Too many requests from this IP, please try again after 15 minutes&#39;</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// API 경로에 보안 미들웨어 적용
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=s1>&#39;/api/&#39;</span><span class=p>,</span> <span class=nx>apiLimiter</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>helmet</span><span class=p>());</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>서비스 간 인증<br>마이크로서비스 간 통신 보안을 위해 JWT 또는 mTLS 사용:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-51-1><a class=lnlinks href=#hl-51-1> 1</a>
</span><span class=lnt id=hl-51-2><a class=lnlinks href=#hl-51-2> 2</a>
</span><span class=lnt id=hl-51-3><a class=lnlinks href=#hl-51-3> 3</a>
</span><span class=lnt id=hl-51-4><a class=lnlinks href=#hl-51-4> 4</a>
</span><span class=lnt id=hl-51-5><a class=lnlinks href=#hl-51-5> 5</a>
</span><span class=lnt id=hl-51-6><a class=lnlinks href=#hl-51-6> 6</a>
</span><span class=lnt id=hl-51-7><a class=lnlinks href=#hl-51-7> 7</a>
</span><span class=lnt id=hl-51-8><a class=lnlinks href=#hl-51-8> 8</a>
</span><span class=lnt id=hl-51-9><a class=lnlinks href=#hl-51-9> 9</a>
</span><span class=lnt id=hl-51-10><a class=lnlinks href=#hl-51-10>10</a>
</span><span class=lnt id=hl-51-11><a class=lnlinks href=#hl-51-11>11</a>
</span><span class=lnt id=hl-51-12><a class=lnlinks href=#hl-51-12>12</a>
</span><span class=lnt id=hl-51-13><a class=lnlinks href=#hl-51-13>13</a>
</span><span class=lnt id=hl-51-14><a class=lnlinks href=#hl-51-14>14</a>
</span><span class=lnt id=hl-51-15><a class=lnlinks href=#hl-51-15>15</a>
</span><span class=lnt id=hl-51-16><a class=lnlinks href=#hl-51-16>16</a>
</span><span class=lnt id=hl-51-17><a class=lnlinks href=#hl-51-17>17</a>
</span><span class=lnt id=hl-51-18><a class=lnlinks href=#hl-51-18>18</a>
</span><span class=lnt id=hl-51-19><a class=lnlinks href=#hl-51-19>19</a>
</span><span class=lnt id=hl-51-20><a class=lnlinks href=#hl-51-20>20</a>
</span><span class=lnt id=hl-51-21><a class=lnlinks href=#hl-51-21>21</a>
</span><span class=lnt id=hl-51-22><a class=lnlinks href=#hl-51-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Spring Boot에서 JWT 인증 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableWebSecurity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>SecurityConfig</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>WebSecurityConfigurerAdapter</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>JwtTokenProvider</span><span class=w> </span><span class=n>jwtTokenProvider</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>configure</span><span class=p>(</span><span class=n>HttpSecurity</span><span class=w> </span><span class=n>http</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>http</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>csrf</span><span class=p>().</span><span class=na>disable</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>sessionManagement</span><span class=p>().</span><span class=na>sessionCreationPolicy</span><span class=p>(</span><span class=n>SessionCreationPolicy</span><span class=p>.</span><span class=na>STATELESS</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>and</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>authorizeRequests</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>antMatchers</span><span class=p>(</span><span class=s>&#34;/public/**&#34;</span><span class=p>).</span><span class=na>permitAll</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>antMatchers</span><span class=p>(</span><span class=s>&#34;/api/v1/**&#34;</span><span class=p>).</span><span class=na>hasRole</span><span class=p>(</span><span class=s>&#34;SERVICE&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>anyRequest</span><span class=p>().</span><span class=na>authenticated</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>.</span><span class=na>and</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>apply</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>JwtConfigurer</span><span class=p>(</span><span class=n>jwtTokenProvider</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>mTLS(상호 TLS) 구현<br>서비스 간 통신에 mTLS 를 사용하여 양방향 인증 보장:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-52-1><a class=lnlinks href=#hl-52-1> 1</a>
</span><span class=lnt id=hl-52-2><a class=lnlinks href=#hl-52-2> 2</a>
</span><span class=lnt id=hl-52-3><a class=lnlinks href=#hl-52-3> 3</a>
</span><span class=lnt id=hl-52-4><a class=lnlinks href=#hl-52-4> 4</a>
</span><span class=lnt id=hl-52-5><a class=lnlinks href=#hl-52-5> 5</a>
</span><span class=lnt id=hl-52-6><a class=lnlinks href=#hl-52-6> 6</a>
</span><span class=lnt id=hl-52-7><a class=lnlinks href=#hl-52-7> 7</a>
</span><span class=lnt id=hl-52-8><a class=lnlinks href=#hl-52-8> 8</a>
</span><span class=lnt id=hl-52-9><a class=lnlinks href=#hl-52-9> 9</a>
</span><span class=lnt id=hl-52-10><a class=lnlinks href=#hl-52-10>10</a>
</span><span class=lnt id=hl-52-11><a class=lnlinks href=#hl-52-11>11</a>
</span><span class=lnt id=hl-52-12><a class=lnlinks href=#hl-52-12>12</a>
</span><span class=lnt id=hl-52-13><a class=lnlinks href=#hl-52-13>13</a>
</span><span class=lnt id=hl-52-14><a class=lnlinks href=#hl-52-14>14</a>
</span><span class=lnt id=hl-52-15><a class=lnlinks href=#hl-52-15>15</a>
</span><span class=lnt id=hl-52-16><a class=lnlinks href=#hl-52-16>16</a>
</span><span class=lnt id=hl-52-17><a class=lnlinks href=#hl-52-17>17</a>
</span><span class=lnt id=hl-52-18><a class=lnlinks href=#hl-52-18>18</a>
</span><span class=lnt id=hl-52-19><a class=lnlinks href=#hl-52-19>19</a>
</span><span class=lnt id=hl-52-20><a class=lnlinks href=#hl-52-20>20</a>
</span><span class=lnt id=hl-52-21><a class=lnlinks href=#hl-52-21>21</a>
</span><span class=lnt id=hl-52-22><a class=lnlinks href=#hl-52-22>22</a>
</span><span class=lnt id=hl-52-23><a class=lnlinks href=#hl-52-23>23</a>
</span><span class=lnt id=hl-52-24><a class=lnlinks href=#hl-52-24>24</a>
</span><span class=lnt id=hl-52-25><a class=lnlinks href=#hl-52-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Spring Boot에서 mTLS 구성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>MtlsConfig</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>ServletWebServerFactory</span><span class=w> </span><span class=nf>servletContainer</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>TomcatServletWebServerFactory</span><span class=w> </span><span class=n>tomcat</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>TomcatServletWebServerFactory</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>tomcat</span><span class=p>.</span><span class=na>addConnectorCustomizers</span><span class=p>(</span><span class=n>connector</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>connector</span><span class=p>.</span><span class=na>setScheme</span><span class=p>(</span><span class=s>&#34;https&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>connector</span><span class=p>.</span><span class=na>setSecure</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Http11NioProtocol</span><span class=w> </span><span class=n>protocol</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>Http11NioProtocol</span><span class=p>)</span><span class=w> </span><span class=n>connector</span><span class=p>.</span><span class=na>getProtocolHandler</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>protocol</span><span class=p>.</span><span class=na>setSSLEnabled</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>protocol</span><span class=p>.</span><span class=na>setClientAuth</span><span class=p>(</span><span class=s>&#34;true&#34;</span><span class=p>);</span><span class=w> </span><span class=c1>// 클라이언트 인증 요구</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 키스토어 및 트러스트스토어 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>protocol</span><span class=p>.</span><span class=na>setKeystoreFile</span><span class=p>(</span><span class=s>&#34;/path/to/keystore.jks&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>protocol</span><span class=p>.</span><span class=na>setKeystorePass</span><span class=p>(</span><span class=s>&#34;keystorePassword&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>protocol</span><span class=p>.</span><span class=na>setTruststoreFile</span><span class=p>(</span><span class=s>&#34;/path/to/truststore.jks&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>protocol</span><span class=p>.</span><span class=na>setTruststorePass</span><span class=p>(</span><span class=s>&#34;truststorePassword&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>protocol</span><span class=p>.</span><span class=na>setKeyAlias</span><span class=p>(</span><span class=s>&#34;tomcat&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>tomcat</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>API 권한 관리<br>세분화된 API 접근 제어를 구현:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-53-1><a class=lnlinks href=#hl-53-1> 1</a>
</span><span class=lnt id=hl-53-2><a class=lnlinks href=#hl-53-2> 2</a>
</span><span class=lnt id=hl-53-3><a class=lnlinks href=#hl-53-3> 3</a>
</span><span class=lnt id=hl-53-4><a class=lnlinks href=#hl-53-4> 4</a>
</span><span class=lnt id=hl-53-5><a class=lnlinks href=#hl-53-5> 5</a>
</span><span class=lnt id=hl-53-6><a class=lnlinks href=#hl-53-6> 6</a>
</span><span class=lnt id=hl-53-7><a class=lnlinks href=#hl-53-7> 7</a>
</span><span class=lnt id=hl-53-8><a class=lnlinks href=#hl-53-8> 8</a>
</span><span class=lnt id=hl-53-9><a class=lnlinks href=#hl-53-9> 9</a>
</span><span class=lnt id=hl-53-10><a class=lnlinks href=#hl-53-10>10</a>
</span><span class=lnt id=hl-53-11><a class=lnlinks href=#hl-53-11>11</a>
</span><span class=lnt id=hl-53-12><a class=lnlinks href=#hl-53-12>12</a>
</span><span class=lnt id=hl-53-13><a class=lnlinks href=#hl-53-13>13</a>
</span><span class=lnt id=hl-53-14><a class=lnlinks href=#hl-53-14>14</a>
</span><span class=lnt id=hl-53-15><a class=lnlinks href=#hl-53-15>15</a>
</span><span class=lnt id=hl-53-16><a class=lnlinks href=#hl-53-16>16</a>
</span><span class=lnt id=hl-53-17><a class=lnlinks href=#hl-53-17>17</a>
</span><span class=lnt id=hl-53-18><a class=lnlinks href=#hl-53-18>18</a>
</span><span class=lnt id=hl-53-19><a class=lnlinks href=#hl-53-19>19</a>
</span><span class=lnt id=hl-53-20><a class=lnlinks href=#hl-53-20>20</a>
</span><span class=lnt id=hl-53-21><a class=lnlinks href=#hl-53-21>21</a>
</span><span class=lnt id=hl-53-22><a class=lnlinks href=#hl-53-22>22</a>
</span><span class=lnt id=hl-53-23><a class=lnlinks href=#hl-53-23>23</a>
</span><span class=lnt id=hl-53-24><a class=lnlinks href=#hl-53-24>24</a>
</span><span class=lnt id=hl-53-25><a class=lnlinks href=#hl-53-25>25</a>
</span><span class=lnt id=hl-53-26><a class=lnlinks href=#hl-53-26>26</a>
</span><span class=lnt id=hl-53-27><a class=lnlinks href=#hl-53-27>27</a>
</span><span class=lnt id=hl-53-28><a class=lnlinks href=#hl-53-28>28</a>
</span><span class=lnt id=hl-53-29><a class=lnlinks href=#hl-53-29>29</a>
</span><span class=lnt id=hl-53-30><a class=lnlinks href=#hl-53-30>30</a>
</span><span class=lnt id=hl-53-31><a class=lnlinks href=#hl-53-31>31</a>
</span><span class=lnt id=hl-53-32><a class=lnlinks href=#hl-53-32>32</a>
</span><span class=lnt id=hl-53-33><a class=lnlinks href=#hl-53-33>33</a>
</span><span class=lnt id=hl-53-34><a class=lnlinks href=#hl-53-34>34</a>
</span><span class=lnt id=hl-53-35><a class=lnlinks href=#hl-53-35>35</a>
</span><span class=lnt id=hl-53-36><a class=lnlinks href=#hl-53-36>36</a>
</span><span class=lnt id=hl-53-37><a class=lnlinks href=#hl-53-37>37</a>
</span><span class=lnt id=hl-53-38><a class=lnlinks href=#hl-53-38>38</a>
</span><span class=lnt id=hl-53-39><a class=lnlinks href=#hl-53-39>39</a>
</span><span class=lnt id=hl-53-40><a class=lnlinks href=#hl-53-40>40</a>
</span><span class=lnt id=hl-53-41><a class=lnlinks href=#hl-53-41>41</a>
</span><span class=lnt id=hl-53-42><a class=lnlinks href=#hl-53-42>42</a>
</span><span class=lnt id=hl-53-43><a class=lnlinks href=#hl-53-43>43</a>
</span><span class=lnt id=hl-53-44><a class=lnlinks href=#hl-53-44>44</a>
</span><span class=lnt id=hl-53-45><a class=lnlinks href=#hl-53-45>45</a>
</span><span class=lnt id=hl-53-46><a class=lnlinks href=#hl-53-46>46</a>
</span><span class=lnt id=hl-53-47><a class=lnlinks href=#hl-53-47>47</a>
</span><span class=lnt id=hl-53-48><a class=lnlinks href=#hl-53-48>48</a>
</span><span class=lnt id=hl-53-49><a class=lnlinks href=#hl-53-49>49</a>
</span><span class=lnt id=hl-53-50><a class=lnlinks href=#hl-53-50>50</a>
</span><span class=lnt id=hl-53-51><a class=lnlinks href=#hl-53-51>51</a>
</span><span class=lnt id=hl-53-52><a class=lnlinks href=#hl-53-52>52</a>
</span><span class=lnt id=hl-53-53><a class=lnlinks href=#hl-53-53>53</a>
</span><span class=lnt id=hl-53-54><a class=lnlinks href=#hl-53-54>54</a>
</span><span class=lnt id=hl-53-55><a class=lnlinks href=#hl-53-55>55</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python FastAPI에서 권한 기반 접근 제어</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi</span> <span class=kn>import</span> <span class=n>FastAPI</span><span class=p>,</span> <span class=n>Depends</span><span class=p>,</span> <span class=n>HTTPException</span><span class=p>,</span> <span class=n>status</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>fastapi.security</span> <span class=kn>import</span> <span class=n>OAuth2PasswordBearer</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>jose</span> <span class=kn>import</span> <span class=n>JWTError</span><span class=p>,</span> <span class=n>jwt</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pydantic</span> <span class=kn>import</span> <span class=n>BaseModel</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span><span class=p>,</span> <span class=n>Optional</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>FastAPI</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>oauth2_scheme</span> <span class=o>=</span> <span class=n>OAuth2PasswordBearer</span><span class=p>(</span><span class=n>tokenUrl</span><span class=o>=</span><span class=s2>&#34;token&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용자 모델</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>User</span><span class=p>(</span><span class=n>BaseModel</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>email</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>roles</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>disabled</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>bool</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 토큰에서 사용자 정보 추출</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_current_user</span><span class=p>(</span><span class=n>token</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>oauth2_scheme</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>credentials_exception</span> <span class=o>=</span> <span class=n>HTTPException</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>status_code</span><span class=o>=</span><span class=n>status</span><span class=o>.</span><span class=n>HTTP_401_UNAUTHORIZED</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Invalid authentication credentials&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>headers</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;WWW-Authenticate&#34;</span><span class=p>:</span> <span class=s2>&#34;Bearer&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>SECRET_KEY</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=n>ALGORITHM</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>username</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;sub&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>username</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>credentials_exception</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=n>get_user_from_db</span><span class=p>(</span><span class=n>username</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>user</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>credentials_exception</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>user</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>JWTError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>credentials_exception</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 권한 확인 함수</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>has_role</span><span class=p>(</span><span class=n>required_role</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>role_checker</span><span class=p>(</span><span class=n>user</span><span class=p>:</span> <span class=n>User</span> <span class=o>=</span> <span class=n>Depends</span><span class=p>(</span><span class=n>get_current_user</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>required_role</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>user</span><span class=o>.</span><span class=n>roles</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=n>HTTPException</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>status_code</span><span class=o>=</span><span class=n>status</span><span class=o>.</span><span class=n>HTTP_403_FORBIDDEN</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>detail</span><span class=o>=</span><span class=s2>&#34;Insufficient permissions&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>user</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>role_checker</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 엔드포인트 예제</span>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/admin/users&#34;</span><span class=p>,</span> <span class=n>dependencies</span><span class=o>=</span><span class=p>[</span><span class=n>Depends</span><span class=p>(</span><span class=n>has_role</span><span class=p>(</span><span class=s2>&#34;ADMIN&#34;</span><span class=p>))])</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>get_users</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;users&#34;</span><span class=p>:</span> <span class=n>get_all_users</span><span class=p>()}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.get</span><span class=p>(</span><span class=s2>&#34;/api/items&#34;</span><span class=p>,</span> <span class=n>dependencies</span><span class=o>=</span><span class=p>[</span><span class=n>Depends</span><span class=p>(</span><span class=n>has_role</span><span class=p>(</span><span class=s2>&#34;USER&#34;</span><span class=p>))])</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>get_items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;items&#34;</span><span class=p>:</span> <span class=n>get_all_items</span><span class=p>()}</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h4 id=iot-기기를-위한-보안-코딩>IoT 기기를 위한 보안 코딩<a hidden class=anchor aria-hidden=true href=#iot-기기를-위한-보안-코딩>#</a></h4><p>IoT 디바이스는 특별한 보안 고려사항이 필요:</p><ol><li><p>안전한 부팅 및 펌웨어 업데이트<br>디지털 서명을 통한 펌웨어 무결성 검증:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-54-1><a class=lnlinks href=#hl-54-1> 1</a>
</span><span class=lnt id=hl-54-2><a class=lnlinks href=#hl-54-2> 2</a>
</span><span class=lnt id=hl-54-3><a class=lnlinks href=#hl-54-3> 3</a>
</span><span class=lnt id=hl-54-4><a class=lnlinks href=#hl-54-4> 4</a>
</span><span class=lnt id=hl-54-5><a class=lnlinks href=#hl-54-5> 5</a>
</span><span class=lnt id=hl-54-6><a class=lnlinks href=#hl-54-6> 6</a>
</span><span class=lnt id=hl-54-7><a class=lnlinks href=#hl-54-7> 7</a>
</span><span class=lnt id=hl-54-8><a class=lnlinks href=#hl-54-8> 8</a>
</span><span class=lnt id=hl-54-9><a class=lnlinks href=#hl-54-9> 9</a>
</span><span class=lnt id=hl-54-10><a class=lnlinks href=#hl-54-10>10</a>
</span><span class=lnt id=hl-54-11><a class=lnlinks href=#hl-54-11>11</a>
</span><span class=lnt id=hl-54-12><a class=lnlinks href=#hl-54-12>12</a>
</span><span class=lnt id=hl-54-13><a class=lnlinks href=#hl-54-13>13</a>
</span><span class=lnt id=hl-54-14><a class=lnlinks href=#hl-54-14>14</a>
</span><span class=lnt id=hl-54-15><a class=lnlinks href=#hl-54-15>15</a>
</span><span class=lnt id=hl-54-16><a class=lnlinks href=#hl-54-16>16</a>
</span><span class=lnt id=hl-54-17><a class=lnlinks href=#hl-54-17>17</a>
</span><span class=lnt id=hl-54-18><a class=lnlinks href=#hl-54-18>18</a>
</span><span class=lnt id=hl-54-19><a class=lnlinks href=#hl-54-19>19</a>
</span><span class=lnt id=hl-54-20><a class=lnlinks href=#hl-54-20>20</a>
</span><span class=lnt id=hl-54-21><a class=lnlinks href=#hl-54-21>21</a>
</span><span class=lnt id=hl-54-22><a class=lnlinks href=#hl-54-22>22</a>
</span><span class=lnt id=hl-54-23><a class=lnlinks href=#hl-54-23>23</a>
</span><span class=lnt id=hl-54-24><a class=lnlinks href=#hl-54-24>24</a>
</span><span class=lnt id=hl-54-25><a class=lnlinks href=#hl-54-25>25</a>
</span><span class=lnt id=hl-54-26><a class=lnlinks href=#hl-54-26>26</a>
</span><span class=lnt id=hl-54-27><a class=lnlinks href=#hl-54-27>27</a>
</span><span class=lnt id=hl-54-28><a class=lnlinks href=#hl-54-28>28</a>
</span><span class=lnt id=hl-54-29><a class=lnlinks href=#hl-54-29>29</a>
</span><span class=lnt id=hl-54-30><a class=lnlinks href=#hl-54-30>30</a>
</span><span class=lnt id=hl-54-31><a class=lnlinks href=#hl-54-31>31</a>
</span><span class=lnt id=hl-54-32><a class=lnlinks href=#hl-54-32>32</a>
</span><span class=lnt id=hl-54-33><a class=lnlinks href=#hl-54-33>33</a>
</span><span class=lnt id=hl-54-34><a class=lnlinks href=#hl-54-34>34</a>
</span><span class=lnt id=hl-54-35><a class=lnlinks href=#hl-54-35>35</a>
</span><span class=lnt id=hl-54-36><a class=lnlinks href=#hl-54-36>36</a>
</span><span class=lnt id=hl-54-37><a class=lnlinks href=#hl-54-37>37</a>
</span><span class=lnt id=hl-54-38><a class=lnlinks href=#hl-54-38>38</a>
</span><span class=lnt id=hl-54-39><a class=lnlinks href=#hl-54-39>39</a>
</span><span class=lnt id=hl-54-40><a class=lnlinks href=#hl-54-40>40</a>
</span><span class=lnt id=hl-54-41><a class=lnlinks href=#hl-54-41>41</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=c1>// C에서 펌웨어 서명 확인
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#include</span> <span class=cpf>&lt;openssl/evp.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;openssl/pem.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>verify_firmware_signature</span><span class=p>(</span><span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>firmware_data</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>firmware_len</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                             <span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>signature</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>sig_len</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                             <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>public_key_path</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>FILE</span> <span class=o>*</span><span class=n>key_file</span> <span class=o>=</span> <span class=nf>fopen</span><span class=p>(</span><span class=n>public_key_path</span><span class=p>,</span> <span class=s>&#34;r&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>key_file</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span> <span class=c1>// 키 파일 열기 실패
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 공개 키 로드
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>EVP_PKEY</span> <span class=o>*</span><span class=n>public_key</span> <span class=o>=</span> <span class=nf>PEM_read_PUBKEY</span><span class=p>(</span><span class=n>key_file</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>fclose</span><span class=p>(</span><span class=n>key_file</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>public_key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span> <span class=c1>// 공개 키 로드 실패
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 서명 확인 컨텍스트 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>EVP_MD_CTX</span> <span class=o>*</span><span class=n>ctx</span> <span class=o>=</span> <span class=nf>EVP_MD_CTX_new</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>result</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>ctx</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 서명 확인 초기화
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nf>EVP_VerifyInit</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>EVP_sha256</span><span class=p>())</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 펌웨어 데이터 업데이트
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>if</span> <span class=p>(</span><span class=nf>EVP_VerifyUpdate</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>firmware_data</span><span class=p>,</span> <span class=n>firmware_len</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>// 서명 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>if</span> <span class=p>(</span><span class=nf>EVP_VerifyFinal</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>signature</span><span class=p>,</span> <span class=n>sig_len</span><span class=p>,</span> <span class=n>public_key</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>result</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// 서명 확인 성공
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=nf>EVP_MD_CTX_free</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nf>EVP_PKEY_free</span><span class=p>(</span><span class=n>public_key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>안전한 통신<br>TLS 를 사용한 IoT 기기 통신 보안:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-55-1><a class=lnlinks href=#hl-55-1> 1</a>
</span><span class=lnt id=hl-55-2><a class=lnlinks href=#hl-55-2> 2</a>
</span><span class=lnt id=hl-55-3><a class=lnlinks href=#hl-55-3> 3</a>
</span><span class=lnt id=hl-55-4><a class=lnlinks href=#hl-55-4> 4</a>
</span><span class=lnt id=hl-55-5><a class=lnlinks href=#hl-55-5> 5</a>
</span><span class=lnt id=hl-55-6><a class=lnlinks href=#hl-55-6> 6</a>
</span><span class=lnt id=hl-55-7><a class=lnlinks href=#hl-55-7> 7</a>
</span><span class=lnt id=hl-55-8><a class=lnlinks href=#hl-55-8> 8</a>
</span><span class=lnt id=hl-55-9><a class=lnlinks href=#hl-55-9> 9</a>
</span><span class=lnt id=hl-55-10><a class=lnlinks href=#hl-55-10>10</a>
</span><span class=lnt id=hl-55-11><a class=lnlinks href=#hl-55-11>11</a>
</span><span class=lnt id=hl-55-12><a class=lnlinks href=#hl-55-12>12</a>
</span><span class=lnt id=hl-55-13><a class=lnlinks href=#hl-55-13>13</a>
</span><span class=lnt id=hl-55-14><a class=lnlinks href=#hl-55-14>14</a>
</span><span class=lnt id=hl-55-15><a class=lnlinks href=#hl-55-15>15</a>
</span><span class=lnt id=hl-55-16><a class=lnlinks href=#hl-55-16>16</a>
</span><span class=lnt id=hl-55-17><a class=lnlinks href=#hl-55-17>17</a>
</span><span class=lnt id=hl-55-18><a class=lnlinks href=#hl-55-18>18</a>
</span><span class=lnt id=hl-55-19><a class=lnlinks href=#hl-55-19>19</a>
</span><span class=lnt id=hl-55-20><a class=lnlinks href=#hl-55-20>20</a>
</span><span class=lnt id=hl-55-21><a class=lnlinks href=#hl-55-21>21</a>
</span><span class=lnt id=hl-55-22><a class=lnlinks href=#hl-55-22>22</a>
</span><span class=lnt id=hl-55-23><a class=lnlinks href=#hl-55-23>23</a>
</span><span class=lnt id=hl-55-24><a class=lnlinks href=#hl-55-24>24</a>
</span><span class=lnt id=hl-55-25><a class=lnlinks href=#hl-55-25>25</a>
</span><span class=lnt id=hl-55-26><a class=lnlinks href=#hl-55-26>26</a>
</span><span class=lnt id=hl-55-27><a class=lnlinks href=#hl-55-27>27</a>
</span><span class=lnt id=hl-55-28><a class=lnlinks href=#hl-55-28>28</a>
</span><span class=lnt id=hl-55-29><a class=lnlinks href=#hl-55-29>29</a>
</span><span class=lnt id=hl-55-30><a class=lnlinks href=#hl-55-30>30</a>
</span><span class=lnt id=hl-55-31><a class=lnlinks href=#hl-55-31>31</a>
</span><span class=lnt id=hl-55-32><a class=lnlinks href=#hl-55-32>32</a>
</span><span class=lnt id=hl-55-33><a class=lnlinks href=#hl-55-33>33</a>
</span><span class=lnt id=hl-55-34><a class=lnlinks href=#hl-55-34>34</a>
</span><span class=lnt id=hl-55-35><a class=lnlinks href=#hl-55-35>35</a>
</span><span class=lnt id=hl-55-36><a class=lnlinks href=#hl-55-36>36</a>
</span><span class=lnt id=hl-55-37><a class=lnlinks href=#hl-55-37>37</a>
</span><span class=lnt id=hl-55-38><a class=lnlinks href=#hl-55-38>38</a>
</span><span class=lnt id=hl-55-39><a class=lnlinks href=#hl-55-39>39</a>
</span><span class=lnt id=hl-55-40><a class=lnlinks href=#hl-55-40>40</a>
</span><span class=lnt id=hl-55-41><a class=lnlinks href=#hl-55-41>41</a>
</span><span class=lnt id=hl-55-42><a class=lnlinks href=#hl-55-42>42</a>
</span><span class=lnt id=hl-55-43><a class=lnlinks href=#hl-55-43>43</a>
</span><span class=lnt id=hl-55-44><a class=lnlinks href=#hl-55-44>44</a>
</span><span class=lnt id=hl-55-45><a class=lnlinks href=#hl-55-45>45</a>
</span><span class=lnt id=hl-55-46><a class=lnlinks href=#hl-55-46>46</a>
</span><span class=lnt id=hl-55-47><a class=lnlinks href=#hl-55-47>47</a>
</span><span class=lnt id=hl-55-48><a class=lnlinks href=#hl-55-48>48</a>
</span><span class=lnt id=hl-55-49><a class=lnlinks href=#hl-55-49>49</a>
</span><span class=lnt id=hl-55-50><a class=lnlinks href=#hl-55-50>50</a>
</span><span class=lnt id=hl-55-51><a class=lnlinks href=#hl-55-51>51</a>
</span><span class=lnt id=hl-55-52><a class=lnlinks href=#hl-55-52>52</a>
</span><span class=lnt id=hl-55-53><a class=lnlinks href=#hl-55-53>53</a>
</span><span class=lnt id=hl-55-54><a class=lnlinks href=#hl-55-54>54</a>
</span><span class=lnt id=hl-55-55><a class=lnlinks href=#hl-55-55>55</a>
</span><span class=lnt id=hl-55-56><a class=lnlinks href=#hl-55-56>56</a>
</span><span class=lnt id=hl-55-57><a class=lnlinks href=#hl-55-57>57</a>
</span><span class=lnt id=hl-55-58><a class=lnlinks href=#hl-55-58>58</a>
</span><span class=lnt id=hl-55-59><a class=lnlinks href=#hl-55-59>59</a>
</span><span class=lnt id=hl-55-60><a class=lnlinks href=#hl-55-60>60</a>
</span><span class=lnt id=hl-55-61><a class=lnlinks href=#hl-55-61>61</a>
</span><span class=lnt id=hl-55-62><a class=lnlinks href=#hl-55-62>62</a>
</span><span class=lnt id=hl-55-63><a class=lnlinks href=#hl-55-63>63</a>
</span><span class=lnt id=hl-55-64><a class=lnlinks href=#hl-55-64>64</a>
</span><span class=lnt id=hl-55-65><a class=lnlinks href=#hl-55-65>65</a>
</span><span class=lnt id=hl-55-66><a class=lnlinks href=#hl-55-66>66</a>
</span><span class=lnt id=hl-55-67><a class=lnlinks href=#hl-55-67>67</a>
</span><span class=lnt id=hl-55-68><a class=lnlinks href=#hl-55-68>68</a>
</span><span class=lnt id=hl-55-69><a class=lnlinks href=#hl-55-69>69</a>
</span><span class=lnt id=hl-55-70><a class=lnlinks href=#hl-55-70>70</a>
</span><span class=lnt id=hl-55-71><a class=lnlinks href=#hl-55-71>71</a>
</span><span class=lnt id=hl-55-72><a class=lnlinks href=#hl-55-72>72</a>
</span><span class=lnt id=hl-55-73><a class=lnlinks href=#hl-55-73>73</a>
</span><span class=lnt id=hl-55-74><a class=lnlinks href=#hl-55-74>74</a>
</span><span class=lnt id=hl-55-75><a class=lnlinks href=#hl-55-75>75</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=c1>// C에서 mbedTLS를 사용한 TLS 클라이언트 구현
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#include</span> <span class=cpf>&#34;mbedtls/net_sockets.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mbedtls/ssl.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mbedtls/entropy.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mbedtls/ctr_drbg.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mbedtls/error.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&#34;mbedtls/certs.h&#34;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>secure_connect_to_server</span><span class=p>(</span><span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>server</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>port</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>mbedtls_net_context</span> <span class=n>server_fd</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>mbedtls_ssl_context</span> <span class=n>ssl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>mbedtls_ssl_config</span> <span class=n>conf</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>mbedtls_entropy_context</span> <span class=n>entropy</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>mbedtls_ctr_drbg_context</span> <span class=n>ctr_drbg</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>pers</span> <span class=o>=</span> <span class=s>&#34;ssl_client&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 초기화
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>mbedtls_net_init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>server_fd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_ssl_init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ssl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_ssl_config_init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>conf</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_entropy_init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>entropy</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_ctr_drbg_init</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctr_drbg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 난수 생성기 시드 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nf>mbedtls_ctr_drbg_seed</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctr_drbg</span><span class=p>,</span> <span class=n>mbedtls_entropy_func</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>entropy</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                             <span class=p>(</span><span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=n>pers</span><span class=p>,</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>pers</span><span class=p>))</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 서버에 연결
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nf>mbedtls_net_connect</span><span class=p>(</span><span class=o>&amp;</span><span class=n>server_fd</span><span class=p>,</span> <span class=n>server</span><span class=p>,</span> <span class=n>port</span><span class=p>,</span> <span class=n>MBEDTLS_NET_PROTO_TCP</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// SSL/TLS 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nf>mbedtls_ssl_config_defaults</span><span class=p>(</span><span class=o>&amp;</span><span class=n>conf</span><span class=p>,</span> <span class=n>MBEDTLS_SSL_IS_CLIENT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=n>MBEDTLS_SSL_TRANSPORT_STREAM</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=n>MBEDTLS_SSL_PRESET_DEFAULT</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 인증서 확인을 선택 사항으로 설정 (프로덕션에서는 필수로 설정해야 함)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>mbedtls_ssl_conf_authmode</span><span class=p>(</span><span class=o>&amp;</span><span class=n>conf</span><span class=p>,</span> <span class=n>MBEDTLS_SSL_VERIFY_OPTIONAL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_ssl_conf_rng</span><span class=p>(</span><span class=o>&amp;</span><span class=n>conf</span><span class=p>,</span> <span class=n>mbedtls_ctr_drbg_random</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>ctr_drbg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// SSL/TLS 설정 적용
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nf>mbedtls_ssl_setup</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ssl</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>conf</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 호스트 이름 설정 (필수)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nf>mbedtls_ssl_set_hostname</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ssl</span><span class=p>,</span> <span class=n>server</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// SSL/TLS 입출력 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>mbedtls_ssl_set_bio</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ssl</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>server_fd</span><span class=p>,</span> <span class=n>mbedtls_net_send</span><span class=p>,</span> <span class=n>mbedtls_net_recv</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 핸드셰이크 수행
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>while</span> <span class=p>(</span><span class=nf>mbedtls_ssl_handshake</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ssl</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 핸드셰이크 재시도
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 이제 ssl_write와 ssl_read를 사용하여 통신 가능
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 사용 후 리소스 정리
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>mbedtls_ssl_close_notify</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ssl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_net_free</span><span class=p>(</span><span class=o>&amp;</span><span class=n>server_fd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_ssl_free</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ssl</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_ssl_config_free</span><span class=p>(</span><span class=o>&amp;</span><span class=n>conf</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_ctr_drbg_free</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctr_drbg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>mbedtls_entropy_free</span><span class=p>(</span><span class=o>&amp;</span><span class=n>entropy</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>데이터 저장 암호화<br>IoT 기기에서 민감한 데이터 암호화:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-56-1><a class=lnlinks href=#hl-56-1> 1</a>
</span><span class=lnt id=hl-56-2><a class=lnlinks href=#hl-56-2> 2</a>
</span><span class=lnt id=hl-56-3><a class=lnlinks href=#hl-56-3> 3</a>
</span><span class=lnt id=hl-56-4><a class=lnlinks href=#hl-56-4> 4</a>
</span><span class=lnt id=hl-56-5><a class=lnlinks href=#hl-56-5> 5</a>
</span><span class=lnt id=hl-56-6><a class=lnlinks href=#hl-56-6> 6</a>
</span><span class=lnt id=hl-56-7><a class=lnlinks href=#hl-56-7> 7</a>
</span><span class=lnt id=hl-56-8><a class=lnlinks href=#hl-56-8> 8</a>
</span><span class=lnt id=hl-56-9><a class=lnlinks href=#hl-56-9> 9</a>
</span><span class=lnt id=hl-56-10><a class=lnlinks href=#hl-56-10>10</a>
</span><span class=lnt id=hl-56-11><a class=lnlinks href=#hl-56-11>11</a>
</span><span class=lnt id=hl-56-12><a class=lnlinks href=#hl-56-12>12</a>
</span><span class=lnt id=hl-56-13><a class=lnlinks href=#hl-56-13>13</a>
</span><span class=lnt id=hl-56-14><a class=lnlinks href=#hl-56-14>14</a>
</span><span class=lnt id=hl-56-15><a class=lnlinks href=#hl-56-15>15</a>
</span><span class=lnt id=hl-56-16><a class=lnlinks href=#hl-56-16>16</a>
</span><span class=lnt id=hl-56-17><a class=lnlinks href=#hl-56-17>17</a>
</span><span class=lnt id=hl-56-18><a class=lnlinks href=#hl-56-18>18</a>
</span><span class=lnt id=hl-56-19><a class=lnlinks href=#hl-56-19>19</a>
</span><span class=lnt id=hl-56-20><a class=lnlinks href=#hl-56-20>20</a>
</span><span class=lnt id=hl-56-21><a class=lnlinks href=#hl-56-21>21</a>
</span><span class=lnt id=hl-56-22><a class=lnlinks href=#hl-56-22>22</a>
</span><span class=lnt id=hl-56-23><a class=lnlinks href=#hl-56-23>23</a>
</span><span class=lnt id=hl-56-24><a class=lnlinks href=#hl-56-24>24</a>
</span><span class=lnt id=hl-56-25><a class=lnlinks href=#hl-56-25>25</a>
</span><span class=lnt id=hl-56-26><a class=lnlinks href=#hl-56-26>26</a>
</span><span class=lnt id=hl-56-27><a class=lnlinks href=#hl-56-27>27</a>
</span><span class=lnt id=hl-56-28><a class=lnlinks href=#hl-56-28>28</a>
</span><span class=lnt id=hl-56-29><a class=lnlinks href=#hl-56-29>29</a>
</span><span class=lnt id=hl-56-30><a class=lnlinks href=#hl-56-30>30</a>
</span><span class=lnt id=hl-56-31><a class=lnlinks href=#hl-56-31>31</a>
</span><span class=lnt id=hl-56-32><a class=lnlinks href=#hl-56-32>32</a>
</span><span class=lnt id=hl-56-33><a class=lnlinks href=#hl-56-33>33</a>
</span><span class=lnt id=hl-56-34><a class=lnlinks href=#hl-56-34>34</a>
</span><span class=lnt id=hl-56-35><a class=lnlinks href=#hl-56-35>35</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=c1>// C에서 데이터 암호화
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#include</span> <span class=cpf>&lt;openssl/evp.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;openssl/rand.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>encrypt_data</span><span class=p>(</span><span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>plaintext</span><span class=p>,</span> <span class=kt>int</span> <span class=n>plaintext_len</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>key</span><span class=p>,</span> <span class=k>const</span> <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>iv</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=kt>unsigned</span> <span class=kt>char</span> <span class=o>*</span><span class=n>ciphertext</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>EVP_CIPHER_CTX</span> <span class=o>*</span><span class=n>ctx</span> <span class=o>=</span> <span class=nf>EVP_CIPHER_CTX_new</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>len</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>ciphertext_len</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 암호화 컨텍스트 초기화
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nf>EVP_EncryptInit_ex</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>EVP_aes_256_cbc</span><span class=p>(),</span> <span class=nb>NULL</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>iv</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>EVP_CIPHER_CTX_free</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 암호화 수행
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nf>EVP_EncryptUpdate</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>ciphertext</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>len</span><span class=p>,</span> <span class=n>plaintext</span><span class=p>,</span> <span class=n>plaintext_len</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>EVP_CIPHER_CTX_free</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>ciphertext_len</span> <span class=o>=</span> <span class=n>len</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 암호화 종료
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nf>EVP_EncryptFinal_ex</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=n>ciphertext</span> <span class=o>+</span> <span class=n>len</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>len</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nf>EVP_CIPHER_CTX_free</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>ciphertext_len</span> <span class=o>+=</span> <span class=n>len</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 정리
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nf>EVP_CIPHER_CTX_free</span><span class=p>(</span><span class=n>ctx</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ciphertext_len</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>안전한 리소스 관리<br>메모리, CPU, 네트워크 등의 리소스 사용을 제한하여 DoS 공격 방지:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-57-1><a class=lnlinks href=#hl-57-1> 1</a>
</span><span class=lnt id=hl-57-2><a class=lnlinks href=#hl-57-2> 2</a>
</span><span class=lnt id=hl-57-3><a class=lnlinks href=#hl-57-3> 3</a>
</span><span class=lnt id=hl-57-4><a class=lnlinks href=#hl-57-4> 4</a>
</span><span class=lnt id=hl-57-5><a class=lnlinks href=#hl-57-5> 5</a>
</span><span class=lnt id=hl-57-6><a class=lnlinks href=#hl-57-6> 6</a>
</span><span class=lnt id=hl-57-7><a class=lnlinks href=#hl-57-7> 7</a>
</span><span class=lnt id=hl-57-8><a class=lnlinks href=#hl-57-8> 8</a>
</span><span class=lnt id=hl-57-9><a class=lnlinks href=#hl-57-9> 9</a>
</span><span class=lnt id=hl-57-10><a class=lnlinks href=#hl-57-10>10</a>
</span><span class=lnt id=hl-57-11><a class=lnlinks href=#hl-57-11>11</a>
</span><span class=lnt id=hl-57-12><a class=lnlinks href=#hl-57-12>12</a>
</span><span class=lnt id=hl-57-13><a class=lnlinks href=#hl-57-13>13</a>
</span><span class=lnt id=hl-57-14><a class=lnlinks href=#hl-57-14>14</a>
</span><span class=lnt id=hl-57-15><a class=lnlinks href=#hl-57-15>15</a>
</span><span class=lnt id=hl-57-16><a class=lnlinks href=#hl-57-16>16</a>
</span><span class=lnt id=hl-57-17><a class=lnlinks href=#hl-57-17>17</a>
</span><span class=lnt id=hl-57-18><a class=lnlinks href=#hl-57-18>18</a>
</span><span class=lnt id=hl-57-19><a class=lnlinks href=#hl-57-19>19</a>
</span><span class=lnt id=hl-57-20><a class=lnlinks href=#hl-57-20>20</a>
</span><span class=lnt id=hl-57-21><a class=lnlinks href=#hl-57-21>21</a>
</span><span class=lnt id=hl-57-22><a class=lnlinks href=#hl-57-22>22</a>
</span><span class=lnt id=hl-57-23><a class=lnlinks href=#hl-57-23>23</a>
</span><span class=lnt id=hl-57-24><a class=lnlinks href=#hl-57-24>24</a>
</span><span class=lnt id=hl-57-25><a class=lnlinks href=#hl-57-25>25</a>
</span><span class=lnt id=hl-57-26><a class=lnlinks href=#hl-57-26>26</a>
</span><span class=lnt id=hl-57-27><a class=lnlinks href=#hl-57-27>27</a>
</span><span class=lnt id=hl-57-28><a class=lnlinks href=#hl-57-28>28</a>
</span><span class=lnt id=hl-57-29><a class=lnlinks href=#hl-57-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=c1>// C에서 리소스 제한 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#include</span> <span class=cpf>&lt;sys/resource.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>set_resource_limits</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>struct</span> <span class=n>rlimit</span> <span class=n>rlim</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// CPU 시간 제한 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>rlim</span><span class=p>.</span><span class=n>rlim_cur</span> <span class=o>=</span> <span class=mi>10</span><span class=p>;</span> <span class=c1>// 10초
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>rlim</span><span class=p>.</span><span class=n>rlim_max</span> <span class=o>=</span> <span class=mi>20</span><span class=p>;</span> <span class=c1>// 최대 20초
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nf>setrlimit</span><span class=p>(</span><span class=n>RLIMIT_CPU</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>rlim</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 메모리 사용량 제한
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>rlim</span><span class=p>.</span><span class=n>rlim_cur</span> <span class=o>=</span> <span class=mi>10</span> <span class=o>*</span> <span class=mi>1024</span> <span class=o>*</span> <span class=mi>1024</span><span class=p>;</span> <span class=c1>// 10MB
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>rlim</span><span class=p>.</span><span class=n>rlim_max</span> <span class=o>=</span> <span class=mi>15</span> <span class=o>*</span> <span class=mi>1024</span> <span class=o>*</span> <span class=mi>1024</span><span class=p>;</span> <span class=c1>// 최대 15MB
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nf>setrlimit</span><span class=p>(</span><span class=n>RLIMIT_AS</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>rlim</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 파일 개수 제한
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>rlim</span><span class=p>.</span><span class=n>rlim_cur</span> <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>rlim</span><span class=p>.</span><span class=n>rlim_max</span> <span class=o>=</span> <span class=mi>100</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nf>setrlimit</span><span class=p>(</span><span class=n>RLIMIT_NOFILE</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>rlim</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h4 id=인젝션-공격-방어>인젝션 공격 방어<a hidden class=anchor aria-hidden=true href=#인젝션-공격-방어>#</a></h4><p>인젝션 공격은 가장 흔하고 위험한 웹 애플리케이션 보안 취약점 중 하나:</p><ol><li><p>SQL 인젝션 방지</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-58-1><a class=lnlinks href=#hl-58-1>1</a>
</span><span class=lnt id=hl-58-2><a class=lnlinks href=#hl-58-2>2</a>
</span><span class=lnt id=hl-58-3><a class=lnlinks href=#hl-58-3>3</a>
</span><span class=lnt id=hl-58-4><a class=lnlinks href=#hl-58-4>4</a>
</span><span class=lnt id=hl-58-5><a class=lnlinks href=#hl-58-5>5</a>
</span><span class=lnt id=hl-58-6><a class=lnlinks href=#hl-58-6>6</a>
</span><span class=lnt id=hl-58-7><a class=lnlinks href=#hl-58-7>7</a>
</span><span class=lnt id=hl-58-8><a class=lnlinks href=#hl-58-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT * FROM users WHERE username = &#39;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>username</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;&#39; AND password = &#39;&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;&#39;&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 안전한 코드</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;SELECT * FROM users WHERE username = ? AND password = ?&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>PreparedStatement</span><span class=w> </span><span class=n>stmt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>connection</span><span class=p>.</span><span class=na>prepareStatement</span><span class=p>(</span><span class=n>query</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>stmt</span><span class=p>.</span><span class=na>setString</span><span class=p>(</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>username</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>stmt</span><span class=p>.</span><span class=na>setString</span><span class=p>(</span><span class=n>2</span><span class=p>,</span><span class=w> </span><span class=n>password</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>명령어 인젝션 방지</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-59-1><a class=lnlinks href=#hl-59-1>1</a>
</span><span class=lnt id=hl-59-2><a class=lnlinks href=#hl-59-2>2</a>
</span><span class=lnt id=hl-59-3><a class=lnlinks href=#hl-59-3>3</a>
</span><span class=lnt id=hl-59-4><a class=lnlinks href=#hl-59-4>4</a>
</span><span class=lnt id=hl-59-5><a class=lnlinks href=#hl-59-5>5</a>
</span><span class=lnt id=hl-59-6><a class=lnlinks href=#hl-59-6>6</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 안전하지 않은 코드</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s2>&#34;ping &#34;</span> <span class=o>+</span> <span class=n>user_input</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 안전한 코드</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=s2>&#34;ping&#34;</span><span class=p>,</span> <span class=n>user_input</span><span class=p>],</span> <span class=n>capture_output</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>text</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>check</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>XSS 방지</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-60-1><a class=lnlinks href=#hl-60-1>1</a>
</span><span class=lnt id=hl-60-2><a class=lnlinks href=#hl-60-2>2</a>
</span><span class=lnt id=hl-60-3><a class=lnlinks href=#hl-60-3>3</a>
</span><span class=lnt id=hl-60-4><a class=lnlinks href=#hl-60-4>4</a>
</span><span class=lnt id=hl-60-5><a class=lnlinks href=#hl-60-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 안전하지 않은 코드
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>element</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=nx>userInput</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 안전한 코드
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>element</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=nx>userInput</span><span class=p>;</span>  <span class=c1>// 또는 적절한 이스케이프 라이브러리 사용
</span></span></span></code></pre></td></tr></table></div></div></li></ol><h4 id=암호화-및-민감-데이터-처리>암호화 및 민감 데이터 처리<a hidden class=anchor aria-hidden=true href=#암호화-및-민감-데이터-처리>#</a></h4><p>데이터 보호를 위한 암호화 모범 사례:</p><ol><li><p>강력한 암호화 알고리즘 사용</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-61-1><a class=lnlinks href=#hl-61-1> 1</a>
</span><span class=lnt id=hl-61-2><a class=lnlinks href=#hl-61-2> 2</a>
</span><span class=lnt id=hl-61-3><a class=lnlinks href=#hl-61-3> 3</a>
</span><span class=lnt id=hl-61-4><a class=lnlinks href=#hl-61-4> 4</a>
</span><span class=lnt id=hl-61-5><a class=lnlinks href=#hl-61-5> 5</a>
</span><span class=lnt id=hl-61-6><a class=lnlinks href=#hl-61-6> 6</a>
</span><span class=lnt id=hl-61-7><a class=lnlinks href=#hl-61-7> 7</a>
</span><span class=lnt id=hl-61-8><a class=lnlinks href=#hl-61-8> 8</a>
</span><span class=lnt id=hl-61-9><a class=lnlinks href=#hl-61-9> 9</a>
</span><span class=lnt id=hl-61-10><a class=lnlinks href=#hl-61-10>10</a>
</span><span class=lnt id=hl-61-11><a class=lnlinks href=#hl-61-11>11</a>
</span><span class=lnt id=hl-61-12><a class=lnlinks href=#hl-61-12>12</a>
</span><span class=lnt id=hl-61-13><a class=lnlinks href=#hl-61-13>13</a>
</span><span class=lnt id=hl-61-14><a class=lnlinks href=#hl-61-14>14</a>
</span><span class=lnt id=hl-61-15><a class=lnlinks href=#hl-61-15>15</a>
</span><span class=lnt id=hl-61-16><a class=lnlinks href=#hl-61-16>16</a>
</span><span class=lnt id=hl-61-17><a class=lnlinks href=#hl-61-17>17</a>
</span><span class=lnt id=hl-61-18><a class=lnlinks href=#hl-61-18>18</a>
</span><span class=lnt id=hl-61-19><a class=lnlinks href=#hl-61-19>19</a>
</span><span class=lnt id=hl-61-20><a class=lnlinks href=#hl-61-20>20</a>
</span><span class=lnt id=hl-61-21><a class=lnlinks href=#hl-61-21>21</a>
</span><span class=lnt id=hl-61-22><a class=lnlinks href=#hl-61-22>22</a>
</span><span class=lnt id=hl-61-23><a class=lnlinks href=#hl-61-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Node.js에서 안전한 암호화 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>crypto</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;crypto&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>encryptData</span><span class=p>(</span><span class=nx>data</span><span class=p>,</span> <span class=nx>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 무작위 초기화 벡터(IV) 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>iv</span> <span class=o>=</span> <span class=nx>crypto</span><span class=p>.</span><span class=nx>randomBytes</span><span class=p>(</span><span class=mi>16</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// AES-256-GCM 암호화 (인증된 암호화)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>cipher</span> <span class=o>=</span> <span class=nx>crypto</span><span class=p>.</span><span class=nx>createCipheriv</span><span class=p>(</span><span class=s1>&#39;aes-256-gcm&#39;</span><span class=p>,</span> <span class=nx>key</span><span class=p>,</span> <span class=nx>iv</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>encrypted</span> <span class=o>=</span> <span class=nx>cipher</span><span class=p>.</span><span class=nx>update</span><span class=p>(</span><span class=nx>data</span><span class=p>,</span> <span class=s1>&#39;utf8&#39;</span><span class=p>,</span> <span class=s1>&#39;hex&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>encrypted</span> <span class=o>+=</span> <span class=nx>cipher</span><span class=p>.</span><span class=kr>final</span><span class=p>(</span><span class=s1>&#39;hex&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 인증 태그 획득
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>authTag</span> <span class=o>=</span> <span class=nx>cipher</span><span class=p>.</span><span class=nx>getAuthTag</span><span class=p>().</span><span class=nx>toString</span><span class=p>(</span><span class=s1>&#39;hex&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// IV, 암호문, 인증 태그 반환
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>iv</span><span class=o>:</span> <span class=nx>iv</span><span class=p>.</span><span class=nx>toString</span><span class=p>(</span><span class=s1>&#39;hex&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>encryptedData</span><span class=o>:</span> <span class=nx>encrypted</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>authTag</span><span class=o>:</span> <span class=nx>authTag</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>안전한 비밀번호 관리</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-62-1><a class=lnlinks href=#hl-62-1> 1</a>
</span><span class=lnt id=hl-62-2><a class=lnlinks href=#hl-62-2> 2</a>
</span><span class=lnt id=hl-62-3><a class=lnlinks href=#hl-62-3> 3</a>
</span><span class=lnt id=hl-62-4><a class=lnlinks href=#hl-62-4> 4</a>
</span><span class=lnt id=hl-62-5><a class=lnlinks href=#hl-62-5> 5</a>
</span><span class=lnt id=hl-62-6><a class=lnlinks href=#hl-62-6> 6</a>
</span><span class=lnt id=hl-62-7><a class=lnlinks href=#hl-62-7> 7</a>
</span><span class=lnt id=hl-62-8><a class=lnlinks href=#hl-62-8> 8</a>
</span><span class=lnt id=hl-62-9><a class=lnlinks href=#hl-62-9> 9</a>
</span><span class=lnt id=hl-62-10><a class=lnlinks href=#hl-62-10>10</a>
</span><span class=lnt id=hl-62-11><a class=lnlinks href=#hl-62-11>11</a>
</span><span class=lnt id=hl-62-12><a class=lnlinks href=#hl-62-12>12</a>
</span><span class=lnt id=hl-62-13><a class=lnlinks href=#hl-62-13>13</a>
</span><span class=lnt id=hl-62-14><a class=lnlinks href=#hl-62-14>14</a>
</span><span class=lnt id=hl-62-15><a class=lnlinks href=#hl-62-15>15</a>
</span><span class=lnt id=hl-62-16><a class=lnlinks href=#hl-62-16>16</a>
</span><span class=lnt id=hl-62-17><a class=lnlinks href=#hl-62-17>17</a>
</span><span class=lnt id=hl-62-18><a class=lnlinks href=#hl-62-18>18</a>
</span><span class=lnt id=hl-62-19><a class=lnlinks href=#hl-62-19>19</a>
</span><span class=lnt id=hl-62-20><a class=lnlinks href=#hl-62-20>20</a>
</span><span class=lnt id=hl-62-21><a class=lnlinks href=#hl-62-21>21</a>
</span><span class=lnt id=hl-62-22><a class=lnlinks href=#hl-62-22>22</a>
</span><span class=lnt id=hl-62-23><a class=lnlinks href=#hl-62-23>23</a>
</span><span class=lnt id=hl-62-24><a class=lnlinks href=#hl-62-24>24</a>
</span><span class=lnt id=hl-62-25><a class=lnlinks href=#hl-62-25>25</a>
</span><span class=lnt id=hl-62-26><a class=lnlinks href=#hl-62-26>26</a>
</span><span class=lnt id=hl-62-27><a class=lnlinks href=#hl-62-27>27</a>
</span><span class=lnt id=hl-62-28><a class=lnlinks href=#hl-62-28>28</a>
</span><span class=lnt id=hl-62-29><a class=lnlinks href=#hl-62-29>29</a>
</span><span class=lnt id=hl-62-30><a class=lnlinks href=#hl-62-30>30</a>
</span><span class=lnt id=hl-62-31><a class=lnlinks href=#hl-62-31>31</a>
</span><span class=lnt id=hl-62-32><a class=lnlinks href=#hl-62-32>32</a>
</span><span class=lnt id=hl-62-33><a class=lnlinks href=#hl-62-33>33</a>
</span><span class=lnt id=hl-62-34><a class=lnlinks href=#hl-62-34>34</a>
</span><span class=lnt id=hl-62-35><a class=lnlinks href=#hl-62-35>35</a>
</span><span class=lnt id=hl-62-36><a class=lnlinks href=#hl-62-36>36</a>
</span><span class=lnt id=hl-62-37><a class=lnlinks href=#hl-62-37>37</a>
</span><span class=lnt id=hl-62-38><a class=lnlinks href=#hl-62-38>38</a>
</span><span class=lnt id=hl-62-39><a class=lnlinks href=#hl-62-39>39</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python에서 안전한 비밀번호 해싱</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>binascii</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hash_password</span><span class=p>(</span><span class=n>password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 솔트 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>salt</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 키 스트레칭을 통한 해싱</span>
</span></span><span class=line><span class=cl>    <span class=n>iterations</span> <span class=o>=</span> <span class=mi>100000</span>
</span></span><span class=line><span class=cl>    <span class=n>hash_bytes</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>pbkdf2_hmac</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;sha256&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>salt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>iterations</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 솔트와 해시 저장</span>
</span></span><span class=line><span class=cl>    <span class=n>storage</span> <span class=o>=</span> <span class=n>salt</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span> <span class=o>+</span> <span class=s1>&#39;:&#39;</span> <span class=o>+</span> <span class=n>binascii</span><span class=o>.</span><span class=n>hexlify</span><span class=p>(</span><span class=n>hash_bytes</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>storage</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify_password</span><span class=p>(</span><span class=n>stored_password</span><span class=p>,</span> <span class=n>provided_password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1># 저장된 비밀번호에서 솔트와 해시 추출</span>
</span></span><span class=line><span class=cl>    <span class=n>salt_hex</span><span class=p>,</span> <span class=n>hash_hex</span> <span class=o>=</span> <span class=n>stored_password</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>salt</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>salt_hex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 제공된 비밀번호 해싱</span>
</span></span><span class=line><span class=cl>    <span class=n>iterations</span> <span class=o>=</span> <span class=mi>100000</span>
</span></span><span class=line><span class=cl>    <span class=n>hash_bytes</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>pbkdf2_hmac</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;sha256&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>provided_password</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>salt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>iterations</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 해시 비교</span>
</span></span><span class=line><span class=cl>    <span class=n>calculated_hash_hex</span> <span class=o>=</span> <span class=n>binascii</span><span class=o>.</span><span class=n>hexlify</span><span class=p>(</span><span class=n>hash_bytes</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>hash_hex</span> <span class=o>==</span> <span class=n>calculated_hash_hex</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>전송 중 데이터 보호:<br>HTTPS, TLS, SSH 등 안전한 통신 프로토콜을 사용.</p></li><li><p>민감한 데이터 관리<br>민감한 정보는 필요한 기간 동안만 메모리에 보관하고 사용 후 즉시 제거:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-63-1><a class=lnlinks href=#hl-63-1> 1</a>
</span><span class=lnt id=hl-63-2><a class=lnlinks href=#hl-63-2> 2</a>
</span><span class=lnt id=hl-63-3><a class=lnlinks href=#hl-63-3> 3</a>
</span><span class=lnt id=hl-63-4><a class=lnlinks href=#hl-63-4> 4</a>
</span><span class=lnt id=hl-63-5><a class=lnlinks href=#hl-63-5> 5</a>
</span><span class=lnt id=hl-63-6><a class=lnlinks href=#hl-63-6> 6</a>
</span><span class=lnt id=hl-63-7><a class=lnlinks href=#hl-63-7> 7</a>
</span><span class=lnt id=hl-63-8><a class=lnlinks href=#hl-63-8> 8</a>
</span><span class=lnt id=hl-63-9><a class=lnlinks href=#hl-63-9> 9</a>
</span><span class=lnt id=hl-63-10><a class=lnlinks href=#hl-63-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Java에서 민감한 데이터 관리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 문자열 대신 char[] 사용</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>char</span><span class=o>[]</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getPasswordFromUser</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>authenticateUser</span><span class=p>(</span><span class=n>password</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 사용 후 즉시 비밀번호 초기화</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Arrays</span><span class=p>.</span><span class=na>fill</span><span class=p>(</span><span class=n>password</span><span class=p>,</span><span class=w> </span><span class=sc>&#39;0&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 오류 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ol><h4 id=세션-관리-및-인증>세션 관리 및 인증<a hidden class=anchor aria-hidden=true href=#세션-관리-및-인증>#</a></h4><p>안전한 세션 및 인증 관리 방법:</p><ol><li><p>강력한 세션 ID 생성</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-64-1><a class=lnlinks href=#hl-64-1> 1</a>
</span><span class=lnt id=hl-64-2><a class=lnlinks href=#hl-64-2> 2</a>
</span><span class=lnt id=hl-64-3><a class=lnlinks href=#hl-64-3> 3</a>
</span><span class=lnt id=hl-64-4><a class=lnlinks href=#hl-64-4> 4</a>
</span><span class=lnt id=hl-64-5><a class=lnlinks href=#hl-64-5> 5</a>
</span><span class=lnt id=hl-64-6><a class=lnlinks href=#hl-64-6> 6</a>
</span><span class=lnt id=hl-64-7><a class=lnlinks href=#hl-64-7> 7</a>
</span><span class=lnt id=hl-64-8><a class=lnlinks href=#hl-64-8> 8</a>
</span><span class=lnt id=hl-64-9><a class=lnlinks href=#hl-64-9> 9</a>
</span><span class=lnt id=hl-64-10><a class=lnlinks href=#hl-64-10>10</a>
</span><span class=lnt id=hl-64-11><a class=lnlinks href=#hl-64-11>11</a>
</span><span class=lnt id=hl-64-12><a class=lnlinks href=#hl-64-12>12</a>
</span><span class=lnt id=hl-64-13><a class=lnlinks href=#hl-64-13>13</a>
</span><span class=lnt id=hl-64-14><a class=lnlinks href=#hl-64-14>14</a>
</span><span class=lnt id=hl-64-15><a class=lnlinks href=#hl-64-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// PHP에서 안전한 세션 관리
</span></span></span><span class=line><span class=cl><span class=c1>// 세션 시작 전 보안 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>ini_set</span><span class=p>(</span><span class=s1>&#39;session.cookie_httponly&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>ini_set</span><span class=p>(</span><span class=s1>&#39;session.cookie_secure&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>ini_set</span><span class=p>(</span><span class=s1>&#39;session.use_only_cookies&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>ini_set</span><span class=p>(</span><span class=s1>&#39;session.cookie_samesite&#39;</span><span class=p>,</span> <span class=s1>&#39;Strict&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 세션 시작
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>session_start</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 새 세션일 경우 안전한 ID 재생성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span> <span class=p>(</span><span class=k>empty</span><span class=p>(</span><span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;initialized&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>session_regenerate_id</span><span class=p>(</span><span class=k>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;initialized&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>다중 인증 구현</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-65-1><a class=lnlinks href=#hl-65-1> 1</a>
</span><span class=lnt id=hl-65-2><a class=lnlinks href=#hl-65-2> 2</a>
</span><span class=lnt id=hl-65-3><a class=lnlinks href=#hl-65-3> 3</a>
</span><span class=lnt id=hl-65-4><a class=lnlinks href=#hl-65-4> 4</a>
</span><span class=lnt id=hl-65-5><a class=lnlinks href=#hl-65-5> 5</a>
</span><span class=lnt id=hl-65-6><a class=lnlinks href=#hl-65-6> 6</a>
</span><span class=lnt id=hl-65-7><a class=lnlinks href=#hl-65-7> 7</a>
</span><span class=lnt id=hl-65-8><a class=lnlinks href=#hl-65-8> 8</a>
</span><span class=lnt id=hl-65-9><a class=lnlinks href=#hl-65-9> 9</a>
</span><span class=lnt id=hl-65-10><a class=lnlinks href=#hl-65-10>10</a>
</span><span class=lnt id=hl-65-11><a class=lnlinks href=#hl-65-11>11</a>
</span><span class=lnt id=hl-65-12><a class=lnlinks href=#hl-65-12>12</a>
</span><span class=lnt id=hl-65-13><a class=lnlinks href=#hl-65-13>13</a>
</span><span class=lnt id=hl-65-14><a class=lnlinks href=#hl-65-14>14</a>
</span><span class=lnt id=hl-65-15><a class=lnlinks href=#hl-65-15>15</a>
</span><span class=lnt id=hl-65-16><a class=lnlinks href=#hl-65-16>16</a>
</span><span class=lnt id=hl-65-17><a class=lnlinks href=#hl-65-17>17</a>
</span><span class=lnt id=hl-65-18><a class=lnlinks href=#hl-65-18>18</a>
</span><span class=lnt id=hl-65-19><a class=lnlinks href=#hl-65-19>19</a>
</span><span class=lnt id=hl-65-20><a class=lnlinks href=#hl-65-20>20</a>
</span><span class=lnt id=hl-65-21><a class=lnlinks href=#hl-65-21>21</a>
</span><span class=lnt id=hl-65-22><a class=lnlinks href=#hl-65-22>22</a>
</span><span class=lnt id=hl-65-23><a class=lnlinks href=#hl-65-23>23</a>
</span><span class=lnt id=hl-65-24><a class=lnlinks href=#hl-65-24>24</a>
</span><span class=lnt id=hl-65-25><a class=lnlinks href=#hl-65-25>25</a>
</span><span class=lnt id=hl-65-26><a class=lnlinks href=#hl-65-26>26</a>
</span><span class=lnt id=hl-65-27><a class=lnlinks href=#hl-65-27>27</a>
</span><span class=lnt id=hl-65-28><a class=lnlinks href=#hl-65-28>28</a>
</span><span class=lnt id=hl-65-29><a class=lnlinks href=#hl-65-29>29</a>
</span><span class=lnt id=hl-65-30><a class=lnlinks href=#hl-65-30>30</a>
</span><span class=lnt id=hl-65-31><a class=lnlinks href=#hl-65-31>31</a>
</span><span class=lnt id=hl-65-32><a class=lnlinks href=#hl-65-32>32</a>
</span><span class=lnt id=hl-65-33><a class=lnlinks href=#hl-65-33>33</a>
</span><span class=lnt id=hl-65-34><a class=lnlinks href=#hl-65-34>34</a>
</span><span class=lnt id=hl-65-35><a class=lnlinks href=#hl-65-35>35</a>
</span><span class=lnt id=hl-65-36><a class=lnlinks href=#hl-65-36>36</a>
</span><span class=lnt id=hl-65-37><a class=lnlinks href=#hl-65-37>37</a>
</span><span class=lnt id=hl-65-38><a class=lnlinks href=#hl-65-38>38</a>
</span><span class=lnt id=hl-65-39><a class=lnlinks href=#hl-65-39>39</a>
</span><span class=lnt id=hl-65-40><a class=lnlinks href=#hl-65-40>40</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Python Flask에서 2단계 인증 구현</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pyotp</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>user</span> <span class=o>=</span> <span class=n>authenticate_credentials</span><span class=p>(</span><span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>user</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;login.html&#39;</span><span class=p>,</span> <span class=n>error</span><span class=o>=</span><span class=s1>&#39;Invalid credentials&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 사용자가 2FA를 활성화했는지 확인</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>user</span><span class=o>.</span><span class=n>two_factor_enabled</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 세션에 사용자 ID 저장하고 2FA 인증 페이지로 리디렉션</span>
</span></span><span class=line><span class=cl>        <span class=n>session</span><span class=p>[</span><span class=s1>&#39;pending_user_id&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>user</span><span class=o>.</span><span class=n>id</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;two_factor_auth&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># 2FA가 활성화되지 않은 경우 바로 로그인</span>
</span></span><span class=line><span class=cl>    <span class=n>login_user</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;dashboard&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/2fa&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>two_factor_auth</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s1>&#39;pending_user_id&#39;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>session</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;login&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>method</span> <span class=o>==</span> <span class=s1>&#39;POST&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=n>User</span><span class=o>.</span><span class=n>query</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>session</span><span class=p>[</span><span class=s1>&#39;pending_user_id&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>totp</span> <span class=o>=</span> <span class=n>pyotp</span><span class=o>.</span><span class=n>TOTP</span><span class=p>(</span><span class=n>user</span><span class=o>.</span><span class=n>otp_secret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>totp</span><span class=o>.</span><span class=n>verify</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>form</span><span class=p>[</span><span class=s1>&#39;otp_code&#39;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>            <span class=c1># 2FA 성공</span>
</span></span><span class=line><span class=cl>            <span class=k>del</span> <span class=n>session</span><span class=p>[</span><span class=s1>&#39;pending_user_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>login_user</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;dashboard&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;2fa.html&#39;</span><span class=p>,</span> <span class=n>error</span><span class=o>=</span><span class=s1>&#39;Invalid code&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s1>&#39;2fa.html&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>안전한 비밀번호 정책 시행</p><ul><li>최소 길이 요구</li><li>대소문자, 숫자, 특수 문자 조합 필요</li><li>흔한 비밀번호 및 이전에 사용한 비밀번호 거부</li><li>정기적인 비밀번호 변경 유도 (단, 너무 자주 변경 요구하지 않음)</li></ul></li></ol><h4 id=안전한-코딩-관련-조직-및-표준>안전한 코딩 관련 조직 및 표준<a hidden class=anchor aria-hidden=true href=#안전한-코딩-관련-조직-및-표준>#</a></h4><p>보안 코딩과 관련된 주요 조직 및 표준:</p><ol><li><strong>OWASP (Open Web Application Security Project)</strong>: 웹 애플리케이션 보안 커뮤니티로, 보안 위험 Top 10 목록, 테스트 가이드, 코드 리뷰 가이드 등을 제공.</li><li><strong>NIST (National Institute of Standards and Technology)</strong>: 미국 표준 기술 연구소로, 사이버 보안 프레임워크 및 가이드라인을 발표.</li><li><strong>ISO/IEC 27034</strong>: 애플리케이션 보안에 관한 국제 표준.</li><li><strong>CERT Secure Coding Standards</strong>: 다양한 프로그래밍 언어에 대한 보안 코딩 표준과 가이드라인을 제공.</li><li><strong>CWE (Common Weakness Enumeration)</strong>: 소프트웨어 보안 취약점의 공통 언어를 제공하는 목록. 개발자들이 코드에서 발생할 수 있는 일반적인 취약점을 이해하고 방지하는 데 도움을 준다.</li><li><strong>SANS (SysAdmin, Audit, Network, Security)</strong>: 정보 보안 연구 및 교육 기관으로, 보안 코딩 지침과 교육 프로그램을 제공한다.</li><li><strong>PCI DSS (Payment Card Industry Data Security Standard)</strong>: 신용카드 정보를 처리하는 모든 기업이 준수해야 하는 보안 표준.</li><li><strong>GDPR (General Data Protection Regulation)</strong>: 유럽연합의 개인정보 보호 규정으로, 소프트웨어 개발에서 데이터 보호 및 개인정보 처리에 관한 요구사항을 규정한다.</li></ol><h4 id=devsecops-개발-수명-주기에-보안-통합>DevSecOps: 개발 수명 주기에 보안 통합<a hidden class=anchor aria-hidden=true href=#devsecops-개발-수명-주기에-보안-통합>#</a></h4><p>DevSecOps 는 개발, 보안, 운영 팀이 협력하여 소프트웨어 개발 수명 주기 전반에 걸쳐 보안을 통합하는 방식:</p><ol><li><p>계획 및 요구사항 단계</p><ul><li>보안 요구사항 정의</li><li>위협 모델링 수행</li><li>보안 사용 사례 개발</li></ul></li><li><p>개발 단계</p><ul><li>안전한 코딩 표준 적용</li><li>개발자 보안 교육</li><li>정적 코드 분석 도구 통합</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-66-1><a class=lnlinks href=#hl-66-1> 1</a>
</span><span class=lnt id=hl-66-2><a class=lnlinks href=#hl-66-2> 2</a>
</span><span class=lnt id=hl-66-3><a class=lnlinks href=#hl-66-3> 3</a>
</span><span class=lnt id=hl-66-4><a class=lnlinks href=#hl-66-4> 4</a>
</span><span class=lnt id=hl-66-5><a class=lnlinks href=#hl-66-5> 5</a>
</span><span class=lnt id=hl-66-6><a class=lnlinks href=#hl-66-6> 6</a>
</span><span class=lnt id=hl-66-7><a class=lnlinks href=#hl-66-7> 7</a>
</span><span class=lnt id=hl-66-8><a class=lnlinks href=#hl-66-8> 8</a>
</span><span class=lnt id=hl-66-9><a class=lnlinks href=#hl-66-9> 9</a>
</span><span class=lnt id=hl-66-10><a class=lnlinks href=#hl-66-10>10</a>
</span><span class=lnt id=hl-66-11><a class=lnlinks href=#hl-66-11>11</a>
</span><span class=lnt id=hl-66-12><a class=lnlinks href=#hl-66-12>12</a>
</span><span class=lnt id=hl-66-13><a class=lnlinks href=#hl-66-13>13</a>
</span><span class=lnt id=hl-66-14><a class=lnlinks href=#hl-66-14>14</a>
</span><span class=lnt id=hl-66-15><a class=lnlinks href=#hl-66-15>15</a>
</span><span class=lnt id=hl-66-16><a class=lnlinks href=#hl-66-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># GitLab CI/CD 파이프라인에 정적 분석 통합 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>stages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>security</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>deploy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>security-scan</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>security</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>npm audit </span><span class=w> </span><span class=c># Node.js 종속성 검사</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sonar-scanner </span><span class=w> </span><span class=c># SonarQube 분석</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>owasp-dependency-check </span><span class=w> </span><span class=c># OWASP 종속성 검사</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>artifacts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>security-reports/</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>테스트 단계</p><ul><li>자동화된 보안 테스트 수행</li><li>침투 테스트</li><li>취약점 스캐닝</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-67-1><a class=lnlinks href=#hl-67-1>1</a>
</span><span class=lnt id=hl-67-2><a class=lnlinks href=#hl-67-2>2</a>
</span><span class=lnt id=hl-67-3><a class=lnlinks href=#hl-67-3>3</a>
</span><span class=lnt id=hl-67-4><a class=lnlinks href=#hl-67-4>4</a>
</span><span class=lnt id=hl-67-5><a class=lnlinks href=#hl-67-5>5</a>
</span><span class=lnt id=hl-67-6><a class=lnlinks href=#hl-67-6>6</a>
</span><span class=lnt id=hl-67-7><a class=lnlinks href=#hl-67-7>7</a>
</span><span class=lnt id=hl-67-8><a class=lnlinks href=#hl-67-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># GitLab CI/CD에 동적 보안 테스트 통합</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>dynamic-security</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>security</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zap-baseline.py -t https://staging-app.example.com </span><span class=w> </span><span class=c># OWASP ZAP 스캔</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>nikto -h https://staging-app.example.com </span><span class=w> </span><span class=c># Nikto 스캔</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>only</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>master</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>배포 단계</p><ul><li>안전한 배포 프로세스</li><li>인프라 보안 검사</li><li>비밀 관리 자동화</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-68-1><a class=lnlinks href=#hl-68-1>1</a>
</span><span class=lnt id=hl-68-2><a class=lnlinks href=#hl-68-2>2</a>
</span><span class=lnt id=hl-68-3><a class=lnlinks href=#hl-68-3>3</a>
</span><span class=lnt id=hl-68-4><a class=lnlinks href=#hl-68-4>4</a>
</span><span class=lnt id=hl-68-5><a class=lnlinks href=#hl-68-5>5</a>
</span><span class=lnt id=hl-68-6><a class=lnlinks href=#hl-68-6>6</a>
</span><span class=lnt id=hl-68-7><a class=lnlinks href=#hl-68-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># Docker 이미지 보안 스캔</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>container-scan</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stage</span><span class=p>:</span><span class=w> </span><span class=l>security</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>script</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>trivy image myapp:latest </span><span class=w> </span><span class=c># 컨테이너 취약점 스캔</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>only</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>master</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>모니터링 및 대응 단계</p><ul><li>보안 모니터링 및 로깅</li><li>자동화된 보안 인시던트 대응</li><li>정기적인 보안 감사</li></ul></li></ol><h4 id=보안-코딩-교육-및-문화>보안 코딩 교육 및 문화<a hidden class=anchor aria-hidden=true href=#보안-코딩-교육-및-문화>#</a></h4><p>조직 내 보안 코딩 문화를 구축하기 위한 방법:</p><ol><li><p>개발자 교육<br>정기적인 보안 코딩 교육과 훈련을 제공:</p><ul><li>보안 코딩 워크샵</li><li>온라인 학습 플랫폼</li><li>CTF(Capture The Flag) 경진대회</li><li>코드 리뷰 세션</li></ul></li><li><p>보안 챔피언 프로그램<br>각 개발 팀에 보안 챔피언을 지정하여 보안 관행을 촉진:</p><ul><li>보안 코드 리뷰 수행</li><li>팀 내 보안 지식 공유</li><li>보안 관련 질문에 대한 첫 번째 연락 지점 역할</li></ul></li><li><p>지속적인 보안 평가<br>애플리케이션 보안을 지속적으로 평가하고 개선:</p><ul><li>정기적인 보안 감사</li><li>자동화된 보안 스캔</li><li>침투 테스트</li><li>버그 바운티 프로그램</li></ul></li><li><p>보안 코딩 가이드라인<br>조직에 맞는 보안 코딩 가이드라인을 개발:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-69-1><a class=lnlinks href=#hl-69-1> 1</a>
</span><span class=lnt id=hl-69-2><a class=lnlinks href=#hl-69-2> 2</a>
</span><span class=lnt id=hl-69-3><a class=lnlinks href=#hl-69-3> 3</a>
</span><span class=lnt id=hl-69-4><a class=lnlinks href=#hl-69-4> 4</a>
</span><span class=lnt id=hl-69-5><a class=lnlinks href=#hl-69-5> 5</a>
</span><span class=lnt id=hl-69-6><a class=lnlinks href=#hl-69-6> 6</a>
</span><span class=lnt id=hl-69-7><a class=lnlinks href=#hl-69-7> 7</a>
</span><span class=lnt id=hl-69-8><a class=lnlinks href=#hl-69-8> 8</a>
</span><span class=lnt id=hl-69-9><a class=lnlinks href=#hl-69-9> 9</a>
</span><span class=lnt id=hl-69-10><a class=lnlinks href=#hl-69-10>10</a>
</span><span class=lnt id=hl-69-11><a class=lnlinks href=#hl-69-11>11</a>
</span><span class=lnt id=hl-69-12><a class=lnlinks href=#hl-69-12>12</a>
</span><span class=lnt id=hl-69-13><a class=lnlinks href=#hl-69-13>13</a>
</span><span class=lnt id=hl-69-14><a class=lnlinks href=#hl-69-14>14</a>
</span><span class=lnt id=hl-69-15><a class=lnlinks href=#hl-69-15>15</a>
</span><span class=lnt id=hl-69-16><a class=lnlinks href=#hl-69-16>16</a>
</span><span class=lnt id=hl-69-17><a class=lnlinks href=#hl-69-17>17</a>
</span><span class=lnt id=hl-69-18><a class=lnlinks href=#hl-69-18>18</a>
</span><span class=lnt id=hl-69-19><a class=lnlinks href=#hl-69-19>19</a>
</span><span class=lnt id=hl-69-20><a class=lnlinks href=#hl-69-20>20</a>
</span><span class=lnt id=hl-69-21><a class=lnlinks href=#hl-69-21>21</a>
</span><span class=lnt id=hl-69-22><a class=lnlinks href=#hl-69-22>22</a>
</span><span class=lnt id=hl-69-23><a class=lnlinks href=#hl-69-23>23</a>
</span><span class=lnt id=hl-69-24><a class=lnlinks href=#hl-69-24>24</a>
</span><span class=lnt id=hl-69-25><a class=lnlinks href=#hl-69-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># 회사 보안 코딩 가이드라인 예시
</span></span></span><span class=line><span class=cl><span class=gh></span>
</span></span><span class=line><span class=cl><span class=gu>## 1. 입력 검증
</span></span></span><span class=line><span class=cl><span class=gu></span><span class=k>-</span> 모든 사용자 입력은 서버 측에서 유효성을 검사해야 합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 문자열에는 허용 목록(allowlist) 접근 방식을 사용합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 숫자형 데이터는 범위를 검사합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 파일 업로드는 확장자, 크기, 콘텐츠 유형을 검증합니다.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>## 2. 데이터베이스 접근
</span></span></span><span class=line><span class=cl><span class=gu></span><span class=k>-</span> ORM 또는 매개변수화된 쿼리를 사용합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 직접 문자열 연결로 쿼리를 구성하지 않습니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 최소 권한 데이터베이스 계정을 사용합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 민감한 데이터는 항상 암호화합니다.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>## 3. 인증 및 세션 관리
</span></span></span><span class=line><span class=cl><span class=gu></span><span class=k>-</span> 다중 요소 인증을 지원합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 패스워드는 최소 12자리 이상이어야 합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 세션 ID는 URL에 노출되지 않아야 합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 세션 타임아웃을 적절하게 설정합니다.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>## 4. 암호화
</span></span></span><span class=line><span class=cl><span class=gu></span><span class=k>-</span> 최신 암호화 알고리즘과 라이브러리를 사용합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 자체 암호화 알고리즘을 만들지 않습니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 암호화 키는 안전하게 관리합니다.
</span></span><span class=line><span class=cl><span class=k>-</span> 전송 중인 모든 데이터에 TLS를 사용합니다.
</span></span></code></pre></td></tr></table></div></div></li></ol><hr><h3 id=참고-및-출처-2>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-2>#</a></h3></div></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>