<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Real-time APIs | hyunyoun's Blog</title>
<meta name=keywords content="Backend,API-Design,Real-time-APIs"><meta name=description content="실시간 API(Real-time API)는 클라이언트와 서버 간에 지속적인 연결을 유지하면서 데이터가 생성되거나 변경되는 즉시 자동으로 전송하는 API이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/networking/real-time-apis/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/networking/real-time-apis/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/networking/real-time-apis/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/networking/real-time-apis/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Real-time APIs"><meta property="og:description" content="실시간 API(Real-time API)는 클라이언트와 서버 간에 지속적인 연결을 유지하면서 데이터가 생성되거나 변경되는 즉시 자동으로 전송하는 API이다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Real-time APIs"><meta name=twitter:description content="실시간 API(Real-time API)는 클라이언트와 서버 간에 지속적인 연결을 유지하면서 데이터가 생성되거나 변경되는 즉시 자동으로 전송하는 API이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"기술 블로그","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Network","item":"https://buenhyden.github.io/posts/networking/"},{"@type":"ListItem","position":3,"name":"Real-time APIs","item":"https://buenhyden.github.io/posts/networking/real-time-apis/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>기술 블로그</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/networking/>Network</a></div><h1>Real-time APIs</h1><div class=post-description>실시간 API(Real-time API)는 클라이언트와 서버 간에 지속적인 연결을 유지하면서 데이터가 생성되거나 변경되는 즉시 자동으로 전송하는 API이다.</div></header><div class=post-content><h2 id=real-time-apis>Real-time APIs<a hidden class=anchor aria-hidden=true href=#real-time-apis>#</a></h2><h3 id=실시간-api의-개념과-중요성>실시간 API의 개념과 중요성<a hidden class=anchor aria-hidden=true href=#실시간-api의-개념과-중요성>#</a></h3><h4 id=실시간-api란-무엇인가>실시간 API란 무엇인가?<a hidden class=anchor aria-hidden=true href=#실시간-api란-무엇인가>#</a></h4><p>실시간 API(Real-time API)는 클라이언트와 서버 간에 지속적인 연결을 유지하면서 데이터가 생성되거나 변경되는 즉시 자동으로 전송하는 API이다. 전통적인 RESTful API가 요청-응답 모델에 기반하여 클라이언트가 데이터를 명시적으로 요청해야 하는 것과 달리, 실시간 API는 새로운 정보가 발생하면 서버에서 클라이언트로 즉시 푸시(push)된다.</p><h4 id=왜-실시간-api가-중요한가>왜 실시간 API가 중요한가?<a hidden class=anchor aria-hidden=true href=#왜-실시간-api가-중요한가>#</a></h4><p>실시간 API는 다음과 같은 이유로 현대 애플리케이션 개발에서 중요한 위치를 차지한다:</p><ol><li><strong>즉각적인 사용자 경험</strong>: 사용자는 최신 데이터를 즉시 볼 수 있어 더 나은 사용자 경험을 제공한다.</li><li><strong>리소스 효율성</strong>: 주기적인 폴링(polling)에 비해 네트워크 트래픽과 서버 부하를 줄일 수 있다.</li><li><strong>양방향 통신</strong>: 클라이언트와 서버 간의 양방향 데이터 흐름을 지원한다.</li><li><strong>확장성</strong>: 최신 실시간 기술은 수많은 동시 연결을 효율적으로 처리할 수 있다.</li></ol><h3 id=실시간-api-기술-및-프로토콜>실시간 API 기술 및 프로토콜<a hidden class=anchor aria-hidden=true href=#실시간-api-기술-및-프로토콜>#</a></h3><p>실시간 API를 구현하기 위한 다양한 기술과 프로토콜이 있으며, 각각 고유한 특성과 장단점을 가지고 있다.</p><h4 id=websocket>WebSocket<a hidden class=anchor aria-hidden=true href=#websocket>#</a></h4><p>WebSocket은 가장 널리 사용되는 실시간 통신 프로토콜로, HTTP를 통해 초기 핸드셰이크를 수행한 후 지속적인 양방향 통신 채널을 설정한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21>21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22>22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23>23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24>24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25>25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26>26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 클라이언트 측 WebSocket 구현 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>socket</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>WebSocket</span><span class=p>(</span><span class=s1>&#39;wss://api.example.com/realtime&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 연결 이벤트 처리
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>socket</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;open&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;WebSocket 연결이 열렸습니다&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>socket</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;subscribe&#39;</span><span class=p>,</span> <span class=nx>channel</span><span class=o>:</span> <span class=s1>&#39;updates&#39;</span> <span class=p>}));</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 메시지 수신 처리
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>socket</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;message&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;서버로부터 메시지 수신:&#39;</span><span class=p>,</span> <span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>updateUI</span><span class=p>(</span><span class=nx>data</span><span class=p>);</span> <span class=c1>// UI 업데이트 함수
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 오류 처리
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>socket</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;error&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;WebSocket 오류 발생:&#39;</span><span class=p>,</span> <span class=nx>event</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 연결 종료 처리
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>socket</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;close&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;WebSocket 연결이 닫혔습니다&#39;</span><span class=p>,</span> <span class=nx>event</span><span class=p>.</span><span class=nx>code</span><span class=p>,</span> <span class=nx>event</span><span class=p>.</span><span class=nx>reason</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 재연결 로직 구현
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>connectWebSocket</span><span class=p>,</span> <span class=mi>5000</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>장점</strong>:</p><ul><li>낮은 지연 시간과 오버헤드</li><li>양방향 전이중(full-duplex) 통신</li><li>대부분의 브라우저와 플랫폼에서 지원</li></ul><p><strong>단점</strong>:</p><ul><li>복잡한 프록시와 로드 밸런서 설정 필요</li><li>연결 관리와 재연결 로직을 직접 구현해야 함</li></ul><h4 id=server-sent-events-sse>Server-Sent Events (SSE)<a hidden class=anchor aria-hidden=true href=#server-sent-events-sse>#</a></h4><p>SSE는 서버에서 클라이언트로의 단방향 통신을 위한 간단한 프로토콜로, 표준 HTTP 연결을 통해 서버에서 클라이언트로 데이터를 스트리밍한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16>16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17>17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18>18</a>
</span><span class=lnt id=hl-1-19><a class=lnlinks href=#hl-1-19>19</a>
</span><span class=lnt id=hl-1-20><a class=lnlinks href=#hl-1-20>20</a>
</span><span class=lnt id=hl-1-21><a class=lnlinks href=#hl-1-21>21</a>
</span><span class=lnt id=hl-1-22><a class=lnlinks href=#hl-1-22>22</a>
</span><span class=lnt id=hl-1-23><a class=lnlinks href=#hl-1-23>23</a>
</span><span class=lnt id=hl-1-24><a class=lnlinks href=#hl-1-24>24</a>
</span><span class=lnt id=hl-1-25><a class=lnlinks href=#hl-1-25>25</a>
</span><span class=lnt id=hl-1-26><a class=lnlinks href=#hl-1-26>26</a>
</span><span class=lnt id=hl-1-27><a class=lnlinks href=#hl-1-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 클라이언트 측 SSE 구현 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>eventSource</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>EventSource</span><span class=p>(</span><span class=s1>&#39;https://api.example.com/events&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 메시지 수신 처리
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>eventSource</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;message&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;이벤트 수신:&#39;</span><span class=p>,</span> <span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>updateUI</span><span class=p>(</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 특정 이벤트 타입 처리
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>eventSource</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;update&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>updateData</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;업데이트 이벤트:&#39;</span><span class=p>,</span> <span class=nx>updateData</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>handleUpdate</span><span class=p>(</span><span class=nx>updateData</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 오류 처리
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>eventSource</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;error&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;SSE 오류 발생:&#39;</span><span class=p>,</span> <span class=nx>event</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>eventSource</span><span class=p>.</span><span class=nx>readyState</span> <span class=o>===</span> <span class=nx>EventSource</span><span class=p>.</span><span class=nx>CLOSED</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 연결이 닫힌 경우 재연결 시도
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=nx>EventSource</span><span class=p>(</span><span class=s1>&#39;https://api.example.com/events&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span> <span class=mi>5000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>장점</strong>:</p><ul><li>구현이 간단하고 HTTP를 통해 동작</li><li>자동 재연결 메커니즘 내장</li><li>방화벽 친화적</li></ul><p><strong>단점</strong>:</p><ul><li>단방향 통신만 지원 (서버 → 클라이언트)</li><li>IE에서는 기본적으로 지원되지 않음</li></ul><h4 id=http-long-polling>HTTP Long Polling<a hidden class=anchor aria-hidden=true href=#http-long-polling>#</a></h4><p>Long Polling은 전통적인 폴링의 효율성을 개선한 기법으로, 클라이언트가 서버에 요청을 보내고 새로운 데이터가 있을 때까지 연결을 유지한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span><span class=lnt id=hl-2-21><a class=lnlinks href=#hl-2-21>21</a>
</span><span class=lnt id=hl-2-22><a class=lnlinks href=#hl-2-22>22</a>
</span><span class=lnt id=hl-2-23><a class=lnlinks href=#hl-2-23>23</a>
</span><span class=lnt id=hl-2-24><a class=lnlinks href=#hl-2-24>24</a>
</span><span class=lnt id=hl-2-25><a class=lnlinks href=#hl-2-25>25</a>
</span><span class=lnt id=hl-2-26><a class=lnlinks href=#hl-2-26>26</a>
</span><span class=lnt id=hl-2-27><a class=lnlinks href=#hl-2-27>27</a>
</span><span class=lnt id=hl-2-28><a class=lnlinks href=#hl-2-28>28</a>
</span><span class=lnt id=hl-2-29><a class=lnlinks href=#hl-2-29>29</a>
</span><span class=lnt id=hl-2-30><a class=lnlinks href=#hl-2-30>30</a>
</span><span class=lnt id=hl-2-31><a class=lnlinks href=#hl-2-31>31</a>
</span><span class=lnt id=hl-2-32><a class=lnlinks href=#hl-2-32>32</a>
</span><span class=lnt id=hl-2-33><a class=lnlinks href=#hl-2-33>33</a>
</span><span class=lnt id=hl-2-34><a class=lnlinks href=#hl-2-34>34</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 클라이언트 측 Long Polling 구현 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>longPoll</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;https://api.example.com/poll&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;GET&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/json&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;Last-Event-ID&#39;</span><span class=o>:</span> <span class=nx>lastEventId</span> <span class=c1>// 마지막으로 수신한 이벤트 ID
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>credentials</span><span class=o>:</span> <span class=s1>&#39;include&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>response</span> <span class=p>=&gt;</span> <span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>())</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>data</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 데이터 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;데이터 수신:&#39;</span><span class=p>,</span> <span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>events</span> <span class=o>&amp;&amp;</span> <span class=nx>data</span><span class=p>.</span><span class=nx>events</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 이벤트 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>data</span><span class=p>.</span><span class=nx>events</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>event</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>handleEvent</span><span class=p>(</span><span class=nx>event</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>lastEventId</span> <span class=o>=</span> <span class=nx>event</span><span class=p>.</span><span class=nx>id</span><span class=p>;</span> <span class=c1>// 마지막 이벤트 ID 업데이트
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 즉시 다음 Long Poll 요청 시작
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>longPoll</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=k>catch</span><span class=p>(</span><span class=nx>error</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Long Polling 오류:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 오류 발생 시 잠시 대기 후 재시도
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>longPoll</span><span class=p>,</span> <span class=mi>5000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 초기 Long Polling 시작
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>longPoll</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>장점</strong>:</p><ul><li>거의 모든 브라우저와 환경에서 동작</li><li>기존 HTTP 인프라와 호환성이 좋음</li></ul><p><strong>단점</strong>:</p><ul><li>잦은 연결 설정/해제로 인한 오버헤드</li><li>많은 동시 연결 시 서버 리소스 소모가 큼</li></ul><h4 id=graphql-subscriptions>GraphQL Subscriptions<a hidden class=anchor aria-hidden=true href=#graphql-subscriptions>#</a></h4><p>GraphQL은 쿼리 언어이지만, Subscriptions 기능을 통해 실시간 데이터 업데이트를 제공한다. 일반적으로 WebSocket 위에 구현된다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16>16</a>
</span><span class=lnt id=hl-3-17><a class=lnlinks href=#hl-3-17>17</a>
</span><span class=lnt id=hl-3-18><a class=lnlinks href=#hl-3-18>18</a>
</span><span class=lnt id=hl-3-19><a class=lnlinks href=#hl-3-19>19</a>
</span><span class=lnt id=hl-3-20><a class=lnlinks href=#hl-3-20>20</a>
</span><span class=lnt id=hl-3-21><a class=lnlinks href=#hl-3-21>21</a>
</span><span class=lnt id=hl-3-22><a class=lnlinks href=#hl-3-22>22</a>
</span><span class=lnt id=hl-3-23><a class=lnlinks href=#hl-3-23>23</a>
</span><span class=lnt id=hl-3-24><a class=lnlinks href=#hl-3-24>24</a>
</span><span class=lnt id=hl-3-25><a class=lnlinks href=#hl-3-25>25</a>
</span><span class=lnt id=hl-3-26><a class=lnlinks href=#hl-3-26>26</a>
</span><span class=lnt id=hl-3-27><a class=lnlinks href=#hl-3-27>27</a>
</span><span class=lnt id=hl-3-28><a class=lnlinks href=#hl-3-28>28</a>
</span><span class=lnt id=hl-3-29><a class=lnlinks href=#hl-3-29>29</a>
</span><span class=lnt id=hl-3-30><a class=lnlinks href=#hl-3-30>30</a>
</span><span class=lnt id=hl-3-31><a class=lnlinks href=#hl-3-31>31</a>
</span><span class=lnt id=hl-3-32><a class=lnlinks href=#hl-3-32>32</a>
</span><span class=lnt id=hl-3-33><a class=lnlinks href=#hl-3-33>33</a>
</span><span class=lnt id=hl-3-34><a class=lnlinks href=#hl-3-34>34</a>
</span><span class=lnt id=hl-3-35><a class=lnlinks href=#hl-3-35>35</a>
</span><span class=lnt id=hl-3-36><a class=lnlinks href=#hl-3-36>36</a>
</span><span class=lnt id=hl-3-37><a class=lnlinks href=#hl-3-37>37</a>
</span><span class=lnt id=hl-3-38><a class=lnlinks href=#hl-3-38>38</a>
</span><span class=lnt id=hl-3-39><a class=lnlinks href=#hl-3-39>39</a>
</span><span class=lnt id=hl-3-40><a class=lnlinks href=#hl-3-40>40</a>
</span><span class=lnt id=hl-3-41><a class=lnlinks href=#hl-3-41>41</a>
</span><span class=lnt id=hl-3-42><a class=lnlinks href=#hl-3-42>42</a>
</span><span class=lnt id=hl-3-43><a class=lnlinks href=#hl-3-43>43</a>
</span><span class=lnt id=hl-3-44><a class=lnlinks href=#hl-3-44>44</a>
</span><span class=lnt id=hl-3-45><a class=lnlinks href=#hl-3-45>45</a>
</span><span class=lnt id=hl-3-46><a class=lnlinks href=#hl-3-46>46</a>
</span><span class=lnt id=hl-3-47><a class=lnlinks href=#hl-3-47>47</a>
</span><span class=lnt id=hl-3-48><a class=lnlinks href=#hl-3-48>48</a>
</span><span class=lnt id=hl-3-49><a class=lnlinks href=#hl-3-49>49</a>
</span><span class=lnt id=hl-3-50><a class=lnlinks href=#hl-3-50>50</a>
</span><span class=lnt id=hl-3-51><a class=lnlinks href=#hl-3-51>51</a>
</span><span class=lnt id=hl-3-52><a class=lnlinks href=#hl-3-52>52</a>
</span><span class=lnt id=hl-3-53><a class=lnlinks href=#hl-3-53>53</a>
</span><span class=lnt id=hl-3-54><a class=lnlinks href=#hl-3-54>54</a>
</span><span class=lnt id=hl-3-55><a class=lnlinks href=#hl-3-55>55</a>
</span><span class=lnt id=hl-3-56><a class=lnlinks href=#hl-3-56>56</a>
</span><span class=lnt id=hl-3-57><a class=lnlinks href=#hl-3-57>57</a>
</span><span class=lnt id=hl-3-58><a class=lnlinks href=#hl-3-58>58</a>
</span><span class=lnt id=hl-3-59><a class=lnlinks href=#hl-3-59>59</a>
</span><span class=lnt id=hl-3-60><a class=lnlinks href=#hl-3-60>60</a>
</span><span class=lnt id=hl-3-61><a class=lnlinks href=#hl-3-61>61</a>
</span><span class=lnt id=hl-3-62><a class=lnlinks href=#hl-3-62>62</a>
</span><span class=lnt id=hl-3-63><a class=lnlinks href=#hl-3-63>63</a>
</span><span class=lnt id=hl-3-64><a class=lnlinks href=#hl-3-64>64</a>
</span><span class=lnt id=hl-3-65><a class=lnlinks href=#hl-3-65>65</a>
</span><span class=lnt id=hl-3-66><a class=lnlinks href=#hl-3-66>66</a>
</span><span class=lnt id=hl-3-67><a class=lnlinks href=#hl-3-67>67</a>
</span><span class=lnt id=hl-3-68><a class=lnlinks href=#hl-3-68>68</a>
</span><span class=lnt id=hl-3-69><a class=lnlinks href=#hl-3-69>69</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Apollo Client를 사용한 GraphQL Subscription 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>ApolloClient</span><span class=p>,</span> <span class=nx>InMemoryCache</span><span class=p>,</span> <span class=nx>HttpLink</span><span class=p>,</span> <span class=nx>split</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@apollo/client&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>WebSocketLink</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@apollo/client/link/ws&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>getMainDefinition</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@apollo/client/utilities&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>SubscriptionClient</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;subscriptions-transport-ws&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// HTTP 링크 설정 (일반 쿼리 및 뮤테이션용)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>httpLink</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>HttpLink</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>uri</span><span class=o>:</span> <span class=s1>&#39;https://api.example.com/graphql&#39;</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// WebSocket 링크 설정 (구독용)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>wsLink</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>WebSocketLink</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=k>new</span> <span class=nx>SubscriptionClient</span><span class=p>(</span><span class=s1>&#39;wss://api.example.com/graphql&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>reconnect</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>connectionParams</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>authToken</span><span class=o>:</span> <span class=nx>localStorage</span><span class=p>.</span><span class=nx>getItem</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 요청 유형에 따라 적절한 링크 선택
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>splitLink</span> <span class=o>=</span> <span class=nx>split</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=p>({</span> <span class=nx>query</span> <span class=p>})</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>definition</span> <span class=o>=</span> <span class=nx>getMainDefinition</span><span class=p>(</span><span class=nx>query</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=nx>definition</span><span class=p>.</span><span class=nx>kind</span> <span class=o>===</span> <span class=s1>&#39;OperationDefinition&#39;</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>      <span class=nx>definition</span><span class=p>.</span><span class=nx>operation</span> <span class=o>===</span> <span class=s1>&#39;subscription&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nx>wsLink</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>httpLink</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Apollo 클라이언트 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>client</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>ApolloClient</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>link</span><span class=o>:</span> <span class=nx>splitLink</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>cache</span><span class=o>:</span> <span class=k>new</span> <span class=nx>InMemoryCache</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 구독 실행
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>MESSAGES_SUBSCRIPTION</span> <span class=o>=</span> <span class=nx>gql</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>  subscription OnNewMessage {
</span></span></span><span class=line><span class=cl><span class=sb>    messageAdded {
</span></span></span><span class=line><span class=cl><span class=sb>      id
</span></span></span><span class=line><span class=cl><span class=sb>      content
</span></span></span><span class=line><span class=cl><span class=sb>      user {
</span></span></span><span class=line><span class=cl><span class=sb>        id
</span></span></span><span class=line><span class=cl><span class=sb>        name
</span></span></span><span class=line><span class=cl><span class=sb>      }
</span></span></span><span class=line><span class=cl><span class=sb>    }
</span></span></span><span class=line><span class=cl><span class=sb>  }
</span></span></span><span class=line><span class=cl><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 컴포넌트에서 구독 사용
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>ChatComponent</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>data</span><span class=p>,</span> <span class=nx>loading</span><span class=p>,</span> <span class=nx>error</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>useSubscription</span><span class=p>(</span><span class=nx>MESSAGES_SUBSCRIPTION</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>loading</span><span class=p>)</span> <span class=k>return</span> <span class=o>&lt;</span><span class=nx>p</span><span class=o>&gt;</span><span class=nx>Loading</span><span class=p>...</span><span class=o>&lt;</span><span class=err>/p&gt;;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=k>return</span> <span class=o>&lt;</span><span class=nx>p</span><span class=o>&gt;</span><span class=nb>Error</span><span class=o>:</span> <span class=p>{</span><span class=nx>error</span><span class=p>.</span><span class=nx>message</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/p&gt;;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=nx>div</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>h3</span><span class=o>&gt;</span><span class=nx>New</span> <span class=nx>Message</span><span class=o>:&lt;</span><span class=err>/h3&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>p</span><span class=o>&gt;</span><span class=p>{</span><span class=nx>data</span><span class=p>.</span><span class=nx>messageAdded</span><span class=p>.</span><span class=nx>content</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/p&gt;</span>
</span></span><span class=line><span class=cl>      <span class=o>&lt;</span><span class=nx>p</span><span class=o>&gt;</span><span class=nx>From</span><span class=o>:</span> <span class=p>{</span><span class=nx>data</span><span class=p>.</span><span class=nx>messageAdded</span><span class=p>.</span><span class=nx>user</span><span class=p>.</span><span class=nx>name</span><span class=p>}</span><span class=o>&lt;</span><span class=err>/p&gt;</span>
</span></span><span class=line><span class=cl>    <span class=o>&lt;</span><span class=err>/div&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>장점</strong>:</p><ul><li>강력한 타입 시스템과 스키마 정의</li><li>클라이언트가 필요한 데이터만 구독 가능</li><li>기존 GraphQL 인프라와 통합 용이</li></ul><p><strong>단점</strong>:</p><ul><li>구현 복잡성이 높음</li><li>학습 곡선이 가파름</li></ul><h4 id=grpc와-protocol-buffers>gRPC와 Protocol Buffers<a hidden class=anchor aria-hidden=true href=#grpc와-protocol-buffers>#</a></h4><p>gRPC는 구글이 개발한 고성능 RPC(원격 프로시저 호출) 프레임워크로, Protocol Buffers를 사용하여 데이터를 직렬화한다. 양방향 스트리밍을 지원하여 실시간 통신에 적합하다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-proto data-lang=proto><span class=line><span class=cl><span class=c1>// Protocol Buffers 정의 예시 (chat.proto)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>syntax</span> <span class=o>=</span> <span class=s>&#34;proto3&#34;</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=kn>package</span> <span class=nn>chat</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=kd>service</span> <span class=n>ChatService</span> <span class=p>{</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  <span class=c1>// 양방향 스트리밍 RPC
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>rpc</span> <span class=n>ChatStream</span> <span class=p>(</span><span class=n>stream</span> <span class=n>ChatMessage</span><span class=p>)</span> <span class=k>returns</span> <span class=p>(</span><span class=n>stream</span> <span class=n>ChatMessage</span><span class=p>)</span> <span class=p>{}</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=p>}</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=kd>message</span> <span class=nc>ChatMessage</span> <span class=p>{</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  <span class=kt>string</span> <span class=n>user_id</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  <span class=kt>string</span> <span class=n>content</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  <span class=kt>int64</span> <span class=n>timestamp</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=p>}</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16>16</a>
</span><span class=lnt id=hl-5-17><a class=lnlinks href=#hl-5-17>17</a>
</span><span class=lnt id=hl-5-18><a class=lnlinks href=#hl-5-18>18</a>
</span><span class=lnt id=hl-5-19><a class=lnlinks href=#hl-5-19>19</a>
</span><span class=lnt id=hl-5-20><a class=lnlinks href=#hl-5-20>20</a>
</span><span class=lnt id=hl-5-21><a class=lnlinks href=#hl-5-21>21</a>
</span><span class=lnt id=hl-5-22><a class=lnlinks href=#hl-5-22>22</a>
</span><span class=lnt id=hl-5-23><a class=lnlinks href=#hl-5-23>23</a>
</span><span class=lnt id=hl-5-24><a class=lnlinks href=#hl-5-24>24</a>
</span><span class=lnt id=hl-5-25><a class=lnlinks href=#hl-5-25>25</a>
</span><span class=lnt id=hl-5-26><a class=lnlinks href=#hl-5-26>26</a>
</span><span class=lnt id=hl-5-27><a class=lnlinks href=#hl-5-27>27</a>
</span><span class=lnt id=hl-5-28><a class=lnlinks href=#hl-5-28>28</a>
</span><span class=lnt id=hl-5-29><a class=lnlinks href=#hl-5-29>29</a>
</span><span class=lnt id=hl-5-30><a class=lnlinks href=#hl-5-30>30</a>
</span><span class=lnt id=hl-5-31><a class=lnlinks href=#hl-5-31>31</a>
</span><span class=lnt id=hl-5-32><a class=lnlinks href=#hl-5-32>32</a>
</span><span class=lnt id=hl-5-33><a class=lnlinks href=#hl-5-33>33</a>
</span><span class=lnt id=hl-5-34><a class=lnlinks href=#hl-5-34>34</a>
</span><span class=lnt id=hl-5-35><a class=lnlinks href=#hl-5-35>35</a>
</span><span class=lnt id=hl-5-36><a class=lnlinks href=#hl-5-36>36</a>
</span><span class=lnt id=hl-5-37><a class=lnlinks href=#hl-5-37>37</a>
</span><span class=lnt id=hl-5-38><a class=lnlinks href=#hl-5-38>38</a>
</span><span class=lnt id=hl-5-39><a class=lnlinks href=#hl-5-39>39</a>
</span><span class=lnt id=hl-5-40><a class=lnlinks href=#hl-5-40>40</a>
</span><span class=lnt id=hl-5-41><a class=lnlinks href=#hl-5-41>41</a>
</span><span class=lnt id=hl-5-42><a class=lnlinks href=#hl-5-42>42</a>
</span><span class=lnt id=hl-5-43><a class=lnlinks href=#hl-5-43>43</a>
</span><span class=lnt id=hl-5-44><a class=lnlinks href=#hl-5-44>44</a>
</span><span class=lnt id=hl-5-45><a class=lnlinks href=#hl-5-45>45</a>
</span><span class=lnt id=hl-5-46><a class=lnlinks href=#hl-5-46>46</a>
</span><span class=lnt id=hl-5-47><a class=lnlinks href=#hl-5-47>47</a>
</span><span class=lnt id=hl-5-48><a class=lnlinks href=#hl-5-48>48</a>
</span><span class=lnt id=hl-5-49><a class=lnlinks href=#hl-5-49>49</a>
</span><span class=lnt id=hl-5-50><a class=lnlinks href=#hl-5-50>50</a>
</span><span class=lnt id=hl-5-51><a class=lnlinks href=#hl-5-51>51</a>
</span><span class=lnt id=hl-5-52><a class=lnlinks href=#hl-5-52>52</a>
</span><span class=lnt id=hl-5-53><a class=lnlinks href=#hl-5-53>53</a>
</span><span class=lnt id=hl-5-54><a class=lnlinks href=#hl-5-54>54</a>
</span><span class=lnt id=hl-5-55><a class=lnlinks href=#hl-5-55>55</a>
</span><span class=lnt id=hl-5-56><a class=lnlinks href=#hl-5-56>56</a>
</span><span class=lnt id=hl-5-57><a class=lnlinks href=#hl-5-57>57</a>
</span><span class=lnt id=hl-5-58><a class=lnlinks href=#hl-5-58>58</a>
</span><span class=lnt id=hl-5-59><a class=lnlinks href=#hl-5-59>59</a>
</span><span class=lnt id=hl-5-60><a class=lnlinks href=#hl-5-60>60</a>
</span><span class=lnt id=hl-5-61><a class=lnlinks href=#hl-5-61>61</a>
</span><span class=lnt id=hl-5-62><a class=lnlinks href=#hl-5-62>62</a>
</span><span class=lnt id=hl-5-63><a class=lnlinks href=#hl-5-63>63</a>
</span><span class=lnt id=hl-5-64><a class=lnlinks href=#hl-5-64>64</a>
</span><span class=lnt id=hl-5-65><a class=lnlinks href=#hl-5-65>65</a>
</span><span class=lnt id=hl-5-66><a class=lnlinks href=#hl-5-66>66</a>
</span><span class=lnt id=hl-5-67><a class=lnlinks href=#hl-5-67>67</a>
</span><span class=lnt id=hl-5-68><a class=lnlinks href=#hl-5-68>68</a>
</span><span class=lnt id=hl-5-69><a class=lnlinks href=#hl-5-69>69</a>
</span><span class=lnt id=hl-5-70><a class=lnlinks href=#hl-5-70>70</a>
</span><span class=lnt id=hl-5-71><a class=lnlinks href=#hl-5-71>71</a>
</span><span class=lnt id=hl-5-72><a class=lnlinks href=#hl-5-72>72</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Node.js에서 gRPC 서버 구현 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>grpc</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;@grpc/grpc-js&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>protoLoader</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;@grpc/proto-loader&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>packageDefinition</span> <span class=o>=</span> <span class=nx>protoLoader</span><span class=p>.</span><span class=nx>loadSync</span><span class=p>(</span><span class=s1>&#39;chat.proto&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>chatProto</span> <span class=o>=</span> <span class=nx>grpc</span><span class=p>.</span><span class=nx>loadPackageDefinition</span><span class=p>(</span><span class=nx>packageDefinition</span><span class=p>).</span><span class=nx>chat</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 활성 스트림을 추적하는 배열
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>activeStreams</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>chatStream</span><span class=p>(</span><span class=nx>call</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 새 스트림을 활성 스트림 목록에 추가
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>activeStreams</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>call</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 클라이언트로부터 메시지 수신 시 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>call</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;data&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>chatMessage</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`메시지 수신: </span><span class=si>${</span><span class=nx>chatMessage</span><span class=p>.</span><span class=nx>content</span><span class=si>}</span><span class=sb> from </span><span class=si>${</span><span class=nx>chatMessage</span><span class=p>.</span><span class=nx>user_id</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 모든 활성 스트림으로 메시지 브로드캐스트
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>broadcastMessage</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>user_id</span><span class=o>:</span> <span class=nx>chatMessage</span><span class=p>.</span><span class=nx>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>content</span><span class=o>:</span> <span class=nx>chatMessage</span><span class=p>.</span><span class=nx>content</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>timestamp</span><span class=o>:</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>activeStreams</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>stream</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>stream</span><span class=p>.</span><span class=nx>write</span><span class=p>(</span><span class=nx>broadcastMessage</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;스트림 쓰기 오류:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 스트림 종료 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>call</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;end&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 종료된 스트림을 활성 목록에서 제거
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>index</span> <span class=o>=</span> <span class=nx>activeStreams</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>call</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>index</span> <span class=o>!==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>activeStreams</span><span class=p>.</span><span class=nx>splice</span><span class=p>(</span><span class=nx>index</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>call</span><span class=p>.</span><span class=nx>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 오류 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>call</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;error&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;스트림 오류:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>index</span> <span class=o>=</span> <span class=nx>activeStreams</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=nx>call</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>index</span> <span class=o>!==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>activeStreams</span><span class=p>.</span><span class=nx>splice</span><span class=p>(</span><span class=nx>index</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// gRPC 서버 설정 및 시작
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>server</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>grpc</span><span class=p>.</span><span class=nx>Server</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>server</span><span class=p>.</span><span class=nx>addService</span><span class=p>(</span><span class=nx>chatProto</span><span class=p>.</span><span class=nx>ChatService</span><span class=p>.</span><span class=nx>service</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>chatStream</span><span class=o>:</span> <span class=nx>chatStream</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>server</span><span class=p>.</span><span class=nx>bindAsync</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;0.0.0.0:50051&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>grpc</span><span class=p>.</span><span class=nx>ServerCredentials</span><span class=p>.</span><span class=nx>createInsecure</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nx>error</span><span class=p>,</span> <span class=nx>port</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;서버 시작 실패:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`gRPC 서버가 </span><span class=si>${</span><span class=nx>port</span><span class=si>}</span><span class=sb>에서 실행 중입니다`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>server</span><span class=p>.</span><span class=nx>start</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>장점</strong>:</p><ul><li>매우 높은 성능과 낮은 지연 시간</li><li>강력한 타입 시스템과 계약 정의</li><li>다양한 언어 지원</li></ul><p><strong>단점</strong>:</p><ul><li>브라우저에서 직접 사용 어려움 (변환 필요)</li><li>학습 곡선이 가파름</li><li>디버깅이 상대적으로 복잡함</li></ul><h3 id=실시간-api-설계-시-고려사항>실시간 API 설계 시 고려사항<a hidden class=anchor aria-hidden=true href=#실시간-api-설계-시-고려사항>#</a></h3><p>실시간 API를 설계할 때는 여러 중요한 측면을 고려해야 한다:</p><h4 id=연결-관리>연결 관리<a hidden class=anchor aria-hidden=true href=#연결-관리>#</a></h4><p>실시간 시스템에서 연결 관리는 핵심 과제이다:</p><ol><li><strong>연결 유지</strong>: 연결이 끊어질 경우의 자동 재연결 메커니즘을 구현해야 한다.</li><li><strong>하트비트(Heartbeat)</strong>: 연결이 활성 상태인지 주기적으로 확인하는 메커니즘이 필요하다.</li><li><strong>연결 상태 모니터링</strong>: 클라이언트와 서버 모두 연결 상태를 추적하고 문제를 감지해야 한다.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>  1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2>  2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3>  3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4>  4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5>  5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6>  6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7>  7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8>  8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9>  9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10> 10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11> 11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12> 12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13> 13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14> 14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15> 15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16> 16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17> 17</a>
</span><span class=lnt id=hl-6-18><a class=lnlinks href=#hl-6-18> 18</a>
</span><span class=lnt id=hl-6-19><a class=lnlinks href=#hl-6-19> 19</a>
</span><span class=lnt id=hl-6-20><a class=lnlinks href=#hl-6-20> 20</a>
</span><span class=lnt id=hl-6-21><a class=lnlinks href=#hl-6-21> 21</a>
</span><span class=lnt id=hl-6-22><a class=lnlinks href=#hl-6-22> 22</a>
</span><span class=lnt id=hl-6-23><a class=lnlinks href=#hl-6-23> 23</a>
</span><span class=lnt id=hl-6-24><a class=lnlinks href=#hl-6-24> 24</a>
</span><span class=lnt id=hl-6-25><a class=lnlinks href=#hl-6-25> 25</a>
</span><span class=lnt id=hl-6-26><a class=lnlinks href=#hl-6-26> 26</a>
</span><span class=lnt id=hl-6-27><a class=lnlinks href=#hl-6-27> 27</a>
</span><span class=lnt id=hl-6-28><a class=lnlinks href=#hl-6-28> 28</a>
</span><span class=lnt id=hl-6-29><a class=lnlinks href=#hl-6-29> 29</a>
</span><span class=lnt id=hl-6-30><a class=lnlinks href=#hl-6-30> 30</a>
</span><span class=lnt id=hl-6-31><a class=lnlinks href=#hl-6-31> 31</a>
</span><span class=lnt id=hl-6-32><a class=lnlinks href=#hl-6-32> 32</a>
</span><span class=lnt id=hl-6-33><a class=lnlinks href=#hl-6-33> 33</a>
</span><span class=lnt id=hl-6-34><a class=lnlinks href=#hl-6-34> 34</a>
</span><span class=lnt id=hl-6-35><a class=lnlinks href=#hl-6-35> 35</a>
</span><span class=lnt id=hl-6-36><a class=lnlinks href=#hl-6-36> 36</a>
</span><span class=lnt id=hl-6-37><a class=lnlinks href=#hl-6-37> 37</a>
</span><span class=lnt id=hl-6-38><a class=lnlinks href=#hl-6-38> 38</a>
</span><span class=lnt id=hl-6-39><a class=lnlinks href=#hl-6-39> 39</a>
</span><span class=lnt id=hl-6-40><a class=lnlinks href=#hl-6-40> 40</a>
</span><span class=lnt id=hl-6-41><a class=lnlinks href=#hl-6-41> 41</a>
</span><span class=lnt id=hl-6-42><a class=lnlinks href=#hl-6-42> 42</a>
</span><span class=lnt id=hl-6-43><a class=lnlinks href=#hl-6-43> 43</a>
</span><span class=lnt id=hl-6-44><a class=lnlinks href=#hl-6-44> 44</a>
</span><span class=lnt id=hl-6-45><a class=lnlinks href=#hl-6-45> 45</a>
</span><span class=lnt id=hl-6-46><a class=lnlinks href=#hl-6-46> 46</a>
</span><span class=lnt id=hl-6-47><a class=lnlinks href=#hl-6-47> 47</a>
</span><span class=lnt id=hl-6-48><a class=lnlinks href=#hl-6-48> 48</a>
</span><span class=lnt id=hl-6-49><a class=lnlinks href=#hl-6-49> 49</a>
</span><span class=lnt id=hl-6-50><a class=lnlinks href=#hl-6-50> 50</a>
</span><span class=lnt id=hl-6-51><a class=lnlinks href=#hl-6-51> 51</a>
</span><span class=lnt id=hl-6-52><a class=lnlinks href=#hl-6-52> 52</a>
</span><span class=lnt id=hl-6-53><a class=lnlinks href=#hl-6-53> 53</a>
</span><span class=lnt id=hl-6-54><a class=lnlinks href=#hl-6-54> 54</a>
</span><span class=lnt id=hl-6-55><a class=lnlinks href=#hl-6-55> 55</a>
</span><span class=lnt id=hl-6-56><a class=lnlinks href=#hl-6-56> 56</a>
</span><span class=lnt id=hl-6-57><a class=lnlinks href=#hl-6-57> 57</a>
</span><span class=lnt id=hl-6-58><a class=lnlinks href=#hl-6-58> 58</a>
</span><span class=lnt id=hl-6-59><a class=lnlinks href=#hl-6-59> 59</a>
</span><span class=lnt id=hl-6-60><a class=lnlinks href=#hl-6-60> 60</a>
</span><span class=lnt id=hl-6-61><a class=lnlinks href=#hl-6-61> 61</a>
</span><span class=lnt id=hl-6-62><a class=lnlinks href=#hl-6-62> 62</a>
</span><span class=lnt id=hl-6-63><a class=lnlinks href=#hl-6-63> 63</a>
</span><span class=lnt id=hl-6-64><a class=lnlinks href=#hl-6-64> 64</a>
</span><span class=lnt id=hl-6-65><a class=lnlinks href=#hl-6-65> 65</a>
</span><span class=lnt id=hl-6-66><a class=lnlinks href=#hl-6-66> 66</a>
</span><span class=lnt id=hl-6-67><a class=lnlinks href=#hl-6-67> 67</a>
</span><span class=lnt id=hl-6-68><a class=lnlinks href=#hl-6-68> 68</a>
</span><span class=lnt id=hl-6-69><a class=lnlinks href=#hl-6-69> 69</a>
</span><span class=lnt id=hl-6-70><a class=lnlinks href=#hl-6-70> 70</a>
</span><span class=lnt id=hl-6-71><a class=lnlinks href=#hl-6-71> 71</a>
</span><span class=lnt id=hl-6-72><a class=lnlinks href=#hl-6-72> 72</a>
</span><span class=lnt id=hl-6-73><a class=lnlinks href=#hl-6-73> 73</a>
</span><span class=lnt id=hl-6-74><a class=lnlinks href=#hl-6-74> 74</a>
</span><span class=lnt id=hl-6-75><a class=lnlinks href=#hl-6-75> 75</a>
</span><span class=lnt id=hl-6-76><a class=lnlinks href=#hl-6-76> 76</a>
</span><span class=lnt id=hl-6-77><a class=lnlinks href=#hl-6-77> 77</a>
</span><span class=lnt id=hl-6-78><a class=lnlinks href=#hl-6-78> 78</a>
</span><span class=lnt id=hl-6-79><a class=lnlinks href=#hl-6-79> 79</a>
</span><span class=lnt id=hl-6-80><a class=lnlinks href=#hl-6-80> 80</a>
</span><span class=lnt id=hl-6-81><a class=lnlinks href=#hl-6-81> 81</a>
</span><span class=lnt id=hl-6-82><a class=lnlinks href=#hl-6-82> 82</a>
</span><span class=lnt id=hl-6-83><a class=lnlinks href=#hl-6-83> 83</a>
</span><span class=lnt id=hl-6-84><a class=lnlinks href=#hl-6-84> 84</a>
</span><span class=lnt id=hl-6-85><a class=lnlinks href=#hl-6-85> 85</a>
</span><span class=lnt id=hl-6-86><a class=lnlinks href=#hl-6-86> 86</a>
</span><span class=lnt id=hl-6-87><a class=lnlinks href=#hl-6-87> 87</a>
</span><span class=lnt id=hl-6-88><a class=lnlinks href=#hl-6-88> 88</a>
</span><span class=lnt id=hl-6-89><a class=lnlinks href=#hl-6-89> 89</a>
</span><span class=lnt id=hl-6-90><a class=lnlinks href=#hl-6-90> 90</a>
</span><span class=lnt id=hl-6-91><a class=lnlinks href=#hl-6-91> 91</a>
</span><span class=lnt id=hl-6-92><a class=lnlinks href=#hl-6-92> 92</a>
</span><span class=lnt id=hl-6-93><a class=lnlinks href=#hl-6-93> 93</a>
</span><span class=lnt id=hl-6-94><a class=lnlinks href=#hl-6-94> 94</a>
</span><span class=lnt id=hl-6-95><a class=lnlinks href=#hl-6-95> 95</a>
</span><span class=lnt id=hl-6-96><a class=lnlinks href=#hl-6-96> 96</a>
</span><span class=lnt id=hl-6-97><a class=lnlinks href=#hl-6-97> 97</a>
</span><span class=lnt id=hl-6-98><a class=lnlinks href=#hl-6-98> 98</a>
</span><span class=lnt id=hl-6-99><a class=lnlinks href=#hl-6-99> 99</a>
</span><span class=lnt id=hl-6-100><a class=lnlinks href=#hl-6-100>100</a>
</span><span class=lnt id=hl-6-101><a class=lnlinks href=#hl-6-101>101</a>
</span><span class=lnt id=hl-6-102><a class=lnlinks href=#hl-6-102>102</a>
</span><span class=lnt id=hl-6-103><a class=lnlinks href=#hl-6-103>103</a>
</span><span class=lnt id=hl-6-104><a class=lnlinks href=#hl-6-104>104</a>
</span><span class=lnt id=hl-6-105><a class=lnlinks href=#hl-6-105>105</a>
</span><span class=lnt id=hl-6-106><a class=lnlinks href=#hl-6-106>106</a>
</span><span class=lnt id=hl-6-107><a class=lnlinks href=#hl-6-107>107</a>
</span><span class=lnt id=hl-6-108><a class=lnlinks href=#hl-6-108>108</a>
</span><span class=lnt id=hl-6-109><a class=lnlinks href=#hl-6-109>109</a>
</span><span class=lnt id=hl-6-110><a class=lnlinks href=#hl-6-110>110</a>
</span><span class=lnt id=hl-6-111><a class=lnlinks href=#hl-6-111>111</a>
</span><span class=lnt id=hl-6-112><a class=lnlinks href=#hl-6-112>112</a>
</span><span class=lnt id=hl-6-113><a class=lnlinks href=#hl-6-113>113</a>
</span><span class=lnt id=hl-6-114><a class=lnlinks href=#hl-6-114>114</a>
</span><span class=lnt id=hl-6-115><a class=lnlinks href=#hl-6-115>115</a>
</span><span class=lnt id=hl-6-116><a class=lnlinks href=#hl-6-116>116</a>
</span><span class=lnt id=hl-6-117><a class=lnlinks href=#hl-6-117>117</a>
</span><span class=lnt id=hl-6-118><a class=lnlinks href=#hl-6-118>118</a>
</span><span class=lnt id=hl-6-119><a class=lnlinks href=#hl-6-119>119</a>
</span><span class=lnt id=hl-6-120><a class=lnlinks href=#hl-6-120>120</a>
</span><span class=lnt id=hl-6-121><a class=lnlinks href=#hl-6-121>121</a>
</span><span class=lnt id=hl-6-122><a class=lnlinks href=#hl-6-122>122</a>
</span><span class=lnt id=hl-6-123><a class=lnlinks href=#hl-6-123>123</a>
</span><span class=lnt id=hl-6-124><a class=lnlinks href=#hl-6-124>124</a>
</span><span class=lnt id=hl-6-125><a class=lnlinks href=#hl-6-125>125</a>
</span><span class=lnt id=hl-6-126><a class=lnlinks href=#hl-6-126>126</a>
</span><span class=lnt id=hl-6-127><a class=lnlinks href=#hl-6-127>127</a>
</span><span class=lnt id=hl-6-128><a class=lnlinks href=#hl-6-128>128</a>
</span><span class=lnt id=hl-6-129><a class=lnlinks href=#hl-6-129>129</a>
</span><span class=lnt id=hl-6-130><a class=lnlinks href=#hl-6-130>130</a>
</span><span class=lnt id=hl-6-131><a class=lnlinks href=#hl-6-131>131</a>
</span><span class=lnt id=hl-6-132><a class=lnlinks href=#hl-6-132>132</a>
</span><span class=lnt id=hl-6-133><a class=lnlinks href=#hl-6-133>133</a>
</span><span class=lnt id=hl-6-134><a class=lnlinks href=#hl-6-134>134</a>
</span><span class=lnt id=hl-6-135><a class=lnlinks href=#hl-6-135>135</a>
</span><span class=lnt id=hl-6-136><a class=lnlinks href=#hl-6-136>136</a>
</span><span class=lnt id=hl-6-137><a class=lnlinks href=#hl-6-137>137</a>
</span><span class=lnt id=hl-6-138><a class=lnlinks href=#hl-6-138>138</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 클라이언트 측 WebSocket 연결 관리 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>class</span> <span class=nx>RealtimeClient</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>(</span><span class=nx>url</span><span class=p>,</span> <span class=nx>options</span> <span class=o>=</span> <span class=p>{})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>url</span> <span class=o>=</span> <span class=nx>url</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>reconnectInterval</span><span class=o>:</span> <span class=mi>1000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>maxReconnectAttempts</span><span class=o>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>heartbeatInterval</span><span class=o>:</span> <span class=mi>30000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>...</span><span class=nx>options</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>socket</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>reconnectAttempts</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>heartbeatTimer</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>listeners</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>message</span><span class=o>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>      <span class=nx>open</span><span class=o>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>      <span class=nx>close</span><span class=o>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>      <span class=nx>error</span><span class=o>:</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>connect</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>connect</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>socket</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>WebSocket</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>socket</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;open&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;연결 성공&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>reconnectAttempts</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>startHeartbeat</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>notifyListeners</span><span class=p>(</span><span class=s1>&#39;open&#39;</span><span class=p>,</span> <span class=nx>event</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>socket</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;message&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 하트비트 응답 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>if</span> <span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>type</span> <span class=o>===</span> <span class=s1>&#39;heartbeat&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>notifyListeners</span><span class=p>(</span><span class=s1>&#39;message&#39;</span><span class=p>,</span> <span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>socket</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;close&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>stopHeartbeat</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>notifyListeners</span><span class=p>(</span><span class=s1>&#39;close&#39;</span><span class=p>,</span> <span class=nx>event</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 비정상 종료인 경우 재연결 시도
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>event</span><span class=p>.</span><span class=nx>wasClean</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>scheduleReconnect</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>socket</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;error&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>notifyListeners</span><span class=p>(</span><span class=s1>&#39;error&#39;</span><span class=p>,</span> <span class=nx>event</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 오류 발생 시 재연결 시도
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>this</span><span class=p>.</span><span class=nx>scheduleReconnect</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>scheduleReconnect</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>reconnectAttempts</span> <span class=o>&gt;=</span> <span class=k>this</span><span class=p>.</span><span class=nx>options</span><span class=p>.</span><span class=nx>maxReconnectAttempts</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;최대 재연결 시도 횟수 초과&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>reconnectAttempts</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>delay</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>options</span><span class=p>.</span><span class=nx>reconnectInterval</span> <span class=o>*</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>pow</span><span class=p>(</span><span class=mf>1.5</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>reconnectAttempts</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`</span><span class=si>${</span><span class=nx>delay</span><span class=si>}</span><span class=sb>ms 후 재연결 시도 (</span><span class=si>${</span><span class=k>this</span><span class=p>.</span><span class=nx>reconnectAttempts</span><span class=si>}</span><span class=sb>/</span><span class=si>${</span><span class=k>this</span><span class=p>.</span><span class=nx>options</span><span class=p>.</span><span class=nx>maxReconnectAttempts</span><span class=si>}</span><span class=sb>)`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>setTimeout</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=k>this</span><span class=p>.</span><span class=nx>connect</span><span class=p>(),</span> <span class=nx>delay</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>startHeartbeat</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>heartbeatTimer</span> <span class=o>=</span> <span class=nx>setInterval</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>socket</span><span class=p>.</span><span class=nx>readyState</span> <span class=o>===</span> <span class=nx>WebSocket</span><span class=p>.</span><span class=nx>OPEN</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>socket</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;heartbeat&#39;</span> <span class=p>}));</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span> <span class=k>this</span><span class=p>.</span><span class=nx>options</span><span class=p>.</span><span class=nx>heartbeatInterval</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>stopHeartbeat</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>heartbeatTimer</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>clearInterval</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>heartbeatTimer</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>heartbeatTimer</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>on</span><span class=p>(</span><span class=nx>event</span><span class=p>,</span> <span class=nx>callback</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>listeners</span><span class=p>[</span><span class=nx>event</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>listeners</span><span class=p>[</span><span class=nx>event</span><span class=p>].</span><span class=nx>push</span><span class=p>(</span><span class=nx>callback</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>this</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>notifyListeners</span><span class=p>(</span><span class=nx>event</span><span class=p>,</span> <span class=nx>data</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>listeners</span><span class=p>[</span><span class=nx>event</span><span class=p>])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>listeners</span><span class=p>[</span><span class=nx>event</span><span class=p>].</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>callback</span> <span class=p>=&gt;</span> <span class=nx>callback</span><span class=p>(</span><span class=nx>data</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>send</span><span class=p>(</span><span class=nx>data</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>socket</span> <span class=o>&amp;&amp;</span> <span class=k>this</span><span class=p>.</span><span class=nx>socket</span><span class=p>.</span><span class=nx>readyState</span> <span class=o>===</span> <span class=nx>WebSocket</span><span class=p>.</span><span class=nx>OPEN</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>socket</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>data</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;WebSocket이 연결되지 않았습니다&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>close</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>stopHeartbeat</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>socket</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>socket</span><span class=p>.</span><span class=nx>close</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 사용 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>client</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>RealtimeClient</span><span class=p>(</span><span class=s1>&#39;wss://api.example.com/realtime&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>client</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;open&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;연결됨&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>client</span><span class=p>.</span><span class=nx>send</span><span class=p>({</span> <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;subscribe&#39;</span><span class=p>,</span> <span class=nx>channel</span><span class=o>:</span> <span class=s1>&#39;orders&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>client</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;message&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>data</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;메시지 수신:&#39;</span><span class=p>,</span> <span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>client</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;close&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;연결 종료&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>client</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;error&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;오류 발생:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=확장성-관리>확장성 관리<a hidden class=anchor aria-hidden=true href=#확장성-관리>#</a></h4><p>실시간 시스템은 많은 동시 연결을 처리해야 하므로 확장성을 고려한 설계가 필수적이다:</p><ol><li><strong>수평적 확장</strong>: 부하 분산을 위한 여러 서버에 걸친 확장 방법을 계획해야 한다.</li><li><strong>메시지 브로커 사용</strong>: Redis, Kafka, RabbitMQ와 같은 메시지 브로커를 사용하여 서버 간 통신을 조정한다.</li><li><strong>연결 샤딩</strong>: 지리적 위치나 사용자 ID 등을 기준으로 연결을 샤딩하여 효율적으로 분산한다.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1>  1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2>  2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3>  3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4>  4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5>  5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6>  6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7>  7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8>  8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9>  9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10> 10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11> 11</a>
</span><span class=lnt id=hl-7-12><a class=lnlinks href=#hl-7-12> 12</a>
</span><span class=lnt id=hl-7-13><a class=lnlinks href=#hl-7-13> 13</a>
</span><span class=lnt id=hl-7-14><a class=lnlinks href=#hl-7-14> 14</a>
</span><span class=lnt id=hl-7-15><a class=lnlinks href=#hl-7-15> 15</a>
</span><span class=lnt id=hl-7-16><a class=lnlinks href=#hl-7-16> 16</a>
</span><span class=lnt id=hl-7-17><a class=lnlinks href=#hl-7-17> 17</a>
</span><span class=lnt id=hl-7-18><a class=lnlinks href=#hl-7-18> 18</a>
</span><span class=lnt id=hl-7-19><a class=lnlinks href=#hl-7-19> 19</a>
</span><span class=lnt id=hl-7-20><a class=lnlinks href=#hl-7-20> 20</a>
</span><span class=lnt id=hl-7-21><a class=lnlinks href=#hl-7-21> 21</a>
</span><span class=lnt id=hl-7-22><a class=lnlinks href=#hl-7-22> 22</a>
</span><span class=lnt id=hl-7-23><a class=lnlinks href=#hl-7-23> 23</a>
</span><span class=lnt id=hl-7-24><a class=lnlinks href=#hl-7-24> 24</a>
</span><span class=lnt id=hl-7-25><a class=lnlinks href=#hl-7-25> 25</a>
</span><span class=lnt id=hl-7-26><a class=lnlinks href=#hl-7-26> 26</a>
</span><span class=lnt id=hl-7-27><a class=lnlinks href=#hl-7-27> 27</a>
</span><span class=lnt id=hl-7-28><a class=lnlinks href=#hl-7-28> 28</a>
</span><span class=lnt id=hl-7-29><a class=lnlinks href=#hl-7-29> 29</a>
</span><span class=lnt id=hl-7-30><a class=lnlinks href=#hl-7-30> 30</a>
</span><span class=lnt id=hl-7-31><a class=lnlinks href=#hl-7-31> 31</a>
</span><span class=lnt id=hl-7-32><a class=lnlinks href=#hl-7-32> 32</a>
</span><span class=lnt id=hl-7-33><a class=lnlinks href=#hl-7-33> 33</a>
</span><span class=lnt id=hl-7-34><a class=lnlinks href=#hl-7-34> 34</a>
</span><span class=lnt id=hl-7-35><a class=lnlinks href=#hl-7-35> 35</a>
</span><span class=lnt id=hl-7-36><a class=lnlinks href=#hl-7-36> 36</a>
</span><span class=lnt id=hl-7-37><a class=lnlinks href=#hl-7-37> 37</a>
</span><span class=lnt id=hl-7-38><a class=lnlinks href=#hl-7-38> 38</a>
</span><span class=lnt id=hl-7-39><a class=lnlinks href=#hl-7-39> 39</a>
</span><span class=lnt id=hl-7-40><a class=lnlinks href=#hl-7-40> 40</a>
</span><span class=lnt id=hl-7-41><a class=lnlinks href=#hl-7-41> 41</a>
</span><span class=lnt id=hl-7-42><a class=lnlinks href=#hl-7-42> 42</a>
</span><span class=lnt id=hl-7-43><a class=lnlinks href=#hl-7-43> 43</a>
</span><span class=lnt id=hl-7-44><a class=lnlinks href=#hl-7-44> 44</a>
</span><span class=lnt id=hl-7-45><a class=lnlinks href=#hl-7-45> 45</a>
</span><span class=lnt id=hl-7-46><a class=lnlinks href=#hl-7-46> 46</a>
</span><span class=lnt id=hl-7-47><a class=lnlinks href=#hl-7-47> 47</a>
</span><span class=lnt id=hl-7-48><a class=lnlinks href=#hl-7-48> 48</a>
</span><span class=lnt id=hl-7-49><a class=lnlinks href=#hl-7-49> 49</a>
</span><span class=lnt id=hl-7-50><a class=lnlinks href=#hl-7-50> 50</a>
</span><span class=lnt id=hl-7-51><a class=lnlinks href=#hl-7-51> 51</a>
</span><span class=lnt id=hl-7-52><a class=lnlinks href=#hl-7-52> 52</a>
</span><span class=lnt id=hl-7-53><a class=lnlinks href=#hl-7-53> 53</a>
</span><span class=lnt id=hl-7-54><a class=lnlinks href=#hl-7-54> 54</a>
</span><span class=lnt id=hl-7-55><a class=lnlinks href=#hl-7-55> 55</a>
</span><span class=lnt id=hl-7-56><a class=lnlinks href=#hl-7-56> 56</a>
</span><span class=lnt id=hl-7-57><a class=lnlinks href=#hl-7-57> 57</a>
</span><span class=lnt id=hl-7-58><a class=lnlinks href=#hl-7-58> 58</a>
</span><span class=lnt id=hl-7-59><a class=lnlinks href=#hl-7-59> 59</a>
</span><span class=lnt id=hl-7-60><a class=lnlinks href=#hl-7-60> 60</a>
</span><span class=lnt id=hl-7-61><a class=lnlinks href=#hl-7-61> 61</a>
</span><span class=lnt id=hl-7-62><a class=lnlinks href=#hl-7-62> 62</a>
</span><span class=lnt id=hl-7-63><a class=lnlinks href=#hl-7-63> 63</a>
</span><span class=lnt id=hl-7-64><a class=lnlinks href=#hl-7-64> 64</a>
</span><span class=lnt id=hl-7-65><a class=lnlinks href=#hl-7-65> 65</a>
</span><span class=lnt id=hl-7-66><a class=lnlinks href=#hl-7-66> 66</a>
</span><span class=lnt id=hl-7-67><a class=lnlinks href=#hl-7-67> 67</a>
</span><span class=lnt id=hl-7-68><a class=lnlinks href=#hl-7-68> 68</a>
</span><span class=lnt id=hl-7-69><a class=lnlinks href=#hl-7-69> 69</a>
</span><span class=lnt id=hl-7-70><a class=lnlinks href=#hl-7-70> 70</a>
</span><span class=lnt id=hl-7-71><a class=lnlinks href=#hl-7-71> 71</a>
</span><span class=lnt id=hl-7-72><a class=lnlinks href=#hl-7-72> 72</a>
</span><span class=lnt id=hl-7-73><a class=lnlinks href=#hl-7-73> 73</a>
</span><span class=lnt id=hl-7-74><a class=lnlinks href=#hl-7-74> 74</a>
</span><span class=lnt id=hl-7-75><a class=lnlinks href=#hl-7-75> 75</a>
</span><span class=lnt id=hl-7-76><a class=lnlinks href=#hl-7-76> 76</a>
</span><span class=lnt id=hl-7-77><a class=lnlinks href=#hl-7-77> 77</a>
</span><span class=lnt id=hl-7-78><a class=lnlinks href=#hl-7-78> 78</a>
</span><span class=lnt id=hl-7-79><a class=lnlinks href=#hl-7-79> 79</a>
</span><span class=lnt id=hl-7-80><a class=lnlinks href=#hl-7-80> 80</a>
</span><span class=lnt id=hl-7-81><a class=lnlinks href=#hl-7-81> 81</a>
</span><span class=lnt id=hl-7-82><a class=lnlinks href=#hl-7-82> 82</a>
</span><span class=lnt id=hl-7-83><a class=lnlinks href=#hl-7-83> 83</a>
</span><span class=lnt id=hl-7-84><a class=lnlinks href=#hl-7-84> 84</a>
</span><span class=lnt id=hl-7-85><a class=lnlinks href=#hl-7-85> 85</a>
</span><span class=lnt id=hl-7-86><a class=lnlinks href=#hl-7-86> 86</a>
</span><span class=lnt id=hl-7-87><a class=lnlinks href=#hl-7-87> 87</a>
</span><span class=lnt id=hl-7-88><a class=lnlinks href=#hl-7-88> 88</a>
</span><span class=lnt id=hl-7-89><a class=lnlinks href=#hl-7-89> 89</a>
</span><span class=lnt id=hl-7-90><a class=lnlinks href=#hl-7-90> 90</a>
</span><span class=lnt id=hl-7-91><a class=lnlinks href=#hl-7-91> 91</a>
</span><span class=lnt id=hl-7-92><a class=lnlinks href=#hl-7-92> 92</a>
</span><span class=lnt id=hl-7-93><a class=lnlinks href=#hl-7-93> 93</a>
</span><span class=lnt id=hl-7-94><a class=lnlinks href=#hl-7-94> 94</a>
</span><span class=lnt id=hl-7-95><a class=lnlinks href=#hl-7-95> 95</a>
</span><span class=lnt id=hl-7-96><a class=lnlinks href=#hl-7-96> 96</a>
</span><span class=lnt id=hl-7-97><a class=lnlinks href=#hl-7-97> 97</a>
</span><span class=lnt id=hl-7-98><a class=lnlinks href=#hl-7-98> 98</a>
</span><span class=lnt id=hl-7-99><a class=lnlinks href=#hl-7-99> 99</a>
</span><span class=lnt id=hl-7-100><a class=lnlinks href=#hl-7-100>100</a>
</span><span class=lnt id=hl-7-101><a class=lnlinks href=#hl-7-101>101</a>
</span><span class=lnt id=hl-7-102><a class=lnlinks href=#hl-7-102>102</a>
</span><span class=lnt id=hl-7-103><a class=lnlinks href=#hl-7-103>103</a>
</span><span class=lnt id=hl-7-104><a class=lnlinks href=#hl-7-104>104</a>
</span><span class=lnt id=hl-7-105><a class=lnlinks href=#hl-7-105>105</a>
</span><span class=lnt id=hl-7-106><a class=lnlinks href=#hl-7-106>106</a>
</span><span class=lnt id=hl-7-107><a class=lnlinks href=#hl-7-107>107</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Node.js + Redis + Socket.IO를 사용한 확장 가능한 실시간 서버 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>http</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;http&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=p>{</span> <span class=nx>Server</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;socket.io&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>Redis</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;ioredis&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>server</span> <span class=o>=</span> <span class=nx>http</span><span class=p>.</span><span class=nx>createServer</span><span class=p>(</span><span class=nx>app</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>io</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Server</span><span class=p>(</span><span class=nx>server</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>adapter</span><span class=o>:</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;socket.io-redis&#39;</span><span class=p>)({</span>
</span></span><span class=line><span class=cl>    <span class=nx>pubClient</span><span class=o>:</span> <span class=k>new</span> <span class=nx>Redis</span><span class=p>(</span><span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>REDIS_URL</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>subClient</span><span class=o>:</span> <span class=k>new</span> <span class=nx>Redis</span><span class=p>(</span><span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>REDIS_URL</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Redis 구독 클라이언트 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>redisSubscriber</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Redis</span><span class=p>(</span><span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>REDIS_URL</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>redisSubscriber</span><span class=p>.</span><span class=nx>subscribe</span><span class=p>(</span><span class=s1>&#39;global-events&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>redisSubscriber</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;message&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>channel</span><span class=p>,</span> <span class=nx>message</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>event</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>io</span><span class=p>.</span><span class=nx>to</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>room</span> <span class=o>||</span> <span class=s1>&#39;all&#39;</span><span class=p>).</span><span class=nx>emit</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>type</span><span class=p>,</span> <span class=nx>event</span><span class=p>.</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 소켓 연결 처리
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>io</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;connection&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>socket</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;새 클라이언트 연결:&#39;</span><span class=p>,</span> <span class=nx>socket</span><span class=p>.</span><span class=nx>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 사용자 인증 및 초기화
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>socket</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;authenticate&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>userData</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 사용자 인증 로직
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>authenticateUser</span><span class=p>(</span><span class=nx>userData</span><span class=p>.</span><span class=nx>token</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 사용자 정보를 소켓에 저장
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>socket</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>user</span> <span class=o>=</span> <span class=nx>user</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 사용자별 룸에 조인
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>socket</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=sb>`user:</span><span class=si>${</span><span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 구독 채널에 조인
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>if</span> <span class=p>(</span><span class=nx>userData</span><span class=p>.</span><span class=nx>subscriptions</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>userData</span><span class=p>.</span><span class=nx>subscriptions</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>channel</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>socket</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=sb>`channel:</span><span class=si>${</span><span class=nx>channel</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=nx>socket</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span><span class=s1>&#39;authenticated&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>success</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>socket</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span><span class=s1>&#39;authenticated&#39;</span><span class=p>,</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>        <span class=nx>success</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=nx>error</span><span class=o>:</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span> 
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 채널 구독
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>socket</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;subscribe&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>channel</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>socket</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=sb>`channel:</span><span class=si>${</span><span class=nx>channel</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>socket</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span><span class=s1>&#39;subscribed&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>channel</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 채널 구독 해제
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>socket</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;unsubscribe&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>channel</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>socket</span><span class=p>.</span><span class=nx>leave</span><span class=p>(</span><span class=sb>`channel:</span><span class=si>${</span><span class=nx>channel</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>socket</span><span class=p>.</span><span class=nx>emit</span><span class=p>(</span><span class=s1>&#39;unsubscribed&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>channel</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 연결 종료 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>socket</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;disconnect&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;클라이언트 연결 종료:&#39;</span><span class=p>,</span> <span class=nx>socket</span><span class=p>.</span><span class=nx>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 정리 로직
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 이벤트 발행 헬퍼 함수
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>publishEvent</span><span class=p>(</span><span class=nx>type</span><span class=p>,</span> <span class=nx>data</span><span class=p>,</span> <span class=nx>room</span> <span class=o>=</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>redis</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Redis</span><span class=p>(</span><span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>REDIS_URL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>redis</span><span class=p>.</span><span class=nx>publish</span><span class=p>(</span><span class=s1>&#39;global-events&#39;</span><span class=p>,</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>room</span>
</span></span><span class=line><span class=cl>  <span class=p>}));</span>
</span></span><span class=line><span class=cl>  <span class=nx>redis</span><span class=p>.</span><span class=nx>quit</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 외부 API에서 사용할 수 있는 이벤트 발행 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/api/events&#39;</span><span class=p>,</span> <span class=nx>express</span><span class=p>.</span><span class=nx>json</span><span class=p>(),</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=p>{</span> <span class=nx>type</span><span class=p>,</span> <span class=nx>data</span><span class=p>,</span> <span class=nx>room</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kr>await</span> <span class=nx>publishEvent</span><span class=p>(</span><span class=nx>type</span><span class=p>,</span> <span class=nx>data</span><span class=p>,</span> <span class=nx>room</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>202</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>success</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>500</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 서버 시작
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>PORT</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>PORT</span> <span class=o>||</span> <span class=mi>3000</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>server</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=nx>PORT</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`실시간 서버가 포트 </span><span class=si>${</span><span class=nx>PORT</span><span class=si>}</span><span class=sb>에서 실행 중입니다`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 사용자 인증 함수 (실제 구현은 별도로 필요)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>authenticateUser</span><span class=p>(</span><span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 토큰 검증 및 사용자 정보 조회 로직
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=s1>&#39;user-123&#39;</span><span class=p>,</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;John Doe&#39;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=데이터-일관성>데이터 일관성<a hidden class=anchor aria-hidden=true href=#데이터-일관성>#</a></h4><p>실시간 시스템에서 데이터 일관성을 유지하는 것은 중요한 과제이다:</p><ol><li><strong>이벤트 순서화</strong>: 이벤트가 발생한 순서대로 처리되도록 보장해야 한다.</li><li><strong>충돌 해결</strong>: 동시 업데이트 충돌을 감지하고 해결하는 전략이 필요하다.</li><li><strong>상태 동기화</strong>: 연결이 끊어졌다가 재연결될 때 상태를 동기화하는 메커니즘이 필요하다.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>  1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>  2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>  3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>  4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>  5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6>  6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7>  7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8>  8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9>  9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10> 10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11> 11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12> 12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13> 13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14> 14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15> 15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16> 16</a>
</span><span class=lnt id=hl-8-17><a class=lnlinks href=#hl-8-17> 17</a>
</span><span class=lnt id=hl-8-18><a class=lnlinks href=#hl-8-18> 18</a>
</span><span class=lnt id=hl-8-19><a class=lnlinks href=#hl-8-19> 19</a>
</span><span class=lnt id=hl-8-20><a class=lnlinks href=#hl-8-20> 20</a>
</span><span class=lnt id=hl-8-21><a class=lnlinks href=#hl-8-21> 21</a>
</span><span class=lnt id=hl-8-22><a class=lnlinks href=#hl-8-22> 22</a>
</span><span class=lnt id=hl-8-23><a class=lnlinks href=#hl-8-23> 23</a>
</span><span class=lnt id=hl-8-24><a class=lnlinks href=#hl-8-24> 24</a>
</span><span class=lnt id=hl-8-25><a class=lnlinks href=#hl-8-25> 25</a>
</span><span class=lnt id=hl-8-26><a class=lnlinks href=#hl-8-26> 26</a>
</span><span class=lnt id=hl-8-27><a class=lnlinks href=#hl-8-27> 27</a>
</span><span class=lnt id=hl-8-28><a class=lnlinks href=#hl-8-28> 28</a>
</span><span class=lnt id=hl-8-29><a class=lnlinks href=#hl-8-29> 29</a>
</span><span class=lnt id=hl-8-30><a class=lnlinks href=#hl-8-30> 30</a>
</span><span class=lnt id=hl-8-31><a class=lnlinks href=#hl-8-31> 31</a>
</span><span class=lnt id=hl-8-32><a class=lnlinks href=#hl-8-32> 32</a>
</span><span class=lnt id=hl-8-33><a class=lnlinks href=#hl-8-33> 33</a>
</span><span class=lnt id=hl-8-34><a class=lnlinks href=#hl-8-34> 34</a>
</span><span class=lnt id=hl-8-35><a class=lnlinks href=#hl-8-35> 35</a>
</span><span class=lnt id=hl-8-36><a class=lnlinks href=#hl-8-36> 36</a>
</span><span class=lnt id=hl-8-37><a class=lnlinks href=#hl-8-37> 37</a>
</span><span class=lnt id=hl-8-38><a class=lnlinks href=#hl-8-38> 38</a>
</span><span class=lnt id=hl-8-39><a class=lnlinks href=#hl-8-39> 39</a>
</span><span class=lnt id=hl-8-40><a class=lnlinks href=#hl-8-40> 40</a>
</span><span class=lnt id=hl-8-41><a class=lnlinks href=#hl-8-41> 41</a>
</span><span class=lnt id=hl-8-42><a class=lnlinks href=#hl-8-42> 42</a>
</span><span class=lnt id=hl-8-43><a class=lnlinks href=#hl-8-43> 43</a>
</span><span class=lnt id=hl-8-44><a class=lnlinks href=#hl-8-44> 44</a>
</span><span class=lnt id=hl-8-45><a class=lnlinks href=#hl-8-45> 45</a>
</span><span class=lnt id=hl-8-46><a class=lnlinks href=#hl-8-46> 46</a>
</span><span class=lnt id=hl-8-47><a class=lnlinks href=#hl-8-47> 47</a>
</span><span class=lnt id=hl-8-48><a class=lnlinks href=#hl-8-48> 48</a>
</span><span class=lnt id=hl-8-49><a class=lnlinks href=#hl-8-49> 49</a>
</span><span class=lnt id=hl-8-50><a class=lnlinks href=#hl-8-50> 50</a>
</span><span class=lnt id=hl-8-51><a class=lnlinks href=#hl-8-51> 51</a>
</span><span class=lnt id=hl-8-52><a class=lnlinks href=#hl-8-52> 52</a>
</span><span class=lnt id=hl-8-53><a class=lnlinks href=#hl-8-53> 53</a>
</span><span class=lnt id=hl-8-54><a class=lnlinks href=#hl-8-54> 54</a>
</span><span class=lnt id=hl-8-55><a class=lnlinks href=#hl-8-55> 55</a>
</span><span class=lnt id=hl-8-56><a class=lnlinks href=#hl-8-56> 56</a>
</span><span class=lnt id=hl-8-57><a class=lnlinks href=#hl-8-57> 57</a>
</span><span class=lnt id=hl-8-58><a class=lnlinks href=#hl-8-58> 58</a>
</span><span class=lnt id=hl-8-59><a class=lnlinks href=#hl-8-59> 59</a>
</span><span class=lnt id=hl-8-60><a class=lnlinks href=#hl-8-60> 60</a>
</span><span class=lnt id=hl-8-61><a class=lnlinks href=#hl-8-61> 61</a>
</span><span class=lnt id=hl-8-62><a class=lnlinks href=#hl-8-62> 62</a>
</span><span class=lnt id=hl-8-63><a class=lnlinks href=#hl-8-63> 63</a>
</span><span class=lnt id=hl-8-64><a class=lnlinks href=#hl-8-64> 64</a>
</span><span class=lnt id=hl-8-65><a class=lnlinks href=#hl-8-65> 65</a>
</span><span class=lnt id=hl-8-66><a class=lnlinks href=#hl-8-66> 66</a>
</span><span class=lnt id=hl-8-67><a class=lnlinks href=#hl-8-67> 67</a>
</span><span class=lnt id=hl-8-68><a class=lnlinks href=#hl-8-68> 68</a>
</span><span class=lnt id=hl-8-69><a class=lnlinks href=#hl-8-69> 69</a>
</span><span class=lnt id=hl-8-70><a class=lnlinks href=#hl-8-70> 70</a>
</span><span class=lnt id=hl-8-71><a class=lnlinks href=#hl-8-71> 71</a>
</span><span class=lnt id=hl-8-72><a class=lnlinks href=#hl-8-72> 72</a>
</span><span class=lnt id=hl-8-73><a class=lnlinks href=#hl-8-73> 73</a>
</span><span class=lnt id=hl-8-74><a class=lnlinks href=#hl-8-74> 74</a>
</span><span class=lnt id=hl-8-75><a class=lnlinks href=#hl-8-75> 75</a>
</span><span class=lnt id=hl-8-76><a class=lnlinks href=#hl-8-76> 76</a>
</span><span class=lnt id=hl-8-77><a class=lnlinks href=#hl-8-77> 77</a>
</span><span class=lnt id=hl-8-78><a class=lnlinks href=#hl-8-78> 78</a>
</span><span class=lnt id=hl-8-79><a class=lnlinks href=#hl-8-79> 79</a>
</span><span class=lnt id=hl-8-80><a class=lnlinks href=#hl-8-80> 80</a>
</span><span class=lnt id=hl-8-81><a class=lnlinks href=#hl-8-81> 81</a>
</span><span class=lnt id=hl-8-82><a class=lnlinks href=#hl-8-82> 82</a>
</span><span class=lnt id=hl-8-83><a class=lnlinks href=#hl-8-83> 83</a>
</span><span class=lnt id=hl-8-84><a class=lnlinks href=#hl-8-84> 84</a>
</span><span class=lnt id=hl-8-85><a class=lnlinks href=#hl-8-85> 85</a>
</span><span class=lnt id=hl-8-86><a class=lnlinks href=#hl-8-86> 86</a>
</span><span class=lnt id=hl-8-87><a class=lnlinks href=#hl-8-87> 87</a>
</span><span class=lnt id=hl-8-88><a class=lnlinks href=#hl-8-88> 88</a>
</span><span class=lnt id=hl-8-89><a class=lnlinks href=#hl-8-89> 89</a>
</span><span class=lnt id=hl-8-90><a class=lnlinks href=#hl-8-90> 90</a>
</span><span class=lnt id=hl-8-91><a class=lnlinks href=#hl-8-91> 91</a>
</span><span class=lnt id=hl-8-92><a class=lnlinks href=#hl-8-92> 92</a>
</span><span class=lnt id=hl-8-93><a class=lnlinks href=#hl-8-93> 93</a>
</span><span class=lnt id=hl-8-94><a class=lnlinks href=#hl-8-94> 94</a>
</span><span class=lnt id=hl-8-95><a class=lnlinks href=#hl-8-95> 95</a>
</span><span class=lnt id=hl-8-96><a class=lnlinks href=#hl-8-96> 96</a>
</span><span class=lnt id=hl-8-97><a class=lnlinks href=#hl-8-97> 97</a>
</span><span class=lnt id=hl-8-98><a class=lnlinks href=#hl-8-98> 98</a>
</span><span class=lnt id=hl-8-99><a class=lnlinks href=#hl-8-99> 99</a>
</span><span class=lnt id=hl-8-100><a class=lnlinks href=#hl-8-100>100</a>
</span><span class=lnt id=hl-8-101><a class=lnlinks href=#hl-8-101>101</a>
</span><span class=lnt id=hl-8-102><a class=lnlinks href=#hl-8-102>102</a>
</span><span class=lnt id=hl-8-103><a class=lnlinks href=#hl-8-103>103</a>
</span><span class=lnt id=hl-8-104><a class=lnlinks href=#hl-8-104>104</a>
</span><span class=lnt id=hl-8-105><a class=lnlinks href=#hl-8-105>105</a>
</span><span class=lnt id=hl-8-106><a class=lnlinks href=#hl-8-106>106</a>
</span><span class=lnt id=hl-8-107><a class=lnlinks href=#hl-8-107>107</a>
</span><span class=lnt id=hl-8-108><a class=lnlinks href=#hl-8-108>108</a>
</span><span class=lnt id=hl-8-109><a class=lnlinks href=#hl-8-109>109</a>
</span><span class=lnt id=hl-8-110><a class=lnlinks href=#hl-8-110>110</a>
</span><span class=lnt id=hl-8-111><a class=lnlinks href=#hl-8-111>111</a>
</span><span class=lnt id=hl-8-112><a class=lnlinks href=#hl-8-112>112</a>
</span><span class=lnt id=hl-8-113><a class=lnlinks href=#hl-8-113>113</a>
</span><span class=lnt id=hl-8-114><a class=lnlinks href=#hl-8-114>114</a>
</span><span class=lnt id=hl-8-115><a class=lnlinks href=#hl-8-115>115</a>
</span><span class=lnt id=hl-8-116><a class=lnlinks href=#hl-8-116>116</a>
</span><span class=lnt id=hl-8-117><a class=lnlinks href=#hl-8-117>117</a>
</span><span class=lnt id=hl-8-118><a class=lnlinks href=#hl-8-118>118</a>
</span><span class=lnt id=hl-8-119><a class=lnlinks href=#hl-8-119>119</a>
</span><span class=lnt id=hl-8-120><a class=lnlinks href=#hl-8-120>120</a>
</span><span class=lnt id=hl-8-121><a class=lnlinks href=#hl-8-121>121</a>
</span><span class=lnt id=hl-8-122><a class=lnlinks href=#hl-8-122>122</a>
</span><span class=lnt id=hl-8-123><a class=lnlinks href=#hl-8-123>123</a>
</span><span class=lnt id=hl-8-124><a class=lnlinks href=#hl-8-124>124</a>
</span><span class=lnt id=hl-8-125><a class=lnlinks href=#hl-8-125>125</a>
</span><span class=lnt id=hl-8-126><a class=lnlinks href=#hl-8-126>126</a>
</span><span class=lnt id=hl-8-127><a class=lnlinks href=#hl-8-127>127</a>
</span><span class=lnt id=hl-8-128><a class=lnlinks href=#hl-8-128>128</a>
</span><span class=lnt id=hl-8-129><a class=lnlinks href=#hl-8-129>129</a>
</span><span class=lnt id=hl-8-130><a class=lnlinks href=#hl-8-130>130</a>
</span><span class=lnt id=hl-8-131><a class=lnlinks href=#hl-8-131>131</a>
</span><span class=lnt id=hl-8-132><a class=lnlinks href=#hl-8-132>132</a>
</span><span class=lnt id=hl-8-133><a class=lnlinks href=#hl-8-133>133</a>
</span><span class=lnt id=hl-8-134><a class=lnlinks href=#hl-8-134>134</a>
</span><span class=lnt id=hl-8-135><a class=lnlinks href=#hl-8-135>135</a>
</span><span class=lnt id=hl-8-136><a class=lnlinks href=#hl-8-136>136</a>
</span><span class=lnt id=hl-8-137><a class=lnlinks href=#hl-8-137>137</a>
</span><span class=lnt id=hl-8-138><a class=lnlinks href=#hl-8-138>138</a>
</span><span class=lnt id=hl-8-139><a class=lnlinks href=#hl-8-139>139</a>
</span><span class=lnt id=hl-8-140><a class=lnlinks href=#hl-8-140>140</a>
</span><span class=lnt id=hl-8-141><a class=lnlinks href=#hl-8-141>141</a>
</span><span class=lnt id=hl-8-142><a class=lnlinks href=#hl-8-142>142</a>
</span><span class=lnt id=hl-8-143><a class=lnlinks href=#hl-8-143>143</a>
</span><span class=lnt id=hl-8-144><a class=lnlinks href=#hl-8-144>144</a>
</span><span class=lnt id=hl-8-145><a class=lnlinks href=#hl-8-145>145</a>
</span><span class=lnt id=hl-8-146><a class=lnlinks href=#hl-8-146>146</a>
</span><span class=lnt id=hl-8-147><a class=lnlinks href=#hl-8-147>147</a>
</span><span class=lnt id=hl-8-148><a class=lnlinks href=#hl-8-148>148</a>
</span><span class=lnt id=hl-8-149><a class=lnlinks href=#hl-8-149>149</a>
</span><span class=lnt id=hl-8-150><a class=lnlinks href=#hl-8-150>150</a>
</span><span class=lnt id=hl-8-151><a class=lnlinks href=#hl-8-151>151</a>
</span><span class=lnt id=hl-8-152><a class=lnlinks href=#hl-8-152>152</a>
</span><span class=lnt id=hl-8-153><a class=lnlinks href=#hl-8-153>153</a>
</span><span class=lnt id=hl-8-154><a class=lnlinks href=#hl-8-154>154</a>
</span><span class=lnt id=hl-8-155><a class=lnlinks href=#hl-8-155>155</a>
</span><span class=lnt id=hl-8-156><a class=lnlinks href=#hl-8-156>156</a>
</span><span class=lnt id=hl-8-157><a class=lnlinks href=#hl-8-157>157</a>
</span><span class=lnt id=hl-8-158><a class=lnlinks href=#hl-8-158>158</a>
</span><span class=lnt id=hl-8-159><a class=lnlinks href=#hl-8-159>159</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 클라이언트 측 상태 동기화 구현 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>class</span> <span class=nx>SynchronizedState</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>(</span><span class=nx>initialState</span> <span class=o>=</span> <span class=p>{})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>state</span> <span class=o>=</span> <span class=nx>initialState</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>version</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>pendingUpdates</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>listeners</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 상태 업데이트 (로컬)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>update</span><span class=p>(</span><span class=nx>patch</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>updateObject</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>id</span><span class=o>:</span> <span class=nx>generateUUID</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>      <span class=nx>version</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>version</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>timestamp</span><span class=o>:</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>      <span class=nx>patch</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 로컬 상태 업데이트
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>this</span><span class=p>.</span><span class=nx>applyUpdate</span><span class=p>(</span><span class=nx>updateObject</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 업데이트를 서버로 전송
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>this</span><span class=p>.</span><span class=nx>pendingUpdates</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>updateObject</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>sendPendingUpdates</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>updateObject</span><span class=p>.</span><span class=nx>id</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 업데이트 적용
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>applyUpdate</span><span class=p>(</span><span class=nx>updateObject</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>updateObject</span><span class=p>.</span><span class=nx>version</span> <span class=o>&gt;</span> <span class=k>this</span><span class=p>.</span><span class=nx>version</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 패치 적용
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>this</span><span class=p>.</span><span class=nx>state</span> <span class=o>=</span> <span class=nx>deepMerge</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>state</span><span class=p>,</span> <span class=nx>updateObject</span><span class=p>.</span><span class=nx>patch</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>version</span> <span class=o>=</span> <span class=nx>updateObject</span><span class=p>.</span><span class=nx>version</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 리스너 알림
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>this</span><span class=p>.</span><span class=nx>notifyListeners</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 서버로부터 업데이트 수신
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>receiveUpdate</span><span class=p>(</span><span class=nx>serverUpdate</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 로컬 업데이트와 서버 업데이트 간 충돌 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>conflictIndex</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>pendingUpdates</span><span class=p>.</span><span class=nx>findIndex</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=nx>update</span> <span class=p>=&gt;</span> <span class=nx>update</span><span class=p>.</span><span class=nx>id</span> <span class=o>===</span> <span class=nx>serverUpdate</span><span class=p>.</span><span class=nx>id</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>conflictIndex</span> <span class=o>!==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 승인된 업데이트는 대기열에서 제거
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>this</span><span class=p>.</span><span class=nx>pendingUpdates</span><span class=p>.</span><span class=nx>splice</span><span class=p>(</span><span class=nx>conflictIndex</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 서버 업데이트 적용
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>this</span><span class=p>.</span><span class=nx>applyUpdate</span><span class=p>(</span><span class=nx>serverUpdate</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 서버와 재동기화
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>resynchronize</span><span class=p>(</span><span class=nx>serverState</span><span class=p>,</span> <span class=nx>serverVersion</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 서버 상태가 더 최신인 경우
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>serverVersion</span> <span class=o>&gt;</span> <span class=k>this</span><span class=p>.</span><span class=nx>version</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>state</span> <span class=o>=</span> <span class=nx>serverState</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>version</span> <span class=o>=</span> <span class=nx>serverVersion</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 서버 상태보다 최신인 대기 중인 업데이트만 유지
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>this</span><span class=p>.</span><span class=nx>pendingUpdates</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>pendingUpdates</span><span class=p>.</span><span class=nx>filter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>update</span> <span class=p>=&gt;</span> <span class=nx>update</span><span class=p>.</span><span class=nx>version</span> <span class=o>&gt;</span> <span class=nx>serverVersion</span>
</span></span><span class=line><span class=cl>      <span class=p>);</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 대기 중인 업데이트 재적용
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>this</span><span class=p>.</span><span class=nx>pendingUpdates</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>update</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>state</span> <span class=o>=</span> <span class=nx>deepMerge</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>state</span><span class=p>,</span> <span class=nx>update</span><span class=p>.</span><span class=nx>patch</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>notifyListeners</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 대기 중인 업데이트 전송 (예시 구현)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>sendPendingUpdates</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>pendingUpdates</span><span class=p>.</span><span class=nx>length</span> <span class=o>===</span> <span class=mi>0</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// WebSocket이 연결되어 있는지 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>socket</span> <span class=o>&amp;&amp;</span> <span class=nx>socket</span><span class=p>.</span><span class=nx>readyState</span> <span class=o>===</span> <span class=nx>WebSocket</span><span class=p>.</span><span class=nx>OPEN</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>pendingUpdates</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>update</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>socket</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>          <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;state_update&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>update</span>
</span></span><span class=line><span class=cl>        <span class=p>}));</span>
</span></span><span class=line><span class=cl>      <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 변경 리스너 등록
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>onChange</span><span class=p>(</span><span class=nx>callback</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>listeners</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>callback</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>this</span><span class=p>.</span><span class=nx>listeners</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>listeners</span><span class=p>.</span><span class=nx>filter</span><span class=p>(</span><span class=nx>cb</span> <span class=p>=&gt;</span> <span class=nx>cb</span> <span class=o>!==</span> <span class=nx>callback</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 리스너 알림
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>notifyListeners</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>listeners</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>callback</span> <span class=p>=&gt;</span> <span class=nx>callback</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>state</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 헬퍼 함수: 깊은 병합
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>deepMerge</span><span class=p>(</span><span class=nx>target</span><span class=p>,</span> <span class=nx>source</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>output</span> <span class=o>=</span> <span class=p>{</span> <span class=p>...</span><span class=nx>target</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>isObject</span><span class=p>(</span><span class=nx>target</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nx>isObject</span><span class=p>(</span><span class=nx>source</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>Object</span><span class=p>.</span><span class=nx>keys</span><span class=p>(</span><span class=nx>source</span><span class=p>).</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>key</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>isObject</span><span class=p>(</span><span class=nx>source</span><span class=p>[</span><span class=nx>key</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=p>(</span><span class=nx>key</span> <span class=k>in</span> <span class=nx>target</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>output</span><span class=p>[</span><span class=nx>key</span><span class=p>]</span> <span class=o>=</span> <span class=nx>source</span><span class=p>[</span><span class=nx>key</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>output</span><span class=p>[</span><span class=nx>key</span><span class=p>]</span> <span class=o>=</span> <span class=nx>deepMerge</span><span class=p>(</span><span class=nx>target</span><span class=p>[</span><span class=nx>key</span><span class=p>],</span> <span class=nx>source</span><span class=p>[</span><span class=nx>key</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>output</span><span class=p>[</span><span class=nx>key</span><span class=p>]</span> <span class=o>=</span> <span class=nx>source</span><span class=p>[</span><span class=nx>key</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>output</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 헬퍼 함수: 객체 확인
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>isObject</span><span class=p>(</span><span class=nx>item</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span><span class=nx>item</span> <span class=o>&amp;&amp;</span> <span class=k>typeof</span> <span class=nx>item</span> <span class=o>===</span> <span class=s1>&#39;object&#39;</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nb>Array</span><span class=p>.</span><span class=nx>isArray</span><span class=p>(</span><span class=nx>item</span><span class=p>));</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>/ UUID 생성 헬퍼 함수</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>generateUUID</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=s1>&#39;xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx&#39;</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=sr>/[xy]/g</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=kr>const</span> <span class=nx>r</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>*</span> <span class=mi>16</span> <span class=o>|</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=kr>const</span> <span class=nx>v</span> <span class=o>=</span> <span class=nx>c</span> <span class=o>===</span> <span class=s1>&#39;x&#39;</span> <span class=o>?</span> <span class=nx>r</span> <span class=o>:</span> <span class=p>(</span><span class=nx>r</span> <span class=o>&amp;</span> <span class=mh>0x3</span> <span class=o>|</span> <span class=mh>0x8</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>v</span><span class=p>.</span><span class=nx>toString</span><span class=p>(</span><span class=mi>16</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=p>});</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// 사용 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>appState</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>SynchronizedState</span><span class=p>({</span>
</span></span><span class=line><span class=cl>	<span class=nx>todos</span><span class=o>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>	<span class=nx>settings</span><span class=o>:</span> <span class=p>{</span> <span class=nx>theme</span><span class=o>:</span> <span class=s1>&#39;light&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=c1>// 리스너 등록
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>appState</span><span class=p>.</span><span class=nx>onChange</span><span class=p>(</span><span class=nx>state</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;상태 변경:&#39;</span><span class=p>,</span> <span class=nx>state</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nx>renderUI</span><span class=p>(</span><span class=nx>state</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=c1>// 로컬 업데이트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>addTodo</span><span class=p>(</span><span class=nx>text</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>appState</span><span class=p>.</span><span class=nx>update</span><span class=p>({</span>
</span></span><span class=line><span class=cl>	<span class=nx>todos</span><span class=o>:</span> <span class=p>[...</span><span class=nx>appState</span><span class=p>.</span><span class=nx>state</span><span class=p>.</span><span class=nx>todos</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>id</span><span class=o>:</span> <span class=nx>generateUUID</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>		<span class=nx>text</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>completed</span><span class=o>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>	<span class=p>}]</span>
</span></span><span class=line><span class=cl>	<span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=보안-고려사항>보안 고려사항<a hidden class=anchor aria-hidden=true href=#보안-고려사항>#</a></h4><p>실시간 API는 특별한 보안 과제를 제기한다:</p><ol><li><strong>인증 및 권한 부여</strong>: 연결 시점과 메시지 송수신 시점 모두에서 적절한 인증이 필요하다.</li><li><strong>메시지 검증</strong>: 모든 수신 메시지의 형식과 내용을 철저히 검증해야 한다.</li><li><strong>속도 제한</strong>: 클라이언트당 메시지 속도를 제한하여 서비스 거부(DoS) 공격을 방지한다.</li><li><strong>전송 중 암호화</strong>: WebSocket을 사용할 때는 반드시 WSS(WebSocket Secure)를 사용해야 한다.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>  1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>  2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3>  3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4>  4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5>  5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6>  6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7>  7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8>  8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9>  9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10> 10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11> 11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12> 12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13> 13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14> 14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15> 15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16> 16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17> 17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18> 18</a>
</span><span class=lnt id=hl-9-19><a class=lnlinks href=#hl-9-19> 19</a>
</span><span class=lnt id=hl-9-20><a class=lnlinks href=#hl-9-20> 20</a>
</span><span class=lnt id=hl-9-21><a class=lnlinks href=#hl-9-21> 21</a>
</span><span class=lnt id=hl-9-22><a class=lnlinks href=#hl-9-22> 22</a>
</span><span class=lnt id=hl-9-23><a class=lnlinks href=#hl-9-23> 23</a>
</span><span class=lnt id=hl-9-24><a class=lnlinks href=#hl-9-24> 24</a>
</span><span class=lnt id=hl-9-25><a class=lnlinks href=#hl-9-25> 25</a>
</span><span class=lnt id=hl-9-26><a class=lnlinks href=#hl-9-26> 26</a>
</span><span class=lnt id=hl-9-27><a class=lnlinks href=#hl-9-27> 27</a>
</span><span class=lnt id=hl-9-28><a class=lnlinks href=#hl-9-28> 28</a>
</span><span class=lnt id=hl-9-29><a class=lnlinks href=#hl-9-29> 29</a>
</span><span class=lnt id=hl-9-30><a class=lnlinks href=#hl-9-30> 30</a>
</span><span class=lnt id=hl-9-31><a class=lnlinks href=#hl-9-31> 31</a>
</span><span class=lnt id=hl-9-32><a class=lnlinks href=#hl-9-32> 32</a>
</span><span class=lnt id=hl-9-33><a class=lnlinks href=#hl-9-33> 33</a>
</span><span class=lnt id=hl-9-34><a class=lnlinks href=#hl-9-34> 34</a>
</span><span class=lnt id=hl-9-35><a class=lnlinks href=#hl-9-35> 35</a>
</span><span class=lnt id=hl-9-36><a class=lnlinks href=#hl-9-36> 36</a>
</span><span class=lnt id=hl-9-37><a class=lnlinks href=#hl-9-37> 37</a>
</span><span class=lnt id=hl-9-38><a class=lnlinks href=#hl-9-38> 38</a>
</span><span class=lnt id=hl-9-39><a class=lnlinks href=#hl-9-39> 39</a>
</span><span class=lnt id=hl-9-40><a class=lnlinks href=#hl-9-40> 40</a>
</span><span class=lnt id=hl-9-41><a class=lnlinks href=#hl-9-41> 41</a>
</span><span class=lnt id=hl-9-42><a class=lnlinks href=#hl-9-42> 42</a>
</span><span class=lnt id=hl-9-43><a class=lnlinks href=#hl-9-43> 43</a>
</span><span class=lnt id=hl-9-44><a class=lnlinks href=#hl-9-44> 44</a>
</span><span class=lnt id=hl-9-45><a class=lnlinks href=#hl-9-45> 45</a>
</span><span class=lnt id=hl-9-46><a class=lnlinks href=#hl-9-46> 46</a>
</span><span class=lnt id=hl-9-47><a class=lnlinks href=#hl-9-47> 47</a>
</span><span class=lnt id=hl-9-48><a class=lnlinks href=#hl-9-48> 48</a>
</span><span class=lnt id=hl-9-49><a class=lnlinks href=#hl-9-49> 49</a>
</span><span class=lnt id=hl-9-50><a class=lnlinks href=#hl-9-50> 50</a>
</span><span class=lnt id=hl-9-51><a class=lnlinks href=#hl-9-51> 51</a>
</span><span class=lnt id=hl-9-52><a class=lnlinks href=#hl-9-52> 52</a>
</span><span class=lnt id=hl-9-53><a class=lnlinks href=#hl-9-53> 53</a>
</span><span class=lnt id=hl-9-54><a class=lnlinks href=#hl-9-54> 54</a>
</span><span class=lnt id=hl-9-55><a class=lnlinks href=#hl-9-55> 55</a>
</span><span class=lnt id=hl-9-56><a class=lnlinks href=#hl-9-56> 56</a>
</span><span class=lnt id=hl-9-57><a class=lnlinks href=#hl-9-57> 57</a>
</span><span class=lnt id=hl-9-58><a class=lnlinks href=#hl-9-58> 58</a>
</span><span class=lnt id=hl-9-59><a class=lnlinks href=#hl-9-59> 59</a>
</span><span class=lnt id=hl-9-60><a class=lnlinks href=#hl-9-60> 60</a>
</span><span class=lnt id=hl-9-61><a class=lnlinks href=#hl-9-61> 61</a>
</span><span class=lnt id=hl-9-62><a class=lnlinks href=#hl-9-62> 62</a>
</span><span class=lnt id=hl-9-63><a class=lnlinks href=#hl-9-63> 63</a>
</span><span class=lnt id=hl-9-64><a class=lnlinks href=#hl-9-64> 64</a>
</span><span class=lnt id=hl-9-65><a class=lnlinks href=#hl-9-65> 65</a>
</span><span class=lnt id=hl-9-66><a class=lnlinks href=#hl-9-66> 66</a>
</span><span class=lnt id=hl-9-67><a class=lnlinks href=#hl-9-67> 67</a>
</span><span class=lnt id=hl-9-68><a class=lnlinks href=#hl-9-68> 68</a>
</span><span class=lnt id=hl-9-69><a class=lnlinks href=#hl-9-69> 69</a>
</span><span class=lnt id=hl-9-70><a class=lnlinks href=#hl-9-70> 70</a>
</span><span class=lnt id=hl-9-71><a class=lnlinks href=#hl-9-71> 71</a>
</span><span class=lnt id=hl-9-72><a class=lnlinks href=#hl-9-72> 72</a>
</span><span class=lnt id=hl-9-73><a class=lnlinks href=#hl-9-73> 73</a>
</span><span class=lnt id=hl-9-74><a class=lnlinks href=#hl-9-74> 74</a>
</span><span class=lnt id=hl-9-75><a class=lnlinks href=#hl-9-75> 75</a>
</span><span class=lnt id=hl-9-76><a class=lnlinks href=#hl-9-76> 76</a>
</span><span class=lnt id=hl-9-77><a class=lnlinks href=#hl-9-77> 77</a>
</span><span class=lnt id=hl-9-78><a class=lnlinks href=#hl-9-78> 78</a>
</span><span class=lnt id=hl-9-79><a class=lnlinks href=#hl-9-79> 79</a>
</span><span class=lnt id=hl-9-80><a class=lnlinks href=#hl-9-80> 80</a>
</span><span class=lnt id=hl-9-81><a class=lnlinks href=#hl-9-81> 81</a>
</span><span class=lnt id=hl-9-82><a class=lnlinks href=#hl-9-82> 82</a>
</span><span class=lnt id=hl-9-83><a class=lnlinks href=#hl-9-83> 83</a>
</span><span class=lnt id=hl-9-84><a class=lnlinks href=#hl-9-84> 84</a>
</span><span class=lnt id=hl-9-85><a class=lnlinks href=#hl-9-85> 85</a>
</span><span class=lnt id=hl-9-86><a class=lnlinks href=#hl-9-86> 86</a>
</span><span class=lnt id=hl-9-87><a class=lnlinks href=#hl-9-87> 87</a>
</span><span class=lnt id=hl-9-88><a class=lnlinks href=#hl-9-88> 88</a>
</span><span class=lnt id=hl-9-89><a class=lnlinks href=#hl-9-89> 89</a>
</span><span class=lnt id=hl-9-90><a class=lnlinks href=#hl-9-90> 90</a>
</span><span class=lnt id=hl-9-91><a class=lnlinks href=#hl-9-91> 91</a>
</span><span class=lnt id=hl-9-92><a class=lnlinks href=#hl-9-92> 92</a>
</span><span class=lnt id=hl-9-93><a class=lnlinks href=#hl-9-93> 93</a>
</span><span class=lnt id=hl-9-94><a class=lnlinks href=#hl-9-94> 94</a>
</span><span class=lnt id=hl-9-95><a class=lnlinks href=#hl-9-95> 95</a>
</span><span class=lnt id=hl-9-96><a class=lnlinks href=#hl-9-96> 96</a>
</span><span class=lnt id=hl-9-97><a class=lnlinks href=#hl-9-97> 97</a>
</span><span class=lnt id=hl-9-98><a class=lnlinks href=#hl-9-98> 98</a>
</span><span class=lnt id=hl-9-99><a class=lnlinks href=#hl-9-99> 99</a>
</span><span class=lnt id=hl-9-100><a class=lnlinks href=#hl-9-100>100</a>
</span><span class=lnt id=hl-9-101><a class=lnlinks href=#hl-9-101>101</a>
</span><span class=lnt id=hl-9-102><a class=lnlinks href=#hl-9-102>102</a>
</span><span class=lnt id=hl-9-103><a class=lnlinks href=#hl-9-103>103</a>
</span><span class=lnt id=hl-9-104><a class=lnlinks href=#hl-9-104>104</a>
</span><span class=lnt id=hl-9-105><a class=lnlinks href=#hl-9-105>105</a>
</span><span class=lnt id=hl-9-106><a class=lnlinks href=#hl-9-106>106</a>
</span><span class=lnt id=hl-9-107><a class=lnlinks href=#hl-9-107>107</a>
</span><span class=lnt id=hl-9-108><a class=lnlinks href=#hl-9-108>108</a>
</span><span class=lnt id=hl-9-109><a class=lnlinks href=#hl-9-109>109</a>
</span><span class=lnt id=hl-9-110><a class=lnlinks href=#hl-9-110>110</a>
</span><span class=lnt id=hl-9-111><a class=lnlinks href=#hl-9-111>111</a>
</span><span class=lnt id=hl-9-112><a class=lnlinks href=#hl-9-112>112</a>
</span><span class=lnt id=hl-9-113><a class=lnlinks href=#hl-9-113>113</a>
</span><span class=lnt id=hl-9-114><a class=lnlinks href=#hl-9-114>114</a>
</span><span class=lnt id=hl-9-115><a class=lnlinks href=#hl-9-115>115</a>
</span><span class=lnt id=hl-9-116><a class=lnlinks href=#hl-9-116>116</a>
</span><span class=lnt id=hl-9-117><a class=lnlinks href=#hl-9-117>117</a>
</span><span class=lnt id=hl-9-118><a class=lnlinks href=#hl-9-118>118</a>
</span><span class=lnt id=hl-9-119><a class=lnlinks href=#hl-9-119>119</a>
</span><span class=lnt id=hl-9-120><a class=lnlinks href=#hl-9-120>120</a>
</span><span class=lnt id=hl-9-121><a class=lnlinks href=#hl-9-121>121</a>
</span><span class=lnt id=hl-9-122><a class=lnlinks href=#hl-9-122>122</a>
</span><span class=lnt id=hl-9-123><a class=lnlinks href=#hl-9-123>123</a>
</span><span class=lnt id=hl-9-124><a class=lnlinks href=#hl-9-124>124</a>
</span><span class=lnt id=hl-9-125><a class=lnlinks href=#hl-9-125>125</a>
</span><span class=lnt id=hl-9-126><a class=lnlinks href=#hl-9-126>126</a>
</span><span class=lnt id=hl-9-127><a class=lnlinks href=#hl-9-127>127</a>
</span><span class=lnt id=hl-9-128><a class=lnlinks href=#hl-9-128>128</a>
</span><span class=lnt id=hl-9-129><a class=lnlinks href=#hl-9-129>129</a>
</span><span class=lnt id=hl-9-130><a class=lnlinks href=#hl-9-130>130</a>
</span><span class=lnt id=hl-9-131><a class=lnlinks href=#hl-9-131>131</a>
</span><span class=lnt id=hl-9-132><a class=lnlinks href=#hl-9-132>132</a>
</span><span class=lnt id=hl-9-133><a class=lnlinks href=#hl-9-133>133</a>
</span><span class=lnt id=hl-9-134><a class=lnlinks href=#hl-9-134>134</a>
</span><span class=lnt id=hl-9-135><a class=lnlinks href=#hl-9-135>135</a>
</span><span class=lnt id=hl-9-136><a class=lnlinks href=#hl-9-136>136</a>
</span><span class=lnt id=hl-9-137><a class=lnlinks href=#hl-9-137>137</a>
</span><span class=lnt id=hl-9-138><a class=lnlinks href=#hl-9-138>138</a>
</span><span class=lnt id=hl-9-139><a class=lnlinks href=#hl-9-139>139</a>
</span><span class=lnt id=hl-9-140><a class=lnlinks href=#hl-9-140>140</a>
</span><span class=lnt id=hl-9-141><a class=lnlinks href=#hl-9-141>141</a>
</span><span class=lnt id=hl-9-142><a class=lnlinks href=#hl-9-142>142</a>
</span><span class=lnt id=hl-9-143><a class=lnlinks href=#hl-9-143>143</a>
</span><span class=lnt id=hl-9-144><a class=lnlinks href=#hl-9-144>144</a>
</span><span class=lnt id=hl-9-145><a class=lnlinks href=#hl-9-145>145</a>
</span><span class=lnt id=hl-9-146><a class=lnlinks href=#hl-9-146>146</a>
</span><span class=lnt id=hl-9-147><a class=lnlinks href=#hl-9-147>147</a>
</span><span class=lnt id=hl-9-148><a class=lnlinks href=#hl-9-148>148</a>
</span><span class=lnt id=hl-9-149><a class=lnlinks href=#hl-9-149>149</a>
</span><span class=lnt id=hl-9-150><a class=lnlinks href=#hl-9-150>150</a>
</span><span class=lnt id=hl-9-151><a class=lnlinks href=#hl-9-151>151</a>
</span><span class=lnt id=hl-9-152><a class=lnlinks href=#hl-9-152>152</a>
</span><span class=lnt id=hl-9-153><a class=lnlinks href=#hl-9-153>153</a>
</span><span class=lnt id=hl-9-154><a class=lnlinks href=#hl-9-154>154</a>
</span><span class=lnt id=hl-9-155><a class=lnlinks href=#hl-9-155>155</a>
</span><span class=lnt id=hl-9-156><a class=lnlinks href=#hl-9-156>156</a>
</span><span class=lnt id=hl-9-157><a class=lnlinks href=#hl-9-157>157</a>
</span><span class=lnt id=hl-9-158><a class=lnlinks href=#hl-9-158>158</a>
</span><span class=lnt id=hl-9-159><a class=lnlinks href=#hl-9-159>159</a>
</span><span class=lnt id=hl-9-160><a class=lnlinks href=#hl-9-160>160</a>
</span><span class=lnt id=hl-9-161><a class=lnlinks href=#hl-9-161>161</a>
</span><span class=lnt id=hl-9-162><a class=lnlinks href=#hl-9-162>162</a>
</span><span class=lnt id=hl-9-163><a class=lnlinks href=#hl-9-163>163</a>
</span><span class=lnt id=hl-9-164><a class=lnlinks href=#hl-9-164>164</a>
</span><span class=lnt id=hl-9-165><a class=lnlinks href=#hl-9-165>165</a>
</span><span class=lnt id=hl-9-166><a class=lnlinks href=#hl-9-166>166</a>
</span><span class=lnt id=hl-9-167><a class=lnlinks href=#hl-9-167>167</a>
</span><span class=lnt id=hl-9-168><a class=lnlinks href=#hl-9-168>168</a>
</span><span class=lnt id=hl-9-169><a class=lnlinks href=#hl-9-169>169</a>
</span><span class=lnt id=hl-9-170><a class=lnlinks href=#hl-9-170>170</a>
</span><span class=lnt id=hl-9-171><a class=lnlinks href=#hl-9-171>171</a>
</span><span class=lnt id=hl-9-172><a class=lnlinks href=#hl-9-172>172</a>
</span><span class=lnt id=hl-9-173><a class=lnlinks href=#hl-9-173>173</a>
</span><span class=lnt id=hl-9-174><a class=lnlinks href=#hl-9-174>174</a>
</span><span class=lnt id=hl-9-175><a class=lnlinks href=#hl-9-175>175</a>
</span><span class=lnt id=hl-9-176><a class=lnlinks href=#hl-9-176>176</a>
</span><span class=lnt id=hl-9-177><a class=lnlinks href=#hl-9-177>177</a>
</span><span class=lnt id=hl-9-178><a class=lnlinks href=#hl-9-178>178</a>
</span><span class=lnt id=hl-9-179><a class=lnlinks href=#hl-9-179>179</a>
</span><span class=lnt id=hl-9-180><a class=lnlinks href=#hl-9-180>180</a>
</span><span class=lnt id=hl-9-181><a class=lnlinks href=#hl-9-181>181</a>
</span><span class=lnt id=hl-9-182><a class=lnlinks href=#hl-9-182>182</a>
</span><span class=lnt id=hl-9-183><a class=lnlinks href=#hl-9-183>183</a>
</span><span class=lnt id=hl-9-184><a class=lnlinks href=#hl-9-184>184</a>
</span><span class=lnt id=hl-9-185><a class=lnlinks href=#hl-9-185>185</a>
</span><span class=lnt id=hl-9-186><a class=lnlinks href=#hl-9-186>186</a>
</span><span class=lnt id=hl-9-187><a class=lnlinks href=#hl-9-187>187</a>
</span><span class=lnt id=hl-9-188><a class=lnlinks href=#hl-9-188>188</a>
</span><span class=lnt id=hl-9-189><a class=lnlinks href=#hl-9-189>189</a>
</span><span class=lnt id=hl-9-190><a class=lnlinks href=#hl-9-190>190</a>
</span><span class=lnt id=hl-9-191><a class=lnlinks href=#hl-9-191>191</a>
</span><span class=lnt id=hl-9-192><a class=lnlinks href=#hl-9-192>192</a>
</span><span class=lnt id=hl-9-193><a class=lnlinks href=#hl-9-193>193</a>
</span><span class=lnt id=hl-9-194><a class=lnlinks href=#hl-9-194>194</a>
</span><span class=lnt id=hl-9-195><a class=lnlinks href=#hl-9-195>195</a>
</span><span class=lnt id=hl-9-196><a class=lnlinks href=#hl-9-196>196</a>
</span><span class=lnt id=hl-9-197><a class=lnlinks href=#hl-9-197>197</a>
</span><span class=lnt id=hl-9-198><a class=lnlinks href=#hl-9-198>198</a>
</span><span class=lnt id=hl-9-199><a class=lnlinks href=#hl-9-199>199</a>
</span><span class=lnt id=hl-9-200><a class=lnlinks href=#hl-9-200>200</a>
</span><span class=lnt id=hl-9-201><a class=lnlinks href=#hl-9-201>201</a>
</span><span class=lnt id=hl-9-202><a class=lnlinks href=#hl-9-202>202</a>
</span><span class=lnt id=hl-9-203><a class=lnlinks href=#hl-9-203>203</a>
</span><span class=lnt id=hl-9-204><a class=lnlinks href=#hl-9-204>204</a>
</span><span class=lnt id=hl-9-205><a class=lnlinks href=#hl-9-205>205</a>
</span><span class=lnt id=hl-9-206><a class=lnlinks href=#hl-9-206>206</a>
</span><span class=lnt id=hl-9-207><a class=lnlinks href=#hl-9-207>207</a>
</span><span class=lnt id=hl-9-208><a class=lnlinks href=#hl-9-208>208</a>
</span><span class=lnt id=hl-9-209><a class=lnlinks href=#hl-9-209>209</a>
</span><span class=lnt id=hl-9-210><a class=lnlinks href=#hl-9-210>210</a>
</span><span class=lnt id=hl-9-211><a class=lnlinks href=#hl-9-211>211</a>
</span><span class=lnt id=hl-9-212><a class=lnlinks href=#hl-9-212>212</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Node.js에서 인증 및 권한 부여가 포함된 WebSocket 서버 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>WebSocket</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;ws&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>jwt</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;jsonwebtoken&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>https</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;https&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>fs</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;fs&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// HTTPS 서버 생성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>server</span> <span class=o>=</span> <span class=nx>https</span><span class=p>.</span><span class=nx>createServer</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>cert</span><span class=o>:</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;/path/to/cert.pem&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=nx>key</span><span class=o>:</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;/path/to/key.pem&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// WebSocket 서버 생성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>wss</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>WebSocket</span><span class=p>.</span><span class=nx>Server</span><span class=p>({</span> <span class=nx>server</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// JWT 비밀 키
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>JWT_SECRET</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>JWT_SECRET</span> <span class=o>||</span> <span class=s1>&#39;your-secret-key&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 클라이언트별 메시지 속도 제한 추적
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>rateLimits</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Map</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 속도 제한 검사 함수
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>checkRateLimit</span><span class=p>(</span><span class=nx>clientId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>now</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>clientRateInfo</span> <span class=o>=</span> <span class=nx>rateLimits</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>clientId</span><span class=p>)</span> <span class=o>||</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>    <span class=nx>count</span><span class=o>:</span> <span class=mi>0</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=nx>lastReset</span><span class=o>:</span> <span class=nx>now</span> 
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 1분마다 카운터 리셋
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>now</span> <span class=o>-</span> <span class=nx>clientRateInfo</span><span class=p>.</span><span class=nx>lastReset</span> <span class=o>&gt;</span> <span class=mi>60000</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>clientRateInfo</span><span class=p>.</span><span class=nx>count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>clientRateInfo</span><span class=p>.</span><span class=nx>lastReset</span> <span class=o>=</span> <span class=nx>now</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 분당 100개 메시지 제한
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>clientRateInfo</span><span class=p>.</span><span class=nx>count</span> <span class=o>&gt;=</span> <span class=mi>100</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 카운터 증가 및 저장
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>clientRateInfo</span><span class=p>.</span><span class=nx>count</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>rateLimits</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>clientId</span><span class=p>,</span> <span class=nx>clientRateInfo</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 권한 확인 함수
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>checkPermission</span><span class=p>(</span><span class=nx>user</span><span class=p>,</span> <span class=nx>action</span><span class=p>,</span> <span class=nx>resource</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 권한 확인 로직 구현
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// 예: 특정 채널에 대한 메시지 전송 권한 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>action</span> <span class=o>===</span> <span class=s1>&#39;send&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>resource</span><span class=p>.</span><span class=nx>startsWith</span><span class=p>(</span><span class=s1>&#39;channel:&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>channelId</span> <span class=o>=</span> <span class=nx>resource</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>user</span><span class=p>.</span><span class=nx>channels</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=nx>channelId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 연결 이벤트 처리
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>wss</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;connection&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>ws</span><span class=p>,</span> <span class=nx>req</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 초기 상태 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>ws</span><span class=p>.</span><span class=nx>isAlive</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>ws</span><span class=p>.</span><span class=nx>user</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 핑/퐁 하트비트 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>ws</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;pong&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>ws</span><span class=p>.</span><span class=nx>isAlive</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 메시지 수신 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>ws</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;message&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>message</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 인증 메시지 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>if</span> <span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>type</span> <span class=o>===</span> <span class=s1>&#39;auth&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// JWT 토큰 검증
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=kr>const</span> <span class=nx>decoded</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>token</span><span class=p>,</span> <span class=nx>JWT_SECRET</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=nx>ws</span><span class=p>.</span><span class=nx>user</span> <span class=o>=</span> <span class=nx>decoded</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=nx>ws</span><span class=p>.</span><span class=nx>clientId</span> <span class=o>=</span> <span class=nx>decoded</span><span class=p>.</span><span class=nx>id</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          
</span></span><span class=line><span class=cl>          <span class=c1>// 인증 성공 응답
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=nx>ws</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;auth_response&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>success</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>          <span class=p>}));</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=c1>// 인증 실패 응답
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=nx>ws</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;auth_response&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>success</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Invalid token&#39;</span>
</span></span><span class=line><span class=cl>          <span class=p>}));</span>
</span></span><span class=line><span class=cl>          
</span></span><span class=line><span class=cl>          <span class=c1>// 인증 실패 시 연결 종료
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=nx>ws</span><span class=p>.</span><span class=nx>terminate</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 인증되지 않은 메시지 거부
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>ws</span><span class=p>.</span><span class=nx>user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>ws</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>          <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;error&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>code</span><span class=o>:</span> <span class=s1>&#39;unauthorized&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;Authentication required&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}));</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 속도 제한 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>checkRateLimit</span><span class=p>(</span><span class=nx>ws</span><span class=p>.</span><span class=nx>clientId</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>ws</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>          <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;error&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>code</span><span class=o>:</span> <span class=s1>&#39;rate_limited&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;Rate limit exceeded&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}));</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 메시지 유형별 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>switch</span> <span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>type</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s1>&#39;subscribe&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>          <span class=c1>// 채널 구독 권한 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=k>if</span> <span class=p>(</span><span class=nx>checkPermission</span><span class=p>(</span><span class=nx>ws</span><span class=p>.</span><span class=nx>user</span><span class=p>,</span> <span class=s1>&#39;subscribe&#39;</span><span class=p>,</span> <span class=sb>`channel:</span><span class=si>${</span><span class=nx>data</span><span class=p>.</span><span class=nx>channel</span><span class=si>}</span><span class=sb>`</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 구독 처리 로직
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>ws</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>              <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;subscribed&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nx>channel</span><span class=o>:</span> <span class=nx>data</span><span class=p>.</span><span class=nx>channel</span>
</span></span><span class=line><span class=cl>            <span class=p>}));</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>ws</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>              <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;error&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nx>code</span><span class=o>:</span> <span class=s1>&#39;permission_denied&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;No permission to subscribe to this channel&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>}));</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s1>&#39;message&#39;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>          <span class=c1>// 메시지 전송 권한 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=k>if</span> <span class=p>(</span><span class=nx>checkPermission</span><span class=p>(</span><span class=nx>ws</span><span class=p>.</span><span class=nx>user</span><span class=p>,</span> <span class=s1>&#39;send&#39;</span><span class=p>,</span> <span class=sb>`channel:</span><span class=si>${</span><span class=nx>data</span><span class=p>.</span><span class=nx>channel</span><span class=si>}</span><span class=sb>`</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 메시지 검증 (예: 콘텐츠 길이, 금지된 콘텐츠 등)
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>data</span><span class=p>.</span><span class=nx>content</span> <span class=o>||</span> <span class=nx>data</span><span class=p>.</span><span class=nx>content</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>1000</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=nx>ws</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;error&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>code</span><span class=o>:</span> <span class=s1>&#39;invalid_message&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;Message content invalid or too long&#39;</span>
</span></span><span class=line><span class=cl>              <span class=p>}));</span>
</span></span><span class=line><span class=cl>              <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 메시지 처리 및 브로드캐스트 로직
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>// …
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>ws</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>              <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;error&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nx>code</span><span class=o>:</span> <span class=s1>&#39;permission_denied&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;No permission to send to this channel&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>}));</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          
</span></span><span class=line><span class=cl>        <span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>          <span class=nx>ws</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;error&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>code</span><span class=o>:</span> <span class=s1>&#39;unknown_message_type&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>message</span><span class=o>:</span> <span class=sb>`Unknown message type: </span><span class=si>${</span><span class=nx>data</span><span class=p>.</span><span class=nx>type</span><span class=si>}</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>          <span class=p>}));</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 메시지 처리 오류
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>ws</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;error&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>code</span><span class=o>:</span> <span class=s1>&#39;message_processing_error&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;Failed to process message&#39;</span>
</span></span><span class=line><span class=cl>      <span class=p>}));</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;메시지 처리 오류:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 연결 종료 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>ws</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;close&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 정리 로직
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>ws</span><span class=p>.</span><span class=nx>clientId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>rateLimits</span><span class=p>.</span><span class=k>delete</span><span class=p>(</span><span class=nx>ws</span><span class=p>.</span><span class=nx>clientId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 비활성 연결 감지를 위한 간격 검사
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>interval</span> <span class=o>=</span> <span class=nx>setInterval</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>wss</span><span class=p>.</span><span class=nx>clients</span><span class=p>.</span><span class=nx>forEach</span><span class=p>((</span><span class=nx>ws</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>ws</span><span class=p>.</span><span class=nx>isAlive</span> <span class=o>===</span> <span class=kc>false</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>ws</span><span class=p>.</span><span class=nx>terminate</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>ws</span><span class=p>.</span><span class=nx>isAlive</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>ws</span><span class=p>.</span><span class=nx>ping</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>},</span> <span class=mi>30000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 서버 종료 시 간격 타이머 정리
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>wss</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;close&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>clearInterval</span><span class=p>(</span><span class=nx>interval</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 서버 시작
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>server</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=mi>8080</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Secure WebSocket 서버가 포트 8080에서 실행 중입니다&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=4-실시간-api-사용-사례>4. 실시간 API 사용 사례<a hidden class=anchor aria-hidden=true href=#4-실시간-api-사용-사례>#</a></h3><p>실시간 API는 다양한 애플리케이션 시나리오에서 활용된다:</p><ul><li><p>채팅 및 메시징 애플리케이션<br>채팅은 실시간 API의 가장 대표적인 사용 사례이다:</p><ol><li><strong>즉각적인 메시지 전달</strong>: 사용자 간 즉시 메시지를 전송한다.</li><li><strong>상태 알림</strong>: 사용자 상태(온라인, 오프라인, 입력 중 등)를 실시간으로 업데이트한다.</li><li><strong>읽음 확인</strong>: 메시지 수신 및 읽음 상태를 실시간으로 표시한다.</li></ol></li><li><p>협업 도구<br>문서 공동 작업, 화이트보드, 프로젝트 관리 등의 협업 도구는 실시간 기능을 통해 생산성을 높인다:</p><ol><li><strong>동시 편집</strong>: 여러 사용자가 동시에 같은 문서를 편집할 수 있다.</li><li><strong>변경 사항 실시간 반영</strong>: 다른 사용자의 변경 사항이 즉시 모든 참여자에게 표시된다.</li><li><strong>커서 위치 공유</strong>: 각 사용자의 현재 작업 위치를 실시간으로 표시한다.</li></ol></li><li><p>금융 및 거래 플랫폼<br>금융 시장 데이터와 거래 정보는 실시간 전송이 중요하다:</p><ol><li><strong>시장 데이터 스트리밍</strong>: 주식, 암호화폐, 외환 등의 가격 정보를 실시간으로 업데이트한다.</li><li><strong>거래 알림</strong>: 거래 실행, 주문 상태 변경 등을 즉시 알린다.</li><li><strong>위험 감지</strong>: 이상 거래나 위험 상황을 실시간으로 감지하고 알린다.</li></ol></li><li><p>온라인 게임<br>게임은 매우 낮은 지연 시간이 요구되는 실시간 통신의 대표적인 예:</p><ol><li><strong>위치 업데이트</strong>: 플레이어 위치와 동작을 실시간으로 동기화한다.</li><li><strong>게임 상태 동기화</strong>: 게임 세계의 상태를 모든 플레이어에게 일관되게 유지한다.</li><li><strong>실시간 상호작용</strong>: 플레이어 간 상호작용을 즉시 반영한다.</li></ol></li><li><p>IoT(사물인터넷) 애플리케이션<br>IoT 기기는 센서 데이터를 실시간으로 전송하고 원격 제어를 위한 명령을 수신한다:</p><ol><li><strong>센서 데이터 스트리밍</strong>: 온도, 습도, 위치 등의 센서 데이터를 실시간으로 전송한다.</li><li><strong>원격 제어</strong>: 기기 상태를 원격으로 제어하고 즉시 응답을 받는다.</li><li><strong>알림 및 경고</strong>: 중요한 이벤트나 임계값 초과 시 즉시 알림을 보낸다.</li></ol></li></ul><h3 id=실시간-api의-모범-사례>실시간 API의 모범 사례<a hidden class=anchor aria-hidden=true href=#실시간-api의-모범-사례>#</a></h3><p>실시간 API를 구현할 때 다음과 같은 모범 사례를 고려해야 한다:</p><ol><li><p>프로토콜 선택<br>애플리케이션 요구사항에 맞는 적절한 프로토콜을 선택하는 것이 중요하다:</p><ol><li><strong>양방향 통신이 필요한 경우</strong>: WebSocket 또는 gRPC</li><li><strong>서버에서 클라이언트로의 단방향 업데이트만 필요한 경우</strong>: SSE(Server-Sent Events)</li><li><strong>브라우저 호환성이 중요한 경우</strong>: WebSocket 또는 Long Polling</li><li><strong>높은 성능이 중요한 경우</strong>: gRPC 또는 최적화된 WebSocket</li></ol></li><li><p>효율적인 메시지 형식<br>메시지 형식은 효율성과 유연성을 고려해야 한다:</p><ol><li><strong>JSON</strong>: 가독성이 좋고 대부분의 환경에서 지원되지만, 크기가 상대적으로 크다.</li><li><strong>MessagePack</strong>: JSON보다 압축률이 높으며 이진 형식으로 효율적이다.</li><li><strong>Protocol Buffers</strong>: 매우 효율적인 이진 직렬화 형식으로 스키마 정의가 필요하다.</li><li><strong>CBOR</strong>: JSON과 유사하지만 더 효율적인 인코딩을 제공한다.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// JSON 형식의 메시지 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;type&#34;</span><span class=o>:</span> <span class=s2>&#34;update&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;channel&#34;</span><span class=o>:</span> <span class=s2>&#34;stocks&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;data&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;symbol&#34;</span><span class=o>:</span> <span class=s2>&#34;AAPL&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;price&#34;</span><span class=o>:</span> <span class=mf>150.25</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;change&#34;</span><span class=o>:</span> <span class=mf>2.75</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;timestamp&#34;</span><span class=o>:</span> <span class=mi>1633456789</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// JSON과 MessagePack 비교
</span></span></span><span class=line><span class=cl><span class=c1>// 위 JSON 메시지의 크기: 약 106 바이트
</span></span></span><span class=line><span class=cl><span class=c1>// MessagePack으로 인코딩 시 크기: 약 70 바이트
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>에러 처리 및 복원력<br>실시간 시스템에서 오류는 불가피하므로 이에 대비해야 한다:</p><ol><li><strong>명확한 오류 메시지</strong>: 클라이언트가 이해하고 대응할 수 있는 명확한 오류 코드와 메시지를 제공한다.</li><li><strong>자동 재연결</strong>: 연결 끊김 시 자동으로 재연결하는 메커니즘을 구현한다.</li><li><strong>상태 복구</strong>: 재연결 후 누락된 메시지나 상태를 복구하는 방법을 제공한다.</li><li><strong>점진적 기능 감소</strong>: 일부 기능에 문제가 있어도 가능한 많은 기능을 유지한다.</li></ol></li><li><p>문서화<br>실시간 API의 문서화는 특히 중요하다:</p><ol><li><strong>프로토콜 및 형식 설명</strong>: 사용된 프로토콜과 메시지 형식을 명확히 설명한다.</li><li><strong>메시지 타입 및 필드</strong>: 모든 메시지 타입과 필드를 상세히 문서화한다.</li><li><strong>이벤트 목록</strong>: 구독 가능한 모든 이벤트와 그 형식을 나열한다.</li><li><strong>인증 및 권한</strong>: 인증 방법과 필요한 권한을 명확히 설명한다.</li><li><strong>예제 코드</strong>: 다양한 언어와 플랫폼에 대한 예제 코드를 제공한다.</li></ol></li><li><p>테스트 및 시뮬레이션<br>실시간 API는 테스트가 복잡할 수 있으므로 적절한 도구와 방법이 필요하다:</p><ol><li><strong>부하 테스트</strong>: 많은 동시 연결을 처리할 수 있는지 확인한다.</li><li><strong>지연 시간 테스트</strong>: 메시지 전달 지연 시간을 측정한다.</li><li><strong>네트워크 조건 시뮬레이션</strong>: 불안정한 네트워크 환경에서의 동작을 테스트한다.</li><li><strong>장애 시뮬레이션</strong>: 서버 장애나 연결 끊김 시의 복구 동작을 확인한다.</li></ol></li></ol><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Types of Real-time APIs</h2></header><div class=entry-content><p>Types of Real-time APIs Real-time API는 클라이언트와 서버 간의 데이터를 거의 즉각적으로 주고받을 수 있는 API로, 실시간 데이터 교환을 가능하게 한다. 이는 사용자 경험을 향상시키고, 데이터 정확성과 응답성을 높이는 데 중요한 역할을 한다.
Real-time API의 주요 유형 WebSocket API 특징: 단일 TCP 연결을 통해 양방향 통신을 지원. 클라이언트와 서버가 모두 데이터를 주고받을 수 있음. 낮은 지연 시간과 효율적인 데이터 전송 가능. 사용 사례: 채팅 애플리케이션, 온라인 게임, 협업 도구. Server-Sent Events (SSE) API 특징: HTTP 기반 단방향 통신(서버 → 클라이언트). 지속적인 연결 유지 및 자동 재연결 지원. 텍스트 기반 데이터 전송(UTF-8). 사용 사례: 실시간 알림, 뉴스 피드, 주식 가격 업데이트. Streaming API 특징: 서버에서 클라이언트로 지속적인 데이터 스트림 제공. 대규모 데이터 처리에 적합(예: 비디오, 오디오 스트리밍). WebSocket 또는 SSE를 기반으로 구현 가능. 사용 사례: 라이브 비디오 스트리밍, 소셜 미디어 피드, IoT 센서 데이터. Pub/Sub API 특징: Publish-Subscribe 패턴 기반. 발행자(Publisher)가 특정 주제(Topic)에 메시지를 게시하면 구독자(Subscriber)가 이를 수신. 데이터 생산자와 소비자를 분리하여 확장성과 효율성 제공. 사용 사례: 메시징 시스템(Kafka, PubNub), IoT 장치 간 통신. Push API 특징: 서버에서 클라이언트로 푸시 알림 전송. 클라이언트가 활성화되지 않아도 메시지 수신 가능. 모바일 애플리케이션에서 주로 사용됨. 사용 사례: 모바일 푸시 알림(Firebase Cloud Messaging), 이메일 알림. Event-Driven API 특징: 이벤트 중심 설계로 상태 변화나 특정 이벤트 발생 시 데이터를 전달. 이벤트 구독 및 처리에 최적화됨. 사용 사례: IoT 애플리케이션, 실시간 모니터링 시스템. Real-Time API 기술 비교 기본 특성 비교 특성 WebSocket SSE (Server-Sent Events) Streaming API Pub/Sub API Push API Event-Driven API 통신 방향 양방향(전이중) 단방향(서버→클라이언트) 단방향/양방향 가능 다방향(다대다) 단방향(서버→클라이언트) 이벤트 기반 프로토콜 WS/WSS HTTP/HTTPS HTTP/HTTPS 다양(MQTT, AMQP 등) HTTP/HTTPS 다양 연결 유지 지속 연결 지속 연결 지속 연결 지속/비지속 가능 비연결성 이벤트 발생 시 자동 재연결 수동 구현 필요 내장 지원 구현에 따라 다름 구현에 따라 다름 구현에 따라 다름 구현에 따라 다름 메시지 포맷 텍스트/바이너리 텍스트(UTF-8) 다양(JSON, XML 등) 다양 JSON 다양 데이터 크기 프레임 크기 제한 제한 없음 청크 단위 전송 일반적으로 작은 메시지 작은 메시지 이벤트 크기 기술적 특성 및 구현 비교 특성 WebSocket SSE (Server-Sent Events) Streaming API Pub/Sub API Push API Event-Driven API 연결 설정 HTTP 업그레이드 후 WS 프로토콜 일반 HTTP 연결 HTTP 연결 다양한 연결 방식 서비스 워커 등록 이벤트 리스너 등록 클라이언트 API WebSocket EventSource HTTP/Fetch 라이브러리별 다양 Push API, Service Worker 이벤트 리스너 서버 구현 WebSocket 서버 필요 일반 HTTP 서버 일반 HTTP 서버 메시지 브로커 서버 푸시 서비스 이벤트 처리 시스템 확장성 연결 유지 부담 상대적으로 가벼움 리소스 집약적 높은 확장성 높은 확장성 높은 확장성 헤더 오버헤드 낮음(최초 연결 후) 중간 중간 낮음 중간 구현에 따라 다름 통합 난이도 중간 쉬움 중간 중간~어려움 어려움 중간~어려움 활용 사례 및 지원 비교 특성 WebSocket SSE (Server-Sent Events) Streaming API Pub/Sub API Push API Event-Driven API 즉시성 매우 높음 높음 중간~높음 중간~높음 중간 중간~높음 브라우저 지원 대부분 지원 대부분 지원(IE 제외) 모두 지원 라이브러리 필요 대부분 지원 구현에 따라 다름 보안 고려사항 WSS 필수, 인증 필요 HTTPS 권장, 인증 필요 HTTPS 권장, 인증 필요 인증/권한 관리 중요 인증 키/토큰 관리 이벤트 검증 중요 리소스 사용량 중간~높음 낮음~중간 중간~높음 중간 낮음 중간 최적 사용 사례 채팅, 게임, 협업 도구 알림, 뉴스 피드, 실시간 데이터 대용량 데이터 전송 분산 메시징, IoT 알림, 백그라운드 메시지 마이크로서비스, 이벤트 기록 성능 및 구현 고려사항 특성 WebSocket SSE (Server-Sent Events) Streaming API Pub/Sub API Push API Event-Driven API 지연 시간 매우 낮음(~100ms) 낮음(~500ms) 중간(~1s) 중간 높음(몇 초~몇 분) 구현에 따라 다름 처리량 높음 중간 매우 높음 매우 높음 낮음 구현에 따라 다름 배터리 영향 중간~높음 낮음~중간 중간~높음 구현에 따라 다름 낮음(백그라운드) 구현에 따라 다름 방화벽 통과 일부 제한 가능 대부분 허용 대부분 허용 혼합 대부분 허용 구현에 따라 다름 저대역폭 환경 적합하지 않음 적합함 적합하지 않음 구현에 따라 다름 적합함 구현에 따라 다름 오프라인 지원 미지원 미지원 미지원 일부 지원 가능 지원(백그라운드) 일부 지원 가능 용어 정리 용어 설명 참고 및 출처</p></div><footer class=entry-footer><span title='2025-02-15 01:56:00 +0000 UTC'>February 15, 2025</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Types of Real-time APIs" href=https://buenhyden.github.io/posts/networking/real-time-apis/types-of-real-time-apis/></a></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>