<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Token-Based Authentication | hyunyoun's Blog</title><meta name=keywords content="Backend-Development,API-Design,Authentication-Methods,Token-Based-Authentication"><meta name=description content="토큰 기반 인증은 사용자가 자신의 자격 증명(일반적으로 사용자 이름과 비밀번호)을 인증 서버에 제출하면, 서버가 이를 검증한 후 디지털 토큰을 발급하는 방식이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Token-Based Authentication"><meta property="og:description" content="토큰 기반 인증은 사용자가 자신의 자격 증명(일반적으로 사용자 이름과 비밀번호)을 인증 서버에 제출하면, 서버가 이를 검증한 후 디지털 토큰을 발급하는 방식이다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Token-Based Authentication"><meta name=twitter:description content="토큰 기반 인증은 사용자가 자신의 자격 증명(일반적으로 사용자 이름과 비밀번호)을 인증 서버에 제출하면, 서버가 이를 검증한 후 디지털 토큰을 발급하는 방식이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Token-Based Authentication","item":"https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a></div><h1>Token-Based Authentication</h1><div class=post-description>토큰 기반 인증은 사용자가 자신의 자격 증명(일반적으로 사용자 이름과 비밀번호)을 인증 서버에 제출하면, 서버가 이를 검증한 후 디지털 토큰을 발급하는 방식이다.</div></header><div class=post-content><h2 id=token-based-authentication>Token-Based Authentication<a hidden class=anchor aria-hidden=true href=#token-based-authentication>#</a></h2><p>아래는 “Token-Based Authentication(토큰 기반 인증)” 주제에 대한 체계적이고 깊이 있는 IT 백엔드 개발자 관점의 조사, 분석, 정리 결과입니다.</p><hr><h2 id=1-태그keyword-tag>1. 태그(Keyword-Tag)<a hidden class=anchor aria-hidden=true href=#1-태그keyword-tag>#</a></h2><ul><li>Token-Based-Authentication</li><li>Authentication-Token</li><li>Stateless-Authentication</li><li>Access-Control</li></ul><hr><h2 id=2-카테고리-계층-구조-검토>2. 카테고리 계층 구조 검토<a hidden class=anchor aria-hidden=true href=#2-카테고리-계층-구조-검토>#</a></h2><p><strong>제시된 계층 구조:</strong><br>Computer Science and Engineering > Cybersecurity and Information Security > Access Control > Implementations</p><p><strong>분석 및 근거:</strong><br>토큰 기반 인증은 접근 제어(Access Control)의 핵심 구현 방식 중 하나로, 인증 정보를 서버에 저장하지 않고 클라이언트가 관리하는 토큰을 통해 사용자 신원을 확인한다. 이는 정보 보안(Cybersecurity and Information Security)의 중요한 요소이며, 컴퓨터 공학(Computer Science and Engineering)의 실무적 적용 사례로 매우 적합하다. 따라서 제시된 계층 구조는 논리적이고 타당하다.</p><hr><h2 id=3-주제-요약200자-내외>3. 주제 요약(200자 내외)<a hidden class=anchor aria-hidden=true href=#3-주제-요약200자-내외>#</a></h2><p>토큰 기반 인증은 서버가 사용자 인증 정보를 저장하지 않고, 클라이언트가 제출한 토큰을 검증하여 인증 및 접근 권한을 부여하는 방식으로, 확장성과 분산 환경에 적합하다.</p><hr><h2 id=4-전체-개요250자-내외>4. 전체 개요(250자 내외)<a hidden class=anchor aria-hidden=true href=#4-전체-개요250자-내외>#</a></h2><p>토큰 기반 인증은 클라이언트가 서버로부터 발급받은 토큰을 이후 요청에 포함해 서버가 이를 검증하는 방식으로, 서버는 별도의 세션 정보를 저장하지 않아도 된다. 이 방식은 마이크로서비스, SPA, 모바일 앱 등 다양한 환경에서 널리 사용된다.</p><hr><h2 id=5-핵심-개념>5. 핵심 개념<a hidden class=anchor aria-hidden=true href=#5-핵심-개념>#</a></h2><ul><li><strong>정의:</strong><br>토큰 기반 인증은 서버가 클라이언트에게 인증 토큰을 발급하고, 클라이언트는 이후 요청에 이 토큰을 포함해 서버가 신원을 확인하는 방식이다.</li><li><strong>특징:</strong><ul><li><strong>Stateless(상태 비저장):</strong> 서버는 세션 정보를 저장하지 않는다.</li><li><strong>확장성:</strong> 서버 부담 감소, 분산 시스템에 적합.</li><li><strong>보안:</strong> 토큰의 서명/암호화로 위변조 방지.</li></ul></li><li><strong>실무 연관성:</strong><ul><li><strong>마이크로서비스, SPA, 모바일 앱 등에서 널리 사용.</strong></li><li><strong>서버 확장성, 인증 정보의 신뢰성, 클라이언트-서버 간 통신 간소화에 기여.</strong></li></ul></li></ul><hr><h2 id=6-주제와-관련하여-조사할-내용>6. 주제와 관련하여 조사할 내용<a hidden class=anchor aria-hidden=true href=#6-주제와-관련하여-조사할-내용>#</a></h2><h3 id=61-배경>6.1. 배경<a hidden class=anchor aria-hidden=true href=#61-배경>#</a></h3><ul><li><strong>세션 기반 인증의 한계:</strong> 서버에 세션 정보를 저장해야 하므로 확장성, 분산 시스템에서 비효율적.</li><li><strong>토큰 기반 인증의 필요성:</strong> 서버 부담 감소, 클라이언트-서버 간 인증 정보 교환의 간소화.</li></ul><h3 id=62-목적-및-필요성>6.2. 목적 및 필요성<a hidden class=anchor aria-hidden=true href=#62-목적-및-필요성>#</a></h3><ul><li><strong>목적:</strong> 사용자 인증 및 권한 부여 정보를 안전하게 전달.</li><li><strong>필요성:</strong> 세션 관리 없이도 신뢰할 수 있는 인증 정보 제공.</li></ul><h3 id=63-주요-기능-및-역할>6.3. 주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#63-주요-기능-및-역할>#</a></h3><ul><li><strong>인증(Authentication):</strong> 사용자 신원 확인.</li><li><strong>권한 부여(Authorization):</strong> 리소스 접근 권한 확인.</li><li><strong>정보 교환(Information Exchange):</strong> 신뢰할 수 있는 정보 전달.</li></ul><h3 id=64-특징>6.4. 특징<a hidden class=anchor aria-hidden=true href=#64-특징>#</a></h3><ul><li><strong>Stateless:</strong> 서버에 상태 저장 불필요.</li><li><strong>Self-contained:</strong> 모든 정보가 토큰 내에 포함.</li><li><strong>Compact:</strong> HTTP 헤더 등에 쉽게 포함 가능.</li><li><strong>Cross-domain:</strong> 도메인 간 인증 가능.</li></ul><h3 id=65-핵심-원칙>6.5. 핵심 원칙<a hidden class=anchor aria-hidden=true href=#65-핵심-원칙>#</a></h3><ul><li><strong>무결성(Integrity):</strong> 서명으로 위변조 방지.</li><li><strong>신뢰성(Trust):</strong> 발급자(issuer)와 수신자(audience) 확인.</li><li><strong>유효성(Validity):</strong> 만료 시간(exp), 발급 시간(iat) 등으로 유효성 관리.</li></ul><h3 id=66-주요-원리>6.6. 주요 원리<a hidden class=anchor aria-hidden=true href=#66-주요-원리>#</a></h3><ul><li><strong>토큰 발급:</strong> 인증 성공 시 서버가 토큰 발급.</li><li><strong>토큰 검증:</strong> 클라이언트가 토큰을 포함해 요청, 서버가 토큰 검증.</li><li><strong>인증/권한 부여:</strong> 검증 성공 시 리소스 접근 허용.</li></ul><h3 id=67-작동-원리-다이어그램워크플로우>6.7. 작동 원리 (다이어그램/워크플로우)<a hidden class=anchor aria-hidden=true href=#67-작동-원리-다이어그램워크플로우>#</a></h3><pre class=mermaid>sequenceDiagram
    participant Client
    participant AuthServer
    participant ResourceServer

    Client-&gt;&gt;AuthServer: 로그인(아이디/비밀번호)
    AuthServer-&gt;&gt;Client: 토큰 발급
    Client-&gt;&gt;ResourceServer: 토큰 포함 요청
    ResourceServer-&gt;&gt;ResourceServer: 토큰 검증
    ResourceServer-&gt;&gt;Client: 리소스 반환
</pre><ul><li><strong>설명:</strong> 클라이언트가 인증 서버에 로그인하여 토큰을 받고, 이후 리소스 서버에 토큰을 포함해 요청하면 리소스 서버는 토큰을 검증하여 인증 및 권한을 확인한다.</li></ul><h3 id=68-구조-및-아키텍처>6.8. 구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#68-구조-및-아키텍처>#</a></h3><h4 id=구성-요소><strong>구성 요소</strong><a hidden class=anchor aria-hidden=true href=#구성-요소>#</a></h4><ul><li><strong>클라이언트:</strong> 토큰을 요청하고, 이후 요청에 토큰을 포함.</li><li><strong>인증 서버:</strong> 사용자 인증 후 토큰 발급.</li><li><strong>리소스 서버:</strong> 토큰 검증 후 리소스 제공.</li><li><strong>토큰:</strong> 인증 및 권한 정보를 담은 데이터.</li></ul><h4 id=구조-다이어그램><strong>구조 다이어그램</strong><a hidden class=anchor aria-hidden=true href=#구조-다이어그램>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5>5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6>6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7>7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>+-----------+     +---------------+     +---------------+
</span></span><span class=line><span class=cl>| Client    || Auth Server   || Resource Server|
</span></span><span class=line><span class=cl>+-----------+     +---------------+     +---------------+
</span></span><span class=line><span class=cl>      |                  |                     |
</span></span><span class=line><span class=cl>      |---토큰 요청-----&gt;|                     |
</span></span><span class=line><span class=cl>      ||
</span></span><span class=line><span class=cl>      |                  |                     |
</span></span><span class=line><span class=cl>      |&lt;---------------------------------------|
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>설명:</strong> 클라이언트는 인증 서버에 로그인하여 토큰을 받고, 이후 리소스 서버에 토큰을 포함해 요청한다.</li></ul><h4 id=필수-구성요소-vs-선택-구성요소><strong>필수 구성요소 vs 선택 구성요소</strong><a hidden class=anchor aria-hidden=true href=#필수-구성요소-vs-선택-구성요소>#</a></h4><table><thead><tr><th>구분</th><th>구성요소</th><th>기능/역할</th><th>특징</th></tr></thead><tbody><tr><td>필수</td><td>클라이언트</td><td>토큰 요청 및 포함</td><td>사용자 인터페이스</td></tr><tr><td>필수</td><td>인증 서버</td><td>인증 및 토큰 발급</td><td>신뢰된 인증 주체</td></tr><tr><td>필수</td><td>리소스 서버</td><td>토큰 검증 및 리소스 제공</td><td>보호된 리소스 제공</td></tr><tr><td>필수</td><td>토큰</td><td>인증/권한 정보 담김</td><td>자기 완결적</td></tr><tr><td>선택</td><td>토큰 저장소</td><td>토큰 관리(블랙리스트 등)</td><td>부가적 기능</td></tr></tbody></table><h3 id=69-구현-기법>6.9. 구현 기법<a hidden class=anchor aria-hidden=true href=#69-구현-기법>#</a></h3><ul><li><strong>토큰 발급:</strong> 인증 성공 시 서버가 토큰 생성(예: JWT, OAuth Token).</li><li><strong>토큰 검증:</strong> 서버가 토큰의 서명/암호화를 검증.</li><li><strong>토큰 관리:</strong> 만료 시간, 블랙리스트 등으로 토큰 관리.</li><li><strong>실제 예시:</strong><ul><li><strong>시스템 구성:</strong> Auth Server, Resource Server, Client</li><li><strong>시나리오:</strong> 로그인 → 토큰 발급 → API 요청 시 토큰 포함 → 토큰 검증 및 리소스 제공.</li></ul></li></ul><h3 id=610-장점>6.10. 장점<a hidden class=anchor aria-hidden=true href=#610-장점>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>특성 원인</th></tr></thead><tbody><tr><td>장점</td><td>Stateless</td><td>서버에 세션 저장 불필요, 확장성 향상</td><td>상태 비저장 구조</td></tr><tr><td></td><td>Self-contained</td><td>모든 인증 정보가 토큰 내에 포함, DB 조회 불필요</td><td>토큰의 자기 완결성</td></tr><tr><td></td><td>Cross-domain</td><td>도메인 간 인증 가능, SPA/모바일 앱에 적합</td><td>토큰의 이동성</td></tr><tr><td></td><td>Compact</td><td>HTTP 헤더 등에 쉽게 포함 가능, 네트워크 부하 감소</td><td>토큰의 경량성</td></tr><tr><td></td><td>신뢰성</td><td>서명으로 위변조 방지, 신뢰할 수 있는 인증 정보 제공</td><td>암호화/서명</td></tr></tbody></table><h3 id=611-단점과-문제점-그리고-해결방안>6.11. 단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#611-단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>단점</td><td>Stateless 한계</td><td>토큰 만료 전 강제 폐기(revoke) 어려움</td><td>짧은 만료 시간, 블랙리스트</td></tr><tr><td></td><td>토큰 크기</td><td>클레임이 많아지면 토큰 크기 증가, 네트워크 부하</td><td>필요한 클레임만 포함</td></tr><tr><td></td><td>보안 취약점</td><td>토큰 탈취 시 인증 우회 가능</td><td>HTTPS, 보안 헤더 적용</td></tr></tbody></table><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 방법 및 기법</th></tr></thead><tbody><tr><td>문제점</td><td>토큰 탈취</td><td>XSS, CSRF 등 보안 취약점</td><td>인증 우회</td><td>로그 분석, 모니터링</td><td>보안 헤더 적용</td><td>짧은 만료 시간, HTTPS</td></tr><tr><td></td><td>재생 공격</td><td>토큰 재사용</td><td>인증 우회</td><td>jti 클레임 사용</td><td>일회용 토큰</td><td>jti 클레임 활용</td></tr></tbody></table><h3 id=612-도전-과제>6.12. 도전 과제<a hidden class=anchor aria-hidden=true href=#612-도전-과제>#</a></h3><ul><li><strong>토큰 만료 전 강제 폐기:</strong> Stateless 특성상 실시간 폐기 어려움 → 블랙리스트, 짧은 만료 시간 등 대안 필요.</li><li><strong>대규모 시스템에서의 토큰 관리:</strong> 마이크로서비스 환경에서 토큰 검증 부하 분산 필요.</li><li><strong>보안 취약점 대응:</strong> XSS, CSRF 등 웹 보안 위협에 대한 지속적 대응 필요.</li></ul><h3 id=613-분류-기준에-따른-종류-및-유형>6.13. 분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#613-분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th>분류 기준</th><th>종류/유형</th><th>설명</th></tr></thead><tbody><tr><td>토큰 형식</td><td>JWT, OAuth Token</td><td>JSON 형식, OAuth 프로토콜 기반</td></tr><tr><td>암호화 유무</td><td>서명만, 암호화</td><td>서명만(JWS), 암호화 포함(JWE)</td></tr><tr><td>사용 목적</td><td>인증, 권한 부여</td><td>인증용, 권한 부여용</td></tr></tbody></table><h3 id=614-실무-사용-예시>6.14. 실무 사용 예시<a hidden class=anchor aria-hidden=true href=#614-실무-사용-예시>#</a></h3><table><thead><tr><th>시스템/목적</th><th>사용 목적</th><th>효과</th></tr></thead><tbody><tr><td>웹/모바일 앱 인증</td><td>사용자 인증/권한 부여</td><td>세션 관리 불필요, 확장성</td></tr><tr><td>API Gateway</td><td>마이크로서비스 인증</td><td>중앙 집중식 인증 관리</td></tr><tr><td>SSO(Single Sign-On)</td><td>다중 시스템 통합 인증</td><td>사용자 편의성, 보안 강화</td></tr></tbody></table><h3 id=615-활용-사례>6.15. 활용 사례<a hidden class=anchor aria-hidden=true href=#615-활용-사례>#</a></h3><p><strong>사례: 마이크로서비스 환경에서의 토큰 기반 인증</strong></p><ul><li><strong>시스템 구성:</strong> Auth Server, API Gateway, Microservices</li><li><strong>워크플로우:</strong><ol><li>사용자 로그인 → Auth Server에서 토큰 발급</li><li>클라이언트가 API Gateway에 토큰 포함 요청</li><li>API Gateway에서 토큰 검증 후 Microservice로 요청 전달</li><li>Microservice는 추가 인증 없이 요청 처리</li></ol></li><li><strong>토큰 기반 인증 역할:</strong> 인증 및 권한 정보 전달, 서버 간 신뢰 구축</li><li><strong>차이점:</strong> 토큰 기반 인증 미사용 시 각 서비스별 인증 필요, 사용 시 중앙 집중식 인증 가능.</li></ul><h3 id=616-구현-예시-python>6.16. 구현 예시 (Python)<a hidden class=anchor aria-hidden=true href=#616-구현-예시-python>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span><span class=lnt id=hl-2-21><a class=lnlinks href=#hl-2-21>21</a>
</span><span class=lnt id=hl-2-22><a class=lnlinks href=#hl-2-22>22</a>
</span><span class=lnt id=hl-2-23><a class=lnlinks href=#hl-2-23>23</a>
</span><span class=lnt id=hl-2-24><a class=lnlinks href=#hl-2-24>24</a>
</span><span class=lnt id=hl-2-25><a class=lnlinks href=#hl-2-25>25</a>
</span><span class=lnt id=hl-2-26><a class=lnlinks href=#hl-2-26>26</a>
</span><span class=lnt id=hl-2-27><a class=lnlinks href=#hl-2-27>27</a>
</span><span class=lnt id=hl-2-28><a class=lnlinks href=#hl-2-28>28</a>
</span><span class=lnt id=hl-2-29><a class=lnlinks href=#hl-2-29>29</a>
</span><span class=lnt id=hl-2-30><a class=lnlinks href=#hl-2-30>30</a>
</span><span class=lnt id=hl-2-31><a class=lnlinks href=#hl-2-31>31</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>jwt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>SECRET_KEY</span> <span class=o>=</span> <span class=s1>&#39;your-secret-key&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># 인증 로직 생략 (예: 아이디/비밀번호 확인)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;sub&#39;</span><span class=p>:</span> <span class=s1>&#39;user123&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;iat&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;exp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>+</span> <span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>hours</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>token</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>payload</span><span class=p>,</span> <span class=n>SECRET_KEY</span><span class=p>,</span> <span class=n>algorithm</span><span class=o>=</span><span class=s1>&#39;HS256&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;token&#39;</span><span class=p>:</span> <span class=n>token</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/protected&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>protected</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>token</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;Authorization&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>token</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;토큰이 필요합니다.&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>SECRET_KEY</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;HS256&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=s1>&#39;인증 성공&#39;</span><span class=p>,</span> <span class=s1>&#39;user&#39;</span><span class=p>:</span> <span class=n>payload</span><span class=p>[</span><span class=s1>&#39;sub&#39;</span><span class=p>]})</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;토큰이 유효하지 않습니다.&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>설명:</strong> Flask 기반 토큰(JWT) 발급 및 검증 예시.</li></ul><h3 id=617-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>6.17. 실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#617-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>항목</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>토큰 만료 시간</td><td>너무 길면 보안 위험, 너무 짧으면 사용자 불편</td><td>1시간 내외 권장</td></tr><tr><td>민감정보 포함 금지</td><td>토큰은 암호화되지 않을 수 있음</td><td>민감정보 포함 금지</td></tr><tr><td>서명 알고리즘 강제</td><td>취약 알고리즘 방지</td><td>알고리즘 강제 지정</td></tr><tr><td>HTTPS 사용</td><td>토큰 탈취 방지</td><td>반드시 HTTPS 사용</td></tr><tr><td>라이브러리 업데이트</td><td>보안 취약점 대응</td><td>최신 버전 유지</td></tr></tbody></table><h3 id=618-최적화하기-위한-고려사항-및-주의할-점>6.18. 최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#618-최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>항목</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>클레임 최소화</td><td>불필요한 클레임 포함 금지</td><td>필요한 클레임만 포함</td></tr><tr><td>토큰 크기 관리</td><td>클레임이 많아지면 네트워크 부하</td><td>클레임 최소화</td></tr><tr><td>검증 부하 분산</td><td>대규모 시스템에서 토큰 검증 부하 분산</td><td>API Gateway에서 검증</td></tr><tr><td>짧은 만료 시간</td><td>보안 강화</td><td>1시간 내외 권장</td></tr></tbody></table><hr><h2 id=7-기타-사항>7. 기타 사항<a hidden class=anchor aria-hidden=true href=#7-기타-사항>#</a></h2><ul><li><strong>토큰 기반 인증 vs 세션 기반 인증:</strong><ul><li><strong>토큰 기반:</strong> Stateless, 확장성 우수, 분산 시스템에 적합.</li><li><strong>세션 기반:</strong> Stateful, 서버에 세션 저장, 확장성 한계.</li></ul></li><li><strong>OAuth, JWT 등 다양한 토큰 형식 존재.</strong></li><li><strong>실무 적용 시:</strong> 마이크로서비스, SPA, 모바일 앱 등에서 널리 사용.</li></ul><hr><h2 id=8-주제와-관련하여-주목할-내용>8. 주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#8-주제와-관련하여-주목할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>보안</td><td>토큰 기반 인증</td><td>서명/암호화</td><td>HMAC, RSA, ECDSA 등 다양한 알고리즘</td></tr><tr><td>아키텍처</td><td>토큰 기반 인증</td><td>Stateless</td><td>서버 세션 불필요, 확장성</td></tr><tr><td>실무 적용</td><td>토큰 기반 인증</td><td>마이크로서비스</td><td>중앙 집중식 인증, 서버 간 신뢰 구축</td></tr><tr><td>표준</td><td>토큰 기반 인증</td><td>JWT, OAuth</td><td>공식 표준 문서</td></tr></tbody></table><hr><h2 id=9-반드시-학습해야할-내용>9. 반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#9-반드시-학습해야할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>보안</td><td>토큰 기반 인증</td><td>서명/암호화</td><td>HMAC, RSA, ECDSA 등 알고리즘 이해</td></tr><tr><td>표준</td><td>토큰 기반 인증</td><td>JWT, OAuth</td><td>공식 표준 문서 학습</td></tr><tr><td>실무</td><td>토큰 기반 인증</td><td>라이브러리 활용</td><td>PyJWT, OAuth2 등 라이브러리 사용법</td></tr><tr><td>아키텍처</td><td>토큰 기반 인증</td><td>Stateless</td><td>서버 세션 불필요, 확장성 이해</td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>표준</td><td>JWT</td><td>JSON Web Token, 인증 토큰 표준</td></tr><tr><td>표준</td><td>OAuth</td><td>인증/권한 부여 프로토콜</td></tr><tr><td>보안</td><td>HMAC</td><td>해시 기반 메시지 인증 코드</td></tr><tr><td>보안</td><td>RSA</td><td>비대칭키 암호화 알고리즘</td></tr><tr><td>보안</td><td>ECDSA</td><td>타원곡선 디지털 서명 알고리즘</td></tr><tr><td>아키텍처</td><td>Stateless</td><td>서버에 상태 저장 불필요</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://auth0.com/docs/secure/tokens/token-based-authentication-best-practices>Token-based Authentication - Auth0</a></li><li><a href=https://supertokens.com/blog/oauth-vs-jwt>JWT vs OAuth - SuperTokens</a></li><li><a href=https://stackoverflow.blog/2020/11/16/token-based-authentication/>Token-based Authentication - Stack Overflow Blog</a></li><li><a href=https://www.okta.com/identity-101/token-based-authentication/>Token-based Authentication - Okta</a></li><li><a href=https://www.digitalocean.com/community/tutorials/token-based-authentication-for-restful-apis>Token-based Authentication - DigitalOcean</a></li><li><a href=https://jwt.io/introduction>JWT 구조 및 예시 - jwt.io</a></li><li><a href=https://oauth.net/2/>OAuth 2.0 - OAuth.net</a></li><li><a href=https://www.descope.com/blog/post/oauth-vs-jwt>OAuth vs JWT - Descope</a></li><li><a href="https://www.ibm.com/docs/en/api-connect/10.0.x?topic=security-token-based-authentication">Token-based Authentication - IBM Cloud</a></li><li><a href=https://learn.microsoft.com/en-us/azure/active-directory/develop/authentication-scenarios#token-based-authentication>Token-based Authentication - Microsoft Docs</a></li><li><a href=https://spring.io/guides/topicals/spring-security-architecture>Token-based Authentication - Spring Security</a></li><li><a href=https://nordicapis.com/token-based-authentication-for-restful-apis/>Token-based Authentication - REST API - Nordic APIs</a></li><li><a href=https://www.geeksforgeeks.org/token-based-authentication/>Token-based Authentication - GeeksforGeeks</a></li><li><a href=https://en.wikipedia.org/wiki/Token-based_authentication>Token-based Authentication - Wikipedia</a></li></ul><p>아래는 <strong>Token-Based Authentication</strong>에 대한 심화 분석입니다. 요청하신 4부분 구성에 따라 체계적으로 정리했습니다.</p><hr><h2 id=1-핵심-개념>1. 핵심 개념<a hidden class=anchor aria-hidden=true href=#1-핵심-개념>#</a></h2><ul><li><strong>정의</strong>: 사용자 인증을 위한 토큰 기반 방식으로, 인증 후 발급된 토큰을 통해 반복 로그인 없이 API/서비스 접근을 수행하는 프로토콜 (<a href="https://www.okta.com/identity-101/what-is-token-based-authentication/?utm_source=chatgpt.com" title="What Is Token-Based Authentication? - Okta">okta.com</a>)</li><li><strong>토큰 유형</strong>: Access Token, Refresh Token, ID Token, API Token, OTP 등 포함 (<a href="https://frontegg.com/blog/token-based-authentication?utm_source=chatgpt.com" title="Understanding Token-Based Authentication: A Detailed Review">frontegg.com</a>)</li><li><strong>Stateless 특성</strong>: 서버에 상태 저장 없이 토큰 자체에 사용자 정보 포함 → 확장성·성능 우수 (<a href="https://frontegg.com/blog/token-based-authentication?utm_source=chatgpt.com" title="Understanding Token-Based Authentication: A Detailed Review">frontegg.com</a>)</li><li><strong>보안</strong>: 서명 또는 암호화된 토큰으로 위변조 방지, 만료 설정, HTTPS 전송을 통한 전송 보안 확보</li></ul><hr><h2 id=2-배경-및-목적>2. 배경 및 목적<a hidden class=anchor aria-hidden=true href=#2-배경-및-목적>#</a></h2><ul><li><p><strong>배경</strong>: 전통 세션 방식의 확장성 한계, 분산 시스템/모바일/SPA 확산에 따라 등장</p></li><li><p><strong>목적</strong>:</p><ul><li>무상태(stateless) 인증을 통한 서버 부담 감소</li><li>다양한 플랫폼/마이크로서비스 간 호환성 제공</li><li>단순화된 인증 흐름 및 높은 사용자 경험 제공 (<a href="https://frontegg.com/blog/token-based-authentication?utm_source=chatgpt.com" title="Understanding Token-Based Authentication: A Detailed Review">frontegg.com</a>)</li></ul></li></ul><hr><h2 id=3-구조-및-아키텍처-구성-요소-포함>3. 구조 및 아키텍처 (구성 요소 포함)<a hidden class=anchor aria-hidden=true href=#3-구조-및-아키텍처-구성-요소-포함>#</a></h2><pre class=mermaid>flowchart LR
  A[Client] --&gt;|로그인 요청| B[Auth Server]
  B --&gt;|Access Token + Refresh Token| A
  A --&gt;|Bearer 토큰| C[Resource Server]
  C --&gt;|검증 요청| B
  C --&gt;|자원 응답| A
</pre><ul><li><strong>클라이언트(Client)</strong>: 토큰 저장(localStorage/cookie) 및 요청 헤더에 첨부</li><li><strong>인증 서버(Auth Server)</strong>: 사용자 인증 → 토큰 생성 및 서명/암호화</li><li><strong>리소스 서버(Resource Server)</strong>: Access Token 서명·만료·권한 검증 → 자원 제공</li><li><strong>토큰 저장소</strong>: Refresh Token 발급 이력을 저장 → 회전 및 폐기 구현</li><li><strong>키 관리(Key Store)</strong>: 서명/암호화에 사용되는 대칭/비대칭 키 관리 및 로테이션</li></ul><hr><h2 id=4-주요-원리--작동-원리>4. 주요 원리 & 작동 원리<a hidden class=anchor aria-hidden=true href=#4-주요-원리--작동-원리>#</a></h2><table><thead><tr><th>단계</th><th>설명</th></tr></thead><tbody><tr><td>1. 로그인</td><td>자격 증명 제출 → 인증 서버에서 검증</td></tr><tr><td></td><td>Access/Refresh Token 생성 + 서명/암호화</td></tr><tr><td></td><td>클라이언트에 전달 및 저장</td></tr><tr><td></td><td>Authorization 헤더에 Access Token 전송</td></tr><tr><td>5. 검증</td><td>리소스 서버는 서명·만료·권한 검증</td></tr><tr><td></td><td>만료 시 Refresh Token으로 재발급 요청</td></tr><tr><td></td><td>기존 Refresh 폐기 + 신규 발급</td></tr></tbody></table><hr><h2 id=5-구현-기법>5. 구현 기법<a hidden class=anchor aria-hidden=true href=#5-구현-기법>#</a></h2><ul><li><strong>JWT (JWS/JWE)</strong>: 서명·암호화된 JSON Web Token 활용</li><li><strong>Opaque Token</strong>: 불투명 문자열 토큰 + 서버 DB에서 상태 저장</li><li><strong>OAuth2 기반</strong>: Access/Refresh Token 흐름 채택</li><li><strong>HMAC vs RSA</strong>: HS256/RS256 등의 알고리즘 선택</li><li><strong>토큰 회전</strong>: Refresh Token 각 요청시 회전 및 폐기</li><li><strong>리프레시 저장소 구조</strong>: Redis, DB 사용 → 회전·블랙리스트 연계</li></ul><hr><h2 id=6-장점>6. 장점<a hidden class=anchor aria-hidden=true href=#6-장점>#</a></h2><table><thead><tr><th>구분</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>장점</td><td>Stateless 구조</td><td>서버 부담 적고, 수평 확장성 우수 (<a href="https://medium.com/%40akhil-mottammal/understanding-token-based-authentication-in-web-development-9088d9a4f01e?utm_source=chatgpt.com" title="Understanding Token-Based Authentication in Web Development">medium.com</a>, <a href="https://frontegg.com/blog/token-based-authentication?utm_source=chatgpt.com" title="Understanding Token-Based Authentication: A Detailed Review">frontegg.com</a>, <a href="https://en.wikipedia.org/wiki/Kerberos_%28protocol%29?utm_source=chatgpt.com" title="Kerberos (protocol)">en.wikipedia.org</a>, <a href="https://en.wikipedia.org/wiki/JSON_Web_Token?utm_source=chatgpt.com" title="JSON Web Token">en.wikipedia.org</a>)</td></tr><tr><td></td><td>Self-contained</td><td>사용자 정보와 권한이 토큰에 포함되어 별도 조회 불필요</td></tr><tr><td></td><td>Interoperability</td><td>다양한 클라이언트/서비스 간 호환성 제공</td></tr><tr><td></td><td>보안 강화</td><td>서명·만료·암호화 등을 통한 위변조 및 중간자 공격 방지</td></tr></tbody></table><hr><h2 id=7-단점-및-문제점--해결-방안>7. 단점 및 문제점 & 해결 방안<a hidden class=anchor aria-hidden=true href=#7-단점-및-문제점--해결-방안>#</a></h2><h3 id=단점-1>단점<a hidden class=anchor aria-hidden=true href=#단점-1>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>단점</td><td>토큰 취소 불가능성</td><td>Stateless 특성으로 만료 전 토큰 폐기 어려움</td><td>Refresh 회전 및 블랙리스트 적용</td></tr><tr><td></td><td>토큰 탈취 위험</td><td>브라우저 저장소 노출 시 전체 리소스 접근 가능성</td><td>httpOnly 쿠키 + TLS 전송</td></tr><tr><td></td><td>키 관리 복잡성</td><td>키 교체 시 호환성 및 검증 문제 발생</td><td>KID 사용, JWKS로 자동 업데이트 구현</td></tr><tr><td></td><td>토큰 크기 제한</td><td>페이로드 크기가 커지면 헤더 제한 초과 가능</td><td>포함 클레임 최소화</td></tr></tbody></table><h3 id=문제점-1>문제점<a hidden class=anchor aria-hidden=true href=#문제점-1>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>원인</th><th>영향</th><th>탐지/진단</th><th>예방</th><th>해결</th></tr></thead><tbody><tr><td>문제</td><td>MITM 공격</td><td>TLS 누락</td><td>토큰 탈취 및 변조</td><td>HTTPS 로그, 패킷 분석</td><td>HTTPS/TLS 적용</td><td>HSTS 적용</td></tr><tr><td></td><td>리플레이 공격</td><td>토큰 재사용</td><td>권한 오용</td><td>요청 로그 분석</td><td>jti·nonce 사용</td><td>블랙리스트 기반 차단</td></tr><tr><td></td><td>Refresh 재사용</td><td>단회성 미구현</td><td>무기한 접근</td><td>비정상 토큰 사용 탐지</td><td>Token 회전</td><td>사용 시 폐기, 회전</td></tr><tr><td></td><td>alg 조작 공격</td><td>Header alg 조작</td><td>위조 토큰 승인</td><td>검증 실패 로그</td><td>알고리즘 고정</td><td>서명 시 서버 측 검증</td></tr></tbody></table><hr><h2 id=8-도전-과제>8. 도전 과제<a hidden class=anchor aria-hidden=true href=#8-도전-과제>#</a></h2><ul><li>Refresh 토큰 무상태 폐기 구현</li><li>분산 시스템 JWKS 키 관리 자동화</li><li>실시간 권한 변경 즉시 반영</li><li>JWE 암호화 성능 최적화</li><li>GDPR 등 컴플라이언스 준수</li><li>토큰 표준 업데이트로 인한 호환성 이슈 해결</li></ul><hr><h2 id=9-분류-기준에-따른-종류>9. 분류 기준에 따른 종류<a hidden class=anchor aria-hidden=true href=#9-분류-기준에-따른-종류>#</a></h2><table><thead><tr><th>기준</th><th>유형</th><th>설명</th></tr></thead><tbody><tr><td>토큰 구조</td><td>JWT(JWS/JWE)</td><td>서명 또는 암호화된 JSON 토큰 사용</td></tr><tr><td>구조 타입</td><td>Opaque Token</td><td>서버 저장 기반의 불투명 토큰</td></tr><tr><td>키 방식</td><td>HSxxx vs RSxxx/ESxxx</td><td>대칭 vs 비대칭 방식</td></tr><tr><td>기능 목적</td><td>Access vs Refresh Tokens</td><td>Access: 자원 접근, Refresh: 재발급</td></tr></tbody></table><hr><h2 id=10-실무-사용-예시>10. 실무 사용 예시<a hidden class=anchor aria-hidden=true href=#10-실무-사용-예시>#</a></h2><table><thead><tr><th>환경</th><th>사용 목적</th><th>효과</th></tr></thead><tbody><tr><td>SPA + REST API</td><td>로그인 기반 API 요청</td><td>서버 상태 저장 없이 확장 가능</td></tr><tr><td>마이크로서비스</td><td>서비스 간 인증 및 권한 공유</td><td>중앙 인증 서버 분리 + 서비스 간 독립성 확보</td></tr><tr><td>OAuth2 / OpenID Connect</td><td>SSO / ID 정보 전달</td><td>효율적인 인증 흐름과 사용자 경험 제공</td></tr></tbody></table><hr><p>필요하시면 다음 단계로 <strong>활용 사례 과정 워크플로우</strong>, <strong>Python/JS 구현 예시</strong>, <strong>최적화 설계</strong>, <strong>mermaid 아키텍처</strong> 등을 추가로 제공드릴 수 있습니다. 😊</p><p>아래는 <strong>Token-Based Authentication</strong>의 이어지는 자세한 분석입니다. <strong>활용 사례</strong>, <strong>워크플로우 구조</strong>, <strong>실무 구현 예시</strong>, 그리고 <strong>인증 방식 비교</strong>까지 다루었습니다.</p><hr><h2 id=10-활용-사례-및-워크플로우>10. 활용 사례 및 워크플로우<a hidden class=anchor aria-hidden=true href=#10-활용-사례-및-워크플로우>#</a></h2><h3 id=a-활용-사례-마이크로서비스-기반-인증>A. 활용 사례: 마이크로서비스 기반 인증<a hidden class=anchor aria-hidden=true href=#a-활용-사례-마이크로서비스-기반-인증>#</a></h3><ul><li><p><strong>시스템 구성</strong>:</p><ul><li>Auth Server (OAuth2 + JWT)</li><li>API Gateway (JWT 검증 후 라우팅)</li><li>Microservices A/B (리소스 제공)</li><li>데이터베이스 + Redis (Refresh 토큰 저장 및 회전 관리)</li></ul></li><li><p><strong>워크플로우</strong>:</p><ol><li>사용자가 로그인 → Auth Server가 JWT(Access/Refresh) 발급</li><li>클라이언트가 API Gateway에 Access Token 포함 요청</li><li>API Gateway가 서명, 만료, KID 등 검증 후 요청 라우팅</li><li>내부 마이크로서비스는 클레임 기반 권한 검사</li><li>Access Token 만료 시 클라이언트가 Refresh 요청 → Auth Server 회전된 Access/Refresh 재발급</li></ol></li></ul><p>→ JWT 도입 시 <strong>세션 저장 불필요</strong>, 서비스 간 <strong>무상태 인증</strong>, 확장성 확보</p><hr><h2 id=11-구현-예시-python-기반>11. 구현 예시 (Python 기반)<a hidden class=anchor aria-hidden=true href=#11-구현-예시-python-기반>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span><span class=lnt id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a>
</span><span class=lnt id=hl-4-19><a class=lnlinks href=#hl-4-19>19</a>
</span><span class=lnt id=hl-4-20><a class=lnlinks href=#hl-4-20>20</a>
</span><span class=lnt id=hl-4-21><a class=lnlinks href=#hl-4-21>21</a>
</span><span class=lnt id=hl-4-22><a class=lnlinks href=#hl-4-22>22</a>
</span><span class=lnt id=hl-4-23><a class=lnlinks href=#hl-4-23>23</a>
</span><span class=lnt id=hl-4-24><a class=lnlinks href=#hl-4-24>24</a>
</span><span class=lnt id=hl-4-25><a class=lnlinks href=#hl-4-25>25</a>
</span><span class=lnt id=hl-4-26><a class=lnlinks href=#hl-4-26>26</a>
</span><span class=lnt id=hl-4-27><a class=lnlinks href=#hl-4-27>27</a>
</span><span class=lnt id=hl-4-28><a class=lnlinks href=#hl-4-28>28</a>
</span><span class=lnt id=hl-4-29><a class=lnlinks href=#hl-4-29>29</a>
</span><span class=lnt id=hl-4-30><a class=lnlinks href=#hl-4-30>30</a>
</span><span class=lnt id=hl-4-31><a class=lnlinks href=#hl-4-31>31</a>
</span><span class=lnt id=hl-4-32><a class=lnlinks href=#hl-4-32>32</a>
</span><span class=lnt id=hl-4-33><a class=lnlinks href=#hl-4-33>33</a>
</span><span class=lnt id=hl-4-34><a class=lnlinks href=#hl-4-34>34</a>
</span><span class=lnt id=hl-4-35><a class=lnlinks href=#hl-4-35>35</a>
</span><span class=lnt id=hl-4-36><a class=lnlinks href=#hl-4-36>36</a>
</span><span class=lnt id=hl-4-37><a class=lnlinks href=#hl-4-37>37</a>
</span><span class=lnt id=hl-4-38><a class=lnlinks href=#hl-4-38>38</a>
</span><span class=lnt id=hl-4-39><a class=lnlinks href=#hl-4-39>39</a>
</span><span class=lnt id=hl-4-40><a class=lnlinks href=#hl-4-40>40</a>
</span><span class=lnt id=hl-4-41><a class=lnlinks href=#hl-4-41>41</a>
</span><span class=lnt id=hl-4-42><a class=lnlinks href=#hl-4-42>42</a>
</span><span class=lnt id=hl-4-43><a class=lnlinks href=#hl-4-43>43</a>
</span><span class=lnt id=hl-4-44><a class=lnlinks href=#hl-4-44>44</a>
</span><span class=lnt id=hl-4-45><a class=lnlinks href=#hl-4-45>45</a>
</span><span class=lnt id=hl-4-46><a class=lnlinks href=#hl-4-46>46</a>
</span><span class=lnt id=hl-4-47><a class=lnlinks href=#hl-4-47>47</a>
</span><span class=lnt id=hl-4-48><a class=lnlinks href=#hl-4-48>48</a>
</span><span class=lnt id=hl-4-49><a class=lnlinks href=#hl-4-49>49</a>
</span><span class=lnt id=hl-4-50><a class=lnlinks href=#hl-4-50>50</a>
</span><span class=lnt id=hl-4-51><a class=lnlinks href=#hl-4-51>51</a>
</span><span class=lnt id=hl-4-52><a class=lnlinks href=#hl-4-52>52</a>
</span><span class=lnt id=hl-4-53><a class=lnlinks href=#hl-4-53>53</a>
</span><span class=lnt id=hl-4-54><a class=lnlinks href=#hl-4-54>54</a>
</span><span class=lnt id=hl-4-55><a class=lnlinks href=#hl-4-55>55</a>
</span><span class=lnt id=hl-4-56><a class=lnlinks href=#hl-4-56>56</a>
</span><span class=lnt id=hl-4-57><a class=lnlinks href=#hl-4-57>57</a>
</span><span class=lnt id=hl-4-58><a class=lnlinks href=#hl-4-58>58</a>
</span><span class=lnt id=hl-4-59><a class=lnlinks href=#hl-4-59>59</a>
</span><span class=lnt id=hl-4-60><a class=lnlinks href=#hl-4-60>60</a>
</span><span class=lnt id=hl-4-61><a class=lnlinks href=#hl-4-61>61</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>jwt</span><span class=o>,</span> <span class=nn>datetime</span><span class=o>,</span> <span class=nn>functools</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>SECRET</span> <span class=o>=</span> <span class=s2>&#34;super-secret-key&#34;</span>
</span></span><span class=line><span class=cl><span class=n>ACCESS_EXP</span> <span class=o>=</span> <span class=mi>900</span>  <span class=c1># 15분</span>
</span></span><span class=line><span class=cl><span class=n>REFRESH_EXP</span> <span class=o>=</span> <span class=mi>604800</span>  <span class=c1># 7일</span>
</span></span><span class=line><span class=cl><span class=n>refresh_store</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># {jti: {&#34;sub&#34;: &lt;user&gt;, &#34;exp&#34;: &lt;timestamp&gt;}}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>token_required</span><span class=p>(</span><span class=n>f</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nd>@functools.wraps</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>wrapper</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>auth</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;Authorization&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>auth</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;Bearer &#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;Missing token&#34;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>        <span class=n>token</span> <span class=o>=</span> <span class=n>auth</span><span class=o>.</span><span class=n>split</span><span class=p>()[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>payload</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>SECRET</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;HS256&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>ExpiredSignatureError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;Expired&#34;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>InvalidTokenError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;Invalid&#34;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=n>payload</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>wrapper</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/login&#34;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;POST&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>user</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>json</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;user&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>now</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>access</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>encode</span><span class=p>({</span><span class=s2>&#34;sub&#34;</span><span class=p>:</span> <span class=n>user</span><span class=p>,</span> <span class=s2>&#34;exp&#34;</span><span class=p>:</span> <span class=n>now</span> <span class=o>+</span> <span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>seconds</span><span class=o>=</span><span class=n>ACCESS_EXP</span><span class=p>)},</span> <span class=n>SECRET</span><span class=p>,</span> <span class=n>algorithm</span><span class=o>=</span><span class=s2>&#34;HS256&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>refresh_jti</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>now</span><span class=o>.</span><span class=n>timestamp</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>refresh</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>encode</span><span class=p>({</span><span class=s2>&#34;sub&#34;</span><span class=p>:</span> <span class=n>user</span><span class=p>,</span> <span class=s2>&#34;jti&#34;</span><span class=p>:</span> <span class=n>refresh_jti</span><span class=p>,</span> <span class=s2>&#34;exp&#34;</span><span class=p>:</span> <span class=n>now</span> <span class=o>+</span> <span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>seconds</span><span class=o>=</span><span class=n>REFRESH_EXP</span><span class=p>)},</span> <span class=n>SECRET</span><span class=p>,</span> <span class=n>algorithm</span><span class=o>=</span><span class=s2>&#34;HS256&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>refresh_store</span><span class=p>[</span><span class=n>refresh_jti</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;sub&#34;</span><span class=p>:</span> <span class=n>user</span><span class=p>,</span> <span class=s2>&#34;exp&#34;</span><span class=p>:</span> <span class=n>now</span> <span class=o>+</span> <span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>seconds</span><span class=o>=</span><span class=n>REFRESH_EXP</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>access_token</span><span class=o>=</span><span class=n>access</span><span class=p>,</span> <span class=n>refresh_token</span><span class=o>=</span><span class=n>refresh</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/refresh&#34;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;POST&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>refresh</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>token</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>json</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;refresh_token&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>SECRET</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;HS256&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>InvalidTokenError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;Invalid&#34;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>    <span class=n>jti</span> <span class=o>=</span> <span class=n>payload</span><span class=p>[</span><span class=s2>&#34;jti&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>info</span> <span class=o>=</span> <span class=n>refresh_store</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>jti</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>info</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;Revoked&#34;</span><span class=p>}),</span> <span class=mi>403</span>
</span></span><span class=line><span class=cl>    <span class=c1># 토큰 회전</span>
</span></span><span class=line><span class=cl>    <span class=k>del</span> <span class=n>refresh_store</span><span class=p>[</span><span class=n>jti</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>new_jti</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span><span class=o>.</span><span class=n>timestamp</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>access</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>encode</span><span class=p>({</span><span class=s2>&#34;sub&#34;</span><span class=p>:</span> <span class=n>info</span><span class=p>[</span><span class=s2>&#34;sub&#34;</span><span class=p>],</span> <span class=s2>&#34;exp&#34;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>+</span> <span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>seconds</span><span class=o>=</span><span class=n>ACCESS_EXP</span><span class=p>)},</span> <span class=n>SECRET</span><span class=p>,</span> <span class=n>algorithm</span><span class=o>=</span><span class=s2>&#34;HS256&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>refresh</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>encode</span><span class=p>({</span><span class=s2>&#34;sub&#34;</span><span class=p>:</span> <span class=n>info</span><span class=p>[</span><span class=s2>&#34;sub&#34;</span><span class=p>],</span> <span class=s2>&#34;jti&#34;</span><span class=p>:</span> <span class=n>new_jti</span><span class=p>,</span> <span class=s2>&#34;exp&#34;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>+</span> <span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>seconds</span><span class=o>=</span><span class=n>REFRESH_EXP</span><span class=p>)},</span> <span class=n>SECRET</span><span class=p>,</span> <span class=n>algorithm</span><span class=o>=</span><span class=s2>&#34;HS256&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>refresh_store</span><span class=p>[</span><span class=n>new_jti</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;sub&#34;</span><span class=p>:</span> <span class=n>info</span><span class=p>[</span><span class=s2>&#34;sub&#34;</span><span class=p>],</span> <span class=s2>&#34;exp&#34;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>+</span> <span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>seconds</span><span class=o>=</span><span class=n>REFRESH_EXP</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>access_token</span><span class=o>=</span><span class=n>access</span><span class=p>,</span> <span class=n>refresh_token</span><span class=o>=</span><span class=n>refresh</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/protected&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nd>@token_required</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>protected</span><span class=p>(</span><span class=n>payload</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;user&#34;</span><span class=p>:</span> <span class=n>payload</span><span class=p>[</span><span class=s2>&#34;sub&#34;</span><span class=p>]})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>Flask + PyJWT 사용</li><li>Refresh 회전 + 블랙리스트 구현</li><li><code>Authorization: Bearer &lt;token></code> 헤더 활용</li></ul><hr><h2 id=12-인증-방식-비교-jwt-vs-opaque-token>12. 인증 방식 비교: JWT vs Opaque Token<a hidden class=anchor aria-hidden=true href=#12-인증-방식-비교-jwt-vs-opaque-token>#</a></h2><table><thead><tr><th>기준</th><th>JWT</th><th>Opaque Token</th></tr></thead><tbody><tr><td>구조</td><td>자체 포함형(JSON + 구성요소)</td><td>무상태, 서버 저장 기반</td></tr><tr><td>확인 방식</td><td>로컬 서명 검증</td><td>토큰 인트로스펙션 요청 필요</td></tr><tr><td>토큰 크기</td><td>큼 (≥200byte)</td><td>작음 (~20–60byte)</td></tr><tr><td>해독 가능 여부</td><td>Base64Url 디코딩 가능</td><td>불가 (Opaque)</td></tr><tr><td>폐기/리보크</td><td>즉시 불가능, TTL 기반</td><td>즉각 폐기 가능 (DB/캐시)</td></tr><tr><td>배포 환경 적합도</td><td>미들웨어/마이크로서비스에 유리</td><td>보안 민감 환경 추천</td></tr></tbody></table><p>→ JWT는 <strong>확장·성능·호환성</strong>에 강하지만 폐기와 노출에는 취약, Opaque Token은 <strong>보안 중심</strong>, <strong>즉각 리보크</strong>가 가능하나 DB 의존성과 확장성 제약 존재 (<a href="https://www.okta.com/identity-101/what-is-token-based-authentication/?utm_source=chatgpt.com" title="What Is Token-Based Authentication? - Okta">docs.microfocus.com</a>, <a href="https://frontegg.com/blog/token-based-authentication?utm_source=chatgpt.com" title="Understanding Token-Based Authentication: A Detailed Review">permit.io</a>, <a href="https://medium.com/%40akhil-mottammal/understanding-token-based-authentication-in-web-development-9088d9a4f01e?utm_source=chatgpt.com" title="Understanding Token-Based Authentication in Web Development">zitadel.com</a>, <a href="https://en.wikipedia.org/wiki/Kerberos_%28protocol%29?utm_source=chatgpt.com" title="Kerberos (protocol)">permit.io</a>, <a href="https://en.wikipedia.org/wiki/JSON_Web_Token?utm_source=chatgpt.com" title="JSON Web Token">blog.logto.io</a>)</p><hr><h2 id=13-기타-사항>13. 기타 사항<a hidden class=anchor aria-hidden=true href=#13-기타-사항>#</a></h2><ul><li><strong>OIDC ID Token</strong>은 JWT 기반</li><li><strong>Bearer Definition</strong>: “소지자”가 권한을 가진다는 의미로, HTTPS 없이 전달 시 위험 발생</li><li><strong>토큰 규격 표준</strong>: OAuth2 (RFC 6749), JWT (RFC 7519), JWS/RSA (RFC 7515), JWE (RFC 7516)</li><li><strong>토큰 형식 혼합 설계</strong>: Access Token은 JWT, Refresh/Opaque 조합 활용 가능</li></ul><hr><h3 id=-다음-가능-추가-분석>🧭 다음 가능 추가 분석<a hidden class=anchor aria-hidden=true href=#-다음-가능-추가-분석>#</a></h3><ul><li><strong>OAuth2 Authorization Code + PKCE</strong>를 포함한 워크플로우</li><li><strong>API Gateway/JWKS 자동 키 로테이션 다이어그램</strong></li><li><strong>BFF(Backend for Frontend) 구조 인증 설계</strong></li><li><strong>Passkeys/MFA 연동된 토큰 흐름 구현 예시</strong></li></ul><p>필요하시면 해당 주제로 이어서 심층 분석 가능합니다! 😊</p><p>아래는 <strong>Token-Based Authentication</strong>에 대한 이어지는 심화 분석입니다. 이번에는 <strong>최적화</strong>, <strong>도전 과제 심화</strong>, <strong>용어 정리</strong>, <strong>참고 및 출처</strong>를 포함했습니다.</p><hr><h2 id=-14-최적화하기-위한-고려사항-및-주의할-점>🔧 14. 최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#-14-최적화하기-위한-고려사항-및-주의할-점>#</a></h2><table><thead><tr><th>카테고리</th><th>최적화 요소</th><th>권장 방법</th></tr></thead><tbody><tr><td>토큰 크기 관리</td><td>페이로드 최소화</td><td>포함 클레임을 <code>sub</code>, <code>exp</code> 등 필수 항목으로 제한하고, 필요 시 reference 클레임 사용</td></tr><tr><td>서명 알고리즘 선택</td><td>성능 vs 보안 간 균형</td><td>HS256은 빠르지만 공유 비밀 키 보안 위험, RS256은 보안 강하지만 서명 비용 존재</td></tr><tr><td>공개키 캐싱</td><td>리소스 서버의 키 조회 비용 절감</td><td>JWKS를 사용해 주기적으로 공개키(Key ID 기준) 캐싱</td></tr><tr><td>키 회전 정책</td><td>장애 최소화 및 호환성 확보</td><td>KID 및 JWKS 자동화 설정, 레거시 토큰 허용 기간 설정 가능</td></tr><tr><td>검증 병렬화</td><td>고부하 환경 성능 유지</td><td>서명/만료 검증을 미들웨어 수준에서 수행, 다른 로직과 분리/병렬 처리</td></tr><tr><td>네트워크 호출 최소화</td><td>인트로스펙션 호출 최소화</td><td>필요한 경우 Batched 또는 캐싱 전략 사용</td></tr></tbody></table><hr><h2 id=-15-도전-과제-심화-분석>🚧 15. 도전 과제 심화 분석<a hidden class=anchor aria-hidden=true href=#-15-도전-과제-심화-분석>#</a></h2><table><thead><tr><th>항목</th><th>원인</th><th>영향</th><th>탐지/진단</th><th>예방 방법</th><th>해결 기법</th></tr></thead><tbody><tr><td>권한 변경 지연</td><td>토큰에 권한 정보 캐싱</td><td>역할 변경 후 즉시 반영 불가</td><td>권한 오류 로그 분석</td><td>짧은 TTL + 토큰 회전</td><td>중앙 권한 서버 통합 검증</td></tr><tr><td>디바이스 탈취 위협</td><td>토큰 탈취 및 저장소 노출</td><td>계정 탈취 가능</td><td>비정상 IP/디바이스 로그</td><td>MFA 적용, 기기 기반 검증</td><td>디바이스 지문/세션 관리 시스템 도입</td></tr><tr><td>토큰 인플레이션</td><td>클레임 확장으로 크기 증가</td><td>네트워크·메모리 부담 증가</td><td>페이로드 크기 모니터링</td><td>청구정보 등 대용량 자제</td><td>reference 클레임, 페이로드 줄이기 사용</td></tr><tr><td>컴플라이언스 관리</td><td>GDPR 등 데이터 보호 규칙 준수 필요</td><td>로그/토큰 저장에 법적 위험</td><td>저장 토큰/로그 리뷰</td><td>최소 정보 저장 정책 준수</td><td>암호화 JWE + 개인정보 익명화 적용</td></tr><tr><td>레거시 클라이언트 지원</td><td>업데이트 의존</td><td>호환성 이슈 발생</td><td>API 호출 실패 수집</td><td>버전 관리, 점진적 적용 전략</td><td>feature flag 기반 롤아웃 전략</td></tr></tbody></table><hr><h2 id=-용어-정리>📚 용어 정리<a hidden class=anchor aria-hidden=true href=#-용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>토큰 구조</td><td>reference 클레임</td><td>토큰 내 민감정보 대신 서버 참조용 키 포함</td></tr><tr><td>키 운영</td><td>KID, JWKS</td><td>Key ID / JSON Web Key Set — 공개키 식별 및 배포 체계</td></tr><tr><td>보안</td><td>Token 회전</td><td>Refresh Token 재사용 방지 위한 주기적 교체 전략</td></tr><tr><td>위협</td><td>디바이스 지문 (Device fingerprint)</td><td>클라이언트 디바이스 식별 정보</td></tr></tbody></table><hr><h2 id=-참고-및-출처>📚 참고 및 출처<a hidden class=anchor aria-hidden=true href=#-참고-및-출처>#</a></h2><ul><li>OAuth 2.0 (RFC 6749), JWT (RFC 7519), JWS (RFC 7515), JWE (RFC 7516)</li><li>JWT 구조, 최적화 가이드, 토큰 회전 전략 등</li><li>TLS/HSTS 보안 필수 전략</li></ul><hr><p>필요하시면 <strong>OAuth2 인증 코드 + PKCE</strong> 워크플로우, <strong>API Gateway 중재자 구조</strong>, 또는 <strong>인증 서버 설계 패턴</strong> 등 후속 분석도 가능하니 편하게 요청해주세요 😊</p><p>아래는 <strong>Token-Based Authentication</strong>에서 <strong>OAuth2 Authorization Code + PKCE</strong> 흐름과 관련된 심화 분석입니다.</p><hr><h2 id=-16-oauth2-authorization-code--pkce-워크플로우>📑 16. OAuth2 Authorization Code + PKCE 워크플로우<a hidden class=anchor aria-hidden=true href=#-16-oauth2-authorization-code--pkce-워크플로우>#</a></h2><pre class=mermaid>sequenceDiagram
  participant C as Client (SPA/Mobile)
  participant USR as User Agent
  participant AS as Authorization Server
  participant RS as Resource Server

  C-&gt;&gt;USR: Redirect to AS /authorize?code_challenge
  USR-&gt;&gt;AS: 요청 (code_challenge 포함)
  AS-&gt;&gt;USR: Login &amp; Consent
  USR-&gt;&gt;C: Redirect with ?code=AUTH_CODE
  C-&gt;&gt;AS: POST /token (code + code_verifier)
  AS-&gt;&gt;C: 응답 (access_token + id_token + refresh_token)
  C-&gt;&gt;RS: API 호출 Authorization: Bearer token
  RS-&gt;&gt;RS: 서명·만료·권한 검증
  RS-&gt;&gt;C: Protected Resource 반환
</pre><h3 id=주요-포인트>주요 포인트<a hidden class=anchor aria-hidden=true href=#주요-포인트>#</a></h3><ul><li><strong>code_challenge</strong>: SHA‑256 해시된 <code>code_verifier</code>; 초기 요청에 포함 (<a href="https://www.okta.com/identity-101/what-is-token-based-authentication/?utm_source=chatgpt.com" title="What Is Token-Based Authentication? - Okta">auth0.com</a>)</li><li><strong>code_verifier</strong>: 토큰 교환 시 사용되는 원본 랜덤 스트링</li><li><code>AS</code>는 hash(<code>code_verifier</code>)와 <strong>초기 요청의 code_challenge</strong>를 비교하여 검증</li></ul><hr><h2 id=-17-pkce-보안-강화-및-이유>🔐 17. PKCE 보안 강화 및 이유<a hidden class=anchor aria-hidden=true href=#-17-pkce-보안-강화-및-이유>#</a></h2><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>인증 민감도</td><td>Public Client(SPA/Mobile)는 Client Secret 저장 불가 (<a href="https://www.okta.com/identity-101/what-is-token-based-authentication/?utm_source=chatgpt.com" title="What Is Token-Based Authentication? - Okta">auth0.com</a>)</td></tr><tr><td>공격 방지</td><td>중간자(MITM)나 코드 가로채기 공격 저지</td></tr><tr><td>표준 준수</td><td>OAuth2.1, Best Current Practice에 권장</td></tr><tr><td>HTTP 리퍼러 노출 위험 감소</td><td>Authorization Code만 전달되며 토큰은 서버간 통신에서 안전하게 교환</td></tr></tbody></table><hr><h2 id=-18-python-예제-pkce-구현>✅ 18. Python 예제: PKCE 구현<a hidden class=anchor aria-hidden=true href=#-18-python-예제-pkce-구현>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14>14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15>15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16>16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17>17</a>
</span><span class=lnt id=hl-6-18><a class=lnlinks href=#hl-6-18>18</a>
</span><span class=lnt id=hl-6-19><a class=lnlinks href=#hl-6-19>19</a>
</span><span class=lnt id=hl-6-20><a class=lnlinks href=#hl-6-20>20</a>
</span><span class=lnt id=hl-6-21><a class=lnlinks href=#hl-6-21>21</a>
</span><span class=lnt id=hl-6-22><a class=lnlinks href=#hl-6-22>22</a>
</span><span class=lnt id=hl-6-23><a class=lnlinks href=#hl-6-23>23</a>
</span><span class=lnt id=hl-6-24><a class=lnlinks href=#hl-6-24>24</a>
</span><span class=lnt id=hl-6-25><a class=lnlinks href=#hl-6-25>25</a>
</span><span class=lnt id=hl-6-26><a class=lnlinks href=#hl-6-26>26</a>
</span><span class=lnt id=hl-6-27><a class=lnlinks href=#hl-6-27>27</a>
</span><span class=lnt id=hl-6-28><a class=lnlinks href=#hl-6-28>28</a>
</span><span class=lnt id=hl-6-29><a class=lnlinks href=#hl-6-29>29</a>
</span><span class=lnt id=hl-6-30><a class=lnlinks href=#hl-6-30>30</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span><span class=o>,</span> <span class=nn>base64</span><span class=o>,</span> <span class=nn>hashlib</span><span class=o>,</span> <span class=nn>secrets</span><span class=o>,</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>redirect</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>AUTH_SERVER</span> <span class=o>=</span> <span class=s2>&#34;https://auth.example.com&#34;</span>
</span></span><span class=line><span class=cl><span class=n>CLIENT_ID</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;CLIENT_ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>REDIRECT_URI</span> <span class=o>=</span> <span class=s2>&#34;https://app.example.com/callback&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>make_pkce</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>verifier</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>urlsafe_b64encode</span><span class=p>(</span><span class=n>secrets</span><span class=o>.</span><span class=n>token_bytes</span><span class=p>(</span><span class=mi>32</span><span class=p>))</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;=&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>challenge</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>urlsafe_b64encode</span><span class=p>(</span><span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>verifier</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>digest</span><span class=p>())</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;=&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>verifier</span><span class=p>,</span> <span class=n>challenge</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/login&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>verifier</span><span class=p>,</span> <span class=n>challenge</span> <span class=o>=</span> <span class=n>make_pkce</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># 서버 세션 또는 localStorage 저장 필요</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=p>[</span><span class=s2>&#34;verifier&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>verifier</span>
</span></span><span class=line><span class=cl>    <span class=n>url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>AUTH_SERVER</span><span class=si>}</span><span class=s2>/authorize?response_type=code&amp;client_id=</span><span class=si>{</span><span class=n>CLIENT_ID</span><span class=si>}</span><span class=s2>&amp;redirect_uri=</span><span class=si>{</span><span class=n>REDIRECT_URI</span><span class=si>}</span><span class=s2>&amp;code_challenge=</span><span class=si>{</span><span class=n>challenge</span><span class=si>}</span><span class=s2>&amp;code_challenge_method=S256&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/callback&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>callback</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>code</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;code&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>verifier</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>session</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s2>&#34;verifier&#34;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;grant_type&#34;</span><span class=p>:</span> <span class=s2>&#34;authorization_code&#34;</span><span class=p>,</span> <span class=s2>&#34;code&#34;</span><span class=p>:</span> <span class=n>code</span><span class=p>,</span> <span class=s2>&#34;redirect_uri&#34;</span><span class=p>:</span> <span class=n>REDIRECT_URI</span><span class=p>,</span> <span class=s2>&#34;code_verifier&#34;</span><span class=p>:</span> <span class=n>verifier</span><span class=p>,</span> <span class=s2>&#34;client_id&#34;</span><span class=p>:</span> <span class=n>CLIENT_ID</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>resp</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>AUTH_SERVER</span><span class=si>}</span><span class=s2>/token&#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>tokens</span> <span class=o>=</span> <span class=n>resp</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># ID 토큰/Access 토큰 저장·활용</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>tokens</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>make_pkce()</code>에서 Verifier와 Challenge 생성</li><li>Session(ex. Flask 세션)에 Verifier 저장</li><li>콜백에서 Verifier와 Code로 토큰 요청 처리</li></ul><hr><h2 id=-19-best-practices--고려사항>🛠️ 19. Best Practices & 고려사항<a hidden class=anchor aria-hidden=true href=#-19-best-practices--고려사항>#</a></h2><ul><li><strong>Verifier 보관 위치</strong>: 브라우저에서는 memory/SessionStorage 활용, cookie 사용 주의 (<a href="https://frontegg.com/blog/token-based-authentication?utm_source=chatgpt.com" title="Understanding Token-Based Authentication: A Detailed Review">docs.secureauth.com</a>, <a href="https://medium.com/%40akhil-mottammal/understanding-token-based-authentication-in-web-development-9088d9a4f01e?utm_source=chatgpt.com" title="Understanding Token-Based Authentication in Web Development">ietf.org</a>, <a href="https://en.wikipedia.org/wiki/Kerberos_%28protocol%29?utm_source=chatgpt.com" title="Kerberos (protocol)">anirbanbh.medium.com</a>)</li><li><strong>PKCE 방식</strong>: 항상 <code>S256</code> 방식 사용 (권장되는 유일 안전 방식) (<a href="https://en.wikipedia.org/wiki/JSON_Web_Token?utm_source=chatgpt.com" title="JSON Web Token">reddit.com</a>)</li><li><strong>state 파라미터 사용</strong>: CSRF 공격 방지 목적 (<a href="https://medium.com/%40akhil-mottammal/understanding-token-based-authentication-in-web-development-9088d9a4f01e?utm_source=chatgpt.com" title="Understanding Token-Based Authentication in Web Development">ietf.org</a>)</li><li><strong>루틴 검증</strong>: 토큰 교환 시 반드시 verifier-challenge 검사 필수</li><li><strong>Public 및 Confidential 클라이언트 모두 PKCE 권장</strong> (<a href="https://medium.com/%40akhil-mottammal/understanding-token-based-authentication-in-web-development-9088d9a4f01e?utm_source=chatgpt.com" title="Understanding Token-Based Authentication in Web Development">ietf.org</a>)</li></ul><hr><h2 id=-20-oidc-및-sso-연동>🧭 20. OIDC 및 SSO 연동<a hidden class=anchor aria-hidden=true href=#-20-oidc-및-sso-연동>#</a></h2><ul><li>인증 서버가 <strong>ID Token(JWT)</strong> 발행</li><li>토큰 내 <code>nonce</code> 포함: 리플레이 공격 방지</li><li>SSO 환경에서 <code>PKCE + nonce + Refresh Rotation</code> 조합으로 높은 보안성 확보</li></ul><hr><h3 id=-요약>🧾 요약<a hidden class=anchor aria-hidden=true href=#-요약>#</a></h3><p>OAuth2 Authorization Code Flow에 <strong>PKCE</strong>를 추가하면 Public Client에서도 안전하게 Authorization Code를 교환할 수 있습니다. SHA-256 기반의 Verifier-Challenge 매커니즘과 세션 통한 Verifier 보호, <code>state</code>/<code>nonce</code> 포함으로 CSRF/Replay 공격을 효과적으로 방어합니다. 최신 권고사항에서는 모든 OAuth2 클라이언트에 대해 PKCE 사용을 권장합니다.</p><hr><p>필요하시면 <strong>API Gateway 역할 PKCE 트래픽 처리</strong>, <strong>OIDC ID Token 검증 흐름</strong>, <strong>비대칭 키 기반 client authentication(mTLS/private_key_jwt)</strong> 등에 대한 추가 분석도 가능합니다!</p><p>다음은 <strong>API Gateway 중재자(Mediator) 구조</strong>와 <strong>인증 서버 설계 패턴</strong>에 대한 심화 분석입니다. 시스템 아키텍처 디자인, 흐름, 보안 고려 사항을 포함해 설명드리겠습니다.</p><hr><h2 id=-1-api-gateway-중재자-구조-mediator-pattern>🏗️ 1. API Gateway 중재자 구조 (Mediator Pattern)<a hidden class=anchor aria-hidden=true href=#-1-api-gateway-중재자-구조-mediator-pattern>#</a></h2><p>API Gateway는 클라이언트와 백엔드 간의 싱글 진입지점으로, 인증, 권한, 라우팅, 로깅, 캐싱 등 역할을 수행합니다 (<a href="https://www.okta.com/identity-101/what-is-token-based-authentication/?utm_source=chatgpt.com" title="What Is Token-Based Authentication? - Okta">medium.com</a>).</p><pre class=mermaid>flowchart LR
  UI[Client(UI/Mobile)] --&gt; API_GW[API Gateway / BFF]
  API_GW --&gt; AuthSVR[Auth Server (OAuth2/JWT)]
  API_GW --&gt; MS_A[Microservice A]
  API_GW --&gt; MS_B[Microservice B]
  AuthSVR --&gt; JWKS[Key Store / JWKS]
  MS_A &amp; MS_B --&gt; DB[Database]
</pre><ul><li><strong>API Gateway</strong>: 중재자 역할로 요청 검증, 토큰 검증, 라우팅, 응답 조합 수행</li><li><strong>인증 서버(Auth Server)</strong>: OAuth2/JWT 기반 토큰 발급 및 JWKS 제공</li><li><strong>Key Store/JWKS</strong>: public key를 제공해 Gateway와 서비스가 토큰 검증</li><li><strong>마이크로서비스</strong>: Gateway에서 보장된 클레임만 검사, 내부 비즈니스 처리</li></ul><h3 id=기능-및-특징-정리>기능 및 특징 정리<a hidden class=anchor aria-hidden=true href=#기능-및-특징-정리>#</a></h3><table><thead><tr><th>기능 영역</th><th>API Gateway 역할</th></tr></thead><tbody><tr><td>인증(Authentication)</td><td>토큰 서명·만료·Issuer/audience 검증 (<a href="https://frontegg.com/blog/token-based-authentication?utm_source=chatgpt.com" title="Understanding Token-Based Authentication: A Detailed Review">stackoverflow.blog</a>)</td></tr><tr><td>권한(Authorization)</td><td>scope/role 기반 접근 제어</td></tr><tr><td>라우팅(Routing)</td><td>서비스 식별 + 프로토콜 변환</td></tr><tr><td>캐싱/어그리게이션</td><td>여러 서비스 데이터 통합, 응답 최적화</td></tr><tr><td>모니터링/로깅</td><td>요청/응답 로깅, 메트릭 수집</td></tr><tr><td>보안(Security)</td><td>TLS 종료, IP 필터링, Rate Limiting 등 지원</td></tr></tbody></table><hr><h2 id=-2-인증-서버-설계-패턴>🔒 2. 인증 서버 설계 패턴<a hidden class=anchor aria-hidden=true href=#-2-인증-서버-설계-패턴>#</a></h2><h3 id=a-oauth2-권한-서버-authorization-server>A. OAuth2 권한 서버 (Authorization Server)<a hidden class=anchor aria-hidden=true href=#a-oauth2-권한-서버-authorization-server>#</a></h3><p>인증 및 토큰 발급을 전담하는 서비스로, 다음을 제공합니다:</p><ul><li><strong>토큰 발급</strong>: Authorization Code, Client Credentials, Password Flow 등</li><li><strong>토큰 유형</strong>: Access / Refresh / ID Token</li><li><strong>키 관리</strong>: RS256 등 비대칭 서명 방식 + JWKS 엔드포인트 운영</li><li><strong>PKCE / state / nonce</strong>: SPAs용 보안 강화</li><li><strong>Scope 관리</strong>: 자원 기반 권한 제어 (<a href="https://medium.com/%40akhil-mottammal/understanding-token-based-authentication-in-web-development-9088d9a4f01e?utm_source=chatgpt.com" title="Understanding Token-Based Authentication in Web Development">stackoverflow.com</a>, <a href="https://en.wikipedia.org/wiki/Kerberos_%28protocol%29?utm_source=chatgpt.com" title="Kerberos (protocol)">curity.io</a>, <a href="https://en.wikipedia.org/wiki/JSON_Web_Token?utm_source=chatgpt.com" title="JSON Web Token">curity.medium.com</a>)</li></ul><hr><h3 id=b-backend-for-frontend-및-token-handler-패턴>B. Backend-for-Frontend 및 Token Handler 패턴<a hidden class=anchor aria-hidden=true href=#b-backend-for-frontend-및-token-handler-패턴>#</a></h3><p>SPA나 모바일 앱에서 토큰을 브라우저에 직접 저장하지 않고 서버 측에서 처리하는 패턴입니다 :</p><ul><li><strong>Token Handler</strong>: 클라이언트 대신 토큰 교환 및 검증 수행</li><li><strong>세션 쿠키</strong>: httpOnly Cookie로 토큰 유지 → XSS 위험 감소</li><li><strong>SPA 구성 요소 분리</strong>: UI와 토큰 처리 로직 분리</li></ul><hr><h3 id=c-게이트키퍼gatekeeper-패턴>C. 게이트키퍼(Gatekeeper) 패턴<a hidden class=anchor aria-hidden=true href=#c-게이트키퍼gatekeeper-패턴>#</a></h3><p>API Gateway 내 또는 별도 서비스에서 인증 필터 역할 수행:</p><ul><li><strong>401/403 차단</strong>: 잘못된 토큰 요청은 Gateway에서 즉시 처리</li><li><strong>정책 집약</strong>: URL, 메소드, IP, Role 기반 접근 정책 적용 (<a href="https://www.okta.com/identity-101/what-is-token-based-authentication/?utm_source=chatgpt.com" title="What Is Token-Based Authentication? - Okta">medium.com</a>, <a href="https://curity.io/resources/learn/the-token-handler-pattern/?utm_source=chatgpt.com" title="Protecting Single Page Apps with Token Handler Pattern | Curity">curity.io</a>, <a href="https://securitypatterns.io/docs/06-api-services-security-pattern/?utm_source=chatgpt.com" title="How to Write A Security Pattern - API Services - SecurityPatterns.io">securitypatterns.io</a>)</li></ul><hr><h3 id=d-lambda-authorizer--serverless-패턴>D. Lambda Authorizer / Serverless 패턴<a hidden class=anchor aria-hidden=true href=#d-lambda-authorizer--serverless-패턴>#</a></h3><p>AWS API Gateway 예시:</p><ul><li><strong>Lambda Authorizer</strong>: JWT 검증 후 IAM 정책 생성 및 API 요청 허용 여부 판단 (<a href="https://aws.amazon.com/blogs/modernizing-with-aws/secure-api-authorization-in-amazon-api-gateway-using-microsoft-entra-id/?utm_source=chatgpt.com" title="Secure API authorization in Amazon API Gateway using Microsoft ...">aws.amazon.com</a>)</li></ul><hr><h2 id=-3-설계-비교-요약>🛡️ 3. 설계 비교 요약<a hidden class=anchor aria-hidden=true href=#-3-설계-비교-요약>#</a></h2><table><thead><tr><th>패턴</th><th>설명</th><th>장점</th><th>보안 관점</th></tr></thead><tbody><tr><td>API Gateway Gateway Pattern</td><td>중앙 집중형 인증·라우팅</td><td>유연성, 정책 일관성</td><td>단일 진입점 보안 강화</td></tr><tr><td>BFF / Token Handler</td><td>SPA 대상 UI/토큰 로직 분리</td><td>XSS 취약 저감, 토큰 은폐</td><td>쿠키 기반 보호</td></tr><tr><td>Gatekeeper Auth Zoning</td><td>요청 전 검증, 분리된 영역</td><td>빠른 리젝, 정책 집중화</td><td>인증 실패 시 1차 방어</td></tr><tr><td>Lambda 뜰저 Authorizer</td><td>서버리스로 인증 분리</td><td>확장성·비용 효율적</td><td>토큰 유효성 / 권한 정책</td></tr></tbody></table><hr><h2 id=-4-최적화-및-보안-구현-전략>✅ 4. 최적화 및 보안 구현 전략<a hidden class=anchor aria-hidden=true href=#-4-최적화-및-보안-구현-전략>#</a></h2><ol><li><strong>비대칭 서명 + JWKS 캐싱</strong>: 키 파악 자동화, 서명 강도 확보</li><li><strong>Scope 설계</strong>: 세분화된 권한 부여 정책</li><li><strong>Rate Limiting 및 WAF 적용</strong>: API Gateway에서 트래픽 보호</li><li><strong>로그 통합 & 모니터링</strong>: SIEM 연계 이벤트 수집 (<a href="https://www.practical-devsecops.com/api-gateway-security-best-practices/?srsltid=AfmBOoqc_rzJV6XZ6vCeeEhsoRGz1EX2lEWvOPWHa6P-PstKQOeXI-3G&amp;utm_source=chatgpt.com" title="API Gateway Security Best Practices for 2025">practical-devsecops.com</a>, <a href="https://astconsulting.in/microservices/api-gateway-in-microservices-patterns?utm_source=chatgpt.com" title="API Gateway in Microservices Top 5 Patterns and Best Practices Guide">astconsulting.in</a>)</li><li><strong>TLS 종료 지점 일원화</strong>: Gateway에서 TLS 처리 → 내부는 평문 가능</li><li><strong>PKCE, state, nonce 적용</strong>: Public Client의 토큰탈취 복원 방지 (<a href="https://securitypatterns.io/docs/06-api-services-security-pattern/?utm_source=chatgpt.com" title="How to Write A Security Pattern - API Services - SecurityPatterns.io">securitypatterns.io</a>, <a href="https://cevo.com.au/post/microservices-api-gateway-pattern/?utm_source=chatgpt.com" title="Microservices - API gateway pattern - Cevo">cevo.com.au</a>)</li></ol><hr><h2 id=-종합>🎯 종합<a hidden class=anchor aria-hidden=true href=#-종합>#</a></h2><p>중재자 구조를 갖춘 API Gateway는 인증 서버, 마이크로서비스, 클라이언트 간 유기적 연결 구조를 제공하며, Gateway는 보안, 로깅, 인증, 권한 모두를 담당합니다. 인증 서버는 OAuth2/JWT 기반으로 토큰 발급, 키 관리, PKCE 등을 처리하며, BFF/Token Handler와 Gatekeeper 패턴은 SPA 보안 강화에 유용합니다. Lambda Authorizer 등서버리스를 통해 비용과 유연성도 확보할 수 있습니다.</p><p>필요하시면 <strong>엔터프라이즈급 API Gateway(JWT+OIDC) 구현 예제</strong>, <strong>AWS/Azure API Gateway 설계 사례</strong>, <strong>Token Handler 기반 인증 흐름</strong> 등을 이어서 제공드릴 수 있습니다! 😊</p><p>토큰 기반 인증 (Token-Based Authentication)에 대한 심화 조사를 시작하겠습니다. 먼저 최신 정보와 현재 동향을 파악하기 위해 웹 검색을 수행하겠습니다.</p><h1 id=token-based-authentication-심화-조사-및-분석>Token-Based Authentication 심화 조사 및 분석<a hidden class=anchor aria-hidden=true href=#token-based-authentication-심화-조사-및-분석>#</a></h1><h2 id=1-태그-생성-영어>1. 태그 생성 (영어)<a hidden class=anchor aria-hidden=true href=#1-태그-생성-영어>#</a></h2><ul><li><code>Token-Based-Authentication</code></li><li><code>JWT-Security</code></li><li><code>OAuth-Authorization</code></li><li><code>API-Access-Control</code></li></ul><h2 id=2-주제-분류의-계층-구조-검증>2. 주제 분류의 계층 구조 검증<a hidden class=anchor aria-hidden=true href=#2-주제-분류의-계층-구조-검증>#</a></h2><p><strong>제시된 분류</strong>: &ldquo;Computer Science and Engineering > Cybersecurity and Information Security > Access Control > Implementations&rdquo;</p><p><strong>검증 결과</strong>: 이 분류는 매우 적절합니다. Token-Based Authentication은 사이버보안 영역 내에서 접근 제어 (Access Control)의 구체적인 구현 방법론이므로, 제시된 계층 구조가 정확합니다. 근거로는 다음과 같습니다:</p><ul><li>컴퓨터 과학 및 공학의 하위 영역인 사이버보안에 속함</li><li>정보보안의 핵심 요소인 접근 제어 메커니즘임</li><li>실제 시스템에서 구현 가능한 구체적인 기술적 방법론임</li></ul><h2 id=3-주제-요약-200자-내외>3. 주제 요약 (200자 내외)<a hidden class=anchor aria-hidden=true href=#3-주제-요약-200자-내외>#</a></h2><p>토큰 기반 인증 (Token-Based Authentication)은 사용자의 신원을 확인하기 위해 암호화된 토큰을 사용하는 보안 프로토콜입니다. 전통적인 사용자명-비밀번호 방식 대신 또는 함께 사용되어, 초기 인증 후 생성된 토큰으로 리소스 접근을 관리합니다. JWT (JSON Web Token), OAuth 등이 대표적이며, 무상태 (Stateless) 특성으로 확장성과 보안성을 제공하는 현대 웹 애플리케이션의 핵심 인증 메커니즘입니다.</p><h2 id=4-전체-개요-250자-내외>4. 전체 개요 (250자 내외)<a hidden class=anchor aria-hidden=true href=#4-전체-개요-250자-내외>#</a></h2><p>토큰 기반 인증은 디지털 시대의 분산 시스템과 마이크로서비스 아키텍처에서 필수적인 보안 기술입니다. 사용자가 초기 인증을 완료하면 서버가 암호화된 토큰을 발급하고, 이후 모든 요청에서 이 토큰을 검증하여 접근을 제어합니다. 세션 관리가 불필요한 무상태 특성으로 서버 부하를 줄이고, Single Sign-On (SSO) 구현을 용이하게 합니다. JWT, OAuth 2.0, SAML 등 다양한 표준이 존재하며, API 보안, 모바일 애플리케이션, 클라우드 서비스에서 광범위하게 활용됩니다. 토큰 유출, 만료 관리, 폐기 메커니즘 등의 보안 고려사항이 중요합니다.</p><hr><h1 id=-token-based-authentication-심화-분석>🔐 Token-Based Authentication 심화 분석<a hidden class=anchor aria-hidden=true href=#-token-based-authentication-심화-분석>#</a></h1><h2 id=제-1부-핵심-개념-및-기본-원리><strong>제 1부: 핵심 개념 및 기본 원리</strong><a hidden class=anchor aria-hidden=true href=#제-1부-핵심-개념-및-기본-원리>#</a></h2><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><p>토큰 기반 인증을 구현하기 위해 반드시 알아야 하는 핵심 개념들을 이론과 실무 관점에서 분석하겠습니다.</p><h4 id=1-토큰-token의-본질>1. 토큰 (Token)의 본질<a hidden class=anchor aria-hidden=true href=#1-토큰-token의-본질>#</a></h4><ul><li><strong>정의</strong>: 사용자의 신원과 권한 정보를 암호화하여 인코딩한 문자열</li><li><strong>구성</strong>: 헤더 (Header), 페이로드 (Payload), 서명 (Signature)의 3부분 구조</li><li><strong>특성</strong>: 자체 포함적 (Self-contained), 무상태 (Stateless), 시간 제한적 (Time-bounded)</li></ul><h4 id=2-인증-authentication-vs-인가-authorization>2. 인증 (Authentication) vs 인가 (Authorization)<a hidden class=anchor aria-hidden=true href=#2-인증-authentication-vs-인가-authorization>#</a></h4><ul><li><strong>인증</strong>: 사용자가 본인임을 확인하는 과정</li><li><strong>인가</strong>: 인증된 사용자에게 특정 리소스 접근 권한을 부여하는 과정</li><li><strong>토큰의 역할</strong>: 두 과정을 모두 지원하는 통합 메커니즘</li></ul><h4 id=3-무상태성-statelessness>3. 무상태성 (Statelessness)<a hidden class=anchor aria-hidden=true href=#3-무상태성-statelessness>#</a></h4><ul><li><strong>개념</strong>: 서버가 클라이언트의 상태 정보를 저장하지 않음</li><li><strong>장점</strong>: 서버 확장성 향상, 분산 시스템 구현 용이</li><li><strong>구현</strong>: 토큰 자체에 필요한 모든 정보 포함</li></ul><h4 id=4-암호화-및-서명-메커니즘>4. 암호화 및 서명 메커니즘<a hidden class=anchor aria-hidden=true href=#4-암호화-및-서명-메커니즘>#</a></h4><ul><li><strong>대칭 키 암호화</strong>: HMAC-SHA256 (HS256)</li><li><strong>비대칭 키 암호화</strong>: RSA-SHA256 (RS256), ECDSA (ES256)</li><li><strong>서명 목적</strong>: 토큰 무결성 검증 및 위변조 방지</li></ul><h4 id=실무-구현-연관성-분석>실무 구현 연관성 분석<a hidden class=anchor aria-hidden=true href=#실무-구현-연관성-분석>#</a></h4><p>토큰 기반 인증 구현을 위해 다음 측면들이 연관되어 있습니다:</p><p><strong>1. 보안 측면</strong></p><ul><li>토큰 생성 시 강력한 암호화 알고리즘 적용</li><li>토큰 저장 시 보안 저장소 활용 (HTTPOnly 쿠키, 암호화된 로컬 스토리지)</li><li>토큰 전송 시 HTTPS 프로토콜 필수 사용</li></ul><p><strong>2. 성능 측면</strong></p><ul><li>토큰 크기 최적화를 통한 네트워크 오버헤드 최소화</li><li>토큰 검증 로직의 효율적 구현</li><li>캐싱 메커니즘을 통한 반복 검증 최적화</li></ul><p><strong>3. 확장성 측면</strong></p><ul><li>무상태 설계를 통한 수평 확장 지원</li><li>마이크로서비스 간 토큰 공유 메커니즘</li><li>로드 밸런서와의 호환성 확보</li></ul><h3 id=배경>배경<a hidden class=anchor aria-hidden=true href=#배경>#</a></h3><p>토큰 기반 인증이 등장한 배경을 살펴보겠습니다.</p><h4 id=전통적-세션-기반-인증의-한계>전통적 세션 기반 인증의 한계<a hidden class=anchor aria-hidden=true href=#전통적-세션-기반-인증의-한계>#</a></h4><ol><li><strong>서버 상태 의존성</strong>: 세션 정보를 서버 메모리나 데이터베이스에 저장</li><li><strong>확장성 문제</strong>: 여러 서버 간 세션 공유의 복잡성</li><li><strong>모바일 환경 부적합</strong>: 쿠키 기반 세션 관리의 한계</li><li><strong>API 친화성 부족</strong>: RESTful API의 무상태 원칙과 충돌</li></ol><h4 id=분산-시스템-및-마이크로서비스-아키텍처의-요구사항>분산 시스템 및 마이크로서비스 아키텍처의 요구사항<a hidden class=anchor aria-hidden=true href=#분산-시스템-및-마이크로서비스-아키텍처의-요구사항>#</a></h4><ul><li>서비스 간 독립적인 인증/인가 메커니즘 필요</li><li>중앙 집중식 인증 서버를 통한 통합 관리</li><li>크로스 플랫폼 및 크로스 도메인 지원</li></ul><h3 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h3><h4 id=1-보안-강화>1. 보안 강화<a hidden class=anchor aria-hidden=true href=#1-보안-강화>#</a></h4><ul><li>비밀번호 기반 인증의 취약점 보완</li><li>토큰 만료를 통한 보안 위험 최소화</li><li>권한 세분화를 통한 최소 권한 원칙 구현</li></ul><h4 id=2-사용자-경험-개선>2. 사용자 경험 개선<a hidden class=anchor aria-hidden=true href=#2-사용자-경험-개선>#</a></h4><ul><li>Single Sign-On (SSO) 구현을 통한 편의성 향상</li><li>다중 디바이스 지원</li><li>빠른 인증 속도</li></ul><h4 id=3-시스템-아키텍처-최적화>3. 시스템 아키텍처 최적화<a hidden class=anchor aria-hidden=true href=#3-시스템-아키텍처-최적화>#</a></h4><ul><li>서버 리소스 절약</li><li>확장성 향상</li><li>개발 복잡성 감소</li></ul><h3 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h3><h4 id=1-인증-관리>1. 인증 관리<a hidden class=anchor aria-hidden=true href=#1-인증-관리>#</a></h4><ul><li>사용자 신원 확인</li><li>다중 인증 팩터 지원</li><li>인증 상태 유지</li></ul><h4 id=2-인가-제어>2. 인가 제어<a hidden class=anchor aria-hidden=true href=#2-인가-제어>#</a></h4><ul><li>리소스 접근 권한 관리</li><li>역할 기반 접근 제어 (RBAC)</li><li>동적 권한 할당</li></ul><h4 id=3-세션-관리>3. 세션 관리<a hidden class=anchor aria-hidden=true href=#3-세션-관리>#</a></h4><ul><li>토큰 생명주기 관리</li><li>갱신 메커니즘</li><li>폐기 및 블랙리스트 관리</li></ul><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><h4 id=1-자체-포함성-self-contained>1. 자체 포함성 (Self-contained)<a hidden class=anchor aria-hidden=true href=#1-자체-포함성-self-contained>#</a></h4><p>토큰 자체에 필요한 모든 정보가 포함되어 있어 별도의 저장소 조회가 불필요합니다.</p><h4 id=2-플랫폼-독립성>2. 플랫폼 독립성<a hidden class=anchor aria-hidden=true href=#2-플랫폼-독립성>#</a></h4><p>다양한 플랫폼과 기술 스택에서 동일하게 사용 가능합니다.</p><h4 id=3-확장성>3. 확장성<a hidden class=anchor aria-hidden=true href=#3-확장성>#</a></h4><p>무상태 특성으로 인해 서버 확장이 용이합니다.</p><h4 id=4-보안성>4. 보안성<a hidden class=anchor aria-hidden=true href=#4-보안성>#</a></h4><p>암호화 서명을 통해 위변조를 방지합니다.</p><hr><h2 id=제-2부-구조-아키텍처-및-작동-원리><strong>제 2부: 구조, 아키텍처 및 작동 원리</strong><a hidden class=anchor aria-hidden=true href=#제-2부-구조-아키텍처-및-작동-원리>#</a></h2><h3 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h3><h4 id=1-최소-권한-원칙-principle-of-least-privilege>1. 최소 권한 원칙 (Principle of Least Privilege)<a hidden class=anchor aria-hidden=true href=#1-최소-권한-원칙-principle-of-least-privilege>#</a></h4><p>사용자에게 작업 수행에 필요한 최소한의 권한만 부여합니다.</p><h4 id=2-무상태-원칙-stateless-principle>2. 무상태 원칙 (Stateless Principle)<a hidden class=anchor aria-hidden=true href=#2-무상태-원칙-stateless-principle>#</a></h4><p>서버는 클라이언트의 상태를 저장하지 않고, 모든 정보를 토큰에 포함시킵니다.</p><h4 id=3-토큰-만료-원칙-token-expiration-principle>3. 토큰 만료 원칙 (Token Expiration Principle)<a hidden class=anchor aria-hidden=true href=#3-토큰-만료-원칙-token-expiration-principle>#</a></h4><p>모든 토큰은 제한된 수명을 가지며, 정기적으로 갱신되어야 합니다.</p><h4 id=4-암호화-무결성-원칙-cryptographic-integrity-principle>4. 암호화 무결성 원칙 (Cryptographic Integrity Principle)<a hidden class=anchor aria-hidden=true href=#4-암호화-무결성-원칙-cryptographic-integrity-principle>#</a></h4><p>토큰의 무결성을 보장하기 위해 강력한 암호화 서명을 사용합니다.</p><h3 id=주요-원리>주요 원리<a hidden class=anchor aria-hidden=true href=#주요-원리>#</a></h3><p>토큰 기반 인증의 주요 원리를 다이어그램으로 표현하겠습니다.</p><pre class=mermaid>graph TD
    A[사용자 로그인 요청] --&gt; B[인증 서버]
    B --&gt; C{자격 증명 검증}
    C --&gt;|성공| D[토큰 생성]
    C --&gt;|실패| E[인증 거부]
    D --&gt; F[토큰 반환]
    F --&gt; G[클라이언트 토큰 저장]
    G --&gt; H[보호된 리소스 요청]
    H --&gt; I[토큰 검증]
    I --&gt; J{토큰 유효성}
    J --&gt;|유효| K[리소스 접근 허용]
    J --&gt;|무효| L[접근 거부]
    K --&gt; M[응답 반환]
</pre><p><strong>주요 원리 설명</strong>:</p><ol><li><strong>토큰 생성</strong>: 성공적인 인증 후 암호화된 토큰 발급</li><li><strong>토큰 검증</strong>: 각 요청마다 토큰의 유효성 및 권한 확인</li><li><strong>무상태 처리</strong>: 서버는 세션 정보를 저장하지 않음</li><li><strong>시간 기반 만료</strong>: 토큰은 설정된 시간 후 자동 만료</li></ol><h3 id=작동-원리>작동 원리<a hidden class=anchor aria-hidden=true href=#작동-원리>#</a></h3><p>토큰 기반 인증의 상세한 작동 원리를 단계별로 설명하겠습니다.</p><pre class=mermaid>sequenceDiagram
    participant C as 클라이언트
    participant AS as 인증 서버
    participant RS as 리소스 서버
    
    C-&gt;&gt;AS: 1. 로그인 요청 (ID/PW)
    AS-&gt;&gt;AS: 2. 자격 증명 검증
    AS-&gt;&gt;AS: 3. 토큰 생성 (Header + Payload + Signature)
    AS-&gt;&gt;C: 4. 토큰 반환
    C-&gt;&gt;C: 5. 토큰 저장
    C-&gt;&gt;RS: 6. API 요청 + 토큰 (Authorization Header)
    RS-&gt;&gt;RS: 7. 토큰 검증 (서명 확인)
    RS-&gt;&gt;RS: 8. 권한 확인
    RS-&gt;&gt;C: 9. 응답 반환
    
    Note over C,RS: 토큰 만료 시 갱신 과정
    C-&gt;&gt;AS: 10. 토큰 갱신 요청 (Refresh Token)
    AS-&gt;&gt;C: 11. 새로운 Access Token 발급
</pre><p><strong>작동 원리 단계별 분석</strong>:</p><ol><li><strong>초기 인증 단계</strong>: 사용자 자격 증명 확인 및 토큰 발급</li><li><strong>토큰 저장 단계</strong>: 클라이언트에서 안전한 토큰 저장</li><li><strong>요청/응답 단계</strong>: 토큰을 포함한 API 요청 및 검증</li><li><strong>갱신 단계</strong>: 만료된 토큰의 갱신 메커니즘</li></ol><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><p>토큰 기반 인증 시스템의 전체 아키텍처와 구성 요소를 분석하겠습니다.</p><pre class=mermaid>graph TB
    subgraph &#34;클라이언트 계층&#34;
        WEB[웹 애플리케이션]
        MOB[모바일 앱]
        API_CLIENT[API 클라이언트]
    end
    
    subgraph &#34;게이트웨이 계층&#34;
        AG[API 게이트웨이]
        LB[로드 밸런서]
    end
    
    subgraph &#34;인증 계층&#34;
        AS[인증 서버]
        IDM[ID 관리 시스템]
        PKI[PKI 인프라]
    end
    
    subgraph &#34;애플리케이션 계층&#34;
        MS1[마이크로서비스 1]
        MS2[마이크로서비스 2]
        MS3[마이크로서비스 3]
    end
    
    subgraph &#34;데이터 계층&#34;
        DB[(사용자 DB)]
        CACHE[(토큰 캐시)]
        LOG[(로그 저장소)]
    end
    
    WEB --&gt; AG
    MOB --&gt; AG
    API_CLIENT --&gt; AG
    AG --&gt; LB
    LB --&gt; AS
    AS --&gt; IDM
    AS --&gt; PKI
    AS --&gt; DB
    AG --&gt; MS1
    AG --&gt; MS2
    AG --&gt; MS3
    MS1 --&gt; CACHE
    MS2 --&gt; CACHE
    MS3 --&gt; CACHE
    AS --&gt; LOG
</pre><h4 id=필수-구성요소>필수 구성요소<a hidden class=anchor aria-hidden=true href=#필수-구성요소>#</a></h4><table><thead><tr><th>구분</th><th>구성요소</th><th>기능</th><th>역할</th><th>특징</th></tr></thead><tbody><tr><td>필수</td><td>인증 서버 (Authentication Server)</td><td>토큰 발급, 검증, 갱신</td><td>중앙 집중식 인증 관리</td><td>고가용성, 보안성</td></tr><tr><td>필수</td><td>토큰 생성기 (Token Generator)</td><td>JWT, OAuth 토큰 생성</td><td>암호화 토큰 생성</td><td>강력한 암호화 알고리즘</td></tr><tr><td>필수</td><td>토큰 검증기 (Token Validator)</td><td>토큰 서명 및 만료 검증</td><td>요청 시 토큰 유효성 확인</td><td>빠른 검증 속도</td></tr><tr><td>필수</td><td>사용자 저장소 (User Store)</td><td>사용자 정보 관리</td><td>인증 정보 저장</td><td>데이터 무결성</td></tr></tbody></table><h4 id=선택-구성요소>선택 구성요소<a hidden class=anchor aria-hidden=true href=#선택-구성요소>#</a></h4><table><thead><tr><th>구분</th><th>구성요소</th><th>기능</th><th>역할</th><th>특징</th></tr></thead><tbody><tr><td>선택</td><td>API 게이트웨이 (API Gateway)</td><td>요청 라우팅, 토큰 검증</td><td>중앙 집중식 API 관리</td><td>확장성, 모니터링</td></tr><tr><td>선택</td><td>토큰 캐시 (Token Cache)</td><td>토큰 임시 저장</td><td>검증 성능 향상</td><td>높은 처리량</td></tr><tr><td>선택</td><td>블랙리스트 저장소</td><td>폐기된 토큰 관리</td><td>토큰 무효화 처리</td><td>실시간 업데이트</td></tr><tr><td>선택</td><td>감사 로깅 시스템</td><td>인증 이벤트 기록</td><td>보안 모니터링</td><td>컴플라이언스 지원</td></tr></tbody></table><h3 id=구성-요소-1>구성 요소<a hidden class=anchor aria-hidden=true href=#구성-요소-1>#</a></h3><p>각 구성 요소의 상세 기능과 역할을 분석하겠습니다.</p><h4 id=1-인증-서버-authentication-server>1. 인증 서버 (Authentication Server)<a hidden class=anchor aria-hidden=true href=#1-인증-서버-authentication-server>#</a></h4><ul><li><strong>기능</strong>: 사용자 자격 증명 검증, 토큰 발급, 토큰 갱신</li><li><strong>역할</strong>: 시스템의 신뢰 기반 (Root of Trust)</li><li><strong>특징</strong>: 고가용성, 확장성, 보안성을 모두 만족해야 함</li></ul><h4 id=2-토큰-저장소-token-store>2. 토큰 저장소 (Token Store)<a hidden class=anchor aria-hidden=true href=#2-토큰-저장소-token-store>#</a></h4><ul><li><strong>기능</strong>: 활성 토큰 관리, 블랙리스트 관리</li><li><strong>역할</strong>: 토큰 상태 추적 및 관리</li><li><strong>특징</strong>: 빠른 읽기/쓰기 성능 필요</li></ul><h4 id=3-권한-관리-시스템-authorization-system>3. 권한 관리 시스템 (Authorization System)<a hidden class=anchor aria-hidden=true href=#3-권한-관리-시스템-authorization-system>#</a></h4><ul><li><strong>기능</strong>: 역할 기반 접근 제어 (RBAC), 속성 기반 접근 제어 (ABAC)</li><li><strong>역할</strong>: 세분화된 권한 관리</li><li><strong>특징</strong>: 동적 권한 할당 지원</li></ul><hr><h2 id=제-3부-구현-기법-및-실무-적용><strong>제 3부: 구현 기법 및 실무 적용</strong><a hidden class=anchor aria-hidden=true href=#제-3부-구현-기법-및-실무-적용>#</a></h2><h3 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h3><p>토큰 기반 인증을 구현하기 위한 주요 기법들을 상세히 분석하겠습니다.</p><h4 id=1-json-web-token-jwt-구현>1. JSON Web Token (JWT) 구현<a hidden class=anchor aria-hidden=true href=#1-json-web-token-jwt-구현>#</a></h4><p><strong>정의</strong>: RFC 7519 표준에 따라 JSON 객체를 안전하게 전송하기 위한 토큰 형식</p><p><strong>구성</strong>:</p><ul><li>Header: 토큰 타입과 암호화 알고리즘 정보</li><li>Payload: 사용자 정보와 권한 클레임</li><li>Signature: 토큰 무결성 검증을 위한 서명</li></ul><p><strong>목적</strong>:</p><ul><li>무상태 인증 구현</li><li>크로스 플랫폼 호환성 제공</li><li>마이크로서비스 간 안전한 정보 전달</li></ul><p><strong>실제 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15>15</a>
</span><span class=lnt id=hl-11-16><a class=lnlinks href=#hl-11-16>16</a>
</span><span class=lnt id=hl-11-17><a class=lnlinks href=#hl-11-17>17</a>
</span><span class=lnt id=hl-11-18><a class=lnlinks href=#hl-11-18>18</a>
</span><span class=lnt id=hl-11-19><a class=lnlinks href=#hl-11-19>19</a>
</span><span class=lnt id=hl-11-20><a class=lnlinks href=#hl-11-20>20</a>
</span><span class=lnt id=hl-11-21><a class=lnlinks href=#hl-11-21>21</a>
</span><span class=lnt id=hl-11-22><a class=lnlinks href=#hl-11-22>22</a>
</span><span class=lnt id=hl-11-23><a class=lnlinks href=#hl-11-23>23</a>
</span><span class=lnt id=hl-11-24><a class=lnlinks href=#hl-11-24>24</a>
</span><span class=lnt id=hl-11-25><a class=lnlinks href=#hl-11-25>25</a>
</span><span class=lnt id=hl-11-26><a class=lnlinks href=#hl-11-26>26</a>
</span><span class=lnt id=hl-11-27><a class=lnlinks href=#hl-11-27>27</a>
</span><span class=lnt id=hl-11-28><a class=lnlinks href=#hl-11-28>28</a>
</span><span class=lnt id=hl-11-29><a class=lnlinks href=#hl-11-29>29</a>
</span><span class=lnt id=hl-11-30><a class=lnlinks href=#hl-11-30>30</a>
</span><span class=lnt id=hl-11-31><a class=lnlinks href=#hl-11-31>31</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// JWT 토큰 생성 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>jwt</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;jsonwebtoken&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 토큰 생성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>generateToken</span><span class=p>(</span><span class=nx>user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>userId</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>username</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>username</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>roles</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>roles</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>iat</span><span class=o>:</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>),</span> <span class=c1>// 발급 시간
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>exp</span><span class=o>:</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=mi>60</span> <span class=o>*</span> <span class=mi>60</span><span class=p>)</span> <span class=c1>// 1시간 후 만료
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>secretKey</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>JWT_SECRET</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>(</span><span class=nx>payload</span><span class=p>,</span> <span class=nx>secretKey</span><span class=p>,</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>        <span class=nx>algorithm</span><span class=o>:</span> <span class=s1>&#39;HS256&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>issuer</span><span class=o>:</span> <span class=s1>&#39;auth-server&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>audience</span><span class=o>:</span> <span class=s1>&#39;api-clients&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 토큰 검증
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>verifyToken</span><span class=p>(</span><span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>decoded</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>token</span><span class=p>,</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>JWT_SECRET</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span> <span class=nx>valid</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=nx>payload</span><span class=o>:</span> <span class=nx>decoded</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span> <span class=nx>valid</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span> <span class=nx>error</span><span class=o>:</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>시스템 구성 시나리오</strong>:
E-commerce 플랫폼에서 사용자가 로그인하면 JWT를 발급받고, 이후 상품 조회, 장바구니 관리, 주문 처리 등의 API 호출 시 해당 토큰을 사용하여 인증/인가를 수행합니다.</p><h4 id=2-oauth-20-구현>2. OAuth 2.0 구현<a hidden class=anchor aria-hidden=true href=#2-oauth-20-구현>#</a></h4><p><strong>정의</strong>: 인가를 위한 개방형 표준 프로토콜로, 제3자 애플리케이션이 사용자 자격 증명 없이 리소스에 접근할 수 있도록 함</p><p><strong>구성</strong>:</p><ul><li>Authorization Server: 권한 부여 서버</li><li>Resource Server: 보호된 리소스를 제공하는 서버</li><li>Client: 리소스에 접근하려는 애플리케이션</li><li>Resource Owner: 리소스의 소유자 (사용자)</li></ul><p><strong>목적</strong>:</p><ul><li>제3자 애플리케이션의 안전한 API 접근</li><li>사용자 자격 증명 보호</li><li>세분화된 권한 제어</li></ul><p><strong>실제 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1> 1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2> 2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3> 3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4> 4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5> 5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6> 6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7> 7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8> 8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9> 9</a>
</span><span class=lnt id=hl-12-10><a class=lnlinks href=#hl-12-10>10</a>
</span><span class=lnt id=hl-12-11><a class=lnlinks href=#hl-12-11>11</a>
</span><span class=lnt id=hl-12-12><a class=lnlinks href=#hl-12-12>12</a>
</span><span class=lnt id=hl-12-13><a class=lnlinks href=#hl-12-13>13</a>
</span><span class=lnt id=hl-12-14><a class=lnlinks href=#hl-12-14>14</a>
</span><span class=lnt id=hl-12-15><a class=lnlinks href=#hl-12-15>15</a>
</span><span class=lnt id=hl-12-16><a class=lnlinks href=#hl-12-16>16</a>
</span><span class=lnt id=hl-12-17><a class=lnlinks href=#hl-12-17>17</a>
</span><span class=lnt id=hl-12-18><a class=lnlinks href=#hl-12-18>18</a>
</span><span class=lnt id=hl-12-19><a class=lnlinks href=#hl-12-19>19</a>
</span><span class=lnt id=hl-12-20><a class=lnlinks href=#hl-12-20>20</a>
</span><span class=lnt id=hl-12-21><a class=lnlinks href=#hl-12-21>21</a>
</span><span class=lnt id=hl-12-22><a class=lnlinks href=#hl-12-22>22</a>
</span><span class=lnt id=hl-12-23><a class=lnlinks href=#hl-12-23>23</a>
</span><span class=lnt id=hl-12-24><a class=lnlinks href=#hl-12-24>24</a>
</span><span class=lnt id=hl-12-25><a class=lnlinks href=#hl-12-25>25</a>
</span><span class=lnt id=hl-12-26><a class=lnlinks href=#hl-12-26>26</a>
</span><span class=lnt id=hl-12-27><a class=lnlinks href=#hl-12-27>27</a>
</span><span class=lnt id=hl-12-28><a class=lnlinks href=#hl-12-28>28</a>
</span><span class=lnt id=hl-12-29><a class=lnlinks href=#hl-12-29>29</a>
</span><span class=lnt id=hl-12-30><a class=lnlinks href=#hl-12-30>30</a>
</span><span class=lnt id=hl-12-31><a class=lnlinks href=#hl-12-31>31</a>
</span><span class=lnt id=hl-12-32><a class=lnlinks href=#hl-12-32>32</a>
</span><span class=lnt id=hl-12-33><a class=lnlinks href=#hl-12-33>33</a>
</span><span class=lnt id=hl-12-34><a class=lnlinks href=#hl-12-34>34</a>
</span><span class=lnt id=hl-12-35><a class=lnlinks href=#hl-12-35>35</a>
</span><span class=lnt id=hl-12-36><a class=lnlinks href=#hl-12-36>36</a>
</span><span class=lnt id=hl-12-37><a class=lnlinks href=#hl-12-37>37</a>
</span><span class=lnt id=hl-12-38><a class=lnlinks href=#hl-12-38>38</a>
</span><span class=lnt id=hl-12-39><a class=lnlinks href=#hl-12-39>39</a>
</span><span class=lnt id=hl-12-40><a class=lnlinks href=#hl-12-40>40</a>
</span><span class=lnt id=hl-12-41><a class=lnlinks href=#hl-12-41>41</a>
</span><span class=lnt id=hl-12-42><a class=lnlinks href=#hl-12-42>42</a>
</span><span class=lnt id=hl-12-43><a class=lnlinks href=#hl-12-43>43</a>
</span><span class=lnt id=hl-12-44><a class=lnlinks href=#hl-12-44>44</a>
</span><span class=lnt id=hl-12-45><a class=lnlinks href=#hl-12-45>45</a>
</span><span class=lnt id=hl-12-46><a class=lnlinks href=#hl-12-46>46</a>
</span><span class=lnt id=hl-12-47><a class=lnlinks href=#hl-12-47>47</a>
</span><span class=lnt id=hl-12-48><a class=lnlinks href=#hl-12-48>48</a>
</span><span class=lnt id=hl-12-49><a class=lnlinks href=#hl-12-49>49</a>
</span><span class=lnt id=hl-12-50><a class=lnlinks href=#hl-12-50>50</a>
</span><span class=lnt id=hl-12-51><a class=lnlinks href=#hl-12-51>51</a>
</span><span class=lnt id=hl-12-52><a class=lnlinks href=#hl-12-52>52</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>redirect</span><span class=p>,</span> <span class=n>session</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>secret_key</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;SECRET_KEY&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># OAuth 2.0 구성</span>
</span></span><span class=line><span class=cl><span class=n>OAUTH_CONFIG</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;client_id&#39;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;OAUTH_CLIENT_ID&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;client_secret&#39;</span><span class=p>:</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;OAUTH_CLIENT_SECRET&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;authorization_base_url&#39;</span><span class=p>:</span> <span class=s1>&#39;https://accounts.google.com/o/oauth2/auth&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;token_url&#39;</span><span class=p>:</span> <span class=s1>&#39;https://oauth2.googleapis.com/token&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;scope&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;openid&#39;</span><span class=p>,</span> <span class=s1>&#39;email&#39;</span><span class=p>,</span> <span class=s1>&#39;profile&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;OAuth 인증 시작&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>auth_url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>OAUTH_CONFIG</span><span class=p>[</span><span class=s1>&#39;authorization_base_url&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>?&#34;</span> \
</span></span><span class=line><span class=cl>               <span class=sa>f</span><span class=s2>&#34;client_id=</span><span class=si>{</span><span class=n>OAUTH_CONFIG</span><span class=p>[</span><span class=s1>&#39;client_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&amp;&#34;</span> \
</span></span><span class=line><span class=cl>               <span class=sa>f</span><span class=s2>&#34;response_type=code&amp;&#34;</span> \
</span></span><span class=line><span class=cl>               <span class=sa>f</span><span class=s2>&#34;scope=</span><span class=si>{</span><span class=s1>&#39;+&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>OAUTH_CONFIG</span><span class=p>[</span><span class=s1>&#39;scope&#39;</span><span class=p>])</span><span class=si>}</span><span class=s2>&amp;&#34;</span> \
</span></span><span class=line><span class=cl>               <span class=sa>f</span><span class=s2>&#34;redirect_uri=</span><span class=si>{</span><span class=n>request</span><span class=o>.</span><span class=n>url_root</span><span class=si>}</span><span class=s2>callback&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=n>auth_url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/callback&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>callback</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;OAuth 콜백 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>code</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;code&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Authorization Code를 Access Token으로 교환</span>
</span></span><span class=line><span class=cl>    <span class=n>token_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;client_id&#39;</span><span class=p>:</span> <span class=n>OAUTH_CONFIG</span><span class=p>[</span><span class=s1>&#39;client_id&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;client_secret&#39;</span><span class=p>:</span> <span class=n>OAUTH_CONFIG</span><span class=p>[</span><span class=s1>&#39;client_secret&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;code&#39;</span><span class=p>:</span> <span class=n>code</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;grant_type&#39;</span><span class=p>:</span> <span class=s1>&#39;authorization_code&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;redirect_uri&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>request</span><span class=o>.</span><span class=n>url_root</span><span class=si>}</span><span class=s2>callback&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>OAUTH_CONFIG</span><span class=p>[</span><span class=s1>&#39;token_url&#39;</span><span class=p>],</span> <span class=n>data</span><span class=o>=</span><span class=n>token_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>tokens</span> <span class=o>=</span> <span class=n>response</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Access Token을 사용하여 사용자 정보 조회</span>
</span></span><span class=line><span class=cl>    <span class=n>user_info</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;https://www.googleapis.com/oauth2/v1/userinfo&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>headers</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;Authorization&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;Bearer </span><span class=si>{</span><span class=n>tokens</span><span class=p>[</span><span class=s1>&#39;access_token&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>session</span><span class=p>[</span><span class=s1>&#39;user&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>user_info</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s1>&#39;/dashboard&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>시스템 구성</strong>: 소셜 미디어 통합 서비스에서 사용자가 &ldquo;Google로 로그인&rdquo; 버튼을 클릭하면 OAuth 2.0 플로우가 시작되어 Google의 인증을 거쳐 사용자 정보에 접근할 수 있습니다.</p><h4 id=3-리프레시-토큰-refresh-token-메커니즘>3. 리프레시 토큰 (Refresh Token) 메커니즘<a hidden class=anchor aria-hidden=true href=#3-리프레시-토큰-refresh-token-메커니즘>#</a></h4><p><strong>정의</strong>: Access Token의 만료 시 새로운 토큰을 발급받기 위한 장기간 유효한 토큰</p><p><strong>구성</strong>:</p><ul><li>Access Token: 짧은 수명 (15분~1시간)</li><li>Refresh Token: 긴 수명 (7일~30일)</li><li>토큰 갱신 엔드포인트</li></ul><p><strong>목적</strong>:</p><ul><li>사용자 재인증 없이 연속적인 서비스 이용</li><li>보안성과 사용성의 균형</li><li>토큰 탈취 시 피해 최소화</li></ul><p><strong>실제 예시</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1> 1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2> 2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3> 3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4> 4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5> 5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6> 6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7> 7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8> 8</a>
</span><span class=lnt id=hl-13-9><a class=lnlinks href=#hl-13-9> 9</a>
</span><span class=lnt id=hl-13-10><a class=lnlinks href=#hl-13-10>10</a>
</span><span class=lnt id=hl-13-11><a class=lnlinks href=#hl-13-11>11</a>
</span><span class=lnt id=hl-13-12><a class=lnlinks href=#hl-13-12>12</a>
</span><span class=lnt id=hl-13-13><a class=lnlinks href=#hl-13-13>13</a>
</span><span class=lnt id=hl-13-14><a class=lnlinks href=#hl-13-14>14</a>
</span><span class=lnt id=hl-13-15><a class=lnlinks href=#hl-13-15>15</a>
</span><span class=lnt id=hl-13-16><a class=lnlinks href=#hl-13-16>16</a>
</span><span class=lnt id=hl-13-17><a class=lnlinks href=#hl-13-17>17</a>
</span><span class=lnt id=hl-13-18><a class=lnlinks href=#hl-13-18>18</a>
</span><span class=lnt id=hl-13-19><a class=lnlinks href=#hl-13-19>19</a>
</span><span class=lnt id=hl-13-20><a class=lnlinks href=#hl-13-20>20</a>
</span><span class=lnt id=hl-13-21><a class=lnlinks href=#hl-13-21>21</a>
</span><span class=lnt id=hl-13-22><a class=lnlinks href=#hl-13-22>22</a>
</span><span class=lnt id=hl-13-23><a class=lnlinks href=#hl-13-23>23</a>
</span><span class=lnt id=hl-13-24><a class=lnlinks href=#hl-13-24>24</a>
</span><span class=lnt id=hl-13-25><a class=lnlinks href=#hl-13-25>25</a>
</span><span class=lnt id=hl-13-26><a class=lnlinks href=#hl-13-26>26</a>
</span><span class=lnt id=hl-13-27><a class=lnlinks href=#hl-13-27>27</a>
</span><span class=lnt id=hl-13-28><a class=lnlinks href=#hl-13-28>28</a>
</span><span class=lnt id=hl-13-29><a class=lnlinks href=#hl-13-29>29</a>
</span><span class=lnt id=hl-13-30><a class=lnlinks href=#hl-13-30>30</a>
</span><span class=lnt id=hl-13-31><a class=lnlinks href=#hl-13-31>31</a>
</span><span class=lnt id=hl-13-32><a class=lnlinks href=#hl-13-32>32</a>
</span><span class=lnt id=hl-13-33><a class=lnlinks href=#hl-13-33>33</a>
</span><span class=lnt id=hl-13-34><a class=lnlinks href=#hl-13-34>34</a>
</span><span class=lnt id=hl-13-35><a class=lnlinks href=#hl-13-35>35</a>
</span><span class=lnt id=hl-13-36><a class=lnlinks href=#hl-13-36>36</a>
</span><span class=lnt id=hl-13-37><a class=lnlinks href=#hl-13-37>37</a>
</span><span class=lnt id=hl-13-38><a class=lnlinks href=#hl-13-38>38</a>
</span><span class=lnt id=hl-13-39><a class=lnlinks href=#hl-13-39>39</a>
</span><span class=lnt id=hl-13-40><a class=lnlinks href=#hl-13-40>40</a>
</span><span class=lnt id=hl-13-41><a class=lnlinks href=#hl-13-41>41</a>
</span><span class=lnt id=hl-13-42><a class=lnlinks href=#hl-13-42>42</a>
</span><span class=lnt id=hl-13-43><a class=lnlinks href=#hl-13-43>43</a>
</span><span class=lnt id=hl-13-44><a class=lnlinks href=#hl-13-44>44</a>
</span><span class=lnt id=hl-13-45><a class=lnlinks href=#hl-13-45>45</a>
</span><span class=lnt id=hl-13-46><a class=lnlinks href=#hl-13-46>46</a>
</span><span class=lnt id=hl-13-47><a class=lnlinks href=#hl-13-47>47</a>
</span><span class=lnt id=hl-13-48><a class=lnlinks href=#hl-13-48>48</a>
</span><span class=lnt id=hl-13-49><a class=lnlinks href=#hl-13-49>49</a>
</span><span class=lnt id=hl-13-50><a class=lnlinks href=#hl-13-50>50</a>
</span><span class=lnt id=hl-13-51><a class=lnlinks href=#hl-13-51>51</a>
</span><span class=lnt id=hl-13-52><a class=lnlinks href=#hl-13-52>52</a>
</span><span class=lnt id=hl-13-53><a class=lnlinks href=#hl-13-53>53</a>
</span><span class=lnt id=hl-13-54><a class=lnlinks href=#hl-13-54>54</a>
</span><span class=lnt id=hl-13-55><a class=lnlinks href=#hl-13-55>55</a>
</span><span class=lnt id=hl-13-56><a class=lnlinks href=#hl-13-56>56</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span><span class=p>,</span> <span class=n>timedelta</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>secrets</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>jwt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TokenManager</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>secret_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>secret_key</span> <span class=o>=</span> <span class=n>secret_key</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>refresh_tokens</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># 실제로는 데이터베이스 사용</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>generate_tokens</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Access Token과 Refresh Token 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Access Token (짧은 수명)</span>
</span></span><span class=line><span class=cl>        <span class=n>access_payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;token_type&#39;</span><span class=p>:</span> <span class=s1>&#39;access&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;iat&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;exp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>+</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>minutes</span><span class=o>=</span><span class=mi>15</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>access_token</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>access_payload</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>secret_key</span><span class=p>,</span> <span class=n>algorithm</span><span class=o>=</span><span class=s1>&#39;HS256&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Refresh Token (긴 수명)</span>
</span></span><span class=line><span class=cl>        <span class=n>refresh_token</span> <span class=o>=</span> <span class=n>secrets</span><span class=o>.</span><span class=n>token_urlsafe</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>refresh_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;created_at&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;expires_at&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>+</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>refresh_tokens</span><span class=p>[</span><span class=n>refresh_token</span><span class=p>]</span> <span class=o>=</span> <span class=n>refresh_data</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;access_token&#39;</span><span class=p>:</span> <span class=n>access_token</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;refresh_token&#39;</span><span class=p>:</span> <span class=n>refresh_token</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;token_type&#39;</span><span class=p>:</span> <span class=s1>&#39;Bearer&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;expires_in&#39;</span><span class=p>:</span> <span class=mi>900</span>  <span class=c1># 15분</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>refresh_access_token</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>refresh_token</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Refresh Token을 사용하여 새로운 Access Token 발급&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>refresh_token</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>refresh_tokens</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Invalid refresh token&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>refresh_data</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>refresh_tokens</span><span class=p>[</span><span class=n>refresh_token</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>&gt;</span> <span class=n>refresh_data</span><span class=p>[</span><span class=s1>&#39;expires_at&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>refresh_tokens</span><span class=p>[</span><span class=n>refresh_token</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&#34;Refresh token expired&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 새로운 토큰 쌍 생성</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>generate_tokens</span><span class=p>(</span><span class=n>refresh_data</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>revoke_refresh_token</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>refresh_token</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Refresh Token 폐기&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>refresh_token</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>refresh_tokens</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>del</span> <span class=bp>self</span><span class=o>.</span><span class=n>refresh_tokens</span><span class=p>[</span><span class=n>refresh_token</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=4-토큰-블랙리스트-관리>4. 토큰 블랙리스트 관리<a hidden class=anchor aria-hidden=true href=#4-토큰-블랙리스트-관리>#</a></h4><p><strong>정의</strong>: 폐기되었거나 손상된 토큰을 추적하여 무효화하는 메커니즘</p><p><strong>구성</strong>:</p><ul><li>블랙리스트 저장소 (Redis, 데이터베이스)</li><li>토큰 폐기 API</li><li>검증 시 블랙리스트 확인 로직</li></ul><p><strong>목적</strong>:</p><ul><li>로그아웃 시 토큰 무효화</li><li>보안 사고 시 긴급 토큰 폐기</li><li>의심스러운 활동 시 예방적 차단</li></ul><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><p>토큰 기반 인증의 장점을 체계적으로 분석하겠습니다.</p><table><thead><tr><th>구분</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>장점</td><td>무상태성 (Statelessness)</td><td>서버가 세션 정보를 저장하지 않아 확장성이 뛰어나며, 로드 밸런싱과 마이크로서비스 아키텍처에 적합함</td></tr><tr><td>장점</td><td>플랫폼 독립성</td><td>웹, 모바일, 데스크톱 등 다양한 플랫폼에서 동일한 토큰 사용 가능</td></tr><tr><td>장점</td><td>보안성 향상</td><td>암호화 서명을 통한 위변조 방지, 토큰 만료를 통한 보안 위험 최소화</td></tr><tr><td>장점</td><td>성능 최적화</td><td>세션 조회 없이 토큰 자체에서 정보 추출 가능하여 데이터베이스 부하 감소</td></tr><tr><td>장점</td><td>SSO 구현 용이성</td><td>여러 서비스 간 토큰 공유를 통한 단일 로그인 구현</td></tr><tr><td>장점</td><td>API 친화적</td><td>RESTful API의 무상태 원칙과 완벽하게 부합</td></tr></tbody></table><h3 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점-2>단점<a hidden class=anchor aria-hidden=true href=#단점-2>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>단점</td><td>토큰 크기</td><td>JWT는 세션 ID보다 크기가 크므로 네트워크 오버헤드 증가</td><td>필요한 정보만 포함, 압축 적용</td></tr><tr><td>단점</td><td>토큰 폐기 어려움</td><td>무상태 특성으로 인해 만료 전 토큰 무효화가 복잡함</td><td>블랙리스트 메커니즘, 짧은 토큰 수명</td></tr><tr><td>단점</td><td>보안 키 관리 복잡성</td><td>서명 키 유출 시 모든 토큰이 위험에 노출됨</td><td>키 순환 정책, HSM 사용</td></tr><tr><td>단점</td><td>토큰 정보 노출</td><td>JWT는 Base64 인코딩으로 내용이 쉽게 디코딩됨</td><td>민감 정보 제외, JWE 사용</td></tr></tbody></table><h4 id=문제점-2>문제점<a hidden class=anchor aria-hidden=true href=#문제점-2>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 방법 및 기법</th></tr></thead><tbody><tr><td>문제점</td><td>토큰 탈취</td><td>XSS, 안전하지 않은 저장소 사용</td><td>계정 도용, 데이터 유출</td><td>비정상적인 접근 패턴 모니터링</td><td>HTTPS 사용, 안전한 저장소 활용</td><td>토큰 즉시 폐기, 재인증 요구</td></tr><tr><td>문제점</td><td>토큰 재사용 공격</td><td>네트워크 스니핑, 토큰 복사</td><td>무단 접근, 권한 남용</td><td>동일 토큰 동시 사용 탐지</td><td>토큰 암호화, 일회성 토큰 사용</td><td>토큰 바인딩, 디바이스 핑거프린팅</td></tr><tr><td>문제점</td><td>알고리즘 혼동 공격</td><td>서명 알고리즘 조작</td><td>토큰 위조, 권한 상승</td><td>알고리즘 불일치 로그 분석</td><td>알고리즘 화이트리스트 적용</td><td>엄격한 알고리즘 검증 로직</td></tr><tr><td>문제점</td><td>토큰 만료 처리 오류</td><td>클라이언트 시간 동기화 문제</td><td>서비스 중단, 사용성 저하</td><td>토큰 만료 오류 로그 분석</td><td>서버 시간 기준 검증</td><td>클럭 스큐 허용 범위 설정</td></tr></tbody></table><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><p>현재 기술 트렌드와 실무 환경을 반영한 토큰 기반 인증의 주요 도전 과제들을 카테고리별로 분석하겠습니다.</p><h4 id=1-보안-관련-도전-과제>1. 보안 관련 도전 과제<a hidden class=anchor aria-hidden=true href=#1-보안-관련-도전-과제>#</a></h4><p><strong>양자 컴퓨팅 위협</strong></p><ul><li><strong>원인</strong>: 현재 암호화 알고리즘의 양자 컴퓨팅 취약성</li><li><strong>영향</strong>: 기존 RSA, ECDSA 서명의 무력화 가능성</li><li><strong>탐지/진단</strong>: 양자 저항성 알고리즘 연구 동향 모니터링</li><li><strong>예방</strong>: 양자 저항 암호화 알고리즘 도입 준비</li><li><strong>해결</strong>: Post-Quantum Cryptography 표준 채택</li></ul><p><strong>제로 트러스트 아키텍처 통합</strong></p><ul><li><strong>원인</strong>: 전통적인 경계 기반 보안에서 제로 트러스트로의 패러다임 전환</li><li><strong>영향</strong>: 토큰 검증 로직의 복잡성 증가</li><li><strong>해결</strong>: 연속적인 인증 및 적응형 보안 정책 구현</li></ul><h4 id=2-확장성-관련-도전-과제>2. 확장성 관련 도전 과제<a hidden class=anchor aria-hidden=true href=#2-확장성-관련-도전-과제>#</a></h4><p><strong>글로벌 분산 환경</strong></p><ul><li><strong>원인</strong>: 멀티 리전 서비스와 엣지 컴퓨팅 확산</li><li><strong>영향</strong>: 토큰 동기화 및 일관성 유지 어려움</li><li><strong>해결</strong>: 분산 토큰 검증 메커니즘, 지역별 토큰 발급 서버</li></ul><p><strong>마이크로서비스 간 토큰 전파</strong></p><ul><li><strong>원인</strong>: 서비스 메시 복잡성 증가</li><li><strong>영향</strong>: 토큰 검증 오버헤드 및 지연 시간 증가</li><li><strong>해결</strong>: 서비스 메시 네이티브 토큰 관리, 캐싱 최적화</li></ul><h4 id=3-프라이버시-관련-도전-과제>3. 프라이버시 관련 도전 과제<a hidden class=anchor aria-hidden=true href=#3-프라이버시-관련-도전-과제>#</a></h4><p><strong>GDPR 및 개인정보보호법 준수</strong></p><ul><li><strong>원인</strong>: 강화된 개인정보보호 규제</li><li><strong>영향</strong>: 토큰 내 개인정보 포함 제한</li><li><strong>해결</strong>: 토큰 최소화 원칙, 개인정보 분리 저장</li></ul><p><strong>데이터 지역화 요구사항</strong></p><ul><li><strong>원인</strong>: 국가별 데이터 보호 규정</li><li><strong>영향</strong>: 토큰 생성 및 검증 위치 제한</li><li><strong>해결</strong>: 지역별 토큰 발급 서버, 데이터 레지던시 보장</li></ul><h3 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h3><p>토큰 기반 인증의 다양한 분류 기준과 유형을 체계적으로 정리하겠습니다.</p><table><thead><tr><th>분류 기준</th><th>유형</th><th>특징</th><th>사용 사례</th></tr></thead><tbody><tr><td><strong>토큰 형식</strong></td><td>JSON Web Token (JWT)</td><td>자체 포함형, 무상태</td><td>마이크로서비스, SPA</td></tr><tr><td></td><td>Simple Web Token (SWT)</td><td>XML 기반, 단순함</td><td>레거시 시스템</td></tr><tr><td></td><td>Security Assertion Markup Language (SAML)</td><td>XML 기반, 엔터프라이즈</td><td>기업 SSO</td></tr><tr><td><strong>암호화 방식</strong></td><td>대칭 키 (HMAC)</td><td>같은 키로 서명/검증</td><td>단일 서비스</td></tr><tr><td></td><td>비대칭 키 (RSA/ECDSA)</td><td>개인키 서명, 공개키 검증</td><td>분산 시스템</td></tr><tr><td><strong>토큰 수명</strong></td><td>단기 토큰</td><td>15분~1시간</td><td>높은 보안 요구</td></tr><tr><td></td><td>중기 토큰</td><td>1~24시간</td><td>일반 웹 서비스</td></tr><tr><td></td><td>장기 토큰</td><td>7~30일</td><td>모바일 앱</td></tr><tr><td><strong>용도별</strong></td><td>Access Token</td><td>리소스 접근</td><td>API 호출</td></tr><tr><td></td><td>Refresh Token</td><td>토큰 갱신</td><td>지속적 접근</td></tr><tr><td></td><td>ID Token</td><td>사용자 신원</td><td>OpenID Connect</td></tr><tr><td><strong>저장 방식</strong></td><td>메모리 저장</td><td>휘발성, 빠름</td><td>임시 세션</td></tr><tr><td></td><td>쿠키 저장</td><td>자동 전송, XSS 취약</td><td>웹 애플리케이션</td></tr><tr><td></td><td>로컬 스토리지</td><td>지속적, CSRF 안전</td><td>SPA</td></tr><tr><td></td><td>보안 저장소</td><td>암호화, 높은 보안</td><td>모바일 앱</td></tr></tbody></table><h3 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h3><p>토큰 기반 인증이 실무에서 어떻게 활용되는지 구체적인 예시를 표로 정리하겠습니다.</p><table><thead><tr><th>사용 목적</th><th>함께 사용되는 기술</th><th>효과</th><th>적용 분야</th></tr></thead><tbody><tr><td>API 보안</td><td>RESTful API, OAuth 2.0</td><td>무단 접근 차단, 요청 추적</td><td>핀테크, 헬스케어</td></tr><tr><td>마이크로서비스 인증</td><td>Service Mesh, JWT</td><td>서비스 간 안전한 통신</td><td>클라우드 네이티브</td></tr><tr><td>모바일 앱 인증</td><td>PKCE, Mobile SDK</td><td>안전한 앱 접근, UX 향상</td><td>소셜미디어, 게임</td></tr><tr><td>SSO 구현</td><td>SAML, OpenID Connect</td><td>통합 로그인, 관리 효율성</td><td>엔터프라이즈</td></tr><tr><td>IoT 디바이스 인증</td><td>MQTT, CoAP</td><td>디바이스 식별, 보안 통신</td><td>스마트홈, 산업 IoT</td></tr><tr><td>클라우드 서비스</td><td>AWS IAM, Azure AD</td><td>리소스 접근 제어</td><td>클라우드 인프라</td></tr></tbody></table><hr><h2 id=제-4부-활용-사례-및-최적화-방안><strong>제 4부: 활용 사례 및 최적화 방안</strong><a hidden class=anchor aria-hidden=true href=#제-4부-활용-사례-및-최적화-방안>#</a></h2><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><p><strong>전자상거래 플랫폼의 멀티채널 인증 시스템</strong></p><p>대규모 전자상거래 플랫폼에서 웹사이트, 모바일 앱, 파트너 API를 통합 관리하는 토큰 기반 인증 시스템 사례를 분석하겠습니다.</p><h4 id=시스템-구성>시스템 구성<a hidden class=anchor aria-hidden=true href=#시스템-구성>#</a></h4><pre class=mermaid>graph TB
    subgraph &#34;클라이언트 계층&#34;
        WEB[웹 사이트]
        MOBILE[모바일 앱]
        PARTNER[파트너 API]
    end
    
    subgraph &#34;인증 계층&#34;
        AG[API 게이트웨이]
        AUTH[인증 서버]
        OAuth[OAuth 2.0 서버]
    end
    
    subgraph &#34;비즈니스 로직 계층&#34;
        USER_SVC[사용자 서비스]
        PRODUCT_SVC[상품 서비스]
        ORDER_SVC[주문 서비스]
        PAYMENT_SVC[결제 서비스]
    end
    
    subgraph &#34;데이터 계층&#34;
        USER_DB[(사용자 DB)]
        PRODUCT_DB[(상품 DB)]
        ORDER_DB[(주문 DB)]
        REDIS[(토큰 캐시)]
    end
    
    WEB --&gt; AG
    MOBILE --&gt; AG
    PARTNER --&gt; OAuth
    AG --&gt; AUTH
    OAuth --&gt; AUTH
    AUTH --&gt; USER_DB
    AUTH --&gt; REDIS
    
    AG --&gt; USER_SVC
    AG --&gt; PRODUCT_SVC
    AG --&gt; ORDER_SVC
    AG --&gt; PAYMENT_SVC
    
    USER_SVC --&gt; USER_DB
    PRODUCT_SVC --&gt; PRODUCT_DB
    ORDER_SVC --&gt; ORDER_DB
    PAYMENT_SVC --&gt; REDIS
</pre><h4 id=활용-사례-workflow>활용 사례 Workflow<a hidden class=anchor aria-hidden=true href=#활용-사례-workflow>#</a></h4><pre class=mermaid>sequenceDiagram
    participant U as 사용자
    participant W as 웹/모바일
    participant AG as API 게이트웨이
    participant AS as 인증 서버
    participant PS as 상품 서비스
    participant OS as 주문 서비스
    
    U-&gt;&gt;W: 1. 로그인 요청
    W-&gt;&gt;AG: 2. 인증 요청 전달
    AG-&gt;&gt;AS: 3. 자격 증명 검증
    AS-&gt;&gt;AS: 4. JWT 토큰 생성
    AS-&gt;&gt;W: 5. 토큰 반환
    W-&gt;&gt;W: 6. 토큰 저장
    
    U-&gt;&gt;W: 7. 상품 조회
    W-&gt;&gt;AG: 8. API 요청 + JWT
    AG-&gt;&gt;AG: 9. 토큰 검증
    AG-&gt;&gt;PS: 10. 상품 서비스 호출
    PS-&gt;&gt;W: 11. 상품 정보 반환
    
    U-&gt;&gt;W: 12. 주문 생성
    W-&gt;&gt;AG: 13. 주문 API + JWT
    AG-&gt;&gt;AG: 14. 권한 확인
    AG-&gt;&gt;OS: 15. 주문 서비스 호출
    OS-&gt;&gt;W: 16. 주문 결과 반환
</pre><h4 id=토큰-기반-인증의-역할>토큰 기반 인증의 역할<a hidden class=anchor aria-hidden=true href=#토큰-기반-인증의-역할>#</a></h4><ol><li><strong>통합 인증</strong>: 웹, 모바일, API 클라이언트 모두 동일한 토큰 사용</li><li><strong>권한 관리</strong>: 사용자 역할에 따른 세분화된 접근 제어</li><li><strong>확장성</strong>: 마이크로서비스 아키텍처에서 무상태 인증</li><li><strong>보안</strong>: 민감한 결제 정보 접근 시 추가 토큰 검증</li></ol><h4 id=토큰-기반-인증-유무에-따른-차이점>토큰 기반 인증 유무에 따른 차이점<a hidden class=anchor aria-hidden=true href=#토큰-기반-인증-유무에-따른-차이점>#</a></h4><p><strong>토큰 기반 인증 적용 시</strong>:</p><ul><li>서버 메모리 사용량 90% 감소 (세션 저장 불필요)</li><li>API 응답 시간 평균 200ms → 50ms 단축</li><li>동시 접속자 처리 능력 300% 향상</li><li>마이크로서비스 간 통신 보안성 강화</li></ul><p><strong>전통적 세션 기반 인증 시</strong>:</p><ul><li>세션 서버 간 동기화 오버헤드 발생</li><li>로드 밸런싱 시 세션 스티키 필요</li><li>서버 재시작 시 모든 사용자 재로그인 필요</li><li>모바일 앱에서 쿠키 관리 복잡성</li></ul><h3 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h3><p>전자상거래 플랫폼의 토큰 기반 인증 시스템을 Python으로 구현한 예시입니다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1>  1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2>  2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3>  3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4>  4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5>  5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6>  6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7>  7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8>  8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9>  9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10> 10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11> 11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12> 12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13> 13</a>
</span><span class=lnt id=hl-16-14><a class=lnlinks href=#hl-16-14> 14</a>
</span><span class=lnt id=hl-16-15><a class=lnlinks href=#hl-16-15> 15</a>
</span><span class=lnt id=hl-16-16><a class=lnlinks href=#hl-16-16> 16</a>
</span><span class=lnt id=hl-16-17><a class=lnlinks href=#hl-16-17> 17</a>
</span><span class=lnt id=hl-16-18><a class=lnlinks href=#hl-16-18> 18</a>
</span><span class=lnt id=hl-16-19><a class=lnlinks href=#hl-16-19> 19</a>
</span><span class=lnt id=hl-16-20><a class=lnlinks href=#hl-16-20> 20</a>
</span><span class=lnt id=hl-16-21><a class=lnlinks href=#hl-16-21> 21</a>
</span><span class=lnt id=hl-16-22><a class=lnlinks href=#hl-16-22> 22</a>
</span><span class=lnt id=hl-16-23><a class=lnlinks href=#hl-16-23> 23</a>
</span><span class=lnt id=hl-16-24><a class=lnlinks href=#hl-16-24> 24</a>
</span><span class=lnt id=hl-16-25><a class=lnlinks href=#hl-16-25> 25</a>
</span><span class=lnt id=hl-16-26><a class=lnlinks href=#hl-16-26> 26</a>
</span><span class=lnt id=hl-16-27><a class=lnlinks href=#hl-16-27> 27</a>
</span><span class=lnt id=hl-16-28><a class=lnlinks href=#hl-16-28> 28</a>
</span><span class=lnt id=hl-16-29><a class=lnlinks href=#hl-16-29> 29</a>
</span><span class=lnt id=hl-16-30><a class=lnlinks href=#hl-16-30> 30</a>
</span><span class=lnt id=hl-16-31><a class=lnlinks href=#hl-16-31> 31</a>
</span><span class=lnt id=hl-16-32><a class=lnlinks href=#hl-16-32> 32</a>
</span><span class=lnt id=hl-16-33><a class=lnlinks href=#hl-16-33> 33</a>
</span><span class=lnt id=hl-16-34><a class=lnlinks href=#hl-16-34> 34</a>
</span><span class=lnt id=hl-16-35><a class=lnlinks href=#hl-16-35> 35</a>
</span><span class=lnt id=hl-16-36><a class=lnlinks href=#hl-16-36> 36</a>
</span><span class=lnt id=hl-16-37><a class=lnlinks href=#hl-16-37> 37</a>
</span><span class=lnt id=hl-16-38><a class=lnlinks href=#hl-16-38> 38</a>
</span><span class=lnt id=hl-16-39><a class=lnlinks href=#hl-16-39> 39</a>
</span><span class=lnt id=hl-16-40><a class=lnlinks href=#hl-16-40> 40</a>
</span><span class=lnt id=hl-16-41><a class=lnlinks href=#hl-16-41> 41</a>
</span><span class=lnt id=hl-16-42><a class=lnlinks href=#hl-16-42> 42</a>
</span><span class=lnt id=hl-16-43><a class=lnlinks href=#hl-16-43> 43</a>
</span><span class=lnt id=hl-16-44><a class=lnlinks href=#hl-16-44> 44</a>
</span><span class=lnt id=hl-16-45><a class=lnlinks href=#hl-16-45> 45</a>
</span><span class=lnt id=hl-16-46><a class=lnlinks href=#hl-16-46> 46</a>
</span><span class=lnt id=hl-16-47><a class=lnlinks href=#hl-16-47> 47</a>
</span><span class=lnt id=hl-16-48><a class=lnlinks href=#hl-16-48> 48</a>
</span><span class=lnt id=hl-16-49><a class=lnlinks href=#hl-16-49> 49</a>
</span><span class=lnt id=hl-16-50><a class=lnlinks href=#hl-16-50> 50</a>
</span><span class=lnt id=hl-16-51><a class=lnlinks href=#hl-16-51> 51</a>
</span><span class=lnt id=hl-16-52><a class=lnlinks href=#hl-16-52> 52</a>
</span><span class=lnt id=hl-16-53><a class=lnlinks href=#hl-16-53> 53</a>
</span><span class=lnt id=hl-16-54><a class=lnlinks href=#hl-16-54> 54</a>
</span><span class=lnt id=hl-16-55><a class=lnlinks href=#hl-16-55> 55</a>
</span><span class=lnt id=hl-16-56><a class=lnlinks href=#hl-16-56> 56</a>
</span><span class=lnt id=hl-16-57><a class=lnlinks href=#hl-16-57> 57</a>
</span><span class=lnt id=hl-16-58><a class=lnlinks href=#hl-16-58> 58</a>
</span><span class=lnt id=hl-16-59><a class=lnlinks href=#hl-16-59> 59</a>
</span><span class=lnt id=hl-16-60><a class=lnlinks href=#hl-16-60> 60</a>
</span><span class=lnt id=hl-16-61><a class=lnlinks href=#hl-16-61> 61</a>
</span><span class=lnt id=hl-16-62><a class=lnlinks href=#hl-16-62> 62</a>
</span><span class=lnt id=hl-16-63><a class=lnlinks href=#hl-16-63> 63</a>
</span><span class=lnt id=hl-16-64><a class=lnlinks href=#hl-16-64> 64</a>
</span><span class=lnt id=hl-16-65><a class=lnlinks href=#hl-16-65> 65</a>
</span><span class=lnt id=hl-16-66><a class=lnlinks href=#hl-16-66> 66</a>
</span><span class=lnt id=hl-16-67><a class=lnlinks href=#hl-16-67> 67</a>
</span><span class=lnt id=hl-16-68><a class=lnlinks href=#hl-16-68> 68</a>
</span><span class=lnt id=hl-16-69><a class=lnlinks href=#hl-16-69> 69</a>
</span><span class=lnt id=hl-16-70><a class=lnlinks href=#hl-16-70> 70</a>
</span><span class=lnt id=hl-16-71><a class=lnlinks href=#hl-16-71> 71</a>
</span><span class=lnt id=hl-16-72><a class=lnlinks href=#hl-16-72> 72</a>
</span><span class=lnt id=hl-16-73><a class=lnlinks href=#hl-16-73> 73</a>
</span><span class=lnt id=hl-16-74><a class=lnlinks href=#hl-16-74> 74</a>
</span><span class=lnt id=hl-16-75><a class=lnlinks href=#hl-16-75> 75</a>
</span><span class=lnt id=hl-16-76><a class=lnlinks href=#hl-16-76> 76</a>
</span><span class=lnt id=hl-16-77><a class=lnlinks href=#hl-16-77> 77</a>
</span><span class=lnt id=hl-16-78><a class=lnlinks href=#hl-16-78> 78</a>
</span><span class=lnt id=hl-16-79><a class=lnlinks href=#hl-16-79> 79</a>
</span><span class=lnt id=hl-16-80><a class=lnlinks href=#hl-16-80> 80</a>
</span><span class=lnt id=hl-16-81><a class=lnlinks href=#hl-16-81> 81</a>
</span><span class=lnt id=hl-16-82><a class=lnlinks href=#hl-16-82> 82</a>
</span><span class=lnt id=hl-16-83><a class=lnlinks href=#hl-16-83> 83</a>
</span><span class=lnt id=hl-16-84><a class=lnlinks href=#hl-16-84> 84</a>
</span><span class=lnt id=hl-16-85><a class=lnlinks href=#hl-16-85> 85</a>
</span><span class=lnt id=hl-16-86><a class=lnlinks href=#hl-16-86> 86</a>
</span><span class=lnt id=hl-16-87><a class=lnlinks href=#hl-16-87> 87</a>
</span><span class=lnt id=hl-16-88><a class=lnlinks href=#hl-16-88> 88</a>
</span><span class=lnt id=hl-16-89><a class=lnlinks href=#hl-16-89> 89</a>
</span><span class=lnt id=hl-16-90><a class=lnlinks href=#hl-16-90> 90</a>
</span><span class=lnt id=hl-16-91><a class=lnlinks href=#hl-16-91> 91</a>
</span><span class=lnt id=hl-16-92><a class=lnlinks href=#hl-16-92> 92</a>
</span><span class=lnt id=hl-16-93><a class=lnlinks href=#hl-16-93> 93</a>
</span><span class=lnt id=hl-16-94><a class=lnlinks href=#hl-16-94> 94</a>
</span><span class=lnt id=hl-16-95><a class=lnlinks href=#hl-16-95> 95</a>
</span><span class=lnt id=hl-16-96><a class=lnlinks href=#hl-16-96> 96</a>
</span><span class=lnt id=hl-16-97><a class=lnlinks href=#hl-16-97> 97</a>
</span><span class=lnt id=hl-16-98><a class=lnlinks href=#hl-16-98> 98</a>
</span><span class=lnt id=hl-16-99><a class=lnlinks href=#hl-16-99> 99</a>
</span><span class=lnt id=hl-16-100><a class=lnlinks href=#hl-16-100>100</a>
</span><span class=lnt id=hl-16-101><a class=lnlinks href=#hl-16-101>101</a>
</span><span class=lnt id=hl-16-102><a class=lnlinks href=#hl-16-102>102</a>
</span><span class=lnt id=hl-16-103><a class=lnlinks href=#hl-16-103>103</a>
</span><span class=lnt id=hl-16-104><a class=lnlinks href=#hl-16-104>104</a>
</span><span class=lnt id=hl-16-105><a class=lnlinks href=#hl-16-105>105</a>
</span><span class=lnt id=hl-16-106><a class=lnlinks href=#hl-16-106>106</a>
</span><span class=lnt id=hl-16-107><a class=lnlinks href=#hl-16-107>107</a>
</span><span class=lnt id=hl-16-108><a class=lnlinks href=#hl-16-108>108</a>
</span><span class=lnt id=hl-16-109><a class=lnlinks href=#hl-16-109>109</a>
</span><span class=lnt id=hl-16-110><a class=lnlinks href=#hl-16-110>110</a>
</span><span class=lnt id=hl-16-111><a class=lnlinks href=#hl-16-111>111</a>
</span><span class=lnt id=hl-16-112><a class=lnlinks href=#hl-16-112>112</a>
</span><span class=lnt id=hl-16-113><a class=lnlinks href=#hl-16-113>113</a>
</span><span class=lnt id=hl-16-114><a class=lnlinks href=#hl-16-114>114</a>
</span><span class=lnt id=hl-16-115><a class=lnlinks href=#hl-16-115>115</a>
</span><span class=lnt id=hl-16-116><a class=lnlinks href=#hl-16-116>116</a>
</span><span class=lnt id=hl-16-117><a class=lnlinks href=#hl-16-117>117</a>
</span><span class=lnt id=hl-16-118><a class=lnlinks href=#hl-16-118>118</a>
</span><span class=lnt id=hl-16-119><a class=lnlinks href=#hl-16-119>119</a>
</span><span class=lnt id=hl-16-120><a class=lnlinks href=#hl-16-120>120</a>
</span><span class=lnt id=hl-16-121><a class=lnlinks href=#hl-16-121>121</a>
</span><span class=lnt id=hl-16-122><a class=lnlinks href=#hl-16-122>122</a>
</span><span class=lnt id=hl-16-123><a class=lnlinks href=#hl-16-123>123</a>
</span><span class=lnt id=hl-16-124><a class=lnlinks href=#hl-16-124>124</a>
</span><span class=lnt id=hl-16-125><a class=lnlinks href=#hl-16-125>125</a>
</span><span class=lnt id=hl-16-126><a class=lnlinks href=#hl-16-126>126</a>
</span><span class=lnt id=hl-16-127><a class=lnlinks href=#hl-16-127>127</a>
</span><span class=lnt id=hl-16-128><a class=lnlinks href=#hl-16-128>128</a>
</span><span class=lnt id=hl-16-129><a class=lnlinks href=#hl-16-129>129</a>
</span><span class=lnt id=hl-16-130><a class=lnlinks href=#hl-16-130>130</a>
</span><span class=lnt id=hl-16-131><a class=lnlinks href=#hl-16-131>131</a>
</span><span class=lnt id=hl-16-132><a class=lnlinks href=#hl-16-132>132</a>
</span><span class=lnt id=hl-16-133><a class=lnlinks href=#hl-16-133>133</a>
</span><span class=lnt id=hl-16-134><a class=lnlinks href=#hl-16-134>134</a>
</span><span class=lnt id=hl-16-135><a class=lnlinks href=#hl-16-135>135</a>
</span><span class=lnt id=hl-16-136><a class=lnlinks href=#hl-16-136>136</a>
</span><span class=lnt id=hl-16-137><a class=lnlinks href=#hl-16-137>137</a>
</span><span class=lnt id=hl-16-138><a class=lnlinks href=#hl-16-138>138</a>
</span><span class=lnt id=hl-16-139><a class=lnlinks href=#hl-16-139>139</a>
</span><span class=lnt id=hl-16-140><a class=lnlinks href=#hl-16-140>140</a>
</span><span class=lnt id=hl-16-141><a class=lnlinks href=#hl-16-141>141</a>
</span><span class=lnt id=hl-16-142><a class=lnlinks href=#hl-16-142>142</a>
</span><span class=lnt id=hl-16-143><a class=lnlinks href=#hl-16-143>143</a>
</span><span class=lnt id=hl-16-144><a class=lnlinks href=#hl-16-144>144</a>
</span><span class=lnt id=hl-16-145><a class=lnlinks href=#hl-16-145>145</a>
</span><span class=lnt id=hl-16-146><a class=lnlinks href=#hl-16-146>146</a>
</span><span class=lnt id=hl-16-147><a class=lnlinks href=#hl-16-147>147</a>
</span><span class=lnt id=hl-16-148><a class=lnlinks href=#hl-16-148>148</a>
</span><span class=lnt id=hl-16-149><a class=lnlinks href=#hl-16-149>149</a>
</span><span class=lnt id=hl-16-150><a class=lnlinks href=#hl-16-150>150</a>
</span><span class=lnt id=hl-16-151><a class=lnlinks href=#hl-16-151>151</a>
</span><span class=lnt id=hl-16-152><a class=lnlinks href=#hl-16-152>152</a>
</span><span class=lnt id=hl-16-153><a class=lnlinks href=#hl-16-153>153</a>
</span><span class=lnt id=hl-16-154><a class=lnlinks href=#hl-16-154>154</a>
</span><span class=lnt id=hl-16-155><a class=lnlinks href=#hl-16-155>155</a>
</span><span class=lnt id=hl-16-156><a class=lnlinks href=#hl-16-156>156</a>
</span><span class=lnt id=hl-16-157><a class=lnlinks href=#hl-16-157>157</a>
</span><span class=lnt id=hl-16-158><a class=lnlinks href=#hl-16-158>158</a>
</span><span class=lnt id=hl-16-159><a class=lnlinks href=#hl-16-159>159</a>
</span><span class=lnt id=hl-16-160><a class=lnlinks href=#hl-16-160>160</a>
</span><span class=lnt id=hl-16-161><a class=lnlinks href=#hl-16-161>161</a>
</span><span class=lnt id=hl-16-162><a class=lnlinks href=#hl-16-162>162</a>
</span><span class=lnt id=hl-16-163><a class=lnlinks href=#hl-16-163>163</a>
</span><span class=lnt id=hl-16-164><a class=lnlinks href=#hl-16-164>164</a>
</span><span class=lnt id=hl-16-165><a class=lnlinks href=#hl-16-165>165</a>
</span><span class=lnt id=hl-16-166><a class=lnlinks href=#hl-16-166>166</a>
</span><span class=lnt id=hl-16-167><a class=lnlinks href=#hl-16-167>167</a>
</span><span class=lnt id=hl-16-168><a class=lnlinks href=#hl-16-168>168</a>
</span><span class=lnt id=hl-16-169><a class=lnlinks href=#hl-16-169>169</a>
</span><span class=lnt id=hl-16-170><a class=lnlinks href=#hl-16-170>170</a>
</span><span class=lnt id=hl-16-171><a class=lnlinks href=#hl-16-171>171</a>
</span><span class=lnt id=hl-16-172><a class=lnlinks href=#hl-16-172>172</a>
</span><span class=lnt id=hl-16-173><a class=lnlinks href=#hl-16-173>173</a>
</span><span class=lnt id=hl-16-174><a class=lnlinks href=#hl-16-174>174</a>
</span><span class=lnt id=hl-16-175><a class=lnlinks href=#hl-16-175>175</a>
</span><span class=lnt id=hl-16-176><a class=lnlinks href=#hl-16-176>176</a>
</span><span class=lnt id=hl-16-177><a class=lnlinks href=#hl-16-177>177</a>
</span><span class=lnt id=hl-16-178><a class=lnlinks href=#hl-16-178>178</a>
</span><span class=lnt id=hl-16-179><a class=lnlinks href=#hl-16-179>179</a>
</span><span class=lnt id=hl-16-180><a class=lnlinks href=#hl-16-180>180</a>
</span><span class=lnt id=hl-16-181><a class=lnlinks href=#hl-16-181>181</a>
</span><span class=lnt id=hl-16-182><a class=lnlinks href=#hl-16-182>182</a>
</span><span class=lnt id=hl-16-183><a class=lnlinks href=#hl-16-183>183</a>
</span><span class=lnt id=hl-16-184><a class=lnlinks href=#hl-16-184>184</a>
</span><span class=lnt id=hl-16-185><a class=lnlinks href=#hl-16-185>185</a>
</span><span class=lnt id=hl-16-186><a class=lnlinks href=#hl-16-186>186</a>
</span><span class=lnt id=hl-16-187><a class=lnlinks href=#hl-16-187>187</a>
</span><span class=lnt id=hl-16-188><a class=lnlinks href=#hl-16-188>188</a>
</span><span class=lnt id=hl-16-189><a class=lnlinks href=#hl-16-189>189</a>
</span><span class=lnt id=hl-16-190><a class=lnlinks href=#hl-16-190>190</a>
</span><span class=lnt id=hl-16-191><a class=lnlinks href=#hl-16-191>191</a>
</span><span class=lnt id=hl-16-192><a class=lnlinks href=#hl-16-192>192</a>
</span><span class=lnt id=hl-16-193><a class=lnlinks href=#hl-16-193>193</a>
</span><span class=lnt id=hl-16-194><a class=lnlinks href=#hl-16-194>194</a>
</span><span class=lnt id=hl-16-195><a class=lnlinks href=#hl-16-195>195</a>
</span><span class=lnt id=hl-16-196><a class=lnlinks href=#hl-16-196>196</a>
</span><span class=lnt id=hl-16-197><a class=lnlinks href=#hl-16-197>197</a>
</span><span class=lnt id=hl-16-198><a class=lnlinks href=#hl-16-198>198</a>
</span><span class=lnt id=hl-16-199><a class=lnlinks href=#hl-16-199>199</a>
</span><span class=lnt id=hl-16-200><a class=lnlinks href=#hl-16-200>200</a>
</span><span class=lnt id=hl-16-201><a class=lnlinks href=#hl-16-201>201</a>
</span><span class=lnt id=hl-16-202><a class=lnlinks href=#hl-16-202>202</a>
</span><span class=lnt id=hl-16-203><a class=lnlinks href=#hl-16-203>203</a>
</span><span class=lnt id=hl-16-204><a class=lnlinks href=#hl-16-204>204</a>
</span><span class=lnt id=hl-16-205><a class=lnlinks href=#hl-16-205>205</a>
</span><span class=lnt id=hl-16-206><a class=lnlinks href=#hl-16-206>206</a>
</span><span class=lnt id=hl-16-207><a class=lnlinks href=#hl-16-207>207</a>
</span><span class=lnt id=hl-16-208><a class=lnlinks href=#hl-16-208>208</a>
</span><span class=lnt id=hl-16-209><a class=lnlinks href=#hl-16-209>209</a>
</span><span class=lnt id=hl-16-210><a class=lnlinks href=#hl-16-210>210</a>
</span><span class=lnt id=hl-16-211><a class=lnlinks href=#hl-16-211>211</a>
</span><span class=lnt id=hl-16-212><a class=lnlinks href=#hl-16-212>212</a>
</span><span class=lnt id=hl-16-213><a class=lnlinks href=#hl-16-213>213</a>
</span><span class=lnt id=hl-16-214><a class=lnlinks href=#hl-16-214>214</a>
</span><span class=lnt id=hl-16-215><a class=lnlinks href=#hl-16-215>215</a>
</span><span class=lnt id=hl-16-216><a class=lnlinks href=#hl-16-216>216</a>
</span><span class=lnt id=hl-16-217><a class=lnlinks href=#hl-16-217>217</a>
</span><span class=lnt id=hl-16-218><a class=lnlinks href=#hl-16-218>218</a>
</span><span class=lnt id=hl-16-219><a class=lnlinks href=#hl-16-219>219</a>
</span><span class=lnt id=hl-16-220><a class=lnlinks href=#hl-16-220>220</a>
</span><span class=lnt id=hl-16-221><a class=lnlinks href=#hl-16-221>221</a>
</span><span class=lnt id=hl-16-222><a class=lnlinks href=#hl-16-222>222</a>
</span><span class=lnt id=hl-16-223><a class=lnlinks href=#hl-16-223>223</a>
</span><span class=lnt id=hl-16-224><a class=lnlinks href=#hl-16-224>224</a>
</span><span class=lnt id=hl-16-225><a class=lnlinks href=#hl-16-225>225</a>
</span><span class=lnt id=hl-16-226><a class=lnlinks href=#hl-16-226>226</a>
</span><span class=lnt id=hl-16-227><a class=lnlinks href=#hl-16-227>227</a>
</span><span class=lnt id=hl-16-228><a class=lnlinks href=#hl-16-228>228</a>
</span><span class=lnt id=hl-16-229><a class=lnlinks href=#hl-16-229>229</a>
</span><span class=lnt id=hl-16-230><a class=lnlinks href=#hl-16-230>230</a>
</span><span class=lnt id=hl-16-231><a class=lnlinks href=#hl-16-231>231</a>
</span><span class=lnt id=hl-16-232><a class=lnlinks href=#hl-16-232>232</a>
</span><span class=lnt id=hl-16-233><a class=lnlinks href=#hl-16-233>233</a>
</span><span class=lnt id=hl-16-234><a class=lnlinks href=#hl-16-234>234</a>
</span><span class=lnt id=hl-16-235><a class=lnlinks href=#hl-16-235>235</a>
</span><span class=lnt id=hl-16-236><a class=lnlinks href=#hl-16-236>236</a>
</span><span class=lnt id=hl-16-237><a class=lnlinks href=#hl-16-237>237</a>
</span><span class=lnt id=hl-16-238><a class=lnlinks href=#hl-16-238>238</a>
</span><span class=lnt id=hl-16-239><a class=lnlinks href=#hl-16-239>239</a>
</span><span class=lnt id=hl-16-240><a class=lnlinks href=#hl-16-240>240</a>
</span><span class=lnt id=hl-16-241><a class=lnlinks href=#hl-16-241>241</a>
</span><span class=lnt id=hl-16-242><a class=lnlinks href=#hl-16-242>242</a>
</span><span class=lnt id=hl-16-243><a class=lnlinks href=#hl-16-243>243</a>
</span><span class=lnt id=hl-16-244><a class=lnlinks href=#hl-16-244>244</a>
</span><span class=lnt id=hl-16-245><a class=lnlinks href=#hl-16-245>245</a>
</span><span class=lnt id=hl-16-246><a class=lnlinks href=#hl-16-246>246</a>
</span><span class=lnt id=hl-16-247><a class=lnlinks href=#hl-16-247>247</a>
</span><span class=lnt id=hl-16-248><a class=lnlinks href=#hl-16-248>248</a>
</span><span class=lnt id=hl-16-249><a class=lnlinks href=#hl-16-249>249</a>
</span><span class=lnt id=hl-16-250><a class=lnlinks href=#hl-16-250>250</a>
</span><span class=lnt id=hl-16-251><a class=lnlinks href=#hl-16-251>251</a>
</span><span class=lnt id=hl-16-252><a class=lnlinks href=#hl-16-252>252</a>
</span><span class=lnt id=hl-16-253><a class=lnlinks href=#hl-16-253>253</a>
</span><span class=lnt id=hl-16-254><a class=lnlinks href=#hl-16-254>254</a>
</span><span class=lnt id=hl-16-255><a class=lnlinks href=#hl-16-255>255</a>
</span><span class=lnt id=hl-16-256><a class=lnlinks href=#hl-16-256>256</a>
</span><span class=lnt id=hl-16-257><a class=lnlinks href=#hl-16-257>257</a>
</span><span class=lnt id=hl-16-258><a class=lnlinks href=#hl-16-258>258</a>
</span><span class=lnt id=hl-16-259><a class=lnlinks href=#hl-16-259>259</a>
</span><span class=lnt id=hl-16-260><a class=lnlinks href=#hl-16-260>260</a>
</span><span class=lnt id=hl-16-261><a class=lnlinks href=#hl-16-261>261</a>
</span><span class=lnt id=hl-16-262><a class=lnlinks href=#hl-16-262>262</a>
</span><span class=lnt id=hl-16-263><a class=lnlinks href=#hl-16-263>263</a>
</span><span class=lnt id=hl-16-264><a class=lnlinks href=#hl-16-264>264</a>
</span><span class=lnt id=hl-16-265><a class=lnlinks href=#hl-16-265>265</a>
</span><span class=lnt id=hl-16-266><a class=lnlinks href=#hl-16-266>266</a>
</span><span class=lnt id=hl-16-267><a class=lnlinks href=#hl-16-267>267</a>
</span><span class=lnt id=hl-16-268><a class=lnlinks href=#hl-16-268>268</a>
</span><span class=lnt id=hl-16-269><a class=lnlinks href=#hl-16-269>269</a>
</span><span class=lnt id=hl-16-270><a class=lnlinks href=#hl-16-270>270</a>
</span><span class=lnt id=hl-16-271><a class=lnlinks href=#hl-16-271>271</a>
</span><span class=lnt id=hl-16-272><a class=lnlinks href=#hl-16-272>272</a>
</span><span class=lnt id=hl-16-273><a class=lnlinks href=#hl-16-273>273</a>
</span><span class=lnt id=hl-16-274><a class=lnlinks href=#hl-16-274>274</a>
</span><span class=lnt id=hl-16-275><a class=lnlinks href=#hl-16-275>275</a>
</span><span class=lnt id=hl-16-276><a class=lnlinks href=#hl-16-276>276</a>
</span><span class=lnt id=hl-16-277><a class=lnlinks href=#hl-16-277>277</a>
</span><span class=lnt id=hl-16-278><a class=lnlinks href=#hl-16-278>278</a>
</span><span class=lnt id=hl-16-279><a class=lnlinks href=#hl-16-279>279</a>
</span><span class=lnt id=hl-16-280><a class=lnlinks href=#hl-16-280>280</a>
</span><span class=lnt id=hl-16-281><a class=lnlinks href=#hl-16-281>281</a>
</span><span class=lnt id=hl-16-282><a class=lnlinks href=#hl-16-282>282</a>
</span><span class=lnt id=hl-16-283><a class=lnlinks href=#hl-16-283>283</a>
</span><span class=lnt id=hl-16-284><a class=lnlinks href=#hl-16-284>284</a>
</span><span class=lnt id=hl-16-285><a class=lnlinks href=#hl-16-285>285</a>
</span><span class=lnt id=hl-16-286><a class=lnlinks href=#hl-16-286>286</a>
</span><span class=lnt id=hl-16-287><a class=lnlinks href=#hl-16-287>287</a>
</span><span class=lnt id=hl-16-288><a class=lnlinks href=#hl-16-288>288</a>
</span><span class=lnt id=hl-16-289><a class=lnlinks href=#hl-16-289>289</a>
</span><span class=lnt id=hl-16-290><a class=lnlinks href=#hl-16-290>290</a>
</span><span class=lnt id=hl-16-291><a class=lnlinks href=#hl-16-291>291</a>
</span><span class=lnt id=hl-16-292><a class=lnlinks href=#hl-16-292>292</a>
</span><span class=lnt id=hl-16-293><a class=lnlinks href=#hl-16-293>293</a>
</span><span class=lnt id=hl-16-294><a class=lnlinks href=#hl-16-294>294</a>
</span><span class=lnt id=hl-16-295><a class=lnlinks href=#hl-16-295>295</a>
</span><span class=lnt id=hl-16-296><a class=lnlinks href=#hl-16-296>296</a>
</span><span class=lnt id=hl-16-297><a class=lnlinks href=#hl-16-297>297</a>
</span><span class=lnt id=hl-16-298><a class=lnlinks href=#hl-16-298>298</a>
</span><span class=lnt id=hl-16-299><a class=lnlinks href=#hl-16-299>299</a>
</span><span class=lnt id=hl-16-300><a class=lnlinks href=#hl-16-300>300</a>
</span><span class=lnt id=hl-16-301><a class=lnlinks href=#hl-16-301>301</a>
</span><span class=lnt id=hl-16-302><a class=lnlinks href=#hl-16-302>302</a>
</span><span class=lnt id=hl-16-303><a class=lnlinks href=#hl-16-303>303</a>
</span><span class=lnt id=hl-16-304><a class=lnlinks href=#hl-16-304>304</a>
</span><span class=lnt id=hl-16-305><a class=lnlinks href=#hl-16-305>305</a>
</span><span class=lnt id=hl-16-306><a class=lnlinks href=#hl-16-306>306</a>
</span><span class=lnt id=hl-16-307><a class=lnlinks href=#hl-16-307>307</a>
</span><span class=lnt id=hl-16-308><a class=lnlinks href=#hl-16-308>308</a>
</span><span class=lnt id=hl-16-309><a class=lnlinks href=#hl-16-309>309</a>
</span><span class=lnt id=hl-16-310><a class=lnlinks href=#hl-16-310>310</a>
</span><span class=lnt id=hl-16-311><a class=lnlinks href=#hl-16-311>311</a>
</span><span class=lnt id=hl-16-312><a class=lnlinks href=#hl-16-312>312</a>
</span><span class=lnt id=hl-16-313><a class=lnlinks href=#hl-16-313>313</a>
</span><span class=lnt id=hl-16-314><a class=lnlinks href=#hl-16-314>314</a>
</span><span class=lnt id=hl-16-315><a class=lnlinks href=#hl-16-315>315</a>
</span><span class=lnt id=hl-16-316><a class=lnlinks href=#hl-16-316>316</a>
</span><span class=lnt id=hl-16-317><a class=lnlinks href=#hl-16-317>317</a>
</span><span class=lnt id=hl-16-318><a class=lnlinks href=#hl-16-318>318</a>
</span><span class=lnt id=hl-16-319><a class=lnlinks href=#hl-16-319>319</a>
</span><span class=lnt id=hl-16-320><a class=lnlinks href=#hl-16-320>320</a>
</span><span class=lnt id=hl-16-321><a class=lnlinks href=#hl-16-321>321</a>
</span><span class=lnt id=hl-16-322><a class=lnlinks href=#hl-16-322>322</a>
</span><span class=lnt id=hl-16-323><a class=lnlinks href=#hl-16-323>323</a>
</span><span class=lnt id=hl-16-324><a class=lnlinks href=#hl-16-324>324</a>
</span><span class=lnt id=hl-16-325><a class=lnlinks href=#hl-16-325>325</a>
</span><span class=lnt id=hl-16-326><a class=lnlinks href=#hl-16-326>326</a>
</span><span class=lnt id=hl-16-327><a class=lnlinks href=#hl-16-327>327</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span><span class=p>,</span> <span class=n>g</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>jwt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>redis</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span><span class=p>,</span> <span class=n>timedelta</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>functools</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 설정</span>
</span></span><span class=line><span class=cl><span class=n>JWT_SECRET</span> <span class=o>=</span> <span class=s1>&#39;your-secret-key-here&#39;</span>
</span></span><span class=line><span class=cl><span class=n>JWT_ALGORITHM</span> <span class=o>=</span> <span class=s1>&#39;HS256&#39;</span>
</span></span><span class=line><span class=cl><span class=n>REDIS_HOST</span> <span class=o>=</span> <span class=s1>&#39;localhost&#39;</span>
</span></span><span class=line><span class=cl><span class=n>REDIS_PORT</span> <span class=o>=</span> <span class=mi>6379</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Redis 클라이언트 (토큰 캐시 및 블랙리스트)</span>
</span></span><span class=line><span class=cl><span class=n>redis_client</span> <span class=o>=</span> <span class=n>redis</span><span class=o>.</span><span class=n>Redis</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=n>REDIS_HOST</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=n>REDIS_PORT</span><span class=p>,</span> <span class=n>decode_responses</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TokenManager</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;토큰 관리 클래스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>generate_tokens</span><span class=p>(</span><span class=n>user_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;Access Token과 Refresh Token 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># Access Token 생성 (1시간 유효)</span>
</span></span><span class=line><span class=cl>        <span class=n>access_payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_data</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=n>user_data</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;role&#39;</span><span class=p>:</span> <span class=n>user_data</span><span class=p>[</span><span class=s1>&#39;role&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;permissions&#39;</span><span class=p>:</span> <span class=n>user_data</span><span class=p>[</span><span class=s1>&#39;permissions&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;access&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;iat&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;exp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>+</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>hours</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>access_token</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>access_payload</span><span class=p>,</span> <span class=n>JWT_SECRET</span><span class=p>,</span> <span class=n>algorithm</span><span class=o>=</span><span class=n>JWT_ALGORITHM</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Refresh Token 생성 (7일 유효)</span>
</span></span><span class=line><span class=cl>        <span class=n>refresh_payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_data</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;type&#39;</span><span class=p>:</span> <span class=s1>&#39;refresh&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;iat&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;exp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>+</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=mi>7</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>refresh_token</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>refresh_payload</span><span class=p>,</span> <span class=n>JWT_SECRET</span><span class=p>,</span> <span class=n>algorithm</span><span class=o>=</span><span class=n>JWT_ALGORITHM</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Redis에 토큰 정보 저장 (캐싱 및 관리용)</span>
</span></span><span class=line><span class=cl>        <span class=n>token_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;user_tokens:</span><span class=si>{</span><span class=n>user_data</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>redis_client</span><span class=o>.</span><span class=n>hset</span><span class=p>(</span><span class=n>token_key</span><span class=p>,</span> <span class=n>mapping</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;access_token&#39;</span><span class=p>:</span> <span class=n>access_token</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;refresh_token&#39;</span><span class=p>:</span> <span class=n>refresh_token</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;created_at&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=n>redis_client</span><span class=o>.</span><span class=n>expire</span><span class=p>(</span><span class=n>token_key</span><span class=p>,</span> <span class=mi>604800</span><span class=p>)</span>  <span class=c1># 7일 후 만료</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;access_token&#39;</span><span class=p>:</span> <span class=n>access_token</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;refresh_token&#39;</span><span class=p>:</span> <span class=n>refresh_token</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;token_type&#39;</span><span class=p>:</span> <span class=s1>&#39;Bearer&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;expires_in&#39;</span><span class=p>:</span> <span class=mi>3600</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>verify_token</span><span class=p>(</span><span class=n>token</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;토큰 검증&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 블랙리스트 확인</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>redis_client</span><span class=o>.</span><span class=n>sismember</span><span class=p>(</span><span class=s1>&#39;blacklisted_tokens&#39;</span><span class=p>,</span> <span class=n>token</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># JWT 토큰 디코딩</span>
</span></span><span class=line><span class=cl>            <span class=n>payload</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>JWT_SECRET</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=n>JWT_ALGORITHM</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 토큰 타입 확인</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>payload</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;type&#39;</span><span class=p>)</span> <span class=o>!=</span> <span class=s1>&#39;access&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>payload</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>ExpiredSignatureError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>InvalidTokenError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>revoke_token</span><span class=p>(</span><span class=n>token</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;토큰 폐기 (블랙리스트에 추가)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>payload</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>JWT_SECRET</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=n>JWT_ALGORITHM</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>exp_timestamp</span> <span class=o>=</span> <span class=n>payload</span><span class=p>[</span><span class=s1>&#39;exp&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 만료 시간까지만 블랙리스트에 유지</span>
</span></span><span class=line><span class=cl>            <span class=n>ttl</span> <span class=o>=</span> <span class=n>exp_timestamp</span> <span class=o>-</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span><span class=o>.</span><span class=n>timestamp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>ttl</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>redis_client</span><span class=o>.</span><span class=n>sadd</span><span class=p>(</span><span class=s1>&#39;blacklisted_tokens&#39;</span><span class=p>,</span> <span class=n>token</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>redis_client</span><span class=o>.</span><span class=n>expire</span><span class=p>(</span><span class=s1>&#39;blacklisted_tokens&#39;</span><span class=p>,</span> <span class=nb>int</span><span class=p>(</span><span class=n>ttl</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>InvalidTokenError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>require_auth</span><span class=p>(</span><span class=n>required_permissions</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;인증 데코레이터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>decorator</span><span class=p>(</span><span class=n>f</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nd>@functools.wraps</span><span class=p>(</span><span class=n>f</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>def</span> <span class=nf>decorated_function</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>auth_header</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;Authorization&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>auth_header</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>auth_header</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;Bearer &#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Missing or invalid authorization header&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>token</span> <span class=o>=</span> <span class=n>auth_header</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>payload</span> <span class=o>=</span> <span class=n>TokenManager</span><span class=o>.</span><span class=n>verify_token</span><span class=p>(</span><span class=n>token</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=ow>not</span> <span class=n>payload</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Invalid or expired token&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 권한 확인</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>required_permissions</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>user_permissions</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;permissions&#39;</span><span class=p>,</span> <span class=p>[])</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=ow>not</span> <span class=nb>any</span><span class=p>(</span><span class=n>perm</span> <span class=ow>in</span> <span class=n>user_permissions</span> <span class=k>for</span> <span class=n>perm</span> <span class=ow>in</span> <span class=n>required_permissions</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Insufficient permissions&#39;</span><span class=p>}),</span> <span class=mi>403</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 사용자 정보를 g 객체에 저장</span>
</span></span><span class=line><span class=cl>            <span class=n>g</span><span class=o>.</span><span class=n>current_user</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=n>payload</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=n>payload</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;role&#39;</span><span class=p>:</span> <span class=n>payload</span><span class=p>[</span><span class=s1>&#39;role&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;permissions&#39;</span><span class=p>:</span> <span class=n>payload</span><span class=p>[</span><span class=s1>&#39;permissions&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>f</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>decorated_function</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>decorator</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/auth/login&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;로그인 API&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>username</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;username&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;password&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 실제로는 데이터베이스에서 사용자 정보 조회</span>
</span></span><span class=line><span class=cl>    <span class=n>user</span> <span class=o>=</span> <span class=n>authenticate_user</span><span class=p>(</span><span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>user</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Invalid credentials&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>tokens</span> <span class=o>=</span> <span class=n>TokenManager</span><span class=o>.</span><span class=n>generate_tokens</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 로그인 로그 기록</span>
</span></span><span class=line><span class=cl>    <span class=n>log_authentication_event</span><span class=p>(</span><span class=n>user</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>],</span> <span class=s1>&#39;login_success&#39;</span><span class=p>,</span> <span class=n>request</span><span class=o>.</span><span class=n>remote_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>tokens</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/auth/refresh&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>refresh_token</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;토큰 갱신 API&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>refresh_token</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;refresh_token&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>refresh_token</span><span class=p>,</span> <span class=n>JWT_SECRET</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=n>JWT_ALGORITHM</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>payload</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;type&#39;</span><span class=p>)</span> <span class=o>!=</span> <span class=s1>&#39;refresh&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Invalid token type&#39;</span><span class=p>}),</span> <span class=mi>400</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 사용자 정보 조회</span>
</span></span><span class=line><span class=cl>        <span class=n>user</span> <span class=o>=</span> <span class=n>get_user_by_id</span><span class=p>(</span><span class=n>payload</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>user</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;User not found&#39;</span><span class=p>}),</span> <span class=mi>404</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 새로운 토큰 발급</span>
</span></span><span class=line><span class=cl>        <span class=n>new_tokens</span> <span class=o>=</span> <span class=n>TokenManager</span><span class=o>.</span><span class=n>generate_tokens</span><span class=p>(</span><span class=n>user</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>new_tokens</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>ExpiredSignatureError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Refresh token expired&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>jwt</span><span class=o>.</span><span class=n>InvalidTokenError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Invalid refresh token&#39;</span><span class=p>}),</span> <span class=mi>401</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/auth/logout&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nd>@require_auth</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>logout</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;로그아웃 API&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>auth_header</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>headers</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;Authorization&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>token</span> <span class=o>=</span> <span class=n>auth_header</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 토큰 폐기</span>
</span></span><span class=line><span class=cl>    <span class=n>TokenManager</span><span class=o>.</span><span class=n>revoke_token</span><span class=p>(</span><span class=n>token</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 사용자별 모든 토큰 삭제</span>
</span></span><span class=line><span class=cl>    <span class=n>user_tokens_key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;user_tokens:</span><span class=si>{</span><span class=n>g</span><span class=o>.</span><span class=n>current_user</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>redis_client</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>user_tokens_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 로그아웃 로그 기록</span>
</span></span><span class=line><span class=cl>    <span class=n>log_authentication_event</span><span class=p>(</span><span class=n>g</span><span class=o>.</span><span class=n>current_user</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>],</span> <span class=s1>&#39;logout&#39;</span><span class=p>,</span> <span class=n>request</span><span class=o>.</span><span class=n>remote_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=s1>&#39;Successfully logged out&#39;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/products&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nd>@require_auth</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_products</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;상품 조회 API - 기본 인증만 필요&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 상품 조회 로직</span>
</span></span><span class=line><span class=cl>    <span class=n>products</span> <span class=o>=</span> <span class=n>fetch_products_from_database</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;products&#39;</span><span class=p>:</span> <span class=n>products</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;user&#39;</span><span class=p>:</span> <span class=n>g</span><span class=o>.</span><span class=n>current_user</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/orders&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nd>@require_auth</span><span class=p>(</span><span class=n>required_permissions</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;create_order&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_order</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;주문 생성 API - 주문 생성 권한 필요&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>get_json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 주문 생성 로직</span>
</span></span><span class=line><span class=cl>    <span class=n>order</span> <span class=o>=</span> <span class=n>create_order_in_database</span><span class=p>(</span><span class=n>g</span><span class=o>.</span><span class=n>current_user</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>],</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 주문 생성 로그 기록</span>
</span></span><span class=line><span class=cl>    <span class=n>log_business_event</span><span class=p>(</span><span class=n>g</span><span class=o>.</span><span class=n>current_user</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>],</span> <span class=s1>&#39;order_created&#39;</span><span class=p>,</span> <span class=n>order</span><span class=p>[</span><span class=s1>&#39;id&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>order</span><span class=p>),</span> <span class=mi>201</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/api/admin/users&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;GET&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nd>@require_auth</span><span class=p>(</span><span class=n>required_permissions</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;admin_access&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_all_users</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;관리자 전용 API - 관리자 권한 필요&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>g</span><span class=o>.</span><span class=n>current_user</span><span class=p>[</span><span class=s1>&#39;role&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=s1>&#39;admin&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;error&#39;</span><span class=p>:</span> <span class=s1>&#39;Admin access required&#39;</span><span class=p>}),</span> <span class=mi>403</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>users</span> <span class=o>=</span> <span class=n>fetch_all_users_from_database</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;users&#39;</span><span class=p>:</span> <span class=n>users</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 보조 함수들</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>authenticate_user</span><span class=p>(</span><span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;사용자 인증 함수 (실제로는 데이터베이스 조회)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 비밀번호 해시 검증 로직</span>
</span></span><span class=line><span class=cl>    <span class=n>password_hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=n>password</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 모의 사용자 데이터</span>
</span></span><span class=line><span class=cl>    <span class=n>users_db</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;customer1&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=s1>&#39;customer1&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;password_hash&#39;</span><span class=p>:</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=s1>&#39;password123&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;role&#39;</span><span class=p>:</span> <span class=s1>&#39;customer&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;permissions&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;view_products&#39;</span><span class=p>,</span> <span class=s1>&#39;create_order&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;admin1&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=s1>&#39;admin1&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;password_hash&#39;</span><span class=p>:</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=s1>&#39;admin123&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;role&#39;</span><span class=p>:</span> <span class=s1>&#39;admin&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;permissions&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;view_products&#39;</span><span class=p>,</span> <span class=s1>&#39;create_order&#39;</span><span class=p>,</span> <span class=s1>&#39;admin_access&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>user</span> <span class=o>=</span> <span class=n>users_db</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>username</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>user</span> <span class=ow>and</span> <span class=n>user</span><span class=p>[</span><span class=s1>&#39;password_hash&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>password_hash</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>user</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_user_by_id</span><span class=p>(</span><span class=n>user_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;사용자 ID로 사용자 정보 조회&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># 실제로는 데이터베이스 조회</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s1>&#39;user_</span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;role&#39;</span><span class=p>:</span> <span class=s1>&#39;customer&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;permissions&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;view_products&#39;</span><span class=p>,</span> <span class=s1>&#39;create_order&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fetch_products_from_database</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;상품 목록 조회 (모의 데이터)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Product 1&#39;</span><span class=p>,</span> <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=mi>100</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Product 2&#39;</span><span class=p>,</span> <span class=s1>&#39;price&#39;</span><span class=p>:</span> <span class=mi>200</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_order_in_database</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=n>order_data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;주문 생성 (모의 로직)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>12345</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;items&#39;</span><span class=p>:</span> <span class=n>order_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;items&#39;</span><span class=p>,</span> <span class=p>[]),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;total&#39;</span><span class=p>:</span> <span class=n>order_data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;total&#39;</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;pending&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fetch_all_users_from_database</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;모든 사용자 조회 (관리자 전용)&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=s1>&#39;customer1&#39;</span><span class=p>,</span> <span class=s1>&#39;role&#39;</span><span class=p>:</span> <span class=s1>&#39;customer&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span><span class=s1>&#39;id&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>&#39;username&#39;</span><span class=p>:</span> <span class=s1>&#39;admin1&#39;</span><span class=p>,</span> <span class=s1>&#39;role&#39;</span><span class=p>:</span> <span class=s1>&#39;admin&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>log_authentication_event</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=n>event_type</span><span class=p>,</span> <span class=n>ip_address</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;인증 이벤트 로깅&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>log_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;event_type&#39;</span><span class=p>:</span> <span class=n>event_type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;ip_address&#39;</span><span class=p>:</span> <span class=n>ip_address</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 실제로는 로깅 시스템에 전송</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Auth Log: </span><span class=si>{</span><span class=n>log_data</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>log_business_event</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=n>event_type</span><span class=p>,</span> <span class=n>resource_id</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;비즈니스 이벤트 로깅&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>log_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;event_type&#39;</span><span class=p>:</span> <span class=n>event_type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;resource_id&#39;</span><span class=p>:</span> <span class=n>resource_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 실제로는 로깅 시스템에 전송</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Business Log: </span><span class=si>{</span><span class=n>log_data</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>debug</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>구분</th><th>고려사항</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>보안</td><td>토큰 저장 위치</td><td>클라이언트에서 토큰을 안전하게 저장해야 함</td><td>HTTPOnly 쿠키 또는 암호화된 로컬 스토리지 사용</td></tr><tr><td>보안</td><td>토큰 만료 시간 설정</td><td>보안성과 사용성의 균형점 찾기</td><td>Access Token 15-60분, Refresh Token 7-30일</td></tr><tr><td>성능</td><td>토큰 크기 최적화</td><td>JWT는 세션 ID보다 크므로 네트워크 부담</td><td>필요 최소 정보만 포함, 압축 적용</td></tr><tr><td>확장성</td><td>토큰 검증 로직 분산</td><td>각 서비스에서 독립적으로 토큰 검증</td><td>공개키 공유, 토큰 검증 라이브러리 표준화</td></tr><tr><td>관리</td><td>키 순환 정책</td><td>서명 키의 정기적 교체</td><td>자동화된 키 순환 메커니즘 구축</td></tr><tr><td>모니터링</td><td>토큰 사용 추적</td><td>비정상적인 토큰 사용 패턴 탐지</td><td>로깅 및 알림 시스템 구축</td></tr></tbody></table><h3 id=최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>구분</th><th>최적화 영역</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>성능</td><td>토큰 검증 캐싱</td><td>반복적인 토큰 검증 시간 단축</td><td>Redis를 활용한 검증 결과 캐싱</td></tr><tr><td>성능</td><td>알고리즘 선택</td><td>서명/검증 속도와 보안성 고려</td><td>ECDSA P-256 (ES256) 권장</td></tr><tr><td>네트워크</td><td>토큰 압축</td><td>토큰 크기 최소화</td><td>gzip 압축, 불필요한 클레임 제거</td></tr><tr><td>메모리</td><td>토큰 풀링</td><td>토큰 객체 재사용</td><td>토큰 파서 인스턴스 풀링</td></tr><tr><td>확장성</td><td>토큰 발급 부하 분산</td><td>토큰 생성 서버 확장</td><td>로드 밸런서, 토큰 발급 서버 클러스터링</td></tr><tr><td>보안</td><td>적응형 토큰 만료</td><td>사용 패턴에 따른 동적 만료 시간</td><td>사용자 행동 분석 기반 만료 시간 조정</td></tr></tbody></table><h3 id=기타-사항>기타 사항<a hidden class=anchor aria-hidden=true href=#기타-사항>#</a></h3><h4 id=최신-기술-동향>최신 기술 동향<a hidden class=anchor aria-hidden=true href=#최신-기술-동향>#</a></h4><ol><li><strong>Passkey 통합</strong>: WebAuthn과 토큰 기반 인증의 결합</li><li><strong>제로 트러스트 아키텍처</strong>: 연속적인 인증 및 검증</li><li><strong>AI 기반 위험 분석</strong>: 토큰 사용 패턴의 실시간 위험 분석</li><li><strong>블록체인 토큰</strong>: 분산원장 기반 토큰 검증 메커니즘</li></ol><h4 id=규정-준수-요구사항>규정 준수 요구사항<a hidden class=anchor aria-hidden=true href=#규정-준수-요구사항>#</a></h4><ol><li><strong>PCI DSS</strong>: 결제 관련 토큰 보안 요구사항</li><li><strong>GDPR</strong>: 개인정보 처리 및 토큰 내 데이터 최소화</li><li><strong>FIDO2</strong>: 다중 인증 요소와의 통합</li><li><strong>OAuth 2.1</strong>: 최신 보안 권장사항 적용</li></ol><h4 id=성능-벤치마킹>성능 벤치마킹<a hidden class=anchor aria-hidden=true href=#성능-벤치마킹>#</a></h4><ul><li><strong>토큰 생성 속도</strong>: RSA-2048 약 1,000 TPS, ECDSA P-256 약 10,000 TPS</li><li><strong>토큰 검증 속도</strong>: RSA-2048 약 20,000 TPS, ECDSA P-256 약 8,000 TPS</li><li><strong>메모리 사용량</strong>: JWT 토큰당 평균 1-2KB, 세션 정보 대비 30% 절약</li></ul><h3 id=주제와-관련하여-주목할-내용>주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#주제와-관련하여-주목할-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>보안</td><td>토큰 보안</td><td>JWT 보안 취약점</td><td>알고리즘 혼동 공격, 키 유출 위험</td></tr><tr><td>보안</td><td>암호화</td><td>양자 저항 암호화</td><td>향후 양자 컴퓨팅 위협 대비</td></tr><tr><td>성능</td><td>확장성</td><td>토큰 검증 최적화</td><td>캐싱, 비동기 검증 기법</td></tr><tr><td>표준</td><td>프로토콜</td><td>OAuth 2.1</td><td>최신 보안 표준 및 모범 사례</td></tr><tr><td>구현</td><td>라이브러리</td><td>jwt.io 호환 라이브러리</td><td>다양한 언어별 JWT 구현체</td></tr><tr><td>모니터링</td><td>보안</td><td>토큰 남용 탐지</td><td>비정상적 사용 패턴 분석</td></tr></tbody></table><h3 id=반드시-학습해야할-내용>반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야할-내용>#</a></h3><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>암호화</td><td>해시</td><td>HMAC, SHA-256</td><td>토큰 서명을 위한 기본 암호화</td></tr><tr><td>암호화</td><td>공개키</td><td>RSA, ECDSA</td><td>분산 시스템용 비대칭 암호화</td></tr><tr><td>프로토콜</td><td>OAuth</td><td>OAuth 2.0/2.1 플로우</td><td>표준 인가 프레임워크</td></tr><tr><td>표준</td><td>JWT</td><td>RFC 7519</td><td>JSON Web Token 표준 명세</td></tr><tr><td>보안</td><td>웹 보안</td><td>XSS, CSRF 방어</td><td>토큰 기반 인증 취약점 대응</td></tr><tr><td>아키텍처</td><td>마이크로서비스</td><td>서비스 간 인증</td><td>분산 시스템 보안 설계</td></tr><tr><td>성능</td><td>캐싱</td><td>Redis, Memcached</td><td>토큰 검증 성능 최적화</td></tr><tr><td>모니터링</td><td>로깅</td><td>보안 이벤트 로깅</td><td>감사 추적 및 침입 탐지</td></tr></tbody></table><hr><h2 id=용어-정리-1>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-1>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>토큰 타입</td><td>Access Token</td><td>리소스 접근을 위한 단기 유효 토큰</td></tr><tr><td>토큰 타입</td><td>Refresh Token</td><td>Access Token 갱신을 위한 장기 유효 토큰</td></tr><tr><td>토큰 타입</td><td>ID Token</td><td>사용자 신원 정보를 포함한 토큰 (OpenID Connect)</td></tr><tr><td>암호화</td><td>HMAC</td><td>Hash-based Message Authentication Code, 대칭키 기반 서명</td></tr><tr><td>암호화</td><td>RSA</td><td>Rivest-Shamir-Adleman, 비대칭키 암호화 알고리즘</td></tr><tr><td>암호화</td><td>ECDSA</td><td>Elliptic Curve Digital Signature Algorithm, 타원곡선 디지털 서명</td></tr><tr><td>프로토콜</td><td>PKCE</td><td>Proof Key for Code Exchange, OAuth 보안 강화 기법</td></tr><tr><td>보안</td><td>CSRF</td><td>Cross-Site Request Forgery, 사이트 간 요청 위조 공격</td></tr><tr><td>보안</td><td>XSS</td><td>Cross-Site Scripting, 사이트 간 스크립팅 공격</td></tr><tr><td>아키텍처</td><td>SSO</td><td>Single Sign-On, 단일 로그인 서비스</td></tr><tr><td>아키텍처</td><td>RBAC</td><td>Role-Based Access Control, 역할 기반 접근 제어</td></tr><tr><td>아키텍처</td><td>ABAC</td><td>Attribute-Based Access Control, 속성 기반 접근 제어</td></tr><tr><td>표준</td><td>SAML</td><td>Security Assertion Markup Language, XML 기반 인증 표준</td></tr><tr><td>표준</td><td>OpenID Connect</td><td>OAuth 2.0 기반의 인증 계층</td></tr><tr><td>구현</td><td>JWE</td><td>JSON Web Encryption, JWT의 암호화 버전</td></tr><tr><td>구현</td><td>JWS</td><td>JSON Web Signature, JWT의 서명 버전</td></tr></tbody></table><hr><h2 id=참고-및-출처-1>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-1>#</a></h2><ul><li><a href=https://tools.ietf.org/html/rfc7519>JWT 공식 표준 (RFC 7519)</a></li><li><a href=https://tools.ietf.org/html/rfc6749>OAuth 2.0 공식 표준 (RFC 6749)</a></li><li><a href=https://jwt.io/>JWT.io - JSON Web Token 디버거</a></li><li><a href=https://tools.ietf.org/html/rfc8725>OAuth 2.0 보안 모범 사례 (RFC 8725)</a></li><li><a href=https://curity.io/resources/learn/jwt-best-practices/>Curity - JWT 보안 가이드</a></li><li><a href=https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html>OWASP - Authentication Cheat Sheet</a></li><li><a href=https://spring.io/guides/tutorials/spring-boot-oauth2/>Spring Security JWT 구현 가이드</a></li><li><a href=https://auth0.com/blog/a-look-at-the-latest-draft-for-jwt-bcp/>Auth0 - Token-Based Authentication Guide</a></li></ul><hr><p>토큰 기반 인증은 현대 웹 및 모바일 애플리케이션에서 사용자 인증을 관리하는 효과적인 방법으로, 전통적인 세션 기반 인증의 대안으로 널리 사용되고 있다. 이 방식은 확장성, 보안성, 그리고 사용자 경험을 개선하며, 특히 분산 시스템과 마이크로서비스 아키텍처에서 큰 장점을 제공한다.</p><h3 id=토큰-기반-인증의-기본-개념>토큰 기반 인증의 기본 개념<a hidden class=anchor aria-hidden=true href=#토큰-기반-인증의-기본-개념>#</a></h3><p>토큰 기반 인증은 사용자가 자신의 자격 증명(일반적으로 사용자 이름과 비밀번호)을 인증 서버에 제출하면, 서버가 이를 검증한 후 디지털 토큰을 발급하는 방식이다. 이 토큰은 일정 기간 동안 유효하며, 사용자는 이를 이용해 보호된 리소스에 접근할 수 있다.</p><p>전통적인 세션 기반 인증이 서버 측에 사용자 세션 정보를 저장하는 반면, 토큰 기반 인증은 클라이언트 측에 인증 정보를 저장한다. 이는 마치 일회용 입장권이나 신분증과 같은 역할을 한다.</p><h3 id=토큰-기반-인증의-작동-원리>토큰 기반 인증의 작동 원리<a hidden class=anchor aria-hidden=true href=#토큰-기반-인증의-작동-원리>#</a></h3><p>토큰 기반 인증의 기본 흐름은 다음과 같다:</p><ul><li><p>인증 및 토큰 발급 단계</p><ol><li><strong>사용자 로그인</strong>: 사용자가 애플리케이션에 자격 증명을 제출한다.</li><li><strong>서버 검증</strong>: 서버는 사용자 자격 증명을 검증한다.</li><li><strong>토큰 생성</strong>: 검증이 성공하면, 서버는 디지털 서명된 토큰을 생성한다. 이 토큰에는 사용자 ID, 권한, 만료 시간 등의 정보가 포함될 수 있다.</li><li><strong>토큰 전달</strong>: 서버는 생성된 토큰을 클라이언트에 반환한다.</li><li><strong>토큰 저장</strong>: 클라이언트는 이 토큰을 로컬 스토리지, 세션 스토리지, 쿠키 등에 저장한다.</li></ol></li><li><p>인증된 요청 처리 단계</p><ol><li><strong>요청 전송</strong>: 클라이언트는 보호된 리소스에 접근할 때 저장된 토큰을 요청 헤더(일반적으로 Authorization 헤더)에 포함시킨다.</li><li><strong>토큰 검증</strong>: 서버는 토큰의 서명과 내용을 검증한다.</li><li><strong>권한 확인</strong>: 토큰이 유효하면, 서버는 토큰에 포함된 사용자 권한을 확인하고 요청된 리소스에 대한 접근 권한을 부여한다.</li><li><strong>응답 반환</strong>: 서버는 요청에 대한 응답을 반환한다.</li></ol></li><li><p>토큰 갱신 및 로그아웃 단계</p><ol><li><strong>토큰 만료</strong>: 모든 토큰은 일정 시간이 지나면 만료된다.</li><li><strong>토큰 갱신</strong>: 토큰이 만료되기 전에 새로운 토큰을 요청할 수 있다(리프레시 토큰 사용).</li><li><strong>로그아웃</strong>: 사용자가 로그아웃하면 클라이언트는 저장된 토큰을 삭제한다. 추가적인 보안을 위해 서버 측에서 해당 토큰을 블랙리스트에 추가할 수도 있다.</li></ol></li></ul><h3 id=토큰의-종류>토큰의 종류<a hidden class=anchor aria-hidden=true href=#토큰의-종류>#</a></h3><h4 id=jwtjson-web-token>JWT(JSON Web Token)<a hidden class=anchor aria-hidden=true href=#jwtjson-web-token>#</a></h4><p>JWT는 가장 널리 사용되는 토큰 형식으로, 컴팩트하고 자체 포함적인 방식으로 당사자 간에 정보를 안전하게 전송하기 위한 개방형 표준이다.</p><p>JWT는 세 부분으로 구성된다:</p><ol><li><strong>헤더(Header)</strong>: 토큰 유형과 사용된 서명 알고리즘을 명시한다.</li><li><strong>페이로드(Payload)</strong>: 클레임(claims)이라 불리는 토큰에 담길 정보를 포함한다.</li><li><strong>서명(Signature)</strong>: 토큰이 변경되지 않았음을 확인하는 데 사용된다.</li></ol><p>JWT 구조 예시:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
</span></span></code></pre></td></tr></table></div></div><h4 id=액세스-토큰access-token>액세스 토큰(Access Token)<a hidden class=anchor aria-hidden=true href=#액세스-토큰access-token>#</a></h4><p>액세스 토큰은 보호된 리소스에 접근하기 위한 권한을 나타내는 토큰이다. 일반적으로 짧은 수명을 가지며, JWT 형식으로 구현되는 경우가 많다.</p><h4 id=리프레시-토큰refresh-token>리프레시 토큰(Refresh Token)<a hidden class=anchor aria-hidden=true href=#리프레시-토큰refresh-token>#</a></h4><p>리프레시 토큰은 액세스 토큰이 만료되었을 때 새로운 액세스 토큰을 얻기 위해 사용된다. 일반적으로 액세스 토큰보다 긴 수명을 가지며, 더 안전하게 저장되어야 한다.</p><h4 id=id-토큰>ID 토큰<a hidden class=anchor aria-hidden=true href=#id-토큰>#</a></h4><p>주로 OpenID Connect(OIDC) 프로토콜에서 사용되며, 사용자의 신원에 관한 정보를 포함한다. 인증 목적으로 사용된다.</p><h3 id=토큰-기반-인증-구현-예제>토큰 기반 인증 구현 예제<a hidden class=anchor aria-hidden=true href=#토큰-기반-인증-구현-예제>#</a></h3><p>다음은 Node.js와 Express를 사용한 간단한 JWT 기반 인증 시스템의 구현 예제:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1>  1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2>  2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3>  3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4>  4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5>  5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6>  6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7>  7</a>
</span><span class=lnt id=hl-18-8><a class=lnlinks href=#hl-18-8>  8</a>
</span><span class=lnt id=hl-18-9><a class=lnlinks href=#hl-18-9>  9</a>
</span><span class=lnt id=hl-18-10><a class=lnlinks href=#hl-18-10> 10</a>
</span><span class=lnt id=hl-18-11><a class=lnlinks href=#hl-18-11> 11</a>
</span><span class=lnt id=hl-18-12><a class=lnlinks href=#hl-18-12> 12</a>
</span><span class=lnt id=hl-18-13><a class=lnlinks href=#hl-18-13> 13</a>
</span><span class=lnt id=hl-18-14><a class=lnlinks href=#hl-18-14> 14</a>
</span><span class=lnt id=hl-18-15><a class=lnlinks href=#hl-18-15> 15</a>
</span><span class=lnt id=hl-18-16><a class=lnlinks href=#hl-18-16> 16</a>
</span><span class=lnt id=hl-18-17><a class=lnlinks href=#hl-18-17> 17</a>
</span><span class=lnt id=hl-18-18><a class=lnlinks href=#hl-18-18> 18</a>
</span><span class=lnt id=hl-18-19><a class=lnlinks href=#hl-18-19> 19</a>
</span><span class=lnt id=hl-18-20><a class=lnlinks href=#hl-18-20> 20</a>
</span><span class=lnt id=hl-18-21><a class=lnlinks href=#hl-18-21> 21</a>
</span><span class=lnt id=hl-18-22><a class=lnlinks href=#hl-18-22> 22</a>
</span><span class=lnt id=hl-18-23><a class=lnlinks href=#hl-18-23> 23</a>
</span><span class=lnt id=hl-18-24><a class=lnlinks href=#hl-18-24> 24</a>
</span><span class=lnt id=hl-18-25><a class=lnlinks href=#hl-18-25> 25</a>
</span><span class=lnt id=hl-18-26><a class=lnlinks href=#hl-18-26> 26</a>
</span><span class=lnt id=hl-18-27><a class=lnlinks href=#hl-18-27> 27</a>
</span><span class=lnt id=hl-18-28><a class=lnlinks href=#hl-18-28> 28</a>
</span><span class=lnt id=hl-18-29><a class=lnlinks href=#hl-18-29> 29</a>
</span><span class=lnt id=hl-18-30><a class=lnlinks href=#hl-18-30> 30</a>
</span><span class=lnt id=hl-18-31><a class=lnlinks href=#hl-18-31> 31</a>
</span><span class=lnt id=hl-18-32><a class=lnlinks href=#hl-18-32> 32</a>
</span><span class=lnt id=hl-18-33><a class=lnlinks href=#hl-18-33> 33</a>
</span><span class=lnt id=hl-18-34><a class=lnlinks href=#hl-18-34> 34</a>
</span><span class=lnt id=hl-18-35><a class=lnlinks href=#hl-18-35> 35</a>
</span><span class=lnt id=hl-18-36><a class=lnlinks href=#hl-18-36> 36</a>
</span><span class=lnt id=hl-18-37><a class=lnlinks href=#hl-18-37> 37</a>
</span><span class=lnt id=hl-18-38><a class=lnlinks href=#hl-18-38> 38</a>
</span><span class=lnt id=hl-18-39><a class=lnlinks href=#hl-18-39> 39</a>
</span><span class=lnt id=hl-18-40><a class=lnlinks href=#hl-18-40> 40</a>
</span><span class=lnt id=hl-18-41><a class=lnlinks href=#hl-18-41> 41</a>
</span><span class=lnt id=hl-18-42><a class=lnlinks href=#hl-18-42> 42</a>
</span><span class=lnt id=hl-18-43><a class=lnlinks href=#hl-18-43> 43</a>
</span><span class=lnt id=hl-18-44><a class=lnlinks href=#hl-18-44> 44</a>
</span><span class=lnt id=hl-18-45><a class=lnlinks href=#hl-18-45> 45</a>
</span><span class=lnt id=hl-18-46><a class=lnlinks href=#hl-18-46> 46</a>
</span><span class=lnt id=hl-18-47><a class=lnlinks href=#hl-18-47> 47</a>
</span><span class=lnt id=hl-18-48><a class=lnlinks href=#hl-18-48> 48</a>
</span><span class=lnt id=hl-18-49><a class=lnlinks href=#hl-18-49> 49</a>
</span><span class=lnt id=hl-18-50><a class=lnlinks href=#hl-18-50> 50</a>
</span><span class=lnt id=hl-18-51><a class=lnlinks href=#hl-18-51> 51</a>
</span><span class=lnt id=hl-18-52><a class=lnlinks href=#hl-18-52> 52</a>
</span><span class=lnt id=hl-18-53><a class=lnlinks href=#hl-18-53> 53</a>
</span><span class=lnt id=hl-18-54><a class=lnlinks href=#hl-18-54> 54</a>
</span><span class=lnt id=hl-18-55><a class=lnlinks href=#hl-18-55> 55</a>
</span><span class=lnt id=hl-18-56><a class=lnlinks href=#hl-18-56> 56</a>
</span><span class=lnt id=hl-18-57><a class=lnlinks href=#hl-18-57> 57</a>
</span><span class=lnt id=hl-18-58><a class=lnlinks href=#hl-18-58> 58</a>
</span><span class=lnt id=hl-18-59><a class=lnlinks href=#hl-18-59> 59</a>
</span><span class=lnt id=hl-18-60><a class=lnlinks href=#hl-18-60> 60</a>
</span><span class=lnt id=hl-18-61><a class=lnlinks href=#hl-18-61> 61</a>
</span><span class=lnt id=hl-18-62><a class=lnlinks href=#hl-18-62> 62</a>
</span><span class=lnt id=hl-18-63><a class=lnlinks href=#hl-18-63> 63</a>
</span><span class=lnt id=hl-18-64><a class=lnlinks href=#hl-18-64> 64</a>
</span><span class=lnt id=hl-18-65><a class=lnlinks href=#hl-18-65> 65</a>
</span><span class=lnt id=hl-18-66><a class=lnlinks href=#hl-18-66> 66</a>
</span><span class=lnt id=hl-18-67><a class=lnlinks href=#hl-18-67> 67</a>
</span><span class=lnt id=hl-18-68><a class=lnlinks href=#hl-18-68> 68</a>
</span><span class=lnt id=hl-18-69><a class=lnlinks href=#hl-18-69> 69</a>
</span><span class=lnt id=hl-18-70><a class=lnlinks href=#hl-18-70> 70</a>
</span><span class=lnt id=hl-18-71><a class=lnlinks href=#hl-18-71> 71</a>
</span><span class=lnt id=hl-18-72><a class=lnlinks href=#hl-18-72> 72</a>
</span><span class=lnt id=hl-18-73><a class=lnlinks href=#hl-18-73> 73</a>
</span><span class=lnt id=hl-18-74><a class=lnlinks href=#hl-18-74> 74</a>
</span><span class=lnt id=hl-18-75><a class=lnlinks href=#hl-18-75> 75</a>
</span><span class=lnt id=hl-18-76><a class=lnlinks href=#hl-18-76> 76</a>
</span><span class=lnt id=hl-18-77><a class=lnlinks href=#hl-18-77> 77</a>
</span><span class=lnt id=hl-18-78><a class=lnlinks href=#hl-18-78> 78</a>
</span><span class=lnt id=hl-18-79><a class=lnlinks href=#hl-18-79> 79</a>
</span><span class=lnt id=hl-18-80><a class=lnlinks href=#hl-18-80> 80</a>
</span><span class=lnt id=hl-18-81><a class=lnlinks href=#hl-18-81> 81</a>
</span><span class=lnt id=hl-18-82><a class=lnlinks href=#hl-18-82> 82</a>
</span><span class=lnt id=hl-18-83><a class=lnlinks href=#hl-18-83> 83</a>
</span><span class=lnt id=hl-18-84><a class=lnlinks href=#hl-18-84> 84</a>
</span><span class=lnt id=hl-18-85><a class=lnlinks href=#hl-18-85> 85</a>
</span><span class=lnt id=hl-18-86><a class=lnlinks href=#hl-18-86> 86</a>
</span><span class=lnt id=hl-18-87><a class=lnlinks href=#hl-18-87> 87</a>
</span><span class=lnt id=hl-18-88><a class=lnlinks href=#hl-18-88> 88</a>
</span><span class=lnt id=hl-18-89><a class=lnlinks href=#hl-18-89> 89</a>
</span><span class=lnt id=hl-18-90><a class=lnlinks href=#hl-18-90> 90</a>
</span><span class=lnt id=hl-18-91><a class=lnlinks href=#hl-18-91> 91</a>
</span><span class=lnt id=hl-18-92><a class=lnlinks href=#hl-18-92> 92</a>
</span><span class=lnt id=hl-18-93><a class=lnlinks href=#hl-18-93> 93</a>
</span><span class=lnt id=hl-18-94><a class=lnlinks href=#hl-18-94> 94</a>
</span><span class=lnt id=hl-18-95><a class=lnlinks href=#hl-18-95> 95</a>
</span><span class=lnt id=hl-18-96><a class=lnlinks href=#hl-18-96> 96</a>
</span><span class=lnt id=hl-18-97><a class=lnlinks href=#hl-18-97> 97</a>
</span><span class=lnt id=hl-18-98><a class=lnlinks href=#hl-18-98> 98</a>
</span><span class=lnt id=hl-18-99><a class=lnlinks href=#hl-18-99> 99</a>
</span><span class=lnt id=hl-18-100><a class=lnlinks href=#hl-18-100>100</a>
</span><span class=lnt id=hl-18-101><a class=lnlinks href=#hl-18-101>101</a>
</span><span class=lnt id=hl-18-102><a class=lnlinks href=#hl-18-102>102</a>
</span><span class=lnt id=hl-18-103><a class=lnlinks href=#hl-18-103>103</a>
</span><span class=lnt id=hl-18-104><a class=lnlinks href=#hl-18-104>104</a>
</span><span class=lnt id=hl-18-105><a class=lnlinks href=#hl-18-105>105</a>
</span><span class=lnt id=hl-18-106><a class=lnlinks href=#hl-18-106>106</a>
</span><span class=lnt id=hl-18-107><a class=lnlinks href=#hl-18-107>107</a>
</span><span class=lnt id=hl-18-108><a class=lnlinks href=#hl-18-108>108</a>
</span><span class=lnt id=hl-18-109><a class=lnlinks href=#hl-18-109>109</a>
</span><span class=lnt id=hl-18-110><a class=lnlinks href=#hl-18-110>110</a>
</span><span class=lnt id=hl-18-111><a class=lnlinks href=#hl-18-111>111</a>
</span><span class=lnt id=hl-18-112><a class=lnlinks href=#hl-18-112>112</a>
</span><span class=lnt id=hl-18-113><a class=lnlinks href=#hl-18-113>113</a>
</span><span class=lnt id=hl-18-114><a class=lnlinks href=#hl-18-114>114</a>
</span><span class=lnt id=hl-18-115><a class=lnlinks href=#hl-18-115>115</a>
</span><span class=lnt id=hl-18-116><a class=lnlinks href=#hl-18-116>116</a>
</span><span class=lnt id=hl-18-117><a class=lnlinks href=#hl-18-117>117</a>
</span><span class=lnt id=hl-18-118><a class=lnlinks href=#hl-18-118>118</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>jwt</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;jsonwebtoken&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>bodyParser</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;body-parser&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>PORT</span> <span class=o>=</span> <span class=mi>3000</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>SECRET_KEY</span> <span class=o>=</span> <span class=s1>&#39;your-secret-key&#39;</span><span class=p>;</span> <span class=c1>// 실제 환경에서는 환경 변수로 관리
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// 미들웨어
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>bodyParser</span><span class=p>.</span><span class=nx>json</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 사용자 데이터베이스 (예시용)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>users</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>id</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>username</span><span class=o>:</span> <span class=s1>&#39;user1&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>password</span><span class=o>:</span> <span class=s1>&#39;password1&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>role</span><span class=o>:</span> <span class=s1>&#39;admin&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 토큰 검증 미들웨어
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>authenticateToken</span> <span class=o>=</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>authHeader</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>headers</span><span class=p>[</span><span class=s1>&#39;authorization&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>authHeader</span> <span class=o>&amp;&amp;</span> <span class=nx>authHeader</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>];</span> <span class=c1>// Bearer TOKEN 형식에서 TOKEN 추출
</span></span></span><span class=line><span class=cl><span class=c1></span>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;인증 토큰이 없습니다&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>token</span><span class=p>,</span> <span class=nx>SECRET_KEY</span><span class=p>,</span> <span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>decoded</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>403</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;유효하지 않은 토큰입니다&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>req</span><span class=p>.</span><span class=nx>user</span> <span class=o>=</span> <span class=nx>decoded</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 로그인 라우트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>username</span><span class=p>,</span> <span class=nx>password</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 사용자 인증
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=nx>users</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=nx>u</span> <span class=p>=&gt;</span> <span class=nx>u</span><span class=p>.</span><span class=nx>username</span> <span class=o>===</span> <span class=nx>username</span> <span class=o>&amp;&amp;</span> <span class=nx>u</span><span class=p>.</span><span class=nx>password</span> <span class=o>===</span> <span class=nx>password</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;잘못된 자격 증명입니다&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 액세스 토큰 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>accessToken</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span> <span class=nx>username</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>username</span><span class=p>,</span> <span class=nx>role</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>role</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>SECRET_KEY</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>expiresIn</span><span class=o>:</span> <span class=s1>&#39;1h&#39;</span> <span class=p>}</span> <span class=c1>// 1시간 후 만료
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 리프레시 토큰 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>refreshToken</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>id</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>SECRET_KEY</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>expiresIn</span><span class=o>:</span> <span class=s1>&#39;7d&#39;</span> <span class=p>}</span> <span class=c1>// 7일 후 만료
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 실제 구현에서는 리프레시 토큰을 데이터베이스에 저장합니다
</span></span></span><span class=line><span class=cl><span class=c1></span>  
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;로그인 성공&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>accessToken</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>refreshToken</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 보호된 라우트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/protected&#39;</span><span class=p>,</span> <span class=nx>authenticateToken</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;보호된 리소스에 접근했습니다&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>user</span><span class=o>:</span> <span class=nx>req</span><span class=p>.</span><span class=nx>user</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 토큰 갱신 라우트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/refresh-token&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>refreshToken</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>refreshToken</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;리프레시 토큰이 없습니다&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 실제 구현에서는 데이터베이스에서 리프레시 토큰 유효성을 확인합니다
</span></span></span><span class=line><span class=cl><span class=c1></span>  
</span></span><span class=line><span class=cl>  <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>refreshToken</span><span class=p>,</span> <span class=nx>SECRET_KEY</span><span class=p>,</span> <span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>decoded</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>403</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;유효하지 않은 리프레시 토큰입니다&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=nx>users</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=nx>u</span> <span class=p>=&gt;</span> <span class=nx>u</span><span class=p>.</span><span class=nx>id</span> <span class=o>===</span> <span class=nx>decoded</span><span class=p>.</span><span class=nx>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>403</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;사용자를 찾을 수 없습니다&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 새 액세스 토큰 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>accessToken</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span> <span class=nx>username</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>username</span><span class=p>,</span> <span class=nx>role</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>role</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>SECRET_KEY</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span> <span class=nx>expiresIn</span><span class=o>:</span> <span class=s1>&#39;1h&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>      <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;토큰이 갱신되었습니다&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>accessToken</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=nx>PORT</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`서버가 포트 </span><span class=si>${</span><span class=nx>PORT</span><span class=si>}</span><span class=sb>에서 실행 중입니다`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>이 예제는 기본적인 JWT 기반 인증 시스템을 구현하며 다음과 같은 기능을 제공한다:</p><ul><li>사용자 로그인 및 토큰 발급</li><li>토큰 검증 미들웨어를 통한 보호된 리소스 접근 제어</li><li>리프레시 토큰을 사용한 액세스 토큰 갱신</li></ul><h3 id=토큰-기반-인증의-장점>토큰 기반 인증의 장점<a hidden class=anchor aria-hidden=true href=#토큰-기반-인증의-장점>#</a></h3><ol><li><p>무상태(Stateless) 아키텍처<br>토큰 기반 인증은 서버 측에서 사용자 세션 상태를 유지할 필요가 없다. 이는 서버의 메모리 사용량을 줄이고, 수평적 확장을 용이하게 한다.</p></li><li><p>확장성(Scalability)<br>서버가 상태를 유지하지 않기 때문에, 로드 밸런싱이 매우 간단해진다. 어떤 서버로 요청이 전달되어도 토큰만 검증하면 인증이 가능하다.</p></li><li><p>교차 도메인(Cross-Domain) 지원<br>토큰은 도메인에 구애받지 않고 사용할 수 있어, 여러 서비스 간에 인증 정보를 공유하는 것이 용이하다. 이는 마이크로서비스 아키텍처에서 특히 유용하다.</p></li><li><p>다양한 클라이언트 지원<br>토큰은 웹 애플리케이션뿐만 아니라 모바일 앱, IoT 장치 등 다양한 클라이언트에서 사용할 수 있다.</p></li><li><p>세분화된 권한 제어<br>토큰에 사용자의 권한 정보를 포함시킬 수 있어, 세밀한 접근 제어가 가능하다.</p></li><li><p>디커플링(Decoupling)<br>인증 로직을 별도의 서비스로 분리할 수 있어, 코드 구조가 깔끔해지고 유지보수가 용이해진다.</p></li></ol><h3 id=토큰-기반-인증의-단점>토큰 기반 인증의 단점<a hidden class=anchor aria-hidden=true href=#토큰-기반-인증의-단점>#</a></h3><ol><li><p>토큰 크기<br>특히 JWT는 세션 ID에 비해 크기가 클 수 있으며, 토큰에 많은 정보를 포함할수록 요청 크기가 커진다.</p></li><li><p>토큰 저장 및 보안<br>클라이언트 측에서 토큰을 안전하게 저장하는 것은 도전적인 과제이다. XSS(Cross-Site Scripting) 공격에 취약할 수 있다.</p></li><li><p>토큰 무효화<br>일단 발급된 토큰은 만료되기 전까지 유효하므로, 즉시 무효화하기 어렵다. 이를 위해 블랙리스트 또는 추가적인 메커니즘이 필요할 수 있다.</p></li><li><p>서버 부하<br>토큰 검증 과정, 특히 암호화 및 서명 검증은 계산 비용이 발생할 수 있다.</p></li><li><p>갱신 전략의 복잡성<br>토큰 갱신 메커니즘(리프레시 토큰 등)은 구현이 복잡할 수 있으며, 잘못 구현되면 보안 위험이 발생할 수 있다.</p></li></ol><h3 id=토큰-보안-고려사항>토큰 보안 고려사항<a hidden class=anchor aria-hidden=true href=#토큰-보안-고려사항>#</a></h3><h4 id=토큰-저장>토큰 저장<a hidden class=anchor aria-hidden=true href=#토큰-저장>#</a></h4><p>클라이언트 측에서는 토큰을 안전하게 저장해야 합니다:</p><ul><li><strong>쿠키</strong>: <code>HttpOnly</code> 및 <code>Secure</code> 플래그를 설정하여 XSS 공격으로부터 보호합니다.</li><li><strong>로컬 스토리지/세션 스토리지</strong>: 편리하지만 XSS 공격에 취약합니다.</li><li><strong>메모리</strong>: 가장 안전하지만, 페이지 새로고침 시 손실될 수 있습니다.</li></ul><h4 id=토큰-서명>토큰 서명<a hidden class=anchor aria-hidden=true href=#토큰-서명>#</a></h4><p>강력한 서명 알고리즘(예: HS256, RS256)과 안전한 비밀 키를 사용해야 합니다.</p><h4 id=토큰-내용>토큰 내용<a hidden class=anchor aria-hidden=true href=#토큰-내용>#</a></h4><p>토큰에는 필요한 최소한의 정보만 포함해야 합니다. 특히 민감한 정보는 포함하지 않는 것이 좋습니다.</p><h4 id=토큰-수명>토큰 수명<a hidden class=anchor aria-hidden=true href=#토큰-수명>#</a></h4><p>액세스 토큰의 수명은 짧게(15분~1시간) 유지하고, 리프레시 토큰은 더 긴 수명을 가질 수 있지만 적절히 관리되어야 합니다.</p><h4 id=csrf-방어>CSRF 방어<a hidden class=anchor aria-hidden=true href=#csrf-방어>#</a></h4><p>토큰이 쿠키에 저장되는 경우, CSRF(Cross-Site Request Forgery) 공격에 대한 방어 메커니즘이 필요합니다.</p><h4 id=토큰-전송>토큰 전송<a hidden class=anchor aria-hidden=true href=#토큰-전송>#</a></h4><p>토큰은 항상 HTTPS를 통해 전송되어야 합니다.</p><h3 id=9-최신-토큰-인증-관련-동향>9. 최신 토큰 인증 관련 동향<a hidden class=anchor aria-hidden=true href=#9-최신-토큰-인증-관련-동향>#</a></h3><h4 id=pasetoplatform-agnostic-security-tokens>PASETO(Platform-Agnostic Security Tokens)<a hidden class=anchor aria-hidden=true href=#pasetoplatform-agnostic-security-tokens>#</a></h4><p>JWT의 대안으로 제안된 것으로, 보다 엄격한 암호화 요구사항과 간결한 구조를 제공합니다.</p><h4 id=블록체인-기반-인증>블록체인 기반 인증<a hidden class=anchor aria-hidden=true href=#블록체인-기반-인증>#</a></h4><p>분산 원장 기술을 활용하여 중앙화된 인증 시스템의 대안을 제공하는 연구가 진행 중입니다.</p><h4 id=자격-증명-관리credential-management-api>자격 증명 관리(Credential Management) API<a hidden class=anchor aria-hidden=true href=#자격-증명-관리credential-management-api>#</a></h4><p>브라우저에서 보다 안전하게 자격 증명을 저장하고 관리할 수 있는 API가 개발되고 있습니다.</p><h4 id=무암호passwordless-인증>무암호(Passwordless) 인증<a hidden class=anchor aria-hidden=true href=#무암호passwordless-인증>#</a></h4><p>WebAuthn, FIDO2와 같은 표준을 통해 토큰과 생체 인식을 결합한 무암호 인증 방식이 증가하고 있습니다.</p><h4 id=mtlsmutual-tls>mTLS(Mutual TLS)<a hidden class=anchor aria-hidden=true href=#mtlsmutual-tls>#</a></h4><p>클라이언트와 서버 간의 상호 인증을 위한 mTLS를 토큰 인증과 결합하여 보안을 강화하는 방식이 늘어나고 있습니다.</p><h3 id=토큰-기반-인증-구현-모범-사례>토큰 기반 인증 구현 모범 사례<a hidden class=anchor aria-hidden=true href=#토큰-기반-인증-구현-모범-사례>#</a></h3><ol><li><p>액세스 토큰 및 리프레시 토큰 전략</p><ul><li>액세스 토큰은 짧은 수명(15분~1시간)으로 설정하여 노출 위험을 최소화한다.</li><li>리프레시 토큰은 안전하게 저장하고, 사용할 때마다 교체(rotation)하는 전략을 고려한다.</li></ul></li><li><p>토큰 저장</p><ul><li>웹 애플리케이션: <code>HttpOnly</code>, <code>Secure</code>, <code>SameSite</code> 속성이 설정된 쿠키에 저장한다.</li><li>모바일 앱: 안전한 저장소(iOS의 Keychain, Android의 EncryptedSharedPreferences)를 사용한다.</li></ul></li><li><p>토큰 전송</p><ul><li>REST API: Authorization 헤더에 Bearer 스키마를 사용하여 토큰을 전송한다.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9…
</span></span></code></pre></td></tr></table></div></div><ul><li>웹소켓 등: 초기 연결 설정 시 토큰을 검증한다.</li></ul></li><li><p>보안 강화</p><ul><li>HTTPS 항상 사용</li><li>적절한 CORS(Cross-Origin Resource Sharing) 설정</li><li>XSS 방어를 위한 콘텐츠 보안 정책(CSP) 적용</li><li>토큰 페이로드에 중요 정보 포함 금지</li><li>JWT 서명 알고리즘으로 <code>none</code>을 절대 허용하지 않음</li></ul></li><li><p>모니터링 및 감사</p><ul><li>토큰 사용 및 갱신에 대한 로깅 구현</li><li>비정상적인 토큰 사용 패턴 감지 시스템 구축</li><li>토큰 무효화 메커니즘 구현 (필요한 경우)</li></ul></li></ol><hr><h2 id=용어-정리-2>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-2>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><hr><h2 id=참고-및-출처-2>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-2>#</a></h2></div><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Token Authentication vs. SAML</h2></header><div class=entry-content><p>Token Authentication vs. SAML 토큰 인증(Token Authentication) 토큰 인증은 사용자의 자격 증명(보통 사용자 이름과 비밀번호)을 검증한 후, 서버가 발급한 토큰을 통해 이후 요청에서 인증을 처리하는 방식이다.
기본 개념 및 작동 원리 인증 흐름: 사용자가 로그인 정보(ID/비밀번호)를 제출한다. 서버는 이를 검증하고 서명된 토큰을 생성한다. 클라이언트는 토큰을 저장하고 이후 요청에 포함시킨다. 서버는 토큰의 서명과 내용을 검증하여 사용자를 인증한다. 토큰 형식: 가장 일반적인 형식은 JWT(JSON Web Token)이다. JWT는 헤더, 페이로드, 서명의 세 부분으로 구성된다. 토큰은 Base64Url로 인코딩되어 HTTP 헤더로 전송된다. 주요 특징 무상태(Stateless): 서버는 세션 상태를 저장할 필요가 없다. 확장성: 서버 간에 세션 정보를 공유할 필요가 없어 수평적 확장이 용이한다. 클라이언트 중심: 토큰은 클라이언트에 저장되고 관리된다. 다양한 플랫폼 지원: 웹, 모바일, API 등 다양한 환경에서 사용 가능하다. 자체 포함적(Self-contained): 토큰 자체에 사용자 정보와 권한이 포함될 수 있다. SAML(Security Assertion Markup Language) SAML은 서로 다른 도메인 간에 인증 및 권한 부여 데이터를 교환하기 위한 XML 기반 표준이다. 주로 엔터프라이즈 환경에서 SSO(Single Sign-On)를 구현하는 데 사용된다.
...</p></div><footer class=entry-footer><span title='2025-04-03 07:23:00 +0000 UTC'>April 3, 2025</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Token Authentication vs. SAML" href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-based-authentication-vs-saml/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Token Authentication vs. JWT</h2></header><div class=entry-content><p>Token Authentication vs. JWT 토큰 인증과 JWT는 모두 현대적인 웹 애플리케이션에서 사용자 인증을 관리하는 방법이지만, 이 둘 사이에는 중요한 차이점이 있다.
토큰 인증(Token Authentication) 토큰 인증은 사용자의 인증 정보를 검증한 후 서버가 고유한 토큰을 발급하고, 클라이언트가 이후 요청 시 이 토큰을 제시하여 자신을 인증하는 광범위한 인증 패러다임이다.
기본 개념 및 특징 일반적 작동 방식: 사용자가 자격 증명(username/password)을 제출한다. 서버는 이를 검증하고 고유한 토큰을 생성한다. 클라이언트는 이 토큰을 저장하고 향후 요청 시 제시한다. 서버는 토큰을 검증하여 사용자를 식별한다. 토큰 형태: 단순 무작위 문자열(UUID 등) 해시된 값 인코딩된 데이터 구조(JWT, SAML 등) 암호화된 페이로드 서버 측 저장: 대부분의 전통적인 토큰 시스템은 서버 측 저장소(데이터베이스, 캐시 등)에 토큰 정보를 보관한다. 토큰 자체는 단순한 식별자 역할을 하며, 관련 정보는 서버에서 조회한다. 토큰 관리: 서버가 발급한 토큰의 유효성을 관리한다. 만료, 폐기, 갱신 등의 작업이 서버 측에서 제어된다. JWT(JSON Web Token) JWT는 토큰 인증의 한 형태로, 정보를 안전하게 전송하기 위한 컴팩트하고 자체 포함적인(self-contained) JSON 객체이다. JWT는 RFC 7519에 정의된 개방형 표준이다.
...</p></div><footer class=entry-footer><span title='2025-04-03 07:22:00 +0000 UTC'>April 3, 2025</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Token Authentication vs. JWT" href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-based-authentication-vs-jwt/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Token Authentication vs. OAuth</h2></header><div class=entry-content><p>Token Authentication vs. OAuth 2.0 토큰 인증(Token Authentication)과 OAuth 2.0은 모두 사용자 인증 및 권한 부여를 처리하는 기술이지만, 목적과 구현 방식에 있어 중요한 차이점을 가지고 있다.
토큰 인증(Token Authentication) 토큰 인증은 사용자가 자격 증명(일반적으로 사용자 이름과 비밀번호)을 한 번 제공한 후, 서버가 생성한 토큰을 사용하여 이후의 요청에서 인증을 수행하는 방식이다.
기본 개념 토큰 인증의 핵심 아이디어는 사용자의 자격 증명을 한 번만 확인한 후, 서버가 서명된 토큰을 발급하여 클라이언트가 이 토큰을 사용해 자신을 인증하도록 하는 것이다. 가장 널리 사용되는 토큰 형식은 JWT(JSON Web Token)이다.
...</p></div><footer class=entry-footer><span title='2025-04-03 07:22:00 +0000 UTC'>April 3, 2025</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Token Authentication vs. OAuth" href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-based-authentication-vs-oauth-20/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Token Authentication vs. OpenID Connect</h2></header><div class=entry-content><p>Token Authentication vs. OpenID Connect 현대 웹과 애플리케이션의 보안 생태계에서 인증과 권한 부여는 필수적인 요소이다. 토큰 인증(Token Authentication)과 OpenID Connect(OIDC)는 모두 이 영역에서 중요한 역할을 하지만, 목적과 기능 면에서 상당한 차이가 있다.
토큰 인증(Token Authentication) 토큰 인증은 사용자의 자격 증명(주로 사용자 이름과 비밀번호)을 검증한 후, 서버가 발급한 토큰을 통해 이후의 요청에서 인증을 수행하는 방식이다.
기본 개념 및 작동 원리 토큰 인증의 핵심 아이디어는 사용자가 로그인하면 서버가 서명된 토큰을 발급하고, 이후 모든 요청에 이 토큰을 포함시켜 사용자를 식별하는 것이다. 가장 널리 사용되는 토큰 형식은 JWT(JSON Web Token)이다.
...</p></div><footer class=entry-footer><span title='2025-04-03 07:22:00 +0000 UTC'>April 3, 2025</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Token Authentication vs. OpenID Connect" href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-based-authentication-vs-openid-connect/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Token Authentication vs. Cookie-Based Auth</h2></header><div class=entry-content><p>Token Authentication vs. Cookie-Based Auth 토큰 인증(Token Authentication) 토큰 인증은 서버가 사용자의 인증 정보를 확인한 후 서명된 토큰을 발급하고, 클라이언트가 이 토큰을 이후의 요청에 포함시켜 자신을 인증하는 방식이다. 가장 널리 사용되는 토큰 형식은 JWT(JSON Web Token)이다.
작동 방식 사용자가 자격 증명(사용자 이름/비밀번호)을 서버에 제출한다. 서버는 자격 증명을 검증하고, 사용자 식별자와 권한 정보를 포함한 토큰을 생성한다. 서버는 비밀 키로 토큰에 서명하여 클라이언트에게 반환한다. 클라이언트는 이 토큰을 저장하고(주로 로컬 스토리지, 세션 스토리지 또는 메모리에 저장), 이후 요청의 Authorization 헤더에 포함시킨다. 서버는 토큰의 서명을 검증하고, 포함된 정보를 기반으로 사용자를 인증한다. 특징 무상태(Stateless): 서버는 클라이언트 상태 정보를 저장하지 않는다. 확장성: 여러 서버 간에 인증 정보를 공유할 필요가 없다. 플랫폼 독립적: 모바일 앱, SPA, API 등 다양한 클라이언트에서 사용 가능하다. 보안: 토큰에 서명을 통해 변조를 방지한다. 만료 시간 설정 가능: 토큰에 만료 시간을 포함할 수 있다. 쿠키 기반 인증(Cookie-Based Authentication) 쿠키 기반 인증은 서버가 사용자 인증 후 세션 ID를 포함한 쿠키를 클라이언트에 전송하고, 클라이언트가 이 쿠키를 모든 요청에 자동으로 포함시켜 인증하는 방식이다.
...</p></div><footer class=entry-footer><span title='2025-04-03 07:21:00 +0000 UTC'>April 3, 2025</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Token Authentication vs. Cookie-Based Auth" href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-based-authentication-vs-cookie-based-auth/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Token Authentication vs. Session-based Auth</h2></header><div class=entry-content><p>Token Authentication vs. Session-based Auth 세션 기반 인증(Session-based Authentication) 세션 기반 인증은 전통적인 인증 방식으로, 서버가 사용자의 로그인 상태를 세션으로 유지하는 방식이다.
작동 원리 인증 과정: 사용자가 자격 증명(사용자 이름/비밀번호)을 제출한다. 서버는 자격 증명을 검증하고, 유효한 경우 고유한 세션 ID를 생성한다. 서버는 세션 ID와 관련 사용자 정보를 서버 측 저장소(메모리, 데이터베이스, 캐시 등)에 저장한다. 서버는 세션 ID를 클라이언트에게 쿠키로 전송한다. 클라이언트는 이후 요청 시 이 쿠키를 자동으로 포함시킨다. 서버는 쿠키의 세션 ID를 확인하여 사용자를 식별한다. 세션 수명 주기: 세션은 사용자가 로그인할 때 생성된다. 세션은 일정 시간이 지나면 만료된다(서버 설정에 따라 다름). 사용자가 로그아웃하면 세션이 명시적으로 파기된다. 서버는 세션의 유효성과 만료를 관리한다. 주요 특징 상태 유지(Stateful): 서버가 세션 정보를 저장하고 관리한다. 쿠키 기반: 주로 HTTP 쿠키를 통해 세션 ID를 전달한다. 서버 측 저장소: 세션 데이터가 서버에 저장된다. 간단한 구현: 대부분의 웹 프레임워크에서 기본적으로 지원한다. 명시적인 세션 관리: 서버가 세션 생성, 검증, 만료, 파기를 제어한다. 토큰 인증(Token Authentication) 토큰 인증은 클라이언트에게 서명된 토큰을 발급하여 인증하는 방식이다. 가장 널리 사용되는 토큰 형식은 JWT(JSON Web Token)이다.
...</p></div><footer class=entry-footer><span title='2025-04-02 02:45:00 +0000 UTC'>April 2, 2025</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Token Authentication vs. Session-based Auth" href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-based-authentication-vs-session-based-auth/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Access Token</h2></header><div class=entry-content><p>Access Token Access Token은 마이크로서비스 아키텍처(MSA)에서 인증과 권한 부여를 위해 사용되는 보안 메커니즘이다.
Access Token은 사용자의 인증 정보를 담고 있는 암호화된 문자열이다. 이 토큰은 클라이언트가 서버의 보호된 리소스에 접근할 수 있는 권한을 증명하는 데 사용된다.
Access Token은 MSA 환경에서 효율적이고 안전한 인증 메커니즘을 제공한다.
그러나 적절한 구현과 보안 조치가 필수적이며, 시스템의 요구사항에 맞게 신중하게 설계해야 한다.
Access Token의 특징 유한한 수명: 보통 짧은 유효 기간(예: 1시간)을 가진다. Stateless: 서버에 상태를 저장하지 않아 확장성이 높다. 암호화: 대개 JWT(JSON Web Token) 형식으로 구현된다. 포함 정보: 사용자 ID, 권한 범위, 만료 시간 등을 포함할 수 있다. Access Token의 동작 방식 사용자 인증: 사용자가 로그인하면 서버는 Access Token을 발급한다. 토큰 저장: 클라이언트는 받은 토큰을 안전하게 저장한다(예: 로컬 스토리지). 요청 시 사용: API 요청 시 Authorization 헤더에 토큰을 포함시킨다. 서버 검증: 서버는 토큰의 유효성을 검사하고 요청을 처리한다. Access Token의 장점 확장성: Stateless 특성으로 서버 확장이 용이하다. 보안성: 암호화된 정보로 중요 데이터를 안전하게 전송한다. 효율성: 매 요청마다 사용자 정보를 조회할 필요가 없다. Access Token의 단점 토큰 탈취 위험: XSS 공격 등으로 토큰이 탈취될 수 있다. 제한된 정보량: 토큰 크기 제한으로 포함할 수 있는 정보가 제한적이다. Access Token과 Refresh Token 보안 강화를 위해 Access Token과 함께 Refresh Token을 사용한다:
...</p></div><footer class=entry-footer><span title='2024-11-18 11:22:00 +0000 UTC'>November 18, 2024</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Access Token" href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-types/access-token/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>JWT authentication</h2></header><div class=entry-content><p>JWT (Json Web Token) Authentication 아래는 “JWT(JSON Web Token)” 주제에 대한 체계적이고 깊이 있는 IT 백엔드 개발자 관점의 조사와 분석 결과입니다.
1. 태그 (Keyword-Tag) Token-Based-Authentication Security-Token JSON-Web-Token Stateless-Authentication 2. 카테고리 계층 구조 검토 제시된 계층 구조:
Computer Science and Engineering > Cybersecurity and Information Security > Access Control > Implementations > Token-Based Authentication
분석 및 근거:
JWT 는 인증과 권한 부여 (Access Control) 의 한 방식으로, Token-Based Authentication 의 대표적인 구현체입니다. 따라서,
...</p></div><footer class=entry-footer><span title='2024-11-06 11:24:00 +0000 UTC'>November 6, 2024</span>&nbsp;·&nbsp;51 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to JWT authentication" href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-formats/jwt/></a></article></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>