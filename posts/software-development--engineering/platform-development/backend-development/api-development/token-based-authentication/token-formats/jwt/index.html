<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>JWT authentication | hyunyoun's Blog</title><meta name=keywords content="Backend Development,API-Design-and-Implementation,API-Authentication-Methods,JWT-authentication"><meta name=description content="JSON Web Token(JWT)은 웹 애플리케이션과 서비스 간에 안전하게 정보를 전송하기 위한 개방형 표준(RFC 7519)이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-formats/jwt/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-formats/jwt/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-formats/jwt/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-formats/jwt/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="JWT authentication"><meta property="og:description" content="JSON Web Token(JWT)은 웹 애플리케이션과 서비스 간에 안전하게 정보를 전송하기 위한 개방형 표준(RFC 7519)이다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="JWT authentication"><meta name=twitter:description content="JSON Web Token(JWT)은 웹 애플리케이션과 서비스 간에 안전하게 정보를 전송하기 위한 개방형 표준(RFC 7519)이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"HY's Blog","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":7,"name":"JWT authentication","item":"https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-formats/jwt/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>HY's Blog</a></div><h1>JWT authentication</h1><div class=post-description>JSON Web Token(JWT)은 웹 애플리케이션과 서비스 간에 안전하게 정보를 전송하기 위한 개방형 표준(RFC 7519)이다.</div></header><div class=post-content><h2 id=jwt-json-web-token-authentication>JWT (Json Web Token) Authentication<a hidden class=anchor aria-hidden=true href=#jwt-json-web-token-authentication>#</a></h2><p>아래는 &ldquo;JWT(JSON Web Token)&rdquo; 주제에 대한 체계적이고 깊이 있는 IT 백엔드 개발자 관점의 조사와 분석 결과입니다.</p><hr><h2 id=1-태그-keyword-tag>1. 태그 (Keyword-Tag)<a hidden class=anchor aria-hidden=true href=#1-태그-keyword-tag>#</a></h2><ul><li>Token-Based-Authentication</li><li>Security-Token</li><li>JSON-Web-Token</li><li>Stateless-Authentication</li></ul><hr><h2 id=2-카테고리-계층-구조-검토>2. 카테고리 계층 구조 검토<a hidden class=anchor aria-hidden=true href=#2-카테고리-계층-구조-검토>#</a></h2><p><strong>제시된 계층 구조:</strong><br>Computer Science and Engineering > Cybersecurity and Information Security > Access Control > Implementations > Token-Based Authentication</p><p><strong>분석 및 근거:</strong><br>JWT 는 인증과 권한 부여 (Access Control) 의 한 방식으로, Token-Based Authentication 의 대표적인 구현체입니다. 따라서,</p><ul><li><strong>Computer Science and Engineering</strong>: 컴퓨터 공학 전반</li><li><strong>Cybersecurity and Information Security</strong>: 정보 보안</li><li><strong>Access Control</strong>: 접근 제어</li><li><strong>Implementations</strong>: 구현체</li><li><strong>Token-Based Authentication</strong>: 토큰 기반 인증<br>으로 분류하는 것이 적절합니다. JWT 는 인증 및 정보 교환의 핵심 기술로, 현대 웹·모바일 인증에서 표준적으로 사용되고 있습니다 <a href="https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-token-structure?utm_source=chatgpt.com" title="JSON Web Token Structure - Auth0">1</a><a href="https://www.ibm.com/docs/en/cics-ts/6.x?topic=cics-json-web-token-jwt&amp;utm_source=chatgpt.com" title="JSON Web Token (JWT) - IBM">3</a>.</li></ul><hr><h2 id=3-주제-요약-200-자-내외>3. 주제 요약 (200 자 내외)<a hidden class=anchor aria-hidden=true href=#3-주제-요약-200-자-내외>#</a></h2><p>JWT 는 사용자 인증 정보를 JSON 형식으로 담고, 암호화 서명으로 위변조를 방지하는 토큰 기반 인증 표준으로, 서버 세션 없이도 안전하게 사용자 인증과 정보 교환이 가능하다 <a href="https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-token-structure?utm_source=chatgpt.com" title="JSON Web Token Structure - Auth0">4</a><a href="https://www.ibm.com/docs/en/cics-ts/6.x?topic=cics-json-web-token-jwt&amp;utm_source=chatgpt.com" title="JSON Web Token (JWT) - IBM">3</a>.</p><hr><h2 id=4-전체-개요-250-자-내외>4. 전체 개요 (250 자 내외)<a hidden class=anchor aria-hidden=true href=#4-전체-개요-250-자-내외>#</a></h2><p>JWT 는 Header, Payload, Signature 로 구성된 토큰으로, 인증 및 권한 정보를 안전하게 전달할 수 있도록 설계되었다. 서버는 세션 상태를 유지하지 않고도 토큰 검증만으로 사용자를 인증할 수 있어, 분산 시스템과 마이크로서비스 환경에 적합하다 <a href="https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-token-structure?utm_source=chatgpt.com" title="JSON Web Token Structure - Auth0">4</a><a href="https://www.geeksforgeeks.org/json-web-token-jwt/?utm_source=chatgpt.com" title="JSON Web Token (JWT) - GeeksforGeeks">5</a>.</p><hr><h2 id=5-핵심-개념>5. 핵심 개념<a hidden class=anchor aria-hidden=true href=#5-핵심-개념>#</a></h2><ul><li><strong>정의</strong>: JWT(JSON Web Token) 는 사용자 인증 및 정보 교환을 위한 개방형 표준 (RFC 7519) 토큰이다.</li><li><strong>구성</strong>: Header(메타데이터), Payload(클레임), Signature(서명) 세 부분으로 구성된다.</li><li><strong>서명 방식</strong>: HMAC, RSA, ECDSA 등 다양한 알고리즘을 사용하여 토큰의 무결성을 보장한다.</li><li><strong>특징</strong>: Self-contained(자기 완결적), Stateless(상태 비저장), Compact(경량), Cross-domain(도메인 간 인증 가능)<a href="https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-token-structure?utm_source=chatgpt.com" title="JSON Web Token Structure - Auth0">4</a><a href="https://www.ibm.com/docs/en/cics-ts/6.x?topic=cics-json-web-token-jwt&amp;utm_source=chatgpt.com" title="JSON Web Token (JWT) - IBM">3</a>.</li><li><strong>실무 연관성</strong>: 세션 관리 없이 인증을 가능하게 하여, 마이크로서비스, SPA, 모바일 앱 등에서 널리 사용된다. 서버 부담 감소, 확장성 향상, 인증 정보의 신뢰성 보장 등 실무적 이점이 크다 <a href="https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-token-structure?utm_source=chatgpt.com" title="JSON Web Token Structure - Auth0">1</a><a href="https://www.ibm.com/docs/en/cics-ts/6.x?topic=cics-json-web-token-jwt&amp;utm_source=chatgpt.com" title="JSON Web Token (JWT) - IBM">3</a>.</li></ul><hr><h2 id=6-주제와-관련하여-조사할-내용>6. 주제와 관련하여 조사할 내용<a hidden class=anchor aria-hidden=true href=#6-주제와-관련하여-조사할-내용>#</a></h2><h3 id=61-배경>6.1. 배경<a hidden class=anchor aria-hidden=true href=#61-배경>#</a></h3><ul><li><strong>세션 기반 인증의 한계</strong>: 서버에 세션 정보를 저장해야 하므로 확장성, 분산 시스템에서 비효율적.</li><li><strong>토큰 기반 인증의 필요성</strong>: 서버 부담 감소, 클라이언트 - 서버 간 인증 정보 교환의 간소화.</li></ul><h3 id=62-목적-및-필요성>6.2. 목적 및 필요성<a hidden class=anchor aria-hidden=true href=#62-목적-및-필요성>#</a></h3><ul><li><strong>목적</strong>: 사용자 인증 및 권한 부여 정보를 안전하게 전달.</li><li><strong>필요성</strong>: 세션 관리 없이도 신뢰할 수 있는 인증 정보 제공.</li></ul><h3 id=63-주요-기능-및-역할>6.3. 주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#63-주요-기능-및-역할>#</a></h3><ul><li><strong>인증 (Authentication)</strong>: 사용자 신원 확인.</li><li><strong>권한 부여 (Authorization)</strong>: 리소스 접근 권한 확인.</li><li><strong>정보 교환 (Information Exchange)</strong>: 신뢰할 수 있는 정보 전달.</li></ul><h3 id=64-특징>6.4. 특징<a hidden class=anchor aria-hidden=true href=#64-특징>#</a></h3><ul><li><strong>Self-contained</strong>: 모든 정보가 토큰 내에 포함.</li><li><strong>Stateless</strong>: 서버에 상태 저장 불필요.</li><li><strong>Compact</strong>: HTTP 헤더 등에 쉽게 포함 가능.</li><li><strong>Cross-domain</strong>: 도메인 간 인증 가능.</li></ul><h3 id=65-핵심-원칙>6.5. 핵심 원칙<a hidden class=anchor aria-hidden=true href=#65-핵심-원칙>#</a></h3><ul><li><strong>무결성 (Integrity)</strong>: 서명으로 위변조 방지.</li><li><strong>신뢰성 (Trust)</strong>: 발급자 (issuer) 와 수신자 (audience) 확인.</li><li><strong>유효성 (Validity)</strong>: 만료 시간 (exp), 발급 시간 (iat) 등으로 유효성 관리.</li></ul><h3 id=66-주요-원리>6.6. 주요 원리<a hidden class=anchor aria-hidden=true href=#66-주요-원리>#</a></h3><ul><li><strong>서명 생성</strong>: Header 와 Payload 를 비밀키로 서명.</li><li><strong>서명 검증</strong>: 수신자가 동일한 비밀키로 서명 검증.</li><li><strong>클레임 검증</strong>: iss, sub, aud, exp, iat 등 표준 클레임 검증.</li></ul><h3 id=67-작동-원리-다이어그램워크플로우>6.7. 작동 원리 (다이어그램/워크플로우)<a hidden class=anchor aria-hidden=true href=#67-작동-원리-다이어그램워크플로우>#</a></h3><pre class=mermaid>sequenceDiagram
    participant Client
    participant AuthServer
    participant ResourceServer

    Client-&gt;&gt;AuthServer: 로그인(아이디/비밀번호)
    AuthServer-&gt;&gt;Client: JWT 발급
    Client-&gt;&gt;ResourceServer: JWT 포함 요청
    ResourceServer-&gt;&gt;ResourceServer: JWT 검증
    ResourceServer-&gt;&gt;Client: 리소스 반환
</pre><ul><li><strong>설명</strong>: 클라이언트가 인증 서버에 로그인하여 JWT 를 받고, 이후 리소스 서버에 JWT 를 포함해 요청하면 리소스 서버는 JWT 를 검증하여 인증 및 권한을 확인한다 <a href="https://www.geeksforgeeks.org/json-web-token-jwt/?utm_source=chatgpt.com" title="JSON Web Token (JWT) - GeeksforGeeks">6</a><a href="https://jwt.io/introduction?utm_source=chatgpt.com" title="JSON Web Token Introduction - jwt.io">7</a>.</li></ul><h3 id=68-구조-및-아키텍처>6.8. 구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#68-구조-및-아키텍처>#</a></h3><h4 id=구성-요소><strong>구성 요소</strong><a hidden class=anchor aria-hidden=true href=#구성-요소>#</a></h4><ul><li><strong>Header</strong>: 토큰 타입 (typ), 서명 알고리즘 (alg) 등 메타데이터.</li><li><strong>Payload</strong>: iss(발급자), sub(주체), exp(만료시간), iat(발급시간) 등 클레임.</li><li><strong>Signature</strong>: Header 와 Payload 를 비밀키로 서명한 값.</li><li><strong>필수 구성요소</strong>: Header, Payload, Signature.</li><li><strong>선택 구성요소</strong>: Custom Claims(사용자 정의 클레임)<a href="https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-token-structure?utm_source=chatgpt.com" title="JSON Web Token Structure - Auth0">4</a><a href="https://www.ibm.com/docs/en/cics-ts/6.x?topic=cics-json-web-token-jwt&amp;utm_source=chatgpt.com" title="JSON Web Token (JWT) - IBM">3</a>.</li></ul><h4 id=구조-다이어그램><strong>구조 다이어그램</strong><a hidden class=anchor aria-hidden=true href=#구조-다이어그램>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5>5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6>6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7>7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8>8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>+-------------------+</span>     <span class=o>+-------------------+</span>     <span class=o>+-------------------+</span>
</span></span><span class=line><span class=cl><span class=o>|</span>     <span class=n>Header</span>        <span class=o>|</span>     <span class=o>|</span>     <span class=n>Payload</span>       <span class=o>|</span>     <span class=o>|</span>    <span class=n>Signature</span>      <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|-------------------|</span>     <span class=o>|-------------------|</span>     <span class=o>|-------------------|</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>typ</span><span class=p>:</span> <span class=n>JWT</span>          <span class=o>|</span>     <span class=o>|</span> <span class=n>iss</span><span class=p>:</span> <span class=n>issuer</span>       <span class=o>|</span>     <span class=o>|</span> <span class=n>HMAC</span><span class=o>-</span><span class=n>SHA256</span><span class=p>(</span>      <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=n>alg</span><span class=p>:</span> <span class=n>HS256</span>        <span class=o>|</span>     <span class=o>|</span> <span class=n>sub</span><span class=p>:</span> <span class=n>subject</span>      <span class=o>|</span>     <span class=o>|</span>   <span class=n>base64</span><span class=p>(</span><span class=n>header</span><span class=p>)</span>  <span class=o>|</span>
</span></span><span class=line><span class=cl><span class=o>+-------------------+</span>     <span class=o>|</span> <span class=nb>exp</span><span class=p>:</span> <span class=n>expiration</span>   <span class=o>|</span>     <span class=o>|</span>   <span class=o>+</span> <span class=s2>&#34;.&#34;</span> <span class=o>+</span>         <span class=o>|</span>
</span></span><span class=line><span class=cl>                          <span class=o>|</span> <span class=n>iat</span><span class=p>:</span> <span class=n>issued</span> <span class=n>at</span>    <span class=o>|</span>     <span class=o>|</span>   <span class=n>base64</span><span class=p>(</span><span class=n>payload</span><span class=p>),</span><span class=o>|</span>
</span></span><span class=line><span class=cl>                          <span class=o>|</span> <span class=o>...</span><span class=n>custom</span> <span class=n>claims</span>  <span class=o>|</span>     <span class=o>|</span>   <span class=n>secret</span><span class=p>)</span>         <span class=o>|</span>
</span></span><span class=line><span class=cl>                          <span class=o>+-------------------+</span>     <span class=o>+-------------------+</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>설명</strong>: 세 부분이 점 (.) 으로 구분되어 하나의 문자열로 합쳐진다 <a href="https://curity.io/resources/learn/jwt-best-practices/?utm_source=chatgpt.com" title="JWT Security Best Practices | Curity">4</a><a href="https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-token-structure?utm_source=chatgpt.com" title="JSON Web Token Structure - Auth0">2</a>.</li></ul><h3 id=69-구현-기법>6.9. 구현 기법<a hidden class=anchor aria-hidden=true href=#69-구현-기법>#</a></h3><ul><li><strong>라이브러리 활용</strong>: PyJWT, jose, jsonwebtoken 등 표준 라이브러리 사용.</li><li><strong>서명 알고리즘 선택</strong>: HMAC(대칭키), RSA/ECDSA(비대칭키).</li><li><strong>클레임 관리</strong>: 표준 클레임 (iss, sub, exp 등) 과 커스텀 클레임 활용.</li><li><strong>토큰 검증</strong>: 서명 검증, 클레임 검증 (iss, aud, exp 등).</li><li><strong>실제 예시</strong>:<ul><li><strong>시스템 구성</strong>: Auth Server(토큰 발급), Resource Server(토큰 검증)</li><li><strong>시나리오</strong>: 로그인 → 토큰 발급 → API 요청 시 토큰 포함 → 토큰 검증 및 리소스 제공 <a href="https://www.geeksforgeeks.org/json-web-token-jwt/?utm_source=chatgpt.com" title="JSON Web Token (JWT) - GeeksforGeeks">6</a><a href="https://jwt.io/introduction?utm_source=chatgpt.com" title="JSON Web Token Introduction - jwt.io">7</a>.</li></ul></li></ul><h3 id=610-장점>6.10. 장점<a hidden class=anchor aria-hidden=true href=#610-장점>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>장점</td><td>Stateless</td><td>서버에 세션 저장 불필요, 확장성 향상</td></tr><tr><td></td><td>Self-contained</td><td>모든 인증 정보가 토큰 내에 포함, DB 조회 불필요</td></tr><tr><td></td><td>Cross-domain</td><td>도메인 간 인증 가능, SPA/모바일 앱에 적합</td></tr><tr><td></td><td>Compact</td><td>HTTP 헤더 등에 쉽게 포함 가능, 네트워크 부하 감소</td></tr><tr><td></td><td>신뢰성</td><td>서명으로 위변조 방지, 신뢰할 수 있는 인증 정보 제공</td></tr></tbody></table><h3 id=611-단점과-문제점-그리고-해결방안>6.11. 단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#611-단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>단점</td><td>Stateless 한계</td><td>토큰 만료 전 강제 폐기 (revoke) 어려움</td><td>짧은 만료 시간, 블랙리스트</td></tr><tr><td></td><td>Payload 노출</td><td>Base64 인코딩만으로 암호화되지 않아 민감정보 노출 위험</td><td>민감정보 포함 금지</td></tr><tr><td></td><td>토큰 크기</td><td>클레임이 많아지면 토큰 크기 증가, 네트워크 부하</td><td>필요한 클레임만 포함</td></tr></tbody></table><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 방법 및 기법</th></tr></thead><tbody><tr><td>문제점</td><td>토큰 탈취</td><td>XSS, CSRF 등 보안 취약점</td><td>인증 우회</td><td>로그 분석, 모니터링</td><td>보안 헤더 적용</td><td>짧은 만료 시간, HTTPS</td></tr><tr><td></td><td>알고리즘 변경 공격</td><td>alg:none 등 취약 알고리즘</td><td>서명 우회</td><td>라이브러리 검증</td><td>알고리즘 강제 지정</td><td>라이브러리 업데이트</td></tr><tr><td></td><td>재생 공격</td><td>토큰 재사용</td><td>인증 우회</td><td>jti 클레임 사용</td><td>일회용 토큰</td><td>jti 클레임 활용</td></tr></tbody></table><h3 id=612-도전-과제>6.12. 도전 과제<a hidden class=anchor aria-hidden=true href=#612-도전-과제>#</a></h3><ul><li><strong>토큰 만료 전 강제 폐기</strong>: Stateless 특성상 실시간 폐기 어려움 → 블랙리스트, 짧은 만료 시간 등 대안 필요.</li><li><strong>대규모 시스템에서의 토큰 관리</strong>: 마이크로서비스 환경에서 토큰 검증 부하 분산 필요.</li><li><strong>보안 취약점 대응</strong>: XSS, CSRF 등 웹 보안 위협에 대한 지속적 대응 필요.</li></ul><h3 id=613-분류-기준에-따른-종류-및-유형>6.13. 분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#613-분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th>분류 기준</th><th>종류/유형</th><th>설명</th></tr></thead><tbody><tr><td>서명 방식</td><td>HMAC, RSA, ECDSA</td><td>대칭키/비대칭키 기반 서명</td></tr><tr><td>암호화 유무</td><td>JWS, JWE</td><td>서명만 (JWS), 암호화 포함 (JWE)</td></tr><tr><td>클레임 타입</td><td>Registered, Public, Private</td><td>표준, 공개, 사설 클레임</td></tr></tbody></table><h3 id=614-실무-사용-예시>6.14. 실무 사용 예시<a hidden class=anchor aria-hidden=true href=#614-실무-사용-예시>#</a></h3><table><thead><tr><th>시스템/목적</th><th>사용 목적</th><th>효과</th></tr></thead><tbody><tr><td>웹/모바일 앱 인증</td><td>사용자 인증/권한 부여</td><td>세션 관리 불필요, 확장성</td></tr><tr><td>API Gateway</td><td>마이크로서비스 인증</td><td>중앙 집중식 인증 관리</td></tr><tr><td>SSO(Single Sign-On)</td><td>다중 시스템 통합 인증</td><td>사용자 편의성, 보안 강화</td></tr></tbody></table><h3 id=615-활용-사례>6.15. 활용 사례<a hidden class=anchor aria-hidden=true href=#615-활용-사례>#</a></h3><p><strong>사례: 마이크로서비스 환경에서의 JWT 활용</strong></p><ul><li><strong>시스템 구성</strong>: Auth Server, API Gateway, Microservices</li><li><strong>워크플로우</strong>:<ol><li>사용자 로그인 → Auth Server 에서 JWT 발급</li><li>클라이언트가 API Gateway 에 JWT 포함 요청</li><li>API Gateway 에서 JWT 검증 후 Microservice 로 요청 전달</li><li>Microservice 는 추가 인증 없이 요청 처리</li></ol></li><li><strong>JWT 역할</strong>: 인증 및 권한 정보 전달, 서버 간 신뢰 구축</li><li><strong>차이점</strong>: JWT 미사용 시 각 서비스별 인증 필요, JWT 사용 시 중앙 집중식 인증 가능 <a href="https://jwt.io/introduction?utm_source=chatgpt.com" title="JSON Web Token Introduction - jwt.io">5</a>.</li></ul><h3 id=616-구현-예시-python>6.16. 구현 예시 (Python)<a hidden class=anchor aria-hidden=true href=#616-구현-예시-python>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>jwt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 비밀키</span>
</span></span><span class=line><span class=cl><span class=n>secret</span> <span class=o>=</span> <span class=s1>&#39;my_super_secret&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># Payload</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;sub&#39;</span><span class=p>:</span> <span class=s1>&#39;user123&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;John Doe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;iat&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;exp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>utcnow</span><span class=p>()</span> <span class=o>+</span> <span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>hours</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1># 토큰 생성</span>
</span></span><span class=line><span class=cl><span class=n>token</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>payload</span><span class=p>,</span> <span class=n>secret</span><span class=p>,</span> <span class=n>algorithm</span><span class=o>=</span><span class=s1>&#39;HS256&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>token</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 토큰 검증</span>
</span></span><span class=line><span class=cl><span class=n>decoded</span> <span class=o>=</span> <span class=n>jwt</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=n>secret</span><span class=p>,</span> <span class=n>algorithms</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;HS256&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>decoded</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>설명</strong>: PyJWT 라이브러리를 활용해 JWT 생성 및 검증 예시 <a href="https://dev.to/jaypmedia/jwt-explained-in-4-minutes-with-visuals-g3n?utm_source=chatgpt.com" title="JWT explained in 4 minutes (With Visuals) - DEV Community">9</a><a href="https://de.wikipedia.org/wiki/JSON_Web_Token?utm_source=chatgpt.com" title="JSON Web Token">11</a>.</li></ul><h3 id=617-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>6.17. 실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#617-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>항목</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>토큰 만료 시간</td><td>너무 길면 보안 위험, 너무 짧으면 사용자 불편</td><td>1 시간 내외 권장</td></tr><tr><td>민감정보 포함 금지</td><td>Payload 는 Base64 인코딩만으로 암호화되지 않음</td><td>민감정보 포함 금지</td></tr><tr><td>서명 알고리즘 강제</td><td>alg:none 등 취약 알고리즘 방지</td><td>알고리즘 강제 지정</td></tr><tr><td>HTTPS 사용</td><td>토큰 탈취 방지</td><td>반드시 HTTPS 사용</td></tr><tr><td>라이브러리 업데이트</td><td>보안 취약점 대응</td><td>최신 버전 유지</td></tr></tbody></table><h3 id=618-최적화하기-위한-고려사항-및-주의할-점>6.18. 최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#618-최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>항목</th><th>설명</th><th>권장사항</th></tr></thead><tbody><tr><td>클레임 최소화</td><td>불필요한 클레임 포함 금지</td><td>필요한 클레임만 포함</td></tr><tr><td>토큰 크기 관리</td><td>클레임이 많아지면 네트워크 부하</td><td>클레임 최소화</td></tr><tr><td>검증 부하 분산</td><td>대규모 시스템에서 토큰 검증 부하 분산</td><td>API Gateway 에서 검증</td></tr><tr><td>짧은 만료 시간</td><td>보안 강화</td><td>1 시간 내외 권장</td></tr></tbody></table><hr><h2 id=7-기타-사항>7. 기타 사항<a hidden class=anchor aria-hidden=true href=#7-기타-사항>#</a></h2><ul><li><strong>JWT vs OAuth</strong>: JWT 는 토큰 형식, OAuth 는 인증/권한 부여 프로토콜로, 함께 사용 가능 <a href="https://dekh.medium.com/the-complete-guide-to-json-web-tokens-jwt-and-token-based-authentication-32501cb5125c?utm_source=chatgpt.com" title="The Complete Guide to JSON Web Tokens (JWT) and Token Based …">1</a>.</li><li><strong>JWT 암호화</strong>: JWS(서명만), JWE(암호화 포함) 로 구분.</li><li><strong>실무 적용 시</strong>: 마이크로서비스, SPA, 모바일 앱 등에서 널리 사용.</li></ul><hr><h2 id=8-주제와-관련하여-주목할-내용>8. 주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#8-주제와-관련하여-주목할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>보안</td><td>JWT</td><td>서명/암호화</td><td>HMAC, RSA, ECDSA 등 다양한 알고리즘</td></tr><tr><td>아키텍처</td><td>JWT</td><td>Stateless</td><td>서버 세션 불필요, 확장성</td></tr><tr><td>실무 적용</td><td>JWT</td><td>마이크로서비스</td><td>중앙 집중식 인증, 서버 간 신뢰 구축</td></tr><tr><td>표준</td><td>JWT</td><td>RFC 7519</td><td>공식 표준 문서</td></tr></tbody></table><hr><h2 id=9-반드시-학습해야할-내용>9. 반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#9-반드시-학습해야할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>보안</td><td>JWT</td><td>서명/암호화</td><td>HMAC, RSA, ECDSA 등 알고리즘 이해</td></tr><tr><td>표준</td><td>JWT</td><td>RFC 7519</td><td>공식 표준 문서 학습</td></tr><tr><td>실무</td><td>JWT</td><td>라이브러리 활용</td><td>PyJWT, jose 등 라이브러리 사용법</td></tr><tr><td>아키텍처</td><td>JWT</td><td>Stateless</td><td>서버 세션 불필요, 확장성 이해</td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>표준</td><td>RFC 7519</td><td>JWT 공식 표준 문서</td></tr><tr><td>보안</td><td>HMAC</td><td>해시 기반 메시지 인증 코드</td></tr><tr><td>보안</td><td>RSA</td><td>비대칭키 암호화 알고리즘</td></tr><tr><td>보안</td><td>ECDSA</td><td>타원곡선 디지털 서명 알고리즘</td></tr><tr><td>아키텍처</td><td>Stateless</td><td>서버에 상태 저장 불필요</td></tr><tr><td>실무</td><td>PyJWT</td><td>Python JWT 라이브러리</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://www.scalekit.com/blog/json-web-tokens-guide-for-developers>JWT 구조 및 설명 - Scalekit</a><a href="https://en.wikipedia.org/wiki/JSON_Web_Token?utm_source=chatgpt.com" title="JSON Web Token">4</a></li><li><a href=https://www.vaadata.com/blog/jwt-json-web-token-vulnerabilities-common-attacks-and-security-best-practices/>JWT 보안 및 구현 가이드 - Vaadata</a>[12]</li><li><a href=https://supertokens.com/blog/oauth-vs-jwt>OAuth vs JWT 비교 - SuperTokens</a><a href="https://dekh.medium.com/the-complete-guide-to-json-web-tokens-jwt-and-token-based-authentication-32501cb5125c?utm_source=chatgpt.com" title="The Complete Guide to JSON Web Tokens (JWT) and Token Based …">1</a></li><li><a href=https://dev.to/jaypmedia/jwt-explained-in-4-minutes-with-visuals-g3n>JWT 구조 및 예시 - DEV Community</a><a href="https://curity.io/resources/learn/jwt-best-practices/?utm_source=chatgpt.com" title="JWT Security Best Practices | Curity">8</a></li><li><a href=https://www.loginradius.com/blog/engineering/guide-to-jwt>JWT 구조 및 클레임 - LoginRadius</a>[13]</li><li><a href=https://dev.to/stringintech/understanding-jwt-authentication-spring-securitys-architecture-and-go-implementation-edk>JWT 인증 흐름 - Spring Security/Go 예시</a><a href="https://frontegg.com/guides/jwt-authorization?utm_source=chatgpt.com" title="​JWT Authorization: How It Works & Implementation Guide - Frontegg">6</a></li><li><a href=https://www.tencentcloud.com/techpedia/101727>JWT 구조 및 예시 - Tencent Cloud</a>[14]</li><li><a href=https://auth0.com/blog/how-to-handle-jwt-in-python/>PyJWT 사용법 - Auth0</a><a href="https://es.wikipedia.org/wiki/JSON_Web_Token?utm_source=chatgpt.com" title="JSON Web Token">9</a></li><li><a href=https://github.com/msatyan/JWT_JS_Demo>JavaScript JWT 구현 예시 - GitHub</a>[15]</li><li><a href=https://github.com/TBMSP/Simple-JWT>PHP JWT 구현 예시 - GitHub</a>[16]</li><li><a href=https://jwt.io/introduction>JWT 공식 소개 - jwt.io</a><a href="https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-token-structure?utm_source=chatgpt.com" title="JSON Web Token Structure - Auth0">2</a></li><li><a href=https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-token-structure>JWT 구조 - Auth0 Docs</a>[17]</li><li><a href=https://support.huaweicloud.com/eu/es-es/usermanual-asm/asm_01_0096.html>JWT 인증 원리 - Huawei Cloud</a><a href="https://www.geeksforgeeks.org/json-web-token-jwt/?utm_source=chatgpt.com" title="JSON Web Token (JWT) - GeeksforGeeks">5</a></li><li><a href=https://pyjwt.readthedocs.io/en/latest/usage.html>PyJWT 공식 문서 - Read the Docs</a><a href="https://dev.to/jaypmedia/jwt-explained-in-4-minutes-with-visuals-g3n?utm_source=chatgpt.com" title="JWT explained in 4 minutes (With Visuals) - DEV Community">10</a></li><li><a href=https://support.pdfgeneratorapi.com/en/article/how-to-create-json-web-token-with-javascript-nk6w4b/>JavaScript JWT 생성 - PDF Generator API</a>[18]</li><li><a href=https://www.descope.com/learn/post/jwt>JWT 작동 원리 - Descope</a><a href="https://www.ibm.com/docs/en/cics-ts/6.x?topic=cics-json-web-token-jwt&amp;utm_source=chatgpt.com" title="JSON Web Token (JWT) - IBM">3</a></li><li><a href=https://dzone.com/articles/jwt-authentication-and-authorization-a-detailed-introduction>JWT 인증 및 권한 부여 - DZone</a><a href="https://jwt.io/introduction?utm_source=chatgpt.com" title="JSON Web Token Introduction - jwt.io">7</a></li><li><a href=https://workos.com/blog/how-to-handle-jwt-in-python>Python JWT 생성 및 검증 - WorkOS</a><a href="https://de.wikipedia.org/wiki/JSON_Web_Token?utm_source=chatgpt.com" title="JSON Web Token">11</a></li><li><a href=https://supertokens.com/blog/what-is-jwt>JWT 구조 및 클레임 - SuperTokens</a>[19]</li></ul><hr><h2 id=-1-topic-tags>🏷️ 1. Topic Tags<a hidden class=anchor aria-hidden=true href=#-1-topic-tags>#</a></h2><p><code>Token-Based-Authentication</code><br><code>Access-Control</code><br><code>JSON-Web-Token</code><br><code>Stateless-Sessions</code></p><hr><h2 id=2-classification-hierarchy-validity>2. Classification Hierarchy Validity<a hidden class=anchor aria-hidden=true href=#2-classification-hierarchy-validity>#</a></h2><p>The categorization—<em>Computer Science and Engineering > Cybersecurity and Information Security > Access Control > Implementations > Token-Based Authentication</em>—is appropriate. JWT sits precisely under &ldquo;Token-Based Authentication&rdquo; as a stateless token mechanism for access control. It aligns with industry classification of auth methods, no adjustments needed.</p><hr><h2 id=3-concise-description-200-자>3. Concise Description (~200 자)<a hidden class=anchor aria-hidden=true href=#3-concise-description-200-자>#</a></h2><p>JWT(JSON Web Token) 는 헤더 (header), 페이로드 (payload), 서명 (signature) 로 구성된 <strong>자체 포함형 (stateless)</strong> 토큰으로, 클라이언트 - 서버 간 인증 및 권한 정보를 안전하게 전달하고 검증하는 데 사용되며, 세션 저장 없이 유효 시간 (exp), 발급자 (iss), 수신자 (aud) 등의 클레임을 포함합니다.</p><hr><h2 id=4-overview-250-자>4. Overview (~250 자)<a hidden class=anchor aria-hidden=true href=#4-overview-250-자>#</a></h2><p>JSON Web Token(JWT) 는 RFC 7519 에 따라 정의된 URL-safe 한 JSON 기반 토큰 형식으로, HMAC 또는 RSA/ECDSA 로 서명된 자체 포함형 JWS 혹은 암호화된 JWE 형태로 제공됩니다. 헤더에는 타입과 알고리즘, 페이로드에는 표준 및 사용자 정의 클레임, 서명으로 무결성을 보장하며, OAuth2 및 SSO, 마이크로서비스 간 인증에 널리 이용됩니다. 세션 저장이 필요 없는 stateless 방식으로, 확장성과 분산 시스템에 유리하나 만료, 탈취 그리고 revocation 등의 보안 이슈 발생 가능성을 가지고 있어 적절한 설계와 키 관리가 필수적입니다.</p><hr><h2 id=5-핵심-개념-1>5. 핵심 개념<a hidden class=anchor aria-hidden=true href=#5-핵심-개념-1>#</a></h2><ul><li><p><strong>JWT 구조</strong>:</p><ol><li>헤더 (Header): <code>{"alg":"HS256","typ":"JWT"}</code> 등 암호 알고리즘 및 토큰 타입 정의 (<a href="https://dekh.medium.com/the-complete-guide-to-json-web-tokens-jwt-and-token-based-authentication-32501cb5125c?utm_source=chatgpt.com" title="The Complete Guide to JSON Web Tokens (JWT) and Token Based …">dekh.medium.com</a>, <a href="https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-token-structure?utm_source=chatgpt.com" title="JSON Web Token Structure - Auth0">auth0.com</a>, <a href="https://www.ibm.com/docs/en/cics-ts/6.x?topic=cics-json-web-token-jwt&amp;utm_source=chatgpt.com" title="JSON Web Token (JWT) - IBM">ibm.com</a>)</li><li>페이로드 (Payload): <code>iss</code>, <code>sub</code>, <code>aud</code>, <code>exp</code>, <code>nbf</code>, <code>iat</code>, <code>jti</code> 등의 표준 및 커스텀 클레임 (<a href="https://en.wikipedia.org/wiki/JSON_Web_Token?utm_source=chatgpt.com" title="JSON Web Token">en.wikipedia.org</a>)</li><li>서명 (Signature): Base64Url(header).Base64Url(payload) 를 비밀 키 또는 개인 키로 HMAC/RSA/ECDSA 서명 (<a href="https://www.geeksforgeeks.org/json-web-token-jwt/?utm_source=chatgpt.com" title="JSON Web Token (JWT) - GeeksforGeeks">geeksforgeeks.org</a>)</li></ol></li><li><p><strong>서명 방식</strong>:<br>HS256/384/512 (공유 비밀, symmetric), RS256/384/512 (비대칭 RSA), ES256/384/512 (ECDSA), PSxxx 및 none(잘못된 사용)</p></li><li><p><strong>Stateless 특성</strong>:<br>서버에 세션 저장 없이 자체 포함된 토큰으로 인증 가능 (<a href="https://frontegg.com/guides/jwt-authorization?utm_source=chatgpt.com" title="​JWT Authorization: How It Works & Implementation Guide - Frontegg">frontegg.com</a>)</p></li><li><p><strong>인증 vs 서명 검증</strong>:</p><ul><li><strong>Validation</strong>(형식 및 클레임 체크, exp 등)</li><li><strong>Verification</strong>(서명 검증, <code>iss</code>, <code>aud</code> 확인) (<a href="https://jwt.io/introduction?utm_source=chatgpt.com" title="JSON Web Token Introduction - jwt.io">jwt.io</a>)</li></ul></li></ul><p><strong>실무 연관성</strong><br>구현 시 라이브러리 (jwt.io, Auth0, PyJWT 등) 사용, <code>alg=none</code> 취약 방지, 충분한 키 길이, 리프레시 토큰 설계, HTTPS 전송이 필수적입니다.</p><hr><h2 id=6-주요-조사-내용-정리>6. 주요 조사 내용 정리<a hidden class=anchor aria-hidden=true href=#6-주요-조사-내용-정리>#</a></h2><p>주요 항목은 5 번에서 포괄했으며, 추가로 다음 항목을 다룹니다.</p><hr><h2 id=7-추가-조사-내용>7. 추가 조사 내용<a hidden class=anchor aria-hidden=true href=#7-추가-조사-내용>#</a></h2><ul><li><strong>JWE(암호화 토큰)</strong>: 암호화된 형태의 JWT 로, 서명 외에 암호화 키 (key), IV, ciphertext, 인증태그 포함. 민감한 데이터 전송 시 사용 (<a href="https://en.wikipedia.org/wiki/JSON_Web_Token?utm_source=chatgpt.com" title="JSON Web Token">en.wikipedia.org</a>, <a href="https://curity.io/resources/learn/jwt-best-practices/?utm_source=chatgpt.com" title="JWT Security Best Practices | Curity">curity.io</a>)</li><li><strong>취약점 요약</strong>:<ul><li><code>alg=none</code> 공격</li><li>잘못된 알고리즘 선택 (weak key, curve)</li><li>토큰 탈취 및 revocation 한계</li></ul></li></ul><hr><h2 id=8-주목할-내용-요약>8. 주목할 내용 요약<a hidden class=anchor aria-hidden=true href=#8-주목할-내용-요약>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>구조</td><td>Header-Payload-Signature</td><td>JWT 세 부분</td><td>URL-safe, Base64Url 인코딩된 형식</td></tr><tr><td>보안</td><td>Validation vs Verification</td><td>처리 차이</td><td>유효성 체크 vs 서명 및 발급자/수신자 검사</td></tr><tr><td>형태</td><td>JWS vs JWE</td><td>Signed vs Encrypted</td><td>무결성만 vs 기밀성 + 무결성</td></tr></tbody></table><hr><h2 id=9-반드시-학습해야할-내용-1>9. 반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#9-반드시-학습해야할-내용-1>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>키 관리</td><td>Symmetric vs Asymmetric</td><td>HS256, RS256 등</td><td>키 형식과 운영 방식 이해</td></tr><tr><td>표준</td><td>RFC 7519, 7515, 7516</td><td>JWS/JWE/JWA</td><td>JWT 및 JOSE 관련 표준 문서</td></tr><tr><td>라이브러리 보안</td><td>JWT 라이브러리 취약점</td><td>alg=none 등</td><td>구현 시 주요 보안 위험 요소</td></tr></tbody></table><hr><h2 id=-용어-정리>🔚 용어 정리<a hidden class=anchor aria-hidden=true href=#-용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>구조</td><td>Base64Url</td><td>URL-safe Base64 인코딩 방식</td></tr><tr><td>클레임</td><td>exp, iat, iss, aud</td><td>토큰의 유효 기간, 발급 시각, 발급자, 수신자 정보</td></tr><tr><td>표준</td><td>JWS, JWE</td><td>JSON Signature vs Encryption</td></tr><tr><td>공격</td><td>alg=none 공격</td><td>서명 없이 공격자가 토큰 위조 가능</td></tr></tbody></table><hr><h2 id=-참고-및-출처>📚 참고 및 출처<a hidden class=anchor aria-hidden=true href=#-참고-및-출처>#</a></h2><ul><li>JWT.io Introduction (<a href="https://jwt.io/introduction?utm_source=chatgpt.com" title="JSON Web Token Introduction - jwt.io">jwt.io</a>, <a href="https://es.wikipedia.org/wiki/JSON_Web_Token?utm_source=chatgpt.com" title="JSON Web Token">es.wikipedia.org</a>, <a href="https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-token-structure?utm_source=chatgpt.com" title="JSON Web Token Structure - Auth0">auth0.com</a>, <a href="https://dev.to/jaypmedia/jwt-explained-in-4-minutes-with-visuals-g3n?utm_source=chatgpt.com" title="JWT explained in 4 minutes (With Visuals) - DEV Community">dev.to</a>, <a href="https://de.wikipedia.org/wiki/JSON_Web_Token?utm_source=chatgpt.com" title="JSON Web Token">de.wikipedia.org</a>)</li><li>JWT 구조, 서명 방식</li><li>Stateless 인증, OAuth2/SO 용도</li><li>JWE 및 보안 취약점</li><li>RFC 및 구현 라이브러리 언급</li></ul><hr><p>추가로 심화된 구조 다이어그램, 구현 예제, 장단점 분석, 실무 활용 케이스 등 단계별 분석이 필요할 경우 말씀해주세요!</p><p>아래는 JWT 에 대한 보다 심화된 분석입니다.</p><hr><h2 id=-구조-및-아키텍처-구성-요소-포함>🧠 구조 및 아키텍처 (구성 요소 포함)<a hidden class=anchor aria-hidden=true href=#-구조-및-아키텍처-구성-요소-포함>#</a></h2><h3 id=다이어그램-mermaid>다이어그램 (Mermaid)<a hidden class=anchor aria-hidden=true href=#다이어그램-mermaid>#</a></h3><pre class=mermaid>flowchart TD
  A[Client] --&gt;|로그인 요청| B[Auth Server]
  B --&gt;|JWT 발급| A
  A --&gt;|Authorization: Bearer JWT| C[Resource Server]
  C --&gt;|서명 검증 + 클레임 검사| BPK[Auth Server Public Key 또는 Shared Secret]
  C --&gt;|응답| A
</pre><h3 id=구성-요소-및-역할>구성 요소 및 역할<a hidden class=anchor aria-hidden=true href=#구성-요소-및-역할>#</a></h3><ul><li><strong>Client</strong>: 토큰 저장 (예: HTTP-only 쿠키, localStorage) 및 요청 헤더 포함</li><li><strong>Auth Server</strong>: 로그인 처리 → JWT 생성 (Header·Payload·Signature) → 발급</li><li><strong>Resource Server</strong>: JWT 서명 검증, <code>iss</code>, <code>aud</code>, <code>exp</code> 등 클레임 확인 후 리소스 제공</li><li><strong>Key Store</strong>:<ul><li>대칭키 (HS256): 인증서버와 리소스 서버 간 공유 (secret)</li><li>비대칭키 (RS/ES256): 인증 서버가 private key 로 서명, 다른 서비스는 public key 로 검증</li></ul></li></ul><hr><h2 id=-주요-원리--작동-원리>✅ 주요 원리 & 작동 원리<a hidden class=anchor aria-hidden=true href=#-주요-원리--작동-원리>#</a></h2><h3 id=jwt-생성과-검증-과정>JWT 생성과 검증 과정<a hidden class=anchor aria-hidden=true href=#jwt-생성과-검증-과정>#</a></h3><ul><li><p><strong>인코딩</strong>: 헤더와 페이로드를 Base64Url 인코딩, <code>.</code> 으로 연결</p></li><li><p><strong>서명</strong>: <code>(base64Url(header) + "." + base64Url(payload))</code> → HMAC/RSA/ECDSA 로 서명 (<a href="https://dekh.medium.com/the-complete-guide-to-json-web-tokens-jwt-and-token-based-authentication-32501cb5125c?utm_source=chatgpt.com" title="The Complete Guide to JSON Web Tokens (JWT) and Token Based …">jwt.io</a>, <a href="https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-token-structure?utm_source=chatgpt.com" title="JSON Web Token Structure - Auth0">auth0.com</a>, <a href="https://www.ibm.com/docs/en/cics-ts/6.x?topic=cics-json-web-token-jwt&amp;utm_source=chatgpt.com" title="JSON Web Token (JWT) - IBM">dev.to</a>, <a href="https://en.wikipedia.org/wiki/JSON_Web_Token?utm_source=chatgpt.com" title="JSON Web Token">geeksforgeeks.org</a>, <a href="https://www.geeksforgeeks.org/json-web-token-jwt/?utm_source=chatgpt.com" title="JSON Web Token (JWT) - GeeksforGeeks">es.wikipedia.org</a>)</p></li><li><p><strong>검증</strong>:</p><ol><li>헤더·페이로드 디코딩</li><li>서명 재계산 및 비교</li><li><code>exp</code>, <code>iss</code>, <code>aud</code> 등의 클레임 유효성 검증</li></ol></li></ul><hr><h2 id=-장점--단점>📊 장점 & 단점<a hidden class=anchor aria-hidden=true href=#-장점--단점>#</a></h2><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>장점</td><td>Stateless 구조</td><td>서버 세션 상태 저장 불필요, 확장성 우수 (<a href="https://frontegg.com/guides/jwt-authorization?utm_source=chatgpt.com" title="​JWT Authorization: How It Works & Implementation Guide - Frontegg">vaadata.com</a>)</td></tr><tr><td>장점</td><td>Interoperability</td><td>다양한 플랫폼 간 인증 정보 공유 용이</td></tr><tr><td>장점</td><td>Self-contained</td><td>클레임에 모든 인증·권한 정보 포함, 별도 조회 불필요</td></tr><tr><td>장점</td><td>Compact</td><td>URL-safe, 크기가 작아 HTTP 헤더에 효율적</td></tr></tbody></table><h3 id=단점-및-해결책>단점 및 해결책<a hidden class=anchor aria-hidden=true href=#단점-및-해결책>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>단점</td><td>Non-revocable</td><td>만료 전 취소 어려움 (stateless 특성) (<a href="https://jwt.io/introduction?utm_source=chatgpt.com" title="JSON Web Token Introduction - jwt.io">supertokens.com</a>)</td><td>짧은 access token TTL + 서버 저장형 refresh token 도입</td></tr><tr><td>단점</td><td>키 탈취 위험</td><td>비밀키 누출 시 위조 가능</td><td>KID 기반 키 로테이션 및 HSM 활용</td></tr><tr><td>단점</td><td>토큰 크기 제한</td><td>페이로드 큰 경우 HTTP 헤더 제한 초과 가능</td><td>포함 클레임 최소화</td></tr><tr><td>단점</td><td>alg Attack 취약성</td><td>악성 <code>alg=none</code>, 헤더 조작 등</td><td>서버 측 알고리즘 고정 정책 및 검증 강화</td></tr></tbody></table><hr><h2 id=-분류-기준에-따른-유형>🧩 분류 기준에 따른 유형<a hidden class=anchor aria-hidden=true href=#-분류-기준에-따른-유형>#</a></h2><table><thead><tr><th>분류 기준</th><th>유형</th><th>설명</th></tr></thead><tbody><tr><td>서명 방식</td><td>JWS(Signature)</td><td>HMAC/RS/ES 계열로 서명된 토큰</td></tr><tr><td></td><td>JWE(Encrypted)</td><td>암호화 포함, 기밀성 보장 (<a href="https://curity.io/resources/learn/jwt-best-practices/?utm_source=chatgpt.com" title="JWT Security Best Practices | Curity">curity.io</a>)</td></tr><tr><td>대칭/비대칭 키</td><td>HSxxx (대칭)</td><td>하나의 secret 공유</td></tr><tr><td></td><td>RSxxx / ESxxx (비대칭)</td><td>private/public key 분리</td></tr><tr><td>사용 목적</td><td>Access Token</td><td>리소스 접근 제어에 사용</td></tr><tr><td></td><td>Refresh Token</td><td>Access 토큰 재발급 목적으로 opaque 형태 저장</td></tr></tbody></table><hr><h2 id=-실무-사용--구현-예시>🛠️ 실무 사용 & 구현 예시<a hidden class=anchor aria-hidden=true href=#-실무-사용--구현-예시>#</a></h2><h3 id=사용-예시-표>사용 예시 표<a hidden class=anchor aria-hidden=true href=#사용-예시-표>#</a></h3><table><thead><tr><th>시스템 구성</th><th>목적</th><th>효과</th></tr></thead><tbody><tr><td>SPA + 백엔드 (REST API)</td><td>로그인 → JWT 발급</td><td>무상태 인증, 인증 부하 감소</td></tr><tr><td>마이크로서비스 아키텍처</td><td>서비스 간 인증</td><td>인증 서버 - 자원 서버 분리 및 확장성 개선</td></tr><tr><td>OAuth2 / OpenID Connect</td><td>SSO 구현</td><td>ID Token 으로 사용자 정보 전달</td></tr></tbody></table><h3 id=활용-사례마이크로서비스>활용 사례–마이크로서비스<a hidden class=anchor aria-hidden=true href=#활용-사례마이크로서비스>#</a></h3><ul><li><p><strong>시스템 구성도</strong>: 인증서버, API 게이트웨이, Service A/B, Redis(리프레시 토큰 저장)</p></li><li><p><strong>워크플로우</strong>:</p><ol><li>사용자 로그인 → 인증서버가 JWT(access, refresh) 발급</li><li>프론트엔드가 JWT 를 전송</li><li>API 게이트웨이가 JWT 서명 + <code>aud</code>, <code>iss</code> 검증, 서비스 라우팅</li><li>서비스 내부는 별도 인증 없이 클레임 기준 권한 판단</li></ol></li></ul><h4 id=with-jwt-vs-without-jwt>With JWT Vs Without JWT<a hidden class=anchor aria-hidden=true href=#with-jwt-vs-without-jwt>#</a></h4><ul><li><strong>With</strong>: 각 서비스가 인증서 백엔드 상태 의존하지 않고 자체 검증 → 높은 응답성</li><li><strong>Without</strong>: 모든 요청마다 인증서 검증 호출 → 병목 및 부하 증가</li></ul><hr><h2 id=-구현-예시-nodejsexpress--jsonwebtoken>🧪 구현 예시 (Node.js–Express + jsonwebtoken)<a hidden class=anchor aria-hidden=true href=#-구현-예시-nodejsexpress--jsonwebtoken>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span><span class=lnt id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a>
</span><span class=lnt id=hl-4-19><a class=lnlinks href=#hl-4-19>19</a>
</span><span class=lnt id=hl-4-20><a class=lnlinks href=#hl-4-20>20</a>
</span><span class=lnt id=hl-4-21><a class=lnlinks href=#hl-4-21>21</a>
</span><span class=lnt id=hl-4-22><a class=lnlinks href=#hl-4-22>22</a>
</span><span class=lnt id=hl-4-23><a class=lnlinks href=#hl-4-23>23</a>
</span><span class=lnt id=hl-4-24><a class=lnlinks href=#hl-4-24>24</a>
</span><span class=lnt id=hl-4-25><a class=lnlinks href=#hl-4-25>25</a>
</span><span class=lnt id=hl-4-26><a class=lnlinks href=#hl-4-26>26</a>
</span><span class=lnt id=hl-4-27><a class=lnlinks href=#hl-4-27>27</a>
</span><span class=lnt id=hl-4-28><a class=lnlinks href=#hl-4-28>28</a>
</span><span class=lnt id=hl-4-29><a class=lnlinks href=#hl-4-29>29</a>
</span><span class=lnt id=hl-4-30><a class=lnlinks href=#hl-4-30>30</a>
</span><span class=lnt id=hl-4-31><a class=lnlinks href=#hl-4-31>31</a>
</span><span class=lnt id=hl-4-32><a class=lnlinks href=#hl-4-32>32</a>
</span><span class=lnt id=hl-4-33><a class=lnlinks href=#hl-4-33>33</a>
</span><span class=lnt id=hl-4-34><a class=lnlinks href=#hl-4-34>34</a>
</span><span class=lnt id=hl-4-35><a class=lnlinks href=#hl-4-35>35</a>
</span><span class=lnt id=hl-4-36><a class=lnlinks href=#hl-4-36>36</a>
</span><span class=lnt id=hl-4-37><a class=lnlinks href=#hl-4-37>37</a>
</span><span class=lnt id=hl-4-38><a class=lnlinks href=#hl-4-38>38</a>
</span><span class=lnt id=hl-4-39><a class=lnlinks href=#hl-4-39>39</a>
</span><span class=lnt id=hl-4-40><a class=lnlinks href=#hl-4-40>40</a>
</span><span class=lnt id=hl-4-41><a class=lnlinks href=#hl-4-41>41</a>
</span><span class=lnt id=hl-4-42><a class=lnlinks href=#hl-4-42>42</a>
</span><span class=lnt id=hl-4-43><a class=lnlinks href=#hl-4-43>43</a>
</span><span class=lnt id=hl-4-44><a class=lnlinks href=#hl-4-44>44</a>
</span><span class=lnt id=hl-4-45><a class=lnlinks href=#hl-4-45>45</a>
</span><span class=lnt id=hl-4-46><a class=lnlinks href=#hl-4-46>46</a>
</span><span class=lnt id=hl-4-47><a class=lnlinks href=#hl-4-47>47</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>jwt</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;jsonwebtoken&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>bodyParser</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;body-parser&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>bodyParser</span><span class=p>.</span><span class=nx>json</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>SECRET</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>JWT_SECRET</span> <span class=o>||</span> <span class=s1>&#39;supersecret&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>ACCESS_EXPIRES</span> <span class=o>=</span> <span class=s1>&#39;15m&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>REFRESH_EXPIRES</span> <span class=o>=</span> <span class=s1>&#39;7d&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 로그인 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span><span class=nx>userId</span><span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>accessToken</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>({</span> <span class=nx>sub</span><span class=o>:</span> <span class=nx>userId</span><span class=p>,</span> <span class=nx>role</span><span class=o>:</span> <span class=s1>&#39;user&#39;</span> <span class=p>},</span> <span class=nx>SECRET</span><span class=p>,</span> <span class=p>{</span> <span class=nx>expiresIn</span><span class=o>:</span> <span class=nx>ACCESS_EXPIRES</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>refreshToken</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>({</span> <span class=nx>sub</span><span class=o>:</span> <span class=nx>userId</span> <span class=p>},</span> <span class=nx>SECRET</span><span class=p>,</span> <span class=p>{</span> <span class=nx>expiresIn</span><span class=o>:</span> <span class=nx>REFRESH_EXPIRES</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 리프레시 토큰은 httpOnly 쿠키로 전송
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>res</span><span class=p>.</span><span class=nx>cookie</span><span class=p>(</span><span class=s1>&#39;refreshToken&#39;</span><span class=p>,</span> <span class=nx>refreshToken</span><span class=p>,</span> <span class=p>{</span> <span class=nx>httpOnly</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=nx>secure</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span> <span class=nx>accessToken</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 보호된 자원
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/profile&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>auth</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>authorization</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>auth</span><span class=p>)</span> <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>auth</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>payload</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>token</span><span class=p>,</span> <span class=nx>SECRET</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span> <span class=nx>userId</span><span class=o>:</span> <span class=nx>payload</span><span class=p>.</span><span class=nx>sub</span><span class=p>,</span> <span class=nx>role</span><span class=o>:</span> <span class=nx>payload</span><span class=p>.</span><span class=nx>role</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>catch</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Invalid or expired token&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 리프레시 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/refresh&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>rt</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>cookies</span><span class=p>.</span><span class=nx>refreshToken</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>payload</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>rt</span><span class=p>,</span> <span class=nx>SECRET</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>newAccess</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>({</span> <span class=nx>sub</span><span class=o>:</span> <span class=nx>payload</span><span class=p>.</span><span class=nx>sub</span><span class=p>,</span> <span class=nx>role</span><span class=o>:</span> <span class=s1>&#39;user&#39;</span> <span class=p>},</span> <span class=nx>SECRET</span><span class=p>,</span> <span class=p>{</span> <span class=nx>expiresIn</span><span class=o>:</span> <span class=nx>ACCESS_EXPIRES</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span> <span class=nx>accessToken</span><span class=o>:</span> <span class=nx>newAccess</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>catch</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>403</span><span class=p>).</span><span class=nx>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=mi>3000</span><span class=p>,</span> <span class=p>()=&gt;</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Server running&#39;</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><hr><h3 id=요약>요약<a hidden class=anchor aria-hidden=true href=#요약>#</a></h3><p>JWT 는 인증 및 권한 정보를 안전하게 전송하기 위한 편리하고 확장성있는 방식이나, 키 관리, 클레임 최소화, 토큰 만료/취소 전략, 암호화 여부 등을 신중하게 설계해야 합니다. 추가 다이어그램, 최적화, 보안 전략 등이 필요하시면 언제든 요청 바랍니다 😊</p><hr><h2 id=-단점과-문제점--해결방안>🛑 단점과 문제점 & 해결방안<a hidden class=anchor aria-hidden=true href=#-단점과-문제점--해결방안>#</a></h2><h3 id=단점-1>단점<a hidden class=anchor aria-hidden=true href=#단점-1>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>단점</td><td>Non‑revocable (취소 불가능)</td><td>Stateless 특성으로 access token 은 취소 어려움</td><td>짧은 TTL 설정 + 서버 저장형 refresh token 사용</td></tr><tr><td></td><td>토큰 탈취 위험</td><td>브라우저 저장소 노출 가능성 → 탈취 시 모든 서비스 접근 가능</td><td>httpOnly 쿠키, TLS 전송, CORS 설정 강화</td></tr><tr><td></td><td>키 관리 복잡성</td><td>키 교체 시 기존 토큰 유효성 문제 발생</td><td>키 ID(KID) 포함 및 키 로테이션 정책 수립</td></tr><tr><td></td><td>alg 공격 취약성</td><td><code>alg=none</code>, 헤더 조작 등 공격에 노출 가능</td><td>알고리즘 고정, 라이브러리 검증 강화, alg 검증 로직 구현</td></tr></tbody></table><h3 id=문제점-심화-분석>문제점 (심화 분석)<a hidden class=anchor aria-hidden=true href=#문제점-심화-분석>#</a></h3><table><thead><tr><th>구분</th><th>항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 방법 및 기법</th></tr></thead><tbody><tr><td>문제점</td><td>중간자 (MITM) 공격</td><td>TLS 미사용 또는 취약한 HTTPS 구성</td><td>토큰 유출 및 변조 가능</td><td>HTTPS 검사, 패킷 분석 경보</td><td>TLS 전송 강제, HSTS 적용</td><td>모든 클라이언트 통신 HTTPS 로 전환</td></tr><tr><td></td><td>탈취된 refresh token 재사용</td><td>refresh token 유효기간 또는 동시사용 허용</td><td>사용자 계정 탈취 및 장기 접근 가능</td><td>비정상 refresh 기록 모니터링</td><td>refresh token 회전 (rotation), 단회성</td><td>토큰 사용 시마다 새 refresh 발급 및 이전 만료</td></tr><tr><td></td><td>리플레이 공격</td><td>동일 token 반복 사용</td><td>권한 없는 요청 수행</td><td>로그 분석, 요청 재사용 탐지</td><td>Nonce 나 jti 활용</td><td>토큰에 jti, nonce 포함 및 서버 블랙리스트</td></tr><tr><td></td><td>클레임 변조 공격</td><td>header/payload 위조 시 검증 소홀</td><td>권한 우회 및 데이터 위변조</td><td>이상 payload 탐지 시스템</td><td>서명 검증 강화</td><td>서명 이후 payload 검사 실패 시 즉시 거부</td></tr></tbody></table><hr><h2 id=-도전-과제-challenges>🎯 도전 과제 (Challenges)<a hidden class=anchor aria-hidden=true href=#-도전-과제-challenges>#</a></h2><ul><li><strong>Refresh 토큰 저장 및 스토리지 확장</strong>: 보안을 유지하면서 확장 가능한 저장소 필요</li><li><strong>JWT 크기 최적화</strong>: 클레임 수와 길이 조절로 HTTP 헤더 길이 제한 고려</li><li><strong>분산된 공개키 (Public Key) 관리</strong>: 마이크로서비스 환경에서 인증 서버 변경 감지 및 호환 유지</li><li><strong>권한 변경 시 토큰 반영 지연</strong>: 기존 토큰에 클레임이 고정되어 있기 때문에 즉각 반영 어려움</li><li><strong>암호화된 JWE 지원 부담</strong>: 성능과 운용 복잡도 증가</li><li><strong>컴플라이언스 준수</strong>: GDPR 등 개인정보 법적 요건 대응</li><li><strong>스턱처 표준 충족</strong>: JWT 변경에 따른 클라이언트 호환성 유지</li></ul><hr><h2 id=-실무-적용-고려사항-및-주의사항>🧰 실무 적용 고려사항 및 주의사항<a hidden class=anchor aria-hidden=true href=#-실무-적용-고려사항-및-주의사항>#</a></h2><table><thead><tr><th>카테고리</th><th>주의할 점/고려사항</th><th>권장사항</th></tr></thead><tbody><tr><td>토큰 저장소</td><td>XSS/CSRF 취약점</td><td>httpOnly + sameSite 쿠키 사용</td></tr><tr><td>전송 보안</td><td>URI 전달, 로컬스토리지 사용 지양</td><td>Authorization 헤더로 전달, HTTPS 적용</td></tr><tr><td>클레임 설계</td><td>민감정보 포함 방지</td><td>사용자 ID 정도만 포함하고 리소스 서버 조회</td></tr><tr><td>키 관리 및 회전</td><td>비대칭 키 사용, 로테이션 계획</td><td>KID 포함, 공개 키 발행 · 삭제 정책 수립</td></tr><tr><td>만료 시간 설정</td><td>너무 길거나 짧은 만료 불균형</td><td>access: 5–15 분 / refresh: 7–30 일</td></tr><tr><td>재발급 전략 설계</td><td>무한 루프 갱신 등 위험 방지</td><td>토큰 회전 및 백리스트 (blacklist) 설계</td></tr><tr><td>로깅/모니터링</td><td>이상 트래픽·토큰 재사용 탐지 중요</td><td>모든 발급/사용 이벤트 로깅</td></tr><tr><td>에러 핸들링</td><td>잘못된 토큰 요청에 과도한 정보 노출 주의</td><td>일반 메시지만 노출 (Server error 등)</td></tr><tr><td>라이브러리 선택</td><td>취약점 있는 구현 주의 (alg=none 등)</td><td>검증된 공식 라이브러리 사용</td></tr></tbody></table><hr><h2 id=-최적화-고려사항-및-권장사항>⚙️ 최적화 고려사항 및 권장사항<a hidden class=anchor aria-hidden=true href=#-최적화-고려사항-및-권장사항>#</a></h2><table><thead><tr><th>카테고리</th><th>최적화 요소</th><th>권장 방법</th></tr></thead><tbody><tr><td>토큰 크기</td><td>페이로드 최소화</td><td>필수 클레임만 포함 (예: <code>sub</code>, <code>exp</code>)</td></tr><tr><td>서명 알고리즘</td><td>속도 vs 안정성 균형</td><td>HS256 속도 / RS256 보안 선택</td></tr><tr><td>키 로테이션</td><td>이전 토큰 여파 최소화</td><td>KID 와 함께 주기적 교체</td></tr><tr><td>백엔드 검증</td><td>불필요한 검증 최소한 수행</td><td>필요한 경우만 서명 + 클레임 검증</td></tr><tr><td>캐싱</td><td>공개키 캐싱</td><td>JWKS, 메모리 캐싱으로 네트워크 최소화</td></tr><tr><td>모니터링</td><td>서명 실패/재사용 알림</td><td>알림 시스템 설정</td></tr><tr><td>배치 처리</td><td>만료된 토큰 정리 자동화</td><td>백그라운드 스크립트 주기 실행</td></tr></tbody></table><hr><h2 id=-마무리-요약>📌 마무리 요약<a hidden class=anchor aria-hidden=true href=#-마무리-요약>#</a></h2><p>JWT 는 클라우드, 마이크로서비스, SPA 환경에서 무상태 인증과 스케일 아웃을 가능하게 하는 핵심 기술입니다. 그러나 키 관리, 토큰 취소 및 보안 취약성을 고려해야 하며, 이를 위해 권장 라이브러리 사용, 키 로테이션, 짧은 TTL, cookie 기반 저장, 검증 강화를 포함한 설계가 필요합니다.</p><hr><h2 id=-용어-정리-1>📚 용어 정리<a hidden class=anchor aria-hidden=true href=#-용어-정리-1>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>보안</td><td>XSS/CSRF</td><td>크로스 사이트 스크립팅 / 요청 위조 공격</td></tr><tr><td>토큰 관리</td><td>jti, nonce</td><td>JWT 고유 식별자/Replay 공격 방지용 임의값</td></tr><tr><td>키 운영</td><td>KID, JWKS</td><td>키 식별자와 JSON Web Key Set</td></tr><tr><td>토큰 유형</td><td>Access vs Refresh Token</td><td>접근과 재발급 목적으로 분리된 토큰 종류</td></tr></tbody></table><hr><p>원하시면 <strong>mermaid 기반의 실무 구조 다이어그램</strong>, <strong>Python 구현 예제</strong>, 혹은 <strong>최적화된 인증 서버 설계</strong> 등에 대해 더 분석해 드릴 수 있습니다. 언제든지 말씀해주세요!</p><hr><p>JWT 에 대한 포괄적인 조사를 수행하겠습니다. 먼저 최신 정보를 확인하기 위해 웹 검색을 실시하겠습니다.</p><h2 id=jwt-json-web-token-포괄적-분석-및-조사>JWT (JSON Web Token) 포괄적 분석 및 조사<a hidden class=anchor aria-hidden=true href=#jwt-json-web-token-포괄적-분석-및-조사>#</a></h2><h3 id=1-태그>1. 태그<a hidden class=anchor aria-hidden=true href=#1-태그>#</a></h3><ul><li>JSON-Web-Token</li><li>Authentication-Authorization</li><li>Stateless-Security</li><li>Token-Based-Authentication</li></ul><h3 id=2-주제의-분류-계층-구조-검증>2. 주제의 분류 계층 구조 검증<a hidden class=anchor aria-hidden=true href=#2-주제의-분류-계층-구조-검증>#</a></h3><p>요청된 분류: &ldquo;Computer Science and Engineering > Cybersecurity and Information Security > Access Control > Implementations > Token-Based Authentication&rdquo;</p><p><strong>검증 결과</strong>: 이 계층 구조는 적절합니다. JWT 는 근본적으로 토큰 기반 인증의 구현체로서, 접근 제어 메커니즘의 일부이며, 정보 보안 영역에 속하는 컴퓨터 과학 기술입니다. 이는 JWT 의 본질적 특성과 활용 목적에 정확히 부합합니다.</p><h3 id=3-주제-요약-200-자-내외-1>3. 주제 요약 (200 자 내외)<a hidden class=anchor aria-hidden=true href=#3-주제-요약-200-자-내외-1>#</a></h3><p>JWT 는 RFC 7519 표준에 따른 JSON 기반 보안 토큰으로, 당사자 간 클레임을 안전하게 전송하는 컴팩트하고 자체 포함된 방식입니다. 디지털 서명이나 암호화를 통해 무결성과 인증을 보장하며, 상태 비저장 인증 메커니즘으로 현대 웹 애플리케이션과 API 에서 널리 사용됩니다.</p><h3 id=4-전체-개요-250-자-내외-1>4. 전체 개요 (250 자 내외)<a hidden class=anchor aria-hidden=true href=#4-전체-개요-250-자-내외-1>#</a></h3><p>본 분석은 JWT 의 핵심 개념부터 실무 적용까지 포괄적으로 다룹니다. JWT 의 구조 (헤더, 페이로드, 서명), 작동 원리, 주요 알고리즘 (HS256, RS256), 보안 고려사항, 장단점, 구현 기법, 활용 사례, 최적화 방안을 심도 있게 분석합니다. 특히 실무에서의 효과적인 적용과 보안 취약점 대응 방안을 중점적으로 제시합니다.</p><hr><h3 id=1-부-기본-개념-및-이론><strong>1 부: 기본 개념 및 이론</strong><a hidden class=anchor aria-hidden=true href=#1-부-기본-개념-및-이론>#</a></h3><h4 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h4><p>JWT 는 JSON Web Token 의 약자로, **JSON 객체로 정보를 안전하게 전송하기 위한 개방형 표준 (RFC 7519)**입니다. 다음과 같은 핵심 개념들을 포함합니다:</p><p><strong>기본 정의</strong></p><ul><li><strong>컴팩트성 (Compactness)</strong>: URL-safe 한 문자열 형태로 HTTP 헤더나 URL 매개변수에 쉽게 포함 가능</li><li><strong>자체 포함성 (Self-contained)</strong>: 토큰 자체가 사용자 정보와 권한 정보를 포함</li><li><strong>상태 비저장성 (Stateless)</strong>: 서버에서 세션 상태를 저장할 필요 없음</li><li><strong>검증 가능성 (Verifiable)</strong>: 디지털 서명을 통한 무결성 및 인증 검증</li></ul><p><strong>JSON Object Signing and Encryption (JOSE) 연관성</strong></p><ul><li><strong>JWS (JSON Web Signature)</strong>: 서명을 통한 무결성 보장</li><li><strong>JWE (JSON Web Encryption)</strong>: 암호화를 통한 기밀성 보장</li><li><strong>JWK (JSON Web Key)</strong>: 키 관리 표준</li><li><strong>JWA (JSON Web Algorithms)</strong>: 암호화 알고리즘 표준</li></ul><p><strong>실무에서 구현하기 위한 필요 내용들</strong></p><ol><li><strong>알고리즘 선택</strong>: HS256(대칭키) vs RS256(비대칭키) 선택 기준</li><li><strong>클레임 설계</strong>: 표준 클레임 (iss, sub, aud, exp, nbf, iat, jti) 과 커스텀 클레임 활용</li><li><strong>키 관리</strong>: 서명 키의 안전한 저장, 순환, 배포 메커니즘</li><li><strong>토큰 라이프사이클</strong>: 발급, 검증, 갱신, 폐기 과정</li><li><strong>보안 고려사항</strong>: 토큰 저장 위치, 전송 보안, 만료 시간 설정</li></ol><h4 id=배경>배경<a hidden class=anchor aria-hidden=true href=#배경>#</a></h4><p>JWT 의 등장 배경은 다음과 같습니다:</p><p><strong>기존 세션 기반 인증의 한계</strong></p><ul><li>서버 메모리 사용으로 인한 확장성 문제</li><li>분산 시스템에서의 세션 공유 복잡성</li><li>마이크로서비스 아키텍처에서의 상태 관리 어려움</li></ul><p><strong>모바일 및 SPA 애플리케이션의 증가</strong></p><ul><li>RESTful API 의 확산</li><li>클라이언트 - 서버 분리 아키텍처 요구</li><li>Cross-Origin Resource Sharing (CORS) 대응 필요</li></ul><p><strong>표준화 요구</strong></p><ul><li>OAuth 2.0 및 OpenID Connect 와의 통합 필요</li><li>상호 운용성 확보</li><li>보안 메커니즘 표준화</li></ul><h4 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h4><p><strong>주요 목적</strong></p><ol><li><strong>상태 비저장 인증</strong>: 서버 확장성 향상</li><li><strong>정보 전달</strong>: 안전한 클레임 전송</li><li><strong>분산 시스템 지원</strong>: 마이크로서비스 간 인증 정보 공유</li><li><strong>표준화</strong>: 다양한 플랫폼 간 호환성 제공</li></ol><p><strong>필요성</strong></p><ul><li><strong>확장성</strong>: 서버 클러스터에서 세션 공유 없이 인증 처리</li><li><strong>성능</strong>: 데이터베이스 조회 없는 빠른 토큰 검증</li><li><strong>유연성</strong>: 다양한 클라이언트 타입 지원</li><li><strong>보안</strong>: 무결성 보장 및 변조 방지</li></ul><h4 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h4><p><strong>인증 (Authentication)</strong></p><ul><li>사용자 신원 확인</li><li>로그인 상태 유지</li><li>세션 관리 대체</li></ul><p><strong>인가 (Authorization)</strong></p><ul><li>리소스 접근 권한 확인</li><li>역할 기반 접근 제어 (RBAC)</li><li>속성 기반 접근 제어 (ABAC)</li></ul><p><strong>정보 교환 (Information Exchange)</strong></p><ul><li>당사자 간 안전한 정보 전송</li><li>클레임 기반 정보 전달</li><li>무결성 보장</li></ul><p><strong>Single Sign-On (SSO)</strong></p><ul><li>여러 애플리케이션 간 통합 인증</li><li>중앙 집중식 인증 서비스</li><li>페더레이션 지원</li></ul><h4 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h4><p><strong>구조적 특징</strong></p><ul><li><strong>3 부분 구성</strong>: 헤더.페이로드.서명</li><li><strong>Base64URL 인코딩</strong>: URL-safe 문자열</li><li><strong>JSON 형식</strong>: 가독성과 파싱 용이성</li></ul><p><strong>보안적 특징</strong></p><ul><li><strong>디지털 서명</strong>: 무결성 및 인증 보장</li><li><strong>선택적 암호화</strong>: 기밀성 제공 (JWE)</li><li><strong>만료 시간</strong>: 토큰 유효 기간 제한</li></ul><p><strong>운영적 특징</strong></p><ul><li><strong>언어 중립성</strong>: 다양한 프로그래밍 언어 지원</li><li><strong>플랫폼 독립성</strong>: 웹, 모바일, 데스크톱 애플리케이션 지원</li><li><strong>라이브러리 생태계</strong>: 풍부한 구현체 제공</li></ul><hr><h3 id=2-부-구조-및-기술적-분석><strong>2 부: 구조 및 기술적 분석</strong><a hidden class=anchor aria-hidden=true href=#2-부-구조-및-기술적-분석>#</a></h3><h4 id=주요-원리>주요 원리<a hidden class=anchor aria-hidden=true href=#주요-원리>#</a></h4><p>JWT 의 주요 원리는 다음과 같습니다:</p><p><strong>무결성 보장 원리</strong></p><ol><li><strong>해시 기반 서명</strong>: 헤더와 페이로드의 해시값을 비밀키로 서명</li><li><strong>변조 감지</strong>: 토큰 내용 변경 시 서명 불일치로 감지</li><li><strong>원본 보장</strong>: 서명 검증을 통한 데이터 무결성 확인</li></ol><p><strong>인증 원리</strong></p><ol><li><strong>신원 확인</strong>: 서명자의 개인키 소유 증명</li><li><strong>부인 방지</strong>: 비대칭키 사용 시 서명자 부인 불가</li><li><strong>신뢰 체인</strong>: 공개키 인프라를 통한 신뢰성 확보</li></ol><h4 id=작동-원리>작동 원리<a hidden class=anchor aria-hidden=true href=#작동-원리>#</a></h4><p>JWT 의 작동 원리를 다이어그램으로 표현하면 다음과 같습니다:</p><pre class=mermaid>sequenceDiagram
    participant Client as 클라이언트
    participant AuthServer as 인증 서버
    participant ResourceServer as 리소스 서버
    
    Client-&gt;&gt;AuthServer: 1. 로그인 요청 (credentials)
    AuthServer-&gt;&gt;AuthServer: 2. 자격 증명 검증
    AuthServer-&gt;&gt;AuthServer: 3. JWT 생성 및 서명
    AuthServer-&gt;&gt;Client: 4. JWT 반환
    Client-&gt;&gt;ResourceServer: 5. 리소스 요청 + JWT
    ResourceServer-&gt;&gt;ResourceServer: 6. JWT 서명 검증
    ResourceServer-&gt;&gt;ResourceServer: 7. 클레임 확인
    ResourceServer-&gt;&gt;Client: 8. 리소스 응답
</pre><p><strong>상세 작동 과정</strong></p><ol><li><p><strong>토큰 생성 단계</strong></p><ul><li>사용자 인증 후 서버에서 JWT 생성</li><li>헤더, 페이로드 정보 설정</li><li>비밀키 또는 개인키로 서명 생성</li></ul></li><li><p><strong>토큰 전송 단계</strong></p><ul><li>Authorization 헤더에 Bearer 토큰으로 전송</li><li><code>Authorization: Bearer &lt;JWT></code></li></ul></li><li><p><strong>토큰 검증 단계</strong></p><ul><li>서버에서 토큰 수신</li><li>서명 검증을 통한 무결성 확인</li><li>클레임 검증 (만료 시간, 발급자 등)</li></ul></li><li><p><strong>접근 제어 단계</strong></p><ul><li>유효한 토큰의 경우 리소스 접근 허용</li><li>무효한 토큰의 경우 접근 거부</li></ul></li></ol><h4 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h4><p>JWT 는 다음과 같은 3 부분 구조를 가집니다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>Header</span><span class=o>.</span><span class=n>Payload</span><span class=o>.</span><span class=n>Signature</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>구조 다이어그램</strong></p><pre class=mermaid>graph TD
    A[JWT Token] --&gt; B[Header]
    A --&gt; C[Payload]
    A --&gt; D[Signature]
    
    B --&gt; B1[alg: 알고리즘]
    B --&gt; B2[typ: 토큰 타입]
    B --&gt; B3[kid: 키 ID]
    
    C --&gt; C1[Standard Claims]
    C --&gt; C2[Public Claims]
    C --&gt; C3[Private Claims]
    
    C1 --&gt; C11[iss: 발급자]
    C1 --&gt; C12[sub: 주체]
    C1 --&gt; C13[aud: 대상]
    C1 --&gt; C14[exp: 만료시간]
    C1 --&gt; C15[nbf: 이전 무효]
    C1 --&gt; C16[iat: 발급시간]
    C1 --&gt; C17[jti: JWT ID]
    
    D --&gt; D1[HMAC 서명]
    D --&gt; D2[RSA 서명]
    D --&gt; D3[ECDSA 서명]
</pre><h4 id=구성-요소-1>구성 요소<a hidden class=anchor aria-hidden=true href=#구성-요소-1>#</a></h4><h5 id=필수-구성요소>필수 구성요소<a hidden class=anchor aria-hidden=true href=#필수-구성요소>#</a></h5><p><strong>1. 헤더 (Header)</strong></p><ul><li><strong>기능</strong>: 토큰 메타데이터 포함</li><li><strong>역할</strong>: 서명 알고리즘 및 토큰 타입 명시</li><li><strong>특징</strong>: Base64URL 인코딩된 JSON 객체</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;alg&#34;</span><span class=p>:</span> <span class=s2>&#34;HS256&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;typ&#34;</span><span class=p>:</span> <span class=s2>&#34;JWT&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>2. 페이로드 (Payload)</strong></p><ul><li><strong>기능</strong>: 클레임 정보 포함</li><li><strong>역할</strong>: 사용자 정보 및 권한 데이터 전달</li><li><strong>특징</strong>: 표준, 공개, 비공개 클레임으로 구성</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3>3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4>4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5>5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6>6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;sub&#34;</span><span class=p>:</span> <span class=s2>&#34;1234567890&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;John Doe&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;admin&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;iat&#34;</span><span class=p>:</span> <span class=mi>1516239022</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;exp&#34;</span><span class=p>:</span> <span class=mi>1516325422</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>3. 서명 (Signature)</strong></p><ul><li><strong>기능</strong>: 무결성 및 인증 보장</li><li><strong>역할</strong>: 토큰 변조 방지 및 발급자 확인</li><li><strong>특징</strong>: 선택된 알고리즘에 따른 서명 생성</li></ul><h5 id=선택-구성요소>선택 구성요소<a hidden class=anchor aria-hidden=true href=#선택-구성요소>#</a></h5><p><strong>1. 암호화 (JWE)</strong></p><ul><li><strong>기능</strong>: 기밀성 보장</li><li><strong>역할</strong>: 민감한 정보 보호</li><li><strong>특징</strong>: 5 부분 구조 (헤더, 암호화키, IV, 암호문, 인증태그)</li></ul><p><strong>2. 중첩 구조</strong></p><ul><li><strong>기능</strong>: 서명 후 암호화</li><li><strong>역할</strong>: 무결성과 기밀성 동시 제공</li><li><strong>특징</strong>: JWS 를 JWE 로 감싸는 구조</li></ul><h4 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h4><h5 id=1-대칭키-알고리즘-hmac>1. 대칭키 알고리즘 (HMAC)<a hidden class=anchor aria-hidden=true href=#1-대칭키-알고리즘-hmac>#</a></h5><p><strong>정의</strong>: 하나의 비밀키를 사용하여 서명 생성 및 검증</p><p><strong>구성</strong></p><ul><li>HS256: HMAC with SHA-256</li><li>HS384: HMAC with SHA-384</li><li>HS512: HMAC with SHA-512</li></ul><p><strong>목적</strong>: 단일 서비스 내에서의 빠른 토큰 처리</p><p><strong>실제 예시</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hmac</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>base64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_signature</span><span class=p>(</span><span class=n>header</span><span class=p>,</span> <span class=n>payload</span><span class=p>,</span> <span class=n>secret</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>message</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>header</span><span class=si>}</span><span class=s2>.</span><span class=si>{</span><span class=n>payload</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>signature</span> <span class=o>=</span> <span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>secret</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>message</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span><span class=o>.</span><span class=n>digest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>base64</span><span class=o>.</span><span class=n>urlsafe_b64encode</span><span class=p>(</span><span class=n>signature</span><span class=p>)</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=s1>&#39;=&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>시스템 구성</strong>: 단일 애플리케이션 서버에서 토큰 발급 및 검증</p><h5 id=2-비대칭키-알고리즘-rsaecdsa>2. 비대칭키 알고리즘 (RSA/ECDSA)<a hidden class=anchor aria-hidden=true href=#2-비대칭키-알고리즘-rsaecdsa>#</a></h5><p><strong>정의</strong>: 공개키/개인키 쌍을 사용하여 서명 생성 및 검증</p><p><strong>구성</strong></p><ul><li>RS256/384/512: RSA with SHA-256/384/512</li><li>ES256/384/512: ECDSA with SHA-256/384/512</li><li>PS256/384/512: RSA-PSS with SHA-256/384/512</li></ul><p><strong>목적</strong>: 분산 시스템에서의 안전한 토큰 검증</p><p><strong>실제 예시</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>jwt</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;jsonwebtoken&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>fs</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;fs&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 개인키로 서명
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>privateKey</span> <span class=o>=</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;private.pem&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>({</span> <span class=nx>userId</span><span class=o>:</span> <span class=mi>123</span> <span class=p>},</span> <span class=nx>privateKey</span><span class=p>,</span> <span class=p>{</span> <span class=nx>algorithm</span><span class=o>:</span> <span class=s1>&#39;RS256&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 공개키로 검증
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>publicKey</span> <span class=o>=</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=s1>&#39;public.pem&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>decoded</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>token</span><span class=p>,</span> <span class=nx>publicKey</span><span class=p>,</span> <span class=p>{</span> <span class=nx>algorithms</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;RS256&#39;</span><span class=p>]</span> <span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>시스템 구성</strong>: 인증 서버 (개인키) 와 리소스 서버 (공개키) 분리</p><h5 id=3-토큰-리프레시-메커니즘>3. 토큰 리프레시 메커니즘<a hidden class=anchor aria-hidden=true href=#3-토큰-리프레시-메커니즘>#</a></h5><p><strong>정의</strong>: 액세스 토큰과 리프레시 토큰을 조합한 보안 강화 기법</p><p><strong>구성</strong></p><ul><li>단기 액세스 토큰 (15 분 -1 시간)</li><li>장기 리프레시 토큰 (7-30 일)</li><li>토큰 순환 (Rotation) 정책</li></ul><p><strong>목적</strong>: 보안성과 사용성의 균형</p><p><strong>시나리오</strong></p><ol><li>초기 로그인 시 두 토큰 발급</li><li>액세스 토큰 만료 시 리프레시 토큰으로 갱신</li><li>리프레시 토큰도 순환하여 보안 강화</li></ol><hr><h3 id=3-부-장단점-및-문제점-분석><strong>3 부: 장단점 및 문제점 분석</strong><a hidden class=anchor aria-hidden=true href=#3-부-장단점-및-문제점-분석>#</a></h3><h4 id=장점-1>장점<a hidden class=anchor aria-hidden=true href=#장점-1>#</a></h4><table><thead><tr><th>구분</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>장점</td><td>확장성 (Scalability)</td><td>서버에서 세션 상태를 저장하지 않아 수평 확장이 용이하며, 로드 밸런서 사용 시 세션 고정 (sticky session) 불필요</td></tr><tr><td>장점</td><td>성능 (Performance)</td><td>토큰 자체에 정보가 포함되어 데이터베이스 조회 없이 빠른 인증 처리 가능</td></tr><tr><td>장점</td><td>상호 운용성 (Interoperability)</td><td>표준화된 JSON 형식으로 다양한 언어와 플랫폼에서 호환</td></tr><tr><td>장점</td><td>무결성 (Integrity)</td><td>디지털 서명을 통해 토큰 변조 감지 및 방지</td></tr><tr><td>장점</td><td>분산 시스템 지원</td><td>마이크로서비스 아키텍처에서 서비스 간 인증 정보 공유 용이</td></tr><tr><td>장점</td><td>모바일 친화적</td><td>쿠키에 의존하지 않아 모바일 애플리케이션에서 활용 용이</td></tr><tr><td>장점</td><td>CORS 해결</td><td>크로스 도메인 요청 시 쿠키 제한 없이 인증 헤더 사용 가능</td></tr></tbody></table><h4 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h4><h5 id=단점-2>단점<a hidden class=anchor aria-hidden=true href=#단점-2>#</a></h5><table><thead><tr><th>구분</th><th>항목</th><th>설명</th><th>해결책</th></tr></thead><tbody><tr><td>단점</td><td>토큰 크기</td><td>쿠키 세션 ID 보다 크기가 크며, 많은 클레임 포함 시 네트워크 오버헤드 증가</td><td>필요한 클레임만 포함, 토큰 압축, Reference Token 사용 고려</td></tr><tr><td>단점</td><td>즉시 무효화 불가</td><td>만료 전까지는 서버에서 강제 무효화가 어려움</td><td>블랙리스트 관리, 짧은 만료 시간 + 리프레시 토큰, Redis 기반 토큰 저장소 활용</td></tr><tr><td>단점</td><td>정보 노출</td><td>Base64 인코딩으로 페이로드 내용이 쉽게 디코딩 가능</td><td>민감한 정보는 토큰에 포함하지 않음, JWE 암호화 사용</td></tr><tr><td>단점</td><td>키 관리 복잡성</td><td>서명키 보안 관리 및 순환의 복잡성</td><td>HSM 사용, 키 관리 서비스 활용, 정기적 키 순환 정책 수립</td></tr></tbody></table><h5 id=문제점-1>문제점<a hidden class=anchor aria-hidden=true href=#문제점-1>#</a></h5><table><thead><tr><th>구분</th><th>항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 방법 및 기법</th></tr></thead><tbody><tr><td>문제점</td><td>Algorithm Confusion</td><td>none 알고리즘 허용 또는 알고리즘 검증 부족</td><td>서명 우회 공격 가능</td><td>토큰 헤더의 alg 필드 모니터링</td><td>허용 알고리즘 화이트리스트 적용</td><td>강제 알고리즘 지정, none 알고리즘 차단</td></tr><tr><td>문제점</td><td>Key Confusion</td><td>공개키를 대칭키로 오인하여 사용</td><td>키 추측 공격 취약성</td><td>알고리즘과 키 타입 불일치 모니터링</td><td>알고리즘별 키 타입 강제 검증</td><td>키 타입과 알고리즘 매칭 검증 로직 구현</td></tr><tr><td>문제점</td><td>Token Leakage</td><td>XSS, 로그 노출, 네트워크 스니핑</td><td>무단 접근 및 권한 상승</td><td>비정상적인 토큰 사용 패턴 모니터링</td><td>HTTPS 강제, 안전한 저장소 사용, CSP 적용</td><td>토큰 순환, 짧은 만료 시간, 위치 기반 검증</td></tr><tr><td>문제점</td><td>Weak Secret</td><td>짧거나 예측 가능한 비밀키 사용</td><td>브루트포스 공격으로 키 탈취</td><td>무결성 실패 토큰 급증 모니터링</td><td>충분한 엔트로피의 키 생성</td><td>강력한 키 생성, 정기적 키 순환</td></tr></tbody></table><h4 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h4><h5 id=보안-과제>보안 과제<a hidden class=anchor aria-hidden=true href=#보안-과제>#</a></h5><p><strong>1. 고급 지속 위협 (APT) 대응</strong></p><ul><li><strong>원인</strong>: 토큰 탈취 후 장기간 악용</li><li><strong>영향</strong>: 민감한 데이터 지속적 노출</li><li><strong>해결 방법</strong>: 행위 기반 분석, 컨텍스트 인식 보안, Zero Trust 아키텍처</li></ul><p><strong>2. 양자 컴퓨팅 위협</strong></p><ul><li><strong>원인</strong>: 현재 암호화 알고리즘의 취약성</li><li><strong>영향</strong>: RSA, ECDSA 알고리즘 무력화</li><li><strong>해결 방법</strong>: 양자 저항 알고리즘 도입, 하이브리드 보안 모델</li></ul><h5 id=운영-과제>운영 과제<a hidden class=anchor aria-hidden=true href=#운영-과제>#</a></h5><p><strong>1. 대규모 토큰 관리</strong></p><ul><li><strong>원인</strong>: 수백만 사용자의 토큰 라이프사이클 관리</li><li><strong>영향</strong>: 성능 저하 및 관리 복잡성</li><li><strong>해결 방법</strong>: 분산 캐싱, 토큰 풀링, 자동화된 모니터링</li></ul><p><strong>2. 규정 준수</strong></p><ul><li><strong>원인</strong>: GDPR, CCPA 등 개인정보보호 법규</li><li><strong>영향</strong>: 토큰 내 개인정보 처리 제약</li><li><strong>해결 방법</strong>: 개인정보 최소화, 동의 관리 시스템, 감사 로그</li></ul><h5 id=기술-과제>기술 과제<a hidden class=anchor aria-hidden=true href=#기술-과제>#</a></h5><p><strong>1. 엣지 컴퓨팅 통합</strong></p><ul><li><strong>원인</strong>: 분산된 엣지 환경에서의 토큰 검증</li><li><strong>영향</strong>: 네트워크 지연 및 오프라인 처리</li><li><strong>해결 방법</strong>: 로컬 키 캐싱, 오프라인 검증 메커니즘</li></ul><p><strong>2. 실시간 토큰 무효화</strong></p><ul><li><strong>원인</strong>: 보안 사고 발생 시 즉시 대응 필요</li><li><strong>영향</strong>: 손상된 토큰의 지속적 사용</li><li><strong>해결 방법</strong>: 실시간 블랙리스트, 푸시 기반 무효화</li></ul><hr><h3 id=4-부-실무-적용-및-최적화><strong>4 부: 실무 적용 및 최적화</strong><a hidden class=anchor aria-hidden=true href=#4-부-실무-적용-및-최적화>#</a></h3><h4 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h4><table><thead><tr><th>분류 기준</th><th>종류/유형</th><th>특징</th><th>사용 사례</th></tr></thead><tbody><tr><td>서명 방식</td><td>JWS (Signed)</td><td>무결성 보장, 내용 가시</td><td>일반적인 인증/인가</td></tr><tr><td>서명 방식</td><td>JWE (Encrypted)</td><td>기밀성 보장, 내용 암호화</td><td>민감한 정보 전송</td></tr><tr><td>서명 방식</td><td>Nested JWT</td><td>서명 후 암호화</td><td>최고 보안 요구사항</td></tr><tr><td>알고리즘</td><td>대칭키 (HS256/384/512)</td><td>빠른 처리, 단일 키</td><td>단일 서비스 환경</td></tr><tr><td>알고리즘</td><td>비대칭키 (RS256/384/512)</td><td>키 분리, 확장성</td><td>분산 시스템</td></tr><tr><td>알고리즘</td><td>타원곡선 (ES256/384/512)</td><td>작은 키 크기, 효율성</td><td>모바일/IoT 환경</td></tr><tr><td>용도</td><td>Access Token</td><td>단기간, API 접근</td><td>RESTful API 인증</td></tr><tr><td>용도</td><td>Refresh Token</td><td>장기간, 토큰 갱신</td><td>토큰 재발급</td></tr><tr><td>용도</td><td>ID Token</td><td>사용자 정보, OpenID Connect</td><td>SSO, 사용자 프로필</td></tr><tr><td>저장 위치</td><td>메모리 저장</td><td>휘발성, 보안성 높음</td><td>SPA 애플리케이션</td></tr><tr><td>저장 위치</td><td>localStorage</td><td>지속성, XSS 취약</td><td>편의성 우선 환경</td></tr><tr><td>저장 위치</td><td>httpOnly Cookie</td><td>XSS 방어, CSRF 주의</td><td>전통적 웹 애플리케이션</td></tr></tbody></table><h4 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h4><table><thead><tr><th>분야</th><th>사용 목적</th><th>함께 사용되는 기술</th><th>효과</th></tr></thead><tbody><tr><td>마이크로서비스</td><td>서비스 간 인증</td><td>Spring Security, Kubernetes</td><td>중앙 집중식 인증, 서비스 메시 보안</td></tr><tr><td>모바일 앱</td><td>사용자 인증</td><td>React Native, Flutter</td><td>오프라인 동작, 빠른 로그인</td></tr><tr><td>SPA 웹앱</td><td>상태 유지</td><td>React, Vue.js, Angular</td><td>새로고침 시 로그인 유지</td></tr><tr><td>API Gateway</td><td>접근 제어</td><td>Kong, AWS API Gateway</td><td>통합 인증, 요청 필터링</td></tr><tr><td>IoT 시스템</td><td>디바이스 인증</td><td>MQTT, CoAP</td><td>경량 인증, 배터리 효율성</td></tr><tr><td>금융 시스템</td><td>거래 인증</td><td>OAuth 2.0, OpenID Connect</td><td>높은 보안, 규정 준수</td></tr></tbody></table><h4 id=활용-사례-대규모-이커머스-플랫폼>활용 사례: 대규모 이커머스 플랫폼<a hidden class=anchor aria-hidden=true href=#활용-사례-대규모-이커머스-플랫폼>#</a></h4><h5 id=시스템-구성>시스템 구성<a hidden class=anchor aria-hidden=true href=#시스템-구성>#</a></h5><pre class=mermaid>graph TB
    subgraph &#34;클라이언트 계층&#34;
        A[웹 브라우저]
        B[모바일 앱]
        C[파트너 API]
    end
    
    subgraph &#34;API Gateway 계층&#34;
        D[AWS API Gateway]
        E[JWT 검증 Lambda]
    end
    
    subgraph &#34;마이크로서비스 계층&#34;
        F[사용자 서비스]
        G[상품 서비스]
        H[주문 서비스]
        I[결제 서비스]
    end
    
    subgraph &#34;인증 계층&#34;
        J[Auth0 서비스]
        K[Redis Token Store]
    end
    
    subgraph &#34;데이터 계층&#34;
        L[사용자 DB]
        M[상품 DB]
        N[주문 DB]
    end
    
    A --&gt; D
    B --&gt; D
    C --&gt; D
    D --&gt; E
    E --&gt; F
    E --&gt; G
    E --&gt; H
    E --&gt; I
    
    F --&gt; J
    G --&gt; J
    H --&gt; J
    I --&gt; J
    
    J --&gt; K
    J --&gt; L
    
    F --&gt; L
    G --&gt; M
    H --&gt; N
    I --&gt; N
</pre><h5 id=워크플로우>워크플로우<a hidden class=anchor aria-hidden=true href=#워크플로우>#</a></h5><ol><li><p><strong>사용자 로그인</strong></p><ul><li>클라이언트에서 Auth0 서비스로 인증 요청</li><li>성공 시 Access Token(15 분) + Refresh Token(7 일) 발급</li><li>토큰을 httpOnly 쿠키에 저장</li></ul></li><li><p><strong>API 요청 처리</strong></p><ul><li>API Gateway 에서 JWT 검증 Lambda 실행</li><li>토큰 서명 검증 및 만료 시간 확인</li><li>Redis 에서 블랙리스트 확인</li></ul></li><li><p><strong>마이크로서비스 호출</strong></p><ul><li>검증된 사용자 정보를 헤더에 포함하여 서비스 호출</li><li>각 서비스에서 권한 기반 접근 제어 수행</li></ul></li></ol><h5 id=jwt-의-역할>JWT 의 역할<a hidden class=anchor aria-hidden=true href=#jwt-의-역할>#</a></h5><ul><li><strong>통합 인증</strong>: 모든 마이크로서비스에서 동일한 토큰 사용</li><li><strong>상태 비저장</strong>: 서비스 간 세션 공유 불필요</li><li><strong>확장성</strong>: 새로운 서비스 추가 시 별도 인증 구현 불필요</li><li><strong>성능</strong>: 각 요청마다 DB 조회 없이 사용자 정보 확인</li></ul><h5 id=jwt-유무에-따른-차이점>JWT 유무에 따른 차이점<a hidden class=anchor aria-hidden=true href=#jwt-유무에-따른-차이점>#</a></h5><p><strong>JWT 사용 시</strong></p><ul><li>평균 응답 시간: 50ms</li><li>서버 메모리 사용량: 낮음</li><li>서비스 간 결합도: 낮음</li><li>확장성: 우수</li></ul><p><strong>세션 기반 인증 시</strong></p><ul><li>평균 응답 시간: 150ms (DB 조회)</li><li>서버 메모리 사용량: 높음</li><li>서비스 간 결합도: 높음</li><li>확장성: 제한적</li></ul><h4 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h4><p>다음은 Python 과 JavaScript 를 사용한 JWT 구현 예시입니다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1>  1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2>  2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3>  3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4>  4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5>  5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6>  6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7>  7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8>  8</a>
</span><span class=lnt id=hl-13-9><a class=lnlinks href=#hl-13-9>  9</a>
</span><span class=lnt id=hl-13-10><a class=lnlinks href=#hl-13-10> 10</a>
</span><span class=lnt id=hl-13-11><a class=lnlinks href=#hl-13-11> 11</a>
</span><span class=lnt id=hl-13-12><a class=lnlinks href=#hl-13-12> 12</a>
</span><span class=lnt id=hl-13-13><a class=lnlinks href=#hl-13-13> 13</a>
</span><span class=lnt id=hl-13-14><a class=lnlinks href=#hl-13-14> 14</a>
</span><span class=lnt id=hl-13-15><a class=lnlinks href=#hl-13-15> 15</a>
</span><span class=lnt id=hl-13-16><a class=lnlinks href=#hl-13-16> 16</a>
</span><span class=lnt id=hl-13-17><a class=lnlinks href=#hl-13-17> 17</a>
</span><span class=lnt id=hl-13-18><a class=lnlinks href=#hl-13-18> 18</a>
</span><span class=lnt id=hl-13-19><a class=lnlinks href=#hl-13-19> 19</a>
</span><span class=lnt id=hl-13-20><a class=lnlinks href=#hl-13-20> 20</a>
</span><span class=lnt id=hl-13-21><a class=lnlinks href=#hl-13-21> 21</a>
</span><span class=lnt id=hl-13-22><a class=lnlinks href=#hl-13-22> 22</a>
</span><span class=lnt id=hl-13-23><a class=lnlinks href=#hl-13-23> 23</a>
</span><span class=lnt id=hl-13-24><a class=lnlinks href=#hl-13-24> 24</a>
</span><span class=lnt id=hl-13-25><a class=lnlinks href=#hl-13-25> 25</a>
</span><span class=lnt id=hl-13-26><a class=lnlinks href=#hl-13-26> 26</a>
</span><span class=lnt id=hl-13-27><a class=lnlinks href=#hl-13-27> 27</a>
</span><span class=lnt id=hl-13-28><a class=lnlinks href=#hl-13-28> 28</a>
</span><span class=lnt id=hl-13-29><a class=lnlinks href=#hl-13-29> 29</a>
</span><span class=lnt id=hl-13-30><a class=lnlinks href=#hl-13-30> 30</a>
</span><span class=lnt id=hl-13-31><a class=lnlinks href=#hl-13-31> 31</a>
</span><span class=lnt id=hl-13-32><a class=lnlinks href=#hl-13-32> 32</a>
</span><span class=lnt id=hl-13-33><a class=lnlinks href=#hl-13-33> 33</a>
</span><span class=lnt id=hl-13-34><a class=lnlinks href=#hl-13-34> 34</a>
</span><span class=lnt id=hl-13-35><a class=lnlinks href=#hl-13-35> 35</a>
</span><span class=lnt id=hl-13-36><a class=lnlinks href=#hl-13-36> 36</a>
</span><span class=lnt id=hl-13-37><a class=lnlinks href=#hl-13-37> 37</a>
</span><span class=lnt id=hl-13-38><a class=lnlinks href=#hl-13-38> 38</a>
</span><span class=lnt id=hl-13-39><a class=lnlinks href=#hl-13-39> 39</a>
</span><span class=lnt id=hl-13-40><a class=lnlinks href=#hl-13-40> 40</a>
</span><span class=lnt id=hl-13-41><a class=lnlinks href=#hl-13-41> 41</a>
</span><span class=lnt id=hl-13-42><a class=lnlinks href=#hl-13-42> 42</a>
</span><span class=lnt id=hl-13-43><a class=lnlinks href=#hl-13-43> 43</a>
</span><span class=lnt id=hl-13-44><a class=lnlinks href=#hl-13-44> 44</a>
</span><span class=lnt id=hl-13-45><a class=lnlinks href=#hl-13-45> 45</a>
</span><span class=lnt id=hl-13-46><a class=lnlinks href=#hl-13-46> 46</a>
</span><span class=lnt id=hl-13-47><a class=lnlinks href=#hl-13-47> 47</a>
</span><span class=lnt id=hl-13-48><a class=lnlinks href=#hl-13-48> 48</a>
</span><span class=lnt id=hl-13-49><a class=lnlinks href=#hl-13-49> 49</a>
</span><span class=lnt id=hl-13-50><a class=lnlinks href=#hl-13-50> 50</a>
</span><span class=lnt id=hl-13-51><a class=lnlinks href=#hl-13-51> 51</a>
</span><span class=lnt id=hl-13-52><a class=lnlinks href=#hl-13-52> 52</a>
</span><span class=lnt id=hl-13-53><a class=lnlinks href=#hl-13-53> 53</a>
</span><span class=lnt id=hl-13-54><a class=lnlinks href=#hl-13-54> 54</a>
</span><span class=lnt id=hl-13-55><a class=lnlinks href=#hl-13-55> 55</a>
</span><span class=lnt id=hl-13-56><a class=lnlinks href=#hl-13-56> 56</a>
</span><span class=lnt id=hl-13-57><a class=lnlinks href=#hl-13-57> 57</a>
</span><span class=lnt id=hl-13-58><a class=lnlinks href=#hl-13-58> 58</a>
</span><span class=lnt id=hl-13-59><a class=lnlinks href=#hl-13-59> 59</a>
</span><span class=lnt id=hl-13-60><a class=lnlinks href=#hl-13-60> 60</a>
</span><span class=lnt id=hl-13-61><a class=lnlinks href=#hl-13-61> 61</a>
</span><span class=lnt id=hl-13-62><a class=lnlinks href=#hl-13-62> 62</a>
</span><span class=lnt id=hl-13-63><a class=lnlinks href=#hl-13-63> 63</a>
</span><span class=lnt id=hl-13-64><a class=lnlinks href=#hl-13-64> 64</a>
</span><span class=lnt id=hl-13-65><a class=lnlinks href=#hl-13-65> 65</a>
</span><span class=lnt id=hl-13-66><a class=lnlinks href=#hl-13-66> 66</a>
</span><span class=lnt id=hl-13-67><a class=lnlinks href=#hl-13-67> 67</a>
</span><span class=lnt id=hl-13-68><a class=lnlinks href=#hl-13-68> 68</a>
</span><span class=lnt id=hl-13-69><a class=lnlinks href=#hl-13-69> 69</a>
</span><span class=lnt id=hl-13-70><a class=lnlinks href=#hl-13-70> 70</a>
</span><span class=lnt id=hl-13-71><a class=lnlinks href=#hl-13-71> 71</a>
</span><span class=lnt id=hl-13-72><a class=lnlinks href=#hl-13-72> 72</a>
</span><span class=lnt id=hl-13-73><a class=lnlinks href=#hl-13-73> 73</a>
</span><span class=lnt id=hl-13-74><a class=lnlinks href=#hl-13-74> 74</a>
</span><span class=lnt id=hl-13-75><a class=lnlinks href=#hl-13-75> 75</a>
</span><span class=lnt id=hl-13-76><a class=lnlinks href=#hl-13-76> 76</a>
</span><span class=lnt id=hl-13-77><a class=lnlinks href=#hl-13-77> 77</a>
</span><span class=lnt id=hl-13-78><a class=lnlinks href=#hl-13-78> 78</a>
</span><span class=lnt id=hl-13-79><a class=lnlinks href=#hl-13-79> 79</a>
</span><span class=lnt id=hl-13-80><a class=lnlinks href=#hl-13-80> 80</a>
</span><span class=lnt id=hl-13-81><a class=lnlinks href=#hl-13-81> 81</a>
</span><span class=lnt id=hl-13-82><a class=lnlinks href=#hl-13-82> 82</a>
</span><span class=lnt id=hl-13-83><a class=lnlinks href=#hl-13-83> 83</a>
</span><span class=lnt id=hl-13-84><a class=lnlinks href=#hl-13-84> 84</a>
</span><span class=lnt id=hl-13-85><a class=lnlinks href=#hl-13-85> 85</a>
</span><span class=lnt id=hl-13-86><a class=lnlinks href=#hl-13-86> 86</a>
</span><span class=lnt id=hl-13-87><a class=lnlinks href=#hl-13-87> 87</a>
</span><span class=lnt id=hl-13-88><a class=lnlinks href=#hl-13-88> 88</a>
</span><span class=lnt id=hl-13-89><a class=lnlinks href=#hl-13-89> 89</a>
</span><span class=lnt id=hl-13-90><a class=lnlinks href=#hl-13-90> 90</a>
</span><span class=lnt id=hl-13-91><a class=lnlinks href=#hl-13-91> 91</a>
</span><span class=lnt id=hl-13-92><a class=lnlinks href=#hl-13-92> 92</a>
</span><span class=lnt id=hl-13-93><a class=lnlinks href=#hl-13-93> 93</a>
</span><span class=lnt id=hl-13-94><a class=lnlinks href=#hl-13-94> 94</a>
</span><span class=lnt id=hl-13-95><a class=lnlinks href=#hl-13-95> 95</a>
</span><span class=lnt id=hl-13-96><a class=lnlinks href=#hl-13-96> 96</a>
</span><span class=lnt id=hl-13-97><a class=lnlinks href=#hl-13-97> 97</a>
</span><span class=lnt id=hl-13-98><a class=lnlinks href=#hl-13-98> 98</a>
</span><span class=lnt id=hl-13-99><a class=lnlinks href=#hl-13-99> 99</a>
</span><span class=lnt id=hl-13-100><a class=lnlinks href=#hl-13-100>100</a>
</span><span class=lnt id=hl-13-101><a class=lnlinks href=#hl-13-101>101</a>
</span><span class=lnt id=hl-13-102><a class=lnlinks href=#hl-13-102>102</a>
</span><span class=lnt id=hl-13-103><a class=lnlinks href=#hl-13-103>103</a>
</span><span class=lnt id=hl-13-104><a class=lnlinks href=#hl-13-104>104</a>
</span><span class=lnt id=hl-13-105><a class=lnlinks href=#hl-13-105>105</a>
</span><span class=lnt id=hl-13-106><a class=lnlinks href=#hl-13-106>106</a>
</span><span class=lnt id=hl-13-107><a class=lnlinks href=#hl-13-107>107</a>
</span><span class=lnt id=hl-13-108><a class=lnlinks href=#hl-13-108>108</a>
</span><span class=lnt id=hl-13-109><a class=lnlinks href=#hl-13-109>109</a>
</span><span class=lnt id=hl-13-110><a class=lnlinks href=#hl-13-110>110</a>
</span><span class=lnt id=hl-13-111><a class=lnlinks href=#hl-13-111>111</a>
</span><span class=lnt id=hl-13-112><a class=lnlinks href=#hl-13-112>112</a>
</span><span class=lnt id=hl-13-113><a class=lnlinks href=#hl-13-113>113</a>
</span><span class=lnt id=hl-13-114><a class=lnlinks href=#hl-13-114>114</a>
</span><span class=lnt id=hl-13-115><a class=lnlinks href=#hl-13-115>115</a>
</span><span class=lnt id=hl-13-116><a class=lnlinks href=#hl-13-116>116</a>
</span><span class=lnt id=hl-13-117><a class=lnlinks href=#hl-13-117>117</a>
</span><span class=lnt id=hl-13-118><a class=lnlinks href=#hl-13-118>118</a>
</span><span class=lnt id=hl-13-119><a class=lnlinks href=#hl-13-119>119</a>
</span><span class=lnt id=hl-13-120><a class=lnlinks href=#hl-13-120>120</a>
</span><span class=lnt id=hl-13-121><a class=lnlinks href=#hl-13-121>121</a>
</span><span class=lnt id=hl-13-122><a class=lnlinks href=#hl-13-122>122</a>
</span><span class=lnt id=hl-13-123><a class=lnlinks href=#hl-13-123>123</a>
</span><span class=lnt id=hl-13-124><a class=lnlinks href=#hl-13-124>124</a>
</span><span class=lnt id=hl-13-125><a class=lnlinks href=#hl-13-125>125</a>
</span><span class=lnt id=hl-13-126><a class=lnlinks href=#hl-13-126>126</a>
</span><span class=lnt id=hl-13-127><a class=lnlinks href=#hl-13-127>127</a>
</span><span class=lnt id=hl-13-128><a class=lnlinks href=#hl-13-128>128</a>
</span><span class=lnt id=hl-13-129><a class=lnlinks href=#hl-13-129>129</a>
</span><span class=lnt id=hl-13-130><a class=lnlinks href=#hl-13-130>130</a>
</span><span class=lnt id=hl-13-131><a class=lnlinks href=#hl-13-131>131</a>
</span><span class=lnt id=hl-13-132><a class=lnlinks href=#hl-13-132>132</a>
</span><span class=lnt id=hl-13-133><a class=lnlinks href=#hl-13-133>133</a>
</span><span class=lnt id=hl-13-134><a class=lnlinks href=#hl-13-134>134</a>
</span><span class=lnt id=hl-13-135><a class=lnlinks href=#hl-13-135>135</a>
</span><span class=lnt id=hl-13-136><a class=lnlinks href=#hl-13-136>136</a>
</span><span class=lnt id=hl-13-137><a class=lnlinks href=#hl-13-137>137</a>
</span><span class=lnt id=hl-13-138><a class=lnlinks href=#hl-13-138>138</a>
</span><span class=lnt id=hl-13-139><a class=lnlinks href=#hl-13-139>139</a>
</span><span class=lnt id=hl-13-140><a class=lnlinks href=#hl-13-140>140</a>
</span><span class=lnt id=hl-13-141><a class=lnlinks href=#hl-13-141>141</a>
</span><span class=lnt id=hl-13-142><a class=lnlinks href=#hl-13-142>142</a>
</span><span class=lnt id=hl-13-143><a class=lnlinks href=#hl-13-143>143</a>
</span><span class=lnt id=hl-13-144><a class=lnlinks href=#hl-13-144>144</a>
</span><span class=lnt id=hl-13-145><a class=lnlinks href=#hl-13-145>145</a>
</span><span class=lnt id=hl-13-146><a class=lnlinks href=#hl-13-146>146</a>
</span><span class=lnt id=hl-13-147><a class=lnlinks href=#hl-13-147>147</a>
</span><span class=lnt id=hl-13-148><a class=lnlinks href=#hl-13-148>148</a>
</span><span class=lnt id=hl-13-149><a class=lnlinks href=#hl-13-149>149</a>
</span><span class=lnt id=hl-13-150><a class=lnlinks href=#hl-13-150>150</a>
</span><span class=lnt id=hl-13-151><a class=lnlinks href=#hl-13-151>151</a>
</span><span class=lnt id=hl-13-152><a class=lnlinks href=#hl-13-152>152</a>
</span><span class=lnt id=hl-13-153><a class=lnlinks href=#hl-13-153>153</a>
</span><span class=lnt id=hl-13-154><a class=lnlinks href=#hl-13-154>154</a>
</span><span class=lnt id=hl-13-155><a class=lnlinks href=#hl-13-155>155</a>
</span><span class=lnt id=hl-13-156><a class=lnlinks href=#hl-13-156>156</a>
</span><span class=lnt id=hl-13-157><a class=lnlinks href=#hl-13-157>157</a>
</span><span class=lnt id=hl-13-158><a class=lnlinks href=#hl-13-158>158</a>
</span><span class=lnt id=hl-13-159><a class=lnlinks href=#hl-13-159>159</a>
</span><span class=lnt id=hl-13-160><a class=lnlinks href=#hl-13-160>160</a>
</span><span class=lnt id=hl-13-161><a class=lnlinks href=#hl-13-161>161</a>
</span><span class=lnt id=hl-13-162><a class=lnlinks href=#hl-13-162>162</a>
</span><span class=lnt id=hl-13-163><a class=lnlinks href=#hl-13-163>163</a>
</span><span class=lnt id=hl-13-164><a class=lnlinks href=#hl-13-164>164</a>
</span><span class=lnt id=hl-13-165><a class=lnlinks href=#hl-13-165>165</a>
</span><span class=lnt id=hl-13-166><a class=lnlinks href=#hl-13-166>166</a>
</span><span class=lnt id=hl-13-167><a class=lnlinks href=#hl-13-167>167</a>
</span><span class=lnt id=hl-13-168><a class=lnlinks href=#hl-13-168>168</a>
</span><span class=lnt id=hl-13-169><a class=lnlinks href=#hl-13-169>169</a>
</span><span class=lnt id=hl-13-170><a class=lnlinks href=#hl-13-170>170</a>
</span><span class=lnt id=hl-13-171><a class=lnlinks href=#hl-13-171>171</a>
</span><span class=lnt id=hl-13-172><a class=lnlinks href=#hl-13-172>172</a>
</span><span class=lnt id=hl-13-173><a class=lnlinks href=#hl-13-173>173</a>
</span><span class=lnt id=hl-13-174><a class=lnlinks href=#hl-13-174>174</a>
</span><span class=lnt id=hl-13-175><a class=lnlinks href=#hl-13-175>175</a>
</span><span class=lnt id=hl-13-176><a class=lnlinks href=#hl-13-176>176</a>
</span><span class=lnt id=hl-13-177><a class=lnlinks href=#hl-13-177>177</a>
</span><span class=lnt id=hl-13-178><a class=lnlinks href=#hl-13-178>178</a>
</span><span class=lnt id=hl-13-179><a class=lnlinks href=#hl-13-179>179</a>
</span><span class=lnt id=hl-13-180><a class=lnlinks href=#hl-13-180>180</a>
</span><span class=lnt id=hl-13-181><a class=lnlinks href=#hl-13-181>181</a>
</span><span class=lnt id=hl-13-182><a class=lnlinks href=#hl-13-182>182</a>
</span><span class=lnt id=hl-13-183><a class=lnlinks href=#hl-13-183>183</a>
</span><span class=lnt id=hl-13-184><a class=lnlinks href=#hl-13-184>184</a>
</span><span class=lnt id=hl-13-185><a class=lnlinks href=#hl-13-185>185</a>
</span><span class=lnt id=hl-13-186><a class=lnlinks href=#hl-13-186>186</a>
</span><span class=lnt id=hl-13-187><a class=lnlinks href=#hl-13-187>187</a>
</span><span class=lnt id=hl-13-188><a class=lnlinks href=#hl-13-188>188</a>
</span><span class=lnt id=hl-13-189><a class=lnlinks href=#hl-13-189>189</a>
</span><span class=lnt id=hl-13-190><a class=lnlinks href=#hl-13-190>190</a>
</span><span class=lnt id=hl-13-191><a class=lnlinks href=#hl-13-191>191</a>
</span><span class=lnt id=hl-13-192><a class=lnlinks href=#hl-13-192>192</a>
</span><span class=lnt id=hl-13-193><a class=lnlinks href=#hl-13-193>193</a>
</span><span class=lnt id=hl-13-194><a class=lnlinks href=#hl-13-194>194</a>
</span><span class=lnt id=hl-13-195><a class=lnlinks href=#hl-13-195>195</a>
</span><span class=lnt id=hl-13-196><a class=lnlinks href=#hl-13-196>196</a>
</span><span class=lnt id=hl-13-197><a class=lnlinks href=#hl-13-197>197</a>
</span><span class=lnt id=hl-13-198><a class=lnlinks href=#hl-13-198>198</a>
</span><span class=lnt id=hl-13-199><a class=lnlinks href=#hl-13-199>199</a>
</span><span class=lnt id=hl-13-200><a class=lnlinks href=#hl-13-200>200</a>
</span><span class=lnt id=hl-13-201><a class=lnlinks href=#hl-13-201>201</a>
</span><span class=lnt id=hl-13-202><a class=lnlinks href=#hl-13-202>202</a>
</span><span class=lnt id=hl-13-203><a class=lnlinks href=#hl-13-203>203</a>
</span><span class=lnt id=hl-13-204><a class=lnlinks href=#hl-13-204>204</a>
</span><span class=lnt id=hl-13-205><a class=lnlinks href=#hl-13-205>205</a>
</span><span class=lnt id=hl-13-206><a class=lnlinks href=#hl-13-206>206</a>
</span><span class=lnt id=hl-13-207><a class=lnlinks href=#hl-13-207>207</a>
</span><span class=lnt id=hl-13-208><a class=lnlinks href=#hl-13-208>208</a>
</span><span class=lnt id=hl-13-209><a class=lnlinks href=#hl-13-209>209</a>
</span><span class=lnt id=hl-13-210><a class=lnlinks href=#hl-13-210>210</a>
</span><span class=lnt id=hl-13-211><a class=lnlinks href=#hl-13-211>211</a>
</span><span class=lnt id=hl-13-212><a class=lnlinks href=#hl-13-212>212</a>
</span><span class=lnt id=hl-13-213><a class=lnlinks href=#hl-13-213>213</a>
</span><span class=lnt id=hl-13-214><a class=lnlinks href=#hl-13-214>214</a>
</span><span class=lnt id=hl-13-215><a class=lnlinks href=#hl-13-215>215</a>
</span><span class=lnt id=hl-13-216><a class=lnlinks href=#hl-13-216>216</a>
</span><span class=lnt id=hl-13-217><a class=lnlinks href=#hl-13-217>217</a>
</span><span class=lnt id=hl-13-218><a class=lnlinks href=#hl-13-218>218</a>
</span><span class=lnt id=hl-13-219><a class=lnlinks href=#hl-13-219>219</a>
</span><span class=lnt id=hl-13-220><a class=lnlinks href=#hl-13-220>220</a>
</span><span class=lnt id=hl-13-221><a class=lnlinks href=#hl-13-221>221</a>
</span><span class=lnt id=hl-13-222><a class=lnlinks href=#hl-13-222>222</a>
</span><span class=lnt id=hl-13-223><a class=lnlinks href=#hl-13-223>223</a>
</span><span class=lnt id=hl-13-224><a class=lnlinks href=#hl-13-224>224</a>
</span><span class=lnt id=hl-13-225><a class=lnlinks href=#hl-13-225>225</a>
</span><span class=lnt id=hl-13-226><a class=lnlinks href=#hl-13-226>226</a>
</span><span class=lnt id=hl-13-227><a class=lnlinks href=#hl-13-227>227</a>
</span><span class=lnt id=hl-13-228><a class=lnlinks href=#hl-13-228>228</a>
</span><span class=lnt id=hl-13-229><a class=lnlinks href=#hl-13-229>229</a>
</span><span class=lnt id=hl-13-230><a class=lnlinks href=#hl-13-230>230</a>
</span><span class=lnt id=hl-13-231><a class=lnlinks href=#hl-13-231>231</a>
</span><span class=lnt id=hl-13-232><a class=lnlinks href=#hl-13-232>232</a>
</span><span class=lnt id=hl-13-233><a class=lnlinks href=#hl-13-233>233</a>
</span><span class=lnt id=hl-13-234><a class=lnlinks href=#hl-13-234>234</a>
</span><span class=lnt id=hl-13-235><a class=lnlinks href=#hl-13-235>235</a>
</span><span class=lnt id=hl-13-236><a class=lnlinks href=#hl-13-236>236</a>
</span><span class=lnt id=hl-13-237><a class=lnlinks href=#hl-13-237>237</a>
</span><span class=lnt id=hl-13-238><a class=lnlinks href=#hl-13-238>238</a>
</span><span class=lnt id=hl-13-239><a class=lnlinks href=#hl-13-239>239</a>
</span><span class=lnt id=hl-13-240><a class=lnlinks href=#hl-13-240>240</a>
</span><span class=lnt id=hl-13-241><a class=lnlinks href=#hl-13-241>241</a>
</span><span class=lnt id=hl-13-242><a class=lnlinks href=#hl-13-242>242</a>
</span><span class=lnt id=hl-13-243><a class=lnlinks href=#hl-13-243>243</a>
</span><span class=lnt id=hl-13-244><a class=lnlinks href=#hl-13-244>244</a>
</span><span class=lnt id=hl-13-245><a class=lnlinks href=#hl-13-245>245</a>
</span><span class=lnt id=hl-13-246><a class=lnlinks href=#hl-13-246>246</a>
</span><span class=lnt id=hl-13-247><a class=lnlinks href=#hl-13-247>247</a>
</span><span class=lnt id=hl-13-248><a class=lnlinks href=#hl-13-248>248</a>
</span><span class=lnt id=hl-13-249><a class=lnlinks href=#hl-13-249>249</a>
</span><span class=lnt id=hl-13-250><a class=lnlinks href=#hl-13-250>250</a>
</span><span class=lnt id=hl-13-251><a class=lnlinks href=#hl-13-251>251</a>
</span><span class=lnt id=hl-13-252><a class=lnlinks href=#hl-13-252>252</a>
</span><span class=lnt id=hl-13-253><a class=lnlinks href=#hl-13-253>253</a>
</span><span class=lnt id=hl-13-254><a class=lnlinks href=#hl-13-254>254</a>
</span><span class=lnt id=hl-13-255><a class=lnlinks href=#hl-13-255>255</a>
</span><span class=lnt id=hl-13-256><a class=lnlinks href=#hl-13-256>256</a>
</span><span class=lnt id=hl-13-257><a class=lnlinks href=#hl-13-257>257</a>
</span><span class=lnt id=hl-13-258><a class=lnlinks href=#hl-13-258>258</a>
</span><span class=lnt id=hl-13-259><a class=lnlinks href=#hl-13-259>259</a>
</span><span class=lnt id=hl-13-260><a class=lnlinks href=#hl-13-260>260</a>
</span><span class=lnt id=hl-13-261><a class=lnlinks href=#hl-13-261>261</a>
</span><span class=lnt id=hl-13-262><a class=lnlinks href=#hl-13-262>262</a>
</span><span class=lnt id=hl-13-263><a class=lnlinks href=#hl-13-263>263</a>
</span><span class=lnt id=hl-13-264><a class=lnlinks href=#hl-13-264>264</a>
</span><span class=lnt id=hl-13-265><a class=lnlinks href=#hl-13-265>265</a>
</span><span class=lnt id=hl-13-266><a class=lnlinks href=#hl-13-266>266</a>
</span><span class=lnt id=hl-13-267><a class=lnlinks href=#hl-13-267>267</a>
</span><span class=lnt id=hl-13-268><a class=lnlinks href=#hl-13-268>268</a>
</span><span class=lnt id=hl-13-269><a class=lnlinks href=#hl-13-269>269</a>
</span><span class=lnt id=hl-13-270><a class=lnlinks href=#hl-13-270>270</a>
</span><span class=lnt id=hl-13-271><a class=lnlinks href=#hl-13-271>271</a>
</span><span class=lnt id=hl-13-272><a class=lnlinks href=#hl-13-272>272</a>
</span><span class=lnt id=hl-13-273><a class=lnlinks href=#hl-13-273>273</a>
</span><span class=lnt id=hl-13-274><a class=lnlinks href=#hl-13-274>274</a>
</span><span class=lnt id=hl-13-275><a class=lnlinks href=#hl-13-275>275</a>
</span><span class=lnt id=hl-13-276><a class=lnlinks href=#hl-13-276>276</a>
</span><span class=lnt id=hl-13-277><a class=lnlinks href=#hl-13-277>277</a>
</span><span class=lnt id=hl-13-278><a class=lnlinks href=#hl-13-278>278</a>
</span><span class=lnt id=hl-13-279><a class=lnlinks href=#hl-13-279>279</a>
</span><span class=lnt id=hl-13-280><a class=lnlinks href=#hl-13-280>280</a>
</span><span class=lnt id=hl-13-281><a class=lnlinks href=#hl-13-281>281</a>
</span><span class=lnt id=hl-13-282><a class=lnlinks href=#hl-13-282>282</a>
</span><span class=lnt id=hl-13-283><a class=lnlinks href=#hl-13-283>283</a>
</span><span class=lnt id=hl-13-284><a class=lnlinks href=#hl-13-284>284</a>
</span><span class=lnt id=hl-13-285><a class=lnlinks href=#hl-13-285>285</a>
</span><span class=lnt id=hl-13-286><a class=lnlinks href=#hl-13-286>286</a>
</span><span class=lnt id=hl-13-287><a class=lnlinks href=#hl-13-287>287</a>
</span><span class=lnt id=hl-13-288><a class=lnlinks href=#hl-13-288>288</a>
</span><span class=lnt id=hl-13-289><a class=lnlinks href=#hl-13-289>289</a>
</span><span class=lnt id=hl-13-290><a class=lnlinks href=#hl-13-290>290</a>
</span><span class=lnt id=hl-13-291><a class=lnlinks href=#hl-13-291>291</a>
</span><span class=lnt id=hl-13-292><a class=lnlinks href=#hl-13-292>292</a>
</span><span class=lnt id=hl-13-293><a class=lnlinks href=#hl-13-293>293</a>
</span><span class=lnt id=hl-13-294><a class=lnlinks href=#hl-13-294>294</a>
</span><span class=lnt id=hl-13-295><a class=lnlinks href=#hl-13-295>295</a>
</span><span class=lnt id=hl-13-296><a class=lnlinks href=#hl-13-296>296</a>
</span><span class=lnt id=hl-13-297><a class=lnlinks href=#hl-13-297>297</a>
</span><span class=lnt id=hl-13-298><a class=lnlinks href=#hl-13-298>298</a>
</span><span class=lnt id=hl-13-299><a class=lnlinks href=#hl-13-299>299</a>
</span><span class=lnt id=hl-13-300><a class=lnlinks href=#hl-13-300>300</a>
</span><span class=lnt id=hl-13-301><a class=lnlinks href=#hl-13-301>301</a>
</span><span class=lnt id=hl-13-302><a class=lnlinks href=#hl-13-302>302</a>
</span><span class=lnt id=hl-13-303><a class=lnlinks href=#hl-13-303>303</a>
</span><span class=lnt id=hl-13-304><a class=lnlinks href=#hl-13-304>304</a>
</span><span class=lnt id=hl-13-305><a class=lnlinks href=#hl-13-305>305</a>
</span><span class=lnt id=hl-13-306><a class=lnlinks href=#hl-13-306>306</a>
</span><span class=lnt id=hl-13-307><a class=lnlinks href=#hl-13-307>307</a>
</span><span class=lnt id=hl-13-308><a class=lnlinks href=#hl-13-308>308</a>
</span><span class=lnt id=hl-13-309><a class=lnlinks href=#hl-13-309>309</a>
</span><span class=lnt id=hl-13-310><a class=lnlinks href=#hl-13-310>310</a>
</span><span class=lnt id=hl-13-311><a class=lnlinks href=#hl-13-311>311</a>
</span><span class=lnt id=hl-13-312><a class=lnlinks href=#hl-13-312>312</a>
</span><span class=lnt id=hl-13-313><a class=lnlinks href=#hl-13-313>313</a>
</span><span class=lnt id=hl-13-314><a class=lnlinks href=#hl-13-314>314</a>
</span><span class=lnt id=hl-13-315><a class=lnlinks href=#hl-13-315>315</a>
</span><span class=lnt id=hl-13-316><a class=lnlinks href=#hl-13-316>316</a>
</span><span class=lnt id=hl-13-317><a class=lnlinks href=#hl-13-317>317</a>
</span><span class=lnt id=hl-13-318><a class=lnlinks href=#hl-13-318>318</a>
</span><span class=lnt id=hl-13-319><a class=lnlinks href=#hl-13-319>319</a>
</span><span class=lnt id=hl-13-320><a class=lnlinks href=#hl-13-320>320</a>
</span><span class=lnt id=hl-13-321><a class=lnlinks href=#hl-13-321>321</a>
</span><span class=lnt id=hl-13-322><a class=lnlinks href=#hl-13-322>322</a>
</span><span class=lnt id=hl-13-323><a class=lnlinks href=#hl-13-323>323</a>
</span><span class=lnt id=hl-13-324><a class=lnlinks href=#hl-13-324>324</a>
</span><span class=lnt id=hl-13-325><a class=lnlinks href=#hl-13-325>325</a>
</span><span class=lnt id=hl-13-326><a class=lnlinks href=#hl-13-326>326</a>
</span><span class=lnt id=hl-13-327><a class=lnlinks href=#hl-13-327>327</a>
</span><span class=lnt id=hl-13-328><a class=lnlinks href=#hl-13-328>328</a>
</span><span class=lnt id=hl-13-329><a class=lnlinks href=#hl-13-329>329</a>
</span><span class=lnt id=hl-13-330><a class=lnlinks href=#hl-13-330>330</a>
</span><span class=lnt id=hl-13-331><a class=lnlinks href=#hl-13-331>331</a>
</span><span class=lnt id=hl-13-332><a class=lnlinks href=#hl-13-332>332</a>
</span><span class=lnt id=hl-13-333><a class=lnlinks href=#hl-13-333>333</a>
</span><span class=lnt id=hl-13-334><a class=lnlinks href=#hl-13-334>334</a>
</span><span class=lnt id=hl-13-335><a class=lnlinks href=#hl-13-335>335</a>
</span><span class=lnt id=hl-13-336><a class=lnlinks href=#hl-13-336>336</a>
</span><span class=lnt id=hl-13-337><a class=lnlinks href=#hl-13-337>337</a>
</span><span class=lnt id=hl-13-338><a class=lnlinks href=#hl-13-338>338</a>
</span><span class=lnt id=hl-13-339><a class=lnlinks href=#hl-13-339>339</a>
</span><span class=lnt id=hl-13-340><a class=lnlinks href=#hl-13-340>340</a>
</span><span class=lnt id=hl-13-341><a class=lnlinks href=#hl-13-341>341</a>
</span><span class=lnt id=hl-13-342><a class=lnlinks href=#hl-13-342>342</a>
</span><span class=lnt id=hl-13-343><a class=lnlinks href=#hl-13-343>343</a>
</span><span class=lnt id=hl-13-344><a class=lnlinks href=#hl-13-344>344</a>
</span><span class=lnt id=hl-13-345><a class=lnlinks href=#hl-13-345>345</a>
</span><span class=lnt id=hl-13-346><a class=lnlinks href=#hl-13-346>346</a>
</span><span class=lnt id=hl-13-347><a class=lnlinks href=#hl-13-347>347</a>
</span><span class=lnt id=hl-13-348><a class=lnlinks href=#hl-13-348>348</a>
</span><span class=lnt id=hl-13-349><a class=lnlinks href=#hl-13-349>349</a>
</span><span class=lnt id=hl-13-350><a class=lnlinks href=#hl-13-350>350</a>
</span><span class=lnt id=hl-13-351><a class=lnlinks href=#hl-13-351>351</a>
</span><span class=lnt id=hl-13-352><a class=lnlinks href=#hl-13-352>352</a>
</span><span class=lnt id=hl-13-353><a class=lnlinks href=#hl-13-353>353</a>
</span><span class=lnt id=hl-13-354><a class=lnlinks href=#hl-13-354>354</a>
</span><span class=lnt id=hl-13-355><a class=lnlinks href=#hl-13-355>355</a>
</span><span class=lnt id=hl-13-356><a class=lnlinks href=#hl-13-356>356</a>
</span><span class=lnt id=hl-13-357><a class=lnlinks href=#hl-13-357>357</a>
</span><span class=lnt id=hl-13-358><a class=lnlinks href=#hl-13-358>358</a>
</span><span class=lnt id=hl-13-359><a class=lnlinks href=#hl-13-359>359</a>
</span><span class=lnt id=hl-13-360><a class=lnlinks href=#hl-13-360>360</a>
</span><span class=lnt id=hl-13-361><a class=lnlinks href=#hl-13-361>361</a>
</span><span class=lnt id=hl-13-362><a class=lnlinks href=#hl-13-362>362</a>
</span><span class=lnt id=hl-13-363><a class=lnlinks href=#hl-13-363>363</a>
</span><span class=lnt id=hl-13-364><a class=lnlinks href=#hl-13-364>364</a>
</span><span class=lnt id=hl-13-365><a class=lnlinks href=#hl-13-365>365</a>
</span><span class=lnt id=hl-13-366><a class=lnlinks href=#hl-13-366>366</a>
</span><span class=lnt id=hl-13-367><a class=lnlinks href=#hl-13-367>367</a>
</span><span class=lnt id=hl-13-368><a class=lnlinks href=#hl-13-368>368</a>
</span><span class=lnt id=hl-13-369><a class=lnlinks href=#hl-13-369>369</a>
</span><span class=lnt id=hl-13-370><a class=lnlinks href=#hl-13-370>370</a>
</span><span class=lnt id=hl-13-371><a class=lnlinks href=#hl-13-371>371</a>
</span><span class=lnt id=hl-13-372><a class=lnlinks href=#hl-13-372>372</a>
</span><span class=lnt id=hl-13-373><a class=lnlinks href=#hl-13-373>373</a>
</span><span class=lnt id=hl-13-374><a class=lnlinks href=#hl-13-374>374</a>
</span><span class=lnt id=hl-13-375><a class=lnlinks href=#hl-13-375>375</a>
</span><span class=lnt id=hl-13-376><a class=lnlinks href=#hl-13-376>376</a>
</span><span class=lnt id=hl-13-377><a class=lnlinks href=#hl-13-377>377</a>
</span><span class=lnt id=hl-13-378><a class=lnlinks href=#hl-13-378>378</a>
</span><span class=lnt id=hl-13-379><a class=lnlinks href=#hl-13-379>379</a>
</span><span class=lnt id=hl-13-380><a class=lnlinks href=#hl-13-380>380</a>
</span><span class=lnt id=hl-13-381><a class=lnlinks href=#hl-13-381>381</a>
</span><span class=lnt id=hl-13-382><a class=lnlinks href=#hl-13-382>382</a>
</span><span class=lnt id=hl-13-383><a class=lnlinks href=#hl-13-383>383</a>
</span><span class=lnt id=hl-13-384><a class=lnlinks href=#hl-13-384>384</a>
</span><span class=lnt id=hl-13-385><a class=lnlinks href=#hl-13-385>385</a>
</span><span class=lnt id=hl-13-386><a class=lnlinks href=#hl-13-386>386</a>
</span><span class=lnt id=hl-13-387><a class=lnlinks href=#hl-13-387>387</a>
</span><span class=lnt id=hl-13-388><a class=lnlinks href=#hl-13-388>388</a>
</span><span class=lnt id=hl-13-389><a class=lnlinks href=#hl-13-389>389</a>
</span><span class=lnt id=hl-13-390><a class=lnlinks href=#hl-13-390>390</a>
</span><span class=lnt id=hl-13-391><a class=lnlinks href=#hl-13-391>391</a>
</span><span class=lnt id=hl-13-392><a class=lnlinks href=#hl-13-392>392</a>
</span><span class=lnt id=hl-13-393><a class=lnlinks href=#hl-13-393>393</a>
</span><span class=lnt id=hl-13-394><a class=lnlinks href=#hl-13-394>394</a>
</span><span class=lnt id=hl-13-395><a class=lnlinks href=#hl-13-395>395</a>
</span><span class=lnt id=hl-13-396><a class=lnlinks href=#hl-13-396>396</a>
</span><span class=lnt id=hl-13-397><a class=lnlinks href=#hl-13-397>397</a>
</span><span class=lnt id=hl-13-398><a class=lnlinks href=#hl-13-398>398</a>
</span><span class=lnt id=hl-13-399><a class=lnlinks href=#hl-13-399>399</a>
</span><span class=lnt id=hl-13-400><a class=lnlinks href=#hl-13-400>400</a>
</span><span class=lnt id=hl-13-401><a class=lnlinks href=#hl-13-401>401</a>
</span><span class=lnt id=hl-13-402><a class=lnlinks href=#hl-13-402>402</a>
</span><span class=lnt id=hl-13-403><a class=lnlinks href=#hl-13-403>403</a>
</span><span class=lnt id=hl-13-404><a class=lnlinks href=#hl-13-404>404</a>
</span><span class=lnt id=hl-13-405><a class=lnlinks href=#hl-13-405>405</a>
</span><span class=lnt id=hl-13-406><a class=lnlinks href=#hl-13-406>406</a>
</span><span class=lnt id=hl-13-407><a class=lnlinks href=#hl-13-407>407</a>
</span><span class=lnt id=hl-13-408><a class=lnlinks href=#hl-13-408>408</a>
</span><span class=lnt id=hl-13-409><a class=lnlinks href=#hl-13-409>409</a>
</span><span class=lnt id=hl-13-410><a class=lnlinks href=#hl-13-410>410</a>
</span><span class=lnt id=hl-13-411><a class=lnlinks href=#hl-13-411>411</a>
</span><span class=lnt id=hl-13-412><a class=lnlinks href=#hl-13-412>412</a>
</span><span class=lnt id=hl-13-413><a class=lnlinks href=#hl-13-413>413</a>
</span><span class=lnt id=hl-13-414><a class=lnlinks href=#hl-13-414>414</a>
</span><span class=lnt id=hl-13-415><a class=lnlinks href=#hl-13-415>415</a>
</span><span class=lnt id=hl-13-416><a class=lnlinks href=#hl-13-416>416</a>
</span><span class=lnt id=hl-13-417><a class=lnlinks href=#hl-13-417>417</a>
</span><span class=lnt id=hl-13-418><a class=lnlinks href=#hl-13-418>418</a>
</span><span class=lnt id=hl-13-419><a class=lnlinks href=#hl-13-419>419</a>
</span><span class=lnt id=hl-13-420><a class=lnlinks href=#hl-13-420>420</a>
</span><span class=lnt id=hl-13-421><a class=lnlinks href=#hl-13-421>421</a>
</span><span class=lnt id=hl-13-422><a class=lnlinks href=#hl-13-422>422</a>
</span><span class=lnt id=hl-13-423><a class=lnlinks href=#hl-13-423>423</a>
</span><span class=lnt id=hl-13-424><a class=lnlinks href=#hl-13-424>424</a>
</span><span class=lnt id=hl-13-425><a class=lnlinks href=#hl-13-425>425</a>
</span><span class=lnt id=hl-13-426><a class=lnlinks href=#hl-13-426>426</a>
</span><span class=lnt id=hl-13-427><a class=lnlinks href=#hl-13-427>427</a>
</span><span class=lnt id=hl-13-428><a class=lnlinks href=#hl-13-428>428</a>
</span><span class=lnt id=hl-13-429><a class=lnlinks href=#hl-13-429>429</a>
</span><span class=lnt id=hl-13-430><a class=lnlinks href=#hl-13-430>430</a>
</span><span class=lnt id=hl-13-431><a class=lnlinks href=#hl-13-431>431</a>
</span><span class=lnt id=hl-13-432><a class=lnlinks href=#hl-13-432>432</a>
</span><span class=lnt id=hl-13-433><a class=lnlinks href=#hl-13-433>433</a>
</span><span class=lnt id=hl-13-434><a class=lnlinks href=#hl-13-434>434</a>
</span><span class=lnt id=hl-13-435><a class=lnlinks href=#hl-13-435>435</a>
</span><span class=lnt id=hl-13-436><a class=lnlinks href=#hl-13-436>436</a>
</span><span class=lnt id=hl-13-437><a class=lnlinks href=#hl-13-437>437</a>
</span><span class=lnt id=hl-13-438><a class=lnlinks href=#hl-13-438>438</a>
</span><span class=lnt id=hl-13-439><a class=lnlinks href=#hl-13-439>439</a>
</span><span class=lnt id=hl-13-440><a class=lnlinks href=#hl-13-440>440</a>
</span><span class=lnt id=hl-13-441><a class=lnlinks href=#hl-13-441>441</a>
</span><span class=lnt id=hl-13-442><a class=lnlinks href=#hl-13-442>442</a>
</span><span class=lnt id=hl-13-443><a class=lnlinks href=#hl-13-443>443</a>
</span><span class=lnt id=hl-13-444><a class=lnlinks href=#hl-13-444>444</a>
</span><span class=lnt id=hl-13-445><a class=lnlinks href=#hl-13-445>445</a>
</span><span class=lnt id=hl-13-446><a class=lnlinks href=#hl-13-446>446</a>
</span><span class=lnt id=hl-13-447><a class=lnlinks href=#hl-13-447>447</a>
</span><span class=lnt id=hl-13-448><a class=lnlinks href=#hl-13-448>448</a>
</span><span class=lnt id=hl-13-449><a class=lnlinks href=#hl-13-449>449</a>
</span><span class=lnt id=hl-13-450><a class=lnlinks href=#hl-13-450>450</a>
</span><span class=lnt id=hl-13-451><a class=lnlinks href=#hl-13-451>451</a>
</span><span class=lnt id=hl-13-452><a class=lnlinks href=#hl-13-452>452</a>
</span><span class=lnt id=hl-13-453><a class=lnlinks href=#hl-13-453>453</a>
</span><span class=lnt id=hl-13-454><a class=lnlinks href=#hl-13-454>454</a>
</span><span class=lnt id=hl-13-455><a class=lnlinks href=#hl-13-455>455</a>
</span><span class=lnt id=hl-13-456><a class=lnlinks href=#hl-13-456>456</a>
</span><span class=lnt id=hl-13-457><a class=lnlinks href=#hl-13-457>457</a>
</span><span class=lnt id=hl-13-458><a class=lnlinks href=#hl-13-458>458</a>
</span><span class=lnt id=hl-13-459><a class=lnlinks href=#hl-13-459>459</a>
</span><span class=lnt id=hl-13-460><a class=lnlinks href=#hl-13-460>460</a>
</span><span class=lnt id=hl-13-461><a class=lnlinks href=#hl-13-461>461</a>
</span><span class=lnt id=hl-13-462><a class=lnlinks href=#hl-13-462>462</a>
</span><span class=lnt id=hl-13-463><a class=lnlinks href=#hl-13-463>463</a>
</span><span class=lnt id=hl-13-464><a class=lnlinks href=#hl-13-464>464</a>
</span><span class=lnt id=hl-13-465><a class=lnlinks href=#hl-13-465>465</a>
</span><span class=lnt id=hl-13-466><a class=lnlinks href=#hl-13-466>466</a>
</span><span class=lnt id=hl-13-467><a class=lnlinks href=#hl-13-467>467</a>
</span><span class=lnt id=hl-13-468><a class=lnlinks href=#hl-13-468>468</a>
</span><span class=lnt id=hl-13-469><a class=lnlinks href=#hl-13-469>469</a>
</span><span class=lnt id=hl-13-470><a class=lnlinks href=#hl-13-470>470</a>
</span><span class=lnt id=hl-13-471><a class=lnlinks href=#hl-13-471>471</a>
</span><span class=lnt id=hl-13-472><a class=lnlinks href=#hl-13-472>472</a>
</span><span class=lnt id=hl-13-473><a class=lnlinks href=#hl-13-473>473</a>
</span><span class=lnt id=hl-13-474><a class=lnlinks href=#hl-13-474>474</a>
</span><span class=lnt id=hl-13-475><a class=lnlinks href=#hl-13-475>475</a>
</span><span class=lnt id=hl-13-476><a class=lnlinks href=#hl-13-476>476</a>
</span><span class=lnt id=hl-13-477><a class=lnlinks href=#hl-13-477>477</a>
</span><span class=lnt id=hl-13-478><a class=lnlinks href=#hl-13-478>478</a>
</span><span class=lnt id=hl-13-479><a class=lnlinks href=#hl-13-479>479</a>
</span><span class=lnt id=hl-13-480><a class=lnlinks href=#hl-13-480>480</a>
</span><span class=lnt id=hl-13-481><a class=lnlinks href=#hl-13-481>481</a>
</span><span class=lnt id=hl-13-482><a class=lnlinks href=#hl-13-482>482</a>
</span><span class=lnt id=hl-13-483><a class=lnlinks href=#hl-13-483>483</a>
</span><span class=lnt id=hl-13-484><a class=lnlinks href=#hl-13-484>484</a>
</span><span class=lnt id=hl-13-485><a class=lnlinks href=#hl-13-485>485</a>
</span><span class=lnt id=hl-13-486><a class=lnlinks href=#hl-13-486>486</a>
</span><span class=lnt id=hl-13-487><a class=lnlinks href=#hl-13-487>487</a>
</span><span class=lnt id=hl-13-488><a class=lnlinks href=#hl-13-488>488</a>
</span><span class=lnt id=hl-13-489><a class=lnlinks href=#hl-13-489>489</a>
</span><span class=lnt id=hl-13-490><a class=lnlinks href=#hl-13-490>490</a>
</span><span class=lnt id=hl-13-491><a class=lnlinks href=#hl-13-491>491</a>
</span><span class=lnt id=hl-13-492><a class=lnlinks href=#hl-13-492>492</a>
</span><span class=lnt id=hl-13-493><a class=lnlinks href=#hl-13-493>493</a>
</span><span class=lnt id=hl-13-494><a class=lnlinks href=#hl-13-494>494</a>
</span><span class=lnt id=hl-13-495><a class=lnlinks href=#hl-13-495>495</a>
</span><span class=lnt id=hl-13-496><a class=lnlinks href=#hl-13-496>496</a>
</span><span class=lnt id=hl-13-497><a class=lnlinks href=#hl-13-497>497</a>
</span><span class=lnt id=hl-13-498><a class=lnlinks href=#hl-13-498>498</a>
</span><span class=lnt id=hl-13-499><a class=lnlinks href=#hl-13-499>499</a>
</span><span class=lnt id=hl-13-500><a class=lnlinks href=#hl-13-500>500</a>
</span><span class=lnt id=hl-13-501><a class=lnlinks href=#hl-13-501>501</a>
</span><span class=lnt id=hl-13-502><a class=lnlinks href=#hl-13-502>502</a>
</span><span class=lnt id=hl-13-503><a class=lnlinks href=#hl-13-503>503</a>
</span><span class=lnt id=hl-13-504><a class=lnlinks href=#hl-13-504>504</a>
</span><span class=lnt id=hl-13-505><a class=lnlinks href=#hl-13-505>505</a>
</span><span class=lnt id=hl-13-506><a class=lnlinks href=#hl-13-506>506</a>
</span><span class=lnt id=hl-13-507><a class=lnlinks href=#hl-13-507>507</a>
</span><span class=lnt id=hl-13-508><a class=lnlinks href=#hl-13-508>508</a>
</span><span class=lnt id=hl-13-509><a class=lnlinks href=#hl-13-509>509</a>
</span><span class=lnt id=hl-13-510><a class=lnlinks href=#hl-13-510>510</a>
</span><span class=lnt id=hl-13-511><a class=lnlinks href=#hl-13-511>511</a>
</span><span class=lnt id=hl-13-512><a class=lnlinks href=#hl-13-512>512</a>
</span><span class=lnt id=hl-13-513><a class=lnlinks href=#hl-13-513>513</a>
</span><span class=lnt id=hl-13-514><a class=lnlinks href=#hl-13-514>514</a>
</span><span class=lnt id=hl-13-515><a class=lnlinks href=#hl-13-515>515</a>
</span><span class=lnt id=hl-13-516><a class=lnlinks href=#hl-13-516>516</a>
</span><span class=lnt id=hl-13-517><a class=lnlinks href=#hl-13-517>517</a>
</span><span class=lnt id=hl-13-518><a class=lnlinks href=#hl-13-518>518</a>
</span><span class=lnt id=hl-13-519><a class=lnlinks href=#hl-13-519>519</a>
</span><span class=lnt id=hl-13-520><a class=lnlinks href=#hl-13-520>520</a>
</span><span class=lnt id=hl-13-521><a class=lnlinks href=#hl-13-521>521</a>
</span><span class=lnt id=hl-13-522><a class=lnlinks href=#hl-13-522>522</a>
</span><span class=lnt id=hl-13-523><a class=lnlinks href=#hl-13-523>523</a>
</span><span class=lnt id=hl-13-524><a class=lnlinks href=#hl-13-524>524</a>
</span><span class=lnt id=hl-13-525><a class=lnlinks href=#hl-13-525>525</a>
</span><span class=lnt id=hl-13-526><a class=lnlinks href=#hl-13-526>526</a>
</span><span class=lnt id=hl-13-527><a class=lnlinks href=#hl-13-527>527</a>
</span><span class=lnt id=hl-13-528><a class=lnlinks href=#hl-13-528>528</a>
</span><span class=lnt id=hl-13-529><a class=lnlinks href=#hl-13-529>529</a>
</span><span class=lnt id=hl-13-530><a class=lnlinks href=#hl-13-530>530</a>
</span><span class=lnt id=hl-13-531><a class=lnlinks href=#hl-13-531>531</a>
</span><span class=lnt id=hl-13-532><a class=lnlinks href=#hl-13-532>532</a>
</span><span class=lnt id=hl-13-533><a class=lnlinks href=#hl-13-533>533</a>
</span><span class=lnt id=hl-13-534><a class=lnlinks href=#hl-13-534>534</a>
</span><span class=lnt id=hl-13-535><a class=lnlinks href=#hl-13-535>535</a>
</span><span class=lnt id=hl-13-536><a class=lnlinks href=#hl-13-536>536</a>
</span><span class=lnt id=hl-13-537><a class=lnlinks href=#hl-13-537>537</a>
</span><span class=lnt id=hl-13-538><a class=lnlinks href=#hl-13-538>538</a>
</span><span class=lnt id=hl-13-539><a class=lnlinks href=#hl-13-539>539</a>
</span><span class=lnt id=hl-13-540><a class=lnlinks href=#hl-13-540>540</a>
</span><span class=lnt id=hl-13-541><a class=lnlinks href=#hl-13-541>541</a>
</span><span class=lnt id=hl-13-542><a class=lnlinks href=#hl-13-542>542</a>
</span><span class=lnt id=hl-13-543><a class=lnlinks href=#hl-13-543>543</a>
</span><span class=lnt id=hl-13-544><a class=lnlinks href=#hl-13-544>544</a>
</span><span class=lnt id=hl-13-545><a class=lnlinks href=#hl-13-545>545</a>
</span><span class=lnt id=hl-13-546><a class=lnlinks href=#hl-13-546>546</a>
</span><span class=lnt id=hl-13-547><a class=lnlinks href=#hl-13-547>547</a>
</span><span class=lnt id=hl-13-548><a class=lnlinks href=#hl-13-548>548</a>
</span><span class=lnt id=hl-13-549><a class=lnlinks href=#hl-13-549>549</a>
</span><span class=lnt id=hl-13-550><a class=lnlinks href=#hl-13-550>550</a>
</span><span class=lnt id=hl-13-551><a class=lnlinks href=#hl-13-551>551</a>
</span><span class=lnt id=hl-13-552><a class=lnlinks href=#hl-13-552>552</a>
</span><span class=lnt id=hl-13-553><a class=lnlinks href=#hl-13-553>553</a>
</span><span class=lnt id=hl-13-554><a class=lnlinks href=#hl-13-554>554</a>
</span><span class=lnt id=hl-13-555><a class=lnlinks href=#hl-13-555>555</a>
</span><span class=lnt id=hl-13-556><a class=lnlinks href=#hl-13-556>556</a>
</span><span class=lnt id=hl-13-557><a class=lnlinks href=#hl-13-557>557</a>
</span><span class=lnt id=hl-13-558><a class=lnlinks href=#hl-13-558>558</a>
</span><span class=lnt id=hl-13-559><a class=lnlinks href=#hl-13-559>559</a>
</span><span class=lnt id=hl-13-560><a class=lnlinks href=#hl-13-560>560</a>
</span><span class=lnt id=hl-13-561><a class=lnlinks href=#hl-13-561>561</a>
</span><span class=lnt id=hl-13-562><a class=lnlinks href=#hl-13-562>562</a>
</span><span class=lnt id=hl-13-563><a class=lnlinks href=#hl-13-563>563</a>
</span><span class=lnt id=hl-13-564><a class=lnlinks href=#hl-13-564>564</a>
</span><span class=lnt id=hl-13-565><a class=lnlinks href=#hl-13-565>565</a>
</span><span class=lnt id=hl-13-566><a class=lnlinks href=#hl-13-566>566</a>
</span><span class=lnt id=hl-13-567><a class=lnlinks href=#hl-13-567>567</a>
</span><span class=lnt id=hl-13-568><a class=lnlinks href=#hl-13-568>568</a>
</span><span class=lnt id=hl-13-569><a class=lnlinks href=#hl-13-569>569</a>
</span><span class=lnt id=hl-13-570><a class=lnlinks href=#hl-13-570>570</a>
</span><span class=lnt id=hl-13-571><a class=lnlinks href=#hl-13-571>571</a>
</span><span class=lnt id=hl-13-572><a class=lnlinks href=#hl-13-572>572</a>
</span><span class=lnt id=hl-13-573><a class=lnlinks href=#hl-13-573>573</a>
</span><span class=lnt id=hl-13-574><a class=lnlinks href=#hl-13-574>574</a>
</span><span class=lnt id=hl-13-575><a class=lnlinks href=#hl-13-575>575</a>
</span><span class=lnt id=hl-13-576><a class=lnlinks href=#hl-13-576>576</a>
</span><span class=lnt id=hl-13-577><a class=lnlinks href=#hl-13-577>577</a>
</span><span class=lnt id=hl-13-578><a class=lnlinks href=#hl-13-578>578</a>
</span><span class=lnt id=hl-13-579><a class=lnlinks href=#hl-13-579>579</a>
</span><span class=lnt id=hl-13-580><a class=lnlinks href=#hl-13-580>580</a>
</span><span class=lnt id=hl-13-581><a class=lnlinks href=#hl-13-581>581</a>
</span><span class=lnt id=hl-13-582><a class=lnlinks href=#hl-13-582>582</a>
</span><span class=lnt id=hl-13-583><a class=lnlinks href=#hl-13-583>583</a>
</span><span class=lnt id=hl-13-584><a class=lnlinks href=#hl-13-584>584</a>
</span><span class=lnt id=hl-13-585><a class=lnlinks href=#hl-13-585>585</a>
</span><span class=lnt id=hl-13-586><a class=lnlinks href=#hl-13-586>586</a>
</span><span class=lnt id=hl-13-587><a class=lnlinks href=#hl-13-587>587</a>
</span><span class=lnt id=hl-13-588><a class=lnlinks href=#hl-13-588>588</a>
</span><span class=lnt id=hl-13-589><a class=lnlinks href=#hl-13-589>589</a>
</span><span class=lnt id=hl-13-590><a class=lnlinks href=#hl-13-590>590</a>
</span><span class=lnt id=hl-13-591><a class=lnlinks href=#hl-13-591>591</a>
</span><span class=lnt id=hl-13-592><a class=lnlinks href=#hl-13-592>592</a>
</span><span class=lnt id=hl-13-593><a class=lnlinks href=#hl-13-593>593</a>
</span><span class=lnt id=hl-13-594><a class=lnlinks href=#hl-13-594>594</a>
</span><span class=lnt id=hl-13-595><a class=lnlinks href=#hl-13-595>595</a>
</span><span class=lnt id=hl-13-596><a class=lnlinks href=#hl-13-596>596</a>
</span><span class=lnt id=hl-13-597><a class=lnlinks href=#hl-13-597>597</a>
</span><span class=lnt id=hl-13-598><a class=lnlinks href=#hl-13-598>598</a>
</span><span class=lnt id=hl-13-599><a class=lnlinks href=#hl-13-599>599</a>
</span><span class=lnt id=hl-13-600><a class=lnlinks href=#hl-13-600>600</a>
</span><span class=lnt id=hl-13-601><a class=lnlinks href=#hl-13-601>601</a>
</span><span class=lnt id=hl-13-602><a class=lnlinks href=#hl-13-602>602</a>
</span><span class=lnt id=hl-13-603><a class=lnlinks href=#hl-13-603>603</a>
</span><span class=lnt id=hl-13-604><a class=lnlinks href=#hl-13-604>604</a>
</span><span class=lnt id=hl-13-605><a class=lnlinks href=#hl-13-605>605</a>
</span><span class=lnt id=hl-13-606><a class=lnlinks href=#hl-13-606>606</a>
</span><span class=lnt id=hl-13-607><a class=lnlinks href=#hl-13-607>607</a>
</span><span class=lnt id=hl-13-608><a class=lnlinks href=#hl-13-608>608</a>
</span><span class=lnt id=hl-13-609><a class=lnlinks href=#hl-13-609>609</a>
</span><span class=lnt id=hl-13-610><a class=lnlinks href=#hl-13-610>610</a>
</span><span class=lnt id=hl-13-611><a class=lnlinks href=#hl-13-611>611</a>
</span><span class=lnt id=hl-13-612><a class=lnlinks href=#hl-13-612>612</a>
</span><span class=lnt id=hl-13-613><a class=lnlinks href=#hl-13-613>613</a>
</span><span class=lnt id=hl-13-614><a class=lnlinks href=#hl-13-614>614</a>
</span><span class=lnt id=hl-13-615><a class=lnlinks href=#hl-13-615>615</a>
</span><span class=lnt id=hl-13-616><a class=lnlinks href=#hl-13-616>616</a>
</span><span class=lnt id=hl-13-617><a class=lnlinks href=#hl-13-617>617</a>
</span><span class=lnt id=hl-13-618><a class=lnlinks href=#hl-13-618>618</a>
</span><span class=lnt id=hl-13-619><a class=lnlinks href=#hl-13-619>619</a>
</span><span class=lnt id=hl-13-620><a class=lnlinks href=#hl-13-620>620</a>
</span><span class=lnt id=hl-13-621><a class=lnlinks href=#hl-13-621>621</a>
</span><span class=lnt id=hl-13-622><a class=lnlinks href=#hl-13-622>622</a>
</span><span class=lnt id=hl-13-623><a class=lnlinks href=#hl-13-623>623</a>
</span><span class=lnt id=hl-13-624><a class=lnlinks href=#hl-13-624>624</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * JWT (JSON Web Token) 구현 예시 - JavaScript (Node.js)
</span></span></span><span class=line><span class=cl><span class=cm> * 대규모 이커머스 플랫폼의 사용자 인증 및 권한 관리 시스템
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>jwt</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;jsonwebtoken&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>crypto</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;crypto&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>redis</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;redis&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>fs</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;fs&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>class</span> <span class=nx>JWTManager</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * JWT 매니저 클래스 생성자
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {Object} options - 설정 옵션
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=nx>constructor</span><span class=p>(</span><span class=nx>options</span> <span class=o>=</span> <span class=p>{})</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>algorithm</span> <span class=o>=</span> <span class=s1>&#39;RS256&#39;</span><span class=p>;</span> <span class=c1>// 비대칭 알고리즘 사용
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>accessTokenExpireMinutes</span> <span class=o>=</span> <span class=mi>15</span><span class=p>;</span> <span class=c1>// 액세스 토큰 만료: 15분
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>refreshTokenExpireDays</span> <span class=o>=</span> <span class=mi>7</span><span class=p>;</span> <span class=c1>// 리프레시 토큰 만료: 7일
</span></span></span><span class=line><span class=cl><span class=c1></span>        
</span></span><span class=line><span class=cl>        <span class=c1>// Redis 클라이언트 초기화 (블랙리스트 관리용)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>redisClient</span> <span class=o>=</span> <span class=nx>redis</span><span class=p>.</span><span class=nx>createClient</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>host</span><span class=o>:</span> <span class=nx>options</span><span class=p>.</span><span class=nx>redisHost</span> <span class=o>||</span> <span class=s1>&#39;localhost&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>port</span><span class=o>:</span> <span class=nx>options</span><span class=p>.</span><span class=nx>redisPort</span> <span class=o>||</span> <span class=mi>6379</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>redisClient</span><span class=p>.</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;error&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Redis 연결 오류:&#39;</span><span class=p>,</span> <span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// RSA 키 쌍 로드 또는 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>loadOrGenerateKeys</span><span class=p>(</span><span class=nx>options</span><span class=p>.</span><span class=nx>privateKeyPath</span><span class=p>,</span> <span class=nx>options</span><span class=p>.</span><span class=nx>publicKeyPath</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * RSA 키 쌍 로드 또는 생성
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {string} privateKeyPath - 개인키 파일 경로
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {string} publicKeyPath - 공개키 파일 경로
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=nx>loadOrGenerateKeys</span><span class=p>(</span><span class=nx>privateKeyPath</span><span class=p>,</span> <span class=nx>publicKeyPath</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>privateKeyPath</span> <span class=o>&amp;&amp;</span> <span class=nx>publicKeyPath</span> <span class=o>&amp;&amp;</span> 
</span></span><span class=line><span class=cl>                <span class=nx>fs</span><span class=p>.</span><span class=nx>existsSync</span><span class=p>(</span><span class=nx>privateKeyPath</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>existsSync</span><span class=p>(</span><span class=nx>publicKeyPath</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>// 기존 키 로드
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>this</span><span class=p>.</span><span class=nx>privateKey</span> <span class=o>=</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=nx>privateKeyPath</span><span class=p>,</span> <span class=s1>&#39;utf8&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>this</span><span class=p>.</span><span class=nx>publicKey</span> <span class=o>=</span> <span class=nx>fs</span><span class=p>.</span><span class=nx>readFileSync</span><span class=p>(</span><span class=nx>publicKeyPath</span><span class=p>,</span> <span class=s1>&#39;utf8&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;기존 RSA 키 쌍 로드 완료&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>// 새로운 키 생성 (개발/테스트용)
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>this</span><span class=p>.</span><span class=nx>generateKeys</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;키 로드 실패:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>this</span><span class=p>.</span><span class=nx>generateKeys</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * 새로운 RSA 키 쌍 생성 (개발/테스트용)
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=nx>generateKeys</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;새로운 RSA 키 쌍 생성 중…&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=p>{</span> <span class=nx>publicKey</span><span class=p>,</span> <span class=nx>privateKey</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>crypto</span><span class=p>.</span><span class=nx>generateKeyPairSync</span><span class=p>(</span><span class=s1>&#39;rsa&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>modulusLength</span><span class=o>:</span> <span class=mi>2048</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>publicKeyEncoding</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;spki&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>format</span><span class=o>:</span> <span class=s1>&#39;pem&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=nx>privateKeyEncoding</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;pkcs8&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>format</span><span class=o>:</span> <span class=s1>&#39;pem&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>privateKey</span> <span class=o>=</span> <span class=nx>privateKey</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>publicKey</span> <span class=o>=</span> <span class=nx>publicKey</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;RSA 키 쌍 생성 완료&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * 액세스 토큰 생성
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {string} userId - 사용자 ID
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {string} username - 사용자명
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {Array} roles - 사용자 역할 목록
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {Array} permissions - 사용자 권한 목록
</span></span></span><span class=line><span class=cl><span class=cm>     * @returns {string} 생성된 JWT 액세스 토큰
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=nx>createAccessToken</span><span class=p>(</span><span class=nx>userId</span><span class=p>,</span> <span class=nx>username</span><span class=p>,</span> <span class=nx>roles</span> <span class=o>=</span> <span class=p>[],</span> <span class=nx>permissions</span> <span class=o>=</span> <span class=p>[])</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>now</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>exp</span> <span class=o>=</span> <span class=nx>now</span> <span class=o>+</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>accessTokenExpireMinutes</span> <span class=o>*</span> <span class=mi>60</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// JWT 클레임 구성
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>sub</span><span class=o>:</span> <span class=nx>userId</span><span class=p>,</span>                     <span class=c1>// Subject (사용자 ID)
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>username</span><span class=o>:</span> <span class=nx>username</span><span class=p>,</span>              <span class=c1>// 사용자명
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>roles</span><span class=o>:</span> <span class=nx>roles</span><span class=p>,</span>                    <span class=c1>// 역할 목록
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>permissions</span><span class=o>:</span> <span class=nx>permissions</span><span class=p>,</span>        <span class=c1>// 권한 목록
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>iss</span><span class=o>:</span> <span class=s1>&#39;ecommerce-platform&#39;</span><span class=p>,</span>      <span class=c1>// Issuer (발급자)
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>aud</span><span class=o>:</span> <span class=s1>&#39;ecommerce-api&#39;</span><span class=p>,</span>           <span class=c1>// Audience (대상)
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>iat</span><span class=o>:</span> <span class=nx>now</span><span class=p>,</span>                       <span class=c1>// Issued At (발급 시간)
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>exp</span><span class=o>:</span> <span class=nx>exp</span><span class=p>,</span>                       <span class=c1>// Expiration Time (만료 시간)
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>jti</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>generateJTI</span><span class=p>()</span>         <span class=c1>// JWT ID (고유 식별자)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 토큰 생성 및 서명
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>(</span><span class=nx>payload</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>privateKey</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>algorithm</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>algorithm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>header</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>kid</span><span class=o>:</span> <span class=s1>&#39;main-signing-key&#39;</span> <span class=c1>// Key ID
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>token</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * 리프레시 토큰 생성
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {string} userId - 사용자 ID
</span></span></span><span class=line><span class=cl><span class=cm>     * @returns {string} 생성된 JWT 리프레시 토큰
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=nx>createRefreshToken</span><span class=p>(</span><span class=nx>userId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>now</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>exp</span> <span class=o>=</span> <span class=nx>now</span> <span class=o>+</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>refreshTokenExpireDays</span> <span class=o>*</span> <span class=mi>24</span> <span class=o>*</span> <span class=mi>60</span> <span class=o>*</span> <span class=mi>60</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>sub</span><span class=o>:</span> <span class=nx>userId</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>type</span><span class=o>:</span> <span class=s1>&#39;refresh&#39;</span><span class=p>,</span>                <span class=c1>// 토큰 타입 명시
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>iss</span><span class=o>:</span> <span class=s1>&#39;ecommerce-platform&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>aud</span><span class=o>:</span> <span class=s1>&#39;ecommerce-auth&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>iat</span><span class=o>:</span> <span class=nx>now</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>exp</span><span class=o>:</span> <span class=nx>exp</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>jti</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>generateJTI</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>(</span><span class=nx>payload</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>privateKey</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>algorithm</span><span class=o>:</span> <span class=k>this</span><span class=p>.</span><span class=nx>algorithm</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * 토큰 검증
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {string} token - 검증할 JWT 토큰
</span></span></span><span class=line><span class=cl><span class=cm>     * @returns {Promise&lt;Object|null&gt;} 검증 성공 시 페이로드, 실패 시 null
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>verifyToken</span><span class=p>(</span><span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 블랙리스트 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kr>const</span> <span class=nx>isBlacklisted</span> <span class=o>=</span> <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>isBlacklisted</span><span class=p>(</span><span class=nx>token</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>isBlacklisted</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;블랙리스트에 등록된 토큰입니다.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 토큰 디코딩 및 검증
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kr>const</span> <span class=nx>payload</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>token</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>publicKey</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>algorithms</span><span class=o>:</span> <span class=p>[</span><span class=k>this</span><span class=p>.</span><span class=nx>algorithm</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>audience</span><span class=o>:</span> <span class=s1>&#39;ecommerce-api&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>issuer</span><span class=o>:</span> <span class=s1>&#39;ecommerce-platform&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>payload</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>error</span><span class=p>.</span><span class=nx>name</span> <span class=o>===</span> <span class=s1>&#39;TokenExpiredError&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;토큰이 만료되었습니다.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nx>error</span><span class=p>.</span><span class=nx>name</span> <span class=o>===</span> <span class=s1>&#39;JsonWebTokenError&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;유효하지 않은 토큰입니다:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;토큰 검증 중 오류:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * 리프레시 토큰을 사용하여 새로운 액세스 토큰 생성
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {string} refreshToken - 리프레시 토큰
</span></span></span><span class=line><span class=cl><span class=cm>     * @returns {Promise&lt;string|null&gt;} 새로운 액세스 토큰 또는 null
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>refreshAccessToken</span><span class=p>(</span><span class=nx>refreshToken</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 리프레시 토큰 검증
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kr>const</span> <span class=nx>payload</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>refreshToken</span><span class=p>,</span> <span class=k>this</span><span class=p>.</span><span class=nx>publicKey</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>algorithms</span><span class=o>:</span> <span class=p>[</span><span class=k>this</span><span class=p>.</span><span class=nx>algorithm</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>audience</span><span class=o>:</span> <span class=s1>&#39;ecommerce-auth&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>issuer</span><span class=o>:</span> <span class=s1>&#39;ecommerce-platform&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>payload</span><span class=p>.</span><span class=nx>type</span> <span class=o>!==</span> <span class=s1>&#39;refresh&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;리프레시 토큰이 아닙니다.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>userId</span> <span class=o>=</span> <span class=nx>payload</span><span class=p>.</span><span class=nx>sub</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>userId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;사용자 ID가 없습니다.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 실제 환경에서는 DB에서 사용자 정보 조회
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kr>const</span> <span class=nx>userInfo</span> <span class=o>=</span> <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>getUserInfo</span><span class=p>(</span><span class=nx>userId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>userInfo</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;사용자 정보를 찾을 수 없습니다.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 새로운 액세스 토큰 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kr>const</span> <span class=nx>newAccessToken</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>createAccessToken</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=nx>userId</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>userInfo</span><span class=p>.</span><span class=nx>username</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>userInfo</span><span class=p>.</span><span class=nx>roles</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>userInfo</span><span class=p>.</span><span class=nx>permissions</span>
</span></span><span class=line><span class=cl>            <span class=p>);</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nx>newAccessToken</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>error</span><span class=p>.</span><span class=nx>name</span> <span class=o>===</span> <span class=s1>&#39;TokenExpiredError&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;리프레시 토큰이 만료되었습니다.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;유효하지 않은 리프레시 토큰입니다:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>.</span><span class=nx>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * 토큰을 블랙리스트에 추가
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {string} token - 블랙리스트에 추가할 토큰
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>blacklistToken</span><span class=p>(</span><span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// 토큰의 jti 추출 (서명 검증 없이)
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kr>const</span> <span class=nx>unverifiedPayload</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>decode</span><span class=p>(</span><span class=nx>token</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>jti</span> <span class=o>=</span> <span class=nx>unverifiedPayload</span><span class=o>?</span><span class=p>.</span><span class=nx>jti</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>exp</span> <span class=o>=</span> <span class=nx>unverifiedPayload</span><span class=o>?</span><span class=p>.</span><span class=nx>exp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>jti</span> <span class=o>&amp;&amp;</span> <span class=nx>exp</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>// 만료 시간까지만 블랙리스트에 보관
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=kr>const</span> <span class=nx>ttl</span> <span class=o>=</span> <span class=nx>exp</span> <span class=o>-</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>ttl</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>redisClient</span><span class=p>.</span><span class=nx>setEx</span><span class=p>(</span><span class=sb>`blacklist:</span><span class=si>${</span><span class=nx>jti</span><span class=si>}</span><span class=sb>`</span><span class=p>,</span> <span class=nx>ttl</span><span class=p>,</span> <span class=s1>&#39;true&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`토큰이 블랙리스트에 추가되었습니다: </span><span class=si>${</span><span class=nx>jti</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;블랙리스트 추가 중 오류:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * 토큰이 블랙리스트에 있는지 확인
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {string} token - 확인할 토큰
</span></span></span><span class=line><span class=cl><span class=cm>     * @returns {Promise&lt;boolean&gt;} 블랙리스트 여부
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>isBlacklisted</span><span class=p>(</span><span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>unverifiedPayload</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>decode</span><span class=p>(</span><span class=nx>token</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>jti</span> <span class=o>=</span> <span class=nx>unverifiedPayload</span><span class=o>?</span><span class=p>.</span><span class=nx>jti</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>jti</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>exists</span> <span class=o>=</span> <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>redisClient</span><span class=p>.</span><span class=nx>exists</span><span class=p>(</span><span class=sb>`blacklist:</span><span class=si>${</span><span class=nx>jti</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>exists</span> <span class=o>===</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * JWT ID 생성
</span></span></span><span class=line><span class=cl><span class=cm>     * @returns {string} 고유한 JWT ID
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=nx>generateJTI</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>crypto</span><span class=p>.</span><span class=nx>randomBytes</span><span class=p>(</span><span class=mi>32</span><span class=p>).</span><span class=nx>toString</span><span class=p>(</span><span class=s1>&#39;hex&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * 사용자 정보 조회 (실제 환경에서는 DB 연동)
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {string} userId - 사용자 ID
</span></span></span><span class=line><span class=cl><span class=cm>     * @returns {Promise&lt;Object|null&gt;} 사용자 정보
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>getUserInfo</span><span class=p>(</span><span class=nx>userId</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 실제 환경에서는 데이터베이스에서 조회
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>mockUsers</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user123&#39;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>username</span><span class=o>:</span> <span class=s1>&#39;john_doe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>roles</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;customer&#39;</span><span class=p>,</span> <span class=s1>&#39;premium&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>permissions</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;read:products&#39;</span><span class=p>,</span> <span class=s1>&#39;write:orders&#39;</span><span class=p>,</span> <span class=s1>&#39;read:profile&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;admin456&#39;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>username</span><span class=o>:</span> <span class=s1>&#39;admin_user&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>roles</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;admin&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nx>permissions</span><span class=o>:</span> <span class=p>[</span><span class=s1>&#39;read:*&#39;</span><span class=p>,</span> <span class=s1>&#39;write:*&#39;</span><span class=p>,</span> <span class=s1>&#39;delete:*&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>mockUsers</span><span class=p>[</span><span class=nx>userId</span><span class=p>]</span> <span class=o>||</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * 인증 미들웨어 클래스
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kr>class</span> <span class=nx>AuthMiddleware</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * 인증 미들웨어 생성자
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {JWTManager} jwtManager - JWT 매니저 인스턴스
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=nx>constructor</span><span class=p>(</span><span class=nx>jwtManager</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=nx>jwtManager</span> <span class=o>=</span> <span class=nx>jwtManager</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * Express.js 미들웨어 함수
</span></span></span><span class=line><span class=cl><span class=cm>     * @returns {Function} Express 미들웨어 함수
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=nx>middleware</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>authHeader</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>authorization</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>userInfo</span> <span class=o>=</span> <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>authenticate</span><span class=p>(</span><span class=nx>authHeader</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=nx>userInfo</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>req</span><span class=p>.</span><span class=nx>user</span> <span class=o>=</span> <span class=nx>userInfo</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=nx>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                        <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Unauthorized&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;유효한 인증 토큰이 필요합니다.&#39;</span>
</span></span><span class=line><span class=cl>                    <span class=p>});</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;인증 미들웨어 오류:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>500</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Internal Server Error&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;서버 내부 오류가 발생했습니다.&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * Authorization 헤더를 통한 인증
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {string} authorizationHeader - Authorization 헤더 값
</span></span></span><span class=line><span class=cl><span class=cm>     * @returns {Promise&lt;Object|null&gt;} 인증 성공 시 사용자 정보, 실패 시 null
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=kr>async</span> <span class=nx>authenticate</span><span class=p>(</span><span class=nx>authorizationHeader</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>authorizationHeader</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Bearer 토큰 추출
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kr>const</span> <span class=nx>parts</span> <span class=o>=</span> <span class=nx>authorizationHeader</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>parts</span><span class=p>.</span><span class=nx>length</span> <span class=o>!==</span> <span class=mi>2</span> <span class=o>||</span> <span class=nx>parts</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>toLowerCase</span><span class=p>()</span> <span class=o>!==</span> <span class=s1>&#39;bearer&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>parts</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>payload</span> <span class=o>=</span> <span class=kr>await</span> <span class=k>this</span><span class=p>.</span><span class=nx>jwtManager</span><span class=p>.</span><span class=nx>verifyToken</span><span class=p>(</span><span class=nx>token</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>payload</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>userId</span><span class=o>:</span> <span class=nx>payload</span><span class=p>.</span><span class=nx>sub</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>username</span><span class=o>:</span> <span class=nx>payload</span><span class=p>.</span><span class=nx>username</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>roles</span><span class=o>:</span> <span class=nx>payload</span><span class=p>.</span><span class=nx>roles</span> <span class=o>||</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>                <span class=nx>permissions</span><span class=o>:</span> <span class=nx>payload</span><span class=p>.</span><span class=nx>permissions</span> <span class=o>||</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * 권한 확인 미들웨어
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {string} requiredPermission - 필요한 권한
</span></span></span><span class=line><span class=cl><span class=cm>     * @returns {Function} Express 미들웨어 함수
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=nx>requirePermission</span><span class=p>(</span><span class=nx>requiredPermission</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Unauthorized&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;인증이 필요합니다.&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>hasPermission</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>,</span> <span class=nx>requiredPermission</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>403</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Forbidden&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;권한이 부족합니다.&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * 권한 확인
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {Object} userInfo - 사용자 정보
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {string} requiredPermission - 필요한 권한
</span></span></span><span class=line><span class=cl><span class=cm>     * @returns {boolean} 권한 보유 여부
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=nx>hasPermission</span><span class=p>(</span><span class=nx>userInfo</span><span class=p>,</span> <span class=nx>requiredPermission</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>userPermissions</span> <span class=o>=</span> <span class=nx>userInfo</span><span class=p>.</span><span class=nx>permissions</span> <span class=o>||</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 와일드카드 권한 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=nx>userPermissions</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=s1>&#39;read:*&#39;</span><span class=p>)</span> <span class=o>||</span> <span class=nx>userPermissions</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=s1>&#39;write:*&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// 구체적 권한 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>return</span> <span class=nx>userPermissions</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=nx>requiredPermission</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * 역할 확인 미들웨어
</span></span></span><span class=line><span class=cl><span class=cm>     * @param {string} requiredRole - 필요한 역할
</span></span></span><span class=line><span class=cl><span class=cm>     * @returns {Function} Express 미들웨어 함수
</span></span></span><span class=line><span class=cl><span class=cm>     */</span>
</span></span><span class=line><span class=cl>    <span class=nx>requireRole</span><span class=p>(</span><span class=nx>requiredRole</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Unauthorized&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;인증이 필요합니다.&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>userRoles</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>.</span><span class=nx>roles</span> <span class=o>||</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>userRoles</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=nx>requiredRole</span><span class=p>)</span> <span class=o>||</span> <span class=nx>userRoles</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=s1>&#39;admin&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>403</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Forbidden&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;필요한 역할이 없습니다.&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * Express.js 애플리케이션 예시
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>createApp</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>express</span><span class=p>.</span><span class=nx>json</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// JWT 매니저 및 인증 미들웨어 초기화
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>jwtManager</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>JWTManager</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>authMiddleware</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>AuthMiddleware</span><span class=p>(</span><span class=nx>jwtManager</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 로그인 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/auth/login&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=p>{</span> <span class=nx>username</span><span class=p>,</span> <span class=nx>password</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1>// 실제 환경에서는 DB에서 사용자 검증
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>if</span> <span class=p>(</span><span class=nx>username</span> <span class=o>===</span> <span class=s1>&#39;john_doe&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>password</span> <span class=o>===</span> <span class=s1>&#39;password123&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>accessToken</span> <span class=o>=</span> <span class=nx>jwtManager</span><span class=p>.</span><span class=nx>createAccessToken</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;user123&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;john_doe&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=p>[</span><span class=s1>&#39;customer&#39;</span><span class=p>,</span> <span class=s1>&#39;premium&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=p>[</span><span class=s1>&#39;read:products&#39;</span><span class=p>,</span> <span class=s1>&#39;write:orders&#39;</span><span class=p>,</span> <span class=s1>&#39;read:profile&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=kr>const</span> <span class=nx>refreshToken</span> <span class=o>=</span> <span class=nx>jwtManager</span><span class=p>.</span><span class=nx>createRefreshToken</span><span class=p>(</span><span class=s1>&#39;user123&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=nx>accessToken</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>refreshToken</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>expiresIn</span><span class=o>:</span> <span class=nx>jwtManager</span><span class=p>.</span><span class=nx>accessTokenExpireMinutes</span> <span class=o>*</span> <span class=mi>60</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Invalid credentials&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;로그인 오류:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>500</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Internal server error&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 토큰 갱신 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/auth/refresh&#39;</span><span class=p>,</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=p>{</span> <span class=nx>refreshToken</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>refreshToken</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>400</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Refresh token is required&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>newAccessToken</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>jwtManager</span><span class=p>.</span><span class=nx>refreshAccessToken</span><span class=p>(</span><span class=nx>refreshToken</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=nx>newAccessToken</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=nx>accessToken</span><span class=o>:</span> <span class=nx>newAccessToken</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nx>expiresIn</span><span class=o>:</span> <span class=nx>jwtManager</span><span class=p>.</span><span class=nx>accessTokenExpireMinutes</span> <span class=o>*</span> <span class=mi>60</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Invalid refresh token&#39;</span>
</span></span><span class=line><span class=cl>                <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;토큰 갱신 오류:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>500</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Internal server error&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 로그아웃 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/auth/logout&#39;</span><span class=p>,</span> <span class=nx>authMiddleware</span><span class=p>.</span><span class=nx>middleware</span><span class=p>(),</span> <span class=kr>async</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>authHeader</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>authorization</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>authHeader</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=kr>await</span> <span class=nx>jwtManager</span><span class=p>.</span><span class=nx>blacklistToken</span><span class=p>(</span><span class=nx>token</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;Successfully logged out&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;로그아웃 오류:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>500</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;Internal server error&#39;</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 보호된 리소스 - 상품 목록 조회
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/api/products&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>        <span class=nx>authMiddleware</span><span class=p>.</span><span class=nx>middleware</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=nx>authMiddleware</span><span class=p>.</span><span class=nx>requirePermission</span><span class=p>(</span><span class=s1>&#39;read:products&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;상품 목록 조회 성공&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>user</span><span class=o>:</span> <span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>products</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Laptop&#39;</span><span class=p>,</span> <span class=nx>price</span><span class=o>:</span> <span class=mi>1000</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Mouse&#39;</span><span class=p>,</span> <span class=nx>price</span><span class=o>:</span> <span class=mi>20</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 보호된 리소스 - 주문 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/api/orders&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>authMiddleware</span><span class=p>.</span><span class=nx>middleware</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=nx>authMiddleware</span><span class=p>.</span><span class=nx>requirePermission</span><span class=p>(</span><span class=s1>&#39;write:orders&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;주문 생성 성공&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>user</span><span class=o>:</span> <span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>orderId</span><span class=o>:</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>().</span><span class=nx>toString</span><span class=p>(</span><span class=mi>36</span><span class=p>).</span><span class=nx>substr</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>9</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 관리자 전용 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/api/admin/users&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>authMiddleware</span><span class=p>.</span><span class=nx>middleware</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=nx>authMiddleware</span><span class=p>.</span><span class=nx>requireRole</span><span class=p>(</span><span class=s1>&#39;admin&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;사용자 목록 조회 성공&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>users</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=s1>&#39;user123&#39;</span><span class=p>,</span> <span class=nx>username</span><span class=o>:</span> <span class=s1>&#39;john_doe&#39;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=s1>&#39;admin456&#39;</span><span class=p>,</span> <span class=nx>username</span><span class=o>:</span> <span class=s1>&#39;admin_user&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>app</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 사용 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>createApp</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>PORT</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>PORT</span> <span class=o>||</span> <span class=mi>3000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=nx>PORT</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`서버가 포트 </span><span class=si>${</span><span class=nx>PORT</span><span class=si>}</span><span class=sb>에서 실행 중입니다.`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;\n=== API 사용 예시 ===&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;1. 로그인: POST /auth/login&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;   Body: {&#34;username&#34;: &#34;john_doe&#34;, &#34;password&#34;: &#34;password123&#34;}&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;2. 상품 조회: GET /api/products&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;   Header: Authorization: Bearer &lt;access_token&gt;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;3. 주문 생성: POST /api/orders&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;   Header: Authorization: Bearer &lt;access_token&gt;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;4. 토큰 갱신: POST /auth/refresh&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;   Body: {&#34;refreshToken&#34;: &#34;&lt;refresh_token&gt;&#34;}&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;5. 로그아웃: POST /auth/logout&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;   Header: Authorization: Bearer &lt;access_token&gt;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;서버 시작 오류:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 스크립트 직접 실행 시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>if</span> <span class=p>(</span><span class=nx>require</span><span class=p>.</span><span class=nx>main</span> <span class=o>===</span> <span class=nx>module</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>main</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>JWTManager</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>AuthMiddleware</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>createApp</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>구분</th><th>고려사항</th><th>세부 내용</th><th>권장사항</th></tr></thead><tbody><tr><td>보안</td><td>알고리즘 선택</td><td>HS256 vs RS256 선택 기준</td><td>분산 환경에서는 RS256, 단일 서비스는 HS256</td></tr><tr><td>보안</td><td>키 관리</td><td>서명키 보안 저장 및 순환</td><td>HSM 사용, 정기적 키 순환 (90 일 주기)</td></tr><tr><td>보안</td><td>토큰 저장</td><td>클라이언트 측 안전한 저장</td><td>httpOnly 쿠키 또는 메모리 저장 선호</td></tr><tr><td>성능</td><td>토큰 크기</td><td>페이로드 크기 최적화</td><td>필수 클레임만 포함, 압축 고려</td></tr><tr><td>성능</td><td>캐싱 전략</td><td>공개키 캐싱 및 검증 최적화</td><td>Redis 기반 키 캐싱, TTL 설정</td></tr><tr><td>운영</td><td>만료 시간</td><td>적절한 토큰 수명 설정</td><td>액세스 토큰: 15 분 -1 시간, 리프레시: 7-30 일</td></tr><tr><td>운영</td><td>모니터링</td><td>토큰 사용 패턴 모니터링</td><td>비정상 토큰 사용 감지, 로깅 시스템 구축</td></tr><tr><td>확장성</td><td>상태 관리</td><td>무효화 메커니즘 설계</td><td>블랙리스트 + 짧은 만료 시간 조합</td></tr></tbody></table><h4 id=최적화하기-위한-고려사항-및-주의할-점>최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#최적화하기-위한-고려사항-및-주의할-점>#</a></h4><table><thead><tr><th>구분</th><th>최적화 영역</th><th>세부 방법</th><th>권장사항</th></tr></thead><tbody><tr><td>성능</td><td>서명 검증</td><td>알고리즘별 성능 차이 고려</td><td>ECDSA > RSA > HMAC 순서로 검토</td></tr><tr><td>성능</td><td>메모리 사용</td><td>토큰 캐싱 전략</td><td>LRU 캐시 + TTL 기반 자동 정리</td></tr><tr><td>성능</td><td>네트워크</td><td>토큰 크기 최소화</td><td>불필요한 클레임 제거, 압축 적용</td></tr><tr><td>보안</td><td>엔트로피</td><td>강력한 키 생성</td><td>최소 256 비트 엔트로피, CSPRNG 사용</td></tr><tr><td>보안</td><td>검증 로직</td><td>클레임 검증 최적화</td><td>필수 클레임 우선 검증, 조기 반환</td></tr><tr><td>확장성</td><td>분산 처리</td><td>키 배포 메커니즘</td><td>JWKS 엔드포인트, CDN 활용</td></tr><tr><td>확장성</td><td>로드 밸런싱</td><td>무상태성 활용</td><td>세션 고정 없는 로드 밸런싱</td></tr><tr><td>유지보수</td><td>버전 관리</td><td>키 버전 관리 시스템</td><td>kid 헤더 활용, 점진적 키 순환</td></tr></tbody></table><h4 id=주제와-관련하여-주목할-내용>주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#주제와-관련하여-주목할-내용>#</a></h4><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>표준</td><td>RFC 문서</td><td>JWT (RFC 7519)</td><td>JSON Web Token 기본 표준</td></tr><tr><td>표준</td><td>RFC 문서</td><td>JWS (RFC 7515)</td><td>JSON Web Signature 서명 표준</td></tr><tr><td>표준</td><td>RFC 문서</td><td>JWE (RFC 7516)</td><td>JSON Web Encryption 암호화 표준</td></tr><tr><td>표준</td><td>RFC 문서</td><td>JWA (RFC 7518)</td><td>JSON Web Algorithms 알고리즘 표준</td></tr><tr><td>표준</td><td>RFC 문서</td><td>JWK (RFC 7517)</td><td>JSON Web Key 키 표준</td></tr><tr><td>보안</td><td>취약점</td><td>Algorithm Confusion</td><td>none 알고리즘 악용 공격</td></tr><tr><td>보안</td><td>취약점</td><td>Key Confusion</td><td>공개키/대칭키 혼동 공격</td></tr><tr><td>보안</td><td>취약점</td><td>Signature Stripping</td><td>서명 제거 공격</td></tr><tr><td>프로토콜</td><td>통합</td><td>OAuth 2.0</td><td>인가 프레임워크와의 결합</td></tr><tr><td>프로토콜</td><td>통합</td><td>OpenID Connect</td><td>인증 레이어 구현</td></tr><tr><td>라이브러리</td><td>Python</td><td>PyJWT</td><td>파이썬 JWT 구현체</td></tr><tr><td>라이브러리</td><td>JavaScript</td><td>jsonwebtoken</td><td>Node.js JWT 라이브러리</td></tr><tr><td>라이브러리</td><td>Java</td><td>jjwt</td><td>자바 JWT 라이브러리</td></tr><tr><td>플랫폼</td><td>클라우드</td><td>Auth0</td><td>관리형 인증 서비스</td></tr><tr><td>플랫폼</td><td>클라우드</td><td>AWS Cognito</td><td>AWS 인증 서비스</td></tr></tbody></table><h4 id=반드시-학습해야할-내용>반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야할-내용>#</a></h4><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>암호학</td><td>해시</td><td>HMAC</td><td>키 기반 메시지 인증 코드</td></tr><tr><td>암호학</td><td>서명</td><td>RSA</td><td>공개키 암호화 알고리즘</td></tr><tr><td>암호학</td><td>서명</td><td>ECDSA</td><td>타원곡선 디지털 서명</td></tr><tr><td>보안</td><td>공격</td><td>XSS</td><td>크로스 사이트 스크립팅 방어</td></tr><tr><td>보안</td><td>공격</td><td>CSRF</td><td>크로스 사이트 요청 위조 방어</td></tr><tr><td>아키텍처</td><td>패턴</td><td>상태 비저장</td><td>Stateless 아키텍처 설계</td></tr><tr><td>아키텍처</td><td>패턴</td><td>마이크로서비스</td><td>분산 시스템 인증 설계</td></tr><tr><td>표준</td><td>프로토콜</td><td>OAuth 2.0</td><td>권한 부여 프레임워크</td></tr><tr><td>표준</td><td>프로토콜</td><td>OpenID Connect</td><td>인증 레이어 표준</td></tr><tr><td>운영</td><td>모니터링</td><td>로깅</td><td>보안 이벤트 로깅 전략</td></tr><tr><td>운영</td><td>모니터링</td><td>메트릭</td><td>토큰 사용량 및 성능 지표</td></tr></tbody></table><hr><h3 id=용어-정리-1>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-1>#</a></h3><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>기본 개념</td><td>JSON Web Token (JWT)</td><td>JSON 객체로 정보를 안전하게 전송하기 위한 표준 (RFC 7519)</td></tr><tr><td>기본 개념</td><td>Claims</td><td>JWT 페이로드에 포함된 정보 조각들</td></tr><tr><td>기본 개념</td><td>Base64URL</td><td>URL-safe 한 Base64 인코딩 방식</td></tr><tr><td>구조</td><td>Header</td><td>JWT 의 첫 번째 부분으로 메타데이터 포함</td></tr><tr><td>구조</td><td>Payload</td><td>JWT 의 두 번째 부분으로 클레임 정보 포함</td></tr><tr><td>구조</td><td>Signature</td><td>JWT 의 세 번째 부분으로 무결성 보장</td></tr><tr><td>알고리즘</td><td>HS256</td><td>HMAC with SHA-256, 대칭키 알고리즘</td></tr><tr><td>알고리즘</td><td>RS256</td><td>RSA Signature with SHA-256, 비대칭키 알고리즘</td></tr><tr><td>알고리즘</td><td>ES256</td><td>ECDSA with P-256 and SHA-256</td></tr><tr><td>클레임</td><td>iss (Issuer)</td><td>토큰 발급자</td></tr><tr><td>클레임</td><td>sub (Subject)</td><td>토큰 주체 (사용자 ID)</td></tr><tr><td>클레임</td><td>aud (Audience)</td><td>토큰 대상</td></tr><tr><td>클레임</td><td>exp (Expiration Time)</td><td>토큰 만료 시간</td></tr><tr><td>클레임</td><td>nbf (Not Before)</td><td>토큰 유효 시작 시간</td></tr><tr><td>클레임</td><td>iat (Issued At)</td><td>토큰 발급 시간</td></tr><tr><td>클레임</td><td>jti (JWT ID)</td><td>토큰 고유 식별자</td></tr><tr><td>보안</td><td>JWS (JSON Web Signature)</td><td>디지털 서명을 통한 무결성 보장</td></tr><tr><td>보안</td><td>JWE (JSON Web Encryption)</td><td>암호화를 통한 기밀성 보장</td></tr><tr><td>보안</td><td>JOSE (JSON Object Signing and Encryption)</td><td>JSON 기반 암호화 표준 집합</td></tr><tr><td>운영</td><td>Access Token</td><td>리소스 접근을 위한 단기 토큰</td></tr><tr><td>운영</td><td>Refresh Token</td><td>액세스 토큰 갱신을 위한 장기 토큰</td></tr><tr><td>운영</td><td>Token Rotation</td><td>토큰 순환을 통한 보안 강화</td></tr><tr><td>운영</td><td>Blacklist</td><td>무효화된 토큰 목록</td></tr><tr><td>기술</td><td>HMAC (Hash-based Message Authentication Code)</td><td>키 기반 메시지 인증 코드</td></tr><tr><td>기술</td><td>RSA</td><td>Rivest-Shamir-Adleman 공개키 암호화</td></tr><tr><td>기술</td><td>ECDSA</td><td>Elliptic Curve Digital Signature Algorithm</td></tr></tbody></table><hr><h3 id=참고-및-출처-1>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-1>#</a></h3><ul><li><a href=https://tools.ietf.org/html/rfc7519>RFC 7519 - JSON Web Token (JWT)</a></li><li><a href=https://tools.ietf.org/html/rfc7515>RFC 7515 - JSON Web Signature (JWS)</a></li><li><a href=https://tools.ietf.org/html/rfc7516>RFC 7516 - JSON Web Encryption (JWE)</a></li><li><a href=https://tools.ietf.org/html/rfc7518>RFC 7518 - JSON Web Algorithms (JWA)</a></li><li><a href=https://jwt.io/introduction>JWT.io - JSON Web Token Introduction</a></li><li><a href=https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_for_Java_Cheat_Sheet.html>OWASP JWT Security Cheat Sheet</a></li><li><a href=https://auth0.com/blog/rs256-vs-hs256-whats-the-difference/>Auth0 Blog - RS256 vs HS256</a></li><li><a href=https://www.ietf.org/archive/id/draft-sheffer-oauth-rfc8725bis-01.html>IETF Internet-Draft - JWT Best Current Practices</a></li></ul><hr><p>JSON Web Token(JWT) 은 웹 애플리케이션과 서비스 간에 안전하게 정보를 전송하기 위한 개방형 표준 (RFC 7519) 이다. 이 기술은 특히 사용자 인증과 정보 교환을 위한 효율적이고 안전한 방법으로, 분산 시스템과 마이크로서비스 아키텍처에서 널리 사용되고 있다. 오늘날 많은 기업들이 전통적인 세션 기반 인증에서 JWT 기반 인증으로 전환하는 추세를 보이고 있다.</p><h4 id=jwt-의-기본-개념>JWT 의 기본 개념<a hidden class=anchor aria-hidden=true href=#jwt-의-기본-개념>#</a></h4><p>JWT 는 JSON 객체를 암호화하고 서명하여 생성된 문자열로, 세 부분으로 구성된다:<br><code>헤더(Header), 페이로드(Payload), 서명(Signature).</code><br>각 부분은 점 (.) 으로 구분되며, Base64Url 로 인코딩된다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>xxxxx.yyyyy.zzzzz
</span></span></code></pre></td></tr></table></div></div><p>여기서:</p><ul><li><code>xxxxx</code> 는 헤더 (알고리즘과 토큰 타입)</li><li><code>yyyyy</code> 는 페이로드 (클레임 정보)</li><li><code>zzzzz</code> 는 서명</li></ul><p>이 구조는 정보를 안전하게 전송하면서도 쉽게 처리할 수 있도록 설계되었다.</p><h4 id=jwt-의-세-가지-구성-요소-상세-분석>JWT 의 세 가지 구성 요소 상세 분석<a hidden class=anchor aria-hidden=true href=#jwt-의-세-가지-구성-요소-상세-분석>#</a></h4><h5 id=헤더-header>헤더 (Header)<a hidden class=anchor aria-hidden=true href=#헤더-header>#</a></h5><p>헤더는 일반적으로 두 가지 정보를 담고 있다:</p><ul><li>토큰 유형 (일반적으로 &ldquo;JWT&rdquo;)</li><li>사용된 서명 알고리즘 (예: HMAC SHA256, RSA)</li></ul><p>예시:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1>1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2>2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3>3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;alg&#34;</span><span class=p>:</span> <span class=s2>&#34;HS256&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;typ&#34;</span><span class=p>:</span> <span class=s2>&#34;JWT&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>이 JSON 객체는 Base64Url 로 인코딩되어 JWT 의 첫 번째 부분을 형성한다.</p><h5 id=페이로드-payload>페이로드 (Payload)<a hidden class=anchor aria-hidden=true href=#페이로드-payload>#</a></h5><p>페이로드에는 사용자 정보나 추가 데이터를 포함하는 클레임 (claim) 이 들어있다.</p><p>클레임은 세 가지 유형으로 분류된다:</p><ol><li><strong>등록된 클레임 (Registered claims)</strong>: 미리 정의된 권장 클레임들<ul><li><code>iss</code>(발행자)</li><li><code>sub</code>(주제)</li><li><code>exp</code>(만료 시간)</li><li><code>iat</code>(발행 시간)</li><li><code>nbf</code>(활성화 시간)</li><li><code>jti</code>(JWT ID)</li></ul></li><li><strong>공개 클레임 (Public claims)</strong>: JWT 사용자가 정의하지만 충돌을 피하기 위해 IANA JSON Web Token Registry 에 등록하거나 URI 형식으로 정의</li><li><strong>비공개 클레임 (Private claims)</strong>: 특정 당사자 간에 정보를 공유하기 위해 생성된 사용자 정의 클레임</li></ol><p>예시:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1>1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2>2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3>3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4>4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5>5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6>6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;sub&#34;</span><span class=p>:</span> <span class=s2>&#34;1234567890&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;홍길동&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;admin&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;iat&#34;</span><span class=p>:</span> <span class=mi>1625240000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;exp&#34;</span><span class=p>:</span> <span class=mi>1625243600</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>이 페이로드도 Base64Url 로 인코딩되어 JWT 의 두 번째 부분을 형성한다. 중요한 점은 이 인코딩이 암호화가 아니라는 것이다. 따라서 페이로드에 민감한 정보 (비밀번호 등) 를 포함해서는 안 된다.</p><h5 id=서명-signature>서명 (Signature)<a hidden class=anchor aria-hidden=true href=#서명-signature>#</a></h5><p>서명은 JWT 의 마지막 부분으로, 인코딩된 헤더, 인코딩된 페이로드, 비밀 키, 그리고 헤더에 명시된 알고리즘을 사용하여 생성된다.</p><p>예를 들어, HMAC SHA256 알고리즘을 사용한다면:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1>1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2>2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3>3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4>4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>HMACSHA256</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>base64UrlEncode</span><span class=p>(</span><span class=n>header</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;.&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=n>base64UrlEncode</span><span class=p>(</span><span class=n>payload</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=n>secret</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>이 서명은 메시지가 변경되지 않았는지 확인하고, JWT 를 발행한 당사자가 맞는지 검증하는 데 사용된다.</p><h4 id=jwt-작동-메커니즘>JWT 작동 메커니즘<a hidden class=anchor aria-hidden=true href=#jwt-작동-메커니즘>#</a></h4><p>JWT 인증의 일반적인 흐름은 다음과 같다:</p><ol><li><p><strong>사용자 로그인</strong>: 사용자가 자격 증명 (사용자 이름/비밀번호) 으로 서버에 로그인한다.</p></li><li><p><strong>JWT 발급</strong>: 서버는 자격 증명을 검증한 후, 비밀 키를 사용하여 JWT 를 생성하고 클라이언트에 반환한다.</p></li><li><p><strong>JWT 저장</strong>: 클라이언트는 JWT 를 로컬 스토리지, 세션 스토리지, 또는 쿠키에 저장한다.</p></li><li><p><strong>요청 인증</strong>: 클라이언트는 보호된 경로나 리소스에 접근할 때마다 Authorization 헤더에 JWT 를 포함시킨다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Authorization: Bearer &lt;token&gt;
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>토큰 검증</strong>: 서버는 JWT 의 서명을 검증하고, 만료 여부를 확인한 후 요청을 처리한다.</p></li><li><p><strong>응답 반환</strong>: 토큰이 유효하면 서버는 요청된 데이터를 응답으로 반환한다.</p></li></ol><p>이러한 프로세스는 서버가 사용자의 상태를 저장할 필요 없이 인증을 처리할 수 있게 해준다 (무상태 인증).</p><h4 id=jwt-구현-예시>JWT 구현 예시<a hidden class=anchor aria-hidden=true href=#jwt-구현-예시>#</a></h4><h5 id=서버-측-구현-nodejsexpress>서버 측 구현 (Node.js/Express)<a hidden class=anchor aria-hidden=true href=#서버-측-구현-nodejsexpress>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12>12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13>13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14>14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15>15</a>
</span><span class=lnt id=hl-19-16><a class=lnlinks href=#hl-19-16>16</a>
</span><span class=lnt id=hl-19-17><a class=lnlinks href=#hl-19-17>17</a>
</span><span class=lnt id=hl-19-18><a class=lnlinks href=#hl-19-18>18</a>
</span><span class=lnt id=hl-19-19><a class=lnlinks href=#hl-19-19>19</a>
</span><span class=lnt id=hl-19-20><a class=lnlinks href=#hl-19-20>20</a>
</span><span class=lnt id=hl-19-21><a class=lnlinks href=#hl-19-21>21</a>
</span><span class=lnt id=hl-19-22><a class=lnlinks href=#hl-19-22>22</a>
</span><span class=lnt id=hl-19-23><a class=lnlinks href=#hl-19-23>23</a>
</span><span class=lnt id=hl-19-24><a class=lnlinks href=#hl-19-24>24</a>
</span><span class=lnt id=hl-19-25><a class=lnlinks href=#hl-19-25>25</a>
</span><span class=lnt id=hl-19-26><a class=lnlinks href=#hl-19-26>26</a>
</span><span class=lnt id=hl-19-27><a class=lnlinks href=#hl-19-27>27</a>
</span><span class=lnt id=hl-19-28><a class=lnlinks href=#hl-19-28>28</a>
</span><span class=lnt id=hl-19-29><a class=lnlinks href=#hl-19-29>29</a>
</span><span class=lnt id=hl-19-30><a class=lnlinks href=#hl-19-30>30</a>
</span><span class=lnt id=hl-19-31><a class=lnlinks href=#hl-19-31>31</a>
</span><span class=lnt id=hl-19-32><a class=lnlinks href=#hl-19-32>32</a>
</span><span class=lnt id=hl-19-33><a class=lnlinks href=#hl-19-33>33</a>
</span><span class=lnt id=hl-19-34><a class=lnlinks href=#hl-19-34>34</a>
</span><span class=lnt id=hl-19-35><a class=lnlinks href=#hl-19-35>35</a>
</span><span class=lnt id=hl-19-36><a class=lnlinks href=#hl-19-36>36</a>
</span><span class=lnt id=hl-19-37><a class=lnlinks href=#hl-19-37>37</a>
</span><span class=lnt id=hl-19-38><a class=lnlinks href=#hl-19-38>38</a>
</span><span class=lnt id=hl-19-39><a class=lnlinks href=#hl-19-39>39</a>
</span><span class=lnt id=hl-19-40><a class=lnlinks href=#hl-19-40>40</a>
</span><span class=lnt id=hl-19-41><a class=lnlinks href=#hl-19-41>41</a>
</span><span class=lnt id=hl-19-42><a class=lnlinks href=#hl-19-42>42</a>
</span><span class=lnt id=hl-19-43><a class=lnlinks href=#hl-19-43>43</a>
</span><span class=lnt id=hl-19-44><a class=lnlinks href=#hl-19-44>44</a>
</span><span class=lnt id=hl-19-45><a class=lnlinks href=#hl-19-45>45</a>
</span><span class=lnt id=hl-19-46><a class=lnlinks href=#hl-19-46>46</a>
</span><span class=lnt id=hl-19-47><a class=lnlinks href=#hl-19-47>47</a>
</span><span class=lnt id=hl-19-48><a class=lnlinks href=#hl-19-48>48</a>
</span><span class=lnt id=hl-19-49><a class=lnlinks href=#hl-19-49>49</a>
</span><span class=lnt id=hl-19-50><a class=lnlinks href=#hl-19-50>50</a>
</span><span class=lnt id=hl-19-51><a class=lnlinks href=#hl-19-51>51</a>
</span><span class=lnt id=hl-19-52><a class=lnlinks href=#hl-19-52>52</a>
</span><span class=lnt id=hl-19-53><a class=lnlinks href=#hl-19-53>53</a>
</span><span class=lnt id=hl-19-54><a class=lnlinks href=#hl-19-54>54</a>
</span><span class=lnt id=hl-19-55><a class=lnlinks href=#hl-19-55>55</a>
</span><span class=lnt id=hl-19-56><a class=lnlinks href=#hl-19-56>56</a>
</span><span class=lnt id=hl-19-57><a class=lnlinks href=#hl-19-57>57</a>
</span><span class=lnt id=hl-19-58><a class=lnlinks href=#hl-19-58>58</a>
</span><span class=lnt id=hl-19-59><a class=lnlinks href=#hl-19-59>59</a>
</span><span class=lnt id=hl-19-60><a class=lnlinks href=#hl-19-60>60</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>jwt</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;jsonwebtoken&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>bodyParser</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;body-parser&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>SECRET_KEY</span> <span class=o>=</span> <span class=s1>&#39;your_secret_key&#39;</span><span class=p>;</span> <span class=c1>// 실제 환경에서는 환경변수 등으로 안전하게 관리해야 함
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>bodyParser</span><span class=p>.</span><span class=nx>json</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 로그인 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 실제 구현에서는 데이터베이스에서 사용자 조회 및 비밀번호 검증 필요
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>username</span><span class=p>,</span> <span class=nx>password</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 사용자 검증 예시
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>username</span> <span class=o>===</span> <span class=s1>&#39;admin&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>password</span> <span class=o>===</span> <span class=s1>&#39;password&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 사용자 정보 기반으로 JWT 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>username</span><span class=o>:</span> <span class=s1>&#39;admin&#39;</span><span class=p>,</span> <span class=nx>role</span><span class=o>:</span> <span class=s1>&#39;admin&#39;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span> <span class=nx>user_id</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span> <span class=nx>username</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>username</span><span class=p>,</span> <span class=nx>role</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>role</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>SECRET_KEY</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span> <span class=nx>expiresIn</span><span class=o>:</span> <span class=s1>&#39;2h&#39;</span> <span class=p>}</span> <span class=c1>// 토큰 만료 시간 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span> <span class=nx>success</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span> <span class=nx>token</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>success</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;인증 실패&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// JWT 검증 미들웨어
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>authenticateToken</span><span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>authHeader</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>headers</span><span class=p>[</span><span class=s1>&#39;authorization&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>authHeader</span> <span class=o>&amp;&amp;</span> <span class=nx>authHeader</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>];</span> <span class=c1>// Bearer TOKEN 형식에서 TOKEN 추출
</span></span></span><span class=line><span class=cl><span class=c1></span>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;인증 토큰이 필요합니다&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>token</span><span class=p>,</span> <span class=nx>SECRET_KEY</span><span class=p>,</span> <span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>decoded</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>403</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;토큰이 유효하지 않습니다&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>req</span><span class=p>.</span><span class=nx>user</span> <span class=o>=</span> <span class=nx>decoded</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 보호된 라우트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/protected&#39;</span><span class=p>,</span> <span class=nx>authenticateToken</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span> 
</span></span><span class=line><span class=cl>    <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;인증된 접근 성공&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=nx>user</span><span class=o>:</span> <span class=nx>req</span><span class=p>.</span><span class=nx>user</span> 
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=mi>3000</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;서버가 3000번 포트에서 실행 중입니다&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=클라이언트-측-구현-javascript>클라이언트 측 구현 (JavaScript)<a hidden class=anchor aria-hidden=true href=#클라이언트-측-구현-javascript>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1> 1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2> 2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3> 3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4> 4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5> 5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6> 6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7> 7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8> 8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9> 9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10>10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11>11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12>12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13>13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14>14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15>15</a>
</span><span class=lnt id=hl-20-16><a class=lnlinks href=#hl-20-16>16</a>
</span><span class=lnt id=hl-20-17><a class=lnlinks href=#hl-20-17>17</a>
</span><span class=lnt id=hl-20-18><a class=lnlinks href=#hl-20-18>18</a>
</span><span class=lnt id=hl-20-19><a class=lnlinks href=#hl-20-19>19</a>
</span><span class=lnt id=hl-20-20><a class=lnlinks href=#hl-20-20>20</a>
</span><span class=lnt id=hl-20-21><a class=lnlinks href=#hl-20-21>21</a>
</span><span class=lnt id=hl-20-22><a class=lnlinks href=#hl-20-22>22</a>
</span><span class=lnt id=hl-20-23><a class=lnlinks href=#hl-20-23>23</a>
</span><span class=lnt id=hl-20-24><a class=lnlinks href=#hl-20-24>24</a>
</span><span class=lnt id=hl-20-25><a class=lnlinks href=#hl-20-25>25</a>
</span><span class=lnt id=hl-20-26><a class=lnlinks href=#hl-20-26>26</a>
</span><span class=lnt id=hl-20-27><a class=lnlinks href=#hl-20-27>27</a>
</span><span class=lnt id=hl-20-28><a class=lnlinks href=#hl-20-28>28</a>
</span><span class=lnt id=hl-20-29><a class=lnlinks href=#hl-20-29>29</a>
</span><span class=lnt id=hl-20-30><a class=lnlinks href=#hl-20-30>30</a>
</span><span class=lnt id=hl-20-31><a class=lnlinks href=#hl-20-31>31</a>
</span><span class=lnt id=hl-20-32><a class=lnlinks href=#hl-20-32>32</a>
</span><span class=lnt id=hl-20-33><a class=lnlinks href=#hl-20-33>33</a>
</span><span class=lnt id=hl-20-34><a class=lnlinks href=#hl-20-34>34</a>
</span><span class=lnt id=hl-20-35><a class=lnlinks href=#hl-20-35>35</a>
</span><span class=lnt id=hl-20-36><a class=lnlinks href=#hl-20-36>36</a>
</span><span class=lnt id=hl-20-37><a class=lnlinks href=#hl-20-37>37</a>
</span><span class=lnt id=hl-20-38><a class=lnlinks href=#hl-20-38>38</a>
</span><span class=lnt id=hl-20-39><a class=lnlinks href=#hl-20-39>39</a>
</span><span class=lnt id=hl-20-40><a class=lnlinks href=#hl-20-40>40</a>
</span><span class=lnt id=hl-20-41><a class=lnlinks href=#hl-20-41>41</a>
</span><span class=lnt id=hl-20-42><a class=lnlinks href=#hl-20-42>42</a>
</span><span class=lnt id=hl-20-43><a class=lnlinks href=#hl-20-43>43</a>
</span><span class=lnt id=hl-20-44><a class=lnlinks href=#hl-20-44>44</a>
</span><span class=lnt id=hl-20-45><a class=lnlinks href=#hl-20-45>45</a>
</span><span class=lnt id=hl-20-46><a class=lnlinks href=#hl-20-46>46</a>
</span><span class=lnt id=hl-20-47><a class=lnlinks href=#hl-20-47>47</a>
</span><span class=lnt id=hl-20-48><a class=lnlinks href=#hl-20-48>48</a>
</span><span class=lnt id=hl-20-49><a class=lnlinks href=#hl-20-49>49</a>
</span><span class=lnt id=hl-20-50><a class=lnlinks href=#hl-20-50>50</a>
</span><span class=lnt id=hl-20-51><a class=lnlinks href=#hl-20-51>51</a>
</span><span class=lnt id=hl-20-52><a class=lnlinks href=#hl-20-52>52</a>
</span><span class=lnt id=hl-20-53><a class=lnlinks href=#hl-20-53>53</a>
</span><span class=lnt id=hl-20-54><a class=lnlinks href=#hl-20-54>54</a>
</span><span class=lnt id=hl-20-55><a class=lnlinks href=#hl-20-55>55</a>
</span><span class=lnt id=hl-20-56><a class=lnlinks href=#hl-20-56>56</a>
</span><span class=lnt id=hl-20-57><a class=lnlinks href=#hl-20-57>57</a>
</span><span class=lnt id=hl-20-58><a class=lnlinks href=#hl-20-58>58</a>
</span><span class=lnt id=hl-20-59><a class=lnlinks href=#hl-20-59>59</a>
</span><span class=lnt id=hl-20-60><a class=lnlinks href=#hl-20-60>60</a>
</span><span class=lnt id=hl-20-61><a class=lnlinks href=#hl-20-61>61</a>
</span><span class=lnt id=hl-20-62><a class=lnlinks href=#hl-20-62>62</a>
</span><span class=lnt id=hl-20-63><a class=lnlinks href=#hl-20-63>63</a>
</span><span class=lnt id=hl-20-64><a class=lnlinks href=#hl-20-64>64</a>
</span><span class=lnt id=hl-20-65><a class=lnlinks href=#hl-20-65>65</a>
</span><span class=lnt id=hl-20-66><a class=lnlinks href=#hl-20-66>66</a>
</span><span class=lnt id=hl-20-67><a class=lnlinks href=#hl-20-67>67</a>
</span><span class=lnt id=hl-20-68><a class=lnlinks href=#hl-20-68>68</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 로그인 함수
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>login</span><span class=p>(</span><span class=nx>username</span><span class=p>,</span> <span class=nx>password</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/json&#39;</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>body</span><span class=o>:</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span> <span class=nx>username</span><span class=p>,</span> <span class=nx>password</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>response</span><span class=p>.</span><span class=nx>ok</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>message</span> <span class=o>||</span> <span class=s1>&#39;로그인에 실패했습니다&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 토큰 저장 (로컬 스토리지 사용 예시)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>localStorage</span><span class=p>.</span><span class=nx>setItem</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>,</span> <span class=nx>data</span><span class=p>.</span><span class=nx>token</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;로그인 오류:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>throw</span> <span class=nx>error</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 보호된 리소스 요청 함수
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>fetchProtectedResource</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>localStorage</span><span class=p>.</span><span class=nx>getItem</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;인증 토큰이 없습니다. 로그인이 필요합니다.&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;/protected&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;GET&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Authorization&#39;</span><span class=o>:</span> <span class=sb>`Bearer </span><span class=si>${</span><span class=nx>token</span><span class=si>}</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>response</span><span class=p>.</span><span class=nx>ok</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>response</span><span class=p>.</span><span class=nx>status</span> <span class=o>===</span> <span class=mi>401</span> <span class=o>||</span> <span class=nx>response</span><span class=p>.</span><span class=nx>status</span> <span class=o>===</span> <span class=mi>403</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 토큰이 만료되었거나 유효하지 않은 경우
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>localStorage</span><span class=p>.</span><span class=nx>removeItem</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 로그인 페이지로 리디렉션
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s1>&#39;/login-page&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;요청에 실패했습니다&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;보호된 리소스 요청 오류:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>throw</span> <span class=nx>error</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 로그아웃 함수
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>logout</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>localStorage</span><span class=p>.</span><span class=nx>removeItem</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 로그인 페이지로 리디렉션
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s1>&#39;/login-page&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=jwt-의-장점>JWT 의 장점<a hidden class=anchor aria-hidden=true href=#jwt-의-장점>#</a></h4><ol><li><strong>무상태 (Stateless)</strong>: 서버는 인증 상태를 저장할 필요가 없어, 수평적 확장이 용이하고 메모리 부담이 적다.</li><li><strong>확장성</strong>: 분산 시스템이나 마이크로서비스 아키텍처에서 효과적으로 사용할 수 있다.</li><li><strong>크로스 도메인/CORS</strong>: 다른 도메인에서도 토큰 사용이 가능하여 여러 서비스 간 인증 공유가 용이하다.</li><li><strong>표준화</strong>: 개방형 표준 (RFC 7519) 을 준수하며, 다양한 언어와 플랫폼에서 구현체가 존재한다.</li><li><strong>자체 포함 (Self-contained)</strong>: 토큰 자체에 필요한 모든 정보가 포함되어 있어, 추가 조회가 필요 없다.</li><li><strong>디커플링 (Decoupling)</strong>: 인증 로직과 비즈니스 로직의 분리가 용이하다.</li><li><strong>모바일 호환성</strong>: 모바일 환경에서도 쉽게 사용할 수 있다.</li></ol><h4 id=jwt-의-단점과-보안-고려사항>JWT 의 단점과 보안 고려사항<a hidden class=anchor aria-hidden=true href=#jwt-의-단점과-보안-고려사항>#</a></h4><ol><li><strong>토큰 크기</strong>: JWTs 는 세션 ID 에 비해 상대적으로 크기가 클 수 있어, 네트워크 오버헤드가 발생할 수 있다.</li><li><strong>저장된 토큰 취약점</strong>: 클라이언트에 저장된 토큰은 XSS 공격에 취약할 수 있다.</li><li><strong>토큰 취소 어려움</strong>: 일단 발급된 토큰은 만료되기 전까지 유효하므로, 즉시 무효화하기 어렵다.</li><li><strong>비밀 키 관리</strong>: 비밀 키가 노출되면 토큰을 위조할 수 있어, 키 관리가 중요하다.</li><li><strong>페이로드 데이터 제한</strong>: 페이로드는 암호화되지 않고 단지 인코딩될 뿐이므로, 민감한 정보를 포함해서는 안 된다.</li><li><strong>만료 시간 관리</strong>: 토큰의 만료 시간을 적절하게 설정해야 보안과 사용자 경험 사이의 균형을 맞출 수 있다.</li></ol><h4 id=jwt-보안-강화-방법>JWT 보안 강화 방법<a hidden class=anchor aria-hidden=true href=#jwt-보안-강화-방법>#</a></h4><h5 id=토큰-저장-보안>토큰 저장 보안<a hidden class=anchor aria-hidden=true href=#토큰-저장-보안>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span><span class=lnt id=hl-21-11><a class=lnlinks href=#hl-21-11>11</a>
</span><span class=lnt id=hl-21-12><a class=lnlinks href=#hl-21-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 쿠키에 토큰 저장 (더 안전한 접근 방식)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>setTokenCookie</span><span class=p>(</span><span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>document</span><span class=p>.</span><span class=nx>cookie</span> <span class=o>=</span> <span class=sb>`token=</span><span class=si>${</span><span class=nx>token</span><span class=si>}</span><span class=sb>; path=/; secure; samesite=strict; httponly`</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 토큰 쿠키 읽기 함수
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>getTokenFromCookie</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>value</span> <span class=o>=</span> <span class=sb>`; </span><span class=si>${</span><span class=nb>document</span><span class=p>.</span><span class=nx>cookie</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>parts</span> <span class=o>=</span> <span class=nx>value</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=sb>`; token=`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>parts</span><span class=p>.</span><span class=nx>length</span> <span class=o>===</span> <span class=mi>2</span><span class=p>)</span> <span class=k>return</span> <span class=nx>parts</span><span class=p>.</span><span class=nx>pop</span><span class=p>().</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;;&#39;</span><span class=p>).</span><span class=nx>shift</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=리프레시-토큰-구현>리프레시 토큰 구현<a hidden class=anchor aria-hidden=true href=#리프레시-토큰-구현>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1> 1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2> 2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3> 3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4> 4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5> 5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6> 6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7> 7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8> 8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9> 9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10>10</a>
</span><span class=lnt id=hl-22-11><a class=lnlinks href=#hl-22-11>11</a>
</span><span class=lnt id=hl-22-12><a class=lnlinks href=#hl-22-12>12</a>
</span><span class=lnt id=hl-22-13><a class=lnlinks href=#hl-22-13>13</a>
</span><span class=lnt id=hl-22-14><a class=lnlinks href=#hl-22-14>14</a>
</span><span class=lnt id=hl-22-15><a class=lnlinks href=#hl-22-15>15</a>
</span><span class=lnt id=hl-22-16><a class=lnlinks href=#hl-22-16>16</a>
</span><span class=lnt id=hl-22-17><a class=lnlinks href=#hl-22-17>17</a>
</span><span class=lnt id=hl-22-18><a class=lnlinks href=#hl-22-18>18</a>
</span><span class=lnt id=hl-22-19><a class=lnlinks href=#hl-22-19>19</a>
</span><span class=lnt id=hl-22-20><a class=lnlinks href=#hl-22-20>20</a>
</span><span class=lnt id=hl-22-21><a class=lnlinks href=#hl-22-21>21</a>
</span><span class=lnt id=hl-22-22><a class=lnlinks href=#hl-22-22>22</a>
</span><span class=lnt id=hl-22-23><a class=lnlinks href=#hl-22-23>23</a>
</span><span class=lnt id=hl-22-24><a class=lnlinks href=#hl-22-24>24</a>
</span><span class=lnt id=hl-22-25><a class=lnlinks href=#hl-22-25>25</a>
</span><span class=lnt id=hl-22-26><a class=lnlinks href=#hl-22-26>26</a>
</span><span class=lnt id=hl-22-27><a class=lnlinks href=#hl-22-27>27</a>
</span><span class=lnt id=hl-22-28><a class=lnlinks href=#hl-22-28>28</a>
</span><span class=lnt id=hl-22-29><a class=lnlinks href=#hl-22-29>29</a>
</span><span class=lnt id=hl-22-30><a class=lnlinks href=#hl-22-30>30</a>
</span><span class=lnt id=hl-22-31><a class=lnlinks href=#hl-22-31>31</a>
</span><span class=lnt id=hl-22-32><a class=lnlinks href=#hl-22-32>32</a>
</span><span class=lnt id=hl-22-33><a class=lnlinks href=#hl-22-33>33</a>
</span><span class=lnt id=hl-22-34><a class=lnlinks href=#hl-22-34>34</a>
</span><span class=lnt id=hl-22-35><a class=lnlinks href=#hl-22-35>35</a>
</span><span class=lnt id=hl-22-36><a class=lnlinks href=#hl-22-36>36</a>
</span><span class=lnt id=hl-22-37><a class=lnlinks href=#hl-22-37>37</a>
</span><span class=lnt id=hl-22-38><a class=lnlinks href=#hl-22-38>38</a>
</span><span class=lnt id=hl-22-39><a class=lnlinks href=#hl-22-39>39</a>
</span><span class=lnt id=hl-22-40><a class=lnlinks href=#hl-22-40>40</a>
</span><span class=lnt id=hl-22-41><a class=lnlinks href=#hl-22-41>41</a>
</span><span class=lnt id=hl-22-42><a class=lnlinks href=#hl-22-42>42</a>
</span><span class=lnt id=hl-22-43><a class=lnlinks href=#hl-22-43>43</a>
</span><span class=lnt id=hl-22-44><a class=lnlinks href=#hl-22-44>44</a>
</span><span class=lnt id=hl-22-45><a class=lnlinks href=#hl-22-45>45</a>
</span><span class=lnt id=hl-22-46><a class=lnlinks href=#hl-22-46>46</a>
</span><span class=lnt id=hl-22-47><a class=lnlinks href=#hl-22-47>47</a>
</span><span class=lnt id=hl-22-48><a class=lnlinks href=#hl-22-48>48</a>
</span><span class=lnt id=hl-22-49><a class=lnlinks href=#hl-22-49>49</a>
</span><span class=lnt id=hl-22-50><a class=lnlinks href=#hl-22-50>50</a>
</span><span class=lnt id=hl-22-51><a class=lnlinks href=#hl-22-51>51</a>
</span><span class=lnt id=hl-22-52><a class=lnlinks href=#hl-22-52>52</a>
</span><span class=lnt id=hl-22-53><a class=lnlinks href=#hl-22-53>53</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 서버 측 리프레시 토큰 처리
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/refresh-token&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>refreshToken</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>body</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 리프레시 토큰 검증 (실제로는 데이터베이스 조회 필요)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>isValidRefreshToken</span><span class=p>(</span><span class=nx>refreshToken</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;유효하지 않은 리프레시 토큰&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 새 액세스 토큰 발급
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=nx>getUserByRefreshToken</span><span class=p>(</span><span class=nx>refreshToken</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>newAccessToken</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>sign</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>user_id</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=p>,</span> <span class=nx>username</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>username</span><span class=p>,</span> <span class=nx>role</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>role</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>SECRET_KEY</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span> <span class=nx>expiresIn</span><span class=o>:</span> <span class=s1>&#39;15m&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span> <span class=nx>accessToken</span><span class=o>:</span> <span class=nx>newAccessToken</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 클라이언트 측 토큰 갱신 처리
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>refreshToken</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>refreshToken</span> <span class=o>=</span> <span class=nx>localStorage</span><span class=p>.</span><span class=nx>getItem</span><span class=p>(</span><span class=s1>&#39;refreshToken&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>refreshToken</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 리프레시 토큰이 없으면 로그인 페이지로 리디렉션
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s1>&#39;/login-page&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;/refresh-token&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/json&#39;</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>body</span><span class=o>:</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span> <span class=nx>refreshToken</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>response</span><span class=p>.</span><span class=nx>ok</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>throw</span> <span class=k>new</span> <span class=nb>Error</span><span class=p>(</span><span class=s1>&#39;토큰 갱신 실패&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>localStorage</span><span class=p>.</span><span class=nx>setItem</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>,</span> <span class=nx>data</span><span class=p>.</span><span class=nx>accessToken</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>data</span><span class=p>.</span><span class=nx>accessToken</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 리프레시 토큰도 만료된 경우, 로그아웃 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>logout</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>throw</span> <span class=nx>error</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=토큰-블랙리스트>토큰 블랙리스트<a hidden class=anchor aria-hidden=true href=#토큰-블랙리스트>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1> 1</a>
</span><span class=lnt id=hl-23-2><a class=lnlinks href=#hl-23-2> 2</a>
</span><span class=lnt id=hl-23-3><a class=lnlinks href=#hl-23-3> 3</a>
</span><span class=lnt id=hl-23-4><a class=lnlinks href=#hl-23-4> 4</a>
</span><span class=lnt id=hl-23-5><a class=lnlinks href=#hl-23-5> 5</a>
</span><span class=lnt id=hl-23-6><a class=lnlinks href=#hl-23-6> 6</a>
</span><span class=lnt id=hl-23-7><a class=lnlinks href=#hl-23-7> 7</a>
</span><span class=lnt id=hl-23-8><a class=lnlinks href=#hl-23-8> 8</a>
</span><span class=lnt id=hl-23-9><a class=lnlinks href=#hl-23-9> 9</a>
</span><span class=lnt id=hl-23-10><a class=lnlinks href=#hl-23-10>10</a>
</span><span class=lnt id=hl-23-11><a class=lnlinks href=#hl-23-11>11</a>
</span><span class=lnt id=hl-23-12><a class=lnlinks href=#hl-23-12>12</a>
</span><span class=lnt id=hl-23-13><a class=lnlinks href=#hl-23-13>13</a>
</span><span class=lnt id=hl-23-14><a class=lnlinks href=#hl-23-14>14</a>
</span><span class=lnt id=hl-23-15><a class=lnlinks href=#hl-23-15>15</a>
</span><span class=lnt id=hl-23-16><a class=lnlinks href=#hl-23-16>16</a>
</span><span class=lnt id=hl-23-17><a class=lnlinks href=#hl-23-17>17</a>
</span><span class=lnt id=hl-23-18><a class=lnlinks href=#hl-23-18>18</a>
</span><span class=lnt id=hl-23-19><a class=lnlinks href=#hl-23-19>19</a>
</span><span class=lnt id=hl-23-20><a class=lnlinks href=#hl-23-20>20</a>
</span><span class=lnt id=hl-23-21><a class=lnlinks href=#hl-23-21>21</a>
</span><span class=lnt id=hl-23-22><a class=lnlinks href=#hl-23-22>22</a>
</span><span class=lnt id=hl-23-23><a class=lnlinks href=#hl-23-23>23</a>
</span><span class=lnt id=hl-23-24><a class=lnlinks href=#hl-23-24>24</a>
</span><span class=lnt id=hl-23-25><a class=lnlinks href=#hl-23-25>25</a>
</span><span class=lnt id=hl-23-26><a class=lnlinks href=#hl-23-26>26</a>
</span><span class=lnt id=hl-23-27><a class=lnlinks href=#hl-23-27>27</a>
</span><span class=lnt id=hl-23-28><a class=lnlinks href=#hl-23-28>28</a>
</span><span class=lnt id=hl-23-29><a class=lnlinks href=#hl-23-29>29</a>
</span><span class=lnt id=hl-23-30><a class=lnlinks href=#hl-23-30>30</a>
</span><span class=lnt id=hl-23-31><a class=lnlinks href=#hl-23-31>31</a>
</span><span class=lnt id=hl-23-32><a class=lnlinks href=#hl-23-32>32</a>
</span><span class=lnt id=hl-23-33><a class=lnlinks href=#hl-23-33>33</a>
</span><span class=lnt id=hl-23-34><a class=lnlinks href=#hl-23-34>34</a>
</span><span class=lnt id=hl-23-35><a class=lnlinks href=#hl-23-35>35</a>
</span><span class=lnt id=hl-23-36><a class=lnlinks href=#hl-23-36>36</a>
</span><span class=lnt id=hl-23-37><a class=lnlinks href=#hl-23-37>37</a>
</span><span class=lnt id=hl-23-38><a class=lnlinks href=#hl-23-38>38</a>
</span><span class=lnt id=hl-23-39><a class=lnlinks href=#hl-23-39>39</a>
</span><span class=lnt id=hl-23-40><a class=lnlinks href=#hl-23-40>40</a>
</span><span class=lnt id=hl-23-41><a class=lnlinks href=#hl-23-41>41</a>
</span><span class=lnt id=hl-23-42><a class=lnlinks href=#hl-23-42>42</a>
</span><span class=lnt id=hl-23-43><a class=lnlinks href=#hl-23-43>43</a>
</span><span class=lnt id=hl-23-44><a class=lnlinks href=#hl-23-44>44</a>
</span><span class=lnt id=hl-23-45><a class=lnlinks href=#hl-23-45>45</a>
</span><span class=lnt id=hl-23-46><a class=lnlinks href=#hl-23-46>46</a>
</span><span class=lnt id=hl-23-47><a class=lnlinks href=#hl-23-47>47</a>
</span><span class=lnt id=hl-23-48><a class=lnlinks href=#hl-23-48>48</a>
</span><span class=lnt id=hl-23-49><a class=lnlinks href=#hl-23-49>49</a>
</span><span class=lnt id=hl-23-50><a class=lnlinks href=#hl-23-50>50</a>
</span><span class=lnt id=hl-23-51><a class=lnlinks href=#hl-23-51>51</a>
</span><span class=lnt id=hl-23-52><a class=lnlinks href=#hl-23-52>52</a>
</span><span class=lnt id=hl-23-53><a class=lnlinks href=#hl-23-53>53</a>
</span><span class=lnt id=hl-23-54><a class=lnlinks href=#hl-23-54>54</a>
</span><span class=lnt id=hl-23-55><a class=lnlinks href=#hl-23-55>55</a>
</span><span class=lnt id=hl-23-56><a class=lnlinks href=#hl-23-56>56</a>
</span><span class=lnt id=hl-23-57><a class=lnlinks href=#hl-23-57>57</a>
</span><span class=lnt id=hl-23-58><a class=lnlinks href=#hl-23-58>58</a>
</span><span class=lnt id=hl-23-59><a class=lnlinks href=#hl-23-59>59</a>
</span><span class=lnt id=hl-23-60><a class=lnlinks href=#hl-23-60>60</a>
</span><span class=lnt id=hl-23-61><a class=lnlinks href=#hl-23-61>61</a>
</span><span class=lnt id=hl-23-62><a class=lnlinks href=#hl-23-62>62</a>
</span><span class=lnt id=hl-23-63><a class=lnlinks href=#hl-23-63>63</a>
</span><span class=lnt id=hl-23-64><a class=lnlinks href=#hl-23-64>64</a>
</span><span class=lnt id=hl-23-65><a class=lnlinks href=#hl-23-65>65</a>
</span><span class=lnt id=hl-23-66><a class=lnlinks href=#hl-23-66>66</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Redis를 사용한 토큰 블랙리스트 구현 예시 (Node.js)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>redis</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;redis&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>client</span> <span class=o>=</span> <span class=nx>redis</span><span class=p>.</span><span class=nx>createClient</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 토큰 블랙리스트에 추가
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>addToBlacklist</span><span class=p>(</span><span class=nx>token</span><span class=p>,</span> <span class=nx>expiryTime</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// JWT에서 만료 시간 추출
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>decodedToken</span> <span class=o>=</span> <span class=nx>jwt</span><span class=p>.</span><span class=nx>decode</span><span class=p>(</span><span class=nx>token</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>expiry</span> <span class=o>=</span> <span class=nx>decodedToken</span><span class=p>.</span><span class=nx>exp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>now</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>ttl</span> <span class=o>=</span> <span class=nx>expiry</span> <span class=o>-</span> <span class=nx>now</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 만료 시간까지만 블랙리스트에 저장
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>ttl</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>client</span><span class=p>.</span><span class=nx>setex</span><span class=p>(</span><span class=nx>token</span><span class=p>,</span> <span class=nx>ttl</span><span class=p>,</span> <span class=s1>&#39;blacklisted&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 토큰이 블랙리스트에 있는지 확인
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>isBlacklisted</span><span class=p>(</span><span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>((</span><span class=nx>resolve</span><span class=p>,</span> <span class=nx>reject</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>client</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>token</span><span class=p>,</span> <span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>reply</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=k>return</span> <span class=nx>reject</span><span class=p>(</span><span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>resolve</span><span class=p>(</span><span class=nx>reply</span> <span class=o>===</span> <span class=s1>&#39;blacklisted&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 로그아웃 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/logout&#39;</span><span class=p>,</span> <span class=nx>authenticateToken</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>authorization</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 토큰 블랙리스트에 추가
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>addToBlacklist</span><span class=p>(</span><span class=nx>token</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;로그아웃 성공&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 블랙리스트 확인을 포함한 인증 미들웨어
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>authenticateTokenWithBlacklist</span><span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>authHeader</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>headers</span><span class=p>[</span><span class=s1>&#39;authorization&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>authHeader</span> <span class=o>&amp;&amp;</span> <span class=nx>authHeader</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;인증 토큰이 필요합니다&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 블랙리스트 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>blacklisted</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>isBlacklisted</span><span class=p>(</span><span class=nx>token</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>blacklisted</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>401</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;세션이 만료되었습니다. 다시 로그인해주세요.&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>jwt</span><span class=p>.</span><span class=nx>verify</span><span class=p>(</span><span class=nx>token</span><span class=p>,</span> <span class=nx>SECRET_KEY</span><span class=p>,</span> <span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>decoded</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>403</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;토큰이 유효하지 않습니다&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=nx>req</span><span class=p>.</span><span class=nx>user</span> <span class=o>=</span> <span class=nx>decoded</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=nx>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>500</span><span class=p>).</span><span class=nx>json</span><span class=p>({</span> <span class=nx>message</span><span class=o>:</span> <span class=s1>&#39;인증 처리 중 오류가 발생했습니다&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=실제-적용-시나리오>실제 적용 시나리오<a hidden class=anchor aria-hidden=true href=#실제-적용-시나리오>#</a></h4><ol><li><p>단일 페이지 애플리케이션 (SPA)<br>React, Vue, Angular 등의 프론트엔드 프레임워크로 구축된 SPA 에서는 JWT 를 사용하여 백엔드 API 와 통신하는 것이 일반적이다. 사용자가 로그인하면 JWT 를 발급받아 로컬 스토리지나 쿠키에 저장하고, 이후 API 요청에 사용한다.</p></li><li><p>마이크로서비스 아키텍처<br>여러 마이크로서비스로 구성된 시스템에서는 JWT 가 서비스 간 인증을 위한 효율적인 방법을 제공한다. 사용자가 하나의 서비스에 인증하면, 발급된 JWT 를 다른 서비스에도 사용할 수 있어 통합 인증이 가능하다.</p></li><li><p>모바일 애플리케이션<br>모바일 앱과 백엔드 서버 간의 통신에서도 JWT 는 효과적인 인증 방식이다. 토큰 기반 접근 방식은 세션 관리의 복잡성을 줄이고, 오프라인 상태에서도 일부 기능을 사용할 수 있게 한다.</p></li></ol><h4 id=jwt-구현-라이브러리-및-도구>JWT 구현 라이브러리 및 도구<a hidden class=anchor aria-hidden=true href=#jwt-구현-라이브러리-및-도구>#</a></h4><h5 id=주요-언어별-jwt-라이브러리>주요 언어별 JWT 라이브러리<a hidden class=anchor aria-hidden=true href=#주요-언어별-jwt-라이브러리>#</a></h5><ul><li><strong>Node.js</strong>: jsonwebtoken, njwt</li><li><strong>Python</strong>: PyJWT, python-jose</li><li><strong>Java</strong>: jjwt, java-jwt</li><li><strong>PHP</strong>: firebase/php-jwt, lcobucci/jwt</li><li><strong>Ruby</strong>: jwt</li><li><strong>.NET</strong>: System.IdentityModel.Tokens.Jwt</li><li><strong>Go</strong>: golang-jwt/jwt</li></ul><h5 id=jwt-디버깅-및-검증-도구>JWT 디버깅 및 검증 도구<a hidden class=anchor aria-hidden=true href=#jwt-디버깅-및-검증-도구>#</a></h5><ul><li><a href=https://jwt.io/>jwt.io</a>: JWT 디코딩, 검증, 생성을 위한 디버거</li><li><a href=https://jwt.ms/>JWT.ms</a>: Microsoft 에서 제공하는 JWT 디코더</li></ul><h4 id=고급-jwt-기법>고급 JWT 기법<a hidden class=anchor aria-hidden=true href=#고급-jwt-기법>#</a></h4><h5 id=jwejson-web-encryption>JWE(JSON Web Encryption)<a hidden class=anchor aria-hidden=true href=#jwejson-web-encryption>#</a></h5><p>JWT 의 확장 형태로, 페이로드를 암호화하여 내용 자체를 보호한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1> 1</a>
</span><span class=lnt id=hl-24-2><a class=lnlinks href=#hl-24-2> 2</a>
</span><span class=lnt id=hl-24-3><a class=lnlinks href=#hl-24-3> 3</a>
</span><span class=lnt id=hl-24-4><a class=lnlinks href=#hl-24-4> 4</a>
</span><span class=lnt id=hl-24-5><a class=lnlinks href=#hl-24-5> 5</a>
</span><span class=lnt id=hl-24-6><a class=lnlinks href=#hl-24-6> 6</a>
</span><span class=lnt id=hl-24-7><a class=lnlinks href=#hl-24-7> 7</a>
</span><span class=lnt id=hl-24-8><a class=lnlinks href=#hl-24-8> 8</a>
</span><span class=lnt id=hl-24-9><a class=lnlinks href=#hl-24-9> 9</a>
</span><span class=lnt id=hl-24-10><a class=lnlinks href=#hl-24-10>10</a>
</span><span class=lnt id=hl-24-11><a class=lnlinks href=#hl-24-11>11</a>
</span><span class=lnt id=hl-24-12><a class=lnlinks href=#hl-24-12>12</a>
</span><span class=lnt id=hl-24-13><a class=lnlinks href=#hl-24-13>13</a>
</span><span class=lnt id=hl-24-14><a class=lnlinks href=#hl-24-14>14</a>
</span><span class=lnt id=hl-24-15><a class=lnlinks href=#hl-24-15>15</a>
</span><span class=lnt id=hl-24-16><a class=lnlinks href=#hl-24-16>16</a>
</span><span class=lnt id=hl-24-17><a class=lnlinks href=#hl-24-17>17</a>
</span><span class=lnt id=hl-24-18><a class=lnlinks href=#hl-24-18>18</a>
</span><span class=lnt id=hl-24-19><a class=lnlinks href=#hl-24-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Node.js에서 JWE 구현 예시 (jose 라이브러리 사용)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>jose</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;jose&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>encryptJWT</span><span class=p>(</span><span class=nx>payload</span><span class=p>,</span> <span class=nx>recipientPublicKey</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// JWE 형식으로 암호화
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>jwe</span> <span class=o>=</span> <span class=kr>await</span> <span class=k>new</span> <span class=nx>jose</span><span class=p>.</span><span class=nx>CompactEncrypt</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=nx>TextEncoder</span><span class=p>().</span><span class=nx>encode</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>payload</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>setProtectedHeader</span><span class=p>({</span> <span class=nx>alg</span><span class=o>:</span> <span class=s1>&#39;RSA-OAEP-256&#39;</span><span class=p>,</span> <span class=nx>enc</span><span class=o>:</span> <span class=s1>&#39;A256GCM&#39;</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>encrypt</span><span class=p>(</span><span class=nx>recipientPublicKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>jwe</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>decryptJWT</span><span class=p>(</span><span class=nx>jwe</span><span class=p>,</span> <span class=nx>privateKey</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// JWE 복호화
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=p>{</span> <span class=nx>plaintext</span> <span class=p>}</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>jose</span><span class=p>.</span><span class=nx>compactDecrypt</span><span class=p>(</span><span class=nx>jwe</span><span class=p>,</span> <span class=nx>privateKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=k>new</span> <span class=nx>TextDecoder</span><span class=p>().</span><span class=nx>decode</span><span class=p>(</span><span class=nx>plaintext</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=jwkjson-web-key>JWK(JSON Web Key)<a hidden class=anchor aria-hidden=true href=#jwkjson-web-key>#</a></h5><p>JWT 서명 및 암호화에 사용되는 키를 JSON 형식으로 표현하는 방법.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1> 1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2> 2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3> 3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4> 4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5> 5</a>
</span><span class=lnt id=hl-25-6><a class=lnlinks href=#hl-25-6> 6</a>
</span><span class=lnt id=hl-25-7><a class=lnlinks href=#hl-25-7> 7</a>
</span><span class=lnt id=hl-25-8><a class=lnlinks href=#hl-25-8> 8</a>
</span><span class=lnt id=hl-25-9><a class=lnlinks href=#hl-25-9> 9</a>
</span><span class=lnt id=hl-25-10><a class=lnlinks href=#hl-25-10>10</a>
</span><span class=lnt id=hl-25-11><a class=lnlinks href=#hl-25-11>11</a>
</span><span class=lnt id=hl-25-12><a class=lnlinks href=#hl-25-12>12</a>
</span><span class=lnt id=hl-25-13><a class=lnlinks href=#hl-25-13>13</a>
</span><span class=lnt id=hl-25-14><a class=lnlinks href=#hl-25-14>14</a>
</span><span class=lnt id=hl-25-15><a class=lnlinks href=#hl-25-15>15</a>
</span><span class=lnt id=hl-25-16><a class=lnlinks href=#hl-25-16>16</a>
</span><span class=lnt id=hl-25-17><a class=lnlinks href=#hl-25-17>17</a>
</span><span class=lnt id=hl-25-18><a class=lnlinks href=#hl-25-18>18</a>
</span><span class=lnt id=hl-25-19><a class=lnlinks href=#hl-25-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// JWK 세트 생성 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>keyPair</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>jose</span><span class=p>.</span><span class=nx>generateKeyPair</span><span class=p>(</span><span class=s1>&#39;RS256&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>publicJwk</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>jose</span><span class=p>.</span><span class=nx>exportJWK</span><span class=p>(</span><span class=nx>keyPair</span><span class=p>.</span><span class=nx>publicKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// JWK 세트 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/.well-known/jwks.json&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>json</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>keys</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>kty</span><span class=o>:</span> <span class=nx>publicJwk</span><span class=p>.</span><span class=nx>kty</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>kid</span><span class=o>:</span> <span class=s1>&#39;12345&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>use</span><span class=o>:</span> <span class=s1>&#39;sig&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>alg</span><span class=o>:</span> <span class=s1>&#39;RS256&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>n</span><span class=o>:</span> <span class=nx>publicJwk</span><span class=p>.</span><span class=nx>n</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>e</span><span class=o>:</span> <span class=nx>publicJwk</span><span class=p>.</span><span class=nx>e</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=jwt-의-미래-전망과-발전-방향>JWT 의 미래 전망과 발전 방향<a hidden class=anchor aria-hidden=true href=#jwt-의-미래-전망과-발전-방향>#</a></h4><ol><li><strong>더 강력한 암호화</strong>: 양자 컴퓨팅의 발전에 대비한 새로운 암호화 알고리즘의 도입</li><li><strong>표준화된 취소 메커니즘</strong>: JWT 취소를 위한 표준 방법 개발</li><li><strong>경량화된 프로필</strong>: IoT 및 제한된 리소스 환경을 위한 경량 JWT 형식</li><li><strong>자동화된 보안 검증</strong>: JWT 구현의 보안 취약점을 자동으로 감지하는 도구</li><li><strong>페더레이션 표준과의 통합</strong>: OpenID Connect, SAML 과 같은 다른 인증 표준과의 더 나은 통합</li></ol><hr><h3 id=참고-및-출처-2>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-2>#</a></h3><p><a href=https://www.syncfusion.com/blogs/post/secure-jwt-storage-best-practices>Secure JWT Storage: Best Practices</a></p></div><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>JWT vs. OAuth 2.0</h2></header><div class=entry-content><p>JWT vs. OAuth 2.0 기본 개념 JWT (JSON Web Token)
JWT는 당사자 간에 안전하게 정보를 JSON 객체로 전송하기 위한 컴팩트하고 자체 완결적인 방식이다. 이 정보는 디지털 서명되어 있어 신뢰할 수 있다. JWT는 주로 인증(Authentication)과 정보 교환을 위해 사용된다. OAuth 2.0
OAuth 2.0은 사용자가 자신의 정보에 대한 접근 권한을 제3자 애플리케이션에 부여할 수 있게 해주는 인가(Authorization) 프레임워크이다. 사용자가 비밀번호를 공유하지 않고도 제한된 접근 권한을 제3자에게 제공할 수 있다. 주요 목적과 용도 JWT의 목적
...</p></div><footer class=entry-footer><span title='2025-04-03 07:30:00 +0000 UTC'>April 3, 2025</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to JWT vs. OAuth 2.0" href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-formats/jwt/jwt-vs-oauth-20/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>jwt vs. Basic Authentication</h2></header><div class=entry-content><p>Jwt vs. Basic Authentication JWT(JSON Web Token) 개요 JWT는 당사자 간에 정보를 JSON 객체로 안전하게 전송하기 위한 개방형 표준(RFC 7519)이다. 이 정보는 디지털 서명되어 있어 신뢰할 수 있다. JWT는 HMAC 알고리즘이나 RSA/ECDSA를 사용한 공개/개인 키 쌍으로 서명될 수 있다.
구조 JWT는 세 부분으로 구성되며, 각 부분은 점(.)으로 구분된다:
헤더(Header): 토큰 유형과 사용된 서명 알고리즘을 지정한다. 페이로드(Payload): 클레임(claim)이라고 불리는 엔티티와 추가 데이터를 포함한다. 서명(Signature): 헤더와 페이로드를 인코딩한 값과 비밀 키를 사용하여 생성된 서명이다. 결과적으로 JWT는 다음과 같은 형태를 가진다:
...</p></div><footer class=entry-footer><span title='2025-04-02 02:49:00 +0000 UTC'>April 2, 2025</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to jwt vs. Basic Authentication" href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-formats/jwt/jwt-vs-basic-authentication/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>jwt vs. Cookie-Based Auth</h2></header><div class=entry-content><p>Jwt vs. Cookie-Based Auth 기본 개념 JWT (JSON Web Token)
JWT는 당사자 간 정보를 안전하게 JSON 객체로 전송하기 위한 컴팩트하고 독립적인 방식이다. 이 정보는 디지털 서명되어 있어 신뢰할 수 있다. JWT는 HMAC 알고리즘이나 RSA/ECDSA와 같은 공개/개인 키 쌍을 사용하여 서명할 수 있다.
쿠키 기반 인증
쿠키 기반 인증은 사용자가 로그인할 때 서버가 세션 ID를 생성하고, 이 세션 ID를 쿠키에 저장하여 클라이언트에게 전송하는 방식이다. 모든 후속 요청에서 클라이언트는 이 쿠키를 서버에 보내고, 서버는 세션 ID를 확인하여 사용자를 인증한다.
...</p></div><footer class=entry-footer><span title='2025-04-02 02:47:00 +0000 UTC'>April 2, 2025</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to jwt vs. Cookie-Based Auth" href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-formats/jwt/jwt-vs-cookie-based-auth/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>jwt vs. Session-based Auth</h2></header><div class=entry-content><p>Jwt vs. Session-based Auth 기본 개념 JWT(JSON Web Token)
JWT는 당사자 간에 정보를 JSON 객체로 안전하게 전송하기 위한 방식이다. 이 정보는 디지털 서명되어 있어 신뢰할 수 있으며, 토큰 자체에 필요한 모든 정보를 포함하고 있다. JWT는 주로 상태 비저장(Stateless) 인증 메커니즘으로 사용된다.
세션 기반 인증
세션 기반 인증은 서버가 사용자의 인증 상태를 유지하는 전통적인 인증 방식이다. 사용자가 로그인하면 서버는 세션 ID를 생성하고 이를 서버 메모리나 데이터베이스에 저장한다. 이 세션 ID는 쿠키를 통해 클라이언트에게 전달되며, 후속 요청에서 클라이언트는 이 쿠키를 전송하여 인증 상태를 유지한다.
...</p></div><footer class=entry-footer><span title='2025-04-02 02:46:00 +0000 UTC'>April 2, 2025</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to jwt vs. Session-based Auth" href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-formats/jwt/jwt-vs-session-based-auth/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>JWT vs. OpenID Connect</h2></header><div class=entry-content><p>JWT vs. OpenID Connect JWT(JSON Web Token)와 OpenID Connect(OIDC)는 모두 현대적인 인증 및 권한 부여 시스템에서 중요한 역할을 하는 기술이다. 이 두 기술은 서로 밀접한 관계가 있지만, 목적과 기능 면에서 중요한 차이점을 가지고 있다.
JWT(JSON Web Token) JWT는 당사자 간에 안전하게 정보를 전송하기 위한 개방형 표준(RFC 7519)으로, 컴팩트하고 자체 포함적인 방식으로 정보를 안전하게 전달한다.
기본 구조 JWT는 점(.)으로 구분된 세 부분으로 구성된다:
헤더(Header): 토큰 유형과 사용된 암호화 알고리즘 정보 페이로드(Payload): 클레임(사용자 ID, 만료 시간 등) 정보 서명(Signature): 토큰의 무결성을 보장하는 디지털 서명 예시:
...</p></div><footer class=entry-footer><span title='2025-04-01 14:53:00 +0000 UTC'>April 1, 2025</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to JWT vs. OpenID Connect" href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-formats/jwt/jwt-vs-openid-connect/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>RFC 7519</h2></header><div class=entry-content><p>RFC 7519 RFC 7519는 JSON Web Token(JWT)에 대한 공식 인터넷 표준 문서이다.
2015년 5월에 Internet Engineering Task Force(IETF)에 의해 발행된 이 문서는 JWT의 구조, 형식, 서명 방법, 암호화 방법 등을 상세히 정의하고 있다. JWT는 당사자 간에 안전하게 정보를 전송하기 위한 간결하고 자체 포함적인 방법을 제공하는 개방형 표준이다.
JWT는 현대 웹 애플리케이션과 마이크로서비스 아키텍처에서 인증 및 정보 교환을 위한 핵심 기술로 자리 잡았다. 특히 Single Sign-On(SSO), API 인증, 정보의 안전한 전송 등 다양한 사용 사례에서 널리 활용되고 있다.
...</p></div><footer class=entry-footer><span title='2025-02-06 03:33:00 +0000 UTC'>February 6, 2025</span>&nbsp;·&nbsp;14 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to RFC 7519" href=https://buenhyden.github.io/posts/software-development--engineering/platform-development/backend-development/api-development/token-based-authentication/token-formats/jwt/rfc-7519/></a></article></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>