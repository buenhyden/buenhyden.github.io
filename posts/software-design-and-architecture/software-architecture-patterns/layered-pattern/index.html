<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Layered Pattern | hyunyoun's Blog</title>
<meta name=keywords content="Software-Design-and-Architecture,Software-Architecture-Patterns,Layered-Pattern"><meta name=description content="애플리케이션의 구성 요소를 수평적 계층으로 조직화하여 각 계층이 특정 기능을 담당하도록 한다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/software-design-and-architecture/software-architecture-patterns/layered-pattern/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.9a2bbe2d8b5afa9d4df22976abb7b72f1f7f1c467d2b30f03090108f9496ae6c.css integrity="sha256-miu+LYta+p1N8il2q7e3Lx9/HEZ9KzDwMJAQj5SWrmw=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/software-design-and-architecture/software-architecture-patterns/layered-pattern/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/software-design-and-architecture/software-architecture-patterns/layered-pattern/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Layered Pattern"><meta property="og:description" content="애플리케이션의 구성 요소를 수평적 계층으로 조직화하여 각 계층이 특정 기능을 담당하도록 한다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-21T08:26:00+00:00"><meta property="article:modified_time" content="2024-11-21T08:26:00+00:00"><meta property="article:tag" content="Software-Design-and-Architecture"><meta property="article:tag" content="Software-Architecture-Patterns"><meta property="article:tag" content="Layered-Pattern"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Layered Pattern"><meta name=twitter:description content="애플리케이션의 구성 요소를 수평적 계층으로 조직화하여 각 계층이 특정 기능을 담당하도록 한다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Software Design and Architecture","item":"https://buenhyden.github.io/posts/software-design-and-architecture/"},{"@type":"ListItem","position":3,"name":"Software Architecture Pattern","item":"https://buenhyden.github.io/posts/software-design-and-architecture/software-architecture-patterns/"},{"@type":"ListItem","position":4,"name":"Layered Pattern","item":"https://buenhyden.github.io/posts/software-design-and-architecture/software-architecture-patterns/layered-pattern/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Layered Pattern","name":"Layered Pattern","description":"애플리케이션의 구성 요소를 수평적 계층으로 조직화하여 각 계층이 특정 기능을 담당하도록 한다.","keywords":["Software-Design-and-Architecture","Software-Architecture-Patterns","Layered-Pattern"],"articleBody":"Layered Pattern 레이어드 패턴(Layered Pattern)은 소프트웨어 아키텍처에서 가장 널리 사용되는 패턴 중 하나.\n이 패턴은 애플리케이션의 구성 요소를 수평적 계층으로 조직화하여 각 계층이 특정 기능을 담당하도록 한다.\n주요 계층의 역할과 책임 ![Layered architecture pattern](sapr_0101.png “https://www.oreilly.com/library/view/software-architecture-patterns/9781491971437/ch01.html_\n일반적으로 레이어드 아키텍처는 다음과 같은 4개의 표준 계층으로 구성된다:\n프레젠테이션 계층 (Presentation Layer): 사용자 또는 외부 시스템과의 상호작용을 담당합니다 입력 데이터의 기본적인 유효성 검사를 수행합니다 응답 데이터를 적절한 형식으로 변환합니다 REST API, 웹 인터페이스, CLI 등의 형태로 구현될 수 있습니다 비즈니스 계층 (Business Layer): 핵심 비즈니스 로직을 구현합니다 트랜잭션 관리를 담당합니다 도메인 객체들의 상태를 조작합니다 비즈니스 규칙을 검증합니다 도메인 계층 (Domain Layer): 비즈니스 도메인의 핵심 개념을 표현합니다 도메인 객체들의 상태와 행위를 정의합니다 비즈니스 규칙을 캡슐화합니다 특정 기술에 독립적입니다 데이터 접근 계층 (Data Access Layer): 데이터의 영속성을 관리합니다 데이터베이스나 외부 시스템과의 통신을 담당합니다 CRUD 작업을 추상화합니다 데이터 매핑을 처리합니다 작은 애플리케이션의 경우 3개 계층으로, 복잡한 애플리케이션은 5개 이상의 계층으로 구성될 수 있다.\n작동 방식 각 계층은 자신의 역할에 집중하며, 아래 계층의 서비스를 사용하고 위 계층에 서비스를 제공한다.\n예를 들어:\n사용자 요청이 프레젠테이션 계층에 도착한니다. 프레젠테이션 계층은 이 요청을 비즈니스 계층으로 전달한다. 비즈니스 계층은 필요한 비즈니스 로직을 처리하고, 데이터가 필요한 경우 영속성 계층에 요청한다. 영속성 계층은 데이터베이스 계층과 상호작용하여 필요한 데이터를 가져온다. 결과는 역순으로 각 계층을 거쳐 최종적으로 사용자에게 전달된다. 장점 모듈성: 애플리케이션을 명확한 계층으로 분리하여 관리와 개발이 용이해진다. 유연성: 한 계층의 변경이 다른 계층에 영향을 미치지 않아 유지보수가 쉽다. 확장성: 개별 계층을 독립적으로 확장할 수 있어 성능 향상이 용이하다. 재사용성: 계층 내의 컴포넌트를 다른 프로젝트에서 재사용할 수 있다. 테스트 용이성: 각 계층을 독립적으로 테스트할 수 있어 단위 테스트와 통합 테스트가 간편해진다. 단점 성능 오버헤드: 여러 계층을 거치면서 지연이 발생할 수 있다. 복잡성 증가: 전체적인 아키텍처가 복잡해질 수 있다. 의존성 문제: 하위 계층에 대한 의존성으로 인해 변경이 어려울 수 있다. 주의할 점과 고려사항 적절한 계층 수 결정: 너무 많은 계층은 복잡성을 증가시킬 수 있습니다 프로젝트의 규모와 복잡성에 따라 적절한 계층 수를 선택해야 합니다 성능 고려: 계층 간 통신에서 약간의 오버헤드가 발생할 수 있습니다 필요한 경우 특정 계층을 건너뛰는 것을 고려할 수 있습니다 계층 간 결합도 관리: 인터페이스를 통한 통신을 철저히 지켜야 합니다 의존성 주입 등의 패턴을 활용하여 결합도를 낮춰야 합니다 적용 사례 기업용 애플리케이션: 복잡한 비즈니스 로직을 포함하는 시스템 여러 개발자가 협업하는 프로젝트 장기적인 유지보수가 필요한 시스템 다양한 클라이언트 지원: 웹, 모바일, 데스크톱 등 여러 클라이언트를 지원해야 하는 경우 API를 제공해야 하는 시스템 데이터 중심 애플리케이션: 복잡한 데이터 처리가 필요한 시스템 여러 데이터 소스를 활용하는 애플리케이션 구현 예시 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 from dataclasses import dataclass from datetime import datetime from typing import List, Optional import sqlite3 # 1. Presentation Layer (프레젠테이션 계층) class OrderController: def __init__(self, order_service): self.order_service = order_service def create_order(self, user_id: int, product_ids: List[int]) -\u003e dict: try: order = self.order_service.place_order(user_id, product_ids) return { \"status\": \"success\", \"order_id\": order.id, \"message\": \"Order created successfully\" } except ValueError as e: return { \"status\": \"error\", \"message\": str(e) } def get_order_details(self, order_id: int) -\u003e dict: try: order = self.order_service.get_order(order_id) return { \"status\": \"success\", \"order\": order.to_dict() } except ValueError as e: return { \"status\": \"error\", \"message\": str(e) } # 2. Business Layer (비즈니스 계층) class OrderService: def __init__(self, order_repository, product_repository): self.order_repository = order_repository self.product_repository = product_repository def place_order(self, user_id: int, product_ids: List[int]) -\u003e 'Order': # 비즈니스 로직 수행 products = [self.product_repository.get_by_id(pid) for pid in product_ids] # 재고 확인 for product in products: if product.stock \u003c= 0: raise ValueError(f\"Product {product.name} is out of stock\") # 총 가격 계산 total_price = sum(product.price for product in products) # 주문 생성 order = Order( id=None, # DB에서 자동 생성 user_id=user_id, products=products, total_price=total_price, status=\"PENDING\", created_at=datetime.now() ) # 주문 저장 saved_order = self.order_repository.save(order) # 재고 감소 for product in products: product.stock -= 1 self.product_repository.update(product) return saved_order def get_order(self, order_id: int) -\u003e 'Order': order = self.order_repository.get_by_id(order_id) if not order: raise ValueError(f\"Order {order_id} not found\") return order # 3. Domain Layer (도메인 계층) @dataclass class Product: id: Optional[int] name: str price: float stock: int description: str @dataclass class Order: id: Optional[int] user_id: int products: List[Product] total_price: float status: str created_at: datetime def to_dict(self): return { \"id\": self.id, \"user_id\": self.user_id, \"products\": [{\"id\": p.id, \"name\": p.name} for p in self.products], \"total_price\": self.total_price, \"status\": self.status, \"created_at\": self.created_at.isoformat() } # 4. Data Access Layer (데이터 접근 계층) class OrderRepository: def __init__(self, db_connection): self.db = db_connection def save(self, order: Order) -\u003e Order: cursor = self.db.cursor() # 주문 정보 저장 cursor.execute(\"\"\" INSERT INTO orders (user_id, total_price, status, created_at) VALUES (?, ?, ?, ?) \"\"\", (order.user_id, order.total_price, order.status, order.created_at)) order_id = cursor.lastrowid # 주문-상품 관계 저장 for product in order.products: cursor.execute(\"\"\" INSERT INTO order_products (order_id, product_id) VALUES (?, ?) \"\"\", (order_id, product.id)) self.db.commit() order.id = order_id return order def get_by_id(self, order_id: int) -\u003e Optional[Order]: cursor = self.db.cursor() # 주문 정보 조회 cursor.execute(\"\"\" SELECT id, user_id, total_price, status, created_at FROM orders WHERE id = ? \"\"\", (order_id,)) order_data = cursor.fetchone() if not order_data: return None # 주문에 포함된 상품 조회 cursor.execute(\"\"\" SELECT p.* FROM products p JOIN order_products op ON p.id = op.product_id WHERE op.order_id = ? \"\"\", (order_id,)) products = [ Product( id=row[0], name=row[1], price=row[2], stock=row[3], description=row[4] ) for row in cursor.fetchall() ] return Order( id=order_data[0], user_id=order_data[1], products=products, total_price=order_data[2], status=order_data[3], created_at=order_data[4] ) 참고 및 출처 ","wordCount":"1000","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2024-11-21T08:26:00Z","dateModified":"2024-11-21T08:26:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/software-design-and-architecture/software-architecture-patterns/layered-pattern/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>posts</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/software-design-and-architecture/>Software Design and Architecture</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/software-design-and-architecture/software-architecture-patterns/>Software Architecture Pattern</a></div><h1 class="post-title entry-hint-parent">Layered Pattern</h1><div class=post-description>애플리케이션의 구성 요소를 수평적 계층으로 조직화하여 각 계층이 특정 기능을 담당하도록 한다.</div><div class=post-meta><span title='2024-11-21 08:26:00 +0000 UTC'>November 21, 2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;1000 words&nbsp;·&nbsp;Me</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#layered-pattern>Layered Pattern</a><ul><li><a href=#주요-계층의-역할과-책임>주요 계층의 역할과 책임</a></li><li><a href=#작동-방식>작동 방식</a></li><li><a href=#장점>장점</a></li><li><a href=#단점>단점</a></li><li><a href=#주의할-점과-고려사항>주의할 점과 고려사항</a></li><li><a href=#적용-사례>적용 사례</a></li><li><a href=#구현-예시>구현 예시</a></li></ul></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=layered-pattern>Layered Pattern<a hidden class=anchor aria-hidden=true href=#layered-pattern>#</a></h2><p>레이어드 패턴(Layered Pattern)은 소프트웨어 아키텍처에서 가장 널리 사용되는 패턴 중 하나.<br>이 패턴은 애플리케이션의 구성 요소를 수평적 계층으로 조직화하여 각 계층이 특정 기능을 담당하도록 한다.</p><h3 id=주요-계층의-역할과-책임>주요 계층의 역할과 책임<a hidden class=anchor aria-hidden=true href=#주요-계층의-역할과-책임>#</a></h3><p>![Layered architecture pattern](sapr_0101.png &ldquo;<a href=https://www.oreilly.com/library/view/software-architecture-patterns/9781491971437/ch01.html>https://www.oreilly.com/library/view/software-architecture-patterns/9781491971437/ch01.html</a>_</p><p>일반적으로 레이어드 아키텍처는 다음과 같은 4개의 표준 계층으로 구성된다:</p><ol><li>프레젠테이션 계층 (Presentation Layer):</li></ol><ul><li>사용자 또는 외부 시스템과의 상호작용을 담당합니다</li><li>입력 데이터의 기본적인 유효성 검사를 수행합니다</li><li>응답 데이터를 적절한 형식으로 변환합니다</li><li>REST API, 웹 인터페이스, CLI 등의 형태로 구현될 수 있습니다</li></ul><ol start=2><li>비즈니스 계층 (Business Layer):</li></ol><ul><li>핵심 비즈니스 로직을 구현합니다</li><li>트랜잭션 관리를 담당합니다</li><li>도메인 객체들의 상태를 조작합니다</li><li>비즈니스 규칙을 검증합니다</li></ul><ol start=3><li>도메인 계층 (Domain Layer):</li></ol><ul><li>비즈니스 도메인의 핵심 개념을 표현합니다</li><li>도메인 객체들의 상태와 행위를 정의합니다</li><li>비즈니스 규칙을 캡슐화합니다</li><li>특정 기술에 독립적입니다</li></ul><ol start=4><li>데이터 접근 계층 (Data Access Layer):</li></ol><ul><li>데이터의 영속성을 관리합니다</li><li>데이터베이스나 외부 시스템과의 통신을 담당합니다</li><li>CRUD 작업을 추상화합니다</li><li>데이터 매핑을 처리합니다</li></ul><p>작은 애플리케이션의 경우 3개 계층으로, 복잡한 애플리케이션은 5개 이상의 계층으로 구성될 수 있다.</p><h3 id=작동-방식>작동 방식<a hidden class=anchor aria-hidden=true href=#작동-방식>#</a></h3><p>각 계층은 자신의 역할에 집중하며, 아래 계층의 서비스를 사용하고 위 계층에 서비스를 제공한다.<br>예를 들어:</p><ol><li>사용자 요청이 프레젠테이션 계층에 도착한니다.</li><li>프레젠테이션 계층은 이 요청을 비즈니스 계층으로 전달한다.</li><li>비즈니스 계층은 필요한 비즈니스 로직을 처리하고, 데이터가 필요한 경우 영속성 계층에 요청한다.</li><li>영속성 계층은 데이터베이스 계층과 상호작용하여 필요한 데이터를 가져온다.</li><li>결과는 역순으로 각 계층을 거쳐 최종적으로 사용자에게 전달된다.</li></ol><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><ol><li><strong>모듈성</strong>: 애플리케이션을 명확한 계층으로 분리하여 관리와 개발이 용이해진다.</li><li><strong>유연성</strong>: 한 계층의 변경이 다른 계층에 영향을 미치지 않아 유지보수가 쉽다.</li><li><strong>확장성</strong>: 개별 계층을 독립적으로 확장할 수 있어 성능 향상이 용이하다.</li><li><strong>재사용성</strong>: 계층 내의 컴포넌트를 다른 프로젝트에서 재사용할 수 있다.</li><li><strong>테스트 용이성</strong>: 각 계층을 독립적으로 테스트할 수 있어 단위 테스트와 통합 테스트가 간편해진다.</li></ol><h3 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h3><ol><li><strong>성능 오버헤드</strong>: 여러 계층을 거치면서 지연이 발생할 수 있다.</li><li><strong>복잡성 증가</strong>: 전체적인 아키텍처가 복잡해질 수 있다.</li><li><strong>의존성 문제</strong>: 하위 계층에 대한 의존성으로 인해 변경이 어려울 수 있다.</li></ol><h3 id=주의할-점과-고려사항>주의할 점과 고려사항<a hidden class=anchor aria-hidden=true href=#주의할-점과-고려사항>#</a></h3><ol><li>적절한 계층 수 결정:</li></ol><ul><li>너무 많은 계층은 복잡성을 증가시킬 수 있습니다</li><li>프로젝트의 규모와 복잡성에 따라 적절한 계층 수를 선택해야 합니다</li></ul><ol start=2><li>성능 고려:</li></ol><ul><li>계층 간 통신에서 약간의 오버헤드가 발생할 수 있습니다</li><li>필요한 경우 특정 계층을 건너뛰는 것을 고려할 수 있습니다</li></ul><ol start=3><li>계층 간 결합도 관리:</li></ol><ul><li>인터페이스를 통한 통신을 철저히 지켜야 합니다</li><li>의존성 주입 등의 패턴을 활용하여 결합도를 낮춰야 합니다</li></ul><h3 id=적용-사례>적용 사례<a hidden class=anchor aria-hidden=true href=#적용-사례>#</a></h3><ol><li>기업용 애플리케이션:</li></ol><ul><li>복잡한 비즈니스 로직을 포함하는 시스템</li><li>여러 개발자가 협업하는 프로젝트</li><li>장기적인 유지보수가 필요한 시스템</li></ul><ol start=2><li>다양한 클라이언트 지원:</li></ol><ul><li>웹, 모바일, 데스크톱 등 여러 클라이언트를 지원해야 하는 경우</li><li>API를 제공해야 하는 시스템</li></ul><ol start=3><li>데이터 중심 애플리케이션:</li></ol><ul><li>복잡한 데이터 처리가 필요한 시스템</li><li>여러 데이터 소스를 활용하는 애플리케이션</li></ul><h3 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>  1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2>  2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3>  3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4>  4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5>  5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6>  6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7>  7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8>  8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9>  9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10> 10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11> 11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12> 12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13> 13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14> 14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15> 15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16> 16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17> 17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18> 18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19> 19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20> 20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21> 21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22> 22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23> 23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24> 24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25> 25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26> 26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27> 27</a>
</span><span class=lnt id=hl-0-28><a class=lnlinks href=#hl-0-28> 28</a>
</span><span class=lnt id=hl-0-29><a class=lnlinks href=#hl-0-29> 29</a>
</span><span class=lnt id=hl-0-30><a class=lnlinks href=#hl-0-30> 30</a>
</span><span class=lnt id=hl-0-31><a class=lnlinks href=#hl-0-31> 31</a>
</span><span class=lnt id=hl-0-32><a class=lnlinks href=#hl-0-32> 32</a>
</span><span class=lnt id=hl-0-33><a class=lnlinks href=#hl-0-33> 33</a>
</span><span class=lnt id=hl-0-34><a class=lnlinks href=#hl-0-34> 34</a>
</span><span class=lnt id=hl-0-35><a class=lnlinks href=#hl-0-35> 35</a>
</span><span class=lnt id=hl-0-36><a class=lnlinks href=#hl-0-36> 36</a>
</span><span class=lnt id=hl-0-37><a class=lnlinks href=#hl-0-37> 37</a>
</span><span class=lnt id=hl-0-38><a class=lnlinks href=#hl-0-38> 38</a>
</span><span class=lnt id=hl-0-39><a class=lnlinks href=#hl-0-39> 39</a>
</span><span class=lnt id=hl-0-40><a class=lnlinks href=#hl-0-40> 40</a>
</span><span class=lnt id=hl-0-41><a class=lnlinks href=#hl-0-41> 41</a>
</span><span class=lnt id=hl-0-42><a class=lnlinks href=#hl-0-42> 42</a>
</span><span class=lnt id=hl-0-43><a class=lnlinks href=#hl-0-43> 43</a>
</span><span class=lnt id=hl-0-44><a class=lnlinks href=#hl-0-44> 44</a>
</span><span class=lnt id=hl-0-45><a class=lnlinks href=#hl-0-45> 45</a>
</span><span class=lnt id=hl-0-46><a class=lnlinks href=#hl-0-46> 46</a>
</span><span class=lnt id=hl-0-47><a class=lnlinks href=#hl-0-47> 47</a>
</span><span class=lnt id=hl-0-48><a class=lnlinks href=#hl-0-48> 48</a>
</span><span class=lnt id=hl-0-49><a class=lnlinks href=#hl-0-49> 49</a>
</span><span class=lnt id=hl-0-50><a class=lnlinks href=#hl-0-50> 50</a>
</span><span class=lnt id=hl-0-51><a class=lnlinks href=#hl-0-51> 51</a>
</span><span class=lnt id=hl-0-52><a class=lnlinks href=#hl-0-52> 52</a>
</span><span class=lnt id=hl-0-53><a class=lnlinks href=#hl-0-53> 53</a>
</span><span class=lnt id=hl-0-54><a class=lnlinks href=#hl-0-54> 54</a>
</span><span class=lnt id=hl-0-55><a class=lnlinks href=#hl-0-55> 55</a>
</span><span class=lnt id=hl-0-56><a class=lnlinks href=#hl-0-56> 56</a>
</span><span class=lnt id=hl-0-57><a class=lnlinks href=#hl-0-57> 57</a>
</span><span class=lnt id=hl-0-58><a class=lnlinks href=#hl-0-58> 58</a>
</span><span class=lnt id=hl-0-59><a class=lnlinks href=#hl-0-59> 59</a>
</span><span class=lnt id=hl-0-60><a class=lnlinks href=#hl-0-60> 60</a>
</span><span class=lnt id=hl-0-61><a class=lnlinks href=#hl-0-61> 61</a>
</span><span class=lnt id=hl-0-62><a class=lnlinks href=#hl-0-62> 62</a>
</span><span class=lnt id=hl-0-63><a class=lnlinks href=#hl-0-63> 63</a>
</span><span class=lnt id=hl-0-64><a class=lnlinks href=#hl-0-64> 64</a>
</span><span class=lnt id=hl-0-65><a class=lnlinks href=#hl-0-65> 65</a>
</span><span class=lnt id=hl-0-66><a class=lnlinks href=#hl-0-66> 66</a>
</span><span class=lnt id=hl-0-67><a class=lnlinks href=#hl-0-67> 67</a>
</span><span class=lnt id=hl-0-68><a class=lnlinks href=#hl-0-68> 68</a>
</span><span class=lnt id=hl-0-69><a class=lnlinks href=#hl-0-69> 69</a>
</span><span class=lnt id=hl-0-70><a class=lnlinks href=#hl-0-70> 70</a>
</span><span class=lnt id=hl-0-71><a class=lnlinks href=#hl-0-71> 71</a>
</span><span class=lnt id=hl-0-72><a class=lnlinks href=#hl-0-72> 72</a>
</span><span class=lnt id=hl-0-73><a class=lnlinks href=#hl-0-73> 73</a>
</span><span class=lnt id=hl-0-74><a class=lnlinks href=#hl-0-74> 74</a>
</span><span class=lnt id=hl-0-75><a class=lnlinks href=#hl-0-75> 75</a>
</span><span class=lnt id=hl-0-76><a class=lnlinks href=#hl-0-76> 76</a>
</span><span class=lnt id=hl-0-77><a class=lnlinks href=#hl-0-77> 77</a>
</span><span class=lnt id=hl-0-78><a class=lnlinks href=#hl-0-78> 78</a>
</span><span class=lnt id=hl-0-79><a class=lnlinks href=#hl-0-79> 79</a>
</span><span class=lnt id=hl-0-80><a class=lnlinks href=#hl-0-80> 80</a>
</span><span class=lnt id=hl-0-81><a class=lnlinks href=#hl-0-81> 81</a>
</span><span class=lnt id=hl-0-82><a class=lnlinks href=#hl-0-82> 82</a>
</span><span class=lnt id=hl-0-83><a class=lnlinks href=#hl-0-83> 83</a>
</span><span class=lnt id=hl-0-84><a class=lnlinks href=#hl-0-84> 84</a>
</span><span class=lnt id=hl-0-85><a class=lnlinks href=#hl-0-85> 85</a>
</span><span class=lnt id=hl-0-86><a class=lnlinks href=#hl-0-86> 86</a>
</span><span class=lnt id=hl-0-87><a class=lnlinks href=#hl-0-87> 87</a>
</span><span class=lnt id=hl-0-88><a class=lnlinks href=#hl-0-88> 88</a>
</span><span class=lnt id=hl-0-89><a class=lnlinks href=#hl-0-89> 89</a>
</span><span class=lnt id=hl-0-90><a class=lnlinks href=#hl-0-90> 90</a>
</span><span class=lnt id=hl-0-91><a class=lnlinks href=#hl-0-91> 91</a>
</span><span class=lnt id=hl-0-92><a class=lnlinks href=#hl-0-92> 92</a>
</span><span class=lnt id=hl-0-93><a class=lnlinks href=#hl-0-93> 93</a>
</span><span class=lnt id=hl-0-94><a class=lnlinks href=#hl-0-94> 94</a>
</span><span class=lnt id=hl-0-95><a class=lnlinks href=#hl-0-95> 95</a>
</span><span class=lnt id=hl-0-96><a class=lnlinks href=#hl-0-96> 96</a>
</span><span class=lnt id=hl-0-97><a class=lnlinks href=#hl-0-97> 97</a>
</span><span class=lnt id=hl-0-98><a class=lnlinks href=#hl-0-98> 98</a>
</span><span class=lnt id=hl-0-99><a class=lnlinks href=#hl-0-99> 99</a>
</span><span class=lnt id=hl-0-100><a class=lnlinks href=#hl-0-100>100</a>
</span><span class=lnt id=hl-0-101><a class=lnlinks href=#hl-0-101>101</a>
</span><span class=lnt id=hl-0-102><a class=lnlinks href=#hl-0-102>102</a>
</span><span class=lnt id=hl-0-103><a class=lnlinks href=#hl-0-103>103</a>
</span><span class=lnt id=hl-0-104><a class=lnlinks href=#hl-0-104>104</a>
</span><span class=lnt id=hl-0-105><a class=lnlinks href=#hl-0-105>105</a>
</span><span class=lnt id=hl-0-106><a class=lnlinks href=#hl-0-106>106</a>
</span><span class=lnt id=hl-0-107><a class=lnlinks href=#hl-0-107>107</a>
</span><span class=lnt id=hl-0-108><a class=lnlinks href=#hl-0-108>108</a>
</span><span class=lnt id=hl-0-109><a class=lnlinks href=#hl-0-109>109</a>
</span><span class=lnt id=hl-0-110><a class=lnlinks href=#hl-0-110>110</a>
</span><span class=lnt id=hl-0-111><a class=lnlinks href=#hl-0-111>111</a>
</span><span class=lnt id=hl-0-112><a class=lnlinks href=#hl-0-112>112</a>
</span><span class=lnt id=hl-0-113><a class=lnlinks href=#hl-0-113>113</a>
</span><span class=lnt id=hl-0-114><a class=lnlinks href=#hl-0-114>114</a>
</span><span class=lnt id=hl-0-115><a class=lnlinks href=#hl-0-115>115</a>
</span><span class=lnt id=hl-0-116><a class=lnlinks href=#hl-0-116>116</a>
</span><span class=lnt id=hl-0-117><a class=lnlinks href=#hl-0-117>117</a>
</span><span class=lnt id=hl-0-118><a class=lnlinks href=#hl-0-118>118</a>
</span><span class=lnt id=hl-0-119><a class=lnlinks href=#hl-0-119>119</a>
</span><span class=lnt id=hl-0-120><a class=lnlinks href=#hl-0-120>120</a>
</span><span class=lnt id=hl-0-121><a class=lnlinks href=#hl-0-121>121</a>
</span><span class=lnt id=hl-0-122><a class=lnlinks href=#hl-0-122>122</a>
</span><span class=lnt id=hl-0-123><a class=lnlinks href=#hl-0-123>123</a>
</span><span class=lnt id=hl-0-124><a class=lnlinks href=#hl-0-124>124</a>
</span><span class=lnt id=hl-0-125><a class=lnlinks href=#hl-0-125>125</a>
</span><span class=lnt id=hl-0-126><a class=lnlinks href=#hl-0-126>126</a>
</span><span class=lnt id=hl-0-127><a class=lnlinks href=#hl-0-127>127</a>
</span><span class=lnt id=hl-0-128><a class=lnlinks href=#hl-0-128>128</a>
</span><span class=lnt id=hl-0-129><a class=lnlinks href=#hl-0-129>129</a>
</span><span class=lnt id=hl-0-130><a class=lnlinks href=#hl-0-130>130</a>
</span><span class=lnt id=hl-0-131><a class=lnlinks href=#hl-0-131>131</a>
</span><span class=lnt id=hl-0-132><a class=lnlinks href=#hl-0-132>132</a>
</span><span class=lnt id=hl-0-133><a class=lnlinks href=#hl-0-133>133</a>
</span><span class=lnt id=hl-0-134><a class=lnlinks href=#hl-0-134>134</a>
</span><span class=lnt id=hl-0-135><a class=lnlinks href=#hl-0-135>135</a>
</span><span class=lnt id=hl-0-136><a class=lnlinks href=#hl-0-136>136</a>
</span><span class=lnt id=hl-0-137><a class=lnlinks href=#hl-0-137>137</a>
</span><span class=lnt id=hl-0-138><a class=lnlinks href=#hl-0-138>138</a>
</span><span class=lnt id=hl-0-139><a class=lnlinks href=#hl-0-139>139</a>
</span><span class=lnt id=hl-0-140><a class=lnlinks href=#hl-0-140>140</a>
</span><span class=lnt id=hl-0-141><a class=lnlinks href=#hl-0-141>141</a>
</span><span class=lnt id=hl-0-142><a class=lnlinks href=#hl-0-142>142</a>
</span><span class=lnt id=hl-0-143><a class=lnlinks href=#hl-0-143>143</a>
</span><span class=lnt id=hl-0-144><a class=lnlinks href=#hl-0-144>144</a>
</span><span class=lnt id=hl-0-145><a class=lnlinks href=#hl-0-145>145</a>
</span><span class=lnt id=hl-0-146><a class=lnlinks href=#hl-0-146>146</a>
</span><span class=lnt id=hl-0-147><a class=lnlinks href=#hl-0-147>147</a>
</span><span class=lnt id=hl-0-148><a class=lnlinks href=#hl-0-148>148</a>
</span><span class=lnt id=hl-0-149><a class=lnlinks href=#hl-0-149>149</a>
</span><span class=lnt id=hl-0-150><a class=lnlinks href=#hl-0-150>150</a>
</span><span class=lnt id=hl-0-151><a class=lnlinks href=#hl-0-151>151</a>
</span><span class=lnt id=hl-0-152><a class=lnlinks href=#hl-0-152>152</a>
</span><span class=lnt id=hl-0-153><a class=lnlinks href=#hl-0-153>153</a>
</span><span class=lnt id=hl-0-154><a class=lnlinks href=#hl-0-154>154</a>
</span><span class=lnt id=hl-0-155><a class=lnlinks href=#hl-0-155>155</a>
</span><span class=lnt id=hl-0-156><a class=lnlinks href=#hl-0-156>156</a>
</span><span class=lnt id=hl-0-157><a class=lnlinks href=#hl-0-157>157</a>
</span><span class=lnt id=hl-0-158><a class=lnlinks href=#hl-0-158>158</a>
</span><span class=lnt id=hl-0-159><a class=lnlinks href=#hl-0-159>159</a>
</span><span class=lnt id=hl-0-160><a class=lnlinks href=#hl-0-160>160</a>
</span><span class=lnt id=hl-0-161><a class=lnlinks href=#hl-0-161>161</a>
</span><span class=lnt id=hl-0-162><a class=lnlinks href=#hl-0-162>162</a>
</span><span class=lnt id=hl-0-163><a class=lnlinks href=#hl-0-163>163</a>
</span><span class=lnt id=hl-0-164><a class=lnlinks href=#hl-0-164>164</a>
</span><span class=lnt id=hl-0-165><a class=lnlinks href=#hl-0-165>165</a>
</span><span class=lnt id=hl-0-166><a class=lnlinks href=#hl-0-166>166</a>
</span><span class=lnt id=hl-0-167><a class=lnlinks href=#hl-0-167>167</a>
</span><span class=lnt id=hl-0-168><a class=lnlinks href=#hl-0-168>168</a>
</span><span class=lnt id=hl-0-169><a class=lnlinks href=#hl-0-169>169</a>
</span><span class=lnt id=hl-0-170><a class=lnlinks href=#hl-0-170>170</a>
</span><span class=lnt id=hl-0-171><a class=lnlinks href=#hl-0-171>171</a>
</span><span class=lnt id=hl-0-172><a class=lnlinks href=#hl-0-172>172</a>
</span><span class=lnt id=hl-0-173><a class=lnlinks href=#hl-0-173>173</a>
</span><span class=lnt id=hl-0-174><a class=lnlinks href=#hl-0-174>174</a>
</span><span class=lnt id=hl-0-175><a class=lnlinks href=#hl-0-175>175</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dataclasses</span> <span class=kn>import</span> <span class=n>dataclass</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>List</span><span class=p>,</span> <span class=n>Optional</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sqlite3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. Presentation Layer (프레젠테이션 계층)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderController</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_service</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>order_service</span> <span class=o>=</span> <span class=n>order_service</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>create_order</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>product_ids</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>order</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>order_service</span><span class=o>.</span><span class=n>place_order</span><span class=p>(</span><span class=n>user_id</span><span class=p>,</span> <span class=n>product_ids</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;success&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;order_id&#34;</span><span class=p>:</span> <span class=n>order</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;message&#34;</span><span class=p>:</span> <span class=s2>&#34;Order created successfully&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;error&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;message&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_order_details</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>order</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>order_service</span><span class=o>.</span><span class=n>get_order</span><span class=p>(</span><span class=n>order_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;success&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;order&#34;</span><span class=p>:</span> <span class=n>order</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>ValueError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=s2>&#34;error&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;message&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Business Layer (비즈니스 계층)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderService</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_repository</span><span class=p>,</span> <span class=n>product_repository</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>order_repository</span> <span class=o>=</span> <span class=n>order_repository</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>product_repository</span> <span class=o>=</span> <span class=n>product_repository</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>place_order</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>user_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>product_ids</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=nb>int</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=s1>&#39;Order&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># 비즈니스 로직 수행</span>
</span></span><span class=line><span class=cl>        <span class=n>products</span> <span class=o>=</span> <span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>product_repository</span><span class=o>.</span><span class=n>get_by_id</span><span class=p>(</span><span class=n>pid</span><span class=p>)</span> <span class=k>for</span> <span class=n>pid</span> <span class=ow>in</span> <span class=n>product_ids</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 재고 확인</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>product</span> <span class=ow>in</span> <span class=n>products</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>product</span><span class=o>.</span><span class=n>stock</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Product </span><span class=si>{</span><span class=n>product</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> is out of stock&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 총 가격 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>total_price</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=n>product</span><span class=o>.</span><span class=n>price</span> <span class=k>for</span> <span class=n>product</span> <span class=ow>in</span> <span class=n>products</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 주문 생성</span>
</span></span><span class=line><span class=cl>        <span class=n>order</span> <span class=o>=</span> <span class=n>Order</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nb>id</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>  <span class=c1># DB에서 자동 생성</span>
</span></span><span class=line><span class=cl>            <span class=n>user_id</span><span class=o>=</span><span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>products</span><span class=o>=</span><span class=n>products</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>total_price</span><span class=o>=</span><span class=n>total_price</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>status</span><span class=o>=</span><span class=s2>&#34;PENDING&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>created_at</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 주문 저장</span>
</span></span><span class=line><span class=cl>        <span class=n>saved_order</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>order_repository</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>order</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 재고 감소</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>product</span> <span class=ow>in</span> <span class=n>products</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>product</span><span class=o>.</span><span class=n>stock</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>product_repository</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>product</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>saved_order</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_order</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=s1>&#39;Order&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>order</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>order_repository</span><span class=o>.</span><span class=n>get_by_id</span><span class=p>(</span><span class=n>order_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>order</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Order </span><span class=si>{</span><span class=n>order_id</span><span class=si>}</span><span class=s2> not found&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>order</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. Domain Layer (도메인 계층)</span>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Product</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>price</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>stock</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>    <span class=n>description</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Order</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>id</span><span class=p>:</span> <span class=n>Optional</span><span class=p>[</span><span class=nb>int</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>user_id</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>    <span class=n>products</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Product</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>total_price</span><span class=p>:</span> <span class=nb>float</span>
</span></span><span class=line><span class=cl>    <span class=n>status</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>created_at</span><span class=p>:</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>to_dict</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;user_id&#34;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;products&#34;</span><span class=p>:</span> <span class=p>[{</span><span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=n>p</span><span class=o>.</span><span class=n>id</span><span class=p>,</span> <span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=n>p</span><span class=o>.</span><span class=n>name</span><span class=p>}</span> <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>products</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;total_price&#34;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>total_price</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>status</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;created_at&#34;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>created_at</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. Data Access Layer (데이터 접근 계층)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderRepository</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>db_connection</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db</span> <span class=o>=</span> <span class=n>db_connection</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>save</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order</span><span class=p>:</span> <span class=n>Order</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Order</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>cursor</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 주문 정보 저장</span>
</span></span><span class=line><span class=cl>        <span class=n>cursor</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            INSERT INTO orders (user_id, total_price, status, created_at)
</span></span></span><span class=line><span class=cl><span class=s2>            VALUES (?, ?, ?, ?)
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>order</span><span class=o>.</span><span class=n>user_id</span><span class=p>,</span> <span class=n>order</span><span class=o>.</span><span class=n>total_price</span><span class=p>,</span> <span class=n>order</span><span class=o>.</span><span class=n>status</span><span class=p>,</span> <span class=n>order</span><span class=o>.</span><span class=n>created_at</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>order_id</span> <span class=o>=</span> <span class=n>cursor</span><span class=o>.</span><span class=n>lastrowid</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 주문-상품 관계 저장</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>product</span> <span class=ow>in</span> <span class=n>order</span><span class=o>.</span><span class=n>products</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>cursor</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>                INSERT INTO order_products (order_id, product_id)
</span></span></span><span class=line><span class=cl><span class=s2>                VALUES (?, ?)
</span></span></span><span class=line><span class=cl><span class=s2>            &#34;&#34;&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>order_id</span><span class=p>,</span> <span class=n>product</span><span class=o>.</span><span class=n>id</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>commit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>order</span><span class=o>.</span><span class=n>id</span> <span class=o>=</span> <span class=n>order_id</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>order</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_by_id</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>order_id</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Optional</span><span class=p>[</span><span class=n>Order</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=n>cursor</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>cursor</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 주문 정보 조회</span>
</span></span><span class=line><span class=cl>        <span class=n>cursor</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            SELECT id, user_id, total_price, status, created_at
</span></span></span><span class=line><span class=cl><span class=s2>            FROM orders WHERE id = ?
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>order_id</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>order_data</span> <span class=o>=</span> <span class=n>cursor</span><span class=o>.</span><span class=n>fetchone</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>order_data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=c1># 주문에 포함된 상품 조회</span>
</span></span><span class=line><span class=cl>        <span class=n>cursor</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>            SELECT p.* FROM products p
</span></span></span><span class=line><span class=cl><span class=s2>            JOIN order_products op ON p.id = op.product_id
</span></span></span><span class=line><span class=cl><span class=s2>            WHERE op.order_id = ?
</span></span></span><span class=line><span class=cl><span class=s2>        &#34;&#34;&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>order_id</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>products</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=n>Product</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=nb>id</span><span class=o>=</span><span class=n>row</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>name</span><span class=o>=</span><span class=n>row</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>price</span><span class=o>=</span><span class=n>row</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>stock</span><span class=o>=</span><span class=n>row</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>description</span><span class=o>=</span><span class=n>row</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>cursor</span><span class=o>.</span><span class=n>fetchall</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Order</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nb>id</span><span class=o>=</span><span class=n>order_data</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>user_id</span><span class=o>=</span><span class=n>order_data</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>products</span><span class=o>=</span><span class=n>products</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>total_price</span><span class=o>=</span><span class=n>order_data</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>status</span><span class=o>=</span><span class=n>order_data</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>created_at</span><span class=o>=</span><span class=n>order_data</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/software-design-and-architecture/>Software-Design-and-Architecture</a></li><li><a href=https://buenhyden.github.io/tags/software-architecture-patterns/>Software-Architecture-Patterns</a></li><li><a href=https://buenhyden.github.io/tags/layered-pattern/>Layered-Pattern</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/software-design-and-architecture/software-architecture-patterns/model-view-controller-pattern/><span class=title>« Prev</span><br><span>Model-View-Controller Pattern</span>
</a><a class=next href=https://buenhyden.github.io/posts/software-design-and-architecture/software-architecture-patterns/publisher-subscriber-pattern/><span class=title>Next »</span><br><span>Publisher-Subscriber Pattern</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>