<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Flyweight Pattern | hyunyoun's Blog</title><meta name=keywords content="Software-Engineering,Design-and-Architecture,Software-Design-Patterns,GoF,Structural,Flyweight-Pattern,Object-Sharing,Memory-Optimization"><meta name=description content="플라이웨이트 패턴은 대량의 유사한 객체들 간에 공통 상태를 공유하여 메모리 사용량을 최소화하는 구조적 디자인 패턴이다.  고유 상태 (Intrinsic State) 와 외부 상태 (Extrinsic State) 를 분리하여, 공유 가능한 고유 상태는 하나의 플라이웨이트 객체에 저장하고 외부 상태는 컨텍스트에서 관리함으로써 메모리 효율성과 성능을 향상시킨다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/software-design-and-architecture/software-design-patterns/classic-design-patterns/gof/structural/flyweight-pattern/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/software-design-and-architecture/software-design-patterns/classic-design-patterns/gof/structural/flyweight-pattern/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/software-design-and-architecture/software-design-patterns/classic-design-patterns/gof/structural/flyweight-pattern/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/software-design-and-architecture/software-design-patterns/classic-design-patterns/gof/structural/flyweight-pattern/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Flyweight Pattern"><meta property="og:description" content="플라이웨이트 패턴은 대량의 유사한 객체들 간에 공통 상태를 공유하여 메모리 사용량을 최소화하는 구조적 디자인 패턴이다.  고유 상태 (Intrinsic State) 와 외부 상태 (Extrinsic State) 를 분리하여, 공유 가능한 고유 상태는 하나의 플라이웨이트 객체에 저장하고 외부 상태는 컨텍스트에서 관리함으로써 메모리 효율성과 성능을 향상시킨다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Flyweight Pattern"><meta name=twitter:description content="플라이웨이트 패턴은 대량의 유사한 객체들 간에 공통 상태를 공유하여 메모리 사용량을 최소화하는 구조적 디자인 패턴이다.  고유 상태 (Intrinsic State) 와 외부 상태 (Extrinsic State) 를 분리하여, 공유 가능한 고유 상태는 하나의 플라이웨이트 객체에 저장하고 외부 상태는 컨텍스트에서 관리함으로써 메모리 효율성과 성능을 향상시킨다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Computer Science and Engineering","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Design and Architecture","item":""},{"@type":"ListItem","position":3,"name":"Software Design Patterns","item":"https://buenhyden.github.io/posts/software-design-and-architecture/software-design-patterns/"},{"@type":"ListItem","position":4,"name":"Classic Design Patterns","item":""},{"@type":"ListItem","position":5,"name":"GoF","item":"https://buenhyden.github.io/posts/software-design-and-architecture/software-design-patterns/classic-design-patterns/gof/"},{"@type":"ListItem","position":6,"name":"Structural","item":"https://buenhyden.github.io/posts/software-design-and-architecture/software-design-patterns/classic-design-patterns/gof/structural/"},{"@type":"ListItem","position":7,"name":"Flyweight Pattern","item":"https://buenhyden.github.io/posts/software-design-and-architecture/software-design-patterns/classic-design-patterns/gof/structural/flyweight-pattern/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>Computer Science and Engineering</a>&nbsp;»&nbsp;<a href>Design and Architecture</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/software-design-and-architecture/software-design-patterns/>Software Design Patterns</a>&nbsp;»&nbsp;<a href>Classic Design Patterns</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/software-design-and-architecture/software-design-patterns/classic-design-patterns/gof/>GoF</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/software-design-and-architecture/software-design-patterns/classic-design-patterns/gof/structural/>Structural</a></div><h1>Flyweight Pattern</h1><div class=post-description>플라이웨이트 패턴은 대량의 유사한 객체들 간에 공통 상태를 공유하여 메모리 사용량을 최소화하는 구조적 디자인 패턴이다. 고유 상태 (Intrinsic State) 와 외부 상태 (Extrinsic State) 를 분리하여, 공유 가능한 고유 상태는 하나의 플라이웨이트 객체에 저장하고 외부 상태는 컨텍스트에서 관리함으로써 메모리 효율성과 성능을 향상시킨다.</div></header><div class=post-content><h2 id=flyweight-pattern>Flyweight Pattern<a hidden class=anchor aria-hidden=true href=#flyweight-pattern>#</a></h2><p>Flyweight Pattern 은 메모리 상의 동일한 객체가 반복적으로 사용될 경우, 그 내부의 불변 데이터를 공유하여 메모리 낭비를 줄이는 구조적 설계 패턴이다. 객체의 상태를 고유 상태와 외부 상태로 분리하여, 공유 가능한 고유 상태만을 플라이웨이트 객체에 저장하고 팩토리를 통해 인스턴스를 관리한다.</p><p>특히 대규모 객체를 반복적으로 생성·사용하는 GUI 요소, 게임 오브젝트, 텍스트 렌더링 등의 환경에서 효과적이다. 이 패턴은 객체 간 차이를 외부화 (Extrinsic State) 하고, 공통된 내부 상태를 내부화하여 공유함으로써 객체 수를 최소화한다.</p><p>예를 들어 텍스트 렌더링 시스템에서 각 글자의 폰트 스타일 등 공통 속성은 공유하고, 위치 정보 등만 별도로 유지하여 수천 개의 문자 객체를 효율적으로 관리할 수 있다. 메모리 절감, 성능 향상이 필요한 시스템에 효과적이다.</p><h3 id=배경>배경<a hidden class=anchor aria-hidden=true href=#배경>#</a></h3><h4 id=역사적-배경>역사적 배경<a hidden class=anchor aria-hidden=true href=#역사적-배경>#</a></h4><p>플라이웨이트 패턴은 1990 년 Paul Calder 와 Mark Linton 에 의해 WYSIWYG 문서 편집기에서 글리프 (Glyph) 정보를 효율적으로 처리하기 위해 최초로 제안되었다. 이후 GoF 에 의해 공식화되어 23 개 디자인 패턴 중 하나로 정립되었다.</p><h4 id=기술적-배경>기술적 배경<a hidden class=anchor aria-hidden=true href=#기술적-배경>#</a></h4><ul><li><strong>메모리 제약</strong>: 초기 시스템에서 RAM 용량이 제한적이었던 환경</li><li><strong>객체지향 프로그래밍의 발전</strong>: 객체 기반 설계의 확산과 함께 발생한 메모리 사용량 증가 문제</li><li><strong>성능 최적화 요구</strong>: 대규모 응용프로그램에서의 효율적인 자원 관리 필요성</li></ul><h3 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h3><h4 id=주요-목적>주요 목적<a hidden class=anchor aria-hidden=true href=#주요-목적>#</a></h4><ul><li><strong>메모리 최적화</strong>: 유사한 객체들 간의 공통 데이터 공유를 통한 메모리 사용량 감소</li><li><strong>성능 향상</strong>: 객체 생성 오버헤드 감소로 인한 애플리케이션 성능 개선</li><li><strong>확장성 보장</strong>: 대량의 객체를 다루는 시스템에서의 확장성 확보</li></ul><h4 id=필요성>필요성<a hidden class=anchor aria-hidden=true href=#필요성>#</a></h4><ul><li>대량의 유사한 객체 생성이 필요한 상황</li><li>메모리 사용량이 시스템 성능에 중요한 영향을 미치는 환경</li><li>객체 생성 비용이 높은 경우</li><li>모바일 기기나 임베디드 시스템과 같은 리소스 제약 환경</li></ul><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><p><strong>Flyweight Pattern</strong>은 <strong>메모리 사용을 최적화</strong>하기 위해 동일한 객체를 <strong>공유해서 사용하는 구조적 디자인 패턴</strong>이다. 특히, 수많은 유사한 객체가 동시에 존재해야 할 때 사용되며, 각 객체의 공통된 <strong>내부 상태 (Intrinsic State)</strong> 는 공유하고, <strong>개별적으로 달라지는 외부 상태 (Extrinsic State)</strong> 는 외부에서 주입된다.</p><blockquote><p>핵심 원리는 " 공통된 상태를 공유 " 하고, " 변하는 상태만 외부에서 관리 " 함으로써 <strong>객체 수를 줄이고 성능을 높이는 것</strong>이다.</p></blockquote><h4 id=기본-개념>기본 개념<a hidden class=anchor aria-hidden=true href=#기본-개념>#</a></h4><ul><li><strong>공유 풀 (Flyweight Factory):</strong> 공유 가능한 객체들을 관리하는 팩토리이다.</li><li><strong>메모리 최적화:</strong> 동일한 객체를 여러 번 생성하지 않고 공유하여 메모리 사용량을 줄인다.</li><li><strong>구조적 패턴:</strong> 객체 간의 관계를 구조적으로 설계하여, 시스템의 유연성과 확장성을 높인다.</li></ul><p><strong>상태 분리 원칙</strong></p><ul><li><strong>내부 상태 (Intrinsic State):</strong> 객체 간에 공유 가능한 불변 상태로, 공통 데이터를 저장한다.</li><li><strong>외부 상태 (Extrinsic State):</strong> 객체마다 고유하게 필요한 상태로, 공유되지 않는다.</li></ul><p><strong>메모리 최적화 원리</strong></p><ul><li><strong>객체 공유</strong>: 동일한 고유 상태를 가진 객체들의 인스턴스 재사용</li><li><strong>상태 분리</strong>: 공유 가능한 상태와 개별 상태의 명확한 구분</li><li><strong>캐싱 메커니즘</strong>: 생성된 플라이웨이트 객체의 풀 (Pool) 관리</li></ul><h4 id=의도-intent>의도 (Intent)<a hidden class=anchor aria-hidden=true href=#의도-intent>#</a></h4><p>공유를 통해 대량의 소립 (fine-grained) 객체를 효율적으로 지원하여 메모리 사용을 최소화한다.</p><h4 id=다른-이름-also-known-as>다른 이름 (Also Known As)<a hidden class=anchor aria-hidden=true href=#다른-이름-also-known-as>#</a></h4><ul><li>경량 패턴 (Lightweight Pattern)</li><li>캐시 패턴 (Cache Pattern)</li></ul><h4 id=동기-motivation--forces>동기 (Motivation / Forces)<a hidden class=anchor aria-hidden=true href=#동기-motivation--forces>#</a></h4><ul><li>대량의 유사 객체를 생성해야 할 때, 객체의 불변 상태를 공유해 메모리 사용과 생성 비용을 줄이고자 할 때.</li></ul><h4 id=적용-가능성-applicability>적용 가능성 (Applicability)<a hidden class=anchor aria-hidden=true href=#적용-가능성-applicability>#</a></h4><ul><li>대량의 객체가 필요하고, 이 객체들이 많은 상태를 공유할 수 있을 때</li><li>객체 생성 비용이 높거나, 메모리 사용이 중요한 시스템</li><li>텍스트 에디터, 게임, 그래픽, 데이터베이스 등.</li></ul><table><thead><tr><th>조건</th><th>설명</th></tr></thead><tbody><tr><td>동일한 속성을 가진 객체가 다수 생성되는 경우</td><td>UI 구성 요소, 게임 객체 등</td></tr><tr><td>메모리 사용량이 문제인 시스템</td><td>제한된 리소스를 사용하는 내장 시스템, 모바일 환경</td></tr><tr><td>객체의 상태를 외부에서 관리할 수 있는 경우</td><td>intrinsic 상태와 extrinsic 상태를 분리 가능해야 함</td></tr></tbody></table><h4 id=패턴이-해결하고자-하는-설계-문제>패턴이 해결하고자 하는 설계 문제<a hidden class=anchor aria-hidden=true href=#패턴이-해결하고자-하는-설계-문제>#</a></h4><ul><li><strong>문제:</strong> 동일한 데이터를 가진 객체가 반복 생성되어 메모리 낭비</li><li><strong>해결:</strong> 공유를 통해 메모리 절약</li></ul><h4 id=문제를-해결하기-위한-설계-구조와-관계>문제를 해결하기 위한 설계 구조와 관계<a hidden class=anchor aria-hidden=true href=#문제를-해결하기-위한-설계-구조와-관계>#</a></h4><ul><li><strong>구조:</strong> FlyweightFactory 에서 공유 객체 관리</li><li><strong>관계:</strong> Client 는 외부 상태 제공, Flyweight 는 내부 상태 공유</li></ul><h4 id=실무-구현-관점>실무 구현 관점<a hidden class=anchor aria-hidden=true href=#실무-구현-관점>#</a></h4><ul><li><strong>공유 가능 데이터 식별:</strong> 어떤 데이터가 여러 객체에서 중복될 수 있는지 분석합니다.</li><li><strong>상태 분리:</strong> 내부/외부 상태를 명확히 구분하여 설계합니다.</li><li><strong>팩토리 활용:</strong> Flyweight 객체 생성 및 관리에 팩토리 패턴을 활용합니다.</li><li><strong>동시성 관리:</strong> 멀티스레드 환경에서 상태 공유 시 동기화 문제를 고려해야 합니다.</li></ul><h4 id=실무-구현을-위한-핵심-요소>실무 구현을 위한 핵심 요소<a hidden class=anchor aria-hidden=true href=#실무-구현을-위한-핵심-요소>#</a></h4><p><strong>팩토리 관리 (Factory Management)</strong></p><ul><li>Flyweight 객체의 생성과 관리를 담당</li><li>이미 생성된 객체는 재사용하고, 없을 경우에만 새로 생성</li><li>싱글톤 패턴과 결합하여 전역 접근점 제공</li></ul><p><strong>상태 관리 전략 (State Management Strategy)</strong></p><ul><li>내재적 상태는 Flyweight 객체 내부에 불변으로 저장</li><li>외재적 상태는 클라이언트가 메서드 호출 시 매개변수로 전달</li><li>상태 분리를 통한 메모리 최적화와 객체 재사용성 확보</li></ul><h3 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h3><h4 id=주요-기능>주요 기능<a hidden class=anchor aria-hidden=true href=#주요-기능>#</a></h4><ul><li><strong>객체 공유 관리</strong>: 동일한 내재적 상태를 가진 객체들의 공유 관리</li><li><strong>상태 분리</strong>: 내재적 상태와 외재적 상태의 체계적 분리</li><li><strong>팩토리 기반 객체 생성</strong>: 중앙화된 객체 생성 및 관리</li><li><strong>메모리 최적화</strong>: 중복 객체 제거를 통한 메모리 효율성 확보</li></ul><h4 id=핵심-역할>핵심 역할<a hidden class=anchor aria-hidden=true href=#핵심-역할>#</a></h4><ul><li><strong>리소스 절약</strong>: 시스템 자원의 효율적 활용</li><li><strong>성능 최적화</strong>: 객체 생성 오버헤드 최소화</li><li><strong>확장성 지원</strong>: 대규모 객체 관리 시스템 구축</li></ul><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><h4 id=구조적-특징>구조적 특징<a hidden class=anchor aria-hidden=true href=#구조적-특징>#</a></h4><ul><li>공유 가능한 내재적 상태와 컨텍스트별 외재적 상태의 명확한 분리</li><li>팩토리 패턴과의 결합을 통한 객체 생성 관리</li><li>불변 객체 (Immutable Object) 특성을 통한 안전한 공유</li></ul><h4 id=동작적-특징>동작적 특징<a hidden class=anchor aria-hidden=true href=#동작적-특징>#</a></h4><ul><li>지연 초기화 (Lazy Initialization) 를 통한 필요 시점 객체 생성</li><li>캐싱 메커니즘을 통한 객체 재사용</li><li>클라이언트와 Flyweight 객체 간의 느슨한 결합</li></ul><h3 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h3><h4 id=설계-원칙>설계 원칙<a hidden class=anchor aria-hidden=true href=#설계-원칙>#</a></h4><ul><li><strong>Single Responsibility Principle</strong>: 각 Flyweight 는 단일 책임을 가짐</li><li><strong>Open/Closed Principle</strong>: 새로운 Flyweight 타입 추가 시 기존 코드 수정 없이 확장 가능</li><li><strong>Dependency Inversion Principle</strong>: 클라이언트는 구체적인 Flyweight 가 아닌 인터페이스에 의존</li></ul><h4 id=메모리-관리-원칙>메모리 관리 원칙<a hidden class=anchor aria-hidden=true href=#메모리-관리-원칙>#</a></h4><ul><li><strong>공유 최대화</strong>: 가능한 한 많은 데이터를 공유하여 메모리 사용량 최소화</li><li><strong>불변성 보장</strong>: 내재적 상태의 불변성을 통한 안전한 공유</li><li><strong>지연 생성</strong>: 실제 필요한 시점에만 객체 생성</li></ul><h3 id=75-참여자들-간의-상호작용-방식>7.5. 참여자들 간의 상호작용 방식<a hidden class=anchor aria-hidden=true href=#75-참여자들-간의-상호작용-방식>#</a></h3><ul><li><strong>Client → FlyweightFactory:</strong> 객체 요청</li><li><strong>FlyweightFactory → Flyweight:</strong> 객체 생성/반환</li><li><strong>Client → Flyweight:</strong> 외부 상태 전달</li></ul><h3 id=작동-원리-및-방식>작동 원리 및 방식<a hidden class=anchor aria-hidden=true href=#작동-원리-및-방식>#</a></h3><h4 id=작동-순서>작동 순서<a hidden class=anchor aria-hidden=true href=#작동-순서>#</a></h4><ol><li><strong>클라이언트 요청</strong>: 특정 내재적 상태를 가진 Flyweight 객체 요청</li><li><strong>팩토리 검사</strong>: 팩토리에서 기존 객체 존재 여부 확인</li><li><strong>객체 반환</strong>: 기존 객체가 있으면 반환, 없으면 새로 생성 후 반환</li><li><strong>상태 전달</strong>: 클라이언트가 외재적 상태를 메서드 매개변수로 전달</li><li><strong>작업 수행</strong>: Flyweight 객체가 내재적 상태와 외재적 상태를 조합하여 작업 수행</li></ol><h4 id=작동-방식-다이어그램>작동 방식 다이어그램<a hidden class=anchor aria-hidden=true href=#작동-방식-다이어그램>#</a></h4><pre class=mermaid>classDiagram
    class Flyweight {
        -sharedState
        +operation(extrinsicState)
    }

    class ConcreteFlyweight {
        +operation(extrinsicState)
    }

    class FlyweightFactory {
        -flyweights : Map
        +getFlyweight(key)
    }

    class Client {
        +operation()
    }

    Flyweight &lt;|-- ConcreteFlyweight
    FlyweightFactory --&gt; Flyweight
    Client --&gt; FlyweightFactory
    Client --&gt; Flyweight
</pre><blockquote><p><strong>설명</strong>: 클라이언트는 Factory 를 통해 Flyweight 객체를 얻고, 외부 상태를 주입하여 사용한다.</p></blockquote><h3 id=주요-원리>주요 원리<a hidden class=anchor aria-hidden=true href=#주요-원리>#</a></h3><ul><li><strong>동일한 객체는 한 번만 생성</strong></li><li><strong>내부/외부 상태 분리</strong></li><li><strong>팩토리에서 객체 관리</strong></li></ul><h4 id=패턴-적용의-결과와-트레이드오프>패턴 적용의 결과와 트레이드오프<a hidden class=anchor aria-hidden=true href=#패턴-적용의-결과와-트레이드오프>#</a></h4><ul><li><strong>결과:</strong> 메모리 절약, 성능 향상</li><li><strong>트레이드오프:</strong> 상태 분리 복잡성, 동시성 문제</li></ul><h4 id=상태-분리-원리>상태 분리 원리<a hidden class=anchor aria-hidden=true href=#상태-분리-원리>#</a></h4><pre class=mermaid>graph TD
    A[원본 객체] --&gt; B[내재적 상태&lt;br/&gt;Intrinsic State]
    A --&gt; C[외재적 상태&lt;br/&gt;Extrinsic State]
    B --&gt; D[Flyweight 객체에 저장&lt;br/&gt;공유 가능, 불변]
    C --&gt; E[클라이언트가 관리&lt;br/&gt;컨텍스트별 변경]
    D --&gt; F[메모리 절약]
    E --&gt; F
</pre><p><strong>내재적 상태 (Intrinsic State)</strong></p><ul><li>여러 객체 간에 공유 가능한 상태</li><li>컨텍스트에 독립적이고 불변적</li><li>Flyweight 객체 내부에 저장</li></ul><p><strong>외재적 상태 (Extrinsic State)</strong></p><ul><li>각 객체마다 고유한 상태</li><li>컨텍스트에 의존적이고 가변적</li><li>클라이언트에서 관리하고 메서드 호출 시 전달</li></ul><h4 id=객체-공유-원리>객체 공유 원리<a hidden class=anchor aria-hidden=true href=#객체-공유-원리>#</a></h4><pre class=mermaid>sequenceDiagram
    participant Client
    participant Factory
    participant FlyweightPool
    participant Flyweight

    Client-&gt;&gt;Factory: getFlyweight(key)
    Factory-&gt;&gt;FlyweightPool: check existing
    alt 기존 객체 존재
        FlyweightPool--&gt;&gt;Factory: return existing
    else 새 객체 필요
        Factory-&gt;&gt;Flyweight: create new
        Factory-&gt;&gt;FlyweightPool: store new
        FlyweightPool--&gt;&gt;Factory: return new
    end
    Factory--&gt;&gt;Client: return flyweight
    Client-&gt;&gt;Flyweight: operation(extrinsicState)
</pre><h4 id=메모리-관리-방식>메모리 관리 방식<a hidden class=anchor aria-hidden=true href=#메모리-관리-방식>#</a></h4><pre class=mermaid>graph LR
    A[대량의 유사 객체] --&gt; B[상태 분석]
    B --&gt; C[내재적 상태 추출]
    B --&gt; D[외재적 상태 분리]
    C --&gt; E[Flyweight Pool]
    D --&gt; F[Client Context]
    E --&gt; G[메모리 절약]
    F --&gt; G
</pre><hr><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>메모리 절약량 = (총 객체 수 × 객체 크기) - (플라이웨이트 수 × 플라이웨이트 크기 + 외부 상태 총 크기)
</span></span></code></pre></td></tr></table></div></div><h4 id=상태-분리-원리-1>상태 분리 원리<a hidden class=anchor aria-hidden=true href=#상태-분리-원리-1>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1>1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2>2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3>3</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>전체 상태 = 고유 상태 (Intrinsic) ∪ 외부 상태 (Extrinsic)
</span></span><span class=line><span class=cl>고유 상태 = 모든 객체 간 공유 가능한 불변 정보
</span></span><span class=line><span class=cl>외부 상태 = 컨텍스트별 개별 관리되는 가변 정보
</span></span></code></pre></td></tr></table></div></div><h4 id=관련-패턴>관련 패턴<a hidden class=anchor aria-hidden=true href=#관련-패턴>#</a></h4><table><thead><tr><th>패턴</th><th>차이점 및 관계</th></tr></thead><tbody><tr><td><strong>Singleton</strong></td><td>Flyweight 객체를 싱글턴으로 관리할 수도 있음</td></tr><tr><td><strong>Factory Method</strong></td><td>Flyweight 객체 생성을 Factory 가 담당</td></tr><tr><td><strong>Object Pool</strong></td><td>자원을 재사용한다는 점에서 유사하지만, Flyweight 은 상태 공유에 집중</td></tr><tr><td><strong>Composite</strong></td><td>복잡한 공유 구조가 필요한 경우 함께 사용 가능</td></tr></tbody></table><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><p>공통된 내부 상태는 캐시된 Flyweight 객체에서 공유되고, 각 호출마다 클라이언트가 외부 상태를 주입한다.</p><h4 id=전체-구조>전체 구조<a hidden class=anchor aria-hidden=true href=#전체-구조>#</a></h4><pre class=mermaid>classDiagram
    class Flyweight {
        &lt;&lt;interface&gt;&gt;
        +operation(extrinsicState)
    }
    
    class ConcreteFlyweight {
        -intrinsicState
        +operation(extrinsicState)
    }
    
    class UnsharedConcreteFlyweight {
        -allState
        +operation(extrinsicState)
    }
    
    class FlyweightFactory {
        -flyweights: Map
        +getFlyweight(key): Flyweight
    }
    
    class Client {
        -extrinsicState
        +operation()
    }
    
    Flyweight &lt;|-- ConcreteFlyweight
    Flyweight &lt;|-- UnsharedConcreteFlyweight
    FlyweightFactory --&gt; Flyweight
    Client --&gt; FlyweightFactory
    Client --&gt; Flyweight
</pre><table><thead><tr><th>구분</th><th>구성요소</th><th>기능 설명</th><th>역할 설명</th><th>주요 특징</th></tr></thead><tbody><tr><td>필수</td><td><strong>Flyweight</strong></td><td>공통 인터페이스 정의</td><td>외부 상태를 매개변수로 받아 작업 수행 메서드 선언</td><td>고유/외부 상태를 명확히 구분하는 시그니처 제공</td></tr><tr><td></td><td><strong>ConcreteFlyweight</strong></td><td>Flyweight 인터페이스의 실제 구현</td><td>고유 상태 저장 및 외부 상태 활용 작업 수행</td><td>불변 객체로 설계되어 <strong>스레드 안전</strong> 확보</td></tr><tr><td></td><td><strong>FlyweightFactory</strong></td><td>객체 생성/관리 및 중복 방지</td><td>객체 풀 관리 및 적절한 플라이웨이트 반환</td><td><strong>싱글톤</strong> 패턴 적용, 전역 공유 가능한 객체 팩토리</td></tr><tr><td></td><td><strong>Context</strong></td><td>외부 상태 저장 및 Flyweight 참조</td><td>외부 상태 + Flyweight 결합하여 완전한 상태 유지</td><td>각 플라이웨이트 객체에 대해 별도 외부 상태 관리</td></tr><tr><td>선택</td><td><strong>UnsharedConcreteFlyweight</strong></td><td>공유되지 않는 특별한 플라이웨이트 구현</td><td>공통적으로 공유되지 않는 개별 객체 처리</td><td>일반적인 패턴 구조에서는 사용되지 않으며, 특정 상황에만 활용됨</td></tr></tbody></table><h3 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>기법명</strong></th><th><strong>정의</strong></th><th><strong>구성 요소</strong></th><th><strong>목적</strong></th><th><strong>대표 기술/예시</strong></th></tr></thead><tbody><tr><td><strong>1. 객체 생성 및 관리</strong></td><td>Factory Method 패턴 활용</td><td>플라이웨이트 객체 생성을 전담하는 팩토리 메서드 구현</td><td>객체 풀 (Map/Dict), 중복 확인 로직, 새 객체 생성 로직</td><td>객체 생성 비용 절감, 중복 객체 방지</td><td>Java <code>FontFactory</code>, Python <code>FlyweightFactory</code></td></tr><tr><td></td><td>팩토리 패턴 + 싱글톤 결합</td><td>전역에서 동일한 Factory 사용, 객체 풀 일관성 유지</td><td>static 싱글톤 인스턴스, 정적 메서드, 공유 캐시</td><td>객체 생성 책임 중앙 집중화, 메모리 공유 극대화</td><td>Python <code>CharacterFactory</code> 예시</td></tr><tr><td></td><td>캐싱 및 객체 풀링 전략</td><td>생성된 객체를 캐시에 보관하고 재사용</td><td>해시 기반 Map, LRU 정책, TTL, 비유지형/유지형 캐시 등</td><td>객체 접근 성능 향상, 메모리 효율화</td><td>LRU Cache, WeakReference 사용</td></tr><tr><td><strong>2. 상태 분리 및 설계</strong></td><td>Intrinsic/Extrinsic 상태 분리</td><td>공유 가능한 내부 상태와 개별 외부 상태를 명확히 구분</td><td>intrinsic: 불변 필드, extrinsic: 메서드 매개변수, 상태 결합 메서드</td><td>객체 간 공유 가능 상태 식별, 불변 객체 설계 강화</td><td>Python <code>Character.display()</code>, JS <code>Particle.render()</code></td></tr><tr><td></td><td>외부 상태 전달 구조화</td><td>외부 상태를 클라이언트가 직접 관리하지 않도록 구조화</td><td>외부 상태 전달 DTO/Wrapper 객체, 주입 헬퍼 클래스</td><td>클라이언트 코드 간소화, 외부 상태 관리 일관성</td><td>DTO 패턴, 상태 캡슐화 클래스</td></tr><tr><td></td><td>불변 객체 설계</td><td>상태 변경을 허용하지 않도록 객체를 immutable 하게 설계</td><td>final 필드, 생성자에서만 설정, setter 제거</td><td>공유 객체의 상태 오염 방지, 동시성 안정성 확보</td><td>Python <code>@dataclass(frozen=True)</code>, Java <code>final</code> 필드</td></tr><tr><td><strong>3. 메모리 및 성능 최적화</strong></td><td>약한 참조 (Weak Reference) 활용</td><td>GC 에 의한 회수 대상이 될 수 있는 약한 참조 기반 객체 캐시</td><td><code>WeakHashMap</code>, <code>WeakReference</code>, 약한 참조 기반 Map 구조</td><td>메모리 누수 방지, 필요 없는 객체 자동 제거</td><td>Java <code>WeakHashMap</code>, Python <code>weakref.WeakValueDictionary</code></td></tr><tr><td></td><td>캐시 키 최적화</td><td>객체 식별용 키를 고유하고 충돌 없게 생성</td><td>tuple 기반 key, dict → str 변환, JSON serialize 등</td><td>캐시 중복 방지, 검색 성능 개선</td><td><code>tuple(state.items())</code>, <code>json.dumps()</code></td></tr><tr><td></td><td>캐시 정책 적용 (LRU, TTL 등)</td><td>오래된 객체를 자동으로 제거하거나 TTL 로 만료</td><td>eviction policy 설정, max size 제한, access log 기록</td><td>캐시 과도 누적 방지, 메모리 점유율 조절</td><td>LRUCache, TTLCache, LFUCache</td></tr><tr><td><strong>4. 동시성 및 안정성</strong></td><td>멀티스레드 안전 Factory 구현</td><td>멀티스레드 환경에서도 안전하게 객체 공유 및 접근 가능</td><td><code>synchronized</code>, <code>thread-safe Map</code>, Lock-Free 구조</td><td>race condition 방지, 공유 객체 무결성 유지</td><td>Java <code>ConcurrentHashMap</code>, Python <code>threading.Lock</code></td></tr><tr><td></td><td>Double-Checked Locking</td><td>객체 생성 시 동기화 영역 최소화하는 최적화 기법</td><td>null 검사 2 회, synchronized block, volatile 변수</td><td>불필요한 동기화 비용 최소화</td><td>Java 싱글톤 객체 생성 시 사용</td></tr><tr><td><strong>5. 고급 최적화 전략</strong></td><td>코드 자동 생성 도구 활용</td><td>상태별 Flyweight 구현을 자동화하여 코드 반복 제거</td><td>코드 생성기, AST 기반 최적화 도구, 메타프로그래밍</td><td>생산성 향상, 유지보수성 향상</td><td>Python <code>metaclass</code>, AST 최적화 툴</td></tr><tr><td></td><td>적용 조건 기반 자동 필터링</td><td>Flyweight 패턴의 적용이 불필요한 경우를 자동으로 필터링</td><td>적용 조건 수치화 (ex. 객체 1000 개 이상), 정적 분석 도구 사용</td><td>오버엔지니어링 방지</td><td>객체 수 기반 조건식 + 적용 여부 판별 로직</td></tr></tbody></table><ul><li><code>객체 생성 및 관리</code>: 팩토리 패턴, 캐싱, 객체 풀</li><li><code>상태 분리</code>: 불변 객체 설계, 상태 주입 구조, Intrinsic/Extrinsic 분리</li><li><code>메모리 최적화</code>: 약한 참조, TTL/LRU, 캐시 정책</li><li><code>동시성</code>: 멀티스레드 안전성 확보, 동기화 메커니즘</li><li><code>고급 전략</code>: 코드 자동화, 적용 조건 분석</li></ul><h4 id=factory-method-기반-객체-풀링>Factory Method 기반 객체 풀링<a hidden class=anchor aria-hidden=true href=#factory-method-기반-객체-풀링>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span><span class=lnt id=hl-7-12><a class=lnlinks href=#hl-7-12>12</a>
</span><span class=lnt id=hl-7-13><a class=lnlinks href=#hl-7-13>13</a>
</span><span class=lnt id=hl-7-14><a class=lnlinks href=#hl-7-14>14</a>
</span><span class=lnt id=hl-7-15><a class=lnlinks href=#hl-7-15>15</a>
</span><span class=lnt id=hl-7-16><a class=lnlinks href=#hl-7-16>16</a>
</span><span class=lnt id=hl-7-17><a class=lnlinks href=#hl-7-17>17</a>
</span><span class=lnt id=hl-7-18><a class=lnlinks href=#hl-7-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Font</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>name</span>  <span class=c1># intrinsic 상태</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>render</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>content</span><span class=p>,</span> <span class=n>size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Rendering &#39;</span><span class=si>{</span><span class=n>content</span><span class=si>}</span><span class=s2>&#39; with font &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2>&#39; at size </span><span class=si>{</span><span class=n>size</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>FontFactory</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>_font_pool</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_font</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>name</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>name</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_font_pool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[Factory] Creating new Font: </span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>cls</span><span class=o>.</span><span class=n>_font_pool</span><span class=p>[</span><span class=n>name</span><span class=p>]</span> <span class=o>=</span> <span class=n>Font</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[Factory] Reusing Font: </span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_font_pool</span><span class=p>[</span><span class=n>name</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>설명</strong>: 동일 폰트를 재사용하기 위해 Factory 클래스가 객체 생성을 통제</li></ul><h4 id=상태-분리-intrinsic-vs-extrinsic>상태 분리: Intrinsic Vs Extrinsic<a hidden class=anchor aria-hidden=true href=#상태-분리-intrinsic-vs-extrinsic>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1>1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2>2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3>3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4>4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5>5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6>6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Character</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>letter</span><span class=p>,</span> <span class=n>font</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>letter</span> <span class=o>=</span> <span class=n>letter</span>          <span class=c1># 공유 가능한 intrinsic 상태</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>font</span> <span class=o>=</span> <span class=n>font</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>display</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>color</span><span class=p>):</span>   <span class=c1># 개별 extrinsic 상태는 메서드로 전달</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Display &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>letter</span><span class=si>}</span><span class=s2>&#39; in font &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>font</span><span class=si>}</span><span class=s2>&#39; at (</span><span class=si>{</span><span class=n>x</span><span class=si>}</span><span class=s2>,</span><span class=si>{</span><span class=n>y</span><span class=si>}</span><span class=s2>) with color </span><span class=si>{</span><span class=n>color</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>설명</strong>: 문자와 폰트는 공유, 위치나 색상은 개별 상태로 분리</li></ul><h4 id=캐싱-및-해시-기반-객체-풀링>캐싱 및 해시 기반 객체 풀링<a hidden class=anchor aria-hidden=true href=#캐싱-및-해시-기반-객체-풀링>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11>11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12>12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13>13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14>14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15>15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16>16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17>17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>FlyweightFactory</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_pool</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_flyweight</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>key</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_pool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[Cache] Creating new object for key: </span><span class=si>{</span><span class=n>key</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_pool</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>ConcreteFlyweight</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[Cache] Using cached object for key: </span><span class=si>{</span><span class=n>key</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_pool</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ConcreteFlyweight</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>shared_state</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>shared_state</span> <span class=o>=</span> <span class=n>shared_state</span>  <span class=c1># intrinsic 상태</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>operate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>unique_state</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[Flyweight] Shared: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>shared_state</span><span class=si>}</span><span class=s2>, Unique: </span><span class=si>{</span><span class=n>unique_state</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>설명</strong>: <code>dict</code> 를 사용한 객체 재사용 로직 구현</li></ul><h4 id=약한-참조-기반-캐싱-실패-사례-포함>약한 참조 기반 캐싱 (실패 사례 포함)<a hidden class=anchor aria-hidden=true href=#약한-참조-기반-캐싱-실패-사례-포함>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>weakref</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>WeakFlyweightFactory</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_pool</span> <span class=o>=</span> <span class=n>weakref</span><span class=o>.</span><span class=n>WeakValueDictionary</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>key</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_pool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[WeakRef] Creating new: </span><span class=si>{</span><span class=n>key</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>_pool</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>ConcreteFlyweight</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_pool</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>설명</strong>: <code>WeakValueDictionary</code> 는 객체가 참조되지 않으면 GC 가 제거</li><li><strong>주의</strong>: 참조 유지하지 않으면 즉시 GC 대상 → 재사용 불가</li></ul><h4 id=thread-safe-factory>Thread-Safe Factory<a hidden class=anchor aria-hidden=true href=#thread-safe-factory>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>threading</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ThreadSafeFactory</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>_lock</span> <span class=o>=</span> <span class=n>threading</span><span class=o>.</span><span class=n>Lock</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>_pool</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_lock</span><span class=p>:</span>  <span class=c1># 임계 구역 보호</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>key</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_pool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[ThreadSafe] Creating: </span><span class=si>{</span><span class=n>key</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=bp>cls</span><span class=o>.</span><span class=n>_pool</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>ConcreteFlyweight</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_pool</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>설명</strong>: 동시성 환경에서의 안전한 객체 생성 보장</li></ul><h4 id=불변-객체-설계>불변 객체 설계<a hidden class=anchor aria-hidden=true href=#불변-객체-설계>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1> 1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2> 2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3> 3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4> 4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5> 5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6> 6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7> 7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8> 8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9> 9</a>
</span><span class=lnt id=hl-12-10><a class=lnlinks href=#hl-12-10>10</a>
</span><span class=lnt id=hl-12-11><a class=lnlinks href=#hl-12-11>11</a>
</span><span class=lnt id=hl-12-12><a class=lnlinks href=#hl-12-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>ImmutableFlyweight</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=vm>__slots__</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;_state&#39;</span><span class=p>]</span>  <span class=c1># 메모리 최적화 및 불변성 의도 명확화</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>state</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_state</span> <span class=o>=</span> <span class=n>state</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@property</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>state</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_state</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>operate</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>unique</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[Immutable] Shared: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_state</span><span class=si>}</span><span class=s2>, Unique: </span><span class=si>{</span><span class=n>unique</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>설명</strong>: 내부 상태는 설정 후 변경 불가 → 상태 오염 방지 및 동시성 강화</li></ul><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>항목</strong></th><th><strong>설명</strong></th><th><strong>주요 원인</strong></th></tr></thead><tbody><tr><td><strong>메모리 최적화</strong></td><td>메모리 절약</td><td>수천~수백만 개의 객체 생성 시, 내재 상태를 공유함으로써 메모리 사용량을 대폭 절감</td><td>객체 재사용, 상태 공유</td></tr><tr><td></td><td>캐싱 효과</td><td>동일 상태의 객체는 Factory 에서 재사용되어 캐시처럼 작동하며, 메모리 접근 속도 및 응답성 향상</td><td>중앙 캐시 관리 구조</td></tr><tr><td><strong>성능 향상</strong></td><td>객체 생성 비용 절감</td><td>새로운 객체를 매번 생성하지 않고 재사용함으로써 생성 오버헤드 및 초기화 비용을 줄임</td><td>팩토리 기반 재사용 구조</td></tr><tr><td></td><td>GC 부담 감소</td><td>객체 수 감소로 인해 가비지 컬렉션의 빈도와 부하가 줄어들어 전체 시스템 성능 향상</td><td>객체 수 감소</td></tr><tr><td></td><td>시스템 응답성 향상</td><td>객체 생성, 메모리 할당, GC 등의 부하가 줄어들어 응답 속도 및 처리량 개선</td><td>경량 구조 + 메모리 효율</td></tr><tr><td><strong>일관성 및 유지보수성</strong></td><td>상태 일관성 보장</td><td>공유 객체가 동일한 내재 상태를 갖기 때문에, 모든 클라이언트에서 동일한 동작 및 값 유지</td><td>불변 공유 상태</td></tr><tr><td></td><td>관심사 분리</td><td>내재 상태와 외재 상태를 명확히 분리하여 코드 구조가 명확해지고, 유지보수와 테스트가 쉬워짐</td><td>상태 모델 분리 설계</td></tr><tr><td><strong>확장성 및 관리 효율</strong></td><td>확장성 제공</td><td>객체 수가 많아져도 상태 공유로 인해 메모리 사용이 선형적으로 증가하지 않으므로, 대규모 시스템에 적합</td><td>상태 공유 기반 구조적 장점</td></tr><tr><td></td><td>객체 관리 용이</td><td>객체의 생성, 수명, 재사용 등을 Factory 에서 일괄 관리 가능 → 객체 수 추적 및 모니터링 용이</td><td>중앙 집중형 Factory 패턴 사용</td></tr></tbody></table><ul><li><strong>Flyweight 의 가장 큰 강점은 메모리 최적화와 성능 향상</strong>.</li><li><strong>Factory 패턴 기반의 객체 재사용</strong>은 <strong>객체 관리의 일관성, 유지보수성, 확장성</strong>까지 자연스럽게 제공.</li><li>특히 대용량 데이터 또는 대규모 UI 렌더링, 게임 엔진, 문서 처리 시스템에서 강력한 장점을 발휘.</li></ul><h3 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>구분</strong></th><th><strong>항목</strong></th><th><strong>설명</strong></th><th><strong>해결 방안 및 기법</strong></th><th></th></tr></thead><tbody><tr><td><strong>설계 복잡성</strong></td><td>단점</td><td>상태 분리의 복잡성</td><td>Intrinsic/Extrinsic 상태를 명확히 나누는 것이 어려움</td><td>도메인 분석 기반 설계, 상태 다이어그램 활용, 상태 캡슐화 설계</td><td></td></tr><tr><td></td><td>단점</td><td>외부 상태 클라이언트 관리 부담</td><td>외부 상태를 클라이언트가 직접 관리해야 하므로 코드가 복잡해짐</td><td>외부 상태 전달용 Wrapper/DTO 객체 도입, 상태 헬퍼 클래스 활용</td><td></td></tr><tr><td></td><td>단점</td><td>코드 가독성 저하</td><td>공유/비공유 상태가 혼재되면 유지보수가 어려워짐</td><td>명명 규칙 통일, 설계 문서화, 역할 분리 철저</td><td></td></tr><tr><td></td><td>문제점</td><td>외부 상태 동기화 실패</td><td>외부 상태 전달 누락 또는 오류로 기능 이상 발생</td><td>상태 유효성 검증 로직 도입, 외부 상태 명세화 및 DTO 기반 전달</td><td></td></tr><tr><td><strong>성능 및 리소스 이슈</strong></td><td>단점</td><td>객체 접근 시 성능 저하</td><td>Factory 를 통한 객체 탐색 과정에서 오버헤드 발생 가능</td><td>해시 기반 검색, LRU 캐시 전략 적용, 데이터 구조 최적화</td><td></td></tr><tr><td></td><td>문제점</td><td>캐싱 누락</td><td>Factory 에 캐시 로직이 누락되면 중복 객체 생성으로 메모리 낭비</td><td>키 생성 전략 정의, 객체 생성 횟수 로깅, HashMap 기반 캐시 구현</td><td></td></tr><tr><td></td><td>문제점</td><td>메모리 누수</td><td>재사용 객체가 무한 누적될 경우 GC 가 회수하지 못하고 누수 발생</td><td>WeakReference 사용, 캐시 TTL 및 LRU 정책 적용, 캐시 정리 스케줄링</td><td></td></tr><tr><td></td><td>문제점</td><td>비효율적 적용</td><td>객체 수가 적은데도 무리하게 적용하면 오히려 복잡도 증가</td><td>사전 조건 분석 후 적용 결정 (1000+ 객체 이상 등), 적용 타당성 점검표 도입</td><td></td></tr><tr><td><strong>동시성 이슈</strong></td><td>단점</td><td>동시성 문제 가능성</td><td>멀티스레드 환경에서 공유 객체 접근 시 race condition 발생 가능</td><td>불변 객체 설계, ConcurrentHashMap 활용, 동기화 도구 (lock, atomic 등) 적용</td><td></td></tr><tr><td></td><td>문제점</td><td>스레드 간 상태 충돌</td><td>Flyweight 객체가 mutable 할 경우 상태 충돌 발생</td><td>immutable 객체 설계, 상태 변경 차단, Lock-free 설계 적용</td><td></td></tr><tr><td></td><td>문제점</td><td>공유 객체 상태 오염</td><td>의도치 않게 상태가 변경되면 전체 객체에 영향 미침</td><td>상태 변경 감시 로직 도입, 상태 변경 메서드 제거 또는 감춤</td><td></td></tr><tr><td><strong>개발 생산성</strong></td><td>단점</td><td>개발 오버헤드</td><td>초기 설계와 구현에 필요한 시간 및 리소스 증가</td><td>코드 자동 생성 도구 활용, 공통 로직 템플릿화</td><td></td></tr><tr><td></td><td>단점</td><td>오버엔지니어링 가능성</td><td>적용 대상이 아닌 곳에도 무분별하게 사용하면 오히려 유지보수 어려움</td><td>객체 수 기준 등 사전 적용 조건 정의, 적용 가이드 문서화</td><td></td></tr><tr><td></td><td>문제점</td><td>상태 일관성 검증 어려움</td><td>공유 객체이므로 상태 변경이 전체 영향 → 디버깅이 어려움</td><td>상태 변경 로그 추적 시스템, 상태 변경 테스트 케이스 구축</td><td></td></tr><tr><td></td><td>문제점</td><td>성능 개선 여부 측정 어려움</td><td>실제 메모리 절감이나 성능 향상을 수치로 측정하기 어려움</td><td>메모리/GC 프로파일링 도구 활용, 벤치마크 및 성능 로그 기반 정량 평가</td><td></td></tr></tbody></table><ul><li><strong>설계 복잡성</strong>은 Flyweight 의 대표적인 진입 장벽으로, 상태 모델링 능력이 매우 중요.</li><li><strong>동시성 이슈와 메모리 관리</strong>는 실무에서 반드시 고려되어야 하며, <strong>불변 객체 설계</strong>와 <strong>캐시 정책 적용</strong>이 핵심 해결책.</li><li><strong>적용 여부 판단</strong>도 중요하며, 오히려 성능을 저해하는 <strong>오버엔지니어링을 피하기 위한 사전 분석 절차</strong>가 필요.</li></ul><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>도전 과제</strong></th><th><strong>원인 및 영향</strong></th><th><strong>탐지 및 진단</strong></th><th><strong>예방 방법</strong></th><th><strong>해결 방안 / 기법</strong></th></tr></thead><tbody><tr><td><strong>1. 상태 설계</strong></td><td>상태 분리의 복잡성</td><td>Intrinsic(공유) / Extrinsic(외부) 상태 구분 어려움잘못된 설계 시 객체 재사용 실패</td><td>도메인 분석, 상태 다이어그램, 설계 리뷰</td><td>상태 정의 기준 명확화, 도메인 모델링, 상태 클러스터링</td><td>명확한 인터페이스 설계, 불변 객체 활용, 외부 상태 DTO/Wrapper 도입</td></tr><tr><td><strong>2. 메모리 관리</strong></td><td>객체 풀 무한 증가에 따른 메모리 누수</td><td>캐시가 계속 쌓여 GC 대상이 되지 않음메모리 소비 증가 → 성능 저하</td><td>Heap Dump, VisualVM, tracemalloc</td><td>TTL, LRU, SoftReference, 풀 정리 로직 도입</td><td>약한 참조 (WeakReference), LRU 캐시 적용, 캐시 만료 정책 구성</td></tr><tr><td></td><td>공유 범위 설계 실패</td><td>유사하지만 공유 불가능한 상태까지 캐싱 → 오용혹은 공유 가능한 상태를 캐싱하지 않음</td><td>메모리 사용 추적, 객체 생성 히스토그램</td><td>상태 범위 명확화, 유사 객체 그룹 분류</td><td>상태 기반 자동 공유 탐지 알고리즘, 정적 분석 기반 상태 분석</td></tr><tr><td><strong>3. 동시성 관리</strong></td><td>스레드 안전성 확보</td><td>공유 객체에 여러 스레드가 접근 시 동기화 문제 Race Condition 발생 가능</td><td>Race Detector, Thread Dump</td><td>불변 객체 설계, 외부 상태 분리</td><td><code>ConcurrentHashMap</code>, <code>Double-Checked Locking</code>, Lock-Free 구조, Actor 모델 적용</td></tr><tr><td><strong>4. 성능 최적화</strong></td><td>캐시 오버헤드와 튜닝</td><td>과도한 캐시 → GC 부하캐시 미스 → 객체 재생성 반복</td><td>캐시 히트율, GC 로그 분석</td><td>적절한 캐시 사이즈, 히트율 기반 조정</td><td>LFU/LRU 캐시 전략, 프로파일링 기반 리밸런싱, 분산 캐시 연계</td></tr><tr><td></td><td>성능 효과 측정의 어려움</td><td>플라이웨이트 적용 전후의 메모리/속도 측정이 명확하지 않음</td><td>Memory Profiler, Benchmark Tool</td><td>테스트 케이스 기반 정량화</td><td>프로파일링 도구 (JFR, VisualVM 등), 벤치마킹 도구 (Py-Spy, perf 등) 사용</td></tr><tr><td><strong>5. 유지보수/유연성</strong></td><td>객체 라이프사이클 관리</td><td>객체 생성/소멸 시점 불명확 시 누수 및 오작동 발생</td><td>힙 사용량 분석, 참조 카운트 확인</td><td>생성/소멸 정책 명시, 수명 주기 테스트</td><td>Reference Counting, Pool Size 제한, Auto Cleanup 로직 구현</td></tr><tr><td></td><td>적용 대상의 자동 식별 및 범용화 어려움</td><td>수작업 구현 시 코드 중복 발생, 확장 어려움</td><td>객체 수 추적, 중복 코드 탐색</td><td>코드 템플릿 및 적용 기준 자동화</td><td>AST 기반 코드 분석, 메타프로그래밍, 코드 생성기 도입</td></tr><tr><td><strong>6. 마이크로서비스 환경</strong></td><td>분산 환경에서의 객체 공유 복잡성</td><td>서비스 간 공유 객체 전송 시 네트워크 오버헤드일관성 보장 어려움</td><td>네트워크 트레이싱, 분산 로그 분석</td><td>로컬 캐시 우선, 객체 ID 전달 방식 활용</td><td>로컬 Flyweight 풀, 분산 동기화 프로토콜, 클라우드 캐싱 솔루션 활용</td></tr><tr><td><strong>7. 시스템 환경 변화</strong></td><td>현대 메모리/CPU 아키텍처 변화 대응 필요</td><td>기존 메모리 관리 기법만으로는 한계 발생</td><td>NUMA 활용도 분석, 압축 메모리 효과 분석</td><td>아키텍처 의존성 제거, 하드웨어 특화 최적화 고려</td><td>NUMA 최적화, 메모리 압축 기술 연계, 실시간 메모리 분석 도구 적용</td></tr></tbody></table><ul><li><strong>상태 분리 설계와 캐시 관리</strong>는 가장 빈번한 도전 과제이며, <strong>불변 객체와 LRU 정책</strong>이 핵심적인 대응 전략이다.</li><li><strong>멀티스레드 환경</strong>에서는 <strong>Concurrent 자료구조와 Lock-Free 설계</strong>가 중요하며,</li><li>**실무 성능 개선 효과는 정량적 측정 (프로파일링/벤치마킹)**을 통해 명확히 해야 한다.</li><li><strong>현대 분산/클라우드 환경</strong>에서는 객체 공유 전략이 더욱 복잡해지므로 <strong>로컬화 및 분산 캐싱</strong>이 효과적이다.</li></ul><h3 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th><strong>분류 카테고리</strong></th><th><strong>분류 기준</strong></th><th><strong>유형</strong></th><th><strong>설명</strong></th><th><strong>예시/활용</strong></th></tr></thead><tbody><tr><td><strong>1. 공유 전략</strong></td><td>공유 여부</td><td>Shared Flyweight</td><td>상태가 동일한 여러 객체가 공유되는 일반적 형태</td><td>기본 도형, 색상 팔레트</td></tr><tr><td></td><td></td><td>Unshared Flyweight</td><td>복합 객체 등, 일부 요소는 공유되지 않고 독립적으로 사용</td><td>복합 그래픽 객체, 특수 UI 위젯 등</td></tr><tr><td></td><td>공유 수준</td><td>Fully Shared</td><td>모든 속성이 공유되는 구조</td><td>동일 아이콘 이미지, 단색 스타일</td></tr><tr><td></td><td></td><td>Partially Shared</td><td>일부 속성만 공유되고 나머지는 외부에서 주입</td><td>같은 폰트 다른 크기의 텍스트</td></tr><tr><td><strong>2. 상태 관리</strong></td><td>상태 유형</td><td>Intrinsic State</td><td>내부 불변 상태, Flyweight 객체 내에 포함되어 공유됨</td><td>글꼴, 도형 정보 등</td></tr><tr><td></td><td></td><td>Extrinsic State</td><td>외부에서 전달되는 개별 상태, 클라이언트가 보관 및 전달</td><td>위치, 회전, 사용자 입력 값</td></tr><tr><td></td><td>상태 가변성</td><td>Immutable Flyweight</td><td>불변 객체로 상태 변경 불가</td><td>문자 객체, 스프라이트, 스타일 버튼 등</td></tr><tr><td></td><td></td><td>Mutable Flyweight</td><td>내재 상태는 고정, 외부 상태나 동작은 유동적</td><td>DB 연결 객체, 네트워크 핸들러</td></tr><tr><td><strong>3. 생성 방식</strong></td><td>생성 시점</td><td>Eager Initialization</td><td>시작 시 전체 객체를 한 번에 생성</td><td>요일, 월, 고정된 게임 타일 등</td></tr><tr><td></td><td></td><td>Lazy Initialization</td><td>사용 요청 시점에 생성되는 방식</td><td>사용자 요청 기반 UI 구성요소</td></tr><tr><td></td><td>생성 전략</td><td>Factory 기반</td><td>중앙 팩토리에서 객체를 관리하고 제공</td><td>FlyweightFactory</td></tr><tr><td></td><td></td><td>스마트 참조 기반</td><td>캐시, 스마트 포인터, Object Pool 기반</td><td>SoftReference 기반 캐싱</td></tr><tr><td><strong>4. 메모리 관리</strong></td><td>저장 방식</td><td>Centralized Pool</td><td>하나의 풀에서 모든 Flyweight 객체를 관리</td><td>HashMap 기반 객체 관리</td></tr><tr><td></td><td></td><td>Distributed Pool</td><td>유형이나 카테고리별로 분산된 풀에서 관리</td><td>모듈별 전용 캐시, 멀티팩토리 구조</td></tr><tr><td></td><td>보존 전략</td><td>Permanent Pool</td><td>애플리케이션 종료까지 유지되는 형태</td><td>시스템 공통 리소스 (e.g., 기본 폰트)</td></tr><tr><td></td><td></td><td>Temporary Pool</td><td>일정 조건이나 시간 이후 GC 대상이 되는 약한 참조 기반</td><td>임시 메시지 객체, 로그 항목</td></tr><tr><td><strong>5. 적용 도메인</strong></td><td>적용 분야</td><td>그래픽 Flyweight</td><td>3D 모델, 텍스처 등 시각 요소 공유</td><td>게임 오브젝트, 배경 요소</td></tr><tr><td></td><td></td><td>텍스트 Flyweight</td><td>문자, 스타일 등 반복되는 텍스트 구성 요소 공유</td><td>워드 프로세서, 코드 에디터</td></tr><tr><td></td><td></td><td>UI 컴포넌트 Flyweight</td><td>공통된 버튼, 아이콘, 입력 필드 등 UI 구성 요소</td><td>리스트뷰, GridView 등에서의 View 재사용</td></tr><tr><td></td><td></td><td>데이터 커넥션 Flyweight</td><td>DB 연결, 네트워크 소켓 등의 반복적 연결 객체 재사용</td><td>Connection Pool, HTTP Connection 재사용</td></tr></tbody></table><h3 id=실무-적용-예시>실무 적용 예시<a hidden class=anchor aria-hidden=true href=#실무-적용-예시>#</a></h3><table><thead><tr><th><strong>도메인</strong></th><th><strong>적용 사례</strong></th><th><strong>공유 객체 (Flyweight)</strong></th><th><strong>외부 상태 (Extrinsic)</strong></th><th><strong>사용 기술</strong></th><th><strong>기대 효과</strong></th></tr></thead><tbody><tr><td><strong>텍스트 처리</strong></td><td>텍스트 에디터 문자 객체</td><td>폰트, 스타일, 크기 등 렌더링 속성</td><td>문자 위치, 컬러, 개별 속성</td><td>Font Engine, Unicode, PDF Renderer</td><td>수천~수만 개 문자에 대한 메모리 절감 (최대 90%)</td></tr><tr><td><strong>게임 개발</strong></td><td>배경 오브젝트, 총알, NPC, 파티클 등</td><td>3D 모델, 텍스처, 애니메이션 정보</td><td>위치, 방향, 속도, 상태 등</td><td>Unity, Unreal Engine, Graphics API</td><td>렌더링 최적화, 프레임 향상, 대량 객체 관리 가능</td></tr><tr><td><strong>웹 브라우저</strong></td><td>HTML DOM 요소 렌더링</td><td>CSS 스타일, 공통 레이아웃</td><td>DOM 구조, 텍스트, 위치 등</td><td>HTML Parser, CSS Engine, Virtual DOM</td><td>로딩 속도 향상, 스타일 재사용으로 메모리 절감</td></tr><tr><td><strong>GUI 프레임워크</strong></td><td>공통 버튼, 아이콘, 위젯</td><td>공통 UI 스타일, 컴포넌트 구조</td><td>이벤트 핸들러, 상태값 등</td><td>Java Swing, React, Flutter</td><td>컴포넌트 재사용, 렌더링 최적화</td></tr><tr><td><strong>지도 서비스</strong></td><td>마커 아이콘, 지도 타일</td><td>아이콘 이미지, 타일 템플릿</td><td>위도/경도, 현재 뷰 포인트</td><td>Leaflet.js, Mapbox, Spatial Index</td><td>대용량 지도 데이터에서도 빠른 렌더링과 메모리 절약</td></tr><tr><td><strong>데이터 시각화</strong></td><td>차트의 데이터 포인트</td><td>마커 모양, 시각적 스타일</td><td>값 좌표, 색상, 범례 항목</td><td>D3.js, WebGL, Highcharts</td><td>대량 데이터 실시간 시각화 성능 확보</td></tr><tr><td><strong>문서 처리</strong></td><td>PDF, 워드 문서 렌더링</td><td>공통 서체 정보, 스타일 속성</td><td>문자 위치, 하이라이트 정보</td><td>PDF.js, Word Processor Engine</td><td>대용량 문서 처리 시 메모리 사용량 최소화</td></tr><tr><td><strong>DB 및 미들웨어</strong></td><td>쿼리 객체, 연결 (Connection) 풀 관리</td><td>쿼리 문자열 구조, 커넥션 템플릿</td><td>파라미터, 사용자 세션 등</td><td>JDBC, HikariCP, ORM Cache</td><td>커넥션/쿼리 재사용으로 동시성 처리량 증가</td></tr><tr><td><strong>사물인터넷 (IoT)</strong></td><td>센서 데이터 처리 객체 재사용</td><td>공통 센서 유형, 포맷 구조</td><td>실시간 측정값, 디바이스 ID 등</td><td>MicroPython, C++, MQTT</td><td>제한된 메모리 환경에서도 고성능 처리 가능</td></tr><tr><td><strong>그래픽/렌더링</strong></td><td>3D 그래픽 구성요소, 게임 맵 등</td><td>메시 (mesh), 쉐이더, 재질 (material) 정보</td><td>위치, 회전, 광원 정보 등</td><td>OpenGL, Vulkan, Three.js</td><td>대규모 씬 처리 시 GPU/메모리 자원 절약</td></tr></tbody></table><ul><li><strong>Flyweight 은 " 공통 속성 " 을 공유</strong>하고, <strong>" 개별 속성 " 은 외부에서 주입</strong>하여 메모리 효율을 극대화함</li><li>실무에서는 <strong>텍스트, 렌더링, GUI, 데이터 시각화, IoT 등 메모리 최적화가 중요한 분야</strong>에서 주로 활용</li><li><strong>공통 리소스를 최대한 분리하고 관리하는 구조 설계</strong>가 핵심이며, <strong>팩토리 + 캐시 + 불변 객체</strong> 조합이 자주 사용됨</li></ul><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><h4 id=사례-1-텍스트-에디터-시스템>사례 1: 텍스트 에디터 시스템<a hidden class=anchor aria-hidden=true href=#사례-1-텍스트-에디터-시스템>#</a></h4><p>Microsoft Word 와 같은 텍스트 에디터에서 수천, 수만 개의 문자 객체를 효율적으로 관리해야 하는 상황</p><p><strong>시스템 구성</strong>:</p><pre class=mermaid>graph TB
    A[Document Editor] --&gt; B[Character Factory]
    B --&gt; C[Character Pool]
    C --&gt; D[Character A]
    C --&gt; E[Character B]
    C --&gt; F[Character …]
    
    A --&gt; G[Document Context]
    G --&gt; H[Position Info]
    G --&gt; I[Formatting Info]
    G --&gt; J[Style Info]
    
    D --&gt; K[Font Family]
    D --&gt; L[Font Size]
    E --&gt; K
    E --&gt; L
</pre><p><strong>Workflow</strong>:</p><ol><li>사용자가 문자 입력</li><li>Character Factory 에서 해당 문자 객체 확인</li><li>기존 객체가 있으면 재사용, 없으면 새로 생성</li><li>Document Context 에서 위치, 스타일 정보 관리</li><li>렌더링 시 Flyweight 객체와 외재적 상태 결합</li></ol><p><strong>Flyweight Pattern 의 역할</strong>:</p><ul><li>동일한 문자의 중복 생성 방지</li><li>폰트 정보와 같은 공통 속성 공유</li><li>메모리 사용량 최적화</li></ul><p><strong>Pattern 적용 전후 차이점</strong>:</p><ul><li><strong>적용 전</strong>: 각 문자마다 별도 객체 생성, 메모리 사용량 급증</li><li><strong>적용 후</strong>: 문자 종류만큼만 객체 생성, 메모리 사용량 90% 감소</li></ul><h4 id=사례-2-멀티플레이어-게임의-총알-시스템>사례 2: 멀티플레이어 게임의 총알 시스템<a hidden class=anchor aria-hidden=true href=#사례-2-멀티플레이어-게임의-총알-시스템>#</a></h4><p>대규모 멀티플레이어 슈팅 게임에서 수천 개의 총알 객체가 동시에 화면에 존재하는 상황</p><p><strong>시스템 구성</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1>1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2>2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3>3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4>4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5>5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6>6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7>7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Game Engine
</span></span><span class=line><span class=cl>├── BulletFactory (플라이웨이트 팩토리)
</span></span><span class=line><span class=cl>├── BulletType (플라이웨이트 인터페이스)
</span></span><span class=line><span class=cl>│   ├── PistolBullet (구체적 플라이웨이트)
</span></span><span class=line><span class=cl>│   ├── RifleBullet (구체적 플라이웨이트)
</span></span><span class=line><span class=cl>│   └── SniperBullet (구체적 플라이웨이트)
</span></span><span class=line><span class=cl>├── BulletContext (컨텍스트)
</span></span><span class=line><span class=cl>└── GameObjectManager (클라이언트)
</span></span></code></pre></td></tr></table></div></div><p><strong>구성 다이어그램</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1>1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2>2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3>3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4>4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5>5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6>6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Player → GameObjectManager → BulletFactory
</span></span><span class=line><span class=cl>                ↓
</span></span><span class=line><span class=cl>            BulletType (공유 객체)
</span></span><span class=line><span class=cl>                ↓
</span></span><span class=line><span class=cl>        BulletContext (개별 상태: 위치, 속도, 방향)
</span></span><span class=line><span class=cl>                ↓
</span></span><span class=line><span class=cl>            Rendering Engine
</span></span></code></pre></td></tr></table></div></div><p><strong>Workflow</strong>:</p><ol><li><strong>총알 발사 요청</strong>: 플레이어가 발사 버튼 클릭</li><li><strong>팩토리 조회</strong>: GameObjectManager 가 BulletFactory 에 해당 총알 타입 요청</li><li><strong>플라이웨이트 반환</strong>: 기존 BulletType 객체 반환 또는 새로 생성</li><li><strong>컨텍스트 생성</strong>: 총알의 위치, 속도, 방향 등 외부 상태로 BulletContext 생성</li><li><strong>게임 루프 처리</strong>: 매 프레임마다 BulletContext 업데이트 및 렌더링</li></ol><p><strong>담당 역할</strong>:</p><ul><li><strong>BulletFactory</strong>: 총알 타입별 플라이웨이트 객체 관리 (메모리 3 개 객체만 유지)</li><li><strong>BulletType</strong>: 총알의 공통 속성 (데미지, 스프라이트, 사운드) 저장</li><li><strong>BulletContext</strong>: 개별 총알의 동적 상태 (위치, 속도, 생존시간) 관리</li><li><strong>메모리 효과</strong>: 10,000 개 총알 × 각 100KB → 3 개 플라이웨이트 × 50KB + 10,000 개 컨텍스트 × 5KB = 200KB (99% 절약)</li></ul><h3 id=구현-예시>구현 예시<a hidden class=anchor aria-hidden=true href=#구현-예시>#</a></h3><h4 id=python>Python<a hidden class=anchor aria-hidden=true href=#python>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11>11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12>12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13>13</a>
</span><span class=lnt id=hl-16-14><a class=lnlinks href=#hl-16-14>14</a>
</span><span class=lnt id=hl-16-15><a class=lnlinks href=#hl-16-15>15</a>
</span><span class=lnt id=hl-16-16><a class=lnlinks href=#hl-16-16>16</a>
</span><span class=lnt id=hl-16-17><a class=lnlinks href=#hl-16-17>17</a>
</span><span class=lnt id=hl-16-18><a class=lnlinks href=#hl-16-18>18</a>
</span><span class=lnt id=hl-16-19><a class=lnlinks href=#hl-16-19>19</a>
</span><span class=lnt id=hl-16-20><a class=lnlinks href=#hl-16-20>20</a>
</span><span class=lnt id=hl-16-21><a class=lnlinks href=#hl-16-21>21</a>
</span><span class=lnt id=hl-16-22><a class=lnlinks href=#hl-16-22>22</a>
</span><span class=lnt id=hl-16-23><a class=lnlinks href=#hl-16-23>23</a>
</span><span class=lnt id=hl-16-24><a class=lnlinks href=#hl-16-24>24</a>
</span><span class=lnt id=hl-16-25><a class=lnlinks href=#hl-16-25>25</a>
</span><span class=lnt id=hl-16-26><a class=lnlinks href=#hl-16-26>26</a>
</span><span class=lnt id=hl-16-27><a class=lnlinks href=#hl-16-27>27</a>
</span><span class=lnt id=hl-16-28><a class=lnlinks href=#hl-16-28>28</a>
</span><span class=lnt id=hl-16-29><a class=lnlinks href=#hl-16-29>29</a>
</span><span class=lnt id=hl-16-30><a class=lnlinks href=#hl-16-30>30</a>
</span><span class=lnt id=hl-16-31><a class=lnlinks href=#hl-16-31>31</a>
</span><span class=lnt id=hl-16-32><a class=lnlinks href=#hl-16-32>32</a>
</span><span class=lnt id=hl-16-33><a class=lnlinks href=#hl-16-33>33</a>
</span><span class=lnt id=hl-16-34><a class=lnlinks href=#hl-16-34>34</a>
</span><span class=lnt id=hl-16-35><a class=lnlinks href=#hl-16-35>35</a>
</span><span class=lnt id=hl-16-36><a class=lnlinks href=#hl-16-36>36</a>
</span><span class=lnt id=hl-16-37><a class=lnlinks href=#hl-16-37>37</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>TreeType</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>color</span><span class=p>,</span> <span class=n>texture</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>color</span> <span class=o>=</span> <span class=n>color</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>texture</span> <span class=o>=</span> <span class=n>texture</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>draw</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Drawing </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s2> at (</span><span class=si>{</span><span class=n>x</span><span class=si>}</span><span class=s2>,</span><span class=si>{</span><span class=n>y</span><span class=si>}</span><span class=s2>) with </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>color</span><span class=si>}</span><span class=s2> and </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>texture</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TreeFactory</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>_tree_types</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_tree_type</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>color</span><span class=p>,</span> <span class=n>texture</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>key</span> <span class=o>=</span> <span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>color</span><span class=p>,</span> <span class=n>texture</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>key</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_tree_types</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Creating new TreeType&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>cls</span><span class=o>.</span><span class=n>_tree_types</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>TreeType</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>color</span><span class=p>,</span> <span class=n>texture</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_tree_types</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Tree</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>tree_type</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>=</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>y</span> <span class=o>=</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>tree_type</span> <span class=o>=</span> <span class=n>tree_type</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>draw</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>tree_type</span><span class=o>.</span><span class=n>draw</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=n>forest</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>tree_type</span> <span class=o>=</span> <span class=n>TreeFactory</span><span class=o>.</span><span class=n>get_tree_type</span><span class=p>(</span><span class=s2>&#34;Oak&#34;</span><span class=p>,</span> <span class=s2>&#34;Green&#34;</span><span class=p>,</span> <span class=s2>&#34;Rough&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>forest</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Tree</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=n>tree_type</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>forest</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Tree</span><span class=p>(</span><span class=mi>30</span><span class=p>,</span> <span class=mi>40</span><span class=p>,</span> <span class=n>tree_type</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>tree</span> <span class=ow>in</span> <span class=n>forest</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>tree</span><span class=o>.</span><span class=n>draw</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=python-문서-컨텍스트-관리>Python: 문서 컨텍스트 관리<a hidden class=anchor aria-hidden=true href=#python-문서-컨텍스트-관리>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1> 1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2> 2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3> 3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4> 4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5> 5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6> 6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7> 7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8> 8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9> 9</a>
</span><span class=lnt id=hl-17-10><a class=lnlinks href=#hl-17-10>10</a>
</span><span class=lnt id=hl-17-11><a class=lnlinks href=#hl-17-11>11</a>
</span><span class=lnt id=hl-17-12><a class=lnlinks href=#hl-17-12>12</a>
</span><span class=lnt id=hl-17-13><a class=lnlinks href=#hl-17-13>13</a>
</span><span class=lnt id=hl-17-14><a class=lnlinks href=#hl-17-14>14</a>
</span><span class=lnt id=hl-17-15><a class=lnlinks href=#hl-17-15>15</a>
</span><span class=lnt id=hl-17-16><a class=lnlinks href=#hl-17-16>16</a>
</span><span class=lnt id=hl-17-17><a class=lnlinks href=#hl-17-17>17</a>
</span><span class=lnt id=hl-17-18><a class=lnlinks href=#hl-17-18>18</a>
</span><span class=lnt id=hl-17-19><a class=lnlinks href=#hl-17-19>19</a>
</span><span class=lnt id=hl-17-20><a class=lnlinks href=#hl-17-20>20</a>
</span><span class=lnt id=hl-17-21><a class=lnlinks href=#hl-17-21>21</a>
</span><span class=lnt id=hl-17-22><a class=lnlinks href=#hl-17-22>22</a>
</span><span class=lnt id=hl-17-23><a class=lnlinks href=#hl-17-23>23</a>
</span><span class=lnt id=hl-17-24><a class=lnlinks href=#hl-17-24>24</a>
</span><span class=lnt id=hl-17-25><a class=lnlinks href=#hl-17-25>25</a>
</span><span class=lnt id=hl-17-26><a class=lnlinks href=#hl-17-26>26</a>
</span><span class=lnt id=hl-17-27><a class=lnlinks href=#hl-17-27>27</a>
</span><span class=lnt id=hl-17-28><a class=lnlinks href=#hl-17-28>28</a>
</span><span class=lnt id=hl-17-29><a class=lnlinks href=#hl-17-29>29</a>
</span><span class=lnt id=hl-17-30><a class=lnlinks href=#hl-17-30>30</a>
</span><span class=lnt id=hl-17-31><a class=lnlinks href=#hl-17-31>31</a>
</span><span class=lnt id=hl-17-32><a class=lnlinks href=#hl-17-32>32</a>
</span><span class=lnt id=hl-17-33><a class=lnlinks href=#hl-17-33>33</a>
</span><span class=lnt id=hl-17-34><a class=lnlinks href=#hl-17-34>34</a>
</span><span class=lnt id=hl-17-35><a class=lnlinks href=#hl-17-35>35</a>
</span><span class=lnt id=hl-17-36><a class=lnlinks href=#hl-17-36>36</a>
</span><span class=lnt id=hl-17-37><a class=lnlinks href=#hl-17-37>37</a>
</span><span class=lnt id=hl-17-38><a class=lnlinks href=#hl-17-38>38</a>
</span><span class=lnt id=hl-17-39><a class=lnlinks href=#hl-17-39>39</a>
</span><span class=lnt id=hl-17-40><a class=lnlinks href=#hl-17-40>40</a>
</span><span class=lnt id=hl-17-41><a class=lnlinks href=#hl-17-41>41</a>
</span><span class=lnt id=hl-17-42><a class=lnlinks href=#hl-17-42>42</a>
</span><span class=lnt id=hl-17-43><a class=lnlinks href=#hl-17-43>43</a>
</span><span class=lnt id=hl-17-44><a class=lnlinks href=#hl-17-44>44</a>
</span><span class=lnt id=hl-17-45><a class=lnlinks href=#hl-17-45>45</a>
</span><span class=lnt id=hl-17-46><a class=lnlinks href=#hl-17-46>46</a>
</span><span class=lnt id=hl-17-47><a class=lnlinks href=#hl-17-47>47</a>
</span><span class=lnt id=hl-17-48><a class=lnlinks href=#hl-17-48>48</a>
</span><span class=lnt id=hl-17-49><a class=lnlinks href=#hl-17-49>49</a>
</span><span class=lnt id=hl-17-50><a class=lnlinks href=#hl-17-50>50</a>
</span><span class=lnt id=hl-17-51><a class=lnlinks href=#hl-17-51>51</a>
</span><span class=lnt id=hl-17-52><a class=lnlinks href=#hl-17-52>52</a>
</span><span class=lnt id=hl-17-53><a class=lnlinks href=#hl-17-53>53</a>
</span><span class=lnt id=hl-17-54><a class=lnlinks href=#hl-17-54>54</a>
</span><span class=lnt id=hl-17-55><a class=lnlinks href=#hl-17-55>55</a>
</span><span class=lnt id=hl-17-56><a class=lnlinks href=#hl-17-56>56</a>
</span><span class=lnt id=hl-17-57><a class=lnlinks href=#hl-17-57>57</a>
</span><span class=lnt id=hl-17-58><a class=lnlinks href=#hl-17-58>58</a>
</span><span class=lnt id=hl-17-59><a class=lnlinks href=#hl-17-59>59</a>
</span><span class=lnt id=hl-17-60><a class=lnlinks href=#hl-17-60>60</a>
</span><span class=lnt id=hl-17-61><a class=lnlinks href=#hl-17-61>61</a>
</span><span class=lnt id=hl-17-62><a class=lnlinks href=#hl-17-62>62</a>
</span><span class=lnt id=hl-17-63><a class=lnlinks href=#hl-17-63>63</a>
</span><span class=lnt id=hl-17-64><a class=lnlinks href=#hl-17-64>64</a>
</span><span class=lnt id=hl-17-65><a class=lnlinks href=#hl-17-65>65</a>
</span><span class=lnt id=hl-17-66><a class=lnlinks href=#hl-17-66>66</a>
</span><span class=lnt id=hl-17-67><a class=lnlinks href=#hl-17-67>67</a>
</span><span class=lnt id=hl-17-68><a class=lnlinks href=#hl-17-68>68</a>
</span><span class=lnt id=hl-17-69><a class=lnlinks href=#hl-17-69>69</a>
</span><span class=lnt id=hl-17-70><a class=lnlinks href=#hl-17-70>70</a>
</span><span class=lnt id=hl-17-71><a class=lnlinks href=#hl-17-71>71</a>
</span><span class=lnt id=hl-17-72><a class=lnlinks href=#hl-17-72>72</a>
</span><span class=lnt id=hl-17-73><a class=lnlinks href=#hl-17-73>73</a>
</span><span class=lnt id=hl-17-74><a class=lnlinks href=#hl-17-74>74</a>
</span><span class=lnt id=hl-17-75><a class=lnlinks href=#hl-17-75>75</a>
</span><span class=lnt id=hl-17-76><a class=lnlinks href=#hl-17-76>76</a>
</span><span class=lnt id=hl-17-77><a class=lnlinks href=#hl-17-77>77</a>
</span><span class=lnt id=hl-17-78><a class=lnlinks href=#hl-17-78>78</a>
</span><span class=lnt id=hl-17-79><a class=lnlinks href=#hl-17-79>79</a>
</span><span class=lnt id=hl-17-80><a class=lnlinks href=#hl-17-80>80</a>
</span><span class=lnt id=hl-17-81><a class=lnlinks href=#hl-17-81>81</a>
</span><span class=lnt id=hl-17-82><a class=lnlinks href=#hl-17-82>82</a>
</span><span class=lnt id=hl-17-83><a class=lnlinks href=#hl-17-83>83</a>
</span><span class=lnt id=hl-17-84><a class=lnlinks href=#hl-17-84>84</a>
</span><span class=lnt id=hl-17-85><a class=lnlinks href=#hl-17-85>85</a>
</span><span class=lnt id=hl-17-86><a class=lnlinks href=#hl-17-86>86</a>
</span><span class=lnt id=hl-17-87><a class=lnlinks href=#hl-17-87>87</a>
</span><span class=lnt id=hl-17-88><a class=lnlinks href=#hl-17-88>88</a>
</span><span class=lnt id=hl-17-89><a class=lnlinks href=#hl-17-89>89</a>
</span><span class=lnt id=hl-17-90><a class=lnlinks href=#hl-17-90>90</a>
</span><span class=lnt id=hl-17-91><a class=lnlinks href=#hl-17-91>91</a>
</span><span class=lnt id=hl-17-92><a class=lnlinks href=#hl-17-92>92</a>
</span><span class=lnt id=hl-17-93><a class=lnlinks href=#hl-17-93>93</a>
</span><span class=lnt id=hl-17-94><a class=lnlinks href=#hl-17-94>94</a>
</span><span class=lnt id=hl-17-95><a class=lnlinks href=#hl-17-95>95</a>
</span><span class=lnt id=hl-17-96><a class=lnlinks href=#hl-17-96>96</a>
</span><span class=lnt id=hl-17-97><a class=lnlinks href=#hl-17-97>97</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABC</span><span class=p>,</span> <span class=n>abstractmethod</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>Optional</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Character</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Flyweight 인터페이스 - 문자 객체의 공통 인터페이스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>render</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>position_x</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>position_y</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>font_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>color</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;문자 렌더링 - 외재적 상태를 매개변수로 받음&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ConcreteCharacter</span><span class=p>(</span><span class=n>Character</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;구체적인 Flyweight - 공유 가능한 문자 객체&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>symbol</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>font_family</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 내재적 상태 - 모든 인스턴스에서 공유됨</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_symbol</span> <span class=o>=</span> <span class=n>symbol</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_font_family</span> <span class=o>=</span> <span class=n>font_family</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>render</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>position_x</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>position_y</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>font_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>color</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;외재적 상태와 내재적 상태를 결합하여 문자 렌더링&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;문자 &#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_symbol</span><span class=si>}</span><span class=s2>&#39; 렌더링:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  위치: (</span><span class=si>{</span><span class=n>position_x</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>position_y</span><span class=si>}</span><span class=s2>)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  폰트: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>_font_family</span><span class=si>}</span><span class=s2>, 크기: </span><span class=si>{</span><span class=n>font_size</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  색상: </span><span class=si>{</span><span class=n>color</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CharacterFactory</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Flyweight Factory - 문자 객체 생성 및 관리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>_characters</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Character</span><span class=p>]</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_character</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=n>symbol</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>font_family</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;Arial&#34;</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Character</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;문자 객체 획득 - 기존 객체 재사용 또는 새로 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>key</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>symbol</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>font_family</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>key</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_characters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;새로운 문자 객체 생성: </span><span class=si>{</span><span class=n>symbol</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>font_family</span><span class=si>}</span><span class=s2>)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>cls</span><span class=o>.</span><span class=n>_characters</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>ConcreteCharacter</span><span class=p>(</span><span class=n>symbol</span><span class=p>,</span> <span class=n>font_family</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;기존 문자 객체 재사용: </span><span class=si>{</span><span class=n>symbol</span><span class=si>}</span><span class=s2> (</span><span class=si>{</span><span class=n>font_family</span><span class=si>}</span><span class=s2>)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_characters</span><span class=p>[</span><span class=n>key</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@classmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_created_characters_count</span><span class=p>(</span><span class=bp>cls</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;생성된 문자 객체 수 반환&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>_characters</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Document</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;클라이언트 - 문서 컨텍스트 관리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_characters</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># 문자와 외재적 상태 저장</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_character</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>symbol</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>x</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                     <span class=n>font_size</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>color</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>font_family</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&#34;Arial&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;문자 추가 - Flyweight 객체와 외재적 상태 관리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>character</span> <span class=o>=</span> <span class=n>CharacterFactory</span><span class=o>.</span><span class=n>get_character</span><span class=p>(</span><span class=n>symbol</span><span class=p>,</span> <span class=n>font_family</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_characters</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;character&#39;</span><span class=p>:</span> <span class=n>character</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;x&#39;</span><span class=p>:</span> <span class=n>x</span><span class=p>,</span> <span class=s1>&#39;y&#39;</span><span class=p>:</span> <span class=n>y</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;font_size&#39;</span><span class=p>:</span> <span class=n>font_size</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;color&#39;</span><span class=p>:</span> <span class=n>color</span>
</span></span><span class=line><span class=cl>        <span class=p>})</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>render_document</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;문서 전체 렌더링&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>=== 문서 렌더링 시작 ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>char_data</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_characters</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>char_data</span><span class=p>[</span><span class=s1>&#39;character&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>render</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>char_data</span><span class=p>[</span><span class=s1>&#39;x&#39;</span><span class=p>],</span> <span class=n>char_data</span><span class=p>[</span><span class=s1>&#39;y&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>char_data</span><span class=p>[</span><span class=s1>&#39;font_size&#39;</span><span class=p>],</span> <span class=n>char_data</span><span class=p>[</span><span class=s1>&#39;color&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>총 생성된 Character 객체 수: </span><span class=si>{</span><span class=n>CharacterFactory</span><span class=o>.</span><span class=n>get_created_characters_count</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;총 문서 내 문자 수: </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_characters</span><span class=p>)</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>document</span> <span class=o>=</span> <span class=n>Document</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># &#34;HELLO&#34; 문자열 추가 - 같은 문자는 객체 재사용</span>
</span></span><span class=line><span class=cl>    <span class=n>word</span> <span class=o>=</span> <span class=s2>&#34;HELLO&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>symbol</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>word</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>document</span><span class=o>.</span><span class=n>add_character</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>symbol</span><span class=o>=</span><span class=n>symbol</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>x</span><span class=o>=</span><span class=n>i</span> <span class=o>*</span> <span class=mi>20</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>font_size</span><span class=o>=</span><span class=mi>12</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;black&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 동일한 문자 &#39;L&#39; 다시 사용 - 기존 객체 재사용됨</span>
</span></span><span class=line><span class=cl>    <span class=n>document</span><span class=o>.</span><span class=n>add_character</span><span class=p>(</span><span class=s1>&#39;L&#39;</span><span class=p>,</span> <span class=mi>150</span><span class=p>,</span> <span class=mi>100</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=s2>&#34;red&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>document</span><span class=o>.</span><span class=n>render_document</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>고려 항목</strong></th><th><strong>설명</strong></th><th><strong>권장사항</strong></th></tr></thead><tbody><tr><td><strong>설계 단계</strong></td><td>상태 분석</td><td>공유 가능한 상태 (intrinsic) 와 개별 상태 (extrinsic) 를 명확히 구분</td><td>도메인 모델 기반 분석, 문서화, UML 등으로 분리 구조 시각화</td></tr><tr><td></td><td>적용 조건 확인</td><td>유사한 객체가 충분히 많은 상황에서만 Flyweight 적용이 효과적</td><td>1000 개 이상 객체 생성 예상 시 도입 고려</td></tr><tr><td></td><td>공유 기준 정의</td><td>어느 범위까지 상태를 공유할 것인지 결정 필요</td><td>설계 시점에 intrinsic/extrinsic 경계 정의, 책임 분리</td></tr><tr><td></td><td>외부 상태 전달 전략</td><td>외부 상태가 많아지면 클라이언트의 관리 복잡도 증가</td><td>DTO, Wrapper, Context 객체 등을 통한 관리</td></tr><tr><td></td><td>메모리 사용량 분석</td><td>Flyweight 적용이 메모리 절약에 실질적으로 기여하는지 측정 필요</td><td>적용 전/후 메모리 프로파일링 (JFR, VisualVM, tracemalloc 등)</td></tr><tr><td><strong>구현 단계</strong></td><td>팩토리 설계</td><td>Flyweight 객체의 생성과 캐싱을 책임지는 팩토리 구조</td><td>HashMap 캐싱, LRU 정책, Singleton 또는 추상 팩토리 패턴 적용</td></tr><tr><td></td><td>팩토리 동시성 관리</td><td>멀티스레드 환경에서의 객체 중복 생성 방지</td><td>Double-Checked Locking, ConcurrentHashMap 활용</td></tr><tr><td></td><td>객체 라이프사이클 관리</td><td>객체의 생성/소멸 시점을 명확히 제어해야 메모리 누수를 방지</td><td>약한 참조 (WeakReference), TTL 기반 캐시, 참조 카운팅 등 적용</td></tr><tr><td></td><td>불변성 보장</td><td>공유 객체가 외부에서 변경되면 전체 시스템에 오류 유발 가능</td><td>불변 객체 (Immutable Object), final/const 필드 사용, setter 제거</td></tr><tr><td><strong>성능 최적화</strong></td><td>캐시 전략</td><td>무제한 캐시로 인한 메모리 문제 발생 방지</td><td>LRU, TTL 캐시 정책, 캐시 최대 크기 제한 설정</td></tr><tr><td></td><td>캐시 오버헤드</td><td>캐시 관리가 과도해지면 오히려 성능 저하 유발 가능</td><td>적중률 기반 캐시 최적화, GC-Friendly 전략 적용</td></tr><tr><td></td><td>동시성 처리</td><td>다중 스레드에서의 안정성 확보 필요</td><td>읽기 전용 객체 설계, 동기화 최소화, Lock-Free 자료구조 사용</td></tr><tr><td></td><td>지연 초기화 (Lazy Loading)</td><td>필요 시점에만 객체 생성하여 초기 리소스 사용 최소화</td><td>Factory 내 lazy instantiation 적용</td></tr><tr><td><strong>유지보수성</strong></td><td>팩토리 책임 분리</td><td>팩토리가 너무 많은 책임을 가지면 코드 관리가 어려워짐</td><td>타입별 팩토리 분리, SRP 적용, 인터페이스 기반 구조 적용</td></tr><tr><td></td><td>확장성 고려</td><td>새로운 Flyweight 타입을 유연하게 추가 가능해야 함</td><td>추상 팩토리 패턴, DI/IoC 구조 설계 고려</td></tr><tr><td></td><td>코드 문서화</td><td>상태 분리 기준과 객체 공유 구조가 명확히 문서화되지 않으면 유지보수가 어려움</td><td>주석, 다이어그램, 적용 기준 명시</td></tr><tr><td><strong>테스트 전략</strong></td><td>공유 객체 검증</td><td>공유 객체의 변경이 전체 시스템에 영향을 줄 수 있으므로 정밀 테스트 필요</td><td>불변성 테스트, 상태 변경 감지 테스트, 객체 생성 횟수 측정 등</td></tr><tr><td></td><td>메모리 사용 테스트</td><td>메모리 절약 효과를 실제로 검증해야 설계의 타당성이 확보됨</td><td>적용 전/후의 객체 수, 메모리 사용량 비교 측정</td></tr></tbody></table><ul><li><strong>" 공유 가능한 객체인가?"</strong> 를 기준으로 상태 분석이 가장 우선되어야 하며,</li><li><strong>팩토리는 단일 책임을 갖되 동시성과 캐시 관리까지 효율적으로 수행</strong>해야 함</li><li><strong>불변성 보장과 외부 상태 관리는 실무에서의 안정성과 유지보수성을 좌우</strong></li><li><strong>정량적 측정과 테스트 자동화를 통해 적용 효과를 검증해야 함</strong></li></ul><h4 id=테스트-전략>테스트 전략<a hidden class=anchor aria-hidden=true href=#테스트-전략>#</a></h4><ul><li><strong>동일 객체 반환 여부 확인</strong></li><li><strong>외부 상태 전달 시 정상 동작 확인</strong></li></ul><h4 id=리팩토링-전략>리팩토링 전략<a hidden class=anchor aria-hidden=true href=#리팩토링-전략>#</a></h4><ul><li><strong>중복 객체 생성 코드를 FlyweightFactory 로 이동</strong></li><li><strong>상태 분리 명확화</strong></li></ul><h4 id=활용-시-흔한-실수>활용 시 흔한 실수<a hidden class=anchor aria-hidden=true href=#활용-시-흔한-실수>#</a></h4><ul><li><strong>내부/외부 상태 구분 불명확</strong></li><li><strong>동시성 문제 무시</strong></li></ul><h3 id=성능을-최적화하기-위한-고려사항-및-주의할-점>성능을 최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#성능을-최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>고려 항목</strong></th><th><strong>설명</strong></th><th><strong>권장사항</strong></th></tr></thead><tbody><tr><td><strong>메모리 최적화</strong></td><td>객체 풀 크기 설정</td><td>풀 크기를 조절하여 과도한 메모리 점유 또는 미사용 객체 방지</td><td>애플리케이션 특성 기반 임계값 설정</td></tr><tr><td></td><td>GC 부하</td><td>공유 객체가 많을수록 GC 압력 증가</td><td>약한 참조 사용 (e.g. <code>WeakReference</code>), GC 튜닝 (G1GC, ZGC 등) 적용</td></tr><tr><td></td><td>메모리 릭 방지</td><td>캐시나 객체 풀에 남아있는 객체로 인한 메모리 누수 위험</td><td>TTL 설정, 정기적 캐시 정리, 최대 크기 제한 설정</td></tr><tr><td></td><td>상태 분리 최적화</td><td>Intrinsic/Extrinsic 상태의 과도한 일반화 또는 경계 불명확성</td><td>명확한 설계 경계 및 역할 단위 분리, 잘 정의된 인터페이스 구성</td></tr><tr><td></td><td>메모리 프로파일링</td><td>Flyweight 적용 전후 힙 사용량 및 객체 수 비교 분석</td><td>Java: JFR, VisualVM / Python: tracemalloc, memory_profiler</td></tr><tr><td><strong>성능 최적화</strong></td><td>팩토리 검색 성능</td><td>객체 검색 시 해시 충돌 등으로 인한 성능 저하 가능</td><td>고유 상태 기반 해시함수 사용, 충돌 최소화, 로드 팩터 조절</td></tr><tr><td></td><td>지연 초기화 (Lazy Init)</td><td>객체가 불필요하게 미리 생성되는 것을 방지</td><td>필요한 시점에만 객체 생성 (<code>lazy loading</code>)</td></tr><tr><td></td><td>배치 처리</td><td>대량 객체 생성 시 개별 처리보다 효율적</td><td>객체 예상 수요 기반 일괄 생성 또는 preloading 활용</td></tr><tr><td></td><td>직렬화/역직렬화 최적화</td><td>저장 또는 전송 시 공유 객체의 효율적 처리 필요</td><td>Intrinsic 상태만 직렬화, Extrinsic 은 클라이언트가 재조립</td></tr><tr><td></td><td>캐시 오버헤드</td><td>과도한 캐시 크기 또는 갱신 비용 발생</td><td>LRU, LFU, TTL 전략 기반 관리, 캐시 적중률 모니터링</td></tr><tr><td><strong>I/O 최적화</strong></td><td>네트워크 전송 효율성</td><td>분산 환경에서 전체 객체 대신 공유 상태만 전송해야 함</td><td>Extrinsic 상태는 로컬에서 생성, Intrinsic 만 전송</td></tr><tr><td><strong>동시성 최적화</strong></td><td>읽기 성능</td><td>읽기 전용 객체는 락 없이 사용 가능</td><td>불변 객체 설계, 락 프리 (lock-free) 구조 적용</td></tr><tr><td></td><td>팩토리의 동시성 처리</td><td>멀티스레드 환경에서 객체 중복 생성 또는 race condition 방지 필요</td><td>Double-checked locking, CAS(Compare-And-Swap) 사용</td></tr><tr><td></td><td>동기화 오버헤드</td><td>필요 이상의 락으로 인해 성능 저하 가능</td><td>Concurrent 자료구조 사용, 비동기 처리, 동기화 최소화</td></tr><tr><td><strong>확장성</strong></td><td>분산 환경에서 객체 공유 전략</td><td>객체 공유 범위가 넓을수록 네트워크 지연, 동기화 복잡성 증가</td><td>지역성 기반 캐싱 (Locality-based Caching), CDN 및 Edge 캐시 활용</td></tr><tr><td><strong>유지보수성</strong></td><td>코드 문서화</td><td>공유 상태 및 외부 상태 분리가 명확하지 않으면 유지보수 어려움</td><td>UML 다이어그램, 주석, 패턴 적용 이유 및 제약사항 문서화</td></tr><tr><td></td><td>추상화 수준</td><td>과도한 일반화로 인해 이해도 저하 및 복잡성 증가 가능</td><td>역할별 책임 분리, 너무 일반적인 Flyweight 는 피하고 유스케이스 기반 설계</td></tr><tr><td><strong>모니터링</strong></td><td>캐시 히트율 및 객체 수 추적</td><td>캐시 성능과 객체 재사용 효과 측정</td><td>샘플링 기반 모니터링 도구 적용 (e.g. Prometheus, Grafana, custom logs)</td></tr><tr><td><strong>변화 대응력</strong></td><td>요구사항 변화 및 확장성 대응 전략</td><td>초기 설계가 경직되면 유연한 확장/변경이 어려움</td><td>설정 기반 팩토리 설계, 플러그인 아키텍처 구조 고려, 동적 로딩 전략 적용</td></tr></tbody></table><ul><li><strong>공유 객체 수가 많아질수록 메모리 최적화와 동시성 제어의 균형</strong>이 중요</li><li><strong>팩토리 설계는 성능의 핵심</strong> → 캐시, 해시 함수, 동기화 전략을 정교하게 설계</li><li><strong>I/O 또는 네트워크 환경에서는 최소 데이터 전송</strong> → Intrinsic 만 공유</li><li><strong>모든 최적화는 사전/사후 측정 기반으로 이루어져야 함</strong> → 프로파일링과 모니터링 필수</li></ul><h3 id=주제와-관련하여-주목할-내용>주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#주제와-관련하여-주목할-내용>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>주제</strong></th><th><strong>항목</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>디자인 패턴</strong></td><td>Flyweight Pattern</td><td>구조적 패턴</td><td>객체의 공유를 통한 메모리 절약 및 성능 최적화를 목표로 하는 GoF 패턴</td></tr><tr><td></td><td>패턴 비교</td><td>Flyweight vs Object Pool</td><td>Flyweight 는 불변 객체 공유, Object Pool 은 상태가 있는 객체 재사용</td></tr><tr><td></td><td>연계 패턴</td><td>Singleton, Factory, Composite, Proxy</td><td>패턴 조합을 통해 생성, 구조화, 접근 제어를 강화</td></tr><tr><td></td><td>설계 원칙 적용</td><td>SRP, DRY</td><td>상태 분리와 관심사 분리를 통한 높은 응집도와 재사용성</td></tr><tr><td></td><td>상태 분리 설계</td><td>Intrinsic / Extrinsic</td><td>내부 불변 상태 vs 외부 클라이언트 상태 분리</td></tr><tr><td><strong>성능 최적화</strong></td><td>메모리 절약 전략</td><td>객체 재사용</td><td>중복 인스턴스를 제거하고 공유를 통해 메모리 사용량 최소화</td></tr><tr><td></td><td>캐시 전략</td><td>LRU, TTL, SoftReference</td><td>상태 공유 객체의 교체/수명 관리 전략</td></tr><tr><td></td><td>성능 분석 도구</td><td>VisualVM, Heap Dump, JProfiler</td><td>Flyweight 적용 전후의 메모리/성능 측정 도구</td></tr><tr><td><strong>객체지향 설계</strong></td><td>불변 객체</td><td>Immutable Object</td><td>상태 변경이 불가능한 객체로 스레드 안전성과 일관성 확보</td></tr><tr><td></td><td>객체 풀링</td><td>Object Pooling</td><td>자주 사용되는 상태 객체의 풀링을 통한 생성 비용 감소</td></tr><tr><td></td><td>Factory 관리</td><td>객체 생명 주기 통제</td><td>생성/캐시/제거를 일관성 있게 관리</td></tr><tr><td><strong>프로그래밍 기술</strong></td><td>동시성 제어</td><td>Thread Safety, Double-Checked Locking</td><td>멀티스레드 환경에서도 안전한 객체 공유 보장</td></tr><tr><td></td><td>약한 참조/GC 최적화</td><td>WeakReference, GC 관리</td><td>자동 메모리 수거로 Flyweight 객체의 수명 관리</td></tr><tr><td><strong>프레임워크/언어 적용</strong></td><td>언어별 사례</td><td>Java String Pool, Python Interned Object</td><td>언어 런타임 수준의 Flyweight 적용 사례</td></tr><tr><td></td><td>프레임워크 연계</td><td>Spring (Bean Scope), React.js (VDOM reuse)</td><td>Bean 공유, 컴포넌트 재사용을 통한 성능 최적화</td></tr><tr><td></td><td>캐시 도구</td><td>Redis, Memcached</td><td>분산 환경에서 객체 상태 캐시와 공유</td></tr><tr><td><strong>도메인별 적용 사례</strong></td><td>게임 개발</td><td>Unity 오브젝트 풀, 애니메이션 인스턴싱</td><td>대량의 반복 객체에 대한 재사용 최적화</td></tr><tr><td></td><td>웹 개발</td><td>HTTP Cache, CDN, Service Worker</td><td>리소스 캐싱 및 상태 공유 통한 성능 향상</td></tr><tr><td></td><td>데이터베이스 최적화</td><td>Connection Pooling, Query Cache</td><td>쿼리 결과 및 연결 공유로 I/O 성능 증대</td></tr><tr><td></td><td>그래픽스</td><td>Scene Graph, Texture Atlas, LOD</td><td>3D 데이터 중복 제거 및 레벨별 렌더링 최적화</td></tr><tr><td><strong>미래 기술 확장</strong></td><td>고급 메모리 기술</td><td>CXL, 3D Stack Memory</td><td>분산 메모리 환경에서도 Flyweight 적용 가능성 탐색</td></tr><tr><td></td><td>양자 컴퓨팅</td><td>상태 얽힘 공유 모델</td><td>양자 시스템에서의 상태 공유 개념으로 확장</td></tr><tr><td></td><td>블록체인</td><td>스마트 컨트랙트 최적화, IPFS</td><td>상태 공유를 통한 가스비 절감 및 중복 저장 제거</td></tr><tr><td></td><td>보안 기술</td><td>Zero Trust, 동형 암호화</td><td>암호화된 상태에서의 데이터 공유 및 접근 제어 최적화</td></tr></tbody></table><h3 id=반드시-학습해야할-내용>반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#반드시-학습해야할-내용>#</a></h3><table><thead><tr><th><strong>카테고리</strong></th><th><strong>주제</strong></th><th><strong>하위 항목 / 키워드</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>디자인 패턴</strong></td><td>Flyweight Pattern</td><td>Structural Pattern, 상태 분리, 객체 공유</td><td>GoF 구조적 패턴 중 하나로, 객체의 메모리 사용을 줄이기 위한 공유 설계 방식</td></tr><tr><td></td><td>관련 디자인 패턴</td><td>Singleton, Factory Method, Proxy, Object Pool</td><td>생성, 접근, 재사용 관점에서 연관되는 주요 패턴들</td></tr><tr><td></td><td>패턴 비교 학습</td><td>Singleton vs Flyweight, Prototype vs Flyweight</td><td>인스턴스 수, 재사용 방식, 상태 관리 방식의 차이 비교</td></tr><tr><td><strong>객체지향 설계</strong></td><td>상태 분리 설계 원리</td><td>Intrinsic/Extrinsic State</td><td>객체 내부/외부 상태의 분리와 설계 전략</td></tr><tr><td></td><td>SOLID 원칙</td><td>SRP, OCP</td><td>객체 재사용과 유지보수성을 높이기 위한 설계 원칙</td></tr><tr><td><strong>메모리 최적화</strong></td><td>메모리 관리 전략</td><td>GC, Soft/Weak Reference, Memory Pool</td><td>객체 수명 주기 및 재사용을 통한 메모리 절감 전략</td></tr><tr><td></td><td>캐시 전략</td><td>LRU, TTL, Hash Consing</td><td>공유 객체 또는 리소스의 수명/교체/재사용을 위한 전략</td></tr><tr><td></td><td>성능 지표</td><td>Memory Footprint, Cache Hit Ratio</td><td>성능 측정을 위한 주요 지표 정의</td></tr><tr><td><strong>동시성 프로그래밍</strong></td><td>Thread Safety</td><td>불변 객체 설계, 락, Double-Checked Locking</td><td>멀티스레드 환경에서 안전한 공유 객체 생성 및 접근</td></tr><tr><td></td><td>Lock-Free Techniques</td><td>무잠금 프로그래밍</td><td>병렬 환경에서 동기화 오버헤드 최소화</td></tr><tr><td></td><td>Concurrent Collections</td><td>Java ConcurrentHashMap 등</td><td>안전한 공유 객체 풀 관리</td></tr><tr><td><strong>성능 분석 및 최적화</strong></td><td>프로파일링 & 모니터링 도구</td><td>VisualVM, JProfiler, Memory Analyzer</td><td>메모리 사용 분석 및 최적화 도구 활용</td></tr><tr><td></td><td>메모리 정렬 및 접근 최적화</td><td>Cache Locality, Memory Alignment</td><td>CPU 성능 친화적인 메모리 레이아웃 설계</td></tr><tr><td><strong>프레임워크 & 언어</strong></td><td>언어별 구현 특성</td><td>Java, C++, Python</td><td>언어별 Flyweight 패턴 구현 방식 및 차이</td></tr><tr><td></td><td>프레임워크 사례</td><td>Spring,.NET</td><td>DI, AOP, Bean Pool 등과의 연계</td></tr><tr><td></td><td>도구 및 라이브러리</td><td>Guava Cache, Caffeine, Spring Cache</td><td>실무에서 객체 공유/재사용을 위한 도구</td></tr><tr><td><strong>실무 적용 분야</strong></td><td>컴퓨터 그래픽스</td><td>Scene Graph, Texture Atlas, LOD</td><td>중복 모델/리소스를 GPU 메모리 효율적으로 관리</td></tr><tr><td></td><td>게임 개발</td><td>Asset Streaming, Animation Instancing</td><td>리소스 동적 로딩 및 애니메이션 재사용 최적화</td></tr><tr><td></td><td>웹 개발</td><td>CDN, Service Workers, HTTP Cache</td><td>정적 리소스 및 오프라인 캐싱의 재사용 전략</td></tr><tr><td></td><td>데이터베이스</td><td>Query Result Cache, Connection Pool, Materialized View</td><td>결과셋 재사용과 연결 풀 관리로 성능 향상</td></tr><tr><td></td><td>분산 시스템</td><td>Distributed Caching (Redis 등), Load Balancing</td><td>마이크로서비스 간 공유 객체, 세션, 캐시 관리</td></tr><tr><td><strong>이론/기초 개념</strong></td><td>구조적 디자인 패턴 군 이해</td><td>Composite, Proxy, Decorator</td><td>Flyweight 와 함께 쓰이는 구조 중심의 패턴군 분석</td></tr><tr><td></td><td>자료구조/알고리즘 기반</td><td>Hash Table, Map, Trie</td><td>빠른 공유 객체 탐색/관리를 위한 자료구조</td></tr><tr><td></td><td>대규모 객체 설계 전략</td><td>Object Grouping, Shallow Copy, Factory Pool</td><td>대량 객체 관리를 위한 설계 기법</td></tr><tr><td><strong>아키텍처 적용</strong></td><td>Microservices Architecture</td><td>Shared Data Optimization, Stateless Proxy</td><td>Flyweight 원리를 마이크로서비스에 적용한 분산 설계 사례</td></tr><tr><td></td><td>코드 품질 및 검토</td><td>Code Review, Pattern Validation</td><td>Flyweight 적용의 적절성, 유지보수성, 성능 영향 분석</td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th><strong>카테고리</strong></th><th><strong>용어</strong></th><th><strong>설명</strong></th></tr></thead><tbody><tr><td><strong>디자인 패턴 개념</strong></td><td>Flyweight Pattern</td><td>객체의 내부 상태를 공유하여 메모리 사용을 최소화하는 구조적 디자인 패턴</td></tr><tr><td></td><td>Flyweight</td><td>공유 가능한 객체를 나타내는 추상 개념</td></tr><tr><td></td><td>Concrete Flyweight</td><td>공유 가능한 객체의 실제 구현체, 내부 상태 (intrinsic) 를 포함</td></tr><tr><td></td><td>Unshared Concrete Flyweight</td><td>공유되지 않는 객체, 개별 생성되어야 하는 예외적인 케이스</td></tr><tr><td></td><td>Flyweight Factory</td><td>Flyweight 객체를 생성하고 캐싱하는 팩토리 역할 수행</td></tr><tr><td></td><td>Context</td><td>Flyweight 와 외부 상태를 결합해 완전한 의미를 가지는 객체</td></tr><tr><td><strong>상태 관리</strong></td><td>Intrinsic State</td><td>공유 가능한 불변 내부 상태, 객체 간 공통</td></tr><tr><td></td><td>Extrinsic State</td><td>외부에서 주입되는 개별 상태, 공유되지 않으며 컨텍스트 의존적</td></tr><tr><td></td><td>Immutable Object</td><td>변경 불가능한 객체, Flyweight 의 상태 공유 특성과 연관</td></tr><tr><td><strong>메모리 최적화 기법</strong></td><td>Object Pool</td><td>상태 있는 객체의 재사용을 위해 미리 생성해두는 저장소</td></tr><tr><td></td><td>Hash Consing</td><td>동일 값의 객체를 하나로 공유하여 중복 제거</td></tr><tr><td></td><td>Lazy Initialization</td><td>실제로 필요할 때까지 객체 생성을 지연시키는 기법</td></tr><tr><td></td><td>Memory Footprint</td><td>프로그램이 사용하는 전체 메모리 용량</td></tr><tr><td></td><td>Cache Locality</td><td>메모리 접근 지역성 원리를 활용한 성능 최적화 기법</td></tr><tr><td><strong>캐싱 및 참조 관리</strong></td><td>LRU (Least Recently Used)</td><td>가장 오래된 캐시 항목부터 제거하는 정책</td></tr><tr><td></td><td>TTL (Time To Live)</td><td>일정 시간이 지나면 캐시 항목을 제거하는 기한</td></tr><tr><td></td><td>Cache Hit Ratio</td><td>요청 중 캐시로부터 처리된 비율</td></tr><tr><td></td><td>Soft Reference</td><td>메모리 부족 시 가비지 컬렉션 대상이 되는 약한 참조</td></tr><tr><td></td><td>Weak Reference</td><td>객체가 다른 강한 참조가 없으면 GC 에 의해 수거될 수 있는 참조 방식</td></tr><tr><td><strong>병렬성/싱글톤 관련</strong></td><td>Double-Checked Locking</td><td>멀티스레드 환경에서 안전하고 효율적인 싱글톤 생성 기법</td></tr><tr><td><strong>GC 및 런타임</strong></td><td>Garbage Collection</td><td>사용하지 않는 객체를 자동으로 메모리에서 해제하는 메커니즘</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><h3 id=공식-및-이론-중심-자료>공식 및 이론 중심 자료<a hidden class=anchor aria-hidden=true href=#공식-및-이론-중심-자료>#</a></h3><ul><li><a href=https://refactoring.guru/design-patterns/flyweight>Flyweight Pattern - Refactoring Guru</a></li><li><a href=https://www.geeksforgeeks.org/flyweight-design-pattern/>Flyweight Design Pattern - GeeksforGeeks</a></li><li><a href=https://en.wikipedia.org/wiki/Flyweight_pattern>Flyweight Pattern - Wikipedia</a></li><li><a href=https://www.tutorialspoint.com/design_pattern/flyweight_pattern.htm>Flyweight Design Pattern - TutorialsPoint</a></li><li><a href=https://howtodoinjava.com/design-patterns/structural/flyweight-design-pattern/>Flyweight Design Pattern - HowToDoInJava</a></li><li><a href=https://java-design-patterns.com/patterns/flyweight/>Flyweight Pattern (Java Design Patterns)</a></li></ul><h3 id=실무-사례-및-블로그-기반-자료>실무 사례 및 블로그 기반 자료<a hidden class=anchor aria-hidden=true href=#실무-사례-및-블로그-기반-자료>#</a></h3><ul><li><a href=https://www.baeldung.com/java-flyweight>Flyweight Pattern in Java - Baeldung</a></li><li><a href=https://stackabuse.com/flyweight-design-pattern-in-python/>Stack Abuse - Flyweight Pattern in Python</a></li><li><a href=https://python101.tistory.com/entry/%EB%94%94%EC%9E%90%EC%9D%B8-%ED%8C%A8%ED%84%B4-%ED%94%8C%EB%9D%BC%EC%9D%B4%EC%9B%A8%EC%9D%B4%ED%8A%B8-%ED%8C%A8%ED%84%B4-Flyweight-Pattern-python-%EC%98%88%EC%A0%9C-%EC%BD%94%EB%93%9C>Python101 - 플라이웨이트 패턴 파이썬 예제</a></li><li><a href=https://velog.io/@sihkang/%EB%94%94%EC%9E%90%EC%9D%B8-%ED%8C%A8%ED%84%B4-%ED%94%8C%EB%9D%BC%EC%9D%B4%EC%9B%A8%EC%9D%B4%ED%8A%B8>velog - 플라이웨이트(경량) 패턴</a></li><li><a href=https://inpa.tistory.com/entry/GOF-%F0%9F%92%A0-Flyweight-%ED%8C%A8%ED%84%B4-%EC%A0%9C%EB%8C%80%EB%A1%9C-%EB%B0%B0%EC%9B%8C%EB%B3%B4%EC%9E%90>Inpa Dev - 플라이웨이트 패턴 완벽 마스터하기</a></li></ul><hr></div></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>