<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Data-Flow Architecture | hyunyoun's Blog</title><meta name=keywords content="Software-Engineering,Design-and-Architecture,Architecture-Styles,Data-Flow-Architecture,Pipe-and-Filer"><meta name=description content="Data-Flow Architecture 는 데이터를 일련의 독립적인 변환 모듈을 통해 순차적으로 처리하는 소프트웨어 아키텍처 스타일이다. 입력 데이터가 각 구성요소를 거치면서 점진적으로 변환되어 최종 출력에 도달하는 구조를 갖는다. 재사용성과 모듈성을 극대화하며 컴파일러, ETL 시스템, 스트림 처리 등에 활용된다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/software-design-and-architecture/architecture/data-architecture/data-flow-architecture/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.a9863521b3bd3c240bc506f46b95e3c06ccef2ae37f529d5f99bdaef442bccce.css integrity="sha256-qYY1IbO9PCQLxQb0a5XjwGzO8q439SnV+Zva70QrzM4=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/software-design-and-architecture/architecture/data-architecture/data-flow-architecture/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/software-design-and-architecture/architecture/data-architecture/data-flow-architecture/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/software-design-and-architecture/architecture/data-architecture/data-flow-architecture/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Data-Flow Architecture"><meta property="og:description" content="Data-Flow Architecture 는 데이터를 일련의 독립적인 변환 모듈을 통해 순차적으로 처리하는 소프트웨어 아키텍처 스타일이다. 입력 데이터가 각 구성요소를 거치면서 점진적으로 변환되어 최종 출력에 도달하는 구조를 갖는다. 재사용성과 모듈성을 극대화하며 컴파일러, ETL 시스템, 스트림 처리 등에 활용된다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Data-Flow Architecture"><meta name=twitter:description content="Data-Flow Architecture 는 데이터를 일련의 독립적인 변환 모듈을 통해 순차적으로 처리하는 소프트웨어 아키텍처 스타일이다. 입력 데이터가 각 구성요소를 거치면서 점진적으로 변환되어 최종 출력에 도달하는 구조를 갖는다. 재사용성과 모듈성을 극대화하며 컴파일러, ETL 시스템, 스트림 처리 등에 활용된다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Computer Science and Engineering","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Design and Architecture","item":""},{"@type":"ListItem","position":3,"name":"Architecture","item":"https://buenhyden.github.io/posts/software-design-and-architecture/architecture/"},{"@type":"ListItem","position":4,"name":"Data-Flow Architecture","item":"https://buenhyden.github.io/posts/software-design-and-architecture/architecture/data-architecture/data-flow-architecture/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>Computer Science and Engineering</a>&nbsp;»&nbsp;<a href>Design and Architecture</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/software-design-and-architecture/architecture/>Architecture</a></div><h1>Data-Flow Architecture</h1><div class=post-description>Data-Flow Architecture 는 데이터를 일련의 독립적인 변환 모듈을 통해 순차적으로 처리하는 소프트웨어 아키텍처 스타일이다. 입력 데이터가 각 구성요소를 거치면서 점진적으로 변환되어 최종 출력에 도달하는 구조를 갖는다. 재사용성과 모듈성을 극대화하며 컴파일러, ETL 시스템, 스트림 처리 등에 활용된다.</div></header><div class=post-content><h2 id=data-flow-architecture>Data-Flow Architecture<a hidden class=anchor aria-hidden=true href=#data-flow-architecture>#</a></h2><p>Data-Flow Architecture 는 소프트웨어 시스템을 데이터 변환의 연속으로 모델링하는 아키텍처 패턴이다. Batch Sequential, Pipe-and-Filter, Process Control 의 세 가지 주요 유형으로 분류되며, 각각 다른 실행 방식과 적용 영역을 갖는다. 이 아키텍처는 높은 모듈성, 재사용성, 병렬처리 가능성을 제공하지만 동적 상호작용과 상태 공유에 제약이 있다. 현대의 빅데이터 처리, 실시간 스트림 분석, 마이크로서비스 아키텍처에서 핵심적인 역할을 담당한다.</p><h3 id=배경>배경<a hidden class=anchor aria-hidden=true href=#배경>#</a></h3><ul><li><strong>역사적 맥락</strong>: 1970 년대, 전통적 von Neumann 방식의 한계를 극복하고 <strong>병렬성 (parallelism)</strong> 과 <strong>데이터 주도 실행 (data-driven execution)</strong> 을 강조한 Data‑Flow 구조가 하드웨어 및 소프트웨어 양쪽에서 연구됨.</li><li><strong>이론적 기반</strong>: 태그된 토큰 (tagged-token) 과 정적인 데이터 흐름 그래프 (static dataflow graph) 를 이용한 동적 데이터 흐름 모델이 적용됨.</li></ul><h3 id=목적-및-필요성>목적 및 필요성<a hidden class=anchor aria-hidden=true href=#목적-및-필요성>#</a></h3><ul><li><strong>모듈성 향상</strong>: 각 변환 단계를 독립적인 모듈로 분리하여 재사용성 극대화</li><li><strong>확장성 제공</strong>: 새로운 필터 추가나 기존 필터 수정 시 다른 구성요소에 최소한의 영향</li><li><strong>병렬 처리 지원</strong>: 독립적인 필터들의 동시 실행으로 성능 향상</li><li><strong>유지보수성 개선</strong>: 각 단계별 독립적인 테스트와 디버깅 가능</li></ul><h3 id=핵심-개념>핵심 개념<a hidden class=anchor aria-hidden=true href=#핵심-개념>#</a></h3><p><strong>Data-Flow Architecture</strong>는 시스템을 데이터의 흐름 중심으로 구성하며, 각 연산 단위를 모듈화하여 독립적으로 실행하고 연결하는 구조이다.<br>주요 구현 방식에는 <code>Batch Sequential</code>, <code>Pipe-and-Filter</code>, <code>Process Control</code> 이 있으며, <strong>데이터 파이프라인</strong>, <strong>스트리밍 처리</strong>, <strong>IoT</strong>, <strong>ETL</strong> 시스템 등 실무 전반에 널리 활용된다.</p><h4 id=기본-개념>기본 개념<a hidden class=anchor aria-hidden=true href=#기본-개념>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>데이터 중심 구동</strong></td><td>연산 순서가 고정되지 않고, <strong>데이터의 도착</strong>에 따라 실행 흐름이 결정됨</td></tr><tr><td><strong>Pipe-and-Filter 패턴</strong></td><td><strong>데이터 처리 필터</strong>들이 파이프를 통해 연결되어 흐름을 구성</td></tr><tr><td><strong>Batch Sequential</strong></td><td><strong>순차적인 배치 처리</strong> 기반 구성: 이전 모듈이 끝나야 다음 단계 실행</td></tr><tr><td><strong>Process Control</strong></td><td><strong>제어 로직 분리</strong> 및 제어 루프 구성 (제어 유닛 ↔ 처리 유닛 분리)</td></tr><tr><td><strong>모듈 병렬성</strong></td><td>각 필터 (모듈) 는 <strong>독립적이고 병렬적으로 실행</strong> 가능</td></tr></tbody></table><h4 id=이론적-관점>이론적 관점<a hidden class=anchor aria-hidden=true href=#이론적-관점>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>데이터 중심 설계</strong></td><td>시스템 주요 설계 단위가 기능보다 데이터 흐름에 집중됨</td></tr><tr><td><strong>컴포넌트 독립성</strong></td><td>각 필터는 <strong>입력 → 처리 → 출력</strong>의 독립적 실행 단위를 형성</td></tr><tr><td><strong>비동기 처리 지원</strong></td><td>각 컴포넌트는 <strong>이벤트/데이터 도착 즉시 처리</strong>, 전체 시스템은 <strong>비동기적</strong>으로 작동</td></tr></tbody></table><h4 id=실무적-관점>실무적 관점<a hidden class=anchor aria-hidden=true href=#실무적-관점>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>확장성</strong></td><td>필터 단위로 구성되어, <strong>새로운 처리 로직 추가/교체가 쉬움</strong></td></tr><tr><td><strong>재사용성</strong></td><td>각 필터는 독립적으로 개발 및 테스트 가능</td></tr><tr><td><strong>분산 처리</strong></td><td>필터 단위로 <strong>멀티노드에 분산</strong> 배치 가능</td></tr><tr><td><strong>스트리밍 적합성</strong></td><td>실시간 분석 및 <strong>데이터 스트리밍 환경에 최적화</strong>됨</td></tr></tbody></table><h4 id=아키텍처-유형별-상세-특징>아키텍처 유형별 상세 특징<a hidden class=anchor aria-hidden=true href=#아키텍처-유형별-상세-특징>#</a></h4><p><strong>Batch Sequential</strong></p><table><thead><tr><th>요소</th><th>설명</th></tr></thead><tbody><tr><td>배치 처리</td><td>데이터를 일정 단위로 묶어 <strong>순차적으로 처리</strong></td></tr><tr><td>순차 실행</td><td><strong>완료 → 다음 단계</strong> 방식의 <strong>단방향 흐름</strong></td></tr></tbody></table><p><strong>Pipe-and-Filter</strong></p><table><thead><tr><th>요소</th><th>설명</th></tr></thead><tbody><tr><td>파이프</td><td>데이터 이동 경로 역할 (필터 간 연결)</td></tr><tr><td>필터</td><td>입력 → 처리 → 출력 수행하는 모듈</td></tr><tr><td>스트림 처리</td><td>데이터 스트림이 <strong>필터 체인</strong>을 통해 실시간 처리됨</td></tr></tbody></table><p><strong>Process Control</strong></p><table><thead><tr><th>요소</th><th>설명</th></tr></thead><tbody><tr><td>제어 변수</td><td>시스템 상태를 제어하는 파라미터</td></tr><tr><td>피드백 루프</td><td><strong>출력이 다시 입력에 영향을 미치는</strong> 순환 구조 (제어 시스템에서 자주 사용됨)</td></tr></tbody></table><h4 id=실무-구현-연관성-및-적용-기술>실무 구현 연관성 및 적용 기술<a hidden class=anchor aria-hidden=true href=#실무-구현-연관성-및-적용-기술>#</a></h4><table><thead><tr><th>영역</th><th>설명</th></tr></thead><tbody><tr><td><strong>ETL/ELT 파이프라인</strong></td><td>Pipe-and-Filter 패턴 기반으로 모듈화된 데이터 전처리 구성</td></tr><tr><td><strong>Kafka / Flink / Spark Streaming</strong></td><td>Stream Processing 기반의 <strong>실시간 파이프라인 처리 구조</strong></td></tr><tr><td><strong>IoT 제어 시스템</strong></td><td>Process Control 패턴 활용하여 센서 제어/모니터링 구성</td></tr><tr><td><strong>데이터 파이프라인 일반</strong></td><td>데이터 중심 흐름을 설계하여 <strong>확장성과 유지보수 용이성 확보</strong></td></tr></tbody></table><h4 id=성능-및-운영-관점의-주요-개념>성능 및 운영 관점의 주요 개념<a hidden class=anchor aria-hidden=true href=#성능-및-운영-관점의-주요-개념>#</a></h4><table><thead><tr><th>항목</th><th>설명</th></tr></thead><tbody><tr><td><strong>병렬 처리</strong></td><td>여러 필터가 동시에 작동하여 <strong>처리량 (throughput) 향상</strong></td></tr><tr><td><strong>파이프라이닝</strong></td><td>각 필터가 <strong>동시다발적으로 다른 데이터 세트</strong>를 처리</td></tr><tr><td><strong>백프레셔 (Backpressure)</strong></td><td>데이터 처리 속도 차이로 인한 압력 조정 메커니즘</td></tr><tr><td><strong>오류 격리</strong></td><td>각 필터에서 발생한 오류는 독립적으로 처리 가능</td></tr><tr><td><strong>데이터 형식 표준화</strong></td><td>필터 간 데이터 교환을 위한 <strong>공통 포맷 유지</strong> 필요</td></tr><tr><td><strong>상태 관리</strong></td><td>Stateless 설계 권장되며, 필요 시 상태 공유 전략 설계 필요</td></tr></tbody></table><h3 id=주요-기능-및-역할>주요 기능 및 역할<a hidden class=anchor aria-hidden=true href=#주요-기능-및-역할>#</a></h3><pre class=mermaid>graph LR
    A[입력 데이터] --&gt; B[변환 모듈 1]
    B --&gt; C[변환 모듈 2]
    C --&gt; D[변환 모듈 3]
    D --&gt; E[출력 데이터]
    
    F[제어 정보] --&gt; B
    F --&gt; C
    F --&gt; D
</pre><p><strong>주요 기능:</strong></p><ul><li>데이터 추출 및 수집</li><li>데이터 변환 및 정제</li><li>데이터 전송 및 라우팅</li><li>오류 검출 및 복구</li><li>성능 모니터링</li></ul><h3 id=특징>특징<a hidden class=anchor aria-hidden=true href=#특징>#</a></h3><table><thead><tr><th>특징</th><th>설명</th></tr></thead><tbody><tr><td>데이터 중심성</td><td>데이터의 흐름이 시스템 구조를 결정</td></tr><tr><td>독립성</td><td>각 처리 단계가 독립적으로 동작</td></tr><tr><td>변환 지향</td><td>데이터의 점진적 변환에 중점</td></tr><tr><td>재사용성</td><td>필터의 다양한 조합으로 재사용 가능</td></tr><tr><td>확장성</td><td>필터 추가/제거를 통한 유연한 확장</td></tr></tbody></table><h3 id=핵심-원칙>핵심 원칙<a hidden class=anchor aria-hidden=true href=#핵심-원칙>#</a></h3><ol><li><strong>단일 책임 원칙</strong>: 각 필터는 하나의 명확한 기능만 수행</li><li><strong>데이터 무결성</strong>: 각 단계에서 데이터의 정확성과 일관성 유지</li><li><strong>느슨한 결합</strong>: 필터 간 최소한의 의존성 유지</li><li><strong>표준화된 인터페이스</strong>: 모든 필터가 동일한 입출력 형식 사용</li><li><strong>오류 격리</strong>: 한 필터의 오류가 다른 필터에 전파되지 않도록 격리</li></ol><h3 id=주요-원리>주요 원리<a hidden class=anchor aria-hidden=true href=#주요-원리>#</a></h3><ul><li><strong>Pipe-and-Filter</strong>: 입력이 연속적으로 필터를 통과하며 처리됨.</li><li><strong>Batch Sequential</strong>: 일괄 순차 처리 방식.</li><li><strong>Process Control</strong>: 제어 유닛 분리, 실시간 제어 시스템에 적합.</li><li><strong>Stream Processing</strong>: 도착한 데이터를 바로 처리하는 방식.</li><li><strong>Idempotency</strong>: 필터 간 반복 실행에도 일관성을 보장해야 함.</li></ul><pre class=mermaid>flowchart TD
    subgraph &#34;Batch Sequential&#34;
        A1[배치 1] --&gt; B1[처리 모듈 1]
        B1 --&gt; C1[완료]
        C1 --&gt; A2[배치 2]
        A2 --&gt; B2[처리 모듈 2]
        B2 --&gt; C2[완료]
    end
    
    subgraph &#34;Pipe and Filter&#34;
        D1[데이터 스트림] --&gt; E1[필터 1]
        E1 --&gt; F1[파이프 1]
        F1 --&gt; E2[필터 2]
        E2 --&gt; F2[파이프 2]
        F2 --&gt; E3[필터 3]
        E3 --&gt; G1[출력 스트림]
    end
    
    subgraph &#34;Process Control&#34;
        H1[제어 변수] --&gt; I1[컨트롤러]
        I1 --&gt; J1[처리 유닛]
        J1 --&gt; K1[피드백]
        K1 --&gt; I1
    end
</pre><p><strong>Batch Sequential 방식:</strong></p><ol><li>전체 데이터를 배치 단위로 분할</li><li>각 배치를 순차적으로 처리 모듈에 전달</li><li>이전 배치 처리 완료 후 다음 배치 시작</li><li>모든 배치 처리 완료 후 결과 통합</li></ol><p><strong>Pipe-and-Filter 방식:</strong></p><ol><li>데이터 스트림이 첫 번째 필터로 전달</li><li>각 필터가 데이터를 변환하여 파이프로 출력</li><li>파이프가 데이터를 다음 필터로 전송</li><li>모든 필터 처리 완료 후 최종 결과 생성</li></ol><p><strong>Process Control 방식:</strong></p><ol><li>제어 변수가 시스템 상태를 모니터링</li><li>컨트롤러가 현재 상태와 목표 상태 비교</li><li>처리 유닛이 필요한 조정 작업 수행</li><li>피드백을 통해 결과를 컨트롤러로 전달</li></ol><h3 id=작동-원리-및-주요-원리>작동 원리 및 주요 원리<a hidden class=anchor aria-hidden=true href=#작동-원리-및-주요-원리>#</a></h3><pre class=mermaid>flowchart LR
    A[&#34;데이터 소스 (Pump)&#34;]
    subgraph Pipeline
      F1[Filter 1] --&gt; F2[Filter 2] --&gt; F3[Filter 3]
    end
    A --&gt; Pipeline --&gt; B(데이터 싱크)
</pre><ul><li><strong>Pipe</strong>: 필터 간 데이터 전송용 버퍼 채널.</li><li><strong>Filter</strong>: 변환 수행, 무상태 (stateless) 또는 상태 공유 가능.</li><li><strong>Pump & Sink</strong>: 데이터를 생성하고 소비하는 입출력 엔티티.</li><li><strong>Token 기반 실행</strong>: 각 필터는 입력 토큰이 도착해야 활성화됨.</li><li><strong>병렬 실행</strong>: 필터 인스턴스를 병렬로 확장 가능.</li></ul><h3 id=구조-및-아키텍처>구조 및 아키텍처<a hidden class=anchor aria-hidden=true href=#구조-및-아키텍처>#</a></h3><p>Data-Flow Architecture 의 전체 구조:</p><pre class=mermaid>graph TB
    subgraph &#34;Data Flow Architecture&#34;
        subgraph &#34;입력 계층&#34;
            A[데이터 소스 1]
            B[데이터 소스 2]
            C[데이터 소스 N]
        end
        
        subgraph &#34;처리 계층&#34;
            D[추출 필터]
            E[변환 필터]
            F[정제 필터]
            G[집계 필터]
        end
        
        subgraph &#34;전송 계층&#34;
            H[파이프 1]
            I[파이프 2]
            J[파이프 3]
        end
        
        subgraph &#34;출력 계층&#34;
            K[데이터 웨어하우스]
            L[데이터 레이크]
            M[실시간 대시보드]
        end
        
        A --&gt; D
        B --&gt; D
        C --&gt; D
        
        D --&gt; H
        H --&gt; E
        E --&gt; I
        I --&gt; F
        F --&gt; J
        J --&gt; G
        
        G --&gt; K
        G --&gt; L
        G --&gt; M
    end
</pre><h4 id=구성-요소>구성 요소<a hidden class=anchor aria-hidden=true href=#구성-요소>#</a></h4><table><thead><tr><th>구분</th><th>구성요소</th><th>기능</th><th>역할</th><th>특징</th></tr></thead><tbody><tr><td>필수</td><td><strong>데이터 소스 (Data Source)</strong></td><td>데이터 생성 및 제공</td><td>시스템의 입력점 역할</td><td>다양한 형태의 데이터 지원</td></tr><tr><td></td><td><strong>필터 (Filter)</strong></td><td>데이터 처리 및 변환</td><td>핵심 비즈니스 로직 수행</td><td>독립적이고 재사용 가능</td></tr><tr><td></td><td><strong>파이프 (Pipe)</strong></td><td>데이터 전송</td><td>필터 간 데이터 연결</td><td>버퍼링 및 동기화 제공</td></tr><tr><td></td><td><strong>데이터 싱크 (Data Sink)</strong></td><td>최종 결과 저장</td><td>시스템의 출력점 역할</td><td>다양한 저장 형식 지원</td></tr><tr><td>선택</td><td><strong>모니터링 시스템</strong></td><td>성능 및 상태 감시</td><td>시스템 안정성 보장</td><td>실시간 알림 및 로깅</td></tr><tr><td></td><td><strong>오류 처리기</strong></td><td>예외 상황 처리</td><td>시스템 복원력 향상</td><td>자동 복구 및 재시도</td></tr><tr><td></td><td><strong>캐시 시스템</strong></td><td>임시 데이터 저장</td><td>성능 최적화</td><td>빠른 데이터 접근</td></tr><tr><td></td><td><strong>스케줄러</strong></td><td>배치 작업 관리</td><td>자동화된 실행 제어</td><td>시간 기반 트리거</td></tr></tbody></table><h3 id=구현-기법>구현 기법<a hidden class=anchor aria-hidden=true href=#구현-기법>#</a></h3><table><thead><tr><th> 카테고리 </th><th> 구현 기법 </th><th> 핵심 개념 / 정의 </th><th> 주요 도구·기술 </th><th> 주요 목적 </th><th> 대표 실전 사례 </th><th> 장·단점 요약 </th></tr></thead><tbody><tr><td><strong>처리 모델 (Processing Models)</strong></td><td><strong>Batch Processing</strong></td><td>일정 주기마다 대량 데이터를 일괄 처리</td><td>Apache Spark, Hadoop, Airflow</td><td>대용량 ETL·집계</td><td>자정 전날 트랜잭션 ETL</td><td>✔ 대량·복잡 계산 최적<br>✘ 지연 (latency) 큼</td></tr><tr><td></td><td><strong>Stream Processing</strong></td><td>데이터 도착 즉시 실시간 처리</td><td>Kafka/Flink, Kinesis, Spark Structured Streaming</td><td>실시간 분석·경보</td><td>IoT 센서 실시간 집계</td><td>✔ 저지연·즉각 대응<br>✘ 처리 순서·정확도 관리 필요</td></tr><tr><td></td><td><strong>Micro‑Batch (Spark Streaming 등)</strong></td><td>수초 단위 미니 배치로 실시간성↑·모델 단순화</td><td>Spark, Storm Trident</td><td>near‑real‑time ETL</td><td>실시간 IoT 로그 정제</td><td>✔ 모델·코드 재사용 ↑<br>✘ 완전 실시간 대비 약간 지연</td></tr><tr><td><strong>하이브리드 아키텍처</strong></td><td><strong>Lambda Architecture</strong></td><td>Batch + Speed Layer 이중 파이프라인</td><td>Hadoop (Spark) + Flink/Kafka</td><td>정확성 + 즉시성</td><td>추천 엔진 재계산</td><td>✔ 정밀·실시간 균형<br>✘ 이중 코드, 운용 복잡</td></tr><tr><td></td><td><strong>Kappa Architecture</strong></td><td>스트림 단일 레이어로 재처리까지 해결</td><td>Kafka + Flink</td><td>단순성·재처리 용이</td><td>실시간 로그 플랫폼</td><td>✔ 단일 코드 기반<br>✘ 과거 데이터 재처리 비용 ↑</td></tr><tr><td><strong>오케스트레이션 & 워크플로</strong></td><td><strong>Workflow Orchestration</strong></td><td>DAG 기반 작업 순서·의존성·재시도 관리</td><td>Airflow, Dagster, NiFi, AWS Step Functions</td><td>파이프라인 자동화·운영</td><td>종속성 많은 ETL DAG</td><td>✔ 리트라이·모니터링 내장<br>✘ 운용 메타스토어 필요</td></tr><tr><td><strong>실행 모델 (Execution Models)</strong></td><td><strong>Token‑Based / Data‑Driven</strong></td><td>토큰 (데이터) 도착이 연산 트리거 → 자연 병렬</td><td>TStreams, StreamC, Google Dataflow SDK</td><td>코어 병렬 알고리즘·DSP</td><td>FPGA/DSP 데이터플로 컴파일</td><td>✔ 최대 병렬도<br>✘ 디버깅 난이도</td></tr><tr><td></td><td><strong>Process Control</strong></td><td>제어 루프·피드백 기반 데이터‑제어 분리</td><td>PLC, SCADA, ROS2</td><td>IoT·산업 제어</td><td>공정 자동화, 로봇 제어</td><td>✔ 실시간 안전제어<br>✘ 하드 RT 보장 필요</td></tr><tr><td><strong>인프라 & 통신</strong></td><td><strong>Event‑Driven Microservices</strong></td><td>각 단계 독립 서비스 + 메시지 브로커</td><td>gRPC/REST + Kafka, NATS</td><td>독립 배포·스케일</td><td>주문/결제 이벤트 파이프라인</td><td>✔ 팀 단위 자율성 ↑<br>✘ 관측성·계약 관리 필수</td></tr><tr><td><strong>운영 보조 기술</strong></td><td><strong>Backpressure & Flow‑Control</strong></td><td>필터 간 속도 차를 제어해 버퍼 폭주 방지</td><td>Reactive Streams, Flink Watermarks</td><td>시스템 안정성</td><td>대용량 로그 스트림</td><td>✔ 메모리 보호<br>✘ 조정 파라미터 복잡</td></tr><tr><td></td><td><strong>State Management</strong></td><td>무상태 권장, 필요 시 외부 상태 저장소</td><td>RocksDB, Redis, Flink State</td><td>정확한 계산/재시작</td><td>세션 윈도 집계</td><td>✔ 정확도 ↑<br>✘ 상태 크기·복제 비용</td></tr></tbody></table><h4 id=batch-processing-apache-spark-활용>Batch Processing (Apache Spark 활용)<a hidden class=anchor aria-hidden=true href=#batch-processing-apache-spark-활용>#</a></h4><p><strong>예시:</strong> PySpark 를 활용한 일괄 ETL 처리</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2>2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3>3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4>4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5>5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6>6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7>7</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pyspark.sql</span> <span class=kn>import</span> <span class=n>SparkSession</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>spark</span> <span class=o>=</span> <span class=n>SparkSession</span><span class=o>.</span><span class=n>builder</span><span class=o>.</span><span class=n>appName</span><span class=p>(</span><span class=s2>&#34;daily_etl&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>getOrCreate</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>df</span> <span class=o>=</span> <span class=n>spark</span><span class=o>.</span><span class=n>read</span><span class=o>.</span><span class=n>csv</span><span class=p>(</span><span class=s2>&#34;s3://bucket/raw/transactions.csv&#34;</span><span class=p>,</span> <span class=n>header</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>inferSchema</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>df_clean</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;amount&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>select</span><span class=p>(</span><span class=s2>&#34;id&#34;</span><span class=p>,</span><span class=s2>&#34;amount&#34;</span><span class=p>,</span><span class=s2>&#34;timestamp&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>df_clean</span><span class=o>.</span><span class=n>write</span><span class=o>.</span><span class=n>mode</span><span class=p>(</span><span class=s2>&#34;overwrite&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>parquet</span><span class=p>(</span><span class=s2>&#34;s3://bucket/processed/transactions/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>spark</span><span class=o>.</span><span class=n>stop</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>설명:</strong> 주기적으로 (raw → clean → transform) 수행되며, 대용량 데이터 처리에 최적화됨.</li></ul><h4 id=stream-processing-kafka--flink-기반>Stream Processing (Kafka + Flink 기반)<a hidden class=anchor aria-hidden=true href=#stream-processing-kafka--flink-기반>#</a></h4><p><strong>예시:</strong> Java + Flink 기반 실시간 스트림 처리</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>StreamExecutionEnvironment</span><span class=w> </span><span class=n>env</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>StreamExecutionEnvironment</span><span class=p>.</span><span class=na>getExecutionEnvironment</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Properties</span><span class=w> </span><span class=n>props</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Properties</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>props</span><span class=p>.</span><span class=na>setProperty</span><span class=p>(</span><span class=s>&#34;bootstrap.servers&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;localhost:9092&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>props</span><span class=p>.</span><span class=na>setProperty</span><span class=p>(</span><span class=s>&#34;group.id&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;flink-group&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>DataStream</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>stream</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>env</span><span class=p>.</span><span class=na>addSource</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>FlinkKafkaConsumer</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=s>&#34;input-topic&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SimpleStringSchema</span><span class=p>(),</span><span class=w> </span><span class=n>props</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>DataStream</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>processed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stream</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=na>filter</span><span class=p>(</span><span class=n>s</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=na>contains</span><span class=p>(</span><span class=s>&#34;error&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>.</span><span class=na>map</span><span class=p>(</span><span class=n>s</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=na>toUpperCase</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>processed</span><span class=p>.</span><span class=na>addSink</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>FlinkKafkaProducer</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=s>&#34;output-topic&#34;</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>SimpleStringSchema</span><span class=p>(),</span><span class=w> </span><span class=n>props</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>env</span><span class=p>.</span><span class=na>execute</span><span class=p>(</span><span class=s>&#34;Kafka-Flink Stream&#34;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ul><li><strong>설명:</strong> Kafka 토픽을 실시간으로 소비 → 조건 필터링/변환 → 새 토픽에 발행.</li></ul><h4 id=hybrid-lambda--kappa-architectures>Hybrid (Lambda / Kappa Architectures)<a hidden class=anchor aria-hidden=true href=#hybrid-lambda--kappa-architectures>#</a></h4><ul><li><p><strong>Lambda Architecture 예시:</strong></p><ul><li><strong>Batch layer:</strong> Spark 배치 작업</li><li><strong>Speed layer:</strong> Flink 를 이용한 실시간 보강</li><li><strong>Serving layer:</strong> 합쳐진 결과 제공</li></ul></li><li><p><strong>Kappa Architecture 예시:</strong></p><ul><li>모든 데이터 흐름을 Kafka 스트림으로 처리, 재처리 시 재입력 및 다시 소비</li><li>중복 처리를 피하면서 단일 코드베이스 유지 가능.</li></ul></li></ul><h4 id=workflow-orchestration-airflow-dag-예시>Workflow Orchestration (Airflow DAG 예시)<a hidden class=anchor aria-hidden=true href=#workflow-orchestration-airflow-dag-예시>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow</span> <span class=kn>import</span> <span class=n>DAG</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.providers.apache.spark.operators.spark_submit</span> <span class=kn>import</span> <span class=n>SparkSubmitOperator</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>airflow.utils.dates</span> <span class=kn>import</span> <span class=n>days_ago</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dag</span> <span class=o>=</span> <span class=n>DAG</span><span class=p>(</span><span class=s1>&#39;etl_dag&#39;</span><span class=p>,</span> <span class=n>start_date</span><span class=o>=</span><span class=n>days_ago</span><span class=p>(</span><span class=mi>1</span><span class=p>),</span> <span class=n>schedule_interval</span><span class=o>=</span><span class=s2>&#34;@daily&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>spark_task</span> <span class=o>=</span> <span class=n>SparkSubmitOperator</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>task_id</span><span class=o>=</span><span class=s2>&#34;spark_etl&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>application</span><span class=o>=</span><span class=s2>&#34;/scripts/daily_etl.py&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>conn_id</span><span class=o>=</span><span class=s2>&#34;spark_default&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>dag</span><span class=o>=</span><span class=n>dag</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>설명:</strong> DAG 기반 배치 연동 & 에러 및 재시도 제어 관리.</li></ul><h4 id=token-based--datadriven-execution>Token-Based / Data‑Driven Execution<a hidden class=anchor aria-hidden=true href=#token-based--datadriven-execution>#</a></h4><ul><li><strong>예시 도구:</strong> TStreams, StreamC, Google Dataflow SDK</li><li><strong>설명:</strong> 데이터 (토큰) 유입 시 직접 트리거되어 병렬 처리 진행. ↳ DSP 나 파이프라인 구현에 유용.</li></ul><h4 id=process-control-산업--iot-시스템>Process Control (산업 & IoT 시스템)<a hidden class=anchor aria-hidden=true href=#process-control-산업--iot-시스템>#</a></h4><ul><li><strong>예시:</strong> ROS2 기반 토픽/노드 구조 또는 PLC/SCADA 피드백 루프</li><li><strong>설명:</strong> 센서 입력에 따라 실시간 제어 루프 수행. 산업 자동화, 로봇 제어에 적합.</li></ul><h4 id=eventdriven-microservices-kafka--microservices>Event‑Driven Microservices (Kafka + Microservices)<a hidden class=anchor aria-hidden=true href=#eventdriven-microservices-kafka--microservices>#</a></h4><ul><li><strong>설명:</strong><ul><li>이벤트 발행: 서비스 1 → Kafka</li><li>서비스 2 → 소비 → 처리 → Kafka/postgres 저장</li></ul></li><li><strong>사례:</strong> 주문속성 이벤트 기반 마이크로서비스 파이프라인</li></ul><h4 id=backpressure--state-management>Backpressure & State Management<a hidden class=anchor aria-hidden=true href=#backpressure--state-management>#</a></h4><ul><li><p><strong>예시 (Flink SQL):</strong></p><ul><li>Time-window aggregation + watermarks 설정</li><li>Kafka 스트림에서 윈도우 기반 집계 시 지연 및 backlog 조절</li></ul></li><li><p><strong>설명:</strong> 정확한 stateful 처리와 안정적 streaming 을 위한 핵심 기술.</p></li></ul><h3 id=장점>장점<a hidden class=anchor aria-hidden=true href=#장점>#</a></h3><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th><th>기여 요인</th></tr></thead><tbody><tr><td><strong>설계적 가치</strong></td><td>낮은 결합도</td><td>필터 간 인터페이스 최소화로 각 컴포넌트가 독립적으로 동작</td><td>흐름 중심 설계, 명확한 데이터 인터페이스</td></tr><tr><td></td><td>모듈화</td><td>각 필터는 독립적으로 개발·테스트·배포 가능</td><td>컴포넌트 독립성</td></tr><tr><td></td><td>유연한 확장성</td><td>새로운 필터의 삽입/삭제/교체가 용이하며 시스템 기능 확장에 유리</td><td>느슨한 결합 구조, 단방향 흐름 기반</td></tr><tr><td><strong>운영적 효율성</strong></td><td>병렬 처리 가능</td><td>독립적인 필터를 멀티스레드 또는 분산 환경에서 병렬 처리 가능</td><td>병렬성 설계, 비동기 실행 기반</td></tr><tr><td></td><td>고처리량 처리</td><td>모듈 단위로 최적화 및 부하 분산 가능, 대규모 데이터 처리에 적합</td><td>비동기/스트리밍 처리 구조</td></tr><tr><td></td><td>유연한 실행 모델</td><td>배치 처리와 스트리밍 처리 방식 모두 지원 가능</td><td>파이프라인 흐름에 기반한 유연한 제어</td></tr><tr><td><strong>개발 생산성</strong></td><td>재사용성</td><td>동일 필터 로직을 여러 워크플로우 또는 시스템 간에 공유 가능</td><td>컴포넌트화된 필터 구조</td></tr><tr><td></td><td>유지보수 용이성</td><td>문제 발생 시 해당 필터만 수정/대체 가능, 영향 범위 최소화</td><td>모듈화된 구조, 필터 단위 테스트 용이성</td></tr><tr><td></td><td>디버깅 및 검증 용이성</td><td>각 단계에서 데이터 로깅, 검증 포인트 설정 가능 → 오류 추적 및 분석에 유리</td><td>파이프라인 구성의 투명성, 필터별 데이터 관찰 가능</td></tr><tr><td></td><td>테스트 용이성</td><td>유닛 단위 테스트가 가능하여 CI/CD 파이프라인과 통합에 유리</td><td>단일 책임 원칙, 독립 컴포넌트 구성</td></tr></tbody></table><h3 id=단점과-문제점-그리고-해결방안>단점과 문제점 그리고 해결방안<a hidden class=anchor aria-hidden=true href=#단점과-문제점-그리고-해결방안>#</a></h3><h4 id=단점>단점<a hidden class=anchor aria-hidden=true href=#단점>#</a></h4><table><thead><tr><th>카테고리</th><th>항목</th><th>설명</th><th>대표 해결 방안</th></tr></thead><tbody><tr><td><strong>구조적 복잡성</strong></td><td>흐름 제어의 복잡성</td><td>조건 분기, 병합, 이벤트 기반 흐름이 복잡하게 설계됨</td><td>조건 라우팅 필터, Flow Controller 도입</td></tr><tr><td><strong>상호작용 제한</strong></td><td>동적 상호작용 제약</td><td>필터 간 동기식 호출, 상태 공유가 어려움</td><td>메시지 브로커 (예: Kafka), 상태 저장소 (Redis 등) 활용</td></tr><tr><td><strong>유지보수 비용</strong></td><td>파이프라인 확장 시 관리 비용 증가</td><td>대형 파이프라인은 필터 수 증가로 복잡해지고 디버깅 난이도 상승</td><td>모듈화된 관리 도구 (Airflow, NiFi), 분리된 필터 디버깅 도입</td></tr><tr><td><strong>상태 관리 한계</strong></td><td>상태 보존이 어려움</td><td>무상태 구조로 인해 이벤트 순서 보장, 세션 상태 관리가 복잡</td><td>체크포인트, 이벤트 소싱, 상태 저장 스토어 (State Store) 사용</td></tr><tr><td><strong>성능 문제</strong></td><td>직렬화/파싱 오버헤드</td><td>파이프 간 메시지 전달에서 직렬화 비용이 누적되어 전체 처리 성능 저하 가능</td><td>Protobuf, Apache Arrow 등 경량 포맷 적용</td></tr><tr><td><strong>데이터 형식 문제</strong></td><td>필터 간 호환성 문제</td><td>포맷/스키마 불일치 시 예외 발생 및 처리 실패 가능</td><td>표준화된 데이터 포맷 사용 (Avro, JSON Schema), 어댑터 패턴 적용</td></tr></tbody></table><h4 id=문제점>문제점<a hidden class=anchor aria-hidden=true href=#문제점>#</a></h4><table><thead><tr><th>카테고리</th><th>문제 항목</th><th>원인</th><th>영향</th><th>탐지 및 진단</th><th>예방 방법</th><th>해결 방법 및 기법</th></tr></thead><tbody><tr><td><strong>신뢰성 문제</strong></td><td>데이터 유실</td><td>파이프 오류, ACK 미수신, 예외 누락</td><td>분석 오류, 불완전한 결과 생성</td><td>로그 모니터링, ACK 확인</td><td>Retry/ACK 시스템 연동</td><td>DLQ(Dead Letter Queue), 재처리 로직 구현</td></tr><tr><td><strong>정확도 문제</strong></td><td>데이터 중복</td><td>배치 - 스트림 중복 적재, 필터 재시도 미처리</td><td>결과 왜곡, 비용 증가</td><td>중복 Key 확인, 해시/타임스탬프 추적</td><td>Idempotent 설계, 중복 감지 파이프라인 설정</td><td>SCD2 전략, Dedup 필터 적용</td></tr><tr><td><strong>성능 문제</strong></td><td>필터 병목</td><td>특정 필터만 느린 처리 속도로 전체 흐름 지연</td><td>파이프라인 처리 속도 저하</td><td>큐 길이, 처리 시간 모니터링</td><td>동시성 확장, 병렬 분산 설계</td><td>Auto-scaling, 필터 리팩토링</td></tr><tr><td><strong>안정성 문제</strong></td><td>장애 전파</td><td>하나의 필터 오류가 전체 흐름을 차단</td><td>전체 시스템 중단</td><td>헬스 체크, SLA 모니터링</td><td>회로 차단기 (Circuit Breaker), 필터 격리</td><td>롤백, 대체 경로 우회 (Retry Path)</td></tr><tr><td><strong>자원 문제</strong></td><td>메모리 누수</td><td>장시간 실행 시 GC 실패, 큐 누적, 캐시 미해제</td><td>시스템 다운, GC Overhead 상승</td><td>Heap/GC 추적, 리소스 누수 탐지</td><td>정기적 풀링 사용, 메모리 스냅샷 검증</td><td>가비지 컬렉션 튜닝, 필터 내 메모리 해제 패턴 적용</td></tr><tr><td><strong>일관성 문제</strong></td><td>데이터 일관성 저하</td><td>필터 간 비동기 처리, 버전 불일치, 분산 동시성 이슈</td><td>비일관성 결과, 데이터 정합성 상실</td><td>체크섬 검증, 이벤트 순서 추적</td><td>버전 태깅, 트랜잭션 경계 도입</td><td>이벤트 소싱, 분산 락, 옵저버블 패턴 적용</td></tr><tr><td><strong>흐름 제어 문제</strong></td><td>Backpressure 현상</td><td>소비자 속도가 생산자를 따라가지 못해 큐/버퍼 초과</td><td>지연 증가, OOM 발생 위험</td><td>큐 길이, 처리률 모니터링</td><td>적응형 처리율 조절, 임계값 설정</td><td>백프레셔 제어 알고리즘 (Exponential Wait 등) 적용</td></tr></tbody></table><h3 id=도전-과제>도전 과제<a hidden class=anchor aria-hidden=true href=#도전-과제>#</a></h3><table><thead><tr><th>카테고리</th><th>도전 과제</th><th>원인</th><th>영향</th><th>해결 방안 및 전략</th></tr></thead><tbody><tr><td><strong>1. 성능 및 실시간성</strong></td><td>대규모 실시간 처리 성능 저하</td><td>데이터량 증가, 병렬성 부족, 지연 발생</td><td>처리 병목, 실시간 분석 지연</td><td>스트림 처리 프레임워크 도입 (Flink, Spark Streaming), 인메모리 처리, GPU/FPGA 활용</td></tr><tr><td></td><td>정확도 vs 지연 트레이드오프</td><td>Lambda 아키텍처의 중복 처리 및 지연 구조</td><td>정확도 희생 또는 응답 시간 지연</td><td>Kappa 아키텍처 전환, 정교한 watermark 기반 처리</td></tr><tr><td><strong>2. 일관성 및 상태 관리</strong></td><td>스트림 상태 불안정 및 체크포인팅 문제</td><td>상태 저장소 장애, 비결정적 처리 순서</td><td>데이터 손실, 재처리 실패, 재시작 불가</td><td>정확한 상태 백업 관리, RocksDB 또는 External State Store 활용</td></tr><tr><td></td><td>분산 환경 내 데이터 일관성 보장</td><td>다양한 노드/파티션에서 동시에 처리</td><td>결과 불일치, 중복 또는 유실 발생</td><td>Exactly-once 보장, Kafka + Flink 상태 일관성 설정</td></tr><tr><td><strong>3. 데이터 품질 및 스키마 관리</strong></td><td>다양한 소스와 스키마 진화 문제</td><td>형식이 상이한 이벤트, 비정형 데이터 증가</td><td>분석 정확도 하락, ML 모델 학습 실패</td><td>스키마 레지스트리 적용, JSON Schema/Avro 기반 유효성 검증</td></tr><tr><td></td><td>데이터 품질 저하</td><td>이상치, 누락, 중복 데이터 유입</td><td>잘못된 분석 결과, 비즈니스 오류</td><td>품질 필터 삽입, Great Expectations, 데이터 리니지 추적</td></tr><tr><td><strong>4. 흐름 제어 및 복잡성</strong></td><td>복잡한 분기/병합 흐름 제어</td><td>다양한 조건 분기, 다중 토픽 조인, 유동적인 라우팅 구조</td><td>파이프라인 오류 발생, 관리 어려움</td><td>DAG 기반 정의, 라우팅 룰 표준화, Flink SQL 등 고수준 DSL 활용</td></tr><tr><td></td><td>마이크로서비스 결합으로 인한 복잡성</td><td>서비스 간 데이터 교환 많고 흐름이 분산됨</td><td>디버깅/테스트/추적 어려움</td><td>서비스 메시 (Istio), Dapr, 메시지 지향 처리로 추상화</td></tr><tr><td><strong>5. 모니터링 및 디버깅</strong></td><td>통합 모니터링 구성의 어려움</td><td>배치, 스트림, 서빙 간 이기종 시스템 존재</td><td>병목 탐지/장애 대응 지연</td><td>Prometheus + Grafana, OpenTelemetry 기반 분산 추적 도입</td></tr><tr><td></td><td>디버깅/재현성 부족</td><td>상태 기반 처리에서 재현 어려움</td><td>장애 원인 분석 난이도 상승</td><td>리플레이 가능한 로그 저장, 이벤트 소싱 기반 재처리 구조 도입</td></tr><tr><td><strong>6. 거버넌스 및 규정 준수</strong></td><td>데이터 리니지 추적 어려움</td><td>복잡한 파이프라인과 연계된 트랜스포머/모델 없음</td><td>데이터 흐름 불투명 → 감사 및 규제 대응 불가</td><td>OpenLineage, Marquez 등 lineage 시스템 구축</td></tr><tr><td><strong>7. 비용 및 자원 관리</strong></td><td>리소스 중복 및 과소/과다 프로비저닝</td><td>멀티 파이프라인/컨슈머 중복 실행</td><td>클라우드 비용 폭증, CPU/MEM 낭비</td><td>AutoScaler 설정, 워크로드 프로파일링, 버퍼 기반 트리거 조정</td></tr></tbody></table><h3 id=분류-기준에-따른-종류-및-유형>분류 기준에 따른 종류 및 유형<a hidden class=anchor aria-hidden=true href=#분류-기준에-따른-종류-및-유형>#</a></h3><table><thead><tr><th>📌 분류 기준</th><th>유형</th><th>설명</th><th>주요 적용 분야</th></tr></thead><tbody><tr><td><strong>1. 구조 구성 방식</strong></td><td>직렬 구조 (Serial Flow)</td><td>필터/모듈이 선형적으로 연결되어 데이터를 단계별로 처리</td><td>단순 파이프라인, ETL, 로그 수집</td></tr><tr><td></td><td>병렬 구조 (Parallel Flow)</td><td>여러 필터가 병렬로 데이터 처리 → 성능 향상과 처리량 증가</td><td>스트리밍 분석, 복잡한 분기 처리</td></tr><tr><td></td><td>혼합 구조 (Hybrid Flow)</td><td>직렬과 병렬 흐름이 혼합된 복합 처리 구조</td><td>대규모 데이터플로우 플랫폼, AI/ML 파이프라인</td></tr><tr><td><strong>2. 실행 및 처리 방식</strong></td><td>배치 순차 처리 (Batch Sequential)</td><td>일괄 수집 후 순차적으로 처리 (시간 지연 허용)</td><td>DWH, 정기 리포트, 데이터 마이그레이션</td></tr><tr><td></td><td>파이프 - 필터 처리 (Pipe-and-Filter)</td><td>필터 간 데이터 흐름이 연속적으로 이어지는 구조</td><td>실시간 로그 분석, 파이프라인 변환 처리</td></tr><tr><td></td><td>피드백 제어 처리 (Process Control)</td><td>처리 결과를 기반으로 동작을 조절하는 제어 기반 구조</td><td>임베디드 시스템, 제어 자동화 시스템</td></tr><tr><td><strong>3. 데이터 처리 시점</strong></td><td>실시간 (Real-time)</td><td>데이터가 도착하는 즉시 처리, 초단위 이하 지연 허용</td><td>금융 거래, IoT 센서 데이터 처리</td></tr><tr><td></td><td>준실시간 (Near real-time)</td><td>몇 초 ~ 몇 분 내 처리. 일정 지연 허용</td><td>추천 시스템, 이벤트 트리거, 알림 시스템</td></tr><tr><td></td><td>배치 처리 (Batch)</td><td>데이터를 일정 주기로 일괄 처리</td><td>보고서 생성, 백오피스 처리</td></tr><tr><td><strong>4. 처리 아키텍처</strong></td><td>Lambda Architecture</td><td>배치 + 스트림을 병합한 이중 처리 경로 구조</td><td>빅데이터 통합 플랫폼, 로그 분석 시스템</td></tr><tr><td></td><td>Kappa Architecture</td><td>스트리밍 중심 구조. 일관된 경로로 모든 데이터 처리</td><td>이벤트 중심 시스템, 실시간 분석 플랫폼</td></tr><tr><td></td><td>Event-driven Architecture</td><td>이벤트 발생을 기반으로 처리 트리거됨. 비동기 흐름에 적합</td><td>마이크로서비스, SOA, 알림 시스템</td></tr><tr><td><strong>5. 배포 및 환경 구성</strong></td><td>단일 시스템</td><td>단일 머신/프로세스 상에서 데이터 흐름 처리</td><td>로컬 테스트, 임베디드 처리</td></tr><tr><td></td><td>분산 시스템</td><td>여러 머신에 필터/처리 노드가 분산 배치됨</td><td>클러스터 기반 실시간 스트리밍, MSA 환경</td></tr><tr><td></td><td>컨테이너 기반 처리</td><td>각 필터/연산을 컨테이너화하여 분산 오케스트레이션 처리</td><td>Kubernetes 기반 데이터 파이프라인 운영</td></tr></tbody></table><h3 id=실무-사용-예시>실무 사용 예시<a hidden class=anchor aria-hidden=true href=#실무-사용-예시>#</a></h3><table><thead><tr><th>카테고리</th><th>주요 사례</th><th>사용 목적</th><th>함께 사용하는 기술/도구</th><th>기대 효과 및 특징</th></tr></thead><tbody><tr><td><strong>데이터 처리 (ETL/ELT)</strong></td><td>BI 파이프라인 구축</td><td>일 단위 데이터 집계, 클렌징, 변환</td><td>Apache Airflow, Spark, dbt, Snowflake</td><td>대용량 배치 처리, 유연한 스케줄링, 데이터 품질 확보</td></tr><tr><td></td><td>로그 데이터 적재 및 분석</td><td>실시간 로그 수집, 정규화, 지표 생성</td><td>Kinesis, Kafka, Logstash, Elasticsearch, Athena</td><td>실시간 분석 + 장기 저장 병행 처리</td></tr><tr><td><strong>실시간 스트리밍</strong></td><td>IoT 센서 모니터링</td><td>온도/습도/장비 이상 탐지 등 실시간 상태 감시</td><td>Kafka, Apache Flink, InfluxDB</td><td>지연 1 초 이하 경보 시스템, CEP 가능</td></tr><tr><td></td><td>사용자 행동 분석</td><td>클릭, 스크롤, 검색 로그 실시간 처리 및 세션 기반 분석</td><td>Kafka, Flink, Redis Streams</td><td>실시간 세션 분석, 마케팅 자동화</td></tr><tr><td><strong>멀티미디어 처리</strong></td><td>이미지 및 비디오 처리</td><td>변환, 필터 적용, 포맷 변경 등 스트리밍 방식의 멀티미디어 파이프라인 구성</td><td>GStreamer, FFmpeg, OpenCV</td><td>저지연 변환, 병렬처리 기반 스트리밍 편집</td></tr><tr><td><strong>컴파일러</strong></td><td>컴파일 단계 구성</td><td>소스 코드 분석 → 중간 코드 생성 → 최적화 → 코드 생성</td><td>Lexer, Parser, AST, Optimizer, LLVM</td><td>각 단계 독립 구성, 최적화 재사용 용이</td></tr><tr><td><strong>서버/네트워크</strong></td><td>웹 서버 요청 처리</td><td>요청 → 필터 체인 → 응답 패턴의 흐름 기반 처리</td><td>nginx, Apache, Express.js</td><td>라우팅, 인증, 압축 등 모듈화된 HTTP 요청 흐름</td></tr><tr><td><strong>추천 시스템</strong></td><td>실시간/배치 하이브리드 추천</td><td>이벤트 기반 피드백 반영 + 주기적 전체 모델 재학습</td><td>Kafka, Spark, Batch Job, Feature Store</td><td>정밀도 향상, 최신성 유지 (Lambda Architecture 활용)</td></tr><tr><td><strong>시스템 자동화/유틸리티</strong></td><td>UNIX 파이프라인 처리</td><td>텍스트 변환, 로그 필터링, grep/sort/awk 등 쉘 기반 파이프 연산</td><td>Bash, awk, sed, grep</td><td>단순한 구성으로도 효율적인 흐름 처리</td></tr></tbody></table><h3 id=활용-사례>활용 사례<a hidden class=anchor aria-hidden=true href=#활용-사례>#</a></h3><h4 id=사례-1-실시간-로그-분석-시스템>사례 1: 실시간 로그 분석 시스템<a hidden class=anchor aria-hidden=true href=#사례-1-실시간-로그-분석-시스템>#</a></h4><p><strong>시스템 구성:</strong></p><ul><li>로그 수집 → 필터 (전처리) → 필터 (분석) → 필터 (알림) → 출력</li></ul><p><strong>Workflow</strong>:</p><pre class=mermaid>graph LR
    A[로그 수집] --&gt; B[전처리 필터]
    B --&gt; C[분석 필터]
    C --&gt; D[알림 필터]
    D --&gt; E[출력]
</pre><ul><li>로그는 수집 → 전처리 → 분석 → 알림 → 출력 순으로 흐르며, 각 필터는 독립적으로 동작한다.</li></ul><p><strong>역할:</strong></p><ul><li>각 필터는 로그를 전처리, 분석, 알림 등으로 처리.</li></ul><p><strong>차이점:</strong></p><ul><li>데이터 플로우 아키텍처가 없으면 모듈화 및 확장성이 떨어지고, 유지보수가 어려움.</li></ul><h4 id=사례-2-lambda-아키텍처>사례 2: Lambda 아키텍처<a hidden class=anchor aria-hidden=true href=#사례-2-lambda-아키텍처>#</a></h4><p><strong>시스템 구성</strong>:</p><ul><li><strong>스트림 계층</strong>: Kafka → Flink 에서 실시간 집계</li><li><strong>배치 계층</strong>: 하루 단위 Spark ETL→ 데이터 웨어하우스</li><li><strong>서빙 계층</strong>: Elasticsearch 와 BI 툴 (PowerBI 등)</li></ul><p><strong>워크플로우</strong>:</p><ol><li>센서·운영 로그 → Kafka</li><li>Flink 로 실시간 처리</li><li>Spark 배치로 전체 재계산</li><li>결과 서빙 → Elasticsearch/BW</li></ol><p><strong>역할</strong>:</p><ul><li>스트림 계층: 실시간 알람, 즉각 반응</li><li>배치 계층: 정확한 집계/재정렬</li><li>서빙 계층: 분석 요청 대응</li></ul><p><strong>접근 차이</strong>:</p><ul><li>단일 스트림: 실시간성 우위, 정확도 낮음</li><li>Lambda: 실시간 + 정확도 둘 다 향상</li></ul><h3 id=616-활용-사례>6.16 활용 사례<a hidden class=anchor aria-hidden=true href=#616-활용-사례>#</a></h3><h4 id=netflix-의-실시간-추천-시스템>Netflix 의 실시간 추천 시스템<a hidden class=anchor aria-hidden=true href=#netflix-의-실시간-추천-시스템>#</a></h4><p><strong>시스템 구성:</strong><br>Netflix 는 사용자의 시청 행동을 실시간으로 분석하여 개인화된 추천을 제공하는 Data-Flow Architecture 를 구축했습니다.</p><p><strong>시스템 구성 다이어그램:</strong></p><pre class=mermaid>graph TB
    subgraph &#34;Netflix 추천 시스템&#34;
        A[사용자 이벤트] --&gt; B[이벤트 수집기]
        B --&gt; C[Apache Kafka]
        C --&gt; D[스트림 처리 필터]
        D --&gt; E[특성 추출 필터]
        E --&gt; F[ML 모델 필터]
        F --&gt; G[추천 결과 필터]
        G --&gt; H[캐시 레이어]
        H --&gt; I[사용자 인터페이스]
        
        J[배치 처리] --&gt; K[모델 훈련]
        K --&gt; F
    end
</pre><p><strong>Workflow:</strong></p><ol><li>사용자의 클릭, 시청, 평가 등의 이벤트 실시간 수집</li><li>Kafka 를 통한 이벤트 스트림 분산 처리</li><li>스트림 처리 필터에서 이벤트 정규화 및 정제</li><li>특성 추출 필터에서 사용자 선호도 특성 계산</li><li>ML 모델 필터에서 개인화 추천 생성</li><li>추천 결과 필터에서 비즈니스 규칙 적용</li><li>캐시를 통한 빠른 응답 제공</li></ol><p><strong>Data-Flow Architecture 의 역할:</strong></p><ul><li><strong>모듈성</strong>: 각 처리 단계를 독립적인 마이크로서비스로 구현</li><li><strong>확장성</strong>: 트래픽 증가에 따른 개별 필터의 수평 확장</li><li><strong>실시간성</strong>: 스트림 처리를 통한 즉시 추천 업데이트</li><li><strong>재사용성</strong>: 다양한 추천 시나리오에 동일한 필터 재활용</li></ul><p><strong>Data-Flow Architecture 유무에 따른 차이점:</strong></p><table><thead><tr><th>구분</th><th>Data-Flow Architecture 적용</th><th>전통적 아키텍처</th></tr></thead><tbody><tr><td><strong>응답 시간</strong></td><td>실시간 (&lt; 100ms)</td><td>배치 기반 (시간~일)</td></tr><tr><td><strong>확장성</strong></td><td>개별 필터 독립 확장</td><td>전체 시스템 확장 필요</td></tr><tr><td><strong>유지보수</strong></td><td>모듈별 독립 수정</td><td>전체 시스템 영향</td></tr><tr><td><strong>복구 능력</strong></td><td>부분 장애 격리</td><td>전체 시스템 중단</td></tr><tr><td><strong>개발 속도</strong></td><td>병렬 개발 가능</td><td>순차 개발 필요</td></tr></tbody></table><h3 id=617-구현-예시>6.17 구현 예시<a hidden class=anchor aria-hidden=true href=#617-구현-예시>#</a></h3><p>Netflix 추천 시스템의 핵심 구성요소를 Python 으로 구현한 예시:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>  1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>  2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3>  3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4>  4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5>  5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6>  6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7>  7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8>  8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9>  9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10> 10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11> 11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12> 12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13> 13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14> 14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15> 15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16> 16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17> 17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18> 18</a>
</span><span class=lnt id=hl-9-19><a class=lnlinks href=#hl-9-19> 19</a>
</span><span class=lnt id=hl-9-20><a class=lnlinks href=#hl-9-20> 20</a>
</span><span class=lnt id=hl-9-21><a class=lnlinks href=#hl-9-21> 21</a>
</span><span class=lnt id=hl-9-22><a class=lnlinks href=#hl-9-22> 22</a>
</span><span class=lnt id=hl-9-23><a class=lnlinks href=#hl-9-23> 23</a>
</span><span class=lnt id=hl-9-24><a class=lnlinks href=#hl-9-24> 24</a>
</span><span class=lnt id=hl-9-25><a class=lnlinks href=#hl-9-25> 25</a>
</span><span class=lnt id=hl-9-26><a class=lnlinks href=#hl-9-26> 26</a>
</span><span class=lnt id=hl-9-27><a class=lnlinks href=#hl-9-27> 27</a>
</span><span class=lnt id=hl-9-28><a class=lnlinks href=#hl-9-28> 28</a>
</span><span class=lnt id=hl-9-29><a class=lnlinks href=#hl-9-29> 29</a>
</span><span class=lnt id=hl-9-30><a class=lnlinks href=#hl-9-30> 30</a>
</span><span class=lnt id=hl-9-31><a class=lnlinks href=#hl-9-31> 31</a>
</span><span class=lnt id=hl-9-32><a class=lnlinks href=#hl-9-32> 32</a>
</span><span class=lnt id=hl-9-33><a class=lnlinks href=#hl-9-33> 33</a>
</span><span class=lnt id=hl-9-34><a class=lnlinks href=#hl-9-34> 34</a>
</span><span class=lnt id=hl-9-35><a class=lnlinks href=#hl-9-35> 35</a>
</span><span class=lnt id=hl-9-36><a class=lnlinks href=#hl-9-36> 36</a>
</span><span class=lnt id=hl-9-37><a class=lnlinks href=#hl-9-37> 37</a>
</span><span class=lnt id=hl-9-38><a class=lnlinks href=#hl-9-38> 38</a>
</span><span class=lnt id=hl-9-39><a class=lnlinks href=#hl-9-39> 39</a>
</span><span class=lnt id=hl-9-40><a class=lnlinks href=#hl-9-40> 40</a>
</span><span class=lnt id=hl-9-41><a class=lnlinks href=#hl-9-41> 41</a>
</span><span class=lnt id=hl-9-42><a class=lnlinks href=#hl-9-42> 42</a>
</span><span class=lnt id=hl-9-43><a class=lnlinks href=#hl-9-43> 43</a>
</span><span class=lnt id=hl-9-44><a class=lnlinks href=#hl-9-44> 44</a>
</span><span class=lnt id=hl-9-45><a class=lnlinks href=#hl-9-45> 45</a>
</span><span class=lnt id=hl-9-46><a class=lnlinks href=#hl-9-46> 46</a>
</span><span class=lnt id=hl-9-47><a class=lnlinks href=#hl-9-47> 47</a>
</span><span class=lnt id=hl-9-48><a class=lnlinks href=#hl-9-48> 48</a>
</span><span class=lnt id=hl-9-49><a class=lnlinks href=#hl-9-49> 49</a>
</span><span class=lnt id=hl-9-50><a class=lnlinks href=#hl-9-50> 50</a>
</span><span class=lnt id=hl-9-51><a class=lnlinks href=#hl-9-51> 51</a>
</span><span class=lnt id=hl-9-52><a class=lnlinks href=#hl-9-52> 52</a>
</span><span class=lnt id=hl-9-53><a class=lnlinks href=#hl-9-53> 53</a>
</span><span class=lnt id=hl-9-54><a class=lnlinks href=#hl-9-54> 54</a>
</span><span class=lnt id=hl-9-55><a class=lnlinks href=#hl-9-55> 55</a>
</span><span class=lnt id=hl-9-56><a class=lnlinks href=#hl-9-56> 56</a>
</span><span class=lnt id=hl-9-57><a class=lnlinks href=#hl-9-57> 57</a>
</span><span class=lnt id=hl-9-58><a class=lnlinks href=#hl-9-58> 58</a>
</span><span class=lnt id=hl-9-59><a class=lnlinks href=#hl-9-59> 59</a>
</span><span class=lnt id=hl-9-60><a class=lnlinks href=#hl-9-60> 60</a>
</span><span class=lnt id=hl-9-61><a class=lnlinks href=#hl-9-61> 61</a>
</span><span class=lnt id=hl-9-62><a class=lnlinks href=#hl-9-62> 62</a>
</span><span class=lnt id=hl-9-63><a class=lnlinks href=#hl-9-63> 63</a>
</span><span class=lnt id=hl-9-64><a class=lnlinks href=#hl-9-64> 64</a>
</span><span class=lnt id=hl-9-65><a class=lnlinks href=#hl-9-65> 65</a>
</span><span class=lnt id=hl-9-66><a class=lnlinks href=#hl-9-66> 66</a>
</span><span class=lnt id=hl-9-67><a class=lnlinks href=#hl-9-67> 67</a>
</span><span class=lnt id=hl-9-68><a class=lnlinks href=#hl-9-68> 68</a>
</span><span class=lnt id=hl-9-69><a class=lnlinks href=#hl-9-69> 69</a>
</span><span class=lnt id=hl-9-70><a class=lnlinks href=#hl-9-70> 70</a>
</span><span class=lnt id=hl-9-71><a class=lnlinks href=#hl-9-71> 71</a>
</span><span class=lnt id=hl-9-72><a class=lnlinks href=#hl-9-72> 72</a>
</span><span class=lnt id=hl-9-73><a class=lnlinks href=#hl-9-73> 73</a>
</span><span class=lnt id=hl-9-74><a class=lnlinks href=#hl-9-74> 74</a>
</span><span class=lnt id=hl-9-75><a class=lnlinks href=#hl-9-75> 75</a>
</span><span class=lnt id=hl-9-76><a class=lnlinks href=#hl-9-76> 76</a>
</span><span class=lnt id=hl-9-77><a class=lnlinks href=#hl-9-77> 77</a>
</span><span class=lnt id=hl-9-78><a class=lnlinks href=#hl-9-78> 78</a>
</span><span class=lnt id=hl-9-79><a class=lnlinks href=#hl-9-79> 79</a>
</span><span class=lnt id=hl-9-80><a class=lnlinks href=#hl-9-80> 80</a>
</span><span class=lnt id=hl-9-81><a class=lnlinks href=#hl-9-81> 81</a>
</span><span class=lnt id=hl-9-82><a class=lnlinks href=#hl-9-82> 82</a>
</span><span class=lnt id=hl-9-83><a class=lnlinks href=#hl-9-83> 83</a>
</span><span class=lnt id=hl-9-84><a class=lnlinks href=#hl-9-84> 84</a>
</span><span class=lnt id=hl-9-85><a class=lnlinks href=#hl-9-85> 85</a>
</span><span class=lnt id=hl-9-86><a class=lnlinks href=#hl-9-86> 86</a>
</span><span class=lnt id=hl-9-87><a class=lnlinks href=#hl-9-87> 87</a>
</span><span class=lnt id=hl-9-88><a class=lnlinks href=#hl-9-88> 88</a>
</span><span class=lnt id=hl-9-89><a class=lnlinks href=#hl-9-89> 89</a>
</span><span class=lnt id=hl-9-90><a class=lnlinks href=#hl-9-90> 90</a>
</span><span class=lnt id=hl-9-91><a class=lnlinks href=#hl-9-91> 91</a>
</span><span class=lnt id=hl-9-92><a class=lnlinks href=#hl-9-92> 92</a>
</span><span class=lnt id=hl-9-93><a class=lnlinks href=#hl-9-93> 93</a>
</span><span class=lnt id=hl-9-94><a class=lnlinks href=#hl-9-94> 94</a>
</span><span class=lnt id=hl-9-95><a class=lnlinks href=#hl-9-95> 95</a>
</span><span class=lnt id=hl-9-96><a class=lnlinks href=#hl-9-96> 96</a>
</span><span class=lnt id=hl-9-97><a class=lnlinks href=#hl-9-97> 97</a>
</span><span class=lnt id=hl-9-98><a class=lnlinks href=#hl-9-98> 98</a>
</span><span class=lnt id=hl-9-99><a class=lnlinks href=#hl-9-99> 99</a>
</span><span class=lnt id=hl-9-100><a class=lnlinks href=#hl-9-100>100</a>
</span><span class=lnt id=hl-9-101><a class=lnlinks href=#hl-9-101>101</a>
</span><span class=lnt id=hl-9-102><a class=lnlinks href=#hl-9-102>102</a>
</span><span class=lnt id=hl-9-103><a class=lnlinks href=#hl-9-103>103</a>
</span><span class=lnt id=hl-9-104><a class=lnlinks href=#hl-9-104>104</a>
</span><span class=lnt id=hl-9-105><a class=lnlinks href=#hl-9-105>105</a>
</span><span class=lnt id=hl-9-106><a class=lnlinks href=#hl-9-106>106</a>
</span><span class=lnt id=hl-9-107><a class=lnlinks href=#hl-9-107>107</a>
</span><span class=lnt id=hl-9-108><a class=lnlinks href=#hl-9-108>108</a>
</span><span class=lnt id=hl-9-109><a class=lnlinks href=#hl-9-109>109</a>
</span><span class=lnt id=hl-9-110><a class=lnlinks href=#hl-9-110>110</a>
</span><span class=lnt id=hl-9-111><a class=lnlinks href=#hl-9-111>111</a>
</span><span class=lnt id=hl-9-112><a class=lnlinks href=#hl-9-112>112</a>
</span><span class=lnt id=hl-9-113><a class=lnlinks href=#hl-9-113>113</a>
</span><span class=lnt id=hl-9-114><a class=lnlinks href=#hl-9-114>114</a>
</span><span class=lnt id=hl-9-115><a class=lnlinks href=#hl-9-115>115</a>
</span><span class=lnt id=hl-9-116><a class=lnlinks href=#hl-9-116>116</a>
</span><span class=lnt id=hl-9-117><a class=lnlinks href=#hl-9-117>117</a>
</span><span class=lnt id=hl-9-118><a class=lnlinks href=#hl-9-118>118</a>
</span><span class=lnt id=hl-9-119><a class=lnlinks href=#hl-9-119>119</a>
</span><span class=lnt id=hl-9-120><a class=lnlinks href=#hl-9-120>120</a>
</span><span class=lnt id=hl-9-121><a class=lnlinks href=#hl-9-121>121</a>
</span><span class=lnt id=hl-9-122><a class=lnlinks href=#hl-9-122>122</a>
</span><span class=lnt id=hl-9-123><a class=lnlinks href=#hl-9-123>123</a>
</span><span class=lnt id=hl-9-124><a class=lnlinks href=#hl-9-124>124</a>
</span><span class=lnt id=hl-9-125><a class=lnlinks href=#hl-9-125>125</a>
</span><span class=lnt id=hl-9-126><a class=lnlinks href=#hl-9-126>126</a>
</span><span class=lnt id=hl-9-127><a class=lnlinks href=#hl-9-127>127</a>
</span><span class=lnt id=hl-9-128><a class=lnlinks href=#hl-9-128>128</a>
</span><span class=lnt id=hl-9-129><a class=lnlinks href=#hl-9-129>129</a>
</span><span class=lnt id=hl-9-130><a class=lnlinks href=#hl-9-130>130</a>
</span><span class=lnt id=hl-9-131><a class=lnlinks href=#hl-9-131>131</a>
</span><span class=lnt id=hl-9-132><a class=lnlinks href=#hl-9-132>132</a>
</span><span class=lnt id=hl-9-133><a class=lnlinks href=#hl-9-133>133</a>
</span><span class=lnt id=hl-9-134><a class=lnlinks href=#hl-9-134>134</a>
</span><span class=lnt id=hl-9-135><a class=lnlinks href=#hl-9-135>135</a>
</span><span class=lnt id=hl-9-136><a class=lnlinks href=#hl-9-136>136</a>
</span><span class=lnt id=hl-9-137><a class=lnlinks href=#hl-9-137>137</a>
</span><span class=lnt id=hl-9-138><a class=lnlinks href=#hl-9-138>138</a>
</span><span class=lnt id=hl-9-139><a class=lnlinks href=#hl-9-139>139</a>
</span><span class=lnt id=hl-9-140><a class=lnlinks href=#hl-9-140>140</a>
</span><span class=lnt id=hl-9-141><a class=lnlinks href=#hl-9-141>141</a>
</span><span class=lnt id=hl-9-142><a class=lnlinks href=#hl-9-142>142</a>
</span><span class=lnt id=hl-9-143><a class=lnlinks href=#hl-9-143>143</a>
</span><span class=lnt id=hl-9-144><a class=lnlinks href=#hl-9-144>144</a>
</span><span class=lnt id=hl-9-145><a class=lnlinks href=#hl-9-145>145</a>
</span><span class=lnt id=hl-9-146><a class=lnlinks href=#hl-9-146>146</a>
</span><span class=lnt id=hl-9-147><a class=lnlinks href=#hl-9-147>147</a>
</span><span class=lnt id=hl-9-148><a class=lnlinks href=#hl-9-148>148</a>
</span><span class=lnt id=hl-9-149><a class=lnlinks href=#hl-9-149>149</a>
</span><span class=lnt id=hl-9-150><a class=lnlinks href=#hl-9-150>150</a>
</span><span class=lnt id=hl-9-151><a class=lnlinks href=#hl-9-151>151</a>
</span><span class=lnt id=hl-9-152><a class=lnlinks href=#hl-9-152>152</a>
</span><span class=lnt id=hl-9-153><a class=lnlinks href=#hl-9-153>153</a>
</span><span class=lnt id=hl-9-154><a class=lnlinks href=#hl-9-154>154</a>
</span><span class=lnt id=hl-9-155><a class=lnlinks href=#hl-9-155>155</a>
</span><span class=lnt id=hl-9-156><a class=lnlinks href=#hl-9-156>156</a>
</span><span class=lnt id=hl-9-157><a class=lnlinks href=#hl-9-157>157</a>
</span><span class=lnt id=hl-9-158><a class=lnlinks href=#hl-9-158>158</a>
</span><span class=lnt id=hl-9-159><a class=lnlinks href=#hl-9-159>159</a>
</span><span class=lnt id=hl-9-160><a class=lnlinks href=#hl-9-160>160</a>
</span><span class=lnt id=hl-9-161><a class=lnlinks href=#hl-9-161>161</a>
</span><span class=lnt id=hl-9-162><a class=lnlinks href=#hl-9-162>162</a>
</span><span class=lnt id=hl-9-163><a class=lnlinks href=#hl-9-163>163</a>
</span><span class=lnt id=hl-9-164><a class=lnlinks href=#hl-9-164>164</a>
</span><span class=lnt id=hl-9-165><a class=lnlinks href=#hl-9-165>165</a>
</span><span class=lnt id=hl-9-166><a class=lnlinks href=#hl-9-166>166</a>
</span><span class=lnt id=hl-9-167><a class=lnlinks href=#hl-9-167>167</a>
</span><span class=lnt id=hl-9-168><a class=lnlinks href=#hl-9-168>168</a>
</span><span class=lnt id=hl-9-169><a class=lnlinks href=#hl-9-169>169</a>
</span><span class=lnt id=hl-9-170><a class=lnlinks href=#hl-9-170>170</a>
</span><span class=lnt id=hl-9-171><a class=lnlinks href=#hl-9-171>171</a>
</span><span class=lnt id=hl-9-172><a class=lnlinks href=#hl-9-172>172</a>
</span><span class=lnt id=hl-9-173><a class=lnlinks href=#hl-9-173>173</a>
</span><span class=lnt id=hl-9-174><a class=lnlinks href=#hl-9-174>174</a>
</span><span class=lnt id=hl-9-175><a class=lnlinks href=#hl-9-175>175</a>
</span><span class=lnt id=hl-9-176><a class=lnlinks href=#hl-9-176>176</a>
</span><span class=lnt id=hl-9-177><a class=lnlinks href=#hl-9-177>177</a>
</span><span class=lnt id=hl-9-178><a class=lnlinks href=#hl-9-178>178</a>
</span><span class=lnt id=hl-9-179><a class=lnlinks href=#hl-9-179>179</a>
</span><span class=lnt id=hl-9-180><a class=lnlinks href=#hl-9-180>180</a>
</span><span class=lnt id=hl-9-181><a class=lnlinks href=#hl-9-181>181</a>
</span><span class=lnt id=hl-9-182><a class=lnlinks href=#hl-9-182>182</a>
</span><span class=lnt id=hl-9-183><a class=lnlinks href=#hl-9-183>183</a>
</span><span class=lnt id=hl-9-184><a class=lnlinks href=#hl-9-184>184</a>
</span><span class=lnt id=hl-9-185><a class=lnlinks href=#hl-9-185>185</a>
</span><span class=lnt id=hl-9-186><a class=lnlinks href=#hl-9-186>186</a>
</span><span class=lnt id=hl-9-187><a class=lnlinks href=#hl-9-187>187</a>
</span><span class=lnt id=hl-9-188><a class=lnlinks href=#hl-9-188>188</a>
</span><span class=lnt id=hl-9-189><a class=lnlinks href=#hl-9-189>189</a>
</span><span class=lnt id=hl-9-190><a class=lnlinks href=#hl-9-190>190</a>
</span><span class=lnt id=hl-9-191><a class=lnlinks href=#hl-9-191>191</a>
</span><span class=lnt id=hl-9-192><a class=lnlinks href=#hl-9-192>192</a>
</span><span class=lnt id=hl-9-193><a class=lnlinks href=#hl-9-193>193</a>
</span><span class=lnt id=hl-9-194><a class=lnlinks href=#hl-9-194>194</a>
</span><span class=lnt id=hl-9-195><a class=lnlinks href=#hl-9-195>195</a>
</span><span class=lnt id=hl-9-196><a class=lnlinks href=#hl-9-196>196</a>
</span><span class=lnt id=hl-9-197><a class=lnlinks href=#hl-9-197>197</a>
</span><span class=lnt id=hl-9-198><a class=lnlinks href=#hl-9-198>198</a>
</span><span class=lnt id=hl-9-199><a class=lnlinks href=#hl-9-199>199</a>
</span><span class=lnt id=hl-9-200><a class=lnlinks href=#hl-9-200>200</a>
</span><span class=lnt id=hl-9-201><a class=lnlinks href=#hl-9-201>201</a>
</span><span class=lnt id=hl-9-202><a class=lnlinks href=#hl-9-202>202</a>
</span><span class=lnt id=hl-9-203><a class=lnlinks href=#hl-9-203>203</a>
</span><span class=lnt id=hl-9-204><a class=lnlinks href=#hl-9-204>204</a>
</span><span class=lnt id=hl-9-205><a class=lnlinks href=#hl-9-205>205</a>
</span><span class=lnt id=hl-9-206><a class=lnlinks href=#hl-9-206>206</a>
</span><span class=lnt id=hl-9-207><a class=lnlinks href=#hl-9-207>207</a>
</span><span class=lnt id=hl-9-208><a class=lnlinks href=#hl-9-208>208</a>
</span><span class=lnt id=hl-9-209><a class=lnlinks href=#hl-9-209>209</a>
</span><span class=lnt id=hl-9-210><a class=lnlinks href=#hl-9-210>210</a>
</span><span class=lnt id=hl-9-211><a class=lnlinks href=#hl-9-211>211</a>
</span><span class=lnt id=hl-9-212><a class=lnlinks href=#hl-9-212>212</a>
</span><span class=lnt id=hl-9-213><a class=lnlinks href=#hl-9-213>213</a>
</span><span class=lnt id=hl-9-214><a class=lnlinks href=#hl-9-214>214</a>
</span><span class=lnt id=hl-9-215><a class=lnlinks href=#hl-9-215>215</a>
</span><span class=lnt id=hl-9-216><a class=lnlinks href=#hl-9-216>216</a>
</span><span class=lnt id=hl-9-217><a class=lnlinks href=#hl-9-217>217</a>
</span><span class=lnt id=hl-9-218><a class=lnlinks href=#hl-9-218>218</a>
</span><span class=lnt id=hl-9-219><a class=lnlinks href=#hl-9-219>219</a>
</span><span class=lnt id=hl-9-220><a class=lnlinks href=#hl-9-220>220</a>
</span><span class=lnt id=hl-9-221><a class=lnlinks href=#hl-9-221>221</a>
</span><span class=lnt id=hl-9-222><a class=lnlinks href=#hl-9-222>222</a>
</span><span class=lnt id=hl-9-223><a class=lnlinks href=#hl-9-223>223</a>
</span><span class=lnt id=hl-9-224><a class=lnlinks href=#hl-9-224>224</a>
</span><span class=lnt id=hl-9-225><a class=lnlinks href=#hl-9-225>225</a>
</span><span class=lnt id=hl-9-226><a class=lnlinks href=#hl-9-226>226</a>
</span><span class=lnt id=hl-9-227><a class=lnlinks href=#hl-9-227>227</a>
</span><span class=lnt id=hl-9-228><a class=lnlinks href=#hl-9-228>228</a>
</span><span class=lnt id=hl-9-229><a class=lnlinks href=#hl-9-229>229</a>
</span><span class=lnt id=hl-9-230><a class=lnlinks href=#hl-9-230>230</a>
</span><span class=lnt id=hl-9-231><a class=lnlinks href=#hl-9-231>231</a>
</span><span class=lnt id=hl-9-232><a class=lnlinks href=#hl-9-232>232</a>
</span><span class=lnt id=hl-9-233><a class=lnlinks href=#hl-9-233>233</a>
</span><span class=lnt id=hl-9-234><a class=lnlinks href=#hl-9-234>234</a>
</span><span class=lnt id=hl-9-235><a class=lnlinks href=#hl-9-235>235</a>
</span><span class=lnt id=hl-9-236><a class=lnlinks href=#hl-9-236>236</a>
</span><span class=lnt id=hl-9-237><a class=lnlinks href=#hl-9-237>237</a>
</span><span class=lnt id=hl-9-238><a class=lnlinks href=#hl-9-238>238</a>
</span><span class=lnt id=hl-9-239><a class=lnlinks href=#hl-9-239>239</a>
</span><span class=lnt id=hl-9-240><a class=lnlinks href=#hl-9-240>240</a>
</span><span class=lnt id=hl-9-241><a class=lnlinks href=#hl-9-241>241</a>
</span><span class=lnt id=hl-9-242><a class=lnlinks href=#hl-9-242>242</a>
</span><span class=lnt id=hl-9-243><a class=lnlinks href=#hl-9-243>243</a>
</span><span class=lnt id=hl-9-244><a class=lnlinks href=#hl-9-244>244</a>
</span><span class=lnt id=hl-9-245><a class=lnlinks href=#hl-9-245>245</a>
</span><span class=lnt id=hl-9-246><a class=lnlinks href=#hl-9-246>246</a>
</span><span class=lnt id=hl-9-247><a class=lnlinks href=#hl-9-247>247</a>
</span><span class=lnt id=hl-9-248><a class=lnlinks href=#hl-9-248>248</a>
</span><span class=lnt id=hl-9-249><a class=lnlinks href=#hl-9-249>249</a>
</span><span class=lnt id=hl-9-250><a class=lnlinks href=#hl-9-250>250</a>
</span><span class=lnt id=hl-9-251><a class=lnlinks href=#hl-9-251>251</a>
</span><span class=lnt id=hl-9-252><a class=lnlinks href=#hl-9-252>252</a>
</span><span class=lnt id=hl-9-253><a class=lnlinks href=#hl-9-253>253</a>
</span><span class=lnt id=hl-9-254><a class=lnlinks href=#hl-9-254>254</a>
</span><span class=lnt id=hl-9-255><a class=lnlinks href=#hl-9-255>255</a>
</span><span class=lnt id=hl-9-256><a class=lnlinks href=#hl-9-256>256</a>
</span><span class=lnt id=hl-9-257><a class=lnlinks href=#hl-9-257>257</a>
</span><span class=lnt id=hl-9-258><a class=lnlinks href=#hl-9-258>258</a>
</span><span class=lnt id=hl-9-259><a class=lnlinks href=#hl-9-259>259</a>
</span><span class=lnt id=hl-9-260><a class=lnlinks href=#hl-9-260>260</a>
</span><span class=lnt id=hl-9-261><a class=lnlinks href=#hl-9-261>261</a>
</span><span class=lnt id=hl-9-262><a class=lnlinks href=#hl-9-262>262</a>
</span><span class=lnt id=hl-9-263><a class=lnlinks href=#hl-9-263>263</a>
</span><span class=lnt id=hl-9-264><a class=lnlinks href=#hl-9-264>264</a>
</span><span class=lnt id=hl-9-265><a class=lnlinks href=#hl-9-265>265</a>
</span><span class=lnt id=hl-9-266><a class=lnlinks href=#hl-9-266>266</a>
</span><span class=lnt id=hl-9-267><a class=lnlinks href=#hl-9-267>267</a>
</span><span class=lnt id=hl-9-268><a class=lnlinks href=#hl-9-268>268</a>
</span><span class=lnt id=hl-9-269><a class=lnlinks href=#hl-9-269>269</a>
</span><span class=lnt id=hl-9-270><a class=lnlinks href=#hl-9-270>270</a>
</span><span class=lnt id=hl-9-271><a class=lnlinks href=#hl-9-271>271</a>
</span><span class=lnt id=hl-9-272><a class=lnlinks href=#hl-9-272>272</a>
</span><span class=lnt id=hl-9-273><a class=lnlinks href=#hl-9-273>273</a>
</span><span class=lnt id=hl-9-274><a class=lnlinks href=#hl-9-274>274</a>
</span><span class=lnt id=hl-9-275><a class=lnlinks href=#hl-9-275>275</a>
</span><span class=lnt id=hl-9-276><a class=lnlinks href=#hl-9-276>276</a>
</span><span class=lnt id=hl-9-277><a class=lnlinks href=#hl-9-277>277</a>
</span><span class=lnt id=hl-9-278><a class=lnlinks href=#hl-9-278>278</a>
</span><span class=lnt id=hl-9-279><a class=lnlinks href=#hl-9-279>279</a>
</span><span class=lnt id=hl-9-280><a class=lnlinks href=#hl-9-280>280</a>
</span><span class=lnt id=hl-9-281><a class=lnlinks href=#hl-9-281>281</a>
</span><span class=lnt id=hl-9-282><a class=lnlinks href=#hl-9-282>282</a>
</span><span class=lnt id=hl-9-283><a class=lnlinks href=#hl-9-283>283</a>
</span><span class=lnt id=hl-9-284><a class=lnlinks href=#hl-9-284>284</a>
</span><span class=lnt id=hl-9-285><a class=lnlinks href=#hl-9-285>285</a>
</span><span class=lnt id=hl-9-286><a class=lnlinks href=#hl-9-286>286</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>asyncio</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABC</span><span class=p>,</span> <span class=n>abstractmethod</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Any</span><span class=p>,</span> <span class=n>Dict</span><span class=p>,</span> <span class=n>List</span><span class=p>,</span> <span class=n>AsyncIterator</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>dataclasses</span> <span class=kn>import</span> <span class=n>dataclass</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>datetime</span> <span class=kn>import</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 기본 필터 인터페이스 정의</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Filter</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Data-Flow Architecture의 기본 필터 인터페이스&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nd>@abstractmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Any</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터 처리 메서드&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 파이프 구현 - 필터 간 데이터 전송</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Pipe</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;필터 간 데이터 전송을 담당하는 파이프&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>buffer_size</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>1000</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>queue</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>Queue</span><span class=p>(</span><span class=n>maxsize</span><span class=o>=</span><span class=n>buffer_size</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>send</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>data</span><span class=p>:</span> <span class=n>Any</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터 전송&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>queue</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>receive</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;데이터 수신&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>queue</span><span class=o>.</span><span class=n>get</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용자 이벤트 데이터 구조</span>
</span></span><span class=line><span class=cl><span class=nd>@dataclass</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UserEvent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>user_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>content_id</span><span class=p>:</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>    <span class=n>event_type</span><span class=p>:</span> <span class=nb>str</span>  <span class=c1># &#39;view&#39;, &#39;click&#39;, &#39;rate&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>timestamp</span><span class=p>:</span> <span class=n>datetime</span>
</span></span><span class=line><span class=cl>    <span class=n>duration</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>    <span class=n>rating</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. 이벤트 수집 필터</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>EventCollectorFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;사용자 이벤트를 수집하고 정규화하는 필터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>raw_event</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>UserEvent</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;원시 이벤트를 UserEvent 객체로 변환&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>event</span> <span class=o>=</span> <span class=n>UserEvent</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=n>user_id</span><span class=o>=</span><span class=n>raw_event</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>content_id</span><span class=o>=</span><span class=n>raw_event</span><span class=p>[</span><span class=s1>&#39;content_id&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>event_type</span><span class=o>=</span><span class=n>raw_event</span><span class=p>[</span><span class=s1>&#39;event_type&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>timestamp</span><span class=o>=</span><span class=n>datetime</span><span class=o>.</span><span class=n>fromisoformat</span><span class=p>(</span><span class=n>raw_event</span><span class=p>[</span><span class=s1>&#39;timestamp&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>                <span class=n>duration</span><span class=o>=</span><span class=n>raw_event</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;duration&#39;</span><span class=p>,</span> <span class=mf>0.0</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=n>rating</span><span class=o>=</span><span class=n>raw_event</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;rating&#39;</span><span class=p>,</span> <span class=mf>0.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;이벤트 수집: </span><span class=si>{</span><span class=n>event</span><span class=o>.</span><span class=n>user_id</span><span class=si>}</span><span class=s2> - </span><span class=si>{</span><span class=n>event</span><span class=o>.</span><span class=n>event_type</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>event</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;이벤트 처리 오류: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. 특성 추출 필터</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>FeatureExtractionFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;사용자 행동에서 특성을 추출하는 필터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>user_profiles</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># 실제로는 Redis 등 외부 저장소 사용</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>event</span><span class=p>:</span> <span class=n>UserEvent</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;사용자 이벤트에서 특성 추출&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>event</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 사용자 프로필 업데이트</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>event</span><span class=o>.</span><span class=n>user_id</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>user_profiles</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>user_profiles</span><span class=p>[</span><span class=n>event</span><span class=o>.</span><span class=n>user_id</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;view_count&#39;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;total_duration&#39;</span><span class=p>:</span> <span class=mf>0.0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;preferred_genres&#39;</span><span class=p>:</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>                <span class=s1>&#39;recent_content&#39;</span><span class=p>:</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>profile</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>user_profiles</span><span class=p>[</span><span class=n>event</span><span class=o>.</span><span class=n>user_id</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>event</span><span class=o>.</span><span class=n>event_type</span> <span class=o>==</span> <span class=s1>&#39;view&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>profile</span><span class=p>[</span><span class=s1>&#39;view_count&#39;</span><span class=p>]</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>profile</span><span class=p>[</span><span class=s1>&#39;total_duration&#39;</span><span class=p>]</span> <span class=o>+=</span> <span class=n>event</span><span class=o>.</span><span class=n>duration</span>
</span></span><span class=line><span class=cl>            <span class=n>profile</span><span class=p>[</span><span class=s1>&#39;recent_content&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>event</span><span class=o>.</span><span class=n>content_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 최근 10개 콘텐츠만 유지</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>profile</span><span class=p>[</span><span class=s1>&#39;recent_content&#39;</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mi>10</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>profile</span><span class=p>[</span><span class=s1>&#39;recent_content&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>profile</span><span class=p>[</span><span class=s1>&#39;recent_content&#39;</span><span class=p>][</span><span class=o>-</span><span class=mi>10</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>features</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>event</span><span class=o>.</span><span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;avg_watch_duration&#39;</span><span class=p>:</span> <span class=n>profile</span><span class=p>[</span><span class=s1>&#39;total_duration&#39;</span><span class=p>]</span> <span class=o>/</span> <span class=nb>max</span><span class=p>(</span><span class=n>profile</span><span class=p>[</span><span class=s1>&#39;view_count&#39;</span><span class=p>],</span> <span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;activity_level&#39;</span><span class=p>:</span> <span class=s1>&#39;high&#39;</span> <span class=k>if</span> <span class=n>profile</span><span class=p>[</span><span class=s1>&#39;view_count&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>50</span> <span class=k>else</span> <span class=s1>&#39;medium&#39;</span> <span class=k>if</span> <span class=n>profile</span><span class=p>[</span><span class=s1>&#39;view_count&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>10</span> <span class=k>else</span> <span class=s1>&#39;low&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;recent_content&#39;</span><span class=p>:</span> <span class=n>profile</span><span class=p>[</span><span class=s1>&#39;recent_content&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;특성 추출 완료: </span><span class=si>{</span><span class=n>event</span><span class=o>.</span><span class=n>user_id</span><span class=si>}</span><span class=s2> - 활동 레벨: </span><span class=si>{</span><span class=n>features</span><span class=p>[</span><span class=s1>&#39;activity_level&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>features</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. 추천 생성 필터</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>RecommendationFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;ML 모델을 사용하여 추천을 생성하는 필터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 실제로는 TensorFlow, PyTorch 등의 모델 로드</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>content_catalog</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;movie_1&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;genre&#39;</span><span class=p>:</span> <span class=s1>&#39;action&#39;</span><span class=p>,</span> <span class=s1>&#39;rating&#39;</span><span class=p>:</span> <span class=mf>4.5</span><span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;movie_2&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;genre&#39;</span><span class=p>:</span> <span class=s1>&#39;comedy&#39;</span><span class=p>,</span> <span class=s1>&#39;rating&#39;</span><span class=p>:</span> <span class=mf>4.2</span><span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;movie_3&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;genre&#39;</span><span class=p>:</span> <span class=s1>&#39;drama&#39;</span><span class=p>,</span> <span class=s1>&#39;rating&#39;</span><span class=p>:</span> <span class=mf>4.7</span><span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;movie_4&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;genre&#39;</span><span class=p>:</span> <span class=s1>&#39;action&#39;</span><span class=p>,</span> <span class=s1>&#39;rating&#39;</span><span class=p>:</span> <span class=mf>4.3</span><span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;movie_5&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;genre&#39;</span><span class=p>:</span> <span class=s1>&#39;comedy&#39;</span><span class=p>,</span> <span class=s1>&#39;rating&#39;</span><span class=p>:</span> <span class=mf>4.0</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>features</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;사용자 특성을 기반으로 추천 생성&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>features</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>user_id</span> <span class=o>=</span> <span class=n>features</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>activity_level</span> <span class=o>=</span> <span class=n>features</span><span class=p>[</span><span class=s1>&#39;activity_level&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>recent_content</span> <span class=o>=</span> <span class=n>features</span><span class=p>[</span><span class=s1>&#39;recent_content&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 간단한 추천 로직 (실제로는 복잡한 ML 모델 사용)</span>
</span></span><span class=line><span class=cl>        <span class=n>recommendations</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 활동 레벨에 따른 추천 수 조정</span>
</span></span><span class=line><span class=cl>        <span class=n>rec_count</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;high&#39;</span><span class=p>:</span> <span class=mi>10</span><span class=p>,</span> <span class=s1>&#39;medium&#39;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span> <span class=s1>&#39;low&#39;</span><span class=p>:</span> <span class=mi>3</span><span class=p>}[</span><span class=n>activity_level</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 최근 시청하지 않은 콘텐츠 추천</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>content_id</span><span class=p>,</span> <span class=n>content_info</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>content_catalog</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>content_id</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>recent_content</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>recommendations</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;content_id&#39;</span><span class=p>:</span> <span class=n>content_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;score&#39;</span><span class=p>:</span> <span class=n>content_info</span><span class=p>[</span><span class=s1>&#39;rating&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                    <span class=s1>&#39;genre&#39;</span><span class=p>:</span> <span class=n>content_info</span><span class=p>[</span><span class=s1>&#39;genre&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 점수 기준 정렬 및 상위 N개 선택</span>
</span></span><span class=line><span class=cl>        <span class=n>recommendations</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>],</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>recommendations</span> <span class=o>=</span> <span class=n>recommendations</span><span class=p>[:</span><span class=n>rec_count</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;recommendations&#39;</span><span class=p>:</span> <span class=n>recommendations</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;generated_at&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;추천 생성 완료: </span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2> - </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>recommendations</span><span class=p>)</span><span class=si>}</span><span class=s2>개 추천&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. 캐시 필터</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CacheFilter</span><span class=p>(</span><span class=n>Filter</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;추천 결과를 캐시에 저장하는 필터&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>cache</span> <span class=o>=</span> <span class=p>{}</span>  <span class=c1># 실제로는 Redis 등 사용</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>recommendation</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;추천 결과를 캐시에 저장&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>recommendation</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>user_id</span> <span class=o>=</span> <span class=n>recommendation</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>cache</span><span class=p>[</span><span class=n>user_id</span><span class=p>]</span> <span class=o>=</span> <span class=n>recommendation</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;캐시 저장 완료: </span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>recommendation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Data-Flow 파이프라인 구성</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>RecommendationPipeline</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Netflix 스타일 추천 시스템 파이프라인&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># 필터 인스턴스 생성</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>event_collector</span> <span class=o>=</span> <span class=n>EventCollectorFilter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>feature_extractor</span> <span class=o>=</span> <span class=n>FeatureExtractionFilter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>recommender</span> <span class=o>=</span> <span class=n>RecommendationFilter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>cache</span> <span class=o>=</span> <span class=n>CacheFilter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 파이프 생성</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pipe1</span> <span class=o>=</span> <span class=n>Pipe</span><span class=p>()</span>  <span class=c1># EventCollector -&gt; FeatureExtractor</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pipe2</span> <span class=o>=</span> <span class=n>Pipe</span><span class=p>()</span>  <span class=c1># FeatureExtractor -&gt; Recommender</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>pipe3</span> <span class=o>=</span> <span class=n>Pipe</span><span class=p>()</span>  <span class=c1># Recommender -&gt; Cache</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>process_event</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>raw_event</span><span class=p>:</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;단일 이벤트 처리&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># 1단계: 이벤트 수집 및 정규화</span>
</span></span><span class=line><span class=cl>        <span class=n>event</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>event_collector</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>raw_event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>event</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>pipe1</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>def</span> <span class=nf>run_pipeline</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34;파이프라인 실행 - 각 필터를 독립적인 태스크로 실행&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 특성 추출 태스크</span>
</span></span><span class=line><span class=cl>        <span class=k>async</span> <span class=k>def</span> <span class=nf>feature_extraction_task</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>event</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>pipe1</span><span class=o>.</span><span class=n>receive</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                    <span class=n>features</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>feature_extractor</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>features</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>pipe2</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>features</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;특성 추출 오류: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 추천 생성 태스크</span>
</span></span><span class=line><span class=cl>        <span class=k>async</span> <span class=k>def</span> <span class=nf>recommendation_task</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>features</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>pipe2</span><span class=o>.</span><span class=n>receive</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                    <span class=n>recommendation</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>recommender</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>features</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>recommendation</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>pipe3</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=n>recommendation</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;추천 생성 오류: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 캐시 저장 태스크</span>
</span></span><span class=line><span class=cl>        <span class=k>async</span> <span class=k>def</span> <span class=nf>cache_task</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>recommendation</span> <span class=o>=</span> <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>pipe3</span><span class=o>.</span><span class=n>receive</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                    <span class=k>await</span> <span class=bp>self</span><span class=o>.</span><span class=n>cache</span><span class=o>.</span><span class=n>process</span><span class=p>(</span><span class=n>recommendation</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;캐시 저장 오류: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 모든 태스크를 동시에 실행</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>feature_extraction_task</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>recommendation_task</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>cache_task</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 사용 예시</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;메인 실행 함수&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline</span> <span class=o>=</span> <span class=n>RecommendationPipeline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 파이프라인 시작</span>
</span></span><span class=line><span class=cl>    <span class=n>pipeline_task</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>create_task</span><span class=p>(</span><span class=n>pipeline</span><span class=o>.</span><span class=n>run_pipeline</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 테스트 이벤트 생성</span>
</span></span><span class=line><span class=cl>    <span class=n>test_events</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=s1>&#39;user_123&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;content_id&#39;</span><span class=p>:</span> <span class=s1>&#39;movie_1&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;event_type&#39;</span><span class=p>:</span> <span class=s1>&#39;view&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;duration&#39;</span><span class=p>:</span> <span class=mf>1200.0</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=s1>&#39;user_123&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;content_id&#39;</span><span class=p>:</span> <span class=s1>&#39;movie_2&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;event_type&#39;</span><span class=p>:</span> <span class=s1>&#39;click&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;user_id&#39;</span><span class=p>:</span> <span class=s1>&#39;user_456&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;content_id&#39;</span><span class=p>:</span> <span class=s1>&#39;movie_3&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;event_type&#39;</span><span class=p>:</span> <span class=s1>&#39;view&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;timestamp&#39;</span><span class=p>:</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>isoformat</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;duration&#39;</span><span class=p>:</span> <span class=mf>3600.0</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 이벤트 처리</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>event</span> <span class=ow>in</span> <span class=n>test_events</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>process_event</span><span class=p>(</span><span class=n>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>  <span class=c1># 약간의 지연</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 결과 확인을 위한 대기</span>
</span></span><span class=line><span class=cl>    <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;=== 캐시된 추천 결과 ===&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>user_id</span><span class=p>,</span> <span class=n>recommendation</span> <span class=ow>in</span> <span class=n>pipeline</span><span class=o>.</span><span class=n>cache</span><span class=o>.</span><span class=n>cache</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;사용자 </span><span class=si>{</span><span class=n>user_id</span><span class=si>}</span><span class=s2>:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>rec</span> <span class=ow>in</span> <span class=n>recommendation</span><span class=p>[</span><span class=s1>&#39;recommendations&#39;</span><span class=p>][:</span><span class=mi>3</span><span class=p>]:</span>  <span class=c1># 상위 3개만 출력</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;  - </span><span class=si>{</span><span class=n>rec</span><span class=p>[</span><span class=s1>&#39;content_id&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2> (점수: </span><span class=si>{</span><span class=n>rec</span><span class=p>[</span><span class=s1>&#39;score&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>, 장르: </span><span class=si>{</span><span class=n>rec</span><span class=p>[</span><span class=s1>&#39;genre&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 실행</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>main</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p>이 구현 예시는 Data-Flow Architecture 의 핵심 개념들을 보여줍니다:</p><ol><li><strong>필터 독립성</strong>: 각 필터가 독립적으로 동작하며 다른 필터의 내부 구현을 알 필요 없음</li><li><strong>파이프를 통한 연결</strong>: 비동기 큐를 사용하여 필터 간 데이터 전송</li><li><strong>병렬 처리</strong>: 각 필터가 독립적인 태스크로 실행되어 병렬 처리 지원</li><li><strong>확장성</strong>: 새로운 필터 추가나 기존 필터 수정이 용이</li><li><strong>오류 격리</strong>: 한 필터의 오류가 다른 필터에 영향을 주지 않음</li></ol><h2 id=12-구현-예시-python-코드-예시>12. 구현 예시 (Python 코드 예시)<a hidden class=anchor aria-hidden=true href=#12-구현-예시-python-코드-예시>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span><span class=lnt id=hl-10-16><a class=lnlinks href=#hl-10-16>16</a>
</span><span class=lnt id=hl-10-17><a class=lnlinks href=#hl-10-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaConsumer</span><span class=p>,</span> <span class=n>KafkaProducer</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pyspark.sql</span> <span class=kn>import</span> <span class=n>SparkSession</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 실시간 스트림 처리 (Flink 유사 PySpark Structured Streaming 예시)</span>
</span></span><span class=line><span class=cl><span class=n>spark</span> <span class=o>=</span> <span class=n>SparkSession</span><span class=o>.</span><span class=n>builder</span><span class=o>.</span><span class=n>appName</span><span class=p>(</span><span class=s2>&#34;stream_app&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>getOrCreate</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>df</span> <span class=o>=</span> <span class=n>spark</span><span class=o>.</span><span class=n>readStream</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s2>&#34;kafka&#34;</span><span class=p>)</span>\
</span></span><span class=line><span class=cl>   <span class=o>.</span><span class=n>option</span><span class=p>(</span><span class=s2>&#34;subscribe&#34;</span><span class=p>,</span> <span class=s2>&#34;sensor&#34;</span><span class=p>)</span>\
</span></span><span class=line><span class=cl>   <span class=o>.</span><span class=n>load</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>processed</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>selectExpr</span><span class=p>(</span><span class=s2>&#34;CAST(value AS STRING) as raw&#34;</span><span class=p>)</span>\
</span></span><span class=line><span class=cl>   <span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=s2>&#34;raw like &#39;</span><span class=si>%a</span><span class=s2>larm%&#39;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>processed</span><span class=o>.</span><span class=n>writeStream</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=s2>&#34;console&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 배치 처리 부분 (Pyspark 예시)</span>
</span></span><span class=line><span class=cl><span class=n>batch_spark</span> <span class=o>=</span> <span class=n>SparkSession</span><span class=o>.</span><span class=n>builder</span><span class=o>.</span><span class=n>appName</span><span class=p>(</span><span class=s2>&#34;batch_app&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>getOrCreate</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>batch_df</span> <span class=o>=</span> <span class=n>batch_spark</span><span class=o>.</span><span class=n>read</span><span class=o>.</span><span class=n>json</span><span class=p>(</span><span class=s2>&#34;/data/sensor/*.json&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>agg</span> <span class=o>=</span> <span class=n>batch_df</span><span class=o>.</span><span class=n>groupBy</span><span class=p>(</span><span class=s2>&#34;device_id&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>count</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>agg</span><span class=o>.</span><span class=n>write</span><span class=o>.</span><span class=n>mode</span><span class=p>(</span><span class=s2>&#34;overwrite&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>parquet</span><span class=p>(</span><span class=s2>&#34;/data/daily_counts&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>스트림에서는 이벤트 필터링·알람 처리</li><li>배치는 하루 단위 전체 데이터 집계</li></ul><h3 id=616-구현-예시>6.16. 구현 예시<a hidden class=anchor aria-hidden=true href=#616-구현-예시>#</a></h3><p><strong>Python 예시 (간단한 파이프라인):</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15>15</a>
</span><span class=lnt id=hl-11-16><a class=lnlinks href=#hl-11-16>16</a>
</span><span class=lnt id=hl-11-17><a class=lnlinks href=#hl-11-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 필터1: 데이터 전처리</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>filter1</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>data</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 필터2: 데이터 분석</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>filter2</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>data</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;error&#34;</span><span class=p>,</span> <span class=s2>&#34;warning&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 필터3: 데이터 출력</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>filter3</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;결과:&#34;</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 파이프라인 실행</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=s2>&#34;This is an ERROR message&#34;</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>filter1</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=n>filter2</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>filter3</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>설명:</strong><br>각 필터는 독립적으로 데이터를 처리하며, 파이프라인 형태로 데이터가 흐릅니다.</p><h2 id=7-기타-사항>7. 기타 사항<a hidden class=anchor aria-hidden=true href=#7-기타-사항>#</a></h2><ul><li><strong>데이터 플로우 아키텍처는 이벤트 기반 아키텍처 (Event-Driven Architecture) 와 유사점이 많으나, 데이터 흐름에 더 초점을 둡니다.</strong></li><li><strong>실시간 데이터 처리, 분산 시스템, 데이터 파이프라인 등 다양한 분야에서 활용됩니다.</strong></li></ul><h2 id=14-적용-및-최적화-고려사항>14. 적용 및 최적화 고려사항<a hidden class=anchor aria-hidden=true href=#14-적용-및-최적화-고려사항>#</a></h2><table><thead><tr><th>카테고리</th><th>주의할 점</th><th>권장사항</th></tr></thead><tbody><tr><td>실무 적용</td><td>시스템 복잡 증가</td><td>단계별 구축 + 모니터링 자동화</td></tr><tr><td></td><td>데이터 호환성</td><td>스키마 명세, 계약 관리 (Confluent Schema Registry)</td></tr><tr><td></td><td>확장성 설계</td><td>필터별 독립 서비스 배포</td></tr><tr><td>최적화</td><td>중복 방지</td><td>Idempotent 정의/적용</td></tr><tr><td></td><td>배치 간격 조정</td><td>실시간성과 자원 비용 절충</td></tr><tr><td></td><td>리소스 할당</td><td>Auto-scaling, Spot 인스턴스 활용</td></tr></tbody></table><h3 id=618-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>6.18 실무에서 효과적으로 적용하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#618-실무에서-효과적으로-적용하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>카테고리</th><th>고려사항</th><th>주의할 점</th><th>권장사항</th></tr></thead><tbody><tr><td><strong>아키텍처 설계</strong></td><td>필터 간 의존성 최소화</td><td>순환 의존성 발생 방지</td><td>의존성 그래프 작성 및 검토</td></tr><tr><td><strong>성능 최적화</strong></td><td>병목 지점 식별 및 해결</td><td>모든 필터를 동일하게 확장하지 말 것</td><td>성능 프로파일링 도구 활용</td></tr><tr><td><strong>데이터 관리</strong></td><td>표준화된 데이터 스키마 정의</td><td>스키마 변경 시 하위 호환성 고려</td><td>버전 관리 및 스키마 진화 전략 수립</td></tr><tr><td><strong>오류 처리</strong></td><td>각 필터별 오류 처리 로직 구현</td><td>오류 정보 손실 방지</td><td>구조화된 로깅 및 모니터링</td></tr><tr><td><strong>모니터링</strong></td><td>실시간 성능 지표 수집</td><td>과도한 모니터링으로 인한 성능 저하</td><td>핵심 지표에 집중한 모니터링</td></tr><tr><td><strong>테스트</strong></td><td>단위 테스트 및 통합 테스트</td><td>프로덕션 환경과의 차이 간과</td><td>테스트 환경의 프로덕션 환경 근사화</td></tr></tbody></table><h3 id=619-최적화하기-위한-고려사항-및-주의할-점>6.19 최적화하기 위한 고려사항 및 주의할 점<a hidden class=anchor aria-hidden=true href=#619-최적화하기-위한-고려사항-및-주의할-점>#</a></h3><table><thead><tr><th>카테고리</th><th>고려사항</th><th>주의할 점</th><th>권장사항</th></tr></thead><tbody><tr><td><strong>처리량 최적화</strong></td><td>배치 크기 조정</td><td>너무 큰 배치로 인한 메모리 부족</td><td>동적 배치 크기 조정 알고리즘</td></tr><tr><td><strong>지연시간 최적화</strong></td><td>파이프 버퍼 크기 최적화</td><td>과도한 버퍼링으로 인한 메모리 사용량 증가</td><td>적응형 버퍼 관리</td></tr><tr><td><strong>리소스 활용</strong></td><td>CPU 및 메모리 사용량 균형</td><td>특정 리소스의 과도한 사용</td><td>리소스 모니터링 및 자동 스케일링</td></tr><tr><td><strong>네트워크 최적화</strong></td><td>데이터 압축 및 직렬화</td><td>압축으로 인한 CPU 오버헤드</td><td>압축 비율과 성능의 균형점 찾기</td></tr><tr><td><strong>캐싱 전략</strong></td><td>중간 결과 캐싱</td><td>캐시 무효화 및 일관성 문제</td><td>TTL 기반 캐시 및 이벤트 기반 무효화</td></tr><tr><td><strong>확장성</strong></td><td>수평 확장 설계</td><td>상태를 가진 필터의 확장 어려움</td><td>무상태 필터 설계 및 외부 상태 저장소 활용</td></tr></tbody></table><h2 id=8-추가로-알아야-할-내용>8. 추가로 알아야 할 내용<a hidden class=anchor aria-hidden=true href=#8-추가로-알아야-할-내용>#</a></h2><ul><li><strong>데이터 플로우 아키텍처와 마이크로서비스 아키텍처의 차이점</strong></li><li><strong>데이터 플로우 아키텍처에서의 에러 처리 및 복구 메커니즘</strong></li><li><strong>실시간 데이터 처리에서의 성능 최적화 기법</strong></li></ul><h2 id=9-주제와-관련하여-주목할-내용>9. 주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#9-주제와-관련하여-주목할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>소프트웨어 아키텍처</td><td>데이터 플로우 아키텍처</td><td>모듈화</td><td>각 필터는 독립적으로 개발·테스트·배포 가능</td></tr><tr><td>소프트웨어 아키텍처</td><td>데이터 플로우 아키텍처</td><td>확장성</td><td>새로운 필터 추가 및 기존 필터 변경이 쉬움</td></tr><tr><td>실시간 처리</td><td>데이터 플로우 아키텍처</td><td>스트리밍</td><td>실시간 데이터 처리에 적합</td></tr><tr><td>분산 시스템</td><td>데이터 플로우 아키텍처</td><td>병렬 처리</td><td>여러 필터를 분산 환경에 배치하여 병렬 처리</td></tr></tbody></table><h2 id=17-주제와-관련하여-주목할-내용>17. 주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#17-주제와-관련하여-주목할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>구조</td><td>패턴</td><td>Pipe-and-Filter</td><td>모듈 간 결합도를 낮추고 독립성을 높이는 핵심 아키텍처 스타일</td></tr><tr><td>성능</td><td>병렬성</td><td>Token 기반 처리</td><td>데이터 기반으로 실행되어 자연스럽게 병렬 처리 가능</td></tr><tr><td>확장성</td><td>하이브리드 모델</td><td>Lambda/Kappa</td><td>정확성과 실시간성을 균형 있게 통합하는 구조</td></tr><tr><td>운영</td><td>오케스트레이션</td><td>Airflow, NiFi</td><td>복잡한 파이프라인 스케줄링 및 모니터링 자동화</td></tr><tr><td>품질</td><td>Idempotency</td><td>재실행 안정성</td><td>중복 실행에도 동일 결과 보장하는 안전한 처리 구조</td></tr><tr><td>보안</td><td>데이터 흐름 보안</td><td>Encryption, Access Control</td><td>파이프 전 구간의 데이터 보호와 접근 제어</td></tr></tbody></table><h2 id=7-주제와-관련하여-주목할-내용>7. 주제와 관련하여 주목할 내용<a hidden class=anchor aria-hidden=true href=#7-주제와-관련하여-주목할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>최신 기술</td><td>클라우드 네이티브</td><td>Kubernetes 기반 배포</td><td>컨테이너화된 필터의 자동 확장 및 관리</td></tr><tr><td>최신 기술</td><td>서버리스 아키텍처</td><td>Function-as-a-Service</td><td>이벤트 기반 필터 실행으로 비용 최적화</td></tr><tr><td>최신 기술</td><td>엣지 컴퓨팅</td><td>분산 데이터 처리</td><td>네트워크 지연 감소 및 대역폭 절약</td></tr><tr><td>AI/ML 통합</td><td>자동 최적화</td><td>머신러닝 기반 튜닝</td><td>실시간 성능 데이터 기반 자동 파라미터 조정</td></tr><tr><td>AI/ML 통합</td><td>지능형 라우팅</td><td>예측 기반 부하 분산</td><td>과거 패턴 분석을 통한 효율적 데이터 라우팅</td></tr><tr><td>보안</td><td>데이터 암호화</td><td>파이프라인 내 암호화</td><td>데이터 전송 및 저장 시 보안 강화</td></tr><tr><td>보안</td><td>접근 제어</td><td>필터별 권한 관리</td><td>세밀한 권한 제어를 통한 보안 강화</td></tr><tr><td>성능</td><td>백프레셔 제어</td><td>적응형 흐름 제어</td><td>처리 속도 차이에 따른 동적 조절</td></tr><tr><td>성능</td><td>지연 최적화</td><td>제로카피 데이터 전송</td><td>메모리 복사 없는 데이터 전달로 성능 향상</td></tr></tbody></table><h2 id=8-반드시-학습해야-할-내용>8. 반드시 학습해야 할 내용<a hidden class=anchor aria-hidden=true href=#8-반드시-학습해야-할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>기초 이론</td><td>아키텍처 패턴</td><td>파이프라인 패턴</td><td>데이터 변환 단계의 연결 방법</td></tr><tr><td>기초 이론</td><td>동시성 프로그래밍</td><td>비동기 처리</td><td>독립적 필터 실행을 위한 동시성 기법</td></tr><tr><td>기초 이론</td><td>데이터 구조</td><td>큐와 스트림</td><td>파이프 구현을 위한 기본 자료구조</td></tr><tr><td>구현 기술</td><td>메시지 큐</td><td>Apache Kafka, RabbitMQ</td><td>분산 파이프라인 구현을 위한 메시징</td></tr><tr><td>구현 기술</td><td>스트림 처리</td><td>Apache Flink, Spark Streaming</td><td>실시간 데이터 처리 프레임워크</td></tr><tr><td>구현 기술</td><td>컨테이너화</td><td>Docker, Kubernetes</td><td>필터의 독립적 배포 및 확장</td></tr><tr><td>모니터링</td><td>관찰가능성</td><td>로깅, 메트릭, 추적</td><td>분산 시스템의 상태 파악</td></tr><tr><td>모니터링</td><td>성능 측정</td><td>처리량, 지연시간 측정</td><td>시스템 성능 평가 지표</td></tr><tr><td>설계 원칙</td><td>SOLID 원칙</td><td>단일 책임, 개방 - 폐쇄</td><td>유지보수 가능한 필터 설계</td></tr><tr><td>설계 원칙</td><td>분산 시스템</td><td>CAP 정리, BASE</td><td>분산 환경에서의 일관성 관리</td></tr></tbody></table><h2 id=18-반드시-학습해야-할-내용>18. 반드시 학습해야 할 내용<a hidden class=anchor aria-hidden=true href=#18-반드시-학습해야-할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>기본 원리</td><td>Data‑Driven Execution</td><td>데이터 도착에 따라 처리 순서 결정</td><td>전통적 제어 흐름과 구분되는 핵심 실행 모델</td></tr><tr><td>패턴 이해</td><td>Batch Sequential / Stream Processing</td><td>두 가지 주요 흐름 형태</td><td>유형별로 사용 시나리오와 장단점 다름</td></tr><tr><td>응용 기술</td><td>Kafka, Spark, Flink</td><td>Data‑Flow 구현에 사용되는 실무 도구</td><td>스트림과 배치를 함께 다룰 수 있음</td></tr><tr><td>성능 관리</td><td>Checkpointing & Replay</td><td>중단 대비 복구 메커니즘</td><td>장애 발생 시 처리 재시작 기반</td></tr><tr><td>운영 도구</td><td>Dagster / Airflow / NiFi</td><td>워크플로우 구성 도구</td><td>실제 구현과 유지관리 시 필수</td></tr><tr><td>보안 및 감사</td><td>Lineage / Data Contracts</td><td>데이터 흐름 추적 및 정의 계약</td><td>데이터 신뢰성과 컴플라이언스 확보</td></tr></tbody></table><h2 id=10-반드시-학습해야할-내용>10. 반드시 학습해야할 내용<a hidden class=anchor aria-hidden=true href=#10-반드시-학습해야할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>소프트웨어 아키텍처</td><td>데이터 플로우 아키텍처</td><td>파이프와 필터</td><td>데이터 흐름 중심의 설계 원리</td></tr><tr><td>실시간 처리</td><td>데이터 플로우 아키텍처</td><td>스트리밍 시스템</td><td>실시간 데이터 처리 방법</td></tr><tr><td>분산 시스템</td><td>데이터 플로우 아키텍처</td><td>분산 처리</td><td>필터 분산 및 병렬 처리 기법</td></tr><tr><td>에러 처리</td><td>데이터 플로우 아키텍처</td><td>복구 메커니즘</td><td>데이터 손실 및 에러 처리 방법</td></tr></tbody></table><h2 id=15-추가로-학습해야-할-내용>15. 추가로 학습해야 할 내용<a hidden class=anchor aria-hidden=true href=#15-추가로-학습해야-할-내용>#</a></h2><table><thead><tr><th>카테고리</th><th>주제</th><th>항목</th><th>설명</th></tr></thead><tbody><tr><td>Data Governance</td><td>Data Lineage</td><td>출처 추적</td><td>Data‑Flow 에서 lineage 구현 및 디버깅 이해 (<a href="https://en.wikipedia.org/wiki/Data_lineage?utm_source=chatgpt.com" title="Data lineage">en.wikipedia.org</a>, <a href="https://www.geeksforgeeks.org/data-pipeline-design-patterns-system-design/?utm_source=chatgpt.com" title="Data Pipeline Design Patterns–System Design | GeeksforGeeks">geeksforgeeks.org</a>, <a href="https://www.cs.cmu.edu/~15740-f20/lectures/15-dataflow.pdf?utm_source=chatgpt.com" title="[PDF] Dataflow Architecture: Pure, Hybrid, and Spatial">cs.cmu.edu</a>)</td></tr><tr><td>Fault Tolerance</td><td>Exactly-once 처리</td><td>Idempotency & ACK</td><td>스트림 중복·누락 제어 기법 이해</td></tr><tr><td>CI/CD</td><td>Pipeline 배포 자동화</td><td>Terraform, Helm</td><td>아키텍처 코드화 및 무중단 배포</td></tr><tr><td>Security</td><td>데이터 보호 및 접근 제어</td><td>Encryption, ACL</td><td>파이프 전 구간 데이터 보안 설계</td></tr></tbody></table><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>소프트웨어 아키텍처</td><td>필터 (Filter)</td><td>데이터를 변환 또는 처리하는 모듈</td></tr><tr><td>소프트웨어 아키텍처</td><td>파이프 (Pipe)</td><td>필터 간 데이터를 전달하는 채널</td></tr><tr><td>분산 시스템</td><td>분산 처리 (Distributed Processing)</td><td>여러 시스템에 작업을 분산하여 처리</td></tr><tr><td>실시간 처리</td><td>스트리밍 (Streaming)</td><td>데이터를 실시간으로 처리 및 전송</td></tr></tbody></table><h2 id=용어-정리-1>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-1>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>기본 개념</td><td>Pipe‑and‑Filter</td><td>데이터가 연속적으로 작은 필터 컴포넌트를 지나며 처리되는 아키텍처 구조</td></tr><tr><td>기본 개념</td><td>Batch Sequential</td><td>배치 단위로 순차 처리되는 데이터 플로우 방식</td></tr><tr><td>기본 개념</td><td>Process Control</td><td>처리 유닛과 제어 유닛이 분리된 실시간 제어 중심 구조</td></tr><tr><td>관련 패턴</td><td>Dataflow architecture</td><td>자료 흐름에 따라 시스템 실행이 결정되는 컴퓨터 아키텍처 (<a href="https://www.geeksforgeeks.org/data-pipeline-design-patterns-system-design/?utm_source=chatgpt.com" title="Data Pipeline Design Patterns–System Design | GeeksforGeeks">airbyte.com</a>)</td></tr><tr><td>관련 패턴</td><td>Stream Processing</td><td>실시간 데이터 흐름 처리 모델, Pipe‑and‑Filter 기반</td></tr><tr><td>관련 패턴</td><td>Lambda Architecture</td><td>배치 + 스트림 결합 아키텍처 (<a href="https://www.geeksforgeeks.org/data-pipeline-design-patterns-system-design/?utm_source=chatgpt.com" title="Data Pipeline Design Patterns–System Design | GeeksforGeeks">airbyte.com</a>)</td></tr></tbody></table><h2 id=16-용어-정리>16. 용어 정리<a hidden class=anchor aria-hidden=true href=#16-용어-정리>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>아키텍처</td><td>Batch Sequential</td><td>배치 단위로 순차 처리하는 Data‑Flow 형태</td></tr><tr><td>아키텍처</td><td>Pipe-and-Filter</td><td>필터 컴포넌트를 파이프라인으로 연결해 데이터 처리</td></tr><tr><td>아키텍처</td><td>Process Control</td><td>제어 장치와 처리 유닛을 분리한 실시간 제어 구조</td></tr><tr><td>모델</td><td>Lambda Architecture</td><td>배치 + 스트림 병행 모델로 정확도와 실시간성 보장</td></tr><tr><td>모델</td><td>Kappa Architecture</td><td>스트림 중심 단일 모델, 스트림 및 리플레이 수행</td></tr><tr><td>개념</td><td>Idempotency</td><td>중복 실행되어도 결과 동일한 처리 특성</td></tr><tr><td>도구</td><td>Orchestration</td><td>파이프라인 작업 스케줄링 및 종속성 관리 도구</td></tr></tbody></table><h2 id=용어-정리-2>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리-2>#</a></h2><table><thead><tr><th>카테고리</th><th>용어</th><th>설명</th></tr></thead><tbody><tr><td>핵심 개념</td><td>필터 (Filter)</td><td>입력 데이터를 변환하여 출력하는 독립적인 처리 단위</td></tr><tr><td>핵심 개념</td><td>파이프 (Pipe)</td><td>필터 간 데이터 전송을 담당하는 연결체 또는 채널</td></tr><tr><td>핵심 개념</td><td>데이터 싱크 (Data Sink)</td><td>파이프라인의 최종 출력을 받는 목적지</td></tr><tr><td>핵심 개념</td><td>데이터 소스 (Data Source)</td><td>파이프라인의 입력 데이터를 제공하는 원천</td></tr><tr><td>처리 방식</td><td>백프레셔 (Backpressure)</td><td>하위 구성요소의 처리 속도가 느려 상위로 압박이 전달되는 현상</td></tr><tr><td>처리 방식</td><td>파이프라이닝 (Pipelining)</td><td>여러 처리 단계가 동시에 서로 다른 데이터를 처리하는 기법</td></tr><tr><td>처리 방식</td><td>스트림 처리 (Stream Processing)</td><td>연속적으로 유입되는 데이터를 실시간으로 처리하는 방식</td></tr><tr><td>처리 방식</td><td>배치 처리 (Batch Processing)</td><td>일정량의 데이터를 모아서 한 번에 처리하는 방식</td></tr><tr><td>아키텍처</td><td>람다 아키텍처 (Lambda Architecture)</td><td>배치와 스트림 처리를 결합한 하이브리드 아키텍처</td></tr><tr><td>아키�ecture</td><td>카파 아키텍처 (Kappa Architecture)</td><td>스트림 처리만을 사용하는 단순화된 아키텍처</td></tr><tr><td>기술 구현</td><td>ETL (Extract, Transform, Load)</td><td>데이터 추출, 변환, 적재의 순서로 진행되는 데이터 처리</td></tr><tr><td>기술 구현</td><td>ELT (Extract, Load, Transform)</td><td>데이터 추출, 적재, 변환의 순서로 진행되는 데이터 처리</td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2><ul><li><a href=https://www.tutorialspoint.com/software_architecture_design/data_flow_architecture.htm>Data Flow Architecture - TutorialsPoint</a></li><li><a href=https://www.startdataengineering.com/post/design-patterns/>Data Pipeline Design Patterns - Start Data Engineering</a></li><li><a href=https://www.geeksforgeeks.org/software-engineering-architectural-design/>Architectural Design - Software Engineering - GeeksforGeeks</a></li><li><a href=https://airbyte.com/data-engineering-resources/data-flow-architecture>What Is Data Flow Architecture - Airbyte</a></li><li><a href=https://www.tutorialride.com/software-architecture-and-design/data-flow-architecture.htm>Data Flow Architecture - Tutorial Ride</a></li><li><a href=https://www.geeksforgeeks.org/pipe-and-filter-architecture-system-design/>Pipe and Filter Architecture - System Design - GeeksforGeeks</a></li><li><a href=https://learn.microsoft.com/en-us/azure/architecture/patterns/pipes-and-filters>Pipes and Filters pattern - Azure Architecture Center</a></li><li><a href=https://www.astera.com/type/blog/etl-batch-processing/>Understanding ETL Batch Processing - Astera</a></li><li><a href=https://en.wikipedia.org/wiki/Extract,_transform,_load>Extract, transform, load - Wikipedia</a></li><li><a href=https://www.geeksforgeeks.org/real-time-operating-system-rtos/>Real-Time Operating System (RTOS) - GeeksforGeeks</a></li><li><a href=https://sam-solutions.com/blog/real-time-embedded-systems/>Real-Time Embedded Systems - SaM Solutions</a></li><li><a href=https://en.wikipedia.org/wiki/Dataflow_architecture>Dataflow architecture - Wikipedia</a></li></ul><h2 id=참고-및-출처-1>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-1>#</a></h2><ul><li>Dagster–Data Pipeline Design Patterns (<a href="https://airbyte.com/data-engineering-resources/data-flow-architecture?utm_source=chatgpt.com" title="What Is Data Flow Architecture: Behind-the-Scenes & Examples">airbyte.com</a>, <a href="https://dagster.io/guides/data-pipeline/data-pipeline-architecture-5-design-patterns-with-examples?utm_source=chatgpt.com" title="Data Pipeline Architecture: 5 Design Patterns with Examples - Dagster">dagster.io</a>)</li><li>Tutorialspoint–Data Flow Architecture 장점 (<a href="https://www.tutorialspoint.com/software_architecture_design/data_flow_architecture.htm?utm_source=chatgpt.com" title="Data Flow Architecture - Tutorials Point">tutorialspoint.com</a>)</li><li>Airbyte–Data Flow Architecture 유형 및 장단점 (<a href="https://airbyte.com/data-engineering-resources/data-flow-architecture?utm_source=chatgpt.com" title="What Is Data Flow Architecture: Behind-the-Scenes & Examples">airbyte.com</a>)</li><li>GeeksforGeeks–Data Pipeline Patterns (<a href="https://www.geeksforgeeks.org/data-pipeline-design-patterns-system-design/?utm_source=chatgpt.com" title="Data Pipeline Design Patterns–System Design | GeeksforGeeks">geeksforgeeks.org</a>)</li><li>CS.CMU–Pure Dataflow 하드웨어 관점 (<a href="https://www.cs.cmu.edu/~15740-f20/lectures/15-dataflow.pdf?utm_source=chatgpt.com" title="[PDF] Dataflow Architecture: Pure, Hybrid, and Spatial">cs.cmu.edu</a>)</li><li>Wikipedia–Dataflow Architecture 특징 (<a href="https://en.wikipedia.org/wiki/Dataflow_architecture?utm_source=chatgpt.com" title="Dataflow architecture">en.wikipedia.org</a>)</li><li>Wikipedia–Data Lineage (<a href="https://en.wikipedia.org/wiki/Data_lineage?utm_source=chatgpt.com" title="Data lineage">en.wikipedia.org</a>)</li></ul><h2 id=참고-및-출처-2>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-2>#</a></h2><ul><li>Data‑Flow 개념 및 세 가지 형태 설명 (<a href="https://en.wikipedia.org/wiki/Dataflow_architecture?utm_source=chatgpt.com" title="Dataflow architecture">en.wikipedia.org</a>)</li><li>장단점, 병렬성 및 실행 방식</li><li>Dataflow architecture vs von Neumann 구조 비교 (<a href="https://www.educba.com/data-flow-architecture/?utm_source=chatgpt.com" title="Modules & Components of Data Flow Architecture - EDUCBA">en.wikipedia.org</a>)</li></ul><h2 id=참고-및-출처-3>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처-3>#</a></h2><ul><li><a href=https://en.wikipedia.org/wiki/Dataflow>Data Flow Architecture – Wikipedia</a></li><li><a href=https://www.oreilly.com/library/view/software-architecture-patterns/9781491971437/ch01.html>Pipe and Filter Architecture – O’Reilly</a></li><li><a href=https://martinfowler.com/articles/dataflow.html>Dataflow Programming – Martin Fowler</a></li></ul><hr></div><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Styles</h2></header><div class=entry-content><p>Styles Batch Sequential, Pipe and Filter, Process Control 은 소프트웨어 아키텍처에서 데이터 흐름 (Data-Flow) 을 중심으로 시스템을 설계하는 대표적인 스타일이다. Batch Sequential 은 일괄 처리, Pipe and Filter 는 연속적 데이터 변환, Process Control 은 실시간 제어 및 피드백에 적합하다. 각각의 구조, 구성 요소, 작동 원리, 장단점, 실무 적용 시 고려사항을 이해하면 다양한 시스템 요구에 맞는 최적의 아키텍처를 설계할 수 있다.
핵심 개념 항목 Batch Sequential Pipe and Filter Process Control 핵심 개념 전체 데이터를 일괄 처리하고 순차적으로 모듈 실행 데이터를 연속적으로 처리하며 필터 간 파이프를 통해 전달 출력 결과를 입력으로 피드백하여 실시간 제어 수행 처리 단위 배치 단위 데이터 집합 필터 (Filter) 단위의 증분 처리 제어 단위 (센서 + 컨트롤러 + 액추에이터) 데이터 흐름 단방향, 고정된 순서의 처리 흐름 연속적 스트림 처리 (Pull 또는 Push) 루프 기반의 순환 흐름 (Feedback Loop) 동작 방식 각 단계가 완전히 종료된 후 다음 단계 실행 각 필터가 독립적으로 병렬 실행 가능 실시간 감지 → 조정 → 피드백 → 반영 반복 상태성 보통 상태 없음 (Stateless), 단계별 상태는 파일로 유지 무상태 필터 기반 처리 또는 선택적 상태 유지 가능 상태 기반 처리 필수 (시스템 상태 지속 추적) 컴포넌트 간 연결 방식 중간 파일, 큐, 임시 저장소 등 간접 연결 파이프 (Pipe) 를 통한 직접 연결 센서, 액추에이터, 컨트롤러 간 밀접 연결 병렬성 및 확장성 병렬 처리 어려움, 순차 구조 병렬성 우수, 필터 단위 확장 가능 병렬성 제한적, 실시간 응답성과 안정성이 중요 기술 예시 Airflow, Spring Batch, cron 기반 ETL Kafka, Flink, GStreamer, Unix Pipe (`cat grep 실무 적용 분야 ETL 파이프라인 - 금융 일마감 처리 - 로그 집계 - 실시간 스트리밍 파이프라인 - 미디어 변환 - 컴파일러 (프론트엔드 처리) - 임베디드 시스템 제어 IoT 자동화 - 클라우드 오토스케일링 시스템 장점 단순 명확한 처리, 디버깅 용이 모듈화, 병렬성, 재사용성, 스트림 처리 적합 실시간 제어, 동적 적응력, 외부 환경 대응 가능 단점 지연 큼, 실시간성 부족, 병목 발생 가능 복잡한 필터 설계 필요, 상태 공유 어려움 복잡한 제어 설계 필요, 높은 실시간성 요구 Batch Sequential: 전통적 일괄 처리 구조. 단순하고 명확하지만 실시간성 부족. ETL, 로그 처리 등 대량 데이터를 주기적으로 처리할 때 적합. Pipe and Filter: 유연하고 모듈화된 스트림 중심 아키텍처. 컴포넌트 재사용성과 병렬성 뛰어나며, 데이터 스트리밍/컴파일러 등 실시간 처리에 적합. Process Control: 물리 시스템이나 제어 시스템에 필수. 상태 기반의 피드백 구조로, 실시간 반응성과 지속적인 조정이 필요한 환경에 이상적. Batch Sequential vs. Pipe and Filter vs. Process Control 비교 항목 Batch Sequential Pipe and Filter Process Control 데이터 처리 방식 일괄 처리 (Batch) 스트림 단위의 점진적 처리 센서 기반 실시간 데이터 감지 및 제어 처리 흐름 제어 단계별 순차 실행 (Strict Order) 필터 독립 실행, 파이프 연결 (Loosely Coupled) 지속적 피드백 루프 기반 제어 동시성 및 실행 모델 순차적 실행만 가능 필터 단위 병렬 처리 가능 실시간 제어 루프 → 제한적 동시성 주요 구성 요소 배치 모듈, 스케줄러, 중간 저장소 (파일/DB 등) 필터 (Filter), 파이프 (Pipe), 스트림 큐 센서, 컨트롤러, 액추에이터 데이터 흐름 방향 일방향 (One-way) 일방향 스트림 처리 (Stream Push/Pull) 양방향 (센서 입력 → 제어 출력 → 피드백) 상태 관리 대부분 무상태 (Stateless), 파일 기반 중간 상태 유지 대부분 무상태, 필요 시 로컬 상태 유지 가능 상태 기반 필수 (센서값 기반 처리 상태 유지) 지연 시간 (Latency) 높음 (일괄 처리 후 전달) 낮음 (도착 즉시 처리) 매우 낮음 (즉시 제어 반응) 처리량 (Throughput) 낮음 (단계 간 대기 시간 존재) 높음 (병렬 필터 구성 가능) 중간 (I/O 와 센서 반응 속도에 따라 달라짐) 확장성 (Scalability) 제한적 (스케일 아웃 어려움) 높음 (필터 단위 수평 확장 용이) 구조적 제약으로 제한적 유지보수성 높음 (단계별 모듈 분리, 디버깅 쉬움) 높음 (모듈화 구조, 필터 재사용 가능) 낮음~중간 (센서/제어 로직 디버깅 복잡) 오류 처리 및 복구 단순 (실패 시 배치 전체 재처리 가능) 복잡 (스트림 상태 기반 오류 처리 필요) 매우 복잡 (센서 신호 오류, 루프 불안정 등 실시간 복구 필요) 적용 분야 - 데이터 웨어하우스 정산
- 보고서 생성
- 일간/월간 배치 작업 - 로그 처리 파이프라인
- 미디어 변환 시스템
- 컴파일러 (전처리~코드생성) - 임베디드 시스템
- IoT 디바이스
- 공정 자동화 및 실시간 모니터링 시스템 대표 구현 기술 Airflow, Spring Batch, CRON Apache Kafka, Apache Flink, Unix Pipeline, GStreamer RTOS, PID/Kalman Filter, ROS, MQTT, Arduino 설계 및 구현 난이도 낮음 (구현 구조 단순) 중간 (병렬 구조, backpressure 등 고려 필요) 높음 (실시간 제어 알고리즘과 장치 제어 설계 필요) 최적화 포인트 배치 주기 조정, 병렬 배치 설계, 디스크 I/O 최적화 backpressure 조정, 병렬 필터 구성, 메시지 처리량 최적화 루프 주기 튜닝, 센서 정확도 향상, 실시간 스케줄링 강점과 약점 비교 구분 Batch Sequential Pipe and Filter Process Control 강점 • 단순하고 안정적인 구조• 독립적인 모듈 테스트• 높은 신뢰성• 명확한 데이터 추적 • 높은 모듈화와 재사용성• 동시 처리로 높은 처리량• 유연한 파이프라인 구성• 증분 처리 가능 • 실시간 적응 능력• 외부 변화에 동적 대응• 안정적인 출력 유지• 자동 조정 기능 약점 • 높은 지연시간• 동시성 부족• 상호작용 불가• 실시간 처리 어려움 • 동적 상호작용 제한• 데이터 형식 표준화 필요• 동적 구성 어려움• 오류 전파 위험 • 높은 구현 복잡성• 예측 불가능한 동작• 디버깅 어려움• 안정성 보장 어려움 핵심 차이점 요약 기준 Batch Sequential Pipe and Filter Process Control 시간 흐름 느림 (대기 후 일괄) 중간 (지연 허용) 빠름 (즉시 제어 필요) 병렬성 없음 우수 (필터 단위) 제한적 (제어 루프) 복잡도 낮음 중간 높음 실무 적용 우선순위 데이터 분석/정산 스트리밍 처리/ETL 실시간 제어/IoT 구조 및 아키텍처 Batch 는 정해진 순서대로 단계별 처리, Pipe-and-Filter 는 스트림 단위로 연속 처리, Process Control 은 피드백 루프를 통한 실시간 제어 구조이다.
...</p></div><footer class=entry-footer><span title='2025-07-14 04:17:00 +0000 UTC'>July 14, 2025</span>&nbsp;·&nbsp;16 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Styles" href=https://buenhyden.github.io/posts/software-design-and-architecture/architecture/data-architecture/data-flow-architecture/flow-styles/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Architectures</h2></header><div class=entry-content><p>Architectures Lambda Architecture(람다 아키텍처) 는 대용량 데이터의 정확한 분석을 위해 배치 처리와 실시간 스트림 처리를 결합한 구조로, 데이터의 신속한 처리와 정확한 결과를 동시에 제공한다. 반면 Kappa Architecture(카파 아키텍처) 는 모든 처리를 스트림 기반으로 단순화하여, 데이터 재처리와 시스템 유지보수를 용이하게 한다. 두 아키텍처는 빅데이터 환경에서 데이터 신뢰성, 확장성, 실시간성 확보를 위한 대표적인 설계 방식으로, 각각의 특징과 적용 환경에 따라 선택적으로 활용된다.
핵심 개념 Lambda Architecture 핵심 개념:
배치 계층 (Batch Layer): 대용량 히스토리컬 데이터를 정확하게 처리하는 불변 데이터 저장소 스피드 계층 (Speed Layer): 실시간 데이터 스트림을 낮은 지연시간으로 처리 서빙 계층 (Serving Layer): 배치와 스피드 계층의 결과를 통합하여 쿼리 서비스 제공 휴먼 내결함성 (Human Fault Tolerance): 코드 오류나 알고리즘 변경 시 히스토리컬 데이터 재처리 지원 Kappa Architecture 핵심 개념:
...</p></div><footer class=entry-footer><span title='2025-07-14 04:16:00 +0000 UTC'>July 14, 2025</span>&nbsp;·&nbsp;12 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Architectures" href=https://buenhyden.github.io/posts/software-design-and-architecture/architecture/data-architecture/data-flow-architecture/data-processing-architectures/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Processing Types</h2></header><div class=entry-content><p>Processing Types 데이터 처리 방식은 시스템의 요구 사항에 따라 배치 (Batch), 스트림 (Stream), 하이브리드 (Hybrid) 로 구분된다. Batch Processing 은 데이터의 대량 집계와 정확성에 적합하고, Stream Processing 은 실시간 응답성과 낮은 지연 시간에 유리하다. Hybrid Processing 은 Lambda Architecture 처럼 두 방식을 조합해 실시간성과 정확성을 모두 확보하려는 전략이다. 각각은 처리량, 지연 시간, 아키텍처 복잡도 등에서 상호 보완적이며, 시스템 목적에 따라 선택 또는 병행된다.
핵심 개념 Batch는 대용량 데이터를 정확하게 처리하고, 일정 간격으로 분석과 보고서를 생성하는 데 적합하다. Stream은 지연 없이 이벤트를 실시간 처리하고, 즉시 반응해야 하는 시스템에 사용된다. Hybrid는 두 방식의 강점을 조합하여, 실시간성과 정합성이 모두 중요한 복잡한 비즈니스 도메인에서 사용된다.
예: 이상 탐지, 실시간 사용자 분석, 추천 시스템 등. 구분 Batch Processing Stream Processing Hybrid Processing 정의 일정량의 데이터를 모아서 일괄 처리 데이터가 생성되는 즉시 실시간으로 처리 배치와 스트림 방식을 병행하여 처리 지향점 정확성, 정합성 중심 실시간성, 즉시 반응 중심 정확성과 실시간성의 균형 처리 방식 고정 주기 실행 (예: 하루 1 회) 이벤트 기반으로 연속 처리 배치 레이어 + 스피드 레이어 (Lambda) / 통합 레이어 (Kappa) 주요 특징 지연 허용, 대용량 처리, 분석 최적화 낮은 지연, 빠른 대응, 상태 기반 처리 가능 복합적 요구 대응, 운영 복잡도 증가 활용 분야 리포트 생성, ETL, 통계 분석 실시간 알림, 이상 탐지, 모니터링 금융 거래 분석, 사용자 행동 예측, 마케팅 실시간 반응 시스템 등 실무 기술 스택 매핑 구성 요소 Batch Stream Hybrid (Lambda/Kappa) 엔진 Apache Spark, Hadoop MapReduce, Hive Apache Flink, Kafka Streams, Spark Streaming Lambda: Spark + Storm / Kappa: Flink 단독 사용 메시징 시스템 Kafka, Amazon Kinesis Kafka, Pulsar, RabbitMQ Kafka (공통 메시지 버퍼링), Kinesis 저장소 HDFS, Amazon S3, RDBMS NoSQL, Elasticsearch, Redis 데이터 레이크 + 실시간 인덱싱 레이어 스케줄링 Airflow, Oozie Kafka Consumer, Flink Job 조합: Airflow + Flink / Kappa 구조에서는 Flink 단독 사용 서빙 레이어 Presto, Druid, BI 도구 Redis, Elasticsearch Redis + Druid/ES 통합 서빙 실무 적용 사례 및 고려 사항 구분 적용 사례 처리 우선순위 적합성 설명 Batch 월간 리포트 생성, 로그 정제 및 보관 정합성 우선 대량 데이터 처리에 적합하며, 처리 지연 허용 가능 Stream 실시간 트래픽 분석, 센서 데이터 모니터링 반응 속도 우선 지연이 적고 상태 기반 처리가 필요한 실시간 이벤트 처리에 적합 Hybrid 광고 클릭 분석, 이상 금융 거래 탐지 정합성 + 실시간성 정확성과 즉시 반응이 동시에 필요한 복합적 시스템에 최적화 하위 처리 기준 비교 기준 Batch Stream Hybrid 지연 허용 여부 있음 (분 ~ 시 단위) 없음 (ms ~ s 단위) 부분 허용 정확성 ✅ ❌ ✅ 실시간성 ❌ ✅ ✅ 구현 복잡도 낮음 보통 높음 운영 복잡도 단순 보통 복잡 아키텍처 연계 요약 처리 방식 연계 아키텍처 설명 Batch ETL Pipeline, Data Warehouse 데이터 수집 → 변환 → 적재 → 분석 (정기적 리포트 등) Stream Event-Driven, Reactive 실시간 이벤트 수신 및 처리, CEP 등 이벤트 흐름 중심 구조 Hybrid Lambda, Kappa Architecture Lambda: 배치 + 스피드 레이어 / Kappa: 단일 스트림 기반 배치 + 실시간 통합 구조 Batch Processing vs. Stream Processing vs. Hybrid Processing 비교 각 처리 방식은 데이터의 시간적 특성과 비즈니스 요구사항에 따라 선택된다. 배치 처리는 정확성과 효율성을, 스트림 처리는 실시간성과 반응성을, 하이브리드 처리는 두 방식의 균형을 추구한다.
...</p></div><footer class=entry-footer><span title='2025-07-14 04:16:00 +0000 UTC'>July 14, 2025</span>&nbsp;·&nbsp;19 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Processing Types" href=https://buenhyden.github.io/posts/software-design-and-architecture/architecture/data-architecture/data-flow-architecture/processing-paradigms/></a></article></main><script type=module>
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>