<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Load Balancing | hyunyoun's Blog</title>
<meta name=keywords content="Backend,API-Design,API-Performance,Load-Balancing"><meta name=description content="API 로드 밸런싱은 현대 웹 아키텍처와 분산 시스템의 필수적인 구성 요소로, 트래픽을 여러 서버에 효율적으로 분산하여 성능, 가용성, 안정성을 극대화한다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/backend/performance-optimization/load-balancing-and-scaling/load-balancing/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/backend/performance-optimization/load-balancing-and-scaling/load-balancing/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/backend/performance-optimization/load-balancing-and-scaling/load-balancing/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Load Balancing"><meta property="og:description" content="API 로드 밸런싱은 현대 웹 아키텍처와 분산 시스템의 필수적인 구성 요소로, 트래픽을 여러 서버에 효율적으로 분산하여 성능, 가용성, 안정성을 극대화한다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-13T01:30:00+00:00"><meta property="article:modified_time" content="2025-02-13T01:30:00+00:00"><meta property="article:tag" content="Backend"><meta property="article:tag" content="API-Design"><meta property="article:tag" content="API-Performance"><meta property="article:tag" content="Load-Balancing"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Load Balancing"><meta name=twitter:description content="API 로드 밸런싱은 현대 웹 아키텍처와 분산 시스템의 필수적인 구성 요소로, 트래픽을 여러 서버에 효율적으로 분산하여 성능, 가용성, 안정성을 극대화한다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"기술 블로그","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Backend","item":"https://buenhyden.github.io/posts/backend/"},{"@type":"ListItem","position":3,"name":"Performance Optimization","item":""},{"@type":"ListItem","position":4,"name":"Load Balancing and Scaling","item":"https://buenhyden.github.io/posts/backend/performance-optimization/load-balancing-and-scaling/"},{"@type":"ListItem","position":5,"name":"Load Balancing","item":"https://buenhyden.github.io/posts/backend/performance-optimization/load-balancing-and-scaling/load-balancing/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Load Balancing","name":"Load Balancing","description":"API 로드 밸런싱은 현대 웹 아키텍처와 분산 시스템의 필수적인 구성 요소로, 트래픽을 여러 서버에 효율적으로 분산하여 성능, 가용성, 안정성을 극대화한다.","keywords":["Backend","API-Design","API-Performance","Load-Balancing"],"articleBody":"Load Balancing API 로드 밸런싱은 현대 웹 아키텍처와 분산 시스템의 필수적인 구성 요소로, 트래픽을 여러 서버에 효율적으로 분산하여 성능, 가용성, 안정성을 극대화한다.\nAPI 로드 밸런싱의 기본 개념 로드 밸런싱은 들어오는 네트워크 트래픽을 여러 서버에 분산하는 프로세스로, 단일 서버의 과부하를 방지하고 애플리케이션의 응답성과 가용성을 향상시킨다. API 컨텍스트에서 로드 밸런싱은 특히 중요한데, API가 종종 높은 동시 요청 수와 일관된 응답 시간을 유지해야 하는 미션 크리티컬한 애플리케이션의 기반이 되기 때문이다.\n로드 밸런싱이 필요한 이유 성능 최적화: 여러 서버에 부하를 분산하여 응답 시간을 최소화한다. 고가용성: 서버 장애 시에도 서비스 중단 없이 트래픽을 다른 정상 서버로 리디렉션한다. 확장성: 수요 증가에 따라 서버를 추가하고 부하 분산 풀에 통합할 수 있다. 유연성: 서버 유지보수를 위해 일부 서버를 오프라인으로 전환하고 나머지 서버로 트래픽을 라우팅할 수 있다. 효율성: 자원 활용도를 최적화하여 비용을 절감한다. 로드 밸런싱의 유형 API 로드 밸런싱은 여러 수준에서 구현될 수 있다:\nL4(전송 계층) 로드 밸런싱: IP 주소와 포트 정보를 기반으로 트래픽 분산 패킷 내용을 검사하지 않고 빠른 처리 가능 TCP/UDP 레벨에서 작동 L7(애플리케이션 계층) 로드 밸런싱: HTTP 헤더, 쿠키, URL 등 애플리케이션 레벨 데이터 기반 라우팅 더 지능적인 라우팅 결정 가능 콘텐츠 기반 라우팅 지원 (예: 특정 API 엔드포인트를 특정 서버로 라우팅) 글로벌 서버 로드 밸런싱(GSLB): 지리적으로 분산된 서버 간에 트래픽 분산 사용자와 가장 가까운 데이터 센터로 라우팅 지역 서버 장애 시 자동 페일오버 제공 로드 밸런싱 알고리즘 적절한 로드 밸런싱 알고리즘 선택은 API 성능에 큰 영향을 미친다.\n주요 알고리즘은 다음과 같다:\n라운드 로빈(Round Robin) 각 서버에 순차적으로 요청을 분배하는 가장 단순한 방식.\n1 2 3 4 5 6 7 8 9 # 라운드 로빈 알고리즘의 의사 코드 servers = [\"server1\", \"server2\", \"server3\", \"server4\"] current_index = 0 def get_next_server(): global current_index server = servers[current_index] current_index = (current_index + 1) % len(servers) return server 장점: 구현이 간단하고 모든 서버가 동일한 사양일 때 효과적.\n단점: 서버 용량이나 현재 부하를 고려하지 않는다.\n가중 라운드 로빈(Weighted Round Robin) 각 서버에 가중치를 할당하여 더 강력한 서버가 더 많은 요청을 처리하도록 한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 # 가중 라운드 로빈 알고리즘의 의사 코드 servers = [ {\"name\": \"server1\", \"weight\": 5}, {\"name\": \"server2\", \"weight\": 3}, {\"name\": \"server3\", \"weight\": 2} ] def get_servers_by_weight(): weighted_servers = [] for server in servers: for i in range(server[\"weight\"]): weighted_servers.append(server[\"name\"]) return weighted_servers weighted_server_list = get_servers_by_weight() current_index = 0 def get_next_server(): global current_index server = weighted_server_list[current_index] current_index = (current_index + 1) % len(weighted_server_list) return server 장점: 서버 용량 차이를 고려한다.\n단점: 실제 서버 부하를 동적으로 반영하지 않는다.\n최소 연결(Least Connections) 현재 가장 적은 활성 연결을 가진 서버로 새 요청을 라우팅한다.\n1 2 3 4 5 6 7 8 9 # 최소 연결 알고리즘의 의사 코드 servers = [ {\"name\": \"server1\", \"active_connections\": 10}, {\"name\": \"server2\", \"active_connections\": 15}, {\"name\": \"server3\", \"active_connections\": 5} ] def get_server_with_least_connections(): return min(servers, key=lambda x: x[\"active_connections\"])[\"name\"] 장점: 서버 부하를 고려하여 더 효율적인 분배가 가능하다.\n단점: 연결 수가 항상 부하를 정확히 반영하지는 않는다.\nIP 해시(IP Hash) 클라이언트 IP 주소를 해싱하여 항상 동일한 서버로 요청을 라우팅한다.\n1 2 3 4 5 6 7 8 9 # IP 해시 알고리즘의 의사 코드 import hashlib servers = [\"server1\", \"server2\", \"server3\", \"server4\"] def get_server_for_ip(ip_address): hash_value = int(hashlib.md5(ip_address.encode()).hexdigest(), 16) server_index = hash_value % len(servers) return servers[server_index] 장점: 세션 유지에 유용하며 같은 클라이언트는 항상 같은 서버에 연결된다.\n단점: 트래픽이 고르게 분산되지 않을 수 있다.\n최소 응답 시간(Least Response Time) 응답 시간이 가장 짧은 서버로 요청을 라우팅한다.\n1 2 3 4 5 6 7 8 9 # 최소 응답 시간 알고리즘의 의사 코드 servers = [ {\"name\": \"server1\", \"response_time\": 120}, # 밀리초 {\"name\": \"server2\", \"response_time\": 95}, {\"name\": \"server3\", \"response_time\": 180} ] def get_server_with_least_response_time(): return min(servers, key=lambda x: x[\"response_time\"])[\"name\"] 장점: 실제 성능을 기반으로 가장 반응성 좋은 서버를 선택한다.\n단점: 응답 시간을 지속적으로 모니터링해야 하므로 오버헤드가 있다.\nAPI 로드 밸런싱 구현 방법 하드웨어 로드 밸런서 물리적 장치를 사용하여 트래픽을 분산한다.\n장점:\n높은 성능과 처리량 전용 하드웨어로 안정성 보장 종종 더 높은 보안 기능 제공 단점:\n비용이 높음 확장성 제한 유지보수가 복잡함 주요 제품: F5 BIG-IP, Citrix ADC, A10 Networks 등\n소프트웨어 로드 밸런서 소프트웨어 애플리케이션을 통해 트래픽을 분산한다.\n장점:\n비용 효율적 유연한 구성 클라우드 환경에 적합 단점:\n하드웨어 솔루션보다 성능이 낮을 수 있음 호스팅 서버의 리소스 사용 주요 제품: NGINX, HAProxy, Apache Traffic Server 등\n클라우드 기반 로드 밸런서 클라우드 제공업체의 관리형 로드 밸런싱 서비스를 활용한다.\n장점:\n관리 오버헤드 최소화 탄력적 확장성 자동 장애 조치 및 자동 확장 단점:\n클라우드 제공업체에 종속 커스터마이징 옵션이 제한적일 수 있음 주요 서비스: AWS Elastic Load Balancing, Google Cloud Load Balancing, Azure Load Balancer 등\n컨테이너 오케스트레이션 기반 로드 밸런싱 Kubernetes와 같은 컨테이너 오케스트레이션 플랫폼의 내장 기능을 활용한다.\n1 2 3 4 5 6 7 8 9 10 11 12 # Kubernetes 서비스 예시 apiVersion: v1 kind: Service metadata: name: api-service spec: selector: app: api ports: - port: 80 targetPort: 8080 type: LoadBalancer 장점:\n컨테이너 환경과의 원활한 통합 자동 확장 및 자가 치유 기능 선언적 구성 단점:\nKubernetes 클러스터 운영의 복잡성 초기 학습 곡선이 가파름 API 로드 밸런싱의 고급 기능 상태 확인(Health Checks) 로드 밸런서는 주기적으로 백엔드 서버의 상태를 확인하여 비정상 서버로의 트래픽 라우팅을 방지한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # NGINX 상태 확인 구성 예시 http { upstream api_servers { server backend1.example.com:80 max_fails=3 fail_timeout=30s; server backend2.example.com:80 max_fails=3 fail_timeout=30s; server backend3.example.com:80 max_fails=3 fail_timeout=30s; } server { listen 80; location / { proxy_pass http://api_servers; health_check interval=10 fails=3 passes=2; } } } 세션 유지(Session Persistence) 특정 클라이언트의 모든 요청이 동일한 백엔드 서버로 라우팅되도록 보장한다.\n1 2 3 4 5 6 7 8 9 10 11 12 # HAProxy 세션 유지 구성 예시 frontend http bind *:80 default_backend api_servers backend api_servers balance roundrobin stick-table type ip size 200k expire 30m stick on src server server1 192.168.1.101:80 check server server2 192.168.1.102:80 check server server3 192.168.1.103:80 check SSL 종료(SSL Termination) 로드 밸런서에서 SSL 연결을 종료하고 백엔드 서버로는 암호화되지 않은 트래픽을 전송하여 백엔드 서버의 부하를 줄인다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # NGINX SSL 종료 구성 예시 http { upstream api_servers { server backend1.example.com:8080; server backend2.example.com:8080; } server { listen 443 ssl; ssl_certificate /etc/nginx/cert.pem; ssl_certificate_key /etc/nginx/cert.key; location / { proxy_pass http://api_servers; } } } 동적 가중치 조정 서버의 현재 부하, 성능 메트릭을 기반으로 가중치를 동적으로 조정한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 # 동적 가중치 조정 의사 코드 def update_server_weights(): for server in servers: # CPU 사용률, 메모리 사용률, 응답 시간 등 메트릭 수집 metrics = collect_server_metrics(server[\"name\"]) # 메트릭을 기반으로 새 가중치 계산 new_weight = calculate_weight( metrics[\"cpu_usage\"], metrics[\"memory_usage\"], metrics[\"response_time\"] ) # 서버 가중치 업데이트 server[\"weight\"] = new_weight # 가중 서버 목록 재생성 regenerate_weighted_server_list() API 로드 밸런싱 아키텍처 패턴 단일 티어 로드 밸런싱 로드 밸런서가 클라이언트와 API 서버 사이에서 직접 요청을 분산한다.\n클라이언트 → 로드 밸런서 → API 서버 풀 장점: 단순하고 구현이 쉽다.\n단점: 로드 밸런서가 단일 장애 지점이 될 수 있다.\n멀티 티어 로드 밸런싱 여러 계층의 로드 밸런서를 사용하여 복잡한 인프라를 처리한다.\n클라이언트 → 글로벌 로드 밸런서 → 지역 로드 밸런서 → API 서버 풀 장점: 더 높은 확장성과 복원력을 제공한다.\n단점: 더 복잡하고 여러 구성 요소가 필요하다.\n마이크로서비스 아키텍처의 로드 밸런싱 서비스 간 통신에도 로드 밸런싱을 적용한다.\n클라이언트 → API 게이트웨이(LB) → 서비스 A(LB) → 서비스 A 인스턴스 풀 → 서비스 B(LB) → 서비스 B 인스턴스 풀 → 서비스 C(LB) → 서비스 C 인스턴스 풀 장점: 세밀한 확장성과 장애 격리를 제공한다.\n단점: 많은 로드 밸런싱 지점으로 인한 복잡성 증가\n서비스 메시(Service Mesh) 프록시 네트워크를 통해 마이크로서비스 간 통신을 관리한다.\n클라이언트 → 인그레스 게이트웨이 → 서비스 A(사이드카 프록시) ↔ 서비스 B(사이드카 프록시) ↔ 서비스 C(사이드카 프록시) 장점: 로드 밸런싱, 관찰성, 보안을 통합적으로 제공한다.\n단점: 사이드카 프록시로 인한 약간의 오버헤드가 발생한다.\n실제 구현 예시 NGINX를 사용한 API 로드 밸런싱 NGINX는 API 로드 밸런싱에 널리 사용되는 고성능 웹 서버 및 리버스 프록시이다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 # NGINX 로드 밸런싱 구성 예시 http { # 업스트림 서버 정의 upstream api_backend { least_conn; # 최소 연결 알고리즘 사용 server api1.example.com:8080 weight=3; server api2.example.com:8080 weight=2; server api3.example.com:8080 weight=1 backup; # 백업 서버 keepalive 32; # 유지 연결 풀 크기 } # 상태 페이지 (모니터링용) server { listen 8081; location /nginx_status { stub_status on; allow 127.0.0.1; deny all; } } # API 프록시 서버 server { listen 80; server_name api.example.com; location / { proxy_pass http://api_backend; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; # 타임아웃 설정 proxy_connect_timeout 5s; proxy_send_timeout 10s; proxy_read_timeout 10s; # 버퍼 설정 proxy_buffering on; proxy_buffer_size 16k; proxy_buffers 4 16k; } # API 경로별 다른 백엔드 서버 그룹 사용 location /v2/ { proxy_pass http://api_v2_backend; } # 속도 제한 적용 location /api/limited { limit_req zone=api_limit burst=5; proxy_pass http://api_backend; } } } Kubernetes에서의 API 로드 밸런싱 Kubernetes는 컨테이너화된 API를 위한 강력한 로드 밸런싱 솔루션을 제공한다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 # API 배포 구성 apiVersion: apps/v1 kind: Deployment metadata: name: api-deployment spec: replicas: 5 selector: matchLabels: app: api template: metadata: labels: app: api spec: containers: - name: api image: my-api:1.0 ports: - containerPort: 8080 readinessProbe: httpGet: path: /health port: 8080 initialDelaySeconds: 5 periodSeconds: 10 resources: limits: cpu: \"1\" memory: \"1Gi\" requests: cpu: \"0.5\" memory: \"512Mi\" --- # API 서비스 (내부 로드 밸런서) apiVersion: v1 kind: Service metadata: name: api-service spec: selector: app: api ports: - port: 80 targetPort: 8080 type: ClusterIP --- # 외부 인그레스 (외부 로드 밸런서) apiVersion: networking.k8s.io/v1 kind: Ingress metadata: name: api-ingress annotations: nginx.ingress.kubernetes.io/rewrite-target: / nginx.ingress.kubernetes.io/ssl-redirect: \"true\" nginx.ingress.kubernetes.io/backend-protocol: \"HTTP\" spec: rules: - host: api.example.com http: paths: - path: / pathType: Prefix backend: service: name: api-service port: number: 80 tls: - hosts: - api.example.com secretName: api-tls-secret AWS 환경에서의 API 로드 밸런싱 AWS Application Load Balancer(ALB)를 사용한 구성이다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 // AWS CloudFormation 템플릿 예시 { \"Resources\": { \"ApiLoadBalancer\": { \"Type\": \"AWS::ElasticLoadBalancingV2::LoadBalancer\", \"Properties\": { \"Name\": \"api-load-balancer\", \"Subnets\": [\"subnet-12345\", \"subnet-67890\"], \"SecurityGroups\": [\"sg-12345\"], \"Scheme\": \"internet-facing\", \"Type\": \"application\", \"IpAddressType\": \"ipv4\" } }, \"ApiTargetGroup\": { \"Type\": \"AWS::ElasticLoadBalancingV2::TargetGroup\", \"Properties\": { \"Name\": \"api-target-group\", \"Port\": 80, \"Protocol\": \"HTTP\", \"VpcId\": \"vpc-12345\", \"HealthCheckPath\": \"/health\", \"HealthCheckIntervalSeconds\": 30, \"HealthCheckTimeoutSeconds\": 5, \"HealthyThresholdCount\": 3, \"UnhealthyThresholdCount\": 2, \"TargetType\": \"instance\" } }, \"ApiListener\": { \"Type\": \"AWS::ElasticLoadBalancingV2::Listener\", \"Properties\": { \"LoadBalancerArn\": {\"Ref\": \"ApiLoadBalancer\"}, \"Port\": 443, \"Protocol\": \"HTTPS\", \"Certificates\": [ {\"CertificateArn\": \"arn:aws:acm:region:account-id:certificate/certificate-id\"} ], \"DefaultActions\": [ { \"Type\": \"forward\", \"TargetGroupArn\": {\"Ref\": \"ApiTargetGroup\"} } ] } }, \"ApiListenerRule\": { \"Type\": \"AWS::ElasticLoadBalancingV2::ListenerRule\", \"Properties\": { \"ListenerArn\": {\"Ref\": \"ApiListener\"}, \"Priority\": 1, \"Conditions\": [ { \"Field\": \"path-pattern\", \"Values\": [\"/api/*\"] } ], \"Actions\": [ { \"Type\": \"forward\", \"TargetGroupArn\": {\"Ref\": \"ApiTargetGroup\"} } ] } } } } API 로드 밸런싱의 모니터링 및 관리 주요 모니터링 지표 API 로드 밸런싱 시스템의 건강 상태를 평가하기 위한 핵심 지표이다:\n요청 처리량(Throughput): 초당 처리되는 요청 수 응답 시간(Response Time): 요청 처리에 소요되는 시간 오류율(Error Rate): 총 요청 중 실패한 요청의 비율 활성 연결 수(Active Connections): 현재 열린 연결 수 백엔드 서버 상태(Backend Server Health): 각 서버의 상태 및 가용성 세션 지속성(Session Persistence): 세션이 유지되는 정도 대기열 길이(Queue Length): 처리 대기 중인 요청 수 로깅 및 분석 효과적인 로드 밸런싱을 위한 로깅 전략:\n1 2 3 4 5 6 7 8 9 10 11 12 # NGINX 액세스 로깅 구성 예시 http { log_format lb_log '$remote_addr - $remote_user [$time_local] ' '\"$request\" $status $body_bytes_sent ' '\"$http_referer\" \"$http_user_agent\" ' '$request_time $upstream_response_time $pipe ' '$upstream_addr $upstream_status'; access_log /var/log/nginx/access.log lb_log; # 나머지 구성… } 로그 분석 도구:\nELK 스택 (Elasticsearch, Logstash, Kibana) Grafana + Prometheus DataDog, New Relic 등 상용 모니터링 솔루션 자동 확장(Auto Scaling) 부하에 따라 자동으로 백엔드 API 서버 수를 조정한다:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 # Kubernetes Horizontal Pod Autoscaler 예시 apiVersion: autoscaling/v2 kind: HorizontalPodAutoscaler metadata: name: api-hpa spec: scaleTargetRef: apiVersion: apps/v1 kind: Deployment name: api-deployment minReplicas: 3 maxReplicas: 10 metrics: - type: Resource resource: name: cpu target: type: Utilization averageUtilization: 70 - type: Resource resource: name: memory target: type: Utilization averageUtilization: 80 - type: Pods pods: metric: name: requests_per_second target: type: AverageValue averageValue: 1000 재해 복구 및 장애 조치 로드 밸런싱 시스템의 복원력을 보장하기 위한 전략:\n다중 가용 영역(Multi-AZ) 배포: 지리적으로 분산된 데이터 센터에 로드 밸런서 배포 로드 밸런서 클러스터링: 로드 밸런서의 고가용성 클러스터 구성 자동 장애 조치: 기본 로드 밸런서 실패 시 보조 로드 밸런서로 자동 전환 백업 및 복원 절차: 로드 밸런서 구성의 정기적인 백업 및 복원 테스트 API 로드 밸런싱의 보안 고려사항 DDoS 방어 분산 서비스 거부 공격으로부터 API를 보호한다:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 # NGINX DDoS 보호 구성 예시 http { # 연결 속도 제한 limit_conn_zone $binary_remote_addr zone=conn_limit_per_ip:10m; limit_conn conn_limit_per_ip 10; # 요청 속도 제한 limit_req_zone $binary_remote_addr zone=req_limit_per_ip:10m rate=5r/s; server { # API 엔드포인트에 속도 제한 적용 location /api/ { limit_req zone=req_limit_per_ip burst=10 nodelay; # 나머지 구성… } } } SSL/TLS 구성 안전한 API 통신을 보장한다:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 # NGINX 보안 SSL 구성 예시 http { server { listen 443 ssl http2; server_name api.example.com; # SSL 인증서 설정 ssl_certificate /etc/nginx/ssl/api.example.com.crt; ssl_certificate_key /etc/nginx/ssl/api.example.com.key; # SSL 프로토콜 및 암호화 설정 ssl_protocols TLSv1.2 TLSv1.3; ssl_prefer_server_ciphers on; ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305'; # HSTS 설정 (HTTP Strict Transport Security) add_header Strict-Transport-Security \"max-age=63072000; includeSubDomains; preload\" always; # SSL 세션 캐싱 ssl_session_timeout 1d; ssl_session_cache shared:SSL:10m; ssl_session_tickets off; # OCSP 스테이플링 ssl_stapling on; ssl_stapling_verify on; resolver 8.8.8.8 8.8.4.4 valid=300s; resolver_timeout 5s; # 나머지 구성… } } API 인증 및 권한 부여 로드 밸런서 수준에서 API 접근 제어를 구현한다:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 # NGINX API 인증 구성 예시 http { server { # API 키 검증 location /api/ { auth_request /validate-api-key; # 나머지 구성… } # API 키 검증 내부 엔드포인트 location = /validate-api-key { internal; proxy_pass http://auth-service/validate; proxy_pass_request_body off; proxy_set_header Content-Length \"\"; proxy_set_header X-Original-URI $request_uri; proxy_set_header X-API-Key $http_x_api_key; } # JWT 검증이 필요한 엔드포인트 location /api/secure/ { auth_request /validate-jwt; # 나머지 구성… } # JWT 검증 내부 엔드포인트 location = /validate-jwt { internal; proxy_pass http://auth-service/validate-jwt; proxy_pass_request_body off; proxy_set_header Content-Length \"\"; proxy_set_header X-Original-URI $request_uri; proxy_set_header Authorization $http_authorization; } } } WAF(웹 애플리케이션 방화벽) 통합 로드 밸런서와 WAF를 통합하여 API 보안 강화:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 # ModSecurity WAF와 NGINX 통합 예시 load_module modules/ngx_http_modsecurity_module.so; http { server { # ModSecurity WAF 활성화 modsecurity on; modsecurity_rules_file /etc/nginx/modsecurity/main.conf; # OWASP ModSecurity Core Rule Set 적용 location /api/ { # 로드 밸런싱 구성 proxy_pass http://api_backend; # WAF 로깅 modsecurity_transaction_id \"$remote_addr-$request_id\"; # 나머지 구성… } } } API 로드 밸런싱의 성능 최적화 연결 처리 최적화 대량의 API 요청을 효율적으로 처리하기 위한 연결 최적화:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 # NGINX 연결 최적화 구성 예시 worker_processes auto; worker_rlimit_nofile 65535; events { worker_connections 16384; multi_accept on; use epoll; } http { # 타임아웃 설정 keepalive_timeout 65; keepalive_requests 100000; # 클라이언트 버퍼 설정 client_body_buffer_size 128k; client_max_body_size 10m; client_body_timeout 12; client_header_timeout 12; # 파일 디스크립터 캐싱 open_file_cache max=200000 inactive=20s; open_file_cache_valid 30s; open_file_cache_min_uses 2; open_file_cache_errors on; # 업스트림 연결 최적화 upstream api_backend { server api1.example.com:8080; server api2.example.com:8080; keepalive 100; keepalive_requests 1000; keepalive_timeout 60s; } server { # 연결 유지 헤더 설정 location /api/ { proxy_pass http://api_backend; proxy_http_version 1.1; proxy_set_header Connection \"\"; } } } 압축 및 캐싱 대역폭 사용 최적화 및 응답 시간 개선:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 # NGINX 압축 및 캐싱 구성 예시 http { # 정적 콘텐츠 압축 gzip on; gzip_comp_level 5; gzip_min_length 256; gzip_proxied any; gzip_types application/json application/xml application/javascript text/plain text/css text/xml; gzip_vary on; # 캐싱 설정 proxy_cache_path /var/cache/nginx levels=1:2 keys_zone=api_cache:10m inactive=60m max_size=1g; server { # API 응답 캐싱 location /api/ { proxy_pass http://api_backend; # 캐싱 활성화 (GET 요청만) proxy_cache api_cache; proxy_cache_methods GET; proxy_cache_valid 200 302 10m; proxy_cache_valid 404 1m; proxy_cache_key $scheme$request_method$host$request_uri; # 캐시 재검증 proxy_cache_revalidate on; proxy_cache_use_stale error timeout updating http_500 http_502 http_503 http_504; proxy_cache_background_update on; # 캐시 상태 헤더 add_header X-Cache-Status $upstream_cache_status; # 조건부 캐싱 (인증 요청은 캐시하지 않음) proxy_cache_bypass $http_authorization; proxy_no_cache $http_authorization; # 나머지 구성… } # 캐시 무효화 엔드포인트 location ~ /purge/(.+) { allow 127.0.0.1; deny all; proxy_cache_purge api_cache $scheme$request_method$host$1; } } } HTTP/2 및 HTTP/3 지원 최신 HTTP 프로토콜을 활용한 성능 향상:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 # NGINX HTTP/2 및 HTTP/3 구성 예시 http { server { listen 443 ssl http2; listen 443 quic reuseport; # HTTP/3 지원 http2_max_concurrent_streams 128; http2_push_preload on; # QUIC 및 HTTP/3 설정 quic_retry on; quic_gso on; # Alt-Svc 헤더 설정 (HTTP/3 광고) add_header Alt-Svc 'h3=\":443\"; ma=86400'; # SSL 설정 ssl_certificate /etc/nginx/ssl/api.example.com.crt; ssl_certificate_key /etc/nginx/ssl/api.example.com.key; # HTTP/2 서버 푸시 (정적 리소스용) location /api/v1/products { http2_push /api/v1/categories; http2_push /api/v1/recommendations; proxy_pass http://api_backend; } } } 비동기 및 스트리밍 API 지원 장기 실행 요청 및 이벤트 스트림을 위한 최적화:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 # NGINX 스트리밍 API 구성 예시 http { upstream api_backend { server api1.example.com:8080; server api2.example.com:8080; } server { # 표준 API 요청 location /api/ { proxy_pass http://api_backend; # 표준 프록시 설정 proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; } # 이벤트 스트리밍 엔드포인트 location /api/stream/ { proxy_pass http://api_backend; # 스트리밍 최적화 proxy_buffering off; proxy_cache off; # 타임아웃 증가 proxy_read_timeout 300s; proxy_connect_timeout 300s; proxy_send_timeout 300s; # 청크 전송 설정 chunked_transfer_encoding on; # SSE(Server-Sent Events) 지원 proxy_set_header Connection ''; proxy_http_version 1.1; # 나머지 구성… } # 웹소켓 엔드포인트 location /api/ws/ { proxy_pass http://api_backend; # 웹소켓 설정 proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection \"upgrade\"; # 웹소켓 타임아웃 proxy_read_timeout 3600s; proxy_send_timeout 3600s; } } } 다양한 환경에서의 API 로드 밸런싱 전략 온프레미스 환경 자체 데이터센터에서 API 로드 밸런싱 구현하기:\n권장 아키텍처:\n프론트엔드: 하드웨어 로드 밸런서(F5, A10 등) 또는 NGINX/HAProxy 백엔드: 애플리케이션 서버 클러스터 인증/권한 부여: 전용 인증 서버 모니터링: Prometheus + Grafana 또는 상용 모니터링 솔루션 고가용성 전략:\n액티브-패시브 로드 밸런서 페어 다중 데이터센터 배포 GSLB(Global Server Load Balancing)를 통한 지역 페일오버 클라우드 네이티브 환경 클라우드 환경에 최적화된 API 로드 밸런싱:\nAWS 아키텍처 예시:\nRoute 53 (DNS) → CloudFront (CDN) → API Gateway → ALB → ECS/EKS 클러스터 Azure 아키텍처 예시:\nAzure Front Door → Azure API Management → Azure Load Balancer → AKS 클러스터 Google Cloud 아키텍처 예시:\nCloud CDN → Cloud Load Balancing → Cloud Run/GKE 주요 이점:\n관리 오버헤드 감소 자동 확장성 글로벌 배포 용이성 서버리스 옵션 통합 보안 및 모니터링 하이브리드 및 멀티 클라우드 환경 다양한 환경에 걸친 API 로드 밸런싱:\n아키텍처 접근법:\n중앙 집중식 라우팅: 글로벌 로드 밸런서가 각 환경의 로드 밸런서로 트래픽 라우팅 단일 엔트리 포인트, 정책 일관성 분산형 라우팅: 각 환경에 독립적인 엔트리 포인트 지역 최적화, 환경 간 독립성 기술 스택:\n서비스 메시: Istio, Linkerd 멀티 클라우드 로드 밸런싱: F5 Distributed Cloud, Cloudflare API 게이트웨이: Kong, Tyk, AWS App Mesh 주요 고려사항:\n환경 간 일관된 보안 정책 지연 시간 최적화 장애 격리 중앙 집중식 모니터링 및 로깅 엣지 컴퓨팅 환경 엣지 위치에서의 API 로드 밸런싱:\n아키텍처 접근법:\n엣지 캐싱: 주로 읽기 작업을 위한 CDN 기반 캐싱 엣지 컴퓨팅: 엣지 로케이션에서 API 비즈니스 로직 실행 하이브리드 엣지: 캐싱 + 간단한 처리는 엣지에서, 복잡한 처리는 백엔드에서 기술 스택:\n엣지 네트워크: Cloudflare Workers, Fastly Compute@Edge, AWS Lambda@Edge 경량 로드 밸런서: Envoy, Traefik 엣지 배포 솔루션: Vercel Edge Functions, Netlify Edge 주요 이점:\n지연 시간 감소 대역폭 비용 절감 오리진 서버 부하 감소 지역별 규정 준수 API 로드 밸런싱의 실제 사례 연구 대규모 전자상거래 API 플랫폼 도전 과제:\n빠르게 변화하는 트래픽 패턴 휴일 시즌 대규모 트래픽 급증 지역별로 다양한 서비스 요구사항 수천 개의 파트너 API 통합 구현 솔루션:\n다계층 로드 밸런싱: 글로벌 계층: Cloudflare + AWS Global Accelerator 지역 계층: ALB(Application Load Balancer) 서비스 계층: 서비스 내 로드 밸런싱 고급 라우팅 전략: 콘텐츠 기반 라우팅: 제품 API vs 주문 API 지리적 라우팅: 가장 가까운 데이터 센터로 가중치 기반 카나리 배포 자동 확장 정책: 예측적 확장: 과거 트래픽 패턴 기반 이벤트 기반 확장: 마케팅 이벤트 전에 미리 확장 다중 지표 확장: CPU, 메모리, 요청 대기열 기반 결과:\n99.99% 가용성 달성 블랙 프라이데이 피크 트래픽 400% 증가 처리 API 응답 시간 65% 감소 인프라 비용 30% 절감 금융 서비스 API 게이트웨이 도전 과제:\n엄격한 규제 준수 요구사항 제로 다운타임 요구사항 매우 민감한 데이터 처리 초당 수천 건의 트랜잭션 구현 솔루션:\n보안 중심 로드 밸런싱: mTLS(상호 TLS) 종단간 인증 요청/응답 암호화 FIPS 140-2 준수 하드웨어 로드 밸런서 WAF 통합 장애 없는 배포 전략: 블루-그린 배포 점진적인 트래픽 전환 자동 롤백 기능 고급 상태 확인: 딥 헬스 체크: API 기능 테스트 회로 차단기 패턴 구현 상태 메트릭 기반 가중치 조정 결과:\n100% 규제 준수 달성 5년 연속 제로 보안 침해 99.999% 가용성(연간 5분 미만 다운타임) 실시간 트랜잭션 처리 보장 글로벌 미디어 스트리밍 API 도전 과제:\n전 세계적으로 분산된 사용자 기반 대용량 미디어 콘텐츠 전송 저지연 API 상호작용 요구 다양한 디바이스 지원 구현 솔루션:\n글로벌 분산 아키텍처: 모든 대륙에 API 엔드포인트 배포 지능형 DNS 라우팅 로컬 캐싱 및 에지 컴퓨팅 스트리밍 최적화: 롱 폴링 및 웹소켓 지원 적응형 비트레이트 API 프로그레시브 콘텐츠 전송 맞춤형 로드 밸런싱 알고리즘: 콘텐츠 인기도 기반 캐싱 지연 시간 기반 라우팅 인식 추천 엔진 라우팅 결과:\n글로벌 평균 API 응답 시간 \u003c 100ms 최대 동시 사용자 1000만 명 지원 CDN 비용 45% 절감 버퍼링 이벤트 70% 감소 API 로드 밸런싱 구현 전략 API 로드 밸런싱을 효과적으로 구현하기 위한 전체적인 접근 방법을 제시합니다.\n계층적 로드 밸런싱 아키텍처 멀티 티어 아키텍처 설계:\n티어 1: 글로벌 엣지 CDN 및 글로벌 로드 밸런서 DDoS 방어 및 WAF 지역 기반 라우팅 TLS 종료 티어 2: 지역 API 게이트웨이 요청 검증 및 제한 인증 및 권한 부여 요청/응답 변환 API 버전 관리 티어 3: 서비스 로드 밸런서 마이크로서비스 간 라우팅 서비스 검색 통합 내부 TLS 종료 헬스 체크 및 회로 차단기 티어 4: 클러스터 로드 밸런서 컨테이너/Pod 수준 라우팅 스테이트풀 워크로드 라우팅 프로토콜 인식 로드 밸런싱 알고리즘 선택 결정 트리 API 유형 및 요구사항에 따른 로드 밸런싱 알고리즘 선택 가이드:\n쿼리 집약적 API: 쿼리 실행 시간에 큰 차이가 있는가? → 최소 연결 서버 용량이 다른가? → 가중 라운드 로빈 캐시 친화적인가? → 일관된 해싱 기타 → 라운드 로빈 상태 유지 API: 세션 상태가 중요한가? → 소스 IP 해싱 사용자별 처리가 필요한가? → URL 해싱 지연 시간이 중요한가? → 최소 응답 시간 기타 → 가중 라운드 로빈 고성능 실시간 API: 초저지연이 중요한가? → 최소 응답 시간 트래픽 급증이 있는가? → 최소 연결 + 동적 가중치 지리적으로 분산되어 있는가? → 지연 시간 기반 라우팅 기타 → 최소 처리 중인 요청 배치 처리 API: 작업 크기가 다양한가? → 리소스 기반 라우팅 서버 용량이 다른가? → 가중 라운드 로빈 우선순위가 있는가? → 우선순위 기반 큐 기타 → 라운드 로빈 구현 단계별 접근법 API 로드 밸런싱 시스템 구축을 위한 단계별 접근법:\n요구사항 분석: API 트래픽 패턴 분석 성능 및 확장성 목표 정의 고가용성 요구사항 식별 보안 요구사항 문서화 아키텍처 설계: 로드 밸런싱 계층 정의 알고리즘 선택 페일오버 전략 설계 모니터링 및 알림 계획 프로토타입 개발: 소규모로 로드 밸런싱 구성 테스트 다양한 알고리즘 비교 성능 벤치마킹 페일오버 테스트 확장 구현: 프로덕션 환경 설정 구성 자동화 CI/CD 파이프라인 통합 점진적 트래픽 전환 최적화 및 튜닝: 실제 트래픽 기반 알고리즘 조정 리소스 활용도 최적화 성능 병목 제거 구성 검증 및 강화 지속적인 개선: 정기적인 성능 검토 새로운 기술 평가 보안 취약점 스캐닝 용량 계획 업데이트 용어 정리 용어 설명 참고 및 출처 ","wordCount":"4135","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2025-02-13T01:30:00Z","dateModified":"2025-02-13T01:30:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/backend/performance-optimization/load-balancing-and-scaling/load-balancing/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>기술 블로그</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend/>Backend</a>&nbsp;»&nbsp;<a href>Performance Optimization</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend/performance-optimization/load-balancing-and-scaling/>Load Balancing and Scaling</a></div><h1 class="post-title entry-hint-parent">Load Balancing</h1><div class=post-description>API 로드 밸런싱은 현대 웹 아키텍처와 분산 시스템의 필수적인 구성 요소로, 트래픽을 여러 서버에 효율적으로 분산하여 성능, 가용성, 안정성을 극대화한다.</div><div class=post-meta><span title='2025-02-13 01:30:00 +0000 UTC'>February 13, 2025</span>&nbsp;·&nbsp;20 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/Backend/Performance%20Optimization/Load%20Balancing%20and%20Scaling/Load-Balancing.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#load-balancing>Load Balancing</a><ul><li><a href=#api-로드-밸런싱의-기본-개념>API 로드 밸런싱의 기본 개념</a></li><li><a href=#로드-밸런싱-알고리즘>로드 밸런싱 알고리즘</a></li><li><a href=#api-로드-밸런싱-구현-방법>API 로드 밸런싱 구현 방법</a></li><li><a href=#api-로드-밸런싱의-고급-기능>API 로드 밸런싱의 고급 기능</a></li><li><a href=#api-로드-밸런싱-아키텍처-패턴>API 로드 밸런싱 아키텍처 패턴</a></li><li><a href=#실제-구현-예시>실제 구현 예시</a></li><li><a href=#api-로드-밸런싱의-모니터링-및-관리>API 로드 밸런싱의 모니터링 및 관리</a></li><li><a href=#api-로드-밸런싱의-보안-고려사항>API 로드 밸런싱의 보안 고려사항</a></li><li><a href=#api-로드-밸런싱의-성능-최적화>API 로드 밸런싱의 성능 최적화</a></li><li><a href=#다양한-환경에서의-api-로드-밸런싱-전략>다양한 환경에서의 API 로드 밸런싱 전략</a></li><li><a href=#api-로드-밸런싱의-실제-사례-연구>API 로드 밸런싱의 실제 사례 연구</a></li><li><a href=#api-로드-밸런싱-구현-전략>API 로드 밸런싱 구현 전략</a></li></ul></li><li><a href=#용어-정리>용어 정리</a></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=load-balancing>Load Balancing<a hidden class=anchor aria-hidden=true href=#load-balancing>#</a></h2><p>API 로드 밸런싱은 현대 웹 아키텍처와 분산 시스템의 필수적인 구성 요소로, 트래픽을 여러 서버에 효율적으로 분산하여 성능, 가용성, 안정성을 극대화한다.</p><h3 id=api-로드-밸런싱의-기본-개념>API 로드 밸런싱의 기본 개념<a hidden class=anchor aria-hidden=true href=#api-로드-밸런싱의-기본-개념>#</a></h3><p>로드 밸런싱은 들어오는 네트워크 트래픽을 여러 서버에 분산하는 프로세스로, 단일 서버의 과부하를 방지하고 애플리케이션의 응답성과 가용성을 향상시킨다. API 컨텍스트에서 로드 밸런싱은 특히 중요한데, API가 종종 높은 동시 요청 수와 일관된 응답 시간을 유지해야 하는 미션 크리티컬한 애플리케이션의 기반이 되기 때문이다.</p><h4 id=로드-밸런싱이-필요한-이유>로드 밸런싱이 필요한 이유<a hidden class=anchor aria-hidden=true href=#로드-밸런싱이-필요한-이유>#</a></h4><ol><li><strong>성능 최적화</strong>: 여러 서버에 부하를 분산하여 응답 시간을 최소화한다.</li><li><strong>고가용성</strong>: 서버 장애 시에도 서비스 중단 없이 트래픽을 다른 정상 서버로 리디렉션한다.</li><li><strong>확장성</strong>: 수요 증가에 따라 서버를 추가하고 부하 분산 풀에 통합할 수 있다.</li><li><strong>유연성</strong>: 서버 유지보수를 위해 일부 서버를 오프라인으로 전환하고 나머지 서버로 트래픽을 라우팅할 수 있다.</li><li><strong>효율성</strong>: 자원 활용도를 최적화하여 비용을 절감한다.</li></ol><h4 id=로드-밸런싱의-유형>로드 밸런싱의 유형<a hidden class=anchor aria-hidden=true href=#로드-밸런싱의-유형>#</a></h4><p>API 로드 밸런싱은 여러 수준에서 구현될 수 있다:</p><ol><li><strong>L4(전송 계층) 로드 밸런싱</strong>:<ul><li>IP 주소와 포트 정보를 기반으로 트래픽 분산</li><li>패킷 내용을 검사하지 않고 빠른 처리 가능</li><li>TCP/UDP 레벨에서 작동</li></ul></li><li><strong>L7(애플리케이션 계층) 로드 밸런싱</strong>:<ul><li>HTTP 헤더, 쿠키, URL 등 애플리케이션 레벨 데이터 기반 라우팅</li><li>더 지능적인 라우팅 결정 가능</li><li>콘텐츠 기반 라우팅 지원 (예: 특정 API 엔드포인트를 특정 서버로 라우팅)</li></ul></li><li><strong>글로벌 서버 로드 밸런싱(GSLB)</strong>:<ul><li>지리적으로 분산된 서버 간에 트래픽 분산</li><li>사용자와 가장 가까운 데이터 센터로 라우팅</li><li>지역 서버 장애 시 자동 페일오버 제공</li></ul></li></ol><h3 id=로드-밸런싱-알고리즘>로드 밸런싱 알고리즘<a hidden class=anchor aria-hidden=true href=#로드-밸런싱-알고리즘>#</a></h3><p>적절한 로드 밸런싱 알고리즘 선택은 API 성능에 큰 영향을 미친다.</p><p>주요 알고리즘은 다음과 같다:</p><h4 id=라운드-로빈round-robin>라운드 로빈(Round Robin)<a hidden class=anchor aria-hidden=true href=#라운드-로빈round-robin>#</a></h4><p>각 서버에 순차적으로 요청을 분배하는 가장 단순한 방식.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2>2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3>3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4>4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5>5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6>6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7>7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8>8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 라운드 로빈 알고리즘의 의사 코드</span>
</span></span><span class=line><span class=cl><span class=n>servers</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;server1&#34;</span><span class=p>,</span> <span class=s2>&#34;server2&#34;</span><span class=p>,</span> <span class=s2>&#34;server3&#34;</span><span class=p>,</span> <span class=s2>&#34;server4&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>current_index</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_next_server</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>current_index</span>
</span></span><span class=line><span class=cl>    <span class=n>server</span> <span class=o>=</span> <span class=n>servers</span><span class=p>[</span><span class=n>current_index</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>current_index</span> <span class=o>=</span> <span class=p>(</span><span class=n>current_index</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>servers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>server</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>장점</strong>: 구현이 간단하고 모든 서버가 동일한 사양일 때 효과적.<br><strong>단점</strong>: 서버 용량이나 현재 부하를 고려하지 않는다.</p><h4 id=가중-라운드-로빈weighted-round-robin>가중 라운드 로빈(Weighted Round Robin)<a hidden class=anchor aria-hidden=true href=#가중-라운드-로빈weighted-round-robin>#</a></h4><p>각 서버에 가중치를 할당하여 더 강력한 서버가 더 많은 요청을 처리하도록 한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16>16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17>17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18>18</a>
</span><span class=lnt id=hl-1-19><a class=lnlinks href=#hl-1-19>19</a>
</span><span class=lnt id=hl-1-20><a class=lnlinks href=#hl-1-20>20</a>
</span><span class=lnt id=hl-1-21><a class=lnlinks href=#hl-1-21>21</a>
</span><span class=lnt id=hl-1-22><a class=lnlinks href=#hl-1-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 가중 라운드 로빈 알고리즘의 의사 코드</span>
</span></span><span class=line><span class=cl><span class=n>servers</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;server1&#34;</span><span class=p>,</span> <span class=s2>&#34;weight&#34;</span><span class=p>:</span> <span class=mi>5</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;server2&#34;</span><span class=p>,</span> <span class=s2>&#34;weight&#34;</span><span class=p>:</span> <span class=mi>3</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;server3&#34;</span><span class=p>,</span> <span class=s2>&#34;weight&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_servers_by_weight</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>weighted_servers</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>server</span> <span class=ow>in</span> <span class=n>servers</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>server</span><span class=p>[</span><span class=s2>&#34;weight&#34;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>            <span class=n>weighted_servers</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>server</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>weighted_servers</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>weighted_server_list</span> <span class=o>=</span> <span class=n>get_servers_by_weight</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>current_index</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_next_server</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>current_index</span>
</span></span><span class=line><span class=cl>    <span class=n>server</span> <span class=o>=</span> <span class=n>weighted_server_list</span><span class=p>[</span><span class=n>current_index</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>current_index</span> <span class=o>=</span> <span class=p>(</span><span class=n>current_index</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>weighted_server_list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>server</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>장점</strong>: 서버 용량 차이를 고려한다.<br><strong>단점</strong>: 실제 서버 부하를 동적으로 반영하지 않는다.</p><h4 id=최소-연결least-connections>최소 연결(Least Connections)<a hidden class=anchor aria-hidden=true href=#최소-연결least-connections>#</a></h4><p>현재 가장 적은 활성 연결을 가진 서버로 새 요청을 라우팅한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3>3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4>4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5>5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6>6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7>7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8>8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 최소 연결 알고리즘의 의사 코드</span>
</span></span><span class=line><span class=cl><span class=n>servers</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;server1&#34;</span><span class=p>,</span> <span class=s2>&#34;active_connections&#34;</span><span class=p>:</span> <span class=mi>10</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;server2&#34;</span><span class=p>,</span> <span class=s2>&#34;active_connections&#34;</span><span class=p>:</span> <span class=mi>15</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;server3&#34;</span><span class=p>,</span> <span class=s2>&#34;active_connections&#34;</span><span class=p>:</span> <span class=mi>5</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_server_with_least_connections</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>min</span><span class=p>(</span><span class=n>servers</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s2>&#34;active_connections&#34;</span><span class=p>])[</span><span class=s2>&#34;name&#34;</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>장점</strong>: 서버 부하를 고려하여 더 효율적인 분배가 가능하다.<br><strong>단점</strong>: 연결 수가 항상 부하를 정확히 반영하지는 않는다.</p><h4 id=ip-해시ip-hash>IP 해시(IP Hash)<a hidden class=anchor aria-hidden=true href=#ip-해시ip-hash>#</a></h4><p>클라이언트 IP 주소를 해싱하여 항상 동일한 서버로 요청을 라우팅한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4>4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5>5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6>6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7>7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8>8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># IP 해시 알고리즘의 의사 코드</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>servers</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;server1&#34;</span><span class=p>,</span> <span class=s2>&#34;server2&#34;</span><span class=p>,</span> <span class=s2>&#34;server3&#34;</span><span class=p>,</span> <span class=s2>&#34;server4&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_server_for_ip</span><span class=p>(</span><span class=n>ip_address</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>hash_value</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>hashlib</span><span class=o>.</span><span class=n>md5</span><span class=p>(</span><span class=n>ip_address</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>(),</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>server_index</span> <span class=o>=</span> <span class=n>hash_value</span> <span class=o>%</span> <span class=nb>len</span><span class=p>(</span><span class=n>servers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>servers</span><span class=p>[</span><span class=n>server_index</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>장점</strong>: 세션 유지에 유용하며 같은 클라이언트는 항상 같은 서버에 연결된다.<br><strong>단점</strong>: 트래픽이 고르게 분산되지 않을 수 있다.</p><h4 id=최소-응답-시간least-response-time>최소 응답 시간(Least Response Time)<a hidden class=anchor aria-hidden=true href=#최소-응답-시간least-response-time>#</a></h4><p>응답 시간이 가장 짧은 서버로 요청을 라우팅한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2>2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3>3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4>4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5>5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6>6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7>7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8>8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 최소 응답 시간 알고리즘의 의사 코드</span>
</span></span><span class=line><span class=cl><span class=n>servers</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;server1&#34;</span><span class=p>,</span> <span class=s2>&#34;response_time&#34;</span><span class=p>:</span> <span class=mi>120</span><span class=p>},</span>  <span class=c1># 밀리초</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;server2&#34;</span><span class=p>,</span> <span class=s2>&#34;response_time&#34;</span><span class=p>:</span> <span class=mi>95</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;server3&#34;</span><span class=p>,</span> <span class=s2>&#34;response_time&#34;</span><span class=p>:</span> <span class=mi>180</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_server_with_least_response_time</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>min</span><span class=p>(</span><span class=n>servers</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s2>&#34;response_time&#34;</span><span class=p>])[</span><span class=s2>&#34;name&#34;</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>장점</strong>: 실제 성능을 기반으로 가장 반응성 좋은 서버를 선택한다.<br><strong>단점</strong>: 응답 시간을 지속적으로 모니터링해야 하므로 오버헤드가 있다.</p><h3 id=api-로드-밸런싱-구현-방법>API 로드 밸런싱 구현 방법<a hidden class=anchor aria-hidden=true href=#api-로드-밸런싱-구현-방법>#</a></h3><h4 id=하드웨어-로드-밸런서>하드웨어 로드 밸런서<a hidden class=anchor aria-hidden=true href=#하드웨어-로드-밸런서>#</a></h4><p>물리적 장치를 사용하여 트래픽을 분산한다.</p><p><strong>장점</strong>:</p><ul><li>높은 성능과 처리량</li><li>전용 하드웨어로 안정성 보장</li><li>종종 더 높은 보안 기능 제공</li></ul><p><strong>단점</strong>:</p><ul><li>비용이 높음</li><li>확장성 제한</li><li>유지보수가 복잡함</li></ul><p><strong>주요 제품</strong>: F5 BIG-IP, Citrix ADC, A10 Networks 등</p><h4 id=소프트웨어-로드-밸런서>소프트웨어 로드 밸런서<a hidden class=anchor aria-hidden=true href=#소프트웨어-로드-밸런서>#</a></h4><p>소프트웨어 애플리케이션을 통해 트래픽을 분산한다.</p><p><strong>장점</strong>:</p><ul><li>비용 효율적</li><li>유연한 구성</li><li>클라우드 환경에 적합</li></ul><p><strong>단점</strong>:</p><ul><li>하드웨어 솔루션보다 성능이 낮을 수 있음</li><li>호스팅 서버의 리소스 사용</li></ul><p><strong>주요 제품</strong>: NGINX, HAProxy, Apache Traffic Server 등</p><h4 id=클라우드-기반-로드-밸런서>클라우드 기반 로드 밸런서<a hidden class=anchor aria-hidden=true href=#클라우드-기반-로드-밸런서>#</a></h4><p>클라우드 제공업체의 관리형 로드 밸런싱 서비스를 활용한다.</p><p><strong>장점</strong>:</p><ul><li>관리 오버헤드 최소화</li><li>탄력적 확장성</li><li>자동 장애 조치 및 자동 확장</li></ul><p><strong>단점</strong>:</p><ul><li>클라우드 제공업체에 종속</li><li>커스터마이징 옵션이 제한적일 수 있음</li></ul><p><strong>주요 서비스</strong>: AWS Elastic Load Balancing, Google Cloud Load Balancing, Azure Load Balancer 등</p><h4 id=컨테이너-오케스트레이션-기반-로드-밸런싱>컨테이너 오케스트레이션 기반 로드 밸런싱<a hidden class=anchor aria-hidden=true href=#컨테이너-오케스트레이션-기반-로드-밸런싱>#</a></h4><p>Kubernetes와 같은 컨테이너 오케스트레이션 플랫폼의 내장 기능을 활용한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># Kubernetes 서비스 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>api-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>api</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>LoadBalancer</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>장점</strong>:</p><ul><li>컨테이너 환경과의 원활한 통합</li><li>자동 확장 및 자가 치유 기능</li><li>선언적 구성</li></ul><p><strong>단점</strong>:</p><ul><li>Kubernetes 클러스터 운영의 복잡성</li><li>초기 학습 곡선이 가파름</li></ul><h3 id=api-로드-밸런싱의-고급-기능>API 로드 밸런싱의 고급 기능<a hidden class=anchor aria-hidden=true href=#api-로드-밸런싱의-고급-기능>#</a></h3><h4 id=상태-확인health-checks>상태 확인(Health Checks)<a hidden class=anchor aria-hidden=true href=#상태-확인health-checks>#</a></h4><p>로드 밸런서는 주기적으로 백엔드 서버의 상태를 확인하여 비정상 서버로의 트래픽 라우팅을 방지한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14>14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15>15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16>16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># NGINX 상태 확인 구성 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>upstream</span> <span class=s>api_servers</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>server</span> <span class=n>backend1.example.com</span><span class=p>:</span><span class=mi>80</span> <span class=s>max_fails=3</span> <span class=s>fail_timeout=30s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>server</span> <span class=n>backend2.example.com</span><span class=p>:</span><span class=mi>80</span> <span class=s>max_fails=3</span> <span class=s>fail_timeout=30s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>server</span> <span class=n>backend3.example.com</span><span class=p>:</span><span class=mi>80</span> <span class=s>max_fails=3</span> <span class=s>fail_timeout=30s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>listen</span> <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass</span> <span class=s>http://api_servers</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>health_check</span> <span class=s>interval=10</span> <span class=s>fails=3</span> <span class=s>passes=2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=세션-유지session-persistence>세션 유지(Session Persistence)<a hidden class=anchor aria-hidden=true href=#세션-유지session-persistence>#</a></h4><p>특정 클라이언트의 모든 요청이 동일한 백엔드 서버로 라우팅되도록 보장한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span><span class=lnt id=hl-7-12><a class=lnlinks href=#hl-7-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># HAProxy 세션 유지 구성 예시
</span></span><span class=line><span class=cl>frontend http
</span></span><span class=line><span class=cl>    bind *:80
</span></span><span class=line><span class=cl>    default_backend api_servers
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>backend api_servers
</span></span><span class=line><span class=cl>    balance roundrobin
</span></span><span class=line><span class=cl>    stick-table type ip size 200k expire 30m
</span></span><span class=line><span class=cl>    stick on src
</span></span><span class=line><span class=cl>    server server1 192.168.1.101:80 check
</span></span><span class=line><span class=cl>    server server2 192.168.1.102:80 check
</span></span><span class=line><span class=cl>    server server3 192.168.1.103:80 check
</span></span></code></pre></td></tr></table></div></div><h4 id=ssl-종료ssl-termination>SSL 종료(SSL Termination)<a hidden class=anchor aria-hidden=true href=#ssl-종료ssl-termination>#</a></h4><p>로드 밸런서에서 SSL 연결을 종료하고 백엔드 서버로는 암호화되지 않은 트래픽을 전송하여 백엔드 서버의 부하를 줄인다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1> 1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2> 2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3> 3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4> 4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5> 5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6> 6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7> 7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8> 8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9> 9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10>10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11>11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12>12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13>13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14>14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15>15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16>16</a>
</span><span class=lnt id=hl-8-17><a class=lnlinks href=#hl-8-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># NGINX SSL 종료 구성 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>upstream</span> <span class=s>api_servers</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>server</span> <span class=n>backend1.example.com</span><span class=p>:</span><span class=mi>8080</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>server</span> <span class=n>backend2.example.com</span><span class=p>:</span><span class=mi>8080</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>listen</span> <span class=mi>443</span> <span class=s>ssl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>ssl_certificate</span> <span class=s>/etc/nginx/cert.pem</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>ssl_certificate_key</span> <span class=s>/etc/nginx/cert.key</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass</span> <span class=s>http://api_servers</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=동적-가중치-조정>동적 가중치 조정<a hidden class=anchor aria-hidden=true href=#동적-가중치-조정>#</a></h4><p>서버의 현재 부하, 성능 메트릭을 기반으로 가중치를 동적으로 조정한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11>11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12>12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13>13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14>14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15>15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16>16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17>17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 동적 가중치 조정 의사 코드</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>update_server_weights</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>server</span> <span class=ow>in</span> <span class=n>servers</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># CPU 사용률, 메모리 사용률, 응답 시간 등 메트릭 수집</span>
</span></span><span class=line><span class=cl>        <span class=n>metrics</span> <span class=o>=</span> <span class=n>collect_server_metrics</span><span class=p>(</span><span class=n>server</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 메트릭을 기반으로 새 가중치 계산</span>
</span></span><span class=line><span class=cl>        <span class=n>new_weight</span> <span class=o>=</span> <span class=n>calculate_weight</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>metrics</span><span class=p>[</span><span class=s2>&#34;cpu_usage&#34;</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>            <span class=n>metrics</span><span class=p>[</span><span class=s2>&#34;memory_usage&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=n>metrics</span><span class=p>[</span><span class=s2>&#34;response_time&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 서버 가중치 업데이트</span>
</span></span><span class=line><span class=cl>        <span class=n>server</span><span class=p>[</span><span class=s2>&#34;weight&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>new_weight</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 가중 서버 목록 재생성</span>
</span></span><span class=line><span class=cl>    <span class=n>regenerate_weighted_server_list</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=api-로드-밸런싱-아키텍처-패턴>API 로드 밸런싱 아키텍처 패턴<a hidden class=anchor aria-hidden=true href=#api-로드-밸런싱-아키텍처-패턴>#</a></h3><h4 id=단일-티어-로드-밸런싱>단일 티어 로드 밸런싱<a hidden class=anchor aria-hidden=true href=#단일-티어-로드-밸런싱>#</a></h4><p>로드 밸런서가 클라이언트와 API 서버 사이에서 직접 요청을 분산한다.</p><pre class=mermaid>클라이언트 → 로드 밸런서 → API 서버 풀
</pre><p><strong>장점</strong>: 단순하고 구현이 쉽다.<br><strong>단점</strong>: 로드 밸런서가 단일 장애 지점이 될 수 있다.</p><h4 id=멀티-티어-로드-밸런싱>멀티 티어 로드 밸런싱<a hidden class=anchor aria-hidden=true href=#멀티-티어-로드-밸런싱>#</a></h4><p>여러 계층의 로드 밸런서를 사용하여 복잡한 인프라를 처리한다.</p><pre class=mermaid>클라이언트 → 글로벌 로드 밸런서 → 지역 로드 밸런서 → API 서버 풀
</pre><p><strong>장점</strong>: 더 높은 확장성과 복원력을 제공한다.<br><strong>단점</strong>: 더 복잡하고 여러 구성 요소가 필요하다.</p><h4 id=마이크로서비스-아키텍처의-로드-밸런싱>마이크로서비스 아키텍처의 로드 밸런싱<a hidden class=anchor aria-hidden=true href=#마이크로서비스-아키텍처의-로드-밸런싱>#</a></h4><p>서비스 간 통신에도 로드 밸런싱을 적용한다.</p><pre class=mermaid>클라이언트 → API 게이트웨이(LB) → 서비스 A(LB) → 서비스 A 인스턴스 풀
                               → 서비스 B(LB) → 서비스 B 인스턴스 풀
                               → 서비스 C(LB) → 서비스 C 인스턴스 풀
</pre><p><strong>장점</strong>: 세밀한 확장성과 장애 격리를 제공한다.<br><strong>단점</strong>: 많은 로드 밸런싱 지점으로 인한 복잡성 증가</p><h4 id=서비스-메시service-mesh>서비스 메시(Service Mesh)<a hidden class=anchor aria-hidden=true href=#서비스-메시service-mesh>#</a></h4><p>프록시 네트워크를 통해 마이크로서비스 간 통신을 관리한다.</p><pre class=mermaid>클라이언트 → 인그레스 게이트웨이 → 서비스 A(사이드카 프록시) ↔ 서비스 B(사이드카 프록시)
                                 ↔ 서비스 C(사이드카 프록시)
</pre><p><strong>장점</strong>: 로드 밸런싱, 관찰성, 보안을 통합적으로 제공한다.<br><strong>단점</strong>: 사이드카 프록시로 인한 약간의 오버헤드가 발생한다.</p><h3 id=실제-구현-예시>실제 구현 예시<a hidden class=anchor aria-hidden=true href=#실제-구현-예시>#</a></h3><h4 id=nginx를-사용한-api-로드-밸런싱>NGINX를 사용한 API 로드 밸런싱<a hidden class=anchor aria-hidden=true href=#nginx를-사용한-api-로드-밸런싱>#</a></h4><p>NGINX는 API 로드 밸런싱에 널리 사용되는 고성능 웹 서버 및 리버스 프록시이다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1> 1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2> 2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3> 3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4> 4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5> 5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6> 6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7> 7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8> 8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9> 9</a>
</span><span class=lnt id=hl-14-10><a class=lnlinks href=#hl-14-10>10</a>
</span><span class=lnt id=hl-14-11><a class=lnlinks href=#hl-14-11>11</a>
</span><span class=lnt id=hl-14-12><a class=lnlinks href=#hl-14-12>12</a>
</span><span class=lnt id=hl-14-13><a class=lnlinks href=#hl-14-13>13</a>
</span><span class=lnt id=hl-14-14><a class=lnlinks href=#hl-14-14>14</a>
</span><span class=lnt id=hl-14-15><a class=lnlinks href=#hl-14-15>15</a>
</span><span class=lnt id=hl-14-16><a class=lnlinks href=#hl-14-16>16</a>
</span><span class=lnt id=hl-14-17><a class=lnlinks href=#hl-14-17>17</a>
</span><span class=lnt id=hl-14-18><a class=lnlinks href=#hl-14-18>18</a>
</span><span class=lnt id=hl-14-19><a class=lnlinks href=#hl-14-19>19</a>
</span><span class=lnt id=hl-14-20><a class=lnlinks href=#hl-14-20>20</a>
</span><span class=lnt id=hl-14-21><a class=lnlinks href=#hl-14-21>21</a>
</span><span class=lnt id=hl-14-22><a class=lnlinks href=#hl-14-22>22</a>
</span><span class=lnt id=hl-14-23><a class=lnlinks href=#hl-14-23>23</a>
</span><span class=lnt id=hl-14-24><a class=lnlinks href=#hl-14-24>24</a>
</span><span class=lnt id=hl-14-25><a class=lnlinks href=#hl-14-25>25</a>
</span><span class=lnt id=hl-14-26><a class=lnlinks href=#hl-14-26>26</a>
</span><span class=lnt id=hl-14-27><a class=lnlinks href=#hl-14-27>27</a>
</span><span class=lnt id=hl-14-28><a class=lnlinks href=#hl-14-28>28</a>
</span><span class=lnt id=hl-14-29><a class=lnlinks href=#hl-14-29>29</a>
</span><span class=lnt id=hl-14-30><a class=lnlinks href=#hl-14-30>30</a>
</span><span class=lnt id=hl-14-31><a class=lnlinks href=#hl-14-31>31</a>
</span><span class=lnt id=hl-14-32><a class=lnlinks href=#hl-14-32>32</a>
</span><span class=lnt id=hl-14-33><a class=lnlinks href=#hl-14-33>33</a>
</span><span class=lnt id=hl-14-34><a class=lnlinks href=#hl-14-34>34</a>
</span><span class=lnt id=hl-14-35><a class=lnlinks href=#hl-14-35>35</a>
</span><span class=lnt id=hl-14-36><a class=lnlinks href=#hl-14-36>36</a>
</span><span class=lnt id=hl-14-37><a class=lnlinks href=#hl-14-37>37</a>
</span><span class=lnt id=hl-14-38><a class=lnlinks href=#hl-14-38>38</a>
</span><span class=lnt id=hl-14-39><a class=lnlinks href=#hl-14-39>39</a>
</span><span class=lnt id=hl-14-40><a class=lnlinks href=#hl-14-40>40</a>
</span><span class=lnt id=hl-14-41><a class=lnlinks href=#hl-14-41>41</a>
</span><span class=lnt id=hl-14-42><a class=lnlinks href=#hl-14-42>42</a>
</span><span class=lnt id=hl-14-43><a class=lnlinks href=#hl-14-43>43</a>
</span><span class=lnt id=hl-14-44><a class=lnlinks href=#hl-14-44>44</a>
</span><span class=lnt id=hl-14-45><a class=lnlinks href=#hl-14-45>45</a>
</span><span class=lnt id=hl-14-46><a class=lnlinks href=#hl-14-46>46</a>
</span><span class=lnt id=hl-14-47><a class=lnlinks href=#hl-14-47>47</a>
</span><span class=lnt id=hl-14-48><a class=lnlinks href=#hl-14-48>48</a>
</span><span class=lnt id=hl-14-49><a class=lnlinks href=#hl-14-49>49</a>
</span><span class=lnt id=hl-14-50><a class=lnlinks href=#hl-14-50>50</a>
</span><span class=lnt id=hl-14-51><a class=lnlinks href=#hl-14-51>51</a>
</span><span class=lnt id=hl-14-52><a class=lnlinks href=#hl-14-52>52</a>
</span><span class=lnt id=hl-14-53><a class=lnlinks href=#hl-14-53>53</a>
</span><span class=lnt id=hl-14-54><a class=lnlinks href=#hl-14-54>54</a>
</span><span class=lnt id=hl-14-55><a class=lnlinks href=#hl-14-55>55</a>
</span><span class=lnt id=hl-14-56><a class=lnlinks href=#hl-14-56>56</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># NGINX 로드 밸런싱 구성 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1># 업스트림 서버 정의
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kn>upstream</span> <span class=s>api_backend</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>least_conn</span><span class=p>;</span>  <span class=c1># 최소 연결 알고리즘 사용
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>server</span> <span class=n>api1.example.com</span><span class=p>:</span><span class=mi>8080</span> <span class=s>weight=3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>server</span> <span class=n>api2.example.com</span><span class=p>:</span><span class=mi>8080</span> <span class=s>weight=2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>server</span> <span class=n>api3.example.com</span><span class=p>:</span><span class=mi>8080</span> <span class=s>weight=1</span> <span class=s>backup</span><span class=p>;</span>  <span class=c1># 백업 서버
</span></span></span><span class=line><span class=cl><span class=c1></span>        
</span></span><span class=line><span class=cl>        <span class=kn>keepalive</span> <span class=mi>32</span><span class=p>;</span>  <span class=c1># 유지 연결 풀 크기
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 상태 페이지 (모니터링용)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>listen</span> <span class=mi>8081</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=s>/nginx_status</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>stub_status</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>allow</span> <span class=n>127.0.0.1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>deny</span> <span class=s>all</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># API 프록시 서버
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>listen</span> <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>server_name</span> <span class=s>api.example.com</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass</span> <span class=s>http://api_backend</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_set_header</span> <span class=s>Host</span> <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_set_header</span> <span class=s>X-Real-IP</span> <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_set_header</span> <span class=s>X-Forwarded-For</span> <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 타임아웃 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>proxy_connect_timeout</span> <span class=s>5s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_send_timeout</span> <span class=s>10s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_read_timeout</span> <span class=s>10s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 버퍼 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>proxy_buffering</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_buffer_size</span> <span class=mi>16k</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_buffers</span> <span class=mi>4</span> <span class=mi>16k</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># API 경로별 다른 백엔드 서버 그룹 사용
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=s>/v2/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass</span> <span class=s>http://api_v2_backend</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 속도 제한 적용
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=s>/api/limited</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>limit_req</span> <span class=s>zone=api_limit</span> <span class=s>burst=5</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass</span> <span class=s>http://api_backend</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=kubernetes에서의-api-로드-밸런싱>Kubernetes에서의 API 로드 밸런싱<a hidden class=anchor aria-hidden=true href=#kubernetes에서의-api-로드-밸런싱>#</a></h4><p>Kubernetes는 컨테이너화된 API를 위한 강력한 로드 밸런싱 솔루션을 제공한다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1> 1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2> 2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3> 3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4> 4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5> 5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6> 6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7> 7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8> 8</a>
</span><span class=lnt id=hl-15-9><a class=lnlinks href=#hl-15-9> 9</a>
</span><span class=lnt id=hl-15-10><a class=lnlinks href=#hl-15-10>10</a>
</span><span class=lnt id=hl-15-11><a class=lnlinks href=#hl-15-11>11</a>
</span><span class=lnt id=hl-15-12><a class=lnlinks href=#hl-15-12>12</a>
</span><span class=lnt id=hl-15-13><a class=lnlinks href=#hl-15-13>13</a>
</span><span class=lnt id=hl-15-14><a class=lnlinks href=#hl-15-14>14</a>
</span><span class=lnt id=hl-15-15><a class=lnlinks href=#hl-15-15>15</a>
</span><span class=lnt id=hl-15-16><a class=lnlinks href=#hl-15-16>16</a>
</span><span class=lnt id=hl-15-17><a class=lnlinks href=#hl-15-17>17</a>
</span><span class=lnt id=hl-15-18><a class=lnlinks href=#hl-15-18>18</a>
</span><span class=lnt id=hl-15-19><a class=lnlinks href=#hl-15-19>19</a>
</span><span class=lnt id=hl-15-20><a class=lnlinks href=#hl-15-20>20</a>
</span><span class=lnt id=hl-15-21><a class=lnlinks href=#hl-15-21>21</a>
</span><span class=lnt id=hl-15-22><a class=lnlinks href=#hl-15-22>22</a>
</span><span class=lnt id=hl-15-23><a class=lnlinks href=#hl-15-23>23</a>
</span><span class=lnt id=hl-15-24><a class=lnlinks href=#hl-15-24>24</a>
</span><span class=lnt id=hl-15-25><a class=lnlinks href=#hl-15-25>25</a>
</span><span class=lnt id=hl-15-26><a class=lnlinks href=#hl-15-26>26</a>
</span><span class=lnt id=hl-15-27><a class=lnlinks href=#hl-15-27>27</a>
</span><span class=lnt id=hl-15-28><a class=lnlinks href=#hl-15-28>28</a>
</span><span class=lnt id=hl-15-29><a class=lnlinks href=#hl-15-29>29</a>
</span><span class=lnt id=hl-15-30><a class=lnlinks href=#hl-15-30>30</a>
</span><span class=lnt id=hl-15-31><a class=lnlinks href=#hl-15-31>31</a>
</span><span class=lnt id=hl-15-32><a class=lnlinks href=#hl-15-32>32</a>
</span><span class=lnt id=hl-15-33><a class=lnlinks href=#hl-15-33>33</a>
</span><span class=lnt id=hl-15-34><a class=lnlinks href=#hl-15-34>34</a>
</span><span class=lnt id=hl-15-35><a class=lnlinks href=#hl-15-35>35</a>
</span><span class=lnt id=hl-15-36><a class=lnlinks href=#hl-15-36>36</a>
</span><span class=lnt id=hl-15-37><a class=lnlinks href=#hl-15-37>37</a>
</span><span class=lnt id=hl-15-38><a class=lnlinks href=#hl-15-38>38</a>
</span><span class=lnt id=hl-15-39><a class=lnlinks href=#hl-15-39>39</a>
</span><span class=lnt id=hl-15-40><a class=lnlinks href=#hl-15-40>40</a>
</span><span class=lnt id=hl-15-41><a class=lnlinks href=#hl-15-41>41</a>
</span><span class=lnt id=hl-15-42><a class=lnlinks href=#hl-15-42>42</a>
</span><span class=lnt id=hl-15-43><a class=lnlinks href=#hl-15-43>43</a>
</span><span class=lnt id=hl-15-44><a class=lnlinks href=#hl-15-44>44</a>
</span><span class=lnt id=hl-15-45><a class=lnlinks href=#hl-15-45>45</a>
</span><span class=lnt id=hl-15-46><a class=lnlinks href=#hl-15-46>46</a>
</span><span class=lnt id=hl-15-47><a class=lnlinks href=#hl-15-47>47</a>
</span><span class=lnt id=hl-15-48><a class=lnlinks href=#hl-15-48>48</a>
</span><span class=lnt id=hl-15-49><a class=lnlinks href=#hl-15-49>49</a>
</span><span class=lnt id=hl-15-50><a class=lnlinks href=#hl-15-50>50</a>
</span><span class=lnt id=hl-15-51><a class=lnlinks href=#hl-15-51>51</a>
</span><span class=lnt id=hl-15-52><a class=lnlinks href=#hl-15-52>52</a>
</span><span class=lnt id=hl-15-53><a class=lnlinks href=#hl-15-53>53</a>
</span><span class=lnt id=hl-15-54><a class=lnlinks href=#hl-15-54>54</a>
</span><span class=lnt id=hl-15-55><a class=lnlinks href=#hl-15-55>55</a>
</span><span class=lnt id=hl-15-56><a class=lnlinks href=#hl-15-56>56</a>
</span><span class=lnt id=hl-15-57><a class=lnlinks href=#hl-15-57>57</a>
</span><span class=lnt id=hl-15-58><a class=lnlinks href=#hl-15-58>58</a>
</span><span class=lnt id=hl-15-59><a class=lnlinks href=#hl-15-59>59</a>
</span><span class=lnt id=hl-15-60><a class=lnlinks href=#hl-15-60>60</a>
</span><span class=lnt id=hl-15-61><a class=lnlinks href=#hl-15-61>61</a>
</span><span class=lnt id=hl-15-62><a class=lnlinks href=#hl-15-62>62</a>
</span><span class=lnt id=hl-15-63><a class=lnlinks href=#hl-15-63>63</a>
</span><span class=lnt id=hl-15-64><a class=lnlinks href=#hl-15-64>64</a>
</span><span class=lnt id=hl-15-65><a class=lnlinks href=#hl-15-65>65</a>
</span><span class=lnt id=hl-15-66><a class=lnlinks href=#hl-15-66>66</a>
</span><span class=lnt id=hl-15-67><a class=lnlinks href=#hl-15-67>67</a>
</span><span class=lnt id=hl-15-68><a class=lnlinks href=#hl-15-68>68</a>
</span><span class=lnt id=hl-15-69><a class=lnlinks href=#hl-15-69>69</a>
</span><span class=lnt id=hl-15-70><a class=lnlinks href=#hl-15-70>70</a>
</span><span class=lnt id=hl-15-71><a class=lnlinks href=#hl-15-71>71</a>
</span><span class=lnt id=hl-15-72><a class=lnlinks href=#hl-15-72>72</a>
</span><span class=lnt id=hl-15-73><a class=lnlinks href=#hl-15-73>73</a>
</span><span class=lnt id=hl-15-74><a class=lnlinks href=#hl-15-74>74</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># API 배포 구성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>api-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>api</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>api</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>api</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>my-api:1.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>readinessProbe</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>httpGet</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/health</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class=m>10</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1Gi&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0.5&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;512Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># API 서비스 (내부 로드 밸런서)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>api-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>api</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>ClusterIP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># 외부 인그레스 (외부 로드 밸런서)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>networking.k8s.io/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Ingress</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>api-ingress</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>nginx.ingress.kubernetes.io/rewrite-target</span><span class=p>:</span><span class=w> </span><span class=l>/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>nginx.ingress.kubernetes.io/ssl-redirect</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>nginx.ingress.kubernetes.io/backend-protocol</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;HTTP&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=l>api.example.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>pathType</span><span class=p>:</span><span class=w> </span><span class=l>Prefix</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>backend</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>api-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>port</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>number</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tls</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>hosts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>api.example.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>secretName</span><span class=p>:</span><span class=w> </span><span class=l>api-tls-secret</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=aws-환경에서의-api-로드-밸런싱>AWS 환경에서의 API 로드 밸런싱<a hidden class=anchor aria-hidden=true href=#aws-환경에서의-api-로드-밸런싱>#</a></h4><p>AWS Application Load Balancer(ALB)를 사용한 구성이다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11>11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12>12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13>13</a>
</span><span class=lnt id=hl-16-14><a class=lnlinks href=#hl-16-14>14</a>
</span><span class=lnt id=hl-16-15><a class=lnlinks href=#hl-16-15>15</a>
</span><span class=lnt id=hl-16-16><a class=lnlinks href=#hl-16-16>16</a>
</span><span class=lnt id=hl-16-17><a class=lnlinks href=#hl-16-17>17</a>
</span><span class=lnt id=hl-16-18><a class=lnlinks href=#hl-16-18>18</a>
</span><span class=lnt id=hl-16-19><a class=lnlinks href=#hl-16-19>19</a>
</span><span class=lnt id=hl-16-20><a class=lnlinks href=#hl-16-20>20</a>
</span><span class=lnt id=hl-16-21><a class=lnlinks href=#hl-16-21>21</a>
</span><span class=lnt id=hl-16-22><a class=lnlinks href=#hl-16-22>22</a>
</span><span class=lnt id=hl-16-23><a class=lnlinks href=#hl-16-23>23</a>
</span><span class=lnt id=hl-16-24><a class=lnlinks href=#hl-16-24>24</a>
</span><span class=lnt id=hl-16-25><a class=lnlinks href=#hl-16-25>25</a>
</span><span class=lnt id=hl-16-26><a class=lnlinks href=#hl-16-26>26</a>
</span><span class=lnt id=hl-16-27><a class=lnlinks href=#hl-16-27>27</a>
</span><span class=lnt id=hl-16-28><a class=lnlinks href=#hl-16-28>28</a>
</span><span class=lnt id=hl-16-29><a class=lnlinks href=#hl-16-29>29</a>
</span><span class=lnt id=hl-16-30><a class=lnlinks href=#hl-16-30>30</a>
</span><span class=lnt id=hl-16-31><a class=lnlinks href=#hl-16-31>31</a>
</span><span class=lnt id=hl-16-32><a class=lnlinks href=#hl-16-32>32</a>
</span><span class=lnt id=hl-16-33><a class=lnlinks href=#hl-16-33>33</a>
</span><span class=lnt id=hl-16-34><a class=lnlinks href=#hl-16-34>34</a>
</span><span class=lnt id=hl-16-35><a class=lnlinks href=#hl-16-35>35</a>
</span><span class=lnt id=hl-16-36><a class=lnlinks href=#hl-16-36>36</a>
</span><span class=lnt id=hl-16-37><a class=lnlinks href=#hl-16-37>37</a>
</span><span class=lnt id=hl-16-38><a class=lnlinks href=#hl-16-38>38</a>
</span><span class=lnt id=hl-16-39><a class=lnlinks href=#hl-16-39>39</a>
</span><span class=lnt id=hl-16-40><a class=lnlinks href=#hl-16-40>40</a>
</span><span class=lnt id=hl-16-41><a class=lnlinks href=#hl-16-41>41</a>
</span><span class=lnt id=hl-16-42><a class=lnlinks href=#hl-16-42>42</a>
</span><span class=lnt id=hl-16-43><a class=lnlinks href=#hl-16-43>43</a>
</span><span class=lnt id=hl-16-44><a class=lnlinks href=#hl-16-44>44</a>
</span><span class=lnt id=hl-16-45><a class=lnlinks href=#hl-16-45>45</a>
</span><span class=lnt id=hl-16-46><a class=lnlinks href=#hl-16-46>46</a>
</span><span class=lnt id=hl-16-47><a class=lnlinks href=#hl-16-47>47</a>
</span><span class=lnt id=hl-16-48><a class=lnlinks href=#hl-16-48>48</a>
</span><span class=lnt id=hl-16-49><a class=lnlinks href=#hl-16-49>49</a>
</span><span class=lnt id=hl-16-50><a class=lnlinks href=#hl-16-50>50</a>
</span><span class=lnt id=hl-16-51><a class=lnlinks href=#hl-16-51>51</a>
</span><span class=lnt id=hl-16-52><a class=lnlinks href=#hl-16-52>52</a>
</span><span class=lnt id=hl-16-53><a class=lnlinks href=#hl-16-53>53</a>
</span><span class=lnt id=hl-16-54><a class=lnlinks href=#hl-16-54>54</a>
</span><span class=lnt id=hl-16-55><a class=lnlinks href=#hl-16-55>55</a>
</span><span class=lnt id=hl-16-56><a class=lnlinks href=#hl-16-56>56</a>
</span><span class=lnt id=hl-16-57><a class=lnlinks href=#hl-16-57>57</a>
</span><span class=lnt id=hl-16-58><a class=lnlinks href=#hl-16-58>58</a>
</span><span class=lnt id=hl-16-59><a class=lnlinks href=#hl-16-59>59</a>
</span><span class=lnt id=hl-16-60><a class=lnlinks href=#hl-16-60>60</a>
</span><span class=lnt id=hl-16-61><a class=lnlinks href=#hl-16-61>61</a>
</span><span class=lnt id=hl-16-62><a class=lnlinks href=#hl-16-62>62</a>
</span><span class=lnt id=hl-16-63><a class=lnlinks href=#hl-16-63>63</a>
</span><span class=lnt id=hl-16-64><a class=lnlinks href=#hl-16-64>64</a>
</span><span class=lnt id=hl-16-65><a class=lnlinks href=#hl-16-65>65</a>
</span><span class=lnt id=hl-16-66><a class=lnlinks href=#hl-16-66>66</a>
</span><span class=lnt id=hl-16-67><a class=lnlinks href=#hl-16-67>67</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=c1>// AWS CloudFormation 템플릿 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;Resources&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ApiLoadBalancer&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Type&#34;</span><span class=p>:</span> <span class=s2>&#34;AWS::ElasticLoadBalancingV2::LoadBalancer&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Properties&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Name&#34;</span><span class=p>:</span> <span class=s2>&#34;api-load-balancer&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Subnets&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;subnet-12345&#34;</span><span class=p>,</span> <span class=s2>&#34;subnet-67890&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;SecurityGroups&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;sg-12345&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Scheme&#34;</span><span class=p>:</span> <span class=s2>&#34;internet-facing&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Type&#34;</span><span class=p>:</span> <span class=s2>&#34;application&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;IpAddressType&#34;</span><span class=p>:</span> <span class=s2>&#34;ipv4&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ApiTargetGroup&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Type&#34;</span><span class=p>:</span> <span class=s2>&#34;AWS::ElasticLoadBalancingV2::TargetGroup&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Properties&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Name&#34;</span><span class=p>:</span> <span class=s2>&#34;api-target-group&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Port&#34;</span><span class=p>:</span> <span class=mi>80</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Protocol&#34;</span><span class=p>:</span> <span class=s2>&#34;HTTP&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;VpcId&#34;</span><span class=p>:</span> <span class=s2>&#34;vpc-12345&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;HealthCheckPath&#34;</span><span class=p>:</span> <span class=s2>&#34;/health&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;HealthCheckIntervalSeconds&#34;</span><span class=p>:</span> <span class=mi>30</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;HealthCheckTimeoutSeconds&#34;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;HealthyThresholdCount&#34;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;UnhealthyThresholdCount&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;TargetType&#34;</span><span class=p>:</span> <span class=s2>&#34;instance&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ApiListener&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Type&#34;</span><span class=p>:</span> <span class=s2>&#34;AWS::ElasticLoadBalancingV2::Listener&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Properties&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;LoadBalancerArn&#34;</span><span class=p>:</span> <span class=p>{</span><span class=nt>&#34;Ref&#34;</span><span class=p>:</span> <span class=s2>&#34;ApiLoadBalancer&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Port&#34;</span><span class=p>:</span> <span class=mi>443</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Protocol&#34;</span><span class=p>:</span> <span class=s2>&#34;HTTPS&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Certificates&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span><span class=nt>&#34;CertificateArn&#34;</span><span class=p>:</span> <span class=s2>&#34;arn:aws:acm:region:account-id:certificate/certificate-id&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;DefaultActions&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Type&#34;</span><span class=p>:</span> <span class=s2>&#34;forward&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;TargetGroupArn&#34;</span><span class=p>:</span> <span class=p>{</span><span class=nt>&#34;Ref&#34;</span><span class=p>:</span> <span class=s2>&#34;ApiTargetGroup&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ApiListenerRule&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Type&#34;</span><span class=p>:</span> <span class=s2>&#34;AWS::ElasticLoadBalancingV2::ListenerRule&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Properties&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;ListenerArn&#34;</span><span class=p>:</span> <span class=p>{</span><span class=nt>&#34;Ref&#34;</span><span class=p>:</span> <span class=s2>&#34;ApiListener&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Priority&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Conditions&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Field&#34;</span><span class=p>:</span> <span class=s2>&#34;path-pattern&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Values&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;/api/*&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Actions&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>          <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Type&#34;</span><span class=p>:</span> <span class=s2>&#34;forward&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;TargetGroupArn&#34;</span><span class=p>:</span> <span class=p>{</span><span class=nt>&#34;Ref&#34;</span><span class=p>:</span> <span class=s2>&#34;ApiTargetGroup&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=api-로드-밸런싱의-모니터링-및-관리>API 로드 밸런싱의 모니터링 및 관리<a hidden class=anchor aria-hidden=true href=#api-로드-밸런싱의-모니터링-및-관리>#</a></h3><h4 id=주요-모니터링-지표>주요 모니터링 지표<a hidden class=anchor aria-hidden=true href=#주요-모니터링-지표>#</a></h4><p>API 로드 밸런싱 시스템의 건강 상태를 평가하기 위한 핵심 지표이다:</p><ol><li><strong>요청 처리량(Throughput)</strong>: 초당 처리되는 요청 수</li><li><strong>응답 시간(Response Time)</strong>: 요청 처리에 소요되는 시간</li><li><strong>오류율(Error Rate)</strong>: 총 요청 중 실패한 요청의 비율</li><li><strong>활성 연결 수(Active Connections)</strong>: 현재 열린 연결 수</li><li><strong>백엔드 서버 상태(Backend Server Health)</strong>: 각 서버의 상태 및 가용성</li><li><strong>세션 지속성(Session Persistence)</strong>: 세션이 유지되는 정도</li><li><strong>대기열 길이(Queue Length)</strong>: 처리 대기 중인 요청 수</li></ol><h4 id=로깅-및-분석>로깅 및 분석<a hidden class=anchor aria-hidden=true href=#로깅-및-분석>#</a></h4><p>효과적인 로드 밸런싱을 위한 로깅 전략:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1> 1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2> 2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3> 3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4> 4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5> 5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6> 6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7> 7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8> 8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9> 9</a>
</span><span class=lnt id=hl-17-10><a class=lnlinks href=#hl-17-10>10</a>
</span><span class=lnt id=hl-17-11><a class=lnlinks href=#hl-17-11>11</a>
</span><span class=lnt id=hl-17-12><a class=lnlinks href=#hl-17-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># NGINX 액세스 로깅 구성 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>log_format</span> <span class=s>lb_log</span> <span class=s>&#39;</span><span class=nv>$remote_addr</span> <span class=s>-</span> <span class=nv>$remote_user</span> <span class=s>[</span><span class=nv>$time_local]</span> <span class=s>&#39;</span>
</span></span><span class=line><span class=cl>                      <span class=s>&#39;&#34;</span><span class=nv>$request&#34;</span> <span class=nv>$status</span> <span class=nv>$body_bytes_sent</span> <span class=s>&#39;</span>
</span></span><span class=line><span class=cl>                      <span class=s>&#39;&#34;</span><span class=nv>$http_referer&#34;</span> <span class=s>&#34;</span><span class=nv>$http_user_agent&#34;</span> <span class=s>&#39;</span>
</span></span><span class=line><span class=cl>                      <span class=s>&#39;</span><span class=nv>$request_time</span> <span class=nv>$upstream_response_time</span> <span class=nv>$pipe</span> <span class=s>&#39;</span>
</span></span><span class=line><span class=cl>                      <span class=s>&#39;</span><span class=nv>$upstream_addr</span> <span class=nv>$upstream_status&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kn>access_log</span> <span class=s>/var/log/nginx/access.log</span> <span class=s>lb_log</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 나머지 구성…
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>로그 분석 도구:</p><ul><li>ELK 스택 (Elasticsearch, Logstash, Kibana)</li><li>Grafana + Prometheus</li><li>DataDog, New Relic 등 상용 모니터링 솔루션</li></ul><h4 id=자동-확장auto-scaling>자동 확장(Auto Scaling)<a hidden class=anchor aria-hidden=true href=#자동-확장auto-scaling>#</a></h4><p>부하에 따라 자동으로 백엔드 API 서버 수를 조정한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1> 1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2> 2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3> 3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4> 4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5> 5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6> 6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7> 7</a>
</span><span class=lnt id=hl-18-8><a class=lnlinks href=#hl-18-8> 8</a>
</span><span class=lnt id=hl-18-9><a class=lnlinks href=#hl-18-9> 9</a>
</span><span class=lnt id=hl-18-10><a class=lnlinks href=#hl-18-10>10</a>
</span><span class=lnt id=hl-18-11><a class=lnlinks href=#hl-18-11>11</a>
</span><span class=lnt id=hl-18-12><a class=lnlinks href=#hl-18-12>12</a>
</span><span class=lnt id=hl-18-13><a class=lnlinks href=#hl-18-13>13</a>
</span><span class=lnt id=hl-18-14><a class=lnlinks href=#hl-18-14>14</a>
</span><span class=lnt id=hl-18-15><a class=lnlinks href=#hl-18-15>15</a>
</span><span class=lnt id=hl-18-16><a class=lnlinks href=#hl-18-16>16</a>
</span><span class=lnt id=hl-18-17><a class=lnlinks href=#hl-18-17>17</a>
</span><span class=lnt id=hl-18-18><a class=lnlinks href=#hl-18-18>18</a>
</span><span class=lnt id=hl-18-19><a class=lnlinks href=#hl-18-19>19</a>
</span><span class=lnt id=hl-18-20><a class=lnlinks href=#hl-18-20>20</a>
</span><span class=lnt id=hl-18-21><a class=lnlinks href=#hl-18-21>21</a>
</span><span class=lnt id=hl-18-22><a class=lnlinks href=#hl-18-22>22</a>
</span><span class=lnt id=hl-18-23><a class=lnlinks href=#hl-18-23>23</a>
</span><span class=lnt id=hl-18-24><a class=lnlinks href=#hl-18-24>24</a>
</span><span class=lnt id=hl-18-25><a class=lnlinks href=#hl-18-25>25</a>
</span><span class=lnt id=hl-18-26><a class=lnlinks href=#hl-18-26>26</a>
</span><span class=lnt id=hl-18-27><a class=lnlinks href=#hl-18-27>27</a>
</span><span class=lnt id=hl-18-28><a class=lnlinks href=#hl-18-28>28</a>
</span><span class=lnt id=hl-18-29><a class=lnlinks href=#hl-18-29>29</a>
</span><span class=lnt id=hl-18-30><a class=lnlinks href=#hl-18-30>30</a>
</span><span class=lnt id=hl-18-31><a class=lnlinks href=#hl-18-31>31</a>
</span><span class=lnt id=hl-18-32><a class=lnlinks href=#hl-18-32>32</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># Kubernetes Horizontal Pod Autoscaler 예시</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>autoscaling/v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>HorizontalPodAutoscaler</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>api-hpa</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>scaleTargetRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>api-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>minReplicas</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>maxReplicas</span><span class=p>:</span><span class=w> </span><span class=m>10</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resource</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>cpu</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>target</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Utilization</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>averageUtilization</span><span class=p>:</span><span class=w> </span><span class=m>70</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resource</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>memory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>target</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Utilization</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>averageUtilization</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Pods</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pods</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>metric</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>requests_per_second</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>target</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>AverageValue</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>averageValue</span><span class=p>:</span><span class=w> </span><span class=m>1000</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=재해-복구-및-장애-조치>재해 복구 및 장애 조치<a hidden class=anchor aria-hidden=true href=#재해-복구-및-장애-조치>#</a></h4><p>로드 밸런싱 시스템의 복원력을 보장하기 위한 전략:</p><ol><li><strong>다중 가용 영역(Multi-AZ) 배포</strong>: 지리적으로 분산된 데이터 센터에 로드 밸런서 배포</li><li><strong>로드 밸런서 클러스터링</strong>: 로드 밸런서의 고가용성 클러스터 구성</li><li><strong>자동 장애 조치</strong>: 기본 로드 밸런서 실패 시 보조 로드 밸런서로 자동 전환</li><li><strong>백업 및 복원 절차</strong>: 로드 밸런서 구성의 정기적인 백업 및 복원 테스트</li></ol><h3 id=api-로드-밸런싱의-보안-고려사항>API 로드 밸런싱의 보안 고려사항<a hidden class=anchor aria-hidden=true href=#api-로드-밸런싱의-보안-고려사항>#</a></h3><h4 id=ddos-방어>DDoS 방어<a hidden class=anchor aria-hidden=true href=#ddos-방어>#</a></h4><p>분산 서비스 거부 공격으로부터 API를 보호한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12>12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13>13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14>14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15>15</a>
</span><span class=lnt id=hl-19-16><a class=lnlinks href=#hl-19-16>16</a>
</span><span class=lnt id=hl-19-17><a class=lnlinks href=#hl-19-17>17</a>
</span><span class=lnt id=hl-19-18><a class=lnlinks href=#hl-19-18>18</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># NGINX DDoS 보호 구성 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1># 연결 속도 제한
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kn>limit_conn_zone</span> <span class=nv>$binary_remote_addr</span> <span class=s>zone=conn_limit_per_ip:10m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>limit_conn</span> <span class=s>conn_limit_per_ip</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 요청 속도 제한
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kn>limit_req_zone</span> <span class=nv>$binary_remote_addr</span> <span class=s>zone=req_limit_per_ip:10m</span> <span class=s>rate=5r/s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1># API 엔드포인트에 속도 제한 적용
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=s>/api/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>limit_req</span> <span class=s>zone=req_limit_per_ip</span> <span class=s>burst=10</span> <span class=s>nodelay</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 나머지 구성…
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=ssltls-구성>SSL/TLS 구성<a hidden class=anchor aria-hidden=true href=#ssltls-구성>#</a></h4><p>안전한 API 통신을 보장한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1> 1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2> 2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3> 3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4> 4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5> 5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6> 6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7> 7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8> 8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9> 9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10>10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11>11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12>12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13>13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14>14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15>15</a>
</span><span class=lnt id=hl-20-16><a class=lnlinks href=#hl-20-16>16</a>
</span><span class=lnt id=hl-20-17><a class=lnlinks href=#hl-20-17>17</a>
</span><span class=lnt id=hl-20-18><a class=lnlinks href=#hl-20-18>18</a>
</span><span class=lnt id=hl-20-19><a class=lnlinks href=#hl-20-19>19</a>
</span><span class=lnt id=hl-20-20><a class=lnlinks href=#hl-20-20>20</a>
</span><span class=lnt id=hl-20-21><a class=lnlinks href=#hl-20-21>21</a>
</span><span class=lnt id=hl-20-22><a class=lnlinks href=#hl-20-22>22</a>
</span><span class=lnt id=hl-20-23><a class=lnlinks href=#hl-20-23>23</a>
</span><span class=lnt id=hl-20-24><a class=lnlinks href=#hl-20-24>24</a>
</span><span class=lnt id=hl-20-25><a class=lnlinks href=#hl-20-25>25</a>
</span><span class=lnt id=hl-20-26><a class=lnlinks href=#hl-20-26>26</a>
</span><span class=lnt id=hl-20-27><a class=lnlinks href=#hl-20-27>27</a>
</span><span class=lnt id=hl-20-28><a class=lnlinks href=#hl-20-28>28</a>
</span><span class=lnt id=hl-20-29><a class=lnlinks href=#hl-20-29>29</a>
</span><span class=lnt id=hl-20-30><a class=lnlinks href=#hl-20-30>30</a>
</span><span class=lnt id=hl-20-31><a class=lnlinks href=#hl-20-31>31</a>
</span><span class=lnt id=hl-20-32><a class=lnlinks href=#hl-20-32>32</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># NGINX 보안 SSL 구성 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>listen</span> <span class=mi>443</span> <span class=s>ssl</span> <span class=s>http2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>server_name</span> <span class=s>api.example.com</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># SSL 인증서 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>ssl_certificate</span> <span class=s>/etc/nginx/ssl/api.example.com.crt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>ssl_certificate_key</span> <span class=s>/etc/nginx/ssl/api.example.com.key</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># SSL 프로토콜 및 암호화 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>ssl_protocols</span> <span class=s>TLSv1.2</span> <span class=s>TLSv1.3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>ssl_prefer_server_ciphers</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>ssl_ciphers</span> <span class=s>&#39;ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># HSTS 설정 (HTTP Strict Transport Security)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>add_header</span> <span class=s>Strict-Transport-Security</span> <span class=s>&#34;max-age=63072000</span><span class=p>;</span> <span class=kn>includeSubDomains</span><span class=p>;</span> <span class=kn>preload&#34;</span> <span class=s>always</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># SSL 세션 캐싱
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>ssl_session_timeout</span> <span class=s>1d</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>ssl_session_cache</span> <span class=s>shared:SSL:10m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>ssl_session_tickets</span> <span class=no>off</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># OCSP 스테이플링
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>ssl_stapling</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>ssl_stapling_verify</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>resolver</span> <span class=n>8.8.8.8</span> <span class=n>8.8.4.4</span> <span class=s>valid=300s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>resolver_timeout</span> <span class=s>5s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 나머지 구성…
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=api-인증-및-권한-부여>API 인증 및 권한 부여<a hidden class=anchor aria-hidden=true href=#api-인증-및-권한-부여>#</a></h4><p>로드 밸런서 수준에서 API 접근 제어를 구현한다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span><span class=lnt id=hl-21-11><a class=lnlinks href=#hl-21-11>11</a>
</span><span class=lnt id=hl-21-12><a class=lnlinks href=#hl-21-12>12</a>
</span><span class=lnt id=hl-21-13><a class=lnlinks href=#hl-21-13>13</a>
</span><span class=lnt id=hl-21-14><a class=lnlinks href=#hl-21-14>14</a>
</span><span class=lnt id=hl-21-15><a class=lnlinks href=#hl-21-15>15</a>
</span><span class=lnt id=hl-21-16><a class=lnlinks href=#hl-21-16>16</a>
</span><span class=lnt id=hl-21-17><a class=lnlinks href=#hl-21-17>17</a>
</span><span class=lnt id=hl-21-18><a class=lnlinks href=#hl-21-18>18</a>
</span><span class=lnt id=hl-21-19><a class=lnlinks href=#hl-21-19>19</a>
</span><span class=lnt id=hl-21-20><a class=lnlinks href=#hl-21-20>20</a>
</span><span class=lnt id=hl-21-21><a class=lnlinks href=#hl-21-21>21</a>
</span><span class=lnt id=hl-21-22><a class=lnlinks href=#hl-21-22>22</a>
</span><span class=lnt id=hl-21-23><a class=lnlinks href=#hl-21-23>23</a>
</span><span class=lnt id=hl-21-24><a class=lnlinks href=#hl-21-24>24</a>
</span><span class=lnt id=hl-21-25><a class=lnlinks href=#hl-21-25>25</a>
</span><span class=lnt id=hl-21-26><a class=lnlinks href=#hl-21-26>26</a>
</span><span class=lnt id=hl-21-27><a class=lnlinks href=#hl-21-27>27</a>
</span><span class=lnt id=hl-21-28><a class=lnlinks href=#hl-21-28>28</a>
</span><span class=lnt id=hl-21-29><a class=lnlinks href=#hl-21-29>29</a>
</span><span class=lnt id=hl-21-30><a class=lnlinks href=#hl-21-30>30</a>
</span><span class=lnt id=hl-21-31><a class=lnlinks href=#hl-21-31>31</a>
</span><span class=lnt id=hl-21-32><a class=lnlinks href=#hl-21-32>32</a>
</span><span class=lnt id=hl-21-33><a class=lnlinks href=#hl-21-33>33</a>
</span><span class=lnt id=hl-21-34><a class=lnlinks href=#hl-21-34>34</a>
</span><span class=lnt id=hl-21-35><a class=lnlinks href=#hl-21-35>35</a>
</span><span class=lnt id=hl-21-36><a class=lnlinks href=#hl-21-36>36</a>
</span><span class=lnt id=hl-21-37><a class=lnlinks href=#hl-21-37>37</a>
</span><span class=lnt id=hl-21-38><a class=lnlinks href=#hl-21-38>38</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># NGINX API 인증 구성 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1># API 키 검증
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=s>/api/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>auth_request</span> <span class=s>/validate-api-key</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 나머지 구성…
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># API 키 검증 내부 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=p>=</span> <span class=s>/validate-api-key</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>internal</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass</span> <span class=s>http://auth-service/validate</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass_request_body</span> <span class=no>off</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_set_header</span> <span class=s>Content-Length</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_set_header</span> <span class=s>X-Original-URI</span> <span class=nv>$request_uri</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_set_header</span> <span class=s>X-API-Key</span> <span class=nv>$http_x_api_key</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># JWT 검증이 필요한 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=s>/api/secure/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>auth_request</span> <span class=s>/validate-jwt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 나머지 구성…
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># JWT 검증 내부 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=p>=</span> <span class=s>/validate-jwt</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>internal</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass</span> <span class=s>http://auth-service/validate-jwt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass_request_body</span> <span class=no>off</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_set_header</span> <span class=s>Content-Length</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_set_header</span> <span class=s>X-Original-URI</span> <span class=nv>$request_uri</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_set_header</span> <span class=s>Authorization</span> <span class=nv>$http_authorization</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=waf웹-애플리케이션-방화벽-통합>WAF(웹 애플리케이션 방화벽) 통합<a hidden class=anchor aria-hidden=true href=#waf웹-애플리케이션-방화벽-통합>#</a></h4><p>로드 밸런서와 WAF를 통합하여 API 보안 강화:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1> 1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2> 2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3> 3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4> 4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5> 5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6> 6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7> 7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8> 8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9> 9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10>10</a>
</span><span class=lnt id=hl-22-11><a class=lnlinks href=#hl-22-11>11</a>
</span><span class=lnt id=hl-22-12><a class=lnlinks href=#hl-22-12>12</a>
</span><span class=lnt id=hl-22-13><a class=lnlinks href=#hl-22-13>13</a>
</span><span class=lnt id=hl-22-14><a class=lnlinks href=#hl-22-14>14</a>
</span><span class=lnt id=hl-22-15><a class=lnlinks href=#hl-22-15>15</a>
</span><span class=lnt id=hl-22-16><a class=lnlinks href=#hl-22-16>16</a>
</span><span class=lnt id=hl-22-17><a class=lnlinks href=#hl-22-17>17</a>
</span><span class=lnt id=hl-22-18><a class=lnlinks href=#hl-22-18>18</a>
</span><span class=lnt id=hl-22-19><a class=lnlinks href=#hl-22-19>19</a>
</span><span class=lnt id=hl-22-20><a class=lnlinks href=#hl-22-20>20</a>
</span><span class=lnt id=hl-22-21><a class=lnlinks href=#hl-22-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># ModSecurity WAF와 NGINX 통합 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>load_module</span> <span class=s>modules/ngx_http_modsecurity_module.so</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1># ModSecurity WAF 활성화
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>modsecurity</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>modsecurity_rules_file</span> <span class=s>/etc/nginx/modsecurity/main.conf</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># OWASP ModSecurity Core Rule Set 적용
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=s>/api/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1># 로드 밸런싱 구성
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>proxy_pass</span> <span class=s>http://api_backend</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># WAF 로깅
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>modsecurity_transaction_id</span> <span class=s>&#34;</span><span class=nv>$remote_addr-$request_id&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 나머지 구성…
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=api-로드-밸런싱의-성능-최적화>API 로드 밸런싱의 성능 최적화<a hidden class=anchor aria-hidden=true href=#api-로드-밸런싱의-성능-최적화>#</a></h3><h4 id=연결-처리-최적화>연결 처리 최적화<a hidden class=anchor aria-hidden=true href=#연결-처리-최적화>#</a></h4><p>대량의 API 요청을 효율적으로 처리하기 위한 연결 최적화:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1> 1</a>
</span><span class=lnt id=hl-23-2><a class=lnlinks href=#hl-23-2> 2</a>
</span><span class=lnt id=hl-23-3><a class=lnlinks href=#hl-23-3> 3</a>
</span><span class=lnt id=hl-23-4><a class=lnlinks href=#hl-23-4> 4</a>
</span><span class=lnt id=hl-23-5><a class=lnlinks href=#hl-23-5> 5</a>
</span><span class=lnt id=hl-23-6><a class=lnlinks href=#hl-23-6> 6</a>
</span><span class=lnt id=hl-23-7><a class=lnlinks href=#hl-23-7> 7</a>
</span><span class=lnt id=hl-23-8><a class=lnlinks href=#hl-23-8> 8</a>
</span><span class=lnt id=hl-23-9><a class=lnlinks href=#hl-23-9> 9</a>
</span><span class=lnt id=hl-23-10><a class=lnlinks href=#hl-23-10>10</a>
</span><span class=lnt id=hl-23-11><a class=lnlinks href=#hl-23-11>11</a>
</span><span class=lnt id=hl-23-12><a class=lnlinks href=#hl-23-12>12</a>
</span><span class=lnt id=hl-23-13><a class=lnlinks href=#hl-23-13>13</a>
</span><span class=lnt id=hl-23-14><a class=lnlinks href=#hl-23-14>14</a>
</span><span class=lnt id=hl-23-15><a class=lnlinks href=#hl-23-15>15</a>
</span><span class=lnt id=hl-23-16><a class=lnlinks href=#hl-23-16>16</a>
</span><span class=lnt id=hl-23-17><a class=lnlinks href=#hl-23-17>17</a>
</span><span class=lnt id=hl-23-18><a class=lnlinks href=#hl-23-18>18</a>
</span><span class=lnt id=hl-23-19><a class=lnlinks href=#hl-23-19>19</a>
</span><span class=lnt id=hl-23-20><a class=lnlinks href=#hl-23-20>20</a>
</span><span class=lnt id=hl-23-21><a class=lnlinks href=#hl-23-21>21</a>
</span><span class=lnt id=hl-23-22><a class=lnlinks href=#hl-23-22>22</a>
</span><span class=lnt id=hl-23-23><a class=lnlinks href=#hl-23-23>23</a>
</span><span class=lnt id=hl-23-24><a class=lnlinks href=#hl-23-24>24</a>
</span><span class=lnt id=hl-23-25><a class=lnlinks href=#hl-23-25>25</a>
</span><span class=lnt id=hl-23-26><a class=lnlinks href=#hl-23-26>26</a>
</span><span class=lnt id=hl-23-27><a class=lnlinks href=#hl-23-27>27</a>
</span><span class=lnt id=hl-23-28><a class=lnlinks href=#hl-23-28>28</a>
</span><span class=lnt id=hl-23-29><a class=lnlinks href=#hl-23-29>29</a>
</span><span class=lnt id=hl-23-30><a class=lnlinks href=#hl-23-30>30</a>
</span><span class=lnt id=hl-23-31><a class=lnlinks href=#hl-23-31>31</a>
</span><span class=lnt id=hl-23-32><a class=lnlinks href=#hl-23-32>32</a>
</span><span class=lnt id=hl-23-33><a class=lnlinks href=#hl-23-33>33</a>
</span><span class=lnt id=hl-23-34><a class=lnlinks href=#hl-23-34>34</a>
</span><span class=lnt id=hl-23-35><a class=lnlinks href=#hl-23-35>35</a>
</span><span class=lnt id=hl-23-36><a class=lnlinks href=#hl-23-36>36</a>
</span><span class=lnt id=hl-23-37><a class=lnlinks href=#hl-23-37>37</a>
</span><span class=lnt id=hl-23-38><a class=lnlinks href=#hl-23-38>38</a>
</span><span class=lnt id=hl-23-39><a class=lnlinks href=#hl-23-39>39</a>
</span><span class=lnt id=hl-23-40><a class=lnlinks href=#hl-23-40>40</a>
</span><span class=lnt id=hl-23-41><a class=lnlinks href=#hl-23-41>41</a>
</span><span class=lnt id=hl-23-42><a class=lnlinks href=#hl-23-42>42</a>
</span><span class=lnt id=hl-23-43><a class=lnlinks href=#hl-23-43>43</a>
</span><span class=lnt id=hl-23-44><a class=lnlinks href=#hl-23-44>44</a>
</span><span class=lnt id=hl-23-45><a class=lnlinks href=#hl-23-45>45</a>
</span><span class=lnt id=hl-23-46><a class=lnlinks href=#hl-23-46>46</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># NGINX 연결 최적화 구성 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>worker_processes</span> <span class=s>auto</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>worker_rlimit_nofile</span> <span class=mi>65535</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>events</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>worker_connections</span> <span class=mi>16384</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>multi_accept</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>use</span> <span class=s>epoll</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1># 타임아웃 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kn>keepalive_timeout</span> <span class=mi>65</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>keepalive_requests</span> <span class=mi>100000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 클라이언트 버퍼 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kn>client_body_buffer_size</span> <span class=mi>128k</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>client_max_body_size</span> <span class=mi>10m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>client_body_timeout</span> <span class=mi>12</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>client_header_timeout</span> <span class=mi>12</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 파일 디스크립터 캐싱
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kn>open_file_cache</span> <span class=s>max=200000</span> <span class=s>inactive=20s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>open_file_cache_valid</span> <span class=s>30s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>open_file_cache_min_uses</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>open_file_cache_errors</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 업스트림 연결 최적화
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kn>upstream</span> <span class=s>api_backend</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>server</span> <span class=n>api1.example.com</span><span class=p>:</span><span class=mi>8080</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>server</span> <span class=n>api2.example.com</span><span class=p>:</span><span class=mi>8080</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kn>keepalive</span> <span class=mi>100</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>keepalive_requests</span> <span class=mi>1000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>keepalive_timeout</span> <span class=s>60s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1># 연결 유지 헤더 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=s>/api/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass</span> <span class=s>http://api_backend</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_http_version</span> <span class=mi>1</span><span class=s>.1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_set_header</span> <span class=s>Connection</span> <span class=s>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=압축-및-캐싱>압축 및 캐싱<a hidden class=anchor aria-hidden=true href=#압축-및-캐싱>#</a></h4><p>대역폭 사용 최적화 및 응답 시간 개선:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1> 1</a>
</span><span class=lnt id=hl-24-2><a class=lnlinks href=#hl-24-2> 2</a>
</span><span class=lnt id=hl-24-3><a class=lnlinks href=#hl-24-3> 3</a>
</span><span class=lnt id=hl-24-4><a class=lnlinks href=#hl-24-4> 4</a>
</span><span class=lnt id=hl-24-5><a class=lnlinks href=#hl-24-5> 5</a>
</span><span class=lnt id=hl-24-6><a class=lnlinks href=#hl-24-6> 6</a>
</span><span class=lnt id=hl-24-7><a class=lnlinks href=#hl-24-7> 7</a>
</span><span class=lnt id=hl-24-8><a class=lnlinks href=#hl-24-8> 8</a>
</span><span class=lnt id=hl-24-9><a class=lnlinks href=#hl-24-9> 9</a>
</span><span class=lnt id=hl-24-10><a class=lnlinks href=#hl-24-10>10</a>
</span><span class=lnt id=hl-24-11><a class=lnlinks href=#hl-24-11>11</a>
</span><span class=lnt id=hl-24-12><a class=lnlinks href=#hl-24-12>12</a>
</span><span class=lnt id=hl-24-13><a class=lnlinks href=#hl-24-13>13</a>
</span><span class=lnt id=hl-24-14><a class=lnlinks href=#hl-24-14>14</a>
</span><span class=lnt id=hl-24-15><a class=lnlinks href=#hl-24-15>15</a>
</span><span class=lnt id=hl-24-16><a class=lnlinks href=#hl-24-16>16</a>
</span><span class=lnt id=hl-24-17><a class=lnlinks href=#hl-24-17>17</a>
</span><span class=lnt id=hl-24-18><a class=lnlinks href=#hl-24-18>18</a>
</span><span class=lnt id=hl-24-19><a class=lnlinks href=#hl-24-19>19</a>
</span><span class=lnt id=hl-24-20><a class=lnlinks href=#hl-24-20>20</a>
</span><span class=lnt id=hl-24-21><a class=lnlinks href=#hl-24-21>21</a>
</span><span class=lnt id=hl-24-22><a class=lnlinks href=#hl-24-22>22</a>
</span><span class=lnt id=hl-24-23><a class=lnlinks href=#hl-24-23>23</a>
</span><span class=lnt id=hl-24-24><a class=lnlinks href=#hl-24-24>24</a>
</span><span class=lnt id=hl-24-25><a class=lnlinks href=#hl-24-25>25</a>
</span><span class=lnt id=hl-24-26><a class=lnlinks href=#hl-24-26>26</a>
</span><span class=lnt id=hl-24-27><a class=lnlinks href=#hl-24-27>27</a>
</span><span class=lnt id=hl-24-28><a class=lnlinks href=#hl-24-28>28</a>
</span><span class=lnt id=hl-24-29><a class=lnlinks href=#hl-24-29>29</a>
</span><span class=lnt id=hl-24-30><a class=lnlinks href=#hl-24-30>30</a>
</span><span class=lnt id=hl-24-31><a class=lnlinks href=#hl-24-31>31</a>
</span><span class=lnt id=hl-24-32><a class=lnlinks href=#hl-24-32>32</a>
</span><span class=lnt id=hl-24-33><a class=lnlinks href=#hl-24-33>33</a>
</span><span class=lnt id=hl-24-34><a class=lnlinks href=#hl-24-34>34</a>
</span><span class=lnt id=hl-24-35><a class=lnlinks href=#hl-24-35>35</a>
</span><span class=lnt id=hl-24-36><a class=lnlinks href=#hl-24-36>36</a>
</span><span class=lnt id=hl-24-37><a class=lnlinks href=#hl-24-37>37</a>
</span><span class=lnt id=hl-24-38><a class=lnlinks href=#hl-24-38>38</a>
</span><span class=lnt id=hl-24-39><a class=lnlinks href=#hl-24-39>39</a>
</span><span class=lnt id=hl-24-40><a class=lnlinks href=#hl-24-40>40</a>
</span><span class=lnt id=hl-24-41><a class=lnlinks href=#hl-24-41>41</a>
</span><span class=lnt id=hl-24-42><a class=lnlinks href=#hl-24-42>42</a>
</span><span class=lnt id=hl-24-43><a class=lnlinks href=#hl-24-43>43</a>
</span><span class=lnt id=hl-24-44><a class=lnlinks href=#hl-24-44>44</a>
</span><span class=lnt id=hl-24-45><a class=lnlinks href=#hl-24-45>45</a>
</span><span class=lnt id=hl-24-46><a class=lnlinks href=#hl-24-46>46</a>
</span><span class=lnt id=hl-24-47><a class=lnlinks href=#hl-24-47>47</a>
</span><span class=lnt id=hl-24-48><a class=lnlinks href=#hl-24-48>48</a>
</span><span class=lnt id=hl-24-49><a class=lnlinks href=#hl-24-49>49</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># NGINX 압축 및 캐싱 구성 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1># 정적 콘텐츠 압축
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kn>gzip</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>gzip_comp_level</span> <span class=mi>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>gzip_min_length</span> <span class=mi>256</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>gzip_proxied</span> <span class=s>any</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>gzip_types</span> <span class=s>application/json</span> <span class=s>application/xml</span> <span class=s>application/javascript</span> <span class=s>text/plain</span> <span class=s>text/css</span> <span class=s>text/xml</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>gzip_vary</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 캐싱 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kn>proxy_cache_path</span> <span class=s>/var/cache/nginx</span> <span class=s>levels=1:2</span> <span class=s>keys_zone=api_cache:10m</span> <span class=s>inactive=60m</span> <span class=s>max_size=1g</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1># API 응답 캐싱
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=s>/api/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass</span> <span class=s>http://api_backend</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 캐싱 활성화 (GET 요청만)
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>proxy_cache</span> <span class=s>api_cache</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_cache_methods</span> <span class=s>GET</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_cache_valid</span> <span class=mi>200</span> <span class=mi>302</span> <span class=mi>10m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_cache_valid</span> <span class=mi>404</span> <span class=mi>1m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_cache_key</span> <span class=nv>$scheme$request_method$host$request_uri</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 캐시 재검증
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>proxy_cache_revalidate</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_cache_use_stale</span> <span class=s>error</span> <span class=s>timeout</span> <span class=s>updating</span> <span class=s>http_500</span> <span class=s>http_502</span> <span class=s>http_503</span> <span class=s>http_504</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_cache_background_update</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 캐시 상태 헤더
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>add_header</span> <span class=s>X-Cache-Status</span> <span class=nv>$upstream_cache_status</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 조건부 캐싱 (인증 요청은 캐시하지 않음)
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>proxy_cache_bypass</span> <span class=nv>$http_authorization</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_no_cache</span> <span class=nv>$http_authorization</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 나머지 구성…
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 캐시 무효화 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=p>~</span> <span class=sr>/purge/(.+)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>allow</span> <span class=n>127.0.0.1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>deny</span> <span class=s>all</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=kn>proxy_cache_purge</span> <span class=s>api_cache</span> <span class=nv>$scheme$request_method$host$1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=http2-및-http3-지원>HTTP/2 및 HTTP/3 지원<a hidden class=anchor aria-hidden=true href=#http2-및-http3-지원>#</a></h4><p>최신 HTTP 프로토콜을 활용한 성능 향상:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1> 1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2> 2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3> 3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4> 4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5> 5</a>
</span><span class=lnt id=hl-25-6><a class=lnlinks href=#hl-25-6> 6</a>
</span><span class=lnt id=hl-25-7><a class=lnlinks href=#hl-25-7> 7</a>
</span><span class=lnt id=hl-25-8><a class=lnlinks href=#hl-25-8> 8</a>
</span><span class=lnt id=hl-25-9><a class=lnlinks href=#hl-25-9> 9</a>
</span><span class=lnt id=hl-25-10><a class=lnlinks href=#hl-25-10>10</a>
</span><span class=lnt id=hl-25-11><a class=lnlinks href=#hl-25-11>11</a>
</span><span class=lnt id=hl-25-12><a class=lnlinks href=#hl-25-12>12</a>
</span><span class=lnt id=hl-25-13><a class=lnlinks href=#hl-25-13>13</a>
</span><span class=lnt id=hl-25-14><a class=lnlinks href=#hl-25-14>14</a>
</span><span class=lnt id=hl-25-15><a class=lnlinks href=#hl-25-15>15</a>
</span><span class=lnt id=hl-25-16><a class=lnlinks href=#hl-25-16>16</a>
</span><span class=lnt id=hl-25-17><a class=lnlinks href=#hl-25-17>17</a>
</span><span class=lnt id=hl-25-18><a class=lnlinks href=#hl-25-18>18</a>
</span><span class=lnt id=hl-25-19><a class=lnlinks href=#hl-25-19>19</a>
</span><span class=lnt id=hl-25-20><a class=lnlinks href=#hl-25-20>20</a>
</span><span class=lnt id=hl-25-21><a class=lnlinks href=#hl-25-21>21</a>
</span><span class=lnt id=hl-25-22><a class=lnlinks href=#hl-25-22>22</a>
</span><span class=lnt id=hl-25-23><a class=lnlinks href=#hl-25-23>23</a>
</span><span class=lnt id=hl-25-24><a class=lnlinks href=#hl-25-24>24</a>
</span><span class=lnt id=hl-25-25><a class=lnlinks href=#hl-25-25>25</a>
</span><span class=lnt id=hl-25-26><a class=lnlinks href=#hl-25-26>26</a>
</span><span class=lnt id=hl-25-27><a class=lnlinks href=#hl-25-27>27</a>
</span><span class=lnt id=hl-25-28><a class=lnlinks href=#hl-25-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># NGINX HTTP/2 및 HTTP/3 구성 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>listen</span> <span class=mi>443</span> <span class=s>ssl</span> <span class=s>http2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>listen</span> <span class=mi>443</span> <span class=s>quic</span> <span class=s>reuseport</span><span class=p>;</span> <span class=c1># HTTP/3 지원
</span></span></span><span class=line><span class=cl><span class=c1></span>        
</span></span><span class=line><span class=cl>        <span class=kn>http2_max_concurrent_streams</span> <span class=mi>128</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>http2_push_preload</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># QUIC 및 HTTP/3 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>quic_retry</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>quic_gso</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Alt-Svc 헤더 설정 (HTTP/3 광고)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>add_header</span> <span class=s>Alt-Svc</span> <span class=s>&#39;h3=&#34;:443&#34;</span><span class=p>;</span> <span class=kn>ma=86400&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># SSL 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>ssl_certificate</span> <span class=s>/etc/nginx/ssl/api.example.com.crt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>ssl_certificate_key</span> <span class=s>/etc/nginx/ssl/api.example.com.key</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># HTTP/2 서버 푸시 (정적 리소스용)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=s>/api/v1/products</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>http2_push</span> <span class=s>/api/v1/categories</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>http2_push</span> <span class=s>/api/v1/recommendations</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass</span> <span class=s>http://api_backend</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=비동기-및-스트리밍-api-지원>비동기 및 스트리밍 API 지원<a hidden class=anchor aria-hidden=true href=#비동기-및-스트리밍-api-지원>#</a></h4><p>장기 실행 요청 및 이벤트 스트림을 위한 최적화:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-26-1><a class=lnlinks href=#hl-26-1> 1</a>
</span><span class=lnt id=hl-26-2><a class=lnlinks href=#hl-26-2> 2</a>
</span><span class=lnt id=hl-26-3><a class=lnlinks href=#hl-26-3> 3</a>
</span><span class=lnt id=hl-26-4><a class=lnlinks href=#hl-26-4> 4</a>
</span><span class=lnt id=hl-26-5><a class=lnlinks href=#hl-26-5> 5</a>
</span><span class=lnt id=hl-26-6><a class=lnlinks href=#hl-26-6> 6</a>
</span><span class=lnt id=hl-26-7><a class=lnlinks href=#hl-26-7> 7</a>
</span><span class=lnt id=hl-26-8><a class=lnlinks href=#hl-26-8> 8</a>
</span><span class=lnt id=hl-26-9><a class=lnlinks href=#hl-26-9> 9</a>
</span><span class=lnt id=hl-26-10><a class=lnlinks href=#hl-26-10>10</a>
</span><span class=lnt id=hl-26-11><a class=lnlinks href=#hl-26-11>11</a>
</span><span class=lnt id=hl-26-12><a class=lnlinks href=#hl-26-12>12</a>
</span><span class=lnt id=hl-26-13><a class=lnlinks href=#hl-26-13>13</a>
</span><span class=lnt id=hl-26-14><a class=lnlinks href=#hl-26-14>14</a>
</span><span class=lnt id=hl-26-15><a class=lnlinks href=#hl-26-15>15</a>
</span><span class=lnt id=hl-26-16><a class=lnlinks href=#hl-26-16>16</a>
</span><span class=lnt id=hl-26-17><a class=lnlinks href=#hl-26-17>17</a>
</span><span class=lnt id=hl-26-18><a class=lnlinks href=#hl-26-18>18</a>
</span><span class=lnt id=hl-26-19><a class=lnlinks href=#hl-26-19>19</a>
</span><span class=lnt id=hl-26-20><a class=lnlinks href=#hl-26-20>20</a>
</span><span class=lnt id=hl-26-21><a class=lnlinks href=#hl-26-21>21</a>
</span><span class=lnt id=hl-26-22><a class=lnlinks href=#hl-26-22>22</a>
</span><span class=lnt id=hl-26-23><a class=lnlinks href=#hl-26-23>23</a>
</span><span class=lnt id=hl-26-24><a class=lnlinks href=#hl-26-24>24</a>
</span><span class=lnt id=hl-26-25><a class=lnlinks href=#hl-26-25>25</a>
</span><span class=lnt id=hl-26-26><a class=lnlinks href=#hl-26-26>26</a>
</span><span class=lnt id=hl-26-27><a class=lnlinks href=#hl-26-27>27</a>
</span><span class=lnt id=hl-26-28><a class=lnlinks href=#hl-26-28>28</a>
</span><span class=lnt id=hl-26-29><a class=lnlinks href=#hl-26-29>29</a>
</span><span class=lnt id=hl-26-30><a class=lnlinks href=#hl-26-30>30</a>
</span><span class=lnt id=hl-26-31><a class=lnlinks href=#hl-26-31>31</a>
</span><span class=lnt id=hl-26-32><a class=lnlinks href=#hl-26-32>32</a>
</span><span class=lnt id=hl-26-33><a class=lnlinks href=#hl-26-33>33</a>
</span><span class=lnt id=hl-26-34><a class=lnlinks href=#hl-26-34>34</a>
</span><span class=lnt id=hl-26-35><a class=lnlinks href=#hl-26-35>35</a>
</span><span class=lnt id=hl-26-36><a class=lnlinks href=#hl-26-36>36</a>
</span><span class=lnt id=hl-26-37><a class=lnlinks href=#hl-26-37>37</a>
</span><span class=lnt id=hl-26-38><a class=lnlinks href=#hl-26-38>38</a>
</span><span class=lnt id=hl-26-39><a class=lnlinks href=#hl-26-39>39</a>
</span><span class=lnt id=hl-26-40><a class=lnlinks href=#hl-26-40>40</a>
</span><span class=lnt id=hl-26-41><a class=lnlinks href=#hl-26-41>41</a>
</span><span class=lnt id=hl-26-42><a class=lnlinks href=#hl-26-42>42</a>
</span><span class=lnt id=hl-26-43><a class=lnlinks href=#hl-26-43>43</a>
</span><span class=lnt id=hl-26-44><a class=lnlinks href=#hl-26-44>44</a>
</span><span class=lnt id=hl-26-45><a class=lnlinks href=#hl-26-45>45</a>
</span><span class=lnt id=hl-26-46><a class=lnlinks href=#hl-26-46>46</a>
</span><span class=lnt id=hl-26-47><a class=lnlinks href=#hl-26-47>47</a>
</span><span class=lnt id=hl-26-48><a class=lnlinks href=#hl-26-48>48</a>
</span><span class=lnt id=hl-26-49><a class=lnlinks href=#hl-26-49>49</a>
</span><span class=lnt id=hl-26-50><a class=lnlinks href=#hl-26-50>50</a>
</span><span class=lnt id=hl-26-51><a class=lnlinks href=#hl-26-51>51</a>
</span><span class=lnt id=hl-26-52><a class=lnlinks href=#hl-26-52>52</a>
</span><span class=lnt id=hl-26-53><a class=lnlinks href=#hl-26-53>53</a>
</span><span class=lnt id=hl-26-54><a class=lnlinks href=#hl-26-54>54</a>
</span><span class=lnt id=hl-26-55><a class=lnlinks href=#hl-26-55>55</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=c1># NGINX 스트리밍 API 구성 예시
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>http</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>upstream</span> <span class=s>api_backend</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>server</span> <span class=n>api1.example.com</span><span class=p>:</span><span class=mi>8080</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>server</span> <span class=n>api2.example.com</span><span class=p>:</span><span class=mi>8080</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kn>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1># 표준 API 요청
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=s>/api/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass</span> <span class=s>http://api_backend</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 표준 프록시 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>proxy_set_header</span> <span class=s>Host</span> <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_set_header</span> <span class=s>X-Real-IP</span> <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 이벤트 스트리밍 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=s>/api/stream/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass</span> <span class=s>http://api_backend</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 스트리밍 최적화
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>proxy_buffering</span> <span class=no>off</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_cache</span> <span class=no>off</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 타임아웃 증가
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>proxy_read_timeout</span> <span class=s>300s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_connect_timeout</span> <span class=s>300s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_send_timeout</span> <span class=s>300s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 청크 전송 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>chunked_transfer_encoding</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># SSE(Server-Sent Events) 지원
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>proxy_set_header</span> <span class=s>Connection</span> <span class=s>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_http_version</span> <span class=mi>1</span><span class=s>.1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 나머지 구성…
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 웹소켓 엔드포인트
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>location</span> <span class=s>/api/ws/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_pass</span> <span class=s>http://api_backend</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 웹소켓 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>proxy_http_version</span> <span class=mi>1</span><span class=s>.1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_set_header</span> <span class=s>Upgrade</span> <span class=nv>$http_upgrade</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_set_header</span> <span class=s>Connection</span> <span class=s>&#34;upgrade&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 웹소켓 타임아웃
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=kn>proxy_read_timeout</span> <span class=s>3600s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kn>proxy_send_timeout</span> <span class=s>3600s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=다양한-환경에서의-api-로드-밸런싱-전략>다양한 환경에서의 API 로드 밸런싱 전략<a hidden class=anchor aria-hidden=true href=#다양한-환경에서의-api-로드-밸런싱-전략>#</a></h3><h4 id=온프레미스-환경>온프레미스 환경<a hidden class=anchor aria-hidden=true href=#온프레미스-환경>#</a></h4><p>자체 데이터센터에서 API 로드 밸런싱 구현하기:</p><p><strong>권장 아키텍처</strong>:</p><ul><li>프론트엔드: 하드웨어 로드 밸런서(F5, A10 등) 또는 NGINX/HAProxy</li><li>백엔드: 애플리케이션 서버 클러스터</li><li>인증/권한 부여: 전용 인증 서버</li><li>모니터링: Prometheus + Grafana 또는 상용 모니터링 솔루션</li></ul><p><strong>고가용성 전략</strong>:</p><ul><li>액티브-패시브 로드 밸런서 페어</li><li>다중 데이터센터 배포</li><li>GSLB(Global Server Load Balancing)를 통한 지역 페일오버</li></ul><h4 id=클라우드-네이티브-환경>클라우드 네이티브 환경<a hidden class=anchor aria-hidden=true href=#클라우드-네이티브-환경>#</a></h4><p>클라우드 환경에 최적화된 API 로드 밸런싱:</p><p><strong>AWS 아키텍처 예시</strong>:</p><pre class=mermaid>Route 53 (DNS) → CloudFront (CDN) → API Gateway → ALB → ECS/EKS 클러스터
</pre><p><strong>Azure 아키텍처 예시</strong>:</p><pre class=mermaid>Azure Front Door → Azure API Management → Azure Load Balancer → AKS 클러스터
</pre><p><strong>Google Cloud 아키텍처 예시</strong>:</p><pre class=mermaid>Cloud CDN → Cloud Load Balancing → Cloud Run/GKE
</pre><p><strong>주요 이점</strong>:</p><ul><li>관리 오버헤드 감소</li><li>자동 확장성</li><li>글로벌 배포 용이성</li><li>서버리스 옵션</li><li>통합 보안 및 모니터링</li></ul><h4 id=하이브리드-및-멀티-클라우드-환경>하이브리드 및 멀티 클라우드 환경<a hidden class=anchor aria-hidden=true href=#하이브리드-및-멀티-클라우드-환경>#</a></h4><p>다양한 환경에 걸친 API 로드 밸런싱:</p><p><strong>아키텍처 접근법</strong>:</p><ol><li><strong>중앙 집중식 라우팅</strong>:<ul><li>글로벌 로드 밸런서가 각 환경의 로드 밸런서로 트래픽 라우팅</li><li>단일 엔트리 포인트, 정책 일관성</li></ul></li><li><strong>분산형 라우팅</strong>:<ul><li>각 환경에 독립적인 엔트리 포인트</li><li>지역 최적화, 환경 간 독립성</li></ul></li></ol><p><strong>기술 스택</strong>:</p><ul><li><strong>서비스 메시</strong>: Istio, Linkerd</li><li><strong>멀티 클라우드 로드 밸런싱</strong>: F5 Distributed Cloud, Cloudflare</li><li><strong>API 게이트웨이</strong>: Kong, Tyk, AWS App Mesh</li></ul><p><strong>주요 고려사항</strong>:</p><ul><li>환경 간 일관된 보안 정책</li><li>지연 시간 최적화</li><li>장애 격리</li><li>중앙 집중식 모니터링 및 로깅</li></ul><h4 id=엣지-컴퓨팅-환경>엣지 컴퓨팅 환경<a hidden class=anchor aria-hidden=true href=#엣지-컴퓨팅-환경>#</a></h4><p>엣지 위치에서의 API 로드 밸런싱:</p><p><strong>아키텍처 접근법</strong>:</p><ol><li><strong>엣지 캐싱</strong>: 주로 읽기 작업을 위한 CDN 기반 캐싱</li><li><strong>엣지 컴퓨팅</strong>: 엣지 로케이션에서 API 비즈니스 로직 실행</li><li><strong>하이브리드 엣지</strong>: 캐싱 + 간단한 처리는 엣지에서, 복잡한 처리는 백엔드에서</li></ol><p><strong>기술 스택</strong>:</p><ul><li><strong>엣지 네트워크</strong>: Cloudflare Workers, Fastly Compute@Edge, AWS Lambda@Edge</li><li><strong>경량 로드 밸런서</strong>: Envoy, Traefik</li><li><strong>엣지 배포 솔루션</strong>: Vercel Edge Functions, Netlify Edge</li></ul><p><strong>주요 이점</strong>:</p><ul><li>지연 시간 감소</li><li>대역폭 비용 절감</li><li>오리진 서버 부하 감소</li><li>지역별 규정 준수</li></ul><h3 id=api-로드-밸런싱의-실제-사례-연구>API 로드 밸런싱의 실제 사례 연구<a hidden class=anchor aria-hidden=true href=#api-로드-밸런싱의-실제-사례-연구>#</a></h3><h4 id=대규모-전자상거래-api-플랫폼>대규모 전자상거래 API 플랫폼<a hidden class=anchor aria-hidden=true href=#대규모-전자상거래-api-플랫폼>#</a></h4><p><strong>도전 과제</strong>:</p><ul><li>빠르게 변화하는 트래픽 패턴</li><li>휴일 시즌 대규모 트래픽 급증</li><li>지역별로 다양한 서비스 요구사항</li><li>수천 개의 파트너 API 통합</li></ul><p><strong>구현 솔루션</strong>:</p><ol><li><strong>다계층 로드 밸런싱</strong>:<ul><li>글로벌 계층: Cloudflare + AWS Global Accelerator</li><li>지역 계층: ALB(Application Load Balancer)</li><li>서비스 계층: 서비스 내 로드 밸런싱</li></ul></li><li><strong>고급 라우팅 전략</strong>:<ul><li>콘텐츠 기반 라우팅: 제품 API vs 주문 API</li><li>지리적 라우팅: 가장 가까운 데이터 센터로</li><li>가중치 기반 카나리 배포</li></ul></li><li><strong>자동 확장 정책</strong>:<ul><li>예측적 확장: 과거 트래픽 패턴 기반</li><li>이벤트 기반 확장: 마케팅 이벤트 전에 미리 확장</li><li>다중 지표 확장: CPU, 메모리, 요청 대기열 기반</li></ul></li></ol><p><strong>결과</strong>:</p><ul><li>99.99% 가용성 달성</li><li>블랙 프라이데이 피크 트래픽 400% 증가 처리</li><li>API 응답 시간 65% 감소</li><li>인프라 비용 30% 절감</li></ul><h4 id=금융-서비스-api-게이트웨이>금융 서비스 API 게이트웨이<a hidden class=anchor aria-hidden=true href=#금융-서비스-api-게이트웨이>#</a></h4><p><strong>도전 과제</strong>:</p><ul><li>엄격한 규제 준수 요구사항</li><li>제로 다운타임 요구사항</li><li>매우 민감한 데이터 처리</li><li>초당 수천 건의 트랜잭션</li></ul><p><strong>구현 솔루션</strong>:</p><ol><li><strong>보안 중심 로드 밸런싱</strong>:<ul><li>mTLS(상호 TLS) 종단간 인증</li><li>요청/응답 암호화</li><li>FIPS 140-2 준수 하드웨어 로드 밸런서</li><li>WAF 통합</li></ul></li><li><strong>장애 없는 배포 전략</strong>:<ul><li>블루-그린 배포</li><li>점진적인 트래픽 전환</li><li>자동 롤백 기능</li></ul></li><li><strong>고급 상태 확인</strong>:<ul><li>딥 헬스 체크: API 기능 테스트</li><li>회로 차단기 패턴 구현</li><li>상태 메트릭 기반 가중치 조정</li></ul></li></ol><p><strong>결과</strong>:</p><ul><li>100% 규제 준수 달성</li><li>5년 연속 제로 보안 침해</li><li>99.999% 가용성(연간 5분 미만 다운타임)</li><li>실시간 트랜잭션 처리 보장</li></ul><h4 id=글로벌-미디어-스트리밍-api>글로벌 미디어 스트리밍 API<a hidden class=anchor aria-hidden=true href=#글로벌-미디어-스트리밍-api>#</a></h4><p><strong>도전 과제</strong>:</p><ul><li>전 세계적으로 분산된 사용자 기반</li><li>대용량 미디어 콘텐츠 전송</li><li>저지연 API 상호작용 요구</li><li>다양한 디바이스 지원</li></ul><p><strong>구현 솔루션</strong>:</p><ol><li><strong>글로벌 분산 아키텍처</strong>:<ul><li>모든 대륙에 API 엔드포인트 배포</li><li>지능형 DNS 라우팅</li><li>로컬 캐싱 및 에지 컴퓨팅</li></ul></li><li><strong>스트리밍 최적화</strong>:<ul><li>롱 폴링 및 웹소켓 지원</li><li>적응형 비트레이트 API</li><li>프로그레시브 콘텐츠 전송</li></ul></li><li><strong>맞춤형 로드 밸런싱 알고리즘</strong>:<ul><li>콘텐츠 인기도 기반 캐싱</li><li>지연 시간 기반 라우팅</li><li>인식 추천 엔진 라우팅</li></ul></li></ol><p><strong>결과</strong>:</p><ul><li>글로벌 평균 API 응답 시간 &lt; 100ms</li><li>최대 동시 사용자 1000만 명 지원</li><li>CDN 비용 45% 절감</li><li>버퍼링 이벤트 70% 감소</li></ul><h3 id=api-로드-밸런싱-구현-전략>API 로드 밸런싱 구현 전략<a hidden class=anchor aria-hidden=true href=#api-로드-밸런싱-구현-전략>#</a></h3><p>API 로드 밸런싱을 효과적으로 구현하기 위한 전체적인 접근 방법을 제시합니다.</p><h4 id=계층적-로드-밸런싱-아키텍처>계층적 로드 밸런싱 아키텍처<a hidden class=anchor aria-hidden=true href=#계층적-로드-밸런싱-아키텍처>#</a></h4><p><strong>멀티 티어 아키텍처 설계</strong>:</p><ol><li><strong>티어 1: 글로벌 엣지</strong><ul><li>CDN 및 글로벌 로드 밸런서</li><li>DDoS 방어 및 WAF</li><li>지역 기반 라우팅</li><li>TLS 종료</li></ul></li><li><strong>티어 2: 지역 API 게이트웨이</strong><ul><li>요청 검증 및 제한</li><li>인증 및 권한 부여</li><li>요청/응답 변환</li><li>API 버전 관리</li></ul></li><li><strong>티어 3: 서비스 로드 밸런서</strong><ul><li>마이크로서비스 간 라우팅</li><li>서비스 검색 통합</li><li>내부 TLS 종료</li><li>헬스 체크 및 회로 차단기</li></ul></li><li><strong>티어 4: 클러스터 로드 밸런서</strong><ul><li>컨테이너/Pod 수준 라우팅</li><li>스테이트풀 워크로드 라우팅</li><li>프로토콜 인식 로드 밸런싱</li></ul></li></ol><h4 id=알고리즘-선택-결정-트리>알고리즘 선택 결정 트리<a hidden class=anchor aria-hidden=true href=#알고리즘-선택-결정-트리>#</a></h4><p>API 유형 및 요구사항에 따른 로드 밸런싱 알고리즘 선택 가이드:</p><ol><li><strong>쿼리 집약적 API</strong>:<ul><li>쿼리 실행 시간에 큰 차이가 있는가? → 최소 연결</li><li>서버 용량이 다른가? → 가중 라운드 로빈</li><li>캐시 친화적인가? → 일관된 해싱</li><li>기타 → 라운드 로빈</li></ul></li><li><strong>상태 유지 API</strong>:<ul><li>세션 상태가 중요한가? → 소스 IP 해싱</li><li>사용자별 처리가 필요한가? → URL 해싱</li><li>지연 시간이 중요한가? → 최소 응답 시간</li><li>기타 → 가중 라운드 로빈</li></ul></li><li><strong>고성능 실시간 API</strong>:<ul><li>초저지연이 중요한가? → 최소 응답 시간</li><li>트래픽 급증이 있는가? → 최소 연결 + 동적 가중치</li><li>지리적으로 분산되어 있는가? → 지연 시간 기반 라우팅</li><li>기타 → 최소 처리 중인 요청</li></ul></li><li><strong>배치 처리 API</strong>:<ul><li>작업 크기가 다양한가? → 리소스 기반 라우팅</li><li>서버 용량이 다른가? → 가중 라운드 로빈</li><li>우선순위가 있는가? → 우선순위 기반 큐</li><li>기타 → 라운드 로빈</li></ul></li></ol><h4 id=구현-단계별-접근법>구현 단계별 접근법<a hidden class=anchor aria-hidden=true href=#구현-단계별-접근법>#</a></h4><p>API 로드 밸런싱 시스템 구축을 위한 단계별 접근법:</p><ol><li><strong>요구사항 분석</strong>:<ul><li>API 트래픽 패턴 분석</li><li>성능 및 확장성 목표 정의</li><li>고가용성 요구사항 식별</li><li>보안 요구사항 문서화</li></ul></li><li><strong>아키텍처 설계</strong>:<ul><li>로드 밸런싱 계층 정의</li><li>알고리즘 선택</li><li>페일오버 전략 설계</li><li>모니터링 및 알림 계획</li></ul></li><li><strong>프로토타입 개발</strong>:<ul><li>소규모로 로드 밸런싱 구성 테스트</li><li>다양한 알고리즘 비교</li><li>성능 벤치마킹</li><li>페일오버 테스트</li></ul></li><li><strong>확장 구현</strong>:<ul><li>프로덕션 환경 설정</li><li>구성 자동화</li><li>CI/CD 파이프라인 통합</li><li>점진적 트래픽 전환</li></ul></li><li><strong>최적화 및 튜닝</strong>:<ul><li>실제 트래픽 기반 알고리즘 조정</li><li>리소스 활용도 최적화</li><li>성능 병목 제거</li><li>구성 검증 및 강화</li></ul></li><li><strong>지속적인 개선</strong>:<ul><li>정기적인 성능 검토</li><li>새로운 기술 평가</li><li>보안 취약점 스캐닝</li><li>용량 계획 업데이트</li></ul></li></ol><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/backend/>Backend</a></li><li><a href=https://buenhyden.github.io/tags/api-design/>API-Design</a></li><li><a href=https://buenhyden.github.io/tags/api-performance/>API-Performance</a></li><li><a href=https://buenhyden.github.io/tags/load-balancing/>Load-Balancing</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/backend/api-design/api-lifecycle-management/performance-management/caching-strategies/><span class=title>« Prev</span><br><span>Caching Strategies</span>
</a><a class=next href=https://buenhyden.github.io/posts/backend/api-design/api-lifecycle-management/monitoring-and-analytics/performance-metrics/><span class=title>Next »</span><br><span>Performance Metrics</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>