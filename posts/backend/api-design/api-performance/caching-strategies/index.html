<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Caching Strategies | hyunyoun's Blog</title>
<meta name=keywords content="Backend,API-Design,API-Performance,Caching-Strategies"><meta name=description content="캐싱은 API 설계에서 성능을 최적화하는 핵심 전략이다. 자주 요청되는 데이터를 임시 저장소에 저장함으로써 반복적인 계산, 데이터베이스 쿼리, 네트워크 요청을 줄이고 응답 시간을 대폭 향상시킬 수 있다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/backend/api-design/api-performance/caching-strategies/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/backend/api-design/api-performance/caching-strategies/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/backend/api-design/api-performance/caching-strategies/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Caching Strategies"><meta property="og:description" content="캐싱은 API 설계에서 성능을 최적화하는 핵심 전략이다. 자주 요청되는 데이터를 임시 저장소에 저장함으로써 반복적인 계산, 데이터베이스 쿼리, 네트워크 요청을 줄이고 응답 시간을 대폭 향상시킬 수 있다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-13T01:30:00+00:00"><meta property="article:modified_time" content="2025-02-13T01:30:00+00:00"><meta property="article:tag" content="Backend"><meta property="article:tag" content="API-Design"><meta property="article:tag" content="API-Performance"><meta property="article:tag" content="Caching-Strategies"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Caching Strategies"><meta name=twitter:description content="캐싱은 API 설계에서 성능을 최적화하는 핵심 전략이다. 자주 요청되는 데이터를 임시 저장소에 저장함으로써 반복적인 계산, 데이터베이스 쿼리, 네트워크 요청을 줄이고 응답 시간을 대폭 향상시킬 수 있다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"기술 블로그","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Backend","item":"https://buenhyden.github.io/posts/backend/"},{"@type":"ListItem","position":3,"name":"APIs","item":"https://buenhyden.github.io/posts/backend/api-design/"},{"@type":"ListItem","position":4,"name":"API Performance","item":"https://buenhyden.github.io/posts/backend/api-design/api-performance/"},{"@type":"ListItem","position":5,"name":"Caching Strategies","item":"https://buenhyden.github.io/posts/backend/api-design/api-performance/caching-strategies/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Caching Strategies","name":"Caching Strategies","description":"캐싱은 API 설계에서 성능을 최적화하는 핵심 전략이다. 자주 요청되는 데이터를 임시 저장소에 저장함으로써 반복적인 계산, 데이터베이스 쿼리, 네트워크 요청을 줄이고 응답 시간을 대폭 향상시킬 수 있다.","keywords":["Backend","API-Design","API-Performance","Caching-Strategies"],"articleBody":"Caching Strategies 캐싱은 API 설계에서 성능을 최적화하는 핵심 전략이다. 자주 요청되는 데이터를 임시 저장소에 저장함으로써 반복적인 계산, 데이터베이스 쿼리, 네트워크 요청을 줄이고 응답 시간을 대폭 향상시킬 수 있다.\nAPI 캐싱은 현대 웹 애플리케이션과 분산 시스템의 성능, 확장성, 사용자 경험을 개선하는 필수적인 전략이다.\n적절히 구현된 캐싱 전략은 다음과 같은 여러 이점을 제공한다:\n응답 시간 단축: 사용자에게 더 빠른 API 응답 제공 백엔드 부하 감소: 서버와 데이터베이스의 리소스 사용 최적화 비용 효율성: 인프라 요구 사항 및 대역폭 비용 절감 확장성 향상: 기존 리소스로 더 많은 사용자와 요청 처리 안정성 개선: 일시적인 장애 상황에서도 서비스 가용성 유지 그러나 API 캐싱은 단순히 기술적 구현 이상의 것이다. 효과적인 캐싱 전략은 데이터의 특성, 사용자 요구사항, 비즈니스 우선순위를 철저히 이해하고 이를 기반으로 설계되어야 한다. 데이터의 신선도, 캐시 적중률, 리소스 사용, 구현 복잡성 간의 균형을 맞추는 것이 중요하다.\n또한, 캐싱은 정적인 것이 아니라 시스템과 함께 발전해야 하는 동적인 전략이다. 캐시 성능을 지속적으로 모니터링하고, 사용 패턴 변화에 따라 전략을 조정하며, 새로운 도구와 기술을 평가하는 것이 필요하다.\n최종적으로, API 캐싱의 성공은 그것이 얼마나 보이지 않는지에 달려 있다. 사용자는 단지 빠르고 안정적으로 작동하는 API를 경험할 뿐, 그 뒤에서 작동하는 복잡한 캐싱 메커니즘에 대해서는 알 필요가 없다. 이것이 바로 잘 설계된 캐싱 전략의 특징이다. - 복잡성은 숨기고, 사용자에게는 원활한 경험만 제공하는 것이다.\nAPI 캐싱의 중요성과 이점 API 캐싱을 구현하면 다음과 같은 여러 이점을 얻을 수 있다:\n성능 향상\n캐싱은 응답 시간을 크게 단축시킨다. 데이터베이스 접근, 복잡한 계산, 외부 서비스 호출 등 시간이 많이 소요되는 작업의 결과를 캐시에 저장하여 재사용함으로써, 사용자에게 훨씬 빠른 응답을 제공할 수 있다.\n서버 부하 감소\n자주 요청되는 데이터를 캐싱하면 서버가 처리해야 할 요청 수가 줄어든다. 이는 CPU, 메모리, 데이터베이스 연결과 같은 서버 리소스의 사용을 최적화하여 더 많은 요청을 처리할 수 있게 한다.\n확장성 개선\n효과적인 캐싱 전략은 시스템의 확장성을 크게 향상시킨다. 동일한 하드웨어로 더 많은 요청을 처리할 수 있게 되므로, 인프라 비용을 절감하면서도 성장하는 트래픽을 수용할 수 있다.\n안정성 향상\n외부 서비스나 데이터베이스에 일시적인 장애가 발생하더라도, 캐시된 데이터를 통해 서비스를 계속 제공할 수 있다. 이는 시스템의 전반적인 안정성과 회복력을 높이는 데 기여한다.\n대역폭 절약\n네트워크 대역폭 사용을 줄임으로써, 특히 모바일 환경이나 제한된 네트워크 환경에서 사용자 경험을 개선할 수 있다.\nAPI 캐싱의 기본 원칙 효과적인 API 캐싱을 구현하기 위해서는 몇 가지 핵심 원칙을 이해하는 것이 중요하다:\n캐시 위치(Cache Location)\n캐시는 시스템의 여러 계층에 위치할 수 있으며, 각 위치는 고유한 장단점을 갖는다:\n클라이언트 측 캐싱: 브라우저나 모바일 앱 등의 클라이언트에서 데이터를 캐싱 네트워크 캐싱: CDN, 프록시 서버, API 게이트웨이에서의 캐싱 서버 측 캐싱: API 서버 내부 또는 분산 캐시 시스템에서의 캐싱 데이터베이스 캐싱: 데이터베이스 쿼리 결과나 계산된 데이터의 캐싱 캐시 무효화(Cache Invalidation)\n캐시된 데이터가 원본 데이터와 일치하도록 관리하는 과정은 캐싱에서 가장 어려운 부분 중 하나이다:\nTTL(Time-To-Live) 기반: 일정 시간이 지나면 자동으로 캐시 항목 만료 이벤트 기반: 데이터 변경 이벤트 발생 시 관련 캐시 항목 무효화 버전 기반: 데이터 변경 시 새 버전 식별자를 사용하여 캐시 항목 관리 캐시 정책(Caching Policy)\n어떤 데이터를 얼마나 오래 캐싱할지 결정하는 정책은 애플리케이션의 특성과 요구사항에 맞게 설계되어야 한다:\n자주 접근되고 변경이 적은 데이터: 더 오랜 기간 캐싱 자주 변경되는 데이터: 짧은 캐싱 기간 또는 특정 조건에서만 캐싱 개인화된 데이터: 사용자별 캐싱 또는 캐싱 제외 고려 API 캐싱 전략 유형 API 캐싱은 다양한 수준과 위치에서 구현될 수 있으며, 각 전략은 특정 사용 사례와 요구사항에 적합하다.\n다음은 주요 API 캐싱 전략들이다:\nHTTP 캐싱 HTTP 프로토콜은 웹에서의 효율적인 캐싱을 위한 내장 메커니즘을 제공한다. 이 방법은 구현이 간단하며 브라우저, CDN, 프록시 서버 등 HTTP 스택의 모든 계층에서 작동한다.\n주요 HTTP 캐싱 헤더 Cache-Control: 가장 중요한 캐싱 헤더로, 캐싱 동작을 세밀하게 제어한다.\nCache-Control: max-age=3600, public 주요 지시어:\nmax-age: 캐시의 신선도 유지 시간(초 단위) public: 모든 캐시에서 응답을 저장할 수 있음 private: 브라우저 같은 개인 캐시에서만 저장 가능 no-cache: 재검증 없이 캐시된 응답을 사용하지 않음 no-store: 어떤 캐시에도 응답을 저장하지 않음 must-revalidate: 만료된 캐시 항목은 반드시 원본 서버에서 재검증 ETag: 리소스의 특정 버전을 식별하는 고유 문자열이다. 변경 감지에 사용된다.\nETag: \"33a64df551425fcc55e4d42a148795d9f25f89d4\" Last-Modified: 리소스가 마지막으로 변경된 날짜와 시간을 나타낸다.\nLast-Modified: Wed, 21 Oct 2023 07:28:00 GMT If-None-Match 및 If-Modified-Since: 클라이언트가 이전에 받은 ETag 또는 Last-Modified 정보를 사용하여 조건부 요청을 보낼 때 사용된다.\nHTTP 캐싱 작동 방식 클라이언트가 리소스를 요청한다. 서버는 캐싱 헤더를 포함한 응답을 보낸다. 클라이언트(또는 중간 캐시)는 이 응답을 저장한다. 동일한 리소스에 대한 후속 요청 시, 캐시 정책에 따라: 유효한 캐시가 있으면: 캐시된 응답을 직접 사용(304 Not Modified) 캐시가 오래되었으면: 조건부 요청으로 서버에 재검증 구현 예제(Spring Boot) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 @RestController public class ProductController { @GetMapping(\"/products/{id}\") public ResponseEntity\u003cProduct\u003e getProduct(@PathVariable Long id) { Product product = productService.findById(id); // ETag 생성 (제품 데이터의 해시 값) String etag = DigestUtils.md5DigestAsHex(product.toString().getBytes()); return ResponseEntity.ok() .cacheControl(CacheControl.maxAge(1, TimeUnit.HOURS).cachePublic()) .eTag(etag) .body(product); } } HTTP 캐싱의 장점 표준 HTTP 인프라를 활용하여 추가 서버 구성 없이 구현 가능 클라이언트, CDN, 프록시 등 여러 계층에서 작동 네트워크 트래픽 감소 및 서버 부하 경감 HTTP 캐싱의 단점 세밀한 캐시 제어가 제한적일 수 있음 개인화된 콘텐츠나 동적 API 응답에는 적합하지 않을 수 있음 데이터 변경 시 즉각적인 캐시 무효화가 어려울 수 있음 애플리케이션 레벨 캐싱 애플리케이션 레벨 캐싱은 API 서버 내부에서 메모리, 로컬 디스크 또는 전용 캐싱 시스템을 사용하여 구현된다. 이 방법은 세밀한 제어가 가능하고 특정 애플리케이션 요구사항에 맞게 최적화할 수 있다.\n인메모리 캐싱 가장 단순하고 빠른 형태의 캐싱으로, 애플리케이션 메모리에 데이터를 직접 저장한다.\nNode.js 구현 예제(node-cache):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 const NodeCache = require('node-cache'); const cache = new NodeCache({ stdTTL: 600 }); // 10분 TTL async function getProductById(id) { // 캐시에서 먼저 확인 const cacheKey = `product_${id}`; const cachedProduct = cache.get(cacheKey); if (cachedProduct) { console.log('Cache hit!'); return cachedProduct; } // 캐시에 없으면 데이터베이스에서 조회 console.log('Cache miss, fetching from database…'); const product = await db.products.findById(id); // 결과를 캐시에 저장 cache.set(cacheKey, product); return product; } Spring Boot 구현 예제(Caffeine):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 @Configuration @EnableCaching public class CacheConfig { @Bean public CacheManager cacheManager() { CaffeineCacheManager cacheManager = new CaffeineCacheManager(\"products\"); cacheManager.setCaffeine(Caffeine.newBuilder() .expireAfterWrite(10, TimeUnit.MINUTES) .maximumSize(1000)); return cacheManager; } } @Service public class ProductService { @Autowired private ProductRepository productRepository; @Cacheable(value = \"products\", key = \"#id\") public Product findById(Long id) { // 캐시 미스 시에만 실행됨 return productRepository.findById(id) .orElseThrow(() -\u003e new ProductNotFoundException(id)); } @CacheEvict(value = \"products\", key = \"#product.id\") public Product update(Product product) { return productRepository.save(product); } } 분산 캐싱 여러 서버 또는 인스턴스 간에 캐시를 공유하기 위해 Redis, Memcached와 같은 분산 캐시 시스템을 사용한다.\nNode.js 구현 예제(Redis):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 const redis = require('redis'); const { promisify } = require('util'); const client = redis.createClient(); // 프로미스 기반으로 Redis 메서드 변환 const getAsync = promisify(client.get).bind(client); const setAsync = promisify(client.set).bind(client); async function getProductById(id) { const cacheKey = `product:${id}`; try { // 캐시에서 먼저 확인 const cachedProduct = await getAsync(cacheKey); if (cachedProduct) { return JSON.parse(cachedProduct); } // 캐시에 없으면 데이터베이스에서 조회 const product = await db.products.findById(id); // 결과를 캐시에 저장 (10분 TTL) await setAsync(cacheKey, JSON.stringify(product), 'EX', 600); return product; } catch (error) { console.error('Cache error:', error); // 캐시 오류 시 데이터베이스에서 직접 조회 return await db.products.findById(id); } } Spring Boot 구현 예제(Redis):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 @Configuration @EnableCaching public class RedisCacheConfig { @Bean public RedisConnectionFactory redisConnectionFactory() { return new LettuceConnectionFactory(); } @Bean public RedisCacheManager cacheManager(RedisConnectionFactory redisConnectionFactory) { RedisCacheConfiguration cacheConfig = RedisCacheConfiguration.defaultCacheConfig() .entryTtl(Duration.ofMinutes(10)) .serializeValuesWith( RedisSerializationContext.SerializationPair.fromSerializer( new GenericJackson2JsonRedisSerializer())); return RedisCacheManager.builder(redisConnectionFactory) .cacheDefaults(cacheConfig) .build(); } } @Service public class ProductService { @Cacheable(value = \"products\", key = \"#id\", unless = \"#result == null\") public Product findById(Long id) { return productRepository.findById(id).orElse(null); } @CacheEvict(value = \"products\", key = \"#product.id\") public Product update(Product product) { return productRepository.save(product); } } 애플리케이션 레벨 캐싱의 장점 세밀한 제어가 가능하며 비즈니스 로직에 최적화 가능 데이터베이스 부하 감소 복잡한 계산 결과나 집계 데이터 캐싱에 적합 캐시 무효화를 애플리케이션 로직과 직접 통합 가능 애플리케이션 레벨 캐싱의 단점 구현 및 유지보수 복잡성 증가 메모리 사용량 관리 필요 분산 환경에서 캐시 일관성 유지의 어려움 데이터베이스 캐싱 데이터베이스 자체에 내장된 캐싱 메커니즘을 활용하거나, 데이터베이스 쿼리 결과를 캐싱하는 전략.\n데이터베이스 내장 캐싱 대부분의 데이터베이스 시스템은 내부적으로 다양한 캐싱 메커니즘을 제공한다:\n쿼리 캐시: 자주 사용되는 쿼리의 결과를 메모리에 저장 버퍼 풀/캐시: 디스크에서 읽은 데이터 페이지를 메모리에 저장 결과셋 캐싱: 쿼리 결과를 임시 저장 MySQL 쿼리 캐싱 설정 예제:\n1 2 3 4 5 6 7 8 9 10 -- 쿼리 캐시 상태 확인 SHOW VARIABLES LIKE 'query_cache%'; -- 쿼리 캐시 활성화 (my.cnf 또는 my.ini 파일) -- query_cache_type = 1 -- query_cache_size = 64M -- 특정 쿼리에 대해 캐싱 활성화/비활성화 SELECT SQL_CACHE * FROM products WHERE category_id = 5; SELECT SQL_NO_CACHE * FROM products WHERE category_id = 5; ORM 수준의 캐싱 ORM(Object-Relational Mapping) 프레임워크는 일반적으로 여러 수준의 캐싱을 제공한다:\n1차 캐시(세션 캐시): 트랜잭션 내에서 엔티티 캐싱 2차 캐시: 여러 세션 간에 공유되는 엔티티 캐시 쿼리 캐시: 쿼리 결과셋 캐싱 Hibernate 2차 캐시 구성 예제:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 @Configuration @EnableCaching public class HibernateCacheConfig { @Bean public LocalContainerEntityManagerFactoryBean entityManagerFactory() { LocalContainerEntityManagerFactoryBean em = new LocalContainerEntityManagerFactoryBean(); // … 기본 설정 … Properties hibernateProps = new Properties(); hibernateProps.setProperty(\"hibernate.cache.use_second_level_cache\", \"true\"); hibernateProps.setProperty(\"hibernate.cache.region.factory_class\", \"org.hibernate.cache.jcache.JCacheRegionFactory\"); hibernateProps.setProperty(\"hibernate.javax.cache.provider\", \"org.ehcache.jsr107.EhcacheCachingProvider\"); em.setJpaProperties(hibernateProps); return em; } } @Entity @Table(name = \"products\") @Cache(usage = CacheConcurrencyStrategy.READ_WRITE) public class Product { // 엔티티 정의 } 데이터베이스 캐싱의 장점 기존 데이터베이스 기능을 활용하여 추가 인프라 없이 구현 가능 데이터 액세스 패턴에 최적화 가능 ORM 캐싱은 개발자가 캐싱 로직을 직접 관리할 필요성 감소 데이터베이스 캐싱의 단점 데이터베이스 시스템 자체의 리소스를 소비 세밀한 제어가 제한적일 수 있음 캐시 인프라가 데이터베이스 서버에 종속됨 CDN 캐싱(Content Delivery Network) CDN은 전 세계 여러 위치에 분산된 서버 네트워크를 통해 콘텐츠를 캐싱하고 제공한다. API 응답을 CDN을 통해 캐싱하면 지리적으로 분산된 사용자에게 더 빠른 응답을 제공할 수 있다.\nCDN 캐싱 구성 API 응답에 적절한 캐싱 헤더 설정(Cache-Control, Expires 등) CDN 서비스(Cloudflare, Akamai, AWS CloudFront 등) 구성 API 엔드포인트를 CDN 배포에 연결 AWS CloudFront 설정 예제:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 { \"DistributionConfig\": { \"DefaultCacheBehavior\": { \"TargetOriginId\": \"api-origin\", \"ViewerProtocolPolicy\": \"redirect-to-https\", \"AllowedMethods\": { \"Quantity\": 7, \"Items\": [\"GET\", \"HEAD\", \"OPTIONS\", \"PUT\", \"POST\", \"PATCH\", \"DELETE\"] }, \"CachedMethods\": { \"Quantity\": 3, \"Items\": [\"GET\", \"HEAD\", \"OPTIONS\"] }, \"ForwardedValues\": { \"QueryString\": true, \"Cookies\": { \"Forward\": \"whitelist\", \"WhitelistedNames\": { \"Quantity\": 1, \"Items\": [\"session-id\"] } }, \"Headers\": { \"Quantity\": 3, \"Items\": [\"Authorization\", \"Accept\", \"Content-Type\"] } }, \"MinTTL\": 0, \"DefaultTTL\": 3600, \"MaxTTL\": 86400 } } } CDN 캐싱을 위한 API 설계 고려사항 URL 구조: 캐시 키로 사용되는 URL 매개변수 최적화 캐싱 가능한 응답 분리: 개인화된 콘텐츠와 공유 가능한 콘텐츠 분리 버전 관리: URL 또는 헤더에 버전 정보 포함하여 캐시 무효화 제어 캐시 태그: 관련 캐시 항목을 그룹화하여 일괄 무효화 가능 CDN 캐싱의 장점 글로벌 사용자를 위한 지연 시간 감소 원본 서버 부하 크게 감소 DDoS 공격 완화 및 추가 보안 레이어 제공 대규모 트래픽 처리에 효과적 CDN 캐싱의 단점 동적이거나 개인화된 콘텐츠에는 적합하지 않을 수 있음 캐시 무효화 지연 가능성 구성 및 모니터링의 복잡성 추가 비용 발생 API 게이트웨이 캐싱 API 게이트웨이는 API 요청을 라우팅하고 관리하는 중간 계층으로, 자체적인 캐싱 기능을 제공한다. 이는 백엔드 서비스의 부하를 줄이고 응답 시간을 개선하는 데 도움이 된다.\n주요 API 게이트웨이 캐싱 기능 응답 캐싱: 특정 API 경로/메서드의 응답 캐싱 캐시 키 관리: URL 경로, 쿼리 매개변수, 헤더 등을 기반으로 캐시 키 구성 TTL 관리: 엔드포인트별 캐시 만료 시간 설정 캐시 무효화: 특정 캐시 항목을 수동으로 무효화 조건부 캐싱: 특정 조건에서만 응답 캐싱 AWS API Gateway 캐싱 구성 예제:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 { \"stageName\": \"prod\", \"cacheClusterEnabled\": true, \"cacheClusterSize\": \"0.5\", \"methodSettings\": { \"*/*\": { \"cachingEnabled\": true, \"cacheTtlInSeconds\": 300 }, \"GET/products\": { \"cachingEnabled\": true, \"cacheTtlInSeconds\": 3600 }, \"GET/products/{id}\": { \"cachingEnabled\": true, \"cacheTtlInSeconds\": 1800, \"cacheKeyParameters\": [\"method.request.path.id\"] }, \"POST/orders\": { \"cachingEnabled\": false } } } Kong API Gateway 캐싱 플러그인 구성 예제:\n1 2 3 4 5 6 7 8 plugins: - name: proxy-cache config: strategy: memory content_type: - application/json cache_ttl: 300 cache_control: false API 게이트웨이 캐싱의 장점 중앙 집중식 캐싱 관리 마이크로서비스 아키텍처에 적합 백엔드 서비스 변경 없이 캐싱 추가 가능 세밀한 캐싱 정책 제어 API 게이트웨이 캐싱의 단점 추가적인 인프라 구성 요소 도입 게이트웨이 자체가 병목 지점이 될 가능성 캐시 일관성 관리 복잡성 리소스 사용량 및 비용 관리 필요 고급 API 캐싱 전략 및 패턴 기본적인 캐싱 전략을 넘어, 더 복잡한 요구사항에 대응하기 위한 고급 캐싱 패턴과 전략:\n계층형 캐싱(Layered Caching) 다양한 수준에서 여러 캐시 계층을 조합하여 성능과 확장성을 최적화하는 전략이다.\n구현 예:\nL1: 애플리케이션 내 인메모리 캐시(가장 빠름, 작은 용량) L2: 분산 캐시(Redis/Memcached - 중간 속도, 대용량) L3: 데이터베이스 쿼리 캐시 L4: CDN/엣지 캐싱 장점:\n각 계층의 강점 활용 가능 캐시 미스 비용 최소화 더 높은 캐시 적중률 달성 시스템 전체의 복원력 향상 프리디클티브 캐싱(Predictive Caching) 사용 패턴과 동향을 분석하여 실제로 요청되기 전에 데이터를 미리 캐싱하는 선제적 접근 방식.\n구현 방법:\n사용자 행동 분석 및 예측 모델 구축 시간대, 위치, 이전 활동 등을 기반으로 캐싱 전략 조정 트렌드, 이벤트, 프로모션 등에 따른 캐싱 조정 예시:\n전자상거래: 인기 제품을 미리 캐싱 콘텐츠 플랫폼: 트렌딩 콘텐츠 미리 로딩 위치 기반 서비스: 사용자의 이동 방향 예측하여 관련 데이터 캐싱 스태일-와일-리밸리데이트(Stale-While-Revalidate) 만료된 캐시 콘텐츠를 제공하면서 동시에 백그라운드에서 새로운 데이터로 캐시를 새로고침하는 전략.\nHTTP 구현 예제:\nCache-Control: max-age=600, stale-while-revalidate=3600 애플리케이션 로직 구현:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 async function getData(key) { const cachedData = cache.get(key); const isStale = cachedData \u0026\u0026 cachedData.timestamp + maxAge \u003c Date.now(); if (cachedData) { // 캐시된 데이터가 오래되었다면, 백그라운드에서 새로고침 if (isStale \u0026\u0026 !refreshingKeys.has(key)) { refreshingKeys.add(key); // 비동기적으로 데이터 새로고침 setTimeout(async () =\u003e { try { const freshData = await fetchFromSource(key); cache.set(key, { data: freshData, timestamp: Date.now() }); } finally { refreshingKeys.delete(key); } }, 0); } // 오래된 데이터라도 즉시 반환 return cachedData.data; } // 캐시에 없으면 소스에서 가져옴 const freshData = await fetchFromSource(key); cache.set(key, { data: freshData, timestamp: Date.now() }); return freshData; } 장점:\n일관되게 빠른 응답 시간 제공 캐시 새로고침으로 인한 지연 시간 없음 백엔드 부하의 일정한 분배 일시적인 백엔드 장애에 대한 복원력 단점:\n구현 복잡성 증가 일시적으로 오래된 데이터 제공 메모리 및 연결 리소스 추가 사용 캐시 스탬핑 헤드(Cache Stampede/Thundering Herd) 방지 동시에 많은 요청이 캐시 미스를 경험할 때 백엔드 시스템에 갑작스러운 부하가 발생하는 현상을 방지하는 전략.\n구현 방법:\n잠금 메커니즘: 첫 번째 요청만 실제 데이터를 가져오고 나머지는 대기\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 const locks = new Map(); async function getDataWithLock(key) { const cachedData = cache.get(key); if (cachedData) { return cachedData; } // 이미 진행 중인 요청이 있는지 확인 if (locks.has(key)) { // 다른 요청이 데이터를 가져오는 동안 대기 return new Promise(resolve =\u003e { const checkInterval = setInterval(() =\u003e { const data = cache.get(key); if (data) { clearInterval(checkInterval); resolve(data); } }, 50); }); } // 잠금 설정 locks.set(key, true); try { // 소스에서 데이터 가져오기 const data = await fetchFromSource(key); cache.set(key, data); return data; } finally { // 잠금 해제 locks.delete(key); } } 프로배빌리스틱 조기 만료(Probabilistic Early Expiration): 캐시 항목의 실제 만료 전에 일부 요청만 새로고침 허용\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 function shouldRefreshCache(ttl, maxAge) { const elapsed = maxAge - ttl; const probability = elapsed / maxAge; return Math.random() \u003c= probability; } async function getData(key) { const cachedItem = cache.get(key); if (cachedItem) { const ttl = cachedItem.expiry - Date.now(); // 아직 만료되지 않았지만 확률적으로 새로고침 결정 if (ttl \u003e 0 \u0026\u0026 !shouldRefreshCache(ttl, MAX_AGE)) { return cachedItem.data; } } // 캐시 미스 또는 새로고침 필요 const data = await fetchFromSource(key); cache.set(key, { data, expiry: Date.now() + MAX_AGE }); return data; } 배경 새로고침(Background Refresh): 만료 시간에 가까워지면 백그라운드에서 주기적으로 캐시 미리 새로고침\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 // 캐시 새로고침 작업을 스케줄링하는 시스템 const refreshScheduler = { tasks: new Map(), schedule(key, ttl) { // 이미 예약된 작업이 있다면 취소 if (this.tasks.has(key)) { clearTimeout(this.tasks.get(key)); } // 만료 10초 전에 새로고침 작업 예약 const refreshTime = Math.max(ttl - 10000, 0); const taskId = setTimeout(async () =\u003e { try { const freshData = await fetchFromSource(key); cache.set(key, { data: freshData, expiry: Date.now() + MAX_AGE }); // 새 만료 시간으로 다시 스케줄링 this.schedule(key, MAX_AGE); } catch (error) { console.error(`Background refresh failed for ${key}:`, error); } }, refreshTime); this.tasks.set(key, taskId); } }; 장점:\n백엔드 시스템 보호 부하 피크 방지 및 평활화 일관된 응답 시간 유지 시스템 안정성 향상 컨텍스트 인식 캐싱(Context-Aware Caching) 사용자 컨텍스트(위치, 기기, 사용자 세그먼트 등)에 따라 캐싱 전략을 동적으로 조정하는 고급 접근법.\n구현 고려사항:\n캐시 키 전략: 컨텍스트 정보를 캐시 키에 통합\n1 2 3 4 5 6 7 8 9 10 11 12 13 function generateCacheKey(baseKey, context) { // 필요한 컨텍스트 요소만 선택 const relevantContext = { country: context.country, userType: context.userType, device: context.deviceCategory }; // 컨텍스트를 정렬된 문자열로 변환하여 일관성 유지 const contextString = JSON.stringify(relevantContext, Object.keys(relevantContext).sort()); return `${baseKey}:${hash(contextString)}`; } 변형 관리(Variant Management): 동일한 리소스의 다양한 컨텍스트별 변형 관리\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 async function getProductDetails(productId, userContext) { // 베이스 키와 컨텍스트 기반 키 생성 const baseKey = `product:${productId}`; const contextKey = generateCacheKey(baseKey, userContext); // 먼저 컨텍스트별 캐시 확인 let data = cache.get(contextKey); if (data) return data; // 컨텍스트별 캐시 미스 시 기본 캐시 확인 data = cache.get(baseKey); if (data) { // 기본 데이터를 컨텍스트에 맞게 변환 const contextualizedData = contextualizeData(data, userContext); // 컨텍스트별 캐시에 저장 cache.set(contextKey, contextualizedData, CONTEXT_TTL); return contextualizedData; } // 모든 캐시 미스 시 원본에서 가져오기 data = await fetchProductFromSource(productId); // 기본 캐시 저장 cache.set(baseKey, data, BASE_TTL); // 컨텍스트화 및 컨텍스트별 캐시 저장 const contextualizedData = contextualizeData(data, userContext); cache.set(contextKey, contextualizedData, CONTEXT_TTL); return contextualizedData; } 적응형 TTL: 컨텍스트, 데이터 유형, 사용 패턴에 따라 캐시 만료 시간 동적 조정\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 function determineTTL(resourceType, context, usagePattern) { let baseTTL = DEFAULT_TTL; // 리소스 유형별 기본 TTL 조정 switch (resourceType) { case 'product': baseTTL = 3600; break; // 1시간 case 'category': baseTTL = 7200; break; // 2시간 case 'userProfile': baseTTL = 300; break; // 5분 } // 지역별 조정 if (context.country === 'US') { baseTTL *= 0.8; // 미국은 데이터 변화가 빠르므로 TTL 감소 } // 사용 패턴별 조정 if (usagePattern === 'highFrequency') { baseTTL *= 1.5; // 자주 접근되는 데이터는 더 오래 캐싱 } return Math.floor(baseTTL); } 장점:\n사용자 경험 개인화와 캐싱 효율성 균형 컨텍스트 관련성 높은 결과 제공 캐시 저장 공간 더 효율적 활용 다양한 사용자 세그먼트 요구 충족 단점:\n캐시 키 폭발 가능성 캐시 적중률 감소 가능성 구현 및 유지 복잡성 증가 에지 컴퓨팅 기반 캐싱(Edge Computing-Based Caching) 콘텐츠를 사용자에게 가까운 에지 위치에서 캐싱 및 처리하여 지연 시간을 최소화하는 전략.\n주요 에지 캐싱 패턴:\n정적 에지 캐싱: 변경이 적은 데이터를 에지에 장기간 캐싱\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 // Cloudflare Workers 예제 addEventListener('fetch', event =\u003e { event.respondWith(handleRequest(event.request)); }); async function handleRequest(request) { const cacheKey = new URL(request.url); // 캐시 확인 const cache = caches.default; let response = await cache.match(request); if (!response) { // 원본 서버에서 가져오기 response = await fetch(request); // 성공적인 GET 요청만 캐싱 if (request.method === 'GET' \u0026\u0026 response.status === 200) { // 에지에 1시간 동안 캐싱 const newResponse = new Response(response.body, response); newResponse.headers.set('Cache-Control', 'public, max-age=3600'); event.waitUntil(cache.put(request, newResponse.clone())); return newResponse; } } return response; } 동적 에지 생성(Dynamic Edge Generation): 에지에서 부분적 콘텐츠 생성 및 변환\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 // Cloudflare Workers 예제 - 데이터 변환 async function handleRequest(request) { // 원본 API에서 데이터 가져오기 const apiResponse = await fetch('https://api.example.com/data'); const data = await apiResponse.json(); // 에지에서 데이터 필터링 및 변환 const transformedData = transformAtEdge(data, getRegionFromRequest(request)); // 변환된 결과 반환 return new Response(JSON.stringify(transformedData), { headers: { 'Content-Type': 'application/json', 'Cache-Control': 'public, max-age=60' } }); } function transformAtEdge(data, region) { // 지역에 따라 데이터 필터링 및 정렬 return data .filter(item =\u003e item.availableRegions.includes(region)) .sort((a, b) =\u003e b.relevanceScore - a.relevanceScore) .slice(0, 20); // 상위 20개 항목만 유지 } 근접성 기반 라우팅(Proximity-Based Routing): 사용자와 가장 가까운 에지 또는 원본 서버로 요청 라우팅\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 async function handleRequest(request) { const userLocation = request.cf.country || 'US'; // 사용자 위치에 기반한 최적의 데이터 소스 결정 const dataSource = determineOptimalDataSource(userLocation); // 데이터 소스에서 데이터 가져오기 return fetch(`https://${dataSource}/api/data`, { headers: request.headers }); } function determineOptimalDataSource(location) { const regionMap = { 'US': 'us-east.api.example.com', 'CA': 'us-east.api.example.com', 'GB': 'eu-west.api.example.com', 'DE': 'eu-central.api.example.com', 'JP': 'ap-northeast.api.example.com', 'AU': 'ap-southeast.api.example.com' }; return regionMap[location] || 'global.api.example.com'; } 장점:\n매우 낮은 지연 시간 지역별 최적화 가능 원본 서버 부하 크게 감소 네트워크 병목 현상 완화 단점:\n에지 위치 간 일관성 관리 어려움 제한된 컴퓨팅 리소스 복잡한 배포 및 관리 특화된 도구 및 플랫폼 필요 API 캐싱을 위한 모범 사례 효과적인 API 캐싱을 위한 핵심 모범 사례와 권장 사항은 다음과 같다:\n캐싱 정책 설계\n리소스별 캐싱 전략: 각 API 엔드포인트의 특성(변경 빈도, 중요도, 접근 패턴)에 맞는 캐싱 정책 설계 캐시 계층화: 여러 캐싱 레이어(클라이언트, CDN, API 게이트웨이, 애플리케이션)의 특성을 활용한 전략 구성 TTL 최적화: 데이터 특성에 따라 적절한 캐시 수명 설정 일관된 캐싱 헤더: 모든 응답에 명확하고 일관된 캐싱 헤더 제공 캐시 키 설계\n효과적인 캐시 키 선택: URL 경로, 쿼리 매개변수, 헤더 등을 고려한 캐시 키 설계 정규화: 동일한 리소스에 대한 다양한 URL 형식을 정규화하여 캐시 효율성 향상 버전 관리: 캐시 키에 리소스 버전 포함하여 갱신 관리 컨텍스트 고려: 필요에 따라 사용자 세그먼트, 디바이스 유형, 위치 등 컨텍스트 정보 포함 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 function generateCacheKey(request) { // 기본 URL 및 경로 정규화 const url = new URL(request.url); const path = url.pathname.toLowerCase().replace(/\\/+$/, ''); // 필수 쿼리 매개변수만 포함 (정렬하여 일관성 유지) const relevantParams = ['category', 'sort', 'limit']; const queryParams = {}; relevantParams.forEach(param =\u003e { if (url.searchParams.has(param)) { queryParams[param] = url.searchParams.get(param); } }); const queryString = new URLSearchParams(queryParams).toString(); // 관련 헤더 포함 (예: 언어, 국가) const language = request.headers.get('Accept-Language') || 'en'; const country = request.headers.get('CF-IPCountry') || 'US'; // API 버전 고려 const apiVersion = request.headers.get('API-Version') || 'v1'; return `${apiVersion}:${path}:${queryString}:${language}:${country}`; } 캐시 무효화 전략\n시간 기반 만료: 적절한 TTL 설정으로 자동 만료 명시적 무효화: 데이터 변경 시 관련 캐시 항목 명시적 삭제 버전 기반 무효화: 리소스 버전을 변경하여 캐시 우회 일괄 무효화: 관련 캐시 항목 그룹을 한 번에 무효화 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 // Redis 캐시 무효화 예제 async function invalidateCache(patterns) { const redisClient = getRedisClient(); for (const pattern of patterns) { // 패턴과 일치하는 모든 키 찾기 const keys = await redisClient.keys(pattern); if (keys.length \u003e 0) { // 일치하는 모든 키 삭제 await redisClient.del(keys); console.log(`Invalidated ${keys.length} cache entries matching pattern: ${pattern}`); } } } // 제품 업데이트 시 관련 캐시 무효화 async function updateProduct(productId, productData) { // 제품 업데이트 await database.products.update(productId, productData); // 관련 캐시 항목 무효화 await invalidateCache([ `product:${productId}*`, // 제품 세부 정보 `category:${productData.categoryId}*`, // 카테고리 목록 `search:*` // 검색 결과 ]); } 모니터링 및 최적화\n캐시 적중률 추적: 캐시 성능을 측정하기 위한 지표 모니터링 핫스팟 식별: 자주 접근되지만 캐시되지 않는 리소스 식별 캐시 크기 최적화: 메모리 사용량과 캐시 적중률 간의 균형 조정 TTL 미세 조정: 사용 패턴에 따른 TTL 주기적 조정 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 // 캐시 메트릭 수집 미들웨어 function cacheMetricsMiddleware(req, res, next) { const startTime = Date.now(); const originalSend = res.send; // 캐시 상태 확인을 위한 플래그 추가 req.cacheStatus = 'MISS'; // 기본값 // 응답 메서드 오버라이드 res.send = function(body) { const responseTime = Date.now() - startTime; // 메트릭 수집 const metrics = { path: req.path, method: req.method, status: res.statusCode, responseTime, cacheStatus: req.cacheStatus, contentLength: Buffer.isBuffer(body) ? body.length : Buffer.byteLength(body) }; // 메트릭 저장 또는 전송 recordMetrics(metrics); // 원래 메서드 호출 return originalSend.call(this, body); }; next(); } // Redis 캐시 래퍼 예제 (메트릭 수집 포함) async function getCachedData(req, key, fetchFunction) { const redisClient = getRedisClient(); try { // 캐시 확인 const cachedData = await redisClient.get(key); if (cachedData) { // 캐시 적중 req.cacheStatus = 'HIT'; return JSON.parse(cachedData); } // 캐시 미스 req.cacheStatus = 'MISS'; // 원본 데이터 가져오기 const data = await fetchFunction(); // 결과 캐싱 await redisClient.set(key, JSON.stringify(data), 'EX', 3600); return data; } catch (error) { // 오류 발생 시 req.cacheStatus = 'ERROR'; throw error; } } 보안 고려사항\n민감한 데이터 캐싱 제한: 개인 식별 정보(PII)나 민감한 데이터는 캐싱 제외 인증된 콘텐츠 처리: 인증이 필요한 데이터의 적절한 캐싱 전략 구현 캐시 포이즌(Cache Poisoning) 방지: 사용자 입력 검증 및 캐시 키 설계 주의 HTTPS 사용: 전송 중 데이터 보호 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 function shouldCacheResponse(request, response) { // 민감한 엔드포인트는 캐싱하지 않음 if (request.path.includes('/user/') || request.path.includes('/payment/') || request.path.includes('/admin/')) { return false; } // 인증된 요청은 특별히 처리 if (request.headers.has('Authorization')) { // 개인화된 데이터는 캐싱하지 않음 return false; // 또는 사용자별 캐시 키 사용 (주의 필요) // request.cacheKey = `${request.cacheKey}:user:${getUserIdFromToken(request)}`; // return true; } // 오류 응답은 캐싱하지 않음 if (response.status \u003e= 400) { return false; } // 나머지는 캐싱 return true; } API 캐싱 구현 사례 연구 실제 API 캐싱 구현의 예시를 통해 다양한 전략과 그 효과를 살펴보자:\n사례 1: 전자상거래 API 캐싱 시나리오: 대규모 전자상거래 플랫폼의 제품 및 카테고리 API\n도전 과제:\n수백만 개의 제품 정보 효율적 제공 주문량 급증 시에도 안정적인 성능 유지 재고 및 가격 정보의 적시성 보장 구현된 캐싱 전략:\n다중 계층 캐싱: CDN: 제품 이미지, 설명 등 정적 콘텐츠 (TTL: 24시간) API 게이트웨이: 카테고리 목록, 제품 검색 결과 (TTL: 15분) 애플리케이션 캐시(Redis): 제품 상세 정보 (TTL: 5분) 데이터베이스 쿼리 캐시: 복잡한 집계 쿼리 (TTL: 1시간) 컨텍스트 인식 캐싱: 국가/지역별 가격 및 재고 캐싱 사용자 세그먼트별 추천 제품 캐싱 재고 관리를 위한 특수 전략: 재고 숫자 \u003e 20: 일반 캐싱 (TTL: 5분) 재고 숫자 \u003c= 20: 짧은 캐싱 (TTL: 1분) 재고 숫자 \u003c= 5: 캐싱하지 않음 (실시간 확인) 결과:\n서버 부하 80% 감소 평균 응답 시간 200ms에서 50ms로 개선 트래픽 급증 시에도 안정적인 성능 유지 추가 하드웨어 비용 절감 사례 2: 소셜 미디어 API 캐싱 시나리오: 대규모 소셜 네트워크 플랫폼의 타임라인 및 사용자 프로필 API\n도전 과제:\n실시간 콘텐츠와 빠른 응답 시간 간의 균형 개인화된 콘텐츠의 효율적인 캐싱 자주 업데이트되는 데이터 관리 구현된 캐싱 전략:\n프래그먼트 캐싱(Fragment Caching): 타임라인의 개별 게시물 단위로 캐싱 사용자 프로필의 각 섹션(기본 정보, 활동, 연결 등) 별도 캐싱 사용자별 캐싱: 사용자 ID 기반 캐시 키 활성 사용자와 비활성 사용자에 대한 차별화된 TTL 타임라인 최적화: ‘인기’ 타임라인: 광범위하게 캐싱 (TTL: 5분) ‘팔로우’ 타임라인: 사용자별 캐싱 + 실시간 업데이트 병합 댓글 및 반응: 읽기 전용 캐싱 + 쓰기 시 무효화 푸시 기반 무효화: 콘텐츠 업데이트 시 이벤트 기반 캐시 무효화 팬아웃(fan-out) 기법으로 관련 사용자의 캐시 선택적 무효화 결과:\n데이터베이스 쿼리 수 65% 감소 타임라인 로딩 시간 300ms에서 80ms로 개선 실시간성을 유지하면서도 서버 부하 크게 감소 사용자당 API 호출 비용 50% 절감 사례 3: 금융 서비스 API 캐싱 시나리오: 주식 시세, 계좌 정보, 거래 이력을 제공하는 금융 API\n도전 과제:\n실시간 시장 데이터의 정확성 민감한 금융 정보의 안전한 처리 규제 준수 및 감사 요구사항 구현된 캐싱 전략:\n데이터 유형별 차별화된 전략: 시장 데이터(공개): 적극적인 캐싱 + 짧은 TTL (10-30초) 계좌 요약 정보: 제한적 캐싱 + 인증 컨텍스트 포함 (TTL: 5분) 거래 이력: 읽기 전용 캐싱 (TTL: 15분) 개인 금융 정보: 캐싱하지 않음 타임스탬프 기반 캐싱: 시장 시간 외 데이터: 장기 캐싱 (TTL: 몇 시간) 거래 시간 중 데이터: 매우 짧은 캐싱 (TTL: 10초) 장 마감 후 데이터: 중간 길이 캐싱 (TTL: 10분) 안전한 사용자별 캐싱: 암호화된 사용자 식별자 기반 캐시 키 메모리 전용 캐싱 (디스크에 저장하지 않음) 세션 종료 시 자동 캐시 무효화 이벤트 기반 실시간 업데이트: WebSocket을 통한 시장 데이터 실시간 푸시 거래 완료 후 관련 캐시 즉시 무효화 결과:\nAPI 서버 부하 70% 감소 시장 데이터 지연 평균 50ms 이내로 유지 규제 준수 유지하면서 성능 최적화 사용자 경험 및 신뢰도 향상 용어 정리 용어 설명 참고 및 출처 ","wordCount":"4834","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2025-02-13T01:30:00Z","dateModified":"2025-02-13T01:30:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/backend/api-design/api-performance/caching-strategies/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>기술 블로그</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend/>Backend</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend/api-design/>APIs</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend/api-design/api-performance/>API Performance</a></div><h1 class="post-title entry-hint-parent">Caching Strategies</h1><div class=post-description>캐싱은 API 설계에서 성능을 최적화하는 핵심 전략이다. 자주 요청되는 데이터를 임시 저장소에 저장함으로써 반복적인 계산, 데이터베이스 쿼리, 네트워크 요청을 줄이고 응답 시간을 대폭 향상시킬 수 있다.</div><div class=post-meta><span title='2025-02-13 01:30:00 +0000 UTC'>February 13, 2025</span>&nbsp;·&nbsp;23 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/Backend/API%20Design/API%20Performance/Caching-Strategies.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#caching-strategies>Caching Strategies</a><ul><li><a href=#api-캐싱의-중요성과-이점>API 캐싱의 중요성과 이점</a></li><li><a href=#api-캐싱의-기본-원칙>API 캐싱의 기본 원칙</a></li><li><a href=#api-캐싱-전략-유형>API 캐싱 전략 유형</a></li><li><a href=#고급-api-캐싱-전략-및-패턴>고급 API 캐싱 전략 및 패턴</a></li><li><a href=#api-캐싱을-위한-모범-사례>API 캐싱을 위한 모범 사례</a></li><li><a href=#api-캐싱-구현-사례-연구>API 캐싱 구현 사례 연구</a></li></ul></li><li><a href=#용어-정리>용어 정리</a></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=caching-strategies>Caching Strategies<a hidden class=anchor aria-hidden=true href=#caching-strategies>#</a></h2><p>캐싱은 API 설계에서 성능을 최적화하는 핵심 전략이다. 자주 요청되는 데이터를 임시 저장소에 저장함으로써 반복적인 계산, 데이터베이스 쿼리, 네트워크 요청을 줄이고 응답 시간을 대폭 향상시킬 수 있다.</p><p>API 캐싱은 현대 웹 애플리케이션과 분산 시스템의 성능, 확장성, 사용자 경험을 개선하는 필수적인 전략이다.</p><p>적절히 구현된 캐싱 전략은 다음과 같은 여러 이점을 제공한다:</p><ul><li><strong>응답 시간 단축</strong>: 사용자에게 더 빠른 API 응답 제공</li><li><strong>백엔드 부하 감소</strong>: 서버와 데이터베이스의 리소스 사용 최적화</li><li><strong>비용 효율성</strong>: 인프라 요구 사항 및 대역폭 비용 절감</li><li><strong>확장성 향상</strong>: 기존 리소스로 더 많은 사용자와 요청 처리</li><li><strong>안정성 개선</strong>: 일시적인 장애 상황에서도 서비스 가용성 유지</li></ul><p>그러나 API 캐싱은 단순히 기술적 구현 이상의 것이다. 효과적인 캐싱 전략은 데이터의 특성, 사용자 요구사항, 비즈니스 우선순위를 철저히 이해하고 이를 기반으로 설계되어야 한다. 데이터의 신선도, 캐시 적중률, 리소스 사용, 구현 복잡성 간의 균형을 맞추는 것이 중요하다.</p><p>또한, 캐싱은 정적인 것이 아니라 시스템과 함께 발전해야 하는 동적인 전략이다. 캐시 성능을 지속적으로 모니터링하고, 사용 패턴 변화에 따라 전략을 조정하며, 새로운 도구와 기술을 평가하는 것이 필요하다.</p><p>최종적으로, API 캐싱의 성공은 그것이 얼마나 보이지 않는지에 달려 있다. 사용자는 단지 빠르고 안정적으로 작동하는 API를 경험할 뿐, 그 뒤에서 작동하는 복잡한 캐싱 메커니즘에 대해서는 알 필요가 없다. 이것이 바로 잘 설계된 캐싱 전략의 특징이다. - 복잡성은 숨기고, 사용자에게는 원활한 경험만 제공하는 것이다.</p><h3 id=api-캐싱의-중요성과-이점>API 캐싱의 중요성과 이점<a hidden class=anchor aria-hidden=true href=#api-캐싱의-중요성과-이점>#</a></h3><p>API 캐싱을 구현하면 다음과 같은 여러 이점을 얻을 수 있다:</p><ol><li><p>성능 향상<br>캐싱은 응답 시간을 크게 단축시킨다. 데이터베이스 접근, 복잡한 계산, 외부 서비스 호출 등 시간이 많이 소요되는 작업의 결과를 캐시에 저장하여 재사용함으로써, 사용자에게 훨씬 빠른 응답을 제공할 수 있다.</p></li><li><p>서버 부하 감소<br>자주 요청되는 데이터를 캐싱하면 서버가 처리해야 할 요청 수가 줄어든다. 이는 CPU, 메모리, 데이터베이스 연결과 같은 서버 리소스의 사용을 최적화하여 더 많은 요청을 처리할 수 있게 한다.</p></li><li><p>확장성 개선<br>효과적인 캐싱 전략은 시스템의 확장성을 크게 향상시킨다. 동일한 하드웨어로 더 많은 요청을 처리할 수 있게 되므로, 인프라 비용을 절감하면서도 성장하는 트래픽을 수용할 수 있다.</p></li><li><p>안정성 향상<br>외부 서비스나 데이터베이스에 일시적인 장애가 발생하더라도, 캐시된 데이터를 통해 서비스를 계속 제공할 수 있다. 이는 시스템의 전반적인 안정성과 회복력을 높이는 데 기여한다.</p></li><li><p>대역폭 절약<br>네트워크 대역폭 사용을 줄임으로써, 특히 모바일 환경이나 제한된 네트워크 환경에서 사용자 경험을 개선할 수 있다.</p></li></ol><h3 id=api-캐싱의-기본-원칙>API 캐싱의 기본 원칙<a hidden class=anchor aria-hidden=true href=#api-캐싱의-기본-원칙>#</a></h3><p>효과적인 API 캐싱을 구현하기 위해서는 몇 가지 핵심 원칙을 이해하는 것이 중요하다:</p><ol><li><p>캐시 위치(Cache Location)<br>캐시는 시스템의 여러 계층에 위치할 수 있으며, 각 위치는 고유한 장단점을 갖는다:</p><ul><li><strong>클라이언트 측 캐싱</strong>: 브라우저나 모바일 앱 등의 클라이언트에서 데이터를 캐싱</li><li><strong>네트워크 캐싱</strong>: CDN, 프록시 서버, API 게이트웨이에서의 캐싱</li><li><strong>서버 측 캐싱</strong>: API 서버 내부 또는 분산 캐시 시스템에서의 캐싱</li><li><strong>데이터베이스 캐싱</strong>: 데이터베이스 쿼리 결과나 계산된 데이터의 캐싱</li></ul></li><li><p>캐시 무효화(Cache Invalidation)<br>캐시된 데이터가 원본 데이터와 일치하도록 관리하는 과정은 캐싱에서 가장 어려운 부분 중 하나이다:</p><ul><li><strong>TTL(Time-To-Live) 기반</strong>: 일정 시간이 지나면 자동으로 캐시 항목 만료</li><li><strong>이벤트 기반</strong>: 데이터 변경 이벤트 발생 시 관련 캐시 항목 무효화</li><li><strong>버전 기반</strong>: 데이터 변경 시 새 버전 식별자를 사용하여 캐시 항목 관리</li></ul></li><li><p>캐시 정책(Caching Policy)<br>어떤 데이터를 얼마나 오래 캐싱할지 결정하는 정책은 애플리케이션의 특성과 요구사항에 맞게 설계되어야 한다:</p><ul><li><strong>자주 접근되고 변경이 적은 데이터</strong>: 더 오랜 기간 캐싱</li><li><strong>자주 변경되는 데이터</strong>: 짧은 캐싱 기간 또는 특정 조건에서만 캐싱</li><li><strong>개인화된 데이터</strong>: 사용자별 캐싱 또는 캐싱 제외 고려</li></ul></li></ol><h3 id=api-캐싱-전략-유형>API 캐싱 전략 유형<a hidden class=anchor aria-hidden=true href=#api-캐싱-전략-유형>#</a></h3><p>API 캐싱은 다양한 수준과 위치에서 구현될 수 있으며, 각 전략은 특정 사용 사례와 요구사항에 적합하다.</p><p>다음은 주요 API 캐싱 전략들이다:</p><h4 id=http-캐싱>HTTP 캐싱<a hidden class=anchor aria-hidden=true href=#http-캐싱>#</a></h4><p>HTTP 프로토콜은 웹에서의 효율적인 캐싱을 위한 내장 메커니즘을 제공한다. 이 방법은 구현이 간단하며 브라우저, CDN, 프록시 서버 등 HTTP 스택의 모든 계층에서 작동한다.</p><h5 id=주요-http-캐싱-헤더>주요 HTTP 캐싱 헤더<a hidden class=anchor aria-hidden=true href=#주요-http-캐싱-헤더>#</a></h5><p><strong>Cache-Control</strong>: 가장 중요한 캐싱 헤더로, 캐싱 동작을 세밀하게 제어한다.</p><pre class=mermaid>Cache-Control: max-age=3600, public
</pre><p>주요 지시어:</p><ul><li><code>max-age</code>: 캐시의 신선도 유지 시간(초 단위)</li><li><code>public</code>: 모든 캐시에서 응답을 저장할 수 있음</li><li><code>private</code>: 브라우저 같은 개인 캐시에서만 저장 가능</li><li><code>no-cache</code>: 재검증 없이 캐시된 응답을 사용하지 않음</li><li><code>no-store</code>: 어떤 캐시에도 응답을 저장하지 않음</li><li><code>must-revalidate</code>: 만료된 캐시 항목은 반드시 원본 서버에서 재검증</li></ul><p><strong>ETag</strong>: 리소스의 특정 버전을 식별하는 고유 문자열이다. 변경 감지에 사용된다.</p><pre class=mermaid>ETag: &#34;33a64df551425fcc55e4d42a148795d9f25f89d4&#34;
</pre><p><strong>Last-Modified</strong>: 리소스가 마지막으로 변경된 날짜와 시간을 나타낸다.</p><pre class=mermaid>Last-Modified: Wed, 21 Oct 2023 07:28:00 GMT
</pre><p><strong>If-None-Match</strong> 및 <strong>If-Modified-Since</strong>: 클라이언트가 이전에 받은 ETag 또는 Last-Modified 정보를 사용하여 조건부 요청을 보낼 때 사용된다.</p><h5 id=http-캐싱-작동-방식>HTTP 캐싱 작동 방식<a hidden class=anchor aria-hidden=true href=#http-캐싱-작동-방식>#</a></h5><ol><li>클라이언트가 리소스를 요청한다.</li><li>서버는 캐싱 헤더를 포함한 응답을 보낸다.</li><li>클라이언트(또는 중간 캐시)는 이 응답을 저장한다.</li><li>동일한 리소스에 대한 후속 요청 시, 캐시 정책에 따라:<ul><li>유효한 캐시가 있으면: 캐시된 응답을 직접 사용(304 Not Modified)</li><li>캐시가 오래되었으면: 조건부 요청으로 서버에 재검증</li></ul></li></ol><h5 id=구현-예제spring-boot>구현 예제(Spring Boot)<a hidden class=anchor aria-hidden=true href=#구현-예제spring-boot>#</a></h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1> 1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2> 2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3> 3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4> 4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5> 5</a>
</span><span class=lnt id=hl-3-6><a class=lnlinks href=#hl-3-6> 6</a>
</span><span class=lnt id=hl-3-7><a class=lnlinks href=#hl-3-7> 7</a>
</span><span class=lnt id=hl-3-8><a class=lnlinks href=#hl-3-8> 8</a>
</span><span class=lnt id=hl-3-9><a class=lnlinks href=#hl-3-9> 9</a>
</span><span class=lnt id=hl-3-10><a class=lnlinks href=#hl-3-10>10</a>
</span><span class=lnt id=hl-3-11><a class=lnlinks href=#hl-3-11>11</a>
</span><span class=lnt id=hl-3-12><a class=lnlinks href=#hl-3-12>12</a>
</span><span class=lnt id=hl-3-13><a class=lnlinks href=#hl-3-13>13</a>
</span><span class=lnt id=hl-3-14><a class=lnlinks href=#hl-3-14>14</a>
</span><span class=lnt id=hl-3-15><a class=lnlinks href=#hl-3-15>15</a>
</span><span class=lnt id=hl-3-16><a class=lnlinks href=#hl-3-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RestController</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ProductController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/products/{id}&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>ResponseEntity</span><span class=o>&lt;</span><span class=n>Product</span><span class=o>&gt;</span><span class=w> </span><span class=nf>getProduct</span><span class=p>(</span><span class=nd>@PathVariable</span><span class=w> </span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Product</span><span class=w> </span><span class=n>product</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>productService</span><span class=p>.</span><span class=na>findById</span><span class=p>(</span><span class=n>id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// ETag 생성 (제품 데이터의 해시 값)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>etag</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DigestUtils</span><span class=p>.</span><span class=na>md5DigestAsHex</span><span class=p>(</span><span class=n>product</span><span class=p>.</span><span class=na>toString</span><span class=p>().</span><span class=na>getBytes</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>ResponseEntity</span><span class=p>.</span><span class=na>ok</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>cacheControl</span><span class=p>(</span><span class=n>CacheControl</span><span class=p>.</span><span class=na>maxAge</span><span class=p>(</span><span class=n>1</span><span class=p>,</span><span class=w> </span><span class=n>TimeUnit</span><span class=p>.</span><span class=na>HOURS</span><span class=p>).</span><span class=na>cachePublic</span><span class=p>())</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>eTag</span><span class=p>(</span><span class=n>etag</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>body</span><span class=p>(</span><span class=n>product</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=http-캐싱의-장점>HTTP 캐싱의 장점<a hidden class=anchor aria-hidden=true href=#http-캐싱의-장점>#</a></h5><ul><li>표준 HTTP 인프라를 활용하여 추가 서버 구성 없이 구현 가능</li><li>클라이언트, CDN, 프록시 등 여러 계층에서 작동</li><li>네트워크 트래픽 감소 및 서버 부하 경감</li></ul><h5 id=http-캐싱의-단점>HTTP 캐싱의 단점<a hidden class=anchor aria-hidden=true href=#http-캐싱의-단점>#</a></h5><ul><li>세밀한 캐시 제어가 제한적일 수 있음</li><li>개인화된 콘텐츠나 동적 API 응답에는 적합하지 않을 수 있음</li><li>데이터 변경 시 즉각적인 캐시 무효화가 어려울 수 있음</li></ul><h4 id=애플리케이션-레벨-캐싱>애플리케이션 레벨 캐싱<a hidden class=anchor aria-hidden=true href=#애플리케이션-레벨-캐싱>#</a></h4><p>애플리케이션 레벨 캐싱은 API 서버 내부에서 메모리, 로컬 디스크 또는 전용 캐싱 시스템을 사용하여 구현된다. 이 방법은 세밀한 제어가 가능하고 특정 애플리케이션 요구사항에 맞게 최적화할 수 있다.</p><h5 id=인메모리-캐싱>인메모리 캐싱<a hidden class=anchor aria-hidden=true href=#인메모리-캐싱>#</a></h5><p>가장 단순하고 빠른 형태의 캐싱으로, 애플리케이션 메모리에 데이터를 직접 저장한다.</p><p><strong>Node.js 구현 예제(node-cache):</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span><span class=lnt id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a>
</span><span class=lnt id=hl-4-19><a class=lnlinks href=#hl-4-19>19</a>
</span><span class=lnt id=hl-4-20><a class=lnlinks href=#hl-4-20>20</a>
</span><span class=lnt id=hl-4-21><a class=lnlinks href=#hl-4-21>21</a>
</span><span class=lnt id=hl-4-22><a class=lnlinks href=#hl-4-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>NodeCache</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;node-cache&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cache</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>NodeCache</span><span class=p>({</span> <span class=nx>stdTTL</span><span class=o>:</span> <span class=mi>600</span> <span class=p>});</span> <span class=c1>// 10분 TTL
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>getProductById</span><span class=p>(</span><span class=nx>id</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 캐시에서 먼저 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>cacheKey</span> <span class=o>=</span> <span class=sb>`product_</span><span class=si>${</span><span class=nx>id</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>cachedProduct</span> <span class=o>=</span> <span class=nx>cache</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>cacheKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>cachedProduct</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Cache hit!&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>cachedProduct</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 캐시에 없으면 데이터베이스에서 조회
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Cache miss, fetching from database…&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>product</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>db</span><span class=p>.</span><span class=nx>products</span><span class=p>.</span><span class=nx>findById</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 결과를 캐시에 저장
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>cache</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>cacheKey</span><span class=p>,</span> <span class=nx>product</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>product</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Spring Boot 구현 예제(Caffeine):</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16>16</a>
</span><span class=lnt id=hl-5-17><a class=lnlinks href=#hl-5-17>17</a>
</span><span class=lnt id=hl-5-18><a class=lnlinks href=#hl-5-18>18</a>
</span><span class=lnt id=hl-5-19><a class=lnlinks href=#hl-5-19>19</a>
</span><span class=lnt id=hl-5-20><a class=lnlinks href=#hl-5-20>20</a>
</span><span class=lnt id=hl-5-21><a class=lnlinks href=#hl-5-21>21</a>
</span><span class=lnt id=hl-5-22><a class=lnlinks href=#hl-5-22>22</a>
</span><span class=lnt id=hl-5-23><a class=lnlinks href=#hl-5-23>23</a>
</span><span class=lnt id=hl-5-24><a class=lnlinks href=#hl-5-24>24</a>
</span><span class=lnt id=hl-5-25><a class=lnlinks href=#hl-5-25>25</a>
</span><span class=lnt id=hl-5-26><a class=lnlinks href=#hl-5-26>26</a>
</span><span class=lnt id=hl-5-27><a class=lnlinks href=#hl-5-27>27</a>
</span><span class=lnt id=hl-5-28><a class=lnlinks href=#hl-5-28>28</a>
</span><span class=lnt id=hl-5-29><a class=lnlinks href=#hl-5-29>29</a>
</span><span class=lnt id=hl-5-30><a class=lnlinks href=#hl-5-30>30</a>
</span><span class=lnt id=hl-5-31><a class=lnlinks href=#hl-5-31>31</a>
</span><span class=lnt id=hl-5-32><a class=lnlinks href=#hl-5-32>32</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableCaching</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>CacheConfig</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>CacheManager</span><span class=w> </span><span class=nf>cacheManager</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>CaffeineCacheManager</span><span class=w> </span><span class=n>cacheManager</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>CaffeineCacheManager</span><span class=p>(</span><span class=s>&#34;products&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>cacheManager</span><span class=p>.</span><span class=na>setCaffeine</span><span class=p>(</span><span class=n>Caffeine</span><span class=p>.</span><span class=na>newBuilder</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>expireAfterWrite</span><span class=p>(</span><span class=n>10</span><span class=p>,</span><span class=w> </span><span class=n>TimeUnit</span><span class=p>.</span><span class=na>MINUTES</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>maximumSize</span><span class=p>(</span><span class=n>1000</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>cacheManager</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ProductService</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>ProductRepository</span><span class=w> </span><span class=n>productRepository</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Cacheable</span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;products&#34;</span><span class=p>,</span><span class=w> </span><span class=n>key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;#id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Product</span><span class=w> </span><span class=nf>findById</span><span class=p>(</span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 캐시 미스 시에만 실행됨</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>productRepository</span><span class=p>.</span><span class=na>findById</span><span class=p>(</span><span class=n>id</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>orElseThrow</span><span class=p>(()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>ProductNotFoundException</span><span class=p>(</span><span class=n>id</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@CacheEvict</span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;products&#34;</span><span class=p>,</span><span class=w> </span><span class=n>key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;#product.id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Product</span><span class=w> </span><span class=nf>update</span><span class=p>(</span><span class=n>Product</span><span class=w> </span><span class=n>product</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>productRepository</span><span class=p>.</span><span class=na>save</span><span class=p>(</span><span class=n>product</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=분산-캐싱>분산 캐싱<a hidden class=anchor aria-hidden=true href=#분산-캐싱>#</a></h5><p>여러 서버 또는 인스턴스 간에 캐시를 공유하기 위해 Redis, Memcached와 같은 분산 캐시 시스템을 사용한다.</p><p><strong>Node.js 구현 예제(Redis):</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1> 1</a>
</span><span class=lnt id=hl-6-2><a class=lnlinks href=#hl-6-2> 2</a>
</span><span class=lnt id=hl-6-3><a class=lnlinks href=#hl-6-3> 3</a>
</span><span class=lnt id=hl-6-4><a class=lnlinks href=#hl-6-4> 4</a>
</span><span class=lnt id=hl-6-5><a class=lnlinks href=#hl-6-5> 5</a>
</span><span class=lnt id=hl-6-6><a class=lnlinks href=#hl-6-6> 6</a>
</span><span class=lnt id=hl-6-7><a class=lnlinks href=#hl-6-7> 7</a>
</span><span class=lnt id=hl-6-8><a class=lnlinks href=#hl-6-8> 8</a>
</span><span class=lnt id=hl-6-9><a class=lnlinks href=#hl-6-9> 9</a>
</span><span class=lnt id=hl-6-10><a class=lnlinks href=#hl-6-10>10</a>
</span><span class=lnt id=hl-6-11><a class=lnlinks href=#hl-6-11>11</a>
</span><span class=lnt id=hl-6-12><a class=lnlinks href=#hl-6-12>12</a>
</span><span class=lnt id=hl-6-13><a class=lnlinks href=#hl-6-13>13</a>
</span><span class=lnt id=hl-6-14><a class=lnlinks href=#hl-6-14>14</a>
</span><span class=lnt id=hl-6-15><a class=lnlinks href=#hl-6-15>15</a>
</span><span class=lnt id=hl-6-16><a class=lnlinks href=#hl-6-16>16</a>
</span><span class=lnt id=hl-6-17><a class=lnlinks href=#hl-6-17>17</a>
</span><span class=lnt id=hl-6-18><a class=lnlinks href=#hl-6-18>18</a>
</span><span class=lnt id=hl-6-19><a class=lnlinks href=#hl-6-19>19</a>
</span><span class=lnt id=hl-6-20><a class=lnlinks href=#hl-6-20>20</a>
</span><span class=lnt id=hl-6-21><a class=lnlinks href=#hl-6-21>21</a>
</span><span class=lnt id=hl-6-22><a class=lnlinks href=#hl-6-22>22</a>
</span><span class=lnt id=hl-6-23><a class=lnlinks href=#hl-6-23>23</a>
</span><span class=lnt id=hl-6-24><a class=lnlinks href=#hl-6-24>24</a>
</span><span class=lnt id=hl-6-25><a class=lnlinks href=#hl-6-25>25</a>
</span><span class=lnt id=hl-6-26><a class=lnlinks href=#hl-6-26>26</a>
</span><span class=lnt id=hl-6-27><a class=lnlinks href=#hl-6-27>27</a>
</span><span class=lnt id=hl-6-28><a class=lnlinks href=#hl-6-28>28</a>
</span><span class=lnt id=hl-6-29><a class=lnlinks href=#hl-6-29>29</a>
</span><span class=lnt id=hl-6-30><a class=lnlinks href=#hl-6-30>30</a>
</span><span class=lnt id=hl-6-31><a class=lnlinks href=#hl-6-31>31</a>
</span><span class=lnt id=hl-6-32><a class=lnlinks href=#hl-6-32>32</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>redis</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;redis&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=p>{</span> <span class=nx>promisify</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;util&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>client</span> <span class=o>=</span> <span class=nx>redis</span><span class=p>.</span><span class=nx>createClient</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 프로미스 기반으로 Redis 메서드 변환
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>getAsync</span> <span class=o>=</span> <span class=nx>promisify</span><span class=p>(</span><span class=nx>client</span><span class=p>.</span><span class=nx>get</span><span class=p>).</span><span class=nx>bind</span><span class=p>(</span><span class=nx>client</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>setAsync</span> <span class=o>=</span> <span class=nx>promisify</span><span class=p>(</span><span class=nx>client</span><span class=p>.</span><span class=nx>set</span><span class=p>).</span><span class=nx>bind</span><span class=p>(</span><span class=nx>client</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>getProductById</span><span class=p>(</span><span class=nx>id</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>cacheKey</span> <span class=o>=</span> <span class=sb>`product:</span><span class=si>${</span><span class=nx>id</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 캐시에서 먼저 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>cachedProduct</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>getAsync</span><span class=p>(</span><span class=nx>cacheKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>cachedProduct</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>cachedProduct</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 캐시에 없으면 데이터베이스에서 조회
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>product</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>db</span><span class=p>.</span><span class=nx>products</span><span class=p>.</span><span class=nx>findById</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 결과를 캐시에 저장 (10분 TTL)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>await</span> <span class=nx>setAsync</span><span class=p>(</span><span class=nx>cacheKey</span><span class=p>,</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>product</span><span class=p>),</span> <span class=s1>&#39;EX&#39;</span><span class=p>,</span> <span class=mi>600</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>product</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=s1>&#39;Cache error:&#39;</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 캐시 오류 시 데이터베이스에서 직접 조회
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=kr>await</span> <span class=nx>db</span><span class=p>.</span><span class=nx>products</span><span class=p>.</span><span class=nx>findById</span><span class=p>(</span><span class=nx>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Spring Boot 구현 예제(Redis):</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span><span class=lnt id=hl-7-12><a class=lnlinks href=#hl-7-12>12</a>
</span><span class=lnt id=hl-7-13><a class=lnlinks href=#hl-7-13>13</a>
</span><span class=lnt id=hl-7-14><a class=lnlinks href=#hl-7-14>14</a>
</span><span class=lnt id=hl-7-15><a class=lnlinks href=#hl-7-15>15</a>
</span><span class=lnt id=hl-7-16><a class=lnlinks href=#hl-7-16>16</a>
</span><span class=lnt id=hl-7-17><a class=lnlinks href=#hl-7-17>17</a>
</span><span class=lnt id=hl-7-18><a class=lnlinks href=#hl-7-18>18</a>
</span><span class=lnt id=hl-7-19><a class=lnlinks href=#hl-7-19>19</a>
</span><span class=lnt id=hl-7-20><a class=lnlinks href=#hl-7-20>20</a>
</span><span class=lnt id=hl-7-21><a class=lnlinks href=#hl-7-21>21</a>
</span><span class=lnt id=hl-7-22><a class=lnlinks href=#hl-7-22>22</a>
</span><span class=lnt id=hl-7-23><a class=lnlinks href=#hl-7-23>23</a>
</span><span class=lnt id=hl-7-24><a class=lnlinks href=#hl-7-24>24</a>
</span><span class=lnt id=hl-7-25><a class=lnlinks href=#hl-7-25>25</a>
</span><span class=lnt id=hl-7-26><a class=lnlinks href=#hl-7-26>26</a>
</span><span class=lnt id=hl-7-27><a class=lnlinks href=#hl-7-27>27</a>
</span><span class=lnt id=hl-7-28><a class=lnlinks href=#hl-7-28>28</a>
</span><span class=lnt id=hl-7-29><a class=lnlinks href=#hl-7-29>29</a>
</span><span class=lnt id=hl-7-30><a class=lnlinks href=#hl-7-30>30</a>
</span><span class=lnt id=hl-7-31><a class=lnlinks href=#hl-7-31>31</a>
</span><span class=lnt id=hl-7-32><a class=lnlinks href=#hl-7-32>32</a>
</span><span class=lnt id=hl-7-33><a class=lnlinks href=#hl-7-33>33</a>
</span><span class=lnt id=hl-7-34><a class=lnlinks href=#hl-7-34>34</a>
</span><span class=lnt id=hl-7-35><a class=lnlinks href=#hl-7-35>35</a>
</span><span class=lnt id=hl-7-36><a class=lnlinks href=#hl-7-36>36</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableCaching</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>RedisCacheConfig</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>RedisConnectionFactory</span><span class=w> </span><span class=nf>redisConnectionFactory</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>LettuceConnectionFactory</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>RedisCacheManager</span><span class=w> </span><span class=nf>cacheManager</span><span class=p>(</span><span class=n>RedisConnectionFactory</span><span class=w> </span><span class=n>redisConnectionFactory</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>RedisCacheConfiguration</span><span class=w> </span><span class=n>cacheConfig</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RedisCacheConfiguration</span><span class=p>.</span><span class=na>defaultCacheConfig</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>entryTtl</span><span class=p>(</span><span class=n>Duration</span><span class=p>.</span><span class=na>ofMinutes</span><span class=p>(</span><span class=n>10</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>serializeValuesWith</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>RedisSerializationContext</span><span class=p>.</span><span class=na>SerializationPair</span><span class=p>.</span><span class=na>fromSerializer</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>new</span><span class=w> </span><span class=n>GenericJackson2JsonRedisSerializer</span><span class=p>()));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>RedisCacheManager</span><span class=p>.</span><span class=na>builder</span><span class=p>(</span><span class=n>redisConnectionFactory</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>cacheDefaults</span><span class=p>(</span><span class=n>cacheConfig</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ProductService</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Cacheable</span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;products&#34;</span><span class=p>,</span><span class=w> </span><span class=n>key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;#id&#34;</span><span class=p>,</span><span class=w> </span><span class=n>unless</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;#result == null&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Product</span><span class=w> </span><span class=nf>findById</span><span class=p>(</span><span class=n>Long</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>productRepository</span><span class=p>.</span><span class=na>findById</span><span class=p>(</span><span class=n>id</span><span class=p>).</span><span class=na>orElse</span><span class=p>(</span><span class=kc>null</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@CacheEvict</span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;products&#34;</span><span class=p>,</span><span class=w> </span><span class=n>key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;#product.id&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Product</span><span class=w> </span><span class=nf>update</span><span class=p>(</span><span class=n>Product</span><span class=w> </span><span class=n>product</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>productRepository</span><span class=p>.</span><span class=na>save</span><span class=p>(</span><span class=n>product</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=애플리케이션-레벨-캐싱의-장점>애플리케이션 레벨 캐싱의 장점<a hidden class=anchor aria-hidden=true href=#애플리케이션-레벨-캐싱의-장점>#</a></h5><ul><li>세밀한 제어가 가능하며 비즈니스 로직에 최적화 가능</li><li>데이터베이스 부하 감소</li><li>복잡한 계산 결과나 집계 데이터 캐싱에 적합</li><li>캐시 무효화를 애플리케이션 로직과 직접 통합 가능</li></ul><h5 id=애플리케이션-레벨-캐싱의-단점>애플리케이션 레벨 캐싱의 단점<a hidden class=anchor aria-hidden=true href=#애플리케이션-레벨-캐싱의-단점>#</a></h5><ul><li>구현 및 유지보수 복잡성 증가</li><li>메모리 사용량 관리 필요</li><li>분산 환경에서 캐시 일관성 유지의 어려움</li></ul><h4 id=데이터베이스-캐싱>데이터베이스 캐싱<a hidden class=anchor aria-hidden=true href=#데이터베이스-캐싱>#</a></h4><p>데이터베이스 자체에 내장된 캐싱 메커니즘을 활용하거나, 데이터베이스 쿼리 결과를 캐싱하는 전략.</p><h5 id=데이터베이스-내장-캐싱>데이터베이스 내장 캐싱<a hidden class=anchor aria-hidden=true href=#데이터베이스-내장-캐싱>#</a></h5><p>대부분의 데이터베이스 시스템은 내부적으로 다양한 캐싱 메커니즘을 제공한다:</p><ul><li><strong>쿼리 캐시</strong>: 자주 사용되는 쿼리의 결과를 메모리에 저장</li><li><strong>버퍼 풀/캐시</strong>: 디스크에서 읽은 데이터 페이지를 메모리에 저장</li><li><strong>결과셋 캐싱</strong>: 쿼리 결과를 임시 저장</li></ul><p><strong>MySQL 쿼리 캐싱 설정 예제:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1> 1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2> 2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3> 3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4> 4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5> 5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6> 6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7> 7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8> 8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9> 9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 쿼리 캐시 상태 확인
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SHOW</span><span class=w> </span><span class=n>VARIABLES</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;query_cache%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 쿼리 캐시 활성화 (my.cnf 또는 my.ini 파일)
</span></span></span><span class=line><span class=cl><span class=c1>-- query_cache_type = 1
</span></span></span><span class=line><span class=cl><span class=c1>-- query_cache_size = 64M
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 특정 쿼리에 대해 캐싱 활성화/비활성화
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>SQL_CACHE</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>category_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>SQL_NO_CACHE</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>products</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>category_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=orm-수준의-캐싱>ORM 수준의 캐싱<a hidden class=anchor aria-hidden=true href=#orm-수준의-캐싱>#</a></h5><p>ORM(Object-Relational Mapping) 프레임워크는 일반적으로 여러 수준의 캐싱을 제공한다:</p><ul><li><strong>1차 캐시(세션 캐시)</strong>: 트랜잭션 내에서 엔티티 캐싱</li><li><strong>2차 캐시</strong>: 여러 세션 간에 공유되는 엔티티 캐시</li><li><strong>쿼리 캐시</strong>: 쿼리 결과셋 캐싱</li></ul><p><strong>Hibernate 2차 캐시 구성 예제:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1> 1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2> 2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3> 3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4> 4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5> 5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6> 6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7> 7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8> 8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9> 9</a>
</span><span class=lnt id=hl-9-10><a class=lnlinks href=#hl-9-10>10</a>
</span><span class=lnt id=hl-9-11><a class=lnlinks href=#hl-9-11>11</a>
</span><span class=lnt id=hl-9-12><a class=lnlinks href=#hl-9-12>12</a>
</span><span class=lnt id=hl-9-13><a class=lnlinks href=#hl-9-13>13</a>
</span><span class=lnt id=hl-9-14><a class=lnlinks href=#hl-9-14>14</a>
</span><span class=lnt id=hl-9-15><a class=lnlinks href=#hl-9-15>15</a>
</span><span class=lnt id=hl-9-16><a class=lnlinks href=#hl-9-16>16</a>
</span><span class=lnt id=hl-9-17><a class=lnlinks href=#hl-9-17>17</a>
</span><span class=lnt id=hl-9-18><a class=lnlinks href=#hl-9-18>18</a>
</span><span class=lnt id=hl-9-19><a class=lnlinks href=#hl-9-19>19</a>
</span><span class=lnt id=hl-9-20><a class=lnlinks href=#hl-9-20>20</a>
</span><span class=lnt id=hl-9-21><a class=lnlinks href=#hl-9-21>21</a>
</span><span class=lnt id=hl-9-22><a class=lnlinks href=#hl-9-22>22</a>
</span><span class=lnt id=hl-9-23><a class=lnlinks href=#hl-9-23>23</a>
</span><span class=lnt id=hl-9-24><a class=lnlinks href=#hl-9-24>24</a>
</span><span class=lnt id=hl-9-25><a class=lnlinks href=#hl-9-25>25</a>
</span><span class=lnt id=hl-9-26><a class=lnlinks href=#hl-9-26>26</a>
</span><span class=lnt id=hl-9-27><a class=lnlinks href=#hl-9-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Configuration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableCaching</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>HibernateCacheConfig</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>LocalContainerEntityManagerFactoryBean</span><span class=w> </span><span class=nf>entityManagerFactory</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>LocalContainerEntityManagerFactoryBean</span><span class=w> </span><span class=n>em</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>LocalContainerEntityManagerFactoryBean</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// … 기본 설정 …</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Properties</span><span class=w> </span><span class=n>hibernateProps</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Properties</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>hibernateProps</span><span class=p>.</span><span class=na>setProperty</span><span class=p>(</span><span class=s>&#34;hibernate.cache.use_second_level_cache&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;true&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>hibernateProps</span><span class=p>.</span><span class=na>setProperty</span><span class=p>(</span><span class=s>&#34;hibernate.cache.region.factory_class&#34;</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=s>&#34;org.hibernate.cache.jcache.JCacheRegionFactory&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>hibernateProps</span><span class=p>.</span><span class=na>setProperty</span><span class=p>(</span><span class=s>&#34;hibernate.javax.cache.provider&#34;</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=s>&#34;org.ehcache.jsr107.EhcacheCachingProvider&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>em</span><span class=p>.</span><span class=na>setJpaProperties</span><span class=p>(</span><span class=n>hibernateProps</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>em</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;products&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Cache</span><span class=p>(</span><span class=n>usage</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CacheConcurrencyStrategy</span><span class=p>.</span><span class=na>READ_WRITE</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Product</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 엔티티 정의</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=데이터베이스-캐싱의-장점>데이터베이스 캐싱의 장점<a hidden class=anchor aria-hidden=true href=#데이터베이스-캐싱의-장점>#</a></h5><ul><li>기존 데이터베이스 기능을 활용하여 추가 인프라 없이 구현 가능</li><li>데이터 액세스 패턴에 최적화 가능</li><li>ORM 캐싱은 개발자가 캐싱 로직을 직접 관리할 필요성 감소</li></ul><h5 id=데이터베이스-캐싱의-단점>데이터베이스 캐싱의 단점<a hidden class=anchor aria-hidden=true href=#데이터베이스-캐싱의-단점>#</a></h5><ul><li>데이터베이스 시스템 자체의 리소스를 소비</li><li>세밀한 제어가 제한적일 수 있음</li><li>캐시 인프라가 데이터베이스 서버에 종속됨</li></ul><h4 id=cdn-캐싱content-delivery-network>CDN 캐싱(Content Delivery Network)<a hidden class=anchor aria-hidden=true href=#cdn-캐싱content-delivery-network>#</a></h4><p>CDN은 전 세계 여러 위치에 분산된 서버 네트워크를 통해 콘텐츠를 캐싱하고 제공한다. API 응답을 CDN을 통해 캐싱하면 지리적으로 분산된 사용자에게 더 빠른 응답을 제공할 수 있다.</p><h5 id=cdn-캐싱-구성>CDN 캐싱 구성<a hidden class=anchor aria-hidden=true href=#cdn-캐싱-구성>#</a></h5><ol><li>API 응답에 적절한 캐싱 헤더 설정(Cache-Control, Expires 등)</li><li>CDN 서비스(Cloudflare, Akamai, AWS CloudFront 등) 구성</li><li>API 엔드포인트를 CDN 배포에 연결</li></ol><p><strong>AWS CloudFront 설정 예제:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span><span class=lnt id=hl-10-15><a class=lnlinks href=#hl-10-15>15</a>
</span><span class=lnt id=hl-10-16><a class=lnlinks href=#hl-10-16>16</a>
</span><span class=lnt id=hl-10-17><a class=lnlinks href=#hl-10-17>17</a>
</span><span class=lnt id=hl-10-18><a class=lnlinks href=#hl-10-18>18</a>
</span><span class=lnt id=hl-10-19><a class=lnlinks href=#hl-10-19>19</a>
</span><span class=lnt id=hl-10-20><a class=lnlinks href=#hl-10-20>20</a>
</span><span class=lnt id=hl-10-21><a class=lnlinks href=#hl-10-21>21</a>
</span><span class=lnt id=hl-10-22><a class=lnlinks href=#hl-10-22>22</a>
</span><span class=lnt id=hl-10-23><a class=lnlinks href=#hl-10-23>23</a>
</span><span class=lnt id=hl-10-24><a class=lnlinks href=#hl-10-24>24</a>
</span><span class=lnt id=hl-10-25><a class=lnlinks href=#hl-10-25>25</a>
</span><span class=lnt id=hl-10-26><a class=lnlinks href=#hl-10-26>26</a>
</span><span class=lnt id=hl-10-27><a class=lnlinks href=#hl-10-27>27</a>
</span><span class=lnt id=hl-10-28><a class=lnlinks href=#hl-10-28>28</a>
</span><span class=lnt id=hl-10-29><a class=lnlinks href=#hl-10-29>29</a>
</span><span class=lnt id=hl-10-30><a class=lnlinks href=#hl-10-30>30</a>
</span><span class=lnt id=hl-10-31><a class=lnlinks href=#hl-10-31>31</a>
</span><span class=lnt id=hl-10-32><a class=lnlinks href=#hl-10-32>32</a>
</span><span class=lnt id=hl-10-33><a class=lnlinks href=#hl-10-33>33</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;DistributionConfig&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;DefaultCacheBehavior&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;TargetOriginId&#34;</span><span class=p>:</span> <span class=s2>&#34;api-origin&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;ViewerProtocolPolicy&#34;</span><span class=p>:</span> <span class=s2>&#34;redirect-to-https&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;AllowedMethods&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Quantity&#34;</span><span class=p>:</span> <span class=mi>7</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Items&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;GET&#34;</span><span class=p>,</span> <span class=s2>&#34;HEAD&#34;</span><span class=p>,</span> <span class=s2>&#34;OPTIONS&#34;</span><span class=p>,</span> <span class=s2>&#34;PUT&#34;</span><span class=p>,</span> <span class=s2>&#34;POST&#34;</span><span class=p>,</span> <span class=s2>&#34;PATCH&#34;</span><span class=p>,</span> <span class=s2>&#34;DELETE&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;CachedMethods&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Quantity&#34;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Items&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;GET&#34;</span><span class=p>,</span> <span class=s2>&#34;HEAD&#34;</span><span class=p>,</span> <span class=s2>&#34;OPTIONS&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;ForwardedValues&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;QueryString&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Cookies&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;Forward&#34;</span><span class=p>:</span> <span class=s2>&#34;whitelist&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;WhitelistedNames&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Quantity&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;Items&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;session-id&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Headers&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;Quantity&#34;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;Items&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;Authorization&#34;</span><span class=p>,</span> <span class=s2>&#34;Accept&#34;</span><span class=p>,</span> <span class=s2>&#34;Content-Type&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;MinTTL&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;DefaultTTL&#34;</span><span class=p>:</span> <span class=mi>3600</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;MaxTTL&#34;</span><span class=p>:</span> <span class=mi>86400</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=cdn-캐싱을-위한-api-설계-고려사항>CDN 캐싱을 위한 API 설계 고려사항<a hidden class=anchor aria-hidden=true href=#cdn-캐싱을-위한-api-설계-고려사항>#</a></h5><ul><li><strong>URL 구조</strong>: 캐시 키로 사용되는 URL 매개변수 최적화</li><li><strong>캐싱 가능한 응답 분리</strong>: 개인화된 콘텐츠와 공유 가능한 콘텐츠 분리</li><li><strong>버전 관리</strong>: URL 또는 헤더에 버전 정보 포함하여 캐시 무효화 제어</li><li><strong>캐시 태그</strong>: 관련 캐시 항목을 그룹화하여 일괄 무효화 가능</li></ul><h5 id=cdn-캐싱의-장점>CDN 캐싱의 장점<a hidden class=anchor aria-hidden=true href=#cdn-캐싱의-장점>#</a></h5><ul><li>글로벌 사용자를 위한 지연 시간 감소</li><li>원본 서버 부하 크게 감소</li><li>DDoS 공격 완화 및 추가 보안 레이어 제공</li><li>대규모 트래픽 처리에 효과적</li></ul><h5 id=cdn-캐싱의-단점>CDN 캐싱의 단점<a hidden class=anchor aria-hidden=true href=#cdn-캐싱의-단점>#</a></h5><ul><li>동적이거나 개인화된 콘텐츠에는 적합하지 않을 수 있음</li><li>캐시 무효화 지연 가능성</li><li>구성 및 모니터링의 복잡성</li><li>추가 비용 발생</li></ul><h4 id=api-게이트웨이-캐싱>API 게이트웨이 캐싱<a hidden class=anchor aria-hidden=true href=#api-게이트웨이-캐싱>#</a></h4><p>API 게이트웨이는 API 요청을 라우팅하고 관리하는 중간 계층으로, 자체적인 캐싱 기능을 제공한다. 이는 백엔드 서비스의 부하를 줄이고 응답 시간을 개선하는 데 도움이 된다.</p><h5 id=주요-api-게이트웨이-캐싱-기능>주요 API 게이트웨이 캐싱 기능<a hidden class=anchor aria-hidden=true href=#주요-api-게이트웨이-캐싱-기능>#</a></h5><ul><li><strong>응답 캐싱</strong>: 특정 API 경로/메서드의 응답 캐싱</li><li><strong>캐시 키 관리</strong>: URL 경로, 쿼리 매개변수, 헤더 등을 기반으로 캐시 키 구성</li><li><strong>TTL 관리</strong>: 엔드포인트별 캐시 만료 시간 설정</li><li><strong>캐시 무효화</strong>: 특정 캐시 항목을 수동으로 무효화</li><li><strong>조건부 캐싱</strong>: 특정 조건에서만 응답 캐싱</li></ul><p><strong>AWS API Gateway 캐싱 구성 예제:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span><span class=lnt id=hl-11-13><a class=lnlinks href=#hl-11-13>13</a>
</span><span class=lnt id=hl-11-14><a class=lnlinks href=#hl-11-14>14</a>
</span><span class=lnt id=hl-11-15><a class=lnlinks href=#hl-11-15>15</a>
</span><span class=lnt id=hl-11-16><a class=lnlinks href=#hl-11-16>16</a>
</span><span class=lnt id=hl-11-17><a class=lnlinks href=#hl-11-17>17</a>
</span><span class=lnt id=hl-11-18><a class=lnlinks href=#hl-11-18>18</a>
</span><span class=lnt id=hl-11-19><a class=lnlinks href=#hl-11-19>19</a>
</span><span class=lnt id=hl-11-20><a class=lnlinks href=#hl-11-20>20</a>
</span><span class=lnt id=hl-11-21><a class=lnlinks href=#hl-11-21>21</a>
</span><span class=lnt id=hl-11-22><a class=lnlinks href=#hl-11-22>22</a>
</span><span class=lnt id=hl-11-23><a class=lnlinks href=#hl-11-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;stageName&#34;</span><span class=p>:</span> <span class=s2>&#34;prod&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;cacheClusterEnabled&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;cacheClusterSize&#34;</span><span class=p>:</span> <span class=s2>&#34;0.5&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;methodSettings&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;*/*&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;cachingEnabled&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;cacheTtlInSeconds&#34;</span><span class=p>:</span> <span class=mi>300</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;GET/products&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;cachingEnabled&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;cacheTtlInSeconds&#34;</span><span class=p>:</span> <span class=mi>3600</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;GET/products/{id}&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;cachingEnabled&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;cacheTtlInSeconds&#34;</span><span class=p>:</span> <span class=mi>1800</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;cacheKeyParameters&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;method.request.path.id&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;POST/orders&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;cachingEnabled&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Kong API Gateway 캐싱 플러그인 구성 예제:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1>1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2>2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3>3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4>4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5>5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6>6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7>7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8>8</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>plugins</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>proxy-cache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>strategy</span><span class=p>:</span><span class=w> </span><span class=l>memory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>content_type</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>application/json</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cache_ttl</span><span class=p>:</span><span class=w> </span><span class=m>300</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cache_control</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h5 id=api-게이트웨이-캐싱의-장점>API 게이트웨이 캐싱의 장점<a hidden class=anchor aria-hidden=true href=#api-게이트웨이-캐싱의-장점>#</a></h5><ul><li>중앙 집중식 캐싱 관리</li><li>마이크로서비스 아키텍처에 적합</li><li>백엔드 서비스 변경 없이 캐싱 추가 가능</li><li>세밀한 캐싱 정책 제어</li></ul><h5 id=api-게이트웨이-캐싱의-단점>API 게이트웨이 캐싱의 단점<a hidden class=anchor aria-hidden=true href=#api-게이트웨이-캐싱의-단점>#</a></h5><ul><li>추가적인 인프라 구성 요소 도입</li><li>게이트웨이 자체가 병목 지점이 될 가능성</li><li>캐시 일관성 관리 복잡성</li><li>리소스 사용량 및 비용 관리 필요</li></ul><h3 id=고급-api-캐싱-전략-및-패턴>고급 API 캐싱 전략 및 패턴<a hidden class=anchor aria-hidden=true href=#고급-api-캐싱-전략-및-패턴>#</a></h3><p>기본적인 캐싱 전략을 넘어, 더 복잡한 요구사항에 대응하기 위한 고급 캐싱 패턴과 전략:</p><h4 id=계층형-캐싱layered-caching>계층형 캐싱(Layered Caching)<a hidden class=anchor aria-hidden=true href=#계층형-캐싱layered-caching>#</a></h4><p>다양한 수준에서 여러 캐시 계층을 조합하여 성능과 확장성을 최적화하는 전략이다.</p><p><strong>구현 예:</strong></p><ul><li>L1: 애플리케이션 내 인메모리 캐시(가장 빠름, 작은 용량)</li><li>L2: 분산 캐시(Redis/Memcached - 중간 속도, 대용량)</li><li>L3: 데이터베이스 쿼리 캐시</li><li>L4: CDN/엣지 캐싱</li></ul><p><strong>장점:</strong></p><ul><li>각 계층의 강점 활용 가능</li><li>캐시 미스 비용 최소화</li><li>더 높은 캐시 적중률 달성</li><li>시스템 전체의 복원력 향상</li></ul><h4 id=프리디클티브-캐싱predictive-caching>프리디클티브 캐싱(Predictive Caching)<a hidden class=anchor aria-hidden=true href=#프리디클티브-캐싱predictive-caching>#</a></h4><p>사용 패턴과 동향을 분석하여 실제로 요청되기 전에 데이터를 미리 캐싱하는 선제적 접근 방식.</p><p><strong>구현 방법:</strong></p><ul><li>사용자 행동 분석 및 예측 모델 구축</li><li>시간대, 위치, 이전 활동 등을 기반으로 캐싱 전략 조정</li><li>트렌드, 이벤트, 프로모션 등에 따른 캐싱 조정</li></ul><p><strong>예시:</strong></p><ul><li>전자상거래: 인기 제품을 미리 캐싱</li><li>콘텐츠 플랫폼: 트렌딩 콘텐츠 미리 로딩</li><li>위치 기반 서비스: 사용자의 이동 방향 예측하여 관련 데이터 캐싱</li></ul><h4 id=스태일-와일-리밸리데이트stale-while-revalidate>스태일-와일-리밸리데이트(Stale-While-Revalidate)<a hidden class=anchor aria-hidden=true href=#스태일-와일-리밸리데이트stale-while-revalidate>#</a></h4><p>만료된 캐시 콘텐츠를 제공하면서 동시에 백그라운드에서 새로운 데이터로 캐시를 새로고침하는 전략.</p><p><strong>HTTP 구현 예제:</strong></p><pre class=mermaid>Cache-Control: max-age=600, stale-while-revalidate=3600
</pre><p><strong>애플리케이션 로직 구현:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1> 1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2> 2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3> 3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4> 4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5> 5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6> 6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7> 7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8> 8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9> 9</a>
</span><span class=lnt id=hl-14-10><a class=lnlinks href=#hl-14-10>10</a>
</span><span class=lnt id=hl-14-11><a class=lnlinks href=#hl-14-11>11</a>
</span><span class=lnt id=hl-14-12><a class=lnlinks href=#hl-14-12>12</a>
</span><span class=lnt id=hl-14-13><a class=lnlinks href=#hl-14-13>13</a>
</span><span class=lnt id=hl-14-14><a class=lnlinks href=#hl-14-14>14</a>
</span><span class=lnt id=hl-14-15><a class=lnlinks href=#hl-14-15>15</a>
</span><span class=lnt id=hl-14-16><a class=lnlinks href=#hl-14-16>16</a>
</span><span class=lnt id=hl-14-17><a class=lnlinks href=#hl-14-17>17</a>
</span><span class=lnt id=hl-14-18><a class=lnlinks href=#hl-14-18>18</a>
</span><span class=lnt id=hl-14-19><a class=lnlinks href=#hl-14-19>19</a>
</span><span class=lnt id=hl-14-20><a class=lnlinks href=#hl-14-20>20</a>
</span><span class=lnt id=hl-14-21><a class=lnlinks href=#hl-14-21>21</a>
</span><span class=lnt id=hl-14-22><a class=lnlinks href=#hl-14-22>22</a>
</span><span class=lnt id=hl-14-23><a class=lnlinks href=#hl-14-23>23</a>
</span><span class=lnt id=hl-14-24><a class=lnlinks href=#hl-14-24>24</a>
</span><span class=lnt id=hl-14-25><a class=lnlinks href=#hl-14-25>25</a>
</span><span class=lnt id=hl-14-26><a class=lnlinks href=#hl-14-26>26</a>
</span><span class=lnt id=hl-14-27><a class=lnlinks href=#hl-14-27>27</a>
</span><span class=lnt id=hl-14-28><a class=lnlinks href=#hl-14-28>28</a>
</span><span class=lnt id=hl-14-29><a class=lnlinks href=#hl-14-29>29</a>
</span><span class=lnt id=hl-14-30><a class=lnlinks href=#hl-14-30>30</a>
</span><span class=lnt id=hl-14-31><a class=lnlinks href=#hl-14-31>31</a>
</span><span class=lnt id=hl-14-32><a class=lnlinks href=#hl-14-32>32</a>
</span><span class=lnt id=hl-14-33><a class=lnlinks href=#hl-14-33>33</a>
</span><span class=lnt id=hl-14-34><a class=lnlinks href=#hl-14-34>34</a>
</span><span class=lnt id=hl-14-35><a class=lnlinks href=#hl-14-35>35</a>
</span><span class=lnt id=hl-14-36><a class=lnlinks href=#hl-14-36>36</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>getData</span><span class=p>(</span><span class=nx>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>cachedData</span> <span class=o>=</span> <span class=nx>cache</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>isStale</span> <span class=o>=</span> <span class=nx>cachedData</span> <span class=o>&amp;&amp;</span> <span class=nx>cachedData</span><span class=p>.</span><span class=nx>timestamp</span> <span class=o>+</span> <span class=nx>maxAge</span> <span class=o>&lt;</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>cachedData</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 캐시된 데이터가 오래되었다면, 백그라운드에서 새로고침
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>isStale</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nx>refreshingKeys</span><span class=p>.</span><span class=nx>has</span><span class=p>(</span><span class=nx>key</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>refreshingKeys</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// 비동기적으로 데이터 새로고침
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>setTimeout</span><span class=p>(</span><span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=kr>const</span> <span class=nx>freshData</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetchFromSource</span><span class=p>(</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=nx>cache</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>data</span><span class=o>:</span> <span class=nx>freshData</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>timestamp</span><span class=o>:</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>          <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>finally</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>refreshingKeys</span><span class=p>.</span><span class=k>delete</span><span class=p>(</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 오래된 데이터라도 즉시 반환
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=nx>cachedData</span><span class=p>.</span><span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// 캐시에 없으면 소스에서 가져옴
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>freshData</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetchFromSource</span><span class=p>(</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>cache</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span><span class=o>:</span> <span class=nx>freshData</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>timestamp</span><span class=o>:</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>freshData</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>장점:</strong></p><ul><li>일관되게 빠른 응답 시간 제공</li><li>캐시 새로고침으로 인한 지연 시간 없음</li><li>백엔드 부하의 일정한 분배</li><li>일시적인 백엔드 장애에 대한 복원력</li></ul><p><strong>단점:</strong></p><ul><li>구현 복잡성 증가</li><li>일시적으로 오래된 데이터 제공</li><li>메모리 및 연결 리소스 추가 사용</li></ul><h4 id=캐시-스탬핑-헤드cache-stampedethundering-herd-방지>캐시 스탬핑 헤드(Cache Stampede/Thundering Herd) 방지<a hidden class=anchor aria-hidden=true href=#캐시-스탬핑-헤드cache-stampedethundering-herd-방지>#</a></h4><p>동시에 많은 요청이 캐시 미스를 경험할 때 백엔드 시스템에 갑작스러운 부하가 발생하는 현상을 방지하는 전략.</p><p><strong>구현 방법:</strong></p><ol><li><p><strong>잠금 메커니즘</strong>: 첫 번째 요청만 실제 데이터를 가져오고 나머지는 대기</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1> 1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2> 2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3> 3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4> 4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5> 5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6> 6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7> 7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8> 8</a>
</span><span class=lnt id=hl-15-9><a class=lnlinks href=#hl-15-9> 9</a>
</span><span class=lnt id=hl-15-10><a class=lnlinks href=#hl-15-10>10</a>
</span><span class=lnt id=hl-15-11><a class=lnlinks href=#hl-15-11>11</a>
</span><span class=lnt id=hl-15-12><a class=lnlinks href=#hl-15-12>12</a>
</span><span class=lnt id=hl-15-13><a class=lnlinks href=#hl-15-13>13</a>
</span><span class=lnt id=hl-15-14><a class=lnlinks href=#hl-15-14>14</a>
</span><span class=lnt id=hl-15-15><a class=lnlinks href=#hl-15-15>15</a>
</span><span class=lnt id=hl-15-16><a class=lnlinks href=#hl-15-16>16</a>
</span><span class=lnt id=hl-15-17><a class=lnlinks href=#hl-15-17>17</a>
</span><span class=lnt id=hl-15-18><a class=lnlinks href=#hl-15-18>18</a>
</span><span class=lnt id=hl-15-19><a class=lnlinks href=#hl-15-19>19</a>
</span><span class=lnt id=hl-15-20><a class=lnlinks href=#hl-15-20>20</a>
</span><span class=lnt id=hl-15-21><a class=lnlinks href=#hl-15-21>21</a>
</span><span class=lnt id=hl-15-22><a class=lnlinks href=#hl-15-22>22</a>
</span><span class=lnt id=hl-15-23><a class=lnlinks href=#hl-15-23>23</a>
</span><span class=lnt id=hl-15-24><a class=lnlinks href=#hl-15-24>24</a>
</span><span class=lnt id=hl-15-25><a class=lnlinks href=#hl-15-25>25</a>
</span><span class=lnt id=hl-15-26><a class=lnlinks href=#hl-15-26>26</a>
</span><span class=lnt id=hl-15-27><a class=lnlinks href=#hl-15-27>27</a>
</span><span class=lnt id=hl-15-28><a class=lnlinks href=#hl-15-28>28</a>
</span><span class=lnt id=hl-15-29><a class=lnlinks href=#hl-15-29>29</a>
</span><span class=lnt id=hl-15-30><a class=lnlinks href=#hl-15-30>30</a>
</span><span class=lnt id=hl-15-31><a class=lnlinks href=#hl-15-31>31</a>
</span><span class=lnt id=hl-15-32><a class=lnlinks href=#hl-15-32>32</a>
</span><span class=lnt id=hl-15-33><a class=lnlinks href=#hl-15-33>33</a>
</span><span class=lnt id=hl-15-34><a class=lnlinks href=#hl-15-34>34</a>
</span><span class=lnt id=hl-15-35><a class=lnlinks href=#hl-15-35>35</a>
</span><span class=lnt id=hl-15-36><a class=lnlinks href=#hl-15-36>36</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>locks</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Map</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>getDataWithLock</span><span class=p>(</span><span class=nx>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>cachedData</span> <span class=o>=</span> <span class=nx>cache</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>cachedData</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>cachedData</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 이미 진행 중인 요청이 있는지 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>locks</span><span class=p>.</span><span class=nx>has</span><span class=p>(</span><span class=nx>key</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 다른 요청이 데이터를 가져오는 동안 대기
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>(</span><span class=nx>resolve</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>checkInterval</span> <span class=o>=</span> <span class=nx>setInterval</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>cache</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>data</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>clearInterval</span><span class=p>(</span><span class=nx>checkInterval</span><span class=p>);</span>
</span></span><span class=line><span class=cl>          <span class=nx>resolve</span><span class=p>(</span><span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span> <span class=mi>50</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 잠금 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>locks</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span> <span class=kc>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 소스에서 데이터 가져오기
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetchFromSource</span><span class=p>(</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>cache</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span> <span class=nx>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>finally</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 잠금 해제
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>locks</span><span class=p>.</span><span class=k>delete</span><span class=p>(</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>프로배빌리스틱 조기 만료(Probabilistic Early Expiration)</strong>: 캐시 항목의 실제 만료 전에 일부 요청만 새로고침 허용</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11>11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12>12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13>13</a>
</span><span class=lnt id=hl-16-14><a class=lnlinks href=#hl-16-14>14</a>
</span><span class=lnt id=hl-16-15><a class=lnlinks href=#hl-16-15>15</a>
</span><span class=lnt id=hl-16-16><a class=lnlinks href=#hl-16-16>16</a>
</span><span class=lnt id=hl-16-17><a class=lnlinks href=#hl-16-17>17</a>
</span><span class=lnt id=hl-16-18><a class=lnlinks href=#hl-16-18>18</a>
</span><span class=lnt id=hl-16-19><a class=lnlinks href=#hl-16-19>19</a>
</span><span class=lnt id=hl-16-20><a class=lnlinks href=#hl-16-20>20</a>
</span><span class=lnt id=hl-16-21><a class=lnlinks href=#hl-16-21>21</a>
</span><span class=lnt id=hl-16-22><a class=lnlinks href=#hl-16-22>22</a>
</span><span class=lnt id=hl-16-23><a class=lnlinks href=#hl-16-23>23</a>
</span><span class=lnt id=hl-16-24><a class=lnlinks href=#hl-16-24>24</a>
</span><span class=lnt id=hl-16-25><a class=lnlinks href=#hl-16-25>25</a>
</span><span class=lnt id=hl-16-26><a class=lnlinks href=#hl-16-26>26</a>
</span><span class=lnt id=hl-16-27><a class=lnlinks href=#hl-16-27>27</a>
</span><span class=lnt id=hl-16-28><a class=lnlinks href=#hl-16-28>28</a>
</span><span class=lnt id=hl-16-29><a class=lnlinks href=#hl-16-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>shouldRefreshCache</span><span class=p>(</span><span class=nx>ttl</span><span class=p>,</span> <span class=nx>maxAge</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>elapsed</span> <span class=o>=</span> <span class=nx>maxAge</span> <span class=o>-</span> <span class=nx>ttl</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>probability</span> <span class=o>=</span> <span class=nx>elapsed</span> <span class=o>/</span> <span class=nx>maxAge</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>()</span> <span class=o>&lt;=</span> <span class=nx>probability</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>getData</span><span class=p>(</span><span class=nx>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>cachedItem</span> <span class=o>=</span> <span class=nx>cache</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>cachedItem</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>ttl</span> <span class=o>=</span> <span class=nx>cachedItem</span><span class=p>.</span><span class=nx>expiry</span> <span class=o>-</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 아직 만료되지 않았지만 확률적으로 새로고침 결정
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>ttl</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nx>shouldRefreshCache</span><span class=p>(</span><span class=nx>ttl</span><span class=p>,</span> <span class=nx>MAX_AGE</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>cachedItem</span><span class=p>.</span><span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 캐시 미스 또는 새로고침 필요
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetchFromSource</span><span class=p>(</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>cache</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>expiry</span><span class=o>:</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>+</span> <span class=nx>MAX_AGE</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>배경 새로고침(Background Refresh)</strong>: 만료 시간에 가까워지면 백그라운드에서 주기적으로 캐시 미리 새로고침</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1> 1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2> 2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3> 3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4> 4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5> 5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6> 6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7> 7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8> 8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9> 9</a>
</span><span class=lnt id=hl-17-10><a class=lnlinks href=#hl-17-10>10</a>
</span><span class=lnt id=hl-17-11><a class=lnlinks href=#hl-17-11>11</a>
</span><span class=lnt id=hl-17-12><a class=lnlinks href=#hl-17-12>12</a>
</span><span class=lnt id=hl-17-13><a class=lnlinks href=#hl-17-13>13</a>
</span><span class=lnt id=hl-17-14><a class=lnlinks href=#hl-17-14>14</a>
</span><span class=lnt id=hl-17-15><a class=lnlinks href=#hl-17-15>15</a>
</span><span class=lnt id=hl-17-16><a class=lnlinks href=#hl-17-16>16</a>
</span><span class=lnt id=hl-17-17><a class=lnlinks href=#hl-17-17>17</a>
</span><span class=lnt id=hl-17-18><a class=lnlinks href=#hl-17-18>18</a>
</span><span class=lnt id=hl-17-19><a class=lnlinks href=#hl-17-19>19</a>
</span><span class=lnt id=hl-17-20><a class=lnlinks href=#hl-17-20>20</a>
</span><span class=lnt id=hl-17-21><a class=lnlinks href=#hl-17-21>21</a>
</span><span class=lnt id=hl-17-22><a class=lnlinks href=#hl-17-22>22</a>
</span><span class=lnt id=hl-17-23><a class=lnlinks href=#hl-17-23>23</a>
</span><span class=lnt id=hl-17-24><a class=lnlinks href=#hl-17-24>24</a>
</span><span class=lnt id=hl-17-25><a class=lnlinks href=#hl-17-25>25</a>
</span><span class=lnt id=hl-17-26><a class=lnlinks href=#hl-17-26>26</a>
</span><span class=lnt id=hl-17-27><a class=lnlinks href=#hl-17-27>27</a>
</span><span class=lnt id=hl-17-28><a class=lnlinks href=#hl-17-28>28</a>
</span><span class=lnt id=hl-17-29><a class=lnlinks href=#hl-17-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 캐시 새로고침 작업을 스케줄링하는 시스템
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>refreshScheduler</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>tasks</span><span class=o>:</span> <span class=k>new</span> <span class=nx>Map</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>schedule</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span> <span class=nx>ttl</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 이미 예약된 작업이 있다면 취소
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>tasks</span><span class=p>.</span><span class=nx>has</span><span class=p>(</span><span class=nx>key</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>clearTimeout</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=nx>tasks</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>key</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 만료 10초 전에 새로고침 작업 예약
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>refreshTime</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>max</span><span class=p>(</span><span class=nx>ttl</span> <span class=o>-</span> <span class=mi>10000</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>taskId</span> <span class=o>=</span> <span class=nx>setTimeout</span><span class=p>(</span><span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>freshData</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetchFromSource</span><span class=p>(</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=nx>cache</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>data</span><span class=o>:</span> <span class=nx>freshData</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>expiry</span><span class=o>:</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>+</span> <span class=nx>MAX_AGE</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 새 만료 시간으로 다시 스케줄링
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>this</span><span class=p>.</span><span class=nx>schedule</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span> <span class=nx>MAX_AGE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=sb>`Background refresh failed for </span><span class=si>${</span><span class=nx>key</span><span class=si>}</span><span class=sb>:`</span><span class=p>,</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span> <span class=nx>refreshTime</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>tasks</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span> <span class=nx>taskId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><p><strong>장점:</strong></p><ul><li>백엔드 시스템 보호</li><li>부하 피크 방지 및 평활화</li><li>일관된 응답 시간 유지</li><li>시스템 안정성 향상</li></ul><h4 id=컨텍스트-인식-캐싱context-aware-caching>컨텍스트 인식 캐싱(Context-Aware Caching)<a hidden class=anchor aria-hidden=true href=#컨텍스트-인식-캐싱context-aware-caching>#</a></h4><p>사용자 컨텍스트(위치, 기기, 사용자 세그먼트 등)에 따라 캐싱 전략을 동적으로 조정하는 고급 접근법.</p><p><strong>구현 고려사항:</strong></p><ol><li><p><strong>캐시 키 전략</strong>: 컨텍스트 정보를 캐시 키에 통합</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1> 1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2> 2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3> 3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4> 4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5> 5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6> 6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7> 7</a>
</span><span class=lnt id=hl-18-8><a class=lnlinks href=#hl-18-8> 8</a>
</span><span class=lnt id=hl-18-9><a class=lnlinks href=#hl-18-9> 9</a>
</span><span class=lnt id=hl-18-10><a class=lnlinks href=#hl-18-10>10</a>
</span><span class=lnt id=hl-18-11><a class=lnlinks href=#hl-18-11>11</a>
</span><span class=lnt id=hl-18-12><a class=lnlinks href=#hl-18-12>12</a>
</span><span class=lnt id=hl-18-13><a class=lnlinks href=#hl-18-13>13</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>generateCacheKey</span><span class=p>(</span><span class=nx>baseKey</span><span class=p>,</span> <span class=nx>context</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 필요한 컨텍스트 요소만 선택
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>relevantContext</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>country</span><span class=o>:</span> <span class=nx>context</span><span class=p>.</span><span class=nx>country</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>userType</span><span class=o>:</span> <span class=nx>context</span><span class=p>.</span><span class=nx>userType</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>device</span><span class=o>:</span> <span class=nx>context</span><span class=p>.</span><span class=nx>deviceCategory</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 컨텍스트를 정렬된 문자열로 변환하여 일관성 유지
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>contextString</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>relevantContext</span><span class=p>,</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>keys</span><span class=p>(</span><span class=nx>relevantContext</span><span class=p>).</span><span class=nx>sort</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=sb>`</span><span class=si>${</span><span class=nx>baseKey</span><span class=si>}</span><span class=sb>:</span><span class=si>${</span><span class=nx>hash</span><span class=p>(</span><span class=nx>contextString</span><span class=p>)</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>변형 관리(Variant Management)</strong>: 동일한 리소스의 다양한 컨텍스트별 변형 관리</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12>12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13>13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14>14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15>15</a>
</span><span class=lnt id=hl-19-16><a class=lnlinks href=#hl-19-16>16</a>
</span><span class=lnt id=hl-19-17><a class=lnlinks href=#hl-19-17>17</a>
</span><span class=lnt id=hl-19-18><a class=lnlinks href=#hl-19-18>18</a>
</span><span class=lnt id=hl-19-19><a class=lnlinks href=#hl-19-19>19</a>
</span><span class=lnt id=hl-19-20><a class=lnlinks href=#hl-19-20>20</a>
</span><span class=lnt id=hl-19-21><a class=lnlinks href=#hl-19-21>21</a>
</span><span class=lnt id=hl-19-22><a class=lnlinks href=#hl-19-22>22</a>
</span><span class=lnt id=hl-19-23><a class=lnlinks href=#hl-19-23>23</a>
</span><span class=lnt id=hl-19-24><a class=lnlinks href=#hl-19-24>24</a>
</span><span class=lnt id=hl-19-25><a class=lnlinks href=#hl-19-25>25</a>
</span><span class=lnt id=hl-19-26><a class=lnlinks href=#hl-19-26>26</a>
</span><span class=lnt id=hl-19-27><a class=lnlinks href=#hl-19-27>27</a>
</span><span class=lnt id=hl-19-28><a class=lnlinks href=#hl-19-28>28</a>
</span><span class=lnt id=hl-19-29><a class=lnlinks href=#hl-19-29>29</a>
</span><span class=lnt id=hl-19-30><a class=lnlinks href=#hl-19-30>30</a>
</span><span class=lnt id=hl-19-31><a class=lnlinks href=#hl-19-31>31</a>
</span><span class=lnt id=hl-19-32><a class=lnlinks href=#hl-19-32>32</a>
</span><span class=lnt id=hl-19-33><a class=lnlinks href=#hl-19-33>33</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>getProductDetails</span><span class=p>(</span><span class=nx>productId</span><span class=p>,</span> <span class=nx>userContext</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 베이스 키와 컨텍스트 기반 키 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>baseKey</span> <span class=o>=</span> <span class=sb>`product:</span><span class=si>${</span><span class=nx>productId</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>contextKey</span> <span class=o>=</span> <span class=nx>generateCacheKey</span><span class=p>(</span><span class=nx>baseKey</span><span class=p>,</span> <span class=nx>userContext</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 먼저 컨텍스트별 캐시 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>let</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>cache</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>contextKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>data</span><span class=p>)</span> <span class=k>return</span> <span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 컨텍스트별 캐시 미스 시 기본 캐시 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>data</span> <span class=o>=</span> <span class=nx>cache</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>baseKey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>data</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 기본 데이터를 컨텍스트에 맞게 변환
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>contextualizedData</span> <span class=o>=</span> <span class=nx>contextualizeData</span><span class=p>(</span><span class=nx>data</span><span class=p>,</span> <span class=nx>userContext</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 컨텍스트별 캐시에 저장
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>cache</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>contextKey</span><span class=p>,</span> <span class=nx>contextualizedData</span><span class=p>,</span> <span class=nx>CONTEXT_TTL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>contextualizedData</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 모든 캐시 미스 시 원본에서 가져오기
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetchProductFromSource</span><span class=p>(</span><span class=nx>productId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 기본 캐시 저장
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>cache</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>baseKey</span><span class=p>,</span> <span class=nx>data</span><span class=p>,</span> <span class=nx>BASE_TTL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 컨텍스트화 및 컨텍스트별 캐시 저장
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>contextualizedData</span> <span class=o>=</span> <span class=nx>contextualizeData</span><span class=p>(</span><span class=nx>data</span><span class=p>,</span> <span class=nx>userContext</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>cache</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>contextKey</span><span class=p>,</span> <span class=nx>contextualizedData</span><span class=p>,</span> <span class=nx>CONTEXT_TTL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>contextualizedData</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>적응형 TTL</strong>: 컨텍스트, 데이터 유형, 사용 패턴에 따라 캐시 만료 시간 동적 조정</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1> 1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2> 2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3> 3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4> 4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5> 5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6> 6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7> 7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8> 8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9> 9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10>10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11>11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12>12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13>13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14>14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15>15</a>
</span><span class=lnt id=hl-20-16><a class=lnlinks href=#hl-20-16>16</a>
</span><span class=lnt id=hl-20-17><a class=lnlinks href=#hl-20-17>17</a>
</span><span class=lnt id=hl-20-18><a class=lnlinks href=#hl-20-18>18</a>
</span><span class=lnt id=hl-20-19><a class=lnlinks href=#hl-20-19>19</a>
</span><span class=lnt id=hl-20-20><a class=lnlinks href=#hl-20-20>20</a>
</span><span class=lnt id=hl-20-21><a class=lnlinks href=#hl-20-21>21</a>
</span><span class=lnt id=hl-20-22><a class=lnlinks href=#hl-20-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>determineTTL</span><span class=p>(</span><span class=nx>resourceType</span><span class=p>,</span> <span class=nx>context</span><span class=p>,</span> <span class=nx>usagePattern</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>baseTTL</span> <span class=o>=</span> <span class=nx>DEFAULT_TTL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 리소스 유형별 기본 TTL 조정
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>switch</span> <span class=p>(</span><span class=nx>resourceType</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s1>&#39;product&#39;</span><span class=o>:</span> <span class=nx>baseTTL</span> <span class=o>=</span> <span class=mi>3600</span><span class=p>;</span> <span class=k>break</span><span class=p>;</span> <span class=c1>// 1시간
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>case</span> <span class=s1>&#39;category&#39;</span><span class=o>:</span> <span class=nx>baseTTL</span> <span class=o>=</span> <span class=mi>7200</span><span class=p>;</span> <span class=k>break</span><span class=p>;</span> <span class=c1>// 2시간
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>case</span> <span class=s1>&#39;userProfile&#39;</span><span class=o>:</span> <span class=nx>baseTTL</span> <span class=o>=</span> <span class=mi>300</span><span class=p>;</span> <span class=k>break</span><span class=p>;</span> <span class=c1>// 5분
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 지역별 조정
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nx>country</span> <span class=o>===</span> <span class=s1>&#39;US&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>baseTTL</span> <span class=o>*=</span> <span class=mf>0.8</span><span class=p>;</span> <span class=c1>// 미국은 데이터 변화가 빠르므로 TTL 감소
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 사용 패턴별 조정
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>usagePattern</span> <span class=o>===</span> <span class=s1>&#39;highFrequency&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>baseTTL</span> <span class=o>*=</span> <span class=mf>1.5</span><span class=p>;</span> <span class=c1>// 자주 접근되는 데이터는 더 오래 캐싱
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>floor</span><span class=p>(</span><span class=nx>baseTTL</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><p><strong>장점:</strong></p><ul><li>사용자 경험 개인화와 캐싱 효율성 균형</li><li>컨텍스트 관련성 높은 결과 제공</li><li>캐시 저장 공간 더 효율적 활용</li><li>다양한 사용자 세그먼트 요구 충족</li></ul><p><strong>단점:</strong></p><ul><li>캐시 키 폭발 가능성</li><li>캐시 적중률 감소 가능성</li><li>구현 및 유지 복잡성 증가</li></ul><h4 id=에지-컴퓨팅-기반-캐싱edge-computing-based-caching>에지 컴퓨팅 기반 캐싱(Edge Computing-Based Caching)<a hidden class=anchor aria-hidden=true href=#에지-컴퓨팅-기반-캐싱edge-computing-based-caching>#</a></h4><p>콘텐츠를 사용자에게 가까운 에지 위치에서 캐싱 및 처리하여 지연 시간을 최소화하는 전략.</p><p><strong>주요 에지 캐싱 패턴:</strong></p><ol><li><p><strong>정적 에지 캐싱</strong>: 변경이 적은 데이터를 에지에 장기간 캐싱</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1> 1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2> 2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3> 3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4> 4</a>
</span><span class=lnt id=hl-21-5><a class=lnlinks href=#hl-21-5> 5</a>
</span><span class=lnt id=hl-21-6><a class=lnlinks href=#hl-21-6> 6</a>
</span><span class=lnt id=hl-21-7><a class=lnlinks href=#hl-21-7> 7</a>
</span><span class=lnt id=hl-21-8><a class=lnlinks href=#hl-21-8> 8</a>
</span><span class=lnt id=hl-21-9><a class=lnlinks href=#hl-21-9> 9</a>
</span><span class=lnt id=hl-21-10><a class=lnlinks href=#hl-21-10>10</a>
</span><span class=lnt id=hl-21-11><a class=lnlinks href=#hl-21-11>11</a>
</span><span class=lnt id=hl-21-12><a class=lnlinks href=#hl-21-12>12</a>
</span><span class=lnt id=hl-21-13><a class=lnlinks href=#hl-21-13>13</a>
</span><span class=lnt id=hl-21-14><a class=lnlinks href=#hl-21-14>14</a>
</span><span class=lnt id=hl-21-15><a class=lnlinks href=#hl-21-15>15</a>
</span><span class=lnt id=hl-21-16><a class=lnlinks href=#hl-21-16>16</a>
</span><span class=lnt id=hl-21-17><a class=lnlinks href=#hl-21-17>17</a>
</span><span class=lnt id=hl-21-18><a class=lnlinks href=#hl-21-18>18</a>
</span><span class=lnt id=hl-21-19><a class=lnlinks href=#hl-21-19>19</a>
</span><span class=lnt id=hl-21-20><a class=lnlinks href=#hl-21-20>20</a>
</span><span class=lnt id=hl-21-21><a class=lnlinks href=#hl-21-21>21</a>
</span><span class=lnt id=hl-21-22><a class=lnlinks href=#hl-21-22>22</a>
</span><span class=lnt id=hl-21-23><a class=lnlinks href=#hl-21-23>23</a>
</span><span class=lnt id=hl-21-24><a class=lnlinks href=#hl-21-24>24</a>
</span><span class=lnt id=hl-21-25><a class=lnlinks href=#hl-21-25>25</a>
</span><span class=lnt id=hl-21-26><a class=lnlinks href=#hl-21-26>26</a>
</span><span class=lnt id=hl-21-27><a class=lnlinks href=#hl-21-27>27</a>
</span><span class=lnt id=hl-21-28><a class=lnlinks href=#hl-21-28>28</a>
</span><span class=lnt id=hl-21-29><a class=lnlinks href=#hl-21-29>29</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Cloudflare Workers 예제
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;fetch&#39;</span><span class=p>,</span> <span class=nx>event</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>event</span><span class=p>.</span><span class=nx>respondWith</span><span class=p>(</span><span class=nx>handleRequest</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>request</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>handleRequest</span><span class=p>(</span><span class=nx>request</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>cacheKey</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URL</span><span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 캐시 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>cache</span> <span class=o>=</span> <span class=nx>caches</span><span class=p>.</span><span class=k>default</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>cache</span><span class=p>.</span><span class=nx>match</span><span class=p>(</span><span class=nx>request</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>response</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 원본 서버에서 가져오기
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>request</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 성공적인 GET 요청만 캐싱
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>method</span> <span class=o>===</span> <span class=s1>&#39;GET&#39;</span> <span class=o>&amp;&amp;</span> <span class=nx>response</span><span class=p>.</span><span class=nx>status</span> <span class=o>===</span> <span class=mi>200</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 에지에 1시간 동안 캐싱
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kr>const</span> <span class=nx>newResponse</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=nx>response</span><span class=p>.</span><span class=nx>body</span><span class=p>,</span> <span class=nx>response</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>newResponse</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=s1>&#39;Cache-Control&#39;</span><span class=p>,</span> <span class=s1>&#39;public, max-age=3600&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>event</span><span class=p>.</span><span class=nx>waitUntil</span><span class=p>(</span><span class=nx>cache</span><span class=p>.</span><span class=nx>put</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span> <span class=nx>newResponse</span><span class=p>.</span><span class=nx>clone</span><span class=p>()));</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>newResponse</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>response</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>동적 에지 생성(Dynamic Edge Generation)</strong>: 에지에서 부분적 콘텐츠 생성 및 변환</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-22-1><a class=lnlinks href=#hl-22-1> 1</a>
</span><span class=lnt id=hl-22-2><a class=lnlinks href=#hl-22-2> 2</a>
</span><span class=lnt id=hl-22-3><a class=lnlinks href=#hl-22-3> 3</a>
</span><span class=lnt id=hl-22-4><a class=lnlinks href=#hl-22-4> 4</a>
</span><span class=lnt id=hl-22-5><a class=lnlinks href=#hl-22-5> 5</a>
</span><span class=lnt id=hl-22-6><a class=lnlinks href=#hl-22-6> 6</a>
</span><span class=lnt id=hl-22-7><a class=lnlinks href=#hl-22-7> 7</a>
</span><span class=lnt id=hl-22-8><a class=lnlinks href=#hl-22-8> 8</a>
</span><span class=lnt id=hl-22-9><a class=lnlinks href=#hl-22-9> 9</a>
</span><span class=lnt id=hl-22-10><a class=lnlinks href=#hl-22-10>10</a>
</span><span class=lnt id=hl-22-11><a class=lnlinks href=#hl-22-11>11</a>
</span><span class=lnt id=hl-22-12><a class=lnlinks href=#hl-22-12>12</a>
</span><span class=lnt id=hl-22-13><a class=lnlinks href=#hl-22-13>13</a>
</span><span class=lnt id=hl-22-14><a class=lnlinks href=#hl-22-14>14</a>
</span><span class=lnt id=hl-22-15><a class=lnlinks href=#hl-22-15>15</a>
</span><span class=lnt id=hl-22-16><a class=lnlinks href=#hl-22-16>16</a>
</span><span class=lnt id=hl-22-17><a class=lnlinks href=#hl-22-17>17</a>
</span><span class=lnt id=hl-22-18><a class=lnlinks href=#hl-22-18>18</a>
</span><span class=lnt id=hl-22-19><a class=lnlinks href=#hl-22-19>19</a>
</span><span class=lnt id=hl-22-20><a class=lnlinks href=#hl-22-20>20</a>
</span><span class=lnt id=hl-22-21><a class=lnlinks href=#hl-22-21>21</a>
</span><span class=lnt id=hl-22-22><a class=lnlinks href=#hl-22-22>22</a>
</span><span class=lnt id=hl-22-23><a class=lnlinks href=#hl-22-23>23</a>
</span><span class=lnt id=hl-22-24><a class=lnlinks href=#hl-22-24>24</a>
</span><span class=lnt id=hl-22-25><a class=lnlinks href=#hl-22-25>25</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Cloudflare Workers 예제 - 데이터 변환
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>handleRequest</span><span class=p>(</span><span class=nx>request</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 원본 API에서 데이터 가져오기
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>apiResponse</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;https://api.example.com/data&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>apiResponse</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 에지에서 데이터 필터링 및 변환
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>transformedData</span> <span class=o>=</span> <span class=nx>transformAtEdge</span><span class=p>(</span><span class=nx>data</span><span class=p>,</span> <span class=nx>getRegionFromRequest</span><span class=p>(</span><span class=nx>request</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 변환된 결과 반환
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>transformedData</span><span class=p>),</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/json&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;Cache-Control&#39;</span><span class=o>:</span> <span class=s1>&#39;public, max-age=60&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>transformAtEdge</span><span class=p>(</span><span class=nx>data</span><span class=p>,</span> <span class=nx>region</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 지역에 따라 데이터 필터링 및 정렬
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=nx>data</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>filter</span><span class=p>(</span><span class=nx>item</span> <span class=p>=&gt;</span> <span class=nx>item</span><span class=p>.</span><span class=nx>availableRegions</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=nx>region</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>sort</span><span class=p>((</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>b</span><span class=p>.</span><span class=nx>relevanceScore</span> <span class=o>-</span> <span class=nx>a</span><span class=p>.</span><span class=nx>relevanceScore</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>20</span><span class=p>);</span> <span class=c1>// 상위 20개 항목만 유지
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>근접성 기반 라우팅(Proximity-Based Routing)</strong>: 사용자와 가장 가까운 에지 또는 원본 서버로 요청 라우팅</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-23-1><a class=lnlinks href=#hl-23-1> 1</a>
</span><span class=lnt id=hl-23-2><a class=lnlinks href=#hl-23-2> 2</a>
</span><span class=lnt id=hl-23-3><a class=lnlinks href=#hl-23-3> 3</a>
</span><span class=lnt id=hl-23-4><a class=lnlinks href=#hl-23-4> 4</a>
</span><span class=lnt id=hl-23-5><a class=lnlinks href=#hl-23-5> 5</a>
</span><span class=lnt id=hl-23-6><a class=lnlinks href=#hl-23-6> 6</a>
</span><span class=lnt id=hl-23-7><a class=lnlinks href=#hl-23-7> 7</a>
</span><span class=lnt id=hl-23-8><a class=lnlinks href=#hl-23-8> 8</a>
</span><span class=lnt id=hl-23-9><a class=lnlinks href=#hl-23-9> 9</a>
</span><span class=lnt id=hl-23-10><a class=lnlinks href=#hl-23-10>10</a>
</span><span class=lnt id=hl-23-11><a class=lnlinks href=#hl-23-11>11</a>
</span><span class=lnt id=hl-23-12><a class=lnlinks href=#hl-23-12>12</a>
</span><span class=lnt id=hl-23-13><a class=lnlinks href=#hl-23-13>13</a>
</span><span class=lnt id=hl-23-14><a class=lnlinks href=#hl-23-14>14</a>
</span><span class=lnt id=hl-23-15><a class=lnlinks href=#hl-23-15>15</a>
</span><span class=lnt id=hl-23-16><a class=lnlinks href=#hl-23-16>16</a>
</span><span class=lnt id=hl-23-17><a class=lnlinks href=#hl-23-17>17</a>
</span><span class=lnt id=hl-23-18><a class=lnlinks href=#hl-23-18>18</a>
</span><span class=lnt id=hl-23-19><a class=lnlinks href=#hl-23-19>19</a>
</span><span class=lnt id=hl-23-20><a class=lnlinks href=#hl-23-20>20</a>
</span><span class=lnt id=hl-23-21><a class=lnlinks href=#hl-23-21>21</a>
</span><span class=lnt id=hl-23-22><a class=lnlinks href=#hl-23-22>22</a>
</span><span class=lnt id=hl-23-23><a class=lnlinks href=#hl-23-23>23</a>
</span><span class=lnt id=hl-23-24><a class=lnlinks href=#hl-23-24>24</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>handleRequest</span><span class=p>(</span><span class=nx>request</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>userLocation</span> <span class=o>=</span> <span class=nx>request</span><span class=p>.</span><span class=nx>cf</span><span class=p>.</span><span class=nx>country</span> <span class=o>||</span> <span class=s1>&#39;US&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 사용자 위치에 기반한 최적의 데이터 소스 결정
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>dataSource</span> <span class=o>=</span> <span class=nx>determineOptimalDataSource</span><span class=p>(</span><span class=nx>userLocation</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 데이터 소스에서 데이터 가져오기
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=nx>fetch</span><span class=p>(</span><span class=sb>`https://</span><span class=si>${</span><span class=nx>dataSource</span><span class=si>}</span><span class=sb>/api/data`</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>headers</span><span class=o>:</span> <span class=nx>request</span><span class=p>.</span><span class=nx>headers</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>determineOptimalDataSource</span><span class=p>(</span><span class=nx>location</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>regionMap</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;US&#39;</span><span class=o>:</span> <span class=s1>&#39;us-east.api.example.com&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;CA&#39;</span><span class=o>:</span> <span class=s1>&#39;us-east.api.example.com&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;GB&#39;</span><span class=o>:</span> <span class=s1>&#39;eu-west.api.example.com&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;DE&#39;</span><span class=o>:</span> <span class=s1>&#39;eu-central.api.example.com&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;JP&#39;</span><span class=o>:</span> <span class=s1>&#39;ap-northeast.api.example.com&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;AU&#39;</span><span class=o>:</span> <span class=s1>&#39;ap-southeast.api.example.com&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>regionMap</span><span class=p>[</span><span class=nx>location</span><span class=p>]</span> <span class=o>||</span> <span class=s1>&#39;global.api.example.com&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><p><strong>장점:</strong></p><ul><li>매우 낮은 지연 시간</li><li>지역별 최적화 가능</li><li>원본 서버 부하 크게 감소</li><li>네트워크 병목 현상 완화</li></ul><p><strong>단점:</strong></p><ul><li>에지 위치 간 일관성 관리 어려움</li><li>제한된 컴퓨팅 리소스</li><li>복잡한 배포 및 관리</li><li>특화된 도구 및 플랫폼 필요</li></ul><h3 id=api-캐싱을-위한-모범-사례>API 캐싱을 위한 모범 사례<a hidden class=anchor aria-hidden=true href=#api-캐싱을-위한-모범-사례>#</a></h3><p>효과적인 API 캐싱을 위한 핵심 모범 사례와 권장 사항은 다음과 같다:</p><ol><li><p>캐싱 정책 설계</p><ul><li><strong>리소스별 캐싱 전략</strong>: 각 API 엔드포인트의 특성(변경 빈도, 중요도, 접근 패턴)에 맞는 캐싱 정책 설계</li><li><strong>캐시 계층화</strong>: 여러 캐싱 레이어(클라이언트, CDN, API 게이트웨이, 애플리케이션)의 특성을 활용한 전략 구성</li><li><strong>TTL 최적화</strong>: 데이터 특성에 따라 적절한 캐시 수명 설정</li><li><strong>일관된 캐싱 헤더</strong>: 모든 응답에 명확하고 일관된 캐싱 헤더 제공</li></ul></li><li><p>캐시 키 설계</p><ul><li><strong>효과적인 캐시 키 선택</strong>: URL 경로, 쿼리 매개변수, 헤더 등을 고려한 캐시 키 설계</li><li><strong>정규화</strong>: 동일한 리소스에 대한 다양한 URL 형식을 정규화하여 캐시 효율성 향상</li><li><strong>버전 관리</strong>: 캐시 키에 리소스 버전 포함하여 갱신 관리</li><li><strong>컨텍스트 고려</strong>: 필요에 따라 사용자 세그먼트, 디바이스 유형, 위치 등 컨텍스트 정보 포함</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-24-1><a class=lnlinks href=#hl-24-1> 1</a>
</span><span class=lnt id=hl-24-2><a class=lnlinks href=#hl-24-2> 2</a>
</span><span class=lnt id=hl-24-3><a class=lnlinks href=#hl-24-3> 3</a>
</span><span class=lnt id=hl-24-4><a class=lnlinks href=#hl-24-4> 4</a>
</span><span class=lnt id=hl-24-5><a class=lnlinks href=#hl-24-5> 5</a>
</span><span class=lnt id=hl-24-6><a class=lnlinks href=#hl-24-6> 6</a>
</span><span class=lnt id=hl-24-7><a class=lnlinks href=#hl-24-7> 7</a>
</span><span class=lnt id=hl-24-8><a class=lnlinks href=#hl-24-8> 8</a>
</span><span class=lnt id=hl-24-9><a class=lnlinks href=#hl-24-9> 9</a>
</span><span class=lnt id=hl-24-10><a class=lnlinks href=#hl-24-10>10</a>
</span><span class=lnt id=hl-24-11><a class=lnlinks href=#hl-24-11>11</a>
</span><span class=lnt id=hl-24-12><a class=lnlinks href=#hl-24-12>12</a>
</span><span class=lnt id=hl-24-13><a class=lnlinks href=#hl-24-13>13</a>
</span><span class=lnt id=hl-24-14><a class=lnlinks href=#hl-24-14>14</a>
</span><span class=lnt id=hl-24-15><a class=lnlinks href=#hl-24-15>15</a>
</span><span class=lnt id=hl-24-16><a class=lnlinks href=#hl-24-16>16</a>
</span><span class=lnt id=hl-24-17><a class=lnlinks href=#hl-24-17>17</a>
</span><span class=lnt id=hl-24-18><a class=lnlinks href=#hl-24-18>18</a>
</span><span class=lnt id=hl-24-19><a class=lnlinks href=#hl-24-19>19</a>
</span><span class=lnt id=hl-24-20><a class=lnlinks href=#hl-24-20>20</a>
</span><span class=lnt id=hl-24-21><a class=lnlinks href=#hl-24-21>21</a>
</span><span class=lnt id=hl-24-22><a class=lnlinks href=#hl-24-22>22</a>
</span><span class=lnt id=hl-24-23><a class=lnlinks href=#hl-24-23>23</a>
</span><span class=lnt id=hl-24-24><a class=lnlinks href=#hl-24-24>24</a>
</span><span class=lnt id=hl-24-25><a class=lnlinks href=#hl-24-25>25</a>
</span><span class=lnt id=hl-24-26><a class=lnlinks href=#hl-24-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>generateCacheKey</span><span class=p>(</span><span class=nx>request</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 기본 URL 및 경로 정규화
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URL</span><span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>url</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>path</span> <span class=o>=</span> <span class=nx>url</span><span class=p>.</span><span class=nx>pathname</span><span class=p>.</span><span class=nx>toLowerCase</span><span class=p>().</span><span class=nx>replace</span><span class=p>(</span><span class=sr>/\/+$/</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 필수 쿼리 매개변수만 포함 (정렬하여 일관성 유지)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>relevantParams</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>,</span> <span class=s1>&#39;sort&#39;</span><span class=p>,</span> <span class=s1>&#39;limit&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>queryParams</span> <span class=o>=</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>relevantParams</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=nx>param</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>url</span><span class=p>.</span><span class=nx>searchParams</span><span class=p>.</span><span class=nx>has</span><span class=p>(</span><span class=nx>param</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>queryParams</span><span class=p>[</span><span class=nx>param</span><span class=p>]</span> <span class=o>=</span> <span class=nx>url</span><span class=p>.</span><span class=nx>searchParams</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>param</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>queryString</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>URLSearchParams</span><span class=p>(</span><span class=nx>queryParams</span><span class=p>).</span><span class=nx>toString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 관련 헤더 포함 (예: 언어, 국가)
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>language</span> <span class=o>=</span> <span class=nx>request</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;Accept-Language&#39;</span><span class=p>)</span> <span class=o>||</span> <span class=s1>&#39;en&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>country</span> <span class=o>=</span> <span class=nx>request</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;CF-IPCountry&#39;</span><span class=p>)</span> <span class=o>||</span> <span class=s1>&#39;US&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// API 버전 고려
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>apiVersion</span> <span class=o>=</span> <span class=nx>request</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;API-Version&#39;</span><span class=p>)</span> <span class=o>||</span> <span class=s1>&#39;v1&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=sb>`</span><span class=si>${</span><span class=nx>apiVersion</span><span class=si>}</span><span class=sb>:</span><span class=si>${</span><span class=nx>path</span><span class=si>}</span><span class=sb>:</span><span class=si>${</span><span class=nx>queryString</span><span class=si>}</span><span class=sb>:</span><span class=si>${</span><span class=nx>language</span><span class=si>}</span><span class=sb>:</span><span class=si>${</span><span class=nx>country</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>캐시 무효화 전략</p><ul><li><strong>시간 기반 만료</strong>: 적절한 TTL 설정으로 자동 만료</li><li><strong>명시적 무효화</strong>: 데이터 변경 시 관련 캐시 항목 명시적 삭제</li><li><strong>버전 기반 무효화</strong>: 리소스 버전을 변경하여 캐시 우회</li><li><strong>일괄 무효화</strong>: 관련 캐시 항목 그룹을 한 번에 무효화</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-25-1><a class=lnlinks href=#hl-25-1> 1</a>
</span><span class=lnt id=hl-25-2><a class=lnlinks href=#hl-25-2> 2</a>
</span><span class=lnt id=hl-25-3><a class=lnlinks href=#hl-25-3> 3</a>
</span><span class=lnt id=hl-25-4><a class=lnlinks href=#hl-25-4> 4</a>
</span><span class=lnt id=hl-25-5><a class=lnlinks href=#hl-25-5> 5</a>
</span><span class=lnt id=hl-25-6><a class=lnlinks href=#hl-25-6> 6</a>
</span><span class=lnt id=hl-25-7><a class=lnlinks href=#hl-25-7> 7</a>
</span><span class=lnt id=hl-25-8><a class=lnlinks href=#hl-25-8> 8</a>
</span><span class=lnt id=hl-25-9><a class=lnlinks href=#hl-25-9> 9</a>
</span><span class=lnt id=hl-25-10><a class=lnlinks href=#hl-25-10>10</a>
</span><span class=lnt id=hl-25-11><a class=lnlinks href=#hl-25-11>11</a>
</span><span class=lnt id=hl-25-12><a class=lnlinks href=#hl-25-12>12</a>
</span><span class=lnt id=hl-25-13><a class=lnlinks href=#hl-25-13>13</a>
</span><span class=lnt id=hl-25-14><a class=lnlinks href=#hl-25-14>14</a>
</span><span class=lnt id=hl-25-15><a class=lnlinks href=#hl-25-15>15</a>
</span><span class=lnt id=hl-25-16><a class=lnlinks href=#hl-25-16>16</a>
</span><span class=lnt id=hl-25-17><a class=lnlinks href=#hl-25-17>17</a>
</span><span class=lnt id=hl-25-18><a class=lnlinks href=#hl-25-18>18</a>
</span><span class=lnt id=hl-25-19><a class=lnlinks href=#hl-25-19>19</a>
</span><span class=lnt id=hl-25-20><a class=lnlinks href=#hl-25-20>20</a>
</span><span class=lnt id=hl-25-21><a class=lnlinks href=#hl-25-21>21</a>
</span><span class=lnt id=hl-25-22><a class=lnlinks href=#hl-25-22>22</a>
</span><span class=lnt id=hl-25-23><a class=lnlinks href=#hl-25-23>23</a>
</span><span class=lnt id=hl-25-24><a class=lnlinks href=#hl-25-24>24</a>
</span><span class=lnt id=hl-25-25><a class=lnlinks href=#hl-25-25>25</a>
</span><span class=lnt id=hl-25-26><a class=lnlinks href=#hl-25-26>26</a>
</span><span class=lnt id=hl-25-27><a class=lnlinks href=#hl-25-27>27</a>
</span><span class=lnt id=hl-25-28><a class=lnlinks href=#hl-25-28>28</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Redis 캐시 무효화 예제
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>invalidateCache</span><span class=p>(</span><span class=nx>patterns</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>redisClient</span> <span class=o>=</span> <span class=nx>getRedisClient</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kr>const</span> <span class=nx>pattern</span> <span class=k>of</span> <span class=nx>patterns</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 패턴과 일치하는 모든 키 찾기
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>keys</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>redisClient</span><span class=p>.</span><span class=nx>keys</span><span class=p>(</span><span class=nx>pattern</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>keys</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 일치하는 모든 키 삭제
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kr>await</span> <span class=nx>redisClient</span><span class=p>.</span><span class=nx>del</span><span class=p>(</span><span class=nx>keys</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Invalidated </span><span class=si>${</span><span class=nx>keys</span><span class=p>.</span><span class=nx>length</span><span class=si>}</span><span class=sb> cache entries matching pattern: </span><span class=si>${</span><span class=nx>pattern</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 제품 업데이트 시 관련 캐시 무효화
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>updateProduct</span><span class=p>(</span><span class=nx>productId</span><span class=p>,</span> <span class=nx>productData</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 제품 업데이트
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>await</span> <span class=nx>database</span><span class=p>.</span><span class=nx>products</span><span class=p>.</span><span class=nx>update</span><span class=p>(</span><span class=nx>productId</span><span class=p>,</span> <span class=nx>productData</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 관련 캐시 항목 무효화
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>await</span> <span class=nx>invalidateCache</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=sb>`product:</span><span class=si>${</span><span class=nx>productId</span><span class=si>}</span><span class=sb>*`</span><span class=p>,</span>           <span class=c1>// 제품 세부 정보
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=sb>`category:</span><span class=si>${</span><span class=nx>productData</span><span class=p>.</span><span class=nx>categoryId</span><span class=si>}</span><span class=sb>*`</span><span class=p>,</span>  <span class=c1>// 카테고리 목록
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=sb>`search:*`</span>                         <span class=c1>// 검색 결과
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>모니터링 및 최적화</p><ul><li><strong>캐시 적중률 추적</strong>: 캐시 성능을 측정하기 위한 지표 모니터링</li><li><strong>핫스팟 식별</strong>: 자주 접근되지만 캐시되지 않는 리소스 식별</li><li><strong>캐시 크기 최적화</strong>: 메모리 사용량과 캐시 적중률 간의 균형 조정</li><li><strong>TTL 미세 조정</strong>: 사용 패턴에 따른 TTL 주기적 조정</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-26-1><a class=lnlinks href=#hl-26-1> 1</a>
</span><span class=lnt id=hl-26-2><a class=lnlinks href=#hl-26-2> 2</a>
</span><span class=lnt id=hl-26-3><a class=lnlinks href=#hl-26-3> 3</a>
</span><span class=lnt id=hl-26-4><a class=lnlinks href=#hl-26-4> 4</a>
</span><span class=lnt id=hl-26-5><a class=lnlinks href=#hl-26-5> 5</a>
</span><span class=lnt id=hl-26-6><a class=lnlinks href=#hl-26-6> 6</a>
</span><span class=lnt id=hl-26-7><a class=lnlinks href=#hl-26-7> 7</a>
</span><span class=lnt id=hl-26-8><a class=lnlinks href=#hl-26-8> 8</a>
</span><span class=lnt id=hl-26-9><a class=lnlinks href=#hl-26-9> 9</a>
</span><span class=lnt id=hl-26-10><a class=lnlinks href=#hl-26-10>10</a>
</span><span class=lnt id=hl-26-11><a class=lnlinks href=#hl-26-11>11</a>
</span><span class=lnt id=hl-26-12><a class=lnlinks href=#hl-26-12>12</a>
</span><span class=lnt id=hl-26-13><a class=lnlinks href=#hl-26-13>13</a>
</span><span class=lnt id=hl-26-14><a class=lnlinks href=#hl-26-14>14</a>
</span><span class=lnt id=hl-26-15><a class=lnlinks href=#hl-26-15>15</a>
</span><span class=lnt id=hl-26-16><a class=lnlinks href=#hl-26-16>16</a>
</span><span class=lnt id=hl-26-17><a class=lnlinks href=#hl-26-17>17</a>
</span><span class=lnt id=hl-26-18><a class=lnlinks href=#hl-26-18>18</a>
</span><span class=lnt id=hl-26-19><a class=lnlinks href=#hl-26-19>19</a>
</span><span class=lnt id=hl-26-20><a class=lnlinks href=#hl-26-20>20</a>
</span><span class=lnt id=hl-26-21><a class=lnlinks href=#hl-26-21>21</a>
</span><span class=lnt id=hl-26-22><a class=lnlinks href=#hl-26-22>22</a>
</span><span class=lnt id=hl-26-23><a class=lnlinks href=#hl-26-23>23</a>
</span><span class=lnt id=hl-26-24><a class=lnlinks href=#hl-26-24>24</a>
</span><span class=lnt id=hl-26-25><a class=lnlinks href=#hl-26-25>25</a>
</span><span class=lnt id=hl-26-26><a class=lnlinks href=#hl-26-26>26</a>
</span><span class=lnt id=hl-26-27><a class=lnlinks href=#hl-26-27>27</a>
</span><span class=lnt id=hl-26-28><a class=lnlinks href=#hl-26-28>28</a>
</span><span class=lnt id=hl-26-29><a class=lnlinks href=#hl-26-29>29</a>
</span><span class=lnt id=hl-26-30><a class=lnlinks href=#hl-26-30>30</a>
</span><span class=lnt id=hl-26-31><a class=lnlinks href=#hl-26-31>31</a>
</span><span class=lnt id=hl-26-32><a class=lnlinks href=#hl-26-32>32</a>
</span><span class=lnt id=hl-26-33><a class=lnlinks href=#hl-26-33>33</a>
</span><span class=lnt id=hl-26-34><a class=lnlinks href=#hl-26-34>34</a>
</span><span class=lnt id=hl-26-35><a class=lnlinks href=#hl-26-35>35</a>
</span><span class=lnt id=hl-26-36><a class=lnlinks href=#hl-26-36>36</a>
</span><span class=lnt id=hl-26-37><a class=lnlinks href=#hl-26-37>37</a>
</span><span class=lnt id=hl-26-38><a class=lnlinks href=#hl-26-38>38</a>
</span><span class=lnt id=hl-26-39><a class=lnlinks href=#hl-26-39>39</a>
</span><span class=lnt id=hl-26-40><a class=lnlinks href=#hl-26-40>40</a>
</span><span class=lnt id=hl-26-41><a class=lnlinks href=#hl-26-41>41</a>
</span><span class=lnt id=hl-26-42><a class=lnlinks href=#hl-26-42>42</a>
</span><span class=lnt id=hl-26-43><a class=lnlinks href=#hl-26-43>43</a>
</span><span class=lnt id=hl-26-44><a class=lnlinks href=#hl-26-44>44</a>
</span><span class=lnt id=hl-26-45><a class=lnlinks href=#hl-26-45>45</a>
</span><span class=lnt id=hl-26-46><a class=lnlinks href=#hl-26-46>46</a>
</span><span class=lnt id=hl-26-47><a class=lnlinks href=#hl-26-47>47</a>
</span><span class=lnt id=hl-26-48><a class=lnlinks href=#hl-26-48>48</a>
</span><span class=lnt id=hl-26-49><a class=lnlinks href=#hl-26-49>49</a>
</span><span class=lnt id=hl-26-50><a class=lnlinks href=#hl-26-50>50</a>
</span><span class=lnt id=hl-26-51><a class=lnlinks href=#hl-26-51>51</a>
</span><span class=lnt id=hl-26-52><a class=lnlinks href=#hl-26-52>52</a>
</span><span class=lnt id=hl-26-53><a class=lnlinks href=#hl-26-53>53</a>
</span><span class=lnt id=hl-26-54><a class=lnlinks href=#hl-26-54>54</a>
</span><span class=lnt id=hl-26-55><a class=lnlinks href=#hl-26-55>55</a>
</span><span class=lnt id=hl-26-56><a class=lnlinks href=#hl-26-56>56</a>
</span><span class=lnt id=hl-26-57><a class=lnlinks href=#hl-26-57>57</a>
</span><span class=lnt id=hl-26-58><a class=lnlinks href=#hl-26-58>58</a>
</span><span class=lnt id=hl-26-59><a class=lnlinks href=#hl-26-59>59</a>
</span><span class=lnt id=hl-26-60><a class=lnlinks href=#hl-26-60>60</a>
</span><span class=lnt id=hl-26-61><a class=lnlinks href=#hl-26-61>61</a>
</span><span class=lnt id=hl-26-62><a class=lnlinks href=#hl-26-62>62</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// 캐시 메트릭 수집 미들웨어
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>cacheMetricsMiddleware</span><span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>startTime</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>originalSend</span> <span class=o>=</span> <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 캐시 상태 확인을 위한 플래그 추가
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>req</span><span class=p>.</span><span class=nx>cacheStatus</span> <span class=o>=</span> <span class=s1>&#39;MISS&#39;</span><span class=p>;</span> <span class=c1>// 기본값
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=c1>// 응답 메서드 오버라이드
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>res</span><span class=p>.</span><span class=nx>send</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>body</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>responseTime</span> <span class=o>=</span> <span class=nb>Date</span><span class=p>.</span><span class=nx>now</span><span class=p>()</span> <span class=o>-</span> <span class=nx>startTime</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 메트릭 수집
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>metrics</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>path</span><span class=o>:</span> <span class=nx>req</span><span class=p>.</span><span class=nx>path</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>method</span><span class=o>:</span> <span class=nx>req</span><span class=p>.</span><span class=nx>method</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>status</span><span class=o>:</span> <span class=nx>res</span><span class=p>.</span><span class=nx>statusCode</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>responseTime</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>cacheStatus</span><span class=o>:</span> <span class=nx>req</span><span class=p>.</span><span class=nx>cacheStatus</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>contentLength</span><span class=o>:</span> <span class=nx>Buffer</span><span class=p>.</span><span class=nx>isBuffer</span><span class=p>(</span><span class=nx>body</span><span class=p>)</span> <span class=o>?</span> <span class=nx>body</span><span class=p>.</span><span class=nx>length</span> <span class=o>:</span> <span class=nx>Buffer</span><span class=p>.</span><span class=nx>byteLength</span><span class=p>(</span><span class=nx>body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 메트릭 저장 또는 전송
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>recordMetrics</span><span class=p>(</span><span class=nx>metrics</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 원래 메서드 호출
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=nx>originalSend</span><span class=p>.</span><span class=nx>call</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=nx>body</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Redis 캐시 래퍼 예제 (메트릭 수집 포함)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>async</span> <span class=kd>function</span> <span class=nx>getCachedData</span><span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>key</span><span class=p>,</span> <span class=nx>fetchFunction</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>redisClient</span> <span class=o>=</span> <span class=nx>getRedisClient</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 캐시 확인
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>cachedData</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>redisClient</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>cachedData</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 캐시 적중
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=nx>req</span><span class=p>.</span><span class=nx>cacheStatus</span> <span class=o>=</span> <span class=s1>&#39;HIT&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>cachedData</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 캐시 미스
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>req</span><span class=p>.</span><span class=nx>cacheStatus</span> <span class=o>=</span> <span class=s1>&#39;MISS&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 원본 데이터 가져오기
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetchFunction</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 결과 캐싱
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>await</span> <span class=nx>redisClient</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>key</span><span class=p>,</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>data</span><span class=p>),</span> <span class=s1>&#39;EX&#39;</span><span class=p>,</span> <span class=mi>3600</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 오류 발생 시
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>req</span><span class=p>.</span><span class=nx>cacheStatus</span> <span class=o>=</span> <span class=s1>&#39;ERROR&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>throw</span> <span class=nx>error</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>보안 고려사항</p><ul><li><strong>민감한 데이터 캐싱 제한</strong>: 개인 식별 정보(PII)나 민감한 데이터는 캐싱 제외</li><li><strong>인증된 콘텐츠 처리</strong>: 인증이 필요한 데이터의 적절한 캐싱 전략 구현</li><li><strong>캐시 포이즌(Cache Poisoning) 방지</strong>: 사용자 입력 검증 및 캐시 키 설계 주의</li><li><strong>HTTPS 사용</strong>: 전송 중 데이터 보호</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-27-1><a class=lnlinks href=#hl-27-1> 1</a>
</span><span class=lnt id=hl-27-2><a class=lnlinks href=#hl-27-2> 2</a>
</span><span class=lnt id=hl-27-3><a class=lnlinks href=#hl-27-3> 3</a>
</span><span class=lnt id=hl-27-4><a class=lnlinks href=#hl-27-4> 4</a>
</span><span class=lnt id=hl-27-5><a class=lnlinks href=#hl-27-5> 5</a>
</span><span class=lnt id=hl-27-6><a class=lnlinks href=#hl-27-6> 6</a>
</span><span class=lnt id=hl-27-7><a class=lnlinks href=#hl-27-7> 7</a>
</span><span class=lnt id=hl-27-8><a class=lnlinks href=#hl-27-8> 8</a>
</span><span class=lnt id=hl-27-9><a class=lnlinks href=#hl-27-9> 9</a>
</span><span class=lnt id=hl-27-10><a class=lnlinks href=#hl-27-10>10</a>
</span><span class=lnt id=hl-27-11><a class=lnlinks href=#hl-27-11>11</a>
</span><span class=lnt id=hl-27-12><a class=lnlinks href=#hl-27-12>12</a>
</span><span class=lnt id=hl-27-13><a class=lnlinks href=#hl-27-13>13</a>
</span><span class=lnt id=hl-27-14><a class=lnlinks href=#hl-27-14>14</a>
</span><span class=lnt id=hl-27-15><a class=lnlinks href=#hl-27-15>15</a>
</span><span class=lnt id=hl-27-16><a class=lnlinks href=#hl-27-16>16</a>
</span><span class=lnt id=hl-27-17><a class=lnlinks href=#hl-27-17>17</a>
</span><span class=lnt id=hl-27-18><a class=lnlinks href=#hl-27-18>18</a>
</span><span class=lnt id=hl-27-19><a class=lnlinks href=#hl-27-19>19</a>
</span><span class=lnt id=hl-27-20><a class=lnlinks href=#hl-27-20>20</a>
</span><span class=lnt id=hl-27-21><a class=lnlinks href=#hl-27-21>21</a>
</span><span class=lnt id=hl-27-22><a class=lnlinks href=#hl-27-22>22</a>
</span><span class=lnt id=hl-27-23><a class=lnlinks href=#hl-27-23>23</a>
</span><span class=lnt id=hl-27-24><a class=lnlinks href=#hl-27-24>24</a>
</span><span class=lnt id=hl-27-25><a class=lnlinks href=#hl-27-25>25</a>
</span><span class=lnt id=hl-27-26><a class=lnlinks href=#hl-27-26>26</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>shouldCacheResponse</span><span class=p>(</span><span class=nx>request</span><span class=p>,</span> <span class=nx>response</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 민감한 엔드포인트는 캐싱하지 않음
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>path</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=s1>&#39;/user/&#39;</span><span class=p>)</span> <span class=o>||</span> 
</span></span><span class=line><span class=cl>      <span class=nx>request</span><span class=p>.</span><span class=nx>path</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=s1>&#39;/payment/&#39;</span><span class=p>)</span> <span class=o>||</span>
</span></span><span class=line><span class=cl>      <span class=nx>request</span><span class=p>.</span><span class=nx>path</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=s1>&#39;/admin/&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 인증된 요청은 특별히 처리
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>has</span><span class=p>(</span><span class=s1>&#39;Authorization&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 개인화된 데이터는 캐싱하지 않음
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 또는 사용자별 캐시 키 사용 (주의 필요)
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// request.cacheKey = `${request.cacheKey}:user:${getUserIdFromToken(request)}`;
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// return true;
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 오류 응답은 캐싱하지 않음
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>response</span><span class=p>.</span><span class=nx>status</span> <span class=o>&gt;=</span> <span class=mi>400</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// 나머지는 캐싱
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=api-캐싱-구현-사례-연구>API 캐싱 구현 사례 연구<a hidden class=anchor aria-hidden=true href=#api-캐싱-구현-사례-연구>#</a></h3><p>실제 API 캐싱 구현의 예시를 통해 다양한 전략과 그 효과를 살펴보자:</p><h4 id=사례-1-전자상거래-api-캐싱>사례 1: 전자상거래 API 캐싱<a hidden class=anchor aria-hidden=true href=#사례-1-전자상거래-api-캐싱>#</a></h4><p><strong>시나리오</strong>: 대규모 전자상거래 플랫폼의 제품 및 카테고리 API</p><p><strong>도전 과제</strong>:</p><ul><li>수백만 개의 제품 정보 효율적 제공</li><li>주문량 급증 시에도 안정적인 성능 유지</li><li>재고 및 가격 정보의 적시성 보장</li></ul><p><strong>구현된 캐싱 전략</strong>:</p><ol><li><strong>다중 계층 캐싱</strong>:<ul><li>CDN: 제품 이미지, 설명 등 정적 콘텐츠 (TTL: 24시간)</li><li>API 게이트웨이: 카테고리 목록, 제품 검색 결과 (TTL: 15분)</li><li>애플리케이션 캐시(Redis): 제품 상세 정보 (TTL: 5분)</li><li>데이터베이스 쿼리 캐시: 복잡한 집계 쿼리 (TTL: 1시간)</li></ul></li><li><strong>컨텍스트 인식 캐싱</strong>:<ul><li>국가/지역별 가격 및 재고 캐싱</li><li>사용자 세그먼트별 추천 제품 캐싱</li></ul></li><li><strong>재고 관리를 위한 특수 전략</strong>:<ul><li>재고 숫자 > 20: 일반 캐싱 (TTL: 5분)</li><li>재고 숫자 &lt;= 20: 짧은 캐싱 (TTL: 1분)</li><li>재고 숫자 &lt;= 5: 캐싱하지 않음 (실시간 확인)</li></ul></li></ol><p><strong>결과</strong>:</p><ul><li>서버 부하 80% 감소</li><li>평균 응답 시간 200ms에서 50ms로 개선</li><li>트래픽 급증 시에도 안정적인 성능 유지</li><li>추가 하드웨어 비용 절감</li></ul><h4 id=사례-2-소셜-미디어-api-캐싱>사례 2: 소셜 미디어 API 캐싱<a hidden class=anchor aria-hidden=true href=#사례-2-소셜-미디어-api-캐싱>#</a></h4><p><strong>시나리오</strong>: 대규모 소셜 네트워크 플랫폼의 타임라인 및 사용자 프로필 API</p><p><strong>도전 과제</strong>:</p><ul><li>실시간 콘텐츠와 빠른 응답 시간 간의 균형</li><li>개인화된 콘텐츠의 효율적인 캐싱</li><li>자주 업데이트되는 데이터 관리</li></ul><p><strong>구현된 캐싱 전략</strong>:</p><ol><li><strong>프래그먼트 캐싱(Fragment Caching)</strong>:<ul><li>타임라인의 개별 게시물 단위로 캐싱</li><li>사용자 프로필의 각 섹션(기본 정보, 활동, 연결 등) 별도 캐싱</li></ul></li><li><strong>사용자별 캐싱</strong>:<ul><li>사용자 ID 기반 캐시 키</li><li>활성 사용자와 비활성 사용자에 대한 차별화된 TTL</li></ul></li><li><strong>타임라인 최적화</strong>:<ul><li>&lsquo;인기&rsquo; 타임라인: 광범위하게 캐싱 (TTL: 5분)</li><li>&lsquo;팔로우&rsquo; 타임라인: 사용자별 캐싱 + 실시간 업데이트 병합</li><li>댓글 및 반응: 읽기 전용 캐싱 + 쓰기 시 무효화</li></ul></li><li><strong>푸시 기반 무효화</strong>:<ul><li>콘텐츠 업데이트 시 이벤트 기반 캐시 무효화</li><li>팬아웃(fan-out) 기법으로 관련 사용자의 캐시 선택적 무효화</li></ul></li></ol><p><strong>결과</strong>:</p><ul><li>데이터베이스 쿼리 수 65% 감소</li><li>타임라인 로딩 시간 300ms에서 80ms로 개선</li><li>실시간성을 유지하면서도 서버 부하 크게 감소</li><li>사용자당 API 호출 비용 50% 절감</li></ul><h4 id=사례-3-금융-서비스-api-캐싱>사례 3: 금융 서비스 API 캐싱<a hidden class=anchor aria-hidden=true href=#사례-3-금융-서비스-api-캐싱>#</a></h4><p><strong>시나리오</strong>: 주식 시세, 계좌 정보, 거래 이력을 제공하는 금융 API</p><p><strong>도전 과제</strong>:</p><ul><li>실시간 시장 데이터의 정확성</li><li>민감한 금융 정보의 안전한 처리</li><li>규제 준수 및 감사 요구사항</li></ul><p><strong>구현된 캐싱 전략</strong>:</p><ol><li><strong>데이터 유형별 차별화된 전략</strong>:<ul><li>시장 데이터(공개): 적극적인 캐싱 + 짧은 TTL (10-30초)</li><li>계좌 요약 정보: 제한적 캐싱 + 인증 컨텍스트 포함 (TTL: 5분)</li><li>거래 이력: 읽기 전용 캐싱 (TTL: 15분)</li><li>개인 금융 정보: 캐싱하지 않음</li></ul></li><li><strong>타임스탬프 기반 캐싱</strong>:<ul><li>시장 시간 외 데이터: 장기 캐싱 (TTL: 몇 시간)</li><li>거래 시간 중 데이터: 매우 짧은 캐싱 (TTL: 10초)</li><li>장 마감 후 데이터: 중간 길이 캐싱 (TTL: 10분)</li></ul></li><li><strong>안전한 사용자별 캐싱</strong>:<ul><li>암호화된 사용자 식별자 기반 캐시 키</li><li>메모리 전용 캐싱 (디스크에 저장하지 않음)</li><li>세션 종료 시 자동 캐시 무효화</li></ul></li><li><strong>이벤트 기반 실시간 업데이트</strong>:<ul><li>WebSocket을 통한 시장 데이터 실시간 푸시</li><li>거래 완료 후 관련 캐시 즉시 무효화</li></ul></li></ol><p><strong>결과</strong>:</p><ul><li>API 서버 부하 70% 감소</li><li>시장 데이터 지연 평균 50ms 이내로 유지</li><li>규제 준수 유지하면서 성능 최적화</li><li>사용자 경험 및 신뢰도 향상</li></ul><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/backend/>Backend</a></li><li><a href=https://buenhyden.github.io/tags/api-design/>API-Design</a></li><li><a href=https://buenhyden.github.io/tags/api-performance/>API-Performance</a></li><li><a href=https://buenhyden.github.io/tags/caching-strategies/>Caching-Strategies</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/programming-languages/javascript/javascript-engines/><span class=title>« Prev</span><br><span>Javascript Engines</span>
</a><a class=next href=https://buenhyden.github.io/posts/computer-science/fundamentals/programming-paradigms/imperative-programming/imperative-programming-vs-declarative-programming/><span class=title>Next »</span><br><span>명령형 프로그래밍(Imperative Programming) vs. 선언적 프로그래밍(Declarative Programming)</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>