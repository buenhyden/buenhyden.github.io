<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>RFC 6749 | hyunyoun's Blog</title>
<meta name=keywords content="Backend,API-Design,Authentication-Methods,OAuth"><meta name=description content="RFC 6749는 OAuth 2.0 권한 부여 프레임워크(The OAuth 2.0 Authorization Framework)를 정의하는 인터넷 표준 문서이다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/backend/api-design/authentication-methods/oauth/rfc-6749/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/backend/api-design/authentication-methods/oauth/rfc-6749/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/backend/api-design/authentication-methods/oauth/rfc-6749/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="RFC 6749"><meta property="og:description" content="RFC 6749는 OAuth 2.0 권한 부여 프레임워크(The OAuth 2.0 Authorization Framework)를 정의하는 인터넷 표준 문서이다."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-28T11:28:00+00:00"><meta property="article:modified_time" content="2025-02-28T11:28:00+00:00"><meta property="article:tag" content="Backend"><meta property="article:tag" content="API-Design"><meta property="article:tag" content="Authentication-Methods"><meta property="article:tag" content="OAuth"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="RFC 6749"><meta name=twitter:description content="RFC 6749는 OAuth 2.0 권한 부여 프레임워크(The OAuth 2.0 Authorization Framework)를 정의하는 인터넷 표준 문서이다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Backend","item":"https://buenhyden.github.io/posts/backend/"},{"@type":"ListItem","position":3,"name":"APIs","item":"https://buenhyden.github.io/posts/backend/api-design/"},{"@type":"ListItem","position":4,"name":"Authentication Methods","item":"https://buenhyden.github.io/posts/backend/api-design/authentication-methods/"},{"@type":"ListItem","position":5,"name":"OAuth","item":"https://buenhyden.github.io/posts/backend/api-design/authentication-methods/oauth/"},{"@type":"ListItem","position":6,"name":"RFC 6749","item":"https://buenhyden.github.io/posts/backend/api-design/authentication-methods/oauth/rfc-6749/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"RFC 6749","name":"RFC 6749","description":"RFC 6749는 OAuth 2.0 권한 부여 프레임워크(The OAuth 2.0 Authorization Framework)를 정의하는 인터넷 표준 문서이다.","keywords":["Backend","API-Design","Authentication-Methods","OAuth"],"articleBody":"RFC 6749 RFC 6749는 OAuth 2.0 권한 부여 프레임워크(The OAuth 2.0 Authorization Framework)를 정의하는 인터넷 표준 문서이다. 이 문서는 2012년 10월에 인터넷 표준화 기구인 IETF(Internet Engineering Task Force)에 의해 발행되었다. 주 저자는 Dick Hardt이며, 여러 기술 전문가들의 협업으로 만들어졌다.\nOAuth 2.0은 이전 버전인 OAuth 1.0(RFC 5849)의 후속 버전으로, 다양한 웹 애플리케이션, 데스크톱 애플리케이션, 모바일 애플리케이션 및 IoT 장치에서 안전한 권한 위임을 가능하게 하는 프로토콜이다. 간단히 말해, OAuth 2.0은 사용자가 자신의 비밀번호를 공유하지 않고도 제3자 애플리케이션에 자신의 데이터에 대한 제한된 접근 권한을 부여할 수 있도록 해주는 프레임워크이다.\nOAuth 1.0에서 OAuth 2.0으로의 전환은 단순한 버전 업그레이드가 아닌 완전한 재설계였다. OAuth 2.0은 OAuth 1.0보다 구현이 더 간단하고, 모바일 애플리케이션과 같은 다양한 클라이언트 유형을 더 잘 지원하며, 더 나은 확장성을 제공한다. 그러나 이런 단순화는 보안 모델의 변화도 수반했다.\nOAuth 2.0의 기본 개념과 용어 OAuth 2.0을 이해하기 위해서는 먼저 다음과 같은 핵심 용어와 개념을 이해해야 한다:\n주요 역할(Roles) OAuth 2.0 프레임워크에는 네 가지 주요 역할이 있다:\n리소스 소유자(Resource Owner): 보호된 리소스에 접근 권한을 부여할 수 있는 엔티티로, 일반적으로 최종 사용자이다. 예를 들어, 자신의 Google 계정 데이터에 접근 권한을 부여하는 사용자이다. 리소스 서버(Resource Server): 보호된 리소스를 호스팅하는 서버로, 액세스 토큰을 사용하여 보호된 리소스 요청을 수락하고 응답할 수 있다. 예를 들어, Google의 API 서버가 이에 해당한다. 클라이언트(Client): 리소스 소유자의 권한으로 보호된 리소스에 접근을 요청하는 애플리케이션이다. 예를 들어, 사용자의 Google 계정에 접근하려는 제3자 애플리케이션이 이에 해당한다. 권한 부여 서버(Authorization Server): 리소스 소유자를 인증하고 권한을 얻은 후 클라이언트에게 액세스 토큰을 발급하는 서버이다. 예를 들어, Google의 OAuth 서버가 이에 해당한다. 토큰(Tokens) OAuth 2.0은 두 가지 주요 토큰 유형을 사용한다:\n액세스 토큰(Access Token): 보호된 리소스에 접근하기 위한 자격 증명으로, 일반적으로 문자열 형태이다. 이 토큰은 리소스 소유자가 클라이언트에게 부여한 권한 범위, 기간 등의 정보를 나타낸다. 리프레시 토큰(Refresh Token): 액세스 토큰이 만료된 후 새 액세스 토큰을 얻기 위해 사용되는 자격 증명이다. 액세스 토큰보다 일반적으로 수명이 길고, 경우에 따라 발급되지 않을 수도 있다. 클라이언트 유형 OAuth 2.0은 다양한 클라이언트 유형을 지원한다:\n기밀 클라이언트(Confidential Client): 클라이언트 자격 증명(비밀)을 안전하게 보관할 수 있는 클라이언트로, 일반적으로 웹 서버에서 실행되는 애플리케이션이다. 공개 클라이언트(Public Client): 클라이언트 자격 증명을 안전하게 보관할 수 없는 클라이언트로, 일반적으로 브라우저에서 실행되는 JavaScript 애플리케이션이나 모바일 앱이 이에 해당한다. 권한 부여 유형(Grant Types) RFC 6749는 다양한 사용 사례를 지원하기 위해 네 가지 기본 권한 부여 유형을 정의한다:\n권한 부여 코드(Authorization Code): 클라이언트가 권한 부여 서버로부터 권한 부여 코드를 얻은 다음, 이 코드를 액세스 토큰으로 교환하는 방식이다. 이는 서버 사이드 웹 애플리케이션에 가장 적합하다. 암시적 부여(Implicit): 간소화된 권한 부여 코드 흐름으로, 권한 부여 코드 없이 액세스 토큰을 직접 발급받는다. 주로 브라우저 내 JavaScript 애플리케이션에 사용된다. 리소스 소유자 비밀번호 자격 증명(Resource Owner Password Credentials): 리소스 소유자의 자격 증명(아이디/비밀번호)을 클라이언트가 직접 사용하여 액세스 토큰을 얻는 방식이다. 높은 수준의 신뢰가 필요하며, 다른 방식이 불가능할 때만 사용해야 한다. 클라이언트 자격 증명(Client Credentials): 클라이언트가 자신의 자격 증명만을 사용하여 액세스 토큰을 얻는 방식으로, 클라이언트가 리소스 소유자를 대신하지 않고 자체적으로 리소스에 접근할 때 사용한다. OAuth 2.0 권한 부여 흐름 상세 분석 권한 부여 코드 부여(Authorization Code Grant) 이 흐름은 웹 애플리케이션과 같은 기밀 클라이언트에 가장 적합하며, 다음과 같은 단계로 진행된다.\n권한 요청: 클라이언트는 사용자를 권한 부여 서버로 리다이렉트하여 권한을 요청한다.\nGET /authorize? response_type=code\u0026 client_id=s6BhdRkqt3\u0026 state=xyz\u0026 redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb 사용자 인증 및 권한 부여: 권한 부여 서버는 사용자를 인증하고 클라이언트 요청에 대한 허가를 요청한다.\n권한 부여 코드 발급: 사용자가 권한을 부여하면, 권한 부여 서버는 클라이언트로 권한 부여 코드와 함께 사용자를 리다이렉트한다.\nHTTP/1.1 302 Found Location: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA\u0026state=xyz 액세스 토큰 요청: 클라이언트는 권한 부여 코드를 사용하여 액세스 토큰을 요청한다.\nPOST /token HTTP/1.1 Host: server.example.com Content-Type: application/x-www-form-urlencoded grant_type=authorization_code\u0026 code=SplxlOBeZQQYbYS6WxSbIA\u0026 redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb\u0026 client_id=s6BhdRkqt3\u0026 client_secret=7Fjfp0ZBr1KtDRbnfVdmIw 액세스 토큰 발급: 권한 부여 서버는 클라이언트의 신원을 확인하고 권한 부여 코드를 검증한 후, 액세스 토큰과 선택적으로 리프레시 토큰을 발급한다.\nHTTP/1.1 200 OK Content-Type: application/json;charset=UTF-8 Cache-Control: no-store Pragma: no-cache { \"access_token\":\"2YotnFZFEjr1zCsicMWpAA\", \"token_type\":\"bearer\", \"expires_in\":3600, \"refresh_token\":\"tGzv3JOkF0XG5Qx2TlKWIA\", \"example_parameter\":\"example_value\" } 이 흐름의 주요 장점은 높은 보안성과 리프레시 토큰 지원이다. 클라이언트 비밀이 사용자에게 노출되지 않고, 액세스 토큰도 프론트 채널(브라우저)을 통해 전달되지 않는다.\n암시적 부여(Implicit Grant) 이 흐름은 브라우저 기반 애플리케이션(SPA)과 같은 공개 클라이언트에 적합하며, 다음과 같은 단계로 진행된다:\n권한 요청: 클라이언트는 사용자를 권한 부여 서버로 리다이렉트한다. 이때 response_type=token으로 설정한다.\nGET /authorize? response_type=token\u0026 client_id=s6BhdRkqt3\u0026 state=xyz\u0026 redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb 사용자 인증 및 권한 부여: 권한 부여 서버는 사용자를 인증하고 권한을 요청한다.\n토큰 발급: 사용자가 권한을 부여하면, 권한 부여 서버는 액세스 토큰을 URI 프래그먼트에 포함시켜 클라이언트로 사용자를 리다이렉트한다.\nHTTP/1.1 302 Found Location: https://client.example.com/cb#access_token=2YotnFZFEjr1zCsicMWpAA\u0026state=xyz\u0026token_type=bearer\u0026expires_in=3600 토큰 사용: 클라이언트는 URI 프래그먼트에서 액세스 토큰을 추출하여 보호된 리소스에 접근하는 데 사용한다.\n이 흐름은 권한 부여 코드 흐름보다 단순하지만, 보안 측면에서 몇 가지 단점이 있다. 액세스 토큰이 브라우저를 통해 전달되므로 노출 위험이 있으며, 리프레시 토큰을 지원하지 않는다.\n리소스 소유자 비밀번호 자격 증명 부여(Resource Owner Password Credentials Grant) 이 흐름은 클라이언트가 리소스 소유자의 자격 증명을 직접 수집하여 액세스 토큰을 얻는 방식이다:\n자격 증명 수집: 클라이언트는 리소스 소유자로부터 직접 사용자 이름과 비밀번호를 획득한다.\n토큰 요청: 클라이언트는 이 자격 증명을 사용하여 권한 부여 서버에 액세스 토큰을 요청한다.\nPOST /token HTTP/1.1 Host: server.example.com Content-Type: application/x-www-form-urlencoded grant_type=password\u0026 username=johndoe\u0026 password=A3ddj3w\u0026 client_id=s6BhdRkqt3\u0026 client_secret=7Fjfp0ZBr1KtDRbnfVdmIw 토큰 발급: 권한 부여 서버는 자격 증명을 검증하고 액세스 토큰을 발급한다.\n이 방식은 리소스 소유자와 클라이언트 간에 높은 신뢰가 있을 때만 사용해야 한다. 예를 들어, 운영 체제 내장 클라이언트나 높은 권한을 가진 애플리케이션에 적합하다.\n클라이언트 자격 증명 부여(Client Credentials Grant) 이 흐름은 클라이언트가 자신의 자격 증명만을 사용하여 액세스 토큰을 얻는 방식이다:\n토큰 요청: 클라이언트는 자신의 자격 증명을 사용하여 권한 부여 서버에 액세스 토큰을 요청한다.\nPOST /token HTTP/1.1 Host: server.example.com Content-Type: application/x-www-form-urlencoded grant_type=client_credentials\u0026 client_id=s6BhdRkqt3\u0026 client_secret=7Fjfp0ZBr1KtDRbnfVdmIw 토큰 발급: 권한 부여 서버는 클라이언트 자격 증명을 검증하고 액세스 토큰을 발급한다.\n이 흐름은 리소스 소유자의 컨텍스트가 없는 클라이언트-서버 간 통신에 적합하다. 예를 들어, 백그라운드 서비스나 마이크로서비스 간 통신에 사용된다.\n토큰과 범위(Scopes) 액세스 토큰(Access Token) 액세스 토큰은 보호된 리소스에 접근하기 위한 자격 증명으로, 다음과 같은 특성을 가진다:\n형식: RFC 6749는 토큰 형식을 명시하지 않으며, 구현에 따라 다양한 형식(불투명 문자열, JWT 등)이 사용된다.\n전달 방식: 주로 HTTP Authorization 헤더를 통해 전달되며, 형식은 일반적으로 “Bearer” 토큰 유형을 사용한(RFC 6750).\nGET /resource HTTP/1.1 Host: server.example.com Authorization: Bearer 2YotnFZFEjr1zCsicMWpAA 수명: 액세스 토큰은 일반적으로 짧은 수명(몇 분에서 몇 시간)을 가지며, 이는 토큰 노출 시 위험을 줄이기 위함이다.\n리프레시 토큰(Refresh Token) 리프레시 토큰은 새로운 액세스 토큰을 얻기 위해 사용되며, 다음과 같은 특성을 가진다:\n용도: 액세스 토큰이 만료된 후 사용자를 다시 인증하지 않고도 새 액세스 토큰을 발급받을 수 있다.\n보안: 리프레시 토큰은 액세스 토큰보다 더 민감하므로, 클라이언트는 이를 안전하게 저장해야 한다.\n갱신 프로세스: 클라이언트는 리프레시 토큰을 사용하여 다음과 같이 새 액세스 토큰을 요청한다.\nPOST /token HTTP/1.1 Host: server.example.com Content-Type: application/x-www-form-urlencoded grant_type=refresh_token\u0026 refresh_token=tGzv3JOkF0XG5Qx2TlKWIA\u0026 client_id=s6BhdRkqt3\u0026 client_secret=7Fjfp0ZBr1KtDRbnfVdmIw 갱신 토큰 순환(Rotation): 보안 강화를 위해 새 액세스 토큰을 발급할 때 새 리프레시 토큰도 함께 발급하는 방식으로, 이전 리프레시 토큰은 무효화된다.\n범위(Scopes) 범위는 액세스 토큰이 부여하는 권한의 범위를 제한하는 메커니즘이다:\n정의: 범위는 일반적으로 공백으로 구분된 문자열 목록으로 표현된다. 예: scope=read_profile edit_profile read_contacts\n요청: 클라이언트는 권한 요청 시 필요한 범위를 지정할 수 있다.\nGET /authorize? response_type=code\u0026 client_id=s6BhdRkqt3\u0026 state=xyz\u0026 redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb\u0026 scope=read_profile%20read_contacts 동의 화면: 권한 부여 서버는 요청된 범위에 기반하여 사용자에게 동의 화면을 제시한다.\n토큰 응답: 발급된 토큰의 범위는 응답에 포함될 수 있으며, 요청된 범위보다 좁을 수 있다.\n{ \"access_token\":\"2YotnFZFEjr1zCsicMWpAA\", \"token_type\":\"bearer\", \"expires_in\":3600, \"refresh_token\":\"tGzv3JOkF0XG5Qx2TlKWIA\", \"scope\":\"read_profile read_contacts\" } 범위 확인: 리소스 서버는 액세스 토큰과 관련된 범위를 확인하여 요청된 리소스에 접근할 권한이 있는지 판단한다.\nOAuth 2.0의 보안 고려사항 RFC 6749는 OAuth 2.0 구현 시 고려해야 할 다양한 보안 측면을 다루고 있다.\n클라이언트 인증 클라이언트 인증은 권한 부여 서버가 토큰을 요청하는 클라이언트의 신원을 확인하는 과정이다:\n클라이언트 비밀(Client Secret): 기밀 클라이언트는 권한 부여 서버에 등록 시 받은 비밀을 사용하여 인증한다.\n인증 방법:\nHTTP Basic 인증 Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW 요청 본문 파라미터 client_id=s6BhdRkqt3\u0026client_secret=gX1fBat3bV 공개 클라이언트: 공개 클라이언트는 클라이언트 비밀을 안전하게 보관할 수 없으므로, 대안적인 인증 메커니즘(예: PKCE)이 권장된다.\n권한 코드와 액세스 토큰 보호 권한 코드와 액세스 토큰을 보호하기 위한 고려사항:\n수명 제한: 권한 코드는 매우 짧은 수명(일반적으로 몇 분)을 가져야 하며, 한 번만 사용 가능해야 한다. 토큰 기밀성: 액세스 토큰은 권한이 없는 당사자에게 노출되지 않도록 해야 한다. TLS 사용: 모든 토큰 교환은 TLS(Transport Layer Security)를 통해 이루어져야 한다. 리다이렉션 URI 검증: 권한 부여 서버는 클라이언트로부터 받은 리다이렉션 URI가 등록된 URI와 정확히 일치하는지 확인해야 한다. 일반적인 보안 위협과 대응 OAuth 2.0 구현에서 고려해야 할 주요 보안 위협:\nCSRF(Cross-Site Request Forgery):\n위협: 공격자가 사용자를 속여 의도하지 않은 권한 부여 요청을 수행하게 할 수 있다. 대응: 클라이언트는 권한 요청 시 state 파라미터를 사용하여 CSRF 공격을 방지해야 한다. GET /authorize?response_type=code\u0026client_id=s6BhdRkqt3\u0026state=xyz\u0026redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb 리다이렉션 URI 조작:\n위협: 공격자가 권한 코드나 액세스 토큰을 자신의 서버로 리다이렉트할 수 있다. 대응: 권한 부여 서버는 리다이렉션 URI를 엄격하게 검증해야 한다. 토큰 탈취:\n위협: 액세스 토큰이 노출되면 공격자가 보호된 리소스에 접근할 수 있다. 대응: 짧은 토큰 수명, TLS 사용, 토큰 저장 시 보안 조치 적용 등 클라이언트 가장(Impersonation):\n위협: 공격자가 합법적인 클라이언트인 것처럼 가장할 수 있다. 대응: 안전한 클라이언트 등록 및 인증 절차 구현 PKCE(Proof Key for Code Exchange) PKCE는 RFC 7636에서 정의된 확장으로, 공개 클라이언트를 위한 보안 강화 메커니즘이다:\n목적: 권한 코드 가로채기 공격으로부터 보호한다.\n작동 방식:\n클라이언트는 랜덤 문자열(code_verifier)을 생성한다. 이 문자열의 해시(code_challenge)를 계산한다. 권한 요청 시 code_challenge와 code_challenge_method(S256 또는 plain)를 포함한다. 토큰 교환 시 원래의 code_verifier를 제공한다. 권한 부여 서버는 code_verifier의 해시가 이전에 받은 code_challenge와 일치하는지 확인한다. 구현 예:\n# 권한 요청 GET /authorize? response_type=code\u0026 client_id=s6BhdRkqt3\u0026 state=xyz\u0026 redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb\u0026 code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM\u0026 code_challenge_method=S256 # 토큰 요청 POST /token HTTP/1.1 Host: server.example.com Content-Type: application/x-www-form-urlencoded grant_type=authorization_code\u0026 code=SplxlOBeZQQYbYS6WxSbIA\u0026 redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb\u0026 client_id=s6BhdRkqt3\u0026 code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk OAuth 2.0 확장과 후속 발전 RFC 6749 발표 이후, OAuth 2.0 생태계는 다양한 확장과 개선을 통해 발전해왔다.\n주요 확장 표준 Bearer Token Usage (RFC 6750):\n액세스 토큰을 HTTP 요청에 포함시키는 방법을 정의한다. Authorization 헤더, 폼 인코딩 바디 파라미터, URI 쿼리 파라미터 등 방법을 명시한다. Token Revocation (RFC 7009):\n클라이언트가 더 이상 필요하지 않거나 손상된 것으로 의심되는 토큰을 취소하는 방법을 정의한다. POST /revoke HTTP/1.1 Host: server.example.com Content-Type: application/x-www-form-urlencoded token=45ghiukldjahdnhzdauz\u0026token_type_hint=refresh_token Dynamic Client Registration (RFC 7591):\n클라이언트가 권한 부여 서버에 자동으로 등록하고 필요한 정보를 얻는 방법을 정의한다. JWT for OAuth 2.0 Client Authentication (RFC 7523):\nJSON Web Token(JWT)을 사용하여 OAuth 2.0 클라이언트를 인증하는 방법을 정의한다. 클라이언트 비밀 대신 JWT를 사용하여 클라이언트 인증을 가능하게 한다. Token Introspection (RFC 7662):\n리소스 서버가 권한 부여 서버에 토큰의 상태와 메타데이터를 질의할 수 있는 방법을 정의한다. POST /introspect HTTP/1.1 Host: server.example.com Accept: application/json Content-Type: application/x-www-form-urlencoded token=2YotnFZFEjr1zCsicMWpAA\u0026token_type_hint=access_token JWT 프로필 및 액세스 토큰 유형(RFC 9068):\nJWT를 OAuth 2.0 액세스 토큰으로 사용하기 위한 표준 프로필을 정의한다. 액세스 토큰에 포함되어야 하는 클레임과 검증 규칙을 명시한다. OAuth 2.1 OAuth 2.1은 현재 개발 중인 규격으로, OAuth 2.0의 개선 버전이다.\n주요 변경 사항은 다음과 같다:\n간소화: 덜 사용되거나 보안 이슈가 있는 권한 부여 흐름 제거(암시적 부여 등) PKCE 필수화: 모든 권한 코드 부여 흐름에서 PKCE 사용을 필수로 함 리다이렉션 URI 요구사항 강화: 더 엄격한 리다이렉션 URI 검증 모범 사례 통합: 여러 확장과 모범 사례를 핵심 사양에 통합 보안 권장사항 업데이트: 최신 위협 모델과 대응 방법 포함 OpenID Connect OpenID Connect(OIDC)는 OAuth 2.0 위에 구축된 인증 레이어로, 다음과 같은 특징이 있다:\nID 토큰: 사용자 인증 정보를 포함하는 JWT 형식의 토큰 UserInfo 엔드포인트: 사용자 프로필 정보를 검색하기 위한 표준 API 표준화된 범위: email, profile, address 등의 표준화된 정보 범위 디스커버리: 서비스 구성 정보를 자동으로 발견할 수 있는 메커니즘 세션 관리: 로그아웃 및 세션 상태 확인을 위한 표준 방법 OpenID Connect는 OAuth 2.0의 권한 부여(Authorization) 기능과 함께 인증(Authentication) 기능을 제공하여, 통합 인증 및 접근 제어 솔루션을 구현할 수 있게 한다.\nOAuth 2.0 구현 예제 다양한 프로그래밍 언어와 프레임워크에서 OAuth 2.0을 구현하는 방법을 살펴보면:\nNode.js 구현 예제 Express.js와 Passport.js를 사용한 OAuth 2.0 클라이언트 구현:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 const express = require('express'); const passport = require('passport'); const OAuth2Strategy = require('passport-oauth2'); const session = require('express-session'); const app = express(); // 세션 설정 app.use(session({ secret: 'your-secret-key', resave: false, saveUninitialized: false })); app.use(passport.initialize()); app.use(passport.session()); // OAuth 2.0 전략 설정 passport.use(new OAuth2Strategy({ authorizationURL: 'https://provider.example.com/oauth2/authorize', tokenURL: 'https://provider.example.com/oauth2/token', clientID: 'your-client-id', clientSecret: 'your-client-secret', callbackURL: 'http://localhost:3000/auth/callback', state: true }, function(accessToken, refreshToken, profile, cb) { // 액세스 토큰 저장 및 사용자 정보 검색 console.log('Access Token:', accessToken); console.log('Refresh Token:', refreshToken); // 데이터베이스에서 사용자 찾기 또는 생성 return cb(null, { id: '123', name: 'Example User' }); } )); // 사용자 직렬화/역직렬화 passport.serializeUser((user, done) =\u003e { done(null, user.id); }); passport.deserializeUser((id, done) =\u003e { // 실제 구현에서는 데이터베이스에서 사용자 조회 done(null, { id: id, name: 'Example User' }); }); // 로그인 라우트 app.get('/auth/login', passport.authenticate('oauth2')); // 콜백 라우트 app.get('/auth/callback', passport.authenticate('oauth2', { failureRedirect: '/login' }), function(req, res) { // 성공적인 인증 후 리다이렉트 res.redirect('/profile'); } ); // 프로필 라우트 app.get('/profile', isAuthenticated, (req, res) =\u003e { res.send(`Hello, ${req.user.name}!`); }); // 인증 미들웨어 function isAuthenticated(req, res, next) { if (req.isAuthenticated()) { return next(); } res.redirect('/auth/login'); } app.listen(3000, () =\u003e { console.log('Server started on port 3000'); }); Spring Boot 구현 예제 Spring Security OAuth2를 사용한 리소스 서버 구현:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.context.annotation.Bean; import org.springframework.security.config.annotation.web.builders.HttpSecurity; import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity; import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer; import org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfigurerAdapter; import org.springframework.security.oauth2.provider.token.TokenStore; import org.springframework.security.oauth2.provider.token.store.JwtTokenStore; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.RestController; import java.security.Principal; @SpringBootApplication @EnableResourceServer @EnableWebSecurity public class ResourceServerApplication extends ResourceServerConfigurerAdapter { public static void main(String[] args) { SpringApplication.run(ResourceServerApplication.class, args); } @Override public void configure(HttpSecurity http) throws Exception { http.authorizeRequests() .antMatchers(\"/api/**\").authenticated() .anyRequest().permitAll(); } @Bean public TokenStore tokenStore() { return new JwtTokenStore(accessTokenConverter()); } @Bean public JwtAccessTokenConverter accessTokenConverter() { JwtAccessTokenConverter converter = new JwtAccessTokenConverter(); converter.setSigningKey(\"your-signing-key\"); return converter; } } @RestController class UserController { @GetMapping(\"/api/user\") public Principal user(Principal principal) { return principal; } @GetMapping(\"/api/resource\") public String resource() { return \"Protected Resource\"; } } Python 구현 예제 Flask와 Authlib을 사용한 OAuth 2.0 클라이언트 구현:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 from flask import Flask, url_for, redirect, session, request from authlib.integrations.flask_client import OAuth import os app = Flask(__name__) app.secret_key = os.urandom(24) oauth = OAuth(app) oauth.register( name='example', client_id='your-client-id', client_secret='your-client-secret', access_token_url='https://provider.example.com/oauth2/token', access_token_params=None, authorize_url='https://provider.example.com/oauth2/authorize', authorize_params=None, api_base_url='https://api.example.com/', client_kwargs={'scope': 'profile email'}, ) @app.route('/') def homepage(): user = session.get('user') if user: return f'Hello {user[\"name\"]}!' return 'Login' @app.route('/login') def login(): redirect_uri = url_for('auth', _external=True) return oauth.example.authorize_redirect(redirect_uri) @app.route('/auth') def auth(): token = oauth.example.authorize_access_token() resp = oauth.example.get('userinfo') user_info = resp.json() # 사용자 정보를 세션에 저장 session['user'] = user_info return redirect('/') @app.route('/logout') def logout(): session.pop('user', None) return redirect('/') if __name__ == '__main__': app.run(debug=True) OAuth 2.0의 모범 사례 OAuth 2.0을 효과적이고 안전하게 구현하기 위한 모범 사례.\n일반적인 모범 사례 항상 TLS 사용: 모든 OAuth 2.0 통신은 TLS(HTTPS)를 통해 이루어져야 한다. 적절한 권한 부여 흐름 선택: 웹 서버 애플리케이션: 권한 부여 코드 부여 단일 페이지 애플리케이션(SPA): 권한 부여 코드 부여 + PKCE 모바일/데스크톱 앱: 권한 부여 코드 부여 + PKCE 서버 간 통신: 클라이언트 자격 증명 부여 토큰 수명 관리: 액세스 토큰: 짧은 수명(15분-1시간) 리프레시 토큰: 더 긴 수명, 필요 시 취소 가능 상태 파라미터 사용: 모든 권한 요청에 state 파라미터를 포함하여 CSRF 공격을 방지한다. 리다이렉션 URI 검증: 정확한 매칭을 통해 리다이렉션 URI를 검증한다. 클라이언트 측 모범 사례 안전한 토큰 저장: 웹 애플리케이션: HttpOnly, Secure, SameSite 쿠키 SPA: 메모리 저장(JavaScript 변수) 또는 안전한 쿠키 모바일 앱: 안전한 저장소(iOS Keychain, Android Keystore) PKCE 사용: 모든 공개 클라이언트는 PKCE를 사용해야 한다. 토큰 갱신 전략: 액세스 토큰 만료 전에 갱신하는 전략을 구현한다. 오류 처리: 토큰 만료, 취소 등의 오류 상황을 적절히 처리한다. 서버 측 모범 사례 클라이언트 검증: 클라이언트 등록 시 철저한 검증과 승인 절차를 수행한다. 범위 제한: 필요한 최소한의 범위만 허용한다. 토큰 서명 및 검증: JWT를 사용할 경우 강력한 서명 알고리즘(RS256 등)을 사용한다. 무차별 대입 공격 방지: 속도 제한, 계정 잠금 등의 방어 메커니즘을 구현한다. 토큰 취소 지원: 토큰 취소 엔드포인트와 취소 목록 관리를 구현한다. OAuth 2.0의 한계와 도전 과제 OAuth 2.0의 주요 한계와 도전 과제를 살펴보면:\n프레임워크의 복잡성 다양한 흐름: 여러 권한 부여 흐름이 존재하여 적절한 흐름을 선택하고 구현하는 데 복잡성이 증가한다. 확장의 파편화: 많은 확장과 프로필이 존재하여 상호 운용성 문제가 발생할 수 있다. 구현 차이: 다양한 OAuth 2.0 제공자 간의 구현 차이로 인해 통합이 어려울 수 있다. 보안 고려 사항 묵시적 흐름 문제: 원래 SPA용으로 설계된 묵시적 흐름은 여러 보안 취약점이 있어 현재는 사용이 권장되지 않는다. 피싱 취약성: 사용자가 가짜 권한 부여 화면을 구별하기 어려울 수 있다. 토큰 보안: 액세스 토큰이 노출될 경우 보호된 리소스에 무단 접근이 가능하다. 오픈 리다이렉터 문제: 부적절한 리다이렉션 URI 검증으로 인해 공격 가능성이 있다. 사용자 경험 문제 리다이렉션 기반: 리다이렉션 기반 흐름은 일부 환경(embedded 시스템, CLI 도구 등)에서 사용자 경험이 좋지 않을 수 있다. 동의 피로(Consent Fatigue): 사용자가 너무 많은 동의 화면에 노출되면 내용을 제대로 읽지 않고 승인하는 경향이 있다. 인증서버 종속성: 인증 서버가 다운되면 모든 클라이언트가 영향을 받는다. 용어 정리 용어 설명 참고 및 출처 ","wordCount":"2734","inLanguage":"en","image":"https://buenhyden.github.io/images","datePublished":"2025-02-28T11:28:00Z","dateModified":"2025-02-28T11:28:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://buenhyden.github.io/posts/backend/api-design/authentication-methods/oauth/rfc-6749/"},"publisher":{"@type":"Organization","name":"hyunyoun's Blog","logo":{"@type":"ImageObject","url":"https://buenhyden.github.io/favicons/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>posts</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend/>Backend</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend/api-design/>APIs</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend/api-design/authentication-methods/>Authentication Methods</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend/api-design/authentication-methods/oauth/>OAuth</a></div><h1 class="post-title entry-hint-parent">RFC 6749</h1><div class=post-description>RFC 6749는 OAuth 2.0 권한 부여 프레임워크(The OAuth 2.0 Authorization Framework)를 정의하는 인터넷 표준 문서이다.</div><div class=post-meta><span title='2025-02-28 11:28:00 +0000 UTC'>February 28, 2025</span>&nbsp;·&nbsp;13 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/buenhyden/blog-data/main/content/posts/Backend/API%20Design/Authentication%20Methods/OAuth/rfc-6749.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#rfc-6749>RFC 6749</a><ul><li><a href=#oauth-20의-기본-개념과-용어>OAuth 2.0의 기본 개념과 용어</a></li><li><a href=#oauth-20-권한-부여-흐름-상세-분석>OAuth 2.0 권한 부여 흐름 상세 분석</a></li><li><a href=#토큰과-범위scopes>토큰과 범위(Scopes)</a></li><li><a href=#oauth-20의-보안-고려사항>OAuth 2.0의 보안 고려사항</a></li><li><a href=#oauth-20-확장과-후속-발전>OAuth 2.0 확장과 후속 발전</a></li><li><a href=#oauth-20-구현-예제>OAuth 2.0 구현 예제</a></li><li><a href=#oauth-20의-모범-사례>OAuth 2.0의 모범 사례</a></li><li><a href=#oauth-20의-한계와-도전-과제>OAuth 2.0의 한계와 도전 과제</a></li></ul></li><li><a href=#용어-정리>용어 정리</a></li><li><a href=#참고-및-출처>참고 및 출처</a></li></ul></nav></div></details></div><div class=post-content><h2 id=rfc-6749>RFC 6749<a hidden class=anchor aria-hidden=true href=#rfc-6749>#</a></h2><p>RFC 6749는 OAuth 2.0 권한 부여 프레임워크(The OAuth 2.0 Authorization Framework)를 정의하는 인터넷 표준 문서이다. 이 문서는 2012년 10월에 인터넷 표준화 기구인 IETF(Internet Engineering Task Force)에 의해 발행되었다. 주 저자는 Dick Hardt이며, 여러 기술 전문가들의 협업으로 만들어졌다.</p><p>OAuth 2.0은 이전 버전인 OAuth 1.0(RFC 5849)의 후속 버전으로, 다양한 웹 애플리케이션, 데스크톱 애플리케이션, 모바일 애플리케이션 및 IoT 장치에서 안전한 권한 위임을 가능하게 하는 프로토콜이다. 간단히 말해, OAuth 2.0은 사용자가 자신의 비밀번호를 공유하지 않고도 제3자 애플리케이션에 자신의 데이터에 대한 제한된 접근 권한을 부여할 수 있도록 해주는 프레임워크이다.</p><p>OAuth 1.0에서 OAuth 2.0으로의 전환은 단순한 버전 업그레이드가 아닌 완전한 재설계였다. OAuth 2.0은 OAuth 1.0보다 구현이 더 간단하고, 모바일 애플리케이션과 같은 다양한 클라이언트 유형을 더 잘 지원하며, 더 나은 확장성을 제공한다. 그러나 이런 단순화는 보안 모델의 변화도 수반했다.</p><h3 id=oauth-20의-기본-개념과-용어>OAuth 2.0의 기본 개념과 용어<a hidden class=anchor aria-hidden=true href=#oauth-20의-기본-개념과-용어>#</a></h3><p>OAuth 2.0을 이해하기 위해서는 먼저 다음과 같은 핵심 용어와 개념을 이해해야 한다:</p><h4 id=주요-역할roles>주요 역할(Roles)<a hidden class=anchor aria-hidden=true href=#주요-역할roles>#</a></h4><p>OAuth 2.0 프레임워크에는 네 가지 주요 역할이 있다:</p><ol><li><strong>리소스 소유자(Resource Owner)</strong>: 보호된 리소스에 접근 권한을 부여할 수 있는 엔티티로, 일반적으로 최종 사용자이다. 예를 들어, 자신의 Google 계정 데이터에 접근 권한을 부여하는 사용자이다.</li><li><strong>리소스 서버(Resource Server)</strong>: 보호된 리소스를 호스팅하는 서버로, 액세스 토큰을 사용하여 보호된 리소스 요청을 수락하고 응답할 수 있다. 예를 들어, Google의 API 서버가 이에 해당한다.</li><li><strong>클라이언트(Client)</strong>: 리소스 소유자의 권한으로 보호된 리소스에 접근을 요청하는 애플리케이션이다. 예를 들어, 사용자의 Google 계정에 접근하려는 제3자 애플리케이션이 이에 해당한다.</li><li><strong>권한 부여 서버(Authorization Server)</strong>: 리소스 소유자를 인증하고 권한을 얻은 후 클라이언트에게 액세스 토큰을 발급하는 서버이다. 예를 들어, Google의 OAuth 서버가 이에 해당한다.</li></ol><h4 id=토큰tokens>토큰(Tokens)<a hidden class=anchor aria-hidden=true href=#토큰tokens>#</a></h4><p>OAuth 2.0은 두 가지 주요 토큰 유형을 사용한다:</p><ol><li><strong>액세스 토큰(Access Token)</strong>: 보호된 리소스에 접근하기 위한 자격 증명으로, 일반적으로 문자열 형태이다. 이 토큰은 리소스 소유자가 클라이언트에게 부여한 권한 범위, 기간 등의 정보를 나타낸다.</li><li><strong>리프레시 토큰(Refresh Token)</strong>: 액세스 토큰이 만료된 후 새 액세스 토큰을 얻기 위해 사용되는 자격 증명이다. 액세스 토큰보다 일반적으로 수명이 길고, 경우에 따라 발급되지 않을 수도 있다.</li></ol><h4 id=클라이언트-유형>클라이언트 유형<a hidden class=anchor aria-hidden=true href=#클라이언트-유형>#</a></h4><p>OAuth 2.0은 다양한 클라이언트 유형을 지원한다:</p><ol><li><strong>기밀 클라이언트(Confidential Client)</strong>: 클라이언트 자격 증명(비밀)을 안전하게 보관할 수 있는 클라이언트로, 일반적으로 웹 서버에서 실행되는 애플리케이션이다.</li><li><strong>공개 클라이언트(Public Client)</strong>: 클라이언트 자격 증명을 안전하게 보관할 수 없는 클라이언트로, 일반적으로 브라우저에서 실행되는 JavaScript 애플리케이션이나 모바일 앱이 이에 해당한다.</li></ol><h4 id=권한-부여-유형grant-types>권한 부여 유형(Grant Types)<a hidden class=anchor aria-hidden=true href=#권한-부여-유형grant-types>#</a></h4><p>RFC 6749는 다양한 사용 사례를 지원하기 위해 네 가지 기본 권한 부여 유형을 정의한다:</p><ol><li><strong>권한 부여 코드(Authorization Code)</strong>: 클라이언트가 권한 부여 서버로부터 권한 부여 코드를 얻은 다음, 이 코드를 액세스 토큰으로 교환하는 방식이다. 이는 서버 사이드 웹 애플리케이션에 가장 적합하다.</li><li><strong>암시적 부여(Implicit)</strong>: 간소화된 권한 부여 코드 흐름으로, 권한 부여 코드 없이 액세스 토큰을 직접 발급받는다. 주로 브라우저 내 JavaScript 애플리케이션에 사용된다.</li><li><strong>리소스 소유자 비밀번호 자격 증명(Resource Owner Password Credentials)</strong>: 리소스 소유자의 자격 증명(아이디/비밀번호)을 클라이언트가 직접 사용하여 액세스 토큰을 얻는 방식이다. 높은 수준의 신뢰가 필요하며, 다른 방식이 불가능할 때만 사용해야 한다.</li><li><strong>클라이언트 자격 증명(Client Credentials)</strong>: 클라이언트가 자신의 자격 증명만을 사용하여 액세스 토큰을 얻는 방식으로, 클라이언트가 리소스 소유자를 대신하지 않고 자체적으로 리소스에 접근할 때 사용한다.</li></ol><h3 id=oauth-20-권한-부여-흐름-상세-분석>OAuth 2.0 권한 부여 흐름 상세 분석<a hidden class=anchor aria-hidden=true href=#oauth-20-권한-부여-흐름-상세-분석>#</a></h3><h4 id=권한-부여-코드-부여authorization-code-grant>권한 부여 코드 부여(Authorization Code Grant)<a hidden class=anchor aria-hidden=true href=#권한-부여-코드-부여authorization-code-grant>#</a></h4><p>이 흐름은 웹 애플리케이션과 같은 기밀 클라이언트에 가장 적합하며, 다음과 같은 단계로 진행된다.</p><ol><li><p><strong>권한 요청</strong>: 클라이언트는 사용자를 권한 부여 서버로 리다이렉트하여 권한을 요청한다.</p><pre class=mermaid>GET /authorize?
response_type=code&amp;
client_id=s6BhdRkqt3&amp;
state=xyz&amp;
redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb
</pre></li><li><p><strong>사용자 인증 및 권한 부여</strong>: 권한 부여 서버는 사용자를 인증하고 클라이언트 요청에 대한 허가를 요청한다.</p></li><li><p><strong>권한 부여 코드 발급</strong>: 사용자가 권한을 부여하면, 권한 부여 서버는 클라이언트로 권한 부여 코드와 함께 사용자를 리다이렉트한다.</p><pre class=mermaid>HTTP/1.1 302 Found
Location: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA&amp;state=xyz
</pre></li><li><p><strong>액세스 토큰 요청</strong>: 클라이언트는 권한 부여 코드를 사용하여 액세스 토큰을 요청한다.</p><pre class=mermaid>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=SplxlOBeZQQYbYS6WxSbIA&amp;
redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb&amp;
client_id=s6BhdRkqt3&amp;
client_secret=7Fjfp0ZBr1KtDRbnfVdmIw
</pre></li><li><p><strong>액세스 토큰 발급</strong>: 권한 부여 서버는 클라이언트의 신원을 확인하고 권한 부여 코드를 검증한 후, 액세스 토큰과 선택적으로 리프레시 토큰을 발급한다.</p><pre class=mermaid>HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  &#34;access_token&#34;:&#34;2YotnFZFEjr1zCsicMWpAA&#34;,
  &#34;token_type&#34;:&#34;bearer&#34;,
  &#34;expires_in&#34;:3600,
  &#34;refresh_token&#34;:&#34;tGzv3JOkF0XG5Qx2TlKWIA&#34;,
  &#34;example_parameter&#34;:&#34;example_value&#34;
}
</pre></li></ol><p>이 흐름의 주요 장점은 높은 보안성과 리프레시 토큰 지원이다. 클라이언트 비밀이 사용자에게 노출되지 않고, 액세스 토큰도 프론트 채널(브라우저)을 통해 전달되지 않는다.</p><h4 id=암시적-부여implicit-grant>암시적 부여(Implicit Grant)<a hidden class=anchor aria-hidden=true href=#암시적-부여implicit-grant>#</a></h4><p>이 흐름은 브라우저 기반 애플리케이션(SPA)과 같은 공개 클라이언트에 적합하며, 다음과 같은 단계로 진행된다:</p><ol><li><p><strong>권한 요청</strong>: 클라이언트는 사용자를 권한 부여 서버로 리다이렉트한다. 이때 <code>response_type=token</code>으로 설정한다.</p><pre class=mermaid>GET /authorize?
response_type=token&amp;
client_id=s6BhdRkqt3&amp;
state=xyz&amp;
redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb
</pre></li><li><p><strong>사용자 인증 및 권한 부여</strong>: 권한 부여 서버는 사용자를 인증하고 권한을 요청한다.</p></li><li><p><strong>토큰 발급</strong>: 사용자가 권한을 부여하면, 권한 부여 서버는 액세스 토큰을 URI 프래그먼트에 포함시켜 클라이언트로 사용자를 리다이렉트한다.</p><pre class=mermaid>HTTP/1.1 302 Found
Location: https://client.example.com/cb#access_token=2YotnFZFEjr1zCsicMWpAA&amp;state=xyz&amp;token_type=bearer&amp;expires_in=3600
</pre></li><li><p><strong>토큰 사용</strong>: 클라이언트는 URI 프래그먼트에서 액세스 토큰을 추출하여 보호된 리소스에 접근하는 데 사용한다.</p></li></ol><p>이 흐름은 권한 부여 코드 흐름보다 단순하지만, 보안 측면에서 몇 가지 단점이 있다. 액세스 토큰이 브라우저를 통해 전달되므로 노출 위험이 있으며, 리프레시 토큰을 지원하지 않는다.</p><h4 id=리소스-소유자-비밀번호-자격-증명-부여resource-owner-password-credentials-grant>리소스 소유자 비밀번호 자격 증명 부여(Resource Owner Password Credentials Grant)<a hidden class=anchor aria-hidden=true href=#리소스-소유자-비밀번호-자격-증명-부여resource-owner-password-credentials-grant>#</a></h4><p>이 흐름은 클라이언트가 리소스 소유자의 자격 증명을 직접 수집하여 액세스 토큰을 얻는 방식이다:</p><ol><li><p><strong>자격 증명 수집</strong>: 클라이언트는 리소스 소유자로부터 직접 사용자 이름과 비밀번호를 획득한다.</p></li><li><p><strong>토큰 요청</strong>: 클라이언트는 이 자격 증명을 사용하여 권한 부여 서버에 액세스 토큰을 요청한다.</p><pre class=mermaid>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=password&amp;
username=johndoe&amp;
password=A3ddj3w&amp;
client_id=s6BhdRkqt3&amp;
client_secret=7Fjfp0ZBr1KtDRbnfVdmIw
</pre></li><li><p><strong>토큰 발급</strong>: 권한 부여 서버는 자격 증명을 검증하고 액세스 토큰을 발급한다.</p></li></ol><p>이 방식은 리소스 소유자와 클라이언트 간에 높은 신뢰가 있을 때만 사용해야 한다. 예를 들어, 운영 체제 내장 클라이언트나 높은 권한을 가진 애플리케이션에 적합하다.</p><h4 id=클라이언트-자격-증명-부여client-credentials-grant>클라이언트 자격 증명 부여(Client Credentials Grant)<a hidden class=anchor aria-hidden=true href=#클라이언트-자격-증명-부여client-credentials-grant>#</a></h4><p>이 흐름은 클라이언트가 자신의 자격 증명만을 사용하여 액세스 토큰을 얻는 방식이다:</p><ol><li><p><strong>토큰 요청</strong>: 클라이언트는 자신의 자격 증명을 사용하여 권한 부여 서버에 액세스 토큰을 요청한다.</p><pre class=mermaid>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=client_credentials&amp;
client_id=s6BhdRkqt3&amp;
client_secret=7Fjfp0ZBr1KtDRbnfVdmIw
</pre></li><li><p><strong>토큰 발급</strong>: 권한 부여 서버는 클라이언트 자격 증명을 검증하고 액세스 토큰을 발급한다.</p></li></ol><p>이 흐름은 리소스 소유자의 컨텍스트가 없는 클라이언트-서버 간 통신에 적합하다. 예를 들어, 백그라운드 서비스나 마이크로서비스 간 통신에 사용된다.</p><h3 id=토큰과-범위scopes>토큰과 범위(Scopes)<a hidden class=anchor aria-hidden=true href=#토큰과-범위scopes>#</a></h3><h4 id=액세스-토큰access-token>액세스 토큰(Access Token)<a hidden class=anchor aria-hidden=true href=#액세스-토큰access-token>#</a></h4><p>액세스 토큰은 보호된 리소스에 접근하기 위한 자격 증명으로, 다음과 같은 특성을 가진다:</p><ol><li><p><strong>형식</strong>: RFC 6749는 토큰 형식을 명시하지 않으며, 구현에 따라 다양한 형식(불투명 문자열, JWT 등)이 사용된다.</p></li><li><p><strong>전달 방식</strong>: 주로 HTTP Authorization 헤더를 통해 전달되며, 형식은 일반적으로 &ldquo;Bearer&rdquo; 토큰 유형을 사용한(RFC 6750).</p><pre class=mermaid>GET /resource HTTP/1.1
Host: server.example.com
Authorization: Bearer 2YotnFZFEjr1zCsicMWpAA
</pre></li><li><p><strong>수명</strong>: 액세스 토큰은 일반적으로 짧은 수명(몇 분에서 몇 시간)을 가지며, 이는 토큰 노출 시 위험을 줄이기 위함이다.</p></li></ol><h4 id=리프레시-토큰refresh-token>리프레시 토큰(Refresh Token)<a hidden class=anchor aria-hidden=true href=#리프레시-토큰refresh-token>#</a></h4><p>리프레시 토큰은 새로운 액세스 토큰을 얻기 위해 사용되며, 다음과 같은 특성을 가진다:</p><ol><li><p><strong>용도</strong>: 액세스 토큰이 만료된 후 사용자를 다시 인증하지 않고도 새 액세스 토큰을 발급받을 수 있다.</p></li><li><p><strong>보안</strong>: 리프레시 토큰은 액세스 토큰보다 더 민감하므로, 클라이언트는 이를 안전하게 저장해야 한다.</p></li><li><p><strong>갱신 프로세스</strong>: 클라이언트는 리프레시 토큰을 사용하여 다음과 같이 새 액세스 토큰을 요청한다.</p><pre class=mermaid>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&amp;
refresh_token=tGzv3JOkF0XG5Qx2TlKWIA&amp;
client_id=s6BhdRkqt3&amp;
client_secret=7Fjfp0ZBr1KtDRbnfVdmIw
</pre></li><li><p><strong>갱신 토큰 순환(Rotation)</strong>: 보안 강화를 위해 새 액세스 토큰을 발급할 때 새 리프레시 토큰도 함께 발급하는 방식으로, 이전 리프레시 토큰은 무효화된다.</p></li></ol><h4 id=범위scopes>범위(Scopes)<a hidden class=anchor aria-hidden=true href=#범위scopes>#</a></h4><p>범위는 액세스 토큰이 부여하는 권한의 범위를 제한하는 메커니즘이다:</p><ol><li><p><strong>정의</strong>: 범위는 일반적으로 공백으로 구분된 문자열 목록으로 표현된다. 예: <code>scope=read_profile edit_profile read_contacts</code></p></li><li><p><strong>요청</strong>: 클라이언트는 권한 요청 시 필요한 범위를 지정할 수 있다.</p><pre class=mermaid>GET /authorize?
response_type=code&amp;
client_id=s6BhdRkqt3&amp;
state=xyz&amp;
redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb&amp;
scope=read_profile%20read_contacts
</pre></li><li><p><strong>동의 화면</strong>: 권한 부여 서버는 요청된 범위에 기반하여 사용자에게 동의 화면을 제시한다.</p></li><li><p><strong>토큰 응답</strong>: 발급된 토큰의 범위는 응답에 포함될 수 있으며, 요청된 범위보다 좁을 수 있다.</p><pre class=mermaid>{
  &#34;access_token&#34;:&#34;2YotnFZFEjr1zCsicMWpAA&#34;,
  &#34;token_type&#34;:&#34;bearer&#34;,
  &#34;expires_in&#34;:3600,
  &#34;refresh_token&#34;:&#34;tGzv3JOkF0XG5Qx2TlKWIA&#34;,
  &#34;scope&#34;:&#34;read_profile read_contacts&#34;
}
</pre></li><li><p><strong>범위 확인</strong>: 리소스 서버는 액세스 토큰과 관련된 범위를 확인하여 요청된 리소스에 접근할 권한이 있는지 판단한다.</p></li></ol><h3 id=oauth-20의-보안-고려사항>OAuth 2.0의 보안 고려사항<a hidden class=anchor aria-hidden=true href=#oauth-20의-보안-고려사항>#</a></h3><p>RFC 6749는 OAuth 2.0 구현 시 고려해야 할 다양한 보안 측면을 다루고 있다.</p><h4 id=클라이언트-인증>클라이언트 인증<a hidden class=anchor aria-hidden=true href=#클라이언트-인증>#</a></h4><p>클라이언트 인증은 권한 부여 서버가 토큰을 요청하는 클라이언트의 신원을 확인하는 과정이다:</p><ol><li><p><strong>클라이언트 비밀(Client Secret)</strong>: 기밀 클라이언트는 권한 부여 서버에 등록 시 받은 비밀을 사용하여 인증한다.</p></li><li><p><strong>인증 방법</strong>:</p><ul><li>HTTP Basic 인증</li></ul><pre class=mermaid>Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
</pre><ul><li>요청 본문 파라미터</li></ul><pre class=mermaid>client_id=s6BhdRkqt3&amp;client_secret=gX1fBat3bV
</pre></li><li><p><strong>공개 클라이언트</strong>: 공개 클라이언트는 클라이언트 비밀을 안전하게 보관할 수 없으므로, 대안적인 인증 메커니즘(예: PKCE)이 권장된다.</p></li></ol><h4 id=권한-코드와-액세스-토큰-보호>권한 코드와 액세스 토큰 보호<a hidden class=anchor aria-hidden=true href=#권한-코드와-액세스-토큰-보호>#</a></h4><p>권한 코드와 액세스 토큰을 보호하기 위한 고려사항:</p><ol><li><strong>수명 제한</strong>: 권한 코드는 매우 짧은 수명(일반적으로 몇 분)을 가져야 하며, 한 번만 사용 가능해야 한다.</li><li><strong>토큰 기밀성</strong>: 액세스 토큰은 권한이 없는 당사자에게 노출되지 않도록 해야 한다.</li><li><strong>TLS 사용</strong>: 모든 토큰 교환은 TLS(Transport Layer Security)를 통해 이루어져야 한다.</li><li><strong>리다이렉션 URI 검증</strong>: 권한 부여 서버는 클라이언트로부터 받은 리다이렉션 URI가 등록된 URI와 정확히 일치하는지 확인해야 한다.</li></ol><h4 id=일반적인-보안-위협과-대응>일반적인 보안 위협과 대응<a hidden class=anchor aria-hidden=true href=#일반적인-보안-위협과-대응>#</a></h4><p>OAuth 2.0 구현에서 고려해야 할 주요 보안 위협:</p><ol><li><p><strong>CSRF(Cross-Site Request Forgery)</strong>:</p><ul><li>위협: 공격자가 사용자를 속여 의도하지 않은 권한 부여 요청을 수행하게 할 수 있다.</li><li>대응: 클라이언트는 권한 요청 시 <code>state</code> 파라미터를 사용하여 CSRF 공격을 방지해야 한다.</li></ul><pre class=mermaid>GET /authorize?response_type=code&amp;client_id=s6BhdRkqt3&amp;state=xyz&amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb
</pre></li><li><p><strong>리다이렉션 URI 조작</strong>:</p><ul><li>위협: 공격자가 권한 코드나 액세스 토큰을 자신의 서버로 리다이렉트할 수 있다.</li><li>대응: 권한 부여 서버는 리다이렉션 URI를 엄격하게 검증해야 한다.</li></ul></li><li><p><strong>토큰 탈취</strong>:</p><ul><li>위협: 액세스 토큰이 노출되면 공격자가 보호된 리소스에 접근할 수 있다.</li><li>대응: 짧은 토큰 수명, TLS 사용, 토큰 저장 시 보안 조치 적용 등</li></ul></li><li><p><strong>클라이언트 가장(Impersonation)</strong>:</p><ul><li>위협: 공격자가 합법적인 클라이언트인 것처럼 가장할 수 있다.</li><li>대응: 안전한 클라이언트 등록 및 인증 절차 구현</li></ul></li></ol><h4 id=pkceproof-key-for-code-exchange>PKCE(Proof Key for Code Exchange)<a hidden class=anchor aria-hidden=true href=#pkceproof-key-for-code-exchange>#</a></h4><p>PKCE는 RFC 7636에서 정의된 확장으로, 공개 클라이언트를 위한 보안 강화 메커니즘이다:</p><ol><li><p><strong>목적</strong>: 권한 코드 가로채기 공격으로부터 보호한다.</p></li><li><p><strong>작동 방식</strong>:</p><ul><li>클라이언트는 랜덤 문자열(code_verifier)을 생성한다.</li><li>이 문자열의 해시(code_challenge)를 계산한다.</li><li>권한 요청 시 code_challenge와 code_challenge_method(S256 또는 plain)를 포함한다.</li><li>토큰 교환 시 원래의 code_verifier를 제공한다.</li><li>권한 부여 서버는 code_verifier의 해시가 이전에 받은 code_challenge와 일치하는지 확인한다.</li></ul></li><li><p><strong>구현 예</strong>:</p><pre class=mermaid># 권한 요청
GET /authorize?
response_type=code&amp;
client_id=s6BhdRkqt3&amp;
state=xyz&amp;
redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb&amp;
code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM&amp;
code_challenge_method=S256

# 토큰 요청
POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=SplxlOBeZQQYbYS6WxSbIA&amp;
redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb&amp;
client_id=s6BhdRkqt3&amp;
code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk
</pre></li></ol><h3 id=oauth-20-확장과-후속-발전>OAuth 2.0 확장과 후속 발전<a hidden class=anchor aria-hidden=true href=#oauth-20-확장과-후속-발전>#</a></h3><p>RFC 6749 발표 이후, OAuth 2.0 생태계는 다양한 확장과 개선을 통해 발전해왔다.</p><h4 id=주요-확장-표준>주요 확장 표준<a hidden class=anchor aria-hidden=true href=#주요-확장-표준>#</a></h4><ol><li><p><strong>Bearer Token Usage (RFC 6750)</strong>:</p><ul><li>액세스 토큰을 HTTP 요청에 포함시키는 방법을 정의한다.</li><li>Authorization 헤더, 폼 인코딩 바디 파라미터, URI 쿼리 파라미터 등 방법을 명시한다.</li></ul></li><li><p><strong>Token Revocation (RFC 7009)</strong>:</p><ul><li>클라이언트가 더 이상 필요하지 않거나 손상된 것으로 의심되는 토큰을 취소하는 방법을 정의한다.</li></ul><pre class=mermaid>POST /revoke HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

token=45ghiukldjahdnhzdauz&amp;token_type_hint=refresh_token
</pre></li><li><p><strong>Dynamic Client Registration (RFC 7591)</strong>:</p><ul><li>클라이언트가 권한 부여 서버에 자동으로 등록하고 필요한 정보를 얻는 방법을 정의한다.</li></ul></li><li><p><strong>JWT for OAuth 2.0 Client Authentication (RFC 7523)</strong>:</p><ul><li>JSON Web Token(JWT)을 사용하여 OAuth 2.0 클라이언트를 인증하는 방법을 정의한다.</li><li>클라이언트 비밀 대신 JWT를 사용하여 클라이언트 인증을 가능하게 한다.</li></ul></li><li><p><strong>Token Introspection (RFC 7662)</strong>:</p><ul><li>리소스 서버가 권한 부여 서버에 토큰의 상태와 메타데이터를 질의할 수 있는 방법을 정의한다.</li></ul><pre class=mermaid>POST /introspect HTTP/1.1
Host: server.example.com
Accept: application/json
Content-Type: application/x-www-form-urlencoded

token=2YotnFZFEjr1zCsicMWpAA&amp;token_type_hint=access_token
</pre></li><li><p><strong>JWT 프로필 및 액세스 토큰 유형(RFC 9068)</strong>:</p><ul><li>JWT를 OAuth 2.0 액세스 토큰으로 사용하기 위한 표준 프로필을 정의한다.</li><li>액세스 토큰에 포함되어야 하는 클레임과 검증 규칙을 명시한다.</li></ul></li></ol><h4 id=oauth-21>OAuth 2.1<a hidden class=anchor aria-hidden=true href=#oauth-21>#</a></h4><p>OAuth 2.1은 현재 개발 중인 규격으로, OAuth 2.0의 개선 버전이다.</p><p>주요 변경 사항은 다음과 같다:</p><ol><li><strong>간소화</strong>: 덜 사용되거나 보안 이슈가 있는 권한 부여 흐름 제거(암시적 부여 등)</li><li><strong>PKCE 필수화</strong>: 모든 권한 코드 부여 흐름에서 PKCE 사용을 필수로 함</li><li><strong>리다이렉션 URI 요구사항 강화</strong>: 더 엄격한 리다이렉션 URI 검증</li><li><strong>모범 사례 통합</strong>: 여러 확장과 모범 사례를 핵심 사양에 통합</li><li><strong>보안 권장사항 업데이트</strong>: 최신 위협 모델과 대응 방법 포함</li></ol><h4 id=openid-connect>OpenID Connect<a hidden class=anchor aria-hidden=true href=#openid-connect>#</a></h4><p>OpenID Connect(OIDC)는 OAuth 2.0 위에 구축된 인증 레이어로, 다음과 같은 특징이 있다:</p><ol><li><strong>ID 토큰</strong>: 사용자 인증 정보를 포함하는 JWT 형식의 토큰</li><li><strong>UserInfo 엔드포인트</strong>: 사용자 프로필 정보를 검색하기 위한 표준 API</li><li><strong>표준화된 범위</strong>: email, profile, address 등의 표준화된 정보 범위</li><li><strong>디스커버리</strong>: 서비스 구성 정보를 자동으로 발견할 수 있는 메커니즘</li><li><strong>세션 관리</strong>: 로그아웃 및 세션 상태 확인을 위한 표준 방법</li></ol><p>OpenID Connect는 OAuth 2.0의 권한 부여(Authorization) 기능과 함께 인증(Authentication) 기능을 제공하여, 통합 인증 및 접근 제어 솔루션을 구현할 수 있게 한다.</p><h3 id=oauth-20-구현-예제>OAuth 2.0 구현 예제<a hidden class=anchor aria-hidden=true href=#oauth-20-구현-예제>#</a></h3><p>다양한 프로그래밍 언어와 프레임워크에서 OAuth 2.0을 구현하는 방법을 살펴보면:</p><h4 id=nodejs-구현-예제>Node.js 구현 예제<a hidden class=anchor aria-hidden=true href=#nodejs-구현-예제>#</a></h4><p>Express.js와 Passport.js를 사용한 OAuth 2.0 클라이언트 구현:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-18-1><a class=lnlinks href=#hl-18-1> 1</a>
</span><span class=lnt id=hl-18-2><a class=lnlinks href=#hl-18-2> 2</a>
</span><span class=lnt id=hl-18-3><a class=lnlinks href=#hl-18-3> 3</a>
</span><span class=lnt id=hl-18-4><a class=lnlinks href=#hl-18-4> 4</a>
</span><span class=lnt id=hl-18-5><a class=lnlinks href=#hl-18-5> 5</a>
</span><span class=lnt id=hl-18-6><a class=lnlinks href=#hl-18-6> 6</a>
</span><span class=lnt id=hl-18-7><a class=lnlinks href=#hl-18-7> 7</a>
</span><span class=lnt id=hl-18-8><a class=lnlinks href=#hl-18-8> 8</a>
</span><span class=lnt id=hl-18-9><a class=lnlinks href=#hl-18-9> 9</a>
</span><span class=lnt id=hl-18-10><a class=lnlinks href=#hl-18-10>10</a>
</span><span class=lnt id=hl-18-11><a class=lnlinks href=#hl-18-11>11</a>
</span><span class=lnt id=hl-18-12><a class=lnlinks href=#hl-18-12>12</a>
</span><span class=lnt id=hl-18-13><a class=lnlinks href=#hl-18-13>13</a>
</span><span class=lnt id=hl-18-14><a class=lnlinks href=#hl-18-14>14</a>
</span><span class=lnt id=hl-18-15><a class=lnlinks href=#hl-18-15>15</a>
</span><span class=lnt id=hl-18-16><a class=lnlinks href=#hl-18-16>16</a>
</span><span class=lnt id=hl-18-17><a class=lnlinks href=#hl-18-17>17</a>
</span><span class=lnt id=hl-18-18><a class=lnlinks href=#hl-18-18>18</a>
</span><span class=lnt id=hl-18-19><a class=lnlinks href=#hl-18-19>19</a>
</span><span class=lnt id=hl-18-20><a class=lnlinks href=#hl-18-20>20</a>
</span><span class=lnt id=hl-18-21><a class=lnlinks href=#hl-18-21>21</a>
</span><span class=lnt id=hl-18-22><a class=lnlinks href=#hl-18-22>22</a>
</span><span class=lnt id=hl-18-23><a class=lnlinks href=#hl-18-23>23</a>
</span><span class=lnt id=hl-18-24><a class=lnlinks href=#hl-18-24>24</a>
</span><span class=lnt id=hl-18-25><a class=lnlinks href=#hl-18-25>25</a>
</span><span class=lnt id=hl-18-26><a class=lnlinks href=#hl-18-26>26</a>
</span><span class=lnt id=hl-18-27><a class=lnlinks href=#hl-18-27>27</a>
</span><span class=lnt id=hl-18-28><a class=lnlinks href=#hl-18-28>28</a>
</span><span class=lnt id=hl-18-29><a class=lnlinks href=#hl-18-29>29</a>
</span><span class=lnt id=hl-18-30><a class=lnlinks href=#hl-18-30>30</a>
</span><span class=lnt id=hl-18-31><a class=lnlinks href=#hl-18-31>31</a>
</span><span class=lnt id=hl-18-32><a class=lnlinks href=#hl-18-32>32</a>
</span><span class=lnt id=hl-18-33><a class=lnlinks href=#hl-18-33>33</a>
</span><span class=lnt id=hl-18-34><a class=lnlinks href=#hl-18-34>34</a>
</span><span class=lnt id=hl-18-35><a class=lnlinks href=#hl-18-35>35</a>
</span><span class=lnt id=hl-18-36><a class=lnlinks href=#hl-18-36>36</a>
</span><span class=lnt id=hl-18-37><a class=lnlinks href=#hl-18-37>37</a>
</span><span class=lnt id=hl-18-38><a class=lnlinks href=#hl-18-38>38</a>
</span><span class=lnt id=hl-18-39><a class=lnlinks href=#hl-18-39>39</a>
</span><span class=lnt id=hl-18-40><a class=lnlinks href=#hl-18-40>40</a>
</span><span class=lnt id=hl-18-41><a class=lnlinks href=#hl-18-41>41</a>
</span><span class=lnt id=hl-18-42><a class=lnlinks href=#hl-18-42>42</a>
</span><span class=lnt id=hl-18-43><a class=lnlinks href=#hl-18-43>43</a>
</span><span class=lnt id=hl-18-44><a class=lnlinks href=#hl-18-44>44</a>
</span><span class=lnt id=hl-18-45><a class=lnlinks href=#hl-18-45>45</a>
</span><span class=lnt id=hl-18-46><a class=lnlinks href=#hl-18-46>46</a>
</span><span class=lnt id=hl-18-47><a class=lnlinks href=#hl-18-47>47</a>
</span><span class=lnt id=hl-18-48><a class=lnlinks href=#hl-18-48>48</a>
</span><span class=lnt id=hl-18-49><a class=lnlinks href=#hl-18-49>49</a>
</span><span class=lnt id=hl-18-50><a class=lnlinks href=#hl-18-50>50</a>
</span><span class=lnt id=hl-18-51><a class=lnlinks href=#hl-18-51>51</a>
</span><span class=lnt id=hl-18-52><a class=lnlinks href=#hl-18-52>52</a>
</span><span class=lnt id=hl-18-53><a class=lnlinks href=#hl-18-53>53</a>
</span><span class=lnt id=hl-18-54><a class=lnlinks href=#hl-18-54>54</a>
</span><span class=lnt id=hl-18-55><a class=lnlinks href=#hl-18-55>55</a>
</span><span class=lnt id=hl-18-56><a class=lnlinks href=#hl-18-56>56</a>
</span><span class=lnt id=hl-18-57><a class=lnlinks href=#hl-18-57>57</a>
</span><span class=lnt id=hl-18-58><a class=lnlinks href=#hl-18-58>58</a>
</span><span class=lnt id=hl-18-59><a class=lnlinks href=#hl-18-59>59</a>
</span><span class=lnt id=hl-18-60><a class=lnlinks href=#hl-18-60>60</a>
</span><span class=lnt id=hl-18-61><a class=lnlinks href=#hl-18-61>61</a>
</span><span class=lnt id=hl-18-62><a class=lnlinks href=#hl-18-62>62</a>
</span><span class=lnt id=hl-18-63><a class=lnlinks href=#hl-18-63>63</a>
</span><span class=lnt id=hl-18-64><a class=lnlinks href=#hl-18-64>64</a>
</span><span class=lnt id=hl-18-65><a class=lnlinks href=#hl-18-65>65</a>
</span><span class=lnt id=hl-18-66><a class=lnlinks href=#hl-18-66>66</a>
</span><span class=lnt id=hl-18-67><a class=lnlinks href=#hl-18-67>67</a>
</span><span class=lnt id=hl-18-68><a class=lnlinks href=#hl-18-68>68</a>
</span><span class=lnt id=hl-18-69><a class=lnlinks href=#hl-18-69>69</a>
</span><span class=lnt id=hl-18-70><a class=lnlinks href=#hl-18-70>70</a>
</span><span class=lnt id=hl-18-71><a class=lnlinks href=#hl-18-71>71</a>
</span><span class=lnt id=hl-18-72><a class=lnlinks href=#hl-18-72>72</a>
</span><span class=lnt id=hl-18-73><a class=lnlinks href=#hl-18-73>73</a>
</span><span class=lnt id=hl-18-74><a class=lnlinks href=#hl-18-74>74</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>passport</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;passport&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>OAuth2Strategy</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;passport-oauth2&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>session</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express-session&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 세션 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>session</span><span class=p>({</span>
</span></span><span class=line><span class=cl>  <span class=nx>secret</span><span class=o>:</span> <span class=s1>&#39;your-secret-key&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>resave</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>saveUninitialized</span><span class=o>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl><span class=p>}));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>passport</span><span class=p>.</span><span class=nx>initialize</span><span class=p>());</span>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=nx>passport</span><span class=p>.</span><span class=nx>session</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// OAuth 2.0 전략 설정
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>passport</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span><span class=k>new</span> <span class=nx>OAuth2Strategy</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>authorizationURL</span><span class=o>:</span> <span class=s1>&#39;https://provider.example.com/oauth2/authorize&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>tokenURL</span><span class=o>:</span> <span class=s1>&#39;https://provider.example.com/oauth2/token&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>clientID</span><span class=o>:</span> <span class=s1>&#39;your-client-id&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>clientSecret</span><span class=o>:</span> <span class=s1>&#39;your-client-secret&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>callbackURL</span><span class=o>:</span> <span class=s1>&#39;http://localhost:3000/auth/callback&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>state</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span><span class=p>(</span><span class=nx>accessToken</span><span class=p>,</span> <span class=nx>refreshToken</span><span class=p>,</span> <span class=nx>profile</span><span class=p>,</span> <span class=nx>cb</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 액세스 토큰 저장 및 사용자 정보 검색
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Access Token:&#39;</span><span class=p>,</span> <span class=nx>accessToken</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Refresh Token:&#39;</span><span class=p>,</span> <span class=nx>refreshToken</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 데이터베이스에서 사용자 찾기 또는 생성
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=nx>cb</span><span class=p>(</span><span class=kc>null</span><span class=p>,</span> <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=s1>&#39;123&#39;</span><span class=p>,</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Example User&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 사용자 직렬화/역직렬화
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>passport</span><span class=p>.</span><span class=nx>serializeUser</span><span class=p>((</span><span class=nx>user</span><span class=p>,</span> <span class=nx>done</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>done</span><span class=p>(</span><span class=kc>null</span><span class=p>,</span> <span class=nx>user</span><span class=p>.</span><span class=nx>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>passport</span><span class=p>.</span><span class=nx>deserializeUser</span><span class=p>((</span><span class=nx>id</span><span class=p>,</span> <span class=nx>done</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 실제 구현에서는 데이터베이스에서 사용자 조회
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>done</span><span class=p>(</span><span class=kc>null</span><span class=p>,</span> <span class=p>{</span> <span class=nx>id</span><span class=o>:</span> <span class=nx>id</span><span class=p>,</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;Example User&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 로그인 라우트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/auth/login&#39;</span><span class=p>,</span> <span class=nx>passport</span><span class=p>.</span><span class=nx>authenticate</span><span class=p>(</span><span class=s1>&#39;oauth2&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 콜백 라우트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/auth/callback&#39;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=nx>passport</span><span class=p>.</span><span class=nx>authenticate</span><span class=p>(</span><span class=s1>&#39;oauth2&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>failureRedirect</span><span class=o>:</span> <span class=s1>&#39;/login&#39;</span> <span class=p>}),</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span><span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 성공적인 인증 후 리다이렉트
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>res</span><span class=p>.</span><span class=nx>redirect</span><span class=p>(</span><span class=s1>&#39;/profile&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 프로필 라우트
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/profile&#39;</span><span class=p>,</span> <span class=nx>isAuthenticated</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=sb>`Hello, </span><span class=si>${</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>.</span><span class=nx>name</span><span class=si>}</span><span class=sb>!`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 인증 미들웨어
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>isAuthenticated</span><span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>isAuthenticated</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>res</span><span class=p>.</span><span class=nx>redirect</span><span class=p>(</span><span class=s1>&#39;/auth/login&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=mi>3000</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Server started on port 3000&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=spring-boot-구현-예제>Spring Boot 구현 예제<a hidden class=anchor aria-hidden=true href=#spring-boot-구현-예제>#</a></h4><p>Spring Security OAuth2를 사용한 리소스 서버 구현:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-19-1><a class=lnlinks href=#hl-19-1> 1</a>
</span><span class=lnt id=hl-19-2><a class=lnlinks href=#hl-19-2> 2</a>
</span><span class=lnt id=hl-19-3><a class=lnlinks href=#hl-19-3> 3</a>
</span><span class=lnt id=hl-19-4><a class=lnlinks href=#hl-19-4> 4</a>
</span><span class=lnt id=hl-19-5><a class=lnlinks href=#hl-19-5> 5</a>
</span><span class=lnt id=hl-19-6><a class=lnlinks href=#hl-19-6> 6</a>
</span><span class=lnt id=hl-19-7><a class=lnlinks href=#hl-19-7> 7</a>
</span><span class=lnt id=hl-19-8><a class=lnlinks href=#hl-19-8> 8</a>
</span><span class=lnt id=hl-19-9><a class=lnlinks href=#hl-19-9> 9</a>
</span><span class=lnt id=hl-19-10><a class=lnlinks href=#hl-19-10>10</a>
</span><span class=lnt id=hl-19-11><a class=lnlinks href=#hl-19-11>11</a>
</span><span class=lnt id=hl-19-12><a class=lnlinks href=#hl-19-12>12</a>
</span><span class=lnt id=hl-19-13><a class=lnlinks href=#hl-19-13>13</a>
</span><span class=lnt id=hl-19-14><a class=lnlinks href=#hl-19-14>14</a>
</span><span class=lnt id=hl-19-15><a class=lnlinks href=#hl-19-15>15</a>
</span><span class=lnt id=hl-19-16><a class=lnlinks href=#hl-19-16>16</a>
</span><span class=lnt id=hl-19-17><a class=lnlinks href=#hl-19-17>17</a>
</span><span class=lnt id=hl-19-18><a class=lnlinks href=#hl-19-18>18</a>
</span><span class=lnt id=hl-19-19><a class=lnlinks href=#hl-19-19>19</a>
</span><span class=lnt id=hl-19-20><a class=lnlinks href=#hl-19-20>20</a>
</span><span class=lnt id=hl-19-21><a class=lnlinks href=#hl-19-21>21</a>
</span><span class=lnt id=hl-19-22><a class=lnlinks href=#hl-19-22>22</a>
</span><span class=lnt id=hl-19-23><a class=lnlinks href=#hl-19-23>23</a>
</span><span class=lnt id=hl-19-24><a class=lnlinks href=#hl-19-24>24</a>
</span><span class=lnt id=hl-19-25><a class=lnlinks href=#hl-19-25>25</a>
</span><span class=lnt id=hl-19-26><a class=lnlinks href=#hl-19-26>26</a>
</span><span class=lnt id=hl-19-27><a class=lnlinks href=#hl-19-27>27</a>
</span><span class=lnt id=hl-19-28><a class=lnlinks href=#hl-19-28>28</a>
</span><span class=lnt id=hl-19-29><a class=lnlinks href=#hl-19-29>29</a>
</span><span class=lnt id=hl-19-30><a class=lnlinks href=#hl-19-30>30</a>
</span><span class=lnt id=hl-19-31><a class=lnlinks href=#hl-19-31>31</a>
</span><span class=lnt id=hl-19-32><a class=lnlinks href=#hl-19-32>32</a>
</span><span class=lnt id=hl-19-33><a class=lnlinks href=#hl-19-33>33</a>
</span><span class=lnt id=hl-19-34><a class=lnlinks href=#hl-19-34>34</a>
</span><span class=lnt id=hl-19-35><a class=lnlinks href=#hl-19-35>35</a>
</span><span class=lnt id=hl-19-36><a class=lnlinks href=#hl-19-36>36</a>
</span><span class=lnt id=hl-19-37><a class=lnlinks href=#hl-19-37>37</a>
</span><span class=lnt id=hl-19-38><a class=lnlinks href=#hl-19-38>38</a>
</span><span class=lnt id=hl-19-39><a class=lnlinks href=#hl-19-39>39</a>
</span><span class=lnt id=hl-19-40><a class=lnlinks href=#hl-19-40>40</a>
</span><span class=lnt id=hl-19-41><a class=lnlinks href=#hl-19-41>41</a>
</span><span class=lnt id=hl-19-42><a class=lnlinks href=#hl-19-42>42</a>
</span><span class=lnt id=hl-19-43><a class=lnlinks href=#hl-19-43>43</a>
</span><span class=lnt id=hl-19-44><a class=lnlinks href=#hl-19-44>44</a>
</span><span class=lnt id=hl-19-45><a class=lnlinks href=#hl-19-45>45</a>
</span><span class=lnt id=hl-19-46><a class=lnlinks href=#hl-19-46>46</a>
</span><span class=lnt id=hl-19-47><a class=lnlinks href=#hl-19-47>47</a>
</span><span class=lnt id=hl-19-48><a class=lnlinks href=#hl-19-48>48</a>
</span><span class=lnt id=hl-19-49><a class=lnlinks href=#hl-19-49>49</a>
</span><span class=lnt id=hl-19-50><a class=lnlinks href=#hl-19-50>50</a>
</span><span class=lnt id=hl-19-51><a class=lnlinks href=#hl-19-51>51</a>
</span><span class=lnt id=hl-19-52><a class=lnlinks href=#hl-19-52>52</a>
</span><span class=lnt id=hl-19-53><a class=lnlinks href=#hl-19-53>53</a>
</span><span class=lnt id=hl-19-54><a class=lnlinks href=#hl-19-54>54</a>
</span><span class=lnt id=hl-19-55><a class=lnlinks href=#hl-19-55>55</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.boot.SpringApplication</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.boot.autoconfigure.SpringBootApplication</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.context.annotation.Bean</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.security.config.annotation.web.builders.HttpSecurity</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.security.config.annotation.web.configuration.EnableWebSecurity</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfigurerAdapter</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.security.oauth2.provider.token.TokenStore</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.security.oauth2.provider.token.store.JwtTokenStore</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.web.bind.annotation.GetMapping</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.web.bind.annotation.RestController</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.security.Principal</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@SpringBootApplication</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableResourceServer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@EnableWebSecurity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ResourceServerApplication</span><span class=w> </span><span class=kd>extends</span><span class=w> </span><span class=n>ResourceServerConfigurerAdapter</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>SpringApplication</span><span class=p>.</span><span class=na>run</span><span class=p>(</span><span class=n>ResourceServerApplication</span><span class=p>.</span><span class=na>class</span><span class=p>,</span><span class=w> </span><span class=n>args</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>configure</span><span class=p>(</span><span class=n>HttpSecurity</span><span class=w> </span><span class=n>http</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>http</span><span class=p>.</span><span class=na>authorizeRequests</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>antMatchers</span><span class=p>(</span><span class=s>&#34;/api/**&#34;</span><span class=p>).</span><span class=na>authenticated</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>.</span><span class=na>anyRequest</span><span class=p>().</span><span class=na>permitAll</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>TokenStore</span><span class=w> </span><span class=nf>tokenStore</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>JwtTokenStore</span><span class=p>(</span><span class=n>accessTokenConverter</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Bean</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>JwtAccessTokenConverter</span><span class=w> </span><span class=nf>accessTokenConverter</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>JwtAccessTokenConverter</span><span class=w> </span><span class=n>converter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>JwtAccessTokenConverter</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>converter</span><span class=p>.</span><span class=na>setSigningKey</span><span class=p>(</span><span class=s>&#34;your-signing-key&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>converter</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@RestController</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>class</span> <span class=nc>UserController</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/api/user&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Principal</span><span class=w> </span><span class=nf>user</span><span class=p>(</span><span class=n>Principal</span><span class=w> </span><span class=n>principal</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>principal</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/api/resource&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>resource</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=s>&#34;Protected Resource&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=python-구현-예제>Python 구현 예제<a hidden class=anchor aria-hidden=true href=#python-구현-예제>#</a></h4><p>Flask와 Authlib을 사용한 OAuth 2.0 클라이언트 구현:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1> 1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2> 2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3> 3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4> 4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5> 5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6> 6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7> 7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8> 8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9> 9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10>10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11>11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12>12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13>13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14>14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15>15</a>
</span><span class=lnt id=hl-20-16><a class=lnlinks href=#hl-20-16>16</a>
</span><span class=lnt id=hl-20-17><a class=lnlinks href=#hl-20-17>17</a>
</span><span class=lnt id=hl-20-18><a class=lnlinks href=#hl-20-18>18</a>
</span><span class=lnt id=hl-20-19><a class=lnlinks href=#hl-20-19>19</a>
</span><span class=lnt id=hl-20-20><a class=lnlinks href=#hl-20-20>20</a>
</span><span class=lnt id=hl-20-21><a class=lnlinks href=#hl-20-21>21</a>
</span><span class=lnt id=hl-20-22><a class=lnlinks href=#hl-20-22>22</a>
</span><span class=lnt id=hl-20-23><a class=lnlinks href=#hl-20-23>23</a>
</span><span class=lnt id=hl-20-24><a class=lnlinks href=#hl-20-24>24</a>
</span><span class=lnt id=hl-20-25><a class=lnlinks href=#hl-20-25>25</a>
</span><span class=lnt id=hl-20-26><a class=lnlinks href=#hl-20-26>26</a>
</span><span class=lnt id=hl-20-27><a class=lnlinks href=#hl-20-27>27</a>
</span><span class=lnt id=hl-20-28><a class=lnlinks href=#hl-20-28>28</a>
</span><span class=lnt id=hl-20-29><a class=lnlinks href=#hl-20-29>29</a>
</span><span class=lnt id=hl-20-30><a class=lnlinks href=#hl-20-30>30</a>
</span><span class=lnt id=hl-20-31><a class=lnlinks href=#hl-20-31>31</a>
</span><span class=lnt id=hl-20-32><a class=lnlinks href=#hl-20-32>32</a>
</span><span class=lnt id=hl-20-33><a class=lnlinks href=#hl-20-33>33</a>
</span><span class=lnt id=hl-20-34><a class=lnlinks href=#hl-20-34>34</a>
</span><span class=lnt id=hl-20-35><a class=lnlinks href=#hl-20-35>35</a>
</span><span class=lnt id=hl-20-36><a class=lnlinks href=#hl-20-36>36</a>
</span><span class=lnt id=hl-20-37><a class=lnlinks href=#hl-20-37>37</a>
</span><span class=lnt id=hl-20-38><a class=lnlinks href=#hl-20-38>38</a>
</span><span class=lnt id=hl-20-39><a class=lnlinks href=#hl-20-39>39</a>
</span><span class=lnt id=hl-20-40><a class=lnlinks href=#hl-20-40>40</a>
</span><span class=lnt id=hl-20-41><a class=lnlinks href=#hl-20-41>41</a>
</span><span class=lnt id=hl-20-42><a class=lnlinks href=#hl-20-42>42</a>
</span><span class=lnt id=hl-20-43><a class=lnlinks href=#hl-20-43>43</a>
</span><span class=lnt id=hl-20-44><a class=lnlinks href=#hl-20-44>44</a>
</span><span class=lnt id=hl-20-45><a class=lnlinks href=#hl-20-45>45</a>
</span><span class=lnt id=hl-20-46><a class=lnlinks href=#hl-20-46>46</a>
</span><span class=lnt id=hl-20-47><a class=lnlinks href=#hl-20-47>47</a>
</span><span class=lnt id=hl-20-48><a class=lnlinks href=#hl-20-48>48</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>url_for</span><span class=p>,</span> <span class=n>redirect</span><span class=p>,</span> <span class=n>session</span><span class=p>,</span> <span class=n>request</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>authlib.integrations.flask_client</span> <span class=kn>import</span> <span class=n>OAuth</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>secret_key</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>24</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>oauth</span> <span class=o>=</span> <span class=n>OAuth</span><span class=p>(</span><span class=n>app</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>oauth</span><span class=o>.</span><span class=n>register</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=o>=</span><span class=s1>&#39;example&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>client_id</span><span class=o>=</span><span class=s1>&#39;your-client-id&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>client_secret</span><span class=o>=</span><span class=s1>&#39;your-client-secret&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>access_token_url</span><span class=o>=</span><span class=s1>&#39;https://provider.example.com/oauth2/token&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>access_token_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>authorize_url</span><span class=o>=</span><span class=s1>&#39;https://provider.example.com/oauth2/authorize&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>authorize_params</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>api_base_url</span><span class=o>=</span><span class=s1>&#39;https://api.example.com/&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>client_kwargs</span><span class=o>=</span><span class=p>{</span><span class=s1>&#39;scope&#39;</span><span class=p>:</span> <span class=s1>&#39;profile email&#39;</span><span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>homepage</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>user</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;user&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>user</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;Hello </span><span class=si>{</span><span class=n>user</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>]</span><span class=si>}</span><span class=s1>!&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&lt;a href=&#34;/login&#34;&gt;Login&lt;/a&gt;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>login</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>redirect_uri</span> <span class=o>=</span> <span class=n>url_for</span><span class=p>(</span><span class=s1>&#39;auth&#39;</span><span class=p>,</span> <span class=n>_external</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>oauth</span><span class=o>.</span><span class=n>example</span><span class=o>.</span><span class=n>authorize_redirect</span><span class=p>(</span><span class=n>redirect_uri</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/auth&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>auth</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>token</span> <span class=o>=</span> <span class=n>oauth</span><span class=o>.</span><span class=n>example</span><span class=o>.</span><span class=n>authorize_access_token</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>resp</span> <span class=o>=</span> <span class=n>oauth</span><span class=o>.</span><span class=n>example</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;userinfo&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>user_info</span> <span class=o>=</span> <span class=n>resp</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># 사용자 정보를 세션에 저장</span>
</span></span><span class=line><span class=cl>    <span class=n>session</span><span class=p>[</span><span class=s1>&#39;user&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>user_info</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/logout&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>logout</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>session</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=s1>&#39;user&#39;</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>redirect</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>debug</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=oauth-20의-모범-사례>OAuth 2.0의 모범 사례<a hidden class=anchor aria-hidden=true href=#oauth-20의-모범-사례>#</a></h3><p>OAuth 2.0을 효과적이고 안전하게 구현하기 위한 모범 사례.</p><h4 id=일반적인-모범-사례>일반적인 모범 사례<a hidden class=anchor aria-hidden=true href=#일반적인-모범-사례>#</a></h4><ol><li><strong>항상 TLS 사용</strong>: 모든 OAuth 2.0 통신은 TLS(HTTPS)를 통해 이루어져야 한다.</li><li><strong>적절한 권한 부여 흐름 선택</strong>:<ul><li>웹 서버 애플리케이션: 권한 부여 코드 부여</li><li>단일 페이지 애플리케이션(SPA): 권한 부여 코드 부여 + PKCE</li><li>모바일/데스크톱 앱: 권한 부여 코드 부여 + PKCE</li><li>서버 간 통신: 클라이언트 자격 증명 부여</li></ul></li><li><strong>토큰 수명 관리</strong>:<ul><li>액세스 토큰: 짧은 수명(15분-1시간)</li><li>리프레시 토큰: 더 긴 수명, 필요 시 취소 가능</li></ul></li><li><strong>상태 파라미터 사용</strong>: 모든 권한 요청에 state 파라미터를 포함하여 CSRF 공격을 방지한다.</li><li><strong>리다이렉션 URI 검증</strong>: 정확한 매칭을 통해 리다이렉션 URI를 검증한다.</li></ol><h4 id=클라이언트-측-모범-사례>클라이언트 측 모범 사례<a hidden class=anchor aria-hidden=true href=#클라이언트-측-모범-사례>#</a></h4><ol><li><strong>안전한 토큰 저장</strong>:<ul><li>웹 애플리케이션: HttpOnly, Secure, SameSite 쿠키</li><li>SPA: 메모리 저장(JavaScript 변수) 또는 안전한 쿠키</li><li>모바일 앱: 안전한 저장소(iOS Keychain, Android Keystore)</li></ul></li><li><strong>PKCE 사용</strong>: 모든 공개 클라이언트는 PKCE를 사용해야 한다.</li><li><strong>토큰 갱신 전략</strong>: 액세스 토큰 만료 전에 갱신하는 전략을 구현한다.</li><li><strong>오류 처리</strong>: 토큰 만료, 취소 등의 오류 상황을 적절히 처리한다.</li></ol><h4 id=서버-측-모범-사례>서버 측 모범 사례<a hidden class=anchor aria-hidden=true href=#서버-측-모범-사례>#</a></h4><ol><li><strong>클라이언트 검증</strong>: 클라이언트 등록 시 철저한 검증과 승인 절차를 수행한다.</li><li><strong>범위 제한</strong>: 필요한 최소한의 범위만 허용한다.</li><li><strong>토큰 서명 및 검증</strong>: JWT를 사용할 경우 강력한 서명 알고리즘(RS256 등)을 사용한다.</li><li><strong>무차별 대입 공격 방지</strong>: 속도 제한, 계정 잠금 등의 방어 메커니즘을 구현한다.</li><li><strong>토큰 취소 지원</strong>: 토큰 취소 엔드포인트와 취소 목록 관리를 구현한다.</li></ol><h3 id=oauth-20의-한계와-도전-과제>OAuth 2.0의 한계와 도전 과제<a hidden class=anchor aria-hidden=true href=#oauth-20의-한계와-도전-과제>#</a></h3><p>OAuth 2.0의 주요 한계와 도전 과제를 살펴보면:</p><ol><li>프레임워크의 복잡성<ol><li><strong>다양한 흐름</strong>: 여러 권한 부여 흐름이 존재하여 적절한 흐름을 선택하고 구현하는 데 복잡성이 증가한다.</li><li><strong>확장의 파편화</strong>: 많은 확장과 프로필이 존재하여 상호 운용성 문제가 발생할 수 있다.</li><li><strong>구현 차이</strong>: 다양한 OAuth 2.0 제공자 간의 구현 차이로 인해 통합이 어려울 수 있다.</li></ol></li><li>보안 고려 사항<ol><li><strong>묵시적 흐름 문제</strong>: 원래 SPA용으로 설계된 묵시적 흐름은 여러 보안 취약점이 있어 현재는 사용이 권장되지 않는다.</li><li><strong>피싱 취약성</strong>: 사용자가 가짜 권한 부여 화면을 구별하기 어려울 수 있다.</li><li><strong>토큰 보안</strong>: 액세스 토큰이 노출될 경우 보호된 리소스에 무단 접근이 가능하다.</li><li><strong>오픈 리다이렉터 문제</strong>: 부적절한 리다이렉션 URI 검증으로 인해 공격 가능성이 있다.</li></ol></li><li>사용자 경험 문제<ol><li><strong>리다이렉션 기반</strong>: 리다이렉션 기반 흐름은 일부 환경(embedded 시스템, CLI 도구 등)에서 사용자 경험이 좋지 않을 수 있다.</li><li><strong>동의 피로(Consent Fatigue)</strong>: 사용자가 너무 많은 동의 화면에 노출되면 내용을 제대로 읽지 않고 승인하는 경향이 있다.</li><li><strong>인증서버 종속성</strong>: 인증 서버가 다운되면 모든 클라이언트가 영향을 받는다.</li></ol></li></ol><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><footer class=post-footer><ul class=post-tags><li><a href=https://buenhyden.github.io/tags/backend/>Backend</a></li><li><a href=https://buenhyden.github.io/tags/api-design/>API-Design</a></li><li><a href=https://buenhyden.github.io/tags/authentication-methods/>Authentication-Methods</a></li><li><a href=https://buenhyden.github.io/tags/oauth/>OAuth</a></li></ul><nav class=paginav><a class=prev href=https://buenhyden.github.io/posts/backend/api-design/real-time-apis/types/server-sent-events/server-sent-events-vs-websocket/><span class=title>« Prev</span><br><span>Server-sent Events vs. Websocket</span>
</a><a class=next href=https://buenhyden.github.io/posts/backend/api-design/real-time-apis/types/websocket-api/websocket-api-vs-websocket/><span class=title>Next »</span><br><span>Websocket API vs. Websocket</span></a></nav></footer><div class=comments><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="dark"?"dark":"light",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const n={src:"https://giscus.app/client.js","data-repo":"buenhyden/buenhyden.github.io","data-repo-id":"R_kgDONsSnFQ","data-category":"General","data-category-id":"DIC_kwDONsSnFc4CmK-R","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"en","data-loading":"lazy",crossorigin:"anonymous",async:""},e=document.createElement("script");Object.entries(n).forEach(([t,n])=>e.setAttribute(t,n)),console.log(e),document.querySelector(".comments").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme)})</script></div></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>