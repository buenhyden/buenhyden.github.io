<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Kafka | hyunyoun's Blog</title>
<meta name=keywords content="Backend,Event-Brokers-and-Message-Brokers,Tools,Kafka"><meta name=description content="Kafka는 높은 처리량, 낮은 지연 시간, 내결함성을 갖춘 실시간 데이터 파이프라인과 스트리밍 애플리케이션을 구축하기 위한 기반을 제공한다."><meta name=author content="Me"><link rel=canonical href=https://buenhyden.github.io/posts/backend/event-brokers-and-message-brokers/tools/kafka/><meta name=google-site-verification content="googlee06938ebbfcbac49.html"><link crossorigin=anonymous href=/assets/css/stylesheet.8762af4fa9ee176c57f72565b721f234162fc7a9c882a271e0a1f68c4e89fb34.css integrity="sha256-h2KvT6nuF2xX9yVltyHyNBYvx6nIgqJx4KH2jE6J+zQ=" rel="preload stylesheet" as=style><link rel=icon href=https://buenhyden.github.io/favicons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://buenhyden.github.io/favicons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://buenhyden.github.io/favicons/favicon-32x32.png><link rel=apple-touch-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><link rel=mask-icon href=https://buenhyden.github.io/favicons/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://buenhyden.github.io/posts/backend/event-brokers-and-message-brokers/tools/kafka/index.xml><link rel=alternate hreflang=en href=https://buenhyden.github.io/posts/backend/event-brokers-and-message-brokers/tools/kafka/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3156423099418350" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-W8XTMYPTLC"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-W8XTMYPTLC")}</script><meta property="og:url" content="https://buenhyden.github.io/posts/backend/event-brokers-and-message-brokers/tools/kafka/"><meta property="og:site_name" content="hyunyoun's Blog"><meta property="og:title" content="Kafka"><meta property="og:description" content="Kafka는 높은 처리량, 낮은 지연 시간, 내결함성을 갖춘 실시간 데이터 파이프라인과 스트리밍 애플리케이션을 구축하기 위한 기반을 제공한다."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://buenhyden.github.io/images"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://buenhyden.github.io/images"><meta name=twitter:title content="Kafka"><meta name=twitter:description content="Kafka는 높은 처리량, 낮은 지연 시간, 내결함성을 갖춘 실시간 데이터 파이프라인과 스트리밍 애플리케이션을 구축하기 위한 기반을 제공한다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://buenhyden.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Backend","item":"https://buenhyden.github.io/posts/backend/"},{"@type":"ListItem","position":3,"name":"Event Brokers and Message Brokers","item":"https://buenhyden.github.io/posts/backend/event-brokers-and-message-brokers/"},{"@type":"ListItem","position":4,"name":"Tools of Event Broker and Message Broker","item":"https://buenhyden.github.io/posts/backend/event-brokers-and-message-brokers/tools/"},{"@type":"ListItem","position":5,"name":"Kafka","item":"https://buenhyden.github.io/posts/backend/event-brokers-and-message-brokers/tools/kafka/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://buenhyden.github.io/ accesskey=h title="Hy's Blog (Alt + H)"><img src=https://buenhyden.github.io/favicons/apple-touch-icon.png alt aria-label=logo height=35>Hy's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://buenhyden.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://buenhyden.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://buenhyden.github.io/til/ title="Today I Learned"><span>Today I Learned</span></a></li><li><a href=https://buenhyden.github.io/coding-test/ title="Coding Test"><span>Coding Test</span></a></li><li><a href=https://buenhyden.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://buenhyden.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://buenhyden.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://buenhyden.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/>posts</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend/>Backend</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend/event-brokers-and-message-brokers/>Event Brokers and Message Brokers</a>&nbsp;»&nbsp;<a href=https://buenhyden.github.io/posts/backend/event-brokers-and-message-brokers/tools/>Tools of Event Broker and Message Broker</a></div><h1>Kafka</h1><div class=post-description>Kafka는 높은 처리량, 낮은 지연 시간, 내결함성을 갖춘 실시간 데이터 파이프라인과 스트리밍 애플리케이션을 구축하기 위한 기반을 제공한다.</div></header><div class=post-content><h2 id=kafka>Kafka<a hidden class=anchor aria-hidden=true href=#kafka>#</a></h2><p>Apache Kafka는 LinkedIn에서 개발되어 나중에 Apache Software Foundation에 기부된 분산 이벤트 스트리밍 플랫폼입니다. Kafka는 높은 처리량, 낮은 지연 시간, 내결함성을 갖춘 실시간 데이터 파이프라인과 스트리밍 애플리케이션을 구축하기 위한 기반을 제공한다.</p><h3 id=주요-특징>주요 특징<a hidden class=anchor aria-hidden=true href=#주요-특징>#</a></h3><ul><li><strong>높은 처리량</strong>: 초당 수백만 개의 메시지를 처리할 수 있다.</li><li><strong>낮은 지연 시간</strong>: 밀리초 단위의 지연 시간으로 메시지를 전달한다.</li><li><strong>내구성</strong>: 메시지는 디스크에 저장되고 복제되어 데이터 손실을 방지한다.</li><li><strong>확장성</strong>: 클러스터를 수평적으로 확장하여 처리량을 높일 수 있다.</li><li><strong>내결함성</strong>: 브로커 장애 시에도 계속 작동할 수 있다.</li><li><strong>분산 아키텍처</strong>: 여러 서버에 걸쳐 작업을 분산한다.</li></ul><h3 id=아키텍처-개요>아키텍처 개요<a hidden class=anchor aria-hidden=true href=#아키텍처-개요>#</a></h3><p>Kafka의 아키텍처는 다음과 같은 주요 구성 요소로 이루어져 있다:</p><ol><li><strong>브로커(Broker)</strong>: Kafka 서버로, 토픽의 파티션을 저장하고 관리한다.</li><li><strong>주키퍼(ZooKeeper)</strong>: 브로커 클러스터의 메타데이터를 관리한다(최신 버전에서는 KRaft 모드로 대체 가능).</li><li><strong>프로듀서(Producer)</strong>: 메시지를 토픽에 발행한다.</li><li><strong>컨슈머(Consumer)</strong>: 토픽에서 메시지를 구독하고 처리한다.</li><li><strong>토픽(Topic)</strong>: 메시지가 발행되는 카테고리 또는 피드 이름이다.</li><li><strong>파티션(Partition)</strong>: 토픽은 여러 파티션으로 나뉘며, 각 파티션은 순서가 보장된 메시지 시퀀스이다.</li></ol><h3 id=kafka의-핵심-개념>Kafka의 핵심 개념<a hidden class=anchor aria-hidden=true href=#kafka의-핵심-개념>#</a></h3><ol><li>토픽과 파티션<ol><li><strong>토픽(Topic)</strong> 은 Kafka에서 데이터를 구성하는 가장 기본적인 단위이다. 각 토픽은 하나 이상의 파티션으로 나뉜다.</li><li><strong>파티션(Partition)</strong> 은 토픽을 여러 서버에 분산시키는 메커니즘을 제공한다. 각 파티션은 변경 불가능한 메시지 시퀀스로, 각 메시지는 파티션 내에서 고유한 오프셋(offset)을 가진다.</li></ol></li><li>복제(Replication)<br>Kafka는 내결함성을 위해 파티션을 여러 브로커에 복제한다. 각 파티션에는 리더(leader)와 팔로워(follower)가 있다:<ul><li><strong>리더</strong>: 모든 읽기 및 쓰기 요청을 처리한다.</li><li><strong>팔로워</strong>: 리더의 데이터를 복제하고, 리더가 실패할 경우 새로운 리더가 될 수 있다.</li></ul></li><li>프로듀서와 컨슈머<ol><li>**프로듀서(Producer)**는 메시지를 토픽에 게시한다.<br>주요 특징:<ul><li>메시지 키(key)를 기반으로 특정 파티션에 메시지 할당</li><li>비동기 또는 동기 전송 지원</li><li>배치 처리를 통한 성능 최적화</li></ul></li><li>**컨슈머(Consumer)**는 토픽에서 메시지를 소비합니다.<br>주요 특징:<ul><li>컨슈머 그룹을 통한 병렬 처리</li><li>오프셋 관리를 통한 메시지 위치 추적</li><li>최소 한 번, 최대 한 번, 정확히 한 번 전달 의미 구현 가능</li></ul></li></ol></li><li>컨슈머 그룹과 오프셋<ol><li>**컨슈머 그룹(Consumer Group)**은 동일한 토픽을 소비하는 컨슈머 집합이다. 각 파티션은 그룹 내 하나의 컨슈머에만 할당된다.</li><li>**오프셋(Offset)**은 파티션 내 각 메시지의 위치를 나타내는 순차적인 ID이다. 컨슈머는 처리한 메시지의 오프셋을 추적하여 메시지를 중복 처리하지 않도록 한다.</li></ol></li></ol><h3 id=kafka-설치-및-기본-구성>Kafka 설치 및 기본 구성<a hidden class=anchor aria-hidden=true href=#kafka-설치-및-기본-구성>#</a></h3><h4 id=단일-노드-설치>단일 노드 설치<a hidden class=anchor aria-hidden=true href=#단일-노드-설치>#</a></h4><p>개발 환경에서는 단일 노드로 Kafka를 실행할 수 있다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Kafka 다운로드</span>
</span></span><span class=line><span class=cl>wget https://downloads.apache.org/kafka/3.4.0/kafka_2.13-3.4.0.tgz
</span></span><span class=line><span class=cl>tar -xzf kafka_2.13-3.4.0.tgz
</span></span><span class=line><span class=cl><span class=nb>cd</span> kafka_2.13-3.4.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ZooKeeper 시작</span>
</span></span><span class=line><span class=cl>bin/zookeeper-server-start.sh config/zookeeper.properties <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kafka 브로커 시작</span>
</span></span><span class=line><span class=cl>bin/kafka-server-start.sh config/server.properties <span class=p>&amp;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=클러스터-설정>클러스터 설정<a hidden class=anchor aria-hidden=true href=#클러스터-설정>#</a></h4><p>프로덕션 환경에서는 여러 브로커로 구성된 클러스터를 설정해야 한다.</p><p>각 브로커에 대한 server.properties 파일을 수정합니다:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=c1># 첫 번째 브로커</span>
</span></span><span class=line><span class=cl><span class=na>broker.id</span><span class=o>=</span><span class=s>0</span>
</span></span><span class=line><span class=cl><span class=na>listeners</span><span class=o>=</span><span class=s>PLAINTEXT://server1:9092</span>
</span></span><span class=line><span class=cl><span class=na>log.dirs</span><span class=o>=</span><span class=s>/var/lib/kafka/data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 두 번째 브로커</span>
</span></span><span class=line><span class=cl><span class=na>broker.id</span><span class=o>=</span><span class=s>1</span>
</span></span><span class=line><span class=cl><span class=na>listeners</span><span class=o>=</span><span class=s>PLAINTEXT://server2:9092</span>
</span></span><span class=line><span class=cl><span class=na>log.dirs</span><span class=o>=</span><span class=s>/var/lib/kafka/data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 세 번째 브로커</span>
</span></span><span class=line><span class=cl><span class=na>broker.id</span><span class=o>=</span><span class=s>2</span>
</span></span><span class=line><span class=cl><span class=na>listeners</span><span class=o>=</span><span class=s>PLAINTEXT://server3:9092</span>
</span></span><span class=line><span class=cl><span class=na>log.dirs</span><span class=o>=</span><span class=s>/var/lib/kafka/data</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=docker-및-kubernetes-배포>Docker 및 Kubernetes 배포<a hidden class=anchor aria-hidden=true href=#docker-및-kubernetes-배포>#</a></h4><p>Docker Compose를 사용한 Kafka 배포 예제:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-2-1><a class=lnlinks href=#hl-2-1> 1</a>
</span><span class=lnt id=hl-2-2><a class=lnlinks href=#hl-2-2> 2</a>
</span><span class=lnt id=hl-2-3><a class=lnlinks href=#hl-2-3> 3</a>
</span><span class=lnt id=hl-2-4><a class=lnlinks href=#hl-2-4> 4</a>
</span><span class=lnt id=hl-2-5><a class=lnlinks href=#hl-2-5> 5</a>
</span><span class=lnt id=hl-2-6><a class=lnlinks href=#hl-2-6> 6</a>
</span><span class=lnt id=hl-2-7><a class=lnlinks href=#hl-2-7> 7</a>
</span><span class=lnt id=hl-2-8><a class=lnlinks href=#hl-2-8> 8</a>
</span><span class=lnt id=hl-2-9><a class=lnlinks href=#hl-2-9> 9</a>
</span><span class=lnt id=hl-2-10><a class=lnlinks href=#hl-2-10>10</a>
</span><span class=lnt id=hl-2-11><a class=lnlinks href=#hl-2-11>11</a>
</span><span class=lnt id=hl-2-12><a class=lnlinks href=#hl-2-12>12</a>
</span><span class=lnt id=hl-2-13><a class=lnlinks href=#hl-2-13>13</a>
</span><span class=lnt id=hl-2-14><a class=lnlinks href=#hl-2-14>14</a>
</span><span class=lnt id=hl-2-15><a class=lnlinks href=#hl-2-15>15</a>
</span><span class=lnt id=hl-2-16><a class=lnlinks href=#hl-2-16>16</a>
</span><span class=lnt id=hl-2-17><a class=lnlinks href=#hl-2-17>17</a>
</span><span class=lnt id=hl-2-18><a class=lnlinks href=#hl-2-18>18</a>
</span><span class=lnt id=hl-2-19><a class=lnlinks href=#hl-2-19>19</a>
</span><span class=lnt id=hl-2-20><a class=lnlinks href=#hl-2-20>20</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;3&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zookeeper</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>confluentinc/cp-zookeeper:7.3.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;2181:2181&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>ZOOKEEPER_CLIENT_PORT</span><span class=p>:</span><span class=w> </span><span class=m>2181</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>kafka</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>confluentinc/cp-kafka:7.3.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>depends_on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>zookeeper</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;9092:9092&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>KAFKA_BROKER_ID</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>KAFKA_ZOOKEEPER_CONNECT</span><span class=p>:</span><span class=w> </span><span class=l>zookeeper:2181</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>KAFKA_ADVERTISED_LISTENERS</span><span class=p>:</span><span class=w> </span><span class=l>PLAINTEXT://localhost:9092</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=주요-구성-매개변수>주요 구성 매개변수<a hidden class=anchor aria-hidden=true href=#주요-구성-매개변수>#</a></h4><p>중요한 구성 매개변수들:</p><ul><li><code>broker.id</code>: 클러스터 내 브로커의 고유 식별자</li><li><code>log.dirs</code>: 로그 세그먼트를 저장할 디렉토리</li><li><code>num.partitions</code>: 자동 생성 토픽의 기본 파티션 수</li><li><code>default.replication.factor</code>: 자동 생성 토픽의 기본 복제 인자</li><li><code>min.insync.replicas</code>: 쓰기 작업이 성공으로 간주되기 위한 최소 동기화 복제본 수</li><li><code>log.retention.hours</code>: 로그를 보존할 시간</li><li><code>log.segment.bytes</code>: 로그 세그먼트의 최대 크기</li></ul><h3 id=프로듀서와-컨슈머-프로그래밍-기초>프로듀서와 컨슈머 프로그래밍 기초<a hidden class=anchor aria-hidden=true href=#프로듀서와-컨슈머-프로그래밍-기초>#</a></h3><h4 id=java-클라이언트>Java 클라이언트<a hidden class=anchor aria-hidden=true href=#java-클라이언트>#</a></h4><p>Maven 의존성 추가:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a>
</span><span class=lnt id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a>
</span><span class=lnt id=hl-3-3><a class=lnlinks href=#hl-3-3>3</a>
</span><span class=lnt id=hl-3-4><a class=lnlinks href=#hl-3-4>4</a>
</span><span class=lnt id=hl-3-5><a class=lnlinks href=#hl-3-5>5</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>org.apache.kafka<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>kafka-clients<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>3.4.0<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>간단한 프로듀서 예제:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-4-1><a class=lnlinks href=#hl-4-1> 1</a>
</span><span class=lnt id=hl-4-2><a class=lnlinks href=#hl-4-2> 2</a>
</span><span class=lnt id=hl-4-3><a class=lnlinks href=#hl-4-3> 3</a>
</span><span class=lnt id=hl-4-4><a class=lnlinks href=#hl-4-4> 4</a>
</span><span class=lnt id=hl-4-5><a class=lnlinks href=#hl-4-5> 5</a>
</span><span class=lnt id=hl-4-6><a class=lnlinks href=#hl-4-6> 6</a>
</span><span class=lnt id=hl-4-7><a class=lnlinks href=#hl-4-7> 7</a>
</span><span class=lnt id=hl-4-8><a class=lnlinks href=#hl-4-8> 8</a>
</span><span class=lnt id=hl-4-9><a class=lnlinks href=#hl-4-9> 9</a>
</span><span class=lnt id=hl-4-10><a class=lnlinks href=#hl-4-10>10</a>
</span><span class=lnt id=hl-4-11><a class=lnlinks href=#hl-4-11>11</a>
</span><span class=lnt id=hl-4-12><a class=lnlinks href=#hl-4-12>12</a>
</span><span class=lnt id=hl-4-13><a class=lnlinks href=#hl-4-13>13</a>
</span><span class=lnt id=hl-4-14><a class=lnlinks href=#hl-4-14>14</a>
</span><span class=lnt id=hl-4-15><a class=lnlinks href=#hl-4-15>15</a>
</span><span class=lnt id=hl-4-16><a class=lnlinks href=#hl-4-16>16</a>
</span><span class=lnt id=hl-4-17><a class=lnlinks href=#hl-4-17>17</a>
</span><span class=lnt id=hl-4-18><a class=lnlinks href=#hl-4-18>18</a>
</span><span class=lnt id=hl-4-19><a class=lnlinks href=#hl-4-19>19</a>
</span><span class=lnt id=hl-4-20><a class=lnlinks href=#hl-4-20>20</a>
</span><span class=lnt id=hl-4-21><a class=lnlinks href=#hl-4-21>21</a>
</span><span class=lnt id=hl-4-22><a class=lnlinks href=#hl-4-22>22</a>
</span><span class=lnt id=hl-4-23><a class=lnlinks href=#hl-4-23>23</a>
</span><span class=lnt id=hl-4-24><a class=lnlinks href=#hl-4-24>24</a>
</span><span class=lnt id=hl-4-25><a class=lnlinks href=#hl-4-25>25</a>
</span><span class=lnt id=hl-4-26><a class=lnlinks href=#hl-4-26>26</a>
</span><span class=lnt id=hl-4-27><a class=lnlinks href=#hl-4-27>27</a>
</span><span class=lnt id=hl-4-28><a class=lnlinks href=#hl-4-28>28</a>
</span><span class=lnt id=hl-4-29><a class=lnlinks href=#hl-4-29>29</a>
</span><span class=lnt id=hl-4-30><a class=lnlinks href=#hl-4-30>30</a>
</span><span class=lnt id=hl-4-31><a class=lnlinks href=#hl-4-31>31</a>
</span><span class=lnt id=hl-4-32><a class=lnlinks href=#hl-4-32>32</a>
</span><span class=lnt id=hl-4-33><a class=lnlinks href=#hl-4-33>33</a>
</span><span class=lnt id=hl-4-34><a class=lnlinks href=#hl-4-34>34</a>
</span><span class=lnt id=hl-4-35><a class=lnlinks href=#hl-4-35>35</a>
</span><span class=lnt id=hl-4-36><a class=lnlinks href=#hl-4-36>36</a>
</span><span class=lnt id=hl-4-37><a class=lnlinks href=#hl-4-37>37</a>
</span><span class=lnt id=hl-4-38><a class=lnlinks href=#hl-4-38>38</a>
</span><span class=lnt id=hl-4-39><a class=lnlinks href=#hl-4-39>39</a>
</span><span class=lnt id=hl-4-40><a class=lnlinks href=#hl-4-40>40</a>
</span><span class=lnt id=hl-4-41><a class=lnlinks href=#hl-4-41>41</a>
</span><span class=lnt id=hl-4-42><a class=lnlinks href=#hl-4-42>42</a>
</span><span class=lnt id=hl-4-43><a class=lnlinks href=#hl-4-43>43</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>org.apache.kafka.clients.producer.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.Properties</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>SimpleProducer</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 프로듀서 속성 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Properties</span><span class=w> </span><span class=n>props</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Properties</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;bootstrap.servers&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;localhost:9092&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;key.serializer&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;org.apache.kafka.common.serialization.StringSerializer&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;value.serializer&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;org.apache.kafka.common.serialization.StringSerializer&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 프로듀서 인스턴스 생성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Producer</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>producer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>KafkaProducer</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>props</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 메시지 전송</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>10</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>String</span><span class=w> </span><span class=n>key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;key-&#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>i</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>String</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;Hello Kafka &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>i</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>ProducerRecord</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>record</span><span class=w> </span><span class=o>=</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>new</span><span class=w> </span><span class=n>ProducerRecord</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=s>&#34;my-topic&#34;</span><span class=p>,</span><span class=w> </span><span class=n>key</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 비동기 전송</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>producer</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=n>record</span><span class=p>,</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Callback</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onCompletion</span><span class=p>(</span><span class=n>RecordMetadata</span><span class=w> </span><span class=n>metadata</span><span class=p>,</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>e</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=n>e</span><span class=p>.</span><span class=na>printStackTrace</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&#34;Sent record: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                            </span><span class=s>&#34;Topic: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>metadata</span><span class=p>.</span><span class=na>topic</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;, &#34;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                            </span><span class=s>&#34;Partition: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>metadata</span><span class=p>.</span><span class=na>partition</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;, &#34;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                            </span><span class=s>&#34;Offset: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>metadata</span><span class=p>.</span><span class=na>offset</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>});</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 자원 해제</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>producer</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>간단한 컨슈머 예제:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a>
</span><span class=lnt id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a>
</span><span class=lnt id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a>
</span><span class=lnt id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a>
</span><span class=lnt id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a>
</span><span class=lnt id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a>
</span><span class=lnt id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a>
</span><span class=lnt id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a>
</span><span class=lnt id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a>
</span><span class=lnt id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a>
</span><span class=lnt id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a>
</span><span class=lnt id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a>
</span><span class=lnt id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a>
</span><span class=lnt id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a>
</span><span class=lnt id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a>
</span><span class=lnt id=hl-5-16><a class=lnlinks href=#hl-5-16>16</a>
</span><span class=lnt id=hl-5-17><a class=lnlinks href=#hl-5-17>17</a>
</span><span class=lnt id=hl-5-18><a class=lnlinks href=#hl-5-18>18</a>
</span><span class=lnt id=hl-5-19><a class=lnlinks href=#hl-5-19>19</a>
</span><span class=lnt id=hl-5-20><a class=lnlinks href=#hl-5-20>20</a>
</span><span class=lnt id=hl-5-21><a class=lnlinks href=#hl-5-21>21</a>
</span><span class=lnt id=hl-5-22><a class=lnlinks href=#hl-5-22>22</a>
</span><span class=lnt id=hl-5-23><a class=lnlinks href=#hl-5-23>23</a>
</span><span class=lnt id=hl-5-24><a class=lnlinks href=#hl-5-24>24</a>
</span><span class=lnt id=hl-5-25><a class=lnlinks href=#hl-5-25>25</a>
</span><span class=lnt id=hl-5-26><a class=lnlinks href=#hl-5-26>26</a>
</span><span class=lnt id=hl-5-27><a class=lnlinks href=#hl-5-27>27</a>
</span><span class=lnt id=hl-5-28><a class=lnlinks href=#hl-5-28>28</a>
</span><span class=lnt id=hl-5-29><a class=lnlinks href=#hl-5-29>29</a>
</span><span class=lnt id=hl-5-30><a class=lnlinks href=#hl-5-30>30</a>
</span><span class=lnt id=hl-5-31><a class=lnlinks href=#hl-5-31>31</a>
</span><span class=lnt id=hl-5-32><a class=lnlinks href=#hl-5-32>32</a>
</span><span class=lnt id=hl-5-33><a class=lnlinks href=#hl-5-33>33</a>
</span><span class=lnt id=hl-5-34><a class=lnlinks href=#hl-5-34>34</a>
</span><span class=lnt id=hl-5-35><a class=lnlinks href=#hl-5-35>35</a>
</span><span class=lnt id=hl-5-36><a class=lnlinks href=#hl-5-36>36</a>
</span><span class=lnt id=hl-5-37><a class=lnlinks href=#hl-5-37>37</a>
</span><span class=lnt id=hl-5-38><a class=lnlinks href=#hl-5-38>38</a>
</span><span class=lnt id=hl-5-39><a class=lnlinks href=#hl-5-39>39</a>
</span><span class=lnt id=hl-5-40><a class=lnlinks href=#hl-5-40>40</a>
</span><span class=lnt id=hl-5-41><a class=lnlinks href=#hl-5-41>41</a>
</span><span class=lnt id=hl-5-42><a class=lnlinks href=#hl-5-42>42</a>
</span><span class=lnt id=hl-5-43><a class=lnlinks href=#hl-5-43>43</a>
</span><span class=lnt id=hl-5-44><a class=lnlinks href=#hl-5-44>44</a>
</span><span class=lnt id=hl-5-45><a class=lnlinks href=#hl-5-45>45</a>
</span><span class=lnt id=hl-5-46><a class=lnlinks href=#hl-5-46>46</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>org.apache.kafka.clients.consumer.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.time.Duration</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.Arrays</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.Properties</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>SimpleConsumer</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 컨슈머 속성 설정</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Properties</span><span class=w> </span><span class=n>props</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Properties</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;bootstrap.servers&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;localhost:9092&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;group.id&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;my-consumer-group&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;key.deserializer&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;org.apache.kafka.common.serialization.StringDeserializer&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;value.deserializer&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;org.apache.kafka.common.serialization.StringDeserializer&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>props</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=s>&#34;auto.offset.reset&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;earliest&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 컨슈머 인스턴스 생성</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Consumer</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>consumer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>KafkaConsumer</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>props</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 토픽 구독</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>consumer</span><span class=p>.</span><span class=na>subscribe</span><span class=p>(</span><span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=s>&#34;my-topic&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 메시지 폴링 및 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=kc>true</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>ConsumerRecords</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>records</span><span class=w> </span><span class=o>=</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>consumer</span><span class=p>.</span><span class=na>poll</span><span class=p>(</span><span class=n>Duration</span><span class=p>.</span><span class=na>ofMillis</span><span class=p>(</span><span class=n>100</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>ConsumerRecord</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>record</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>records</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=s>&#34;Received record: &#34;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=s>&#34;Topic: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>record</span><span class=p>.</span><span class=na>topic</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;, &#34;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=s>&#34;Partition: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>record</span><span class=p>.</span><span class=na>partition</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;, &#34;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=s>&#34;Offset: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>record</span><span class=p>.</span><span class=na>offset</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;, &#34;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=s>&#34;Key: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>record</span><span class=p>.</span><span class=na>key</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&#34;, &#34;</span><span class=w> </span><span class=o>+</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=s>&#34;Value: &#34;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>record</span><span class=p>.</span><span class=na>value</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>e</span><span class=p>.</span><span class=na>printStackTrace</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 자원 해제</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>consumer</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=python-클라이언트>Python 클라이언트<a hidden class=anchor aria-hidden=true href=#python-클라이언트>#</a></h4><p>Python 패키지 설치:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip install kafka-python
</span></span></code></pre></td></tr></table></div></div><p>Python 프로듀서 예제:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-7-1><a class=lnlinks href=#hl-7-1> 1</a>
</span><span class=lnt id=hl-7-2><a class=lnlinks href=#hl-7-2> 2</a>
</span><span class=lnt id=hl-7-3><a class=lnlinks href=#hl-7-3> 3</a>
</span><span class=lnt id=hl-7-4><a class=lnlinks href=#hl-7-4> 4</a>
</span><span class=lnt id=hl-7-5><a class=lnlinks href=#hl-7-5> 5</a>
</span><span class=lnt id=hl-7-6><a class=lnlinks href=#hl-7-6> 6</a>
</span><span class=lnt id=hl-7-7><a class=lnlinks href=#hl-7-7> 7</a>
</span><span class=lnt id=hl-7-8><a class=lnlinks href=#hl-7-8> 8</a>
</span><span class=lnt id=hl-7-9><a class=lnlinks href=#hl-7-9> 9</a>
</span><span class=lnt id=hl-7-10><a class=lnlinks href=#hl-7-10>10</a>
</span><span class=lnt id=hl-7-11><a class=lnlinks href=#hl-7-11>11</a>
</span><span class=lnt id=hl-7-12><a class=lnlinks href=#hl-7-12>12</a>
</span><span class=lnt id=hl-7-13><a class=lnlinks href=#hl-7-13>13</a>
</span><span class=lnt id=hl-7-14><a class=lnlinks href=#hl-7-14>14</a>
</span><span class=lnt id=hl-7-15><a class=lnlinks href=#hl-7-15>15</a>
</span><span class=lnt id=hl-7-16><a class=lnlinks href=#hl-7-16>16</a>
</span><span class=lnt id=hl-7-17><a class=lnlinks href=#hl-7-17>17</a>
</span><span class=lnt id=hl-7-18><a class=lnlinks href=#hl-7-18>18</a>
</span><span class=lnt id=hl-7-19><a class=lnlinks href=#hl-7-19>19</a>
</span><span class=lnt id=hl-7-20><a class=lnlinks href=#hl-7-20>20</a>
</span><span class=lnt id=hl-7-21><a class=lnlinks href=#hl-7-21>21</a>
</span><span class=lnt id=hl-7-22><a class=lnlinks href=#hl-7-22>22</a>
</span><span class=lnt id=hl-7-23><a class=lnlinks href=#hl-7-23>23</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaProducer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 프로듀서 생성</span>
</span></span><span class=line><span class=cl><span class=n>producer</span> <span class=o>=</span> <span class=n>KafkaProducer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>value_serializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>v</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>v</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메시지 전송</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;number&#39;</span><span class=p>:</span> <span class=n>i</span><span class=p>,</span> <span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=sa>f</span><span class=s1>&#39;Hello Kafka </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>future</span> <span class=o>=</span> <span class=n>producer</span><span class=o>.</span><span class=n>send</span><span class=p>(</span><span class=s1>&#39;my-topic&#39;</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 결과 확인</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>record_metadata</span> <span class=o>=</span> <span class=n>future</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>timeout</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Sent to </span><span class=si>{</span><span class=n>record_metadata</span><span class=o>.</span><span class=n>topic</span><span class=si>}</span><span class=s2> partition </span><span class=si>{</span><span class=n>record_metadata</span><span class=o>.</span><span class=n>partition</span><span class=si>}</span><span class=s2> offset </span><span class=si>{</span><span class=n>record_metadata</span><span class=o>.</span><span class=n>offset</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error sending message: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 모든 메시지가 전송될 때까지 대기</span>
</span></span><span class=line><span class=cl><span class=n>producer</span><span class=o>.</span><span class=n>flush</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>producer</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>Python 컨슈머 예제:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-8-1><a class=lnlinks href=#hl-8-1> 1</a>
</span><span class=lnt id=hl-8-2><a class=lnlinks href=#hl-8-2> 2</a>
</span><span class=lnt id=hl-8-3><a class=lnlinks href=#hl-8-3> 3</a>
</span><span class=lnt id=hl-8-4><a class=lnlinks href=#hl-8-4> 4</a>
</span><span class=lnt id=hl-8-5><a class=lnlinks href=#hl-8-5> 5</a>
</span><span class=lnt id=hl-8-6><a class=lnlinks href=#hl-8-6> 6</a>
</span><span class=lnt id=hl-8-7><a class=lnlinks href=#hl-8-7> 7</a>
</span><span class=lnt id=hl-8-8><a class=lnlinks href=#hl-8-8> 8</a>
</span><span class=lnt id=hl-8-9><a class=lnlinks href=#hl-8-9> 9</a>
</span><span class=lnt id=hl-8-10><a class=lnlinks href=#hl-8-10>10</a>
</span><span class=lnt id=hl-8-11><a class=lnlinks href=#hl-8-11>11</a>
</span><span class=lnt id=hl-8-12><a class=lnlinks href=#hl-8-12>12</a>
</span><span class=lnt id=hl-8-13><a class=lnlinks href=#hl-8-13>13</a>
</span><span class=lnt id=hl-8-14><a class=lnlinks href=#hl-8-14>14</a>
</span><span class=lnt id=hl-8-15><a class=lnlinks href=#hl-8-15>15</a>
</span><span class=lnt id=hl-8-16><a class=lnlinks href=#hl-8-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>kafka</span> <span class=kn>import</span> <span class=n>KafkaConsumer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 컨슈머 생성</span>
</span></span><span class=line><span class=cl><span class=n>consumer</span> <span class=o>=</span> <span class=n>KafkaConsumer</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;my-topic&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>bootstrap_servers</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;localhost:9092&#39;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=n>auto_offset_reset</span><span class=o>=</span><span class=s1>&#39;earliest&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>group_id</span><span class=o>=</span><span class=s1>&#39;my-python-consumer-group&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>value_deserializer</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 메시지 소비</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>message</span> <span class=ow>in</span> <span class=n>consumer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Received: </span><span class=si>{</span><span class=n>message</span><span class=o>.</span><span class=n>topic</span><span class=si>}</span><span class=s2> partition </span><span class=si>{</span><span class=n>message</span><span class=o>.</span><span class=n>partition</span><span class=si>}</span><span class=s2> offset </span><span class=si>{</span><span class=n>message</span><span class=o>.</span><span class=n>offset</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Key: </span><span class=si>{</span><span class=n>message</span><span class=o>.</span><span class=n>key</span><span class=si>}</span><span class=s2>, Value: </span><span class=si>{</span><span class=n>message</span><span class=o>.</span><span class=n>value</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=고급-kafka-기능>고급 Kafka 기능<a hidden class=anchor aria-hidden=true href=#고급-kafka-기능>#</a></h3><h4 id=스키마-레지스트리>스키마 레지스트리<a hidden class=anchor aria-hidden=true href=#스키마-레지스트리>#</a></h4><p>Kafka는 기본적으로 스키마 강제를 제공하지 않지만, Confluent Schema Registry와 함께 사용하여 메시지 포맷을 관리할 수 있다.</p><p>Avro 스키마 예제:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-9-1><a class=lnlinks href=#hl-9-1>1</a>
</span><span class=lnt id=hl-9-2><a class=lnlinks href=#hl-9-2>2</a>
</span><span class=lnt id=hl-9-3><a class=lnlinks href=#hl-9-3>3</a>
</span><span class=lnt id=hl-9-4><a class=lnlinks href=#hl-9-4>4</a>
</span><span class=lnt id=hl-9-5><a class=lnlinks href=#hl-9-5>5</a>
</span><span class=lnt id=hl-9-6><a class=lnlinks href=#hl-9-6>6</a>
</span><span class=lnt id=hl-9-7><a class=lnlinks href=#hl-9-7>7</a>
</span><span class=lnt id=hl-9-8><a class=lnlinks href=#hl-9-8>8</a>
</span><span class=lnt id=hl-9-9><a class=lnlinks href=#hl-9-9>9</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;namespace&#34;</span><span class=p>:</span> <span class=s2>&#34;example.avro&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;record&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;User&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;fields&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;name&#34;</span><span class=p>,</span> <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;string&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;age&#34;</span><span class=p>,</span> <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;int&#34;</span><span class=p>,</span> <span class=s2>&#34;null&#34;</span><span class=p>]}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=kafka-streams>Kafka Streams<a hidden class=anchor aria-hidden=true href=#kafka-streams>#</a></h4><p>Kafka Streams는 Kafka 기반의 스트림 처리 라이브러리로, 스트림 처리 애플리케이션을 쉽게 구축할 수 있게 한다.</p><h4 id=kafka-connect>Kafka Connect<a hidden class=anchor aria-hidden=true href=#kafka-connect>#</a></h4><p>Kafka Connect는 Kafka와 외부 시스템 간의 데이터 이동을 위한 프레임워크이다.</p><p>소스 커넥터 설정 예제(MySQL에서 데이터 가져오기):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-10-1><a class=lnlinks href=#hl-10-1> 1</a>
</span><span class=lnt id=hl-10-2><a class=lnlinks href=#hl-10-2> 2</a>
</span><span class=lnt id=hl-10-3><a class=lnlinks href=#hl-10-3> 3</a>
</span><span class=lnt id=hl-10-4><a class=lnlinks href=#hl-10-4> 4</a>
</span><span class=lnt id=hl-10-5><a class=lnlinks href=#hl-10-5> 5</a>
</span><span class=lnt id=hl-10-6><a class=lnlinks href=#hl-10-6> 6</a>
</span><span class=lnt id=hl-10-7><a class=lnlinks href=#hl-10-7> 7</a>
</span><span class=lnt id=hl-10-8><a class=lnlinks href=#hl-10-8> 8</a>
</span><span class=lnt id=hl-10-9><a class=lnlinks href=#hl-10-9> 9</a>
</span><span class=lnt id=hl-10-10><a class=lnlinks href=#hl-10-10>10</a>
</span><span class=lnt id=hl-10-11><a class=lnlinks href=#hl-10-11>11</a>
</span><span class=lnt id=hl-10-12><a class=lnlinks href=#hl-10-12>12</a>
</span><span class=lnt id=hl-10-13><a class=lnlinks href=#hl-10-13>13</a>
</span><span class=lnt id=hl-10-14><a class=lnlinks href=#hl-10-14>14</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;mysql-source-connector&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;config&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;connector.class&#34;</span><span class=p>:</span> <span class=s2>&#34;io.confluent.connect.jdbc.JdbcSourceConnector&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;connection.url&#34;</span><span class=p>:</span> <span class=s2>&#34;jdbc:mysql://localhost:3306/mydatabase&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;connection.user&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;connection.password&#34;</span><span class=p>:</span> <span class=s2>&#34;password&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;topic.prefix&#34;</span><span class=p>:</span> <span class=s2>&#34;mysql-&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;table.whitelist&#34;</span><span class=p>:</span> <span class=s2>&#34;users,orders&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;mode&#34;</span><span class=p>:</span> <span class=s2>&#34;incrementing&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;incrementing.column.name&#34;</span><span class=p>:</span> <span class=s2>&#34;id&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;tasks.max&#34;</span><span class=p>:</span> <span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>싱크 커넥터 설정 예제(Elasticsearch로 데이터 보내기):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-11-1><a class=lnlinks href=#hl-11-1> 1</a>
</span><span class=lnt id=hl-11-2><a class=lnlinks href=#hl-11-2> 2</a>
</span><span class=lnt id=hl-11-3><a class=lnlinks href=#hl-11-3> 3</a>
</span><span class=lnt id=hl-11-4><a class=lnlinks href=#hl-11-4> 4</a>
</span><span class=lnt id=hl-11-5><a class=lnlinks href=#hl-11-5> 5</a>
</span><span class=lnt id=hl-11-6><a class=lnlinks href=#hl-11-6> 6</a>
</span><span class=lnt id=hl-11-7><a class=lnlinks href=#hl-11-7> 7</a>
</span><span class=lnt id=hl-11-8><a class=lnlinks href=#hl-11-8> 8</a>
</span><span class=lnt id=hl-11-9><a class=lnlinks href=#hl-11-9> 9</a>
</span><span class=lnt id=hl-11-10><a class=lnlinks href=#hl-11-10>10</a>
</span><span class=lnt id=hl-11-11><a class=lnlinks href=#hl-11-11>11</a>
</span><span class=lnt id=hl-11-12><a class=lnlinks href=#hl-11-12>12</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;elasticsearch-sink-connector&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;config&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;connector.class&#34;</span><span class=p>:</span> <span class=s2>&#34;io.confluent.connect.elasticsearch.ElasticsearchSinkConnector&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;topics&#34;</span><span class=p>:</span> <span class=s2>&#34;mysql-users&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;connection.url&#34;</span><span class=p>:</span> <span class=s2>&#34;http://localhost:9200&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type.name&#34;</span><span class=p>:</span> <span class=s2>&#34;_doc&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;key.ignore&#34;</span><span class=p>:</span> <span class=s2>&#34;true&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;schema.ignore&#34;</span><span class=p>:</span> <span class=s2>&#34;true&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;tasks.max&#34;</span><span class=p>:</span> <span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=ksql>KSQL<a hidden class=anchor aria-hidden=true href=#ksql>#</a></h4><p>KSQL은 Kafka 스트림에 대한 SQL 인터페이스를 제공하는 이벤트 스트리밍 데이터베이스이다.</p><p>KSQL 쿼리 예제:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-12-1><a class=lnlinks href=#hl-12-1> 1</a>
</span><span class=lnt id=hl-12-2><a class=lnlinks href=#hl-12-2> 2</a>
</span><span class=lnt id=hl-12-3><a class=lnlinks href=#hl-12-3> 3</a>
</span><span class=lnt id=hl-12-4><a class=lnlinks href=#hl-12-4> 4</a>
</span><span class=lnt id=hl-12-5><a class=lnlinks href=#hl-12-5> 5</a>
</span><span class=lnt id=hl-12-6><a class=lnlinks href=#hl-12-6> 6</a>
</span><span class=lnt id=hl-12-7><a class=lnlinks href=#hl-12-7> 7</a>
</span><span class=lnt id=hl-12-8><a class=lnlinks href=#hl-12-8> 8</a>
</span><span class=lnt id=hl-12-9><a class=lnlinks href=#hl-12-9> 9</a>
</span><span class=lnt id=hl-12-10><a class=lnlinks href=#hl-12-10>10</a>
</span><span class=lnt id=hl-12-11><a class=lnlinks href=#hl-12-11>11</a>
</span><span class=lnt id=hl-12-12><a class=lnlinks href=#hl-12-12>12</a>
</span><span class=lnt id=hl-12-13><a class=lnlinks href=#hl-12-13>13</a>
</span><span class=lnt id=hl-12-14><a class=lnlinks href=#hl-12-14>14</a>
</span><span class=lnt id=hl-12-15><a class=lnlinks href=#hl-12-15>15</a>
</span><span class=lnt id=hl-12-16><a class=lnlinks href=#hl-12-16>16</a>
</span><span class=lnt id=hl-12-17><a class=lnlinks href=#hl-12-17>17</a>
</span><span class=lnt id=hl-12-18><a class=lnlinks href=#hl-12-18>18</a>
</span><span class=lnt id=hl-12-19><a class=lnlinks href=#hl-12-19>19</a>
</span><span class=lnt id=hl-12-20><a class=lnlinks href=#hl-12-20>20</a>
</span><span class=lnt id=hl-12-21><a class=lnlinks href=#hl-12-21>21</a>
</span><span class=lnt id=hl-12-22><a class=lnlinks href=#hl-12-22>22</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- 스트림 생성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=n>STREAM</span><span class=w> </span><span class=n>orders</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>order_id</span><span class=w> </span><span class=nb>BIGINT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>customer_id</span><span class=w> </span><span class=nb>BIGINT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>product_id</span><span class=w> </span><span class=nb>BIGINT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>quantity</span><span class=w> </span><span class=nb>INT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>price</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>KAFKA_TOPIC</span><span class=o>=</span><span class=s1>&#39;order-events&#39;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>VALUE_FORMAT</span><span class=o>=</span><span class=s1>&#39;JSON&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 테이블 생성
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>product_sales</span><span class=w> </span><span class=k>AS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>product_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=n>quantity</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>price</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>total_sales</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>orders</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>product_id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- 쿼리 실행
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>product_sales</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>total_sales</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1000</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=성능-최적화-및-운영>성능 최적화 및 운영<a hidden class=anchor aria-hidden=true href=#성능-최적화-및-운영>#</a></h3><ol><li><p>프로듀서 성능 튜닝<br><strong>배치 설정</strong>:</p><ul><li><code>batch.size</code>: 한 번에 전송할 레코드 배치의 크기</li><li><code>linger.ms</code>: 배치를 전송하기 전에 대기할 시간<br><strong>압축</strong>:</li><li><code>compression.type</code>: 메시지 압축 유형(none, gzip, snappy, lz4, zstd)<br><strong>버퍼 및 재시도</strong>:</li><li><code>buffer.memory</code>: 전송 대기 중인 레코드에 사용할 버퍼 크기</li><li><code>retries</code>: 일시적인 오류에 대한 재시도 횟수</li><li><code>retry.backoff.ms</code>: 재시도 간격</li></ul></li><li><p>컨슈머 성능 튜닝<br><strong>폴링 및 처리</strong>:</p><ul><li><code>max.poll.records</code>: 단일 poll()에서 반환되는 최대 레코드 수</li><li><code>fetch.min.bytes</code>: 요청당 가져올 최소 데이터 양</li><li><code>fetch.max.wait.ms</code>: 최소 바이트를 사용할 수 없는 경우 대기 시간<br><strong>커밋 설정</strong>:</li><li><code>enable.auto.commit</code>: 자동 오프셋 커밋 활성화 여부</li><li><code>auto.commit.interval.ms</code>: 자동 커밋 간격</li></ul></li><li><p>브로커 성능 튜닝<br><strong>디스크 성능</strong>:</p><ul><li>고성능 SSD 사용</li><li>RAID 구성보다 JBOD(Just a Bunch of Disks) 선호</li><li><code>log.flush.interval.messages</code> 및 <code>log.flush.interval.ms</code> 조정<br><strong>JVM 튜닝</strong>:</li><li>적절한 힙 크기 설정</li><li>G1GC 가비지 컬렉터 사용<br><strong>네트워크 설정</strong>:</li><li><code>num.network.threads</code>: 네트워크 요청을 처리하는 스레드 수</li><li><code>num.io.threads</code>: 디스크 I/O를 처리하는 스레드 수</li></ul></li><li><p>모니터링 및 관리<br><strong>JMX 메트릭</strong>:</p><ul><li>생산자, 소비자, 브로커 메트릭 모니터링</li><li>Prometheus, Grafana, Datadog 등의 도구 활용<br><strong>로그 및 경고</strong>:</li><li>브로커 로그 모니터링</li><li>중요 메트릭에 대한 경고 설정<br><strong>관리 도구</strong>:</li><li>Kafka Manager(CMAK)</li><li>Confluent Control Center</li><li>Kafdrop</li></ul></li></ol><h3 id=장애-처리-및-복구-전략>장애 처리 및 복구 전략<a hidden class=anchor aria-hidden=true href=#장애-처리-및-복구-전략>#</a></h3><ol><li>브로커 장애<br><strong>리더 선출</strong>: 브로커가 실패하면 해당 브로커가 리더였던 파티션은 ISR(In-Sync Replicas)에서 새 리더를 선출한다.<br><strong>브로커 복구 단계</strong>:<ol><li>실패한 브로커를 재시작</li><li>자동으로 클러스터에 재참여</li><li>파티션 데이터 동기화</li><li>리더십 재분배</li></ol></li><li>컨슈머 장애<br><strong>컨슈머 리밸런싱</strong>: 컨슈머가 실패하면 그룹 코디네이터가 리밸런싱을 시작하여 파티션을 나머지 컨슈머에게 재할당한다.<br><strong>예외 처리 전략</strong>:<ul><li>일시적인 오류: 재시도</li><li>영구적인 오류: 데드레터(Dead Letter) 큐에 메시지 전달</li><li>심각한 오류: 알림 및 수동 개입</li></ul></li><li>데이터 내구성 보장<br><strong>최소 동기화 복제본</strong>: <code>min.insync.replicas</code> 설정으로 쓰기 작업의 내구성을 보장한다.<br><strong>메시지 전달 의미</strong>:<ul><li><code>acks=0</code>: 전송 확인 없음(최소 내구성)</li><li><code>acks=1</code>: 리더만 확인(중간 내구성)</li><li><code>acks=all</code>: 모든 ISR이 확인(최대 내구성)</li></ul></li><li>재해 복구<br><strong>다중 데이터 센터 복제</strong>: MirrorMaker 2.0을 사용하여 데이터 센터 간 데이터 복제를 구현합니다.</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-13-1><a class=lnlinks href=#hl-13-1> 1</a>
</span><span class=lnt id=hl-13-2><a class=lnlinks href=#hl-13-2> 2</a>
</span><span class=lnt id=hl-13-3><a class=lnlinks href=#hl-13-3> 3</a>
</span><span class=lnt id=hl-13-4><a class=lnlinks href=#hl-13-4> 4</a>
</span><span class=lnt id=hl-13-5><a class=lnlinks href=#hl-13-5> 5</a>
</span><span class=lnt id=hl-13-6><a class=lnlinks href=#hl-13-6> 6</a>
</span><span class=lnt id=hl-13-7><a class=lnlinks href=#hl-13-7> 7</a>
</span><span class=lnt id=hl-13-8><a class=lnlinks href=#hl-13-8> 8</a>
</span><span class=lnt id=hl-13-9><a class=lnlinks href=#hl-13-9> 9</a>
</span><span class=lnt id=hl-13-10><a class=lnlinks href=#hl-13-10>10</a>
</span><span class=lnt id=hl-13-11><a class=lnlinks href=#hl-13-11>11</a>
</span><span class=lnt id=hl-13-12><a class=lnlinks href=#hl-13-12>12</a>
</span><span class=lnt id=hl-13-13><a class=lnlinks href=#hl-13-13>13</a>
</span><span class=lnt id=hl-13-14><a class=lnlinks href=#hl-13-14>14</a>
</span><span class=lnt id=hl-13-15><a class=lnlinks href=#hl-13-15>15</a>
</span><span class=lnt id=hl-13-16><a class=lnlinks href=#hl-13-16>16</a>
</span><span class=lnt id=hl-13-17><a class=lnlinks href=#hl-13-17>17</a>
</span><span class=lnt id=hl-13-18><a class=lnlinks href=#hl-13-18>18</a>
</span><span class=lnt id=hl-13-19><a class=lnlinks href=#hl-13-19>19</a>
</span><span class=lnt id=hl-13-20><a class=lnlinks href=#hl-13-20>20</a>
</span><span class=lnt id=hl-13-21><a class=lnlinks href=#hl-13-21>21</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=c1># source-connect.properties</span>
</span></span><span class=line><span class=cl><span class=na>bootstrap.servers</span><span class=o>=</span><span class=s>kafka1:9092,kafka2:9092</span>
</span></span><span class=line><span class=cl><span class=na>group.id</span><span class=o>=</span><span class=s>mirror-group</span>
</span></span><span class=line><span class=cl><span class=na>config.storage.topic</span><span class=o>=</span><span class=s>mm2-configs</span>
</span></span><span class=line><span class=cl><span class=na>offset.storage.topic</span><span class=o>=</span><span class=s>mm2-offsets</span>
</span></span><span class=line><span class=cl><span class=na>status.storage.topic</span><span class=o>=</span><span class=s>mm2-status</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># target-connect.properties</span>
</span></span><span class=line><span class=cl><span class=na>bootstrap.servers</span><span class=o>=</span><span class=s>kafka3:9092,kafka4:9092</span>
</span></span><span class=line><span class=cl><span class=na>group.id</span><span class=o>=</span><span class=s>mirror-group</span>
</span></span><span class=line><span class=cl><span class=na>config.storage.topic</span><span class=o>=</span><span class=s>mm2-configs</span>
</span></span><span class=line><span class=cl><span class=na>offset.storage.topic</span><span class=o>=</span><span class=s>mm2-offsets</span>
</span></span><span class=line><span class=cl><span class=na>status.storage.topic</span><span class=o>=</span><span class=s>mm2-status</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># mm2.properties</span>
</span></span><span class=line><span class=cl><span class=na>clusters</span><span class=o>=</span><span class=s>source, target</span>
</span></span><span class=line><span class=cl><span class=na>source.bootstrap.servers</span><span class=o>=</span><span class=s>kafka1:9092,kafka2:9092</span>
</span></span><span class=line><span class=cl><span class=na>target.bootstrap.servers</span><span class=o>=</span><span class=s>kafka3:9092,kafka4:9092</span>
</span></span><span class=line><span class=cl><span class=na>source-&gt;target.enabled</span><span class=o>=</span><span class=s>true</span>
</span></span><span class=line><span class=cl><span class=na>source-&gt;target.topics</span><span class=o>=</span><span class=s>.*</span>
</span></span><span class=line><span class=cl><span class=na>tasks.max</span><span class=o>=</span><span class=s>10</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=실무-적용-사례-및-디자인-패턴>실무 적용 사례 및 디자인 패턴<a hidden class=anchor aria-hidden=true href=#실무-적용-사례-및-디자인-패턴>#</a></h3><h4 id=이벤트-소싱-패턴>이벤트 소싱 패턴<a hidden class=anchor aria-hidden=true href=#이벤트-소싱-패턴>#</a></h4><p>**이벤트 소싱(Event Sourcing)**은 상태 변경을 이벤트 시퀀스로 저장하는 패턴이다.</p><p>구현 단계:</p><ol><li>도메인 이벤트 정의</li><li>이벤트를 Kafka 토픽에 저장</li><li>이벤트를 처리하여 현재 상태 구성</li><li>필요시 이벤트를 재생하여 상태 재구성</li></ol><h4 id=cqrs-패턴>CQRS 패턴<a hidden class=anchor aria-hidden=true href=#cqrs-패턴>#</a></h4><p>**CQRS(Command Query Responsibility Segregation)**는 명령(쓰기)과 쿼리(읽기)를 분리하는 패턴이다.</p><p>Kafka를 활용한 CQRS 구현:</p><ol><li>명령을 Kafka 토픽으로 전송</li><li>이벤트 처리기가 명령을 처리하고 상태 변경</li><li>상태 변경 이벤트를 Kafka 토픽에 게시</li><li>읽기 모델 프로젝션이 이벤트를 소비하여 읽기 전용 데이터베이스 업데이트</li><li>쿼리는 읽기 전용 데이터베이스에서 처리</li></ol><h4 id=데이터-파이프라인-구축>데이터 파이프라인 구축<a hidden class=anchor aria-hidden=true href=#데이터-파이프라인-구축>#</a></h4><p>실시간 데이터 파이프라인 아키텍처:</p><ol><li>소스 시스템(데이터베이스, 애플리케이션 등)에서 Kafka Connect로 데이터 수집</li><li>Kafka 토픽에서 데이터 스트림 처리(Kafka Streams 또는 KSQL)</li><li>처리된 데이터를 분석 시스템(Elasticsearch, Hadoop 등)으로 전달</li><li>대시보드 또는 알림 시스템에서 결과 시각화</li></ol><h4 id=마이크로서비스-통신>마이크로서비스 통신<a hidden class=anchor aria-hidden=true href=#마이크로서비스-통신>#</a></h4><p>Kafka를 활용한 마이크로서비스 통신 패턴:</p><p><strong>이벤트 기반 통신</strong>:</p><ul><li>서비스 간 느슨한 결합</li><li>비동기 통신</li><li>이벤트 소싱과 결합</li></ul><p><strong>요청-응답 패턴</strong>:</p><ul><li>요청 토픽과 응답 토픽 사용</li><li>상관 ID로 요청과 응답 연결</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-14-1><a class=lnlinks href=#hl-14-1> 1</a>
</span><span class=lnt id=hl-14-2><a class=lnlinks href=#hl-14-2> 2</a>
</span><span class=lnt id=hl-14-3><a class=lnlinks href=#hl-14-3> 3</a>
</span><span class=lnt id=hl-14-4><a class=lnlinks href=#hl-14-4> 4</a>
</span><span class=lnt id=hl-14-5><a class=lnlinks href=#hl-14-5> 5</a>
</span><span class=lnt id=hl-14-6><a class=lnlinks href=#hl-14-6> 6</a>
</span><span class=lnt id=hl-14-7><a class=lnlinks href=#hl-14-7> 7</a>
</span><span class=lnt id=hl-14-8><a class=lnlinks href=#hl-14-8> 8</a>
</span><span class=lnt id=hl-14-9><a class=lnlinks href=#hl-14-9> 9</a>
</span><span class=lnt id=hl-14-10><a class=lnlinks href=#hl-14-10>10</a>
</span><span class=lnt id=hl-14-11><a class=lnlinks href=#hl-14-11>11</a>
</span><span class=lnt id=hl-14-12><a class=lnlinks href=#hl-14-12>12</a>
</span><span class=lnt id=hl-14-13><a class=lnlinks href=#hl-14-13>13</a>
</span><span class=lnt id=hl-14-14><a class=lnlinks href=#hl-14-14>14</a>
</span><span class=lnt id=hl-14-15><a class=lnlinks href=#hl-14-15>15</a>
</span><span class=lnt id=hl-14-16><a class=lnlinks href=#hl-14-16>16</a>
</span><span class=lnt id=hl-14-17><a class=lnlinks href=#hl-14-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// 요청 토픽에 메시지 전송</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>String</span><span class=w> </span><span class=n>correlationId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>UUID</span><span class=p>.</span><span class=na>randomUUID</span><span class=p>().</span><span class=na>toString</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>ProducerRecord</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>record</span><span class=w> </span><span class=o>=</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>new</span><span class=w> </span><span class=n>ProducerRecord</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=s>&#34;request-topic&#34;</span><span class=p>,</span><span class=w> </span><span class=n>correlationId</span><span class=p>,</span><span class=w> </span><span class=n>requestData</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>producer</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=n>record</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>// 응답 토픽에서 특정 상관 ID의 메시지만 소비</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>consumer</span><span class=p>.</span><span class=na>subscribe</span><span class=p>(</span><span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=s>&#34;response-topic&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=kc>true</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>ConsumerRecords</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>records</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>consumer</span><span class=p>.</span><span class=na>poll</span><span class=p>(</span><span class=n>Duration</span><span class=p>.</span><span class=na>ofMillis</span><span class=p>(</span><span class=n>100</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>ConsumerRecord</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>record</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>records</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>record</span><span class=p>.</span><span class=na>key</span><span class=p>().</span><span class=na>equals</span><span class=p>(</span><span class=n>correlationId</span><span class=p>))</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 응답 처리</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>record</span><span class=p>.</span><span class=na>value</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=kafka-보안>Kafka 보안<a hidden class=anchor aria-hidden=true href=#kafka-보안>#</a></h3><h4 id=인증>인증<a hidden class=anchor aria-hidden=true href=#인증>#</a></h4><p><strong>SSL/TLS 인증</strong>:</p><ul><li>클라이언트와 브로커 간 SSL/TLS 인증 설정</li><li>클라이언트 인증서를 사용한 양방향 인증</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-15-1><a class=lnlinks href=#hl-15-1> 1</a>
</span><span class=lnt id=hl-15-2><a class=lnlinks href=#hl-15-2> 2</a>
</span><span class=lnt id=hl-15-3><a class=lnlinks href=#hl-15-3> 3</a>
</span><span class=lnt id=hl-15-4><a class=lnlinks href=#hl-15-4> 4</a>
</span><span class=lnt id=hl-15-5><a class=lnlinks href=#hl-15-5> 5</a>
</span><span class=lnt id=hl-15-6><a class=lnlinks href=#hl-15-6> 6</a>
</span><span class=lnt id=hl-15-7><a class=lnlinks href=#hl-15-7> 7</a>
</span><span class=lnt id=hl-15-8><a class=lnlinks href=#hl-15-8> 8</a>
</span><span class=lnt id=hl-15-9><a class=lnlinks href=#hl-15-9> 9</a>
</span><span class=lnt id=hl-15-10><a class=lnlinks href=#hl-15-10>10</a>
</span><span class=lnt id=hl-15-11><a class=lnlinks href=#hl-15-11>11</a>
</span><span class=lnt id=hl-15-12><a class=lnlinks href=#hl-15-12>12</a>
</span><span class=lnt id=hl-15-13><a class=lnlinks href=#hl-15-13>13</a>
</span><span class=lnt id=hl-15-14><a class=lnlinks href=#hl-15-14>14</a>
</span><span class=lnt id=hl-15-15><a class=lnlinks href=#hl-15-15>15</a>
</span><span class=lnt id=hl-15-16><a class=lnlinks href=#hl-15-16>16</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=c1># broker 설정</span>
</span></span><span class=line><span class=cl><span class=na>listeners</span><span class=o>=</span><span class=s>SSL://localhost:9093</span>
</span></span><span class=line><span class=cl><span class=na>ssl.keystore.location</span><span class=o>=</span><span class=s>/var/private/ssl/kafka.server.keystore.jks</span>
</span></span><span class=line><span class=cl><span class=na>ssl.keystore.password</span><span class=o>=</span><span class=s>keystore-password</span>
</span></span><span class=line><span class=cl><span class=na>ssl.key.password</span><span class=o>=</span><span class=s>key-password</span>
</span></span><span class=line><span class=cl><span class=na>ssl.truststore.location</span><span class=o>=</span><span class=s>/var/private/ssl/kafka.server.truststore.jks</span>
</span></span><span class=line><span class=cl><span class=na>ssl.truststore.password</span><span class=o>=</span><span class=s>truststore-password</span>
</span></span><span class=line><span class=cl><span class=na>ssl.client.auth</span><span class=o>=</span><span class=s>required</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 클라이언트 설정</span>
</span></span><span class=line><span class=cl><span class=na>security.protocol</span><span class=o>=</span><span class=s>SSL</span>
</span></span><span class=line><span class=cl><span class=na>ssl.truststore.location</span><span class=o>=</span><span class=s>/var/private/ssl/kafka.client.truststore.jks</span>
</span></span><span class=line><span class=cl><span class=na>ssl.truststore.password</span><span class=o>=</span><span class=s>truststore-password</span>
</span></span><span class=line><span class=cl><span class=na>ssl.keystore.location</span><span class=o>=</span><span class=s>/var/private/ssl/kafka.client.keystore.jks</span>
</span></span><span class=line><span class=cl><span class=na>ssl.keystore.password</span><span class=o>=</span><span class=s>keystore-password</span>
</span></span><span class=line><span class=cl><span class=na>ssl.key.password</span><span class=o>=</span><span class=s>key-password</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>SASL 인증</strong>: Kafka는 다양한 SASL 메커니즘을 지원한다:</p><ul><li>PLAIN: 기본 사용자 이름/비밀번호 인증</li><li>SCRAM: 비밀번호 기반의 더 안전한 인증</li><li>GSSAPI: Kerberos 기반 인증</li><li>OAUTHBEARER: OAuth 토큰 기반 인증</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-16-1><a class=lnlinks href=#hl-16-1> 1</a>
</span><span class=lnt id=hl-16-2><a class=lnlinks href=#hl-16-2> 2</a>
</span><span class=lnt id=hl-16-3><a class=lnlinks href=#hl-16-3> 3</a>
</span><span class=lnt id=hl-16-4><a class=lnlinks href=#hl-16-4> 4</a>
</span><span class=lnt id=hl-16-5><a class=lnlinks href=#hl-16-5> 5</a>
</span><span class=lnt id=hl-16-6><a class=lnlinks href=#hl-16-6> 6</a>
</span><span class=lnt id=hl-16-7><a class=lnlinks href=#hl-16-7> 7</a>
</span><span class=lnt id=hl-16-8><a class=lnlinks href=#hl-16-8> 8</a>
</span><span class=lnt id=hl-16-9><a class=lnlinks href=#hl-16-9> 9</a>
</span><span class=lnt id=hl-16-10><a class=lnlinks href=#hl-16-10>10</a>
</span><span class=lnt id=hl-16-11><a class=lnlinks href=#hl-16-11>11</a>
</span><span class=lnt id=hl-16-12><a class=lnlinks href=#hl-16-12>12</a>
</span><span class=lnt id=hl-16-13><a class=lnlinks href=#hl-16-13>13</a>
</span><span class=lnt id=hl-16-14><a class=lnlinks href=#hl-16-14>14</a>
</span><span class=lnt id=hl-16-15><a class=lnlinks href=#hl-16-15>15</a>
</span><span class=lnt id=hl-16-16><a class=lnlinks href=#hl-16-16>16</a>
</span><span class=lnt id=hl-16-17><a class=lnlinks href=#hl-16-17>17</a>
</span><span class=lnt id=hl-16-18><a class=lnlinks href=#hl-16-18>18</a>
</span><span class=lnt id=hl-16-19><a class=lnlinks href=#hl-16-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=c1># 브로커 설정</span>
</span></span><span class=line><span class=cl><span class=na>listeners</span><span class=o>=</span><span class=s>SASL_SSL://localhost:9093</span>
</span></span><span class=line><span class=cl><span class=na>security.inter.broker.protocol</span><span class=o>=</span><span class=s>SASL_SSL</span>
</span></span><span class=line><span class=cl><span class=na>sasl.mechanism.inter.broker.protocol</span><span class=o>=</span><span class=s>PLAIN</span>
</span></span><span class=line><span class=cl><span class=na>sasl.enabled.mechanisms</span><span class=o>=</span><span class=s>PLAIN</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># JAAS 구성</span>
</span></span><span class=line><span class=cl><span class=na>listener.name.sasl_ssl.plain.sasl.jaas.config</span><span class=o>=</span><span class=s>org.apache.kafka.common.security.plain.PlainLoginModule required \
</span></span></span><span class=line><span class=cl><span class=s>    username=&#34;admin&#34; \
</span></span></span><span class=line><span class=cl><span class=s>    password=&#34;admin-secret&#34; \
</span></span></span><span class=line><span class=cl><span class=s>    user_admin=&#34;admin-secret&#34; \
</span></span></span><span class=line><span class=cl><span class=s>    user_user1=&#34;user1-secret&#34;;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 클라이언트 설정</span>
</span></span><span class=line><span class=cl><span class=na>security.protocol</span><span class=o>=</span><span class=s>SASL_SSL</span>
</span></span><span class=line><span class=cl><span class=na>sasl.mechanism</span><span class=o>=</span><span class=s>PLAIN</span>
</span></span><span class=line><span class=cl><span class=na>sasl.jaas.config</span><span class=o>=</span><span class=s>org.apache.kafka.common.security.plain.PlainLoginModule required \
</span></span></span><span class=line><span class=cl><span class=s>    username=&#34;user1&#34; \
</span></span></span><span class=line><span class=cl><span class=s>    password=&#34;user1-secret&#34;;</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=인가>인가<a hidden class=anchor aria-hidden=true href=#인가>#</a></h4><p>Kafka는 ACL(Access Control Lists)을 통해 리소스 접근 제어를 제공한다.</p><p><strong>ACL 설정</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-17-1><a class=lnlinks href=#hl-17-1> 1</a>
</span><span class=lnt id=hl-17-2><a class=lnlinks href=#hl-17-2> 2</a>
</span><span class=lnt id=hl-17-3><a class=lnlinks href=#hl-17-3> 3</a>
</span><span class=lnt id=hl-17-4><a class=lnlinks href=#hl-17-4> 4</a>
</span><span class=lnt id=hl-17-5><a class=lnlinks href=#hl-17-5> 5</a>
</span><span class=lnt id=hl-17-6><a class=lnlinks href=#hl-17-6> 6</a>
</span><span class=lnt id=hl-17-7><a class=lnlinks href=#hl-17-7> 7</a>
</span><span class=lnt id=hl-17-8><a class=lnlinks href=#hl-17-8> 8</a>
</span><span class=lnt id=hl-17-9><a class=lnlinks href=#hl-17-9> 9</a>
</span><span class=lnt id=hl-17-10><a class=lnlinks href=#hl-17-10>10</a>
</span><span class=lnt id=hl-17-11><a class=lnlinks href=#hl-17-11>11</a>
</span><span class=lnt id=hl-17-12><a class=lnlinks href=#hl-17-12>12</a>
</span><span class=lnt id=hl-17-13><a class=lnlinks href=#hl-17-13>13</a>
</span><span class=lnt id=hl-17-14><a class=lnlinks href=#hl-17-14>14</a>
</span><span class=lnt id=hl-17-15><a class=lnlinks href=#hl-17-15>15</a>
</span><span class=lnt id=hl-17-16><a class=lnlinks href=#hl-17-16>16</a>
</span><span class=lnt id=hl-17-17><a class=lnlinks href=#hl-17-17>17</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 토픽에 대한 읽기 권한 부여</span>
</span></span><span class=line><span class=cl>bin/kafka-acls.sh --bootstrap-server localhost:9092 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --add --allow-principal User:user1 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --operation Read <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --topic my-topic
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 컨슈머 그룹에 대한 권한 부여</span>
</span></span><span class=line><span class=cl>bin/kafka-acls.sh --bootstrap-server localhost:9092 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --add --allow-principal User:user1 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --operation Read <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --group my-consumer-group
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 프로듀서에 대한 쓰기 권한 부여</span>
</span></span><span class=line><span class=cl>bin/kafka-acls.sh --bootstrap-server localhost:9092 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --add --allow-principal User:user2 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --operation Write <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --topic my-topic
</span></span></code></pre></td></tr></table></div></div><p><strong>중앙화된 권한 관리</strong>: Confluent의 RBAC(Role-Based Access Control)을 사용하여 보다 세분화된 권한 관리가 가능하다.</p><h4 id=암호화>암호화<a hidden class=anchor aria-hidden=true href=#암호화>#</a></h4><p><strong>전송 중 암호화</strong>:</p><ul><li>SSL/TLS를 사용한 브로커-클라이언트 간 통신 암호화</li><li>브로커 간 통신 암호화 (security.inter.broker.protocol=SSL)</li></ul><p><strong>저장 데이터 암호화</strong>:</p><ul><li>호스트 레벨 디스크 암호화 (LUKS, dm-crypt 등)</li><li>Confluent의 저장 데이터 암호화 기능 (엔터프라이즈 기능)</li></ul><h3 id=kafka-배포-및-운영-모범-사례>Kafka 배포 및 운영 모범 사례<a hidden class=anchor aria-hidden=true href=#kafka-배포-및-운영-모범-사례>#</a></h3><ol><li><p>클러스터 사이징<br><strong>브로커 수 결정 요소</strong>:</p><ul><li>처리해야 할 데이터 양</li><li>필요한 처리량</li><li>원하는 복제 인자</li><li>내결함성 요구사항<br>클러스터 크기 산정 공식:</li></ul><pre class=mermaid>필요한 브로커 수 = (데이터 처리량 × 보존 기간 × 복제 인자) / 브로커당 디스크 용량
</pre><p><strong>파티션 수 결정 요소</strong>:</p><ul><li>토픽당 처리량</li><li>컨슈머 병렬 처리 수준</li><li>메시지 순서 요구사항</li></ul><p><strong>경험적 지침</strong>:</p><ul><li>파티션 수는 컨슈머 스레드 수의 2-3배</li><li>토픽당 파티션 수는 브로커 수의 배수가 되도록 설정</li><li>파티션 수가 너무 많으면 성능 저하와 관리 오버헤드 발생</li></ul></li><li><p>프로덕션 배포 체크리스트<br><strong>하드웨어 요구사항</strong>:</p><ul><li>디스크: 고성능 SSD (RAID보다 JBOD 선호)</li><li>메모리: 최소 32GB (힙 크기는 보통 최대 32GB)</li><li>CPU: 멀티코어 프로세서 (I/O와 네트워크 작업에 유리)</li><li>네트워크: 최소 10 Gbps NIC</li></ul><p><strong>OS 및 JVM 설정</strong>:</p><ul><li>파일 설명자 제한 증가 (ulimit -n)</li><li>스왑 비활성화 또는 최소화</li><li>G1GC 가비지 컬렉터 사용</li><li>적절한 힙 크기 설정</li></ul><p><strong>중요 구성 매개변수</strong>:</p><ul><li><code>log.retention.hours</code>: 로그 보존 시간</li><li><code>log.retention.bytes</code>: 로그 보존 크기</li><li><code>log.segment.bytes</code>: 로그 세그먼트 크기</li><li><code>num.partitions</code>: 기본 파티션 수</li><li><code>num.recovery.threads.per.data.dir</code>: 서버 시작 시 복구 스레드 수</li><li><code>default.replication.factor</code>: 기본 복제 인자</li><li><code>min.insync.replicas</code>: 최소 동기화 복제본 수</li></ul></li><li><p>운영 모범 사례<br><strong>백업 전략</strong>:</p><ul><li>정기적인 토픽 백업 (예: MirrorMaker)</li><li>브로커 구성 파일 백업</li><li>재해 복구 계획 수립</li></ul><p><strong>모니터링 주요 메트릭</strong>:</p><ul><li>브로커 수준:<ul><li>활성 컨트롤러 수</li><li>요청 핸들러 유휴 비율</li><li>네트워크/디스크 처리량</li><li>JVM 메모리 사용량</li></ul></li><li>토픽/파티션 수준:<ul><li>복제 지연(Replication Lag)</li><li>ISR 축소율</li><li>메시지 처리량</li><li>파티션 불균형 지표</li></ul></li><li>클라이언트 수준:<ul><li>생산/소비 지연 시간</li><li>요청 속도</li><li>오류율</li></ul></li></ul><p><strong>롤링 업그레이드 절차</strong>:</p><ol><li>새 버전 호환성 확인</li><li>구성 변경사항 검토</li><li>테스트 환경에서 검증</li><li>브로커를 한 번에 하나씩 업그레이드</li><li>각 브로커 업그레이드 후 클러스터 상태 확인</li></ol></li><li><p>토픽 관리 전략<br><strong>토픽 설계 고려사항</strong>:</p><ul><li>메시지 크기와 볼륨</li><li>보존 요구사항</li><li>읽기/쓰기 패턴</li><li>순서 보장 요구사항</li></ul><p><strong>토픽 명명 규칙</strong>:</p><pre class=mermaid>&lt;환경&gt;.&lt;팀/서비스&gt;.&lt;데이터 유형&gt;
</pre><p>예: <code>prod.users.registration</code>, <code>dev.payments.transactions</code></p><p><strong>토픽 구성 모범 사례</strong>:</p><ul><li>토픽별 파티션 수 최적화</li><li>토픽별 보존 기간 설정</li><li>토픽별 압축 설정</li></ul></li></ol><h3 id=kafka-에코시스템-및-통합>Kafka 에코시스템 및 통합<a hidden class=anchor aria-hidden=true href=#kafka-에코시스템-및-통합>#</a></h3><ul><li><p>Confluent Platform 구성 요소</p><ul><li><strong>Confluent Schema Registry</strong>:<ul><li>메시지 스키마 관리</li><li>스키마 호환성 검사</li><li>스키마 버전 관리</li></ul></li><li><strong>Confluent REST Proxy</strong>:<ul><li>HTTP를 통한 Kafka 토픽 액세스</li><li>비 JVM 클라이언트를 위한 인터페이스</li><li>방화벽 뒤에서 Kafka 사용 가능</li></ul></li><li><strong>Confluent Control Center</strong>:<ul><li>클러스터 모니터링 및 관리 UI</li><li>스키마, 커넥터, KSQL 관리</li><li>데이터 흐름 시각화</li></ul></li><li><strong>Confluent Replicator</strong>:<ul><li>클러스터 간 데이터 복제</li><li>토픽 이름 변환 및 필터링</li><li>동기화 상태 모니터링</li></ul></li></ul></li><li><p>Kafka와 빅데이터 생태계 통합</p><ul><li><strong>Hadoop 통합</strong>:<ul><li>Kafka Connect HDFS 싱크 커넥터</li><li>Flume Kafka 소스/싱크</li></ul></li><li><strong>Spark 통합</strong>:<ul><li>Spark Streaming의 Kafka 소스/싱크</li><li>Structured Streaming과 Kafka 통합</li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-20-1><a class=lnlinks href=#hl-20-1> 1</a>
</span><span class=lnt id=hl-20-2><a class=lnlinks href=#hl-20-2> 2</a>
</span><span class=lnt id=hl-20-3><a class=lnlinks href=#hl-20-3> 3</a>
</span><span class=lnt id=hl-20-4><a class=lnlinks href=#hl-20-4> 4</a>
</span><span class=lnt id=hl-20-5><a class=lnlinks href=#hl-20-5> 5</a>
</span><span class=lnt id=hl-20-6><a class=lnlinks href=#hl-20-6> 6</a>
</span><span class=lnt id=hl-20-7><a class=lnlinks href=#hl-20-7> 7</a>
</span><span class=lnt id=hl-20-8><a class=lnlinks href=#hl-20-8> 8</a>
</span><span class=lnt id=hl-20-9><a class=lnlinks href=#hl-20-9> 9</a>
</span><span class=lnt id=hl-20-10><a class=lnlinks href=#hl-20-10>10</a>
</span><span class=lnt id=hl-20-11><a class=lnlinks href=#hl-20-11>11</a>
</span><span class=lnt id=hl-20-12><a class=lnlinks href=#hl-20-12>12</a>
</span><span class=lnt id=hl-20-13><a class=lnlinks href=#hl-20-13>13</a>
</span><span class=lnt id=hl-20-14><a class=lnlinks href=#hl-20-14>14</a>
</span><span class=lnt id=hl-20-15><a class=lnlinks href=#hl-20-15>15</a>
</span><span class=lnt id=hl-20-16><a class=lnlinks href=#hl-20-16>16</a>
</span><span class=lnt id=hl-20-17><a class=lnlinks href=#hl-20-17>17</a>
</span><span class=lnt id=hl-20-18><a class=lnlinks href=#hl-20-18>18</a>
</span><span class=lnt id=hl-20-19><a class=lnlinks href=#hl-20-19>19</a>
</span><span class=lnt id=hl-20-20><a class=lnlinks href=#hl-20-20>20</a>
</span><span class=lnt id=hl-20-21><a class=lnlinks href=#hl-20-21>21</a>
</span><span class=lnt id=hl-20-22><a class=lnlinks href=#hl-20-22>22</a>
</span><span class=lnt id=hl-20-23><a class=lnlinks href=#hl-20-23>23</a>
</span><span class=lnt id=hl-20-24><a class=lnlinks href=#hl-20-24>24</a>
</span><span class=lnt id=hl-20-25><a class=lnlinks href=#hl-20-25>25</a>
</span><span class=lnt id=hl-20-26><a class=lnlinks href=#hl-20-26>26</a>
</span><span class=lnt id=hl-20-27><a class=lnlinks href=#hl-20-27>27</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-scala data-lang=scala><span class=line><span class=cl><span class=c1>// Spark Streaming을 사용한 Kafka 데이터 처리 예제
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>val</span> <span class=n>spark</span> <span class=k>=</span> <span class=nc>SparkSession</span><span class=o>.</span><span class=n>builder</span><span class=o>().</span><span class=n>appName</span><span class=o>(</span><span class=s>&#34;KafkaSparkIntegration&#34;</span><span class=o>).</span><span class=n>getOrCreate</span><span class=o>()</span>
</span></span><span class=line><span class=cl><span class=k>import</span> <span class=nn>spark.implicits._</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>val</span> <span class=n>kafkaStream</span> <span class=k>=</span> <span class=n>spark</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>readStream</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>format</span><span class=o>(</span><span class=s>&#34;kafka&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>option</span><span class=o>(</span><span class=s>&#34;kafka.bootstrap.servers&#34;</span><span class=o>,</span> <span class=s>&#34;localhost:9092&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>option</span><span class=o>(</span><span class=s>&#34;subscribe&#34;</span><span class=o>,</span> <span class=s>&#34;my-topic&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>load</span><span class=o>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>val</span> <span class=n>valueDS</span> <span class=k>=</span> <span class=n>kafkaStream</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>selectExpr</span><span class=o>(</span><span class=s>&#34;CAST(value AS STRING)&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>as</span><span class=o>[</span><span class=kt>String</span><span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>val</span> <span class=n>wordCounts</span> <span class=k>=</span> <span class=n>valueDS</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>flatMap</span><span class=o>(</span><span class=k>_</span><span class=o>.</span><span class=n>split</span><span class=o>(</span><span class=s>&#34; &#34;</span><span class=o>))</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>groupBy</span><span class=o>(</span><span class=s>&#34;value&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>count</span><span class=o>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>val</span> <span class=n>query</span> <span class=k>=</span> <span class=n>wordCounts</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>writeStream</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>outputMode</span><span class=o>(</span><span class=s>&#34;complete&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>format</span><span class=o>(</span><span class=s>&#34;console&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=o>.</span><span class=n>start</span><span class=o>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>query</span><span class=o>.</span><span class=n>awaitTermination</span><span class=o>()</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>Flink 통합</strong>:<ul><li>Flink Kafka 커넥터</li><li>Flink Table API와 Kafka 통합</li></ul></li></ul></li><li><p>클라우드 네이티브 통합</p><ul><li><strong>Kubernetes 배포</strong>:<ul><li>Strimzi Kafka Operator 사용</li><li>상태 관리 및 자동 확장</li></ul></li><li><strong>클라우드 서비스</strong>:<ul><li>AWS MSK (Amazon Managed Streaming for Kafka)</li><li>Confluent Cloud</li><li>Azure Event Hubs for Kafka</li></ul></li><li><strong>서버리스 통합</strong>:<ul><li>AWS Lambda와 Kafka 통합</li><li>Azure Functions와 Kafka 통합</li><li>Google Cloud Functions와 Kafka 통합</li></ul></li></ul></li></ul><h3 id=실무적-조언-및-일반적인-함정>실무적 조언 및 일반적인 함정<a hidden class=anchor aria-hidden=true href=#실무적-조언-및-일반적인-함정>#</a></h3><ol><li><p>성공적인 Kafka 도입을 위한 조언</p><ol><li><strong>점진적 접근</strong>:<ul><li>작은 프로젝트부터 시작</li><li>경험을 쌓은 후 확장</li><li>반복적인 아키텍처 개선</li></ul></li><li><strong>프로젝트 설계 시 고려사항</strong>:<ul><li>메시지 형식 및 스키마 표준화</li><li>토픽 명명 규칙 수립</li><li>명확한 책임 분리 및 소유권 정의</li></ul></li><li><strong>조직 전략</strong>:<ul><li>충분한 교육 및 지식 공유</li><li>전담 Kafka 운영 팀 구성 고려</li><li>내부 모범 사례 문서화</li></ul></li></ol></li><li><p>일반적인 함정과 해결 방법</p><ol><li><strong>과도한 파티션 수</strong>:<ul><li>문제: 파티션이 너무 많으면 성능 저하와 리밸런싱 시간 증가</li><li>해결: 실제 처리량 요구사항에 맞춰 파티션 수 최적화</li></ul></li><li><strong>부적절한 키 선택</strong>:<ul><li>문제: 편향된 키 분포로 인한 핫 파티션</li><li>해결: 균등하게 분포된 키 선택 또는 사용자 정의 파티셔너 구현</li></ul></li><li><strong>불충분한 모니터링</strong>:<ul><li>문제: 문제 발생 시 원인 파악 어려움</li><li>해결: 포괄적인 모니터링 및 알림 시스템 구축</li></ul></li><li><strong>잘못된 소비자 오프셋 관리</strong>:<ul><li>문제: 메시지 중복 처리 또는 유실</li><li>해결: 명시적인 오프셋 커밋 전략 및 멱등성 구현</li></ul></li></ol></li><li><p>성능 문제 해결 가이드</p><ul><li><strong>높은 지연 시간 문제</strong>:<ol><li>디스크 I/O 병목 확인</li><li><ol start=2><li>크 지연 시간 측정</li></ol></li><li><ol start=3><li>일시 중지 모니터링</li></ol></li><li><ol start=4><li>설정 최적화</li></ol></li></ol></li><li><strong>처리량 문제</strong>:<ol><li>파티션 수 확인 및 조정</li><li>압축 설정 검토</li><li>클라이언트 배치 설정 최적화</li><li>하드웨어 리소스 확인</li></ol></li><li><strong>불균형 클러스터</strong>:<ol><li>토픽 파티션 할당 확인</li><li>리더 파티션 재분배 실행</li><li>사용자 정의 파티션 할당 전략 고려</li></ol></li></ul></li></ol><h3 id=kafka의-미래와-최신-동향>Kafka의 미래와 최신 동향<a hidden class=anchor aria-hidden=true href=#kafka의-미래와-최신-동향>#</a></h3><h4 id=kraft-모드-zookeeper-제거>KRaft 모드 (ZooKeeper 제거)<a hidden class=anchor aria-hidden=true href=#kraft-모드-zookeeper-제거>#</a></h4><p>Kafka 3.0부터 ZooKeeper 의존성을 제거하고 Kafka Raft 메타데이터 모드를 도입했다.</p><p><strong>KRaft 모드의 장점</strong>:</p><ul><li>단일 기술 스택 유지</li><li>클러스터 확장성 향상</li><li>컨트롤러 장애 조치 시간 단축</li><li>메타데이터 성능 향상</li></ul><p><strong>구성 방법</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-21-1><a class=lnlinks href=#hl-21-1>1</a>
</span><span class=lnt id=hl-21-2><a class=lnlinks href=#hl-21-2>2</a>
</span><span class=lnt id=hl-21-3><a class=lnlinks href=#hl-21-3>3</a>
</span><span class=lnt id=hl-21-4><a class=lnlinks href=#hl-21-4>4</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=c1># server.properties</span>
</span></span><span class=line><span class=cl><span class=na>process.roles</span><span class=o>=</span><span class=s>broker,controller</span>
</span></span><span class=line><span class=cl><span class=na>node.id</span><span class=o>=</span><span class=s>1</span>
</span></span><span class=line><span class=cl><span class=na>controller.quorum.voters</span><span class=o>=</span><span class=s>1@localhost:9093,2@localhost:9093,3@localhost:9093</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=tiered-storage>Tiered Storage<a hidden class=anchor aria-hidden=true href=#tiered-storage>#</a></h4><p>계층형 스토리지는 핫 데이터와 콜드 데이터를 구분하여 비용 효율적으로 관리한다.</p><p><strong>장점</strong>:</p><ul><li>저비용 스토리지 활용</li><li>무제한 메시지 보존</li><li>브로커 재시작 시간 단축</li></ul><h4 id=kafka-improvement-proposalskips>Kafka Improvement Proposals(KIPs)<a hidden class=anchor aria-hidden=true href=#kafka-improvement-proposalskips>#</a></h4><p>주목할 만한 최근 KIP:</p><ul><li>KIP-500: ZooKeeper 의존성 제거</li><li>KIP-405: 파티션 재할당 개선</li><li>KIP-516: 토픽 삭제 개선</li><li>KIP-679: 소비자 그룹 리밸런싱 프로토콜 개선</li></ul><h4 id=산업-동향>산업 동향<a hidden class=anchor aria-hidden=true href=#산업-동향>#</a></h4><p><strong>실시간 데이터 파이프라인</strong>:</p><ul><li>변경 데이터 캡처(CDC)와 Kafka 통합</li><li>데이터 레이크 및 웨어하우스 통합</li></ul><p><strong>이벤트 중심 아키텍처</strong>:</p><ul><li>마이크로서비스 통신 메커니즘으로 Kafka 채택 증가</li><li>실시간 비즈니스 인텔리전스</li></ul><p><strong>Edge Computing</strong>:</p><ul><li>에지 환경에서의 Kafka 배포</li><li>제한된 리소스 환경에 최적화된 Kafka 클라이언트</li></ul><hr><h2 id=용어-정리>용어 정리<a hidden class=anchor aria-hidden=true href=#용어-정리>#</a></h2><table><thead><tr><th>용어</th><th>설명</th></tr></thead><tbody><tr><td></td><td></td></tr></tbody></table><hr><h2 id=참고-및-출처>참고 및 출처<a hidden class=anchor aria-hidden=true href=#참고-및-출처>#</a></h2></div><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Kafka vs RabbitMQ</h2></header><div class=entry-content><p>Kafka vs. RabbitMQ Apache Kafka와 RabbitMQ는 모두 분산 메시징 시스템이지만 설계 목적, 아키텍처, 활용 사례에서 뚜렷한 차이를 보인다.
기본 개념 항목 Apache Kafka RabbitMQ 유형 분산 이벤트 스트리밍 플랫폼 메시지 브로커 (AMQP 구현) 주요 목적 대규모 실시간 데이터 스트리밍 및 처리 유연한 메시지 라우팅과 비동기 통신 지원 데이터 처리 로그 기반 스트림 (메시지 재생 가능) 큐 기반 메시지 (소비 후 삭제) Kafka는 LinkedIn에서 개발되어 나중에 Apache 재단으로 이관된 분산 이벤트 스트리밍 플랫폼이다. 주로 대용량 데이터 스트림을 실시간으로 처리하기 위해 설계되었다.
...</p></div><footer class=entry-footer><span title='2024-10-22 11:41:00 +0000 UTC'>October 22, 2024</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Me</footer><a class=entry-link aria-label="post link to Kafka vs RabbitMQ" href=https://buenhyden.github.io/posts/backend/event-brokers-and-message-brokers/tools/kafka/kafka-vs-rabbitmq/></a></article></main><footer class=footer><span>&copy; 2025 <a href=https://buenhyden.github.io/>hyunyoun's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>